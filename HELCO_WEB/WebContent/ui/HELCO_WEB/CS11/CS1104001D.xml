<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="440" Id="CS1104001D" Left="8" OnLoadCompleted="fn_OnLoadCompleted" OnUnloadCompleted="fn_OnUnloadCompleted" PidAttrib="7" Title="중도해지상세" Top="8" Ver="1.0" Width="792" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_gbn">
				<Contents>
					<colinfo id="CODE" size="3" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="50" summ="default" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME>-&#32;선택&#32;-</CODE_NAME>
					</record>
					<record>
						<CODE>R01</CODE>
						<CODE_NAME>1)&#32;전환계약체결에&#32;따른&#32;중지</CODE_NAME>
					</record>
					<record>
						<CODE>R02</CODE>
						<CODE_NAME>2)&#32;보수업체변경(이관)</CODE_NAME>
					</record>
					<record>
						<CODE>R03</CODE>
						<CODE_NAME>3)&#32;계약해지</CODE_NAME>
					</record>
					<record>
						<CODE>R99</CODE>
						<CODE_NAME>4)&#32;기타</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond_div">
				<Contents>
					<colinfo id="NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="DNO" size="256" summ="default" type="STRING"/>
					<colinfo id="DOCNO" size="256" summ="default" type="STRING"/>
					<record>
						<DNO></DNO>
						<DOCNO></DOCNO>
						<NUM></NUM>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_head_div">
				<Contents>
					<colinfo id="NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="KUNNR" size="256" summ="default" type="STRING"/>
					<colinfo id="KUNNR_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSITE_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="JHD" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="REQC" size="256" summ="default" type="STRING"/>
					<colinfo id="JID" size="256" summ="default" type="STRING"/>
					<colinfo id="REQE" size="256" summ="default" type="STRING"/>
					<colinfo id="REQ" size="256" summ="default" type="STRING"/>
					<colinfo id="RPD" size="256" summ="default" type="STRING"/>
					<record>
						<GBN></GBN>
						<JHD></JHD>
						<JID></JID>
						<KUNNR></KUNNR>
						<KUNNR_NM></KUNNR_NM>
						<NUM></NUM>
						<REQ></REQ>
						<REQC></REQC>
						<REQE></REQE>
						<RPD></RPD>
						<ZSITE_NM></ZSITE_NM>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list_div">
				<Contents>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="THYN" size="256" summ="default" type="STRING"/>
					<colinfo id="PJT" size="256" summ="default" type="STRING"/>
					<colinfo id="ARA" size="256" summ="default" type="STRING"/>
					<colinfo id="TEM" size="256" summ="default" type="STRING"/>
					<colinfo id="BSU" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSITE_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="KUNNR" size="256" summ="default" type="STRING"/>
					<colinfo id="DNO" size="256" summ="default" type="STRING"/>
					<colinfo id="ISD" size="256" summ="default" type="STRING"/>
					<colinfo id="ARA_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="BSU_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="KUNNR_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="TEM_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="HNO" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="HNA" size="256" summ="default" type="STRING"/>
					<colinfo id="WDT" size="256" summ="default" type="STRING"/>
					<colinfo id="FDT" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSPEC1" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSPEC2" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSPEC" size="256" summ="default" type="STRING"/>
					<colinfo id="PST" size="256" summ="default" type="STRING"/>
					<colinfo id="PST_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="GND" size="256" summ="default" type="STRING"/>
					<colinfo id="GND_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="BGT" size="256" summ="default" type="STRING"/>
					<colinfo id="BMT" size="256" summ="default" type="STRING"/>
					<colinfo id="BHD" size="256" summ="default" type="STRING"/>
					<colinfo id="MG1" size="256" summ="default" type="STRING"/>
					<colinfo id="BJT" size="256" summ="default" type="STRING"/>
					<colinfo id="BST" size="256" summ="default" type="STRING"/>
					<colinfo id="AYS" size="256" summ="default" type="STRING"/>
					<colinfo id="BYS" size="256" summ="default" type="STRING"/>
					<colinfo id="HYN" size="256" summ="default" type="STRING"/>
					<colinfo id="MANDT" size="256" summ="default" type="STRING"/>
					<colinfo id="SQL_GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
					<colinfo id="ZLIFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="AGB_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="ABG_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="GUBUN" size="256" summ="default" type="STRING"/>
					<colinfo id="JBF" size="256" summ="default" type="STRING"/>
					<colinfo id="APSTAT" size="256" summ="default" type="STRING"/>
					<colinfo id="APSTATNM" size="256" summ="default" type="STRING"/>
					<colinfo id="CRDPT1" size="256" summ="default" type="STRING"/>
					<colinfo id="REDPT1" size="256" summ="default" type="STRING"/>
					<colinfo id="ZMUSAOCNT" size="256" summ="default" type="STRING"/>
					<colinfo id="ZMUSAOCNT2" size="256" summ="default" type="STRING"/>
					<colinfo id="ZMUSAUCNT" size="256" summ="default" type="STRING"/>
					<colinfo id="ZMUSAUCNT2" size="256" summ="default" type="STRING"/>
					<colinfo id="MB_STN" size="256" summ="default" type="STRING"/>
					<colinfo id="MB_STN_NAME" size="256" summ="default" type="STRING"/>
					<colinfo id="ABG" size="256" summ="default" type="STRING"/>
					<colinfo id="RMK" size="256" summ="default" type="STRING"/>
					<colinfo id="BGT_A" size="256" summ="default" type="STRING"/>
					<colinfo id="BGT_B" size="256" summ="default" type="STRING"/>
					<colinfo id="BMT_A" size="256" summ="default" type="STRING"/>
					<colinfo id="BMT_B" size="256" summ="default" type="STRING"/>
					<colinfo id="GNO" size="256" summ="default" type="STRING"/>
					<colinfo id="ENDDATE" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="JYM" size="256" summ="default" type="STRING"/>
					<colinfo id="NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="JHD" size="256" summ="default" type="STRING"/>
					<colinfo id="JID" size="256" summ="default" type="STRING"/>
					<colinfo id="GCD" size="256" summ="default" type="STRING"/>
					<colinfo id="REQE" size="256" summ="default" type="STRING"/>
					<colinfo id="REQC" size="256" summ="default" type="STRING"/>
					<colinfo id="REQ" size="256" summ="default" type="STRING"/>
					<colinfo id="RPD" size="256" summ="default" type="STRING"/>
					<colinfo id="JGBN" size="256" summ="default" type="STRING"/>
					<colinfo id="B_VNDADR" size="256" summ="default" type="STRING"/>
					<colinfo id="B_VNDNM" size="256" summ="default" type="STRING"/>
					<colinfo id="B_REPNM" size="256" summ="default" type="STRING"/>
					<colinfo id="CS136_GYM" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond_dtl">
				<Contents>
					<colinfo id="PJT" size="256" summ="default" type="STRING"/>
					<colinfo id="BPM" size="256" summ="default" type="STRING"/>
					<colinfo id="ARA" size="256" summ="default" type="STRING"/>
					<colinfo id="BSU" size="256" summ="default" type="STRING"/>
					<colinfo id="TEM" size="256" summ="default" type="STRING"/>
					<colinfo id="KUNNR" size="256" summ="default" type="STRING"/>
					<colinfo id="GND" size="256" summ="default" type="STRING"/>
					<colinfo id="ISD" size="256" summ="default" type="STRING"/>
					<colinfo id="DNO" size="256" summ="default" type="STRING"/>
					<colinfo id="NUM" size="256" summ="default" type="STRING"/>
					<record>
						<ARA></ARA>
						<BPM></BPM>
						<BSU></BSU>
						<DNO></DNO>
						<GND></GND>
						<ISD></ISD>
						<KUNNR></KUNNR>
						<NUM></NUM>
						<PJT></PJT>
						<TEM></TEM>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_doc_cond">
				<Contents>
					<colinfo id="DOCTYPE" size="256" summ="default" type="STRING"/>
					<colinfo id="TEM" size="256" summ="default" type="STRING"/>
					<record>
						<DOCTYPE></DOCTYPE>
						<TEM></TEM>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_docno_gen">
				<Contents>
					<colinfo id="PFX" size="256" summ="default" type="STRING"/>
					<colinfo id="DOCNO" size="256" summ="default" type="STRING"/>
					<record>
						<DOCNO></DOCNO>
						<PFX></PFX>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_conf_cond">
				<Contents>
					<colinfo id="DOCNO" size="256" summ="default" type="STRING"/>
					<record>
						<DOCNO></DOCNO>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_conf_list">
				<Contents>
					<colinfo id="APRNK_S1" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM_S1" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE_S1" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK_S2" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM_S2" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE_S2" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK_S3" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM_S3" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE_S3" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK_S4" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM_S4" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE_S4" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK_S5" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM_S5" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE_S5" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK_R1" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM_R1" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE_R1" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK_R2" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM_R2" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE_R2" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK_R3" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM_R3" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE_R3" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK_R4" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM_R4" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE_R4" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK_R5" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM_R5" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE_R5" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_draftpers_list">
				<Contents>
					<colinfo id="D_TEM" size="256" summ="default" type="STRING"/>
					<colinfo id="D_RANK" size="256" summ="default" type="STRING"/>
					<colinfo id="D_NAME" size="256" summ="default" type="STRING"/>
					<colinfo id="D_DATE" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_print_h">
				<Contents>
					<colinfo id="DNO" size="256" summ="default" type="STRING"/>
					<colinfo id="D_TEM" size="256" summ="default" type="STRING"/>
					<colinfo id="D_RANK" size="256" summ="default" type="STRING"/>
					<colinfo id="D_NAME" size="256" summ="default" type="STRING"/>
					<colinfo id="D_DATE" size="256" summ="default" type="STRING"/>
					<colinfo id="BSU_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="KUNNR_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="TELF1" size="256" summ="default" type="STRING"/>
					<colinfo id="B_VNDADR" size="256" summ="default" type="STRING"/>
					<colinfo id="B_VNDNM" size="256" summ="default" type="STRING"/>
					<colinfo id="B_REPNM" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK_S1" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM_S1" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE_S1" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK_S2" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM_S2" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE_S2" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK_S3" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM_S3" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE_S3" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK_S4" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM_S4" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE_S4" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK_S5" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM_S5" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE_S5" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK_R1" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM_R1" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE_R1" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK_R2" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM_R2" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE_R2" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK_R3" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM_R3" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE_R3" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK_R4" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM_R4" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE_R4" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK_R5" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM_R5" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE_R5" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_print">
				<Contents>
					<colinfo id="PJT" size="256" summ="default" type="STRING"/>
					<colinfo id="ARA" size="256" summ="default" type="STRING"/>
					<colinfo id="TEM" size="256" summ="default" type="STRING"/>
					<colinfo id="BSU" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSITE_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="KUNNR" size="256" summ="default" type="STRING"/>
					<colinfo id="DNO" size="256" summ="default" type="STRING"/>
					<colinfo id="ISD" size="256" summ="default" type="STRING"/>
					<colinfo id="ARA_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="BSU_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="KUNNR_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="TEM_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="HNO" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="HNA" size="256" summ="default" type="STRING"/>
					<colinfo id="WDT" size="256" summ="default" type="STRING"/>
					<colinfo id="FDT" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSPEC1" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSPEC2" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSPEC" size="256" summ="default" type="STRING"/>
					<colinfo id="PST" size="256" summ="default" type="STRING"/>
					<colinfo id="PST_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="GND" size="256" summ="default" type="STRING"/>
					<colinfo id="GND_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="BGT" size="256" summ="default" type="STRING"/>
					<colinfo id="BMT" size="256" summ="default" type="STRING"/>
					<colinfo id="BHD" size="256" summ="default" type="STRING"/>
					<colinfo id="MG1" size="256" summ="default" type="STRING"/>
					<colinfo id="BJT" size="256" summ="default" type="STRING"/>
					<colinfo id="BST" size="256" summ="default" type="STRING"/>
					<colinfo id="AYS" size="256" summ="default" type="STRING"/>
					<colinfo id="BYS" size="256" summ="default" type="STRING"/>
					<colinfo id="HYN" size="256" summ="default" type="STRING"/>
					<colinfo id="MANDT" size="256" summ="default" type="STRING"/>
					<colinfo id="SQL_GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
					<colinfo id="ZLIFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="AGB_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="ABG_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="GUBUN" size="256" summ="default" type="STRING"/>
					<colinfo id="JBF" size="256" summ="default" type="STRING"/>
					<colinfo id="APSTAT" size="256" summ="default" type="STRING"/>
					<colinfo id="APSTATNM" size="256" summ="default" type="STRING"/>
					<colinfo id="ZMUSAOCNT" size="256" summ="default" type="STRING"/>
					<colinfo id="ZMUSAOCNT2" size="256" summ="default" type="STRING"/>
					<colinfo id="ZMUSAUCNT" size="256" summ="default" type="STRING"/>
					<colinfo id="ZMUSAUCNT2" size="256" summ="default" type="STRING"/>
					<colinfo id="MB_STN" size="256" summ="default" type="STRING"/>
					<colinfo id="MB_STN_NAME" size="256" summ="default" type="STRING"/>
					<colinfo id="ABG" size="256" summ="default" type="STRING"/>
					<colinfo id="RMK" size="256" summ="default" type="STRING"/>
					<colinfo id="BGT_A" size="256" summ="default" type="STRING"/>
					<colinfo id="BGT_B" size="256" summ="default" type="STRING"/>
					<colinfo id="BMT_A" size="256" summ="default" type="STRING"/>
					<colinfo id="BMT_B" size="256" summ="default" type="STRING"/>
					<colinfo id="GNO" size="256" summ="default" type="STRING"/>
					<colinfo id="ENDDATE" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="JYM" size="256" summ="default" type="STRING"/>
					<colinfo id="NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="JHD" size="256" summ="default" type="STRING"/>
					<colinfo id="JID" size="256" summ="default" type="STRING"/>
					<colinfo id="GCD" size="256" summ="default" type="STRING"/>
					<colinfo id="REQE" size="256" summ="default" type="STRING"/>
					<colinfo id="REQC" size="256" summ="default" type="STRING"/>
					<colinfo id="REQ" size="256" summ="default" type="STRING"/>
					<colinfo id="RPD" size="256" summ="default" type="STRING"/>
					<colinfo id="JGBN" size="256" summ="default" type="STRING"/>
					<colinfo id="B_VNDADR" size="256" summ="default" type="STRING"/>
					<colinfo id="B_VNDNM" size="256" summ="default" type="STRING"/>
					<colinfo id="B_REPNM" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_apstat_cb">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="DTEXT1" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_decide">
				<Contents>
					<colinfo id="MANDT" size="256" summ="default" type="STRING"/>
					<colinfo id="DOCNO" size="256" summ="default" type="STRING"/>
					<colinfo id="DOCKIND" size="256" summ="default" type="STRING"/>
					<colinfo id="APPGUBN" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQNO" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQSTAT" size="256" summ="default" type="STRING"/>
					<colinfo id="APDPT1" size="256" summ="default" type="STRING"/>
					<colinfo id="APDPT1_N" size="256" summ="default" type="STRING"/>
					<colinfo id="APNUM" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE" size="256" summ="default" type="STRING"/>
					<colinfo id="APTIM" size="256" summ="default" type="STRING"/>
					<colinfo id="APDESC" size="256" summ="default" type="STRING"/>
					<colinfo id="APSTAT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_check">
				<Contents>
					<colinfo id="CNT" size="256" summ="default" type="STRING"/>
					<record>
						<CNT></CNT>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_rcond">
				<Contents>
					<colinfo id="ZPROGRAM" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN" size="256" summ="default" type="STRING"/>
					<record>
						<GBN></GBN>
						<ZPROGRAM></ZPROGRAM>
					</record>
				</Contents>
			</Dataset>
		</Datasets>
		<Shape BKColor="user12" Bottom="429" Height="26" Id="Shape4" Left="7" LineColor="user13" Right="779" TabOrder="14" Top="403" Type="Rectangle" Width="772"></Shape>
		<Shape BKColor="user12" Bottom="404" Height="26" Id="Shape3" Left="7" LineColor="user13" Right="779" TabOrder="13" Top="378" Type="Rectangle" Width="772"></Shape>
		<Shape BKColor="user12" Bottom="66" Height="26" Id="Shape1" Left="8" LineColor="user13" Right="780" TabOrder="3" Top="40" Type="Rectangle" Width="772"></Shape>
		<Grid AutoEnter="TRUE" AutoFitEndLine="Hide" BindDataset="ds_list_div" BkColor2="default" BoldHead="true" Border="Flat" Bottom="304" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="240" Id="grd_list_div" InputPanel="FALSE" Left="8" LineColor="user20" LineType="ExHORZ" OnHeadClick="grd_list_div_OnHeadClick" Right="780" RowHeight="20" Style="sty_grid" TabOrder="1" TabStop="true" Top="64" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="772">
			<contents>
				<format id="Default">
					<columns>
						<col width="32"/>
						<col width="32"/>
						<col width="53"/>
						<col width="45"/>
						<col width="86"/>
						<col width="33"/>
						<col width="60"/>
						<col width="60"/>
						<col width="54"/>
						<col width="65"/>
						<col width="65"/>
						<col width="80"/>
						<col width="80"/>
						<col width="65"/>
						<col width="65"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
					</columns>
					<head>
						<cell col="0" display="checkbox" edit="checkbox" font="굴림,9" rowspan="2"/>
						<cell col="1" display="text" font="굴림,9" rowspan="2" text="No"/>
						<cell col="2" display="text" font="굴림,9" rowspan="2" text="Proj.No"/>
						<cell col="3" display="text" font="굴림,9" rowspan="2" text="호기"/>
						<cell col="4" display="text" font="굴림,9" rowspan="2" text="호기명"/>
						<cell col="5" display="text" font="굴림,9" rowspan="2" text="순번"/>
						<cell col="6" display="text" font="굴림,9" rowspan="2" text="기종"/>
						<cell col="7" display="text" font="굴림,9" rowspan="2" text="사양"/>
						<cell col="8" display="text" font="굴림,9" rowspan="2" text="구분"/>
						<cell col="9" colspan="4" display="text" font="굴림,9" text="무상공사"/>
						<cell col="13" colspan="4" display="text" font="굴림,9" text="무상일반"/>
						<cell col="17" display="text" font="굴림,9" rowspan="2" text="기성지급월"/>
						<cell col="9" display="text" font="굴림,9" row="1" text="예산개월수"/>
						<cell col="10" display="text" font="굴림,9" row="1" text="사용개월수"/>
						<cell col="11" display="text" font="굴림,9" row="1" text="개시일"/>
						<cell col="12" display="text" font="굴림,9" row="1" text="만료일"/>
						<cell col="13" display="text" font="굴림,9" row="1" text="예산개월수"/>
						<cell col="14" display="text" font="굴림,9" row="1" text="사용개월수"/>
						<cell col="15" display="text" font="굴림,9" row="1" text="개시일"/>
						<cell col="16" display="text" font="굴림,9" row="1" text="만료일"/>
					</head>
					<body>
						<cell col="0" colid="CHK" display="checkbox" edit="checkbox"/>
						<cell align="center" col="1" display="text" expr="currow+1"/>
						<cell align="center" col="2" colid="PJT" display="text"/>
						<cell align="center" col="3" colid="HNO" display="text"/>
						<cell align="left" col="4" colid="HNA" display="text"/>
						<cell align="center" col="5" colid="SEQ" display="text"/>
						<cell align="center" col="6" colid="ZSPEC1" display="text"/>
						<cell align="left" col="7" colid="ZSPEC2" display="text"/>
						<cell align="center" col="8" colid="GND_NM" display="text"/>
						<cell align="center" col="9" colid="ZMUSAOCNT" display="text"/>
						<cell align="center" col="10" colid="ZMUSAUCNT" display="text"/>
						<cell align="center" col="11" colid="BGT_A" display="text" Mask="####.##.##"/>
						<cell align="center" col="12" colid="BMT_A" display="text" Mask="####.##.##"/>
						<cell align="center" col="13" colid="ZMUSAOCNT2" display="text"/>
						<cell align="center" col="14" colid="ZMUSAUCNT2" display="text"/>
						<cell align="center" col="15" colid="BGT_B" display="text" Mask="####.##.##"/>
						<cell align="center" col="16" colid="BMT_B" display="text" Mask="####.##.##"/>
						<cell align="center" col="17" colid="CS136_GYM" display="text"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Div Height="36" Id="div_btn" TabOrder="2" Text="Div0" ToolTipFont="Default,0" Url="WB01::CommBtnForm.xml" Width="792">
			<Contents></Contents>
		</Div>
		<Static Align="Center" Height="24" Id="st_irum" Left="9" Style="sty_lb_form_basic" TabOrder="4" Text="결재번호" Top="41" VAlign="Middle" Width="64"></Static>
		<Static Align="Center" Height="24" Id="Static0" Left="434" Style="sty_lb_form_basic" TabOrder="5" Text="현장명" Top="41" VAlign="Middle" Width="80"></Static>
		<Edit BindDataset="ds_head_div" Border="Flat" Column="ZSITE_NM" Enable="FALSE" Height="20" Id="ed_zsite_nm" Left="516" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="6" Top="43" Width="260"></Edit>
		<Static Align="Center" Height="24" Id="Static2" Left="203" Style="sty_lb_form_basic" TabOrder="7" Text="고객명" Top="41" VAlign="Middle" Width="80"></Static>
		<Shape BKColor="user12" Bottom="379" Height="51" Id="Shape6" Left="7" LineColor="user13" Right="779" TabOrder="8" Top="328" Type="Rectangle" Width="772"></Shape>
		<Static Align="Center" Height="49" Id="st_vkgrp" Left="89" Style="sty_lb_form_basic" TabOrder="9" Text="당사요구안" Top="329" VAlign="Middle" Width="80"></Static>
		<Static Align="Center" Height="24" Id="st_rmk" Left="8" Style="sty_lb_form_basic" TabOrder="11" Text="계약예정일" Top="404" VAlign="Middle" Width="161"></Static>
		<Static Align="Center" Height="24" Id="st_cdate" Left="89" Style="sty_lb_form_basic" TabOrder="12" Text="협의결과" Top="379" VAlign="Middle" Width="80"></Static>
		<Static Align="Center" Height="74" Id="st_gbn" Left="8" Style="sty_lb_form_basic" TabOrder="10" Text="사유" Top="329" VAlign="Middle" Width="80"></Static>
		<Shape BKColor="user12" Bottom="329" Height="26" Id="Shape2" Left="7" LineColor="user13" Right="779" TabOrder="15" Top="303" Type="Rectangle" Width="772"></Shape>
		<Static Align="Center" Height="24" Id="Static1" Left="89" Style="sty_lb_form_basic" TabOrder="16" Text="사유" Top="304" VAlign="Middle" Width="80"></Static>
		<Static Align="Center" Height="24" Id="Static4" Left="586" Style="sty_lb_form_basic" TabOrder="17" Text="작성일" Top="304" VAlign="Middle" Width="80"></Static>
		<Static Align="Center" Height="24" Id="Static5" Left="393" Style="sty_lb_form_basic" TabOrder="19" Text="중도해지일" Top="304" VAlign="Middle" Width="80"></Static>
		<Static Align="Center" Height="24" Id="Static6" Left="8" Style="sty_lb_form_basic" TabOrder="18" Text="구분&#32;" Top="304" VAlign="Middle" Width="80"></Static>
		<Combo BindDataset="ds_head_div" BKColor="khaki" Border="Flat" CodeColumn="CODE" Column="GBN" DataColumn="CODE_NAME" DisableBKColor="user5" Height="20" Id="cb_gbn" InnerDataset="ds_gbn" Left="169" Style="sty_ipt_form" TabOrder="20" Top="305" Width="223"></Combo>
		<Calendar BindDataset="ds_head_div" BKColor="khaki" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="JID" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Enable="FALSE" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_jid" Left="668" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="21" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="306" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="110"></Calendar>
		<Calendar BindDataset="ds_head_div" BKColor="khaki" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="JHD" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_jhd" Left="475" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" OnChanged="cal_jhd_OnChanged" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="22" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="306" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="110"></Calendar>
		<Edit BindDataset="ds_head_div" Border="Flat" Column="KUNNR_NM" Enable="FALSE" Height="20" Id="ed_kunnr_nm" Left="285" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="23" Top="43" Width="147"></Edit>
		<Static Align="Center" Height="49" Id="Static3" Left="393" Style="sty_lb_form_basic" TabOrder="24" Text="고객요구안" Top="329" VAlign="Middle" Width="80"></Static>
		<Edit BindDataset="ds_head_div" Border="Flat" CheckLength="Byte" Column="REQ" Height="20" Id="ed_req" Left="170" LeftMargin="4" MaxLength="100" Style="sty_ipt_form" TabOrder="25" Top="381" Width="606"></Edit>
		<Calendar BindDataset="ds_head_div" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="RPD" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_rpd" Left="170" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="26" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="406" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="110"></Calendar>
		<Edit BindDataset="ds_head_div" Border="Flat" Column="NUM" Enable="FALSE" Height="20" Id="ed_num" Left="74" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="27" Top="43" Width="127"></Edit>
		<Edit Height="21" Id="cal_bgt" Left="8" TabOrder="28" Text="발주개시일" Top="456" Visible="FALSE" Width="65"></Edit>
		<Edit Height="21" Id="cal_bmt" Left="80" TabOrder="29" Text="발주만료일" Top="456" Visible="FALSE" Width="65"></Edit>
		<Edit Height="21" Id="ed_gnd" Left="152" TabOrder="30" Text="발주구분" Top="456" Visible="FALSE" Width="57"></Edit>
		<Edit Height="21" Id="ed_doctype" Left="216" TabOrder="31" Text="전자결재문서유형" Top="456" Visible="FALSE" Width="106"></Edit>
		<Edit Height="21" Id="ed_tem" Left="328" TabOrder="32" Text="팀코드" Top="456" Visible="FALSE" Width="58"></Edit>
		<TextArea BindDataset="ds_head_div" BKColor="khaki" Border="Flat" Column="REQE" Height="45" Id="ed_reqe" Left="170" Style="sty_ipt_form" TabOrder="33" Top="331" Width="221"></TextArea>
		<TextArea BindDataset="ds_head_div" BKColor="khaki" Border="Flat" Column="REQC" Height="45" Id="ed_reqc" Left="474" Style="sty_ipt_form" TabOrder="34" Top="331" Width="301"></TextArea>
		<Static Align="Center" Height="24" Id="Static7" Left="392" Style="sty_lb_form_basic" TabOrder="35" Text="결재상태" Top="404" VAlign="Middle" Width="81"></Static>
		<Combo Border="Flat" CodeColumn="CODE" DataColumn="DTEXT1" Enable="FALSE" Height="20" Id="cb_apstat" InnerDataset="ds_apstat_cb" Left="473" Style="sty_ipt_form" TabOrder="36" Top="406" Width="111"></Combo>
		<Button ButtonStyle="TRUE" Cursor="HAND" Enable="FALSE" Height="22" Id="btn_modify" ImageID="btn_user_09" Left="680" OnClick="btn_modify_OnClick" Style="sty_btn" TabOrder="37" Text="해지일&#32;수정" Top="406" Transparent="TRUE" Visible="FALSE" Width="88"></Button>
	</Form>
	<Script><![CDATA[﻿﻿﻿﻿﻿﻿﻿/*
 ******************************************************************************************
 * 기      능   : 
 * 작  성  자   : 
 * 작성  일자   : 
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
#include "LIB::commons.js";	// 공통 스크립트 
#include "LIB::common_cs.js";	// 서비스 공통 스크립트
//=========================================================================================
// [ PART 1 ]
// Form에서 사용될 전역변수를 선언
// FORM에서 사용되는 전역변수는 대문자로 작성하며, F_XXX 의 형태를 갖도록 한다. 
//=========================================================================================
var fa_docno;
var vDPT = "";
var jhd_auth = true; // 중도해지일 및 해지사유 수정권한 Flag
//=========================================================================================
// [ PART 2 ]
// Form Loading / Unloading 시 작업 정의
//=========================================================================================
function fn_OnLoadCompleted(obj) {
	gfn_initForm();
	//============== 수신부서 결재그룹 체크 ===============================	
	gfn_initDs(ds_rcond, true);
	ds_rcond.SetColumn(0, "ZPROGRAM", "WBAP_DOCKIND");
	ds_rcond.SetColumn(0, "GBN", "01");	
	vDPT = gfn_getAuthDpt(ds_rcond);
	ds_rcond.ClearData();
    //========================================================= 

    //============== 사유 및 중도해지 일자 수정권한 체크 ===============================	
	gfn_initDs(ds_rcond, true);
	ds_rcond.SetColumn(0, "ZPROGRAM", "CS1104001D");
	ds_rcond.SetColumn(0, "GBN", "01");	
	jhd_auth = gfn_getAuth(ds_rcond);
	ds_rcond.ClearData();
	//=================================================================================	 
	       
	fn_init();
	// 초기화 완료메시지
	gfn_showMsg("CI00007");
	
	//==================CRM 전환 관련 안내문구 추가 2021.05.13 HJH================================
	gfn_showAlert("CI30001", "5월 10일부터는 S-CRM으로 서비스 영업 계약을 진행요청 드리며," +
							 "\n\n개선 요청 및 문제점에 대하여서는 기존과 같이 BS포탈 우측 상단 메인 메뉴 " + 
							 "\n\n[문의/개선 요청 게시판]에 자유로운 피드백 작성 및 공지사항의 담당자 에게 발송 송부 바랍니다. " +
							 "\n5월 17일 부터는 SRM의 계약메뉴 사용은 각 지역 담당별로 순차적으로 확대하여 중단 진행 예정입니다."
							 
				  );	
	//============================================================================================		
}
function fn_init() {
	
	if(length(ed_num.Text) > 0){
		fa_docno=ed_num.Text;
	}
		
	if( isExistVar("fa_docno",true) == 1 && length(fa_docno) > 0) {
		ds_head_div.SetColumn(0, "NUM", fa_docno);
	}
	
	div_btn.btn_decide.Enable 	= false;	// 결재버튼
	div_btn.btn_draft.Enable  	= false;	// 기안버튼
	div_btn.btn_print.Enable  	= false;	// 출력버튼
	div_btn.btn_sendback.Enable = false;  	// 반송버튼
	
	// 해더 display 셋팅 
	if(  isExistVar("fa_docno",true) == 1 && length(fa_docno) > 0 ) {
		// disabled
		ed_zsite_nm.Enable = false;
		ed_kunnr_nm.Enable = false;
		ed_num.Enable      = false;
		cal_bgt.Enable     = false;
		cal_bmt.Enable     = false;
		cal_jhd.Enable     = false;
		cal_jid.Enable     = false;
		cb_gbn.Enable 	   = false;
		ed_tem.Enable      = false;
		ed_reqe.Enable     = false;
		ed_reqc.Enable     = false;
		ed_req.Enable      = false;
		cal_rpd.Enable     = false;
		div_btn.btn_draft.Enable = false;
	} else {		
	
		var cRow 		  = parent.ds_mst.GetCurrow();
		ed_zsite_nm.Text  = parent.ds_mst.GetColumn(cRow, "ZSITE_NM");
		ed_kunnr_nm.Text  = parent.ds_mst.GetColumn(cRow, "KUNNR_NM");
		ed_gnd.Text       = parent.ds_mst.GetColumn(cRow, "GND");
		cal_bgt.Text      = parent.ds_mst.GetColumn(cRow, "BGT");
		cal_bmt.Text      = parent.ds_mst.GetColumn(cRow, "BMT");
		cal_jid.Text      = gfn_getCurrDate();
		cb_gbn.Index 	  = 0;
		
		ed_tem.Text       = parent.ds_mst.GetColumn(cRow, "TEM");
		ed_num.Text       = '';					// 전자결재문서번호
		ed_doctype.Text   = 'H08';				// 전자결재문서유형
		
		// 중도해지관리번호가 있는경우 중도해지를 할 수 없다.
		// 중도해지는 청구등록기안완료된 건만 가능하다.
		// 중복 중도해지는 할 수 없다.
		// 자동발주도 중도해지할수 있다.
		
	
		var user_grp = gfn_getUserGroup();
		
		if( user_grp > "10" || length(G_DPT1) > 0 ) // 내부직원 작성가능
		{
			//if( parent.ds_mst.GetColumn(cRow, "PST") == 'A6' && (parent.ds_mst.GetColumn(cRow, "APSTAT") == '6'||parent.ds_mst.GetColumn(cRow, "APSTAT") == 'XX') ) {
			if( parent.ds_mst.GetColumn(cRow, "PST") == 'A6' || parent.ds_mst.GetColumn(cRow, "APSTAT") == 'XX' ) {
				div_btn.btn_draft.Enable = true;
			} else {
				div_btn.btn_draft.Enable = false;
			}
		} else {
			div_btn.btn_draft.Enable = false;
		}
		
	}
	
	// 결재상태공통코드조회
	var codeArr    = ["WBAP_STAT"];
	var dsObjArr   = [ds_apstat_cb];
	var addTypeArr = [G_CODE_NONE];
	gfn_searchCommCode(codeArr, dsObjArr, addTypeArr);
	
	
	fn_query();
	// 초기화 완료메시지
	gfn_showMsg("CI00007");
}


/********************************************************************************
* 기      능   : 공통코드가 조회된 후의 Callback 함수 
********************************************************************************/
function fn_completeInit(sCode, sDsObj, sCodeType) {
	cb_apstat.value = 0;
}
/********************************************************************************
* 기      능   : form UnloadCompleted 
********************************************************************************/
function fn_OnUnloadCompleted(obj) {
	return gfn_isFormUnload(obj);
}
//=========================================================================================
// [ PART 3 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,form닫기)
//=========================================================================================
/********************************************************************************
* 기      능   : 조회 1
********************************************************************************/
function fn_query() {

	gfn_clearMsgBar();
	
	if( length(trim(ed_num.Text)) > 0 ) {	// 문서함 상세조회
		fn_searchQuery();

		// Display Change
		grd_list_div.SetCellProp("head", 0, "Edit", "none");
		grd_list_div.SetCellProp("body", 0, "Edit", "none");
		grd_list_div.SetCellProp("head", 0, "Display", "");
		grd_list_div.SetCellProp("body", 0, "Display", "");

	} else {
		var _dataSet = parent.ds_dtl;
		
		ds_list_div.row = -1;
		ds_list_div.ClearData();
		for( var i = 0; i < _dataSet.RowCount(); i++ ) {
			ds_list_div.AddRow();
			
			ds_list_div.SetColumn(i, "PJT", 		_dataSet.GetColumn(i, "PJT") 		);
			ds_list_div.SetColumn(i, "HNO", 		_dataSet.GetColumn(i, "HNO") 		);
			ds_list_div.SetColumn(i, "SEQ", 		_dataSet.GetColumn(i, "SEQ") 		);
			ds_list_div.SetColumn(i, "HNA", 		_dataSet.GetColumn(i, "HNA")		);
			ds_list_div.SetColumn(i, "ZSPEC", 		_dataSet.GetColumn(i, "ZSPEC") 		);
			ds_list_div.SetColumn(i, "ZSPEC1", 		_dataSet.GetColumn(i, "ZSPEC1") 	);
			ds_list_div.SetColumn(i, "ZSPEC2", 		_dataSet.GetColumn(i, "ZSPEC2") 	);
			ds_list_div.SetColumn(i, "GND", 		_dataSet.GetColumn(i, "GND") 		);
			ds_list_div.SetColumn(i, "GND_NM", 		_dataSet.GetColumn(i, "GND_NM") 	);
			ds_list_div.SetColumn(i, "ZMUSAOCNT", 	_dataSet.GetColumn(i, "ZMUSAOCNT") 	);
			ds_list_div.SetColumn(i, "ZMUSAOCNT2", 	_dataSet.GetColumn(i, "ZMUSAOCNT2") );
			ds_list_div.SetColumn(i, "ZMUSAUCNT", 	_dataSet.GetColumn(i, "ZMUSAUCNT") 	);
			ds_list_div.SetColumn(i, "ZMUSAUCNT2", 	_dataSet.GetColumn(i, "ZMUSAUCNT2") );
			ds_list_div.SetColumn(i, "BGT_A", 		_dataSet.GetColumn(i, "BGT_A") 		);
			ds_list_div.SetColumn(i, "BGT_B", 		_dataSet.GetColumn(i, "BGT_B") 		);
			ds_list_div.SetColumn(i, "BMT_A", 		_dataSet.GetColumn(i, "BMT_A") 		);
			ds_list_div.SetColumn(i, "BMT_B", 		_dataSet.GetColumn(i, "BMT_B") 		);
			ds_list_div.SetColumn(i, "BGT", 		_dataSet.GetColumn(i, "BGT") 		);
			ds_list_div.SetColumn(i, "BMT", 		_dataSet.GetColumn(i, "BMT") 		);
			ds_list_div.SetColumn(i, "ENDDATE",		"" 		);
			ds_list_div.SetColumn(i, "CS136_GYM",   _dataSet.GetColumn(i, "CS136_GYM")  ); // 기성지급 여부 체크 20150512 이하림
			ds_list_div.SetColumn(i, "BST", 		_dataSet.GetColumn(i, "BST") 		);
		}
	}
}
/********************************************************************************
* 기      능   : 중도해지관리번호에 의한 상세조회 1
********************************************************************************/
function fn_searchQuery() {
	ds_cond_div.row = -1;
	ds_cond_div.ClearData();
	
	ds_cond_div.AddRow();
	ds_cond_div.SetColumn(0, "NUM", fa_docno);
	ds_cond_div.SetColumn(0, "DNO", fa_docno);
    ds_cond_div.SetColumn(0, "DOCNO", fa_docno);

	tit_clearActionInfo();
	// 결재진행여부확인조회
	tit_addSearchActionInfo("cs11:CS1104001D_S3");
	// 상세조회
	tit_addSearchActionInfo("cs11:CS1104001D_S1");
	// 결재자조회
	tit_addSearchActionInfo("cs11:CS1101001B_S9");
	tit_callService(
		  ""
		, ""
		, "ds_cond=ds_cond_div"
		, "ds_list_div=ds_list ds_decide=ds_decide ds_check=ds_cnt"
		, ""
		, "ufn_afterQuery"
		, true);
}
function ufn_afterQuery(errCode, errMsg) {
	// 메시지 처리 
	// gfn_showSearchMsg(grd_list_div);
	
	if( ds_list_div.GetRowCount() > 0 ) {
		var cRow = 0;
		ed_zsite_nm.Text = ds_list_div.GetColumn(cRow, "ZSITE_NM");
		ed_kunnr_nm.Text = ds_list_div.GetColumn(cRow, "KUNNR_NM");
		cal_bgt.Text     = ds_list_div.GetColumn(cRow, "BGT");
		cal_bmt.Text     = ds_list_div.GetColumn(cRow, "BMT");
		cal_jhd.value    = ds_list_div.GetColumn(cRow, "JHD");
		cal_jid.value    = ds_list_div.GetColumn(cRow, "JID");
		cb_gbn.value 	 = ds_list_div.GetColumn(cRow, "JGBN");
		ed_tem.Text      = ds_list_div.GetColumn(cRow, "TEM");
		ed_reqe.Text     = ds_list_div.GetColumn(cRow, "REQE");
		ed_reqc.Text     = ds_list_div.GetColumn(cRow, "REQC");
		ed_req.Text      = ds_list_div.GetColumn(cRow, "REQ");
		cal_rpd.value    = ds_list_div.GetColumn(cRow, "RPD");
		cb_apstat.value  = ds_list_div.GetColumn(0,    "APSTAT");
		
		

		// 결재선 등록
		var user_grp = gfn_getUserGroup();
		if( user_grp > "10" || length(G_DPT1) > 0 ) // 내부직원 작성가능
		{
			// 결재상태
			cb_apstat.Visible = true;
			
			// 기안자 접수자는 화면에서 결재선 지정
			// 반송된 것도 재기안 가능하게 해달라 ( BY 최인식 과장 2014.12.16)
			//if (parseInt(ds_list_div.GetColumn(0,"APSTAT")) == 0 || (ds_list_div.GetColumn(0,"APSTAT") == "3" && ds_list_div.GetColumn(0,"REDPT1") == G_DPT1))
			if (parseInt(ds_list_div.GetColumn(0,"APSTAT")) == 0 || (ds_list_div.GetColumn(0,"APSTAT") == "3" && ds_list_div.GetColumn(0,"REDPT1") == vDPT))
			{
				div_btn.btn_draft.Enable  = true;
			} else {
			
				// 반송의 경우 반송이외의 기안진행중이거나 처리완료된건이 있는 경우 비활성화
				// 단, 중도해지팝업에선 무조건 비활성화. 중도해지번호를 파라미터로 받는경우도 비활성(신규로 등록해야하기때문)
				if(	(parseInt(ds_list_div.GetColumn(0,"APSTAT")) == 2 || parseInt(ds_list_div.GetColumn(0,"APSTAT")) == 5) && parseInt(ds_check.GetColumn(0, "CNT")) == 0  && (isExistVar("fa_popupGbn",true)==0) && (isExistVar("fa_docno",true)==0) ) {
					div_btn.btn_draft.Enable  = true;
				} else {
					div_btn.btn_draft.Enable  = false;
				}
				
			}
			
			/* 출력공통정보조회 */
			ufn_getApprovalData();
			
		} else 
		{
			//div_btn.btn_draft.Visible = false;
			div_btn.btn_draft.Enable  = false;
		}
		
		// 기안진행(1), 수신진행(4) 일때 결재자일때 결재버튼 활성화.
		if( (ds_list_div.GetColumn(0,"APSTAT") > '0' && ds_list_div.GetColumn(0,"APSTAT") != '3' && ds_list_div.GetColumn(0,"APSTAT") < '6') && ds_decide.rowcount > 0 && G_USER_ID == substr(ds_decide.GetColumn(0, "APNUM"),1) ) {
			div_btn.btn_decide.Enable = true;
			div_btn.btn_sendback.Enable = true;
		} else {
			div_btn.btn_decide.Enable = false;
			div_btn.btn_sendback.Enable = false;
		}
	}
	// 담당자에 한해서 중도해지일 변경 가능 처리 
	if(jhd_auth == true) {
		cal_jhd.Enable = true;
		btn_modify.Visible = true;
		btn_modify.Enable = true;	
	}
}
/* 출력공통정보조회 */
function ufn_getApprovalData () {
	ds_conf_cond.SetColumn(0, "DOCNO", ed_num.Text);	
	
	tit_clearActionInfo();
	tit_addSearchActionInfo("wb01:DOC_CONF_S1");
	tit_addSearchActionInfo("wb01:DOC_CONF_S2");
	tit_callService(
		""
		, ""
		, "ds_conf_cond=ds_conf_cond"
		, "ds_conf_list=ds_conf_list ds_draftpers_list=ds_draftpers_list"
		, ""
		, ""
		, true);
}

/********************************************************************************
* 기      능   : 기안 (중도해지)
********************************************************************************/
function process() {

	if( ds_list_div.rowCount() < 1 ) {
		// 승인할 정보 없음. 
		return;
	}
	
	tit_clearActionInfo();
	
	// 무상발주중도해지 insert(ZCST623)
	tit_addSaveActionInfo(
		  ""
		, "cs11:CS1104001D_I1"
		, ""
		, "FLAG");

	tit_callService(
          ""
        , ""
        , "ds_list=ds_list_div:A"
        , ""
        , ""
        , "fn_afterDraft");
}
function ufn_validation() {
	/* 	1) 프로젝트 호기별로 중도해지일자를 기준으로 중도해지일의 해당년월에 해당하는
		   기성비확정건이 있는 경우 ALERT('기성비가 이미 처리되었습니다. 처리될 수 없습니다.')
		2) 계약예정일은 기능은 없고 단지 참조정보이다.
		3) 사유, 해지일, 작성일, 당사요구안, 고객요구안은 필수항목이다.
		4) 계약예정일은 중도해지일보다 커야한다.
		5) 중도해지일 해당월 이후의 데이터가 기성비처리가 되지 않은경우 해당월포함이후 데이터까지 
		   중도해지시킨다.
		6) CEIL(발주개시일 - 중도해지일) => 사용개월수 업데이트
		   1일이라도 차이가 나면 그 해당월에 대하여 사용된 것으로 본다.
		   (ZMASTER02 사용개월수 1개월)
	 */ 
	gfn_clearMsgBar();

	if( ds_list_div.FindRow("CHK", 1) == -1 ) {
		gfn_showAlert("CW00013");
		return false;
	}

	// 20130927 김재순CJ 요청(서비스관리부 이세희만 발주중지등록 가능하도록)
	/*
	if(G_USER_ID == "2018454" || G_USER_ID == "T018454" 
	|| G_USER_ID == "2021153" || G_USER_ID == "T021153"  //임유진-고객지원부 
	|| G_USER_ID == "2017938" || G_USER_ID == "T017938" 
	|| G_USER_ID == "2017750" || G_USER_ID == "2021200" 
	|| G_USER_ID == "2018519" || G_USER_ID == "3014312" 
	|| G_USER_ID == "3016544" || G_USER_ID == "2019175" || G_USER_ID == "3018679") {
		//alert("OK");
	} else {
		gfn_showAlert("무상발주중지 작업은 서비스관리부 권한입니다. 서비스관리부에 문의 바랍니다.");
		return false;
	}
	*/
	
	/* 중도해지사유 */
	if( gfn_isNull(cb_gbn, true) ) {
		gfn_showAlert("CW00001", "중도해지사유");
		return false;
	}
	
	/* 중도해지일 */
	if( gfn_isNull(cal_jhd, true) ) {
		gfn_showAlert("CW00001", "중도해지일");
		return;
	}
	
	/* 작성일 */
	if( gfn_isNull(cal_jid, true) ) {
		gfn_showAlert("CW00001", "작성일");
		return false;
	}
	
	/* 당사요구안 */
	if( gfn_isNull(ed_reqe, true) ) {
		gfn_showAlert("CW00001", "당사요구안");
		return false;
	}
	
	/* 고객요구안 */
	if( gfn_isNull(ed_reqc, true) ) {
		gfn_showAlert("CW00001", "고객요구안");
		return false;
	}

	/* 계약예정일은 중도해지일보다 커야한다. */
	if( length(trim(cal_rpd.value)) > 0 && cal_jhd.value > cal_rpd.value ) {
		gfn_showAlert("계약예정일이 중도해지일보다 작습니다.");
		return false;
	}
	// 마감일자 체크 ( 시스템일자 기준 전월말일자 )
	var closeDate =  gfn_getLeapLastDay(gfn_getBeforeMonth(substr(gfn_getCurrDate(),0,6),1)+"01");

	for( var i = 0; i < ds_list_div.GetRowCount(); i++ ) {
	
		if( ds_list_div.GetColumn(i,"CHK") == true ) {
			var bgt = ds_list_div.GetColumn(i, "BGT");	// 발주개시일
			var bmt = ds_list_div.GetColumn(i, "BMT");	// 발주만료일
			var bhd = cal_jhd.value;					// 중도해지일
			var gym = ds_list_div.GetColumn(i, "CS136_GYM");	// 기성지급월
			var bhd_l = gfn_getLeapLastDay(bhd) ;               // 중도해지 요청 년월의 마지막 일자
			var bst = ds_list_div.GetColumn(i, "BST");	// 승인일자 
			var idq = 0 ;
			
			// 기성 지급된 년월로는 중도해지 기안 불가 20150527 이하림
			if(gym != "") { 
				// 가장 최근에 지급된 기성년월의 마지막일자가 아닌 경우는 중도해지 불가
				if (gym == substr(bhd,0,6) and bhd != bhd_l){
					gfn_showAlert(i+1+ "번째 호기는 " +gym+ " 기성 지급이 완료되어 중도해지가 불가합니다.");
					return false;
				}
				// 가장 최근에 지급된 기성년월 이전년월로 입력한 경우 중도해지 불가
				if (gym > substr(bhd,0,6)){
					gfn_showAlert(i+1+ "번째 호기는 " +gym+ " 기성 지급이 완료되어 "+substr(bhd,0,6)+" 중도해지가 불가합니다.");
					return false;
				}						
			}
			// 마감일 이전에 승인된 데이터의 경우 체크 
			if(bst <= closeDate) {
				//마감일 체크 	 20170309 이하림 
				if(closeDate > bhd) {
					gfn_showAlert("요청하신 중도해지월은 이미 마감되었습니다. ");
					return false;
				}			
			}
			
			// 중도해지일은 발주개시일과 발주만료일 사이에 있어야한다.
			if( bgt > bhd ) {
				gfn_showAlert("중도해지일은 발주개시일보다 작을수 없습니다.");
				return false;
			}
			if( bhd > bmt ) {
				gfn_showAlert("중도해지일은 발주만료일보다 클수 없습니다.");
				return false;
			}
			
			// 사용개월수( 하루라도 차이가 있으면 무조건 올림처리로 개월수를 측정한다. ) by 최인식과장
			var mg1 = gfn_getMonthCnt( ds_list_div.GetColumn(i, "BGT"), cal_jhd.value );
			if( parseInt(mg1) == 0 ) {
				mg1 = "1";
			}
			/*
			if( parseInt(mg1) <= 0 ) {
				gfn_showAlert("사용개월수는 0보다 커야합니다.");
				return false;
			} */
			
			ds_list_div.SetColumn(i, "FLAG", 	"U");						// 업데이트 대상
			ds_list_div.SetColumn(i, "MG1", 	mg1 );						// 사용개월수(중도해지일-발주개시일)
			ds_list_div.SetColumn(i, "ENDDATE", cal_jhd.value);				// 중도해지일
			ds_list_div.SetColumn(i, "JYM",     substr(cal_jhd.value,0,6));	// 중도해지년월
			ds_list_div.SetColumn(i, "JHD",     cal_jhd.value); 			// 중도해지일
			ds_list_div.SetColumn(i, "JID",     cal_jid.value); 			// 작성일
			ds_list_div.SetColumn(i, "GCD",     cb_gbn.value); 				// 사유구분코드
			ds_list_div.SetColumn(i, "REQE",    ed_reqe.Text); 				// 당사요구안
			ds_list_div.SetColumn(i, "REQC",    ed_reqc.Text); 				// 고객요구안
			ds_list_div.SetColumn(i, "REQ",     ed_req.Text); 				// 협의결과
			ds_list_div.SetColumn(i, "RPD",     cal_rpd.value); 			// 계약예정일
			
			// 보수대상호기마스터 업데이트시  발주구분에 따른 업데이트 조건구분
			if( ds_list_div.GetColumn(i, "GND") == "A" )      { //무상공사
				if( ds_list_div.GetColumn(i, "SEQ") == "0001" ) {
					ds_list_div.SetColumn(i, "GBN", "A");
				} else {
					ds_list_div.SetColumn(i, "GBN", "B");
				}
			} 
			else if( ds_list_div.GetColumn(i, "GND") == "B" ) { //무상일반
				if( ds_list_div.GetColumn(i, "SEQ") == "0001" ) {
					ds_list_div.SetColumn(i, "GBN", "C");
				} else {
					ds_list_div.SetColumn(i, "GBN", "D");
				}
			}

			// IDQ( 지급승인금액-지급승인일수 )
			
			// 무상 개시월 = 만료 요청월 인 경우 IDQ 재계산 
			idq = parseInt(substr(cal_jhd.value,6,2)) - parseInt(substr(bgt,6,2)) + 1 ;
			if( substr(bgt,0,6) == substr(cal_jhd.value,0,6) ) {
				ds_list_div.SetColumn( i, "IDQ", idq);
			} else {
				ds_list_div.SetColumn( i, "IDQ", idq);
			}
			
		}
	}
	
	return true;
}

/********************************************************************************
* 기      능   : 기안 (중도해지)
********************************************************************************/
function fn_draft() {
	
	// 수신부서기안처리시.
	if( cb_apstat.value == '3' ) {
		ufn_draftPopupOpen();
	} else {
		ufn_draft();
	}
}
function ufn_draft() {
	if( !ufn_validation() ) {
		return;
	} 
	ufn_getDocNo();
}
/* 전자결재문서번호채번 */
function ufn_getDocNo() {
	ds_docno_gen.row = -1;
	ds_docno_gen.ClearData();							
	ds_docno_gen.AddRow();							
	ds_docno_gen.SetColumn(0, "PFX", ed_doctype.Text); // H01, H02 … R01, R02 …		
								
	tit_clearActionInfo();							
	tit_addSearchActionInfo("wb01:DOC_CODE_GEN_S1", true);							
	tit_addSearchActionInfo("wb01:DOC_CODE_GEN_U1");							
	tit_callService(					
		, ""						
		, "ds_docno_gen_i=ds_docno_gen"						
		, "ds_docno_gen=ds_docno_gen_o"						
		, ""						
		, "ufn_setDocInfo"						
		, true);
}
/* 전자결재문서번호채번 Callback  */
function ufn_setDocInfo() {
	if ( ds_error.rowcount() > 0 ) {
		gfn_showMsg("CE00001");
	} else {
		ed_num.Text = ds_docno_gen.GetColumn(0, "DOCNO");
		gfn_showMsg("CI00003", '전자결재문서번호:' + ed_num.Text);
		//alert( '전자결재문서번호(ufn_setDocInfo):' + ed_num.Text );
		if( length(ed_num.Text) <= 0 ) {
			var arr = ["전자결재문서번호"];
			gfn_showMsg("CW00001", arr);
			return;
		}
		ufn_draftPopupOpen();
	}
}
function ufn_draftPopupOpen() {
	// 결재상태에 따른 수신/발신부서 구분처리
	var appgubn = "S";					// 내부부서 결재	
												
	if( cb_apstat.value == "3" ) {
		appgubn = "R";					// 수신부서 결재	=> 결재상태 
	}
	
	var docKind = '10';					// 결재종류
	var arg = "fa_docno=" + ed_num.Text + " fa_dockind =" + docKind + " fa_appgubn=" + quote(appgubn);				
	var returnArgs = gfn_openPopup2("CS0401001A", true, arg);
	if( returnArgs[0] == "S" ) {
		div_btn.btn_draft.Enable = false;
		
		if( appgubn == 'R') {
			if( cb_apstat.value == "3" ) {
				ds_cond_div.SetColumn(0, "DOCNO", ds_cond_div.GetColumn(0, "NUM"));
				
				// Validation			
				tit_clearActionInfo();
				// 결재자조회
				tit_addSearchActionInfo("cs11:CS1101001B_S11");
				tit_callService(
				  ""
				, ""
				, "ds_cond=ds_cond_div"
				, "ds_decide=ds_decide"
				, ""
				, "ufn_draftAndDecide"
				, true);
			} else {
				return;
			}
		} else {
			fn_afterDraftBefore();
		}
	}
	
	// (수신부서)기안반송처리
	if( cb_apstat.value == "3" && returnArgs[1] == 'S' ) {
		tit_clearActionInfo();	
		// 무상보수발주정보(zcst116) update (종결처리)
		tit_addMultiActionInfo("cs11:CS1104001D_U10");
	
		tit_callService(
			  ""
			, ""
			, "ds_list=ds_list_div" 
			, ""
			, ""
			, "fn_afterSendback"
			, true);
	}
	
}
/* 기안과 결재 동시처리 */
function ufn_draftAndDecide(errCode, errMsg) {
	// 최종기안과동시에 결재완료인경우처리
	if( ds_decide.rowcount > 0 && ds_decide.GetColumn(0, "APSTAT") == '6' ) { 
	
		if ( ds_error.rowcount() > 0 ) {
			gfn_showAlert("CE00001");
		} else {
			// 결재처리
			for( var i = 0; i < ds_list_div.GetRowCount(); i++ ) {
				var bgt = ds_list_div.GetColumn(i, "BGT");	// 발주개시일
				var bmt = ds_list_div.GetColumn(i, "BMT");	// 발주만료일
				var bhd = cal_jhd.value;					// 중도해지일
				
				// 중도해지일은 발주개시일과 발주만료일 사이에 있어야한다.
				if( bgt > bhd ) {
					gfn_showAlert("중도해지일은 발주개시일보다 작을수 없습니다.");
					return false;
				}
				if( bhd > bmt ) {
					gfn_showAlert("중도해지일은 발주만료일보다 클수 없습니다.");
					return false;
				}
		
				var mg1 = gfn_getMonthCnt( ds_list_div.GetColumn(i, "BGT"), cal_jhd.value );
				if( parseInt(mg1) == 0 ) {
					mg1 = "1";
				}
				/*
				if( parseInt(mg1) <= 0 ) {
					gfn_showAlert("사용개월수는 0보다 커야합니다.");
					return false;
				} */
				
				ds_list_div.SetColumn(i, "FLAG", 	"U");						// 업데이트 대상
				ds_list_div.SetColumn(i, "MG1", 	mg1 );						// 사용개월수(중도해지일-발주개시일)
				ds_list_div.SetColumn(i, "ENDDATE", bhd);						// 중도해지일
				ds_list_div.SetColumn(i, "JYM",     substr(cal_jhd.value,0,6));	// 중도해지년월
				ds_list_div.SetColumn(i, "JHD",     cal_jhd.value); 			// 중도해지일
				ds_list_div.SetColumn(i, "JID",     cal_jid.value); 			// 작성일
				ds_list_div.SetColumn(i, "GCD",     cb_gbn.value); 				// 사유구분코드
				ds_list_div.SetColumn(i, "REQE",    ed_reqe.Text); 				// 당사요구안
				ds_list_div.SetColumn(i, "REQC",    ed_reqc.Text); 				// 고객요구안
				ds_list_div.SetColumn(i, "REQ",     ed_req.Text); 				// 협의결과
				ds_list_div.SetColumn(i, "RPD",     cal_rpd.value); 			// 계약예정일

				
				// 보수대상호기마스터 업데이트시  발주구분에 따른 업데이트 조건구분
				if( ds_list_div.GetColumn(i, "GND") == "A" )      { //무상공사
					if( ds_list_div.GetColumn(i, "SEQ") == "0001" ) {
						ds_list_div.SetColumn(i, "GBN", "A");
					} else {
						ds_list_div.SetColumn(i, "GBN", "B");
					}
				} 
				else if( ds_list_div.GetColumn(i, "GND") == "B" ) { //무상일반
					if( ds_list_div.GetColumn(i, "SEQ") == "0001" ) {
						ds_list_div.SetColumn(i, "GBN", "C");
					} else {
						ds_list_div.SetColumn(i, "GBN", "D");
					}
				}
			}
			
			tit_clearActionInfo();
			if( cal_bgt.value == cal_jhd.value ) { //발주시작일(CS116_BGT) == 입력한 중도해지일
				
				// 기성비지급정보 update(ZCST136)
				tit_addMultiActionInfo("cs11:CS1104001D_U2");
				// 무상보수발주정보 select(ZCST116)
				tit_addSearchActionInfo("cs11:CS1104001D_S3", true);
				
				if( substr(cal_jhd.value,6,8) == "01" ) {
					// 무상보수발주정보 update(ZCST116)
					tit_addMultiActionInfo("cs11:CS1104001D_U8");
				} else {
					// 무상보수발주정보 update(ZCST116)
					tit_addMultiActionInfo("cs11:CS1104001D_U6");
				}
				// 무상보수발주정보 update(ZCST116) - 최종승인처리
				tit_addMultiActionInfo("cs11:CS1104001D_U11");
				
				// 보수대상호기마스터 update(ZCST111)
				tit_addMultiActionInfo("cs11:CS1104001D_U3");
			} 
			else { //발주시작일(CS116_BGT) <> 입력한 중도해지일
				
				// 기성비지급정보 update(ZCST136)
				tit_addMultiActionInfo("cs11:CS1104001D_U4");
				// 무상보수발주정보 update(ZCST116)- 20150207---추가
				tit_addMultiActionInfo("cs11:CS1104001D_U5");
				// 무상보수발주정보 update(ZCST116)
				tit_addMultiActionInfo("cs11:CS1104001D_U6");
				// 무상보수발주정보 update(ZCST116) - 최종승인처리
				tit_addMultiActionInfo("cs11:CS1104001D_U11");
				// 보수대상호기마스터 update(ZCST111)
				tit_addMultiActionInfo("cs11:CS1104001D_U7");
		
			}
			if(cb_gbn.value=="R02"){ // 중도해지 사유가 이관 일 경우 사용개월수 변경처리 20150408 이하림
				tit_addMultiActionInfo("cs11:CS1104001D_U9");
			}

			tit_callService(
				  ""
				, ""
				, "ds_list=ds_list_div"
				, ""
				, ""
				, "fn_afterDecide"
				, true);
		
		}
	}	
}
function fn_afterDraftBefore() {
	obj.fireevent = false;
	for( var i = 0; i < ds_list_div.RowCount(); i++ ) {
		if( ds_list_div.GetColumn(i, "CHK") == true ) { //체크박스가 true 일 경우
			ds_list_div.SetColumn(i, "NUM",  ed_num.Text);
		} 
	}
	obj.fireevent = true;
	process();
}
function fn_afterDraft(errCode, errMsg) {
	if ( ds_error.rowcount() > 0 ) {
		gfn_showMsg("CE00001");
	} else {
		gfn_showMsg("CI00003");
		fn_init();
		div_btn.btn_draft.Enable = false;
		div_btn.btn_decide.Enable = true;	// 결재버튼
	}
}

/********************************************************************************
* 기      능   : 삽입 20
********************************************************************************/
function fn_insert() {
	// 그리드에 row 추가 
	var newRow = gfn_addGridRow(grd_list_div, -1, "FLAG");
}
/********************************************************************************
* 기      능   : Delete 
********************************************************************************/
function fn_delete() {
	if ( ds_list_div.rowCount() < 1 ) {
		// 삭제할 정보 없음. 
		return;
	}
	// Grid 삭제 처리 
	gfn_deleteGridRow( grd_list_div, ds_list_div.row, "FLAG" );
}
/********************************************************************************
* 기      능   : 저장 
********************************************************************************/
function fn_save() {

}
/********************************************************************************
* 기      능   : 닫기  
********************************************************************************/
function fn_close() {
	close();
}
/********************************************************************************
* 기      능   : 액셀  
********************************************************************************/
function fn_excel() {
	// Excel Export 
	gfn_saveToExcel(grd_list_div, true );
}
/********************************************************************************
* 기      능   : 접수 5
********************************************************************************/
function fn_receipt() {

}
/********************************************************************************
* 기      능   : 승인 10
********************************************************************************/
function fn_approval() {

}
/********************************************************************************
* 기      능   : d결재 15
********************************************************************************/
function fn_decide() {

	gfn_clearMsgBar();

	if( ds_list_div.rowCount() < 1 ) {
		// 승인할 정보 없음. 
		return;
	}

	if( !gfn_showConfirm("CI00014", "문서번호 : "+ quote(ds_head_div.GetColumn(0,"NUM"))+ "결재") ) return;
	
	for( var i = 0; i < ds_list_div.GetRowCount(); i++ ) {
		var bgt = ds_list_div.GetColumn(i, "BGT");	// 발주개시일
		var bmt = ds_list_div.GetColumn(i, "BMT");	// 발주만료일
		var bhd = cal_jhd.value;					// 중도해지일
		var idq = 0;
		
		// 중도해지일은 발주개시일과 발주만료일 사이에 있어야한다.
		if( bgt > bhd ) {
			gfn_showAlert("중도해지일은 발주개시일보다 작을수 없습니다.");
			return false;
		}
		if( bhd > bmt ) {
			gfn_showAlert("중도해지일은 발주만료일보다 클수 없습니다.");
			return false;
		}

		var mg1 = "";
		//전확계획에 따른 중지일 경우 남은 개월수 모두 소진. 20150206 추가 함...!!!
		// 중도해지 사유가 이관일 경우만 추가발주 가능 20150323 이하림
		if(cb_gbn.value=="R01" || cb_gbn.value=="R03" || cb_gbn.value=="R99"){
			 mg1 = gfn_getMonthCnt( ds_list_div.GetColumn(i, "BGT"),  ds_list_div.GetColumn(i, "BMT") );
		} else {
			 mg1 = gfn_getMonthCnt( ds_list_div.GetColumn(i, "BGT"), cal_jhd.value );
			 if( parseInt(mg1) == 0 ) {
				mg1 = "1";
			}
		}

		/*
		if( parseInt(mg1) <= 0 ) {
			gfn_showAlert("사용개월수는 0보다 커야합니다.");
			return false;
		} */
		
		ds_list_div.SetColumn(i, "FLAG", 	"U");						// 업데이트 대상
		ds_list_div.SetColumn(i, "MG1", 	mg1 );						// 사용개월수(중도해지일-발주개시일)
		ds_list_div.SetColumn(i, "ENDDATE", cal_jhd.value);				// 중도해지일
		ds_list_div.SetColumn(i, "JYM",     substr(cal_jhd.value,0,6));	// 중도해지년월
		ds_list_div.SetColumn(i, "JHD",     cal_jhd.value); 			// 중도해지일
		ds_list_div.SetColumn(i, "JID",     cal_jid.value); 			// 작성일
		ds_list_div.SetColumn(i, "GCD",     cb_gbn.value); 				// 사유구분코드
		ds_list_div.SetColumn(i, "REQE",    ed_reqe.Text); 				// 당사요구안
		ds_list_div.SetColumn(i, "REQC",    ed_reqc.Text); 				// 고객요구안
		ds_list_div.SetColumn(i, "REQ",     ed_req.Text); 				// 협의결과
		ds_list_div.SetColumn(i, "RPD",     cal_rpd.value); 			// 계약예정일
		
		// 보수대상호기마스터 업데이트시  발주구분에 따른 업데이트 조건구분
		if( ds_list_div.GetColumn(i, "GND") == "A" )      { //무상공사
			if( ds_list_div.GetColumn(i, "SEQ") == "0001" ) {
				ds_list_div.SetColumn(i, "GBN", "A");
			} else {
				ds_list_div.SetColumn(i, "GBN", "B");
			}
		} 
		else if( ds_list_div.GetColumn(i, "GND") == "B" ) { //무상일반
			if( ds_list_div.GetColumn(i, "SEQ") == "0001" ) {
				ds_list_div.SetColumn(i, "GBN", "C");
			} else {
				ds_list_div.SetColumn(i, "GBN", "D");
			}
		}
		//------------------------------------------------------------------------------
		//----IDQ값 넣기....!!!
		// 무상 개시월 = 만료 요청월 인 경우 IDQ 재계산 
		idq = parseInt(substr(cal_jhd.value,6,2)) - parseInt(substr(bgt,6,2)) + 1 ;
		
		if( substr(bgt,0,6) == substr(cal_jhd.value,0,6) ) {
			ds_list_div.SetColumn( i, "IDQ", idq);
		} else {
			//ds_list_div.SetColumn( i, "IDQ", idq);
			ds_list_div.SetColumn( i, "IDQ", parseInt(substr(cal_jhd.value,6,2)) );
		}	

		//-----------------------------------------------------------------------------------
	}

	//tit_showDs(ds_list_div, false); ///return;

	
 	// 수신진행인 경우에만 진행한다. 	
 	tit_clearActionInfo();
 	if( ds_list_div.GetColumn(0,"APSTAT") == '4' ) {
		
		if( cal_bgt.value == cal_jhd.value ) { //발주시작일(CS116_BGT) == 입력한 중도해지일
				
			// 기성비지급정보 update(ZCST136)
			tit_addMultiActionInfo("cs11:CS1104001D_U2");
			// 무상보수발주정보 select(ZCST116)
			tit_addSearchActionInfo("cs11:CS1104001D_S3", true);
			
			if( substr(cal_jhd.value,6,8) == "01" ) {
				// 무상보수발주정보 update(ZCST116)
				tit_addMultiActionInfo("cs11:CS1104001D_U8");
			} else {
				// 무상보수발주정보 update(ZCST116)
				tit_addMultiActionInfo("cs11:CS1104001D_U6");
			}
			// 무상보수발주정보 update(ZCST116) - 최종승인처리
			tit_addMultiActionInfo("cs11:CS1104001D_U11");
			
			// 보수대상호기마스터 update(ZCST111)
			tit_addMultiActionInfo("cs11:CS1104001D_U3");
		} 
		else { //발주시작일(CS116_BGT) <> 입력한 중도해지일
			//alert("IDQ: "+ ds_list_div.GetColumn(0, "IDQ"));
			// 기성비지급정보 update(ZCST136)
			tit_addMultiActionInfo("cs11:CS1104001D_U4");
			
			// 무상보수발주정보 update(ZCST136)- 20150207---추가
			tit_addMultiActionInfo("cs11:CS1104001D_U5");
			// 기성비 일할 계산 20170525
			tit_addMultiActionInfo("cs11:CS1104001D_U5B");
			
			// 무상보수발주정보 update(ZCST116)
			tit_addMultiActionInfo("cs11:CS1104001D_U6");
			// 무상보수발주정보 update(ZCST116) - 최종승인처리
			tit_addMultiActionInfo("cs11:CS1104001D_U11");
			// 보수대상호기마스터 update(ZCST111)
			tit_addMultiActionInfo("cs11:CS1104001D_U7");
	
		}
		if(cb_gbn.value=="R02"){  // 중도해지 사유가 이관 일 경우 사용개월수 변경처리 20150408 이하림
			tit_addMultiActionInfo("cs11:CS1104001D_U9");
		}
	}
	
	 /*
	 alert("IDQ: "+ ds_list_div.GetColumn(0, "IDQ"));
	 alert("9----"+ds_list_div.GetColumn(0, "PJT"));
	 alert(ds_list_div.GetColumn(0, "HNO"));
	 alert(ds_list_div.GetColumn(0, "SEQ"));
	 alert(ds_list_div.GetColumn(0, "ISR"));
	 alert(ds_list_div.GetColumn(0, "GND"));
	 alert(ds_list_div.GetColumn(0, "JYM"));
	 return;
	 */
	 	
	// 결재상태변경
	ds_decide.SetColumn(0, "SEQSTAT", "3");
	// 결재정보 관리 - 차순별 결재정보  update(zwbap02)
 	tit_addMultiActionInfo("cs04:CS0401002A_U2");
 	// 현장지원 결재 정보 관리 update(zwbap01)
 	tit_addMultiActionInfo("cs04:CS0401002A_U3");
	tit_callService(
		  ""
		, ""
		, "ds_list_0=ds_decide ds_list=ds_list_div"
		, ""
		, ""
		, "fn_afterDecide"
		, true);
}
/********************************************************************************
* 기      능   : 결재 Callback  
********************************************************************************/
function fn_afterDecide(errCode, errMsg) {
	if ( ds_error.rowcount() > 0 ) {
		gfn_showMsg("CE00001");
	} else {
		gfn_showMsg("CI00003");
		div_btn.btn_decide.Enable = false;		// 결재버튼
		div_btn.btn_draft.Enable  = false;		// 기안버튼
		div_btn.btn_print.Enable  = false;		// 출력버튼
		div_btn.btn_sendback.Enable = false; 	// 반송버튼
		//parent.fn_query();
		//fn_close();
	}
}


/********************************************************************************
* 기      능   : 취소 35
********************************************************************************/
function fn_cancel() {
	
}
/********************************************************************************
* 기      능   : print 40
********************************************************************************/
function fn_print() {
	// 출력공통정보조회
	ds_conf_cond.SetColumn(0, "DOCNO", ed_num.Text);	
	
	tit_clearActionInfo();
	tit_addSearchActionInfo("wb01:DOC_CONF_S1");
	tit_addSearchActionInfo("wb01:DOC_CONF_S2");
	tit_callService(
		  ""
		, ""
		, "ds_conf_cond=ds_conf_cond"
		, "ds_conf_list=ds_conf_list ds_draftpers_list=ds_draftpers_list"
		, ""
		, "fn_afterprint"
		, true);
}
function fn_afterPrint(errCode, errMsg) {
	if ( errCode!= 0 ) {
		gfn_showMsg("CE00001");
	} else {
		gfn_showMsg("CI00005");
		
		var _dataSet = ds_list_div;
		if ( _dataSet.rowCount() < 1 ) {
			// 정보 없음. 
			return;
		}
		
		// Master DataSet Setting
		ds_print_h.row = -1;
		ds_print_h.ClearData();
		ds_print_h.AddRow();
		
		ds_print_h.SetColumn(0,"DNO", 			_dataSet.GetColumn(0,"NUM")					);	// 전자결재문서번호
		ds_print_h.SetColumn(0,"D_TEM", 		ds_draftpers_list.GetColumn(0, "D_TEM")		);	// 기안부서
		ds_print_h.SetColumn(0,"D_RANK", 		ds_draftpers_list.GetColumn(0, "D_RANK")	);	// 직급
		ds_print_h.SetColumn(0,"D_NAME", 		ds_draftpers_list.GetColumn(0, "D_NAME")	);	// 기안자
		ds_print_h.SetColumn(0,"D_DATE", 		ds_draftpers_list.GetColumn(0, "D_DATE")	);	// 기안일자
		
		
		// 기안처리자정보
		ds_print_h.SetColumn(0, "APRNK_S1"	  ,ds_conf_list.GetColumn(0, "APRNK_S1" 	) );	// 기안부서1
		ds_print_h.SetColumn(0, "APIRUM_S1"   ,ds_conf_list.GetColumn(0, "APIRUM_S1"	) );	// 기안자1
		ds_print_h.SetColumn(0, "APDATE_S1"   ,ds_conf_list.GetColumn(0, "APDATE_S1"	) );	// 기안승인일자1
		ds_print_h.SetColumn(0, "APRNK_S2"    ,ds_conf_list.GetColumn(0, "APRNK_S2" 	) );
		ds_print_h.SetColumn(0, "APIRUM_S2"   ,ds_conf_list.GetColumn(0, "APIRUM_S2"	) );
		ds_print_h.SetColumn(0, "APDATE_S2"   ,ds_conf_list.GetColumn(0, "APDATE_S2"	) );
		ds_print_h.SetColumn(0, "APRNK_S3"    ,ds_conf_list.GetColumn(0, "APRNK_S3" 	) );
		ds_print_h.SetColumn(0, "APIRUM_S3"   ,ds_conf_list.GetColumn(0, "APIRUM_S3"	) );
		ds_print_h.SetColumn(0, "APDATE_S3"   ,ds_conf_list.GetColumn(0, "APDATE_S3"	) );
		ds_print_h.SetColumn(0, "APRNK_S4"    ,ds_conf_list.GetColumn(0, "APRNK_S4" 	) );
		ds_print_h.SetColumn(0, "APIRUM_S4"   ,ds_conf_list.GetColumn(0, "APIRUM_S4"	) );
		ds_print_h.SetColumn(0, "APDATE_S4"   ,ds_conf_list.GetColumn(0, "APDATE_S4"	) );
		ds_print_h.SetColumn(0, "APRNK_S5"    ,ds_conf_list.GetColumn(0, "APRNK_S5" 	) );
		ds_print_h.SetColumn(0, "APIRUM_S5"   ,ds_conf_list.GetColumn(0, "APIRUM_S5"	) );
		ds_print_h.SetColumn(0, "APDATE_S5"   ,ds_conf_list.GetColumn(0, "APDATE_S5"	) );
		ds_print_h.SetColumn(0, "APRNK_R1"    ,ds_conf_list.GetColumn(0, "APRNK_R1" 	) );	// 수신부서1
		ds_print_h.SetColumn(0, "APIRUM_R1"   ,ds_conf_list.GetColumn(0, "APIRUM_R1"	) );	// 수신자1
		ds_print_h.SetColumn(0, "APDATE_R1"   ,ds_conf_list.GetColumn(0, "APDATE_R1"	) );	// 수신일자1
		ds_print_h.SetColumn(0, "APRNK_R2"    ,ds_conf_list.GetColumn(0, "APRNK_R2" 	) );
		ds_print_h.SetColumn(0, "APIRUM_R2"   ,ds_conf_list.GetColumn(0, "APIRUM_R2"	) );
		ds_print_h.SetColumn(0, "APDATE_R2"   ,ds_conf_list.GetColumn(0, "APDATE_R2"	) );
		ds_print_h.SetColumn(0, "APRNK_R3"    ,ds_conf_list.GetColumn(0, "APRNK_R3" 	) );
		ds_print_h.SetColumn(0, "APIRUM_R3"   ,ds_conf_list.GetColumn(0, "APIRUM_R3"	) );
		ds_print_h.SetColumn(0, "APDATE_R3"   ,ds_conf_list.GetColumn(0, "APDATE_R3"	) );
		ds_print_h.SetColumn(0, "APRNK_R4"    ,ds_conf_list.GetColumn(0, "APRNK_R4" 	) );
		ds_print_h.SetColumn(0, "APIRUM_R4"   ,ds_conf_list.GetColumn(0, "APIRUM_R4"	) );
		ds_print_h.SetColumn(0, "APDATE_R4"   ,ds_conf_list.GetColumn(0, "APDATE_R4"	) );
		ds_print_h.SetColumn(0, "APRNK_R5"    ,ds_conf_list.GetColumn(0, "APRNK_R5" 	) );
		ds_print_h.SetColumn(0, "APIRUM_R5"   ,ds_conf_list.GetColumn(0, "APIRUM_R5"	) );
		ds_print_h.SetColumn(0, "APDATE_R5"   ,ds_conf_list.GetColumn(0, "APDATE_R5"	) );
		
		// 추가사항
		ds_print_h.SetColumn(0,"ZSITE_NM", 		ds_head_div.GetColumn(0,"ZSITE_NM")			);	// 현장명
		ds_print_h.SetColumn(0,"KUNNR_NM", 		ds_head_div.GetColumn(0,"KUNNR_NM")			);	// 고객명
		ds_print_h.SetColumn(0,"NUM", 			ds_head_div.GetColumn(0,"NUM")				);	// 관리번호
		ds_print_h.SetColumn(0,"JHD", 			ds_head_div.GetColumn(0,"JHD")				);	// 발주중도해지일
		ds_print_h.SetColumn(0,"JID", 			ds_head_div.GetColumn(0,"JID")				);	// 작성일
		ds_print_h.SetColumn(0,"JGBN", 			cb_gbn.Text									);	// 중도해지사유구분
		ds_print_h.SetColumn(0,"REQE", 			ds_head_div.GetColumn(0,"REQE")				);	// 당사요구안
		ds_print_h.SetColumn(0,"REQC", 			ds_head_div.GetColumn(0,"REQC")				);	// 고객요구안
		ds_print_h.SetColumn(0,"REQ", 			ds_head_div.GetColumn(0,"REQ")				);	// 협의결과
		ds_print_h.SetColumn(0,"RPD", 			ds_head_div.GetColumn(0,"RPD")				);	// 계약예정일자
		
		
		
		// Detail DataSet Setting
		ds_print.row = -1;
		ds_print.ClearData();
		for( var i = 0; i < _dataSet.RowCount(); i++ ) {
			//if( _dataSet.GetColumn(i, "CHK") == true ) { //체크박스가 true 일 경우
				ds_print.AddRow();
				ds_print.SetColumn(i,"PJT", 			_dataSet.GetColumn(i,"PJT")			);	// 프로젝트
				ds_print.SetColumn(i,"ZSITE_NM", 		_dataSet.GetColumn(i,"ZSITE_NM")	);	// 현장명
				ds_print.SetColumn(i,"FDT", 			_dataSet.GetColumn(i,"ISD")			);	// 보수인수일
				ds_print.SetColumn(i,"ISD", 			_dataSet.GetColumn(i,"ISD")			);	// 보수인수일
				ds_print.SetColumn(i,"ZMUSAOCNT", 		_dataSet.GetColumn(i,"ZMUSAOCNT")	);	// 무상공사예산개월
				ds_print.SetColumn(i,"ZMUSAOCNT2", 		_dataSet.GetColumn(i,"ZMUSAOCNT2")	);	// 무상일반예산개월
				ds_print.SetColumn(i,"GND_NM", 			_dataSet.GetColumn(i,"GND_NM")		);	// 발주구분
				ds_print.SetColumn(i,"MON", 			_dataSet.GetColumn(i,"MON")			);	// 개월수(MG1)
				ds_print.SetColumn(i,"BGT", 			_dataSet.GetColumn(i,"BGT")			);	// 발주개시일
				ds_print.SetColumn(i,"BMT", 			_dataSet.GetColumn(i,"BMT")			);	// 발주만료일
				ds_print.SetColumn(i,"HNO", 			_dataSet.GetColumn(i,"HNO")			);	// 호기명
				ds_print.SetColumn(i,"MUT", 			_dataSet.GetColumn(i,"MUT")			);	// 단가
				ds_print.SetColumn(i,"AMT", 			_dataSet.GetColumn(i,"AMT")			);	// 월정금액
				ds_print.SetColumn(i,"BSU_NM", 			_dataSet.GetColumn(i,"BSU_NM")		);	// 현장명
				ds_print.SetColumn(i,"KUNNR_NM", 		_dataSet.GetColumn(i,"KUNNR_NM")	);	// 고객명
				ds_print.SetColumn(i,"TELF1", 			_dataSet.GetColumn(i,"TELF1")		);	// 고객연락처
				//ds_print.SetColumn(i,"B_VNDADR", 		_dataSet.GetColumn(i,"B_VNDADR")	);	// 업체주소
				//ds_print.SetColumn(i,"B_VNDNM", 		_dataSet.GetColumn(i,"B_VNDNM")		);	// 업체명
				//ds_print.SetColumn(i,"B_REPNM", 		_dataSet.GetColumn(i,"B_REPNM")		);	// 대표자
			//} 
		}
	
		// UbiReport Call
		Dialog("CS11::CS1101001C.xml", "");
	}
}
/********************************************************************************
* 기      능   : 발행 50
********************************************************************************/
function fn_out() {

}
/********************************************************************************
* 기      능   : 신청 55
********************************************************************************/
function fn_request() {

}
/********************************************************************************
* 기      능   : 전송 60
********************************************************************************/
function fn_trans() {

}
/********************************************************************************
* 기      능   : 반송 65
********************************************************************************/
function fn_sendback() {
	gfn_clearMsgBar();
	
	if( ds_list_div.rowCount() < 1 ) {
		// 승인할 정보 없음. 
		return;
	}
	
	if( !gfn_showConfirm("CI00014", "문서번호 : "+ quote(ds_head_div.GetColumn(0,"NUM"))+ "반송") ) return;

	tit_clearActionInfo();
	// 무상보수발주정보(zcst116) update 
	tit_addMultiActionInfo("cs11:CS1104001D_U10");
	
	// 결재상태변경
	ds_decide.SetColumn(0, "SEQSTAT", "2");
	// 결재정보 관리 - 차순별 결재정보  update(zwbap02)
 	tit_addMultiActionInfo("cs04:CS0401002A_U2");
 	// 현장지원 결재 정보 관리 update(zwbap01)
 	tit_addMultiActionInfo("cs04:CS0401002A_U3");

	tit_callService(
		  ""
		, ""
		, "ds_list_0=ds_decide ds_list=ds_list_div" 
		, ""
		, ""
		, "fn_afterSendback"
		, true);
}
/********************************************************************************
* 기      능   : 반송 Callback  
********************************************************************************/
function fn_afterSendback(errCode, errMsg) {
	if ( ds_error.rowcount() > 0 ) {
		gfn_showMsg("CE00001");
	} else {
		gfn_showMsg("CI00003");
		div_btn.btn_decide.Enable 	= false;	// 결재버튼
		div_btn.btn_draft.Enable  	= false;	// 기안버튼
		div_btn.btn_print.Enable  	= false;	// 출력버튼
		div_btn.btn_save.Enable   	= false;	// 저장버튼
		div_btn.btn_sendback.Enable = false;  	// 반송버튼
		//parent.fn_query();
	}
}


/********************************************************************************
* 기      능   : 계산 70
********************************************************************************/
function fn_cal() {

}
/********************************************************************************
* 기      능   : 복사 75
********************************************************************************/
function fn_copy() {

}
/********************************************************************************
* 기      능   : 확인 80
********************************************************************************/
function fn_confirm() {

}
//=========================================================================================
// [ PART 4]
// Callback 함수 정의 : callback 함수명은 메인 함수의 fn_xxxx() 에서 xxxx 부분은 fn_afterXXXX()
// 형태가 되도록 작성 
//=========================================================================================
/********************************************************************************
* 기      능   : 조회 Callback  
********************************************************************************/
function fn_afterQuery(errCode, errMsg) {
	// 메시지 처리 
	gfn_showSearchMsg(grd_list_div);
}
/********************************************************************************
* 기      능   : 저장 Callback  
********************************************************************************/
function fn_afterSave(errCode, errMsg) {
	if ( ds_error.rowcount() > 0 ) {
		gfn_showMsg("CE00001");
	} else {
		gfn_showMsg("CI00003");
	}
}
//=========================================================================================
// [ PART 5 ]
// Detail Process Event 정의 ( User Define function )
// 사용자 정의 함수는 ufn_xxxx() 형태로 작성 
//=========================================================================================
/********************************************************************************
* 기      능   : 사용자 정의 함수  
********************************************************************************/
function ufn_userfunction() {

}

//=========================================================================================
// [ PART 6 ]
// component Event 정의 : 각 Component 별 이벤트 
//=========================================================================================
/********************************************************************************
* 기      능   : 그리드 헤더 클릭시 정렬 처리 
********************************************************************************/
function grd_list_div_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
{
	if ( nCell == 0 ) {
		// 전체 선택
		if(  isExistVar("fa_docno",true) == 1 && length(fa_docno) > 0 ) {
			//gfn_selectAllGrid2(obj, 0, 0, false);
		} else {
			gfn_selectAllGrid2(obj, 0, 0, true);
		}
	} else {
		// 그리드 정렬 처리 
		gfn_sortGrid(obj,nCell);
	}
}
/********************************************************************************
* 기      능   : 데이터셋 값 변경 시 - Flag 처리 
********************************************************************************/
function ds_list_div_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{
	gfn_changeFlag( obj, strColumnID, nRow, "FLAG" );
}

/********************************************************************************
* 기      능   : 무상 담당자에 한해서 해지사유 및 해지일 변경 가능 처리
********************************************************************************/
function btn_modify_OnClick(obj)
{

	tit_clearActionInfo();

	tit_addMultiActionInfo("cs11:CS1104001D_U12");
	tit_callService(
		  ""
		, ""
		, "ds_head_div=ds_head_div" 
		, ""
		, "t_pjt="+quote(ds_list_div.GetColumn(0, "PJT"))
		, "fn_afterModify"
		, true);	

}
function fn_afterModify(errCode, errMsg){

	if(errCode != 0) {
		gfn_showAlert("CE00001");
	} 
}

//=============================================================================
function cal_jhd_OnChanged(obj,strOldText,strNewText)
{
	if ( div_btn.btn_draft.Enable == 1 ) {			
	  alert("무상일경우 기안시에는 '중도해지일' 과  '발주만료일' 이 동일합니다" );
	}
}
]]></Script>
</Window>