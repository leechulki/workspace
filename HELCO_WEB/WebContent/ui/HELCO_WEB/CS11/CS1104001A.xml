<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="562" Id="CS1104001A" Left="8" OnLoadCompleted="fn_OnLoadCompleted" OnUnloadCompleted="fn_OnUnloadCompleted" PidAttrib="7" Title="무상발주&#32;청구현황" Top="8" Ver="1.0" Width="978" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_cond">
				<Contents>
					<colinfo id="PJT" size="256" summ="default" type="STRING"/>
					<colinfo id="ARA" size="256" summ="default" type="STRING"/>
					<colinfo id="BSU" size="256" summ="default" type="STRING"/>
					<colinfo id="BPM" size="256" summ="default" type="STRING"/>
					<colinfo id="TEM" size="256" summ="default" type="STRING"/>
					<colinfo id="PST" size="256" summ="default" type="STRING"/>
					<colinfo id="GND" size="256" summ="default" type="STRING"/>
					<colinfo id="PBN" size="256" summ="default" type="STRING"/>
					<colinfo id="BALJU_FM" size="256" summ="default" type="STRING"/>
					<colinfo id="BALJU_TO" size="256" summ="default" type="STRING"/>
					<colinfo id="DPT" size="256" summ="default" type="STRING"/>
					<colinfo id="ADD_YN" size="256" summ="default" type="STRING"/>
					<colinfo id="DOCNO" size="256" summ="default" type="STRING"/>
					<record>
						<ADD_YN></ADD_YN>
						<ARA></ARA>
						<BALJU_FM></BALJU_FM>
						<BALJU_TO></BALJU_TO>
						<BPM></BPM>
						<BSU></BSU>
						<DOCNO></DOCNO>
						<DPT></DPT>
						<GND></GND>
						<PBN></PBN>
						<PJT></PJT>
						<PST></PST>
						<TEM></TEM>
					</record>
				</Contents>
			</Dataset>
			<Dataset CanColumnChange="ds_mst_CanColumnChange" DataSetType="Dataset" Id="ds_mst">
				<Contents>
					<colinfo id="ARA" size="256" summ="default" type="STRING"/>
					<colinfo id="ARA_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="TEM" size="256" summ="default" type="STRING"/>
					<colinfo id="TEM_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="BSU" size="256" summ="default" type="STRING"/>
					<colinfo id="BSU_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="PJT" size="256" summ="default" type="STRING"/>
					<colinfo id="KUNNR" size="256" summ="default" type="STRING"/>
					<colinfo id="KUNNR_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="TELF1" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSITE_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="HNO_CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="ISD" size="256" summ="default" type="STRING"/>
					<colinfo id="ZMUSAOCNT" size="256" summ="default" type="STRING"/>
					<colinfo id="ZMUSAUCNT" size="256" summ="default" type="STRING"/>
					<colinfo id="ZMUSAOCNT2" size="256" summ="default" type="STRING"/>
					<colinfo id="ZMUSAUCNT2" size="256" summ="default" type="STRING"/>
					<colinfo id="MB_STN" size="256" summ="default" type="STRING"/>
					<colinfo id="MB_STN_NAME" size="256" summ="default" type="STRING"/>
					<colinfo id="DNO" size="256" summ="default" type="STRING"/>
					<colinfo id="APSTAT" size="256" summ="default" type="STRING"/>
					<colinfo id="APSTATNM" size="256" summ="default" type="STRING"/>
					<colinfo id="APSTAT_HJ" size="256" summ="default" type="STRING"/>
					<colinfo id="GND" size="256" summ="default" type="STRING"/>
					<colinfo id="GND_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="BPM" size="256" summ="default" type="STRING"/>
					<colinfo id="BPM_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="PST" size="256" summ="default" type="STRING"/>
					<colinfo id="PST_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="AOCNT" size="256" summ="default" type="STRING"/>
					<colinfo id="AUCNT" size="256" summ="default" type="STRING"/>
					<colinfo id="BOCNT" size="256" summ="default" type="STRING"/>
					<colinfo id="BUCNT" size="256" summ="default" type="STRING"/>
					<colinfo id="NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="IJD" size="256" summ="default" type="STRING"/>
					<colinfo id="JUC" size="256" summ="default" type="STRING"/>
					<colinfo id="JUC_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="ADD" size="256" summ="default" type="STRING"/>
					<colinfo id="BGT" size="256" summ="default" type="STRING"/>
					<colinfo id="BMT" size="256" summ="default" type="STRING"/>
					<colinfo id="BTN" size="256" summ="default" type="STRING"/>
					<colinfo id="CS649_FNA" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_dtl" OnColumnChanged="ds_dtl_OnColumnChanged">
				<Contents>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="THYN" size="256" summ="default" type="STRING"/>
					<colinfo id="PJT" size="256" summ="default" type="STRING"/>
					<colinfo id="ARA" size="256" summ="default" type="STRING"/>
					<colinfo id="TEM" size="256" summ="default" type="STRING"/>
					<colinfo id="BSU" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSITE_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="KUNNR" size="256" summ="default" type="STRING"/>
					<colinfo id="DNO" size="256" summ="default" type="STRING"/>
					<colinfo id="ISD" size="256" summ="default" type="STRING"/>
					<colinfo id="ARA_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="BSU_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="KUNNR_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="TEM_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="HNO" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="HNA" size="256" summ="default" type="STRING"/>
					<colinfo id="WDT" size="256" summ="default" type="STRING"/>
					<colinfo id="FDT" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSPEC1" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSPEC2" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSPEC" size="256" summ="default" type="STRING"/>
					<colinfo id="PST" size="256" summ="default" type="STRING"/>
					<colinfo id="PST_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="GND" size="256" summ="default" type="STRING"/>
					<colinfo id="GND_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="BGT" size="256" summ="default" type="STRING"/>
					<colinfo id="BMT" size="256" summ="default" type="STRING"/>
					<colinfo id="BHD" size="256" summ="default" type="STRING"/>
					<colinfo id="MG1" size="256" summ="default" type="STRING"/>
					<colinfo id="BJT" size="256" summ="default" type="STRING"/>
					<colinfo id="BST" size="256" summ="default" type="STRING"/>
					<colinfo id="AYS" size="256" summ="default" type="STRING"/>
					<colinfo id="BYS" size="256" summ="default" type="STRING"/>
					<colinfo id="HYN" size="256" summ="default" type="STRING"/>
					<colinfo id="MANDT" size="256" summ="default" type="STRING"/>
					<colinfo id="SQL_GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
					<colinfo id="ZLIFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="AGB_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="ABG_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="GUBUN" size="256" summ="default" type="STRING"/>
					<colinfo id="JBF" size="256" summ="default" type="STRING"/>
					<colinfo id="APSTAT" size="256" summ="default" type="STRING"/>
					<colinfo id="APSTATNM" size="256" summ="default" type="STRING"/>
					<colinfo id="ZMUSAOCNT" size="256" summ="default" type="STRING"/>
					<colinfo id="ZMUSAOCNT2" size="256" summ="default" type="STRING"/>
					<colinfo id="ZMUSAUCNT" size="256" summ="default" type="STRING"/>
					<colinfo id="ZMUSAUCNT2" size="256" summ="default" type="STRING"/>
					<colinfo id="MB_STN" size="256" summ="default" type="STRING"/>
					<colinfo id="MB_STN_NAME" size="256" summ="default" type="STRING"/>
					<colinfo id="ABG" size="256" summ="default" type="STRING"/>
					<colinfo id="RMK" size="256" summ="default" type="STRING"/>
					<colinfo id="B_VNDNM" size="256" summ="default" type="STRING"/>
					<colinfo id="BGT_A" size="256" summ="default" type="STRING"/>
					<colinfo id="BGT_B" size="256" summ="default" type="STRING"/>
					<colinfo id="BMT_A" size="256" summ="default" type="STRING"/>
					<colinfo id="BMT_B" size="256" summ="default" type="STRING"/>
					<colinfo id="AOCNT" size="256" summ="default" type="STRING"/>
					<colinfo id="AUCNT" size="256" summ="default" type="STRING"/>
					<colinfo id="NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="JHD_YN" size="256" summ="default" type="STRING"/>
					<colinfo id="MOD" size="256" summ="default" type="STRING"/>
					<colinfo id="AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="MUT" size="256" summ="default" type="STRING"/>
					<colinfo id="JUC" size="256" summ="default" type="STRING"/>
					<colinfo id="JUC_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="TELF1" size="256" summ="default" type="STRING"/>
					<colinfo id="CS136_GYM" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_gnd">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME>-&#32;전체&#32;-</CODE_NAME>
					</record>
					<record>
						<CODE>A</CODE>
						<CODE_NAME>무상공사</CODE_NAME>
					</record>
					<record>
						<CODE>B</CODE>
						<CODE_NAME>무상일반</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_pbn">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME>-&#32;전체&#32;-</CODE_NAME>
					</record>
					<record>
						<CODE>A</CODE>
						<CODE_NAME>승강기</CODE_NAME>
					</record>
					<record>
						<CODE>B</CODE>
						<CODE_NAME>주차</CODE_NAME>
					</record>
					<record>
						<CODE>C</CODE>
						<CODE_NAME>PSD</CODE_NAME>
					</record>
					<record>
						<CODE>D</CODE>
						<CODE_NAME>물류</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_apstat_cb">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME>-&#32;전체&#32;-</CODE_NAME>
					</record>
					<record>
						<CODE>0</CODE>
						<CODE_NAME>기안&#32;미결재</CODE_NAME>
					</record>
					<record>
						<CODE>1</CODE>
						<CODE_NAME>기안&#32;진행</CODE_NAME>
					</record>
					<record>
						<CODE>2</CODE>
						<CODE_NAME>기안&#32;반송</CODE_NAME>
					</record>
					<record>
						<CODE>3</CODE>
						<CODE_NAME>기안&#32;결재완료</CODE_NAME>
					</record>
					<record>
						<CODE>4</CODE>
						<CODE_NAME>수신&#32;진행</CODE_NAME>
					</record>
					<record>
						<CODE>5</CODE>
						<CODE_NAME>수신&#32;반송</CODE_NAME>
					</record>
					<record>
						<CODE>6</CODE>
						<CODE_NAME>수신&#32;결재완료</CODE_NAME>
					</record>
					<record>
						<CODE>XX</CODE>
						<CODE_NAME>자동&#32;발주</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond_dtl">
				<Contents>
					<colinfo id="PJT" size="256" summ="default" type="STRING"/>
					<colinfo id="BPM" size="256" summ="default" type="STRING"/>
					<colinfo id="ARA" size="256" summ="default" type="STRING"/>
					<colinfo id="BSU" size="256" summ="default" type="STRING"/>
					<colinfo id="TEM" size="256" summ="default" type="STRING"/>
					<colinfo id="KUNNR" size="256" summ="default" type="STRING"/>
					<colinfo id="GND" size="256" summ="default" type="STRING"/>
					<colinfo id="ISD" size="256" summ="default" type="STRING"/>
					<colinfo id="DNO" size="256" summ="default" type="STRING"/>
					<colinfo id="NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="PST" size="256" summ="default" type="STRING"/>
					<colinfo id="IJD" size="256" summ="default" type="STRING"/>
					<colinfo id="JUC" size="256" summ="default" type="STRING"/>
					<colinfo id="BGT" size="256" summ="default" type="STRING"/>
					<colinfo id="BMT" size="256" summ="default" type="STRING"/>
					<record>
						<ARA></ARA>
						<BGT></BGT>
						<BMT></BMT>
						<BPM></BPM>
						<BSU></BSU>
						<DNO></DNO>
						<GND></GND>
						<IJD></IJD>
						<ISD></ISD>
						<JUC></JUC>
						<KUNNR></KUNNR>
						<NUM></NUM>
						<PJT></PJT>
						<PST></PST>
						<TEM></TEM>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_doc_cond">
				<Contents>
					<colinfo id="DOCTYPE" size="256" summ="default" type="STRING"/>
					<colinfo id="TEM" size="256" summ="default" type="STRING"/>
					<record>
						<DOCTYPE></DOCTYPE>
						<TEM></TEM>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_docno_gen">
				<Contents>
					<colinfo id="PFX" size="256" summ="default" type="STRING"/>
					<colinfo id="DOCNO" size="256" summ="default" type="STRING"/>
					<record>
						<DOCNO></DOCNO>
						<PFX></PFX>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_conf_cond">
				<Contents>
					<colinfo id="DOCNO" size="256" summ="default" type="STRING"/>
					<record>
						<DOCNO></DOCNO>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_conf_list">
				<Contents>
					<colinfo id="APRNK_S1" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM_S1" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE_S1" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK_S2" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM_S2" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE_S2" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK_S3" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM_S3" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE_S3" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK_S4" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM_S4" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE_S4" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK_S5" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM_S5" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE_S5" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK_R1" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM_R1" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE_R1" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK_R2" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM_R2" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE_R2" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK_R3" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM_R3" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE_R3" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK_R4" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM_R4" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE_R4" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK_R5" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM_R5" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE_R5" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_draftpers_list">
				<Contents>
					<colinfo id="D_TEM" size="256" summ="default" type="STRING"/>
					<colinfo id="D_RANK" size="256" summ="default" type="STRING"/>
					<colinfo id="D_NAME" size="256" summ="default" type="STRING"/>
					<colinfo id="D_DATE" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_print_h">
				<Contents>
					<colinfo id="DNO" size="256" summ="default" type="STRING"/>
					<colinfo id="D_TEM" size="256" summ="default" type="STRING"/>
					<colinfo id="D_RANK" size="256" summ="default" type="STRING"/>
					<colinfo id="D_NAME" size="256" summ="default" type="STRING"/>
					<colinfo id="D_DATE" size="256" summ="default" type="STRING"/>
					<colinfo id="BSU_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="KUNNR_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="TELF1" size="256" summ="default" type="STRING"/>
					<colinfo id="B_VNDADR" size="256" summ="default" type="STRING"/>
					<colinfo id="B_VNDNM" size="256" summ="default" type="STRING"/>
					<colinfo id="B_REPNM" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK_S1" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM_S1" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE_S1" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK_S2" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM_S2" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE_S2" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK_S3" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM_S3" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE_S3" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK_S4" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM_S4" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE_S4" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK_S5" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM_S5" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE_S5" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK_R1" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM_R1" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE_R1" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK_R2" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM_R2" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE_R2" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK_R3" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM_R3" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE_R3" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK_R4" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM_R4" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE_R4" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK_R5" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM_R5" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE_R5" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_print">
				<Contents>
					<colinfo id="PJT" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSITE_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="FDT" size="256" summ="default" type="STRING"/>
					<colinfo id="ZMUSAOCNT" size="256" summ="default" type="STRING"/>
					<colinfo id="ZMUSAOCNT2" size="256" summ="default" type="STRING"/>
					<colinfo id="GND_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="MON" size="256" summ="default" type="STRING"/>
					<colinfo id="BGT" size="256" summ="default" type="STRING"/>
					<colinfo id="BMT" size="256" summ="default" type="STRING"/>
					<colinfo id="HNO" size="256" summ="default" type="STRING"/>
					<colinfo id="AMT" size="255" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_add">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME>-&#32;전체&#32;-</CODE_NAME>
					</record>
					<record>
						<CODE>Y</CODE>
						<CODE_NAME>Yes</CODE_NAME>
					</record>
					<record>
						<CODE>N</CODE>
						<CODE_NAME>No</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_decide">
				<Contents>
					<colinfo id="MANDT" size="256" summ="default" type="STRING"/>
					<colinfo id="DOCNO" size="256" summ="default" type="STRING"/>
					<colinfo id="DOCKIND" size="256" summ="default" type="STRING"/>
					<colinfo id="APPGUBN" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQNO" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQSTAT" size="256" summ="default" type="STRING"/>
					<colinfo id="APDPT1" size="256" summ="default" type="STRING"/>
					<colinfo id="APDPT1_N" size="256" summ="default" type="STRING"/>
					<colinfo id="APNUM" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE" size="256" summ="default" type="STRING"/>
					<colinfo id="APTIM" size="256" summ="default" type="STRING"/>
					<colinfo id="APDESC" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_wf_stat">
				<Contents>
					<colinfo id="DOCNO" size="256" summ="default" type="STRING"/>
					<colinfo id="DOCKIND" size="256" summ="default" type="STRING"/>
					<colinfo id="APPGUBN" size="256" summ="default" type="STRING"/>
					<colinfo id="APPGUBNNM" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQNO" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQNONM" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQSTAT" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQSTATNM" size="256" summ="default" type="STRING"/>
					<colinfo id="APDPT1" size="256" summ="default" type="STRING"/>
					<colinfo id="APDPT1_N" size="256" summ="default" type="STRING"/>
					<colinfo id="APNUM" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE" size="256" summ="default" type="STRING"/>
					<colinfo id="APTIM" size="256" summ="default" type="STRING"/>
					<colinfo id="APDESC" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_chkDel">
				<Contents>
					<colinfo id="CS116_PJT" size="256" summ="default" type="STRING"/>
					<colinfo id="CS116_HNO" size="256" summ="default" type="STRING"/>
					<colinfo id="CS116_SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="CS116_GND" size="256" summ="default" type="STRING"/>
					<colinfo id="CS116_MG1" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_rcond">
				<Contents>
					<colinfo id="ZPROGRAM" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN" size="256" summ="default" type="STRING"/>
					<record>
						<GBN></GBN>
						<ZPROGRAM></ZPROGRAM>
					</record>
				</Contents>
			</Dataset>
		</Datasets>
		<PopupDiv Border="Flat" Height="146" Id="PopupDiv0" Left="990" TabOrder="8" TabStop="FALSE" Top="160" Width="154">
			<Contents>
				<Calendar Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="146" Id="cal_temp" MonthOnly="TRUE" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" OnDayClick="PopupDiv0_cal_temp_OnDayClick" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="1" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="-2" Value="20130101" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="152"></Calendar>
			</Contents>
		</PopupDiv>
		<Shape BKColor="user0" Bottom="56" Height="56" Id="Shape0" Left="0" LineColor="user1" Right="978" TabOrder="1" Top="0" Type="Rectangle" Width="978"></Shape>
		<Static Align="Right" Height="20" Id="st_bsu" Left="7" Style="sty_lb_search" TabOrder="3" Text="협력사&#32;" Top="29" VAlign="Middle" Width="80"></Static>
		<Div BKColor="user0" Height="20" Id="div_code" Left="89" OnLoadCompleted="fn_OnLoadCompleted" OnTimer="WB0199010A_OnTimer" TabOrder="2" Text="Div0" Top="29" Url="WB01::WB0199010A.xml" Width="415">
			<Contents></Contents>
		</Div>
		<Static Align="Right" Height="20" Id="st_pjt" Left="571" Style="sty_lb_search" TabOrder="4" Text="Proj&#32;No&#32;" Top="6" VAlign="Middle" Width="80"></Static>
		<Edit BindDataset="ds_cond" Border="Flat" Column="PJT" Height="20" Id="ed_pjt" Left="653" MaxLength="6" Style="sty_ipt_search" TabOrder="5" Top="6" UpperOnly="TRUE" Width="82"></Edit>
		<Button Cursor="HAND" Height="18" Id="btn_pjt" ImageID="btn_icon_search" Left="737" OnClick="btn_pjt_OnClick" TabOrder="6" Text="Button0" Top="7" Width="18"></Button>
		<Calendar BindDataset="ds_cond" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="BALJU_FM" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_balju_fm" Left="90" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_search" SundayTextColor="user35" TabOrder="7" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="6" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="100"></Calendar>
		<Static Align="Center" Border="None" Color="user7" Font="굴림,9" Height="20" Id="st_btw" Left="192" TabOrder="9" Text="~" Top="7" VAlign="Middle" Width="18"></Static>
		<Calendar BindDataset="ds_cond" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="BALJU_TO" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_balju_to" Left="214" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_search" SundayTextColor="user35" TabOrder="10" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="6" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="100"></Calendar>
		<Static Align="Right" Height="20" Id="st_bap" Left="571" Style="sty_lb_search" TabOrder="11" Text="제품군&#32;" Top="29" VAlign="Middle" Width="80"></Static>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="CODE" Column="PBN" DataColumn="CODE_NAME" Height="20" Id="cb_pbn" InnerDataset="ds_pbn" Left="652" Style="sty_ipt_search" TabOrder="12" Top="28" Width="93"></Combo>
		<Static Align="Right" Height="20" Id="Static0" Left="7" Style="sty_lb_search" TabOrder="13" Text="발주기간&#32;" Top="6" VAlign="Middle" Width="80"></Static>
		<Static Align="Right" Height="20" Id="Static1" Left="360" Style="sty_lb_search" TabOrder="14" Text="발주구분&#32;" Top="6" VAlign="Middle" Width="80"></Static>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="CODE" Column="GND" DataColumn="CODE_NAME" Height="20" Id="cb_gnd" InnerDataset="ds_gnd" Left="441" Style="sty_ipt_search" TabOrder="15" Top="5" Width="93"></Combo>
		<Static Align="Right" Height="20" Id="Static2" Left="795" Style="sty_lb_search" TabOrder="16" Text="결재상태&#32;" Top="6" VAlign="Middle" Width="80"></Static>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="CODE" Column="PST" DataColumn="CODE_NAME" Height="20" Id="cb_apstat" InnerDataset="ds_apstat_cb" Left="876" Style="sty_ipt_search" TabOrder="17" Top="5" Width="93"></Combo>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_cancel" ImageID="btn_sub_04" Left="899" LeftMargin="12" OnClick="btn_cancel_openPopup" Style="sty_btn" TabOrder="18" Text="중도해지" Top="64" Transparent="TRUE" Width="72"></Button>
		<Grid AutoEnter="TRUE" AutoFitEndLine="Hide" BindDataset="ds_mst" BkColor2="default" BoldHead="true" Border="Flat" Bottom="296" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="30" Height="208" Id="grd_mst" InputPanel="FALSE" Left="8" LineColor="user20" LineType="ExHORZ" OnCellClick="grd_mst_OnCellClick" OnCellDBLClick="grd_mst_OnCellDblClick" OnCellPosChanged="grd_mst_OnCellPosChanged" OnHeadClick="grd_mst_OnHeadClick" Right="966" RowHeight="20" Style="sty_grid" TabOrder="19" TabStop="true" Top="88" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="958">
			<contents>
				<format id="Default">
					<columns>
						<col width="40"/>
						<col width="112"/>
						<col width="120"/>
						<col width="60"/>
						<col width="120"/>
						<col width="120"/>
						<col width="50"/>
						<col width="0"/>
						<col width="80"/>
						<col width="97"/>
						<col width="93"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="60"/>
						<col width="60"/>
						<col width="60"/>
						<col width="60"/>
						<col width="105"/>
						<col width="70"/>
						<col width="118"/>
						<col width="90"/>
						<col width="55"/>
						<col width="55"/>
						<col width="118"/>
						<col width="80"/>
						<col width="80"/>
						<col width="30"/>
						<col width="34"/>
						<col width="172"/>
					</columns>
					<head>
						<cell align="center" col="0" color="user21" display="text" font="굴림,9" text="No"/>
						<cell align="center" col="1" color="user21" display="text" font="굴림,9" text="팀"/>
						<cell align="center" col="2" color="user21" display="text" font="굴림,9" text="협력사"/>
						<cell align="center" col="3" color="user21" display="text" font="굴림,9" text="Proj&#32;No"/>
						<cell align="center" col="4" color="user21" display="text" font="굴림,9" text="고객명"/>
						<cell align="center" col="5" color="user21" display="text" font="굴림,9" text="현장명"/>
						<cell align="center" col="6" color="user21" display="text" font="굴림,9" text="대수"/>
						<cell align="center" col="7" color="user21" display="text" font="굴림,9" text="신규수주일"/>
						<cell col="8" color="user21" display="text" font="굴림,9" text="입주일자"/>
						<cell col="9" color="user21" display="text" font="굴림,9" text="주택관리업체"/>
						<cell col="10" color="user21" display="text" font="굴림,9" text="고객연락처"/>
						<cell col="11" color="user21" display="text" font="굴림,9" text="발주개시일"/>
						<cell col="12" color="user21" display="text" font="굴림,9" text="발주만료일"/>
						<cell col="13" color="user21" display="text" font="굴림,9" text="건물준공일"/>
						<cell col="14" color="user21" display="text" font="굴림,9" text="공사예산&#10;개월수"/>
						<cell col="15" color="user21" display="text" font="굴림,9" text="공사사용&#10;개월수"/>
						<cell col="16" color="user21" display="text" font="굴림,9" text="일반예산&#10;개월수"/>
						<cell col="17" color="user21" display="text" font="굴림,9" text="일반사용&#10;개월수"/>
						<cell col="18" color="user21" display="text" font="굴림,9" text="무상보수&#10;개시기준"/>
						<cell col="19" color="user21" display="text" font="굴림,9" text="발주구분"/>
						<cell col="20" color="user21" display="text" font="굴림,9" text="청구결재번호"/>
						<cell col="21" color="user21" display="text" font="굴림,9" text="청구결재상태"/>
						<cell col="22" display="text"/>
						<cell col="23" color="user21" display="text" font="굴림,9" text="진행상태"/>
						<cell col="24" color="user21" display="text" font="굴림,9" text="중도해지결재번호"/>
						<cell col="25" color="user21" display="text" font="굴림,9" text="해지결재상태"/>
						<cell col="26" color="user21" display="text" font="굴림,9" text="추가발주일자"/>
						<cell align="center" col="27" display="text" font="Default,9" TrimType="Both"/>
						<cell align="center" col="28" display="text" font="Default,9" text="다운" TrimType="Both"/>
						<cell align="center" col="29" display="text" font="Default,9" text="첨부파일" TrimType="Both"/>
					</head>
					<body>
						<cell align="center" bkcolor2="user22" col="0" display="text" expr="currow+1"/>
						<cell align="left" bkcolor2="user22" col="1" colid="TEM_NM" display="text"/>
						<cell bkcolor2="user22" col="2" colid="BSU_NM" display="text"/>
						<cell align="center" bkcolor2="user22" col="3" colid="PJT" display="text"/>
						<cell bkcolor2="user22" col="4" colid="KUNNR_NM" display="text"/>
						<cell bkcolor2="user22" col="5" colid="ZSITE_NM" display="text"/>
						<cell align="center" bkcolor2="user22" col="6" colid="HNO_CNT" display="text"/>
						<cell align="center" bkcolor2="user22" col="7" colid="BSTDK" display="text" Mask="####.##.##"/>
						<cell align="center" col="8" colid="IJD" display="text" Mask="####.##.##"/>
						<cell col="9" colid="JUC_NM" display="text"/>
						<cell col="10" colid="TELF1" display="text"/>
						<cell align="center" col="11" colid="BGT" display="text" Mask="####.##.##"/>
						<cell align="center" col="12" colid="BMT" display="text" Mask="####.##.##"/>
						<cell align="center" col="13" colid="COMPL_DA" display="text" Mask="####.##.##"/>
						<cell align="right" col="14" colid="ZMUSAOCNT" display="text"/>
						<cell align="right" col="15" colid="ZMUSAUCNT" display="text"/>
						<cell align="right" col="16" colid="ZMUSAOCNT2" display="text"/>
						<cell align="right" col="17" colid="ZMUSAUCNT2" display="text"/>
						<cell align="center" col="18" colid="MB_STN_NAME" display="text"/>
						<cell align="center" col="19" colid="GND_NM" display="text"/>
						<cell align="center" col="20" colid="DNO" display="text"/>
						<cell col="21" colid="APSTAT" combocol="CODE" combodataset="ds_apstat_cb" combotext="CODE_NAME" display="combo"/>
						<cell align="center" bkcolor2="user22" bkimagealign="stretch" bkimageid="btn_grid_01" col="22" display="button" text="수정"/>
						<cell align="center" col="23" colid="PST_NM" display="text"/>
						<cell align="center" col="24" colid="NUM" display="text"/>
						<cell col="25" colid="APSTAT_HJ" combocol="CODE" combodataset="ds_apstat_cb" combotext="CODE_NAME" display="combo"/>
						<cell align="center" col="26" colid="ADD" display="text" Mask="####.##.##"/>
						<cell align="center" bkcolor2="user22" bkimageid='expr:iif(length(getColumn(currow,&#32;&quot;CS649_FNA&quot;)&#32;)&#32;&gt;&#32;0&#32;,&#32;&quot;btn_icon_search&quot;,&#32;&quot;&quot;)' col="27" display='expr:iif(length(getColumn(currow,&#32;&quot;CS649_FNA&quot;)&#32;)&#32;&gt;&#32;0&#32;,&#32;&quot;button&quot;,&#32;&quot;&quot;)'/>
						<cell align="left" bkcolor2="user22" bkimageid='expr:iif(length(getColumn(currow,&#32;&quot;CS649_FNA&quot;)&#32;)&#32;&gt;&#32;0&#32;,&#32;&quot;icon_grid_file&quot;,&#32;&quot;&quot;)' col="28" cursor='expr:iif(length(getColumn(currow,&#32;&quot;CS649_FNA&quot;)&#32;)&#32;&gt;&#32;0&#32;,&#32;&quot;hand&quot;,&#32;&quot;arrow&quot;)' display="text"/>
						<cell align="left" bkcolor2="user22" col="29" colid="CS649_FNA" display="text"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Grid AutoEnter="TRUE" AutoFitEndLine="Hide" BindDataset="ds_dtl" BkColor2="default" BoldHead="true" Border="Flat" Bottom="552" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="240" Id="grd_dtl" InputPanel="FALSE" Left="8" LineColor="user20" LineType="ExHORZ" OnCellDBLClick="grd_dtl_OnCellDblClick" OnHeadClick="grd_dtl_OnHeadClick" Right="966" RowHeight="20" Style="sty_grid" TabOrder="20" TabStop="true" Top="312" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="958">
			<contents>
				<format id="Default">
					<columns>
						<col width="30"/>
						<col width="30"/>
						<col width="116"/>
						<col width="109"/>
						<col width="60"/>
						<col width="100"/>
						<col width="60"/>
						<col width="39"/>
						<col width="60"/>
						<col width="60"/>
						<col width="72"/>
						<col width="60"/>
						<col width="66"/>
						<col width="64"/>
						<col width="75"/>
						<col width="80"/>
						<col width="80"/>
						<col width="67"/>
						<col width="70"/>
						<col width="80"/>
						<col width="60"/>
						<col width="93"/>
						<col width="93"/>
						<col width="70"/>
						<col width="80"/>
					</columns>
					<head>
						<cell col="0" color="user21" display="checkbox" edit="checkbox" font="굴림,9"/>
						<cell col="1" color="user21" display="text" font="굴림,9" text="No"/>
						<cell col="2" color="user21" display="text" font="굴림,9" text="지사명"/>
						<cell col="3" color="user21" display="text" font="굴림,9" text="업체명"/>
						<cell col="4" color="user21" display="text" font="굴림,9" text="Proj.No"/>
						<cell col="5" color="user21" display="text" font="굴림,9" text="현장명"/>
						<cell col="6" color="user21" display="text" font="굴림,9" text="호기"/>
						<cell col="7" color="user21" display="text" font="굴림,9" text="순번"/>
						<cell col="8" color="user21" display="text" font="굴림,9" text="호기명"/>
						<cell col="9" color="user21" display="text" font="굴림,9" text="빌딩구분"/>
						<cell col="10" color="user21" display="text" font="굴림,9" text="인수일"/>
						<cell col="11" color="user21" display="text" font="굴림,9" text="발주구분"/>
						<cell col="12" color="user21" display="text" font="굴림,9" text="예산개월수"/>
						<cell col="13" color="user21" display="text" font="굴림,9" text="사용개월수"/>
						<cell col="14" color="user21" display="text" font="굴림,9" text="개시일"/>
						<cell col="15" color="user21" display="text" font="굴림,9" text="만료일"/>
						<cell col="16" color="user21" display="text" font="굴림,9" text="건물준공일"/>
						<cell col="17" color="user21" display="text" font="굴림,9" text="잔여개월수"/>
						<cell col="18" color="user21" display="text" font="굴림,9" text="무상승인일"/>
						<cell col="19" color="user21" display="text" font="굴림,9" text="비고"/>
						<cell col="20" color="user21" display="text" font="굴림,9" text="자동발주"/>
						<cell col="21" color="user21" display="text" font="굴림,9" text="중도해지여부"/>
						<cell align="center" col="22" color="user21" display="text" font="굴림,9" text="청구결재상태"/>
						<cell col="23" color="user21" display="text" font="굴림,9" text="진행상태"/>
						<cell col="24" color="user21" display="text" font="굴림,9" text="비고"/>
					</head>
					<body>
						<cell align="center" bkcolor2="user22" col="0" colid="CHK" display="checkbox" edit="checkbox"/>
						<cell align="center" col="1" display="text" expr="currow+1"/>
						<cell col="2" colid="TEM_NM" display="text"/>
						<cell col="3" colid="B_VNDNM" display="text"/>
						<cell align="center" col="4" colid="PJT" display="text"/>
						<cell col="5" colid="ZSITE_NM" display="text"/>
						<cell align="center" col="6" colid="HNO" display="text"/>
						<cell align="right" col="7" colid="SEQ" display="text"/>
						<cell col="8" colid="HNA" display="text"/>
						<cell align="center" col="9" colid="ABG_NM" display="text"/>
						<cell align="center" col="10" colid="ISD" display="text" Mask="####.##.##"/>
						<cell align="center" col="11" colid="GND_NM" display="text"/>
						<cell align="center" col="12" colid="AOCNT" display="text"/>
						<cell align="center" col="13" colid="AUCNT" display="text"/>
						<cell align="center" col="14" colid="BGT" display="text" Mask="####.##.##"/>
						<cell align="center" col="15" colid="BMT" display="text" Mask="####.##.##"/>
						<cell align="center" col="16" colid="COMPL_DA" display="text" Mask="####.##.##"/>
						<cell align="center" col="17" colid="MOD" display="text"/>
						<cell col="18" colid="BST" display="text" Mask="####.##.##"/>
						<cell align="center" bkcolor2="user22" bkimagealign="stretch" bkimageid="btn_grid_01" col="19" display="button" text="기성비조회"/>
						<cell align="center" col="20" colid="JBF" display="checkbox"/>
						<cell col="21" colid="JHD_YN" display="checkbox"/>
						<cell align="center" col="22" colid="APSTAT" combocol="CODE" combodataset="ds_apstat_cb" combotext="CODE_NAME" display="combo"/>
						<cell align="center" col="23" colid="PST_NM" display="text"/>
						<cell align="center" bkcolor2="user22" bkimagealign="stretch" bkimageid="btn_grid_01" col="24" display="button" text="발주삭제"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Edit Height="21" Id="ed_save_yn" Left="368" TabOrder="21" Text="등록/미등록구분변수" Top="576" Visible="FALSE" Width="122"></Edit>
		<Edit Height="21" Id="ed_doctype" Left="256" TabOrder="22" Text="전자결재문서유형" Top="576" Visible="FALSE" Width="106"></Edit>
		<Edit Height="21" Id="ed_docno" Left="104" TabOrder="23" Text="전자결재문서번호" Top="576" Visible="FALSE" Width="146"></Edit>
		<Edit Height="21" Id="ed_usergroup" Left="8" TabOrder="24" Text="사용자그룹코드" Top="576" Visible="FALSE" Width="90"></Edit>
		<Edit Height="21" Id="ed_tem" Left="496" TabOrder="25" Text="팀코드" Top="576" Visible="FALSE" Width="58"></Edit>
		<Edit Height="21" Id="ed_apstat" Left="560" TabOrder="26" Text="결재상태" Top="576" Visible="FALSE" Width="56"></Edit>
		<Edit Height="21" Id="ed_gnd" Left="680" TabOrder="27" Text="발주구분" Top="576" Visible="FALSE" Width="80"></Edit>
		<Edit Height="21" Id="ed_pst" Left="624" TabOrder="28" Text="진행상태" Top="576" Visible="FALSE" Width="56"></Edit>
		<Static Color="user6" Height="20" Id="Static3" Left="11" TabOrder="29" Text="※&#32;청구결재번호나&#32;중도해지결재번호를&#32;더블클릭하시면&#32;상세화면을&#32;보실수&#32;있습니다." Top="67" VAlign="Middle" Width="880"></Static>
		<Static Align="Right" Height="20" Id="Static4" Left="795" Style="sty_lb_search" TabOrder="30" Text="추가발주여부" Top="30" VAlign="Middle" Width="80"></Static>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="CODE" Column="ADD_YN" DataColumn="CODE_NAME" Height="20" Id="cb_add_yn" InnerDataset="ds_add" Left="876" Style="sty_ipt_search" TabOrder="31" Top="29" Width="93"></Combo>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_baldel" ImageID="btn_sub_04" Left="728" LeftMargin="12" OnClick="btn_baldel_OnClick" Style="sty_btn" TabOrder="32" Text="삭제" Top="64" Transparent="TRUE" Width="72"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_balcan" ImageID="btn_sub_04" Left="816" LeftMargin="12" OnClick="btn_balcan_OnClick" Style="sty_btn" TabOrder="33" Text="승인취소" Top="64" Transparent="TRUE" Width="72"></Button>
		<Edit Height="21" Id="ed_posid" Left="104" TabOrder="34" Text="원프로젝트" Top="600" Visible="FALSE" Width="146"></Edit>
		<FileDialog Bottom="81" FilePath="c:\" Height="24" Id="saveDialog" Left="1032" Right="1056" TabOrder="34" Top="57" Type="Save" Width="24"></FileDialog>
	</Form>
	<Script><![CDATA[/*
 ******************************************************************************************
 * 기      능   : 
 * 작  성  자   : 
 * 작성  일자   : 
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
#include "LIB::commons.js";	// 공통 스크립트 
#include "LIB::common_cs.js";	// 서비스 공통 스크립트
#include "LIB::utility.js";	// 다중 선택 
//=========================================================================================
// [ PART 1 ]
// Form에서 사용될 전역변수를 선언
// FORM에서 사용되는 전역변수는 대문자로 작성하며, F_XXX 의 형태를 갖도록 한다. 
//=========================================================================================
var cancle_auth = false; // 삭제, 승인취소 권한
var delete_auth = false; // 발주삭제 권한		
//=========================================================================================
// [ PART 2 ]
// Form Loading / Unloading 시 작업 정의
//=========================================================================================
function fn_OnLoadCompleted(obj) {
	gfn_initForm(true);
	
	// 전자결재문서를 참조하세요.
	ed_docno.Text     = '';					// 전자결재문서번호
	ed_doctype.Text   = 'H07';				// 전자결재문서유형
	ed_usergroup.Text = gfn_getUserGroup();	// 사용자권한그룹

	
	var firstDay = substr(gfn_getCurrDate(),0,6) + "01";
	cal_balju_fm.value = firstDay;
	cal_balju_to.value = gfn_getCurrDate();
	ed_pjt.SetFocus();

	ds_cond.SetColumn(0, "BALJU_FM", cal_balju_fm.value);
	ds_cond.SetColumn(0, "BALJU_TO", cal_balju_to.value);
	ds_cond.SetColumn(0, "PST", 	 cb_apstat.value);
	
	// Button Controll
	ufn_enableBtn("print", false);	// 프린트
	ufn_enableBtn("draft", false);	// 기안
	btn_cancel.Enable = false;		// 중도해지
	
	btn_baldel.Visible = false;
	btn_balcan.Visible = false;
	
	gfn_initDs(ds_rcond, true);
	ds_rcond.SetColumn(0, "ZPROGRAM", "CS1104001A");
	ds_rcond.SetColumn(0, "GBN", "01");	
	cancle_auth = gfn_getAuth(ds_rcond);
	ds_rcond.ClearData();
	
	gfn_initDs(ds_rcond, true);
	ds_rcond.SetColumn(0, "ZPROGRAM", "CS1104001A");
	ds_rcond.SetColumn(0, "GBN", "02");	
	delete_auth = gfn_getAuth(ds_rcond);
	ds_rcond.ClearData();
	
	if(cancle_auth == true) {
		btn_baldel.Visible = true; // 삭제
		btn_balcan.Visible = true; // 승인취소
	}
	
	/*if(G_USER_ID == "2021153" || G_USER_ID == "2018209" || G_USER_ID == "2018900" || G_USER_ID == "2029758" || G_USER_ID == "2999999"){
		btn_baldel.Visible = true;
		btn_balcan.Visible = true;
	}*/
	
	// 초기화 완료메시지
	gfn_showMsg("CI00007");
}
/********************************************************************************
* 기      능   : 공통코드가 조회된 후의 Callback 함수 
********************************************************************************/
function fn_completeInit(sCode, sDsObj, sCodeType) {
	cb_apstat.Index = 0;
	gfn_showMsg("CI00007");
}
/********************************************************************************
* 기      능   : form UnloadCompleted 
********************************************************************************/
function fn_OnUnloadCompleted(obj) {
	return gfn_isFormUnload(obj);
}
//=========================================================================================
// [ PART 3 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,form닫기)
//=========================================================================================
/********************************************************************************
* 기      능   : 조회 1
********************************************************************************/
function fn_query() {
	
	if( length(ed_pjt.value) <> 0 ) { //프로젝트 번호를 입력했을 경우에 pjt, pst, gnd 만 조건으로 넘긴다.
		ds_cond.SetColumn(0, "PJT", ed_pjt.value);
		ds_cond.SetColumn(0, "PST", cb_apstat.value);
		ds_cond.SetColumn(0, "BSU", '');
		ds_cond.SetColumn(0, "BPM", '');
		ds_cond.SetColumn(0, "ARA", '');
		ds_cond.SetColumn(0, "DPT", '');
		ds_cond.SetColumn(0, "GND", cb_gnd.value);
	} else {
		if( length(ed_pjt.value) == 0 ) { 
			if( gfn_isNull(cal_balju_fm, true) ) {
				var arr = [trim(st_balju_date.value)];
				gfn_showMsg("CW00001", arr);
				return;
			}
	
			if( gfn_isNull(cal_balju_to, true) ) {
				var arr = [trim(st_balju_date.value)];
				gfn_showMsg("CW00001", arr);
				return;
			}
		}
	
		ds_cond.SetColumn(0, "BALJU_FM", cal_balju_fm.value);
		ds_cond.SetColumn(0, "BALJU_TO", cal_balju_to.value);
		ds_cond.SetColumn(0, "PST", 	 cb_apstat.value);
		ds_cond.SetColumn(0, "GND", 	 cb_gnd.value);
	}

	// sort mark 삭제 
	gfn_clearGridSortMark(grd_mst);
	ds_mst.ClearData();

	ds_dtl.row = -1;
	ds_dtl.ClearData();

	tit_clearActionInfo();
    //var qst = gfn_deptQuery();	// 부서
    var qst = gfn_deptQuery("C");	// 부서
    tit_addSearchActionInfo("cs11:CS1104001A_S1", null, true);	
	tit_callService(
          ""
        , ""
        , "ds_cond=ds_cond"
        , "ds_mst=ds_mst"
        , "WQST=" + quote(qst)
        , "fn_afterQuery"
        , true);
}

/********************************************************************************
* 기      능   : Detail 조회 1
********************************************************************************/
function fn_queryDtl() {
	// 상세조회조건 셋팅
	var cRow = ds_mst.GetCurrow();
	ds_cond_dtl.row = -1;
	ds_cond_dtl.ClearData();
	ds_cond_dtl.AddRow();
	ds_cond_dtl.SetColumn(0, "PJT", 	ds_mst.GetColumn(cRow, "PJT"));
	ds_cond_dtl.SetColumn(0, "TEM", 	ds_mst.GetColumn(cRow, "TEM"));
	ds_cond_dtl.SetColumn(0, "ARA", 	ds_mst.GetColumn(cRow, "ARA"));
	ds_cond_dtl.SetColumn(0, "BPM", 	ds_mst.GetColumn(cRow, "BPM"));
	ds_cond_dtl.SetColumn(0, "BSU", 	ds_mst.GetColumn(cRow, "BSU"));
	ds_cond_dtl.SetColumn(0, "KUNNR", 	ds_mst.GetColumn(cRow, "KUNNR"));
	ds_cond_dtl.SetColumn(0, "ISD", 	ds_mst.GetColumn(cRow, "ISD"));
	ds_cond_dtl.SetColumn(0, "GND", 	ds_mst.GetColumn(cRow, "GND"));
	ds_cond_dtl.SetColumn(0, "IJD", 	ds_mst.GetColumn(cRow, "IJD"));
	ds_cond_dtl.SetColumn(0, "JUC", 	ds_mst.GetColumn(cRow, "JUC"));
	ds_cond_dtl.SetColumn(0, "DNO", 	ds_mst.GetColumn(cRow, "DNO"));
	ds_cond_dtl.SetColumn(0, "NUM", 	ds_mst.GetColumn(cRow, "NUM"));
	ds_cond_dtl.SetColumn(0, "PST", 	ds_mst.GetColumn(cRow, "PST"));
	ds_cond_dtl.SetColumn(0, "BGT", 	ds_mst.GetColumn(cRow, "BGT"));
	ds_cond_dtl.SetColumn(0, "BMT", 	ds_mst.GetColumn(cRow, "BMT"));
	
	// 상세데이터 조회
	gfn_clearGridSortMark(grd_dtl);
	ds_dtl.row = -1;
	ds_dtl.ClearData();

	tit_clearActionInfo();
	tit_addSearchActionInfo("cs11:CS1104001A_S2");
	tit_callService(
          ""
        , ""
        , "ds_cond=ds_cond_dtl"
        , "ds_dtl=ds_dtl"
        , ""
        , "fn_afterQueryDtl"
        , true);
}

/********************************************************************************
* 기      능   : 삽입 20
********************************************************************************/
function fn_insert() {
	// 그리드에 row 추가 
	var newRow = gfn_addGridRow(grd_list, -1, "FLAG");
}
/********************************************************************************
* 기      능   : Delete 
********************************************************************************/
function fn_delete() {
	if ( ds_list2.rowCount() < 1 ) {
		// 삭제할 정보 없음. 
		return;
	}
}
/********************************************************************************
* 기      능   : 저장 
********************************************************************************/
function fn_save() {
	if ( ds_list2.rowCount() < 1 ) {
		// 삭제할 정보 없음. 
		return;
	}
}
/********************************************************************************
* 기      능   : 닫기  
********************************************************************************/
function fn_close() {
	close();
}
/********************************************************************************
* 기      능   : 액셀  
********************************************************************************/
function fn_excel() {
	// Excel Export 
	gfn_saveToExcel(grd_mst, true );
	// gfn_saveToExcel(grd_dtl, true );
}
/********************************************************************************
* 기      능   : 접수 5
********************************************************************************/
function fn_receipt() {

}
/********************************************************************************
* 기      능   : 승인 10
********************************************************************************/
function fn_approval() {

}
/********************************************************************************
* 기      능   : 결재 15
********************************************************************************/
function fn_decide() {

}
/********************************************************************************
* 기      능   : 취소 35
********************************************************************************/
function fn_cancel() {

}
/********************************************************************************
* 기      능   : print 40
********************************************************************************/
function fn_print() {
	// 출력공통정보조회
	ds_conf_cond.SetColumn(0, "DOCNO", ed_docno.Text);	
	
	tit_clearActionInfo();
	tit_addSearchActionInfo("wb01:DOC_CONF_S1");
	tit_addSearchActionInfo("wb01:DOC_CONF_S2");
	tit_callService(
		  ""
		, ""
		, "ds_conf_cond=ds_conf_cond"
		, "ds_conf_list=ds_conf_list ds_draftpers_list=ds_draftpers_list"
		, ""
		, "fn_afterprint"
		, true);
}
function fn_afterPrint(errCode, errMsg) {
	if ( errCode!= 0 ) {
		gfn_showMsg("CE00001");
	} else {
		gfn_showMsg("CI00005");
		
		var _dataSet = ds_dtl;
		if ( _dataSet.rowCount() < 1 ) {
			// 정보 없음. 
			return;
		}
		
		// Master DataSet Setting
		ds_print_h.row = -1;
		ds_print_h.ClearData();
		ds_print_h.AddRow();
		
		ds_print_h.SetColumn(0,"DNO", 			_dataSet.GetColumn(0,"DNO")					);	// 전자결재문서번호
		ds_print_h.SetColumn(0,"D_TEM", 		ds_draftpers_list.GetColumn(0, "D_TEM")		);	// 기안부서
		ds_print_h.SetColumn(0,"D_RANK", 		ds_draftpers_list.GetColumn(0, "D_RANK")	);	// 직급
		ds_print_h.SetColumn(0,"D_NAME", 		ds_draftpers_list.GetColumn(0, "D_NAME")	);	// 기안자
		ds_print_h.SetColumn(0,"D_DATE", 		ds_draftpers_list.GetColumn(0, "D_DATE")	);	// 기안일자
		ds_print_h.SetColumn(0,"BSU_NM", 		_dataSet.GetColumn(0,"BSU_NM")				);	// 현장명
		ds_print_h.SetColumn(0,"KUNNR_NM", 		_dataSet.GetColumn(0,"KUNNR_NM")			);	// 고객명
		ds_print_h.SetColumn(0,"TELF1", 		_dataSet.GetColumn(0,"TELF1")				);	// 고객연락처
		ds_print_h.SetColumn(0,"B_VNDADR", 		_dataSet.GetColumn(0,"B_VNDADR")			);	// 업체주소
		ds_print_h.SetColumn(0,"B_VNDNM", 		_dataSet.GetColumn(0,"B_VNDNM")				);	// 업체명
		ds_print_h.SetColumn(0,"B_REPNM", 		_dataSet.GetColumn(0,"B_REPNM")				);	// 대표자
		
		// 기안처리자정보
		ds_print_h.SetColumn(0, "APRNK_S1"	  ,ds_conf_list.GetColumn(0, "APRNK_S1" 	) );	// 기안부서
		ds_print_h.SetColumn(0, "APIRUM_S1"   ,ds_conf_list.GetColumn(0, "APIRUM_S1"	) );	// 기안자
		ds_print_h.SetColumn(0, "APDATE_S1"   ,ds_conf_list.GetColumn(0, "APDATE_S1"	) );	// 기안승인일자
		ds_print_h.SetColumn(0, "APRNK_S2"    ,ds_conf_list.GetColumn(0, "APRNK_S2" 	) );
		ds_print_h.SetColumn(0, "APIRUM_S2"   ,ds_conf_list.GetColumn(0, "APIRUM_S2"	) );
		ds_print_h.SetColumn(0, "APDATE_S2"   ,ds_conf_list.GetColumn(0, "APDATE_S2"	) );
		ds_print_h.SetColumn(0, "APRNK_S3"    ,ds_conf_list.GetColumn(0, "APRNK_S3" 	) );
		ds_print_h.SetColumn(0, "APIRUM_S3"   ,ds_conf_list.GetColumn(0, "APIRUM_S3"	) );
		ds_print_h.SetColumn(0, "APDATE_S3"   ,ds_conf_list.GetColumn(0, "APDATE_S3"	) );
		ds_print_h.SetColumn(0, "APRNK_S4"    ,ds_conf_list.GetColumn(0, "APRNK_S4" 	) );
		ds_print_h.SetColumn(0, "APIRUM_S4"   ,ds_conf_list.GetColumn(0, "APIRUM_S4"	) );
		ds_print_h.SetColumn(0, "APDATE_S4"   ,ds_conf_list.GetColumn(0, "APDATE_S4"	) );
		ds_print_h.SetColumn(0, "APRNK_S5"    ,ds_conf_list.GetColumn(0, "APRNK_S5" 	) );
		ds_print_h.SetColumn(0, "APIRUM_S5"   ,ds_conf_list.GetColumn(0, "APIRUM_S5"	) );
		ds_print_h.SetColumn(0, "APDATE_S5"   ,ds_conf_list.GetColumn(0, "APDATE_S5"	) );
		ds_print_h.SetColumn(0, "APRNK_R1"    ,ds_conf_list.GetColumn(0, "APRNK_R1" 	) );	// 수신부서
		ds_print_h.SetColumn(0, "APIRUM_R1"   ,ds_conf_list.GetColumn(0, "APIRUM_R1"	) );	// 수신자
		ds_print_h.SetColumn(0, "APDATE_R1"   ,ds_conf_list.GetColumn(0, "APDATE_R1"	) );	// 수신일자
		ds_print_h.SetColumn(0, "APRNK_R2"    ,ds_conf_list.GetColumn(0, "APRNK_R2" 	) );
		ds_print_h.SetColumn(0, "APIRUM_R2"   ,ds_conf_list.GetColumn(0, "APIRUM_R2"	) );
		ds_print_h.SetColumn(0, "APDATE_R2"   ,ds_conf_list.GetColumn(0, "APDATE_R2"	) );
		ds_print_h.SetColumn(0, "APRNK_R3"    ,ds_conf_list.GetColumn(0, "APRNK_R3" 	) );
		ds_print_h.SetColumn(0, "APIRUM_R3"   ,ds_conf_list.GetColumn(0, "APIRUM_R3"	) );
		ds_print_h.SetColumn(0, "APDATE_R3"   ,ds_conf_list.GetColumn(0, "APDATE_R3"	) );
		ds_print_h.SetColumn(0, "APRNK_R4"    ,ds_conf_list.GetColumn(0, "APRNK_R4" 	) );
		ds_print_h.SetColumn(0, "APIRUM_R4"   ,ds_conf_list.GetColumn(0, "APIRUM_R4"	) );
		ds_print_h.SetColumn(0, "APDATE_R4"   ,ds_conf_list.GetColumn(0, "APDATE_R4"	) );
		ds_print_h.SetColumn(0, "APRNK_R5"    ,ds_conf_list.GetColumn(0, "APRNK_R5" 	) );
		ds_print_h.SetColumn(0, "APIRUM_R5"   ,ds_conf_list.GetColumn(0, "APIRUM_R5"	) );
		ds_print_h.SetColumn(0, "APDATE_R5"   ,ds_conf_list.GetColumn(0, "APDATE_R5"	) );
		
		// Detail DataSet Setting
		ds_print.row = -1;
		ds_print.ClearData();
		for( var i = 0; i < _dataSet.RowCount(); i++ ) {
			ds_print.AddRow();
			ds_print.SetColumn(i,"PJT", 			_dataSet.GetColumn(i,"PJT")			);	// 프로젝트
			ds_print.SetColumn(i,"ZSITE_NM", 		_dataSet.GetColumn(i,"ZSITE_NM")	);	// 현장명
			ds_print.SetColumn(i,"FDT", 			_dataSet.GetColumn(i,"FDT")			);	// 보수인수일
			ds_print.SetColumn(i,"ZMUSAOCNT", 		_dataSet.GetColumn(i,"ZMUSAOCNT")	);	// 무상공사예산개월
			ds_print.SetColumn(i,"ZMUSAOCNT2", 		_dataSet.GetColumn(i,"ZMUSAOCNT2")	);	// 무상일반예산개월
			ds_print.SetColumn(i,"GND_NM", 			_dataSet.GetColumn(i,"GND_NM")		);	// 발주구분
			ds_print.SetColumn(i,"MON", 			_dataSet.GetColumn(i,"MON")			);	// 개월수(MG1)
			ds_print.SetColumn(i,"BGT", 			_dataSet.GetColumn(i,"BGT")			);	// 발주개시일
			ds_print.SetColumn(i,"BMT", 			_dataSet.GetColumn(i,"BMT")			);	// 발주만료일
			ds_print.SetColumn(i,"HNO", 			_dataSet.GetColumn(i,"HNO")			);	// 호기
			ds_print.SetColumn(i,"AMT", 			_dataSet.GetColumn(i,"AMT")			);	// 월정금액
		} 
		
		// UbiReport Call
		Dialog("CS11::CS1101001C.xml", "");
	}
}
/********************************************************************************
* 기      능   : 발행 50
********************************************************************************/
function fn_out() {

}
/********************************************************************************
* 기      능   : 신청 55
********************************************************************************/
function fn_request() {

}
/********************************************************************************
* 기      능   : 전송 60
********************************************************************************/
function fn_trans() {

}
/********************************************************************************
* 기      능   : 반송 65
********************************************************************************/
function fn_sendback() {
	gfn_clearMsgBar();
	if ( ds_list.rowCount() < 1 ) {
		// 반송할 정보 없음. 
		return;
	}
}
/********************************************************************************
* 기      능   : 계산 70
********************************************************************************/
function fn_cal() {

}
/********************************************************************************
* 기      능   : 복사 75
********************************************************************************/
function fn_copy() {

}
/********************************************************************************
* 기      능   : 확인 80
********************************************************************************/
function fn_confirm() {

}
/********************************************************************************
* 기      능   : 기안  201411
********************************************************************************/
function fn_draft() {
	ufn_draft();
}

/* SAP와 WEB의 무상발주개월수 체크 */
function ufn_saveChk() {
	tit_clearActionInfo();
	tit_addSearchActionInfo("cs11:CS1102001A_S4");
	tit_callService(
		  ""
		, ""
		, "ds_cond_chk3=ds_cond_chk3"
		, "ds_cnt3=ds_cnt3"
		, ""
		, ""
		, true
		, true
		, true
		);
		
	if( ds_cnt3.GetColumn(0, "CNT") > 0 ) {
		gfn_showAlert("SAP와 WEB의 무상발주개월수가 다릅니다.");
		return false;
	}

	return true;
}
/* 실패여부 체크 */
function ufn_cancelFChk() {
	tit_clearActionInfo();
	tit_addSearchActionInfo("cs06:CS0602001A_S12");
	tit_callService(
		  ""
		, ""
		, "ds_cond_chk=ds_cond_chk"
		, "ds_cnt=ds_cnt"
		, ""
		, ""
		, true
		, true
		, true
		);

	if( ds_cnt.GetColumn(0,"CNT") > 0 ) {
		gfn_showAlert("CW00223");
		return false;
	}

	return true;
}
/* 유상계약과 중복여부 체크 */
function ufn_UChk() {
	tit_clearActionInfo();
	tit_addSearchActionInfo("cs06:CS0607001A_S11");
	tit_callService(
		  ""
		, ""
		, "ds_cond_chk2=ds_cond_chk2"
		, "ds_cnt2=ds_cnt2"
		, ""
		, ""
		, true
		, true
		, true
		);
	
	if( ds_cnt2.GetColumn(0,"CNT") > 0 ) {
		gfn_showAlert("CW00197");
		return false;
	}

	return true;
}

function ufn_draft() {
	
	if( !gfn_showConfirm("CI00014", "기안" ) ) return;

	trace(ds_mst.GetColumn(ds_mst.currow,"DNO"));

	// 청구 결재번호가 있는 경우만 채번
	if(length(ds_mst.GetColumn(ds_mst.currow,"DNO")) == 0) {
		ufn_getDocNo();
	} else {
	// 청구 결재번호가 있는 경우 협력사 기안 건 
	// 결재선 팝업 
		ed_docno.Text = ds_mst.GetColumn(ds_mst.currow,"DNO");
		ufn_draftPopupOpen();
	}
	
}
/* 전자결재문서번호채번 */
function ufn_getDocNo() {
	ds_docno_gen.row = -1;
	ds_docno_gen.ClearData();							
	ds_docno_gen.AddRow();							
	ds_docno_gen.SetColumn( 0, "PFX", ed_doctype.Text ); // H01, H02 … R01, R02 …		
								
	tit_clearActionInfo();							
	tit_addSearchActionInfo("wb01:DOC_CODE_GEN_S1", true);							
	tit_addSearchActionInfo("wb01:DOC_CODE_GEN_U1");							
	tit_callService(					
		, ""						
		, "ds_docno_gen_i=ds_docno_gen"						
		, "ds_docno_gen=ds_docno_gen_o"						
		, ""						
		, "ufn_setDocInfo"						
		, true);						
}


/* 전자결재문서번호채번 Callback  */
function ufn_setDocInfo(errCode, errMsg) {
	if ( errCode > 0 ) {
		gfn_showMsg("CE00001");
	} else {
		ed_docno.Text = ds_docno_gen.GetColumn(0, "DOCNO");
		gfn_showMsg("CI00003", '전자결재문서번호:' + ed_docno.Text);
		if( length(ed_docno.Text) <= 0 ) {
			var arr = ["전자결재문서번호"];
			gfn_showMsg("CW00001", arr);
			return;
		}

		ufn_draftPopupOpen();
	}
}
/* 결재선 지정 팝업 오픈 */
function ufn_draftPopupOpen() {
	
	// 보수협력사일 경우 기안접수테이블에 insert 한다.
	var user_grp = gfn_getUserGroup();
	//if( user_grp == '10' ) {
	//	alert( '보수협력시일 경우 기안접수테이블에 insert 한다!' );
	//	return;
	//}


	// 결재상태에 따른 수신/발신부서 구분처리
	var appgubn = "S";					// 내부부서 결재													
	if( ed_apstat.Text == "3" ) {
		appgubn = "R";					// 수신부서 결재
	}
	
	var docKind = '9';					// 결재종류
	//--자회사 무상발주 수정  --> 20210326 --
	//if( user_grp == '10' && substr(G_USER_ID,0,1) == '8' ) {
	if( (user_grp == '10' && substr(G_USER_ID,0,1) == '8') or substr(G_USER_ID,1,1) = '9' ) {
		var arg = "fa_docno="     + ed_docno.Text 
		        + " fa_dockind =" + docKind 
		        + " fa_appgubn="  + quote(appgubn)
		        + " fa_posid="    + quote(ed_posid.Text) ;				
		var returnArgs = gfn_openPopup2("CS0401001B", true, arg);
		if( returnArgs[0] == "S" ) {
			fn_afterDraft();
		}
	} else {
		var arg = "fa_docno=" + ed_docno.Text + " fa_dockind =" + docKind + " fa_appgubn=" + quote(appgubn);				
		var returnArgs = gfn_openPopup2("CS0401001A", true, arg);
		if( returnArgs[0] == "S" ) {
			fn_afterDraft();
		}

	}
}
function fn_afterDraft() {
	// Validation
	obj.fireevent = false;
	for( var i = 0; i < ds_dtl.RowCount(); i++ ) {
		//if( ds_dtl.GetColumn(i, "CHK") == true ) {
			ds_dtl.SetColumn(i, "FLAG", "I");
			ds_dtl.SetColumn(i, "DNO",  ed_docno.Text);
		//} else {
			//ds_dtl.SetColumn(i, "FLAG", "");
		//}
	}
	obj.fireevent = true;
	
	// 결재상태조회시 필요.
	ds_decide.row = -1;
	ds_decide.ClearData();
	ds_decide.AddRow();
	ds_decide.SetColumn(0, "DOCNO", ed_docno.Text);

	tit_clearActionInfo();
	tit_callService(
	  "CS1101001B_ACT"
	, "draft"
	, "ds_draft=ds_dtl"
	, ""
	, ""
	, "ufn_afterDraft");
}
function ufn_afterDraft(errCode, errMsg) {
	if ( errCode > 0 ) {
		gfn_showMsg("CE00001");
	} else {
		gfn_showMsg("CI00003");
		ufn_enableBtn("draft", false);
	}
	fn_query();
}


//=========================================================================================
// [ PART 4]
// Callback 함수 정의 : callback 함수명은 메인 함수의 fn_xxxx() 에서 xxxx 부분은 fn_afterXXXX()
// 형태가 되도록 작성 
//=========================================================================================
/********************************************************************************
* 기      능   : 조회 Callback  
********************************************************************************/
function fn_afterQuery(errCode, errMsg) {
	// 메시지 처리 
	gfn_showMsg("CI00002", ds_mst.RowCount()+"");
	if( ds_mst.rowcount > 0 ) {
		ds_mst.row = 0;
	}
}

/********************************************************************************
* 기      능   : 상세조회 Callback  
********************************************************************************/
function fn_afterQueryDtl(errCode, errMsg) {
	// 메시지 처리 
	//gfn_showMsg("CI00002", ds_dtl.RowCount()+"");
}

/********************************************************************************
* 기      능   : 승인 Callback  
********************************************************************************/
function fn_afterApproval(errCode, errMsg) {
}
/********************************************************************************
* 기      능   : 반송 Callback  
********************************************************************************/
function fn_afterSendback(errCode, errMsg) {
	if ( errCode!= 0 ) {
		gfn_showMsg("CE00001");
	} else {
		gfn_showMsg("CI00005");
		fn_query();
	}
}

//=========================================================================================
// [ PART 5 ]
// Detail Process Event 정의 ( User Define function )
// 사용자 정의 함수는 ufn_xxxx() 형태로 작성 
//=========================================================================================
/********************************************************************************
* 기      능   : 사용자 정의 함수  
********************************************************************************/

/* 권한에 따른 버튼제어 */
 function ufn_btnControl() {
	
	ufn_enableBtn("print", false);
	ufn_enableBtn("draft", false);
	btn_baldel.Enable = false;
	btn_balcan.Enable = false;
	
	var user_grp = gfn_getUserGroup();
	var cRow = ds_mst.GetCurrow();
	if( user_grp > "10" || length(G_DPT1) > 0 ) // 내부직원 작성가능
	{
		// 기안자 접수자는 화면에서 결재선 지정
		if(  parseInt(ds_mst.GetColumn(cRow,"APSTAT")) < 1 && ds_mst.GetColumn(cRow,"PST") == 'A1' )
		{
			ufn_enableBtn("draft", true);
		} else {
			ufn_enableBtn("draft", false);
		}
		
		// 프린트버튼 컨트롤
		if( length(ds_mst.GetColumn(cRow, "DNO")) > 0 ) {
			ufn_enableBtn("print", true);
		} else {
			ufn_enableBtn("print", false);
		}
		
		// 중도해지버튼 컨트롤
		// 중도해지관리번호가 있는경우 중도해지를 할 수 없다.
		// 진행상태가 완료이고 결재상태가 수신결재완료일때만 가능하다.
		// 중복 중도해지는 할 수 없다.
		// 자동발주도 중도해지할수 있다.
		// 반송데이터는 재차 중도해지가 가능하다.

		if( length(ds_mst.GetColumn(cRow, "NUM")) > 0 && (ds_mst.GetColumn(cRow, "APSTAT_HJ")=='1'
		                                                  || ds_mst.GetColumn(cRow, "APSTAT_HJ")=='3'
		                                                  || ds_mst.GetColumn(cRow, "APSTAT_HJ")=='4' 
		                                                  || ds_mst.GetColumn(cRow, "APSTAT_HJ")=='6') ) {
			btn_cancel.Enable = false;
		} else {
			// 진행상태가 완료이고 결재상태가 수신결재완료일때
			// 운영에 기존 데이터 기안 미결재 상태일때 처리되도록 수정
			//if( ds_mst.GetColumn(cRow, "PST") == 'A6' && (ds_mst.GetColumn(cRow, "APSTAT") == '6' || ds_mst.GetColumn(cRow, "APSTAT") == 'XX') ) {
			if( ds_mst.GetColumn(cRow, "PST") == 'A6' || (ds_mst.GetColumn(cRow, "PST") == 'A6' && ds_mst.GetColumn(cRow, "APSTAT") == 'XX'))  {
				btn_cancel.Enable = true; 
			} else {
				btn_cancel.Enable = false;
			}
			//중도해지 청구 문서가 있는 경우 중도해지 버튼 비활성화
			// if ( length(ds_mst.GetColumn(cRow, "NUM")) != 0 )
				// btn_cancel.Enable = false;
			// } else {
				// btn_cancel.Enable = true;
			// }
		}
	}
	
	// 보수협력사의 경우 결재접수테이블로 insert 한다.
	if( user_grp == '10' ) {
	//alert(ds_mst.GetColumn(cRow,"APSTAT"));
	//alert(ds_mst.GetColumn(cRow,"PST"));
		if(  parseInt(ds_mst.GetColumn(cRow,"APSTAT")) < 1 && ds_mst.GetColumn(cRow,"PST") == 'A1' )
		{
			ufn_enableBtn("draft", true);
		} else {
			ufn_enableBtn("draft", false);
		}
	} 
	
	if( ds_mst.GetColumn(cRow, "PST") <> 'A6' ) {
		btn_baldel.Enable = true;
	} else {
		btn_balcan.Enable = true;
	}
 }
 

//=========================================================================================
// [ PART 6 ]
// component Event 정의 : 각 Component 별 이벤트 
//=========================================================================================
/********************************************************************************
* 기      능   : 그리드 헤더 클릭시 정렬 처리 
********************************************************************************/
function grd_dtl_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
{
	if ( nCell == 0 ) {
		// 그리드 표시할 컬럼 선택 
		gfn_selectAllGrid2(obj, 0, 0, true);
	} else {
		// 그리드 정렬 처리 
		gfn_sortGrid(obj,nCell);
	}
}

/********************************************************************************
* 기      능   : 데이터셋 값 변경 시 - Flag 처리 
********************************************************************************/
function ds_dtl_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{
//	gfn_changeFlag( obj, strColumnID, nRow, "FLAG" );
	gfn_clearMsgBar();
	if( strColumnID == "CHK" ) {
		obj.fireevent = false;
		//if( ds_dtl.GetColumn(nRow, "CHK") == true ) {
			ds_dtl.SetColumn(nRow, "FLAG", "I");
		//} else {
			//ds_dtl.SetColumn(nRow, "FLAG", "");
		//}
		obj.fireevent = true;
	}
}

/********************************************************************************
* 기      능   : Project Popup 
********************************************************************************/
function btn_pjt_OnClick(obj)
{
	var arg = "pjt=" + quote(ed_pjt.Text);
	gfn_openPopup("CS9601002A",true,arg);
}

/********************************************************************************
* 기      능   : Detail Popup 
********************************************************************************/
function grd_mst_OnCellDblClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
	var arg = "";
	
	// 무상발주청구내역
	if( nCell == 20 ) 			{	
		if( length(ds_mst.GetColumn(nRow,"DNO")) > 0 ) {
			arg = " fa_docno=" + quote(ds_mst.GetColumn(nRow,"DNO")) + " fa_popgbn=A"
			    + " pjt=" + quote(ds_mst.GetColumn(nRow,"PJT"));
			gfn_openPopup("CS1101001B", true, arg);
		}
	}
	// 중도해지내역
	else if (  nCell == 23 ) 	{	
		if( length(ds_mst.GetColumn(nRow,"NUM")) > 0 ) {
			arg += " fa_docno=" + quote(ds_mst.GetColumn(nRow,"NUM")) + " fa_popgbn=A";
			gfn_openPopup("CS1104001D", true, arg);
		}
	}
	// 수정
	else if (  nCell == 22 ) 	{
		// 수정시 더블클릭 팝업오픈
		//자동발주 + 작성 상태인 경우 수정 가능 20150330 이하림
		if( (ds_mst.GetColumn(nRow,"APSTAT") == '0' && ds_mst.GetColumn(nRow,"PST") == 'A1')
		    || ds_mst.GetColumn(nRow,"PST") == 'A2'|| (ds_mst.GetColumn(nRow,"APSTAT") == 'XX' && ds_mst.GetColumn(nRow,"PST") == 'A1')) {
			gfn_openPopup("CS1101001B", true, arg);
		} else {
			gfn_showMsg("기안미결재 및 작성 시에만 수정이 가능합니다.");
		}
	}
	// 청구결재상태   // 해지결재상태
	else if (  nCell == 21  or nCell == 25 ) 	{
		var docNo;
		if(nCell == 21 ) {
			docNo = ds_mst.GetColumn(grd_mst.CurrentRow, "DNO");
		} else if(nCell == 25 ) {
			docNo = ds_mst.GetColumn(grd_mst.CurrentRow, "NUM");
		}		
		
		ds_cond.SetColumn(0, "DOCNO", docNo);
		
		tit_clearActionInfo();														
		tit_addSingleActionInfo("cs01:CS0101008A_S3");								//결재상세정보를 가져온다.
		tit_callService("", "", "ds_cond=ds_cond", "ds_wf_stat=ds_wf_stat", "", "", true, false,true);
	
		if(ds_wf_stat.rowcount <= 0)
		{
			return;
		}
		var statStr = "";
		 
		for(var iCnt = ds_wf_stat.rowcount - 1; iCnt >= 0; iCnt--)
		{
			statStr += ds_wf_stat.GetColumn(iCnt, "APPGUBNNM") + " / " + 
					   ds_wf_stat.GetColumn(iCnt, "SEQNONM")  + " / " + 
					   ds_wf_stat.GetColumn(iCnt, "SEQSTATNM")  + "\n    " + 
					   ds_wf_stat.GetColumn(iCnt, "APDPT1_N")  + " / " + 
					   ds_wf_stat.GetColumn(iCnt, "APRNK")  + " / " + 
					   ds_wf_stat.GetColumn(iCnt, "APIRUM")  + "\n";				   	
		}
			
		gfn_openMsgWin(statStr, "", "A", docNo + " 결재상태");
	
	}
	
}

/********************************************************************************
* 기      능   : 취소 Popup 
********************************************************************************/
function btn_cancel_OnClick(obj)
{
	var arg = "";
	gfn_openPopup("CS1104001B", true, arg);
}

/********************************************************************************
* 기      능   : 
********************************************************************************/
function grd_dtl_OnCellClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
	/*
	if( nCell == 15 && ds_list.GetColumn(nRow, "APSTAT") == "0" ) {
		if( ds_list.GetColumn(nRow, "GND") == "A" ) {
			grd_list.SetCellProp("body", 15, "Edit", "none");
		} else if( ds_list.GetColumn(nRow, "GND") == "B" ) {
			grd_list.SetCellProp("body",15,"Edit","checkbox");
		}
	}
	*/
}

/********************************************************************************
* 기      능   : 중도해지 Popup 
********************************************************************************/
function btn_cancel_openPopup(obj)
{
	/* 	=> 기성비팝업을 별도로 띄우지 않는다.
		=> 잔여기성비가 있는 것(기성비확정일이 없는것. 조회시 필요) */
	var pop_obj = gfn_openPopup("CS1104001D", true);
	fn_query();
}

/********************************************************************************
* 기      능   : 마스터 그리드변경에 의한 상세조회 이벤트 
********************************************************************************/
function grd_mst_OnCellPosChanged(obj,nRow,nCell,nOldRow,nOldCell,nPivotIndex,nOldPivotIndex)
{	
	if(ds_mst.RowCount() <> 0 ) {
		ed_apstat.Text 	= ds_mst.GetColumn(nRow, "APSTAT");	// 결재상태코드
		ed_gnd.Text    	= ds_mst.GetColumn(nRow, "GND");	// 발주구분
		ed_tem.Text 	= ds_mst.GetColumn(nRow, "TEM");	// 팀코드
		ed_docNo.Text   = ds_mst.GetColumn(nRow, "DNO");	// 결재번호
		ed_posid.Text   = ds_mst.GetColumn(nRow, "PJT");	// 결재번호
	
		// Button Controll
		ufn_btnControl();
		
		fn_queryDtl();
	}
}

/********************************************************************************
* 기      능   : 상세 체크박스 변경에 의한 플래그업데이트 
********************************************************************************/
function ds_dtl_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{
	gfn_clearMsgBar();
	if( strColumnID == "CHK" ) {
		obj.fireevent = false;
		//if( ds_dtl.GetColumn(nRow, "CHK") == true ) {
			ds_dtl.SetColumn(nRow, "FLAG", "I");
		//} else {
			//ds_dtl.SetColumn(nRow, "FLAG", "");
		//}
		obj.fireevent = true;
	}
}

function grd_mst_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
{
	if ( nCell == 0 ) {
		// 그리드 표시할 컬럼 선택 
		//gfn_selectGridCol(obj);
	} else {
		// 그리드 정렬 처리 
		gfn_sortGrid(obj,nCell);
	}
}

/* 기성비조회 */
function grd_dtl_OnCellDblClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
	// 비고
	if( nCell == 19 ) {
		var apstat = ds_dtl.GetColumn(nRow,"APSTAT");
		var pst    = ds_dtl.GetColumn(nRow,"PST");
		/* 결재승인이 완료 된 건에 대해서는 기성지급 내역이 확인이 가능하도록 보완 요청 */
		if( apstat == '6' || pst == 'A6' ) {
			var arg =  "pjt=" + quote(ds_dtl.GetColumn(nRow,"PJT")) + 
				      " hno=" + quote(ds_dtl.GetColumn(nRow,"HNO")) + 
				      " seq=" + quote(ds_dtl.GetColumn(nRow,"SEQ")) + 
				      " gnd=" + quote(ds_dtl.GetColumn(nRow,"GND")) + 
				      " mg1=" + quote(ds_dtl.GetColumn(nRow,"MG1"));

			gfn_openPopup("CS3306001A", true, arg);
		 }
	}
	
	// 2019.03.22 더블클릭 실행 시 무조건 관리부에 문의하라는 팝업이 표출되어 로직 순서를 변경함.
	if( nCell == 24 ) {
		if(delete_auth = true) {
			alert("* 삭제 대상 *"+ "\n    " + 
				"1. 직영, 자동발주 "+ "\n    " + 
				"2. 무상승인월 = 삭제작업월 "+ "\n    " );
			var arg =  "pjt=" + quote(ds_dtl.GetColumn(nRow,"PJT")) + 
					  " hno=" + quote(ds_dtl.GetColumn(nRow,"HNO")) + 
					  " seq=" + quote(ds_dtl.GetColumn(nRow,"SEQ")) + 
					  " gnd=" + quote(ds_dtl.GetColumn(nRow,"GND"));
	
			if (fn_chkDel(arg) == false) {
				alert("삭제가 불가능합니다.");
			} else {
				if(!gfn_openMsgWin("무상발주 삭제 처리를 하시겠습니까? "+ "\n    " + 
							"프로젝트 = " + quote(ds_dtl.GetColumn(nRow,"PJT")) + "\n    " + 
							"호기     = " + quote(ds_dtl.GetColumn(nRow,"HNO")) + "\n    " + 
							"발주구분 = " + quote(ds_dtl.GetColumn(nRow,"GND_NM")) 
				
				,"","C","무상발주 삭제")) return;
				
				fn_balDel();		
			} else {
				alert("서비스 관리부에 문의 바랍니다.");
			}
		}
	}
	/*if(G_USER_ID == "2021153" OR G_USER_ID == "2021200" OR G_USER_ID == "2023687" OR G_USER_ID == "2018900" OR G_USER_ID == "2029758" OR G_USER_ID == "2999999") {
		if( nCell == 24 ) {
			alert("* 삭제 대상 *"+ "\n    " + 
			"1. 직영, 자동발주 "+ "\n    " + 
			"2. 무상승인월 = 삭제작업월 "+ "\n    " );
			var arg =  "pjt=" + quote(ds_dtl.GetColumn(nRow,"PJT")) + 
					  " hno=" + quote(ds_dtl.GetColumn(nRow,"HNO")) + 
					  " seq=" + quote(ds_dtl.GetColumn(nRow,"SEQ")) + 
					  " gnd=" + quote(ds_dtl.GetColumn(nRow,"GND"));
	
			if (fn_chkDel(arg) == false) {
				alert("삭제가 불가능합니다.");
			} else {
				if(!gfn_openMsgWin("무상발주 삭제 처리를 하시겠습니까? "+ "\n    " + 
							"프로젝트 = " + quote(ds_dtl.GetColumn(nRow,"PJT")) + "\n    " + 
							"호기     = " + quote(ds_dtl.GetColumn(nRow,"HNO")) + "\n    " + 
							"발주구분 = " + quote(ds_dtl.GetColumn(nRow,"GND_NM")) 
				
				,"","C","무상발주 삭제")) return;
				
				fn_balDel();	
			}
		}
	} else {
		alert("서비스 관리부에 문의 바랍니다.");
	}*/
}
function fn_chkDel(arg) {
	//alert(arg);
	ds_chkDel.ClearData();
	tit_clearActionInfo();
	tit_addSearchActionInfo("cs11:CS1104001A_S3"); 
	tit_callService("", "", "", "ds_chkDel=ds_chkDel", arg, "", true, false,true);

	if(ds_chkDel.RowCount() <> 1) {
		return false;
	} else {
		return true;
	}
}
function fn_balDel() {
	//TRACE(ds_chkDel.SaveXML());
	tit_clearActionInfo();
	tit_addSearchActionInfo("cs11:CS1104001A_D1"); 
	tit_addSearchActionInfo("cs11:CS1104001A_U6"); 
	tit_addSearchActionInfo("cs11:CS1104001A_U7"); 						
	tit_callService(					
		, ""						
		, "ds_chkDel=ds_chkDel"						
		, ""						
		, ""						
		, "fn_afterBalDel"						
		, true);						

}
function fn_afterBalDel() {
	fn_query();
}
/********************************************************************************
* 기      능   : 미승인 발주 데이타 삭제
********************************************************************************/
function btn_baldel_OnClick(obj)
{
	ufn_balDelete();
}
/********************************************************************************
* 기      능   : 승인 발주 데이타 승인 취소
********************************************************************************/
function btn_balcan_OnClick(obj)
{
	ufn_balDelete();
}
/********************************************************************************
* 기      능   : 발주 데이타 삭제 
********************************************************************************/
function ufn_balDelete()
{
	if(ds_dtl.rowCount() < 1) {
		// 저장할 정보 없음.
		gfn_showMsg("CW00010");		//데이터가 없습니다.
		return;
	}

	if(ds_dtl.FindRow("CHK", 1) == -1) {
		gfn_showMsg("CW00013");		//처리할 자료를 먼저 선택해 주십시오.
		return;
	}
	
	tit_clearActionInfo();
	tit_callService(
	  "CS1101001B_ACT"
	, "balDelete"
	, "ds_list=ds_dtl"
	, ""
	, ""
	, "fn_afterBalDel");
}

/********************************************************************************
* 기      능   : 무상확인서 첨부 파일 확인 
********************************************************************************/
function grd_mst_OnCellClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{

	if(nCell == 27 && length(ds_mst.GetColumn(nRow, "CS649_FNA")) > 0) { // 첨부 이미지 VIEWER
	
		var arg = "fname_app=" + quote(ds_mst.GetColumn(nRow, "CS649_FNA"))
		        + " fname="     +quote(ds_mst.GetColumn(nRow, "CS649_FNA"));
		gfn_openPopup("CS0404001A", true, arg);

	}
	// 다운로드
	if ( nCell == 28 && length(ds_mst.getColumn(nRow, "CS649_FNA")) > 0 ) {
		// 첨부 파일 처리 
		saveDialog.FileName = tit_getLocalFileName(ds_mst.getColumn(nRow, "CS649_FNA"));
		if (saveDialog.open())
		{
			tit_fileRead(
				httpFile
				, "AP"
				, ds_mst.getColumn(nRow, "CS649_FNA")
				, saveDialog.FilePath
				, saveDialog.FileName);
		}
	}
}
]]></Script>
</Window>