<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="496" Id="CS1101001B" Left="8" OnLoadCompleted="fn_OnLoadCompleted" OnUnloadCompleted="fn_OnUnloadCompleted" PidAttrib="7" Title="무상발주&#32;입력" Top="8" Ver="1.0" Width="792" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_head_div">
				<Contents>
					<colinfo id="DAT" size="256" summ="default" type="STRING"/>
					<colinfo id="TEM" size="256" summ="default" type="STRING"/>
					<colinfo id="PJT" size="256" summ="default" type="STRING"/>
					<colinfo id="BSU" size="256" summ="default" type="STRING"/>
					<colinfo id="ARA" size="256" summ="default" type="STRING"/>
					<colinfo id="KUNNR" size="256" summ="default" type="STRING"/>
					<colinfo id="GND" size="256" summ="default" type="STRING"/>
					<colinfo id="DNO" size="256" summ="default" type="STRING"/>
					<colinfo id="JUC" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="CRDPT1" size="256" summ="default" type="STRING"/>
					<colinfo id="REDPT1" size="256" summ="default" type="STRING"/>
					<colinfo id="APSTAT" size="256" summ="default" type="STRING"/>
					<colinfo id="ISD" size="256" summ="default" type="STRING"/>
					<colinfo id="HNO_GB" size="256" summ="default" type="STRING"/>
					<record>
						<APSTAT></APSTAT>
						<ARA></ARA>
						<BSU></BSU>
						<CRDPT1></CRDPT1>
						<DAT></DAT>
						<DNO></DNO>
						<GBN></GBN>
						<GND></GND>
						<HNO_GB></HNO_GB>
						<ISD></ISD>
						<JUC></JUC>
						<KUNNR></KUNNR>
						<PJT></PJT>
						<REDPT1></REDPT1>
						<TEM></TEM>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_dtl_div" OnColumnChanged="ds_dtl_div_OnColumnChanged">
				<Contents>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="GND" size="256" summ="default" type="STRING"/>
					<colinfo id="GND_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="PJT" size="256" summ="default" type="STRING"/>
					<colinfo id="HNO" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="ISD" size="256" summ="default" type="STRING"/>
					<colinfo id="HNA" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSITE_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="KUNNR" size="256" summ="default" type="STRING"/>
					<colinfo id="KUNNR_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="BMT" size="256" summ="default" type="STRING"/>
					<colinfo id="BSTDK" size="256" summ="default" type="STRING"/>
					<colinfo id="MB_STN" size="256" summ="default" type="STRING"/>
					<colinfo id="MB_STN_NAME" size="256" summ="default" type="STRING"/>
					<colinfo id="HB_ST" size="256" summ="default" type="STRING"/>
					<colinfo id="FDT" size="256" summ="default" type="STRING"/>
					<colinfo id="TDT" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSPEC1" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSPEC2" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSPEC3" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSPEC" size="256" summ="default" type="STRING"/>
					<colinfo id="ARA" size="256" summ="default" type="STRING"/>
					<colinfo id="ARA_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="TEM" size="256" summ="default" type="STRING"/>
					<colinfo id="TEM_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="BPM" size="256" summ="default" type="STRING"/>
					<colinfo id="BPM_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="BSU" size="256" summ="default" type="STRING"/>
					<colinfo id="BSU_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="TYP" size="256" summ="default" type="STRING"/>
					<colinfo id="IJD" size="256" summ="default" type="STRING"/>
					<colinfo id="TELF1" size="256" summ="default" type="STRING"/>
					<colinfo id="AGB" size="256" summ="default" type="STRING"/>
					<colinfo id="ABG" size="256" summ="default" type="STRING"/>
					<colinfo id="BHD" size="256" summ="default" type="STRING"/>
					<colinfo id="CBS" size="256" summ="default" type="STRING"/>
					<colinfo id="HTY" size="256" summ="default" type="STRING"/>
					<colinfo id="JUC" size="256" summ="default" type="STRING"/>
					<colinfo id="JUN" size="256" summ="default" type="STRING"/>
					<colinfo id="MON" size="256" summ="default" type="STRING"/>
					<colinfo id="GBU" size="256" summ="default" type="STRING"/>
					<colinfo id="BGT" size="256" summ="default" type="STRING"/>
					<colinfo id="MG1" size="256" summ="default" type="STRING"/>
					<colinfo id="ZMUSAOCNT" size="256" summ="default" type="STRING"/>
					<colinfo id="ZMUSAUCNT" size="256" summ="default" type="STRING"/>
					<colinfo id="ZMUSAOCNT2" size="256" summ="default" type="STRING"/>
					<colinfo id="ZMUSAUCNT2" size="256" summ="default" type="STRING"/>
					<colinfo id="SQL_GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="PJTHNO" size="256" summ="default" type="STRING"/>
					<colinfo id="DNO" size="256" summ="default" type="STRING"/>
					<colinfo id="APSTAT" size="256" summ="default" type="STRING"/>
					<colinfo id="APSTATNM" size="256" summ="default" type="STRING"/>
					<colinfo id="CRDPT1" size="256" summ="default" type="STRING"/>
					<colinfo id="REDPT1" size="256" summ="default" type="STRING"/>
					<colinfo id="MUT" size="255" summ="default" type="STRING"/>
					<colinfo id="AMT" size="255" summ="default" type="STRING"/>
					<colinfo id="G_VBNM" size="255" summ="default" type="STRING"/>
					<colinfo id="S_VBNM" size="255" summ="default" type="STRING"/>
					<colinfo id="B_VNDADR" size="255" summ="default" type="STRING"/>
					<colinfo id="B_VNDNM" size="255" summ="default" type="STRING"/>
					<colinfo id="B_REPNM" size="255" summ="default" type="STRING"/>
					<colinfo id="ADD" size="256" summ="default" type="STRING"/>
					<colinfo id="GNO" size="256" summ="default" type="STRING"/>
					<colinfo id="AYS" size="256" summ="default" type="STRING"/>
					<colinfo id="BYS" size="256" summ="default" type="STRING"/>
					<colinfo id="BGT_A" size="256" summ="default" type="STRING"/>
					<colinfo id="BMT_A" size="256" summ="default" type="STRING"/>
					<colinfo id="BGT_B" size="256" summ="default" type="STRING"/>
					<colinfo id="BMT_B" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list_i">
				<Contents>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="GND" size="256" summ="default" type="STRING"/>
					<colinfo id="GND_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="PJT" size="256" summ="default" type="STRING"/>
					<colinfo id="HNO" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="ISD" size="256" summ="default" type="STRING"/>
					<colinfo id="HNA" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSITE_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="KUNNR" size="256" summ="default" type="STRING"/>
					<colinfo id="KUNNR_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="BMT" size="256" summ="default" type="STRING"/>
					<colinfo id="BSTDK" size="256" summ="default" type="STRING"/>
					<colinfo id="MB_STN" size="256" summ="default" type="STRING"/>
					<colinfo id="MB_STN_NAME" size="256" summ="default" type="STRING"/>
					<colinfo id="HB_ST" size="256" summ="default" type="STRING"/>
					<colinfo id="FDT" size="256" summ="default" type="STRING"/>
					<colinfo id="TDT" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSPEC1" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSPEC2" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSPEC3" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSPEC" size="256" summ="default" type="STRING"/>
					<colinfo id="ARA" size="256" summ="default" type="STRING"/>
					<colinfo id="ARA_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="TEM" size="256" summ="default" type="STRING"/>
					<colinfo id="TEM_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="BPM" size="256" summ="default" type="STRING"/>
					<colinfo id="BPM_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="BSU" size="256" summ="default" type="STRING"/>
					<colinfo id="BSU_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="TYP" size="256" summ="default" type="STRING"/>
					<colinfo id="IJD" size="256" summ="default" type="STRING"/>
					<colinfo id="TELF1" size="256" summ="default" type="STRING"/>
					<colinfo id="AGB" size="256" summ="default" type="STRING"/>
					<colinfo id="ABG" size="256" summ="default" type="STRING"/>
					<colinfo id="BHD" size="256" summ="default" type="STRING"/>
					<colinfo id="CBS" size="256" summ="default" type="STRING"/>
					<colinfo id="HTY" size="256" summ="default" type="STRING"/>
					<colinfo id="JUC" size="256" summ="default" type="STRING"/>
					<colinfo id="JUN" size="256" summ="default" type="STRING"/>
					<colinfo id="MON" size="256" summ="default" type="STRING"/>
					<colinfo id="GBU" size="256" summ="default" type="STRING"/>
					<colinfo id="BGT" size="256" summ="default" type="STRING"/>
					<colinfo id="MG1" size="256" summ="default" type="STRING"/>
					<colinfo id="ZMUSAOCNT" size="256" summ="default" type="STRING"/>
					<colinfo id="ZMUSAUCNT" size="256" summ="default" type="STRING"/>
					<colinfo id="ZMUSAOCNT2" size="256" summ="default" type="STRING"/>
					<colinfo id="ZMUSAUCNT2" size="256" summ="default" type="STRING"/>
					<colinfo id="SQL_GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="PJTHNO" size="256" summ="default" type="STRING"/>
					<colinfo id="DNO" size="256" summ="default" type="STRING"/>
					<colinfo id="APSTAT" size="256" summ="default" type="STRING"/>
					<colinfo id="APSTATNM" size="256" summ="default" type="STRING"/>
					<colinfo id="CRDPT1" size="256" summ="default" type="STRING"/>
					<colinfo id="REDPT1" size="256" summ="default" type="STRING"/>
					<colinfo id="MUT" size="255" summ="default" type="STRING"/>
					<colinfo id="AMT" size="255" summ="default" type="STRING"/>
					<colinfo id="G_VBNM" size="255" summ="default" type="STRING"/>
					<colinfo id="S_VBNM" size="255" summ="default" type="STRING"/>
					<colinfo id="B_VNDADR" size="255" summ="default" type="STRING"/>
					<colinfo id="B_VNDNM" size="255" summ="default" type="STRING"/>
					<colinfo id="B_REPNM" size="255" summ="default" type="STRING"/>
					<colinfo id="ADD" size="256" summ="default" type="STRING"/>
					<colinfo id="GNO" size="256" summ="default" type="STRING"/>
					<colinfo id="AYS" size="256" summ="default" type="STRING"/>
					<colinfo id="BYS" size="256" summ="default" type="STRING"/>
					<colinfo id="BGT_A" size="256" summ="default" type="STRING"/>
					<colinfo id="BMT_A" size="256" summ="default" type="STRING"/>
					<colinfo id="BGT_B" size="256" summ="default" type="STRING"/>
					<colinfo id="BMT_B" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_gnd">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME>-&#32;선택&#32;-</CODE_NAME>
					</record>
					<record>
						<CODE>A</CODE>
						<CODE_NAME>무상공사</CODE_NAME>
					</record>
					<record>
						<CODE>B</CODE>
						<CODE_NAME>무상일반</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_error">
				<Contents>
					<colinfo id="IDX" size="256" summ="default" type="STRING"/>
					<colinfo id="ERRMSG" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_conf_cond">
				<Contents>
					<colinfo id="DOCNO" size="256" summ="default" type="STRING"/>
					<record>
						<DOCNO></DOCNO>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_conf_list">
				<Contents>
					<colinfo id="APRNK_S1" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM_S1" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE_S1" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK_S2" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM_S2" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE_S2" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK_S3" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM_S3" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE_S3" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK_S4" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM_S4" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE_S4" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK_S5" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM_S5" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE_S5" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK_R1" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM_R1" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE_R1" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK_R2" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM_R2" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE_R2" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK_R3" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM_R3" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE_R3" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK_R4" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM_R4" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE_R4" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK_R5" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM_R5" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE_R5" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_draftpers_list">
				<Contents>
					<colinfo id="D_TEM" size="256" summ="default" type="STRING"/>
					<colinfo id="D_RANK" size="256" summ="default" type="STRING"/>
					<colinfo id="D_NAME" size="256" summ="default" type="STRING"/>
					<colinfo id="D_DATE" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_print_h">
				<Contents>
					<colinfo id="DNO" size="256" summ="default" type="STRING"/>
					<colinfo id="D_TEM" size="256" summ="default" type="STRING"/>
					<colinfo id="D_RANK" size="256" summ="default" type="STRING"/>
					<colinfo id="D_NAME" size="256" summ="default" type="STRING"/>
					<colinfo id="D_DATE" size="256" summ="default" type="STRING"/>
					<colinfo id="BSU_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="KUNNR_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="TELF1" size="256" summ="default" type="STRING"/>
					<colinfo id="B_VNDADR" size="256" summ="default" type="STRING"/>
					<colinfo id="B_VNDNM" size="256" summ="default" type="STRING"/>
					<colinfo id="B_REPNM" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK_S1" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM_S1" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE_S1" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK_S2" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM_S2" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE_S2" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK_S3" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM_S3" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE_S3" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK_S4" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM_S4" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE_S4" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK_S5" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM_S5" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE_S5" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK_R1" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM_R1" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE_R1" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK_R2" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM_R2" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE_R2" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK_R3" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM_R3" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE_R3" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK_R4" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM_R4" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE_R4" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK_R5" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM_R5" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE_R5" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_print">
				<Contents>
					<colinfo id="PJT" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSITE_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="FDT" size="256" summ="default" type="STRING"/>
					<colinfo id="ZMUSAOCNT" size="256" summ="default" type="STRING"/>
					<colinfo id="ZMUSAOCNT2" size="256" summ="default" type="STRING"/>
					<colinfo id="GND_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="MON" size="256" summ="default" type="STRING"/>
					<colinfo id="BGT" size="256" summ="default" type="STRING"/>
					<colinfo id="BMT" size="256" summ="default" type="STRING"/>
					<colinfo id="HNO" size="256" summ="default" type="STRING"/>
					<colinfo id="AMT" size="255" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_doc_cond">
				<Contents>
					<colinfo id="DOCTYPE" size="256" summ="default" type="STRING"/>
					<colinfo id="TEM" size="256" summ="default" type="STRING"/>
					<record>
						<DOCTYPE></DOCTYPE>
						<TEM></TEM>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond_chk">
				<Contents>
					<colinfo id="PJT" size="256" summ="default" type="STRING"/>
					<colinfo id="HNO" size="256" summ="default" type="STRING"/>
					<record>
						<HNO></HNO>
						<PJT></PJT>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond_chk2">
				<Contents>
					<colinfo id="PJT" size="256" summ="default" type="STRING"/>
					<colinfo id="HNO" size="256" summ="default" type="STRING"/>
					<colinfo id="BGT" size="256" summ="default" type="STRING"/>
					<colinfo id="BMT" size="256" summ="default" type="STRING"/>
					<record>
						<BGT></BGT>
						<BMT></BMT>
						<HNO></HNO>
						<PJT></PJT>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cnt">
				<Contents>
					<colinfo id="CNT" size="256" summ="default" type="STRING"/>
					<record>
						<CNT></CNT>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cnt2">
				<Contents>
					<colinfo id="CNT" size="256" summ="default" type="STRING"/>
					<record>
						<CNT></CNT>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond_chk3">
				<Contents>
					<colinfo id="POSID_1" size="256" summ="default" type="STRING"/>
					<colinfo id="GND" size="256" summ="default" type="STRING"/>
					<colinfo id="MON" size="256" summ="default" type="STRING"/>
					<record>
						<GND></GND>
						<MON></MON>
						<POSID_1></POSID_1>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cnt3">
				<Contents>
					<colinfo id="CNT" size="256" summ="default" type="STRING"/>
					<record>
						<CNT></CNT>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_apstat_cb">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="DTEXT1" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_decide">
				<Contents>
					<colinfo id="MANDT" size="256" summ="default" type="STRING"/>
					<colinfo id="DOCNO" size="256" summ="default" type="STRING"/>
					<colinfo id="DOCKIND" size="256" summ="default" type="STRING"/>
					<colinfo id="APPGUBN" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQNO" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQSTAT" size="256" summ="default" type="STRING"/>
					<colinfo id="APDPT1" size="256" summ="default" type="STRING"/>
					<colinfo id="APDPT1_N" size="256" summ="default" type="STRING"/>
					<colinfo id="APNUM" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE" size="256" summ="default" type="STRING"/>
					<colinfo id="APTIM" size="256" summ="default" type="STRING"/>
					<colinfo id="APDESC" size="256" summ="default" type="STRING"/>
					<colinfo id="APSTAT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cnt4">
				<Contents>
					<colinfo id="CNT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_zcst649">
				<Contents>
					<colinfo id="CS649_DOC" size="256" summ="default" type="STRING"/>
					<colinfo id="CS649_FNA" size="256" summ="default" type="STRING"/>
					<colinfo id="FNAM_YN" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_docno_gen">
				<Contents>
					<colinfo id="PFX" size="256" summ="default" type="STRING"/>
					<colinfo id="DOCNO" size="256" summ="default" type="STRING"/>
					<record>
						<DOCNO></DOCNO>
						<PFX></PFX>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_rcond">
				<Contents>
					<colinfo id="ZPROGRAM" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN" size="256" summ="default" type="STRING"/>
					<record>
						<GBN></GBN>
						<ZPROGRAM></ZPROGRAM>
					</record>
				</Contents>
			</Dataset>
		</Datasets>
		<Shape BKColor="user12" Bottom="66" Height="26" Id="Shape1" Left="7" LineColor="user13" Right="779" TabOrder="3" Top="40" Type="Rectangle" Width="772"></Shape>
		<Grid AutoEnter="TRUE" AutoFitEndLine="Hide" BindDataset="ds_dtl_div" BkColor2="default" BoldHead="true" Border="Flat" Bottom="425" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="309" Id="grd_dtl" InputPanel="FALSE" Left="7" LineColor="user20" LineType="ExHORZ" OnHeadClick="grd_dtl_OnHeadClick" Right="779" RowHeight="20" Style="sty_grid" TabOrder="1" TabStop="true" Top="116" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="772">
			<contents>
				<format id="Default">
					<columns>
						<col width="25"/>
						<col width="40"/>
						<col width="58"/>
						<col width="41"/>
						<col width="80"/>
						<col width="86"/>
						<col width="126"/>
						<col width="80"/>
						<col width="60"/>
						<col width="60"/>
						<col width="80"/>
						<col width="80"/>
						<col width="60"/>
						<col width="60"/>
						<col width="80"/>
						<col width="80"/>
						<col width="0"/>
						<col width="0"/>
						<col width="70"/>
					</columns>
					<head>
						<cell col="0" display="checkbox" edit="checkbox" rowspan="2"/>
						<cell col="1" display="text" font="굴림,9" rowspan="2" text="No"/>
						<cell align="center" col="2" display="text" font="굴림,9" rowspan="2" text="Proj&#32;No"/>
						<cell col="3" display="text" font="굴림,9" rowspan="2" text="호기"/>
						<cell col="4" display="text" font="굴림,9" rowspan="2" text="호기명"/>
						<cell align="center" col="5" display="text" font="굴림,9" rowspan="2" text="기종"/>
						<cell col="6" display="text" font="굴림,9" rowspan="2" text="사양"/>
						<cell col="7" display="text" font="굴림,9" rowspan="2" text="인수일자"/>
						<cell col="8" colspan="4" display="text" font="굴림,9" text="무상공사"/>
						<cell col="8" display="text" font="굴림,9" row="1" text="예산개월"/>
						<cell col="9" display="text" font="굴림,9" row="1" text="사용개월"/>
						<cell col="10" display="text" font="굴림,9" row="1" text="발주개시일"/>
						<cell col="11" display="text" font="굴림,9" row="1" text="발주만료일"/>
						<cell col="12" colspan="4" display="text" font="굴림,9" text="무상일반"/>
						<cell col="12" display="text" font="굴림,9" row="1" text="예산개월"/>
						<cell col="13" display="text" font="굴림,9" row="1" text="사용개월"/>
						<cell col="14" display="text" font="굴림,9" row="1" text="발주개시일"/>
						<cell col="15" display="text" font="굴림,9" row="1" text="발주만료일"/>
						<cell col="16" display="text" font="굴림,9" rowspan="2" text="발주개시일"/>
						<cell col="17" display="text" font="굴림,9" rowspan="2" text="발주만료일"/>
						<cell col="18" display="text" font="굴림,9" rowspan="2" text="발주개월수"/>
					</head>
					<body>
						<cell col="0" colid="CHK" display="checkbox" edit="checkbox"/>
						<cell align="center" col="1" display="text" expr="currow+1"/>
						<cell align="center" col="2" colid="PJT" display="text" font="굴림,9"/>
						<cell align="center" col="3" colid="HNO" display="text" font="굴림,9"/>
						<cell align="center" col="4" colid="HNA" display="text" font="굴림,9"/>
						<cell align="center" col="5" colid="TYP" display="text" font="굴림,9"/>
						<cell align="left" col="6" colid="ZSPEC2" display="text"/>
						<cell align="center" col="7" colid="ISD" display="text" Mask="####.##.##"/>
						<cell align="center" col="8" colid="ZMUSAOCNT" display="text"/>
						<cell align="center" col="9" colid="ZMUSAUCNT" display="text"/>
						<cell align="center" col="10" colid="BGT_A" display="text" Mask="####.##.##"/>
						<cell align="center" col="11" colid="BMT_A" display="text" Mask="####.##.##"/>
						<cell align="center" col="12" colid="ZMUSAOCNT2" display="text"/>
						<cell align="center" col="13" colid="ZMUSAUCNT2" display="text"/>
						<cell align="center" col="14" colid="BGT_B" display="text" Mask="####.##.##"/>
						<cell align="center" col="15" colid="BMT_B" display="text" Mask="####.##.##"/>
						<cell col="16" colid="BGT" display="text" Mask="####.##.##"/>
						<cell align="center" col="17" colid="BMT" display="text" Mask="####.##.##"/>
						<cell align="right" col="18" colid="MON" display="text"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Div Height="36" Id="div_btn" TabOrder="2" Text="Div0" ToolTipFont="Default,0" Url="WB01::CommBtnForm.xml" Width="792">
			<Contents></Contents>
		</Div>
		<Static Align="Center" Height="24" Id="Static0" Left="224" Style="sty_lb_form_basic" TabOrder="4" Text="보수업체명" Top="41" VAlign="Middle" Width="80"></Static>
		<Edit Border="Flat" Enable="FALSE" Height="20" Id="ed_bsu_nm" Left="306" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="5" Top="43" Width="166"></Edit>
		<Static Align="Center" Height="24" Id="Static2" Left="8" Style="sty_lb_form_basic" TabOrder="6" Text="팀명" Top="41" VAlign="Middle" Width="80"></Static>
		<Edit Border="Flat" Enable="FALSE" Height="20" Id="ed_tem_nm" Left="90" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="7" Top="43" Width="126"></Edit>
		<Shape BKColor="user12" Bottom="115" Height="26" Id="Shape0" Left="7" LineColor="user13" Right="779" TabOrder="8" Top="89" Type="Rectangle" Width="772"></Shape>
		<Static Align="Center" Height="24" Id="Static3" Left="224" Style="sty_lb_form_basic" TabOrder="9" Text="입주일자" Top="90" VAlign="Middle" Width="80"></Static>
		<Static Align="Center" Height="24" Id="Static5" Left="8" Style="sty_lb_form_basic" TabOrder="10" Text="발주개시일" Top="90" VAlign="Middle" Width="80"></Static>
		<Static Align="Center" Height="24" Id="Static7" Left="479" Style="sty_lb_form_basic" TabOrder="11" Text="주택관리업체" Top="90" VAlign="Middle" Width="80"></Static>
		<Edit BKColor="khaki" Border="Flat" Height="20" Id="ed_jucText" Left="561" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="12" Top="92" Width="191"></Edit>
		<Shape BKColor="user12" Bottom="91" Height="26" Id="Shape4" Left="7" LineColor="user13" Right="779" TabOrder="13" Top="65" Type="Rectangle" Width="772"></Shape>
		<Static Align="Center" Height="24" Id="Static8" Left="224" Style="sty_lb_form_basic" TabOrder="14" Text="고객연락처" Top="66" VAlign="Middle" Width="80"></Static>
		<Edit BKColor="khaki" Border="Flat" Enable="FALSE" Height="20" Id="ed_kunnr_nm" Left="90" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="17" Top="68" Width="126"></Edit>
		<Static Align="Center" Height="24" Id="Static9" Left="8" Style="sty_lb_form_basic" TabOrder="15" Text="고객명" Top="66" VAlign="Middle" Width="80"></Static>
		<Static Align="Center" Height="24" Id="Static10" Left="479" Style="sty_lb_form_basic" TabOrder="16" Text="발주구분" Top="66" VAlign="Middle" Width="80"></Static>
		<Calendar BKColor="khaki" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="E_DATE" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_bgt" Left="90" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="18" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="93" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="78"></Calendar>
		<Calendar BKColor="khaki" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="E_DATE" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_ijd" Left="306" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="19" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="92" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="78"></Calendar>
		<Edit BKColor="khaki" Border="Flat" Enable="FALSE" Height="20" Id="ed_telf1" Left="306" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="20" Top="68" Width="166"></Edit>
		<Button Cursor="HAND" Height="18" Id="btn_juc" ImageID="btn_icon_search" Left="757" OnClick="btn_juc_OnClick" TabOrder="21" Text="Button0" Top="93" Width="18"></Button>
		<Static Align="Center" Height="24" Id="Static1" Left="479" Style="sty_lb_form_basic" TabOrder="22" Text="현장명" Top="41" VAlign="Middle" Width="80"></Static>
		<Edit Border="Flat" Enable="FALSE" Height="20" Id="ed_zsite_nm" Left="561" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="23" Top="43" Width="214"></Edit>
		<Combo BindDataset="ds_head_div" BKColor="khaki" Border="Flat" CodeColumn="CODE" Column="GND" DataColumn="CODE_NAME" Enable="FALSE" Height="20" Id="cb_gnd" INDEX="0" InnerDataset="ds_gnd" Left="560" Style="sty_ipt_search" TabOrder="24" Top="68" Width="104"></Combo>
		<Edit Height="15" Id="ed_juc" Left="672" TabOrder="25" Top="72" Visible="FALSE" Width="58"></Edit>
		<Edit Height="21" Id="ed_doctype" Left="8" TabOrder="26" Text="전자결재문서유형" Top="504" Visible="FALSE" Width="98"></Edit>
		<Edit Height="21" Id="ed_tem" Left="112" TabOrder="27" Text="팀코드" Top="504" Visible="FALSE" Width="42"></Edit>
		<Static Align="Center" Height="24" Id="Static4" Left="8" Style="sty_lb_form_basic" TabOrder="29" Text="발주개시일" Top="426" VAlign="Middle" Width="80"></Static>
		<Shape BKColor="user12" Bottom="452" Height="26" Id="Shape2" Left="7" LineColor="user13" Right="779" TabOrder="28" Top="426" Type="Rectangle" Width="772"></Shape>
		<Static Align="Center" Height="24" Id="Static6" Left="224" Style="sty_lb_form_basic" TabOrder="30" Text="결재상태" Top="427" VAlign="Middle" Width="80"></Static>
		<Combo Border="Flat" CodeColumn="CODE" DataColumn="DTEXT1" Enable="FALSE" Height="20" Id="cb_apstat" INDEX="0" InnerDataset="ds_apstat_cb" Left="304" Style="sty_ipt_search" TabOrder="31" Top="428" Width="104"></Combo>
		<Static Align="Center" Height="24" Id="Static11" Left="8" Style="sty_lb_form_basic" TabOrder="32" Text="결재번호" Top="427" VAlign="Middle" Width="80"></Static>
		<Edit Border="Flat" Enable="FALSE" Height="20" Id="ed_docno" Left="89" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="33" Top="429" Width="134"></Edit>
		<Shape BKColor="user12" Bottom="476" Height="26" Id="Shape3" Left="7" LineColor="user13" Right="779" TabOrder="34" Top="450" Type="Rectangle" Width="772"></Shape>
		<Static Align="Center" Height="24" Id="Static12" Left="8" Style="sty_lb_form_basic" TabOrder="35" Text="누락정보" Top="451" VAlign="Middle" Width="80"></Static>
		<Checkbox BKColor="user5" Enable="FALSE" Height="17" Id="chk_2" Left="96" TabOrder="36" Text="고객정보누락" Top="455" Value="FALSE" Width="112"></Checkbox>
		<Checkbox BKColor="user5" Enable="FALSE" Height="17" Id="chk_3" Left="216" TabOrder="37" Text="호기명누락" Top="455" Value="FALSE" Width="112"></Checkbox>
		<Checkbox BKColor="user5" Enable="FALSE" Height="17" Id="chk_4" Left="336" TabOrder="38" Text="점검자누락" Top="455" Value="FALSE" Width="112"></Checkbox>
		<Checkbox BKColor="user5" Enable="FALSE" Height="17" Id="chk_5" Left="456" TabOrder="39" Text="유상계약" Top="455" Value="FALSE" Width="112"></Checkbox>
		<Static Align="Center" Height="24" Id="st_uploadFlag" Left="576" Style="sty_lb_form_basic" TabOrder="40" Text="무상확인서" Top="426" VAlign="Middle" Width="80"></Static>
		<Edit Align="CENTER" BindDataset="ds_zcst649" Border="Flat" Column="FNAM_YN" Enable="FALSE" Height="20" Id="ed_uploadFlag" Left="658" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="41" Top="428" Width="30"></Edit>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_viewFile" ImageID="btn_sub_04" Left="696" LeftMargin="12" OnClick="btn_viewFile_OnClick" Style="sty_btn" TabOrder="42" Text="파일보기" Top="428" Transparent="TRUE" Width="80"></Button>
	</Form>
	<Script><![CDATA[﻿﻿﻿﻿﻿﻿﻿/*
 ******************************************************************************************
 * 기      능   : 
 * 작  성  자   : 
 * 작성  일자   : 
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
#include "LIB::commons.js";	// 공통 스크립트 
#include "LIB::common_cs.js";	// 서비스 공통 스크립트
//=========================================================================================
// [ PART 1 ]
// Form에서 사용될 전역변수를 선언
// FORM에서 사용되는 전역변수는 대문자로 작성하며, F_XXX 의 형태를 갖도록 한다. 
//=========================================================================================
var status = false;	// 저장상태여부확인
var vDPT = "";

//=========================================================================================
// [ PART 2 ]
// Form Loading / Unloading 시 작업 정의
//=========================================================================================
function fn_OnLoadCompleted(obj) {
	gfn_initForm();
	//============== 수신부서 결재그룹 체크 ===============================	
	gfn_initDs(ds_rcond, true);
	ds_rcond.SetColumn(0, "ZPROGRAM", "WBAP_DOCKIND");
	ds_rcond.SetColumn(0, "GBN", "01");	
	vDPT = gfn_getAuthDpt(ds_rcond);
	ds_rcond.ClearData();
    //=========================================================    
	fn_init();

	// 초기화 완료메시지
	gfn_showMsg("CI00007");
}
function fn_init() {	
	
	status = false;
	if( isExistVar("fa_docno",true) == 1 && length(fa_docno) > 0 ) {
		ds_head_div.SetColumn(0, "DNO", 	fa_docno);
		ds_head_div.SetColumn(0, "PJT", 	pjt);
		
		div_btn.btn_draft.Enable = false;		// 기안버튼
		div_btn.btn_print.Enable = true;		// 출력버튼
		div_btn.btn_save.Enable  = false;		// 저장버튼
		div_btn.btn_decide.Enable = false;		// 결재버튼
		div_btn.btn_sendback.Enable = false;	// 반송버튼
		
		cal_bgt.Enable 		= false;
		cal_ijd.Enable 		= false;
		ed_jucText.Enable 	= false;
		btn_juc.Visible     = false;
		ed_docno.Text       = fa_docno;
	} else {
		div_btn.btn_draft.Enable = false;		// 기안버튼
		div_btn.btn_print.Enable = false;		// 출력버튼
		div_btn.btn_save.Enable  = true;		// 저장버튼
		div_btn.btn_decide.Enable = false;		// 결재버튼
		div_btn.btn_sendback.Enable = false;	// 반송버튼
		
		// 기안미결재 저장상태인 경우 수정할 수 있게 변경한다.
		// 해더정보 셋팅
		var cRow = 0;
		var _dataSet;
		if( isExistsDataSetForParent("ds_mst") 
			&& ((parent.ds_mst.GetColumn(parent.ds_mst.GetCurrow(), "APSTAT") == '0' && parent.ds_mst.GetColumn(parent.ds_mst.GetCurrow(), "PST") == 'A1' )
			|| parent.ds_mst.GetColumn(parent.ds_mst.GetCurrow(), "PST") == 'A2' 
			||(parent.ds_mst.GetColumn(parent.ds_mst.GetCurrow(), "APSTAT") == 'XX'  && parent.ds_mst.GetColumn(parent.ds_mst.GetCurrow(), "PST") == 'A1'))
				) {
			_dataSet = parent.ds_mst;
			status = true;
		} 
		else {
			_dataSet = parent.ds_list;
			if(_dataSet.GetColumn(_dataSet.GetCurrow(), "CHK") == 'N')
				div_btn.btn_save.Enable  = false;
			status = false;
		}
		
		
		// 해더정보 셋팅
		var cRow = _dataSet.GetCurrow();
		ds_head_div.row = -1;
		ds_head_div.ClearData();
		ds_head_div.AddRow();
		
		ds_head_div.SetColumn(0, "DAT",   	gfn_getCurrDate());		// 보수인수승인일자
		ds_head_div.SetColumn(0, "TEM", 	_dataSet.GetColumn(cRow, "TEM"));		// Team Code
		ds_head_div.SetColumn(0, "PJT", 	_dataSet.GetColumn(cRow, "PJT"));		// Project No
		ds_head_div.SetColumn(0, "BSU", 	_dataSet.GetColumn(cRow, "BSU"));		// 부서코드 
		ds_head_div.SetColumn(0, "ARA", 	_dataSet.GetColumn(cRow, "ARA"));		// 지역코드
		ds_head_div.SetColumn(0, "KUNNR", 	_dataSet.GetColumn(cRow, "KUNNR"));		// 고객코드
		ds_head_div.SetColumn(0, "GND", 	_dataSet.GetColumn(cRow, "GND"));		// 발주구분(A:무상공사,B:무상일반)
		ds_head_div.SetColumn(0, "GBN", 	_dataSet.GetColumn(cRow, "GBN"));		// 추가발주여부(Y/N) 
		ds_head_div.SetColumn(0, "ISD", 	_dataSet.GetColumn(cRow, "ISD"));		// 인수일자 추가
		ds_head_div.SetColumn(0, "HNO_GB", 	_dataSet.GetColumn(cRow, "HNO_GB"));		// 인수일자 추가
		
		// 해더 display 셋팅 TELF1
		ed_tem_nm.Text    = _dataSet.GetColumn(cRow, "TEM_NM");		// 팀명
		ed_bsu_nm.Text    = _dataSet.GetColumn(cRow, "BSU_NM");		// 보수협력사명
		ed_zsite_nm.Text  = _dataSet.GetColumn(cRow, "ZSITE_NM");	// 현장명
		ed_kunnr_nm.Text  = _dataSet.GetColumn(cRow, "KUNNR_NM");	// 고객명
		ed_telf1.Text     = _dataSet.GetColumn(cRow, "TELF1");		// 고객연락처
		
		//누락정보
		chk_2.value     = _dataSet.GetColumn(cRow, "CHK2");		
		chk_3.value     = _dataSet.GetColumn(cRow, "CHK3");		
		chk_4.value     = _dataSet.GetColumn(cRow, "CHK4");	
		chk_5.value     = _dataSet.GetColumn(cRow, "CHK5");	
		
		// 전자결재문서번호 
		ed_docno.Text     = '';											// 전자결재문서번호
		ed_doctype.Text   = 'H07';										// 전자결재문서유형
		ed_tem.Text       = _dataSet.GetColumn(cRow, "TEM");			// 팀코드
		
		// 무상공사일 경우 입주일자를 입력하지 않는다.
		if( cb_gnd.Value == 'A' ) {
			cal_ijd.Enable = false;
		} else {
			cal_ijd.Enable = true;
		}
	
		// 권한에 따른 버튼제어
		ufn_btnControl();
	}

	
	// 결재상태
	var codeArr    = ["WBAP_STAT"];
	var dsObjArr   = [ds_apstat_cb];
	var addTypeArr = [G_CODE_NONE];
	gfn_searchCommCode(codeArr, dsObjArr, addTypeArr);
	
	cb_apstat.value = 0;
	
	// 상세내역조회
	if ( status ) {
		ufn_searchQueryForUpdate();
	} else {
		fn_query();
	}
}

/********************************************************************************
* 기      능   : 공통코드가 조회된 후의 Callback 함수 
********************************************************************************/
function fn_completeInit(sCode, sDsObj, sCodeType) {
}
/********************************************************************************
* 기      능   : form UnloadCompleted 
********************************************************************************/
function fn_OnUnloadCompleted(obj) {
	return gfn_isFormUnload(obj);
}
//=========================================================================================
// [ PART 3 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,form닫기)
//=========================================================================================
/********************************************************************************
* 기      능   : 조회 1
********************************************************************************/
function fn_query() {
	
	fn_createWait("", this);		//"처리중입니다. 잠시 기다려주십시오." 윈도우 create
	
	gfn_clearGridSortMark(grd_dtl);
	ds_dtl_div.row = -1;
	ds_dtl_div.ClearData();
	ds_zcst649.ClearData();
	
	var _url = "cs11:CS1101001B_S1";
	if( isExistVar("fa_docno",true) == 1 && length(fa_docno) > 0 ) {			// 문서함에서 오픈시.
		_url = "cs11:CS1101001B_S4";
	} else {
		if( ds_head_div.GetColumn(0, "GBN") == 'Y' ) {	// 추가발주일때
			_url = "cs11:CS1101001B_S8";
		} else {
			_url = "cs11:CS1101001B_S1";
		}
	}

	tit_clearActionInfo();
	tit_addSearchActionInfo("cs11:CS1101001B_S9"); // 결재자조회
	tit_addSearchActionInfo("cs11:CS1101001B_S13"); // 협력사 기안정보 
	tit_addSearchActionInfo(_url);
	tit_callService(
        ""
        , ""
        , "ds_cond=ds_head_div"
        , "ds_dtl_div=ds_list ds_decide=ds_decide ds_zcst649=ds_zcst649"
        , ""
        , "fn_afterQuery"
        , true);
}
/********************************************************************************
* 기      능   : 삽입 20
********************************************************************************/
function fn_insert() {
	// 그리드에 row 추가 
	var newRow = gfn_addGridRow(grd_dtl, -1, "FLAG");
}
/********************************************************************************
* 기      능   : Delete 
********************************************************************************/
function fn_delete() {
	if ( ds_dtl_div.rowCount() < 1 ) {
		// 삭제할 정보 없음. 
		return;
	}
	
	// Grid 삭제 처리 
	gfn_deleteGridRow( grd_dtl, ds_dtl_div.row, "FLAG" );
}
/********************************************************************************
* 기      능   : 저장 
********************************************************************************/
function fn_save() {
	// Message Bar 초기화
	gfn_clearMsgBar();
	
	// Validation
	if( !ufn_validation_default() ) {
		return;
	}
	
	if( !gfn_showConfirm("CI00014", "저장" ) ) return;
	
	// 업데이트시와 신규등록구분처리
	if( status ) {

		ds_dtl_div.fireevent = false;
		gfn_copyDs(ds_dtl_div, ds_list_i, "CHK=1");
		ds_dtl_div.fireevent = true;

		// 발주개시일로 부터 발주만료일자 계산
		var nday = substr(cal_bgt.Value,6,2);
		var month = parseInt(ds_list_i.GetColumn(0, "MON"));
		var nDate, cDate;	

		if( nday <> "01" ) {
			nDate = gfn_getAfterMonth(substr(cal_bgt.Value,0,6), parseInt(ds_list_i.GetColumn(0, "MON")) );
			if(month == 12) {
				nDate = substr(gfn_getAfterDate(cal_bgt.Value,365),0,6);
			}
			
			cDate = nDate + "" + nDay;
			cDate = gfn_getBeforeDate(cDate, 1);
		} else {
			nDate = gfn_getAfterMonth(substr(cal_bgt.Value,0,6), parseInt(ds_list_i.GetColumn(0, "MON")) - 1);
			cDate = nDate + "" + gfn_getLastDayByStr(substr(nDate,0,6));
		}	
		
		for(var i=0; i<ds_list_i.RowCount(); i++) {	
			ds_list_i.SetColumn( i, "BGT" , cal_bgt.Value); //개시일
			ds_list_i.SetColumn( i, "BHD" , cDate);         //만료일
			ds_list_i.SetColumn( i, "BMT" , cDate);         //만료일
			ds_list_i.SetColumn( i, "IJD" , cal_ijd.Value); //입주일
		}

		if( !ufn_setListValues() ) return;

		tit_clearActionInfo();
		// 재기안 타도록 기존 결재선 정보 삭제 ZWBAP01 ZWBAP02
		tit_addMultiActionInfo("cs11:CS1101001B_D2");
		tit_addMultiActionInfo("cs11:CS1101001B_D3");		
		// 협력사에서 작성한 기안문서함의 정보 삭제 ZCST649	
		tit_addMultiActionInfo("cs11:CS1101001B_D4");
		// 수정 정보 업데이트 ZCST116
		tit_addMultiActionInfo("cs11:CS1101001B_U9");
		
		// 다음 순번 발주 정보 생성 후 삭제 부분 주석 처리
		// tit_addMultiActionInfo("cs11:CS1101001B_I3");
		// tit_addMultiActionInfo("cs11:CS1101001B_D2");
		// tit_addMultiActionInfo("cs11:CS1101001B_D3");
		// tit_addMultiActionInfo("cs11:CS1101001B_D1");
		
		tit_callService(
		  ""
		, ""
		, "ds_list_d=ds_dtl_div ds_list_i=ds_list_i" 
		, ""
		, ""
		, "fn_afterSave"
		, true);
		
	} else {
	
		// Save List Values Setting
		if( !ufn_setListValues() ) return;
	
		process();
	}
}
/********************************************************************************
* 기      능   : 저장 Callback  
********************************************************************************/
function fn_afterSave(errCode, errMsg) {
	if ( ds_error.rowcount() > 0 ) {
		gfn_showAlert("CE00001");
	} else {
		gfn_showAlert("CI00003");
		div_btn.btn_draft.Enable 	= false;	// 기안버튼
		div_btn.btn_print.Enable 	= false;	// 출력버튼
		div_btn.btn_save.Enable  	= false;	// 저장버튼
		div_btn.btn_decide.Enable   = false;    // 결재버튼
		div_btn.btn_sendback.Enable	= false;  	// 반송버튼
		parent.fn_query();
			//fn_close();
	}
}

/********************************************************************************
* 기      능   : 닫기  
********************************************************************************/
function fn_close() {
	close();
}
/********************************************************************************
* 기      능   : 액셀  
********************************************************************************/
function fn_excel() {
	// Excel Export 
	gfn_saveToExcel(grd_dtl, true );
}
/********************************************************************************
* 기      능   : 접수 5
********************************************************************************/
function fn_receipt() {

}
/********************************************************************************
* 기      능   : 승인 10
********************************************************************************/
function fn_approval() {

}
/********************************************************************************
* 기      능   : 결재 15
********************************************************************************/
function fn_decide() {
	
	gfn_clearMsgBar();
	
	if( ds_dtl_div.rowCount() < 1 ) {
		// 승인할 정보 없음. 
		return;
	}
	
	if( !gfn_showConfirm("CI00014", "문서번호 : " + quote(ds_head_div.GetColumn(0,"DNO")) + "결재") ) return;
	
	var z = 0;
	for( var i = 0; i < ds_dtl_div.RowCount(); i++ ) {
		// 무상개월수가 0일 경우	
		if( ds_dtl_div.GetColumn(i, "MG1") < 1 ) { 
			var arr = [parseInt(i) + 1, "무상개월수"];
			gfn_showMsg("CW00055", arr);
			ds_dtl_div.row = i;
			return;
		}
		
		// 무상일반인 경우 반드시 확인서를 체크하고 승인해야 함
		if( ds_dtl_div.GetColumn(i, "GND") == 'B' && ds_dtl_div.GetColumn(i, "HYN") == false ) { 
			var arr = [parseInt(i) + 1];
			gfn_showMsg("CW00043", arr);
			ds_dtl_div.row = i;
			return;
		}
		
		if( ds_dtl_div.GetColumn(i, "HYN") == true ) { //확인서를 체크했을 경우
			ds_dtl_div.SetColumn(i, "THYN", "Y");
		} else {
			ds_dtl_div.SetColumn(i, "THYN", "N");
		}
		
		ds_dtl_div.SetColumn(i, "MANDT", G_MANDT);
		
		// 무상공사최초발주일자(AYS), 무상일반최초발주일자(BYS)
		if( ds_dtl_div.GetColumn(i, "GND") == 'A' && length(ds_dtl_div.GetColumn(i, "AYS")) > 0 )         {
			ds_dtl_div.SetColumn(i, "SQL_GBN", "1");
		} else if( ds_dtl_div.GetColumn(i, "GND") == 'A' && length(ds_dtl_div.GetColumn(i, "AYS")) == 0 ) {
			ds_dtl_div.SetColumn(i, "SQL_GBN", "2");
		} else if( ds_dtl_div.GetColumn(i, "GND") == 'B' && length(ds_dtl_div.GetColumn(i, "BYS"))  > 0 ) {
			ds_dtl_div.SetColumn(i, "SQL_GBN", "3");
		} else if( ds_dtl_div.GetColumn(i, "GND") == 'B' && length(ds_dtl_div.GetColumn(i, "BYS")) == 0 ) {
			ds_dtl_div.SetColumn(i, "SQL_GBN", "4");
		}

		z++;
		//alert( 'seq[' + i + ']=>' + ds_dtl.GetColumn(i, "SEQ") );
	}

	if( z == 0 ) {
		gfn_showMsg("CW00005");
		return;		
	}
	
	//----------------------------------------------------------------------
	// 의견 입력 팝업 추가 
	// f팝업 전달 변수 fa_docno : 문서번호 ,fa_dockind : 문서종류 
	// return 값 : rtn_yn (Y:의견입력됨 N:의견입력안됨)
	if(gfn_showConfirm("CW10025","의견을 입력하시겠습니까?") )
	{
		var arg = "";
		arg = " fa_docno=" + quote(ds_decide.GetColumn(0,"DOCNO")) +" fa_dockind=" + quote(ds_decide.GetColumn(0,"DOCKIND"));
		var rtn_yn = gfn_openPopup2("CS0401001C", true , arg);
	}
	//alert("rtn_yn:"+rtn_yn);
	// 의견입력 팝업 종료
	//----------------------------------------------------------------------
	
	// 결재상태변경
	ds_decide.SetColumn(0, "SEQSTAT", "3");
	
	tit_callService(
          "CS1101001B_ACT"
        , "saveDecide"
        , "ds_list=ds_dtl_div ds_decide=ds_decide"
        , "ds_error=ds_error"
        , ""
        , "fn_afterDecide");

}

/********************************************************************************
* 기      능   : 결재 Callback  
********************************************************************************/
function fn_afterDecide(errCode, errMsg) {
	if ( ds_error.rowcount() > 0 ) {
		gfn_showAlert("CE00001");
	} else {
		gfn_showAlert("CI00003");
		div_btn.btn_decide.Enable 	= false;	// 결재버튼
		div_btn.btn_draft.Enable  	= false;	// 기안버튼
		div_btn.btn_print.Enable  	= false;	// 출력버튼
		div_btn.btn_save.Enable   	= false;	// 저장버튼
		div_btn.btn_sendback.Enable = false;  	// 반송버튼
		//parent.fn_query();
			//fn_close();
	}
}
/********************************************************************************
* 기      능   : 취소 35
********************************************************************************/
function fn_cancel() {

}
/********************************************************************************
* 기      능   : print 40
********************************************************************************/
function fn_print() {
	var _dataSet = ds_dtl_div;
	if ( _dataSet.rowCount() < 1 ) {
		// 정보 없음. 
		return;
	}
	
	// Master DataSet Setting
	ds_print_h.row = -1;
	ds_print_h.ClearData();
	ds_print_h.AddRow();
	
	ds_print_h.SetColumn(0,"DNO", 			ed_docno.Text								);	// 전자결재문서번호
	ds_print_h.SetColumn(0,"D_TEM", 		ds_draftpers_list.GetColumn(0, "D_TEM")		);	// 기안부서
	ds_print_h.SetColumn(0,"D_RANK", 		ds_draftpers_list.GetColumn(0, "D_RANK")	);	// 직급
	ds_print_h.SetColumn(0,"D_NAME", 		ds_draftpers_list.GetColumn(0, "D_NAME")	);	// 기안자
	ds_print_h.SetColumn(0,"D_DATE", 		ds_draftpers_list.GetColumn(0, "D_DATE")	);	// 기안일자
	ds_print_h.SetColumn(0,"BSU_NM", 		ed_bsu_nm.Text								);	// 보수업체
	ds_print_h.SetColumn(0,"ZSITE_NM", 		ed_zsite_nm.Text							);	// 현장명
	ds_print_h.SetColumn(0,"KUNNR_NM", 		ed_kunnr_nm.Text							);	// 고객명
	ds_print_h.SetColumn(0,"TELF1", 		ed_telf1.Text								);	// 고객연락처
	ds_print_h.SetColumn(0,"B_VNDADR", 		_dataSet.GetColumn(0,"B_VNDADR")			);	// 업체주소
	ds_print_h.SetColumn(0,"B_VNDNM", 		_dataSet.GetColumn(0,"B_VNDNM")				);	// 업체명
	ds_print_h.SetColumn(0,"B_REPNM", 		_dataSet.GetColumn(0,"B_REPNM")				);	// 대표자
	
	// 기안처리자정보
	ds_print_h.SetColumn(0, "APRNK_S1"	  ,ds_conf_list.GetColumn(0, "APRNK_S1" 	) );	// 기안부서
	ds_print_h.SetColumn(0, "APIRUM_S1"   ,ds_conf_list.GetColumn(0, "APIRUM_S1"	) );	// 기안자
	ds_print_h.SetColumn(0, "APDATE_S1"   ,ds_conf_list.GetColumn(0, "APDATE_S1"	) );	// 기안승인일자
	ds_print_h.SetColumn(0, "APRNK_S2"    ,ds_conf_list.GetColumn(0, "APRNK_S2" 	) );
	ds_print_h.SetColumn(0, "APIRUM_S2"   ,ds_conf_list.GetColumn(0, "APIRUM_S2"	) );
	ds_print_h.SetColumn(0, "APDATE_S2"   ,ds_conf_list.GetColumn(0, "APDATE_S2"	) );
	ds_print_h.SetColumn(0, "APRNK_S3"    ,ds_conf_list.GetColumn(0, "APRNK_S3" 	) );
	ds_print_h.SetColumn(0, "APIRUM_S3"   ,ds_conf_list.GetColumn(0, "APIRUM_S3"	) );
	ds_print_h.SetColumn(0, "APDATE_S3"   ,ds_conf_list.GetColumn(0, "APDATE_S3"	) );
	ds_print_h.SetColumn(0, "APRNK_S4"    ,ds_conf_list.GetColumn(0, "APRNK_S4" 	) );
	ds_print_h.SetColumn(0, "APIRUM_S4"   ,ds_conf_list.GetColumn(0, "APIRUM_S4"	) );
	ds_print_h.SetColumn(0, "APDATE_S4"   ,ds_conf_list.GetColumn(0, "APDATE_S4"	) );
	ds_print_h.SetColumn(0, "APRNK_S5"    ,ds_conf_list.GetColumn(0, "APRNK_S5" 	) );
	ds_print_h.SetColumn(0, "APIRUM_S5"   ,ds_conf_list.GetColumn(0, "APIRUM_S5"	) );
	ds_print_h.SetColumn(0, "APDATE_S5"   ,ds_conf_list.GetColumn(0, "APDATE_S5"	) );
	ds_print_h.SetColumn(0, "APRNK_R1"    ,ds_conf_list.GetColumn(0, "APRNK_R1" 	) );	// 수신부서
	ds_print_h.SetColumn(0, "APIRUM_R1"   ,ds_conf_list.GetColumn(0, "APIRUM_R1"	) );	// 수신자
	ds_print_h.SetColumn(0, "APDATE_R1"   ,ds_conf_list.GetColumn(0, "APDATE_R1"	) );	// 수신일자
	ds_print_h.SetColumn(0, "APRNK_R2"    ,ds_conf_list.GetColumn(0, "APRNK_R2" 	) );
	ds_print_h.SetColumn(0, "APIRUM_R2"   ,ds_conf_list.GetColumn(0, "APIRUM_R2"	) );
	ds_print_h.SetColumn(0, "APDATE_R2"   ,ds_conf_list.GetColumn(0, "APDATE_R2"	) );
	ds_print_h.SetColumn(0, "APRNK_R3"    ,ds_conf_list.GetColumn(0, "APRNK_R3" 	) );
	ds_print_h.SetColumn(0, "APIRUM_R3"   ,ds_conf_list.GetColumn(0, "APIRUM_R3"	) );
	ds_print_h.SetColumn(0, "APDATE_R3"   ,ds_conf_list.GetColumn(0, "APDATE_R3"	) );
	ds_print_h.SetColumn(0, "APRNK_R4"    ,ds_conf_list.GetColumn(0, "APRNK_R4" 	) );
	ds_print_h.SetColumn(0, "APIRUM_R4"   ,ds_conf_list.GetColumn(0, "APIRUM_R4"	) );
	ds_print_h.SetColumn(0, "APDATE_R4"   ,ds_conf_list.GetColumn(0, "APDATE_R4"	) );
	ds_print_h.SetColumn(0, "APRNK_R5"    ,ds_conf_list.GetColumn(0, "APRNK_R5" 	) );
	ds_print_h.SetColumn(0, "APIRUM_R5"   ,ds_conf_list.GetColumn(0, "APIRUM_R5"	) );
	ds_print_h.SetColumn(0, "APDATE_R5"   ,ds_conf_list.GetColumn(0, "APDATE_R5"	) );
	
	// Detail DataSet Setting
	ds_print.row = -1;
	ds_print.ClearData();
	for( var i = 0; i < _dataSet.RowCount(); i++ ) {
		if( isExistVar("fa_docno",true) == 1 && length(fa_docno) > 0 ) {
			ds_print.AddRow();
			ds_print.SetColumn(i,"PJT", 			_dataSet.GetColumn(i,"PJT")			);	// 프로젝트
			ds_print.SetColumn(i,"ZSITE_NM", 		_dataSet.GetColumn(i,"ZSITE_NM")	);	// 현장명
			ds_print.SetColumn(i,"FDT", 			_dataSet.GetColumn(i,"FDT")			);	// 보수인수일
			ds_print.SetColumn(i,"ZMUSAOCNT", 		_dataSet.GetColumn(i,"ZMUSAOCNT")	);	// 무상공사예산개월
			ds_print.SetColumn(i,"ZMUSAOCNT2", 		_dataSet.GetColumn(i,"ZMUSAOCNT2")	);	// 무상일반예산개월
			ds_print.SetColumn(i,"GND_NM", 			_dataSet.GetColumn(i,"GND_NM")		);	// 발주구분
			ds_print.SetColumn(i,"MON", 			_dataSet.GetColumn(i,"MON")			);	// 개월수(MG1)
			ds_print.SetColumn(i,"BGT", 			_dataSet.GetColumn(i,"BGT")			);	// 발주개시일
			ds_print.SetColumn(i,"BMT", 			_dataSet.GetColumn(i,"BMT")			);	// 발주만료일
			ds_print.SetColumn(i,"HNO", 			_dataSet.GetColumn(i,"HNO")			);	// 호기
			ds_print.SetColumn(i,"AMT", 			_dataSet.GetColumn(i,"AMT")			);	// 월정금액
		} else {
			// 저장되어있지 않기때문에 처리된것(체크된것)을 목록으로써 출력한다.
			if( _dataSet.GetColumn(i, "CHK") == true ) { //체크박스가 true 일 경우
				ds_print.AddRow();
				ds_print.SetColumn(i,"PJT", 			_dataSet.GetColumn(i,"PJT")			);	// 프로젝트
				ds_print.SetColumn(i,"ZSITE_NM", 		_dataSet.GetColumn(i,"ZSITE_NM")	);	// 현장명
				ds_print.SetColumn(i,"FDT", 			_dataSet.GetColumn(i,"FDT")			);	// 보수인수일
				ds_print.SetColumn(i,"ZMUSAOCNT", 		_dataSet.GetColumn(i,"ZMUSAOCNT")	);	// 무상공사예산개월
				ds_print.SetColumn(i,"ZMUSAOCNT2", 		_dataSet.GetColumn(i,"ZMUSAOCNT2")	);	// 무상일반예산개월
				ds_print.SetColumn(i,"GND_NM", 			_dataSet.GetColumn(i,"GND_NM")		);	// 발주구분
				ds_print.SetColumn(i,"MON", 			_dataSet.GetColumn(i,"MON")			);	// 개월수(MG1)
				ds_print.SetColumn(i,"BGT", 			_dataSet.GetColumn(i,"BGT")			);	// 발주개시일
				ds_print.SetColumn(i,"BMT", 			_dataSet.GetColumn(i,"BMT")			);	// 발주만료일
				ds_print.SetColumn(i,"HNO", 			_dataSet.GetColumn(i,"HNO")			);	// 호기
				ds_print.SetColumn(i,"AMT", 			_dataSet.GetColumn(i,"AMT")			);	// 월정금액
			} 
		}
	}// end for


	// UbiReport Call
	Dialog("CS11::CS1101001C.xml", "");
}



/********************************************************************************
* 기      능   : 발행 50
********************************************************************************/
function fn_out() {

}
/********************************************************************************
* 기      능   : 신청 55
********************************************************************************/
function fn_request() {

}
/********************************************************************************
* 기      능   : 전송 60
********************************************************************************/
function fn_trans() {

}
/********************************************************************************
* 기      능   : 반송 65
********************************************************************************/
function fn_sendback() {
	
	gfn_clearMsgBar();
	
	if( ds_dtl_div.rowCount() < 1 ) {
		// 승인할 정보 없음. 
		return;
	}
	
	if( !gfn_showConfirm("CI00014", "문서번호 : "+ quote(ds_head_div.GetColumn(0,"DNO"))+ "반송") ) return;
	
	tit_clearActionInfo();
	// 무상보수발주정보(zcst116) insert
	//반려시 SEQ+1 INSERT 하는 로직 삭제 20150212 
	//tit_addMultiActionInfo("cs11:CS1101001B_I2");	
	
	// 무상보수발주정보(zcst116) update
	tit_addMultiActionInfo("cs11:CS1101001B_U8");
	
	// 결재상태변경
	ds_decide.SetColumn(0, "SEQSTAT", "2");
	
	// 결재정보 관리 - 차순별 결재정보  update(zwbap02)
	tit_addMultiActionInfo("cs04:CS0401002A_U2");
	
	// 현장지원 결재 정보 관리 update(zwbap01)
	tit_addMultiActionInfo("cs04:CS0401002A_U3");
	
	tit_callService(
		  ""
		, ""
		, "ds_list_0=ds_decide ds_list=ds_dtl_div" 
		, ""
		, ""
		, "fn_afterSendback"
		, true);
}

/********************************************************************************
* 기      능   : 반송 Callback  
********************************************************************************/
function fn_afterSendback(errCode, errMsg) {
	if ( ds_error.rowcount() > 0 ) {
		gfn_showMsg("CE00001");
	} else {
		gfn_showMsg("CI00003");
		div_btn.btn_decide.Enable 	= false;	// 결재버튼
		div_btn.btn_draft.Enable  	= false;	// 기안버튼
		div_btn.btn_print.Enable  	= false;	// 출력버튼
		div_btn.btn_save.Enable   	= false;	// 저장버튼
		div_btn.btn_sendback.Enable = false;  	// 반송버튼
		//parent.fn_query();
			//fn_close();
	}
}
/********************************************************************************
* 기      능   : 계산 70
********************************************************************************/
function fn_cal() {

}
/********************************************************************************
* 기      능   : 복사 75
********************************************************************************/
function fn_copy() {

}
/********************************************************************************
* 기      능   : 확인 80
********************************************************************************/
function fn_confirm() {

}
/********************************************************************************
* 기      능   : 기안  201411
********************************************************************************/
function fn_draft() {
	gfn_clearMsgBar();
	
	if( !gfn_showConfirm("CI00014", "기안" )) {
		return;
	}
	
	// 문서번호 없을시 채번
	if(length(ed_docno.Text) < 1) {
		ufn_getDocNo();
	}
	
	ufn_draftPopupOpen();
}
function ufn_draftPopupOpen() {
	// 결재상태에 따른 수신/발신부서 구분처리
	var appgubn = "S";					// 내부부서 결재	
	if( cb_apstat.value == "3" ) {
		appgubn = "R";					// 수신부서 결재	=> 결재상태 
	}
	
	var docKind = '9';					// 결재종류
	var arg = "fa_docno=" + ed_docno.Text + " fa_dockind =" + docKind + " fa_appgubn=" + quote(appgubn);	
				TRACE("arg = " + arg);
	var returnArgs = gfn_openPopup2("CS0401001A", true, arg);	
	if( returnArgs[0] == "S" ) {
		gfn_showMsg("CI00003", '전자결재문서번호:' + ed_docno.Text);
		div_btn.btn_draft.Enable = false;	// 기안버튼
		//div_btn.btn_decide.Enable = true;	// 결재버튼
		
		// 저장 후 기안처리시
		if( cb_apstat.value == "0" ) {
			// Validation
			obj.fireevent = false;
			for( var i = 0; i < ds_dtl_div.RowCount(); i++ ) {
				ds_dtl_div.SetColumn(i, "FLAG", "I");
				ds_dtl_div.SetColumn(i, "DNO",  ed_docno.Text);
			}
			obj.fireevent = true;
		
			tit_clearActionInfo();
			tit_callService(
			  "CS1101001B_ACT"
			, "draft"
			, "ds_draft=ds_dtl_div ds_decide=ds_decide"
			, ""
			, ""
			, "fn_afterDraft");
		}
		
		// 반송이 아닌 상신처리시.
		if( cb_apstat.value == "3" && returnArgs[1] == '' ) {
			// 기안과 동시에 수신결재완료처리인경우 후속프로세스를 처리하기위해 기안완료후 상태를 조회한다.		
			tit_clearActionInfo();
			tit_addSearchActionInfo("cs11:CS1101001B_S11");
			tit_callService(
			  ""
			, ""
			, "ds_cond=ds_head_div"
			, "ds_decide=ds_decide"
			, ""
			, "ufn_draftAndDecide"
			, true);
			
		}
		
		// (수신부서)기안반송처리시
		if( cb_apstat.value == "3" && returnArgs[1] == 'S' ) {

			tit_clearActionInfo();
			// 무상보수발주정보(zcst116) insert
			tit_addMultiActionInfo("cs11:CS1101001B_I2");
			// 무상보수발주정보(zcst116) update
			tit_addMultiActionInfo("cs11:CS1101001B_U8");
			tit_callService(
				  ""
				, ""
				, "ds_list=ds_dtl_div" 
				, ""
				, ""
				, "fn_afterSendback"
				, true);
		}

	} 
	fn_init();
	
}
function ufn_draftAndDecide(errCode, errMsg) {
	
	// 최종기안과동시에 결재완료인경우처리
	if( ds_decide.rowcount > 0 && ds_decide.GetColumn(0, "APSTAT") == '6' ) { 
	
		if ( ds_error.rowcount() > 0 ) {
			gfn_showAlert("CE00001");
		} else {
			var z = 0;
			for( var i = 0; i < ds_dtl_div.RowCount(); i++ ) {
		
				if( ds_dtl_div.GetColumn(i, "HYN") == true ) { //확인서를 체크했을 경우
					ds_dtl_div.SetColumn(i, "THYN", "Y");
				} else {
					ds_dtl_div.SetColumn(i, "THYN", "N");
				}
				
				ds_dtl_div.SetColumn(i, "MANDT", G_MANDT);
				
				// 무상공사최초발주일자(AYS), 무상일반최초발주일자(BYS)
				if( ds_dtl_div.GetColumn(i, "GND") == 'A' && length(ds_dtl_div.GetColumn(i, "AYS")) > 0 )         {
					ds_dtl_div.SetColumn(i, "SQL_GBN", "1");
				} else if( ds_dtl_div.GetColumn(i, "GND") == 'A' && length(ds_dtl_div.GetColumn(i, "AYS")) == 0 ) {
					ds_dtl.SetColumn(i, "SQL_GBN", "2");
				} else if( ds_dtl_div.GetColumn(i, "GND") == 'B' && length(ds_dtl_div.GetColumn(i, "BYS"))  > 0 ) {
					ds_dtl.SetColumn(i, "SQL_GBN", "3");
				} else if( ds_dtl_div.GetColumn(i, "GND") == 'B' && length(ds_dtl_div.GetColumn(i, "BYS")) == 0 ) {
					ds_dtl_div.SetColumn(i, "SQL_GBN", "4");
				}
		
				z++;
			}
	
			if( z == 0 ) {
				gfn_showMsg("CW00005");
				return;		
			}
			
			tit_clearActionInfo();
			tit_callService(
				  "CS1101001B_ACT"
				, "saveDraftAndDecide"
				, "ds_list=ds_dtl_div ds_decide=ds_decide"
				, "ds_error=ds_error"
				, ""
				, "fn_afterDecide");
		}
	}
		
	
}

function fn_afterDraft(errCode, errMsg) {
	if ( ds_error.rowcount() > 0 ) {
		gfn_showAlert("CE00001");
	} else {
		gfn_showAlert("CI00003");
		div_btn.btn_draft.Enable = false;
		parent.fn_query();
	}
}


/********************************************************************************
* 기      능   : 프로세스 처리
********************************************************************************/
function process() {
	
	gfn_clearMsgBar();
	
	tit_clearActionInfo();
	tit_callService(
		  "CS1101001B_ACT"
		, "save"
		, "ds_list=ds_dtl_div"
		, "ds_error=ds_error ds_dtl_div=ds_list"
		, ""
		, "fn_afterSave");
}
/* Default Validation */
function ufn_validation_default () {
	
	if ( !gfn_isChangeDs(ds_dtl_div, true) ) {
		return false;
	}

	// 발주구분
	if( gfn_isNull(cb_gnd, true) ) {
		var arr = [cb_gnd.value];
		gfn_showAlert("발주구분", arr);
		return false;
	}
	// 발주개시일
	if( gfn_isNull(cal_bgt, true) ) {
		var arr = ["발주개시일"];
		gfn_showAlert("CW00001", arr);
		return false;
	}
	
	var gnd = cb_gnd.Value;	// 발주구분(A:무상공사, B:무상일반)
	/* 이전년도 무상발주 불가(EIS 장표 대수 오류) */
	var bYear = substr(cal_bgt.value, 0, 4);
	var cYear = substr(gfn_getCurrDate(), 0, 4);

	// if( bYear < cYear ) {
		// gfn_showAlert("이전년도로 발주입력이 불가능합니다.\n고객지원부에 문의바랍니다.(02-3670-0816)");
		// return false;
	// }
	
	// 무상일반일때 
	if( gnd == 'B' ) {
		// 입주일자가 입력되어야함.(대상:ZCST111)
		if( gfn_isNull(cal_ijd, true) ) {
			var arr = ["입주일자"];
			gfn_showAlert("CW00001", arr);
			return false;
		}
		// 입주일자는 발주개시일자보다 작으면 안된다.
		if( cal_ijd.value < cal_bgt.value ) {
			var arr = ["발주개시일", "입주일자"];
			gfn_showAlert("CW00036", arr);
			return false;
		}
		// 무상공사 발주 내역 체크 		
		for( var i = 0; i < ds_dtl_div.RowCount(); i++ ) {		
			if( ds_dtl_div.GetColumn(i, "CHK") == true ) {
				if(cal_bgt <= ds_dtl_div.GetColumn(i, "BMT_A")){
					gfn_showAlert("무상공사 만료일 이전으로 입력할 수 없습니다.");
					return false;
				}
			}
		}
	}

	// 주택관리업체
	if( gfn_isNull(ed_juc, true) ) {
		var arr = ["주택관리업체"];
		gfn_showAlert("CW00001", arr);
		return false;
	}
	
	//전자결재문서번호채번 체크
	/*
	if( ed_docno.Text == '' ) {
		var arr = ["전자결재문서번호"];
		gfn_showAlert("CW00001", arr);
		return false;
	} */
	
	return true;
}
/* Validation And Value Save Setting */
function ufn_setListValues() {
	var gnd		= cb_gnd.Value;	// 발주구분(A:무상공사, B:무상일반)
	var tDate 	= replace(cal_bgt.value,".","");
	ds_dtl_div.fireevent = false;
	for( var i = 0; i < ds_dtl_div.RowCount(); i++ ) {
	
		if( ds_dtl_div.GetColumn(i, "CHK") == true ) { //체크박스가 true 일 경우
				
			// 무상발주개월수가 1보다 작은 경우
			if( parseInt(trim(ds_dtl_div.GetColumn(i, "MON"))) < 1 ) { 
				var arr = [parseInt(i) + 1];
				gfn_showAlert("CW00181", arr);
				ds_dtl_div.row = i;
				return false;
			}
			
			// 보수인수승인일자
			// 발주개시일은 보수인수일보다 작을 수 없다.
			if( ds_dtl_div.GetColumn(i, "FDT") > tDate ) {
				var arr = [parseInt(i) + 1, "발주개시일", "보수인수일자"];
				gfn_showMsg("CW00037", arr);
				ds_dtl_div.row = i;
				return false;
			}
			
			var nday = substr(tDate,6,2);
			var month = parseInt(ds_dtl_div.GetColumn(i, "MON"));
			var nDate, cDate;
			
			// 프로젝트호기번호
			var pjthno;
			pjthno = ds_dtl_div.GetColumn(i, "PJT") + ds_dtl_div.GetColumn(i, "HNO");
			ds_dtl_div.SetColumn(i, "PJTHNO", pjthno);
			
			// 발주만료일자, 발주해지일자
			if( nday <> "01" ) {
				nDate = gfn_getAfterMonth(substr(tDate,0,6), parseInt(ds_dtl_div.GetColumn(i, "MON")) );
				if(month == 12) {
					nDate = substr(gfn_getAfterDate(cal_bgt.Value,365),0,6);
				}
				
				cDate = nDate + "" + nDay;
				cDate = gfn_getBeforeDate(cDate, 1);
			} else {
				nDate = gfn_getAfterMonth(substr(tDate,0,6), parseInt(ds_dtl_div.GetColumn(i, "MON")) - 1);
				cDate = nDate + "" + gfn_getLastDayByStr(substr(nDate,0,6));
			}
			
			// 실패여부 체크
			gfn_initDs(ds_cond_chk,  true);
			ds_cond_chk.SetColumn (0, "PJT", ds_dtl_div.GetColumn(i, "PJT"));
			ds_cond_chk.SetColumn (0, "HNO", ds_dtl_div.GetColumn(i, "HNO"));
			if( ufn_cancelFChk() == false ) {
				ds_dtl_div.row = i;
				return false;
			}
			
			//유상계약과 중복여부 체크
			gfn_initDs(ds_cond_chk2, true);
			ds_cond_chk2.SetColumn(0, "PJT", ds_dtl_div.GetColumn(i, "PJT"));
			ds_cond_chk2.SetColumn(0, "HNO", ds_dtl_div.GetColumn(i, "HNO"));
			ds_cond_chk2.SetColumn(0, "BGT", cal_bgt.value);
			ds_cond_chk2.SetColumn(0, "BMT", cDate);
			if( ufn_UChk() == false ) {
				ds_dtl_div.row = i;
				return false;
			}
			
			// SAP와 WEB의 무상발주개월수 체크
			var posid_1 = ds_dtl_div.GetColumn(i, "PJT") + ds_dtl_div.GetColumn(i, "HNO");
			ds_cond_chk3.SetColumn(0, "POSID_1", posid_1);
			ds_cond_chk3.SetColumn(0, "GND", gnd);
			ds_cond_chk3.SetColumn(0, "MON", ds_dtl_div.GetColumn(i,"MON"));
			if( ufn_saveChk() == false ) { // 발주개월수 체크(화면에 나타난 발주잔여개월수와 실제 ZMASTER02에 입력된 발주개월수 비교)
				ds_dtl_div.row = i;
				return false;
			}
			
			// Display 용
			//alert(ds_head_div.GetColumn(0, "GBN"));
			if( gnd == 'A' ) {
				//if( length( ds_dtl_div.GetColumn(i, "BGT_A") ) > 0 && cal_bgt.value >= ds_dtl_div.GetColumn(i, "BGT_A") ) {
				//if( ds_head_div.GetColumn(0, "GBN") == 'Y' && cal_bgt.value >= ds_dtl_div.GetColumn(i, "BGT_A")  && cal_bgt.value <= ds_dtl_div.GetColumn(i, "BMT_A") ) {
				if( ds_head_div.GetColumn(0, "GBN") == 'Y' && cal_bgt.value <= ds_dtl_div.GetColumn(i, "BMT_A") ) {
					// 2020.09.28 만료일 이전으로 추가발주 되지 않도록 수정. 최선경씨 확인 Han J.H
					gfn_showAlert("추가발주시 기존발주기간과 중복등록할 수 없습니다.");
					return false;
				}
			
				ds_dtl_div.SetColumn(i, "BGT_A", cal_bgt.value);	// 무상공사 발주개시일자	
				ds_dtl_div.SetColumn(i, "BMT_A", cDate);			// 무상공사 발주만료일자
			}
			else {
				// 무상일반 발주개시일 무상공사와 중복여부체크
				// 무상일반과 무상공사의 기간이 중복되면 안됨
				gfn_initDs(ds_cond_chk2, true);
				ds_cond_chk2.SetColumn(0, "PJT", ds_dtl_div.GetColumn(i, "PJT"));
				ds_cond_chk2.SetColumn(0, "HNO", ds_dtl_div.GetColumn(i, "HNO"));
				ds_cond_chk2.SetColumn(0, "BGT", cal_bgt.value);
				ds_cond_chk2.SetColumn(0, "BMT", cDate);
				if( ufn_UBgtChkB() == false) {
					ds_dtl_div.row = i;
					return false;
				} 
				//if( length( ds_dtl_div.GetColumn(i, "BGT_B") ) > 0 && cal_bgt.value >= ds_dtl_div.GetColumn(i, "BGT_B") ) {
				//if( ds_head_div.GetColumn(0, "GBN") == 'Y' && cal_bgt.value >= ds_dtl_div.GetColumn(i, "BGT_B")  && cal_bgt.value <= ds_dtl_div.GetColumn(i, "BMT_B") ) {
				if( ds_head_div.GetColumn(0, "GBN") == 'Y' && cal_bgt.value <= ds_dtl_div.GetColumn(i, "BMT_B") ) {
					// 2020.09.28 만료일 이전으로 추가발주 되지 않도록 수정. 최선경씨 확인 Han J.H
					gfn_showAlert("추가발주시 기존발주기간과 중복등록할 수 없습니다.");
					return false;
				}
			    ds_dtl_div.SetColumn(i, "BGT_B", cal_bgt.value);	// 무상일반 발주개시일자	
				ds_dtl_div.SetColumn(i, "BMT_B", cDate);			// 무상일반 발주만료일자	
			}
			
			ds_dtl_div.SetColumn(i, "BHD", cDate);			// 발주해지일자	
			ds_dtl_div.SetColumn(i, "BMT", cDate);			// 발주만료일자
			ds_dtl_div.SetColumn(i, "IJD", cal_ijd.value);	// 입주일자.
			
			// 최초발주개시일
			// 조회해온 데이터가 없는 경우 등록시 입력
			if( ds_dtl_div.GetColumn(i, "SEQ") == '' ) {
				ds_dtl_div.SetColumn(i, "CBS", cal_bgt.value);
			} else {
				ds_dtl_div.SetColumn(i, "CBS", "");
			}
			
			// 입주확인서존재유무(2014.11.20 사용안할거라고 함 by 최인식과장)
			if( gnd == "A" ) {
				ds_dtl_div.SetColumn(i, "HYN", "");
			} else {
				ds_dtl_div.SetColumn(i, "HYN", "Y");
			}
			
			ds_dtl_div.SetColumn(i, "GND", gnd);				// 발주구분(무상공사:A, 무상일반:B)
			ds_dtl_div.SetColumn(i, "JUC", ed_juc.Text); 		// 주택관리업체
			ds_dtl_div.SetColumn(i, "BGT", cal_bgt.value);		// 발주개시일자
			ds_dtl_div.SetColumn(i, "DNO", ed_docno.Text);		// 전자결재문서번호
			ds_dtl_div.SetColumn(i, "MUT", "0");				// 기성비의 발주개시일에서 발주만료일까지의 합계		
			ds_dtl_div.SetColumn(i, "FLAG", "I");
			
		} else {
			ds_dtl_div.SetColumn(i, "FLAG", "");
		}
	}
	ds_dtl_div.fireevent = true;
	
	return true;
}
/* SAP와 WEB의 무상발주개월수 체크 */
function ufn_saveChk() {
	tit_clearActionInfo();
	tit_addSearchActionInfo("cs11:CS1102001A_S4");
	tit_callService(
		  ""
		, ""
		, "ds_cond_chk3=ds_cond_chk3"
		, "ds_cnt3=ds_cnt3"
		, ""
		, ""
		, true
		, true
		, true
		);
		
	if( ds_cnt3.GetColumn(0, "CNT") > 0 ) {
		gfn_showAlert("SAP와 WEB의 무상발주개월수가 다릅니다.");
		return false;
	}

	return true;
}
/* 실패여부 체크 */
function ufn_cancelFChk() {
	tit_clearActionInfo();
	tit_addSearchActionInfo("cs06:CS0602001A_S12");
	tit_callService(
		  ""
		, ""
		, "ds_cond_chk=ds_cond_chk"
		, "ds_cnt=ds_cnt"
		, ""
		, ""
		, true
		, true
		, true
		);

	if( ds_cnt.GetColumn(0,"CNT") > 0 ) {
		gfn_showAlert("CW00223");
		return false;
	}

	return true;
}
/* 유상계약과 중복여부 체크 */
function ufn_UChk() {
	tit_clearActionInfo();
	tit_addSearchActionInfo("cs06:CS0607001A_S11");
	tit_callService(
		  ""
		, ""
		, "ds_cond_chk2=ds_cond_chk2"
		, "ds_cnt2=ds_cnt2"
		, ""
		, ""
		, true
		, true
		, true
		);

	
	if( ds_cnt2.GetColumn(0,"CNT") > 0 ) {
		gfn_showAlert("CW00197");
		return false;
	}

	return true;
}
/* 무상일반 발주개시일 체크 */
function ufn_UBgtChkB() {
	tit_clearActionInfo();
	tit_addSearchActionInfo("cs11:CS1101001B_S10");
	tit_callService(
		  ""
		, ""
		, "ds_cond_chk2=ds_cond_chk2"
		, "ds_cnt4=ds_cnt"
		, ""
		, ""
		, true
		, true
		, true
		);

	if( ds_cnt4.GetColumn(0,"CNT") > 0 ) {
		gfn_showAlert("무상일반과 무상공사의 발주기간이 중복될 수 없습니다.");
		return false;
	}

	return true;
}
//=========================================================================================
// [ PART 4]
// Callback 함수 정의 : callback 함수명은 메인 함수의 fn_xxxx() 에서 xxxx 부분은 fn_afterXXXX()
// 형태가 되도록 작성 
//=========================================================================================
/********************************************************************************
* 기      능   : 조회 Callback  
********************************************************************************/
function fn_afterQuery(errCode, errMsg) {
	// 메시지 처리 
	//gfn_showSearchMsg(grd_dtl);
	if ( errCode!= 0 ) {
		gfn_showMsg("CE00001");
	} else {
		if( isExistVar("fa_docno",true) == 1 && length(fa_docno) > 0 && ds_dtl_div.rowcount > 0 ) {
			// 해더 display 셋팅
			ed_tem_nm.Text   = ds_dtl_div.GetColumn(0, "TEM_NM");
			ed_bsu_nm.Text   = ds_dtl_div.GetColumn(0, "BSU_NM");
			ed_zsite_nm.Text = ds_dtl_div.GetColumn(0, "ZSITE_NM");
			ed_kunnr_nm.Text = ds_dtl_div.GetColumn(0, "KUNNR_NM");
			ed_telf1.Text    = ds_dtl_div.GetColumn(0, "TELF1");
			cal_bgt.Text     = ds_dtl_div.GetColumn(0, "BGT");
			cal_ijd.Text     = ds_dtl_div.GetColumn(0, "IJD");
			ed_jucText.Text  = ds_dtl_div.GetColumn(0, "JUN");
			cb_gnd.Value     = ds_dtl_div.GetColumn(0, "GND");
			cb_apstat.value  = ds_dtl_div.GetColumn(0, "APSTAT");
			
			// Display Change
			grd_dtl.SetCellProp("head", 0, "Edit",    "none");
			grd_dtl.SetCellProp("body", 0, "Edit",    "none");
			grd_dtl.SetCellProp("head", 0, "Display", "");
			grd_dtl.SetCellProp("body", 0, "Display", "");
			
			// 결재선 등록
			var user_grp = gfn_getUserGroup();
			if( user_grp > "10"  || length(G_DPT1) > 0 ) // 내부직원 작성가능
			{
				cb_apstat.Visible = true;
				
				// 기안자 접수자는 화면에서 결재선 지정
				// 결재상태에따른 기안버튼제어
				//if( parseInt(ds_dtl_div.GetColumn(0,"APSTAT")) < 1 || (ds_dtl_div.GetColumn(0,"APSTAT") == "3" && ds_dtl_div.GetColumn(0,"REDPT1") == G_DPT1) )
				if( parseInt(ds_dtl_div.GetColumn(0,"APSTAT")) < 1 || (ds_dtl_div.GetColumn(0,"APSTAT") == "3" && ds_dtl_div.GetColumn(0,"REDPT1") == vDPT) )
				{
					div_btn.btn_draft.Enable  = true;
				} else {
					div_btn.btn_draft.Enable  = false;
				}
				
			} else {
				div_btn.btn_draft.Enable    = false;	// 기안버튼
			}
			
			// 출력공통정보조회
			ufn_getApprovalData();
	
		} else {
			div_btn.btn_draft.Enable    = false;	// 기안버튼
		}
		
		// 기안진행(1), 수신진행(4) 일때 결재자일때 결재버튼 활성화.
		if( (ds_dtl_div.GetColumn(0,"APSTAT") > '0' && ds_dtl_div.GetColumn(0,"APSTAT") != '3' && ds_dtl_div.GetColumn(0,"APSTAT") < '6') && ds_decide.rowcount > 0 && G_USER_ID == substr(ds_decide.GetColumn(0, "APNUM"),1)	) {
			div_btn.btn_decide.Enable   = true;		// 결재버튼
			div_btn.btn_sendback.Enable = true;		// 반송버튼
		} else {
			div_btn.btn_decide.Enable   = false;	// 결재버튼
			div_btn.btn_sendback.Enable = false;	// 반송버튼
		}
	}
}

/********************************************************************************
* 기      능   : 출력 Callback  
********************************************************************************/
function fn_afterBeforePrint() {
	if( ds_error.rowcount() > 0 ) {
		gfn_showMsg("CE00001");
	} else {
		gfn_showMsg("CI00003");
		// 프린트 출력
		fn_afterPrint();
	}
}

function fn_afterPrint() {
	var _dataSet = ds_dtl_div;
	if ( _dataSet.rowCount() < 1 ) {
		// 삭제할 정보 없음. 
		return;
	}
	
	ds_print.row = -1;
	ds_print.ClearData();
	for( var i = 0; i < _dataSet.RowCount(); i++ ) {
		ds_print.SetColumn(i,"DNO", 			_dataSet.GetColumn(i,"DNO")			);	// 전자결재문서번호
		ds_print.SetColumn(i,"GND_NM", 			_dataSet.GetColumn(i,"GND_NM")		);	// 발주구분
		ds_print.SetColumn(i,"PJT", 			_dataSet.GetColumn(i,"PJT")			);	// 프로젝트
		ds_print.SetColumn(i,"ISD", 			_dataSet.GetColumn(i,"ISD")			);	// 보수인수일
		ds_print.SetColumn(i,"HNA", 			_dataSet.GetColumn(i,"HNA")			);	// 호기명
		ds_print.SetColumn(i,"ZSITE_NM", 		_dataSet.GetColumn(i,"ZSITE_NM")	);	// 현장명
		ds_print.SetColumn(i,"KUNNR_NM", 		_dataSet.GetColumn(i,"KUNNR_NM")	);	// 고객명
		ds_print.SetColumn(i,"BGT", 			_dataSet.GetColumn(i,"BGT")			);	// 발주개시일
		ds_print.SetColumn(i,"BMT", 			_dataSet.GetColumn(i,"BMT")			);	// 발주만료일
		ds_print.SetColumn(i,"FDT", 			_dataSet.GetColumn(i,"ISD")			);	// 보수인수일
		ds_print.SetColumn(i,"BSU_NM", 			_dataSet.GetColumn(i,"BSU_NM")		);	// 보수업체
		ds_print.SetColumn(i,"TELF1", 			_dataSet.GetColumn(i,"TELF1")		);	// 고객연락처
		ds_print.SetColumn(i,"MON", 			_dataSet.GetColumn(i,"MON")			);	// 개월수(MG1)
		ds_print.SetColumn(i,"ZMUSAOCNT", 		_dataSet.GetColumn(i,"AOCNT")		);	// 무상공사예산개월
		ds_print.SetColumn(i,"ZMUSAUCNT", 		_dataSet.GetColumn(i,"BOCNT")		);	// 무상일반예산개월
		ds_print.SetColumn(i,"MUT", 			_dataSet.GetColumn(i,"MUT")			);	// 단가
		ds_print.SetColumn(i,"AMT", 			_dataSet.GetColumn(i,"AMT")			);	// 월정금액
	}	

	// UbiReport Call
	Dialog("CS11::CS1101001C.xml", "");
}

//=========================================================================================
// [ PART 5 ]
// Detail Process Event 정의 ( User Define function )
// 사용자 정의 함수는 ufn_xxxx() 형태로 작성 
//=========================================================================================
/********************************************************************************
* 기      능   : 사용자 정의 함수  
********************************************************************************/
function ufn_userfunction() {

}

//=========================================================================================
// [ PART 6 ]
// component Event 정의 : 각 Component 별 이벤트 
//=========================================================================================
/********************************************************************************
* 기      능   : 그리드 헤더 클릭시 정렬 처리 
********************************************************************************/
function grd_dtl_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
{
	if ( nCell == 0 ) {
		// 전체 선택
		if( isExistVar("fa_docno",true) == 1 && length(fa_docno) > 0 ) {
			//gfn_selectAllGrid2(obj, 0, 0, false);
		} else {
			gfn_selectAllGrid2(obj, 0, 0, true);
		}
	} else {
		// 그리드 정렬 처리 
		gfn_sortGrid(obj,nCell);
	}
}

/********************************************************************************
* 기      능   : 주택관리업체 팝업
********************************************************************************/
function btn_juc_OnClick(obj)
{
	var arg;
	gfn_openPopup("CS1102001C", true, arg);
}


/********************************************************************************
* 기      능   : 데이터셋 값 변경 시 - Flag 처리 
********************************************************************************/
function ds_dtl_div_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex) {
	gfn_clearMsgBar();
	if( strColumnID == "CHK" ) {
		obj.fireevent = false;
		if( ds_dtl_div.GetColumn(nRow, "CHK") == true ) {
			ds_dtl_div.SetColumn(nRow, "FLAG", "I");
		} else {
			ds_dtl_div.SetColumn(nRow, "FLAG", "");
		}
		obj.fireevent = true;
	}
}

/********************************************************************************
 * 기      능   : 권한에 따른 버튼제어
 ********************************************************************************/
 function ufn_btnControl() {
	var user_grp = gfn_getUserGroup();
	
	// 보수PM일 경우와 지방사무소일 경우 만 기안처리할 수 있다.
	if (user_grp == "20" ) {
		div_btn.btn_draft.Enable = true;	// 기안버튼
		div_btn.btn_print.Enable = false;	// 출력버튼
		//div_btn.btn_save.Enable  = true;	// 저장버튼
		//div_btn.btn_decide.Enable  = true;	// 결재버튼
		//div_btn.btn_sendback.Enable = true;	// 반송버튼
	} 
	else if (user_grp == "30") {
		div_btn.btn_draft.Enable = true;	// 기안버튼
		div_btn.btn_print.Enable = false;	// 출력버튼
		//div_btn.btn_save.Enable  = true;	// 저장버튼
		//div_btn.btn_decide.Enable  = true;	// 결재버튼
		//div_btn.btn_sendback.Enable = true;	// 반송버튼
	}
	else if (user_grp == "40") {
		div_btn.btn_draft.Enable = false;	// 기안버튼
		div_btn.btn_print.Enable = false;	// 출력버튼
		//div_btn.btn_save.Enable  = true;	// 저장버튼
		div_btn.btn_decide.Enable  = false;	// 결재버튼
		div_btn.btn_sendback.Enable = false;// 반송버튼
	}
	else {
		// 보수협력사(직영 모두)만 저장한다.
		div_btn.btn_draft.Enable = false;	// 기안버튼
		div_btn.btn_print.Enable = false;	// 출력버튼
		div_btn.btn_decide.Enable  = false;	// 결재버튼
		//div_btn.btn_save.Enable  = true;	// 저장버튼
		div_btn.btn_sendback.Enable = false;// 반송버튼
	}
}

/* 출력공통정보조회 */
function ufn_getApprovalData () {
	
	ds_conf_cond.SetColumn(0, "DOCNO", ed_docno.Text);	
	
	tit_clearActionInfo();
	tit_addSearchActionInfo("wb01:DOC_CONF_S1");
	tit_addSearchActionInfo("wb01:DOC_CONF_S2");
	tit_callService(
		  ""
		, ""
		, "ds_conf_cond=ds_conf_cond"
		, "ds_conf_list=ds_conf_list ds_draftpers_list=ds_draftpers_list"
		, ""
		, ""
		, true);
}

/* 기안미결재 저장상태인 경우 목록조회 */
function ufn_searchQueryForUpdate() {
	if( parent.ds_dtl.RowCount() <= 0 ) {
		return;
	}
	
	// 헤더셋팅
	var cRow         = parent.ds_mst.GetCurrow();
	ed_tem_nm.Text   = parent.ds_mst.GetColumn(cRow, "TEM_NM");
	ed_bsu_nm.Text   = parent.ds_mst.GetColumn(cRow, "BSU_NM");
	ed_zsite_nm.Text = parent.ds_mst.GetColumn(cRow, "ZSITE_NM");
	ed_kunnr_nm.Text = parent.ds_mst.GetColumn(cRow, "KUNNR_NM");
	ed_telf1.Text    = parent.ds_mst.GetColumn(cRow, "TELF1");
	cal_bgt.Text     = parent.ds_mst.GetColumn(cRow, "BGT");
	cal_ijd.Text     = parent.ds_mst.GetColumn(cRow, "IJD");
	ed_juc.Text      = parent.ds_mst.GetColumn(cRow, "JUC");
	ed_jucText.Text  = parent.ds_mst.GetColumn(cRow, "JUC_NM");
	cb_gnd.Value     = parent.ds_mst.GetColumn(cRow, "GND");
	cb_apstat.value  = parent.ds_mst.GetColumn(cRow, "APSTAT");
	
	// 상세목록 셋팅
	ds_dtl_div.row = -1;
	ds_dtl_div.ClearData();
	ds_dtl_div.fireevent = false;
	for( var i = 0; i < parent.ds_dtl.RowCount(); i++ ) {
		//ds_dtl_div.add
		ds_dtl_div.AddRow();
		
		ds_dtl_div.SetColumn(i, "CHK"      		  ,1   );
		ds_dtl_div.SetColumn(i, "FLAG"      	  ,"I" );
		ds_dtl_div.SetColumn(i, "PJT"      		  ,parent.ds_dtl.GetColumn(i, "PJT"            ) );	
		ds_dtl_div.SetColumn(i, "ARA"             ,parent.ds_dtl.GetColumn(i, "ARA"            ) );
		ds_dtl_div.SetColumn(i, "ARA_NM"          ,parent.ds_dtl.GetColumn(i, "ARA_NM"         ) );
		ds_dtl_div.SetColumn(i, "TEM"             ,parent.ds_dtl.GetColumn(i, "TEM"            ) );
		ds_dtl_div.SetColumn(i, "BSU"             ,parent.ds_dtl.GetColumn(i, "BSU"            ) );
		ds_dtl_div.SetColumn(i, "BSU_NM"          ,parent.ds_dtl.GetColumn(i, "BSU_NM"         ) );
		ds_dtl_div.SetColumn(i, "ZSITE_NM"        ,parent.ds_dtl.GetColumn(i, "ZSITE_NM"       ) );
		ds_dtl_div.SetColumn(i, "KUNNR"           ,parent.ds_dtl.GetColumn(i, "KUNNR"          ) );
		ds_dtl_div.SetColumn(i, "DNO"             ,parent.ds_dtl.GetColumn(i, "DNO"            ) );
		ds_dtl_div.SetColumn(i, "ISD"             ,parent.ds_dtl.GetColumn(i, "ISD"            ) );
		ds_dtl_div.SetColumn(i, "KUNNR_NM"        ,parent.ds_dtl.GetColumn(i, "KUNNR_NM"	   ) );
		ds_dtl_div.SetColumn(i, "TEM_NM"          ,parent.ds_dtl.GetColumn(i, "TEM_NM"         ) );
		ds_dtl_div.SetColumn(i, "HNO"             ,parent.ds_dtl.GetColumn(i, "HNO"            ) );
		ds_dtl_div.SetColumn(i, "SEQ"             ,parent.ds_dtl.GetColumn(i, "SEQ"            ) );
		ds_dtl_div.SetColumn(i, "HNA"             ,parent.ds_dtl.GetColumn(i, "HNA"            ) );
		ds_dtl_div.SetColumn(i, "WDT"             ,parent.ds_dtl.GetColumn(i, "WDT"            ) );
		ds_dtl_div.SetColumn(i, "FDT"             ,parent.ds_dtl.GetColumn(i, "FDT"            ) );
		ds_dtl_div.SetColumn(i, "TYP"             ,parent.ds_dtl.GetColumn(i, "ZSPEC1"         ) );
		ds_dtl_div.SetColumn(i, "ZSPEC2"          ,parent.ds_dtl.GetColumn(i, "ZSPEC2"         ) );
		ds_dtl_div.SetColumn(i, "ZSPEC"           ,parent.ds_dtl.GetColumn(i, "ZSPEC"          ) );
		ds_dtl_div.SetColumn(i, "PST"             ,parent.ds_dtl.GetColumn(i, "PST"            ) );
		ds_dtl_div.SetColumn(i, "PST_NM"          ,parent.ds_dtl.GetColumn(i, "PST_NM"         ) );
		ds_dtl_div.SetColumn(i, "GND"             ,parent.ds_dtl.GetColumn(i, "GND"            ) );
		ds_dtl_div.SetColumn(i, "GND_NM"          ,parent.ds_dtl.GetColumn(i, "GND_NM"         ) );
		ds_dtl_div.SetColumn(i, "BGT"             ,parent.ds_dtl.GetColumn(i, "BGT"            ) );
		ds_dtl_div.SetColumn(i, "BMT"             ,parent.ds_dtl.GetColumn(i, "BMT"            ) );
		ds_dtl_div.SetColumn(i, "BHD"             ,parent.ds_dtl.GetColumn(i, "BHD"            ) );
		ds_dtl_div.SetColumn(i, "MG1"             ,parent.ds_dtl.GetColumn(i, "MG1"            ) );
		ds_dtl_div.SetColumn(i, "MON"             ,parent.ds_dtl.GetColumn(i, "MG1"            ) );
		ds_dtl_div.SetColumn(i, "BJT"             ,parent.ds_dtl.GetColumn(i, "BJT"            ) );
		ds_dtl_div.SetColumn(i, "BST"             ,parent.ds_dtl.GetColumn(i, "BST"            ) );
		ds_dtl_div.SetColumn(i, "AYS"             ,parent.ds_dtl.GetColumn(i, "AYS"            ) );
		ds_dtl_div.SetColumn(i, "BYS"             ,parent.ds_dtl.GetColumn(i, "BYS"            ) );
		ds_dtl_div.SetColumn(i, "IJD"             ,parent.ds_dtl.GetColumn(i, "IJD"            ) );
		ds_dtl_div.SetColumn(i, "HYN"             ,parent.ds_dtl.GetColumn(i, "HYN"            ) );
		ds_dtl_div.SetColumn(i, "MANDT"           ,parent.ds_dtl.GetColumn(i, "MANDT"          ) );
		ds_dtl_div.SetColumn(i, "SQL_GBN"         ,parent.ds_dtl.GetColumn(i, "SQL_GBN"        ) );
		ds_dtl_div.SetColumn(i, "PSPID"           ,parent.ds_dtl.GetColumn(i, "PSPID"          ) );
		ds_dtl_div.SetColumn(i, "POSID"           ,parent.ds_dtl.GetColumn(i, "POSID"          ) );
		ds_dtl_div.SetColumn(i, "ZLIFNR"          ,parent.ds_dtl.GetColumn(i, "ZLIFNR"         ) );
		ds_dtl_div.SetColumn(i, "AGB_NM"          ,parent.ds_dtl.GetColumn(i, "AGB_NM"         ) );
		ds_dtl_div.SetColumn(i, "ABG_NM"          ,parent.ds_dtl.GetColumn(i, "ABG_NM"         ) );
		ds_dtl_div.SetColumn(i, "GUBUN"           ,parent.ds_dtl.GetColumn(i, "GUBUN"          ) );
		ds_dtl_div.SetColumn(i, "JBF"             ,parent.ds_dtl.GetColumn(i, "JBF"            ) );
		ds_dtl_div.SetColumn(i, "APSTAT"          ,parent.ds_dtl.GetColumn(i, "APSTAT"         ) );
		ds_dtl_div.SetColumn(i, "APSTATNM"        ,parent.ds_dtl.GetColumn(i, "APSTATNM"       ) );
		ds_dtl_div.SetColumn(i, "CRDPT1"          ,parent.ds_dtl.GetColumn(i, "CRDPT1"         ) );
		ds_dtl_div.SetColumn(i, "REDPT1"          ,parent.ds_dtl.GetColumn(i, "REDPT1"         ) );
		ds_dtl_div.SetColumn(i, "MB_STN"          ,parent.ds_dtl.GetColumn(i, "MB_STN"         ) );
		ds_dtl_div.SetColumn(i, "MB_STN_NAME"     ,parent.ds_dtl.GetColumn(i, "MB_STN_NAME"    ) );
		ds_dtl_div.SetColumn(i, "ABG"             ,parent.ds_dtl.GetColumn(i, "ABG"            ) );
		ds_dtl_div.SetColumn(i, "B_VNDNM"         ,parent.ds_dtl.GetColumn(i, "B_VNDNM"        ) );
		ds_dtl_div.SetColumn(i, "RMK"             ,parent.ds_dtl.GetColumn(i, "RMK"            ) );
		ds_dtl_div.SetColumn(i, "AMT"             ,parent.ds_dtl.GetColumn(i, "AMT"            ) );
		ds_dtl_div.SetColumn(i, "MUT"             ,parent.ds_dtl.GetColumn(i, "MUT"            ) );
		ds_dtl_div.SetColumn(i, "ZMUSAOCNT"       ,parent.ds_dtl.GetColumn(i, "ZMUSAOCNT"      ) );
		ds_dtl_div.SetColumn(i, "ZMUSAUCNT"       ,parent.ds_dtl.GetColumn(i, "ZMUSAUCNT"      ) );
		ds_dtl_div.SetColumn(i, "ZMUSAOCNT2"      ,parent.ds_dtl.GetColumn(i, "ZMUSAOCNT2"     ) );
		ds_dtl_div.SetColumn(i, "ZMUSAUCNT2"      ,parent.ds_dtl.GetColumn(i, "ZMUSAUCNT2"     ) );
		ds_dtl_div.SetColumn(i, "BGT_A"           ,parent.ds_dtl.GetColumn(i, "BGT_A"          ) );
		ds_dtl_div.SetColumn(i, "BGT_B"           ,parent.ds_dtl.GetColumn(i, "BGT_B"          ) );
		ds_dtl_div.SetColumn(i, "BMT_A"           ,parent.ds_dtl.GetColumn(i, "BMT_A"          ) );
		ds_dtl_div.SetColumn(i, "BMT_B"           ,parent.ds_dtl.GetColumn(i, "BMT_B"          ) );
		ds_dtl_div.SetColumn(i, "NUM"             ,parent.ds_dtl.GetColumn(i, "NUM"            ) );
		ds_dtl_div.SetColumn(i, "JHD"             ,parent.ds_dtl.GetColumn(i, "JHD"            ) );
		ds_dtl_div.SetColumn(i, "JID"             ,parent.ds_dtl.GetColumn(i, "JID"            ) );
		ds_dtl_div.SetColumn(i, "JGBN"            ,parent.ds_dtl.GetColumn(i, "JGBN"           ) );
		ds_dtl_div.SetColumn(i, "REQE"            ,parent.ds_dtl.GetColumn(i, "REQE"           ) );
		ds_dtl_div.SetColumn(i, "REQC"            ,parent.ds_dtl.GetColumn(i, "REQC"           ) );
		ds_dtl_div.SetColumn(i, "REQ"             ,parent.ds_dtl.GetColumn(i, "REQ"            ) );
		ds_dtl_div.SetColumn(i, "RPD"             ,parent.ds_dtl.GetColumn(i, "RPD"            ) );
		ds_dtl_div.SetColumn(i, "JYM"             ,parent.ds_dtl.GetColumn(i, "JYM"            ) );
		ds_dtl_div.SetColumn(i, "ENDDATE"         ,parent.ds_dtl.GetColumn(i, "ENDDATE"        ) );
		ds_dtl_div.SetColumn(i, "JHD_YN"          ,parent.ds_dtl.GetColumn(i, "JHD_YN"         ) );
	}
	ds_dtl_div.fireevent = true;
}
/* 부모창 데이터셋 존재여부 체크 */
function isExistsDataSetForParent(_dataSetName) {
	var objDs;
	for( var i = 0; i < parent.Components.count; i++ ){
		if( parent.components[i].getType() == "Dataset" ){
			objDs = parent.components[i];
			if( objDs.ID == _dataSetName ) {
				return true;
			}
		}
	}
	return false;
}


/********************************************************************************
* 기      능   : 무상확인서 미리보기 
********************************************************************************/
function btn_viewFile_OnClick(obj)
{
	if( length(ds_zcst649.GetColumn(0, "CS649_FNA")) > 0 ) { //첨부 이미지 VIEWER
	
		var arg = "fname_app=" + quote(ds_zcst649.GetColumn(0, "CS649_FNA"))
		        + " fname="    + quote(ds_zcst649.GetColumn(0, "CS649_FNA"))
		        ;
		gfn_openPopup("CS0404001A", true, arg);

	}
}

/********************************************************************************
* 기      능   : 전자결재 문서번호채번
********************************************************************************/
function ufn_getDocNo() {
	ds_docno_gen.row = -1;
	ds_docno_gen.ClearData();							
	ds_docno_gen.AddRow();							
	ds_docno_gen.SetColumn( 0, "PFX", "H07" ); // H01, H02 … R01, R02 …		
								
	tit_clearActionInfo();							
	tit_addSearchActionInfo("wb01:DOC_CODE_GEN_S1", true);							
	tit_addSearchActionInfo("wb01:DOC_CODE_GEN_U1");							
	tit_callService(					
		""
		, ""						
		, "ds_docno_gen_i=ds_docno_gen"						
		, "ds_docno_gen=ds_docno_gen_o"						
		, ""						
		, "ufn_setDocInfo"						
		, true
		, false
		, true);
}

/********************************************************************************
* 기      능   : 전자결재문서번호채번 Callback
********************************************************************************/
function ufn_setDocInfo(errCode, errMsg) {
	if ( errCode > 0 ) {
		gfn_showMsg("CE00001");
	} else {
		ed_docno.Text = ds_docno_gen.GetColumn(0, "DOCNO");

		if( length(ed_docno.Text) <= 0 ) {
			var arr = ["전자결재문서번호"];
			gfn_showMsg("CW00001", arr);
			return;
		}

	}
}]]></Script>
</Window>