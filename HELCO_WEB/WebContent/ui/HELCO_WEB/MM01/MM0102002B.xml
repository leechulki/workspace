<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="553" Id="MM0102001B" Left="8" OnKeyDown="gfn_EnterInForm" OnLoadCompleted="fn_OnLoadCompleted" PidAttrib="7" Title="품목표&#32;상세정보" Top="8" Ver="1.0" Width="918" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_cond">
				<Contents>
					<colinfo id="HOGIN" size="9" type="STRING"/>
					<colinfo id="MATNR" size="14" type="STRING"/>
					<colinfo id="IDNRK" size="14" type="STRING"/>
					<colinfo id="ITEM_SEQ" size="3" type="STRING"/>
					<colinfo id="MATKL" size="14" type="STRING"/>
					<colinfo id="SQLSTR" size="256" type="STRING"/>
					<record>
						<HOGIN></HOGIN>
						<IDNRK></IDNRK>
						<ITEM_SEQ></ITEM_SEQ>
						<MATKL></MATKL>
						<MATNR></MATNR>
						<SQLSTR></SQLSTR>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list2">
				<Contents>
					<colinfo id="TYPE" size="10" type="STRING"/>
					<colinfo id="TEXT" size="120" type="STRING"/>
					<colinfo id="CRDAT" size="8" type="STRING"/>
					<colinfo id="IDNRK" size="14" type="STRING"/>
					<colinfo id="SEQ" size="3" type="STRING"/>
					<colinfo id="ITEM_SEQ" size="3" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list">
				<Contents>
					<colinfo id="BOM_LEVEL" size="6" type="STRING"/>
					<colinfo id="CRDAT" size="24" type="STRING"/>
					<colinfo id="CRTIM" size="18" type="STRING"/>
					<colinfo id="CRUSER" size="60" type="STRING"/>
					<colinfo id="DZEINR" size="120" type="STRING"/>
					<colinfo id="EXTWG" size="54" type="STRING"/>
					<colinfo id="HOGIN" size="72" type="STRING"/>
					<colinfo id="IDNRK" size="54" type="STRING"/>
					<colinfo id="MAKTX" size="120" type="STRING"/>
					<colinfo id="MATKL" size="27" type="STRING"/>
					<colinfo id="MATNR" size="54" type="STRING"/>
					<colinfo id="MATNR_NM" size="120" type="STRING"/>
					<colinfo id="MEINS" size="9" type="STRING"/>
					<colinfo id="MENGE" size="15" type="DECIMAL"/>
					<colinfo id="PART" size="11" type="DECIMAL"/>
					<colinfo id="PART_NM" size="16" type="STRING"/>
					<colinfo id="SITE_NM" size="105" type="STRING"/>
					<colinfo id="SIZE" size="180" type="STRING"/>
					<colinfo id="SPEC" size="180" type="STRING"/>
					<colinfo id="SPEC1" size="15" type="STRING"/>
					<colinfo id="SPEC2" size="75" type="STRING"/>
					<colinfo id="VERSION" size="6" type="STRING"/>
					<colinfo id="CURRDATE" size="8" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_detail">
				<Contents>
					<colinfo id="TYPE" size="10" type="STRING"/>
					<colinfo id="TEXT" size="120" type="STRING"/>
					<colinfo id="CRDAT" size="10" type="STRING"/>
					<colinfo id="IDNRK" size="14" type="STRING"/>
					<colinfo id="SEQ" size="3" type="STRING"/>
					<colinfo id="ITEM_SEQ" size="3" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_head">
				<Contents>
					<colinfo id="AUFNR" size="36" type="STRING"/>
					<colinfo id="CONSNAM" size="90" type="STRING"/>
					<colinfo id="CRUSER" size="60" type="STRING"/>
					<colinfo id="HOGI" size="72" type="STRING"/>
					<colinfo id="ITEM_NAM" size="90" type="STRING"/>
					<colinfo id="ITEM_NO" size="27" type="STRING"/>
					<colinfo id="MATNR" size="54" type="STRING"/>
					<colinfo id="PLAN_NO" size="120" type="STRING"/>
					<colinfo id="PPLDAT" size="24" type="STRING"/>
					<colinfo id="PSMNG" size="15" type="DECIMAL"/>
					<colinfo id="SPEC" size="90" type="STRING"/>
					<colinfo id="SSCDAT" size="24" type="STRING"/>
					<colinfo id="ZSIZE" size="180" type="STRING"/>
					<colinfo id="ZSPEC" size="180" type="STRING"/>
					<colinfo id="CURRDATE" size="8" type="STRING"/>
					<colinfo id="PART_NM" size="60" type="STRING"/>
					<colinfo id="ATYPE" size="15" type="STRING"/>
					<colinfo id="AMEIN" size="9" type="STRING"/>
					<colinfo id="ITEM_SEQ" size="3" type="STRING"/>
					<record>
						<AMEIN></AMEIN>
						<ATYPE></ATYPE>
						<AUFNR></AUFNR>
						<CONSNAM></CONSNAM>
						<CRUSER></CRUSER>
						<CURRDATE></CURRDATE>
						<HOGI></HOGI>
						<ITEM_NAM></ITEM_NAM>
						<ITEM_NO></ITEM_NO>
						<ITEM_SEQ></ITEM_SEQ>
						<MATNR></MATNR>
						<PART_NM></PART_NM>
						<PLAN_NO></PLAN_NO>
						<PPLDAT></PPLDAT>
						<PSMNG/>
						<SPEC></SPEC>
						<SSCDAT></SSCDAT>
						<ZSIZE></ZSIZE>
						<ZSPEC></ZSPEC>
					</record>
				</Contents>
			</Dataset>
		</Datasets>
		<Shape BKColor="user12" Bottom="70" Height="26" Id="Shape6" Left="8" LineColor="user13" Right="910" TabOrder="39" Top="44" Type="Rectangle" Width="902"></Shape>
		<Shape BKColor="user12" Bottom="95" Height="26" Id="Shape1" Left="8" LineColor="user13" Right="910" TabOrder="40" Top="69" Type="Rectangle" Width="902"></Shape>
		<Shape BKColor="user12" Bottom="120" Height="26" Id="Shape2" Left="8" LineColor="user13" Right="910" TabOrder="41" Top="94" Type="Rectangle" Width="902"></Shape>
		<Shape BKColor="user12" Bottom="145" Height="26" Id="Shape3" Left="8" LineColor="user13" Right="910" TabOrder="42" Top="119" Type="Rectangle" Width="902"></Shape>
		<Shape BKColor="user12" Bottom="170" Height="26" Id="Shape4" Left="8" LineColor="user13" Right="910" TabOrder="43" Top="144" Type="Rectangle" Width="902"></Shape>
		<Shape BKColor="user12" Bottom="195" Height="26" Id="Shape5" Left="8" LineColor="user13" Right="910" TabOrder="44" Top="169" Type="Rectangle" Width="902"></Shape>
		<Static Align="Right" Height="24" Id="Static1" Left="9" Style="sty_lb_form_basic" TabOrder="1" Text="호기번호　" Top="45" VAlign="Middle" Width="94"></Static>
		<Static Align="Right" Height="24" Id="Static2" Left="367" Style="sty_lb_form_basic" TabOrder="2" Text="PART　" Top="120" VAlign="Middle" Width="95"></Static>
		<Static Align="Right" Height="24" Id="Static3" Left="666" Style="sty_lb_form_basic" TabOrder="3" Text="수량　&#32;" Top="45" VAlign="Middle" Width="95"></Static>
		<Edit BindDataset="ds_list" Border="Flat" Column="PART_NM" DisableBKColor="user5" Enable="FALSE" Height="20" Id="Edit3" Left="464" LeftMargin="10" Readonly="TRUE" Style="sty_ipt_form" TabOrder="0" TabStop="FALSE" Top="122" Width="200"></Edit>
		<Edit BindDataset="ds_list" Border="Flat" Column="HOGIN" DisableBKColor="user5" Enable="FALSE" Height="20" Id="Edit0" Left="105" LeftMargin="10" Readonly="TRUE" Style="sty_ipt_form" TabOrder="1" TabStop="FALSE" Top="47" Width="260"></Edit>
		<Static Align="Right" Height="24" Id="Static4" Left="9" Style="sty_lb_form_basic" TabOrder="6" Text="공사명　" Top="70" VAlign="Middle" Width="94"></Static>
		<Static Align="Right" Height="24" Id="Static5" Left="367" Style="sty_lb_form_basic" TabOrder="7" Text="BLOCK　" Top="145" VAlign="Middle" Width="95"></Static>
		<Static Align="Right" Height="24" Id="Static6" Left="666" Style="sty_lb_form_basic" TabOrder="8" Text="단위　&#32;" Top="70" VAlign="Middle" Width="95"></Static>
		<Edit BindDataset="ds_list" Border="Flat" Column="MATKL" DisableBKColor="user5" Enable="FALSE" Height="20" Id="Edit7" Left="464" LeftMargin="10" Readonly="TRUE" Style="sty_ipt_form" TabOrder="2" TabStop="FALSE" Top="147" Width="200"></Edit>
		<Edit BindDataset="ds_list" Border="Flat" Column="SITE_NM" DisableBKColor="user5" Enable="FALSE" Height="20" Id="Edit8" Left="105" LeftMargin="10" Readonly="TRUE" Style="sty_ipt_form" TabOrder="3" TabStop="FALSE" Top="72" Width="260"></Edit>
		<Static Align="Right" Height="24" Id="Static7" Left="9" Style="sty_lb_form_basic" TabOrder="11" Text="자재번호　" Top="95" VAlign="Middle" Width="94"></Static>
		<Static Align="Right" Height="24" Id="Static8" Left="9" Style="sty_lb_form_basic" TabOrder="12" Text="SPEC　" Top="145" VAlign="Middle" Width="94"></Static>
		<Static Align="Right" Height="24" Id="Static9" Left="666" Style="sty_lb_form_basic" TabOrder="13" Text="일자　&#32;" Top="145" VAlign="Middle" Width="95"></Static>
		<Edit BindDataset="ds_list" Border="Flat" Column="SPEC" DisableBKColor="user5" Enable="FALSE" Height="20" Id="Edit12" Left="105" LeftMargin="10" Readonly="TRUE" Style="sty_ipt_form" TabOrder="4" TabStop="FALSE" Top="147" Width="260"></Edit>
		<Edit BindDataset="ds_list" Border="Flat" Column="IDNRK" DisableBKColor="user5" Enable="FALSE" Height="20" Id="Edit13" Left="105" LeftMargin="10" Readonly="TRUE" Style="sty_ipt_form" TabOrder="5" TabStop="FALSE" Top="97" Width="260"></Edit>
		<Static Align="Right" Height="24" Id="Static10" Left="9" Style="sty_lb_form_basic" TabOrder="16" Text="자재내역　" Top="120" VAlign="Middle" Width="94"></Static>
		<Static Align="Right" Height="24" Id="Static12" Left="666" Style="sty_lb_form_basic" TabOrder="17" Text="시간　&#32;" Top="170" VAlign="Middle" Width="95"></Static>
		<Edit BindDataset="ds_list" Border="Flat" Column="MATNR_NM" DisableBKColor="user5" Enable="FALSE" Height="20" Id="Edit18" Left="105" LeftMargin="10" Readonly="TRUE" Style="sty_ipt_form" TabOrder="6" TabStop="FALSE" Top="122" Width="260"></Edit>
		<Static Align="Right" Height="24" Id="Static13" Left="367" Style="sty_lb_form_basic" TabOrder="18" Text="도면번호　&#32;" Top="95" VAlign="Middle" Width="95"></Static>
		<Static Align="Right" Height="24" Id="Static14" Left="666" Style="sty_lb_form_basic" TabOrder="19" Text="담당자　&#32;" Top="120" VAlign="Middle" Width="95"></Static>
		<Edit BindDataset="ds_list" Border="Flat" Column="CRUSER" DisableBKColor="user5" Enable="FALSE" Height="20" Id="Edit22" Left="763" LeftMargin="10" Readonly="TRUE" Style="sty_ipt_form" TabOrder="7" TabStop="FALSE" Top="122" Width="144"></Edit>
		<Edit BindDataset="ds_list" Border="Flat" Column="DZEINR" DisableBKColor="user5" Enable="FALSE" Height="20" Id="Edit23" Left="464" LeftMargin="10" Readonly="TRUE" Style="sty_ipt_form" TabOrder="8" TabStop="FALSE" Top="97" Width="200"></Edit>
		<Edit BindDataset="ds_list" Border="Flat" Column="EXTWG" DisableBKColor="user5" Enable="FALSE" Height="20" Id="Edit17" Left="464" LeftMargin="10" Readonly="TRUE" Style="sty_ipt_form" TabOrder="9" TabStop="FALSE" Top="172" Width="200"></Edit>
		<Static Align="Right" Height="24" Id="Static11" Left="367" Style="sty_lb_form_basic" TabOrder="23" Text="BOX　" Top="170" VAlign="Middle" Width="95"></Static>
		<Div Height="36" Id="div_btn" TabOrder="10" TabStop="FALSE" Text="Div0" Url="WB01::CommBtnForm.xml" Width="918">
			<Contents></Contents>
		</Div>
		<MaskEdit BindDataset="ds_list" Border="Flat" Column="CRDAT" DisableBKColor="user5" Enable="FALSE" Height="20" Id="MaskEdit3" Left="763" LeftMargin="10" Mask="####-##-##" Readonly="TRUE" Style="sty_ipt_form" TabOrder="11" TabStop="FALSE" Top="147" Type="STRING" Width="144"></MaskEdit>
		<MaskEdit BindDataset="ds_list" Border="Flat" Column="CRTIM" DisableBKColor="user5" Enable="FALSE" Height="20" Id="MaskEdit1" Left="763" LeftMargin="10" Mask="##:##:##" Readonly="TRUE" Style="sty_ipt_form" TabOrder="12" TabStop="FALSE" Top="172" Type="STRING" Width="144"></MaskEdit>
		<Static Align="Right" Height="24" Id="Static0" Left="9" Style="sty_lb_form_basic" TabOrder="27" Text="SIZE　" Top="170" VAlign="Middle" Width="94"></Static>
		<Edit BindDataset="ds_list" Border="Flat" Column="SIZE" DisableBKColor="user5" Enable="FALSE" Height="20" Id="Edit1" Left="105" LeftMargin="10" Readonly="TRUE" Style="sty_ipt_form" TabOrder="13" TabStop="FALSE" Top="172" Width="260"></Edit>
		<Static Align="Right" Height="24" Id="Static16" Left="367" Style="sty_lb_form_basic" TabOrder="29" Text="기종　&#32;" Top="45" VAlign="Middle" Width="95"></Static>
		<Edit BindDataset="ds_list" Border="Flat" Column="SPEC1" DisableBKColor="user5" Enable="FALSE" Height="20" Id="Edit4" Left="464" LeftMargin="10" Readonly="TRUE" Style="sty_ipt_form" TabOrder="14" TabStop="FALSE" Top="47" Width="200"></Edit>
		<Static Align="Right" Height="24" Id="Static17" Left="367" Style="sty_lb_form_basic" TabOrder="31" Text="제품사양　&#32;" Top="70" VAlign="Middle" Width="95"></Static>
		<Edit BindDataset="ds_list" Border="Flat" Column="SPEC2" DisableBKColor="user5" Enable="FALSE" Height="20" Id="Edit5" Left="464" LeftMargin="10" Readonly="TRUE" Style="sty_ipt_form" TabOrder="15" TabStop="FALSE" Top="72" Width="200"></Edit>
		<Grid AreaSelect="TRUE" AutoFitEndLine="Hide" BindDataset="ds_list2" BkColor2="default" BoldHead="true" Border="Flat" Bottom="545" CellMoving="TRUE" ColSelect="TRUE" ColSizing="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="342" Id="grd_list2" InputPanel="FALSE" Left="8" LineColor="user20" LineType="ExHORZ" Right="910" RowHeight="20" Style="sty_grid" TabOrder="16" TabStop="FALSE" Top="203" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="902">
			<contents>
				<format id="Default">
					<columns>
						<col width="44"/>
						<col width="75"/>
						<col width="95"/>
						<col width="590"/>
						<col width="90"/>
					</columns>
					<head>
						<cell align="center" col="0" display="text" font="굴림,9" text="No"/>
						<cell col="1" display="text" font="굴림,9" text="구분"/>
						<cell col="2" display="text" font="굴림,9" text="자재번호"/>
						<cell align="center" col="3" display="text" font="굴림,9" text="세부내역"/>
						<cell col="4" display="text" font="굴림,9" text="일자"/>
					</head>
					<body>
						<cell align="center" bkcolor2="user22" col="0" display="text" expr="currow+1"/>
						<cell align="center" col="1" colid="TYPE" display="text"/>
						<cell align="center" col="2" colid="IDNRK" display="text"/>
						<cell bkcolor2="user22" col="3" colid="TEXT" display="text"/>
						<cell align="center" col="4" colid="CRDAT" display="text" Mask="####.##.##"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Static Align="Right" Height="24" Id="Static15" Left="666" Style="sty_lb_form_basic" TabOrder="34" Text="VERSION　&#32;" Top="95" VAlign="Middle" Width="95"></Static>
		<Edit BindDataset="ds_list" Border="Flat" Column="VERSION" DisableBKColor="user5" Enable="FALSE" Height="20" Id="Edit2" Left="763" LeftMargin="10" Readonly="TRUE" Style="sty_ipt_form" TabOrder="17" TabStop="FALSE" Top="97" Width="144"></Edit>
		<Edit BindDataset="ds_list" Border="Flat" Column="MEINS" DisableBKColor="user5" Enable="FALSE" Height="20" Id="Edit9" Left="763" LeftMargin="10" Readonly="TRUE" Style="sty_ipt_form" TabOrder="18" TabStop="FALSE" Top="72" Width="144"></Edit>
		<Edit BindDataset="ds_list" Border="Flat" Column="MENGE" DisableBKColor="user5" Enable="FALSE" Height="20" Id="Edit6" Left="763" LeftMargin="10" Readonly="TRUE" Style="sty_ipt_form" TabOrder="38" TabStop="FALSE" Top="47" Width="144"></Edit>
	</Form>
	<Script><![CDATA[/*
 ******************************************************************************************
 * 기      능   : 
 * 작  성  자   : 
 * 작성  일자   : 
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
#include "LIB::commons.js";	// 공통 스크립트 
//=========================================================================================
// [ PART 1 ]
// Form에서 사용될 전역변수를 선언
// FORM에서 사용되는 전역변수는 대문자로 작성하며, F_XXX 의 형태를 갖도록 한다. 
//=========================================================================================

//=========================================================================================
// [ PART 2 ]
// Form Loading / Unloading 시 작업 정의
//=========================================================================================
function fn_OnLoadCompleted(obj) 
{
	gfn_initForm();

	fn_query();
}
/********************************************************************************
* 기      능   : 공통코드가 조회된 후의 Callback 함수 
********************************************************************************/
function fn_completeInit(sCode, sDsObj, sCodeType) 
{

}
/********************************************************************************
* 기      능   : form UnloadCompleted 
********************************************************************************/
function fn_OnUnloadCompleted(obj) 
{
	return gfn_isFormUnload(obj);
}
/********************************************************************************
* 기      능   : 조회 
********************************************************************************/
function fn_query() 
{
	if(Length(Trim(HOGIN)) < 6)
	{
		return;
		fn_close();
	}
	
	// 호기번호 검증
	ds_list.ClearData();
	
	ds_cond.setColumn(0, "HOGIN", HOGIN);
	ds_cond.setColumn(0, "MATNR", MATNR);
	ds_cond.setColumn(0, "MATKL", MATKL);

	tit_clearActionInfo();

	if (HOGIN.substr(0,1) == "Q")
	{
		tit_addSearchActionInfo("mm01:MM0102002B_S3", null, true);
	}
	else
	{
		tit_addSearchActionInfo("mm01:MM0102002B_S1", null, true);
	}
	
	tit_callService(
          ""
        , ""
        , "ds_cond=ds_cond"
        , "ds_list=ds_list"
        , ""
        , "fn_afterQuery"
        , true);
}
//=========================================================================================
// [ PART 4]
// Callback 함수 정의 : callback 함수명은 메인 함수의 fn_xxxx() 에서 xxxx 부분은 fn_afterXXXX()
// 형태가 되도록 작성 
//=========================================================================================
/********************************************************************************
* 기      능   : 조회 Callback  
********************************************************************************/
function fn_afterQuery() 
{
	if (ds_list.RowCount() == 0) 
	{
		gfn_showAlert("품목표 상세 정보가 없습니다.");
		close();
	}
	else
	{
		ds_list2.ClearData();
	
		ds_cond.setColumn(0, "HOGIN", ds_list.GetColumn(0, "HOGIN"));
		ds_cond.setColumn(0, "MATNR", ds_list.GetColumn(0, "MATNR"));
		ds_cond.setColumn(0, "IDNRK", ds_list.GetColumn(0, "IDNRK"));
		ds_cond.setColumn(0, "MATKL", ds_list.GetColumn(0, "MATKL"));

		var sqlstr = " WHERE MANDT ='"    + G_MANDT                          + "'"         
				   + "   AND WOKNUM='"    + ds_list.GetColumn(0, "HOGIN")    + "'"     
				   + "   AND (IDNRK='"    + ds_list.GetColumn(0, "MATNR")    + "'"   
				   + "    OR  MATNR='"    + ds_list.GetColumn(0, "MATNR")    + "'"   
				   + "    AND IDNRK='"    + ds_list.GetColumn(0, "IDNRK")    + "'" 
				   + "    AND MATKL='"    + ds_list.GetColumn(0, "MATKL")    + "'"    
				   + "    OR  MATNR='"    + ds_list.GetColumn(0, "IDNRK")    + "')";
	
		ds_cond.setColumn(0, "SQLSTR", sqlstr);
	
		tit_clearActionInfo();

		tit_addSearchActionInfo("mm01:MM0102002A_S2", null, true);
	
		tit_callService(
			  ""
			, ""
			, "ds_cond=ds_cond"
			, "ds_list2=ds_list"
			, ""
			, ""
			, true);
	}
}/********************************************************************************
* 기      능   :  인쇄 Callback  
********************************************************************************/
function fn_afterQueryPrint() 
{	
	gfn_copyDs(ds_list2,ds_detail);

	for(var i = 0; i<ds_detail.rowcount; i++)
	{
		ds_detail.SetColumn(i,"CRDAT",gfn_formatDate(ds_detail.GetColumn(i,"CRDAT"),'.'));
		ds_detail.SetColumn(i,"SEQ",i+1);
	}
	tit_showDs(ds_detail);

	// UbiReport Call
	Dialog("MM01::MM0102003B.xml", "", -1, -1, "Resize=true");
}
/********************************************************************************
* 기      능   : 닫기  
********************************************************************************/
function fn_close() 
{
	close();
}
/********************************************************************************
* 기      능   : print 40
********************************************************************************/
function fn_print() 
{
//	PrintScreen(false);

	if (ds_list.rowcount < 1)
	{
		gfn_showAlert("CW00013");
		return;
	}
	
	// head copy
	ds_head.ClearData();

	ds_head.AddRow();

	ds_head.SetColumn(0,"HOGI"     ,ds_list.GetColumn(0,"HOGIN")   );
	ds_head.SetColumn(0,"CONSNAM"  ,ds_list.GetColumn(0,"SITE_NM") );
	ds_head.SetColumn(0,"ATYPE"    ,ds_list.GetColumn(0,"SPEC1")   );
	ds_head.SetColumn(0,"SPEC"     ,ds_list.GetColumn(0,"SPEC2")   );
	ds_head.SetColumn(0,"ITEM_NO"  ,ds_list.GetColumn(0,"MATKL")   );
	ds_head.SetColumn(0,"ITEM_NAM" ,ds_list.GetColumn(0,"MATNR_NM"));
	ds_head.SetColumn(0,"ZSPEC"    ,ds_list.GetColumn(0,"SPEC")    );
	ds_head.SetColumn(0,"ZSIZE"    ,ds_list.GetColumn(0,"SIZE")    );
	ds_head.SetColumn(0,"PLAN_NO"  ,ds_list.GetColumn(0,"DZEINR")  );
	ds_head.SetColumn(0,"MATNR"    ,ds_list.GetColumn(0,"IDNRK")   );
	ds_head.SetColumn(0,"PSMNG"    ,ds_list.GetColumn(0,"MENGE")   );
	ds_head.SetColumn(0,"AMEIN"    ,ds_list.GetColumn(0,"MEINS")   );
	ds_head.SetColumn(0,"PPLDAT"   ,""      );
	ds_head.SetColumn(0,"SSCDAT"   ,""      );
	ds_head.SetColumn(0,"PART"     ,ds_list.GetColumn(0,"PART")    );
	ds_head.SetColumn(0,"AUFNR"    ,""      );
	ds_head.SetColumn(0,"CRUSER"   ,ds_list.GetColumn(0,"CRUSER")  );
	ds_head.SetColumn(0,"PART_NM"  ,ds_list.GetColumn(0,"PART_NM") );
	ds_head.SetColumn(0,"ITEM_SEQ" ,ds_list.GetColumn(0,"ITEM_SEQ"));
	ds_head.SetColumn(0,"CURRDATE",gfn_formatDate(ds_list.GetColumn(0,"CURRDATE"),'.'));
	
	// detail copy
    ds_detail.ClearData();
    gfn_copyDs(ds_list2,ds_detail);

	for(var i = 0; i<ds_detail.rowcount; i++)
	{
		ds_detail.SetColumn(i,"CRDAT",gfn_formatDate(ds_detail.GetColumn(i,"CRDAT"),'.'));
		ds_detail.SetColumn(i,"SEQ",i+1);
	}
	// UbiReport Call
	Dialog("MM01::MM0102003B.xml", "", -1, -1, "Resize=true");
}
/********************************************************************************
* 기      능   : 세부내역 액셀  
********************************************************************************/
function fn_excel() 
{
	var str = "호기번호 : " + ds_list.GetColumn(0, "HOGIN")    + ", "
		    + "  공사명 : " + ds_list.GetColumn(0, "SITE_NM")  + ",\n"
		    + "    기종 : " + ds_list.GetColumn(0, "SPEC1")    + ", "
		    + "제품사양 : " + ds_list.GetColumn(0, "SPEC2")    + ", "
		    + "자재번호 : " + ds_list.GetColumn(0, "IDNRK")    + ", "
		    + "자재내역 : " + ds_list.GetColumn(0, "MATNR_NM") + ", " 
		    + "    SPEC : " + ds_list.GetColumn(0, "SPEC")     + ", " 
		    + "    SIZE : " + ds_list.GetColumn(0, "SIZE")     + ",\n"
		    + "도면번호 : " + ds_list.GetColumn(0, "DZEINR")   + ", "
		    + "    PART : " + ds_list.GetColumn(0, "PART_NM")  + ", "
		    + "   BLOCK : " + ds_list.GetColumn(0, "BLOCK")    + ",\n"
		    + "    수량 : " + ds_list.GetColumn(0, "MENGE")    + ", "
		    + "    단위 : " + ds_list.GetColumn(0, "MEINS")    + "";
	
	setExcelGridHeader(grd_list2,str);
}

function setExcelGridHeader(grdObj,strText)
{
	create("grid","grdExcel",'BindDataSet="' + grdObj.BindDataset +'"');
	grdExcel.contents = grdObj.Contents;
	
	var headCnt = getHeadCount(grdExcel);
	var totCol  = grdExcel.GetColCount();
	
	var irow;
	
	for(var i = 0 ; i < headCnt ; i++ )
	{
		irow = toInteger(grdExcel.GetCellProp("head",i,"row"));
		grdExcel.SetCellProp("head",i,"row",irow+1);
	}

	var str_temp = grdExcel.GetCurContents();
	var str_Head = '<cell align="left" col="0" colspan="' + totCol + '" display="text" text="' + strText + '"/>';	
	str_temp = replace(str_temp, '</head>',str_Head +'</head>');
		
	grdExcel.contents = str_temp;

	grdExcel.ExportExcelEx("품목표","A1",false,true,true);

	Destroy(grdExcel);
}

function getHeadCount(grdObj)
{
	var strConts = grdObj.Contents;
	
	var iPos = pos(strConts,"<head>");

	var strHead = Mid(strConts,iPos);
	
	iPos = pos(strHead,"</head>");
	
	strHead = Mid(strHead,0,iPos+7);
	
//	trace(strHead);
	
	var spObj = split(strHead,chr(10),"webstyle");
	
	return spObj.length()-2;
}

]]></Script>
</Window>