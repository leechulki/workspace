<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="562" Id="PS1120001A" Left="8" OnLoadCompleted="fn_OnLoadCompleted" OnUnloadCompleted="fn_OnUnloadCompleted" PidAttrib="7" Title="리모델링&#32;실측등록" Top="8" Ver="1.0" Width="978" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_cond">
				<Contents>
					<colinfo id="QTNUM" size="256" summ="default" type="STRING"/>
					<colinfo id="QTSER" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
					<colinfo id="VBELN" size="256" summ="default" type="STRING"/>
					<colinfo id="MANDT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="cwt_code">
				<Contents>
					<colinfo Id="CODE" Size="256" Type="STRING"/>
					<colinfo Id="CODE_NAME" Size="256" Type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="use_code">
				<Contents>
					<colinfo Id="CODE" Size="256" Type="STRING"/>
					<colinfo Id="CODE_NAME" Size="256" Type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_error"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_rad_list" OnColumnChanged="ds_rad_list_OnColumnChanged" OnRowPosChanged="ds_rad_list_OnRowPosChanged">
				<Contents>
					<colinfo id="FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="QTSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="ECWTP" size="256" summ="default" type="STRING"/>
					<colinfo id="CBRK" size="256" summ="default" type="STRING"/>
					<colinfo id="CRST" size="256" summ="default" type="STRING"/>
					<colinfo id="ERST" size="256" summ="default" type="STRING"/>
					<colinfo id="HRST" size="256" summ="default" type="STRING"/>
					<colinfo id="MRST" size="256" summ="default" type="STRING"/>
					<colinfo id="NOTICE" size="256" summ="default" type="STRING"/>
					<colinfo id="SUVST" size="256" summ="default" type="STRING"/>
					<colinfo id="GTYPE" size="256" summ="default" type="STRING"/>
					<colinfo id="ZUSE" size="256" summ="default" type="STRING"/>
					<colinfo id="TYPE1" size="256" summ="default" type="STRING"/>
					<colinfo id="TYPE2" size="256" summ="default" type="STRING"/>
					<colinfo id="SUVDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="SUVSN" size="256" summ="default" type="STRING"/>
					<colinfo id="HOGI" size="256" summ="default" type="STRING"/>
					<colinfo id="BRNDCD" size="256" summ="default" type="STRING"/>
					<colinfo id="SUVNAM" size="256" summ="default" type="STRING"/>
					<colinfo id="PRINT_HOGI" size="256" summ="default" type="STRING"/>
					<colinfo id="QTNUM" size="256" summ="default" type="STRING"/>
					<colinfo id="QTSER" size="256" summ="default" type="STRING"/>
					<colinfo id="VBELN" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="SAPSEQ" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Filter" FilterExpr="Length(SUVPRD)&amp;gt;0" Id="ds_rad_prh"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_master">
				<Contents>
					<column id="GSNAM" type="STRING"></column>
					<column id="MANDT" type="STRING"></column>
					<column id="NAME1" type="STRING"></column>
					<column id="NAMET" type="STRING"></column>
					<column id="PM" type="STRING"></column>
					<column id="PSPID" type="STRING"></column>
					<column id="QTNUM" type="STRING"></column>
					<column id="QTSEQ" type="STRING"></column>
					<column id="QTSER" type="STRING"></column>
					<column id="USER_ID" type="STRING"></column>
					<column id="VBELN" type="STRING"></column>
					<column id="ZKUNNR" type="STRING"></column>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond2">
				<Contents>
					<colinfo id="QTNUM" size="256" summ="default" type="STRING"/>
					<colinfo id="QTSER" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
					<colinfo id="VBELN" size="256" summ="default" type="STRING"/>
					<colinfo id="MANDT" size="256" summ="default" type="STRING"/>
					<colinfo id="QTSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="SUVSN" size="256" summ="default" type="STRING"/>
					<colinfo id="SUVST" size="256" summ="default" type="STRING"/>
					<colinfo id="PRINT_HOGI" size="256" summ="default" type="STRING"/>
					<colinfo id="HOGI" size="256" summ="default" type="STRING"/>
					<colinfo id="SAPSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="MAX_HTSER" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond_code">
				<Contents>
					<colinfo id="MANDT" size="256" summ="default" type="STRING"/>
					<colinfo id="SUVPRH" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_dummy">
				<Contents>
					<colinfo id="SUVPRH" size="256" summ="default" type="STRING"/>
					<colinfo id="MANDT" size="256" summ="default" type="STRING"/>
					<colinfo id="SUVPRHNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="SUVPRD" size="256" summ="default" type="STRING"/>
					<colinfo id="SUVPRDNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="VIEWORDER" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ELR_B_ECWTP">
				<Contents>
					<colinfo id="SUVPRH" size="256" summ="default" type="STRING"/>
					<colinfo id="MANDT" size="256" summ="default" type="STRING"/>
					<colinfo id="SUVPRHNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="SUVPRD" size="256" summ="default" type="STRING"/>
					<colinfo id="SUVPRDNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="VIEWORDER" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ELR_B_CBRK">
				<Contents>
					<colinfo id="SUVPRH" size="256" summ="default" type="STRING"/>
					<colinfo id="MANDT" size="256" summ="default" type="STRING"/>
					<colinfo id="SUVPRHNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="SUVPRD" size="256" summ="default" type="STRING"/>
					<colinfo id="SUVPRDNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="VIEWORDER" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_CD_R_STAT">
				<Contents>
					<colinfo id="SUVPRH" size="256" summ="default" type="STRING"/>
					<colinfo id="MANDT" size="256" summ="default" type="STRING"/>
					<colinfo id="SUVPRHNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="SUVPRD" size="256" summ="default" type="STRING"/>
					<colinfo id="SUVPRDNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="VIEWORDER" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_CD_S_STAT">
				<Contents>
					<colinfo id="SUVPRH" size="256" summ="default" type="STRING"/>
					<colinfo id="MANDT" size="256" summ="default" type="STRING"/>
					<colinfo id="SUVPRHNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="SUVPRD" size="256" summ="default" type="STRING"/>
					<colinfo id="SUVPRDNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="VIEWORDER" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_CD_R_TYPE">
				<Contents>
					<colinfo id="SUVPRH" size="256" summ="default" type="STRING"/>
					<colinfo id="MANDT" size="256" summ="default" type="STRING"/>
					<colinfo id="SUVPRHNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="SUVPRD" size="256" summ="default" type="STRING"/>
					<colinfo id="SUVPRDNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="VIEWORDER" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ee_hpb">
				<Contents>
					<colinfo id="FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="MANDT" size="256" summ="default" type="STRING"/>
					<colinfo id="SUVSN" size="256" summ="default" type="STRING"/>
					<colinfo id="INORDER" size="256" summ="default" type="STRING"/>
					<colinfo id="APPLYFLOOR" size="256" summ="default" type="STRING"/>
					<colinfo id="ELR_E_IDTP" size="256" summ="default" type="STRING"/>
					<colinfo id="ELR_E_HLLC" size="256" summ="default" type="STRING"/>
					<colinfo id="ELR_E_FSLC" size="256" summ="default" type="STRING"/>
					<colinfo id="ELR_E_A" size="256" summ="default" type="STRING"/>
					<colinfo id="ELR_E_B" size="256" summ="default" type="STRING"/>
					<colinfo id="ELR_E_C" size="256" summ="default" type="STRING"/>
					<colinfo id="ELR_E_D" size="256" summ="default" type="STRING"/>
					<colinfo id="ELR_E_E" size="256" summ="default" type="STRING"/>
					<colinfo id="ELR_E_F" size="256" summ="default" type="STRING"/>
					<colinfo id="ELR_E_BXD" size="256" summ="default" type="STRING"/>
					<colinfo id="ELR_E_H" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ELR_E_HLLC">
				<Contents>
					<colinfo id="SUVPRD" size="90" summ="default" type="STRING"/>
					<colinfo id="SUVPRDNAME" size="150" summ="default" type="STRING"/>
					<colinfo id="SUVPRH" size="90" summ="default" type="STRING"/>
					<colinfo id="VIEWORDER" size="6" summ="default" type="INT"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ELR_E_IDTP">
				<Contents>
					<colinfo id="SUVPRD" size="90" summ="default" type="STRING"/>
					<colinfo id="SUVPRDNAME" size="150" summ="default" type="STRING"/>
					<colinfo id="SUVPRH" size="90" summ="default" type="STRING"/>
					<colinfo id="VIEWORDER" size="6" summ="default" type="INT"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ELR_E_FSLC">
				<Contents>
					<colinfo id="SUVPRD" size="90" summ="default" type="STRING"/>
					<colinfo id="SUVPRDNAME" size="150" summ="default" type="STRING"/>
					<colinfo id="SUVPRH" size="90" summ="default" type="STRING"/>
					<colinfo id="VIEWORDER" size="6" summ="default" type="INT"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_dummy2">
				<Contents>
					<colinfo id="MAX_HTSER" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_input_list">
				<Contents>
					<colinfo id="SUVSN" size="30" summ="default" type="STRING"/>
					<colinfo id="SUVPRH" size="90" summ="default" type="STRING"/>
					<colinfo id="SUVTYPE" size="15" summ="default" type="STRING"/>
					<colinfo id="SUVPRD" size="90" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_rad_trans">
				<Contents>
					<colinfo id="MESGACCP" size="256" summ="default" type="STRING"/>
					<colinfo id="MESGTITL" size="256" summ="default" type="STRING"/>
					<colinfo id="MESGDESC" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
		</Datasets>
		<Div Height="36" Id="div_btn" TabOrder="0" ToolTipFont="Default,0" Url="WB01::CommBtnForm.xml" Width="976">
			<Contents></Contents>
		</Div>
		<Shape BKColor="user12" Bottom="68" Height="26" Id="Shape0" Left="11" LineColor="user13" Right="968" TabOrder="1" Top="42" Type="Rectangle" Width="957"></Shape>
		<Static Align="Right" Height="24" Id="Static0" Left="12" Style="sty_lb_form_basic" TabOrder="2" Text="견적번호&#32;" Top="43" VAlign="Middle" Width="94"></Static>
		<Edit BindDataset="ds_cond" Border="Flat" Column="QTNUM" Enable="FALSE" Height="20" Id="Edit1" Left="108" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="3" Text="aaaaa" Top="45" Width="157"></Edit>
		<Static Align="Right" Height="24" Id="Static4" Left="269" Style="sty_lb_form_basic" TabOrder="3" Text="공사명&#32;" Top="42" VAlign="Middle" Width="94"></Static>
		<Edit BindDataset="ds_master" Border="Flat" Column="GSNAM" Enable="FALSE" Height="20" Id="Edit3" Left="365" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="3" Top="45" Width="332"></Edit>
		<Static Align="Right" Height="24" Id="Static2" Left="699" Style="sty_lb_form_basic" TabOrder="4" Text="프로젝트/수주번호&#32;" Top="43" VAlign="Middle" Width="94"></Static>
		<Edit BindDataset="ds_master" Border="Flat" Column="VBELN" Enable="FALSE" Height="20" Id="Edit2" Left="794" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="4" Top="45" Width="157"></Edit>
		<Shape BKColor="user12" Bottom="93" Height="26" Id="Shape2" Left="11" LineColor="user13" Right="968" TabOrder="9" Top="67" Type="Rectangle" Width="957"></Shape>
		<Static Align="Right" Height="24" Id="Static5" Left="12" Style="sty_lb_form_basic" TabOrder="11" Text="실측자&#32;" Top="68" VAlign="Middle" Width="94"></Static>
		<Edit BindDataset="ds_master" Border="Flat" Column="USER_ID" Height="20" Id="Edit9" Left="108" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="10" Top="70" Width="117"></Edit>
		<Static Align="Right" Height="24" Id="Static11" Left="246" Style="sty_lb_form_basic" TabOrder="13" Text="PM&#32;" Top="69" VAlign="Middle" Width="94"></Static>
		<Edit BindDataset="ds_master" Border="Flat" Column="NAMET" Enable="FALSE" Height="20" Id="Edit5" Left="342" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="12" Top="71" Width="117"></Edit>
		<Static Align="Right" Height="24" Id="Static1" Left="485" Style="sty_lb_form_basic" TabOrder="15" Text="영업담당&#32;" Top="68" VAlign="Middle" Width="94"></Static>
		<Edit BindDataset="ds_master" Border="Flat" Column="ZKUNNR" Enable="FALSE" Height="20" Id="Edit0" Left="581" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="14" Top="70" Width="117"></Edit>
		<Static Align="Right" Height="24" Id="Static3" Left="737" Style="sty_lb_form_basic" TabOrder="17" Text="기술영업담당&#32;" Top="68" VAlign="Middle" Width="94"></Static>
		<Edit BindDataset="ds_master" Border="Flat" Column="NAME1" Enable="FALSE" Height="20" Id="Edit4" Left="835" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="16" Top="71" Width="117"></Edit>
		<Grid AutoEnter="TRUE" AutoFitEndLine="Hide" BindDataset="ds_rad_list" BkColor2="default" BoldHead="true" Border="Flat" Bottom="280" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="160" Id="grd_rad_list" InputPanel="FALSE" Left="8" LineColor="user20" LineType="ExHORZ" OnExpandEdit="grd_rad_list_OnExpandEdit" Right="968" RowHeight="20" Style="sty_grid" TabOrder="18" TabStop="true" Top="120" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="960">
			<contents>
				<format id="Default">
					<columns>
						<col width="48"/>
						<col width="93"/>
						<col width="57"/>
						<col width="69"/>
						<col width="73"/>
						<col width="65"/>
						<col width="86"/>
						<col width="106"/>
						<col width="106"/>
						<col width="106"/>
						<col width="106"/>
						<col width="106"/>
						<col width="103"/>
						<col width="89"/>
						<col width="89"/>
					</columns>
					<head>
						<cell align="center" col="0" color="user21" display="text" font="굴림,9" rowspan="2" text="상태"/>
						<cell align="center" col="1" color="user21" display="text" font="굴림,9" rowspan="2" text="일련번호/호기"/>
						<cell col="2" color="user21" display="text" font="굴림,9" rowspan="2" text="기종"/>
						<cell col="3" color="user21" display="text" font="굴림,9" rowspan="2" text="용도"/>
						<cell col="4" color="user21" display="text" font="굴림,9" rowspan="2" text="인승"/>
						<cell col="5" color="user21" display="text" font="굴림,9" rowspan="2" text="속도"/>
						<cell col="6" color="user21" display="text" font="굴림,9" rowspan="2" text="실측일자"/>
						<cell align="center" col="7" color="user21" display="text" font="굴림,9" rowspan="2" text="CWT&#32;위치"/>
						<cell align="center" col="8" color="user21" display="text" font="굴림,9" rowspan="2" text="공용&#32;브라켓"/>
						<cell col="9" colspan="4" display="text">
							<cell col="0" display="text"/>
							<cell align="center" col="1" color="user21" display="text" font="굴림,9" text="실측보고서"/>
							<cell align="center" col="2" color="user21" display="text" font="굴림,9" text="등록상태"/>
							<cell col="3" display="text"/>
						</cell>
						<cell align="center" col="9" color="user21" display="text" font="굴림,9" row="1" text="승강로"/>
						<cell align="center" col="10" color="user21" display="text" font="굴림,9" row="1" text="기계실"/>
						<cell align="center" col="11" color="user21" display="text" font="굴림,9" row="1" text="CWT&#32;및&#32;층고"/>
						<cell align="center" col="12" color="user21" display="text" font="굴림,9" row="1" text="승장부문"/>
						<cell align="center" col="13" color="user21" display="text" font="굴림,9" rowspan="2" text="특이사항"/>
						<cell align="center" col="14" color="user21" display="text" font="굴림,9" rowspan="2" text="실측진행상태"/>
					</head>
					<body>
						<cell bkcolor2="user22" bkimageid='expr:gfn_getFlagBkImageID(getColumn(currow,&#32;&quot;FLAG&quot;))' col="0" display="text"/>
						<cell align="center" bkcolor2="user22" col="1" colid="PRINT_HOGI" display="text"/>
						<cell align="center" col="2" colid="GTYPE" display="text"/>
						<cell align="center" col="3" colid="ZUSE" display="text"/>
						<cell align="center" col="4" colid="TYPE1" display="text"/>
						<cell align="center" col="5" colid="TYPE2" display="text"/>
						<cell align="center" col="6" colid="SUVDAT" display="date" edit="date"/>
						<cell col="7" colid="ECWTP" combocol="SUVPRD" combodataset="ds_ELR_B_ECWTP" combotext="SUVPRDNAME" display="combo" edit="combo"/>
						<cell col="8" colid="CBRK" combocol="SUVPRD" combodataset="ds_ELR_B_CBRK" combotext="SUVPRDNAME" display="combo" edit="combo"/>
						<cell col="9" colid="HRST" combocol="SUVPRD" combodataset="ds_CD_R_STAT" combotext="SUVPRDNAME" display="combo" expandshow="true"/>
						<cell col="10" colid="MRST" combocol="SUVPRD" combodataset="ds_CD_R_STAT" combotext="SUVPRDNAME" display="combo" expandshow="true"/>
						<cell col="11" colid="CRST" combocol="SUVPRD" combodataset="ds_CD_R_STAT" combotext="SUVPRDNAME" display="combo" expandshow="true"/>
						<cell col="12" colid="ERST" combocol="SUVPRD" combodataset="ds_CD_R_STAT" combotext="SUVPRDNAME" display="combo" expandshow="true"/>
						<cell bkcolor2="user22" col="13" colid="NOTICE" display="text" expandshow="expr:decode(fn_isNull(NOTICE),&apos;1&apos;,&apos;false&apos;,&apos;true&apos;)"/>
						<cell col="14" colid="SUVST" combocol="SUVPRD" combodataset="ds_CD_S_STAT" combotext="SUVPRDNAME" display="combo"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Grid AutoFitEndLine="Hide" BindDataset="ds_rad_prh" BkColor2="default" BoldHead="true" Border="Flat" Bottom="545" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="241" Id="grd_rad_prh" InputPanel="FALSE" Left="8" LineColor="user20" LineType="ExHORZ" Right="472" RowHeight="20" Style="sty_grid" TabOrder="19" TabStop="true" Top="304" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="464">
			<contents>
				<format id="Default">
					<columns>
						<col width="41"/>
						<col width="92"/>
						<col width="60"/>
						<col width="0"/>
						<col width="152"/>
						<col width="88"/>
						<col width="129"/>
					</columns>
					<head>
						<cell align="center" col="0" color="user21" display="text" font="굴림,9" text="상태"/>
						<cell align="center" col="1" color="user21" display="text" font="굴림,9" text="일련번호/호기"/>
						<cell align="center" col="2" color="user21" display="text" font="굴림,9" text="보고서"/>
						<cell align="center" col="3" color="user21" display="text" font="굴림,9" text="사양"/>
						<cell align="center" col="4" color="user21" display="text" font="굴림,9" text="사양명"/>
						<cell align="center" col="5" color="user21" display="text" font="굴림,9" text="실측값"/>
						<cell align="center" col="6" color="user21" display="text" font="굴림,9" text="등록자"/>
					</head>
					<body>
						<cell col="0" display="text"/>
						<cell align="center" bkcolor2="user22" col="1" colid="HOGI" display="text"/>
						<cell align="center" col="2" colid="SUVTYPE" combocol="SUVPRD" combodataset="ds_CD_R_TYPE" combotext="SUVPRDNAME" display="combo"/>
						<cell align="center" bkcolor2="user22" col="3" colid="SUVPRH" display="text"/>
						<cell align="left" bkcolor2="user22" col="4" colid="SUVPRHNAME" display="text"/>
						<cell align="right" bkcolor2="user22" col="5" colid="SUVPRD" display="text"/>
						<cell align="center" bkcolor2="user22" col="6" colid="ERNAM" display="text"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="Button0" ImageID="btn_sub_05" Left="883" LeftMargin="12" OnClick="btn_rap_cal_OnClick" Style="sty_btn" TabOrder="20" Text="실측등록완료" Top="96" Transparent="TRUE" Width="83"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_survey_copy" ImageID="btn_sub_04" Left="812" LeftMargin="12" OnClick="btn_survey_copy_OnClick" Style="sty_btn" TabOrder="21" Text="실측&#32;복사" Top="96" Transparent="TRUE" Width="71"></Button>
		<PopupDiv Border="Flat" BorderColor="user16" Height="75" Id="popdiv_notice" Left="104" ShadowColor="user8" TabOrder="22" TabStop="FALSE" Top="376" Width="757">
			<Contents>
				<Image FillType="STRETCH" Height="36" Id="img_bak" ImageID="popup_title_back" TabOrder="3" Width="856"></Image>
				<Static Align="Right" Height="36" Id="Static12" Style="sty_lb_form_basic" TabOrder="2" Text="특이사항&#32;&#10;모든&#32;보고서&#32;공용&#32;&#32;" Top="36" VAlign="Middle" Width="95"></Static>
				<TextArea Border="Flat" Height="33" Id="ta_NOTICE" Left="97" MaxLength="100" Readonly="TRUE" Style="sty_ipt_form" TabOrder="1" Top="38" VScroll="TRUE" Width="656"></TextArea>
				<Image Height="36" Id="Image1" ImageID="form_bl_title_main" Left="8" LeftMargin="10" TabOrder="4" Width="15"></Image>
				<Static Color="user5" Font="굴림,10,Bold" Height="20" Id="st_title" Left="28" TabOrder="5" Text="특이사항" Top="8" VAlign="Middle" Width="348"></Static>
			</Contents>
		</PopupDiv>
		<Static Color="user6" Font="굴림,9,Bold" Height="20" Id="Static13" Left="496" TabOrder="24" Text="표시기&#32;실측사양값" Top="282" VAlign="Middle" Width="822"></Static>
		<Image Height="19" Id="Image4" ImageID="form_bl_title_sub" Left="485" TabOrder="23" Top="283" Width="11"></Image>
		<Static Color="user6" Font="굴림,9,Bold" Height="20" Id="Static6" Left="24" TabOrder="25" Text="실측사양(표시기제외)" Top="282" VAlign="Middle" Width="400"></Static>
		<Grid AutoEnter="TRUE" AutoFitEndLine="Hide" BindDataset="ds_ee_hpb" BkColor2="default" BoldHead="true" Border="Flat" Bottom="545" ColSizing="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="241" Id="grd_hpb" InputPanel="FALSE" Left="480" LineColor="user20" LineType="ExHORZ" Right="968" RowHeight="20" Style="sty_grid" TabOrder="26" TabStop="true" Top="304" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="488">
			<contents>
				<format id="Default">
					<columns>
						<col width="35"/>
						<col width="63"/>
						<col width="88"/>
						<col width="90"/>
						<col width="93"/>
						<col width="50"/>
						<col width="50"/>
						<col width="50"/>
						<col width="50"/>
						<col width="50"/>
						<col width="50"/>
						<col width="60"/>
						<col width="50"/>
					</columns>
					<head>
						<cell align="center" col="0" color="user21" display="text" font="굴림,9" text="상태"/>
						<cell col="1" color="user21" display="text" font="굴림,9" text="적용층"/>
						<cell align="center" col="2" color="user21" display="text" font="굴림,9" text="종류"/>
						<cell col="3" color="user21" display="text" font="굴림,9" text="홀랜턴&#32;위치"/>
						<cell col="4" color="user21" display="text" font="굴림,9" text="소방스위치&#32;위치"/>
						<cell col="5" color="user21" display="text" font="굴림,9" text="A"/>
						<cell col="6" color="user21" display="text" font="굴림,9" text="B"/>
						<cell col="7" color="user21" display="text" font="굴림,9" text="F"/>
						<cell col="8" color="user21" display="text" font="굴림,9" text="C"/>
						<cell col="9" color="user21" display="text" font="굴림,9" text="D"/>
						<cell col="10" color="user21" display="text" font="굴림,9" text="E"/>
						<cell col="11" color="user21" display="text" font="굴림,9" text="BOX깊이"/>
						<cell col="12" color="user21" display="text" font="굴림,9" text="H"/>
					</head>
					<body>
						<cell bkimageid='expr:gfn_getFlagBkImageID(getColumn(currow,&#32;&quot;FLAG&quot;))' col="0" display="text"/>
						<cell align="center" col="1" colid="APPLYFLOOR" display="text" edit="normal" limit="30"/>
						<cell align="center" bkcolor2="user22" col="2" colid="ELR_E_IDTP" combocol="SUVPRD" combodataset="ds_ELR_E_IDTP" combodisplayrowcnt="6" combotext="SUVPRDNAME" display="combo" edit="combo"/>
						<cell col="3" colid="ELR_E_HLLC" combocol="SUVPRD" combodataset="ds_ELR_E_HLLC" combotext="SUVPRDNAME" display="combo" edit="expr:decode(ELR_E_IDTP,&apos;HLT&apos;,&apos;combo&apos;,&apos;none&apos;)"/>
						<cell col="4" colid="ELR_E_FSLC" combocol="SUVPRD" combodataset="ds_ELR_E_FSLC" combotext="SUVPRDNAME" display="combo" edit="expr:decode(ELR_E_IDTP,&apos;FSW&apos;,&apos;combo&apos;,&apos;none&apos;)"/>
						<cell col="5" colid="ELR_E_A" display="number" edit="number" limit="5"/>
						<cell col="6" colid="ELR_E_B" display="number" edit="number" limit="5"/>
						<cell col="7" colid="ELR_E_F" display="number" edit="number" limit="5"/>
						<cell col="8" colid="ELR_E_C" display="number" edit="number" limit="5"/>
						<cell col="9" colid="ELR_E_D" display="number" edit="number" limit="5"/>
						<cell col="10" colid="ELR_E_E" display="number" edit="number" limit="5"/>
						<cell col="11" colid="ELR_E_BXD" display="text" edit="normal" limit="15"/>
						<cell col="12" colid="ELR_E_H" display="number" edit="number" limit="5"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Image Height="19" Id="Image0" ImageID="form_bl_title_sub" Left="8" TabOrder="27" Top="283" Width="11"></Image>
		<CyHttpFile Height="24" Id="httpFile" Left="984" Top="16" Width="24"></CyHttpFile>
		<FileDialog Bottom="39" Height="24" Id="saveDialog" Left="1009" Right="1033" TabOrder="27" Top="15" Type="Save" Width="24"></FileDialog>
	</Form>
	<Script><![CDATA[﻿﻿﻿﻿﻿﻿﻿﻿/*
 ******************************************************************************************
 * 기      능   : 
 * 작  성  자   : 
 * 작성  일자   : 
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
#include "LIB::commons.js";	// 공통 스크립트 
#include "LIB::utility.js";	// 다중 선택 

//=========================================================================================
// [ PART 1 ]
// Form에서 사용될 전역변수를 선언
// FORM에서 사용되는 전역변수는 대문자로 작성하며, F_XXX 의 형태를 갖도록 한다. 
//=========================================================================================
var F_TITLE = "리모델링 실측등록";
var F_SUVST = "T";  // T: 처리중, "S: 실측화면에서 정상적으로 S 성공처리함

//=========================================================================================
// [ PART 2 ]
// Form Loading / Unloading 시 작업 정의
//=========================================================================================
function fn_OnLoadCompleted(obj) {
	//trace("견적번호 : " + QTNUM);
	ds_master.MANDT = G_MANDT;
	ds_master.QTNUM = QTNUM;
	//ds_cond.AddRow();
	//ds_cond.SetColumn(0,"QTNUM",QTNUM)
	ds_master.QTSER = QTSER;
	//ds_cond.SetColumn(0,"QTSER",QTSER)
	ds_master.GSNAM = GSNAM;
	ds_master.NAME1 = NAME1;
	ds_master.NAMET = NAMET;
	//ds_master.PM = PM;
	ds_master.VBELN = VBELN; 
	//ds_cond.SetColumn(0,"VBELN",VBELN)
	ds_master.ZKUNNR = ZKUNNR;
	//ds_master.USER_ID = G_USER_ID;
	
	div_btn.fn_loadUseBtn("1,30,45,900", F_TITLE, "", "");
    fn_resize();
	gfn_initForm();
	fn_init_form();
}


/********************************************************************************
* 쿼리  : 코드 조회 : CWT 위치
********************************************************************************/
function fn_query_code(code) {

	var arr = split(code, ",");
	for(var i = 0; i < arr.length(); i++) {

		ds_cond_code.ClearData();
		ds_cond_code.AppendRow();
		ds_cond_code.SetColumn(0, "MANDT", G_MANDT);
		ds_cond_code.SetColumn(0, "SUVPRH", arr[i]);
		
		//trace("arr["+i+"]" + arr[i]);
		
		tit_clearActionInfo();
		tit_addSearchActionInfo("ps11:PS1120001A_S3"); // 헤더 조회
		
		tit_callService(""
		    			,""
						,"ds_cond=ds_cond_code"
						,"ds_dummy=ds_dummy"
						,""
						,"fn_afterQuery_code"
						,""
						,""
						,true);
	}
}

/********************************************************************************
* 기      능   : 조회 Callback  
********************************************************************************/
function fn_afterQuery_code(errCode, errMsg) {
    //trace("code : " + ds_cond_code.GetColumn(0, "SUVPRH"));
	object("ds_"+ds_cond_code.GetColumn(0, "SUVPRH")).copy(ds_dummy);
	//object("ds_"+ds_cond_code.GetColumn(0, "SUVPRH")).saveXML();
}


/********************************************************************************
* 기      능   : form UnloadCompleted 
********************************************************************************/
function fn_OnUnloadCompleted(obj) {
	return gfn_isFormUnload(obj);
}

/********************************************************************************
* 기      능   : 폼 초기화
********************************************************************************/
function fn_init_form() {
    //ed_brndseq.Text = F_BRNDSEQ;
    
    fn_query_code("ELR_B_ECWTP,ELR_B_CBRK,CD_R_STAT,CD_S_STAT,CD_R_TYPE,ELR_E_IDTP,ELR_E_HLLC,ELR_E_FSLC");
    
    // 초기 쿼리 수행
    //trace("초기 쿼리수행");
    fn_query();
} 

function fn_resize() {
	this.onsize = "";
	window.top    = GetPlatformInfo("WorkArea","top");
	window.left   = GetPlatformInfo("WorkArea","left");
	window.width  = GetPlatformInfo("WorkArea","width");
	window.height = GetPlatformInfo("WorkArea","height");
}

//=========================================================================================
// [ PART 3 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,form닫기)
//=========================================================================================
/********************************************************************************
* 기      능   : 조회 1
********************************************************************************/
function fn_query() {

  //trace("fn_query start : ");
  
  
  //trace("견적번호 : " + QTNUM);

  tit_clearActionInfo();
  tit_addSearchActionInfo("ps11:PS1120001A_S1");
  
  // TODO 실제로 값 전달하고 받아 오도록 작성하기
  
                
  
				//TRACE(ds_master.SaveXML());
				
				
  
  				ds_cond.ClearData();
  				ds_rad_list.ClearData();
				ds_cond.AddRow();
				ds_cond.setColumn(0, "MANDT", G_MANDT);
				ds_cond.setColumn(0, "QTNUM", ds_master.QTNUM);
				ds_cond.setColumn(0, "QTSER", ds_master.QTSER);
				ds_cond.setColumn(0, "VBELN", ds_master.VBELN);
				//TRACE(ds_cond.SaveXML());
				//ds_cond.setColumn(0, "BIGO", ds_list_tmp.GetColumn(i, "BIGO"))
  
  	 tit_callService(
        ""
        , ""
        , "ds_cond=ds_cond"
        , "ds_rad_list=ds_rad_list"
        , ""
        , "fn_afterQuery"
		, true
		, true
		, true);
}

/********************************************************************************
* 기      능   : 조회 Callback  
********************************************************************************/
function fn_afterQuery(errCode, errMsg) {
	//trace(ds_rad_list.saveXML());
	fn_query2();
	fn_query3();
	//fn_query4();
}

/********************************************************************************
* 기      능   : 닫기  
********************************************************************************/
function fn_close() {

	// 하나의 정보라도 변경된 정보가 있으면 체크하고 새로운 창을 띄우지 않는다. 
	for(var i=0; i< ds_rad_list.count; i++) {
	
		if(ds_rad_list.GetColumn(i, "FLAG")!="") {
			if(gfn_openMsgWin("변경 사항이 있습니다. \n이대로 닫으면, 변경사항은 저장 되지 않습니다.\n"+
		          "저장을 눌러 저장 할 수 있습니다.\n"+
		          "창을 닫으시겠습니까?" , "W","C")) {
				this.Close();
			}else {
				return false;
			}
		}
	
	 }

	

    this.Close();
}

/********************************************************************************
* 기      능   : 실측 타입별 실측등록 화면 호출
********************************************************************************/
function grd_rad_list_OnExpandEdit(obj,nRow,nCell,strVal,nPivotIndex)
{
	if(nCell == 13) {
		var leftX = parseInt(GetPlatformInfo("WorkArea","left")) +100;
		var topY  = parseInt(GetPlatformInfo("WorkArea","top")) + 270;
		
		popdiv_notice.ta_NOTICE.Text = ds_rad_list.GetColumn(nRow, "NOTICE");
		popdiv_notice.TrackPopup(leftX, topY);
		return;
	}
	        
    var ECWTP  = ds_rad_list.GetColumn(nRow, "ECWTP");
    var CBRK   = ds_rad_list.GetColumn(nRow, "CBRK");
    var SUVDAT = ds_rad_list.GetColumn(nRow, "SUVDAT");	   	            	            	            
    
    if(fn_isNull(SUVDAT)) {
		gfn_openMsgWin("실측일을 입력해 주십시오", "I");
		grd_rad_list.SetCellPos(6);
		grd_rad_list.SetFocus();
		return;
	}
	
	if(fn_isNull(ECWTP)) {	
		gfn_openMsgWin("CWT 위치를 선택해주십시오", "I");
		grd_rad_list.SetCellPos(7);
		grd_rad_list.SetFocus();
		return;
	}
	
	if(ECWTP != "R" && fn_isNull(CBRK)) {
		gfn_openMsgWin("공용브라켓 여부를 선택해주십시오", "I");
		grd_rad_list.SetCellPos(8);
		grd_rad_list.SetFocus();
		return;
	}

	// 하나의 정보라도 변경된 정보가 있으면 체크하고 새로운 창을 띄우지 않는다. 
	if(ds_rad_list.CaseCount("FLAG!=''") > 0) {
		gfn_openMsgWin("변경사항이 있습니다. 변경 내용 저장 후 실행해 주십시오.", "W");
		return false;
	}
		
	arg= "QTNUM=" + quote(ds_master.QTNUM);
	arg= arg + ", QTSER=" + quote(ds_master.QTSER);
	arg= arg + ", GSNAM=" + quote(ds_master.GSNAM);
	arg= arg + ", PM=" + quote(ds_master.PM);
	arg= arg + ", NAME1=" + quote(ds_master.NAME1);
	arg= arg + ", NAMET=" + quote(ds_master.NAMET);
	arg= arg + ", VBELN=" + quote(ds_master.VBELN);
	//수주 단계전 견적 단계 테스트를 위해서 주석 처리
	//arg= arg + ", VBELN=" + quote("");
	arg= arg + ", ZKUNNR=" + quote(ds_master.ZKUNNR);           
	arg= arg + ", QTSEQ=" + quote(ds_rad_list.GetColumn(nRow, "QTSEQ"));
	arg= arg + ", GTYPE=" + quote(ds_rad_list.GetColumn(nRow, "GTYPE"));	            
	arg= arg + ", ZUSE=" + quote(ds_rad_list.GetColumn(nRow, "ZUSE"));	            
	arg= arg + ", TYPE1=" + quote(ds_rad_list.GetColumn(nRow, "TYPE1"));
	arg= arg + ", TYPE2=" + quote(ds_rad_list.GetColumn(nRow, "TYPE2"));
	arg= arg + ", ECWTP=" + quote(ds_rad_list.GetColumn(nRow, "ECWTP"));
	arg= arg + ", CBRK=" + quote(ds_rad_list.GetColumn(nRow, "CBRK"));
	arg= arg + ", NOTICE=" + quote(ds_rad_list.GetColumn(nRow, "NOTICE"));
	arg= arg + ", HOGI=" + quote(ds_rad_list.GetColumn(nRow, "HOGI"));
	arg= arg + ", PRINT_HOGI=" + quote(ds_rad_list.GetColumn(nRow, "PRINT_HOGI"));
	arg= arg + ", SUVSN=" + quote(ds_rad_list.GetColumn(nRow, "SUVSN"));
	arg= arg + ", BRNDCD=" + quote(ds_rad_list.GetColumn(nRow, "BRNDCD"));
	arg= arg + ", SUVNAM=" + quote(ds_rad_list.GetColumn(nRow, "SUVNAM"));
	arg= arg + ", SUVDAT=" + quote(ds_rad_list.GetColumn(nRow, "SUVDAT"));	   	            	            	            
	//trace(arg);	

    //alert(nCell);
    var pagUrl = "PS11::PS1120002A.xml";
    var arr;
    switch(nCell) {

	    case 9:
	        // 승강로 부분
			//var pagUrl = "PS11::PS1120002A.xml";
			
			//alert(b);
			//alert(c);
			
	/*		if( b == "R" && c = "Y") {
			    pagUrl = "PS11::PS1120002A.xml";
			} if( b == "R" && c = "N") {
			    alert("후횡락(REAR(90°))의 경우 공용브라켓을 유로 변경해 주십시오.");
				break;
			} else if( b == "F/L" && c = "N") {
			    pagUrl = "PS11::PS1120002B.xml";
			} else if( b == "F/L" && c = "Y") {
			    pagUrl = "PS11::PS1120002C.xml";
			} else if( b == "F/R" && c = "N") {
			    pagUrl = "PS11::PS1120002D.xml";
			} else if( b == "F/R" && c = "Y") {
			    pagUrl = "PS11::PS1120002E.xml";
			}else if( b == "R/L" && c = "N") {
			    pagUrl = "PS11::PS1120002B.xml";	
			} else if( b == "R/L" && c = "Y") {
			    pagUrl = "PS11::PS1120002C.xml";
			} else if( b == "R/R" && c = "N") {
			    pagUrl = "PS11::PS1120002D.xml";
			} else if( b == "R/R" && c = "Y") {
			    pagUrl = "PS11::PS1120002E.xml";
			}
	   */
			
			
			arg= arg + ", CD_R_TYPE=" + quote("H");	
			arr = gfn_openPopupUrl(pagUrl, true, arg);
	        break;
	    case 10:
	        // 기계실
	        /*
			var pagUrl = "PS11::PS1120003A.xml";
			var arr;
			if( b == "R") {
			    pagUrl = "PS11::PS1120003A.xml";
			} else if( b == "F/L" || b=="R/L") {
			    pagUrl = "PS11::PS1120003B.xml";
			} else if( b == "F/R" || b=="R/R") {
			    pagUrl = "PS11::PS1120003C.xml";
			}
			*/
		
			arg= arg + ", CD_R_TYPE=" + quote("M");
			arr = gfn_openPopupUrl(pagUrl, true, arg);
	        break;
	    case 11:
	        // CWT 실측등록
		
			//var arr = gfn_openPopupUrl("PS11::PS1120004A.xml", true, arg);
			arg= arg + ", CD_R_TYPE=" + quote("C");
			//공통 페이지로 호출하기.
			arr = gfn_openPopupUrl(pagUrl, true, arg);
	        break;
	    case 12:
	        // 승장부문 실측등록
				
			
			//var arr = gfn_openPopupUrl("PS11::PS1120005A.xml", true, arg);
			arg= arg + ", CD_R_TYPE=" + quote("E");
			//공통 페이지로 호출하기.
			arr = gfn_openPopupUrl(pagUrl, true, arg);
	        break;
	        
	    default  :
	        break;
	}

	if(arr == "Y") fn_query();

}

/********************************************************************************
* 기      능   : 사양복사 화면 호출
********************************************************************************/
function btn_survey_copy_OnClick(obj)
{
	// 하나의 정보라도 변경된 정보가 있으면 체크하고 새로운 창을 띄우지 않는다. 
	for(var i=0; i< ds_rad_list.count; i++) {
	
		if(ds_rad_list.GetColumn(i, "FLAG")!="") {
			gfn_openMsgWin("변경사항이 있습니다. 변경 내용 저장 후 실행해 주십시오.", "W");
			return false;
		}
	
	 }
	
	var arg = "";
	
				arg= "QTNUM=" + quote(ds_master.QTNUM);
				arg= arg + ", QTSER=" + quote(ds_master.QTSER);
				arg= arg + ", GSNAM=" + quote(ds_master.GSNAM);
				arg= arg + ", PM=" + quote(ds_master.PM);
				arg= arg + ", NAME1=" + quote(ds_master.NAME1);
				arg= arg + ", NAMET=" + quote(ds_master.NAMET);
	            arg= arg + ", VBELN=" + quote(ds_master.VBELN);
	            arg= arg + ", ZKUNNR=" + quote(ds_master.ZKUNNR); 
	            //arg= arg + ", ds_rad_list=" + ds_rad_list;
	            
	            //trace(arg);
	
	var arr = gfn_openPopupUrl("PS11::PS1120001C.xml", true, arg);
	fn_query();
}

function grd_rad_list_OnCellClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{

   
	
}

/********************************************************************************
* 기      능   : grid double click 시 조회 
********************************************************************************/
function fn_query2(nRow) {
    
	//ds_list2.ClearData();
	ds_rad_prh.ClearData();
	
	//trace("START Here");
	
	//trace(nRow);

//alert(ds_list.SaveXML());
	
	ds_cond2.ClearData();
	ds_cond2.AddRow();
	//ds_cond2.setColumn(0, "GBN", ds_list.GetColumn(nRow,"GBN"));
	ds_cond2.SetColumn(0,"MANDT",ds_master.MANDT);
	ds_cond2.SetColumn(0,"QTNUM",ds_master.QTNUM);
	ds_cond2.SetColumn(0,"QTSER",ds_master.QTSER);
	ds_cond2.SetColumn(0,"VBELN",ds_master.VBELN);
	ds_cond2.setColumn(0, "QTSEQ", ds_rad_list.GetColumn(nRow,"QTSEQ"));
	ds_cond2.setColumn(0, "PRINT_HOGI", ds_rad_list.GetColumn(nRow,"PRINT_HOGI"));
	ds_cond2.setColumn(0, "HOGI", ds_rad_list.GetColumn(nRow,"PRINT_HOGI"));
	ds_cond2.setColumn(0, "SUVSN", ds_rad_list.GetColumn(nRow,"SUVSN"));
	if(ds_rad_list.GetColumn(nRow,"SAPSEQ") == -1) {
		ds_cond2.setColumn(0, "SAPSEQ", 0);
	} else {
		ds_cond2.setColumn(0, "SAPSEQ", ds_rad_list.GetColumn(nRow,"SAPSEQ"));
	}
	
	//trace(ds_cond2.SaveXML());
	var userId = ds_rad_list.GetColumn(nRow,"SUVNAM");
	if(Length(userId) > 0) {
        ds_master.USER_ID = userId;
	} else {
	    ds_master.USER_ID = G_USER_NAME;
	}
//alert(ds_cond2.SaveXML());	
	
	tit_clearActionInfo();
	if(ds_master.VBELN !="" && ds_rad_list.GetColumn(nRow,"SAPSEQ") == -1) {
		tit_addSearchActionInfo("ps11:PS1120001A_S6", null, true);
	} else if(ds_master.VBELN !="" && ds_rad_list.GetColumn(nRow,"SAPSEQ") > -1)  {
		tit_addSearchActionInfo("ps11:PS1120001A_S7", null, true);
	} else {
		tit_addSearchActionInfo("ps11:PS1120001A_S5", null, true);
	}
	
	tit_callService(
        ""
        , ""
        , "ds_cond=ds_cond2"
        , "ds_rad_prh=ds_rad_prh"
        , ""
        , "fn_afterQuery2"
        , ""
        , ""
        , true);
     
                  
}


/********************************************************************************
* 기      능   : 조회 Callback  
********************************************************************************/
function fn_afterQuery2(errCode, errMsg) {
	
	//trace(ds_rad_prh.rowcount);
	grd_rad_prh.SetCellProp("head",0,"text",ds_rad_prh.rowcount+" 건");
	//gfn_showMsg("CI00002",ds_list2.RowCount()+"");
}

function fn_query3(nRow) {
	//ds_list2.ClearData();
	ds_ee_hpb.ClearData();
	
	//trace("START Here");
	
	//trace(nRow);

//alert(ds_list.SaveXML());
	
	ds_cond2.ClearData();
	ds_cond2.AddRow();
	//ds_cond2.setColumn(0, "GBN", ds_list.GetColumn(nRow,"GBN"));
	ds_cond2.SetColumn(0,"MANDT",ds_master.MANDT);
	ds_cond2.SetColumn(0,"QTNUM",ds_master.QTNUM);
	ds_cond2.SetColumn(0,"QTSER",ds_master.QTSER);
	ds_cond2.SetColumn(0,"VBELN",ds_master.VBELN);
	ds_cond2.setColumn(0, "QTSEQ", ds_rad_list.GetColumn(nRow,"QTSEQ"));
	ds_cond2.setColumn(0, "PRINT_HOGI", ds_rad_list.GetColumn(nRow,"PRINT_HOGI"));	
	ds_cond2.setColumn(0, "SUVSN", ds_rad_list.GetColumn(nRow,"SUVSN"));
	
	//trace(ds_cond2.SaveXML());

	
//alert(ds_cond2.SaveXML());	
	
	tit_clearActionInfo();
	tit_addSearchActionInfo("ps11:PS1120001A_S4", null, true);
	
	tit_callService(
        ""
        , ""
        , "ds_cond=ds_cond2"
        , "ds_ee_hpb=ds_ee_hpb"
        , ""
        , "fn_afterQuery3"
        , ""
        , ""
        , true);
     
                  
}


/********************************************************************************
* 기      능   : 조회 Callback  
********************************************************************************/
function fn_afterQuery3(errCode, errMsg) {
	
	//trace(ds_rad_prh.rowcount);
	//grd_rad_prh.SetCellProp("head",0,"text",ds_rad_prh.rowcount+" 건");
	//gfn_showMsg("CI00002",ds_list2.RowCount()+"");
}

/********************************************************************************
* 기      능   : grid double click 시  하위 그리드 조회 조회 
********************************************************************************/

function grd_rad_list_OnCellDblClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
	//alert("100 :" + ds_rad_list.GetColumn(nRow,"PRINT_HOGI") + ": 100");
	if(trim(ds_rad_list.GetColumn(nRow,"PRINT_HOGI"))=="") {

	}else {
		//alert(ds_rad_list.GetColumn(nRow,"PRINT_HOGI"));
		//trace(nRow);
		fn_query2(nRow);	
		fn_query3(nRow);
	}
	
}

function ds_rad_list_OnRowPosChanged(obj,nOldRow,nRow)
{
	if(trim(ds_rad_list.GetColumn(nRow,"PRINT_HOGI"))=="") {

	}else {
		//alert(ds_rad_list.GetColumn(nRow,"PRINT_HOGI"));
		//trace(nRow);
		if(nRow > -1) {
			fn_query2(nRow);	
			fn_query3(nRow);
		}
	}
}

function btn_rap_cal_OnClick(obj)
{

	// 하나의 정보라도 변경된 정보가 있으면 체크하고 새로운 창을 띄우지 않는다. 
	for(var i=0; i< ds_rad_list.count; i++) {
		if(ds_rad_list.GetColumn(i, "FLAG")!="") {
			gfn_openMsgWin("변경사항이 있습니다. 변경 내용 저장 후 실행해 주십시오.");
			return false;
		}
	 }
	 
	 //alert(ds_rad_list.GetColumn(ds_rad_list.currow, "SUVST"));
	 if(ds_rad_list.GetColumn(ds_rad_list.currow, "SUVST") == "Y") {
			gfn_openMsgWin("수정된 내용이 없습니다. 이미 작성 완료 상태 입니다.", "I");
			return false;
	 }
	
	 if(gfn_openMsgWin("실측등록을 완료 하시겠습니까?", "I","C")) {
		if(ds_rad_list.GetColumn(ds_rad_list.currow, "HRST") == "N" ||  ds_rad_list.GetColumn(ds_rad_list.currow, "HRST") == "T") {
			gfn_openMsgWin("승강로 관련 등록 작업을 완료 해주십시오.", "I");
			return false;
		}

		if(ds_rad_list.GetColumn(ds_rad_list.currow, "MRST") == "N" || ds_rad_list.GetColumn(ds_rad_list.currow, "MRST") == "T") {
			gfn_openMsgWin("기계실 관련 실측등록 작업을 완료 해주십시오.", "I");
			return false;
		}	
		
		if(ds_rad_list.GetColumn(ds_rad_list.currow, "CRST") == "N" || ds_rad_list.GetColumn(ds_rad_list.currow, "CRST") == "T") {
			gfn_openMsgWin("CWT 및 층고 관련 실측등록 작업을 완료 해주십시오.", "I");
			return false;
		}			
		
		if(ds_rad_list.GetColumn(ds_rad_list.currow, "CRST") == "N" || ds_rad_list.GetColumn(ds_rad_list.currow, "CRST") == "T") {
			gfn_openMsgWin("승장부문관련 실측등록 작업을 완료 해주십시오.", "I");
			return false;
		}

		// 검증후 완료 여부 자료 업데이트
		ds_cond2.ClearData();
		ds_cond2.AddRow();
		//trace(grd_list.CurrentRow);
		
		//trace(ds_rad_list.currow);
		ds_cond2.setColumn(0, "QTNUM", ds_rad_list.GetColumn(ds_rad_list.currow, "QTNUM"));
		ds_cond2.setColumn(0, "QTSER", ds_rad_list.GetColumn(ds_rad_list.currow, "QTSER"));
		ds_cond2.setColumn(0, "QTSEQ", ds_rad_list.GetColumn(ds_rad_list.currow, "QTSEQ"));
		ds_cond2.setColumn(0, "VBELN", ds_rad_list.GetColumn(ds_rad_list.currow, "VBELN"));
		ds_cond2.setColumn(0, "HOGI", ds_rad_list.GetColumn(ds_rad_list.currow, "HOGI"));
		ds_cond2.setColumn(0, "SUVSN", ds_rad_list.GetColumn(ds_rad_list.currow, "SUVSN"));
		ds_cond2.setColumn(0, "SUVST", "Y");
		
		//trace(ds_cond2.SaveXML());
		
		//변경 이력 최대 차수 확인 하기 
		
		tit_clearActionInfo();
		tit_addSearchActionInfo("ps11:PS1120001A_S8");
		
		tit_callService(
		""
		, ""
		, "ds_cond2=ds_cond2"
		, "ds_dummy2=ds_dummy2"
		, ""
		, ""
		, true
		, true
		, true);
		
		
		//trace(ds_dummy2.saveXML());
		//최대 이력 차수를 전달
		ds_cond2.setColumn(0, "MAX_HTSER", ds_dummy2.getColumn(0,"MAX_HTSER") );
		
		//master에 등록
		tit_clearActionInfo();
		tit_addSingleActionInfo("ps11:PS1120001A_I3");			
		tit_callService(
			""
			, ""
			, "ds_cond2=ds_cond2"
			, ""
			, ""
			, "fn_masterAfter"
			, true
			, true
			, true
		);
	}
}

function fn_masterAfter() {
	//실측 값 이력 등록
	tit_clearActionInfo();
	tit_addSingleActionInfo("ps11:PS1120001A_I4");			
	tit_callService(
		""
		, ""
		, "ds_cond2=ds_cond2"
		, ""
		, ""
		, "fn_slave1After"
		, true
		, true
		, true
	);	
}

function fn_slave1After() {
	//실측 값 이력 등록
	tit_clearActionInfo();
	tit_addSingleActionInfo("ps11:PS1120001A_I5");			
	tit_callService(
		""
		, ""
		, "ds_cond2=ds_cond2"
		, ""
		, ""
		, "fn_confirmAfter"
		, true
		, true
		, true
	);	
}

function fn_confirmAfter() {
	// 등록 여부를 완료로 전환하는 쿼리 실행 스크립트.
	tit_clearActionInfo();
	if(ds_rad_list.GetColumn(grd_list.CurrentRow, "VBELN")!="") {
		tit_addSingleActionInfo("ps11:PS1120001A_U2");			
	}else {
		tit_addSingleActionInfo("ps11:PS1120001A_U1");			
	}
	tit_callService(
		""
		, ""
		, "ds_cond2=ds_cond2"
		, ""
		, ""
		, ""
		, true
		, true
		, true
	);

    //====================쪽지전송 시작===============================
    ds_rad_trans.ClearData();
    tit_clearActionInfo();
    tit_addSearchActionInfo("ps11:PS1120001A_S9");            
    tit_callService(
      ""
    , ""
    , "ds_cond2=ds_cond2"
    , "ds_rad_trans=ds_rad_trans"
    , ""
    , ""  //"fn_afterQuery"
    , "" //true
    , ""
    , true);    

    //====================쪽지전송 시작===============================
    var arg = "";        
    var param = ""; 
    var lv_mesgdesc = "";
    var msgtitle = "";
    // 견적번호만 있는 경우 강제로 기본 데이터를 생성한다.
    if(ds_rad_trans.GetRowCount() == 0) {
        ds_rad_trans.AddRow();
        ds_rad_trans.SetColumn(0, "GSNAM",  ds_master.GetColumn(0, "GSNAM"));
        ds_rad_trans.SetColumn(0, "MANDT",  ds_master.GetColumn(0, "MANDT"));
        ds_rad_trans.SetColumn(0, "QTNUM",  ds_master.GetColumn(0, "QTNUM"));
        ds_rad_trans.SetColumn(0, "VBELN",  ds_master.GetColumn(0, "VBELN"));
        ds_rad_trans.SetColumn(0, "USER",  "helco"+G_USER_ID+"@hdel.co.kr");
    }

    if(ds_cond2.GetColumn(0, "MAX_HTSER") == "1") {
        msgtitle = ds_rad_trans.GetColumn(0,"MESGTITL") + "실측 등록";
        lv_mesgdesc = ds_rad_trans.GetColumn(0,"VBELN") +' '+ ds_rad_trans.GetColumn(0,"GSNAM") +'현장의 전산 실측치가 등록 되었습니다.';
    } else {
        msgtitle = ds_rad_trans.GetColumn(0,"MESGTITL") + "실측 수정("+ds_cond2.GetColumn(0, "MAX_HTSER")+")";
        lv_mesgdesc = ds_rad_trans.GetColumn(0,"VBELN") +' '+ ds_rad_trans.GetColumn(0,"GSNAM") +'현장의 전산 실측치가 수정 되었습니다.';
    }
    ds_rad_trans.setcolumn(0, "MESGTITL", msgtitle);
    ds_rad_trans.setcolumn(0, "MESGDESC", lv_mesgdesc);

    if(length(ds_rad_trans.GetColumn(0,"KUNNR")) > 0) {
        ds_rad_trans.setcolumn(0, "MESGACCP", substr(ds_rad_trans.GetColumn(0,"KUNNR"),1,7));
        perno = ds_rad_trans.GetColumn(0, "KUNNR_MAIL");
        ds_rad_trans.SetColumn(0, "PERNO",  perno);
    } else {
        // 담당자 미정 시 이현철 책임으로 변경처리 (2020.08.18 수정 요청 - 이현철 책임님 요청)
        ds_rad_trans.setcolumn(0, "MESGACCP", "2017954");
        perno = 'helco2017954@hdel.co.kr';
        ds_rad_trans.SetColumn(0, "PERNO",  perno);
    }
    //====================쪽지전송 끝===============================
    
    fn_trans();
}

/********************************************************************************
* 기      능   : trans(전송)  
********************************************************************************/
function fn_trans() {
	tit_clearActionInfo();	
	tit_addMultiActionInfo("ps12:PS1205001A_I1");			
	tit_callService(
		""
		, ""
		, "ds_trans=ds_rad_trans"
		, ""
		, ""
		, "fn_aftertrans"
		, "" //true
		, ""
		, true);
}

/********************************************************************************
* 기      능   : trans(이메일전송)  
********************************************************************************/
function fn_aftertrans() {
	tit_callService(
		"COMM_ACT"
		, "sendmail"
		, ""
		, ""
		," SEND_USER=" + quote( ds_rad_trans.GetColumn(0,"USER") )
			+ " RECE_USER=" + quote( ds_rad_trans.GetColumn(0,"PERNO") )
			+ " MESGTITL=" + quote( ds_rad_trans.GetColumn(0,"MESGTITL") )
			+ " MESGBODY=" + quote( ds_rad_trans.GetColumn(0,"MESGDESC") )
		, "fn_afterMail"
		, false
		, true);
		
    fn_query();
}

function fn_afterMail(errCode, errMsg) {
	if ( errCode!= 0 ) {		
		//gfn_showMsg("CE00001");
	    gfn_openMsgWin("실측등록이 완료 되었으나 메일전송을 실패 하였습니다.", "E");
	} else {
	    gfn_openMsgWin("실측등록이 완료 되었습니다.", "I");
	}
}

function ds_rad_list_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{
	if (varNewValue != varOldValue) {
	    gfn_changeFlag(obj, strColumnID, nRow, "FLAG");
	}

/*
	if(ds_rad_list.GetColumn(nRow,"FLAG") =="I") {
	} else {
		if(trim(strOldRow) != trim(strNewRow)) {
			ds_rad_list.SetColumn(nRow, "FLAG", "U");
		}else {
			ds_rad_list.SetColumn(nRow, "FLAG", "");
		}
	}
*/	
}

///수정,입력 필수 체크하는 함수
function fn_checkModifyList_rad(){
	if ( !gfn_isChangeDs(ds_rad_list, true, "FLAG") ) {
		return false;
	}

	return true;
}


function fn_existCheck_rad(code1){
	ds_cntCond.SetColumn(0,"CODE1",code1);
	tit_clearActionInfo();
	tit_addSearchActionInfo("ps11:PS1130001A_S4");
		
	tit_callService(
		""
		, ""
		, "ds_cntCond=ds_cntCond"
		, "ds_cnt=ds_cnt"
		, ""
		, ""
		, true
		, true
		, true);
	
}



//마스터  그리드 저장
function fn_save()
{

	var queryi="";
	var queryu="ps11:PS1120001A_I1";
	var queryd="";

	if(VBELN != "") {
		queryi="";
		queryu="ps11:PS1120001A_I2";
		queryd="";
	}

    // 마스터 등록 데이터 생성한다.
    ds_input_list.ClearData();
    var SUVSN;
    var FLAG;
    var nRow = -1;
    var ECWTP;
    var CBRK;
	for(var i=0; i < ds_rad_list.GetRowCount(); i++) {
	    FLAG = ds_rad_list.GetColumn(i, "FLAG");
	    SUVSN = ds_rad_list.GetColumn(i, "SUVSN");
	    ECWTP = ds_rad_list.GetColumn(i, "ECWTP");
	    CBRK = ds_rad_list.GetColumn(i, "CBRK");
	    if(Length(ECWTP) == 0) ECWTP = "";
	    if(Length(CBRK) == 0) CBRK = "";
	    
    	if(FLAG == "U" && Length(SUVSN)>0) {
	        nRow = ds_input_list.AddRow();
		    ds_input_list.SetColumn(nRow, "SUVSN", SUVSN);
		    ds_input_list.SetColumn(nRow, "SUVTYPE", "H");
		    ds_input_list.SetColumn(nRow, "SUVPRH", "ELR_B_ECWTP");
		    ds_input_list.SetColumn(nRow, "SUVPRD", ECWTP);

	        nRow = ds_input_list.AddRow();
		    ds_input_list.SetColumn(nRow, "SUVSN", SUVSN);
		    ds_input_list.SetColumn(nRow, "SUVTYPE", "H");
		    ds_input_list.SetColumn(nRow, "SUVPRH", "ELR_B_CBRK");
		    ds_input_list.SetColumn(nRow, "SUVPRD", CBRK);
    	}
	}

	if(ds_rad_list.GetUpdate()) {

	    //=====================마스터 실측 사양 반영====================
	    if(ds_input_list.GetRowCount()>0) {
			tit_clearActionInfo();
			tit_addMultiActionInfo("ps11:PS1120001A_U3");
			tit_callService(""
						   ,""
						   ,"ds_input_list=ds_input_list"
						   ,""
						   ,""
						   ,""
						   ,true);
	    }

		tit_clearActionInfo();
		tit_addSaveActionInfo(
			  queryi
			, queryu
			, queryd
			, "FLAG"
			);

			//trace(ds_rad_suvprh_list.SaveXML());
			//ds_rad_list.saveXML();
		// 저장 처리 
		tit_callService(
			""
			, ""
			, "ds_list=ds_rad_list:A"
			, ""
			, ""
			, "fn_afterModify_rad"
			, true
			, true
			, true			        
			);
	}
	// 코드값 추가 로직 필요함
	
}


function fn_afterModify_rad(errCode, errMsg){
	//trace("fn_afterModify_rad errCode : " + errCode);
	fn_afterSave(errCode, errMsg);
}


/********************************************************************************
* 기      능   : 저장 Callback  
********************************************************************************/
function fn_afterSave(errCode, errMsg) {
	//trace("erroCode : " + errCode);
	if(errCode != "0") {
		gfn_showAlert("CE00001");
		
	}else {
		gfn_showAlert("CI00003");
		fn_query_code("DATA_DIVS,DATA_ITEM,CD_I_TYPE");
		
		fn_query();
		fn_query2();
		fn_query3();
	}
}

/********************************************************************************
* 기      능   : 액셀  
********************************************************************************/
function fn_excel() {
    if ( ds_rad_list.RowCount() > 0 ) {
        // gfn_exportExcel(grd_rad_list, "리모델링 실측 데이터 요약");
        var fileUrl;
        var serverUrl = G_SERVER_URL + "mipApp/radSurveyC/dwnSuvExcel";
        var rtn;
        var readSize = -1;
        var fileName;
        var qtnum = ds_master.QTNUM;
        var qtser = ds_master.QTSER;
        var prjNum = ds_master.VBELN;
        var day = gfn_formatDate(G_CURR_DATE, "-");
        var param;

        // 파일명 생성
        if(Length(prjNum) > 0) {
            fileName = ds_master.GSNAM + "_"+prjNum+"_"+day;
            param = "SYSID="+G_SYSID+"&MANDT="+G_MANDT+"&PRJNUM="+prjNum;
        } else {
            fileName = ds_master.GSNAM + "_"+qtnum+"_"+qtser+"_"+day;
            param = "SYSID="+G_SYSID+"&MANDT="+G_MANDT+"&QTNUM="+qtnum+"&QTSER="+qtser;
        }
        serverUrl = serverUrl + "?"+param;
        saveDialog.FileName = fileName+".xlsx";
        if(saveDialog.open()) {
            fileUrl = saveDialog.FilePath + "\\" + saveDialog.FileName;
            httpFile.OpenFile(serverUrl, fileUrl, "GET");
            if( rtn < 0 ) {
           		gfn_openMsgWin("서버에서 실측등록 엑셀 다운로드를 실패하였습다.", "E");
                return;
            }
            while(1) {
                readSize = httpFile.ReadFile(10485760);
                if( readSize == 0 || readSize == -1 ) {
                    break;
                }
            }

            httpFile.CloseFile();
            if( readSize < 0 ) {
           		gfn_openMsgWin("서버에서 실측등록 엑셀 다운로드를 실패하였습다.", "E");
                return;
            }
        }
        //trace("serverUrl:"+serverUrl);
	} else {
	    gfn_showAlert("CW00010");
	}	
}

// 값이 NULL이면 true, NULL이 아니면 false
function fn_isNull(str) {
	if(length(trim(str)) < 1) return true;
	return false;
}]]></Script>
</Window>