<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="888" Id="PS1120004A" Left="8" OnLoadCompleted="fn_OnLoadCompleted" OnUnloadCompleted="fn_OnUnloadCompleted" PidAttrib="7" Title="CWT&#32;상세&#32;및&#32;층고&#32;실측등록" Top="8" Ver="1.0" Width="978" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_column_filter">
				<Contents>
					<colinfo id="dataSet" size="256" summ="default" type="STRING"/>
					<colinfo id="column" size="256" summ="default" type="STRING"/>
					<colinfo id="grid" size="256" summ="default" type="STRING"/>
					<record>
						<column>CS</column>
						<dataSet>ds_cs</dataSet>
						<grid>div_pop.grd_cs</grid>
					</record>
					<record>
						<column>CB</column>
						<dataSet>ds_cb</dataSet>
						<grid>div_pop.div_cb.grd_cb</grid>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_column_split">
				<Contents>
					<colinfo id="dataSet" size="256" summ="default" type="STRING"/>
					<colinfo id="column" size="256" summ="default" type="STRING"/>
					<colinfo id="grid" size="256" summ="default" type="STRING"/>
					<record>
						<column>ELR_C_WTTK,ELR_C_WGT,ELR_C_WTQ</column>
						<dataSet>ds_cw</dataSet>
						<grid>div_pop.grd_cw</grid>
					</record>
					<record>
						<column>ELR_C_CWSTP,ELR_C_A,ELR_C_B,ELR_C_F,ELR_C_L,ELR_C_G,ELR_C_H,ELR_C_K,ELR_C_J,ELR_C_D,ELR_C_E,ELR_C_C,ELR_C_REMW</column>
						<dataSet>ds_cf</dataSet>
						<grid>div_pop.grd_cf</grid>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond">
				<Contents>
					<colinfo id="MANDT" size="256" summ="default" type="STRING"/>
					<colinfo id="QTNUM" size="256" summ="default" type="STRING"/>
					<colinfo id="QTSER" size="256" summ="default" type="STRING"/>
					<colinfo id="QTSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="VBELN" size="256" summ="default" type="STRING"/>
					<colinfo id="HOGI" size="256" summ="default" type="STRING"/>
					<colinfo id="SUVSN" size="256" summ="default" type="STRING"/>
					<colinfo id="GTYPE" size="256" summ="default" type="STRING"/>
					<colinfo id="ZUSE" size="256" summ="default" type="STRING"/>
					<colinfo id="TYPE1" size="256" summ="default" type="STRING"/>
					<colinfo id="TYPE2" size="256" summ="default" type="STRING"/>
					<colinfo id="SUVNAM" size="256" summ="default" type="STRING"/>
					<colinfo id="DATADIV" size="256" summ="default" type="STRING"/>
					<colinfo id="ITEMDIV" size="256" summ="default" type="STRING"/>
					<colinfo id="SUVPRH" size="256" summ="default" type="STRING"/>
					<colinfo id="SUVDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="GSNAM" size="256" summ="default" type="STRING"/>
					<colinfo id="NAMET" size="256" summ="default" type="STRING"/>
					<colinfo id="NAME1" size="256" summ="default" type="STRING"/>
					<colinfo id="NOTICE" size="256" summ="default" type="STRING"/>
					<colinfo id="ZKUNNR" size="256" summ="default" type="STRING"/>
					<colinfo id="ECWTP" size="256" summ="default" type="STRING"/>
					<colinfo id="CBRK" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_dummy"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_head">
				<Contents>
					<colinfo id="CRST" size="3" summ="default" type="STRING"/>
					<colinfo id="ECWTP" size="15" summ="default" type="STRING"/>
					<colinfo id="ERST" size="3" summ="default" type="STRING"/>
					<colinfo id="GSNAM" size="150" summ="default" type="STRING"/>
					<colinfo id="GTYPE" size="60" summ="default" type="STRING"/>
					<colinfo id="HOGI" size="72" summ="default" type="STRING"/>
					<colinfo id="HRST" size="3" summ="default" type="STRING"/>
					<colinfo id="MANDT" size="9" summ="default" type="STRING"/>
					<colinfo id="MRST" size="3" summ="default" type="STRING"/>
					<colinfo id="NAME1" size="105" summ="default" type="STRING"/>
					<colinfo id="NAMET" size="60" summ="default" type="STRING"/>
					<colinfo id="NOTICE" size="765" summ="default" type="STRING"/>
					<colinfo id="QTNUM" size="30" summ="default" type="STRING"/>
					<colinfo id="QTSEQ" size="6" summ="default" type="INT"/>
					<colinfo id="QTSER" size="6" summ="default" type="INT"/>
					<colinfo id="STEXT" size="120" summ="default" type="STRING"/>
					<colinfo id="SUVDAT" size="24" summ="default" type="STRING"/>
					<colinfo id="SUVNAM" size="36" summ="default" type="STRING"/>
					<colinfo id="SUVSN" size="30" summ="default" type="STRING"/>
					<colinfo id="SUVST" size="3" summ="default" type="STRING"/>
					<colinfo id="TYPE1" size="30" summ="default" type="STRING"/>
					<colinfo id="TYPE2" size="30" summ="default" type="STRING"/>
					<colinfo id="ZKUNNR" size="120" summ="default" type="STRING"/>
					<colinfo id="ZUSE" size="30" summ="default" type="STRING"/>
					<colinfo id="ZZPJT_ID" size="72" summ="default" type="STRING"/>
					<colinfo id="CBRK" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cwt" OnColumnChanged="ds_cwt_OnColumnChanged">
				<Contents>
					<colinfo id="CALPRD" size="90" summ="default" type="STRING"/>
					<colinfo id="CALYSNO" size="3" summ="default" type="STRING"/>
					<colinfo id="DATADIV" size="15" summ="default" type="STRING"/>
					<colinfo id="DWYSNO" size="3" summ="default" type="STRING"/>
					<colinfo id="FLAG" size="1" summ="default" type="STRING"/>
					<colinfo id="IFNECMSG" size="90" summ="default" type="STRING"/>
					<colinfo id="IFNECST" size="450" summ="default" type="STRING"/>
					<colinfo id="IFNECYSNO" size="3" summ="default" type="STRING"/>
					<colinfo id="INPUTYSNO" size="3" summ="default" type="STRING"/>
					<colinfo id="INTYPE" size="15" summ="default" type="STRING"/>
					<colinfo id="ITEMDIV" size="15" summ="default" type="STRING"/>
					<colinfo id="MANDT" size="9" summ="default" type="STRING"/>
					<colinfo id="MODYPRD" size="90" summ="default" type="STRING"/>
					<colinfo id="MODYYSNO" size="3" summ="default" type="STRING"/>
					<colinfo id="NECYSNO" size="3" summ="default" type="STRING"/>
					<colinfo id="PRH" size="90" summ="default" type="STRING"/>
					<colinfo id="PRHYSNO" size="3" summ="default" type="STRING"/>
					<colinfo id="SUVPRD" size="90" summ="default" type="STRING"/>
					<colinfo id="SUVPRH" size="90" summ="default" type="STRING"/>
					<colinfo id="SUVPRHNAME" size="150" summ="default" type="STRING"/>
					<colinfo id="SUVSN" size="30" summ="default" type="STRING"/>
					<colinfo id="SUVTYPE" size="15" summ="default" type="STRING"/>
					<colinfo id="VIEWORDER" size="6" summ="default" type="INT"/>
					<colinfo id="VIEWYSNO" size="3" summ="default" type="STRING"/>
					<colinfo id="O_SUVPRD" size="256" summ="default" type="STRING"/>
					<colinfo id="CALNAM" size="256" summ="default" type="STRING"/>
					<colinfo id="MODYNAM" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cs" OnColumnChanged="ds_cwt_OnColumnChanged">
				<Contents>
					<colinfo id="CALPRD" size="90" summ="default" type="STRING"/>
					<colinfo id="CALYSNO" size="3" summ="default" type="STRING"/>
					<colinfo id="DATADIV" size="15" summ="default" type="STRING"/>
					<colinfo id="DWYSNO" size="3" summ="default" type="STRING"/>
					<colinfo id="FLAG" size="1" summ="default" type="STRING"/>
					<colinfo id="IFNECMSG" size="90" summ="default" type="STRING"/>
					<colinfo id="IFNECST" size="450" summ="default" type="STRING"/>
					<colinfo id="IFNECYSNO" size="3" summ="default" type="STRING"/>
					<colinfo id="INPUTYSNO" size="3" summ="default" type="STRING"/>
					<colinfo id="INTYPE" size="15" summ="default" type="STRING"/>
					<colinfo id="ITEMDIV" size="15" summ="default" type="STRING"/>
					<colinfo id="MANDT" size="9" summ="default" type="STRING"/>
					<colinfo id="MODYPRD" size="90" summ="default" type="STRING"/>
					<colinfo id="MODYYSNO" size="3" summ="default" type="STRING"/>
					<colinfo id="NECYSNO" size="3" summ="default" type="STRING"/>
					<colinfo id="PRH" size="90" summ="default" type="STRING"/>
					<colinfo id="PRHYSNO" size="3" summ="default" type="STRING"/>
					<colinfo id="SUVPRD" size="90" summ="default" type="STRING"/>
					<colinfo id="SUVPRH" size="90" summ="default" type="STRING"/>
					<colinfo id="SUVPRHNAME" size="150" summ="default" type="STRING"/>
					<colinfo id="SUVSN" size="30" summ="default" type="STRING"/>
					<colinfo id="SUVTYPE" size="15" summ="default" type="STRING"/>
					<colinfo id="VIEWORDER" size="6" summ="default" type="INT"/>
					<colinfo id="VIEWYSNO" size="3" summ="default" type="STRING"/>
					<colinfo id="O_SUVPRD" size="256" summ="default" type="STRING"/>
					<colinfo id="CALNAM" size="256" summ="default" type="STRING"/>
					<colinfo id="MODYNAM" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cw" OnColumnChanged="ds_hostway_OnColumnChanged">
				<Contents>
					<colinfo id="FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="ELR_C_WTTK" size="256" summ="default" type="STRING"/>
					<colinfo id="ELR_C_WGT" size="256" summ="default" type="STRING"/>
					<colinfo id="ELR_C_WTQ" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cf" OnColumnChanged="ds_hostway_OnColumnChanged">
				<Contents>
					<colinfo id="FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="ELR_C_CWSTP" size="256" summ="default" type="STRING"/>
					<colinfo id="ELR_C_A" size="256" summ="default" type="STRING"/>
					<colinfo id="ELR_C_B" size="256" summ="default" type="STRING"/>
					<colinfo id="ELR_C_F" size="256" summ="default" type="STRING"/>
					<colinfo id="ELR_C_L" size="256" summ="default" type="STRING"/>
					<colinfo id="ELR_C_G" size="256" summ="default" type="STRING"/>
					<colinfo id="ELR_C_H" size="256" summ="default" type="STRING"/>
					<colinfo id="ELR_C_K" size="256" summ="default" type="STRING"/>
					<colinfo id="ELR_C_J" size="256" summ="default" type="STRING"/>
					<colinfo id="ELR_C_D" size="256" summ="default" type="STRING"/>
					<colinfo id="ELR_C_E" size="256" summ="default" type="STRING"/>
					<colinfo id="ELR_C_C" size="256" summ="default" type="STRING"/>
					<colinfo id="ELR_C_REMW" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cb" OnColumnChanged="ds_cwt_OnColumnChanged">
				<Contents>
					<colinfo id="CALPRD" size="90" summ="default" type="STRING"/>
					<colinfo id="CALYSNO" size="3" summ="default" type="STRING"/>
					<colinfo id="DATADIV" size="15" summ="default" type="STRING"/>
					<colinfo id="DWYSNO" size="3" summ="default" type="STRING"/>
					<colinfo id="FLAG" size="1" summ="default" type="STRING"/>
					<colinfo id="IFNECMSG" size="90" summ="default" type="STRING"/>
					<colinfo id="IFNECST" size="450" summ="default" type="STRING"/>
					<colinfo id="IFNECYSNO" size="3" summ="default" type="STRING"/>
					<colinfo id="INPUTYSNO" size="3" summ="default" type="STRING"/>
					<colinfo id="INTYPE" size="15" summ="default" type="STRING"/>
					<colinfo id="ITEMDIV" size="15" summ="default" type="STRING"/>
					<colinfo id="MANDT" size="9" summ="default" type="STRING"/>
					<colinfo id="MODYPRD" size="90" summ="default" type="STRING"/>
					<colinfo id="MODYYSNO" size="3" summ="default" type="STRING"/>
					<colinfo id="NECYSNO" size="3" summ="default" type="STRING"/>
					<colinfo id="PRH" size="90" summ="default" type="STRING"/>
					<colinfo id="PRHYSNO" size="3" summ="default" type="STRING"/>
					<colinfo id="SUVPRD" size="90" summ="default" type="STRING"/>
					<colinfo id="SUVPRH" size="90" summ="default" type="STRING"/>
					<colinfo id="SUVPRHNAME" size="150" summ="default" type="STRING"/>
					<colinfo id="SUVSN" size="30" summ="default" type="STRING"/>
					<colinfo id="SUVTYPE" size="15" summ="default" type="STRING"/>
					<colinfo id="VIEWORDER" size="6" summ="default" type="INT"/>
					<colinfo id="VIEWYSNO" size="3" summ="default" type="STRING"/>
					<colinfo id="O_SUVPRD" size="256" summ="default" type="STRING"/>
					<colinfo id="CALNAM" size="256" summ="default" type="STRING"/>
					<colinfo id="MODYNAM" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list">
				<Contents>
					<colinfo id="CALPRD" size="90" summ="default" type="STRING"/>
					<colinfo id="CALYSNO" size="3" summ="default" type="STRING"/>
					<colinfo id="DATADIV" size="15" summ="default" type="STRING"/>
					<colinfo id="DWYSNO" size="3" summ="default" type="STRING"/>
					<colinfo id="FLAG" size="0" summ="default" type="STRING"/>
					<colinfo id="IFNECMSG" size="90" summ="default" type="STRING"/>
					<colinfo id="IFNECST" size="450" summ="default" type="STRING"/>
					<colinfo id="IFNECYSNO" size="3" summ="default" type="STRING"/>
					<colinfo id="INPUTYSNO" size="3" summ="default" type="STRING"/>
					<colinfo id="INTYPE" size="15" summ="default" type="STRING"/>
					<colinfo id="ITEMDIV" size="15" summ="default" type="STRING"/>
					<colinfo id="MANDT" size="9" summ="default" type="STRING"/>
					<colinfo id="MODYPRD" size="90" summ="default" type="STRING"/>
					<colinfo id="MODYYSNO" size="3" summ="default" type="STRING"/>
					<colinfo id="NECYSNO" size="3" summ="default" type="STRING"/>
					<colinfo id="PRH" size="90" summ="default" type="STRING"/>
					<colinfo id="PRHYSNO" size="3" summ="default" type="STRING"/>
					<colinfo id="SUVPRD" size="90" summ="default" type="STRING"/>
					<colinfo id="SUVPRH" size="90" summ="default" type="STRING"/>
					<colinfo id="SUVPRHNAME" size="150" summ="default" type="STRING"/>
					<colinfo id="SUVSN" size="30" summ="default" type="STRING"/>
					<colinfo id="SUVTYPE" size="15" summ="default" type="STRING"/>
					<colinfo id="VIEWORDER" size="6" summ="default" type="INT"/>
					<colinfo id="VIEWYSNO" size="3" summ="default" type="STRING"/>
					<colinfo id="O_SUVPRD" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
		</Datasets>
		<Div Height="36" Id="div_btn" TabOrder="1" ToolTipFont="Default,0" Url="WB01::CommBtnForm.xml" Width="976">
			<Contents></Contents>
		</Div>
		<Div Height="750" Id="div_pop" Left="8" scroll="true" TabOrder="2" Text="Div0" Top="176" Width="958">
			<Contents>
				<Shape BKColor="user12" Bottom="712" Height="712" Id="Shape3" Left="7" LineColor="user13" Right="7" TabOrder="3" Top="0" Type="Rectangle" Width="0"></Shape>
				<Image Border="Flat" BorderColor="user13" Height="552" Id="Image0" ImageID="IMG::ps1120004a_cwt.gif" Left="12" OnClick="div_pop_Image0_OnClick" TabOrder="1" Top="25" Width="448"></Image>
				<Grid AutoEnter="TRUE" AutoFit="TRUE" AutoFitEndLine="Hide" BindDataset="ds_cs" BkColor2="default" BoldHead="true" Border="Flat" Bottom="575" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="546" Id="grd_cs" InputPanel="FALSE" Left="784" LineColor="user20" LineType="ExHORZ" MinWidth="100" Right="937" RowHeight="20" Style="sty_grid" TabOrder="2" TabStop="true" Top="29" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="153">
					<contents>
						<format id="Default">
							<columns>
								<col width="35"/>
								<col width="70"/>
								<col width="50"/>
							</columns>
							<head>
								<cell align="center" col="0" color="user21" display="text" font="굴림,9" text="상태"/>
								<cell align="center" col="1" color="user21" display="text" font="굴림,9" text="층"/>
								<cell col="2" color="user21" display="text" font="굴림,9" text="층고"/>
							</head>
							<body>
								<cell bkimageid='expr:gfn_getFlagBkImageID(getColumn(currow,&#32;&quot;FLAG&quot;))' col="0" display="text"/>
								<cell align="center" bkcolor2="user22" col="1" colid="SUVPRHNAME" display="text"/>
								<cell align="right" bkcolor2="user22" col="2" colid="SUVPRD" display="number" edit="number" limit="5"/>
							</body>
						</format>
					</contents>
				</Grid>
				<Static Color="user6" Font="굴림,9,Bold" Height="20" Id="Static19" Left="26" TabOrder="5" Text="카운터프레임상세" Top="5" VAlign="Middle" Width="254"></Static>
				<Image Height="19" Id="Image6" ImageID="form_bl_title_sub" Left="16" TabOrder="4" Top="4" Width="11"></Image>
				<Image Height="19" Id="Image9" ImageID="form_bl_title_sub" Left="463" TabOrder="6" Top="4" Width="11"></Image>
				<Static Color="user6" Font="굴림,9,Bold" Height="20" Id="Static2" Left="473" TabOrder="7" Text="SUB&#32;WEIGHT&#32;상세" Top="5" VAlign="Middle" Width="222"></Static>
				<Image Border="Flat" BorderColor="user13" Height="232" Id="Image12" ImageID="IMG::ps1120004a_hitchplate1-1.gif" Left="465" TabOrder="8" Top="345" Width="315"></Image>
				<Image Border="Flat" BorderColor="user13" Height="214" Id="Image13" ImageID="IMG::ps1120004a_cwtframe.gif" Left="461" TabOrder="9" Top="27" Width="320"></Image>
				<Image Height="19" Id="Image15" ImageID="form_bl_title_sub" Left="467" TabOrder="10" Top="324" Width="11"></Image>
				<Static Color="user6" Font="굴림,9,Bold" Height="20" Id="Static5" Left="477" TabOrder="11" Text="CWT&#32;FRAME" Top="325" VAlign="Middle" Width="222"></Static>
				<Image Height="19" Id="Image16" ImageID="form_bl_title_sub" Left="779" TabOrder="12" Top="4" Width="11"></Image>
				<Static Color="user6" Font="굴림,9,Bold" Height="20" Id="Static6" Left="788" TabOrder="13" Text="층고" Top="5" VAlign="Middle" Width="95"></Static>
				<Image Height="19" Id="Image18" ImageID="form_bl_title_sub" Left="10" TabOrder="16" Top="584" Width="11"></Image>
				<Static Color="user6" Font="굴림,9,Bold" Height="20" Id="Static8" Left="20" TabOrder="15" Text="카운터프레임상세/CWT&#32;FRAME/HITCH&#32;PLATE&#32;입력/ROPE&#32;END&#32;제거작업" Top="585" VAlign="Middle" Width="486"></Static>
				<Grid AutoEnter="TRUE" AutoFit="TRUE" AutoFitEndLine="Hide" BindDataset="ds_cf" BkColor2="default" BoldHead="true" Border="Flat" Bottom="649" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="41" Id="grd_cf" InputPanel="FALSE" Left="16" LineColor="user20" LineType="ExHORZ" MinWidth="100" OnExpandEdit="div_pop_grd_OnExpandEdit" Right="940" RowHeight="20" Style="sty_grid" TabOrder="14" TabStop="true" Top="608" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="924">
					<contents>
						<format id="Default">
							<columns>
								<col width="35"/>
								<col width="90"/>
								<col width="58"/>
								<col width="58"/>
								<col width="58"/>
								<col width="58"/>
								<col width="58"/>
								<col width="58"/>
								<col width="58"/>
								<col width="58"/>
								<col width="58"/>
								<col width="58"/>
								<col width="58"/>
								<col width="150"/>
							</columns>
							<head>
								<cell align="center" col="0" color="user21" display="text" font="굴림,9" text="상태"/>
								<cell col="1" color="user21" display="text" font="굴림,9" text="CWT&#32;형상타입"/>
								<cell align="center" col="2" color="user21" display="text" font="굴림,9" text="A"/>
								<cell col="3" color="user21" display="text" font="굴림,9" text="B"/>
								<cell col="4" color="user21" display="text" font="굴림,9" text="F"/>
								<cell col="5" color="user21" display="text" font="굴림,9" text="L"/>
								<cell col="6" color="user21" display="text" font="굴림,9" text="G"/>
								<cell col="7" color="user21" display="text" font="굴림,9" text="H"/>
								<cell col="8" color="user21" display="text" font="굴림,9" text="K"/>
								<cell col="9" color="user21" display="text" font="굴림,9" text="J"/>
								<cell col="10" color="user21" display="text" font="굴림,9" text="D"/>
								<cell col="11" color="user21" display="text" font="굴림,9" text="E"/>
								<cell col="12" color="user21" display="text" font="굴림,9" text="C"/>
								<cell col="13" color="user21" display="text" font="굴림,9" text="ROPE&#32;END&#32;제거&#32;가능여부"/>
							</head>
							<body>
								<cell bkimageid='expr:gfn_getFlagBkImageID(getColumn(currow,&#32;&quot;FLAG&quot;))' col="0" display="text"/>
								<cell align="center" col="1" colid="ELR_C_CWSTP" display="text" expandchar="..." expandshow="true"/>
								<cell align="right" bkcolor2="user22" col="2" colid="ELR_C_A" display="number" edit="number" limit="5"/>
								<cell align="right" col="3" colid="ELR_C_B" display="number" edit="number" limit="5"/>
								<cell align="right" col="4" colid="ELR_C_F" display="number" edit="number" limit="5"/>
								<cell align="right" col="5" colid="ELR_C_L" display="number" edit="number" limit="5"/>
								<cell align="right" col="6" colid="ELR_C_G" display="number" edit="number" limit="5"/>
								<cell align="right" col="7" colid="ELR_C_H" display="number" edit="number" limit="5"/>
								<cell align="right" col="8" colid="ELR_C_K" display="number" edit="number" limit="5"/>
								<cell align="right" col="9" colid="ELR_C_J" display="number" edit="number" limit="5"/>
								<cell align="right" col="10" colid="ELR_C_D" display="number" edit="number" limit="5"/>
								<cell align="right" col="11" colid="ELR_C_E" display="number" edit="number" limit="5"/>
								<cell align="right" col="12" colid="ELR_C_C" display="number" edit="number" limit="5"/>
								<cell col="13" colid="ELR_C_REMW" display="checkbox" edit="checkbox"/>
							</body>
						</format>
					</contents>
				</Grid>
				<Grid AutoEnter="TRUE" AutoFit="TRUE" AutoFitEndLine="Hide" BindDataset="ds_cw" BkColor2="default" BoldHead="true" Border="Flat" Bottom="288" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="41" Id="grd_cw" InputPanel="FALSE" Left="470" LineColor="user20" LineType="ExHORZ" MinWidth="100" Right="774" RowHeight="20" Style="sty_grid" TabOrder="17" TabStop="true" Top="247" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="304">
					<contents>
						<format id="Default">
							<columns>
								<col width="41"/>
								<col width="79"/>
								<col width="76"/>
								<col width="81"/>
							</columns>
							<head>
								<cell align="center" col="0" color="user21" display="text" font="굴림,9" text="상태"/>
								<cell col="1" color="user21" display="text" font="굴림,9" text="WT두께"/>
								<cell align="center" col="2" color="user21" display="text" font="굴림,9" text="개당무게"/>
								<cell col="3" color="user21" display="text" font="굴림,9" text="WT수량"/>
							</head>
							<body>
								<cell align="center" bkimageid='expr:gfn_getFlagBkImageID(getColumn(currow,&#32;&quot;FLAG&quot;))' col="0" display="text"/>
								<cell align="right" col="1" colid="ELR_C_WTTK" display="number" edit="number" limit="5"/>
								<cell align="right" bkcolor2="user22" col="2" colid="ELR_C_WGT" display="number" edit="number" limit="5"/>
								<cell align="right" col="3" colid="ELR_C_WTQ" display="number" edit="number" limit="5"/>
							</body>
						</format>
					</contents>
				</Grid>
				<div BKColor="user12" Border="Flat" BorderColor="user13" Height="272" Id="div_cb" Left="8" TabOrder="18" Top="664" Width="928">
					<Contents>
						<Image Border="Flat" BorderColor="user13" Height="234" Id="Image1" ImageID="IMG::ps1120004a_buffer.gif" Left="8" TabOrder="1" Top="28" Width="184"></Image>
						<Grid AutoEnter="TRUE" AutoFitEndLine="Hide" AutoScrollBar="Vert" BindDataset="ds_cb" BkColor2="default" BoldHead="true" Border="Flat" Bottom="262" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="232" Id="grd_cb" InputPanel="FALSE" Left="208" LineColor="user20" LineType="ExHORZ" OnExpandEdit="div_pop_grd_OnExpandEdit" Right="468" RowHeight="20" Style="sty_grid" TabOrder="2" TabStop="true" Top="30" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="260">
							<contents>
								<format id="Default">
									<columns>
										<col width="35"/>
										<col width="140"/>
										<col width="84"/>
									</columns>
									<head>
										<cell align="center" col="0" color="user21" display="text" font="굴림,9" text="상태"/>
										<cell align="center" col="1" color="user21" display="text" font="굴림,9" text="사양"/>
										<cell col="2" color="user21" display="text" font="굴림,9" text="실측값"/>
									</head>
									<body>
										<cell bkimageid='expr:gfn_getFlagBkImageID(getColumn(currow,&#32;&quot;FLAG&quot;))' col="0" display="text"/>
										<cell align="center" bkcolor2="user22" col="1" colid="SUVPRHNAME" display="text"/>
										<cell col="2" colid="SUVPRD" display="expr:decode(INTYPE,&apos;NUM&apos;,&apos;number&apos;,decode(INTYPE,&apos;COMBO&apos;,&apos;combo&apos;,decode(INTYPE,&apos;CHECK&apos;,&apos;checkbox&apos;,&apos;text&apos;)))" edit="expr:decode(INTYPE,&apos;NUM&apos;,&apos;number&apos;,decode(INTYPE,&apos;COMBO&apos;,&apos;combo&apos;,decode(INTYPE,&apos;CHECK&apos;,&apos;checkbox&apos;,&apos;none&apos;)))" expandchar="..." expandshow="expr:decode(INTYPE,&apos;POPCHAR&apos;,true,&apos;POPNUM&apos;,true,false)" limit="5"/>
									</body>
								</format>
							</contents>
						</Grid>
						<Static Color="user6" Font="굴림,9,Bold" Height="20" Id="Static1" Left="208" TabOrder="6" Text="충돌판&#32;상세&#32;치수&#32;입력" Top="2" VAlign="Middle" Width="150"></Static>
						<Image Height="19" Id="Image2" ImageID="form_bl_title_sub" Left="198" TabOrder="5" Top="2" Width="11"></Image>
						<Static Color="user6" Font="굴림,9,Bold" Height="20" Id="Static7" Left="16" TabOrder="4" Text="BUFFER&#32;충돌판" Top="2" VAlign="Middle" Width="158"></Static>
						<Image Height="19" Id="Image17" ImageID="form_bl_title_sub" Left="6" TabOrder="3" Top="2" Width="11"></Image>
					</Contents>
				</div>
			</Contents>
		</Div>
		<Div Height="132" Id="divTop" Left="11" TabOrder="3" Text="Div0" Top="42" Width="952">
			<Contents>
				<Shape BKColor="user12" Bottom="26" Height="26" Id="Shape0" Left="1" LineColor="user13" Right="951" TabOrder="1" Top="0" Type="Rectangle" Width="950"></Shape>
				<Static Align="Right" Height="24" Id="Static0" Left="2" Style="sty_lb_form_basic" TabOrder="5" Text="견적번호&#32;" Top="1" VAlign="Middle" Width="95"></Static>
				<Edit BindDataset="ds_head" Border="Flat" Column="QTNUM" Enable="FALSE" Height="20" Id="Edit1" Left="99" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="3" Top="3" Width="135"></Edit>
				<Static Align="Right" Height="24" Id="Static4" Left="237" Style="sty_lb_form_basic" TabOrder="4" Text="공사명&#32;" Top="1" VAlign="Middle" Width="94"></Static>
				<Edit BindDataset="ds_head" Border="Flat" Column="GSNAM" Enable="FALSE" Height="20" Id="Edit3" Left="333" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="2" Top="3" Width="354"></Edit>
				<Static Align="Right" Height="24" Id="Static2" Left="690" Style="sty_lb_form_basic" TabOrder="4" Text="수주번호&#32;" Top="1" VAlign="Middle" Width="94"></Static>
				<Edit BindDataset="ds_head" Border="Flat" Column="ZZPJT_ID" Enable="FALSE" Height="20" Id="Edit2" Left="786" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="3" Top="3" Width="162"></Edit>
				<Shape BKColor="user12" Bottom="51" Height="26" Id="Shape2" Left="1" LineColor="user13" Right="951" TabOrder="8" Top="25" Type="Rectangle" Width="950"></Shape>
				<Shape BKColor="user12" Bottom="76" Height="26" Id="Shape1" Left="1" LineColor="user13" Right="951" TabOrder="9" Top="50" Type="Rectangle" Width="950"></Shape>
				<Shape BKColor="user12" Bottom="129" Height="54" Id="Shape3" Left="1" LineColor="user13" Right="951" TabOrder="10" Top="75" Type="Rectangle" Width="950"></Shape>
				<Static Align="Right" Height="24" Id="Static5" Left="2" Style="sty_lb_form_basic" TabOrder="27" Text="실측자&#32;" Top="26" VAlign="Middle" Width="95"></Static>
				<Static Align="Right" Height="24" Id="Static9" Left="2" Style="sty_lb_form_basic" TabOrder="28" Text="호기&#32;" Top="50" VAlign="Middle" Width="95"></Static>
				<Edit BindDataset="ds_head" Border="Flat" Column="HOGI" Enable="FALSE" Height="20" Id="Edit11" Left="99" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="26" Top="53" Width="104"></Edit>
				<Edit BindDataset="ds_head" Border="Flat" Column="SUVNAM" Enable="FALSE" Height="20" Id="Edit5" Left="99" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="11" Top="28" Width="135"></Edit>
				<Static Align="Right" Height="24" Id="Static11" Left="237" Style="sty_lb_form_basic" TabOrder="12" Text="PM&#32;" Top="26" VAlign="Middle" Width="94"></Static>
				<Static Align="Right" Height="24" Id="Static6" Left="205" Style="sty_lb_form_basic" TabOrder="17" Text="기종&#32;" Top="51" VAlign="Middle" Width="80"></Static>
				<Edit BindDataset="ds_head" Border="Flat" Column="GTYPE" Enable="FALSE" Height="20" Id="Edit9" Left="286" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="25" Top="53" Width="101"></Edit>
				<Edit BindDataset="ds_head" Border="Flat" Column="NAMET" Enable="FALSE" Height="20" Id="Edit6" Left="333" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="24" Top="28" Width="120"></Edit>
				<Static Align="Right" Height="24" Id="Static7" Left="390" Style="sty_lb_form_basic" TabOrder="19" Text="용도&#32;" Top="51" VAlign="Middle" Width="80"></Static>
				<Static Align="Right" Height="24" Id="Static1" Left="456" Style="sty_lb_form_basic" TabOrder="14" Text="영업담당&#32;" Top="26" VAlign="Middle" Width="94"></Static>
				<Edit BindDataset="ds_head" Border="Flat" Column="ZUSE" Enable="FALSE" Height="20" Id="Edit7" Left="472" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="18" Top="53" Width="120"></Edit>
				<Edit BindDataset="ds_head" Border="Flat" Column="ZKUNNR" Enable="FALSE" Height="20" Id="Edit0" Left="552" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="13" Top="28" Width="135"></Edit>
				<Static Align="Right" Height="24" Id="Static8" Left="594" Style="sty_lb_form_basic" TabOrder="21" Text="인승&#32;" Top="51" VAlign="Middle" Width="80"></Static>
				<Edit BindDataset="ds_head" Border="Flat" Column="TYPE1" Enable="FALSE" Height="20" Id="Edit8" Left="675" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="20" Top="53" Width="88"></Edit>
				<Static Align="Right" Height="24" Id="Static3" Left="690" Style="sty_lb_form_basic" TabOrder="16" Text="기술영업담당&#32;" Top="26" VAlign="Middle" Width="94"></Static>
				<Static Align="Right" Height="24" Id="Static10" Left="765" Style="sty_lb_form_basic" TabOrder="23" Text="속도&#32;" Top="51" VAlign="Middle" Width="80"></Static>
				<Edit BindDataset="ds_head" Border="Flat" Column="TYPE2" Enable="FALSE" Height="20" Id="Edit10" Left="847" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="22" Top="53" Width="101"></Edit>
				<Edit BindDataset="ds_head" Border="Flat" Column="NAME1" Enable="FALSE" Height="20" Id="Edit4" Left="786" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="15" Top="28" Width="162"></Edit>
				<Static Align="Right" Height="52" Id="Static12" Left="2" Style="sty_lb_form_basic" TabOrder="30" Text="특이사항&#32;&#10;모든&#32;보고서&#32;공용&#32;&#32;" Top="76" VAlign="Middle" Width="95"></Static>
				<TextArea BindDataset="ds_head" Border="Flat" Column="NOTICE" Height="48" Id="TextArea00" Left="99" MaxLength="100" Style="sty_ipt_form" TabOrder="29" Top="78" VScroll="TRUE" Width="849"></TextArea>
			</Contents>
		</Div>
		<Static Color="user6" Font="굴림,9,Bold" Height="20" Id="Static1" Left="224" TabOrder="4" Text="충돌판&#32;상세&#32;치수&#32;입력" Top="688" VAlign="Middle" Width="222"></Static>
		<Image Height="19" Id="Image2" ImageID="form_bl_title_sub" Left="214" TabOrder="5" Top="686" Width="11"></Image>
		<Static Color="user6" Font="굴림,9,Bold" Height="20" Id="Static7" Left="32" TabOrder="6" Text="BUFFER&#32;충돌판" Top="688" VAlign="Middle" Width="222"></Static>
		<Image Height="19" Id="Image17" ImageID="form_bl_title_sub" Left="22" TabOrder="7" Top="686" Width="11"></Image>
	</Form>
	<Script><![CDATA[﻿﻿﻿﻿﻿﻿﻿﻿/*
 ******************************************************************************************
 * 기      능   : CWT 상세 및 층고 실측등록
 * 작  성  자   :
 * 작성  일자   :
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
#include "LIB::commons.js";	// 공통 스크립트
#include "LIB::utility.js";	// 다중 선택
//=========================================================================================
// [ PART 1 ]
// Form에서 사용될 전역변수를 선언
// FORM에서 사용되는 전역변수는 대문자로 작성하며, F_XXX 의 형태를 갖도록 한다.
//=========================================================================================
var F_TITLE = "CWT 상세 및 층고 실측등록";
var saveStat = "";
//=========================================================================================
// [ PART 2 ]
// Form Loading / Unloading 시 작업 정의
//=========================================================================================
function fn_OnLoadCompleted(obj) {
	div_btn.fn_loadUseBtn("30,900", F_TITLE, "", "");
    fn_resize();
	gfn_initForm();

	
	gfn_showMsg("");
	//fn_query_code("ELR_M_MBSP,ELR_M_CHSP,ELR_M_SBSP,ELR_M_MBTP"); // 콤보값 조회
	fn_query();
}

/********************************************************************************
* 기      능   : 공통코드가 조회된 후의 Callback 함수
********************************************************************************/
function fn_completeInit(sCode, sDsObj, sCodeType) {
}

/********************************************************************************
* 기      능   : form UnloadCompleted
********************************************************************************/
function fn_OnUnloadCompleted(obj) {
	return gfn_isFormUnload(obj);
}

function fn_resize() {
	this.onsize = "";
	window.top    = GetPlatformInfo("WorkArea","top");
	window.left   = GetPlatformInfo("WorkArea","left");
	window.width  = GetPlatformInfo("WorkArea","width");
	window.height = GetPlatformInfo("WorkArea","height");
}

/********************************************************************************
* 기      능   : 조회 
********************************************************************************/
function fn_query() {

	var pr_Hogi   = HOGI;
	var pr_Suvnam = SUVNAM;
	
	ds_cond.ClearData();
	ds_cond.AppendRow();
	ds_cond.SetColumn(0, "QTNUM",  QTNUM);  // 견적번호
	ds_cond.SetColumn(0, "QTSEQ",  QTSEQ);  // 일련번호
	ds_cond.SetColumn(0, "VBELN",  VBELN);  // 프로젝트번호 N18710
	ds_cond.SetColumn(0, "HOGI",   HOGI);   // 호기
	ds_cond.SetColumn(0, "GTYPE",  GTYPE);  // 기종
	ds_cond.SetColumn(0, "ZUSE",   ZUSE);   // 용도
	ds_cond.SetColumn(0, "TYPE1",  TYPE1);  // 인승
	ds_cond.SetColumn(0, "TYPE2",  TYPE2);  // 속도
	ds_cond.SetColumn(0, "GSNAM",  GSNAM);  // 공사명
	ds_cond.SetColumn(0, "ZKUNNR", ZKUNNR); // 영업담당
	ds_cond.SetColumn(0, "NAME1",  NAME1);  // 기술영업담당
	ds_cond.SetColumn(0, "NAMET",  NAMET);  // PM
	ds_cond.SetColumn(0, "QTSER",  QTSER);  // 견적차수
	ds_cond.SetColumn(0, "ECWTP",  ECWTP);  // CWT위치 ECWTP
	ds_cond.SetColumn(0, "CBRK",   CBRK);   // 공용브라켓 CBRK
	ds_cond.SetColumn(0, "SUVSN",  SUVSN);  // 실측고유번호 0000000001
	ds_cond.SetColumn(0, "SUVDAT", SUVDAT); // 실측일자
	ds_cond.SetColumn(0, "SUVNAM", SUVNAM); // 실측자
	
	ds_cond.SetColumn(0, "DATADIV", 'ELR'); // 데이터구분
	ds_cond.SetColumn(0, "ITEMDIV", 'CF');  // 항목구분
	
    ds_head.ClearData();
    ds_cwt.ClearData();

	tit_clearActionInfo();
	tit_addSearchActionInfo("ps11:PS1120002A_S1"); // 헤더 조회		                         	
	tit_addSearchActionInfo("ps11:PS1120002A_S2"); // 평면도 실측 조회
	//tit_addSearchActionInfo("ps11:PS1120002A_S3"); // 승장실 상세 조회
	
	 tit_callService(""
                    ,""
                    ,"ds_cond=ds_cond"
                    ,"ds_head=ds_head ds_cwt=ds_hostway_survey"
                    ,""
                    ,"fn_afterQuery"
                    ,""
                    ,""
                    ,true);
}

/********************************************************************************
* 기      능   : 조회 Callback  
********************************************************************************/
function fn_afterQuery(errCode, errMsg) {
	column_split();
	ds_filter_copy("==","||");
}

// 데이터셋 필터링 후 복사
function ds_filter_copy(sign, symbol) {
	var col = "ITEMDIV";
	var cnt = ds_column_filter.GetRowCount();
	for(var x = 0; x < cnt; x++) {
		var ds = object(ds_column_filter.GetColumn(x, "dataSet"));
		var arr = split(ds_column_filter.GetColumn(x, "column"), ",");
		var i = 0;
		var filter = "";
		while(i < arr.length()) {
			if(i == 0) {
				filter = col+sign+quote(arr[i]);
			}else {
				filter += symbol+col+sign+quote(arr[i]);
			}
			i++;
		}
		
		ds_cwt.Filter(filter);
		ds.CopyF(ds_cwt);	
		ds_cwt.UnFilter();
	}
}

// 열을 횡으로 변환
function column_split() {
	var cnt = ds_column_split.GetRowCount();
	for(var x = 0; x < cnt; x++) {
		var ds = object(ds_column_split.GetColumn(x, "dataSet"));
		ds.clearData();
		var row  = ds.AppendRow();
		var arr = split(ds_column_split.GetColumn(x, "column"), ",");
		var i = 0;
		while(i < arr.length()) {
			var fRow = ds_cwt.FindRow("SUVPRH", arr[i]);
			var data = ds_cwt.GetColumn(fRow, "SUVPRD");
			ds.SetColumn(row, arr[i], data);
			i++;
		}
	}
}
//=========================================================================================
// [ PART 3 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,form닫기)
//=========================================================================================
/********************************************************************************
* 기      능   : 닫기  
********************************************************************************/
function fn_close() {
    this.Close();
}

// 값이 변경됐을 경우 표시
function ds_cwt_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex) {
	if(strColumnID == "SUVPRD") {
		if(trim(obj.GetColumn(nRow, "O_SUVPRD")) != trim(varNewValue)) {
			obj.SetColumn(nRow, "FLAG", "U");
		}else {
			obj.SetColumn(nRow, "FLAG", "N");
		}
	}
}

// 실측사양 코드값 조회
function fn_query_code(code) {
	var arr = split(code, ",");
	for(var i = 0; i < arr.length(); i++) {
		ds_cond.ClearData();
		ds_cond.AppendRow();
		ds_cond.SetColumn(0, "SUVPRH", arr[i]);
		
		tit_clearActionInfo();
		tit_addSearchActionInfo("ps11:PS1120002A_S3"); // 헤더 조회
		
        tit_callService(""
                       ,""
                       ,"ds_cond=ds_cond"
                       ,"ds_dummy=ds_dummy"
                       ,""
                       ,"fn_afterQuery_code"
                       ,""
                       ,""
                       ,true);
    }
}

/********************************************************************************
* 기      능   : 조회 Callback  
********************************************************************************/
function fn_afterQuery_code(errCode, errMsg) {
	object("ds_"+ds_cond.GetColumn(0, "SUVPRH")).copy(ds_dummy);
}

// 데이터가 변경될 경우 즉시 메인데이터셋에 반영한다.
function ds_hostway_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex) {
	var fRow = ds_cwt.FindRow("SUVPRH", strColumnID);
	ds_cwt.SetColumn(fRow, "SUVPRD", trim(varNewValue));

	var arr;
	var i = 0;
	for(i = 0; i < ds_column_split.GetRowCount(); i++) {
		var ds  = ds_column_split.GetColumn(i, "dataSet");
		var col = ds_column_split.GetColumn(i, "column");
		if(obj.id == ds) arr = split(col, ",");		
	}
	
	i = 0;
	var chg = "N";
	while(i < arr.length()) {
		    fRow  = ds_cwt.FindRow("SUVPRH", arr[i]);
		var data  = trim(ds_cwt.GetColumn(fRow, "SUVPRD"));
		var oData = trim(ds_cwt.GetColumn(fRow, "O_SUVPRD"));

		if(data <> oData) {
			chg = "Y";
		}
		i++;
	}

	if(chg == "Y") {
		obj.SetColumn(nRow, "FLAG", "U");
	}else {
		obj.SetColumn(nRow, "FLAG", "");
	}
}

// cwt표준브리킷 선택
function div_pop_Checkbox_OnClick(obj,strValue) {
	var value = decode(obj.id, "Checkbox0", decode(strValue, "1", "1", "0"), "Checkbox1", decode(strValue, "1", "0", "1"));
	var obj   = decode(obj.id, "Checkbox0", "div_pop.div03.Checkbox1", "Checkbox1", "div_pop.div03.Checkbox0");
	ds_cwt04.SetColumn(0, "ELR_M_MBLD", value);
	object(obj).value = decode(strValue, "1", "0", "1");
}

/********************************************************************************
* 기      능   : 저장버튼 누르면 실행
********************************************************************************/
function fn_save() {
	if(!fn_preSave()) return; // 저장 전 체크
	
	if(!gfn_showConfirm("CI10003")) return; // 저장하시겠습니까?
	
	var SUVSN = ds_head.GetColumn(0, "SUVSN");
	if(length(trim(SUVSN)) < 1) {
		saveStat = "P"; // 조회 후 메세지 나오지 않게
		tit_clearActionInfo();
		tit_addSearchActionInfo("ps11:PS1120002A_S4"); // 실측고유번호 조회
		
		 tit_callService(""
						,""
						,"ds_cond=ds_cond"
						,"ds_dummy=ds_dummy"
						,""
						,"fn_afterSave"
						,""
						,""
						,true);
						
		ds_head.SetColumn(0, "SUVSN", ds_Dummy.GetColumn(0, "SUVSN"));
		//alert("SUVSN >> "+ds_head.GetColumn(0, "SUVSN"));
	}
	ds_head.SetColumn(0, "CRST",  "Y"); // CWT및층고등록상태 Y:작성완료

	saveStat = "S";
	// 신규, 수정된 실측값만 복사해 저장
	ds_list.ClearData();
	ds_cwt.Filter("FLAG='U'");
	ds_list.copyF(ds_cwt);

	// 수정된 데이터만 복사
	for(var i = 0; i < ds_cs.GetRowCount(); i++) {
		if(ds_cs.GetColumn(i, "FLAG") == "U") {
			var nRow = ds_list.AppendRow();
			ds_list.CopyRow(nRow, ds_cs, i);
		}
	}
	
	// 수정된 데이터만 복사
	for(var i = 0; i < ds_cb.GetRowCount(); i++) {
		if(ds_cb.GetColumn(i, "FLAG") == "U") {
			var nRow = ds_list.AppendRow();
			ds_list.CopyRow(nRow, ds_cb, i);
		}
	}
	
	// CWT위치 추가
	var nRow = ds_list.AppendRow();
	ds_list.CopyRow(nRow, ds_cwt, 0);
	ds_list.SetColumn(nRow, "SUVPRH", "ELR_B_ECWTP");
	ds_list.SetColumn(nRow, "SUVPRD", ds_head.GetColumn(0, "ECWTP"));
	
	// 공용브라켓 추가
	nRow = ds_list.AppendRow();
	ds_list.CopyRow(nRow, ds_cwt, 0);
	ds_list.SetColumn(nRow, "SUVPRH", "ELR_B_CBRK");
	ds_list.SetColumn(nRow, "SUVPRD", ds_head.GetColumn(0, "CBRK"));
	
	for(var i = 0; i < ds_list.GetRowCount(); i++) {
		ds_list.SetColumn(i, "SUVSN", ds_head.GetColumn(0, "SUVSN"));
		var inType = ds_list.GetColumn(i, "INTYPE");
		var suvPrd = ds_list.GetColumn(i, "SUVPRD");
		
		if(inType == "CHECK") {
			ds_list.SetColumn(i, "SUVPRD",  decode(suvPrd, "1", "Y", "0", "N"));
			ds_list.SetColumn(i, "MODYPRD", decode(suvPrd, "1", "Y", "0", "N"));
		}else {
			ds_list.SetColumn(i, "MODYPRD", suvPrd); // 실측사양값 = 보정사양값
		}
		ds_list.SetColumn(i, "SUVTYPE", "C");    // 실측타입 : 승강장
	}
	
	tit_clearActionInfo();
	var ZZPJT_ID = ds_head.GetColumn(0, "ZZPJT_ID");
	// 수주번호 유무에 따른 분기
	if(length(trim(ZZPJT_ID)) < 1) {
		tit_addSingleActionInfo("ps11:PS1120002A_I1"); // 견적실측 등록
	}else {
		tit_addSingleActionInfo("ps11:PS1120002A_I2"); // 수주실측 등록
	}

	// 수정된 실측치가 없으면 호출하지 않음
	if(ds_list.GetRowCount() > 0) {
		tit_addMultiActionInfo("ps11:PS1120002A_I3"); // 리모델링실측치 등록 tit_addMultiActionInfo
	}
	
	tit_callService(""
				   ,""
				   ,"ds_head=ds_head ds_list=ds_list"
				   ,""
				   ,""
				   ,"fn_afterSave"
				   ,true);
}

// 저장 전 실측치 필수체크
function fn_preSave() {
	var wds = ds_column_filter;
	for(var i = 0; i < wds.GetRowCount(); i++) {
		var grd = wds.GetColumn(i, "grid");
		var ds  = wds.GetColumn(i, "dataSet");
		
		if(!required_check01(object(ds), grd)) return false;
	}
	
	wds = ds_column_split;
	for(var i = 0; i < wds.GetRowCount(); i++) {
		var grd = wds.GetColumn(i, "grid");
		var col = wds.GetColumn(i, "column");
		
		if(!required_check02(grd, split(col, ","))) return false;
	}
	
	return true;
}

// 그리드 필수체크1
function required_check01(ds, grd) {
	var i = 0;
	var required;
	var name;
	var value;
	var sGrd = object(grd);
	while(i < ds.GetRowCount()) {
		required = ds.GetColumn(i, "NECYSNO");
		name     = ds.GetColumn(i, "SUVPRHNAME");
		value    = ds.GetColumn(i, "SUVPRD");

		if(required == "Y" && length(trim(value)) < 1) {
			gfn_showAlert(name+" 는 필수값 입니다.");
			ds.row = i;
			sGrd.SetCellPos(2);
			sGrd.SetFocus();
			return false;
		}
		i++;
	}
	
	return true;
}

// 그리드 필수체크2
function required_check02(grd, arr) {
	var i = 0;
	var required;
	var name;
	var value;
	var suvprh;
	var sGrd = object(grd);
	while(i < arr.length()) {
		var fRow = ds_cwt.FindRow("SUVPRH", arr[i]);		
		required = ds_cwt.GetColumn(fRow, "NECYSNO");
		name     = ds_cwt.GetColumn(fRow, "SUVPRHNAME");
		suvprh   = ds_cwt.GetColumn(fRow, "SUVPRH");
		value    = ds_cwt.GetColumn(fRow, "SUVPRD");

		if(required == "Y" && length(trim(value)) < 1) {
			gfn_showAlert(name+" 는 필수값 입니다.");
			
			for(var y = 0; y < sGrd.GetColCount(); y++) {
				var colid = sGrd.GetCellProp('body', y, 'colid');

				if(colid == suvprh) {
					sGrd.SetCellPos(y);
				}
			}
			sGrd.SetFocus();
			return false;
		}
		i++;
	}
	return true;
}
/********************************************************************************
* 기      능   : 저장 Callback  
********************************************************************************/
function fn_afterSave(errCode, errMsg) {

	if(saveStat == "P") return;

	if(errCode != "0") {
		gfn_showAlert("CE00001");
		
	}else {
		gfn_showAlert("CI00003");
		fn_query();
	}
}
// 팝업호출
function div_pop_grd_OnExpandEdit(obj,nRow,nCell,strVal,nPivotIndex) {
	var ds       = object(obj.bindDataSet);
	var sel      = "";
	var selValue = "";
	var selTitle = "";
	
	if(obj.id == "grd_cf") {
		sel      = "ELR_C_CWSTP";
		selValue = ds.getColumn(0, "ELR_C_CWSTP");
		selTitle = "기존 CWT 세가지 형상";
	}else if(obj.id == "grd_cb") {
		sel      = ds.getColumn(nRow, "SUVPRH");
		selValue = ds.getColumn(nRow, "SUVPRD");
		selTitle = ds.getColumn(nRow, "SUVPRHNAME");
	}
	
	var arg = "pr_SUVPRH="+quote(sel)+" pr_SUVPRHNAME="+quote(selTitle)+" pr_SUVPRD="+quote(selValue);

	var url = "";
	if(sel == "ELR_C_CWSTP") url = "PS11::PS1120004B.xml";  // 기존 CWT 세가지 형상
	if(sel == "ELR_C_VSP")   url = "PS11::PS1120004C.xml";  // 볼트규격
	
	var rtn = gfn_openPopupUrl(url, true, arg);
	
	if(length(trim(rtn)) > 0) {
		if(obj.id == "grd_cf") {
			ds.SetColumn(0, "ELR_C_CWSTP", rtn);
		}else if(obj.id == "grd_cb") {
			ds.SetColumn(nRow, "SUVPRD", rtn);
		}
	}
}]]></Script>
</Window>