<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="562" Id="PS1107001B" Left="8" OnLoadCompleted="fn_OnLoadCompleted" OnUnloadCompleted="fn_OnUnloadCompleted" PidAttrib="7" Title="리모델링&#32;실측확인" Top="8" Ver="1.0" Width="978" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_error"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_master">
				<Contents>
					<column id="GSNAM" type="STRING"></column>
					<column id="MANDT" type="STRING"></column>
					<column id="NAME1" type="STRING"></column>
					<column id="NAMET" type="STRING"></column>
					<column id="PM" type="STRING"></column>
					<column id="PSPID" type="STRING"></column>
					<column id="QTNUM" type="STRING"></column>
					<column id="QTSEQ" type="STRING"></column>
					<column id="QTSER" type="STRING"></column>
					<column id="USER_ID" type="STRING"></column>
					<column id="VBELN" type="STRING"></column>
					<column id="ZKUNNR" type="STRING"></column>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond_code">
				<Contents>
					<colinfo id="MANDT" size="256" summ="default" type="STRING"/>
					<colinfo id="SUVPRH" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_dummy">
				<Contents>
					<colinfo id="SUVPRH" size="256" summ="default" type="STRING"/>
					<colinfo id="MANDT" size="256" summ="default" type="STRING"/>
					<colinfo id="SUVPRHNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="SUVPRD" size="256" summ="default" type="STRING"/>
					<colinfo id="SUVPRDNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="VIEWORDER" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ELR_B_ECWTP">
				<Contents>
					<colinfo id="SUVPRH" size="256" summ="default" type="STRING"/>
					<colinfo id="MANDT" size="256" summ="default" type="STRING"/>
					<colinfo id="SUVPRHNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="SUVPRD" size="256" summ="default" type="STRING"/>
					<colinfo id="SUVPRDNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="VIEWORDER" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ELR_B_CBRK">
				<Contents>
					<colinfo id="SUVPRH" size="256" summ="default" type="STRING"/>
					<colinfo id="MANDT" size="256" summ="default" type="STRING"/>
					<colinfo id="SUVPRHNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="SUVPRD" size="256" summ="default" type="STRING"/>
					<colinfo id="SUVPRDNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="VIEWORDER" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_CD_R_STAT">
				<Contents>
					<colinfo id="SUVPRH" size="256" summ="default" type="STRING"/>
					<colinfo id="MANDT" size="256" summ="default" type="STRING"/>
					<colinfo id="SUVPRHNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="SUVPRD" size="256" summ="default" type="STRING"/>
					<colinfo id="SUVPRDNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="VIEWORDER" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_CD_S_STAT">
				<Contents>
					<colinfo id="SUVPRH" size="256" summ="default" type="STRING"/>
					<colinfo id="MANDT" size="256" summ="default" type="STRING"/>
					<colinfo id="SUVPRHNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="SUVPRD" size="256" summ="default" type="STRING"/>
					<colinfo id="SUVPRDNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="VIEWORDER" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_CD_R_TYPE">
				<Contents>
					<colinfo id="SUVPRH" size="256" summ="default" type="STRING"/>
					<colinfo id="MANDT" size="256" summ="default" type="STRING"/>
					<colinfo id="SUVPRHNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="SUVPRD" size="256" summ="default" type="STRING"/>
					<colinfo id="SUVPRDNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="VIEWORDER" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ELR_E_HLLC">
				<Contents>
					<colinfo id="SUVPRD" size="90" summ="default" type="STRING"/>
					<colinfo id="SUVPRDNAME" size="150" summ="default" type="STRING"/>
					<colinfo id="SUVPRH" size="90" summ="default" type="STRING"/>
					<colinfo id="VIEWORDER" size="6" summ="default" type="INT"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ELR_E_IDTP">
				<Contents>
					<colinfo id="SUVPRD" size="90" summ="default" type="STRING"/>
					<colinfo id="SUVPRDNAME" size="150" summ="default" type="STRING"/>
					<colinfo id="SUVPRH" size="90" summ="default" type="STRING"/>
					<colinfo id="VIEWORDER" size="6" summ="default" type="INT"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ELR_E_FSLC">
				<Contents>
					<colinfo id="SUVPRD" size="90" summ="default" type="STRING"/>
					<colinfo id="SUVPRDNAME" size="150" summ="default" type="STRING"/>
					<colinfo id="SUVPRH" size="90" summ="default" type="STRING"/>
					<colinfo id="VIEWORDER" size="6" summ="default" type="INT"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond">
				<Contents>
					<colinfo id="QTNUM" size="256" summ="default" type="STRING"/>
					<colinfo id="QTSER" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
					<colinfo id="VBELN" size="256" summ="default" type="STRING"/>
					<colinfo id="MANDT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_rad_list" OnColumnChanged="ds_rad_list_OnColumnChanged" OnRowPosChanged="ds_rad_list_OnRowPosChanged">
				<Contents>
					<colinfo id="FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="QTSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="ECWTP" size="256" summ="default" type="STRING"/>
					<colinfo id="CBRK" size="256" summ="default" type="STRING"/>
					<colinfo id="CRST" size="256" summ="default" type="STRING"/>
					<colinfo id="ERST" size="256" summ="default" type="STRING"/>
					<colinfo id="HRST" size="256" summ="default" type="STRING"/>
					<colinfo id="MRST" size="256" summ="default" type="STRING"/>
					<colinfo id="NOTICE" size="256" summ="default" type="STRING"/>
					<colinfo id="SUVST" size="256" summ="default" type="STRING"/>
					<colinfo id="GTYPE" size="256" summ="default" type="STRING"/>
					<colinfo id="ZUSE" size="256" summ="default" type="STRING"/>
					<colinfo id="TYPE1" size="256" summ="default" type="STRING"/>
					<colinfo id="TYPE2" size="256" summ="default" type="STRING"/>
					<colinfo id="SUVDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="SUVSN" size="256" summ="default" type="STRING"/>
					<colinfo id="HOGI" size="256" summ="default" type="STRING"/>
					<colinfo id="BRNDCD" size="256" summ="default" type="STRING"/>
					<colinfo id="SUVNAM" size="256" summ="default" type="STRING"/>
					<colinfo id="PRINT_HOGI" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="SAPSEQ" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond2">
				<Contents>
					<colinfo id="QTNUM" size="256" summ="default" type="STRING"/>
					<colinfo id="QTSER" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
					<colinfo id="VBELN" size="256" summ="default" type="STRING"/>
					<colinfo id="MANDT" size="256" summ="default" type="STRING"/>
					<colinfo id="QTSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="SUVSN" size="256" summ="default" type="STRING"/>
					<colinfo id="SUVST" size="256" summ="default" type="STRING"/>
					<colinfo id="PRINT_HOGI" size="256" summ="default" type="STRING"/>
					<colinfo id="HOGI" size="256" summ="default" type="STRING"/>
					<colinfo id="SAPSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ee_hpb">
				<Contents>
					<colinfo id="FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="MANDT" size="256" summ="default" type="STRING"/>
					<colinfo id="SUVSN" size="256" summ="default" type="STRING"/>
					<colinfo id="INORDER" size="256" summ="default" type="STRING"/>
					<colinfo id="APPLYFLOOR" size="256" summ="default" type="STRING"/>
					<colinfo id="ELR_E_IDTP" size="256" summ="default" type="STRING"/>
					<colinfo id="ELR_E_HLLC" size="256" summ="default" type="STRING"/>
					<colinfo id="ELR_E_FSLC" size="256" summ="default" type="STRING"/>
					<colinfo id="ELR_E_A" size="256" summ="default" type="STRING"/>
					<colinfo id="ELR_E_B" size="256" summ="default" type="STRING"/>
					<colinfo id="ELR_E_C" size="256" summ="default" type="STRING"/>
					<colinfo id="ELR_E_D" size="256" summ="default" type="STRING"/>
					<colinfo id="ELR_E_E" size="256" summ="default" type="STRING"/>
					<colinfo id="ELR_E_F" size="256" summ="default" type="STRING"/>
					<colinfo id="ELR_E_BXD" size="256" summ="default" type="STRING"/>
					<colinfo id="ELR_E_H" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ee_hpb_mod" OnColumnChanged="ds_ee_hpb_mod_OnColumnChanged">
				<Contents>
					<colinfo id="FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="MANDT" size="256" summ="default" type="STRING"/>
					<colinfo id="SUVSN" size="256" summ="default" type="STRING"/>
					<colinfo id="INORDER" size="256" summ="default" type="STRING"/>
					<colinfo id="APPLYFLOOR" size="256" summ="default" type="STRING"/>
					<colinfo id="ELR_E_IDTP" size="256" summ="default" type="STRING"/>
					<colinfo id="ELR_E_HLLC" size="256" summ="default" type="STRING"/>
					<colinfo id="ELR_E_FSLC" size="256" summ="default" type="STRING"/>
					<colinfo id="ELR_E_A" size="256" summ="default" type="STRING"/>
					<colinfo id="ELR_E_B" size="256" summ="default" type="STRING"/>
					<colinfo id="ELR_E_C" size="256" summ="default" type="STRING"/>
					<colinfo id="ELR_E_D" size="256" summ="default" type="STRING"/>
					<colinfo id="ELR_E_E" size="256" summ="default" type="STRING"/>
					<colinfo id="ELR_E_F" size="256" summ="default" type="STRING"/>
					<colinfo id="ELR_E_BXD" size="256" summ="default" type="STRING"/>
					<colinfo id="ELR_E_H" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_rad_prh_old">
				<Contents>
					<colinfo id="FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="HOGI" size="256" summ="default" type="STRING"/>
					<colinfo id="SUVTYPE" size="256" summ="default" type="STRING"/>
					<colinfo id="SUVPRH" size="256" summ="default" type="STRING"/>
					<colinfo id="SUVPRHNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="SUVPRD" size="256" summ="default" type="STRING"/>
					<colinfo id="CALPRD" size="256" summ="default" type="STRING"/>
					<colinfo id="MODYPRD" size="256" summ="default" type="STRING"/>
					<colinfo id="H" size="256" summ="default" type="STRING"/>
					<colinfo id="NOTICE" size="256" summ="default" type="STRING"/>
					<colinfo id="ERNAM" size="256" summ="default" type="STRING"/>
					<colinfo id="SUVSN" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ee_hpb_mod_old">
				<Contents>
					<colinfo id="FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="MANDT" size="256" summ="default" type="STRING"/>
					<colinfo id="SUVSN" size="256" summ="default" type="STRING"/>
					<colinfo id="INORDER" size="256" summ="default" type="STRING"/>
					<colinfo id="APPLYFLOOR" size="256" summ="default" type="STRING"/>
					<colinfo id="ELR_E_IDTP" size="256" summ="default" type="STRING"/>
					<colinfo id="ELR_E_HLLC" size="256" summ="default" type="STRING"/>
					<colinfo id="ELR_E_FSLC" size="256" summ="default" type="STRING"/>
					<colinfo id="ELR_E_A" size="256" summ="default" type="STRING"/>
					<colinfo id="ELR_E_B" size="256" summ="default" type="STRING"/>
					<colinfo id="ELR_E_C" size="256" summ="default" type="STRING"/>
					<colinfo id="ELR_E_D" size="256" summ="default" type="STRING"/>
					<colinfo id="ELR_E_E" size="256" summ="default" type="STRING"/>
					<colinfo id="ELR_E_F" size="256" summ="default" type="STRING"/>
					<colinfo id="ELR_E_BXD" size="256" summ="default" type="STRING"/>
					<colinfo id="ELR_E_H" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ee_dummy">
				<Contents>
					<colinfo id="CALPRD" size="90" summ="default" type="STRING"/>
					<colinfo id="CALYSNO" size="3" summ="default" type="STRING"/>
					<colinfo id="DATADIV" size="15" summ="default" type="STRING"/>
					<colinfo id="DWYSNO" size="3" summ="default" type="STRING"/>
					<colinfo id="FLAG" size="0" summ="default" type="STRING"/>
					<colinfo id="IFNECMSG" size="90" summ="default" type="STRING"/>
					<colinfo id="IFNECST" size="450" summ="default" type="STRING"/>
					<colinfo id="IFNECYSNO" size="3" summ="default" type="STRING"/>
					<colinfo id="INPUTYSNO" size="3" summ="default" type="STRING"/>
					<colinfo id="INTYPE" size="15" summ="default" type="STRING"/>
					<colinfo id="ITEMDIV" size="15" summ="default" type="STRING"/>
					<colinfo id="MANDT" size="9" summ="default" type="STRING"/>
					<colinfo id="MODYPRD" size="90" summ="default" type="STRING"/>
					<colinfo id="MODYYSNO" size="3" summ="default" type="STRING"/>
					<colinfo id="NECYSNO" size="3" summ="default" type="STRING"/>
					<colinfo id="PRH" size="90" summ="default" type="STRING"/>
					<colinfo id="PRHYSNO" size="3" summ="default" type="STRING"/>
					<colinfo id="SUVPRD" size="90" summ="default" type="STRING"/>
					<colinfo id="SUVPRH" size="90" summ="default" type="STRING"/>
					<colinfo id="SUVPRHNAME" size="150" summ="default" type="STRING"/>
					<colinfo id="SUVSN" size="30" summ="default" type="STRING"/>
					<colinfo id="SUVTYPE" size="15" summ="default" type="STRING"/>
					<colinfo id="VIEWORDER" size="6" summ="default" type="INT"/>
					<colinfo id="VIEWYSNO" size="3" summ="default" type="STRING"/>
					<colinfo id="O_SUVPRD" size="256" summ="default" type="STRING"/>
					<colinfo id="CALNAM" size="256" summ="default" type="STRING"/>
					<colinfo id="MODYNAM" size="256" summ="default" type="STRING"/>
					<colinfo id="INORDER" size="256" summ="default" type="STRING"/>
					<colinfo id="APPLYFLOOR" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Filter" FilterExpr="Length(SUVPRD)&amp;gt;0" Id="ds_rad_prh" OnColumnChanged="ds_rad_prh_OnColumnChanged"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_rad_list_old">
				<Contents>
					<colinfo id="FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="QTSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="ECWTP" size="256" summ="default" type="STRING"/>
					<colinfo id="CBRK" size="256" summ="default" type="STRING"/>
					<colinfo id="CRST" size="256" summ="default" type="STRING"/>
					<colinfo id="ERST" size="256" summ="default" type="STRING"/>
					<colinfo id="HRST" size="256" summ="default" type="STRING"/>
					<colinfo id="MRST" size="256" summ="default" type="STRING"/>
					<colinfo id="NOTICE" size="256" summ="default" type="STRING"/>
					<colinfo id="SUVST" size="256" summ="default" type="STRING"/>
					<colinfo id="GTYPE" size="256" summ="default" type="STRING"/>
					<colinfo id="ZUSE" size="256" summ="default" type="STRING"/>
					<colinfo id="TYPE1" size="256" summ="default" type="STRING"/>
					<colinfo id="TYPE2" size="256" summ="default" type="STRING"/>
					<colinfo id="SUVDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="SUVSN" size="256" summ="default" type="STRING"/>
					<colinfo id="HOGI" size="256" summ="default" type="STRING"/>
					<colinfo id="BRNDCD" size="256" summ="default" type="STRING"/>
					<colinfo id="SUVNAM" size="256" summ="default" type="STRING"/>
					<colinfo id="PRINT_HOGI" size="256" summ="default" type="STRING"/>
					<colinfo id="QTNUM" size="256" summ="default" type="STRING"/>
					<colinfo id="QTSER" size="256" summ="default" type="STRING"/>
					<colinfo id="VBELN" size="256" summ="default" type="STRING"/>
					<record>
						<BRNDCD></BRNDCD>
						<CBRK>사용</CBRK>
						<CRST>등록</CRST>
						<ECWTP>REAR&#32;(90°)</ECWTP>
						<ERST>등록</ERST>
						<FLAG></FLAG>
						<GTYPE>LXVF</GTYPE>
						<HOGI></HOGI>
						<HRST>등록</HRST>
						<MRST>등록</MRST>
						<NOTICE>특이사항</NOTICE>
						<PRINT_HOGI></PRINT_HOGI>
						<QTNUM></QTNUM>
						<QTSEQ>L01</QTSEQ>
						<QTSER></QTSER>
						<SUVDAT></SUVDAT>
						<SUVNAM></SUVNAM>
						<SUVSN></SUVSN>
						<SUVST>등록완료</SUVST>
						<TYPE1>7</TYPE1>
						<TYPE2>60</TYPE2>
						<VBELN></VBELN>
						<ZUSE>PS</ZUSE>
					</record>
					<record>
						<BRNDCD></BRNDCD>
						<CBRK>사용</CBRK>
						<CRST>등록</CRST>
						<ECWTP>FRONT&#32;LEFT</ECWTP>
						<ERST>작성중</ERST>
						<FLAG></FLAG>
						<GTYPE>LXVF</GTYPE>
						<HOGI></HOGI>
						<HRST>작성중</HRST>
						<MRST>작성중</MRST>
						<NOTICE>특이사항</NOTICE>
						<PRINT_HOGI></PRINT_HOGI>
						<QTNUM></QTNUM>
						<QTSEQ>L02</QTSEQ>
						<QTSER></QTSER>
						<SUVDAT></SUVDAT>
						<SUVNAM></SUVNAM>
						<SUVSN></SUVSN>
						<SUVST>작성중</SUVST>
						<TYPE1>7</TYPE1>
						<TYPE2>60</TYPE2>
						<VBELN></VBELN>
						<ZUSE>PS</ZUSE>
					</record>
					<record>
						<BRNDCD></BRNDCD>
						<CBRK>미사용</CBRK>
						<CRST>등록</CRST>
						<ECWTP>FRONT&#32;LEFT</ECWTP>
						<ERST>작성중</ERST>
						<FLAG></FLAG>
						<GTYPE>LXVF</GTYPE>
						<HOGI></HOGI>
						<HRST>작성중</HRST>
						<MRST>작성중</MRST>
						<NOTICE>특이사항</NOTICE>
						<PRINT_HOGI></PRINT_HOGI>
						<QTNUM></QTNUM>
						<QTSEQ>L03</QTSEQ>
						<QTSER></QTSER>
						<SUVDAT></SUVDAT>
						<SUVNAM></SUVNAM>
						<SUVSN></SUVSN>
						<SUVST>작성중</SUVST>
						<TYPE1>7</TYPE1>
						<TYPE2>60</TYPE2>
						<VBELN></VBELN>
						<ZUSE>PS</ZUSE>
					</record>
					<record>
						<BRNDCD></BRNDCD>
						<CBRK>사용</CBRK>
						<CRST>등록</CRST>
						<ECWTP>REAR&#32;RIGHT</ECWTP>
						<ERST>작성중</ERST>
						<FLAG></FLAG>
						<GTYPE>WBSS</GTYPE>
						<HOGI></HOGI>
						<HRST>작성중</HRST>
						<MRST>작성중</MRST>
						<NOTICE>특이사항</NOTICE>
						<PRINT_HOGI></PRINT_HOGI>
						<QTNUM></QTNUM>
						<QTSEQ>L04</QTSEQ>
						<QTSER></QTSER>
						<SUVDAT></SUVDAT>
						<SUVNAM></SUVNAM>
						<SUVSN></SUVSN>
						<SUVST>작성중</SUVST>
						<TYPE1>9</TYPE1>
						<TYPE2>60</TYPE2>
						<VBELN></VBELN>
						<ZUSE>PS</ZUSE>
					</record>
					<record>
						<BRNDCD></BRNDCD>
						<CBRK>미사용</CBRK>
						<CRST>등록</CRST>
						<ECWTP>REAR&#32;RIGHT</ECWTP>
						<ERST>작성중</ERST>
						<FLAG></FLAG>
						<GTYPE>WBSS</GTYPE>
						<HOGI></HOGI>
						<HRST>작성중</HRST>
						<MRST>작성중</MRST>
						<NOTICE>특이사항</NOTICE>
						<PRINT_HOGI></PRINT_HOGI>
						<QTNUM></QTNUM>
						<QTSEQ>L05</QTSEQ>
						<QTSER></QTSER>
						<SUVDAT></SUVDAT>
						<SUVNAM></SUVNAM>
						<SUVSN></SUVSN>
						<SUVST>작성중</SUVST>
						<TYPE1>9</TYPE1>
						<TYPE2>60</TYPE2>
						<VBELN></VBELN>
						<ZUSE>PS</ZUSE>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_formula">
				<Contents>
					<colinfo id="formula" size="256" summ="default" type="STRING"/>
					<colinfo id="range" size="256" summ="default" type="STRING"/>
					<colinfo id="message" size="256" summ="default" type="STRING"/>
					<record>
						<formula>abs(H_LL-&#32;(H_A&#32;+&#32;H_CAR_A&#32;+&#32;(H_CARBG/2)&#32;-&#32;(H_JJ/2)))</formula>
						<message>LL값이&#32;(A&#32;+&#32;Car&#32;Rail&#32;가로&#32;+&#32;CAR&#32;BG/2&#32;-JJ/2)&#32;결과&#32;와&#32;50mm&#32;이상&#32;차이[$1]가&#32;납니다.</message>
						<range>50</range>
					</record>
					<record>
						<formula>abs(H_RL-&#32;(H_B&#32;+&#32;H_CAR_A&#32;+&#32;(H_CARBG/2)&#32;-&#32;(H_JJ/2)))</formula>
						<message>RL값이&#32;(B&#32;+&#32;Car&#32;Rail&#32;가로&#32;+&#32;CAR&#32;BG/2&#32;-JJ/2)&#32;결과&#32;와&#32;50mm&#32;이상&#32;차이[$1]가&#32;납니다.</message>
						<range>50</range>
					</record>
					<record>
						<formula>abs(H_H&#32;-&#32;H_J)</formula>
						<message>H값과&#32;J값은&#32;같아야&#32;합니다.</message>
						<range>0</range>
					</record>
					<record>
						<formula>abs(H_X&#32;-&#32;(H_A&#32;+&#32;H_B&#32;+&#32;(H_CAR_A*2)&#32;+&#32;H_CARBG))</formula>
						<message>X값이&#32;(A&#32;+&#32;B&#32;+&#32;(Car&#32;Rail&#32;가로&#32;x&#32;2)&#32;+&#32;CAR&#32;BG)&#32;결과&#32;와&#32;200mm&#32;이상&#32;차이[$1]가&#32;납니다.</message>
						<range>200</range>
					</record>
					<record>
						<formula>abs(H_Y&#32;-&#32;(H_C&#32;+&#32;H_E&#32;+&#32;H_PP&#32;+&#32;H_F))</formula>
						<message>Y값이&#32;(C&#32;+&#32;E&#32;+&#32;PP&#32;+&#32;F)&#32;결과&#32;와&#32;200mm&#32;이상&#32;차이[$1]가&#32;납니다.</message>
						<range>200</range>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_car_rail">
				<Contents>
					<colinfo id="rail" size="256" summ="default" type="STRING"/>
					<colinfo id="a" size="256" summ="default" type="STRING"/>
					<colinfo id="b" size="256" summ="default" type="STRING"/>
					<colinfo id="c" size="256" summ="default" type="STRING"/>
					<record>
						<a>60</a>
						<b>78</b>
						<c>16.4</c>
						<rail>5</rail>
					</record>
					<record>
						<a>88</a>
						<b>96</b>
						<c>19</c>
						<rail>7</rail>
					</record>
					<record>
						<a>56</a>
						<b>78</b>
						<c>10</c>
						<rail>8</rail>
					</record>
					<record>
						<a>62</a>
						<b>89</b>
						<c>16</c>
						<rail>13</rail>
					</record>
					<record>
						<a>89</a>
						<b>114</b>
						<c>16</c>
						<rail>18</rail>
					</record>
					<record>
						<a>89</a>
						<b>127</b>
						<c>16</c>
						<rail>24</rail>
					</record>
					<record>
						<a>108</a>
						<b>140</b>
						<c>19</c>
						<rail>30</rail>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_excel_template">
				<Contents>
					<colinfo id="AEDAT" size="24" summ="default" type="STRING"/>
					<colinfo id="AENAM" size="36" summ="default" type="STRING"/>
					<colinfo id="APPLYFLOOR" size="90" summ="default" type="STRING"/>
					<colinfo id="APPLYFLOOR_2" size="90" summ="default" type="STRING"/>
					<colinfo id="ATKLA" size="30" summ="default" type="STRING"/>
					<colinfo id="CALDAT" size="24" summ="default" type="STRING"/>
					<colinfo id="CALNAM" size="36" summ="default" type="STRING"/>
					<colinfo id="CALPRD" size="90" summ="default" type="STRING"/>
					<colinfo id="ELR_E_A" size="90" summ="default" type="STRING"/>
					<colinfo id="ELR_E_B" size="90" summ="default" type="STRING"/>
					<colinfo id="ELR_E_BXD" size="90" summ="default" type="STRING"/>
					<colinfo id="ELR_E_C" size="90" summ="default" type="STRING"/>
					<colinfo id="ELR_E_D" size="90" summ="default" type="STRING"/>
					<colinfo id="ELR_E_E" size="90" summ="default" type="STRING"/>
					<colinfo id="ELR_E_EFMAT" size="90" summ="default" type="STRING"/>
					<colinfo id="ELR_E_F" size="90" summ="default" type="STRING"/>
					<colinfo id="ELR_E_FSLC" size="90" summ="default" type="STRING"/>
					<colinfo id="ELR_E_H" size="90" summ="default" type="STRING"/>
					<colinfo id="ELR_E_HLLC" size="90" summ="default" type="STRING"/>
					<colinfo id="ELR_E_IDTP" size="90" summ="default" type="STRING"/>
					<colinfo id="ELR_E_JAMBTP" size="90" summ="default" type="STRING"/>
					<colinfo id="ELR_E_PNLH" size="90" summ="default" type="STRING"/>
					<colinfo id="ERDAT" size="24" summ="default" type="STRING"/>
					<colinfo id="ERNAM" size="36" summ="default" type="STRING"/>
					<colinfo id="ITEMDIVNM" size="150" summ="default" type="STRING"/>
					<colinfo id="MODYDAT" size="24" summ="default" type="STRING"/>
					<colinfo id="MODYNAM" size="36" summ="default" type="STRING"/>
					<colinfo id="MODYPRD" size="90" summ="default" type="STRING"/>
					<colinfo id="PRD" size="90" summ="default" type="STRING"/>
					<colinfo id="PRD_B" size="90" summ="default" type="STRING"/>
					<colinfo id="PRH" size="90" summ="default" type="STRING"/>
					<colinfo id="PRH_B" size="90" summ="default" type="STRING"/>
					<colinfo id="PRHNAME" size="90" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="20" summ="default" type="LONG"/>
					<colinfo id="SUVPRD" size="90" summ="default" type="STRING"/>
					<colinfo id="SUVPRH" size="90" summ="default" type="STRING"/>
					<colinfo id="SUVPRHNAME" size="150" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_excel_template2">
				<Contents>
					<colinfo id="CALPRD" size="90" summ="default" type="STRING"/>
					<colinfo id="ITEMDIVNM" size="150" summ="default" type="STRING"/>
					<colinfo id="MODYPRD" size="90" summ="default" type="STRING"/>
					<colinfo id="PRD" size="90" summ="default" type="STRING"/>
					<colinfo id="PRH" size="90" summ="default" type="STRING"/>
					<colinfo id="SUVPRD" size="90" summ="default" type="STRING"/>
					<colinfo id="SUVPRH" size="90" summ="default" type="STRING"/>
					<colinfo id="SUVPRHNAME" size="150" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
		</Datasets>
		<Div Height="36" Id="div_btn" TabOrder="0" ToolTipFont="Default,0" Url="WB01::CommBtnForm.xml" Width="976">
			<Contents></Contents>
		</Div>
		<Shape BKColor="user12" Bottom="68" Height="26" Id="Shape0" Left="11" LineColor="user13" Right="961" TabOrder="1" Top="42" Type="Rectangle" Width="950"></Shape>
		<Static Align="Right" Height="24" Id="Static0" Left="12" Style="sty_lb_form_basic" TabOrder="2" Text="견적번호&#32;" Top="43" VAlign="Middle" Width="94"></Static>
		<Edit BindDataset="ds_master" Border="Flat" Column="QTNUM" Enable="FALSE" Height="20" Id="Edit1" Left="108" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="3" Text="bbbb" Top="45" Width="157"></Edit>
		<Static Align="Right" Height="24" Id="Static4" Left="269" Style="sty_lb_form_basic" TabOrder="3" Text="공사명&#32;" Top="42" VAlign="Middle" Width="94"></Static>
		<Edit BindDataset="ds_master" Border="Flat" Column="GSNAM" Enable="FALSE" Height="20" Id="Edit3" Left="365" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="3" Top="45" Width="332"></Edit>
		<Static Align="Right" Height="24" Id="Static2" Left="699" Style="sty_lb_form_basic" TabOrder="4" Text="프로젝트/수주번호&#32;" Top="43" VAlign="Middle" Width="94"></Static>
		<Edit BindDataset="ds_master" Border="Flat" Column="VBELN" Enable="FALSE" Height="20" Id="Edit2" Left="794" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="4" Top="45" Width="157"></Edit>
		<Shape BKColor="user12" Bottom="93" Height="26" Id="Shape2" Left="11" LineColor="user13" Right="961" TabOrder="9" Top="67" Type="Rectangle" Width="950"></Shape>
		<Static Align="Right" Height="24" Id="Static5" Left="12" Style="sty_lb_form_basic" TabOrder="11" Text="실측자&#32;" Top="68" VAlign="Middle" Width="94"></Static>
		<Edit BindDataset="ds_master" Border="Flat" Column="USER_ID" Height="20" Id="Edit9" Left="108" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="10" Top="70" Width="117"></Edit>
		<Static Align="Right" Height="24" Id="Static11" Left="246" Style="sty_lb_form_basic" TabOrder="13" Text="PM&#32;" Top="69" VAlign="Middle" Width="94"></Static>
		<Edit BindDataset="ds_master" Border="Flat" Column="NAMET" Enable="FALSE" Height="20" Id="Edit5" Left="342" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="12" Top="71" Width="117"></Edit>
		<Static Align="Right" Height="24" Id="Static1" Left="485" Style="sty_lb_form_basic" TabOrder="15" Text="영업담당&#32;" Top="68" VAlign="Middle" Width="94"></Static>
		<Edit BindDataset="ds_master" Border="Flat" Column="ZKUNNR" Enable="FALSE" Height="20" Id="Edit0" Left="581" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="14" Top="70" Width="117"></Edit>
		<Static Align="Right" Height="24" Id="Static3" Left="735" Style="sty_lb_form_basic" TabOrder="17" Text="기술영업담당&#32;" Top="68" VAlign="Middle" Width="94"></Static>
		<Edit BindDataset="ds_master" Border="Flat" Column="NAME1" Enable="FALSE" Height="20" Id="Edit4" Left="833" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="16" Top="71" Width="117"></Edit>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_survey_copy" ImageID="btn_sub_04" Left="893" LeftMargin="12" OnClick="btn_survey_copy_OnClick" Style="sty_btn" TabOrder="18" Text="실측&#32;복사" Top="104" Transparent="TRUE" Width="71"></Button>
		<Static Color="user6" Font="굴림,9,Bold" Height="20" Id="Static13" Left="521" TabOrder="19" Text="표시기&#32;실측사양값" Top="288" VAlign="Middle" Width="822"></Static>
		<Static Color="user6" Font="굴림,9,Bold" Height="20" Id="Static6" Left="521" TabOrder="20" Text="표시기&#32;보정사양값" Top="424" VAlign="Middle" Width="822"></Static>
		<Grid AutoEnter="TRUE" AutoFitEndLine="Hide" BindDataset="ds_rad_list" BkColor2="default" BoldHead="true" Border="Flat" Bottom="280" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="152" Id="grd_rad_list" InputPanel="FALSE" Left="16" LineColor="user20" LineType="ExHORZ" OnExpandEdit="grd_rad_list_OnExpandEdit" Right="966" RowHeight="20" Style="sty_grid" TabOrder="21" TabStop="true" Top="128" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="950">
			<contents>
				<format id="Default">
					<columns>
						<col width="48"/>
						<col width="93"/>
						<col width="57"/>
						<col width="69"/>
						<col width="73"/>
						<col width="65"/>
						<col width="86"/>
						<col width="106"/>
						<col width="106"/>
						<col width="106"/>
						<col width="106"/>
						<col width="106"/>
						<col width="103"/>
						<col width="89"/>
						<col width="89"/>
						<col width="80"/>
					</columns>
					<head>
						<cell align="center" col="0" color="user21" display="text" font="굴림,9" rowspan="2" text="상태"/>
						<cell align="center" col="1" color="user21" display="text" font="굴림,9" rowspan="2" text="일련번호/호기"/>
						<cell col="2" color="user21" display="text" font="굴림,9" rowspan="2" text="기종"/>
						<cell col="3" color="user21" display="text" font="굴림,9" rowspan="2" text="용도"/>
						<cell col="4" color="user21" display="text" font="굴림,9" rowspan="2" text="인승"/>
						<cell col="5" color="user21" display="text" font="굴림,9" rowspan="2" text="속도"/>
						<cell col="6" color="user21" display="text" font="굴림,9" rowspan="2" text="실측일자"/>
						<cell align="center" col="7" color="user21" display="text" font="굴림,9" rowspan="2" text="CWT&#32;위치"/>
						<cell align="center" col="8" color="user21" display="text" font="굴림,9" rowspan="2" text="공용&#32;브라켓"/>
						<cell col="9" colspan="4" display="text">
							<cell col="0" display="text"/>
							<cell align="center" col="1" color="user21" display="text" font="굴림,9" text="실측보고서"/>
							<cell align="center" col="2" color="user21" display="text" font="굴림,9" text="등록상태"/>
							<cell col="3" display="text"/>
						</cell>
						<cell align="center" col="9" color="user21" display="text" font="굴림,9" row="1" text="승강로"/>
						<cell align="center" col="10" color="user21" display="text" font="굴림,9" row="1" text="기계실"/>
						<cell align="center" col="11" color="user21" display="text" font="굴림,9" row="1" text="CWT&#32;및&#32;층고"/>
						<cell align="center" col="12" color="user21" display="text" font="굴림,9" row="1" text="승장부문"/>
						<cell align="center" col="13" color="user21" display="text" font="굴림,9" rowspan="2" text="특이사항"/>
						<cell align="center" col="14" color="user21" display="text" font="굴림,9" rowspan="2" text="실측진행상태"/>
						<cell col="15" display="text" rowspan="2" text="SAPSEQ"/>
					</head>
					<body>
						<cell bkcolor2="user22" bkimageid='expr:gfn_getFlagBkImageID(getColumn(currow,&#32;&quot;FLAG&quot;))' col="0" display="text"/>
						<cell align="center" bkcolor2="user22" col="1" colid="PRINT_HOGI" display="text"/>
						<cell align="center" col="2" colid="GTYPE" display="text"/>
						<cell align="center" col="3" colid="ZUSE" display="text"/>
						<cell align="center" col="4" colid="TYPE1" display="text"/>
						<cell align="center" col="5" colid="TYPE2" display="text"/>
						<cell align="center" col="6" colid="SUVDAT" display="date" edit="date"/>
						<cell col="7" colid="ECWTP" combocol="SUVPRD" combodataset="ds_ELR_B_ECWTP" combotext="SUVPRDNAME" display="combo" edit='expr:decode(getColumn(currow,&quot;HRST&quot;)+&quot;^&quot;+getColumn(currow,&#32;&quot;MRST&quot;)+&quot;^&quot;+getColumn(currow,&quot;CRST&quot;)+&quot;^&quot;+getColumn(currow,&#32;&quot;ERST&quot;),&quot;N^N^N^N&quot;,&quot;combo&quot;,&quot;none&quot;)'/>
						<cell col="8" colid="CBRK" combocol="SUVPRD" combodataset="ds_ELR_B_CBRK" combotext="SUVPRDNAME" display="combo" edit='expr:decode(getColumn(currow,&quot;HRST&quot;)+&quot;^&quot;+getColumn(currow,&#32;&quot;MRST&quot;)+&quot;^&quot;+getColumn(currow,&quot;CRST&quot;)+&quot;^&quot;+getColumn(currow,&#32;&quot;ERST&quot;),&quot;N^N^N^N&quot;,&quot;combo&quot;,&quot;none&quot;)'/>
						<cell col="9" colid="HRST" combocol="SUVPRD" combodataset="ds_CD_R_STAT" combotext="SUVPRDNAME" display="combo" expandshow="true"/>
						<cell col="10" colid="MRST" combocol="SUVPRD" combodataset="ds_CD_R_STAT" combotext="SUVPRDNAME" display="combo" expandshow="true"/>
						<cell col="11" colid="CRST" combocol="SUVPRD" combodataset="ds_CD_R_STAT" combotext="SUVPRDNAME" display="combo" expandshow="true"/>
						<cell col="12" colid="ERST" combocol="SUVPRD" combodataset="ds_CD_R_STAT" combotext="SUVPRDNAME" display="combo" expandshow="true"/>
						<cell bkcolor2="user22" col="13" colid="NOTICE" display="text" expandshow="expr:decode(fn_isNull(NOTICE),&apos;1&apos;,&apos;false&apos;,&apos;true&apos;)"/>
						<cell col="14" colid="SUVST" combocol="SUVPRD" combodataset="ds_CD_S_STAT" combotext="SUVPRDNAME" display="combo"/>
						<cell col="15" colid="SAPSEQ" display="text"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Image Height="19" Id="Image0" ImageID="form_bl_title_sub" Left="16" TabOrder="24" Top="288" Width="11"></Image>
		<Static Color="user6" Font="굴림,9,Bold" Height="20" Id="Static7" Left="32" TabOrder="23" Text="실측사양(표시기제외)" Top="287" VAlign="Middle" Width="400"></Static>
		<Grid AutoEnter="TRUE" AutoFitEndLine="Hide" BindDataset="ds_rad_prh" BkColor2="default" BoldHead="true" Border="Flat" Bottom="552" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="240" Id="grd_rad_prh" InputPanel="FALSE" Left="16" LineColor="user20" LineType="ExHORZ" Right="480" RowHeight="20" Style="sty_grid" TabOrder="22" TabStop="true" Top="312" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="464">
			<contents>
				<format id="Default">
					<columns>
						<col width="41"/>
						<col width="92"/>
						<col width="50"/>
						<col width="1"/>
						<col width="96"/>
						<col width="52"/>
						<col width="54"/>
						<col width="55"/>
						<col width="129"/>
						<col width="63"/>
					</columns>
					<head>
						<cell align="center" col="0" color="user21" display="text" font="굴림,9" text="상태"/>
						<cell align="center" col="1" color="user21" display="text" font="굴림,9" text="일련번호/호기"/>
						<cell align="center" col="2" color="user21" display="text" font="굴림,9" text="보고서"/>
						<cell align="center" col="3" color="user21" display="text" font="굴림,9" text="사양"/>
						<cell align="center" col="4" color="user21" display="text" font="굴림,9" text="사양명"/>
						<cell align="center" col="5" color="user21" display="text" font="굴림,9" text="실측값"/>
						<cell align="center" col="6" color="user21" display="text" font="굴림,9" text="연산값"/>
						<cell align="center" col="7" color="user21" display="text" font="굴림,9" text="보정값"/>
						<cell align="center" col="8" color="user21" display="text" font="굴림,9" text="등록자"/>
						<cell col="9" display="text"/>
					</head>
					<body>
						<cell bkimageid='expr:gfn_getFlagBkImageID(getColumn(currow,&#32;&quot;FLAG&quot;))' col="0" colid="FLAG" display="image"/>
						<cell align="center" bkcolor2="user22" col="1" colid="HOGI" display="text"/>
						<cell col="2" colid="SUVTYPE" combocol="SUVPRD" combodataset="ds_CD_R_TYPE" combotext="SUVPRDNAME" display="combo"/>
						<cell align="center" bkcolor2="user22" col="3" colid="SUVPRH" display="text"/>
						<cell align="left" bkcolor2="user22" col="4" colid="SUVPRHNAME" display="text"/>
						<cell align="right" bkcolor2="user22" col="5" colid="SUVPRD" display="text"/>
						<cell align="right" bkcolor="user13" col="6" display="text"/>
						<cell align="right" bkcolor="cornsilk" col="7" colid="MODYPRD" display="text" edit="expr:decode(INTYPE,&apos;NUM&apos;,&apos;number&apos;,&apos;normal&apos;)" limit="expr:decode(INTYPE,&apos;NUM&apos;,5,20)"/>
						<cell align="center" bkcolor2="user22" col="8" colid="ERNAM" display="text"/>
						<cell col="9" display="text"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Image Height="19" Id="Image1" ImageID="form_bl_title_sub" Left="504" TabOrder="25" Top="288" Width="11"></Image>
		<Image Height="19" Id="Image2" ImageID="form_bl_title_sub" Left="504" TabOrder="26" Top="424" Width="11"></Image>
		<Grid AutoEnter="TRUE" AutoFitEndLine="Hide" BindDataset="ds_ee_hpb" BkColor2="default" BoldHead="true" Border="Flat" Bottom="408" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="96" Id="grd_hpb" InputPanel="FALSE" Left="496" LineColor="user20" LineType="ExHORZ" OnHScroll="grd_hpb_OnHScroll" OnMouseOver="grd_hpb_OnMouseOver" OnVScroll="grd_hpb_OnVScroll" Right="968" RowHeight="20" Style="sty_grid" TabOrder="27" TabStop="true" Top="312" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="472">
			<contents>
				<format id="Default">
					<columns>
						<col width="35"/>
						<col width="63"/>
						<col width="88"/>
						<col width="90"/>
						<col width="93"/>
						<col width="50"/>
						<col width="50"/>
						<col width="50"/>
						<col width="50"/>
						<col width="50"/>
						<col width="50"/>
						<col width="60"/>
						<col width="50"/>
					</columns>
					<head>
						<cell align="center" col="0" color="user21" display="text" font="굴림,9" text="상태"/>
						<cell col="1" color="user21" display="text" font="굴림,9" text="적용층"/>
						<cell align="center" col="2" color="user21" display="text" font="굴림,9" text="종류"/>
						<cell col="3" color="user21" display="text" font="굴림,9" text="홀랜턴&#32;위치"/>
						<cell col="4" color="user21" display="text" font="굴림,9" text="소방스위치&#32;위치"/>
						<cell col="5" color="user21" display="text" font="굴림,9" text="A"/>
						<cell col="6" color="user21" display="text" font="굴림,9" text="B"/>
						<cell col="7" color="user21" display="text" font="굴림,9" text="F"/>
						<cell col="8" color="user21" display="text" font="굴림,9" text="C"/>
						<cell col="9" color="user21" display="text" font="굴림,9" text="D"/>
						<cell col="10" color="user21" display="text" font="굴림,9" text="E"/>
						<cell col="11" color="user21" display="text" font="굴림,9" text="BOX깊이"/>
						<cell col="12" color="user21" display="text" font="굴림,9" text="H"/>
					</head>
					<body>
						<cell bkimageid='expr:gfn_getFlagBkImageID(getColumn(currow,&#32;&quot;FLAG&quot;))' col="0" display="text"/>
						<cell align="center" col="1" colid="APPLYFLOOR" display="text" limit="30"/>
						<cell align="center" bkcolor2="user22" col="2" colid="ELR_E_IDTP" combocol="SUVPRD" combodataset="ds_ELR_E_IDTP" combodisplayrowcnt="6" combotext="SUVPRDNAME" display="combo"/>
						<cell col="3" colid="ELR_E_HLLC" combocol="SUVPRD" combodataset="ds_ELR_E_HLLC" combotext="SUVPRDNAME" display="combo"/>
						<cell col="4" colid="ELR_E_FSLC" combocol="SUVPRD" combodataset="ds_ELR_E_FSLC" combotext="SUVPRDNAME" display="combo"/>
						<cell col="5" colid="ELR_E_A" display="number" limit="5"/>
						<cell col="6" colid="ELR_E_B" display="number" limit="5"/>
						<cell col="7" colid="ELR_E_F" display="number" limit="5"/>
						<cell col="8" colid="ELR_E_C" display="number" limit="5"/>
						<cell col="9" colid="ELR_E_D" display="number" limit="5"/>
						<cell col="10" colid="ELR_E_E" display="number" limit="5"/>
						<cell col="11" colid="ELR_E_BXD" display="number" limit="5"/>
						<cell col="12" colid="ELR_E_H" display="number" limit="5"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Grid AutoEnter="TRUE" AutoFitEndLine="Hide" BindDataset="ds_ee_hpb_mod" BkColor2="default" BoldHead="true" Border="Flat" Bottom="552" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="104" Id="grd_hbb_mod" InputPanel="FALSE" Left="496" LineColor="user20" LineType="ExHORZ" OnHScroll="grd_hbb_mod_OnHScroll" OnMouseOver="grd_hbb_mod_OnMouseOver" OnVScroll="grd_hbb_mod_OnVScroll" Right="968" RowHeight="20" Style="sty_grid" TabOrder="28" TabStop="true" Top="448" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="472">
			<contents>
				<format id="Default">
					<columns>
						<col width="35"/>
						<col width="63"/>
						<col width="88"/>
						<col width="90"/>
						<col width="93"/>
						<col width="50"/>
						<col width="50"/>
						<col width="50"/>
						<col width="50"/>
						<col width="50"/>
						<col width="50"/>
						<col width="60"/>
						<col width="50"/>
					</columns>
					<head>
						<cell align="center" col="0" color="user21" display="text" font="굴림,9" text="상태"/>
						<cell col="1" color="user21" display="text" font="굴림,9" text="적용층"/>
						<cell align="center" col="2" color="user21" display="text" font="굴림,9" text="종류"/>
						<cell col="3" color="user21" display="text" font="굴림,9" text="홀랜턴&#32;위치"/>
						<cell col="4" color="user21" display="text" font="굴림,9" text="소방스위치&#32;위치"/>
						<cell col="5" color="user21" display="text" font="굴림,9" text="A"/>
						<cell col="6" color="user21" display="text" font="굴림,9" text="B"/>
						<cell col="7" color="user21" display="text" font="굴림,9" text="F"/>
						<cell col="8" color="user21" display="text" font="굴림,9" text="C"/>
						<cell col="9" color="user21" display="text" font="굴림,9" text="D"/>
						<cell col="10" color="user21" display="text" font="굴림,9" text="E"/>
						<cell col="11" color="user21" display="text" font="굴림,9" text="BOX깊이"/>
						<cell col="12" color="user21" display="text" font="굴림,9" text="H"/>
					</head>
					<body>
						<cell bkcolor="user22" bkimageid='expr:gfn_getFlagBkImageID(getColumn(currow,&#32;&quot;FLAG&quot;))' col="0" colid="FLAG" display="image"/>
						<cell align="center" col="1" colid="APPLYFLOOR" display="text" limit="30"/>
						<cell align="center" bkcolor="cornsilk" col="2" colid="ELR_E_IDTP" combocol="SUVPRD" combodataset="ds_ELR_E_IDTP" combodisplayrowcnt="6" combotext="SUVPRDNAME" display="combo" edit="combo"/>
						<cell col="3" colid="ELR_E_HLLC" combocol="SUVPRD" combodataset="ds_ELR_E_HLLC" combotext="SUVPRDNAME" display="combo" edit="expr:decode(ELR_E_IDTP,&apos;HLT&apos;,&apos;combo&apos;,&apos;none&apos;)"/>
						<cell col="4" colid="ELR_E_FSLC" combocol="SUVPRD" combodataset="ds_ELR_E_FSLC" combotext="SUVPRDNAME" display="combo" edit="expr:decode(ELR_E_IDTP,&apos;FSW&apos;,&apos;combo&apos;,&apos;none&apos;)"/>
						<cell bkcolor="cornsilk" col="5" colid="ELR_E_A" display="number" edit="number" limit="5"/>
						<cell bkcolor="cornsilk" col="6" colid="ELR_E_B" display="number" edit="number" limit="5"/>
						<cell bkcolor="cornsilk" col="7" colid="ELR_E_F" display="number" edit="number" limit="5"/>
						<cell bkcolor="cornsilk" col="8" colid="ELR_E_C" display="number" edit="number" limit="5"/>
						<cell bkcolor="cornsilk" col="9" colid="ELR_E_D" display="number" edit="number" limit="5"/>
						<cell bkcolor="cornsilk" col="10" colid="ELR_E_E" display="number" edit="number" limit="5"/>
						<cell bkcolor="cornsilk" col="11" colid="ELR_E_BXD" display="number" edit="number" limit="5"/>
						<cell bkcolor="cornsilk" col="12" colid="ELR_E_H" display="number" edit="number" limit="5"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Grid AutoEnter="TRUE" AutoFitEndLine="Hide" BindDataset="ds_excel_template" BkColor2="default" BoldHead="true" Border="Flat" Bottom="816" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="312" Id="grd_excel" InputPanel="FALSE" Left="136" LineColor="user20" LineType="ExHORZ" Right="920" RowHeight="20" Style="sty_grid" TabOrder="29" TabStop="true" Top="504" UseAutoSizing="Col" UseDBuff="true" UseExSizing="Col" UsePopupMenu="true" UseSelColor="true" Visible="FALSE" VLineColor="default" WheelScrollRow="1" Width="784">
			<contents>
				<format id="Default">
					<columns>
						<col width="41"/>
						<col width="92"/>
						<col width="92"/>
						<col width="233"/>
						<col width="96"/>
						<col width="20"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="20"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="100"/>
						<col width="70"/>
						<col width="70"/>
						<col width="70"/>
						<col width="70"/>
						<col width="70"/>
						<col width="70"/>
						<col width="70"/>
						<col width="70"/>
						<col width="20"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="110"/>
					</columns>
					<head>
						<cell col="0" colspan="5" display="text">
							<cell align="center" col="0" color="user21" colspan="5" display="text" font="굴림,9" text="-견적영업사양"/>
						</cell>
						<cell align="center" col="5" color="user21" display="text" font="굴림,9" text="||"/>
						<cell col="6" colspan="16" display="text">
							<cell align="center" col="0" color="user21" colspan="16" display="text" font="굴림,9" text="-&#32;실측사양(승강로,기계실,CWT)"/>
						</cell>
						<cell align="center" col="22" color="user21" display="text" font="굴림,9" text="||"/>
						<cell col="23" colspan="12" display="text">
							<cell col="0" color="#4d6975" colspan="12" display="text" font="굴림,9" text="-표시기실측"/>
						</cell>
						<cell align="center" col="35" color="user21" display="text" font="굴림,9" text="||"/>
						<cell col="36" colspan="4" display="text">
							<cell col="0" color="user21" colspan="4" display="text" font="굴림,9" text="-&#32;JAMB정보실측"/>
						</cell>
						<cell align="center" col="0" color="user21" display="text" font="굴림,9" row="1" text="순번"/>
						<cell align="center" col="1" color="user21" display="text" font="굴림,9" row="1" text="그룹"/>
						<cell align="center" col="2" color="user21" display="text" font="굴림,9" row="1" text="영업사양"/>
						<cell align="center" col="3" color="user21" display="text" font="굴림,9" row="1" text="영업사양명"/>
						<cell align="center" col="4" color="user21" display="text" font="굴림,9" row="1" text="영업사양값"/>
						<cell align="center" col="5" color="user21" display="text" font="굴림,9" row="1" text="||"/>
						<cell align="center" col="6" color="user21" display="text" font="굴림,9" row="1" text="실측보고서"/>
						<cell align="center" col="7" color="user21" display="text" font="굴림,9" row="1" text="실측사양"/>
						<cell align="center" col="8" color="user21" display="text" font="굴림,9" row="1" text="실측사양명"/>
						<cell align="center" col="9" color="user21" display="text" font="굴림,9" row="1" text="실측값"/>
						<cell align="center" col="10" color="user21" display="text" font="굴림,9" row="1" text="영업사양값"/>
						<cell align="center" col="11" color="user21" display="text" font="굴림,9" row="1" text="연산값"/>
						<cell align="center" col="12" color="user21" display="text" font="굴림,9" row="1" text="보정값"/>
						<cell align="center" col="13" color="user21" display="text" font="굴림,9" row="1" text="영업사양"/>
						<cell align="center" col="14" color="user21" display="text" font="굴림,9" row="1" text="&#32;최초등록일&#32;"/>
						<cell align="center" col="15" color="user21" display="text" font="굴림,9" row="1" text="최초등록자"/>
						<cell align="center" col="16" color="user21" display="text" font="굴림,9" row="1" text="&#32;최종수정일&#32;"/>
						<cell align="center" col="17" color="user21" display="text" font="굴림,9" row="1" text="최종수정자"/>
						<cell align="center" col="18" color="user21" display="text" font="굴림,9" row="1" text="최종연산등록일"/>
						<cell align="center" col="19" color="user21" display="text" font="굴림,9" row="1" text="최종연산등록자"/>
						<cell align="center" col="20" color="user21" display="text" font="굴림,9" row="1" text="최종보정등록일"/>
						<cell align="center" col="21" color="user21" display="text" font="굴림,9" row="1" text="최종보정등록자"/>
						<cell align="center" col="22" color="user21" display="text" font="굴림,9" row="1" text="||"/>
						<cell align="center" col="23" color="user21" display="text" font="굴림,9" row="1" text="적용층"/>
						<cell align="center" col="24" color="user21" display="text" font="굴림,9" row="1" text="표시기종류"/>
						<cell align="center" col="25" color="user21" display="text" font="굴림,9" row="1" text="홀랜턴위치"/>
						<cell align="center" col="26" color="user21" display="text" font="굴림,9" row="1" text="소방스위치위치"/>
						<cell align="center" col="27" color="user21" display="text" font="굴림,9" row="1" text="A"/>
						<cell align="center" col="28" color="user21" display="text" font="굴림,9" row="1" text="B"/>
						<cell align="center" col="29" color="user21" display="text" font="굴림,9" row="1" text="F"/>
						<cell align="center" col="30" color="user21" display="text" font="굴림,9" row="1" text="C"/>
						<cell align="center" col="31" color="user21" display="text" font="굴림,9" row="1" text="D"/>
						<cell align="center" col="32" color="user21" display="text" font="굴림,9" row="1" text="E"/>
						<cell align="center" col="33" color="user21" display="text" font="굴림,9" row="1" text="BOX깊이"/>
						<cell align="center" col="34" color="user21" display="text" font="굴림,9" row="1" text="H"/>
						<cell align="center" col="35" color="user21" display="text" font="굴림,9" row="1" text="||"/>
						<cell align="center" col="36" color="user21" display="text" font="굴림,9" row="1" text="적용층"/>
						<cell align="center" col="37" color="user21" display="text" font="굴림,9" row="1" text="JAMB타입"/>
						<cell align="center" col="38" color="user21" display="text" font="굴림,9" row="1" text="출입구마감재질"/>
						<cell align="center" col="39" color="user21" display="text" font="굴림,9" row="1" text="승장도어판넬높이"/>
					</head>
					<body>
						<cell align="center" col="0" colid="SEQ" display="normal"/>
						<cell align="left" bkcolor2="user22" col="1" colid="ATKLA" display="normal"/>
						<cell align="left" col="2" colid="PRH" combocol="SUVPRD" combotext="SUVPRD" display="normal"/>
						<cell align="left" bkcolor2="user22" col="3" colid="PRHNAME" display="normal"/>
						<cell align="left" bkcolor2="user22" col="4" colid="PRD" display="normal"/>
						<cell align="right" bkcolor2="user22" col="5" display="normal"/>
						<cell col="6" colid="ITEMDIVNM" display="text"/>
						<cell col="7" colid="SUVPRH" display="text"/>
						<cell col="8" colid="SUVPRHNAME" display="text"/>
						<cell col="9" colid="SUVPRD" display="text"/>
						<cell col="10" colid="PRD_B" display="text"/>
						<cell col="11" colid="CALPRD" display="text"/>
						<cell col="12" colid="MODYPRD" display="text"/>
						<cell col="13" colid="PRH_B" display="text"/>
						<cell col="14" colid="ERDAT" display="date"/>
						<cell col="15" colid="ERNAM" display="text"/>
						<cell col="16" colid="AEDAT" display="date"/>
						<cell col="17" colid="AENAM" display="text"/>
						<cell col="18" colid="CALDAT" display="date"/>
						<cell col="19" colid="CALNAM" display="text"/>
						<cell col="20" colid="MODYDAT" display="date"/>
						<cell col="21" colid="MODYNAM" display="text"/>
						<cell col="22" display="text"/>
						<cell col="23" colid="APPLYFLOOR" display="text"/>
						<cell col="24" colid="ELR_E_IDTP" display="text"/>
						<cell col="25" colid="ELR_E_HLLC" display="text"/>
						<cell col="26" colid="ELR_E_FSLC" display="text"/>
						<cell col="27" colid="ELR_E_A" display="text"/>
						<cell col="28" colid="ELR_E_B" display="text"/>
						<cell col="29" colid="ELR_E_F" display="text"/>
						<cell col="30" colid="ELR_E_C" display="text"/>
						<cell col="31" colid="ELR_E_D" display="text"/>
						<cell col="32" colid="ELR_E_E" display="text"/>
						<cell col="33" colid="ELR_E_BXD" display="text"/>
						<cell col="34" colid="ELR_E_H" display="text"/>
						<cell col="35" display="text"/>
						<cell col="36" colid="APPLYFLOOR_2" display="text"/>
						<cell col="37" colid="ELR_E_JAMBTP" display="text"/>
						<cell col="38" colid="ELR_E_EFMAT" display="text"/>
						<cell col="39" colid="ELR_E_PNLH" display="text"/>
					</body>
				</format>
			</contents>
		</Grid>
		<PopupDiv Border="Flat" BorderColor="user16" Height="75" Id="popdiv_notice" Left="112" ShadowColor="user8" TabOrder="30" TabStop="FALSE" Top="384" Width="757">
			<Contents>
				<Image FillType="STRETCH" Height="36" Id="img_bak" ImageID="popup_title_back" TabOrder="3" Width="856"></Image>
				<Static Align="Right" Height="36" Id="Static12" Style="sty_lb_form_basic" TabOrder="2" Text="특이사항&#32;&#10;모든&#32;보고서&#32;공용&#32;&#32;" Top="36" VAlign="Middle" Width="95"></Static>
				<TextArea Border="Flat" Height="33" Id="ta_NOTICE" Left="97" MaxLength="100" Readonly="TRUE" Style="sty_ipt_form" TabOrder="1" Top="38" VScroll="TRUE" Width="656"></TextArea>
				<Image Height="36" Id="Image1" ImageID="form_bl_title_main" Left="8" LeftMargin="10" TabOrder="4" Width="15"></Image>
				<Static Color="user5" Font="굴림,10,Bold" Height="20" Id="st_title" Left="28" TabOrder="5" Text="특이사항" Top="8" VAlign="Middle" Width="348"></Static>
			</Contents>
		</PopupDiv>
	</Form>
	<Script><![CDATA[﻿﻿﻿﻿﻿﻿﻿﻿/*
 ******************************************************************************************
 * 기      능   : 
 * 작  성  자   : 
 * 작성  일자   : 
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
#include "LIB::commons.js";	// 공통 스크립트 
#include "LIB::utility.js";	// 다중 선택 
//=========================================================================================
// [ PART 1 ]
// Form에서 사용될 전역변수를 선언
// FORM에서 사용되는 전역변수는 대문자로 작성하며, F_XXX 의 형태를 갖도록 한다. 
//=========================================================================================
var F_TITLE = "리모델링 실측확인";
var sclgrid = "hpb";

//=========================================================================================
// [ PART 2 ]
// Form Loading / Unloading 시 작업 정의
//=========================================================================================
function fn_OnLoadCompleted(obj) {
	//trace("견적번호 : " + QTNUM);
	ds_master.MANDT = G_MANDT;
	ds_master.QTNUM = QTNUM;
	//ds_cond.AddRow();
	//ds_cond.SetColumn(0,"QTNUM",QTNUM)
	ds_master.QTSER = QTSER;
	//ds_cond.SetColumn(0,"QTSER",QTSER)
	ds_master.GSNAM = GSNAM;
	ds_master.NAME1 = NAME1;
	ds_master.NAMET = NAMET;
	ds_master.PM = PM;
	ds_master.VBELN = VBELN; 
	//ds_cond.SetColumn(0,"VBELN",VBELN)
	ds_master.ZKUNNR = ZKUNNR;
	//ds_master.USER_ID = G_USER_ID;
	
	div_btn.fn_loadUseBtn("1,30,45,900", F_TITLE, "", "");
    fn_resize();
	gfn_initForm();
	fn_init_form();
}

/********************************************************************************
* 쿼리  : 코드 조회 : CWT 위치
********************************************************************************/
function fn_query_code(code) {

	var arr = split(code, ",");
	for(var i = 0; i < arr.length(); i++) {

		ds_cond_code.ClearData();
		ds_cond_code.AppendRow();
		ds_cond_code.SetColumn(0, "MANDT", G_MANDT);
		ds_cond_code.SetColumn(0, "SUVPRH", arr[i]);
		
		//trace("arr["+i+"]" + arr[i]);
		
		tit_clearActionInfo();
		tit_addSearchActionInfo("ps11:PS1120001A_S3"); // 헤더 조회
		
		tit_callService(""
		    			,""
						,"ds_cond=ds_cond_code"
						,"ds_dummy=ds_dummy"
						,""
						,"fn_afterQuery_code"
						,""
						,""
						,true);
	}
}

/********************************************************************************
* 기      능   : 조회 Callback  
********************************************************************************/
function fn_afterQuery_code(errCode, errMsg) {
    //trace("code : " + ds_cond_code.GetColumn(0, "SUVPRH"));
	object("ds_"+ds_cond_code.GetColumn(0, "SUVPRH")).copy(ds_dummy);
	//object("ds_"+ds_cond_code.GetColumn(0, "SUVPRH")).saveXML();
	
	
}

/********************************************************************************
* 기      능   : form UnloadCompleted 
********************************************************************************/
function fn_OnUnloadCompleted(obj) {
	return gfn_isFormUnload(obj);
}

/********************************************************************************
* 기      능   : 폼 초기화
********************************************************************************/
function fn_init_form() {
    //ed_brndseq.Text = F_BRNDSEQ;
    
    fn_query_code("ELR_B_ECWTP,ELR_B_CBRK,CD_R_STAT,CD_S_STAT,CD_R_TYPE,ELR_E_IDTP,ELR_E_HLLC,ELR_E_FSLC");
    
    // 초기 쿼리 수행
    //trace("초기 쿼리수행");
    fn_query();
} 

function fn_resize() {
	this.onsize = "";
	window.top    = GetPlatformInfo("WorkArea","top");
	window.left   = GetPlatformInfo("WorkArea","left");
	window.width  = GetPlatformInfo("WorkArea","width");
	window.height = GetPlatformInfo("WorkArea","height");
}

//=========================================================================================
// [ PART 3 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,form닫기)
//=========================================================================================
/********************************************************************************
* 기      능   : 조회 1
********************************************************************************/
function fn_query() {

  //trace("query start : ");
  
  
  //trace("견적번호 : " + QTNUM);

  
  
  tit_clearActionInfo();
  tit_addSearchActionInfo("ps11:PS1120001B_S1");
  
  // TODO 실제로 값 전달하고 받아 오도록 작성하기
  
                
  
				//TRACE(ds_master.SaveXML());
				
				
  
  				ds_cond.ClearData();
  				ds_rad_list.ClearData();
				ds_cond.AddRow();
				ds_cond.setColumn(0, "MANDT", G_MANDT);
				ds_cond.setColumn(0, "QTNUM", ds_master.QTNUM);
				ds_cond.setColumn(0, "QTSER", ds_master.QTSER);
				ds_cond.setColumn(0, "VBELN", ds_master.VBELN);
				//TRACE(ds_cond.SaveXML());
				//ds_cond.setColumn(0, "BIGO", ds_list_tmp.GetColumn(i, "BIGO"))
  
  	 tit_callService(
        ""
        , ""
        , "ds_cond=ds_cond"
        , "ds_rad_list=ds_rad_list"
        , ""
        , "fn_afterQuery"
        , ""
        , ""
        , true);
        
        //trace("result : " + ds_rad_list.SaveXML());
        
        //TRACE("ds_rad_list query end " );
        
        //TRACE(ds_rad_list.SaveXML());
        
        
        
     ed_FileName.value = '';


}


/********************************************************************************
* 기      능   : 조회 Callback  
********************************************************************************/
function fn_afterQuery(errCode, errMsg) {

	ds_rad_list_old.copy(ds_rad_list);
	//fn_query2();
	//fn_query3();
	//fn_query4();

}

/********************************************************************************
* 기      능   : 닫기  
********************************************************************************/
function fn_close() {
	
	
	if(ds_rad_list.CaseCount("FLAG!=''") > 0) {
		if(gfn_openMsgWin("변경 사항이 있습니다. \n이대로 닫으면, 변경사항은 저장 되지 않습니다.\n"+
			  "저장을 눌러 저장 할 수 있습니다.\n"+
			  "창을 닫으시겠습니까?" , "W","C")) {
			this.Close();
		} else {
			return false;
		}
	}
	 
	// 하나의 정보라도 변경된 정보가 있으면 체크하고 새로운 창을 띄우지 않는다. 
	
	if(ds_rad_prh.CaseCount("FLAG!=''") > 0) {
		if(gfn_openMsgWin("변경 사항이 있습니다. \n이대로 닫으면, 변경사항은 저장 되지 않습니다.\n"+
			  "저장을 눌러 저장 할 수 있습니다.\n"+
			  "창을 닫으시겠습니까?" , "W","C")) {
			this.Close();
		} else {
			return false;
		}

	}
	 	 
	// 하나의 정보라도 변경된 정보가 있으면 체크하고 새로운 창을 띄우지 않는다. 	
	if(ds_ee_hpb_mod.CaseCount("FLAG!=''") > 0) {
		if(gfn_openMsgWin("변경 사항이 있습니다. \n이대로 닫으면, 변경사항은 저장 되지 않습니다.\n"+
			  "저장을 눌러 저장 할 수 있습니다.\n"+
			  "창을 닫으시겠습니까?" , "W","C")) {
			this.Close();
		} else {
			return false;
		}
	}

    this.Close();
}

/********************************************************************************
* 기      능   : 실측 타입별 실측등록 화면 호출
********************************************************************************/
function grd_rad_list_OnExpandEdit(obj,nRow,nCell,strVal,nPivotIndex)
{
	if(nCell == 13) {
		var leftX = parseInt(GetPlatformInfo("WorkArea","left")) +100;
		var topY  = parseInt(GetPlatformInfo("WorkArea","top")) + 270;
		
		popdiv_notice.ta_NOTICE.Text = ds_rad_list.GetColumn(nRow, "NOTICE");
		popdiv_notice.TrackPopup(leftX, topY);
		return;
	}
	
    var ECWTP  = ds_rad_list.GetColumn(nRow, "ECWTP");
    var CBRK   = ds_rad_list.GetColumn(nRow, "CBRK");
    var SUVDAT = ds_rad_list.GetColumn(nRow, "SUVDAT");	   	            	            	            
    
    if(fn_isNull(SUVDAT)) {
		gfn_openMsgWin("실측일을 입력해 주십시오", "I");
		grd_rad_list.SetCellPos(6);
		grd_rad_list.SetFocus();
		return;
	}
	
	if(fn_isNull(ECWTP)) {	
		gfn_openMsgWin("CWT 위치를 선택해주십시오", "I");
		grd_rad_list.SetCellPos(7);
		grd_rad_list.SetFocus();
		return;
	}
	
	if(ECWTP != "R" && fn_isNull(CBRK)) {
		gfn_openMsgWin("공용브라켓 여부를 선택해주십시오", "I");
		grd_rad_list.SetCellPos(8);
		grd_rad_list.SetFocus();
		return;
	}

	// 하나의 정보라도 변경된 정보가 있으면 체크하고 새로운 창을 띄우지 않는다. 
	if(ds_rad_list.CaseCount("FLAG!=''") > 0) {
		gfn_openMsgWin("변경사항이 있습니다. 변경 내용 저장 후 실행해 주십시오.", "W");
		return;
	}
    
    if(ds_rad_prh.CaseCount("FLAG!=''") > 0) {
		gfn_openMsgWin("변경사항이 있습니다. 변경 내용 저장 후 실행해 주십시오.", "W");
		return;
	}

	if(ds_ee_hpb_mod.CaseCount("FLAG!=''") > 0) {
		gfn_openMsgWin("변경사항이 있습니다. 변경 내용 저장 후 실행해 주십시오.", "W");
		return;
	}
		
	arg= "QTNUM=" + quote(ds_master.QTNUM);
	arg= arg + ", QTSER=" + quote(ds_master.QTSER);
	arg= arg + ", GSNAM=" + quote(ds_master.GSNAM);
	arg= arg + ", PM=" + quote(ds_master.PM);
	arg= arg + ", NAME1=" + quote(ds_master.NAME1);
	arg= arg + ", NAMET=" + quote(ds_master.NAMET);
	arg= arg + ", VBELN=" + quote(ds_master.VBELN);
	//수주 단계전 견적 단계 테스트를 위해서 주석 처리
	//arg= arg + ", VBELN=" + quote("");
	arg= arg + ", ZKUNNR=" + quote(ds_master.ZKUNNR);           
	arg= arg + ", QTSEQ=" + quote(ds_rad_list.GetColumn(nRow, "QTSEQ"));
	arg= arg + ", GTYPE=" + quote(ds_rad_list.GetColumn(nRow, "GTYPE"));	            
	arg= arg + ", ZUSE=" + quote(ds_rad_list.GetColumn(nRow, "ZUSE"));	            
	arg= arg + ", TYPE1=" + quote(ds_rad_list.GetColumn(nRow, "TYPE1"));
	arg= arg + ", TYPE2=" + quote(ds_rad_list.GetColumn(nRow, "TYPE2"));
	arg= arg + ", ECWTP=" + quote(ds_rad_list.GetColumn(nRow, "ECWTP"));
	arg= arg + ", CBRK=" + quote(ds_rad_list.GetColumn(nRow, "CBRK"));
	arg= arg + ", NOTICE=" + quote(ds_rad_list.GetColumn(nRow, "NOTICE"));
	arg= arg + ", HOGI=" + quote(ds_rad_list.GetColumn(nRow, "HOGI"));
	arg= arg + ", PRINT_HOGI=" + quote(ds_rad_list.GetColumn(nRow, "PRINT_HOGI"));	
	arg= arg + ", SUVSN=" + quote(ds_rad_list.GetColumn(nRow, "SUVSN"));
	arg= arg + ", BRNDCD=" + quote(ds_rad_list.GetColumn(nRow, "BRNDCD"));
	arg= arg + ", SUVNAM=" + quote(ds_rad_list.GetColumn(nRow, "SUVNAM"));
	arg= arg + ", SUVDAT=" + quote(ds_rad_list.GetColumn(nRow, "SUVDAT"));	   	            	            	            
	arg= arg + ", READONLY=" + quote("Y");
	//trace(arg);	

    
    //alert(nCell);
    var pagUrl = "PS11::PS1120002A.xml";
    var arr;
    
    switch(nCell) {
	    case 9:
			
	/*		if( b == "R" && c = "Y") {
			    pagUrl = "PS11::PS1120002A.xml";
			} if( b == "R" && c = "N") {
			    alert("후횡락(REAR(90°))의 경우 공용브라켓을 유로 변경해 주십시오.");
				break;
			} else if( b == "F/L" && c = "N") {
			    pagUrl = "PS11::PS1120002B.xml";
			} else if( b == "F/L" && c = "Y") {
			    pagUrl = "PS11::PS1120002C.xml";
			} else if( b == "F/R" && c = "N") {
			    pagUrl = "PS11::PS1120002D.xml";
			} else if( b == "F/R" && c = "Y") {
			    pagUrl = "PS11::PS1120002E.xml";
			}else if( b == "R/L" && c = "N") {
			    pagUrl = "PS11::PS1120002B.xml";	
			} else if( b == "R/L" && c = "Y") {
			    pagUrl = "PS11::PS1120002C.xml";
			} else if( b == "R/R" && c = "N") {
			    pagUrl = "PS11::PS1120002D.xml";
			} else if( b == "R/R" && c = "Y") {
			    pagUrl = "PS11::PS1120002E.xml";
			}
	   */
			
			
			arg = arg + ", CD_R_TYPE=" + quote("H");	
			arr = gfn_openPopupUrl(pagUrl, true, arg);
	        break;
	    case 10:
	        // 기계실
	        /*
			var pagUrl = "PS11::PS1120003A.xml";
			var arr;
			if( b == "R") {
			    pagUrl = "PS11::PS1120003A.xml";
			} else if( b == "F/L" || b=="R/L") {
			    pagUrl = "PS11::PS1120003B.xml";
			} else if( b == "F/R" || b=="R/R") {
			    pagUrl = "PS11::PS1120003C.xml";
			}
			*/
		
			arg = arg + ", CD_R_TYPE=" + quote("M");
			arr = gfn_openPopupUrl(pagUrl, true, arg);
	        break;
	    case 11:
	        // CWT 실측등록
		
			//var arr = gfn_openPopupUrl("PS11::PS1120004A.xml", true, arg);
			arg = arg + ", CD_R_TYPE=" + quote("C");
			//공통 페이지로 호출하기.
			arr = gfn_openPopupUrl(pagUrl, true, arg);
	        break;
	    case 12:
	        // 승장부문 실측등록
				
			
			//var arr = gfn_openPopupUrl("PS11::PS1120005A.xml", true, arg);
			arg = arg + ", CD_R_TYPE=" + quote("E");
			//공통 페이지로 호출하기.
			arr = gfn_openPopupUrl(pagUrl, true, arg);
	        break;

	    default  :
	        break;
	}
	if(arr == "Y") fn_query();
}

/********************************************************************************
* 기      능   : 리모델링LAYOUT
********************************************************************************/
function btn_rap_cal_OnClick(obj)
{
    for(var i =0 ; i < ds_rad_prh.GetRowCount(); i++) {
        ds_rad_prh.SetColumn(i, "FLAG", "U");
        ds_rad_prh.SetColumn(i, "G", "99");
        ds_rad_prh.SetColumn(i, "H", "99");
    }
}

/********************************************************************************
* 기      능   : LAYOUYT 체크
********************************************************************************/
function btn_rap_check_OnClick(obj)
{
    var arg = ""; 
	var arr = gfn_openPopupUrl("COM::Com0271.xml", true, arg);
}

/********************************************************************************
* 기      능   : 사양복사 화면 호출
********************************************************************************/
function btn_survey_copy_OnClick(obj)
{
	
	// 하나의 정보라도 변경된 정보가 있으면 체크하고 새로운 창을 띄우지 않는다. 
	for(var i=0; i< ds_rad_list.count; i++) {
	
		if(ds_rad_list.GetColumn(i, "FLAG")!="") {
			gfn_openMsgWin("변경사항이 있습니다. 변경 내용 저장 후 실행해 주십시오.", "W");
			return false;
		}
	
	 }
	 
	// 하나의 정보라도 변경된 정보가 있으면 체크하고 새로운 창을 띄우지 않는다. 
	for(var i=0; i< ds_rad_prh.count; i++) {
	
		if(ds_rad_prh.GetColumn(i, "FLAG")!="") {
			gfn_openMsgWin("변경사항이 있습니다. 변경 내용 저장 후 실행해 주십시오.", "W");
			return false;
		}
	
	 }
	 	 
	// 하나의 정보라도 변경된 정보가 있으면 체크하고 새로운 창을 띄우지 않는다. 
	for(var i=0; i< ds_ee_hpb_mod.count; i++) {
	
		if(ds_ee_hpb_mod.GetColumn(i, "FLAG")!="") {
			gfn_openMsgWin("변경사항이 있습니다. 변경 내용 저장 후 실행해 주십시오.", "W");
			return false;
		}
	
	 }	 
	
	var arg = "";
	
				arg= "QTNUM=" + quote(ds_master.QTNUM);
				arg= arg + ", QTSER=" + quote(ds_master.QTSER);
				arg= arg + ", GSNAM=" + quote(ds_master.GSNAM);
				arg= arg + ", PM=" + quote(ds_master.PM);
				arg= arg + ", NAME1=" + quote(ds_master.NAME1);
				arg= arg + ", NAMET=" + quote(ds_master.NAMET);
	            arg= arg + ", VBELN=" + quote(ds_master.VBELN);
	            arg= arg + ", ZKUNNR=" + quote(ds_master.ZKUNNR); 
	            //arg= arg + ", ds_rad_list=" + ds_rad_list;
	            
	            //trace(arg);
	
	var arr = gfn_openPopupUrl("PS11::PS1120001C.xml", true, arg);
	fn_query();
}

/********************************************************************************
* 기      능   : grid double click 시 조회 
********************************************************************************/
function fn_query2(nRow) {
	//ds_list2.ClearData();
	ds_rad_prh.ClearData();
	
	//trace("START Here");
	
	//trace(nRow);

//alert(ds_list.SaveXML());
	
	ds_cond2.ClearData();
	ds_cond2.AddRow();
	//ds_cond2.setColumn(0, "GBN", ds_list.GetColumn(nRow,"GBN"));
	ds_cond2.SetColumn(0,"MANDT",ds_master.MANDT);
	ds_cond2.SetColumn(0,"QTNUM",ds_master.QTNUM);
	ds_cond2.SetColumn(0,"QTSER",ds_master.QTSER);
	ds_cond2.SetColumn(0,"VBELN",ds_master.VBELN);
	ds_cond2.setColumn(0, "QTSEQ", ds_rad_list.GetColumn(nRow,"QTSEQ"));
	ds_cond2.setColumn(0, "PRINT_HOGI", ds_rad_list.GetColumn(nRow,"PRINT_HOGI"));
	ds_cond2.setColumn(0, "HOGI", ds_rad_list.GetColumn(nRow,"PRINT_HOGI"));
	ds_cond2.setColumn(0, "SUVSN", ds_rad_list.GetColumn(nRow,"SUVSN"));
	if(ds_rad_list.GetColumn(nRow,"SAPSEQ") == -1) {
		ds_cond2.setColumn(0, "SAPSEQ", 0);
	} else {
		ds_cond2.setColumn(0, "SAPSEQ", ds_rad_list.GetColumn(nRow,"SAPSEQ"));
	}
	
	var userId = ds_rad_list.GetColumn(nRow,"SUVNAM");
	if(Length(userId) > 0) {
        ds_master.USER_ID = userId;
	} else {
	    ds_master.USER_ID = G_USER_NAME;
	}
	//trace(ds_cond2.SaveXML());

	
//alert(ds_cond2.SaveXML());	
	
	tit_clearActionInfo();
	if(ds_master.VBELN !="" && ds_rad_list.GetColumn(nRow,"SAPSEQ") == -1) {
		tit_addSearchActionInfo("ps11:PS1120001B_S7", null, true);
	} else if(ds_master.VBELN !="" && ds_rad_list.GetColumn(nRow,"SAPSEQ") > -1)  {
		tit_addSearchActionInfo("ps11:PS1120001B_S8", null, true);
	} else {
		tit_addSearchActionInfo("ps11:PS1120001B_S6", null, true);
	}
	
	tit_callService(
        ""
        , ""
        , "ds_cond=ds_cond2"
        , "ds_rad_prh=ds_rad_prh"
        , ""
        , "fn_afterQuery2"
        , ""
        , ""
        , true);

    //trace("ds_rad_prh:"+ds_rad_prh.SaveXML());
}


/********************************************************************************
* 기      능   : 조회 Callback  
********************************************************************************/
function fn_afterQuery2(errCode, errMsg) {
	
	// 기존 자료와의 비교를 위해서 old로 복사해 둔다. 
	ds_rad_prh_old.copy(ds_rad_prh);
}


function fn_query3(nRow) {
	//ds_list2.ClearData();
	ds_ee_hpb.ClearData();
	
	//trace("START Here");
	
	//trace(nRow);

	//alert(ds_list.SaveXML());
	
	ds_cond2.ClearData();
	ds_cond2.AddRow();
	//ds_cond2.setColumn(0, "GBN", ds_list.GetColumn(nRow,"GBN"));
	ds_cond2.SetColumn(0, "MANDT",ds_master.MANDT);
	ds_cond2.SetColumn(0, "QTNUM",ds_master.QTNUM);
	ds_cond2.SetColumn(0, "QTSER",ds_master.QTSER);
	ds_cond2.SetColumn(0, "VBELN",ds_master.VBELN);
	ds_cond2.setColumn(0, "QTSEQ", ds_rad_list.GetColumn(nRow,"QTSEQ"));
	ds_cond2.setColumn(0, "PRINT_HOGI", ds_rad_list.GetColumn(nRow,"PRINT_HOGI"));	
	ds_cond2.setColumn(0, "HOGI", ds_rad_list.GetColumn(nRow,"PRINT_HOGI"));	
	ds_cond2.setColumn(0, "SUVSN", ds_rad_list.GetColumn(nRow,"SUVSN"));
	
	var SAPSEQ = ds_rad_list.GetColumn(nRow,"SAPSEQ");
	if(SAPSEQ == "-1") {
		ds_cond2.setColumn(0 ,"SAPSEQ" ,0);
		ds_cond2.setColumn(0 ,"SEQ"    ,0);
	} else {
		ds_cond2.setColumn(0 ,"SAPSEQ" ,SAPSEQ);
		ds_cond2.setColumn(0 ,"SEQ"    ,SAPSEQ);
	}
	
	//trace(ds_cond2.SaveXML());

	
//alert(ds_cond2.SaveXML());	
	
	tit_clearActionInfo();
	tit_addSearchActionInfo("ps11:PS1120001B_S4", null, true);
	
	if(!fn_isNull(ds_master.VBELN) && SAPSEQ == "-1") {
		tit_addSearchActionInfo("ps11:PS1120001B_S10");
		
	}else if(!fn_isNull(ds_master.VBELN) && SAPSEQ != "-1") {
		tit_addSearchActionInfo("ps11:PS1120001B_S11");
		
	}else {
		tit_addSearchActionInfo("ps11:PS1120001B_S9");
	}
	
	tit_callService(
        ""
        , ""
        , "ds_cond=ds_cond2"
        , "ds_excel_template=ds_excel_template ds_ee_hpb=ds_ee_hpb"
        , ""
        , "fn_afterQuery3"
        , ""
        , ""
        , true);
}


/********************************************************************************
* 기      능   : 조회 Callback  
********************************************************************************/
function fn_afterQuery3(errCode, errMsg) {
	
	//trace(ds_rad_prh.rowcount);
	//grd_rad_prh.SetCellProp("head",0,"text",ds_rad_prh.rowcount+" 건");
	//gfn_showMsg("CI00002",ds_list2.RowCount()+"");
	
	//trace(ds_excel_template.SaveXML()); 
}

function fn_query4(nRow) {
	//ds_list2.ClearData();
	ds_ee_hpb_mod.ClearData();
	
	//trace("START Here");
	
	//trace(nRow);

	//alert(ds_list.SaveXML());
	
	ds_cond2.ClearData();
	ds_cond2.AddRow();
	//ds_cond2.setColumn(0, "GBN", ds_list.GetColumn(nRow,"GBN"));
	ds_cond2.SetColumn(0,"MANDT",ds_master.MANDT);
	ds_cond2.SetColumn(0,"QTNUM",ds_master.QTNUM);
	ds_cond2.SetColumn(0,"QTSER",ds_master.QTSER);
	ds_cond2.SetColumn(0,"VBELN",ds_master.VBELN);
	ds_cond2.setColumn(0, "QTSEQ", ds_rad_list.GetColumn(nRow,"QTSEQ"));
	ds_cond2.setColumn(0, "PRINT_HOGI", ds_rad_list.GetColumn(nRow,"PRINT_HOGI"));	
	ds_cond2.setColumn(0, "SUVSN", ds_rad_list.GetColumn(nRow,"SUVSN"));
	
	//trace(ds_cond2.SaveXML());

	
	//alert(ds_cond2.SaveXML());	
	
	tit_clearActionInfo();
	tit_addSearchActionInfo("ps11:PS1120001B_S5", null, true);
	
	tit_callService(
        ""
        , ""
        , "ds_cond=ds_cond2"
        , "ds_ee_hpb_mod=ds_ee_hpb_mod"
        , ""
        , "fn_afterQuery4"
        , ""
        , ""
        , true);
     
                  
}


/********************************************************************************
* 기      능   : 조회 Callback  
********************************************************************************/
function fn_afterQuery4(errCode, errMsg) {
	// 기존 자료와의 비교를 위해서 old로 복사해 둔다. 
	ds_ee_hpb_mod_old.copy(ds_ee_hpb_mod);

}

/********************************************************************************
* 기      능   : grid double click 시  하위 그리드 조회 조회 
********************************************************************************/

function ds_rad_list_OnRowPosChanged(obj,nOldRow,nRow) {
	if(nRow > -1) {
		fn_query2(nRow);
		fn_query3(nRow);
		fn_query4(nRow);
	}
}

function grd_hpb_OnHScroll(obj,strType,nPos)
{
	if(sclgrid=="hpb") {
		grd_hbb_mod.HScrollPos = nPos;
	}
}


function grd_hpb_OnVScroll(obj,strType,nPos)
{
	if(sclgrid=="hpb") {
		grd_hbb_mod.VScrollPos = nPos;
	}
}




function grd_hbb_mod_OnHScroll(obj,strType,nPos)
{
	if(sclgrid=="hpb_mod") {
		grd_hpb.HScrollPos = nPos;
	}
}


function grd_hbb_mod_OnVScroll(obj,strType,nPos)
{
	if(sclgrid=="hpb_mod") {
		grd_hpb.VScrollPos = nPos;
	}
}

function grd_hpb_OnMouseOver(obj,nPosX,nPosY,nRow,nCell,nPivotIndex)
{
	sclgrid="hpb";
}

function grd_hbb_mod_OnMouseOver(obj,nPosX,nPosY,nRow,nCell,nPivotIndex)
{
	sclgrid="hpb_mod";
}

function ds_rad_prh_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{


		//trace("nRow" + nRow);
		//trace("strColumnID : " + strColumnID);
		//trace("varOldValue : " + trim(varOldValue));
		//trace("varNewValue : " + trim(varNewValue));
		
		//trace(ds_rad_prh.GetColumn(nRow,"FLAG"));
		
		
		var strOldRow = ds_rad_prh_old.GetColumn(nRow, "HOGI");
		strOldRow = strOldRow+"^"+ds_rad_prh_old.GetColumn(nRow, "SUVTYPE");
		strOldRow = strOldRow+"^"+ds_rad_prh_old.GetColumn(nRow, "SUVPRH");
		strOldRow = strOldRow+"^"+ds_rad_prh_old.GetColumn(nRow, "SUVPRHNAME");
		strOldRow = strOldRow+"^"+ds_rad_prh_old.GetColumn(nRow, "SUVPRD");
		strOldRow = strOldRow+"^"+ds_rad_prh_old.GetColumn(nRow, "CALPRD");
		strOldRow = strOldRow+"^"+ds_rad_prh_old.GetColumn(nRow, "MODYPRD");
		strOldRow = strOldRow+"^"+ds_rad_prh_old.GetColumn(nRow, "H");
		strOldRow = strOldRow+"^"+ds_rad_prh_old.GetColumn(nRow, "NOTICE");
		strOldRow = strOldRow+"^"+ds_rad_prh_old.GetColumn(nRow, "ERNAM");
		strOldRow = strOldRow+"^"+ds_rad_prh_old.GetColumn(nRow, "SUVSN");
		
		//trace(strOldRow);		
		
		
		var strNewRow = obj.GetColumn(nRow, "HOGI");
		strNewRow = strNewRow+"^"+obj.GetColumn(nRow, "SUVTYPE");
		strNewRow = strNewRow+"^"+obj.GetColumn(nRow, "SUVPRH");
		strNewRow = strNewRow+"^"+obj.GetColumn(nRow, "SUVPRHNAME");
		strNewRow = strNewRow+"^"+obj.GetColumn(nRow, "SUVPRD");
		strNewRow = strNewRow+"^"+obj.GetColumn(nRow, "CALPRD");
		strNewRow = strNewRow+"^"+obj.GetColumn(nRow, "MODYPRD");
		strNewRow = strNewRow+"^"+obj.GetColumn(nRow, "H");
		strNewRow = strNewRow+"^"+obj.GetColumn(nRow, "NOTICE");
		strNewRow = strNewRow+"^"+obj.GetColumn(nRow, "ERNAM");
		strNewRow = strNewRow+"^"+obj.GetColumn(nRow, "SUVSN");
		
		//trace(strNewRow);
		
		//trace(ds_rad_prh.GetColumn(nRow,"FLAG"));
		//trace(obj.GetColumn(nRow,"FLAG"));
		
		nRowNF= ds_rad_prh.SearchRowNF("SUVPRH=\"" +obj.GetColumn(nRow, "SUVPRH") + "\"");
		
		if(ds_rad_prh.GetColumnNF(nRowNF,"FLAG") =="I") {
		
		} else {
		
			if(trim(strOldRow) != trim(strNewRow)) {
			
				
				
				ds_rad_prh.SetColumnNF(nRowNF, "FLAG", "U");
				//trace("달라달라");
				//trace(obj.SaveXML());
			}else {
				ds_rad_prh.SetColumnNF(nRowNF, "FLAG", "");
			}
		}
		
		//trace(ds_rad_prh.saveXML());
		
		//trace(ds_rad_prh.GetColumn(nRow, "FLAG"));
		//trace(obj.GetColumn(nRow, "FLAG"));
	
}

function ds_ee_hpb_mod_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{

//trace("nRow" + nRow);
		//trace("strColumnID : " + strColumnID);
		//trace("varOldValue : " + trim(varOldValue));
		//trace("varNewValue : " + trim(varNewValue));
		
		
		var strOldRow = ds_ee_hpb_mod_old.GetColumn(nRow, "MANDT");
		strOldRow = strOldRow+"^"+ds_ee_hpb_mod_old.GetColumn(nRow, "SUVSN");
		strOldRow = strOldRow+"^"+ds_ee_hpb_mod_old.GetColumn(nRow, "INORDER");
		strOldRow = strOldRow+"^"+ds_ee_hpb_mod_old.GetColumn(nRow, "APPLYFLOOR");
		strOldRow = strOldRow+"^"+ds_ee_hpb_mod_old.GetColumn(nRow, "ELR_E_IDTP");
		strOldRow = strOldRow+"^"+ds_ee_hpb_mod_old.GetColumn(nRow, "ELR_E_HLLC");
		strOldRow = strOldRow+"^"+ds_ee_hpb_mod_old.GetColumn(nRow, "ELR_E_FLSC");
		strOldRow = strOldRow+"^"+ds_ee_hpb_mod_old.GetColumn(nRow, "ELR_E_A");
		strOldRow = strOldRow+"^"+ds_ee_hpb_mod_old.GetColumn(nRow, "ELR_E_B");
		strOldRow = strOldRow+"^"+ds_ee_hpb_mod_old.GetColumn(nRow, "ELR_E_C");
		strOldRow = strOldRow+"^"+ds_ee_hpb_mod_old.GetColumn(nRow, "ELR_E_D");
		strOldRow = strOldRow+"^"+ds_ee_hpb_mod_old.GetColumn(nRow, "ELR_E_E");
		strOldRow = strOldRow+"^"+ds_ee_hpb_mod_old.GetColumn(nRow, "ELR_E_F");				
		strOldRow = strOldRow+"^"+ds_ee_hpb_mod_old.GetColumn(nRow, "ELR_E_BXD");				
		strOldRow = strOldRow+"^"+ds_ee_hpb_mod_old.GetColumn(nRow, "ELR_E_H");								
		
		//trace(strOldRow);		
		
		
		var strNewRow = obj.GetColumn(nRow, "MANDT");
		strNewRow = strNewRow+"^"+obj.GetColumn(nRow, "SUVSN");
		strNewRow = strNewRow+"^"+obj.GetColumn(nRow, "INORDER");
		strNewRow = strNewRow+"^"+obj.GetColumn(nRow, "APPLYFLOOR");
		strNewRow = strNewRow+"^"+obj.GetColumn(nRow, "ELR_E_IDTP");
		strNewRow = strNewRow+"^"+obj.GetColumn(nRow, "ELR_E_HLLC");
		strNewRow = strNewRow+"^"+obj.GetColumn(nRow, "ELR_E_FLSC");
		strNewRow = strNewRow+"^"+obj.GetColumn(nRow, "ELR_E_A");
		strNewRow = strNewRow+"^"+obj.GetColumn(nRow, "ELR_E_B");
		strNewRow = strNewRow+"^"+obj.GetColumn(nRow, "ELR_E_C");
		strNewRow = strNewRow+"^"+obj.GetColumn(nRow, "ELR_E_D");
		strNewRow = strNewRow+"^"+obj.GetColumn(nRow, "ELR_E_E");
		strNewRow = strNewRow+"^"+obj.GetColumn(nRow, "ELR_E_F");
		strNewRow = strNewRow+"^"+obj.GetColumn(nRow, "ELR_E_BXD");
		strNewRow = strNewRow+"^"+obj.GetColumn(nRow, "ELR_E_H");								
		
		//trace(strNewRow);
		
		if(ds_ee_hpb_mod.GetColumn(nRow,"FLAG") =="I") {
		
		} else {
		
			if(trim(strOldRow) != trim(strNewRow)) {
				
				ds_ee_hpb_mod.SetColumn(nRow, "FLAG", "U");
				//trace("달라달라");
				//trace(obj.SaveXML());
			}else {
				ds_ee_hpb_mod.SetColumn(nRow, "FLAG", "");
			}
		}
		
		//trace(ds_ee_hpb_mod.GetColumn(nRow, "FLAG"));
		//trace(obj.GetColumn(nRow, "FLAG"));
	
}

//수정,입력 필수 체크하는 함수
function fn_checkModifyList_rad(){
	for(var i=0;i<ds_rad_list.GetRowCount();i++){
		if((ds_rad_list.GetColumn(i,"QTSER")==null || ds_rad_suvprh_list.GetColumn(i,"QTSER")=="") && (ds_rad_list.GetColumn(i,"HOGI")==null || ds_rad_list.GetColumn(i,"HOGI")=="")){
			gfn_showAlert("CW00001", "견적순번/호기");		
			return false;		
		}		
	}
	if ( !gfn_isChangeDs(ds_rad_list, true, "FLAG") ) {
		return false;
	}

	return true;
}


function fn_existCheck_rad(code1){
	ds_cntCond.SetColumn(0,"CODE1",code1);
	tit_clearActionInfo();
	tit_addSearchActionInfo("ps11:PS1130001A_S4");
		
	tit_callService(
		""
		, ""
		, "ds_cntCond=ds_cntCond"
		, "ds_cnt=ds_cnt"
		, ""
		, ""
		, true
		, true
		, true);
	
}

function fn_afterModify_rad(errCode, errMsg){

	//trace("fn_afterModify_rad errCode : " + errCode);
	
	fn_afterSave(errCode, errMsg);
	

	
}


/********************************************************************************
* 기      능   : 저장 Callback  
********************************************************************************/
function fn_afterSave(errCode, errMsg) {
	//trace("erroCode : " + errCode);
	if(errCode != "0") {
		gfn_showAlert("CE00001");

	}else {
		gfn_showAlert("CI00003");
		fn_query_code("DATA_DIVS,DATA_ITEM,CD_I_TYPE");

		fn_query();
		fn_query2();
		fn_query3();
	}
}

function fn_save() {
	// 보정값이 등록 됐을경우, 연산식으로 그 값이 적절한지 체크.
	if(!fn_input_formula()) return;
	
	//사양에서 변경된 값이 있는지 체크 한다. 
	//var rad1=fn_checkModifyList_rad();
		
	  //사양에서 변경된 값이 있는지 체크 한다. 
	 //var prh1=fn_checkModifyList_Prh();
	  //표시기에서 변경된 값이 있는지 체크 한다. 
	 //var hpb1=fn_checkModifyList_hpb();
	 // 표시기 저장할 데이터를 생성한다.
	 fn_checkModifyList_hpb();
	 
	 
	 if(!ds_rad_list.GetUpdate() && !ds_rad_prh.GetUpdate() && !ds_ee_hpb_mod.GetUpdate()) {
		gfn_showAlert("CW00005");
		return false;
	 }
	 
	 // 둘다 변경 내용이 없을때 저장 기능을 멈춘다.
	 //if((rad1 +prh1+hpb1) == 0 ){
	//	gfn_showAlert("CW00005");
	//	return false;
	 //}
	 
	//마스터 그리드 저장.
	var queryi="";
	var queryu="ps11:PS1120001A_I1";
	var queryd="";
	
	if(VBELN != "") {
		queryi="";
		queryu="ps11:PS1120001A_I2";
		queryd="";		
	}
	

	if(ds_rad_list.GetUpdate()) {
		tit_clearActionInfo();
		tit_addSaveActionInfo(
			queryi
			, queryu
			, queryd
			, "FLAG"
			);
			
			//trace(ds_rad_suvprh_list.SaveXML());
			
			ds_rad_list.saveXML();
	
		// 저장 처리 
		tit_callService(
			""
			, ""
			, "ds_list=ds_rad_list:A"
			, ""
			, ""
			, "fn_afterModify_rad"
			, true
			, true
			, true			        
			);
	}	 
	 
	 // 사양에서 변경된 값이 있으면 저장 쿼리를 실행한다. 
	 if(ds_rad_prh.GetUpdate()) {
	 //trace("737 ::: ");

	 	tit_clearActionInfo();
		tit_addSaveActionInfo(
			""
			, "ps11:PS1120001B_I1"
			, ""
			, "FLAG"
			);
			
			//trace(ds_rad_prh.SaveXML());
	
		// 저장 처리 
		tit_callService(
			""
			, ""
			, "ds_list=ds_rad_prh:A"
			, ""
			//, "WSUVPRH="+quote(ds_rad_suvprh_list.GetColumn(ds_rad_suvprh_list.currow,"SUVPRH"))+" CTEXT1="+quote(ed_codeName.Text)+" LANG="+quote(cb_lang.Value)
			, "WSUVPRH="+quote(ds_rad_prh.GetColumn(ds_rad_prh.currow,"SUVPRH"))
			, "fn_afterSavePrh2"        
			);
	}
	
	 // 표시기에서 변경된 값이 있으면 저장 쿼리를 수행한다. 
	 if(ds_ee_hpb_mod.GetUpdate()) {

	 		tit_clearActionInfo();
		    tit_addSaveActionInfo(
			""
			, "ps11:PS1120001B_I2"
			, ""
			, "FLAG"
			);

		// 저장 처리 
		tit_callService(
			""
			, ""
			, "ds_list=ds_ee_dummy:A"
			, ""
			//, "WSUVPRH="+quote(ds_rad_suvprh_list.GetColumn(ds_rad_suvprh_list.currow,"SUVPRH"))+" CTEXT1="+quote(ed_codeName.Text)+" LANG="+quote(cb_lang.Value)
			, "WSUVSN="+quote(ds_ee_hpb_mod.GetColumn(ds_ee_hpb_mod.currow,"SUVSN"))
			, "fn_afterSavePrh4"        
			);
	}
		
}

function fn_afterSavePrh2(errCode, errMsg) {
    
	if(errCode != "0") {
		gfn_showAlert("CE00001");
	} else {
		// 성장적으로 처리되면 다시 조회한다.
	    if(!ds_ee_hpb_mod.GetUpdate()) {
		    gfn_openMsgWin("실측보정값이 저장 되었습니다.", "I");
		} 
		fn_query2(ds_rad_list.currow);
	}
}

function fn_afterSavePrh4(errCode, errMsg) {
	if(errCode != "0") {
		gfn_showAlert("CE00001");
	} else {
	    // 실측보정값이 저장 되었습니다.
		gfn_openMsgWin("실측보정값이 저장 되었습니다.", "I");
		// 성장적으로 처리되면 다시 조회한다.
	    fn_query4(ds_rad_list.currow);
	}
}

// 보정값이 등록 됐을경우, 연산식으로 그 값이 적절한지 체크.
function fn_input_formula() {
	// 실측A+ Car Rail 가로 + 실측치BG/2 -JJ/2	실측치 LL값과 비교하여 50mm 이하 차이 날 것 ( 불만족 시 경고 )
	var ds   = ds_rad_prh;
	var fRow = ds.FindRow("SUVPRH", "ELR_H_A");
	var H_A  = parseInt(ds.GetColumn(fRow ,"MODYPRD"));
	    H_A  = decode(H_A, 0, parseInt(ds.GetColumn(fRow ,"SUVPRD")), H_A);

        fRow    = ds.FindRow("SUVPRH", "ELR_H_CARBG");
	var H_CARBG = parseInt(ds.GetColumn(fRow ,"MODYPRD"));
	    H_CARBG = decode(H_CARBG, 0, parseInt(ds.GetColumn(fRow ,"SUVPRD")), H_CARBG);

        fRow = ds.FindRow("SUVPRH", "ELR_H_JJ");
	var H_JJ = parseInt(ds.GetColumn(fRow ,"MODYPRD"));
	    H_JJ = decode(H_JJ, 0, parseInt(ds.GetColumn(fRow ,"SUVPRD")), H_JJ);	
	
	    fRow = ds.FindRow("SUVPRH", "ELR_H_LL");
	var H_LL = parseInt(ds.GetColumn(fRow ,"MODYPRD"));
	    H_LL = decode(H_LL, 0, parseInt(ds.GetColumn(fRow ,"SUVPRD")), H_LL);
	    
	    fRow      = ds.FindRow("SUVPRH", "ELR_H_CARRAIL");
	var H_CARRAIL = ds.GetColumn(fRow ,"MODYPRD");
	    H_CARRAIL = decode(fn_isNull(H_CARRAIL), true, ds.GetColumn(fRow ,"SUVPRD"), H_CARRAIL);
	var H_CAR_A   = parseInt(ds_car_rail.GetColumn(ds_car_rail.FindRow("rail", H_CARRAIL)  ,"a"));	
	
	// 실측B+ Car Rail 가로 + 실측치BG/2 -JJ/2	실측치 RL값과 비교하여 50mm 이하 차이 날 것 ( 불만족 시 경고 )
	    fRow = ds.FindRow("SUVPRH", "ELR_H_B");
	var H_B  = parseInt(ds.GetColumn(fRow ,"MODYPRD"));
	    H_B  = decode(H_B, 0, parseInt(ds.GetColumn(fRow ,"SUVPRD")), H_B);
	    
	    fRow = ds.FindRow("SUVPRH", "ELR_H_RL");
	var H_RL = parseInt(ds.GetColumn(fRow ,"MODYPRD"));
	    H_RL = decode(H_RL, 0, parseInt(ds.GetColumn(fRow ,"SUVPRD")), H_RL);
	
	//(실측치CA-실측치JJ) / 2 와 일치 여부 검토 ( 오차 10mm )
	    fRow = ds.FindRow("SUVPRH", "ELR_H_CA");
	var H_CA = parseInt(ds.GetColumn(fRow ,"MODYPRD"));
	    H_CA = decode(H_CA, 0, parseInt(ds.GetColumn(fRow ,"SUVPRD")), H_CA);
	
	    fRow = ds.FindRow("SUVPRH", "ELR_H_W1");
	var H_W1 = parseInt(ds.GetColumn(fRow ,"MODYPRD"));
	    H_W1 = decode(H_W1, 0, parseInt(ds.GetColumn(fRow ,"SUVPRD")), H_W1);
	
	// 검토용. H=J 확인 할 것. ( 불만족 시 경고 )
	    fRow = ds.FindRow("SUVPRH", "ELR_H_H");
	var H_H  = parseInt(ds.GetColumn(fRow ,"MODYPRD"));
	    H_H  = decode(H_H, 0, parseInt(ds.GetColumn(fRow ,"SUVPRD")), H_H);
	
	   fRow = ds.FindRow("SUVPRH", "ELR_H_J");
	var H_J = parseInt(ds.GetColumn(fRow ,"MODYPRD"));
	    H_J = decode(H_J, 0, parseInt(ds.GetColumn(fRow ,"SUVPRD")), H_J);
	
	// X 계산식 적용	실측A+실측B+(Car Rail 가로 x2) + 실측치 BG	실측치 X와 비교차여 오차200mm 이하 검토. ( 불만족 시 경고 )
	   fRow = ds.FindRow("SUVPRH", "ELR_H_X");
	var H_X = parseInt(ds.GetColumn(fRow ,"MODYPRD"));
	    H_X = decode(H_X, 0, parseInt(ds.GetColumn(fRow ,"SUVPRD")), H_X);
	
	// Y 계산식 적용	실측C+실측E+실측PP+실측F	실측치 Y와 비교차여 오차200mm 이하 검토. ( 불만족 시 경고 )	
	    fRow = ds.FindRow("SUVPRH", "ELR_H_C");
	var H_C  = parseInt(ds.GetColumn(fRow  ,"MODYPRD"));
	    H_C  = decode(H_C, 0, parseInt(ds.GetColumn(fRow ,"SUVPRD")), H_C);
	
	    fRow = ds.FindRow("SUVPRH", "ELR_H_E");
	var H_E  = parseInt(ds.GetColumn(fRow  ,"MODYPRD"));
	    H_E  = decode(H_E, 0, parseInt(ds.GetColumn(fRow ,"SUVPRD")), H_E);
	
	    fRow = ds.FindRow("SUVPRH", "ELR_H_PP");
	var H_PP = parseInt(ds.GetColumn(fRow ,"MODYPRD"));
	    H_PP = decode(H_PP, 0, parseInt(ds.GetColumn(fRow ,"SUVPRD")), H_PP);
	
	    fRow = ds.FindRow("SUVPRH", "ELR_H_F");
	var H_F  = parseInt(ds.GetColumn(fRow ,"MODYPRD"));
	    H_F  = decode(H_F, 0, parseInt(ds.GetColumn(fRow ,"SUVPRD")), H_F);
	
	    fRow = ds.FindRow("SUVPRH", "ELR_H_Y");
	var H_Y  = parseInt(ds.GetColumn(fRow ,"MODYPRD"));
	    H_Y  = decode(H_Y, 0, parseInt(ds.GetColumn(fRow ,"SUVPRD")), H_Y);
	
	for(var i = 0; i < ds_formula.GetRowCount(); i ++) {
		var result    = eval(ds_formula.GetColumn(i, "formula"));
		//trace("result >> "+result);
		if(result > parseInt(ds_formula.GetColumn(i, "range"))) {
			var msg = ds_formula.GetColumn(i, "message");
			    msg = replace(msg, "$1", result);
			gfn_openMsgWin(msg, "W");
			return false;
		}
	}
	
	return true;
}
//수정,입력 필수 체크하는 함수
function fn_checkModifyList_Prh(){
	for(var i=0;i<ds_rad_prh.GetRowCount();i++){
		if(ds_rad_prh.GetColumn(i,"SUVPRH")==null || ds_rad_prh.GetColumn(i,"SUVPRH")==""){
			gfn_showAlert("CW00001", "실측사양");		
			return false;		
		}
	}

	if ( !gfn_isChangeDs(ds_rad_prh, false, "FLAG") ) {
		return 0;
	}
	
	return 1;
}

//수정,입력 필수 체크하는 함수
function fn_checkModifyList_Rad(){
	for(var i=0;i<ds_rad_list.GetRowCount();i++){
		if(ds_rad_list.GetColumn(i,"HOGI")==null || ds_rad_list.GetColumn(i,"HOGI")==""){
			gfn_showAlert("CW00001", "호기");		
			return false;		
		}
	}
	if ( !gfn_isChangeDs(ds_rad_list, false, "FLAG") ) {
		return 0;
	}

	return 1;
}


//수정,입력 필수 체크하는 함수
function fn_checkModifyList_hpb(){
	ds_ee_dummy.ClearData();
	for(var i=0;i<ds_ee_hpb_mod.GetRowCount();i++){
		
		if(ds_ee_hpb_mod.GetColumn(i,"APPLYFLOOR")==null || ds_ee_hpb_mod.GetColumn(i,"APPLYFLOOR")==""){
			gfn_showAlert("CW00001", "적용층");		
			return false;		
		}		
		
		
		
		var suvsn = ds_ee_hpb_mod.GetColumn(i,"SUVSN");
		var applyfloor = ds_ee_hpb_mod.GetColumn(i,"APPLYFLOOR");
		
		
		
		if(ds_ee_hpb_mod.GetColumn(i,"FLAG")=="U") {
		
			//trace(ds_ee_hpb_mod.colcount);
		
			for(var j =0; j<ds_ee_hpb_mod.colcount; j++) {
			
			
				
				if(ds_ee_hpb_mod.GetColID(j) !="MANDT" && ds_ee_hpb_mod.GetColID(j) !="FLAG" && ds_ee_hpb_mod.GetColID(j) !="INORDER" && ds_ee_hpb_mod.GetColID(j) !="SUVSN" && ds_ee_hpb_mod.GetColID(j) !="APPLYFLOOR"   ) {
					var row=ds_ee_dummy.AddRow();
					ds_ee_dummy.SetColumn(row,"MANDT", G_MANDT);
					ds_ee_dummy.SetColumn(row,"FLAG", "U");
					ds_ee_dummy.SetColumn(row,"INORDER", ds_ee_hpb_mod.GetColumn(i,"INORDER"));
					ds_ee_dummy.SetColumn(row,"SUVSN", suvsn);
					ds_ee_dummy.SetColumn(row,"APPLYFLOOR", applyfloor);
					ds_ee_dummy.SetColumn(row,"SUVPRH", ds_ee_hpb_mod.GetColID(j));
					ds_ee_dummy.SetColumn(row,"SUVPRD",  ds_ee_hpb.GetColumn(i,ds_ee_hpb_mod.GetColID(j)));
					if(ds_ee_hpb.GetColumn(i,ds_ee_hpb_mod.GetColID(j)) == ds_ee_hpb_mod.GetColumn(i,ds_ee_hpb_mod.GetColID(j))) {
					    ds_ee_dummy.SetColumn(row,"MODYPRD", "");
					} else {
					    ds_ee_dummy.SetColumn(row,"MODYPRD", ds_ee_hpb_mod.GetColumn(i,ds_ee_hpb_mod.GetColID(j)));
					}
					//trace(ds_ee_hpb_mod.getColId(j));
					//trace(ds_ee_hpb.GetColumn(i,ds_ee_hpb_mod.GetColID(j)));
					//trace(ds_ee_hpb_mod.GetColumn(i,ds_ee_hpb_mod.GetColID(j)));
				}
			}
			//trace(ds_ee_dummy.SaveXML());
		}
	}
	if ( !gfn_isChangeDs(ds_ee_hpb_mod, false, "FLAG") ) {
		return 0;
	}

	return 1;
}


function ds_rad_list_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{

		//trace("nRow" + nRow);
		//trace("strColumnID : " + strColumnID);
		//trace("varOldValue : " + trim(varOldValue));
		//trace("varNewValue : " + trim(varNewValue));
		
		
		var strOldRow = ds_rad_list_old.GetColumn(nRow, "MANDT");
		strOldRow = strOldRow+"^"+ds_rad_list_old.GetColumn(nRow, "QTNUM");
		strOldRow = strOldRow+"^"+ds_rad_list_old.GetColumn(nRow, "QTSEQ");
		strOldRow = strOldRow+"^"+ds_rad_list_old.GetColumn(nRow, "QTSER");
		strOldRow = strOldRow+"^"+ds_rad_list_old.GetColumn(nRow, "VBELN");
		strOldRow = strOldRow+"^"+ds_rad_list_old.GetColumn(nRow, "HOGI");
		strOldRow = strOldRow+"^"+ds_rad_list_old.GetColumn(nRow, "ECWTP");
		strOldRow = strOldRow+"^"+ds_rad_list_old.GetColumn(nRow, "CBRK");
		strOldRow = strOldRow+"^"+ds_rad_list_old.GetColumn(nRow, "CRST");
		strOldRow = strOldRow+"^"+ds_rad_list_old.GetColumn(nRow, "ERST");
		strOldRow = strOldRow+"^"+ds_rad_list_old.GetColumn(nRow, "HRST");
		strOldRow = strOldRow+"^"+ds_rad_list_old.GetColumn(nRow, "MRST");
		strOldRow = strOldRow+"^"+ds_rad_list_old.GetColumn(nRow, "NECYSNO");
		strOldRow = strOldRow+"^"+ds_rad_list_old.GetColumn(nRow, "NOTICE");
		strOldRow = strOldRow+"^"+ds_rad_list_old.GetColumn(nRow, "SUVST");
		strOldRow = strOldRow+"^"+ds_rad_list_old.GetColumn(nRow, "GTYPE");
		strOldRow = strOldRow+"^"+ds_rad_list_old.GetColumn(nRow, "ZUSE");
		strOldRow = strOldRow+"^"+ds_rad_list_old.GetColumn(nRow, "TYPE1");
		strOldRow = strOldRow+"^"+ds_rad_list_old.GetColumn(nRow, "TYPE2");
		strOldRow = strOldRow+"^"+ds_rad_list_old.GetColumn(nRow, "SUVDAT");
		strOldRow = strOldRow+"^"+ds_rad_list_old.GetColumn(nRow, "SUVSN");
		strOldRow = strOldRow+"^"+ds_rad_list_old.GetColumn(nRow, "HOGI");
		strOldRow = strOldRow+"^"+ds_rad_list_old.GetColumn(nRow, "BRNDCD");
		strOldRow = strOldRow+"^"+ds_rad_list_old.GetColumn(nRow, "ERDAT");
		strOldRow = strOldRow+"^"+ds_rad_list_old.GetColumn(nRow, "SUVNAM");
		strOldRow = strOldRow+"^"+ds_rad_list_old.GetColumn(nRow, "PRINT_HOGI");
		strOldRow = strOldRow+"^"+ds_rad_list_old.GetColumn(nRow, "AEDAT");
		strOldRow = strOldRow+"^"+ds_rad_list_old.GetColumn(nRow, "AEZET");
		strOldRow = strOldRow+"^"+ds_rad_list_old.GetColumn(nRow, "AENAM");
		
		//trace(strOldRow);		
		
		
		var strNewRow = obj.GetColumn(nRow, "MANDT");
		strNewRow = strNewRow+"^"+obj.GetColumn(nRow, "QTNUM");
		strNewRow = strNewRow+"^"+obj.GetColumn(nRow, "QTSEQ");
		strNewRow = strNewRow+"^"+obj.GetColumn(nRow, "QTSER");
		strNewRow = strNewRow+"^"+obj.GetColumn(nRow, "VBELN");
		strNewRow = strNewRow+"^"+obj.GetColumn(nRow, "HOGI");
		strNewRow = strNewRow+"^"+obj.GetColumn(nRow, "ECWTP");
		strNewRow = strNewRow+"^"+obj.GetColumn(nRow, "CBRK");
		strNewRow = strNewRow+"^"+obj.GetColumn(nRow, "CRST");
		strNewRow = strNewRow+"^"+obj.GetColumn(nRow, "ERST");
		strNewRow = strNewRow+"^"+obj.GetColumn(nRow, "HRST");
		strNewRow = strNewRow+"^"+obj.GetColumn(nRow, "MRST");
		strNewRow = strNewRow+"^"+obj.GetColumn(nRow, "NECYSNO");		
		strNewRow = strNewRow+"^"+obj.GetColumn(nRow, "NOTICE");
		strNewRow = strNewRow+"^"+obj.GetColumn(nRow, "SUVST");
		strNewRow = strNewRow+"^"+obj.GetColumn(nRow, "GTYPE");
		strNewRow = strNewRow+"^"+obj.GetColumn(nRow, "ZUSE");
		strNewRow = strNewRow+"^"+obj.GetColumn(nRow, "TYPE1");
		strNewRow = strNewRow+"^"+obj.GetColumn(nRow, "TYPE2");
		strNewRow = strNewRow+"^"+obj.GetColumn(nRow, "SUVDAT");
		strNewRow = strNewRow+"^"+obj.GetColumn(nRow, "SUVSN");
		strNewRow = strNewRow+"^"+obj.GetColumn(nRow, "HOGI");
		strNewRow = strNewRow+"^"+obj.GetColumn(nRow, "BRNDCD");
		strNewRow = strNewRow+"^"+obj.GetColumn(nRow, "ERDAT");		
		strNewRow = strNewRow+"^"+obj.GetColumn(nRow, "SUVNAM");
		strNewRow = strNewRow+"^"+obj.GetColumn(nRow, "PRINT_HOGI");
		strNewRow = strNewRow+"^"+obj.GetColumn(nRow, "AEDAT");
		strNewRow = strNewRow+"^"+obj.GetColumn(nRow, "AEZET");
		strNewRow = strNewRow+"^"+obj.GetColumn(nRow, "AENAM");		
		
		//trace(strNewRow);
		
		if(ds_rad_list.GetColumn(nRow,"FLAG") =="I") {
		
		} else {
		
			if(trim(strOldRow) != trim(strNewRow)) {
				
				ds_rad_list.SetColumn(nRow, "FLAG", "U");
				//trace("달라달라");
				//trace(obj.SaveXML());
			}else {
				ds_rad_list.SetColumn(nRow, "FLAG", "");
			}
		}
		
		//trace(ds_rad_list.GetColumn(nRow, "FLAG"));
		//trace(ds_rad_list.GetColumn(nRow, "NECYSNO"));
		//trace(ds_rad_list.GetColumn(nRow, "INPUTYSNO"));
		//trace(obj.GetColumn(nRow, "FLAG"));
		//trace(obj.GetColumn(nRow, "NECYSNO"));		
		//trace(ds_rad_list.GetColumn(nRow, "INPUTYSNO"));	
	
}

// 값이 NULL이면 true, NULL이 아니면 false
function fn_isNull(str) {
	if(length(trim(str)) < 1) return true;
	return false;
}

/********************************************************************************
* 기      능   : 액셀  
********************************************************************************/
function fn_excel() {
	if (ds_excel_template.RowCount() > 0)
		gfn_exportExcel(grd_excel, "리모델링 실측 데이터");
	else
		gfn_showAlert("CW00010");
}
]]></Script>
</Window>