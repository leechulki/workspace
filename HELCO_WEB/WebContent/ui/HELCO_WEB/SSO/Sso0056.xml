<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="440" Id="Form" Left="8" OnLoadCompleted="fn_OnLoadCompleted" OnUnloadCompleted="fn_OnUnloadCompleted" PidAttrib="7" Title="순번이동" Top="8" Ver="1.0" Width="1000" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_mv_ZSDT0090">
				<Contents>
					<colinfo id="MANDT" size="9" summ="default" type="STRING"/>
					<colinfo id="VBELN" size="30" summ="default" type="STRING"/>
					<colinfo id="PSPID" size="72" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="5" summ="default" type="DECIMAL"/>
					<colinfo id="BSTNK" size="256" summ="default" type="STRING"/>
					<colinfo id="BEXEC" size="1" summ="default" type="STRING"/>
					<colinfo id="DYN" size="1" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_mv_ZSDT0091" OnColumnChanged="ds_mv_ZSDT0091_OnColumnChanged">
				<Contents>
					<colinfo id="FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="MANDT" size="9" summ="default" type="STRING"/>
					<colinfo id="VBELN" size="30" summ="default" type="STRING"/>
					<colinfo id="PSPID" size="72" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="5" summ="default" type="DECIMAL"/>
					<colinfo id="SEQN" size="5" summ="default" type="DECIMAL"/>
					<colinfo id="POSNR" size="18" summ="default" type="STRING"/>
					<colinfo id="HOGI" size="72" summ="default" type="STRING"/>
					<colinfo id="ARKTX" size="120" summ="default" type="STRING"/>
					<colinfo id="MVSEQN" size="5" summ="default" type="DECIMAL"/>
					<colinfo id="MVPOSNR" size="18" summ="default" type="STRING"/>
					<colinfo id="MVHOGI" size="72" summ="default" type="STRING"/>
					<colinfo id="MVARKTX" size="120" summ="default" type="STRING"/>
					<colinfo id="VIEWSEQN" size="256" summ="default" type="STRING"/>
					<colinfo id="VIEWHOGI" size="256" summ="default" type="STRING"/>
					<colinfo id="VIEWARKTX" size="256" summ="default" type="STRING"/>
					<colinfo id="BEXEC" size="1" summ="default" type="STRING"/>
					<colinfo id="MVFLAG" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_in_ZSDS0063">
				<Contents>
					<colinfo id="VBELN" size="256" summ="default" type="STRING"/>
					<colinfo id="PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="AUART" size="256" summ="default" type="STRING"/>
					<colinfo id="SPART" size="256" summ="default" type="STRING"/>
					<colinfo id="VKBUR" size="256" summ="default" type="STRING"/>
					<colinfo id="VKBURT" size="256" summ="default" type="STRING"/>
					<colinfo id="ZKUNNR" size="256" summ="default" type="STRING"/>
					<colinfo id="ZKUNNRT" size="256" summ="default" type="STRING"/>
					<colinfo id="KUNRG" size="256" summ="default" type="STRING"/>
					<colinfo id="KUNRG_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="KUNWE" size="256" summ="default" type="STRING"/>
					<colinfo id="KUNWE_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="KUNZ1" size="256" summ="default" type="STRING"/>
					<colinfo id="KUNZ2" size="256" summ="default" type="STRING"/>
					<colinfo id="KUNZ3" size="256" summ="default" type="STRING"/>
					<colinfo id="TELF1" size="256" summ="default" type="STRING"/>
					<colinfo id="BSTNK" size="256" summ="default" type="STRING"/>
					<colinfo id="BRAN1" size="256" summ="default" type="STRING"/>
					<colinfo id="BSTDK" size="256" summ="default" type="STRING"/>
					<colinfo id="ZQNTY" size="256" summ="default" type="STRING"/>
					<colinfo id="NETWR" size="256" summ="default" type="STRING"/>
					<colinfo id="WAVWR" size="256" summ="default" type="STRING"/>
					<colinfo id="COMMI" size="256" summ="default" type="STRING"/>
					<colinfo id="VDATU" size="256" summ="default" type="STRING"/>
					<colinfo id="WAERK" size="256" summ="default" type="STRING"/>
					<colinfo id="ZTERM" size="256" summ="default" type="STRING"/>
					<colinfo id="INCO1" size="256" summ="default" type="STRING"/>
					<colinfo id="INCO2" size="256" summ="default" type="STRING"/>
					<colinfo id="WWBLD" size="256" summ="default" type="STRING"/>
					<colinfo id="REPMO" size="256" summ="default" type="STRING"/>
					<colinfo id="GUAMO" size="256" summ="default" type="STRING"/>
					<colinfo id="ZAPDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="STADA" size="256" summ="default" type="STRING"/>
					<colinfo id="WORMO" size="256" summ="default" type="STRING"/>
					<colinfo id="REGION" size="256" summ="default" type="STRING"/>
					<colinfo id="HIGH_G" size="256" summ="default" type="STRING"/>
					<colinfo id="ADMITNO" size="256" summ="default" type="STRING"/>
					<colinfo id="CHEOR" size="256" summ="default" type="STRING"/>
					<colinfo id="COMPL_DA" size="256" summ="default" type="STRING"/>
					<colinfo id="FINAL_DA" size="256" summ="default" type="STRING"/>
					<colinfo id="ENFOR" size="256" summ="default" type="STRING"/>
					<colinfo id="TURNKEY" size="256" summ="default" type="STRING"/>
					<colinfo id="KISCON" size="256" summ="default" type="STRING"/>
					<colinfo id="HEL_REG" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNR2" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNR3" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNRCHK" size="256" summ="default" type="STRING"/>
					<colinfo id="REG_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="REG_PE" size="256" summ="default" type="STRING"/>
					<colinfo id="EMAIL" size="256" summ="default" type="STRING"/>
					<colinfo id="SOCNO" size="256" summ="default" type="STRING"/>
					<colinfo id="CORNO" size="256" summ="default" type="STRING"/>
					<colinfo id="COMNO" size="256" summ="default" type="STRING"/>
					<colinfo id="SEP_MON" size="256" summ="default" type="STRING"/>
					<colinfo id="CDATE" size="256" summ="default" type="STRING"/>
					<colinfo id="WWBLDT" size="256" summ="default" type="STRING"/>
					<colinfo id="CONTR_DA" size="256" summ="default" type="STRING"/>
					<record>
						<ADMITNO></ADMITNO>
						<AUART></AUART>
						<BRAN1></BRAN1>
						<BSTDK></BSTDK>
						<BSTNK></BSTNK>
						<CDATE></CDATE>
						<CHEOR></CHEOR>
						<COMMI></COMMI>
						<COMNO></COMNO>
						<COMPL_DA></COMPL_DA>
						<CONTR_DA></CONTR_DA>
						<CORNO></CORNO>
						<EMAIL></EMAIL>
						<ENFOR></ENFOR>
						<FINAL_DA></FINAL_DA>
						<GUAMO></GUAMO>
						<HEL_REG></HEL_REG>
						<HIGH_G></HIGH_G>
						<INCO1></INCO1>
						<INCO2></INCO2>
						<KISCON></KISCON>
						<KUNRG></KUNRG>
						<KUNRG_NM></KUNRG_NM>
						<KUNWE></KUNWE>
						<KUNWE_NM></KUNWE_NM>
						<KUNZ1></KUNZ1>
						<KUNZ2></KUNZ2>
						<KUNZ3></KUNZ3>
						<LIFNR></LIFNR>
						<LIFNR2></LIFNR2>
						<LIFNR3></LIFNR3>
						<LIFNRCHK></LIFNRCHK>
						<NETWR></NETWR>
						<PSPID></PSPID>
						<REG_NO></REG_NO>
						<REG_PE></REG_PE>
						<REGION></REGION>
						<REPMO></REPMO>
						<SEP_MON></SEP_MON>
						<SEQ></SEQ>
						<SOCNO></SOCNO>
						<SPART></SPART>
						<STADA></STADA>
						<TELF1></TELF1>
						<TURNKEY></TURNKEY>
						<VBELN></VBELN>
						<VDATU></VDATU>
						<VKBUR></VKBUR>
						<VKBURT></VKBURT>
						<WAERK></WAERK>
						<WAVWR></WAVWR>
						<WORMO></WORMO>
						<WWBLD></WWBLD>
						<WWBLDT></WWBLDT>
						<ZAPDAT></ZAPDAT>
						<ZKUNNR></ZKUNNR>
						<ZKUNNRT></ZKUNNRT>
						<ZQNTY></ZQNTY>
						<ZTERM></ZTERM>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_in_ZSDT0090">
				<Contents>
					<colinfo id="MANDT" size="256" summ="default" type="STRING"/>
					<colinfo id="VBELN" size="256" summ="default" type="STRING"/>
					<colinfo id="PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="3" summ="default" type="INT"/>
					<colinfo id="ZQNTY" size="256" summ="default" type="STRING"/>
					<colinfo id="NETWR" size="256" summ="default" type="STRING"/>
					<colinfo id="WAVWR" size="256" summ="default" type="STRING"/>
					<colinfo id="COMMI" size="256" summ="default" type="STRING"/>
					<colinfo id="VDATU" size="256" summ="default" type="STRING"/>
					<colinfo id="WAERK" size="256" summ="default" type="STRING"/>
					<colinfo id="CHNETWR" size="256" summ="default" type="STRING"/>
					<colinfo id="CHWAVWR" size="256" summ="default" type="STRING"/>
					<colinfo id="CHCOMMI" size="256" summ="default" type="STRING"/>
					<colinfo id="CHVDATU" size="256" summ="default" type="STRING"/>
					<colinfo id="CHWAERK" size="256" summ="default" type="STRING"/>
					<colinfo id="FINL" size="256" summ="default" type="STRING"/>
					<colinfo id="ERDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="ERNAM" size="256" summ="default" type="STRING"/>
					<colinfo id="BIGO1" size="256" summ="default" type="STRING"/>
					<colinfo id="BIGO2" size="256" summ="default" type="STRING"/>
					<colinfo id="BIGO3" size="256" summ="default" type="STRING"/>
					<colinfo id="BIGO4" size="256" summ="default" type="STRING"/>
					<colinfo id="BIGO5" size="256" summ="default" type="STRING"/>
					<colinfo id="CHRES" size="256" summ="default" type="STRING"/>
					<colinfo id="REDEP" size="256" summ="default" type="STRING"/>
					<colinfo id="CHRES_A" size="256" summ="default" type="STRING"/>
					<colinfo id="REDEP_A" size="256" summ="default" type="STRING"/>
					<colinfo id="CHRES_B" size="256" summ="default" type="STRING"/>
					<colinfo id="REDEP_B" size="256" summ="default" type="STRING"/>
					<colinfo id="CHRES_C" size="256" summ="default" type="STRING"/>
					<colinfo id="REDEP_C" size="256" summ="default" type="STRING"/>
					<colinfo id="CHRES_D" size="256" summ="default" type="STRING"/>
					<colinfo id="REDEP_D" size="256" summ="default" type="STRING"/>
					<colinfo id="CHRES_E" size="256" summ="default" type="STRING"/>
					<colinfo id="REDEP_E" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_in_ZSDT0091">
				<Contents>
					<colinfo id="MANDT" size="256" summ="default" type="STRING"/>
					<colinfo id="VBELN" size="256" summ="default" type="STRING"/>
					<colinfo id="PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="POSNR" size="256" summ="default" type="STRING"/>
					<colinfo id="HOGI" size="256" summ="default" type="STRING"/>
					<colinfo id="AUART" size="256" summ="default" type="STRING"/>
					<colinfo id="KZWI4" size="256" summ="default" type="STRING"/>
					<colinfo id="NETWR" size="256" summ="default" type="STRING"/>
					<colinfo id="WAVWR" size="256" summ="default" type="STRING"/>
					<colinfo id="EDATU" size="256" summ="default" type="STRING"/>
					<colinfo id="REPMO" size="256" summ="default" type="STRING"/>
					<colinfo id="GUAMO" size="256" summ="default" type="STRING"/>
					<colinfo id="WORMO" size="256" summ="default" type="STRING"/>
					<colinfo id="CHNETWR" size="256" summ="default" type="STRING"/>
					<colinfo id="CHWAVWR" size="256" summ="default" type="STRING"/>
					<colinfo id="CHEDATU" size="256" summ="default" type="STRING"/>
					<colinfo id="CHREPMO" size="256" summ="default" type="STRING"/>
					<colinfo id="CHGUAMO" size="256" summ="default" type="STRING"/>
					<colinfo id="CHWORMO" size="256" summ="default" type="STRING"/>
					<colinfo id="WAERK" size="256" summ="default" type="STRING"/>
					<colinfo id="CHCK" size="256" summ="default" type="STRING"/>
					<colinfo id="HOGI_CANC" size="256" summ="default" type="STRING"/>
					<colinfo id="ERDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="ERNAM" size="256" summ="default" type="STRING"/>
					<colinfo id="STATUS" size="256" summ="default" type="STRING"/>
					<colinfo id="MATNR" size="256" summ="default" type="STRING"/>
					<colinfo id="CLASS" size="256" summ="default" type="STRING"/>
					<colinfo id="SPEC_STAT" size="256" summ="default" type="STRING"/>
					<colinfo id="ARKTX" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_in_ZSDT0092">
				<Contents>
					<colinfo id="MANDT" size="256" summ="default" type="STRING"/>
					<colinfo id="VBELN" size="256" summ="default" type="STRING"/>
					<colinfo id="PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="3" summ="default" type="INT"/>
					<colinfo id="POSNR" size="256" summ="default" type="STRING"/>
					<colinfo id="HOGI" size="256" summ="default" type="STRING"/>
					<colinfo id="FKDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="MLBEZ" size="256" summ="default" type="STRING"/>
					<colinfo id="ZTERM" size="256" summ="default" type="STRING"/>
					<colinfo id="FKSAF" size="256" summ="default" type="STRING"/>
					<colinfo id="FPLTR" size="256" summ="default" type="STRING"/>
					<colinfo id="MSTXT" size="256" summ="default" type="STRING"/>
					<colinfo id="FAKWR" size="256" summ="default" type="STRING"/>
					<colinfo id="WAERK" size="256" summ="default" type="STRING"/>
					<colinfo id="ERDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="ERNAM" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_in_ZSDT0093">
				<Contents>
					<colinfo id="MANDT" size="256" summ="default" type="STRING"/>
					<colinfo id="VBELN" size="256" summ="default" type="STRING"/>
					<colinfo id="PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="3" summ="default" type="INT"/>
					<colinfo id="POSNR" size="256" summ="default" type="STRING"/>
					<colinfo id="HOGI" size="256" summ="default" type="STRING"/>
					<colinfo id="CHFKDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="CHMLBEZ" size="256" summ="default" type="STRING"/>
					<colinfo id="CHZTERM" size="256" summ="default" type="STRING"/>
					<colinfo id="CHFKSAF" size="256" summ="default" type="STRING"/>
					<colinfo id="FPLTR" size="256" summ="default" type="STRING"/>
					<colinfo id="CHMSTXT" size="256" summ="default" type="STRING"/>
					<colinfo id="CHFAKWR" size="256" summ="default" type="STRING"/>
					<colinfo id="WAERK" size="256" summ="default" type="STRING"/>
					<colinfo id="ERDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="ERNAM" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_in_ZSDT0094_original">
				<Contents>
					<colinfo id="MANDT" size="256" summ="default" type="STRING"/>
					<colinfo id="PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="POSNR" size="256" summ="default" type="STRING"/>
					<colinfo id="HOGI" size="256" summ="default" type="STRING"/>
					<colinfo id="NAM_CHAR" size="256" summ="default" type="STRING"/>
					<colinfo id="ATBEZ" size="256" summ="default" type="STRING"/>
					<colinfo id="CHAR_VALUE" size="256" summ="default" type="STRING"/>
					<colinfo id="ATWTB" size="256" summ="default" type="STRING"/>
					<colinfo id="CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="ERDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="ERNAM" size="256" summ="default" type="STRING"/>
					<colinfo id="CNGBN" size="256" summ="default" type="STRING"/>
					<colinfo id="ATKLA" size="256" summ="default" type="STRING"/>
					<colinfo id="CHAR_VALUEMD" size="256" summ="default" type="STRING"/>
					<colinfo id="ATWTB" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_in_ZSDT0094_change">
				<Contents>
					<colinfo id="MANDT" size="256" summ="default" type="STRING"/>
					<colinfo id="PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="POSNR" size="256" summ="default" type="STRING"/>
					<colinfo id="HOGI" size="256" summ="default" type="STRING"/>
					<colinfo id="NAM_CHAR" size="256" summ="default" type="STRING"/>
					<colinfo id="ATBEZ" size="256" summ="default" type="STRING"/>
					<colinfo id="CHAR_VALUE" size="256" summ="default" type="STRING"/>
					<colinfo id="ATWTB" size="256" summ="default" type="INT"/>
					<colinfo id="CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="ERDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="ERNAM" size="256" summ="default" type="STRING"/>
					<colinfo id="CNGBN" size="256" summ="default" type="STRING"/>
					<colinfo id="ATKLA" size="256" summ="default" type="STRING"/>
					<colinfo id="CHAR_VALUEMD" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_error">
				<Contents>
					<colinfo id="ERRCODE" size="10" type="STRING"/>
					<colinfo id="ERRMSG" size="200" type="STRING"/>
				</Contents>
			</Dataset>
		</Datasets>
		<Div Height="36" Id="div_btn" TabOrder="1" Text="Div0" Url="WB01::CommBtnForm.xml" Width="998">
			<Contents></Contents>
		</Div>
		<Grid AutoEnter="TRUE" AutoFitEndLine="Hide" BindDataset="ds_mv_ZSDT0091" BkColor2="default" BoldHead="true" Border="Flat" Bottom="427" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="315" Id="mvGrid" InputPanel="FALSE" Left="8" LineColor="user20" LineType="ExHORZ" MultiSelect="TRUE" Right="992" RowHeight="20" Style="sty_grid" TabOrder="2" TabStop="true" Top="112" TopSummary="TRUE" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="984">
			<contents>
				<format id="Default">
					<columns>
						<col width="67"/>
						<col width="100"/>
						<col width="100"/>
						<col width="160"/>
						<col width="160"/>
						<col width="389"/>
					</columns>
					<head>
						<cell align="center" col="0" color="user21" display="text" font="굴림,9" text="변경구분"/>
						<cell align="center" col="1" color="user21" display="text" font="굴림,9" text="순번"/>
						<cell align="center" col="2" color="user21" display="text" font="굴림,9" text="변경순번"/>
						<cell align="center" col="3" color="user21" display="text" font="굴림,9" text="호기"/>
						<cell align="center" col="4" color="user21" display="text" font="굴림,9" text="변경호기"/>
						<cell align="center" col="5" color="user21" display="text" font="굴림,9" text="SPEC&#32;내역&#32;/&#32;변경&#32;SPEC&#32;내역"/>
					</head>
					<body>
						<cell align="center" bkcolor2="user22" bkimageid='expr:gfn_getFlagBkImageID(getColumn(currow,&#32;&quot;FLAG&quot;))' col="0" colid="FLAG" display="image"/>
						<cell align="center" bkcolor2="user22" col="1" colid="SEQN" display="text"/>
						<cell align="center" bkcolor2="user22" col="2" colid="MVSEQN" display="text" edit="numchar"/>
						<cell align="center" bkcolor2="user22" col="3" colid="HOGI" display="text"/>
						<cell align="center" bkcolor2="user22" col="4" colid="MvHOGI" display="text"/>
						<cell align="center" bkcolor2="user22" col="5" colid="VIEWARKTX" display="text"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Button ButtonStyle="TRUE" Color="black" Height="20" Id="btn_init_hogi" ImageID="btn_sub_03" Left="932" OnClick="fn_mv_dataset_init" Style="sty_btn" TabOrder="3" Text="초기화" Top="88" Width="64"></Button>
		<Shape BKColor="user0" Bottom="78" Height="30" Id="Shape2" Left="8" LineColor="user1" Right="992" TabOrder="4" Top="48" Type="Rectangle" Width="984"></Shape>
		<Static Align="Right" Height="20" Id="Static6" Left="227" Style="sty_lb_search" TabOrder="5" Text="현장명&#32;" Top="52" VAlign="Middle" Width="80"></Static>
		<Edit BindDataset="ds_mv_ZSDT0090" BKColor="user5" Border="Flat" Column="BSTNK" Enable="FALSE" Height="20" Id="ed_bstnk" Left="313" LeftMargin="4" OnFocus="ufn_OnFocus" OnKillFocus="ufn_OnKillFocus" RightMargin="4" Style="sty_ipt_form" TabOrder="6" Top="52" Width="671"></Edit>
		<Edit Align="CENTER" BindDataset="ds_mv_ZSDT0090" BKColor="yellow" Border="Flat" Column="SEQ" Height="20" Id="seq" Left="64" LeftMargin="4" MaxLength="2" Number="TRUE" OnChanged="seq_OnChanged" RightMargin="4" Style="sty_ipt_form" TabOrder="7" Top="88" Width="30"></Edit>
		<Static Align="Right" Height="16" Id="Static0" Left="7" TabOrder="8" Text="변경차수" Top="90" VAlign="Middle" Width="51"></Static>
		<Static Align="Right" Height="20" Id="Static4" Left="13" Style="sty_lb_search" TabOrder="9" Text="프로젝트&#32;" Top="52" VAlign="Middle" Width="80"></Static>
		<Edit Align="CENTER" BindDataset="ds_mv_ZSDT0090" BKColor="user5" Border="Flat" Column="PSPID" Enable="FALSE" Height="20" Id="Edit1" Left="99" LeftMargin="4" OnFocus="ufn_OnFocus" OnKillFocus="ufn_OnKillFocus" RightMargin="4" Style="sty_ipt_form" TabOrder="10" Top="52" Width="113"></Edit>
		<Button Appearance="FLAT" ButtonStyle="TRUE" Color="user5" Cursor="HAND" DomainID="btn.mv.save" Height="22" Id="btn_mv_save" ImageID="btn_comm_save_k" Left="881" LeftMargin="20" OnClick="fn_mv_hogi_save" TabOrder="11" Text="저장" Top="6" Width="52"></Button>
	</Form>
	<Script><![CDATA[/*
 ******************************************************************************************
 * 기      능   : 계약호기 순번 변경(Sso0056)
 * 작  성  자   : 박수근
 * 작성  일자   : 2012.06
 * ----------------------------------------------------------------------------------------
 * HISTORY    : 
 ******************************************************************************************
*/

#include "LIB::commons.js";			// 공통 스크립트 
#include "LIB::common_sd.js";
#include "LIB::common_hdel.js";		// 공통 스크립트  /* GNY 추가 */
#include "LIB::nsfRequest.js";		// 공통 스크립트 

//=========================================================================================
// [ PART 1 ]
// Form에서 사용될 전역변수를 선언
// FORM에서 사용되는 전역변수는 대문자로 작성하며, F_XXX 의 형태를 갖도록 한다 
//=========================================================================================
var F_FORM_ID 	= "Sso0056";   
var F_QTNUM		= "";		// 조회된 견적번호
var F_QTSER		= "";		// 조회된 견적차수
var F_VBELN		= "";		// 조회된 프로젝트번호
var F_RECAD_DA	= "";		// 조회된 수주승인일
var F_PARENT_QTNUM = "";	// 이전화면에서 넘어온 견적계획번호
var F_ZPRGFLG   = "";		// 견적진행상태
var F_PROCESSING = false;	// 처리중 플래그 2013.03.21

//=========================================================================================
// Form Loading 
//=========================================================================================
function fn_OnLoadCompleted(obj)
{
	// Button 정보 loading 시키기 
	div_btn.fn_loadUseBtn('', ParentTitle+'계약 호기 순번 변경[sso0056]', '', '');
	
	// 화면상의 데이터를 생성한다
	fn_mv_dataset_init();
}

/********************************************************************************
* form UnloadCompleted 
********************************************************************************/
function fn_OnUnloadCompleted(obj) {

}


/********************************************************************************
* 조회 
********************************************************************************/
function fn_query() 
{ 

}

/******************************************************
* 기능 : 화면 닫기
*******************************************************/
function fn_OnClick_btn(obj)
{
	close();
}

/********************************************************************************
* 기      능   : 조회 Callback  
********************************************************************************/
function fn_afterQuery(strSvcID, nErrorCode, strErrorMag)
{ 
	
}

/********************************************************************************
* 기      능   : UI mvdata init
*              : 초기화 버튼 클릭 시 수행
********************************************************************************/
function fn_mv_dataset_init()
{ 
    // Parent.ds_output_ZSDS0063 Parent.ds_output_ZSDT0090= Parent.ds_output_ZSDT0091
    fn_createWait("",this);

    ds_mv_ZSDT0090.ClearData();
    ds_mv_ZSDT0091.ClearData();
    ds_error.ClearData();
    
    ds_mv_ZSDT0090.AddRow();
    ds_mv_ZSDT0090.SetColumn(0,"MANDT", G_MANDT); // 값이 없음
    ds_mv_ZSDT0090.SetColumn(0,"VBELN", Parent.ds_output_ZSDS0063.GetColumn(0, "VBELN")); // 값이 없음
    ds_mv_ZSDT0090.SetColumn(0,"PSPID", Parent.ds_output_ZSDS0063.GetColumn(0, "PSPID"));
    ds_mv_ZSDT0090.SetColumn(0,"SEQ"  , Parent.ds_output_ZSDS0063.GetColumn(0, "SEQ"));
    ds_mv_ZSDT0090.SetColumn(0,"BSTNK", Parent.ds_output_ZSDS0063.GetColumn(0, "BSTNK"));
    // 쿼리 조회를 통해 해당 값이 "Y" 인 경우에만 호기를 변경할 수 있다
    ds_mv_ZSDT0090.SetColumn(0,"BEXEC", "Y");
    //trace(ds_mv_ZSDT0090.SaveXML());
    
    // item값을 입력한다
    for(var i=0; i < Parent.ds_output_ZSDT0091.getRowCount(); i++ ) {
        ds_mv_ZSDT0091.AddRow();
        ds_mv_ZSDT0091.SetColumn(ds_mv_ZSDT0091.row, "FLAG", "");
        ds_mv_ZSDT0091.SetColumn(ds_mv_ZSDT0091.row, "MANDT", G_MANDT);
        ds_mv_ZSDT0091.SetColumn(ds_mv_ZSDT0091.row, "VBELN", Parent.ds_output_ZSDT0091.GetColumn(i, "VBELN"));
        ds_mv_ZSDT0091.SetColumn(ds_mv_ZSDT0091.row, "PSPID", Parent.ds_output_ZSDT0091.GetColumn(i, "PSPID"));
        ds_mv_ZSDT0091.SetColumn(ds_mv_ZSDT0091.row, "SEQ",   Parent.ds_output_ZSDT0091.GetColumn(i, "SEQ"));
        ds_mv_ZSDT0091.SetColumn(ds_mv_ZSDT0091.row, "SEQN",  (i+1));
        ds_mv_ZSDT0091.SetColumn(ds_mv_ZSDT0091.row, "POSNR", Parent.ds_output_ZSDT0091.GetColumn(i, "POSNR"));
        ds_mv_ZSDT0091.SetColumn(ds_mv_ZSDT0091.row, "HOGI",  Parent.ds_output_ZSDT0091.GetColumn(i, "HOGI"));
        ds_mv_ZSDT0091.SetColumn(ds_mv_ZSDT0091.row, "ARKTX", Parent.ds_output_ZSDT0091.GetColumn(i, "ARKTX"));
        ds_mv_ZSDT0091.SetColumn(ds_mv_ZSDT0091.row, "MVSEQN", (i+1));
        ds_mv_ZSDT0091.SetColumn(ds_mv_ZSDT0091.row, "MVPOSNR",  Parent.ds_output_ZSDT0091.GetColumn(i, "POSNR"));
        ds_mv_ZSDT0091.SetColumn(ds_mv_ZSDT0091.row, "MVHOGI",  Parent.ds_output_ZSDT0091.GetColumn(i, "HOGI"));
        ds_mv_ZSDT0091.SetColumn(ds_mv_ZSDT0091.row, "MVARKTX", Parent.ds_output_ZSDT0091.GetColumn(i, "ARKTX"));
        var viewseq = ds_mv_ZSDT0091.GetColumn(ds_mv_ZSDT0091.row, "SEQN") +" / "+ds_mv_ZSDT0091.GetColumn(ds_mv_ZSDT0091.row, "MVSEQN");
        var viewhogi = ds_mv_ZSDT0091.GetColumn(ds_mv_ZSDT0091.row, "HOGI") +" / "+ds_mv_ZSDT0091.GetColumn(ds_mv_ZSDT0091.row, "MVHOGI");
        var viewarktx = ds_mv_ZSDT0091.GetColumn(ds_mv_ZSDT0091.row, "ARKTX") +" / "+ds_mv_ZSDT0091.GetColumn(ds_mv_ZSDT0091.row, "MVARKTX");
        ds_mv_ZSDT0091.SetColumn(ds_mv_ZSDT0091.row, "VIEWSEQN", viewseq);
        ds_mv_ZSDT0091.SetColumn(ds_mv_ZSDT0091.row, "VIEWHOGI", viewhogi);
        ds_mv_ZSDT0091.SetColumn(ds_mv_ZSDT0091.row, "VIEWARKTX", viewarktx);
        // 호기별 기술사양 전송 여부 체크
        ds_mv_ZSDT0091.SetColumn(ds_mv_ZSDT0091.row,"BEXEC", "Y");
    }

	ds_mv_ZSDT0091.ClearSelect();   //범위 선택 해제
    ds_mv_ZSDT0091.SelectRow(0);   //ROW 재선택
    ds_mv_ZSDT0091.row = 0;

    fn_init_query();
}

/********************************************************************************
* 기      능   : 초기화면 호출 시 처리
********************************************************************************/
function fn_init_query() 
{
    var in_ds_list  = " ds_mv_ZSDT0090=ds_mv_ZSDT0090"
                     +" ds_mv_ZSDT0091=ds_mv_ZSDT0091"
                     +" ds_error=ds_error";
                     
    var out_ds_list = " ds_mv_ZSDT0090=ds_mv_ZSDT0090"
                     +" ds_mv_ZSDT0091=ds_mv_ZSDT0091"
                     +" ds_error=ds_error";

	nsfRequest(  "query"                       // srvId
			   , "sso0056/hogiTechSendList"    // url
			   , in_ds_list           // inDsList
			   , out_ds_list           // outDsList
			   , ""                            // strParam
			   , "fn_init_callback"            // CallBackFunc
			   );
}

/********************************************************************************
* 기      능   : 초기화면 쿼리 호출 후 callback 함수
********************************************************************************/
function fn_init_callback() 
{
    fn_destroyWait();
    if(ds_error.RowCount() > 0) {
        gfn_showAlert(ds_error.GetColumn(0, "ERRMSG"));
    }
    var finl = trim(fa_pspid);
    if( finl != '' && ds_mv_ZSDT0090.GetColumn(0, "DYN") == "Y" ) {
        gfn_showAlert("CW00022", "계약변경 "+ds_mv_ZSDT0090.GetColumn(0, "SEQ")+"차수에 저장된 계약변경 데이터가 존재합니다.해당 차수 계약변경 데이터를 삭제한 후 호기를 변경하십시요.");
        close();
    }
}

/********************************************************************************
* 기      능   : 화면에서 입력된 from to 호기번호 이동
********************************************************************************/
function fn_mv_hogi_save(obj)
{
    // 중복 정의된 순번 및 입력값 범위가 벗어난 경우에 대한 처리를 수행한다.
    fn_createWait("",this);
    
    if( mvIsDatasetUpdate() ) {

		var isExe = true;
		for ( var i = 0 ; i < ds_mv_ZSDT0091.GetRowCount() ; i++ )
		{
			var tmpCnt = 0;
			var tmpSeqn = ds_mv_ZSDT0091.GetColumn(i, "MVSEQN");
			for(var j = 0 ; j < ds_mv_ZSDT0091.GetRowCount(); j++ )
			{
				if( tmpSeqn == ds_mv_ZSDT0091.GetColumn(j, "MVSEQN") ) {
					tmpCnt = ToNumber(tmpCnt) + 1;
				}
			}
			
			if( tmpCnt > 1 ) {
			   isExe = false;
			   gfn_showAlert("CW00022", "호기("+(i+1)+")에 변경순번이 중복 입력 되었습니다. 입력값을 확인하십시요");
			   break;
			}
			
			if( tmpSeqn == null || tmpSeqn == "" ) {
			   isExe = false;
			   gfn_showAlert("CW00022", "호기("+(i+1)+")에 변경 순번을 입력하십시요.");
			   break;
			}
		}
		
		// isExe = false;
		
        if( isExe ) {
			var in_ds_list  = " ds_mv_ZSDT0090=ds_mv_ZSDT0090"
							 +" ds_mv_ZSDT0091=ds_mv_ZSDT0091"
							 +" ds_error=ds_error";
							 
			var out_ds_list = "ds_error=ds_error";
		
			nsfRequest(  "query"                       // srvId
					   , "sso0056/saveMoveHogiData"    // url
					   , in_ds_list                    // inDsList
					   , out_ds_list                   // outDsList
					   , ""                            // strParam
					   , "fn_mv_hogi_callback"         // CallBackFunc
					   );
	    } else {
	        fn_destroyWait();
	    }
    } else {
       fn_destroyWait();
       gfn_showAlert("CW00022", "호기 순번이 변경된 자료가 없습니다");
    }
}

/********************************************************************************
* 기      능   : 호기 변경 호출 후 callback 함수
********************************************************************************/
function fn_mv_hogi_callback() 
{
    if(ds_error.RowCount() > 0) {
        fn_destroyWait();
        gfn_showAlert(ds_error.GetColumn(0, "ERRMSG"));
    } else {
        
        // 호기 변경 자료 재조회 후 전체 원가합계 기능을 처리해야 한다.
        Parent.call_init_mv_query();

        fn_destroyWait();
        // gfn_showAlert("CW00022", "호기 순번이 변경되었습니다.\n계약변경요청 화면에서 원가산출을 수행 하셔야 됩니다.");
        
        close();
    }
}

// 변경정보 체크 스크립트
function mvIsDatasetUpdate()
{
	var bUpdated = false;
	var arrDs = [ ds_mv_ZSDT0091 ];
	for ( var i = 0 ; i < arrDs.length ; i++ )
	{
		var objDs = arrDs[i];
		for ( var j = 0 ; j < objDs.getRowCount() ; j++ )
		{
			if ( objDs.getColumn(j, "FLAG") == "U")
			{
				bUpdated = true;
				break;
			}
		}
	}

    return bUpdated;
}

/********************************************************************************
* 기      능   : 화면에서 입력된 from to 호기번호 이동
********************************************************************************/
function fn_single_mv_hogi(obj)
{ 
	var fromHogi = ToNumber(from_seq.Text);
	var toHogi = ToNumber(to_seq.Text);
	var mvCnt = ds_mv_ZSDT0091.getRowCount();
	var bexec = ds_mv_ZSDT0090.GetColumn(0, "BEXEC");
	
	// 기술사양서가 전송된 건이 있는 경우 처리
	if( bexec == "N" ) {
	    gfn_showAlert("CW00022", "기술사양서가 전송되어 호기 순번을 변경할 수 없습니다.");
	    return;
	}
	
	if( from_seq.Text != '' && to_seq.Text != '') {
	    if( fromHogi <> toHogi && fromHogi <= mvCnt && toHogi <= mvCnt ) {
	        fn_data_mv_hogi(fromHogi, toHogi);

			ds_mv_ZSDT0091.ClearSelect();                        // 범위 선택 해제
			ds_mv_ZSDT0091.SelectRow((ToNumber(fromHogi)-1));    // ROW 재선택
			ds_mv_ZSDT0091.SelectRow((ToNumber(toHogi))-1);      // ROW 재선택
			if( fromHogi < toHogi ) {
			    ds_mv_ZSDT0091.row = (ToNumber(fromHogi)-1);
			} else {
			    ds_mv_ZSDT0091.row = (ToNumber(toHogi)-1);
			}
	    }
	}
}

/********************************************************************************
* 기      능   : 멀티 선택된 호기 순번을 위로 이동 시킨다
********************************************************************************/
function fn_multi_mv_hogi_up()
{
    var fromSelected = false;
    var fromSelectedIndex = 0;
    var toSelectedIndex = 0;
	var bexec = ds_mv_ZSDT0090.GetColumn(0, "BEXEC");

	// 기술사양서가 전송된 건이 있는 경우 처리
	if( bexec == "N" ) {
	    gfn_showAlert("CW00022", "기술사양서가 전송되어 호기 순번을 변경할 수 없습니다.");
	    return;
	}

    for(var i = 1; i < ds_mv_ZSDT0091.GetRowCount(); i++ ) {
        fromSelected = ds_mv_ZSDT0091.selectRow(i);
        if( fromSelected ) {
            fromSelectedIndex = i;
            toSelectedIndex = i-1;
            fn_data_mv_hogi(fromSelectedIndex+1, toSelectedIndex+1);
            ds_mv_ZSDT0091.selectRow(i, false);
            ds_mv_ZSDT0091.selectRow(i-1, true);
        } else {
            ds_mv_ZSDT0091.selectRow(i, false);
        }
    }
}

/********************************************************************************
* 기      능   : 멀티 선택된 호기 순번을 아래로 이동 시킨다
********************************************************************************/
function fn_multi_mv_hogi_down()
{
    var fromSelected = false;
    var fromSelectedIndex = 0;
    var toSelectedIndex = 0;

	var bexec = ds_mv_ZSDT0090.GetColumn(0, "BEXEC");
	
	// 기술사양서가 전송된 건이 있는 경우 처리
	if( bexec == "N" ) {
	    gfn_showAlert("CW00022", "기술사양서가 전송되어 호기 순번을 변경할 수 없습니다.");
	    return;
	}
    
    for(var i = ds_mv_ZSDT0091.GetRowCount()-2; i > -1 ; i-- ) {
        fromSelected = ds_mv_ZSDT0091.selectRow(i);
        if( fromSelected ) {
            fromSelectedIndex = i;
            toSelectedIndex = i+1;
            fn_data_mv_hogi(fromSelectedIndex+1, toSelectedIndex+1);
            ds_mv_ZSDT0091.selectRow(i, false);
            ds_mv_ZSDT0091.selectRow(i+1, true);
        } else {
            ds_mv_ZSDT0091.selectRow(i, false);
        }
    }
}

/********************************************************************************
* 기      능   : 호기 순번 데이터를 이동시킨다
********************************************************************************/
function fn_data_mv_hogi(vfromIndex, vtoIndex)
{
    vfromIndex = vfromIndex-1;
    vtoIndex = vtoIndex-1;

	// to값을 갖고 from 값을 변경한다
	var tmpSEQN = ds_mv_ZSDT0091.GetColumn(vfromIndex, "MVSEQN");
	var tmpPOSNR = ds_mv_ZSDT0091.GetColumn(vfromIndex, "MVPOSNR");
	var tmpHOGI = ds_mv_ZSDT0091.GetColumn(vfromIndex, "MVHOGI");
	var tmpARKTX = ds_mv_ZSDT0091.GetColumn(vfromIndex, "MVARKTX");
	
	var viewseq = "";
	var viewhogi = "";
	var viewarktx = "";
	var bexecFrom = ds_mv_ZSDT0091.GetColumn(vfromIndex, "BEXEC");
	var bexecto   = ds_mv_ZSDT0091.GetColumn(vtoIndex, "BEXEC");
	if( bexecFrom == "N" || bexecto == "N") {
	    gfn_showAlert("CW00022", "해당 호기는 기술자료가 전송요청되어 순번 이동을 할 수 없습니다");
	    return;
	}

	ds_mv_ZSDT0091.SetColumn(vfromIndex, "MVSEQN",  ds_mv_ZSDT0091.GetColumn(vtoIndex, "MVSEQN"));
	ds_mv_ZSDT0091.SetColumn(vfromIndex, "MVPOSNR",  ds_mv_ZSDT0091.GetColumn(vtoIndex, "MVPOSNR"));
	ds_mv_ZSDT0091.SetColumn(vfromIndex, "MVHOGI",  ds_mv_ZSDT0091.GetColumn(vtoIndex, "MVHOGI"));
	ds_mv_ZSDT0091.SetColumn(vfromIndex, "MVARKTX",  ds_mv_ZSDT0091.GetColumn(vtoIndex, "MVARKTX"));

    viewseq = ds_mv_ZSDT0091.GetColumn(vfromIndex, "SEQN") +" / "+ds_mv_ZSDT0091.GetColumn(vfromIndex, "MVSEQN");
    viewhogi = ds_mv_ZSDT0091.GetColumn(vfromIndex, "HOGI") +" / "+ds_mv_ZSDT0091.GetColumn(vfromIndex, "MVHOGI");
    viewarktx = ds_mv_ZSDT0091.GetColumn(vfromIndex, "ARKTX") +" / "+ds_mv_ZSDT0091.GetColumn(vfromIndex, "MVARKTX");

    ds_mv_ZSDT0091.SetColumn(vfromIndex, "VIEWSEQN", viewseq);
    ds_mv_ZSDT0091.SetColumn(vfromIndex, "VIEWHOGI", viewhogi);
    ds_mv_ZSDT0091.SetColumn(vfromIndex, "VIEWARKTX", viewarktx);

    if( ds_mv_ZSDT0091.GetColumn(vfromIndex, "HOGI") != ds_mv_ZSDT0091.GetColumn(vfromIndex, "MVHOGI") ) {
        ds_mv_ZSDT0091.SetColumn(vfromIndex, "FLAG", "U");
        ds_mv_ZSDT0091.SetColumn(vfromIndex, "MVFLAG", "Y");
    } else {
        ds_mv_ZSDT0091.SetColumn(vfromIndex, "FLAG", "");
        ds_mv_ZSDT0091.SetColumn(vfromIndex, "MVFLAG", "N");
    }

    // tmp 값으로 to값을 변경한다
	ds_mv_ZSDT0091.SetColumn(vtoIndex, "MVSEQN",  tmpSEQN);
	ds_mv_ZSDT0091.SetColumn(vtoIndex, "MVPOSNR",  tmpPOSNR);
	ds_mv_ZSDT0091.SetColumn(vtoIndex, "MVHOGI",  tmpHOGI);
	ds_mv_ZSDT0091.SetColumn(vtoIndex, "MVARKTX", tmpARKTX);
	
    viewseq = ds_mv_ZSDT0091.GetColumn(vtoIndex, "SEQN") +" / "+ds_mv_ZSDT0091.GetColumn(vtoIndex, "MVSEQN");
    viewhogi = ds_mv_ZSDT0091.GetColumn(vtoIndex, "HOGI") +" / "+ds_mv_ZSDT0091.GetColumn(vtoIndex, "MVHOGI");
    viewarktx = ds_mv_ZSDT0091.GetColumn(vtoIndex, "ARKTX") +" / "+ds_mv_ZSDT0091.GetColumn(vtoIndex, "MVARKTX");
    ds_mv_ZSDT0091.SetColumn(vtoIndex, "VIEWSEQN", viewseq);
    ds_mv_ZSDT0091.SetColumn(vtoIndex, "VIEWHOGI", viewhogi);
    ds_mv_ZSDT0091.SetColumn(vtoIndex, "VIEWARKTX", viewarktx);

    if( ds_mv_ZSDT0091.GetColumn(vtoIndex, "HOGI") != ds_mv_ZSDT0091.GetColumn(vtoIndex, "MVHOGI") ) {
        ds_mv_ZSDT0091.SetColumn(vtoIndex, "FLAG", "U");
        ds_mv_ZSDT0091.SetColumn(vtoIndex, "MVFLAG", "N");
    } else {
        ds_mv_ZSDT0091.SetColumn(vtoIndex, "FLAG", "");
        ds_mv_ZSDT0091.SetColumn(vtoIndex, "MVFLAG", "N");
    }
}

function ds_mv_ZSDT0091_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{
    var mvSeqn = ds_mv_ZSDT0091.GetColumn(nRow, "MVSEQN");
	if( strColumnID == "MVSEQN") {
	    if( ds_mv_ZSDT0091.GetColumn(nRow, "SEQN") != mvSeqn ) {
	        var bexec = ds_mv_ZSDT0090.GetColumn(0, "BEXEC");
			// 기술사양서가 전송된 건이 있는 경우 처리
			if( bexec == "N" ) {
				gfn_showAlert("CW00022", "기술사양서가 전송되어 호기 순번을 변경할 수 없습니다.");
				return;
			} else {
			    // 변경된 키 값을 입력한다.
			    var tmpIndex = ToNumber(mvSeqn) - 1;
			    if( ds_mv_ZSDT0091.GetColumn(nRow, "SEQN") == null || ds_mv_ZSDT0091.GetColumn(nRow, "SEQN") == "" ) {
			        gfn_showAlert("CW00022", "입력한 변경 순번을 확인 하십시요");
			        return;
			    } else {
					// to값을 갖고 from 값을 변경한다
					var chgIndex = ToNumber(mvSeqn) - 1;
					if( ToNumber(mvSeqn) > ds_mv_ZSDT0091.GetRowCount() || ToNumber(mvSeqn) == 0 ) {
			            gfn_showAlert("CW00022", "입력한 변경 순번을 확인 하십시요");
			            return;
					} else {
						var viewarktx = ds_mv_ZSDT0091.GetColumn(nRow, "ARKTX") +" / "+ds_mv_ZSDT0091.GetColumn(chgIndex, "ARKTX");
						ds_mv_ZSDT0091.SetColumn(nRow, "MVPOSNR", ds_mv_ZSDT0091.GetColumn(chgIndex, "POSNR"));
						ds_mv_ZSDT0091.SetColumn(nRow, "MVHOGI", ds_mv_ZSDT0091.GetColumn(chgIndex, "HOGI"));
						ds_mv_ZSDT0091.SetColumn(nRow, "VIEWARKTX", viewarktx);
						ds_mv_ZSDT0091.SetColumn(nRow, "FLAG", "U");
					}
			    }
			}
	    } else {
			var viewarktx = ds_mv_ZSDT0091.GetColumn(nRow, "ARKTX") +" / "+ds_mv_ZSDT0091.GetColumn(nRow, "ARKTX");
			ds_mv_ZSDT0091.SetColumn(nRow, "MVPOSNR", ds_mv_ZSDT0091.GetColumn(nRow, "POSNR"));
			ds_mv_ZSDT0091.SetColumn(nRow, "MVHOGI", ds_mv_ZSDT0091.GetColumn(nRow, "HOGI"));
			ds_mv_ZSDT0091.SetColumn(nRow, "VIEWARKTX", viewarktx);
			ds_mv_ZSDT0091.SetColumn(nRow, "FLAG", "");
	    }
	}
}
]]></Script>
</Window>