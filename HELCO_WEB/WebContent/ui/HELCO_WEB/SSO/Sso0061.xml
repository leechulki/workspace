<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="562" Id="Sso0060" Left="8" OnLoadCompleted="fn_OnLoadCompleted" OnUnloadCompleted="fn_OnUnloadCompleted" PidAttrib="7" Title="수주변경" Top="8" Ver="1.0" Width="978" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_cond">
				<Contents>
					<colinfo id="CMD" size="4" type="STRING"/>
					<colinfo id="QRY_GB" size="1" type="STRING"/>
					<colinfo id="QTNUM" size="10" type="STRING"/>
					<colinfo id="QTSER" size="3" type="INT"/>
					<colinfo id="PSPID" size="10" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_error">
				<Contents>
					<colinfo id="ERRCODE" size="10" type="STRING"/>
					<colinfo id="ERRMSG" size="200" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list_partner" OnColumnChanged="ds_list_partner_OnColumnChanged">
				<Contents>
					<colinfo id="FLAG" size="1" type="STRING"/>
					<colinfo id="PARTNER_GB" size="10" type="STRING"/>
					<colinfo id="PARTNER_CD" size="10" type="STRING"/>
					<colinfo id="PARTNER_NM" size="50" type="STRING"/>
					<colinfo id="PARTNER_INFO" size="100" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list_txt" OnColumnChanged="ds_list_txt_OnColumnChanged">
				<Contents>
					<colinfo id="FLAG" size="1" type="STRING"/>
					<colinfo id="VBELN" size="10" type="STRING"/>
					<colinfo id="SER" size="5" type="INT"/>
					<colinfo id="TEXT" size="132" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list_item" OnColumnChanged="ds_list_item_OnColumnChanged" OnRowPosChanged="ds_list_item_OnRowPosChanged">
				<Contents>
					<colinfo id="CHK" size="1" type="STRING"/>
					<colinfo id="FLAG" size="1" type="STRING"/>
					<colinfo id="VBELN" size="10" type="STRING"/>
					<colinfo id="QTSEQ" size="3" type="STRING"/>
					<colinfo id="POSNR" size="6" type="STRING"/>
					<colinfo id="MATNR" size="18" type="STRING"/>
					<colinfo id="ARKTX" size="40" type="STRING"/>
					<colinfo id="KWMENG" size="5" type="INT"/>
					<colinfo id="HOGI" size="24" type="STRING"/>
					<colinfo id="WERKS" size="4" type="STRING"/>
					<colinfo id="NETWR" size="15" type="DECIMAL"/>
					<colinfo id="WAVWR" size="15" type="DECIMAL"/>
					<colinfo id="EDATU" size="8" type="STRING"/>
					<colinfo id="REPMO" size="2" type="STRING"/>
					<colinfo id="GUAMO" size="2" type="STRING"/>
					<colinfo id="WORMO" size="2" type="STRING"/>
					<colinfo id="WAERK" size="5" type="STRING"/>
					<colinfo id="CONDA" size="8" type="STRING"/>
					<colinfo id="STADA" size="8" type="STRING"/>
					<colinfo id="ZRMDA" size="8" type="STRING"/>
					<colinfo id="WWBLD" size="2" type="STRING"/>
					<colinfo id="BRNDCD" size="30" type="STRING"/>
					<colinfo id="BRNDSEQ" size="3" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_bill_gbn">
				<Contents>
					<colinfo id="CODE" size="1" type="STRING"/>
					<colinfo id="CODE_NAME" size="30" type="STRING"/>
					<record>
						<CODE>H</CODE>
						<CODE_NAME>프로젝트</CODE_NAME>
					</record>
					<record>
						<CODE>P</CODE>
						<CODE_NAME>품목별</CODE_NAME>
					</record>
					<record>
						<CODE>A</CODE>
						<CODE_NAME>품목전체</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list_bill" OnColumnChanged="ds_list_bill_OnColumnChanged">
				<Contents>
					<colinfo id="FLAG" size="1" summ="default" type="STRING"/>
					<colinfo id="BILL_GB" size="1" summ="default" type="STRING"/>
					<colinfo id="VBELN" size="10" summ="default" type="STRING"/>
					<colinfo id="POSNR" size="6" summ="default" type="STRING"/>
					<colinfo id="MLBEZ" size="5" summ="default" type="STRING"/>
					<colinfo id="FKDAT" size="8" summ="default" type="STRING"/>
					<colinfo id="ZTERM" size="4" summ="default" type="STRING"/>
					<colinfo id="FAKWR" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="WAERK" size="5" summ="default" type="STRING"/>
					<colinfo id="FAKSP" size="2" summ="default" type="STRING"/>
					<colinfo id="FKSAF" size="1" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_dtl" OnColumnChanged="ds_dtl_OnColumnChanged">
				<Contents>
					<colinfo id="FLAG" size="1" summ="default" type="STRING"/>
					<colinfo id="QTNUM" size="10" summ="default" type="STRING"/>
					<colinfo id="QTSER" size="3" summ="default" type="INT"/>
					<colinfo id="VBELN" size="10" summ="default" type="STRING"/>
					<colinfo id="AUART" size="4" summ="default" type="STRING"/>
					<colinfo id="SPART" size="2" summ="default" type="STRING"/>
					<colinfo id="VKBUR" size="4" summ="default" type="STRING"/>
					<colinfo id="VKBUR_NM" size="30" summ="default" type="STRING"/>
					<colinfo id="VKGRP" size="3" summ="default" type="STRING"/>
					<colinfo id="VKGRP_NM" size="30" summ="default" type="STRING"/>
					<colinfo id="BSTKD" size="35" summ="default" type="STRING"/>
					<colinfo id="BSTDK" size="8" summ="default" type="STRING"/>
					<colinfo id="VDATU" size="8" summ="default" type="STRING"/>
					<colinfo id="ZTERM" size="4" summ="default" type="STRING"/>
					<colinfo id="WAERK" size="5" summ="default" type="STRING"/>
					<colinfo id="EXCHRT" size="256" summ="default" type="STRING"/>
					<colinfo id="INCO1" size="3" summ="default" type="STRING"/>
					<colinfo id="INCO2" size="28" summ="default" type="STRING"/>
					<colinfo id="KUNNR_RG" size="10" summ="default" type="STRING"/>
					<colinfo id="KUNNR_WE" size="10" summ="default" type="STRING"/>
					<colinfo id="KUNNR_Z1" size="10" summ="default" type="STRING"/>
					<colinfo id="KUNNR_Z2" size="10" summ="default" type="STRING"/>
					<colinfo id="KUNNR_Z3" size="10" summ="default" type="STRING"/>
					<colinfo id="CONTR_DA" size="8" summ="default" type="STRING"/>
					<colinfo id="WWBLD" size="2" summ="default" type="STRING"/>
					<colinfo id="WWBLD_L" size="10" summ="default" type="STRING"/>
					<colinfo id="REPMO" size="2" summ="default" type="STRING"/>
					<colinfo id="GUAMO" size="2" summ="default" type="STRING"/>
					<colinfo id="RECAD_DA" size="8" summ="default" type="STRING"/>
					<colinfo id="WORMO" size="2" summ="default" type="STRING"/>
					<colinfo id="PSPID" size="24" summ="default" type="STRING"/>
					<colinfo id="REGION" size="2" summ="default" type="STRING"/>
					<colinfo id="HIGH_G" size="1" summ="default" type="STRING"/>
					<colinfo id="ADMITNO" size="10" summ="default" type="STRING"/>
					<colinfo id="CHEOR" size="2" summ="default" type="STRING"/>
					<colinfo id="COMPL_DA" size="8" summ="default" type="STRING"/>
					<colinfo id="FINAL_DA" size="8" summ="default" type="STRING"/>
					<colinfo id="ENFOR" size="20" summ="default" type="STRING"/>
					<colinfo id="TURNKEY" size="1" summ="default" type="STRING"/>
					<colinfo id="KISCON" size="1" summ="default" type="STRING"/>
					<colinfo id="HEL_REG" size="1" summ="default" type="STRING"/>
					<colinfo id="LIFNR" size="10" summ="default" type="STRING"/>
					<colinfo id="LIFNR2" size="10" summ="default" type="STRING"/>
					<colinfo id="LIFNR3" size="10" summ="default" type="STRING"/>
					<colinfo id="LIFNRCHK" size="1" summ="default" type="STRING"/>
					<colinfo id="REG_NO" size="20" summ="default" type="STRING"/>
					<colinfo id="REG_PE" size="10" summ="default" type="STRING"/>
					<colinfo id="EMAIL" size="30" summ="default" type="STRING"/>
					<colinfo id="SOCNO" size="16" summ="default" type="STRING"/>
					<colinfo id="CORNO" size="16" summ="default" type="STRING"/>
					<colinfo id="COMNO" size="11" summ="default" type="STRING"/>
					<colinfo id="SEP_MON" size="5" summ="default" type="INT"/>
					<colinfo id="BILL_GBN" size="1" summ="default" type="STRING"/>
					<colinfo id="HB_STN" size="1" summ="default" type="STRING"/>
					<colinfo id="HB_FROM" size="8" summ="default" type="STRING"/>
					<colinfo id="HB_TO" size="8" summ="default" type="STRING"/>
					<colinfo id="HB_PUB" size="1" summ="default" type="STRING"/>
					<colinfo id="MB_STN" size="1" summ="default" type="STRING"/>
					<colinfo id="KUNNR_RG2" size="10" summ="default" type="STRING"/>
					<colinfo id="FKSAK" size="1" summ="default" type="STRING"/>
					<colinfo id="KVGR1" size="3" summ="default" type="STRING"/>
					<colinfo id="EXRATE" size="256" summ="default" type="STRING"/>
					<colinfo id="SHCHK" size="256" summ="default" type="STRING"/>
					<colinfo id="LHCHK" size="256" summ="default" type="STRING"/>
					<colinfo id="ACHNO" size="256" summ="default" type="STRING"/>
					<colinfo id="KUNAPRV" size="256" summ="default" type="STRING"/>
					<colinfo id="ACHTP" size="256" summ="default" type="STRING"/>
					<colinfo id="ACHDT" size="256" summ="default" type="STRING"/>
					<colinfo id="SOPTP" size="256" summ="default" type="STRING"/>
					<colinfo id="SOPDT" size="256" summ="default" type="STRING"/>
					<colinfo id="SOP_Y_REGDT" size="256" summ="default" type="STRING"/>
					<colinfo id="AUPTP" size="256" summ="default" type="STRING"/>
					<colinfo id="AUPYEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="VIPTP" size="256" summ="default" type="STRING"/>
					<colinfo id="ARCPI" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list_zterm">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list_inco1">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list_cheor">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list_region">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list_turnkey">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list_lifnrchk">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list_kiscon">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list_hel_reg">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list_mlbez">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list_build">
				<Contents>
					<colinfo id="BUILDUSE" size="256" type="STRING"/>
					<colinfo id="STEXT" size="256" type="STRING"/>
					<colinfo id="BUILDUSE_L" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list_build_l">
				<Contents>
					<colinfo id="BUILDUSE_L" size="256" type="STRING"/>
					<colinfo id="STEXT" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond_build">
				<Contents>
					<colinfo id="BUILDUSE" size="6" type="STRING"/>
					<colinfo id="STEXT" size="120" type="STRING"/>
					<colinfo id="WHERE" size="256" type="STRING"/>
					<record>
						<BUILDUSE></BUILDUSE>
						<STEXT></STEXT>
						<WHERE></WHERE>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_auart_cd">
				<Contents>
					<colinfo id="CODE" size="1" type="STRING"/>
					<colinfo id="CODE_NAME" size="1" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_spart_cd">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_qry_gbn">
				<Contents>
					<colinfo id="CODE" size="1" type="STRING"/>
					<colinfo id="CODE_NAME" size="30" type="STRING"/>
					<record>
						<CODE>Q</CODE>
						<CODE_NAME>견적번호</CODE_NAME>
					</record>
					<record>
						<CODE>P</CODE>
						<CODE_NAME>프로젝트</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_partner_gbn">
				<Contents>
					<colinfo id="CODE" size="1" type="STRING"/>
					<colinfo id="CODE_NAME" size="30" type="STRING"/>
					<record>
						<CODE>KUNNR_RG</CODE>
						<CODE_NAME>판매처</CODE_NAME>
					</record>
					<record>
						<CODE>KUNNR_RG2</CODE>
						<CODE_NAME>지급인</CODE_NAME>
					</record>
					<record>
						<CODE>KUNNR_WE</CODE>
						<CODE_NAME>납품처</CODE_NAME>
					</record>
					<record>
						<CODE>KUNNR_Z1</CODE>
						<CODE_NAME>대리점</CODE_NAME>
					</record>
					<record>
						<CODE>KUNNR_Z2</CODE>
						<CODE_NAME>담당자</CODE_NAME>
					</record>
					<record>
						<CODE>KUNNR_Z3</CODE>
						<CODE_NAME>기술영업담당자</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_dtl_save">
				<Contents>
					<colinfo id="FLAG" size="1" summ="default" type="STRING"/>
					<colinfo id="QTNUM" size="10" summ="default" type="STRING"/>
					<colinfo id="QTSER" size="5" summ="default" type="STRING"/>
					<colinfo id="VBELN" size="10" summ="default" type="STRING"/>
					<colinfo id="AUART" size="4" summ="default" type="STRING"/>
					<colinfo id="SPART" size="2" summ="default" type="STRING"/>
					<colinfo id="VKBUR" size="4" summ="default" type="STRING"/>
					<colinfo id="VKBUR_NM" size="30" summ="default" type="STRING"/>
					<colinfo id="VKGRP" size="3" summ="default" type="STRING"/>
					<colinfo id="VKGRP_NM" size="30" summ="default" type="STRING"/>
					<colinfo id="BSTKD" size="35" summ="default" type="STRING"/>
					<colinfo id="BSTDK" size="8" summ="default" type="STRING"/>
					<colinfo id="VDATU" size="8" summ="default" type="STRING"/>
					<colinfo id="ZTERM" size="4" summ="default" type="STRING"/>
					<colinfo id="WAERK" size="5" summ="default" type="STRING"/>
					<colinfo id="EXCHRT" size="256" summ="default" type="STRING"/>
					<colinfo id="INCO1" size="3" summ="default" type="STRING"/>
					<colinfo id="INCO2" size="28" summ="default" type="STRING"/>
					<colinfo id="KUNNR_RG" size="10" summ="default" type="STRING"/>
					<colinfo id="KUNNR_WE" size="10" summ="default" type="STRING"/>
					<colinfo id="KUNNR_Z1" size="10" summ="default" type="STRING"/>
					<colinfo id="KUNNR_Z2" size="10" summ="default" type="STRING"/>
					<colinfo id="KUNNR_Z3" size="10" summ="default" type="STRING"/>
					<colinfo id="CONTR_DA" size="8" summ="default" type="STRING"/>
					<colinfo id="WWBLD" size="2" summ="default" type="STRING"/>
					<colinfo id="REPMO" size="2" summ="default" type="STRING"/>
					<colinfo id="GUAMO" size="2" summ="default" type="STRING"/>
					<colinfo id="RECAD_DA" size="8" summ="default" type="STRING"/>
					<colinfo id="WORMO" size="2" summ="default" type="STRING"/>
					<colinfo id="PSPID" size="24" summ="default" type="STRING"/>
					<colinfo id="REGION" size="2" summ="default" type="STRING"/>
					<colinfo id="HIGH_G" size="1" summ="default" type="STRING"/>
					<colinfo id="ADMITNO" size="10" summ="default" type="STRING"/>
					<colinfo id="CHEOR" size="2" summ="default" type="STRING"/>
					<colinfo id="COMPL_DA" size="8" summ="default" type="STRING"/>
					<colinfo id="FINAL_DA" size="8" summ="default" type="STRING"/>
					<colinfo id="ENFOR" size="20" summ="default" type="STRING"/>
					<colinfo id="TURNKEY" size="1" summ="default" type="STRING"/>
					<colinfo id="KISCON" size="1" summ="default" type="STRING"/>
					<colinfo id="HEL_REG" size="1" summ="default" type="STRING"/>
					<colinfo id="LIFNR" size="10" summ="default" type="STRING"/>
					<colinfo id="LIFNR2" size="10" summ="default" type="STRING"/>
					<colinfo id="LIFNR3" size="10" summ="default" type="STRING"/>
					<colinfo id="LIFNRCHK" size="1" summ="default" type="STRING"/>
					<colinfo id="REG_NO" size="20" summ="default" type="STRING"/>
					<colinfo id="REG_PE" size="10" summ="default" type="STRING"/>
					<colinfo id="EMAIL" size="30" summ="default" type="STRING"/>
					<colinfo id="SOCNO" size="16" summ="default" type="STRING"/>
					<colinfo id="CORNO" size="16" summ="default" type="STRING"/>
					<colinfo id="COMNO" size="11" summ="default" type="STRING"/>
					<colinfo id="SEP_MON" size="5" summ="default" type="INT"/>
					<colinfo id="BILL_GBN" size="1" summ="default" type="STRING"/>
					<colinfo id="HB_STN" size="1" summ="default" type="STRING"/>
					<colinfo id="HB_FROM" size="10" summ="default" type="STRING"/>
					<colinfo id="HB_TO" size="10" summ="default" type="STRING"/>
					<colinfo id="HB_PUB" size="1" summ="default" type="STRING"/>
					<colinfo id="KUNNR_RG2" size="10" summ="default" type="STRING"/>
					<colinfo id="KVGR1" size="3" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list_txt_save">
				<Contents>
					<colinfo id="FLAG" size="1" type="STRING"/>
					<colinfo id="VBELN" size="10" type="STRING"/>
					<colinfo id="SER" size="5" type="INT"/>
					<colinfo id="TEXT" size="132" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list_item_save">
				<Contents>
					<colinfo id="CHK" size="1" type="STRING"/>
					<colinfo id="FLAG" size="1" type="STRING"/>
					<colinfo id="VBELN" size="10" type="STRING"/>
					<colinfo id="QTSEQ" size="3" type="STRING"/>
					<colinfo id="POSNR" size="6" type="STRING"/>
					<colinfo id="MATNR" size="18" type="STRING"/>
					<colinfo id="ARKTX" size="40" type="STRING"/>
					<colinfo id="KWMENG" size="5" type="INT"/>
					<colinfo id="HOGI" size="24" type="STRING"/>
					<colinfo id="WERKS" size="4" type="STRING"/>
					<colinfo id="NETWR" size="15" type="DECIMAL"/>
					<colinfo id="WAVWR" size="15" type="DECIMAL"/>
					<colinfo id="EDATU" size="8" type="STRING"/>
					<colinfo id="REPMO" size="2" type="STRING"/>
					<colinfo id="GUAMO" size="2" type="STRING"/>
					<colinfo id="WORMO" size="2" type="STRING"/>
					<colinfo id="WAERK" size="5" type="STRING"/>
					<colinfo id="CONDA" size="8" type="STRING"/>
					<colinfo id="STADA" size="8" type="STRING"/>
					<colinfo id="ZRMDA" size="8" type="STRING"/>
					<colinfo id="WWBLD" size="2" type="STRING"/>
					<colinfo id="BRNDCD" size="30" type="STRING"/>
					<colinfo id="BRNDSEQ" size="3" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list_bill_save">
				<Contents>
					<colinfo id="FLAG" size="1" summ="default" type="STRING"/>
					<colinfo id="BILL_GB" size="1" summ="default" type="STRING"/>
					<colinfo id="VBELN" size="10" summ="default" type="STRING"/>
					<colinfo id="POSNR" size="6" summ="default" type="STRING"/>
					<colinfo id="MLBEZ" size="5" summ="default" type="STRING"/>
					<colinfo id="FKDAT" size="8" summ="default" type="STRING"/>
					<colinfo id="ZTERM" size="4" summ="default" type="STRING"/>
					<colinfo id="FAKWR" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="WAERK" size="5" summ="default" type="STRING"/>
					<colinfo id="FAKSP" size="2" summ="default" type="STRING"/>
					<colinfo id="FKSAF" size="1" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list_zterm_head">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_hb_stn">
				<Contents>
					<colinfo id="CODE" size="1" type="STRING"/>
					<colinfo id="CODE_NAME" size="30" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_hb_pub">
				<Contents>
					<colinfo id="CODE" size="1" type="STRING"/>
					<colinfo id="CODE_NAME" size="30" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_arg">
				<Contents>
					<colinfo id="GUBUN" size="256" type="STRING"/>
					<colinfo id="MANDT" size="256" type="STRING"/>
					<colinfo id="QTNUM" size="256" type="STRING"/>
					<colinfo id="QTSER" size="256" type="STRING"/>
					<colinfo id="QTSEQ" size="256" type="STRING"/>
					<colinfo id="VBELN" size="256" type="STRING"/>
					<colinfo id="POSNR" size="256" type="STRING"/>
					<colinfo id="MATNR" size="256" type="STRING"/>
					<colinfo id="HOGI" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_mb_stn">
				<Contents>
					<colinfo id="CODE" size="1" type="STRING"/>
					<colinfo id="CODE_NAME" size="30" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list_kvgr1">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_sto">
				<Contents>
					<colinfo id="changed" size="256" summ="default" type="STRING"/>
					<colinfo id="ordno" size="256" summ="default" type="STRING"/>
					<colinfo id="dpclr" size="256" summ="default" type="STRING"/>
					<colinfo id="dpcpd" size="256" summ="default" type="STRING"/>
					<colinfo id="canfg" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_yesno">
				<Contents>
					<colinfo id="CODE" size="1" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="30" summ="default" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME>No</CODE_NAME>
					</record>
					<record>
						<CODE>X</CODE>
						<CODE_NAME>Yes</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list_abrand">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
		</Datasets>
		<Edit Border="Flat" Height="20" Id="ed_vbeln_qry" Left="96" LeftMargin="4" MaxLength="6" OnChanged="ed_vbeln_qry_OnChanged" RightMargin="4" Style="sty_ipt_search_ind" TabOrder="2" Top="8" UpperOnly="TRUE" Width="64"></Edit>
		<Edit Border="Flat" Height="20" Id="ed_qtnum_qry" ImeMode="none" Left="96" LeftMargin="4" RightMargin="4" Style="sty_ipt_search_ind" TabOrder="1" Top="8" UpperOnly="TRUE" Visible="FALSE" Width="64"></Edit>
		<Shape BKColor="user0" Bottom="35" Height="35" Id="Shape1" Left="0" LineColor="user1" Right="978" TabOrder="47" Top="0" Type="Rectangle" Width="978"></Shape>
		<Shape BKColor="user12" Bottom="565" Height="525" Id="comm_shape" Left="2" LineColor="user13" Right="978" TabOrder="16" Top="40" Type="Rectangle" Width="976"></Shape>
		<Tab Border="Flat" Height="250" Id="tab_hdel" Left="12" OnChanged="tab_hdel_OnChanged" Style="sty_tab" TabOrder="9" Top="198" Width="962">
			<Contents>
				<TabPage BorderColor="black" Height="225" Id="head" ImageID="tab_main" Left="2" TabOrder="29" Text="헤더" Top="23" Width="958">
					<Calendar BindDataset="ds_dtl" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="CONTR_DA" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_contr_da" Left="131" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_search_ind" SundayTextColor="user35" TabOrder="1" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="3" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="150"></Calendar>
					<Static Align="Right" Height="20" Id="Static1" Left="3" Style="sty_lb_form_basic" TabOrder="0" Text="계약일&#32;" Top="3" VAlign="Middle" Width="126"></Static>
					<Static Align="Right" Height="20" Id="Static3" Left="3" Style="sty_lb_form_basic" TabOrder="19" Text="무상보수개월수&#32;" Top="113" VAlign="Middle" Width="94"></Static>
					<Static Align="Right" Height="20" Id="Static0" Left="132" Style="sty_lb_form_basic" TabOrder="19" Text="하자보증개월수&#32;" Top="113" VAlign="Middle" Width="102"></Static>
					<Static Align="Right" Height="20" Id="Static2" Left="3" Style="sty_lb_form_basic" TabOrder="19" Text="공사용사용개월수&#32;" Top="135" VAlign="Middle" Width="103"></Static>
					<Static Align="Right" Height="20" Id="Static4" Left="3" Style="sty_lb_form_basic" TabOrder="19" Text="건물준공일&#32;" Top="25" VAlign="Middle" Width="126"></Static>
					<Calendar BindDataset="ds_dtl" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="COMPL_DA" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_compl_da" Left="131" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="2" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="25" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="150"></Calendar>
					<Static Align="Right" Height="20" Id="Static5" Left="3" Style="sty_lb_form_basic" TabOrder="23" Text="최종완료일&#32;" Top="47" VAlign="Middle" Width="126"></Static>
					<Calendar BindDataset="ds_dtl" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="FINAL_DA" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_final_da" Left="131" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="3" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="47" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="150"></Calendar>
					<Static Align="Right" Height="20" Id="Static10" Left="131" Style="sty_lb_form_basic" TabOrder="23" Text="건물용도&#32;" Top="69" VAlign="Middle" Width="60"></Static>
					<Checkbox BindDataset="ds_dtl" Column="HIGH_G" Height="20" Id="chk_high_g" Left="131" LeftMargin="10" RightMargin="10" Style="sty_ipt_form_chk" TabOrder="9" TextAlign="CENTER" Top="157" TrueValue="X" Value="FALSE" Width="32"></Checkbox>
					<Static Align="Right" Height="20" Id="Static7" Left="3" Style="sty_lb_form_basic" TabOrder="23" Text="하이그로시적용&#32;" Top="157" VAlign="Middle" Width="126"></Static>
					<Static Align="Right" Height="20" Id="Static11" Left="3" Style="sty_lb_form_basic" TabOrder="23" Text="설치보수지역&#32;" Top="91" VAlign="Middle" Width="126"></Static>
					<Combo BindDataset="ds_dtl" Border="Flat" CodeColumn="CODE" Column="REGION" DataColumn="CODE_NAME" Height="20" Id="cb_region" InnerDataset="ds_list_region" Left="130" Style="sty_ipt_form_ind" TabOrder="5" Top="90" Width="153"></Combo>
					<Static Align="Right" Height="20" Id="Static13" Left="283" Style="sty_lb_form_basic" TabOrder="23" Text="원프로젝트&#32;" Top="3" VAlign="Middle" Width="126"></Static>
					<Static Align="Right" Height="20" Id="Static14" Left="283" Style="sty_lb_form_basic" TabOrder="23" Text="시행사&#32;" Top="25" VAlign="Middle" Width="126"></Static>
					<Static Align="Right" Height="20" Id="Static15" Left="164" Style="sty_lb_form_basic" TabOrder="23" Text="분할개월수&#32;" Top="157" VAlign="Middle" Width="71"></Static>
					<Static Align="Right" Height="20" Id="Static16" Left="283" Style="sty_lb_form_basic" TabOrder="23" Text="공사구분&#32;" Top="47" VAlign="Middle" Width="126"></Static>
					<Static Align="Right" Height="20" Id="Static17" Left="283" Style="sty_lb_form_basic" TabOrder="23" Text="계약형태&#32;" Top="69" VAlign="Middle" Width="126"></Static>
					<Static Align="Right" Height="20" Id="Static18" Left="283" Style="sty_lb_form_basic" TabOrder="23" Text="건설공사대장&#32;통보&#32;대상여부" Top="91" VAlign="Middle" Width="126"></Static>
					<Edit BindDataset="ds_dtl" Border="Flat" CheckLength="Byte" Column="REG_NO" Height="20" Id="ed_reg_no" ImeMode="none" Left="746" LeftMargin="4" MaxLength="7" RightMargin="4" Style="sty_ipt_form" TabOrder="20" Top="3" UpperOnly="TRUE" Width="211"></Edit>
					<Static Align="Right" Height="20" Id="Static20" Left="661" Style="sty_lb_form_basic" TabOrder="24" Text="등록자&#32;" Top="25" VAlign="Middle" Width="84"></Static>
					<Static Align="Center" Height="20" Id="Static21" Left="596" Style="sty_lb_form_basic" TabOrder="25" Text="공동수급1" Top="47" VAlign="Middle" Width="63"></Static>
					<Static Align="Center" Height="20" Id="Static22" Left="596" Style="sty_lb_form_basic" TabOrder="27" Text="공동수급2" Top="69" VAlign="Middle" Width="63"></Static>
					<Static Align="Center" Height="20" Id="Static23" Left="596" Style="sty_lb_form_basic" TabOrder="27" Text="공동수급3" Top="91" VAlign="Middle" Width="63"></Static>
					<Static Align="Right" Height="20" Id="Static24" Left="661" Style="sty_lb_form_basic" TabOrder="27" Text="이메일&#32;" Top="113" VAlign="Middle" Width="84"></Static>
					<Edit BindDataset="ds_dtl" Border="Flat" CheckLength="Byte" Column="EMAIL" Height="20" Id="ed_email" ImeMode="none" Left="746" LeftMargin="4" MaxLength="30" RightMargin="4" Style="sty_ipt_form" TabOrder="23" Top="113" UpperOnly="TRUE" Width="211"></Edit>
					<Static Align="Right" Height="20" Id="Static25" Left="661" Style="sty_lb_form_basic" TabOrder="27" Text="주민번호-개인&#32;" Top="135" VAlign="Middle" Width="84"></Static>
					<Static Align="Right" Height="20" Id="Static26" Left="661" Style="sty_lb_form_basic" TabOrder="28" Text="법인/사업자&#32;" Top="157" VAlign="Middle" Width="84"></Static>
					<Edit BindDataset="ds_dtl" Border="Flat" CheckLength="Byte" Column="PSPID" Height="20" Id="ed_pspid" ImeMode="none" Left="411" LeftMargin="4" MaxLength="24" RightMargin="4" Style="sty_ipt_form" TabOrder="11" Text="123456789012345678901234" Top="3" UpperOnly="TRUE" Width="182"></Edit>
					<Edit BindDataset="ds_dtl" Border="Flat" CheckLength="Byte" Column="ENFOR" Height="20" Id="ed_enfor" ImeMode="none" Left="411" LeftMargin="4" MaxLength="20" RightMargin="4" Style="sty_ipt_form_ind" TabOrder="12" Text="12345678901234567890" Top="25" UpperOnly="TRUE" Width="182"></Edit>
					<Edit BindDataset="ds_dtl" Border="Flat" CheckLength="Byte" Column="REG_PE" Height="20" Id="ed_reg_pe" ImeMode="none" Left="746" LeftMargin="4" MaxLength="10" RightMargin="4" Style="sty_ipt_form" TabOrder="21" Top="25" UpperOnly="TRUE" Width="211"></Edit>
					<Combo BindDataset="ds_dtl" Border="Flat" CodeColumn="CODE" Column="HEL_REG" DataColumn="CODE_NAME" Enable="FALSE" Height="20" Id="cb_hel_reg" InnerDataset="ds_list_hel_reg" Left="410" OnChanged="hel_reg_onChanged" Style="sty_ipt_form_ind" TabOrder="15" Top="90" Width="185"></Combo>
					<Combo BindDataset="ds_dtl" Border="Flat" CodeColumn="CODE" Column="TURNKEY" DataColumn="CODE_NAME" Height="20" Id="cb_turnkey" InnerDataset="ds_list_turnkey" Left="410" Style="sty_ipt_form_ind" TabOrder="13" Top="46" Width="185"></Combo>
					<Combo BindDataset="ds_dtl" Border="Flat" CodeColumn="CODE" Column="LIFNRCHK" DataColumn="CODE_NAME" Height="20" Id="cb_lifnrchk" InnerDataset="ds_list_lifnrchk" Left="410" OnChanged="fn_lifnrchk_onchanged" Style="sty_ipt_form_ind" TabOrder="14" Top="68" Width="185"></Combo>
					<Static Align="Right" Height="20" Id="Static28" Left="661" Style="sty_lb_form_basic" TabOrder="36" Text="등록번호&#32;" Top="3" VAlign="Middle" Width="84"></Static>
					<Static Align="Center" Height="32" Id="Static29" Left="596" Style="sty_lb_form_basic" TabOrder="37" Text="계약" Top="113" VAlign="Bottom" Width="63"></Static>
					<Div BKColor="user0" Height="20" Id="div_lifnr1" Left="661" OnLoadCompleted="fn_OnLoadCompleted" OnTimer="WB0199010A_OnTimer" Style="sty_ipt_form" TabOrder="22" Text="Div0" Top="47" Url="COM::Coms004.xml" Width="294">
						<Contents></Contents>
					</Div>
					<Div BKColor="user0" Height="20" Id="div_lifnr2" Left="661" OnLoadCompleted="fn_OnLoadCompleted" OnTimer="WB0199010A_OnTimer" Style="sty_ipt_form" TabOrder="23" Text="Div0" Top="69" Url="COM::Coms004.xml" Width="294">
						<Contents></Contents>
					</Div>
					<Div BKColor="user0" Height="20" Id="div_lifnr3" Left="661" OnLoadCompleted="fn_OnLoadCompleted" OnTimer="WB0199010A_OnTimer" Style="sty_ipt_form" TabOrder="23" Text="Div0" Top="91" Url="COM::Coms004.xml" Width="294">
						<Contents></Contents>
					</Div>
					<Static Align="Center" Height="20" Id="Static19" Left="596" Style="sty_lb_form_basic" TabOrder="41" Text="건설" Top="3" VAlign="Bottom" Width="63"></Static>
					<Combo BindDataset="ds_dtl" Border="Flat" CodeColumn="BUILDUSE" Column="WWBLD" DataColumn="STEXT" Height="20" Id="cb_wwbld" InnerDataset="ds_list_build" Left="192" OnClick="cb_wwbld_OnClick" Style="sty_ipt_form_ind" TabOrder="4" Top="68" Width="90"></Combo>
					<Edit Align="RIGHT" BindDataset="ds_dtl" Border="Flat" CheckLength="Byte" Column="REPMO" Enable="FALSE" Height="20" Id="ed_repmo" ImeMode="none" Left="98" LeftMargin="4" MaxLength="2" Number="TRUE" RightMargin="4" Style="sty_ipt_form_ind" TabOrder="6" Top="113" UpperOnly="TRUE" Width="32"></Edit>
					<Edit Align="RIGHT" BindDataset="ds_dtl" Border="Flat" CheckLength="Byte" Column="GUAMO" Height="20" Id="ed_guamo" ImeMode="none" Left="237" LeftMargin="4" MaxLength="2" Number="TRUE" RightMargin="4" Style="sty_ipt_form_ind" TabOrder="7" Top="113" UpperOnly="TRUE" Width="43"></Edit>
					<Edit Align="RIGHT" BindDataset="ds_dtl" Border="Flat" CheckLength="Byte" Column="WORMO" Enable="FALSE" Height="20" Id="ed_wormo" ImeMode="none" Left="107" LeftMargin="4" MaxLength="2" Number="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="8" Top="135" UpperOnly="TRUE" Width="23"></Edit>
					<Edit Align="RIGHT" BindDataset="ds_dtl" Border="Flat" CheckLength="Byte" Column="SEP_MON" Height="20" Id="ed_sep_mon" ImeMode="none" Left="237" LeftMargin="4" MaxLength="2" Number="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="10" Top="157" UpperOnly="TRUE" Width="43"></Edit>
					<Edit BindDataset="ds_dtl" Border="Flat" CheckLength="Byte" Column="SOCNO" Height="20" Id="ed_socno" ImeMode="none" Left="746" LeftMargin="4" MaxLength="16" RightMargin="4" Style="sty_ipt_form" TabOrder="24" Text="1234567890123456" Top="135" UpperOnly="TRUE" Width="211"></Edit>
					<Edit BindDataset="ds_dtl" Border="Flat" CheckLength="Byte" Column="CORNO" Height="20" Id="ed_corno" ImeMode="none" Left="746" LeftMargin="4" MaxLength="16" RightMargin="4" Style="sty_ipt_form" TabOrder="25" Top="157" UpperOnly="TRUE" Width="120"></Edit>
					<Edit BindDataset="ds_dtl" Border="Flat" CheckLength="Byte" Column="COMNO" Height="20" Id="ed_comno" ImeMode="none" Left="872" LeftMargin="4" MaxLength="11" RightMargin="4" Style="sty_ipt_form" TabOrder="26" Text="12345678901" Top="157" UpperOnly="TRUE" Width="85"></Edit>
					<Combo BindDataset="ds_dtl" Border="Flat" CodeColumn="CODE" Column="HB_STN" DataColumn="CODE_NAME" Height="20" Id="cb_hb_stn" InnerDataset="ds_hb_stn" Left="410" Style="sty_ipt_form" TabOrder="16" Top="134" Width="185"></Combo>
					<Static Align="Right" Height="20" Id="Static8" Left="283" Style="sty_lb_form_basic" TabOrder="50" Text="하자보증개시기준&#32;" Top="135" VAlign="Middle" Width="126"></Static>
					<Static Align="Right" Height="20" Id="Static9" Left="283" Style="sty_lb_form_basic" TabOrder="52" Text="보증보험발행처&#32;" Top="179" VAlign="Middle" Width="126"></Static>
					<Combo BindDataset="ds_dtl" Border="Flat" CodeColumn="CODE" Column="HB_PUB" DataColumn="CODE_NAME" Enable="FALSE" Height="20" Id="cb_hb_pub" InnerDataset="ds_hb_pub" Left="410" Style="sty_ipt_form" TabOrder="19" Top="178" Width="185"></Combo>
					<Calendar BindDataset="ds_dtl" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="HB_FROM" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" Enable="FALSE" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_hb_from" Left="411" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="17" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="157" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="82"></Calendar>
					<Calendar BindDataset="ds_dtl" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="HB_TO" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" Enable="FALSE" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_hb_to" Left="512" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="18" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="157" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="82"></Calendar>
					<Static Align="Center" Border="None" Color="user7" Font="굴림,9" Height="20" Id="Static30" Left="497" TabOrder="56" Text="~" Top="158" VAlign="Middle" Width="11"></Static>
					<Static Align="Right" Height="20" Id="Static31" Left="283" Style="sty_lb_form_basic" TabOrder="57" Text="하자보증기간&#32;" Top="157" VAlign="Middle" Width="126"></Static>
					<Static Align="Right" Height="20" Id="Static12" Left="283" Style="sty_lb_form_basic" TabOrder="58" Text="무상보수개시기준&#32;" Top="113" VAlign="Middle" Width="126"></Static>
					<Combo BindDataset="ds_dtl" Border="Flat" CodeColumn="CODE" Column="MB_STN" DataColumn="CODE_NAME" Height="20" Id="cb_mb_stn" InnerDataset="ds_mb_stn" Left="410" Style="sty_ipt_form" TabOrder="59" Top="112" Width="185"></Combo>
					<Combo BindDataset="ds_dtl" Border="Flat" CodeColumn="CODE" Column="KVGR1" DataColumn="CODE_NAME" Height="20" Id="cb_kvgr1" InnerDataset="ds_list_kvgr1" Left="202" Style="sty_ipt_form_ind" TabOrder="60" Top="178" Width="80"></Combo>
					<Static Align="Right" Height="20" Id="Static6" Left="131" Style="sty_lb_form_basic" TabOrder="61" Text="계산서구분" Top="179" VAlign="Middle" Width="71"></Static>
					<Checkbox BindDataset="ds_dtl" Column="ADMITNO" Height="20" Id="Checkbox0" Left="42" LeftMargin="10" RightMargin="10" Style="sty_ipt_form_chk" TabOrder="63" TextAlign="CENTER" Top="179" TrueValue="X" Value="FALSE" Width="24"></Checkbox>
					<Static Align="Right" Height="20" Id="Static32" Left="2" Style="sty_lb_form_basic" TabOrder="62" Text="7.7.7" Top="179" VAlign="Middle" Width="40"></Static>
					<Static Align="Right" Height="20" Id="Static33" Left="132" Style="sty_lb_form_basic" TabOrder="64" Text="상해검수여부" Top="135" VAlign="Middle" Width="102"></Static>
					<Checkbox BindDataset="ds_dtl" Column="SHCHK" Height="20" Id="chk_shchk" Left="238" LeftMargin="10" RightMargin="10" Style="sty_ipt_form_chk" TabOrder="65" TextAlign="CENTER" Top="135" TrueValue="X" Value="FALSE" Width="43"></Checkbox>
					<Static Align="Right" Height="20" Id="Static34" Left="66" Style="sty_lb_form_basic" TabOrder="66" Text="LH" Top="179" VAlign="Middle" Width="40"></Static>
					<Checkbox BindDataset="ds_dtl" Column="LHCHK" FalseValue="&#32;" Height="20" Id="chk_lh" Left="106" LeftMargin="10" RightMargin="10" Style="sty_ipt_form_chk" TabOrder="67" TextAlign="CENTER" Top="179" TrueValue="X" Value="FALSE" Width="24"></Checkbox>
					<Static Align="Right" Height="20" Id="Static35" Left="283" Style="sty_lb_form_basic" TabOrder="68" Text="건축&#32;허가번호&#32;" Top="201" VAlign="Middle" Width="126"></Static>
					<Edit BindDataset="ds_dtl" Border="Flat" CheckLength="Byte" Column="ACHNO" Enable="FALSE" Height="20" Id="ed_achno" ImeMode="none" Left="410" LeftMargin="4" MaxLength="50" RightMargin="4" Style="sty_ipt_form" TabOrder="69" Top="201" UpperOnly="TRUE" Width="184"></Edit>
					<Calendar BindDataset="ds_sto" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="dpcpd" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_dpcpd" Left="746" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" OnChanged="tab_hdel_head_cal_dpcpd_OnChanged" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="70" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="179" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="80"></Calendar>
					<Static Align="Right" Height="20" Id="Static37" Left="2" Style="sty_lb_form_basic" TabOrder="71" Text="건축&#32;허가유형&#32;" Top="201" VAlign="Middle" Width="80"></Static>
					<Static Align="Right" Height="20" Id="Static38" Left="132" Style="sty_lb_form_basic" TabOrder="73" Text="건축&#32;허가일&#32;" Top="201" VAlign="Middle" Width="68"></Static>
					<Calendar BindDataset="ds_dtl" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="ACHDT" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" Enable="FALSE" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_achdt" Left="202" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="72" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="201" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="80"></Calendar>
					<Combo BindDataset="ds_dtl" Border="Flat" CodeColumn="CODE" Column="ACHTP" DataColumn="CODE_NAME" Enable="FALSE" Height="20" Id="cb_achtp" InnerDataset="ds_yesno" Left="84" OnChanged="tab_hdel_head_cb_achtp_OnChanged" Style="sty_ipt_form" TabOrder="74" Top="200" Width="48"></Combo>
					<Static Align="Right" Height="20" Id="Static39" Left="829" Style="sty_lb_form_basic" TabOrder="75" Text="개설여부" Top="201" VAlign="Middle" Width="49"></Static>
					<Combo BindDataset="ds_dtl" Border="Flat" CodeColumn="CODE" Column="SOPTP" DataColumn="CODE_NAME" Height="20" Id="cb_soptp" InnerDataset="ds_yesno" Left="879" Style="sty_ipt_form" TabOrder="76" Top="201" Width="80"></Combo>
					<Static Align="Right" BKColor="user5" Height="20" Id="Static27" Left="867" Style="sty_lb_form_basic" TabOrder="77" Text="/" Top="157" VAlign="Middle" Width="4"></Static>
					<Static Align="Right" Height="20" Id="Static41" Left="596" Style="sty_lb_form_basic" TabOrder="78" Text="계약금&#32;수금&#32;예정일&#32;" Top="179" VAlign="Middle" Width="148"></Static>
					<Static Align="Right" Height="20" Id="Static42" Left="596" Style="sty_lb_form_basic" TabOrder="80" Text="현장개설(예정)일자&#32;" Top="201" VAlign="Middle" Width="148"></Static>
					<Calendar BindDataset="ds_dtl" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="SOPDT" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_sopdt" Left="746" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="79" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="201" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="80"></Calendar>
					<Static Align="Right" Height="20" Id="Static36" Left="829" Style="sty_lb_form_basic" TabOrder="81" Text="개설등록" Top="179" VAlign="Middle" Width="49"></Static>
					<Calendar BindDataset="ds_dtl" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="SOP_Y_REGDT" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" Enable="FALSE" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="Calendar0" Left="879" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="82" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="179" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="80"></Calendar>
					<Static Align="Center" Height="22" Id="Static40" Left="596" Style="sty_lb_form_basic" TabOrder="83" Text="공사대장" Top="23" VAlign="Middle" Width="63"></Static>
					<Static Align="Center" Height="32" Id="Static43" Left="596" Style="sty_lb_form_basic" TabOrder="84" Text="담당자" Top="145" VAlign="Middle" Width="63"></Static>
					<Static Align="Right" Height="20" Id="Static44" Left="3" Style="sty_lb_form_basic" TabOrder="85" Text="대분류&#32;" Top="69" VAlign="Middle" Width="45"></Static>
					<Combo Border="Flat" CodeColumn="BUILDUSE_L" DataColumn="STEXT" Height="20" Id="cb_wwbld_l" InnerDataset="ds_list_build_l" Left="50" OnChanged="cb_wwbld_l_OnChanged" Style="sty_ipt_form_ind" TabOrder="86" Top="68" Width="80"></Combo>
				</TabPage>
				<TabPage BorderColor="black" Height="225" Id="item" ImageID="tab_main" Left="2" Style="sty_tab" TabOrder="29" Text="품목" Top="23" Width="958">
					<Static Align="Center" Height="42" Id="Static17" Left="2" Style="sty_lb_form_basic" TabOrder="19" Top="164" VAlign="Middle" Width="153"></Static>
					<Grid AutoEnter="TRUE" AutoFitEndLine="Hide" BindDataset="ds_list_item" BkColor2="default" BoldHead="true" Border="Flat" Bottom="162" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="159" Id="grid_item" InputPanel="FALSE" Left="2" LineColor="user20" LineType="ExHORZ" OnExpandEdit="tab_hdel_item_grid_item_OnExpandEdit" OnKeyDown="tab_hdel_item_grid_item_OnKeyDown" Right="955" RowHeight="20" Style="sty_grid" TabOrder="1" TabStop="true" Top="3" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="953">
						<contents>
							<format id="Default">
								<columns>
									<col width="38"/>
									<col width="28"/>
									<col width="33"/>
									<col width="85"/>
									<col width="101"/>
									<col width="80"/>
									<col width="254"/>
									<col width="97"/>
									<col width="97"/>
									<col width="102"/>
									<col width="99"/>
									<col width="110"/>
									<col width="110"/>
									<col width="102"/>
									<col width="85"/>
									<col width="86"/>
									<col width="84"/>
									<col width="90"/>
								</columns>
								<head>
									<cell align="center" col="0" display="text" font="굴림,9" text="No"/>
									<cell align="center" col="1" color="user21" display="image" font="굴림,9"/>
									<cell align="center" col="2" color="user21" display="text" font="굴림,9" text="변경"/>
									<cell align="center" col="3" color="user21" display="text" font="굴림,9" text="판매문서품목"/>
									<cell align="center" col="4" color="user21" display="text" font="굴림,9" text="자재번호"/>
									<cell align="center" col="5" color="user21" display="text" font="굴림,9" text="브랜드"/>
									<cell align="center" col="6" color="user21" display="text" font="굴림,9" text="SPEC"/>
									<cell align="center" col="7" color="user21" display="text" font="굴림,9" text="수주금액"/>
									<cell align="center" col="8" color="user21" display="text" font="굴림,9" text="원가"/>
									<cell align="center" col="9" color="user21" display="text" font="굴림,9" text="호기"/>
									<cell align="center" col="10" color="user21" display="text" font="굴림,9" text="무상보수개월수"/>
									<cell align="center" col="11" color="user21" display="text" font="굴림,9" text="하자보증개월수"/>
									<cell align="center" col="12" color="user21" display="text" font="굴림,9" text="공사용사용개월수"/>
									<cell align="center" col="13" color="user21" display="text" font="굴림,9" text="건물용도"/>
									<cell align="center" col="14" color="user21" display="text" font="굴림,9" text="납기일"/>
									<cell align="center" col="15" color="user21" display="text" font="굴림,9" text="협의납기일"/>
									<cell align="center" col="16" color="user21" display="text" font="굴림,9" text="착공예정일"/>
									<cell align="center" col="17" color="user21" display="text" font="굴림,9" text="골조완료예정일"/>
								</head>
								<body>
									<cell align="center" bkcolor2="user22" col="0" display="text" expr="currow+1"/>
									<cell align="center" bkcolor2="user22" col="1" colid="CHK" display="checkbox" edit="checkbox"/>
									<cell align="center" bkcolor2="user22" bkimageid='expr:gfn_getFlagBkImageID(getColumn(currow,&#32;&quot;FLAG&quot;))' col="2" colid="FLAG" display="image"/>
									<cell align="center" autosizing="none" bkcolor2="user22" checklength="Byte" col="3" colid="POSNR" display="text"/>
									<cell align="left" autosizing="none" bkcolor2="user22" checklength="Byte" col="4" colid="MATNR" display="text"/>
									<cell align="left" autosizing="none" bkcolor2="user22" checklength="Byte" col="5" colid="BRNDCD" combocol="CODE" combodataset="ds_list_abrand" combotext="CODE_NAME" display="combo"/>
									<cell align="left" autosizing="none" bkcolor2="user22" checklength="Byte" col="6" colid="ARKTX" display="text" expandchar="사양" expandshow="true" expandsize="30"/>
									<cell align="right" autosizing="none" bkcolor2="user22" checklength="Byte" col="7" colid="NETWR" display="number" LimitDec="2"/>
									<cell align="right" autosizing="none" bkcolor2="user22" checklength="Byte" col="8" colid="WAVWR" display="number" LimitDec="2"/>
									<cell align="center" autosizing="none" bkcolor2="user22" checklength="Byte" col="9" colid="HOGI" display="text"/>
									<cell align="right" autosizing="none" bkcolor2="user22" checklength="Byte" col="10" colid="REPMO" display="text"/>
									<cell align="right" autosizing="none" bkcolor2="user22" checklength="Byte" col="11" colid="GUAMO" display="text"/>
									<cell align="right" autosizing="none" bkcolor2="user22" checklength="Byte" col="12" colid="WORMO" display="text"/>
									<cell align="center" autosizing="none" bkcolor2="user22" checklength="Byte" col="13" colid="WWBLD" combocol="BUILDUSE" combodataset="ds_list_build" combodisplayrowcnt="20" combotext="STEXT" display="combo"/>
									<cell align="center" autosizing="none" bkcolor2="user22" checklength="Byte" col="14" colid="EDATU" display="text" expr="gfn_getChkDate(F_FORM_ID,&#32;EDATU)" Mask="expr:gfn_getMaskDate(F_FORM_ID)"/>
									<cell align="center" autosizing="none" bkcolor2="user22" checklength="Byte" col="15" colid="CONDA" display="text" expr="gfn_getChkDate(F_FORM_ID,&#32;CONDA)" Mask="expr:gfn_getMaskDate(F_FORM_ID)"/>
									<cell align="center" autosizing="none" bkcolor2="user22" checklength="Byte" col="16" colid="STADA" display="text" expr="gfn_getChkDate(F_FORM_ID,&#32;STADA)" Mask="expr:gfn_getMaskDate(F_FORM_ID)"/>
									<cell align="center" autosizing="none" bkcolor2="user22" checklength="Byte" col="17" colid="ZRMDA" display="text" expr="gfn_getChkDate(F_FORM_ID,&#32;ZRMDA)" Mask="expr:gfn_getMaskDate(F_FORM_ID)"/>
								</body>
							</format>
						</contents>
					</Grid>
					<Static Align="Right" Height="20" Id="Static3" Left="157" Style="sty_lb_form_basic" TabOrder="1" Text="무상보수&#32;개월수&#32;" Top="164" VAlign="Middle" Width="110"></Static>
					<Static Align="Right" Height="20" Id="Static0" Left="157" Style="sty_lb_form_basic" TabOrder="2" Text="하자보증&#32;개월수&#32;" Top="186" VAlign="Middle" Width="110"></Static>
					<Static Align="Right" Height="20" Id="Static1" Left="357" Style="sty_lb_form_basic" TabOrder="3" Text="공사용사용&#32;개월수&#32;" Top="164" VAlign="Middle" Width="110"></Static>
					<Calendar BindDataset="ds_list_item" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="STADA" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_stada" Left="869" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="9" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="164" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="86"></Calendar>
					<Calendar BindDataset="ds_list_item" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="ZRMDA" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_zrmda" Left="869" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="10" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="186" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="86"></Calendar>
					<Static Align="Right" Height="20" Id="Static4" Left="557" Style="sty_lb_form_basic" TabOrder="9" Text="협의납기일&#32;" Top="186" VAlign="Middle" Width="110"></Static>
					<Static Align="Right" Height="20" Id="Static5" Left="757" Style="sty_lb_form_basic" TabOrder="10" Text="착공예정일&#32;" Top="164" VAlign="Middle" Width="110"></Static>
					<Static Align="Right" Height="20" Id="Static6" Left="757" Style="sty_lb_form_basic" TabOrder="10" Text="골조완료예정일&#32;" Top="186" VAlign="Middle" Width="110"></Static>
					<Static Align="Right" Height="20" Id="Static10" Left="357" Style="sty_lb_form_basic" TabOrder="12" Text="건물용도&#32;" Top="186" VAlign="Middle" Width="110"></Static>
					<Combo BindDataset="ds_list_item" Border="Flat" CodeColumn="BUILDUSE" Column="WWBLD" DataColumn="STEXT" Height="20" Id="cb_wwbld" InnerDataset="ds_list_build" Left="468" Style="sty_ipt_form_ind" TabOrder="6" Top="185" Width="88"></Combo>
					<Static Align="Right" Height="20" Id="Static2" Left="557" Style="sty_lb_form_basic" TabOrder="14" Text="납기일&#32;" Top="164" VAlign="Middle" Width="110"></Static>
					<Edit Align="RIGHT" BindDataset="ds_list_item" Border="Flat" CheckLength="Byte" Column="REPMO" Enable="FALSE" Height="20" Id="ed_repmo" ImeMode="none" Left="269" LeftMargin="4" MaxLength="2" Number="TRUE" OnChanged="tab_hdel_item_ed_repmo_OnChanged" RightMargin="4" Style="sty_ipt_form_ind" TabOrder="3" Top="164" UpperOnly="TRUE" Width="86"></Edit>
					<Edit Align="RIGHT" BindDataset="ds_list_item" Border="Flat" CheckLength="Byte" Column="GUAMO" Height="20" Id="ed_guamo" ImeMode="none" Left="269" LeftMargin="4" MaxLength="2" Number="TRUE" RightMargin="4" Style="sty_ipt_form_ind" TabOrder="4" Top="186" UpperOnly="TRUE" Width="86"></Edit>
					<Edit Align="RIGHT" BindDataset="ds_list_item" Border="Flat" CheckLength="Byte" Column="WORMO" Enable="FALSE" Height="20" Id="ed_wormo" ImeMode="none" Left="469" LeftMargin="4" MaxLength="2" Number="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="5" Top="164" UpperOnly="TRUE" Width="86"></Edit>
					<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_head_copy" ImageID="btn_sub_08" Left="10" LeftMargin="12" OnClick="tab_hdel_item_btn_head_copy_OnClick" Style="sty_btn" TabOrder="2" Text="헤더정보&#32;일괄복사" Top="164" Transparent="TRUE" Width="123"></Button>
					<Calendar BindDataset="ds_list_item" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="EDATU" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Enable="FALSE" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_edatu" Left="669" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form_ind" SundayTextColor="user35" TabOrder="7" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="164" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="86"></Calendar>
					<Calendar BindDataset="ds_list_item" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="CONDA" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_conda" Left="669" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="8" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="186" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="86"></Calendar>
					<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_sta_copy" ImageID="btn_sub_10" Left="10" LeftMargin="12" OnClick="tab_hdel_item_btn_sta_copy_OnClick" Style="sty_btn" TabOrder="20" Text="착공(골조)예정일&#32;일괄복사" Top="184" Transparent="TRUE" Width="140"></Button>
				</TabPage>
				<TabPage BorderColor="black" Height="225" Id="txt" ImageID="tab_main" Left="2" TabOrder="29" Text="TEXT" Top="23" Width="958">
					<Grid AreaSelect="TRUE" AutoEnter="TRUE" AutoFitEndLine="Hide" BindDataset="ds_list_txt" BkColor2="default" BoldHead="true" Border="Flat" Bottom="204" ColSelect="TRUE" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="177" Id="grid_txt" InputPanel="FALSE" Left="2" LineColor="user20" LineType="ExHORZ" OnKeyDown="tab_hdel_txt_grid_OnKeyDown" Right="952" RowHeight="20" Style="sty_grid" TabOrder="4" TabStop="true" Top="27" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="950">
						<contents>
							<format id="Default">
								<columns>
									<col width="38"/>
									<col width="33"/>
									<col width="839"/>
								</columns>
								<head>
									<cell align="center" col="0" display="text" font="굴림,9"/>
									<cell align="center" col="1" color="user21" display="text" font="굴림,9" text="변경"/>
									<cell align="center" col="2" color="user21" display="text" font="굴림,9" text="프로젝트&#32;내역"/>
								</head>
								<body>
									<cell align="center" bkcolor2="user22" col="0" display="text" expr="currow+1"/>
									<cell align="left" autosizing="none" bkcolor2="user22" bkimageid='expr:gfn_getFlagBkImageID(getColumn(currow,&#32;&quot;FLAG&quot;))' checklength="Byte" col="1" colid="FLAG" display="image" edit="normal"/>
									<cell align="left" autosizing="none" bkcolor2="user22" checklength="Byte" col="2" colid="TEXT" display="text" edit="normal"/>
								</body>
							</format>
						</contents>
					</Grid>
					<Button Appearance="FLAT" ButtonStyle="TRUE" Color="user5" Cursor="HAND" Height="22" Id="btn_input_txt" ImageID="btn_comm_input_u" Left="3" LeftMargin="20" OnClick="tab_hdel_txt_btn_input_txt_OnClick" TabOrder="1" Text="행삽입" Top="4" Width="64"></Button>
					<Button Appearance="FLAT" ButtonStyle="TRUE" Color="user5" Cursor="HAND" Height="22" Id="btn_delete_txt" ImageID="btn_comm_delete_k" Left="130" LeftMargin="20" OnClick="tab_hdel_txt_btn_delete_txt_OnClick" TabOrder="3" Text="삭제" Top="3" Width="52"></Button>
					<Button Appearance="FLAT" ButtonStyle="TRUE" Color="user5" Cursor="HAND" Height="22" Id="btn_append_txt" ImageID="btn_comm_input_u" Left="67" LeftMargin="20" OnClick="tab_hdel_txt_btn_input_txt_OnClick" TabOrder="2" Text="행추가" Top="4" Width="64"></Button>
				</TabPage>
			</Contents>
		</Tab>
		<Edit BindDataset="ds_dtl" Border="Flat" Column="VKBUR" Enable="FALSE" Height="20" Id="ed_vkbur" Left="627" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="13" TabStop="FALSE" Top="46" Width="38"></Edit>
		<Grid AreaSelect="TRUE" AutoEnter="TRUE" AutoFitEndLine="Hide" BindDataset="ds_list_bill" BkColor2="default" BoldHead="true" Border="Flat" Bottom="557" ColSelect="TRUE" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="85" Id="grd_bill" InputPanel="FALSE" Left="16" LineColor="user20" LineType="ExHORZ" OnCellPosChanged="grd_bill_OnCellPosChanged" OnKeyDown="grd_bill_OnKeyDown" Right="978" RowHeight="20" Style="sty_grid" TabOrder="21" TabStop="true" Top="472" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="962">
			<contents>
				<format id="Default">
					<columns>
						<col width="71"/>
						<col width="33"/>
						<col width="85"/>
						<col width="94"/>
						<col width="204"/>
						<col width="53"/>
						<col width="56"/>
						<col width="117"/>
						<col width="246"/>
						<col width="0"/>
					</columns>
					<head>
						<cell align="center" col="0" color="expr:GC_FONTCOLOR_EDITABLE_F" display="text" font="굴림,9"/>
						<cell align="center" col="1" color="user21" display="text" font="굴림,9" text="변경"/>
						<cell align="center" col="2" color="user21" display="text" font="굴림,9" text="판매문서품목"/>
						<cell align="center" col="3" color="user21" display="text" font="굴림,9" text="청구계획일"/>
						<cell align="center" col="4" color="user21" display="text" font="굴림,9" text="종별구분"/>
						<cell align="center" col="5" color="user21" display="text" font="굴림,9" text="보류"/>
						<cell align="center" col="6" color="user21" display="text" font="굴림,9" text="BillSt"/>
						<cell align="center" col="7" color="user21" display="text" font="굴림,9" text="청구금액"/>
						<cell align="center" col="8" color="user21" display="text" font="굴림,9" text="지급조건"/>
						<cell col="9" display="text"/>
					</head>
					<body>
						<cell align="center" bkcolor2="user22" col="0" display="text" expr="currow+1"/>
						<cell align="center" bkcolor2="user22" bkimageid='expr:gfn_getFlagBkImageID(getColumn(currow,&#32;&quot;FLAG&quot;))' col="1" colid="FLAG" display="image"/>
						<cell align="center" autosizing="none" bkcolor2="user22" col="2" colid="POSNR" display="text"/>
						<cell align="center" autosizing="none" bkcolor2="user22" col="3" colid="FKDAT" display="text" edit="normal" expr="gfn_getChkDate(F_FORM_ID,&#32;FKDAT)" Mask="expr:gfn_getMaskDate(F_FORM_ID)"/>
						<cell align="left" autosizing="none" bkcolor2="user22" col="4" colid="MLBEZ" combocol="CODE" combodataset="ds_list_mlbez" combodisplayrowcnt="20" combotext="CODE_NAME" display="combo" edit="combo"/>
						<cell align="center" autosizing="none" bkcolor2="user22" col="5" colid="FAKSP" display="text" edit="normal"/>
						<cell align="center" autosizing="none" bkcolor2="user22" col="6" colid="FKSAF" display="text"/>
						<cell align="right" autosizing="none" bkcolor2="user22" col="7" colid="FAKWR" display="number" edit="number"/>
						<cell align="left" autosizing="none" bkcolor2="user22" col="8" colid="ZTERM" combocol="CODE" combodataset="ds_list_zterm" combodisplayrowcnt="20" combotext="CODE_NAME" display="combo" edit="combo"/>
						<cell autosizing="none" col="9" colid="BILL_GB" display="text"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Button Appearance="FLAT" ButtonStyle="TRUE" Color="user5" Cursor="HAND" Height="22" Id="btn_input_bill" ImageID="btn_comm_input_u" Left="12" LeftMargin="20" OnClick="btn_input_bill_OnClick" TabOrder="22" Text="행삽입" Top="449" Width="60"></Button>
		<Button Appearance="FLAT" ButtonStyle="TRUE" Color="user5" Cursor="HAND" Height="22" Id="btn_delete_bill" ImageID="btn_comm_delete_k" Left="138" LeftMargin="20" OnClick="btn_delete_bill_OnClick" TabOrder="24" Text="삭제" Top="449" Width="52"></Button>
		<Radio Border="None" CodeColumn="CODE" ColumnCount="3" DataColumn="CODE_NAME" Height="20" Id="rd_qry_gbn" INDEX="0" InnerDataset="ds_qry_gbn" Left="184" LeftMargin="4" OnClick="rd_qry_gbn_OnClick" RightMargin="4" Style="sty_ipt_search_ind_radio" TabOrder="3" Top="15" Visible="FALSE" Width="48">
			<Contents>
				<Layout code="1" default="true" height="20" left="0" text="호기" top="0" width="40"/>
				<Layout code="2" height="20" left="45" text="프로젝트" top="0" width="80"/>
			</Contents>
		</Radio>
		<Button Height="18" Id="btn_popQtnum" ImageID="btn_icon_search" Left="344" OnClick="fn_OnClick_popup" TabOrder="15" TabStop="FALSE" Text="Button0" Top="8" Transparent="TRUE" Visible="FALSE" Width="18"></Button>
		<Static Align="Right" Height="20" Id="Static16" Left="191" Style="sty_lb_form_basic" TabOrder="39" Text="수주승인일&#32;" Top="90" VAlign="Middle" Width="80"></Static>
		<MaskEdit BindDataset="ds_dtl" Border="Flat" Column="RECAD_DA" Cursor="IBEAM" DecimalLen="0" Enable="FALSE" Height="20" Id="med_recad_da" Left="273" LeftMargin="4" Mask="@@@@.@@.@@" MaxLength="13" RightMargin="4" Style="sty_ipt_form" TabOrder="25" TabStop="FALSE" Top="90" Type="STRING" Width="87"></MaskEdit>
		<Static Align="Right" Height="20" Id="Static10" Left="6" Style="sty_lb_form_basic" TabOrder="34" Text="견적번호&#32;" Top="46" VAlign="Middle" Width="80"></Static>
		<Edit BindDataset="ds_dtl" Border="Flat" Column="QTNUM" Enable="FALSE" Height="20" Id="ed_qtnum" Left="88" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="12" TabStop="FALSE" Top="46" UpperOnly="TRUE" Width="79"></Edit>
		<Static Align="Right" Height="20" Id="Static13" Left="6" Style="sty_lb_form_basic" TabOrder="35" Text="프로젝트&#32;" Top="68" VAlign="Middle" Width="80"></Static>
		<Edit BindDataset="ds_dtl" Border="Flat" Column="VBELN" Enable="FALSE" Height="20" Id="ed_vbeln" Left="88" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="16" TabStop="FALSE" Top="68" UpperOnly="TRUE" Width="101"></Edit>
		<Grid AreaSelect="true" AutoEnter="TRUE" AutoFitEndLine="Hide" AutoScrollBar="None" BindDataset="ds_list_partner" BkColor2="default" BoldHead="true" Border="Flat" Bottom="198" Editable="TRUE" Enable="true" EndLineColor="default" FixedColSizing="TRUE" HeadBorder="Flat" HeadHeight="20" Height="130" Id="grid_partner" InputPanel="FALSE" Left="531" LineColor="user20" LineType="ExHORZ" OnExpandEdit="grid_partner_OnExpandEdit" OnMouseOver="grid_partner_OnMouseOver" Right="973" RowHeight="20" Style="sty_grid" TabOrder="8" TabStop="true" Top="68" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="442">
			<contents>
				<format id="Default">
					<columns>
						<col width="92"/>
						<col width="90"/>
						<col width="109"/>
						<col width="150"/>
					</columns>
					<head>
						<cell align="center" autosizing="none" col="0" color="user21" display="text" font="굴림,9" text="파트너역할"/>
						<cell align="center" autosizing="none" col="1" color="user21" display="text" font="굴림,9" text="파트너"/>
						<cell align="center" autosizing="none" col="2" color="user21" display="text" font="굴림,9" text="이름"/>
						<cell align="center" autosizing="none" col="3" color="user21" display="text" font="굴림,9" text="주소/연락처"/>
					</head>
					<body>
						<cell align="right" autosizing="none" bkcolor2="user22" checklength="Byte" col="0" colid="PARTNER_GB" combocol="CODE" combodataset="ds_partner_gbn" combotext="CODE_NAME" display="combo"/>
						<cell align="left" autosizing="none" bkcolor2="user22" checklength="Byte" col="1" colid="PARTNER_CD" display="text" expandchar="..." expandshow='expr:decode(PARTNER_GB,&#32;&quot;KUNNR_WE&quot;,&#32;true,&#32;&quot;KUNNR_Z3&quot;,&#32;true,&#32;&#32;&quot;KUNNR_RG2&quot;,&#32;true,&#32;false)'/>
						<cell align="left" autosizing="none" bkcolor2="user22" checklength="Byte" col="2" colid="PARTNER_NM" display="text"/>
						<cell align="left" autosizing="none" bkcolor2="user22" checklength="Byte" col="3" colid="PARTNER_INFO" display="text"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Static Align="Right" Height="20" Id="Static2" Left="191" Style="sty_lb_form_basic" TabOrder="3" Text="문서유형&#32;" Top="46" VAlign="Middle" Width="80"></Static>
		<Edit BindDataset="ds_dtl" Border="Flat" Column="AUART" Enable="FALSE" Height="20" Id="ed_auart" Left="273" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="10" TabStop="FALSE" Text="ZS01" Top="46" Width="88"></Edit>
		<Static Align="Right" Height="20" Id="Static1" Left="531" Style="sty_lb_form_basic" TabOrder="5" Text="부서/팀&#32;" Top="46" VAlign="Middle" Width="94"></Static>
		<Edit BindDataset="ds_dtl" Border="Flat" Column="VKGRP" Enable="FALSE" Height="20" Id="ed_vkgrp" Left="667" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="14" TabStop="FALSE" Top="46" Width="38"></Edit>
		<Edit BindDataset="ds_dtl" Border="Flat" Column="BSTKD" Enable="FALSE" Height="20" Id="ed_bstkd" Left="703" LeftMargin="4" MaxLength="35" RightMargin="4" Style="sty_ipt_form" TabOrder="17" TabStop="FALSE" Text="12345678901234567890123456789012345" Top="8" Width="265"></Edit>
		<Static Align="Right" Height="20" Id="Static11" Left="6" Style="sty_lb_form_basic" TabOrder="26" Text="수주금액&#32;" Top="112" VAlign="Middle" Width="80"></Static>
		<MaskEdit Border="Flat" Cursor="IBEAM" DecimalLen="2" Enable="FALSE" Height="20" Id="med_netwr" Left="88" LeftMargin="4" MaxLength="13" RightMargin="4" Style="sty_ipt_form" TabOrder="17" TabStop="FALSE" Top="112" Width="101"></MaskEdit>
		<Static Align="Right" Height="20" Id="Static7" Left="6" Style="sty_lb_form_basic" TabOrder="29" Text="원가&#32;" Top="134" VAlign="Middle" Width="80"></Static>
		<MaskEdit Border="Flat" Cursor="IBEAM" DecimalLen="2" Enable="FALSE" Height="20" Id="med_wavwr" Left="88" LeftMargin="4" MaxLength="13" RightMargin="4" Style="sty_ipt_form" TabOrder="19" TabStop="FALSE" Top="134" Width="101"></MaskEdit>
		<Static Align="Right" Height="20" Id="Static12" Left="6" Style="sty_lb_form_basic" TabOrder="27" Text="시행율(%)&#32;" Top="156" VAlign="Middle" Width="80"></Static>
		<MaskEdit Border="Flat" Cursor="IBEAM" DecimalLen="1" Enable="FALSE" Height="20" Id="med_rate" Left="88" LeftMargin="4" Mask="99.9" MaxLength="4" RightMargin="4" Style="sty_ipt_form" TabOrder="18" TabStop="FALSE" Top="156" Width="101"></MaskEdit>
		<Static Align="Right" Height="20" Id="Static9" Left="6" Style="sty_lb_form_basic" TabOrder="21" Text="통화/환율" Top="178" VAlign="Middle" Width="80"></Static>
		<Static Align="Right" Height="20" Id="Static4" Left="191" Style="sty_lb_form_basic" TabOrder="19" Text="납기일&#32;" Top="134" VAlign="Middle" Width="80"></Static>
		<Calendar BindDataset="ds_dtl" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="VDATU" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" Enable="FALSE" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_vdatu" Left="273" LeftMargin="4" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" RightMargin="4" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_search_ind" SundayTextColor="user35" TabOrder="4" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="134" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="88"></Calendar>
		<Static Align="Right" Height="20" Id="Static5" Left="363" Style="sty_lb_form_basic" TabOrder="20" Text="지급조건&#32;" Top="90" VAlign="Middle" Width="75"></Static>
		<Combo BindDataset="ds_dtl" Border="Flat" CodeColumn="CODE" Column="ZTERM" DataColumn="CODE_NAME" Height="20" Id="cb_zterm" InnerDataset="ds_list_zterm_head" Left="440" Style="sty_ipt_form_ind" TabOrder="5" Top="90" Width="89"></Combo>
		<Static Align="Right" Height="20" Id="Static8" Left="191" Style="sty_lb_form_basic" TabOrder="22" Text="인도조건1&#32;" Top="156" VAlign="Middle" Width="80"></Static>
		<Combo BindDataset="ds_dtl" Border="Flat" CodeColumn="CODE" Column="INCO1" DataColumn="CODE" Height="20" Id="cb_inco1" InnerDataset="ds_list_inco1" Left="272" Style="sty_ipt_form" TabOrder="6" Top="155" Width="88"></Combo>
		<Static Align="Right" Height="20" Id="Static14" Left="191" Style="sty_lb_form_basic" TabOrder="23" Text="인도조건2&#32;" Top="178" VAlign="Middle" Width="80"></Static>
		<Edit BindDataset="ds_dtl" Border="Flat" CheckLength="Byte" Column="INCO2" Height="20" Id="ed_inco2" ImeMode="none" Left="273" LeftMargin="4" MaxLength="28" RightMargin="4" Style="sty_ipt_form" TabOrder="7" Top="178" UpperOnly="TRUE" Width="255"></Edit>
		<Static Align="Right" Height="20" Id="Static6" Left="781" Style="sty_lb_form_basic" TabOrder="18" Text="수주일&#32;" Top="108" VAlign="Middle" Width="0"></Static>
		<Static Align="Right" Height="20" Id="Static3" Left="191" Style="sty_lb_form_basic" TabOrder="4" Text="제품군&#32;" Top="68" VAlign="Middle" Width="80"></Static>
		<Edit BindDataset="ds_dtl" Border="Flat" Column="SPART" Enable="FALSE" Height="20" Id="ed_spart" Left="273" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="11" TabStop="FALSE" Text="1234" Top="68" Width="88"></Edit>
		<MaskEdit BindDataset="ds_dtl" Border="Flat" Column="BSTDK" Cursor="IBEAM" DecimalLen="0" Enable="FALSE" Height="20" Id="med_bstdk" Left="273" LeftMargin="4" Mask="@@@@.@@.@@" MaxLength="13" RightMargin="4" Style="sty_ipt_form" TabOrder="20" TabStop="FALSE" Top="112" Type="STRING" Width="87"></MaskEdit>
		<Edit BindDataset="ds_dtl" Border="Flat" Column="VKGRP_NM" Enable="FALSE" Height="20" Id="ed_vkgrp_nm" Left="841" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="27" TabStop="FALSE" Top="46" Width="132"></Edit>
		<Edit BindDataset="ds_dtl" Border="Flat" Column="VKBUR_NM" Enable="FALSE" Height="20" Id="ed_vkbur_nm" Left="707" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="26" TabStop="FALSE" Top="46" Width="132"></Edit>
		<Button Appearance="FLAT" ButtonStyle="TRUE" Color="user5" Cursor="HAND" Height="22" Id="btn_append_bill" ImageID="btn_comm_input_u" Left="74" LeftMargin="20" OnClick="btn_input_bill_OnClick" TabOrder="23" Text="행추가" Top="449" Width="64"></Button>
		<Static Align="Right" Height="20" Id="Static15" Left="6" Style="sty_lb_form_basic" TabOrder="45" Text="수주승인번호&#32;" Top="90" VAlign="Middle" Width="80"></Static>
		<Edit BindDataset="ds_dtl" Border="Flat" CheckLength="Byte" Enable="FALSE" Height="20" Id="ed_admitno" ImeMode="none" Left="88" LeftMargin="4" MaxLength="50" RightMargin="4" Style="sty_ipt_form" TabOrder="28" TabStop="FALSE" Top="90" UpperOnly="TRUE" Width="101"></Edit>
		<Static Align="Right" Height="20" Id="Static17" Left="191" Style="sty_lb_form_basic" TabOrder="46" Text="수주일&#32;" Top="112" VAlign="Middle" Width="80"></Static>
		<Edit Border="Flat" Enable="FALSE" Height="20" Id="ed_auart_nm" Left="363" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="29" TabStop="FALSE" Top="46" Width="166"></Edit>
		<Edit Border="Flat" Enable="FALSE" Height="20" Id="ed_spart_nm" Left="363" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="30" TabStop="FALSE" Top="68" Width="166"></Edit>
		<MaskEdit Border="Flat" Cursor="IBEAM" DecimalLen="2" Enable="FALSE" Height="20" Id="med_fakwr_sum" Left="878" LeftMargin="4" MaxLength="20" RightMargin="4" Style="sty_ipt_form" TabOrder="31" TabStop="FALSE" Top="449" Width="96"></MaskEdit>
		<MaskEdit Border="Flat" Cursor="IBEAM" DecimalLen="2" Enable="FALSE" Height="20" Id="med_fakwr_totsum" Left="473" LeftMargin="4" Mask="123,456,789,012" MaxLength="20" RightMargin="4" Style="sty_ipt_form" TabOrder="32" TabStop="FALSE" Top="449" Width="96"></MaskEdit>
		<Edit Border="Flat" Enable="FALSE" Font="Default,9,Bold" Height="20" Id="ed_status" Left="180" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="33" TabStop="FALSE" Text="진행상태" Top="8" Width="166"></Edit>
		<Static Align="Right" Height="20" Id="st_i_ymd" Left="8" Style="sty_lb_search" TabOrder="55" Text="프로젝트&#32;" Top="7" VAlign="Middle" Width="85"></Static>
		<Checkbox BindDataset="ds_dtl" Column="BILL_GBN" FalseValue="P" Height="20" Id="chk_bill_gbn" Left="284" LeftMargin="4" OnClick="chk_bill_gbn_OnClick" RightMargin="4" Style="sty_ipt_form_ind_chk" TabOrder="34" Text="헤더청구" TextAlign="CENTER" Top="449" TrueValue="H" Value="FALSE" Width="84"></Checkbox>
		<Combo Border="Flat" CodeColumn="CODE" DataColumn="CODE_NAME" Height="20" Id="cb_bill_gbn" InnerDataset="ds_bill_gbn" Left="682" OnChanged="cb_bill_gbn_OnChanged" Style="sty_ipt_form" TabOrder="35" Top="448" Width="89"></Combo>
		<Edit Align="CENTER" BindDataset="ds_dtl" Border="Flat" Column="QTSER" Enable="FALSE" Height="20" Id="ed_qtser" Left="167" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="36" TabStop="FALSE" Top="46" UpperOnly="TRUE" Width="22"></Edit>
		<Static Align="Right" Height="20" Id="Static18" Left="192" Style="sty_lb_form_basic" TabOrder="58" Text="청구구분&#32;" Top="449" VAlign="Middle" Width="90"></Static>
		<Static Align="Right" Height="20" Id="Static19" Left="370" Style="sty_lb_form_basic" TabOrder="53" Text="청구금액&#32;총합계&#32;" Top="449" VAlign="Middle" Width="101"></Static>
		<Static Align="Right" Height="20" Id="Static20" Left="571" Style="sty_lb_form_basic" TabOrder="60" Text="빌링필터조건&#32;" Top="449" VAlign="Middle" Width="110"></Static>
		<Static Align="Right" Height="20" Id="st_sum" Left="772" Style="sty_lb_form_basic" TabOrder="51" Text="청구금액필터합계&#32;" Top="449" VAlign="Middle" Width="104"></Static>
		<Static Align="Right" Height="20" Id="Static21" Left="376" Style="sty_lb_search" TabOrder="62" Text="거래선&#32;" Top="8" VAlign="Middle" Width="85"></Static>
		<Edit Border="Flat" Enable="FALSE" Height="20" Id="ed_guresun" Left="464" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="63" TabStop="FALSE" Top="8" Width="144"></Edit>
		<Static Align="Right" Height="20" Id="Static22" Left="616" Style="sty_lb_search" TabOrder="64" Text="현장명&#32;" Top="8" VAlign="Middle" Width="85"></Static>
		<Button Cursor="HAND" Height="18" Id="btn_pjt" ImageID="btn_icon_search" Left="161" OnClick="ufn_openPjt" TabOrder="65" Top="8" Transparent="TRUE" Width="18"></Button>
		<Edit BindDataset="ds_dtl" Border="Flat" CheckLength="Byte" Column="WAERK" Enable="FALSE" Height="20" Id="Edit0" ImeMode="none" Left="88" LeftMargin="4" MaxLength="50" RightMargin="4" Style="sty_ipt_form" TabOrder="66" TabStop="FALSE" Text="1234567890" Top="177" UpperOnly="TRUE" Width="50"></Edit>
		<Edit BindDataset="ds_dtl" Border="Flat" CheckLength="Byte" Column="EXCHRT" Enable="FALSE" Height="20" Id="ed_exchrt" ImeMode="none" Left="139" LeftMargin="4" MaxLength="50" RightMargin="4" Style="sty_ipt_form" TabOrder="67" TabStop="FALSE" Text="1234567890" Top="177" UpperOnly="TRUE" Width="50"></Edit>
		<Static Align="Right" Height="20" Id="Static24" Left="363" Style="sty_lb_form_basic" TabOrder="68" Text="VIP&#32;Project&#32;" Top="112" VAlign="Middle" Width="75"></Static>
		<Combo BindDataset="ds_dtl" Border="Flat" CodeColumn="CODE" Column="VIPTP" DataColumn="CODE_NAME" Height="20" Id="cb_viptp" InnerDataset="ds_yesno" Left="440" Style="sty_ipt_form" TabOrder="70" Top="112" Width="89"></Combo>
		<Static Align="Right" Height="20" Id="Static25" Left="363" Style="sty_lb_form_basic" TabOrder="69" Text="연단가/통합&#32;" Top="134" VAlign="Middle" Width="75"></Static>
		<Checkbox Align="LEFT" BindDataset="ds_dtl" BKColor="user5" Column="AUPTP" Height="20" Id="chk_auptp" Left="448" LeftMargin="10" OnClick="chk_auptp_OnClick" RightMargin="10" Style="sty_ipt_search_chk" TabOrder="72" TextAlign="CENTER" Top="134" TrueValue="X" Value="FALSE" Width="25"></Checkbox>
		<Combo BindDataset="ds_dtl" Border="Flat" CodeColumn="CODE" Column="AUPYEAR" DataColumn="CODE_NAME" Enable="FALSE" Height="20" Id="cb_year" Left="460" Style="sty_ipt_form" TabOrder="71" Top="134" Width="68"></Combo>
		<Static Align="Center" Height="20" Id="Static0" Left="363" Style="sty_lb_form_basic" TabOrder="73" Text="개인정보&#32;수집&#32;동의" Top="156" VAlign="Middle" Width="165"></Static>
		<Checkbox BindDataset="ds_dtl" Column="ARCPI" Height="20" Id="chk_arcpi" Left="504" TabOrder="74" Top="156" TrueValue="X" Value="FALSE" Width="25"></Checkbox>
	</Form>
	<Script><![CDATA[/*
 ******************************************************************************************
 * 기      능   : 수주생성 (Sso0060)
 * 작  성  자   : 구란이
 * 작성  일자   : 2012.07.31
 * ----------------------------------------------------------------------------------------
 * HISTORY    : V1.0 : 2012.09.03 : 신규
 * COMMENT
   0. T-CODE                : 
   1. WFC URL 				: 
   2. WFC OPERATION NAME 	: 
   3. WFC OBJ NAME 			: 
   4. 개발자료 :   
   ※ 수주생성 ==> SAPHEE.VBAK
 ******************************************************************************************
*/
#include "LIB::commons.js";
#include "LIB::nsfRequest.js";
#include "LIB::common_hdel.js";
#include "LIB::common_sd.js";


//=========================================================================================
// [ PART 1 ]
// Form에서 사용될 전역변수를 선언
// FORM에서 사용되는 전역변수는 대문자로 작성하며, F_XXX 의 형태를 갖도록 한다. 
//=========================================================================================
var F_FORM_ID 	= "Sso0061";   
var F_QRY_GB	= "";		// 조회구분(Q:견적번호로 조회, P:프로젝트번호로 조회)
var F_QRY_NUM	= "";		// 조회번호(견적번호 또는 프로젝트번호)
var F_QTNUM		= "";		// 조회된 견적번호
var F_QTSER		= "";		// 조회된 견적차수
var F_VBELN		= "";		// 조회된 프로젝트번호
var F_RECAD_DA	= "";		// 조회된 수주승인일


// 임시코딩 : 폼파라메터 : 삭제필요
// var fa_qry_gb 	= "P";			// 조회구분(Q:견적번호,P:프로젝트번호)
// var fa_qry_num  = "T10050";		// 조회번호(견적번호 또는 프로젝트번호) 

//  폼 호출정보
// gfn_form_activate(pPgmId, fa_qry_gb+fa_qry_num)

//=========================================================================================
// [ PART 2 ]
// Form Loading / Unloading 시 작업 정의
//=========================================================================================
function fn_OnLoadCompleted(obj) {
	 
	
	gfn_initForm(true);     
			
	// 폼 초기화
	fn_init_form();
	
	/* list 코드 LOAD */   
	gfn_SetListCode(F_FORM_ID, GC_CDGB_REGION	, ds_list_region	, tab_hdel.head.cb_region	, 0, "N", "Y"); // 설치지역_저장항목
	gfn_SetListCode(F_FORM_ID, GC_CDGB_CHEOR	, ds_list_cheor		, tab_hdel.head.cb_cheor	, 0, "N", "Y"); // 검사기관_저장항목
	//gfn_SetListCode(F_FORM_ID, GC_CDGB_TURNKEY	, ds_list_turnkey	, tab_hdel.head.cb_turnkey	, 0, "N", "Y"); // 공사구분 _저장항목
	gfn_queryDD07T('ZSDD_CCTYPE', ds_list_turnkey, 'N');
	//gfn_SetListCode(F_FORM_ID, GC_CDGB_LIFNRCHK	, ds_list_lifnrchk	, tab_hdel.head.cb_lifnrchk	, 0, "N", "Y"); // 계약형태 _저장항목
	gfn_queryDD07T('ZSDDLIFNRCHK', ds_list_lifnrchk, 'N');
	//gfn_SetListCode(F_FORM_ID, GC_CDGB_KISCON	, ds_list_kiscon	, tab_hdel.head.cb_kiscon	, 0, "N", "Y"); // KISCON등록(원도급)_저장항목
	gfn_SetListCode(F_FORM_ID, GC_CDGB_HEL_REG 	, ds_list_hel_reg	, tab_hdel.head.cb_hel_reg	, 0, "N", "Y"); // 당사등록 _저장항목
	gfn_SetListCode(F_FORM_ID, GC_CDGB_HB_STN  	, ds_hb_stn			, tab_hdel.head.cb_hb_stn	, 0, "N", "Y"); // 하자보증개시기준    _저장항목
	gfn_SetListCode(F_FORM_ID, GC_CDGB_MB_STN  	, ds_mb_stn			, tab_hdel.head.cb_mb_stn	, 0, "N", "Y"); // 하자보증개시기준    _저장항목
	gfn_SetListCode(F_FORM_ID, GC_CDGB_HB_PUB  	, ds_hb_pub			, tab_hdel.head.cb_hb_pub	, 0, "N", "Y"); // 보증보험발행처    _저장항목
	gfn_SetListCode(F_FORM_ID, GC_CDGB_KVGR1    , ds_list_kvgr1	    , tab_hdel.head.cb_kvgr1    , 0, "N", "N"); // 설치지역_저장항목
	
	
    //=========================================================================================
    //  기능ID    : UF017
    //  개선내역  : 2016.02.12 공용코드 개별 액션 호출 통합하여 처리
    //=========================================================================================
    // 문서유형, 건물용도, 지급조건, 인도조건, 종별구분 코드목록 조회
    fn_CommonCode();
    
	// 연간단가 기준 년도 세팅
	var curYear = substr(gfn_getCurrDate(),0,4); 
	fn_Year(curYear,-1,2,0);       
}
function fn_afterQueryDD07T_ZSDD_CCTYPE(errCode, errMsg) {
}
/********************************************************************************
* 기      능   : 공통코드가 조회된 후의 Callback 함수 (common.js에서 호출됨)
********************************************************************************/
function fn_completeInit(sCode, sDsObj, sCodeType) {
	gfn_showMsg("CI00007");  
}

/********************************************************************************
* 기      능   : form UnloadCompleted 
********************************************************************************/
function fn_OnUnloadCompleted(obj) {
	return gfn_isFormUnload(obj);
}

// 닫기
function fn_close() { 
	
	if (fn_valid_chk("close") == false) return false;

	close();
}

// 폼 초기화 
function fn_init_form()
{ 
	// 메세지바 초기화
	gfn_clearMsgBar();   
	 
	// 폼변수 초기화  
	F_USER_GROUP_B  = G_USER_GROUP_B;  	// 임시 추가
	F_SYSDATE   	= substr(gfn_getCurrDate(),0,8); // 현재년월일(8자리)
	F_QRY_GB		= fa_qry_gb;		// 조회구분(Q:견적번호로 조회, P:프로젝트번호로 조회)
	F_QRY_NUM		= fa_qry_num;		// 견적번호 또는 프로젝트번호
	F_QTNUM			= "";				// 조회된 견적번호
	F_QTSER			= "";				// 조회된 견적차수
	F_VBELN			= "";				// 조회된 프로젝트번호
	F_RECAD_DA		= "";				// 조회된 수주승인일


	// 데이타셋 초기화
	ds_dtl.ClearData(); 	
	ds_list_item.ClearData();
	ds_list_txt.ClearData(); 
	
	// 견적상태 초기화
	ed_status.Text = "";
	
	// 코딩 시 필요한 그리드 컬럼 인덱스	  
	//F_COLNUM_MEKIND	= gfn_getColIdx(grd_list,"MEKIND"	);  // 법조치종류
	
	// 그리드, 디비젼, 탭 항목 위치 재조정 
	comm_shape.Height 	= 524;
	grid_partner.top 	= 68;
	grid_partner.Height = 141; 
	grid_partner.Width 	= 442; 
	tab_hdel.Height 	= 248;
	tab_hdel.Width  	= 962; 
	tab_hdel.item.grid_item.Height 	= 159;
	tab_hdel.item.grid_item.Width   = 953;
	tab_hdel.txt.grid_txt.Height 	= 177;   
	grd_bill.Height = 101;
	
	tab_hdel.TabIndex = 0;  // 헤더 탭에 오도록 
	 
	// 공동수급1, 공동수급2, 공동수급3 디비젼 초기화 
	tab_hdel.head.div_lifnr1.fn_rsetSize(272, 81, 170);  	 // 사이즈조정
	tab_hdel.head.div_lifnr2.fn_rsetSize(272, 81, 170);  	 // 사이즈조정
	tab_hdel.head.div_lifnr3.fn_rsetSize(272, 81, 170); 		 // 사이즈조정
	
	tab_hdel.head.div_lifnr1.top = 47;
	tab_hdel.head.div_lifnr2.top = 69;
	tab_hdel.head.div_lifnr3.top = 91;
	tab_hdel.head.div_lifnr1.btn_popLifnr.Enable = false;
	tab_hdel.head.div_lifnr2.btn_popLifnr.Enable = false;
	tab_hdel.head.div_lifnr3.btn_popLifnr.Enable = false;
	tab_hdel.head.div_lifnr1.ed_name1.Visible = true;						// 협력업체명 보이도록 수정
	tab_hdel.head.div_lifnr2.ed_name1.Visible = true;						// 협력업체명 보이도록 수정
	tab_hdel.head.div_lifnr3.ed_name1.Visible = true; 						// 협력업체명 보이도록 수정
	tab_hdel.head.div_lifnr1.ed_name1.Enable = false;						// 협력업체명 수정불가하도록 수정
	tab_hdel.head.div_lifnr2.ed_name1.Enable = false;						// 협력업체명 수정불가하도록 수정
	tab_hdel.head.div_lifnr3.ed_name1.Enable = false; 						// 협력업체명 수정불가하도록 수정
	tab_hdel.head.div_lifnr1.ed_lifnr.Style = "sty_ipt_form"; 				// 스타일적용(옵션 입력항목)
	tab_hdel.head.div_lifnr2.ed_lifnr.Style = "sty_ipt_form"; 				// 스타일적용(옵션 입력항목)
	tab_hdel.head.div_lifnr3.ed_lifnr.Style = "sty_ipt_form"; 				// 스타일적용(옵션 입력항목)
	gfn_BindColumn(tab_hdel.head.div_lifnr1.ed_lifnr, "ds_dtl", "LIFNR");	// 데이타셋 바인딩
	gfn_BindColumn(tab_hdel.head.div_lifnr2.ed_lifnr, "ds_dtl", "LIFNR2");	// 데이타셋 바인딩
	gfn_BindColumn(tab_hdel.head.div_lifnr3.ed_lifnr, "ds_dtl", "LIFNR3");	// 데이타셋 바인딩
	
	// 그리드 FIX
	gfn_grid_fix(tab_hdel.item.grid_item	, 5);	// 품목그리드는 SPEC에서 fix
	
	// 빌링필터구분 초기화
	cb_bill_gbn.Value = "";
	fn_bill_filter();
	cb_bill_gbn.Enable = false; 
	
	// 버튼 제어
	tab_hdel.item.btn_head_copy.Enable = false;
	tab_hdel.item.btn_sta_copy.Enable = false;
	tab_hdel.txt.btn_input_txt.Enable = false;
	tab_hdel.txt.btn_append_txt.Enable = false;
	tab_hdel.txt.btn_delete_txt.Enable = false; 
	btn_input_bill.Enable = false;
	btn_append_bill.Enable = false;
	btn_delete_bill.Enable = false;
	
	//현장명 활성화 적용 2013.05.31
	ed_bstkd.Enable = true;
	
	// 폼 파라메터에 값이 존재할 경우 해당 값을 기본으로 보여주고 조회 이벤트를 호출한다. 
	rd_qry_gbn.Value = "P";
	ed_vbeln_qry.text = F_QRY_NUM;

	// 조회구분 옵션변경 이벤트 강제호출
	rd_qry_gbn_OnClick();	
	// 조회구분이 있을 경우 조회서비스 강제호출
	if (length(F_QRY_GB) > 0 && length(F_QRY_NUM) > 0) {
		//=========================================================================================
		//  기능ID    : UF014 시작
		//  개선내역  : 2016.02.12 공용코드 개별 액션 호출 통합하여 처리
		//=========================================================================================
        fn_query();
	}
}     


//=========================================================================================
// [ PART 3 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,form닫기)
//=========================================================================================
/********************************************************************************
* 기      능   : 조회 1
********************************************************************************/
var fn_query_chk = false; //중복조회 방지용 flag

function fn_query() { 
	
	gfn_clearMsgBar(); 
	
	// sort mark 삭제 
	gfn_clearGridSortMark(grd_bill); 
	
	// 조회조건 항목오류검증
	if (fn_valid_chk("query") == false)  return; 
	
	// 조회조건 설정
	ds_cond.ClearData();   
	if (fn_param_set("query") == false)  return;   
	
	if(!fn_query_chk) {
		fn_query_chk = true;
	} else {
		gfn_showAlert("CW10025", "조회중입니다..");
		return;
	}
	
	// 조회항목 초기화
	F_QTNUM				= "";	// 조회된 견적번호
	F_QTSER				= "";	// 조회된 견적차수
	F_VBELN				= "";	// 조회된 프로젝트번호
	F_RECAD_DA 			= "";	// 조회된 수주승인일
	ed_status.Text 		= "";	// 견적상태
	med_netwr.Text 		= "";	// 수주금액
	med_wavwr.Text 		= "";	// 원가
	med_rate.Text 		= "";	// 시행율
	ed_auart_nm.text 	= "";  	// 문서유형명
	ed_spart_nm.text 	= "";	// 제품군명 
	tab_hdel.TabIndex 	= 0;	// 헤더 탭으로 이동
	
	// 데이타셋 이벤트 비활성화
	ds_dtl.Fireevent = false; 
	ds_list_partner.Fireevent = false; 
	ds_list_item.Fireevent = false; 
	ds_list_bill.Fireevent = false; 
	ds_list_txt.Fireevent = false;  
	
	// 서비스 호출 
	fn_createWait("",this);     // 처리중입니다. 메시지 처리

	ds_dtl.ClearData();		
	ds_list_partner.ClearData();
	ds_list_item.ClearData();
	ds_list_bill.ClearData();
	ds_list_txt.ClearData();
	ds_dtl_save.ClearData();		 
	ds_list_item_save.ClearData();
	ds_list_bill_save.ClearData();
	ds_list_txt_save.ClearData();

	ds_error.ClearData();   	// 결과값 

	var in_ds_list =  " ds_cond=ds_cond" 
					+ " ds_dtl=ds_dtl"
					+ " ds_sto=ds_sto"
					+ " ds_list_partner=ds_list_partner"
					+ " ds_list_item=ds_list_item"
					+ " ds_list_bill=ds_list_bill"
					+ " ds_list_txt=ds_list_txt"
					;
	var out_ds_list = " ds_dtl=ds_dtl"
					+ " ds_sto=ds_sto"
					+ " ds_list_partner=ds_list_partner"
					+ " ds_list_item=ds_list_item"
					+ " ds_list_bill=ds_list_bill"
					+ " ds_list_txt=ds_list_txt"
					+ " ds_error=ds_error"
					;
	
	nsfRequest("query"						// srvId
				, "sso0060N/findOrderChange"			// url
				//, "sso0060/find"			// url
				, in_ds_list				// inDsList
				, out_ds_list				// outDsList
				, ""						// strParam
				, "fn_afterQuery"			// CallBackFunc
				);
 
} 


// 오더유형 조회
function fn_query_auart() { 
	
	// 오더유형 콤보목록 조회
	nsfRequest("query", "combo/comboAuartNm"  , "ds_auart_cd=ds_auart_cd"
											  , "ds_auart_cd=ds_auart_cd ds_error=ds_error"
											  , ""
											  , "fn_afterQuery_auart"); 

 
}

// 건물용도 코드목록 조회함수
function fn_query_bdtyp() 
{      
	nsfRequest("query"									// srvId
				, "com0160/find"						// url
				, "ds_cond_build=ds_cond_build ds_list_build=ds_list_build"		// inDsList
				, "ds_list_build=ds_list_build ds_error=ds_error"	// outDsList
				, ""									// strParam
				, "fn_afterQuery_bdtyp"						// CallBackFunc
				);  
}   

 
//=========================================================================================
// [ PART 4]
// Callback 함수 정의 : callback 함수명은 메인 함수의 fn_xxxx() 에서 xxxx 부분은 fn_afterXXXX()
// 형태가 되도록 작성 
//=========================================================================================
/********************************************************************************
* 기      능   : 조회 Callback  
********************************************************************************/
function fn_afterQuery(errCode, errMsg) {  
	
	fn_query_chk = false; //중복조회 방지용 flag
	fn_destroyWait();  
	
	// 데이타셋 이벤트 활성화
	ds_dtl.Fireevent 			= true; 
	ds_list_partner.Fireevent 	= true; 
	ds_list_item.Fireevent 		= true; 
	ds_list_bill.Fireevent 		= true; 
	ds_list_txt.Fireevent 		= true; 
	
	if(ds_error.RowCount() > 0) 	// 조회실패
	{
		gfn_showMsgBar(ds_error.GetColumn(0,"ERRMSG"), ds_error.GetColumn(0,"ERRCODE"));   
		gfn_openMsgWin(ds_error.GetColumn(0,"ERRMSG"), 'W','A');
		
		// 폼 파라메터가 존재하고 오류코드가 CW10013 이면 화면을 close한다.
		// "CW10013", "${}는 입찰완료정보가 존재하지 않는 견적번호입니다."); 
		if (length(F_QRY_NUM) > 0 && ds_error.GetColumn(0,"ERRCODE")=="CW10013")
		{
			fn_close();
		}
		return;
	} 

	// 조회된 자료가 있을 경우 그리드 첫번째 행에 포커스 위치시킨다.
	if (ds_dtl.RowCount() <= 0) {
		gfn_showMsg("CW00010");	//CW00010 : "데이터가 없습니다."
		return;
	}

	// 거래선명칭 표시
	if(ds_list_partner.rowcount != 0 )
	{ 
		ed_guresun.Text = ds_list_partner.getColumn(1, "PARTNER_NM"); 
	}
	
	F_QTNUM		= ds_dtl.GetColumn(0, "QTNUM");		// 조회된 견적번호
	F_QTSER		= ds_dtl.GetColumn(0, "QTSER");		// 조회된 견적차수
	F_VBELN		= ds_dtl.GetColumn(0, "VBELN");		// 조회된 프로젝트번호
	F_RECAD_DA 	= ds_dtl.GetColumn(0, "RECAD_DA");	// 조회된 수주승인일

	// 금액, 원가, 시행율 산출하여 Display
	med_netwr.text = ds_list_item.sum("NETWR");							// 금액
	med_wavwr.text = ds_list_item.sum("WAVWR");							// 원가
	med_rate.text  = round((parseFloat(med_wavwr.Value) / parseFloat(med_netwr.Value)) * 100,1) ;	// 시행율
	  
	// 청구구분별 총합계
	fn_tot_bill_sum();
	
	// 해외영업부인 경우
	if (ds_dtl.GetColumn(0, "VKBUR") == "B500" ||
		ds_dtl.GetColumn(0, "VKBUR") == "B600" ||
		ds_dtl.GetColumn(0, "VKBUR") == "B700" ||
		ds_dtl.GetColumn(0, "VKBUR") == "B900" ||
		ds_dtl.GetColumn(0, "VKBUR") == "BA00" ||
		ds_dtl.GetColumn(0, "VKBUR") == "BB00" ||
		ds_dtl.GetColumn(0, "VKBUR") == "EH00"	
		)
	{  
		// (헤더청구인경우에만) 품목별 청구 가능
		//trace("BILL_GBN===>" + ds_dtl.GetColumn(0,"BILL_GBN") ); 				 
		//if ( ds_dtl.GetColumn(0,"BILL_GBN") == "H" ) {
		chk_bill_gbn.Enable = true;   
		//}
		
		// 필수항목 재설정  
		tab_hdel.head.cb_wwbld	.style = "sty_ipt_form";
		tab_hdel.head.cb_wwbld_l.style = "sty_ipt_form"; //대분류jss
		tab_hdel.head.ed_repmo	.style = "sty_ipt_form";
		tab_hdel.head.ed_guamo	.style = "sty_ipt_form";
		tab_hdel.head.ed_enfor	.style = "sty_ipt_form"; 
		tab_hdel.head.cb_region	.style = "sty_ipt_form"; 
		tab_hdel.head.cb_turnkey	.style = "sty_ipt_form";
		tab_hdel.head.cb_lifnrchk.style = "sty_ipt_form";
		//tab_hdel.head.cb_kiscon	.style = "sty_ipt_form";
		// tab_hdel.head.cb_hel_reg	.style = "sty_ipt_form"; 
		tab_hdel.item.ed_repmo	.style = "sty_ipt_form"; 
		tab_hdel.item.ed_guamo	.style = "sty_ipt_form"; 
		tab_hdel.item.cb_wwbld	.style = "sty_ipt_form";  
		//tab_hdel.item.cb_kvgr1	.style = "sty_ipt_form";  
		
	}
	else
	{
		// 품목별 청구 가능
		chk_bill_gbn.Enable = false; 
		
		// 필수항목 재설정  
		tab_hdel.head.cb_wwbld	.style = "sty_ipt_form_ind";
		tab_hdel.head.cb_wwbld_l.style = "sty_ipt_form_ind"; //대분류jss
		tab_hdel.head.ed_repmo	.style = "sty_ipt_form_ind";
		tab_hdel.head.ed_guamo	.style = "sty_ipt_form_ind";
		tab_hdel.head.ed_enfor	.style = "sty_ipt_form_ind"; 
		tab_hdel.head.cb_region	.style = "sty_ipt_form_ind"; 
		tab_hdel.head.cb_turnkey	.style = "sty_ipt_form_ind";
		tab_hdel.head.cb_lifnrchk.style = "sty_ipt_form_ind";
		//tab_hdel.head.cb_kiscon	.style = "sty_ipt_form_ind";
		tab_hdel.head.cb_hel_reg	.style = "sty_ipt_form_ind"; 
		tab_hdel.item.ed_repmo	.style = "sty_ipt_form_ind"; 
		tab_hdel.item.ed_guamo	.style = "sty_ipt_form_ind"; 
		tab_hdel.item.cb_wwbld	.style = "sty_ipt_form_ind";  
		//tab_hdel.item.cb_kvgr1	.style = "sty_ipt_form_ind";  
	}
	
	//trace("####################################");
	//trace(left(ds_dtl.GetColumn(0,"AUART"), 2));
	//trace(ds_dtl.GetColumn(0,"VBELN"));
				
	//지급조건, 인도조건1~2 수정 확인 : 2013.09.10 신미정
	if ( ds_dtl.GetColumn(0,"FKSAK") == "C" ) 
	{	cb_zterm.Enable = false;
		cb_inco1.Enable = false;
		ed_inco2.Enable = false;
	} else {
		cb_zterm.Enable = true;
		if ( left(ds_dtl.GetColumn(0,"AUART"), 2) == "ZE" || 
			 left(ds_dtl.GetColumn(0,"AUART"), 2) == "ZC" ||
			 left(ds_dtl.GetColumn(0,"AUART"), 2) == "ZT" )
		{
			cb_inco1.Enable = true;
			ed_inco2.Enable = true;
		} else {
			cb_inco1.Enable = false;
			ed_inco2.Enable = false;
		}
		
	}
	
	//해외경우 현장명 수정 가능하도록 
	if ( left(ds_dtl.GetColumn(0,"AUART"), 2) == "ZE" || 
		 left(ds_dtl.GetColumn(0,"AUART"), 2) == "ZC" ||
		 left(ds_dtl.GetColumn(0,"AUART"), 2) == "ZT" )
	{ 
	  // 2013.04.02 청구계획 일괄복사 기능 활성화
	  tab_hdel.item.btn_plan_copy.Enable = true;
	  ed_bstkd.Enable = true;
	  
	  //해외 부품수출(ZC), 중계무역(ZT)인 경우 납기일 변경 -> 2013.03.13 신미정 
	  if ( left(ds_dtl.GetColumn(0,"AUART"), 2) == "ZC" ||
		   left(ds_dtl.GetColumn(0,"AUART"), 2) == "ZT" )
		{
		  tab_hdel.item.cal_edatu.Enable = true;
		}
		else
		{
		  tab_hdel.item.cal_edatu.Enable = false;
		}
		
		tab_hdel.head.cb_soptp.Enable     = false;
		tab_hdel.head.cal_sopdt.Enable    = false;
	}
	else
	{
	  //ed_bstkd.Enable = false;
	  tab_hdel.item.cal_edatu.Enable = false;
	  
	  if(left(ds_dtl.GetColumn(0,"AUART"), 2) == "ZN") ed_bstkd.Enable = false; //리모델링 현장명변경 제한 : 2021.10 jss
	  else ed_bstkd.Enable = true;
	  
	}
	
	// 수주미생성 견적의 경우 청구구분을 헤더청구로 기본설정처리
	if (length(F_VBELN)==0)
	{
		chk_bill_gbn.Value = "H";	// default = H (헤더청구)
	} 
	
	// 빌링필터조건 SET   
	cb_bill_gbn.Value = ds_dtl.GetColumn(0, "BILL_GBN");  
	fn_bill_filter(); 
	
	// 문서유형명 SET
	ed_auart_nm.text = ds_auart_cd.GetColumn(ds_auart_cd.FindRow("CODE", ds_dtl.GetColumn(0, "AUART"))
											, "CODE_NAME");
	
	// 제품군명 SET
	ed_spart_nm.text = gfn_GetListCodeName(F_FORM_ID, GC_CDGB_SPART, ds_dtl.GetColumn(0, "SPART"));
	
	// 버튼 제어
	tab_hdel.head.div_lifnr1.btn_popLifnr.Enable = true;	// HEAD 공동수급1 검색버튼
	tab_hdel.head.div_lifnr2.btn_popLifnr.Enable = true;	// HEAD 공동수급2검색버튼
	tab_hdel.head.div_lifnr3.btn_popLifnr.Enable = true; // HEAD 공동수급3 검색버튼
	tab_hdel.item.btn_head_copy	.Enable = true;			// 품목 헤더정보 일괄복사 버튼
	tab_hdel.item.btn_sta_copy	.Enable = true;			//착공(골조)예정일 일괄복사
	tab_hdel.txt.btn_input_txt	.Enable = true;			// TEXT 행삽입 버튼
	tab_hdel.txt.btn_append_txt	.Enable = true;			// TEXT 행추가 버튼
	tab_hdel.txt.btn_delete_txt	.Enable = true; 		// TEXT 삭제 버튼
	btn_input_bill	.Enable = true;						// BILLING 행삽입 버튼
	btn_append_bill	.Enable = true;						// BILLING 행추가 버튼
	btn_delete_bill	.Enable = true;						// BILLING 삭제 버튼  
	cb_bill_gbn		.Enable = true;						// 빌링 필터링 콤보

	// 수주승인일이 존재할 경우
	if ( F_RECAD_DA <> "00000000")
	{
		fn_recad_da_exist(false);		// 일부 항목 수정불가 처리
		ed_status.Text = "수주승인완료";
	}
	// 수주승인일이 존재하지 않을 경우
	else
	{
		fn_recad_da_exist(true);			// 모든 항목 수정가능 처리
		
		
		// 프로젝트번호가 존재할 경우
		if (length(F_VBELN) > 0)
		{
			ed_status.Text = "수주생성완료";
		}
		else
		{
			ed_status.Text = "견적낙찰성공";
			
			// 신규 수주건인 경우
			// 품목 그리드의 체크박스를 수정불가능하게 처리하여 
			// 모든 품목이 다 수주생성되도록 처리
			tab_hdel.item.grid_item.SetCellProp("body",1,"Edit","none"); 
			ds_list_item.FireEvent = false;
			for (var i=0; i<ds_list_item.RowCount();i++)
			{
				ds_list_item.SetColumn(i, "CHK"	, 1);
				ds_list_item.SetColumn(i, "FLAG", "I");	// 수주생성을 위해 모두 입력(I)으로 처리
			}
			ds_list_item.FireEvent = true;
	
		}
	}

	tab_hdel.head.cb_achtp.Enable     = true;	// 건축허가유형	
	
	if (tab_hdel.head.cb_achtp.Value == "Y" )
	{
		tab_hdel.head.cal_achdt.Enable    = true;	// 건축허가일
		tab_hdel.head.ed_achno.Enable     = true;	// 건축허가번호		
	} else {
		tab_hdel.head.cal_achdt.Enable    = false;	// 건축허가일
		tab_hdel.head.ed_achno.Enable     = false;	// 건축허가번호		
	}

	if (chk_auptp.Value == "X") {
		cb_year.Enable = true;
	}
	else {
		cb_year.Enable = false;
	}
	
	// 화면제어 : 현장개설일 관련
	if (ds_dtl.GetColumn(0, "SOPTP") == "X")  {
		tab_hdel.head.cb_soptp.Enable     = false;
		tab_hdel.head.cal_sopdt.Enable    = false;	
	} else {
		tab_hdel.head.cb_soptp.Enable     = true;
		tab_hdel.head.cal_sopdt.Enable    = true;	
	}
	
	adjustEnableDpcpd();

	// 조회 변경적용완료
	ds_dtl.ApplyChange();
	ds_list_partner.ApplyChange();  
	ds_list_item.ApplyChange();  
	ds_list_bill.ApplyChange(); 
	ds_list_txt.ApplyChange(); 
	
	
	//건물용도대분류 세팅 : 2020.12 jss
	if( length(trim(ds_dtl.GetColumnNF(0, "WWBLD"))) > 0 ) {
		var wwbld = trim(ds_dtl.GetColumnNF(0, "WWBLD"));
		var rowIdx = ds_list_build.FindRowNF("BUILDUSE", wwbld);
		if(length(trim(ds_list_build.GetColumnNF(rowIdx, "BUILDUSE_L"))) > 0 ){
			var rowIdxL = ds_list_build_l.FindRowNF("BUILDUSE_L", trim(ds_list_build.GetColumnNF(rowIdx, "BUILDUSE_L")));
			tab_hdel.head.cb_wwbld_l.index = rowIdxL;
		}
	 }
	
	
	// CI00001: "조회를 완료했습니다."
	gfn_showMsg("CI00001"); 
} 
function adjustEnableDpcpd() {
	tab_hdel.head.cal_dpcpd.Enable = false;
	if(ds_sto.GetColumn(0, 'ordno') != ed_vbeln_qry.Text
		|| ds_sto.GetColumn(0, 'dpclr') == true
		|| ds_sto.GetColumn(0, 'canfg') == true)
		return;

	tab_hdel.head.cal_dpcpd.Enable = true;
}
// 오더유형코드목록 조회 CALL BACK함수
function fn_afterQuery_auart(errCode, errMsg) 
{   
	
}  


// 건물용도 코드목록 조회 CALL BACK함수
function fn_afterQuery_bdtyp(errCode, errMsg) 
{    
	gfn_InsertRowCombo(ds_list_build, 0, "N", "Y", "BUILDUSE", "STEXT"); // 선택 행 추가
	tab_hdel.head.cb_wwbld.index = 0;
	tab_hdel.item.cb_wwbld.index = 0; 
}   

// 지급조건 코드목록 조회함수
function fn_query_zterm() 
{     
	nsfRequest("query"												// srvId
				, "combo/comboZterm"								// url
				, "ds_list_zterm=ds_list_zterm"						// inDsList
				, "ds_list_zterm=ds_list_zterm ds_error=ds_error"	// outDsList
				, ""												// strParam
				, "fn_afterQuery_zterm"								// CallBackFunc
				); 
}   

// 지급조건 코드목록 조회 CALL BACK함수
function fn_afterQuery_zterm(errCode, errMsg) 
{    
	// HEAD의 지급조건 Filtering 
	gfn_copyDs(ds_list_zterm, ds_list_zterm_head, "CODE=='0001' || CODE=='0002'"||
	                                              "CODE=='LC01' || CODE=='LL01'"|| //2013.01.17  해외 지급조건 추가
	                                              "CODE=='LU01' || CODE=='LU02'"||
	                                              "CODE=='LU03' || CODE=='LU04'"||
	                                              "CODE=='PA01' || CODE=='TB01'"||
	                                              "CODE=='TF01' || CODE=='W001'");
	
	gfn_InsertRowCombo(ds_list_zterm	 , 0, "N", "Y", "CODE", "CODE_NAME"); // 선택 행 추가 
	gfn_InsertRowCombo(ds_list_zterm_head, 0, "N", "Y", "CODE", "CODE_NAME"); // 선택 행 추가 
	cb_zterm.index = 0;
}   

// 인도조건 코드목록 조회함수
function fn_query_inco() 
{     
	nsfRequest("query"												// srvId
				, "combo/comboInco"									// url
				, "ds_list_inco1=ds_list_inco1"						// inDsList
				, "ds_list_inco1=ds_list_inco1 ds_error=ds_error"	// outDsList
				, ""												// strParam
				, "fn_afterQuery_inco"								// CallBackFunc
				); 
}   

// 인도조건 코드목록 조회 CALL BACK함수
function fn_afterQuery_inco(errCode, errMsg) 
{    
	gfn_InsertRowCombo(ds_list_inco1, 0, "N", "Y", "CODE", "CODE_NAME"); // 선택 행 추가
	cb_inco1.index = 0;
}   

// 종별구분 코드목록 조회함수
function fn_query_mlbez() 
{     
	nsfRequest("query"												// srvId
				, "combo/comboMlbez"									// url
				, "ds_list_mlbez=ds_list_mlbez"						// inDsList
				, "ds_list_mlbez=ds_list_mlbez ds_error=ds_error"	// outDsList
				, ""												// strParam
				, "fn_afterQuery_mlbez"								// CallBackFunc
				); 
}   

// 종별구분 코드목록 조회 CALL BACK함수
function fn_afterQuery_mlbez(errCode, errMsg) 
{    
	gfn_InsertRowCombo(ds_list_mlbez, 0, "N", "Y", "CODE", "CODE_NAME"); // 선택 행 추가 
	ds_list_mlbez.row = 0;
}   


/********************************************************************************
* 기      능   : 저장 : 수주생성, 수주변경
********************************************************************************/
function fn_save() { 
	
	gfn_clearMsgBar();   

	// 저장항목 오류검증
	if (fn_valid_chk("save") == false)  return false;
	
	// 저장여부 확인    (프로젝트번호가 없을 경우에는 신규 수주생성)
	var save_gbn = decode(length(F_VBELN), 0 , "입력된 견적정보로 신규 수주가 생성됩니다. 견적정보" 
											 , "기 생성된 수주생성자료가 변경됩니다. 수주정보"); 
	if (!gfn_showConfirm("CI00014", save_gbn))  return false;  
	  
	// 저장항목 값설정   
	if (fn_param_set("save") == false)  return false;
    
//---< 2017.08.31 수주 변경 시 대금청구 삭제 현상 확인 by mj.Shin 		Start 
	destroy("ds_list_bill_chk");
	create("dataset", "ds_list_bill_chk");
	gfn_copyDs(ds_list_bill_save, ds_list_bill_chk, "FKSAF <> '' "); 
	if(ds_list_bill_chk.rowcount() == 0) {
		// CW00208 : "[${}]은/는 필수입력 입니다.확인바랍니다.")
		gfn_showAlert("CW00208", "대금청구 계획");
		return false;	
	}

//---> 2017.08.31 수주 변경 시 대금청구 삭제 현상 확인 by mj.Shin 		End 

	// 서비스 호출 후 사업계획번호 GET
	fn_createWait("",this);     // 처리중입니다. 메시지 처리 

	ds_error.ClearData();   	// 결과값 

	var in_ds_list =  " ds_cond=ds_cond" 
					+ " ds_sto=ds_sto" 
					+ " ds_dtl_save=ds_dtl_save" 
					+ " ds_list_item_save=ds_list_item_save"
					+ " ds_list_txt_save=ds_list_txt_save"
					+ " ds_list_bill_save=ds_list_bill_save"
					+ " ds_error=ds_error"
					;
	var out_ds_list = " ds_error=ds_error"
					;
	
	nsfRequest("update"						     // srvId
				, "sso0060N/saveXmlEstiMateCreate"  // url
				//, "sso0060N/saveEstiMateCreate"  // url
				//, "sso0060/save"                 // url
				, in_ds_list				     // inDsList
				, out_ds_list				     // outDsList
				, ""						     // strParam
				, "fn_afterSave"			     // CallBackFunc
				);

}

/********************************************************************************
* 기      능   : 저장 Callback  
********************************************************************************/
function fn_afterSave(svcId, errCode, errMsg) {   
		
	// 처리중 메세지바 종료처리
	fn_destroyWait();  

	if(ds_error.rowcount() > 0) {    
		gfn_showMsgBar(ds_error.GetColumn(0,"ERRMSG"), ds_error.GetColumn(0,"ERRCODE"));  
		gfn_openMsgWin(ds_error.GetColumn(0,'ERRMSG'), 'W','A');
	} else {  
		
		gfn_showAlert("CI00003");  // CI00003: "저장을 완료했습니다
		
		// 저장 변경적용완료
		ds_dtl.ApplyChange();
		ds_list_partner.ApplyChange();  
		ds_list_item.ApplyChange();  
		ds_list_bill.ApplyChange(); 
		ds_list_txt.ApplyChange(); 
		
		// 저장완료 후 재조회
		fn_query();
	}
} 

********************************************************************************
* 기      능   : 삭제
********************************************************************************/
function fn_delete() { 

	gfn_clearMsgBar();   
	
	// 저장항목 오류검증
	if (fn_valid_chk("delete") == false)  return false;
	
	// 삭제여부 확인
	// "CI00015", "${}을/를 삭제 하시겠습니까?")
	if (!gfn_showConfirm("CI00015", "기 생성된 수주생성자료가 삭제됩니다. 수주정보"))  return false;  
	  
	// 저장항목 값설정   
	if (fn_param_set("delete") == false)  return false;

	/*
	trace(ds_cond.SaveXML());
	trace(ds_dtl_save.SaveXML());
	trace(ds_list_item_save.SaveXML());
	trace(ds_list_txt_save.SaveXML());
	trace(ds_list_bill_save.SaveXML()); 
	*/

	// 서비스 호출 후 사업계획번호 GET

	ds_error.ClearData();   	// 결과값 
	var in_ds_list =  " ds_cond=ds_cond" 
					+ " ds_dtl_save=ds_dtl_save" 
					+ " ds_list_item_save=ds_list_item_save"
					+ " ds_list_txt_save=ds_list_txt_save"
					+ " ds_list_bill_save=ds_list_bill_save"
					+ " ds_error=ds_error"
					;
	var out_ds_list = " ds_error=ds_error"
					;
	
	nsfRequest("update"						// srvId
				//, "sso0060/save"			// url
				, "sso0060N/saveXmlEstiMateCreate"
				, in_ds_list				// inDsList
				, out_ds_list				// outDsList
				, ""						// strParam
				, "fn_afterDelete"			// CallBackFunc
				);
 
	fn_createWait("",this);     // 처리중입니다. 메시지 처리 
}

/********************************************************************************
* 기      능   : 삭제 Callback  
********************************************************************************/
function fn_afterDelete(errCode, errMsg) {   
		
	// 처리중 메세지바 종료처리
	fn_destroyWait();  
	
	/*trace("fn_afterDelete 호출 start");    
	trace("fn_afterDelete.errCode : " + errCode);
	trace("fn_afterDelete.errMsg : " + errMsg); 
	trace(ds_error.SaveXML()); 
	*/
	if(ds_error.rowcount() > 0) {    
		gfn_showMsgBar(ds_error.GetColumn(0,"ERRMSG"), ds_error.GetColumn(0,"ERRCODE"));  
	} else {  
	
		// "CI00004", "삭제를 완료했습니다."
		gfn_showMsg("CI00004"); 
		
		// 저장 변경적용완료
		ds_dtl.ApplyChange();
		ds_list_partner.ApplyChange();  
		ds_list_item.ApplyChange();  
		ds_list_bill.ApplyChange(); 
		ds_list_txt.ApplyChange(); 
		
		// 저장완료 후 재조회
		fn_query();
		
	}
	
	//trace("fn_afterDelete 호출 end");
} 


// 항목 오류 검증
// pProcGb : 처리구분 (query:조회,excel:엑셀)
function fn_valid_chk(pProcGb)
{   
	var arr   = "";
	var ChgYn = "N";
	var posnr = "";	// 판매문서품목번호
	var nRow  = "";
	var netwr = "";	// 품목 수주금액
	var fakwr = ""; // 품목 청구금액합계
						
 	switch(pProcGb)
	{
		  
		case "query" :   // 조회 시

			if (rd_qry_gbn.Value = "P")	// 프로젝트번호로 조회하는 경우
			{
				if (length(ed_vbeln_qry.text) <> 6)
				{
					//"CW00022 : [${}] 을/를 확인하십시요."
					gfn_showAlert("CW00022", rd_qry_gbn.Text);
					gfn_SetFocus(ed_vbeln_qry,"Y"); 
					return false;
				} 
			}   
			
			// 변경된 자료 존재여부 확인
			if(gfn_isChangeDs(ds_dtl		 , false, "", "수주생성")== true )				
			{ 
				var arr = ["조회","계속"];
				// "CI10001", "변경된 자료가 존재합니다. \n${} 할 경우 기존에 변경된 정보가 모두 소실됩니다.\n\n{} 하시겠습니까?"); 			 
				if (gfn_showConfirm("CI10001", arr) == false)  
				{ 
					return false;
				}  
			} 
			 
			break;   
		
		case "bill_gbn" :   // 빌링에서 청구구분 체크 변경 시
			
			// alert("chk_bill_gbn.Value : " + chk_bill_gbn.Value);
			// alert("ds_list_bill.FindRowNF(BILL_GB, H) : " + ds_list_bill.FindRowNF("BILL_GB", "H"));
			// alert("ds_list_bill.FindRowNF(BILL_GB, P) : " + ds_list_bill.FindRowNF("BILL_GB", "P"));
			
			// 프로젝트 빌링 선택 시
			if (chk_bill_gbn.Value == "H")
			{
				// 품목별 빌링이 기 존재하면
				if (ds_list_bill.FindRowNF("BILL_GB", "P") >= 0)
				{
					arr = ["품목별빌링","헤더청구","품목별빌링","헤더청구"];
					// "CI10002", ""${}자료가 존재합니다. \n${}을(를) 선택하실 경우 ${}자료가 모두 소실됩니다.\n${}을(를)선택하시겠습니까?"); 
					if (gfn_showConfirm("CI10002", arr) == false)   
					{ 
						// 품목별빌링 자료 유지 
						ds_dtl.SetColumn(0, "BILL_GBN", "P");
						cb_bill_gbn.Value = "P"; 
						fn_bill_filter();
						return false;
					} 
				}
				 
			}
			// 품목 빌링 선택 시
			else if (chk_bill_gbn.Value == "P" || chk_bill_gbn.Value == "A")
			{
				// 프로젝트 빌링이 기 존재하면
				if (ds_list_bill.FindRowNF("BILL_GB", "H") >= 0)
				{
					arr = ["헤더청구","품목별빌링","헤더청구","품목별빌링"]; 
					// "CI10002", ""${}자료가 존재합니다. \n${}을(를) 선택하실 경우 ${}자료가 모두 소실됩니다.\n${}을(를)선택하시겠습니까?"); 
					if (gfn_showConfirm("CI10002", arr) == false)   
					{ 
						// 선택하지 않기  : 프로젝트빌링 자료 유지 
						ds_dtl.SetColumn(0, "BILL_GBN", "H");
						cb_bill_gbn.Value = "H";  
						fn_bill_filter();
						return false;
					} 
				}
				 
			} 
			 
			break;   
			
		case "input_bill" :   // 빌링에서 입력/행추가 버튼 클릭 시
			  
			if (chk_bill_gbn.Value == "")
			{
				// CW00208 : "[${}]은/는 필수입력 입니다.확인바랍니다.")
				gfn_showAlert("CW00208", "청구구분");
				gfn_SetFocus(chk_bill_gbn,"N"); 
				return false;
			}
				
			 
			break;   
				
		case "save":   	// 저장
		  
			// 변경된 내역 존재여부 체크 
			// 기능개선
			//if(gfn_isChangeDs(ds_dtl, true, "FLAG", "수주생성")== false) 
			//{ 
			//	return false; 
			//}      
			if( IsDatasetUpdate() == false ) {
			    gfn_showAlert("CW00006", "수주변경 자료");
			    return false;
			}
			
			// 견적에서 넘어오는 필수데이타 체크
			//  : 부서코드, 팀코드, 판매문서유형코드, 제품군코드,
			//    통화, 납품요청일, 판매처코드, 대리님코드, 담당자코드
			//    건물용도코드, 
			//  : 자재번호, 수주금액, 원가, SPEC
			if (length(ds_dtl.GetColumn(0, "VKBUR"))==0)
			{
				// CW00208 : "[${}]은/는 필수입력 입니다.확인바랍니다.")
				gfn_showAlert("CW00208", "견적자료 중 부서");
				gfn_SetFocus(ed_vkbur_nm,"Y"); 
				return false;
			}
			if (length(ds_dtl.GetColumn(0, "VKGRP"))==0)
			{
				// CW00208 : "[${}]은/는 필수입력 입니다.확인바랍니다.")
				gfn_showAlert("CW00208", "견적자료 중 팀");
				gfn_SetFocus(ed_vkgrp_nm,"Y"); 
				return false;
			} 
			if (length(ds_dtl.GetColumn(0, "VDATU"))==0)
			{
				// CW00208 : "[${}]은/는 필수입력 입니다.확인바랍니다.")
				gfn_showAlert("CW00208", "견적자료 중 납기일");
				gfn_SetFocus(cal_vdatu,"Y"); 
				return false;
			} 
			if (length(ds_dtl.GetColumn(0, "WWBLD"))==0)
			{
				// CW00208 : "[${}]은/는 필수입력 입니다.확인바랍니다.")
				gfn_showAlert("CW00208", "견적자료 중 건물용도");
				tab_hdel.TabIndex = 0; 		// HEADER TAB으로 이동
				gfn_SetFocus(tab_hdel.head.cb_wwbld,"Y"); 
				return false;
			}
			/**
			if (length(ds_dtl.GetColumn(0, "WWBLD_L"))==0)
			{
				// CW00208 : "[${}]은/는 필수입력 입니다.확인바랍니다.")
				gfn_showAlert("CW00208", "견적자료 중 대분류");
				tab_hdel.TabIndex = 0; 		// HEADER TAB으로 이동
				gfn_SetFocus(tab_hdel.head.cb_wwbld_l,"Y"); 
				return false;
			}
			*/
		    fakwr = ds_list_item.CaseSum("MATNR==''", "FAKWR"); // 자재번호가 없는 품목의 수주금액SUM 
			if (fakwr > 0)
			{
				// CW00208 : "[${}]은/는 필수입력 입니다.확인바랍니다.")
				gfn_showAlert("CW00208", "견적자료 중 품목의 자재번호");
				gfn_SetFocusGrid(tab_hdel.item.grid_item, 0, 4);
				return false;
			}  
						
			// 납품요청일 필수체크 (견적기초자료에서 체크하고 있으므로 불필요)
			// if (length(ds_dtl.GetColumn(0, "VDATU"))==0)
			// {
				////CW00208 : "[${}]은/는 필수입력 입니다.확인바랍니다.")
				// gfn_showAlert("CW00208", "납품요청일");
				// gfn_SetFocus(cal_vdatu,"Y"); 
				// return false;
			// }     
			
			// 지급조건 필수체크
			if (length(ds_dtl.GetColumn(0, "ZTERM"))==0)
			{
				// CW00208 : "[${}]은/는 필수입력 입니다.확인바랍니다.")
				gfn_showAlert("CW00208", "지급조건");
				gfn_SetFocus(cb_zterm,"Y"); 
				return false;
			} 
			
			// 파트너 그리드 체크
			for (var i=0; i<=ds_list_partner.RowCount(); i++)
			{     
				// 파트너가 판매처(KUNNR_RG), 납품처(KUNNR_WE),담당자(KUNNR_Z2)인 경우
				if (ds_list_partner.GetColumn(i, "PARTNER_GB") == "KUNNR_RG" 
					|| ds_list_partner.GetColumn(i, "PARTNER_GB") == "KUNNR_WE" 
					|| ds_list_partner.GetColumn(i, "PARTNER_GB") == "KUNNR_Z2"
					|| ds_list_partner.GetColumn(i, "PARTNER_GB") == "KUNNR_RG2") 
				{
					// 파트너코드  필수 체크 
					if (length(ds_list_partner.GetColumn(i, "PARTNER_CD"))==0
						|| length(ds_list_partner.GetColumn(i, "PARTNER_NM"))==0)
					{ 
						nRow = ds_partner_gbn.FindRow("CODE", ds_list_partner.GetColumn(i, "PARTNER_GB"));
						// CW00208 : "[${}]은/는 필수입력 입니다.확인바랍니다.")
						gfn_showAlert("CW00208", ds_partner_gbn.GetColumn(nRow, "CODE_NAME")); 
						gfn_SetFocusGrid(grid_partner, i, 0); 
						return false;
					}  
				}
				// 파트너가 대리점(KUNNR_Z1)인 경우
				else if (ds_list_partner.GetColumn(i, "PARTNER_GB") == "KUNNR_Z1") 
				{ 
					// 문서유형 뒤 2자리가 01:직영, 02:대리점 이므로
					// 대리점 체크는 문서유형 뒤 2자리가 02일 경우만 필수체크하기로 함
					if (
							(substr(ds_dtl.GetColumn(0, "AUART"),1,1)!="E")	// 대리점인 경우
							&&
							(substr(ds_dtl.GetColumn(0, "AUART"),2,2)=="02")	// 대리점인 경우
							&&
							(length(ds_list_partner.GetColumn(i, "PARTNER_CD"))==0
								|| length(ds_list_partner.GetColumn(i, "PARTNER_NM"))==0)
						)
					{ 
						nRow = ds_partner_gbn.FindRow("CODE", ds_list_partner.GetColumn(i, "PARTNER_GB"));
						// CW00208 : "[${}]은/는 필수입력 입니다.확인바랍니다.")
						gfn_showAlert("CW00208", ds_partner_gbn.GetColumn(nRow, "CODE_NAME")); 
						gfn_SetFocusGrid(grid_partner, i, 0); 
						return false;
					}  
				}
			} 
			
			// 계약일 필수체크
			if (length(ds_dtl.GetColumn(0, "CONTR_DA"))==0)
			{
				// CW00208 : "[${}]은/는 필수입력 입니다.확인바랍니다.")
				gfn_showAlert("CW00208", "헤더의 계약일");
				tab_hdel.TabIndex = 0; 		// HEADER TAB으로 이동
				gfn_SetFocus(tab_hdel.head.cal_contr_da,"Y"); 
				return false;
			} 
			
			if(tab_hdel.head.cal_dpcpd.Enable = true
				&& (ds_sto.GetColumn(0,'dpcpd') == '' || ds_sto.GetColumn(0,'dpcpd') == null)
				&& (left(ds_dtl.GetColumn(0,'AUART'), 2) == 'ZS' || left(ds_dtl.GetColumn(0,'AUART'), 2) == 'ZN')) {
				gfn_showAlert("CW00208", "STO 계약금 수금예정일");
				tab_hdel.TabIndex = 0; 		// HEADER TAB
				gfn_SetFocus(tab_hdel.head.cal_dpcpd,"Y"); 
				return false;
			}
			
			// 건물용도 필수체크 (견적기초자료에서 체크하고 있으므로 불필요)
			// if (length(ds_dtl.GetColumn(0, "WWBLD"))=="0
			// {
				////CW00208 : "[${}]은/는 필수입력 입니다.확인바랍니다.")
				// gfn_showAlert("CW00208", "건물용도");
				// gfn_SetFocus(tab_hdel.head.cb_wwbld,"Y"); 
				// return false;
			// }  
			
			// 해외영업부가 경우에만 필수인 항목 체크
			if (   ds_dtl.GetColumn(0, "VKBUR") <> "B500" 
				&& ds_dtl.GetColumn(0, "VKBUR") <> "B600" 
				&& ds_dtl.GetColumn(0, "VKBUR") <> "B700" 
				&& ds_dtl.GetColumn(0, "VKBUR") <> "B900"
				&& ds_dtl.GetColumn(0, "VKBUR") <> "BA00"
				&& ds_dtl.GetColumn(0, "VKBUR") <> "BB00"
				&& ds_dtl.GetColumn(0, "VKBUR") <> "EH00"      )
			{  
				// 무상보수개월수 필수체크
				if (length(trim(ds_dtl.GetColumn(0, "REPMO"))) == 0) 
				{
					// CW00208 : "[${}]은/는 필수입력 입니다.확인바랍니다.")
					gfn_showAlert("CW00208", "헤더의 무상보수개월수");
					tab_hdel.TabIndex = 0; 		// HEADER TAB으로 이동
					gfn_SetFocus(tab_hdel.head.ed_repmo,"Y"); 
					return false;
				} 
				
				// 하자보증개월수 필수체크
				if (length(trim(ds_dtl.GetColumn(0, "GUAMO")))==0)
				{
					// CW00208 : "[${}]은/는 필수입력 입니다.확인바랍니다.")
					gfn_showAlert("CW00208", "헤더의 하자보증개월수");
					tab_hdel.TabIndex = 0; 		// HEADER TAB으로 이동
					gfn_SetFocus(tab_hdel.head.ed_guamo,"Y"); 
					return false;
				} 
				
				// 시행사 필수체크
				if (length(trim(ds_dtl.GetColumn(0, "ENFOR")))==0)
				{
					// CW00208 : "[${}]은/는 필수입력 입니다.확인바랍니다.")
					gfn_showAlert("CW00208", "헤더의 시행사");
					tab_hdel.TabIndex = 0; 		// HEADER TAB으로 이동
					gfn_SetFocus(tab_hdel.head.ed_enfor,"Y"); 
					return false;
				} 
				
				// 설치보수지역 필수체크
				if (length(trim(ds_dtl.GetColumn(0, "REGION")))==0)
				{
					// CW00208 : "[${}]은/는 필수입력 입니다.확인바랍니다.")
					gfn_showAlert("CW00208", "헤더의 설치보수지역");
					tab_hdel.TabIndex = 0; 		// HEADER TAB으로 이동
					gfn_SetFocus(tab_hdel.head.cb_region,"Y"); 
					return false;
				} 
				
				// 공사구분 필수체크
				if (length(trim(ds_dtl.GetColumn(0, "TURNKEY")))==0)
				{
					// CW00208 : "[${}]은/는 필수입력 입니다.확인바랍니다.")
					gfn_showAlert("CW00208", "헤더의 공사구분");
					tab_hdel.TabIndex = 0; 		// HEADER TAB으로 이동
					gfn_SetFocus(tab_hdel.head.cb_turnkey,"Y"); 
					return false;
				} 
				
				// 계약형태 필수체크
				if (length(trim(ds_dtl.GetColumn(0, "LIFNRCHK")))==0)
				{
					// CW00208 : "[${}]은/는 필수입력 입니다.확인바랍니다.")
					gfn_showAlert("CW00208", "헤더의 계약형태");
					tab_hdel.TabIndex = 0; 		// HEADER TAB으로 이동
					gfn_SetFocus(tab_hdel.head.cb_lifnrchk,"Y"); 
					return false;
				}  
				
				// KISCON등록(원도급)  필수체크
				/*if (length(ds_dtl.GetColumn(0, "KISCON"))==0)
				{
					// CW00208 : "[${}]은/는 필수입력 입니다.확인바랍니다.")
					gfn_showAlert("CW00208", "헤더의 KISCON등록(원도급) ");
					tab_hdel.TabIndex = 0; 		// HEADER TAB으로 이동
					gfn_SetFocus(tab_hdel.head.cb_kiscon,"Y"); 
					return false;
				} */  
				
				// 당사등록  필수체크
				if (length(trim(ds_dtl.GetColumn(0, "HEL_REG")))==0)
				{
					// CW00208 : "[${}]은/는 필수입력 입니다.확인바랍니다.")
					gfn_showAlert("CW00208", "헤더의 당사등록 ");
					tab_hdel.TabIndex = 0; 		// HEADER TAB으로 이동
					gfn_SetFocus(tab_hdel.head.cb_hel_reg,"Y"); 
					return false;
				}  
				
				// 건축허가 정보 필수 Check  		
				if (ds_dtl.GetColumn(0, "ACHTP") == "X") 
				{
					if (length(trim(ds_dtl.GetColumn(0, "ACHDT")))==0 ) 
					{
						gfn_showAlert("CW00208", "건축 허가일");
						tab_hdel.TabIndex = 0; 		// HEADER TAB으로 이동
						gfn_SetFocus(tab_hdel.head.cal_achdt,"Y"); 
						return false;				
					}
					
					if (length(trim(ds_dtl.GetColumn(0, "ACHNO")))==0 )
					{
						gfn_showAlert("CW00208", "건축 허가번호");
						tab_hdel.TabIndex = 0; 		// HEADER TAB으로 이동
						gfn_SetFocus(tab_hdel.head.ed_achno,"Y"); 
						return false;								
					}
				
				}								

				if (length(ds_dtl.GetColumn(0, "EMAIL"))==0)
				{
					// CW00208 : "[${}]은/는 필수입력 입니다.확인바랍니다.")
					gfn_showAlert("CW00208", "계약 담당자 이메일");
					gfn_SetFocus(tab_hdel.head.ed_email,"Y"); 
					return false;
				} 
				// 현장개설 관련 Check
				// 수주 변경 시 현장개설 일자 필수 Check 제외(수주 입력 시 필수 체크, 양철민C 요청) by mj.Shin 2020.03.23 
				/*if ( trim(ds_dtl.GetColumn(0, "SOP_Y_REGDT")) == "00000000" && ( length(trim(ds_dtl.GetColumn(0, "SOPDT"))) == 0 || ds_dtl.GetColumn(0, "SOPDT") == "00000000" ) )
				{
					gfn_showAlert("CW00208", "현장개설(예정)일자");
					tab_hdel.TabIndex = 0; 		// HEADER TAB으로 이동
					gfn_SetFocus(tab_hdel.head.cal_sopdt,"Y"); 
					return false;				
				}
				
				if (ds_dtl.GetColumn(0, "SOPTP") == "X") 
				{								
					if ( trim(ds_dtl.GetColumn(0, "SOP_Y_REGDT")) == "00000000" && ( ds_dtl.GetColumn(0, "SOPDT") > substr(gfn_getCurrDate(),0,8) ) ) 
					{
						gfn_showAlert("CW10025", "현장 개설 후 현장개설(예정)일자는 과거/금일 날짜만 입력 가능합니다.");
						tab_hdel.TabIndex = 0; 		// HEADER TAB으로 이동
						gfn_SetFocus(tab_hdel.head.cal_sopdt,"Y"); 
						return false;				
					}					
										
				} else {
					
					if ( ds_dtl.GetColumn(0, "SOPDT") <= substr(gfn_getCurrDate(),0,8) ) 
					{
						gfn_showAlert("CW10025", "현장개설 전 현장개설(예정)일자는 미래 날짜만 입력 가능합니다.");
						tab_hdel.TabIndex = 0; 		// HEADER TAB으로 이동
						gfn_SetFocus(tab_hdel.head.cal_sopdt,"Y"); 
						return false;				
					}					
				}*/
			}
			
			//2021.06 jss
			var vRecadDa = "";	
			var vBstdk = "";
			if( !(ds_dtl.GetColumn(0,"RECAD_DA") == "" || ds_dtl.GetColumn(0,"RECAD_DA") == null || ds_dtl.GetColumn(0,"RECAD_DA") == "00000000")) {
				vRecadDa = ds_dtl.GetColumn(0,"RECAD_DA");
			}
			if( !(ds_dtl.GetColumn(0,"BSTDK") == "" || ds_dtl.GetColumn(0,"BSTDK") == null || ds_dtl.GetColumn(0,"BSTDK") == "00000000")) {
				vBstdk = ds_dtl.GetColumn(0,"BSTDK");
			}
			
			// 품목 그리드 체크
			for (var i=0; i<ds_list_item.RowCount(); i++)
			{   
			
				posnr = ds_list_item.GetColumn(i, "POSNR"); // 판매문서품목번호
					
				// 수주생성 저장인 경우에는 모든 행에 대해서 체크하고
				// 기 생성된 수주자료의 경우에는 선택된 행에 대하여
				if (ds_list_item.GetColumn(i, "CHK") == 1 )
				{ 
					
					// 해외영업부가 경우에만 필수인 항목 체크
					if (   ds_dtl.GetColumn(0, "VKBUR") <> "B500" 
						&& ds_dtl.GetColumn(0, "VKBUR") <> "B600"  
						&& ds_dtl.GetColumn(0, "VKBUR") <> "B700" 
						&& ds_dtl.GetColumn(0, "VKBUR") <> "B900" 
						&& ds_dtl.GetColumn(0, "VKBUR") <> "BA00" 
						&& ds_dtl.GetColumn(0, "VKBUR") <> "BB00" 
						&& ds_dtl.GetColumn(0, "VKBUR") <> "EH00")
					{  
					 
						// 무상보수개월수 필수 체크
						if (length(trim(ds_list_item.GetColumn(i, "REPMO")))==0)
						{
							// CW00208 : "[${}]은/는 필수입력 입니다.확인바랍니다.")
							gfn_showAlert("CW00208", posnr + " 품목의 무상보수개월수");
							tab_hdel.TabIndex = 1; 		// 품목 TAB으로 이동
							gfn_SetFocus(tab_hdel.item.ed_repmo,"Y"); 
							return false;
						}
						// 하자보증 개월수  필수 체크
						if (length(trim(ds_list_item.GetColumn(i, "GUAMO")))==0)
						{
							// CW00208 : "[${}]은/는 필수입력 입니다.확인바랍니다.")
							gfn_showAlert("CW00208", posnr + " 품목의 하자보증 개월수");
							tab_hdel.TabIndex = 1; 		// 품목 TAB으로 이동
							gfn_SetFocus(tab_hdel.item.ed_guamo,"Y"); 
							return false;
						}
						// 건물용도 필수 체크
						if (length(trim(ds_list_item.GetColumn(i, "WWBLD")))==0)
						{
							// CW00208 : "[${}]은/는 필수입력 입니다.확인바랍니다.")
							gfn_showAlert("CW00208", posnr + " 품목의 건물용도");
							tab_hdel.TabIndex = 1; 		// 품목 TAB으로 이동
							gfn_SetFocus(tab_hdel.item.cb_wwbld,"Y"); 
							return false;
						}
					}
					
					// 납기일 필수 체크
					if (length(trim(ds_list_item.GetColumn(i, "EDATU")))==0)
					{
						// CW00208 : "[${}]은/는 필수입력 입니다.확인바랍니다.")
						gfn_showAlert("CW00208", posnr + " 품목의 납기일");
						tab_hdel.TabIndex = 1; 		// 품목 TAB으로 이동
						gfn_SetFocus(tab_hdel.item.cal_edatu,"Y"); 
						return false;
					} 
					
				}
				
				// 품목별 빌링인경우
				// 수주금액 <> 청구금액합계 이면 오류 
				if (chk_bill_gbn.Value == "P")
				{
					// 품목별 수주금액
					netwr = ds_list_item.GetColumn(i, "NETWR");
					// 품목별 청구금액합계
					fakwr = ds_list_bill.CaseSumNF("BILL_GB=='P' AND POSNR=='"+posnr+"'", "FAKWR");
					
	// med_fakwr_totsum.text = ds_list_bill.CaseSumNF("BILL_GB=='" + chk_bill_gbn.Value +"'", "FAKWR");

					//trace("품목별 수주금액 netwr 	 : " + ds_list_item.GetColumn(i, "NETWR")); 
					//trace("품목별 청구금액합계 fakwr : " + fakwr);
					
					//NETWR  FAKWR
					//if (netwr==0 || fakwr==0 || netwr <> fakwr)
					if (netwr <> fakwr)
					{
						//trace("netwr==0 || fakwr==0 || netwr <> fakwr");
						arr = [ "판매문서품목(" 	+ ds_list_item.GetColumn(i,"POSNR") + ")",
								"청구금액합계(" 	+ fakwr + ")",
								"품목별 수주금액(" 	+ netwr + ")"
								]; 
						//"CW10011", "${}의 [${}]은 [${}]과 동일해야 합니다." 
						gfn_showAlert("CW10011",arr); 
						tab_hdel.TabIndex = 1;							// 품목 탭으로 이동
						gfn_SetFocusGrid(tab_hdel.item.grid_item, i, 6); 	// 품목의 수주금액 셀 포커싱처리
						ds_list_item_OnRowPosChanged(ds_list_item,-1,i);// 품목의 수주금액 셀 포커싱처리
						return false;	
					}
				}
				
				//2021.06 jss
				//착공예정일 필수 체크
				if((left(ds_dtl.GetColumn(0,'AUART'), 2) == 'ZS' || left(ds_dtl.GetColumn(0,'AUART'), 2) == 'ZN')) {
					if(ds_list_item.GetColumn(i,"NETWR") > 0){
						if( ds_list_item.GetColumn(i,"STADA") == "" || ds_list_item.GetColumn(i,"STADA") == null || ds_list_item.GetColumn(i,"STADA") == "00000000" ) {
							// CW00208 : "[${}]은/는 필수입력 입니다.확인바랍니다.")
							gfn_showAlert("CW00208", posnr + " 품목의 착공예정일");
							tab_hdel.TabIndex = 1; 		// 품목 TAB으로 이동
							gfn_SetFocusGrid(tab_hdel.item.grid_item, i, gfn_getColIdx(tab_hdel.item.grid_item,'STADA')); 
							return false;
						}
						
						//골조완료예정일 필수 체크
						if( ds_list_item.GetColumn(i,"ZRMDA") == "" || ds_list_item.GetColumn(i,"ZRMDA") == null || ds_list_item.GetColumn(i,"ZRMDA") == "00000000" ) {
							// CW00208 : "[${}]은/는 필수입력 입니다.확인바랍니다.")
							gfn_showAlert("CW00208", posnr + " 품목의 골조완료예정일");
							tab_hdel.TabIndex = 1; 		// 품목 TAB으로 이동
							gfn_SetFocusGrid(tab_hdel.item.grid_item, i, gfn_getColIdx(tab_hdel.item.grid_item,'ZRMDA')); 
							return false;
						}
						
						if(vRecadDa != ""){
							if(toNumber(vRecadDa) > toNumber(ds_list_item.GetColumn(i,"STADA"))){
								alert(posnr + " 품목의 착공예정일이 수주승인일보다 작습니다.");
								tab_hdel.TabIndex = 1; 		// 품목 TAB으로 이동
								gfn_SetFocusGrid(tab_hdel.item.grid_item, i, gfn_getColIdx(tab_hdel.item.grid_item,'STADA')); 
								return false;
							}
							if(toNumber(vRecadDa) > toNumber(ds_list_item.GetColumn(i,"ZRMDA"))){
								alert(posnr + " 품목의 골조완료예정일이 수주승인일보다 작습니다.");
								tab_hdel.TabIndex = 1; 		// 품목 TAB으로 이동
								gfn_SetFocusGrid(tab_hdel.item.grid_item, i, gfn_getColIdx(tab_hdel.item.grid_item,'ZRMDA')); 
								return false;
							}
						 }
		
						if(vBstdk != ""){
							if(toNumber(vBstdk) > toNumber(ds_list_item.GetColumn(i,"STADA"))){
								alert(posnr + " 품목의 착공예정일이 수주일보다 작습니다.");
								tab_hdel.TabIndex = 1; 		// 품목 TAB으로 이동
								gfn_SetFocusGrid(tab_hdel.item.grid_item, i, gfn_getColIdx(tab_hdel.item.grid_item,'STADA')); 
								return false;
							}
							if(toNumber(vBstdk) > toNumber(ds_list_item.GetColumn(i,"ZRMDA"))){
								alert(posnr + " 품목의 골조완료예정일이 수주일보다 작습니다.");
								tab_hdel.TabIndex = 1; 		// 품목 TAB으로 이동
								gfn_SetFocusGrid(tab_hdel.item.grid_item, i, gfn_getColIdx(tab_hdel.item.grid_item,'ZRMDA')); 
								return false;
							}
						 }
					 }
				 }
			}  
			 
			if (chk_bill_gbn.Value == "")
			{
				// CW00208 : "[${}]은/는 필수입력 입니다.확인바랍니다.")
				gfn_showAlert("CW00208", "청구구분");
				gfn_SetFocus(chk_bill_gbn,"N"); 
				return false;
			}  
			
			// 헤더청구 빌링인경우
			// 수주금액 <> 청구금액합계 이면 오류 
			if (chk_bill_gbn.Value == "H")
			{
				// 빌링의 수주금액합계 <> 청구금액합계 이면 오류  
				netwr = ds_list_item.Sum("NETWR");  					// 품목별 수주금액합계 
				fakwr = ds_list_bill.CaseSumNF("BILL_GB=='"+chk_bill_gbn.Value+"'", "FAKWR");  // 품목별 청구금액합계
				//trace("헤더 수주금액 netwr 	 : " + netwr);
				//trace("헤더 청구금액합계 fakwr : " + fakwr); 
				//if (netwr==0 || fakwr==0 || netwr <> fakwr)

				if (ToString(netwr) <> ToString(ds_list_bill.Sum("FAKWR"))) //정밀도위해 문자처리
				{
					arr = [ "헤더청구 빌링",
							"청구금액합계(" + fakwr + ")",
							"수주금액합계(" + netwr + ")"
							]; 
					//"CW10011", "${}의 [${}]은 [${}]과 동일해야 합니다." 
					gfn_showAlert("CW10011",arr); 
					tab_hdel.TabIndex = 1;				// 품목 탭으로 이동
					gfn_SetFocusGrid(grd_bill, 0, 5); 	// 청구금액 셀 포커싱처리   
					return false;	
				}
			}			
			
			//2013.02.13 신미정: 필터링된 데이터내에서 체크 하도록 수정, ex)RowCountNF -> RowCount로변경
			// 빌링 그리드 체크 
			var posnr_nm = "";
			for (var i=0; i<ds_list_bill.RowCount(); i++)
			{    
				//trace("빌링 그리드 체크 i : " + i);
				
				// 품목별 그리드에서 빌링의 행을 찾는다. 
				posnr = ds_list_bill.GetColumn(i, "POSNR");
				nRow = ds_list_item.FindRow("POSNR", posnr);
				posnr_nm = iif(chk_bill_gbn.Value=="H","","품목번호["+posnr+"]의 ");
				
				//trace("빌링 그리드 체크 nRow : " + nRow);
				
				// 청구계획일 필수 체크
				//trace("빌링 그리드 체크 : 청구계획일 필수 체크");
				if (length(trim(ds_list_bill.GetColumn(i, "FKDAT")))==0)
				{
					// CW00208 : "[${}]은/는 필수입력 입니다.확인바랍니다.")
					gfn_showAlert("CW00208", posnr_nm + "빌링 " + parseInt(i+1) + "행의 청구계획일"); 
					tab_hdel.TabIndex = 1;		// 품목 탭으로 이동
					ds_list_item.row = iif(nRow>=0, nRow, i); 
					gfn_SetFocusGrid(grd_bill, nRow, "FKDAT") ; 
					return false;
				} 
				// 청구계획일 날짜오류  체크 
				//trace("빌링 그리드 체크 : 청구계획일 날짜오류  체크 ");
				if (gfn_chkDate(ds_list_bill.GetColumn(i, "FKDAT") 
								, posnr_nm + "빌링 " + parseInt(i+1) + "행의 청구계획일" 
								, true)  == -1)
				{ 
					tab_hdel.TabIndex = 1;		// 품목 탭으로 이동
					ds_list_item.row = iif(nRow>=0, nRow, i);
					gfn_SetFocusGrid(grd_bill, nRow, "FKDAT") ; 
					return false;
				} 
				// 종별구분 필수 체크
				//trace("빌링 그리드 체크 : 종별구분 필수 체크 ");
				if (length(trim(ds_list_bill.GetColumn(i, "MLBEZ")))==0)
				{
					// CW00208 : "[${}]은/는 필수입력 입니다.확인바랍니다.")
					gfn_showAlert("CW00208", posnr_nm + "빌링 " + parseInt(i+1) + "행의 종별구분"); 
					tab_hdel.TabIndex = 1;		// 품목 탭으로 이동
					ds_list_item.row = iif(nRow>=0, nRow, i);
					gfn_SetFocusGrid(grd_bill, i, "MLBEZ") ; 
					return false;
				}  
				// 청구금액 필수 체크
				//trace("빌링 그리드 체크 : 청구금액 필수 체크 ");
/*				if (ds_list_bill.GetColumnNF(i, "FAKWR")==0)
				{
					// CW00208 : "[${}]은/는 필수입력 입니다.확인바랍니다.")
					gfn_showAlert("CW00208", posnr_nm + "빌링 " + parseInt(i+1) + "행의 청구금액"); 
					tab_hdel.TabIndex = 1;		// 품목 탭으로 이동
					ds_list_item.row = iif(nRow>=0, nRow, i);
					gfn_SetFocusGrid(grd_bill, i, "FAKWR") ; 
					return false;
				}     */
				// 지급조건 필수 체크
				//trace("빌링 그리드 체크 :  지급조건 필수 체크");
				if (length(trim(ds_list_bill.GetColumn(i, "ZTERM")))==0)
				{
					// CW00208 : "[${}]은/는 필수입력 입니다.확인바랍니다.")
					gfn_showAlert("CW00208", posnr_nm + "빌링 " + parseInt(i+1) + "행의 지급조건"); 
					tab_hdel.TabIndex = 1;		// 품목 탭으로 이동
					ds_list_item.row = iif(nRow>=0, nRow, i);
					gfn_SetFocusGrid(grd_bill, i, "ZTERM") ; 
					return false;
				} 
				
				// 청구계획 종별 CHECK 강화  - 201312  계약관리팀 홍수봉 DL 요청  by 김선호 20140121  재 반영 2015.10.15
				// 1. A(선수금) 선택시 종별은 계약시 OR 도면승인시만 선택 가능 
				if ( ds_dtl.GetColumn(0, "VKBUR") != "B500" && 
			         ds_dtl.GetColumn(0, "VKBUR") != "B600" &&  
			         ds_dtl.GetColumn(0, "VKBUR") != "B700" && 
			         ds_dtl.GetColumn(0, "VKBUR") != "B900" &&
					 ds_dtl.GetColumn(0, "VKBUR") != "BA00" && 
					 ds_dtl.GetColumn(0, "VKBUR") != "BB00" &&
					 ds_dtl.GetColumn(0, "VKBUR") != "EH00" ) {
			     
			    //trace(ds_dtl.GetColumn(0,"RECAD_DA"));
			    if ( ds_dtl.GetColumn(0,"RECAD_DA") == "" || ds_dtl.GetColumn(0,"RECAD_DA") == "00000000" ) {  //
				switch ( substr(ds_list_bill.GetColumnNF(i, "ZTERM"),0,1))
				{
					case 'A' :
						if ( ds_list_bill.GetColumnNF(i, "MLBEZ") != '10001' &&      //계약시
							 ds_list_bill.GetColumnNF(i, "MLBEZ") != '10002'         //도면승인시
							 //ds_list_bill.GetColumnNF(i, "MLBEZ") != '10003' 
							 //ds_list_bill.GetColumnNF(i, "MLBEZ") != '10011' &&  제외  
							 //ds_list_bill.GetColumnNF(i, "MLBEZ") != '10012' &&
							 //ds_list_bill.GetColumnNF(i, "MLBEZ") != '20000'   
						   ){
							Alert(posnr_nm + "빌링 " + parseInt(i+1) + "행의 지급조건 선수금일 경우 종별구분은  계약시 or 도면승인시 입니다."); 
							//tab_hdel.TabIndex = 1;		// 품목 탭으로 이동
							//ds_list_item.row = iif(nRow>=0, nRow, i);
							gfn_SetFocusGrid(grd_bill, i, "ZTERM") ; 
							return false;					
						}
						break;
					case 'B' :
						if ( ds_list_bill.GetColumnNF(i, "MLBEZ") != '10003' &&       //착공시(선적시)
						     ds_list_bill.GetColumnNF(i, "MLBEZ") != '10004' &&       //주자재반입시
							 ds_list_bill.GetColumnNF(i, "MLBEZ") != '10005' &&       //출입구완료시
							 ds_list_bill.GetColumnNF(i, "MLBEZ") != '10006' &&       //주자재설치시
							 ds_list_bill.GetColumnNF(i, "MLBEZ") != '10007' &&       //설치완료시  
							 ds_list_bill.GetColumnNF(i, "MLBEZ") != '10008' &&       //완성검사시
							 //ds_list_bill.GetColumnNF(i, "MLBEZ") != '10011' && 
							 //ds_list_bill.GetColumnNF(i, "MLBEZ") != '10012' &&
							 ds_list_bill.GetColumnNF(i, "MLBEZ") != '20000'   ){     //월기성
							Alert(posnr_nm + "빌링 " + parseInt(i+1) + "행의 지급조건 중도금일 경우 종별구분은 주자재반입시 or 출입구완료시 or 주자재설치시 or 설치완료시 or 완성검사시 or 월기성입니다."); 
							//tab_hdel.TabIndex = 1;		// 품목 탭으로 이동
							//ds_list_item.row = iif(nRow>=0, nRow, i);
							gfn_SetFocusGrid(grd_bill, i, "ZTERM") ; 
							return false;					
						}
						break;	
					case 'C' :	
						/*if ( ds_dtl.GetColumn(0, "CONTR_DA") < '20160302' ) {  //계약일  구분 
						 if ( ds_list_bill.GetColumnNF(i, "MLBEZ") != '10007' &&       //설치완료시   >>> 잔금 선택 제외 계약관리팀20160229
						  	  ds_list_bill.GetColumnNF(i, "MLBEZ") != '10008' &&       //완성검사시
							  ds_list_bill.GetColumnNF(i, "MLBEZ") != '10009' &&       //인도시
							  ds_list_bill.GetColumnNF(i, "MLBEZ") != '10010' &&       //건물준공시
							  ds_list_bill.GetColumnNF(i, "MLBEZ") != '10011' &&       //분할청구(교체)
							  ds_list_bill.GetColumnNF(i, "MLBEZ") != '10012' &&       //일괄청구(분할수금)
							  ds_list_bill.GetColumnNF(i, "MLBEZ") != '20000'          //월기성
						    ){
							  Alert(posnr_nm + "빌링 " + parseInt(i+1) + "행의 지급조건 잔금일 경우 종별구분은  설치완료시 or 완성검사시 or 인도시 or  건물준공시 or 월기성 or 분할청구입니다."); 
							  //tab_hdel.TabIndex = 1;		// 품목 탭으로 이동
							  //ds_list_item.row = iif(nRow>=0, nRow, i);
							  gfn_SetFocusGrid(grd_bill, i, "ZTERM") ; 
							  return false;					
						     } }
						else  {*/
							if ( ds_list_bill.GetColumnNF(i, "MLBEZ") != '10007' &&       //설치완료시   >>> 잔금 선택 제외 계약관리팀20160229 >> 다시 원복 20160607 계약관리팀 
							    ds_list_bill.GetColumnNF(i, "MLBEZ") != '10008' &&       //완성검사시
							    ds_list_bill.GetColumnNF(i, "MLBEZ") != '10009' &&       //인도시
								ds_list_bill.GetColumnNF(i, "MLBEZ") != '10010' &&       //건물준공시
								ds_list_bill.GetColumnNF(i, "MLBEZ") != '10011' &&       //분할청구(교체)
								ds_list_bill.GetColumnNF(i, "MLBEZ") != '10012' &&       //일괄청구(분할수금)
								ds_list_bill.GetColumnNF(i, "MLBEZ") != '20000'          //월기성
						       ){
								 Alert(posnr_nm + "빌링 " + parseInt(i+1) + "행의 지급조건 잔금일 경우 종별구분은  완성검사시 or 인도시 or  건물준공시 or 월기성 or 분할청구입니다."); 
								 //tab_hdel.TabIndex = 1;		// 품목 탭으로 이동
								 //ds_list_item.row = iif(nRow>=0, nRow, i);
								 gfn_SetFocusGrid(grd_bill, i, "ZTERM") ; 
								 return false;					
						        }
						//}
						break;
					break;
					default :					
				} } }
			} 
			
			break;  
		
		case "delete" :   // 삭제 시
		
			if (ds_dtl.RowCount() == 0)	// 자료가 존재하지 않는 경우
			{
				gfn_showAlert("CW00054");
				gfn_SetFocus(ed_vbeln_qry,"Y");
				return false;
			}    

			// 변경된 내역 존재여부 체크  
			if(
					   gfn_isChangeDs(ds_dtl		 , false, "", "수주생성")== true
					|| gfn_isChangeDs(ds_list_partner, false, "", "수주생성")== true
					|| gfn_isChangeDs(ds_list_txt	 , false, "", "수주생성")== true
					|| gfn_isChangeDs(ds_list_bill	 , false, "", "수주생성")== true
			   )				
			{
				// "CW00072", " 삭제가 불가한 데이터입니다."; 			 
				gfn_showAlert("CW00072");
				return false;
			} 

			break;   
		
		case "close":   	// 닫기 
		
			// 변경된 내역 존재여부 체크  
			if(
					   gfn_isChangeDs(ds_dtl		 , false, "", "수주생성")== true
					|| gfn_isChangeDs(ds_list_partner, false, "", "수주생성")== true
					|| gfn_isChangeDs(ds_list_txt	 , false, "", "수주생성")== true
					|| gfn_isChangeDs(ds_list_bill	 , false, "", "수주생성")== true
			   )				
			{ 
				var arr = ["닫기","계속"];
				// "CI10001", "변경된 자료가 존재합니다. \n${} 할 경우 기존에 변경된 정보가 모두 소실됩니다.\n\n{} 하시겠습니까?"); 			 
				if (gfn_showConfirm("CI10001", arr) == false)  
				{ 
					return false;
				}  
			} 
			
			break;
			 
		default: 
			break; 
	}   

	return true;
}

// INPUT PARAM SET
// pProcGb : 처리구분 (query:조회)
function fn_param_set(pProcGb)
{   
	
	switch(pProcGb)
	{
		case "query" :  // 조회 시
			 
			ds_cond.AddRow();   
			ds_cond.SetColumn(0, "CMD"		, "DISP" 			); // DISP:조회, SAVE:생성, UPDT:변경, DELE:삭제
			ds_cond.SetColumn(0, "QRY_GB"	, rd_qry_gbn.Value	); // 조회구분(Q:견적번호, P:프로젝트)

			if (rd_qry_gbn.Value == "P")		// 프로젝트번호로 조회 시
			{
				ds_cond.SetColumn(0, "PSPID", trim(ed_vbeln_qry.Text) 	); // 프로젝트번호                 
			} 

			break;  
			
		case "save" :  // 수주생성 또는 수주변경 시
			
			ds_cond.ClearData();
			ds_cond.AddRow(); 
			if (length(F_VBELN)==0)		// 프로젝트번호 미존재 시 수주생성
			{
				ds_cond.SetColumn(0, "CMD", "SAVE" ); // DISP:조회, SAVE:수주생성, UPDT:수주변경, DELE:삭제
			}
			else
			{
				ds_cond.SetColumn(0, "CMD", "UPDT" ); // DISP:조회, SAVE:수주생성, UPDT:수주변경, DELE:삭제				
			} 
			ds_cond.SetColumn(0, "PSPID"	, F_VBELN); // 프로젝트번호           
			ds_cond.SetColumn(0, "QTNUM"	, F_QTNUM); // 견적번호           
			ds_cond.SetColumn(0, "QTSER"	, F_QTSER); // 견적차수     
			
			// WEB -> SAP 변환
			if (chk_auptp.Value == "0") ds_dtl.SetColumn(0, "AUPTP", ""); 
			if (chk_arcpi.Value == "0") ds_dtl.SetColumn(0, "ARCPI", ""); 
			if (cb_year.Value == "") 	ds_dtl.SetColumn(0, "AUPYEAR", "0000");
						
			// HEAD 데이타셋 복사
			gfn_copyDs(ds_dtl, ds_dtl_save, ""); 
			
			for (var i=0; i< ds_dtl_save.RowCount(); i++)
			{
				// HEAD 저장 데이타셋에 날짜항목 포맷설정 
				fn_format_date(ds_dtl_save, i, "BSTDK");		// 수주일
				fn_format_date(ds_dtl_save, i, "RECAD_DA");		// 수주승인일
				fn_format_date(ds_dtl_save, i, "VDATU");		// 납기일
				fn_format_date(ds_dtl_save, i, "CONTR_DA"); 	// 계약일
				fn_format_date(ds_dtl_save, i, "COMPL_DA");  	// 건물준공일
				fn_format_date(ds_dtl_save, i, "FINAL_DA");    	// 최종완료일
				fn_format_date(ds_dtl_save, i, "HB_FROM");  	// 하자보증기간_FROM
				fn_format_date(ds_dtl_save, i, "HB_TO");    	// 하자보증기간_TO 	
				fn_format_date(ds_dtl_save, i, "ACHDT");    	// 건축 허가일
				fn_format_date(ds_dtl_save, i, "SOPDT");    	// 현장 개설(예정) 일자
				fn_format_date(ds_dtl_save, i, "SOP_Y_REGDT"); 	// 현장 개설 등록일자 
				/*if (ds_cond.GetColumn(0,"CMD") == "UPDT") {
					ds_dtl_save.SetColumn(i,"WAERK", "");
				}*/
			}  
			//trace(ds_dtl_save.savexml());
			// 품목 데이타셋 복사 (변경된 건만 복사 :  I(수주생성),U:(수주변경))
			//gfn_copyDs(ds_list_item, ds_list_item_save, "(FLAG=='I' || FLAG=='U') && CHK =='1' "); 
			//gfn_copyDs(ds_list_item, ds_list_item_save, ""); 
			gfn_copyDs(ds_list_item, ds_list_item_save, "NETWR > 0 "); 
			//trace("~~~~~~~~~~~~~" + ds_list_item_save.savexml());
			for (var i=0; i< ds_list_item_save.RowCount(); i++)
			{
				// 품목 저장 데이타셋에 날짜항목 포맷설정 
				fn_format_date(ds_list_item_save, i, "EDATU");		// 납기일 
				fn_format_date(ds_list_item_save, i, "CONDA");		// 협의납기일 
				fn_format_date(ds_list_item_save, i, "STADA");		// 착공예정일 
				fn_format_date(ds_list_item_save, i, "ZRMDA");		// 골조완료예정일 
			} 
			
			// TEXT 데이타셋 복사 (TEXT에 값이 있는 행만 복사)
			gfn_copyDs(ds_list_txt, ds_list_txt_save, "TEXT <> ''");
			
			// 빌링 데이타셋 복사 (청구계획일에 값이 있는 행만 복사)   
			ds_list_bill_save.ClearData();
		 	for (var i=0; i< ds_list_bill.RowCountNF(); i++)
			{
				// 청구구분과 같은 빌링 데이타이면서 회수계획일에 값이 있는 경우만 빌링으로 저장함
				if (ds_list_bill.GetColumnNF(i, "BILL_GB") == chk_bill_gbn.Value
					&& length(ds_list_bill.GetColumnNF(i, "FKDAT")) > 0)
				{
					ds_list_bill_save.AddRow();  
					ds_list_bill_save.SetColumn(ds_list_bill_save.row, "FLAG"	, ds_list_bill.GetColumnNF(i,"FLAG"		)); // FLAG
					ds_list_bill_save.SetColumn(ds_list_bill_save.row, "BILL_GB", ds_list_bill.GetColumnNF(i,"BILL_GB"	)); // 빌링구분(H:프로젝트,P:품목)
					ds_list_bill_save.SetColumn(ds_list_bill_save.row, "VBELN"	, ds_list_bill.GetColumnNF(i,"VBELN"	)); // 프로젝트번호
					ds_list_bill_save.SetColumn(ds_list_bill_save.row, "POSNR"	, ds_list_bill.GetColumnNF(i,"POSNR"	)); // 품목번호
					ds_list_bill_save.SetColumn(ds_list_bill_save.row, "MLBEZ"	, ds_list_bill.GetColumnNF(i,"MLBEZ"	)); // 종별구분
					ds_list_bill_save.SetColumn(ds_list_bill_save.row, "FKDAT"	, ds_list_bill.GetColumnNF(i,"FKDAT"	)); // 납기일
					fn_format_date(ds_list_bill_save, ds_list_bill_save.row, "FKDAT");										// 납기일 
					ds_list_bill_save.SetColumn(ds_list_bill_save.row, "ZTERM"	, ds_list_bill.GetColumnNF(i,"ZTERM"	)); // 지급조건
					ds_list_bill_save.SetColumn(ds_list_bill_save.row, "FAKWR"	, ds_list_bill.GetColumnNF(i,"FAKWR"	)); // 청구금액
					ds_list_bill_save.SetColumn(ds_list_bill_save.row, "FAKSP"	, ds_list_bill.GetColumnNF(i,"FAKSP"	)); // 지급조건
					ds_list_bill_save.SetColumn(ds_list_bill_save.row, "FKSAF"	, ds_list_bill.GetColumnNF(i,"FKSAF"	)); // 빌링상태
					ds_list_bill_save.SetColumn(ds_list_bill_save.row, "WAERK"	, ds_dtl_save.GetColumn(0,"WAERK"		)); // 통화코드
				}
			}  
			
			break;
			
		case "delete" :  // 삭제시

			ds_cond.ClearData();
			ds_cond.AddRow();

			ds_cond.SetColumn(0, "CMD"		, "DELE" 			); 	// DISP:조회, SAVE:생성, UPDT:변경, DELE:삭제

			ds_cond.SetColumn(0, "PSPID"	, F_VBELN); // 프로젝트번호           
			ds_cond.SetColumn(0, "QTNUM"	, F_QTNUM); // 견적번호           
			ds_cond.SetColumn(0, "QTSER"	, F_QTSER); // 견적차수     
			
			// HEAD 데이타셋 복사
			gfn_copyDs(ds_dtl, ds_dtl_save, ""); 
			for (var i = 0; i < ds_dtl_save.RowCount(); i++)
			{
				// HEAD 저장 데이타셋에 날짜항목 포맷설정 
				fn_format_date(ds_dtl_save, i, "BSTDK");		// 수주일
				fn_format_date(ds_dtl_save, i, "RECAD_DA");		// 수주승인일
				fn_format_date(ds_dtl_save, i, "VDATU");		// 납기일
				fn_format_date(ds_dtl_save, i, "CONTR_DA"); 	// 계약일
				fn_format_date(ds_dtl_save, i, "COMPL_DA");  	// 건물준공일
				fn_format_date(ds_dtl_save, i, "FINAL_DA");    	// 최종완료일
				fn_format_date(ds_dtl_save, i, "HB_FROM");  	// 하자보증기간_FROM
				fn_format_date(ds_dtl_save, i, "HB_TO");    	// 하자보증기간_TO 
				
				//ds_dtl_save.SetColumn(i,"WAERK", "");
				
			}  
			
			// 품목 데이타셋 복사 (변경된 건만 복사 :  전체)
			gfn_copyDs(ds_list_item, ds_list_item_save, ""); 
			for (var i = 0; i < ds_list_item_save.RowCount(); i++)
			{
				// 품목 저장 데이타셋에 날짜항목 포맷설정 
				fn_format_date(ds_list_item_save, i, "EDATU");		// 납기일 
				fn_format_date(ds_list_item_save, i, "CONDA");		// 협의납기일 
				fn_format_date(ds_list_item_save, i, "STADA");		// 착공예정일 
				fn_format_date(ds_list_item_save, i, "ZRMDA");		// 골조완료예정일 
			} 
			
			// TEXT 데이타셋 복사 (TEXT에 값이 있는 행만 복사)
			gfn_copyDs(ds_list_txt, ds_list_txt_save, "TEXT <> ''");
			
			// 빌링 데이타셋 복사 (청구계획일에 값이 있는 행만 복사)   
			ds_list_bill_save.ClearData();
		 	for (var i = 0; i < ds_list_bill.RowCountNF(); i++)
			{
				// 청구구분과 같은 빌링 데이타이면서 청구계획일에 값이 있는 경우만 빌링으로 저장함
				if (ds_list_bill.GetColumnNF(i, "BILL_GB") == chk_bill_gbn.Value
					&& length(ds_list_bill.GetColumnNF(i, "FKDAT")) > 0)
				{
					ds_list_bill_save.AddRow();  
					ds_list_bill_save.SetColumn(ds_list_bill_save.row, "FLAG"	, ds_list_bill.GetColumnNF(i,"FLAG"		)); // FLAG
					ds_list_bill_save.SetColumn(ds_list_bill_save.row, "BILL_GB", ds_list_bill.GetColumnNF(i,"BILL_GB"	)); // 빌링구분(H:프로젝트,P:품목)
					ds_list_bill_save.SetColumn(ds_list_bill_save.row, "VBELN"	, ds_list_bill.GetColumnNF(i,"VBELN"	)); // 프로젝트번호
					ds_list_bill_save.SetColumn(ds_list_bill_save.row, "POSNR"	, ds_list_bill.GetColumnNF(i,"POSNR"	)); // 품목번호
					ds_list_bill_save.SetColumn(ds_list_bill_save.row, "MLBEZ"	, ds_list_bill.GetColumnNF(i,"MLBEZ"	)); // 종별구분
					ds_list_bill_save.SetColumn(ds_list_bill_save.row, "FKDAT"	, ds_list_bill.GetColumnNF(i,"FKDAT"	)); // 납기일
					fn_format_date(ds_list_bill_save, ds_list_bill_save.row, "FKDAT");										// 납기일 
					ds_list_bill_save.SetColumn(ds_list_bill_save.row, "ZTERM"	, ds_list_bill.GetColumnNF(i,"ZTERM"	)); // 지급조건
					ds_list_bill_save.SetColumn(ds_list_bill_save.row, "FAKWR"	, ds_list_bill.GetColumnNF(i,"FAKWR"	)); // 청구금액
					ds_list_bill_save.SetColumn(ds_list_bill_save.row, "WAERK"	, ds_dtl_save.GetColumn(0,"WAERK"		)); // 통화코드
				}
			}  

			break;  
				
		default: 
			break; 
	}   

	return true;
	
}

// SAP으로 저장하기 위해 날짜타입에 포맷설정
function fn_format_date(pDs, pRow, pColid)
{   
	var date = gfn_getFormatDate(F_FORM_ID, pDs.GetColumn(pRow, pColid), "-");
	
	//trace("fn_format_date.date : " + date);
	pDs.SetColumn(pRow, pColid , date);   
}

// 파트너 그리드 툴팁 제공
function grid_partner_OnMouseOver(obj,nPosX,nPosY,nRow,nCell,nPivotIndex)
{
	if (nCell == 2) // 파트너이름
	{
		grid_partner.ToolTipText = ds_list_partner.GetColumn(nRow, "PARTNER_NM");
	}
	else if (nCell == 3) // 파트너정보
	{
		grid_partner.ToolTipText = ds_list_partner.GetColumn(nRow, "PARTNER_INFO");
	}
	else
	{
		grid_partner.ToolTipText  = "";
	}
}

// 검색조건 옵션버튼 클릭 시 : 견적번호, 프로젝트번호
function rd_qry_gbn_OnClick(obj)
{ 
	// alert("rd_qry_gbn_OnClick");
	
	ed_qtnum_qry.top = 7;
	btn_popQtnum.top = 8;
	ed_vbeln_qry.top = 7;
	
	//if (rd_qry_gbn.Value = "Q")				// 견적번호 선택 시
	//{
	//	ed_qtnum_qry.visible = true;
		//btn_popQtnum.Visible = true;
	//	ed_vbeln_qry.visible = false; 
	//	ed_qtnum_qry.SetFocus();
	//	ed_qtnum_qry.Text = "A200000001";	// 임시코딩 : 삭제필요
	//}
	//else 
	if (rd_qry_gbn.Value = "P")		// 프로젝트 선택 시
	{
		ed_qtnum_qry.visible = false;
		btn_popQtnum.Visible = false;
		ed_vbeln_qry.visible = true;
		ed_vbeln_qry.SetFocus();
		//ed_vbeln_qry.text = "T10050";  		// 임시코딩 : 삭제필요
	}
}

// 파트너 그리드에서 납품처, 기술영업담당자 변경 선택 시
function grid_partner_OnExpandEdit(obj,nRow,nCell,strVal,nPivotIndex)
{
	if (ds_list_partner.RowCount()==0) return;
	
	var partner_gb = ds_list_partner.GetColumn(nRow, "PARTNER_GB");	// 파트너역할구분
	
	switch (partner_gb)
	{
		case "KUNNR_WE":  // 납품처
		
			// 기술영업담당자 선택 팝업화면 OPEN
			var arg = ""
					+ " fa_frm_title= " + quote("납품처 조회") 	// 팝업화면 제목
					+ " fa_code= " 		+ quote("") 			// 팝업화면 코드
					+ " fa_code_name= " + quote("") 			// 팝업화면 명
					; 
		
			var arr = gfn_openPopUpUrlHdel("Com::Com0190.xml", true, arg );	 
			
			// trace("arr : " + arr); 
			
			if (arr != null && arr != 0)
			{
				ds_list_partner.SetColumn(ds_list_partner.row, "PARTNER_CD" 	, arr[0]);	// 코드
				ds_list_partner.SetColumn(ds_list_partner.row, "PARTNER_NM"		, arr[1]);	// 명 
				ds_list_partner.SetColumn(ds_list_partner.row, "PARTNER_INFO"	, arr[2]);	// 정보 
			}
			
			break; 
		
		case "KUNNR_Z3":  // 기술영업담당자
		
			// 기술영업담당자 선택 팝업화면 OPEN
			var arg = ""
					+ " fa_frm_title= " + quote("기술영업담당자 조회") 	// 팝업화면 제목
					+ " fa_sman_cd= " 	+ quote("") 					// 팝업화면 담당자코드
					+ " fa_sman_nm= " 	+ quote("") 					// 팝업화면 담당자명
					+ " fa_sman_filter= "+ quote("H") 					// 팝업화면 담당자필터조건(H:직원만조회
					; 
		
			var arr = gfn_openPopUpUrlHdel("Com::Com0030.xml", true, arg );	 
			
			// trace("arr : " + arr); 
			
			if (arr != null && arr != 0)
			{
				ds_list_partner.SetColumn(ds_list_partner.row, "PARTNER_CD" 	, arr[0]);	// 담당자코드
				ds_list_partner.SetColumn(ds_list_partner.row, "PARTNER_NM"		, arr[1]);	// 담당자명
				ds_list_partner.SetColumn(ds_list_partner.row, "PARTNER_INFO"	, arr[2]);	// 담당자정보
			}
			
			break; 
			
		case "KUNNR_RG2":  // 지급인  2013.02.06 추가 
		
			// 선택 팝업화면 OPEN
			var arg = ""
					+ " fa_frm_title= " + quote("지급인 조회") 	// 팝업화면 제목
					+ " fa_code= " 		+ quote("") 			// 팝업화면 코드
					+ " fa_code_name= " + quote("") 			// 팝업화면 명
					; 
		
			var arr = gfn_openPopUpUrlHdel("Com::Com0040.xml", true, arg );	 
			
			//trace("arr : " + arr); 
			
			if (arr != null && arr != 0)
			{
				ds_list_partner.SetColumn(ds_list_partner.row, "PARTNER_CD" 	, arr[0]);	// 코드
				ds_list_partner.SetColumn(ds_list_partner.row, "PARTNER_NM"		, arr[1]);	// 명 
				ds_list_partner.SetColumn(ds_list_partner.row, "PARTNER_INFO"	, arr[2]);	// 정보 
			}
			
			break; 
			
			
		default :
			break; 
	} 
}

function tab_hdel_item_grid_item_OnExpandEdit(obj,nRow,nCell,strVal,nPivotIndex)
{
	var posnr = "";
	var matnr = "";

	if (ds_list_item.RowCount()==0) return;

	switch (nCell)
	{
		case 6:  // SPEC
			ds_arg.ClearData(); 
			var nRow = ds_arg.addRow();

			ds_arg.setColumn(nRow, "GUBUN", "SO");		// 수주
		    ds_arg.setColumn(nRow, "MANDT", G_MANDT); 
		    ds_arg.setColumn(nRow, "QTNUM", ed_qtnum.Value); 
		    ds_arg.setColumn(nRow, "QTSER", ed_qtser.Value);
		    ds_arg.setColumn(nRow, "VBELN", ed_vbeln.Value);	// 프로젝트
		    ds_arg.setColumn(nRow, "QTSEQ", ds_list_item.getColumn(ds_list_item.row, "QTSEQ"));  // 견적일련번호

			matnr = trim( ds_list_item.getColumn(ds_list_item.row, "MATNR") );
			if (matnr == null || matnr == "")
		    {
				gfn_showAlert("CW10046");
				return false;
		    }
		    ds_arg.setColumn(nRow, "MATNR", matnr);  // 자재번호

			// 판매문서품목 체크
		    posnr = trim(ds_list_item.getColumn(ds_list_item.row, "POSNR"));
		    if (posnr == null || posnr == "")
		    {
				gfn_showAlert("CW10068");
				return false;
		    }

		    ds_arg.setColumn(nRow, "POSNR", posnr);   // 판매문서품목

			ds_arg.setColumn(nRow, "HOGI", trim(ds_list_item.getColumn(ds_list_item.row, "HOGI")));   // 호기

			var arr = gfn_openPopUpUrlHdel("SSO::Sso0062.xml", true, "");
			if (arr != null && arr != 0) {
				return;
			}			
			
			break; 
			
		default :
			break; 
	} 
} 

// 빌링구분별 빌링목록 필터링
function fn_bill_filter()
{  
	//trace("fn_bill_filter");
	
	if (ds_dtl.RowCount() == 0) return; 
	
	var posnr = ds_list_item.GetColumn(ds_list_item.row,"POSNR"); // 품목번호
	if (cb_bill_gbn.Value == "H") 				// 프로젝트인 경우
	{
		grd_bill.SetColProp(2, "Width", 0 );	// 판매문서품목번호  안보이게
		ds_list_bill.Filter("BILL_GB=='H'");
	}
	else if (cb_bill_gbn.Value == "P") 			// 품목별인 경우
	{
		grd_bill.SetColProp(2, "Width", 80 );	// 판매문서품목번호  보이게
		ds_list_bill.Filter("BILL_GB=='P' && POSNR=='"+posnr+"'");
	}
	else if (cb_bill_gbn.Value == "A") 			// 품목전체인 경우
	{
		grd_bill.SetColProp(2, "Width", 80 );	// 판매문서품목번호  보이게 
		ds_list_bill.Filter("BILL_GB=='P'");
	}
	
	// 청구구분과 필터조건이 불일치할 경우에 행삽입, 행추가, 행삭제 불가처리
	if ( (chk_bill_gbn.Value == "H" && cb_bill_gbn.Value <> "H") ||
		 (chk_bill_gbn.Value == "P" && cb_bill_gbn.Value == "H")
		)
	{
		btn_input_bill.Enable  = false;
		btn_append_bill.Enable = false;
		btn_delete_bill.Enable = false;
	}
	else
	{
		// 2013.01.24 수주완료의 경우는 false처리 (단, 문서유혀의 앞2자리가 ZE, ZT, ZC는 true)
		if (length(trim(F_RECAD_DA)) > 0)	{	// 수주승인의 경우
			if( substr(ed_auart.Text, 0, 2) == "ZE" ||
				substr(ed_auart.Text, 0, 2) == "ZT" ||
				substr(ed_auart.Text, 0, 2) == "ZC" )	{
				btn_input_bill.Enable  = true;
				btn_append_bill.Enable = true;
				btn_delete_bill.Enable = true;
			}else	{
				btn_input_bill.Enable  = false;
				btn_append_bill.Enable = false;
				btn_delete_bill.Enable = false;
			}
		}else	{
			btn_input_bill.Enable  = true;
			btn_append_bill.Enable = true;
			btn_delete_bill.Enable = true;
		}
	}
	
	// 필터구분별 합계
	fn_filter_bill_sum();	
}

// 빌링 입력버튼 클릭 시
function btn_input_bill_OnClick(obj)
{

	// 행추가 조건 항목 오류검증
	if (fn_valid_chk("input_bill") == false)  return;  
	
	// 행추가 (입력:현재 행 앞에 삽입됨, 행추가:맨뒤에 추가됨))
	var newRow = gfn_addGridRow(grd_bill, iif(obj.id=="btn_append_bill",-1,ds_list_bill.row), "FLAG");	// 추가된 행번호를 받아옴  
		
	// 판매문서품목번호 GET (프로젝트별 빌링일 경우에는 "")
	var posnr = ds_list_item.GetColumn(ds_list_item.row, "POSNR");  
	
	/// 새로 추가된 행에 기본값을 설정한다.	
	ds_list_bill.Fireevent = false;		
																		
	ds_list_bill.SetColumn(newRow, "VBELN"	, ds_dtl.GetColumn(ds_dtl.row, "VBELN")	);	// 프로젝트
	ds_list_bill.SetColumn(newRow, "POSNR"	, iif(cb_bill_gbn.Value="H","", posnr)	);	// 판매문서품목번호
	ds_list_bill.SetColumn(newRow, "WAERK"	, ds_dtl.GetColumn(ds_dtl.row, "WAERK")	);	// 통화 
	ds_list_bill.SetColumn(newRow, "BILL_GB", iif(cb_bill_gbn.Value="A","P",cb_bill_gbn.Value));	// 청구구분
	ds_list_bill.SetColumn(newRow, "FAKSP"  , "02");	// 보류 구분 
	ds_list_bill.SetColumn(newRow, "FKSAF"  , "A");	// BILLST 구분 
	ds_list_bill.Fireevent = true;	
	// 그리드 포커싱 (청구계획일에 포커싱처리)
	gfn_SetFocusGrid(grd_bill, ds_list_bill.row, 3);  
	 
}

// 빌링 삭제버튼 클릭 시
function btn_delete_bill_OnClick(obj)
{
	ds_list_bill.DeleteRow(ds_list_bill.row);
	ds_dtl.SetColumn(0,"FLAG","U");
}

// 텍스트 입력버튼 클릭 시
function tab_hdel_txt_btn_input_txt_OnClick(obj)
{
	var vDate = " ";

	vDate  = "[" + substr(gfn_getCurrDate(), 0, 4) + "-";
	vDate += substr(gfn_getCurrDate(), 4, 2) + "-";
	vDate += substr(gfn_getCurrDate(), 6, 2) + "]";

	// 행추가 조건 항목 오류검증
	//if (fn_valid_chk("input_txt") == false)  return;  
	
	// 행추가 : (입력:현재 행 앞에 삽입됨, 행추가:맨뒤에 추가됨)
	var newRow = gfn_addGridRow(tab_hdel.txt.grid_txt, iif(obj.id=="btn_append_txt",-1,ds_list_txt.row), "FLAG");	// 추가된 행번호를 받아옴  
	 
	/// 새로 추가된 행에 기본값을 설정한다.	ds_list_bill.Fireevent = false;
	ds_list_txt.Fireevent = false;		
	ds_list_txt.SetColumn(newRow, "VBELN"  , ds_dtl.GetColumn(ds_dtl.row,"VBELN"));	// 프로젝트
	ds_list_txt.Fireevent = true;	

	// 행추가 및 행삽입 시 현재일자 자동 입력처리
	ds_list_txt.SetColumn(newRow, "TEXT", vDate);
	
	// 그리드 포커싱 (프로젝트내역)
	gfn_SetFocusGrid(tab_hdel.txt.grid_txt, ds_list_txt.row, 2);  
}


// 텍스트 삭제버튼 클릭 시
function tab_hdel_txt_btn_delete_txt_OnClick(obj)
{
	ds_list_txt.DeleteRow(ds_list_txt.row); 
	ds_dtl.SetColumn(0,"FLAG","U");
} 

// 품목 그리드 컬럼 데이타 변경 시
function ds_list_item_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{
	// 값이 변경되었을 경우 변경구분 컬럼 자동 SET 
	if (varNewValue != varOldValue)  
	{ 
		obj.Fireevent = false; 
		gfn_changeFlag( obj, strColumnID, nRow, "FLAG");   	// FLAG 변경 : U
		if ( !(strColumnID == "CHK" && varOldValue == "1") ) { // 2013.03.14 체크박스 토글 기능을 위해 수정
			ds_list_item.SetColumn(nRow, "CHK", "1");		// 체크박스 : 체크
		}
		ds_dtl.SetColumn(0, "FLAG", "U");					// 전체 변경구분 SET
		obj.Fireevent = true;  
	} 
}

// 빌링 그리드 컬럼 데이타 변경 시
function ds_list_bill_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{ 
	// 값이 변경되었을 경우 변경구분 컬럼 자동 SET 
	if (varNewValue != varOldValue)  
	{   
		obj.Fireevent = false; 
		gfn_changeFlag( obj, strColumnID, nRow, "FLAG");   	// FLAG 변경 : U 
		 
		if (strColumnID=="FAKWR")
		{    
			fn_filter_bill_sum();	// 필터링별 합계
			fn_tot_bill_sum();		// 청구구분별합계
			
		}
		ds_dtl.SetColumn(0, "FLAG", "U");	// 변경구분 SET
		
		obj.Fireevent = true;  
	} 
}

// 필터링별 빌링 합계 산출
function fn_filter_bill_sum()
{ 
	
	// 프로젝트빌링 합계
	if (cb_bill_gbn.Value == "H")
	{ 
		//med_fakwr_sum.text = ds_list_bill.CaseSumNF("BILL_GB=='H'", "FAKWR");
		var totSum = 0;
		for (var i=0; i<ds_list_bill.RowCount(); i++)  {
			if( ds_list_bill.GetColumn(i, "BILL_GB") == 'H' ) {
			    totSum = toNumber(totSum) + toNumber(ds_list_bill.GetColumn(i, "FAKWR"));
			}
		}
		med_fakwr_sum.text = totSum;
	}
	// 품목별빌링 합계
	else if (cb_bill_gbn.Value == "P" )
	{ 
		var posnr = ds_list_item.GetColumn(ds_list_item.row, "POSNR");  // 품목번호
		//med_fakwr_sum.text = ds_list_bill.CaseSumNF("BILL_GB=='P' AND POSNR=='"+posnr+"'", "FAKWR"); 
		
		var totSum = 0;
		for (var i=0; i<ds_list_bill.RowCount(); i++)  {
			if( ds_list_bill.GetColumn(i, "BILL_GB") == 'P' && ds_list_bill.GetColumn(i, "POSNR") == posnr ) {
			    totSum = toNumber(totSum) + toNumber(ds_list_bill.GetColumn(i, "FAKWR"));
			}
		}
		med_fakwr_sum.text = totSum;

	}
	// 품목전체 빌링 합계
	else if (cb_bill_gbn.Value == "A" )
	{ 
		// med_fakwr_sum.text 	= ds_list_bill.CaseSumNF("BILL_GB=='P'", "FAKWR"); 
		var totSum = 0;
		for (var i=0; i<ds_list_bill.RowCount(); i++)  {
			if( ds_list_bill.GetColumn(i, "BILL_GB") == 'P' ) {
			    totSum = toNumber(totSum) + toNumber(ds_list_bill.GetColumn(i, "FAKWR"));
			}
		}
		med_fakwr_sum.text = totSum;
	}
} 

// 청구구분별 빌링 합계 산출
function fn_tot_bill_sum()
{  
	// med_fakwr_totsum.text = ds_list_bill.CaseSumNF("BILL_GB=='" + chk_bill_gbn.Value +"'", "FAKWR");

	var totSum = 0;
	for (var i=0; i<ds_list_bill.RowCount(); i++)  {
	    if( ds_list_bill.GetColumn(i, "BILL_GB") == chk_bill_gbn.Value ) {
	        totSum = toNumber(totSum) + toNumber(ds_list_bill.GetColumn(i, "FAKWR"));
	    }
	}
	
	med_fakwr_totsum.text = totSum;
	   
}


// 프로젝트내역 컬럼 데이타 변경 시
function ds_list_txt_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{ 
	// 값이 변경되었을 경우 변경구분 컬럼 자동 SET 
	if (varNewValue != varOldValue)  
	{  
		obj.Fireevent = false; 
		gfn_changeFlag( obj, strColumnID, nRow, "FLAG");   	// FLAG 변경 : U
		ds_dtl.SetColumn(0, "FLAG", "U");					// 변경구분 SET
		obj.Fireevent = true;  
	} 
}

// 품목 행 선택 변경 시
function ds_list_item_OnRowPosChanged(obj,nOldRow,nRow)
{
	fn_bill_filter(); // 빌링구분별 필터
}

// 빌링그리드에서 키 입력 시
function grd_bill_OnKeyDown(obj,nChar,bShift,bCtrl,bAlt,nLLParam,nHLParam)
{
	var ds = object(obj.BindDataset);  
	
	// 엔터키이면
	if (nChar==13)
	{  
		// 마지막 행에서의 엔터인 경우 행추가 호출
		if (ds.row == ds.RowCount()-1) btn_input_bill_OnClick(btn_append_bill);
		// 다음 행으로 이동
		ds.row = ds.row + 1;  
	} 
	// Esc 키이면 변경전 자료로 되돌린다.
	else if (nChar==27)
	{  
		var nCol 	= obj.GetCellPos();
		gfn_SetOrgColumn(obj, ds.row, nCol); 
		// switch (nCol)					// 변경된 셀 인덱스
		// {
			// case F_COLNUM_DISGBN_CHK:	// 표시여부 
			// case F_COLNUM_INGTEXT:		// 진행사항 
				// gfn_SetOrgColumn(obj, ds.row, nCol); 		 
				// break; 
		// }  
	} 
	else {
		gfn_GrdCellCopyPasteReset(obj, ds, bCtrl, nChar);
		
	} 
	
}

// 파트너 그리드에서 컬럼 데이타 변경 발생 시
function ds_list_partner_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{
    //trace(ds_list_partner.savexml());
	// 파트너코드 변경이 아니면 상세 데이타셋에 파트너코드 SET 하지 않는다.
	if (strColumnID <> "PARTNER_CD") return;
	
	// 파트너구분
	var partner_gb = ds_list_partner.GetColumn(nRow, "PARTNER_GB");
	
	switch (partner_gb)
	{
		case "KUNNR_WE": 	// 납품처
			ds_dtl.SetColumn(0, "KUNNR_WE", ds_list_partner.GetColumn(nRow, strColumnID));
			break;	
		case "KUNNR_Z3": 	// 기술영업담당자
			ds_dtl.SetColumn(0, "KUNNR_Z3", ds_list_partner.GetColumn(nRow, strColumnID));
			break; 
	    case "KUNNR_RG2": 	// 지급인
			ds_dtl.SetColumn(0, "KUNNR_RG2", ds_list_partner.GetColumn(nRow, strColumnID));
			break; 
	} 
	
}   

// TEST 그리드에서 키 입력 시
function tab_hdel_txt_grid_OnKeyDown(obj,nChar,bShift,bCtrl,bAlt,nLLParam,nHLParam)
{
	var ds = object(obj.BindDataset);  
	
	// 엔터키이면
	if (nChar==13)
	{  
		// 마지막 행에서의 엔터인 경우 행추가 호출
		if (ds.row == ds.RowCount()-1) tab_hdel_txt_btn_input_txt_OnClick(tab_hdel.txt.btn_append_txt);
		// 다음 행으로 이동
		ds.row = ds.row + 1;  
	} 
	// Esc 키이면 변경전 자료로 되돌린다.
	else if (nChar==27)
	{  
		var nCol 	= obj.GetCellPos();
		gfn_SetOrgColumn(obj, ds.row, nCol); 
		// switch (nCol)					// 변경된 셀 인덱스
		// {
			// case F_COLNUM_DISGBN_CHK:	// 표시여부 
			// case F_COLNUM_INGTEXT:		// 진행사항 
				// gfn_SetOrgColumn(obj, ds.row, nCol); 		 
				// break; 
		// }  
	} 
	else {
		gfn_GrdCellCopyPasteReset(obj, ds, bCtrl, nChar); 
	} 
}
 
// 탭 인덱스 변경 시
function tab_hdel_OnChanged(obj,nOldIndex,nNewindex)
{  
	
}


// 수주승인번호가 존재할 경우 더 이상 수정불가능하도록 변경
// pFlag : enadble (true:수정가능, false:수정불가능)
function fn_recad_da_exist(pFlag)
{
	//cal_vdatu.Enable = pFlag;  // HEAD-납기일  비활성화적용 2013.02.05              
	tab_hdel.head.cal_contr_da.Enable = pFlag;  // HEAD-계약일            
	tab_hdel.head.chk_shchk.Enable = pFlag;  // HEAD-계약일            
	//tab_hdel.head.ed_repmo.Enable = pFlag;  // HEAD-무상보수 개월수     
	//tab_hdel.head.ed_wormo.Enable = pFlag;  // HEAD-공사용사용 개월수    

	//tab_hdel.item.ed_repmo.Enable = pFlag;	// 품목-무상보수 개월수
	//tab_hdel.item.ed_wormo.Enable = pFlag;	// 품목-공사용사용 개월수
	//tab_hdel.item.cal_edatu.Enable = pFlag;	// 품목-납기일 

	grd_bill.SetCellProp("body", 3, "edit", iif(pFlag==false,"none","normal"));	// 빌링-청구계획일
	grd_bill.SetCellProp("body", 4, "edit", iif(pFlag==false,"none","combo"	));	// 빌링-종별구분
	grd_bill.SetCellProp("body", 7, "edit", iif(pFlag==false,"none","number"));	// 빌링-청구금액
	grd_bill.SetCellProp("body", 8, "edit", iif(pFlag==false,"none","combo"	));	// 빌링-지급조건

	btn_input_bill.Enable  = pFlag;	// 빌링-행삽입버튼
	btn_append_bill.Enable = pFlag;	// 빌링-행추가버튼
	btn_delete_bill.Enable = pFlag;	// 빌링-행삭제버튼
	chk_bill_gbn.Enable    = pFlag;	// 빌링-청구구분
	
	// 오더유형이 승강기 영업인 경우에만 VIP Project 활성화
	if (ds_dtl.GetColumn(0,"AUART") == 'ZS01') {
		cb_viptp.Enable = true;		
	}
	else {
		cb_viptp.Enable = false;
	}

	// 2013.01.24 수주승인의 경우에도 판매문서가 ZE, ZC, ZT의 경우는 수정 가능
	if (length(trim(F_RECAD_DA)) > 0)	{	// 수주승인의 경우
		if( substr(ed_auart.Text, 0, 2) == "ZE" ||
			substr(ed_auart.Text, 0, 2) == "ZT" ||
			substr(ed_auart.Text, 0, 2) == "ZC" )	{
			grd_bill.SetCellProp("body", 3, "edit", "normal");	// 빌링-청구계획일
			grd_bill.SetCellProp("body", 4, "edit", "combo");	// 빌링-종별구분
			grd_bill.SetCellProp("body", 7, "edit", "number");	// 빌링-청구금액
			grd_bill.SetCellProp("body", 8, "edit", "combo");	// 빌링-지급조건

			btn_input_bill.Enable  = true;	// 빌링-행삽입버튼
			btn_append_bill.Enable = true;	// 빌링-행추가버튼
			btn_delete_bill.Enable = true;	// 빌링-행삭제버튼
			chk_bill_gbn.Enable    = true;
		}
	}

	// 해외영업부가 아닌 경우 청구구분 수정불가
	if ((ds_dtl.GetColumn(0, "VKBUR") <> "B500" &&
		ds_dtl.GetColumn(0, "VKBUR") <> "B600" &&
		ds_dtl.GetColumn(0, "VKBUR") <> "B700" &&
		ds_dtl.GetColumn(0, "VKBUR") <> "B900" &&
		ds_dtl.GetColumn(0, "VKBUR") <> "BA00" &&
		ds_dtl.GetColumn(0, "VKBUR") <> "BB00" &&
		ds_dtl.GetColumn(0, "VKBUR") <> "EH00") || 
		//해영이면서 품목청구 이면 수정불가
		((ds_dtl.GetColumn(0, "VKBUR") == "B500" &&
		ds_dtl.GetColumn(0, "VKBUR") == "B600" &&
		ds_dtl.GetColumn(0, "VKBUR") == "B700" &&
		ds_dtl.GetColumn(0, "VKBUR") == "B900" &&
		ds_dtl.GetColumn(0, "VKBUR") == "BA00" &&
		ds_dtl.GetColumn(0, "VKBUR") == "BB00" &&
		ds_dtl.GetColumn(0, "VKBUR") == "EH00") || 
		ds_dtl.GetColumn(0,"BILL_GBN") == "P" ))
	{   
		chk_bill_gbn.Enable = false; 
	} 

}

// 품목 그리드 데이타 변경 시
function ds_dtl_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{
	ds_dtl.SetColumn(0, "FLAG", "U");	// 변경구분 SET
	//trace(ds_dtl.savexml());
}

// 품목 그리드 키 입력 시
function tab_hdel_item_grid_item_OnKeyDown(obj,nChar,bShift,bCtrl,bAlt,nLLParam,nHLParam)
{
	var ds = object(obj.BindDataset);   
	
	// 엔터키이면
	if (nChar==13)
	{   
		// 다음 행으로 이동
		ds.row = ds.row + 1;  
	} 
	// Esc 키이면 변경전 자료로 되돌린다.
	else if (nChar==27)
	{  
		var nCol 	= obj.GetCellPos();
		gfn_SetOrgColumn(obj, ds.row, nCol); 
		// switch (nCol)					// 변경된 셀 인덱스
		// {
			// case F_COLNUM_DISGBN_CHK:	// 표시여부 
			// case F_COLNUM_INGTEXT:		// 진행사항 
				// gfn_SetOrgColumn(obj, ds.row, nCol); 		 
				// break; 
		// }  
	} 
	else {
	//alert("tab_hdel_item_grid_item_OnKeyDown.gfn_GrdCellCopyPasteReset");
	
		gfn_GrdCellCopyPasteReset(, ds, bCtrl, nChar); 
	}
}

// 헤더정보 일괄복사 버튼 클릭 시
function tab_hdel_item_btn_head_copy_OnClick(obj)
{ 	
	var str = "헤더에 입력되어 있는 "
	            + "                                      "
				+ "무상보수개월수, 공사용사용개월수, 납기일, 하자보증개월수, 건물용도로 \n" 
				;
	// CI00024", "${} 작업을 진행 하시겠습니까?"
	if (!gfn_showConfirm("CI00024",str+"모든 품목에 복사")) 
	{
		return false;
	}
	
	var repmo = ds_dtl.GetColumn(0, "REPMO"); 	// HEAD-무상보수개월수
	var wormo = ds_dtl.GetColumn(0, "WORMO");  	// HEAD-공사용사용개월수
	var vdatu = ds_dtl.GetColumn(0, "VDATU");  	// HEAD-납기일     
	var guamo = ds_dtl.GetColumn(0, "GUAMO");	// HEAD-하자보증개월수
	var wwbld = ds_dtl.GetColumn(0, "WWBLD"); 	// HEAD-건물용도 
	
	ds_list_item.FireEvent = false;  
	for (var i=0; i<ds_list_item.RowCount(); i++)
	{
		if (length(F_RECAD_DA)==0) 	// 수주승인시에는 수정불가
		{
			ds_list_item.SetColumn(i, "REPMO", repmo);	// 품목-무상보수개월수
			ds_list_item.SetColumn(i, "WORMO", wormo);	// 품목-공사용사용개월수
			ds_list_item.SetColumn(i, "EDATU", vdatu);	// 품목-납기일
		}
		ds_list_item.SetColumn(i, "GUAMO", guamo);		// 품목-하자보증개월수
		ds_list_item.SetColumn(i, "WWBLD", wwbld);		// 품목-건물용도
	}    
	ds_list_item.FireEvent = true;
}

// 청구구분 선택 변경 시
function chk_bill_gbn_OnClick(obj,strValue)
{
	//trace("chk_bill_gbn_OnClick");
	fn_bill_gbn_onclick("Y"); 
}

// 청구구분 선택 변경 시
function fn_bill_gbn_onclick(pValidChkYN)
{
	//trace("fn_bill_gbn_onclick.pValidChkYN : " + pValidChkYN);
	
	if (ds_dtl.RowCount() == 0) return;
	
	// 행추가 조건 항목 오류검증
	if (pValidChkYN=="Y")
	{
		if (fn_valid_chk("bill_gbn") == false)  return;  
	} 
	
	// 청구구분별 합계 재산출 
	fn_tot_bill_sum();
	
	// 필터구분 재설정 및 필터
	cb_bill_gbn.Value = chk_bill_gbn.Value;  
	fn_bill_filter();
}

// 빌링조회필터조건 변경 시
function cb_bill_gbn_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	fn_bill_filter(); 
}


function ufn_openPjt(obj)
{
	var arg = "fa_zzpjt_cd   = "+quote(ed_vbeln_qry.Text);		//프로젝트번호
//프로젝트명			+ " fa_zzpjt_nm  = "+quote(ed_qtso_nm.Text); 	
	var arr = gfn_openPopUpUrlHdel("Com::Com0180.xml", true, arg);			
	if (arr != null && arr != 0) {
		ed_vbeln_qry.Text = arr[0];
	}				
}

function ed_vbeln_qry_OnChanged(obj,strText)
{
	fn_query_so();  				// 프로젝트조회 서비스 호출
}
/********************************************************************************
* 기      능   :  프로젝트 조회 
********************************************************************************/
function fn_query_so() { 
	
	gfn_clearMsgBar();   
	
	// 출력데이타셋 초기화
	ds_list_so.ClearData();
	ds_cond_so.ClearData();
	ds_cond_so.AddRow();
	
	ds_cond_so.SetColumn(0, "ZZPJT_ID", trim(ed_qtso_no.text));
	ds_cond_so.SetColumn(0, "BSTNK", trim(ed_qtso_nm.text));
	
	// 서비스호출
	nsfRequest("query"									// srvId
				, "com0180/find"						// url
				, "ds_cond_zzpjt=ds_cond_so ds_list_zzpjt=ds_list_so"	// inDsList
				, "ds_list_so=ds_list_zzpjt ds_error=ds_error_qtso"		// outDsList
				, ""									// strParam
				, "fn_afterQuery_so");					// CallBackFunc
}

//=========================================================================================
//  함수기능  : 수주생성 문서유형, 건물용도, 지급조건, 인도조건, 종별구분 코드목록 조회
//  SV ID : CommonCodeQuery
//  Call Back : CommonCodeCallBack
//  기능ID    : UF015
//  개선내역  : 2016.02.12 공용코드 개별 액션 호출 통합하여 처리
//=========================================================================================
function fn_CommonCode() {
    nsfRequest("CommonCodeQuery", "sso0060N/CommonCode"
              ,"ds_auart_cd=ds_auart_cd ds_cond_build=ds_cond_build ds_list_build=ds_list_build ds_list_build_l=ds_list_build_l ds_list_zterm=ds_list_zterm ds_list_inco1=ds_list_inco1 ds_list_mlbez=ds_list_mlbez ds_list_abrand=ds_list_abrand"
              ,"ds_auart_cd=ds_auart_cd ds_list_build=ds_list_build ds_list_build_l=ds_list_build_l ds_list_zterm=ds_list_zterm ds_list_inco1=ds_list_inco1 ds_list_mlbez=ds_list_mlbez ds_list_abrand=ds_list_abrand ds_error=ds_error"
              , ""
              , "CommonCodeCallBack"
              );
}

//=========================================================================================
//  함수기능  : 수주생성 문서유형, 건물용도, 지급조건, 인도조건, 종별구분 코드목록 조회 call Back
//  기능ID    : UF015
//=========================================================================================
function CommonCodeCallBack(svcId, errCode, errMsg) {
    // 건물용도 콤보박스 초기값 선언
	gfn_InsertRowCombo(ds_list_build, 0, "N", "Y", "BUILDUSE", "STEXT"); // 선택 행 추가
	gfn_InsertRowCombo(ds_list_build_l, 0, "N", "Y", "BUILDUSE_L", "STEXT"); //2020.12 jss
	tab_hdel.head.cb_wwbld.index = 0;
	tab_hdel.head.cb_wwbld_l.index = 0;
	tab_hdel.item.cb_wwbld.index = 0; 
    
    // 지급조건 콤보 초기값 선언
	// HEAD의 지급조건 Filtering 
	gfn_copyDs(ds_list_zterm, ds_list_zterm_head, "CODE=='0001' || CODE=='0002'"||
	                                              "CODE=='LC01' || CODE=='LL01'"|| //2013.01.17  해외 지급조건 추가
	                                              "CODE=='LU01' || CODE=='LU02'"||
	                                              "CODE=='LU03' || CODE=='LU04'"||
	                                              "CODE=='PA01' || CODE=='TB01'"||
	                                              "CODE=='TF01' || CODE=='W001'");

	gfn_InsertRowCombo(ds_list_zterm	 , 0, "N", "Y", "CODE", "CODE_NAME"); // 선택 행 추가 
	gfn_InsertRowCombo(ds_list_zterm_head, 0, "N", "Y", "CODE", "CODE_NAME"); // 선택 행 추가 
	cb_zterm.index = 0;

    // 인도조건 콤보박스 초기값 선언
	gfn_InsertRowCombo(ds_list_inco1, 0, "N", "Y", "CODE", "CODE_NAME"); // 선택 행 추가
	cb_inco1.index = 0;

    // 종별구분 콤보박스 초기값 선언
	gfn_InsertRowCombo(ds_list_mlbez, 0, "N", "Y", "CODE", "CODE_NAME"); // 선택 행 추가 
	ds_list_mlbez.row = 0;

    // 에러 메시지 처리 추가
    if(ds_error.RowCount() > 0) 
    {
        gfn_showAlert(ds_error.GetColumn(0, "ERRMSG"));
    }
}

// 기능개선
// 변경정보 체크 스크립트
function IsDatasetUpdate()
{
	var bUpdated = false;
	var arrDs = [ ds_dtl
	            , ds_list_item
	            , ds_list_bill
	            , ds_list_txt
	];

	for ( var i = 0 ; i < arrDs.length ; i++ )
	{
		var objDs = arrDs[i];
		for ( var j = 0 ; j < objDs.getRowCount() ; j++ )
		{
			if ( objDs.getColumn(j, "FLAG") == "I" || objDs.getColumn(j, "FLAG") == "U" || objDs.getColumn(j, "FLAG") == "D" )
			{
				bUpdated = true;
				break;
			}
		}
	}

	return bUpdated;
}


function grd_bill_OnCellPosChanged(obj,nRow,nCell,nOldRow,nOldCell,nPivotIndex,nOldPivotIndex)
{
	var fksaf = object(obj.BindDataset).GetColumn(nRow, "FKSAF");		//2017.03.27 Billst = 'C' , 수정 불가 by mj.Shin
	obj.Editable = iif(fksaf != 'A', false, true);
}

function tab_hdel_head_cal_dpcpd_OnChanged(obj,strOldText,strNewText)
{
	var ds = object(tab_hdel.head.cal_dpcpd.BindDataset);

	if(ds.GetColumn(0, 'ordno') != ed_vbeln_qry.Text)
		return;

	ds.SetColumn(0, 'changed', true);
}
function tab_hdel_head_cb_achtp_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	if(strCode == "X") {
		tab_hdel.head.cal_achdt.Enable    = true;	// 건축허가일
		tab_hdel.head.ed_achno.Enable     = true;	// 건축허가번호			
	} else {
		tab_hdel.head.cal_achdt.Enable    = false;	// 건축허가일
		tab_hdel.head.ed_achno.Enable     = false;	// 건축허가번호			
		
		tab_hdel.head.cal_achdt.Text      = '';		// 건축허가일
		tab_hdel.head.ed_achno.Text       = '';		// 건축허가번호						
	}	
}

function chk_auptp_OnClick(obj,strValue)
{
	if(strValue == "X") {
		cb_year.Enable = true;	
	} else {
		cb_year.Enable = false;	
		cb_year.Value = "";
	}
}

function hel_reg_onChanged(obj,strPreText,strPostText)
{
	
	if (length(trim(ds_dtl.GetColumn(0, "REG_NO"))) == 0  &&  ds_dtl.GetColumn(0, "HEL_REG") == "1") {
		ds_dtl.SetColumn(0, 'REG_NO', "0000000");
	} 

  	if ( ds_dtl.GetColumn(0, "HEL_REG") != "1" ) {
		ds_dtl.SetColumn(0, 'REG_NO', "");
	}
}

function fn_lifnrchk_onChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	if (strCode == "1") {
		tab_hdel.head.div_lifnr1.ed_lifnr.Text = '0000002000';
	} else if (strCode != "1" && tab_hdel.head.div_lifnr1.ed_lifnr.Text == '0000002000') {
		tab_hdel.head.div_lifnr1.ed_lifnr.Text = '';
		tab_hdel.head.div_lifnr1.ed_name1.Text = '';
	}
	
	if (strCode == "1") 
	{	
		if (toNumber(med_netwr.Value) >= 100000000) {
			ds_dtl.SetColumn(0,"HEL_REG","1");
		} else {
			ds_dtl.SetColumn(0,"HEL_REG","2");
		}
	} else {
		if (toNumber(med_netwr.Value) >= 40000000) {
			ds_dtl.SetColumn(0,"HEL_REG","1");
			
		} else {
			ds_dtl.SetColumn(0,"HEL_REG","2");
		}
	}
	
	var strCode = ds_dtl.getColumn(0, "HEL_REG");
    hel_reg_onChanged(strCode, strCode, "","","");
	
}


function cb_wwbld_l_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	ds_list_build.UnFilter();
	if(length(trim(strCode)) > 0){
	  ds_list_build.Filter("BUILDUSE_L == "+quote(strCode));
	  tab_hdel.head.cb_wwbld.index = 0;
	}else{
	  ds_list_build.UnFilter();
	  tab_hdel.head.cb_wwbld.index = 0;
	}  
}

function cb_wwbld_OnClick(obj)
{
	if(length(trim(tab_hdel.head.cb_wwbld_l.Value)) > 0){
		ds_list_build.Filter("BUILDUSE_L == "+quote(tab_hdel.head.cb_wwbld_l.Value));
	}else ds_list_build.UnFilter();
}


function tab_hdel_item_btn_sta_copy_OnClick(obj)
{					
	if(ds_list_item.GetColumn(0,"STADA") == "" || ds_list_item.GetColumn(0,"STADA") == null || ds_list_item.GetColumn(0,"STADA") == "00000000") {
		gfn_showAlert("CW10025", "착공예정일을 입력 하시기 바랍니다.");
		gfn_SetFocusGrid(tab_hdel.item.grid_item, 0, gfn_getColIdx(tab_hdel.item.grid_item,'STADA')); 
		return;
	}

	if(ds_list_item.GetColumn(0,"ZRMDA") == "" || ds_list_item.GetColumn(0,"ZRMDA") == null || ds_list_item.GetColumn(0,"ZRMDA") == "00000000") {
		gfn_showAlert("CW10025", "골조완료예정일 입력 하시기 바랍니다.");
		gfn_SetFocusGrid(tab_hdel.item.grid_item, 0, gfn_getColIdx(tab_hdel.item.grid_item,'ZRMDA')); 
		return;
	}

	var str = "품목 첫행에 입력되어 있는 "
	            + "                                      "
				+ "착공예정일, 골조완료예정일을\n" 
				;
	// CI00024", "${} 작업을 진행 하시겠습니까?"
	if (!gfn_showConfirm("CI00024",str+"모든 품목에 복사")) 
	{
		return false;
	}
	
	var stada = ds_list_item.GetColumn(0,"STADA");
	var zrmda = ds_list_item.GetColumn(0,"ZRMDA");
	
	for (var i=1; i<ds_list_item.RowCount(); i++)
	{
		ds_list_item.SetColumn(i, "STADA", stada);
		ds_list_item.SetColumn(i, "ZRMDA", zrmda);
	}
}]]></Script>
</Window>