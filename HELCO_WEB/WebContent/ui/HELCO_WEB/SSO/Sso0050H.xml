<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="562" Id="Ses0031H" Left="8" OnLoadCompleted="fn_OnLoadCompleted" OnUnloadCompleted="fn_OnUnloadCompleted" PidAttrib="7" Title="리모델링&#32;수주사양&#32;층별사양전개" Top="8" Ver="1.0" Width="976" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_prh01" OnColumnChanged="ds_prh_OnColumnChanged">
				<Contents>
					<colinfo id="FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="ITYPE" size="256" summ="default" type="STRING"/>
					<colinfo id="OBJID" size="256" summ="default" type="STRING"/>
					<colinfo id="OBJINDEX" size="256" summ="default" type="STRING"/>
					<colinfo id="PRH" size="256" summ="default" type="STRING"/>
					<colinfo id="PRHNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="PRD" size="256" summ="default" type="STRING"/>
					<record>
						<FLAG></FLAG>
						<ITYPE>NUM</ITYPE>
						<OBJID></OBJID>
						<OBJINDEX></OBJINDEX>
						<PRD></PRD>
						<PRH>EL_CJM1Q</PRH>
						<PRHNAME></PRHNAME>
					</record>
					<record>
						<FLAG></FLAG>
						<ITYPE></ITYPE>
						<OBJID></OBJID>
						<OBJINDEX></OBJINDEX>
						<PRD></PRD>
						<PRH>EL_CJM1</PRH>
						<PRHNAME></PRHNAME>
					</record>
					<record>
						<FLAG></FLAG>
						<ITYPE></ITYPE>
						<OBJID></OBJID>
						<OBJINDEX></OBJINDEX>
						<PRD></PRD>
						<PRH>EL_CHPI1</PRH>
						<PRHNAME></PRHNAME>
					</record>
					<record>
						<FLAG></FLAG>
						<ITYPE>CHAR</ITYPE>
						<OBJID></OBJID>
						<OBJINDEX></OBJINDEX>
						<PRD></PRD>
						<PRH>EL_CJM1F</PRH>
						<PRHNAME></PRHNAME>
					</record>
					<record>
						<FLAG></FLAG>
						<ITYPE>NUM</ITYPE>
						<OBJID></OBJID>
						<OBJINDEX></OBJINDEX>
						<PRD></PRD>
						<PRH>EL_CJM2Q</PRH>
						<PRHNAME></PRHNAME>
					</record>
					<record>
						<FLAG></FLAG>
						<ITYPE></ITYPE>
						<OBJID></OBJID>
						<OBJINDEX></OBJINDEX>
						<PRD></PRD>
						<PRH>EL_CJM2</PRH>
						<PRHNAME></PRHNAME>
					</record>
					<record>
						<FLAG></FLAG>
						<ITYPE></ITYPE>
						<OBJID></OBJID>
						<OBJINDEX></OBJINDEX>
						<PRD></PRD>
						<PRH>EL_CHPI2</PRH>
						<PRHNAME></PRHNAME>
					</record>
					<record>
						<FLAG></FLAG>
						<ITYPE>CHAR</ITYPE>
						<OBJID></OBJID>
						<OBJINDEX></OBJINDEX>
						<PRD></PRD>
						<PRH>EL_CJM2F</PRH>
						<PRHNAME></PRHNAME>
					</record>
					<record>
						<FLAG></FLAG>
						<ITYPE>NUM</ITYPE>
						<OBJID></OBJID>
						<OBJINDEX></OBJINDEX>
						<PRD></PRD>
						<PRH>EL_CJM3Q</PRH>
						<PRHNAME></PRHNAME>
					</record>
					<record>
						<FLAG></FLAG>
						<ITYPE></ITYPE>
						<OBJID></OBJID>
						<OBJINDEX></OBJINDEX>
						<PRD></PRD>
						<PRH>EL_CJM3</PRH>
						<PRHNAME></PRHNAME>
					</record>
					<record>
						<FLAG></FLAG>
						<ITYPE></ITYPE>
						<OBJID></OBJID>
						<OBJINDEX></OBJINDEX>
						<PRD></PRD>
						<PRH>EL_CHPI3</PRH>
						<PRHNAME></PRHNAME>
					</record>
					<record>
						<FLAG></FLAG>
						<ITYPE>CHAR</ITYPE>
						<OBJID></OBJID>
						<OBJINDEX></OBJINDEX>
						<PRD></PRD>
						<PRH>EL_CJM3F</PRH>
						<PRHNAME></PRHNAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_prh02" OnColumnChanged="ds_prh_OnColumnChanged">
				<Contents>
					<colinfo id="FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="ITYPE" size="256" summ="default" type="STRING"/>
					<colinfo id="OBJID" size="256" summ="default" type="STRING"/>
					<colinfo id="OBJINDEX" size="256" summ="default" type="STRING"/>
					<colinfo id="PRH" size="256" summ="default" type="STRING"/>
					<colinfo id="PRHNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="PRD" size="256" summ="default" type="STRING"/>
					<record>
						<FLAG></FLAG>
						<ITYPE></ITYPE>
						<OBJID></OBJID>
						<OBJINDEX></OBJINDEX>
						<PRD></PRD>
						<PRH>EL_CHPBM1</PRH>
						<PRHNAME></PRHNAME>
					</record>
					<record>
						<FLAG></FLAG>
						<ITYPE>CHAR</ITYPE>
						<OBJID></OBJID>
						<OBJINDEX></OBJINDEX>
						<PRD></PRD>
						<PRH>EL_CHPBM1F</PRH>
						<PRHNAME></PRHNAME>
					</record>
					<record>
						<FLAG></FLAG>
						<ITYPE>NUM</ITYPE>
						<OBJID></OBJID>
						<OBJINDEX></OBJINDEX>
						<PRD></PRD>
						<PRH>EL_CHPBM1Q</PRH>
						<PRHNAME></PRHNAME>
					</record>
					<record>
						<FLAG></FLAG>
						<ITYPE></ITYPE>
						<OBJID></OBJID>
						<OBJINDEX></OBJINDEX>
						<PRD></PRD>
						<PRH>EL_CHPBM2</PRH>
						<PRHNAME></PRHNAME>
					</record>
					<record>
						<FLAG></FLAG>
						<ITYPE>CHAR</ITYPE>
						<OBJID></OBJID>
						<OBJINDEX></OBJINDEX>
						<PRD></PRD>
						<PRH>EL_CHPBM2F</PRH>
						<PRHNAME></PRHNAME>
					</record>
					<record>
						<FLAG></FLAG>
						<ITYPE>NUM</ITYPE>
						<OBJID></OBJID>
						<OBJINDEX></OBJINDEX>
						<PRD></PRD>
						<PRH>EL_CHPBM2Q</PRH>
						<PRHNAME></PRHNAME>
					</record>
					<record>
						<FLAG></FLAG>
						<ITYPE></ITYPE>
						<OBJID></OBJID>
						<OBJINDEX></OBJINDEX>
						<PRD></PRD>
						<PRH>EL_CHPBT</PRH>
						<PRHNAME></PRHNAME>
					</record>
					<record>
						<FLAG></FLAG>
						<ITYPE>CHAR</ITYPE>
						<OBJID></OBJID>
						<OBJINDEX></OBJINDEX>
						<PRD></PRD>
						<PRH>EL_CHPBTF</PRH>
						<PRHNAME></PRHNAME>
					</record>
					<record>
						<FLAG></FLAG>
						<ITYPE>NUM</ITYPE>
						<OBJID></OBJID>
						<OBJINDEX></OBJINDEX>
						<PRD></PRD>
						<PRH>EL_CHPBTQ</PRH>
						<PRHNAME></PRHNAME>
					</record>
					<record>
						<FLAG></FLAG>
						<ITYPE></ITYPE>
						<OBJID></OBJID>
						<OBJINDEX></OBJINDEX>
						<PRD></PRD>
						<PRH>EL_CHPBB</PRH>
						<PRHNAME></PRHNAME>
					</record>
					<record>
						<FLAG></FLAG>
						<ITYPE>CHAR</ITYPE>
						<OBJID></OBJID>
						<OBJINDEX></OBJINDEX>
						<PRD></PRD>
						<PRH>EL_CHPBBF</PRH>
						<PRHNAME></PRHNAME>
					</record>
					<record>
						<FLAG></FLAG>
						<ITYPE>NUM</ITYPE>
						<OBJID></OBJID>
						<OBJINDEX></OBJINDEX>
						<PRD></PRD>
						<PRH>EL_CHPBBQ</PRH>
						<PRHNAME></PRHNAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_prh03" OnColumnChanged="ds_prh_OnColumnChanged">
				<Contents>
					<colinfo id="FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="ITYPE" size="256" summ="default" type="STRING"/>
					<colinfo id="OBJID" size="256" summ="default" type="STRING"/>
					<colinfo id="OBJINDEX" size="256" summ="default" type="STRING"/>
					<colinfo id="PRH" size="256" summ="default" type="STRING"/>
					<colinfo id="PRHNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="PRD" size="256" summ="default" type="STRING"/>
					<record>
						<FLAG></FLAG>
						<ITYPE></ITYPE>
						<OBJID></OBJID>
						<OBJINDEX></OBJINDEX>
						<PRD></PRD>
						<PRH>EL_CHIPM1</PRH>
						<PRHNAME></PRHNAME>
					</record>
					<record>
						<FLAG></FLAG>
						<ITYPE>CHAR</ITYPE>
						<OBJID></OBJID>
						<OBJINDEX></OBJINDEX>
						<PRD></PRD>
						<PRH>EL_CHIPM1F</PRH>
						<PRHNAME></PRHNAME>
					</record>
					<record>
						<FLAG></FLAG>
						<ITYPE>NUM</ITYPE>
						<OBJID></OBJID>
						<OBJINDEX></OBJINDEX>
						<PRD></PRD>
						<PRH>EL_CHIPM1Q</PRH>
						<PRHNAME></PRHNAME>
					</record>
					<record>
						<FLAG></FLAG>
						<ITYPE></ITYPE>
						<OBJID></OBJID>
						<OBJINDEX></OBJINDEX>
						<PRD></PRD>
						<PRH>EL_CHIPM2</PRH>
						<PRHNAME></PRHNAME>
					</record>
					<record>
						<FLAG></FLAG>
						<ITYPE>CHAR</ITYPE>
						<OBJID></OBJID>
						<OBJINDEX></OBJINDEX>
						<PRD></PRD>
						<PRH>EL_CHIPM2F</PRH>
						<PRHNAME></PRHNAME>
					</record>
					<record>
						<FLAG></FLAG>
						<ITYPE>NUM</ITYPE>
						<OBJID></OBJID>
						<OBJINDEX></OBJINDEX>
						<PRD></PRD>
						<PRH>EL_CHIPM2Q</PRH>
						<PRHNAME></PRHNAME>
					</record>
					<record>
						<FLAG></FLAG>
						<ITYPE></ITYPE>
						<OBJID></OBJID>
						<OBJINDEX></OBJINDEX>
						<PRD></PRD>
						<PRH>EL_CHIPT</PRH>
						<PRHNAME></PRHNAME>
					</record>
					<record>
						<FLAG></FLAG>
						<ITYPE>CHAR</ITYPE>
						<OBJID></OBJID>
						<OBJINDEX></OBJINDEX>
						<PRD></PRD>
						<PRH>EL_CHIPTF</PRH>
						<PRHNAME></PRHNAME>
					</record>
					<record>
						<FLAG></FLAG>
						<ITYPE>NUM</ITYPE>
						<OBJID></OBJID>
						<OBJINDEX></OBJINDEX>
						<PRD></PRD>
						<PRH>EL_CHIPTQ</PRH>
						<PRHNAME></PRHNAME>
					</record>
					<record>
						<FLAG></FLAG>
						<ITYPE></ITYPE>
						<OBJID></OBJID>
						<OBJINDEX></OBJINDEX>
						<PRD></PRD>
						<PRH>EL_CHIPB</PRH>
						<PRHNAME></PRHNAME>
					</record>
					<record>
						<FLAG></FLAG>
						<ITYPE>CHAR</ITYPE>
						<OBJID></OBJID>
						<OBJINDEX></OBJINDEX>
						<PRD></PRD>
						<PRH>EL_CHIPBF</PRH>
						<PRHNAME></PRHNAME>
					</record>
					<record>
						<FLAG></FLAG>
						<ITYPE>NUM</ITYPE>
						<OBJID></OBJID>
						<OBJINDEX></OBJINDEX>
						<PRD></PRD>
						<PRH>EL_CHIPBQ</PRH>
						<PRHNAME></PRHNAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_prh04" OnColumnChanged="ds_prh_OnColumnChanged">
				<Contents>
					<colinfo id="FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="ITYPE" size="256" summ="default" type="STRING"/>
					<colinfo id="PRHNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="OBJID" size="256" summ="default" type="STRING"/>
					<colinfo id="OBJINDEX" size="256" summ="default" type="STRING"/>
					<colinfo id="PRH" size="256" summ="default" type="STRING"/>
					<colinfo id="PRD" size="256" summ="default" type="STRING"/>
					<record>
						<FLAG></FLAG>
						<ITYPE></ITYPE>
						<OBJID></OBJID>
						<OBJINDEX></OBJINDEX>
						<PRD></PRD>
						<PRH>EL_CHL</PRH>
						<PRHNAME></PRHNAME>
					</record>
					<record>
						<FLAG></FLAG>
						<ITYPE>CHAR</ITYPE>
						<OBJID></OBJID>
						<OBJINDEX></OBJINDEX>
						<PRD></PRD>
						<PRH>EL_CHLF</PRH>
						<PRHNAME></PRHNAME>
					</record>
					<record>
						<FLAG></FLAG>
						<ITYPE>NUM</ITYPE>
						<OBJID></OBJID>
						<OBJINDEX></OBJINDEX>
						<PRD></PRD>
						<PRH>EL_CHLQ</PRH>
						<PRHNAME></PRHNAME>
					</record>
					<record>
						<FLAG></FLAG>
						<ITYPE></ITYPE>
						<OBJID></OBJID>
						<OBJINDEX></OBJINDEX>
						<PRD></PRD>
						<PRH>EL_CHL2</PRH>
						<PRHNAME></PRHNAME>
					</record>
					<record>
						<FLAG></FLAG>
						<ITYPE>CHAR</ITYPE>
						<OBJID></OBJID>
						<OBJINDEX></OBJINDEX>
						<PRD></PRD>
						<PRH>EL_CHL2F</PRH>
						<PRHNAME></PRHNAME>
					</record>
					<record>
						<FLAG></FLAG>
						<ITYPE>NUM</ITYPE>
						<OBJID></OBJID>
						<OBJINDEX></OBJINDEX>
						<PRD></PRD>
						<PRH>EL_CHL2Q</PRH>
						<PRHNAME></PRHNAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_prh05" OnColumnChanged="ds_prh_OnColumnChanged">
				<Contents>
					<colinfo id="FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="ITYPE" size="256" summ="default" type="STRING"/>
					<colinfo id="OBJID" size="256" summ="default" type="STRING"/>
					<colinfo id="OBJINDEX" size="256" summ="default" type="STRING"/>
					<colinfo id="PRH" size="256" summ="default" type="STRING"/>
					<colinfo id="PRHNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="PRD" size="256" summ="default" type="STRING"/>
					<record>
						<FLAG></FLAG>
						<ITYPE></ITYPE>
						<OBJID></OBJID>
						<OBJINDEX></OBJINDEX>
						<PRD></PRD>
						<PRH>EL_CFRSW</PRH>
						<PRHNAME></PRHNAME>
					</record>
					<record>
						<FLAG></FLAG>
						<ITYPE>CHAR</ITYPE>
						<OBJID></OBJID>
						<OBJINDEX></OBJINDEX>
						<PRD></PRD>
						<PRH>EL_EMF</PRH>
						<PRHNAME></PRHNAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_template_floor">
				<Contents>
					<colinfo id="FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="MANDT" size="256" summ="default" type="STRING"/>
					<colinfo id="PRH" size="256" summ="default" type="STRING"/>
					<colinfo id="PRHNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="PRD" size="256" summ="default" type="STRING"/>
					<colinfo id="ATKLA" size="256" summ="default" type="STRING"/>
					<colinfo id="OBJID" size="256" summ="default" type="STRING"/>
					<colinfo id="OBJINDEX" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_floorSuvPrh">
				<Contents>
					<colinfo id="SUVSN" size="256" summ="default" type="STRING"/>
					<colinfo id="FLOOR" size="256" summ="default" type="STRING"/>
					<colinfo id="FLOORNUM" size="256" summ="default" type="INT"/>
					<colinfo id="FLOORNM" size="256" summ="default" type="STRING"/>
					<colinfo id="JAMBGRP" size="256" summ="default" type="STRING"/>
					<colinfo id="JAMBMODEL" size="256" summ="default" type="STRING"/>
					<colinfo id="HPIMODEL" size="256" summ="default" type="STRING"/>
					<colinfo id="HPBMODEL" size="256" summ="default" type="STRING"/>
					<colinfo id="HIPMODEL" size="256" summ="default" type="STRING"/>
					<colinfo id="HLTNMODEL" size="256" summ="default" type="STRING"/>
					<colinfo id="FSWMODEL" size="256" summ="default" type="STRING"/>
					<colinfo id="HPIPRD" size="256" summ="default" type="STRING"/>
					<colinfo id="HPBPRD" size="256" summ="default" type="STRING"/>
					<colinfo id="HIPPRD" size="256" summ="default" type="STRING"/>
					<colinfo id="HLTNPRD" size="256" summ="default" type="STRING"/>
					<colinfo id="PRKSWPRD" size="256" summ="default" type="STRING"/>
					<colinfo id="FSWPRD" size="256" summ="default" type="STRING"/>
					<colinfo id="HPIAPPLYFLOOR" size="256" summ="default" type="STRING"/>
					<colinfo id="HPBAPPLYFLOOR" size="256" summ="default" type="STRING"/>
					<colinfo id="HIPAPPLYFLOOR" size="256" summ="default" type="STRING"/>
					<colinfo id="HLTNAPPLYFLOOR" size="256" summ="default" type="STRING"/>
					<colinfo id="PRKSWAPPLYFLOOR" size="256" summ="default" type="STRING"/>
					<colinfo id="FSWAPPLYFLOOR" size="256" summ="default" type="STRING"/>
					<colinfo id="JAMBINFO" size="256" summ="default" type="STRING"/>
					<colinfo id="JAMBTP" size="256" summ="default" type="STRING"/>
					<colinfo id="SUVPRH" size="256" summ="default" type="STRING"/>
					<colinfo id="SUVPRD" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_error">
				<Contents>
					<colinfo id="IDX" size="256" type="STRING"/>
					<colinfo id="ERRMSG" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_suv_prh_cp">
				<Contents>
					<colinfo id="FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="MANDT" size="256" summ="default" type="STRING"/>
					<colinfo id="SUVSN" size="256" summ="default" type="STRING"/>
					<colinfo id="SUVPRH" size="256" summ="default" type="STRING"/>
					<colinfo id="PRH" size="256" summ="default" type="STRING"/>
					<colinfo id="CHGPRD" size="256" summ="default" type="STRING"/>
					<colinfo id="ATKLA" size="256" summ="default" type="STRING"/>
					<colinfo id="ITEMDIVNM" size="256" summ="default" type="STRING"/>
					<colinfo id="SUVPRHNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="SUVPRD" size="256" summ="default" type="STRING"/>
					<colinfo id="PRD" size="256" summ="default" type="STRING"/>
					<colinfo id="CALPRD" size="256" summ="default" type="STRING"/>
					<colinfo id="MODYPRD" size="256" summ="default" type="STRING"/>
					<colinfo id="MODYYSNO" size="256" summ="default" type="STRING"/>
					<colinfo id="INTYPE" size="256" summ="default" type="STRING"/>
					<colinfo id="PRHNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="OBJID" size="256" summ="default" type="STRING"/>
					<colinfo id="OBJINDEX" size="256" summ="default" type="STRING"/>
					<colinfo id="PRHYSNO" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_floor">
				<Contents>
					<colinfo id="SUVPRH" size="256" summ="default" type="STRING"/>
					<colinfo id="CALPRD" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_jamb_msg">
				<Contents>
					<colinfo id="KEY" size="256" summ="default" type="STRING"/>
					<colinfo id="MSG" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
		</Datasets>
		<Div Height="43" Id="div_btn" Left="3" TabOrder="1" Text="Div0" Url="WB01::CommBtnForm.xml" Width="973">
			<Contents></Contents>
		</Div>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_rap_apply" ImageID="btn_sub_09" Left="847" LeftMargin="12" OnClick="btn_rap_cal_OnClick" Style="sty_btn" TabOrder="2" Text="층별&#32;수주사양&#32;적용" Top="50" Transparent="TRUE" Width="120"></Button>
		<Div Height="480" Id="div_pop" scroll="true" TabOrder="32" Text="Div0" Top="72" Width="1320">
			<Contents>
				<Shape BKColor="user12" Bottom="240" Height="232" Id="Shape3" Left="8" LineColor="user13" Right="1304" TabOrder="12" Top="8" Type="Rectangle" Width="1296"></Shape>
				<Grid AutoFitEndLine="Hide" BindDataset="ds_prh01" BkColor2="default" BoldHead="true" Border="Flat" Bottom="233" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="201" Id="grd_rad_prh01" InputPanel="FALSE" Left="8" LineColor="user20" LineType="ExHORZ" Right="328" RowHeight="20" Style="sty_grid" TabOrder="1" TabStop="true" Top="32" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="320">
					<contents>
						<format id="Default">
							<columns>
								<col width="34"/>
								<col width="154"/>
								<col width="86"/>
							</columns>
							<head>
								<cell align="center" col="0" color="user21" display="text" font="굴림,9" text="상태"/>
								<cell col="1" color="user21" display="text" font="굴림,9" text="OUTSIDE"/>
								<cell align="center" col="2" color="user21" display="text" font="굴림,9" text="값"/>
							</head>
							<body>
								<cell bkimageid='expr:gfn_getFlagBkImageID(getColumn(currow,&#32;&quot;FLAG&quot;))' col="0" display="text"/>
								<cell align="left" bkcolor2="user22" col="1" colid="PRHNAME" display="text"/>
								<cell align="center" bkcolor="expr:iif(ITYPE&#32;!=&#32;&apos;&apos;,&#32;&apos;#E4EDF4&apos;,&#32;&apos;default&apos;)" bkcolor2="expr:iif(ITYPE&#32;!=&#32;&apos;&apos;,&#32;&apos;#E4EDF4&apos;,&#32;&apos;default&apos;)" col="2" colid="PRD" display="text" edit="expr:iif(ITYPE&#32;!=&#32;&apos;&apos;,&#32;decode(ITYPE,&apos;NUM&apos;,&apos;number&apos;,&apos;normal&apos;),&#32;&apos;none&apos;)"/>
							</body>
						</format>
					</contents>
				</Grid>
				<Image Height="19" Id="Image6" ImageID="form_bl_title_sub" Left="7" TabOrder="2" Top="241" Width="11"></Image>
				<Static Color="user6" Font="굴림,9,Bold" Height="20" Id="Static19" Left="21" TabOrder="3" Text="층별&#32;수주사양&#32;및&#32;실측사양&#32;전개" Top="243" VAlign="Middle" Width="254"></Static>
				<Grid AutoFitEndLine="Hide" BindDataset="ds_floorSuvPrh" BkColor2="default" BoldHead="true" Border="Flat" Bottom="474" ColSizing="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="202" Id="grid_floor_map" InputPanel="FALSE" Left="8" LineColor="user20" LineType="ExHORZ" Right="1300" RowHeight="20" Style="sty_grid" TabOrder="4" TabStop="true" Top="272" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="1292">
					<contents>
						<format id="Default">
							<columns>
								<col width="50"/>
								<col width="77"/>
								<col width="39"/>
								<col width="75"/>
								<col width="73"/>
								<col width="41"/>
								<col width="70"/>
								<col width="75"/>
								<col width="38"/>
								<col width="71"/>
								<col width="77"/>
								<col width="51"/>
								<col width="73"/>
								<col width="77"/>
								<col width="61"/>
								<col width="87"/>
								<col width="97"/>
								<col width="57"/>
								<col width="91"/>
							</columns>
							<head>
								<cell col="0" display="text" rowspan="2">
									<cell col="0" display="text"/>
									<cell align="center" col="0" color="user21" display="text" font="굴림,9" row="1" text="층"/>
								</cell>
								<cell col="-1" display="text">
									<cell col="0" display="text"/>
									<cell col="1" display="text"/>
									<cell col="2" color="user21" display="text" font="굴림,9" text="영업사양"/>
									<cell col="3" color="user21" display="text" font="굴림,9" text="사양"/>
									<cell col="4" display="text"/>
								</cell>
								<cell col="1" colspan="3" display="text">
									<cell col="0" display="text" font="굴림,9"/>
									<cell col="1" display="text" font="굴림,9" text="JAMB"/>
									<cell col="2" display="text" font="굴림,9"/>
								</cell>
								<cell col="1" display="text" font="굴림,9" row="1" text="수주&#32;JAMB"/>
								<cell col="2" display="text" font="굴림,9" row="1" text="층명"/>
								<cell col="4" colspan="3" display="text">
									<cell col="0" display="text"/>
									<cell col="1" color="user21" display="text" font="굴림,9" text="HPI"/>
									<cell col="2" color="user21" display="text" font="굴림,9"/>
								</cell>
								<cell col="7" colspan="3" display="text">
									<cell col="0" display="text"/>
									<cell col="1" color="user21" display="text" font="굴림,9" text="HPB"/>
									<cell col="2" color="user21" display="text" font="굴림,9"/>
								</cell>
								<cell col="9" display="text"/>
								<cell col="10" colspan="3" display="text">
									<cell col="0" display="text"/>
									<cell col="1" color="user21" display="text" font="굴림,9" text="HIP"/>
									<cell col="2" display="text"/>
								</cell>
								<cell col="12" display="text"/>
								<cell col="13" colspan="3" display="text">
									<cell col="0" display="text"/>
									<cell col="1" color="user21" display="text" font="굴림,9" text="홀랜턴"/>
									<cell col="2" display="text"/>
								</cell>
								<cell col="15" display="text"/>
								<cell col="16" colspan="3" display="text">
									<cell col="0" display="text"/>
									<cell col="1" color="user21" display="text" font="굴림,9" text="소방스위치"/>
									<cell col="2" display="text"/>
								</cell>
								<cell col="3" color="user21" display="text" font="굴림,9" row="1" text="실측&#32;JAMB"/>
								<cell col="4" color="user21" display="text" font="굴림,9" row="1" text="수주&#32;HPI"/>
								<cell col="5" color="user21" display="text" font="굴림,9" row="1" text="층명"/>
								<cell col="6" color="user21" display="text" font="굴림,9" row="1" text="실측&#32;HPI"/>
								<cell col="7" color="user21" display="text" font="굴림,9" row="1" text="수주&#32;HPB"/>
								<cell col="8" color="user21" display="text" font="굴림,9" row="1" text="층명"/>
								<cell col="9" color="user21" display="text" font="굴림,9" row="1" text="실측&#32;HPB"/>
								<cell col="10" color="user21" display="text" font="굴림,9" row="1" text="수주&#32;HIP"/>
								<cell col="11" color="user21" display="text" font="굴림,9" row="1" text="층명"/>
								<cell col="12" color="user21" display="text" font="굴림,9" row="1" text="실측&#32;HIP"/>
								<cell col="13" color="user21" display="text" font="굴림,9" row="1" text="수주&#32;홀랜턴"/>
								<cell col="14" color="user21" display="text" font="굴림,9" row="1" text="층명"/>
								<cell col="15" color="user21" display="text" font="굴림,9" row="1" text="실측&#32;홀랜턴"/>
								<cell col="16" color="user21" display="text" font="굴림,9" row="1" text="수주&#32;소방스위치"/>
								<cell col="17" color="user21" display="text" font="굴림,9" row="1" text="층명"/>
								<cell col="18" color="user21" display="text" font="굴림,9" row="1" text="실측&#32;소방스위치"/>
							</head>
							<body>
								<cell align="center" col="0" colid="FLOOR" display="text" expr='FLOOR+&quot;층&quot;'/>
								<cell align="center" col="1" colid="JAMBINFO" display="text"/>
								<cell align="center" col="2" colid="FLOORNM" display="text"/>
								<cell align="center" col="3" colid="JAMBTP" color="user34" display="text"/>
								<cell align="center" col="4" colid="HPIMODEL" display="normal" edit="normal"/>
								<cell align="center" col="5" colid="FLOORNM" display="normal" edit="checkbox"/>
								<cell align="center" col="6" colid="HPIPRD" color="user34" display="normal" edit="checkbox"/>
								<cell align="center" col="7" colid="HPBMODEL" display="normal"/>
								<cell align="center" col="8" colid="FLOORNM" display="normal"/>
								<cell align="center" col="9" colid="HPBPRD" color="user34" display="normal"/>
								<cell align="center" col="10" colid="HIPMODEL" display="text"/>
								<cell align="center" col="11" colid="FLOORNM" display="text"/>
								<cell align="center" col="12" colid="HIPPRD" color="user34" display="text"/>
								<cell align="center" col="13" colid="HLTNMODEL" display="text"/>
								<cell align="center" col="14" colid="FLOORNM" display="text"/>
								<cell align="center" col="15" colid="HLTNPRD" color="user34" display="text"/>
								<cell align="center" col="16" colid="FSWMODEL" display="text"/>
								<cell align="center" col="17" colid="FLOORNM" display="text"/>
								<cell align="center" col="18" colid="FSWPRD" color="user34" display="text"/>
							</body>
						</format>
					</contents>
				</Grid>
				<Image Height="19" Id="Image0" ImageID="form_bl_title_sub" Left="8" TabOrder="5" Top="9" Width="11"></Image>
				<Static Color="user6" Font="굴림,9,Bold" Height="20" Id="Static0" Left="18" TabOrder="6" Text="수주사양-JAMB,HPI(수평형위치표시기)" Top="10" VAlign="Middle" Width="254"></Static>
				<Image Height="19" Id="Image1" ImageID="form_bl_title_sub" Left="331" TabOrder="7" Top="10" Width="11"></Image>
				<Static Color="user6" Font="굴림,9,Bold" Height="20" Id="Static1" Left="342" TabOrder="8" Text="수주사양-HPB(승장버튼)" Top="11" VAlign="Middle" Width="254"></Static>
				<Image Height="19" Id="Image3" ImageID="form_bl_title_sub" Left="653" TabOrder="9" Top="10" Width="11"></Image>
				<Static Color="user6" Font="굴림,9,Bold" Height="20" Id="Static3" Left="665" TabOrder="10" Text="수주사양-HIP(수직형위치표시기)" Top="11" VAlign="Middle" Width="254"></Static>
				<Grid AutoFitEndLine="Hide" BindDataset="ds_prh02" BkColor2="default" BoldHead="true" Border="Flat" Bottom="233" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="201" Id="grd_rad_prh02" InputPanel="FALSE" Left="333" LineColor="user20" LineType="ExHORZ" Right="653" RowHeight="20" Style="sty_grid" TabOrder="11" TabStop="true" Top="32" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="320">
					<contents>
						<format id="Default">
							<columns>
								<col width="34"/>
								<col width="177"/>
								<col width="86"/>
							</columns>
							<head>
								<cell align="center" col="0" color="user21" display="text" font="굴림,9" text="상태"/>
								<cell col="1" color="user21" display="text" font="굴림,9" text="OUTSIDE"/>
								<cell align="center" col="2" color="user21" display="text" font="굴림,9" text="값"/>
							</head>
							<body>
								<cell bkimageid='expr:gfn_getFlagBkImageID(getColumn(currow,&#32;&quot;FLAG&quot;))' col="0" display="text"/>
								<cell align="left" bkcolor2="user22" col="1" colid="PRHNAME" display="text"/>
								<cell align="center" bkcolor="expr:iif(ITYPE&#32;!=&#32;&apos;&apos;,&#32;&apos;#E4EDF4&apos;,&#32;&apos;default&apos;)" bkcolor2="expr:iif(ITYPE&#32;!=&#32;&apos;&apos;,&#32;&apos;#E4EDF4&apos;,&#32;&apos;default&apos;)" col="2" colid="PRD" display="text" edit="expr:iif(ITYPE&#32;!=&#32;&apos;&apos;,&#32;decode(ITYPE,&apos;NUM&apos;,&apos;number&apos;,&apos;normal&apos;),&#32;&apos;none&apos;)"/>
							</body>
						</format>
					</contents>
				</Grid>
				<Image Height="19" Id="Image2" ImageID="form_bl_title_sub" Left="977" TabOrder="13" Top="10" Width="11"></Image>
				<Static Color="user6" Font="굴림,9,Bold" Height="20" Id="Static2" Left="989" TabOrder="14" Text="수주사양-홀랜턴" Top="10" VAlign="Middle" Width="126"></Static>
				<Grid AutoFitEndLine="Hide" BindDataset="ds_prh04" BkColor2="default" BoldHead="true" Border="Flat" Bottom="138" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="106" Id="grd_rad_prh04" InputPanel="FALSE" Left="984" LineColor="user20" LineType="ExHORZ" Right="1304" RowHeight="20" Style="sty_grid" TabOrder="15" TabStop="true" Top="32" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="320">
					<contents>
						<format id="Default">
							<columns>
								<col width="34"/>
								<col width="154"/>
								<col width="86"/>
							</columns>
							<head>
								<cell align="center" col="0" color="user21" display="text" font="굴림,9" text="상태"/>
								<cell col="1" color="user21" display="text" font="굴림,9" text="OUTSIDE"/>
								<cell align="center" col="2" color="user21" display="text" font="굴림,9" text="값"/>
							</head>
							<body>
								<cell bkimageid='expr:gfn_getFlagBkImageID(getColumn(currow,&#32;&quot;FLAG&quot;))' col="0" display="text"/>
								<cell align="left" bkcolor2="user22" col="1" colid="PRHNAME" display="text"/>
								<cell align="center" bkcolor="expr:iif(ITYPE&#32;!=&#32;&apos;&apos;,&#32;&apos;#E4EDF4&apos;,&#32;&apos;default&apos;)" bkcolor2="expr:iif(ITYPE&#32;!=&#32;&apos;&apos;,&#32;&apos;#E4EDF4&apos;,&#32;&apos;default&apos;)" col="2" colid="PRD" display="text" edit="expr:iif(ITYPE&#32;!=&#32;&apos;&apos;,&#32;decode(ITYPE,&apos;NUM&apos;,&apos;number&apos;,&apos;normal&apos;),&#32;&apos;none&apos;)"/>
							</body>
						</format>
					</contents>
				</Grid>
				<Grid AutoFitEndLine="Hide" BindDataset="ds_prh05" BkColor2="default" BoldHead="true" Border="Flat" Bottom="230" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="62" Id="grd_rad_prh05" InputPanel="FALSE" Left="984" LineColor="user20" LineType="ExHORZ" Right="1304" RowHeight="20" Style="sty_grid" TabOrder="16" TabStop="true" Top="168" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="320">
					<contents>
						<format id="Default">
							<columns>
								<col width="34"/>
								<col width="154"/>
								<col width="86"/>
							</columns>
							<head>
								<cell align="center" col="0" color="user21" display="text" font="굴림,9" text="상태"/>
								<cell col="1" color="user21" display="text" font="굴림,9" text="OUTSIDE"/>
								<cell align="center" col="2" color="user21" display="text" font="굴림,9" text="값"/>
							</head>
							<body>
								<cell bkimageid='expr:gfn_getFlagBkImageID(getColumn(currow,&#32;&quot;FLAG&quot;))' col="0" display="text"/>
								<cell align="left" bkcolor2="user22" col="1" colid="PRHNAME" display="text"/>
								<cell align="center" bkcolor="expr:iif(ITYPE&#32;!=&#32;&apos;&apos;,&#32;&apos;#E4EDF4&apos;,&#32;&apos;default&apos;)" bkcolor2="expr:iif(ITYPE&#32;!=&#32;&apos;&apos;,&#32;&apos;#E4EDF4&apos;,&#32;&apos;default&apos;)" col="2" colid="PRD" display="text" edit="expr:iif(ITYPE&#32;!=&#32;&apos;&apos;,&#32;decode(ITYPE,&apos;NUM&apos;,&apos;number&apos;,&apos;normal&apos;),&#32;&apos;none&apos;)"/>
							</body>
						</format>
					</contents>
				</Grid>
				<Image Height="19" Id="Image4" ImageID="form_bl_title_sub" Left="980" TabOrder="17" Top="147" Width="11"></Image>
				<Static Color="user6" Font="굴림,9,Bold" Height="20" Id="Static4" Left="992" TabOrder="18" Text="수주사양-소방스위치" Top="148" VAlign="Middle" Width="123"></Static>
				<Grid AutoFitEndLine="Hide" BindDataset="ds_prh03" BkColor2="default" BoldHead="true" Border="Flat" Bottom="233" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="201" Id="grd_rad_prh03" InputPanel="FALSE" Left="657" LineColor="user20" LineType="ExHORZ" Right="977" RowHeight="20" Style="sty_grid" TabOrder="19" TabStop="true" Top="32" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="320">
					<contents>
						<format id="Default">
							<columns>
								<col width="34"/>
								<col width="177"/>
								<col width="86"/>
							</columns>
							<head>
								<cell align="center" col="0" color="user21" display="text" font="굴림,9" text="상태"/>
								<cell col="1" color="user21" display="text" font="굴림,9" text="OUTSIDE"/>
								<cell align="center" col="2" color="user21" display="text" font="굴림,9" text="값"/>
							</head>
							<body>
								<cell bkimageid='expr:gfn_getFlagBkImageID(getColumn(currow,&#32;&quot;FLAG&quot;))' col="0" display="text"/>
								<cell align="left" bkcolor2="user22" col="1" colid="PRHNAME" display="text"/>
								<cell align="center" bkcolor="expr:iif(ITYPE&#32;!=&#32;&apos;&apos;,&#32;&apos;#E4EDF4&apos;,&#32;&apos;default&apos;)" bkcolor2="expr:iif(ITYPE&#32;!=&#32;&apos;&apos;,&#32;&apos;#E4EDF4&apos;,&#32;&apos;default&apos;)" col="2" colid="PRD" display="text" edit="expr:iif(ITYPE&#32;!=&#32;&apos;&apos;,&#32;decode(ITYPE,&apos;NUM&apos;,&apos;number&apos;,&apos;normal&apos;),&#32;&apos;none&apos;)"/>
							</body>
						</format>
					</contents>
				</Grid>
			</Contents>
		</Div>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_floor_out" ImageID="btn_sub_08" Left="733" LeftMargin="12" OnClick="btn_floor_out_OnClick" Style="sty_btn" TabOrder="4" Text="수주사양&#32;층별전개" Top="50" Transparent="TRUE" Width="111"></Button>
	</Form>
	<Script><![CDATA[/*
 ******************************************************************************************
 * 기      능   : 리모델링 실측값 적용
 * 작  성  자   : 홍길동
 * 작성  일자   : 
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */   
#include "LIB::commons.js";	// 공통 스크립트 
#include "LIB::nsfRequest.js";	// 공통 스크립트 
#include "LIB::common_hdel.js";	// 공통 스크립트  /* GNY 추가 */
//=========================================================================================
// [ PART 1 ]
// Form에서 사용될 전역변수를 선언
// FORM에서 사용되는 전역변수는 대문자로 작성하며, F_XXX 의 형태를 갖도록 한다. 
//=========================================================================================
var F_TITLE = "리모델링 수주사양 층별전개";
var G_PRH_Array = ["ds_prh01" ,"ds_prh02" ,"ds_prh03" ,"ds_prh04" ,"ds_prh05"];
var SUVSN = "";
var FLOORYSNO  = "N";  // 리모델링층별사양 실행결과 여부 만약 오류가 발생하면 오류코드:E

//=========================================================================================
// [ PART 2 ]
// Form Loading / Unloading 시 작업 정의
//=========================================================================================
function fn_OnLoadCompleted(obj) {
    // 팝업 버튼 적용
	div_btn.fn_loadUseBtn("900", F_TITLE, "", "");
	gfn_initForm();
	fn_init_form();
}

/********************************************************************************
* 기      능   : form UnloadCompleted 
********************************************************************************/
function fn_OnUnloadCompleted(obj) {
	return gfn_isFormUnload(obj);
}

/********************************************************************************
* 기      능   : 폼 초기화
********************************************************************************/
function fn_init_form() {
    // 화면 사이즈 조정
    fn_resize();

    ds_template_floor.ClearData();
    // 복사처리
    ds_template_floor.Copy(parent.ds_template_prh);
    ds_suv_prh_cp.Copy(parent.ds_suv_prh);
    
    ds_prh01.OnColumnChanged = "";
    ds_prh02.OnColumnChanged = "";
    ds_prh03.OnColumnChanged = "";
    ds_prh04.OnColumnChanged = "";
    ds_prh05.OnColumnChanged = "";
    
    // 화면에 정의된 영업사양 코드명과 코드값으로 로컬 데이터셑을 변경한다.
    // ds_prh01, ds_prh02, ds_prh03, ds_prh04, ds_prh05, ds_prh06
    //trace("ds_template_floor:"+ds_template_floor.SaveXML());
    var dsObj;
    var objId;
    var objIndex;
    var prh;
    var prhName;
    var prd;
    var findRow = -1;
    for(var i=0; i < Length(G_PRH_Array); i++) {
        dsObj = object(G_PRH_Array[i]);
        for(var j=0; j < dsObj.GetRowCount(); j++) {
            prh = dsObj.GetColumn(j, "PRH");
            findRow = ds_template_floor.FindRow("PRH", prh);
            if(findRow > -1) {
                objId = ds_template_floor.GetColumn(findRow, "OBJID");
                objIndex = ds_template_floor.GetColumn(findRow, "OBJINDEX");
                prhName = ds_template_floor.GetColumn(findRow, "PRHNAME");
                prd = ds_template_floor.GetColumn(findRow, "PRD");
                
                // 값을 반영한다.
                dsObj.SetColumn(j, "OBJID", objId);
                dsObj.SetColumn(j, "OBJINDEX", objIndex);
                dsObj.SetColumn(j, "PRHNAME", prhName);
                dsObj.SetColumn(j, "PRD", prd);
            }
        }
        dsObj.ApplyChange();
    }
    
    ds_prh01.OnColumnChanged = "ds_prh_OnColumnChanged";
    ds_prh02.OnColumnChanged = "ds_prh_OnColumnChanged";
    ds_prh03.OnColumnChanged = "ds_prh_OnColumnChanged";
    ds_prh04.OnColumnChanged = "ds_prh_OnColumnChanged";
    ds_prh05.OnColumnChanged = "ds_prh_OnColumnChanged";

    // 최초 리모델링 수주사양 층별전개
    fn_query();
}

/********************************************************************************
* 기      능   : 윈도우 사이즈 조정
********************************************************************************/
function fn_resize() {
	//this.window.showwindow("Maximize");
	window.top    = GetPlatformInfo("WorkArea","top");
	window.left   = GetPlatformInfo("WorkArea","left");
	window.width  = GetPlatformInfo("WorkArea","width");
	window.height = GetPlatformInfo("WorkArea","height");
	
	div_pop.width = window.width - 20;
	div_pop.Height = window.height- 100;
}

//=========================================================================================
// [ PART 3 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,form닫기)
//=========================================================================================
function fn_OnClick_btn(obj)
{
	var fncName = "fn_" + substr(obj.id, 4);
	eval( fncName + "()");
}

/********************************************************************************
* 기      능   : 조회(층별사양전개 처리 데이터 조회)
********************************************************************************/
function fn_query() {
    // 층별사양 전개 입력값 생성이 완료되면 영업사양 + 실측사양 층별전개 로직을 수행한다.
    var svcId     = "specFloorOut";
    var svcUrl    = "radSurveyC/specFloorOut";
    var inDsList  = "ds_template_floor=ds_template_floor ds_floorSuvPrh=ds_floorSuvPrh ds_suv_prh=ds_suv_prh_cp";
    var outDsList = "FLOORYSNO=FLOORYSNO ds_error=ds_error ds_floorSuvPrh=ds_floorSuvPrh";
    var inParam   = " SUVSN='"+SUVSN+"'";
    var callBackFunc = "fn_afterQuery";

    fn_createWait("",this);
    ds_error.ClearData();
    ds_floorSuvPrh.ClearData();
    nsfRequest(svcId, svcUrl, inDsList, outDsList, inParam, callBackFunc);
}

/********************************************************************************
* 기      능   : 액셀  
********************************************************************************/
function fn_excel() {
    fn_createWait("",this);
}

/********************************************************************************
* 기      능   : 확인  
********************************************************************************/
function fn_confirm() {
    fn_createWait("",this);
}

/********************************************************************************
* 기      능   : 닫기  
********************************************************************************/
function fn_close() {
    if(ds_template_floor.GetUpdate()) {
		if (gfn_showConfirm("CW10025", "수정한 DATA는 손실됩니다. 리모델링 수주사양 층별전개 화면을 종료하시겠습니까??") == true) {
			this.close();
		}
    } else {
	    this.close();
    }
}

/********************************************************************************
* 기      능   : 저장(층별전개사양 저장)
********************************************************************************/
function fn_save() {
    var elAuse    = "";
    var elEmf     = "";
    var elEmf     = "";
    var dpk       = "";
    // 층별전개 저장 시 장애용 홀버튼 높이 산출판단을 위해 용도값을 파라미터로 전달한다.
    findRow = ds_template_floor.FindRow("PRH", "EL_AUSE");
    if(findRow > -1) {
        elAuse = ds_template_floor.GetColumn(findRow, "PRD");
    }
    findRow = ds_template_floor.FindRow("PRH", "EL_EMF");
    if(findRow > -1) {
        elEmf = ds_template_floor.GetColumn(findRow, "PRD");
    }
    
    // 파라미터 추가
    findRow = parent.ds_template_prh.FindRow("PRH", "EL_DPK");
    if(findRow > -1) {
        dpk = ds_template_floor.GetColumn(findRow, "PRD");
        if(Length(dpk) == 0) {
            dpk = "N";
        }
    }
    ds_floor.ClearData();

    var svcId     = "applyFloorOut";
    var svcUrl    = "radSurveyC/applyFloorOut";
    var inDsList  = "ds_floorSuvPrh=ds_floorSuvPrh ds_suv_prh=ds_suv_prh_cp ds_floor=ds_floor";
    var outDsList = "ds_error=ds_error ds_floor=ds_floor";
    var inParam   = " SUVSN='"+SUVSN+"' EL_AUSE='"+elAuse+"' EL_EMF='"+elEmf+"' EL_DPK='"+dpk+"'";
    var callBackFunc = "fn_afterSave";
    var findRow = -1;
    fn_createWait("",this);
    ds_error.ClearData();
    nsfRequest(svcId, svcUrl, inDsList, outDsList, inParam, callBackFunc);
} 

/********************************************************************************
* 기      능   : 저장 입력값 체크
********************************************************************************/
function fn_save_validate() {
    var isValidate = true;
    return isValidate;
}

//=========================================================================================
// [ PART 4]
// Callback 함수 정의 : callback 함수명은 메인 함수의 fn_xxxx() 에서 xxxx 부분은 fn_afterXXXX()
// 형태가 되도록 작성 
//=========================================================================================
/********************************************************************************
* 기      능   : fn_init_form Callback  
********************************************************************************/
function fn_afterInitForm(svcId, errCode, errMsg) {
    fn_destroyWait();
	if(ds_error.rowcount > 0)	{
		gfn_showAlert(ds_error.GetColumn(0,"ERRMSG"));
		return;
	}
}

/********************************************************************************
* 기      능   : 조회 Callback  
********************************************************************************/
function fn_afterQuery(svcId, errCode, errMsg) {
    fn_destroyWait();
	if(ds_error.rowcount > 0)	{
		// 데이터셋 정렬
		ds_floorSuvPrh.Sort("FLOORNUM", false);
		gfn_showAlert(ds_error.GetColumn(0,"ERRMSG"));
		return;
	}

	//ds_jamb_msg
	// 만약 실측치 JAMB과 영업사양 JAMB이 불일치 하면 경고 메시지 처리한다. FLOORYSNO = N ds_floorSuvPrh
	var JAMBGRP;
	var JAMBMODEL;
	var JAMBTP;
	var key;
	var msg;
	var addRow = -1;
	var findRow = -1;
	ds_jamb_msg.ClearData();
	for(var i=0; i < ds_floorSuvPrh.GetRowCount(); i++) {
		JAMBGRP = ds_floorSuvPrh.GetColumn(i, "JAMBGRP");
		JAMBMODEL = ds_floorSuvPrh.GetColumn(i, "JAMBMODEL");
		JAMBTP = Replace(JAMBTP, "U", "");
		if(Length(JAMBMODEL)>0 && Length(JAMBTP)>0) {
			if(IndexOf(JAMBMODEL, JAMBTP) < 0) {
				key = JAMBGRP + JAMBMODEL + JAMBTP;
				msg = "";
				if(JAMBGRP == "1") {
					msg = "영업사양 [C002 \JAMB(1):"+JAMBMODEL+"]과 실측사양 ["+JAMBTP+"]과 값이 달라 자동도면을 생성할 수 없습니다.\n";
				} else if(JAMBGRP == "2") {
					msg = "영업사양 [C011 \JAMB(2):"+JAMBMODEL+"]과 실측사양 ["+JAMBTP+"]과 값이 달라 자동도면을 생성할 수 없습니다.\n";
				} else if(JAMBGRP == "3") {
					msg = "영업사양 [C020 \JAMB(3):"+JAMBMODEL+"]과 실측사양 ["+JAMBTP+"]과 값이 달라 자동도면을 생성할 수 없습니다.\n";
				}
				findRow = ds_jamb_msg.FindRow("KEY", key);
				if(findRow<0 && msg != "") {
					addRow = ds_jamb_msg.AddRow();
					ds_jamb_msg.SetColumn(addRow, "KEY", key);
					ds_jamb_msg.SetColumn(addRow, "MSG", msg);
				}
			}
		}
	}

	if(ds_jamb_msg.GetRowCount()>0) {
		msg = "";
		for(var j=0; j < ds_jamb_msg.GetRowCount(); j++) {
			msg = msg + ds_jamb_msg.GetColumn(j, "MSG");
		}
		gfn_openMsgWin(msg, "", "A", "오류알림");
		FLOORYSNO = "N";
	} else {
	    gfn_openMsgWin("수주사양 층별전개가 정상적으로 처리 되었습니다.전개 결과 확인 후 층별 수주사양 적용 버튼을 수행해 주십시요.", "", "A", "알림");
	}

	// 데이터셋 정렬
	ds_floorSuvPrh.Sort("FLOORNUM", false);
}

/********************************************************************************
* 기      능   : 저장 Callback  
********************************************************************************/
function fn_afterSave(svcId, errCode, errMsg) {
	if(ds_error.rowcount > 0)	{
		gfn_showAlert(ds_error.GetColumn(0,"ERRMSG"));
        fn_destroyWait();
		return;
	} else {
	    // 저장 후 층별사양 전개 값 처리
        // 첫번째 메인 화면에서 가지고 있는 영업사양값 변경
        var flag;
        for(var i =0; i < ds_template_floor.GetRowCount(); i++) {
            flag = ds_template_floor.GetColumn(i, "FLAG");
            prh  = ds_template_floor.GetColumn(i, "PRH");
            if(flag == "U") {
				objId    = ds_template_floor.GetColumn(i, "OBJID");
				objIndex = ds_template_floor.GetColumn(i, "OBJINDEX");
				prd   = ds_template_floor.GetColumn(i, "PRD");
				object(objId).SetColumn(objIndex, "PRD", prd);
            }
        }

        //trace("ds_floor:"+ds_floor.SaveXML());
        // ELR_C_EF 층고실적 CHGPRD 초기화
        var suvprh;
        for(var i=0; i < parent.ds_suv_prh.GetRowCountNF(); i++) {
            suvprh = parent.ds_suv_prh.GetColumnNF(i, "SUVPRH");
            if(IndexOf(suvprh, "ELR_C_EF") > -1 || IndexOf(suvprh, "ELC_C_EF") > -1) {
                parent.ds_suv_prh.SetColumnNF(i, "CALPRD", "");
            }
        }
        
        
        var findRow = -1;
        var calprd;
        for(var i=0; i < ds_floor.GetRowCount(); i++) {
            suvprh = ds_floor.GetColumn(i, "SUVPRH");
            calprd = ds_floor.GetColumn(i, "CALPRD");
			findRow = parent.ds_suv_prh.FindRowNF("SUVPRH", suvprh);
			if(findRow > -1) {
				parent.ds_suv_prh.SetColumnNF(findRow, "CALPRD", calprd);
			}
        }
        fn_destroyWait();

        // 처리 성공 메시지 처리
        gfn_openMsgWin("층별 수주사양 적용이 완료 되었습니다.", "", "A", "알림");

		// 화면에 존재하는 층별전개 데이터를 DB에 저장한다.
		this.close(FLOORYSNO);
	}
}

//=========================================================================================
// [ PART 5]
// 화면 UI 함수
//=========================================================================================
/********************************************************************************
* 기      능   : 사양 적용층 변경 시 층별 수주사양 및 실측사양 전개값을 최신화 한다.
********************************************************************************/
function ds_prh_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{
    if(varOldValue != varNewValue && strColumnID == "PRD") {
        // 상태 플래그를 변경한다.
        gfn_changeFlag( obj, strColumnID, nRow, "FLAG");
    
        // 층별 전개 사양값을 변경한다.
        var prh = obj.GetColumn(nRow, "PRH");
        var findRow = -1;
        findRow = ds_template_floor.FindRow("PRH", prh);
        if(findRow >-1) {
            ds_template_floor.SetColumn(findRow, "FLAG", "U");
            ds_template_floor.SetColumn(findRow, "PRD", varNewValue);
            // 상태 플래그를 변경한다.
            gfn_changeFlag( ds_template_floor, "PRD", findRow, "FLAG");

            // 값 변경 시 처리
            FLOORYSNO = "N";
        }
    }
}

/********************************************************************************
* 기      능   : 층별사양전개 조회
********************************************************************************/
function btn_floor_out_OnClick(obj)
{
    // 변경된 값이 없는면 층별전개를 처리하지 않는다.
    if(ds_template_floor.GetUpdate() || ds_prh02.GetUpdate() || ds_prh03.GetUpdate() || ds_prh04.GetUpdate() || ds_prh05.GetUpdate()) {
        fn_query();	
    }
}

/********************************************************************************
* 기      능   : 층별사양전개 데이터를 DB에 저장한다.
********************************************************************************/
function btn_rap_cal_OnClick(obj)
{
    // 변경된 값이 없는면 층별전개를 처리하지 않는다.
	// 실측값 수주사양을 화면에 반영한다.
	var objId;
	var objIndex;
	var prd;
	var findRow;
	var prh;
    if(FLOORYSNO == "Y") {
        // 저장
        fn_save();
    } else {
        gfn_openMsgWin("영업사양을 수정하여 수주사양 층별전개를 수행해 주십시요", "", "A", "알림");
    }
}
]]></Script>
</Window>