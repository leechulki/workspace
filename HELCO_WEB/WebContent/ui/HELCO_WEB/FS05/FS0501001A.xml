<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="562" Id="FS0501001A" Left="8" OnLoadCompleted="fn_OnLoadCompleted" OnUnloadCompleted="fn_OnUnloadCompleted" PidAttrib="7" Title="프로젝트&#32;이동계획&#32;조회" Top="8" Ver="1.0" Width="978" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_error">
				<Contents>
					<colinfo id="IDX" size="256" type="STRING"/>
					<colinfo id="ERRMSG" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond">
				<Contents>
					<colinfo id="MANDT" size="3" summ="default" type="STRING"/>
					<colinfo id="PSPID" size="12" summ="default" type="STRING"/>
					<colinfo id="ESCS_MONTH_FROM" size="12" summ="default" type="STRING"/>
					<colinfo id="ESCS_MONTH_TO" size="12" summ="default" type="STRING"/>
					<colinfo id="ORDR_TYPE" size="256" summ="default" type="STRING"/>
					<colinfo id="SALE_PRSN" size="256" summ="default" type="STRING"/>
					<colinfo id="SALE_PRSN_NAME" size="256" summ="default" type="STRING"/>
					<colinfo id="EBDG_MGST" size="256" summ="default" type="STRING"/>
					<colinfo id="BSTDK" size="256" summ="default" type="STRING"/>
					<record>
						<BSTDK></BSTDK>
						<EBDG_MGST></EBDG_MGST>
						<ESCS_MONTH_FROM></ESCS_MONTH_FROM>
						<ESCS_MONTH_TO></ESCS_MONTH_TO>
						<MANDT></MANDT>
						<ORDR_TYPE></ORDR_TYPE>
						<PSPID></PSPID>
						<SALE_PRSN></SALE_PRSN>
						<SALE_PRSN_NAME></SALE_PRSN_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_combo_a03">
				<Contents>
					<colinfo id="CDGR_UPER" size="30" summ="default" type="STRING"/>
					<colinfo id="CODE" size="30" summ="default" type="STRING"/>
					<colinfo id="CODE_GROP" size="30" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="150" summ="default" type="STRING"/>
					<colinfo id="CODE_UPER" size="30" summ="default" type="STRING"/>
					<colinfo id="DATASET_ID" size="200" summ="default" type="STRING"/>
					<colinfo id="EXTN_CODE1" size="150" summ="default" type="STRING"/>
					<colinfo id="EXTN_CODE2" size="150" summ="default" type="STRING"/>
					<colinfo id="EXTN_CODE3" size="150" summ="default" type="STRING"/>
					<colinfo id="EXTN_CODE4" size="150" summ="default" type="STRING"/>
					<colinfo id="EXTN_CODE5" size="150" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_pspid_list">
				<Contents>
					<colinfo id="MANDT" size="256" summ="default" type="STRING"/>
					<colinfo id="ORDR_TYPE" size="256" summ="default" type="STRING"/>
					<colinfo id="ORDR_TYPE_NAME" size="256" summ="default" type="STRING"/>
					<colinfo id="PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="BSTNK" size="256" summ="default" type="STRING"/>
					<colinfo id="BSTDK" size="256" summ="default" type="STRING"/>
					<colinfo id="VDATU" size="256" summ="default" type="STRING"/>
					<colinfo id="ESMT_TAMT" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="ESMT_RATE" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="SLCS_RATE" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="SALE_COST" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="ZTERM" size="256" summ="default" type="STRING"/>
					<colinfo id="ZTERM_NAME" size="256" summ="default" type="STRING"/>
					<colinfo id="EBDG_TAMT" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="ADOC_CLAS" size="256" summ="default" type="STRING"/>
					<colinfo id="EXE_FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="ADOC_NUMB" size="20" summ="default" type="STRING"/>
					<colinfo id="EBDG_MGSQ" size="256" summ="default" type="INT"/>
					<colinfo id="EBDG_MGST" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_plan_data" OnColumnChanged="ds_plan_data_OnColumnChanged">
				<Contents>
					<colinfo id="MANDT" size="10" summ="default" type="STRING"/>
					<colinfo id="DIV" size="10" summ="default" type="STRING"/>
					<colinfo id="DIV_NAME" size="10" summ="default" type="STRING"/>
					<colinfo id="ADOC_CLAS" size="10" summ="default" type="STRING"/>
					<colinfo id="ADOC_NUMB" size="20" summ="default" type="STRING"/>
					<colinfo id="TOT_AMT" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="AGO_TOT_AMT" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="YEAR_TOT_AMT" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="AMT0" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="AMT1" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="AMT2" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="AMT3" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="AMT4" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="AMT5" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="AMT6" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="AMT7" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="AMT8" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="AMT9" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="AMT10" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="AMT11" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="AMT12" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="AMT13" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="AMT14" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="AMT15" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="AMT16" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="AMT17" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="AMT18" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="AMT19" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="AMT20" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="AMT21" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="AMT22" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="AMT23" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="ORG_AMT0" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="ORG_AMT1" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="ORG_AMT2" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="ORG_AMT3" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="ORG_AMT4" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="ORG_AMT5" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="ORG_AMT6" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="ORG_AMT7" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="ORG_AMT8" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="ORG_AMT9" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="ORG_AMT10" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="ORG_AMT11" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="ORG_AMT12" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="ORG_AMT13" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="ORG_AMT14" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="ORG_AMT15" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="ORG_AMT16" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="ORG_AMT17" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="ORG_AMT18" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="ORG_AMT19" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="ORG_AMT20" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="ORG_AMT21" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="ORG_AMT22" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="ORG_AMT23" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="FLAG" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_zfst0500_list">
				<Contents>
					<colinfo id="MANDT" size="3" summ="default" type="STRING"/>
					<colinfo id="ADOC_CLAS" size="10" summ="default" type="STRING"/>
					<colinfo id="ADOC_NUMB" size="20" summ="default" type="STRING"/>
					<colinfo id="ZYEAR" size="4" summ="default" type="STRING"/>
					<colinfo id="ZMONTH" size="2" summ="default" type="STRING"/>
					<colinfo id="WAERK" size="5" summ="default" type="STRING"/>
					<colinfo id="SALE_AMT" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="BAMT" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="CAMT" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="FLAG" size="10" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_combo_a02">
				<Contents>
					<colinfo id="CDGR_UPER" size="30" summ="default" type="STRING"/>
					<colinfo id="CODE" size="30" summ="default" type="STRING"/>
					<colinfo id="CODE_GROP" size="30" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="150" summ="default" type="STRING"/>
					<colinfo id="CODE_UPER" size="30" summ="default" type="STRING"/>
					<colinfo id="DATASET_ID" size="200" summ="default" type="STRING"/>
					<colinfo id="EXTN_CODE1" size="150" summ="default" type="STRING"/>
					<colinfo id="EXTN_CODE2" size="150" summ="default" type="STRING"/>
					<colinfo id="EXTN_CODE3" size="150" summ="default" type="STRING"/>
					<colinfo id="EXTN_CODE4" size="150" summ="default" type="STRING"/>
					<colinfo id="EXTN_CODE5" size="150" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_pspid_pk">
				<Contents>
					<colinfo id="PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="ADOC_NUMB" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_amt01">
				<Contents>
					<colinfo id="DIVS" size="256" summ="default" type="STRING"/>
					<colinfo id="PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="MONTH" size="256" summ="default" type="STRING"/>
					<colinfo id="AMT" size="256" summ="default" type="DECIMAL"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_amt02">
				<Contents>
					<colinfo id="DIVS" size="256" summ="default" type="STRING"/>
					<colinfo id="PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="MONTH" size="256" summ="default" type="STRING"/>
					<colinfo id="AMT" size="256" summ="default" type="DECIMAL"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_amt03">
				<Contents>
					<colinfo id="DIVS" size="256" summ="default" type="STRING"/>
					<colinfo id="PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="MONTH" size="256" summ="default" type="STRING"/>
					<colinfo id="AMT" size="256" summ="default" type="DECIMAL"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_month">
				<Contents>
					<colinfo id="MONTH" size="256" summ="default" type="STRING"/>
					<colinfo id="ROW_INDEX" size="256" summ="default" type="INT"/>
					<colinfo id="COL_ID" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_zfst0500">
				<Contents>
					<colinfo id="MANDT" size="3" summ="default" type="STRING"/>
					<colinfo id="ADOC_CLAS" size="10" summ="default" type="STRING"/>
					<colinfo id="ADOC_NUMB" size="20" summ="default" type="STRING"/>
					<colinfo id="ZYEAR" size="4" summ="default" type="STRING"/>
					<colinfo id="ZMONTH" size="2" summ="default" type="STRING"/>
					<colinfo id="WAERK" size="5" summ="default" type="STRING"/>
					<colinfo id="SALE_AMT" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="BAMT" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="CAMT" size="15" summ="default" type="DECIMAL"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_zfst0500_1">
				<Contents>
					<colinfo id="MANDT" size="3" summ="default" type="STRING"/>
					<colinfo id="ADOC_CLAS" size="10" summ="default" type="STRING"/>
					<colinfo id="ADOC_NUMB" size="20" summ="default" type="STRING"/>
					<colinfo id="ZYEAR" size="4" summ="default" type="STRING"/>
					<colinfo id="ZMONTH" size="2" summ="default" type="STRING"/>
					<colinfo id="WAERK" size="5" summ="default" type="STRING"/>
					<colinfo id="SALE_AMT" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="BAMT" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="CAMT" size="15" summ="default" type="DECIMAL"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_zfst0500_2">
				<Contents>
					<colinfo id="MANDT" size="3" summ="default" type="STRING"/>
					<colinfo id="ADOC_CLAS" size="10" summ="default" type="STRING"/>
					<colinfo id="ADOC_NUMB" size="20" summ="default" type="STRING"/>
					<colinfo id="ZYEAR" size="4" summ="default" type="STRING"/>
					<colinfo id="ZMONTH" size="2" summ="default" type="STRING"/>
					<colinfo id="WAERK" size="5" summ="default" type="STRING"/>
					<colinfo id="SALE_AMT" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="BAMT" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="CAMT" size="15" summ="default" type="DECIMAL"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_zfst0301">
				<Contents>
					<colinfo id="MANDT" size="3" summ="default" type="STRING"/>
					<colinfo id="OCNT_NUMB" size="20" summ="default" type="STRING"/>
					<colinfo id="EBDG_MGSQ" size="10" summ="default" type="INT"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_pspid_excel">
				<Contents>
					<colinfo id="MANDT" size="256" summ="default" type="STRING"/>
					<colinfo id="ORDR_TYPE" size="256" summ="default" type="STRING"/>
					<colinfo id="ORDR_TYPE_NAME" size="256" summ="default" type="STRING"/>
					<colinfo id="PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="BSTNK" size="256" summ="default" type="STRING"/>
					<colinfo id="BSTDK" size="256" summ="default" type="STRING"/>
					<colinfo id="VDATU" size="256" summ="default" type="STRING"/>
					<colinfo id="ESMT_TAMT" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="ESMT_RATE" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="SLCS_RATE" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="SALE_COST" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="ZTERM" size="256" summ="default" type="STRING"/>
					<colinfo id="ZTERM_NAME" size="256" summ="default" type="STRING"/>
					<colinfo id="EBDG_TAMT" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="ADOC_CLAS" size="256" summ="default" type="STRING"/>
					<colinfo id="EXE_FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="ADOC_NUMB" size="20" summ="default" type="STRING"/>
					<colinfo id="EBDG_MGSQ" size="256" summ="default" type="INT"/>
					<colinfo id="EBDG_MGST" size="256" summ="default" type="STRING"/>
					<colinfo id="DIV" size="10" summ="default" type="STRING"/>
					<colinfo id="DIV_NAME" size="10" summ="default" type="STRING"/>
					<colinfo id="TOT_AMT" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="AGO_TOT_AMT" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="YEAR_TOT_AMT" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="AMT0" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="AMT1" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="AMT2" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="AMT3" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="AMT4" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="AMT5" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="AMT6" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="AMT7" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="AMT8" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="AMT9" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="AMT10" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="AMT11" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="AMT12" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="AMT13" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="AMT14" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="AMT15" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="AMT16" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="AMT17" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="AMT18" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="AMT19" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="AMT20" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="AMT21" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="AMT22" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="AMT23" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="ORG_AMT0" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="ORG_AMT1" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="ORG_AMT2" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="ORG_AMT3" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="ORG_AMT4" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="ORG_AMT5" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="ORG_AMT6" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="ORG_AMT7" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="ORG_AMT8" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="ORG_AMT9" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="ORG_AMT10" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="ORG_AMT11" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="ORG_AMT12" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="ORG_AMT13" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="ORG_AMT14" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="ORG_AMT15" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="ORG_AMT16" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="ORG_AMT17" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="ORG_AMT18" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="ORG_AMT19" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="ORG_AMT20" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="ORG_AMT21" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="ORG_AMT22" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="ORG_AMT23" size="15" summ="default" type="DECIMAL"/>
				</Contents>
			</Dataset>
			<Dataset DataObject="ds_plan_data" DataSetType="Filter" FilterExpr='ADOC_CLAS&#32;==&#32;ds_pspid_list.GetColumn(ds_pspid_list.GetRowPos(),&#32;&quot;ADOC_CLAS&quot;)&#32;&amp;&amp;&#32;ADOC_NUMB&#32;==&#32;ds_pspid_list.GetColumn(ds_pspid_list.GetRowPos(),&#32;&quot;ADOC_NUMB&quot;)' Id="ds_plan_fdata"></Dataset>
		</Datasets>
		<Shape BKColor="user0" Bottom="30" Height="30" Id="Shape1" Left="0" LineColor="user1" Right="978" TabOrder="1" Top="0" Type="Rectangle" Width="978"></Shape>
		<Grid AutoEnter="TRUE" AutoFitEndLine="Hide" BindDataset="ds_pspid_list" BkColor2="default" BoldHead="true" Border="Flat" Bottom="344" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="25" Height="304" Id="grd_plan" InputPanel="FALSE" Left="8" LineColor="user20" LineType="ExHORZ" OnCellPosChanged="grd_plan_OnCellPosChanged" OnHeadClick="grd_list_OnHeadClick" Right="968" RowHeight="20" Style="sty_grid" TabOrder="2" TabStop="true" Top="40" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="960">
			<contents>
				<format id="Default">
					<columns>
						<col width="0"/>
						<col width="121"/>
						<col width="97"/>
						<col width="213"/>
						<col width="77"/>
						<col width="75"/>
						<col width="94"/>
						<col width="72"/>
						<col width="66"/>
						<col width="92"/>
						<col width="92"/>
						<col width="74"/>
					</columns>
					<head>
						<cell col="0" display="text"/>
						<cell col="1" color="user21" display="text" font="굴림,9" text="오더유형"/>
						<cell align="center" col="2" color="user21" display="text" font="굴림,9" text="프로젝트번호" wordwrap="word"/>
						<cell align="center" col="3" color="user21" display="text" font="굴림,9" text="프로젝트명" wordwrap="word"/>
						<cell col="4" color="user21" display="text" font="굴림,9" text="수주일자"/>
						<cell col="5" color="user21" display="text" font="굴림,9" text="납기"/>
						<cell col="6" color="user21" display="text" font="굴림,9" text="수주금액"/>
						<cell col="7" color="user21" display="text" font="굴림,9" text="수주시행율"/>
						<cell col="8" color="user21" display="text" font="굴림,9" text="시행율"/>
						<cell col="9" color="user21" display="text" font="굴림,9" text="수주원가"/>
						<cell col="10" color="user21" display="text" font="굴림,9" text="시행예산금액"/>
						<cell col="11" color="user21" display="text" font="굴림,9" text="지급조건"/>
					</head>
					<body>
						<cell align="center" bkcolor2="user22" col="0" display="text" edit="normal"/>
						<cell align="center" col="1" colid="ORDR_TYPE_NAME" display="text"/>
						<cell align="center" bkcolor2="user22" col="2" colid="PSPID" display="text" expandsize="0"/>
						<cell align="left" bkcolor2="user22" col="3" colid="BSTNK" display="text" expandsize="30" limit="765" Valign="Center"/>
						<cell align="center" col="4" colid="BSTDK" display="date" Valign="Center"/>
						<cell align="center" col="5" colid="VDATU" display="date" Valign="Center"/>
						<cell col="6" colid="ESMT_TAMT" display="number" Valign="Center"/>
						<cell align="center" col="7" colid="ESMT_RATE" display="number" Valign="Center"/>
						<cell align="center" col="8" colid="SLCS_RATE" display="text" Valign="Center"/>
						<cell align="right" col="9" colid="SALE_COST" display="number" Valign="Center"/>
						<cell align="right" col="10" colid="EBDG_TAMT" display="number" Valign="Center"/>
						<cell align="center" col="11" colid="ZTERM_NAME" display="text" Valign="Center"/>
					</body>
					<summary>
						<cell col="0" display="text"/>
						<cell align="center" bkcolor="user25" col="1" color="user26" colspan="5" display="text" text="합계"/>
						<cell align="right" bkcolor="user25" col="6" color="user26" display="number" expr='ds_pspid_list.Sum(&quot;ESMT_TAMT&quot;)' text="ㅁㅁㅁ"/>
						<cell align="center" bkcolor="user25" col="7" color="user26" display="text" expr='round(ds_pspid_list.Sum(&quot;SALE_COST&quot;)/ds_pspid_list.Sum(&quot;ESMT_TAMT&quot;)*100,2)'/>
						<cell align="center" bkcolor="user25" col="8" color="user26" display="text" expr='round(ds_pspid_list.Sum(&quot;EBDG_TAMT&quot;)/ds_pspid_list.Sum(&quot;ESMT_TAMT&quot;)*100,2)'/>
						<cell align="right" bkcolor="user25" col="9" color="user26" display="number" expr='ds_pspid_list.Sum(&quot;SALE_COST&quot;)'/>
						<cell align="right" bkcolor="user25" col="10" color="user26" display="number" expr='ds_pspid_list.Sum(&quot;EBDG_TAMT&quot;)'/>
						<cell bkcolor="user25" col="11" color="user26" display="text"/>
					</summary>
				</format>
			</contents>
		</Grid>
		<Grid AutoEnter="TRUE" AutoFitEndLine="Hide" BindDataset="ds_plan_fdata" BkColor2="default" BoldHead="true" Border="Flat" Bottom="543" ColSelect="TRUE" ColSizing="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="175" Id="grd_amt" InputPanel="FALSE" Left="8" LineColor="user20" LineType="ExHORZ" Right="968" RowHeight="20" Style="sty_grid" TabOrder="3" TabStop="true" Top="368" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="960">
			<contents>
				<format id="Default">
					<columns>
						<col width="0"/>
						<col width="84"/>
						<col width="86"/>
						<col width="86"/>
						<col width="86"/>
						<col width="65"/>
						<col width="65"/>
						<col width="65"/>
						<col width="65"/>
						<col width="65"/>
						<col width="65"/>
						<col width="65"/>
						<col width="65"/>
						<col width="65"/>
						<col width="65"/>
						<col width="65"/>
						<col width="65"/>
						<col width="65"/>
						<col width="65"/>
						<col width="65"/>
						<col width="65"/>
						<col width="65"/>
						<col width="65"/>
						<col width="65"/>
						<col width="65"/>
						<col width="65"/>
						<col width="65"/>
						<col width="65"/>
						<col width="65"/>
					</columns>
					<head>
						<cell align="center" col="0" display="text" text="프로젝트번호" Valign="Center" wordwrap="word"/>
						<cell align="center" col="1" display="text" text="구분" Valign="Center" wordwrap="word"/>
						<cell align="center" col="2" display="text" text="총합계" Valign="Center" wordwrap="word"/>
						<cell align="center" col="3" display="text" text="이전년월합계" Valign="Center" wordwrap="word"/>
						<cell align="center" col="4" display="text" text="년월합계" Valign="Center" wordwrap="word"/>
						<cell align="center" col="5" display="text" text="1월"/>
						<cell align="center" col="6" display="text" text="2월"/>
						<cell align="center" col="7" display="text" text="3월"/>
						<cell align="center" col="8" display="text" text="4월"/>
						<cell align="center" col="9" display="text" text="5월"/>
						<cell align="center" col="10" display="text" text="6월"/>
						<cell align="center" col="11" display="text" text="7월"/>
						<cell align="center" col="12" display="text" text="8월"/>
						<cell align="center" col="13" display="text" text="9월"/>
						<cell align="center" col="14" display="text" text="10월"/>
						<cell align="center" col="15" display="text" text="11월"/>
						<cell align="center" col="16" display="text" text="12월"/>
						<cell align="center" col="17" display="text" text="1월"/>
						<cell align="center" col="18" display="text" text="2월"/>
						<cell align="center" col="19" display="text" text="3월"/>
						<cell align="center" col="20" display="text" text="4월"/>
						<cell align="center" col="21" display="text" text="5월"/>
						<cell align="center" col="22" display="text" text="6월"/>
						<cell align="center" col="23" display="text" text="7월"/>
						<cell align="center" col="24" display="text" text="8월"/>
						<cell align="center" col="25" display="text" text="9월"/>
						<cell align="center" col="26" display="text" text="10월"/>
						<cell align="center" col="27" display="text" text="11월"/>
						<cell align="center" col="28" display="text" text="12월"/>
					</head>
					<body>
						<cell align="center" bkcolor="user25" bkcolor2="user0" col="0" colid="ADOC_NUMB" display="text" limit="13" LimitDec="0"/>
						<cell align="center" bkcolor="user25" bkcolor2="user0" col="1" colid="DIV_NAME" display="text" limit="13" LimitDec="0"/>
						<cell align="right" bkcolor="user25" bkcolor2="user0" col="2" colid="TOT_AMT" display="number" limit="13" LimitDec="0"/>
						<cell align="right" bkcolor="user25" bkcolor2="user0" col="3" colid="AGO_TOT_AMT" display="number" limit="13" LimitDec="0"/>
						<cell align="right" bkcolor="user25" bkcolor2="user0" col="4" colid="YEAR_TOT_AMT" display="number" limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="5" colid="AMT0" display="number" edit="expr:iif(FLAG==&apos;Y&apos;,&apos;number&apos;,&apos;none&apos;)" expr="iif(AMT0&#32;==0,&#32;&apos;&apos;,&#32;AMT0)" limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="6" colid="AMT1" display="number" edit="expr:iif(FLAG==&apos;Y&apos;,&apos;number&apos;,&apos;none&apos;)" expr="iif(AMT1&#32;==0,&#32;&apos;&apos;,&#32;AMT1)" limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="7" colid="AMT2" display="number" edit="expr:iif(FLAG==&apos;Y&apos;,&apos;number&apos;,&apos;none&apos;)" expr="iif(AMT2&#32;==0,&#32;&apos;&apos;,&#32;AMT2)" limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="8" colid="AMT3" display="number" edit="expr:iif(FLAG==&apos;Y&apos;,&apos;number&apos;,&apos;none&apos;)" expr="iif(AMT3&#32;==0,&#32;&apos;&apos;,&#32;AMT3)" limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="9" colid="AMT4" display="number" edit="expr:iif(FLAG==&apos;Y&apos;,&apos;number&apos;,&apos;none&apos;)" expr="iif(AMT4&#32;==0,&#32;&apos;&apos;,&#32;AMT4)" limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="10" colid="AMT5" display="number" edit="expr:iif(FLAG==&apos;Y&apos;,&apos;number&apos;,&apos;none&apos;)" expr="iif(AMT5&#32;==0,&#32;&apos;&apos;,&#32;AMT5)" limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="11" colid="AMT6" display="number" edit="expr:iif(FLAG==&apos;Y&apos;,&apos;number&apos;,&apos;none&apos;)" expr="iif(AMT6&#32;==0,&#32;&apos;&apos;,&#32;AMT6)" limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="12" colid="AMT7" display="number" edit="expr:iif(FLAG==&apos;Y&apos;,&apos;number&apos;,&apos;none&apos;)" expr="iif(AMT7&#32;==0,&#32;&apos;&apos;,&#32;AMT7)" limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="13" colid="AMT8" display="number" edit="expr:iif(FLAG==&apos;Y&apos;,&apos;number&apos;,&apos;none&apos;)" expr="iif(AMT8&#32;==0,&#32;&apos;&apos;,&#32;AMT8)" limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="14" colid="AMT9" display="number" edit="expr:iif(FLAG==&apos;Y&apos;,&apos;number&apos;,&apos;none&apos;)" expr="iif(AMT9&#32;==0,&#32;&apos;&apos;,&#32;AMT9)" limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="15" colid="AMT10" display="number" edit="expr:iif(FLAG==&apos;Y&apos;,&apos;number&apos;,&apos;none&apos;)" expr="iif(AMT10==0,&#32;&apos;&apos;,&#32;AMT10)" limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="16" colid="AMT11" display="number" edit="expr:iif(FLAG==&apos;Y&apos;,&apos;number&apos;,&apos;none&apos;)" expr="iif(AMT11==0,&#32;&apos;&apos;,&#32;AMT11)" limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="17" colid="AMT12" display="number" edit="expr:iif(FLAG==&apos;Y&apos;,&apos;number&apos;,&apos;none&apos;)" expr="iif(AMT12==0,&#32;&apos;&apos;,&#32;AMT12)" limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="18" colid="AMT13" display="number" edit="expr:iif(FLAG==&apos;Y&apos;,&apos;number&apos;,&apos;none&apos;)" expr="iif(AMT13==0,&#32;&apos;&apos;,&#32;AMT13)" limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="19" colid="AMT14" display="number" edit="expr:iif(FLAG==&apos;Y&apos;,&apos;number&apos;,&apos;none&apos;)" expr="iif(AMT14==0,&#32;&apos;&apos;,&#32;AMT14)" limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="20" colid="AMT15" display="number" edit="expr:iif(FLAG==&apos;Y&apos;,&apos;number&apos;,&apos;none&apos;)" expr="iif(AMT15==0,&#32;&apos;&apos;,&#32;AMT15)" limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="21" colid="AMT16" display="number" edit="expr:iif(FLAG==&apos;Y&apos;,&apos;number&apos;,&apos;none&apos;)" expr="iif(AMT16==0,&#32;&apos;&apos;,&#32;AMT16)" limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="22" colid="AMT17" display="number" edit="expr:iif(FLAG==&apos;Y&apos;,&apos;number&apos;,&apos;none&apos;)" expr="iif(AMT17==0,&#32;&apos;&apos;,&#32;AMT17)" limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="23" colid="AMT18" display="number" edit="expr:iif(FLAG==&apos;Y&apos;,&apos;number&apos;,&apos;none&apos;)" expr="iif(AMT18==0,&#32;&apos;&apos;,&#32;AMT18)" limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="24" colid="AMT19" display="number" edit="expr:iif(FLAG==&apos;Y&apos;,&apos;number&apos;,&apos;none&apos;)" expr="iif(AMT19==0,&#32;&apos;&apos;,&#32;AMT19)" limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="25" colid="AMT20" display="number" edit="expr:iif(FLAG==&apos;Y&apos;,&apos;number&apos;,&apos;none&apos;)" expr="iif(AMT20==0,&#32;&apos;&apos;,&#32;AMT20)" limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="26" colid="AMT21" display="number" edit="expr:iif(FLAG==&apos;Y&apos;,&apos;number&apos;,&apos;none&apos;)" expr="iif(AMT21==0,&#32;&apos;&apos;,&#32;AMT21)" limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="27" colid="AMT22" display="number" edit="expr:iif(FLAG==&apos;Y&apos;,&apos;number&apos;,&apos;none&apos;)" expr="iif(AMT22==0,&#32;&apos;&apos;,&#32;AMT22)" limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="28" colid="AMT23" display="number" edit="expr:iif(FLAG==&apos;Y&apos;,&apos;number&apos;,&apos;none&apos;)" expr="iif(AMT23==0,&#32;&apos;&apos;,&#32;AMT23)" limit="13" LimitDec="0"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Div Height="20" Id="Div0" TabOrder="4" Text="Div0" Top="346" Width="978">
			<Contents>
				<Image Height="20" Id="Image2" ImageID="form_bl_title_sub" Left="5" TabOrder="3" Top="-2" Width="11"></Image>
				<Static Color="user6" Font="굴림,9,Bold" Height="20" Id="Static0" Left="18" TabOrder="2" Text="매출/청구/수금&#32;현황" VAlign="Middle" Width="158"></Static>
			</Contents>
		</Div>
		<Static Align="Right" Height="20" Id="st_qtdat_fm" Left="752" Style="sty_lb_search" TabOrder="5" Text="현황시작년월" Top="5" VAlign="Middle" Width="84"></Static>
		<Static Align="Right" Height="20" Id="Static2" Left="538" Style="sty_lb_search" TabOrder="7" Text="프로젝트번호" Top="5" VAlign="Middle" Width="92"></Static>
		<Edit BindDataset="ds_cond" Border="Flat" BorderColor="user1" Column="PSPID" Height="20" Id="ed_pspid" Left="631" MaxLength="14" Style="sty_btn" TabOrder="6" Top="5" UpperOnly="TRUE" Width="99"></Edit>
		<Button Cursor="HAND" Height="18" Id="btn_prj_num" ImageID="btn_icon_search" Left="730" OnClick="btn_prj_num_OnClick" TabOrder="8" Top="6" Transparent="TRUE" Width="18"></Button>
		<Static Align="Right" Height="20" Id="Static11" Left="354" Style="sty_lb_search" TabOrder="10" Text="오더유형" Top="5" VAlign="Middle" Width="64"></Static>
		<Combo BindDataset="ds_cond" Border="Flat" BorderColor="user1" CodeColumn="CODE" Column="ORDR_TYPE" DataColumn="CODE_NAME" Height="20" Id="cb_ordrType" INDEX="0" InnerDataset="ds_combo_a03" Left="417" Style="sty_ipt_search" TabOrder="9" Top="4" Width="116"></Combo>
		<Calendar BindDataset="ds_cond" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="ESCS_MONTH_FROM" Dateformat="yyyy.MM" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="22" Id="ed_escsMonthFrom" Left="836" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_search_ind" SundayTextColor="user35" TabOrder="11" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="4" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="77"></Calendar>
		<Static Align="Right" Height="20" Id="Static12" Left="10" Style="sty_lb_search" TabOrder="13" Text="진행상태&#32;" Top="5" VAlign="Middle" Width="68"></Static>
		<Combo BindDataset="ds_cond" Border="Flat" BorderColor="user1" CodeColumn="CODE" Column="EBDG_MGST" DataColumn="CODE_NAME" Height="20" Id="cb_ebdgMgst" INDEX="0" InnerDataset="ds_combo_a02" Left="77" Style="sty_ipt_form" TabOrder="12" Top="4" Width="109"></Combo>
		<Grid AutoEnter="TRUE" AutoFitEndLine="Hide" BindDataset="ds_pspid_excel" BkColor2="default" BoldHead="true" Border="Flat" Bottom="1080" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="25" Height="160" Id="grid_excel" InputPanel="FALSE" LineColor="user20" LineType="ExHORZ" Right="1528" RowHeight="20" Style="sty_grid" TabOrder="14" TabStop="true" Top="920" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="1528">
			<contents>
				<format id="Default">
					<columns>
						<col width="121"/>
						<col width="97"/>
						<col width="213"/>
						<col width="77"/>
						<col width="75"/>
						<col width="94"/>
						<col width="72"/>
						<col width="66"/>
						<col width="92"/>
						<col width="92"/>
						<col width="74"/>
						<col width="84"/>
						<col width="86"/>
						<col width="86"/>
						<col width="86"/>
						<col width="65"/>
						<col width="65"/>
						<col width="65"/>
						<col width="65"/>
						<col width="65"/>
						<col width="65"/>
						<col width="65"/>
						<col width="65"/>
						<col width="65"/>
						<col width="65"/>
						<col width="65"/>
						<col width="65"/>
						<col width="65"/>
						<col width="65"/>
						<col width="65"/>
						<col width="65"/>
						<col width="65"/>
						<col width="65"/>
						<col width="65"/>
						<col width="65"/>
						<col width="65"/>
						<col width="65"/>
						<col width="65"/>
						<col width="65"/>
					</columns>
					<head>
						<cell col="0" color="user21" display="text" font="굴림,9" text="오더유형"/>
						<cell align="center" col="1" color="user21" display="text" font="굴림,9" text="프로젝트번호" wordwrap="word"/>
						<cell align="center" col="2" color="user21" display="text" font="굴림,9" text="프로젝트명" wordwrap="word"/>
						<cell col="3" color="user21" display="text" font="굴림,9" text="수주일자"/>
						<cell col="4" color="user21" display="text" font="굴림,9" text="납기"/>
						<cell col="5" color="user21" display="text" font="굴림,9" text="수주금액"/>
						<cell col="6" color="user21" display="text" font="굴림,9" text="수주시행율"/>
						<cell col="7" color="user21" display="text" font="굴림,9" text="시행율"/>
						<cell col="8" color="user21" display="text" font="굴림,9" text="수주원가"/>
						<cell col="9" color="user21" display="text" font="굴림,9" text="시행예산금액"/>
						<cell col="10" color="user21" display="text" font="굴림,9" text="지급조건"/>
						<cell align="center" col="11" display="text" text="구분" Valign="Center" wordwrap="word"/>
						<cell align="center" col="12" display="text" text="총합계" Valign="Center" wordwrap="word"/>
						<cell align="center" col="13" display="text" text="이전년월합계" Valign="Center" wordwrap="word"/>
						<cell align="center" col="14" display="text" text="년월합계" Valign="Center" wordwrap="word"/>
						<cell align="center" col="15" display="text" text="1월"/>
						<cell align="center" col="16" display="text" text="2월"/>
						<cell align="center" col="17" display="text" text="3월"/>
						<cell align="center" col="18" display="text" text="4월"/>
						<cell align="center" col="19" display="text" text="5월"/>
						<cell align="center" col="20" display="text" text="6월"/>
						<cell align="center" col="21" display="text" text="7월"/>
						<cell align="center" col="22" display="text" text="8월"/>
						<cell align="center" col="23" display="text" text="9월"/>
						<cell align="center" col="24" display="text" text="10월"/>
						<cell align="center" col="25" display="text" text="11월"/>
						<cell align="center" col="26" display="text" text="12월"/>
						<cell align="center" col="27" display="text" text="1월"/>
						<cell align="center" col="28" display="text" text="2월"/>
						<cell align="center" col="29" display="text" text="3월"/>
						<cell align="center" col="30" display="text" text="4월"/>
						<cell align="center" col="31" display="text" text="5월"/>
						<cell align="center" col="32" display="text" text="6월"/>
						<cell align="center" col="33" display="text" text="7월"/>
						<cell align="center" col="34" display="text" text="8월"/>
						<cell align="center" col="35" display="text" text="9월"/>
						<cell align="center" col="36" display="text" text="10월"/>
						<cell align="center" col="37" display="text" text="11월"/>
						<cell align="center" col="38" display="text" text="12월"/>
					</head>
					<body>
						<cell align="center" col="0" colid="ORDR_TYPE_NAME" display="text"/>
						<cell align="center" bkcolor2="user22" col="1" colid="PSPID" display="text" expandsize="0"/>
						<cell align="left" bkcolor2="user22" col="2" colid="BSTNK" display="text" expandsize="30" limit="765" Valign="Center"/>
						<cell align="center" col="3" colid="BSTDK" display="date" Valign="Center"/>
						<cell align="center" col="4" colid="VDATU" display="date" Valign="Center"/>
						<cell col="5" colid="ESMT_TAMT" display="number" Valign="Center"/>
						<cell align="center" col="6" colid="ESMT_RATE" display="number" Valign="Center"/>
						<cell align="center" col="7" colid="SLCS_RATE" display="text" Valign="Center"/>
						<cell align="right" col="8" colid="SALE_COST" display="number" Valign="Center"/>
						<cell align="right" col="9" colid="EBDG_TAMT" display="number" Valign="Center"/>
						<cell align="center" col="10" colid="ZTERM_NAME" display="text" Valign="Center"/>
						<cell align="center" bkcolor="user25" bkcolor2="user0" col="11" colid="DIV_NAME" display="text" limit="13" LimitDec="0"/>
						<cell align="right" bkcolor="user25" bkcolor2="user0" col="12" colid="TOT_AMT" display="number" limit="13" LimitDec="0"/>
						<cell align="right" bkcolor="user25" bkcolor2="user0" col="13" colid="AGO_TOT_AMT" display="number" limit="13" LimitDec="0"/>
						<cell align="right" bkcolor="user25" bkcolor2="user0" col="14" colid="YEAR_TOT_AMT" display="number" limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="15" colid="AMT0" display="number" edit="expr:iif(FLAG==&apos;Y&apos;,&apos;number&apos;,&apos;none&apos;)" expr="iif(AMT0&#32;==0,&#32;&apos;&apos;,&#32;AMT0)" limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="16" colid="AMT1" display="number" edit="expr:iif(FLAG==&apos;Y&apos;,&apos;number&apos;,&apos;none&apos;)" expr="iif(AMT1&#32;==0,&#32;&apos;&apos;,&#32;AMT1)" limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="17" colid="AMT2" display="number" edit="expr:iif(FLAG==&apos;Y&apos;,&apos;number&apos;,&apos;none&apos;)" expr="iif(AMT2&#32;==0,&#32;&apos;&apos;,&#32;AMT2)" limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="18" colid="AMT3" display="number" edit="expr:iif(FLAG==&apos;Y&apos;,&apos;number&apos;,&apos;none&apos;)" expr="iif(AMT3&#32;==0,&#32;&apos;&apos;,&#32;AMT3)" limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="19" colid="AMT4" display="number" edit="expr:iif(FLAG==&apos;Y&apos;,&apos;number&apos;,&apos;none&apos;)" expr="iif(AMT4&#32;==0,&#32;&apos;&apos;,&#32;AMT4)" limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="20" colid="AMT5" display="number" edit="expr:iif(FLAG==&apos;Y&apos;,&apos;number&apos;,&apos;none&apos;)" expr="iif(AMT5&#32;==0,&#32;&apos;&apos;,&#32;AMT5)" limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="21" colid="AMT6" display="number" edit="expr:iif(FLAG==&apos;Y&apos;,&apos;number&apos;,&apos;none&apos;)" expr="iif(AMT6&#32;==0,&#32;&apos;&apos;,&#32;AMT6)" limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="22" colid="AMT7" display="number" edit="expr:iif(FLAG==&apos;Y&apos;,&apos;number&apos;,&apos;none&apos;)" expr="iif(AMT7&#32;==0,&#32;&apos;&apos;,&#32;AMT7)" limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="23" colid="AMT8" display="number" edit="expr:iif(FLAG==&apos;Y&apos;,&apos;number&apos;,&apos;none&apos;)" expr="iif(AMT8&#32;==0,&#32;&apos;&apos;,&#32;AMT8)" limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="24" colid="AMT9" display="number" edit="expr:iif(FLAG==&apos;Y&apos;,&apos;number&apos;,&apos;none&apos;)" expr="iif(AMT9&#32;==0,&#32;&apos;&apos;,&#32;AMT9)" limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="25" colid="AMT10" display="number" edit="expr:iif(FLAG==&apos;Y&apos;,&apos;number&apos;,&apos;none&apos;)" expr="iif(AMT10==0,&#32;&apos;&apos;,&#32;AMT10)" limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="26" colid="AMT11" display="number" edit="expr:iif(FLAG==&apos;Y&apos;,&apos;number&apos;,&apos;none&apos;)" expr="iif(AMT11==0,&#32;&apos;&apos;,&#32;AMT11)" limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="27" colid="AMT12" display="number" edit="expr:iif(FLAG==&apos;Y&apos;,&apos;number&apos;,&apos;none&apos;)" expr="iif(AMT12==0,&#32;&apos;&apos;,&#32;AMT12)" limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="28" colid="AMT13" display="number" edit="expr:iif(FLAG==&apos;Y&apos;,&apos;number&apos;,&apos;none&apos;)" expr="iif(AMT13==0,&#32;&apos;&apos;,&#32;AMT13)" limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="29" colid="AMT14" display="number" edit="expr:iif(FLAG==&apos;Y&apos;,&apos;number&apos;,&apos;none&apos;)" expr="iif(AMT14==0,&#32;&apos;&apos;,&#32;AMT14)" limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="30" colid="AMT15" display="number" edit="expr:iif(FLAG==&apos;Y&apos;,&apos;number&apos;,&apos;none&apos;)" expr="iif(AMT15==0,&#32;&apos;&apos;,&#32;AMT15)" limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="31" colid="AMT16" display="number" edit="expr:iif(FLAG==&apos;Y&apos;,&apos;number&apos;,&apos;none&apos;)" expr="iif(AMT16==0,&#32;&apos;&apos;,&#32;AMT16)" limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="32" colid="AMT17" display="number" edit="expr:iif(FLAG==&apos;Y&apos;,&apos;number&apos;,&apos;none&apos;)" expr="iif(AMT17==0,&#32;&apos;&apos;,&#32;AMT17)" limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="33" colid="AMT18" display="number" edit="expr:iif(FLAG==&apos;Y&apos;,&apos;number&apos;,&apos;none&apos;)" expr="iif(AMT18==0,&#32;&apos;&apos;,&#32;AMT18)" limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="34" colid="AMT19" display="number" edit="expr:iif(FLAG==&apos;Y&apos;,&apos;number&apos;,&apos;none&apos;)" expr="iif(AMT19==0,&#32;&apos;&apos;,&#32;AMT19)" limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="35" colid="AMT20" display="number" edit="expr:iif(FLAG==&apos;Y&apos;,&apos;number&apos;,&apos;none&apos;)" expr="iif(AMT20==0,&#32;&apos;&apos;,&#32;AMT20)" limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="36" colid="AMT21" display="number" edit="expr:iif(FLAG==&apos;Y&apos;,&apos;number&apos;,&apos;none&apos;)" expr="iif(AMT21==0,&#32;&apos;&apos;,&#32;AMT21)" limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="37" colid="AMT22" display="number" edit="expr:iif(FLAG==&apos;Y&apos;,&apos;number&apos;,&apos;none&apos;)" expr="iif(AMT22==0,&#32;&apos;&apos;,&#32;AMT22)" limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="38" colid="AMT23" display="number" edit="expr:iif(FLAG==&apos;Y&apos;,&apos;number&apos;,&apos;none&apos;)" expr="iif(AMT23==0,&#32;&apos;&apos;,&#32;AMT23)" limit="13" LimitDec="0"/>
					</body>
					<summary>
						<cell align="center" bkcolor="user25" col="0" color="user26" colspan="5" display="text" text="합계"/>
						<cell align="right" bkcolor="user25" col="5" color="user26" display="number" expr='ds_pspid_excel.Sum(&quot;ESMT_TAMT&quot;)' text="ㅁㅁㅁ"/>
						<cell align="center" bkcolor="user25" col="6" color="user26" display="text" expr='round(ds_pspid_excel.Sum(&quot;SALE_COST&quot;)/ds_pspid_excel.Sum(&quot;ESMT_TAMT&quot;)*100,2)'/>
						<cell align="center" bkcolor="user25" col="7" color="user26" display="text" expr='round(ds_pspid_excel.Sum(&quot;EBDG_TAMT&quot;)/ds_pspid_excel.Sum(&quot;ESMT_TAMT&quot;)*100,2)'/>
						<cell align="right" bkcolor="user25" col="8" color="user26" display="number" expr='ds_pspid_excel.Sum(&quot;SALE_COST&quot;)'/>
						<cell align="right" bkcolor="user25" col="9" color="user26" display="number" expr='ds_pspid_excel.Sum(&quot;EBDG_TAMT&quot;)'/>
						<cell bkcolor="user25" col="10" color="user26" display="text"/>
					</summary>
				</format>
			</contents>
		</Grid>
		<Static Align="Right" Height="20" Id="Static0" Left="189" Style="sty_lb_search" TabOrder="15" Text="수주년월" Top="5" VAlign="Middle" Width="84"></Static>
		<Calendar BindDataset="ds_cond" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="BSTDK" Dateformat="yyyy.MM" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="22" Id="ca_bstdk" Left="273" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_search_ind" SundayTextColor="user35" TabOrder="16" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="4" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="77"></Calendar>
	</Form>
	<Script><![CDATA[/*
 ******************************************************************************************
 * 기      능   : 프로젝트 이동계획 조회
 * 작  성  자   : 박수근
 * 작성  일자   : 2017.04.28
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
#include "LIB::commons.js";           // 공통 스크립트
#include "LIB::fs_common.js";         // 물류서비스 공통 스크립트

//=========================================================================================
// [ PART 1 ]
// Form에서 사용될 전역변수를 선언
// FORM에서 사용되는 전역변수는 대문자로 작성하며, F_XXX 의 형태를 갖도록 한다.
//=========================================================================================
var g_isChang = false;

//=========================================================================================
// [ PART 2 ]
// Form Loading / Unloading 시 작업 정의
//=========================================================================================
function fn_OnLoadCompleted(obj) {
    gfn_initForm(true);             // Form 로드 이벤트 맨 첫줄에 기술
    fn_init_form();             // 폼 초기화
}

/********************************************************************************
* 기      능   : form UnloadCompleted
********************************************************************************/
function fn_OnUnloadCompleted(obj) {
    return gfn_isFormUnload(obj);
}

/********************************************************************************
* 기      능   : 폼 초기화
********************************************************************************/
function fn_init_form() {
    // 공용코드 데이터 코드 타입: CODE_GROP:DATASETID -> A02:ds_combo_a02, A03:ds_combo_a03
    var codeArray = ["A02:ds_combo_a02::EXTN2='OB%'","A03:ds_combo_a03"];
    // 공용코드 콤보 데이터 셑을 가져온다.
    gn_fsComboDataSet(codeArray);

    // 현재년도
    var year = left( gfn_getCurrDate(), 4 );
    
    // 현재일
    var curDay = gfn_getCurrDate();
    
    ed_escsMonthFrom.Value = year+"0101";

    fn_query();
}

/********************************************************************************
* 기      능   : 월별청구수금계획 조회
********************************************************************************/
function fn_query() {
    // 검색조건 체크
    if( ed_escsMonthFrom.Value == "" ) {
        gfn_openMsgWin("현황 시작년월을 입력하세요.", "", "A", "");
    }

    var startYearMonth = substr( ed_escsMonthFrom.Value, 0, 6 );
    var rowIndex = 0;
    ds_month.ClearData();
    ds_month.fireevent = false;
    for(var i=0; i < 24; i++) {
        var month = gfn_getAfterMonth(startYearMonth, i);
        var nRow = ds_month.AppendRow();
        ds_month.SetColumn(nRow, "MONTH", month);
        ds_month.SetColumn(nRow, "ROW_INDEX", i);
        ds_month.SetColumn(nRow, "COL_ID", "AMT"+i);
        grd_amt.SetCellProp("head", (i+5), "text", substr(month, 0,4)+"."+substr(month, 4)+"월");
    }
    ds_month.fireevent = true;

    // 그리드 초기화
    gfn_clearGridSortMark(grd_plan);
    
    // 계획 데이터 초기화
    ds_plan_data.ClearData();

    // 조회 스크립트
    tit_clearActionInfo();
    tit_addSearchActionInfo("fs05:FS0502001A_S1");
    tit_callService(
                    ""
                   ,""
                   ,"ds_cond=ds_cond"
                   ,"ds_pspid_list=ds_pspid_list"
                   ,""
                   ,"fn_afterQuery"
                   ,"true"
                   ,"true"
                   ,"false"
                   );
}

/********************************************************************************
* 기      능   : 월별청구수금계획 조회 Callback
********************************************************************************/
function fn_afterQuery(errCode, errMsg) {
    if(errCode != "0") {
        gfn_showMsg("CE00001");
    } else {
        gfn_showMsg("CI00002", ds_pspid_list.rowCount() + "");
        // 프로젝트 검색조건 전달하여 매출, 청수, 수금, 실적 및 계획 정보를 조회한다.
        fn_queryDetail();
    }
}

/********************************************************************************
* 기      능   : 월별청구수금계획 세부 자료 조회
********************************************************************************/
function fn_queryDetail() 
{
    var adocNumb = ds_pspid_list.GetColumn(ds_pspid_list.currow, "ADOC_NUMB");
    var div = ds_pspid_list.GetColumn(ds_pspid_list.currow, "DIV");
    var exeFlag = ds_pspid_list.GetColumn(ds_pspid_list.currow, "EXE_FLAG");
    var pspid = ds_pspid_list.GetColumn(ds_pspid_list.currow, "PSPID");

    if( exeFlag != "Y" ) {
		ds_pspid_pk.ClearData();
		var nRow = ds_pspid_pk.AppendRow();
		ds_pspid_pk.SetColumn(nRow, "PSPID", pspid);
		ds_pspid_pk.SetColumn(nRow, "ADOC_NUMB", adocNumb);
		ds_pspid_list.SetColumn(ds_pspid_list.currow, "EXE_FLAG", "Y");

		// 조회 스크립트
		tit_clearActionInfo();
		// 월별실적
		tit_addSearchActionInfo("fs05:FS0502001A_S2");
		// 매출실적
		tit_addSearchActionInfo("fs05:FS0502001A_S3");
		// 청구실적
		tit_addSearchActionInfo("fs05:FS0502001A_S4");
		// 수금실적
		tit_addSearchActionInfo("fs05:FS0502001A_S5");
		tit_callService(
						""
					   ,""
					   ,"ds_cond=ds_cond ds_pspid_pk=ds_pspid_pk"
					   ,"ds_zfst0500_list=ds_zfst0500_list ds_amt01=ds_amt01 ds_amt02=ds_amt02 ds_amt03=ds_amt03"
					   ,""
					   ,"fn_afterQueryDetail"
					   ,"true"
					   ,"true"
					   ,"false"
					   );
    } else {
        ds_plan_fdata.RecalcFilter();
    }
}

/********************************************************************************
* 기      능   : 월별청구수금계획 조회 Callback
********************************************************************************/
function fn_afterQueryDetail(errCode, errMsg) {
    if(errCode != "0") {
        gfn_showMsg("CE00001");
    } else {
        ds_plan_data.fireevent = false;
        // 기본 월 데이터 구조를 생성한다.
        // 1-1 매출, 1-2: 매출계획, 1-3: 매출 합계
        // 2-1 청구, 2-2: 청구계획, 2-3: 청구 합계
        // 3-1 수금, 3-2: 수금계획, 3-3: 수금 합계
        // DIV, DIV_NAME, ADOC_CLAS, ADOC_NUMB 변수기준[00~ 23}
        var adocClas = ds_pspid_list.GetColumn(ds_pspid_list.currow, "ADOC_CLAS");
        var adocNumb = ds_pspid_list.GetColumn(ds_pspid_list.currow, "ADOC_NUMB");

        var nRow = ds_plan_data.AppendRow();
        ds_plan_data.SetColumn(nRow, "DIV", "1-1");
        ds_plan_data.SetColumn(nRow, "DIV_NAME", "매출");
        ds_plan_data.SetColumn(nRow, "ADOC_CLAS", adocClas);
        ds_plan_data.SetColumn(nRow, "ADOC_NUMB", adocNumb);
        ds_plan_data.SetColumn(nRow, "TOT_AMT", 0);
        ds_plan_data.SetColumn(nRow, "AGO_TOT_AMT", 0);
        ds_plan_data.SetColumn(nRow, "YEAR_TOT_AMT", 0);
        
        nRow = ds_plan_data.AppendRow();
        ds_plan_data.SetColumn(nRow, "DIV", "1-2");
        ds_plan_data.SetColumn(nRow, "DIV_NAME", "매출계획");
        ds_plan_data.SetColumn(nRow, "ADOC_CLAS", adocClas);
        ds_plan_data.SetColumn(nRow, "ADOC_NUMB", adocNumb);
        ds_plan_data.SetColumn(nRow, "TOT_AMT", 0);
        ds_plan_data.SetColumn(nRow, "AGO_TOT_AMT", 0);
        ds_plan_data.SetColumn(nRow, "YEAR_TOT_AMT", 0);
        ds_plan_data.SetColumn(nRow, "FLAG", "Y");
        
        nRow = ds_plan_data.AppendRow();
        ds_plan_data.SetColumn(nRow, "DIV", "2-1");
        ds_plan_data.SetColumn(nRow, "DIV_NAME", "청구");
        ds_plan_data.SetColumn(nRow, "ADOC_CLAS", adocClas);
        ds_plan_data.SetColumn(nRow, "ADOC_NUMB", adocNumb);
        ds_plan_data.SetColumn(nRow, "TOT_AMT", 0);
        ds_plan_data.SetColumn(nRow, "AGO_TOT_AMT", 0);
        ds_plan_data.SetColumn(nRow, "YEAR_TOT_AMT", 0);

        nRow = ds_plan_data.AppendRow();
        ds_plan_data.SetColumn(nRow, "DIV", "2-2");
        ds_plan_data.SetColumn(nRow, "DIV_NAME", "청구계획");
        ds_plan_data.SetColumn(nRow, "ADOC_CLAS", adocClas);
        ds_plan_data.SetColumn(nRow, "ADOC_NUMB", adocNumb);
        ds_plan_data.SetColumn(nRow, "TOT_AMT", 0);
        ds_plan_data.SetColumn(nRow, "AGO_TOT_AMT", 0);
        ds_plan_data.SetColumn(nRow, "YEAR_TOT_AMT", 0);
        ds_plan_data.SetColumn(nRow, "FLAG", "Y");

        nRow = ds_plan_data.AppendRow();
        ds_plan_data.SetColumn(nRow, "DIV", "3-1");
        ds_plan_data.SetColumn(nRow, "DIV_NAME", "수금");
        ds_plan_data.SetColumn(nRow, "ADOC_CLAS", adocClas);
        ds_plan_data.SetColumn(nRow, "ADOC_NUMB", adocNumb);
        ds_plan_data.SetColumn(nRow, "TOT_AMT", 0);
        ds_plan_data.SetColumn(nRow, "AGO_TOT_AMT", 0);
        ds_plan_data.SetColumn(nRow, "YEAR_TOT_AMT", 0);

        nRow = ds_plan_data.AppendRow();
        ds_plan_data.SetColumn(nRow, "DIV", "3-2");
        ds_plan_data.SetColumn(nRow, "DIV_NAME", "수금계획");
        ds_plan_data.SetColumn(nRow, "ADOC_CLAS", adocClas);
        ds_plan_data.SetColumn(nRow, "ADOC_NUMB", adocNumb);
        ds_plan_data.SetColumn(nRow, "TOT_AMT", 0);
        ds_plan_data.SetColumn(nRow, "AGO_TOT_AMT", 0);
        ds_plan_data.SetColumn(nRow, "YEAR_TOT_AMT", 0);
        ds_plan_data.SetColumn(nRow, "FLAG", "Y");

        ds_plan_data.fireevent = true;
        ds_plan_fdata.RecalcFilter();
        
        ds_plan_data.fireevent = false;
        for(var i=0; i < ds_zfst0500_list.GetRowCount(); i++) {
            var fcolRow = ds_month.FindRow("MONTH", ds_zfst0500_list.GetColumn(i, "ZMONTH"));
            if( fcolRow > -1 ) {
                // 수주년 기준 데이터 존재 시
				var colId = ds_month.GetColumn(fcolRow, "COL_ID");
				var orgColId = "ORG_"+colId;
				var fRow = ds_plan_fdata.FindRow("DIV", "1-2");
				var nfRow = ds_plan_fdata.GetRowIndexNF(fRow);
				// 매출 계획 데이터
				ds_plan_data.SetColumn(nfRow, colId, ds_zfst0500_list.GetColumn(i, "SALE_AMT"));
				ds_plan_data.SetColumn(nfRow, orgColId, ds_zfst0500_list.GetColumn(i, "SALE_AMT"));
				// 수주년도합계 수행 처리
				ds_plan_data.SetColumn(nfRow, "YEAR_TOT_AMT", toNumber(ds_plan_data.GetColumn(nfRow, "YEAR_TOT_AMT"))+toNumber(ds_zfst0500_list.GetColumn(i, "SALE_AMT")));
				// 총합계 합산 처리 수행
				ds_plan_data.SetColumn(nfRow, "TOT_AMT", toNumber(ds_plan_data.GetColumn(nfRow, "TOT_AMT"))+toNumber(ds_zfst0500_list.GetColumn(i, "SALE_AMT")));
				
				// 청구계획 데이터 입력
				fRow = ds_plan_fdata.FindRow("DIV", "2-2");
				nfRow = ds_plan_fdata.GetRowIndexNF(fRow);
				ds_plan_data.SetColumn(nfRow, colId, ds_zfst0500_list.GetColumn(i, "BAMT"));
				ds_plan_data.SetColumn(nfRow, orgColId, ds_zfst0500_list.GetColumn(i, "BAMT"));
				// 수주년도합계 수행 처리
				ds_plan_data.SetColumn(nfRow, "YEAR_TOT_AMT", toNumber(ds_plan_data.GetColumn(nfRow, "YEAR_TOT_AMT"))+toNumber(ds_zfst0500_list.GetColumn(i, "BAMT")));
				// 총합계 합산 처리 수행
				ds_plan_data.SetColumn(nfRow, "TOT_AMT", toNumber(ds_plan_data.GetColumn(nfRow, "TOT_AMT"))+toNumber(ds_zfst0500_list.GetColumn(i, "BAMT")));
				
				// 수금계획 데이터 입력
				fRow = ds_plan_fdata.FindRow("DIV", "3-2");
				nfRow = ds_plan_fdata.GetRowIndexNF(fRow);
				ds_plan_data.SetColumn(nfRow, colId, ds_zfst0500_list.GetColumn(i, "CAMT"));
			    ds_plan_data.SetColumn(nfRow, orgColId, ds_zfst0500_list.GetColumn(i, "CAMT"));

				// 수주년도합계 수행 처리
				ds_plan_data.SetColumn(nfRow, "YEAR_TOT_AMT", toNumber(ds_plan_data.GetColumn(nfRow, "YEAR_TOT_AMT"))+toNumber(ds_zfst0500_list.GetColumn(i, "CAMT")));
				// 총합계 합산 처리 수행
				ds_plan_data.SetColumn(nfRow, "TOT_AMT", toNumber(ds_plan_data.GetColumn(nfRow, "TOT_AMT"))+toNumber(ds_zfst0500_list.GetColumn(i, "CAMT")));
            } else {
                // 검색조건 이전 데이터 존재 시
				var fRow = ds_plan_fdata.FindRow("DIV", "1-2");
				var nfRow = ds_plan_fdata.GetRowIndexNF(fRow);
				// 매출 계획 데이터 이전년도 합계처리
				ds_plan_data.SetColumn(nfRow, "AGO_TOT_AMT", toNumber(ds_plan_data.GetColumn(nfRow, "AGO_TOT_AMT"))+toNumber(ds_zfst0500_list.GetColumn(i, "SALE_AMT")));
				// 총합계 합산 처리 수행
				ds_plan_data.SetColumn(nfRow, "TOT_AMT", toNumber(ds_plan_data.GetColumn(nfRow, "TOT_AMT"))+toNumber(ds_zfst0500_list.GetColumn(i, "SALE_AMT")));
				
				// 청구계획 데이터 입력
				fRow = ds_plan_fdata.FindRow("DIV", "2-2");
				nfRow = ds_plan_fdata.GetRowIndexNF(fRow);
				ds_plan_data.SetColumn(nfRow, "AGO_TOT_AMT", toNumber(ds_plan_data.GetColumn(nfRow, "AGO_TOT_AMT"))+toNumber(ds_zfst0500_list.GetColumn(i, "BAMT")));
				// 총합계 합산 처리 수행
				ds_plan_data.SetColumn(nfRow, "TOT_AMT", toNumber(ds_plan_data.GetColumn(nfRow, "TOT_AMT"))+toNumber(ds_zfst0500_list.GetColumn(i, "BAMT")));

				// 수금계획 데이터 입력
				fRow = ds_plan_fdata.FindRow("DIV", "3-2");
				nfRow = ds_plan_fdata.GetRowIndexNF(fRow);
				ds_plan_data.SetColumn(nfRow, "AGO_TOT_AMT", toNumber(ds_plan_data.GetColumn(nfRow, "AGO_TOT_AMT"))+toNumber(ds_zfst0500_list.GetColumn(i, "CAMT")));
				// 총합계 합산 처리 수행
				ds_plan_data.SetColumn(nfRow, "TOT_AMT", toNumber(ds_plan_data.GetColumn(nfRow, "TOT_AMT"))+toNumber(ds_zfst0500_list.GetColumn(i, "CAMT")));
            }
        }

        // 매출 데이터 입력
        for(var i=0; i < ds_amt01.GetRowCount(); i++) {
            var fcolRow = ds_month.FindRow("MONTH", ds_amt01.GetColumn(i, "MONTH"));
            if( fcolRow > -1 ) {
                // 수주년 기준 데이터 존재 시
				var colId = ds_month.GetColumn(fcolRow, "COL_ID");
				var orgColId = "ORG_"+colId;
				var fRow = ds_plan_fdata.FindRow("DIV", "1-1");
				var nfRow = ds_plan_fdata.GetRowIndexNF(fRow);
				// 매출 계획 데이터
				ds_plan_data.SetColumn(nfRow, colId, ds_amt01.GetColumn(i, "AMT"));
				ds_plan_data.SetColumn(nfRow, orgColId, ds_amt01.GetColumn(i, "AMT"));
				// 수주년도합계 수행 처리
				ds_plan_data.SetColumn(nfRow, "YEAR_TOT_AMT", toNumber(ds_plan_data.GetColumn(nfRow, "YEAR_TOT_AMT"))+toNumber(ds_amt01.GetColumn(i, "AMT")));
				// 총합계 합산 처리 수행
				ds_plan_data.SetColumn(nfRow, "TOT_AMT", toNumber(ds_plan_data.GetColumn(nfRow, "TOT_AMT"))+toNumber(ds_amt01.GetColumn(i, "AMT")));
				
            } else {
                // 검색조건 이전 데이터 존재 시
				var fRow = ds_plan_fdata.FindRow("DIV", "1-1");
				var nfRow = ds_plan_fdata.GetRowIndexNF(fRow);
				// 매출 계획 데이터 이전년도 합계처리
				ds_plan_data.SetColumn(nfRow, "AGO_TOT_AMT", toNumber(ds_plan_data.GetColumn(nfRow, "AGO_TOT_AMT"))+toNumber(ds_amt01.GetColumn(i, "AMT")));
				// 총합계 합산 처리 수행
				ds_plan_data.SetColumn(nfRow, "TOT_AMT", toNumber(ds_plan_data.GetColumn(nfRow, "TOT_AMT"))+toNumber(ds_amt01.GetColumn(i, "AMT")));
            }
        }

        // 청구 데이터 입력
        for(var i=0; i < ds_amt02.GetRowCount(); i++) {
            var fcolRow = ds_month.FindRow("MONTH", ds_amt02.GetColumn(i, "MONTH"));
            if( fcolRow > -1 ) {
                // 수주년 기준 데이터 존재 시
				var colId = ds_month.GetColumn(fcolRow, "COL_ID");
				var orgColId = "ORG_"+colId;
				var fRow = ds_plan_fdata.FindRow("DIV", "2-1");
				var nfRow = ds_plan_fdata.GetRowIndexNF(fRow);
				// 매출 계획 데이터
				ds_plan_data.SetColumn(nfRow, colId, ds_amt02.GetColumn(i, "AMT"));
				ds_plan_data.SetColumn(nfRow, orgColId, ds_amt02.GetColumn(i, "AMT"));
				// 수주년도합계 수행 처리
				ds_plan_data.SetColumn(nfRow, "YEAR_TOT_AMT", toNumber(ds_plan_data.GetColumn(nfRow, "YEAR_TOT_AMT"))+toNumber(ds_amt02.GetColumn(i, "AMT")));
				// 총합계 합산 처리 수행
				ds_plan_data.SetColumn(nfRow, "TOT_AMT", toNumber(ds_plan_data.GetColumn(nfRow, "TOT_AMT"))+toNumber(ds_amt02.GetColumn(i, "AMT")));
				
            } else {
                // 검색조건 이전 데이터 존재 시
				var fRow = ds_plan_fdata.FindRow("DIV", "2-1");
				var nfRow = ds_plan_fdata.GetRowIndexNF(fRow);
				// 매출 계획 데이터 이전년도 합계처리
				ds_plan_data.SetColumn(nfRow, "AGO_TOT_AMT", toNumber(ds_plan_data.GetColumn(nfRow, "AGO_TOT_AMT"))+toNumber(ds_amt02.GetColumn(i, "AMT")));
				// 총합계 합산 처리 수행
				ds_plan_data.SetColumn(nfRow, "TOT_AMT", toNumber(ds_plan_data.GetColumn(nfRow, "TOT_AMT"))+toNumber(ds_amt02.GetColumn(i, "AMT")));
            }
        }
        
        // 수금 데이터 입력
        for(var i=0; i < ds_amt03.GetRowCount(); i++) {
            var fcolRow = ds_month.FindRow("MONTH", ds_amt03.GetColumn(i, "MONTH"));
            if( fcolRow > -1 ) {
                // 수주년 기준 데이터 존재 시
				var colId = ds_month.GetColumn(fcolRow, "COL_ID");
				var orgColId = "ORG_"+colId;
				var fRow = ds_plan_fdata.FindRow("DIV", "3-1");
				var nfRow = ds_plan_fdata.GetRowIndexNF(fRow);
				// 매출 계획 데이터
				ds_plan_data.SetColumn(nfRow, colId, ds_amt03.GetColumn(i, "AMT"));
				ds_plan_data.SetColumn(nfRow, orgColId, ds_amt03.GetColumn(i, "AMT"));
				// 수주년도합계 수행 처리
				ds_plan_data.SetColumn(nfRow, "YEAR_TOT_AMT", toNumber(ds_plan_data.GetColumn(nfRow, "YEAR_TOT_AMT"))+toNumber(ds_amt03.GetColumn(i, "AMT")));
				// 총합계 합산 처리 수행
				ds_plan_data.SetColumn(nfRow, "TOT_AMT", toNumber(ds_plan_data.GetColumn(nfRow, "TOT_AMT"))+toNumber(ds_amt03.GetColumn(i, "AMT")));
				
            } else {
                // 검색조건 이전 데이터 존재 시
				var fRow = ds_plan_fdata.FindRow("DIV", "3-1");
				var nfRow = ds_plan_fdata.GetRowIndexNF(fRow);
				// 매출 계획 데이터 이전년도 합계처리
				ds_plan_data.SetColumn(nfRow, "AGO_TOT_AMT", toNumber(ds_plan_data.GetColumn(nfRow, "AGO_TOT_AMT"))+toNumber(ds_amt03.GetColumn(i, "AMT")));
				// 총합계 합산 처리 수행
				ds_plan_data.SetColumn(nfRow, "TOT_AMT", toNumber(ds_plan_data.GetColumn(nfRow, "TOT_AMT"))+toNumber(ds_amt03.GetColumn(i, "AMT")));
            }
        }

        ds_plan_data.fireevent = true;
    }
}

/********************************************************************************
* 기      능   : 프로젝트 이동계획 엑셀 다운로드
********************************************************************************/
function fn_excel() {
    if( ds_pspid_list.GetRowCount() == 0 ) {
        gfn_openMsgWin("엑셀 다운로드할 프로젝트 정보가 없습니다.", "", "A", "");
        return;
    }
    
    ds_pspid_excel.ClearData();
    // 프로젝트 검색 조건 생성
	ds_pspid_pk.ClearData();
	ds_pspid_pk.fireevent = false;
	for(var i=0; i <  ds_pspid_list.GetRowCount(); i++) {
		var nRow = ds_pspid_pk.AppendRow();
		ds_pspid_pk.SetColumn(nRow, "PSPID", ds_pspid_list.GetColumn(i, "PSPID"));
		ds_pspid_pk.SetColumn(nRow, "ADOC_NUMB", ds_pspid_list.GetColumn(i, "ADOC_NUMB"));
	}
	ds_pspid_pk.fireevent = true;

	// 조회 스크립트
	tit_clearActionInfo();
	// 월별실적
	tit_addSearchActionInfo("fs05:FS0502001A_S2");
	// 매출실적
	tit_addSearchActionInfo("fs05:FS0502001A_S3");
	// 청구실적
	tit_addSearchActionInfo("fs05:FS0502001A_S4");
	// 수금실적
	tit_addSearchActionInfo("fs05:FS0502001A_S5");
	tit_callService(
					""
				   ,""
				   ,"ds_cond=ds_cond ds_pspid_pk=ds_pspid_pk"
				   ,"ds_zfst0500_list=ds_zfst0500_list ds_amt01=ds_amt01 ds_amt02=ds_amt02 ds_amt03=ds_amt03"
				   ,""
				   ,"fn_afterQueryExcel"
				   ,"true"
				   ,"true"
				   ,"false"
				   );
}

/********************************************************************************
* 기      능   : 월별청구수금계획 조회 Callback
********************************************************************************/
function fn_afterQueryExcel(errCode, errMsg) {
    if(errCode != "0") {
        gfn_showMsg("CE00001");
    } else {
		var startYearMonth = substr( ed_escsMonthFrom.Value, 0, 6 );
		var rowIndex = 0;
		var starIndex = 15;
		// 그리드 헤더 생성
		for(var i=0; i < ds_month.GetRowCount(); i++) {
			var month = ds_month.GetColumn(i, "MONTH");
			grid_excel.SetCellProp("head", (starIndex+i), "text", substr(month, 0,4)+"."+substr(month, 4)+"월");
		}
        
        ds_pspid_excel.fireevent = false;
        for(var i=0; i <  ds_pspid_list.GetRowCount(); i++) {
            var nRow = ds_pspid_excel.AppendRow();
            ds_pspid_excel.CopyRow(nRow, "ds_pspid_list", i);
            ds_pspid_excel.SetColumn(nRow, "DIV_NAME", "매출");
            nRow = ds_pspid_excel.AppendRow();
            ds_pspid_excel.SetColumn(nRow, "DIV_NAME", "매출계획");
            nRow = ds_pspid_excel.AppendRow();
            ds_pspid_excel.SetColumn(nRow, "DIV_NAME", "청구");
            nRow = ds_pspid_excel.AppendRow();
            ds_pspid_excel.SetColumn(nRow, "DIV_NAME", "청구계획");
            nRow = ds_pspid_excel.AppendRow();
            ds_pspid_excel.SetColumn(nRow, "DIV_NAME", "수금");
            nRow = ds_pspid_excel.AppendRow();
            ds_pspid_excel.SetColumn(nRow, "DIV_NAME", "수금계획");
            
	    }
        ds_pspid_excel.fireevent = true;
        
        // 계획치 입력
        ds_pspid_excel.fireevent = false;
        for(var i=0; i < ds_zfst0500_list.GetRowCount(); i++) {
            var rowIndex = ds_pspid_excel.FindRow("ADOC_NUMB", ds_zfst0500_list.GetColumn(i, "ADOC_NUMB"));
            var fcolRow = ds_month.FindRow("MONTH", ds_zfst0500_list.GetColumn(i, "ZMONTH"));
            if( fcolRow > -1 ) {
                // 수주년 기준 데이터 존재 시
				var colId = ds_month.GetColumn(fcolRow, "COL_ID");
				// 매출 계획 데이터
				ds_pspid_excel.SetColumn(rowIndex+1, colId, ds_zfst0500_list.GetColumn(i, "SALE_AMT"));

				// 수주년도합계 수행 처리
				ds_pspid_excel.SetColumn(rowIndex+1, "YEAR_TOT_AMT", toNumber(ds_pspid_excel.GetColumn(rowIndex+1, "YEAR_TOT_AMT"))+toNumber(ds_zfst0500_list.GetColumn(i, "SALE_AMT")));
				// 총합계 합산 처리 수행
				ds_pspid_excel.SetColumn(rowIndex+1, "TOT_AMT", toNumber(ds_pspid_excel.GetColumn(rowIndex+1, "TOT_AMT"))+toNumber(ds_zfst0500_list.GetColumn(i, "SALE_AMT")));
				
				
				// 청구계획 데이터 입력
				ds_pspid_excel.SetColumn(rowIndex+3, colId, ds_zfst0500_list.GetColumn(i, "BAMT"));
				// 수주년도합계 수행 처리
				ds_pspid_excel.SetColumn(rowIndex+3, "YEAR_TOT_AMT", toNumber(ds_pspid_excel.GetColumn(rowIndex+3, "YEAR_TOT_AMT"))+toNumber(ds_zfst0500_list.GetColumn(i, "BAMT")));
				// 총합계 합산 처리 수행
				ds_pspid_excel.SetColumn(rowIndex+3, "TOT_AMT", toNumber(ds_pspid_excel.GetColumn(rowIndex+3, "TOT_AMT"))+toNumber(ds_zfst0500_list.GetColumn(i, "BAMT")));
				
				// 수금계획 데이터 입력
				ds_pspid_excel.SetColumn(rowIndex+5, colId, ds_zfst0500_list.GetColumn(i, "CAMT"));

				// 수주년도합계 수행 처리
				ds_pspid_excel.SetColumn(rowIndex+5, "YEAR_TOT_AMT", toNumber(ds_pspid_excel.GetColumn(rowIndex+5, "YEAR_TOT_AMT"))+toNumber(ds_zfst0500_list.GetColumn(i, "CAMT")));
				// 총합계 합산 처리 수행
				ds_pspid_excel.SetColumn(rowIndex+5, "TOT_AMT", toNumber(ds_pspid_excel.GetColumn(rowIndex+5, "TOT_AMT"))+toNumber(ds_zfst0500_list.GetColumn(i, "CAMT")));
            } else {
                // 검색조건 이전 데이터 존재 시
				// 매출 계획 데이터 이전년도 합계처리
				ds_pspid_excel.SetColumn(rowIndex+1, "AGO_TOT_AMT", toNumber(ds_pspid_excel.GetColumn(rowIndex+1, "AGO_TOT_AMT"))+toNumber(ds_zfst0500_list.GetColumn(i, "SALE_AMT")));
				// 총합계 합산 처리 수행
				ds_pspid_excel.SetColumn(rowIndex+1, "TOT_AMT", toNumber(ds_pspid_excel.GetColumn(rowIndex+1, "TOT_AMT"))+toNumber(ds_zfst0500_list.GetColumn(i, "SALE_AMT")));
				
				// 청구계획 데이터 입력
				ds_pspid_excel.SetColumn(rowIndex+3, "AGO_TOT_AMT", toNumber(ds_pspid_excel.GetColumn(rowIndex+3, "AGO_TOT_AMT"))+toNumber(ds_zfst0500_list.GetColumn(i, "BAMT")));
				// 총합계 합산 처리 수행
				ds_pspid_excel.SetColumn(rowIndex+3, "TOT_AMT", toNumber(ds_pspid_excel.GetColumn(rowIndex+3, "TOT_AMT"))+toNumber(ds_zfst0500_list.GetColumn(i, "BAMT")));

				// 수금계획 데이터 입력
				ds_pspid_excel.SetColumn(rowIndex+5, "AGO_TOT_AMT", toNumber(ds_pspid_excel.GetColumn(rowIndex+5, "AGO_TOT_AMT"))+toNumber(ds_zfst0500_list.GetColumn(i, "CAMT")));
				// 총합계 합산 처리 수행
				ds_pspid_excel.SetColumn(rowIndex+5, "TOT_AMT", toNumber(ds_pspid_excel.GetColumn(rowIndex+5, "TOT_AMT"))+toNumber(ds_zfst0500_list.GetColumn(i, "CAMT")));
            }
        }
                
        // 매출실적
        for(var i=0; i < ds_amt01.GetRowCount(); i++) {
            var rowIndex = ds_pspid_excel.FindRow("PSPID", ds_amt01.GetColumn(i, "PSPID"));
            var fcolRow = ds_month.FindRow("MONTH", ds_amt01.GetColumn(i, "MONTH"));
            if( fcolRow > -1 ) {
                // 수주년 기준 데이터 존재 시
				var colId = ds_month.GetColumn(fcolRow, "COL_ID");
				// 매출 계획 데이터
				ds_pspid_excel.SetColumn(rowIndex, colId, ds_amt01.GetColumn(i, "AMT"));
				// 수주년도합계 수행 처리
				ds_pspid_excel.SetColumn(rowIndex, "YEAR_TOT_AMT", toNumber(ds_pspid_excel.GetColumn(rowIndex, "YEAR_TOT_AMT"))+toNumber(ds_amt01.GetColumn(i, "AMT")));
				// 총합계 합산 처리 수행
				ds_pspid_excel.SetColumn(rowIndex, "TOT_AMT", toNumber(ds_pspid_excel.GetColumn(rowIndex, "TOT_AMT"))+toNumber(ds_amt01.GetColumn(i, "AMT")));
				
            } else {
				// 매출 계획 데이터 이전년도 합계처리
				ds_pspid_excel.SetColumn(rowIndex, "AGO_TOT_AMT", toNumber(ds_pspid_excel.GetColumn(rowIndex, "AGO_TOT_AMT"))+toNumber(ds_amt01.GetColumn(i, "AMT")));
				// 총합계 합산 처리 수행
				ds_pspid_excel.SetColumn(rowIndex, "TOT_AMT", toNumber(ds_pspid_excel.GetColumn(rowIndex, "TOT_AMT"))+toNumber(ds_amt01.GetColumn(i, "AMT")));
            }
        }
                
        // 청구실적
        for(var i=0; i < ds_amt02.GetRowCount(); i++) {
            var rowIndex = ds_pspid_excel.FindRow("PSPID", ds_amt02.GetColumn(i, "PSPID"));
            var fcolRow = ds_month.FindRow("MONTH", ds_amt02.GetColumn(i, "MONTH"));
            if( fcolRow > -1 ) {
                // 수주년 기준 데이터 존재 시
				var colId = ds_month.GetColumn(fcolRow, "COL_ID");
				// 매출 계획 데이터
				ds_pspid_excel.SetColumn(rowIndex+2, colId, ds_amt02.GetColumn(i, "AMT"));
				// 수주년도합계 수행 처리
				ds_pspid_excel.SetColumn(rowIndex+2, "YEAR_TOT_AMT", toNumber(ds_pspid_excel.GetColumn(rowIndex+2, "YEAR_TOT_AMT"))+toNumber(ds_amt02.GetColumn(i, "AMT")));
				// 총합계 합산 처리 수행
				ds_pspid_excel.SetColumn(rowIndex+2, "TOT_AMT", toNumber(ds_pspid_excel.GetColumn(rowIndex+2, "TOT_AMT"))+toNumber(ds_amt02.GetColumn(i, "AMT")));
				
            } else {
				// 매출 계획 데이터 이전년도 합계처리
				ds_pspid_excel.SetColumn(rowIndex+2, "AGO_TOT_AMT", toNumber(ds_pspid_excel.GetColumn(rowIndex+2, "AGO_TOT_AMT"))+toNumber(ds_amt02.GetColumn(i, "AMT")));
				// 총합계 합산 처리 수행
				ds_pspid_excel.SetColumn(rowIndex+2, "TOT_AMT", toNumber(ds_pspid_excel.GetColumn(rowIndex+2, "TOT_AMT"))+toNumber(ds_amt02.GetColumn(i, "AMT")));
            }
        }
                
        // 수금실적
        for(var i=0; i < ds_amt03.GetRowCount(); i++) {
            var rowIndex = ds_pspid_excel.FindRow("PSPID", ds_amt03.GetColumn(i, "PSPID"));
            var fcolRow = ds_month.FindRow("MONTH", ds_amt03.GetColumn(i, "MONTH"));
            if( fcolRow > -1 ) {
                // 수주년 기준 데이터 존재 시
				var colId = ds_month.GetColumn(fcolRow, "COL_ID");
				// 매출 계획 데이터
				ds_pspid_excel.SetColumn(rowIndex+4, colId, ds_amt03.GetColumn(i, "AMT"));
				// 수주년도합계 수행 처리
				ds_pspid_excel.SetColumn(rowIndex+4, "YEAR_TOT_AMT", toNumber(ds_pspid_excel.GetColumn(rowIndex+4, "YEAR_TOT_AMT"))+toNumber(ds_amt03.GetColumn(i, "AMT")));
				// 총합계 합산 처리 수행
				ds_pspid_excel.SetColumn(rowIndex+4, "TOT_AMT", toNumber(ds_pspid_excel.GetColumn(rowIndex+4, "TOT_AMT"))+toNumber(ds_amt03.GetColumn(i, "AMT")));
				
            } else {
				// 매출 계획 데이터 이전년도 합계처리
				ds_pspid_excel.SetColumn(rowIndex+4, "AGO_TOT_AMT", toNumber(ds_pspid_excel.GetColumn(rowIndex+4, "AGO_TOT_AMT"))+toNumber(ds_amt03.GetColumn(i, "AMT")));
				// 총합계 합산 처리 수행
				ds_pspid_excel.SetColumn(rowIndex+4, "TOT_AMT", toNumber(ds_pspid_excel.GetColumn(rowIndex+4, "TOT_AMT"))+toNumber(ds_amt03.GetColumn(i, "AMT")));
            }
        }

        ds_pspid_excel.fireevent = true;

	    // 엑셀 데이터 셑 생성 후 다운로드 처리를 수행한다.
	    gfn_saveToExcel(grid_excel, true, "", "", false, true);
    }
}

/********************************************************************************
* 기      능   : 닫기
********************************************************************************/
function fn_close() {
    if( g_isChang ) {
        if( gfn_showConfirm("저장처리 없이 종료하시겠습니까?") ) {
            close();
        } else {
            return;
        }
    }

    close();
}

/********************************************************************************
* 기      능   : 프로젝트 번호 조회 팝업
********************************************************************************/
function btn_prj_num_OnClick(obj)
{
    var arg="";
	var arr = null;
    arr = gfn_openPopup("FS0301001B", true, arg);
    if( length(arr) > 0 )  {
		ds_cond.fireevent = false;
		ds_cond.SetColumn(0, "PSPID", arr[0]);
		ds_cond.fireevent = true;
    }
}

/********************************************************************************
* 기      능   : 담당자 팝업을 호출한다.
********************************************************************************/
function btn_salePrsn_OnClick(obj)
{
	var arg="";
	var arr=null;
    arr = gfn_openPopup("FS_COM0801", true, arg);
    ds_cond.fireevent = false;
    if( length(arr) > 0 )  {
        ds_cond.SetColumn(0, "SALE_PRSN", arr[0]);
        ds_cond.SetColumn(0, "SALE_PRSN_NAME", arr[1]);
    }
    ds_cond.fireevent = true;
}

/********************************************************************************
* 기      능   : 그리드 헤더 클릭시 정렬 처리 
********************************************************************************/
function grd_list_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
{
	if ( nCell == 0 ) {
        // 그리드 정렬 처리 
		gfn_multiSortGrid(obj, false, 1);
	} else {
        // 그리드 정렬 처리 
	    gfn_sortGrid(obj,nCell);
	}
}

/********************************************************************************
* 기      능   : 그리드 체인지 클릭 시
********************************************************************************/
function grd_plan_OnCellPosChanged(obj,nRow,nCell,nOldRow,nOldCell,nPivotIndex,nOldPivotIndex)
{
    // 수금계획 자료를 조회한다.
	fn_queryDetail();
}

/********************************************************************************
* 기      능   : 수주계획 입력값 변경 시 합계 금액 변경 처리
********************************************************************************/
function ds_plan_data_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{
    var amt = toNumber(varNewValue) - toNumber(varOldValue);
	ds_plan_data.fireevent = false;
	ds_plan_data.SetColumn(nRow, "YEAR_TOT_AMT", toNumber(ds_plan_data.GetColumn(nRow, "YEAR_TOT_AMT"))+amt);
	ds_plan_data.SetColumn(nRow, "TOT_AMT", toNumber(ds_plan_data.GetColumn(nRow, "TOT_AMT"))+amt);
	ds_plan_data.fireevent = true;
	g_isChang = true;
}

]]></Script>
</Window>