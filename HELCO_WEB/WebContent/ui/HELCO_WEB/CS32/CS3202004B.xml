<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="320" Id="CS1213001B" Left="8" OnLoadCompleted="fn_OnLoadCompleted" OnUnloadCompleted="fn_OnUnloadCompleted" PidAttrib="7" Title="Copy&#32;Tool" ToolTipFont="Default,0" Top="8" Ver="1.0" Width="600" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_rsn">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<colinfo id="DTEXT1" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_hep">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
		</Datasets>
		<Shape BKColor="user12" Bottom="143" Height="26" Id="Shape7" Left="6" LineColor="user13" Right="592" TabOrder="23" Top="117" Type="Rectangle" Width="586"></Shape>
		<Shape BKColor="user12" Bottom="68" Height="26" Id="Shape2" Left="6" LineColor="user13" Right="592" TabOrder="7" Top="42" Type="Rectangle" Width="586"></Shape>
		<Shape BKColor="user12" Bottom="243" Height="26" Id="Shape3" Left="6" LineColor="user13" Right="592" TabOrder="4" Top="217" Type="Rectangle" Width="586"></Shape>
		<Shape BKColor="user12" Bottom="118" Height="26" Id="Shape0" Left="6" LineColor="user13" Right="592" TabOrder="2" Top="92" Type="Rectangle" Width="586"></Shape>
		<Static Align="Right" Height="24" Id="st_ydt" Left="7" Style="sty_lb_form_basic" TabOrder="3" Text="유상게시일&#32;" Top="93" VAlign="Middle" Width="105"></Static>
		<Calendar Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DisableBKColor="user5" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="USD" Left="114" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" OnChanged="USD_OnChanged" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="1" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="95" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="100"></Calendar>
		<Div Height="36" Id="div_btn" Left="-8" TabOrder="6" Text="Div0" Url="WB01::CommBtnForm.xml" Width="608">
			<Contents></Contents>
		</Div>
		<Static Align="Right" Height="24" Id="st_rsn" Left="7" Style="sty_lb_form_basic" TabOrder="8" Text="사유&#32;" Top="43" VAlign="Middle" Width="105"></Static>
		<Combo Border="Flat" CodeColumn="CODE" DataColumn="CODE_NAME" Height="20" Id="cb_rsn" INDEX="0" InnerDataset="ds_rsn" Left="113" Style="sty_ipt_form" TabOrder="9" Top="44" Width="150"></Combo>
		<Shape BKColor="user12" Bottom="168" Height="26" Id="Shape1" Left="6" LineColor="user13" Right="592" TabOrder="11" Top="142" Type="Rectangle" Width="586"></Shape>
		<Shape BKColor="user12" Bottom="193" Height="26" Id="Shape4" Left="6" LineColor="user13" Right="592" TabOrder="12" Top="167" Type="Rectangle" Width="586"></Shape>
		<Shape BKColor="user12" Bottom="218" Height="26" Id="Shape5" Left="6" LineColor="user13" Right="592" TabOrder="13" Top="192" Type="Rectangle" Width="586"></Shape>
		<Static Align="Right" Height="24" Id="st_ybn" Left="7" Style="sty_lb_form_basic" TabOrder="14" Text="실패예정일&#32;" Top="143" VAlign="Middle" Width="105"></Static>
		<Static Align="Right" Height="24" Id="st_ymt" Left="7" Style="sty_lb_form_basic" TabOrder="15" Text="FM여부&#32;" Top="168" VAlign="Middle" Width="105"></Static>
		<Static Align="Right" Height="24" Id="st_yon" Left="7" Style="sty_lb_form_basic" TabOrder="16" Text="계약단가&#32;" Top="193" VAlign="Middle" Width="105"></Static>
		<Checkbox BKColor="user5" DisableBKColor="user5" Height="20" Id="FYN" Left="120" Style="sty_ipt_form_chk" TabOrder="17" Top="169" Value="FALSE" Width="16"></Checkbox>
		<MaskEdit Border="Flat" Height="20" Id="YMT" Left="114" Style="sty_ipt_form" TabOrder="18" Top="195" Value="0" Width="100"></MaskEdit>
		<Shape BKColor="user12" Bottom="93" Height="26" Id="Shape6" Left="6" LineColor="user13" Right="592" TabOrder="20" Top="67" Type="Rectangle" Width="586"></Shape>
		<Static Align="Right" Height="24" Id="st_bdt" Left="7" Style="sty_lb_form_basic" TabOrder="21" Text="계약예정일&#32;" Top="68" VAlign="Middle" Width="105"></Static>
		<Calendar Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DisableBKColor="user5" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="YDT" Left="114" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" OnChanged="YDT_OnChanged" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="19" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="70" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="100"></Calendar>
		<Static Align="Right" Height="24" Id="Static0" Left="7" Style="sty_lb_form_basic" TabOrder="24" Text="유상만료일&#32;" Top="118" VAlign="Middle" Width="105"></Static>
		<Calendar Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DisableBKColor="user5" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="UMR" Left="114" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" OnChanged="UMR_OnChanged" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="22" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="120" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="100"></Calendar>
		<Shape BKColor="user12" Bottom="269" Height="27" Id="Shape10" Left="6" LineColor="user13" Right="592" TabOrder="25" Top="242" Type="Rectangle" Width="586"></Shape>
		<Static Align="Right" Height="24" Id="st_rmk" Left="7" Style="sty_lb_form_basic" TabOrder="5" Text="비고&#32;" Top="243" VAlign="Middle" Width="105"></Static>
		<Edit Border="Flat" Height="20" Id="RMK" Left="114" Style="sty_ipt_form" TabOrder="10" Top="245" Width="475"></Edit>
		<Calendar Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DisableBKColor="user5" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="FDT" Left="114" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" OnChanged="FDT_OnChanged" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="26" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="144" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="100"></Calendar>
		<Static Align="Right" Height="24" Id="Static1" Left="7" Style="sty_lb_form_basic" TabOrder="27" Text="점검주기&#32;" Top="218" VAlign="Middle" Width="105"></Static>
		<Combo Border="Flat" CodeColumn="CODE" DataColumn="CODE_NAME" Height="20" Id="cb_hep" INDEX="0" InnerDataset="ds_hep" Left="113" Style="sty_ipt_form" TabOrder="28" Top="219" Width="100"></Combo>
	</Form>
	<Script><![CDATA[/*
 ******************************************************************************************
 * 기      능   : 
 * 작  성  자   : 
 * 작성  일자   : 
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
#include "LIB::commons.js";	// 공통 스크립트 
//=========================================================================================
// [ PART 1 ]
// Form에서 사용될 전역변수를 선언
// FORM에서 사용되는 전역변수는 대문자로 작성하며, F_XXX 의 형태를 갖도록 한다. 
//=========================================================================================

//=========================================================================================
// [ PART 2 ]
// Form Loading / Unloading 시 작업 정의
//=========================================================================================
function fn_OnLoadCompleted(obj) {
	// Form 로드 이벤트 맨 첫줄에 기술 
	gfn_initForm();
	
	var codeArr = ["CS158", "CS179"];
    var dsObjArr = [ds_rsn, ds_hep];
    var addTypeArr = [G_CODE_SELECT, G_CODE_SELECT];
    gfn_searchCommCode(codeArr, dsObjArr, addTypeArr);
}

/********************************************************************************
* 기      능   : 공통코드가 조회된 후의 Callback 함수 
********************************************************************************/
function fn_completeInit(sCode, sDsObj, sCodeType) {
	cb_rsn.Index = 0;
	cb_hep.Index = 0;
	
	for(var i=0; i<parseInt(parent.ds_list.rowcount); i++) {
		if(parent.ds_list.GetColumn(i, "CHK") == true) {
			var gbn = parent.ds_list.GetColumn(i, "PRO");
			if(gbn = "1"){
				ds_rsn.Filter("DTEXT1 == 1");
				ds_rsn.InsertRow();
				ds_rsn.SetColumn(0, "CODE", ""); 
				ds_rsn.SetColumn(0, "CODE_NAME", "- 선택 -");
				ds_rsn.SetColumn(0, "DTEXT1", "");
				ds_rsn.Index = 0;
				ds_rsn.Enable = true;
			}else if(gbn = "2"){
				ds_rsn.Filter("DTEXT1 == 2");
				ds_rsn.InsertRow();
				ds_rsn.SetColumn(0, "CODE", ""); 
				ds_rsn.SetColumn(0, "CODE_NAME", "- 선택 -");
				ds_rsn.SetColumn(0, "DTEXT1", "");
				ds_rsn.Index = 0;
				ds_rsn.Enable = true;
			}else if(gbn = "3"){
				ds_rsn.Filter("DTEXT1 == 3");
				ds_rsn.InsertRow();
				ds_rsn.SetColumn(0, "CODE", ""); 
				ds_rsn.SetColumn(0, "CODE_NAME", "- 선택 -");
				ds_rsn.SetColumn(0, "DTEXT1", "");
				ds_rsn.Index = 0;
				ds_rsn.Enable = true;
			}
			break;
		}
	}
}

/********************************************************************************
* 기      능   : form UnloadCompleted 
********************************************************************************/
function fn_OnUnloadCompleted(obj) {
	return gfn_isFormUnload(obj);
}

/********************************************************************************
* 기      능   : 닫기  
********************************************************************************/
function fn_close() {
	close();
}

/********************************************************************************
* 기      능   : 복사 75
********************************************************************************/
function fn_copy() {
	gfn_clearMsgBar();
	var diff;
	for(var i=0; i<parseInt(parent.ds_list.rowcount); i++) {
		if(parent.ds_list.GetColumn(i, "CHK") == true) {
			parent.ds_list.SetColumn(i, "RSN", cb_rsn.value);
			parent.ds_list.SetColumn(i, "YDT", YDT.value);
			parent.ds_list.SetColumn(i, "USD", USD.value);
			parent.ds_list.SetColumn(i, "UMR", UMR.value);
			parent.ds_list.SetColumn(i, "FDT", FDT.value);
			parent.ds_list.SetColumn(i, "FYN", FYN.value);
			parent.ds_list.SetColumn(i, "YMT", YMT.value);
			parent.ds_list.SetColumn(i, "HEP", cb_hep.value);
			parent.ds_list.SetColumn(i, "RMK", RMK.value);
			diff = gfn_getMonthCnt(USD.Value, UMR.Value);
			if(parseInt(diff) < 0 ) diff = 0;
			parent.ds_list.SetColumn(i, "YON", diff);
		}
	}
	fn_close();
}


function FDT_OnChanged(obj,strOldText,strNewText)
{
	if(strNewText != ''){
		YDT.value = '';
		USD.value = '';
		UMR.value = '';
	}
}

function YDT_OnChanged(obj,strOldText,strNewText)
{
	if(strNewText != ''){
		USD.Value = strNewText;
		UMR.Value = AddDate(AddMonth(strNewText,12),-1);
		FDT.value = '';
	}
}



function USD_OnChanged(obj,strOldText,strNewText)
{
	if(strNewText != ''){
		UMR.Value = AddDate(AddMonth(strNewText,12),-1);
		FDT.value = '';
	}
}
]]></Script>
</Window>