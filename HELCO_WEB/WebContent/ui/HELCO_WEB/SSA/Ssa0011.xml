<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="496" Id="Ssa0011" Left="8" OnLoadCompleted="fn_OnLoadCompleted" OnUnloadCompleted="fn_OnUnloadCompleted" PidAttrib="7" Title="수금전&#32;공정진행&#32;요청서&#32;상세" Top="8" Ver="1.0" Width="978" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_cs">
				<Contents>
					<colinfo id="DOCU" size="24" type="STRING"/>
					<colinfo id="PSPID" size="24" type="STRING"/>
					<colinfo id="POST1" size="40" type="STRING"/>
					<colinfo id="KUNNR" size="10" type="STRING"/>
					<colinfo id="KUNNT" size="35" type="STRING"/>
					<colinfo id="KUNZ2" size="10" type="STRING"/>
					<colinfo id="KUNZT" size="35" type="STRING"/>
					<colinfo id="PTEXT" size="100" type="STRING"/>
					<colinfo id="VKGRP" size="3" type="STRING"/>
					<colinfo id="VKGRT" size="20" type="STRING"/>
					<colinfo id="ZCITY_NM" size="30" type="STRING"/>
					<colinfo id="PRATE" size="8" type="STRING"/>
					<colinfo id="GRATE" size="8" type="STRING"/>
					<colinfo id="IRATE" size="8" type="STRING"/>
					<colinfo id="ZQNTY" size="256" type="INT"/>
					<colinfo id="NETWR" size="18" type="STRING"/>
					<colinfo id="WAVWR" size="16" type="STRING"/>
					<colinfo id="WAERK" size="256" type="STRING"/>
					<colinfo id="CHNEW" size="18" type="STRING"/>
					<colinfo id="SUNEW" size="18" type="STRING"/>
					<colinfo id="MCNT" size="256" type="STRING"/>
					<colinfo id="REQTY" size="256" type="STRING"/>
					<colinfo id="MEINS" size="256" type="STRING"/>
					<colinfo id="PLDAT" size="10" type="STRING"/>
					<colinfo id="FKDAT" size="10" type="STRING"/>
					<colinfo id="CODAT" size="10" type="STRING"/>
					<colinfo id="BRAN1" size="10" type="STRING"/>
					<colinfo id="BRAN2" size="10" type="STRING"/>
					<colinfo id="JUDGE" size="1" type="STRING"/>
					<colinfo id="RANK" size="8" type="STRING"/>
					<colinfo id="ADDF1" size="3" type="STRING"/>
					<colinfo id="ADDF2" size="3" type="STRING"/>
					<colinfo id="ADDF3" size="3" type="STRING"/>
					<colinfo id="ADDFT" size="25" type="STRING"/>
					<colinfo id="KU_ZQNTY" size="13" type="STRING"/>
					<colinfo id="KU_NETWR" size="18" type="STRING"/>
					<colinfo id="KU_CHNEW" size="18" type="STRING"/>
					<colinfo id="KU_SUNEW" size="18" type="STRING"/>
					<colinfo id="FICG" size="18" type="STRING"/>
					<colinfo id="MICG" size="18" type="STRING"/>
					<colinfo id="TOTALCG" size="18" type="STRING"/>
					<colinfo id="KU_MISU" size="18" type="STRING"/>
					<colinfo id="KU_MISUQ" size="18" type="STRING"/>
					<colinfo id="GSCG" size="18" type="STRING"/>
					<colinfo id="BILL" size="18" type="STRING"/>
					<colinfo id="CODAT2" size="8" type="STRING"/>
					<colinfo id="VMISU" size="100" type="STRING"/>
					<colinfo id="CHPDT" size="10" type="STRING"/>
					<colinfo id="ZBEPJEO" size="10" type="STRING"/>
					<colinfo id="CONTR_DA" size="10" type="STRING"/>
					<colinfo id="VAT_RATE" size="14" type="STRING"/>
					<colinfo id="C_MODIFY" size="14" type="STRING"/>
					<colinfo id="ERDAT" size="8" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_is">
				<Contents>
					<colinfo id="STATE" size="256" type="STRING"/>
					<colinfo id="STATUS" size="256" type="STRING"/>
					<colinfo id="DOCU" size="256" type="STRING"/>
					<colinfo id="PSPID" size="256" type="STRING"/>
					<colinfo id="POST1" size="256" type="STRING"/>
					<colinfo id="ERDAT" size="256" type="STRING"/>
					<colinfo id="PROTP" size="256" type="STRING"/>
					<colinfo id="PROTT" size="256" type="STRING"/>
					<colinfo id="APDAT" size="256" type="STRING"/>
					<colinfo id="PLDAT" size="256" type="STRING"/>
					<colinfo id="FKDAT" size="256" type="STRING"/>
					<colinfo id="CODAT" size="256" type="STRING"/>
					<colinfo id="CADAT" size="256" type="STRING"/>
					<colinfo id="ZQNTY" size="256" type="STRING"/>
					<colinfo id="NETWR" size="256" type="STRING"/>
					<colinfo id="WAERK" size="256" type="STRING"/>
					<colinfo id="APTYP" size="256" type="STRING"/>
					<colinfo id="KUNNR" size="256" type="STRING"/>
					<colinfo id="KUNRG" size="256" type="STRING"/>
					<colinfo id="KUNZ1" size="256" type="STRING"/>
					<colinfo id="KUNZ2" size="256" type="STRING"/>
					<colinfo id="ZCITY_NM" size="256" type="STRING"/>
					<colinfo id="REQTY" size="256" type="STRING"/>
					<colinfo id="MEINS" size="256" type="STRING"/>
					<colinfo id="BRAN1" size="256" type="STRING"/>
					<colinfo id="JUDGE" size="256" type="STRING"/>
					<colinfo id="RANK" size="256" type="STRING"/>
					<colinfo id="ADDF" size="256" type="STRING"/>
					<colinfo id="ADDFT" size="256" type="STRING"/>
					<colinfo id="KUNNT" size="256" type="STRING"/>
					<colinfo id="VKBUR" size="256" type="STRING"/>
					<colinfo id="VKBUT" size="256" type="STRING"/>
					<colinfo id="VKGRP" size="256" type="STRING"/>
					<colinfo id="VKGRT" size="256" type="STRING"/>
					<colinfo id="KUNZ1T" size="256" type="STRING"/>
					<colinfo id="KUNZ2T" size="256" type="STRING"/>
					<colinfo id="CODAT2" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_error">
				<Contents>
					<colinfo id="IDX" size="256" type="STRING"/>
					<colinfo id="ERRMSG" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_itab">
				<Contents>
					<colinfo id="MANDT" size="256" type="STRING"/>
					<colinfo id="PSPID" size="256" type="STRING"/>
					<colinfo id="PROTP" size="256" type="STRING"/>
					<colinfo id="ERDAT" size="256" type="STRING"/>
					<colinfo id="ZSEQ" size="256" type="STRING"/>
					<colinfo id="FKDAT" size="256" type="STRING"/>
					<colinfo id="CODAT" size="256" type="STRING"/>
					<colinfo id="DMBTR" size="256" type="STRING"/>
					<colinfo id="WAERK" size="256" type="STRING"/>
					<colinfo id="ERZZT" size="256" type="STRING"/>
					<colinfo id="ERNAM" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_itab2">
				<Contents>
					<colinfo id="TDFORMAT" size="256" type="STRING"/>
					<colinfo id="TDLINE" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_itab3">
				<Contents>
					<colinfo id="ZTERM" size="256" type="STRING"/>
					<colinfo id="MLBEZ" size="256" type="STRING"/>
					<colinfo id="MLBET" size="256" type="STRING"/>
					<colinfo id="ZTERT" size="256" type="STRING"/>
					<colinfo id="FAKWR" size="256" type="STRING"/>
					<colinfo id="NETWR" size="256" type="STRING"/>
					<colinfo id="HWBAS" size="256" type="STRING"/>
					<colinfo id="WAERK" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_itab4">
				<Contents>
					<colinfo id="CHPDT" size="256" type="STRING"/>
					<colinfo id="ZBEPJEO" size="256" type="STRING"/>
					<colinfo id="CQNTY" size="256" type="STRING"/>
					<colinfo id="PROF_H" size="256" type="STRING"/>
					<colinfo id="RATE_B" size="256" type="STRING"/>
					<colinfo id="RATE_I" size="256" type="STRING"/>
					<colinfo id="LOAN_R" size="256" type="STRING"/>
					<colinfo id="RATE_PF" size="256" type="STRING"/>
					<colinfo id="PFCAP" size="256" type="STRING"/>
					<colinfo id="WAERK" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_save">
				<Contents>
					<colinfo id="GUBUN" size="1" type="STRING"/>
					<colinfo id="UNAME" size="12" type="STRING"/>
					<colinfo id="DOCU" size="24" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_approval">
				<Contents>
					<colinfo id="STATE" size="256" type="STRING"/>
					<colinfo id="STATUS" size="256" type="STRING"/>
					<colinfo id="APDAT" size="256" type="STRING"/>
					<colinfo id="APTYP" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_waerk">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
		</Datasets>
		<Shape BKColor="user0" Bottom="488" Height="83" Id="Shape13" Left="9" LineColor="user1" Right="957" TabOrder="45" Top="405" Type="Rectangle" Width="948"></Shape>
		<Shape BKColor="user0" Bottom="401" Height="26" Id="Shape12" Left="9" LineColor="user1" Right="957" TabOrder="44" Top="375" Type="Rectangle" Width="948"></Shape>
		<Shape BKColor="user0" Bottom="376" Height="26" Id="Shape11" Left="9" LineColor="user1" Right="957" TabOrder="43" Top="350" Type="Rectangle" Width="948"></Shape>
		<Shape BKColor="user0" Bottom="351" Height="26" Id="Shape10" Left="9" LineColor="user1" Right="957" TabOrder="42" Top="325" Type="Rectangle" Width="948"></Shape>
		<Shape BKColor="user0" Bottom="321" Height="26" Id="Shape9" Left="9" LineColor="user1" Right="528" TabOrder="41" Top="295" Type="Rectangle" Width="519"></Shape>
		<Shape BKColor="user0" Bottom="296" Height="26" Id="Shape8" Left="9" LineColor="user1" Right="528" TabOrder="40" Top="270" Type="Rectangle" Width="519"></Shape>
		<Shape BKColor="user0" Bottom="271" Height="26" Id="Shape88" Left="9" LineColor="user1" Right="528" TabOrder="39" Top="245" Type="Rectangle" Width="519"></Shape>
		<Shape BKColor="user0" Bottom="239" Height="26" Id="Shape6" Left="9" LineColor="user1" Right="957" TabOrder="38" Top="213" Type="Rectangle" Width="948"></Shape>
		<Shape BKColor="user0" Bottom="205" Height="26" Id="Shape5" Left="9" LineColor="user1" Right="957" TabOrder="37" Top="179" Type="Rectangle" Width="948"></Shape>
		<Shape BKColor="user0" Bottom="180" Height="26" Id="Shape4" Left="9" LineColor="user1" Right="957" TabOrder="36" Top="154" Type="Rectangle" Width="948"></Shape>
		<Shape BKColor="user0" Bottom="155" Height="26" Id="Shape3" Left="9" LineColor="user1" Right="957" TabOrder="35" Top="129" Type="Rectangle" Width="948"></Shape>
		<Shape BKColor="user0" Bottom="121" Height="26" Id="Shape2" Left="9" LineColor="user1" Right="957" TabOrder="34" Top="95" Type="Rectangle" Width="948"></Shape>
		<Shape BKColor="user0" Bottom="96" Height="26" Id="Shape1" Left="9" LineColor="user1" Right="957" TabOrder="33" Top="70" Type="Rectangle" Width="948"></Shape>
		<Shape BKColor="user0" Bottom="71" Height="26" Id="Shape0" Left="9" LineColor="user1" Right="957" TabOrder="1" Top="45" Type="Rectangle" Width="948"></Shape>
		<Static Align="Right" Height="24" Id="st_docu" Left="10" Style="sty_lb_search" TabOrder="2" Text="문서&#32;번호&#32;" Top="46" VAlign="Middle" Width="100"></Static>
		<Edit BindDataset="ds_cs" Border="Flat" Column="DOCU" Enable="FALSE" Height="20" Id="ed_docu" Left="112" LeftMargin="4" Readonly="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="3" Top="48" Width="120"></Edit>
		<Static Align="Right" Height="24" Id="st_pspid" Left="10" Style="sty_lb_search" TabOrder="4" Text="공사&#32;번호&#32;" Top="71" VAlign="Middle" Width="100"></Static>
		<Edit BindDataset="ds_cs" Border="Flat" Column="PSPID" Enable="FALSE" Height="20" Id="ed_pspid" Left="112" LeftMargin="4" Readonly="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="5" Top="73" Width="120"></Edit>
		<Static Align="Right" Height="24" Id="st_zcity_nm" Left="452" Style="sty_lb_search" TabOrder="6" Text="설치&#32;지역&#32;" Top="71" VAlign="Middle" Width="100"></Static>
		<Static Align="Right" Height="24" Id="st_netwr" Left="10" Style="sty_lb_search" TabOrder="7" Text="수주금액/대수&#32;" Top="96" VAlign="Middle" Width="100"></Static>
		<Static Align="Right" Height="24" Id="st_prate" Left="452" Style="sty_lb_search" TabOrder="8" Text="설치&#32;공정율&#32;" Top="96" VAlign="Middle" Width="100"></Static>
		<Static Align="Right" Height="24" Id="st_chnew" Left="10" Style="sty_lb_search" TabOrder="9" Text="청구&#32;금액&#32;" Top="130" VAlign="Middle" Width="100"></Static>
		<Static Align="Right" Height="24" Id="st_sunew" Left="10" Style="sty_lb_search" TabOrder="10" Text="수금액&#32;" Top="155" VAlign="Middle" Width="100"></Static>
		<Static Align="Right" Height="24" Id="st_micg" Left="452" Style="sty_lb_search" TabOrder="11" Text="미수금/기성채권&#32;" Top="155" VAlign="Middle" Width="100"></Static>
		<Static Height="24" Id="st_slash" Left="704" Style="sty_lb_search" TabOrder="12" Text="&#32;/" Top="155" VAlign="Middle" Width="16"></Static>
		<Static Height="24" Id="st_percent" Left="704" Style="sty_lb_search" TabOrder="13" Text="&#32;%" Top="130" VAlign="Middle" Width="16"></Static>
		<Static Align="Right" Height="24" Id="st_ficg" Left="10" Style="sty_lb_search" TabOrder="14" Text="회계상채권액&#32;" Top="180" VAlign="Middle" Width="100"></Static>
		<Static Align="Right" Height="24" Id="st_bill" Left="452" Style="sty_lb_search" TabOrder="15" Text="미도래&#32;어음&#32;" Top="180" VAlign="Middle" Width="100"></Static>
		<Static Align="Right" Height="24" Id="st_totalcg" Left="10" Style="sty_lb_search" TabOrder="16" Text="총&#32;미수&#32;채권&#32;" Top="214" VAlign="Middle" Width="100"></Static>
		<Static Align="Right" Height="24" Id="st_reqty" Left="10" Style="sty_lb_search" TabOrder="17" Text="요청&#32;대수&#32;" Top="246" VAlign="Middle" Width="100"></Static>
		<Static Align="Right" Height="24" Id="st_pldat" Left="10" Style="sty_lb_search" TabOrder="18" Text="생산&#32;예정일&#32;" Top="271" VAlign="Middle" Width="100"></Static>
		<Static Align="Right" Height="24" Id="st_chpdt" Left="268" Style="sty_lb_search" TabOrder="19" Text="착공예정일&#32;" Top="271" VAlign="Middle" Width="100"></Static>
		<Static Align="Right" Height="24" Id="st_bran1" Left="10" Style="sty_lb_search" TabOrder="20" Text="신용등급&#32;" Top="296" VAlign="Middle" Width="100"></Static>
		<Edit Align="RIGHT" BindDataset="ds_cs" Border="Flat" Column="BRAN1" Height="20" Id="ed_bran1" Left="112" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="21" Top="298" UpperOnly="TRUE" Width="120"></Edit>
		<Static Align="Right" Height="24" Id="st_judge" Left="10" Style="sty_lb_search" TabOrder="22" Text="당사기준&#32;등급" Top="326" VAlign="Middle" Width="100"></Static>
		<Edit BindDataset="ds_cs" Border="Flat" Column="JUDGE" Enable="FALSE" Height="20" Id="ed_judge" Left="112" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="23" Top="328" Width="120"></Edit>
		<Static Align="Right" Height="24" Id="st_rank" Left="10" Style="sty_lb_search" TabOrder="24" Text="시공능력순위&#32;" Top="351" VAlign="Middle" Width="100"></Static>
		<Edit BindDataset="ds_cs" Border="Flat" Column="RANK" Height="20" Id="ed_rank" Left="112" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="25" Top="353" Width="120"></Edit>
		<Static Align="Right" Height="24" Id="st_addf" Left="10" Style="sty_lb_search" TabOrder="26" Text="첨부&#32;서류&#32;" Top="376" VAlign="Middle" Width="100"></Static>
		<Edit BindDataset="ds_cs" Border="Flat" Column="ADDFT" Height="20" Id="ed_addft" ImeMode="none" Left="368" LeftMargin="4" Readonly="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="27" Top="378" Width="148"></Edit>
		<Static Align="Right" Height="24" Id="st_" Left="10" Style="sty_lb_search" TabOrder="28" Text="사유&#32;" Top="406" VAlign="Middle" Width="100"></Static>
		<Static Align="Right" Height="24" Id="st_grate" Left="452" Style="sty_lb_search" TabOrder="29" Text="기성율&#32;" Top="130" VAlign="Middle" Width="100"></Static>
		<Edit BindDataset="ds_cs" Border="Flat" Column="PTEXT" Enable="FALSE" Height="20" Id="ed_ptext" Left="236" LeftMargin="4" Readonly="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="30" Top="73" Width="200"></Edit>
		<Edit Align="RIGHT" BindDataset="ds_cs" Border="Flat" Column="BRAN2" Enable="FALSE" Height="20" Id="ed_bran2" Left="236" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="31" Top="298" Width="102"></Edit>
		<Edit BindDataset="ds_cs" Border="Flat" Column="ZCITY_NM" Enable="FALSE" Height="20" Id="ed_zcity_nm" Left="554" LeftMargin="4" Readonly="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="32" Top="73" Width="148"></Edit>
		<Checkbox BindDataset="ds_cs" Column="ADDF1" Height="18" Id="chk_addf1" Left="118" Style="sty_ipt_search_chk" TabOrder="46" Text="직불동의서" Top="379" TrueValue="1" Value="FALSE" Width="82"></Checkbox>
		<Checkbox BindDataset="ds_cs" Column="ADDF2" Height="18" Id="chk_addf2" Left="214" Style="sty_ipt_search_chk" TabOrder="47" Text="기업신용현황" Top="379" TrueValue="2" Value="FALSE" Width="90"></Checkbox>
		<Checkbox BindDataset="ds_cs" Column="ADDF3" Height="18" Id="chk_addf3" Left="318" Style="sty_ipt_search_chk" TabOrder="48" Text="기타" Top="379" TrueValue="3" Value="FALSE" Width="50"></Checkbox>
		<Div Height="36" Id="div_btn" TabOrder="49" Text="Div0" Url="WB01::CommBtnForm.xml" Width="978">
			<Contents></Contents>
		</Div>
		<Grid AutoEnter="TRUE" AutoFit="TRUE" AutoFitEndLine="Hide" BindDataset="ds_itab" BkColor2="default" BoldHead="true" Border="Flat" Bottom="368" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="35" Height="124" Id="grd_list" InputPanel="FALSE" Left="536" LineColor="user20" LineType="ExHORZ" MinWidth="100" OnHeadClick="grd_list_OnHeadClick" Right="957" RowHeight="20" Style="sty_grid" TabOrder="50" TabStop="true" Top="244" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="421">
			<contents>
				<format id="Default">
					<columns>
						<col width="30"/>
						<col width="100"/>
						<col width="105"/>
						<col width="80"/>
						<col width="80"/>
					</columns>
					<head>
						<cell align="center" col="0" color="user21" display="text" font="굴림,9" text="No"/>
						<cell align="center" col="1" color="user21" display="text" font="굴림,9" text="수금액"/>
						<cell align="center" col="2" color="user21" display="text" font="굴림,9" text="통화"/>
						<cell align="center" col="3" color="user21" display="text" font="굴림,9" text="청구예정일"/>
						<cell align="center" col="4" color="user21" display="text" font="굴림,9" text="수금예정일"/>
					</head>
					<body>
						<cell align="center" bkcolor2="user22" col="0" display="text" expr="currow+1"/>
						<cell align="right" bkcolor2="user22" col="1" colid="DMBTR" display="number" edit="masknumber" Mask="###,##0" text="0"/>
						<cell align="center" bkcolor2="user22" col="2" colid="WAERK" combocol="CODE" combodataset="ds_waerk" combotext="CODE_NAME" display="combo" edit="combo"/>
						<cell align="center" bkcolor2="user22" col="3" colid="FKDAT" display="text" edit="mask" limit="8" Mask="####-##-##"/>
						<cell align="center" bkcolor2="user22" col="4" colid="CODAT" display="text" edit="mask" limit="8" Mask="####-##-##"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Calendar BindDataset="ds_cs" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="PLDAT" Dateformat="yyyy-MM-dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_pldat" Left="112" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="51" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="274" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="108"></Calendar>
		<Calendar BindDataset="ds_cs" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="CHPDT" Dateformat="yyyy-MM-dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Enable="FALSE" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_chpdt" Left="371" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="52" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="273" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="108"></Calendar>
		<MaskEdit BindDataset="ds_cs" Border="Flat" BorderColor="user13" Column="SUNEW" Enable="FALSE" Height="20" Id="me_sunew" Left="113" Style="sty_ipt_form" TabOrder="53" Top="157" Width="120"></MaskEdit>
		<MaskEdit BindDataset="ds_cs" Border="Flat" BorderColor="user13" Column="FICG" Enable="FALSE" Height="20" Id="me_ficg" Left="113" Style="sty_ipt_form" TabOrder="54" Top="182" Width="120"></MaskEdit>
		<MaskEdit BindDataset="ds_cs" Border="Flat" BorderColor="user13" Column="CHNEW" Enable="FALSE" Height="20" Id="me_chnew" Left="113" Style="sty_ipt_form" TabOrder="55" Top="132" Width="120"></MaskEdit>
		<MaskEdit BindDataset="ds_cs" Border="Flat" BorderColor="user13" Column="TOTALCG" Enable="FALSE" Height="20" Id="me_totalcg" Left="113" Style="sty_ipt_form" TabOrder="56" Top="216" Width="120"></MaskEdit>
		<MaskEdit BindDataset="ds_cs" Border="Flat" BorderColor="user13" Column="ZQNTY" Enable="FALSE" Height="20" Id="me_zqnty" Left="237" Style="sty_ipt_form_chk" TabOrder="57" Top="98" Width="63"></MaskEdit>
		<MaskEdit BindDataset="ds_cs" Border="Flat" BorderColor="user13" Column="NETWR" Enable="FALSE" Height="20" Id="me_netwr" Left="113" Style="sty_ipt_form_chk" TabOrder="58" Top="98" Width="120"></MaskEdit>
		<MaskEdit BindDataset="ds_cs" Border="Flat" BorderColor="user13" Column="PRATE" Enable="FALSE" Height="20" Id="me_prate" Left="554" Style="sty_ipt_form_chk" TabOrder="59" Top="98" Width="148"></MaskEdit>
		<MaskEdit BindDataset="ds_cs" Border="Flat" BorderColor="user13" Column="GRATE" Enable="FALSE" Height="20" Id="me_grate" Left="554" Style="sty_ipt_form" TabOrder="60" Top="133" Width="148"></MaskEdit>
		<MaskEdit BindDataset="ds_cs" Border="Flat" BorderColor="user13" Column="MICG" Enable="FALSE" Height="20" Id="me_micg" Left="554" Style="sty_ipt_form" TabOrder="61" Top="157" Width="148"></MaskEdit>
		<MaskEdit BindDataset="ds_cs" Border="Flat" BorderColor="user13" Column="GSCG" Enable="FALSE" Height="20" Id="me_gscg" Left="722" Style="sty_ipt_form" TabOrder="62" Top="157" Width="148"></MaskEdit>
		<MaskEdit BindDataset="ds_cs" Border="Flat" BorderColor="user13" Column="BILL" Enable="FALSE" Height="20" Id="me_bill" Left="554" Style="sty_ipt_form" TabOrder="63" Top="182" Width="148"></MaskEdit>
		<MaskEdit BindDataset="ds_cs" Border="Flat" BorderColor="user13" Column="REQTY" Enable="FALSE" Height="20" Id="me_reqty" Left="113" Style="sty_ipt_form" TabOrder="64" Top="248" Width="120"></MaskEdit>
		<Edit Border="Flat" Height="20" Id="ed_tdline1" Left="112" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="65" Top="408" Width="840"></Edit>
		<Edit Border="Flat" Height="20" Id="ed_tdline2" Left="112" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="66" Top="427" Width="840"></Edit>
		<Edit Border="Flat" Height="20" Id="ed_tdline3" Left="112" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="67" Top="446" Width="840"></Edit>
		<Edit Border="Flat" Height="20" Id="ed_tdline4" Left="112" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="68" Top="465" Width="840"></Edit>
	</Form>
	<Script><![CDATA[/*
 ******************************************************************************************
 * 기      능   : 
 * 작  성  자   : 
 * 작성  일자   : 
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
#include "LIB::commons.js";	// 공통 스크립트 
#include "LIB::nsfRequest.js";	// 공통 스크립트 
#include "LIB::common_hdel.js";	// 공통 스크립트  /* GNY 추가 */
//=========================================================================================
// [ PART 1 ]
// Form에서 사용될 전역변수를 선언
// FORM에서 사용되는 전역변수는 대문자로 작성하며, F_XXX 의 형태를 갖도록 한다. 
//=========================================================================================

var F_FRM_TITLE = "";	// 공통코드 화면명
var F_USER_AUTH = "";	// 담당자 권한

//=========================================================================================
// [ PART 2 ]
// Form Loading / Unloading 시 작업 정의
//=========================================================================================
function fn_OnLoadCompleted(obj) {

	gfn_initForm(true);

	//공통코드 조회
	var codeArr = ["WAERK"];
	var dsObjArr = [ds_waerk];
	var addTypeArr = [G_CODE_NONE,G_CODE_NONE,G_CODE_SELECT];
	var oderTypeArr = ["DTEXT1"];
	
	gfn_searchCommCode(codeArr, dsObjArr, addTypeArr);
}

/********************************************************************************
* 기      능   : form UnloadCompleted 
********************************************************************************/
function fn_OnUnloadCompleted(obj) {
	return gfn_isFormUnload(obj);
}

//=========================================================================================
// [ PART 3 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,form닫기)
//=========================================================================================

/********************************************************************************
* 기      능   : 폼 초기화
********************************************************************************/
function fn_init_form() {

	ds_is.ClearData();
	ds_is.copy(parent.ds_detail);

	var aptyp = ds_is.GetColumn(0, "APTYP");
	var protp = ds_is.GetColumn(0, "PROTP");
	
	var btn   = "";

	switch (aptyp) {
		case "승인"   : 
			btn = "40";  
			cal_pldat.Enable = false;    
			ed_bran1.Enable = false;
			ed_rank.Enable = false;
			chk_addf1.Enable = false;
			chk_addf2.Enable = false;
			chk_addf3.Enable = false;
			ed_addft.Enable = false;
			ed_tdline1.Enable = false;
			ed_tdline2.Enable = false;
			ed_tdline3.Enable = false;
			ed_tdline4.Enable = false;
			grd_list.Editable = false;
			break;
		case "미승인" : btn = "10,35,25,30,40"; break;
		default       : btn = "10,35,40";       break;
	}

	switch (protp) {
		case "A" : F_FRM_TITLE = "수금 전 생산 요청서"; break;
		case "B" : F_FRM_TITLE = "수금 전 출하 요청서"; break;
		case "C" : F_FRM_TITLE = "수금 전 착공 요청서"; break;
		case "D" : F_FRM_TITLE = "수금 전 접수 요청서"; break;
		case "E" : F_FRM_TITLE = "수금 전 준공 요청서"; break;
		default  : break;
	}

	div_btn.fn_loadUseBtn(btn, F_FRM_TITLE, "", "");

	F_USER_AUTH = right(G_USER_GROUP_B, 2 );
	
	//관리부 및 내부사용자만 승인, 취소버튼 활성화
	if (F_USER_AUTH == "50"){
		div_btn.btn_approval.visible = true;
		div_btn.btn_cancel.visible = true;
	} else {
		div_btn.btn_approval.visible = false;
		div_btn.btn_cancel.visible = false;	
	}
	
	ds_cs.AddRow();
	ds_cs.SetColumn(0, "DOCU"    , ds_is.GetColumn(0, "DOCU"    ));
	ds_cs.SetColumn(0, "PSPID"   , ds_is.GetColumn(0, "PSPID"   ));
	ds_cs.SetColumn(0, "POST1"   , ds_is.GetColumn(0, "POST1"   ));
	ds_cs.SetColumn(0, "KUNNR"   , ds_is.GetColumn(0, "KUNNR"   ));
	ds_cs.SetColumn(0, "KUNNT"   , ds_is.GetColumn(0, "KUNNT"   ));
	ds_cs.SetColumn(0, "KUNZ2"   , ds_is.GetColumn(0, "KUNZ2"   ));
	ds_cs.SetColumn(0, "KUNZT"   , ds_is.GetColumn(0, "KUNZ2T"  ));
	ds_cs.SetColumn(0, "VKGRP"   , ds_is.GetColumn(0, "VKGRP"   ));
	ds_cs.SetColumn(0, "VKGRT"   , ds_is.GetColumn(0, "VKGRT"   ));
	ds_cs.SetColumn(0, "VKGRT"   , ds_is.GetColumn(0, "VKGRT"   ));
	ds_cs.SetColumn(0, "ZCITY_NM", ds_is.GetColumn(0, "ZCITY_NM"));
	ds_cs.SetColumn(0, "ZQNTY"   , ds_is.GetColumn(0, "ZQNTY"   ));
	ds_cs.SetColumn(0, "NETWR"   , ds_is.GetColumn(0, "NETWR"   ));
	ds_cs.SetColumn(0, "WAERK"   , ds_is.GetColumn(0, "WAERK"   ));
	ds_cs.SetColumn(0, "MEINS"   , ds_is.GetColumn(0, "MEINS"   ));
	ds_cs.SetColumn(0, "PLDAT"   , ds_is.GetColumn(0, "PLDAT"   ));
	ds_cs.SetColumn(0, "FKDAT"   , ds_is.GetColumn(0, "FKDAT"   ));
	ds_cs.SetColumn(0, "CODAT"   , ds_is.GetColumn(0, "CODAT"   ));
	ds_cs.SetColumn(0, "BRAN1"   , ds_is.GetColumn(0, "BRAN1"   ));
	ds_cs.SetColumn(0, "JUDGE"   , ds_is.GetColumn(0, "JUDGE"   ));
	ds_cs.SetColumn(0, "RANK"    , ds_is.GetColumn(0, "RANK"    ));
	ds_cs.SetColumn(0, "ADDFT"   , ds_is.GetColumn(0, "ADDFT"   ));
	ds_cs.SetColumn(0, "ERDAT"   , ds_is.GetColumn(0, "ERDAT"   ));	
	ds_cs.SetColumn(0, "ADDF1"   , "0");
	ds_cs.SetColumn(0, "ADDF2"   , "0");
	ds_cs.SetColumn(0, "ADDF3"   , "0");

	if ( ds_is.RowCount() >0) {
		fn_query(); 
	}
} 

/********************************************************************************
* 기      능   : 조회 1
********************************************************************************/
function fn_query() {
	nsfRequest("query", "ssa0010/find_dtl", "ds_cs=ds_cs ds_is=ds_is", "ds_cs=ds_cs ds_itab=ds_itab ds_itab2=ds_itab2 ds_error=ds_error", "", "fn_afterQuery");

    fn_createWait("",this); // 처리중입니다. 메시지 처리
}

/********************************************************************************
* 기      능   : 저장
********************************************************************************/
function fn_save() {

	if(gfn_showConfirm("CI10003") == true) {		//저장하시겠습니까?

		if (ds_cs.GetRowCount()==0) {
			gfn_showAlert("CW00006", F_FRM_TITLE);
			return false;	//변경된 데이터가 없습니다
		} else {
			var pldat = ds_cs.GetColumn(0, "PLDAT"); // 생산예정일
			var chpdt = ds_cs.GetColumn(0, "CHPDT"); // 착공예정일
			
			if (pldat == null || pldat == "" || pldat == "00000000") ds_cs.SetColumn(0, "PLDAT", "0000-00-00"  );
			else                                                     ds_cs.SetColumn(0, "PLDAT", cal_pldat.Text);

			if (chpdt == null || chpdt == "" || chpdt == "00000000") ds_cs.SetColumn(0, "CHPDT", "0000-00-00"  );
			else                                                     ds_cs.SetColumn(0, "CHPDT", cal_chpdt.Text);

			for (var i=0; i<ds_itab.GetRowCount(); i++) {
				ds_itab.SetColumn(i, "FKDAT", grd_list.GetCellText("Body", i, 3));
				ds_itab.SetColumn(i, "CODAT", grd_list.GetCellText("Body", i, 4));
			}
			
			//요청사유
			ds_itab2.ClearData();
			for (var i=0; i<4; i++) {
				ds_itab2.InsertRow(i);
				ds_itab2.SetColumn(i, "TDFORMAT", "*");
				ds_itab2.SetColumn(i, "TDLINE", object("ed_tdline"+(i+1)).text);
			}

			ds_save.ClearData();
			ds_save.AddRow();
			ds_save.SetColumn(0, "GUBUN", "S"      );	//D:삭제, S:저장
			ds_save.SetColumn(0, "UNAME", G_USER_ID);
		//trace(ds_save.SaveXML()); trace(ds_cs.SaveXML()); trace(ds_itab.SaveXML());	trace(ds_itab2.SaveXML());

			nsfRequest("save", "ssa0010/update", "ds_save=ds_save ds_cs=ds_cs ds_itab=ds_itab ds_itab2=ds_itab2"
											   , "ds_cs=ds_cs ds_itab=ds_itab ds_itab2=ds_itab2 ds_error=ds_error", "", "fn_afterSave");
		}
	} else {
		return;
	}
}

/********************************************************************************
* 기      능   : 삭제
********************************************************************************/
function fn_delete() {

	if(gfn_showConfirm("삭제하시겠습니까?") == true) {

		if (ds_cs.GetRowCount()==0) {
			gfn_showAlert("CW00006", F_FRM_TITLE);
			return false;	//변경된 데이터가 없습니다
		} else {
			var pldat = ds_cs.GetColumn(0, "PLDAT"); // 생산예정일
			var chpdt = ds_cs.GetColumn(0, "CHPDT"); // 착공예정일
			
			if (pldat == null || pldat == "" || pldat == "00000000") ds_cs.SetColumn(0, "PLDAT", "0000-00-00"  );
			else                                                     ds_cs.SetColumn(0, "PLDAT", cal_pldat.Text);

			if (chpdt == null || chpdt == "" || chpdt == "00000000") ds_cs.SetColumn(0, "CHPDT", "0000-00-00"  );
			else                                                     ds_cs.SetColumn(0, "CHPDT", cal_chpdt.Text);

			for (var i=0; i<ds_itab.GetRowCount(); i++) {
				ds_itab.SetColumn(i, "FKDAT", grd_list.GetCellText("Body", i, 3));
				ds_itab.SetColumn(i, "CODAT", grd_list.GetCellText("Body", i, 4));
			}

			ds_save.ClearData();
			ds_save.AddRow();
			ds_save.SetColumn(0, "GUBUN", "D"      );
			ds_save.SetColumn(0, "UNAME", G_USER_ID);
		//trace(ds_save.SaveXML()); trace(ds_cs.SaveXML()); trace(ds_itab.SaveXML());	trace(ds_itab2.SaveXML());
	
			nsfRequest("save", "ssa0010/update", "ds_save=ds_save ds_cs=ds_cs ds_itab=ds_itab ds_itab2=ds_itab2"
											   , "ds_cs=ds_cs ds_itab=ds_itab ds_itab2=ds_itab2 ds_error=ds_error", "", "fn_afterSave");

		}
	} else {
		return;
	}
}

/********************************************************************************
* 기      능   : 승인
********************************************************************************/
function fn_approval() {

	ds_save.ClearData();
	ds_save.AddRow();
	ds_save.SetColumn(0, "UNAME", G_USER_ID);
	ds_save.SetColumn(0, "DOCU" , ds_is.GetColumn(0, "DOCU"));

	ds_approval.AddRow();
	ds_approval.SetColumn(0, "STATE" , ds_is.GetColumn(0, "STATE" ));
	ds_approval.SetColumn(0, "STATUS", ds_is.GetColumn(0, "STATUS"));
	ds_approval.SetColumn(0, "APDAT" , ds_is.GetColumn(0, "APDAT" ));
	ds_approval.SetColumn(0, "APTYP" , ds_is.GetColumn(0, "APTYP"));
//	trace(ds_approval.SaveXML());

	nsfRequest("approval", "ssa0010/approval", "ds_save=ds_save ds_approval=ds_approval", "ds_approval=ds_approval ds_error=ds_error", "", "fn_afterSave");
}

/********************************************************************************
* 기      능   : 취소
********************************************************************************/
function fn_cancel() {

	ds_save.ClearData();
	ds_save.AddRow();
	ds_save.SetColumn(0, "UNAME", G_USER_ID);
	ds_save.SetColumn(0, "DOCU" , ds_is.GetColumn(0, "DOCU"));

	ds_approval.AddRow();
	ds_approval.SetColumn(0, "STATE" , ds_is.GetColumn(0, "STATE" ));
	ds_approval.SetColumn(0, "STATUS", ds_is.GetColumn(0, "STATUS"));
	ds_approval.SetColumn(0, "APDAT" , ds_is.GetColumn(0, "APDAT" ));
	ds_approval.SetColumn(0, "APTYP" , ds_is.GetColumn(0, "APTYP"));
//	trace(ds_approval.SaveXML());

	nsfRequest("cancel", "ssa0010/cancel", "ds_save=ds_save ds_approval=ds_approval", "ds_approval=ds_approval ds_error=ds_error", "", "fn_afterSave");
}

/********************************************************************************
* 기      능   : 출력
********************************************************************************/
function fn_print() {

	// 문서번호 확인
	if(length(ed_docu.Text) == 0){
		gfn_showAlert("CW00208", "문서번호");	//[${}]은/는 필수입력 입니다. 확인바랍니다.
		ed_qtnum.SetFocus();
	   return false;
	}	

	var pldat = ds_cs.GetColumn(0, "PLDAT"); // 생산예정일
	
	if (pldat == null || pldat == "" || pldat == "00000000") ds_cs.SetColumn(0, "PLDAT", "0000-00-00"  );
	else                                                     ds_cs.SetColumn(0, "PLDAT", cal_pldat.Text);
	
	//요청사유
	ds_itab2.ClearData();
	for (var i=0; i<4; i++) {
		ds_itab2.InsertRow(i);
		ds_itab2.SetColumn(i, "TDFORMAT", "*");
		ds_itab2.SetColumn(i, "TDLINE", object("ed_tdline"+(i+1)).text);
	}
		
	nsfRequest("queryPrint", "ssa0010/print", "ds_cs=ds_cs", "ds_itab3=ds_itab3 ds_itab4=ds_itab4 ds_error=ds_error", "", "fn_afterPrint");
}

/********************************************************************************
* 기      능   : 닫기  
********************************************************************************/
function fn_close() {
	close();
}

/********************************************************************************
* 기      능   : 액셀  
********************************************************************************/
function fn_excel() {
}

//=========================================================================================
// [ PART 4]
// Callback 함수 정의 : callback 함수명은 메인 함수의 fn_xxxx() 에서 xxxx 부분은 fn_afterXXXX()
// 형태가 되도록 작성 
//=========================================================================================
/********************************************************************************
* 기      능   : 공통코드가 조회된 후의 Callback 함수 
********************************************************************************/
function fn_completeInit(sCode, sDsObj, sCodeType) {

	fn_init_form(); 	// 폼 초기화
}

/********************************************************************************
* 기      능   : 조회 Callback  
********************************************************************************/
function fn_afterQuery(svcId, errCode, errMsg) {

	fn_destroyWait();
//trace(ds_cs.SaveXML());
	if (svcId == "query") {
	
		var pldat = ds_cs.GetColumn(0, "PLDAT"); // 생산예정일
		var chpdt = ds_cs.GetColumn(0, "CHPDT"); // 착공예정일

		cal_pldat.Text = Replace(pldat, "-", "");
		cal_chpdt.Text = Replace(chpdt, "-", "");

		chk_addf1.Value = decode(ds_cs.GetColumn(0, "ADDF1"), "1", "1", "0");
		chk_addf2.Value = decode(ds_cs.GetColumn(0, "ADDF1"), "2", "1", "0");
		chk_addf3.Value = decode(ds_cs.GetColumn(0, "ADDF1"), "3", "1", "0");
		
		//요청사유
		if (ds_itab2.GetRowCount() > 0 ) {
			for (var i=0; i<ds_itab2.GetRowCount(); i++) {
				object("ed_tdline"+(i+1)).text = ds_itab2.GetColumn(i, "TDLINE");
			}
		}
	} 

	if (ds_error.rowcount() > 0) {
		gfn_showMsg("CE00001");
	} 
}

/********************************************************************************
* 기      능   : 저장 Callback
********************************************************************************/
function fn_afterSave(svcId, errCode, errMsg) {

	if (ds_error.rowcount > 0) {
		gfn_showAlert(ds_error.GetColumn(0, "ERRMSG"));
		Close();
		return false;
	}
	
	parent.fn_query();

	if (svcId == "save") {
		
		
		var pldat = ds_cs.GetColumn(0, "PLDAT"); // 생산예정일
		var chpdt = ds_cs.GetColumn(0, "CHPDT"); // 착공예정일

		cal_pldat.Text = Replace(pldat, "-", "");
		cal_chpdt.Text = Replace(chpdt, "-", "");
		
		Close();
	} else if (svcId == "approval") {
		if (ds_error.rowcount() > 0) {
			gfn_showAlert(ds_error.GetColumn(0,"ERRMSG"));
		} else {
			if (errCode != 0) gfn_showMsg("CE00001");
			else {
				gfn_showAlert("승인되었습니다.");
				gfn_showMsg("CI00002", ds_cs.RowCount() + "");
			}
		}
	} else if (svcId == "cancel") {
		if (ds_error.rowcount() > 0) {
			gfn_showAlert(ds_error.GetColumn(0,"ERRMSG"));
		} else {
			if (errCode != 0) gfn_showMsg("CE00001");
			else {
				gfn_showAlert("취소되었습니다.");
				gfn_showMsg("CI00002", ds_cs.RowCount() + "");
			}
		}
	}
}

/********************************************************************************
* 기      능   : 출력 Callback  
********************************************************************************/
function fn_afterPrint(svcId, errCode, errMsg) {

	fn_destroyWait();
	
//		trace(ds_itab4.savexml()); trace(ds_itab3.savexml());  trace(ds_itab.savexml()); trace(ds_itab2.savexml());

	var rowCnt = ds_itab3.GetRowCount() + 1;
	var fakwr  = ds_itab3.Sum("FAKWR");
	var hwbas  = ds_itab3.Sum("HWBAS");
	var cQnty  = ds_itab4.GetColumn(0, "CQNTY");

	var pRate = ds_cs.GetColumn("PRATE");
	var gRate = ds_cs.GetColumn("GRATE");

	if (pRate == null) pRate = 0;
	if (gRate == null) gRate = 0;

	pRate = pRate * fakwr;
	gRate = gRate * fakwr;

	var erdat = parent.ds_detail.GetColumn(0, "ERDAT");
	var arg =  "rowCnt=" + quote(rowCnt)
	         + " fakwr=" + quote(fakwr)
	         + " hwbas=" + quote(hwbas)
	         + " cQnty=" + quote(cQnty)
	         + " pRate=" + quote(pRate)
	         + " gRate=" + quote(gRate)
	         + " erdat=" + quote(erdat);
	
	Dialog("SSA::Ssa0012.xml", arg, -1, -1, "Resize=true");	// UbiReport Call


	if (ds_error.rowcount() > 0) {
		gfn_showMsg("CE00001");
	} 
}

//=========================================================================================
// [ PART 6 ]
// component Event 정의 : 각 Component 별 이벤트 
//=========================================================================================
/********************************************************************************
* 기      능   : 정렬 처리 
********************************************************************************/
function grd_list_OnHeadClick(obj,nCell,nX,nY,nPivotIndex) {
	if (nCell == 0) gfn_selectAllGrid(obj,nCell,nCell,true);
	else            gfn_sortGrid(obj, nCell);
}

/********************************************************************************
* 기      능   : 조회
********************************************************************************/
function fn_OnClick_btn(obj) {
	var fncName = "fn_" + substr(obj.id, 4); 
	eval( fncName + "()");
}
]]></Script>
</Window>