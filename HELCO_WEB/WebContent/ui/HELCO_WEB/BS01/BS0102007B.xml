<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="464" Id="BS0102007B" Left="8" OnLoadCompleted="fn_OnLoadCompleted" OnUnloadCompleted="fn_OnUnloadCompleted" PidAttrib="7" Title="견적승인판정&#32;기준" Top="8" Ver="1.0" Width="872" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_cond2">
				<Contents>
					<colinfo id="DEV" size="256" type="STRING"/>
					<colinfo id="GNM" size="256" type="STRING"/>
					<colinfo id="SPT" size="256" type="STRING"/>
					<colinfo id="TEL" size="256" type="STRING"/>
					<colinfo id="AD1" size="256" type="STRING"/>
					<colinfo id="AD2" size="256" type="STRING"/>
					<colinfo id="AGB" size="256" type="STRING"/>
					<colinfo id="PID" size="256" type="STRING"/>
					<colinfo id="PKY" size="256" type="STRING"/>
					<record>
						<AD1></AD1>
						<AD2></AD2>
						<AGB></AGB>
						<DEV></DEV>
						<GNM></GNM>
						<PID></PID>
						<PKY></PKY>
						<SPT></SPT>
						<TEL></TEL>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list2">
				<Contents>
					<colinfo id="GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="BS201_AGB" size="256" summ="default" type="STRING"/>
					<colinfo id="BS201_DEP" size="256" summ="default" type="STRING"/>
					<colinfo id="BS201_RDT" size="256" summ="default" type="STRING"/>
					<colinfo id="BS201_SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="BS201_SIR" size="256" summ="default" type="STRING"/>
					<colinfo id="BS201_AD1" size="300" summ="default" type="STRING"/>
					<colinfo id="BS201_AD2" size="300" summ="default" type="STRING"/>
					<colinfo id="BS201_EAM" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="BS201_DEV" size="256" summ="default" type="STRING"/>
					<colinfo id="BS201_GNM" size="300" summ="default" type="STRING"/>
					<colinfo id="BS201_QTY" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="BS201_SPT" size="300" summ="default" type="STRING"/>
					<colinfo id="BS201_TEL" size="90" summ="default" type="STRING"/>
					<colinfo id="BS201_PID" size="256" summ="default" type="STRING"/>
					<colinfo id="BS201_JRT" size="256" summ="default" type="STRING"/>
					<colinfo id="BS201_PST" size="256" summ="default" type="STRING"/>
					<colinfo id="BS201_NCD" size="256" summ="default" type="STRING"/>
					<colinfo id="BS201_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="BS201_ADT" size="256" summ="default" type="STRING"/>
					<colinfo id="BS201_CID" size="256" summ="default" type="STRING"/>
					<colinfo id="BS201_GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="BS203_COMA" size="256" summ="default" type="STRING"/>
					<colinfo id="PKY" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="FLAG" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ncd">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_jrt">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list3">
				<Contents>
					<colinfo id="BS201_PST" size="60" summ="default" type="STRING"/>
					<colinfo id="BS201_DEP" size="256" summ="default" type="STRING"/>
					<colinfo id="BS201_RDT" size="18" summ="default" type="STRING"/>
					<colinfo id="BS201_SEQ" size="15" summ="default" type="STRING"/>
					<colinfo id="BS201_SIR" size="256" summ="default" type="STRING"/>
					<colinfo id="BS201_NCD" size="300" summ="default" type="STRING"/>
					<colinfo id="FLAG2" size="256" summ="default" type="STRING"/>
					<colinfo id="FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="BS201_JRT" size="256" summ="default" type="STRING"/>
					<colinfo id="BS201_DEL" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list4">
				<Contents>
					<colinfo id="BS201_PST" size="60" summ="default" type="STRING"/>
					<colinfo id="BS201_DEP" size="256" summ="default" type="STRING"/>
					<colinfo id="BS201_RDT" size="18" summ="default" type="STRING"/>
					<colinfo id="BS201_SEQ" size="15" summ="default" type="STRING"/>
					<colinfo id="BS201_SIR" size="256" summ="default" type="STRING"/>
					<colinfo id="BS201_NCD" size="300" summ="default" type="STRING"/>
					<colinfo id="FLAG2" size="256" summ="default" type="STRING"/>
					<colinfo id="FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="BS201_JRT" size="256" summ="default" type="STRING"/>
					<colinfo id="BS201_DEL" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
		</Datasets>
		<Shape BKColor="user12" Bottom="69" Height="26" Id="Shape7" Left="7" LineColor="user13" Right="863" TabOrder="3" Top="43" Type="Rectangle" Width="856"></Shape>
		<Grid AutoFitEndLine="Hide" BindDataset="ds_list2" BkColor2="default" BoldHead="true" Border="Flat" Bottom="457" ColSizing="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="382" Id="grd_list2" InputPanel="FALSE" Left="7" LineColor="user20" LineType="ExHORZ" OnHeadClick="grd_list2_OnHeadClick" Right="863" RowHeight="20" Style="sty_grid" TabOrder="1" TabStop="true" Top="75" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="856">
			<contents>
				<format id="Default">
					<columns>
						<col width="30"/>
						<col width="20"/>
						<col width="50"/>
						<col width="50"/>
						<col width="50"/>
						<col width="100"/>
						<col width="100"/>
						<col width="110"/>
						<col width="100"/>
						<col width="80"/>
						<col width="90"/>
						<col width="220"/>
						<col width="100"/>
						<col width="60"/>
						<col width="60"/>
						<col width="80"/>
						<col width="60"/>
						<col width="60"/>
						<col width="70"/>
					</columns>
					<head>
						<cell align="center" col="0" color="user21" display="text" font="굴림,9" text="NO"/>
						<cell align="center" col="1" color="user21" display="text" font="굴림,9"/>
						<cell align="center" col="2" color="user21" display="text" font="굴림,9" text="견적구분"/>
						<cell align="center" col="3" color="user21" display="text" font="굴림,9" text="구분"/>
						<cell align="center" col="4" color="user21" display="text" font="굴림,9" text="제품구분"/>
						<cell align="center" col="5" color="user21" display="text" font="굴림,9" text="시행사"/>
						<cell align="center" col="6" color="user21" display="text" font="굴림,9" text="발주처"/>
						<cell align="center" col="7" color="user21" display="text" font="굴림,9" text="공사명"/>
						<cell align="center" col="8" color="user21" display="text" font="굴림,9" text="견적요청담당자"/>
						<cell align="center" col="9" color="user21" display="text" font="굴림,9" text="면담자"/>
						<cell align="center" col="10" color="user21" display="text" font="굴림,9" text="현장연락처"/>
						<cell align="center" col="11" color="user24" display="text" font="굴림,9" text="주소"/>
						<cell align="center" col="12" color="user24" display="text" font="굴림,9" text="상세주소"/>
						<cell align="center" col="13" color="user21" display="text" font="굴림,9" text="판정결과"/>
						<cell align="center" col="14" color="user21" display="text" font="굴림,9" text="진행상태"/>
						<cell align="center" col="15" color="user21" display="text" font="굴림,9" text="불가사유"/>
						<cell align="center" col="16" color="user21" display="text" font="굴림,9" text="승인번호"/>
						<cell align="center" col="17" color="user21" display="text" font="굴림,9" text="낙찰사"/>
						<cell align="center" col="18" color="user21" display="text" font="굴림,9" text="판정일자"/>
					</head>
					<body>
						<cell align="center" bkcolor2="user22" col="0" colid="BS201_GNM" color="expr:decode(CHK,true,&apos;red&apos;,&apos;default&apos;)" display="text" expr="CURROW+1"/>
						<cell align="center" col="1" colid="CHK" color="expr:decode(CHK,true,&apos;red&apos;,&apos;default&apos;)" display="checkbox"/>
						<cell align="center" bkcolor2="user22" col="2" colid="BS201_AGB" color="expr:decode(CHK,true,&apos;red&apos;,&apos;default&apos;)" display="text"/>
						<cell align="center" bkcolor2="user22" col="3" colid="GBN" color="expr:decode(CHK,true,&apos;red&apos;,&apos;default&apos;)" display="text"/>
						<cell align="center" bkcolor2="user22" col="4" colid="BS201_GBN" color="expr:decode(CHK,true,&apos;red&apos;,&apos;default&apos;)" display="text"/>
						<cell bkcolor2="user22" col="5" colid="BS201_DEV" color="expr:decode(CHK,true,&apos;red&apos;,&apos;default&apos;)" display="text"/>
						<cell bkcolor2="user22" col="6" colid="BS201_GNM" color="expr:decode(CHK,true,&apos;red&apos;,&apos;default&apos;)" display="text"/>
						<cell bkcolor2="user22" col="7" colid="BS201_SPT" color="expr:decode(CHK,true,&apos;red&apos;,&apos;default&apos;)" display="text"/>
						<cell align="center" bkcolor2="user22" col="8" colid="BS201_CID" color="expr:decode(CHK,true,&apos;red&apos;,&apos;default&apos;)" display="text"/>
						<cell bkcolor2="user22" col="9" colid="BS201_PID" color="expr:decode(CHK,true,&apos;red&apos;,&apos;default&apos;)" display="text"/>
						<cell bkcolor2="user22" col="10" colid="BS201_TEL" color="expr:decode(CHK,true,&apos;red&apos;,&apos;default&apos;)" display="text"/>
						<cell bkcolor2="user22" col="11" colid="BS201_AD1" color="expr:decode(CHK,true,&apos;red&apos;,&apos;default&apos;)" display="text"/>
						<cell bkcolor2="user22" col="12" colid="BS201_AD2" color="expr:decode(CHK,true,&apos;red&apos;,&apos;default&apos;)" display="text"/>
						<cell align="center" bkcolor2="user22" col="13" colid="BS201_JRT" color="expr:decode(CHK,true,&apos;red&apos;,&apos;default&apos;)" display="text"/>
						<cell align="center" bkcolor2="user22" col="14" colid="BS201_PST" color="expr:decode(CHK,true,&apos;red&apos;,&apos;default&apos;)" display="text"/>
						<cell align="center" bkcolor2="user22" col="15" colid="BS201_NCD" color="expr:decode(CHK,true,&apos;red&apos;,&apos;default&apos;)" display="text"/>
						<cell align="center" bkcolor2="user22" col="16" colid="BS201_NO" color="expr:decode(CHK,true,&apos;red&apos;,&apos;default&apos;)" display="text"/>
						<cell align="center" bkcolor2="user22" col="17" colid="BS203_COMA" color="expr:decode(CHK,true,&apos;red&apos;,&apos;default&apos;)" display="text"/>
						<cell align="center" bkcolor2="user22" col="18" colid="BS201_ADT" color="expr:decode(CHK,true,&apos;red&apos;,&apos;default&apos;)" display="text" Mask="####.##.##"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Div Height="36" Id="div_btn" TabOrder="2" Text="Div0" Url="WB01::CommBtnForm.xml" Width="872">
			<Contents></Contents>
		</Div>
		<Static Align="Right" Height="24" Id="st_jrt" Left="8" Style="sty_lb_form_basic" TabOrder="4" Text="판정결과&#32;" Top="44" VAlign="Middle" Width="100"></Static>
		<Combo Border="Flat" CodeColumn="CODE" DataColumn="CODE_NAME" Height="20" Id="cb_jrt" InnerDataset="ds_jrt" Left="110" OnChanged="cb_jrt_OnChanged" Style="sty_ipt_form" TabOrder="5" Top="45" Width="107"></Combo>
		<Static Align="Right" Height="24" Id="st_ncd" Left="224" Style="sty_lb_form_basic" TabOrder="6" Text="불가사유&#32;" Top="44" VAlign="Middle" Width="100"></Static>
		<Combo Border="Flat" CodeColumn="CODE" DataColumn="CODE_NAME" Height="20" Id="cb_ncd" InnerDataset="ds_ncd" Left="326" Style="sty_ipt_form" TabOrder="7" Top="45" Width="107"></Combo>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_sub_save" ImageID="btn_sub_02" Left="812" LeftMargin="12" OnClick="btn_sub_save_OnClick" Style="sty_btn" TabOrder="8" Text="저장" Top="46" Transparent="TRUE" Width="50"></Button>
		<Static Height="18" Id="st_cond" Left="128" TabOrder="9" Text="조회조건을&#32;하나이상" Top="520" Visible="FALSE" Width="81"></Static>
		<Static Height="16" Id="st_panguyl" Left="216" TabOrder="10" Text="판정결과" Top="520" Visible="FALSE" Width="56"></Static>
		<Static Height="13" Id="st_bulga" Left="272" TabOrder="11" Text="불가" Top="520" Visible="FALSE" Width="40"></Static>
		<Static Height="16" Id="Static0" Left="304" TabOrder="12" Text="불가사유" Top="520" Visible="FALSE" Width="80"></Static>
		<Static Height="13" Id="st_param" Left="360" TabOrder="13" Text="저장할" Top="520" Visible="FALSE" Width="40"></Static>
		<Static Height="13" Id="st_pst" Left="408" TabOrder="14" Text="진행상태" Top="520" Visible="FALSE" Width="50"></Static>
	</Form>
	<Script><![CDATA[﻿﻿﻿﻿﻿﻿﻿﻿/*
 ******************************************************************************************
 * 기      능   : 
 * 작  성  자   : 
 * 작성  일자   : 
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
#include "LIB::commons.js";	// 공통 스크립트 
#include "LIB::utility.js";	// 다중 선택 
//=========================================================================================
// [ PART 1 ]
// Form에서 사용될 전역변수를 선언
// FORM에서 사용되는 전역변수는 대문자로 작성하며, F_XXX 의 형태를 갖도록 한다. 
//=========================================================================================

//=========================================================================================
// [ PART 2 ]
// Form Loading / Unloading 시 작업 정의
//=========================================================================================
function fn_OnLoadCompleted(obj) {
	gfn_initForm();

	var codeArr = ["BS112","BS103"];
	var dsObjArr = [ds_ncd,ds_jrt];
	var addTypeArr = [G_CODE_SELECT,G_CODE_SELECT];
	gfn_searchCommCode(codeArr, dsObjArr, addTypeArr);

	ds_cond2.SetColumn(0,"DEV",ds_list.GetColumn(ds_list.row,"BS201_DEV"));
	ds_cond2.SetColumn(0,"GNM",ds_list.GetColumn(ds_list.row,"BS201_GNM"));
	ds_cond2.SetColumn(0,"SPT",ds_list.GetColumn(ds_list.row,"BS201_SPT"));

	if(ds_list.GetColumn(ds_list.row,"BS201_TEL") == '')
		ds_cond2.SetColumn(0,"TEL","전화번호없음");
	else
		ds_cond2.SetColumn(0,"TEL",ds_list.GetColumn(ds_list.row,"BS201_TEL"));

	ds_cond2.SetColumn(0,"AD1",ds_list.GetColumn(ds_list.row,"BS201_AD1"));
	ds_cond2.SetColumn(0,"AD2",ds_list.GetColumn(ds_list.row,"BS201_AD2"));
	ds_cond2.SetColumn(0,"AGB",agb);
	ds_cond2.SetColumn(0,"PID",ds_list.GetColumn(ds_list.row,"BS201_PID"));
	ds_cond2.SetColumn(0,"PKY",ds_list.GetColumn(ds_list.row,"PKY"));

	fn_query();
}
/********************************************************************************
* 기      능   : form UnloadCompleted 
********************************************************************************/
function fn_OnUnloadCompleted(obj) {
	return gfn_isFormUnload(obj);
}

/********************************************************************************
* 기      능   : 공통코드가 조회된 후의 Callback 함수 
********************************************************************************/
function fn_completeInit(sCode, sDsObj, sCodeType) {
	if(length(trim(jrt)) > 0) {
		cb_jrt.Value = jrt;
	} else {
		cb_jrt.Index = 0;
	}

	if(length(trim(ncd)) > 0) {
		cb_ncd.Value = ncd;
		cb_ncd.Enable = true;
	} else {
		cb_ncd.Index = 0;
		cb_ncd.Enable = false;
	}
}

//=========================================================================================
// [ PART 3 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,form닫기)
//=========================================================================================
/********************************************************************************
* 기      능   : 조회 
********************************************************************************/
function fn_query() {
	tit_clearActionInfo();
	tit_addSearchActionInfo("bs01:BS0102007B_S1");

	tit_callService(
        ""
        , ""
        , "ds_cond2=ds_cond2"
        , "ds_list2=ds_list2"
        , ""
        , "fn_afterQuery"
        , true
        , true);
}
/********************************************************************************
* 기      능   : 조회 Callback  
********************************************************************************/
function fn_afterQuery(errCode, errMsg) {
	gfn_showMsg("CI00002",ds_list2.RowCount()+"");
}
/********************************************************************************
* 기      능   : 닫기  
********************************************************************************/
function fn_close() {
	close();
}
//=========================================================================================
// [ PART 4]
// Callback 함수 정의 : callback 함수명은 메인 함수의 fn_xxxx() 에서 xxxx 부분은 fn_afterXXXX()
// 형태가 되도록 작성 
//=========================================================================================

/********************************************************************************
* 기      능   : 액셀  
********************************************************************************/
function fn_excel() {
	gfn_saveToExcel(grd_list2, true);
}

function cb_jrt_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex) {
	if(cb_jrt.Value == "20") { //불가
		cb_ncd.Enable = true;
	} else { //승인
		cb_ncd.Index = 0;
		cb_ncd.Enable = false;
	}
}

function btn_sub_save_OnClick(obj) {
	gfn_clearMsgBar();

	var userGroup = gfn_getUserGroup();

	for(var i=0; i<ds_list2.rowcount; i++) {
		if(ds_list2.GetColumn(i,"FLAG") == 'U') {
			if(length(trim(cb_jrt.Value)) == 0) {
				gfn_showMsg("CW00001", st_jrt.value);
				return;
			} else if(cb_jrt.Value == '20' && length(trim(cb_ncd.Value)) == 0) {
				var arr = [st_panguyl.value, st_bulga.value, st_ncd.value];
				gfn_showMsg("CW00144", arr);
				return;
			}
//alert(" sgbn ==> [" + sgbn + "]\n agb ==> [" + agb + "]\n userGroup ==> [" + userGroup + "]\n pst ==> [" + pst + "]");
			if(sgbn == 'A') { //대리점
				if(userGroup == '10' || userGroup == '20') {
					gfn_showAlert("현재 프로그램을 사용하실수 없습니다.");
					return;
				}

				if(userGroup == '30' && pst <> '15' && pst <> '20') {
					gfn_showAlert("진행상태를 확인하시기 바랍니다.");
					return;
				}

				if(userGroup == '40' && pst <> '20') {
					gfn_showAlert("진행상태를 확인하시기 바랍니다.");
					return;
				}
			} else { //본팀
				if(userGroup == '10' || userGroup == '20') {
					gfn_showAlert("현재 프로그램을 사용하실수 없습니다.");
					return;
				}

				if(userGroup == '30' && pst <> '25' && pst <> '30') {
					gfn_showAlert("진행상태를 확인하시기 바랍니다.");
					return;
				}

				if(userGroup == '40' && pst <> '30') {
					gfn_showAlert("진행상태를 확인하시기 바랍니다.");
					return;
				}
			}

			if(sgbn == 'A') { //대리점
				if(userGroup == '30' && (pst == 15 || pst == 20)) {
					var rows = ds_list3.AddRow();
					if(agb == 'A') { //실행가
						ds_list3.SetColumn(rows,"BS201_PST","20");
					} else { //예산가
						ds_list3.SetColumn(rows,"BS201_PST","30");
					}
					ds_list3.SetColumn(rows,"BS201_JRT",cb_jrt.Value);
					ds_list3.SetColumn(rows,"BS201_NCD",cb_ncd.Value);
					ds_list3.SetColumn(rows,"BS201_DEP",ds_list2.GetColumn(i,"BS201_DEP"));
					ds_list3.SetColumn(rows,"BS201_RDT",ds_list2.GetColumn(i,"BS201_RDT"));
					ds_list3.SetColumn(rows,"BS201_SEQ",ds_list2.GetColumn(i,"BS201_SEQ"));
					ds_list3.SetColumn(rows,"BS201_SIR",ds_list2.GetColumn(i,"BS201_SIR"));
					ds_list3.SetColumn(rows,"FLAG",ds_list2.GetColumn(i,"FLAG"));
	
					if(agb == 'B') { // 예산가
						var rows = ds_list4.AddRow();
						ds_list4.SetColumn(rows,"BS201_PST","30");
						ds_list4.SetColumn(rows,"BS201_JRT",cb_jrt.Value);
						ds_list4.SetColumn(rows,"BS201_NCD",cb_ncd.Value);
						ds_list4.SetColumn(rows,"BS201_DEP",ds_list2.GetColumn(i,"BS201_DEP"));
						ds_list4.SetColumn(rows,"BS201_RDT",ds_list2.GetColumn(i,"BS201_RDT"));
						ds_list4.SetColumn(rows,"BS201_SEQ",ds_list2.GetColumn(i,"BS201_SEQ"));
						ds_list4.SetColumn(rows,"BS201_SIR",ds_list2.GetColumn(i,"BS201_SIR"));
						ds_list4.SetColumn(rows,"FLAG",ds_list2.GetColumn(i,"FLAG"));
					}
				} else if(userGroup == '40' && pst == 20) {
					var rows = ds_list4.AddRow();
					ds_list4.SetColumn(rows,"BS201_PST","30");
					ds_list4.SetColumn(rows,"BS201_JRT",cb_jrt.Value);
					ds_list4.SetColumn(rows,"BS201_NCD",cb_ncd.Value);
					ds_list4.SetColumn(rows,"BS201_DEP",ds_list2.GetColumn(i,"BS201_DEP"));
					ds_list4.SetColumn(rows,"BS201_RDT",ds_list2.GetColumn(i,"BS201_RDT"));
					ds_list4.SetColumn(rows,"BS201_SEQ",ds_list2.GetColumn(i,"BS201_SEQ"));
					ds_list4.SetColumn(rows,"BS201_SIR",ds_list2.GetColumn(i,"BS201_SIR"));
					ds_list4.SetColumn(rows,"FLAG",ds_list2.GetColumn(i,"FLAG"));
				}
				else return;
			} else { //본팀
				if(userGroup == '30' && (pst == 25 || pst == 30)) {
					var rows = ds_list3.AddRow();
					if(agb == 'A') { //실행가
						ds_list3.SetColumn(rows,"BS201_PST","30");
					} else { //예산가
						ds_list3.SetColumn(rows,"BS201_PST","35");
					}
					ds_list3.SetColumn(rows,"BS201_JRT",cb_jrt.Value);
					ds_list3.SetColumn(rows,"BS201_NCD",cb_ncd.Value);
					ds_list3.SetColumn(rows,"BS201_DEP",ds_list2.GetColumn(i,"BS201_DEP"));
					ds_list3.SetColumn(rows,"BS201_RDT",ds_list2.GetColumn(i,"BS201_RDT"));
					ds_list3.SetColumn(rows,"BS201_SEQ",ds_list2.GetColumn(i,"BS201_SEQ"));
					ds_list3.SetColumn(rows,"BS201_SIR",ds_list2.GetColumn(i,"BS201_SIR"));
					ds_list3.SetColumn(rows,"FLAG",ds_list2.GetColumn(i,"FLAG"));
	
					if(agb == 'B') { // 예산가
						var rows = ds_list4.AddRow();
						ds_list4.SetColumn(rows,"BS201_PST","35");
						ds_list4.SetColumn(rows,"BS201_JRT",cb_jrt.Value);
						ds_list4.SetColumn(rows,"BS201_NCD",cb_ncd.Value);
						ds_list4.SetColumn(rows,"BS201_DEP",ds_list2.GetColumn(i,"BS201_DEP"));
						ds_list4.SetColumn(rows,"BS201_RDT",ds_list2.GetColumn(i,"BS201_RDT"));
						ds_list4.SetColumn(rows,"BS201_SEQ",ds_list2.GetColumn(i,"BS201_SEQ"));
						ds_list4.SetColumn(rows,"BS201_SIR",ds_list2.GetColumn(i,"BS201_SIR"));
						ds_list4.SetColumn(rows,"FLAG",ds_list2.GetColumn(i,"FLAG"));
					}
				} else if(userGroup == '40' && pst == 30) {
					var rows = ds_list4.AddRow();
					ds_list4.SetColumn(rows,"BS201_PST","35");
					ds_list4.SetColumn(rows,"BS201_JRT",cb_jrt.Value);
					ds_list4.SetColumn(rows,"BS201_NCD",cb_ncd.Value);
					ds_list4.SetColumn(rows,"BS201_DEP",ds_list2.GetColumn(i,"BS201_DEP"));
					ds_list4.SetColumn(rows,"BS201_RDT",ds_list2.GetColumn(i,"BS201_RDT"));
					ds_list4.SetColumn(rows,"BS201_SEQ",ds_list2.GetColumn(i,"BS201_SEQ"));
					ds_list4.SetColumn(rows,"BS201_SIR",ds_list2.GetColumn(i,"BS201_SIR"));
					ds_list4.SetColumn(rows,"FLAG",ds_list2.GetColumn(i,"FLAG"));
				}
				else return;
			}
		}
	}

	tit_clearActionInfo();

	if(sgbn == "A") { //대리점
		tit_addSaveActionInfo(
			""
			, "bs01:BS0102007A_U1"
			, ""
			, "FLAG"
			, ""
			, -1
			, "");

		tit_addSaveActionInfo(
			""
			, "bs01:BS0102007A_U2"
			, ""
			, "FLAG"
			, ""
			, -1
			, "");
	} else { //본팀
		tit_addSaveActionInfo(
			""
			, "bs01:BS0102007A_U4"
			, ""
			, "FLAG"
			, ""
			, -1
			, "");

		tit_addSaveActionInfo(
			""
			, "bs01:BS0102007A_U5"
			, ""
			, "FLAG"
			, ""
			, -1
			, "");

		if(userGroup == "30") {
			tit_addSelectExActionInfo("bs01:BS0102007A_S6", "bs01:BS0102007A_I1", "bs01:BS0102007A_U6");
		} else if(userGroup == "40") {
			tit_addSelectExActionInfo("bs01:BS0102007A_S7", "bs01:BS0102007A_I2", "bs01:BS0102007A_U7");
		}
	}

	tit_callService(
		""
		, ""
		, "ds_list1=ds_list3:A ds_list2=ds_list4:A"
		, ""
		, ""
		, "fn_afterSave");
}

/********************************************************************************
* 기      능   : 저장 Callback
********************************************************************************/
function fn_afterSave(errCode, errMsg) {
	if(errCode != 0) {
		gfn_showMsg("CE00001");
	} else {
		gfn_showMsg("CI00003");
		close();
	}
}

function grd_list2_OnHeadClick(obj,nCell,nX,nY,nPivotIndex) {
	gfn_sortGrid(obj,nCell);
}
]]></Script>
</Window>