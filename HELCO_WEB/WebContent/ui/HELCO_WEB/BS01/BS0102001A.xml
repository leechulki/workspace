<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="580" Id="BS0102001A" Left="8" OnLoadCompleted="fn_OnLoadCompleted" OnUnloadCompleted="fn_OnUnloadCompleted" PidAttrib="7" Title="견적승인의뢰&#32;등록" Top="8" Ver="1.0" Width="778" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_cond2">
				<Contents>
					<colinfo id="GNO" size="256" summ="default" type="STRING"/>
					<colinfo id="RDT" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="SIR" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN" size="256" summ="default" type="STRING"/>
					<record>
						<GBN></GBN>
						<GNO></GNO>
						<RDT></RDT>
						<SEQ></SEQ>
						<SIR></SIR>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_sukum">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_typ">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_head">
				<Contents>
					<colinfo id="BS201_AD1" size="300" summ="default" type="STRING"/>
					<colinfo id="BS201_AD2" size="300" summ="default" type="STRING"/>
					<colinfo id="BS201_CDT" size="24" summ="default" type="STRING"/>
					<colinfo id="BS201_CID" size="30" summ="default" type="STRING"/>
					<colinfo id="BS201_EAM" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="BS201_FCD" size="6" summ="default" type="STRING"/>
					<colinfo id="BS201_FRT" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="BS201_DEV" size="256" summ="default" type="STRING"/>
					<colinfo id="BS201_GNM" size="300" summ="default" type="STRING"/>
					<colinfo id="BS201_LCD" size="6" summ="default" type="STRING"/>
					<colinfo id="BS201_LDT" size="24" summ="default" type="STRING"/>
					<colinfo id="BS201_LRT" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="BS201_MCD" size="6" summ="default" type="STRING"/>
					<colinfo id="BS201_MRT" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="BS201_PST" size="6" summ="default" type="STRING"/>
					<colinfo id="BS201_RDT" size="18" summ="default" type="STRING"/>
					<colinfo id="BS201_T01" size="256" summ="default" type="STRING"/>
					<colinfo id="BS201_T02" size="256" summ="default" type="STRING"/>
					<colinfo id="BS201_T03" size="256" summ="default" type="STRING"/>
					<colinfo id="BS201_T04" size="256" summ="default" type="STRING"/>
					<colinfo id="BS201_T05" size="256" summ="default" type="STRING"/>
					<colinfo id="BS201_RMK" size="600" summ="default" type="STRING"/>
					<colinfo id="BS201_SEQ" size="15" summ="default" type="STRING"/>
					<colinfo id="BS201_SIR" size="256" summ="default" type="STRING"/>
					<colinfo id="BS201_SPT" size="300" summ="default" type="STRING"/>
					<colinfo id="BS201_TEL" size="90" summ="default" type="STRING"/>
					<colinfo id="BS201_ZIP" size="18" summ="default" type="STRING"/>
					<colinfo id="NAME1" size="105" summ="default" type="STRING"/>
					<colinfo id="BS201_QTY" size="256" summ="default" type="STRING"/>
					<colinfo id="BS201_OAM" size="256" summ="default" type="STRING"/>
					<colinfo id="BS201_RAT" size="256" summ="default" type="STRING"/>
					<colinfo id="BS201_PID" size="256" summ="default" type="STRING"/>
					<colinfo id="BS201_GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="BS201_AGB" size="256" summ="default" type="STRING"/>
					<colinfo id="BS201_USE" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list2">
				<Contents>
					<colinfo id="BS201_RDT" size="256" summ="default" type="STRING"/>
					<colinfo id="BS201_SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="BS201_SIR" size="256" summ="default" type="STRING"/>
					<colinfo id="BS202_SPC" size="256" summ="default" type="STRING"/>
					<colinfo id="BS202_TYP" size="256" summ="default" type="STRING"/>
					<colinfo id="BS202_USE" size="256" summ="default" type="STRING"/>
					<colinfo id="BS202_MAN" size="256" summ="default" type="STRING"/>
					<colinfo id="BS202_OPN" size="256" summ="default" type="STRING"/>
					<colinfo id="BS202_SPD" size="256" summ="default" type="STRING"/>
					<colinfo id="BS202_STP" size="256" summ="default" type="STRING"/>
					<colinfo id="BS202_RAT" size="256" summ="default" type="STRING"/>
					<colinfo id="BS202_RMK" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_userp">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_gbn2">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_desc">
				<Contents>
					<colinfo id="DESC" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_gbn3">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME>-&#32;선택&#32;-</CODE_NAME>
					</record>
					<record>
						<CODE>A</CODE>
						<CODE_NAME>실행가</CODE_NAME>
					</record>
					<record>
						<CODE>B</CODE>
						<CODE_NAME>예산가</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_use">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_man">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_opn">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_spd">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_buse">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
		</Datasets>
		<Shape BKColor="user12" Bottom="66" Height="26" Id="Shape1" Left="8" LineColor="user13" Right="770" TabOrder="2" Top="40" Type="Rectangle" Width="762"></Shape>
		<Shape BKColor="user12" Bottom="91" Height="26" Id="Shape2" Left="8" LineColor="user13" Right="770" TabOrder="3" Top="65" Type="Rectangle" Width="762"></Shape>
		<Static Align="Right" Height="24" Id="Static4" Left="9" Style="sty_lb_form_basic" TabOrder="4" Text="대리점명&#32;" Top="41" VAlign="Middle" Width="95"></Static>
		<Static Align="Right" Height="24" Id="Static11" Left="309" Style="sty_lb_form_basic" TabOrder="6" Text="견적요청등록일&#32;" Top="41" VAlign="Middle" Width="95"></Static>
		<Static Align="Right" Height="24" Id="Static14" Left="564" Style="sty_lb_form_basic" TabOrder="7" Text="견적요청담당자&#32;" Top="41" VAlign="Middle" Width="95"></Static>
		<Edit BindDataset="ds_head" Border="Flat" Column="NAME1" Enable="FALSE" Height="20" Id="ed_name1" Left="106" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="5" Top="43" Width="200"></Edit>
		<Edit BindDataset="ds_head" Border="Flat" CheckLength="Byte" Column="BS201_PID" Height="20" Id="ed_pid" ImeMode="native" Left="660" LeftMargin="4" MaxLength="10" RightMargin="4" Style="sty_ipt_form" TabOrder="13" Top="68" Width="107"></Edit>
		<Static Align="Right" Height="24" Id="st_tel" Left="564" Style="sty_lb_form_basic" TabOrder="11" Text="면담자&#32;" Top="66" VAlign="Middle" Width="95"></Static>
		<Edit BindDataset="ds_head" Border="Flat" Column="BS201_SPT" Height="20" Id="ed_spt" Left="406" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="12" Top="68" Width="155"></Edit>
		<Static Align="Right" Height="24" Id="st_spt" Left="309" Style="sty_lb_form_basic" TabOrder="10" Text="공사명&#32;" Top="66" VAlign="Middle" Width="95"></Static>
		<Edit BindDataset="ds_head" Border="Flat" Column="BS201_GNM" Height="20" Id="ed_gnm" Left="106" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="9" Top="68" Width="200"></Edit>
		<Static Align="Right" Height="24" Id="st_gnm" Left="9" Style="sty_lb_form_basic" TabOrder="8" Text="발주처&#32;" Top="66" VAlign="Middle" Width="95"></Static>
		<Shape BKColor="user12" Bottom="116" Height="26" Id="Shape0" Left="8" LineColor="user13" Right="770" TabOrder="14" Top="90" Type="Rectangle" Width="762"></Shape>
		<Static Align="Right" Height="24" Id="Static3" Left="9" Style="sty_lb_form_basic" TabOrder="15" Text="현장주소&#32;" Top="91" VAlign="Middle" Width="95"></Static>
		<Button Cursor="HAND" Height="18" Id="btn_zipcode2" ImageID="btn_icon_search" Left="167" OnClick="Button1_OnClick" TabOrder="16" Text="Button0" Top="94" Transparent="TRUE" Width="18"></Button>
		<Edit BindDataset="ds_head" Border="Flat" CheckLength="Byte" Column="BS201_AD1" Height="20" Id="ed_addr" Left="186" MaxLength="100" Readonly="TRUE" Style="sty_ipt_form" TabOrder="17" Top="93" Width="275"></Edit>
		<Edit BindDataset="ds_head" Border="Flat" CheckLength="Byte" Column="BS201_AD2" Height="20" Id="ed_addrdetail2" Left="463" MaxLength="100" Style="sty_ipt_form" TabOrder="18" Top="93" Width="99"></Edit>
		<Image Height="19" Id="Image0" ImageID="form_bl_title_sub" Left="8" TabOrder="19" Top="168" Width="11"></Image>
		<Static Color="user6" Font="굴림,9,Bold" Height="20" Id="Static19" Left="21" TabOrder="20" Text="수금조건율" Top="169" VAlign="Middle" Width="254"></Static>
		<Grid AutoEnter="TRUE" AutoFit="TRUE" AutoFitEndLine="Hide" BindDataset="ds_head" BkColor2="default" BoldHead="true" Border="Flat" Bottom="233" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="43" Id="grd_head" InputPanel="FALSE" Left="8" LineColor="user20" LineType="ExHORZ" MinWidth="100" OnExpandEdit="grd_head_OnExpandEdit" Right="770" RowHeight="20" Style="sty_grid" TabOrder="21" TabStop="true" Top="190" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="762">
			<contents>
				<format id="Default">
					<columns>
						<col width="110"/>
						<col width="110"/>
						<col width="110"/>
						<col width="110"/>
						<col width="110"/>
						<col width="110"/>
						<col width="100"/>
					</columns>
					<head>
						<cell align="center" col="0" color="user21" display="text" font="굴림,9" text="(선수금)수금조건"/>
						<cell align="center" col="1" color="user21" display="text" font="굴림,9" text="(선수금)수금율(%)"/>
						<cell align="center" col="2" color="user21" display="text" font="굴림,9" text="(중도금)수금조건"/>
						<cell align="center" col="3" color="user21" display="text" font="굴림,9" text="(중도금)수금율(%)"/>
						<cell align="center" col="4" color="user21" display="text" font="굴림,9" text="(잔금)수금조건"/>
						<cell align="center" col="5" color="user21" display="text" font="굴림,9" text="(잔금)수금율(%)"/>
						<cell align="center" col="6" color="user21" display="text" font="굴림,9" text="납기일자"/>
					</head>
					<body>
						<cell align="right" bkcolor2="user22" col="0" colid="BS201_FCD" combocol="CODE" combodataset="ds_sukum" combotext="CODE_NAME" display="combo" edit="combo"/>
						<cell align="right" bkcolor2="user22" col="1" colid="BS201_FRT" display="number" edit="number"/>
						<cell align="right" bkcolor2="user22" col="2" colid="BS201_MCD" combocol="CODE" combodataset="ds_sukum" combotext="CODE_NAME" display="combo" edit="combo"/>
						<cell align="right" bkcolor2="user22" col="3" colid="BS201_MRT" display="number" edit="number"/>
						<cell align="right" bkcolor2="user22" col="4" colid="BS201_LCD" combocol="CODE" combodataset="ds_sukum" combotext="CODE_NAME" display="combo" edit="combo"/>
						<cell align="right" bkcolor2="user22" col="5" colid="BS201_LRT" display="number" edit="number"/>
						<cell align="center" bkcolor2="user22" col="6" colid="BS201_LDT" display="text" expandimage="btn_grid_icon_pen" expandshow="true" expandsize="18" Mask="####.##.##"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Shape BKColor="user12" Bottom="287" Height="51" Id="Shape5" Left="8" LineColor="user13" Right="770" TabOrder="23" Top="236" Type="Rectangle" Width="762"></Shape>
		<TextArea BindDataset="ds_head" Border="Flat" Column="BS201_RMK" Height="45" Id="tx_rmk" Left="113" Style="sty_ipt_form" TabOrder="24" Top="239" VScroll="TRUE" Width="654"></TextArea>
		<Static Align="Right" Height="49" Id="Static10" Left="9" Style="sty_lb_form_basic" TabOrder="22" Text="특이사항&#32;" Top="237" VAlign="Middle" Width="102"></Static>
		<Image Height="19" Id="Image1" ImageID="form_bl_title_sub" Left="8" TabOrder="25" Top="431" Width="11"></Image>
		<Static Color="user6" Font="굴림,9,Bold" Height="20" Id="Static5" Left="21" TabOrder="26" Text="사양&#32;및&#32;견적&#32;정보" Top="433" VAlign="Middle" Width="254"></Static>
		<Grid AutoEnter="TRUE" AutoFitEndLine="Hide" BindDataset="ds_list2" BkColor2="default" BoldHead="true" Border="Flat" Bottom="574" ColSelect="TRUE" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="120" Id="grd_list2" InputPanel="FALSE" Left="8" LineColor="user20" LineType="ExHORZ" Right="770" RowHeight="20" Style="sty_grid" TabOrder="27" TabStop="true" Top="454" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="762">
			<contents>
				<format id="Default">
					<columns>
						<col width="40"/>
						<col width="80"/>
						<col width="100"/>
						<col width="80"/>
						<col width="80"/>
						<col width="100"/>
						<col width="60"/>
						<col width="60"/>
						<col width="200"/>
					</columns>
					<head>
						<cell align="center" col="0" color="user21" display="text" font="굴림,9" text="No"/>
						<cell align="center" col="1" color="user21" display="text" font="굴림,9" text="기종"/>
						<cell align="center" col="2" color="user21" display="text" font="굴림,9" text="용도"/>
						<cell align="center" col="3" color="user21" display="text" font="굴림,9" text="인승"/>
						<cell align="center" col="4" color="user21" display="text" font="굴림,9" text="열림"/>
						<cell align="center" col="5" color="user21" display="text" font="굴림,9" text="속도"/>
						<cell align="center" col="6" color="user21" display="text" font="굴림,9" text="층수"/>
						<cell align="center" col="7" color="user21" display="text" font="굴림,9" text="시행율"/>
						<cell align="center" col="8" color="user21" display="text" font="굴림,9" text="비고"/>
					</head>
					<body>
						<cell align="center" bkcolor2="user22" col="0" display="text" expr="currow+1"/>
						<cell bkcolor2="user22" col="1" colid="BS202_TYP" combocol="CODE" combodataset="ds_typ" combodisplayrowcnt="6" combotext="CODE_NAME" display="combo" edit="combo"/>
						<cell bkcolor2="user22" col="2" colid="BS202_USE" combocol="CODE" combodataset="ds_use" combotext="CODE_NAME" display="combo" edit="combo"/>
						<cell bkcolor2="user22" col="3" colid="BS202_MAN" combocol="CODE" combodataset="ds_man" combotext="CODE_NAME" display="combo" edit="combo"/>
						<cell bkcolor2="user22" col="4" colid="BS202_OPN" combocol="CODE" combodataset="ds_opn" combotext="CODE_NAME" display="combo" edit="combo"/>
						<cell bkcolor2="user22" col="5" colid="BS202_SPD" combocol="CODE" combodataset="ds_spd" combotext="CODE_NAME" display="combo" edit="combo"/>
						<cell bkcolor2="user22" col="6" colid="BS202_STP" display="number" edit="number" limit="3"/>
						<cell align="right" bkcolor2="user22" col="7" colid="BS202_RAT" display="number" Mask="##0.0"/>
						<cell bkcolor2="user22" col="8" colid="BS202_RMK" display="text" edit="normal"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Div Height="36" Id="div_btn" TabOrder="28" Text="Div0" Url="WB01::CommBtnForm.xml" Width="778">
			<Contents></Contents>
		</Div>
		<MaskEdit BindDataset="ds_head" Border="Flat" Column="BS201_ZIP" Height="20" Id="med_zipcode" Left="106" LeftMargin="10" Mask="###-###" MaxLength="7" Style="sty_ipt_form" TabOrder="29" Top="93" Type="STRING" Width="60"></MaskEdit>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_plus" ImageID="btn_icon_plus" Left="724" LeftMargin="12" OnClick="btn_plus_OnClick" Style="sty_btn" TabOrder="30" Top="431" Transparent="TRUE" Width="22"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_minus" ImageID="btn_icon_minus" Left="748" LeftMargin="12" OnClick="btn_minus_OnClick" Style="sty_btn" TabOrder="31" Top="431" Transparent="TRUE" Width="22"></Button>
		<Calendar BindDataset="ds_head" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="BS201_CDT" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Enable="FALSE" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_cdt" Left="406" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="32" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="43" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="97"></Calendar>
		<Static Height="13" Id="st_zipcode2" Left="60" TabOrder="33" Text="우편번호" Top="590" Visible="FALSE" Width="40"></Static>
		<Static Height="13" Id="st_addr2" Left="100" TabOrder="34" Text="주소" Top="590" Visible="FALSE" Width="40"></Static>
		<Static Height="13" Id="st_param" Left="141" TabOrder="35" Text="사양&#32;및&#32;견적정보" Top="590" Visible="FALSE" Width="40"></Static>
		<Static Height="13" Id="st_fcd" Left="32" TabOrder="36" Text="선수금&#32;수금조건" Top="616" Visible="FALSE" Width="40"></Static>
		<Static Height="13" Id="st_frt" Left="72" TabOrder="37" Text="선수금&#32;수금율" Top="616" Visible="FALSE" Width="40"></Static>
		<Static Height="13" Id="st_mcd" Left="120" TabOrder="38" Text="중도금&#32;수금조건" Top="616" Visible="FALSE" Width="40"></Static>
		<Static Height="13" Id="st_mrt" Left="160" TabOrder="39" Text="중도금&#32;수금율" Top="616" Visible="FALSE" Width="40"></Static>
		<Static Height="13" Id="st_lcd" Left="200" TabOrder="40" Text="잔금&#32;수금조건" Top="616" Visible="FALSE" Width="40"></Static>
		<Static Height="13" Id="st_lrt" Left="240" TabOrder="41" Text="잔금&#32;수금율" Top="616" Visible="FALSE" Width="40"></Static>
		<Static Height="13" Id="st_ldt" Left="280" TabOrder="42" Text="납기일자" Top="616" Visible="FALSE" Width="40"></Static>
		<Static Height="13" Id="st_curr" Left="376" TabOrder="43" Text="현재일자" Top="618" Visible="FALSE" Width="40"></Static>
		<Static Height="13" Id="st_typ" Left="32" TabOrder="44" Text="기종" Top="632" Visible="FALSE" Width="40"></Static>
		<Static Height="13" Id="st_use" Left="72" TabOrder="45" Text="용도" Top="632" Visible="FALSE" Width="40"></Static>
		<Static Height="13" Id="st_man" Left="120" TabOrder="46" Text="인승" Top="632" Visible="FALSE" Width="40"></Static>
		<Static Height="13" Id="st_opn" Left="160" TabOrder="47" Text="열림" Top="632" Visible="FALSE" Width="40"></Static>
		<Static Height="13" Id="st_spd" Left="200" TabOrder="48" Text="속도" Top="632" Visible="FALSE" Width="40"></Static>
		<Calendar Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="146" Id="cal_temp" Left="792" MonthOnly="TRUE" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" OnDayClick="cal_temp_OnDayClick" OnKillFocus="cal_temp_OnKillFocus" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="49" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="176" Value="20080401" Visible="FALSE" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="152"></Calendar>
		<Static Height="13" Id="st_update" Left="464" TabOrder="50" Text="수정" Top="616" Visible="FALSE" Width="40"></Static>
		<Static Height="13" Id="st_delete" Left="496" TabOrder="51" Text="삭제" Top="616" Visible="FALSE" Width="40"></Static>
		<Static Height="13" Id="st_param2" Left="222" TabOrder="52" Text="삭제할" Top="592" Visible="FALSE" Width="40"></Static>
		<Static Height="13" Id="st_sukumrate" Left="280" TabOrder="53" Text="수금율" Top="648" Visible="FALSE" Width="40"></Static>
		<Static Align="Right" Height="24" Id="Static0" Left="564" Style="sty_lb_form_basic" TabOrder="54" Text="현장연락처&#32;" Top="91" VAlign="Middle" Width="95"></Static>
		<Edit BindDataset="ds_head" Border="Flat" Column="BS201_TEL" Height="20" Id="ed_tel" Left="660" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="55" Top="93" Width="107"></Edit>
		<Combo BindDataset="ds_head" Border="Flat" CodeColumn="CODE" Column="BS201_CID" DataColumn="CODE_NAME" Height="20" Id="cb_cid" INDEX="0" InnerDataset="ds_userp" Left="660" Style="sty_ipt_form" TabOrder="56" Top="42" Width="107"></Combo>
		<Shape BKColor="user12" Bottom="141" Height="26" Id="Shape3" Left="8" LineColor="user13" Right="770" TabOrder="57" Top="115" Type="Rectangle" Width="762"></Shape>
		<Static Align="Right" Height="24" Id="Static1" Left="309" Style="sty_lb_form_basic" TabOrder="58" Text="제품구분&#32;" Top="116" VAlign="Middle" Width="95"></Static>
		<Combo BindDataset="ds_head" Border="Flat" CodeColumn="CODE" Column="BS201_GBN" DataColumn="CODE_NAME" Height="20" Id="cb_gbn2" InnerDataset="ds_gbn2" Left="405" Style="sty_ipt_form" TabOrder="59" Top="117" Width="107"></Combo>
		<Static Align="Right" Height="24" Id="st_agb" Left="564" Style="sty_lb_form_basic" TabOrder="60" Text="견적구분&#32;" Top="116" VAlign="Middle" Width="95"></Static>
		<Combo BindDataset="ds_head" Border="Flat" CodeColumn="CODE" Column="BS201_AGB" DataColumn="CODE_NAME" Height="20" Id="cb_gbn3" InnerDataset="ds_gbn3" Left="660" Style="sty_ipt_form" TabOrder="61" Top="117" Width="107"></Combo>
		<Static Height="13" Id="st_stp" Left="232" TabOrder="62" Text="층수" Top="632" Visible="FALSE" Width="40"></Static>
		<Static Align="Right" Height="24" Id="st_dev" Left="9" Style="sty_lb_form_basic" TabOrder="63" Text="시행사&#32;" Top="116" VAlign="Middle" Width="95"></Static>
		<Edit BindDataset="ds_head" Border="Flat" Column="BS201_DEV" Height="20" Id="ed_dev" Left="106" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="64" Top="118" Width="200"></Edit>
		<Shape BKColor="user12" Bottom="166" Height="26" Id="Shape4" Left="8" LineColor="user13" Right="770" TabOrder="65" Top="140" Type="Rectangle" Width="762"></Shape>
		<Static Align="Right" Height="24" Id="st_buse" Left="9" Style="sty_lb_form_basic" TabOrder="66" Text="건물용도&#32;" Top="141" VAlign="Middle" Width="95"></Static>
		<Combo BindDataset="ds_head" Border="Flat" CodeColumn="CODE" Column="BS201_USE" DataColumn="CODE_NAME" Height="20" Id="cb_buse" InnerDataset="ds_buse" Left="105" Style="sty_ipt_form" TabOrder="67" Top="142" Width="107"></Combo>
		<Static Height="13" Id="st_rat" Left="336" TabOrder="68" Text="시행율" Top="648" Visible="FALSE" Width="40"></Static>
		<Static Color="user6" Font="굴림,9,Bold" Height="20" Id="st_txt" Left="21" TabOrder="70" Text="특기사항" Top="290" VAlign="Middle" Width="254"></Static>
		<Image Height="19" Id="Image2" ImageID="form_bl_title_sub" Left="8" TabOrder="69" Top="289" Width="11"></Image>
		<Shape BKColor="user12" Bottom="336" Height="24" Id="Shape8" Left="7" LineColor="user13" Right="769" TabOrder="71" Top="312" Type="Rectangle" Width="762"></Shape>
		<Static Align="Right" Height="22" Id="st_t01" Left="8" Style="sty_lb_form_basic" TabOrder="72" Text="1.&#32;" Top="313" VAlign="Middle" Width="45"></Static>
		<Edit BindDataset="ds_head" Border="Flat" Column="BS201_T01" Enable="FALSE" Height="20" Id="ed_t01" Left="55" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="73" Top="314" Width="711"></Edit>
		<Shape BKColor="user12" Bottom="359" Height="24" Id="Shape6" Left="7" LineColor="user13" Right="769" TabOrder="74" Top="335" Type="Rectangle" Width="762"></Shape>
		<Static Align="Right" Height="22" Id="st_t02" Left="8" Style="sty_lb_form_basic" TabOrder="75" Text="2.&#32;" Top="336" VAlign="Middle" Width="45"></Static>
		<Edit BindDataset="ds_head" Border="Flat" Column="BS201_T02" Enable="FALSE" Height="20" Id="ed_t02" Left="55" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="76" Top="337" Width="711"></Edit>
		<Shape BKColor="user12" Bottom="382" Height="24" Id="Shape7" Left="7" LineColor="user13" Right="769" TabOrder="77" Top="358" Type="Rectangle" Width="762"></Shape>
		<Static Align="Right" Height="22" Id="st_t03" Left="8" Style="sty_lb_form_basic" TabOrder="78" Text="3.&#32;" Top="359" VAlign="Middle" Width="45"></Static>
		<Edit BindDataset="ds_head" Border="Flat" Column="BS201_T03" Enable="FALSE" Height="20" Id="ed_t03" Left="55" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="79" Top="360" Width="711"></Edit>
		<Shape BKColor="user12" Bottom="405" Height="24" Id="Shape9" Left="7" LineColor="user13" Right="769" TabOrder="1" Top="381" Type="Rectangle" Width="762"></Shape>
		<Edit BindDataset="ds_head" Border="Flat" Column="BS201_T04" Enable="FALSE" Height="20" Id="ed_t04" Left="55" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="81" Top="383" Width="711"></Edit>
		<Static Align="Right" Height="22" Id="st_t04" Left="8" Style="sty_lb_form_basic" TabOrder="80" Text="4.&#32;" Top="382" VAlign="Middle" Width="45"></Static>
		<Shape BKColor="user12" Bottom="428" Height="24" Id="Shape10" Left="7" LineColor="user13" Right="769" TabOrder="82" Top="404" Type="Rectangle" Width="762"></Shape>
		<Static Align="Right" Height="22" Id="st_t05" Left="8" Style="sty_lb_form_basic" TabOrder="83" Text="5.&#32;" Top="405" VAlign="Middle" Width="45"></Static>
		<Edit BindDataset="ds_head" Border="Flat" Column="BS201_T05" Enable="FALSE" Height="20" Id="ed_t05" Left="55" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="84" Top="406" Width="711"></Edit>
	</Form>
	<Script><![CDATA[﻿﻿﻿﻿﻿﻿﻿﻿/*
 ******************************************************************************************
 * 기      능   : 
 * 작  성  자   : 
 * 작성  일자   : 
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
#include "LIB::commons.js";	// 공통 스크립트 
#include "LIB::utility.js";	// 다중 선택 
#include "LIB::common_hdel.js";	// 공통 스크립트  /* GNY 추가 */
//=========================================================================================
// [ PART 1 ]
// Form에서 사용될 전역변수를 선언
// FORM에서 사용되는 전역변수는 대문자로 작성하며, F_XXX 의 형태를 갖도록 한다. 
//=========================================================================================

//=========================================================================================
// [ PART 2 ]
// Form Loading / Unloading 시 작업 정의
//=========================================================================================
function fn_OnLoadCompleted(obj) 
{
	gfn_initForm();

	if(gubun == 'I') 
	{
		ds_cond2.SetColumn(0,"GNO","");
		ds_cond2.SetColumn(0,"RDT","");
		ds_cond2.SetColumn(0,"SEQ","");
		ds_cond2.SetColumn(0,"SIR","");
		ds_cond2.SetColumn(0,"GBN","1");
		div_btn.btn_delete.enable = false;
		div_btn.btn_save.enable = true;
	} 
	else if(gubun == 'U') 
	{
		ds_cond2.SetColumn(0,"GNO",ds_list.GetColumn(ds_list.row,"BS201_GNO"));
		ds_cond2.SetColumn(0,"RDT",ds_list.GetColumn(ds_list.row,"BS201_RDT"));
		ds_cond2.SetColumn(0,"SEQ",ds_list.GetColumn(ds_list.row,"BS201_SEQ"));
		ds_cond2.SetColumn(0,"SIR",ds_list.GetColumn(ds_list.row,"BS201_SIR"));
		ds_cond2.SetColumn(0,"GBN","1");
		div_btn.btn_delete.enable = true;
		div_btn.btn_save.enable = true;
	} 
	else if(gubun == 'S') 
	{
		ds_cond2.SetColumn(0,"GNO",ds_list.GetColumn(ds_list.row,"BS201_GNO"));
		ds_cond2.SetColumn(0,"RDT",ds_list.GetColumn(ds_list.row,"BS201_RDT"));
		ds_cond2.SetColumn(0,"SEQ",ds_list.GetColumn(ds_list.row,"BS201_SEQ"));
		ds_cond2.SetColumn(0,"SIR",ds_list.GetColumn(ds_list.row,"BS201_SIR"));
		ds_cond2.SetColumn(0,"GBN","2");
		div_btn.btn_delete.enable = false;
		div_btn.btn_save.enable = false;
	} 
	else 
	{
		ds_cond2.SetColumn(0,"GNO","");
		ds_cond2.SetColumn(0,"RDT","");
		ds_cond2.SetColumn(0,"SEQ","");
		ds_cond2.SetColumn(0,"SIR","");
		ds_cond2.SetColumn(0,"GBN","2");
		div_btn.btn_delete.enable = false;
		div_btn.btn_save.enable = false;
	}

	//코드콤보 설정 : 지역, 구분2 
	var codeArr = ["BS102","CS131","BS403","EL_ZATYP","EL_ZAUSE","EL_ZAMAN","EL_ZAOPEN","EL_ZASPD"];
	var dsObjArr = [ds_sukum,ds_gbn2,ds_buse,ds_typ,ds_use,ds_man,ds_opn,ds_spd];
	var addTypeArr = [G_CODE_NONE,G_CODE_NONE,G_CODE_SELECT];
	var oderTypeArr = ["DTEXT1"];
	gfn_searchCommCode2(codeArr, dsObjArr, addTypeArr, oderTypeArr);

	tit_clearActionInfo();
	tit_addSearchActionInfo("bs01:BS0102001A_S4");

	tit_callService(
        ""
        , ""
        , "ds_cond=ds_cond2"
        , "ds_userp=ds_userp"
        , ""
        , "fn_afterUser"
        , true
        , true);

	fn_query();
}
/********************************************************************************
* 기      능   : 공통코드가 조회된 후의 Callback 함수 
********************************************************************************/
function fn_completeInit(sCode, sDsObj, sCodeType) {

}
/********************************************************************************
* 기      능   : form UnloadCompleted 
********************************************************************************/
function fn_OnUnloadCompleted(obj) 
{
	return gfn_isFormUnload(obj);
}
//=========================================================================================
// [ PART 3 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,form닫기)
//=========================================================================================
/********************************************************************************
* 기      능   : 조회 
********************************************************************************/
function fn_query() 
{
	tit_clearActionInfo();
	tit_addSearchActionInfo("bs01:BS0102001A_S1");
	tit_addSearchActionInfo("bs01:BS0102001A_S2");
	tit_addSearchActionInfo("bs01:BS0102006A_S2");

	tit_callService(
        ""
        , ""
        , "ds_cond=ds_cond2"
        , "ds_head=ds_head ds_list2=ds_list2 ds_desc=ds_desc"
        , ""
        , "fn_afterQuery"
        , true
        , true);
}
/********************************************************************************
* 기      능   : 조회 Callback  
********************************************************************************/
function fn_afterQuery(errCode, errMsg) 
{
	gfn_showMsg("CI00002",ds_list2.RowCount()+"");

	if(ds_head.rowcount == 0) 
	{
		ds_head.AddRow();
	}

	if(gubun == 'I')
	{
		ed_name1.value = G_VEND_NAME;
		cb_cid.value = G_USER_ID;
		cal_cdt.value = gfn_getCurrDate();
		cb_gbn2.Index = 0;
		cb_gbn3.Index = 0;
		cb_buse.Index = 0;
	}
	if((gubun == 'I' || gubun == 'U') && G_USER_GROUP_B == 'B10' && ds_desc.GetColumn(0,"DESC") == "Y")
	{
		cb_cid.value = G_USER_ID;
		cb_cid.Enable = false;
	}

	if(ds_head.GetColumn(0, "BS201_PST") > "10") {
		cb_gbn3.Enable = false;
	}
}
/********************************************************************************
* 기      능   : 조회 Callback  
********************************************************************************/
function fn_afterUser(errCode, errMsg) 
{
}
/********************************************************************************
* 기      능   : 저장
********************************************************************************/
function fn_save() 
{
	if(gfn_isNull(ed_gnm, true, ed_gnm.Value)) return false; // 발주처
	if(gfn_isNull(ed_spt, true, ed_spt.Value)) return false; // 공사명
	if(gfn_isNull(ed_dev, true, ed_dev.Value)) return false; // 시행사
	if(gfn_isNull(ed_tel, true, ed_tel.Value)) return false; // 현장연락처
	if(gfn_isNull(med_zipcode2, true, med_zipcode2.Value)) return false; // 우편번호
	if(gfn_isNull(ed_addr2, true, ed_addr2.Value)) return false; // 주소1
	if(length(trim(cb_gbn2.Value)) == 0) { // 제품구분
		gfn_showMsg("제품구분은 필수입력 항목입니다. 확인하여 주십시오.");
		return false;
	}
	if(length(trim(cb_gbn3.Value)) == 0) { // 견적구분
		gfn_showMsg("견적구분은 필수입력 항목입니다. 확인하여 주십시오.");
		return false;
	}
	if(length(trim(cb_buse.Value)) == 0) { // 건물용도
		gfn_showMsg("건물용도는 필수입력 항목입니다. 확인하여 주십시오.");
		return false;
	}

	// 수금조건율정보 필수입력 체크
	var dsArr = ["BS201_FCD","BS201_FRT","BS201_MCD","BS201_MRT","BS201_LCD","BS201_LRT","BS201_LDT"];
	var lbArr = [st_fcd.value,st_frt.value,st_mcd.value,st_mrt.value,st_lcd.value,st_lrt.value,st_ldt.value];
	if ( gfn_isGridNull(grd_head,dsArr,lbArr,"") ) 
	{
		return;
	}

	if(parseFloat(ds_head.GetColumn(0,"BS201_FRT")) + parseFloat(ds_head.GetColumn(0,"BS201_MRT")) + parseFloat(ds_head.GetColumn(0,"BS201_LRT")) != 100 )
	{
		//수금율의 합은 100%이어야 합니다.\n확인하여 주십시오.
		var arr = [st_sukumrate.value, "100%" ];
		gfn_showMsg("CW00142",arr);
		return;
	}

	//진행상태 : 10-작성,15-전송,20-접수,30-확정
	if(parseInt(ds_head.GetColumn(0,"BS201_PST")) > 15 )
	{
		//이미 견적승인 판정결과가 등록 되어, 수정이 불가합니다.
		gfn_showMsg("CW00143",st_update.value);
		return;
	}

	if(ds_head.GetColumn(0,"BS201_LDT") <= gfn_getCurrDate() )
	{
		var arr = [st_ldt.value, st_curr.value ];
		gfn_showMsg("CW00024",arr);
		return;
	}

	if(ds_list2.rowcount == 0)
	{
		gfn_showMsg("CW00113",st_param.value);
		return;
	}

	// 사양및견적정보 필수입력 체크
	var dsArr = ["BS202_TYP","BS202_USE","BS202_MAN","BS202_OPN","BS202_SPD","BS202_STP"];
	var lbArr = [st_typ.value,st_use.value,st_man.value,st_opn.value,st_spd.value,st_stp.value];
	if ( gfn_isGridNull(grd_list2,dsArr,lbArr,"") ) 
	{
		return;
	}

	var spc;
	for(var i=0; i<ds_list2.rowcount; i++)
	{
		if(ds_list2.GetColumn(i,"BS202_RAT") > 110) {
			gfn_showAlert(parseInt(i) + "번째 행의 시행율을 확인하십시요.\n시행율은 110%보다 작아야 합니다.");
			return;
		}

		ds_list2.SetColumn(i,"BS201_RDT",ds_head.GetColumn(0,"BS201_RDT"));
		ds_list2.SetColumn(i,"BS201_SEQ",ds_head.GetColumn(0,"BS201_SEQ"));
		ds_list2.SetColumn(i,"BS201_SIR",ds_head.GetColumn(0,"BS201_SIR"));

		//용도 + 인승(용량) + '-' +OPEN 타입 + 속도 + '-' + 층수 + '/' + 정지층수
		spc = ds_list2.GetColumn(i, "BS202_USE") + ds_list2.GetColumn(i, "BS202_MAN")
				+ '-' + ds_list2.GetColumn(i, "BS202_OPN") + ds_list2.GetColumn(i, "BS202_SPD") 
				+ '-' + ds_list2.GetColumn(i, "BS202_STP");

		ds_list2.SetColumn(i, "BS202_SPC", spc);
	}

	ds_head.SetColumn(0,"BS201_QTY",1);
	ds_head.SetColumn(0,"BS201_EAM",0);
	ds_head.SetColumn(0,"BS201_OAM",0);
	ds_head.SetColumn(0,"BS201_RAT",0);

	tit_clearActionInfo();

	if(gubun == 'I') 
	{
		tit_addSingleActionInfo("bs01:BS0102001A_I1");
		tit_addMultiActionInfo("bs01:BS0102001A_I2");
	} 
	else if(gubun == 'U') 
	{	
		tit_addSingleActionInfo("bs01:BS0102001A_U1");
		tit_addSingleActionInfo("bs01:BS0102001A_D1");
		tit_addMultiActionInfo("bs01:BS0102001A_I3");
	}

	tit_callService(
		""
		, ""
		, "ds_head=ds_head ds_list2=ds_list2"
		, ""
		, ""
		, "fn_afterSave"
		, true);
}
/********************************************************************************
* 기      능   : 저장 Callback
********************************************************************************/
function fn_afterSave(errCode, errMsg)
{
	if ( errCode!= 0 ) 
	{
		gfn_showMsg("CE00001");
	}
	else 
	{
		gfn_showMsg("CI00003");
	}
}
/********************************************************************************
* 기      능   : 닫기  
********************************************************************************/
function fn_close() 
{
	close();
}
//=========================================================================================
// [ PART 4]
// Callback 함수 정의 : callback 함수명은 메인 함수의 fn_xxxx() 에서 xxxx 부분은 fn_afterXXXX()
// 형태가 되도록 작성 
//=========================================================================================

/********************************************************************************
* 기      능   : 액셀  
********************************************************************************/
function fn_excel() 
{
	gfn_saveToExcel(grd_list2, true );
}
/********************************************************************************
* 기      능   : 우편번호검색 팝업
********************************************************************************/
function Button1_OnClick(obj)
{
	var arg = "strObj="+quote(Obj.id);
	//gfn_openPopup("CS9601003A",true,arg);
	gfn_openPopUpUrlHdel("SES::Ses0034A.xml", true, arg);
}
/********************************************************************************
* 기      능   : 그리드에 row추가
********************************************************************************/
function btn_plus_OnClick(obj)
{
	if(gubun == 'U' || gubun == 'I')
	{
		ds_list2.AddRow();
	}
}
/********************************************************************************
* 기      능   : 그리드에 row삭제
********************************************************************************/
function btn_minus_OnClick(obj)
{
	if(gubun == 'U' || gubun == 'I')
	{
		ds_list2.DeleteRow(ds_list2.row);
	}
}
// 달력 처리 부분 
/********************************************************************************
* 기      능   : 그리드에서 날짜 입력시 
********************************************************************************/
function grd_head_OnExpandEdit(obj,nRow,nCell,strVal,nPivotIndex)
{
	var rect = obj.GetCellRect(nRow, ncell);
	cal_temp.top = rect[1] + 140;
	cal_temp.Left = rect[0] - 50; 
	cal_temp.Visible = true;
	cal_temp.value = ds_head.getColumn(nRow, "BS201_LDT");
	cal_temp.SetFocus();
}
/********************************************************************************
* 기      능   : 달력에서 일자 선택했을 경우 
********************************************************************************/
function cal_temp_OnDayClick(obj,strText)
{
	ds_head.SetColumn(ds_head.row, "BS201_LDT", strText);
	obj.Visible = false;
}

/********************************************************************************
* 기      능   : 달력에서 포커스 잃었을 경우 
********************************************************************************/
function cal_temp_OnKillFocus(obj)
{
	obj.Visible = false;
}
/********************************************************************************
* 기      능   : Delete 
********************************************************************************/
function fn_delete() 
{
	if(parseInt(ds_head.GetColumn(0,"BS201_PST")) > 15 )
	{
		//이미 견적승인 판정결과가 등록 되어, 수정이 불가합니다.
		gfn_showMsg("CW00143",st_delete.value);
		return;
	}

	if(ds_head.rowcount == 0 && ds_list2.rowcount == 0)
	{
		gfn_showMsg("CW00113",st_param2.value);
		return;
	}

	tit_clearActionInfo();
	tit_addSingleActionInfo("bs01:BS0102001A_D1");
	tit_addSelectExActionInfo("bs01:BS0102001A_S3", "bs01:BS0102001A_D2", "");

	tit_callService(
		""
		, ""
		, "ds_head=ds_head"
		, ""
		, ""
		, "fn_afterDelete"
		, true);	

}

/********************************************************************************
* 기      능   : 저장 Callback  
********************************************************************************/
function fn_afterDelete(errCode, errMsg) 
{
	if ( errCode!= 0 ) 
	{
		gfn_showMsg("CE00001");
	} 
	else 
	{
		gfn_showMsg("CI00003");
		fn_query();
	}
}
]]></Script>
</Window>