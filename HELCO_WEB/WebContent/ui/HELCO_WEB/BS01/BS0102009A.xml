<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="580" Id="BS0102009A" Left="8" OnLoadCompleted="fn_OnLoadCompleted" OnUnloadCompleted="fn_OnUnloadCompleted" PidAttrib="7" Title="원가의뢰사양정보" TooltipFont="Default,0" Top="8" Ver="1.0" Width="778" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_cond2">
				<Contents>
					<colinfo id="GNO" size="256" summ="default" type="STRING"/>
					<colinfo id="RDT" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="SIR" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="GRP" size="256" summ="default" type="STRING"/>
					<colinfo id="T01" size="256" summ="default" type="STRING"/>
					<colinfo id="T02" size="256" summ="default" type="STRING"/>
					<colinfo id="T03" size="256" summ="default" type="STRING"/>
					<colinfo id="T04" size="256" summ="default" type="STRING"/>
					<colinfo id="T05" size="256" summ="default" type="STRING"/>
					<record>
						<GBN></GBN>
						<GNO></GNO>
						<GRP></GRP>
						<RDT></RDT>
						<SEQ></SEQ>
						<SIR></SIR>
						<T01></T01>
						<T02></T02>
						<T03></T03>
						<T04></T04>
						<T05></T05>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_sukum">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_typ">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_head">
				<Contents>
					<colinfo id="BS201_AD1" size="300" summ="default" type="STRING"/>
					<colinfo id="BS201_AD2" size="300" summ="default" type="STRING"/>
					<colinfo id="BS201_CDT" size="24" summ="default" type="STRING"/>
					<colinfo id="BS201_CID" size="30" summ="default" type="STRING"/>
					<colinfo id="BS201_EAM" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="BS201_FCD" size="6" summ="default" type="STRING"/>
					<colinfo id="BS201_FRT" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="BS201_DEV" size="256" summ="default" type="STRING"/>
					<colinfo id="BS201_GNM" size="300" summ="default" type="STRING"/>
					<colinfo id="BS201_LCD" size="6" summ="default" type="STRING"/>
					<colinfo id="BS201_LDT" size="24" summ="default" type="STRING"/>
					<colinfo id="BS201_LRT" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="BS201_MCD" size="6" summ="default" type="STRING"/>
					<colinfo id="BS201_MRT" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="BS201_PST" size="6" summ="default" type="STRING"/>
					<colinfo id="BS201_RDT" size="18" summ="default" type="STRING"/>
					<colinfo id="BS201_T01" size="256" summ="default" type="STRING"/>
					<colinfo id="BS201_T02" size="256" summ="default" type="STRING"/>
					<colinfo id="BS201_T03" size="256" summ="default" type="STRING"/>
					<colinfo id="BS201_T04" size="256" summ="default" type="STRING"/>
					<colinfo id="BS201_T05" size="256" summ="default" type="STRING"/>
					<colinfo id="BS201_RMK" size="600" summ="default" type="STRING"/>
					<colinfo id="BS201_SEQ" size="15" summ="default" type="STRING"/>
					<colinfo id="BS201_SIR" size="256" summ="default" type="STRING"/>
					<colinfo id="BS201_SPT" size="300" summ="default" type="STRING"/>
					<colinfo id="BS201_TEL" size="90" summ="default" type="STRING"/>
					<colinfo id="BS201_ZIP" size="18" summ="default" type="STRING"/>
					<colinfo id="NAME1" size="105" summ="default" type="STRING"/>
					<colinfo id="BS201_QTY" size="256" summ="default" type="STRING"/>
					<colinfo id="BS201_OAM" size="256" summ="default" type="STRING"/>
					<colinfo id="BS201_RAT" size="256" summ="default" type="STRING"/>
					<colinfo id="BS201_PID" size="256" summ="default" type="STRING"/>
					<colinfo id="BS201_GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="BS201_YST" size="256" summ="default" type="STRING"/>
					<colinfo id="BS201_USE" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK_203" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list2" OnColumnChanged="ds_list2_OnColumnChanged">
				<Contents>
					<colinfo id="GNO" size="256" summ="default" type="STRING"/>
					<colinfo id="BS202_RDT" size="256" summ="default" type="STRING"/>
					<colinfo id="BS202_SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="BS202_SIR" size="256" summ="default" type="STRING"/>
					<colinfo id="BS202_ISR" size="256" summ="default" type="STRING"/>
					<colinfo id="BS202_TYP" size="256" summ="default" type="STRING"/>
					<colinfo id="BS202_USE" size="256" summ="default" type="STRING"/>
					<colinfo id="BS202_MAN" size="256" summ="default" type="STRING"/>
					<colinfo id="BS202_OPN" size="256" summ="default" type="STRING"/>
					<colinfo id="BS202_SPD" size="256" summ="default" type="STRING"/>
					<colinfo id="BS202_STP" size="256" summ="default" type="STRING"/>
					<colinfo id="BS202_OAM" size="256" summ="default" type="STRING"/>
					<colinfo id="BS202_EAM" size="256" summ="default" type="STRING"/>
					<colinfo id="BS202_RAT" size="256" summ="default" type="STRING"/>
					<colinfo id="BS202_RMK" size="256" summ="default" type="STRING"/>
					<colinfo id="BS202_SPC" size="256" summ="default" type="STRING"/>
					<colinfo id="YST" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_userp">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_gbn2">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_gbn3">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME>-&#32;선택&#32;-</CODE_NAME>
					</record>
					<record>
						<CODE>A</CODE>
						<CODE_NAME>실행가</CODE_NAME>
					</record>
					<record>
						<CODE>B</CODE>
						<CODE_NAME>예산가</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_spd">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_desc">
				<Contents>
					<colinfo id="DESC" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_use">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_man">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_opn">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_pst">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_in">
				<Contents>
					<colinfo id="RDT" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="SIR" size="256" summ="default" type="STRING"/>
					<colinfo id="ISR" size="256" summ="default" type="STRING"/>
					<record>
						<ISR></ISR>
						<RDT></RDT>
						<SEQ></SEQ>
						<SIR></SIR>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list3">
				<Contents>
					<colinfo id="NAM_CHAR" size="256" summ="default" type="STRING"/>
					<colinfo id="ATBEZ" size="256" summ="default" type="STRING"/>
					<colinfo id="VALUE1" size="256" summ="default" type="STRING"/>
					<colinfo id="ATWTB1" size="256" summ="default" type="STRING"/>
					<colinfo id="VALUE2" size="256" summ="default" type="STRING"/>
					<colinfo id="ATWTB2" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond3">
				<Contents>
					<colinfo id="RDT" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="SIR" size="256" summ="default" type="STRING"/>
					<colinfo id="ISR" size="256" summ="default" type="STRING"/>
					<record>
						<ISR></ISR>
						<RDT></RDT>
						<SEQ></SEQ>
						<SIR></SIR>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_error">
				<Contents>
					<colinfo id="IDX" size="256" type="STRING"/>
					<colinfo id="ERRMSG" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_buse">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_in2">
				<Contents>
					<colinfo id="RDT" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="SIR" size="256" summ="default" type="STRING"/>
					<colinfo id="ISR" size="256" summ="default" type="STRING"/>
					<record>
						<ISR></ISR>
						<RDT></RDT>
						<SEQ></SEQ>
						<SIR></SIR>
					</record>
				</Contents>
			</Dataset>
		</Datasets>
		<Image Height="19" Id="Image0" ImageID="form_bl_title_sub" Left="7" TabOrder="1" Top="167" Width="11"></Image>
		<Static Color="user6" Font="굴림,9,Bold" Height="20" Id="Static19" Left="20" TabOrder="2" Text="수금조건율" Top="169" VAlign="Middle" Width="254"></Static>
		<Grid AutoEnter="TRUE" AutoFit="TRUE" AutoFitEndLine="Hide" BindDataset="ds_head" BkColor2="default" BoldHead="true" Border="Flat" Bottom="233" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="43" Id="grd_head" InputPanel="FALSE" Left="7" LineColor="user20" LineType="ExHORZ" MinWidth="100" OnExpandEdit="grd_head_OnExpandEdit" Right="769" RowHeight="20" Style="sty_grid" TabOrder="3" TabStop="true" Top="190" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="762">
			<contents>
				<format id="Default">
					<columns>
						<col width="110"/>
						<col width="110"/>
						<col width="110"/>
						<col width="110"/>
						<col width="110"/>
						<col width="110"/>
						<col width="100"/>
					</columns>
					<head>
						<cell align="center" col="0" color="user21" display="text" font="굴림,9" text="(선수금)수금조건"/>
						<cell align="center" col="1" color="user21" display="text" font="굴림,9" text="(선수금)수금율(%)"/>
						<cell align="center" col="2" color="user21" display="text" font="굴림,9" text="(중도금)수금조건"/>
						<cell align="center" col="3" color="user21" display="text" font="굴림,9" text="(중도금)수금율(%)"/>
						<cell align="center" col="4" color="user21" display="text" font="굴림,9" text="(잔금)수금조건"/>
						<cell align="center" col="5" color="user21" display="text" font="굴림,9" text="(잔금)수금율(%)"/>
						<cell align="center" col="6" color="user21" display="text" font="굴림,9" text="납기일자"/>
					</head>
					<body>
						<cell align="right" bkcolor2="user22" col="0" colid="BS201_FCD" combocol="CODE" combodataset="ds_sukum" combotext="CODE_NAME" display="combo" edit="combo"/>
						<cell align="right" bkcolor2="user22" col="1" colid="BS201_FRT" display="number" edit="number"/>
						<cell align="right" bkcolor2="user22" col="2" colid="BS201_MCD" combocol="CODE" combodataset="ds_sukum" combotext="CODE_NAME" display="combo" edit="combo"/>
						<cell align="right" bkcolor2="user22" col="3" colid="BS201_MRT" display="number" edit="number"/>
						<cell align="right" bkcolor2="user22" col="4" colid="BS201_LCD" combocol="CODE" combodataset="ds_sukum" combotext="CODE_NAME" display="combo" edit="combo"/>
						<cell align="right" bkcolor2="user22" col="5" colid="BS201_LRT" display="number" edit="number"/>
						<cell align="center" bkcolor2="user22" col="6" colid="BS201_LDT" display="text" expandimage="btn_grid_icon_pen" expandshow="true" expandsize="18" Mask="####.##.##"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Shape BKColor="user12" Bottom="287" Height="51" Id="Shape5" Left="7" LineColor="user13" Right="769" TabOrder="5" Top="236" Type="Rectangle" Width="762"></Shape>
		<TextArea BindDataset="ds_head" Border="Flat" Column="BS201_RMK" Height="45" Id="tx_rmk" Left="112" Style="sty_ipt_form" TabOrder="6" Top="239" VScroll="TRUE" Width="654"></TextArea>
		<Static Align="Right" Height="49" Id="Static10" Left="8" Style="sty_lb_form_basic" TabOrder="4" Text="특이사항&#32;" Top="237" VAlign="Middle" Width="102"></Static>
		<Image Height="19" Id="Image1" ImageID="form_bl_title_sub" Left="7" TabOrder="7" Top="430" Width="11"></Image>
		<Static Color="user6" Font="굴림,9,Bold" Height="20" Id="Static5" Left="20" TabOrder="8" Text="사양&#32;정보" Top="432" VAlign="Middle" Width="254"></Static>
		<Grid AutoEnter="TRUE" AutoFitEndLine="Hide" BindDataset="ds_list2" BkColor2="default" BoldHead="true" Border="Flat" Bottom="574" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="120" Id="grd_list2" InputPanel="FALSE" Left="7" LineColor="user20" LineType="ExHORZ" OnCellDBLClick="grd_list2_OnCellDblClick" Right="769" RowHeight="20" Style="sty_grid" TabOrder="9" TabStop="true" Top="454" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="762">
			<contents>
				<format id="Default">
					<columns>
						<col width="30"/>
						<col width="40"/>
						<col width="80"/>
						<col width="100"/>
						<col width="80"/>
						<col width="80"/>
						<col width="100"/>
						<col width="60"/>
						<col width="80"/>
						<col width="80"/>
						<col width="50"/>
						<col width="60"/>
						<col width="60"/>
						<col width="150"/>
					</columns>
					<head>
						<cell col="0" display="text" font="굴림,9" text="선택"/>
						<cell align="center" col="1" color="user21" display="text" font="굴림,9" text="No"/>
						<cell align="center" col="2" color="user21" display="text" font="굴림,9" text="기종"/>
						<cell align="center" col="3" color="user21" display="text" font="굴림,9" text="용도"/>
						<cell align="center" col="4" color="user21" display="text" font="굴림,9" text="인승"/>
						<cell align="center" col="5" color="user21" display="text" font="굴림,9" text="열림"/>
						<cell align="center" col="6" color="user21" display="text" font="굴림,9" text="속도"/>
						<cell align="center" col="7" color="user21" display="text" font="굴림,9" text="층수"/>
						<cell align="center" col="8" color="user21" display="text" font="굴림,9" text="원가"/>
						<cell align="center" col="9" color="user21" display="text" font="굴림,9" text="견적가"/>
						<cell align="center" col="10" color="user21" display="text" font="굴림,9" text="시행율"/>
						<cell align="center" col="11" color="user21" display="text" font="굴림,9" text="계산"/>
						<cell align="center" col="12" color="user21" display="text" font="굴림,9" text="내역"/>
						<cell align="center" col="13" color="user21" display="text" font="굴림,9" text="비고"/>
					</head>
					<body>
						<cell align="center" bkcolor2="user22" col="0" colid="CHK" display="expr:iif(length(trim(BS202_ISR))&#32;&gt;&#32;0,&apos;checkbox&apos;,&apos;normal&apos;)" edit="expr:iif(length(trim(BS202_ISR))&#32;&gt;&#32;0,&apos;checkbox&apos;,&apos;none&apos;)"/>
						<cell align="center" bkcolor2="user22" col="1" display="text" expr="currow+1"/>
						<cell bkcolor2="user22" col="2" colid="BS202_TYP" combocol="CODE" combodataset="ds_typ" combodisplayrowcnt="6" combotext="CODE_NAME" display="combo" edit="combo"/>
						<cell bkcolor2="user22" col="3" colid="BS202_USE" combocol="CODE" combodataset="ds_use" combotext="CODE_NAME" display="combo" edit="combo"/>
						<cell bkcolor2="user22" col="4" colid="BS202_MAN" combocol="CODE" combodataset="ds_man" combotext="CODE_NAME" display="combo" edit="combo"/>
						<cell bkcolor2="user22" col="5" colid="BS202_OPN" combocol="CODE" combodataset="ds_opn" combotext="CODE_NAME" display="combo" edit="combo"/>
						<cell bkcolor2="user22" col="6" colid="BS202_SPD" combocol="CODE" combodataset="ds_spd" combotext="CODE_NAME" display="combo" edit="combo"/>
						<cell bkcolor2="user22" col="7" colid="BS202_STP" display="number" edit="number" limit="3"/>
						<cell align="right" bkcolor2="user22" col="8" colid="BS202_OAM" display="number"/>
						<cell align="right" bkcolor2="user22" col="9" colid="BS202_EAM" display="number"/>
						<cell align="right" bkcolor2="user22" col="10" colid="BS202_RAT" display="number" edit="expr:iif(YST&#32;==&#32;&apos;A1&apos;,&apos;number&apos;,&apos;none&apos;)" Mask="##0.0"/>
						<cell align="center" bkcolor2="user22" bkimagealign="stretch" bkimageid="btn_grid_01" col="11" cursor="hand" display="button" text="계산"/>
						<cell align="center" bkcolor2="user22" bkimagealign="stretch" bkimageid="btn_grid_01" col="12" cursor="hand" display="button" text="내역"/>
						<cell bkcolor2="user22" col="13" colid="BS202_RMK" display="text" edit="normal"/>
					</body>
					<summary>
						<cell align="center" bkcolor="user25" col="0" color="user26" colspan="4" display="text" font="굴림,9" text="합&#32;계"/>
						<cell align="center" bkcolor="user25" col="4" color="user26" display="text"/>
						<cell align="center" bkcolor="user25" col="5" color="user26" display="text"/>
						<cell align="center" bkcolor="user25" col="6" color="user26" display="text"/>
						<cell align="center" bkcolor="user25" col="7" color="user26" display="text"/>
						<cell align="right" bkcolor="user25" col="8" color="user26" display="number" expr='sum(&quot;BS202_OAM&quot;)'/>
						<cell align="right" bkcolor="user25" col="9" color="user26" display="number" expr='sum(&quot;BS202_EAM&quot;)'/>
						<cell align="right" bkcolor="user25" col="10" color="user26" display="number" expr='ROUND(sum(&quot;BS202_OAM&quot;)/sum(&quot;BS202_EAM&quot;)*100,1)' Mask="##0.0"/>
						<cell align="center" bkcolor="user25" col="11" color="user26" display="text"/>
						<cell align="center" bkcolor="user25" col="12" color="user26" display="text"/>
						<cell align="center" bkcolor="user25" col="13" color="user26" display="text"/>
					</summary>
				</format>
			</contents>
		</Grid>
		<Div Height="36" Id="div_btn" TabOrder="10" Text="Div0" Url="WB01::CommBtnForm.xml" Width="778">
			<Contents></Contents>
		</Div>
		<Static Height="13" Id="st_zipcode2" Left="60" TabOrder="11" Text="우편번호" Top="590" Visible="FALSE" Width="40"></Static>
		<Static Height="13" Id="st_addr2" Left="100" TabOrder="12" Text="주소" Top="590" Visible="FALSE" Width="40"></Static>
		<Static Height="18" Id="st_param" Left="141" TabOrder="13" Text="사양&#32;정보" Top="590" Visible="FALSE" Width="59"></Static>
		<Static Height="13" Id="st_fcd" Left="32" TabOrder="14" Text="선수금&#32;수금조건" Top="616" Visible="FALSE" Width="40"></Static>
		<Static Height="13" Id="st_frt" Left="72" TabOrder="15" Text="선수금&#32;수금율" Top="616" Visible="FALSE" Width="40"></Static>
		<Static Height="13" Id="st_mcd" Left="120" TabOrder="16" Text="중도금&#32;수금조건" Top="616" Visible="FALSE" Width="40"></Static>
		<Static Height="13" Id="st_mrt" Left="160" TabOrder="17" Text="중도금&#32;수금율" Top="616" Visible="FALSE" Width="40"></Static>
		<Static Height="13" Id="st_lcd" Left="200" TabOrder="18" Text="잔금&#32;수금조건" Top="616" Visible="FALSE" Width="40"></Static>
		<Static Height="13" Id="st_lrt" Left="240" TabOrder="19" Text="잔금&#32;수금율" Top="616" Visible="FALSE" Width="40"></Static>
		<Static Height="13" Id="st_ldt" Left="280" TabOrder="20" Text="납기일자" Top="616" Visible="FALSE" Width="40"></Static>
		<Static Height="13" Id="st_curr" Left="376" TabOrder="21" Text="현재일자" Top="618" Visible="FALSE" Width="40"></Static>
		<Static Height="13" Id="st_typ" Left="32" TabOrder="22" Text="기종" Top="632" Visible="FALSE" Width="40"></Static>
		<Calendar Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="146" Id="cal_temp" Left="792" MonthOnly="TRUE" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" OnDayClick="cal_temp_OnDayClick" OnKillFocus="cal_temp_OnKillFocus" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="23" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="176" Value="20080401" Visible="FALSE" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="152"></Calendar>
		<Static Height="13" Id="st_update" Left="464" TabOrder="24" Text="수정" Top="616" Visible="FALSE" Width="40"></Static>
		<Static Height="13" Id="st_delete" Left="496" TabOrder="25" Text="삭제" Top="616" Visible="FALSE" Width="40"></Static>
		<Static Height="13" Id="st_param2" Left="222" TabOrder="26" Text="삭제할" Top="592" Visible="FALSE" Width="40"></Static>
		<Static Height="13" Id="st_sukumrate" Left="280" TabOrder="27" Text="수금율" Top="648" Visible="FALSE" Width="40"></Static>
		<Static Height="13" Id="st_use" Left="72" TabOrder="28" Text="용도" Top="632" Visible="FALSE" Width="40"></Static>
		<Static Height="13" Id="st_man" Left="120" TabOrder="29" Text="인승" Top="632" Visible="FALSE" Width="40"></Static>
		<Static Height="13" Id="st_opn" Left="160" TabOrder="30" Text="열림" Top="632" Visible="FALSE" Width="40"></Static>
		<Static Height="13" Id="st_spd" Left="200" TabOrder="31" Text="속도" Top="632" Visible="FALSE" Width="40"></Static>
		<Static Height="13" Id="st_stp" Left="232" TabOrder="32" Text="층수" Top="632" Visible="FALSE" Width="40"></Static>
		<Shape BKColor="user12" Bottom="66" Height="26" Id="Shape1" Left="7" LineColor="user13" Right="769" TabOrder="33" Top="40" Type="Rectangle" Width="762"></Shape>
		<Shape BKColor="user12" Bottom="91" Height="26" Id="Shape2" Left="7" LineColor="user13" Right="769" TabOrder="34" Top="65" Type="Rectangle" Width="762"></Shape>
		<Static Align="Right" Height="24" Id="Static4" Left="8" Style="sty_lb_form_basic" TabOrder="35" Text="대리점명&#32;" Top="41" VAlign="Middle" Width="95"></Static>
		<Static Align="Right" Height="24" Id="Static11" Left="261" Style="sty_lb_form_basic" TabOrder="37" Text="견적요청등록일&#32;" Top="41" VAlign="Middle" Width="95"></Static>
		<Static Align="Right" Height="24" Id="Static14" Left="515" Style="sty_lb_form_basic" TabOrder="38" Text="견적요청담당자&#32;" Top="41" VAlign="Middle" Width="95"></Static>
		<Edit BindDataset="ds_head" Border="Flat" Column="NAME1" Enable="FALSE" Height="20" Id="ed_name1" Left="105" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="36" Top="43" Width="150"></Edit>
		<Edit BindDataset="ds_head" Border="Flat" CheckLength="Byte" Column="BS201_PID" Height="20" Id="ed_pid" ImeMode="native" Left="612" LeftMargin="4" MaxLength="10" RightMargin="4" Style="sty_ipt_form" TabOrder="44" Top="68" Width="150"></Edit>
		<Static Align="Right" Height="24" Id="st_tel" Left="515" Style="sty_lb_form_basic" TabOrder="42" Text="면담자&#32;" Top="66" VAlign="Middle" Width="95"></Static>
		<Edit BindDataset="ds_head" Border="Flat" Column="BS201_SPT" Height="20" Id="ed_spt" Left="358" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="43" Top="68" Width="150"></Edit>
		<Static Align="Right" Height="24" Id="st_spt" Left="261" Style="sty_lb_form_basic" TabOrder="41" Text="공사명&#32;" Top="66" VAlign="Middle" Width="95"></Static>
		<Edit BindDataset="ds_head" Border="Flat" Column="BS201_GNM" Height="20" Id="ed_gnm" Left="105" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="40" Top="68" Width="150"></Edit>
		<Static Align="Right" Height="24" Id="st_gnm" Left="8" Style="sty_lb_form_basic" TabOrder="39" Text="발주처&#32;" Top="66" VAlign="Middle" Width="95"></Static>
		<Shape BKColor="user12" Bottom="116" Height="26" Id="Shape0" Left="7" LineColor="user13" Right="769" TabOrder="45" Top="90" Type="Rectangle" Width="762"></Shape>
		<Static Align="Right" Height="24" Id="Static3" Left="8" Style="sty_lb_form_basic" TabOrder="46" Text="현장주소&#32;" Top="91" VAlign="Middle" Width="95"></Static>
		<Button Height="18" Id="btn_zipcode2" ImageID="btn_icon_search" Left="166" OnClick="Button1_OnClick" TabOrder="47" Text="Button0" Top="94" Transparent="TRUE" Width="18"></Button>
		<Edit BindDataset="ds_head" Border="Flat" CheckLength="Byte" Column="BS201_AD1" Height="20" Id="ed_addr2" Left="185" MaxLength="100" Readonly="TRUE" Style="sty_ipt_form" TabOrder="48" Top="93" Width="170"></Edit>
		<Edit BindDataset="ds_head" Border="Flat" CheckLength="Byte" Column="BS201_AD2" Height="20" Id="ed_addrdetail2" Left="358" MaxLength="100" Style="sty_ipt_form" TabOrder="49" Top="93" Width="150"></Edit>
		<MaskEdit BindDataset="ds_head" Border="Flat" Column="BS201_ZIP" Height="20" Id="med_zipcode2" Left="105" LeftMargin="10" Mask="###-###" MaxLength="7" Style="sty_ipt_form" TabOrder="50" Top="93" Type="STRING" Width="60"></MaskEdit>
		<Calendar BindDataset="ds_head" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="BS201_CDT" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Enable="FALSE" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_cdt" Left="358" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="51" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="43" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="150"></Calendar>
		<Static Align="Right" Height="24" Id="Static0" Left="515" Style="sty_lb_form_basic" TabOrder="52" Text="현장연락처&#32;" Top="91" VAlign="Middle" Width="95"></Static>
		<Edit BindDataset="ds_head" Border="Flat" Column="BS201_TEL" Height="20" Id="ed_tel" Left="612" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="53" Top="93" Width="150"></Edit>
		<Combo BindDataset="ds_head" Border="Flat" CodeColumn="CODE" Column="BS201_CID" DataColumn="CODE_NAME" Enable="FALSE" Height="20" Id="cb_cid" INDEX="0" InnerDataset="ds_userp" Left="611" Style="sty_ipt_search" TabOrder="54" Top="42" Width="152"></Combo>
		<Shape BKColor="user12" Bottom="141" Height="26" Id="Shape3" Left="7" LineColor="user13" Right="769" TabOrder="55" Top="115" Type="Rectangle" Width="762"></Shape>
		<Static Align="Right" Height="24" Id="Static1" Left="8" Style="sty_lb_form_basic" TabOrder="56" Text="시행사&#32;" Top="116" VAlign="Middle" Width="95"></Static>
		<Shape BKColor="user12" Bottom="166" Height="26" Id="Shape4" Left="7" LineColor="user13" Right="769" TabOrder="57" Top="140" Type="Rectangle" Width="762"></Shape>
		<Static Align="Right" Height="24" Id="Static6" Left="261" Style="sty_lb_form_basic" TabOrder="58" Text="제품구분&#32;" Top="116" VAlign="Middle" Width="95"></Static>
		<Combo BindDataset="ds_head" Border="Flat" CodeColumn="CODE" Column="BS201_GBN" DataColumn="CODE_NAME" Enable="FALSE" Height="20" Id="Combo0" InnerDataset="ds_gbn2" Left="357" Style="sty_ipt_search" TabOrder="59" Top="117" Width="152"></Combo>
		<Static Align="Right" Height="24" Id="Static7" Left="515" Style="sty_lb_form_basic" TabOrder="60" Text="견적구분&#32;" Top="116" VAlign="Middle" Width="95"></Static>
		<Combo BindDataset="ds_head" Border="Flat" CodeColumn="CODE" Column="BS201_AGB" DataColumn="CODE_NAME" Enable="FALSE" Height="20" Id="Combo1" InnerDataset="ds_gbn3" Left="611" Style="sty_ipt_search" TabOrder="61" Top="117" Width="152"></Combo>
		<Static Align="Right" Height="24" Id="Static8" Left="261" Style="sty_lb_form_basic" TabOrder="62" Text="진행상태&#32;" Top="141" VAlign="Middle" Width="95"></Static>
		<Combo BindDataset="ds_head" Border="Flat" CodeColumn="CODE" Column="BS201_YST" DataColumn="CODE_NAME" Enable="FALSE" Height="20" Id="Combo2" InnerDataset="ds_pst" Left="357" Style="sty_ipt_search" TabOrder="63" Top="142" Width="152"></Combo>
		<Edit BindDataset="ds_head" Border="Flat" Column="BS201_DEV" Enable="FALSE" Height="20" Id="ed_dev" Left="105" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="64" Top="118" Width="150"></Edit>
		<Static Align="Right" Height="24" Id="st_buse" Left="8" Style="sty_lb_form_basic" TabOrder="65" Text="건물용도&#32;" Top="141" VAlign="Middle" Width="95"></Static>
		<Combo BindDataset="ds_head" Border="Flat" CodeColumn="CODE" Column="BS201_USE" DataColumn="CODE_NAME" Enable="FALSE" Height="20" Id="cb_buse" InnerDataset="ds_buse" Left="104" Style="sty_ipt_form" TabOrder="66" Top="142" Width="152"></Combo>
		<Static Color="user6" Font="굴림,9,Bold" Height="20" Id="st_txt" Left="21" TabOrder="68" Text="특기사항" Top="290" VAlign="Middle" Width="254"></Static>
		<Shape BKColor="user12" Bottom="336" Height="24" Id="Shape8" Left="7" LineColor="user13" Right="769" TabOrder="69" Top="312" Type="Rectangle" Width="762"></Shape>
		<Static Align="Right" Height="22" Id="st_t01" Left="8" Style="sty_lb_form_basic" TabOrder="70" Text="1.&#32;" Top="313" VAlign="Middle" Width="45"></Static>
		<Edit BindDataset="ds_head" Border="Flat" Column="BS201_T01" Height="20" Id="ed_t01" Left="55" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="71" Top="314" Width="711"></Edit>
		<Shape BKColor="user12" Bottom="359" Height="24" Id="Shape6" Left="7" LineColor="user13" Right="769" TabOrder="72" Top="335" Type="Rectangle" Width="762"></Shape>
		<Static Align="Right" Height="22" Id="st_t02" Left="8" Style="sty_lb_form_basic" TabOrder="73" Text="2.&#32;" Top="336" VAlign="Middle" Width="45"></Static>
		<Edit BindDataset="ds_head" Border="Flat" Column="BS201_T02" Height="20" Id="ed_t02" Left="55" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="74" Top="337" Width="711"></Edit>
		<Shape BKColor="user12" Bottom="382" Height="24" Id="Shape7" Left="7" LineColor="user13" Right="769" TabOrder="75" Top="358" Type="Rectangle" Width="762"></Shape>
		<Static Align="Right" Height="22" Id="st_t03" Left="8" Style="sty_lb_form_basic" TabOrder="76" Text="3.&#32;" Top="359" VAlign="Middle" Width="45"></Static>
		<Edit BindDataset="ds_head" Border="Flat" Column="BS201_T03" Height="20" Id="ed_t03" Left="55" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="77" Top="360" Width="711"></Edit>
		<Shape BKColor="user12" Bottom="405" Height="24" Id="Shape9" Left="7" LineColor="user13" Right="769" TabOrder="67" Top="381" Type="Rectangle" Width="762"></Shape>
		<Edit BindDataset="ds_head" Border="Flat" Column="BS201_T04" Height="20" Id="ed_t04" Left="55" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="79" Top="383" Width="711"></Edit>
		<Static Align="Right" Height="22" Id="st_t04" Left="8" Style="sty_lb_form_basic" TabOrder="78" Text="4.&#32;" Top="382" VAlign="Middle" Width="45"></Static>
		<Shape BKColor="user12" Bottom="428" Height="24" Id="Shape10" Left="7" LineColor="user13" Right="769" TabOrder="80" Top="404" Type="Rectangle" Width="762"></Shape>
		<Static Align="Right" Height="22" Id="st_t05" Left="8" Style="sty_lb_form_basic" TabOrder="81" Text="5.&#32;" Top="405" VAlign="Middle" Width="45"></Static>
		<Edit BindDataset="ds_head" Border="Flat" Column="BS201_T05" Height="20" Id="ed_t05" Left="55" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="82" Top="406" Width="711"></Edit>
		<Image Height="19" Id="Image2" ImageID="form_bl_title_sub" Left="8" TabOrder="83" Top="289" Width="11"></Image>
	</Form>
	<Script><![CDATA[﻿﻿﻿﻿﻿﻿﻿﻿/*
 ******************************************************************************************
 * 기      능   : 
 * 작  성  자   : 
 * 작성  일자   : 
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
#include "LIB::commons.js";	// 공통 스크립트 
#include "LIB::utility.js";	// 다중 선택 
//=========================================================================================
// [ PART 1 ]
// Form에서 사용될 전역변수를 선언
// FORM에서 사용되는 전역변수는 대문자로 작성하며, F_XXX 의 형태를 갖도록 한다. 
//=========================================================================================
var userGroup;
var gRow = null;
//=========================================================================================
// [ PART 2 ]
// Form Loading / Unloading 시 작업 정의
//=========================================================================================
function fn_OnLoadCompleted(obj) {
	gfn_initForm();

	userGroup = gfn_getUserGroup();

	ds_cond2.SetColumn(0,"GNO",ds_list.GetColumn(ds_list.row,"BS201_GNO"));
	ds_cond2.SetColumn(0,"RDT",ds_list.GetColumn(ds_list.row,"BS201_RDT"));
	ds_cond2.SetColumn(0,"SEQ",ds_list.GetColumn(ds_list.row,"BS201_SEQ"));
	ds_cond2.SetColumn(0,"SIR",ds_list.GetColumn(ds_list.row,"BS201_SIR"));
	ds_cond2.SetColumn(0,"GBN","2");

	//코드콤보 설정 : 지역, 구분2 
	var codeArr = ["BS102","CS131","BS403","EL_ZATYP","EL_ZAUSE","EL_ZAMAN","EL_ZAOPEN","EL_ZASPD","BS107"];
	var dsObjArr = [ds_sukum,ds_gbn2,ds_buse,ds_typ,ds_use,ds_man,ds_opn,ds_spd,ds_pst];
	var addTypeArr = [G_CODE_NONE,G_CODE_NONE,G_CODE_NONE,G_CODE_NONE,G_CODE_NONE,G_CODE_NONE,G_CODE_NONE,G_CODE_NONE,G_CODE_NONE];
	gfn_searchCommCode(codeArr, dsObjArr, addTypeArr);

	tit_clearActionInfo();
	tit_addSearchActionInfo("bs01:BS0102001A_S4");

	tit_callService(
        ""
        , ""
        , "ds_cond=ds_cond2"
        , "ds_userp=ds_userp"
        , ""
        , "fn_afterUser"
        , true
        , true);
}

/********************************************************************************
* 기      능   : 공통코드가 조회된 후의 Callback 함수 
********************************************************************************/
function fn_completeInit(sCode, sDsObj, sCodeType) {
	div_btn.btn_recost.enable = false;
}

/********************************************************************************
* 기      능   : form UnloadCompleted 
********************************************************************************/
function fn_OnUnloadCompleted(obj) {
	return gfn_isFormUnload(obj);
}

//=========================================================================================
// [ PART 3 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,form닫기)
//=========================================================================================
/********************************************************************************
* 기      능   : 조회 
********************************************************************************/
function fn_query() {
	ds_cond2.SetColumn(0, "GRP", userGroup);

	tit_clearActionInfo();
	tit_addSearchActionInfo("bs01:BS0102009A_S1");
	tit_addSearchActionInfo("bs01:BS0102009A_S2");

	tit_callService(
        ""
        , ""
        , "ds_cond=ds_cond2"
        , "ds_head=ds_head ds_list2=ds_list2"
        , ""
        , "fn_afterQuery"
        , true
        , true);
}

/********************************************************************************
* 기      능   : 조회 Callback  
********************************************************************************/
function fn_afterQuery(errCode, errMsg) {
	gfn_showMsg("CI00002",ds_list2.RowCount()+"");

	if(ds_head.GetColumn(0, "BS201_YST") == "A1") {
//		ed_t01.Enable = true;
//		ed_t02.Enable = true;
//		ed_t03.Enable = true;
//		ed_t04.Enable = true;
//		ed_t05.Enable = true;
	} else {
//		ed_t01.Enable = false;
//		ed_t02.Enable = false;
//		ed_t03.Enable = false;
//		ed_t04.Enable = false;
//		ed_t05.Enable = false;

		if(ds_head.GetColumn(0, "BS201_YST") == "A6" && ds_head.GetColumn(0, "CHK_203") == "0") {
			div_btn.btn_recost.enable = true;
		}
	}

	if(ds_head.rowcount == 0) {
		ds_head.AddRow();
	}
}

/********************************************************************************
* 기      능   : 조회 Callback  
********************************************************************************/
function fn_afterUser(errCode, errMsg) {
	fn_query();
}

/********************************************************************************
* 기      능   : 전송
********************************************************************************/
function fn_trans() {
	if(ds_head.GetColumn(0, "BS201_YST") > "A1") {
		gfn_showAlert("작성상태에서만 전송이 가능합니다.");
		return false;
	}

	for(var i=0; i<ds_list2.rowcount; i++) {
		if(ds_list2.GetColumn(i,"BS202_RAT") == 0) {
			gfn_showAlert(parseInt(i) + 1 + "번째 행의 시행율을 확인하십시요.\n시행율은 0%보다 커야 합니다.");
			return;
		}

		if(ds_list2.GetColumn(i,"BS202_RAT") > 110) {
			gfn_showAlert(parseInt(i) + 1 + "번째 행의 시행율을 확인하십시요.\n시행율은 110%보다 작아야 합니다.");
			return;
		}
	}

	if(Confirm("특기사항과 시행율을 모두 입력하셨습니까?") == true) {
		ds_cond2.SetColumn(0, "T01", ed_t01.value);
		ds_cond2.SetColumn(0, "T02", ed_t02.value);
		ds_cond2.SetColumn(0, "T03", ed_t03.value);
		ds_cond2.SetColumn(0, "T04", ed_t04.value);
		ds_cond2.SetColumn(0, "T05", ed_t05.value);

		tit_clearActionInfo();
		tit_addSelectExActionInfo("bs01:BS0102009A_S3", "", "bs01:BS0102009A_U1");
		tit_addMultiActionInfo("bs01:BS0102009A_U3");

		tit_callService(
			""
			, ""
			, "ds_cond2=ds_cond2 ds_list2=ds_list2"
			, ""
			, ""
			, "fn_afterTrans"
			, true);
	} else {
		return;
	}
}

/********************************************************************************
* 기      능   : 재견적
********************************************************************************/
function fn_recost() {
	if(gfn_isNull(ed_gnm, true, ed_gnm.Value)) return false; // 발주처
	if(gfn_isNull(ed_spt, true, ed_spt.Value)) return false; // 공사명
	if(gfn_isNull(ed_tel, true, ed_tel.Value)) return false; // 현장연락처
	if(gfn_isNull(med_zipcode2, true, med_zipcode2.Value)) return false; // 우편번호
	if(gfn_isNull(ed_addr2, true, ed_addr2.Value)) return false; // 주소1

	// 수금조건율정보 필수입력 체크
	var dsArr = ["BS201_FCD","BS201_FRT","BS201_MCD","BS201_MRT","BS201_LCD","BS201_LRT","BS201_LDT"];
	var lbArr = [st_fcd.value,st_frt.value,st_mcd.value,st_mrt.value,st_lcd.value,st_lrt.value,st_ldt.value];

	if(gfn_isGridNull(grd_head,dsArr,lbArr,"")) {
		return;
	}

	if(parseFloat(ds_head.GetColumn(0,"BS201_FRT")) + parseFloat(ds_head.GetColumn(0,"BS201_MRT")) + parseFloat(ds_head.GetColumn(0,"BS201_LRT")) != 100) {
		//수금율의 합은 100%이어야 합니다.\n확인하여 주십시오.
		var arr = [st_sukumrate.value, "100%"];
		gfn_showMsg("CW00142",arr);
		return;
	}

	if(ds_head.GetColumn(0,"BS201_LDT") <= gfn_getCurrDate()) {
		var arr = [st_ldt.value, st_curr.value];
		gfn_showMsg("CW00024",arr);
		return;
	}

	if(ds_list2.rowcount == 0) {
		gfn_showMsg("CW00113",st_param.value);
		return;
	}

	// 사양및견적정보 필수입력 체크
	var dsArr = ["BS202_TYP","BS202_USE","BS202_MAN","BS202_OPN","BS202_SPD","BS202_STP"];
	var lbArr = [st_typ.value,st_use.value,st_man.value,st_opn.value,st_spd.value,st_stp.value];

	if(gfn_isGridNull(grd_list2,dsArr,lbArr,"")) {
		return;
	}

	var spc;
	for(var i=0; i<ds_list2.rowcount; i++) {
		if(ds_list2.GetColumn(i,"BS202_RAT") > 110) {
			gfn_showAlert(parseInt(i) + "번째 행의 시행율을 확인하십시요.\n시행율은 110%보다 작아야 합니다.");
			return;
		}

		ds_list2.SetColumn(i,"BS202_RDT",ds_head.GetColumn(0,"BS201_RDT"));
		ds_list2.SetColumn(i,"BS202_SEQ",ds_head.GetColumn(0,"BS201_SEQ"));
		ds_list2.SetColumn(i,"BS202_SIR",ds_head.GetColumn(0,"BS201_SIR"));

		//용도 + 인승(용량) + '-' +OPEN 타입 + 속도 + '-' + 층수 + '/' + 정지층수
		spc = ds_list2.GetColumn(i, "BS202_USE") + ds_list2.GetColumn(i, "BS202_MAN")
				+ '-' + ds_list2.GetColumn(i, "BS202_OPN") + ds_list2.GetColumn(i, "BS202_SPD") 
				+ '-' + ds_list2.GetColumn(i, "BS202_STP");

		ds_list2.SetColumn(i, "BS202_SPC", spc);
	}

	ds_head.SetColumn(0,"BS201_QTY",1);
	ds_head.SetColumn(0,"BS201_EAM",0);
	ds_head.SetColumn(0,"BS201_OAM",0);
	ds_head.SetColumn(0,"BS201_RAT",0);

	if(!gfn_showConfirm("CI00024","재견적")) {
		return;
	}

	tit_clearActionInfo();

	tit_addSingleActionInfo("bs01:BS0102009A_I1");
	tit_addMultiActionInfo("bs01:BS0102009A_I2");
	tit_addSingleActionInfo("bs01:BS0102009A_I3");

	tit_callService(
		""
		, ""
		, "ds_head=ds_head ds_list2=ds_list2"
		, ""
		, ""
		, "fn_afterRecost"
		, true);
}

/********************************************************************************
* 기      능   : 재견적 Callback
********************************************************************************/
function fn_afterRecost(errCode, errMsg) {
	if(errCode != 0) {
		gfn_showMsg("CE00001");
	} else {
		gfn_showMsg("CI00003");
		close();
	}
}

/********************************************************************************
* 기      능   : 전송 Callback
********************************************************************************/
function fn_afterTrans(errCode, errMsg) {
	if(errCode != 0) {
		gfn_showMsg("CE00001");
	} else {
		gfn_showMsg("CI00006", "전송");
		fn_query();
	}
}

/********************************************************************************
* 기      능   : 계산 Callback  
********************************************************************************/
function fn_afterSave(errCode, errMsg) {
	if(errCode != 0) {
		gfn_showMsg("CE00001");
	} else {
		gfn_showMsg("CI00005");
		//fn_query();
		fn_EamSave();
	}
}

/********************************************************************************
* 기      능   : 닫기  
********************************************************************************/
function fn_close() {
	close();
}

//=========================================================================================
// [ PART 4]
// Callback 함수 정의 : callback 함수명은 메인 함수의 fn_xxxx() 에서 xxxx 부분은 fn_afterXXXX()
// 형태가 되도록 작성 
//=========================================================================================

/********************************************************************************
* 기      능   : 액셀  
********************************************************************************/
function fn_excel() {
	gfn_saveToExcel(grd_list2, true);
}

/********************************************************************************
* 기      능   : 그리드2에 DATASET변경시
********************************************************************************/
function ds_list2_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex) {
	switch(strColumnID) {
		case "CHK":
			if(ds_list2.getColumn(nRow, "CHK") == "1") {
				if(gRow != null) {
					ds_list2.SetColumn(gRow, "CHK", "0");
				}
	
				gRow = nRow;
	
//				var arg = "pst=" + quote(cb_pst.Text);
				var arg = "";
				gfn_openPopup("BS0102010A",true,arg);
				FROW = ds_list.row;
				fn_query();
			} else {
				if(gRow == nRow) {
					gRow = null;
				}
			}
		case "BS202_OAM":	// 원가
			if(ds_list2.GetColumn(nRow,"BS202_EAM") == 0) {
				ds_list2.SetColumn(nRow,"BS202_RAT",0);
			} else {
				ds_list2.SetColumn(nRow,"BS202_RAT",ROUND(parseFloat(ds_list2.GetColumn(nRow,"BS202_OAM")*100)/parseFloat(ds_list2.GetColumn(nRow,"BS202_EAM")),1));
			}
			break;
	}	
}

/********************************************************************************
* 기      능   : 그리드 더블 클릭시 팝업연동
********************************************************************************/
function grd_list2_OnCellDblClick(obj,nRow,nCell,nX,nY,nPivotIndex) {
	if(nCell <> 10 && nCell <> 11 && nCell <> 12) {
//		var arg = "";
//		gfn_openPopup("BS0102010A",true,arg);
//		FROW = ds_list.row;
//		fn_query();
	} else if(nCell == 11) {
		if(userGroup >= 30) {
			if(ds_head.GetColumn(0, "BS201_YST") <> "A3") {
				gfn_showAlert("요청상태에서만 계산이 가능합니다.");
				return false;
			} else {
				fn_Calc();
			}
		} else {
			gfn_showAlert("사용 권한이 없습니다.");
			return false;
		}
	} else if(nCell == 10) {
	} else {
		var arg = "";
		gfn_openPopup("BS0102011A",true,arg);
/*
		if(userGroup >= 30) {
			var arg = "";
			gfn_openPopup("BS0102011A",true,arg);
		} else {
			gfn_showAlert("사용 권한이 없습니다.");
			return false;
		}
*/
	}
}

function fn_Calc() {
	ds_cond3.Reset();
	ds_list3.Reset();

	ds_cond3.SetColumn(0, "RDT", ds_list2.GetColumn(ds_list2.currow, "BS202_RDT"));
	ds_cond3.SetColumn(0, "SEQ", ds_list2.GetColumn(ds_list2.currow, "BS202_SEQ"));
	ds_cond3.SetColumn(0, "SIR", ds_list2.GetColumn(ds_list2.currow, "BS202_SIR"));
	ds_cond3.SetColumn(0, "ISR", ds_list2.GetColumn(ds_list2.currow, "BS202_ISR"));

	tit_clearActionInfo();
	tit_addSearchActionInfo("bs01:BS0102009A_S4");

	tit_callService(
        ""
        , ""
        , "ds_cond3=ds_cond3"
        , "ds_list3=ds_list3"
        , ""
        , "fn_afterCalc"
        , true
        , true);
}

function fn_afterCalc(errCode, errMsg) {
	if(errCode != 0) {
		gfn_showMsg("CE00001");
	} else {
		fn_CallRfc();
	}
}

function fn_CallRfc() {
	ds_in.Reset();

	ds_in.SetColumn(0, "RDT", ds_list2.GetColumn(ds_list2.currow, "BS202_RDT"));
	ds_in.SetColumn(0, "SEQ", ds_list2.GetColumn(ds_list2.currow, "BS202_SEQ"));
	ds_in.SetColumn(0, "SIR", ds_list2.GetColumn(ds_list2.currow, "BS202_SIR"));
	ds_in.SetColumn(0, "ISR", ds_list2.GetColumn(ds_list2.currow, "BS202_ISR"));

	tit_callService(
		"BS0102009A_ACT"
		, "save"
		, "ds_in=ds_in ds_list3=ds_list3"
		, "ds_error=ds_error"
		, ""
		, "fn_afterSave");
}

function fn_EamSave() {
	ds_in2.Reset();

	ds_in2.SetColumn(0, "RDT", ds_list2.GetColumn(ds_list2.currow, "BS202_RDT"));
	ds_in2.SetColumn(0, "SEQ", ds_list2.GetColumn(ds_list2.currow, "BS202_SEQ"));
	ds_in2.SetColumn(0, "SIR", ds_list2.GetColumn(ds_list2.currow, "BS202_SIR"));
	ds_in2.SetColumn(0, "ISR", ds_list2.GetColumn(ds_list2.currow, "BS202_ISR"));

	tit_clearActionInfo();
	tit_addSingleActionInfo("bs01:BS0102009A_U2");

	tit_callService(
		""
		, ""
		, "ds_in2=ds_in2"
		, ""
		, ""
		, "fn_afterEamSave"
		, true);
}

function fn_afterEamSave(errCode, errMsg) {
	if(errCode != 0) {
		gfn_showMsg("견적금액 저장시 오류가 발생하였습니다.\n정보기술실에 문의 바랍니다.");
	} else {
		fn_query();
	}
}

// 달력 처리 부분 
/********************************************************************************
* 기      능   : 그리드에서 날짜 입력시 
********************************************************************************/
function grd_head_OnExpandEdit(obj,nRow,nCell,strVal,nPivotIndex) {
	var rect = obj.GetCellRect(nRow, ncell);
	cal_temp.top = rect[1] + 140;
	cal_temp.Left = rect[0] - 50; 
	cal_temp.Visible = true;
	cal_temp.value = ds_head.getColumn(nRow, "BS201_LDT");
	cal_temp.SetFocus();
}

/********************************************************************************
* 기      능   : 달력에서 일자 선택했을 경우 
********************************************************************************/
function cal_temp_OnDayClick(obj,strText) {
	ds_head.SetColumn(ds_head.row, "BS201_LDT", strText);
	obj.Visible = false;
}

/********************************************************************************
* 기      능   : 달력에서 포커스 잃었을 경우 
********************************************************************************/
function cal_temp_OnKillFocus(obj) {
	obj.Visible = false;
}
]]></Script>
</Window>