<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="440" Id="CS1241001C" Left="8" OnLoadCompleted="fn_OnLoadCompleted" OnUnloadCompleted="fn_OnUnloadCompleted" PidAttrib="7" Title="교육&#32;수료내역&#32;상세" Top="8" Ver="1.0" Width="792" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_cond2">
				<Contents>
					<colinfo id="PSNO" size="256" summ="default" type="STRING"/>
					<record>
						<PSNO></PSNO>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list">
				<Contents>
					<colinfo id="VKGRP" size="256" summ="default" type="STRING"/>
					<colinfo id="VKGRP_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN1" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN1_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN2" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN2_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="C_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="C_DATE" size="256" summ="default" type="STRING"/>
					<colinfo id="E_DATE" size="256" summ="default" type="STRING"/>
					<colinfo id="Q_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="Q_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="RMK" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="AS_ARA" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_gbn">
				<Contents>
					<colinfo id="CODE" size="255" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="255" summ="default" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME>-&#32;선택&#32;-</CODE_NAME>
					</record>
					<record>
						<CODE>A</CODE>
						<CODE_NAME>기술인력</CODE_NAME>
					</record>
					<record>
						<CODE>B</CODE>
						<CODE_NAME>책임인력</CODE_NAME>
					</record>
					<record>
						<CODE>C</CODE>
						<CODE_NAME>실무인력</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_gbn2">
				<Contents>
					<colinfo id="CODE" size="255" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="255" summ="default" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME>-&#32;선택&#32;-</CODE_NAME>
					</record>
					<record>
						<CODE>1</CODE>
						<CODE_NAME>중저속</CODE_NAME>
					</record>
					<record>
						<CODE>2</CODE>
						<CODE_NAME>고속</CODE_NAME>
					</record>
					<record>
						<CODE>3</CODE>
						<CODE_NAME>ES,&#32;MW</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_vkgrp_cd">
				<Contents>
					<colinfo id="CODE" size="255" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="255" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list4">
				<Contents>
					<colinfo id="VKGRP" size="256" summ="default" type="STRING"/>
					<colinfo id="VKGRP_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN1" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN1_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN2" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN2_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="C_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="C_DATE" size="256" summ="default" type="STRING"/>
					<colinfo id="E_DATE" size="256" summ="default" type="STRING"/>
					<colinfo id="Q_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="Q_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="RMK" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="PSNO" size="256" summ="default" type="STRING"/>
					<record>
						<C_DATE></C_DATE>
						<C_NO></C_NO>
						<CHK></CHK>
						<E_DATE></E_DATE>
						<GBN></GBN>
						<GBN1></GBN1>
						<GBN1_NM></GBN1_NM>
						<GBN2></GBN2>
						<GBN2_NM></GBN2_NM>
						<GBN_NM></GBN_NM>
						<PSNO/>
						<Q_NM></Q_NM>
						<Q_NO></Q_NO>
						<RMK></RMK>
						<SEQ></SEQ>
						<VKGRP></VKGRP>
						<VKGRP_NM></VKGRP_NM>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_asara">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME>-&#32;전체&#32;-</CODE_NAME>
					</record>
					<record>
						<CODE>E5</CODE>
						<CODE_NAME>서울</CODE_NAME>
					</record>
					<record>
						<CODE>G1</CODE>
						<CODE_NAME>부산</CODE_NAME>
					</record>
					<record>
						<CODE>G2</CODE>
						<CODE_NAME>대구</CODE_NAME>
					</record>
					<record>
						<CODE>G3</CODE>
						<CODE_NAME>광주</CODE_NAME>
					</record>
					<record>
						<CODE>G4</CODE>
						<CODE_NAME>대전</CODE_NAME>
					</record>
					<record>
						<CODE>G5</CODE>
						<CODE_NAME>전주</CODE_NAME>
					</record>
					<record>
						<CODE>G6</CODE>
						<CODE_NAME>강원</CODE_NAME>
					</record>
					<record>
						<CODE>G7</CODE>
						<CODE_NAME>울산</CODE_NAME>
					</record>
					<record>
						<CODE>G8</CODE>
						<CODE_NAME>인천</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
		</Datasets>
		<Shape BKColor="user12" Bottom="115" Height="26" Id="Shape0" Left="7" LineColor="user13" Right="779" TabOrder="36" Top="89" Type="Rectangle" Width="772"></Shape>
		<Shape BKColor="user12" Bottom="165" Height="26" Id="Shape4" Left="7" LineColor="user13" Right="779" TabOrder="37" Top="139" Type="Rectangle" Width="772"></Shape>
		<Shape BKColor="user12" Bottom="140" Height="26" Id="Shape3" Left="7" LineColor="user13" Right="779" TabOrder="35" Top="114" Type="Rectangle" Width="772"></Shape>
		<Shape BKColor="user12" Bottom="66" Height="26" Id="Shape1" Left="7" LineColor="user13" Right="779" TabOrder="3" Top="40" Type="Rectangle" Width="772"></Shape>
		<Static Align="Right" Height="24" Id="Static1" Left="393" Style="sty_lb_form_basic" TabOrder="12" Text="자격구분&#32;" Top="41" VAlign="Middle" Width="80"></Static>
		<Grid AutoEnter="TRUE" AutoFitEndLine="Hide" BindDataset="ds_list" BkColor2="default" BoldHead="true" Border="Flat" Bottom="432" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="264" Id="grd_list2" InputPanel="FALSE" Left="8" LineColor="user20" LineType="ExHORZ" Right="776" RowHeight="20" Style="sty_grid" TabOrder="1" TabStop="true" Top="168" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="768">
			<contents>
				<format id="Default">
					<columns>
						<col width="30"/>
						<col width="30"/>
						<col width="60"/>
						<col width="60"/>
						<col width="100"/>
						<col width="80"/>
						<col width="80"/>
						<col width="100"/>
						<col width="100"/>
						<col width="200"/>
					</columns>
					<head>
						<cell col="0" display="checkbox" edit="checkbox" font="굴림,9"/>
						<cell align="center" col="1" color="user21" display="text" font="굴림,9" text="No"/>
						<cell align="center" col="2" color="user21" display="text" font="굴림,9" text="교육구분"/>
						<cell align="center" col="3" color="user21" display="text" font="굴림,9" text="교육과정"/>
						<cell align="center" col="4" color="user21" display="text" font="굴림,9" text="수료증번호"/>
						<cell align="center" col="5" color="user21" display="text" font="굴림,9" text="수료일"/>
						<cell align="center" col="6" color="user21" display="text" font="굴림,9" text="유효기간"/>
						<cell align="center" col="7" color="user21" display="text" font="굴림,9" text="자격명"/>
						<cell align="center" col="8" color="user21" display="text" font="굴림,9" text="자격번호"/>
						<cell align="center" col="9" color="user21" display="text" font="굴림,9" text="비고"/>
					</head>
					<body>
						<cell align="center" bkcolor2="user22" col="0" colid="CHK" display="checkbox" edit="checkbox"/>
						<cell align="center" bkcolor2="user22" col="1" display="text" expr="currow+1"/>
						<cell align="center" bkcolor2="user22" col="2" colid="GBN1_NM" combocol="CODE" combodataset="ds_gbn" combotext="CODE_NAME" display="text" limit="100" Valign="Center"/>
						<cell align="center" bkcolor2="user22" col="3" colid="GBN2_NM" combocol="CODE" combodataset="ds_gbn2" combotext="CODE_NAME" display="text" limit="100" Valign="Center"/>
						<cell align="center" bkcolor2="user22" col="4" colid="C_NO" display="text" limit="100" Valign="Center"/>
						<cell align="center" bkcolor2="user22" col="5" colid="C_DATE" display="text" limit="100" Mask="####.##.##" Valign="Center"/>
						<cell align="center" bkcolor2="user22" col="6" colid="E_DATE" display="text" limit="100" Mask="####.##.##" Valign="Center"/>
						<cell align="center" bkcolor2="user22" col="7" colid="Q_NM" display="text" limit="100" Valign="Center"/>
						<cell align="center" bkcolor2="user22" col="8" colid="Q_NO" display="text" limit="100" Valign="Center"/>
						<cell align="left" bkcolor2="user22" col="9" colid="RMK" display="text" limit="100" multiline="true" wordwrap="exchar"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Div Height="36" Id="div_btn" TabOrder="2" Text="Div0" ToolTipFont="Default,0" Url="WB01::CommBtnForm.xml" Width="792">
			<Contents></Contents>
		</Div>
		<Static Align="Right" Height="24" Id="st_irum" Left="8" Style="sty_lb_form_basic" TabOrder="4" Text="성명&#32;" Top="41" VAlign="Middle" Width="80"></Static>
		<Edit Align="CENTER" Border="Flat" Enable="FALSE" Height="20" Id="ed_irum" Left="89" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="5" Top="43" Width="110"></Edit>
		<Static Align="Right" Height="24" Id="st_psno" Left="201" Style="sty_lb_form_basic" TabOrder="6" Text="사번&#32;" Top="41" VAlign="Middle" Width="80"></Static>
		<Edit Align="CENTER" BindDataset="ds_cond2" Border="Flat" Column="PSNO" Enable="FALSE" Height="20" Id="ed_psno" ImeMode="none" Left="282" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="7" Top="43" Width="110"></Edit>
		<Calendar Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="146" Id="cal_temp" Left="904" MonthOnly="TRUE" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" OnDayClick="cal_temp_OnDayClick" OnKillFocus="cal_temp_OnKillFocus" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="8" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="280" Value="20130513" Visible="FALSE" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="152"></Calendar>
		<Edit Align="CENTER" Border="Flat" Enable="FALSE" Height="20" Id="ed_gbn" Left="474" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="10" Top="43" Width="110"></Edit>
		<Static Align="Right" Height="24" Id="Static0" Left="586" Style="sty_lb_form_basic" TabOrder="9" Text="배치부서&#32;" Top="41" VAlign="Middle" Width="80"></Static>
		<Edit Align="CENTER" Border="Flat" Enable="FALSE" Height="20" Id="ed_vkgrp" Left="667" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="11" Top="43" Width="110"></Edit>
		<Static Align="Right" Height="24" Id="Static2" Left="393" Style="sty_lb_form_basic" TabOrder="13" Text="자격구분&#32;" Top="41" VAlign="Middle" Width="80"></Static>
		<Shape BKColor="user12" Bottom="90" Height="26" Id="Shape6" Left="7" LineColor="user13" Right="779" TabOrder="14" Top="64" Type="Rectangle" Width="772"></Shape>
		<Static Align="Right" Height="24" Id="st_vkgrp" Left="201" Style="sty_lb_form_basic" TabOrder="15" Text="배치부서&#32;" Top="65" VAlign="Middle" Width="80"></Static>
		<Static Align="Right" Height="24" Id="st_gbn2" Left="586" Style="sty_lb_form_basic" TabOrder="16" Text="교육과정&#32;" Top="90" VAlign="Middle" Width="80"></Static>
		<Static Align="Right" Height="24" Id="st_gbn1" Left="586" Style="sty_lb_form_basic" TabOrder="18" Text="교육구분&#32;" Top="65" VAlign="Middle" Width="80"></Static>
		<Combo BindDataset="ds_list" Border="Flat" CodeColumn="CODE" Column="GBN1" DataColumn="CODE_NAME" DisableBKColor="user5" Height="20" Id="cb_gbn1" InnerDataset="ds_gbn" Left="666" OnChanged="cb_gbn1_OnChanged" Style="sty_ipt_form" TabOrder="19" Top="66" Width="110"></Combo>
		<Combo BindDataset="ds_list" Border="Flat" CodeColumn="CODE" Column="GBN2" DataColumn="CODE_NAME" DisableBKColor="user5" Height="20" Id="cb_gbn2" InnerDataset="ds_gbn2" Left="667" Style="sty_ipt_form" TabOrder="20" Top="91" Width="110"></Combo>
		<Combo BindDataset="ds_list" Border="Flat" CodeColumn="CODE" Column="GBN" DataColumn="CODE_NAME" DisableBKColor="user5" Height="20" Id="cb_gbn" InnerDataset="ds_gbn" Left="88" Style="sty_ipt_form" TabOrder="21" Top="66" Width="110"></Combo>
		<Combo BindDataset="ds_list" Border="Flat" CodeColumn="CODE" Column="VKGRP" DataColumn="CODE_NAME" DisableBKColor="user5" Height="20" Id="cb_vkgrp" InnerDataset="ds_vkgrp_cd" Left="282" Style="sty_ipt_form" TabOrder="22" Top="66" Width="110"></Combo>
		<Static Align="Right" Height="24" Id="st_rmk" Left="8" Style="sty_lb_form_basic" TabOrder="23" Text="비고&#32;" Top="140" VAlign="Middle" Width="80"></Static>
		<Calendar BindDataset="ds_list" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="E_DATE" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_edate" Left="474" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="24" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="92" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="110"></Calendar>
		<Calendar BindDataset="ds_list" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="C_DATE" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_cdate" Left="282" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" OnChanged="cal_cdate_OnChanged" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="25" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="92" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="110"></Calendar>
		<Edit BindDataset="ds_list" Border="Flat" Column="C_NO" Height="20" Id="ed_cno" ImeMode="none" Left="89" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="26" Top="92" Width="110"></Edit>
		<Edit BindDataset="ds_list" Border="Flat" Column="Q_NO" Height="20" Id="ed_qno" Left="474" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="27" Top="117" Width="110"></Edit>
		<Edit BindDataset="ds_list" Border="Flat" Column="Q_NM" Height="20" Id="ed_qnm" Left="89" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="28" Top="117" Width="300"></Edit>
		<Static Align="Right" Height="24" Id="st_qno" Left="393" Style="sty_lb_form_basic" TabOrder="29" Text="자격번호&#32;" Top="115" VAlign="Middle" Width="80"></Static>
		<Static Align="Right" Height="24" Id="st_qnm" Left="8" Style="sty_lb_form_basic" TabOrder="30" Text="자격명&#32;" Top="115" VAlign="Middle" Width="80"></Static>
		<Edit BindDataset="ds_list" Border="Flat" CheckLength="Byte" Column="RMK" Height="20" Id="ed_rmk" Left="89" LeftMargin="4" MaxLength="100" Style="sty_ipt_form" TabOrder="31" Top="142" Width="688"></Edit>
		<Static Align="Right" Height="24" Id="st_cdate" Left="201" Style="sty_lb_form_basic" TabOrder="32" Text="수료일&#32;" Top="90" VAlign="Middle" Width="80"></Static>
		<Static Align="Right" Height="24" Id="st_edate" Left="393" Style="sty_lb_form_basic" TabOrder="33" Text="유효기간&#32;" Top="90" VAlign="Middle" Width="80"></Static>
		<Static Align="Right" Height="24" Id="st_cno" Left="8" Style="sty_lb_form_basic" TabOrder="34" Text="수료증&#32;번호&#32;" Top="90" VAlign="Middle" Width="80"></Static>
		<Static Align="Right" Height="24" Id="st_gbn" Left="8" Style="sty_lb_form_basic" TabOrder="17" Text="자격구분&#32;" Top="65" VAlign="Middle" Width="80"></Static>
		<Edit Align="CENTER" Border="Flat" Enable="FALSE" Height="20" Id="ed_juno" Left="667" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="38" Top="117" Width="110"></Edit>
		<Static Align="Right" Height="24" Id="Static3" Left="586" Style="sty_lb_form_basic" TabOrder="39" Text="생년월일&#32;" Top="115" VAlign="Middle" Width="80"></Static>
		<Static Align="Right" Height="24" Id="st_asara" Left="393" Style="sty_lb_form_basic" TabOrder="40" Text="배치지역&#32;" Top="65" VAlign="Middle" Width="80"></Static>
		<Combo BindDataset="ds_list" Border="Flat" CodeColumn="CODE" Column="AS_ARA" DataColumn="CODE_NAME" DisableBKColor="user5" Height="20" Id="cb_asara" InnerDataset="ds_asara" Left="474" Style="sty_ipt_form" TabOrder="41" Top="66" Width="110"></Combo>
	</Form>
	<Script><![CDATA[﻿﻿﻿﻿﻿﻿﻿﻿/*
 ******************************************************************************************
 * 기      능   : 사번별 승강기 교육 수료 내역 입력 및 조회 관리 화면
 * 작  성  자   : 이하림
 * 작성  일자   : 2014 / 07
 * ----------------------------------------------------------------------------------------
 * HISTORY    : 2015 / 03 YAR 프로그램 수정
 ******************************************************************************************
 */
#include "LIB::commons.js";	// 공통 스크립트 
#include "LIB::utility.js";	// 다중 선택 
//=========================================================================================
// [ PART 1 ]
// Form에서 사용될 전역변수를 선언
// FORM에서 사용되는 전역변수는 대문자로 작성하며, F_XXX 의 형태를 갖도록 한다. 
//=========================================================================================
var userGroup;
var psno;
var juno;
var irum;
var gRow = null;
var icnt;
//=========================================================================================
// [ PART 2 ]
// Form Loading / Unloading 시 작업 정의
//=========================================================================================
function fn_OnLoadCompleted(obj) {
	gfn_initForm();
	ed_psno = psno ; // 사번
	ed_irum = irum ; // 이름
	ed_juno = substr(juno,0,6) ; 
	//코드콤보 설정 :  배치부서
	var codeArr = ["VKGRP"];
	var dsObjArr = [ds_vkgrp_cd];
	var addTypeArr = [G_CODE_ALL,G_CODE_ALL];
	gfn_searchCommCode(codeArr, dsObjArr, addTypeArr);
	
	fn_query();
}

/********************************************************************************
* 기      능   : 공통코드가 조회된 후의 Callback 함수 
********************************************************************************/
function fn_completeInit(sCode, sDsObj, sCodeType) {
	ds_vkgrp_cd.Filter(" (CODE >= 'EA1' AND CODE < 'EFP') OR CODE = '' "); // 2015.02.23 YAR 조직개편 반영
	// 자격구분 및 배치부서 입력 권한 
	if(G_USER_ID = "2017938" || G_USER_ID = "2027607"  // 최인식 조성인 
	|| G_USER_ID = "2019523" || G_USER_ID = "2023687" || G_USER_ID = "2021200" // 윤아로 용아름 이하림
	|| G_USER_ID = "2018900" || G_USER_ID = "2029758" || G_USER_ID = "2999999") { 
//		cb_gbn.Enable = true ;
		cb_vkgrp.Enable = true ;	
		cb_asara.Enable = true ;	
	} else {
//		cb_gbn.Enable = false ;
		cb_vkgrp.Enable = false ;	
		cb_asara.Enable = false ;
	}
}

/********************************************************************************
* 기      능   : form UnloadCompleted 
********************************************************************************/
function fn_OnUnloadCompleted(obj) {
	return gfn_isFormUnload(obj);
}

//=========================================================================================
// [ PART 3 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,form닫기)
//=========================================================================================
/********************************************************************************
* 기      능   : 조회 
********************************************************************************/
function fn_query() {

	ds_list.ClearData();
//	ds_cond2.SetColumn(0,"PSNO",psno);
	tit_clearActionInfo();
	tit_addSearchActionInfo("cs96:CS9613001B_S1");

	tit_callService(
        ""
        , ""
        , "ds_cond2=ds_cond2"
        , "ds_list=ds_list"
        , ""
        , "fn_afterQuery"
        , true
        , true);
}

/********************************************************************************
* 기      능   : 조회 Callback  
********************************************************************************/
function fn_afterQuery(errCode, errMsg) {
	gfn_showMsg("CI00002",ds_list.RowCount()+"");

	icnt = ds_list.GetRowCount() ;
//	cb_gbn.Index = 0;
//	cb_gbn1.Index = 0;
//	cb_gbn2.Index = 0;
//	cb_vkgrp.Index = 0;	
	
	ed_gbn.Text   = ds_list.GetColumn(0,"GBN_NM");
	ed_vkgrp.Text = ds_list.GetColumn(0,"VKGRP_NM");
	
}

/********************************************************************************
* 기      능   : 저장
********************************************************************************/
function fn_save() {

	gfn_clearMsgBar();

	for(var i=0; i<ds_list.RowCount(); i++) {
		ds_list.SetColumn(i, "CHK",  true); 
		ds_list.SetColumn(i, "VKGRP",  cb_vkgrp.Value); 
		ds_list.SetColumn(i, "AS_ARA",  cb_asara.Value); 
	}
	
	if(ds_list.rowCount() < 1) {
		// 저장할 정보 없음.
		gfn_showAlert("CW00010");
		return;
	}	
	
	if(ds_list.FindRow("CHK", 1) == -1) {
		gfn_showMsg("CW00013");
		return;
	}
	var j =0;
	for(var i=0; i<ds_list.RowCount(); i++) {					
		if(ds_list.GetColumn(i, "CHK") == true) {
			
			// if(trim(ds_list.GetColumn(i, "FLAG")) == "U"){		
				// gfn_showAlert( i + 1 + "번째 정보는 저장대상이 아닙니다." );
				// return;
			// }
		
			if(length(trim(ds_list.GetColumn(i, "GBN"))) == 0){		
				gfn_showAlert("CW00001", trim(st_gbn.Text));
				return;
			}
	
			// 배치부서 입력 권한 
			// if(length(trim(ds_list.GetColumn(i, "VKGRP"))) == 0){		
				// gfn_showAlert("CW00001", trim(st_vkgrp.Text));
				// return;
			// }
			
			if(trim(ds_list.GetColumn(i, "GBN")) != "C"){				//실무인력인 경우, 교육과정 필수아님 2015.03.11 YAR
				if(length(trim(ds_list.GetColumn(i, "GBN1"))) == 0){
					gfn_showAlert("CW00001", trim(st_gbn1.Text));
					return;
				}
			}
			if(trim(ds_list.GetColumn(i, "GBN")) != "C"){
				if(length(trim(ds_list.GetColumn(i, "GBN2"))) == 0){	
					gfn_showAlert("CW00001", trim(st_gbn2.Text));
					return;
				}
			}
			if(length(trim(ds_list.GetColumn(i, "C_NO"))) == 0){	
				gfn_showAlert("CW00001", trim(st_cno.Text));
				return;
			}

			// ds_list.SetColumn(i, "PSNO", psno );	
			// ds_list.SetColumn(i, "VKGRP", cb_vkgrp.VALUE );	
			// ds_list.SetColumn(i, "GBN", cb_gbn.Value );	
			// ds_list.SetColumn(i, "GBN1", cb_gbn1.Value );	
			// ds_list.SetColumn(i, "GBN2", cb_gbn2.Value );	
			// ds_list.SetColumn(i, "C_NO", ed_cno.Value );	
			// ds_list.SetColumn(i, "C_DATE", cal_cdate.Value );	
			// ds_list.SetColumn(i, "E_DATE", cal_edate.Value );	
			// ds_list.SetColumn(i, "Q_NM", ed_qnm.Value );	
			// ds_list.SetColumn(i, "Q_NO", ed_qno.Value );	
			// ds_list.SetColumn(i, "RMK", ed_rmk.Value );
			
			ds_list.SetColumn(j, "PSNO",   ed_psno.Value);
			// ds_list.SetColumn(j, "VKGRP",  ds_list.GetColumn(i, "VKGRP"));
			// ds_list.SetColumn(j, "GBN",    ds_list.GetColumn(i, "GBN"));
			// ds_list.SetColumn(j, "GBN1",   ds_list.GetColumn(i, "GBN1"));
			// ds_list.SetColumn(j, "GBN2",   ds_list.GetColumn(i, "GBN2"));
			// ds_list.SetColumn(j, "C_NO",   ds_list.GetColumn(i, "C_NO"));
			// ds_list.SetColumn(j, "C_DATE", ds_list.GetColumn(i, "C_DATE"));	
			// ds_list.SetColumn(j, "E_DATE", ds_list.GetColumn(i, "E_DATE"));	
			// ds_list.SetColumn(j, "Q_NM",   ds_list.GetColumn(i, "Q_NM"));
			// ds_list.SetColumn(j, "Q_NO",   ds_list.GetColumn(i, "Q_NO"));	
			// ds_list.SetColumn(j, "RMK",    ds_list.GetColumn(i, "RMK"));	
			// ds_list.SetColumn(j, "SEQ",    ds_list.GetColumn(i, "SEQ"));	

		}	
		j++;	
	}

	tit_clearActionInfo();
	//if(icnt == 0) {
//*	if(length(trim(ds_list.GetColumn(0, "GBN"))) == 0){	//기존 자격구분 값 없는경우 Insert 2015.03.11 YAR
		tit_addSingleActionInfo("cs96:CS9613001B_I1"); //210 Insert or Update
//*		tit_addSingleActionInfo("cs96:CS9613001B_I2");//211	Insert
//	} else {											
//*		tit_addSingleActionInfo("cs96:CS9613001B_U1"); //210 Update
//		tit_addSingleActionInfo("cs96:CS9613001B_D1"); //211 Delete
		tit_addMultiActionInfo("cs96:CS9613001B_I2");	//211  Insert or Update  
	//*}

	tit_callService(
		""
		, ""
		, "ds_list=ds_list"
		, ""
		, ""
		, "fn_afterSave"
		, true);
}

/********************************************************************************
* 기      능   : 삭제
********************************************************************************/
function fn_delete() {	

}
/********************************************************************************
* 기      능   : 저장 Callback  
********************************************************************************/
function fn_afterSave(errCode, errMsg) {
	if(errCode != 0) {
		gfn_showMsg("CE00001");
	} else {
		gfn_showMsg("CI00005");
		fn_query();
	}
}

/********************************************************************************
* 기      능   : 삭제 Callback  
********************************************************************************/
function fn_afterDelete(errCode, errMsg) {
	if(errCode != 0) {
		gfn_showMsg("CE00001");
	} else {
		gfn_showMsg("CI00005");
	}
}

/********************************************************************************
* 기      능   : 닫기  
********************************************************************************/
function fn_close() {
	var arr = "Q2"; // parent 의 두번째 그리드만 조회
	parent.fn_query(arr);
	close();
}

//=========================================================================================
// [ PART 4]
// Callback 함수 정의 : callback 함수명은 메인 함수의 fn_xxxx() 에서 xxxx 부분은 fn_afterXXXX()
// 형태가 되도록 작성 
//=========================================================================================

/********************************************************************************
* 기      능   : 액셀  
********************************************************************************/
function fn_excel() {
	gfn_saveToExcel(grd_list2, true);
}

/********************************************************************************
* 기      능   : 입력
********************************************************************************/
function fn_input()
{	
	gfn_addGridRow(grd_list2, -1, "FLAG");
	ds_list.SetColumn(ds_list.currow, "CHK", "1");
	ds_list.SetColumn(ds_list.currow, "FLAG", "I");
	ds_list.SetColumn(ds_list.currow, "GBN", ds_list.GetColumn(0,"GBN"));
	ds_list.SetColumn(ds_list.currow, "VKGRP", ds_list.GetColumn(0,"VKGRP"));

	if(G_USER_ID = "2017938" || G_USER_ID = "2027607"  // 최인식 조성인
	|| G_USER_ID = "2019523" || G_USER_ID = "2023687" || G_USER_ID = "2021200" // 윤아로 용아름 이하림
	|| G_USER_ID = "2018900" || G_USER_ID = "2029758" || G_USER_ID = "2999999") { 
//		cb_gbn.Enable = true ;
		cb_vkgrp.Enable = true ;
	} else {
//		cb_gbn.Enable = false ;
		cb_vkgrp.Enable = false ;
	}
		
	cb_gbn1.Index = 0;
	cb_gbn2.Enable = false ;
	cb_gbn2.Value = "";
}

/********************************************************************************
* 기      능   : 달력에서 일자 선택했을 경우 
********************************************************************************/
function cal_temp_OnDayClick(obj,strText) {
	obj.Visible = false;
}

/********************************************************************************
* 기      능   : 달력에서 포커스 잃었을 경우 
********************************************************************************/
function cal_temp_OnKillFocus(obj) {
	obj.Visible = false;
}

function cb_gbn1_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
//	if(strCode == "C") { // 실무 인력의 경우 교육과정이 필요 없다.
//		cb_gbn2.Enable = false ;
//		cb_gbn2.Value = "";
//	} else if (strCode == "") { 
	if(strCode == ""){
		cb_gbn2.Enable = false ;
		cb_gbn2.Value = "";	
	} else {
		cb_gbn2.Enable = true ;
	}
	//  Combo의 변경된 값이 적용된 경우 발생하는 이벤트 
	//trace("cb_gbn1_OnChanged(obj, " + strCode + ", " + strText + ", " + nOldIndex + ", " + nNewIndex + ")" );
}

function cal_cdate_OnChanged(obj,strOldText,strNewText)
{
	//trace("cal_cdate_OnCharChanged(obj, " + strOldText + ", " + strNewText+ ")" );
	//cal_edate.Value = gfn_getAfterDate(strNewText, 365*3);
	//cal_edate.Value = gfn_getAfterDate(strNewText, 1094);
	var yyyy = toNumber(substr(strNewText, 0, 4)) + 3;
	var mmdd = substr(strNewText, 4, 4);
	var date = yyyy + mmdd;
	cal_edate.Value = gfn_getBeforeDate(date, 1);	//수료일+3 년 -1 된 날짜 필요
	

}
]]></Script>
</Window>