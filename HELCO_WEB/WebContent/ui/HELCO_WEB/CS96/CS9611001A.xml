<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="562" Id="CS9611001A" Left="8" OnLoadCompleted="fn_OnLoadCompleted" OnUnloadCompleted="fn_OnUnloadCompleted" PidAttrib="7" Title="주간주요업무진행현황" ToolTipFont="Default,0" Top="8" Ver="1.0" Width="978" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_list" OnColumnChanged="ds_list_OnColumnChanged" OnRowPosChanged="ds_list_OnRowPosChanged">
				<Contents>
					<colinfo id="FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="YYMM" size="256" summ="default" type="STRING"/>
					<colinfo id="ARA_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="VKGRP" size="256" summ="default" type="STRING"/>
					<colinfo id="LGORT" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="GBNA" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="NAM" size="256" summ="default" type="STRING"/>
					<colinfo id="QTY" size="256" summ="default" type="STRING"/>
					<colinfo id="AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="YAMT" size="256" summ="default" type="STRING"/>
					<colinfo id="KND" size="256" summ="default" type="STRING"/>
					<colinfo id="VSDATE" size="256" summ="default" type="STRING"/>
					<colinfo id="VSTANT" size="256" summ="default" type="STRING"/>
					<colinfo id="TEXT" size="256" summ="default" type="STRING"/>
					<colinfo id="MAGM" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond">
				<Contents>
					<colinfo id="ARA" size="256" summ="default" type="STRING"/>
					<colinfo id="BSU" size="256" summ="default" type="STRING"/>
					<colinfo id="BPM" size="256" summ="default" type="STRING"/>
					<colinfo id="YY" size="256" summ="default" type="STRING"/>
					<colinfo id="MM" size="256" summ="default" type="STRING"/>
					<colinfo id="YYMM" size="256" summ="default" type="STRING"/>
					<colinfo id="TEM" size="256" summ="default" type="STRING"/>
					<record>
						<ARA></ARA>
						<BPM></BPM>
						<BSU></BSU>
						<MM></MM>
						<TEM></TEM>
						<YY></YY>
						<YYMM></YYMM>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_gbna">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME>-&#32;선택&#32;-</CODE_NAME>
					</record>
					<record>
						<CODE>A</CODE>
						<CODE_NAME>신규계약</CODE_NAME>
					</record>
					<record>
						<CODE>B</CODE>
						<CODE_NAME>재계약</CODE_NAME>
					</record>
					<record>
						<CODE>C</CODE>
						<CODE_NAME>수리공사</CODE_NAME>
					</record>
					<record>
						<CODE>D</CODE>
						<CODE_NAME>부품판매</CODE_NAME>
					</record>
					<record>
						<CODE>E</CODE>
						<CODE_NAME>거래선방문</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_gbna_grd">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME>-&#32;선택&#32;-</CODE_NAME>
					</record>
					<record>
						<CODE>A</CODE>
						<CODE_NAME>신규계약</CODE_NAME>
					</record>
					<record>
						<CODE>B</CODE>
						<CODE_NAME>재계약</CODE_NAME>
					</record>
					<record>
						<CODE>C</CODE>
						<CODE_NAME>수리공사</CODE_NAME>
					</record>
					<record>
						<CODE>D</CODE>
						<CODE_NAME>부품판매</CODE_NAME>
					</record>
					<record>
						<CODE>E</CODE>
						<CODE_NAME>거래선방문</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_month_cd">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
					<record>
						<CODE>01</CODE>
						<CODE_NAME>1월</CODE_NAME>
					</record>
					<record>
						<CODE>02</CODE>
						<CODE_NAME>2월</CODE_NAME>
					</record>
					<record>
						<CODE>03</CODE>
						<CODE_NAME>3월</CODE_NAME>
					</record>
					<record>
						<CODE>04</CODE>
						<CODE_NAME>4월</CODE_NAME>
					</record>
					<record>
						<CODE>05</CODE>
						<CODE_NAME>5월</CODE_NAME>
					</record>
					<record>
						<CODE>06</CODE>
						<CODE_NAME>6월</CODE_NAME>
					</record>
					<record>
						<CODE>07</CODE>
						<CODE_NAME>7월</CODE_NAME>
					</record>
					<record>
						<CODE>08</CODE>
						<CODE_NAME>8월</CODE_NAME>
					</record>
					<record>
						<CODE>09</CODE>
						<CODE_NAME>9월</CODE_NAME>
					</record>
					<record>
						<CODE>10</CODE>
						<CODE_NAME>10월</CODE_NAME>
					</record>
					<record>
						<CODE>11</CODE>
						<CODE_NAME>11월</CODE_NAME>
					</record>
					<record>
						<CODE>12</CODE>
						<CODE_NAME>12월</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_year_cd">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_knd">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME>-&#32;선택&#32;-</CODE_NAME>
					</record>
					<record>
						<CODE>1</CODE>
						<CODE_NAME>FM</CODE_NAME>
					</record>
					<record>
						<CODE>2</CODE>
						<CODE_NAME>POG</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_knd_grd">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME>-&#32;선택&#32;-</CODE_NAME>
					</record>
					<record>
						<CODE>1</CODE>
						<CODE_NAME>FM</CODE_NAME>
					</record>
					<record>
						<CODE>2</CODE>
						<CODE_NAME>POG</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_bsu_grd">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
		</Datasets>
		<Shape BKColor="user12" Bottom="139" Height="26" Id="Shape1" Left="8" LineColor="user13" Right="966" TabOrder="10" Top="113" Type="Rectangle" Width="958"></Shape>
		<Shape BKColor="user12" Bottom="114" Height="26" Id="Shape6" Left="8" LineColor="user13" Right="966" TabOrder="2" Top="88" Type="Rectangle" Width="958"></Shape>
		<Shape BKColor="user12" Bottom="89" Height="26" Id="Shape4" Left="8" LineColor="user13" Right="966" TabOrder="3" Top="63" Type="Rectangle" Width="958"></Shape>
		<Shape BKColor="user12" Bottom="64" Height="26" Id="Shape5" Left="8" LineColor="user13" Right="966" TabOrder="4" Top="38" Type="Rectangle" Width="958"></Shape>
		<Shape BKColor="user0" Bottom="32" Height="32" Id="Shape0" Left="0" LineColor="user1" Right="978" TabOrder="5" Top="0" Type="Rectangle" Width="978"></Shape>
		<Static Align="Right" Height="24" Id="st_qty" Left="9" Style="sty_lb_form_basic" TabOrder="0" Text="대수&#32;" Top="64" VAlign="Middle" Width="108"></Static>
		<Edit Align="RIGHT" BindDataset="ds_list" Border="Flat" CheckLength="Byte" Column="QTY" Height="20" Id="ed_qty" ImeMode="none" Left="119" LeftMargin="4" MaxLength="3" Number="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="1" Top="66" Width="100"></Edit>
		<Static Align="Right" Height="20" Id="st_bsu" Left="5" Style="sty_lb_search" TabOrder="8" Text="협력사&#32;" Top="5" VAlign="Middle" Width="80"></Static>
		<Div BKColor="user0" Height="20" Id="div_code" Left="87" OnLoadCompleted="fn_OnLoadCompleted" OnTimer="WB0199010A_OnTimer" TabOrder="4" Text="Div0" Top="5" Url="WB01::WB0199010A.xml" Width="415">
			<Contents></Contents>
		</Div>
		<Static Align="Right" Height="24" Id="st_amt" Left="503" Style="sty_lb_form_basic" TabOrder="9" Text="금액&#32;" Top="64" VAlign="Middle" Width="108"></Static>
		<Static Align="Right" Height="24" Id="st_gbna" Left="9" Style="sty_lb_form_basic" TabOrder="11" Text="입력구분&#32;" Top="39" VAlign="Middle" Width="108"></Static>
		<Combo BindDataset="ds_list" Border="Flat" CodeColumn="CODE" Column="GBNA" DataColumn="CODE_NAME" Height="20" Id="cb_gbna" InnerDataset="ds_gbna" Left="118" OnChanged="cb_gbna_OnChanged" Style="sty_ipt_form" TabOrder="12" Top="40" Width="104"></Combo>
		<Shape BKColor="user12" Bottom="164" Height="26" Id="Shape2" Left="8" LineColor="user13" Right="966" TabOrder="15" Top="138" Type="Rectangle" Width="958"></Shape>
		<Static Align="Right" Height="24" Id="st_vsdate" Left="9" Style="sty_lb_form_basic" TabOrder="13" Text="방문일자&#32;" Top="114" VAlign="Middle" Width="108"></Static>
		<Static Align="Right" Height="24" Id="st_nam" Left="503" Style="sty_lb_form_basic" TabOrder="16" Text="고객/현장명&#32;" Top="39" VAlign="Middle" Width="108"></Static>
		<Edit BindDataset="ds_list" Border="Flat" CheckLength="Byte" Column="NAM" Height="20" Id="ed_nam" ImeMode="none" Left="613" LeftMargin="4" MaxLength="20" RightMargin="4" Style="sty_ipt_form" TabOrder="14" Top="41" Width="200"></Edit>
		<Calendar BindDataset="ds_list" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="VSDATE" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_vsdate" Left="119" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="17" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="116" UseTrailingDay="FALSE" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="102"></Calendar>
		<Grid AutoEnter="TRUE" AutoFitEndLine="Hide" BindDataset="ds_list" BkColor2="default" BoldHead="true" Border="Flat" Bottom="553" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" FixedColSizing="TRUE" HeadBorder="Flat" HeadHeight="20" Height="383" Id="grd_list" InputPanel="FALSE" Left="8" LineColor="user20" LineType="ExHORZ" OnCellClick="grd_list_OnCellClick" OnHeadClick="grd_list_OnHeadClick" Right="966" RowHeight="20" Style="sty_grid" TabOrder="18" TabStop="FALSE" Top="170" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="958">
			<contents>
				<format id="Default">
					<columns>
						<col width="20"/>
						<col width="40"/>
						<col width="60"/>
						<col width="150"/>
						<col width="80"/>
						<col width="150"/>
						<col width="60"/>
						<col width="100"/>
						<col width="60"/>
						<col width="70"/>
						<col width="80"/>
						<col width="80"/>
						<col width="200"/>
					</columns>
					<head>
						<cell bkimageid="icon_grid_sel" col="0" cursor="hand" display="text"/>
						<cell col="1" display="text" font="Default,9" text="No"/>
						<cell align="center" col="2" display="text" font="Default,9" text="지역" TrimType="Both"/>
						<cell align="center" col="3" display="text" font="Default,9" text="업체명" TrimType="Both"/>
						<cell align="center" col="4" display="text" font="Default,9" text="입력구분" TrimType="Both"/>
						<cell align="center" col="5" display="text" font="Default,9" text="현장명" TrimType="Both"/>
						<cell col="6" display="text" font="Default,9" text="대수" TrimType="Both"/>
						<cell col="7" display="text" font="Default,9" text="금액" TrimType="Both"/>
						<cell align="center" col="8" display="text" font="Default,9" text="예상이익" TrimType="Both"/>
						<cell align="center" col="9" display="text" font="Default,9" text="FM/POG" TrimType="Both"/>
						<cell align="center" col="10" display="text" font="Default,9" text="방문일자" TrimType="Both"/>
						<cell align="center" col="11" display="text" font="Default,9" text="방문자" TrimType="Both"/>
						<cell align="center" col="12" display="text" font="Default,9" text="진행/방문현황" TrimType="Both"/>
					</head>
					<body>
						<cell align="center" bkimageid='expr:gfn_getFlagBkImageID(getColumn(currow,&#32;&quot;FLAG&quot;))' col="0" display="text"/>
						<cell align="center" col="1" display="text" expr="currow+1"/>
						<cell align="center" bkcolor2="user22" col="2" colid="ARA_NM" display="text"/>
						<cell align="left" bkcolor2="user22" col="3" colid="LGORT" combocol="CODE" combodataset="ds_bsu_grd" combotext="CODE_NAME" display="combo"/>
						<cell align="center" bkcolor2="user22" col="4" colid="GBNA" combocol="CODE" combodataset="ds_gbna_grd" combotext="CODE_NAME" display="combo"/>
						<cell align="left" bkcolor2="user22" col="5" colid="NAM" display="text"/>
						<cell align="right" bkcolor2="user22" col="6" colid="QTY" display="number" Mask="###,##0"/>
						<cell align="right" bkcolor2="user22" col="7" colid="AMT" display="number" Mask="###,##0"/>
						<cell align="right" bkcolor2="user22" col="8" colid="YAMT" display="number" Mask="###.#0"/>
						<cell align="center" bkcolor2="user22" col="9" colid="KND" combocol="CODE" combodataset="ds_knd_grd" combotext="CODE_NAME" display="combo"/>
						<cell align="center" bkcolor2="user22" col="10" colid="VSDATE" display="text" Mask="####.##.##"/>
						<cell align="center" bkcolor2="user22" col="11" colid="VSTANT" display="text"/>
						<cell align="left" bkcolor2="user22" col="12" colid="TEXT" display="text"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Static Align="Right" Height="20" Id="st_yymm" Left="506" Style="sty_lb_search" TabOrder="19" Text="기준년월&#32;" Top="5" VAlign="Middle" Width="80"></Static>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="CODE" Column="YY" DataColumn="CODE_NAME" DisableBKColor="user5" Height="20" Id="cb_year" InnerDataset="ds_year_cd" Left="587" Style="sty_ipt_search" TabOrder="20" Top="4" Width="75"></Combo>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="CODE" Column="MM" DataColumn="CODE_NAME" DisableBKColor="user5" Height="20" Id="cb_month" InnerDataset="ds_month_cd" Left="662" Style="sty_ipt_search" TabOrder="21" Top="4" Width="56"></Combo>
		<MaskEdit Align="Right" BindDataset="ds_list" Border="Flat" Column="AMT" DecimalLen="0" Height="20" Id="med_amt" Left="613" Mask="###,##0" Style="sty_ipt_form" TabOrder="22" Top="66" Width="100"></MaskEdit>
		<Static Align="Right" Height="24" Id="st_yamt" Left="9" Style="sty_lb_form_basic" TabOrder="23" Text="예상이익&#32;" Top="89" VAlign="Middle" Width="108"></Static>
		<MaskEdit Align="Right" BindDataset="ds_list" Border="Flat" Column="YAMT" DecimalLen="2" DecimalMinLen="2" Height="20" Id="med_yamt" Left="119" Mask="###.#0" Style="sty_ipt_form" TabOrder="24" Top="91" Width="100"></MaskEdit>
		<Static Align="Right" Height="24" Id="st_knd" Left="503" Style="sty_lb_form_basic" TabOrder="25" Text="FM/POG&#32;" Top="89" VAlign="Middle" Width="108"></Static>
		<Combo BindDataset="ds_list" Border="Flat" CodeColumn="CODE" Column="KND" DataColumn="CODE_NAME" Height="20" Id="cb_knd" InnerDataset="ds_knd" Left="612" Style="sty_ipt_form" TabOrder="26" Top="90" Width="104"></Combo>
		<Static Align="Right" Height="24" Id="st_vstant" Left="503" Style="sty_lb_form_basic" TabOrder="28" Text="방문자&#32;" Top="114" VAlign="Middle" Width="108"></Static>
		<Edit BindDataset="ds_list" Border="Flat" CheckLength="Byte" Column="VSTANT" Height="20" Id="ed_vstant" ImeMode="none" Left="613" LeftMargin="4" MaxLength="10" RightMargin="4" Style="sty_ipt_form" TabOrder="27" Top="116" Width="100"></Edit>
		<Static Align="Right" Height="24" Id="st_text" Left="9" Style="sty_lb_form_basic" TabOrder="30" Text="진행/방문현황&#32;" Top="139" VAlign="Middle" Width="108"></Static>
		<Edit BindDataset="ds_list" Border="Flat" CheckLength="Byte" Column="TEXT" Height="20" Id="ed_text" ImeMode="none" Left="119" LeftMargin="4" MaxLength="50" RightMargin="4" Style="sty_ipt_form" TabOrder="29" Top="141" Width="380"></Edit>
		<Edit Align="RIGHT" Border="Flat" CheckLength="Byte" Height="20" Id="ed_rcnt" ImeMode="none" Left="568" LeftMargin="4" MaxLength="3" Number="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="31" Top="576" Visible="FALSE" Width="40"></Edit>
	</Form>
	<Script><![CDATA[/*
 ******************************************************************************************
 * 기      능   : 프로그램 관리 
 * 작  성  자   : 
 * 작성  일자   : 
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
#include "LIB::commons.js";	// 공통 스크립트 
#include "LIB::utility.js";	// 다중 선택 
//=========================================================================================
// [ PART 1 ]
// Form에서 사용될 전역변수를 선언
// FORM에서 사용되는 전역변수는 대문자로 작성하며, F_XXX 의 형태를 갖도록 한다. 
//=========================================================================================

//=========================================================================================
// [ PART 2 ]
// Form Loading / Unloading 시 작업 정의
//=========================================================================================
function fn_OnLoadCompleted(obj) {
	// Form 로드 이벤트 맨 첫줄에 기술 
	gfn_initForm(true);
	// 버튼처리
	ufn_enableBtn("input", false);
	ufn_enableBtn("delete", false);
	ufn_enableBtn("save", false);

	tit_clearActionInfo();
	tit_addSearchActionInfo("cs96:CS9611001A_S2");

	tit_callService(
        ""
        , ""
        , ""
        , "ds_bsu_grd=ds_bsu"
        , ""
        , ""
        , true
        , true);

	cb_gbna.Index = 0;

	var curYear = substr(gfn_getCurrDate(),0,4);
	fn_makeYear(curYear,-3,10);
	cb_month.index = parseInt(substr(gfn_getCurrDate(),4,2))-1;
	cb_year.SetFocus();
}

/************************************************************************************
* 기      능   : 작업기간 계산(현재년도,당해년도에서 뺄 년수, 당해년도에서 더할 년수
************************************************************************************/
function fn_makeYear(curYear,sNum,eNum) {
	var rowCnt = eNum-sNum;
	var row = 0;

	for(var i=rowCnt; i>-1; i--) {
		ds_year_cd.AddRow();
		ds_year_cd.SetColumn(row,"CODE",parseInt(curYear)+i+parseInt(sNum));
		ds_year_cd.SetColumn(row,"CODE_NAME",(parseInt(curYear)+i+parseInt(sNum))+"년");
		row++;
	}

	cb_year.index = eNum;
}

/********************************************************************************
* 기      능   : 공통코드가 조회된 후의 Callback 함수 
********************************************************************************/
function fn_completeInit(sCode, sDsObj, sCodeType) {

}

/********************************************************************************
* 기      능   : form UnloadCompleted 
********************************************************************************/
function fn_OnUnloadCompleted(obj) {
	return gfn_isFormUnload(obj);
}

//=========================================================================================
// [ PART 3 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,form닫기)
//=========================================================================================
/********************************************************************************
* 기      능   : 조회 
********************************************************************************/
function fn_query() {
	ds_list.row = -1;

	var user_grp = gfn_getUserGroup();

	if(user_grp <> "40") {
		if(length(trim(div_code.cb_small.value)) == 0) {
			gfn_showAlert("협력사를 선택하여 주십시요.");
			return;
		}
	} else {
		if(length(trim(div_code.cb_big.value)) == 0) {
			gfn_showAlert("협력사구분을 선택하여 주십시요.");
			return;
		}
	}

	if(user_grp == "10") { // 보수협력사일 경우
		ds_cond.SetColumn(0, "BSU", G_LGORT);
		ds_cond.SetColumn(0, "TEM", '');
		ds_cond.SetColumn(0, "BPM", '');
		ds_cond.SetColumn(0, "ARA", '');
	} else if(user_grp == "20") { // 보수PM일 경우
		ds_cond.SetColumn(0, "BSU", trim(div_code.cb_small.value));
		ds_cond.SetColumn(0, "TEM", '');
		ds_cond.SetColumn(0, "BPM", G_USER_ID);
		ds_cond.SetColumn(0, "ARA", '');
	} else if(user_grp == "30") { // 지방사무소일 경우
		ds_cond.SetColumn(0, "BSU", trim(div_code.cb_small.value));
		ds_cond.SetColumn(0, "TEM", G_SAP_USER_VGCD);
		ds_cond.SetColumn(0, "BPM", '');
		ds_cond.SetColumn(0, "ARA", '');
	} else if(user_grp == "40") { // 고객지원부일 경우
		ds_cond.SetColumn(0, "BSU", trim(div_code.cb_small.value));
		if(div_code.cb_big.value == '1') { // 협력사 콤보1이 지역일 경우
			ds_cond.SetColumn(0, "TEM", '');
			ds_cond.SetColumn(0, "BPM", '');
			ds_cond.SetColumn(0, "ARA", trim(div_code.cb_mid.value));
		} else if(div_code.cb_big.value == '2') { // 협력사 콤보1이 PM일 경우
			ds_cond.SetColumn(0, "TEM", '');
			ds_cond.SetColumn(0, "BPM", trim(div_code.cb_mid.value));
			ds_cond.SetColumn(0, "ARA", '');
		} else { // 협력사 콤보1이 팀일 경우
			ds_cond.SetColumn(0, "TEM", trim(div_code.cb_mid.value));
			ds_cond.SetColumn(0, "BPM", '');
			ds_cond.SetColumn(0, "ARA", '');
		}
	}

	var t_yymm = cb_year.Value + cb_month.Value + "";
	ds_cond.SetColumn(0, "YYMM", t_yymm);

	gfn_clearGridSortMark(grd_list);

	tit_clearActionInfo();

	tit_addSearchActionInfo("cs96:CS9611001A_S1");

	tit_callService(
          ""
        , ""
        , "ds_cond=ds_cond"
        , "ds_list=ds_list"
        , ""
        , "fn_afterQuery"
        , true);	
}

/********************************************************************************
* 기      능   : 저장  
********************************************************************************/
function fn_save() {
	if(length(trim(div_code.cb_small.value)) == 0) {
		gfn_showAlert("협력사를 선택하여 주십시요.");
		return;
	}

	if(parseInt(ed_rcnt.Text) == 0 && ds_list.rowcount == 0) {
		return;
	}

	if(parseInt(ed_rcnt.Text) > 0 && ds_list.GetOrgColumn(0, "MAGM") == "X") { // 해당월 마감완료
		gfn_showAlert("해당월은 마감완료 되어 수정이 불가합니다.");
		return;
	}

	var f = "";
	var t_seq = 0;

	for(var i=0; i<ds_list.rowCount(); i++) {
		f = ds_list.getColumn(i, "FLAG");
		if(f == "I" || f == "U") {
			if(length(ds_list.getColumn(i, "GBNA")) == 0) {
				gfn_showAlert("CW00001", "입력구분");
                ds_list.row = i;
				return;
			}

			if(ds_list.getColumn(i, "GBNA") <> "E" && length(ds_list.getColumn(i, "KND")) == 0) {
				gfn_showAlert("CW00001", "FM/POG");
                ds_list.row = i;
				return;
			}

			if(length(ds_list.getColumn(i, "NAM")) == 0) {
				gfn_showAlert("CW00001", "고객/현장명");
                ds_list.row = i;
				return;
			}

			if(length(ds_list.getColumn(i, "TEXT")) == 0) {
				gfn_showAlert("CW00001", "진행/방문현황");
                ds_list.row = i;
				return;
			}

			t_seq = i + 1;

			if(parseInt(t_seq) < 10) {
				t_seq = "0" + t_seq;
			} else {
				t_seq = t_seq;
			}

			ds_list.SetColumn(i, "SEQ", t_seq);

			if(length(trim(ds_list.getColumn(i, "QTY"))) == 0) {
				ds_list.SetColumn(i, "QTY", 0);
			}

			if(length(trim(ds_list.getColumn(i, "AMT"))) == 0) {
				ds_list.SetColumn(i, "AMT", 0);
			}

			if(length(trim(ds_list.getColumn(i, "YAMT"))) == 0) {
				ds_list.SetColumn(i, "YAMT", 0.00);
			}
		}
	}

	gfn_clearGridSortMark(grd_list);

	tit_clearActionInfo();

	if(ds_list.rowcount > 0) {
		tit_addSingleActionInfo("cs96:CS9611001A_D1");
		tit_addMultiActionInfo("cs96:CS9611001A_I1");
	} else {
		ds_cond.SetColumn(0, "BSU", trim(div_code.cb_small.value));
		tit_addSingleActionInfo("cs96:CS9611001A_D2");
	}

	tit_callService(
		""
		, ""
		, "ds_list=ds_list:A ds_cond=ds_cond"
		, ""
		, ""
		, "fn_afterSave"
		, true);
}

/********************************************************************************
* 기      능   : 입력
********************************************************************************/
function fn_input() {
	if(length(trim(div_code.cb_small.value)) == 0) {
		gfn_showAlert("협력사를 선택하여 주십시요.");
		return;
	}

	if(parseInt(ed_rcnt.Text) > 0 && ds_list.GetOrgColumn(0, "MAGM") == "X") { // 해당월 마감완료
		gfn_showAlert("해당월은 마감완료 되어 수정이 불가합니다.");
		return;
	}

	ed_nam.Enable = false; // 고객/현장명
	ed_qty.Enable = false; // 대수
	med_amt.Enable = false; // 금액
	med_yamt.Enable = false; // 예상이익
	cb_knd.Enable = false; // FM/POG
	cal_vsdate.Enable = false; // 방문일자
	ed_vstant.Enable = false; // 방문자
	ed_text.Enable = false; // 진행/방문현황

	var nRow = gfn_addGridRow(grd_list, -1, "FLAG");
	var t_yymm = cb_year.Value + cb_month.Value + "";

	ds_list.SetColumn(nRow, "YYMM", t_yymm);
	ds_list.SetColumn(nRow, "LGORT", trim(div_code.cb_small.value));
	ds_list.SetColumn(nRow, "LIFNR", trim(div_code.cb_small.value));
	ds_list.SetColumn(nRow, "GBNA", cb_gbna.Value);
	ds_list.SetColumn(nRow, "KND", cb_knd.Value);

	cb_gbna.Index = 0;
	cb_knd.Index = 0;

	cb_gbna.SetFocus();
}

/********************************************************************************
* 기      능   : 삭제 
********************************************************************************/
function fn_delete() {
	if(ds_list.rowcount > 0) {
		if(length(trim(div_code.cb_small.value)) == 0) {
			gfn_showAlert("협력사를 선택하여 주십시요.");
			return;
		}

		if(parseInt(ed_rcnt.Text) > 0 && ds_list.GetOrgColumn(0, "MAGM") == "X") { // 해당월 마감완료
			gfn_showAlert("해당월은 마감완료 되어 수정이 불가합니다.");
			return;
		}

		ds_list.DeleteRow(ds_list.row);
	}
}

/********************************************************************************
* 기      능   : 닫기  
********************************************************************************/
function fn_close() {
	close();
}

/********************************************************************************
* 기      능   : 액셀  
********************************************************************************/
function fn_excel() {
	gfn_saveToExcel(grd_list, true);
}

//=========================================================================================
// [ PART 4]
// Callback 함수 정의 : callback 함수명은 메인 함수의 fn_xxxx() 에서 xxxx 부분은 fn_afterXXXX()
// 형태가 되도록 작성 
//=========================================================================================
/********************************************************************************
* 기      능   : 조회 Callback  
********************************************************************************/
function fn_afterQuery(errCode, errMsg) {
	ufn_enableBtn("input", true);
	ufn_enableBtn("delete", true);

	if(ds_list.rowcount > 0) {
		ufn_enableBtn("save", true);
	}

	if(trim(ds_list.GetColumn(0, "GBNA")) == "E") { // 거래선방문
		med_amt.Enable = false;
		med_yamt.Enable = false;
		cb_knd.Enable = false;
		cal_vsdate.Enable = true;
		ed_vstant.Enable = true;
	} else { // 수주진행
		med_amt.Enable = true;
		med_yamt.Enable = true;
		cb_knd.Enable = true;
		cal_vsdate.Enable = false;
		ed_vstant.Enable = false;
	}

	ed_rcnt.Text = ds_list.GetRowCount();

	gfn_showSearchMsg(grd_list, errCode, errMsg);	
}

/********************************************************************************
* 기      능   : 저장 Callback  
********************************************************************************/
function fn_afterSave(errCode, errMsg) {
	if(errCode != 0) {
		gfn_showMsg("CE00001");
	} else {
		gfn_showMsg("CI00003");
		fn_query();
	}
}

//=========================================================================================
// [ PART 6 ]
// component Event 정의 : 각 Component 별 이벤트 
//=========================================================================================
/********************************************************************************
* 기      능   : 정렬 처리 
********************************************************************************/
function grd_list_OnHeadClick(obj,nCell,nX,nY,nPivotIndex) {
	if(nCell == 0) {
		gfn_selectGridCol(obj); 
	} else if(nCell > 1) {
		gfn_sortGrid(obj,nCell);
	}
}

/********************************************************************************
* 기      능   :  변경시 마다 
********************************************************************************/
function ds_list_OnRowPosChanged(obj,nOldRow,nRow) {
	if(nRow == -1) {
		return;
	}

	if(ds_list.getColumn(nRow, "FLAG") == "I") {
		cb_gbna.SetFocus();
		ufn_enableBtn("save", true);
		ufn_enableBtn("delete", true);
	} else {
		ds_list.fireevent = false;
		ufn_enableBtn("save", true);
		ufn_enableBtn("delete", true);
		ds_list.fireevent = true;
	}
}

/********************************************************************************
* 기      능   :  데이터 변경시 처리 
********************************************************************************/
function ds_list_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex) {
	gfn_changeFlag(obj, strColumnID, nRow, "FLAG");
}

function cb_gbna_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex) {
	if(length(trim(cb_gbna.Value)) > 0) { // 값 선택시
		if(cb_gbna.Value == "E") { // 거래선방문
			med_amt.Value = 0;
			med_yamt.Value = 0;
			cb_knd.Value = "";

			med_amt.Enable = false;
			med_yamt.Enable = false;
			cb_knd.Enable = false;
			cal_vsdate.Enable = true;
			ed_vstant.Enable = true;
		} else { // 수주진행
			cal_vsdate.Value = "";
			ed_vstant.Value = "";

			med_amt.Enable = true;
			med_yamt.Enable = true;
			cb_knd.Enable = true;
			cal_vsdate.Enable = false;
			ed_vstant.Enable = false;
		}

		ed_nam.Enable = true;
		ed_qty.Enable = true;
		ed_text.Enable = true;
	} else { // 값 미선택시
		ed_nam.Value = "";
		ed_qty.Value = "";
		med_amt.Value = 0;
		med_yamt.Value = 0;
		cb_knd.Value = "";
		cal_vsdate.Value = "";
		ed_vstant.Value = "";
		ed_text.Value = "";

		ed_nam.Enable = false;
		ed_qty.Enable = false;
		med_amt.Enable = false;
		med_yamt.Enable = false;
		cb_knd.Enable = false;
		cal_vsdate.Enable = false;
		ed_vstant.Enable = false;
		ed_text.Enable = false;
	}
}

function grd_list_OnCellClick(obj,nRow,nCell,nX,nY,nPivotIndex) {
	if(trim(ds_list.GetColumn(nRow, "GBNA")) == "E") { // 거래선방문
		med_amt.Enable = false;
		med_yamt.Enable = false;
		cb_knd.Enable = false;
		cal_vsdate.Enable = true;
		ed_vstant.Enable = true;
	} else { // 수주진행
		med_amt.Enable = true;
		med_yamt.Enable = true;
		cb_knd.Enable = true;
		cal_vsdate.Enable = false;
		ed_vstant.Enable = false;
	}
}
]]></Script>
</Window>