<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="384" Id="CS9610002B" Left="8" OnLoadCompleted="fn_OnLoadCompleted" OnUnloadCompleted="fn_OnUnloadCompleted" PidAttrib="7" Title="설치면허업체&#32;직원등록" Top="8" Ver="1.0" Width="600" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_list">
				<Contents>
					<colinfo id="VKGRP" size="256" summ="default" type="STRING"/>
					<colinfo id="VKGRP_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN1" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN1_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN2" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN2_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="C_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="C_DATE" size="256" summ="default" type="STRING"/>
					<colinfo id="E_DATE" size="256" summ="default" type="STRING"/>
					<colinfo id="Q_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="Q_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="RMK" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="AS_ARA" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_yn">
				<Contents>
					<colinfo id="CODE" size="255" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="255" summ="default" type="STRING"/>
					<record>
						<CODE>Y</CODE>
						<CODE_NAME>Y</CODE_NAME>
					</record>
					<record>
						<CODE>N</CODE>
						<CODE_NAME>N</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ara">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_bsu">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME></CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_user">
				<Contents>
					<colinfo id="ARA" size="256" summ="default" type="STRING"/>
					<colinfo id="NAM" size="256" summ="default" type="STRING"/>
					<colinfo id="BDT" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="TEL" size="256" summ="default" type="STRING"/>
					<colinfo id="JOB" size="256" summ="default" type="STRING"/>
					<colinfo id="FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="EML" size="256" summ="default" type="STRING"/>
					<colinfo id="CID" size="256" summ="default" type="STRING"/>
					<colinfo id="CID_NAM" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNR_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="TJYN" size="256" summ="default" type="STRING"/>
					<colinfo id="TNAM" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond">
				<Contents>
					<colinfo id="ARA" size="256" summ="default" type="STRING"/>
					<colinfo id="BSU" size="256" summ="default" type="STRING"/>
					<colinfo id="CLO" size="256" summ="default" type="STRING"/>
					<record>
						<ARA></ARA>
						<BSU></BSU>
						<CLO></CLO>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_userdel">
				<Contents>
					<colinfo id="ARA" size="256" summ="default" type="STRING"/>
					<colinfo id="NAM" size="256" summ="default" type="STRING"/>
					<colinfo id="BDT" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_user_save">
				<Contents>
					<colinfo id="ARA" size="256" summ="default" type="STRING"/>
					<colinfo id="NAM" size="256" summ="default" type="STRING"/>
					<colinfo id="BDT" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="TEL" size="256" summ="default" type="STRING"/>
					<colinfo id="JOB" size="256" summ="default" type="STRING"/>
					<colinfo id="FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="EML" size="256" summ="default" type="STRING"/>
					<colinfo id="CID" size="256" summ="default" type="STRING"/>
					<colinfo id="CID_NAM" size="256" summ="default" type="STRING"/>
					<colinfo id="TJYN" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_tjyn">
				<Contents>
					<colinfo id="CODE" size="255" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="255" summ="default" type="STRING"/>
					<record>
						<CODE>Y</CODE>
						<CODE_NAME>Y</CODE_NAME>
					</record>
					<record>
						<CODE>N</CODE>
						<CODE_NAME>N</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_rcond">
				<Contents>
					<colinfo id="ZPROGRAM" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN" size="256" summ="default" type="STRING"/>
					<record>
						<GBN></GBN>
						<ZPROGRAM></ZPROGRAM>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_tuser_list">
				<Contents>
					<colinfo id="NAM" size="256" summ="default" type="STRING"/>
					<colinfo id="BDT" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNR_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="ARA" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
		</Datasets>
		<Shape BKColor="user12" Bottom="115" Height="26" Id="Shape0" Left="7" LineColor="user13" Right="587" TabOrder="21" Top="89" Type="Rectangle" Width="580"></Shape>
		<Shape BKColor="user12" Bottom="66" Height="26" Id="Shape1" Left="7" LineColor="user13" Right="587" TabOrder="9" Top="40" Type="Rectangle" Width="580"></Shape>
		<Static Align="Right" Height="24" Id="Static1" Left="393" Style="sty_lb_form_basic" TabOrder="13" Text="자격구분&#32;" Top="41" VAlign="Middle" Width="80"></Static>
		<Div Height="36" Id="div_btn" TabOrder="8" Text="Div0" ToolTipFont="Default,0" Url="WB01::CommBtnForm.xml" Width="595">
			<Contents></Contents>
		</Div>
		<Static Align="Right" Height="24" Id="st_irum" Left="8" Style="sty_lb_form_basic" TabOrder="10" Text="지역" Top="41" VAlign="Middle" Width="80"></Static>
		<Static Align="Right" Height="24" Id="st_psno" Left="201" Style="sty_lb_form_basic" TabOrder="11" Text="성명" Top="41" VAlign="Middle" Width="80"></Static>
		<Edit Align="CENTER" BindDataset="ds_user" Border="Flat" Column="NAM" Height="20" Id="ed_nam" ImeMode="none" Left="282" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="2" Top="43" Width="110"></Edit>
		<Calendar Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="146" Id="cal_temp" Left="904" MonthOnly="TRUE" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" OnDayClick="cal_temp_OnDayClick" OnKillFocus="cal_temp_OnKillFocus" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="12" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="280" Value="20130513" Visible="FALSE" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="152"></Calendar>
		<Static Align="Right" Height="24" Id="Static2" Left="393" Style="sty_lb_form_basic" TabOrder="14" Text="생년월일" Top="41" VAlign="Middle" Width="80"></Static>
		<Shape BKColor="user12" Bottom="90" Height="26" Id="Shape6" Left="7" LineColor="user13" Right="587" TabOrder="15" Top="64" Type="Rectangle" Width="580"></Shape>
		<Combo BindDataset="ds_user" Border="Flat" CodeColumn="CODE" Column="JOB" DataColumn="CODE_NAME" DisableBKColor="user5" Height="20" Id="cb_yn" InnerDataset="ds_yn" Left="89" Style="sty_ipt_form" TabOrder="6" Top="91" Width="110"></Combo>
		<Edit BindDataset="ds_user" Border="Flat" Column="TEL" Height="20" Id="ed_hpn" Left="474" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="5" Top="67" Width="110"></Edit>
		<Static Align="Right" Height="24" Id="st_cno" Left="8" Style="sty_lb_form_basic" TabOrder="17" Text="재직여부" Top="90" VAlign="Middle" Width="80"></Static>
		<Static Align="Right" Height="24" Id="st_gbn" Left="8" Style="sty_lb_form_basic" TabOrder="16" Text="업체" Top="65" VAlign="Middle" Width="80"></Static>
		<Static Align="Right" Height="24" Id="st_asara" Left="393" Style="sty_lb_form_basic" TabOrder="18" Text="휴대폰번호" Top="65" VAlign="Middle" Width="80"></Static>
		<Combo BindDataset="ds_user" Border="Flat" CodeColumn="CODE" Column="ARA" DataColumn="CODE_NAME" Height="20" Id="cb_ara1" ImeMode="none" InnerDataset="ds_ara" Left="89" OnChanged="ufn_setBsu" Style="sty_ipt_search" TabOrder="1" Top="42" Width="100"></Combo>
		<Combo BindDataset="ds_user" Border="Flat" CodeColumn="CODE" Column="LIFNR" DataColumn="CODE_NAME" Height="20" Id="cb_bsu" InnerDataset="ds_bsu" Left="89" Style="sty_ipt_search_ind" TabOrder="4" Top="66" Width="238"></Combo>
		<Grid AutoEnter="TRUE" AutoFitEndLine="Hide" BindDataset="ds_user" BkColor2="default" BoldHead="true" Border="Flat" Bottom="376" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="232" Id="grd_list2" InputPanel="FALSE" Left="8" LineColor="user20" LineType="ExHORZ" OnCellPosChanged="grd_list2_OnCellPosChanged" Right="588" RowHeight="20" Style="sty_grid" TabOrder="19" TabStop="true" Top="144" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="580">
			<contents>
				<format id="Default">
					<columns>
						<col width="30"/>
						<col width="30"/>
						<col width="60"/>
						<col width="62"/>
						<col width="80"/>
						<col width="80"/>
						<col width="90"/>
						<col width="142"/>
						<col width="115"/>
						<col width="163"/>
						<col width="61"/>
						<col width="100"/>
						<col width="71"/>
					</columns>
					<head>
						<cell col="0" display="checkbox" edit="checkbox" font="굴림,9"/>
						<cell align="center" col="1" color="user21" display="text" font="굴림,9" text="No"/>
						<cell align="center" col="2" color="user21" display="text" font="굴림,9" text="지역"/>
						<cell align="center" col="3" color="user21" display="text" font="굴림,9" text="팀장여부"/>
						<cell align="center" col="4" color="user21" display="text" font="굴림,9" text="팀장명"/>
						<cell align="center" col="5" color="user21" display="text" font="굴림,9" text="성명"/>
						<cell align="center" col="6" color="user21" display="text" font="굴림,9" text="생년월일"/>
						<cell align="center" col="7" color="user21" display="text" font="굴림,9" text="업체"/>
						<cell align="center" col="8" color="user21" display="text" font="굴림,9" text="휴대폰번호"/>
						<cell align="center" col="9" color="user21" display="text" font="굴림,9" text="이메일"/>
						<cell align="center" col="10" color="user21" display="text" font="굴림,9" text="재직여부"/>
						<cell align="center" col="11" color="user21" display="text" font="굴림,9" text="생성일자"/>
						<cell align="center" col="12" color="user21" display="text" font="굴림,9" text="생성자"/>
					</head>
					<body>
						<cell align="center" bkcolor2="user22" col="0" colid="CHK" display="checkbox" edit="checkbox"/>
						<cell align="center" bkcolor2="user22" col="1" display="text" expr="currow+1"/>
						<cell align="center" bkcolor2="user22" col="2" colid="ARA" combocol="CODE" combodataset="ds_ara" combotext="CODE_NAME" display="combo" limit="100" Valign="Center"/>
						<cell align="center" bkcolor2="user22" col="3" colid="TJYN" combodisplayrowcnt="0" display="checkbox" Valign="Center"/>
						<cell align="center" bkcolor2="user22" col="4" colid="TNAM" combocol="NAM" combodataset="ds_tuser_list" combotext="NAM" display="combo" limit="100" Valign="Center"/>
						<cell align="center" bkcolor2="user22" col="5" colid="NAM" combodisplayrowcnt="0" display="text" limit="100" Valign="Center"/>
						<cell align="center" bkcolor2="user22" col="6" colid="BDT" combodisplayrowcnt="4" display="text" limit="100" Mask="####.##.##" Valign="Center"/>
						<cell align="center" bkcolor2="user22" col="7" colid="LIFNR_NM" combodisplayrowcnt="0" display="text" limit="100" Valign="Center"/>
						<cell align="center" bkcolor2="user22" col="8" colid="TEL" display="text" limit="100" Mask="###-####-####" Valign="Center"/>
						<cell align="center" bkcolor2="user22" col="9" colid="EML" display="text" limit="100" Valign="Center"/>
						<cell align="center" bkcolor2="user22" col="10" colid="JOB" display="text" limit="100" Valign="Center"/>
						<cell align="center" bkcolor2="user22" col="11" colid="CDT" display="text" expr="TODAY()" limit="100" Mask="####.##.##" Valign="Center"/>
						<cell align="left" bkcolor2="user22" col="12" colid="CID_NAM" display="text" limit="100" multiline="true" wordwrap="exchar"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Static Align="Right" Height="24" Id="Static0" Left="8" Style="sty_lb_form_basic" TabOrder="20" Text="재직여부" Top="90" VAlign="Middle" Width="80"></Static>
		<Edit Align="CENTER" BindDataset="ds_user" Border="Flat" Column="BDT" Height="20" Id="ed_bir" Left="474" LeftMargin="4" MaxLength="8" Number="TRUE" OnChanged="ed_bir_OnChanged" RightMargin="4" Style="sty_ipt_form" TabOrder="3" Top="43" Width="110"></Edit>
		<Edit BindDataset="ds_user" Border="Flat" Column="EML" Height="20" Id="ed_email" Left="474" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="7" Top="92" Width="110"></Edit>
		<Static Align="Right" Height="24" Id="Static3" Left="393" Style="sty_lb_form_basic" TabOrder="22" Text="이메일" Top="90" VAlign="Middle" Width="80"></Static>
		<Static Align="Right" Height="24" Id="Static4" Left="201" Style="sty_lb_form_basic" TabOrder="23" Text="팀장여부" Top="91" VAlign="Middle" Width="80"></Static>
		<Checkbox BindDataset="ds_user" Column="TJYN" Height="15" Id="chk_tjyn" Left="289" OnClick="chk_tjyn_OnClick" TabOrder="24" Text="Checkbox0" Top="95" Value="FALSE" Width="12"></Checkbox>
		<Shape BKColor="user12" Bottom="140" Height="26" Id="Shape2" Left="7" LineColor="user13" Right="587" TabOrder="28" Top="114" Type="Rectangle" Width="580"></Shape>
		<Combo BindDataset="ds_user" Border="Flat" CodeColumn="NAM" Column="TNAM" DataColumn="NAM" DisableBKColor="user5" Height="20" Id="sel_tnam" InnerDataset="ds_tuser_list" Left="89" OnClick="sel_tnam_OnClick" Style="sty_ipt_form" TabOrder="25" Top="116" Width="110"></Combo>
		<Static Align="Right" Height="24" Id="Static5" Left="8" Style="sty_lb_form_basic" TabOrder="26" Text="재직여부" Top="115" VAlign="Middle" Width="80"></Static>
		<Static Align="Right" Height="24" Id="Static6" Left="8" Style="sty_lb_form_basic" TabOrder="27" Text="팀장명" Top="115" VAlign="Middle" Width="80"></Static>
		<Button Cursor="HAND" Height="18" Id="btn_tnam_reset" ImageID="btn_icon_trash" Left="199" OnClick="btn_tnam_reset_OnClick" TabOrder="29" Text="Button0" Top="118" Width="18"></Button>
	</Form>
	<Script><![CDATA[﻿﻿﻿﻿﻿﻿﻿﻿/*
 ******************************************************************************************
 * 기      능   : 설치면허업체 직원등록화면
 * 작  성  자   : Yong ahreum
 * 작성  일자   : 2017.06
 * ----------------------------------------------------------------------------------------
 * HISTORY    : 
 ******************************************************************************************
 */
#include "LIB::commons.js";	// 공통 스크립트 
#include "LIB::common_cs.js";	// 서비스 공통 스크립트
#include "LIB::utility.js";	// 다중 선택 
//=========================================================================================
// [ PART 1 ]
// Form에서 사용될 전역변수를 선언
// FORM에서 사용되는 전역변수는 대문자로 작성하며, F_XXX 의 형태를 갖도록 한다. 
//=========================================================================================
var userGroup;
var psno;
var juno;
var irum;
var gRow = null;
var icnt;
var save_auth = true; // 2019.07.02
//=========================================================================================
// [ PART 2 ]
// Form Loading / Unloading 시 작업 정의
//=========================================================================================
function fn_OnLoadCompleted(obj) {
	gfn_initForm();

	var codeArr = ["CS115"];
	var dsObjArr = [ds_ara];
	
	var addTypeArr = [G_CODE_ALL,G_CODE_SELECT];
	gfn_searchCommCode(codeArr, dsObjArr, addTypeArr);
	
	gfn_initDs(ds_rcond, true);
	ds_rcond.SetColumn(0, "ZPROGRAM", "CS9610002B");
	ds_rcond.SetColumn(0, "GBN", "01");	
	save_auth = gfn_getAuth(ds_rcond);
	ds_rcond.ClearData();
	
	if(save_auth == true) { // MOD 사업팀
		//==========================권한에 대한 버튼 활성/비활성 처리==================================
		div_btn.btn_save.Enable 	= true;	// 저장버튼
		div_btn.btn_input.Enable 	= true;	// 입력버튼
		div_btn.btn_delete.Enable 	= true;	// 삭제버튼
		div_btn.btn_query.Enable 	= true;	// 조회버튼
		//=============================================================================================		
	} else {
		//==========================권한에 대한 버튼 활성/비활성 처리==================================
		div_btn.btn_save.Enable 	= false;	// 저장버튼
		div_btn.btn_input.Enable 	= false;	// 입력버튼
		div_btn.btn_delete.Enable 	= false;	// 삭제버튼
		//=============================================================================================	
	}
	
	cb_ara1.Enable = false;
	ufn_setBsu();
	fn_getTeamLeader();
	fn_query();
}

/********************************************************************************
* 기      능   : 공통코드가 조회된 후의 Callback 함수 
********************************************************************************/
function fn_completeInit(sCode, sDsObj, sCodeType) {

}

/********************************************************************************
* 기      능   : form UnloadCompleted 
********************************************************************************/
function fn_OnUnloadCompleted(obj) {
	return gfn_isFormUnload(obj);
}

//=========================================================================================
// [ PART 3 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,form닫기)
//=========================================================================================
/********************************************************************************
* 기      능   : 조회 
********************************************************************************/
function fn_query() {

	ds_cond.SetColumn(0, "ARA", ara);
	//================================2019.06.25 업체코드 데이터셋 세팅 시작==================================
	if(length(cb_bsu.Value) > 0) {
		ds_cond.SetColumn(0, "BSU", cb_bsu.Value);
	} else {
		ds_cond.SetColumn(0, "BSU", ds_bsu.GetColumn(0,"CODE")); // 초기진입시 협력사 콤보의 첫번째 항목을 세팅한다.
	}
	//================================2019.06.25 업체코드 데이터셋 세팅 종료==================================	
	ds_user.ClearData();
	
	tit_clearActionInfo();
	tit_addSearchActionInfo("cs96:CS9610002A_S3");
	tit_callService(
        ""
        , ""
        , "ds_cond=ds_cond"
        , "ds_user=ds_user"
        , ""
        , "fn_afterQuery"
        , true
        , true);
}

/********************************************************************************
* 기      능   : 조회 Callback  
********************************************************************************/
function fn_afterQuery(errCode, errMsg) {
	gfn_showMsg("CI00002",ds_user.RowCount()+"");
	
	// 해당 사업자로 등록된 인원 없을시 재조회를 위한 데이터셋 세팅. 2019.07.02 Han J.H
	if(ds_user.rowcount < 1) {
		gfn_addGridRow(grd_list2, -1, "FLAG");
		ds_user.SetColumn(0, "ARA", ds_cond.GetColumn(0, "ARA"));
		ds_user.SetColumn(0, "LIFNR", ufn_setBsu());
	}
}

/********************************************************************************
* 기      능   : 저장
********************************************************************************/
function fn_save() {

	gfn_clearMsgBar();

	// for(var i=0; i<ds_user.RowCount(); i++) {
		// ds_user.SetColumn(i, "CHK",  true); 
	// }
	gfn_copyDs(ds_user, ds_user_save, "CHK=1");
	if(ds_user.rowCount() < 1) {
		// 저장할 정보 없음.
		gfn_showAlert("CW00010");
		return;
	}	
	
	if(ds_user.FindRow("CHK", 1) == -1) {
		gfn_showMsg("CW00013");
		return;
	}
	var j =0;
	for(var i=0; i<ds_user.RowCount(); i++) {
		if(ds_user.GetColumn(i, "CHK") == true) {
			if(length(trim(ds_user.GetColumn(i, "NAM"))) == 0){	
				gfn_showAlert("CW00001", "성명");
				return;
			}
			if(length(trim(ds_user.GetColumn(i, "ARA"))) == 0){	
				gfn_showAlert("CW00001", "지역");
				return;
			}
			if(length(trim(ds_user.GetColumn(i, "LIFNR"))) == 0){	
				gfn_showAlert("CW00001", "업체");
				return;
			}
			if(length(trim(ds_user.GetColumn(i, "BDT"))) == 0){	
				gfn_showAlert("CW00001", "생년월일");
				return;
			}
			if(length(trim(ds_user.GetColumn(i, "JOB"))) == 0){	
				gfn_showAlert("CW00001", "재직여부");
				return;
			}
		}	
		j++;	
	}
	tit_clearActionInfo();
	tit_addMultiActionInfo("cs96:CS9610002B_I1"); 
	tit_callService(
		""
		, ""
		, "ds_user_save=ds_user_save"
		, ""
		, ""
		, "fn_afterSave"
		, true);
}

/**********************************************************************s**********
* 기      능   : 삭제
********************************************************************************/
function fn_delete() {	
	
	if(ds_user.FindRow("CHK", 1) == -1) {
		gfn_showMsg("CW00013");
		return false;
	}
	var j = 0;
	for(var i=0; i<ds_user.RowCount(); i++) {					
		if(ds_user.GetColumn(i, "CHK") == true) {
			ds_userdel.AddRow();
			ds_userdel.SetColumn(j, "NAM", ds_user.GetColumn(i, "NAM"));
			ds_userdel.SetColumn(j, "BDT", ds_user.GetColumn(i, "BDT"));
			ds_userdel.SetColumn(j, "LIFNR", ds_user.GetColumn(i, "LIFNR"));
			ds_userdel.SetColumn(j, "ARA", ds_user.GetColumn(i, "ARA"));				
			j++;
		}
	}

	tit_clearActionInfo();
	tit_addMultiActionInfo("cs96:CS9610002B_D1"); 
	tit_callService(
		""
		, ""
		, "ds_userdel=ds_userdel"
		, ""
		, ""
		, "fn_afterSave"
		, true);

}
/********************************************************************************
* 기      능   : 삭제 Callback  
********************************************************************************/
function fn_afterSave(errCode, errMsg) {
	if(errCode != 0) {
		gfn_showMsg("CE00001");
	} else {
		gfn_showMsg("CI00005");
		fn_getTeamLeader(); // 2019.07.02 저장 후 팀장목록 리프레시
		fn_query();
	}
}

/********************************************************************************
* 기      능   : 삭제 Callback  
********************************************************************************/
function fn_afterDelete(errCode, errMsg) {
	if(errCode != 0) {
		gfn_showMsg("CE00001");
	} else {
		gfn_showMsg("CI00005");
	}
}

/********************************************************************************
* 기      능   : 닫기  
********************************************************************************/
function fn_close() {
//	var arr = "Q2"; // parent 의 두번째 그리드만 조회
//	parent.fn_query(arr);
	close();
}

//=========================================================================================
// [ PART 4]
// Callback 함수 정의 : callback 함수명은 메인 함수의 fn_xxxx() 에서 xxxx 부분은 fn_afterXXXX()
// 형태가 되도록 작성 
//=========================================================================================

/********************************************************************************
* 기      능   : 액셀  
********************************************************************************/
function fn_excel() {
	gfn_saveToExcel(grd_list2, true);
}

/********************************************************************************
* 기      능   : 입력
********************************************************************************/
function fn_input()
{	
	var selIdx = ds_user.GetRowPos(); // 선택된 협력사명을 가져와서 새로운 그리드에 셋팅
	
	gfn_addGridRow(grd_list2, -1, "FLAG");
	
	ds_user.SetColumn(ds_user.currow, "CHK", "1");
	ds_user.SetColumn(ds_user.currow, "FLAG", "I");
	ds_user.SetColumn(ds_user.currow, "ARA", ds_cond.GetColumn(0, "ARA"));
	//ds_user.SetColumn(ds_user.currow, "LIFNR", ufn_setBsu());
	ds_user.SetColumn(ds_user.currow, "LIFNR", ds_user.GetColumn(selIdx, "LIFNR"));
	);
}

/********************************************************************************
* 기      능   : 달력에서 일자 선택했을 경우 
********************************************************************************/
function cal_temp_OnDayClick(obj,strText) {
	obj.Visible = false;
}

/********************************************************************************
* 기      능   : 달력에서 포커스 잃었을 경우 
********************************************************************************/
function cal_temp_OnKillFocus(obj) {
	obj.Visible = false;
}

function ufn_setBsu() {	
	//ds_cond.SetColumn(0, "ARA", cb_ara1.Value);
	ds_cond.SetColumn(0, "ARA", ara);
	tit_clearActionInfo();
	tit_addSearchActionInfo("cs96:CS9610002A_S2");
	tit_callService(
		""
		, ""
		, "ds_cond=ds_cond"
		, "ds_bsu=ds_bsu"
		, ""
		, "fn_afterBsu"
		, true
		, true
		, true
		);	        
}
function fn_afterBsu(){
	if(ds_bsu.rowcount > 0) {
		ds_bsu.DeleteRow(0);
	}
}

function cal_cdate_OnChanged(obj,strOldText,strNewText)
{
	var yyyy = toNumber(substr(strNewText, 0, 4)) + 3;
	var mmdd = substr(strNewText, 4, 4);
	var date = yyyy + mmdd;
	cal_edate.Value = gfn_getBeforeDate(date, 1);
}
/********************************************************************************
* 기      능   : 전체 팀장목록 가져오기 
********************************************************************************/
function fn_getTeamLeader() {
	ds_cond.SetColumn(0, "ARA", ara);
	
	ds_tuser_list.ClearData();
		
	tit_clearActionInfo();
	tit_addSearchActionInfo("cs96:CS9610002A_S4");
	
	tit_callService(
        ""
        , ""
        , "ds_cond=ds_cond"
        , "ds_tuser_list=ds_tuser_list"
        , ""
        , "fn_afterGetTeamLeader"
        , true
        , false
        , true);	
}

function fn_afterGetTeamLeader() {
	//if(length(cb_bsu.Value) > 0) {
		//alert('ok');
	//}
}

function grd_list2_OnCellPosChanged(obj,nRow,nCell,nOldRow,nOldCell,nPivotIndex,nOldPivotIndex)
{
	if(length(ds_user.GetColumn(nRow,"LIFNR")) > 0) { // 그리드의 업체명이 존재하면 해당 업체명으로 팀장명 필터링
		
		ds_tuser_list.filter("LIFNR == " + quote( ds_user.GetColumn(nRow,"LIFNR")));
		
		if(ds_tuser_list.rowcount < 1) { // 업체명으로 팀장리스트를 필터링후 기등록된 팀장이 존재하지 않으면 콤보박스 비활성화
			sel_tnam.Enable = false; // 팀장명 콤보박스 선택 비활성화
		} else { // 기등록된 팀장이 존재한다면
			// 팀장일때에는 팀장명 콤보박스를 비활성화 시킨다.
			if(ds_user.GetColumn(nRow,"TJYN") == '1') {
				sel_tnam.Enable = false; // 팀장명 콤보박스 선택 비활성화
			} else {
				sel_tnam.Enable = true; // 팀장명 콤보박스 선택 활성화
			}		
		}
	}
}
/********************************************************************************
* 기      능   : 팀장명 초기화 
********************************************************************************/
function btn_tnam_reset_OnClick(obj)
{
	if(length(trim(sel_tnam.Text)) < 1) {
		gfn_showAlert("팀장명이 선택되어 있지 않습니다. 다시 한번 확인해주세요.");
		return;
	} else {
		sel_tnam.Text = ''; // 팀장명 초기화
	}
}
/********************************************************************************
* 기      능   : 팀장여부 비활성화에 대한 검증로직
********************************************************************************/
function chk_tjyn_OnClick(obj,strValue)
{
	if(chk_tjyn.Value == '0') { // 팀장여부 비활성화 시
		var resultIdx = ds_user.FindRow("TNAM",ed_nam.Text);
		if(resultIdx != '-1') {
			gfn_showAlert("해당 팀장명으로 팀원이 선택되어 있습니다. 팀원 초기화 저장 후 진행해주세요.");
			chk_tjyn.Value = '1';
			return;
		}
	} else if(chk_tjyn.Value == '1') { // 팀장여부 활성화 시
		if(length(trim(ds_user.GetColumn(ds_user.currow,"TNAM"))) > 0) { // 팀원이면 팀장여부를 선택하지 못하도록 처리
			gfn_showAlert("팀원이므로 팀장여부를 선택하실수 없습니다. 팀장명 해제 후 선택해주십시오.");
			chk_tjyn.Value = '0';
			return;
		}
	}
}]]></Script>
</Window>