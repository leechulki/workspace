<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="200" Id="CS9615001B" Left="8" OnKeyDown="gfn_EnterInForm" OnLoadCompleted="fn_OnLoadCompleted" PidAttrib="7" Title="문서&#32;저장" Top="8" Ver="1.0" Width="496" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_cond">
				<Contents>
					<colinfo id="CS655_DOC" size="30" summ="default" type="STRING"/>
					<colinfo id="CS655_OKN" size="3" summ="default" type="STRING"/>
					<colinfo id="CS655_DKN" size="3" summ="default" type="STRING"/>
					<record>
						<CS655_DKN></CS655_DKN>
						<CS655_DOC></CS655_DOC>
						<CS655_OKN></CS655_OKN>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_dknno">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<colinfo id="DTEXT1" size="256" summ="default" type="STRING"/>
					<colinfo id="DTEXT2" size="256" summ="default" type="STRING"/>
					<record>
						<CODE>1</CODE>
						<CODE_NAME>계약서</CODE_NAME>
						<DTEXT1></DTEXT1>
						<DTEXT2></DTEXT2>
					</record>
					<record>
						<CODE>2</CODE>
						<CODE_NAME>발주서</CODE_NAME>
						<DTEXT1></DTEXT1>
						<DTEXT2></DTEXT2>
					</record>
					<record>
						<CODE>3</CODE>
						<CODE_NAME>계약변경합의서</CODE_NAME>
						<DTEXT1></DTEXT1>
						<DTEXT2></DTEXT2>
					</record>
					<record>
						<CODE>4</CODE>
						<CODE_NAME>작업완료확인서</CODE_NAME>
						<DTEXT1></DTEXT1>
						<DTEXT2></DTEXT2>
					</record>
					<record>
						<CODE>5</CODE>
						<CODE_NAME>추가약정서</CODE_NAME>
						<DTEXT1></DTEXT1>
						<DTEXT2></DTEXT2>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_head">
				<Contents>
					<colinfo id="MANDT" size="256" summ="default" type="STRING"/>
					<colinfo id="CS655_DOC" size="256" summ="default" type="STRING"/>
					<colinfo id="CS655_SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="CS655_NAM" size="256" summ="default" type="STRING"/>
					<colinfo id="CS655_SIZ" size="256" summ="default" type="STRING"/>
					<colinfo id="CS655_OKN" size="256" summ="default" type="STRING"/>
					<colinfo id="CS655_DKN" size="256" summ="default" type="STRING"/>
					<colinfo id="CS655_IID" size="256" summ="default" type="STRING"/>
					<colinfo id="CS655_IDA" size="256" summ="default" type="STRING"/>
					<colinfo id="CS655_UID" size="256" summ="default" type="STRING"/>
					<colinfo id="CS655_UDA" size="256" summ="default" type="STRING"/>
					<colinfo id="CS655_STA" size="256" summ="default" type="STRING"/>
					<colinfo id="FILE_PATH" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_seqstat">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_draft">
				<Contents>
					<colinfo id="DEPT_N" size="60" summ="default" type="STRING"/>
					<colinfo id="DPT1" size="6" summ="default" type="STRING"/>
					<colinfo id="DPT1_N" size="60" summ="default" type="STRING"/>
					<colinfo id="IRUM" size="36" summ="default" type="STRING"/>
					<colinfo id="PSNO" size="30" summ="default" type="STRING"/>
					<colinfo id="RANK" size="6" summ="default" type="STRING"/>
					<colinfo id="RANK_N" size="36" summ="default" type="STRING"/>
					<colinfo id="TELH" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_stat">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_error">
				<Contents>
					<colinfo id="IDX" size="256" type="STRING"/>
					<colinfo id="ERRMSG" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_docno_gen">
				<Contents>
					<colinfo id="PFX" size="256" type="STRING"/>
					<colinfo id="DOCNO" size="256" type="STRING"/>
					<record>
						<PFX></PFX>
						<DOCNO></DOCNO>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_oknno">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<colinfo id="DTEXT1" size="256" summ="default" type="STRING"/>
					<colinfo id="DTEXT2" size="256" summ="default" type="STRING"/>
					<record>
						<CODE>1</CODE>
						<CODE_NAME>정기보수</CODE_NAME>
						<DTEXT1></DTEXT1>
						<DTEXT2></DTEXT2>
					</record>
					<record>
						<CODE>2</CODE>
						<CODE_NAME>수리공사</CODE_NAME>
						<DTEXT1></DTEXT1>
						<DTEXT2></DTEXT2>
					</record>
					<record>
						<CODE>3</CODE>
						<CODE_NAME>부품판매</CODE_NAME>
						<DTEXT1></DTEXT1>
						<DTEXT2></DTEXT2>
					</record>
				</Contents>
			</Dataset>
		</Datasets>
		<Shape BKColor="user12" Bottom="74" Height="26" Id="Shape1" Left="9" LineColor="user13" Right="488" TabOrder="5" Top="48" Type="Rectangle" Width="479"></Shape>
		<Div Height="36" Id="div_btn" TabOrder="3" Text="Div0" Url="WB01::CommBtnForm.xml" Width="498">
			<Contents></Contents>
		</Div>
		<Image Height="36" Id="Image1" ImageID="form_bl_title_main" Left="8" TabOrder="1" Top="-1" Width="15"></Image>
		<Static Color="user5" Font="굴림,10,Bold" Height="20" Id="Static0" Left="28" TabOrder="2" Text="MMPR&#32;조회" Top="8" VAlign="Middle" Width="192"></Static>
		<Static Align="Right" Height="24" Id="Static16" Left="10" Style="sty_lb_form_basic" TabOrder="4" Text="오더유형&#32;" Top="49" VAlign="Middle" Width="62"></Static>
		<Static Border="None" Color="user7" Font="굴림,9" Height="20" Id="Static2" Left="8" TabOrder="6" Text="※&#32;첨부&#32;(최대&#32;1Mb)" Top="80" VAlign="Middle" Width="120"></Static>
		<Edit Border="Flat" Height="20" Id="ed_fileName" Left="128" LeftMargin="4" Readonly="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="7" Top="104" Width="296"></Edit>
		<Button Height="18" Id="btn_openFile" ImageID="btn_icon_polder" Left="429" OnClick="btn_openFile_OnClick" TabOrder="8" Text="Button0" Top="104" Width="18"></Button>
		<Button Height="18" Id="btn_deleteFile" ImageID="btn_icon_trash" Left="448" OnClick="btn_deleteFile_OnClick" TabOrder="9" Text="Button0" Top="104" Width="18"></Button>
		<File Bottom="226" Height="24" Id="f_tmp" Left="358" Right="382" TabOrder="25" Top="202" Width="24"></File>
		<FileDialog Bottom="226" Height="24" Id="fileDialog" Left="335" Right="359" TabOrder="26" Top="202" Width="24"></FileDialog>
		<Button Enable="FALSE" Height="18" Id="btn_saveFile" ImageID="btn_icon_save" Left="469" OnClick="btn_saveFile_OnClick" TabOrder="13" Text="Button0" Top="104" Width="18"></Button>
		<CyHttpFile Height="24" Id="httpFile" Left="383" Top="202" Width="24"></CyHttpFile>
		<FileDialog Bottom="226" FilePath="c:\" Height="24" Id="saveDialog" Left="311" Right="335" TabOrder="15" Top="202" Type="Save" Width="24"></FileDialog>
		<Edit Border="Flat" Height="20" Id="ed_fileName2" Left="128" LeftMargin="4" Readonly="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="11" Top="127" Width="296"></Edit>
		<Button Height="18" Id="btn_openFile2" ImageID="btn_icon_polder" Left="429" OnClick="btn_openFile_OnClick2" TabOrder="12" Text="Button0" Top="128" Width="18"></Button>
		<Button Height="18" Id="btn_deleteFile2" ImageID="btn_icon_trash" Left="449" OnClick="btn_deleteFile_OnClick2" TabOrder="13" Text="Button0" Top="128" Width="18"></Button>
		<Button Enable="FALSE" Height="18" Id="btn_saveFile2" ImageID="btn_icon_save" Left="469" OnClick="btn_saveFile_OnClick2" TabOrder="14" Text="Button0" Top="128" Width="18"></Button>
		<Edit Border="Flat" Height="20" Id="ed_fileName3" Left="128" LeftMargin="4" Readonly="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="15" Top="150" Width="296"></Edit>
		<Button Height="18" Id="btn_openFile3" ImageID="btn_icon_polder" Left="429" OnClick="btn_openFile_OnClick3" TabOrder="16" Text="Button0" Top="151" Width="18"></Button>
		<Button Height="18" Id="btn_deleteFile3" ImageID="btn_icon_trash" Left="449" OnClick="btn_deleteFile_OnClick3" TabOrder="17" Text="Button0" Top="151" Width="18"></Button>
		<Button Enable="FALSE" Height="18" Id="btn_saveFile3" ImageID="btn_icon_save" Left="469" OnClick="btn_saveFile_OnClick3" TabOrder="18" Text="Button0" Top="151" Width="18"></Button>
		<Combo Border="Flat" CodeColumn="CODE" Column="DOCKIND" DataColumn="CODE_NAME" Enable="FALSE" Height="20" Id="cb_oknno" InnerDataset="ds_oknno" Left="74" Style="sty_ipt_search" TabOrder="19" Top="50" Width="116"></Combo>
		<Edit Border="Flat" Height="20" Id="ed_fileName4" Left="128" LeftMargin="4" Readonly="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="20" Top="173" Width="296"></Edit>
		<Button Height="18" Id="btn_openFile4" ImageID="btn_icon_polder" Left="429" OnClick="btn_openFile_OnClick4" TabOrder="21" Text="Button0" Top="174" Width="18"></Button>
		<Button Height="18" Id="btn_deleteFile4" ImageID="btn_icon_trash" Left="449" OnClick="btn_deleteFile_OnClick4" TabOrder="22" Text="Button0" Top="174" Width="18"></Button>
		<Button Enable="FALSE" Height="18" Id="btn_saveFile4" ImageID="btn_icon_save" Left="469" OnClick="btn_saveFile_OnClick4" TabOrder="23" Text="Button0" Top="174" Width="18"></Button>
		<Combo Border="Flat" CodeColumn="CODE" Column="DOCKIND" DataColumn="CODE_NAME" Enable="FALSE" Height="20" Id="cb_dknno1" InnerDataset="ds_dknno" Left="7" Style="sty_ipt_search" TabOrder="24" Top="103" Width="116"></Combo>
		<Combo Border="Flat" CodeColumn="CODE" Column="DOCKIND" DataColumn="CODE_NAME" Enable="FALSE" Height="20" Id="cb_dknno2" InnerDataset="ds_dknno" Left="7" Style="sty_ipt_search" TabOrder="25" Top="126" Width="116"></Combo>
		<Combo Border="Flat" CodeColumn="CODE" Column="DOCKIND" DataColumn="CODE_NAME" Enable="FALSE" Height="20" Id="cb_dknno3" InnerDataset="ds_dknno" Left="7" Style="sty_ipt_search" TabOrder="26" Top="149" Width="116"></Combo>
		<Combo Border="Flat" CodeColumn="CODE" Column="DOCKIND" DataColumn="CODE_NAME" Enable="FALSE" Height="20" Id="cb_dknno4" InnerDataset="ds_dknno" Left="7" Style="sty_ipt_search" TabOrder="27" Top="172" Width="116"></Combo>
	</Form>
	<Script><![CDATA[﻿﻿﻿﻿﻿﻿﻿﻿/*
 ******************************************************************************************
 * 기      능   : 
 * 작  성  자   : 
 * 작성  일자   : 
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
#include "LIB::commons.js";	// 공통 스크립트 
//=========================================================================================
// [ PART 1 ]
// Form에서 사용될 전역변수를 선언
// FORM에서 사용되는 전역변수는 대문자로 작성하며, F_XXX 의 형태를 갖도록 한다. 
//=========================================================================================
var F_SIZE = 1024 * 1024 * 1;	// 최대1Mb
var file = "";
var fileSize = "";
var completeFlag = false;		//20141203이종석:결재상신 완료 플래그 세팅
var sendbackFlag = false;		// 20141211 MG.J:결재반송 결과 플래그
var sendbackClick = "N";		// 20141211 MG.J:반송버튼클릭여부
//=========================================================================================
// [ PART 2 ]
// Form Loading / Unloading 시 작업 정의
//=========================================================================================
function fn_OnLoadCompleted(obj) {
	// Form 로드 이벤트 맨 첫줄에 기술 
	gfn_initForm();

    // 구분 코드값 가져오기
    var codeArr = ["WBAP_STAT","WBAP_SEQSTAT"];
    var dsObjArr = [ds_stat,ds_seqstat];
    var addTypeArr = [G_CODE_NONE,G_CODE_NONE];
    gfn_searchCommCode(codeArr, dsObjArr, addTypeArr,true);
    
    /*
    ed_fileName2.Enable = false;
	btn_openFile2.Enable = false;
	btn_deleteFile2.Enable = false;
	btn_saveFile2.Enable = false;
	
	ed_fileName3.Enable = false;
	btn_openFile3.Enable = false;
	btn_deleteFile3.Enable = false;
	btn_saveFile3.Enable = false;
	*/
	//alert(fa_docno+"---"+fa_oknno+"---"+fa_dknno);
	
	cb_oknno.value = fa_oknno;
	//cb_dknno.value = fa_dknno;

	
    // 문서번호
    // 문서 구분 설정

    if(length(fa_docno) > 0)
    {
		ds_cond.SetColumn(0,"CS655_DOC", fa_docno);
		ds_cond.SetColumn(0,"CS655_OKN", fa_oknno);
		//ds_cond.SetColumn(0,"CS655_DKN", fa_dknno);  

		fn_query();
	} else {
		if(cb_oknno.Value=="1") {
			cb_dknno1.Value="1";
			cb_dknno2.Value="2";
			cb_dknno3.Value="3";
			cb_dknno4.Value="5";
			ds_head.AddRow();
			ds_head.AddRow();
			ds_head.AddRow();
			ds_head.AddRow();
			ds_head.SetColumn(0,"CS655_DKN", "1");
			ds_head.SetColumn(1,"CS655_DKN", "2");
			ds_head.SetColumn(2,"CS655_DKN", "3");
			ds_head.SetColumn(3,"CS655_DKN", "5");
		} else if(cb_oknno.Value=="2"){
		}
		else {
		}
	}

    /*
    tit_clearActionInfo();
	tit_addSearchActionInfo("cs96:CS9615001B_S1");
	
	tit_callService(
         ""
         , ""
         , "ds_cond=ds_cond"
         , "ds_head=ds_head"
         , ""
         , "fn_afterQuery"
         , true);
    
    */
	//trace(ds_cond.SaveXML());

}
/********************************************************************************
* 기      능   : 공통코드가 조회된 후의 Callback 함수 
********************************************************************************/
function fn_completeInit(sCode, sDsObj, sCodeType) {
}
/********************************************************************************
* 기      능   : form UnloadCompleted 
********************************************************************************/
function fn_OnUnloadCompleted(obj) {
	return gfn_isFormUnload(obj);
}
//=========================================================================================
// [ PART 3 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,form닫기)
//=========================================================================================
/********************************************************************************
* 기      능   : 조회 1
********************************************************************************/
function fn_query() {

	 	tit_clearActionInfo();
		tit_addSearchActionInfo("cs96:CS9615001B_S1");
	
		tit_callService(
			 ""
			 , ""
			 , "ds_cond=ds_cond"
			 , "ds_head=ds_head"
			 , ""
			 , "fn_afterQuery"
			 , true);
}
/********************************************************************************
* 기      능   : 삽입 20
********************************************************************************/
function fn_insert() {
	// 그리드에 row 추가 
	//var newRow = gfn_addGridRow(grd_list, -1, "FLAG");
}
/********************************************************************************
* 기      능   : Delete 
********************************************************************************/
function fn_delete() {

}

/********************************************************************************
* 기      능   : 닫기  
********************************************************************************/
function fn_close() {
	close("S");
}
/********************************************************************************
* 기      능   : 액셀  
********************************************************************************/
// function fn_excel() {
	// Excel Export 
	// gfn_saveToExcel(grd_list, true );
// }


/********************************************************************************
* 기      능   : print 40
********************************************************************************/
function fn_print() {

}

//=========================================================================================
// [ PART 4]
// Callback 함수 정의 : callback 함수명은 메인 함수의 fn_xxxx() 에서 xxxx 부분은 fn_afterXXXX()
// 형태가 되도록 작성 
//=========================================================================================
/********************************************************************************
* 기      능   : 조회 Callback  
********************************************************************************/
function fn_afterQuery(errCode, errMsg) {
	if(ds_head.rowcount > 0)
	{
		//alert(ds_head.getColumn(0, "CS655_NAM"));
		for(var i=0; i<ds_head.rowcount; i++) {
			if(i==0){
				cb_dknno1.Value=ds_head.getColumn(i, "CS655_DKN");
				if ( length( ds_head.getColumn(i, "CS655_NAM") ) > 0 ) {
					ed_fileName.value = tit_getLocalFileName(ds_head.getColumn(i, "CS655_NAM")) ;
					ed_fileName.Enable = false;
					btn_saveFile.enable = true;
					btn_openFile.Enable = false;
					btn_deleteFile.Enable = true;
				} else {
					ed_fileName.Enable = true;
					btn_saveFile.enable = false;
					btn_openFile.Enable = true;
					btn_deleteFile.Enable = false;
				}
			}
			if(i==1){
				cb_dknno2.Value=ds_head.getColumn(i, "CS655_DKN");
				if ( length( ds_head.getColumn(i, "CS655_NAM") ) > 0 ) {
					ed_fileName2.value = tit_getLocalFileName(ds_head.getColumn(i, "CS655_NAM")) ;
					ed_fileName2.Enable = false;
					btn_saveFile2.enable = true;
					btn_openFile2.Enable = false;
					btn_deleteFile2.Enable = true;
				} else {
					ed_fileName2.Enable = true;
					btn_saveFile2.enable = false;
					btn_openFile2.Enable = true;
					btn_deleteFile2.Enable = false;
				}
			}
			if(i==2){
				cb_dknno3.Value=ds_head.getColumn(i, "CS655_DKN");
				if ( length( ds_head.getColumn(i, "CS655_NAM") ) > 0 ) {
					ed_fileName3.value = tit_getLocalFileName(ds_head.getColumn(i, "CS655_NAM")) ;
					ed_fileName3.Enable = false;
					btn_saveFile3.enable = true;
					btn_openFile3.Enable = false;
					btn_deleteFile3.Enable = true;
				} else {
					ed_fileName3.Enable = true;
					btn_saveFile3.enable = false;
					btn_openFile3.Enable = true;
					btn_deleteFile3.Enable = false;
				}
			}
			if(i==3){
				cb_dknno4.Value=ds_head.getColumn(i, "CS655_DKN");
				if ( length( ds_head.getColumn(i, "CS655_NAM") ) > 0 ) {
					ed_fileName4.value = tit_getLocalFileName(ds_head.getColumn(i, "CS655_NAM")) ;
					ed_fileName4.Enable = false;
					btn_saveFile4.enable = true;
					btn_openFile4.Enable = false;
					btn_deleteFile4.Enable = true;
				} else {
					ed_fileName4.Enable = true;
					btn_saveFile4.enable = false;
					btn_openFile4.Enable = true;
					btn_deleteFile4.Enable = false;
				}
			}
			
		}

	} 
}



/********************************************************************************
* 기      능   : 조회 Callback  
********************************************************************************/


/********************************************************************************
* 기      능   : 저장 Callback  
********************************************************************************/

function fn_save() {

	if ( ds_error.rowcount() > 0 ) {
		gfn_showMsg("CE00001");
	} else {
		
		if (!gfn_isChangeDs(ds_head, false)) {
			// CW00005=변경된 정보가 없습니다.
			gfn_showAlert('CW00005');
			return;
		}

		if(length(ds_head.GetColumn(0, "CS655_DOC")) > 0){

			for(i=0;i<ds_head.GetRowCount();i++) {
				if(ds_head.GetRowType(i)=="update"){
					if(length(ds_head.getColumn(i, "CS655_NAM")) > 0){
						ds_head.SetColumn(i,"CS655_STA","U");
						ds_head.SetColumn(i,"CS655_UID",G_USER_ID);
					} else {
						var user_grp = gfn_getUserGroup();
						if(user_grp == "10"){
							gfn_showAlert("CW10025", "삭제 할수 없습니다. 파일을 첨부해 주세요.");
							return;
						}
						ds_head.SetColumn(i,"CS655_STA","D");
						ds_head.SetColumn(i,"CS655_UID",G_USER_ID);
					}
					
					if(length(ds_head.getColumn(i, "CS655_NAM")) > 0) {
						// 첨부 파일 처리 
						var arr = tit_fileWrite(
							httpFile, "CS", ds_head.getColumn(i, "FILE_PATH"), ds_head.getColumn(i, "CS655_NAM"), "", "", "" );  
						
						if( arr[0] == "S" ) {
							// 성공 
							ds_head.setColumn(i, "CS655_NAM", arr[2]);	// 파일 명 
							ds_head.setColumn(i, "CS655_SIZ", fileSize);
						} else {
							gfn_showAlert( arr[1] );
							return;
						}
					} else {
						ds_head.setColumn(i, "CS655_NAM", "");
						ds_head.setColumn(i, "CS655_SIZ", 0);
					}
				
				}
				
	
			}
			
			tit_clearActionInfo();
		
			//저장 처리 
			tit_addMultiActionInfo("cs96:CS9615001B_U1");
			//trace(ds_head.SaveXML());
					
			tit_callService(
				""
				, ""
				, "ds_head=ds_head:U"
				, ""
				, ""
				, ""
				, true
				, true
				, true);
			
			
			
		
		} else {
			
			get_docno();
			
			for(var i=0; i<ds_head.rowcount; i++) {
				ds_head.SetColumn(i,"MANDT",G_MANDT);  //클라이언트
				ds_head.SetColumn(i,"CS655_DOC",ds_docno_gen.GetColumn(0, "DOCNO"));  //파일관리번호
				ds_head.SetColumn(i,"CS655_SEQ",i+1);  //SEQ
				//ds_head.SetColumn(0,"CS655_NAM",G_MANDT);  //파일명
				//ds_head.SetColumn(0,"CS655_SIZ",G_MANDT);  //파일사이즈
				ds_head.SetColumn(i,"CS655_OKN",cb_oknno.value);  //오더유형코드
				//ds_head.SetColumn(i,"CS655_DKN",cb_dknno.value);  //문서구문코드
				ds_head.SetColumn(i,"CS655_IID",G_USER_ID);  //등록자
				//ds_head.SetColumn(0,"CS655_IDA","");  //등록일
				ds_head.SetColumn(i,"CS655_UID",G_USER_ID);  //수정자
				//ds_head.SetColumn(0,"CS655_UDA","");  //수정일
				ds_head.SetColumn(i,"CS655_STA","I");  //상태코드
			}
			
			if(length( ed_fileName.value ) > 0) {
				// 첨부 파일 처리 
				var arr = tit_fileWrite(
					httpFile, "CS", ds_head.getColumn(0, "FILE_PATH"), ds_head.getColumn(0, "CS655_NAM"), "", "", "" );  
				if( arr[0] == "S" ) {
					// 성공 
					ds_head.setColumn(0, "CS655_NAM", arr[2]);	// 파일 명 
					ds_head.setColumn(0, "CS655_SIZ", fileSize);
				} else {
					gfn_showAlert( arr[1] );
					return;
				}
			} 
			else {
				ds_head.setColumn(0, "CS655_NAM", "");
				ds_head.setColumn(0, "CS655_SIZ", 0);
			}
			
			if(length( ed_fileName2.value ) > 0) {
				// 첨부 파일 처리 
				var arr = tit_fileWrite(
					httpFile, "CS", ds_head.getColumn(1, "FILE_PATH"), ds_head.getColumn(1, "CS655_NAM"), "", "", "" );  
				if( arr[0] == "S" ) {
					// 성공 
					ds_head.setColumn(1, "CS655_NAM", arr[2]);	// 파일 명 
					ds_head.setColumn(1, "CS655_SIZ", fileSize);
				} else {
					gfn_showAlert( arr[1] );
					return;
				}
			} 
			else {
				ds_head.setColumn(1, "CS655_NAM", "");
				ds_head.setColumn(1, "CS655_SIZ", 0);
			}
			
			if(length( ed_fileName3.value ) > 0) {
				// 첨부 파일 처리 
				var arr = tit_fileWrite(
					httpFile, "CS", ds_head.getColumn(2, "FILE_PATH"), ds_head.getColumn(2, "CS655_NAM"), "", "", "" );  
				if( arr[0] == "S" ) {
					// 성공 
					ds_head.setColumn(2, "CS655_NAM", arr[2]);	// 파일 명 
					ds_head.setColumn(2, "CS655_SIZ", fileSize);
				} else {
					gfn_showAlert( arr[1] );
					return;
				}
			} 
			else {
				ds_head.setColumn(2, "CS655_NAM", "");
				ds_head.setColumn(2, "CS655_SIZ", 0);
			}
			
			if(length( ed_fileName4.value ) > 0) {
				// 첨부 파일 처리 
				var arr = tit_fileWrite(
					httpFile, "CS", ds_head.getColumn(3, "FILE_PATH"), ds_head.getColumn(3, "CS655_NAM"), "", "", "" );  
				if( arr[0] == "S" ) {
					// 성공 
					ds_head.setColumn(3, "CS655_NAM", arr[2]);	// 파일 명 
					ds_head.setColumn(3, "CS655_SIZ", fileSize);
				} else {
					gfn_showAlert( arr[1] );
					return;
				}
			} 
			else {
				ds_head.setColumn(3, "CS655_NAM", "");
				ds_head.setColumn(3, "CS655_SIZ", 0);
			}
			
			tit_clearActionInfo();
		
			//저장 처리 
			tit_addMultiActionInfo("cs96:CS9615001B_I1");
			//trace(ds_head.SaveXML());
					
			tit_callService(
				""
				, ""
				, "ds_head=ds_head:A"
				, ""
				, ""
				, ""
				, true
				, true
				, true);
			}
			
			
		}
		
		
		close(ds_head.GetColumn(0, "CS655_DOC"));
	}

	
	
}

//=========================================================================================
// [ PART 5 ]
// Detail Process Event 정의 ( User Define function )
// 사용자 정의 함수는 ufn_xxxx() 형태로 작성 
//=========================================================================================
/********************************************************************************
* 기      능   : 사용자 정의 함수  
********************************************************************************/
function ufn_userfunction() {

}

//=========================================================================================
// [ PART 6 ]
// component Event 정의 : 각 Component 별 이벤트 
//=========================================================================================
/********************************************************************************
* 기      능   : 그리드 헤더 클릭시 정렬 처리 
********************************************************************************/
function grd_list_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
{

}

function btn_openFile_OnClick(obj)
{
	fileDialog.open();
	
	if ( length(fileDialog.FilePath) == 0 
		|| length( fileDialog.FileName ) == 0 ) {
		return;
	}

	fileSize = f_tmp.GetLength(fileDialog.FilePath + "\\" + fileDialog.FileName );
	if ( fileSize <= 0 ) {
		gfn_showAlert("CW00048");
		return;
	}
	
	if ( fileSize > toNumber(F_SIZE)) {
		gfn_showAlert("CW00047", "3 Mbytes" );	
		return;
	}
	
	//if(ds_head.rowcount==0) ds_head.AddRow();
	ds_head.SetColumn(0,"CS655_NAM",fileDialog.FileName);  //파일명
	ds_head.SetColumn(0,"CS655_SIZ",fileSize);  //파일사이즈
	ds_head.setColumn(0,"FILE_PATH", fileDialog.FilePath);
	
	//alert(fileDialog.FileName);
	ed_fileName.value = fileDialog.FilePath + "\\" + fileDialog.FileName;
	
	if(ed_fileName.value.Length()>0) {
		ed_fileName2.Enable = true;
		btn_openFile2.Enable = true;
		btn_deleteFile2.Enable = true;
		btn_saveFile2.Enable = true;
	}

}

function btn_openFile_OnClick2(obj)
{
	fileDialog.open();
	
	if ( length(fileDialog.FilePath) == 0 
		|| length( fileDialog.FileName ) == 0 ) {
		return;
	}

	fileSize = f_tmp.GetLength(fileDialog.FilePath + "\\" + fileDialog.FileName );
	if ( fileSize <= 0 ) {
		gfn_showAlert("CW00048");
		return;
	}
	
	if ( fileSize > toNumber(F_SIZE)) {
		gfn_showAlert("CW00047", "3 Mbytes" );	
		return;
	}
	
	//if(ds_head.rowcount==1) ds_head.AddRow();
	ds_head.SetColumn(1,"CS655_NAM",fileDialog.FileName);  //파일명
	ds_head.SetColumn(1,"CS655_SIZ",fileSize);  //파일사이즈
	ds_head.setColumn(1,"FILE_PATH", fileDialog.FilePath);
	
	//alert(fileDialog.FileName);
	ed_fileName2.value = fileDialog.FilePath + "\\" + fileDialog.FileName;
	
	if(ed_fileName2.value.Length()>0) {
		ed_fileName3.Enable = true;
		btn_openFile3.Enable = true;
		btn_deleteFile3.Enable = true;
		btn_saveFile3.Enable = true;
	}

}

function btn_openFile_OnClick3(obj)
{
	fileDialog.open();
	
	if ( length(fileDialog.FilePath) == 0 
		|| length( fileDialog.FileName ) == 0 ) {
		return;
	}

	fileSize = f_tmp.GetLength(fileDialog.FilePath + "\\" + fileDialog.FileName );
	if ( fileSize <= 0 ) {
		gfn_showAlert("CW00048");
		return;
	}
	
	if ( fileSize > toNumber(F_SIZE)) {
		gfn_showAlert("CW00047", "3 Mbytes" );	
		return;
	}
	
	//if(ds_head.rowcount==2) ds_head.AddRow();
	ds_head.SetColumn(2,"CS655_NAM",fileDialog.FileName);  //파일명
	ds_head.SetColumn(2,"CS655_SIZ",fileSize);  //파일사이즈
	ds_head.setColumn(2,"FILE_PATH", fileDialog.FilePath);
	
	//alert(fileDialog.FileName);
	ed_fileName3.value = fileDialog.FilePath + "\\" + fileDialog.FileName;

}

function btn_openFile_OnClick4(obj)
{
	fileDialog.open();
	
	if ( length(fileDialog.FilePath) == 0 
		|| length( fileDialog.FileName ) == 0 ) {
		return;
	}

	fileSize = f_tmp.GetLength(fileDialog.FilePath + "\\" + fileDialog.FileName );
	if ( fileSize <= 0 ) {
		gfn_showAlert("CW00048");
		return;
	}
	
	if ( fileSize > toNumber(F_SIZE)) {
		gfn_showAlert("CW00047", "3 Mbytes" );	
		return;
	}
	
	//if(ds_head.rowcount==2) ds_head.AddRow();
	ds_head.SetColumn(3,"CS655_NAM",fileDialog.FileName);  //파일명
	ds_head.SetColumn(3,"CS655_SIZ",fileSize);  //파일사이즈
	ds_head.setColumn(3,"FILE_PATH", fileDialog.FilePath);
	
	//alert(fileDialog.FileName);
	ed_fileName4.value = fileDialog.FilePath + "\\" + fileDialog.FileName;

}


/********************************************************************************
* 기      능   : 첨부파일 삭제 
********************************************************************************/
function btn_deleteFile_OnClick(obj)
{
	ed_fileName.value = "";

	ds_head.setColumn(0, "CS655_NAM", "");
	ds_head.setColumn(0, "CS655_SIZ", 0);
	ds_head.setColumn(0, "FILE_PATH", "");
	
	ed_fileName.Enable = true;
	btn_openFile.Enable = true;
	btn_deleteFile.Enable = false;
	btn_saveFile.Enable = false;
		
}

function btn_deleteFile_OnClick2(obj)
{
	ed_fileName2.value = "";

	ds_head.setColumn(1, "CS655_NAM", "");
	ds_head.setColumn(1, "CS655_SIZ", 0);
	ds_head.setColumn(1, "FILE_PATH", "");
	
	ed_fileName2.Enable = true;
	btn_openFile2.Enable = true;
	btn_deleteFile2.Enable = false;
	btn_saveFile2.Enable = false;
}

function btn_deleteFile_OnClick3(obj)
{
	ed_fileName3.value = "";

	ds_head.setColumn(2, "CS655_NAM", "");
	ds_head.setColumn(2, "CS655_SIZ", 0);
	ds_head.setColumn(2, "FILE_PATH", "");
	
	ed_fileName3.Enable = true;
	btn_openFile3.Enable = true;
	btn_deleteFile3.Enable = false;
	btn_saveFile3.Enable = false;
	
}

function btn_deleteFile_OnClick4(obj)
{
	ed_fileName4.value = "";

	ds_head.setColumn(3, "CS655_NAM", "");
	ds_head.setColumn(3, "CS655_SIZ", 0);
	ds_head.setColumn(3, "FILE_PATH", "");
	
	ed_fileName4.Enable = true;
	btn_openFile4.Enable = true;
	btn_deleteFile4.Enable = false;
	btn_saveFile4.Enable = false;
	
}


/********************************************************************************
* 기      능   : 첨부파일 저장  
********************************************************************************/
function btn_saveFile_OnClick(obj)
{
	saveDialog.FileName = ed_fileName.value;
    saveDialog.open();
    if ( length(saveDialog.FilePath) == 0 ) {
        return;
    }

	var arr = tit_fileRead(httpFile, "CS"
        , ds_head.getColumn(0, "CS655_NAM")
        , saveDialog.FilePath, saveDialog.FileName);
        
    //alert(arr[0]);
    if ( arr[0] == 'E' ) {
        gfn_alert("Download failed : \n" + arr[1] );
    }
}

function btn_saveFile_OnClick2(obj)
{
	saveDialog.FileName = ed_fileName2.value;
    saveDialog.open();
    if ( length(saveDialog.FilePath) == 0 ) {
        return;
    }

	var arr = tit_fileRead(httpFile, "CS"
        , ds_head.getColumn(1, "CS655_NAM")
        , saveDialog.FilePath, saveDialog.FileName);
        
    //alert(arr[0]);
    if ( arr[0] == 'E' ) {
        gfn_alert("Download failed : \n" + arr[1] );
    }
}

function btn_saveFile_OnClick3(obj)
{
	saveDialog.FileName = ed_fileName3.value;
    saveDialog.open();
    if ( length(saveDialog.FilePath) == 0 ) {
        return;
    }

	var arr = tit_fileRead(httpFile, "CS"
        , ds_head.getColumn(2, "CS655_NAM")
        , saveDialog.FilePath, saveDialog.FileName);
        
    //alert(arr[0]);
    if ( arr[0] == 'E' ) {
        gfn_alert("Download failed : \n" + arr[1] );
    }
}

function btn_saveFile_OnClick4(obj)
{
	saveDialog.FileName = ed_fileName4.value;
    saveDialog.open();
    if ( length(saveDialog.FilePath) == 0 ) {
        return;
    }

	var arr = tit_fileRead(httpFile, "CS"
        , ds_head.getColumn(3, "CS655_NAM")
        , saveDialog.FilePath, saveDialog.FileName);
        
    //alert(arr[0]);
    if ( arr[0] == 'E' ) {
        gfn_alert("Download failed : \n" + arr[1] );
    }
}

function enableFile()
{
	ed_fileName.Enable = true;
	btn_openFile.Enable = true;
	btn_deleteFile.Enable = true;
	btn_saveFile.Enable = false;
}

function get_docno()
{
		ds_docno_gen.ClearData();													//결재번호생성 데이터셋을 클리어한다
		ds_docno_gen.AddRow();																
		ds_docno_gen.SetColumn(0,"PFX","FIL");										//Prefix
		
		tit_clearActionInfo();					
		tit_addSearchActionInfo("wb01:DOC_CODE_GEN_S1",true);					
		tit_addSearchActionInfo("wb01:DOC_CODE_GEN_U1");					
		tit_callService(															//동기화 방식으로 서비스를 콜한다.	
			, ""				
			, "ds_docno_gen_i=ds_docno_gen"				
			, "ds_docno_gen=ds_docno_gen_o"				
			, ""				
			, ""				
			, true
			, false
			, true);				
}]]></Script>
</Window>