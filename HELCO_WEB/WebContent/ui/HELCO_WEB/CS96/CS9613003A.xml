<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="544" Id="CS9613003A" Left="8" OnLoadCompleted="fn_OnLoadCompleted" OnUnloadCompleted="fn_OnUnloadCompleted" PidAttrib="7" Title="시행율&#32;관리(주차)" Top="8" Ver="1.0" Width="978" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_cond">
				<Contents>
					<colinfo id="ZYEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="TYPE" size="256" summ="default" type="STRING"/>
					<record>
						<TYPE></TYPE>
						<ZYEAR></ZYEAR>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_type">
				<Contents>
					<colinfo id="CODE1" size="256" summ="default" type="STRING"/>
					<colinfo id="CTEXT2" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_data">
				<Contents>
					<colinfo id="CS607_YEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="CS607_SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="CS607_TYP" size="256" summ="default" type="STRING"/>
					<colinfo id="CS607_TYPNM" size="256" summ="default" type="STRING"/>
					<colinfo id="CS607_JAMT" size="256" summ="default" type="STRING"/>
					<colinfo id="CS607_LAB_J" size="256" summ="default" type="STRING"/>
					<colinfo id="CS607_LAB_B" size="256" summ="default" type="STRING"/>
					<colinfo id="CS607_IAMT" size="256" summ="default" type="STRING"/>
					<colinfo id="CS607_LAB_N" size="256" summ="default" type="STRING"/>
					<colinfo id="CS607_DIR" size="256" summ="default" type="STRING"/>
					<colinfo id="CS607_INDIR" size="256" summ="default" type="STRING"/>
					<colinfo id="CS607_PCOST" size="256" summ="default" type="STRING"/>
					<colinfo id="CS607_RAT" size="256" summ="default" type="STRING"/>
					<colinfo id="CS607_SAMT" size="256" summ="default" type="STRING"/>
					<colinfo id="CS607_CPRC_5" size="256" summ="default" type="STRING"/>
					<colinfo id="CS607_PCOST_5" size="256" summ="default" type="STRING"/>
					<colinfo id="CS607_RAT_5" size="256" summ="default" type="STRING"/>
					<colinfo id="CS607_CART_5" size="256" summ="default" type="STRING"/>
					<colinfo id="CS607_MPRC" size="256" summ="default" type="STRING"/>
					<record>
						<CS607_CART_5></CS607_CART_5>
						<CS607_CPRC_5></CS607_CPRC_5>
						<CS607_DIR></CS607_DIR>
						<CS607_IAMT></CS607_IAMT>
						<CS607_INDIR></CS607_INDIR>
						<CS607_JAMT></CS607_JAMT>
						<CS607_LAB_B></CS607_LAB_B>
						<CS607_LAB_J></CS607_LAB_J>
						<CS607_LAB_N></CS607_LAB_N>
						<CS607_MPRC></CS607_MPRC>
						<CS607_PCOST></CS607_PCOST>
						<CS607_PCOST_5></CS607_PCOST_5>
						<CS607_RAT></CS607_RAT>
						<CS607_RAT_5></CS607_RAT_5>
						<CS607_SAMT></CS607_SAMT>
						<CS607_SEQ></CS607_SEQ>
						<CS607_TYP></CS607_TYP>
						<CS607_TYPNM></CS607_TYPNM>
						<CS607_YEAR></CS607_YEAR>
					</record>
					<record>
						<CS607_CART_5></CS607_CART_5>
						<CS607_CPRC_5></CS607_CPRC_5>
						<CS607_DIR></CS607_DIR>
						<CS607_IAMT></CS607_IAMT>
						<CS607_INDIR></CS607_INDIR>
						<CS607_JAMT></CS607_JAMT>
						<CS607_LAB_B></CS607_LAB_B>
						<CS607_LAB_J></CS607_LAB_J>
						<CS607_LAB_N></CS607_LAB_N>
						<CS607_MPRC></CS607_MPRC>
						<CS607_PCOST></CS607_PCOST>
						<CS607_PCOST_5></CS607_PCOST_5>
						<CS607_RAT></CS607_RAT>
						<CS607_RAT_5></CS607_RAT_5>
						<CS607_SAMT></CS607_SAMT>
						<CS607_SEQ></CS607_SEQ>
						<CS607_TYP></CS607_TYP>
						<CS607_TYPNM></CS607_TYPNM>
						<CS607_YEAR></CS607_YEAR>
					</record>
					<record>
						<CS607_CART_5></CS607_CART_5>
						<CS607_CPRC_5></CS607_CPRC_5>
						<CS607_DIR></CS607_DIR>
						<CS607_IAMT></CS607_IAMT>
						<CS607_INDIR></CS607_INDIR>
						<CS607_JAMT></CS607_JAMT>
						<CS607_LAB_B></CS607_LAB_B>
						<CS607_LAB_J></CS607_LAB_J>
						<CS607_LAB_N></CS607_LAB_N>
						<CS607_MPRC></CS607_MPRC>
						<CS607_PCOST></CS607_PCOST>
						<CS607_PCOST_5></CS607_PCOST_5>
						<CS607_RAT></CS607_RAT>
						<CS607_RAT_5></CS607_RAT_5>
						<CS607_SAMT></CS607_SAMT>
						<CS607_SEQ></CS607_SEQ>
						<CS607_TYP></CS607_TYP>
						<CS607_TYPNM></CS607_TYPNM>
						<CS607_YEAR></CS607_YEAR>
					</record>
					<record>
						<CS607_CART_5></CS607_CART_5>
						<CS607_CPRC_5></CS607_CPRC_5>
						<CS607_DIR></CS607_DIR>
						<CS607_IAMT></CS607_IAMT>
						<CS607_INDIR></CS607_INDIR>
						<CS607_JAMT></CS607_JAMT>
						<CS607_LAB_B></CS607_LAB_B>
						<CS607_LAB_J></CS607_LAB_J>
						<CS607_LAB_N></CS607_LAB_N>
						<CS607_MPRC></CS607_MPRC>
						<CS607_PCOST></CS607_PCOST>
						<CS607_PCOST_5></CS607_PCOST_5>
						<CS607_RAT></CS607_RAT>
						<CS607_RAT_5></CS607_RAT_5>
						<CS607_SAMT></CS607_SAMT>
						<CS607_SEQ></CS607_SEQ>
						<CS607_TYP></CS607_TYP>
						<CS607_TYPNM></CS607_TYPNM>
						<CS607_YEAR></CS607_YEAR>
					</record>
					<record>
						<CS607_CART_5></CS607_CART_5>
						<CS607_CPRC_5></CS607_CPRC_5>
						<CS607_DIR></CS607_DIR>
						<CS607_IAMT></CS607_IAMT>
						<CS607_INDIR></CS607_INDIR>
						<CS607_JAMT></CS607_JAMT>
						<CS607_LAB_B></CS607_LAB_B>
						<CS607_LAB_J></CS607_LAB_J>
						<CS607_LAB_N></CS607_LAB_N>
						<CS607_MPRC></CS607_MPRC>
						<CS607_PCOST></CS607_PCOST>
						<CS607_PCOST_5></CS607_PCOST_5>
						<CS607_RAT></CS607_RAT>
						<CS607_RAT_5></CS607_RAT_5>
						<CS607_SAMT></CS607_SAMT>
						<CS607_SEQ></CS607_SEQ>
						<CS607_TYP></CS607_TYP>
						<CS607_TYPNM></CS607_TYPNM>
						<CS607_YEAR></CS607_YEAR>
					</record>
					<record>
						<CS607_CART_5></CS607_CART_5>
						<CS607_CPRC_5></CS607_CPRC_5>
						<CS607_DIR></CS607_DIR>
						<CS607_IAMT></CS607_IAMT>
						<CS607_INDIR></CS607_INDIR>
						<CS607_JAMT></CS607_JAMT>
						<CS607_LAB_B></CS607_LAB_B>
						<CS607_LAB_J></CS607_LAB_J>
						<CS607_LAB_N></CS607_LAB_N>
						<CS607_MPRC></CS607_MPRC>
						<CS607_PCOST></CS607_PCOST>
						<CS607_PCOST_5></CS607_PCOST_5>
						<CS607_RAT></CS607_RAT>
						<CS607_RAT_5></CS607_RAT_5>
						<CS607_SAMT></CS607_SAMT>
						<CS607_SEQ></CS607_SEQ>
						<CS607_TYP></CS607_TYP>
						<CS607_TYPNM></CS607_TYPNM>
						<CS607_YEAR></CS607_YEAR>
					</record>
					<record>
						<CS607_CART_5></CS607_CART_5>
						<CS607_CPRC_5></CS607_CPRC_5>
						<CS607_DIR></CS607_DIR>
						<CS607_IAMT></CS607_IAMT>
						<CS607_INDIR></CS607_INDIR>
						<CS607_JAMT></CS607_JAMT>
						<CS607_LAB_B></CS607_LAB_B>
						<CS607_LAB_J></CS607_LAB_J>
						<CS607_LAB_N></CS607_LAB_N>
						<CS607_MPRC></CS607_MPRC>
						<CS607_PCOST></CS607_PCOST>
						<CS607_PCOST_5></CS607_PCOST_5>
						<CS607_RAT></CS607_RAT>
						<CS607_RAT_5></CS607_RAT_5>
						<CS607_SAMT></CS607_SAMT>
						<CS607_SEQ></CS607_SEQ>
						<CS607_TYP></CS607_TYP>
						<CS607_TYPNM></CS607_TYPNM>
						<CS607_YEAR></CS607_YEAR>
					</record>
					<record>
						<CS607_CART_5></CS607_CART_5>
						<CS607_CPRC_5></CS607_CPRC_5>
						<CS607_DIR></CS607_DIR>
						<CS607_IAMT></CS607_IAMT>
						<CS607_INDIR></CS607_INDIR>
						<CS607_JAMT></CS607_JAMT>
						<CS607_LAB_B></CS607_LAB_B>
						<CS607_LAB_J></CS607_LAB_J>
						<CS607_LAB_N></CS607_LAB_N>
						<CS607_MPRC></CS607_MPRC>
						<CS607_PCOST></CS607_PCOST>
						<CS607_PCOST_5></CS607_PCOST_5>
						<CS607_RAT></CS607_RAT>
						<CS607_RAT_5></CS607_RAT_5>
						<CS607_SAMT></CS607_SAMT>
						<CS607_SEQ></CS607_SEQ>
						<CS607_TYP></CS607_TYP>
						<CS607_TYPNM></CS607_TYPNM>
						<CS607_YEAR></CS607_YEAR>
					</record>
					<record>
						<CS607_CART_5></CS607_CART_5>
						<CS607_CPRC_5></CS607_CPRC_5>
						<CS607_DIR></CS607_DIR>
						<CS607_IAMT></CS607_IAMT>
						<CS607_INDIR></CS607_INDIR>
						<CS607_JAMT></CS607_JAMT>
						<CS607_LAB_B></CS607_LAB_B>
						<CS607_LAB_J></CS607_LAB_J>
						<CS607_LAB_N></CS607_LAB_N>
						<CS607_MPRC></CS607_MPRC>
						<CS607_PCOST></CS607_PCOST>
						<CS607_PCOST_5></CS607_PCOST_5>
						<CS607_RAT></CS607_RAT>
						<CS607_RAT_5></CS607_RAT_5>
						<CS607_SAMT></CS607_SAMT>
						<CS607_SEQ></CS607_SEQ>
						<CS607_TYP></CS607_TYP>
						<CS607_TYPNM></CS607_TYPNM>
						<CS607_YEAR></CS607_YEAR>
					</record>
					<record>
						<CS607_CART_5></CS607_CART_5>
						<CS607_CPRC_5></CS607_CPRC_5>
						<CS607_DIR></CS607_DIR>
						<CS607_IAMT></CS607_IAMT>
						<CS607_INDIR></CS607_INDIR>
						<CS607_JAMT></CS607_JAMT>
						<CS607_LAB_B></CS607_LAB_B>
						<CS607_LAB_J></CS607_LAB_J>
						<CS607_LAB_N></CS607_LAB_N>
						<CS607_MPRC></CS607_MPRC>
						<CS607_PCOST></CS607_PCOST>
						<CS607_PCOST_5></CS607_PCOST_5>
						<CS607_RAT></CS607_RAT>
						<CS607_RAT_5></CS607_RAT_5>
						<CS607_SAMT></CS607_SAMT>
						<CS607_SEQ></CS607_SEQ>
						<CS607_TYP></CS607_TYP>
						<CS607_TYPNM></CS607_TYPNM>
						<CS607_YEAR></CS607_YEAR>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_year">
				<Contents>
					<colinfo id="ZYEAR" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cnt">
				<Contents>
					<colinfo id="C607" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_srate">
				<Contents>
					<colinfo id="CS647_YEA" size="4" summ="default" type="STRING"/>
					<colinfo id="CS647_GBN" size="1" summ="default" type="STRING"/>
					<colinfo id="CS647_FMR" size="10" summ="default" type="DECIMAL"/>
					<colinfo id="CS647_POG" size="10" summ="default" type="DECIMAL"/>
					<colinfo id="CS647_GJR" size="10" summ="default" type="DECIMAL"/>
					<colinfo id="CS647_JGL1" size="10" summ="default" type="DECIMAL"/>
					<colinfo id="CS647_JGL2" size="10" summ="default" type="DECIMAL"/>
					<colinfo id="CS647_JGL3" size="10" summ="default" type="DECIMAL"/>
					<colinfo id="CS647_NBT" size="10" summ="default" type="DECIMAL"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_mmar">
				<Contents>
					<colinfo id="CS648_YEA" size="4" summ="default" type="STRING"/>
					<colinfo id="CS648_GBN" size="1" summ="default" type="STRING"/>
					<colinfo id="BGN" size="1" summ="default" type="STRING"/>
					<colinfo id="CS648_JCD" size="3" summ="default" type="STRING"/>
					<colinfo id="AR1_GBN" size="1" summ="default" type="STRING"/>
					<colinfo id="AR1_MIN" size="10" summ="default" type="DECIMAL"/>
					<colinfo id="AR1_MAX" size="10" summ="default" type="DECIMAL"/>
					<colinfo id="AR1_PER" size="10" summ="default" type="DECIMAL"/>
					<colinfo id="AR2_GBN" size="1" summ="default" type="STRING"/>
					<colinfo id="AR2_MIN" size="10" summ="default" type="DECIMAL"/>
					<colinfo id="AR2_MAX" size="10" summ="default" type="DECIMAL"/>
					<colinfo id="AR2_PER" size="10" summ="default" type="DECIMAL"/>
					<colinfo id="AR3_GBN" size="1" summ="default" type="STRING"/>
					<colinfo id="AR3_MIN" size="10" summ="default" type="DECIMAL"/>
					<colinfo id="AR3_MAX" size="10" summ="default" type="DECIMAL"/>
					<colinfo id="AR3_PER" size="10" summ="default" type="DECIMAL"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_area">
				<Contents>
					<colinfo id="CS650_ARA" size="2" summ="default" type="STRING"/>
					<colinfo id="CS650_ARA_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="CS650_YEA" size="4" summ="default" type="STRING"/>
					<colinfo id="CS650_ARAG" size="3" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_area_grp">
				<Contents>
					<colinfo id="CS651_YEA" size="4" summ="default" type="STRING"/>
					<colinfo id="CS651_ARAG" size="3" summ="default" type="STRING"/>
					<colinfo id="CS651_GBN" size="1" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_grp_type">
				<Contents>
					<colinfo id="type_cd" size="1" summ="default" type="STRING"/>
					<colinfo id="type_nm" size="10" summ="default" type="STRING"/>
					<record>
						<type_cd>A</type_cd>
						<type_nm>주차방식&#32;전체</type_nm>
					</record>
					<record>
						<type_cd>D</type_cd>
						<type_nm>주차방식별&#32;분리</type_nm>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_type_gbn">
				<Contents>
					<colinfo id="TYPE_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="TYPE_NM" size="256" summ="default" type="STRING"/>
					<record>
						<TYPE_CD>AET</TYPE_CD>
						<TYPE_NM>승강기방식</TYPE_NM>
					</record>
					<record>
						<TYPE_CD>ACT</TYPE_CD>
						<TYPE_NM>평면왕복식</TYPE_NM>
					</record>
					<record>
						<TYPE_CD>AAN</TYPE_CD>
						<TYPE_NM>다층순환식</TYPE_NM>
					</record>
					<record>
						<TYPE_CD>ALL</TYPE_CD>
						<TYPE_NM>ALL</TYPE_NM>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_area_type">
				<Contents>
					<colinfo id="grp_cd" size="2" summ="default" type="STRING"/>
					<colinfo id="grp_nm" size="256" summ="default" type="STRING"/>
					<record>
						<grp_cd>AR1</grp_cd>
						<grp_nm>수도권</grp_nm>
					</record>
					<record>
						<grp_cd>AR2</grp_cd>
						<grp_nm>지방&#32;현장수&#32;10개이하</grp_nm>
					</record>
					<record>
						<grp_cd>AR3</grp_cd>
						<grp_nm>지방&#32;현장수&#32;10개초과</grp_nm>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_mmar_input">
				<Contents>
					<colinfo id="CS648_YEA" size="4" summ="default" type="STRING"/>
					<colinfo id="CS648_GBN" size="1" summ="default" type="STRING"/>
					<colinfo id="CS648_BGN" size="1" summ="default" type="STRING"/>
					<colinfo id="CS648_JCD" size="3" summ="default" type="STRING"/>
					<colinfo id="CS648_LGC" size="3" summ="default" type="STRING"/>
					<colinfo id="CS648_MIN" size="10" summ="default" type="DECIMAL"/>
					<colinfo id="CS648_MAX" size="10" summ="default" type="DECIMAL"/>
					<colinfo id="CS648_PER" size="10" summ="default" type="DECIMAL"/>
				</Contents>
			</Dataset>
		</Datasets>
		<Shape BKColor="user0" Bottom="30" Height="30" Id="Shape0" Left="0" LineColor="user1" Right="978" TabOrder="1" Top="0" Type="Rectangle" Width="978"></Shape>
		<Static Align="Right" Height="20" Id="st_dat" Left="9" Style="sty_lb_search" TabOrder="2" Text="기준&#32;년" Top="5" VAlign="Middle" Width="80"></Static>
		<Combo Border="Flat" CodeColumn="ZYEAR" DataColumn="ZYEAR" DisableBKColor="user5" Height="20" Id="cb_year" InnerDataset="ds_year" Left="90" OnChanged="cb_year_OnChanged" Style="sty_ipt_search" TabOrder="3" Top="4" Width="75"></Combo>
		<Tab Border="Flat" Font="굴림,9" Height="496" Id="tab_main" Left="12" MouseOverColor="user16" SelColor="user15" SelectFont="굴림,9" Style="sty_tab" TabOrder="4" Top="40" Width="954">
			<Contents>
				<TabPage BorderColor="black" Height="470" Id="tab1" ImageID="tab_form_09" Left="2" TabOrder="1" Text="시행율&#32;변수&#32;관리" Top="24" Width="950">
					<Static Align="Center" Border="Flat" BorderColor="user20" Height="41" Id="Static24" Left="16" Style="sty_lb_form_basic" TabOrder="1" Text="외주용역비" Top="36" VAlign="Middle" Width="95"></Static>
					<Static Border="Flat" BorderColor="user13" Height="41" Id="Static0" Left="738" TabOrder="2" Top="36" Width="172"></Static>
					<Grid AutoEnter="TRUE" AutoFitEndLine="Hide" AutoScrollBar="None" BindDataset="ds_srate" BkColor2="default" BoldHead="true" Border="Flat" Bottom="77" CellMoving="TRUE" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" FixedColSizing="TRUE" HeadBorder="Flat" HeadHeight="20" Height="41" Id="grd_tar" InputPanel="FALSE" Left="110" LineColor="user20" LineType="ExHORZ" Right="270" RowHeight="20" Style="sty_grid" TabOrder="3" TabStop="true" Top="36" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="160">
						<contents>
							<format id="Default">
								<columns>
									<col width="80"/>
									<col width="81"/>
								</columns>
								<head>
									<cell col="0" display="text" font="굴림,9" text="FM"/>
									<cell col="1" display="text" font="굴림,9" text="POG"/>
								</head>
								<body>
									<cell align="right" bkcolor2="user22" col="0" colid="CS647_FMR" combodisplayrowcnt="1" display="number" edit="number" limit="5" Mask="#0.##"/>
									<cell align="right" bkcolor2="user22" col="1" colid="CS647_POG" display="number" edit="number" limit="5" Mask="#0.##"/>
								</body>
							</format>
						</contents>
					</Grid>
					<Static Align="Center" Border="Flat" BorderColor="user20" Height="41" Id="Static1" Left="269" Style="sty_lb_form_basic" TabOrder="4" Text="출장비" Top="36" VAlign="Middle" Width="95"></Static>
					<Grid AutoEnter="TRUE" AutoFitEndLine="Hide" AutoScrollBar="None" BindDataset="ds_srate" BkColor2="default" BoldHead="true" Border="Flat" Bottom="77" CellMoving="TRUE" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="41" Id="grd_iex" InputPanel="FALSE" Left="363" LineColor="user20" LineType="ExHORZ" Right="645" RowHeight="20" Style="sty_grid" TabOrder="5" TabStop="true" Top="36" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="282">
						<contents>
							<format id="Default">
								<columns>
									<col width="101"/>
									<col width="90"/>
									<col width="90"/>
								</columns>
								<head>
									<cell col="0" display="text" font="굴림,9" text="서울/경기/인천"/>
									<cell col="1" display="text" font="굴림,9" text="제주"/>
									<cell col="2" display="text" font="굴림,9" text="그&#32;외&#32;지역"/>
								</head>
								<body>
									<cell align="right" bkcolor2="user22" col="0" colid="CS647_JGL1" display="currency" edit="number" limit="9" Mask="#,###,###"/>
									<cell align="right" bkcolor2="user22" col="1" colid="CS647_JGL2" display="currency" edit="number" limit="9" Mask="#,###,###"/>
									<cell align="right" bkcolor2="user22" col="2" colid="CS647_JGL3" display="currency" edit="number" limit="9" Mask="#,###,###"/>
								</body>
							</format>
						</contents>
					</Grid>
					<Static Align="Center" Border="Flat" BorderColor="user20" Height="41" Id="Static2" Left="644" Style="sty_lb_form_basic" TabOrder="6" Text="간접비" Top="36" VAlign="Middle" Width="95"></Static>
					<Static Align="Center" Height="15" Id="Static3" Left="746" TabOrder="7" Text="직접비&#32;*&#32;" Top="51" Width="50"></Static>
					<MaskEdit BindDataset="ds_srate" Border="Flat" Column="CS647_GJR" DigitLen="3" Height="26" Id="edt_gjr" Left="803" Mask="#0.##" MaxLength="5" NullValue="0" ShadowColor="user12" Style="sty_ipt_form" TabOrder="8" Top="43" Width="47"></MaskEdit>
					<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_cs647_save" ImageID="btn_sub_07" Left="801" LeftMargin="12" OnClick="tab_main_tab1_btn_cs647_save_OnClick" Style="sty_btn" TabOrder="9" Text="시행율&#32;변수저장" Top="8" Transparent="TRUE" Width="108"></Button>
					<Static Border="Flat" BorderColor="user13" Height="388" Id="Static9" Left="16" TabOrder="10" Top="80" Width="894"></Static>
					<Tab Border="Flat" Font="굴림,9" Height="356" Id="tab_main" Left="19" MouseOverColor="user16" OnChanged="tab_main_tab1_tab_main_OnChanged" SelColor="user15" SelectFont="굴림,9" Style="sty_tab" TabOrder="11" Top="108" Width="888">
						<Contents>
							<TabPage BorderColor="black" Height="330" Id="tab1" ImageID="tab_form_09" Left="2" TabOrder="1" Text="그룹&#32;설정" Top="24" Width="884">
								<Static Border="None" Color="user6" Font="굴림,9" Height="20" Id="st_local" Left="18" TabOrder="1" Text="그룹별&#32;지역&#32;매핑" Top="17" VAlign="Middle" Width="151"></Static>
								<Grid AutoEnter="TRUE" AutoFitEndLine="Hide" AutoScrollBar="Vert" BindDataset="ds_area" BkColor2="default" BoldHead="true" Border="Flat" Bottom="328" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" FixedColSizing="TRUE" HeadBorder="Flat" HeadHeight="20" Height="288" Id="grd_area" InputPanel="FALSE" Left="17" LineColor="user20" LineType="ExHORZ" Right="348" RowHeight="20" Style="sty_grid" TabOrder="2" TabStop="true" Top="40" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="331">
									<contents>
										<format id="Default">
											<columns>
												<col width="110"/>
												<col width="221"/>
											</columns>
											<head>
												<cell autosizing="none" col="0" display="text" font="굴림,9" text="지역"/>
												<cell autosizing="none" col="1" display="text" font="굴림,9" text="그룹"/>
											</head>
											<body>
												<cell align="center" bkcolor2="user22" col="0" colid="CS650_ARA_NM" combodisplayrowcnt="1" display="text"/>
												<cell align="center" bkcolor="lightcyan" col="1" colid="CS650_ARAG" combocol="grp_cd" combodataset="ds_area_type" comboseltext="===선택===" combotext="grp_nm" display="combo" edit="combo"/>
											</body>
										</format>
									</contents>
								</Grid>
								<Static Border="None" Color="user6" Font="굴림,9" Height="20" Id="Static0" Left="466" TabOrder="3" Text="그룹별&#32;방식타입&#32;매핑" Top="17" VAlign="Middle" Width="151"></Static>
								<Static Border="None" Color="user7" Font="굴림,9" Height="16" Id="Static1" Left="465" TabOrder="4" Text="※&#32;방식타입&#32;:&#32;주차방식전체(대수지정만함)" Top="124" Width="392"></Static>
								<Grid AutoEnter="TRUE" AutoFit="TRUE" AutoFitEndLine="Hide" AutoScrollBar="Vert" BindDataset="ds_area_grp" BkColor2="default" BoldHead="true" Border="Flat" Bottom="121" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" FixedColSizing="TRUE" HeadBorder="Flat" HeadHeight="20" Height="81" Id="grd_area_grp" InputPanel="FALSE" Left="465" LineColor="user20" LineType="ExHORZ" MinWidth="100" Right="769" RowHeight="20" Style="sty_grid" TabOrder="5" TabStop="true" Top="40" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="304">
									<contents>
										<format id="Default">
											<columns>
												<col width="180"/>
												<col width="121"/>
											</columns>
											<head>
												<cell col="0" display="text" font="굴림,9" text="그룹명"/>
												<cell col="1" display="text" font="굴림,9" text="방식타입"/>
											</head>
											<body>
												<cell align="center" bkcolor2="user22" col="0" colid="CS651_ARAG" combocol="grp_cd" combodataset="ds_area_type" combodisplayrowcnt="1" combotext="grp_nm" display="combo"/>
												<cell align="center" bkcolor="lightcyan" col="1" colid="CS651_GBN" combocol="type_cd" combodataset="ds_grp_type" comboseltext="===선택===" combotext="type_nm" display="combo" edit="combo"/>
											</body>
										</format>
									</contents>
								</Grid>
								<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_cs650_save" ImageID="btn_sub_06" Left="785" LeftMargin="12" OnClick="tab_main_tab1_tab_main_tab1_btn_cs650_save_OnClick" Style="sty_btn" TabOrder="6" Text="그룹세팅저장" Top="4" Transparent="TRUE" Width="96"></Button>
								<Static Border="None" Color="user7" Font="굴림,9" Height="16" Id="Static2" Left="465" TabOrder="7" Text="&#32;&#32;&#32;&#32;주차방식별분리(승강기방식,평면왕복식,다층순환식별&#32;대수지정함)" Top="140" Width="392"></Static>
							</TabPage>
							<TabPage BorderColor="black" Height="330" Id="tab3" ImageID="tab_form_09" Left="2" TabOrder="2" Text="보수노무비&#32;설정" Top="24" Width="884">
								<Grid AutoEnter="TRUE" AutoFitEndLine="Hide" AutoScrollBar="Vert" BindDataset="ds_mmar" BkColor2="default" BoldHead="true" Border="Flat" Bottom="320" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" FixedColSizing="TRUE" HeadBorder="Flat" HeadHeight="20" Height="292" Id="grd_mmar" InputPanel="FALSE" Left="9" LineColor="user20" LineType="ExHORZ" Right="873" RowHeight="20" Style="sty_grid" TabOrder="1" TabStop="true" Top="28" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="864">
									<contents>
										<format id="Default">
											<columns>
												<col width="186"/>
												<col width="75"/>
												<col width="75"/>
												<col width="75"/>
												<col width="75"/>
												<col width="75"/>
												<col width="75"/>
												<col width="75"/>
												<col width="75"/>
												<col width="75"/>
												<col width="0"/>
											</columns>
											<head>
												<cell col="0" display="text" font="굴림,9" rowspan="2" text="방식&#32;종류"/>
												<cell col="1" colspan="3" display="text" font="굴림,9" text="수도권"/>
												<cell col="4" colspan="3" display="text" font="굴림,9" text="지방&#32;현장수&#32;10개이하"/>
												<cell col="7" colspan="3" display="text" font="굴림,9" text="지방&#32;현장수&#32;10개초과"/>
												<cell col="10" display="text" rowspan="2"/>
												<cell autosizing="none" col="1" display="text" font="굴림,9" row="1" text="최소"/>
												<cell autosizing="none" col="2" display="text" font="굴림,9" row="1" text="최대"/>
												<cell autosizing="none" col="3" display="text" font="굴림,9" row="1" text="비율"/>
												<cell autosizing="none" col="4" display="text" font="굴림,9" row="1" text="최소"/>
												<cell autosizing="none" col="5" display="text" font="굴림,9" row="1" text="최대"/>
												<cell autosizing="none" col="6" display="text" font="굴림,9" row="1" text="비율"/>
												<cell autosizing="none" col="7" display="text" font="굴림,9" row="1" text="최소"/>
												<cell autosizing="none" col="8" display="text" font="굴림,9" row="1" text="최대"/>
												<cell autosizing="none" col="9" display="text" font="굴림,9" row="1" text="비율"/>
											</head>
											<body>
												<cell align="center" bkcolor2="user22" col="0" colid="CS648_JCD" combocol="TYPE_CD" combodataset="ds_type_gbn" combodisplayrowcnt="1" combotext="TYPE_NM" display="combo" suppress="2" SuppressAlign="Middle" Valign="Center"/>
												<cell align="center" bkcolor="expr:iif(BGN==AR1_GBN,&#32;&apos;defualt&apos;,&#32;&apos;lightgrey&apos;)" col="1" colid="AR1_MIN" display="number" edit="expr:iif(BGN==AR1_GBN,&#32;&apos;integer&apos;,&#32;&apos;none&apos;)"/>
												<cell align="center" bkcolor="expr:iif(BGN==AR1_GBN,&#32;&apos;defualt&apos;,&#32;&apos;lightgrey&apos;)" col="2" colid="AR1_MAX" display="number" edit="expr:iif(BGN==AR1_GBN,&#32;&apos;integer&apos;,&#32;&apos;none&apos;)"/>
												<cell align="right" bkcolor="expr:iif(BGN==AR1_GBN,&#32;&apos;defualt&apos;,&#32;&apos;lightgrey&apos;)" col="3" colid="AR1_PER" display="number" edit="expr:iif(BGN==AR1_GBN,&#32;&apos;number&apos;,&#32;&apos;none&apos;)" Mask="##0.#"/>
												<cell align="center" bkcolor="expr:iif(BGN==AR2_GBN,&#32;&apos;defualt&apos;,&#32;&apos;lightgrey&apos;)" col="4" colid="AR2_MIN" display="number" edit="expr:iif(BGN==AR2_GBN,&#32;&apos;integer&apos;,&#32;&apos;none&apos;)"/>
												<cell align="center" bkcolor="expr:iif(BGN==AR2_GBN,&#32;&apos;defualt&apos;,&#32;&apos;lightgrey&apos;)" col="5" colid="AR2_MAX" display="number" edit="expr:iif(BGN==AR2_GBN,&#32;&apos;integer&apos;,&#32;&apos;none&apos;)"/>
												<cell align="right" bkcolor="expr:iif(BGN==AR2_GBN,&#32;&apos;defualt&apos;,&#32;&apos;lightgrey&apos;)" col="6" colid="AR2_PER" display="number" edit="expr:iif(BGN==AR2_GBN,&#32;&apos;number&apos;,&#32;&apos;none&apos;)" Mask="##0.#"/>
												<cell align="center" bkcolor="expr:iif(BGN==AR3_GBN,&#32;&apos;defualt&apos;,&#32;&apos;lightgrey&apos;)" col="7" colid="AR3_MIN" display="number" edit="expr:iif(BGN==AR3_GBN,&#32;&apos;integer&apos;,&#32;&apos;none&apos;)"/>
												<cell align="center" bkcolor="expr:iif(BGN==AR3_GBN,&#32;&apos;defualt&apos;,&#32;&apos;lightgrey&apos;)" col="8" colid="AR3_MAX" display="number" edit="expr:iif(BGN==AR3_GBN,&#32;&apos;integer&apos;,&#32;&apos;none&apos;)"/>
												<cell align="right" bkcolor="expr:iif(BGN==AR3_GBN,&#32;&apos;defualt&apos;,&#32;&apos;lightgrey&apos;)" col="9" colid="AR3_PER" display="number" edit="expr:iif(BGN==AR3_GBN,&#32;&apos;number&apos;,&#32;&apos;none&apos;)" Mask="##0.#"/>
												<cell align="center" bkcolor2="user22" col="10" colid="CS648_JCD" combocol="TYPE_CD" combodataset="ds_type_gbn" combodisplayrowcnt="1" combotext="TYPE_NM" display="combo"/>
											</body>
										</format>
									</contents>
								</Grid>
								<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_cs648_save" ImageID="btn_sub_09" Left="741" LeftMargin="12" OnClick="tab_main_tab1_tab_main_tab3_btn_cs648_save_OnClick" Style="sty_btn" TabOrder="2" Text="보수노무비설정저장" Top="4" Transparent="TRUE" Width="136"></Button>
							</TabPage>
						</Contents>
					</Tab>
					<Static Align="Center" Border="Flat" BorderColor="user20" Height="26" Id="Static4" Left="16" Style="sty_lb_form_basic" TabOrder="12" Text="보수노무비" Top="80" VAlign="Middle" Width="95"></Static>
					<Static Border="Flat" BorderColor="user13" Height="26" Id="Static8" Left="110" TabOrder="13" Top="80" Width="160"></Static>
					<MaskEdit BindDataset="ds_srate" Border="Flat" Column="CS647_NBT" Height="20" Id="edt_man_amt" Left="113" Mask="###,###,##0" MaxLength="9" NullValue="0" ShadowColor="user12" Style="sty_ipt_form" TabOrder="14" Top="83" Width="153"></MaskEdit>
				</TabPage>
				<TabPage BorderColor="black" Height="470" Id="tab2" ImageID="tab_form_09" Left="2" TabOrder="2" Text="기준금액&#32;관리&#32;" Top="24" Width="950">
					<Shape BKColor="user12" Bottom="63" Height="26" Id="Shape4" Left="95" LineColor="user13" Right="327" TabOrder="3" Top="37" Type="Rectangle" Width="232"></Shape>
					<Combo Border="Flat" CodeColumn="CODE2" DataColumn="CTEXT2" DisableBKColor="user5" Height="20" Id="cb_type" InnerDataset="ds_type" Left="109" OnChanged="cb_type_OnChanged" Style="sty_ipt_form" TabOrder="4" Top="39" Width="211"></Combo>
					<Shape BKColor="user12" Bottom="63" Height="26" Id="Shape2" Left="7" LineColor="user13" Right="104" TabOrder="1" Top="37" Type="Rectangle" Width="97"></Shape>
					<Static Align="Center" Height="24" Id="Static6" Left="8" Style="sty_lb_form_basic" TabOrder="2" Text="주차방식" Top="38" VAlign="Middle" Width="95"></Static>
					<Grid AutoEnter="TRUE" AutoFitEndLine="Hide" BindDataset="ds_data" BkColor2="default" BoldHead="true" Border="Flat" Bottom="464" CellMoving="TRUE" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="452" Id="grd_data" InputPanel="FALSE" Left="334" LineColor="user20" LineType="ExHORZ" OnHeadClick="grd_list_OnHeadClick" Right="891" RowHeight="20" Style="sty_grid" TabOrder="5" TabStop="true" Top="12" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="557">
						<contents>
							<format id="Default">
								<columns>
									<col width="76"/>
									<col width="160"/>
									<col width="160"/>
									<col width="160"/>
								</columns>
								<head>
									<cell col="0" display="text" font="굴림,9" text="연차"/>
									<cell col="1" display="text" font="굴림,9" text="자재비"/>
									<cell col="2" display="text" font="굴림,9" text="정기검사비"/>
									<cell col="3" display="text" font="굴림,9" text="수주단가"/>
								</head>
								<body>
									<cell align="center" bkcolor2="user22" col="0" colid="CS607_SEQ" display="text"/>
									<cell align="right" bkcolor2="user22" col="1" colid="CS607_JAMT" display="currency" edit="number"/>
									<cell align="right" bkcolor2="user22" col="2" colid="CS607_IAMT" display="currency" edit="number"/>
									<cell align="right" col="3" colid="CS607_CART_5" display="currency" edit="number"/>
								</body>
							</format>
						</contents>
					</Grid>
					<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_save" ImageID="btn_sub_10" Left="185" LeftMargin="12" OnClick="fn_save" Style="sty_btn" TabOrder="6" Text="방식별&#32;기준금액&#32;저장" Top="12" Transparent="TRUE" Width="148"></Button>
				</TabPage>
			</Contents>
		</Tab>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_copy" ImageID="btn_sub_05" Left="882" LeftMargin="12" OnClick="btn_copy_OnClick" Style="sty_btn" TabOrder="5" Text="Copy&#32;Tool" Top="38" Transparent="TRUE" Width="83"></Button>
	</Form>
	<Script><![CDATA[﻿﻿﻿﻿﻿﻿﻿/*
 ******************************************************************************************
 * 기      능   : 
 * 작  성  자   : 
 * 작성  일자   : 
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
#include "LIB::commons.js";	// 공통 스크립트 
//=========================================================================================
// [ PART 1 ]
// Form에서 사용될 전역변수를 선언
// FORM에서 사용되는 전역변수는 대문자로 작성하며, F_XXX 의 형태를 갖도록 한다. 
//=========================================================================================

//=========================================================================================
// [ PART 2 ]
// Form Loading / Unloading 시 작업 정의
//=========================================================================================
function fn_OnLoadCompleted(obj) {
	gfn_initForm();
	
	//기준 년 콤보 초기화
	ufn_initYearCombo();
	
	//기준 타입 콤보 초기화
	ufn_initTypeCombo();
}
/********************************************************************************
* 기      능   : 공통코드가 조회된 후의 Callback 함수 
********************************************************************************/
function fn_completeInit(sCode, sDsObj, sCodeType) {

}
/********************************************************************************
* 기      능   : form UnloadCompleted 
********************************************************************************/
function fn_OnUnloadCompleted(obj) {
	return gfn_isFormUnload(obj);
}
//=========================================================================================
// [ PART 3 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,form닫기)
//=========================================================================================
/********************************************************************************
* 기      능   : 조회 1
********************************************************************************/
function fn_query() {

}
/********************************************************************************
* 기      능   : 삽입 20
********************************************************************************/
function fn_insert() {

}
/********************************************************************************
* 기      능   : Delete 
********************************************************************************/
function fn_delete() {

}
/********************************************************************************
* 기      능   : 저장 
********************************************************************************/
function fn_save() {
	//선택 연도를 조회한다.
	
	var strYear = cb_year.Value;
	if(cb_year.Index == 0)
	{
		gfn_showAlert("연도를 선택해주세요.");
		return;
	}
	
	ds_cond.SetColumn(0, "ZYEAR", strYear);	

	//선택 연도를 조회한다.
	
	var strType = tab_main.tab2.cb_type.Value;
	if(tab_main.tab2.cb_type.Index == 0)
	{
		gfn_showAlert("방식을 선택해주세요.");
		return;
	}
	
	ds_cond.SetColumn(0, "TYPE", strType);		

	/* Start Of Input Validation Routines -------------------------------------------------------------------------------------- */
	
	//준비작업
	tit_clearActionInfo();

	//ZCST607 : S04 : 주차시행율
	if(!ufn_checkDataSetStatus(ds_data))
	{
		gfn_showAlert("CW10025","시행율 항목 중 누락된 항목이 존재합니다. \n확인 후 다시 시도하시기 바랍니다.");
		tab_main.tab2.grd_data.SetFocus();
		return;
	}

	tit_addMultiActionInfo("cs96:CS9613003A_D1");
	tit_addMultiActionInfo("cs96:CS9613003A_I1");	

	/* End Of Input Validation Routines ---------------------------------------------------------------------------------------- */
		
	if(!gfn_showConfirm("CI00008", "저장확인"))
	{
		tit_clearActionInfo();
		return;
	}	
	
	tit_callService(
		""
		, ""
		, "ds_cond=ds_cond ds_data=ds_data"
		, ""
		, ""
		, "fn_afterSave");
	
}

function tab_main_tab1_btn_cs647_save_OnClick(obj)
{
	//선택 연도를 조회한다.
	var strYear = cb_year.Value;
	if(cb_year.Index == 0)
	{
		gfn_showAlert("연도를 선택해주세요.");
		return;
	}	
	ds_cond.SetColumn(0, "ZYEAR", strYear);	
	
	/* Start Of Input Validation Routines -------------------------------------------------------------------------------------- */
	//준비작업
	tit_clearActionInfo();
	
	//ZCST647 : S05 : 시행율 변수들
	if(ds_srate.GetRowType(0)!="update")
	{
		gfn_showAlert("CW10025","시행율 변수설정 항목에서 변경된 내용이 없습니다. ");
		return;
	}

	//삭제후 입력
	tit_addMultiActionInfo("cs96:CS9613003A_D2");
	tit_addMultiActionInfo("cs96:CS9613003A_I2");	

	/* End Of Input Validation Routines ---------------------------------------------------------------------------------------- */
		
	if(!gfn_showConfirm("CI00008", "저장확인"))
	{
		tit_clearActionInfo();
		return;
	}	
	
	tit_callService(
		""
		, ""
		, "ds_cond=ds_cond ds_srate=ds_srate"
		, ""
		, ""
		, "fn_afterSave");
	
}

function tab_main_tab1_tab_main_tab1_btn_cs650_save_OnClick(obj)
{
	//선택 연도를 조회한다.
	var strYear = cb_year.Value;
	if(cb_year.Index == 0)
	{
		gfn_showAlert("연도를 선택해주세요.");
		return;
	}	
	ds_cond.SetColumn(0, "ZYEAR", strYear);	
	
	/* Start Of Input Validation Routines -------------------------------------------------------------------------------------- */
	//준비작업
	tit_clearActionInfo();
	
	//ZCST650 : S06 : 지역별 지역그룹매핑
	var dsAreaRowType="0";
	for(i=0;i<ds_area.GetRowCount();i++) {
		if(ds_area.GetRowType(i)=="update") 
			dsAreaRowType="1";
	}
	//ZCST651 : S07 : 지역그룹별 주차방식 매핑
	var dsAreaGrpRowType="0";
	for(i=0;i<ds_area_grp.GetRowCount();i++) {
		if(ds_area_grp.GetRowType(i)=="update") 
			dsAreaGrpRowType="1";
	}

	if((dsAreaRowType=="0")&&(dsAreaGrpRowType="0"))
	{
		gfn_showAlert("CI30001","그룹세팅 항목에서 변경된 내용이 없습니다. ");
		return;
	}

	//삭제후 입력
	tit_addMultiActionInfo("cs96:CS9613003A_D3");
	tit_addMultiActionInfo("cs96:CS9613003A_D4");
	tit_addMultiActionInfo("cs96:CS9613003A_I3");	
	tit_addMultiActionInfo("cs96:CS9613003A_I4");	

	/* End Of Input Validation Routines ---------------------------------------------------------------------------------------- */
		
	if(!gfn_showConfirm("CI00008", "저장확인"))
	{
		tit_clearActionInfo();
		return;
	}	
	
	tit_callService(
		""
		, ""
		, "ds_cond=ds_cond ds_area=ds_area ds_area_grp=ds_area_grp"
		, ""
		, ""
		, "fn_afterSave");
}

function tab_main_tab1_tab_main_tab3_btn_cs648_save_OnClick(obj)
{
	//선택 연도를 조회한다.
	var strYear = cb_year.Value;
	if(cb_year.Index == 0)
	{
		gfn_showAlert("연도를 선택해주세요.");
		return;
	}	
	ds_cond.SetColumn(0, "ZYEAR", strYear);	
	
	/* Start Of Input Validation Routines -------------------------------------------------------------------------------------- */
	//준비작업
	tit_clearActionInfo();

	//ZCST648 : S08 : 연도- 지역그룹 - 주차방식별 대수,비율지정
	var dsMmarRowType="0";
	for(i=0;i<ds_mmar.GetRowCount();i++) {
		if(ds_mmar.GetRowType(i)=="update") 
			dsMmarRowType="1";
	}
	
	if((dsMmarRowType=="0"))
	{
		gfn_showAlert("CI30001","보수노무비 설정에서 변경된 내용이 없습니다. ");
		return;
	}
	
	//방식별 최소값이 최대값(Row-1)을 넘었는지 체크..
	var areaGrpNm="", typeNm="";
	for(z=0;z<ds_mmar.GetRowCount();z++) {
		if(ds_mmar.GetColumn(z,"AR1_MIN")!=null 
			&& ds_mmar.GetColumn(z,"AR1_MIN")!=""
			&& ds_mmar.GetColumn(z,"AR1_GBN")==ds_mmar.GetColumn(z,"BGN")) 
		{
			areaGrpNm="수도권/";
			typeNm=tab_main.tab1.tab_main.tab3.grd_mmar.GetCellText('Body',z,10)+"/";
			//MAX,PER값이 있는지 체크
			if(ds_mmar.GetColumn(z,"AR1_MAX")==null || ds_mmar.GetColumn(z,"AR1_MAX")=="") {
				gfn_showAlert("CW10025",areaGrpNm+typeNm+"최대값이 없습니다. \n입력하여주시기 바랍니다.");
				return;
			}
			if(ds_mmar.GetColumn(z,"AR1_PER")==null || ds_mmar.GetColumn(z,"AR1_PER")=="") {
				gfn_showAlert("CW10025",areaGrpNm+typeNm+"비율값이 없습니다. \n입력하여주시기 바랍니다.");
				return;
			}
			//2번째 Row부터 최소값이 이전최대값과 비교
			if(ds_mmar.GetColumn(z,"CS648_GBN")!="A") {
				if(ds_mmar.GetColumn(z,"CS648_JCD")==ds_mmar.GetColumn(z-1,"CS648_JCD")) {
					if(ds_mmar.GetColumn(z,"AR1_MIN")<=ds_mmar.GetColumn(z-1,"AR1_MAX")) {
						gfn_showAlert("CW10025",areaGrpNm+typeNm+"최소값이 이전 Row의 최대값 보다 같거나 작을수 없습니다. ");
						return;
					}
				}
			}
		}
		
		if(ds_mmar.GetColumn(z,"AR2_MIN")!=null 
			&& ds_mmar.GetColumn(z,"AR2_MIN")!=""
			&& ds_mmar.GetColumn(z,"AR2_GBN")==ds_mmar.GetColumn(z,"BGN")) 
		{
			areaGrpNm="지방현장수10개이하/";
			typeNm=tab_main.tab1.tab_main.tab3.grd_mmar.GetCellText('Body',z,10)+"/";
			//MAX,PER값이 있는지 체크
			if(ds_mmar.GetColumn(z,"AR2_MAX")==null || ds_mmar.GetColumn(z,"AR2_MAX")=="") {
				gfn_showAlert("CW10025",areaGrpNm+typeNm+"최대값이 없습니다. \n입력하여주시기 바랍니다.");
				tab_main.tab1.tab_main.tab3.grd_mmar.SetFocus();
				return;
			}
			if(ds_mmar.GetColumn(z,"AR2_PER")==null || ds_mmar.GetColumn(z,"AR2_PER")=="") {
				gfn_showAlert("CW10025",areaGrpNm+typeNm+"비율값이 없습니다. \n입력하여주시기 바랍니다.");
				tab_main.tab1.tab_main.tab3.grd_mmar.SetFocus();
				return;
			}
			//2번째 Row부터 최소값이 이전최대값과 비교
			if(ds_mmar.GetColumn(z,"CS648_GBN")!="A") {
				if(ds_mmar.GetColumn(z,"CS648_JCD")==ds_mmar.GetColumn(z-1,"CS648_JCD")) {
					if(ds_mmar.GetColumn(z,"AR2_MIN")<=ds_mmar.GetColumn(z-1,"AR2_MAX")) {
						gfn_showAlert("CW10025",areaGrpNm+typeNm+"최소값이 이전 Row의 최대값 보다 같거나 작을수 없습니다. ");
						return;
					}
				}
			}
		}
		
		if(ds_mmar.GetColumn(z,"AR3_MIN")!=null 
			&& ds_mmar.GetColumn(z,"AR3_MIN")!=""
			&& ds_mmar.GetColumn(z,"AR3_GBN")==ds_mmar.GetColumn(z,"BGN")) 
		{
			areaGrpNm="지방현장수10개초과/";
			typeNm=tab_main.tab1.tab_main.tab3.grd_mmar.GetCellText('Body',z,10)+"/";
			//MAX,PER값이 있는지 체크
			if(ds_mmar.GetColumn(z,"AR3_MAX")==null || ds_mmar.GetColumn(z,"AR3_MAX")=="") {
				gfn_showAlert("CW10025",areaGrpNm+typeNm+"최대값이 없습니다. \n입력하여주시기 바랍니다.");
				tab_main.tab1.tab_main.tab3.grd_mmar.SetFocus();
				return;
			}
			if(ds_mmar.GetColumn(z,"AR3_PER")==null || ds_mmar.GetColumn(z,"AR3_PER")=="") {
				gfn_showAlert("CW10025",areaGrpNm+typeNm+"비율값이 없습니다. \n입력하여주시기 바랍니다.");
				tab_main.tab1.tab_main.tab3.grd_mmar.SetFocus();
				return;
			}
			//2번째 Row부터 최소값이 이전최대값과 비교
			if(ds_mmar.GetColumn(z,"CS648_GBN")!="A") {
				if(ds_mmar.GetColumn(z,"CS648_JCD")==ds_mmar.GetColumn(z-1,"CS648_JCD")) {
					if(ds_mmar.GetColumn(z,"AR3_MIN")<=ds_mmar.GetColumn(z-1,"AR3_MAX")) {
						gfn_showAlert("CW10025",areaGrpNm+typeNm+"최소값이 이전 Row의 최대값 보다 같거나 작을수 없습니다. ");
						return;
					}
				}
			}
		}
		
	}
	
	//ds_mmar -> ds_mmar_input으로 변환
	ds_mmar_input.ClearData();
	var rowidx=0;
	for(z=0;z<ds_mmar.GetRowCount();z++) {
		if(ds_mmar.GetColumn(z,"AR1_MIN")!=null 
			&& ds_mmar.GetColumn(z,"AR1_MIN")!=""
			&& ds_mmar.GetColumn(z,"AR1_GBN")==ds_mmar.GetColumn(z,"BGN")) 
		{
			ds_mmar_input.AddRow();
			ds_mmar_input.SetColumn(rowidx,"CS648_YEA",ds_mmar.GetColumn(z,"CS648_YEA"));
			ds_mmar_input.SetColumn(rowidx,"CS648_GBN",ds_mmar.GetColumn(z,"CS648_GBN"));
			ds_mmar_input.SetColumn(rowidx,"CS648_BGN",ds_mmar.GetColumn(z,"AR1_GBN"));
			ds_mmar_input.SetColumn(rowidx,"CS648_JCD",ds_mmar.GetColumn(z,"CS648_JCD"));
			ds_mmar_input.SetColumn(rowidx,"CS648_LGC","AR1");
			ds_mmar_input.SetColumn(rowidx,"CS648_MIN",ds_mmar.GetColumn(z,"AR1_MIN"));
			ds_mmar_input.SetColumn(rowidx,"CS648_MAX",ds_mmar.GetColumn(z,"AR1_MAX"));
			ds_mmar_input.SetColumn(rowidx,"CS648_PER",ds_mmar.GetColumn(z,"AR1_PER"));
			/*
			alert(rowidx + ":: CS648_YEA :: "+ds_mmar_input.GetColumn(rowidx,"CS648_YEA"));
			alert(rowidx + ":: CS648_GBN :: "+ds_mmar_input.GetColumn(rowidx,"CS648_GBN"));
			alert(rowidx + ":: CS648_BGN :: "+ds_mmar_input.GetColumn(rowidx,"CS648_BGN"));
			alert(rowidx + ":: CS648_JCD :: "+ds_mmar_input.GetColumn(rowidx,"CS648_JCD"));
			alert(rowidx + ":: CS648_LGC :: "+ds_mmar_input.GetColumn(rowidx,"CS648_LGC"));
			alert(rowidx + ":: CS648_MAX :: "+ds_mmar_input.GetColumn(rowidx,"CS648_MAX"));
			alert(rowidx + ":: CS648_GBN :: "+ds_mmar_input.GetColumn(rowidx,"CS648_GBN"));
			alert(rowidx + ":: CS648_PER :: "+ds_mmar_input.GetColumn(rowidx,"CS648_PER"));
			*/
			rowidx++;
		}
		if(ds_mmar.GetColumn(z,"AR2_MIN")!=null 
			&& ds_mmar.GetColumn(z,"AR2_MIN")!=""
			&& ds_mmar.GetColumn(z,"AR2_GBN")==ds_mmar.GetColumn(z,"BGN")) 
		{
			ds_mmar_input.AddRow();
			ds_mmar_input.SetColumn(rowidx,"CS648_YEA",ds_mmar.GetColumn(z,"CS648_YEA"));
			ds_mmar_input.SetColumn(rowidx,"CS648_GBN",ds_mmar.GetColumn(z,"CS648_GBN"));
			ds_mmar_input.SetColumn(rowidx,"CS648_BGN",ds_mmar.GetColumn(z,"AR2_GBN"));
			ds_mmar_input.SetColumn(rowidx,"CS648_JCD",ds_mmar.GetColumn(z,"CS648_JCD"));
			ds_mmar_input.SetColumn(rowidx,"CS648_LGC","AR2");
			ds_mmar_input.SetColumn(rowidx,"CS648_MIN",ds_mmar.GetColumn(z,"AR2_MIN"));
			ds_mmar_input.SetColumn(rowidx,"CS648_MAX",ds_mmar.GetColumn(z,"AR2_MAX"));
			ds_mmar_input.SetColumn(rowidx,"CS648_PER",ds_mmar.GetColumn(z,"AR2_PER"));
			rowidx++;
		}
		if(ds_mmar.GetColumn(z,"AR3_MIN")!=null 
			&& ds_mmar.GetColumn(z,"AR3_MIN")!=""
			&& ds_mmar.GetColumn(z,"AR3_GBN")==ds_mmar.GetColumn(z,"BGN")) 
		{
			ds_mmar_input.AddRow();
			ds_mmar_input.SetColumn(rowidx,"CS648_YEA",ds_mmar.GetColumn(z,"CS648_YEA"));
			ds_mmar_input.SetColumn(rowidx,"CS648_GBN",ds_mmar.GetColumn(z,"CS648_GBN"));
			ds_mmar_input.SetColumn(rowidx,"CS648_BGN",ds_mmar.GetColumn(z,"AR3_GBN"));
			ds_mmar_input.SetColumn(rowidx,"CS648_JCD",ds_mmar.GetColumn(z,"CS648_JCD"));
			ds_mmar_input.SetColumn(rowidx,"CS648_LGC","AR3");
			ds_mmar_input.SetColumn(rowidx,"CS648_MIN",ds_mmar.GetColumn(z,"AR3_MIN"));
			ds_mmar_input.SetColumn(rowidx,"CS648_MAX",ds_mmar.GetColumn(z,"AR3_MAX"));
			ds_mmar_input.SetColumn(rowidx,"CS648_PER",ds_mmar.GetColumn(z,"AR3_PER"));
			rowidx++;
		}
		
	}
	
	//삭제후 입력
	tit_addMultiActionInfo("cs96:CS9613003A_D5");
	tit_addMultiActionInfo("cs96:CS9613003A_I5");		

	/* End Of Input Validation Routines ---------------------------------------------------------------------------------------- */
	if(!gfn_showConfirm("CI00008", "저장확인"))
	{
		tit_clearActionInfo();
		return;
	}	
	
	tit_callService(
		""
		, ""
		, "ds_cond=ds_cond ds_mmar_input=ds_mmar_input"
		, ""
		, ""
		, "fn_afterSave");
	
}

/********************************************************************************
* 기      능   : 닫기  
********************************************************************************/
function fn_close() {
	close();
}

/********************************************************************************
* 기      능   : 취소 35
********************************************************************************/
function fn_cancel() {
	if(!gfn_showConfirm("CI00013", "입력"))
	{
		return;
	}

	//선택 연도를 조회한다.
	
	var strYear = cb_year.Value;
	if(cb_year.Index == 0)
	{
		gfn_showAlert("연도를 선택해주세요.");
		ufn_clearGrid();
		return;
	}
	
	ds_cond.SetColumn(0, "ZYEAR", strYear);	

	var strType = tab_main.tab2.cb_type.Value;
	ds_cond.SetColumn(0, "TYPE", strType);	


	//그리드를 채우기 위한 함수를 호출한다.
	ufn_retrieveData_01(ds_cond);		//그리드에 데이터를 채운다
	ufn_retrieveData_09(ds_cond);
}

/********************************************************************************
* 기      능   : 확인 80
********************************************************************************/
function fn_confirm() {

}
//=========================================================================================
// [ PART 4]
// Callback 함수 정의 : callback 함수명은 메인 함수의 fn_xxxx() 에서 xxxx 부분은 fn_afterXXXX()
// 형태가 되도록 작성 
//=========================================================================================
/********************************************************************************
* 기      능   : 조회 Callback  
********************************************************************************/
function fn_afterQuery(errCode, errMsg) {
	// 메시지 처리 
	gfn_showSearchMsg(tab_main.tab2.grd_data);
}
/********************************************************************************
* 기      능   : 저장 Callback  
********************************************************************************/
function fn_afterSave(errCode, errMsg) {
	if(errCode != 0) {
		gfn_showMsg("CE00001");
	} else {
		gfn_showMsg("CI00003");
		//close();
	}
}
//=========================================================================================
// [ PART 5 ]
// Detail Process Event 정의 ( User Define function )
// 사용자 정의 함수는 ufn_xxxx() 형태로 작성 
//=========================================================================================
/********************************************************************************
* 기      능   : 연도 콤보를 설정한다
********************************************************************************/

function ufn_initYearCombo() 
{
	tit_clearActionInfo();	
	tit_addSearchActionInfo("cs96:CS9613003A_S1");
	tit_callService(
        ""
        , ""
        , ""
        , "ds_year=ds_year"
        , ""
        , "ufn_afterInitYearCombo"
        , true);
}

function ufn_afterInitYearCombo(errCode, errMsg) {
	ds_year.insertRow(0);
	ds_year.setColumn(0, "ZYEAR", "- 선택 -");
	//cb_year.value = "";
	cb_year.Index = 0;
	//cb_year.value = substr(gfn_getCurrDate(),0,4);
	for(i=0;i<ds_year.RowCount();i++) {
		if(substr(gfn_getCurrDate(),0,4)==ds_year.GetColumn(i,"ZYEAR")) {
			cb_year.value = substr(gfn_getCurrDate(),0,4);
			cb_year.Index = i;
		}
	}
	cb_year_OnChanged();
}

/********************************************************************************
* 기      능   : 구분 콤보를 설정한다
********************************************************************************/

function ufn_initTypeCombo() 
{
	tit_clearActionInfo();	
	tit_addSearchActionInfo("cs96:CS9613003A_S2");
	tit_callService(
        ""
        , ""
        , ""
        , "ds_type=ds_type"
        , ""
        , "ufn_afterInitTypeCombo"
        , true);
}

function ufn_afterInitTypeCombo(errCode, errMsg) {
	ds_type.insertRow(0);
	ds_type.setColumn(0, "CTEXT2", "- 선택 -");
	tab_main.tab2.cb_type.value = "";
	tab_main.tab2.cb_type.Index = 0;
}


/********************************************************************************
* 기      능   : 각 그리드에 빈값이 존재하는지 확인한다.
********************************************************************************/
function ufn_checkDataSetStatus(ds_target)
{
	for(iCnt=0;iCnt < ds_target.count;iCnt++)
	{
		for(iCntIn=0;iCntIn < ds_target.GetColCount();iCntIn++)
		{
			if(trim(ds_target.GetColumn(iCnt, iCntIn)).length == 0)
			{
				return false;
			}
		}	
	}	
	return true;
}


/********************************************************************************
* 기      능   : 연도별 기준금액 데이터 retrieve
********************************************************************************/
//연도별 기준금액
function ufn_retrieveData_09(ds_cond)
{
	tit_clearActionInfo();	
	
	gfn_clearGridSortMark(tab_main.tab2.grd_data); 
	ds_data.Clear();

	
	tit_addSearchActionInfo("cs96:CS9613003A_S3",null, true);		//테이블의 해당 연도의 카운트를 가져온다. 
	tit_addSearchActionInfo("cs96:CS9613003A_S4", null, true);  	//연도별 주차시행율 데이터	ds_data
	
	tit_callService(	
        ""
        , ""
        , "ds_cond=ds_cond"
        , "ds_cnt=ds_cnt ds_data=ds_data"
        , ""
        , "fn_afterQuery"
        , true
        , true);
        	
/*        	
    //ZLCODE의 Outerjoin에 의해 생성된 구성요소에 대한 YEAR 정보 삽입
    for(iCnt=0;iCnt < ds_nmb.count;iCnt++)
    {
		ds_nmb.setColumn(iCnt, "ZYEAR", ds_cond.getColumn(0, "ZYEAR"));
	}
*/

}

//시행율변수들 조회
function ufn_retrieveData_01(ds_cond)
{
	tit_clearActionInfo();	
	ufn_clearGrid();
	
	tit_addSearchActionInfo("cs96:CS9613003A_S5", null, true);  	//연도별 시행율변수들 조회	ds_srate
	tit_addSearchActionInfo("cs96:CS9613003A_S6", null, true);  	//지역별 그룹매핑 조회	ds_area
	tit_addSearchActionInfo("cs96:CS9613003A_S7", null, true);  	//지역그룹별 방식설정	ds_area_grp
	tit_addSearchActionInfo("cs96:CS9613003A_S8", null, true);  	//노무비 설정	ds_mmar
	
	tit_callService(	
        ""
        , ""
        , "ds_cond=ds_cond"
        , "ds_srate=ds_srate ds_area=ds_area ds_area_grp=ds_area_grp ds_mmar=ds_mmar"
        , ""
        , "fn_afterQuery"
        , true
        , true);

}

//보수노무비 설정 조회
function ufn_retrieveData_02(ds_cond)
{
	tit_clearActionInfo();	
	gfn_clearGridSortMark(grd_mmar); 
	ds_mmar.Clear();
	
	tit_addSearchActionInfo("cs96:CS9613003A_S8", null, true);  	//노무비 설정	ds_mmar
	
	tit_callService(	
        ""
        , ""
        , "ds_cond=ds_cond"
        , "ds_mmar=ds_mmar"
        , ""
        , "fn_afterQuery"
        , true
        , true);

}

/********************************************************************************
* 기      능   : 그리드 데이터를 Clear한다.
********************************************************************************/

function ufn_clearGrid()
{
	//연도별 기준금액관리
	gfn_clearGridSortMark(tab_main.tab2.grd_data); 
	ds_data.Clear();
	//시행율변수관리
	ds_srate.Clear();
	
	//지역vs그룹설정
	gfn_clearGridSortMark(tab_main.tab1.tab_main.tab1.grd_area); 
	ds_area.Clear();
	//그룹vs방식설정
	gfn_clearGridSortMark(tab_main.tab1.tab_main.tab1.grd_area_grp); 
	ds_area_grp.Clear();
	
	//보수노무비 설정
	gfn_clearGridSortMark(tab_main.tab1.tab_main.tab3.grd_mmar);
	ds_mmar.Clear();
}

//=========================================================================================
// [ PART 6 ]
// component Event 정의 : 각 Component 별 이벤트 
//=========================================================================================
/********************************************************************************
* 기      능   : 그리드 헤더 클릭시 정렬 처리 
********************************************************************************/
function grd_list_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
{
	if ( nCell == 0 ) {
		// 그리드 표시할 컬럼 선택 
		gfn_selectGridCol(obj);
	} else {
		// 그리드 정렬 처리 
		gfn_sortGrid(obj,nCell);
	}
}

/********************************************************************************
* 기      능   : 연도 변경
********************************************************************************/

function cb_year_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	
	//선택 연도를 조회한다.
	var strYear = cb_year.Value;
	if(cb_year.Index == 0)
	{
		gfn_showAlert("연도를 선택해주세요.");
		
		ufn_clearGrid();
		return;
	}
	
	ds_cond.SetColumn(0, "ZYEAR", strYear);	
	

	//선택 연도를 조회한다.
	
	var strType = tab_main.tab2.cb_type.Value;
	tab_main.tab2.cb_type.Index = 0;
	/*
	if(cb_type.Index == 0)
	{
		//alert("방식을 선택해주세요.");
		ufn_clearGrid();
		return;
	}
	*/
	ds_cond.SetColumn(0, "TYPE", strType);	
	
	//그리드를 채우기 위한 함수를 호출한다.
	ufn_retrieveData_01(ds_cond);		//그리드에 데이터를 채운다
	
}

/********************************************************************************
* 기      능   :방식 변경
********************************************************************************/

function cb_type_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	//선택 연도를 조회한다.
	
	var strYear = cb_year.Value;
	if(cb_year.Index == 0)
	{
		gfn_showAlert("연도를 선택해주세요.");
		ufn_clearGrid();
		return;
	}
	
	ds_cond.SetColumn(0, "ZYEAR", strYear);	

	//선택 연도를 조회한다.
	
	var strType = tab_main.tab2.cb_type.Value;
	if(tab_main.tab2.cb_type.Index == 0)
	{
		gfn_showAlert("방식을 선택해주세요.");
		
		gfn_clearGridSortMark(tab_main.tab2.grd_data); 
		ds_data.Clear();
		
		return;
	}
	
	ds_cond.SetColumn(0, "TYPE", strType);	


	//그리드를 채우기 위한 함수를 호출한다.
	ufn_retrieveData_09(ds_cond);		//그리드에 데이터를 채운다
}

/********************************************************************************
* 기      능   : 카피툴 버튼 클릭
********************************************************************************/

function btn_copy_OnClick(obj)
{
	var arg = "scr='003A'";
	
	gfn_openPopup("CS9613002B", true, arg);
}


/********************************************************************************
* 기      능   : 시행율변수관리의 내부Tab 클릭시
********************************************************************************/
function tab_main_tab1_tab_main_OnChanged(obj,nOldIndex,nNewindex)
{
	//탭전환시 0->1로 전환시 각 셀별로 COLOR및 세팅 수정
	if(nOldIndex==0 && nNewindex==1) {
		//그리드전환시 그룹설정에 내용이 수정중이면 먼저 저장하라는 메시지 보여주기
		//ZCST650 : S06 : 지역별 지역그룹매핑
		var dsAreaRowType="0";
		for(i=0;i<ds_area.GetRowCount();i++) {
			if(ds_area.GetRowType(i)=="update") 
				dsAreaRowType="1";
		}
		//ZCST651 : S07 : 지역그룹별 주차방식 매핑
		var dsAreaGrpRowType="0";
		for(i=0;i<ds_area_grp.GetRowCount();i++) {
			if(ds_area_grp.GetRowType(i)=="update") 
				dsAreaGrpRowType="1";
		}
	
		if((dsAreaRowType=="1")||(dsAreaGrpRowType="1"))
		{
			gfn_showAlert("CW10025","그룹 설정에 수정한 내용이 있습니다. \n저장을 수행후 탭을 선택하세요. ");
			//이전탭으로 이동
			obj.TabIndex = nOldIndex;
			return;
		}
		
		//그리드를 채우기 위한 함수를 호출한다.
		ufn_retrieveData_02(ds_cond);		//그리드에 데이터를 채운다
		
	}
}

]]></Script>
</Window>