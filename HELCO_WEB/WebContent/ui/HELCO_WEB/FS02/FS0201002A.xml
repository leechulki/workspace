<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="562" Id="FS0201002A" Left="8" OnLoadCompleted="fn_OnLoadCompleted" OnUnloadCompleted="fn_OnUnloadCompleted" PidAttrib="7" Title="견적원가&#32;등록/변경" Top="8" Ver="1.0" Width="978" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_error">
				<Contents>
					<colinfo id="IDX" size="256" type="STRING"/>
					<colinfo id="ERRMSG" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond">
				<Contents>
					<colinfo id="MANDT" size="3" summ="default" type="STRING"/>
					<colinfo id="ESCS_NUMB" size="20" summ="default" type="STRING"/>
					<colinfo id="ESCS_NTIM" size="5" summ="default" type="INT"/>
					<colinfo id="ESCS_STAT" size="10" summ="default" type="STRING"/>
					<colinfo id="ESCS_STAT_NAME" size="120" summ="default" type="STRING"/>
					<colinfo id="APPR_STAT" size="10" summ="default" type="STRING"/>
					<colinfo id="APPR_STAT_NAME" size="35" summ="default" type="STRING"/>
					<colinfo id="RE_ESCS_NTIM" size="5" summ="default" type="INT"/>
					<record>
						<APPR_STAT></APPR_STAT>
						<APPR_STAT_NAME></APPR_STAT_NAME>
						<ESCS_NTIM/>
						<ESCS_NUMB></ESCS_NUMB>
						<ESCS_STAT></ESCS_STAT>
						<ESCS_STAT_NAME></ESCS_STAT_NAME>
						<MANDT></MANDT>
						<RE_ESCS_NTIM/>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_zfst0200">
				<Contents>
					<colinfo id="MANDT" size="3" summ="default" type="STRING"/>
					<colinfo id="ESCS_NUMB" size="20" summ="default" type="STRING"/>
					<colinfo id="ESCS_NTIM" size="5" summ="default" type="INT"/>
					<colinfo id="ORDR_TYPE" size="10" summ="default" type="STRING"/>
					<colinfo id="POST1" size="40" summ="default" type="STRING"/>
					<colinfo id="KUNNR" size="10" summ="default" type="STRING"/>
					<colinfo id="KUNNR_NAME" size="35" summ="default" type="STRING"/>
					<colinfo id="KUNNR_CTAT" size="20" summ="default" type="STRING"/>
					<colinfo id="REP_NAME" size="3" summ="default" type="STRING"/>
					<colinfo id="ESMT_CNTR" size="35" summ="default" type="STRING"/>
					<colinfo id="ESMT_CNTR_NAME" size="35" summ="default" type="STRING"/>
					<colinfo id="FAX" size="20" summ="default" type="STRING"/>
					<colinfo id="HTEL" size="20" summ="default" type="STRING"/>
					<colinfo id="EMAIL" size="20" summ="default" type="STRING"/>
					<colinfo id="SALE_PRSN" size="20" summ="default" type="STRING"/>
					<colinfo id="SALE_PRSN_NAME" size="35" summ="default" type="STRING"/>
					<colinfo id="MRGN_RATE" size="9" summ="default" type="DECIMAL"/>
					<colinfo id="WAERK" size="5" summ="default" type="STRING"/>
					<colinfo id="ESCS_TAMT" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="ESMT_TAMT" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="NGTT_TAMT" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="NGTT_APYN" size="1" summ="default" type="STRING"/>
					<colinfo id="REMK" size="4000" summ="default" type="STRING"/>
					<colinfo id="OCNT_PDYN" size="1" summ="default" type="STRING"/>
					<colinfo id="OCNT_PDDT" size="8" summ="default" type="STRING"/>
					<colinfo id="ESMT_PUBN" size="5" summ="default" type="INT"/>
					<colinfo id="AFIL_NUMB" size="20" summ="default" type="STRING"/>
					<colinfo id="ESCS_STAT" size="10" summ="default" type="STRING"/>
					<colinfo id="ESCS_STAT_NAME" size="120" summ="default" type="STRING"/>
					<colinfo id="ESCS_APDT" size="8" summ="default" type="STRING"/>
					<colinfo id="APPR_STAT" size="10" summ="default" type="STRING"/>
					<colinfo id="APPR_STAT_NAME" size="35" summ="default" type="STRING"/>
					<colinfo id="ESCS_ITEM_CNT" size="256" summ="default" type="INT"/>
					<colinfo id="MODI_USER" size="10" summ="default" type="STRING"/>
					<colinfo id="WRIT_USER" size="10" summ="default" type="STRING"/>
					<colinfo id="ADIT" size="256" summ="default" type="STRING"/>
					<colinfo id="APPR" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Editable="True" Id="ds_zfst0201_list">
				<Contents>
					<colinfo id="LIST_INDEX" size="100" summ="default" type="STRING"/>
					<colinfo id="CHK" size="100" summ="default" type="STRING"/>
					<colinfo id="FLAG" size="100" summ="default" type="STRING"/>
					<colinfo id="LEVEL" size="100" summ="default" type="STRING"/>
					<colinfo id="MANDT" size="3" summ="default" type="STRING"/>
					<colinfo id="ESCS_NUMB" size="20" summ="default" type="STRING"/>
					<colinfo id="ESCS_NTIM" size="5" summ="default" type="INT"/>
					<colinfo id="ESCS_ITSQ" size="5" summ="default" type="INT"/>
					<colinfo id="ITEM_DIYN" size="1" summ="default" type="STRING"/>
					<colinfo id="ESCS_GROP" size="10" summ="default" type="STRING"/>
					<colinfo id="ESCS_UPGR" size="10" summ="default" type="STRING"/>
					<colinfo id="ESCS_ITEM" size="9" summ="default" type="STRING"/>
					<colinfo id="EXTN_ESCS" size="21" summ="default" type="STRING"/>
					<colinfo id="ESCE_NAME" size="100" summ="default" type="STRING"/>
					<colinfo id="MTRL_DIVS" size="10" summ="default" type="STRING"/>
					<colinfo id="MTRL_NUMB" size="20" summ="default" type="STRING"/>
					<colinfo id="PART_NAME" size="100" summ="default" type="STRING"/>
					<colinfo id="STAD" size="100" summ="default" type="STRING"/>
					<colinfo id="UNIT" size="3" summ="default" type="STRING"/>
					<colinfo id="QNTY" size="5" summ="default" type="INT"/>
					<colinfo id="COST" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="WAERK" size="5" summ="default" type="STRING"/>
					<colinfo id="UKURS" size="9" summ="default" type="DECIMAL"/>
					<colinfo id="ICDT_EPNS" size="6" summ="default" type="DECIMAL"/>
					<colinfo id="IDRT_COST" size="6" summ="default" type="DECIMAL"/>
					<colinfo id="SALE_COST" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="MRGN_RATE" size="9" summ="default" type="DECIMAL"/>
					<colinfo id="ESMT_COST" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="PRES_COST" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="NGTT_ESCS" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="ESMT_EGRT" size="9" summ="default" type="DECIMAL"/>
					<colinfo id="CRES_COST" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="UNIT_CRES_COST" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="NOTE" size="256" summ="default" type="STRING"/>
					<colinfo id="ESMT_CMPY" size="40" summ="default" type="STRING"/>
					<colinfo id="WORD_REFR" size="256" summ="default" type="STRING"/>
					<colinfo id="OCNT_NUMB" size="20" summ="default" type="STRING"/>
					<colinfo id="EBDG_MGSQ" size="5" summ="default" type="INT"/>
					<colinfo id="EBDG_ITSQ" size="5" summ="default" type="INT"/>
					<colinfo id="MODI_DATE" size="8" summ="default" type="STRING"/>
					<colinfo id="MODI_TIME" size="6" summ="default" type="STRING"/>
					<colinfo id="MODI_USER" size="12" summ="default" type="STRING"/>
					<colinfo id="DEGREE" size="9" summ="default" type="DECIMAL"/>
					<colinfo id="ESIT_SEQN" size="5" summ="default" type="INT"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_combo_a03">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_copy_list">
				<Contents>
					<colinfo id="EXTN_ESCS" size="256" summ="default" type="STRING"/>
					<colinfo id="ESCS_GROP" size="256" summ="default" type="STRING"/>
					<colinfo id="SALE_COST" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="ESMT_COST" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="PRES_COST" size="15" summ="default" type="DECIMAL"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_combo_a02">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<colinfo id="EXTN_CODE1" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Editable="True" Id="ds_zfst0201_excel">
				<Contents>
					<colinfo id="EXTN_ESCS" size="21" summ="default" type="STRING"/>
					<colinfo id="ESCE_NAME" size="100" summ="default" type="STRING"/>
					<colinfo id="MTRL_NUMB" size="20" summ="default" type="STRING"/>
					<colinfo id="PART_NAME" size="100" summ="default" type="STRING"/>
					<colinfo id="STAD" size="100" summ="default" type="STRING"/>
					<colinfo id="UNIT" size="3" summ="default" type="STRING"/>
					<colinfo id="QNTY" size="5" summ="default" type="INT"/>
					<colinfo id="UNIT_COST" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="COST" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="WAERK" size="5" summ="default" type="STRING"/>
					<colinfo id="UKURS" size="9" summ="default" type="DECIMAL"/>
					<colinfo id="ICDT_EPNS" size="6" summ="default" type="DECIMAL"/>
					<colinfo id="IDRT_COST" size="6" summ="default" type="DECIMAL"/>
					<colinfo id="SALE_COST" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="MRGN_RATE" size="9" summ="default" type="DECIMAL"/>
					<colinfo id="ESMT_COST" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="PRES_COST" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="NGTT_ESCS" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="ESMT_EGRT" size="9" summ="default" type="DECIMAL"/>
					<colinfo id="CRES_COST" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="NOTE" size="256" summ="default" type="STRING"/>
					<colinfo id="ESMT_CMPY" size="40" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_doc_appr">
				<Contents>
					<colinfo id="MANDT" size="256" summ="default" type="STRING"/>
					<colinfo id="ADOC_CLAS" size="256" summ="default" type="STRING"/>
					<colinfo id="ADOC_NUMB" size="256" summ="default" type="STRING"/>
					<colinfo id="ADOC_NTIM" size="256" summ="default" type="STRING"/>
					<colinfo id="APPR_STAT" size="256" summ="default" type="STRING"/>
					<record>
						<ADOC_CLAS></ADOC_CLAS>
						<ADOC_NTIM></ADOC_NTIM>
						<ADOC_NUMB></ADOC_NUMB>
						<APPR_STAT></APPR_STAT>
						<MANDT></MANDT>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataObject="ds_zfst0201_list" DataSetType="Filter" Id="ds_zfst0201_master" OnColumnChanged="ds_zfst0201_master_OnColumnChanged"></Dataset>
			<Dataset DataObject="ds_zfst0201_list" DataSetType="Filter" FilterExpr='ITEM_DIYN==&apos;D&apos;&#32;&amp;&amp;&#32;ESCS_UPGR&#32;==&#32;ds_zfst0201_master.GetColumn(ds_zfst0201_master.GetRowPos(),&#32;&quot;ESCS_GROP&quot;)' Id="ds_zfst0201_detail" OnColumnChanged="ds_zfst0201_detail_OnColumnChanged"></Dataset>
		</Datasets>
		<Shape BKColor="user0" Bottom="29" Height="30" Id="Shape2" Left="0" LineColor="user1" Right="978" TabOrder="1" Top="-1" Type="Rectangle" Width="978"></Shape>
		<Shape BKColor="user0" Bottom="140" Height="88" Id="Shape0" Left="0" LineColor="user1" Right="978" TabOrder="2" Top="52" Type="Rectangle" Width="978"></Shape>
		<Static Align="Right" Height="20" Id="Static1" Left="8" Style="sty_lb_search" TabOrder="4" Text="견적원가번호" Top="4" VAlign="Middle" Width="96"></Static>
		<Edit Align="CENTER" BindDataset="ds_cond" Border="Flat" BorderColor="user1" Column="ESCS_NUMB" Height="20" Id="ed_escsNumb" Left="105" MaxLength="10" Readonly="TRUE" Style="sty_ipt_form_ind" TabOrder="3" Text="HEEC20170222001" Top="4" UpperOnly="TRUE" Width="106"></Edit>
		<Button Cursor="HAND" Height="18" Id="btn_escsNumb" ImageID="btn_icon_search" Left="210" OnClick="btn_budget_num_OnClick" TabOrder="5" Top="5" Transparent="TRUE" Width="18"></Button>
		<Static Align="Right" Height="20" Id="Static15" Left="230" Style="sty_lb_search" TabOrder="6" Text="차수" Top="4" VAlign="Middle" Width="44"></Static>
		<Edit Align="CENTER" BindDataset="ds_cond" Border="Flat" BorderColor="user1" Column="ESCS_NTIM" Height="20" Id="ed_escsNtim" Left="274" MaxLength="10" Readonly="TRUE" Style="sty_ipt_form_ind" TabOrder="7" Text="1" Top="4" UpperOnly="TRUE" Width="27"></Edit>
		<Static Color="user6" Font="굴림,9,Bold" Height="20" Id="Static19" Left="15" TabOrder="9" Text="사업정보" Top="34" VAlign="Middle" Width="102"></Static>
		<Image Height="20" Id="Image0" ImageID="form_bl_title_sub" Left="2" TabOrder="8" Top="32" Width="11"></Image>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_basicCode" ImageID="btn_sub_04" Left="728" LeftMargin="12" OnClick="btn_basic_info_OnClick" Style="sty_btn" TabOrder="10" Text="기준정보" Top="4" Transparent="TRUE" Width="76"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_excelUp" ImageID="btn_sub_05" Left="886" LeftMargin="12" OnClick="btn_price_upload_OnClick" Style="sty_btn" TabOrder="13" Text="엑셀업로드" Top="144" Transparent="TRUE" Width="84"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_costCopy" ImageID="btn_sub_04" Left="811" LeftMargin="12" OnClick="btn_price_copy_OnClick" Style="sty_btn" TabOrder="14" Text="원가복사" Top="144" Transparent="TRUE" Width="71"></Button>
		<Div Height="20" Id="Div0" Left="5" TabOrder="11" Text="Div0" Top="365" Width="969">
			<Contents>
				<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_itemCopy" ImageID="btn_sub_04" Left="819" LeftMargin="12" OnClick="btn_item_copy_OnClick" Style="sty_btn" TabOrder="2" Text="품목복사" Transparent="TRUE" Width="76"></Button>
				<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_mtrlAdd" ImageID="btn_sub_04" Left="892" LeftMargin="12" OnClick="btn_material_add_OnClick" Style="sty_btn" TabOrder="3" Text="자재복사" Transparent="TRUE" Width="76"></Button>
				<Image Height="20" Id="Image2" ImageID="form_bl_title_sub" Left="-3" TabOrder="5" Top="-1" Width="11"></Image>
				<Static Color="user6" Font="굴림,9,Bold" Height="20" Id="Static0" Left="10" TabOrder="4" Text="품목별&#32;원가" Top="1" VAlign="Middle" Width="102"></Static>
				<Button Cursor="HAND" Height="20" Id="btn_rowAdd2" ImageID="btn_icon_plus" Left="769" LeftMargin="12" OnClick="Div0_btn_rowAdd2_OnClick" Style="sty_btn" TabOrder="7" Transparent="TRUE" Width="22"></Button>
				<Button Cursor="HAND" Height="20" Id="btn_rowDel2" ImageID="btn_icon_minus" Left="793" LeftMargin="12" OnClick="Div0_btn_rowDel2_OnClick" Style="sty_btn" TabOrder="6" Transparent="TRUE" Width="22"></Button>
			</Contents>
		</Div>
		<Image Height="20" Id="Image1" ImageID="form_bl_title_sub" Left="2" TabOrder="15" Top="144" Width="11"></Image>
		<Static Color="user6" Font="굴림,9,Bold" Height="20" Id="Static4" Left="15" TabOrder="16" Text="기준항목별&#32;견적&#32;원가" Top="144" VAlign="Middle" Width="158"></Static>
		<Static Align="Right" Height="20" Id="Static0" Left="306" Style="sty_lb_search" TabOrder="17" Text="진행상태" Top="4" VAlign="Middle" Width="60"></Static>
		<Edit BindDataset="ds_zfst0200" Border="Flat" BorderColor="user1" Column="ESCS_STAT_NAME" Height="20" Id="ed_escsStatName" Left="366" MaxLength="10" Readonly="TRUE" Style="sty_ipt_form_ind" TabOrder="18" Top="4" UpperOnly="TRUE" Width="139"></Edit>
		<Static Align="Right" Height="20" Id="Static2" Left="508" Style="sty_lb_search" TabOrder="19" Text="결재상태" Top="4" VAlign="Middle" Width="60"></Static>
		<Edit BindDataset="ds_zfst0200" Border="Flat" BorderColor="user1" Column="APPR_STAT_NAME" Height="20" Id="ed_apprStatName" Left="568" MaxLength="10" Readonly="TRUE" Style="sty_ipt_form_ind" TabOrder="20" Top="4" UpperOnly="TRUE" Width="155"></Edit>
		<Button Cursor="HAND" Height="20" Id="btn_rowAdd1" ImageID="btn_icon_plus" Left="764" LeftMargin="12" OnClick="btn_rowAdd1_OnClick" Style="sty_btn" TabOrder="22" Top="144" Transparent="TRUE" Width="22"></Button>
		<Button Cursor="HAND" Height="20" Id="btn_rowDel1" ImageID="btn_icon_minus" Left="787" LeftMargin="12" OnClick="btn_rowDel1_OnClick" Style="sty_btn" TabOrder="21" Top="144" Transparent="TRUE" Width="22"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_adocInfo" ImageID="btn_sub_04" Left="801" LeftMargin="12" OnClick="btn_appr_info_OnClick" Style="sty_btn" TabOrder="23" Text="결재정보" Top="4" Transparent="TRUE" Width="76"></Button>
		<Shape BKColor="user12" Bottom="85" Height="26" Id="Shape5" Left="8" LineColor="user13" Right="642" TabOrder="24" Top="59" Type="Rectangle" Width="634"></Shape>
		<Edit BindDataset="ds_zfst0200" Border="Flat" BorderColor="user13" Column="KUNNR_NAME" Height="20" Id="Edit24" Left="60" MaxLength="10" Readonly="TRUE" Style="sty_ipt_form_ind" TabOrder="25" Top="62" UpperOnly="TRUE" Width="99"></Edit>
		<Static Align="Right" Height="24" Id="Static40" Left="9" Style="sty_lb_form_basic" TabOrder="26" Text="고객명" Top="60" VAlign="Middle" Width="52"></Static>
		<Static Align="Right" Height="24" Id="Static9" Left="180" Style="sty_lb_form_basic" TabOrder="27" Text="프로젝트명" Top="60" VAlign="Middle" Width="68"></Static>
		<Static Align="Right" Height="24" Id="Static10" Left="479" Style="sty_lb_form_basic" TabOrder="28" Text="오더유형" Top="60" VAlign="Middle" Width="60"></Static>
		<Button Cursor="HAND" Height="18" Id="btn_cusnName" ImageID="btn_icon_search" Left="159" OnClick="btn_cusnName_OnClick" TabOrder="29" Top="63" Transparent="TRUE" Width="18"></Button>
		<Edit BindDataset="ds_zfst0200" Border="Flat" Column="POST1" Height="20" Id="Edit6" Left="249" Style="sty_ipt_form" TabOrder="30" Top="62" Width="227"></Edit>
		<Combo BindDataset="ds_zfst0200" Border="Flat" BorderColor="user13" CodeColumn="CODE" Column="ORDR_TYPE" DataColumn="CODE_NAME" Height="20" Id="cb_ordrType" InnerDataset="ds_combo_a03" Left="537" Style="sty_ipt_form" TabOrder="31" Top="61" Width="92"></Combo>
		<Shape BKColor="user12" Bottom="110" Height="26" Id="Shape1" Left="8" LineColor="user13" Right="642" TabOrder="32" Top="84" Type="Rectangle" Width="634"></Shape>
		<Static Align="Right" Height="24" Id="Static18" Left="9" Style="sty_lb_form_basic" TabOrder="33" Text="국가" Top="85" VAlign="Middle" Width="52"></Static>
		<Shape BKColor="user12" Bottom="135" Height="76" Id="Shape3" Left="642" LineColor="user13" Right="973" TabOrder="34" Top="59" Type="Rectangle" Width="331"></Shape>
		<Button Cursor="HAND" Height="18" Id="btn_cntrCode" ImageID="btn_icon_search" Left="159" OnClick="btn_cntrCode_OnClick" TabOrder="36" Top="88" Transparent="TRUE" Width="18"></Button>
		<Edit BindDataset="ds_zfst0200" Border="Flat" BorderColor="user13" Column="ESMT_CNTR_NAME" Height="20" Id="Edit1" Left="60" MaxLength="10" Readonly="TRUE" Style="sty_ipt_form_ind" TabOrder="37" Top="87" UpperOnly="TRUE" Width="99"></Edit>
		<Shape BKColor="user12" Bottom="135" Height="26" Id="Shape4" Left="8" LineColor="user13" Right="642" TabOrder="38" Top="109" Type="Rectangle" Width="634"></Shape>
		<Static Align="Right" Height="24" Id="Static3" Left="480" Style="sty_lb_form_basic" TabOrder="39" Text="전화번호" Top="85" VAlign="Middle" Width="52"></Static>
		<Edit BindDataset="ds_zfst0200" Border="Flat" Column="KUNNR_CTAT" Height="20" Id="Edit2" Left="531" Style="sty_ipt_form" TabOrder="40" Top="87" Width="83"></Edit>
		<Static Align="Right" Height="24" Id="Static5" Left="9" Style="sty_lb_form_basic" TabOrder="41" Text="HP" Top="110" VAlign="Middle" Width="20"></Static>
		<Edit BindDataset="ds_zfst0200" Border="Flat" Column="HTEL" Height="20" Id="Edit3" Left="29" Style="sty_ipt_form" TabOrder="42" Top="112" Width="83"></Edit>
		<Static Align="Right" Height="24" Id="Static6" Left="116" Style="sty_lb_form_basic" TabOrder="43" Text="FAX" Top="110" VAlign="Middle" Width="28"></Static>
		<Edit BindDataset="ds_zfst0200" Border="Flat" Column="FAX" Height="20" Id="Edit10" Left="146" Style="sty_ipt_form" TabOrder="44" Top="112" Width="83"></Edit>
		<Static Align="Right" Height="24" Id="Static7" Left="303" Style="sty_lb_form_basic" TabOrder="45" Text="MAIL" Top="85" VAlign="Middle" Width="28"></Static>
		<Edit BindDataset="ds_zfst0200" Border="Flat" Column="EMAIL" Height="20" Id="Edit11" Left="331" Style="sty_ipt_form" TabOrder="46" Top="87" Width="147"></Edit>
		<Static Align="Right" Height="74" Id="Static16" Left="643" Style="sty_lb_form_basic" TabOrder="47" Text="특기사항" Top="60" VAlign="Middle" Width="52"></Static>
		<TextArea BindDataset="ds_zfst0200" BorderColor="user13" Column="REMK" Height="71" Id="et_calculat" Left="695" Style="sty_ipt_form" TabOrder="48" Top="62" VScroll="TRUE" Width="271"></TextArea>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_write" ImageID="btn_sub_06" Left="874" LeftMargin="12" OnClick="btn_write_OnClick" Style="sty_btn" TabOrder="51" Text="예산항목등록" Top="4" Transparent="TRUE" Width="100"></Button>
		<Static Align="Right" Height="24" Id="Static11" Left="179" Style="sty_lb_form_basic" TabOrder="53" Text="담당자" Top="85" VAlign="Middle" Width="36"></Static>
		<Edit BindDataset="ds_zfst0200" Border="Flat" Column="REP_NAME" Height="20" Id="ed_repName" Left="216" Style="sty_ipt_form" TabOrder="54" Top="87" Width="83"></Edit>
		<Edit Align="CENTER" BindDataset="ds_zfst0200" Border="Flat" BorderColor="user13" Column="SALE_PRSN_NAME" Height="20" Id="Edit9" Left="297" MaxLength="10" Readonly="TRUE" Style="sty_ipt_form_ind" TabOrder="55" Text="홍길동" Top="112" UpperOnly="TRUE" Width="59"></Edit>
		<Static Align="Right" Height="24" Id="Static13" Left="235" Style="sty_lb_form_basic" TabOrder="56" Text="영업담당자" Top="110" VAlign="Middle" Width="60"></Static>
		<Button Cursor="HAND" Height="18" Id="btn_salePrsn" ImageID="btn_icon_search" Left="357" OnClick="btn_salePrsn_OnClick" TabOrder="57" Top="113" Transparent="TRUE" Width="18"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_fileUp" ImageID="btn_sub_04" Left="898" LeftMargin="12" OnClick="btn_fileUp_OnClick" Style="sty_btn" TabOrder="35" Text="파일등록" Top="31" Transparent="TRUE" Width="76"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_mngrReg" ImageID="btn_sub_05" Left="381" LeftMargin="12" OnClick="btn_person_OnClick" Style="sty_btn" TabOrder="52" Text="담당자등록" Top="112" Transparent="TRUE" Width="89"></Button>
		<Static Align="Right" Height="24" Id="Static8" Left="472" Style="sty_lb_form_basic" TabOrder="49" Text="수주예상일" Top="110" VAlign="Middle" Width="60"></Static>
		<Calendar BindDataset="ds_zfst0200" Border="Flat" BorderColor="user13" ClickedBkColor="user32" ClickedTextColor="user33" Column="OCNT_PDDT" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="Calendar2" Left="533" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="50" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="112" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="100"></Calendar>
		<Grid AutoEnter="TRUE" AutoFitEndLine="Hide" BindDataset="ds_zfst0201_master" BkColor2="default" BoldHead="true" Border="Flat" Bottom="361" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="25" Height="193" HScrollCell="TRUE" Id="grd_master" InputPanel="FALSE" Left="8" LineColor="user20" LineType="ExHORZ" OnCellClick="grd_master_OnCellClick" OnCellPosChanged="grd_master_OnCellPosChanged" Right="968" RowHeight="20" Style="sty_grid" TabOrder="12" TabStop="true" Top="168" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="960">
			<contents>
				<format id="Default">
					<columns>
						<col width="0"/>
						<col width="0"/>
						<col width="56"/>
						<col width="27"/>
						<col width="231"/>
						<col width="157"/>
						<col width="44"/>
						<col width="45"/>
						<col width="98"/>
						<col width="93"/>
						<col width="94"/>
						<col width="98"/>
						<col width="44"/>
						<col width="47"/>
						<col width="179"/>
					</columns>
					<head>
						<cell col="0" display="text"/>
						<cell col="1" display="text"/>
						<cell col="2" display="text"/>
						<cell align="center" col="3" color="user21" display="text" font="굴림,9" wordwrap="word"/>
						<cell align="center" col="4" color="user21" display="text" font="굴림,9" text="항목" wordwrap="word"/>
						<cell align="center" col="5" color="user21" display="text" font="굴림,9" text="규격" wordwrap="word"/>
						<cell align="center" col="6" color="user21" display="text" font="굴림,9" text="단위" wordwrap="word"/>
						<cell col="7" color="user21" display="text" font="굴림,9" text="수량"/>
						<cell col="8" color="user21" display="text" font="굴림,9" text="단가(원)"/>
						<cell col="9" color="user21" display="text" font="굴림,9" text="원가(원)"/>
						<cell align="center" col="10" color="user21" display="text" font="굴림,9" text="견적금액(원)"/>
						<cell col="11" color="user21" display="text" font="굴림,9" text="네고금액(원)"/>
						<cell col="12" color="user21" display="text" font="굴림,9" text="시행율"/>
						<cell col="13" color="user21" display="text" font="굴림,9" text="비율"/>
						<cell col="14" color="user21" display="text" font="굴림,9" text="비고"/>
					</head>
					<body>
						<cell align="center" bkcolor2="user22" col="0" display="text" edit="normal"/>
						<cell col="1" colid="CHK" display="text"/>
						<cell align="left" col="2" colid="LIST_INDEX" display="text"/>
						<cell align="center" bkcolor2="user22" col="3" colid="FLAG" display="null" expandsize="0"/>
						<cell align="left" bkcolor2="user22" col="4" colid="ESCE_NAME" display="normal" edit="normal"/>
						<cell align="left" bkcolor2="user22" checklength="Byte" col="5" colid="STAD" display="text" edit="normal" expandsize="30" limit="150" Valign="Center"/>
						<cell align="center" bkcolor2="user22" col="6" colid="UNIT" display="text" edit="normal" expandsize="30" limit="765" Valign="Center"/>
						<cell align="right" col="7" colid="QNTY" display="text" edit="number" expr="iif(QNTY==0,&#32;&apos;&apos;,&#32;QNTY)" Valign="Center"/>
						<cell align="right" col="8" colid="COST" display="number" expr="iif(COST==0,&#32;&apos;&apos;,&#32;COST)" Valign="Center"/>
						<cell align="right" bkcolor2="user22" col="9" colid="SALE_COST" display="number" expr="iif(SALE_COST==0,&#32;&apos;&apos;,&#32;SALE_COST)" Valign="Center"/>
						<cell col="10" colid="ESMT_COST" display="number" expr="iif(ESMT_COST==0,&#32;&apos;&apos;,&#32;ESMT_COST)" Valign="Center"/>
						<cell col="11" colid="NGTT_ESCS" display="number" expr="iif(NGTT_ESCS==0,&#32;&apos;&apos;,&#32;NGTT_ESCS)" Valign="Center"/>
						<cell align="center" col="12" colid="MRGN_RATE" display="numberexp" expr="round(100*SALE_COST/NGTT_ESCS,2)" Valign="Center"/>
						<cell align="center" col="13" display="text" expr='round(SALE_COST/CaseSumNF(&quot;ESCS_UPGR=&apos;&apos;&quot;,&#32;&quot;SALE_COST&quot;)*100,2)' Valign="Center"/>
						<cell align="left" col="14" colid="NOTE" display="text" edit="normal" limit="256" Valign="Center"/>
					</body>
					<summary>
						<cell col="0" display="text"/>
						<cell col="1" display="text"/>
						<cell align="center" bkcolor="user25" col="2" color="user26" colspan="6" display="text" text="직접비합계"/>
						<cell align="right" bkcolor="user25" col="8" color="user26" display="number" expr='ds_zfst0201_list.CaseSumNF(&quot;ITEM_DIYN=&apos;M&apos;&#32;&amp;&amp;&#32;indexOf(ESCS_ITEM,&#32;&apos;Z00&apos;)&#32;&lt;&#32;0&quot;,&#32;&quot;COST&quot;)'/>
						<cell align="right" bkcolor="user25" col="9" color="user26" display="number" expr='ds_zfst0201_list.CaseSumNF(&quot;ESCS_UPGR==&apos;&apos;&#32;&amp;&amp;&#32;indexOf(ESCS_ITEM,&apos;Z00&apos;)&#32;&lt;&#32;0&quot;,&quot;SALE_COST&quot;)'/>
						<cell align="right" bkcolor="user25" col="10" color="user26" display="number" expr='ds_zfst0201_list.CaseSumNF(&quot;&#32;ESCS_UPGR=&apos;&apos;&#32;&amp;&amp;&#32;indexOf(ESCS_ITEM,&#32;&apos;Z00&apos;)&#32;&lt;&#32;0&quot;,&#32;&quot;ESMT_COST&quot;)'/>
						<cell align="right" bkcolor="user25" col="11" color="user26" display="number" expr='ds_zfst0201_list.CaseSumNF(&quot;ESCS_UPGR=&apos;&apos;&#32;&amp;&amp;&#32;indexOf(ESCS_ITEM,&#32;&apos;Z00&apos;)&#32;&lt;&#32;0&quot;,&#32;&quot;NGTT_ESCS&quot;)'/>
						<cell align="center" bkcolor="user25" col="12" color="user26" display="text" expr='round(ds_zfst0201_list.CaseSumNF(&quot;ESCS_UPGR=&apos;&apos;&#32;&amp;&amp;&#32;indexOf(ESCS_ITEM,&#32;&apos;Z00&apos;)&#32;&lt;&#32;0&quot;,&#32;&quot;SALE_COST&quot;)/ds_zfst0201_list.CaseSumNF(&quot;ESCS_UPGR=&apos;&apos;&#32;&amp;&amp;&#32;indexOf(ESCS_ITEM,&#32;&apos;Z00&apos;)&#32;&lt;&#32;0&quot;,&#32;&quot;NGTT_ESCS&quot;)*100,2)'/>
						<cell align="right" bkcolor="user25" col="13" color="user26" display="text"/>
						<cell bkcolor="user25" col="14" color="user26" display="text"/>
						<cell col="0" display="text" row="1"/>
						<cell col="1" display="text" row="1"/>
						<cell align="center" bkcolor="user25" col="2" color="user26" colspan="6" display="text" expr='&quot;합계&quot;' row="1"/>
						<cell align="right" bkcolor="user25" col="8" color="user26" display="number" expr='ds_zfst0201_list.CaseSumNF(&quot;ITEM_DIYN=&apos;M&apos;&quot;,&#32;&quot;COST&quot;)' row="1"/>
						<cell align="right" bkcolor="user25" col="9" color="user26" display="number" expr='ds_zfst0201_list.CaseSumNF(&quot;ESCS_UPGR=&apos;&apos;&quot;,&#32;&quot;SALE_COST&quot;)' row="1"/>
						<cell align="right" bkcolor="user25" col="10" color="user26" display="number" expr='ds_zfst0201_list.CaseSumNF(&quot;&#32;ESCS_UPGR=&apos;&apos;&#32;&quot;,&#32;&quot;ESMT_COST&quot;)' row="1"/>
						<cell align="right" bkcolor="user25" col="11" color="user26" display="number" expr='ds_zfst0201_list.CaseSumNF(&quot;ESCS_UPGR=&apos;&apos;&quot;,&#32;&quot;NGTT_ESCS&quot;)' row="1"/>
						<cell align="center" bkcolor="user25" col="12" color="user26" display="text" expr='round(ds_zfst0201_list.CaseSumNF(&quot;ESCS_UPGR=&apos;&apos;&quot;,&#32;&quot;SALE_COST&quot;)/ds_zfst0201_list.CaseSumNF(&quot;ESCS_UPGR=&apos;&apos;&quot;,&#32;&quot;NGTT_ESCS&quot;)*100,2)' row="1"/>
						<cell bkcolor="user25" col="13" color="user26" display="text" row="1"/>
						<cell bkcolor="user25" col="14" color="user26" display="text" row="1"/>
					</summary>
				</format>
			</contents>
		</Grid>
		<Grid AutoEnter="TRUE" AutoFitEndLine="Hide" BindDataset="ds_zfst0201_excel" BkColor2="default" BoldHead="true" Border="Flat" Bottom="88" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="25" Height="88" HScrollCell="TRUE" Id="excel_grid" InputPanel="FALSE" Left="992" LineColor="user20" LineType="ExHORZ" OnCellClick="grd_master_OnCellClick" OnCellPosChanged="grd_master_OnCellPosChanged" Right="1952" RowHeight="20" Style="sty_grid" TabOrder="58" TabStop="true" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="FALSE" VLineColor="default" WheelScrollRow="1" Width="960">
			<contents>
				<format id="Default">
					<columns>
						<col width="231"/>
						<col width="157"/>
						<col width="172"/>
						<col width="44"/>
						<col width="45"/>
						<col width="98"/>
						<col width="93"/>
						<col width="94"/>
						<col width="98"/>
						<col width="98"/>
						<col width="44"/>
						<col width="47"/>
						<col width="179"/>
						<col width="179"/>
					</columns>
					<head>
						<cell align="center" col="0" color="user21" display="text" font="굴림,9" text="항목" wordwrap="word"/>
						<cell align="center" col="1" color="user21" display="text" font="굴림,9" text="규격" wordwrap="word"/>
						<cell align="center" col="2" color="user21" display="text" font="굴림,9" text="자재번호/Part&#32;Numb" wordwrap="word"/>
						<cell align="center" col="3" color="user21" display="text" font="굴림,9" text="단위" wordwrap="word"/>
						<cell col="4" color="user21" display="text" font="굴림,9" text="수량"/>
						<cell col="5" color="user21" display="text" font="굴림,9" text="단가(원)"/>
						<cell col="6" color="user21" display="text" font="굴림,9" text="원가(원)"/>
						<cell align="center" col="7" color="user21" display="text" font="굴림,9" text="견적금액(원)"/>
						<cell col="8" color="user21" display="text" font="굴림,9" text="네고금액(원)"/>
						<cell col="9" color="user21" display="text" font="굴림,9" text="이전견적금액(원)"/>
						<cell col="10" color="user21" display="text" font="굴림,9" text="시행율"/>
						<cell col="11" color="user21" display="text" font="굴림,9" text="비율"/>
						<cell col="12" color="user21" display="text" font="굴림,9" text="견적업체명"/>
						<cell col="13" color="user21" display="text" font="굴림,9" text="비고"/>
					</head>
					<body>
						<cell align="left" bkcolor2="user22" col="0" colid="ESCE_NAME" display="normal" edit="normal" expr="iif(ESCE_NAME==&apos;&apos;,&#32;&apos;&#32;&#32;-&#32;&apos;+PART_NAME,&#32;LIST_INDEX+&apos;&#32;&apos;+ESCE_NAME)"/>
						<cell align="left" bkcolor2="user22" checklength="Byte" col="1" colid="STAD" display="text" edit="normal" expandsize="30" limit="150" Valign="Center"/>
						<cell align="left" bkcolor2="user22" col="2" colid="MTRL_NUMB" display="normal" edit="normal"/>
						<cell align="center" bkcolor2="user22" col="3" colid="UNIT" display="text" edit="normal" expandsize="30" limit="765" Valign="Center"/>
						<cell align="right" col="4" colid="QNTY" display="text" edit="number" expr="iif(QNTY==0,&#32;&apos;&apos;,&#32;QNTY)" Valign="Center"/>
						<cell align="right" col="5" colid="COST" display="number" expr="iif(COST==0,&#32;&apos;&apos;,&#32;COST)" Valign="Center"/>
						<cell align="right" bkcolor2="user22" col="6" colid="SALE_COST" display="number" expr="iif(SALE_COST==0,&#32;&apos;&apos;,&#32;SALE_COST)" Valign="Center"/>
						<cell col="7" colid="ESMT_COST" display="number" expr="iif(ESMT_COST==0,&#32;&apos;&apos;,&#32;ESMT_COST)" Valign="Center"/>
						<cell col="8" colid="NGTT_ESCS" display="number" expr="iif(NGTT_ESCS==0,&#32;&apos;&apos;,&#32;NGTT_ESCS)" Valign="Center"/>
						<cell align="right" col="9" colid="PRES_COST" display="number" expr="iif(PRES_COST==0,&#32;&apos;&apos;,&#32;PRES_COST)" Valign="Center"/>
						<cell align="center" col="10" colid="MRGN_RATE" display="numberexp" expr="round(100*SALE_COST/NGTT_ESCS,2)" Valign="Center"/>
						<cell align="center" col="11" display="text" expr='round(SALE_COST/CaseSumNF(&quot;ESCS_UPGR=&apos;&apos;&quot;,&#32;&quot;SALE_COST&quot;)*100,2)' Valign="Center"/>
						<cell align="left" col="12" colid="ESMT_CMPY" display="text" edit="normal" limit="256" Valign="Center"/>
						<cell align="left" col="13" colid="NOTE" display="text" edit="normal" limit="256" Valign="Center"/>
					</body>
					<summary>
						<cell align="center" bkcolor="user25" col="0" color="user26" colspan="5" display="text" expr='&quot;합계&quot;'/>
						<cell align="right" bkcolor="user25" col="5" color="user26" display="number" expr='CaseSumNF(&quot;ITEM_DIYN=&apos;M&apos;&quot;,&#32;&quot;COST&quot;)'/>
						<cell align="right" bkcolor="user25" col="6" color="user26" display="number" expr='CaseSumNF(&quot;ESCS_UPGR=&apos;&apos;&quot;,&#32;&quot;SALE_COST&quot;)'/>
						<cell align="right" bkcolor="user25" col="7" color="user26" display="number" expr='CaseSumNF(&quot;ESCS_UPGR=&apos;&apos;&quot;,&#32;&quot;ESMT_COST&quot;)'/>
						<cell align="right" bkcolor="user25" col="8" color="user26" display="number" expr='CaseSumNF(&quot;ESCS_UPGR=&apos;&apos;&quot;,&#32;&quot;NGTT_ESCS&quot;)'/>
						<cell align="right" bkcolor="user25" col="9" color="user26" display="number" expr='CaseSumNF(&quot;ESCS_UPGR=&apos;&apos;&quot;,&#32;&quot;PRES_COST&quot;)'/>
						<cell align="center" bkcolor="user25" col="10" color="user26" display="text" expr='round(CaseSumNF(&quot;ESCS_UPGR=&apos;&apos;&quot;,&#32;&quot;SALE_COST&quot;)/CaseSumNF(&quot;ESCS_UPGR=&apos;&apos;&quot;,&#32;&quot;NGTT_ESCS&quot;)*100,2)'/>
						<cell bkcolor="user25" col="11" color="user26" display="text"/>
						<cell bkcolor="user25" col="12" color="user26" display="text"/>
						<cell bkcolor="user25" col="13" color="user26" display="text"/>
					</summary>
				</format>
			</contents>
		</Grid>
		<Grid AutoEnter="TRUE" AutoFitEndLine="Hide" BindDataset="ds_zfst0201_detail" BkColor2="default" BoldHead="true" Border="Flat" Bottom="555" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="25" Height="163" Id="grd_detail" InputPanel="FALSE" Left="8" LineColor="user20" LineType="ExHORZ" OnExpandEdit="grd_detail_OnExpandEdit" Right="968" RowHeight="20" Style="sty_grid" TabOrder="59" TabStop="true" Top="392" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="960">
			<contents>
				<format id="Default">
					<columns>
						<col width="0"/>
						<col width="29"/>
						<col width="110"/>
						<col width="157"/>
						<col width="109"/>
						<col width="56"/>
						<col width="33"/>
						<col width="64"/>
						<col width="66"/>
						<col width="68"/>
						<col width="68"/>
						<col width="68"/>
						<col width="82"/>
						<col width="138"/>
						<col width="100"/>
						<col width="113"/>
						<col width="78"/>
						<col width="140"/>
						<col width="175"/>
					</columns>
					<head>
						<cell col="0" display="text"/>
						<cell align="center" col="1" color="user21" display="text" font="굴림,9" text="순번" wordwrap="word"/>
						<cell align="center" col="2" color="user21" display="text" font="굴림,9" text="자재번호/Part&#32;Num" wordwrap="word"/>
						<cell align="center" col="3" color="user21" display="text" font="굴림,9" text="항목" wordwrap="word"/>
						<cell align="center" col="4" color="user21" display="text" font="굴림,9" text="규격" wordwrap="word"/>
						<cell col="5" color="user21" display="text" font="굴림,9" text="단위"/>
						<cell col="6" color="user21" display="text" font="굴림,9" text="수량"/>
						<cell align="center" col="7" color="user21" display="text" font="굴림,9" text="통화단위"/>
						<cell col="8" color="user21" display="text" font="굴림,9" text="환율"/>
						<cell col="9" color="user21" display="text" font="굴림,9" text="단가"/>
						<cell col="10" color="user21" display="text" font="굴림,9" text="수입부대"/>
						<cell col="11" color="user21" display="text" font="굴림,9" text="간접비"/>
						<cell col="12" color="user21" display="text" font="굴림,9" text="원가(원)"/>
						<cell align="center" col="13" color="user21" display="text" font="굴림,9" text="견적금액(원)"/>
						<cell col="14" color="user21" display="text" font="굴림,9" text="네고금액(원)"/>
						<cell col="15" color="user21" display="text" font="굴림,9" text="이전견적금액(원)"/>
						<cell col="16" color="user21" display="text" font="굴림,9" text="시행율"/>
						<cell col="17" color="user21" display="text" font="굴림,9" text="견적업체명"/>
						<cell col="18" color="user21" display="text" font="굴림,9" text="비고"/>
					</head>
					<body>
						<cell align="center" bkcolor2="user22" col="0" display="text" edit="normal"/>
						<cell align="center" bkcolor2="user22" col="1" display="text" expandsize="0" expr="currow+1"/>
						<cell align="center" bkcolor2="user22" col="2" colid="MTRL_NUMB" display="normal" edit="expr:iif(MTRL_DIVS==&apos;010&apos;,&#32;&apos;none&apos;,&#32;&apos;normal&apos;)"/>
						<cell align="left" bkcolor2="user22" checklength="Byte" col="3" colid="PART_NAME" display="text" edit="normal" expandsize="30" limit="150" Valign="Center"/>
						<cell align="left" bkcolor2="user22" col="4" colid="STAD" display="text" edit="normal" expandsize="30" limit="765" Valign="Center"/>
						<cell align="center" col="5" colid="UNIT" display="text" edit="normal" Valign="Center"/>
						<cell align="right" col="6" colid="QNTY" display="text" edit="number" expr="iif(QNTY==0,&#32;&apos;&apos;,&#32;QNTY)" Valign="Center"/>
						<cell align="center" col="7" colid="WAERK" display="text" expandshow="true" Valign="Center"/>
						<cell align="right" col="8" colid="UKURS" display="numberexp" edit="number" expr="iif(UKURS==0,&#32;&apos;&apos;,&#32;UKURS)" Valign="Center"/>
						<cell align="right" bkcolor2="user22" col="9" colid="COST" display="number" edit="number" expr="iif(COST==0,&#32;&apos;&apos;,&#32;COST)" Valign="Center"/>
						<cell align="right" col="10" colid="ICDT_EPNS" display="numberexp" edit="number" expr="iif(ICDT_EPNS==0,&#32;&apos;&apos;,&#32;ICDT_EPNS)" Valign="Center"/>
						<cell align="right" col="11" colid="IDRT_COST" display="numberexp" edit="number" expr="iif(IDRT_COST==0,&#32;&apos;&apos;,&#32;IDRT_COST)" Valign="Center"/>
						<cell align="right" col="12" colid="SALE_COST" display="number" expr="iif(SALE_COST==0,&#32;&apos;&apos;,&#32;SALE_COST)" Valign="Center"/>
						<cell align="right" col="13" colid="ESMT_COST" display="number" edit="number" expr="iif(ESMT_COST==0,&#32;&apos;&apos;,&#32;ESMT_COST)" Valign="Center"/>
						<cell align="right" col="14" colid="NGTT_ESCS" display="number" expr="iif(NGTT_ESCS==0,&#32;&apos;&apos;,&#32;NGTT_ESCS)" Valign="Center"/>
						<cell align="right" col="15" colid="PRES_COST" display="number" expr="iif(PRES_COST==0,&#32;&apos;&apos;,&#32;PRES_COST)" Valign="Center"/>
						<cell align="center" col="16" colid="MRGN_RATE" display="numberexp" expr="iif(MRGN_RATE==0,&#32;&apos;&apos;,&#32;MRGN_RATE)" Valign="Center"/>
						<cell col="17" colid="ESMT_CMPY" display="text" edit="normal" Valign="Center"/>
						<cell col="18" colid="NOTE" display="text" edit="normal" limit="256" Valign="Center"/>
					</body>
				</format>
			</contents>
		</Grid>
	</Form>
	<Script><![CDATA[/*
 ******************************************************************************************
 * 기      능   : 견적원가 등록
 * 작  성  자   : 박수근
 * 작성  일자   : 20116.11.01
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
#include "LIB::commons.js";           // 공통 스크립트
#include "LIB::fs_common.js";         // 물류서비스 공통 스크립트

//=========================================================================================
// [ PART 1 ]
// Form에서 사용될 전역변수를 선언
// FORM에서 사용되는 전역변수는 대문자로 작성하며, F_XXX 의 형태를 갖도록 한다.
//=========================================================================================
var dataLoad = "N";
var g_escsItemSeqn =0;
var dataSort = "N";
var g_mItemCnt = 0;
var g_gType = "1"; // 1: 직접비, 2: 간접비
var g_widthArray = Array();

//=========================================================================================
// [ PART 2 ]
// Form Loading / Unloading 시 작업 정의
//=========================================================================================
function fn_OnLoadCompleted(obj) {
    gfn_initForm(true);             // Form 로드 이벤트 맨 첫줄에 기술
    fn_init_form();             // 폼 초기화
}

/********************************************************************************
* 기      능   : form UnloadCompleted
********************************************************************************/
function fn_OnUnloadCompleted(obj) {
    return gfn_isFormUnload(obj);
}

/********************************************************************************
* 기      능   : 폼 초기화
********************************************************************************/
function fn_init_form() {
    // 견적원가 드롭다운 그리드 선언
    gfn_InitDrillDown(ds_zfst0201_list, grd_master, "ITEM_DIYN=='M'", "FLAG", "LEVEL", "ESCS_GROP", "ESCS_UPGR", "ESCE_NAME", "CHK");

    // 입력 파라미터 체크 escsNumb='' escsNtim=
    if( FS0201002A.IsExistVar("escsNumb") ) {
        if( escsNumb == "" ) {
			if( fn_escsCreate() ) {
				fn_query();
			}
        } else {
			ds_cond.SetColumn(0, "ESCS_NUMB", escsNumb);
			ds_cond.SetColumn(0, "ESCS_NTIM", escsNtim);
			fn_query();
        }
    }

    //var codeArray = ["A02:ds_combo_a02","A03:ds_combo_a03"];
    // 공용코드 콤보 데이터 셑을 가져온다.
	var codeArray =
		[
			,"A03:ds_combo_a03::EXTN1="+Quote("_%")
		];

    gn_fsComboDataSet(codeArray);
    // EXTN_CODE1='EC' OR EXTN_CODE1='ES'
    
    // 품목별 원가 그리드 width
	for(var i=0; i < grd_detail.GetColCount(); i++) {
        g_widthArray[i] = grd_detail.GetColProp(i,"Width");
	}
}

/********************************************************************************
* 기      능   : 견적원가 조회
********************************************************************************/
function fn_query() {
    if( ed_escsNumb.text == '' ) {
        gfn_openMsgWin("견적원가번호를 입력하십시요", "", "A", "");
        return;
    }

    // 조회 스크립트
    tit_clearActionInfo();
    tit_addSearchActionInfo("fs02:FS0201002A_S1");
    tit_addSearchActionInfo("fs02:FS0201002A_S2");
    tit_callService(
                    ""
                   ,""
                   ,"ds_cond=ds_cond"
                   ,"ds_zfst0200=ds_zfst0200 ds_zfst0201_list=ds_zfst0201_list"
                   ,""
                   ,"fn_afterQuery"
                   ,"true"
                   ,"true"
                   ,"false"
                   );
}

/********************************************************************************
* 기      능   : 견적원가 조회 Callback
********************************************************************************/
function fn_afterQuery(errCode, errMsg) {
    if(ds_error.rowcount() > 0) {
        gfn_showMsg("CE00001");
    } else {
        gfn_showMsg("CI00002", ds_zfst0200.rowCount() + "");
        if( ds_zfst0200.rowCount() >  0 ) {
            // 품목 맥시 시퀀스 값을 글로별 변수에 선언한다.
            g_escsItemSeqn = ds_zfst0200.GetColumn(0, "ESCS_ITEM_CNT");
            dataLoad = "Y";
            dataSort = "N";
            // 권한 체크
            fn_authCtrl();
            ds_zfst0201_detail.RecalcFilter();
            g_mItemCnt = ds_zfst0201_master.GetRowCountNF();
        } else {
            gfn_openMsgWin("존재하지 않는 견적원가번호 입니다.\n견적원가번호를 입력하십시요", "", "A", "");
			ds_cond.SetColumn(0, "ESCS_NUMB", "");
			ds_cond.SetColumn(0, "ESCS_NTIM", "");
        }
    }
}

/********************************************************************************
* 기      능   : 견적원가 버튼 및 권한 체크 로직
********************************************************************************/
function fn_authCtrl()
{
    // 팀구분에 따른 원가 내역 조회 처리
	// 문서상태 030: 견적원가 작성중, 040: 견적원가 결재 중: 050: 견적원가 승인
	var escsStat = ds_zfst0200.GetColumn(0, "ESCS_STAT");
	// 결재상태
	var apprStat = ds_zfst0200.GetColumn(0, "APPR_STAT");
	// 작성자
	var writUser = ds_zfst0200.GetColumn(0, "WRIT_USER");

    if( G_DPT1 != "CD" ) {
        grd_master.Editable = false;
		grd_master.SetCellProp("body", 8, "Expr", "iif(COST>0, '', '')");
		grd_master.SetCellProp("body", 9, "Expr", "iif(SALE_COST>0, '', '')");
		grd_master.SetCellProp("body", 13, "Expr", "iif(MRGN_RATE>0, '', '')");

        grd_detail.Editable = false;
		grd_detail.SetCellProp("body", 9, "Expr", "iif(COST>0, '', '')");
		grd_detail.SetCellProp("body", 12, "Expr", "iif(SALE_COST>0, '', '')");
		grd_detail.SetCellProp("body", 16, "Expr", "iif(MRGN_RATE>0, '', '')");
    }

    if( !(escsStat == "020" || escsStat == "030") ) {
        grd_master.Editable = false;
        grd_detail.Editable = false;
    }

    // 최초 버튼 제어
	btn_approval.Enable = false;        // 승인
	btn_draft.Enable = false;           // 기안
	btn_rewrite.Enable = false;         // 재작성
	btn_delete.Enable = false;          // 삭제
	btn_save.Enable = false;            // 저장
	btn_print.Enable = false;           // 출력
	btn_excel.Enable = false;           // 엑셀
	btn_sendback.Enable = false;        // 반송
	btn_write.Enable = false;           // 예산항목등록
	btn_fileUp.Enable = false;          // 파일등록
	btn_mngrReg.Enable = false;         // 담당자 등록
	btn_basicCode.Enable = false;       // 기준정보
	btn_adocInfo.Enable = false;        // 결재정보
	btn_costCopy.Enable = false;        // 원가복사
	btn_excelUp.Enable = false;         // 엑셀업로드
	btn_rowAdd1.Enable = false;         // 추가
	btn_rowDel1.Enable = false;         // 삭제
	Div0.btn_rowAdd2.Enable = false;    // 추가1
	Div0.btn_rowDel2.Enable = false;    // 삭제1
	Div0.btn_itemCopy.Enable = false;   // 품목복사
	Div0.btn_mtrlAdd.Enable = false;    // 자재복사

    // 물류서비스 팀인 경우
    if( G_DPT1 == "CD" ) {
        if( escsStat == "020" || escsStat == "030" ) {
			btn_draft.Enable = true;           // 기안
			btn_delete.Enable = true;          // 삭제
			btn_save.Enable = true;            // 저장
			btn_print.Enable = true;           // 출력
			btn_excel.Enable = true;           // 엑셀
			btn_write.Enable = true;           // 예산항목등록
			btn_fileUp.Enable = true;          // 파일등록
			btn_mngrReg.Enable = true;         // 담당자 등록
			btn_basicCode.Enable = true;       // 기준정보
			btn_costCopy.Enable = true;        // 원가복사
			btn_excelUp.Enable = true;         // 엑셀업로드
			btn_rowAdd1.Enable = true;         // 추가
			btn_rowDel1.Enable = true;         // 삭제
            grd_detail.Editable = true;
        }

        // 견적원가 반려 상태
        if( escsStat == "020" ) {
			// 결재정보
		    btn_adocInfo.Enable = true;        // 결재정보
        }

        // 견적원가 결재 중
        if( escsStat == "040" ) {
			btn_print.Enable = true;           // 출력
			btn_excel.Enable = true;           // 엑셀
			btn_fileUp.Enable = true;          // 파일등록
			// 문서 상태가 결재 중 일 경우 로그인 사용자가 결재 대상자 인 경우
			var adit = ds_zfst0200.GetColumn(0, "ADIT");
			var appr = ds_zfst0200.GetColumn(0, "APPR");
			var apprStat = ds_zfst0200.GetColumn(0, "APPR_STAT");

			if( G_USER_ID == adit && apprStat == "190" ) {
	            btn_approval.Enable = true;        // 승인
	            btn_sendback.Enable = true;        // 반송
			}

			if( G_USER_ID == appr && apprStat == "290" ) {
	            btn_approval.Enable = true;        // 승인
	            btn_sendback.Enable = true;        // 반송
			}

            // 심사자 정보가 없는 경우 바로 승인 처리
			if( G_USER_ID == appr && adit == "" && apprStat == "190" ) {
	            btn_approval.Enable = true;        // 승인
	            btn_sendback.Enable = true;        // 반송
			}

			// 결재정보
		    btn_adocInfo.Enable = true;        // 결재정보
        }

        // 승인완료 상태
        if( escsStat == "050" ||  escsStat == "060") {
	        btn_rewrite.Enable = true;         // 재작성
			btn_print.Enable = true;           // 출력
			btn_excel.Enable = true;           // 엑셀
			btn_fileUp.Enable = true;          // 파일등록
		    btn_adocInfo.Enable = true;        // 결재정보
        }

        // 견적원가 수주 완료 상태
        if( escsStat == "060" ) {
			btn_print.Enable = true;           // 출력
			btn_excel.Enable = true;           // 엑셀
			btn_fileUp.Enable = true;          // 파일등록
		    btn_adocInfo.Enable = true;        // 결재정보
        }
    }
}

/********************************************************************************
* 기      능   : 재작성
********************************************************************************/
function fn_rewrite() {
	// 문서상태 030: 견적원가 작성중, 040: 견적원가 결재 중: 050: 견적원가 승인
	var escsStat = ds_zfst0200.GetColumn(0, "ESCS_STAT");
    if( !(escsStat == "050" || escsStat == "060") ) {
        gfn_openMsgWin("진행상태가 견적원가승인 또는 견적원가수주완료시에만 재작성할 수 있습니다.", "", "A", "");
        return;
    }

	if( gfn_showConfirm("견적원가를 재작성 하시겠습니까?") ) {
	    var reEscsNtim = toNumber(ds_cond.GetColumn(0, "ESCS_NTIM"))+1;
	    ds_cond.SetColumn(0, "RE_ESCS_NTIM", reEscsNtim);
		tit_clearActionInfo();
		tit_addSingleActionInfo("fs02:FS0201002A_I3");
		tit_addSingleActionInfo("fs02:FS0201002A_I4");
		tit_callService(
						""
					   ,""
					   ,"ds_cond=ds_cond"
					   ,""
					   ,""
					   ,"fn_afterRewrite"
					   ,"true"
					   ,"true"
					   ,"false"
					   );	
	}
}

/********************************************************************************
* 기      능   : 재작성
********************************************************************************/
function fn_afterRewrite() {
    if(ds_error < 0) {
        gfn_showMsg("CE00001");
    } else {
        gfn_openMsgWin("견적원가 재작성 처리가 완료 되었습니다.", "", "A", "");
        ds_cond.SetColumn(0, "ESCS_NTIM", ds_cond.GetColumn(0, "RE_ESCS_NTIM"));
        // 재전송 차수로 견적원가 문서를 재조회한다.
        fn_query();
    }
}

/********************************************************************************
* 기      능   : 삭제
********************************************************************************/
function fn_delete() {
	if( gfn_showConfirm("삭제 하시겠습니까?") ) {
		tit_clearActionInfo();
		tit_addMultiActionInfo("fs02:FS0201002A_D1");
		tit_addMultiActionInfo("fs02:FS0201002A_D2");

		tit_callService(
						""
					   ,""
					   ,"ds_zfst0200=ds_zfst0200"
					   ,""
					   ,""
					   ,"fn_afterDelete"
					   ,"true"
					   ,"true"
					   ,"false"
					   );
	}
}

/********************************************************************************
* 기      능   : 견적원가품목 삭제 Callback
********************************************************************************/
function fn_afterDelete(errCode, errMsg) {
    if(ds_error.rowcount() > 0) {
        gfn_showMsg("CE00001");
    } else {
        gfn_showMsg("CI00003");
        gfn_openMsgWin("견적원가 내역이 삭제 되었습니다.", "", "A", "");
        ds_cond.ClearData();
        ds_cond.AppendRow();
        ds_zfst0200.ClearData();
        ds_zfst0201_list.ClearData();
        ds_zfst0201_master.RecalcFilter();
        ds_zfst0201_detail.RecalcFilter();
    }
}

/********************************************************************************
* 기      능   : 견적원가품목 저장
********************************************************************************/
function fn_save() {
    // 멀티 입력 스크립트
    if( ds_zfst0200.GetUpdate() || ds_zfst0201_list.GetUpdate() || dataSort == "Y" ) {
        if( gfn_showConfirm("저장 하시겠습니까?") ) {
			tit_clearActionInfo();
			if( ds_zfst0201_list.GetUpdate() || dataSort == "Y" ) {
			    // 화면순번 생성
		        ds_zfst0201_list.fireevent = false;
		        //trace("ds_zfst0201_list:"+ds_zfst0201_list.SaveXML());
			    for(var i=0; i < ds_zfst0201_list.GetRowCount(); i++) {
			        ds_zfst0201_list.SetColumn(i, "ESIT_SEQN", i);
			    }
		        ds_zfst0201_list.fireevent = true;
			    tit_addSaveActionInfo("fs02:FS0201002A_I2", "fs02:FS0201002A_U2", "fs02:FS0201002A_D3", "", "", "", "", "");
			}
            // 견적 총금액 반영
            ds_zfst0200.SetColumn(0, "ESCS_TAMT", ds_zfst0201_list.CaseSumNF("ESCS_UPGR=''", "SALE_COST"));
            ds_zfst0200.SetColumn(0, "ESMT_TAMT", ds_zfst0201_list.CaseSumNF("ESCS_UPGR=''", "ESMT_COST"));
            ds_zfst0200.SetColumn(0, "NGTT_TAMT", ds_zfst0201_list.CaseSumNF("ESCS_UPGR=''", "NGTT_ESCS"));
            
            // 시행율
            ds_zfst0200.SetColumn(0, "MRGN_RATE", round(ds_zfst0201_list.CaseSumNF("ESCS_UPGR=''", "SALE_COST")/ds_zfst0201_list.CaseSumNF("ESCS_UPGR=''", "NGTT_ESCS")*100,2));

		    tit_addSingleActionInfo("fs02:FS0201002A_U1");
			tit_callService(
							""
						   ,""
						   ,"ds_zfst0201=ds_zfst0201_list:A ds_zfst0200=ds_zfst0200"
						   ,""
						   ,""
						   ,"fn_afterSave"
						   ,"true"
						   ,"true"
						   ,"false"
						   );
        }
    }
}

/********************************************************************************
* 기      능   : 견적원가품목 저장 Callback
********************************************************************************/
function fn_afterSave(errCode, errMsg) {
    if(ds_error < 0) {
        gfn_showMsg("CE00001");
    } else {
        gfn_showMsg("CI00003");
        gfn_openMsgWin("견적원가 내역이 저장되었습니다.", "", "A", "");
        fn_query();
    }
}

/********************************************************************************
* 기      능   : 기안
********************************************************************************/
function fn_draft()
{
    if(fn_validate()) {
		if( ds_zfst0200.GetUpdate() || ds_zfst0201_list.GetUpdate() || dataSort == "Y" ) {
			gfn_openMsgWin("저장 후 기안 요청을 하십시요.", "", "A", "");
			return false;
		}
		var aDocClas = "EC";
		var aDocNumb = ds_zfst0200.GetColumn(0, "ESCS_NUMB");
		var aDocNtim = ds_zfst0200.GetColumn(0, "ESCS_NTIM");
		var arg="";
		arg="aDocClas="+aDocClas+" aDocNumb="+aDocNumb+" aDocNtim="+aDocNtim+" disableDecide=true";
		var aRtn = null;
		aRtn = gfn_openPopup("FS_COM0701", true, arg);
		if( length(aRtn) > 0 )  {
		    // 결재승인처리가 완료 되었음
		    // 쿼리를 재조회 한 후 버튼의 대한 퀀한을 재 설정한다.
	        gfn_openMsgWin("기안처리가 완료 되었습니다.", "", "A", "");
		    fn_query();
		}
    }
}

/********************************************************************************
* 기      능   : 기안 시 입력값 체크
********************************************************************************/
function fn_validate()
{
    var isValidate = true;
    // 마스터 입력 정보를 체크한다.
    if( ds_zfst0200.GetColumn(0, "KUNNR") == "" ) {
	    gfn_openMsgWin("고객명을 입력하십시요.", "", "A", "");
	    return false;
    }

    if( ds_zfst0200.GetColumn(0, "POST1") == "" ) {
	    gfn_openMsgWin("프로젝트명을 입력하십시요.", "", "A", "");
	    return false;
    }

    if( ds_zfst0200.GetColumn(0, "ORDR_TYPE") == "" ) {
	    gfn_openMsgWin("오더유형을 선택하십시요.", "", "A", "");
	    return false;
    }

    if( ds_zfst0200.GetColumn(0, "ESMT_CNTR") == "" ) {
	    gfn_openMsgWin("국가명을 입력하십시요.", "", "A", "");
	    return false;
    }

    if( ds_zfst0200.GetColumn(0, "SALE_PRSN") == "" ) {
	    gfn_openMsgWin("영업담당자명을 입력하십시요.", "", "A", "");
	    return false;
    }

    // 상위 예산항목 입력값을 체크한다.
    for(var i=0; i < ds_zfst0201_list.GetRowCount(); i++) {
        if( ds_zfst0201_list.GetColumn(i,"ITEM_DIYN") == "M" ) {
			var escsGrop = ds_zfst0201_list.GetColumn(i,"ESCS_GROP");
			var masterfilter = "ITEM_DIYN='M' && ESCS_UPGR="+quote(escsGrop);
			var findRow = ds_zfst0201_list.SearchRow(masterfilter, i+1);
			if( findRow < 0 ) {
				// 세부 품목부터 입력값을 체크한다
				var filterString = "ITEM_DIYN=='D' && ESCS_UPGR == "+quote(escsGrop);
				ds_zfst0201_detail.FilterExpr = filterString;
				var esceName = ds_zfst0201_list.GetColumn(i,"ESCE_NAME");  // 예산항목명
				if( ds_zfst0201_detail.GetRowCount() == 0 ) {
					// 등록된 품목이 존재하지 않습니다.
					gfn_openMsgWin(esceName+"항목에 등록된 견적품목이 없습니다.", "", "A", "");
					var filterString = "ITEM_DIYN=='D' && ESCS_UPGR == ds_zfst0201_master.GetColumn(ds_zfst0201_master.GetRowPos(), 'ESCS_GROP')";
					ds_zfst0201_detail.FilterExpr = filterString;
					return false;
				} else {
					if( ds_zfst0201_list.GetColumn(i,"UNIT") == "" ) {
						gfn_openMsgWin(esceName+"항목의 예산항목 단위를 입력하세요.", "", "A", "");
						var filterString = "ITEM_DIYN=='D' && ESCS_UPGR == ds_zfst0201_master.GetColumn(ds_zfst0201_master.GetRowPos(), 'ESCS_GROP')";
						ds_zfst0201_detail.FilterExpr = filterString;
						return false;
					}

					if( ds_zfst0201_list.GetColumn(i,"QNTY") == 0 ) {
						gfn_openMsgWin(esceName+"항목의 예산항목 수량을 입력하세요.", "", "A", "");
						var filterString = "ITEM_DIYN=='D' && ESCS_UPGR == ds_zfst0201_master.GetColumn(ds_zfst0201_master.GetRowPos(), 'ESCS_GROP')";
						ds_zfst0201_detail.FilterExpr = filterString;
						return false;
					}

					for(var j=0; j < ds_zfst0201_detail.GetRowCount(); j++) {
						// 입력값을 체크한다.
						var unit = ds_zfst0201_detail.GetColumn(j,"UNIT");  // 단위
						var qnty = ds_zfst0201_detail.GetColumn(j,"QNTY");  // 수량
						var cost = ds_zfst0201_detail.GetColumn(j,"COST");  // 단가
						var cost = ds_zfst0201_detail.GetColumn(j,"SALE_COST"); // 견적금액
						var partName = ds_zfst0201_detail.GetColumn(j,"PART_NAME"); // 항목

						if( ds_zfst0201_detail.GetColumn(j,"PART_NAME") == "" ) {
							gfn_openMsgWin(esceName+"항목의 품목 항목을 입력하세요.", "", "A", "");
							var filterString = "ITEM_DIYN=='D' && ESCS_UPGR == ds_zfst0201_master.GetColumn(ds_zfst0201_master.GetRowPos(), 'ESCS_GROP')";
							ds_zfst0201_detail.FilterExpr = filterString;
							return false;
						}

						if( ds_zfst0201_detail.GetColumn(j,"UNIT") == "" ) {
							gfn_openMsgWin(esceName+"항목의 품목 단위을 입력하세요.", "", "A", "");
							var filterString = "ITEM_DIYN=='D' && ESCS_UPGR == ds_zfst0201_master.GetColumn(ds_zfst0201_master.GetRowPos(), 'ESCS_GROP')";
							ds_zfst0201_detail.FilterExpr = filterString;
							return false;
						}

						if( ds_zfst0201_detail.GetColumn(j,"QNTY") == 0 ) {
							gfn_openMsgWin(esceName+"항목의 품목 수량을 입력하세요.", "", "A", "");
							var filterString = "ITEM_DIYN=='D' && ESCS_UPGR == ds_zfst0201_master.GetColumn(ds_zfst0201_master.GetRowPos(), 'ESCS_GROP')";
							ds_zfst0201_detail.FilterExpr = filterString;
							return false;
						}

						if( ds_zfst0201_detail.GetColumn(j,"COST") == 0 ) {
							gfn_openMsgWin(esceName+"항목의 품목 단가를 입력하세요.", "", "A", "");
							var filterString = "ITEM_DIYN=='D' && ESCS_UPGR == ds_zfst0201_master.GetColumn(ds_zfst0201_master.GetRowPos(), 'ESCS_GROP')";
							ds_zfst0201_detail.FilterExpr = filterString;
							return false;
						}

						if( ds_zfst0201_detail.GetColumn(j,"SALE_COST") == 0 ) {
							gfn_openMsgWin(esceName+"항목의 품목 견적금액을 입력하세요.", "", "A", "");
							var filterString = "ITEM_DIYN=='D' && ESCS_UPGR == ds_zfst0201_master.GetColumn(ds_zfst0201_master.GetRowPos(), 'ESCS_GROP')";
							ds_zfst0201_detail.FilterExpr = filterString;
							return false;
						}
					}
				}
			}
        }
    }

	var filterString = "ITEM_DIYN=='D' && ESCS_UPGR == ds_zfst0201_master.GetColumn(ds_zfst0201_master.GetRowPos(), 'ESCS_GROP')";
	ds_zfst0201_detail.FilterExpr = filterString;
    return isValidate;
}

/********************************************************************************
* 기      능   : 결재승인
********************************************************************************/
function fn_approval()
{
	if( gfn_showConfirm("결재 승인 처리 하시겠습니까?") ) {
        ds_doc_appr.fireevent = false;
	    ds_doc_appr.SetColumn(0, "ADOC_CLAS", "EC");
	    ds_doc_appr.SetColumn(0, "ADOC_NUMB", ds_zfst0200.GetColumn(0, "ESCS_NUMB"));
	    ds_doc_appr.SetColumn(0, "ADOC_NTIM", ds_zfst0200.GetColumn(0, "ESCS_NTIM"));
		var adit = ds_zfst0200.GetColumn(0, "ADIT");
		var appr = ds_zfst0200.GetColumn(0, "APPR");
		var apprStat = ds_zfst0200.GetColumn(0, "APPR_STAT");
		if( G_USER_ID == adit ) {
            ds_doc_appr.SetColumn(0, "APPR_STAT", "290");  // 심사완료
		}
		if( G_USER_ID == appr) {
            ds_doc_appr.SetColumn(0, "APPR_STAT", "390");  // 승인완료
		}
	    ds_doc_appr.fireevent = true;

		tit_clearActionInfo();
		tit_addSingleActionInfo("fs01:FS_COM0701_M2");  // 결재 테이블 상태값 처리
		if( G_USER_ID == appr) {
		    tit_addSingleActionInfo("fs01:FS_COM0701_U1");  // 견적원가 문서 상태값 처리
		}
		tit_callService(
						""
					   ,""
					   ,"ds_doc_appr=ds_doc_appr ds_doc_stat=ds_doc_appr"
					   ,""
					   ,""
					   ,"fn_approvalCallback"
					   ,"true"
					   ,"true"
					   ,"false"
					   );
    }
}

/********************************************************************************
* 기      능   : 결재승인
********************************************************************************/
function fn_approvalCallback()
{
    if(ds_error< 0) {
        gfn_showMsg("CE00001");
    } else {
        gfn_openMsgWin("결재 승인처리가 완료 되었습니다.", "", "A", "");
	    fn_query();
    }
}

/********************************************************************************
* 기      능   : 반송
********************************************************************************/
function fn_sendback() {
	var aDocClas = "EC";
	var aDocNumb = ds_zfst0200.GetColumn(0, "ESCS_NUMB");
	var aDocNtim = ds_zfst0200.GetColumn(0, "ESCS_NTIM");
	var arg="";
	arg="aDocClas="+aDocClas+" aDocNumb="+aDocNumb+" aDocNtim="+aDocNtim;
	var aRtn = null;
    aRtn = gfn_openPopup("FS_COM0703", true, arg);
    if( length(aRtn) > 0 )  {
		// 결재 반송 처리가 완료 되었음
		// 쿼리를 재조회 한 후 버튼의 대한 퀀한을 재 설정한다.
		gfn_openMsgWin("반송 처리 되었습니다.", "", "A", "");
		fn_query();
	}
}

/********************************************************************************
* 기      능   : 액셀
********************************************************************************/
function fn_excel() {
    ds_zfst0201_excel.ClearData();
    ds_zfst0201_excel.Copy(ds_zfst0201_list);
    gfn_saveToExcel(excel_grid, true, "", "", false, true);
}

/********************************************************************************
* 기      능   : 출력
********************************************************************************/
function fn_print() {
    var arg="";
    Dialog("CS01::FS0201001D.xml", "");
}

/********************************************************************************
* 기      능   : 닫기
********************************************************************************/
function fn_close() {
    if( ds_zfst0200.GetUpdate() ) {
        if( gfn_showConfirm("저장처리 없이 종료하시겠습니까?") ) {
            close();
        } else {
            return;
        }
    }

    if( ds_zfst0201_list.GetUpdate() ) {
        if( gfn_showConfirm("저장처리 없이 종료하시겠습니까?") ) {
            close();
        } else {
            return;
        }
    }

    close();
}

/********************************************************************************
* 기      능   : 사업년도별 기준정보 팝업을 호출한다.
********************************************************************************/
function btn_basic_info_OnClick(obj)
{
    var year = substr(gfn_getCurrDate(),0,4);
    var arg="bsnsYear="+quote(year);
    gfn_openPopup("FS0102001B", true, arg);
}

/********************************************************************************
* 기      능   : 원가 복사 팝업을 호출한다.
********************************************************************************/
function btn_price_copy_OnClick(obj)
{
    if( g_mItemCnt != ds_zfst0201_master.GetRowCountNF() ) {
        gfn_openMsgWin("변경된 예산항목 리스트 저장 후에 원가 복사 팝업을 실행할 수 있습니다.", "", "A", "");
        return;
    }

    var arg="";
    arg="kunnr="+quote(ds_zfst0200.GetColumn(0, "KUNNR"));
    arg = arg +" kunnrName="+quote(ds_zfst0200.GetColumn(0, "KUNNR_NAME"));
    arg = arg +" escsNumb="+quote(ds_cond.GetColumn(0, "ESCS_NUMB"));
    arg = arg +" escsNtim="+quote(ds_cond.GetColumn(0, "ESCS_NTIM"));
    ds_copy_list.ClearData();
    gfn_openPopup2("FS0201002B", true, arg, 1, 1, "AutoSize=true Resize=true CloseFlag=false");
}

/********************************************************************************
* 기      능   : Row 복사 시작
********************************************************************************/
function fn_rowCopyStart()
{
    ds_zfst0201_list.fireevent = false;
    ds_copy_list.fireevent = false;
	grd_detail.Redraw = false;
	grd_master.Redraw = false;
}

/********************************************************************************
* 기      능   : 마스터 예산항목 존재여부 확인
********************************************************************************/
function fn_masterRow(extnEscs) {
	return ds_zfst0201_list.SearchRow("ITEM_DIYN='M' && EXTN_ESCS='"+extnEscs+"'");
}

/********************************************************************************
* 기      능   : 마스터 예산항목 생성 ESCS_GROP, ESCS_ITEM, EXTN_ESCS, ESCE_NAME
********************************************************************************/
function fn_createFirstMasterRow(escsGrop, escsItem, extnEscs, esceName) {
    var mRow = 0;
    var iRow = 0;
    mRow = ds_zfst0201_list.SearchRow("ITEM_DIYN='M' && ESCS_ITEM='"+escsItem+"'");
    iRow = ds_zfst0201_list.InsertRow( mRow+1 );
    ds_zfst0201_list.SetColumn(iRow, "FLAG", "1");
    ds_zfst0201_list.SetColumn(iRow, "LEVEL", toNumber(ds_zfst0201_list.GetColumn(mRow, "LEVEL"))+1);
    ds_zfst0201_list.SetColumn(iRow, "ESCS_UPGR", ds_zfst0201_list.GetColumn(mRow, "ESCS_GROP"));
    ds_zfst0201_list.SetColumn(iRow, "ESCS_GROP", Timem()+iRow);
    ds_zfst0201_list.SetColumn(iRow, "CHK", "");
	ds_zfst0201_list.SetColumn(iRow, "ESCS_NUMB", ds_zfst0200.GetColumn(0, "ESCS_NUMB"));
	ds_zfst0201_list.SetColumn(iRow, "ESCS_NTIM", ds_zfst0200.GetColumn(0, "ESCS_NTIM"));
	ds_zfst0201_list.SetColumn(iRow, "ESCS_ITEM", escsItem);
	ds_zfst0201_list.SetColumn(iRow, "EXTN_ESCS", extnEscs);
	ds_zfst0201_list.SetColumn(iRow, "ITEM_DIYN", "M");
	ds_zfst0201_list.SetColumn(iRow, "ESCE_NAME", esceName);
    return iRow;
}

/********************************************************************************
* 기      능   : 마스터 예산항목 생성 ESCS_GROP, ESCS_ITEM, EXTN_ESCS, ESCE_NAME
********************************************************************************/
function fn_createNextMasterRow(mRow, escsGrop, escsItem, extnEscs, esceName) {
    var iRow = 0;
    iRow = ds_zfst0201_list.InsertRow( mRow+1 );
    ds_zfst0201_list.SetColumn(iRow, "FLAG", "1");
    ds_zfst0201_list.SetColumn(iRow, "LEVEL", toNumber(ds_zfst0201_list.GetColumn(mRow, "LEVEL"))+1);
    ds_zfst0201_list.SetColumn(iRow, "ESCS_UPGR", ds_zfst0201_list.GetColumn(mRow, "ESCS_GROP"));
    ds_zfst0201_list.SetColumn(iRow, "ESCS_GROP", Timem()+iRow);
    ds_zfst0201_list.SetColumn(iRow, "CHK", "");
	ds_zfst0201_list.SetColumn(iRow, "ESCS_NUMB", ds_zfst0200.GetColumn(0, "ESCS_NUMB"));
	ds_zfst0201_list.SetColumn(iRow, "ESCS_NTIM", ds_zfst0200.GetColumn(0, "ESCS_NTIM"));
	ds_zfst0201_list.SetColumn(iRow, "ESCS_ITEM", escsItem);
	ds_zfst0201_list.SetColumn(iRow, "EXTN_ESCS", extnEscs);
	ds_zfst0201_list.SetColumn(iRow, "ITEM_DIYN", "M");
	ds_zfst0201_list.SetColumn(iRow, "ESCE_NAME", esceName);
    return iRow;
}

/********************************************************************************
* 기      능   : Row 단위 품목 추가
********************************************************************************/
function fn_rowCopy(nMRowNF, EXTN_ESCS, MTRL_NUMB, PART_NAME, STAD, UNIT, QNTY, WAERK, UKURS, COST, ICDT_EPNS, IDRT_COST, SALE_COST, NGTT_ESCS, ESMT_CMPY, NOTE, MTRL_DIVS)
{
	var sid = ds_zfst0201_list.GetColumn( nMRowNF, "ESCS_GROP" );
	var level = ds_zfst0201_list.GetColumn( nMRowNF, "LEVEL" );
	var escsItem = ds_zfst0201_list.GetColumn( nMRowNF, "ESCS_ITEM" );
	var extnEscs = ds_zfst0201_list.GetColumn( nMRowNF, "EXTN_ESCS" );

	var filterString = "ITEM_DIYN='D' && EXTN_ESCS='"+EXTN_ESCS+"'";
	ds_zfst0201_list.FilterExpr = filterString;
	var rowCnt = ds_zfst0201_list.GetRowCount();
	var nDRowCnt = nMRowNF + rowCnt + 1;
	ds_zfst0201_list.FilterExpr = "";
	ds_zfst0201_list.UnFilter();

	var iRow = ds_zfst0201_list.InsertRow( nDRowCnt );
	// 키값 입력
	ds_zfst0201_list.SetColumn(iRow, "ESCS_NUMB", ds_zfst0201_list.GetColumn(nMRowNF, "ESCS_NUMB"));
	ds_zfst0201_list.SetColumn(iRow, "ESCS_NTIM", ds_zfst0201_list.GetColumn(nMRowNF, "ESCS_NTIM"));
	//ds_zfst0201_list.SetColumn(iRow, "ESCE_NAME", ds_zfst0201_list.GetColumn(nMRowNF, "ESCE_NAME"));
	ds_zfst0201_list.SetColumn(iRow, "ESCS_ITEM", escsItem);
	ds_zfst0201_list.SetColumn(iRow, "EXTN_ESCS", extnEscs);
	ds_zfst0201_list.SetColumn(iRow, "ESCS_GROP", Timem()+iRow);
	ds_zfst0201_list.SetColumn(iRow, "ESCS_UPGR", sid);
	ds_zfst0201_list.SetColumn(iRow, "LEVEL", parseInt( level ) + 1);
	ds_zfst0201_list.SetColumn(iRow, "ITEM_DIYN", "D");

	// 선택 항목 복사
	ds_zfst0201_list.SetColumn(iRow, "MTRL_NUMB", MTRL_NUMB);
	ds_zfst0201_list.SetColumn(iRow, "PART_NAME", PART_NAME);
	ds_zfst0201_list.SetColumn(iRow, "STAD", STAD);
	ds_zfst0201_list.SetColumn(iRow, "UNIT", UNIT);
	ds_zfst0201_list.SetColumn(iRow, "QNTY", QNTY);
	ds_zfst0201_list.SetColumn(iRow, "WAERK", WAERK);
	ds_zfst0201_list.SetColumn(iRow, "UKURS", UKURS);
	ds_zfst0201_list.SetColumn(iRow, "COST", COST);
	ds_zfst0201_list.SetColumn(iRow, "ICDT_EPNS", ICDT_EPNS);
	ds_zfst0201_list.SetColumn(iRow, "IDRT_COST", IDRT_COST);
	ds_zfst0201_list.SetColumn(iRow, "SALE_COST", SALE_COST);
	ds_zfst0201_list.SetColumn(iRow, "ESMT_COST", NGTT_ESCS);
	ds_zfst0201_list.SetColumn(iRow, "NGTT_ESCS", NGTT_ESCS);
	ds_zfst0201_list.SetColumn(iRow, "PRES_COST", NGTT_ESCS);
	ds_zfst0201_list.SetColumn(iRow, "ESMT_CMPY", ESMT_CMPY);
    ds_zfst0201_list.SetColumn(iRow, "NOTE", NOTE);
    ds_zfst0201_list.SetColumn(iRow, "MTRL_DIVS", MTRL_DIVS);
	var saleCost = ds_zfst0201_list.GetColumn(iRow, "SALE_COST");
	var esmtCost = ds_zfst0201_list.GetColumn(iRow, "ESMT_COST");
	var ngttEscs = ds_zfst0201_list.GetColumn(iRow, "NGTT_ESCS");
	// 시행율 계산
	if( saleCost > 0 && esmtCost > 0 && ngttEscs > 0 ) {
		var mrgnRate = fn_mrgnRateCalu(saleCost, esmtCost);
		ds_zfst0201_list.SetColumn(iRow, "MRGN_RATE", mrgnRate);
	}

	// copy 기준 정보 등록
	var findRow = ds_copy_list.FindRow("EXTN_ESCS", extnEscs);
	if( findRow > -1 ) {
	    ds_copy_list.SetColumn(findRow, "SALE_COST", SALE_COST+toNumber(ds_copy_list.GetColumn(findRow, "SALE_COST")));
	    ds_copy_list.SetColumn(findRow, "ESMT_COST", NGTT_ESCS+toNumber(ds_copy_list.GetColumn(findRow, "ESMT_COST")));
	    ds_copy_list.SetColumn(findRow, "PRES_COST", NGTT_ESCS+toNumber(ds_copy_list.GetColumn(findRow, "PRES_COST")));
	} else {
	    var iCopyRow = ds_copy_list.AppendRow();
	    ds_copy_list.SetColumn(iCopyRow, "EXTN_ESCS", extnEscs);
	    ds_copy_list.SetColumn(iCopyRow, "ESCS_GROP", sid);
	    ds_copy_list.SetColumn(iCopyRow, "SALE_COST", SALE_COST);
	    ds_copy_list.SetColumn(iCopyRow, "ESMT_COST", NGTT_ESCS);
	    ds_copy_list.SetColumn(iCopyRow, "PRES_COST", NGTT_ESCS);
	}
}

/********************************************************************************
* 기      능   : 합계 처리 로직 수행 - 이벤트 단위 기준으로 동작 시 이벤트 문제로 개별 총계 계산 로직 수행함
********************************************************************************/
function fn_rowCopySum()
{
    //trace("ds_copy_list:"+ds_copy_list.SaveXML());
    for(var i=0; i < ds_copy_list.GetRowCount(); i++) {
        var escsGrop = ds_copy_list.GetColumn(i, "ESCS_GROP");
        var nMRowNF = ds_zfst0201_list.FindRow("ESCS_GROP", escsGrop);
        var saleCostSum = ds_copy_list.GetColumn(i, "SALE_COST"); // 원가
        var esmtCostSum = ds_copy_list.GetColumn(i, "ESMT_COST"); // 견적금액 NGTT_ESCS(네고금액)
        var presCostSum = ds_copy_list.GetColumn(i, "PRES_COST"); // 이전견적금액
        fn_getUpgrRowNum(nMRowNF, saleCostSum, esmtCostSum, presCostSum);
    }
}

/********************************************************************************
* 기      능   : 상위키 계산 로직을 처리한다.
********************************************************************************/
function fn_getUpgrRowNum(uRow, saleCostSum, esmtCostSum, presCostSum)
{
    if( uRow > -1 ) {
        // 계산로직 수행 후
        fn_setColumCal(uRow, saleCostSum, esmtCostSum, presCostSum);

        // 해당 함수 재 호출
        var nURow = ds_zfst0201_list.FindRow("ESCS_GROP", ds_zfst0201_list.GetColumn(uRow, "ESCS_UPGR"));
        fn_getUpgrRowNum(nURow, saleCostSum, esmtCostSum, presCostSum);
    }
}

/********************************************************************************
* 기      능   : 상위키 계산 로직을 처리한다.
********************************************************************************/
function fn_setColumCal(uRow, saleCostSum, esmtCostSum, presCostSum) {
    var saleCostSumTmp = 0;
    var esmtCostSumTmp = 0;
    var presCostSumTmp = 0;
	saleCostSumTmp = saleCostSum + toNumber(ds_zfst0201_list.GetColumn(uRow, "SALE_COST"));
	esmtCostSumTmp = esmtCostSum + toNumber(ds_zfst0201_list.GetColumn(uRow, "ESMT_COST"));
	presCostSumTmp = presCostSum + toNumber(ds_zfst0201_list.GetColumn(uRow, "PRES_COST"));

	ds_zfst0201_list.SetColumn(uRow, "SALE_COST", saleCostSumTmp);
	ds_zfst0201_list.SetColumn(uRow, "ESMT_COST", esmtCostSumTmp);
	ds_zfst0201_list.SetColumn(uRow, "NGTT_ESCS", esmtCostSumTmp);
	ds_zfst0201_list.SetColumn(uRow, "PRES_COST", presCostSumTmp);

	// QNTY, COST
	var qnty = ds_zfst0201_list.GetColumn(uRow, "QNTY");
	var cost = 0;
	if( qnty > 0 ) {
	    cost = round(esmtCostSum/qnty,2);
	    ds_zfst0201_list.SetColumn(uRow, "COST", cost);
	}
}

/********************************************************************************
* 기      능   : Row 복사 종료
********************************************************************************/
function fn_rowCopyEnd()
{
    var filterString = "ITEM_DIYN=='D' && ESCS_UPGR == ds_zfst0201_master.GetColumn(ds_zfst0201_master.GetRowPos(), 'ESCS_GROP')";
    ds_zfst0201_detail.FilterExpr = filterString;
    ds_zfst0201_master.row = 0;
	ds_zfst0201_master.RecalcFilter();
	ds_zfst0201_detail.RecalcFilter();

	// 전체 필터값 초기화
	for(var i=0; i < ds_zfst0201_list.GetRowCount(); i++) {
		ds_zfst0201_list.SetColumn(i, "FLAG", "1");
	}

	grd_detail.Redraw = true;
	grd_master.Redraw = true;
    ds_copy_list.fireevent = true;
    ds_zfst0201_list.fireevent = true;
}

/********************************************************************************
* 기      능   : 원가 엑셀 업로드 화면을 호출한다.
********************************************************************************/
function btn_price_upload_OnClick(obj)
{
    if( g_mItemCnt != ds_zfst0201_master.GetRowCountNF() ) {
        gfn_openMsgWin("변경된 예산항목 리스트 저장 후에 엑셀업로드를 실행할 수 있습니다.", "", "A", "");
        return;
    }

    // 엑셀양식 다운로드 데이터 셑을 생성한다.
    ds_zfst0201_excel.ClearData();
	var filterString = "ITEM_DIYN='M'";
	ds_zfst0201_list.FilterExpr = filterString;
	ds_zfst0201_excel.fireevent = false;
    for(var i=0; i < ds_zfst0201_list.GetRowCount(); i++) {
        var escsGrop = ds_zfst0201_list.GetColumn(i,"ESCS_GROP");
        var findRow = ds_zfst0201_list.FindRow("ESCS_UPGR", escsGrop);
        // 하위 단계가 없는 예산 항목
        if( findRow < 0 ) {
            var nRow = ds_zfst0201_excel.AppendRow();
            ds_zfst0201_excel.SetColumn(nRow, "EXTN_ESCS", ds_zfst0201_list.GetColumn(i,"EXTN_ESCS"));
            ds_zfst0201_excel.SetColumn(nRow, "ESCE_NAME", ds_zfst0201_list.GetColumn(i-1,"ESCE_NAME")+":"+ds_zfst0201_list.GetColumn(i,"ESCE_NAME"));
        }
    }
	ds_zfst0201_excel.fireevent = true;
	ds_zfst0201_list.FilterExpr = "";
	ds_zfst0201_list.UnFilter();

    var arg="";
    arg = "escsNumb="+quote(ds_cond.GetColumn(0, "ESCS_NUMB"))+" escsNtim="+quote(ds_cond.GetColumn(0, "ESCS_NTIM"));
    gfn_openPopup2("FS0201002C", true, arg, 1, 1, "AutoSize=true Resize=true CloseFlag=false");
}

/********************************************************************************
* 기      능   : 원가 품목 복사 화면을 호출한다.
********************************************************************************/
function btn_item_copy_OnClick(obj)
{
    var arg="";
    var arg="kunnr="+quote(ds_zfst0200.GetColumn(0, "KUNNR"));
    arg = arg +" kunnrName="+quote(ds_zfst0200.GetColumn(0, "KUNNR_NAME"));
    arg = arg +" escsNumb="+quote(ds_cond.GetColumn(0, "ESCS_NUMB"));
    arg = arg +" escsNtim="+quote(ds_cond.GetColumn(0, "ESCS_NTIM"));
    arg = arg +" escsItem="+quote(ds_zfst0201_master.GetColumn(ds_zfst0201_master.currow, "ESCS_ITEM"));
    arg = arg +" extnEscs="+quote(ds_zfst0201_master.GetColumn(ds_zfst0201_master.currow, "EXTN_ESCS"));
    arg = arg +" esceName="+quote(ds_zfst0201_master.GetColumn(ds_zfst0201_master.currow, "ESCE_NAME"));
    gfn_openPopup2("FS0201002D", true, arg, 1, 1, "AutoSize=true Resize=true CloseFlag=false");
}

/********************************************************************************
* 기      능   : 자재복사 화면을 호출한다.
********************************************************************************/
function btn_material_add_OnClick(obj)
{
    var arg="";
    arg = arg +" extnEscs="+quote(ds_zfst0201_master.GetColumn(ds_zfst0201_master.currow, "EXTN_ESCS"));
    arg = arg +" esceName="+quote(ds_zfst0201_master.GetColumn(ds_zfst0201_master.currow, "ESCE_NAME"));
    gfn_openPopup2("FS_COM0401", true, arg, 1, 1, "AutoSize=true Resize=true CloseFlag=false");
}

/********************************************************************************
* 기      능   : 견적원가 조회 팝업을 후출한다.
********************************************************************************/
function btn_budget_num_OnClick(obj)
{
    var arg="";
    var arr=null;
    arr = gfn_openPopup("FS0201001B", true, arg);
    if( length(arr) > 0 ) {
		ds_cond.SetColumn(0, "ESCS_NUMB", arr[0]);
		ds_cond.SetColumn(0, "ESCS_NTIM", arr[1]);
		fn_query();
    }
}

/********************************************************************************
* 기      능   : 결재정보 팝업을 호출한다.
********************************************************************************/
function btn_appr_info_OnClick(obj)
{
    var aDocClas = "EC";
    var aDocNumb = ds_zfst0200.GetColumn(0, "ESCS_NUMB");
    var aDocNtim = ds_zfst0200.GetColumn(0, "ESCS_NTIM");
    var arg="aDocClas="+aDocClas+" aDocNumb="+aDocNumb+" aDocNtim="+aDocNtim;
    var aRtn= null;
    aRtn = gfn_openPopup("FS_COM0702", true, arg);
	if( length(aRtn) > 0 )  {
		// 결재승인처리가 완료 되었음
		// 쿼리를 재조회 한 후 버튼의 대한 퀀한을 재 설정한다.
		gfn_openMsgWin("기안취소가 완료 되었습니다.", "", "A", "");
		fn_query();
	}
}

/********************************************************************************
* 기      능   : 파일업로드 팝업을 호출한다.
********************************************************************************/
function btn_fileUp_OnClick(obj)
{
    var arg="";
    arg = arg +" escsNumb="+quote(ds_cond.GetColumn(0, "ESCS_NUMB"));
    arg = arg +" escsNtim="+quote(ds_cond.GetColumn(0, "ESCS_NTIM"));
    arg = arg +" escsStat="+quote(ds_zfst0200.GetColumn(0, "ESCS_STAT"));
    arg = arg +" apprStat="+quote(ds_zfst0200.GetColumn(0, "APPR_STAT"));
    arg = arg +" writUser="+quote(ds_zfst0200.GetColumn(0, "WRIT_USER"));
    arg = arg +" modiUser="+quote(ds_zfst0200.GetColumn(0, "MODI_USER"));
    gfn_openPopup("FS0201002E", true, arg);
}

/********************************************************************************
* 기      능   : 담당자등록 팝업을 호출한다.
********************************************************************************/
function btn_person_OnClick(obj)
{
    if( dataLoad == "Y" ) {
		var arg = "";
		arg = "adocClas="+quote("EC")+" adocNumb ="+quote(ds_cond.GetColumn(0, "ESCS_NUMB"));
		gfn_openPopup("FS0103001B", true, arg);
    }
}

/********************************************************************************
* 기      능   : 견적원가 항목등록 팝업을 호출한다.
********************************************************************************/
function btn_write_OnClick(obj)
{
	if( fn_escsCreate() ) {
		fn_query();
	}
}

/********************************************************************************
* 기      능   : 견적원가 항목등록 팝업을 호출한다.
********************************************************************************/
function fn_escsCreate()
{
    var arg="";
	var arr=null;
	if( dataLoad == "N" ) {
	    arg = "escsNumb='' escsNtim=''";
		arr = gfn_openPopup("FS0201002F", true, arg);
		if( length(arr) > 0 ) {
		    ds_cond.SetColumn(0, "ESCS_NUMB", arr[0]);
		    ds_cond.SetColumn(0, "ESCS_NTIM", arr[1]);
			return true;
		} else {
			return false;
		}
	} else {
	    arg = "escsNumb="+quote(ds_cond.GetColumn(0, "ESCS_NUMB"))+" escsNtim="+quote(ds_cond.GetColumn(0, "ESCS_NTIM"));
	    arr = gfn_openPopup("FS0201002F", true, arg);
	    // 추가된 데이터에 대해서 예산 항목을 Add한다.
	    if( length(arr) > 0 ) {
			return true;
		} else {
			return false;
		}
	}
}

/********************************************************************************
* 기      능   : 고객정보 팝업을 호출한다.
********************************************************************************/
function btn_cusnName_OnClick(obj)
{
	var arg="";
	var arr=null;
    arr = gfn_openPopup("FS_COM0201", true, arg);
    ds_zfst0200.fireevent = false;
    if( length(arr) > 0 )  {
        ds_zfst0200.SetColumn(0, "KUNNR", arr[0]);
        ds_zfst0200.SetColumn(0, "KUNNR_NAME", arr[1]);
    }
    ds_zfst0200.fireevent = true;
}

/********************************************************************************
* 기      능   : 국가코드 팝업을 호출한다.
********************************************************************************/
function btn_cntrCode_OnClick(obj)
{
	var arg="";
	var arr = null;
    arr = gfn_openPopup("FS_COM0901", true, arg);
    ds_zfst0200.fireevent = false;
    if( length(arr) > 0 )  {
        ds_zfst0200.SetColumn(0, "ESMT_CNTR", arr[0]);
        ds_zfst0200.SetColumn(0, "ESMT_CNTR_NAME", arr[1]);
    }
    ds_zfst0200.fireevent = true;
}

/********************************************************************************
* 기      능   : 담당자 팝업을 호출한다.
********************************************************************************/
function btn_salePrsn_OnClick(obj)
{
	var arg="";
	var arr=null;
    arr = gfn_openPopup("FS_COM0801", true, arg);
    ds_zfst0200.fireevent = false;
    if( length(arr) > 0 )  {
        ds_zfst0200.SetColumn(0, "SALE_PRSN", arr[0]);
        ds_zfst0200.SetColumn(0, "SALE_PRSN_NAME", arr[1]);
    }
    ds_zfst0200.fireevent = true;
}

/********************************************************************************
* 기      능   : 접기 와 펼치기
********************************************************************************/
function grd_master_OnCellClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
	var columnID = obj.GetCellProp("body",nCell,"colid");
	var value = obj.GetCellValue(nRow, nCell);
	switch ( columnID ) {
	case "CHK":
		gfn_DrillDownCheckBox(obj, nRow);
		break;
	case "FLAG":
		ds_zfst0201_master.SetColumn(nRow, columnID, iif( value == '1' , '0', '1' ));
		ds_zfst0201_master.RecalcFilter();
		break;
	}
}

/********************************************************************************
* 기      능   : 상세조회
********************************************************************************/
function grd_master_OnCellPosChanged(obj,nRow,nCell,nOldRow,nOldCell,nPivotIndex,nOldPivotIndex)
{
    // 만약에 선택된 데이터 셑의 pis아래 부모코드로 pid가 정의되어 있으면 버튼을 disable 처리한다.
   	//var nMRowNF = ds_zfst0201_master.GetRowIndexNF(nRow);
   	var escsGrop = ds_zfst0201_master.GetColumn(nRow, "ESCS_GROP");
   	var filterString = "ESCS_UPGR="+quote(escsGrop)+" && ITEM_DIYN='M'";
   	var findRow = ds_zfst0201_master.SearchRow(filterString, nRow+1);
   	if( findRow > -1 ) {
		Div0.btn_rowAdd2.Enable = false;
		Div0.btn_rowDel2.Enable = false;
		Div0.btn_itemCopy.Enable = false;
		Div0.btn_mtrlAdd.Enable = false;
   	} else {
        // 부서 권한이 있는 경우
        // 문서상태 030: 견적원가 작성중, 040: 견적원가 결재 중: 050: 견적원가 승인
        var escsStat = ds_zfst0200.GetColumn(0, "ESCS_STAT");
        if( G_DPT1 == "CD" && ( escsStat == "020" || escsStat == "030") ) {
			Div0.btn_rowAdd2.Enable = true;
			Div0.btn_rowDel2.Enable = true;
			Div0.btn_itemCopy.Enable = true;
			Div0.btn_mtrlAdd.Enable = true;
        }
   	}
	ds_zfst0201_detail.RecalcFilter();
	fn_grdItemCtl(ds_zfst0201_master.GetColumn(nRow, "ESCS_ITEM"));
}

/********************************************************************************
* 기      능   : 직접비/간접시 기준원 사이즈 조절
********************************************************************************/
function fn_grdItemCtl(escsItem)
{
    if( indexOf(escsItem, "Z00") > -1 ) {
        // 간접비 입력항목만 그리드로 표현한다.
        if( g_gType == "1" ) {
			Div0.btn_itemCopy.Enable = false;
			Div0.btn_mtrlAdd.Enable = false;
            // 특정 컬럼에 사이즈 제거
            grd_detail.SetColProp(2,"Width", 0);  // 자재번호
            grd_detail.SetColProp(10,"Width", 0); // 수입부대
            grd_detail.SetColProp(15,"Width", 0); // 이전견적금액
            grd_detail.SetColProp(17,"Width", 0); // 견적업체명
            g_gType = "2";
        }
    } else {
        if( g_gType == "2" ) {
            // 그리드 사이즈 원복
            for(var i=0; i < g_widthArray.length; i++) {
                grd_detail.SetColProp(i,"Width", g_widthArray[i]);
            }
            g_gType = "1";
        }
    }
}

/********************************************************************************
* 기      능   : 견적원가 마스터 추가
********************************************************************************/
function btn_rowAdd1_OnClick(obj)
{
	if (ds_zfst0201_master.currow >= 0) {
	    var iDCnt = ds_zfst0201_detail.GetRowCount();
	    if( iDCnt > 0 ) {
            gfn_openMsgWin("등록된 품목이 존재하면 원가 항목을 추가 할 수 없습니다.", "", "A", "");
	    } else {
		    var iRow = gfn_DrillDownAddRow(grd_master, ds_zfst0201_master.currow, true, Timem(), "fn_addRowCallback" );
	    }
	}
}

/********************************************************************************
* 기      능   : 견적원가 마스터 추가 callback
********************************************************************************/
function fn_addRowCallback(iRow, oNewSid)
{
	// 시퀀스 코드를 생성한다.
	g_escsItemSeqn = toNumber(g_escsItemSeqn) + 1;
	var escsItem = gfn_fsFillZero(g_escsItemSeqn, 12);
	var extnEscs = "000000000000000000000";
	var bugtCode = "000000000";
	var newExtnEscs = "000000000000000000000";
    var escsGrop = ds_zfst0201_list.GetColumn(iRow, "ESCS_UPGR");
    if( length(escsGrop) > 0 ) {
	    var findRow = ds_zfst0201_list.FindRow("ESCS_GROP", escsGrop);
        bugtCode = ds_zfst0201_list.GetColumn(findRow, "ESCS_ITEM");
        newExtnEscs = bugtCode + escsItem;
	}
	ds_zfst0201_list.SetColumn(iRow, "ESCS_NUMB", ds_zfst0200.GetColumn(0, "ESCS_NUMB"));
	ds_zfst0201_list.SetColumn(iRow, "ESCS_NTIM", ds_zfst0200.GetColumn(0, "ESCS_NTIM"));

	ds_zfst0201_list.SetColumn(iRow, "ESCS_ITEM", bugtCode);
	ds_zfst0201_list.SetColumn(iRow, "EXTN_ESCS", newExtnEscs);
	ds_zfst0201_list.SetColumn(iRow, "ITEM_DIYN", "M");
	ds_zfst0201_list.SetColumn(iRow, "ESCE_NAME", "견적원가항목입력");
}

/******************************************************
* 기      능   : 견적원가 마스터 삭제
********************************************************************************/
function btn_rowDel1_OnClick(obj)
{
	if (ds_zfst0201_master.currow >= 0){
		gfn_DrillDownDeleteRow(grd_master, ds_zfst0201_master.currow);
	}
}

/********************************************************************************
* 기      능   : 견적원가 품목 추가
********************************************************************************/
function Div0_btn_rowAdd2_OnClick(obj)
{
	if ( ds_zfst0201_master.firstrow < 0 ) return;

	var nMRowNF = ds_zfst0201_master.GetRowIndexNF( ds_zfst0201_master.currow );
	var nDRowCnt = ds_zfst0201_detail.GetRowCount();

	var sid = ds_zfst0201_list.GetColumn( nMRowNF, "ESCS_GROP" );
	var level = ds_zfst0201_list.GetColumn( nMRowNF, "LEVEL" );
	var escsItem = ds_zfst0201_list.GetColumn( nMRowNF, "ESCS_ITEM" );
	var extnEscs = ds_zfst0201_list.GetColumn( nMRowNF, "EXTN_ESCS" );
	var iRow = ds_zfst0201_list.InsertRow( nMRowNF + nDRowCnt + 1 );

	grd_detail.Redraw = false;
	grd_master.Redraw = false;

	ds_zfst0201_list.SetColumn(iRow, "ESCS_NUMB", ds_zfst0200.GetColumn(0, "ESCS_NUMB"));
	ds_zfst0201_list.SetColumn(iRow, "ESCS_NTIM", ds_zfst0200.GetColumn(0, "ESCS_NTIM"));

	ds_zfst0201_list.SetColumn(iRow, "ESCS_ITEM", escsItem);
	ds_zfst0201_list.SetColumn(iRow, "EXTN_ESCS", extnEscs);

	ds_zfst0201_list.SetColumn(iRow, "ESCS_GROP", Timem()+iRow);
	ds_zfst0201_list.SetColumn(iRow, "ESCS_UPGR", sid);
	ds_zfst0201_list.SetColumn(iRow, "LEVEL", parseInt( level ) + 1);
	ds_zfst0201_list.SetColumn(iRow, "ITEM_DIYN", "D");
	ds_zfst0201_list.SetColumn(iRow, "PART_NAME", "품목입력");

	// 디폴트 값 입력
	// 통화단위
	ds_zfst0201_list.SetColumn(iRow, "WAERK", "KRW");
	// 환율-> 환화 기준
	ds_zfst0201_list.SetColumn(iRow, "UKURS", 1);
	// 수입부대
	ds_zfst0201_list.SetColumn(iRow, "ICDT_EPNS", "");
	// 간접비
	ds_zfst0201_list.SetColumn(iRow, "IDRT_COST", "");

	ds_zfst0201_master.RecalcFilter();
	ds_zfst0201_detail.RecalcFilter();
	grd_master.Redraw = true;
	grd_detail.Redraw = true;
}

/********************************************************************************
* 기      능   : 견적원가 품목 삭제
********************************************************************************/
function Div0_btn_rowDel2_OnClick(obj)
{
	if (ds_zfst0201_detail.currow >= 0) {
	    var iRowNF = ds_zfst0201_detail.GetRowIndexNF(ds_zfst0201_detail.currow);
	    // 삭제하기 전에 해당 데이터의 마스터 정보 총계를 변경한 후에 해당 로우를 삭제해야 한다.
	    ds_zfst0201_list.fireevent = false;
	    ds_zfst0201_list.SetColumn(iRowNF, "SALE_COST", 0);
	    ds_zfst0201_list.SetColumn(iRowNF, "ESMT_COST", 0);
	    ds_zfst0201_list.SetColumn(iRowNF, "NGTT_ESCS", 0);
		gfn_DrillDownSum(ds_zfst0201_master, ds_zfst0201_master.currow, "", "SALE_COST");
        gfn_DrillDownSum(ds_zfst0201_master, ds_zfst0201_master.currow, "", "ESMT_COST");
        gfn_DrillDownSum(ds_zfst0201_master, ds_zfst0201_master.currow, "", "NGTT_ESCS");

	    // 삭제하기 전에 해당 데이터의 마스터 정보 총계를 변경한 후에 해당 로우를 삭제해야 한다.
		ds_zfst0201_list.DeleteRow(iRowNF);
	    ds_zfst0201_list.fireevent = true;
	    
		ds_zfst0201_master.RecalcFilter();
		ds_zfst0201_detail.RecalcFilter();
	}
}

/********************************************************************************
* 기      능   : 견적원가 품목 값 변경 이벤트
********************************************************************************/
function ds_zfst0201_detail_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{
    var iRowNF = ds_zfst0201_detail.GetRowIndexNF(nRow);
    if( ds_zfst0201_list.GetColumn(iRowNF,"ITEM_DIYN") == "D" ) {
		switch ( strColumnID ) {
			// 수량, 환율, 단가, 수입부대,간접비
			case "QNTY":
			case "UKURS":
			case "COST":
			case "ICDT_EPNS":
			case "IDRT_COST":
				// 매출원가 = 수량 * 환율 * 단가 * 수입부대 * 간접비
				var saleCost = fn_costCalu(ds_zfst0201_detail.GetColumn(nRow, "QNTY"), ds_zfst0201_detail.GetColumn(nRow, "UKURS"),
										   ds_zfst0201_detail.GetColumn(nRow, "COST"), ds_zfst0201_detail.GetColumn(nRow, "ICDT_EPNS"),
										   ds_zfst0201_detail.GetColumn(nRow, "IDRT_COST"));
				// 원가 계산 함수 호출
				ds_zfst0201_list.SetColumn(iRowNF, "SALE_COST", saleCost);
				gfn_DrillDownSum(ds_zfst0201_master, ds_zfst0201_master.currow, "", "SALE_COST");
				ds_zfst0201_master.RecalcFilter();
				break;
			// 원가, 견적원가
			case "SALE_COST":
				//  해당 값이 변경된 경우 시행율을 계산한다.
				var saleCost = ds_zfst0201_list.GetColumn(iRowNF, "SALE_COST");
				var esmtCost = ds_zfst0201_list.GetColumn(iRowNF, "ESMT_COST");
				var ngttEscs = ds_zfst0201_list.GetColumn(iRowNF, "NGTT_ESCS");
				// 시행율 라운2
				if( saleCost > 0 && esmtCost > 0 && ngttEscs > 0 ) {
					var mrgnRate = fn_mrgnRateCalu(saleCost, esmtCost);
					ds_zfst0201_list.SetColumn(iRowNF, "MRGN_RATE", mrgnRate);
				}
				break;
			case "ESMT_COST":
				//  해당 값이 변경된 경우 시행율을 계산한다.
				var saleCost = ds_zfst0201_list.GetColumn(iRowNF, "SALE_COST");
				var esmtCost = ds_zfst0201_list.GetColumn(iRowNF, "ESMT_COST");
				ds_zfst0201_list.SetColumn(iRowNF, "NGTT_ESCS",esmtCost);
				gfn_DrillDownSum(ds_zfst0201_master, ds_zfst0201_master.currow, "", "ESMT_COST");
				ds_zfst0201_master.RecalcFilter();
				break;
			case "NGTT_ESCS":
				//  해당 값이 변경된 경우 시행율을 계산한다.
				var saleCost = ds_zfst0201_list.GetColumn(iRowNF, "SALE_COST");
				var esmtCost = ds_zfst0201_list.GetColumn(iRowNF, "ESMT_COST");
				var ngttEscs = ds_zfst0201_list.GetColumn(iRowNF, "NGTT_ESCS");
				// 시행율 라운2
				if( saleCost > 0 && esmtCost > 0 && ngttEscs > 0 ) {
					var mrgnRate = fn_mrgnRateCalu(saleCost, ngttEscs);
					ds_zfst0201_list.SetColumn(iRowNF, "MRGN_RATE", mrgnRate);
				}
				gfn_DrillDownSum(ds_zfst0201_master, ds_zfst0201_master.currow, "", "NGTT_ESCS");
				ds_zfst0201_master.RecalcFilter();
				break;
		}    
    }
}

/********************************************************************************
* 기      능   : 견적원가 예산항목 값 변경 이벤트
********************************************************************************/
function ds_zfst0201_master_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{
    ds_zfst0201_list.fireevent = false;
    var iRowNF = ds_zfst0201_master.GetRowIndexNF(nRow);
    if( ds_zfst0201_list.GetColumn(iRowNF,"ITEM_DIYN") == "M" ) {
		switch ( strColumnID ) {
			// 원가 변경시
			case "UNIT":
				var iRowNF = ds_zfst0201_master.GetRowIndexNF(nRow);
				var escsGrop = ds_zfst0201_list.GetColumn(iRowNF,"ESCS_GROP");
				var filterString = "ESCS_UPGR="+quote(escsGrop)+" && ITEM_DIYN='M'";
				var findRow = ds_zfst0201_master.SearchRow(filterString, nRow+1);
				if( findRow > -1 && varNewValue != "" ) {
					// 단위, 수량 입력을 못하게 제어한다. 이벤트 제거
					ds_zfst0201_list.fireevent = false;
					gfn_openMsgWin("해당 셀의 단위 값은 입력할 수 없습니다.", "", "A", "");
					ds_zfst0201_list.SetColumn(iRowNF, "UNIT","");
					ds_zfst0201_list.fireevent = true;
					return;
				}
				break;
			case "QNTY":
				var iRowNF = ds_zfst0201_master.GetRowIndexNF(nRow);
				var escsGrop = ds_zfst0201_list.GetColumn(iRowNF,"ESCS_GROP");
				var filterString = "ESCS_UPGR="+quote(escsGrop)+" && ITEM_DIYN='M'";
				var findRow = ds_zfst0201_master.SearchRow(filterString, nRow+1);
				if( findRow > -1 && varNewValue > 0 ) {
					// 단위, 수량 입력을 못하게 제어한다. 이벤트 제거
					ds_zfst0201_list.fireevent = false;
					gfn_openMsgWin("해당 셀의 수량 값은 입력할 수 없습니다.", "", "A", "");
					ds_zfst0201_list.SetColumn(iRowNF, "QNTY",0);
					ds_zfst0201_list.fireevent = true;
					return;
				}

				var qnty = ds_zfst0201_list.GetColumn(iRowNF,"QNTY");
				var saleCost = ds_zfst0201_list.GetColumn(iRowNF,"SALE_COST");
				var cost = 0;
				if( qnty > 0 ) {
					// 단가항목 셑팅
					cost = toNumber(saleCost)/toNumber(qnty);
					ds_zfst0201_list.SetColumn(iRowNF, "COST", cost);
				} else {
					ds_zfst0201_list.SetColumn(iRowNF, "COST", 0);
				}
				break;
			case "SALE_COST":
			case "ESMT_COST":
				//  시행율을 구해서 셀에 입력한다.
				var iRowNF = ds_zfst0201_master.GetRowIndexNF(nRow);
				var saleCost = ds_zfst0201_list.GetColumn(iRowNF, "SALE_COST");
				var esmtCost = ds_zfst0201_list.GetColumn(iRowNF, "ESMT_COST");
				var ngttEscs = ds_zfst0201_list.GetColumn(iRowNF, "NGTT_ESCS");
				
				/*  해당 로직에서는 이벤트를 죽여야 한다. */
				var qnty = ds_zfst0201_list.GetColumn(iRowNF,"QNTY");
				var cost = 0;
				if( qnty > 0 ) {
					// 단가항목 셑팅
					cost = toNumber(saleCost)/toNumber(qnty);
					ds_zfst0201_list.SetColumn(iRowNF, "COST", cost);
				} else {
					ds_zfst0201_list.SetColumn(iRowNF, "COST", 0);
				}
				
				// 시행율 라운2
				if( saleCost > 0 && esmtCost > 0 && ngttEscs > 0 ) {
					var mrgnRate = fn_mrgnRateCalu(saleCost, ngttEscs);
					ds_zfst0201_list.SetColumn(iRowNF, "MRGN_RATE", mrgnRate);
				}
				break;
		}
    }
    ds_zfst0201_list.fireevent = true;
}

/********************************************************************************
* 기      능   : 매출원가 생성
*                매출원가 = 수량 * 환율 * 단가 * 수입부대 * 간접비
********************************************************************************/
function fn_costCalu(qnty, ukurs, cost, icdtEpns, idrtCost) {
    var saleCost = 0;
    // 원가
    if( ukurs == "" || ukurs == "0" ) {
        saleCost = toNumber(qnty) * toNumber(cost);
    } else {
        saleCost = toNumber(qnty) * toNumber(ukurs) * toNumber(cost);
    }

    // 수입부대
    if( toNumber(icdtEpns) > 0 ) {
        saleCost = saleCost * toNumber(icdtEpns);
    }
    // 간접비
    if( toNumber(idrtCost) > 0 ) {
        saleCost = saleCost * toNumber(idrtCost);
    }
    // 금액은 소수점없이 반올림한다.
    return round(saleCost,0);
}

/********************************************************************************
* 기      능   : 시행율 계산
*                시행율 = 원가/견적원가*100 round 2
********************************************************************************/
function fn_mrgnRateCalu(saleCost, esmtCost) {
    var mrgnRate = round(toNumber(saleCost)/toNumber(esmtCost)*100,2);
    return mrgnRate;
}

/********************************************************************************
* 기      능   : 견적원가 품목 공통코드 팝업 호출
********************************************************************************/
function grd_detail_OnExpandEdit(obj,nRow,nCell,strVal,nPivotIndex)
{
	var columnID = obj.GetCellProp("body",nCell,"colid");
    var rowIndex = ds_zfst0201_detail.GetRowIndexNF(nRow);
    switch (columnID) {
	    case "WAERK":
	        // 통화단위 리턴
            var arg="";
           	var arr = null;
            arr = gfn_openPopup("FS_COM0103", true, arg);
            if( length(arr) > 0 )  {
			    ds_zfst0201_list.SetColumn(rowIndex, "WAERK", arr[0]);
			    ds_zfst0201_list.SetColumn(rowIndex, "UKURS", arr[1]);
            }
	        break;
    }
}

/********************************************************************************
* 기      능   : Master Rows Up
********************************************************************************/
function btn_rowUp_OnClick(obj)
{
	gfn_DrillDownMoveRow(grd_master, ds_zfst0201_master.currow, true, 1);
	dataSort = "Y";
}

/********************************************************************************
* 기      능   : Master Rows Down
********************************************************************************/
function btn_masterRowDown_OnClick(obj)
{
	gfn_DrillDownMoveRow(grd_master, ds_zfst0201_master.currow, false, 1);
	dataSort = "Y";
}
]]></Script>
</Window>