<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="562" Id="FS0202003A" Left="8" OnLoadCompleted="fn_OnLoadCompleted" OnTimer="FS0202003A_OnTimer" OnUnloadCompleted="fn_OnUnloadCompleted" PidAttrib="7" Style="sty_ipt_form" Title="견적서&#32;등록/변경" Top="8" Ver="1.0" Width="978" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_error">
				<Contents>
					<colinfo id="IDX" size="256" type="STRING"/>
					<colinfo id="ERRMSG" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond">
				<Contents>
					<colinfo id="MANDT" size="3" summ="default" type="STRING"/>
					<colinfo id="ESCS_NUMB" size="20" summ="default" type="STRING"/>
					<colinfo id="ESCS_NTIM" size="5" summ="default" type="INT"/>
					<colinfo id="ESMT_NUMB" size="20" summ="default" type="STRING"/>
					<colinfo id="ESMT_ITSQ" size="256" summ="default" type="STRING"/>
					<colinfo id="ESMT_SBSQ" size="256" summ="default" type="STRING"/>
					<colinfo id="ACTION_CMD" size="256" summ="default" type="STRING"/>
					<colinfo id="WAERK" size="5" summ="default" type="STRING"/>
					<colinfo id="OT_UKURS" size="9" summ="default" type="DECIMAL"/>
					<colinfo id="UKURS" size="9" summ="default" type="DECIMAL"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_zfst0200">
				<Contents>
					<colinfo id="MANDT" size="3" summ="default" type="STRING"/>
					<colinfo id="ESCS_NUMB" size="20" summ="default" type="STRING"/>
					<colinfo id="ESCS_NTIM" size="5" summ="default" type="INT"/>
					<colinfo id="ORDR_TYPE" size="10" summ="default" type="STRING"/>
					<colinfo id="ORDR_TYPE_NAME" size="256" summ="default" type="STRING"/>
					<colinfo id="POST1" size="40" summ="default" type="STRING"/>
					<colinfo id="KUNNR" size="10" summ="default" type="STRING"/>
					<colinfo id="KUNNR_NAME" size="35" summ="default" type="STRING"/>
					<colinfo id="KUNNR_CTAT" size="20" summ="default" type="STRING"/>
					<colinfo id="ESMT_CNTR" size="3" summ="default" type="STRING"/>
					<colinfo id="REP_NAME" size="256" summ="default" type="STRING"/>
					<colinfo id="FAX" size="20" summ="default" type="STRING"/>
					<colinfo id="HTEL" size="20" summ="default" type="STRING"/>
					<colinfo id="EMAIL" size="20" summ="default" type="STRING"/>
					<colinfo id="SALE_PRSN" size="20" summ="default" type="STRING"/>
					<colinfo id="SALE_PRSN_NAME" size="35" summ="default" type="STRING"/>
					<colinfo id="MRGN_RATE" size="9" summ="default" type="DECIMAL"/>
					<colinfo id="WAERK" size="5" summ="default" type="STRING"/>
					<colinfo id="WAERK_NAME" size="256" summ="default" type="STRING"/>
					<colinfo id="UKURS" size="9" summ="default" type="DECIMAL"/>
					<colinfo id="UKURS_RATE" size="5" summ="default" type="INT"/>
					<colinfo id="ESCS_TAMT" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="ESMT_TAMT" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="NGTT_TAMT" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="NGTT_APYN" size="1" summ="default" type="STRING"/>
					<colinfo id="REMK" size="4000" summ="default" type="STRING"/>
					<colinfo id="OCNT_PDYN" size="1" summ="default" type="STRING"/>
					<colinfo id="OCNT_PDDT" size="8" summ="default" type="STRING"/>
					<colinfo id="OCNT_NUMB" size="20" summ="default" type="STRING"/>
					<colinfo id="ESMT_PUBN" size="5" summ="default" type="INT"/>
					<colinfo id="AFIL_NUMB" size="20" summ="default" type="STRING"/>
					<colinfo id="ESCS_STAT" size="10" summ="default" type="STRING"/>
					<colinfo id="ESCS_STAT_NAME" size="120" summ="default" type="STRING"/>
					<colinfo id="ESCS_APDT" size="8" summ="default" type="STRING"/>
					<colinfo id="APPR_STAT" size="10" summ="default" type="STRING"/>
					<colinfo id="APPR_STAT_NAME" size="35" summ="default" type="STRING"/>
					<colinfo id="ESMT_CNTR_NAME" size="50" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_zfst0202" OnColumnChanged="ds_zfst0202_OnColumnChanged">
				<Contents>
					<colinfo id="MANDT" size="3" summ="default" type="STRING"/>
					<colinfo id="ESMT_NUMB" size="20" summ="default" type="STRING"/>
					<colinfo id="BSNS_NAME" size="100" summ="default" type="STRING"/>
					<colinfo id="ORCU_NAME" size="100" summ="default" type="STRING"/>
					<colinfo id="ESMT_TAMT" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="NGTT_TAMT" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="ESMT_CNTR" size="3" summ="default" type="STRING"/>
					<colinfo id="ESMT_CNTR_NAME" size="256" summ="default" type="STRING"/>
					<colinfo id="WAERK" size="5" summ="default" type="STRING"/>
					<colinfo id="WAERK_NAME" size="50" summ="default" type="STRING"/>
					<colinfo id="OT_UKURS" size="9" summ="default" type="DECIMAL"/>
					<colinfo id="UKURS" size="9" summ="default" type="DECIMAL"/>
					<colinfo id="CRES_TAMT" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="CRNG_TAMT" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="NGTT_DPYN" size="1" summ="default" type="STRING"/>
					<colinfo id="DLIV" size="200" summ="default" type="STRING"/>
					<colinfo id="DLIV_IVIC" size="10" summ="default" type="STRING"/>
					<colinfo id="DLIV_OTHR" size="100" summ="default" type="STRING"/>
					<colinfo id="PAYT_TERM" size="100" summ="default" type="STRING"/>
					<colinfo id="WRNT_CNDT" size="100" summ="default" type="STRING"/>
					<colinfo id="INSP_CDT" size="100" summ="default" type="STRING"/>
					<colinfo id="DEST" size="100" summ="default" type="STRING"/>
					<colinfo id="REF_DOCU" size="100" summ="default" type="STRING"/>
					<colinfo id="PROD_INYN" size="1" summ="default" type="STRING"/>
					<colinfo id="ESMT_PROD_TEXT" size="256" summ="default" type="STRING"/>
					<colinfo id="ESMT_PROD" size="100" summ="default" type="STRING"/>
					<colinfo id="ESMT_EPDT_DAY" size="10" summ="default" type="INT"/>
					<colinfo id="ESMT_EPDT" size="8" summ="default" type="STRING"/>
					<colinfo id="ESMT_DATE" size="8" summ="default" type="STRING"/>
					<colinfo id="REMK" size="4000" summ="default" type="STRING"/>
					<colinfo id="ESCS_APDT" size="8" summ="default" type="STRING"/>
					<colinfo id="ESMT_STAT" size="10" summ="default" type="STRING"/>
					<colinfo id="ESCS_NUMB" size="20" summ="default" type="STRING"/>
					<colinfo id="ESCS_NTIM" size="5" summ="default" type="INT"/>
					<colinfo id="OCNT_NUMB" size="20" summ="default" type="STRING"/>
					<colinfo id="WRIT_DATE" size="8" summ="default" type="STRING"/>
					<colinfo id="WRIT_TIME" size="6" summ="default" type="STRING"/>
					<colinfo id="WRIT_USER" size="12" summ="default" type="STRING"/>
					<colinfo id="OCNT_PDYN" size="1" summ="default" type="STRING"/>
					<colinfo id="OCNT_PDDT" size="8" summ="default" type="STRING"/>
					<colinfo id="SALE_PRSN" size="20" summ="default" type="STRING"/>
					<colinfo id="SALE_PRSN_NAME" size="35" summ="default" type="STRING"/>
					<colinfo id="KUNNR" size="10" summ="default" type="STRING"/>
					<colinfo id="KUNNR_NAME" size="35" summ="default" type="STRING"/>
					<colinfo id="KUNNR_CTAT" size="20" summ="default" type="STRING"/>
					<colinfo id="REP_NAME" size="256" summ="default" type="STRING"/>
					<colinfo id="FAX" size="20" summ="default" type="STRING"/>
					<colinfo id="HTEL" size="20" summ="default" type="STRING"/>
					<colinfo id="EMAIL" size="20" summ="default" type="STRING"/>
					<colinfo id="ESMT_STAT_NAME" size="50" summ="default" type="STRING"/>
					<colinfo id="APPR_STAT" size="10" summ="default" type="STRING"/>
					<colinfo id="APPR_STAT_NAME" size="35" summ="default" type="STRING"/>
					<colinfo id="DRAF" size="36" summ="default" type="STRING"/>
					<colinfo id="ADIT" size="256" summ="default" type="STRING"/>
					<colinfo id="APPR" size="256" summ="default" type="STRING"/>
					<colinfo id="UKURS_RATE" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="DLIV_IVIC_NAME" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_zfst0203" OnColumnChanged="ds_zfst0203_OnColumnChanged">
				<Contents>
					<colinfo id="MANDT" size="3" summ="default" type="STRING"/>
					<colinfo id="ESMT_NUMB" size="20" summ="default" type="STRING"/>
					<colinfo id="ESMT_SBSQ" size="10" summ="default" type="INT"/>
					<colinfo id="CNTS" size="200" summ="default" type="STRING"/>
					<colinfo id="STAD" size="200" summ="default" type="STRING"/>
					<colinfo id="UNIT" size="3" summ="default" type="STRING"/>
					<colinfo id="QNTY" size="10" summ="default" type="INT"/>
					<colinfo id="WAERK" size="5" summ="default" type="STRING"/>
					<colinfo id="ESMT_COST" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="CRES_COST" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="NOTE" size="4000" summ="default" type="STRING"/>
					<colinfo id="WRIT_DATE" size="8" summ="default" type="STRING"/>
					<colinfo id="WRIT_TIME" size="6" summ="default" type="STRING"/>
					<colinfo id="WRIT_USER" size="12" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_zfst0204" OnColumnChanged="ds_zfst0204_OnColumnChanged">
				<Contents>
					<colinfo id="MANDT" size="3" summ="default" type="STRING"/>
					<colinfo id="ESMT_NUMB" size="20" summ="default" type="STRING"/>
					<colinfo id="ESMT_ITSQ" size="5" summ="default" type="INT"/>
					<colinfo id="ESMT_SBSQ" size="5" summ="default" type="INT"/>
					<colinfo id="ESMT_PGSQ" size="5" summ="default" type="INT"/>
					<colinfo id="CNTS" size="200" summ="default" type="STRING"/>
					<colinfo id="STAD" size="100" summ="default" type="STRING"/>
					<colinfo id="UNIT" size="3" summ="default" type="STRING"/>
					<colinfo id="QNTY" size="10" summ="default" type="INT"/>
					<colinfo id="WAERK" size="5" summ="default" type="STRING"/>
					<colinfo id="ESMT_COST" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="CRES_COST" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="NOTE" size="4000" summ="default" type="STRING"/>
					<colinfo id="WRIT_DATE" size="8" summ="default" type="STRING"/>
					<colinfo id="WRIT_TIME" size="6" summ="default" type="STRING"/>
					<colinfo id="WRIT_USER" size="12" summ="default" type="STRING"/>
					<colinfo id="CHK" size="1" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_combo_s06">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_combo_a03">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_zfst0201">
				<Contents>
					<colinfo id="MANDT" size="3" summ="default" type="STRING"/>
					<colinfo id="ESMT_NUMB" size="20" summ="default" type="STRING"/>
					<colinfo id="ESMT_ITSQ" size="5" summ="default" type="INT"/>
					<colinfo id="ESMT_SBSQ" size="5" summ="default" type="INT"/>
					<colinfo id="ESMT_PGSQ" size="5" summ="default" type="INT"/>
					<colinfo id="CNTS" size="200" summ="default" type="STRING"/>
					<colinfo id="STAD" size="100" summ="default" type="STRING"/>
					<colinfo id="UNIT" size="3" summ="default" type="STRING"/>
					<colinfo id="QNTY" size="10" summ="default" type="INT"/>
					<colinfo id="WAERK" size="5" summ="default" type="STRING"/>
					<colinfo id="SALE_COST" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="ESMT_COST" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="CRES_COST" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="NOTE" size="4000" summ="default" type="STRING"/>
					<colinfo id="WRIT_DATE" size="8" summ="default" type="STRING"/>
					<colinfo id="WRIT_TIME" size="6" summ="default" type="STRING"/>
					<colinfo id="WRIT_USER" size="12" summ="default" type="STRING"/>
					<colinfo id="CHK" size="1" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_combo_zfst0203">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="INT"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_zfst0202_key" OnColumnChanged="ds_zfst0202_OnColumnChanged">
				<Contents>
					<colinfo id="ESMT_NUMB" size="20" summ="default" type="STRING"/>
					<colinfo id="ACTION_CMD" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_zfst0201_rtn">
				<Contents>
					<colinfo id="LIST_INDEX" size="100" summ="default" type="STRING"/>
					<colinfo id="CHK" size="100" summ="default" type="STRING"/>
					<colinfo id="FLAG" size="100" summ="default" type="STRING"/>
					<colinfo id="LEVEL" size="100" summ="default" type="STRING"/>
					<colinfo id="MANDT" size="3" summ="default" type="STRING"/>
					<colinfo id="ESCS_NUMB" size="20" summ="default" type="STRING"/>
					<colinfo id="ESCS_NTIM" size="5" summ="default" type="INT"/>
					<colinfo id="POST1" size="100" summ="default" type="STRING"/>
					<colinfo id="ESCS_ITSQ" size="5" summ="default" type="INT"/>
					<colinfo id="ITEM_DIYN" size="1" summ="default" type="STRING"/>
					<colinfo id="ESCS_GROP" size="10" summ="default" type="STRING"/>
					<colinfo id="ESCS_UPGR" size="10" summ="default" type="STRING"/>
					<colinfo id="PESCS_GROP" size="256" summ="default" type="STRING"/>
					<colinfo id="PESCS_UPGR" size="256" summ="default" type="STRING"/>
					<colinfo id="ESCS_ITEM" size="9" summ="default" type="STRING"/>
					<colinfo id="EXTN_ESCS" size="21" summ="default" type="STRING"/>
					<colinfo id="ESCE_NAME" size="100" summ="default" type="STRING"/>
					<colinfo id="MTRL_DIVS" size="10" summ="default" type="STRING"/>
					<colinfo id="MTRL_NUMB" size="20" summ="default" type="STRING"/>
					<colinfo id="PART_NAME" size="100" summ="default" type="STRING"/>
					<colinfo id="STAD" size="100" summ="default" type="STRING"/>
					<colinfo id="UNIT" size="3" summ="default" type="STRING"/>
					<colinfo id="QNTY" size="5" summ="default" type="INT"/>
					<colinfo id="COST" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="WAERK" size="5" summ="default" type="STRING"/>
					<colinfo id="UKURS" size="9" summ="default" type="DECIMAL"/>
					<colinfo id="ICDT_EPNS" size="6" summ="default" type="DECIMAL"/>
					<colinfo id="IDRT_COST" size="6" summ="default" type="DECIMAL"/>
					<colinfo id="SALE_COST" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="MRGN_RATE" size="9" summ="default" type="DECIMAL"/>
					<colinfo id="ESMT_COST" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="PRES_COST" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="NGTT_ESCS" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="ESMT_EGRT" size="9" summ="default" type="DECIMAL"/>
					<colinfo id="CRES_COST" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="UNIT_CRES_COST" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="NOTE" size="256" summ="default" type="STRING"/>
					<colinfo id="ESMT_CMPY" size="40" summ="default" type="STRING"/>
					<colinfo id="WORD_REFR" size="256" summ="default" type="STRING"/>
					<colinfo id="OCNT_NUMB" size="20" summ="default" type="STRING"/>
					<colinfo id="EBDG_MGSQ" size="5" summ="default" type="INT"/>
					<colinfo id="EBDG_ITSQ" size="5" summ="default" type="INT"/>
					<colinfo id="MODI_DATE" size="8" summ="default" type="STRING"/>
					<colinfo id="MODI_TIME" size="6" summ="default" type="STRING"/>
					<colinfo id="MODI_USER" size="12" summ="default" type="STRING"/>
					<colinfo id="DEGREE" size="9" summ="default" type="DECIMAL"/>
					<colinfo id="ESIT_SEQN" size="5" summ="default" type="INT"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_doc_appr">
				<Contents>
					<colinfo id="MANDT" size="3" summ="default" type="STRING"/>
					<colinfo id="ADOC_CLAS" size="10" summ="default" type="STRING"/>
					<colinfo id="ADOC_NUMB" size="20" summ="default" type="STRING"/>
					<colinfo id="ADOC_NTIM" size="5" summ="default" type="INT"/>
					<colinfo id="RSON_RJCT" size="600" summ="default" type="STRING"/>
					<colinfo id="APPR_STAT" size="30" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_zfst0103">
				<Contents>
					<colinfo id="MANDT" size="3" summ="default" type="STRING"/>
					<colinfo id="ADOC_CLAS" size="10" summ="default" type="STRING"/>
					<colinfo id="ADOC_NUMB" size="20" summ="default" type="STRING"/>
					<colinfo id="ADOC_NTIM" size="5" summ="default" type="INT"/>
					<colinfo id="RSON_RJCT" size="200" summ="default" type="STRING"/>
					<colinfo id="DRAF_TIME" size="8" summ="default" type="STRING"/>
					<colinfo id="DRAF_DATE" size="6" summ="default" type="STRING"/>
					<colinfo id="DRAF" size="12" summ="default" type="STRING"/>
					<colinfo id="DRAF_NAME" size="256" summ="default" type="STRING"/>
					<colinfo id="DRAF_STAT" size="5" summ="default" type="STRING"/>
					<colinfo id="ADIT_DATE" size="8" summ="default" type="STRING"/>
					<colinfo id="ADIT_TIME" size="6" summ="default" type="STRING"/>
					<colinfo id="ADIT" size="12" summ="default" type="STRING"/>
					<colinfo id="ADIT_NAME" size="256" summ="default" type="STRING"/>
					<colinfo id="ADIT_STAT" size="5" summ="default" type="STRING"/>
					<colinfo id="APPR_DATE" size="8" summ="default" type="STRING"/>
					<colinfo id="APPR_TIME" size="6" summ="default" type="STRING"/>
					<colinfo id="APPR" size="12" summ="default" type="STRING"/>
					<colinfo id="APPR_NAME" size="12" summ="default" type="STRING"/>
					<colinfo id="APPR_STAT" size="10" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
		</Datasets>
		<Static Align="Center" BKColor="user1" Height="23" Id="vbeln1" Left="1520" TabOrder="1" Top="487" Visible="FALSE" Width="0"></Static>
		<Shape BKColor="user0" Bottom="56" Height="56" Id="Shape2" Left="0" LineColor="user1" Right="978" TabOrder="2" Top="0" Type="Rectangle" Width="978"></Shape>
		<Static Align="Right" Height="20" Id="Static1" Left="8" Style="sty_lb_search" TabOrder="4" Text="견적번호&#32;" Top="5" VAlign="Middle" Width="70"></Static>
		<Edit Align="CENTER" BindDataset="ds_zfst0202" Border="Flat" BorderColor="user1" Column="ESMT_NUMB" Height="20" Id="ed_esmtNumb" Left="78" MaxLength="10" Readonly="TRUE" Style="sty_ipt_form_ind" TabOrder="3" Top="5" UpperOnly="TRUE" Width="114"></Edit>
		<Button Cursor="HAND" Enable="FALSE" Height="18" Id="btn_esmtNumb" ImageID="btn_icon_search" Left="194" OnClick="fn_esmtNumb_OnClick" TabOrder="5" Top="6" Transparent="TRUE" Width="18"></Button>
		<Static Align="Right" Height="20" Id="Static15" Left="1101" Style="sty_lb_search" TabOrder="7" Text="견적차수" Top="5" VAlign="Middle" Visible="FALSE" Width="0"></Static>
		<Edit Border="Flat" BorderColor="user1" Height="20" Id="Edit8" Left="1161" MaxLength="10" Readonly="TRUE" Style="sty_ipt_form_ind" TabOrder="8" Top="5" UpperOnly="TRUE" Visible="FALSE" Width="0"></Edit>
		<Tab Border="Flat" Color="user7" FixedImage="FALSE" Font="굴림,9" Height="496" Id="tab_esmt" Left="8" MouseOverColor="user16" SelColor="user15" SelectFont="굴림,9" Style="sty_tab" TabOrder="9" Top="60" Width="960">
			<Contents>
				<TabPage BorderColor="black" Height="471" Id="tab_esmtInfo" ImageEdgeWidth="2" ImageID="tab_main" Left="2" TabOrder="19" Text="견적서&#32;마스터&#32;정보" Top="23" Width="956">
					<Shape BKColor="user12" Bottom="157" Height="26" Id="Shape4" Left="5" LineColor="user13" Right="951" TabOrder="38" Top="131" Type="Rectangle" Width="946"></Shape>
					<Shape BKColor="user12" Bottom="132" Height="26" Id="Shape2" Left="5" LineColor="user13" Right="951" TabOrder="33" Top="106" Type="Rectangle" Width="946"></Shape>
					<Shape BKColor="user12" Bottom="32" Height="26" Id="Shape5" Left="5" LineColor="user13" Right="951" TabOrder="1" Top="6" Type="Rectangle" Width="946"></Shape>
					<Edit BindDataset="ds_zfst0202" Border="Flat" BorderColor="user13" Column="ORCU_NAME" Height="20" Id="ed_orcuName" Left="149" MaxLength="100" RemoveCRLF="TRUE" Style="sty_ipt_form" TabOrder="2" Top="9" UpperOnly="TRUE" Width="315"></Edit>
					<Static Align="Right" Height="24" Id="Static40" Left="6" Style="sty_lb_form_basic" TabOrder="3" Text="발주처명&#32;" Top="7" VAlign="Middle" Width="140"></Static>
					<Shape BKColor="user12" Bottom="57" Height="26" Id="Shape0" Left="5" LineColor="user13" Right="951" TabOrder="4" Top="31" Type="Rectangle" Width="946"></Shape>
					<Edit BindDataset="ds_zfst0202" Border="Flat" BorderColor="user13" Column="BSNS_NAME" Height="20" Id="ed_bsnsName" Left="620" MaxLength="100" RemoveCRLF="TRUE" Style="sty_ipt_form" TabOrder="5" Top="9" UpperOnly="TRUE" Width="323"></Edit>
					<Static Align="Right" Height="24" Id="Static0" Left="477" Style="sty_lb_form_basic" TabOrder="29" Text="사업명&#32;" Top="7" VAlign="Middle" Width="140"></Static>
					<Shape BKColor="user12" Bottom="82" Height="26" Id="Shape1" Left="5" LineColor="user13" Right="951" TabOrder="30" Top="56" Type="Rectangle" Width="946"></Shape>
					<Edit BindDataset="ds_zfst0200" Border="Flat" BorderColor="user13" Column="ORDR_TYPE_NAME" Height="20" Id="ed_ordrType" Left="149" MaxLength="10" Readonly="TRUE" RemoveCRLF="TRUE" Style="sty_ipt_form_ind" TabOrder="31" TabStop="FALSE" Top="34" UpperOnly="TRUE" Width="315"></Edit>
					<Static Align="Right" Height="24" Id="Static1" Left="6" Style="sty_lb_form_basic" TabOrder="32" Text="오더유형&#32;" Top="32" VAlign="Middle" Width="140"></Static>
					<Static Align="Right" Height="24" Id="Static2" Left="477" Style="sty_lb_form_basic" TabOrder="35" Text="국가&#32;" Top="32" VAlign="Middle" Width="140"></Static>
					<Edit BindDataset="ds_zfst0202" Border="Flat" BorderColor="user13" Column="ESMT_CNTR_NAME" Height="20" Id="ed_esmtCntr" Left="620" MaxLength="10" Readonly="TRUE" RemoveCRLF="TRUE" Style="sty_ipt_form_ind" TabOrder="34" TabStop="FALSE" Top="34" UpperOnly="TRUE" Width="302"></Edit>
					<Static Align="Right" Height="24" Id="Static3" Left="6" Style="sty_lb_form_basic" TabOrder="37" Text="견적금액(원)&#32;" Top="57" VAlign="Middle" Width="140"></Static>
					<MaskEdit Align="Right" BindDataset="ds_zfst0202" Border="Flat" BorderColor="user13" Column="ESMT_TAMT" Height="20" Id="ed_esmtTamt" Left="149" Mask="&apos;*************&apos;" MaxLength="17" NullValue="0" Readonly="TRUE" Style="sty_ipt_form_ind" TabOrder="36" TabStop="FALSE" Top="59" Width="315"></MaskEdit>
					<Shape BKColor="user12" Bottom="182" Height="26" Id="Shape6" Left="5" LineColor="user13" Right="951" TabOrder="39" Top="156" Type="Rectangle" Width="946"></Shape>
					<Static Align="Right" Height="24" Id="Static5" Left="6" Style="sty_lb_form_basic" TabOrder="41" Text="환산견적금액&#32;" Top="107" VAlign="Middle" Width="140"></Static>
					<MaskEdit Align="Right" BindDataset="ds_zfst0202" Border="Flat" BorderColor="user13" Column="CRES_TAMT" Height="20" Id="ed_cresTamt" Left="149" Mask="&apos;*************&apos;" MaxLength="17" NullValue="0" Readonly="TRUE" Style="sty_ipt_form_ind" TabOrder="40" TabStop="FALSE" Top="109" Width="315"></MaskEdit>
					<Static Align="Right" Height="24" Id="Static6" Left="6" Style="sty_lb_form_basic" TabOrder="42" Text="납기&#32;" Top="132" VAlign="Middle" Width="140"></Static>
					<Static Align="Right" Height="24" Id="Static7" Left="6" Style="sty_lb_form_basic" TabOrder="43" Text="인도조건송장&#32;" Top="157" VAlign="Middle" Width="140"></Static>
					<Static Align="Right" Height="24" Id="Static8" Left="477" Style="sty_lb_form_basic" TabOrder="44" Text="인도조건기타&#32;" Top="157" VAlign="Middle" Width="140"></Static>
					<Edit BindDataset="ds_zfst0202" Border="Flat" Column="DLIV_OTHR" Height="20" Id="ed_dlivOthr" Left="620" MaxLength="100" RemoveCRLF="TRUE" Style="sty_ipt_form" TabOrder="12" Top="159" Width="323"></Edit>
					<Shape BKColor="user12" Bottom="207" Height="26" Id="Shape3" Left="5" LineColor="user13" Right="951" TabOrder="45" Top="181" Type="Rectangle" Width="946"></Shape>
					<Static Align="Right" Height="24" Id="Static9" Left="6" Style="sty_lb_form_basic" TabOrder="46" Text="지불조건&#32;" Top="182" VAlign="Middle" Width="140"></Static>
					<Edit BindDataset="ds_zfst0202" Border="Flat" Column="PAYT_TERM" Height="20" Id="ed_paytTerm" Left="149" MaxLength="100" RemoveCRLF="TRUE" Style="sty_ipt_form" TabOrder="13" Top="184" Width="315"></Edit>
					<Shape BKColor="user12" Bottom="282" Height="26" Id="Shape7" Left="5" LineColor="user13" Right="951" TabOrder="47" Top="256" Type="Rectangle" Width="946"></Shape>
					<Shape BKColor="user12" Bottom="232" Height="26" Id="Shape8" Left="5" LineColor="user13" Right="951" TabOrder="48" Top="206" Type="Rectangle" Width="946"></Shape>
					<Static Align="Right" Height="24" Id="Static13" Left="6" Style="sty_lb_form_basic" TabOrder="49" Text="검사조건&#32;" Top="207" VAlign="Middle" Width="140"></Static>
					<Edit BindDataset="ds_zfst0202" Border="Flat" Column="INSP_CDT" Height="20" Id="ed_inspCdt" Left="149" MaxLength="100" RemoveCRLF="TRUE" Style="sty_ipt_form" TabOrder="15" Top="209" Width="315"></Edit>
					<Shape BKColor="user12" Bottom="343" Height="62" Id="Shape9" Left="5" LineColor="user13" Right="951" TabOrder="50" Top="281" Type="Rectangle" Width="946"></Shape>
					<Static Align="Right" Height="60" Id="Static10" Left="6" Style="sty_lb_form_basic" TabOrder="51" Text="특기사항&#32;" Top="282" VAlign="Middle" Width="140"></Static>
					<TextArea BindDataset="ds_zfst0202" Border="Flat" Column="REMK" Height="55" Id="tx_remk" Left="149" MaxLength="4000" Style="sty_ipt_form" TabOrder="22" Top="285" VScroll="TRUE" Width="794"></TextArea>
					<Shape BKColor="user12" Bottom="107" Height="26" Id="Shape10" Left="5" LineColor="user13" Right="951" TabOrder="52" Top="81" Type="Rectangle" Width="946"></Shape>
					<Shape BKColor="user12" Bottom="368" Height="26" Id="Shape12" Left="5" LineColor="user13" Right="951" TabOrder="53" Top="342" Type="Rectangle" Width="946"></Shape>
					<Static Align="Right" Height="24" Id="Static14" Left="6" Style="sty_lb_form_basic" TabOrder="54" Text="영업담당자&#32;" Top="343" VAlign="Middle" Width="140"></Static>
					<Edit Align="CENTER" BindDataset="ds_zfst0202" Border="Flat" Column="SALE_PRSN_NAME" Height="20" Id="ed_esmtUser" Left="149" Readonly="TRUE" Style="sty_ipt_form_ind" TabOrder="55" TabStop="FALSE" Top="345" Width="112"></Edit>
					<Button Cursor="HAND" Height="18" Id="btn_salePrsn" ImageID="btn_icon_search" Left="262" OnClick="fn_salePrsn_OnClick" Style="sty_btn" TabOrder="23" Top="346" Transparent="TRUE" Width="18"></Button>
					<Shape BKColor="user12" Bottom="416" Height="26" Id="Shape13" Left="5" LineColor="user13" Right="951" TabOrder="56" Top="390" Type="Rectangle" Width="946"></Shape>
					<Static Align="Right" Height="24" Id="Static17" Left="6" Style="sty_lb_form_basic" TabOrder="57" Text="고객담당자명&#32;" Top="391" VAlign="Middle" Width="140"></Static>
					<Shape BKColor="user12" Bottom="441" Height="26" Id="Shape14" Left="5" LineColor="user13" Right="951" TabOrder="58" Top="415" Type="Rectangle" Width="946"></Shape>
					<Static Align="Right" Height="24" Id="Static18" Left="6" Style="sty_lb_form_basic" TabOrder="59" Text="전화번호(회사)&#32;" Top="416" VAlign="Middle" Width="140"></Static>
					<Edit BindDataset="ds_zfst0202" Border="Flat" Column="KUNNR_CTAT" Height="20" Id="ed_kunnrCtat" Left="150" MaxLength="20" RemoveCRLF="TRUE" Style="sty_ipt_form" TabOrder="25" Top="418" Width="315"></Edit>
					<Static Align="Right" Height="24" Id="Static19" Left="477" Style="sty_lb_form_basic" TabOrder="60" Text="HP&#32;" Top="416" VAlign="Middle" Width="140"></Static>
					<Edit BindDataset="ds_zfst0202" Border="Flat" Column="HTEL" Height="20" Id="ed_hTel" Left="620" MaxLength="20" RemoveCRLF="TRUE" Style="sty_ipt_form" TabOrder="26" Top="418" Width="323"></Edit>
					<Shape BKColor="user12" Bottom="466" Height="26" Id="Shape15" Left="5" LineColor="user13" Right="951" TabOrder="61" Top="440" Type="Rectangle" Width="946"></Shape>
					<Static Align="Right" Height="24" Id="Static20" Left="6" Style="sty_lb_form_basic" TabOrder="62" Text="FAX&#32;" Top="441" VAlign="Middle" Width="140"></Static>
					<Edit BindDataset="ds_zfst0202" Border="Flat" Column="FAX" Height="20" Id="ed_fax" Left="150" MaxLength="20" RemoveCRLF="TRUE" Style="sty_ipt_form" TabOrder="27" Top="443" Width="315"></Edit>
					<Static Align="Right" Height="24" Id="Static21" Left="477" Style="sty_lb_form_basic" TabOrder="63" Text="MAIL&#32;" Top="441" VAlign="Middle" Width="140"></Static>
					<Edit BindDataset="ds_zfst0202" Border="Flat" Column="EMAIL" Height="20" Id="ed_email" Left="620" MaxLength="20" RemoveCRLF="TRUE" Style="sty_ipt_form" TabOrder="28" Top="443" Width="323"></Edit>
					<Image Height="20" Id="Image1" ImageID="form_bl_title_sub" Left="1" TabOrder="64" Top="370" Width="11"></Image>
					<Static Color="user6" Font="굴림,9,Bold" Height="20" Id="Static22" Left="14" TabOrder="65" Text="고객사&#32;담당자&#32;정보" Top="372" VAlign="Middle" Width="126"></Static>
					<Static Align="Right" Height="24" Id="Static23" Left="477" Style="sty_lb_form_basic" TabOrder="67" Text="네고견적금액(원)&#32;" Top="57" VAlign="Middle" Width="140"></Static>
					<MaskEdit Align="Right" BindDataset="ds_zfst0202" Border="Flat" BorderColor="user13" Column="NGTT_TAMT" Height="20" Id="ed_ngttTamt" Left="620" Mask="&apos;*************&apos;" MaxLength="17" NullValue="0" Readonly="TRUE" Style="sty_ipt_form_ind" TabOrder="66" TabStop="FALSE" Top="59" Width="323"></MaskEdit>
					<MaskEdit Align="Right" BindDataset="ds_zfst0202" Border="Flat" BorderColor="user13" Column="CRNG_TAMT" Height="20" Id="ed_crngTamt" Left="620" Mask="&apos;*************&apos;" MaxLength="17" NullValue="0" Readonly="TRUE" Style="sty_ipt_form_ind" TabOrder="68" TabStop="FALSE" Top="109" Width="323"></MaskEdit>
					<Static Align="Right" Height="24" Id="Static24" Left="477" Style="sty_lb_form_basic" TabOrder="69" Text="네고환산견적금액&#32;" Top="107" VAlign="Middle" Width="140"></Static>
					<Combo BindDataset="ds_zfst0202" Border="Flat" CodeColumn="CODE" Column="DLIV_IVIC" DataColumn="CODE_NAME" Height="20" Id="cb_dlivIvic" INDEX="0" InnerDataset="ds_combo_s06" Left="148" ResetIndex="FIRST" Style="sty_ipt_form" TabOrder="11" Top="159" Width="319"></Combo>
					<Edit BindDataset="ds_zfst0202" Border="Flat" Column="DLIV" Height="20" Id="ed_dliv" Left="149" MaxLength="100" RemoveCRLF="TRUE" Style="sty_ipt_form" TabOrder="9" Top="134" Width="315"></Edit>
					<Button Cursor="HAND" Height="18" Id="btn_esmtCntr" ImageID="btn_icon_search" Left="924" OnClick="fn_esmtCntr_OnClick" Style="sty_btn" TabOrder="6" Top="35" Transparent="TRUE" Width="18"></Button>
					<Edit BindDataset="ds_zfst0202" Border="Flat" Column="WRNT_CNDT" Height="20" Id="ed_wrntCndt" Left="620" MaxLength="100" RemoveCRLF="TRUE" Style="sty_ipt_form" TabOrder="14" Top="184" Width="323"></Edit>
					<Static Align="Right" Height="24" Id="Static25" Left="477" Style="sty_lb_form_basic" TabOrder="70" Text="보증조건&#32;" Top="182" VAlign="Middle" Width="140"></Static>
					<Static Align="Right" Height="24" Id="Static12" Left="6" Style="sty_lb_form_basic" TabOrder="71" Text="발행일자&#32;" Top="257" VAlign="Middle" Width="140"></Static>
					<Calendar BindDataset="ds_zfst0202" Border="Flat" BorderColor="user13" ClickedBkColor="user32" ClickedTextColor="user33" Column="ESMT_DATE" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_esmtDate" Left="150" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="18" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="259" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="93"></Calendar>
					<Static Align="Right" Height="24" Id="Static16" Left="256" Style="sty_lb_form_basic" TabOrder="72" Text="유효일자&#32;" Top="257" VAlign="Middle" Width="140"></Static>
					<Static Align="Right" Height="24" Id="Static15" Left="477" Style="sty_lb_form_basic" TabOrder="73" Text="유효기간&#32;" Top="257" VAlign="Middle" Width="140"></Static>
					<Edit BindDataset="ds_zfst0202" Border="Flat" Column="ESMT_PROD_TEXT" Height="20" Id="ed_esmtProd" Left="670" MaxLength="100" Readonly="TRUE" Style="sty_ipt_form_ind" TabOrder="21" Top="259" Width="273"></Edit>
					<Static Align="Right" Height="24" Id="Static11" Left="477" Style="sty_lb_form_basic" TabOrder="74" Text="목적지" Top="207" VAlign="Middle" Width="140"></Static>
					<Checkbox BindDataset="ds_zfst0202" BKColor="user5" Column="PROD_INYN" FalseValue="N" Height="19" Id="chk_prodInyn" Left="620" Style="sty_ipt_form_chk" TabOrder="20" Text="수정" Top="260" TrueValue="Y" Value="FALSE" Width="48"></Checkbox>
					<Static Align="Right" Height="24" Id="Static4" Left="6" Style="sty_lb_form_basic" TabOrder="76" Text="화폐단위&#32;" Top="82" VAlign="Middle" Width="140"></Static>
					<Edit Align="CENTER" BindDataset="ds_zfst0202" Border="Flat" BorderColor="user13" Column="WAERK_NAME" Height="20" Id="ed_waerk" Left="149" MaxLength="10" Readonly="TRUE" Style="sty_ipt_form_ind" TabOrder="75" TabStop="FALSE" Top="84" UpperOnly="TRUE" Width="112"></Edit>
					<Button Cursor="HAND" Height="18" Id="btn_curyCode" ImageID="btn_icon_search" Left="262" OnClick="fn_curyCode_OnClick" Style="sty_btn" TabOrder="7" Top="85" Transparent="TRUE" Width="18"></Button>
					<Static Align="Right" Height="24" Id="Static26" Left="477" Style="sty_lb_form_basic" TabOrder="77" Text="환율&#32;" Top="82" VAlign="Middle" Width="140"></Static>
					<MaskEdit Align="Right" BindDataset="ds_zfst0202" Border="Flat" Column="UKURS" Cursor="IBEAM" DecimalLen="5" DigitLen="6" Height="20" Id="med_ukurs" Left="620" Mask="&apos;*************&apos;" MaxLength="11" NullValue="0" RightMargin="5" Style="sty_ipt_form" TabOrder="8" Top="84" TrimType="Both" Width="112"></MaskEdit>
					<Static Align="Right" Height="24" Id="Static27" Left="478" Style="sty_lb_form_basic" TabOrder="78" Text="네고금액&#32;표시여부&#32;" Top="132" VAlign="Middle" Width="140"></Static>
					<Checkbox BindDataset="ds_zfst0202" BKColor="user5" Column="NGTT_DPYN" FalseValue="N" Height="19" Id="Checkbox0" Left="620" Style="sty_ipt_form_chk" TabOrder="10" Text="네고&#32;금액&#32;표시" Top="135" TrueValue="Y" Value="FALSE" Width="104"></Checkbox>
					<Edit Align="RIGHT" BindDataset="ds_zfst0202" Border="Flat" Column="ESMT_EPDT_DAY" Height="20" Id="ed_esmtEpdt" ImeMode="none" Left="398" MaxLength="5" Number="TRUE" RemoveCRLF="TRUE" RightMargin="2" Style="sty_ipt_form" TabOrder="19" Top="259" Width="43"></Edit>
					<Static Height="17" Id="Static28" Left="446" TabOrder="79" Text="일" Top="261" VAlign="Middle" Width="10"></Static>
					<Edit BindDataset="ds_zfst0202" Border="Flat" Column="REP_NAME" Height="20" Id="ed_refName" ImeMode="none" Left="150" MaxLength="20" RemoveCRLF="TRUE" Style="sty_ipt_form" TabOrder="24" Top="393" Width="315"></Edit>
					<Edit BindDataset="ds_zfst0202" Border="Flat" Column="DEST" Height="20" Id="ed_dest" Left="620" MaxLength="100" Style="sty_ipt_form" TabOrder="16" Top="209" Width="323"></Edit>
					<Shape BKColor="user12" Bottom="257" Height="26" Id="Shape11" Left="5" LineColor="user13" Right="951" TabOrder="80" Top="231" Type="Rectangle" Width="946"></Shape>
					<Static Align="Right" Height="24" Id="Static29" Left="6" Style="sty_lb_form_basic" TabOrder="81" Text="참조" Top="232" VAlign="Middle" Width="140"></Static>
					<Edit BindDataset="ds_zfst0202" Border="Flat" Column="REF_DOCU" Height="20" Id="Edit0" Left="149" MaxLength="100" RemoveCRLF="TRUE" Style="sty_ipt_form" TabOrder="17" Top="234" Width="315"></Edit>
				</TabPage>
				<TabPage BorderColor="black" Height="471" Id="tab_esmtItem" ImageEdgeWidth="2" ImageID="tab_main" Left="2" TabOrder="32" Text="갑지&#32;품목" Top="23" Width="956">
					<Grid AutoEnter="TRUE" AutoFitEndLine="Hide" BindDataset="ds_zfst0203" BkColor2="default" BoldHead="true" Border="Flat" Bottom="457" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="25" Height="432" Id="grd_prod" InputPanel="FALSE" Left="6" LineColor="user20" LineType="ExHORZ" Right="949" RowHeight="20" Style="sty_grid" TabOrder="1" TabStop="true" Top="25" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="943">
						<contents>
							<format id="Default">
								<columns>
									<col width="30"/>
									<col width="250"/>
									<col width="160"/>
									<col width="46"/>
									<col width="45"/>
									<col width="83"/>
									<col width="102"/>
									<col width="200"/>
								</columns>
								<head>
									<cell align="center" col="0" color="user21" display="text" font="굴림,9" text="순번" wordwrap="word"/>
									<cell align="center" col="1" color="user21" display="text" font="굴림,9" text="내역" wordwrap="word"/>
									<cell align="center" col="2" color="user21" display="text" font="굴림,9" text="규격" wordwrap="word"/>
									<cell align="center" col="3" color="user21" display="text" font="굴림,9" text="단위" wordwrap="word"/>
									<cell col="4" color="user21" display="text" font="굴림,9" text="수량"/>
									<cell col="5" color="user21" display="text" font="굴림,9" text="견적금액(원)"/>
									<cell col="6" color="user21" display="text" font="굴림,9" text="환산견적금액"/>
									<cell col="7" color="user21" display="text" font="굴림,9" text="비고"/>
								</head>
								<body>
									<cell align="center" bkcolor2="user22" col="0" colid="ESMT_SBSQ" display="text" expandsize="0" expr="RowIndex&#32;+&#32;1"/>
									<cell align="left" bkcolor2="user22" col="1" colid="CNTS" display="normal" edit="normal" limit="200"/>
									<cell align="left" bkcolor2="user22" checklength="Byte" col="2" colid="STAD" display="text" edit="normal" expandsize="30" limit="100" Valign="Center"/>
									<cell align="center" bkcolor2="user22" col="3" colid="UNIT" display="text" edit="normal" expandsize="30" limit="3" Valign="Center"/>
									<cell align="right" col="4" colid="QNTY" display="number" edit="number" limit="5" LimitDec="0" Valign="Center"/>
									<cell align="right" col="5" colid="ESMT_COST" display="number" edit="number" limit="15" LimitDec="2" Valign="Center"/>
									<cell align="right" col="6" colid="CRES_COST" display="number" limit="15" LimitDec="2" Valign="Center"/>
									<cell col="7" colid="NOTE" display="text" edit="normal" limit="1000" Valign="Center"/>
								</body>
								<summary>
									<cell col="0" colspan="5" display="text">
										<cell align="center" col="0" colspan="5" display="text" text="합계"/>
									</cell>
									<cell align="right" col="5" display="number" expr="SUM(&apos;ESMT_COST&apos;)"/>
									<cell align="right" col="6" display="number" expr="SUM(&apos;CRES_COST&apos;)"/>
									<cell col="7" display="text"/>
								</summary>
							</format>
						</contents>
					</Grid>
					<Image Height="20" Id="Image1" ImageID="form_bl_title_sub" Left="2" TabOrder="2" Top="1" Width="11"></Image>
					<Static Color="user6" Font="굴림,9,Bold" Height="20" Id="Static2" Left="15" TabOrder="3" Text="견적&#32;항목" Top="3" VAlign="Middle" Width="158"></Static>
					<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_rowAdd" ImageID="btn_icon_plus" Left="900" LeftMargin="12" OnClick="fn_rowAdd_OnClick" Style="sty_btn" TabOrder="4" Top="1" Transparent="TRUE" Width="23"></Button>
					<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_rowDel" ImageID="btn_icon_minus" Left="926" LeftMargin="12" OnClick="fn_rowDel_OnClick" Style="sty_btn" TabOrder="5" Top="1" Transparent="TRUE" Width="24"></Button>
				</TabPage>
				<TabPage BorderColor="black" Height="471" Id="tab_esmtDtil" ImageEdgeWidth="2" ImageID="tab_main" Left="2" TabOrder="32" Text="을지&#32;품목" Top="23" Width="956">
					<Grid AutoEnter="TRUE" AutoFitEndLine="Hide" BindDataset="ds_zfst0204" BkColor2="default" BoldHead="true" Border="Flat" Bottom="468" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="25" Height="439" Id="grd_detail" InputPanel="FALSE" Left="6" LineColor="user20" LineType="ExHORZ" OnHeadClick="grd_detail_OnHeadClick" Right="950" RowHeight="20" Style="sty_grid" TabOrder="14" TabStop="true" Top="29" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="944">
						<contents>
							<format id="Default">
								<columns>
									<col width="0"/>
									<col width="30"/>
									<col width="79"/>
									<col width="105"/>
									<col width="250"/>
									<col width="160"/>
									<col width="50"/>
									<col width="40"/>
									<col width="100"/>
									<col width="100"/>
									<col width="200"/>
								</columns>
								<head>
									<cell col="0" display="text"/>
									<cell align="center" col="1" color="user21" display="checkbox" edit="checkbox" font="굴림,9" text="선택" wordwrap="word"/>
									<cell col="2" color="user21" display="text" font="굴림,9" text="을지출력번호"/>
									<cell col="3" color="user21" display="text" font="굴림,9" text="갑지품목"/>
									<cell align="center" col="4" color="user21" display="text" font="굴림,9" text="항목" wordwrap="word"/>
									<cell align="center" col="5" color="user21" display="text" font="굴림,9" text="규격" wordwrap="word"/>
									<cell col="6" color="user21" display="text" font="굴림,9" text="단위"/>
									<cell col="7" color="user21" display="text" font="굴림,9" text="수량"/>
									<cell col="8" color="user21" display="text" font="굴림,9" text="견적금액(원)"/>
									<cell col="9" color="user21" display="text" font="굴림,9" text="환산견적금액"/>
									<cell col="10" color="user21" display="text" font="굴림,9" text="비고"/>
								</head>
								<body>
									<cell align="center" bkcolor2="user22" col="0" display="text" edit="normal"/>
									<cell align="center" bkcolor2="user22" col="1" colid="CHK" display="checkbox" edit="checkbox" expandsize="0"/>
									<cell align="center" col="2" colid="ESMT_PGSQ" display="number" edit="number" limit="5" LimitDec="0"/>
									<cell align="center" col="3" colid="ESMT_SBSQ" combocol="CODE" combodataset="ds_combo_zfst0203" combotext="CODE_NAME" display="combo" edit="combo" limit="5" LimitDec="0"/>
									<cell align="left" bkcolor2="user22" checklength="Byte" col="4" colid="CNTS" display="text" edit="normal" expandsize="30" limit="200" Valign="Center"/>
									<cell align="left" bkcolor2="user22" col="5" colid="STAD" display="text" edit="normal" expandsize="30" limit="100" Valign="Center"/>
									<cell align="center" col="6" colid="UNIT" display="text" edit="normal" limit="3" Valign="Center"/>
									<cell align="right" col="7" colid="QNTY" display="number" edit="number" limit="5" LimitDec="0" Valign="Center"/>
									<cell align="right" col="8" colid="ESMT_COST" display="number" edit="number" expr="iif(&#32;ESMT_COST&#32;&lt;&#32;1,&#32;&apos;&apos;,&#32;ESMT_COST&#32;)" limit="15" LimitDec="2" Valign="Center"/>
									<cell align="right" col="9" colid="CRES_COST" display="number" limit="15" LimitDec="2" Valign="Center"/>
									<cell col="10" colid="NOTE" display="text" edit="normal" limit="1000" Valign="Center"/>
								</body>
							</format>
						</contents>
					</Grid>
					<Static Color="user6" Font="굴림,9,Bold" Height="20" Id="Static0" Left="22" TabOrder="1" Text="견적&#32;항목별&#32;품목" Top="4" VAlign="Middle" Width="158"></Static>
					<Image Height="20" Id="Image0" ImageID="form_bl_title_sub" Left="9" TabOrder="1" Top="2" Width="11"></Image>
					<Button Cursor="HAND" Enable="FALSE" Height="20" Id="btn_rowAdd2" ImageID="btn_icon_plus" Left="901" LeftMargin="12" OnClick="fn_rowAdd2_Onclick" Style="sty_btn" TabOrder="10" Top="4" Transparent="TRUE" Width="22"></Button>
					<Button Cursor="HAND" Enable="FALSE" Height="20" Id="btn_rowDel2" ImageID="btn_icon_minus" Left="928" LeftMargin="12" OnClick="fn_rowDel2_OnClick" Style="sty_btn" TabOrder="12" Top="4" Transparent="TRUE" Width="22"></Button>
					<Button ButtonStyle="TRUE" Cursor="HAND" Enable="FALSE" Height="20" Id="btn_escsItem" ImageID="btn_sub_08" Left="775" LeftMargin="12" OnClick="fn_escsItem_OnClick" Style="sty_btn" TabOrder="8" Text="견적원가품목추가" Top="4" Transparent="TRUE" Width="121"></Button>
					<Static Align="Right" Height="20" Id="Static40" Left="295" Style="sty_lb_form_basic" TabOrder="7" Text="을지출력번호&#32;" Top="4" VAlign="Middle" Width="94"></Static>
					<Edit Align="CENTER" Border="Flat" Height="20" Id="ed_esmtPgsq" Left="389" MaxLength="4" Number="TRUE" Style="sty_ipt_form" TabOrder="3" Top="4" Width="35"></Edit>
					<Button ButtonStyle="TRUE" Cursor="HAND" Enable="FALSE" Height="20" Id="btn_printApply" ImageID="btn_sub_02" Left="427" LeftMargin="12" OnClick="fn_printApply_OnClick" Style="sty_btn" TabOrder="4" Text="적용" Top="4" Transparent="TRUE" Width="52"></Button>
					<Static Align="Right" Height="20" Id="Static1" Left="487" Style="sty_lb_form_basic" TabOrder="9" Text="품목&#32;금액&#32;합계&#32;" Top="4" VAlign="Middle" Width="94"></Static>
					<Button ButtonStyle="TRUE" Cursor="HAND" Enable="FALSE" Height="20" Id="btn_sbsqApply" ImageID="btn_sub_02" Left="715" LeftMargin="12" OnClick="fn_sbsqApply_OnClick" Style="sty_btn" TabOrder="6" Text="적용" Top="4" Transparent="TRUE" Width="52"></Button>
					<Combo Border="Flat" CodeColumn="CODE" DataColumn="CODE_NAME" DisplayRowCnt="10" Height="20" Id="cb_esmtSbsq" INDEX="0" InnerDataset="ds_combo_zfst0203" Left="580" Style="sty_ipt_form" TabOrder="5" Top="3" Width="134"></Combo>
				</TabPage>
			</Contents>
		</Tab>
		<Static Align="Right" Height="20" Id="Static3" Left="575" Style="sty_lb_search" TabOrder="10" Text="견적원가번호&#32;" Top="5" VAlign="Middle" Width="93"></Static>
		<Edit Align="CENTER" BindDataset="ds_zfst0202" Border="Flat" BorderColor="user1" Column="ESCS_NUMB" Height="20" Id="ed_escsNumb" Left="668" MaxLength="10" Readonly="TRUE" Style="sty_ipt_form_ind" TabOrder="11" Top="5" UpperOnly="TRUE" Width="114"></Edit>
		<Static Align="Right" Height="20" Id="Static6" Left="305" Style="sty_lb_search" TabOrder="11" Text="견적총금액(B)&#32;" Top="29" VAlign="Middle" Width="100"></Static>
		<Static Align="Right" Height="20" Id="Static18" Left="8" Style="sty_lb_search" TabOrder="12" Text="견적원가총금액(A)&#32;" Top="29" VAlign="Middle" Width="124"></Static>
		<Static Align="Right" Height="20" Id="Static7" Left="575" Style="sty_lb_search" TabOrder="13" Text="시행율(A/B)&#32;" Top="29" VAlign="Middle" Width="84"></Static>
		<Static Align="Right" Height="20" Id="Static0" Left="806" Style="sty_lb_search" TabOrder="14" Text="차수&#32;" Top="5" VAlign="Middle" Width="38"></Static>
		<Edit Align="CENTER" BindDataset="ds_zfst0202" Border="Flat" BorderColor="user1" Column="ESCS_NTIM" Height="20" Id="ed_escsNtim" Left="844" MaxLength="10" Readonly="TRUE" Style="sty_ipt_form_ind" TabOrder="15" Top="5" UpperOnly="TRUE" Width="27"></Edit>
		<Static Align="Right" Height="20" Id="Static2" Left="218" Style="sty_lb_search" TabOrder="16" Text="진행상태&#32;" Top="5" VAlign="Middle" Width="68"></Static>
		<Edit BindDataset="ds_zfst0202" Border="Flat" BorderColor="user1" Column="ESMT_STAT_NAME" Height="20" Id="ed_esmtStat" Left="286" MaxLength="10" Readonly="TRUE" Style="sty_ipt_form_ind" TabOrder="17" Top="5" UpperOnly="TRUE" Width="91"></Edit>
		<Static Align="Right" Height="20" Id="Static4" Left="386" Style="sty_lb_search" TabOrder="18" Text="결재상태&#32;" Top="5" VAlign="Middle" Width="68"></Static>
		<Edit BindDataset="ds_zfst0202" Border="Flat" BorderColor="user1" Column="APPR_STAT_NAME" Height="20" Id="ed_esmtApst" Left="454" MaxLength="10" Readonly="TRUE" Style="sty_ipt_form_ind" TabOrder="19" Top="5" UpperOnly="TRUE" Width="91"></Edit>
		<Static Align="Right" Height="20" Id="Static5" Left="719" Style="sty_lb_search" TabOrder="19" Text="품목총금액&#32;" Top="29" VAlign="Middle" Width="84"></Static>
		<Button ButtonStyle="TRUE" Cursor="HAND" Enable="FALSE" Height="20" Id="btn_adocInfo" ImageID="btn_sub_04" Left="893" LeftMargin="12" OnClick="fn_adocInfo_OnClick" Style="sty_btn" TabOrder="21" Text="결재정보" Top="4" Transparent="TRUE" Width="71"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Enable="FALSE" Height="20" Id="btn_mngrReg" ImageID="btn_sub_05" Left="883" LeftMargin="12" OnClick="fn_mngrReg_OnClick" Style="sty_btn" TabOrder="22" Text="담당자등록" Top="59" Transparent="TRUE" Width="89"></Button>
		<Button Cursor="HAND" Enable="FALSE" Height="18" Id="btn_escsNumb" ImageID="btn_icon_search" Left="783" OnClick="fn_escsNumb_OnClick" TabOrder="23" Top="6" Transparent="TRUE" Width="18"></Button>
		<MaskEdit Align="Right" BindDataset="ds_zfst0200" Border="Flat" Column="ESCS_TAMT" Height="20" Id="ed_escsTamt" Left="132" Mask="&apos;*************&apos;" MaxLength="17" NullValue="0" Readonly="TRUE" Style="sty_ipt_search_ind" TabOrder="24" Top="29" Width="167"></MaskEdit>
		<MaskEdit Align="Right" BindDataset="ds_zfst0200" Border="Flat" Column="ESMT_TAMT" Height="20" Id="ed_esmtTamt" Left="405" Mask="&apos;*************&apos;" MaxLength="17" NullValue="0" Readonly="TRUE" Style="sty_ipt_search_ind" TabOrder="25" Top="29" Width="167"></MaskEdit>
		<MaskEdit Align="Right" BindDataset="ds_zfst0202" Border="Flat" Column="ESMT_TAMT" Height="20" Id="ed_esmtProdTamt" Left="803" Mask="&apos;*************&apos;" MaxLength="17" NullValue="0" Readonly="TRUE" Style="sty_ipt_search_ind" TabOrder="26" Top="29" Width="167"></MaskEdit>
		<MaskEdit Align="Right" BindDataset="ds_zfst0200" Border="Flat" Column="MRGN_RATE" Height="20" Id="ed_mrgnRate" Left="659" Mask="&apos;******&apos;" MaxLength="10" NullValue="0" Readonly="TRUE" Style="sty_ipt_search_ind" TabOrder="27" Top="29" Width="56"></MaskEdit>
		<Button ButtonStyle="TRUE" Cursor="HAND" Enable="FALSE" Height="20" Id="btn_ngttCost" ImageID="btn_sub_08" Left="759" LeftMargin="12" OnClick="fn_ngttCost_OnClick" Style="sty_btn" TabOrder="28" Text="네고견적원가수정" Top="59" Transparent="TRUE" Width="129"></Button>
	</Form>
	<Script><![CDATA[/*
 ******************************************************************************************
 * 기      능   : 사양별 템플릿 특성값 지정
 * 작  성  자   : 박수근
 * 작성  일자   : 20116.11.01
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
#include "LIB::commons.js";           // 공통 스크립트
#include "LIB::fs_common.js";         // 물류서비스 공통 스크립트

//=========================================================================================
// [ PART 1 ]
// Form에서 사용될 전역변수를 선언
// FORM에서 사용되는 전역변수는 대문자로 작성하며, F_XXX 의 형태를 갖도록 한다.
//=========================================================================================

var F_CMD = "I"; // 등록(I) / 변경(U)에 대한 구분자 

//=========================================================================================
// [ PART 2 ]
// Form Loading / Unloading 시 작업 정의
//=========================================================================================
function fn_OnLoadCompleted(obj) {
    gfn_initForm(true);             // Form 로드 이벤트 맨 첫줄에 기술
    fn_init_form();             // 폼 초기화
}

/********************************************************************************
* 기      능   : form UnloadCompleted
********************************************************************************/
function fn_OnUnloadCompleted(obj) {
    return gfn_isFormUnload(obj);
}

/********************************************************************************
* 기      능   : 폼 초기화
********************************************************************************/
function fn_init_form() {
	fn_esmateCostDataSetInit();
	fn_esmateDataSetInit();
	fn_make_ds_combo_zfst0203();
	fn_btn_control();
    var codeArray = ["S06:ds_combo_s06", "A03:ds_combo_a03"];
    // 공용코드 콤보 데이터 셑을 가져온다.
    gn_fsComboDataSet(codeArray);
    
	var sEsmtNumb = iif(FS0202003A.IsExistVar("pEsmtNumb") , pEsmtNumb, "");
	var sEscsNumb = iif(FS0202003A.IsExistVar("pEscsNumb") , pEscsNumb, "");
	var sEscsNtim = iif(FS0202003A.IsExistVar("pEscsNtim") , pEscsNtim, "");

	if ( length( sEsmtNumb ) > 0 )
	{
		ds_zfst0202.SetColumn(0, "ESMT_NUMB", sEsmtNumb);
		F_CMD = "U";
		SetTimer(1, 300);
	}
	else if( length( sEscsNumb ) > 0 && length( sEscsNtim ) > 0 )
	{
		ds_zfst0200.SetColumn(0, "ESCS_NUMB", sEscsNumb);
		ds_zfst0200.SetColumn(0, "ESCS_NTIM", sEscsNtim);
		F_CMD = "I";
		SetTimer(2, 300);
	}
}
/********************************************************************************
* 기      능   : 폼 타이머
********************************************************************************/
function FS0202003A_OnTimer(obj,nEventID)
{
	KillTimer(nEventID);
	if (nEventID == 1)
	{
		fn_query();
	}
	else if(nEventID == 2)
	{
		fn_escsQuery();
	}
	fn_btn_control();
}
/********************************************************************************
* 기      능   : 조회
********************************************************************************/
function fn_query() {
	var sEsmtNumb = ds_zfst0202.GetColumn(0, "ESMT_NUMB");
	if ( length( sEsmtNumb ) < 1 )
	{
		gfn_openMsgWin("조회할 견적서 번호를 입력해야 합니다.");
		btn_esmtNumb.Click();
		return;
	}
	
	fn_esmateCostDataSetInit();
	fn_esmateDataSetInit();
	gfn_initDs( ds_cond , true);
	ds_cond.SetColumn(0, "ESMT_NUMB", sEsmtNumb );
	
    // 조회 스크립트
    tit_clearActionInfo();
    tit_addSearchActionInfo("fs02:FS0202003A_S1");
    tit_addSearchActionInfo("fs02:FS0202003A_S2");
    tit_addSearchActionInfo("fs02:FS0202003A_S3");
    tit_addSearchActionInfo("fs02:FS0202003A_S4");
    tit_callService(
                    ""
                   ,""
                   ,"ds_cond=ds_cond ds_cond=ds_cond ds_cond=ds_cond ds_cond=ds_cond"
                   ,"ds_zfst0202=ds_zfst0202 ds_zfst0203=ds_zfst0203 ds_zfst0204=ds_zfst0204 ds_zfst0200=ds_zfst0200"
                   ,""
                   ,"fn_afterQuery"
                   ,"true"
                   ,"true"
                   ,"false"
                   );
}
function fn_afterQuery(errCode , errMsg)
{
	var nRowCount = ds_zfst0202.rowCount();
	if ( gfn_barMsgSearch( nRowCount , errCode ) ) return;
	if ( nRowCount < 1 )
	{
		gfn_showAlert("등록된 견적서가 없습니다.", "W");
		fn_esmateDataSetInit();
		fn_esmateCostDataSetInit();
		return;
	}
	F_CMD = "U";
	fn_make_ds_combo_zfst0203();
	if ( ds_zfst0202.GetColumn(0, "PROD_INYN") == 'N' )
	{
		ds_zfst0202.SetColumn(0, "ESMT_PROD_TEXT", "발행일로 부터 "+ds_zfst0202.GetColumn(0, "ESMT_EPDT_DAY")+"일");
		ds_zfst0202.ApplyChange();
	}
	fn_btn_control();
}
/********************************************************************************
* 기      능   : 승인 10
********************************************************************************/
function fn_approval() { 
    var aDocNumb = ds_zfst0202.GetColumn(0, "ESMT_NUMB"); 
    if ( length( aDocNumb ) < 1 )
    {
		gfn_openMsgWin("견적서가 생성되지 않았습니다.", "W");
		return;
    }
    if ( ds_zfst0202.GetUpdate() || ds_zfst0203.GetUpdate() || ds_zfst0204.GetUpdate() )
    {
		gfn_openMsgWin("변경사항이 저장되지 않았습니다.", "W");
		return;
    }
	gfn_initDs( ds_doc_appr, true );
	ds_doc_appr.SetColumn(0, "ADOC_CLAS", "ES" );
	ds_doc_appr.SetColumn(0, "ADOC_NUMB", aDocNumb );
	ds_doc_appr.SetColumn(0, "ADOC_NTIM", 1);
	tit_clearActionInfo();
	tit_addSingleActionInfo("fs01:FS_COM0701_S1"); 
	tit_callService(
					""
				   ,""
				   ,"ds_cond=ds_doc_appr"
				   ,"ds_zfst0103=ds_zfst0103"
				   ,""
				   ,"fn_afterApproval"
				   ,"true"
				   ,"true"
				   ,"false"
				   );
}
function fn_afterApproval(errCode, errMsg)
{
	if ( gfn_barMsgSearch(ds_zfst0103.GetRowCount(), errCode) )  return;
	var aRtn = gfn_docApprInfo(ds_zfst0103);

	if( aRtn[2] != G_USER_ID ) 
	{
		gfn_openMsgWin("승인 권한이 없습니다.", "W", "A", "");
		return;
	}
	if( gfn_showConfirm("승인 하시겠습니까?") ) {
		gfn_initDs( ds_doc_appr, true );
		
		ds_doc_appr.SetColumn(0, "ADOC_CLAS", "ES" );
		ds_doc_appr.SetColumn(0, "ADOC_NUMB", ds_zfst0202.GetColumn(0, "ESMT_NUMB") );
		ds_doc_appr.SetColumn(0, "ADOC_NTIM", 1);
		ds_doc_appr.SetColumn(0, "APPR_STAT", aRtn[1]);  
		
		tit_clearActionInfo();
		tit_addSingleActionInfo("fs01:FS_COM0701_M2");  // 결재 테이블 상태값 처리
		tit_addSingleActionInfo("fs01:FS_COM0701_U2");  // 견적 문서 상태값 처리
		tit_callService(
						""
					   ,""
					   ,"ds_doc_appr=ds_doc_appr ds_doc_stat=ds_doc_appr"
					   ,""
					   ,""
					   ,"fn_postApproval"
					   ,"true"
					   ,"true"
					   ,"false"
					   );
    }
}
function fn_postApproval(errCode, errMsg)
{
	if ( gfn_barMsgSearch(0, errCode) )  return;
	gfn_openMsgWin("결재 되었습니다.", "I", "A", "");
	fn_query();
}
/********************************************************************************
* 기      능   : 기안
********************************************************************************/
function fn_draft()
{
    var aDocClas = "ES";
    var aDocNumb = ds_zfst0202.GetColumn(0, "ESMT_NUMB");
    var aDocNtim = "1";
    if ( length( aDocNumb ) < 1 )
    {
		gfn_openMsgWin("견적서가 생성되지 않았습니다.", "W", "A", "");
		return;
    }
    if ( ds_zfst0202.GetUpdate() || ds_zfst0203.GetUpdate() || ds_zfst0204.GetUpdate() )
    {
		gfn_openMsgWin("변경사항이 저장되지 않았습니다.", "W", "A", "");
		return;
    }
	if ( ds_zfst0202.GetColumn(0, "ESMT_TAMT") != ds_zfst0200.GetColumn(0, "ESMT_TAMT") )
	{
		gfn_openMsgWin("견적원가의 견적금액과 견적서의 견적금액의 합이 달르면 기안할 수 없습니다.", "E", "A", "");
		return;
	}
    var arg="aDocClas="+ Quote(aDocClas) +" aDocNumb="+Quote(aDocNumb)+" aDocNtim="+Quote(aDocNtim)+" disableDecide=true";
    var aRtn = gfn_openPopup("FS_COM0701", true, arg);

    if (length(aRtn+"") > 0)
    {
		fn_query();
    }
}
/********************************************************************************
* 기      능   : 재견적
********************************************************************************/
function fn_recost() {
	ds_zfst0202.SetColumn(0, "ESMT_NUMB", "");
	ds_zfst0202.SetColumn(0, "ESMT_STAT", "130");
	ds_zfst0202.SetColumn(0, "ESMT_STAT_NAME", "견적작성중");
	ds_zfst0202.SetColumn(0, "APPR_STAT", "110");
	ds_zfst0202.SetColumn(0, "APPR_STAT_NAME", "작성중");
	F_CMD = "I";
	fn_btn_control();
}
/********************************************************************************
* 기      능   : 삭제
********************************************************************************/
function fn_delete() {
	var sEsmtStat = ds_zfst0202.GetColumn(0, "ESMT_STAT");
	if ( sEsmtStat == "150" ) 
	{
		gfn_openMsgWin("승인된 견적서는 삭제할 수 없습니다.", "W", "A", "");
		return;
	}
	var arg = ["견적서"];
	if ( !gfn_openMsgWin(gfn_getMsg("CI00015", arg), "I", "C", "CI00015") ) return;
    gfn_initDs( ds_cond , true);
	ds_cond.SetColumn(0, "ESMT_NUMB", ds_zfst0202.GetColumn(0, "ESMT_NUMB") ); 
	
    // 조회 스크립트
    tit_clearActionInfo();
    tit_addSingleActionInfo("fs02:FS0202003A_D3");
    tit_addSingleActionInfo("fs02:FS0202003A_D2");
    tit_addSingleActionInfo("fs02:FS0202003A_D1");
    tit_callService(
                    ""
                   ,""
                   ,"ds_zfst0204_d=ds_cond ds_zfst0203_d=ds_cond ds_zfst0202=ds_cond"
                   ,""
                   ,""
                   ,"fn_afterDelete"
                   ,"true"
                   ,"true"
                   ,"false"
                   );
}
function fn_afterDelete(errCode, errMsg)
{
	if( gfn_barMsgDelete(errCode) ) return;
	fn_esmateCostDataSetInit();
	fn_esmateDataSetInit();
	gfn_initDs( ds_cond , true);
}

/********************************************************************************
* 기      능   : 저장
********************************************************************************/
function fn_save() {
	if ( ds_zfst0202.GetUpdate() || ds_zfst0203.GetUpdate() || ds_zfst0204.GetUpdate() )
	{
		
		var nCount203 = ds_zfst0203.GetRowCount();
		var nCount204 = ds_zfst0204.getRowCount();
		var iRow = 0;
		var nRow = 0;
		var nEsmtSbsq = 0;
		
		var arg = [];
		// 발주처명
		if ( length( trim( ds_zfst0202.GetColumn(0, "ORCU_NAME") + "" ) ) < 1 )
		{
			arg[0] = "발주처명";
			gfn_showAlert("CW00001", arg);
			return;
		}
		// 사업명
		if ( length( trim( ds_zfst0202.GetColumn(0, "BSNS_NAME") + "" ) ) < 1 )
		{
			arg[0] = "사업명";
			gfn_showAlert("CW00001", arg);
			return;
		}
		// 국가
		if ( length( trim( ds_zfst0202.GetColumn(0, "ESMT_CNTR") + "" ) ) < 1 )
		{
			arg[0] = "국가";
			gfn_showAlert("CW00001", arg);
			return;
		}
		// 화폐단위
		if ( length( trim( ds_zfst0202.GetColumn(0, "WAERK") + "" ) ) < 1 )
		{
			arg[0] = "화폐단위";
			gfn_showAlert("CW00001", arg);
			return;
		}
		// 환율
		if ( length( trim( ds_zfst0202.GetColumn(0, "UKURS") + "" ) ) < 1 )
		{
			arg[0] = "환율";
			gfn_showAlert("CW00001", arg);
			return;
		}
		// 납기
		if ( length( trim( ds_zfst0202.GetColumn(0, "DLIV") + "" ) ) < 1 )
		{
			arg[0] = "납기";
			gfn_showAlert("CW00001", arg);
			return;
		}
		// 인도조건
		if ( length( trim( ds_zfst0202.GetColumn(0, "DLIV_IVIC") + "" ) ) < 1 && length( trim( ds_zfst0202.GetColumn(0, "DLIV_OTHR") + "" ) ) < 1 )
		{
			arg[0] = "인도조건";
			gfn_showAlert("CW00001", arg);
			return;
		}
		// 지불조건
		if ( length( trim( ds_zfst0202.GetColumn(0, "PAYT_TERM") + "" ) ) < 1 )
		{
			arg[0] = "지불조건";
			gfn_showAlert("CW00001", arg);
			return;
		}
		// 보증조건
		if ( length( trim( ds_zfst0202.GetColumn(0, "WRNT_CNDT") + "" ) ) < 1 )
		{
			arg[0] = "보증조건";
			gfn_showAlert("CW00001", arg);
			return;
		}
		// 검사조건
		if ( length( trim( ds_zfst0202.GetColumn(0, "INSP_CDT") + "" ) ) < 1 )
		{
			arg[0] = "검사조건";
			gfn_showAlert("CW00001", arg);
			return;
		}
		// 목적지(국외)
		if (ds_zfst0202.GetColumn(0, "ESMT_CNTR") != "KR" && length( trim( ds_zfst0202.GetColumn(0, "DEST") + "" ) ) < 1 )
		{
			arg[0] = "목적지";
			gfn_showAlert("CW00001", arg);
			return;
		}
		// 유효기간 ESMT_EPDT_DAY
		if ( ds_zfst0202.GetColumn(0, "PROD_INYN") != "Y" && parseInt( ds_zfst0202.GetColumn(0, "ESMT_EPDT_DAY") ) < 1 )
		{
			arg[0] = "유효기간";
			gfn_showAlert("CW00001", arg);
			return;
		}
		if ( ds_zfst0202.GetColumn(0, "PROD_INYN") == "Y" )
		{
			if ( length( trim( ds_zfst0202.GetColumn(0, "ESMT_PROD_TEXT") + "" ) ) < 1 )
			{
				arg[0] = "유효기간";
				gfn_showAlert("CW00001", arg);
				return;
			}
			else
			{
				ds_zfst0202.SetColumn(0, "ESMT_PROD", trim( ds_zfst0202.GetColumn(0, "ESMT_PROD_TEXT")) );
			}
		}
		// 발행일자
		if ( length( trim( ds_zfst0202.GetColumn(0, "ESMT_DATE") + "" ) ) < 1 )
		{
			arg[0] = "발행일자";
			gfn_showAlert("CW00001", arg);
			return;
		}
		// 갑지 품목수
		if ( nCount203 < 1 )
		{ 
			gfn_openMsgWin("등록할 갑지 품목이 없습니다.", "W", "A", "");
			return;
		}
		else
		{
			for( iRow = 0; iRow < nCount203; iRow++ )
			{
				if ( length( trim( ds_zfst0203.GetColumn(iRow, "CNTS") ) ) < 1 )
				{
					arg[0] = "갑지의 품목 내역";
					gfn_showAlert("CW00001", arg);
					tab_esmt.TabIndex = 1;
					tab_esmt.tab_esmtItem.grd_prod.row = iRow;
					return;
				}
			}
		}
		// 을지 
		if ( nCount204 > 0 )
		{
			for( iRow = 0; iRow < nCount203; iRow++ )
			{
				if ( length( trim( ds_zfst0203.GetColumn(iRow, "CNTS") ) ) < 1 )
				{
					arg[0] = "을지의 품목 내역";
					gfn_showAlert("CW00001", arg);
					tab_esmt.TabIndex = 1;
					tab_esmt.tab_esmtItem.grd_prod.row = iRow;
					return;
				}
			}
		}
		
		if ( ds_zfst0202.GetColumn(0, "ESMT_TAMT") != ds_zfst0200.GetColumn(0, "ESMT_TAMT") )
		{
			if ( !gfn_openMsgWin("견적원가의 견적금액과 입력하신 견적금액의 합이 서로 다름니다.\n" +
								"저장하시겠습니까?", "W", "C", "") ) return;
		}
		else
		{
			if ( !gfn_openMsgWin("견적서를 저장하시겠습니까?", "I", "C", "") ) return;
		}
		
		gfn_initDs(ds_cond, true);
		ds_cond.SetColumn(0, "ESCS_NUMB", ds_zfst0202.GetColumn(0, "ESCS_NUMB"));
		ds_cond.SetColumn(0, "ESCS_NTIM", ds_zfst0202.GetColumn(0, "ESCS_NTIM"));
		ds_cond.SetColumn(0, "ESMT_NUMB", "");
		ds_cond.SetColumn(0, "WAERK", ds_zfst0202.GetColumn(0, "WAERK") );
		ds_cond.SetColumn(0, "OT_UKURS", ds_zfst0202.GetColumn(0, "OT_UKURS") );
		ds_cond.SetColumn(0, "UKURS", ds_zfst0202.GetColumn(0, "UKURS") );
		// 조회 스크립트
		tit_clearActionInfo();
		tit_addSearchActionInfo("fs02:FS0202003A_S4");
		tit_callService(
						""
					   ,""
					   ,"ds_cond=ds_cond"
					   ,"ds_zfst0200=ds_zfst0200"
					   ,""
					   ,"fn_preSave"
					   ,"true"
					   ,"true"
					   ,"false"
					   );
		
	}
	else
	{
		gfn_showMsg("CW00005");
	}
}
function fn_preSave(errCode, errMsg)
{

	if ( errCode != 0 ) return;

	if ( ds_zfst0200.GetRowCount() > 0 )
	{
		if (ds_zfst0200.GetColumn(0, "OCNT_PDYN") == "Y")
		{
			gfn_openMsgWin("선택한 견적원가는 이미 수주 등록되었습니다.\n"+
							"다른 견적원가를 선택하시기 바랍니다.", "W", "A", "");
			return;
		}

		if (ds_zfst0200.GetColumn(0, "ESCS_STAT") != "050")
		{
			gfn_openMsgWin("선택한 견적원가는 견적서를 발행할 수 없는 상태입니다.", "W", "A", "");
			return;
		}
	
		var nCount203 = ds_zfst0203.GetRowCount();
		var nCount204 = ds_zfst0204.getRowCount();
		var iRow = 0;
		var nRow = 0;
		var nEsmtSbsq = 0;
		
		ds_cond.SetColumn(0, "ACTION_CMD", F_CMD );
		ds_cond.SetColumn(0, "ESMT_NUMB", ds_zfst0202.GetColumn(0, "ESMT_NUMB"));

		tab_esmt.tab_esmtDtil.grd_detail.Redraw = false;
		
		ds_zfst0203.FireEvent = false;
		for( iRow = 0; iRow < nCount203; iRow++ )
		{
			ds_zfst0203.SetColumn(iRow, "ESMT_SBSQ", iRow+1);
		}
		ds_zfst0203.FireEvent = true;

		ds_zfst0204.FireEvent = false;
		for( iRow = 0; iRow < nCount204; iRow++ )
		{
			ds_zfst0204.SetColumn(iRow, "ESMT_ITSQ", iRow +1 );
			nEsmtSbsq = ds_zfst0204.GetColumn(iRow, "ESMT_SBSQ");
			nRow = ds_combo_zfst0203.FindRow("CODE", nEsmtSbsq );
			ds_zfst0204.SetColumn(iRow, "ESMT_SBSQ", iif( nRow < 1, 0, nRow ));
		}
		ds_zfst0204.FireEvent = true;
		tab_esmt.tab_esmtDtil.grd_detail.Redraw = true;
		
		tit_clearActionInfo();
		tit_addSearchActionInfo("fs02:FS0202003A_S6", true);
		tit_addSingleActionInfo("fs02:FS0202003A_M1");
		tit_addSingleActionInfo("fs02:FS0202003A_D2");
		tit_addSingleActionInfo("fs02:FS0202003A_D3");
		tit_addMultiActionInfo("fs02:FS0202003A_I1"); 
		tit_addMultiActionInfo("fs02:FS0202003A_I2"); 
		tit_addSingleActionInfo("fs02:FS0202003A_U3");
		tit_callService(
						""
					   ,""
					   ,"ds_cond=ds_cond ds_zfst0202=ds_zfst0202 ds_zfst0203_d=ds_cond ds_zfst0204_d=ds_cond ds_zfst0203=ds_zfst0203 ds_zfst0204=ds_zfst0204 ds_zfst0202=ds_zfst0202"
					   ,"ds_zfst0202_key=ds_zfst0202_key"
					   ,"ACTION_CMD="+F_CMD
					   ,"fn_afterSave"
					   ,"true"
					   ,"true"
					   ,"false"
					   );
	
	}
	else
	{
		gfn_openMsgWin("견적원가에 대하여 견적서를 발행할 수 없는 상태입니다.", "W", "A", "");
	}
}
function fn_afterSave(errCode, errMsg)
{
	if( gfn_barMsgSave(errCode) ) return true;
	if ( length( ds_zfst0202.GetColumn(0, "ESMT_NUMB") ) < 1 )
	{
		ds_zfst0202.SetColumn(0, "ESMT_NUMB", ds_zfst0202_key.GetColumn(0, "ESMT_NUMB") );
	}
	F_CMD = "U";
	fn_query();
}
/********************************************************************************
* 기      능   : 출력
********************************************************************************/
function fn_print() {
	Create("Dataset", "ds_zfst0200_p", "DatasetType='Dataset'");
	Create("Dataset", "ds_zfst0202_p", "DatasetType='Dataset'");
	Create("Dataset", "ds_zfst0203_p", "DatasetType='Dataset'");
	Create("Dataset", "ds_zfst0204_p", "DatasetType='Dataset'"); 
	Create("Dataset", "ds_zfst0204_g_p", "DatasetType='Dataset'"); 
	ds_zfst0200_p.Copy(ds_zfst0200);
	ds_zfst0202_p.Copy(ds_zfst0202);
	ds_zfst0203_p.Copy(ds_zfst0203);
	ds_zfst0204_p.Copy(ds_zfst0204);
	ds_zfst0204_g_p.AddColumn("ESMT_PGSQ", "Decimal");
	ds_zfst0204_g_p.AddColumn("ESMT_COST", "Decimal");
	
	if ( ds_zfst0202_p.GetColIndex("DLIV_IVIC_NAME") < 0 ){
		ds_zfst0202_p.AddColumn("DLIV_IVIC_NAME", "String");
	}
	ds_zfst0202_p.SetColumn(0, "DLIV_IVIC_NAME", tab_esmt.tab_esmtInfo.cb_dlivIvic.Text);
	if( ds_zfst0202_p.GetColumn( 0, "ESMT_PROD" ) == "" )
	{
		ds_zfst0202_p.SetColumn( 0, "ESMT_PROD_TEXT" , datetime( ds_zfst0202_p.GetColumn( 0, "ESMT_EPDT" ) ) - datetime( ds_zfst0202_p.GetColumn( 0, "ESMT_DATE" ) ) );
	}
	ds_zfst0204_p.AddColumn("ESMT_SBSQ_NAME", "String");
	var nRowCount = ds_zfst0204_p.GetRowCount();
	var iRow = 0;
	var gRow = 0;
	var findRow = -1;
	var nEsmtPgsq = -1;
	for( ; iRow < nRowCount; iRow++ )
	{
		ds_zfst0204_p.SetColumn(iRow, "ESMT_SBSQ_NAME", ds_zfst0203_p.LookUp("ESMT_SBSQ", ds_zfst0204_p.GetColumn(iRow, "ESMT_SBSQ"), "CNTS") );
		nEsmtPgsq = ds_zfst0204_p.GetColumn( iRow, "ESMT_PGSQ" );
		findRow = ds_zfst0204_g_p.FindRow("ESMT_PGSQ", nEsmtPgsq );
		if ( findRow < 0 ) 
		{
			gRow = ds_zfst0204_g_p.AppendRow();
			ds_zfst0204_g_p.SetColumn(gRow, "ESMT_PGSQ", nEsmtPgsq );
			ds_zfst0204_g_p.SetColumn(gRow, "ESMT_COST", ds_zfst0204_p.CaseSum( "ESMT_PGSQ=="+nEsmtPgsq, "ESMT_COST" ) );
		}
	} 
	Dialog("FS02::FS0202003C.xml", "");
	Destroy("ds_zfst0200_p");
	Destroy("ds_zfst0202_p");
	Destroy("ds_zfst0203_p");
	Destroy("ds_zfst0204_p");
	Destroy("ds_zfst0204_g_p");
}
/********************************************************************************
* 기      능   : 액셀  
********************************************************************************/
function fn_excel() {
	// Excel Export 
	if ( tab_esmt.TabIndex == 0 ) gfn_openMsgWin("마스터정보는 엑셀로 저장되지 않습니다.", "I", "A", "");
	else if ( tab_esmt.TabIndex == 1 ) gfn_saveToExcel(tab_esmt.tab_esmtItem.grd_prod, true );
	else if ( tab_esmt.TabIndex == 2 ) gfn_saveToExcel(tab_esmt.tab_esmtDtil.grd_detail, true );
}
/********************************************************************************
* 기      능   : 반송 65
********************************************************************************/
function fn_sendback() {
	var sApprStat = ds_zfst0202.GetColumn(0, "APPR_STAT");
	var sEsmtNumb = ds_zfst0202.GetColumn(0, "ESMT_NUMB");
	if ( length( trim( sEsmtNumb + "" ) ) < 1 ) return;
	if ( sApprStat == '190' || sApprStat == '290' )
	{
		if ( gfn_openMsgWin("견적서를 반송하시겠습니까?", "I", "C", "") )
		{
			var arg = " aDocClas='ES' aDocNumb=" + Quote( sEsmtNumb ) + " aDocNtim=1";
			var aRtn = gfn_openPopup("FS_COM0703", true, arg);
			if ( length( aRtn + "" ) > 0 )
			{
				 ds_zfst0202.SetColumn(0, "ESMT_NUMB", aRtn[0]); 
				 fn_Query();
			}
		}
	}
}
/********************************************************************************
* 기      능   : 닫기
********************************************************************************/
function fn_close() 
{
	gfn_formClose( ds_zfst0202.GetUpdate() || ds_zfst0203.GetUpdate() || ds_zfst0204.GetUpdate() );
}
/********************************************************************************
* 기      능   : 견적원가 데이티셋 초기화
********************************************************************************/
function fn_esmateCostDataSetInit()
{
	gfn_initDs( ds_zfst0200 , true);
	ds_zfst0200.ApplyChange();
}
/********************************************************************************
* 기      능   : 견적서 데이티셋 초기화
********************************************************************************/
function fn_esmateDataSetInit()
{
	F_CMD = "I";
	gfn_initDs( ds_zfst0202 , true);
	ds_zfst0202.SetColumn(0, "DLIV_IVIC", "");
	ds_zfst0202.SetColumn(0, "WAERK", "KRW");
	ds_zfst0202.SetColumn(0, "WAERK_NAME", "대한민국 원");
	ds_zfst0202.SetColumn(0, "ESMT_CNTR", "KR");
	ds_zfst0202.SetColumn(0, "ESMT_CNTR_NAME", "한국");
	ds_zfst0202.SetColumn(0, "OT_UKURS", 1);
	ds_zfst0202.SetColumn(0, "UKURS", 1);
	ds_zfst0202.SetColumn(0, "ESMT_DATE", gfn_getCurrDate() );
	ds_zfst0202.SetColumn(0, "ESMT_EPDT_DAY", 30); 
	ds_zfst0202.SetColumn(0, "ESMT_STAT", "130");
	ds_zfst0202.SetColumn(0, "ESMT_STAT_NAME", "견적작성중");
	ds_zfst0202.SetColumn(0, "APPR_STAT", "110");
	ds_zfst0202.SetColumn(0, "APPR_STAT_NAME", "작성중");
	ds_zfst0202.SetColumn(0, "DRAF", G_USER_ID );
	ds_zfst0202.SetColumn(0, "ADIT", "" );
	ds_zfst0202.SetColumn(0, "APPR", "" );
	ds_zfst0202.ApplyChange();
	
	gfn_initDs( ds_zfst0203 , false);
    ds_zfst0203.ApplyChange();
    
    gfn_initDs( ds_zfst0204 , false);
    ds_zfst0204.ApplyChange();
    
}

/********************************************************************************
* 기      능   : 견적서조회 팝업을 호출한다.
********************************************************************************/
function fn_esmtNumb_OnClick(obj)
{
	var arg="";
	var aRtn = gfn_openPopup("FS0202003B", true, arg);
	if ( length( aRtn ) > 0 )
	{
		 ds_zfst0202.SetColumn(0, "ESMT_NUMB", aRtn[0]); 
		 fn_Query();
	}
}

/********************************************************************************
* 기      능   : 견적원가번호조회 팝업을 호출한다.
********************************************************************************/
function fn_escsNumb_OnClick(obj)
{
	var sApprStat = ds_zfst0202.GetColumn(0, "APPR_STAT");
	var sEsmtStat = ds_zfst0202.GetColumn(0, "ESMT_STAT");
	if ( sEsmtStat != '150' && sEsmtStat != '140' )
	{
		var arg=" esmtTrgt='Y'";
		var aRtn = gfn_openPopup("FS0201001B", true, arg);
		if ( length( aRtn ) > 0 )
		{
			 ds_zfst0200.SetColumn(0, "ESCS_NUMB", aRtn[0]);
			 ds_zfst0200.SetColumn(0, "ESCS_NTIM", aRtn[1]);
			 fn_escsQuery();
		}
	}
	else
	{
		gfn_openMsgWin("결재중이거나 승인된 견적서는 견적원가를 변경할 수 없습니다.", "W", "A", "");
		return;
	}
}

/********************************************************************************
* 기      능   : 견적 원가 조회후 원가의 정보를 반영한다.
********************************************************************************/
function fn_escsQuery()
{
	if ( length( trim(ds_zfst0202.GetColumn(0, "ESMT_NUMB") + "") ) != 0 ) {
		if ( !gfn_openMsgWin("작성된 견적서의 견적원가를 다시 선택하면 새로운 견적서를 작성해야만 합니다.\n"+
							 "다시 작성하시겠습니까?", "I", "C", "") ) return;
		fn_recost();
	}
	gfn_initDs(ds_cond, true);
	ds_cond.SetColumn(0, "ESCS_NUMB", ds_zfst0200.GetColumn(0, "ESCS_NUMB"));
	ds_cond.SetColumn(0, "ESCS_NTIM", ds_zfst0200.GetColumn(0, "ESCS_NTIM"));
	ds_cond.SetColumn(0, "ESMT_NUMB", "");
	ds_cond.SetColumn(0, "WAERK", ds_zfst0202.GetColumn(0, "WAERK") );
	ds_cond.SetColumn(0, "OT_UKURS", ds_zfst0202.GetColumn(0, "OT_UKURS") );
	ds_cond.SetColumn(0, "UKURS", ds_zfst0202.GetColumn(0, "UKURS") );
    // 조회 스크립트
    tit_clearActionInfo();
    tit_addSearchActionInfo("fs02:FS0202003A_S4");
    tit_addSearchActionInfo("fs02:FS0202003A_S5");
    tit_callService(
                    ""
                   ,""
                   ,"ds_cond=ds_cond ds_cond=ds_cond"
                   ,"ds_zfst0200=ds_zfst0200 ds_zfst0201=ds_zfst0201"
                   ,""
                   ,"fn_afterEscsQuery"
                   ,"true"
                   ,"true"
                   ,"false"
                   );
}
function fn_afterEscsQuery(errCode, errMsg)
{ 
    if (errCode != 0 || ds_zfst0200.GetRowCount() < 1 ) return;
	gfn_showMsg("CI00001");
	ds_zfst0202.FireEvent = false;
	
	var ukurs = parseFloat( ds_zfst0202.GetColumn(0, "UKURS") ); 
	var ukursRate = parseFloat( ds_zfst0202.GetColumn(0, "UKURS_RATE") );
	
	ds_zfst0202.SetColumn(0, "ESCS_NUMB", ds_zfst0200.GetColumn(0, "ESCS_NUMB") );
	ds_zfst0202.SetColumn(0, "ESCS_NTIM", ds_zfst0200.GetColumn(0, "ESCS_NTIM") );
	ds_zfst0202.SetColumn(0, "BSNS_NAME", ds_zfst0200.GetColumn(0, "POST1") );
	ds_zfst0202.SetColumn(0, "KUNNR", ds_zfst0200.GetColumn(0, "KUNNR") );
	ds_zfst0202.SetColumn(0, "ORCU_NAME", ds_zfst0200.GetColumn(0, "KUNNR_NAME") );
	ds_zfst0202.SetColumn(0, "ORDR_TYPE", ds_zfst0200.GetColumn(0, "ORDR_TYPE") );
	ds_zfst0202.SetColumn(0, "ORDR_TYPE_NAME", ds_zfst0200.GetColumn(0, "ORDR_TYPE_NAME") );
	ds_zfst0202.SetColumn(0, "WAERK", ds_zfst0200.GetColumn(0, "WAERK") );
	ds_zfst0202.SetColumn(0, "WAERK_NAME", ds_zfst0200.GetColumn(0, "WAERK_NAME") );
	ds_zfst0202.SetColumn(0, "ESMT_TAMT", 0 ) ;//ds_zfst0200.GetColumn(0, "ESMT_TAMT") );
	ds_zfst0202.SetColumn(0, "NGTT_TAMT", ds_zfst0200.GetColumn(0, "NGTT_TAMT") );
	ds_zfst0202.SetColumn(0, "CRES_TAMT", 0 ) ;//fn_ExangeEstmateCost( parseFloat( ds_zfst0200.GetColumn(0, "ESMT_TAMT") ), ukurs , otUkurs ) );
	ds_zfst0202.SetColumn(0, "CRNG_TAMT", fn_ExangeEstmateCost( parseFloat( ds_zfst0200.GetColumn(0, "NGTT_TAMT") ) , ukurs , ukursRate ) );
	ds_zfst0202.SetColumn(0, "ESMT_CNTR", ds_zfst0200.GetColumn(0, "ESMT_CNTR") );
	ds_zfst0202.SetColumn(0, "ESMT_CNTR_NAME", ds_zfst0200.GetColumn(0, "ESMT_CNTR_NAME") );
	ds_zfst0202.SetColumn(0, "SALE_PRSN", ds_zfst0200.GetColumn(0, "SALE_PRSN") );
	ds_zfst0202.SetColumn(0, "SALE_PRSN_NAME", ds_zfst0200.GetColumn(0, "SALE_PRSN_NAME") );
	ds_zfst0202.SetColumn(0, "OCNT_PDYN", ds_zfst0200.GetColumn(0, "OCNT_PDYN") );
	ds_zfst0202.SetColumn(0, "OCNT_PDDT", ds_zfst0200.GetColumn(0, "OCNT_PDDT") );
	
	ds_zfst0202.FireEvent = true;
	if ( gfn_openMsgWin("고객사 담당자 정보를 갱신하시겠습니까?", "I", "C") )
	{
		ds_zfst0202.FireEvent = false;
		ds_zfst0202.FireEvent = true;
		ds_zfst0202.SetColumn(0, "REP_NAME", ds_zfst0200.GetColumn(0, "REP_NAME") );
		ds_zfst0202.SetColumn(0, "KUNNR_CTAT", ds_zfst0200.GetColumn(0, "KUNNR_CTAT") );
		ds_zfst0202.SetColumn(0, "HTEL", ds_zfst0200.GetColumn(0, "HTEL") );
		ds_zfst0202.SetColumn(0, "FAX", ds_zfst0200.GetColumn(0, "FAX") );
		ds_zfst0202.SetColumn(0, "EMAIL", ds_zfst0200.GetColumn(0, "EMAIL") );
	}
	var bReload204 = true;
	if (ds_zfst0204.GetRowCount() > 0 )
	{
		bReload204 = gfn_openMsgWin("견적서 을지 품목 정보를 모두 갱신하시겠습니까?", "I", "C" );
	}
	if ( bReload204 )
	{
		ds_zfst0204.ClearData();
		ds_zfst0204.FireEvent = false;
		var iRow = 0;
		var nRowCount = ds_zfst0201.GetRowCount();
		
		while( iRow < nRowCount )
		{
			iRow = ds_zfst0204.AppendRow();
			ds_zfst0204.CopyRow(iRow, ds_zfst0201, iRow);
			ds_zfst0204.SetColumn(iRow, "ESMT_ITSQ", iRow);
			iRow++;
		}
		ds_zfst0204.FireEvent = true;
	}
	ds_zfst0202_WAERK_UKURS_Changed();
	
	if (ds_zfst0200.GetColumn(0, "OCNT_PDYN") == "Y")
	{
		gfn_openMsgWin("선택한 견적원가는 이미 수주 등록되었습니다.\n"+
						"다른 견적원가를 선택하시기 바랍니다.", "W", "A", "");
	}
}

/********************************************************************************
* 기      능   : 담당자등록 팝업을 호출한다.
********************************************************************************/
function fn_mngrReg_OnClick(obj)
{
    var arg="";
    gfn_openPopup("FS0103001B", true, arg);
}

/********************************************************************************
* 기      능   : 결재정보 팝업을 호출한다.
********************************************************************************/
function fn_adocInfo_OnClick(obj)
{
    var aDocClas = "ES";
    var aDocNumb = ds_zfst0202.GetColumn(0, "ESMT_NUMB");
    var aDocNtim = "1";
    if ( length( aDocNumb ) < 1 )
    {
		gfn_openMsgWin("견적서가 생성되지 않았습니다.", "W");
		return;
    }
    var arg="aDocClas="+ Quote(aDocClas) +" aDocNumb="+Quote(aDocNumb)+" aDocNtim="+Quote(aDocNtim);
    gfn_openPopup("FS_COM0702", true, arg);
}

/********************************************************************************
* 기      능   : 화폐단위 팝업을 호출한다.
********************************************************************************/
function fn_curyCode_OnClick(obj)
{
	var aRtn = gfn_openPopup("FS_COM0103", true, "");
	if (length(aRtn) > 0)
	{
		ds_zfst0202.SetColumn(0, "WAERK", aRtn[0]);
		ds_zfst0202.SetColumn(0, "OT_UKURS", aRtn[1]);
		ds_zfst0202.SetColumn(0, "WAERK_NAME", aRtn[2]);
		ds_zfst0202.SetColumn(0, "UKURS", aRtn[3]);
		ds_zfst0202.SetColumn(0, "UKURS_RATE", aRtn[5]);
		ds_zfst0202_WAERK_UKURS_Changed();
	}
}

/********************************************************************************
* 기      능   : 견적 국가 팝업을 호출한다.
********************************************************************************/
function fn_esmtCntr_OnClick(obj)
{
	var aRtn = gfn_openPopup("FS_COM0901", true, "");
	if (length(aRtn) > 0)
	{
		ds_zfst0202.SetColumn(0, "ESMT_CNTR", aRtn[0]);
		ds_zfst0202.SetColumn(0, "ESMT_CNTR_NAME", aRtn[1]);
	}
}

/********************************************************************************
* 기      능   : 영업담당자 선텍
********************************************************************************/
function fn_salePrsn_OnClick(obj)
{
    var aRtn = gfn_openPopup("FS_COM0801", true, "");
    if ( length( aRtn ) > 0 )
    {
		ds_zfst0202.SetColumn(0, "SALE_PRSN", aRtn[0]);
		ds_zfst0202.SetColumn(0, "SALE_PRSN_NAME", aRtn[1]);
    }
}
/********************************************************************************
* 기      능   : 갑지 품목 추가
********************************************************************************/
function fn_rowAdd_OnClick(obj)
{
	var nMaxSbSq = 1;
	var nRowCount = ds_zfst0203.GetRowCount() ;
	if ( nRowCount > 0 ) nMaxSbSq = ds_zfst0203.Max("ESMT_SBSQ") + 1 ;
	var nRow = ds_zfst0203.GetRowPos();
	var iRow = -1;
	var iRow2 = -1;
	if( nRow == (nRowCount -1) )
	{
		iRow = ds_zfst0203.AppendRow();
		iRow2 = ds_combo_zfst0203.AppendRow();
	}
	else
	{
		iRow = ds_zfst0203.InsertRow( nRow +1 );
		iRow2 = ds_combo_zfst0203.InsertRow(iRow+1);
	}
	ds_zfst0203.SetColumn(iRow, "ESMT_NUMB", ds_zfst0202.GetColumn(0, "ESMT_NUMB") );
	ds_zfst0203.SetColumn(iRow, "ESMT_SBSQ", nMaxSbSq);

	ds_combo_zfst0203.SetColumn( iRow2, "CODE", nMaxSbSq );
	ds_combo_zfst0203.SetColumn( iRow2, "CODE_NAME", ds_zfst0203.GetColumn(iRow, "CNTS") );
}

/********************************************************************************
* 기      능   : 갑지 품목 삭제
********************************************************************************/
function fn_rowDel_OnClick(obj)
{
	ds_combo_zfst0203.DeleteRow( ds_combo_zfst0203.FindRow("CODE", ds_zfst0203.GetColumn(ds_zfst0203.GetRowPos(), "ESMT_SBSQ" ) ) );
	var aSetFields = [ "ESMT_SBSQ='0'" ];
	gfn_setColumnData(tab_esmt.tab_esmtDtil.grd_detail, aSetFields, "ESMT_SBSQ="+Quote(ds_zfst0203.GetColumn(ds_zfst0203.GetRowPos(), "ESMT_SBSQ" )) );
	ds_zfst0203.DeleteRow( ds_zfst0203.GetRowPos() );
}

/********************************************************************************
* 기      능   : 갑지 품목 삭제
********************************************************************************/
function fn_make_ds_combo_zfst0203()
{
	ds_combo_zfst0203.ClearData();
	var nRow = 0;
	var nRowCount = ds_zfst0203.GetRowCount();
	nRow = ds_combo_zfst0203.AppendRow();
	ds_combo_zfst0203.SetColumn( nRow, "CODE", 0 );
	ds_combo_zfst0203.SetColumn( nRow, "CODE_NAME", gfn_getCodeName(G_CODE_SELECT) );
	for(var iRow = 0; iRow < nRowCount; iRow++)
	{
		nRow = ds_combo_zfst0203.AppendRow();
		ds_combo_zfst0203.SetColumn( nRow, "CODE", ds_zfst0203.GetColumn(iRow, "ESMT_SBSQ" ) );
		ds_combo_zfst0203.SetColumn( nRow, "CODE_NAME", ds_zfst0203.GetColumn(iRow, "CNTS") );
	}
	tab_esmt.tab_esmtDtil.cb_esmtSbsq.Index=0;
}

/********************************************************************************
* 기      능   : 을지 품목 추가
********************************************************************************/
function fn_rowAdd2_Onclick(obj)
{
	var nMaxSbSq = 1;
	var nRowCount = ds_zfst0204.GetRowCount() ;
	if ( nRowCount > 0 ) nMaxSbSq = ds_zfst0204.Max("ESMT_ITSQ") + 1 ;
	var nRow = ds_zfst0204.GetRowPos();
	var iRow = -1;
	var iRow2 = -1;
	if( nRow == (nRowCount -1) )
	{
		iRow = ds_zfst0204.AppendRow(); 
	}
	else
	{
		iRow = ds_zfst0204.InsertRow( nRow +1 ); 
	} 
	ds_zfst0204.SetColumn(iRow, "ESMT_NUMB", ds_zfst0202.GetColumn(0, "ESMT_NUMB"));
	ds_zfst0204.SetColumn(iRow, "ESMT_ITSQ", nMaxSbSq);
	return iRow;
}

/********************************************************************************
* 기      능   : 견적원가 품목 추가
********************************************************************************/
function fn_escsItem_OnClick(obj)
{
	if ( ds_zfst0200.firstrow < 0 || length( ds_zfst0200.GetColumn(0, "ESCS_NUMB") ) < 1 )
	{
		gfn_openMsgWin("견적서를 작성할 견적원가를 선택해야 합니다.", "W");
		fn_escsNumb_OnClick(btn_escsNumb);
		return;
	}
    var escsNumb = ds_zfst0200.GetColumn(0, "ESCS_NUMB");
    var escsNtim = ds_zfst0200.GetColumn(0, "ESCS_NTIM");
    var arg="escsNumb="+ Quote(escsNumb) +" escsNtim="+Quote(escsNtim) ;
    ds_zfst0201_rtn.ClearData();
    gfn_openPopup("FS0202002B", true, arg, 1, 1, "AutoSize=true Resize=true CloseFlag=false");
    var rtnRowCount = ds_zfst0201_rtn.GetRowCount();

    if ( rtnRowCount > 0 )
    {
		var iRow = -1;
		tab_esmt.tab_esmtDtil.grd_detail.Redraw = false;
		ds_zfst0204.FireEvent = false;
		var nMaxSbSq = 1;
		if ( rtnRowCount > 0 ) nMaxSbSq = ds_zfst0204.Max("ESMT_ITSQ") + 1 ;
		for( var rRow = 0; rRow < rtnRowCount; rRow++ )
		{
			iRow = fn_rowAdd2_Onclick(obj);
			ds_zfst0204.SetColumn(iRow, "CHK", "1"); 
			ds_zfst0204.SetColumn(iRow, "ESMT_ITSQ", nMaxSbSq);
			ds_zfst0204.SetColumn(iRow, "ESMT_SBSQ", 0 );
			ds_zfst0204.SetColumn(iRow, "ESMT_PGSQ", 0 );
			ds_zfst0204.SetColumn(iRow, "CNTS", iif( ds_zfst0201_rtn.GetColumn(rRow, "ITEM_DIYN") == "M", ds_zfst0201_rtn.GetColumn(rRow, "ESCE_NAME"), ds_zfst0201_rtn.GetColumn(rRow, "PART_NAME") ) ); 
			ds_zfst0204.SetColumn(iRow, "STAD", ds_zfst0201_rtn.GetColumn(rRow, "STAD") ); 
			ds_zfst0204.SetColumn(iRow, "UNIT", ds_zfst0201_rtn.GetColumn(rRow, "UNIT") ); 
			ds_zfst0204.SetColumn(iRow, "QNTY", ds_zfst0201_rtn.GetColumn(rRow, "QNTY") ); 
			ds_zfst0204.SetColumn(iRow, "WAERK", ds_zfst0202.GetColumn(0, "WAERK" ) ); 
			ds_zfst0204.SetColumn(iRow, "ESMT_COST", ds_zfst0201_rtn.GetColumn(rRow, "ESMT_COST") ); 
			ds_zfst0204.SetColumn(iRow, "CRES_COST", fn_ExangeEstmateCost(ds_zfst0201_rtn.GetColumn(rRow, "ESMT_COST")) ); 
			ds_zfst0204.SetColumn(iRow, "NOTE", ds_zfst0201_rtn.GetColumn(rRow, "NOTE") ); 
		}
		ds_zfst0204.FireEvent = true;
		tab_esmt.tab_esmtDtil.grd_detail.Redraw = true;
    }
}

/********************************************************************************
* 기      능   : 을지 품목 삭제
********************************************************************************/
function fn_rowDel2_OnClick(obj)
{ 
	var nCheckCount = ds_zfst0204.CaseCount("CHK=='1'");
	if ( nCheckCount > 0 )
	{
		var iRow = 0;
		while( iRow < ds_zfst0204.GetRowCount() )
		{
			iRow = ds_zfst0204.FindRow("CHK", "1", iRow);
			if ( iRow < 0 ) break;
			ds_zfst0204.DeleteRow(iRow);
		}
	}
	else
	{
		ds_zfst0204.DeleteRow( ds_zfst0204.GetRowPos() );
	}
}

/********************************************************************************
* 기      능   : 을지 페이지 번호 적용
********************************************************************************/
function fn_printApply_OnClick(obj)
{
	var nCheckCount = ds_zfst0204.CaseCount("CHK=='1'");
	if ( nCheckCount > 0 )
	{
		var aSetFields = [
			"ESMT_PGSQ=" + Quote(tab_esmt.tab_esmtDtil.ed_esmtPgsq.Value)
			];
		gfn_setColumnData(tab_esmt.tab_esmtDtil.grd_detail, aSetFields, "CHK='1'");
		aSetFields[0] = "CHK=''";
		gfn_setColumnData(tab_esmt.tab_esmtDtil.grd_detail, aSetFields, "CHK='1'");
	}
	else
	{
		var arr = ["을지 품목을"];
		gfn_showAlert("CW00116", arr);
		return;
	}
}

/********************************************************************************
* 기      능   : 갑지 품목 번호 적용
********************************************************************************/
function fn_sbsqApply_OnClick(obj)
{
	var nComboCount = ds_combo_zfst0203.GetRowCount();
	var aSetFields = array();
	if ( nComboCount < 2 )
	{
		gfn_openMsgWin("최소한 하나 이상의 갑지 품목이 있어야 합니다.", "I", "A", "");
	}
	else if (tab_esmt.tab_esmtDtil.cb_esmtSbsq.Index < 1 ) 
	{
		if (!gfn_openMsgWin("선택된 금액의 합계를 모두 적용하시겠습니까?", "I", "C", "")) return;
		if ( nComboCount == 2 ) 
		{
			aSetFields[0] = "ESMT_SBSQ=" + Quote(ds_combo_zfst0203.GetColumn(1,"CODE")) ;
			gfn_setColumnData(tab_esmt.tab_esmtDtil.grd_detail, aSetFields);
		}
		fn_SumOfEsmtItems();
	}
	else
	{
		var nCheckCount = ds_zfst0204.CaseCount("CHK=='1'");
		if ( nCheckCount > 0 )
		{
			aSetFields[0] = "ESMT_SBSQ=" + Quote( ds_combo_zfst0203.GetColumn(tab_esmt.tab_esmtDtil.cb_esmtSbsq.Index,"CODE") );
			gfn_setColumnData(tab_esmt.tab_esmtDtil.grd_detail, aSetFields, "CHK='1'");
			fn_SumOfEsmtItems(tab_esmt.tab_esmtDtil.cb_esmtSbsq.Value);
			aSetFields[0] = "CHK=''";
			gfn_setColumnData(tab_esmt.tab_esmtDtil.grd_detail, aSetFields, "CHK='1'");
		}
		else
		{
			var arr = ["금액 합계를 적용할 갑지 품목"];
			gfn_showAlert("CW10078", arr);
			tab_esmt.tab_esmtDtil.cb_esmtSbsq.SetFocus();
			return;
		}
	}
}

/********************************************************************************
* 기      능   : 네고견적원가수정 팝업 호출
********************************************************************************/
function fn_ngttCost_OnClick(obj)
{
	var sEscsNumb = ds_zfst0202.GetColumn(0, "ESCS_NUMB");
	var sEscsNtim = ds_zfst0202.GetColumn(0, "ESCS_NTIM");
	if ( length( sEscsNumb ) < 1 )
	{
		gfn_messageWin("견적원가를 선택해야만 합니다.");
		btn_escsNumb.Click();
		return;
	}
    var arg="";
    arg = arg +" escsNumb="+quote(sEscsNumb);
    arg = arg +" escsNtim="+quote(sEscsNtim);
    var aRtn = gfn_openPopup2("FS0202002A", true, arg, 1, 1, "AutoSize=true Resize=true CloseFlag=false");
    if ( length( aRtn + "" ) > 0 )
    {
		ds_zfst0202.FireEvent = false;
		ds_zfst0202.SetColumn( 0, "NGTT_TAMT", aRtn );
		ds_zfst0202.SetColumn( 0, "CRNG_TAMT", fn_ExangeEstmateCost(aRtn) );
		ds_zfst0202.FireEvent = true;
    }
}
/********************************************************************************
* 기      능   : 환율, 화폐단위 정보 변경시.
********************************************************************************/
function ds_zfst0202_WAERK_UKURS_Changed()
{
	var ukurs = parseFloat(ds_zfst0202.GetColumn(0, "UKURS"));
	var ukursRate = parseFloat(ds_zfst0202.GetColumn(0, "UKURS_RATE"));
	var iRow = 0;
	var nRowCount = ds_zfst0204.GetRowCount();
	
	ds_zfst0204.FireEvent = false;
	for( iRow = 0; iRow < nRowCount; iRow++ )
	{
		ds_zfst0204.SetColumn(iRow, "CRES_COST", fn_ExangeEstmateCost( ds_zfst0204.GetColumn( iRow , "ESMT_COST" ), ukurs, ukursRate ) );
	}
	ds_zfst0204.FireEvent = true;
	
	nRowCount = ds_zfst0203.GetRowCount();
	ds_zfst0203.FireEvent = false;
	var sumEsmtCost = 0;
	for( iRow = 0; iRow < nRowCount; iRow++ )
	{
		sumEsmtCost += parseFloat( ds_zfst0203.GetColumn( iRow , "ESMT_COST" ) );
		ds_zfst0203.SetColumn(iRow, "CRES_COST", fn_ExangeEstmateCost( ds_zfst0203.GetColumn( iRow , "ESMT_COST" ), ukurs, ukursRate ) );
	}
	ds_zfst0203.FireEvent = true;
	
	ds_zfst0202.FireEvent = false;
	ds_zfst0202.SetColumn( 0, "ESMT_TAMT", sumEsmtCost );
	ds_zfst0202.SetColumn( 0, "CRES_TAMT", fn_ExangeEstmateCost(sumEsmtCost, ukurs, ukursRate) );
	ds_zfst0202.SetColumn( 0, "CRNG_TAMT", fn_ExangeEstmateCost(ds_zfst0202.GetColumn(0, "NGTT_TAMT"), ukurs, ukursRate) );
	ds_zfst0202.FireEvent = true;
}

/********************************************************************************
* 기      능   : 마스터 정보 변경시.
********************************************************************************/
function ds_zfst0202_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{
	ds_zfst0202.FireEvent = false;
	switch( strColumnID )
	{
	case "ESMT_DATE":
		var sEsmtDate = varNewValue;
		var nEsmtEpdtDay = parseInt( ds_zfst0202.GetColumn(0, "ESMT_EPDT_DAY") );
		var sProdInyn = ds_zfst0202.GetColumn(0, "PROD_INYN"); 
		if ( length( sEsmtDate +"" ) != 8 ) {
			sEsmtDate = gfn_getCurrDate();
			ds_zfst0202.SetColumn(0, "ESMT_DATE", sEsmtDate); 
		}
		if ( nEsmtEpdtDay < 0 ) nEsmtEpdtDay = 30;
		
		ds_zfst0202.SetColumn(0, "ESMT_EPDT", AddDate(DateTime(sEsmtDate), nEsmtEpdtDay ) );
		if ( sProdInyn != "Y" ) 
		{
			ds_zfst0202.SetColumn(0, "ESMT_EPDT_DAY", nEsmtEpdtDay ); 
			ds_zfst0202.SetColumn(0, "ESMT_PROD", "");
			ds_zfst0202.SetColumn(0, "ESMT_PROD_TEXT", "발행일로 부터 " + nEsmtEpdtDay + "일");
		}
		else
		{
			ds_zfst0202.SetColumn(0, "ESMT_EPDT_DAY", 0 );
			ds_zfst0202.SetColumn(0, "ESMT_EPDT", sEsmtDate); 
			ds_zfst0202.SetColumn(0, "ESMT_PROD_TEXT", ds_zfst0202.GetColumn(0, "ESMT_PROD"));
		}
		break;
	case "ESMT_EPDT_DAY":
		var nEsmtEpdtDay = parseInt( varNewValue + "" ); 
		var sEsmtDate = ds_zfst0202.GetColumn(0, "ESMT_DATE");
		var sProdInyn = ds_zfst0202.GetColumn(0, "PROD_INYN"); 
		
		if ( length( sEsmtDate ) != 8 ) ds_zfst0202.SetColumn(0, "ESMT_DATE", gfn_getCurrDate());
		if ( nEsmtEpdtDay > 0 )
		{
			ds_zfst0202.SetColumn(0, "ESMT_EPDT", AddDate(DateTime(sEsmtDate), nEsmtEpdtDay ) ); 
		}
		else
		{
			ds_zfst0202.SetColumn(0, "ESMT_EPDT", sEsmtDate); 
		}
		if ( sProdInyn != "Y" ) 
		{
			ds_zfst0202.SetColumn(0, "ESMT_PROD", "");
			ds_zfst0202.SetColumn(0, "ESMT_PROD_TEXT", "발행일로 부터 " + nEsmtEpdtDay + "일");
		}
		else
		{
			ds_zfst0202.SetColumn(0, "ESMT_PROD_TEXT", ds_zfst0202.GetColumn(0, "ESMT_PROD"));
		}
		break;
	case "PROD_INYN":
		var sEsmtDate = ds_zfst0202.GetColumn(0, "ESMT_DATE");
		var nEsmtEpdtDay = parseInt( ds_zfst0202.GetColumn(0, "ESMT_EPDT_DAY") ); 
		if ( length( sEsmtDate ) != 8 ) ds_zfst0202.SetColumn(0, "ESMT_DATE", gfn_getCurrDate());
		if ( varNewValue != "Y" )
		{
			if ( nEsmtEpdtDay < 0 ) nEsmtEpdtDay = 30;
			ds_zfst0202.SetColumn(0, "ESMT_EPDT", AddDate(DateTime(sEsmtDate), nEsmtEpdtDay ));
			ds_zfst0202.SetColumn(0, "ESMT_PROD", "");
			ds_zfst0202.SetColumn(0, "ESMT_PROD_TEXT", "발행일로 부터 " + nEsmtEpdtDay + "일");
			tab_esmt.tab_esmtInfo.ed_esmtEpdt.Style = "sty_ipt_form";
			tab_esmt.tab_esmtInfo.ed_esmtEpdt.ReadOnly = false; 
			tab_esmt.tab_esmtInfo.ed_esmtProd.Style = "sty_ipt_form_ind";
			tab_esmt.tab_esmtInfo.ed_esmtProd.ReadOnly = true; 
		}
		else
		{
			ds_zfst0202.SetColumn(0, "ESMT_EPDT_DAY", 0); 
			ds_zfst0202.SetColumn(0, "ESMT_EPDT", sEsmtDate);
			ds_zfst0202.SetColumn(0, "ESMT_PROD_TEXT", ds_zfst0202.GetColumn(0, "ESMT_PROD"));
			tab_esmt.tab_esmtInfo.ed_esmtEpdt.Style = "sty_ipt_form_ind";
			tab_esmt.tab_esmtInfo.ed_esmtEpdt.ReadOnly = true; 
			tab_esmt.tab_esmtInfo.ed_esmtProd.Style = "sty_ipt_form";
			tab_esmt.tab_esmtInfo.ed_esmtProd.ReadOnly = false;
		}
		break;
	case "UKURS":
	    ds_zfst0202_WAERK_UKURS_Changed();
		break;
	}
	ds_zfst0202.FireEvent = true;
}
/********************************************************************************
* 기      능   : 견적서 품목 변경
********************************************************************************/
function ds_zfst0204_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{
	var nRowPos = -1;
	var nTempEsmtCost = 0;
	ds_zfst0204.FireEvent = false;
	obj.FireEvent = false;
	switch(strColumnID)
	{
	case "ESMT_SBSQ":
		nRowPos = ds_zfst0203.FindRow("ESMT_SBSQ", varOldValue); 
		if ( nRowPos >= 0 )
		{
			nTempEsmtCost = ds_zfst0203.GetColumn( nRowPos, "ESMT_COST") - ds_zfst0204.GetColumn( nRow, "ESMT_COST");
			ds_zfst0203.SetColumn( nRowPos, "ESMT_COST", nTempEsmtCost );
			ds_zfst0203.SetColumn( nRowPos, "CRES_COST", fn_ExangeEstmateCost(nTempEsmtCost) );
		}
		nRowPos = ds_zfst0203.FindRow("ESMT_SBSQ", varNewValue); 
		if ( nRowPos >= 0 )
		{
			nTempEsmtCost = ds_zfst0203.GetColumn( nRowPos, "ESMT_COST") + ds_zfst0204.GetColumn( nRow, "ESMT_COST");
			ds_zfst0203.SetColumn( nRowPos, "ESMT_COST", nTempEsmtCost );
			ds_zfst0203.SetColumn( nRowPos, "CRES_COST", fn_ExangeEstmateCost(nTempEsmtCost) );
		}
		
		break;
	case "ESMT_COST":
		ds_zfst0204.SetColumn( nRow, "CRES_COST", fn_ExangeEstmateCost(parseFloat(varNewValue)) );
		fn_SumOfEsmtItems(ds_zfst0204.GetColumn( nRow, "ESMT_SBSQ"));
		break;
	}
	obj.FireEvent = true;
	ds_zfst0204.FireEvent = true;
}

/********************************************************************************
* 기      능   : 환산 견적 금액 계산
********************************************************************************/
function fn_ExangeEstmateCost(nEsmtCost, ukurs, ukursRate)
{
	if ( length( trim( ukurs + "" ) ) < 1 ) ukurs = ds_zfst0202.GetColumn(0, "UKURS") ;  // 환율
	if ( length( trim( ukursRate + "" ) ) < 1 ) ukursRate = ds_zfst0202.GetColumn(0, "UKURS_RATE") ; // 단위국가통화 단위
	ukurs = parseFloat(ukurs);
	ukursRate = parseFloat(ukursRate);
	if ( ukurs < 0 ) ukurs = 0;
	if ( ukurs < 1 ) ukursRate = 1;
	return iif( parseFloat(nEsmtCost) == 0 || ukurs == 0, 0, round( parseFloat(nEsmtCost) / ukurs * ukursRate, 2 ) );
}

/********************************************************************************
* 기      능   : 마스터 견적금액 변경
********************************************************************************/
function fn_sumOfEsmtCost()
{	
	ds_zfst0202.FireEvent = false;
	var sumEsmtCost = ds_zfst0203.Sum("ESMT_COST");
	ds_zfst0202.SetColumn( 0, "ESMT_TAMT", sumEsmtCost );
	ds_zfst0202.SetColumn( 0, "CRES_TAMT", fn_ExangeEstmateCost( sumEsmtCost ) );
	ds_zfst0202.FireEvent = true;
}
/********************************************************************************
* 기      능   : 견적서 을지품목의 합계를 계산
********************************************************************************/
function fn_SumOfEsmtItems(sSelectProduct)
{
	var grdDetail = tab_esmt.tab_esmtDtil.grd_detail;
	var grdProd = tab_esmt.tab_esmtItem.grd_prod ;
	var nRowCount = ds_zfst0203.GetRowCount();
	var iRow = ds_zfst0203.findRow("ESMT_SBSQ", sSelectProduct);
	var sumEsmtCost = 0;
	var nCresCost = 0; 
	ds_zfst0203.FireEvent = false;
	grdProd.Redraw = false;
	if ( iRow >= 0 )
	{
		sumEsmtCost = ds_zfst0204.CaseSum("ESMT_SBSQ=="+sSelectProduct , "ESMT_COST"); 
		ds_zfst0203.SetColumn( iRow, "ESMT_COST", sumEsmtCost );
		ds_zfst0203.SetColumn( iRow, "CRES_COST", fn_ExangeEstmateCost(sumEsmtCost) );
	}
	else
	{
		for( iRow = 0; iRow < nRowCount; iRow++ )
		{
			sumEsmtCost = ds_zfst0204.CaseSum("ESMT_SBSQ=="+ds_zfst0203.GetColumn(iRow, "ESMT_SBSQ") , "ESMT_COST");  
			ds_zfst0203.SetColumn( iRow, "ESMT_COST", sumEsmtCost );
			ds_zfst0203.SetColumn( iRow, "CRES_COST", fn_ExangeEstmateCost(sumEsmtCost) );
		}
	}
	fn_sumOfEsmtCost();
	grdProd.Redraw = true;
	ds_zfst0203.FireEvent = true;
}

/********************************************************************************
* 기      능   : 을지 품목 그리드 Head Click
********************************************************************************/
function grd_detail_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
{
	var strColumnId = obj.GetCellProp("body", nCell, "ColId");
	switch( strColumnId )
	{
	case "CHK":
		var nCountCheck = ds_zfst0204.CaseCount( "CHK=='1'" );
		var nRowCount = ds_zfst0204.GetRowCount();
		var aSetFields = array();
		if ( nCountCheck >= nRowCount ) aSetFields[0]="CHK=''";
		else aSetFields[0]="CHK='1'";
		ds_zfst0204.FireEvent = false;
		obj.Redraw = false;
		gfn_setColumnData(tab_esmt.tab_esmtDtil.grd_detail, aSetFields);
		obj.Redraw = true;
		ds_zfst0204.FireEvent = true;
		break;
	}
}

/********************************************************************************
* 기      능   : 갑지 품목 그리드 변경시
********************************************************************************/
function ds_zfst0203_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{
	ds_zfst0203.FireEvent = false;
	switch( strColumnID )
	{
	case "CNTS":
		ds_combo_zfst0203.SetColumn( ds_combo_zfst0203.FindRow("CODE", ds_zfst0203.GetColumn(nRow, "ESMT_SBSQ") ), "CODE_NAME", varNewValue );
		break;
	case "ESMT_COST":
		ds_zfst0203.SetColumn(nRow, "CRES_COST", fn_ExangeEstmateCost(varNewValue) );
		fn_sumOfEsmtCost();
		break;
	}
	ds_zfst0203.FireEvent = true;
}

/********************************************************************************
* 기      능   : 화면 버튼 제어
********************************************************************************/
function fn_btn_control()
{
	var sEsmtStat = ds_zfst0202.GetColumn(0, "ESMT_STAT");
	var sApprStat = ds_zfst0202.GetColumn(0, "APPR_STAT");
	var sDraf = ds_zfst0202.GetColumn(0, "DRAF");
	var sAdit = ds_zfst0202.GetColumn(0, "ADIT");
	var sAppr = ds_zfst0202.GetColumn(0, "APPR");
	var tab1 = tab_esmt.GetItem(0);
	var tab2 = tab_esmt.GetItem(1);
	var tab3 = tab_esmt.GetItem(2);

	btn_approval.Enable = false;        // 승인
	btn_draft.Enable = false;           // 기안
	btn_recost.Enable = false;         // 재견적
	btn_delete.Enable = false;          // 삭제
	btn_save.Enable = false;            // 저장
	btn_print.Enable = false;           // 출력
	btn_excel.Enable = false;           // 엑셀
	btn_sendback.Enable = false;        // 반송
	
	btn_esmtNumb.Enable = false; 		// 견적서 번호 조회
	btn_escsNumb.Enable = false;		// 견적원가 번호 조회
	btn_adocInfo.Enable = false;		// 결재정보 조회
	btn_ngttCost.Enable = false;		// 네고견적원가 수정
	btn_mngrReg.Enable = false;			// 담당자 관리
	
	ed_escsTamt.Type = "String";		// 견적원가 총금액
	ed_esmtTamt.Type = "String";		// 견적총금액
	ed_mrgnRate.Type = "String";		// 시행율
	ed_esmtProdTamt.Type = "String";	// 품목 총금액
	
	
	tab1.Enable = false;				// 마스터 정보 텝
	tab1.btn_esmtCntr.Enable = false;	// 견적 국가 조회
	tab1.btn_curyCode.Enable = false;	// 화폐단위 조회
	tab1.btn_salePrsn.Enable = false;	// 영업 담당자 조회
	 
	tab2.grd_prod.Editable = false;		// 갑지 그리드
	tab2.btn_rowAdd.Enable = false;		// 갑지 행추가
	tab2.btn_rowDel.Enable = false;		// 갑지 행삭제
	 
	tab3.grd_detail.Editable = false;		// 을지 그리드
	tab3.btn_printApply.Enable = false;	// 을지 출력 순서 적용
	tab3.btn_sbsqApply.Enable = false;	// 갑지 품목 번호 적용
	tab3.btn_escsItem.Enable = false;	// 견적원가 품목 추가 
	tab3.btn_rowAdd2.Enable = false;	// 을지 행추가
	tab3.btn_rowDel2.Enable = false;	// 을지 행삭제
	
	
	tab1.ed_esmtTamt.Type = "String";
	tab1.ed_ngttTamt.Type = "String";
	tab1.ed_cresTamt.Type = "String";
	tab1.ed_crngTamt.Type = "String";
	
	tab2.grd_prod.SetCellProp("Body", tab2.grd_prod.GetBindCellIndex("body","ESMT_COST"), "Display", "null");
	tab2.grd_prod.SetCellProp("Body", tab2.grd_prod.GetBindCellIndex("body","CRES_COST"), "Display", "null");
	tab2.grd_prod.SetCellProp("Summ", 1, "Display", "null");
	tab2.grd_prod.SetCellProp("Summ", 2, "Display", "null");
	
	tab3.grd_detail.SetCellProp("Body", tab3.grd_detail.GetBindCellIndex("body","ESMT_COST"), "Display", "null");
	tab3.grd_detail.SetCellProp("Body", tab3.grd_detail.GetBindCellIndex("body","CRES_COST"), "Display", "null");
		
    if( G_DPT1 == "CD" ) {
		ed_escsTamt.Type = "Number"; 
		ed_esmtTamt.Type = "Number"; 
		ed_mrgnRate.Type = "Number"; 
		ed_esmtProdTamt.Type = "Number"; 
		
		tab1.ed_esmtTamt.Type = "Number";
		tab1.ed_ngttTamt.Type = "Number";
		tab1.ed_cresTamt.Type = "Number";
		tab1.ed_crngTamt.Type = "Number";
		tab2.grd_prod.SetCellProp("body", tab2.grd_prod.GetBindCellIndex("body","ESMT_COST"), "Display", "Number");
		tab2.grd_prod.SetCellProp("body", tab2.grd_prod.GetBindCellIndex("body","CRES_COST"), "Display", "Number");
		tab2.grd_prod.SetCellProp("Summ", 1, "Display", "Number");
		tab2.grd_prod.SetCellProp("Summ", 2, "Display", "Number");
		
		tab3.grd_detail.SetCellProp("body", tab3.grd_detail.GetBindCellIndex("body","ESMT_COST"), "Display", "Number");
		tab3.grd_detail.SetCellProp("body", tab3.grd_detail.GetBindCellIndex("body","CRES_COST"), "Display", "Number");
	}
	
	if( G_DPT1 == "CD" ) 
	{
		btn_print.Enable = true;           // 출력
		btn_excel.Enable = true;           // 엑셀
		btn_mngrReg.Enable = true;			// 담당자 관리
		if (sEsmtStat == "110")	
		{	//견적폐기
		}
		if (sEsmtStat == "120" || sEsmtStat == "130")	
		{	//견적반려 //견적작성중
			if ( sDraf == G_USER_ID )
			{
				if ( sApprStat!="150" && sApprStat!="190" ){
					btn_draft.Enable = true;           	// 기안
					if ( length( trim( ds_zfst0202.GetColumn(0, "ESMT_NUMB") + "" ) ) > 0 ) btn_delete.Enable = true;          	// 삭제
					btn_save.Enable = true;            	// 저장
				}
				btn_adocInfo.Enable = true;			// 결재정보 조회
				
				btn_esmtNumb.Enable = true; 		// 견적서 번호 조회
				btn_escsNumb.Enable = true;			// 견적원가 번호 조회
				btn_ngttCost.Enable = true;			// 네고견적원가 수정
				btn_mngrReg.Enable = true;			// 담당자 관리
		
				tab1.Enable = true;					// 마스터 정보 텝
				tab1.btn_esmtCntr.Enable = true;	// 견적 국가 조회
				tab1.btn_curyCode.Enable = true;	// 화폐단위 조회
				tab1.btn_salePrsn.Enable = true;	// 영업 담당자 조회
				
				tab2.grd_prod.Editable = true;		// 갑지 그리드
				tab2.btn_rowAdd.Enable = true;		// 갑지 행추가
				tab2.btn_rowDel.Enable = true;		// 갑지 행삭제
				
				tab3.grd_detail.Editable = true;		// 을지 그리드
				tab3.btn_printApply.Enable = true;	// 을지 출력 순서 적용
				tab3.btn_sbsqApply.Enable = true;	// 갑지 품목 번호 적용
				tab3.btn_escsItem.Enable = true;	// 견적원가 품목 추가 
				tab3.btn_rowAdd2.Enable = true;		// 을지 행추가
				tab3.btn_rowDel2.Enable = true;		// 을지 행삭제
			}
		}
		if (sEsmtStat == "140" && ( sAdit == G_USER_ID || sAppr == G_USER_ID ))	
		{	//견적결재중
			btn_approval.Enable = true;        	// 승인
			btn_sendback.Enable = true;        	// 반송
		}
		if (sEsmtStat == "150" && sDraf == G_USER_ID )	
		{	//견적승인
			btn_recost.Enable = true;         	// 재견적
		}
	}
}
]]></Script>
</Window>