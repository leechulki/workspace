<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="504" Icon="btn_icon_back_01" Id="PS1204005B" Left="8" OnLoadCompleted="fn_OnLoadCompleted" OnUnloadCompleted="fn_OnUnloadCompleted" PidAttrib="7" Title="현장민원&#32;접수" Top="8" Ver="1.0" Width="633" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_cond">
				<Contents>
					<colinfo id="LIFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="SUPR_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQNO" size="256" summ="default" type="STRING"/>
					<colinfo id="STATE" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSITE_NM" size="256" summ="default" type="STRING"/>
					<record>
						<GBN></GBN>
						<LIFNR></LIFNR>
						<PSPID></PSPID>
						<SEQNO></SEQNO>
						<STATE></STATE>
						<SUPR_DT></SUPR_DT>
						<ZSITE_NM></ZSITE_NM>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_master" OnColumnChanged="ds_master_OnColumnChanged">
				<Contents>
					<colinfo id="SUPR_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQNO" size="256" summ="default" type="STRING"/>
					<colinfo id="STATE" size="256" summ="default" type="STRING"/>
					<colinfo id="MINWON" size="256" summ="default" type="STRING"/>
					<colinfo id="TYPE" size="256" summ="default" type="STRING"/>
					<colinfo id="BIGO" size="256" summ="default" type="STRING"/>
					<colinfo id="DEPT" size="256" summ="default" type="STRING"/>
					<colinfo id="BIGO2" size="256" summ="default" type="STRING"/>
					<colinfo id="FINSH" size="256" summ="default" type="STRING"/>
					<colinfo id="BIGO3" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSITE_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="NAMET" size="256" summ="default" type="STRING"/>
					<colinfo id="MAN" size="256" summ="default" type="STRING"/>
					<colinfo id="TEXT30" size="256" summ="default" type="STRING"/>
					<colinfo id="CELLP" size="256" summ="default" type="STRING"/>
					<colinfo id="USERNUMB" size="256" summ="default" type="STRING"/>
					<colinfo id="EMAIL" size="256" summ="default" type="STRING"/>
					<colinfo id="EMAIL2" size="256" summ="default" type="STRING"/>
					<colinfo id="TEL" size="256" summ="default" type="STRING"/>
					<colinfo id="RDATE" size="256" summ="default" type="STRING"/>
					<colinfo id="A_PERSON" size="256" summ="default" type="STRING"/>
					<colinfo id="C_CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="C_DUTY" size="256" summ="default" type="STRING"/>
					<colinfo id="C_CELL" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="B_SITUATION" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZACTSS" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNR_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="TMCD" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_closed">
				<Contents>
					<colinfo id="CNT" size="256" type="STRING"/>
					<record>
						<CNT></CNT>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_gbn">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE>A</CODE>
						<CODE_NAME>대리점</CODE_NAME>
					</record>
					<record>
						<CODE>B</CODE>
						<CODE_NAME>고객사</CODE_NAME>
					</record>
					<record>
						<CODE>C</CODE>
						<CODE_NAME>설치협력사</CODE_NAME>
					</record>
					<record>
						<CODE>D</CODE>
						<CODE_NAME>내용증명</CODE_NAME>
					</record>
					<record>
						<CODE>E</CODE>
						<CODE_NAME>대표이사&#32;비서실</CODE_NAME>
					</record>
					<record>
						<CODE>F</CODE>
						<CODE_NAME>사이버&#32;신문고</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_chk">
				<Contents>
					<colinfo id="CNT" size="256" summ="default" type="STRING"/>
					<record>
						<CNT></CNT>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_sms">
				<Contents>
					<colinfo id="TRAN_ID" size="256" type="STRING"/>
					<colinfo id="TRAN_PHONE" size="256" type="STRING"/>
					<colinfo id="TRAN_CALLBACK" size="256" type="STRING"/>
					<colinfo id="TRAN_STATUS" size="256" type="STRING"/>
					<colinfo id="TRAN_MSG" size="256" type="STRING"/>
					<colinfo id="TRAN_ETC1" size="256" type="STRING"/>
					<colinfo id="TRAN_TYPE" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_lifnr">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
					<colinfo id="ZZACTSS" size="256" type="STRING"/>
					<colinfo id="ZZACTSS_NM" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_error"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_trans">
				<Contents>
					<colinfo id="PJT" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
					<colinfo id="MESGTITL" size="256" summ="default" type="STRING"/>
					<colinfo id="MESGDESC" size="256" summ="default" type="STRING"/>
					<colinfo id="PMNM" size="256" summ="default" type="STRING"/>
					<colinfo id="SITE_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="PERNO1" size="256" summ="default" type="STRING"/>
					<colinfo id="PERNO2" size="256" summ="default" type="STRING"/>
					<colinfo id="PERNO" size="256" summ="default" type="STRING"/>
					<colinfo id="USER" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_man">
				<Contents>
					<colinfo id="PSNO" size="256" summ="default" type="STRING"/>
					<colinfo id="IRUM" size="256" summ="default" type="STRING"/>
					<colinfo id="DPT1" size="256" summ="default" type="STRING"/>
					<colinfo id="TELH" size="256" summ="default" type="STRING"/>
					<colinfo id="MESGTITL" size="256" summ="default" type="STRING"/>
					<colinfo id="MESGDESC" size="256" summ="default" type="STRING"/>
					<colinfo id="PERNO" size="256" summ="default" type="STRING"/>
					<colinfo id="USER" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_print">
				<Contents>
					<colinfo id="SUPR_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQNO" size="256" summ="default" type="STRING"/>
					<colinfo id="STATE" size="256" summ="default" type="STRING"/>
					<colinfo id="MINWON" size="256" summ="default" type="STRING"/>
					<colinfo id="TYPE" size="256" summ="default" type="STRING"/>
					<colinfo id="BIGO" size="256" summ="default" type="STRING"/>
					<colinfo id="DEPT" size="256" summ="default" type="STRING"/>
					<colinfo id="BIGO2" size="256" summ="default" type="STRING"/>
					<colinfo id="FINSH" size="256" summ="default" type="STRING"/>
					<colinfo id="BIGO3" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSITE_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="NAMET" size="256" summ="default" type="STRING"/>
					<colinfo id="MAN" size="256" summ="default" type="STRING"/>
					<colinfo id="TEXT30" size="256" summ="default" type="STRING"/>
					<colinfo id="ZTEL" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_c">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE>A</CODE>
						<CODE_NAME>유</CODE_NAME>
					</record>
					<record>
						<CODE>B</CODE>
						<CODE_NAME>무</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_a">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME></CODE_NAME>
					</record>
					<record>
						<CODE>A</CODE>
						<CODE_NAME>이종훈CJ</CODE_NAME>
					</record>
					<record>
						<CODE>B</CODE>
						<CODE_NAME>안창선BJ</CODE_NAME>
					</record>
					<record>
						<CODE>C</CODE>
						<CODE_NAME>강철의BJ</CODE_NAME>
					</record>
					<record>
						<CODE>D</CODE>
						<CODE_NAME>김연식GJ</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_g">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE>A</CODE>
						<CODE_NAME>민원현장</CODE_NAME>
					</record>
					<record>
						<CODE>B</CODE>
						<CODE_NAME>민원예방현장</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_tmcd">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NM" size="256" type="STRING"/>
					<colinfo id="LIFNR" size="256" type="STRING"/>
					<colinfo id="DELEF" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_lifnr_grid">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_condLifnr">
				<Contents>
					<colinfo id="LIFNR" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
		</Datasets>
		<Shape BKColor="user0" Bottom="162" Height="27" Id="Shape4" Left="0" LineColor="user1" Right="630" TabOrder="52" Top="135" Type="Rectangle" Width="630"></Shape>
		<Shape BKColor="user0" Bottom="186" Height="27" Id="Shape5" Left="0" LineColor="user1" Right="630" TabOrder="38" Top="159" Type="Rectangle" Width="630"></Shape>
		<Shape BKColor="user0" Bottom="451" Height="188" Id="Shape2" Left="0" LineColor="user1" Right="630" TabOrder="15" Top="263" Type="Rectangle" Width="630"></Shape>
		<Shape BKColor="user0" Bottom="111" Height="26" Id="Shape6" Left="0" LineColor="user1" Right="630" TabOrder="8" Top="85" Type="Rectangle" Width="630"></Shape>
		<Shape BKColor="user0" Bottom="264" Height="57" Id="Shape8" Left="0" LineColor="user1" Right="630" TabOrder="10" Top="207" Type="Rectangle" Width="630"></Shape>
		<Shape BKColor="user0" Bottom="86" Height="26" Id="Shape0" Left="0" LineColor="user1" Right="630" TabOrder="3" Top="60" Type="Rectangle" Width="630"></Shape>
		<Static Align="Right" Height="22" Id="Static1" Left="6" Style="sty_lb_search" TabOrder="2" Text="프로젝트&#32;" Top="62" VAlign="Middle" Width="100"></Static>
		<Edit Align="CENTER" BindDataset="ds_cond" Border="Flat" Column="PSPID" Enable="FALSE" Height="22" Id="ed_pjt" ImeMode="none" Left="108" Style="sty_ipt_search" TabOrder="4" Top="62" Width="80"></Edit>
		<Static Align="Right" Height="22" Id="Static0" Left="161" Style="sty_lb_search" TabOrder="5" Text="현장명&#32;" Top="86" VAlign="Middle" Width="100"></Static>
		<Edit BindDataset="ds_master" BKColor="user0" Border="Flat" Column="ZSITE_NM" Enable="FALSE" Height="22" Id="ed_bstnk" Left="264" Readonly="TRUE" Style="sty_ipt_search" TabOrder="6" Top="87" Width="156"></Edit>
		<Div Height="32" Id="div_btn" Left="-1" TabOrder="7" Text="Div0" Url="WB01::CommBtnForm.xml" Width="635">
			<Contents></Contents>
		</Div>
		<Shape BKColor="user0" Bottom="136" Height="26" Id="Shape1" Left="0" LineColor="user1" Right="630" TabOrder="9" Top="110" Type="Rectangle" Width="630"></Shape>
		<Static Align="Right" Height="22" Id="Static11" Left="6" Style="sty_lb_search" TabOrder="11" Text="현장PM&#32;" Top="112" VAlign="Middle" Width="100"></Static>
		<Static Align="Right" Height="22" Id="Static13" Left="217" Style="sty_lb_search" TabOrder="12" Text="영업담당&#32;" Top="112" VAlign="Middle" Width="100"></Static>
		<Static Align="Right" Height="22" Id="Static27" Left="424" Style="sty_lb_search" TabOrder="13" Text="민원접수일&#32;" Top="87" VAlign="Middle" Width="100"></Static>
		<Static Height="12" Id="st_img" Left="786" TabOrder="14" Top="572" Width="22"></Static>
		<Calendar BindDataset="ds_master" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="RDATE" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="22" Id="cal_suprdt" Left="527" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_search" SundayTextColor="user35" TabOrder="1" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="87" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="100"></Calendar>
		<Static Align="Right" Height="54" Id="Static7" Left="6" Style="sty_lb_search" TabOrder="16" Text="민원&#32;유형&#32;" Top="208" VAlign="Middle" Width="100"></Static>
		<Edit Align="CENTER" BindDataset="ds_master" BKColor="user0" Border="Flat" Column="NAMET" Enable="FALSE" Height="22" Id="ed_posid" Left="108" Readonly="TRUE" Style="sty_ipt_search" TabOrder="17" Top="112" Width="100"></Edit>
		<Edit Align="CENTER" BindDataset="ds_master" BKColor="user0" Border="Flat" Column="MAN" Enable="FALSE" Height="22" Id="Edit1" Left="320" Readonly="TRUE" Style="sty_ipt_search" TabOrder="18" Top="112" Width="100"></Edit>
		<Button Align="Right" ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_sms" ImageID="btn_sub_02" Left="696" LeftMargin="12" OnClick="btn_sms_OnClick" Style="sty_btn" TabOrder="19" Text="SMS" Top="32" Transparent="TRUE" Visible="FALSE" Width="48"></Button>
		<Static Align="Right" Height="22" Id="Static2" Left="6" Style="sty_lb_search" TabOrder="20" Text="지역&#32;" Top="86" VAlign="Middle" Width="100"></Static>
		<Edit Align="CENTER" BindDataset="ds_master" Border="Flat" Column="TEXT30" Enable="FALSE" Height="22" Id="Edit6" Left="108" Style="sty_ipt_search" TabOrder="21" Top="86" Width="50"></Edit>
		<Button Height="18" Id="btn_pjt" ImageID="btn_icon_search" Left="190" OnClick="btn_pjt_OnClick" TabOrder="22" Text="Button0" Top="64" Width="18"></Button>
		<Static Align="Right" Height="22" Id="Static4" Left="425" Style="sty_lb_search" TabOrder="23" Text="민원제기처&#32;" Top="160" VAlign="Middle" Width="100"></Static>
		<Combo BindDataset="ds_master" Border="Flat" CodeColumn="CODE" Column="MINWON" DataColumn="CODE_NAME" Height="22" Id="cb_gbn" ImeMode="none" InnerDataset="ds_gbn" Left="528" OnChanged="cb_gbn_OnChanged" Style="sty_ipt_search" TabOrder="24" Top="160" Width="100"></Combo>
		<Static Align="Center" Height="160" Id="Static5" Left="6" Style="sty_lb_search" TabOrder="25" Text="고객&#32;및&#32;영업&#13;&#10;&#13;&#10;고충내용" Top="264" VAlign="Middle" Width="100"></Static>
		<Static Font="Default,10,Bold" Height="16" Id="Static3" Left="2" Style="sty_lb_form_basic" TabOrder="26" Text="&#32;민원접수" Top="35" VAlign="Middle" Width="60"></Static>
		<Shape BKColor="user0" Bottom="480" Height="54" Id="Shape3" Left="0" LineColor="user1" Right="630" TabOrder="29" Top="426" Type="Rectangle" Width="630"></Shape>
		<Static Align="Right" Height="50" Id="Static6" Left="6" Style="sty_lb_search" TabOrder="28" Text="관련팀&#32;&#32;" Top="428" VAlign="Middle" Width="100"></Static>
		<Radio BindDataset="ds_master" BKColor="user0" Border="None" Column="TYPE" Height="45" Id="rd_gbn" INDEX="-1" Left="112" Style="sty_ipt_form_radio" TabOrder="27" Top="214" Width="504">
			<Contents>
				<Layout code="A" height="20" left="0" text="검사일정관련" top="0" width="100"/>
				<Layout code="B" height="20" left="105" text="착공지연" top="0" width="70"/>
				<Layout code="C" height="20" left="180" text="자재문제" top="0" width="70"/>
				<Layout code="D" height="20" left="255" text="소통부재" top="0" width="70"/>
				<Layout code="E" height="20" left="330" text="현장/건축사항" top="0" width="100"/>
				<Layout code="G" height="20" left="435" text="공정지연" top="0" width="110"/>
				<Layout code="H" height="20" left="0" text="옵션공사" top="24" width="70"/>
				<Layout code="I" height="20" left="105" text="보완작업" top="24" width="70"/>
				<Layout code="F" height="20" left="180" text="기타" top="24" width="100"/>
			</Contents>
		</Radio>
		<Radio BindDataset="ds_master" BKColor="user0" Border="None" Column="DEPT" Height="50" Id="rd_gbn2" INDEX="-1" Left="112" Style="sty_ipt_form_radio" TabOrder="30" Top="428" Width="472">
			<Contents>
				<Layout code="A" height="20" left="0" text="구매" top="0" width="60"/>
				<Layout code="B" height="20" left="65" text="제조" top="0" width="60"/>
				<Layout code="C" height="20" left="130" text="영업" top="0" width="60"/>
				<Layout code="D" height="20" left="195" text="설치" top="0" width="60"/>
				<Layout code="E" height="20" left="260" text="설계" top="0" width="60"/>
				<Layout code="F" height="20" left="325" text="영업기술" top="0" width="80"/>
				<Layout code="G" height="20" left="405" text="검사기관" top="0" width="70"/>
				<Layout code="H" height="20" left="0" text="제조지원" top="25" width="80"/>
				<Layout code="I" height="20" left="85" text="효율개선" top="25" width="80"/>
				<Layout code="J" height="20" left="170" text="품질" top="25" width="80"/>
				<Layout code="L" height="20" left="255" text="서비스" top="25" width="90"/>
				<Layout code="K" height="20" left="350" text="기타" top="25" width="60"/>
			</Contents>
		</Radio>
		<Static Align="Right" Height="22" Id="Static8" Left="216" Style="sty_lb_search" TabOrder="31" Text="차수&#32;" Top="62" VAlign="Middle" Width="100"></Static>
		<Edit Align="RIGHT" BindDataset="ds_master" BKColor="user0" Border="Flat" Column="SEQNO" Enable="FALSE" Height="22" Id="ed_seq" Left="320" Readonly="TRUE" Style="sty_ipt_search" TabOrder="32" Top="62" Width="100"></Edit>
		<TextArea BindDataset="ds_master" Column="BIGO" Height="149" Id="ta_bigo" ImeMode="none" Left="112" TabOrder="33" Top="272" VScroll="TRUE" Width="512"></TextArea>
		<Static Align="Right" Height="22" Id="Static9" Left="425" Style="sty_lb_search" TabOrder="35" Text="민원제기자&#32;전화&#32;" Top="112" VAlign="Middle" Width="100"></Static>
		<Edit Align="CENTER" BindDataset="ds_master" Border="Flat" Column="CELLP" Height="22" Id="ed_tel" Left="528" Style="sty_ipt_search" TabOrder="34" Top="112" Width="100"></Edit>
		<Static Align="Center" BKColor="brown" Height="22" Id="Static12" Left="424" Style="sty_lb_search" TabOrder="37" Text="현장방문일" Top="62" VAlign="Middle" Width="100"></Static>
		<Calendar BindDataset="ds_cond" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="SUPR_DT" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Enable="FALSE" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="22" Id="Calendar0" Left="527" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_search" SundayTextColor="user35" TabOrder="36" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="62" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="100"></Calendar>
		<Shape BKColor="user0" Bottom="213" Height="28" Id="Shape7" Left="0" LineColor="user1" Right="630" TabOrder="39" Top="185" Type="Rectangle" Width="630"></Shape>
		<Static Align="Right" Height="22" Id="Static14" Left="217" Style="sty_lb_search" TabOrder="41" Text="고객연락처&#32;&#32;" Top="161" VAlign="Middle" Width="100"></Static>
		<Edit Align="CENTER" BindDataset="ds_master" Border="Flat" Column="C_CELL" Height="22" Id="Edit0" Left="320" Style="sty_ipt_search" TabOrder="40" Top="160" Width="100"></Edit>
		<Static Align="Right" Height="22" Id="Static15" Left="6" Style="sty_lb_search" TabOrder="42" Text="고객협의&#32;" Top="161" VAlign="Middle" Width="100"></Static>
		<Combo BindDataset="ds_master" Border="Flat" CodeColumn="CODE" Column="C_CHK" DataColumn="CODE_NAME" Height="22" Id="Combo0" ImeMode="none" InnerDataset="ds_c" Left="108" Style="sty_ipt_search" TabOrder="43" Top="160" Width="100"></Combo>
		<Static Align="Right" Height="22" Id="Static16" Left="6" Style="sty_lb_search" TabOrder="44" Text="고객직책&#32;" Top="188" VAlign="Middle" Width="100"></Static>
		<Edit Align="CENTER" BindDataset="ds_master" Border="Flat" Column="C_DUTY" Height="22" Id="Edit2" Left="108" Style="sty_ipt_search" TabOrder="45" Top="188" Width="100"></Edit>
		<Static Align="Right" Height="22" Id="Static17" Left="217" Style="sty_lb_search" TabOrder="46" Text="방문현장구분&#32;" Top="188" VAlign="Middle" Width="100"></Static>
		<Combo BindDataset="ds_master" Border="Flat" CodeColumn="CODE" Column="GBN" DataColumn="CODE_NAME" Height="22" Id="Combo1" ImeMode="none" InnerDataset="ds_g" Left="320" Style="sty_ipt_search" TabOrder="47" Top="187" Width="100"></Combo>
		<Static Align="Right" Height="22" Id="Static18" Left="425" Style="sty_lb_search" TabOrder="48" Text="지역담당자&#32;" Top="188" VAlign="Middle" Width="100"></Static>
		<Combo BindDataset="ds_master" Border="Flat" CodeColumn="CODE" Column="A_PERSON" DataColumn="CODE_NAME" Height="22" Id="Combo2" ImeMode="none" InnerDataset="ds_a" Left="528" Style="sty_ipt_search" TabOrder="49" Top="187" Width="100"></Combo>
		<Edit BindDataset="ds_master" Border="Flat" CheckLength="Byte" Column="LIFNR_NM" Height="20" Id="edt_lifnr" ImeMode="native" Left="109" MaxLength="30" OnChanged="edt_lifnr_OnChanged" OnKeyDown="edt_lifnr_OnKeyDown" Style="sty_ipt_search" TabOrder="50" Top="137" UpperOnly="TRUE" Width="151"></Edit>
		<Button Height="18" Id="btn_lifnr" ImageID="btn_icon_search" Left="263" OnClick="btn_lifnr_OnClick" TabOrder="51" Text="btn_lifnr" Top="138" Width="18"></Button>
		<Static Align="Right" Height="22" Id="Static10" Left="6" Style="sty_lb_search" TabOrder="53" Text="협력업체&#32;" Top="136" VAlign="Middle" Width="100"></Static>
		<Static Align="Right" Height="22" Id="Static19" Left="297" Style="sty_lb_search" TabOrder="54" Text="팀장&#32;" Top="136" VAlign="Middle" Width="100"></Static>
		<Combo BindDataset="ds_master" Border="Flat" CodeColumn="CODE" Column="TMCD" DataColumn="CODE_NM" Height="20" Id="cb_tmcd" InnerDataset="ds_tmcd" Left="398" Style="sty_ipt_search" TabOrder="55" Top="136" Width="106"></Combo>
	</Form>
	<Script><![CDATA[﻿﻿﻿﻿﻿﻿/*
 ******************************************************************************************
 * 기      능   : 
 * 작  성  자   :  방기태
 * 작성  일자   : 2012.11.13
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
#include "LIB::commons.js";	// 공통 스크립트 
//=========================================================================================
// [ PART 1 ]
// Form에서 사용될 전역변수를 선언
// FORM에서 사용되는 전역변수는 대문자로 작성하며, F_XXX 의 형태를 갖도록 한다. 
//=========================================================================================
var userGroup = "";

//var lv_mrrate1 = 0.0;
var PER_CHK;
var PRE_SUPRDT;
var PRE_PJT;
var PRE_SEQ;
var PRE_GRP;
var PRE_STT;
//=========================================================================================
// [ PART 2 ]
// Form Loading / Unloading 시 작업 정의
//=========================================================================================
function fn_OnLoadCompleted(obj) {
	// Form 로드 이벤트 맨 첫줄에 기술 
	//gfn_initForm(true);	
	gfn_initForm();	
	
	gfn_initDs(ds_master, true);	
	gfn_initDs(ds_cond, true);	
	
		
	PER_CHK 	= PER_CHK;
  //  ds_cond.SetColumn(0,"PSPID",PRE_PJT);
//	ds_cond.SetColumn(0,"REQ_DAT",PRE_SUPRDT);
//	ds_cond.SetColumn(0,"SEQNO",PRE_SEQ);
//	ds_cond.SetColumn(0,"STATE",PRE_STT);
//    PRE_STT     = PRE_STT;
   // PRE_GRP		= PRE_GRP;
    

	if(PER_CHK == "C") //입력분
	{
	//	cal_suprdt.Value 	= PRE_SUPRDT;
	//	ed_pjt.Text			= PRE_PJT;		
	//	ed_seq.Value 	      	= PRE_SEQ;
		//ed_seq.Text	      	= PRE_STT;
	  ds_cond.SetColumn(0,"PSPID",PRE_PJT);
      ds_cond.SetColumn(0,"SUPR_DT",PRE_SUPRDT);
	  ds_cond.SetColumn(0,"SEQNO",PRE_SEQ);
	  ds_cond.SetColumn(0,"STATE",PRE_STT);
		
													
		ufn_enable("C");
		
		fn_query();
				
	}
	else if(PER_CHK == "N")  //신규 
	{				
		
		//cb_lifnr.value = PRE_LIFNR;
		//cb_lifnr.Index = ds_lifnr.FindRow("CODE", PRE_LIFNR);
		

		cal_suprdt.value   = gfn_getCurrDate();
		
	    ufn_enable("N");
	}
	 
}
    
    
/********************************************************************************
* 기      능   : 조회 Callback  
********************************************************************************/
function fn_afterLifnr(errCode, errMsg) 
{	
/*
	cb_lifnr.Index = ds_lifnr.FindRow("CODE", PRE_LIFNR);
*/	
}    
    

/********************************************************************************
* 기      능   : 컴포넌트들의 활성화 여부
********************************************************************************/	
function ufn_enable(chk)
{

 if(chk=="C"){	//입력분
    if(PRE_STT = 'D')// 미접수 
    {
		   			
			cal_suprdt.Enable 	= false;
			ed_pjt.Enable 		= false;
			btn_pjt.Enable      = false;
			cb_gbn.Enable 		= true;
			//ta_bigo.Enable      = false;
			ta_bigo.Enable    = true;
			rd_gbn.Enable        = true;
		    rd_gbn2.Enable		= true;
			
			div_btn.btn_query.visible = false;
			div_btn.btn_delete.visible = true;
			div_btn.btn_save.visible = true;
			div_btn.btn_print.visible = true;
			ed_tel.Enable 		= true;
			Calendar0.Enable 	= false;
	}
	else
	{ 
	
	        cal_suprdt.Enable 	= false;
			ed_pjt.Enable 		= false;
			btn_pjt.Enable      = false;
			cb_gbn.Enable 		= true;
			//ta_bigo.Enable      = false;
			ta_bigo.Enable    = true;
			rd_gbn.Enable        = false;
     		rd_gbn2.Enable		= false;
     		ed_tel.Enable 		= false;
			

			Calendar0.Enable 	= false;
			
			div_btn.btn_query.visible = false;
			div_btn.btn_delete.visible = false;
			div_btn.btn_print.visible = true;
			div_btn.btn_save.visible = false;
	
	}


		
  }
	else if(chk=="N") //신규입력분 
	{
	
		cal_suprdt.Enable 	= true;
		ed_pjt.Enable 		= false;
		btn_pjt.Enable      = true;
		cb_gbn.Enable 		= true;
	    ta_bigo.Enable      = true;
		rd_gbn.Enable       = true;
		rd_gbn2.Enable		= true;
		ed_tel.Enable 		= true;

		Calendar0.Enable 	= false;
		
		div_btn.btn_query.visible = true;
		div_btn.btn_delete.visible = true;
		div_btn.btn_print.visible = true;
		div_btn.btn_save.visible = true;     
	}
}	
    
    
    
/********************************************************************************
* 기      능   : 공통코드가 조회된 후의 Callback 함수 
********************************************************************************/
function fn_completeInit(sCode, sDsObj, sCodeType) {
	
}

/********************************************************************************
* 기      능   : form UnloadCompleted 
********************************************************************************/
function fn_OnUnloadCompleted(obj) {
	return gfn_isFormUnload(obj);
}    

/********************************************************************************
* 기      능   : 프로젝트 조회 팝업
********************************************************************************/    
function btn_popProj_OnClick(obj)
{

	var arg = "pjt="+quote(ed_pjt.Text);
	gfn_openPopup("CS9601002A", true, arg);
	
}    
    
    
/********************************************************************************
* 기      능   : 조회 
********************************************************************************/
function fn_query()
{	
        tit_clearActionInfo();		   
		tit_addSearchActionInfo("ps12:PS1204005B_S5");         		    
		tit_callService(
			""
			, ""
			, "ds_cond=ds_cond"
			, "ds_chk=ds_chk"
			, ""
		    , "fn_after"
			, ""
			, ""
			, true);
}
 
function fn_after() 
{		
	if(PER_CHK == "C") //입력분
	{		  
	//	if(gfn_isNull(cb_lifnr, true, Static9.Text)) return;
		//if(gfn_isNull(cal_suprdt, true, Static27.Text)) return;
		//if(gfn_isNull(ed_pjt, true, Static1.Text)) return;			
		//if(gfn_isNull(ed_seq, true, Static8.Text)) return;			
		

		tit_clearActionInfo();		   
		tit_addSearchActionInfo("ps12:PS1204005B_S3");         		    
		
		tit_callService(
			""
			, ""
			, "ds_cond=ds_cond"
			, "ds_master=ds_master"
			, ""
			, "fn_afterQuery"
			, ""
			, ""
			, true);
 

	}
    else if(PER_CHK == "N") // 미입력 
    {
       
		if(gfn_isNull(ed_pjt, true, Static1.Text)) return;	
		
		tit_clearActionInfo();		 
		if(ds_chk.GetColumn(0,"CNT") > 0) {                  // 입력분 있을 때 
		tit_addSearchActionInfo("ps12:PS1204005B_S6"); 	 }
		else{
		tit_addSearchActionInfo("ps12:PS1204005B_S1");   }  // 압력분 없을 떄     		      
		tit_callService(
			""
			, ""
			, "ds_cond=ds_cond"
			, "ds_master=ds_master"
			, ""
			, "fn_afterQuery"
			, ""
			, ""
			, true);	
		                             
	
    }
}    
/********************************************************************************
* 기      능   : 호기선택시 조회
********************************************************************************/
 function fn_posid()
 {
 	if(gfn_isNull(ed_pjt, true, Static1.Text)) return;		
	//if(gfn_isNull(ed_posid, true, Static11.Text)) return;		
        	
	/*tit_clearActionInfo();		  		     
	tit_addSearchActionInfo("ps12:PS1204005B_S1");         		      
	tit_callService(
		""
		, ""
		, "ds_cond=ds_cond"
		, "ds_master=ds_master"
		, ""
		, "fn_afterQuery"
		, ""
		, ""
		, true);
		*/
	fn_query();	
 }


/********************************************************************************
* 기      능   : 조회 Callback  
********************************************************************************/
function fn_afterQuery(errCode, errMsg) {
	gfn_showMsg("CI00001");
    fn_tmcd();
}


/********************************************************************************
* 기      능   : 공통코드가 조회된 후의 Callback 함수 
********************************************************************************/
function fn_completeInit(sCode, sDsObj, sCodeType) {
	if(userGroup == "40")
	{
		//cb_zzactss.Index = 0;
		//cb_zzactss.Enable = true;
	}
	else if(userGroup == "30")
	{
		//ds_zzactss.Filter("CODE="+quote(G_AREA_CODE_E));
		//cb_zzactss.Index = 0;
		//cb_zzactss.Enable = false;
	}
	else if(userGroup == "10")
	{
		//cb_zzactss.Index = 0;
		//cb_zzactss.Enable = false;
	}
}


/********************************************************************************
* 기      능   : form UnloadCompleted 
********************************************************************************/
function fn_OnUnloadCompleted(obj) {
	return gfn_isFormUnload(obj);
}
//=========================================================================================
// [ PART 3 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,form닫기)
//=========================================================================================

/********************************************************************************
* 기      능   : 닫기  
********************************************************************************/
function fn_close() {
	parent.fn_query();    
	close();
}
/********************************************************************************
* 기      능   : 그리드 헤더 클릭시 정렬 처리 
********************************************************************************/
function grd_list_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
{	

}
/********************************************************************************
* 기      능   : 액셀  
********************************************************************************/
function fn_excel() {
	//gfn_saveToExcel(grd_list, true );
}

/********************************************************************************
* 기      능   : 원프로젝트 팝업
********************************************************************************/
function btn_pjt_OnClick(obj)
{
	//alert("btn_pjt_OnClick");	 
	
	var arg = "pjt="+quote(ed_pjt.Text);
	gfn_openPopup("CS9601002A",true,arg);
}
/********************************************************************************
* 기      능   : 저장
********************************************************************************/
function fn_save() 
{
	if(gfn_isNull(cal_suprdt, true, Static27.Text)) return false;
	if(gfn_isNull(ed_pjt, true, Static1.Text)) return false;
	
	if(gfn_isNull(edt_lifnr, true, Static10.Text)) return false;
	if(gfn_isNull(cb_tmcd, true, Static19.Text)) return false;
	
	if(gfn_isNull(cb_gbn, true, Static4.Text)) return false;	
	if(gfn_isNull(rd_gbn, true, Static7.Text)) return false;	
	if(gfn_isNull(rd_gbn2, true, Static6.Text)) return false;
	if(gfn_isNull(ta_bigo, true, Static5.Text)) return false;
	if(gfn_isNull(ed_tel, true, Static9.Text)) return false;
	//if(gfn_isNull(Combo1, true, Static17.Text)) return false;
	//if(gfn_isNull(Calendar0, true, Static12.Text)) return false;
	//if(gfn_isNull(Combo2, true, Static18.Text)) return false; 20200422수정
	//if(gfn_isNull(Combo0, true, Static15.Text)) return false;
	
	Trace(ds_cond.GetColumn(0,"SUPR_DT"));
    // ds_master.SetColumn(0,"SEQNO", ds_master.GetColumn(0,"SEQNO"));
     ds_master.SetColumn(0,"GBN", 'A');
     ds_master.SetColumn(0,"SUPR_DT", ds_cond.GetColumn(0,"SUPR_DT"));
			
	tit_clearActionInfo();		
	tit_addSelectExActionInfo("ps12:PS1204005B_S2", "ps12:PS1204005B_I1", "ps12:PS1204005B_U1");
	tit_callService(
		""
		, ""
		, "ds_master=ds_master"
		, ""
		, ""
		, "fn_afterSave"
		, ""
		, ""
		, true  // ""
		
		);	


}


/********************************************************************************
* 기      능   : 저장 Callback  
********************************************************************************/
function fn_afterSave(errCode, errMsg) {
	if ( errCode != 0 ) 
	{
		gfn_showMsg("CE00001");
	} 
	else 
	{
		//ufn_enable("C");
	     PER_CHK = 'C';  //저장시 변경으로 들어감
	     PRE_STT = 'D';
	//	gfn_showMsg("CI00003");	
		parent.fn_query();    
	//	fn_close();
		//fn_afterTrans();		
   		
    }

  // fn_mail();
    
}

/********************************************************************************
* 기      능   : 전송 60
********************************************************************************/
function fn_trans() 
{
        ds_master.SetColumn(0,"SUPR_DT", ds_cond.GetColumn(0,"SUPR_DT"));
  
  		tit_clearActionInfo();	
		tit_addSearchActionInfo("ps12:PS1204005B_U2");	
         tit_callService(
			""
			, ""
			, "ds_master=ds_master"
			, ""
			, ""
			, "fn_aftertrans"
			, "" //true
			, ""
			, true);	


}


/********************************************************************************
* 기      능   : 저장 Callback  
********************************************************************************/
function fn_aftertrans(errCode, errMsg) {
	if ( errCode != 0 ) 
	{
		gfn_showMsg("CE00001");
	} 
	else 
	{
		//ufn_enable("C");
		//PER_CHK = 'C';  //저장시 변경으로 들어감
		gfn_showMsg("CI00003");	
		//fn_afterTrans();		
   		
    }

 fn_mail();
 fn_sms();   
 
}
/********************************************************************************
* 기      능   : 삭제
********************************************************************************/
function fn_delete() 
{

    if(gfn_isNull(cal_suprdt, true, Static27.Text)) return false;
	if(gfn_isNull(ed_pjt, true, Static1.Text)) return false;
	if(gfn_isNull(cb_gbn, true, Static4.Text)) return false;	
	if(gfn_isNull(rd_gbn, true, Static7.Text)) return false;	
	if(gfn_isNull(rd_gbn2, true, Static6.Text)) return false;
	if(gfn_isNull(ta_bigo, true, Static5.Text)) return false;

    ds_master.SetColumn(0,"SUPR_DT", ds_cond.GetColumn(0,"SUPR_DT"));
    ds_master.SetColumn(0,"SEQNO", ds_cond.GetColumn(0,"SEQNO"));
	if(PER_CHK == "C")
	{
		if (!gfn_showConfirm("CI00015","현장민원접수")) 
		{
			return;
		}	
	 
	
		tit_clearActionInfo();	
		//tit_addSingleActionInfo("bs04:BS0409002B_D2");
		tit_addSingleActionInfo("ps12:PS1204005B_D1");
		tit_callService(
			""
			, ""        
			, "ds_master=ds_master"
			, ""
			, ""
			, "fn_afterDelete"
			, ""
			, ""
			,true  // ""
			);	
      }
     
	//fn_reset("D");
      
}




/********************************************************************************
* 기      능   : 삭제 Callback  
********************************************************************************/
function fn_afterDelete(errCode, errMsg) {
	if ( errCode != 0 ) 
	{
		gfn_showMsg("CE00001");
	} 
	else 
	{
		gfn_showMsg("CI00004");		
		parent.fn_query();    
		fn_close();
	}
}

/********************************************************************************
* 기      능   : E-MAIL 전송 
********************************************************************************/
function fn_mail() 
{

	var lv_msg = "";
    var user;
    var perno;
	var chkmsg;
	

	//pm
/*	if(length(ds_master.GetColumn(0, "USERNUMB")) > 0)
	{
	  lv_msg = '' + ed_pjt.Text + '(' + ed_bstnk.Text + ') 의 현장에 하기와 같이 민원이 접수되었으니 사유 및 조치 계획을 회신 바랍니다.';  
	  chkmsg = '' + ed_bstnk.Text +'현장 민원접수 건';
	

	
	  user =  'helco' + G_USER_ID + '@hdel.co.kr';    
	//    user =  'helco2022702@hdel.co.kr';
	  perno = 'helco2022702@hdel.co.kr';
  	//perno = 'helco' + ds_master.GetColumn(0, "USERNUMB") + '@hdel.co.kr';
 

	tit_callService(
			"COMM_ACT"
			, "sendmail"
			, ""
			, ""
			//, "USER_JUMIN=" + quote(med_jumin1.value+med_jumin2.value)
			//	+ 
			," SEND_USER=" + quote(user)
				+ " RECE_USER=" + quote(perno)
				+ " MESGTITL=" + quote(chkmsg)
				+ " MESGBODY=" + quote(lv_msg)
			, ""  //"fn_afterQuery"
			, false
			, true);	
	}*/
	//팀장
	/*if(length(ds_master.GetColumn(0, "EMAIL")) > 0)
	{
	    lv_msg = '' + ed_pjt.Text + '(' + ed_bstnk.Text + ') 의 현장에 하기와 같이 민원이 접수되었으니 사유 및 조치 계획을 회신 바랍니다.';  
	    chkmsg = '' + ed_bstnk.Text +'현장 민원접수 건';
	

	
	     user =  'helco' + G_USER_ID + '@hdel.co.kr';    
	//    user =  'helco2022702@hdel.co.kr';
	     perno = 'helco2022702@hdel.co.kr';
  	//perno = 'helco' + ds_master.GetColumn(0, "EMAIL") + '@hdel.co.kr';
 

	tit_callService(
			"COMM_ACT"
			, "sendmail"
			, ""
			, ""
			//, "USER_JUMIN=" + quote(med_jumin1.value+med_jumin2.value)
			//	+ 
			," SEND_USER=" + quote(user)
				+ " RECE_USER=" + quote(perno)
				+ " MESGTITL=" + quote(chkmsg)
				+ " MESGBODY=" + quote(lv_msg)
			, ""  //"fn_afterQuery"
			, false
			, true);	
	}
	//부서장
    if(length(ds_master.GetColumn(0, "EMAIL2")) > 0)
	{
    	 lv_msg = '' + ed_pjt.Text + '(' + ed_bstnk.Text + ') 의 현장에 하기와 같이 민원이 접수되었으니 사유 및 조치 계획을 회신바랍니다.';  
	     chkmsg = '' + ed_bstnk.Text +'현장 민원접수 건';
	

	
	     user =  'helco' + G_USER_ID + '@hdel.co.kr';    
	//    user =  'helco2022702@hdel.co.kr';
	     perno = 'helco2022702@hdel.co.kr';
 //  	perno = 'helco' + ds_master.GetColumn(0, "EMAIL2") + '@hdel.co.kr';
 

	     tit_callService(
			"COMM_ACT"
			, "sendmail"
			, ""
			, ""
			//, "USER_JUMIN=" + quote(med_jumin1.value+med_jumin2.value)
			//	+ 
			," SEND_USER=" + quote(user)
				+ " RECE_USER=" + quote(perno)
				+ " MESGTITL=" + quote(chkmsg)
				+ " MESGBODY=" + quote(lv_msg)
			, ""  //"fn_afterQuery"
			, false
			, true);	
	}
	*/
	
	//고광호bj (디폴트)
	
	   //lv_msg = '' + ed_pjt.Text + '(' ;
	   //lv_msg = lv_msg + ds_master.GetColumn(0,"ZSITE_NM") + ') 의 현장에 하기와 같이 민원이 접수되었으니 사유 및 조치 계획을 회신 바랍니다.'; 
	  // lv_msg = '' + lv_msg + '\n' + ds_master.GetColumn(0,"BIGO")  ;
	   lv_msg = '귀하가 요청하신 ' + ed_bstnk.Text + '(' + ed_pjt.Text + ')의 민원접수가 ' + cal_suprdt.Value + ' 일에 접수되었습니다.';
	   chkmsg = '' + ed_pjt.Text + '(' + ds_master.GetColumn(0,"ZSITE_NM") + ') 현장 민원접수 건';
	

	
	   user =  'helco' + G_USER_ID + '@hdel.co.kr';      
	   perno = 'koparko@hdel.co.kr' ;   
 //      perno = 'eunhye.lee@hdel.co.kr' ;   
 

	  tit_callService(
			"COMM_ACT"
			, "sendmail"
			, ""
			, ""
			//, "USER_JUMIN=" + quote(med_jumin1.value+med_jumin2.value)
			//	+ 
			," SEND_USER=" + quote(user)
				+ " RECE_USER=" + quote(perno)
				+ " MESGTITL=" + quote(chkmsg)
				+ " MESGBODY=" + quote(lv_msg)
			, ""  //"fn_afterQuery"
			, false
			, true);	

	//parent.fn_query();    
	//fn_close();		
}
function cb_gbn_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{    //alert(cb_gbn.Value);
    //민원제기처가 대리점인 경우 영업담당자 번호 
	if(cb_gbn.Value == 'A') 
	{
	  ds_master.SetColumn(0,"CELLP", ds_master.GetColumn(0,"TEL"));
	}
	else
	{
	   ds_master.SetColumn(0,"CELLP",'');
	}
}

/********************************************************************************
* 기      능   : print 40
********************************************************************************/
function fn_print() 
{
	ds_print.ClearData();
	ds_print.Copy(ds_master);

	Dialog("PS12::PS1204006P.xml", "");

}
/********************************************************************************
* 기      능   : sms 전송
********************************************************************************/
function fn_sms() 
{
  //alert("a");
	if(length(trim(Combo2.Text)) == 0 )
	{
		gfn_showAlert("CW00113", '지역담당자');
		return;
	}
	
	var lv_msg = "";
    var lv_tel = ""; //"010-4714-5711";
    
	lv_msg = '공사번호' + ed_pjt.Text + ', 현장명' + ed_bstnk.Text + '에 대한 민원이 접수되었습니다.SRM 현장민원 접수내역에서 확인하시기 바랍니다.' ;
	
	if(Combo2.Value == 'A')
	{
  	  lv_tel = "010-6430-0709";
	}
	else if(Combo2.Value == 'B')
	{
	  lv_tel = "010-9186-6823";
 	}
	else if(Combo2.Value == 'C')
	{
	  lv_tel = "010-8418-3416";
	}
	else if(Combo2.Value == 'D')
	{
  	  lv_tel = "010-8566-9405";
	}	
	 //alert(Combo2.Value);	
	 
	gfn_initDs(ds_sms, true);
	ds_sms.SetColumn(0,"TRAN_ETC1", "PS1204008B");
	//ds_sms.SetColumn(0,"TRAN_TYPE", "1");
	//ds_sms.SetColumn(0,"TRAN_STATUS", "1");
	ds_sms.SetColumn(0,"TRAN_TYPE", "0");
	ds_sms.SetColumn(0,"TRAN_STATUS", "0");
	ds_sms.SetColumn(0,"TRAN_CALLBACK", "1577-0603");
	ds_sms.SetColumn(0,"TRAN_MSG", lv_msg);
    ds_sms.SetColumn(0,"TRAN_PHONE", lv_tel);


//trace(	ds_sms.SaveXML());
//alert("xxx");	
	tit_clearActionInfo();
	tit_addMultiActionInfo("ps07:PS0704001A_I2");
	tit_callService(
		"PDA_ACT"
		, ""
		, "ds_sms=ds_sms"
		, ""
		, ""
		, "fn_smsSend" //""
		, ""
		, ""
		, true);
		
 
		
}



/********************************************************************************
* 기      능   : sms 메시지 Callback  
********************************************************************************/
function fn_smsSend(errCode, errMsg) 
{
//alert("s");
	if ( errCode != 0 ) 
	{
		global.FRM_BOTTOM.img_msgType.imageId = "bottom_icon_caution";
		global.FRM_BOTTOM.st_msg.color = "yellow";       
		global.FRM_BOTTOM.st_msg.value = "SMS발송을 실패하였습니다.";
		return;
	} 
    else 
    {
		//global.FRM_BOTTOM.img_msgType.imageId = "bottom_icon_caution";
		//global.FRM_BOTTOM.st_msg.color = "yellow";       
		global.FRM_BOTTOM.st_msg.value = "SMS발송이 되었습니다.";
		
	}
	
	 
    parent.fn_query();    
    fn_close();
}

/********************************************************************************
* 기      능   : 협력업체 변경시 팀장 세팅
********************************************************************************/
function edt_lifnr_OnChanged(obj,strText)
{
	fn_tmcd();
}

function btn_lifnr_OnClick(obj)
{
	//var arg = ds_list.GetColumn(nRow, "WRKLFN");
	var arg = 'F_ZZACTSS='+quote(ds_master.getColumn(0, "ZZACTSS"));
	var arr = gfn_openPopup("PS0208001D", true, arg);
	
	if(Length(arr) > 0)
	{
		//ds_list.fireevent = false;
		ds_master.SetColumn(0, "LIFNR", arr[0]);
		ds_master.SetColumn(0, "LIFNR_NM", arr[1]);
		
		fn_tmcd();
		//ds_list.fireevent = true;
	}
}

/********************************************************************************
* 기      능   : 협력업체 변경 후, Enter 키 클릭 시
********************************************************************************/
function edt_lifnr_OnKeyDown(obj,nChar,bShift,bCtrl, bAlt,LLParam,HLParam)
{
	if(nChar == 13)	// 엔터키 클릭 시
	{
		applyData();
	}
}

/********************************************************************************
* 기      능   : 업체별 팀장코드 함수 
********************************************************************************/
function fn_tmcd() 
{
    tit_clearActionInfo();
	tit_addSearchActionInfo("ps12:PS1204005B_S7");      //팀장 코드
	
	tit_callService(
		""
		, ""
		, "ds_master=ds_master"
		, "ds_tmcd=ds_tmcd"		
		, ""
		, ""   //"fn_afterQueryA"
		, ""  //true
		, ""
		, true);
		
		 //ds_zzlifnr.SetColumn(0,"PCNT" , ds_tmcd.GetColumn(0,"PCNT"));
}

function ds_master_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{
	if(strColumnID == 'LIFNR_NM')
	{
		if(length(Trim(varNewValue)) == 0)
		{
			ds_master.SetColumn(0, "LIFNR", "");
			ds_master.SetColumn(0, "LIFNR_NM", "");
			return;
		}
		
		// 존재하는 사업자번호 체크 (미존재시 팝업)
		nFindRow = ufn_chkLifnr(varNewValue);
		
		if(nFindRow < 0)	// 사업자 번호 미존재시 팝업을 띄워준다.
		{
			var arg = "";
			var arr = gfn_openPopup("PS0208001D", true, arg);
			
			if(Length(arr) > 0)
			{
				ds_master.SetColumn(0, "LIFNR", arr[0]);
				ds_master.SetColumn(0, "LIFNR_NM", arr[1]);
			}

		}
		else
		{
			if(nFindRow == 1)
			{
				ds_master.SetColumn(0, "LIFNR", ds_lifnr_grid.GetColumn(0, "CODE"));
				ds_master.SetColumn(0, "LIFNR_NM", ds_lifnr_grid.GetColumn(0, "CODE_NAME"));
			}
			else
			{
				var arg = "F_LIFNR_N="+quote(varNewValue);
				var arr = gfn_openPopup("PS0208001D", true, arg);
				
				if(Length(arr) > 0)
				{
					ds_master.SetColumn(0, "LIFNR", arr[0]);
					ds_master.SetColumn(0, "LIFNR_NM", arr[1]);
				}
			}
			
		}
	}
}

function ufn_chkLifnr(lifnr)
{
	var rValue = 0;
	
	ds_condLifnr.ClearData();
	ds_condLifnr.addRow();
	ds_condLifnr.SetColumn(0, "LIFNR", lifnr);
	
	tit_clearActionInfo();
	tit_addSearchActionInfo("ps02:PS0208001D_S2");
	tit_callService(
		""
		, ""
		, "ds_cond=ds_condLifnr"
		, "ds_lifnr_grid=ds_lifnr_grid"
		, ""
		, "" // fn_afterQueryC
		, ""
		, ""
		, true);
	
	if(ds_lifnr_grid.GetRowCount() == 0)
	{
		rValue = -1;
	}
	else
	{
		rValue = ds_lifnr_grid.GetRowCount();
	}
	
	return rValue;
}]]></Script>
</Window>