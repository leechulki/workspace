<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="562" Id="PS1205002E_BAK" Left="8" OnLoadCompleted="fn_OnLoadCompleted" OnUnloadCompleted="fn_OnUnloadCompleted" PidAttrib="7" Title="단계별&#32;안전점검&#32;현황" Top="8" Ver="1.0" Width="978" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_list" OnColumnChanged="ds_list_OnColumnChanged">
				<Contents>
					<colinfo id="CHECK" size="256" summ="default" type="STRING"/>
					<colinfo id="PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZACTSS" size="256" summ="default" type="STRING"/>
					<colinfo id="TEXT30" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNR_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="TEMNO" size="256" summ="default" type="STRING"/>
					<colinfo id="NAMET" size="256" summ="default" type="STRING"/>
					<colinfo id="TEMNO2" size="256" summ="default" type="STRING"/>
					<colinfo id="NAMET2" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSPEC1" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSPEC2" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZSHIP1" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZCOMP2" size="256" summ="default" type="STRING"/>
					<colinfo id="STEP1" size="256" summ="default" type="STRING"/>
					<colinfo id="STEP1_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="STEP2" size="256" summ="default" type="STRING"/>
					<colinfo id="STEP2_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="STEP3" size="256" summ="default" type="STRING"/>
					<colinfo id="STEP3_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="MDATE" size="256" summ="default" type="STRING"/>
					<colinfo id="ERNAM" size="256" summ="default" type="STRING"/>
					<colinfo id="EDATE" size="256" summ="default" type="STRING"/>
					<colinfo id="AENAM" size="256" summ="default" type="STRING"/>
					<colinfo id="SAFE1_CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="SAFE2_CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSITE_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="TYPE" size="256" summ="default" type="STRING"/>
					<colinfo id="TYPENM" size="256" summ="default" type="STRING"/>
					<colinfo id="STEP1_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="STEP2_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="STEP3_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="DEVICE_GBN1" size="256" summ="default" type="STRING"/>
					<colinfo id="DEVICE_GBN2" size="256" summ="default" type="STRING"/>
					<colinfo id="DEVICE_GBN3" size="256" summ="default" type="STRING"/>
					<colinfo id="APPR1_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="APPR2_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="APPR3_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="APPR1_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="APPR2_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="APPR3_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="APPR1_CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="APPR2_CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="APPR3_CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="RJCT1" size="256" summ="default" type="STRING"/>
					<colinfo id="RJCT2" size="256" summ="default" type="STRING"/>
					<colinfo id="RJCT3" size="256" summ="default" type="STRING"/>
					<colinfo id="FNAME_APP" size="256" summ="default" type="STRING"/>
					<colinfo id="STEP3_GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZGUBUN" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond">
				<Contents>
					<colinfo id="PSPID" size="255" summ="default" type="STRING"/>
					<colinfo id="ZZGUBUN" size="256" summ="default" type="STRING"/>
					<colinfo id="SHIP1_F" size="256" summ="default" type="STRING"/>
					<colinfo id="SHIP1_T" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZACTSS" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZPMNUM" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZLIFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="USER_CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="USER_GRUP" size="256" summ="default" type="STRING"/>
					<colinfo id="SO_GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="APPR" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID_IN1" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID_IN2" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID_IN3" size="256" summ="default" type="STRING"/>
					<colinfo id="RJCT_DESC" size="256" summ="default" type="STRING"/>
					<record>
						<PSPID></PSPID>
						<SHIP1_F></SHIP1_F>
						<SHIP1_T></SHIP1_T>
						<SO_GBN></SO_GBN>
						<USER_CODE></USER_CODE>
						<USER_GRUP></USER_GRUP>
						<ZZACTSS></ZZACTSS>
						<ZZGUBUN></ZZGUBUN>
						<ZZLIFNR></ZZLIFNR>
						<ZZPMNUM></ZZPMNUM>
						<APPR></APPR>
						<POSID_IN1></POSID_IN1>
						<POSID_IN2></POSID_IN2>
						<POSID_IN3></POSID_IN3>
						<RJCT_DESC></RJCT_DESC>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_code">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE>A</CODE>
						<CODE_NAME>양호</CODE_NAME>
					</record>
					<record>
						<CODE>B</CODE>
						<CODE_NAME>해당사항없음</CODE_NAME>
					</record>
					<record>
						<CODE></CODE>
						<CODE_NAME></CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list2">
				<Contents>
					<colinfo id="CHECK" size="256" summ="default" type="STRING"/>
					<colinfo id="PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZACTSS" size="256" summ="default" type="STRING"/>
					<colinfo id="TEXT30" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNR_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="TEMNO" size="256" summ="default" type="STRING"/>
					<colinfo id="NAMET" size="256" summ="default" type="STRING"/>
					<colinfo id="TEMNO2" size="256" summ="default" type="STRING"/>
					<colinfo id="NAMET2" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSPEC1" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSPEC2" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZSHIP1" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZCOMP2" size="256" summ="default" type="STRING"/>
					<colinfo id="STEP1" size="256" summ="default" type="STRING"/>
					<colinfo id="STEP1_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="STEP2" size="256" summ="default" type="STRING"/>
					<colinfo id="STEP2_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="STEP3" size="256" summ="default" type="STRING"/>
					<colinfo id="STEP3_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="MDATE" size="256" summ="default" type="STRING"/>
					<colinfo id="ERNAM" size="256" summ="default" type="STRING"/>
					<colinfo id="EDATE" size="256" summ="default" type="STRING"/>
					<colinfo id="AENAM" size="256" summ="default" type="STRING"/>
					<colinfo id="SAFE1_CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="SAFE2_CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSITE_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="TYPE" size="256" summ="default" type="STRING"/>
					<colinfo id="TYPENM" size="256" summ="default" type="STRING"/>
					<colinfo id="STEP1_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="STEP2_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="STEP3_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="DEVICE_GBN1" size="256" summ="default" type="STRING"/>
					<colinfo id="DEVICE_GBN2" size="256" summ="default" type="STRING"/>
					<colinfo id="DEVICE_GBN3" size="256" summ="default" type="STRING"/>
					<colinfo id="APPR1_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="APPR2_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="APPR3_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="APPR1_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="APPR2_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="APPR3_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="APPR1_CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="APPR2_CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="APPR3_CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="APPR_RJCT1" size="256" summ="default" type="STRING"/>
					<colinfo id="APPR_RJCT2" size="256" summ="default" type="STRING"/>
					<colinfo id="APPR_RJCT3" size="256" summ="default" type="STRING"/>
					<colinfo id="FNAME_APP" size="256" summ="default" type="STRING"/>
					<colinfo id="STEP3_GBN" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond2" OnColumnChanged="ds_list_OnColumnChanged">
				<Contents>
					<colinfo id="PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
					<colinfo id="GUBUN" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond3" OnColumnChanged="ds_list_OnColumnChanged">
				<Contents>
					<colinfo id="GUBUN" size="256" summ="default" type="STRING"/>
					<colinfo id="GUBUN2" size="256" summ="default" type="STRING"/>
					<colinfo id="STEP" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_print" OnColumnChanged="ds_list_OnColumnChanged">
				<Contents>
					<colinfo id="PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSITE_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZACTSS" size="256" summ="default" type="STRING"/>
					<colinfo id="TEXT30" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNR_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="TEMNO" size="256" summ="default" type="STRING"/>
					<colinfo id="NAMET" size="256" summ="default" type="STRING"/>
					<colinfo id="TEMNO2" size="256" summ="default" type="STRING"/>
					<colinfo id="NAMET2" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZSHIP1" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZCOMP2" size="256" summ="default" type="STRING"/>
					<colinfo id="STEP" size="256" summ="default" type="STRING"/>
					<colinfo id="STEP_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="IMAGE1" size="256" summ="default" type="STRING"/>
					<colinfo id="IMAGE2" size="256" summ="default" type="STRING"/>
					<colinfo id="IMAGE3" size="256" summ="default" type="STRING"/>
					<colinfo id="TYPE" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZGUBUN" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_zzpmnum_cd">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME></CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_zzactss">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME></CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond_cd">
				<Contents>
					<colinfo id="TEMNO" size="256" type="STRING"/>
					<colinfo id="ZZACTSS" size="256" type="STRING"/>
					<record>
						<TEMNO></TEMNO>
						<ZZACTSS></ZZACTSS>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_zzlifnr">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
					<colinfo id="SORTL" size="256" type="STRING"/>
					<colinfo id="LOEVM" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_fname_cond">
				<Contents>
					<colinfo id="PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
					<colinfo id="GUBUN" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_fname">
				<Contents>
					<colinfo id="GBN" size="256" type="STRING"/>
					<colinfo id="FNAME" size="256" type="STRING"/>
					<colinfo id="FNAME_APP" size="256" type="STRING"/>
					<colinfo id="CDATE" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_mail_cond">
				<Contents>
					<colinfo id="PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNR" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_mail">
				<Contents>
					<colinfo id="PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNR_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="NAMET2" size="256" summ="default" type="STRING"/>
					<colinfo id="TEM_EMAIL" size="256" summ="default" type="STRING"/>
					<colinfo id="REP_EMAIL" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list_tmp" OnColumnChanged="ds_list_OnColumnChanged">
				<Contents>
					<colinfo id="CHECK" size="256" summ="default" type="STRING"/>
					<colinfo id="PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZACTSS" size="256" summ="default" type="STRING"/>
					<colinfo id="TEXT30" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNR_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="TEMNO" size="256" summ="default" type="STRING"/>
					<colinfo id="NAMET" size="256" summ="default" type="STRING"/>
					<colinfo id="TEMNO2" size="256" summ="default" type="STRING"/>
					<colinfo id="NAMET2" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSPEC1" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSPEC2" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZSHIP1" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZCOMP2" size="256" summ="default" type="STRING"/>
					<colinfo id="STEP1" size="256" summ="default" type="STRING"/>
					<colinfo id="STEP1_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="STEP2" size="256" summ="default" type="STRING"/>
					<colinfo id="STEP2_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="STEP3" size="256" summ="default" type="STRING"/>
					<colinfo id="STEP3_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="MDATE" size="256" summ="default" type="STRING"/>
					<colinfo id="ERNAM" size="256" summ="default" type="STRING"/>
					<colinfo id="EDATE" size="256" summ="default" type="STRING"/>
					<colinfo id="AENAM" size="256" summ="default" type="STRING"/>
					<colinfo id="SAFE1_CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="SAFE2_CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSITE_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="TYPE" size="256" summ="default" type="STRING"/>
					<colinfo id="STEP1_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="STEP2_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="STEP3_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="DEVICE_GBN1" size="256" summ="default" type="STRING"/>
					<colinfo id="DEVICE_GBN2" size="256" summ="default" type="STRING"/>
					<colinfo id="DEVICE_GBN3" size="256" summ="default" type="STRING"/>
					<colinfo id="APPR1_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="APPR2_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="APPR3_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="APPR1_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="APPR2_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="APPR3_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="APPR1_CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="APPR2_CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="APPR3_CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="APPR_RJCT1" size="256" summ="default" type="STRING"/>
					<colinfo id="APPR_RJCT2" size="256" summ="default" type="STRING"/>
					<colinfo id="APPR_RJCT3" size="256" summ="default" type="STRING"/>
					<colinfo id="FNAME_APP" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
		</Datasets>
		<Shape BKColor="user0" Bottom="104" Height="104" Id="Shape0" Left="0" LineColor="user1" Right="978" TabOrder="1" Top="0" Type="Rectangle" Width="978"></Shape>
		<Static Align="Right" Border="Flat" Enable="FALSE" Height="22" Id="Static2" Left="525" Style="sty_ipt_search" TabOrder="12" Top="4" VAlign="Middle" Visible="FALSE" Width="129"></Static>
		<Static Align="Right" Border="Flat" Height="22" Id="Static3" Left="99" Style="sty_ipt_search" TabOrder="6" Top="4" VAlign="Middle" Width="154"></Static>
		<Static Align="Right" Height="20" Id="Static0" Left="336" Style="sty_lb_search" TabOrder="2" Text="Proj&#32;No&#32;" Top="30" VAlign="Middle" Width="92"></Static>
		<Edit BindDataset="ds_cond" Border="Flat" CheckLength="Byte" Column="PSPID" Height="20" Id="ed_pjt" ImeMode="english" Left="431" MaxLength="6" Style="sty_ipt_search" TabOrder="18" Top="30" UpperOnly="TRUE" Width="76"></Edit>
		<Button Height="18" Id="btn_popProj" ImageID="btn_icon_search" Left="508" OnClick="btn_popProj_OnClick" TabOrder="3" Text="Button0" Top="31" Transparent="TRUE" Width="18"></Button>
		<Grid AreaSelect="TRUE" AutoEnter="TRUE" AutoFitEndLine="Hide" BindDataset="ds_list" BkColor2="default" BoldHead="true" Border="Flat" Bottom="556" ColSelect="TRUE" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="444" Id="grd_list" InputPanel="FALSE" Left="8" LineColor="user20" LineType="ExHORZ" OnCellDBLClick="grd_list_OnCellDblClick" OnHeadClick="grd_list_OnHeadClick" Right="966" RowHeight="20" ScrollCell="true" Style="sty_grid" TabOrder="4" TabStop="true" Top="112" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="958">
			<contents>
				<format id="EL">
					<columns>
						<col fix="left" width="25"/>
						<col fix="left" width="20"/>
						<col fix="left" width="60"/>
						<col fix="left" width="134"/>
						<col fix="left" width="62"/>
						<col width="54"/>
						<col width="50"/>
						<col width="70"/>
						<col width="103"/>
						<col width="60"/>
						<col width="70"/>
						<col width="110"/>
						<col width="73"/>
						<col width="73"/>
						<col width="60"/>
						<col width="40"/>
						<col width="77"/>
						<col width="60"/>
						<col width="40"/>
						<col width="77"/>
						<col width="60"/>
						<col width="40"/>
						<col width="77"/>
						<col width="0"/>
						<col width="0"/>
						<col width="0"/>
						<col width="0"/>
						<col width="0"/>
						<col width="0"/>
						<col width="0"/>
						<col width="0"/>
						<col width="0"/>
						<col width="0"/>
						<col width="0"/>
						<col width="0"/>
					</columns>
					<head>
						<cell align="center" col="0" color="user21" display="text" font="굴림,9" rowspan="2" text="NO"/>
						<cell align="center" col="1" color="user21" display="checkbox" font="굴림,9" rowspan="2"/>
						<cell align="center" col="2" color="user21" display="text" font="굴림,9" rowspan="2" text="프로젝트"/>
						<cell align="center" col="3" color="user21" display="text" font="굴림,9" rowspan="2" text="현장명"/>
						<cell align="center" col="4" color="user21" display="text" font="굴림,9" rowspan="2" text="호기번호"/>
						<cell align="center" col="5" color="user21" display="text" font="굴림,9" rowspan="2" text="사무소"/>
						<cell align="center" col="6" color="user21" display="text" font="굴림,9" rowspan="2" text="기종"/>
						<cell align="center" col="7" color="user21" display="text" font="굴림,9" rowspan="2" text="타입"/>
						<cell col="8" color="user21" display="text" font="굴림,9" rowspan="2" text="사양"/>
						<cell col="9" color="user21" display="text" font="굴림,9" rowspan="2" text="사무소"/>
						<cell col="10" color="user21" display="text" font="굴림,9" rowspan="2" text="착공예정일"/>
						<cell col="11" color="user21" display="text" font="굴림,9" rowspan="2" text="협력업체"/>
						<cell col="12" color="user21" display="text" font="굴림,9" rowspan="2" text="팀장"/>
						<cell col="13" color="user21" display="text" font="굴림,9" rowspan="2" text="PM"/>
						<cell col="14" color="user21" colspan="9" display="text" font="굴림,9" text="업로드일자"/>
						<cell align="center" col="14" color="user21" display="text" font="굴림,9" row="1" text="업로드1"/>
						<cell align="center" col="15" color="user21" display="text" font="굴림,9" row="1" text="출처1"/>
						<cell align="center" col="16" color="user21" display="text" font="굴림,9" row="1" text="1단계"/>
						<cell align="center" col="17" color="user21" display="text" font="굴림,9" row="1" text="업로드2"/>
						<cell align="center" col="18" color="user21" display="text" font="굴림,9" row="1" text="출처2"/>
						<cell align="center" col="19" color="user21" display="text" font="굴림,9" row="1" text="2단계"/>
						<cell align="center" col="20" color="user21" display="text" font="굴림,9" row="1" text="업로드3"/>
						<cell align="center" col="21" color="user21" display="text" font="굴림,9" row="1" text="출처3"/>
						<cell align="center" col="22" color="user21" display="text" font="굴림,9" row="1" text="3단계"/>
						<cell col="23" color="user21" colspan="3" display="text" font="굴림,9" text="지사&#32;승인"/>
						<cell align="center" col="23" color="user21" display="normal" font="굴림,9" row="1" text="1단계"/>
						<cell align="center" col="24" color="user21" display="normal" font="굴림,9" row="1" text="2단계"/>
						<cell align="center" col="25" color="user21" display="normal" font="굴림,9" row="1" text="3단계"/>
						<cell col="26" color="user21" colspan="9" display="text" font="굴림,9" text="승인&#32;날짜"/>
						<cell align="center" col="26" color="user21" colspan="3" display="text" font="굴림,9" row="1" text="1단계"/>
						<cell align="center" col="29" color="user21" colspan="3" display="text" font="굴림,9" row="1" text="2단계"/>
						<cell align="center" col="32" color="user21" colspan="3" display="text" font="굴림,9" row="1" text="3단계"/>
					</head>
					<body>
						<cell align="center" bkcolor2="user22" col="0" display="text" expr="CURROW+1"/>
						<cell align="center" bkcolor2="user22" col="1" colid="CHECK" display="checkbox" edit="checkbox"/>
						<cell align="center" bkcolor2="user22" col="2" colid="PSPID" display="text"/>
						<cell align="center" bkcolor2="user22" col="3" colid="ZSITE_NM" display="text"/>
						<cell align="center" bkcolor2="user22" col="4" colid="POSID" display="text"/>
						<cell align="center" bkcolor2="user22" col="5" colid="TEXT30" display="text"/>
						<cell align="center" bkcolor2="user22" col="6" colid="ZSPEC1" display="text"/>
						<cell align="center" bkcolor2="user22" col="7" colid="TYPENM" display="text"/>
						<cell align="center" bkcolor2="user22" col="8" colid="ZSPEC2" display="text"/>
						<cell align="center" bkcolor2="user22" col="9" colid="TEXT30" display="text"/>
						<cell align="center" bkcolor2="user22" col="10" colid="ZZSHIP1" display="text" Mask="####.##.##"/>
						<cell align="left" bkcolor2="user22" col="11" colid="LIFNR_NM" display="text"/>
						<cell align="center" bkcolor2="user22" col="12" colid="NAMET2" display="text"/>
						<cell align="center" bkcolor2="user22" col="13" colid="NAMET" display="text"/>
						<cell align="center" bkcolor2="user22" col="14" colid="STEP1_ID" display="text"/>
						<cell align="center" bkcolor2="user22" col="15" colid="DEVICE_GBN1" display="text"/>
						<cell align="center" bkcolor2="user22" col="16" colid="STEP1_DT" display="text" Mask="####.##.##"/>
						<cell align="center" bkcolor2="user22" col="17" colid="STEP2_ID" display="text"/>
						<cell align="center" bkcolor2="user22" col="18" colid="DEVICE_GBN2" display="text"/>
						<cell align="center" bkcolor2="user22" col="19" colid="STEP2_DT" display="text" Mask="####.##.##"/>
						<cell align="center" bkcolor2="user22" col="20" colid="STEP3_ID" display="text"/>
						<cell align="center" bkcolor2="user22" col="21" colid="DEVICE_GBN3" display="text"/>
						<cell align="center" bkcolor2="user22" col="22" colid="STEP3_DT" display="text" Mask="####.##.##"/>
						<cell align="center" bkcolor='expr:iif(APPR1_CHK==&quot;완료&quot;,&quot;green&quot;,iif(APPR1_CHK==&quot;반려&quot;,&quot;orange&quot;,&quot;user22&quot;))' col="23" colid="APPR1_CHK" color='expr:iif(APPR1_CHK==&quot;1&quot;||APPR1_CHK==&quot;0&quot;,&apos;black&apos;,&apos;white&apos;)' display='expr:iif(APPR1_CHK==&quot;1&quot;||APPR1_CHK==&quot;0&quot;,&quot;checkbox&quot;,&quot;text&quot;)' edit='expr:iif(APPR1_CHK==&quot;1&quot;||APPR1_CHK==&quot;0&quot;,&quot;checkbox&quot;,&quot;text&quot;)'/>
						<cell align="center" bkcolor='expr:iif(APPR2_CHK==&quot;완료&quot;,&quot;green&quot;,iif(APPR2_CHK==&quot;반려&quot;,&quot;orange&quot;,&quot;user22&quot;))' col="24" colid="APPR2_CHK" color='expr:iif(APPR2_CHK==&quot;1&quot;||APPR2_CHK==&quot;0&quot;,&apos;black&apos;,&apos;white&apos;)' display='expr:iif(APPR2_CHK==&quot;1&quot;||APPR2_CHK==&quot;0&quot;,&quot;checkbox&quot;,&quot;text&quot;)' edit='expr:iif(APPR2_CHK==&quot;1&quot;||APPR2_CHK==&quot;0&quot;,&quot;checkbox&quot;,&quot;text&quot;)'/>
						<cell align="center" bkcolor='expr:iif(APPR3_CHK==&quot;완료&quot;,&quot;green&quot;,iif(APPR3_CHK==&quot;반려&quot;,&quot;orange&quot;,&quot;user22&quot;))' col="25" colid="APPR3_CHK" color='expr:iif(APPR3_CHK==&quot;1&quot;||APPR3_CHK==&quot;0&quot;,&apos;black&apos;,&apos;white&apos;)' display='expr:iif(APPR3_CHK==&quot;1&quot;||APPR3_CHK==&quot;0&quot;,&quot;checkbox&quot;,&quot;text&quot;)' edit='expr:iif(APPR3_CHK==&quot;1&quot;||APPR3_CHK==&quot;0&quot;,&quot;checkbox&quot;,&quot;text&quot;)'/>
						<cell align="center" bkcolor2="user22" col="26" colid="APPR1_ID" display="text"/>
						<cell align="center" bkcolor='expr:iif(APPR_RJCT1==&quot;반&quot;,&quot;orange&quot;,&quot;user22&quot;)' col="27" colid="APPR_RJCT1" color='expr:iif(APPR_RJCT1==&quot;반&quot;,&quot;white&quot;,&quot;default&quot;)' display="text"/>
						<cell align="center" bkcolor='expr:iif(APPR_RJCT1==&quot;반&quot;,&quot;orange&quot;,&quot;user22&quot;)' col="28" colid="APPR1_DT" color='expr:iif(APPR_RJCT1==&quot;반&quot;,&quot;white&quot;,&quot;default&quot;)' display="text" Mask="####.##.##"/>
						<cell align="center" bkcolor2="user22" col="29" colid="APPR2_ID" display="text"/>
						<cell align="center" bkcolor='expr:iif(APPR_RJCT2==&quot;반&quot;,&quot;orange&quot;,&quot;user22&quot;)' col="30" colid="APPR_RJCT2" color='expr:iif(APPR_RJCT2==&quot;반&quot;,&quot;white&quot;,&quot;default&quot;)' display="text"/>
						<cell align="center" bkcolor='expr:iif(APPR_RJCT2==&quot;반&quot;,&quot;orange&quot;,&quot;user22&quot;)' col="31" colid="APPR2_DT" color='expr:iif(APPR_RJCT2==&quot;반&quot;,&quot;white&quot;,&quot;default&quot;)' display="text" Mask="####.##.##"/>
						<cell align="center" bkcolor2="user22" col="32" colid="APPR3_ID" display="text"/>
						<cell align="center" bkcolor='expr:iif(APPR_RJCT3==&quot;반&quot;,&quot;orange&quot;,&quot;user22&quot;)' col="33" colid="APPR_RJCT3" color='expr:iif(APPR_RJCT3==&quot;반&quot;,&quot;white&quot;,&quot;default&quot;)' display="text"/>
						<cell align="center" bkcolor='expr:iif(APPR_RJCT3==&quot;반&quot;,&quot;orange&quot;,&quot;user22&quot;)' col="34" colid="APPR3_DT" color='expr:iif(APPR_RJCT3==&quot;반&quot;,&quot;white&quot;,&quot;default&quot;)' display="text" Mask="####.##.##"/>
					</body>
				</format>
				<format id="ES">
					<columns>
						<col fix="left" width="25"/>
						<col fix="left" width="20"/>
						<col fix="left" width="53"/>
						<col fix="left" width="115"/>
						<col width="65"/>
						<col width="49"/>
						<col width="50"/>
						<col width="70"/>
						<col width="103"/>
						<col width="60"/>
						<col width="70"/>
						<col width="77"/>
						<col width="77"/>
						<col width="110"/>
						<col width="73"/>
						<col width="73"/>
					</columns>
					<head>
						<cell align="center" col="0" color="user21" display="text" font="굴림,9" rowspan="2" text="NO"/>
						<cell align="center" col="1" color="user21" display="checkbox" font="굴림,9" rowspan="2"/>
						<cell align="center" col="2" color="user21" display="text" font="굴림,9" rowspan="2" text="프로젝트"/>
						<cell align="center" col="3" color="user21" display="text" font="굴림,9" rowspan="2" text="현장명"/>
						<cell align="center" col="4" color="user21" display="text" font="굴림,9" rowspan="2" text="호기번호"/>
						<cell align="center" col="5" color="user21" display="text" font="굴림,9" rowspan="2" text="사무소"/>
						<cell align="center" col="6" color="user21" display="text" font="굴림,9" rowspan="2" text="기종"/>
						<cell align="center" col="7" color="user21" display="text" font="굴림,9" rowspan="2" text="타입"/>
						<cell col="8" color="user21" display="text" font="굴림,9" rowspan="2" text="사양"/>
						<cell col="9" color="user21" display="text" font="굴림,9" rowspan="2" text="사무소"/>
						<cell col="10" color="user21" display="text" font="굴림,9" rowspan="2" text="착공예정일"/>
						<cell col="11" color="user21" display="text" font="굴림,9" rowspan="2" text="협력업체"/>
						<cell col="12" color="user21" display="text" font="굴림,9" rowspan="2" text="팀장"/>
						<cell col="13" color="user21" display="text" font="굴림,9" rowspan="2" text="PM"/>
						<cell col="14" color="user21" colspan="2" display="text" font="굴림,9" text="점검확인"/>
						<cell align="center" col="14" color="user21" display="text" font="굴림,9" row="1" text="자재양중"/>
						<cell align="center" col="15" color="user21" display="text" font="굴림,9" row="1" text="Truss"/>
					</head>
					<body>
						<cell align="center" bkcolor2="user22" col="0" display="text" expr="CURROW+1"/>
						<cell align="center" bkcolor2="user22" col="1" colid="CHECK" display="checkbox" edit="checkbox"/>
						<cell align="center" bkcolor2="user22" col="2" colid="PSPID" display="text"/>
						<cell align="center" bkcolor2="user22" col="3" colid="ZSITE_NM" display="text"/>
						<cell align="center" bkcolor2="user22" col="4" colid="POSID" display="text"/>
						<cell align="center" bkcolor2="user22" col="5" colid="TEXT30" display="text"/>
						<cell align="center" bkcolor2="user22" col="6" colid="ZSPEC1" display="text"/>
						<cell align="center" bkcolor2="user22" col="7" colid="TYPENM" display="text"/>
						<cell align="center" bkcolor2="user22" col="8" colid="ZSPEC2" display="text"/>
						<cell align="center" bkcolor2="user22" col="9" colid="TEXT30" display="text"/>
						<cell align="center" bkcolor2="user22" col="10" colid="ZZSHIP1" display="text" Mask="####.##.##"/>
						<cell align="left" bkcolor2="user22" col="11" colid="LIFNR_NM" display="text"/>
						<cell align="center" bkcolor2="user22" col="12" colid="NAMET2" display="text"/>
						<cell align="center" bkcolor2="user22" col="13" colid="NAMET" display="text"/>
						<cell align="center" bkcolor2="user22" col="14" colid="STEP1_DT" color='expr:iif(STEP1_DT=&apos;00000000&apos;,&quot;red&quot;,&quot;default&quot;)' display="text" Mask="####.##.##"/>
						<cell align="center" bkcolor2="user22" col="15" colid="STEP2_DT" color='expr:iif(STEP2_DT=&apos;00000000&apos;,&quot;red&quot;,&quot;default&quot;)' display="text" Mask="####.##.##"/>
					</body>
				</format>
				<format id="JUCHA">
					<columns>
						<col fix="left" width="25"/>
						<col fix="left" width="20"/>
						<col fix="left" width="60"/>
						<col fix="left" width="134"/>
						<col width="62"/>
						<col width="54"/>
						<col width="50"/>
						<col width="70"/>
						<col width="103"/>
						<col width="60"/>
						<col width="70"/>
						<col width="110"/>
						<col width="73"/>
						<col width="73"/>
						<col width="77"/>
						<col width="77"/>
						<col width="77"/>
					</columns>
					<head>
						<cell align="center" col="0" color="user21" display="text" font="굴림,9" rowspan="2" text="NO"/>
						<cell align="center" col="1" color="user21" display="checkbox" font="굴림,9" rowspan="2"/>
						<cell align="center" col="2" color="user21" display="text" font="굴림,9" rowspan="2" text="프로젝트"/>
						<cell align="center" col="3" color="user21" display="text" font="굴림,9" rowspan="2" text="현장명"/>
						<cell align="center" col="4" color="user21" display="text" font="굴림,9" rowspan="2" text="호기번호"/>
						<cell align="center" col="5" color="user21" display="text" font="굴림,9" rowspan="2" text="사무소"/>
						<cell align="center" col="6" color="user21" display="text" font="굴림,9" rowspan="2" text="기종"/>
						<cell align="center" col="7" color="user21" display="text" font="굴림,9" rowspan="2" text="타입"/>
						<cell col="8" color="user21" display="text" font="굴림,9" rowspan="2" text="사양"/>
						<cell col="9" color="user21" display="text" font="굴림,9" rowspan="2" text="사무소"/>
						<cell col="10" color="user21" display="text" font="굴림,9" rowspan="2" text="착공예정일"/>
						<cell col="11" color="user21" display="text" font="굴림,9" rowspan="2" text="협력업체"/>
						<cell col="12" color="user21" display="text" font="굴림,9" rowspan="2" text="팀장"/>
						<cell col="13" color="user21" display="text" font="굴림,9" rowspan="2" text="PM"/>
						<cell col="14" color="user21" colspan="3" display="text" font="굴림,9" text="점검일자"/>
						<cell align="center" col="14" color="user21" display="text" font="굴림,9" row="1" text="1단계"/>
						<cell align="center" col="15" color="user21" display="text" font="굴림,9" row="1" text="2단계"/>
						<cell align="center" col="16" color="user21" display="text" font="굴림,9" row="1" text="3단계"/>
					</head>
					<body>
						<cell align="center" bkcolor2="user22" col="0" display="text" expr="CURROW+1"/>
						<cell align="center" bkcolor2="user22" col="1" colid="CHECK" display="checkbox" edit="checkbox"/>
						<cell align="center" bkcolor2="user22" col="2" colid="PSPID" display="text"/>
						<cell align="center" bkcolor2="user22" col="3" colid="ZSITE_NM" display="text"/>
						<cell align="center" bkcolor2="user22" col="4" colid="POSID" display="text"/>
						<cell align="center" bkcolor2="user22" col="5" colid="TEXT30" display="text"/>
						<cell align="center" bkcolor2="user22" col="6" colid="ZSPEC1" display="text"/>
						<cell align="center" bkcolor2="user22" col="7" colid="TYPENM" display="text"/>
						<cell align="center" bkcolor2="user22" col="8" colid="ZSPEC2" display="text"/>
						<cell align="center" bkcolor2="user22" col="9" colid="TEXT30" display="text"/>
						<cell align="center" bkcolor2="user22" col="10" colid="ZZSHIP1" display="text" Mask="####.##.##"/>
						<cell align="left" bkcolor2="user22" col="11" colid="LIFNR_NM" display="text"/>
						<cell align="center" bkcolor2="user22" col="12" colid="NAMET2" display="text"/>
						<cell align="center" bkcolor2="user22" col="13" colid="NAMET" display="text"/>
						<cell align="center" bkcolor2="user22" col="14" colid="STEP1_DT" color='expr:iif(STEP1_DT=&apos;00000000&apos;,&quot;read&quot;,&quot;default&quot;)' display="text" Mask="####.##.##"/>
						<cell align="center" bkcolor2="user22" col="15" colid="STEP2_DT" color='expr:iif(STEP2_DT=&apos;00000000&apos;,&quot;red&quot;,&quot;default&quot;)' display="text" Mask="####.##.##"/>
						<cell align="center" bkcolor2="user22" col="16" colid="STEP3_DT" color='expr:iif(STEP3_DT=&apos;00000000&apos;,&quot;red&quot;,&quot;default&quot;)' display="text" Mask="####.##.##"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Calendar Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="146" Id="cal_temp" Left="1072" MonthOnly="TRUE" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" OnDayClick="cal_temp_OnDayClick" OnKillFocus="cal_temp_OnKillFocus" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="5" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="176" Value="20080401" Visible="FALSE" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="152"></Calendar>
		<Static Align="Right" Height="20" Id="Static1" Left="5" Style="sty_lb_search" TabOrder="7" Text="부&#32;문&#32;" Top="4" VAlign="Middle" Width="92"></Static>
		<Checkbox Enable="FALSE" FalseValue="0" Height="18" Id="chk_so4" Left="595" Style="sty_ipt_search_chk" TabOrder="11" Text="강북팀" Top="5" TrueValue="1" Visible="FALSE" Width="55"></Checkbox>
		<Checkbox Enable="FALSE" FalseValue="0" Height="18" Id="chk_so3" Left="528" Style="sty_ipt_search_chk" TabOrder="10" Text="강남팀" Top="5" TrueValue="1" Visible="FALSE" Width="58"></Checkbox>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="CODE" Column="ZZACTSS" DataColumn="CODE_NAME" Height="20" Id="cb_zzactss" InnerDataset="ds_zzactss" Left="430" OnChanged="cb_zzactss_OnChanged" Style="sty_ipt_search" TabOrder="9" Top="4" Width="94"></Combo>
		<Static Align="Right" Height="20" Id="Static18" Left="336" Style="sty_lb_search" TabOrder="8" Text="사무소&#32;" Top="5" VAlign="Middle" Width="92"></Static>
		<Static Align="Right" Height="20" Id="st_zzpmnum" Left="676" Style="sty_lb_search" TabOrder="13" Text="PM&#32;" Top="5" VAlign="Middle" Width="92"></Static>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="CODE" Column="ZZPMNUM" DataColumn="CODE_NAME" Height="20" Id="cb_zzpmnum" InnerDataset="ds_zzpmnum_cd" Left="769" Style="sty_ipt_search" TabOrder="21" Top="4" Width="111"></Combo>
		<Static Align="Right" Height="20" Id="st_date" Left="5" Style="sty_lb_search" TabOrder="14" Text="착공예정일&#32;" Top="29" VAlign="Middle" Width="92"></Static>
		<Calendar BindDataset="ds_cond" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="SHIP1_F" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="ed_ship1_f" Left="99" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_search" SundayTextColor="user35" TabOrder="15" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="29" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="94"></Calendar>
		<Static Align="Center" Border="None" Color="user7" Font="굴림,9" Height="14" Id="Static13" Left="197" TabOrder="17" Text="~" Top="32" VAlign="Middle" Width="12"></Static>
		<Calendar BindDataset="ds_cond" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="SHIP1_T" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="ed_ship1_t" Left="211" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_search" SundayTextColor="user35" TabOrder="16" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="29" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="94"></Calendar>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="CODE" Column="ZZLIFNR" DataColumn="CODE_NAME" Height="20" Id="cb_zzlifnr" InnerDataset="ds_zzlifnr" Left="770" Style="sty_ipt_search" TabOrder="19" Top="28" Width="162"></Combo>
		<Static Align="Right" Height="20" Id="st_lifnr" Left="677" Style="sty_lb_search" TabOrder="20" Text="설치협력사&#32;" Top="29" VAlign="Middle" Width="92"></Static>
		<Radio BindDataset="ds_cond" BKColor="user0" Border="None" Column="ZZGUBUN" Font="굴림,9" Height="15" Id="Radio1" INDEX="-1" Left="104" Style="sty_ipt_form_radio" TabOrder="23" Top="5" Value="1" Width="142">
			<Contents>
				<Layout code="2" height="20" left="0" text="E/S" top="0" width="40"/>
				<Layout code="3" height="20" left="43" text="M/W" top="0" width="50"/>
				<Layout code="4" height="20" left="93" text="주차" top="0" width="50"/>
			</Contents>
		</Radio>
		<Static Font="굴림,9" Height="23" Id="Static6" Left="10" TabOrder="23" Text="※&#32;리스트를&#32;더블클릭하면&#32;안전조치&#32;사진을&#32;볼&#32;수&#32;있습니다" Top="77" VAlign="Middle" Width="369"></Static>
		<Static Font="굴림,9" Height="16" Id="Static7" Left="368" TabOrder="25" Text="안전조치사진&#32;등록은&#32;[작업일보&#32;공정진행현황(현장이미지)]&#32;화면에서&#32;하시기&#32;바랍니다." Top="80" Width="475"></Static>
		<Static Font="굴림,9" Height="16" Id="Static12" Left="368" TabOrder="24" Text="설치본부&#32;안전3단계&#32;운영은&#32;안전승인시스템으로&#32;변경운영됩니다." Top="64" Width="376"></Static>
	</Form>
	<Script><![CDATA[﻿﻿﻿﻿﻿﻿﻿﻿
/*
 ******************************************************************************************
 * 기      능   :
 * 작  성  자   :
 * 작성  일자   :
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
#include "LIB::commons.js";	// 공통 스크립트
#include "LIB::utility.js";	// 다중 선택

//=========================================================================================
// [ PART 1 ]
// Form에서 사용될 전역변수를 선언
// FORM에서 사용되는 전역변수는 대문자로 작성하며, F_XXX 의 형태를 갖도록 한다.
//=========================================================================================
var user_grp = "";
var name1 = "";
var arr = "";
var chk = "";
var _rejectDesc = '';

//=========================================================================================
// [ PART 2 ]
// Form Loading / Unloading 시 작업 정의
//=========================================================================================
function fn_OnLoadCompleted(obj) {
	gfn_initForm(true);
	//gfn_initDs(ds_cond, true);

	user_grp = gfn_getUserGroup();

	Radio0.Index = 0;
	Radio1.Index = 0;

	if(user_grp == '10' || user_grp == '20')
	{
		chk_so3.Enable = false;
		chk_so4.Enable = false;
		//cb_zzpmnum.Enable = true;
	}
	else if( user_grp == '30' || user_grp == '40' )
	{
		chk_so3.Enable = true;
		chk_so4.Enable = true;
		cb_zzpmnum.Enable = true;
	}

	chk_so3.Value = '1';
	chk_so4.Value = '1';

	ed_ship1_f.value = substr(gfn_getCurrDate(),0,6)+"01";
	ed_ship1_t.value = gfn_getLeapLastDay(gfn_getCurrDate());

	ds_cond.SetColumn(0,"USER_GRUP",user_grp);
	if (user_grp == "10")
	{
		ds_cond.SetColumn(0,"USER_CODE",G_VEND_CODE_E);
	}
	else if (user_grp == "20")
	{
		ds_cond.SetColumn(0,"USER_CODE",G_USER_ID);
	}
	else if (user_grp == "30")
	{
		ds_cond.SetColumn(0,"USER_CODE",G_AREA_CODE_E);
	}

	var codeArr = ["PS003"];
    var dsObjArr = [ds_zzactss];
    var addTypeArr = [G_CODE_ALL];
    gfn_searchCommCode(codeArr, dsObjArr, addTypeArr);

	tit_clearActionInfo();
	tit_addSearchActionInfo("wb01:SEOLCHI_VEND_S2");

	tit_callService(
		""
		, ""
		, "ds_cond=ds_cond"
		, "ds_zzlifnr=ds_lifnr_cd"  // ds_pronr=ds_pronr"
		, ""
		, "fn_afterQueryC"
		, ""
		, ""
		, true);

	if(Radio1.Value == "1")
    {
		grd_list.Format = "EL";
	}
	else if(Radio1.Value == "2")
	{
		grd_list.Format = "ES";
	}
	else if(Radio1.Value == "3")
	{
	    grd_list.Format = "ES";
	}
	else if(Radio1.Value == "4")
	{
	    grd_list.Format = "JUCHA";
	}

	ed_ship1_f.SETFOCUS();
	gfn_showMsg("CI00007");
}

/********************************************************************************
* 기      능   : 공통코드가 조회된 후의 Callback 함수
********************************************************************************/
function fn_completeInit(sCode, sDsObj, sCodeType)
{
	if(user_grp == "30" || user_grp == "40")
	{
		cb_zzactss.Index = 0;
		cb_zzactss.Enable = true;
	}
	else if(user_grp == "10")
	{
		cb_zzactss.Index = 0;
		cb_zzactss.Enable = false;
		cb_zzpmnum.Enable = false;
	}
}

/********************************************************************************
* 기      능   : 조회 Callback  - 리스트의 검사기관 조회
********************************************************************************/
function fn_afterLifnr(errCode, errMsg) {

}

/********************************************************************************
* 기      능   : form UnloadCompleted
********************************************************************************/
function fn_OnUnloadCompleted(obj) {
	return gfn_isFormUnload(obj);
}

//=========================================================================================
// [ PART 3 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,form닫기)
//=========================================================================================

/********************************************************************************
* 기      능   : 라디오 버튼 변경 이베네트
********************************************************************************/
function Radio1_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	fn_query();
}

/********************************************************************************
* 기      능   : 사무소콤보 변경시 설치PM 콤보값 생성
********************************************************************************/
function cb_zzactss_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
    ds_cond.SetColumn(0,"ZZLIFNR",'');

    if(ds_cond.GetColumn(0,"ZZACTSS") == '')
    {
      ds_zzlifnr.UnFilter();
    }
    else
    {
      var arr = ds_cond.GetColumn(0,"ZZACTSS");
	  ds_zzlifnr.Filter("ZZACTSS ==" +quote(arr));
    }

    ds_cond_cd.SetColumn(0,"ZZACTSS",strCode);
	cb_zzpmnum.value = "";

	tit_clearActionInfo();
	tit_addSearchActionInfo("ps02:PS0201001A_S41");

	tit_callService(
		""
		, ""
		, "ds_cond_cd=ds_cond_cd"
		, "ds_zzpmnum_cd=ds_zzpmnum_cd"  // ds_pronr=ds_pronr"
		, ""
		, "fn_afterZzactssChange"
		, ""
		, ""
		, true);
}

/********************************************************************************
* 기      능   :  협력사 조회 Callback
********************************************************************************/
function fn_afterQueryC(errCode, errMsg) {
	cb_zzlifnr.Index = 0;

	if ( user_grp == "10" )
	{
		cb_zzlifnr.Enable = false;
	}
	else if ( user_grp == "30" || user_grp == "40")
	{

		ds_zzlifnr.filter("LOEVM!='X'" );
		gfn_insertEmptyRow( ds_zzlifnr, G_CODE_ALL );
		cb_zzlifnr.value = "";
	}
}

/********************************************************************************
* 기      능   : 조회 Callback  - 사무소 변경시
********************************************************************************/
function fn_afterZzactssChange(errCode, errMsg) {
	gfn_insertEmptyRow( ds_zzpmnum_cd, G_CODE_ALL );
	cb_zzpmnum.value = "";
}

/********************************************************************************
* 기      능   : 조회 1
********************************************************************************/
function fn_query()
{

    if ( !gfn_checkFromToObj(ed_ship1_f, ed_ship1_t, true, st_date.value, 0, true) )
    {
		return;
	}

	//E/L, E/S 구분
	if(Radio1.Value == "1")
    {
		ds_cond.SetColumn(0,"ZZGUBUN","1");
		grd_list.Format = "EL";
	}
	else if(Radio1.Value == "2")
	{
		ds_cond.SetColumn(0,"ZZGUBUN","2");
		grd_list.Format = "ES";
	}
	else if(Radio1.Value == "3")
	{
		ds_cond.SetColumn(0,"ZZGUBUN","3");
		grd_list.Format = "ES";
	}
	else if(Radio1.Value == "4")
	{
	    ds_cond.SetColumn(0,"ZZGUBUN","4");
		grd_list.Format = "JUCHA";
	}

	tit_clearActionInfo();
	//tit_addSearchActionInfo("ps12:PS1205002A_S1");
	tit_addSearchActionInfo("ps12:PS1205002E_S1");
	tit_callService(
          ""
        , ""
        , "ds_cond=ds_cond"
        , "ds_list=ds_list"
        , ""
        , "fn_afterQuery"
        , ""
		, ""
        , true);
}

/********************************************************************************
* 기      능   : 조회 Callback
********************************************************************************/
function fn_afterQuery(errCode, errMsg) {
	// 메시지 처리
	//gfn_showSearchMsg(grd_list);
	gfn_showMsg("CI00002",ds_list.RowCount()+"");
	

}

/********************************************************************************
* 기      능   : 조회 Callback
********************************************************************************/
function fn_afterQuery2(errCode, errMsg)
{

}

/********************************************************************************
* 기      능   : 조회 Callback
********************************************************************************/
function fn_afterQuery3(errCode, errMsg)
{

}

/********************************************************************************
* 기      능   : 저장
********************************************************************************/
function fn_save()
{

}

/********************************************************************************
* 기      능   : 삽입 20
********************************************************************************/
function fn_input() {
}
/********************************************************************************
* 기      능   : Delete
********************************************************************************/
function fn_delete()
{

}

/********************************************************************************
* 기      능   : 전송 60
********************************************************************************/
function fn_trans() {

}

/********************************************************************************
* 기      능   : 닫기
********************************************************************************/
function fn_close() {
	close();
}

/********************************************************************************
* 기      능   : 액셀
********************************************************************************/
function fn_excel()
{
	// Excel Export
	gfn_saveToExcel(grd_list, true );

	//gfn_saveToExcel(grd_list, true, '', '', true );
}

/********************************************************************************
* 기      능   : 접수 5
********************************************************************************/
function fn_receipt() {

}

/********************************************************************************
* 기      능   : 승인 10
********************************************************************************/
function fn_approval() {
	if(!gfn_showConfirm("승인하시겠습니까?")) {
		return;
	}

	ds_list_tmp.ClearData();
	ds_list_tmp.copyF(ds_list);
	ds_list_tmp.Filter('APPR1_CHK==1');
	var appr1Checked = '';
	for (var i = 0; i < ds_list_tmp.RowCount(); i++) {
		if (i > 0) {
			appr1Checked += ',';
		}
		appr1Checked += "'" + ds_list_tmp.GetColumn(i, 'POSID') + "'";
	}
	ds_list_tmp.unFilter();
	ds_list_tmp.Filter('APPR2_CHK==1');
	var appr2Checked = '';
	for (var i = 0; i < ds_list_tmp.RowCount(); i++) {
		if (i > 0) {
			appr2Checked += ',';
		}
		appr2Checked += "'" + ds_list_tmp.GetColumn(i, 'POSID') + "'";
	}
	ds_list_tmp.unFilter();
	ds_list_tmp.Filter('APPR3_CHK==1');
	var appr3Checked = '';
	for (var i = 0; i < ds_list_tmp.RowCount(); i++) {
		if (i > 0) {
			appr3Checked += ',';
		}
		appr3Checked += "'" + ds_list_tmp.GetColumn(i, 'POSID') + "'";
	}

	if (appr1Checked == '' && appr2Checked == '' && appr3Checked == '') {
		gfn_alert('지사 승인 체크 박스를 선택해 주세요.');
		return;
	}
	
	// 안전 1단계 승인 처리 update
	if (appr1Checked != '') {
		ds_cond.SetColumn(0, 'POSID_IN1', 'AND POSID IN (' + appr1Checked + ')');
		tit_addMultiActionInfo("ps12:PS1205002E_U1");  // ZPSTW1502 Update
	}
    // 안전 2단계 승인 처리 update
	if (appr2Checked != '') {
		ds_cond.SetColumn(0, 'POSID_IN2', 'AND POSID IN (' + appr2Checked + ')');
		tit_addMultiActionInfo("ps12:PS1205002E_U2");  // ZPSTW1502 Update
	}
	// 안전 3단계 승인 처리 update
	if (appr3Checked != '') {
		ds_cond.SetColumn(0, 'POSID_IN3', 'AND POSID IN (' + appr3Checked + ')');
		tit_addMultiActionInfo("ps12:PS1205002E_U3");	// ZPSTW1502 Update
	}

	tit_callService(
		""
		, ""
		, "ds_cond=ds_cond"
		, ""
		, ""
		, "fn_afterApproval"
		, true);
}

function fn_afterApproval() {
	ds_list_tmp.ClearData();

	ds_cond.SetColumn(0, 'POSID_IN1', '');
	ds_cond.SetColumn(0, 'POSID_IN2', '');
	ds_cond.SetColumn(0, 'POSID_IN3', '');

	fn_query();
}

/********************************************************************************
* 기      능   : d결재 15
********************************************************************************/
function fn_decide() {
}

/********************************************************************************
* 기      능   : 취소 35
********************************************************************************/
function fn_cancel() {
}

/********************************************************************************
* 기      능   : 더블클릭 이벤트
********************************************************************************/
function grd_list_OnCellDblClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
	chk = '';

	//gfn_initDs(ds_cond3, true);
	var arg = "";
	var arg2 = "";
	var param = "";
	var param2 = "";

	ds_cond3.ClearData();
	ds_cond3.AddRow();
	arg = "'" + ds_list.GetColumn(nRow,"PSPID") + "'";
	param = "  AND A.POSID IN ("+arg+")";
	ds_cond3.SetColumn(0,"GUBUN",param);

	arg2 = "'" + ds_list.GetColumn(nRow,"POSID") + "'";
	param2 = "  AND A.POSID_1 IN ("+arg2+")";
	ds_cond3.SetColumn(0,"GUBUN2",param2);

	var step = 0;
	if (nCell >= 14) {
		if (nCell >= 14 && nCell <= 16) {
			step = 0;
		} else if (nCell >= 17 && nCell <= 19) {
			step = 1;
		} else if (nCell >= 20 && nCell <= 22) {
			step = 2;
		} else if (nCell == 23) {
			step = 0;
		} else if (nCell == 24) {
			step = 1;
		} else if (nCell == 25) {
			step = 2;
		} else if (nCell >= 26 && nCell <= 28) {
			step = 0;
		} else if (nCell >= 29 && nCell <= 31) {
			step = 1;
		} else if (nCell >= 32 && nCell <= 34) {
			step = 2;
		} else {
			step = 0;
		}
		fn_print1('EL' + (step + 1));
		return;
	}

	if(Radio1.Value == "1")
    {
		gfn_openPopup("PS1205002C",true, 'step=' + step);
	}
	else if(Radio1.Value == "2" || Radio1.Value == "3")
	{
		gfn_openPopup("PS1205002D",true, 'step=' + step);
	}
	else if(Radio1.Value == "4")
	{
	    gfn_openPopup("PS1205002F",true, 'step=' + step);
	}
}

function fn_afterFname() {
	if (ds_fname.RowCount() == 0) {
		gfn_showAlert('안전 조치 사진 데이터가 존재하지 않습니다.');
		return;
	}

	var arg = '';
	var cnt = 0;
	for (var i = 0; i < ds_fname.RowCount(); i++) {
		var fnameApp = ds_fname.GetColumn(i, "FNAME_APP");
		var fname = ds_fname.GetColumn(i, "FNAME");
		var cdate = ds_fname.GetColumn(i, "CDATE");
		if (fnameApp != '') {
			var url = GF_FILE_SERVER_URL;
			if (IndexOf(url, "localhost")) {
				url = Replace(url, "localhost:8088", "203.242.37.24:8080");
			}
			if (i > 0) {
				arg += ' ';
			}
			arg += "fname_app" + i + "=" + quote(Replace(url, "/HELCO_WEB/", "/") + 'upload/QM/' + fnameApp);
			arg += " fname" + i + "=" + quote(fname);
			arg += " cdate" + i + "=" + quote(cdate);

			cnt++;
		}
	}
	arg += " cnt=" + cnt;

	gfn_openPopupUrl("PS12::PS1205002H.xml", true, arg, 1000, 1000, 0, 0);
	// Dialog("PS12::PS1205002H.xml",arg, -1, -1, "Resize=true");
}

/********************************************************************************
* 기      능   : print 40
********************************************************************************/
function fn_print()
{
	if(ds_list.RowCount() == 0)
	{
		gfn_showMsg("CW00010");
		return;
	}
	if(ds_list.FindRow("CHECK", 1)==-1){
		gfn_showMsg('CW00046');
		return;
	}

	var pspid = "";
	var arg = "";
	var arg2 = "";

	var param = "";
	var param2 = "";

	ds_list_tmp.ClearData();
	ds_list.Filter("CHECK==1");
	ds_list_tmp.copyF(ds_list);
	ds_list.unFilter();

	ds_list_tmp.Sort("PSPID,POSID",True);
	for(var i=0; i<ds_list_tmp.GetRowCount(); i++)
	{
		if(pspid != ds_list_tmp.GetColumn(i,"PSPID"))
		{
			arg += "'"+ds_list_tmp.GetColumn(i,"PSPID")+"'"+",";
		}
		pspid = ds_list_tmp.GetColumn(i,"PSPID");


		arg2 += "'"+ds_list_tmp.GetColumn(i,"POSID")+"'"+",";
	}

	if(substr(arg,length(arg)-1) == ",") arg = substr(arg,0,length(arg)-1);
	param = "  AND A.POSID IN ("+arg+")";

	if(substr(arg2,length(arg2)-1) == ",") arg2 = substr(arg2,0,length(arg2)-1);
	param2 = "  AND A.POSID_1 IN ("+arg2+")";

	ds_cond3.ClearData();
	ds_cond3.AddRow();
	ds_cond3.SetColumn(0,"GUBUN",param);
	ds_cond3.SetColumn(0,"GUBUN2",param2);

//==================================================================

	if(Radio1.Value == "1")
    {
		//ds_cond3.SetColumn(0, "GUBUN", '10' );
		gfn_openPopup("PS1205002C",true);
	}
	else if(Radio1.Value == "2" || Radio1.Value == "3")
	{
		//ds_cond3.SetColumn(0, "GUBUN", '11' );
		gfn_openPopup("PS1205002D",true);
	}
     else if(Radio1.Value == "4")
	{
		gfn_openPopup("PS1205002F",true);
	}
}

/********************************************************************************
* 기      능   : MR상부비계
********************************************************************************/
function fn_print1(chk)
{
trace('### print1 ###');
	var path = '';

    //==============================================
	if(chk == 'EL1')
	{
		ds_cond3.SetColumn(0, "STEP", 'STEP1' );
	}
	else if(chk == 'EL2')
	{
		ds_cond3.SetColumn(0, "STEP", 'STEP2' );
	}
	else
	{
		ds_cond3.SetColumn(0, "STEP", 'STEP3' );
	}
    //===============================================

	tit_clearActionInfo();
	tit_addSearchActionInfo("ps12:PS1205002E_S2");
	tit_callService(
          ""
        , ""
        , "ds_cond3=ds_cond3"
        , "ds_print=ds_print"
        , ""
        , ""
        , ""
		, ""
        , true);

	for(var i=0; i<ds_print.GetRowCount(); i++)
	{
		if( length(ds_print.GetColumn(i, "IMAGE1")) != 0)
		{
//alert('1');
//alert(path);
			path = '';
			path = tit_getServerDir("QM", ds_print.GetColumn(i, "IMAGE1") ) ;

			ds_print.SetColumn(i,"IMAGE1", path);
		}

		if( length(ds_print.GetColumn(i, "IMAGE2")) != 0)
		{
//alert('2');
//alert(path);
			path = '';
			path = tit_getServerDir("QM", ds_print.GetColumn(i, "IMAGE2") ) ;
			ds_print.SetColumn(i,"IMAGE2", path);
		}
	    if( length(ds_print.GetColumn(i, "IMAGE3")) != 0)
	    {
//alert('3');
//alert(path);
		path = '';
		path = tit_getServerDir("QM", ds_print.GetColumn(i, "IMAGE3") ) ;
		ds_print.SetColumn(i,"IMAGE3", path);
	    }



		if (chk == 'EL2' && ds_print.GetColumn(i, 'TYPE') == 'EL01' && ds_print.GetColumn(i, 'ZZGUBUN') == '10') {
			ds_print.SetColumn(i, 'IMAGE2', '');
			ds_print.SetColumn(i, 'IMAGE_NM2', '');
			ds_print.SetColumn(i, 'IMAGE3', '');
			ds_print.SetColumn(i, 'IMAGE_NM3', '');
		} else if (chk == 'EL3' && ds_print.GetColumn(i, 'TYPE') == 'EL01' && ds_print.GetColumn(i, 'ZZGUBUN') == '10') {
			ds_print.SetColumn(i, 'IMAGE3', '');
			ds_print.SetColumn(i, 'IMAGE_NM3', '');
		} else if (chk == 'EL1' && ds_print.GetColumn(i, 'TYPE') == 'EL02' && ds_print.GetColumn(i, 'ZZGUBUN') == '10') {
			ds_print.SetColumn(i, 'IMAGE3', '');
			ds_print.SetColumn(i, 'IMAGE_NM3', '');
		} else if (chk == 'EL2' && ds_print.GetColumn(i, 'TYPE') == 'EL02' && ds_print.GetColumn(i, 'ZZGUBUN') == '10') {
			ds_print.SetColumn(i, 'IMAGE2', '');
			ds_print.SetColumn(i, 'IMAGE_NM2', '');
			ds_print.SetColumn(i, 'IMAGE3', '');
			ds_print.SetColumn(i, 'IMAGE_NM3', '');
		} else if (chk == 'EL3' && ds_print.GetColumn(i, 'TYPE') == 'EL02' && ds_print.GetColumn(i, 'ZZGUBUN') == '10') {
			ds_print.SetColumn(i, 'IMAGE2', '');
			ds_print.SetColumn(i, 'IMAGE_NM2', '');
			ds_print.SetColumn(i, 'IMAGE3', '');
			ds_print.SetColumn(i, 'IMAGE_NM3', '');
		} else if (chk == 'EL1' && ds_print.GetColumn(i, 'TYPE') == 'EL03' && ds_print.GetColumn(i, 'ZZGUBUN') == '10') {
			ds_print.SetColumn(i, 'IMAGE3', '');
			ds_print.SetColumn(i, 'IMAGE_NM3', '');
		} else if (chk == 'EL3' && ds_print.GetColumn(i, 'TYPE') == 'EL03' && ds_print.GetColumn(i, 'ZZGUBUN') == '10') {
			ds_print.SetColumn(i, 'IMAGE2', '');
			ds_print.SetColumn(i, 'IMAGE_NM2', '');
			ds_print.SetColumn(i, 'IMAGE3', '');
			ds_print.SetColumn(i, 'IMAGE_NM3', '');
		}



//alert(chk);
//alert(ds_print.GetColumn(i,"ZSPEC"));
	if(chk == 'EL1') //1단계
	{
		trace("chk == EL1");
	   if(ds_print.GetColumn(i,"TYPE") == 'EL01'|| ds_print.GetColumn(i,"TYPE") == 'EL04')
	   {
	    	trace("TYPE == EL01 or EL04");
		 Dialog("PS12::PS1205002P.xml", "gbn='EL1'");
	   }
	   else if(ds_print.GetColumn(i,"TYPE") == '')
	   {
	    	trace("TYPE == ''");
	     Dialog("PS12::PS1205002P.xml", "gbn='EL9'");
	   }
	   else
	   {
	    	trace("TYPE <> EL01 or EL04 or ''");
	     Dialog("PS12::PS1205002P.xml", "gbn='EL4'");
	   }
	}
	else if(chk == 'EL2') //2단계
	{
		trace("chk == EL2");
	    if(ds_print.GetColumn(i,"TYPE") == 'EL01' || ds_print.GetColumn(i,"TYPE") == 'EL04')
	    {
	    	trace("TYPE == EL01 or EL04");
	      Dialog("PS12::PS1205002P.xml", "gbn='EL2'");
	    }
	    else if(ds_print.GetColumn(i,"TYPE") == 'EL02'||ds_print.GetColumn(i,"TYPE") == 'EL05')
	    {
	    	trace("TYPE == EL02 or EL05");
	      Dialog("PS12::PS1205002P.xml", "gbn='EL5'");
	    }
	    else if(ds_print.GetColumn(i,"TYPE") == 'EL03'||ds_print.GetColumn(i,"TYPE") == 'EL06')
	    {
	    	trace("TYPE == EL03 or EL06");
	      Dialog("PS12::PS1205002P.xml", "gbn='EL6'");
	    }
	    else
	    {
		    trace("TYPE <> EL01 ~ 6");
	      Dialog("PS12::PS1205002P.xml", "gbn='EL10'");
	    }
	}
	else //3단계
	{
		trace("chk == EL3");
	  if(ds_print.GetColumn(i,"TYPE") == 'EL01'||ds_print.GetColumn(i,"TYPE") == 'EL04')
	    {
		trace("TYPE == EL01 or EL04");
		  Dialog("PS12::PS1205002P.xml", "gbn='EL3'");
		}
	  else if(ds_print.GetColumn(i,"TYPE") == 'EL02'||ds_print.GetColumn(i,"TYPE") == 'EL05')
	    {
	  trace("TYPE == EL02 or EL05");
	      Dialog("PS12::PS1205002P.xml", "gbn='EL7'");
	    }
	  else if(ds_print.GetColumn(i,"TYPE") == 'EL03' ||ds_print.GetColumn(i,"TYPE") == 'EL06')
	    {
	    trace("TYPE == EL03 or EL06");
	      Dialog("PS12::PS1205002P.xml", "gbn='EL8'");
	    }
	  else
	    {
	    trace("TYPE <> EL01 ~ 6");
	      Dialog("PS12::PS1205002P.xml", "gbn='EL11'");
	    }
	}
 }
}

/********************************************************************************
* 기      능   : print 40
********************************************************************************/
function fn_print2()
{
trace('### print2 ###');
    //==============================================
	if(chk == 'ES1')
	{
		ds_cond3.SetColumn(0, "STEP", 'STEP1' );
	}
	else
	{
		ds_cond3.SetColumn(0, "STEP", 'STEP2' );
	}
    //===============================================

	tit_clearActionInfo();
	tit_addSearchActionInfo("ps12:PS1205002E_S3");
	tit_callService(
          ""
        , ""
        , "ds_cond3=ds_cond3"
        , "ds_print=ds_print"
        , ""
        , ""
        , ""
		, ""
        , true);

	for(var i=0; i<ds_print.GetRowCount(); i++)
	{
		if( length(ds_print.GetColumn(i, "IMAGE1")) != 0)
		{
			path = '';
			path = tit_getServerDir("QM", ds_print.GetColumn(i, "IMAGE1") ) ;
			ds_print.SetColumn(i,"IMAGE1", path);
		}

		if( length(ds_print.GetColumn(i, "IMAGE2")) != 0)
		{
			path = '';
			path = tit_getServerDir("QM", ds_print.GetColumn(i, "IMAGE2") ) ;
			ds_print.SetColumn(i,"IMAGE2", path);
		}
	}

	if(chk == 'ES1')
	{
		Dialog("PS12::PS1205002P.xml", "gbn='ES1'");
	}
	else
	{
		Dialog("PS12::PS1205002P.xml", "gbn='ES2'");
	}
}

/********************************************************************************
* 기      능   : print 40
********************************************************************************/
function fn_print3()
{
trace('### print3 ###');
	var path = '';

    //==============================================
	if(chk == 'JUCHA')
	{
		ds_cond3.SetColumn(0, "STEP", 'STEP1' );
	}
	else if(chk == 'JUCHA2')
	{
		ds_cond3.SetColumn(0, "STEP", 'STEP2' );
	}
	else if(chk == 'JUCHA3')
	{
		ds_cond3.SetColumn(0, "STEP", 'STEP3' );
	}
    //===============================================

	tit_clearActionInfo();
	tit_addSearchActionInfo("ps12:PS1205002E_S4");
	tit_callService(
          ""
        , ""
        , "ds_cond3=ds_cond3"
        , "ds_print=ds_print"
        , ""
        , ""
        , ""
		, ""
        , true);

	for(var i=0; i<ds_print.GetRowCount(); i++)
	{
		if( length(ds_print.GetColumn(i, "IMAGE1")) != 0)
		{
			path = '';
			path = tit_getServerDir("QM", ds_print.GetColumn(i, "IMAGE1") ) ;

			ds_print.SetColumn(i,"IMAGE1", path);
		}

		if( length(ds_print.GetColumn(i, "IMAGE2")) != 0)
		{
			path = '';
			path = tit_getServerDir("QM", ds_print.GetColumn(i, "IMAGE2") ) ;
			ds_print.SetColumn(i,"IMAGE2", path);
		}

	   if(chk == 'JUCHA') //1단계
	    {//alert("a");

	       if(ds_print.GetColumn(i,"TYPE") == 'JC01')
	        {//alert("b");
	          Dialog("PS12::PS1205002P.xml", "gbn='JUCHA'");
	        }
	       else if(ds_print.GetColumn(i,"TYPE") == 'JC02')
	        {//alert("c");
	          Dialog("PS12::PS1205002P.xml", "gbn='JUCHA2");
	        }
	       else if(ds_print.GetColumn(i,"TYPE") == 'JC03')
	        {//alert("d");
	          Dialog("PS12::PS1205002P.xml", "gbn='JUCHA3'");
	        }
	       else if(ds_print.GetColumn(i,"TYPE") == 'JC04')
	        {//alert("e");
	          Dialog("PS12::PS1205002P.xml", "gbn='JUCHA4'");
	        }
	       else
	        {//alert("e");
	          Dialog("PS12::PS1205002P.xml", "gbn='JUCHA13'");
	        }
	    }
	    else if(chk == 'JUCHA2') //2단계
        {
	       if(ds_print.GetColumn(i,"TYPE") == 'JC01')
	       {
	         Dialog("PS12::PS1205002P.xml", "gbn='JUCHA5'");
	       }
	       else if(ds_print.GetColumn(i,"TYPE") == 'JC02')
	       {
	         Dialog("PS12::PS1205002P.xml", "gbn='JUCHA6'");
	       }
	       else if(ds_print.GetColumn(i,"TYPE") == 'JC03')
	       {
	         Dialog("PS12::PS1205002P.xml", "gbn='JUCHA7'");
	       }
	       else if(ds_print.GetColumn(i,"TYPE") == 'JC04')
	       {
	         Dialog("PS12::PS1205002P.xml", "gbn='JUCHA8'");
	       }
	       else
	       {
	         Dialog("PS12::PS1205002P.xml", "gbn='JUCHA14'");
	       }
	    }
	    else if (chk =='JUCHA3')//3단계
	    { //alert("1");
	      if(ds_print.GetColumn(i,"TYPE") == 'JC01')
	       {
		     Dialog("PS12::PS1205002P.xml", "gbn='JUCHA9'");
		   }
	      else if(ds_print.GetColumn(i,"TYPE") == 'JC02')
	       {// alert("2");
	         Dialog("PS12::PS1205002P.xml", "gbn='JUCHA10'");
	       }
	      else if(ds_print.GetColumn(i,"TYPE") == 'JC03')
	       {
	         Dialog("PS12::PS1205002P.xml", "gbn='JUCHA11'");
	       }
	      else if(ds_print.GetColumn(i,"TYPE") == 'JC04')
	      {
	         Dialog("PS12::PS1205002P.xml", "gbn='JUCHA12'");
	      }
	      else
	      {
	        Dialog("PS12::PS1205002P.xml", "gbn='JUCHA15'");
	      }
	    }
	}
}

/********************************************************************************
* 기      능   : 발행 50
********************************************************************************/
function fn_out() {

}

/********************************************************************************
* 기      능   : 신청 55
********************************************************************************/
function fn_request() {

}

/********************************************************************************
* 기      능   : 반송 65
********************************************************************************/
function fn_sendback() {

}

/********************************************************************************
* 기      능   : 계산 70
********************************************************************************/
function fn_cal() {

}

/********************************************************************************
* 기      능   : 복사 75
********************************************************************************/
function fn_copy() {

}

/********************************************************************************
* 기      능   : 확인 80
********************************************************************************/
function fn_confirm() {

}

//=========================================================================================
// [ PART 4]
// Callback 함수 정의 : callback 함수명은 메인 함수의 fn_xxxx() 에서 xxxx 부분은 fn_afterXXXX()
// 형태가 되도록 작성
//=========================================================================================

/********************************************************************************
* 기      능   : 저장 Callback
********************************************************************************/
function fn_afterSave(errCode, errMsg)
{

}

/********************************************************************************
* 기      능   : 삭제 Callback
********************************************************************************/
function fn_afterDelete(errCode, errMsg)
{

}

//=========================================================================================
// [ PART 5 ]
// Detail Process Event 정의 ( User Define function )
// 사용자 정의 함수는 ufn_xxxx() 형태로 작성
//=========================================================================================
/********************************************************************************
* 기      능   : 사용자 정의 함수
********************************************************************************/
function ufn_userfunction() {

}

/********************************************************************************
* 기      능   : master / detail 데이터셋 초기 데이터 셋팅
********************************************************************************/
function ufn_save(gbn){

}

//=========================================================================================
// [ PART 6 ]
// component Event 정의 : 각 Component 별 이벤트
//=========================================================================================
/********************************************************************************
* 기      능   : 그리드 헤더 클릭시 정렬 처리
********************************************************************************/
function grd_list_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
{
	if ( nCell == 0 ) {
		//return;
		gfn_selectGridCol(obj);
	}
	else if ( nCell == 1 ) {
		// 그리드에서 전체 선택 또는 선택 해제
		gfn_selectAllGrid(obj,nCell,nCell,true);
	} else {
		// 그리드 정렬 처리
		gfn_sortGrid(obj,nCell);
	}
}

/********************************************************************************
* 기      능   : 데이터셋 값 변경 시 - Flag 처리
********************************************************************************/
function ds_list_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{

}

/********************************************************************************
* 기      능   : 그리드 셀 클릭 시 이벤트
********************************************************************************/
function grd_list_OnCellClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{

}

// 달력 처리 부분
/********************************************************************************
* 기      능   : 그리드에서 날짜 입력시
********************************************************************************/
function grd_list_OnExpandEdit(obj,nRow,nCell,strVal,nPivotIndex)
{

}

/********************************************************************************
* 기      능   : 달력에서 일자 선택했을 경우
********************************************************************************/
function cal_temp_OnDayClick(obj,strText)
{

}

/********************************************************************************
* 기      능   : 달력에서 포커스 잃었을 경우
********************************************************************************/
function cal_temp_OnKillFocus(obj)
{
	//obj.Visible = false;
}

function btn_popProj_OnClick(obj)
{
	var arg = "pjt="+quote(ed_pjt.Text);
	gfn_openPopup("CS9601002A", true, arg);
}

function fn_reject() {
	ds_list_tmp.ClearData();
	ds_list_tmp.copyF(ds_list);
	ds_list_tmp.Filter('APPR1_CHK==1');
	var appr1CheckedCnt = ds_list_tmp.RowCount();
	ds_list_tmp.unFilter();
	ds_list_tmp.Filter('APPR2_CHK==1');
	var appr2CheckedCnt = ds_list_tmp.RowCount();
	ds_list_tmp.unFilter();
	ds_list_tmp.Filter('APPR3_CHK==1');
	var appr3CheckedCnt = ds_list_tmp.RowCount();

	if (appr1CheckedCnt == 0 && appr2CheckedCnt == 0 && appr3CheckedCnt == 0) {
		gfn_alert('지사 승인 체크 박스를 선택해 주세요.');
		return;
	}

	ds_list_tmp.unFilter();

	gfn_openPopup("PS1205002G",true);
}

function fn_callbackRejectPopup(rejectDesc) {
	_rejectDesc = rejectDesc;

	tit_clearActionInfo();
	ds_list_tmp.Filter('APPR1_CHK==1');
	var appr1Checked = '';
	for (var i = 0; i < ds_list_tmp.RowCount(); i++) {
		if (i > 0) {
			appr1Checked += ',';
		}
		appr1Checked += "'" + ds_list_tmp.GetColumn(i, 'POSID') + "'";
	}
	ds_list_tmp.unFilter();
	ds_list_tmp.Filter('APPR2_CHK==1');
	var appr2Checked = '';
	for (var i = 0; i < ds_list_tmp.RowCount(); i++) {
		if (i > 0) {
			appr2Checked += ',';
		}
		appr2Checked += "'" + ds_list_tmp.GetColumn(i, 'POSID') + "'";
	}
	ds_list_tmp.unFilter();
	ds_list_tmp.Filter('APPR3_CHK==1');
	var appr3Checked = '';
	for (var i = 0; i < ds_list_tmp.RowCount(); i++) {
		if (i > 0) {
			appr3Checked += ',';
		}
		appr3Checked += "'" + ds_list_tmp.GetColumn(i, 'POSID') + "'";
	}

	ds_cond.SetColumn(0, 'RJCT_DESC', rejectDesc);

	if (appr1Checked != '') {
		ds_cond.SetColumn(0, 'POSID_IN1', 'AND POSID IN (' + appr1Checked + ')');
		tit_addMultiActionInfo("ps12:PS1205002E_U4");
	}

	if (appr2Checked != '') {
		ds_cond.SetColumn(0, 'POSID_IN2', 'AND POSID IN (' + appr2Checked + ')');
		tit_addMultiActionInfo("ps12:PS1205002E_U5");
	}

	if (appr3Checked != '') {
		ds_cond.SetColumn(0, 'POSID_IN3', 'AND POSID IN (' + appr3Checked + ')');
		tit_addMultiActionInfo("ps12:PS1205002E_U6");
	}

	tit_callService(
		""
		, ""
		, "ds_cond=ds_cond"
		, ""
		, ""
		, "fn_sendMailAfterReject"
		, true);
}

function fn_sendMailAfterReject() {
	ds_list_tmp.unFilter();
	for (var i = 0; i < ds_list_tmp.RowCount(); i++) {
		var pspid = ds_list_tmp.GetColumn(i, 'PSPID');
		var posid = ds_list_tmp.GetColumn(i, 'POSID');
		var lifnr = ds_list_tmp.GetColumn(i, 'LIFNR');
		var appr1Chk = ds_list_tmp.GetColumn(i, 'APPR1_CHK');
		var appr2Chk = ds_list_tmp.GetColumn(i, 'APPR2_CHK');
		var appr3Chk = ds_list_tmp.GetColumn(i, 'APPR3_CHK');
		var lifnr_nm = ds_list_tmp.GetColumn(i, 'ZSITE_NM');
		var namet2 = ds_list_tmp.GetColumn(i, 'NAMET2');

		if (appr1Chk == '1' || appr2Chk == '1' || appr3Chk == '1') {

			tit_clearActionInfo();
			tit_addSearchActionInfo("ps12:PS1205002E_S6");

			if (ds_mail_cond.RowCount() == 0) {
				ds_mail_cond.ClearData();
				ds_mail_cond.AddRow();
			}

			var arg = '';
			arg += "'" + appr1Chk + "' AS APPR1_CHK, ";
			arg += "'" + appr2Chk + "' AS APPR2_CHK, ";
			arg += "'" + appr3Chk + "' AS APPR3_CHK, ";
			arg += "'" + lifnr_nm + "' AS LIFNR_NM, ";
			arg += "'" + namet2 + "' AS NAMET2";
			trace('arg : ' + arg);

			ds_mail_cond.SetColumn(0, 'PSPID', pspid);
			ds_mail_cond.SetColumn(0, 'POSID', posid);
			ds_mail_cond.SetColumn(0, 'LIFNR', lifnr);

			tit_callService(
				""
				, ""
				, "ds_mail_cond=ds_mail_cond"
				, "ds_mail=ds_mail"
				, "EXTERNAL_COLUMN=" + quote(arg)
				, "fn_sendMail"
				, true);
		}
	}

	GFN_ShowAlert("반려 처리를 완료했습니다.");
	fn_query();
}

function fn_sendMail() {
	trace('##### fn_sendMail start #####');
	for (var i = 0; i < ds_mail.RowCount(); i++) {
		var appr1_chk = ds_mail.GetColumn(0, 'APPR1_CHK');
		var appr2_chk = ds_mail.GetColumn(0, 'APPR2_CHK');
		var appr3_chk = ds_mail.GetColumn(0, 'APPR3_CHK');
		var pspid = ds_mail.GetColumn(0, 'PSPID');
		var posid = ds_mail.GetColumn(0, 'POSID');
		var namec = ds_mail.GetColumn(0, 'NAMEC');
		var lifnr_nm = ds_mail.GetColumn(0, 'LIFNR_NM');
		var namet2 = ds_mail.GetColumn(0, 'NAMET2');
		var tem_email = ds_mail.GetColumn(0, 'TEM_EMAIL');
		var rep_email = ds_mail.GetColumn(0, 'REP_EMAIL');

		if (tem_email != null && tem_email != '') {
			var send_user = G_EMAIL;
			if (send_user == null || send_user == '') {
				send_user = quote('helco' + G_USER_ID +  '@hdel.co.kr');
			} else {
				send_user = quote(G_EMAIL);
			}
			var contents = ' SEND_USER=' + send_user;
			contents += " SEND_USER_NM=" + quote( G_USER_NAME );

			if (tem_email != null && tem_email != '') {
				contents += " RECE_USER=" + quote( tem_email );

				if (namet2 != null && namet2 != '') {
					contents += " RECV_USER_NM=" + quote( namet2 );
				}
			}

			if (rep_email != null && rep_email != '') {
				contents += " CC_USER=" + quote( rep_email );

				if (namec != null && namec != '') {
					contents += " CC_USER_NM=" + quote( namec );
				}
			}

			var title = '[반려][안전관리현황]' + lifnr_nm + ' ';
			if (appr1_chk == '1' || appr1_chk == 1) {
				title += '(1단계)';
			}
			if (appr2_chk == '1' || appr2_chk == 1) {
				title += '(2단계)';
			}
			if (appr3_chk == '1' || appr3_chk == 1) {
				title += '(3단계)';
			}

			contents += ' MESGTITL='  + quote( title );

			var body = title + '\n\n';
			body += '아래와 같은 사유로 반려되었습니다.\n\n';
			body += '================================\n\n';
			body += _rejectDesc + '\n';
			body += '================================\n\n';

			contents += " MESGBODY="  + quote( body );

			trace('mail contents : ' + contents);

			tit_callService(
					"COMM_ACT"
					, "sendmail"
					, ""
					, ""
					, contents
					, ""
					, false
					, true);
		}
	}
	trace('##### fn_sendMail end #####');
}

]]></Script>
</Window>