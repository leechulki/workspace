<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="696" Icon="btn_icon_back_01" Id="PS0201001G" Left="8" OnLoadCompleted="fn_OnLoadCompleted" OnUnloadCompleted="fn_OnUnloadCompleted" PidAttrib="7" Title="현장관리(답사)&#32;이력관리(NEW)" Top="8" Ver="1.0" Width="1128" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_cond">
				<Contents>
					<colinfo id="PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQNO" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_master" UseClientLayout="1">
				<Contents>
					<colinfo id="PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQNO" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="EXPLO" size="256" summ="default" type="STRING"/>
					<colinfo id="CNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="FRAME_AFQ" size="256" summ="default" type="STRING"/>
					<colinfo id="AFQ" size="256" summ="default" type="STRING"/>
					<colinfo id="FRAME_DATE" size="256" summ="default" type="STRING"/>
					<colinfo id="MATNR_DATE" size="256" summ="default" type="STRING"/>
					<colinfo id="HOOK_DATE" size="256" summ="default" type="STRING"/>
					<colinfo id="CONSULT" size="256" summ="default" type="STRING"/>
					<colinfo id="FNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="FPATH" size="256" summ="default" type="STRING"/>
					<colinfo id="FSIZE" size="256" summ="default" type="STRING"/>
					<colinfo id="FNAME_APP" size="256" summ="default" type="STRING"/>
					<colinfo id="EXPLM" size="256" summ="default" type="STRING"/>
					<colinfo id="BIGO" size="256" summ="default" type="STRING"/>
					<colinfo id="CONSULTER1" size="256" summ="default" type="STRING"/>
					<colinfo id="CONSULTER2" size="256" summ="default" type="STRING"/>
					<colinfo id="FNAME1" size="256" summ="default" type="STRING"/>
					<colinfo id="FPATH1" size="256" summ="default" type="STRING"/>
					<colinfo id="FNAME_APP1" size="256" summ="default" type="STRING"/>
					<colinfo id="FSIZE1" size="256" summ="default" type="STRING"/>
					<colinfo id="CFNAME1" size="256" summ="default" type="STRING"/>
					<colinfo id="CFDATE1" size="256" summ="default" type="STRING"/>
					<colinfo id="FNAME2" size="256" summ="default" type="STRING"/>
					<colinfo id="FPATH2" size="256" summ="default" type="STRING"/>
					<colinfo id="FNAME_APP2" size="256" summ="default" type="STRING"/>
					<colinfo id="FSIZE2" size="256" summ="default" type="STRING"/>
					<colinfo id="CFNAME2" size="256" summ="default" type="STRING"/>
					<colinfo id="CFDATE2" size="256" summ="default" type="STRING"/>
					<colinfo id="CDATE" size="256" summ="default" type="STRING"/>
					<colinfo id="F_CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="AFQ_INDC" size="256" summ="default" type="STRING"/>
					<colinfo id="CID" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN_ELES" size="256" summ="default" type="STRING"/>
					<colinfo id="CURR_DATE" size="256" summ="default" type="STRING"/>
					<colinfo id="GUIDE_YN" size="256" summ="default" type="STRING"/>
					<colinfo id="GUIDE_DT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_head" OnColumnChanged="ds_head_OnColumnChanged" UseClientLayout="1">
				<Contents>
					<colinfo id="ADDR" size="210" summ="default" type="STRING"/>
					<colinfo id="CDATE" size="24" summ="default" type="STRING"/>
					<colinfo id="CONTR_DA" size="24" summ="default" type="STRING"/>
					<colinfo id="KUNNR_NM" size="105" summ="default" type="STRING"/>
					<colinfo id="MANDT" size="9" summ="default" type="STRING"/>
					<colinfo id="TEXT30" size="90" summ="default" type="STRING"/>
					<colinfo id="VALUE" size="11" summ="default" type="INT"/>
					<colinfo id="VDATU" size="24" summ="default" type="STRING"/>
					<colinfo id="ZMAN_NM" size="60" summ="default" type="STRING"/>
					<colinfo id="ZQNTY" size="6" summ="default" type="STRING"/>
					<colinfo id="ZSITE_NM" size="105" summ="default" type="STRING"/>
					<colinfo id="ZSITE_TEL" size="256" summ="default" type="STRING"/>
					<colinfo id="ZTEL" size="60" summ="default" type="STRING"/>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
					<colinfo id="GUBUN" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNRCHK" size="256" summ="default" type="STRING"/>
					<colinfo id="STRAS" size="256" summ="default" type="STRING"/>
					<colinfo id="NAME1" size="256" summ="default" type="STRING"/>
					<colinfo id="STRAS2" size="256" summ="default" type="STRING"/>
					<colinfo id="TURNKEY" size="256" summ="default" type="STRING"/>
					<colinfo id="ENFOR" size="256" summ="default" type="STRING"/>
					<colinfo id="ZMAN" size="256" summ="default" type="STRING"/>
					<colinfo id="STEXT" size="256" summ="default" type="STRING"/>
					<colinfo id="ZLIFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="PRDUSERNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="USERTELE" size="256" summ="default" type="STRING"/>
					<colinfo id="JKUNNR" size="256" summ="default" type="STRING"/>
					<colinfo id="TXT30" size="256" summ="default" type="STRING"/>
					<colinfo id="G_STAT" size="256" summ="default" type="STRING"/>
					<colinfo id="TEXT" size="256" summ="default" type="STRING"/>
					<colinfo id="SOPTP_REVERSE" size="256" summ="default" type="STRING"/>
					<colinfo id="GUIDE_YN" size="256" summ="default" type="STRING"/>
					<colinfo id="GUIDE_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="CNFM_YN" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_longText">
				<Contents>
					<colinfo id="TDOBJ" size="256" type="STRING"/>
					<colinfo id="TDNAME" size="256" type="STRING"/>
					<colinfo id="TDID" size="256" type="STRING"/>
					<colinfo id="TEXT" size="256" type="STRING"/>
					<colinfo id="FLAG" size="1" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_longText2">
				<Contents>
					<colinfo id="TDOBJ" size="256" type="STRING"/>
					<colinfo id="TDNAME" size="256" type="STRING"/>
					<colinfo id="TDID" size="256" type="STRING"/>
					<colinfo id="TEXT" size="256" type="STRING"/>
					<colinfo id="FLAG" size="1" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond1">
				<Contents>
					<colinfo id="PSPID" size="255" type="STRING"/>
					<record>
						<PSPID></PSPID>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_file" UseClientLayout="1">
				<Contents>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="PSPID" size="255" summ="default" type="STRING"/>
					<colinfo id="SEQNO" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQNO2" size="256" summ="default" type="STRING"/>
					<colinfo id="FNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="FNAME2" size="256" summ="default" type="STRING"/>
					<colinfo id="FPATH" size="256" summ="default" type="STRING"/>
					<colinfo id="FNAME_APP" size="256" summ="default" type="STRING"/>
					<colinfo id="FSIZE" size="256" summ="default" type="STRING"/>
					<colinfo id="CFNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="CFDATE" size="256" summ="default" type="STRING"/>
					<colinfo id="DEL_FNAME" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_temp">
				<Contents>
					<colinfo id="PSPID" size="255" summ="default" type="STRING"/>
					<colinfo id="SEQNO" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQNO2" size="256" summ="default" type="STRING"/>
					<colinfo id="FNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="FNAME2" size="256" summ="default" type="STRING"/>
					<colinfo id="FPATH" size="256" summ="default" type="STRING"/>
					<colinfo id="FNAME_APP" size="256" summ="default" type="STRING"/>
					<colinfo id="FSIZE" size="256" summ="default" type="STRING"/>
					<colinfo id="CFNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="CFDATE" size="256" summ="default" type="STRING"/>
					<colinfo id="DEL_FNAME" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_file2" UseClientLayout="1">
				<Contents>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="PSPID" size="255" summ="default" type="STRING"/>
					<colinfo id="SEQNO" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQNO2" size="256" summ="default" type="STRING"/>
					<colinfo id="FNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="FNAME2" size="256" summ="default" type="STRING"/>
					<colinfo id="FPATH" size="256" summ="default" type="STRING"/>
					<colinfo id="FNAME_APP" size="256" summ="default" type="STRING"/>
					<colinfo id="FSIZE" size="256" summ="default" type="STRING"/>
					<colinfo id="CFNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="CFDATE" size="256" summ="default" type="STRING"/>
					<colinfo id="DEL_FNAME" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_f" UseClientLayout="1">
				<Contents>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="PSPID" size="255" summ="default" type="STRING"/>
					<colinfo id="SEQNO" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQNO2" size="256" summ="default" type="STRING"/>
					<colinfo id="FNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="FNAME2" size="256" summ="default" type="STRING"/>
					<colinfo id="FPATH" size="256" summ="default" type="STRING"/>
					<colinfo id="FNAME_APP" size="256" summ="default" type="STRING"/>
					<colinfo id="FSIZE" size="256" summ="default" type="STRING"/>
					<colinfo id="CFNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="CFDATE" size="256" summ="default" type="STRING"/>
					<colinfo id="DEL_FNAME" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list1">
				<Contents>
					<colinfo id="TEXT" size="255" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_save" UseClientLayout="1">
				<Contents>
					<colinfo id="PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
					<colinfo id="ENABLE" size="256" summ="default" type="STRING"/>
					<colinfo id="GTCNT" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZINTER" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZSHIP1" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZSHIP2" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZSHIP3" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZSHIP4" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZSHIP5" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZSHIP6" size="256" summ="default" type="STRING"/>
					<colinfo id="AUFNR1" size="256" summ="default" type="STRING"/>
					<colinfo id="AUFNR2" size="256" summ="default" type="STRING"/>
					<colinfo id="AUFNR3" size="256" summ="default" type="STRING"/>
					<colinfo id="AUFNR4" size="256" summ="default" type="STRING"/>
					<colinfo id="AUFNR5" size="256" summ="default" type="STRING"/>
					<colinfo id="AUFNR6" size="256" summ="default" type="STRING"/>
					<colinfo id="FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="MATNR_DATE" size="256" summ="default" type="STRING"/>
					<colinfo id="CURR_DATE" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_error">
				<Contents>
					<colinfo id="IDX" size="256" type="STRING"/>
					<colinfo id="ERRMSG" size="256" type="STRING"/>
					<record>
						<ERRMSG></ERRMSG>
						<IDX></IDX>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_chkDay">
				<Contents>
					<colinfo id="CHK_INDC" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond_temp">
				<Contents>
					<colinfo id="MATNR_DATE" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond_day">
				<Contents>
					<colinfo id="FROM_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="TO_DT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_nextDay">
				<Contents>
					<colinfo id="DT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_check">
				<Contents>
					<colinfo id="MATNR_DATE" size="256" summ="default" type="STRING"/>
					<colinfo id="STADA" size="256" summ="default" type="STRING"/>
					<colinfo id="GUBUN" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZPJT_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSITE_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="ZMAN_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="NAMET" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID_1" size="256" summ="default" type="STRING"/>
					<colinfo id="CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="MAILRECV" size="256" summ="default" type="STRING"/>
					<colinfo id="MAILRECVNM" size="256" summ="default" type="STRING"/>
					<record>
						<CNT></CNT>
						<GUBUN></GUBUN>
						<MAILRECV></MAILRECV>
						<MAILRECVNM></MAILRECVNM>
						<MATNR_DATE></MATNR_DATE>
						<NAMET></NAMET>
						<POSID_1></POSID_1>
						<STADA></STADA>
						<ZMAN_NM></ZMAN_NM>
						<ZSITE_NM></ZSITE_NM>
						<ZZPJT_ID></ZZPJT_ID>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_trans">
				<Contents>
					<colinfo id="PJT" size="256" summ="default" type="STRING"/>
					<colinfo id="HNO" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
					<colinfo id="MESGTITL" size="256" summ="default" type="STRING"/>
					<colinfo id="MESGDESC" size="256" summ="default" type="STRING"/>
					<colinfo id="PMNM" size="256" summ="default" type="STRING"/>
					<colinfo id="SITE_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="FRAME_CK" size="256" summ="default" type="STRING"/>
					<colinfo id="PERNO1" size="256" summ="default" type="STRING"/>
					<colinfo id="PERNO2" size="256" summ="default" type="STRING"/>
					<colinfo id="PERNO" size="256" summ="default" type="STRING"/>
					<colinfo id="USER" size="256" summ="default" type="STRING"/>
					<colinfo id="PER_MAIL" size="256" summ="default" type="STRING"/>
					<colinfo id="MAILRECV" size="256" summ="default" type="STRING"/>
					<colinfo id="MAILRECVNM" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
		</Datasets>
		<Static Align="Right" Border="Flat" BorderColor="user7" Height="615" Id="Static12" Left="449" Style="sty_ipt_search" TabOrder="47" Top="73" VAlign="Middle" Width="671"></Static>
		<Static Font="Default,10,Bold" Height="16" Id="Static3" Left="449" Style="sty_lb_form_basic" TabOrder="1" Text="▣&#32;현장관리(답사)" Top="51" VAlign="Middle" Width="120"></Static>
		<Div Height="32" Id="div_btn" Left="-1" TabOrder="2" Text="Div0" Url="WB01::CommBtnForm.xml" Width="1129">
			<Contents></Contents>
		</Div>
		<Static Align="Center" Height="24" Id="Static58" Left="456" Style="sty_lb_form_basic" TabOrder="3" Text="현장답사일" Top="84" VAlign="Middle" Width="120"></Static>
		<Static Align="Center" Height="24" Id="Static0" Left="691" Style="sty_lb_form_basic" TabOrder="5" Text="현장답사자" Top="84" VAlign="Middle" Width="120"></Static>
		<Edit Align="CENTER" BindDataset="ds_master" Border="Flat" BorderColor="user13" Column="EXPLM" DisableBKColor="user5" DisableColor="BACKGROUND" Height="24" Id="ed_explm" Left="819" Style="sty_ipt_search" TabOrder="4" Top="84" Width="100"></Edit>
		<Static Align="Right" Border="Flat" Height="20" Id="Static4" Left="462" Style="sty_ipt_search" TabOrder="7" Top="122" VAlign="Middle" Width="252"></Static>
		<Radio BindDataset="ds_master" BKColor="user5" Border="None" Column="GBN" DisableBKColor="user5" Height="18" Id="rd_gbn" INDEX="-1" Left="463" Style="sty_ipt_form_radio" TabOrder="6" Top="123" Width="250">
			<Contents>
				<Layout code="A" height="20" left="0" text="전화" top="0" width="60"/>
				<Layout code="B" height="20" left="65" text="방문" top="0" width="60"/>
				<Layout code="C" height="20" left="130" text="전산" top="0" width="60"/>
				<Layout code="D" height="20" left="195" text="메일" top="0" width="60"/>
			</Contents>
		</Radio>
		<Static Align="Center" Height="24" Id="Static1" Left="456" Style="sty_lb_form_basic" TabOrder="8" Text="골조진행상태" Top="154" VAlign="Middle" Width="120"></Static>
		<Static Height="24" Id="Static2" Left="579" TabOrder="9" Text="현재층수" Top="162" Width="50"></Static>
		<Static Height="24" Id="Static5" Left="691" TabOrder="10" Text="층&#32;&#32;(총층수:" Top="162" Width="65"></Static>
		<Edit Align="CENTER" BindDataset="ds_master" Border="Flat" BorderColor="user13" Column="FRAME_AFQ" DisableBKColor="user5" DisableColor="user13" Height="24" Id="ed_fafq" ImeMode="english" Left="632" Style="sty_ipt_search" TabOrder="11" Top="156" Width="50"></Edit>
		<Edit Align="CENTER" BindDataset="ds_master" Border="Flat" BorderColor="user13" Column="aFQ" DisableBKColor="user5" DisableColor="BACKGROUND" Enable="FALSE" Height="24" Id="ed_afq" Left="760" Style="sty_ipt_search" TabOrder="12" Top="154" Width="40"></Edit>
		<Static Height="24" Id="Static6" Left="804" TabOrder="13" Text=")" Top="164" Width="10"></Static>
		<Static Align="Center" Height="24" Id="Static7" Left="456" Style="sty_lb_form_basic" TabOrder="14" Text="골조예상완료일" Top="186" VAlign="Middle" Width="120"></Static>
		<Static Align="Center" Height="24" Id="Static8" Left="704" Style="sty_lb_form_basic" TabOrder="15" Text="자재반입예상일" Top="186" VAlign="Middle" Width="120"></Static>
		<Static Align="Center" Height="24" Id="Static9" Left="456" Style="sty_lb_form_basic" TabOrder="16" Text="후크소요일" Top="219" VAlign="Middle" Width="120"></Static>
		<Static Align="Center" Height="24" Id="Static10" Left="456" Style="sty_lb_form_basic" TabOrder="17" Text="현장&#32;협의(메모)" Top="296" VAlign="Middle" Width="120"></Static>
		<Static Align="Center" Height="24" Id="Static11" Left="792" Style="sty_lb_form_basic" TabOrder="18" Text="첨부파일" Top="312" VAlign="Middle" Width="120"></Static>
		<FileDialog Bottom="792" Filter="All(*.*)|*.*|jpg&#32;File(*.jpg)|*.jpg|jpeg&#32;File(*.jpeg)|*.jpeg|bmp&#32;File(*.bmp)|*.jpeg|gif&#32;File(*.gif)|*.gif|pdf&#32;File(*.pdf)|*.pdf|" Height="24" Id="fileDialog" Left="240" Right="264" TabOrder="26" Top="768" Width="24"></FileDialog>
		<File Bottom="792" Height="24" Id="f_tmp" Left="309" Right="333" TabOrder="27" Top="768" Width="24"></File>
		<FileDialog Bottom="792" Filter="All(*.*)|*.*|jpg&#32;File(*.jpg)|*.jpg|jpeg&#32;File(*.jpeg)|*.jpeg|bmp&#32;File(*.bmp)|*.jpeg|gif&#32;File(*.gif)|*.gif|pdf&#32;File(*.pdf)|*.pdf|" Height="24" Id="saveDialog" Left="343" Right="367" TabOrder="28" Top="768" Type="Save" Width="24"></FileDialog>
		<Button Height="19" Id="btn_openFile" ImageID="btn_icon_polder" Left="1477" OnClick="btn_openFile_OnClick" TabOrder="19" Text="Button0" Top="527" Width="19"></Button>
		<Calendar BindDataset="ds_master" Border="Flat" BorderColor="user13" ClickedBkColor="user32" ClickedTextColor="user33" Column="FRAME_DATE" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="24" Id="cal_fdate" Left="584" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_search" SundayTextColor="user35" TabOrder="20" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="186" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="100"></Calendar>
		<Calendar BindDataset="ds_master" Border="Flat" BorderColor="user13" ClickedBkColor="user32" ClickedTextColor="user33" Column="MATNR_DATE" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="24" Id="cal_mdate" Left="832" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" OnChanged="cal_mdate_OnChanged" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_search" SundayTextColor="user35" TabOrder="21" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="186" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="100"></Calendar>
		<Calendar BindDataset="ds_master" Border="Flat" BorderColor="user13" ClickedBkColor="user32" ClickedTextColor="user33" Column="HOOK_DATE" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="24" Id="cal_hdate" Left="584" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_search" SundayTextColor="user35" TabOrder="22" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="219" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="100"></Calendar>
		<Calendar BindDataset="ds_master" Border="Flat" BorderColor="user13" ClickedBkColor="user32" ClickedTextColor="user33" Column="eXPLO" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="24" Id="cal_explo" Left="584" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_search" SundayTextColor="user35" TabOrder="23" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="84" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="100"></Calendar>
		<Calendar Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="146" Id="cal_temp" Left="1288" MonthOnly="TRUE" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" OnDayClick="cal_temp_OnDayClick" OnKillFocus="cal_temp_OnKillFocus" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="24" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="152" Value="20080401" Visible="FALSE" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="152"></Calendar>
		<Edit BindDataset="ds_master" Border="Flat" Column="FNAME" Enable="FALSE" Height="24" Id="ed_FileName" ImeMode="none" Left="1216" LeftMargin="4" Readonly="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="25" Top="528" Width="250"></Edit>
		<Static Height="15" Id="st_img" Left="732" TabOrder="26" Top="502" Width="25"></Static>
		<Calendar Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="146" Id="cal_temp1" Left="1288" MonthOnly="TRUE" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="27" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="320" Value="20180101" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="152"></Calendar>
		<Static Font="Default,10,Bold" Height="16" Id="Static13" Left="5" Style="sty_lb_form_basic" TabOrder="28" Text="▣&#32;현장정보" Top="51" VAlign="Middle" Width="80"></Static>
		<Static Font="Default,8" Height="12" Id="Static14" Left="657" TabOrder="29" Text="*&#32;기존&#32;종이&#32;방식으로&#32;현장답사록을&#32;관리하는&#32;경우는&#32;첨부파일만&#32;등록하시기&#32;바랍니다." Top="49" Width="432"></Static>
		<Div Border="Flat" Height="615" Id="Div0" Left="5" TabOrder="30" Text="Div0" Top="73" Width="443">
			<Contents>
				<Shape BKColor="user12" Bottom="164" Height="26" Id="Shape5" Left="4" LineColor="user13" Right="187" TabOrder="5" Top="138" Type="Rectangle" Width="183"></Shape>
				<TextArea BindDataset="ds_list1" Border="Flat" Column="TEXT" Height="415" Id="txt_longTxt" Left="9" Readonly="TRUE" Style="sty_ipt_form" TabOrder="1" Top="189" Width="434"></TextArea>
				<Static Font="Default,10,Bold" Height="16" Id="Static15" Left="5" Style="sty_lb_form_basic" TabOrder="2" Text="▣&#32;특기사항" Top="171" VAlign="Middle" Width="80"></Static>
				<Edit BindDataset="ds_head" Border="Flat" Column="ZSITE_TEL" Height="20" Id="Edit10" Left="81" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="3" Top="141" Width="103"></Edit>
				<Static Align="Center" Height="24" Id="Static16" Left="5" Style="sty_lb_form_basic" TabOrder="4" Text="현장전화" Top="139" VAlign="Middle" Width="74"></Static>
				<Edit Align="CENTER" BindDataset="ds_head" Border="Flat" Column="ENFOR" Height="20" Id="Edit9" Left="298" LeftMargin="4" Readonly="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="6" Top="109" Width="139"></Edit>
				<Edit Align="CENTER" BindDataset="ds_head" Border="Flat" Column="KUNNR_NM" Height="20" Id="Edit8" Left="81" LeftMargin="4" Readonly="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="7" Top="109" Width="138"></Edit>
				<Static Align="Center" Height="24" Id="Static17" Left="5" Style="sty_lb_form_basic" TabOrder="8" Text="계약업체" Top="107" VAlign="Middle" Width="74"></Static>
				<Static Align="Center" Height="24" Id="Static18" Left="221" Style="sty_lb_form_basic" TabOrder="9" Text="시행사" Top="107" VAlign="Middle" Width="75"></Static>
				<Shape BKColor="user12" Bottom="132" Height="26" Id="Shape4" Left="4" LineColor="user13" Right="440" TabOrder="10" Top="106" Type="Rectangle" Width="436"></Shape>
				<Edit Align="CENTER" BindDataset="ds_head" Border="Flat" Column="G_STAT" Height="20" Id="Edit7" Left="363" LeftMargin="4" Readonly="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="11" Top="85" Width="74"></Edit>
				<Static Align="Center" Height="24" Id="Static19" Left="286" Style="sty_lb_form_basic" TabOrder="12" Text="계약상태" Top="83" VAlign="Middle" Width="75"></Static>
				<Edit Align="CENTER" BindDataset="ds_head" Border="Flat" Column="LIFNRCHK" Height="20" Id="Edit2" Left="210" LeftMargin="4" Readonly="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="13" Top="85" Width="74"></Edit>
				<Edit Align="CENTER" BindDataset="ds_head" Border="Flat" Column="TXT30" Height="20" Id="Edit1" Left="81" LeftMargin="4" Readonly="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="14" Top="85" Width="50"></Edit>
				<Static Align="Center" Height="24" Id="Static20" Left="5" Style="sty_lb_form_basic" TabOrder="15" Text="상태" Top="83" VAlign="Middle" Width="74"></Static>
				<Static Align="Center" Height="24" Id="Static21" Left="133" Style="sty_lb_form_basic" TabOrder="16" Text="계약형태" Top="83" VAlign="Middle" Width="75"></Static>
				<Shape BKColor="user12" Bottom="108" Height="26" Id="Shape3" Left="4" LineColor="user13" Right="440" TabOrder="17" Top="82" Type="Rectangle" Width="436"></Shape>
				<Edit BindDataset="ds_head" Border="Flat" Column="ADDR" Height="20" Id="Edit0" Left="81" LeftMargin="4" Readonly="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="18" Top="60" Width="356"></Edit>
				<Static Align="Center" Height="24" Id="Static22" Left="5" Style="sty_lb_form_basic" TabOrder="19" Text="프로젝트명" Top="58" VAlign="Middle" Width="74"></Static>
				<Shape BKColor="user12" Bottom="83" Height="26" Id="Shape0" Left="4" LineColor="user13" Right="440" TabOrder="20" Top="57" Type="Rectangle" Width="436"></Shape>
				<Static Align="Center" Height="24" Id="Static23" Left="290" Style="sty_lb_form_basic" TabOrder="21" Text="납기일" Top="9" VAlign="Middle" Width="63"></Static>
				<Edit Align="CENTER" BindDataset="ds_head" Border="Flat" Column="ZQNTY" Height="20" Id="Edit6" Left="238" LeftMargin="4" Readonly="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="22" Top="11" Width="50"></Edit>
				<Edit BindDataset="ds_head" Border="Flat" Column="ZSITE_NM" Height="20" Id="Edit5" Left="81" LeftMargin="4" Readonly="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="23" Top="36" Width="356"></Edit>
				<Static Align="Center" Height="24" Id="Static24" Left="5" Style="sty_lb_form_basic" TabOrder="24" Text="프로젝트명" Top="34" VAlign="Middle" Width="74"></Static>
				<Shape BKColor="user12" Bottom="59" Height="26" Id="Shape2" Left="4" LineColor="user13" Right="440" TabOrder="25" Top="33" Type="Rectangle" Width="436"></Shape>
				<Edit Align="CENTER" BindDataset="ds_head" Border="Flat" Column="POSID" Height="20" Id="Edit3" Left="81" LeftMargin="4" Readonly="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="26" Top="11" Width="90"></Edit>
				<Static Align="Center" Height="24" Id="Static25" Left="5" Style="sty_lb_form_basic" TabOrder="27" Text="프로젝트&#32;" Top="9" VAlign="Middle" Width="74"></Static>
				<Static Align="Center" Height="24" Id="Static26" Left="173" Style="sty_lb_form_basic" TabOrder="28" Text="총대수" Top="9" VAlign="Middle" Width="63"></Static>
				<Shape BKColor="user12" Bottom="34" Height="26" Id="Shape1" Left="4" LineColor="user13" Right="440" TabOrder="29" Top="8" Type="Rectangle" Width="436"></Shape>
				<Static Align="Center" Height="24" Id="Static58" Left="5" Style="sty_lb_form_basic" TabOrder="30" Text="프로젝트" Top="9" VAlign="Middle" Width="74"></Static>
				<Static Align="Center" Height="24" Id="Static0" Left="5" Style="sty_lb_form_basic" TabOrder="31" Text="프로젝트명" Top="34" VAlign="Middle" Width="74"></Static>
				<Static Align="Center" Height="23" Id="Static1" Left="5" Style="sty_lb_form_basic" TabOrder="32" Text="설치지역" Top="59" VAlign="Middle" Width="74"></Static>
				<Static Align="Center" Height="24" Id="Static2" Left="5" Style="sty_lb_form_basic" TabOrder="33" Text="상태" Top="83" VAlign="Middle" Width="74"></Static>
				<Static Align="Center" Height="23" Id="Static3" Left="5" Style="sty_lb_form_basic" TabOrder="34" Text="계약업체" Top="108" VAlign="Middle" Width="74"></Static>
				<Static Align="Center" Height="24" Id="Static4" Left="5" Style="sty_lb_form_basic" TabOrder="35" Text="현장전화" Top="139" VAlign="Middle" Width="74"></Static>
				<Static Align="Center" Height="24" Id="Static5" Left="173" Style="sty_lb_form_basic" TabOrder="36" Text="총대수" Top="9" VAlign="Middle" Width="63"></Static>
				<Static Align="Center" Height="24" Id="Static6" Left="290" Style="sty_lb_form_basic" TabOrder="37" Text="납기일" Top="9" VAlign="Middle" Width="63"></Static>
				<Static Align="Center" Height="24" Id="Static7" Left="133" Style="sty_lb_form_basic" TabOrder="38" Text="계약형태" Top="83" VAlign="Middle" Width="75"></Static>
				<Static Align="Center" Height="24" Id="Static8" Left="287" Style="sty_lb_form_basic" TabOrder="39" Text="계약상태" Top="83" VAlign="Middle" Width="74"></Static>
				<Static Align="Center" Height="23" Id="Static9" Left="222" Style="sty_lb_form_basic" TabOrder="40" Text="시행사" Top="108" VAlign="Middle" Width="74"></Static>
				<MaskEdit Align="Center" BindDataset="ds_head" Border="Flat" BorderColor="user13" Column="VDATU" Cursor="IBEAM" Height="20" Id="mae_vdatu" Left="355" Mask="####.##.##" MaxLength="8" NullValue="00000000" Readonly="TRUE" Style="sty_ipt_form" TabOrder="41" Top="11" Type="STRING" Value="MaskEdit0" Width="82"></MaskEdit>
				<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_modify" ImageID="btn_sub_02" Left="190" LeftMargin="12" OnClick="Div0_btn_modify_OnClick" Style="sty_btn" TabOrder="42" TabStop="FALSE" Text="수정" Top="140" Transparent="TRUE" Width="47"></Button>
				<Static Font="Default,8" Height="11" Id="Static14" Left="246" TabOrder="43" Text="*&#32;현장전화는&#32;변경가능" Top="144" VAlign="Middle" Width="120"></Static>
			</Contents>
		</Div>
		<Static Font="Default,8" Height="26" Id="Static15" Left="728" TabOrder="31" Text="현장방문&#32;시&#32;사진으로&#32;이력을&#32;남겨놓으면&#13;&#10;분쟁시&#32;증빙자료로&#32;활용할&#32;수&#32;있습니다" Top="115" VAlign="Middle" Width="205"></Static>
		<TextArea BindDataset="ds_master" Border="Flat" Column="CONSULT" Height="352" Id="txt_consult" Left="456" Style="sty_ipt_form" TabOrder="32" Top="326" Width="320"></TextArea>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_fileAdd" ImageID="btn_sub_04" Left="939" LeftMargin="12" OnClick="btn_fileAdd_OnClick" Style="sty_btn" TabOrder="33" TabStop="FALSE" Text="파일추가" Top="342" Transparent="TRUE" Width="72"></Button>
		<Button Align="Left" ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_imageViewer" ImageID="btn_sub_09" Left="792" OnClick="btn_imageViewer_OnClick" Style="sty_btn" TabOrder="34" Text="&#32;&#32;&#32;이미지&#32;뷰어로&#32;보기" Top="342" Transparent="TRUE" Width="133"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_fileDel" ImageID="btn_sub_04" Left="1012" LeftMargin="12" OnClick="btn_fileDel_OnClick" Style="sty_btn" TabOrder="35" TabStop="FALSE" Text="파일삭제" Top="342" Transparent="TRUE" Width="72"></Button>
		<Static Font="Default,8" Height="12" Id="Static17" Left="984" TabOrder="36" Text="*&#32;더블클릭:파일오픈" Top="369" Width="107"></Static>
		<Grid AutoEnter="TRUE" AutoFitEndLine="Hide" AutoScrollBar="AlwaysVert" BindDataset="ds_file" BkColor2="default" BoldHead="true" Border="Flat" Bottom="546" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="162" Id="grd_list" InputPanel="FALSE" Left="792" LineColor="user20" LineType="ExHORZ" OnCellDBLClick="grd_list_OnCellDblClick" OnHeadClick="grd_list_OnHeadClick" Right="1082" RowHeight="20" Style="sty_grid" TabOrder="37" TabStop="true" Top="384" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="290">
			<contents>
				<format id="Default">
					<columns>
						<col width="20"/>
						<col width="251"/>
					</columns>
					<head>
						<cell align="center" col="0" display="checkbox"/>
						<cell col="1" display="text" text="첨부파일&#32;리스트"/>
					</head>
					<body>
						<cell align="left" bkcolor2="user22" col="0" colid="CHK" display="checkbox" edit="checkbox"/>
						<cell align="left" bkcolor2="user22" col="1" colid="FNAME2" display="text"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Static Align="Center" Height="24" Id="Static16" Left="792" Style="sty_lb_form_basic" TabOrder="38" Text="협의자1" Top="554" VAlign="Middle" Width="143"></Static>
		<Static Align="Center" Height="24" Id="Static18" Left="939" Style="sty_lb_form_basic" TabOrder="39" Text="협의자2" Top="554" VAlign="Middle" Width="143"></Static>
		<Edit Align="CENTER" BindDataset="ds_master" Border="Flat" BorderColor="user13" Column="CONSULTER1" DisableBKColor="user5" DisableColor="BACKGROUND" Height="24" Id="Edit1" Left="833" Readonly="TRUE" Style="sty_ipt_search" TabOrder="40" Top="579" Width="102"></Edit>
		<Static Align="Center" Height="24" Id="Static19" Left="792" Style="sty_lb_form_basic" TabOrder="41" Text="이름" Top="579" VAlign="Middle" Width="41"></Static>
		<Static Align="Center" Height="24" Id="Static20" Left="939" Style="sty_lb_form_basic" TabOrder="43" Text="이름" Top="579" VAlign="Middle" Width="41"></Static>
		<Edit Align="CENTER" BindDataset="ds_master" Border="Flat" BorderColor="user13" Column="CONSULTER2" DisableBKColor="user5" DisableColor="BACKGROUND" Height="24" Id="Edit0" Left="980" Readonly="TRUE" Style="sty_ipt_search" TabOrder="42" Top="579" Width="102"></Edit>
		<Image Height="61" Id="Image0" Left="977" TabOrder="44" Top="204" Width="61"></Image>
		<Image Border="Flat" FillType="STRETCH" Height="76" Id="img_01" Left="792" Style="sty_ipt_form" TabOrder="45" Top="602" Width="143"></Image>
		<Image Border="Flat" FillType="STRETCH" Height="76" Id="img_02" Left="939" Style="sty_ipt_form" TabOrder="46" Top="602" Width="143"></Image>
		<Static Font="Default,8" Height="12" Id="Static21" Left="793" TabOrder="48" Text="*&#32;여러파일&#32;등록은&#32;한&#32;파일씩&#32;업로드&#32;가능합니다." Top="244" Width="482"></Static>
		<Radio BindDataset="ds_master" BKColor="user5" Border="None" Column="GBN_ELES" DisableBKColor="user5" Height="18" Id="rd_eles" INDEX="-1" Left="989" Style="sty_ipt_form_radio" TabOrder="49" Top="87" Width="82">
			<Contents>
				<Layout code="EL" height="20" left="0" text="EL" top="0" width="40"/>
				<Layout code="ES" height="20" left="45" text="ES" top="0" width="40"/>
			</Contents>
		</Radio>
		<Static Align="Center" Height="24" Id="Static22" Left="923" Style="sty_lb_form_basic" TabOrder="50" Text="EL/ES" Top="84" VAlign="Middle" Width="62"></Static>
		<Grid AutoEnter="TRUE" AutoFitEndLine="Hide" AutoScrollBar="AlwaysVert" BindDataset="ds_save" BkColor2="default" BoldHead="true" Border="Flat" Bottom="1034" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="162" Id="grd_save" InputPanel="FALSE" Left="912" LineColor="user20" LineType="ExHORZ" OnCellDBLClick="grd_list_OnCellDblClick" OnHeadClick="grd_list_OnHeadClick" Right="1096" RowHeight="20" Style="sty_grid" TabOrder="51" TabStop="true" Top="872" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="FALSE" VLineColor="default" WheelScrollRow="1" Width="184">
			<contents>
				<format id="Default">
					<columns>
						<col width="83"/>
					</columns>
					<head>
						<cell col="0" display="text" text="프로젝트"/>
					</head>
					<body>
						<cell align="left" bkcolor2="user22" col="0" colid="PSPID" display="text"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Static Align="Center" Height="24" Id="Static23" Left="704" Style="sty_lb_form_basic" TabOrder="52" Text="현장개설안됨(NO)" Top="218" VAlign="Middle" Width="120"></Static>
		<Checkbox BindDataset="ds_head" Color="user7" Column="SOPTP_REVERSE" DisableBKColor="user5" FalseValue="0" Height="23" Id="cb_ck1" Left="832" TabOrder="53" Text="현장개설이&#32;안되있을시&#32;Check" Top="218" TrueValue="1" Value="FALSE" Width="193"></Checkbox>
		<Static Align="Center" BKColor="lightgreen" Height="24" Id="Static24" Left="456" Style="sty_lb_form_basic" TabOrder="54" Text="건축협조사항안내" Top="263" VAlign="Middle" Width="120"></Static>
		<Radio BindDataset="ds_head" BKColor="user5" Border="None" Column="GUIDE_YN" DisableBKColor="user5" Height="18" Id="rd_direction" INDEX="-1" Left="589" Style="sty_ipt_form_radio" TabOrder="55" Top="266" Width="114">
			<Contents>
				<Layout code="N" height="20" left="0" text="미안내" top="0" width="60"/>
				<Layout code="Y" height="20" left="65" text="안내" top="0" width="60"/>
			</Contents>
		</Radio>
		<Calendar BindDataset="ds_head" Border="Flat" BorderColor="user13" ClickedBkColor="user32" ClickedTextColor="user33" Column="GUIDE_DT" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySpacingHeight="6" DisableBKColor="user12" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="24" Id="Calendar0" Left="712" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_search" SundayTextColor="user35" TabOrder="56" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="263" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="100"></Calendar>
		<Static Font="Default,8" Height="24" Id="Static25" Left="817" TabOrder="57" Text="건축협조사항을&#32;직접&#32;안내하지&#32;못하는&#32;상황은&#13;&#10;우측&#32;버튼을&#32;클릭하여&#32;문자를&#32;보내시기&#32;바랍니다." Top="268" Width="245"></Static>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_archi" ImageID="btn_sub_02" Left="1066" LeftMargin="12" OnClick="btn_archi_OnClick" Style="sty_btn" TabOrder="58" TabStop="FALSE" Text="건축" Top="268" Transparent="TRUE" Width="47"></Button>
		<Static Align="Center" Height="24" Id="stc_inter" Left="944" Style="sty_lb_form_basic" TabOrder="59" Text="Interface" Top="186" VAlign="Middle" Width="95"></Static>
		<Checkbox BindDataset="ds_head" Color="user7" Column="CNFM_YN" DisableBKColor="user5" FalseValue="0" Height="23" Id="chk_inter" Left="1048" TabOrder="60" Top="186" TrueValue="1" Value="FALSE" Width="20"></Checkbox>
	</Form>
	<Script><![CDATA[﻿﻿﻿﻿﻿﻿/*
 ******************************************************************************************
 * 기      능   : 
 * 작  성  자   :  송광용
 * 작성  일자   : 2018-09-03
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
#include "LIB::commons.js";	// 공통 스크립트 
//=========================================================================================
// [ PART 1 ]
// Form에서 사용될 전역변수를 선언
// FORM에서 사용되는 전역변수는 대문자로 작성하며, F_XXX 의 형태를 갖도록 한다. 
//=========================================================================================
var userGroup = "";
var lv_msg = "";
var _F_FILE_DIR = "";	// 로컬에서 현재 선택한 파일 디렉토리 
var _F_FILE_NAME = "";	// 로컬에서 현재 선택한 파일  명 
var _F_FILE_SIZE = 0;	// 파일 사이즈 
var _F_FILE_DELETE = false;
var F_SIZE = 1024 * 10096;	// 4096K
var fv_interface = false;
//=========================================================================================
// [ PART 2 ]
// Form Loading / Unloading 시 작업 정의
//=========================================================================================
function fn_OnLoadCompleted(obj) {
	// Form 로드 이벤트 맨 첫줄에 기술 
	gfn_initForm();	
	gfn_initDs(ds_cond, true);	
	
	ds_cond.SetColumn(0,"PSPID", PRE_PJT);
	ds_cond.SetColumn(0,"GBN", PRE_GBN) ;   
	if(PRE_GBN == "C"){
		ds_cond.SetColumn(0,"SEQNO", gfn_fillZero(PRE_SEQ, 3)) ;   
     }
	
	if(Length(Trim(ds_cond.GetColumn(0, "PSPID"))) < 6)
	{
		gfn_openMsgWin("프로젝트 번호를 확인하세요.");
		close();
	}
	
	// Interface 기능은 설치부 신성철, 이주엽 담당자만 보이도록 권한설정. 2021-04-07 신성철 직장 요청.
	if(G_USER_ID == '3018598' || G_USER_ID == '2019191')
	{
		stc_inter.Visible = true;
		chk_inter.Visible = true;
	}
	else
	{
		stc_inter.Visible = false;
		chk_inter.Visible = false;
	}
	
    fn_query();
          	
}
/********************************************************************************
* 기      능   : 컴포넌트들의 활성화 여부
********************************************************************************/	
function ufn_enable(chk)
{
	
}	
    
    
    
/********************************************************************************
* 기      능   : 공통코드가 조회된 후의 Callback 함수 
********************************************************************************/
function fn_completeInit(sCode, sDsObj, sCodeType) {
	
}

/********************************************************************************
* 기      능   : form UnloadCompleted 
********************************************************************************/
function fn_OnUnloadCompleted(obj) {
	return gfn_isFormUnload(obj);
}    
/********************************************************************************
* 기      능   : 조회 
********************************************************************************/
function fn_query() {	
    tit_clearActionInfo();		
    
    if(PRE_GBN == "N"){ 
		tit_addSearchActionInfo("ps02:PS0201001F_S1");
	} //신규입력시
	else{
		tit_addSearchActionInfo("ps02:PS0201001F_S2");
	} //수정시
	
	
	tit_addSearchActionInfo("ps02:PS0201001B_S11");	// 프로젝트 정보
	tit_addSearchActionInfo("ps02:PS0201001G_S1");	// 첨부파일 정보

	tit_callService(
	 ""
	, ""
	, "ds_cond=ds_cond"
	, "ds_master=ds_master ds_head=ds_head ds_file=ds_file"
	, ""
	, "fn_afterQuery"
	, ""
	, ""
	, true);	                               
   
	
}   

/********************************************************************************
* 기      능   : 조회 Callback  
********************************************************************************/
function fn_afterQuery(errCode, errMsg) {
	gfn_showMsg("CI00001");
	
	//답사자 본인만 수정 가능

	if(PRE_GBN <> 'N' && ds_master.GetColumn(0, "CID") <> G_USER_ID)
	{
		div_btn.btn_save.Enable = false;
		btn_fileAdd.Enable = false;
		btn_fileDel.Enable = false;
	}
	
	
	//층수데이터 가져와서 신규입력시에는 0 안보이게 처리.
	var nFrameAfq = ds_master.GetColumn(0, "FRAME_AFQ");
	var sAfqIndc  = ds_master.GetColumn(0, "AFQ_INDC");
	
	// ds_master에 층수 데이터 변경하기
	if(PRE_GBN == "N")	// 신규입력
	{
		ds_master.SetColumn(0, "FRAME_AFQ", '');
	}
	else	// 수정
	{
		if(nFrameAfq == 0 && sAfqIndc == '')	// 층수데이터가 0이고, 층수 데이터 변경을 하지 않았다면
		{
			ds_master.SetColumn(0, "FRAME_AFQ", '');
		}
	}
	
	//# 특기사항 + (G2미통과이고, Interface 안된 호기이면 = 'X') EN_INTER = 'X'인 경우 - 삭제
	
	
	tit_clearActionInfo();
	tit_callService(
          "PS0101001A_ACT"
        , "query"
        , "ds_cond=ds_cond"
        , "ds_list1=ds_list"
        , ""
        , "fn_afterQuery1"
        , false);
    
    
    
	//# 이미지 가져오기
	ufn_getConsultImage();
	
    
}

/********************************************************************************
* 기      능   : 조회 Callback  
********************************************************************************/
function fn_afterQuery1(errCode, errMsg) 
{
	//gfn_showSearchMsg(Tab00.tab1.grd_list1, errCode, errMsg);
}

/********************************************************************************
* 기      능   : 공통코드가 조회된 후의 Callback 함수 
********************************************************************************/
function fn_completeInit(sCode, sDsObj, sCodeType) 
{ 
  /*
	if(userGroup == "40")
	{
		//cb_zzactss.Index = 0;
		//cb_zzactss.Enable = true;
	}
	else if(userGroup == "30")
	{
		//ds_zzactss.Filter("CODE="+quote(G_AREA_CODE_E));
		//cb_zzactss.Index = 0;
		//cb_zzactss.Enable = false;
	}
	else if(userGroup == "10")
	{
		//cb_zzactss.Index = 0;
		//cb_zzactss.Enable = false;
	}*/
}


/********************************************************************************
* 기      능   : form UnloadCompleted 
********************************************************************************/
function fn_OnUnloadCompleted(obj) {
	return gfn_isFormUnload(obj);
}
//=========================================================================================
// [ PART 3 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,form닫기)
//=========================================================================================

/********************************************************************************
* 기      능   : 닫기  
********************************************************************************/
function fn_close() {
	parent.fn_query(); 
	close();
}
/********************************************************************************
* 기      능   : 그리드 헤더 클릭시 정렬 처리 
********************************************************************************/
function grd_list_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
{	
	if ( nCell == 0 ) {
		// 현재 처리할 format 기억
		gfn_selectAllGrid(obj,nCell,nCell,true);
	}
}
/********************************************************************************
* 기      능   : 액셀  
********************************************************************************/
function fn_excel() {
	//gfn_saveToExcel(grd_list, true );
}
/********************************************************************************
* 기      능   : 저장
********************************************************************************/
function fn_save() 
{
   // 필수입력 - EL/ES
   if(Length(rd_eles.Value) == 0)
   {
		gfn_openMsgWin("EL/ES 여부를 선택하세요.");
		return;
   }
   
   // 필수입력 - 골조예상완료일(FRAME_DATE)
   if(cal_fdate.Value == '' or cal_fdate.Value = '0000000'){
		gfn_openMsgWin("골조예상완료일을 입력하세요.");
		return;
   }
   
   // 필수입력 - 자재반입예상일(MATNR_DATE)
   if(cal_mdate.Value == '' or cal_mdate.Value = '0000000'){
		gfn_openMsgWin("자재반입예상일을 입력하세요.");
		return;
   }
   
   // 필수입력 - 건축협조사항 안내/미안내 필수체크
   if(Length(rd_direction.Value) == 0){
		gfn_openMsgWin("건축협조사항안내를 선택하세요.");
		return;
   }
   
   
   if(cal_fdate.Value == '' or cal_fdate.Value = '0000000'){
       lv_msg = '현장답사(' + ed_fafq.Text + '층/' + ed_afq.Text + '층) 골조예상완료: 미입력';
   }
   else{ 
      lv_msg = '현장답사(' + ed_fafq.Text + '층/' + ed_afq.Text + '층) 골조예상완료:' + substr(cal_fdate.Value,0,4) +'-'+ substr(cal_fdate.Value,4,2) +'-' + substr(cal_fdate.Value,6,2);
   } 
   
   //층수데이터 가져와서 신규입력시에는 0 안보이게 처리.
	var nFrameAfq = ds_master.GetColumn(0, "FRAME_AFQ");
	var sAfqIndc  = ds_master.GetColumn(0, "AFQ_INDC");
	
	// ds_master에 층수 데이터 변경하기
	if(PRE_GBN == "N")	// 신규입력
	{
		if(nFrameAfq == '')
		{
			ds_master.SetColumn(0, "FRAME_AFQ", 0);
			ds_master.SetColumn(0, "AFQ_INDC", '');
		}
		else
		{
			ds_master.SetColumn(0, "AFQ_INDC", 'X');
		}
		
	}
	else	// 수정
	{
		if(nFrameAfq == '' && sAfqIndc == '')	// 층수데이터가 0이고, 층수 데이터 변경을 하지 않았다면
		{
			ds_master.SetColumn(0, "FRAME_AFQ", 0);
		}
		else
		{
			if(nFrameAfq == '')
			{
				gfn_openMsgWin("현재층수를 입력하세요.");
				return;
			}
			ds_master.SetColumn(0, "AFQ_INDC", 'X');
		}
	}
	
    ds_master.SetColumn(0,"BIGO", lv_msg);
    
    // # 2020-04-09 신성철 직장 요청(계획확정체계 PROJECT 진행 시)
    // # 자재반입 예상일이 금일자 기준 42일 이후인 경우 -> 자재반입예상일로 A~F Block(착공계획)일자를 세팅
    //                금일자 기준 42일 이내인 경우, Today()기준 42일 뒤로 출하예정일 설정.
    // # 출하예정일자 - 설치부, 제조본부 일자만 UPDATE(최소한의 일자만 입력해주는 용도), INTERFACE(PRPS-ZZINTER) = 'X'는 찍지 않음.
	
	var sOrgMatnrDt = ds_master.GetOrgColumn(0, "MATNR_DATE"); // 자재반입예상일
	var sNewMatnrDt = ds_master.GetColumn(0, "MATNR_DATE"); // 자재반입예상일
	
	var sElesIndc = ds_master.GetColumn(0, "GBN_ELES"); // EL/ES
	var sCnfmYn   = ds_head.GetColumn(0, "CNFM_YN");
	//Trace(sOrgMatnrDt);
	//Trace(sNewMatnrDt);
	
	// 자재반입예상일을 변경 + EL 체크 + 현장확인완료 미체크된 경우 인터페이스 처리 가능.
	if(sElesIndc == 'EL' && sOrgMatnrDt != sNewMatnrDt && sCnfmYn != '1')
	{
		fv_interface = true;
	}
	else
	{
		fv_interface = false;
	}
	

	//Trace(ds_head.saveXML());
    
	tit_clearActionInfo();		
	tit_addSelectExActionInfo("ps02:PS0201001F_S3", "ps02:PS0201001F_I1", "ps02:PS0201001F_U1");	// ZPST0019에만 이력을 남김
	tit_addSelectExActionInfo("ps02:PS0201001F_S5", "ps02:PS0201001F_I3", "ps02:PS0201001F_U4");	// ZPSTPM07 INSERT OR UPDATE.
	//tit_addSelectExActionInfo("ps02:PS0201001F_S4", "ps02:PS0201001F_I2", "ps02:PS0201001F_U2"); ZPSTPM01 테이블에는 이력을 남기지 않음.
	
	tit_callService(
		""
		, ""
		, "ds_master=ds_master ds_head=ds_head"
		, ""
		, ""
		, "fn_SaveFile"
		, ""
		, ""
		, true  // ""
		
		);
		
		
	
}
/********************************************************************************
* 기      능   : 저장 Callback  
********************************************************************************/
function fn_SaveFile(errCode, errMsg) {
	if ( errCode!= 0 ) {
		gfn_showMsg("CE00001");
	} else {
		gfn_showMsg("CI00003");
		
		if(ds_cond.GetColumn(0, "GBN") != 'C')
		{
			ds_cond.SetColumn(0, "SEQNO", ds_master.GetColumn(0, "SEQNO"));
			ds_cond.SetColumn(0, "GBN", 'C');
			
			PRE_GBN = 'C';
		}
		
		if(ds_master.GetColumn(0, "AFQ_INDC") == '' && ds_master.GetColumn(0, "FRAME_AFQ") == 0)	
		{
			ds_master.SetColumn(0, "FRAME_AFQ", "");
		}
		
		
		if(fv_interface == true)
		{
			tit_clearActionInfo();		
			tit_addSearchActionInfo("ps02:PS0201001G_S2");	// 인터페이스 여부 확인 및 G2 통과여부 확인. (G2미통과, 인터페이스가 안되었을 때 CALLBACK 타게됨)
		
			tit_callService(
			 ""
			, ""
			, "ds_master=ds_master"
			, "ds_save=ds_save"
			, ""
			, "fn_afterInter"
			, ""
			, ""
			, true);
		}
		else
		{
			fn_customerReqDateChk();
		}
		
	}
}

function fn_afterInter(errCode, errMsg)
{
	if ( errCode!= 0 ) {
		gfn_showMsg("CE00001");
	}
	else
	{
		var sMatnrDt      = ds_master.GetColumn(0, "MATNR_DATE");
		var sCurrentDt_42 = ds_save.GetColumn(0, "CURR_DATE");	// 금일자 + 42일(W6)
		var sSaveDt = "";
		
		//Trace(sMatnrDt);
		//Trace(sCurrentDt_42);
		if(sMatnrDt > sCurrentDt_42) // 42일 이후 입력 시에는 해당 일정 그대로 입력
		{
			sSaveDt = sMatnrDt;
		}
		else	// 42일 이내일 경우에는 금일 기준 42일 뒤로 출하예정일 설정
		{
			sSaveDt = sCurrentDt_42;
		}
		//Trace(sSaveDt);
		for(var i=0;i<ds_save.GetRowCount();i++)
		{
			ds_save.SetColumn(i, "ZZSHIP1", sSaveDt);
			ds_save.SetColumn(i, "ZZSHIP2", sSaveDt);
			ds_save.SetColumn(i, "ZZSHIP3", sSaveDt);
			ds_save.SetColumn(i, "ZZSHIP4", sSaveDt);
			ds_save.SetColumn(i, "ZZSHIP5", sSaveDt);
			ds_save.SetColumn(i, "ZZSHIP6", sSaveDt);
			ds_save.SetColumn(i, "FLAG", "1");
			
		}
		
		//Trace(ds_save.saveXML());
		// RFC Function으로 저장 (착공계획일자 세팅로직)
		// 저장 처리
		tit_callService(
			"PS0201001A_ACT"
			, "save_g"
			, "ds_save=ds_save:A"
			, "ds_error=ds_error"
			, ""
			, "fn_afterSaveQ");
        
		
	}
	
}

function fn_afterSaveQ(errCode, errMsg)
{
	//Trace(ds_error.saveXML());
	//Trace(ds_save.saveXML());
	if(ds_error.GetRowCount() > 0)
	{
		gfn_showWSSaveMsgForQM("grd_save", ds_error, "FLAG", errCode, errMsg);
	}	
	else
	{
		fn_customerReqDateChk();
		//gfn_openMsgWin("저장되었습니다.");
	}
	
}




function fn_customerReqDateChk() {

	tit_clearActionInfo();		
	tit_addSearchActionInfo("ps02:PS0201001G_S5");	// 자재반입 예상일과 착공예정일  비교하여  자재반입 예상일이 나중이거나 월이 다른 경우 메일 발송

	tit_callService(
	 ""
	, ""
	, "ds_master=ds_master"
	, "ds_check=ds_check"
	, ""
	, "fn_afterCustomerReqDateChk"
	, ""
	, ""
	, true);
}


function fn_afterCustomerReqDateChk(errCode, errMsg)
{		
	if(ds_check.rowcount !=0 && ds_check.GetColumn(0, "CNT") == "1")
	{
		var varMATNR_DATE = ds_check.GetColumn(0, "MATNR_DATE");
		var varSTADA = ds_check.GetColumn(0, "STADA");	
		
		if( (varMATNR_DATE > varSTADA) &&  (substr(varMATNR_DATE, 0, 6) != substr(varSTADA, 0, 6))  )		
		{				
			fn_mail();		
		}
		else
		{
			gfn_openMsgWin("저장되었습니다.");
		}
	}
	else
	{
		gfn_openMsgWin("저장되었습니다.");
	}
}



function fn_mail()
{
	//alert(gfn_formatDate(ds_check.GetColumn(0, "STADA")));
	tit_clearActionInfo();	
	
	var varUser = "admin@hyundaielevator.com";
	var varUserNm = "(현대E/L) ADMIN";
	
	var varMesgtitl = "고객요청일 및 착공일 재확인 요청의 건";
	
	var varContent = "";
	varContent += "고객요청일 대비 설치착공일이 지연되는 현장을 공유합니다.\n";
	varContent += "영업, 설치팀에서는 현장 재검토 바랍니다.\n\n";
	varContent += "* 공사번호 : "+ds_check.GetColumn(0, "ZZPJT_ID") +" \n";
	varContent += "* 현장명 : "+ds_check.GetColumn(0, "ZSITE_NM") +" \n";
	varContent += "* 고객요청일 : "+gfn_formatDate(ds_check.GetColumn(0, "STADA")) +" \n";
	varContent += "* 착공일 : "+gfn_formatDate(ds_check.GetColumn(0, "MATNR_DATE")) +" \n";
	varContent += "* 영업담당 : "+ds_check.GetColumn(0, "ZMAN_NM") +" \n";
	varContent += "* 설치PM : "+ds_check.GetColumn(0, "NAMET") +" \n";
	
	var varPerno = "";
	var varPernoNm = "";
	if(ds_check.rowcount != 0 && ds_check.GetColumn(0, "GUBUN") == "NI") 
	{
		varPerno = "piljeong.kim@hyundaielevator.com"; // 영업(NI 김필정 )
		varPernoNm = "김필정";
	}
	else
	{
		varPerno = "daeseung.park@hyundaielevator.com"; //	영업(리모델링 박대승)
		varPernoNm = "박대승";
	}
	
	
	var mailRecv = ds_check.GetColumn(0, "MAILRECV");
	var mailRecvNm = ds_check.GetColumn(0, "MAILRECVNM");
	
	
	ds_trans.AddRow();
	ds_trans.SetColumn(0,"USER", varUser);
	ds_trans.SetColumn(0,"PERNO", varPerno);
	ds_trans.SetColumn(0,"MESGTITL", varMesgtitl);
	ds_trans.SetColumn(0,"MESGDESC", varContent);
	
	/*
	var varPerno2 = "";
	var varPernoNm2 = "";
	var varPerno3 = "";
	var varPernoNm3 = "";
	
	varPerno2 = "seongcheol.shin@hyundaielevator.com";  
	varPernoNm2 = "신성철";
	
	varPerno3 = "juyoub.lee@hyundaielevator.com";  
	varPernoNm3 = "이주엽";
	*/
	var cc_user =  varPerno;
	var cc_user_nm = varPernoNm;
	var bcc_user = "";
	var bcc_user_nm = "";
	
	
trace(ds_trans.SaveXML());
trace(varContent);





	tit_callService(
			"COMM_ACT"
			, "sendmailNew"
			, ""
			, ""
			," SEND_USER=" + quote( varUser )			
				+ " RECV_USER=" + quote( mailRecv )				
				+ " CC_USER=" + quote(cc_user)
				+ " BCC_USER=" + quote(bcc_user)				
				+ " SEND_USER_NM=" + quote( varUserNm )				
				+ " RECV_USER_NM=" + quote( mailRecvNm )	
				+ " CC_USER_NM=" + quote(cc_user_nm)
				+ " BCC_USER_NM=" + quote(bcc_user_nm)
				+ " MESGTITL="  + quote( varMesgtitl )
				+ " MESGBODY="  + quote( varContent )
			, ""  //"fn_afterQuery"
			, false
			, true);	


/*
trace("varUser : " + quote( varUser ) );
trace("mailRecv : " + quote( mailRecv ) );			
trace("cc_user : " + quote( cc_user ) );			
trace("bcc_user : " + quote( bcc_user ) );			
trace("G_USER_NAME : " + quote( G_USER_NAME ) );			
trace("mailRecvNm : " + quote( mailRecvNm ) );			
trace("cc_user_nm : " + quote( cc_user_nm ) );	
trace("bcc_user_nm : " + quote( bcc_user_nm ) );			
trace("varMesgtitl : " + quote( varMesgtitl ) );	
trace("varContent : " + quote( varContent ) );	
*/





	
	/*
	tit_callService(
		"COMM_ACT"
		, "sendmail"
		, ""
		, ""
		//, "USER_JUMIN=" + quote(med_jumin1.value+med_jumin2.value)
		//	+ 
		," SEND_USER=" + quote( ds_trans.GetColumn(0,"USER") )
			+ " RECE_USER=" + quote( ds_trans.GetColumn(0,"PERNO") )
			+ " MESGTITL=" + quote( ds_trans.GetColumn(0,"MESGTITL") )
			+ " MESGBODY=" + quote( ds_trans.GetColumn(0,"MESGDESC") )
		, ""  //"fn_afterQuery"
		, false
		, true);	
		
	tit_callService(
		"COMM_ACT"
		, "sendmail"
		, ""
		, ""
		//, "USER_JUMIN=" + quote(med_jumin1.value+med_jumin2.value)
		//	+ 
		," SEND_USER=" + quote( ds_trans.GetColumn(0,"USER") )
			+ " RECE_USER=" + quote( varPerno2 )
			+ " MESGTITL=" + quote( ds_trans.GetColumn(0,"MESGTITL") )
			+ " MESGBODY=" + quote( ds_trans.GetColumn(0,"MESGDESC") )
		, ""  //"fn_afterQuery"
		, false
		, true);	
		
	tit_callService(
		"COMM_ACT"
		, "sendmail"
		, ""
		, ""
		//, "USER_JUMIN=" + quote(med_jumin1.value+med_jumin2.value)
		//	+ 
		," SEND_USER=" + quote( ds_trans.GetColumn(0,"USER") )
			+ " RECE_USER=" + quote( varPerno3 )
			+ " MESGTITL=" + quote( ds_trans.GetColumn(0,"MESGTITL") )
			+ " MESGBODY=" + quote( ds_trans.GetColumn(0,"MESGDESC") )
		, ""  //"fn_afterQuery"
		, false
		, true);	
	*/
	
	gfn_openMsgWin("저장되었습니다.");
}
/********************************************************************************
* 기      능   : 현장전화 수정 후 Callback 
********************************************************************************/
function fn_SaveTel(errCode, errMsg)
{
	if ( errCode!= 0 ) {
		gfn_showMsg("CE00001");
	} else {
		gfn_showMsg("CI00003");
		
		tit_clearActionInfo();		
		tit_addSearchActionInfo("ps02:PS0201001B_S11");	// 프로젝트 정보

	
		tit_callService(
		 ""
		, ""
		, "ds_cond=ds_cond"
		, "ds_head=ds_head"
		, ""
		, "fn_afterQuery2"
		, ""
		, ""
		, true);	      
	}
}

/********************************************************************************
* 기      능   : 현장전화 수정 후 재조회
********************************************************************************/
function fn_afterQuery2() {
	// 수정 되었습니다. 메시지 출력
	gfn_openMsgWin("수정되었습니다.");
}
/********************************************************************************
* 기      능   : 롱텍스트 읽기
********************************************************************************/
function ufn_getLongText(dsObj, tabObj, tabColName, tabId) {

	if ( length( tabObj) == 0 || length( tabColName) == 0 || length( tabId) == 0) {
		return "";
	}

	tit_callService(
        "COMM_ACT"
        , "getLongText2"
        , ""
        , ""
        , "TDID=" + quote(tabId) + " TDNAME=" 
				+ quote(tabColName) +" TDOBJECT=" + quote(tabObj)
        , ""
        , false
        , true
        , true);
    
    nRow = dsObj.addRow();    
    dsObj.setColumn(nRow, "TDOBJECT", tabObj);
    dsObj.setColumn(nRow, "TDNAME", tabColName);
    dsObj.setColumn(nRow, "TDID", tabId);
    
    //alert(_LONGTEXT);
    //ufn_replaceSpecialChar(_LONGTEXT);  //문자 변환
    
    dsObj.setColumn(nRow, "TEXT", _LONGTEXT);
    
	return _LONGTEXT;
	
}

/******************************************************
* 주어진 글자를 len 만큼 잘라서 배열로 return
* @param  str  주어진 글자
* @param  len  자리수
******************************************************/
function ufn_substrToArray(str, len) {
	var rtn = array();
	var temp = "";
	var tCnt = 0;
	var cnt = 0;
		
	
	//===============================================================
	//===============================================================
	var tmp_str;	
	
	var lt_cnt = 0;
	var lt_cnt2 = 0;
	var chk = "";
		
	str = replace(str,chr(13)+chr(10),"|");	

	for( var i = 0; i < length(str); i++ ) 
	{   	
		chk = "";
		if ( charAt( str, i) == "|" ) 
		{
			lt_cnt = 0;
			lt_cnt2++;
			chk = "X";
			tmp_str = "";			
		}
		else
		{
			if ( lengthb(charAt( str, i)) == 2 )
			{
				lt_cnt = lt_cnt + 2;
				tmp_str = charAt( str, i);
			}
			else
			{
				lt_cnt = lt_cnt + 1;
				tmp_str = charAt( str, i);
			}
		}
				
		temp += tmp_str;	
				
		if ( lt_cnt == len )
		{
			temp += "";	
			lt_cnt = 0;
			lt_cnt2++;
			chk = "X";
		}
			
		if ( chk == "X" )
		{			
			if ( length( temp ) > 0 ) 
			{
				rtn[lt_cnt2 - 1] = temp;			
				temp = "";
			}
			else
			{
				lt_cnt2 = lt_cnt2 - 1;					
			}			
		}
		else if ( length(str) == i + 1 )
		{
			rtn[lt_cnt2] = temp;
			temp = "";
		}
	}
	return rtn;	
	
}



/********************************************************************************
* 기      능   : 이미지 뷰어 팝업 로드
********************************************************************************/
function btn_imageViewer_OnClick(obj)
{
	if(ds_cond.getColumn(0, "GBN") == "N")
	{
		gfn_openMsgWin("저장 후, 첨부파일을 등록해 주세요.","","A");
		return;
	}
	
	var formID="";

	formID = "PS0201001H";  
	//break;
	var sCdate   = ds_master.GetColumn(0, "CDATE");
	var sGbn     = ds_master.GetColumn(0, "GBN");
	var sCname   = ds_master.GetColumn(0, "CNAME");
	var sCid     = ds_master.GetColumn(0, "CID");
	var sCnt     = ds_file.rowcount;
	var sConsult = ds_master.GetColumn(0, "CONSULT");
	var sPspid   = ds_master.GetColumn(0, "PSPID");
	var sSeqNo   = ds_master.GetColumn(0, "SEQNO");
	

	var arg = "PRE_CDATE="+quote(sCdate);
	    arg += " PRE_CID="+quote(sCid);
	    arg += " PRE_GBN="+quote(sGbn);
		arg += " PRE_CNAME="+quote(sCname);
		arg += " PRE_FCNT="+quote(sCnt);
		arg += " PRE_CONSULT="+quote(sConsult);
		arg += " PRE_PSPID="+quote(sPspid);
		arg += " PRE_SEQNO="+quote(sSeqNo);
		arg += " GBN="+quote(PRE_GBN);
		

	
	gfn_openPopup(formID, true, arg);
}

/********************************************************************************
* 기      능   : 파일 추가
********************************************************************************/
function btn_fileAdd_OnClick(obj)
{
	if(ds_cond.getColumn(0, "GBN") == "N")
	{
		gfn_openMsgWin("저장 후, 첨부파일을 등록해 주세요.","","A");
		return;
	}
	
	var fileName = "";
	
	if(ds_file.rowcount >= 30)
	{
		gfn_openMsgWin("추가할 수 있는 파일 개수를 초과했습니다.\n (최대 30개 저장가능)","","A");
		return;
	}
	
	var sRtn = fileDialog.open();
	
	if(sRtn == 0) return;
	
	if ( length(fileDialog.FilePath) == 0 
		|| length(fileDialog.FileName ) == 0 ) {
		return;
	}

	var fileSize = f_tmp.GetLength(fileDialog.FilePath + "\\" + fileDialog.FileName );
	if ( fileSize <= 0 ) {
		gfn_showAlert("CW00048");
		return;
	}

	if ( fileSize > toNumber(F_SIZE)) {
		gfn_showAlert("CW00047", "10 Mbytes" );	
		return;
	}

	/*
	//한글제목 입력금지(한글제목깨짐)
	for( var i = 0; i < length( fileDialog.FileName); i++ ) {
		if ( lengthb(charAt( fileDialog.FileName, i)) == 2 ) {
			gfn_showMsg("CW00213");
			return;
		}
	}
	*/

	
	
	// 파일정보
	if(length(fileDialog.FileName) > 0 )
	{
		var thumbext = fileDialog.FileName; //파일을 추가한 input 값
		thumbext = substr(thumbext, ufn_lastIndexOf(thumbext)); //확정자값 가져오기 
		thumbext = ToLower(thumbext); //소문자로 변경
	 
	
	    if(thumbext != "jpg" && thumbext != "jpeg" && thumbext != "png" &&  thumbext != "gif" &&  thumbext != "bmp"  && thumbext != "pdf")
	    { // 확장자를 확인
			global.FRM_BOTTOM.img_msgType.imageId = "bottom_icon_caution";
		    global.FRM_BOTTOM.st_msg.color = "yellow";       
			global.FRM_BOTTOM.st_msg.value = "이미지 파일(jpg, jpeg, png, gif, bmp, pdf)만 등록 가능합니다.";
			return false;
		}
	  
		if(ds_file.rowcount < 30)
		{
			ds_temp.ClearData();
			ds_temp.addRow();
			ds_temp.setColumn(0, "PSPID", ds_master.getColumn(0, "PSPID"));
			ds_temp.setColumn(0, "SEQNO", ds_master.GetColumn(0, "SEQNO"));

			ds_temp.setColumn(0, "FNAME", fileDialog.FileName);
			ds_temp.setColumn(0, "FSIZE", fileSize);
			ds_temp.setColumn(0, "FPATH", fileDialog.FilePath);
			
			//fileDialog.GetFileList(ds_f);
			//trace(ds_f.saveXML());
			if(length(ds_temp.getColumn(0, "FNAME")) != 0 && length(ds_temp.getColumn(0, "FPATH")) != 0)
			{
				//fileName = left(GetDate(),8)+"_"+right(GetDate(),6)+"_"+ds_list_i.getColumn(i, "HNO")+ds_list_i.getColumn(i, "CHASU")+"."+gfn_getFileExt(ds_list_i.getColumn(i, "FNAME"));
				fileName = left(GetDate(),8) +"_"+ right(GetDate(),6) +"_"+ ds_temp.getColumn(0, "SEQNO") +"_"+ G_USER_ID + "_" + ds_temp.getColumn(0, "PSPID") +"."+gfn_getFileExt(ds_temp.getColumn(0, "FNAME"));
				var arr = tit_fileWrite(httpFile
					, "PS"
					, ds_temp.getColumn(0, "FPATH")
					, ds_temp.getColumn(0, "FNAME")
					, fileName// 실제 db에 저장될 파일 이름
					, "U"	  // time stamp를 붙이지 않을 경우 U 사용 
					, ds_temp.GetColumn(0,"DEL_FNAME"));    // ds_list_i.getColumn(i, "DEL_FNAME") );//삭제할 이전 파일명 
				if ( arr[0] == "S" ) {
					ds_temp.setColumn(0, "FNAME_APP", fileName);
				}
				else if ( arr[0] != "S" )
				{
					gfn_showMsg("CW00035"); 
					return;
				}
				
				// 파일 추가 저장
				tit_clearActionInfo();	
				tit_addSingleActionInfo("ps02:PS0201001G_I1");
				tit_callService(
					""
					, ""        
					, "ds_temp=ds_temp"
					, ""
					, ""
					, "fn_afterFileAdd"
					, ""
					, ""
					,true  // ""
					);
			}

		}
		else
		{
			gfn_showMsg("추가할 수 있는 파일 개수를 초과했습니다. (최대 30개 저장가능)");
			return;
		}
	
	  //ds_list.setColumn(i, "GBN", cb_gbn.Value);
	}

}

/********************************************************************************
* 기      능   : 파일 삭제
********************************************************************************/
function btn_fileDel_OnClick(obj)
{
	if(ds_cond.getColumn(0, "GBN") == "N")
	{
		gfn_openMsgWin("저장 후, 첨부파일을 등록해 주세요.","","A");
		return;
	}
	
	if(ds_file.rowcount == 0) return;
	
	var nChkRow = ds_file.SearchRow("CHK == '1'");
	
	if(nChkRow < 0) return;
	
	for(var i=0; i<ds_file.rowcount; i++)
	{
		var sFileName = ds_file.GetColumn(i, "FNAME");
		var sChk      = ds_file.GetColumn(i, "CHK");
		
		if(length(sFileName) != 0 && sChk == "1")
		{
			var arr = tit_fileDelete("PS",ds_file.getColumn(i, "FNAME_APP"), false);
		}
	}
	
	// 체크된 파일만 삭제처리
	ds_file.Filter("CHK==1");
	ds_file2.copyF(ds_file);
	ds_file.unFilter();

	// 파일 삭제 저장
	tit_clearActionInfo();	
	tit_addMultiActionInfo("ps02:PS0201001G_D1");
	tit_callService(
		""
		, ""        
		, "ds_file=ds_file2"
		, ""
		, ""
		, "fn_afterFileAdd"
		, ""
		, ""
		,true  // ""
		);
		
}

/********************************************************************************
* 기      능   : 파일 저장 후, Callback
********************************************************************************/
function fn_afterFileAdd()
{
	// 저장 후, 파일리스트 재조회
	tit_clearActionInfo();		
	tit_addSearchActionInfo("ps02:PS0201001G_S1");	// 첨부파일 정보
	
	tit_callService(
	 ""
	, ""
	, "ds_cond=ds_cond"
	, "ds_file=ds_file"
	, ""
	, "fn_afterQuery"
	, ""
	, ""
	, true);
}

/********************************************************************************
* 기      능   : 첨부파일 더블 클릭 시 파일오픈
********************************************************************************/
function grd_list_OnCellDblClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
	if(nCell != 0) 
	{
		if( length(ds_file.getColumn(nRow, "FNAME")) > 0) {
		   // 첨부 파일 처리 
		   fn_createWait("", this);
		
			var FilePath = "c:\\Temp" ;		
			var FileExec = "c:\\Temp\\" + ds_file.getColumn(nRow, "FNAME");
	
			saveDialog.FileName = ds_file.getColumn(nRow, "FNAME");
			
			var rMsg = tit_fileRead(
										httpFile
										, "PS"  	  // 저장 디렉토리
										, ds_file.getColumn(nRow, "FNAME_APP")	// 서버에서 전송받을 이름
										, FilePath    // 로컬 경로
										, ds_file.getColumn(nRow, "FNAME")    // 로컬 파일명
									   );
	
				fn_destroyWait();
				if ( rMsg[0] == "E" ) {
					if ( length(trim(rMsg[1])) > 0 ) {
					  //  ExecShell(FileExec);
						gfn_showAlert("CW10025", rMsg[1]);
					} else {
	
						gfn_showAlert("CW10025", "파일 다운로드에 실패하였습니다.");
					}
				} else {	
					ExecShell(FileExec);		
				}	
					
					
			 }
	}
}

/********************************************************************************
* 기      능   : 서명 데이터 보여주기
********************************************************************************/
function ufn_getConsultImage()
{
	//wb_01.pageUrl = "about:blank";
	//wb_01.run();
					
	if(ds_master.rowcount == 0) return;
	
	var sServerDir      =  "SIGN";
	var sLocalFileName  =  ds_master.GetColumn(0, "FNAME1");
	var sLocalFileDir   =  ds_master.GetColumn(0, "FPATH1");
	var sServerFileName =  ds_master.GetColumn(0, "FNAME_APP1");
	
	if ( length( sServerFileName) > 0) {
	/*
		if ( length( sLocalFileName ) > 0 ) {
			if ( f_tmp.GetLength(sLocalFileDir + "\\" + sServerFileName) > 0 ) {
				// 로컬에 저장된 정보 다시 표시 
				_F_FILE_DIR  =  sLocalFileDir;
				_F_FILE_NAME = sServerFileName;
	
				if( ufn_isImage( sServerFileName )  ) {
					//trace(sLocalFileDir + "\\" + sServerFileName);
					tit_getServerDir(sServerDir, sServerFileName);
					img_01.ImageID = sLocalFileDir + "\\" + sLocalFileName;
					//wb_01.pageUrl = sLocalFileDir + "\\" + sLocalFileName;
					//wb_01.run();
				}	
			} else {
				gfn_showAlert("Not found :" + sLocalFileDir + "\\" + sLocalFileName );
				sLocalFileName = "";
				sServerFileName = "";
			}
		} else {
	*/
			if( ufn_isImage( sServerFileName )  ) {
				//trace(tit_getServerDir(sServerDir, sServerFileName));
				img_01.ImageID = tit_getServerDir(sServerDir, sServerFileName);
				
				//wb_01.pageUrl = tit_getServerDir(sServerDir, sServerFileName);
				//wb_01.run();
			}	
		}	
	//}
	
	//wb_02.pageUrl = "about:blank";
	//wb_02.run();
	
	var sLocalFileName2  =  ds_master.GetColumn(0, "FNAME2");
	var sLocalFileDir2   =  ds_master.GetColumn(0, "FPATH2");
	var sServerFileName2 =  ds_master.GetColumn(0, "FNAME_APP2");

	if ( length( sServerFileName2) > 0) {
	/*
		if ( length( sLocalFileName2 ) > 0 ) {
			if ( f_tmp.GetLength(sLocalFileDir2 + "\\" + sServerFileName2) > 0 ) {
				// 로컬에 저장된 정보 다시 표시 
				_F_FILE_DIR  =  sLocalFileDir2;
				_F_FILE_NAME =  sServerFileName2;
	
				if( ufn_isImage( sServerFileName2 )  ) {
					//trace(sLocalFileDir + "\\" + sServerFileName);
					//wb_02.pageUrl = sLocalFileDir2 + "\\" + sLocalFileName2;
					//wb_02.run();
					img_02.ImageID = sLocalFileDir2 + "\\" + sLocalFileName2;
				}	
			} else {
				gfn_showAlert("Not found :" + sLocalFileDir2 + "\\" + sLocalFileName2 );
				sLocalFileName2 = "";
				sServerFileName2 = "";
			}
		} else {
		*/
			if( ufn_isImage( sServerFileName2 )  ) {
				//trace(tit_getServerDir(sServerDir, sServerFileName));
				//wb_02.pageUrl = tit_getServerDir(sServerDir, sServerFileName2);
				//wb_02.run();
				img_02.ImageID = tit_getServerDir(sServerDir, sServerFileName2);
			}	
		}	
	//}
}

/********************************************************************************
* 기      능   : 이미지 파일일 경우 열어줌
********************************************************************************/
function ufn_isImage(fileNm) {
	var s = toUpperCase(right( fileNm, 4));
	if ( s == ".JPG" || s == ".GIF" || s == ".PNG" || s == ".BMP") {
		return true;
	} else if ( toUpperCase(right( fileNm, 5)) == ".JPEG") {
		return true;
	}
	
	return false;
}

/********************************************************************************
* 기      능   : 현장 전화 수정 버튼 클릭 시
********************************************************************************/
function Div0_btn_modify_OnClick(obj)
{
	//# 현장 전화번호 저장
	tit_clearActionInfo();		
	tit_addSelectExActionInfo("ps02:PS0201001F_S5", "ps02:PS0201001F_I3", "ps02:PS0201001F_U4");	// ZPSTPM07 INSERT OR UPDATE.
	tit_callService(
		""
		, ""
		, "ds_head=ds_head"
		, ""
		, ""
		, "fn_SaveTel"
		, ""
		, ""
		, true  // ""
		
		);
}

function ufn_lastIndexOf(sParmString)
{
	var j = 0;//.위치 
	var k = 0;// 결과위치 
	var k = 0;//.위치 -1 
	
	
	while(true) 
	{ 
		r = pos(sParmString,".",j);
		
		if (r == -1) 
		{ 
			break; 
		} 
		
		j=r+1; 
	
	} 
	k = j; 
	
	return k;
}

/*
// 자재반입 예상일 변경 시, working day 여부 확인.
function cal_mdate_CanChange(obj,strOldText,strText)
{
	var rtn = fn_chkWorkingDay(strText);

	return rtn;
}*/

// Working Day 확인 함수.
function fn_chkWorkingDay(day)
{
	if(Length(day) == 0)
	{
		return;
	}
	
	ds_cond_temp.ClearData();
	ds_cond_temp.AddRow();
	ds_cond_temp.SetColumn(0, "MATNR_DATE", day);
	
	tit_clearActionInfo();		
	tit_addSearchActionInfo("ps02:PS0201001G_S3");


	tit_callService(
	 ""
	, ""
	, "ds_cond=ds_cond_temp"
	, "ds_chkDay=ds_chkDay"
	, ""
	, ""
	, ""
	, ""
	, true);
	
	var sChkIndc   = ds_chkDay.GetColumn(0, "CHK_INDC");
	
	if(sChkIndc == 'N')
	{
		gfn_openMsgWin("해당 일자는 휴무일입니다.\n(공장 휴무일 또는 지정공휴일)","W");
		return false;
	}
	
	return true;
}

function cal_mdate_OnChanged(obj,strOldText,strNewText)
{
	// 1. Working Day (근무일) 확인.
	var rtn = fn_chkWorkingDay(strNewText);
	
	// 2. 자재반입예상일 < 현재일 인 경우 문제가 됨. - 2021-02-17 신성철직장 요청
	if(rtn == true)
	{
		if(strNewText < gfn_getCurrDate())
		{
			gfn_openMsgWin("자재반입예상일은 현재일 이후로 선택하세요.");
			rtn = false;
		}
		
	}
	
	// 날짜 초기화 세팅.
	if(rtn == false)
	{
		cal_mdate.Value = "";
	}
	else
	{
		// 출하 통제일 로직 확인하여 일자 변경
		//cal_mdate.Value = fn_zpst0149_day(strNewText);
	}
	
	return rtn;
}

//  출하 통제일 로직 확인하여 일자 변경 2021.02.09 생산관리팀 신경철 팀원 요청.
function fn_zpst0149_day(day)
{
	if(Length(day) == 0)
	{
		return;
	}
	
	ds_cond_day.ClearData();
	ds_cond_day.AddRow();
	ds_cond_day.SetColumn(0, "FROM_DT", day);
	ds_cond_day.SetColumn(0, "TO_DT", gfn_getAfterDate(day,30));
	
	tit_clearActionInfo();		
	tit_addSearchActionInfo("ps02:PS0201001G_S4");


	tit_callService(
	 ""
	, ""
	, "ds_cond=ds_cond_day"
	, "ds_nextDay=ds_nextDay"
	, ""
	, ""
	, ""
	, ""
	, true);
	
	var sNextDay   = ds_nextDay.GetColumn(0, "DT");

	if(sNextDay <> day && sNextDay <> '')
	{
		gfn_openMsgWin("출하 통제일에 의해 가장 가까운 가능일로 변경합니다. ","I");
		return sNextDay;
	}
	
	return day;
}

/********************************************************************************
* 기      능   : 건축 버튼 클릭 시 - 건축협조사항 팝업 
********************************************************************************/
function btn_archi_OnClick(obj)
{
	var formID="";
	var pjt = ds_cond.GetColumn(0, "PSPID");
	var sUrl = "PS0201001G"; // 신규 추가 건

	var sTel = ds_head.GetColumn(0, "ZSITE_TEL");
	var sSR  = ds_head.GetColumn(0, "SOPTP_REVERSE");

	
	
	if(Length(Trim(pjt)) < 6)
	{
		gfn_openMsgWin("조회조건에서 프로젝트 번호를 확인해주세요.");
		return;
	}
	
	var arg = "URL="+quote(sUrl);
		arg += " TEL="+quote(sTel);
		arg += " POSID="+quote(pjt);
		arg += " SOPTP_REVERSE="+quote(sSR);

	
	//SELFLG = "N";
	var rtn = gfn_openPopupUrl("PS15::PS1503001B.xml",true, arg); 

	if(rtn != null && rtn != 0)
	{
		ds_head.SetColumn(0, "GUIDE_YN", rtn[0]);
		ds_head.SetColumn(0, "GUIDE_DT", rtn[1]);
	}
	//Trace(ds_head.saveXML());
	
}

function ds_head_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{
	if(strColumnID == 'GUIDE_YN')
	{
		if(ds_head.GetOrgColumn(nRow, "GUIDE_YN") <> varNewValue)
		{
			if(varNewValue == 'Y') // 안내
			{
				// 날짜 세팅
				ds_head.SetColumn(nRow, "GUIDE_DT", gfn_getCurrDate());
				Calendar0.Enable = true;
			}
			else	// 미안내 
			{
				// 날짜 Clear
				ds_head.SetColumn(nRow, "GUIDE_DT", "");
				Calendar0.Enable = false;
				
			}
		}
		else
		{
			if(varNewValue == 'Y') // 안내
			{
				Calendar0.Enable = true;
			}
			else	// 미안내 
			{
				Calendar0.Enable = false;
				
			}
		}
	}
}


]]></Script>
</Window>