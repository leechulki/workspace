<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="562" Id="PS209001A" Left="8" OnLoadCompleted="fn_OnLoadCompleted" OnSize="PS0209001A_OnSize" OnUnloadCompleted="fn_OnUnloadCompleted" PidAttrib="7" Title="작업일보&#32;공정&#32;진행&#32;현황&#32;(현장이미지)" Top="8" Ver="1.0" Width="976" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_cond_for_file">
				<Contents>
					<colinfo id="SEQNO" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond" OnColumnChanged="ds_cond_OnColumnChanged">
				<Contents>
					<colinfo id="PSPID" size="255" summ="default" type="STRING"/>
					<colinfo id="ZZLIFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZLIFNR_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="INP_DTF" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZACTSS" size="256" summ="default" type="STRING"/>
					<colinfo id="CURR_DATE" size="256" summ="default" type="STRING"/>
					<colinfo id="USER_GRUP" size="256" summ="default" type="STRING"/>
					<colinfo id="USER_CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="G_USER_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZPMNUM" size="256" summ="default" type="STRING"/>
					<colinfo id="POPID" size="256" summ="default" type="STRING"/>
					<colinfo id="SO3" size="256" summ="default" type="STRING"/>
					<colinfo id="SO4" size="256" summ="default" type="STRING"/>
					<colinfo id="CLSSFY" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="TMCD" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQNO" size="256" summ="default" type="STRING"/>
					<record>
						<CLSSFY></CLSSFY>
						<CURR_DATE></CURR_DATE>
						<G_USER_ID></G_USER_ID>
						<GBN></GBN>
						<INP_DTF></INP_DTF>
						<POPID></POPID>
						<PSPID></PSPID>
						<SO3></SO3>
						<SO4></SO4>
						<USER_CODE></USER_CODE>
						<USER_GRUP></USER_GRUP>
						<ZZACTSS></ZZACTSS>
						<ZZLIFNR></ZZLIFNR>
						<ZZLIFNR_NM></ZZLIFNR_NM>
						<ZZPMNUM></ZZPMNUM>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_zzactss">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME></CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_zzlifnr">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
					<colinfo id="SORTL" size="256" type="STRING"/>
					<colinfo id="LOEVM" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_zzpmnum_cd">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME></CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond_cd">
				<Contents>
					<colinfo id="TEMNO" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZACTSS" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZSAWONNUM" size="256" summ="default" type="STRING"/>
					<colinfo id="TMCD" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZLIFNR" size="256" summ="default" type="STRING"/>
					<record>
						<TEMNO></TEMNO>
						<TMCD></TMCD>
						<ZZACTSS></ZZACTSS>
						<ZZLIFNR></ZZLIFNR>
						<ZZSAWONNUM></ZZSAWONNUM>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond1">
				<Contents>
					<colinfo id="PSPID" size="255" summ="default" type="STRING"/>
					<colinfo id="INP_DTF" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
					<colinfo id="SAFE" size="256" summ="default" type="STRING"/>
					<record>
						<INP_DTF></INP_DTF>
						<POSID></POSID>
						<PSPID></PSPID>
						<SAFE></SAFE>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list3">
				<Contents>
					<colinfo id="PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
					<colinfo id="GUBUN" size="256" summ="default" type="STRING"/>
					<colinfo id="PRONR" size="256" summ="default" type="STRING"/>
					<colinfo id="PROWRK" size="256" summ="default" type="STRING"/>
					<colinfo id="PRO_R" size="256" summ="default" type="STRING"/>
					<colinfo id="SAFE" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list3_tmp">
				<Contents>
					<colinfo id="PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
					<colinfo id="GUBUN" size="256" summ="default" type="STRING"/>
					<colinfo id="PRONR" size="256" summ="default" type="STRING"/>
					<colinfo id="PROWRK" size="256" summ="default" type="STRING"/>
					<colinfo id="PRO_R" size="256" summ="default" type="STRING"/>
					<colinfo id="SAFE" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_pop1"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_pop2"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_pop3"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_pop">
				<Contents></Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list1">
				<Contents>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSPEC1" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSPEC2" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZSHIP1" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZCOMP2" size="256" summ="default" type="STRING"/>
					<colinfo id="PMCD" size="256" summ="default" type="STRING"/>
					<colinfo id="TMCD" size="256" summ="default" type="STRING"/>
					<colinfo id="PRONR" size="256" summ="default" type="STRING"/>
					<colinfo id="PRO_R" size="256" summ="default" type="STRING"/>
					<colinfo id="PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSITE_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZGUBUN" size="256" summ="default" type="STRING"/>
					<colinfo id="INIT_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="M_MH" size="256" summ="default" type="STRING"/>
					<colinfo id="N_MH" size="256" summ="default" type="STRING"/>
					<colinfo id="A_MH" size="256" summ="default" type="STRING"/>
					<colinfo id="SUM_MH" size="256" summ="default" type="STRING"/>
					<colinfo id="NAMEE" size="256" summ="default" type="STRING"/>
					<colinfo id="PROWRK" size="256" summ="default" type="STRING"/>
					<colinfo id="TOT_PRO" size="256" summ="default" type="STRING"/>
					<colinfo id="NAME1" size="256" summ="default" type="STRING"/>
					<colinfo id="NAMET" size="256" summ="default" type="STRING"/>
					<colinfo id="NAMET2" size="256" summ="default" type="STRING"/>
					<colinfo id="CHECK" size="256" summ="default" type="STRING"/>
					<colinfo id="TYPE" size="256" summ="default" type="STRING"/>
					<colinfo id="APPR_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="APP_PRO" size="256" summ="default" type="STRING"/>
					<colinfo id="S_PRO" size="256" summ="default" type="STRING"/>
					<colinfo id="TXT30" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZILSIC" size="256" summ="default" type="STRING"/>
					<colinfo id="TEXT30" size="256" summ="default" type="STRING"/>
					<colinfo id="STEP1_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="STEP2_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="STEP3_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="SAFE" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSPEC" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID_DONG" size="256" summ="default" type="STRING"/>
					<colinfo id="HO_CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="INP_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="S_PRO2" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_save">
				<Contents></Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_save1">
				<Contents></Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_save2">
				<Contents></Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_save3">
				<Contents></Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list4">
				<Contents>
					<colinfo id="PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
					<colinfo id="GUBUN" size="256" summ="default" type="STRING"/>
					<colinfo id="PRONR" size="256" summ="default" type="STRING"/>
					<colinfo id="PROWRK" size="256" summ="default" type="STRING"/>
					<colinfo id="PRO_R" size="256" summ="default" type="STRING"/>
					<colinfo id="SAFE" size="256" summ="default" type="STRING"/>
					<colinfo id="POSIDCNT" size="256" summ="default" type="INT"/>
					<colinfo id="POSID_DONG" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list5">
				<Contents></Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond2">
				<Contents>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
					<colinfo id="GUBUN" size="256" summ="default" type="STRING"/>
					<colinfo id="TYPE" size="256" summ="default" type="STRING"/>
					<colinfo id="VER" size="256" summ="default" type="STRING"/>
					<colinfo id="PSPID" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond3">
				<Contents>
					<colinfo id="PSPID" size="255" summ="default" type="STRING"/>
					<colinfo id="INP_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
					<colinfo id="GUBUN" size="256" summ="default" type="STRING"/>
					<colinfo id="PRONR" size="256" summ="default" type="STRING"/>
					<colinfo id="COM_CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="FPATH" size="256" summ="default" type="STRING"/>
					<colinfo id="ORGFNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="FNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="FSIZE" size="999" summ="default" type="INT"/>
					<colinfo id="FDATR" size="256" summ="default" type="STRING"/>
					<colinfo id="TYPE" size="256" summ="default" type="STRING"/>
					<colinfo id="VER" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list2_0">
				<Contents>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSPEC1" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSPEC2" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZSHIP1" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZCOMP2" size="256" summ="default" type="STRING"/>
					<colinfo id="PMCD" size="256" summ="default" type="STRING"/>
					<colinfo id="TMCD" size="256" summ="default" type="STRING"/>
					<colinfo id="PRONR" size="256" summ="default" type="STRING"/>
					<colinfo id="PRO_R" size="256" summ="default" type="STRING"/>
					<colinfo id="PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSITE_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZGUBUN" size="256" summ="default" type="STRING"/>
					<colinfo id="INIT_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="M_MH" size="256" summ="default" type="STRING"/>
					<colinfo id="N_MH" size="256" summ="default" type="STRING"/>
					<colinfo id="A_MH" size="256" summ="default" type="STRING"/>
					<colinfo id="SUM_MH" size="256" summ="default" type="STRING"/>
					<colinfo id="NAMEE" size="256" summ="default" type="STRING"/>
					<colinfo id="PROWRK" size="256" summ="default" type="STRING"/>
					<colinfo id="TOT_PRO" size="256" summ="default" type="STRING"/>
					<colinfo id="NAME1" size="256" summ="default" type="STRING"/>
					<colinfo id="NAMET" size="256" summ="default" type="STRING"/>
					<colinfo id="NAMET2" size="256" summ="default" type="STRING"/>
					<colinfo id="CHECK" size="256" summ="default" type="STRING"/>
					<colinfo id="TYPE" size="256" summ="default" type="STRING"/>
					<colinfo id="APPR_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="APP_PRO" size="256" summ="default" type="STRING"/>
					<colinfo id="S_PRO" size="256" summ="default" type="STRING"/>
					<colinfo id="TXT30" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZILSIC" size="256" summ="default" type="STRING"/>
					<colinfo id="TEXT30" size="256" summ="default" type="STRING"/>
					<colinfo id="STEP1_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="STEP2_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="STEP3_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="SAFE" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSPEC" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID_DONG" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list2">
				<Contents>
					<colinfo id="BUJ" size="30" summ="default" type="STRING"/>
					<colinfo id="CH_FLG" size="0" summ="default" type="STRING"/>
					<colinfo id="CS101_ABG" size="60" summ="default" type="STRING"/>
					<colinfo id="CS101_AGB" size="60" summ="default" type="STRING"/>
					<colinfo id="CS101_BYD" size="24" summ="default" type="STRING"/>
					<colinfo id="CS101_FDT" size="24" summ="default" type="STRING"/>
					<colinfo id="CS101_FYN" size="3" summ="default" type="STRING"/>
					<colinfo id="CS101_HNA" size="90" summ="default" type="STRING"/>
					<colinfo id="CS101_HNO" size="9" summ="default" type="STRING"/>
					<colinfo id="CS101_IJY" size="24" summ="default" type="STRING"/>
					<colinfo id="CS101_PJT" size="18" summ="default" type="STRING"/>
					<colinfo id="CS101_VSD" size="24" summ="default" type="STRING"/>
					<colinfo id="DATE1" size="1" summ="default" type="STRING"/>
					<colinfo id="FLAG" size="0" summ="default" type="STRING"/>
					<colinfo id="IJD" size="24" summ="default" type="STRING"/>
					<colinfo id="JUJ" size="30" summ="default" type="STRING"/>
					<colinfo id="LIFNR" size="1" summ="default" type="STRING"/>
					<colinfo id="NAME1" size="256" summ="default" type="STRING"/>
					<colinfo id="NAMET" size="60" summ="default" type="STRING"/>
					<colinfo id="CELLPT" size="256" summ="default" type="STRING"/>
					<colinfo id="TELF1" size="256" summ="default" type="STRING"/>
					<colinfo id="TELFX" size="256" summ="default" type="STRING"/>
					<colinfo id="NAMET2" size="256" summ="default" type="STRING"/>
					<colinfo id="CELLPT2" size="256" summ="default" type="STRING"/>
					<colinfo id="ORG" size="1" summ="default" type="STRING"/>
					<colinfo id="ORG_BUJ" size="0" summ="default" type="STRING"/>
					<colinfo id="ORG_JUJ" size="0" summ="default" type="STRING"/>
					<colinfo id="PAPRID" size="30" summ="default" type="STRING"/>
					<colinfo id="TEMNO" size="18" summ="default" type="STRING"/>
					<colinfo id="ZMUSAOCNT" size="6" summ="default" type="STRING"/>
					<colinfo id="ZMUSAOCNT2" size="6" summ="default" type="STRING"/>
					<colinfo id="ZMUSAOCNT3" size="11" summ="default" type="INT"/>
					<colinfo id="ZQEGEMSA" size="24" summ="default" type="STRING"/>
					<colinfo id="ZSPEC1" size="15" summ="default" type="STRING"/>
					<colinfo id="ZSPEC2" size="75" summ="default" type="STRING"/>
					<colinfo id="ZSPEC9" size="9" summ="default" type="STRING"/>
					<colinfo id="POSID_OLD" size="256" summ="default" type="STRING"/>
					<colinfo id="DSCODE" size="256" summ="default" type="STRING"/>
					<colinfo id="FNM1" size="256" summ="default" type="STRING"/>
					<colinfo id="FNM2" size="256" summ="default" type="STRING"/>
					<colinfo id="FNM3" size="256" summ="default" type="STRING"/>
					<colinfo id="FNM4" size="256" summ="default" type="STRING"/>
					<colinfo id="FNM1_APP" size="256" summ="default" type="STRING"/>
					<colinfo id="FNM2_APP" size="256" summ="default" type="STRING"/>
					<colinfo id="FNM3_APP" size="256" summ="default" type="STRING"/>
					<colinfo id="FNM4_APP" size="256" summ="default" type="STRING"/>
					<colinfo id="SID" size="256" summ="default" type="STRING"/>
					<colinfo id="STN" size="256" summ="default" type="STRING"/>
					<colinfo id="FDT" size="256" summ="default" type="STRING"/>
					<colinfo id="TDT" size="256" summ="default" type="STRING"/>
					<colinfo id="GAO" size="256" summ="default" type="STRING"/>
					<colinfo id="PUB" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK_HNOINFO" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK_CSTINFO" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list1_tmp">
				<Contents>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSPEC1" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSPEC2" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZSHIP1" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZCOMP2" size="256" summ="default" type="STRING"/>
					<colinfo id="PMCD" size="256" summ="default" type="STRING"/>
					<colinfo id="TMCD" size="256" summ="default" type="STRING"/>
					<colinfo id="PRONR" size="256" summ="default" type="STRING"/>
					<colinfo id="PRO_R" size="256" summ="default" type="STRING"/>
					<colinfo id="PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSITE_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZGUBUN" size="256" summ="default" type="STRING"/>
					<colinfo id="INIT_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="M_MH" size="256" summ="default" type="STRING"/>
					<colinfo id="N_MH" size="256" summ="default" type="STRING"/>
					<colinfo id="A_MH" size="256" summ="default" type="STRING"/>
					<colinfo id="SUM_MH" size="256" summ="default" type="STRING"/>
					<colinfo id="NAMEE" size="256" summ="default" type="STRING"/>
					<colinfo id="PROWRK" size="256" summ="default" type="STRING"/>
					<colinfo id="TOT_PRO" size="256" summ="default" type="STRING"/>
					<colinfo id="NAME1" size="256" summ="default" type="STRING"/>
					<colinfo id="NAMET" size="256" summ="default" type="STRING"/>
					<colinfo id="NAMET2" size="256" summ="default" type="STRING"/>
					<colinfo id="CHECK" size="256" summ="default" type="STRING"/>
					<colinfo id="TYPE" size="256" summ="default" type="STRING"/>
					<colinfo id="APPR_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="APP_PRO" size="256" summ="default" type="STRING"/>
					<colinfo id="S_PRO" size="256" summ="default" type="STRING"/>
					<colinfo id="TXT30" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZILSIC" size="256" summ="default" type="STRING"/>
					<colinfo id="TEXT30" size="256" summ="default" type="STRING"/>
					<colinfo id="STEP1_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="STEP2_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="STEP3_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="SAFE" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSPEC" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID_DONG" size="256" summ="default" type="STRING"/>
					<colinfo id="HO_CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="INP_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="S_PRO2" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_gbn">
				<Contents>
					<colinfo id="GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="GNO" size="256" summ="default" type="STRING"/>
					<colinfo id="GNO_STEP" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_pop_f">
				<Contents></Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_lifnr_grid">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_condLifnr">
				<Contents>
					<colinfo id="LIFNR" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_tmcd">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NM" size="256" type="STRING"/>
					<colinfo id="LIFNR" size="256" type="STRING"/>
					<colinfo id="DELEF" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_file">
				<Contents>
					<colinfo id="MANDT" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQNO" size="256" summ="default" type="STRING"/>
					<colinfo id="SQFCD" size="256" summ="default" type="STRING"/>
					<colinfo id="GUBUN" size="256" summ="default" type="STRING"/>
					<colinfo id="MCROM" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSPEC3" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQNOTXT" size="256" summ="default" type="STRING"/>
					<colinfo id="FNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="F_EXT" size="256" summ="default" type="STRING"/>
					<colinfo id="FPATH" size="256" summ="default" type="STRING"/>
					<colinfo id="FNAME_APP" size="256" summ="default" type="STRING"/>
					<colinfo id="CRDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="CRTIM" size="256" summ="default" type="STRING"/>
					<colinfo id="CRNAM" size="256" summ="default" type="STRING"/>
					<colinfo id="CHDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="CHTIM" size="256" summ="default" type="STRING"/>
					<colinfo id="CHNAM" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_files">
				<Contents>
					<colinfo id="MANDT" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQNO" size="256" summ="default" type="STRING"/>
					<colinfo id="SQFCD" size="256" summ="default" type="STRING"/>
					<colinfo id="GUBUN" size="256" summ="default" type="STRING"/>
					<colinfo id="MCROM" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSPEC3" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQNOTXT" size="256" summ="default" type="STRING"/>
					<colinfo id="FNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="F_EXT" size="256" summ="default" type="STRING"/>
					<colinfo id="FPATH" size="256" summ="default" type="STRING"/>
					<colinfo id="FNAME_APP" size="256" summ="default" type="STRING"/>
					<colinfo id="CRDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="CRTIM" size="256" summ="default" type="STRING"/>
					<colinfo id="CRNAM" size="256" summ="default" type="STRING"/>
					<colinfo id="CHDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="CHTIM" size="256" summ="default" type="STRING"/>
					<colinfo id="CHNAM" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list_safe">
				<Contents>
					<colinfo id="CHECK" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN_NM" size="165" summ="default" type="STRING"/>
					<colinfo id="GBN_NM2" size="165" summ="default" type="STRING"/>
					<colinfo id="PSPID" size="48" summ="default" type="STRING"/>
					<colinfo id="POSID" size="48" summ="default" type="STRING"/>
					<colinfo id="POSID_DONG" size="48" summ="default" type="STRING"/>
					<colinfo id="CNT" size="6" summ="default" type="STRING"/>
					<colinfo id="CDATE" size="30" summ="default" type="STRING"/>
					<colinfo id="CNAME" size="105" summ="default" type="STRING"/>
					<colinfo id="CNAME2" size="105" summ="default" type="STRING"/>
					<colinfo id="FNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="FPATH" size="256" summ="default" type="STRING"/>
					<colinfo id="FNAME_APP" size="256" summ="default" type="STRING"/>
					<colinfo id="FSIZE" size="256" summ="default" type="STRING"/>
					<colinfo id="COLOR" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="FNAME_TMP" size="256" summ="default" type="STRING"/>
					<colinfo id="TYPE" size="256" summ="default" type="STRING"/>
					<colinfo id="GNO" size="256" summ="default" type="STRING"/>
					<colinfo id="GNO_STEP" size="256" summ="default" type="STRING"/>
					<colinfo id="SAFE" size="256" summ="default" type="STRING"/>
					<colinfo id="SAFE_CK" size="256" summ="default" type="STRING"/>
					<colinfo id="GUBUN" size="256" summ="default" type="STRING"/>
					<colinfo id="STEP1" size="256" summ="default" type="STRING"/>
					<colinfo id="STEP1_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="STEP1_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="DEVICE_GBN1" size="256" summ="default" type="STRING"/>
					<colinfo id="STEP2" size="256" summ="default" type="STRING"/>
					<colinfo id="STEP2_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="STEP2_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="DEVICE_GBN2" size="256" summ="default" type="STRING"/>
					<colinfo id="STEP3" size="256" summ="default" type="STRING"/>
					<colinfo id="STEP3_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="STEP3_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="DEVICE_GBN3" size="256" summ="default" type="STRING"/>
					<colinfo id="APPR_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="APPR_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="PRONR" size="256" summ="default" type="STRING"/>
					<colinfo id="PROWRK" size="256" summ="default" type="STRING"/>
					<colinfo id="PRO_R" size="256" summ="default" type="STRING"/>
					<colinfo id="VER" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond_safe">
				<Contents>
					<colinfo id="GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="PSPID" size="48" summ="default" type="STRING"/>
					<colinfo id="POSID" size="48" summ="default" type="STRING"/>
					<colinfo id="FNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="SO_GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="TYPE" size="256" summ="default" type="STRING"/>
					<colinfo id="GNO" size="256" summ="default" type="STRING"/>
					<colinfo id="SAFE" size="256" summ="default" type="STRING"/>
					<colinfo id="SAFE_CK" size="256" summ="default" type="STRING"/>
					<colinfo id="TYPE_CHK" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_trans">
				<Contents>
					<colinfo id="MESGACCP" size="256" summ="default" type="STRING"/>
					<colinfo id="MESGTITL" size="256" summ="default" type="STRING"/>
					<colinfo id="MESGDESC" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond_ms">
				<Contents>
					<colinfo id="PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="GUBUN" size="256" summ="default" type="STRING"/>
					<colinfo id="SO_GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="SO_GBN2" size="256" summ="default" type="STRING"/>
					<record>
						<GUBUN></GUBUN>
						<PSPID></PSPID>
						<SO_GBN/>
						<SO_GBN2/>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_chk">
				<Contents>
					<colinfo id="CNT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_save_ck">
				<Contents></Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_save_ck2">
				<Contents></Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_sdAuth" UseClientLayout="1">
				<Contents>
					<colinfo id="AUTH_CNT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
		</Datasets>
		<Shape BKColor="user0" Bottom="56" Height="56" Id="Shape0" Left="0" LineColor="user1" Right="1651" TabOrder="1" Top="0" Type="Rectangle" Width="1651"></Shape>
		<Static Align="Right" DomainID="com.pjtno" Height="20" Id="st_pjt" Left="8" Style="sty_lb_search" TabOrder="2" Text="프로젝트번호&#32;" Top="29" VAlign="Middle" Width="92"></Static>
		<Edit BindDataset="ds_cond" Border="Flat" CheckLength="Byte" Column="PSPID" Height="20" Id="ed_pspid" ImeMode="english" Left="104" MaxLength="6" Style="sty_ipt_search" TabOrder="3" Top="29" UpperOnly="TRUE" Width="78"></Edit>
		<Button Height="18" Id="Button0" ImageID="btn_icon_search" Left="185" OnClick="btn_pjt_OnClick" TabOrder="4" Text="Button0" Top="30" Width="18"></Button>
		<Static Align="Right" Height="20" Id="Static18" Left="208" Style="sty_lb_search" TabOrder="5" Text="사무소&#32;" Top="5" VAlign="Middle" Width="92"></Static>
		<Static Align="Right" Border="Flat" Enable="FALSE" Height="20" Id="Static19" Left="30" Style="sty_ipt_search" TabOrder="6" Top="1668" VAlign="Middle" Visible="FALSE" Width="138"></Static>
		<Checkbox BindDataset="ds_cond" Column="SO4" Enable="FALSE" FalseValue="0" Height="18" Id="chk_so4" Left="135" Style="sty_ipt_search_chk" TabOrder="8" Text="강북팀" Top="1669" TrueValue="1" Visible="FALSE" Width="61"></Checkbox>
		<Checkbox BindDataset="ds_cond" Column="SO3" Enable="FALSE" FalseValue="0" Height="18" Id="chk_so3" Left="66" Style="sty_ipt_search_chk" TabOrder="7" Text="강남팀" Top="1669" TrueValue="1" Visible="FALSE" Width="58"></Checkbox>
		<Static Align="Right" Height="20" Id="st_date" Left="8" Style="sty_lb_search" TabOrder="9" Text="조회일자&#32;" Top="5" VAlign="Middle" Width="92"></Static>
		<Calendar BindDataset="ds_cond" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="INP_DTF" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="ed_inpday_f" Left="104" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_search" SundayTextColor="user35" TabOrder="10" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="5" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="94"></Calendar>
		<Static Align="Right" Height="20" Id="st_zzpmnum" Left="876" Style="sty_lb_search" TabOrder="11" Text="PM&#32;" Top="5" VAlign="Middle" Width="92"></Static>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="CODE" Column="ZZPMNUM" DataColumn="CODE_NAME" Height="20" Id="cb_zzpmnum" InnerDataset="ds_zzpmnum_cd" Left="970" Style="sty_ipt_search" TabOrder="12" Top="5" Width="120"></Combo>
		<Static Align="Right" Height="20" Id="Static2" Left="400" Style="sty_lb_search" TabOrder="13" Text="설치협력사&#32;" Top="5" VAlign="Middle" Width="92"></Static>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="CODE" Column="ZZLIFNR" DataColumn="CODE_NAME" Height="20" Id="cb_zzlifnr" InnerDataset="ds_zzlifnr" Left="1112" Style="sty_ipt_search" TabOrder="14" Top="5" Visible="FALSE" Width="162"></Combo>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="CODE" Column="ZZACTSS" DataColumn="CODE_NAME" Height="20" Id="cb_zzactss" InnerDataset="ds_zzactss" Left="302" OnChanged="cb_zzactss_OnChanged" Style="sty_ipt_search" TabOrder="15" Top="5" Width="94"></Combo>
		<Div Border="RaisedEdge" Height="150" Id="Div0" Left="16" TabOrder="16" Text="Div0" Top="1704" Visible="FALSE" Width="577">
			<Contents>
				<Static Color="user7" Font="굴림,8" Height="24" Id="st_dong0" Left="7" TabOrder="1" Text="101동" Top="10" VAlign="Middle" Visible="FALSE" Width="56"></Static>
				<Static Color="user7" Font="굴림,8" Height="24" Id="st_0" Left="7" TabOrder="2" Text="호기&#32;:" Top="50" VAlign="Middle" Visible="FALSE" Width="56"></Static>
				<Static Color="user7" Font="굴림,8" Height="24" Id="st_1" Left="7" TabOrder="3" Text="호기&#32;:" Top="100" VAlign="Middle" Visible="FALSE" Width="56"></Static>
				<Static Align="Center" Color="user7" Font="굴림,9" Height="24" Id="Div0Date0" Left="71" TabOrder="4" Text="2019-01-01" Top="4" VAlign="Middle" Visible="FALSE" Width="144"></Static>
				<Static Align="Center" BKColor="ACTIVECAPTION" Color="user22" Font="굴림,9" Height="20" Id="Div0Title0" Left="71" TabOrder="5" Text="&#32;형판작업" Top="27" VAlign="Middle" Visible="FALSE" Width="144"></Static>
				<Image Border="Flat" Cursor="HAND" FillType="STRETCH" Height="85" Id="Div0Image0" Left="71" OnClick="images_onClickOpenPopup" Static="FALSE" TabOrder="6" TabStop="FALSE" Top="54" UserData="0" Visible="FALSE" Width="144"></Image>
				<Button Cursor="HAND" Height="18" Id="btn_openFile" ImageID="btn_icon_search" Left="47" OnClick="btn_openFile_OnClick" TabOrder="7" Text="Button0" Top="6" Visible="FALSE" Width="18"></Button>
			</Contents>
		</Div>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_picture" ImageID="btn_user_05" Left="1376" LeftMargin="12" OnClick="btn_picture_OnClick" Style="sty_btn" TabOrder="18" TabStop="FALSE" Text="&#32;사진보기" Top="8" Transparent="TRUE" Visible="FALSE" Width="80"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_gisung_save" ImageID="btn_user_03" Left="1456" LeftMargin="12" OnClick="btn_gisung_save_OnClick" Style="sty_btn" TabOrder="17" TabStop="FALSE" Text="&#32;저장" Top="8" Transparent="TRUE" Visible="FALSE" Width="59"></Button>
		<Div Border="RaisedEdge" BorderColor="user23" Height="808" Id="divImage" Left="1344" scroll="true" TabOrder="19" Text="Div0" Top="80" Visible="FALSE" Width="309">
			<Contents>
				<Static Align="Center" Color="user7" Font="굴림,9" Height="24" Id="div_date1" Left="7" TabOrder="1" Text="2019-01-01" Top="2" VAlign="Middle" Visible="FALSE" Width="135"></Static>
				<Static Align="Center" BKColor="ACTIVECAPTION" Color="user22" Font="굴림,9" Height="20" Id="div_pro_name1" Left="7" TabOrder="2" Text="&#32;형판작업" Top="25" VAlign="Middle" Visible="FALSE" Width="135"></Static>
				<Image Border="Flat" Cursor="HAND" FillType="STRETCH" Height="240" Id="Image1" Left="7" OnClick="images_onClickOpenPopup" Static="FALSE" TabOrder="3" TabStop="FALSE" Top="49" UserData="0" Visible="FALSE" Width="135"></Image>
				<Image Border="Flat" Cursor="HAND" FillType="STRETCH" Height="240" Id="Image2" Left="148" OnClick="images_onClickOpenPopup" Static="FALSE" TabOrder="4" TabStop="FALSE" Top="49" UserData="0" Visible="FALSE" Width="135"></Image>
				<Static Align="Center" Color="user7" Font="굴림,9" Height="24" Id="div_date2" Left="147" TabOrder="5" Text="2019-01-01" Top="2" VAlign="Middle" Visible="FALSE" Width="135"></Static>
				<Static Align="Center" BKColor="ACTIVECAPTION" Color="user22" Font="굴림,9" Height="20" Id="div_pro_name2" Left="147" TabOrder="6" Text="&#32;형판작업" Top="25" VAlign="Middle" Visible="FALSE" Width="135"></Static>
				<Static Align="Center" Color="user7" Font="굴림,9" Height="24" Id="div_date3" Left="7" TabOrder="7" Text="2019-01-01" Top="290" VAlign="Middle" Visible="FALSE" Width="135"></Static>
				<Static Align="Center" BKColor="ACTIVECAPTION" Color="user22" Font="굴림,9" Height="20" Id="div_pro_name3" Left="7" TabOrder="8" Text="&#32;형판작업" Top="313" VAlign="Middle" Visible="FALSE" Width="135"></Static>
				<Image Border="Flat" Cursor="HAND" FillType="STRETCH" Height="240" Id="Image3" Left="7" OnClick="images_onClickOpenPopup" Static="FALSE" TabOrder="9" TabStop="FALSE" Top="337" UserData="0" Visible="FALSE" Width="135"></Image>
				<Image Border="Flat" Cursor="HAND" FillType="STRETCH" Height="240" Id="Image4" Left="148" OnClick="images_onClickOpenPopup" Static="FALSE" TabOrder="10" TabStop="FALSE" Top="337" UserData="0" Visible="FALSE" Width="135"></Image>
				<Static Align="Center" Color="user7" Font="굴림,9" Height="24" Id="div_date4" Left="147" TabOrder="11" Text="2019-01-01" Top="290" VAlign="Middle" Visible="FALSE" Width="135"></Static>
				<Static Align="Center" BKColor="ACTIVECAPTION" Color="user22" Font="굴림,9" Height="20" Id="div_pro_name4" Left="147" TabOrder="12" Text="&#32;형판작업" Top="313" VAlign="Middle" Visible="FALSE" Width="135"></Static>
				<Static Align="Center" Color="user7" Font="굴림,9" Height="24" Id="div_date5" Left="7" TabOrder="13" Text="2019-01-01" Top="580" VAlign="Middle" Visible="FALSE" Width="135"></Static>
				<Static Align="Center" BKColor="ACTIVECAPTION" Color="user22" Font="굴림,9" Height="20" Id="div_pro_name5" Left="11" TabOrder="14" Text="&#32;형판작업" Top="602" VAlign="Middle" Visible="FALSE" Width="135"></Static>
				<Image Border="Flat" Cursor="HAND" FillType="STRETCH" Height="240" Id="Image5" Left="7" OnClick="images_onClickOpenPopup" Static="FALSE" TabOrder="15" TabStop="FALSE" Top="626" UserData="0" Visible="FALSE" Width="135"></Image>
				<Image Border="Flat" Cursor="HAND" FillType="STRETCH" Height="240" Id="Image6" Left="148" OnClick="images_onClickOpenPopup" Static="FALSE" TabOrder="16" TabStop="FALSE" Top="626" UserData="0" Visible="FALSE" Width="135"></Image>
				<Static Align="Center" Color="user7" Font="굴림,9" Height="24" Id="div_date6" Left="147" TabOrder="17" Text="2019-01-01" Top="580" VAlign="Middle" Visible="FALSE" Width="135"></Static>
				<Static Align="Center" BKColor="ACTIVECAPTION" Color="user22" Font="굴림,9" Height="20" Id="div_pro_name6" Left="147" TabOrder="18" Text="&#32;형판작업" Top="602" VAlign="Middle" Visible="FALSE" Width="135"></Static>
				<Image Border="Flat" Cursor="HAND" FillType="STRETCH" Height="240" Id="Image8" Left="150" OnClick="images_onClickOpenPopup" Static="FALSE" TabOrder="22" TabStop="FALSE" Top="914" UserData="0" Visible="FALSE" Width="135"></Image>
				<Static Align="Center" BKColor="ACTIVECAPTION" Color="user22" Font="굴림,9" Height="20" Id="div_pro_name8" Left="149" TabOrder="24" Text="&#32;형판작업" Top="891" VAlign="Middle" Visible="FALSE" Width="135"></Static>
				<Image Border="Flat" Cursor="HAND" FillType="STRETCH" Height="240" Id="Image10" Left="150" OnClick="images_onClickOpenPopup" Static="FALSE" TabOrder="28" TabStop="FALSE" Top="1201" UserData="0" Visible="FALSE" Width="135"></Image>
				<Static Align="Center" Color="user7" Font="굴림,9" Height="24" Id="div_date10" Left="149" TabOrder="29" Text="2019-01-01" Top="1155" VAlign="Middle" Visible="FALSE" Width="135"></Static>
				<Static Align="Center" BKColor="ACTIVECAPTION" Color="user22" Font="굴림,9" Height="20" Id="div_pro_name10" Left="149" TabOrder="30" Text="&#32;형판작업" Top="1178" VAlign="Middle" Visible="FALSE" Width="135"></Static>
				<Static Align="Center" Color="user7" Font="굴림,9" Height="24" Id="div_date12" Left="149" TabOrder="34" Text="2019-01-01" Top="1443" VAlign="Middle" Visible="FALSE" Width="135"></Static>
				<Static Align="Center" BKColor="ACTIVECAPTION" Color="user22" Font="굴림,9" Height="20" Id="div_pro_name12" Left="149" TabOrder="35" Text="&#32;형판작업" Top="1465" VAlign="Middle" Visible="FALSE" Width="135"></Static>
				<Static Align="Center" Color="user7" Font="굴림,9" Height="24" Id="div_date7" Left="9" TabOrder="19" Text="2019-01-01" Top="868" VAlign="Middle" Visible="FALSE" Width="135"></Static>
				<Static Align="Center" BKColor="ACTIVECAPTION" Color="user22" Font="굴림,9" Height="20" Id="div_pro_name7" Left="9" TabOrder="20" Text="&#32;형판작업" Top="891" VAlign="Middle" Visible="FALSE" Width="135"></Static>
				<Image Border="Flat" Cursor="HAND" FillType="STRETCH" Height="240" Id="Image7" Left="9" OnClick="images_onClickOpenPopup" Static="FALSE" TabOrder="21" TabStop="FALSE" Top="914" UserData="0" Visible="FALSE" Width="135"></Image>
				<Static Align="Center" Color="user7" Font="굴림,9" Height="24" Id="div_date8" Left="149" TabOrder="23" Text="2019-01-01" Top="868" VAlign="Middle" Visible="FALSE" Width="135"></Static>
				<Static Align="Center" Color="user7" Font="굴림,9" Height="24" Id="div_date9" Left="9" TabOrder="25" Text="2019-01-01" Top="1155" VAlign="Middle" Visible="FALSE" Width="135"></Static>
				<Static Align="Center" BKColor="ACTIVECAPTION" Color="user22" Font="굴림,9" Height="20" Id="div_pro_name9" Left="9" TabOrder="26" Text="&#32;형판작업" Top="1178" VAlign="Middle" Visible="FALSE" Width="135"></Static>
				<Image Border="Flat" Cursor="HAND" FillType="STRETCH" Height="240" Id="Image9" Left="9" OnClick="images_onClickOpenPopup" Static="FALSE" TabOrder="27" TabStop="FALSE" Top="1201" UserData="0" Visible="FALSE" Width="135"></Image>
				<Static Align="Center" Color="user7" Font="굴림,9" Height="24" Id="div_date11" Left="9" TabOrder="31" Text="2019-01-01" Top="1443" VAlign="Middle" Visible="FALSE" Width="135"></Static>
				<Image Border="Flat" Cursor="HAND" FillType="STRETCH" Height="240" Id="Image12" Left="150" OnClick="images_onClickOpenPopup" Static="FALSE" TabOrder="33" TabStop="FALSE" Top="1488" UserData="0" Visible="FALSE" Width="135"></Image>
				<Static Align="Center" BKColor="ACTIVECAPTION" Color="user22" Font="굴림,9" Height="20" Id="div_pro_name11" Left="13" TabOrder="32" Text="&#32;형판작업" Top="1465" VAlign="Middle" Visible="FALSE" Width="135"></Static>
				<Image Border="Flat" Cursor="HAND" FillType="STRETCH" Height="240" Id="Image11" Left="9" OnClick="images_onClickOpenPopup" Static="FALSE" TabOrder="36" TabStop="FALSE" Top="1488" UserData="0" Visible="FALSE" Width="135"></Image>
			</Contents>
		</Div>
		<Grid AreaSelect="TRUE" AutoFitEndLine="Hide" BindDataset="ds_list1" BkColor2="default" BoldHead="true" Border="Flat" Bottom="888" ColSelect="TRUE" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="30" Height="828" Id="grd_list1" InputPanel="FALSE" Left="2" LineColor="user20" LineType="ExHORZ" OnCellClick="ds_list1_OnCellClick" OnCellDBLClick="grd_list1_OnCellDblClick" OnHeadClick="grd_list1_OnHeadClick" OnKeyDown="grd_list1_OnKeyDown" Right="608" RowHeight="20" Style="sty_grid" TabOrder="20" TabStop="true" Top="60" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="606">
			<contents>
				<format id="Default">
					<columns>
						<col fix="left" width="30"/>
						<col fix="left" width="52"/>
						<col fix="left" width="153"/>
						<col fix="left" width="70"/>
						<col fix="left" width="50"/>
						<col fix="left" width="106"/>
						<col fix="left" width="52"/>
						<col fix="left" width="73"/>
					</columns>
					<head>
						<cell col="0" display="text" font="굴림,9" text="No"/>
						<cell align="center" col="1" color="user21" display="text" font="굴림,9" text="프로젝트"/>
						<cell align="center" col="2" color="user21" display="text" font="굴림,9" text="현장명"/>
						<cell align="center" col="3" color="user21" display="text" font="굴림,9" text="호기"/>
						<cell align="center" col="4" color="user21" display="text" font="굴림,9" scrollbar="both" text="PM"/>
						<cell align="center" col="5" color="user21" display="text" font="굴림,9" scrollbar="both" text="협력업체"/>
						<cell align="center" col="6" color="user21" display="text" font="굴림,9" scrollbar="both" text="작업팀장"/>
						<cell align="center" col="7" color="user21" display="text" font="굴림,9" text="일보누계(%)"/>
					</head>
					<body>
						<cell align="center" col="0" colid="no" display="text" edit="normal" expr="currow+1"/>
						<cell align="center" bkcolor2="user22" col="1" colid="PSPID" display="text" suppress="1"/>
						<cell align="left" bkcolor2="user22" col="2" colid="ZSITE_NM" display="text" suppress="2"/>
						<cell align="center" bkcolor2="user22" col="3" colid="POSID" display="text"/>
						<cell align="center" bkcolor2="user22" col="4" colid="NAMET" display="text"/>
						<cell align="left" bkcolor2="user22" col="5" colid="NAME1" display="text"/>
						<cell align="center" bkcolor2="user22" col="6" colid="NAMET2" display="text"/>
						<cell align="right" bkcolor2="user22" col="7" colid="TOT_PRO" display="number" Mask="expr:&apos;#0.0&apos;"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Tab Height="58" Id="Tab00" Left="608" TabIndex="1" TabOrder="21" Top="1706" Visible="FALSE" Width="81">
			<Contents>
				<TabPage Height="33" Id="tab00" Left="2" TabOrder="22" Text="tab1" Top="23" Width="77"></TabPage>
				<TabPage Height="33" Id="tab2" Left="2" TabOrder="22" Text="tab2" Top="23" Width="77"></TabPage>
			</Contents>
		</Tab>
		<Static Height="16" Id="Static16" Left="632" TabOrder="22" Text="Static0" Top="1793" Visible="FALSE" Width="67"></Static>
		<Grid AreaSelect="true" AutoFitEndLine="Hide" BindDataset="ds_pop" BkColor2="default" BoldHead="true" Border="Flat" Bottom="888" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="828" HScrollCell="TRUE" Id="grd_pop" InputPanel="FALSE" Left="616" LineColor="user20" LineType="ExHORZ" OnCellClick="grd_pop_OnCellClick" Right="1340" ScrollCell="true" Style="sty_grid" TabOrder="23" TabStop="true" Top="60" UseAutoSizing="Row" UseDBuff="true" UseExprCache="Row" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="724">
			<contents>
				<format id="Default">
					<columns>
						<col fix="left" width="25"/>
						<col fix="left" width="240"/>
						<col fix="left" width="45"/>
						<col fix="left" width="45"/>
						<col fix="left" width="53"/>
						<col fix="left" width="55"/>
						<col fix="left" width="53"/>
						<col fix="left" width="72"/>
						<col fix="left" width="72"/>
						<col fix="left" width="45"/>
					</columns>
					<head>
						<cell col="0" display="text" font="굴림,9" text="NO"/>
						<cell col="1" display="text" font="굴림,9" text="DESCRIPTION"/>
						<cell col="2" display="text" font="굴림,9" text="공정율"/>
						<cell col="3" display="text" font="굴림,9" text="누계"/>
						<cell col="4" display="text" font="굴림,9" text="계획"/>
						<cell col="5" display="text" font="굴림,9" text="업로드"/>
						<cell col="6" display="text" font="굴림,9" text="완료"/>
						<cell col="7" display="text" font="굴림,9" text="안전승인"/>
						<cell col="8" display="text" edit="expr:decode(COL0,&#32;&apos;0&apos;,&#32;&apos;checkbox&apos;,&#32;&apos;1&apos;,decode(JCOL0,&apos;0&apos;,&apos;none&apos;,&#32;&apos;1&apos;,&#32;&apos;checkbox&apos;,&apos;none&apos;),&#32;&apos;none&apos;)" font="굴림,9" text="기성"/>
						<cell col="9" display="text" font="굴림,9" text="승인자"/>
					</head>
					<body>
						<cell align="center" bkcolor="expr:decode(UPLOAD_YN,&#32;&apos;Y&apos;,&#32;&apos;pink&apos;,&#32;&apos;F&apos;,&#32;&apos;lightgreen&apos;,&#32;&apos;default&apos;)" col="0" display="text" expr="currow+1"/>
						<cell bkcolor="expr:decode(UPLOAD_YN,&#32;&apos;Y&apos;,&#32;&apos;pink&apos;,&#32;&apos;F&apos;,&#32;&apos;lightgreen&apos;,&#32;&apos;default&apos;)" col="1" colid="PROWRK" display="text"/>
						<cell align="right" bkcolor="expr:decode(UPLOAD_YN,&#32;&apos;Y&apos;,&#32;&apos;pink&apos;,&#32;&apos;F&apos;,&#32;&apos;lightgreen&apos;,&#32;&apos;default&apos;)" col="2" colid="PRO_R" display="number" Mask="expr:&apos;#0.0&apos;"/>
						<cell align="right" bkcolor="expr:decode(UPLOAD_YN,&#32;&apos;Y&apos;,&#32;&apos;pink&apos;,&#32;&apos;F&apos;,&#32;&apos;lightgreen&apos;,&#32;&apos;default&apos;)" col="3" colid="PRO_SUM" display="number" Mask="expr:&apos;#0.0&apos;"/>
						<cell bkcolor="expr:decode(JCOL,&#32;&apos;1&apos;,&#32;&apos;user34&apos;,&#32;&apos;default&apos;)" bkcolor2="expr:decode(JCOL,&#32;&apos;1&apos;,&#32;&apos;user34&apos;,&#32;&apos;user22&apos;)" col="4" colid="JCOL" display="checkbox"/>
						<cell bkimageid='expr:iif(&#32;FINISH_PIC_YN&#32;&#32;==&#32;&apos;Y&apos;&#32;,&#32;gfn_getFlagBkImageID(&quot;I&quot;)&#32;,&#32;&quot;&quot;)' col="5" cursor='expr:iif(&#32;FINISH_PIC_YN&#32;&#32;==&#32;&apos;Y&apos;&#32;,&#32;&quot;hand&quot;,&#32;&quot;arrow&quot;)' display="number" edit="checkbox"/>
						<cell bkcolor="expr:decode(COM_CHK,&#32;&apos;1&apos;,&#32;&apos;user34&apos;,&#32;&apos;default&apos;)" bkcolor2="expr:decode(COM_CHK,&#32;&apos;1&apos;,&#32;&apos;user34&apos;,&#32;&apos;user22&apos;)" col="6" colid="COM_CHK" display="checkbox" edit="expr:iif(FLAG&#32;==&#32;&apos;1&apos;,&#32;iif(VER&gt;=&#32;&apos;005&apos;,&#32;iif(EDATE&#32;==&#32;gfn_getCurrDate()&#32;&amp;&amp;&#32;FINISH_PIC_YN&#32;==&#32;&apos;N&apos;&#32;,&#32;&apos;checkbox&apos;&#32;,iif(FIX_COM_CHK&#32;!=&#32;1&amp;&amp;&#32;FINISH_PIC_YN&#32;==&#32;&apos;N&apos;&#32;,&#32;&apos;checkbox&apos;,&#32;&apos;none&apos;))&#32;,&apos;checkbox&apos;)&#32;,&apos;none&apos;)"/>
						<cell bkcolor="expr:decode(UPLOAD_YN,&#32;&apos;Y&apos;,&#32;&apos;pink&apos;,&#32;&apos;F&apos;,&#32;&apos;lightgreen&apos;,&#32;&apos;default&apos;)" col="7" colid="APRDT" display="text" Mask="####.##.##"/>
						<cell bkcolor="expr:iif(COL&#32;==&#32;&apos;1&apos;&#32;&amp;&amp;&#32;COM_CHK&#32;==&#32;&apos;1&apos;,&#32;&apos;user34&apos;,&#32;&apos;default&apos;)" col="8" colid="COL" color="expr:iif(COL&#32;==&#32;&apos;1&apos;&#32;&amp;&amp;&#32;COM_CHK&#32;==&#32;&apos;1&apos;),&#32;&apos;white&apos;,&#32;&apos;default&apos;)" display='expr:decode(COL,&#32;&apos;1&apos;,&#32;&quot;checkbox&quot;,&#32;&apos;0&apos;,iif(COM_CHK&#32;==&#32;&apos;1&apos;,&#32;&quot;checkbox&quot;,&#32;&quot;normal&quot;),&#32;&apos;normal&apos;)' edit='expr:decode(COL,&#32;&apos;1&apos;,&#32;&quot;checkbox&quot;,&#32;&apos;0&apos;,&#32;iif(COM_CHK&#32;==&#32;&apos;1&apos;,&#32;&quot;checkbox&quot;,&#32;&quot;none&quot;),&#32;&apos;none&apos;)' expr="decode(COL,&#32;&apos;0&apos;,&#32;&apos;&apos;,&#32;&apos;1&apos;,&#32;&apos;1&apos;,&#32;COL)" Mask="expr:decode(COL,&#32;&apos;0&apos;,&#32;&apos;0&apos;,&#32;&apos;1&apos;,&#32;&apos;1&apos;,&#32;&apos;####.##.##&apos;)"/>
						<cell align="center" bkcolor="expr:decode(UPLOAD_YN,&#32;&apos;Y&apos;,&#32;&apos;pink&apos;,&#32;&apos;F&apos;,&#32;&apos;lightgreen&apos;,&#32;&apos;default&apos;)" col="9" colid="APPR_NM" display="text"/>
					</body>
					<summary>
						<cell align="center" bkcolor="user27" col="0" color="user26" colspan="2" display="text" text="당일&#32;누계&#32;공정율"/>
						<cell col="2" display="text"/>
						<cell col="3" display="text"/>
						<cell bkcolor="user27" col="4" color="user26" display="number" Mask="expr:&apos;#0.0&apos;"/>
						<cell col="5" display="text"/>
						<cell bkcolor="user27" col="6" color="user26" display="number" Mask="expr:&apos;#0.0&apos;"/>
						<cell bkcolor="user27" col="7" color="user26" colspan="2" display="number" Mask="expr:&apos;#0.0&apos;"/>
						<cell align="center" bkcolor="user27" col="9" color="user26" display="text" text="당일&#32;누계&#32;공정율"/>
					</summary>
				</format>
			</contents>
		</Grid>
		<Static Align="Center" BKColor="#daedf5" Border="Flat" BorderColor="user13" Color="black" Font="굴림,9" Height="22" Id="Static0" Left="1344" TabOrder="23" Text="작업완료&#32;사진" Top="60" VAlign="Middle" Width="309"></Static>
		<FileDialog Bottom="24" Filter="All(*.*)|*.*|jpg&#32;File(*.jpg)|*.jpg|jpeg&#32;File(*.jpeg)|*.jpeg|bmp&#32;File(*.bmp)|*.jpeg|gif&#32;File(*.gif)|*.gif|png&#32;File(*.png)|*.png|pdf&#32;File(*.pdf)|*.pdf|" Height="24" Id="saveDialog" Left="1592" Right="1616" TabOrder="24" Type="Save" Width="24"></FileDialog>
		<CyHttpFile Height="24" Id="httpFile" Left="1624" Width="24"></CyHttpFile>
		<Static BKColor="pink" Height="16" Id="Static1" Left="688" TabOrder="25" Top="32" Width="30"></Static>
		<Static BKColor="lightgreen" Height="16" Id="Static3" Left="865" TabOrder="26" Top="32" Width="30"></Static>
		<Static Height="16" Id="Static4" Left="725" TabOrder="27" Text="사진" Top="32" VAlign="Middle" Width="27"></Static>
		<Static Height="16" Id="Static5" Left="831" TabOrder="28" Text="공정" Top="32" VAlign="Middle" Width="30"></Static>
		<Static Color="red" Font="Tahoma,9,Bold,Italic" Height="16" Id="Static6" Left="753" TabOrder="29" Text="업로드&#32;대상" Top="32" VAlign="Middle" Width="72"></Static>
		<Static Height="16" Id="Static7" Left="1005" TabOrder="31" Text="공정" Top="32" VAlign="Middle" Width="27"></Static>
		<Static Color="red" Font="Tahoma,9,Bold,Italic" Height="16" Id="Static8" Left="930" TabOrder="32" Text="업로드&#32;완료" Top="32" VAlign="Middle" Width="72"></Static>
		<Static Height="16" Id="Static9" Left="902" TabOrder="30" Text="사진" Top="32" VAlign="Middle" Width="27"></Static>
		<Static Align="Right" Border="Flat" Height="20" Id="Static10" Left="499" Style="sty_ipt_search" TabOrder="33" Top="30" VAlign="Middle" Width="180"></Static>
		<Radio BindDataset="ds_cond" BKColor="user0" Border="None" Column="GBN" Font="굴림,9" Height="18" Id="rd_chk" INDEX="-1" Left="504" Style="sty_ipt_form_radio" TabOrder="34" Top="31" Value="1" Width="172">
			<Contents>
				<Layout code="1" height="20" left="0" text="전체" top="0" width="50"/>
				<Layout code="2" height="20" left="50" text="신공정" top="0" width="65"/>
				<Layout code="3" height="20" left="115" text="구공정" top="0" width="70"/>
			</Contents>
		</Radio>
		<Static Align="Right" Height="20" Id="Static11" Left="400" Style="sty_lb_search" TabOrder="35" Text="공정구분&#32;" Top="29" VAlign="Middle" Width="92"></Static>
		<Edit BindDataset="ds_cond" Border="Flat" CheckLength="Byte" Column="ZZLIFNR_NM" Height="20" Id="edt_lifnr" ImeMode="native" Left="496" MaxLength="30" OnKeyDown="edt_lifnr_OnKeyDown" Style="sty_ipt_search" TabOrder="36" Top="5" UpperOnly="TRUE" Width="151"></Edit>
		<Button Height="18" Id="btn_lifnr" ImageID="btn_icon_search" Left="650" OnClick="btn_lifnr_OnClick" TabOrder="37" Text="btn_lifnr" Top="6" Width="18"></Button>
		<Static Align="Right" Height="20" Id="st_tmcd" Left="672" Style="sty_lb_search" TabOrder="38" Text="설치팀장&#32;" Top="5" VAlign="Middle" Width="92"></Static>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="CODE" Column="TMCD" DataColumn="CODE_NM" Height="20" Id="cb_tmcd" InnerDataset="ds_tmcd" Left="766" Style="sty_ipt_search" TabOrder="39" Top="4" Width="106"></Combo>
		<Static Font="굴림,9,Bold" Height="18" Id="Static12" Left="219" TabOrder="40" Text="선택호기&#32;:&#32;" Top="31" VAlign="Middle" Width="77"></Static>
		<Static Font="굴림,9,Bold" Height="18" Id="lb_posid" Left="288" TabOrder="41" Top="31" VAlign="Middle" Width="104"></Static>
		<CyHttpFile Height="24" Id="httpFile1" Left="896" Top="56" Width="24"></CyHttpFile>
	</Form>
	<Script><![CDATA[/*
 *****************************************************************************************
 * 기      능   :
 * 작  성  자   :
 * 작성  일자   :
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
#include "LIB::commons.js";	// 공통 스크립트
//=========================================================================================
// [ PART 1 ]
// Form에서 사용될 전역변수를 선언
// FORM에서 사용되는 전역변수는 대문자로 작성하며, F_XXX 의 형태를 갖도록 한다.
//=========================================================================================
var userGroup = "";
var args = "";
var curr_date = "";
var _GUBUN = "";
var _P_POSID = "";
var _P_GUBUN = "";
var _P_TYPE = "";
var _P_VER = "";
var _P_SAFE = "";
var _P_ZSPEC = "";
var _P_CHK = "";
var E_FLAG = "";
var _TABGUBUN = "";
var prev_row = -1;//호기 리스트에서 키보드 이동 시 조회 기능 추가 - 2019.03.14 강민석K
var dblclick_row = -1;//협력업체, 작업팀장 선택 시 선택한 협력업체 정보가 표시되도록 수정 - 2019.03.21 강민석K
var _send_file = false;
//=========================================================================================
// [ PART 2 ]
// Form Loading / Unloading 시 작업 정의
//=========================================================================================
function fn_OnLoadCompleted(obj)
{
	// Form 로드 이벤트 맨 첫줄에 기술
	gfn_initForm(false);

	userGroup = gfn_getUserGroup();

	ed_inpday_f.value = gfn_getCurrDate();

	ds_cond.SetColumn(0,"USER_GRUP",userGroup);
	if (userGroup == "10")
	{
		ds_cond.SetColumn(0,"USER_CODE",G_VEND_CODE_E);
	}
	else if (userGroup == "20")
	{
		ds_cond.SetColumn(0,"USER_CODE",G_USER_ID);
	}
	else if (userGroup == "30")
	{
		ds_cond.SetColumn(0,"USER_CODE",G_AREA_CODE_E);
	}

	var codeArr = ["PS003"];
    var dsObjArr = [ds_zzactss];
    var addTypeArr = [G_CODE_ALL];
    gfn_searchCommCode(codeArr, dsObjArr, addTypeArr);

	initImage();

	ds_cond.SetColumn(0, "CLSSFY", 'A');
	ds_cond.SetColumn(0, "GBN" , "1");

	tit_clearActionInfo();
	tit_addSearchActionInfo("ps02:PS0201001A_S34");
	tit_addSearchActionInfo("ps02:PS0201001A_S76"); // SRM 권한 영업대리점 (zsd11, zsdb10) 확인위해
	tit_callService(
		""
		, ""
		, "ds_cond=ds_cond"
		, "ds_zzlifnr=ds_zzlifnr_cd ds_sdAuth=ds_sdAuth"   // ds_pronr=ds_pronr"
		, ""
		, "fn_afterQueryC"
		, ""
		, ""
		, true);

	ed_inpday_f.SETFOCUS();
	gfn_showMsg("CI00007");

	//trace("AS-IS 투입일자별 작업일보 조회 및 승인 화면에서 넘겨준 프로젝트 번호(F_PSPID) : " + F_PSPID);
	
	if( length(F_PSPID) > 0 )  //프로젝트 번호가 넘어왔을때
	{
		ds_cond.SetColumn(0, "PSPID", F_PSPID);
		fn_query();
	}
}

/********************************************************************************
* 기      능   :  이미지 초기화 - 추가 2019.03.11 강민석K
********************************************************************************/
function initImage() {
	for(var i = 0; i < 12; i++)
	{
		//투입일자
		eval("divImage.div_date" + (i + 1)).Text = "";
		eval("divImage.div_date" + (i + 1)).Visible = false;

		//공정명
		eval("divImage.div_pro_name" + (i + 1)).Text = "";
		eval("divImage.div_pro_name" + (i + 1)).Visible = false;

		//이미지
		eval("divImage.Image" + (i + 1)).ImageID = "";
		eval("divImage.Image" + (i + 1)).Visible = false;
		divImage.Visible = true;
	}

	divImage.SetScroll(0, 0);
}

/********************************************************************************
* 기      능   :  협력사 조회 Callback
********************************************************************************/
function fn_afterQueryC(errCode, errMsg) {
	
	if(ds_sdAuth.GetColumn(0, "AUTH_CNT") > 0)
	{
		userGroup = '40';
		btn_save.Enable = false;
	}
	
	if ( userGroup == "10" )
	{
		ds_cond.fireevent = false;
		ds_cond.SetColumn(0, "ZZLIFNR", G_VEND_CODE_E);
		ds_cond.SetColumn(0, "ZZLIFNR_NM", G_VEND_NAME);
		ds_cond.fireevent = true;

		edt_lifnr.Enable = false;
		btn_lifnr.Enable = false;
		fn_tmcd();
	}
	else if ( userGroup == "30" || userGroup == "40")
	{
		edt_lifnr.Enable = true;
		btn_lifnr.Enable = true;
	}
	
	
	//Trace(ds_cond.GetColumn(0,"ZZLIFNR"));
}

/********************************************************************************
* 기      능   : 공통코드가 조회된 후의 Callback 함수
********************************************************************************/
function fn_completeInit(sCode, sDsObj, sCodeType)
{
	if(userGroup == "40")
	{
		cb_zzactss.Index = 0;
		cb_zzactss.Enable = true;
	}
	else if(userGroup == "30")
	{
		ds_zzactss.Filter("CODE="+quote(G_AREA_CODE_E));
		cb_zzactss.Index = 0;
		cb_zzactss.Enable = false;
		
		if(userGroup == "40" || userGroup == "30"){
			ds_cond.SetColumn(0,"ZZLIFNR",'');
		}
	
		if(ds_cond.GetColumn(0,"ZZACTSS") == ''){
			ds_zzlifnr.UnFilter();
		}else{
			var arr = ds_cond.GetColumn(0,"ZZACTSS");
			ds_zzlifnr.Filter("ZZACTSS ==" +quote(arr));
		}
		
		ds_cond_cd.SetColumn(0,"ZZACTSS",G_AREA_CODE_E);
		cb_zzpmnum.value = "";
	
		tit_clearActionInfo();
		tit_addSearchActionInfo("ps02:PS0201001A_S41");
		
		tit_callService(
			""
			, ""
			, "ds_cond_cd=ds_cond_cd"
			, "ds_zzpmnum_cd=ds_zzpmnum_cd"  // ds_pronr=ds_pronr"
			, ""
			, "fn_afterZzactssChange"
			, ""
			, ""
			, true);
	}
	else if(userGroup == "10")
	{
		cb_zzactss.Index = 0;
		cb_zzactss.Enable = false;
	}
}

/********************************************************************************
* 기      능   : form UnloadCompleted
********************************************************************************/
function fn_OnUnloadCompleted(obj)
{
	return gfn_isFormUnload(obj);
}

//=========================================================================================
// [ PART 3 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,form닫기)
//=========================================================================================
/********************************************************************************
* 기      능   : 조회
********************************************************************************/
function fn_query()
{
	// 투입일자 필수
	if(gfn_isNull(ed_inpday_f, true, st_date.value))  return;
	var sZzactss    = ds_cond.GetColumn(0, "ZZACTSS");
	var sZZLIFNR_NM = ds_cond.GetColumn(0, "ZZLIFNR_NM");
	var sPspid      = ds_cond.GetColumn(0, "PSPID");
	
	if(Length(Trim(sPspid)) == 0 && Length(Trim(sZzactss)) == 0 && Length(Trim(sZZLIFNR_NM)) == 0)
	{
		gfn_openMsgWin("프로젝트 번호/사무소/설치협력사 중 하나는 필수선택입니다.");
		return;
	}
	
	
	tit_clearActionInfo();
	tit_addSearchActionInfo("ps02:PS0209003A_S1");//==> 예전 PS0207003A_S1.xml

	tit_callService(
          ""
        , ""
        , "ds_cond=ds_cond"
        , "ds_list1=ds_list1"
        , ""
        , "fn_afterQuery"
        , ""
        , ""
        , true);
}

/********************************************************************************
* 기      능   : 조회 Callback
********************************************************************************/
function fn_afterQuery(errCode, errMsg)
{
	//trace("fn_afterQuery F_POSID (이전화면에서 넘겨준 호기번호) : " + F_POSID);
	//trace("fn_afterQuery _P_POSID (최근에 리스트에서 선택했던 호기번호) : " + _P_POSID);

	if( length(_P_POSID) > 0 || length(F_POSID) > 0 )  //호기번호가 있을때
	{
		var POSID = "";
		if(length(F_POSID) > 0){
			POSID = F_POSID;
			F_POSID = "";//이전화면에서 넘겨준 호기번호는 한번 쓰고 초기화해야 재조회 시 사요하지 않는다 - 2019.03.15 강민석K
		}else{
			POSID = _P_POSID;
		}

		ds_list1.row = ds_list1.FindRow("POSID", POSID);
		grd_list1.SetCellPos(3);

		ds_list1_OnCellClick('', ds_list1.row, 3, '', '', '');//공정표 그리기 호출
	}

	gfn_showSearchMsg(ds_list1, errCode, errMsg);
}

/********************************************************************************
* 기      능   : 닫기
********************************************************************************/
function fn_close()
{
	close();
}

//=========================================================================================
// [ PART 6 ]
// component Event 정의 : 각 Component 별 이벤트
//=========================================================================================
/********************************************************************************
* 기      능   : 원프로젝트 팝업
********************************************************************************/
function btn_pjt_OnClick(obj)
{
	var arg = "pjt="+quote(ed_pjt.Text);

	gfn_openPopup("PS9601002A",true,arg);
}

/********************************************************************************
* 기      능   : 리스트의 타이틀 클릭
********************************************************************************/
function grd_list1_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
{
	if ( nCell == 0 ) {
		return;
	}
	else if ( nCell == 1 ) {
		// 그리드 표시할 컬럼 선택
		gfn_selectAllGrid(obj,nCell,nCell,true);
	} else {
		// 그리드 정렬 처리
		gfn_sortGrid(obj,nCell);
	}
}

/********************************************************************************
* 기      능   : 프로젝트에서 엔터키 처리
********************************************************************************/
function ed_pjt_OnKeyDown(obj,nChar,bShift,bCtrl, bAlt,LLParam,HLParam)
{
}

/********************************************************************************
* 기      능   : 저장
********************************************************************************/
function fn_save()
{
	//강민석K 수정
	if (!gfn_showConfirm("CW10025","저장하시겠습니까?"))
	{
		return;
	}

	ds_save.deleteAll();
	ds_save.copyF(ds_pop);
	
	//Trace(ds_save.saveXML());
	//return;
	for(var j=0; j<ds_save.GetRowCount(); j++)
	{
		ds_save.SetColumn(j, "PSPID", substr(_P_POSID,0,6));
		ds_save.SetColumn(j, "POSID", _P_POSID);
		ds_save.SetColumn(j, "GUBUN", _P_GUBUN);
		//trace('INP_DTF : ' + ds_cond.GetColumn(0, "INP_DTF"));
		//trace('INP_DT : ' + ds_cond.GetColumn(0, "INP_DT"));
		ds_save.SetColumn(j, "INP_DT", ds_cond.GetColumn(0, "INP_DTF"));

       	if(ds_save.GetColumn(j, "COL")=="1"  && ds_save.GetColumn(j, "B_COL")=="N"){
			ds_save.SetColumn(j, "FLAG2", "I");
		} else if(ds_save.GetColumn(j, "COL")=="0" && ds_save.GetColumn(j, "B_COL")=="Y") {
			ds_save.SetColumn(j, "FLAG2", "D");
		}

		//trace('before : ' + ds_save.GetColumn(j, 'COM_CHK') + ', after : ' + ds_save.GetColumn(j, 'FIX_COM_CHK') + ', file changed : ' + ds_save.GetColumn(j, 'COM_CHK_DIFF'));
		if (ds_save.GetColumn(j, 'COM_CHK') != ds_save.GetColumn(j, 'FIX_COM_CHK') && ds_save.GetColumn(j, 'COM_CHK_DIFF') != '1') {
			ds_save.SetColumn(j, 'FLAG2', 'U');
		}
		// 1단계 안전 승인
		if(ds_save.GetColumn(j, "FLAG2") == 'I' && ds_save.GetColumn(j, "SAFE_CK") == 'X' && ds_save.GetColumn(j, "PROCESS_BY_SAFE") == 'A')
		{
			ds_save.SetColumn(j, "APPR1_YN", 'Y');
		}
		// 2단계 안전 승인
		if(ds_save.GetColumn(j, "FLAG2") == 'I' && ds_save.GetColumn(j, "SAFE_CK") == 'X' && ds_save.GetColumn(j, "PROCESS_BY_SAFE") == 'B')
		{
			ds_save.SetColumn(j, "APPR2_YN", 'Y');
		}
		// 3단계 안전 승인
		if(ds_save.GetColumn(j, "FLAG2") == 'I' && ds_save.GetColumn(j, "SAFE_CK") == 'X' && ds_save.GetColumn(j, "PROCESS_BY_SAFE") == 'C')
		{
			ds_save.SetColumn(j, "APPR3_YN", 'Y');
		}
		
		// 1단계 안전 승인취소
		if(ds_save.GetColumn(j, "FLAG2") == 'D' && ds_save.GetColumn(j, "SAFE_CK") == 'X' && ds_save.GetColumn(j, "PROCESS_BY_SAFE") == 'A')
		{
			ds_save.SetColumn(j, "APPR1_YN", 'N');
		}
		// 2단계 안전 승인취소
		if(ds_save.GetColumn(j, "FLAG2") == 'D' && ds_save.GetColumn(j, "SAFE_CK") == 'X' && ds_save.GetColumn(j, "PROCESS_BY_SAFE") == 'B')
		{
			ds_save.SetColumn(j, "APPR2_YN", 'N');
		}
		// 3단계 안전 승인취소
		if(ds_save.GetColumn(j, "FLAG2") == 'D' && ds_save.GetColumn(j, "SAFE_CK") == 'X' && ds_save.GetColumn(j, "PROCESS_BY_SAFE") == 'C')
		{
			ds_save.SetColumn(j, "APPR3_YN", 'N');
		}
		
	}

	ds_save1.deleteAll();
	ds_save.Filter("FLAG2 == 'I'");
	ds_save1.copyF(ds_save);
	ds_save.unFilter();

	ds_save2.deleteAll();
	ds_save.Filter("FLAG2 == 'D'");
	ds_save2.copyF(ds_save);
	ds_save.unFilter();
	
	ds_save_ck.deleteAll();
	ds_save.Filter("FLAG2 == 'I' && SAFE_CK == 'X' && PROCESS_BY_SAFE <> 'N'");
	ds_save_ck.copyF(ds_save);
	ds_save.unFilter();
	
	ds_save_ck2.deleteAll();
	ds_save.Filter("FLAG2 == 'D' && SAFE_CK == 'X' && PROCESS_BY_SAFE <> 'N'");
	ds_save_ck2.copyF(ds_save);
	ds_save.unFilter();
	
	//Trace(ds_save1.saveXML());
	Trace(ds_save_ck.saveXML());
	Trace(ds_save_ck2.saveXML());
	//return;
	if(ds_save1.rowcount > 0)
	{
		
		tit_clearActionInfo();
		tit_addMultiActionInfo("ps02:PS0207003C_I1");//zpst0112 -기성 체크 저장
		
		tit_callService(
			""
			, ""
			, "ds_save1=ds_save1"
			, ""
			, ""
			, ""
			, ""
			, ""
			, true  // ""
		);
		
		if(ds_save_ck.rowcount > 0)
		{
			/*
			//안전 공정 PM 승인 처리
			tit_clearActionInfo();
			tit_addMultiActionInfo("ps02:PS0209001A_U1");//zpstw1502 update
			tit_callService(
				  ""
				, ""
				, "ds_save_ck=ds_save_ck"
				, ""
				, ""
				, ""
				, ""
				, ""
				, true
			);
			*/
		}
		
	}

	if(ds_save2.rowcount > 0)
	{
		tit_clearActionInfo();
		tit_addMultiActionInfo("ps02:PS0207003C_D1");//zpst0112 - 기성 미체크 저장
		
		tit_callService(
			""
			, ""
			, "ds_save2=ds_save2"
			, ""
			, ""
			, ""
			, ""
			, ""
			, true  // ""
		);
		
		if(ds_save_ck2.rowcount > 0)
		{
			/*
			//안전 공정 PM 승인 취소 처리
			tit_clearActionInfo();
			tit_addMultiActionInfo("ps02:PS0209001A_U1");//zpstw1502 update 안전공정 PM승인 취소
			tit_callService(
				  ""
				, ""
				, "ds_save_ck=ds_save_ck2"
				, ""
				, ""
				, ""
				, ""
				, ""
				, true
			);*/
		}
	}

    F_CHK2 = 'Y'; // 저장 시 체크값 변경

	//기존 김기석K 개발 소스
	// 그리드 저장 대상 로우

	var nPos = ds_list1.GetRowPosition();

	if(nPos >= 0)
	{
		ds_list1_tmp.ClearData();
		var nAddRow = ds_list1_tmp.addRow();

		ds_list1_tmp.CopyRow(nAddRow, ds_list1, nPos);

		ds_pop_f.ClearData();

		//Trace(ds_pop_f.saveXML());
		var nSum = 0;
		for(i=0;i<ds_pop.GetRowCount();i++)
		{
			if(ds_pop.GetColumn(i, "COL") == 1 || (ds_pop.GetColumn(i, "COL") != 1 && ds_pop.GetColumn(i, "COL") != 0))
			{
				nSum += ds_pop.GetColumn(i, "PRO_R");
			}
		}

		var nProR = ds_list1_tmp.GetColumn(0, "S_PRO2");	//기존 총 합계.

		//Trace(ToNumber(nSum) - ToNumber(nProR));


		ds_list1_tmp.SetColumn(0, "S_PRO", ToNumber(nSum) - ToNumber(nProR));
		ds_list1_tmp.SetColumn(0, "INP_DT", ds_cond.GetColumn(0, "INP_DTF"));


		if(ds_list1_tmp.GetRowCount() > 0){

			tit_clearActionInfo();
			tit_addMultiActionInfo("ps02:PS0207003A_I4");
			tit_callService(
			  ""
			, ""
			, "ds_list2=ds_list1_tmp"
			, ""
			, ""
			, ""//"fn_afterSave"
			, ""
			, ""
			, true  // ""
		   );
		}
	}

	ds_save3.deleteAll();
	ds_save.Filter("FLAG2 == 'U'");
	ds_save3.copyF(ds_save);
	//trace('ds_save3 rowcount : ' + ds_save3.rowcount);
	ds_save.unFilter();
	if (ds_save3.rowcount > 0) {
		tit_clearActionInfo();
		//tit_addMultiActionInfo("ps02:PS0209001A_U1");
		tit_addSelectExActionInfo("ps02:PS0207001A_S9", "ps02:PS0207001A_I3", "ps02:PS0208001A_U4");
		tit_callService(
			  ""
			, ""
			, "ds_detail=ds_save3 ds_detail=ds_save3 ds_cond1=ds_save3"
			, ""
			, ""
			, ""	//callback
			, ""
			, ""
			, true  //sync
		);
	}

	ds_save3.deleteAll();
	ds_save.Filter("COM_CHK_DIFF == '1'");
	ds_save3.copyF(ds_save);
	ds_pop.unFilter();

	fn_picServer_save();

	fn_comCheck_save();

	fn_query();
}

/********************************************************************************
* 기      능   : 삭제 Callback
********************************************************************************/
function fn_afterDelete(errCode, errMsg)
{
}

/********************************************************************************
* 기      능   : 사무소콤보 변경시 설치PM 콤보값 생성
********************************************************************************/
function cb_zzactss_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	if(userGroup == "40" || userGroup == "30"){
		ds_cond.SetColumn(0,"ZZLIFNR",'');
	}

    if(ds_cond.GetColumn(0,"ZZACTSS") == ''){
		ds_zzlifnr.UnFilter();
    }else{
		var arr = ds_cond.GetColumn(0,"ZZACTSS");
		ds_zzlifnr.Filter("ZZACTSS ==" +quote(arr));
    }

	ds_cond_cd.SetColumn(0,"ZZACTSS",strCode);
	cb_zzpmnum.value = "";

	tit_clearActionInfo();
	tit_addSearchActionInfo("ps02:PS0201001A_S41");

	tit_callService(
		""
		, ""
		, "ds_cond_cd=ds_cond_cd"
		, "ds_zzpmnum_cd=ds_zzpmnum_cd"  // ds_pronr=ds_pronr"
		, ""
		, "fn_afterZzactssChange"
		, ""
		, ""
		, true);
}

/********************************************************************************
* 기      능   : 조회 Callback  - 사무소 변경시
********************************************************************************/
function fn_afterZzactssChange(errCode, errMsg) {
	gfn_insertEmptyRow( ds_zzpmnum_cd, G_CODE_ALL );
	cb_zzpmnum.value = "";
}

/********************************************************************************
* 기      능   : 현장 호기 리스트의 셀 클릭
********************************************************************************/
function ds_list1_OnCellClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
	lb_posid.Text = ds_list1.getColumn(nRow, "POSID");
	//협력업체 셀 클릭 시 업체정보 팝업 추가 - 2019.03.12 강민석
	//업체정보 팝업(PS0101001C) 화면을 띄우기 위해 Tab00과 Static16을 화면에 추가 함.
	//Tab00과 Static16은 화면에 실제 표시하진 않는다.

	//협력업체 정보 표시는 더블클릭 이벤트로 변경 - 2019.03.14 강민석K
	if(nCell != 4 && nCell != 5) {
		var chk = "";

		if(length(ed_pspid.Text) <= 0 && length(cb_zzactss.Value) <= 0 ){
			chk = 'N';
		}else{
			chk = 'Y';
		}

		_P_POSID = ds_list1.getColumn(nRow, "POSID");
		_P_GUBUN = ds_list1.getColumn(nRow, "ZZGUBUN");
		_P_TYPE = ds_list1.getColumn(nRow, "TYPE");
		_P_VER = ds_list1.getColumn(nRow, "VER");
		_P_SAFE = ds_list1.getColumn(nRow, "SAFE");
		_P_ZSPEC = ds_list1.getColumn(nRow, "ZSPEC");

		//trace("현재 선택한 호기 : " + _P_POSID);

		_P_CHK = chk;

		select_construction_process();
	}
}

/********************************************************************************
* 기      능   : 협력사 업체정보 팝업 표시 기능
********************************************************************************/
function fn_afterQuery2(){
	//trace("dblclick_row : " + dblclick_row);

	var LIFNR = ds_list2.GetColumn(dblclick_row, "LIFNR");
	ds_list2.Filter("LIFNR=" + quote(LIFNR));
	// ds_list2

	//trace("LIFNR : " + LIFNR);
	gfn_openPopup("PS0101001C",true);
}

/********************************************************************************
* 기      능   : 공정별 작업이름
********************************************************************************/
function ufn_makeTile(obj, value)
{
	if(length(value) > 12) value = left(value,12) + "..." ;
	obj.Text = value;
}

/********************************************************************************
* 기      능   : 공절별 작업 날짜
********************************************************************************/
function ufn_makeDate(obj, value)
{
	obj.Text = value;
}

/********************************************************************************
* 기      능   : 이미지 출력
********************************************************************************/
function ufn_getLocalImage(obj, fa_serverFileName, fa_orgFileName)
{
	//큰 이미지 표시방법 수정 - 2019.03.14 강민석K
	obj.ImageID = tit_getServerDir("PS", fa_serverFileName);//이미지 표시
	obj.UserData = fa_orgFileName;//클릭 했을 때 사용할 원본 파일명 저장
}

/********************************************************************************
* 기      능   : 이미지 출력
********************************************************************************/
function ufn_getImage(obj, fileName, idx, fa_orgFileName)
{
	//큰 이미지 표시방법 수정 - 2019.03.14 강민석K
	obj.ImageID = substr(tit_getServerDir("PS", fileName),0,idx)+substr(tit_getServerDir("PS", fileName),idx);//이미지 표시
	obj.UserData = fa_orgFileName;//클릭 했을 때 사용할 원본 파일명 저장
}

/********************************************************************************
* 기      능   : 조회 Callback  - 공정표 불러오기
********************************************************************************/
function select_construction_process()
{
	//수금전 진행상태가 'P'(진행)이 아닐경우 공정진행 입력 금지 20100820 sjy
	if(E_FLAG != 'P'  || _P_CHK == 'N'){

	}

	_P_CHK2 = 'N'; //기본 셋팅
	fn_query_process();
}

/********************************************************************************
* 기      능   : 조회 Callback  - 공정표 그리기
********************************************************************************/
function fn_query_process()
{
	gfn_clearGridSortMark(grd_pop);
	ds_pop.row = -1;//공정표 리스트의 데이터셋
	ds_pop.ClearData();

	var args = "PSPID="+quote(substr(_P_POSID,0,6));
	    args += " POSID="+quote(_P_POSID);
		args += " GUBUN="+quote(_P_GUBUN);
		args += " ZSEPC="+quote(_P_ZSPEC);
		args += " SAFE="+quote(_P_SAFE);
		args += " TYPE="+quote(_P_TYPE);
		args += " VER="+quote(_P_VER);

	var q1="";
	var q2="";
	var q3="";

	var cRow=0;

	q1	+= ", '0' COL"
		+ ", 'N' B_COL"

	//추가(안전검사관련)//
		+ ",  '" + _P_SAFE + "' SAFE"
		+ "\n ,VALUE(MIN((CASE WHEN RIGHT(R03.POSID_1, 3)='"+right(_P_POSID,3)+"' THEN "
		+ "\n (CASE  WHEN (T13.MDATE)  <> '' THEN '1' ELSE '0' END)  "
		+ "\n END)), '0') JCOL";

	q1	+= "\n ,CASE WHEN (SELECT X.LIFNR FROM SAPHEE.ZMASTER02 AS X WHERE X.MANDT = A.MANDT "
		+ "\n  AND X.POSID= '"+ SUBSTR(_P_POSID,0,6) +"' AND X.POSID_1 = '"+ _P_POSID+"') = '0000008001' THEN '1' ELSE '0' END AS DIR";

	q2 	+= "\n , VALUE(MIN((CASE WHEN RIGHT(R02.POSID_1, 3)='"+right(_P_POSID,3)+"' THEN "
		+ "\n (CASE WHEN (T12.CRDAT)='00000000' THEN '0'"
		+ "\n WHEN  (T12.CRDAT)=HEX(CURRENT DATE) THEN '1' ELSE CHAR(T12.CRDAT) END) "
		+ "\n END)), '0') COL";

	q2 += "\n , 'N' B_COL";

	//추가(안전검사관련)//
	q2  += "\n,  '" + _P_SAFE + "' SAFE"
		+ "\n ,VALUE(MIN((CASE WHEN RIGHT(R03.POSID_1, 3)='"+right(_P_POSID,3)+"' THEN "
		+ "\n (CASE  WHEN (T13.MDATE)  <> '' THEN '1' ELSE '0' END)  "
		+ "\n END)), '0') JCOL";

	q2 	+= "\n ,CASE WHEN (SELECT X.LIFNR FROM SAPHEE.ZMASTER02 AS X WHERE X.MANDT = T11.MANDT "
		+ "\n  AND X.POSID= '"+ SUBSTR(_P_POSID,0,6) +"' AND X.POSID_1 = '"+ _P_POSID +"') = '0000008001' THEN '1' ELSE '0' END AS DIR";

	q3  += "\n , T.COL"
		+ "\n , T.B_COL"
		+ "\n , T.SAFE"
		+ "\n , T.JCOL"
		+ "\n , T.DIR";

	cRow++;

	args += " S1_QUERY="+quote(q1);
	args += " S2_QUERY="+quote(q2);
	args += " S3_QUERY="+quote(q3);

	tit_clearActionInfo();
	tit_addSearchActionInfo("ps02:PS0207003B_S1");
	tit_addSearchActionInfo("ps02:PS0209003B_S2"); //NEW PS0207003B_S2
	tit_addSearchActionInfo("ps02:PS0207003B_S3");

	tit_callService(
		""
		, ""
		, ""
		, "ds_pop1=ds_pop1 ds_pop2=ds_pop2 ds_pop3=ds_pop3"
		, args
		, "fn_processAfterQuery"
		, true);
}

/********************************************************************************
* 기      능   : 조회 Callback  - fn_processAfterQuery
********************************************************************************/
function fn_processAfterQuery(errCode, errMsg)
{

	// 메시지 처리
	gfn_showSearchMsg(grd_pop);

	grd_pop.Redraw = false;

	if(ds_pop1.FindRow('UD', 'A')!='-1'){
		ds_pop.copy(ds_pop2);
	}else{
		ds_pop.copy(ds_pop1);
	}

	grd_pop.Redraw = true;
	//trace("ds_pop : \n" + ds_pop.SaveXML());

	for(var r=0; r<ds_pop.GetRowCount(); r++)
	{
		var RM_PROCESS = ds_pop.GetColumn(r, 'RM_PROCESS');
		var COL = ds_pop.GetColumn(r, 'COL');
		var JCOL = ds_pop.GetColumn(r, 'JCOL');
		var PROCESS_BY_SAFE_NUM = ds_pop.GetColumn(r, 'PROCESS_BY_SAFE_NUM');
		var F_SAFE_NUM = ds_pop.GetColumn(r, 'F_SAFE_NUM');


		//trace('RM_PROCESS : ' + RM_PROCESS);
		//trace('COL : ' + COL);
		//trace('JCOL : ' + JCOL);
		//trace('PROCESS_BY_SAFE_NUM : ' + PROCESS_BY_SAFE_NUM);
		//trace('F_SAFE_NUM : ' + F_SAFE_NUM);

		for(var c=0; c<ds_pop.GetColCount(); c++)
		{
			//trace("ds_pop GetColID : " + ds_pop.GetColID(c));
			if(left(ds_pop.GetColID(c), 3)=="COL")
			{
				//trace("ds_pop GetColumn : " + ds_pop.GetColumn(r, c));
				//if(ds_pop.GetColumn(r, c)=="1")
				if(ds_pop.GetColumn(r, c) != "0")
				{
					//trace("GetColID1 : " + ds_pop.GetColID(c));
					//trace("GetColID2 : " + "B_COL" + substr(ds_pop.GetColID(c), 3));
					ds_pop.SetColumn(r,"B_COL"+substr(ds_pop.GetColID(c), 3),"Y");
				}

				if (RM_PROCESS == '0' && COL == '0') {
					if (!(JCOL == '1')) {
						ds_pop.SetColumn(r, 'COL', '');
					}
				}
			}
		}
	}
	

	
	
	//Trace(ds_pop.saveXML());
	var endd = parseInt(grd_pop.GetColCount()) - 2 + parseInt(grd_pop.GetColCount()) - 2;
	var posid_1 = "";

	//trace("posid_1 : " + posid_1);
	//trace("cRow : " + cRow);
	//trace("endd : " + endd);
	//trace("POSID1 : " + ds_pop3.FindRow("POSID", posid_1));
	//trace("TOT_F : " + ds_pop3.GetColumn(ds_pop3.FindRow("POSID", posid_1), "TOT_F"));
	//trace("TOT_G : " + ds_pop3.GetColumn(ds_pop3.FindRow("POSID", posid_1), "TOT_G"));

	posid_1 = _P_POSID;
	grd_pop.SetCellProp("summary", 1, "Text", ds_pop3.GetColumn(ds_pop3.FindRow("POSID", posid_1), "TOT_F"));
	grd_pop.SetCellProp("summary", 2, "Text", ds_pop3.GetColumn(ds_pop3.FindRow("POSID", posid_1), "TOT_G"));

	//수금전 진행상태가 'P'(진행)이 아닐경우 공정진행 입력 금지 20100820 sjy
	if(E_FLAG != 'P'){
		grd_pop.Editable = false;
	}

	if(E_FLAG != 'P'){
		grd_pop.Editable = false;
	}

	//협력사는 조회만 가능
	if(gfn_getUserGroup()=="10"){
		grd_pop.Editable = false;
	}else{
		grd_pop.Editable = true;
	}

	//-------------------------------------------------------------------------------------
	//호기리스트에서 호기 선택 -> 공정표 표시 -> 이미지 조회 기능 추가 - 2019.03.11 강민석K
	var row = ds_cond2.AddRow();
	ds_cond2.SetColumn(0, "PSPID", substr(_P_POSID,0,6));
	ds_cond2.SetColumn(0, "POSID", _P_POSID);
	ds_cond2.SetColumn(0, "GUBUN", _P_GUBUN);
	ds_cond2.SetColumn(0, "TYPE", _P_TYPE);
	ds_cond2.SetColumn(0, "VER", _P_VER);
	//trace("선택된 ds_cond2 : " + ds_cond2.SaveXML());

	tit_clearActionInfo();
	tit_addSearchActionInfo("ps02:PS0209003A_S4");

	tit_callService(
          ""
        , ""
        , "ds_cond2=ds_cond2"
        , "ds_list5=ds_list5"
        , ""
        , "fn_afterSeletePopidInfo" // ""
        , ""
        , ""
        , true);
	//-------------------------------------------------------------------------------------
}

/********************************************************************************
* 기      능   : 조회 Callback
********************************************************************************/
function fn_afterDate(errCode, errMsg) {
}

/********************************************************************************
* 기      능   : 이미지 조회 Callback 추가 - 2019.03.11 강민석K
********************************************************************************/
function fn_afterSeletePopidInfo() {

	//trace("이미지 조회 결과 : " + ds_list5.SaveXML());

	initImage();
	if(ds_list5.GetRowCount() == 0)
	{
		//gfn_showAlert("해당 호기에 아직 완료사진이 없습니다.");
		gfn_showMsg("해당 호기에 아직 완료사진이 없습니다.");
		return;
	}

	var lastIndex = 0;
	for(var i = 0; i < ds_list5.GetRowCount(); i++)
	{
		//trace("투입일 : " + ds_list5.GetColumn(i, "EDATE"));
		//trace("공정명 : " + ds_list5.GetColumn(i, "PROWRK"));
		//trace("공정율 : " + ds_list5.GetColumn(i, "PRO_R"));
		//trace("파일명(FNAME) : " + ds_list5.GetColumn(i, "FNAME"));
		//trace("파일명(FNAME_APP) : " + ds_list5.GetColumn(i, "ORGFNAME"));

		//투입일자 static 세팅
		ufn_makeDate(eval("divImage.div_date" + (i + 1)), ds_list5.GetColumn(i, "EDATE") + " (" + ds_list5.GetColumn(i, "PRO_SUM") + "%)");

		//공정명 static 세팅
		ufn_makeTile(eval("divImage.div_pro_name" + (i + 1)), ToNumber(ds_list5.GetColumn(i, "PRONR")) + "." + ds_list5.GetColumn(i, "PROWRK"));
		

		//이미지 파일명이 있는 공정만 이미지 표시
		if(length(ds_list5.GetColumn(i, "FNAME")) != 0)
		{
			//이미지 세팅
			fa_serverFileName = ds_list5.GetColumn(i, "FNAME");//파일명
			//trace("fa_serverFileName : " + fa_serverFileName);
			//trace("ServerDir : " + tit_getServerDir("PS", fa_serverFileName));
			if(IndexOf(tit_getServerDir("PS", fa_serverFileName),'localhost') > 0) //로컬
			{
				//이미지 클릭 시 표시방법 수정 - 2019.03.14 강민석K (고범석K 요청사항)
				ufn_getLocalImage(eval("divImage.Image" + (i + 1)), fa_serverFileName, ds_list5.GetColumn(i, "ORGFNAME"));
			}else{
				//이미지 클릭 시 표시방법 수정 - 2019.03.14 강민석K (고범석K 요청사항)
				var idx = IndexOf(tit_getServerDir("PS", fa_serverFileName),'/',10); //운영
				ufn_getImage(eval("divImage.Image" + (i + 1)), fa_serverFileName, idx, ds_list5.GetColumn(i, "ORGFNAME"));
			}

			lastIndex = i + 1;
		}

		eval("divImage.div_date" + (i + 1)).Visible = true;
		eval("divImage.div_pro_name" + (i + 1)).Visible = true;
		eval("divImage.Image" + (i + 1)).Visible = true;
		
	
	}

	//trace("lastIndex : " + lastIndex);
	//마지막 공정 이후의 컨트롤들은 숨김처리
	for(var j = lastIndex + 1; j <= ds_list5.GetRowCount(); j++){
		eval("divImage.div_date" + j).Visible = false;
		eval("divImage.div_pro_name" + j).Visible = false;
		eval("divImage.Image" + j).Visible = false;
	}
	divImage.ResizeScroll();//스크롤바 표시를 동적으로 할 때 사용 -> 송광용D 가이드

	//trace("lastIndex : " + lastIndex);
	if(lastIndex != 0){
		var lastImage_Top = eval("divImage.Image" + lastIndex).Top;
		var lastImage_Height = eval("divImage.Image" + lastIndex).Height;
		//trace("lastIndex : " + lastIndex + ", lastImage_Top : " + lastImage_Top + ", lastImage_Height : " + lastImage_Height);

		divImage.SetScroll(0, lastImage_Top + lastImage_Height);
	}


}

/********************************************************************************
* 기      능   : 그리드 셀 클릭 시 이벤트
********************************************************************************/
function grd_pop_OnCellClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
	//trace("COL : " + ds_pop.GetColumn(nRow, "COL"));
	//trace("COM_CHK : " + ds_pop.GetColumn(nRow, "COM_CHK"));
	//trace("PROCESS_BY_SAFE_NUM : " + ds_pop.GetColumn(nRow, "PROCESS_BY_SAFE_NUM"));
	//trace("F_SAFE_NUM : " + ds_pop.GetColumn(nRow, "F_SAFE_NUM"));

	var curCol = grd_pop.GetCellProp("body", nCell, "COLID");

	var arrQualityPic = "";
	var arrFinishPic  = "";

	//trace("COL : " + length(ds_pop.GetColumn(nRow, "COL")));
	if (nCell == 5) //사진 이미지뷰어 띄우기
	{
	    //사진업로드를 해야하는 공정이며, 해당 공정의 샘플 이미지 파일을 조회한다.
		if (ds_pop.GetColumn(nRow, 'FINISH_PIC_YN') == 'Y')
		{
			var gubun = "N"; //서버에도 , 당일에도 사진이 없는 상태

			_UPLOAD_NROW = nRow;
			arrFinishPic = Split(ds_pop.GetColumn(nRow,'FINISH_PIC'),',');

			ds_files.ClearData();

			for (var i = 0 ; i < Length(arrFinishPic) ; i++)
			{
				ds_cond_for_file.ClearData();
				ds_cond_for_file.AddRow();
				ds_cond_for_file.SetColumn(0, "SEQNO", arrFinishPic[i]);

				tit_clearActionInfo();
				tit_addSearchActionInfo("ps02:PS0208001C_S1");  //공정별 샘플 사진정보
				tit_callService(
					""
					, ""
					, "ds_cond=ds_cond_for_file"
					, "ds_file=ds_file"
					, ""
					, "ufn_afterSelectFile"
					, true);
			}

			var argDay= "";

			//완료사진 업로드 여부 체크
			if (length( ds_pop.GetColumn(nRow, "FNAME") ) <= 0) //서버에 등록된 사진이 없을때
			{
			    //ds_cond3- 당일 이미지 뷰어팝업창에서 담은 파일 데이터셋
				var findRow = ds_cond3.FindRow("PRONR", ds_pop.GetColumn(nRow,"PRONR")); //PRONR 공정번호

				if (findRow == -1) //당일도 없다면
					gubun = "N";  //이미지 뷰어팝업창에서 샘플 이미지를 보여주고, 파일을 선택 바를 보이게 함.
			    else {   //있다면

			        if (length(ds_cond3.GetColumn(findRow, 'FNAME')) <= 0)
			        {
						gubun = "N"; //삭제처리 되었다면

						ds_cond3.deleteRow(findRow);

			        }
			        else {
						gubun = "D"; //이미지 뷰어팝업창에서 임시저장한 파일을 보이게하고, 파일선택바를 보이게  함.

						argDay = " UPLOAD_NROW=" + quote(_UPLOAD_NROW);
						argDay += " PRONR=" + quote(ds_cond3.GetColumn(findRow, 'PRONR'));
						argDay += " _P_FPATH=" + quote(ds_cond3.GetColumn(findRow, 'FPATH'));
						argDay += " _P_ORGFNAME=" + quote(ds_cond3.GetColumn(findRow, 'ORGFNAME'));
						argDay += " _P_FNAME=" + quote(ds_cond3.GetColumn(findRow, 'FNAME'));
						argDay += " _P_FSIZE=" + quote(ds_cond3.GetColumn(findRow, 'FSIZE'));
						argDay += " _P_FDATR=" + quote(ds_cond3.GetColumn(findRow, 'FDATR'));
					}
				}
			}
			else { //  있다면
			    trace( "서버에 파일이 있음 : "  + ds_pop.GetColumn(nRow, "FNAME") );
			    // ORGFNAME

			    //=========================================================================================
			    //현재 다시 재 선택 또는 삭제 변경한게 있는지 확인 한다
			    var findRow = ds_cond3.FindRow("PRONR", ds_pop.GetColumn(nRow,"PRONR")); //PRONR 공정번호

				if (findRow == -1) { //없다면

				    trace( " 현재 다시선택한 파일이 없음_COM_CHK : "  + ds_pop.GetColumn(nRow, 'COM_CHK'));

				    if(ds_pop.GetColumn(nRow, 'COM_CHK') == "1")
			        {
			            trace( " 현재 다시선택한 파일이 없음");
						gubun = "S"; //이미지 뷰어팝업창에서 파일을 선택 바를 보이게 함.
					} else {
					    gubun = "N";
					}
				}
			    else { // 있다면
					trace("서버에 있는데 현재 다시 선택 하셨습니다.  ");

					if (ds_cond3.GetColumn(findRow, 'FNAME') == "")
					{
						trace( " 현재 다시선택한 파일을 삭제하셔서 서버에 등록된 파일을 다시 보여 줍니다.");
						trace( " ds_cond3 count : " + ds_cond3.rowcount);

						gubun = "N";
					}
					else {

						trace( " 현재 다시선택한 파일을 보여 줍니다.");


						gubun = "D"; //이미지 뷰어팝업창에서 임시저장한 파일을 보이게하고, 파일선택바를 보이게  함.
						argDay = "";

						argDay = " UPLOAD_NROW=" + quote(_UPLOAD_NROW);
						argDay += " PRONR=" + quote(ds_cond3.GetColumn(findRow, 'PRONR'));
						argDay += " _P_FPATH=" + quote(ds_cond3.GetColumn(findRow, 'FPATH'));
						argDay += " _P_ORGFNAME=" + quote(ds_cond3.GetColumn(findRow, 'ORGFNAME'));
						argDay += " _P_FNAME=" + quote(ds_cond3.GetColumn(findRow, 'FNAME'));
						argDay += " _P_FSIZE=" + quote(ds_cond3.GetColumn(findRow, 'FSIZE'));
						argDay += " _P_FDATR=" + quote(ds_cond3.GetColumn(findRow, 'FDATR'));
					}
				}
			}

			//trace('nRow : ' + nRow + ', FLAG : ' + ds_pop.GetColumn(nRow,'FLAG'));
			//if ( ds_pop.GetColumn(nRow,'FLAG') != "1" ) // 완료공정 단계가 아니면
			//{
			//    gubun = "B";
			//}

			//gubun 값에 따른 arg 정리
			var arg = "GUBUN=" + quote(gubun);

			if (gubun == 'D') { // 업로드 전 당일 선택 파일이면,
				arg+= argDay;
			} else {
				arg+= " UPLOAD_NROW=" + quote(_UPLOAD_NROW);
				arg+= " PRONR=" + quote(ds_pop.GetColumn(nRow, 'PRONR'));
				arg+= " _P_FPATH=" + quote(ds_pop.GetColumn(nRow, 'FPATH'));
				arg+= " _P_ORGFNAME=" + quote(ds_pop.GetColumn(nRow, 'ORGFNAME'));
				arg+= " _P_FNAME=" + quote(ds_pop.GetColumn(nRow, 'FNAME'));
				arg+= " _P_FSIZE=" + quote(ds_pop.GetColumn(nRow, 'FSIZE'));
				arg+= " _P_FDATR=" + quote(ds_pop.GetColumn(nRow, 'FDATR'));
		    }

		    //trace("이미지 뷰(arg) ==" + arg);

		    //호출전 체크상태
		    var be_ComCheck = ds_pop.GetColumn(nRow, "COM_CHK_DIFF");

		    trace("사진선택 호출전_체크상태 : " + be_ComCheck);

			var arr = gfn_openPopupUrl("PS02::PS0208001C.xml", true, arg);

			//당일 완료공정율 계산
			trace("사진 선택 호출 후_체크상태 : " + ds_pop.GetColumn(nRow, "COM_CHK_DIFF"));
		}
	}

	if(nCell == 7 && length(ds_pop.GetColumn(nRow, "COL")) < 8){
		//trace("PROCESS_BY_SAFE_NUM : " + parseInt(ds_pop.GetColumn(nRow,'PROCESS_BY_SAFE_NUM')));
		//trace("F_SAFE_NUM : " + parseInt(ds_pop.GetColumn(nRow,'F_SAFE_NUM')));

		//trace("COL : " + ds_pop.GetColumn(nRow, "COL"));
		if(ds_pop.GetColumn(nRow, "JCOL") <> "1"){
			gfn_showMsg("완료되지 않은 공정은 기성체크 할 수 없습니다.");
			return;
		}else if(parseInt(ds_pop.GetColumn(nRow,'F_SAFE_NUM')) < parseInt(ds_pop.GetColumn(nRow,'PROCESS_BY_SAFE_NUM'))){
			gfn_showMsg("안전검사 후 완료체크 할 수 있습니다.");
			return;
		} else if (ds_pop.GetColumn(nRow, 'RM_PROCESS') == '0') {
			gfn_showMsg('안전 사진 등록에 대한 승인완료후 기성체크할 수 있습니다.');
		}
	}

	if (nCell == 6) //완료체크시
	{
		//데이터셋(ds_pop) 의 flag 값으로 체크 / 언체크 처리 합니다.
		trace('ds_pop(before) flag : ' + ds_pop.GetColumn(nRow, 'FLAG'));
		trace('ds_pop2 flag : ' + ds_pop2.GetColumn(nRow, 'FLAG'));
		ds_pop.SetColumn(nRow, "FLAG", ds_pop2.GetColumn(nRow, 'FLAG') ); //초기 조회시의 flag 값으로 다시 셋팅
		trace('ds_pop(after) flag : ' + ds_pop.GetColumn(nRow, 'FLAG'));
	} // end if nCell

	//수금전 진행상태가 'P':진행이 아닐경우 공정진행 입력 금지 20100820 sjy
	if(E_FLAG != 'P') return;

	//협력사는 조회만
	if(gfn_getUserGroup()=="10") return;

	if(left(curCol, 3)=='COL'){
		//trace("ZCHECK : " + ds_pop.GetColumn(nRow, "ZCHECK") + ", " + ds_pop.GetColumn(nRow, curCol) + ", GISUNG_CHK : " + ds_pop.GetColumn(nRow, "GISUNG_CHK"));
		if(ds_pop.GetColumn(nRow, "ZCHECK")=='X' && ds_pop.GetColumn(nRow, curCol)=='0' && ds_pop.GetColumn(nRow, "GISUNG_CHK" ) <> 'X'){
			for(var i=nRow; i>=0; i--){
				if(ds_pop.GetColumn(i, curCol)==0  &&  ( ds_pop.GetColumn(nRow, "J" + curCol ) == '1')){
					if(i!=nRow) ds_pop.SetColumn(i, curCol, '1');
					//if(i!=nRow) ds_pop.SetColumn(i, curCol,  gfn_getCurrDate());
					ufn_setTodaysVal(i, nCell, 0);
				}

				if(ds_pop.GetColumn(i-1, "ZCHECK")=='X' && i!=nRow){
					return;
				}
			}
		}else{
			ufn_setTodaysVal(nRow, nCell, ds_pop.GetColumn(nRow, curCol));
		}
	}
	//trace("COL : " + ds_pop.GetColumn(nRow, "COL"));
}

/********************************************************************************
* 기      능   : 당일 공정률 계산
********************************************************************************/
function ufn_setTodaysVal(nRow, nCell, val)
{
	if(nCell == 6){
		var curVal = ParseFloat(grd_pop.GetCellProp("summary", 2, "Text"));
		var pro_r_val = ParseFloat(ds_pop.GetColumn(nRow, "PRO_R"));

		//trace("curVal : " + curVal);
		//trace("pro_r_val : " + pro_r_val);

		if(val == 0){//기성 체크박스 체크 했을 경우
			curVal = curVal + pro_r_val;
		}else if(val == 1){//기성 체크박스 체크해제 했을 경우
			curVal = curVal - pro_r_val;
		}

		grd_pop.SetCellProp("summary", 2, "Text", curVal);
	}
}

/********************************************************************************
* 기      능   : 사진보기 버튼
********************************************************************************/
function btn_picture_OnClick(obj)
{
	if(length(_P_POSID) <> 0){//호기가 선택되었을때
		var arg = "P_POSID=" + quote(_P_POSID);
		var arr = gfn_openPopupUrl("PS02::PS0209001B.xml", true, arg);
	}else{
		gfn_showAlert("선택된 호기가 없습니다. 확인바랍니다.");
		return;
	}
}

/********************************************************************************
* 기      능   : 이미지 큰팝업 호출
********************************************************************************/
function images_onClickOpenPopup(obj,nX,nY)
{
	//PS0209001C에 이미지를 표시하던 방식을 PC의 툴을 사용하도록 수정 - 2019.03.14 강민석K (고범석K 요청사항)
	var OGRFNAME = obj.UserData;
	var FNAME = obj.ImageID;

	var idx = ufn_lastIndexOf(FNAME);
	FNAME = substr(FNAME, idx, Length(FNAME));

	if(length(OGRFNAME) > 0){
		fn_createWait("", this);

		var FilePath = "c:\\Temp" ;
		var FileExec = "c:\\Temp\\" + obj.UserData;

		saveDialog.FileName = obj.UserData;

		var rMsg = tit_fileRead(
						httpFile
						, "PS"  	// 저장 디렉토리
						, FNAME		// 서버에서 전송받을 이름
						, FilePath  // 로컬 경로
						, OGRFNAME  // 로컬 파일명
					   );
		fn_destroyWait();
		if ( rMsg[0] == "E" ) {
			if ( length(trim(rMsg[1])) > 0 ) {
				gfn_showMsg("CW10025", rMsg[1]);
			} else {
				gfn_showAlert("CW10025", "파일 다운로드에 실패하였습니다.");
			}
		} else {
			ExecShell(FileExec);
		}
	}
}

/********************************************************************************
* 기      능   : 저장 버튼
********************************************************************************/
function btn_gisung_save_OnClick(obj)
{
	if (!gfn_showConfirm("CW10025","저장하시겠습니까?")){
	 return;
    }

	if(length(_P_POSID) <> 0){//호기가 선택되었을때
		ds_save.deleteAll();
	    ds_save.copyF(ds_pop);

	    for(var j=0; j<ds_save.GetRowCount(); j++){
		    ds_save.SetColumn(j,"PSPID", substr(_P_POSID,0,6));
		    ds_save.SetColumn(j,"POSID", _P_POSID);
		    ds_save.SetColumn(j,"GUBUN", _P_GUBUN);

			if(ds_save.GetColumn(j, "COL")=="1"  && ds_save.GetColumn(j, "B_COL")=="N"){
				ds_save.SetColumn(j, "FLAG", "I");
			}else if(ds_save.GetColumn(j, "COL")=="0" && ds_save.GetColumn(j, "B_COL")=="Y"){
				ds_save.SetColumn(j, "FLAG", "D");
			}
	    }

	    ds_save1.deleteAll();
	    ds_save.Filter("FLAG == 'I'");
	    ds_save1.copyF(ds_save);
	    ds_save.unFilter();

		ds_save2.deleteAll();
		ds_save.Filter("FLAG == 'D'");
		ds_save2.copyF(ds_save);
		ds_save.unFilter();
		
		ds_save_ck.deleteAll();
	    ds_save.Filter("FLAG == 'I' && SAFE_CK == 'X'");
	    ds_save_ck.copyF(ds_save);
	    ds_save.unFilter();
	    
	    ds_save_ck2.deleteAll();
	    ds_save.Filter("FLAG == 'D' && SAFE_CK == 'X'");
	    ds_save_ck2.copyF(ds_save);
	    ds_save.unFilter();

	    if(ds_save1.rowcount > 0){
			tit_clearActionInfo();
			tit_addMultiActionInfo("ps02:PS0207003C_I1");//zpst0112
			tit_callService(
				  ""
				, ""
				, "ds_save1=ds_save1"
				, ""
				, ""
				, ""
				, ""
				, ""
				, true
			);
			
			
		}

	    if(ds_save2.rowcount > 0) {
			tit_clearActionInfo();
		    tit_addMultiActionInfo("ps02:PS0207003C_D1");//zpst0112
		    tit_callService(
				  ""
				, ""
				, "ds_save2=ds_save2"
				, ""
				, ""
				, ""
				, ""
				, ""
				, true
				);
				

		  }
		//쿼리재실행 TODO::
		select_construction_process();
	}else{
		gfn_showAlert("선택된 호기가 없습니다. 확인바랍니다.");
		return;
	}
}

/********************************************************************************
* 기      능   : 폼 사이즈가 변경될때 상단 검색항목의 shape0 컴포넌트만 width 변
********************************************************************************/
function PS0209001A_OnSize(obj,nCx,nCy,nState)
{
	//trace("PS0209001A_OnSize : "+this.width+","+this.height);

	if(this.width > 1502){
	    var chgWidth = this.width - 1502;
		Shape0.Width = 1502 + chgWidth;
	}
	else{
		Shape0.Width = 1502;
	}
}

/*******************************************************************************
* 기      능   : 협력업체 또는 작업팀장 셀을 더블클릭 시 협력업체 정보가 표시되도록 추가 - 2019.03.14 강민석K
********************************************************************************/
function grd_list1_OnCellDblClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
	if(nCell == 4 || nCell == 5) {
		dblclick_row = nRow;

		var row = ds_cond2.AddRow();
		ds_cond2.SetColumn(0, "POSID", SUBSTR(ds_list1.getColumn(nRow, "POSID"), 0, 6));
		//trace("부모창 ds_cond2 : " + ds_cond2.SaveXML());

		tit_clearActionInfo();
		tit_addSearchActionInfo("ps01:PS0101001A_S2");
		tit_callService(
			""
			, ""
			, "ds_cond=ds_cond2"
			, "ds_list2=ds_list2"
			, ""
			, "fn_afterQuery2"
			, true);
	}
}

/*******************************************************************************
* 기      능   : 키보드 방향키로 이동 시 조회되도록 추가 - 2019.03.14 강민석K
********************************************************************************/
function grd_list1_OnKeyDown(obj,nChar,bShift,bCtrl,bAlt,nLLParam,nHLParam)
{
	//trace("nChar : " + nChar);
	//trace("prev_row : " + prev_row);
	//trace("obj CurrentRow : " + obj.CurrentRow);
	//trace("obj CurrentCell : " + obj.CurrentCell);

	if(prev_row != obj.CurrentRow){
		prev_row = obj.CurrentRow;
		ds_list1_OnCellClick(obj, obj.CurrentRow, obj.CurrentCell, 'key');
	}
}

function ufn_lastIndexOf(sParmString)
{
	var j = 0;//.위치
	var k = 0;// 결과위치
	var k = 0;//.위치 -1


	while(true)
	{
		r = pos(sParmString,"/",j);

		if (r == -1)
		{
			break;
		}

		j=r+1;

	}
	k = j;

	return k;
}

function edt_lifnr_OnKeyDown(obj,nChar,bShift,bCtrl, bAlt,LLParam,HLParam)
{
	if(nChar == 13)
	{
		applyData();
	}
}

function btn_lifnr_OnClick(obj)
{
	//var arg = ds_list.GetColumn(nRow, "WRKLFN");
	var arg = 'F_ZZACTSS='+quote(ds_cond.getColumn(0, "ZZACTSS"));
	var arr = gfn_openPopup("PS0208001D", true, arg);

	if(Length(arr) > 0)
	{
		//ds_list.fireevent = false;
		ds_cond.SetColumn(0, "ZZLIFNR", arr[0]);
		ds_cond.SetColumn(0, "ZZLIFNR_NM", arr[1]);
		//ds_list.fireevent = true;
		fn_tmcd();
	}
}

function ds_cond_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{
	if(strColumnID == 'ZZLIFNR_NM')
	{
		if(length(Trim(varNewValue)) == 0)
		{
			ds_cond.SetColumn(0, "ZZLIFNR", "");
			ds_cond.SetColumn(0, "ZZLIFNR_NM", "");
			return;
		}

		// 존재하는 사업자번호 체크 (미존재시 팝업)
		nFindRow = ufn_chkLifnr(varNewValue);

		if(nFindRow < 0)	// 사업자 번호 미존재시 팝업을 띄워준다.
		{
			var arg = "";
			var arr = gfn_openPopup("PS0208001D", true, arg);

			if(Length(arr) > 0)
			{
				ds_cond.SetColumn(0, "ZZLIFNR", arr[0]);
				ds_cond.SetColumn(0, "ZZLIFNR_NM", arr[1]);
			}
		}
		else
		{
			if(nFindRow == 1)
			{
				ds_cond.SetColumn(0, "ZZLIFNR", ds_lifnr_grid.GetColumn(0, "CODE"));
				ds_cond.SetColumn(0, "ZZLIFNR_NM", ds_lifnr_grid.GetColumn(0, "CODE_NAME"));
			}
			else
			{
				var arg = "F_LIFNR_N="+quote(varNewValue);
				var arr = gfn_openPopup("PS0208001D", true, arg);

				if(Length(arr) > 0)
				{
					ds_cond.SetColumn(0, "ZZLIFNR", arr[0]);
					ds_cond.SetColumn(0, "ZZLIFNR_NM", arr[1]);
				}
			}
		}
	}
}

function ufn_chkLifnr(lifnr)
{
	var rValue = 0;

	ds_condLifnr.ClearData();
	ds_condLifnr.addRow();
	ds_condLifnr.SetColumn(0, "LIFNR", lifnr);

	tit_clearActionInfo();
	tit_addSearchActionInfo("ps02:PS0208001D_S2");
	tit_callService(
		""
		, ""
		, "ds_cond=ds_condLifnr"
		, "ds_lifnr_grid=ds_lifnr_grid"
		, ""
		, "" // fn_afterQueryC
		, ""
		, ""
		, true);

	if(ds_lifnr_grid.GetRowCount() == 0)
	{
		rValue = -1;
	}
	else
	{
		rValue = ds_lifnr_grid.GetRowCount();
	}

	return rValue;
}

/********************************************************************************
* 기      능   : 협력업체 변경시 팀장코드 재검색
********************************************************************************/
function cb_zzlifnr_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	fn_tmcd();
}

/********************************************************************************
* 기      능   : 업체별 팀장코드 함수
********************************************************************************/
function fn_tmcd()
{
    tit_clearActionInfo();
	tit_addSearchActionInfo("ps02:PS0206001A_S6");      //팀장 코드

	tit_callService(
		""
		, ""
		, "ds_cond=ds_cond"
		, "ds_tmcd=ds_tmcd"
		, ""
		, ""   //"fn_afterQueryA"
		, ""  //true
		, ""
		, true);

	 ds_zzlifnr.SetColumn(0,"PCNT" , ds_tmcd.GetColumn(0,"PCNT"));
}


/********************************************************************************
* 기      능   : ufn_afterSelectFile Sring ',' 짜른 데이터를 데이터셋에 중첩
********************************************************************************/
function ufn_afterSelectFile()
{
	ds_files.AppendDataset(ds_file);
}

function fn_picServer_save() {
    //trace("이미지뷰 선택 사진 저장 : " + ds_cond3.rowcount);
	trace('ds_cond3 : ' + ds_cond3.RowCount() + ', ds_save3 : ' + ds_save3.RowCount());
	//trace(ds_cond3.SaveXml());
	//trace(ds_save3.SaveXml());

	if (ds_cond3.rowcount > 0)
	{
	    for (var k = 0; k < ds_cond3.rowcount; k++) // =
		{
		    if (k == 0) {
		        ds_file_safe.ClearData();
		    }
            ds_file_safe.AddRow();

		    var prono = ds_cond3.GetColumn(k, "PRONR"); //공정번호

		    var _F_FILE_DIR = ds_cond3.GetColumn(k, "FPATH");
		    var _F_FILE_NAME = ds_cond3.GetColumn(k, "ORGFNAME");
			var _F_FILE_ORG_NAME = _F_FILE_NAME;
			var _F_SIZE = ds_cond3.GetColumn(k, 'FSIZE');
			var _F_DATR = ds_cond3.GetColumn(k, 'FDATR');

		    //ds_file_safe.SetColumn(k, 'FPATH', _F_FILE_DIR);
		    //ds_file_safe.SetColumn(k, 'FNAME', _F_FILE_NAME);

		    trace("fn_picServer_save_PRONR : " + prono );
		    trace("_F_FILE_DIR : " + _F_FILE_DIR );
		    trace("_F_FILE_NAME : " + _F_FILE_NAME );

		    if (_F_FILE_NAME == '') {
				var findRow = ds_save3.FindRow("PRONR", prono); //PRONR 공정번호

				ds_save3.SetColumn(findRow, "FPATH",   '');
				ds_save3.SetColumn(findRow, "FNAME",   '');
				ds_save3.SetColumn(findRow, "ORGFNAME",'');
				ds_save3.SetColumn(findRow, 'FSIZE', '0');
				ds_save3.SetColumn(findRow, 'FDATR', '');
				continue;
		    }

			var arr = tit_fileWrite(httpFile1
				, "PS"				//serverSaveDir
				, _F_FILE_DIR		//localFilePath
				, _F_FILE_NAME		//localFileName
				, _F_FILE_NAME		//sendFileName
				, ""	  			// time stamp를 붙이지 않을 경우 U 사용
				, ""
			);

			//서버송신 결과
			trace("서버 송신 결과 arr[0] : " + arr[0] + " arr[1] : " +  arr[1] + " arr[2] : " +  arr[2]);

			var _N_FILE_DIR = arr[1];
		    var _N_FILE_NAME = arr[2];

			if ( arr[0] == "S" ) {

				_send_file = true;

				//완료 데이터 셋 정보를 업데이트
				if (ds_save3.rowcount > 0)
				{
				    var findRow = ds_save3.FindRow("PRONR", prono); //PRONR 공정번호

					trace("PRONR : " + prono + " , " + " _N_FPATH: " + _N_FILE_DIR + " ,_N_FNAME: " + _N_FILE_NAME );

					ds_save3.SetColumn(findRow, "FPATH",   _N_FILE_DIR);
					ds_save3.SetColumn(findRow, "FNAME",   _N_FILE_NAME);
					ds_save3.SetColumn(findRow, "ORGFNAME",   _F_FILE_ORG_NAME);
					ds_save3.SetColumn(findRow, 'FSIZE', _F_SIZE);
					ds_save3.SetColumn(findRow, 'FDATR', _F_DATR);
				}
			}
			else  //if ( arr[0] != "S" )
			{
			    gfn_showMsg("CW00035");
				return;
			}

		}// end for
	} //end if
}

/********************************************************************************
* 기      능   : 공정표 팝업 화면에서 확인 버튼을 눌렀을 때 완료체크 항목 저장
********************************************************************************/
function fn_comCheck_save()
{
    trace("완료체크 항목 저장: start") ;

    trace("완료체크 항목 수: " + ds_save3.rowcount + " 건") ;
    trace('ds_save3 : ' + ds_save3.SaveXML());

	if (ds_save3.rowcount > 0) //완료 데이터셋이 있을때 업데이트
	{
		tit_clearActionInfo();
		tit_addMultiActionInfo("ps02:PS0208001A_U4");   //ZPSTW0304
		tit_callService(
			""
			, ""
			, "ds_cond1=ds_save3"
			, ""
			, ""
			, ""
			, ""
			, ""
			, true);

		fn_ps1205001_save();

 	}
 	trace("완료체크 항목 저장:  end") ;
}

function fn_ps1205001_save() {
	trace('start fn_ps1205001_save');
	for (var i = 0; i < ds_save3.rowcount; i++) {
		trace(i + 'PSPID : ' + ds_save3.GetColumn(i, 'PSPID'));
		trace(i + 'INP_DT : ' + ds_save3.GetColumn(i, 'INP_DT'));
		trace(i + 'POSID : ' + ds_save3.GetColumn(i, 'POSID'));
		trace(i + 'GUBUN : ' + ds_save3.GetColumn(i, 'GUBUN'));
		trace(i + 'PRONR : ' + ds_save3.GetColumn(i, 'PRONR'));
		trace(i + 'COM_CHK : ' + ds_save3.GetColumn(i, 'COM_CHK'));
		trace(i + 'FPATH : ' + ds_save3.GetColumn(i, 'FPATH'));
		trace(i + 'ORGFNAME : ' + ds_save3.GetColumn(i, 'ORGFNAME'));
		trace(i + 'FNAME : ' + ds_save3.GetColumn(i, 'FNAME'));
		trace(i + 'FSIZE : ' + ds_save3.GetColumn(i, 'FSIZE'));
		trace(i + 'FDATR : ' + ds_save3.GetColumn(i, 'FDATR'));
		trace(i + 'TYPE : ' + F_TYPE);
		trace(i + 'VER : ' + F_VER);

		ds_save3.SetColumn(i, 'TYPE', F_TYPE);
		ds_save3.SetColumn(i, 'VER', F_VER);
		tit_clearActionInfo();
		tit_addSearchActionInfo("ps12:PS1205001A_S4");
		tit_callService(
			""
			, ""
			, "ds_cond=ds_save3"
			, "ds_gbn=ds_gbn"
			, ""
			, ""
			, ""
			, ""
			, true);

		trace('detected gbn : ' + ds_gbn.GetColumn(0, 'GBN') + ', gno_step : ' + ds_gbn.GetColumn(0, 'GNO_STEP'));
		ds_save3.SetColumn(0, 'GBN', ds_gbn.GetColumn(0, 'GBN'));
		ds_save3.SetColumn(0, 'GNO', ds_gbn.GetColumn(0, 'GNO'));
		ds_save3.SetColumn(0, 'GNO_STEP', ds_gbn.GetColumn(0, 'GNO_STEP'));

		if (Length(ds_save3.GetColumn(i, 'FNAME')) == 0) {
			// 안전사진 삭제 처리
			if (ds_gbn.RowCount() > 0 && Length(ds_gbn.GetColumn(0, 'GBN')) > 0) {
				tit_clearActionInfo();
				tit_addMultiActionInfo('wb01:WB0199061A_D2');
				tit_addMultiActionInfo('wb01:WB0199061A_D1');
				tit_callService(
					""
					, ""
					, "ds_cond3=ds_save3 ds_list2_tmp=ds_save3"
					, ""
					, ""
					, ""
					, ""
					, ""
					, true);

				var gno_step = ds_gbn.GetColumn(0, 'GNO_STEP');
				if (Length(gno_step) != '') {
					var args = '';
					if (gno_step == '1') {
						args = "STEP1_DT = '00000000', STEP1_ID = '', APPR1_DT = '00000000', APPR1_ID = '', RJCT1_DESC = ''";
					} else if (gno_step == '2') {
						args = "STEP2_DT = '00000000', STEP2_ID = '', APPR2_DT = '00000000', APPR2_ID = '', RJCT2_DESC = ''";
					} else if (gno_step == '3') {
						args = "STEP3_DT = '00000000', STEP3_ID = '', APPR3_DT = '00000000', APPR3_ID = '', RJCT3_DESC = ''";
					}
					/*
					tit_clearActionInfo();
					tit_addSingleActionInfo('ps12:PS1205001A_U4');
					tit_callService(
						""
						, ""
						, "ds_list2_tmp=ds_save3"
						, ""
						, " QUERY=" + quote( args )
						, ""
						, ""
						, ""
						, true);
					*/
				}
			}
		} else
			// 안전사진 등록 처리
			if (ds_gbn.RowCount() > 0 && Length(ds_gbn.GetColumn(0, 'GBN')) > 0) {
				tit_clearActionInfo();
				tit_addSearchActionInfo("wb01:WB0199061A_S1");
				tit_callService(
					""
					, ""
					, "ds_cond=ds_save3"
					, "ds_list_safe=ds_list"
					, ""
					, ""
					, ""
					, ""
					, true);

				if (ds_list_safe.RowCount() > 0) {
					trace('안전사진 업로드 로직 시작');

					if(fn_ps1205001_checkSave()) {
						trace('체크로직 통과');

						var fileName = left(GetDate(),8)+"_"+right(GetDate(),6)+"_"+ds_list_safe.getColumn(0, "GBN")+"_"+ds_list_safe.getColumn(0, "PSPID");

						ds_list_safe.SetColumn(0, 'FPATH', ds_file_safe.GetColumn(i, 'FPATH'));
						ds_list_safe.SetColumn(0, 'FNAME', ds_file_safe.GetColumn(i, 'FNAME'));

						var arr = tit_fileWrite(httpFile1
										, "QM"
										, ds_list_safe.getColumn(0, "FPATH")
										, ds_list_safe.getColumn(0, "FNAME")
										, fileName// 실제 db에 저장될 파일 이름
										, "U"	  // time stamp를 붙이지 않을 경우 U 사용
										, "");    // ds_list_safe.getColumn(i, "CS108_QAD") );//삭제할 이전 파일명

						trace("서버 송신 결과 arr[0] : " + arr[0] + " arr[1] : " +  arr[1] + " arr[2] : " +  arr[2] + " arr[3] : " +  arr[3]);

						if ( arr[0] == "S" )
						{
							for(var i=0; i < ds_list_safe.RowCount(); i++)
							{
								ds_list_safe.setColumn(i, "FNAME_APP", arr[2]);
								ds_list_safe.setColumn(i, "FSIZE", ToNumber(arr[3]));
								ds_list_safe.setColumn(i, "FNAME", ds_list_safe.GetColumn(i, 'GBN_NM2') + '.jpg');
								ds_list_safe.setColumn(i, "GBN",   ds_gbn.GetColumn(0, 'GBN'));

								//=======update/insert (마스터)구분=================
								ds_cond3.ClearData();
								ds_cond3.AddRow();
								ds_cond3.setColumn(0, "GBN",   ds_gbn.GetColumn(0, 'GBN'));
								ds_cond3.setColumn(0, "PSPID", ds_list_safe.GetColumn(i, "PSPID"));
								ds_cond3.setColumn(0, "POSID", ds_list_safe.GetColumn(i, "POSID"));
								ds_cond3.setColumn(0, "FNAME", ds_list_safe.GetColumn(i, "FNAME"));
								ds_cond3.setColumn(0, "SO_GBN", ds_list_safe.GetColumn(i, "SO_GBN"));

								tit_clearActionInfo();
								tit_addSelectExActionInfo("wb01:WB0199061A_S4", "wb01:WB0199061A_I1", "");

								tit_callService(
									""
									, ""
									, "ds_cond3=ds_cond3"
									, ""
									, ""
									, ""
									, ""
									, ""
									, true  // ""
								);

								//디테일 INSERT
								tit_clearActionInfo();
								if (ds_chk.GetColumn(0, 'CNT') == '0') {
									tit_addMultiActionInfo("wb01:WB0199061A_I2");
								} else {
									tit_addMultiActionInfo("ps12:PS1205001A_U5");
								}
								tit_callService(
									  ""
									, ""
									, "ds_list_tmp=ds_list_safe ds_cond3=ds_list_safe"
									, ""
									, ""
									, ""
									, ""
									, ""
									, true);

								fn_ps1205001_afterSave();
							}
						}
						else if ( arr[0] != "S" )
						{
							gfn_showMsg("CW00035");
							return;
						}
					}
				}
			}
		}
	}
	//trace('end fn_ps1205001_save');
}

function fn_ps1205001_checkSave()
{
	trace('체크로직 시작');
	//타입,기종, 구분 확인별로 저장확인
	for(var i=0; i<ds_list_safe.GetRowCount(); i++)
	{
		ds_cond_safe.ClearData();
		ds_cond_safe.AddRow();
		ds_cond_safe.setColumn(0, "GBN", ds_list_safe.GetColumn(i, "GBN"));
		ds_cond_safe.setColumn(0, "PSPID", ds_list_safe.GetColumn(i, "PSPID"));
		ds_cond_safe.setColumn(0, "POSID", ds_list_safe.GetColumn(i, "POSID"));

		ds_cond_safe.setColumn(0, "TYPE", ds_list_safe.GetColumn(i,"TYPE"));
		ds_cond_safe.setColumn(0, "TYPE_CHK", ds_list_safe.GetColumn(i,"TYPE_CHK"));

 	    ds_cond_safe.setColumn(0, "GNO", ds_list_safe.GetColumn(i,"GNO"));
        ds_cond_safe.setColumn(0, "SAFE", ds_list_safe.GetColumn(i,"SAFE"));
        ds_cond_safe.setColumn(0, "SAFE_CK", ds_list_safe.GetColumn(i,"SAFE_CK"));

		ds_cond_safe.setColumn(0, "FNAME", ds_list_safe.GetColumn(i, "FNAME_TMP"));

//		tit_clearActionInfo();
//		tit_addSearchActionInfo("wb01:WB0199061A_S3");

//		tit_callService(
//			""
//			, ""
//			, "ds_cond3=ds_cond3"
//			, "ds_list3=ds_list3"
//			, ""
//			, ""
//			, ""
//			, ""
//			, true);

//		if( ds_list3.GetColumn(0, "CNT") > 0 )
//		{
//			trace("안전사진 업로드의 같은 호기에 동일한 파일이 존재합니다.");
//			return false;
//		}

		tit_clearActionInfo();
		tit_addSearchActionInfo("ps12:PS1205001A_S20");
		tit_callService(
			""
			, ""
			, "ds_cond3=ds_cond_safe"
			, "ds_chk=ds_chk"
			, ""
			, ""
			, ""
			, ""
			, true);


//		if(ds_chk.GetColumn(0,"CNT") = 0)
//		{
//			trace("안전사진 업로드 순서대로 입력해주세요.");
//			return false;
//		}
	}
	trace('체크로직 종료');

	return true;
}

function fn_ps1205001_afterSave() {

	//====================쪽지전송 시작===============================
	var arg = "";
	var param = "";
	var lv_mesgdesc = "";
	for(var i=0; i<ds_list_safe.GetRowCount(); i++)
	{
		arg += "'"+ds_list_safe.GetColumn(i,"POSID")+"'"+",";
	}
	if(substr(arg,length(arg)-1) == ",") arg = substr(arg,0,length(arg)-1);
	param = "  AND A.POSID_1 IN (" +arg+ ")";

	ds_cond_ms.ClearData();
	ds_cond_ms.AddRow();
	ds_cond_ms.setcolumn(0,"PSPID",ds_list_safe.GetColumn(0,"PSPID") );
	ds_cond_ms.SetColumn(0,"GUBUN",param);


	tit_clearActionInfo();
	tit_addSearchActionInfo("ps12:PS1205001A_S2");
	tit_callService(
		""
		, ""
		, "ds_cond_ms=ds_cond_ms"
		, "ds_trans=ds_trans"
		, ""
		, ""  //"fn_afterQuery"
		, "" //true
		, ""
		, true);


	lv_mesgdesc = arg + '\n' + '호기의 [' + ds_list_safe.GetColumn(0, "FNAME") + '] 파일이 입력되었습니다';
	for(var i=0; i<ds_trans.GetRowCount(); i++)
	{
		//if( ds_trans.GetColumn(i, "MESGACCP") == G_USER_ID)
		//{
		//	ds_trans.DeleteRow(i);
		//	i--;
		//}
		//else
		//{
			ds_trans.setcolumn(i, "MESGDESC", lv_mesgdesc);
		//}
	}

	tit_clearActionInfo();

	//tit_addSearchActionInfo("ps12:PS1205001A_I1");
	tit_addMultiActionInfo("ps12:PS1205001A_I1");

	tit_callService(
		""
		, ""
		, "ds_trans=ds_trans"
		, ""
		, ""
		, ""  //"fn_afterQuery"
		, "" //true
		, ""
		, true);

	//====================쪽지전송 끝===============================

	fn_ps1205001_query3();
}


/********************************************************************************
* 기      능   : 단계별 안전단계 자동 입력  //ZPSTW0207 , ZPSTW1502 인터페이스
********************************************************************************/
function fn_ps1205001_query3() {

	for(var i=0;  i<ds_list_safe.RowCount();  i++)
	{
		if ((ds_list_safe.GetColumn(i,"SAFE") = 'A' && ds_list_safe.GetColumn(i,"SAFE_CK") = 'X') || ds_list_safe.GetColumn(i,"GNO_STEP") == '1')
		{
			ds_list_safe.SetColumn(i,"STEP1","A");
			ds_list_safe.SetColumn(i,"GUBUN","A");
			ds_list_safe.SetColumn(i,"STEP1_DT",(gfn_getCurrDate()));

			// 1단계 등록자 ID
			ds_list_safe.SetColumn(i, "STEP1_ID", g_user_id);
			// 1단계 출처
			ds_list_safe.SetColumn(i, "DEVICE_GBN1", "S");
		}
		else if ((ds_list_safe.GetColumn(i,"SAFE") = 'B' && ds_list_safe.GetColumn(i,"SAFE_CK") = 'X') || ds_list_safe.GetColumn(i,"GNO_STEP") == '2')
		{
			ds_list_safe.SetColumn(i,"STEP2","A");
			ds_list_safe.SetColumn(i,"GUBUN","B");
			ds_list_safe.SetColumn(i,"STEP2_DT",(gfn_getCurrDate()));

			// 2단계 등록자 ID
			ds_list_safe.SetColumn(i, "STEP2_ID", g_user_id);
			// 2단계 출처
			ds_list_safe.SetColumn(i, "DEVICE_GBN2", "S");
		}
		else if ((ds_list_safe.GetColumn(i,"SAFE") = 'C' && ds_list_safe.GetColumn(i,"SAFE_CK") = 'X') || ds_list_safe.GetColumn(i,"GNO_STEP") == '3')
		{
			ds_list_safe.SetColumn(i,"STEP3","A");
			ds_list_safe.SetColumn(i,"GUBUN","C");
			ds_list_safe.SetColumn(i,"STEP3_DT",(gfn_getCurrDate()));

			// 3단계 등록자 ID
			ds_list_safe.SetColumn(i, "STEP3_ID", g_user_id);
			// 3단계 출처
			ds_list_safe.SetColumn(i, "DEVICE_GBN3", "S");
		}
	}

	fn_ps1205001_save2();
}

/********************************************************************************
* 기      능   : 저장  //ZPSTW1502
********************************************************************************/
function fn_ps1205001_save2()
{
	/*
	for(var i=0; i<ds_list_safe.RowCount();  i++)
	{
		tit_clearActionInfo();
		tit_addSelectExActionInfo("ps12:PS1205001A_S10", "ps12:PS1205001A_I2", "ps12:PS1205001A_U2");
		tit_callService(
			""
			, ""
			, "ds_list_tmp=ds_list_safe"
			, ""
			, ""
			, ""
			, ""
			, ""
			, true );
	}*/
	
	fn_ps1205001_query5();
}

/********************************************************************************
* 기      능   : 단계별 안전단계 자동 입력 //ZPSTW0207
********************************************************************************/
function fn_ps1205001_query5() {
	for(var i=0;  i<ds_list_safe.GetRowCount();  i++)
	{
		if( length(ds_list_safe.GetColumn(i,"GUBUN")) > 0)
		{
			tit_clearActionInfo();
			tit_addSelectExActionInfo("ps12:PS1205001A_S11", "ps12:PS1205001A_I3", "");
			tit_callService(
			""
		  , ""
		  , "ds_list_tmp=ds_list_safe"
		  , ""
		  , ""
		  , ""
		  , ""
		  , ""
		  , true );
		}
	}
}

/********************************************************************************
* 기      능   : 데이터셋 값 변경 시 - Flag 처리
********************************************************************************/
function ds_pop_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{
	gfn_changeFlag( obj, strColumnID, nRow, "FLAG" );
}

]]></Script>
</Window>