<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="504" Id="PS0201001J" Left="8" OnLoadCompleted="fn_OnLoadCompleted" OnUnloadCompleted="fn_OnUnloadCompleted" PidAttrib="7" Title="체크리스트작성-이미지&#32;뷰어" Top="8" Ver="1.0" Width="896" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_cond" UseClientLayout="1">
				<Contents>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
					<colinfo id="CHKDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZGUBUN" size="256" summ="default" type="STRING"/>
					<colinfo id="ZQNUM" size="256" summ="default" type="STRING"/>
					<colinfo id="CH_PER" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_file" OnRowPosChanged="ds_file_OnRowPosChanged" UseClientLayout="1">
				<Contents>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
					<colinfo id="CHKDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZGUBUN" size="256" summ="default" type="STRING"/>
					<colinfo id="CH_PER" size="256" summ="default" type="STRING"/>
					<colinfo id="ZQNUM" size="256" summ="default" type="STRING"/>
					<colinfo id="FNUM" size="256" summ="default" type="STRING"/>
					<colinfo id="FPATH" size="256" summ="default" type="STRING"/>
					<colinfo id="FNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="FNAME_APP" size="256" summ="default" type="STRING"/>
					<colinfo id="CRDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="CRTIM" size="256" summ="default" type="STRING"/>
					<colinfo id="CRNAM" size="256" summ="default" type="STRING"/>
					<colinfo id="BIGO" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_file2">
				<Contents>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
					<colinfo id="CHKDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZGUBUN" size="256" summ="default" type="STRING"/>
					<colinfo id="CH_PER" size="256" summ="default" type="STRING"/>
					<colinfo id="ZQNUM" size="256" summ="default" type="STRING"/>
					<colinfo id="FNUM" size="256" summ="default" type="STRING"/>
					<colinfo id="FPATH" size="256" summ="default" type="STRING"/>
					<colinfo id="FNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="FNAME_APP" size="256" summ="default" type="STRING"/>
					<colinfo id="CRDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="CRTIM" size="256" summ="default" type="STRING"/>
					<colinfo id="CRNAM" size="256" summ="default" type="STRING"/>
					<colinfo id="BIGO" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_temp">
				<Contents>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
					<colinfo id="CHKDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZGUBUN" size="256" summ="default" type="STRING"/>
					<colinfo id="CH_PER" size="256" summ="default" type="STRING"/>
					<colinfo id="ZQNUM" size="256" summ="default" type="STRING"/>
					<colinfo id="FNUM" size="256" summ="default" type="STRING"/>
					<colinfo id="FPATH" size="256" summ="default" type="STRING"/>
					<colinfo id="FNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="FNAME_APP" size="256" summ="default" type="STRING"/>
					<colinfo id="CRDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="CRTIM" size="256" summ="default" type="STRING"/>
					<colinfo id="CRNAM" size="256" summ="default" type="STRING"/>
					<colinfo id="BIGO" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_fileList" OnRowPosChanged="ds_file_OnRowPosChanged" UseClientLayout="1">
				<Contents>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
					<colinfo id="CHKDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZGUBUN" size="256" summ="default" type="STRING"/>
					<colinfo id="CH_PER" size="256" summ="default" type="STRING"/>
					<colinfo id="ZQNUM" size="256" summ="default" type="STRING"/>
					<colinfo id="FNUM" size="256" summ="default" type="STRING"/>
					<colinfo id="FPATH" size="256" summ="default" type="STRING"/>
					<colinfo id="FNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="FNAME_APP" size="256" summ="default" type="STRING"/>
					<colinfo id="CRDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="CRTIM" size="256" summ="default" type="STRING"/>
					<colinfo id="CRNAM" size="256" summ="default" type="STRING"/>
					<colinfo id="BIGO" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
		</Datasets>
		<FileDialog Bottom="32" Filter="All(*.*)|*.*|jpg&#32;File(*.jpg)|*.jpg|jpeg&#32;File(*.jpeg)|*.jpeg|bmp&#32;File(*.bmp)|*.jpeg|gif&#32;File(*.gif)|*.gif|pdf&#32;File(*.pdf)|*.pdf|" Height="24" Id="fileDialog" Left="960" MultiSelect="TRUE" Right="984" TabOrder="12" Top="8" Width="24"></FileDialog>
		<FileDialog Bottom="32" Filter="All(*.*)|*.*|jpg&#32;File(*.jpg)|*.jpg|jpeg&#32;File(*.jpeg)|*.jpeg|bmp&#32;File(*.bmp)|*.jpeg|gif&#32;File(*.gif)|*.gif|pdf&#32;File(*.pdf)|*.pdf|" Height="24" Id="saveDialog" Left="1008" Right="1032" TabOrder="10" Top="8" Type="Save" Width="24"></FileDialog>
		<Static Color="user5" Font="굴림,10,Bold" Height="20" Id="st_title" Left="28" TabOrder="1" Text="이미지&#32;뷰어" Top="8" VAlign="Middle" Width="192"></Static>
		<WebBrowser Border="Flat" Height="457" Id="webBrowser" Left="944" PageUrl="about:blank" Silent="True" Style="sty_ipt_form" TabOrder="2" Top="104" Visible="FALSE" Width="584"></WebBrowser>
		<Image Cursor="HAND" Font="돋움,9,Bold" Height="20" Id="img_close" Left="863" OnClick="img_close_OnClick" Static="FALSE" TabOrder="3" Text="X" Top="8" Transparent="TRUE" Width="20"></Image>
		<File Bottom="64" Height="24" Id="f_tmp" Left="960" Right="984" TabOrder="13" Top="40" Width="24"></File>
		<Grid AutoEnter="TRUE" AutoFitEndLine="Hide" AutoScrollBar="AlwaysVert" BindDataset="ds_file" BkColor2="default" BoldHead="true" Border="Flat" Bottom="316" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="220" Id="grd_list" InputPanel="FALSE" Left="8" LineColor="user20" LineType="ExHORZ" OnCellDBLClick="grd_list_OnCellDblClick" OnHeadClick="grd_list_OnHeadClick" Right="298" RowHeight="20" Style="sty_grid" TabOrder="4" TabStop="true" Top="96" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="290">
			<contents>
				<format id="Default">
					<columns>
						<col width="20"/>
						<col width="252"/>
					</columns>
					<head>
						<cell align="center" col="0" display="checkbox"/>
						<cell col="1" display="text" text="첨부파일&#32;리스트"/>
					</head>
					<body>
						<cell align="left" bkcolor2="user22" col="0" colid="CHK" display="checkbox" edit="checkbox"/>
						<cell align="left" bkcolor2="user22" col="1" colid="FNAME" display="text"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_fileAdd" ImageID="btn_sub_04" Left="154" LeftMargin="12" OnClick="btn_fileAdd_OnClick" Style="sty_btn" TabOrder="5" TabStop="FALSE" Text="파일추가" Top="72" Transparent="TRUE" Width="72"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_fileDel" ImageID="btn_sub_04" Left="227" LeftMargin="12" OnClick="btn_fileDel_OnClick" Style="sty_btn" TabOrder="6" TabStop="FALSE" Text="파일삭제" Top="72" Transparent="TRUE" Width="72"></Button>
		<Button Align="Left" ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_fileDown" ImageID="btn_sub_06" Left="8" OnClick="btn_fileDown_OnClick" Style="sty_btn" TabOrder="7" Text="&#32;&#32;&#32;파일&#32;다운로드" Top="72" Transparent="TRUE" Width="96"></Button>
		<Div Height="32" Id="div_btn" Left="-2" TabOrder="8" Text="Div0" Url="WB01::CommBtnForm.xml" Width="896">
			<Contents></Contents>
		</Div>
		<Static Font="Default,8" Height="12" Id="Static14" Left="16" TabOrder="9" Text="*&#32;PDF&#32;파일은&#32;더블클릭으로&#32;오픈하시기&#32;바랍니다." Top="41" Width="278"></Static>
		<Image Border="Flat" FillType="STRETCH" Height="457" Id="img_sitePic" Left="304" OnClick="img_sitePic_OnClick" Style="sty_ipt_form" TabOrder="10" Top="39" Width="584"></Image>
		<Static Font="Default,8" Height="12" Id="Static21" Left="16" TabOrder="11" Text="*&#32;원본이미지&#32;조회는&#32;아래&#32;리스트에서&#32;더블클릭&#32;하세요." Top="57" Width="277"></Static>
		<Static Font="Default,8,Bold" Height="12" Id="Static2" Left="16" TabOrder="12" Text="*&#32;이미지&#32;미리보기는&#32;파일&#32;확장자가" Top="329" Width="278"></Static>
		<Static Font="Default,8,Bold" Height="12" Id="Static3" Left="16" TabOrder="13" Text="&#32;&#32;bmp,&#32;jpg,&#32;gif인&#32;경우만&#32;지원합니다." Top="345" Width="278"></Static>
		<CyHttpFile Height="24" Id="httpFile" Left="1008" Top="40" Width="24"></CyHttpFile>
	</Form>
	<Script><![CDATA[#include "LIB::tit_comm_0001.js";
#include "LIB::commons.js";	// 공통 스크립트

/**
*	화면 로드
**/
var _F_FILE_DIR = "";	// 로컬에서 현재 선택한 파일 디렉토리
var _F_FILE_NAME = "";	// 로컬에서 현재 선택한 파일  명
var _F_FILE_SIZE = 0;	// 파일 사이즈
var _F_FILE_DELETE = false;
var F_SIZE = 1024 * 10096;	// 4096K

var _POSID = '';
var _CHKDAT = '';
var _ZZGUBUN = '';
var _ZQNUM = '';
var _CH_PER = '';

function fn_OnLoadCompleted(obj)
{
	_POSID = POSID;
	_CHKDAT = CHKDAT;
	_ZZGUBUN = ZZGUBUN;
	_CH_PER = CH_PER;
	_ZQNUM = ZQNUM;

	trace('POSID:' + _POSID + ', CHKDAT:' + _CHKDAT + ', ZZGUBUN:' + _ZZGUBUN + ', ZQNUM:' + _ZQNUM);

    gfn_initForm();
	gfn_initDs(ds_cond, true);

	ds_cond.SetColumn(0, 'POSID', POSID);
	ds_cond.SetColumn(0, 'CHKDAT', CHKDAT);
	ds_cond.SetColumn(0, 'ZZGUBUN', ZZGUBUN);
	ds_cond.SetColumn(0, 'CH_PER', CH_PER);
	ds_cond.SetColumn(0, 'ZQNUM', ZQNUM);

	// #첨부파일 조회
	ufn_selectFile();
}

/********************************************************************************
* 기      능   : 닫기
********************************************************************************/
function fn_close() {
	var isFileUploaded = '0';
	if (ds_file.RowCount() > 0) {
		trace('file list : ' + ds_file.RowCount());
		isFileUploaded = '1';
	}
	parent.onResume(_ZQNUM, isFileUploaded);
	close();
}

/********************************************************************************
* 기      능   : 조회 Callback
********************************************************************************/
function fn_afterQuery(errCode, errMsg) {
	trace('fn_afterQuery');
	//첨부파일 보여주기
	ufn_showImage(0);
}

/********************************************************************************
* 기      능   : 파일 다운로드
********************************************************************************/
function btn_fileDown_OnClick(obj)
{
	if(ds_file.rowcount == 0) return;

	var nRow = ds_file.rowposition;

	var svrFileName = ds_file.GetColumn(nRow, "FNAME_APP");
	var orgFileName = ds_file.GetColumn(nRow, "FNAME");
	var ext         = gfn_getFileExt(ds_file.getColumn(nRow, "FNAME"));

	saveDialog.FileName = orgFileName;
	saveDialog.Filter = "All(*.*)|*.*";	//"Acrobet Reader(*.pdf)|*.pdf|CAD Files(*.dwg)|*.dwg|";
	saveDialog.FilterIndex = "";		//decode(ext, "pdf","0", "1");
    var sRtn = saveDialog.open();

	if(sRtn != "1") return;

	var idx = ufn_lastIndexOf(saveDialog.FileName);
	var fdFileName = saveDialog.FileName;
    var fileName =  decode(idx, -1, fdFileName, substr(fdFileName, 0, ufn_lastIndexOf(fdFileName)-1));
    var localFileName = fileName + "." + ext;


	var rMsg = tit_fileRead(
		httpFile
		, "PS"			// 저장 디렉토리
		, svrFileName			// 서버에서 전송받을 이름
		, saveDialog.FilePath	// 로컬 경로
		, localFileName			// 로컬 파일명
	);

	if ( rMsg[0] == "E" ) {
		if ( length(trim(rMsg[1])) > 0 ) {
			gfn_showAlert("CW10025", rMsg[1]);
		} else {
			gfn_showAlert("CW10025", "파일 다운로드에 실패하였습니다.");
		}
	} else {
		gfn_showAlert("CW10025", "파일을 다운로드 하였습니다.");
	}
}

/********************************************************************************
* 기      능   : 파일 추가
********************************************************************************/
function btn_fileAdd_OnClick(obj)
{
	var fileName = "";

	if (ds_file.rowcount >= 30) {
		gfn_openMsgWin("추가할 수 있는 파일 개수를 초과했습니다.\n (최대 30개 저장가능)","","A");
		return;
	}

	var sRtn = fileDialog.open();

	if (sRtn == 0) return;

	if ( length(fileDialog.FilePath) == 0 || length(fileDialog.FileName) == 0 ) {
		return;
	}

	var fileSize = f_tmp.GetLength(fileDialog.FilePath + "\\" + fileDialog.FileName );
	if ( fileSize <= 0 ) {
		gfn_showAlert("CW00048");
		return;
	}

	if ( fileSize > toNumber(F_SIZE)) {
		gfn_showAlert("CW00047", "10 Mbytes" );
		return;
	}

	// 파일정보
	if (length(fileDialog.FileName) > 0)
	{
		var thumbext = fileDialog.FileName; //파일을 추가한 input 값

		thumbext = substr(thumbext, ufn_lastIndexOf(thumbext)); //확정자값 가져오기
		thumbext = ToLower(thumbext); //소문자로 변경

	    if(thumbext != "jpg" && thumbext != "jpeg" && thumbext != "png" &&  thumbext != "gif" &&  thumbext != "bmp"  && thumbext != "pdf")
	    { // 확장자를 확인
			global.FRM_BOTTOM.img_msgType.imageId = "bottom_icon_caution";
		    global.FRM_BOTTOM.st_msg.color = "yellow";
			global.FRM_BOTTOM.st_msg.value = "이미지 파일(jpg, jpeg, png, gif, bmp, pdf)만 등록 가능합니다.";
			return false;
		}
		trace('ds_file size : ' + ds_file.rowcount);
		if (ds_file.rowcount < 30) {
			ds_temp.ClearData();
			ds_temp.addRow();
			ds_temp.setColumn(0, "POSID", ds_cond.getColumn(0, "POSID"));
			ds_temp.setColumn(0, "CHKDAT", ds_cond.GetColumn(0, "CHKDAT"));
			ds_temp.setColumn(0, "ZZGUBUN", ds_cond.GetColumn(0, "ZZGUBUN"));
			ds_temp.setColumn(0, "CH_PER", ds_cond.GetColumn(0, "CH_PER"));
			ds_temp.setColumn(0, "ZQNUM", ds_cond.GetColumn(0, "ZQNUM"));
			var fnum = 1;
			if (ds_file.rowcount > 0) {
				fnum = ToInteger(ds_file.GetColumn(0, 'FNUM')) + 1;
			}
			trace('fnum : ' + fnum);
			ds_temp.setColumn(0, "FNUM", fnum);
			trace('ds_temp FNUM : ' + ds_temp.getColumn(0, "FNUM"));
			ds_temp.setColumn(0, "FNAME", fileDialog.FileName);
			ds_temp.setColumn(0, "FPATH", fileDialog.FilePath);
			if(length(ds_temp.getColumn(0, "FNAME")) != 0 && length(ds_temp.getColumn(0, "FPATH")) != 0)
			{
				fileName = ds_temp.getColumn(0, "POSID") + "_" + ds_temp.getColumn(0, "CHKDAT") + "_" + ds_temp.getColumn(0, "ZZGUBUN") + "_" + ds_temp.getColumn(0, "ZQNUM") + "_" + ds_temp.getColumn(0, "FNUM") + '_' + left(GetDate(),8) + "_" + right(GetDate(),6) + "_" + G_USER_ID + "." + gfn_getFileExt(ds_temp.getColumn(0, "FNAME"));
				trace('file name : ' + fileName);
				var arr = tit_fileWrite(httpFile
					, "PS"
					, ds_temp.getColumn(0, "FPATH")
					, ds_temp.getColumn(0, "FNAME")
					, fileName// 실제 db에 저장될 파일 이름
					, "U"	  // time stamp를 붙이지 않을 경우 U 사용
					, ds_temp.GetColumn(0,"DEL_FNAME"));    // ds_list_i.getColumn(i, "DEL_FNAME") );	//삭제할 이전 파일명
				trace('file write result : ' + arr[0]);
				if ( arr[0] == "S" ) {
					ds_temp.setColumn(0, "FNAME_APP", fileName);
				} else if ( arr[0] != "S" ) {
					gfn_showMsg("CW00035");
					return;
				}

				// 파일 추가 저장
				tit_clearActionInfo();
				tit_addSingleActionInfo("ps02:PS0201001J_I1");
				tit_callService(
					""
					, ""
					, "ds_temp=ds_temp"
					, ""
					, ""
					, "fn_afterFileAdd"
					, ""
					, ""
					,true  // ""
				);
			}
		} else {
			gfn_openMsgWin("추가할 수 있는 파일 개수를 초과했습니다.\n (최대 30개 저장가능)","","A");
			return;
		}
	}
}

/********************************************************************************
* 기      능   : 파일 삭제
********************************************************************************/
function btn_fileDel_OnClick(obj)
{
	if(ds_file.rowcount == 0) return;

	var nChkRow = ds_file.SearchRow("CHK == '1'");

	if(nChkRow < 0) return;

	for(var i=0; i<ds_file.rowcount; i++)
	{
		var sFileName = ds_file.GetColumn(i, "FNAME");
		var sChk      = ds_file.GetColumn(i, "CHK");

		if(length(sFileName) != 0 && sChk == "1")
		{
			var arr = tit_fileDelete("PS",ds_file.getColumn(i, "FNAME_APP"), false);
		}
	}

	// 체크된 파일만 삭제처리
	ds_file.Filter("CHK==1");
	ds_file2.copyF(ds_file);
	ds_file.unFilter();

	// 파일 삭제 저장
	tit_clearActionInfo();
	tit_addMultiActionInfo("ps02:PS0201001J_D1");
	tit_callService(
		""
		, ""
		, "ds_file=ds_file2"
		, ""
		, ""
		, "fn_afterFileAdd"
		, ""
		, ""
		,true  // ""
		);
}

/********************************************************************************
* 기      능   : 파일 저장,삭제 후, Callback
********************************************************************************/
function fn_afterFileAdd()
{
	ds_file.clearData();

	// 저장 후, 파일리스트 재조회
	tit_clearActionInfo();
	tit_addSearchActionInfo("ps02:PS0201001J_S1");	// 첨부파일 정보

	tit_callService(
	 ""
	, ""
	, "ds_cond=ds_cond"
	, "ds_file=ds_file"
	, ""
	, "fn_afterQuery"
	, ""
	, ""
	, true);
}

/********************************************************************************
* 기      능   : 첨부파일 그리드 헤드 클릭 시
********************************************************************************/
function grd_list_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
{
	if ( nCell == 0 ) {
		// 현재 처리할 format 기억
		gfn_selectAllGrid(obj,nCell,nCell,true);
	}
}

/********************************************************************************
* 기      능   : Row 포지션 변경 시, 그림 보여주기
********************************************************************************/
function ds_file_OnRowPosChanged(obj,nOldRow,nRow)
{
	trace('ds_file_OnRowPosChanged - nOldRow:' + nOldRow + ',nRow:' + nRow);
	// # WebBrowser에 이미지 표시
	ufn_showImage(nRow);
}

/********************************************************************************
* 기      능   : 이미지 파일일 경우 열어줌
********************************************************************************/
function ufn_isImage(fileNm) {
	var s = toUpperCase(right( fileNm, 4));
	if ( s == ".JPG" || s == ".GIF" || s == ".PNG" || s == ".BMP") {
		return true;
	} else if ( toUpperCase(right( fileNm, 5)) == ".JPEG") {
		return true;
	}

	return false;
}



/********************************************************************************
* 기      능   : 첨부파일 조회
********************************************************************************/
function ufn_selectFile()
{
	// 첨부파일 SELECT 해오기
	tit_clearActionInfo();
	tit_addSearchActionInfo("ps02:PS0201001J_S1");	// 첨부파일 정보

	tit_callService(
	 ""
	, ""
	, "ds_cond=ds_cond"
	, "ds_file=ds_file"
	, ""
	, ""
	, ""
	, ""
	, true);
}

/********************************************************************************
* 기      능   : 첨부파일 더블 클릭 시 파일오픈
********************************************************************************/
function grd_list_OnCellDblClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
	if(nCell != 0)
	{
		if( length(ds_file.getColumn(nRow, "FNAME")) > 0) {
		   // 첨부 파일 처리
		   fn_createWait("", this);

			var FilePath = "c:\\Temp" ;
			var FileExec = "c:\\Temp\\" + ds_file.getColumn(nRow, "FNAME");

			saveDialog.FileName = ds_file.getColumn(nRow, "FNAME");

			var rMsg = tit_fileRead(
				httpFile
				, "PS"  	  // 저장 디렉토리
				, ds_file.getColumn(nRow, "FNAME_APP")	// 서버에서 전송받을 이름
				, FilePath    // 로컬 경로
				, ds_file.getColumn(nRow, "FNAME")    // 로컬 파일명
			   );

			fn_destroyWait();

			if ( rMsg[0] == "E" ) {
				if ( length(trim(rMsg[1])) > 0 ) {
				  //  ExecShell(FileExec);
					gfn_showAlert("CW10025", rMsg[1]);
				} else {

					gfn_showAlert("CW10025", "파일 다운로드에 실패하였습니다.");
				}
			} else {
				ExecShell(FileExec);
			}
		}
	}
}

function fn_OnUnloadCompleted(obj) {
	return gfn_isFormUnload(obj);
}

function ufn_showImage(nRow)
{
	img_sitePic.ImageID = "";

	//webBrowser.pageUrl = "about:blank";
	//WebBrowser.run();

	if(ds_file.rowcount == 0) return;
	if(nRow < 0) return;


	var sServerDir      =  "PS";
	var sLocalFileName  =  ds_file.GetColumn(nRow, "FNAME");
	var sLocalFileDir  =  ds_file.GetColumn(nRow, "FPATH");

	var sServerFileName =  ds_file.GetColumn(nRow, "FNAME_APP");

	if ( length( sServerFileName) > 0) {
		if( ufn_isImage( sServerFileName )  ) {
			img_sitePic.ImageID = tit_getServerDir(sServerDir, sServerFileName);
			//trace(tit_getServerDir(sServerDir, sServerFileName));
			//webBrowser.pageUrl = tit_getServerDir(sServerDir, sServerFileName);
			//WebBrowser.run();
		}
	}
}

function ufn_lastIndexOf(sParmString)
{
	var j = 0;//.위치
	var k = 0;// 결과위치
	var k = 0;//.위치 -1


	while(true)
	{
		r = pos(sParmString,".",j);

		if (r == -1)
		{
			break;
		}

		j=r+1;

	}
	k = j;

	return k;
}

function img_sitePic_OnClick(obj,nX,nY)
{

}
]]></Script>
</Window>