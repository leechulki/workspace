<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="562" Id="PS0205001A" Left="8" OnLoadCompleted="fn_OnLoadCompleted" OnUnloadCompleted="fn_OnUnloadCompleted" PidAttrib="7" Title="협력사&#32;일일&#32;작업내역" Top="8" Ver="1.0" Width="978" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_cond">
				<Contents>
					<colinfo id="PSPID" size="255" type="STRING"/>
					<colinfo id="ZZLIFNR" size="256" type="STRING"/>
					<colinfo id="SO2" size="256" type="STRING"/>
					<colinfo id="SO3" size="256" type="STRING"/>
					<colinfo id="SO4" size="256" type="STRING"/>
					<colinfo id="SO5" size="256" type="STRING"/>
					<colinfo id="INP_DT" size="256" type="STRING"/>
					<colinfo id="ZZACTSS" size="256" type="STRING"/>
					<colinfo id="SO6" size="256" type="STRING"/>
					<colinfo id="CURR_DATE" size="256" type="STRING"/>
					<colinfo id="G_USER_ID" size="256" type="STRING"/>
					<record>
						<CURR_DATE></CURR_DATE>
						<G_USER_ID></G_USER_ID>
						<INP_DT></INP_DT>
						<PSPID></PSPID>
						<SO2></SO2>
						<SO3></SO3>
						<SO4></SO4>
						<SO5></SO5>
						<SO6></SO6>
						<ZZACTSS></ZZACTSS>
						<ZZLIFNR></ZZLIFNR>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_head">
				<Contents>
					<colinfo id="CEO" size="20" type="STRING"/>
					<colinfo id="ALL_MAN" size="24" type="STRING"/>
					<colinfo id="D_MAN" size="24" type="STRING"/>
					<colinfo id="S_MAN" size="24" type="STRING"/>
					<colinfo id="P_SITE" size="24" type="STRING"/>
					<colinfo id="P_CNT" size="90" type="STRING"/>
					<colinfo id="VDATU" size="256" type="STRING"/>
					<colinfo id="F_DATE" size="256" type="STRING"/>
					<colinfo id="T_DATE" size="256" type="STRING"/>
					<colinfo id="SITE_NM" size="256" type="STRING"/>
					<colinfo id="KUNNR" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset CanRowPosChange="ds_list1_CanRowPosChange" DataSetType="Dataset" Id="ds_list1">
				<Contents>
					<colinfo id="POSID" size="256" type="STRING"/>
					<colinfo id="ZSPEC1" size="256" type="STRING"/>
					<colinfo id="ZSPEC2" size="256" type="STRING"/>
					<colinfo id="ZZSHIP1" size="256" type="STRING"/>
					<colinfo id="ZZCOMP2" size="256" type="STRING"/>
					<colinfo id="PMCD" size="256" type="STRING"/>
					<colinfo id="TMCD" size="256" type="STRING"/>
					<colinfo id="PERNO1" size="256" type="STRING"/>
					<colinfo id="PERNO2" size="256" type="STRING"/>
					<colinfo id="PERNO3" size="256" type="STRING"/>
					<colinfo id="PERNO4" size="256" type="STRING"/>
					<colinfo id="PERNO5" size="256" type="STRING"/>
					<colinfo id="MI_PERNO" size="256" type="STRING"/>
					<colinfo id="PER_SUM" size="256" type="STRING"/>
					<colinfo id="FIR_DT" size="256" type="STRING"/>
					<colinfo id="PRONR" size="256" type="STRING"/>
					<colinfo id="PRO_R" size="256" type="STRING"/>
					<colinfo id="PSPID" size="256" type="STRING"/>
					<colinfo id="INP_DT" size="256" type="STRING"/>
					<colinfo id="LIFNR" size="256" type="STRING"/>
					<colinfo id="ZZGUBUN" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_zzlifnr">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
					<colinfo id="SORTL" size="256" type="STRING"/>
					<colinfo id="LOEVM" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset CanRowPosChange="ds_list2_CanRowPosChange" DataSetType="Dataset" Id="ds_list2">
				<Contents>
					<colinfo id="POSID" size="256" type="STRING"/>
					<colinfo id="ZSPEC1" size="256" type="STRING"/>
					<colinfo id="ZSPEC2" size="256" type="STRING"/>
					<colinfo id="ZZSHIP1" size="256" type="STRING"/>
					<colinfo id="ZZCOMP2" size="256" type="STRING"/>
					<colinfo id="PMCD" size="256" type="STRING"/>
					<colinfo id="TMCD" size="256" type="STRING"/>
					<colinfo id="PERNO1" size="256" type="STRING"/>
					<colinfo id="PERNO2" size="256" type="STRING"/>
					<colinfo id="PERNO3" size="256" type="STRING"/>
					<colinfo id="PERNO4" size="256" type="STRING"/>
					<colinfo id="PERNO5" size="256" type="STRING"/>
					<colinfo id="MI_PERNO" size="256" type="STRING"/>
					<colinfo id="PER_SUM" size="256" type="STRING"/>
					<colinfo id="FIR_DT" size="256" type="STRING"/>
					<colinfo id="PRONR" size="256" type="STRING"/>
					<colinfo id="PRO_R" size="256" type="STRING"/>
					<colinfo id="PSPID" size="256" type="STRING"/>
					<colinfo id="INP_DT" size="256" type="STRING"/>
					<colinfo id="LIFNR" size="256" type="STRING"/>
					<colinfo id="ZSAFE" size="256" type="STRING"/>
					<colinfo id="ZINSP" size="256" type="STRING"/>
					<colinfo id="ZWORK" size="256" type="STRING"/>
					<colinfo id="ZWERP" size="256" type="STRING"/>
					<colinfo id="BIGO" size="256" type="STRING"/>
					<colinfo id="ZZGUBUN" size="256" type="STRING"/>
					<record>
						<BIGO></BIGO>
						<FIR_DT></FIR_DT>
						<INP_DT></INP_DT>
						<LIFNR></LIFNR>
						<MI_PERNO></MI_PERNO>
						<PER_SUM></PER_SUM>
						<PERNO1></PERNO1>
						<PERNO2></PERNO2>
						<PERNO3></PERNO3>
						<PERNO4></PERNO4>
						<PERNO5></PERNO5>
						<PMCD></PMCD>
						<POSID></POSID>
						<PRO_R></PRO_R>
						<PRONR></PRONR>
						<PSPID></PSPID>
						<TMCD></TMCD>
						<ZINSP></ZINSP>
						<ZSAFE></ZSAFE>
						<ZSPEC1></ZSPEC1>
						<ZSPEC2></ZSPEC2>
						<ZWERP></ZWERP>
						<ZWORK></ZWORK>
						<ZZCOMP2></ZZCOMP2>
						<ZZGUBUN></ZZGUBUN>
						<ZZSHIP1></ZZSHIP1>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_pmcd">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NM" size="256" type="STRING"/>
					<colinfo id="RETIF" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_tmcd">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NM" size="256" type="STRING"/>
					<colinfo id="LIFNR" size="256" type="STRING"/>
					<colinfo id="DELEF" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_perno">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NM" size="256" type="STRING"/>
					<colinfo id="LIFNR" size="256" type="STRING"/>
					<colinfo id="RETIF" size="256" type="STRING"/>
					<colinfo id="TEMNO" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_pronr">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NM" size="256" type="STRING"/>
					<colinfo id="ZZGUBUN" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_persum">
				<Contents>
					<colinfo id="CNT" size="256" type="STRING"/>
					<colinfo id="NAME" size="256" type="STRING"/>
					<record>
						<CNT>0</CNT>
						<NAME>0명</NAME>
					</record>
					<record>
						<CNT>0.5</CNT>
						<NAME>0.5명</NAME>
					</record>
					<record>
						<CNT>1</CNT>
						<NAME>1명</NAME>
					</record>
					<record>
						<CNT>2</CNT>
						<NAME>2명</NAME>
					</record>
					<record>
						<CNT>3</CNT>
						<NAME>3명</NAME>
					</record>
					<record>
						<CNT>4</CNT>
						<NAME>4명</NAME>
					</record>
					<record>
						<CNT>5</CNT>
						<NAME>5명</NAME>
					</record>
					<record>
						<CNT>6</CNT>
						<NAME>6명</NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list1_tmp">
				<Contents>
					<colinfo id="POSID" size="256" type="STRING"/>
					<colinfo id="ZSPEC1" size="256" type="STRING"/>
					<colinfo id="ZSPEC2" size="256" type="STRING"/>
					<colinfo id="ZZSHIP1" size="256" type="STRING"/>
					<colinfo id="ZZCOMP2" size="256" type="STRING"/>
					<colinfo id="PMCD" size="256" type="STRING"/>
					<colinfo id="TMCD" size="256" type="STRING"/>
					<colinfo id="PERNO1" size="256" type="STRING"/>
					<colinfo id="PERNO2" size="256" type="STRING"/>
					<colinfo id="PERNO3" size="256" type="STRING"/>
					<colinfo id="PERNO4" size="256" type="STRING"/>
					<colinfo id="PERNO5" size="256" type="STRING"/>
					<colinfo id="MI_PERNO" size="256" type="STRING"/>
					<colinfo id="PER_SUM" size="256" type="STRING"/>
					<colinfo id="FIR_DT" size="256" type="STRING"/>
					<colinfo id="PRONR" size="256" type="STRING"/>
					<colinfo id="PRO_R" size="256" type="STRING"/>
					<colinfo id="PSPID" size="256" type="STRING"/>
					<colinfo id="INP_DT" size="256" type="STRING"/>
					<colinfo id="LIFNR" size="256" type="STRING"/>
					<colinfo id="ZZGUBUN" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list2_tmp">
				<Contents>
					<colinfo id="POSID" size="256" type="STRING"/>
					<colinfo id="ZSPEC1" size="256" type="STRING"/>
					<colinfo id="ZSPEC2" size="256" type="STRING"/>
					<colinfo id="ZZSHIP1" size="256" type="STRING"/>
					<colinfo id="ZZCOMP2" size="256" type="STRING"/>
					<colinfo id="PMCD" size="256" type="STRING"/>
					<colinfo id="TMCD" size="256" type="STRING"/>
					<colinfo id="PERNO1" size="256" type="STRING"/>
					<colinfo id="PERNO2" size="256" type="STRING"/>
					<colinfo id="PERNO3" size="256" type="STRING"/>
					<colinfo id="PERNO4" size="256" type="STRING"/>
					<colinfo id="PERNO5" size="256" type="STRING"/>
					<colinfo id="MI_PERNO" size="256" type="STRING"/>
					<colinfo id="PER_SUM" size="256" type="STRING"/>
					<colinfo id="FIR_DT" size="256" type="STRING"/>
					<colinfo id="PRONR" size="256" type="STRING"/>
					<colinfo id="PRO_R" size="256" type="STRING"/>
					<colinfo id="PSPID" size="256" type="STRING"/>
					<colinfo id="INP_DT" size="256" type="STRING"/>
					<colinfo id="LIFNR" size="256" type="STRING"/>
					<colinfo id="ZSAFE" size="256" type="STRING"/>
					<colinfo id="ZINSP" size="256" type="STRING"/>
					<colinfo id="ZWORK" size="256" type="STRING"/>
					<colinfo id="ZWERP" size="256" type="STRING"/>
					<colinfo id="BIGO" size="256" type="STRING"/>
					<colinfo id="ZZGUBUN" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_zsafe">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NM" size="256" type="STRING"/>
					<record>
						<CODE>0</CODE>
						<CODE_NM>없음</CODE_NM>
					</record>
					<record>
						<CODE>1</CODE>
						<CODE_NM>사망</CODE_NM>
					</record>
					<record>
						<CODE>2</CODE>
						<CODE_NM>부상</CODE_NM>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_zinsp">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NM" size="256" type="STRING"/>
					<record>
						<CODE>0</CODE>
						<CODE_NM>양호</CODE_NM>
					</record>
					<record>
						<CODE>1</CODE>
						<CODE_NM>불량</CODE_NM>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_zwork">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NM" size="256" type="STRING"/>
					<record>
						<CODE>0</CODE>
						<CODE_NM>양호</CODE_NM>
					</record>
					<record>
						<CODE>1</CODE>
						<CODE_NM>불량</CODE_NM>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_zwerp">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NM" size="256" type="STRING"/>
					<record>
						<CODE>0</CODE>
						<CODE_NM>양호</CODE_NM>
					</record>
					<record>
						<CODE>1</CODE>
						<CODE_NM>불량</CODE_NM>
					</record>
				</Contents>
			</Dataset>
		</Datasets>
		<Shape BKColor="user0" Bottom="32" Height="32" Id="Shape0" Left="0" LineColor="user1" Right="978" TabOrder="1" Top="0" Type="Rectangle" Width="978"></Shape>
		<Static Align="Right" DomainID="com.pjtno" Height="20" Id="st_pjt" Left="504" Style="sty_lb_search" TabOrder="2" Text="프로젝트번호&#32;" Top="5" VAlign="Middle" Width="92"></Static>
		<Edit BindDataset="ds_cond" Border="Flat" CheckLength="Byte" Column="PSPID" Height="20" Id="ed_pspid" ImeMode="english" Left="597" MaxLength="6" Style="sty_ipt_search" TabOrder="3" Top="5" UpperOnly="TRUE" Width="78"></Edit>
		<Button Height="18" Id="Button0" ImageID="btn_icon_search" Left="677" OnClick="btn_pjt_OnClick" TabOrder="4" Text="Button0" Top="6" Width="18"></Button>
		<Shape BKColor="user12" Bottom="64" Height="26" Id="Shape9" Left="9" LineColor="user13" Right="967" TabOrder="5" Top="38" Type="Rectangle" Width="958"></Shape>
		<Static Align="Right" Height="24" Id="Static30" Left="10" Style="sty_lb_form_basic" TabOrder="6" Text="프로젝트명&#32;" Top="39" VAlign="Middle" Width="98"></Static>
		<Shape BKColor="user12" Bottom="89" Height="26" Id="Shape1" Left="9" LineColor="user13" Right="967" TabOrder="7" Top="63" Type="Rectangle" Width="958"></Shape>
		<Static Align="Right" Height="24" Id="Static1" Left="10" Style="sty_lb_form_basic" TabOrder="8" Text="전체인원&#32;" Top="64" VAlign="Middle" Width="98"></Static>
		<Static Align="Right" Height="24" Id="Static2" Left="249" Style="sty_lb_form_basic" TabOrder="9" Text="직업인원&#32;" Top="64" VAlign="Middle" Width="98"></Static>
		<Static Align="Right" Height="24" Id="Static3" Left="467" Style="sty_lb_form_basic" TabOrder="10" Text="간접인원&#32;" Top="64" VAlign="Middle" Width="98"></Static>
		<Shape BKColor="user12" Bottom="114" Height="26" Id="Shape2" Left="9" LineColor="user13" Right="967" TabOrder="11" Top="88" Type="Rectangle" Width="958"></Shape>
		<Static Align="Right" Height="24" Id="Static5" Left="10" Style="sty_lb_form_basic" TabOrder="12" Text="진행현장수&#32;" Top="89" VAlign="Middle" Width="98"></Static>
		<Edit BindDataset="ds_head" Border="Flat" Column="SITE_NM" Height="20" Id="ed_sitenm" Left="110" LeftMargin="4" Readonly="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="14" Top="41" Width="354"></Edit>
		<Edit Align="RIGHT" BindDataset="ds_head" Border="Flat" Column="S_MAN" Height="20" Id="ed_sman" Left="567" LeftMargin="4" Readonly="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="13" Top="67" Width="94"></Edit>
		<Edit Align="RIGHT" BindDataset="ds_head" Border="Flat" Column="P_SITE" Height="20" Id="ed_site" Left="110" LeftMargin="4" Readonly="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="15" Top="91" Width="94"></Edit>
		<Static Align="Right" Height="24" Id="Static6" Left="467" Style="sty_lb_form_basic" TabOrder="16" Text="대표자&#32;" Top="39" VAlign="Middle" Width="98"></Static>
		<Edit BindDataset="ds_head" Border="Flat" Column="CEO" Height="20" Id="ed_ceo" Left="567" LeftMargin="4" Readonly="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="17" Top="42" Width="94"></Edit>
		<Edit Align="RIGHT" BindDataset="ds_head" Border="Flat" Column="D_MAN" Height="20" Id="ed_dman" Left="349" LeftMargin="4" Readonly="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="18" Top="67" Width="94"></Edit>
		<Edit Align="RIGHT" BindDataset="ds_head" Border="Flat" Column="ALL_MAN" Height="20" Id="ed_allman" Left="110" LeftMargin="4" Readonly="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="19" Top="67" Width="94"></Edit>
		<Static Align="Right" Height="24" Id="Static14" Left="249" Style="sty_lb_form_basic" TabOrder="20" Text="진행대수&#32;" Top="89" VAlign="Middle" Width="98"></Static>
		<Edit Align="RIGHT" BindDataset="ds_head" Border="Flat" Column="P_CNT" Height="20" Id="ed_cnt" Left="349" LeftMargin="4" Readonly="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="21" Top="91" Width="94"></Edit>
		<Tab Border="Flat" Font="굴림,9" Height="438" Id="Tab00" Left="5" MouseOverColor="user16" OnChanged="Tab00_OnChanged" SelColor="user15" SelectFont="굴림,9" Style="sty_tab" TabOrder="22" Top="120" Width="966">
			<Contents>
				<TabPage BorderColor="black" Height="412" Id="tab1" ImageID="tab_form_04" Left="2" TabOrder="19" Text="미입력분" Top="24" Width="962">
					<Grid AreaSelect="TRUE" AutoFitEndLine="Hide" BindDataset="ds_list1" BkColor2="default" BoldHead="true" Border="Flat" Bottom="407" CellMoving="TRUE" ColSelect="TRUE" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="407" Id="grd_list1" InputPanel="FALSE" Left="1" LineColor="user20" LineType="ExHORZ" OnHeadClick="Tab00_tab1_grd_list1_OnHeadClick" Right="961" RowHeight="20" Style="sty_grid" TabOrder="1" TabStop="true" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="960">
						<contents>
							<format id="Default">
								<columns>
									<col fix="left" width="30"/>
									<col fix="left" width="20"/>
									<col fix="left" width="70"/>
									<col fix="left" width="85"/>
									<col fix="left" width="118"/>
									<col width="70"/>
									<col width="70"/>
									<col width="77"/>
									<col width="70"/>
									<col width="60"/>
									<col width="60"/>
									<col width="60"/>
									<col width="60"/>
									<col width="60"/>
									<col width="222"/>
									<col width="62"/>
									<col width="70"/>
									<col width="130"/>
									<col width="60"/>
									<col width="81"/>
									<col width="106"/>
									<col width="0"/>
								</columns>
								<head>
									<cell bkimageid="icon_grid_sel" col="0" display="text"/>
									<cell align="center" col="1" color="user21" display="checkbox" font="굴림,9"/>
									<cell align="center" col="2" color="user21" display="text" font="굴림,9" text="호기"/>
									<cell align="center" col="3" color="user21" display="text" font="굴림,9" text="기종"/>
									<cell align="center" col="4" color="user21" display="text" font="굴림,9" text="사양"/>
									<cell align="center" col="5" color="user21" display="text" font="굴림,9" text="착공예정일"/>
									<cell align="center" col="6" color="user21" display="text" font="굴림,9" text="준공예정일"/>
									<cell align="center" col="7" color="user21" display="text" font="굴림,9" text="PM"/>
									<cell align="center" col="8" color="user21" display="text" font="굴림,9" text="팀장"/>
									<cell align="center" col="9" color="user21" display="text" font="굴림,9" text="사원1"/>
									<cell align="center" col="10" color="user21" display="text" font="굴림,9" text="사원2"/>
									<cell align="center" col="11" color="user21" display="text" font="굴림,9" text="사원3"/>
									<cell align="center" col="12" color="user21" display="text" font="굴림,9" text="사원4"/>
									<cell align="center" col="13" color="user21" display="text" font="굴림,9" text="사원5"/>
									<cell align="center" col="14" color="user21" display="text" font="굴림,9" text="미등록인원"/>
									<cell align="center" col="15" color="user21" display="text" font="굴림,9" text="인원소개"/>
									<cell align="center" col="16" color="user21" display="text" font="굴림,9" text="최초투입일"/>
									<cell align="center" col="17" color="user21" display="text" font="굴림,9" text="작업공정입력"/>
									<cell align="center" col="18" color="user21" display="text" font="굴림,9" text="공정율(%)"/>
									<cell align="center" col="19" color="user21" display="text" font="굴림,9" text="투입일"/>
									<cell align="center" col="20" color="user21" display="text" font="굴림,9" text="협력업체코드"/>
									<cell align="center" col="21" color="user21" display="text" font="굴림,9" text="구분"/>
								</head>
								<body>
									<cell align="center" col="0" display="text" expr="currow&#32;+&#32;1"/>
									<cell align="center" col="1" colid="CHECK" display="checkbox" edit="checkbox"/>
									<cell align="center" bkcolor2="user22" col="2" colid="POSID" display="text"/>
									<cell align="center" bkcolor2="user22" col="3" colid="ZSPEC1" display="text"/>
									<cell bkcolor2="user22" col="4" colid="ZSPEC2" display="text"/>
									<cell align="center" bkcolor2="user22" col="5" colid="ZZSHIP1" display="text" Mask="####.##.##"/>
									<cell align="center" bkcolor2="user22" col="6" colid="ZZCOMP2" display="text" Mask="####.##.##"/>
									<cell align="center" bkcolor2="user22" col="7" colid="PMCD" combocol="CODE" combodataset="ds_pmcd" combotext="CODE_NM" display="combo"/>
									<cell align="center" bkcolor2="user22" col="8" colid="TMCD" combocol="CODE" combodataset="ds_tmcd" combotext="CODE_NM" display="combo"/>
									<cell bkcolor2="user22" bkimagealign="right" bkimageid="icon_grid_edit" col="9" colid="PERNO1" combocol="CODE" combodataset="ds_perno" combotext="CODE_NM" display="combo" edit="combo"/>
									<cell bkcolor2="user22" bkimagealign="right" bkimageid="icon_grid_edit" col="10" colid="PERNO2" combocol="CODE" combodataset="ds_perno" combotext="CODE_NM" display="combo" edit="combo"/>
									<cell bkcolor2="user22" bkimagealign="right" bkimageid="icon_grid_edit" col="11" colid="PERNO3" combocol="CODE" combodataset="ds_perno" combotext="CODE_NM" display="combo" edit="combo"/>
									<cell bkcolor2="user22" bkimagealign="right" bkimageid="icon_grid_edit" col="12" colid="PERNO4" combocol="CODE" combodataset="ds_perno" combotext="CODE_NM" display="combo" edit="combo"/>
									<cell bkcolor2="user22" bkimagealign="right" bkimageid="icon_grid_edit" col="13" colid="PERNO5" combocol="CODE" combodataset="ds_perno" combotext="CODE_NM" display="combo" edit="combo"/>
									<cell bkcolor2="user22" bkimagealign="right" bkimageid="icon_grid_edit" col="14" colid="MI_PERNO" display="text" edit="normal"/>
									<cell align="center" bkcolor2="user22" bkimagealign="right" bkimageid="icon_grid_edit" col="15" colid="PER_SUM" combocol="CNT" combodataset="ds_persum" combodisplayrowcnt="6" combotext="NAME" display="combo" edit="combo"/>
									<cell align="center" bkcolor2="user22" col="16" colid="FIR_DT" display="text" Mask="####.##.##"/>
									<cell align="center" bkcolor2="user22" bkimagealign="right" bkimageid="icon_grid_edit" col="17" colid="PRONR" combocol="CODE" combodataset="ds_pronr" combotext="CODE_NM" display="combo" edit="combo"/>
									<cell align="right" bkcolor2="user22" col="18" colid="PRO_R" display="number" Mask="##0.00"/>
									<cell align="center" bkcolor2="user22" col="19" colid="INP_DT" display="text" Mask="####.##.##"/>
									<cell align="center" bkcolor2="user22" col="20" colid="LIFNR" display="text"/>
									<cell align="center" bkcolor2="user22" col="21" colid="ZZGUBUN" display="text"/>
								</body>
								<summary>
									<cell bkcolor="user25" col="0" color="user26" colspan="18" display="text">
										<cell align="center" col="0" color="user26" colspan="16" display="text" domainid="com.avg" text="평균"/>
										<cell align="right" col="15" color="user26" colspan="11" display="text"/>
										<cell align="right" col="16" color="user26" colspan="11" display="text"/>
										<cell align="right" col="17" color="user26" colspan="11" display="text"/>
									</cell>
									<cell align="right" bkcolor="user25" col="18" color="user26" display="number" expr='sum(&quot;PRO_R&quot;)/parseInt(ds_list1.rowcount)' Mask="##0.00"/>
									<cell bkcolor="user25" col="19" color="user26" colspan="2" display="text">
										<cell align="right" col="19" color="user26" colspan="11" display="text"/>
										<cell align="center" col="20" color="user26" colspan="16" display="text" domainid="com.avg" text="평균"/>
									</cell>
									<cell bkcolor="user25" col="21" color="user26" display="text">
										<cell align="center" col="0" color="user26" colspan="16" display="text" domainid="com.avg" text="평균"/>
										<cell align="right" col="15" color="user26" colspan="11" display="text"/>
										<cell align="right" col="16" color="user26" colspan="11" display="text"/>
										<cell align="right" col="17" color="user26" colspan="11" display="text"/>
									</cell>
								</summary>
							</format>
						</contents>
					</Grid>
				</TabPage>
				<TabPage BorderColor="black" Height="412" Id="tab2" ImageID="tab_form_04" Left="2" TabOrder="26" Text="입력분" Top="24" Width="962">
					<Grid AreaSelect="TRUE" AutoFitEndLine="Hide" BindDataset="ds_list2" BkColor2="default" BoldHead="true" Border="Flat" Bottom="407" CellMoving="TRUE" ColSelect="TRUE" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="407" Id="grd_list2" InputPanel="FALSE" Left="1" LineColor="user20" LineType="ExHORZ" OnHeadClick="Tab00_tab2_grd_list2_OnHeadClick" Right="961" RowHeight="20" Style="sty_grid" TabOrder="1" TabStop="true" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="960">
						<contents>
							<format id="Default">
								<columns>
									<col fix="left" width="30"/>
									<col fix="left" width="20"/>
									<col fix="left" width="70"/>
									<col fix="left" width="85"/>
									<col fix="left" width="118"/>
									<col width="70"/>
									<col width="70"/>
									<col width="77"/>
									<col width="70"/>
									<col width="60"/>
									<col width="60"/>
									<col width="60"/>
									<col width="60"/>
									<col width="60"/>
									<col width="222"/>
									<col width="56"/>
									<col width="70"/>
									<col width="130"/>
									<col width="60"/>
									<col width="81"/>
									<col width="106"/>
									<col width="75"/>
									<col width="84"/>
									<col width="75"/>
									<col width="75"/>
									<col width="297"/>
									<col width="0"/>
								</columns>
								<head>
									<cell bkimageid="icon_grid_sel" col="0" display="text"/>
									<cell align="center" col="1" color="user21" display="checkbox" font="굴림,9"/>
									<cell align="center" col="2" color="user21" display="text" font="굴림,9" text="호기"/>
									<cell align="center" col="3" color="user21" display="text" font="굴림,9" text="기종"/>
									<cell align="center" col="4" color="user21" display="text" font="굴림,9" text="사양"/>
									<cell align="center" col="5" color="user21" display="text" font="굴림,9" text="착공예정일"/>
									<cell align="center" col="6" color="user21" display="text" font="굴림,9" text="준공예정일"/>
									<cell align="center" col="7" color="user21" display="text" font="굴림,9" text="PM"/>
									<cell align="center" col="8" color="user21" display="text" font="굴림,9" text="팀장"/>
									<cell align="center" col="9" color="user21" display="text" font="굴림,9" text="사원1"/>
									<cell align="center" col="10" color="user21" display="text" font="굴림,9" text="사원2"/>
									<cell align="center" col="11" color="user21" display="text" font="굴림,9" text="사원3"/>
									<cell align="center" col="12" color="user21" display="text" font="굴림,9" text="사원4"/>
									<cell align="center" col="13" color="user21" display="text" font="굴림,9" text="사원5"/>
									<cell align="center" col="14" color="user21" display="text" font="굴림,9" text="미등록인원"/>
									<cell align="center" col="15" color="user21" display="text" font="굴림,9" text="인원소개"/>
									<cell align="center" col="16" color="user21" display="text" font="굴림,9" text="최초투입일"/>
									<cell align="center" col="17" color="user21" display="text" font="굴림,9" text="작업공정입력"/>
									<cell align="center" col="18" color="user21" display="text" font="굴림,9" text="공정율(%)"/>
									<cell align="center" col="19" color="user21" display="text" font="굴림,9" text="투입일"/>
									<cell align="center" col="20" color="user21" display="text" font="굴림,9" text="협력업체코드"/>
									<cell align="center" col="21" color="user21" display="text" font="굴림,9" text="안전사고"/>
									<cell align="center" col="22" color="user21" display="text" font="굴림,9" text="현장안전점검"/>
									<cell align="center" col="23" color="user21" display="text" font="굴림,9" text="근태여부"/>
									<cell align="center" col="24" color="user21" display="text" font="굴림,9" text="보호구착용"/>
									<cell align="center" col="25" color="user21" display="text" font="굴림,9" text="비고"/>
									<cell align="center" col="26" color="user21" display="text" font="굴림,9" text="구분"/>
								</head>
								<body>
									<cell align="center" col="0" display="text" expr="currow&#32;+&#32;1"/>
									<cell align="center" col="1" colid="CHECK" display="checkbox" edit="checkbox"/>
									<cell align="center" bkcolor2="user22" col="2" colid="POSID" display="text"/>
									<cell align="center" bkcolor2="user22" col="3" colid="ZSPEC1" display="text"/>
									<cell bkcolor2="user22" col="4" colid="ZSPEC2" display="text"/>
									<cell align="center" bkcolor2="user22" col="5" colid="ZZSHIP1" display="text" Mask="####.##.##"/>
									<cell align="center" bkcolor2="user22" col="6" colid="ZZCOMP2" display="text" Mask="####.##.##"/>
									<cell align="center" bkcolor2="user22" col="7" colid="PMCD" combocol="CODE" combodataset="ds_pmcd" combotext="CODE_NM" display="combo"/>
									<cell align="center" bkcolor2="user22" col="8" colid="TMCD" combocol="CODE" combodataset="ds_tmcd" combotext="CODE_NM" display="combo"/>
									<cell bkcolor2="user22" bkimagealign="right" bkimageid="icon_grid_edit" col="9" colid="PERNO1" combocol="CODE" combodataset="ds_perno" combotext="CODE_NM" display="combo" edit="combo"/>
									<cell bkcolor2="user22" bkimagealign="right" bkimageid="icon_grid_edit" col="10" colid="PERNO2" combocol="CODE" combodataset="ds_perno" combotext="CODE_NM" display="combo" edit="combo"/>
									<cell bkcolor2="user22" bkimagealign="right" bkimageid="icon_grid_edit" col="11" colid="PERNO3" combocol="CODE" combodataset="ds_perno" combotext="CODE_NM" display="combo" edit="combo"/>
									<cell bkcolor2="user22" bkimagealign="right" bkimageid="icon_grid_edit" col="12" colid="PERNO4" combocol="CODE" combodataset="ds_perno" combotext="CODE_NM" display="combo" edit="combo"/>
									<cell bkcolor2="user22" bkimagealign="right" bkimageid="icon_grid_edit" col="13" colid="PERNO5" combocol="CODE" combodataset="ds_perno" combotext="CODE_NM" display="combo" edit="combo"/>
									<cell bkcolor2="user22" bkimagealign="right" bkimageid="icon_grid_edit" col="14" colid="MI_PERNO" display="text" edit="normal"/>
									<cell align="center" bkcolor2="user22" bkimagealign="right" bkimageid="icon_grid_edit" col="15" colid="PER_SUM" combocol="CNT" combodataset="ds_persum" combodisplayrowcnt="6" combotext="NAME" display="combo" edit="combo"/>
									<cell align="center" bkcolor2="user22" col="16" colid="FIR_DT" display="text" Mask="####.##.##"/>
									<cell align="center" bkcolor2="user22" bkimagealign="right" bkimageid="icon_grid_edit" col="17" colid="PRONR" combocol="CODE" combodataset="ds_pronr" combotext="CODE_NM" display="combo" edit="combo"/>
									<cell align="right" bkcolor2="user22" col="18" colid="PRO_R" display="number" Mask="##0.00"/>
									<cell align="center" bkcolor2="user22" col="19" colid="INP_DT" display="text" Mask="####.##.##"/>
									<cell align="center" bkcolor2="user22" col="20" colid="LIFNR" display="text"/>
									<cell bkcolor2="user22" bkimagealign="right" col="21" colid="ZSAFE" combocol="CODE" combodataset="ds_zsafe" combotext="CODE_NM" display="combo"/>
									<cell bkcolor2="user22" bkimagealign="right" col="22" colid="ZINSP" combocol="CODE" combodataset="ds_zinsp" combotext="CODE_NM" display="combo"/>
									<cell bkcolor2="user22" bkimagealign="right" col="23" colid="ZWORK" combocol="CODE" combodataset="ds_zwork" combotext="CODE_NM" display="combo"/>
									<cell bkcolor2="user22" bkimagealign="right" col="24" colid="ZWERP" combocol="CODE" combodataset="ds_zwerp" combotext="CODE_NM" display="combo"/>
									<cell bkcolor2="user22" bkimagealign="right" col="25" colid="BIGO" display="text"/>
									<cell align="center" bkcolor2="user22" col="26" colid="ZZGUBUN" display="text"/>
								</body>
								<summary>
									<cell bkcolor="user25" col="0" color="user26" colspan="18" display="text">
										<cell align="center" col="0" color="user26" colspan="16" display="text" domainid="com.avg" text="평균"/>
										<cell align="right" col="15" color="user26" colspan="11" display="text"/>
										<cell align="right" col="16" color="user26" colspan="11" display="text"/>
										<cell align="right" col="17" color="user26" colspan="11" display="text"/>
									</cell>
									<cell align="right" bkcolor="user25" col="18" color="user26" display="number" expr='sum(&quot;PRO_R&quot;)/parseInt(ds_list2.rowcount)' Mask="##0.00"/>
									<cell bkcolor="user25" col="19" color="user26" colspan="7">
										<cell align="center" col="39" color="user26" colspan="16" display="text" domainid="com.avg" text="평균"/>
										<cell align="right" col="38" color="user26" colspan="11" display="text"/>
										<cell align="right" col="38" color="user26" colspan="11" display="text"/>
										<cell align="right" col="37" color="user26" colspan="11" display="text"/>
										<cell align="right" col="36" color="user26" colspan="11" display="text"/>
										<cell align="center" col="21" color="user26" colspan="16" display="text" domainid="com.avg" text="평균"/>
										<cell align="right" col="39" color="user26" colspan="11" display="text"/>
										<cell align="right" col="38" color="user26" colspan="11" display="text"/>
										<cell align="right" col="37" color="user26" colspan="11" display="text"/>
										<cell align="center" col="22" color="user26" colspan="16" display="text" domainid="com.avg" text="평균"/>
										<cell align="right" col="40" color="user26" colspan="11" display="text"/>
										<cell align="right" col="39" color="user26" colspan="11" display="text"/>
										<cell align="right" col="38" color="user26" colspan="11" display="text"/>
										<cell align="center" col="23" color="user26" colspan="16" display="text" domainid="com.avg" text="평균"/>
										<cell align="right" col="41" color="user26" colspan="11" display="text"/>
										<cell align="right" col="40" color="user26" colspan="11" display="text"/>
										<cell align="right" col="39" color="user26" colspan="11" display="text"/>
										<cell align="center" col="24" color="user26" colspan="16" display="text" domainid="com.avg" text="평균"/>
										<cell align="right" col="42" color="user26" colspan="11" display="text"/>
										<cell align="right" col="41" color="user26" colspan="11" display="text"/>
										<cell align="right" col="40" color="user26" colspan="11" display="text"/>
										<cell align="center" col="25" color="user26" colspan="16" display="text" domainid="com.avg" text="평균"/>
									</cell>
									<cell bkcolor="user25" col="26" color="user26" display="text">
										<cell align="center" col="0" color="user26" colspan="16" display="text" domainid="com.avg" text="평균"/>
										<cell align="right" col="15" color="user26" colspan="11" display="text"/>
										<cell align="right" col="16" color="user26" colspan="11" display="text"/>
										<cell align="right" col="17" color="user26" colspan="11" display="text"/>
									</cell>
								</summary>
							</format>
						</contents>
					</Grid>
				</TabPage>
			</Contents>
		</Tab>
		<Static Align="Right" Height="20" Id="st_lifnr" Left="8" Style="sty_lb_search" TabOrder="23" Text="설치협력사&#32;" Top="5" VAlign="Middle" Width="92"></Static>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="CODE" Column="ZZLIFNR" DataColumn="CODE_NAME" Height="20" Id="cb_zzlifnr" InnerDataset="ds_zzlifnr" Left="102" Style="sty_ipt_search" TabOrder="24" Top="4" Width="169"></Combo>
		<Static Align="Right" Height="20" Id="st_inpday" Left="288" Style="sty_lb_search" TabOrder="25" Text="투입일자&#32;" Top="5" VAlign="Middle" Width="92"></Static>
		<Calendar BindDataset="ds_cond" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="INP_DT" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cb_inpday" Left="382" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_search" SundayTextColor="user35" TabOrder="26" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="5" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="94"></Calendar>
		<Static Align="Right" Height="24" Id="Static8" Left="467" Style="sty_lb_form_basic" TabOrder="27" Text="전체공사기간&#32;" Top="89" VAlign="Middle" Width="98"></Static>
		<Calendar BindDataset="ds_head" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="F_DATE" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Enable="FALSE" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="Calendar0" Left="567" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="28" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="91" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="137"></Calendar>
		<Static Height="17" Id="Static9" Left="706" TabOrder="29" Text="~" Top="95" Width="8"></Static>
		<Calendar BindDataset="ds_head" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="T_DATE" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Enable="FALSE" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="Calendar1" Left="720" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="30" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="91" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="137"></Calendar>
		<Static Align="Right" Height="24" Id="Static7" Left="664" Style="sty_lb_form_basic" TabOrder="32" Text="납기일&#32;" Top="39" VAlign="Middle" Width="96"></Static>
		<Calendar BindDataset="ds_head" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="VDATU" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Enable="FALSE" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="ed_vdatu" Left="762" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="31" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="42" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="138"></Calendar>
		<Static Align="Right" Height="24" Id="Static0" Left="664" Style="sty_lb_form_basic" TabOrder="33" Text="계약업체&#32;" Top="64" VAlign="Middle" Width="96"></Static>
		<Edit BindDataset="ds_head" Border="Flat" Column="KUNNR" Height="20" Id="ed_kunnr" Left="762" LeftMargin="4" Readonly="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="34" Top="66" Width="202"></Edit>
	</Form>
	<Script><![CDATA[/*
 *****************************************************************************************
 * 기      능   : 
 * 작  성  자   : BANG GI TAE
 * 작성  일자   : 2012.04.03
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
#include "LIB::commons.js";	// 공통 스크립트 
//=========================================================================================
// [ PART 1 ]
// Form에서 사용될 전역변수를 선언
// FORM에서 사용되는 전역변수는 대문자로 작성하며, F_XXX 의 형태를 갖도록 한다. 
//=========================================================================================
var user_grp = "";
var args = "";
var curr_date = "";
var tm_cd = "";
var zzgubun = "";
//var userGroup = "";
//=========================================================================================
// [ PART 2 ]
// Form Loading / Unloading 시 작업 정의
//=========================================================================================
function fn_OnLoadCompleted(obj) 
{

    
//Alert("fn_OnLoadCompleted : " + zzgubun);
 
	// Form 로드 이벤트 맨 첫줄에 기술
	gfn_initForm(true);
	
				
	user_grp = gfn_getUserGroup();
	
	cb_inpday.Value = gfn_getCurrDate();
	Tab00.TabIndex = 0;

	tit_clearActionInfo();	
	tit_addSearchActionInfo("ps02:PS0205001A_S1");		//업체 코드
	tit_addSearchActionInfo("ps02:PS0205001A_S5");      //PM 코드
	tit_addSearchActionInfo("ps02:PS0205001A_S6");      //팀장 코드
	
	tit_addSearchActionInfo("ps02:PS0205001A_S8");      //공정 코드
	
	tit_callService(
		""
		, ""
		, "ds_cond=ds_cond"
		, "ds_zzlifnr=ds_zzlifnr ds_pmcd=ds_pmcd ds_tmcd=ds_tmcd ds_pronr=ds_pronr"
		, ""
		, "fn_afterQueryA"
		, ""  //true
		, ""
		, true);
	
		
	
	cb_inpday.SETFOCUS();
	gfn_showMsg("CI00007");
	
	btn_delete.enable = false;	
	
			
}

/********************************************************************************
* 기      능   : 조회 Callback  - 설치협력사 로그인시 협력업체코드 첫번째 선택
********************************************************************************/
function fn_afterQueryA(errCode, errMsg) 
{

	//alert(G_VEND_CODE_E);
	//alert(ds_pronr.SaveXML());	

	if( user_grp == "10")
	{
		ds_zzlifnr.filter("CODE == " + quote( G_VEND_CODE_E) );
		cb_zzlifnr.Index = 0;
		cb_zzlifnr.Enable = false;
	}
	else if ( user_grp == "40" )
	{
		cb_zzlifnr.Enable = true;
		//ds_zzlifnr.Filter("LOEVM==''");
		gfn_insertEmptyRow( ds_zzlifnr, G_CODE_ALL );
		cb_zzlifnr.value = "";
	}	
	
	else if ( user_grp == "30" )  //임시로 열어줌
	{
		cb_zzlifnr.Enable = true;
		//ds_zzlifnr.Filter("LOEVM==''");
		gfn_insertEmptyRow( ds_zzlifnr, G_CODE_ALL );
		cb_zzlifnr.value = "";
	}	
	
	
	else
	{
		cb_zzlifnr.value = "";
		cb_zzlifnr.Enable = false;
	}
	
//Alert("fn_afterQueryA : " + zzgubun);	
}

/********************************************************************************
* 기      능   : 공통코드가 조회된 후의 Callback 함수 
********************************************************************************/
function fn_completeInit(sCode, sDsObj, sCodeType) 
{
//Alert("fn_completeInit : " + zzgubun);
}


/********************************************************************************
* 기      능   : form UnloadCompleted 
********************************************************************************/
function fn_OnUnloadCompleted(obj) 
{
//Alert("fn_OnUnloadCompleted : " + zzgubun);
	return gfn_isFormUnload(obj);
}


/********************************************************************************
* 기      능   : 조회
********************************************************************************/
function ufn_hedquery() 
{
	curr_date = ToNumber(gfn_getCurrDate());
	ds_cond.SetColumn(0,"CURR_DATE",curr_date);
	


	tit_clearActionInfo();	
	tit_addSearchActionInfo("ps02:PS0205001A_S2");
	tit_callService(
		""
		, ""
		, "ds_cond=ds_cond"
		, "ds_head=ds_head"
		, ""
		, ""  //"fn_afterQueryA"
		, ""  //true
		, ""
		, true);
//Alert("ufn_hedquery : " + zzgubun);		

}



//=========================================================================================
// [ PART 3 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,form닫기)
//=========================================================================================
/********************************************************************************
* 기      능   : 조회
********************************************************************************/
function fn_query() 
{
	
    //헤더 부분 가져오기
	ufn_hedquery();
	
	
	//설치협력사 조회시 협력업체 필수체크
	if(gfn_isNull(cb_zzlifnr, true, st_lifnr.value))  return;	
	//투입일 필수체크
	if(gfn_isNull(cb_inpday,  true, st_inpday.value)) return;
    //프로젝트 필수체크
    if(gfn_isNull(ed_pspid,   true, st_pjt.value))	  return;
	
	//=================협력업체 사원정보=====================
	tit_clearActionInfo();	
	tit_addSearchActionInfo("ps02:PS0205001A_S7");  //사원 코드	
	tit_callService(
          ""
        , ""
        , "ds_cond=ds_cond"
        , "ds_perno=ds_perno"
        , ""
        , ""  //"fn_afterQuery"  
        , ""
        , ""
        , true);


    // ======================미입력분/입력분=================    
	//gfn_initDs(ds_list1, true);	
    
	tit_clearActionInfo();	
	//tit_addSearchActionInfo("ps02:PS0205001A_S7");  //사원 코드
	tit_addSearchActionInfo("ps02:PS0205001A_S3");  //미입력분
	tit_addSearchActionInfo("ps02:PS0205001A_S4");  //입력분
	tit_callService(
          ""
        , ""
        , "ds_cond=ds_cond"
        , "ds_list1=ds_list1 ds_list2=ds_list2"
        , ""
        , "fn_afterQuery"  
        , ""
        , ""
        , true);

        
        
   
     //    
        
        
     for( var i=0; i<ds_list1.rowcount; i++ )   
     {  
        
        ds_list1.SetColumn(i, "INP_DT", cb_inpday.Value);
        
        ds_list1.SetColumn(i, "LIFNR", cb_zzlifnr.Value);
                
     }
     
//Alert("fn_query : " + zzgubun);	     
     
}

/********************************************************************************
* 기      능   : 닫기 
********************************************************************************/
function fn_close() 
{
	close();
}



//=========================================================================================
// [ PART 4]
// Callback 함수 정의 : callback 함수명은 메인 함수의 fn_xxxx() 에서 xxxx 부분은 fn_afterXXXX()
// 형태가 되도록 작성 
//=========================================================================================
/********************************************************************************
* 기      능   : 조회 Callback 
********************************************************************************/
function fn_afterQuery(errCode, errMsg) 
{
	
	//gfn_showMsg("CI00002",ds_head.RowCount()+"");
	
	gfn_showSearchMsg(grd_list1, errCode, errMsg);
	
	ds_list1.Reset();
	
	Tab00.TabIndex = 0;
	//ed_pspid.SETFOCUS();
//Alert("fn_afterQuery : " + zzgubun);	 	
	
	
}
/********************************************************************************
* 기      능   : 조회 Callback  
********************************************************************************/
function fn_afterQuery1(errCode, errMsg) 
{
	//gfn_showSearchMsg(Tab00.tab1.grd_list1, errCode, errMsg);
}
/********************************************************************************
* 기      능   : 조회 Callback  
********************************************************************************/
function fn_afterQuery2(errCode, errMsg) 
{
	/*
	gfn_showMsg("CI00002",ds_list2.RowCount()+"");
	if(ds_list3.rowcount > 0) filterList();
	*/
}
//=========================================================================================
// [ PART 5 ]
// Detail Process Event 정의 ( User Define function )
// 사용자 정의 함수는 ufn_xxxx() 형태로 작성 
//=========================================================================================
/********************************************************************************
* 기      능   : 사용자 정의 함수  
********************************************************************************/
function ufn_userfunction() 
{
}

/********************************************************************************
* 기      능   : 액셀  
********************************************************************************/
function fn_excel() 
{

	switch (Tab00.TabIndex) 
	{
		
		case 0 :
			if( ds_list1.rowcount > 0 )
			{
//alert(ds_list1.rowcount);
				gfn_saveToExcel(Tab00.tab1.grd_list1, true );
				break;
			}
			
			
		case 1 :
			if( ds_list2.rowcount > 0 )
			{
//alert(ds_list2.rowcount);			
				gfn_saveToExcel(Tab00.tab2.grd_list2, true );
				break;
			}	
	}
	
	
}



//=========================================================================================
// [ PART 6 ]
// component Event 정의 : 각 Component 별 이벤트 
//=========================================================================================
/********************************************************************************
* 기      능   : 텝 선택시
********************************************************************************/
function Tab00_OnChanged(obj, nOldIndex, nNewIndex)
{

	ds_perno.unFilter();
	
	if( obj.TabIndex == 0 )
	{ 
		btn_delete.enable = false;	
		//ds_list1.CanRowPosChange = "ds_list1_CanRowPosChange";
		ds_list1_CanRowPosChange();
		
	}
    else if( obj.TabIndex == 1 )
    {
		btn_delete.enable = true;	
		//ds_list2.CanRowPosChange = "ds_list2_CanRowPosChange";
		ds_list2_CanRowPosChange();
	}
	
	
//Alert("Tab00_OnChanged : " + zzgubun);		

	/*
	if( ds_head.rowcount > 0 && obj.TabIndex == 0) 
	{
		fn_query1();
	}	
	else if( ds_head.rowcount > 0 && obj.TabIndex == 1 ) 
	{
		fn_query2();
	}
	else if( ds_head.rowcount > 0 && obj.TabIndex == 2 ) 
	{
		fn_query3();
	}
	else if( ds_head.rowcount > 0 && obj.TabIndex == 3 ) 
	{
		fn_query4();
	}
	*/
}
/********************************************************************************
* 기      능   : 원프로젝트 팝업
********************************************************************************/
function btn_pjt_OnClick(obj)
{

	var arg = "pjt="+quote(ed_pjt.Text);
	
	gfn_openPopup("CS9601002A",true,arg);
	
	fn_query();
//Alert("btn_pjt_OnClick : " + zzgubun);		
}


/********************************************************************************
* 기      능   : 리스트의 타이틀 클릭  
********************************************************************************/
function Tab00_tab1_grd_list1_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
{
   
	if ( nCell == 0 ) {
		return;
	}
	else if ( nCell == 1 ) {
		// 그리드 표시할 컬럼 선택 
		gfn_selectAllGrid(obj,nCell,nCell,true);
	} else {
		// 그리드 정렬 처리 
		gfn_sortGrid(obj,nCell);
	}
	
//Alert("Tab00_tab1_grd_list1_OnHeadClick : " + zzgubun);	
	
}	
	
	
function Tab00_tab2_grd_list2_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
{

	if ( nCell == 0 ) 
	{
		return;
	}
	else if ( nCell == 1 ) {
		// 그리드 표시할 컬럼 선택 
		gfn_selectAllGrid(obj,nCell,nCell,true);
	} else {
		// 그리드 정렬 처리 
		gfn_sortGrid(obj,nCell);
	}	
	
//Alert("Tab00_tab2_grd_list2_OnHeadClick : " + zzgubun);		
}	
	
	
	
/********************************************************************************
* 기      능   : 프로젝트에서 엔터키 처리 
********************************************************************************/
function ed_pjt_OnKeyDown(obj,nChar,bShift,bCtrl, bAlt,LLParam,HLParam)
{
	if(nChar == 13)
	{

		fn_query();
	}
//Alert("ed_pjt_OnKeyDown : " + zzgubun);			
	
}


/********************************************************************************
* 기      능   : tab 선택시 선택안되도록 처리(자재협력사가 선택시)
********************************************************************************/
function Tab00_OnChanging(obj,nOldIndex,nNewIndex)
{
	//if(trim(G_USER_GROUP_M) == 'M10' && (nNewIndex == 0 || nNewIndex == 3) ) return false;
}

function Tab00_tab2_grd_list2_OnCellDblClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
	/*
	if(nCell == '1') gfn_openPopup("PS0101001B",true);
	else if(nCell == '7' || nCell == '9' || nCell == '10') gfn_openPopup("PS0101001C",true);
	*/
}




/********************************************************************************
* 기      능   :  그리드에서 콤보 클릭시
********************************************************************************/
function fn_changeperno_grd_cd(temno, zzgubun)
{    
	//alert(ds_perno.SaveXML());	
	//ds_perno.filter("RETIF!='X' && TEMNO==" + quote( temno)  );
	
//alert("1");	
//alert(ds_pronr.SaveXML());		
	
	
//Alert("fn_changeperno_grd_cd : " + zzgubun);		
	ds_perno.filter("RETIF!='X' && ( TEMNO== 'T' || TEMNO==" + quote( temno) + ")"  );
	
//alert(zzgubun);	
	
//alert(ds_pronr.SaveXML());	

	ds_pronr.FILTER("ZZGUBUN==" + quote( zzgubun));
	
//alert(ds_pronr.SaveXML());	
//alert("5");		
//alert(ds_pronr.SaveXML());	

}


function ds_list1_CanRowPosChange(obj,nOldRow,nRow)
{
	
//alert("1");	
//alert(ds_list1.getColumn(nRow, "ZZGUBUN"));	

//Alert("ds_list1_CanRowPosChange : " + Tab00.TabIndex);	
	tm_cd = ds_list1.getColumn(nRow, "TMCD");
	zzgubun = ds_list1.getColumn(nRow, "ZZGUBUN");
	
	
	fn_changeperno_grd_cd(tm_cd, zzgubun);	
	//return true;	
}



function ds_list2_CanRowPosChange(obj,nOldRow,nRow)
{

//alert("2");	
//alert(ds_pronr.SaveXML());	
//Alert("ds_list2_CanRowPosChange : " + Tab00.TabIndex);
	//tm_cd = ds_list2.getColumn(nRow, "TMCD");
	
	if ( Tab00.TabIndex != 0 )
	{   
	    tm_cd = ds_list2.getColumn(nRow, "TMCD");
		zzgubun = ds_list2.getColumn(nRow, "ZZGUBUN");
	}
	
	fn_changeperno_grd_cd(tm_cd, zzgubun);		
}



/********************************************************************************
* 기      능   : 저장
********************************************************************************/
function fn_save() 
{

	if( Tab00.TabIndex == 0 )  //미입력분
	{
	
		// 그리드 저장 대상 로우
		if(ds_list1.FindRow("CHECK", 1)==-1)
		{
			gfn_showMsg('CW00046');
			return;
		}
	
		for(var i=0; i<ds_list1.GetRowCount(); i++)
		{
			if(ds_list1.GetColumn(i, "CHECK")==1)
			{
			
				// 필수 입력 항목	
				if(length(ds_list1.GetColumn(i, "PRONR"))<=0 )
				{
					var arr = [parseInt(i) + 1, "작업공정"];
					gfn_showMsg("CW00224", arr);
					return;
				} 
				
			}
		}
	
		ds_list1.Filter("CHECK==1");
		ds_list1_tmp.copyF(ds_list1);
		ds_list1.unFilter();	
	
	
	
		tit_clearActionInfo();
		tit_addMultiActionInfo("ps02:PS0205001A_I1");
		tit_callService(
          ""
        , ""
        , "ds_list1_tmp=ds_list1_tmp"
        , ""
        , ""
        , "fn_afterSave" 
        , ""
        , ""
        , true);
		
		ds_list1_tmp.DeleteAll();
		//fn_query();
	}
    else if( Tab00.TabIndex == 1 )  // 입력분
    {
    
		// 그리드 저장 대상 로우
		if(ds_list2.FindRow("CHECK", 1)==-1)
		{
			gfn_showMsg('CW00046');
			return;
		}
		
		for(var i=0; i<ds_list2.GetRowCount(); i++)
		{
			if(ds_list2.GetColumn(i, "CHECK")==1)
			{
			
				// 필수 입력 항목	
				if(length(ds_list2.GetColumn(i, "PRONR"))<=0 )
				{
					var arr = [parseInt(i) + 1, "작업공정"];
					gfn_showMsg("CW00224", arr);
					return;
				} 
				
			}
		}
	
		ds_list2.Filter("CHECK==1");
		ds_list2_tmp.copyF(ds_list2);
		ds_list2.unFilter();	
		
		
    
		tit_clearActionInfo();
		tit_addMultiActionInfo("ps02:PS0205001A_U1");
		tit_callService(
          ""
        , ""
        , "ds_list2_tmp=ds_list2_tmp"
        , ""
        , ""
        , "fn_afterSave" 
        , ""
        , ""
        , true);
		
		ds_list2_tmp.DeleteAll();
		//fn_query();		
	}
	
}
 

/********************************************************************************
* 기      능   : 삭제
********************************************************************************/
function fn_delete() 
{


    if( Tab00.TabIndex == 1 )  // 입력분
    {
    
		// 그리드 저장 대상 로우
		if(ds_list2.FindRow("CHECK", 1)==-1)
		{
			gfn_showMsg('CW00046');
			return;
		}
		
		for(var i=0; i<ds_list2.GetRowCount(); i++)
		{
			if(ds_list2.GetColumn(i, "CHECK")==1)
			{
			
				// 삭제가 안되는 경우
				if( length(ds_list2.GetColumn(i, "ZSAFE")) > 0 || length(ds_list2.GetColumn(i, "ZINSP"))>0 || length(ds_list2.GetColumn(i, "ZWORK"))>0 ||
				    length(ds_list2.GetColumn(i, "ZWERP")) > 0 || length(ds_list2.GetColumn(i, "BIGO")) > 0  )
				{
					//var arr = [parseInt(i) + 1, "안전사고/현장안전점검/근태여부/보호구착용/비고 입력분은 삭제가 불가능 담당 PM에게 확인바람"];
					var lv_low = parseInt(i) + 1;
					var arr = lv_low + "행의 " + "안전사고/현장안전점검/근태여부/보호구착용/비고 입력분은 삭제가 불가능 담당 PM에게 확인바람";					
					gfn_showMsg("CW00022", arr);
					return;
				} 
				
			}
		}

	
		ds_list2.Filter("CHECK==1");
		ds_list2_tmp.copyF(ds_list2);
		ds_list2.unFilter();	
		
		
    
		tit_clearActionInfo();
		tit_addMultiActionInfo("ps02:PS0205001A_D1");
		tit_callService(
          ""
        , ""
        , "ds_list2_tmp=ds_list2_tmp"
        , ""
        , ""
        , "fn_afterDelete" 
        , ""
        , ""
        , true);
		
		ds_list2_tmp.DeleteAll();
		//fn_query();		
	}
	

}



/********************************************************************************
* 기      능   : 저장 Callback  
********************************************************************************/
function fn_afterSave(errCode, errMsg) 
{
	if ( errCode != 0 ) {
		gfn_showMsg("CE00001");
	} else {
		gfn_showMsg("CI00003");		
		fn_query();
	}
}

/********************************************************************************
* 기      능   : 삭제 Callback  
********************************************************************************/
function fn_afterDelete(errCode, errMsg) 
{
	if ( errCode != 0 ) {
		gfn_showMsg("CE00001");
	} else {
		gfn_showMsg("CI00004");		
		fn_query();
	}
}






]]></Script>
</Window>