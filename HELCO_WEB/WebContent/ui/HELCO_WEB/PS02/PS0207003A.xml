<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="562" Id="PS0207003A" Left="8" OnLoadCompleted="fn_OnLoadCompleted" OnUnloadCompleted="fn_OnUnloadCompleted" PidAttrib="7" Title="투입일자별&#32;작업일보&#32;조회&#32;및&#32;승인" Top="8" Ver="1.0" Width="978" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_cond" OnColumnChanged="ds_cond_OnColumnChanged">
				<Contents>
					<colinfo id="PSPID" size="255" summ="default" type="STRING"/>
					<colinfo id="ZZLIFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZLIFNR_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="INP_DTF" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZACTSS" size="256" summ="default" type="STRING"/>
					<colinfo id="CURR_DATE" size="256" summ="default" type="STRING"/>
					<colinfo id="USER_GRUP" size="256" summ="default" type="STRING"/>
					<colinfo id="USER_CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="G_USER_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZPMNUM" size="256" summ="default" type="STRING"/>
					<colinfo id="SO3" size="256" summ="default" type="STRING"/>
					<colinfo id="SO4" size="256" summ="default" type="STRING"/>
					<colinfo id="COMP_SHOW_YN" size="256" summ="default" type="STRING"/>
					<record>
						<COMP_SHOW_YN></COMP_SHOW_YN>
						<CURR_DATE></CURR_DATE>
						<G_USER_ID></G_USER_ID>
						<INP_DTF></INP_DTF>
						<PSPID></PSPID>
						<SO3></SO3>
						<SO4></SO4>
						<USER_CODE></USER_CODE>
						<USER_GRUP></USER_GRUP>
						<ZZACTSS></ZZACTSS>
						<ZZLIFNR></ZZLIFNR>
						<ZZLIFNR_NM></ZZLIFNR_NM>
						<ZZPMNUM></ZZPMNUM>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list1" OnColumnChanged="ds_list1_OnColumnChanged">
				<Contents>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSPEC1" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSPEC2" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZSHIP1" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZCOMP2" size="256" summ="default" type="STRING"/>
					<colinfo id="PMCD" size="256" summ="default" type="STRING"/>
					<colinfo id="TMCD" size="256" summ="default" type="STRING"/>
					<colinfo id="PRONR" size="256" summ="default" type="STRING"/>
					<colinfo id="PRO_R" size="256" summ="default" type="STRING"/>
					<colinfo id="PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSITE_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZGUBUN" size="256" summ="default" type="STRING"/>
					<colinfo id="INIT_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="M_MH" size="256" summ="default" type="STRING"/>
					<colinfo id="N_MH" size="256" summ="default" type="STRING"/>
					<colinfo id="A_MH" size="256" summ="default" type="STRING"/>
					<colinfo id="SUM_MH" size="256" summ="default" type="STRING"/>
					<colinfo id="NAMEE" size="256" summ="default" type="STRING"/>
					<colinfo id="PROWRK" size="256" summ="default" type="STRING"/>
					<colinfo id="TOT_PRO" size="256" summ="default" type="STRING"/>
					<colinfo id="NAME1" size="256" summ="default" type="STRING"/>
					<colinfo id="NAMET" size="256" summ="default" type="STRING"/>
					<colinfo id="NAMET2" size="256" summ="default" type="STRING"/>
					<colinfo id="CHECK" size="256" summ="default" type="STRING"/>
					<colinfo id="TYPE" size="256" summ="default" type="STRING"/>
					<colinfo id="APPR_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="APP_PRO" size="256" summ="default" type="STRING"/>
					<colinfo id="S_PRO" size="256" summ="default" type="STRING"/>
					<colinfo id="TXT30" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZILSIC" size="256" summ="default" type="STRING"/>
					<colinfo id="TEXT30" size="256" summ="default" type="STRING"/>
					<colinfo id="STEP1_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="STEP2_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="STEP3_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="SAFE" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSPEC" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID_DONG" size="256" summ="default" type="STRING"/>
					<colinfo id="VER" size="256" summ="default" type="STRING"/>
					<colinfo id="S_PRO_TMP" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_zzactss">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME></CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_zzlifnr">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
					<colinfo id="SORTL" size="256" type="STRING"/>
					<colinfo id="LOEVM" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_zzpmnum_cd">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME></CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond_cd">
				<Contents>
					<colinfo id="TEMNO" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZACTSS" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZSAWONNUM" size="256" summ="default" type="STRING"/>
					<colinfo id="TMCD" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZLIFNR" size="256" summ="default" type="STRING"/>
					<record>
						<TEMNO></TEMNO>
						<TMCD></TMCD>
						<ZZACTSS></ZZACTSS>
						<ZZLIFNR></ZZLIFNR>
						<ZZSAWONNUM></ZZSAWONNUM>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list2">
				<Contents>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSPEC1" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSPEC2" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZSHIP1" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZCOMP2" size="256" summ="default" type="STRING"/>
					<colinfo id="PMCD" size="256" summ="default" type="STRING"/>
					<colinfo id="TMCD" size="256" summ="default" type="STRING"/>
					<colinfo id="PRONR" size="256" summ="default" type="STRING"/>
					<colinfo id="PRO_R" size="256" summ="default" type="STRING"/>
					<colinfo id="PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSITE_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZGUBUN" size="256" summ="default" type="STRING"/>
					<colinfo id="INIT_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="M_MH" size="256" summ="default" type="STRING"/>
					<colinfo id="N_MH" size="256" summ="default" type="STRING"/>
					<colinfo id="A_MH" size="256" summ="default" type="STRING"/>
					<colinfo id="SUM_MH" size="256" summ="default" type="STRING"/>
					<colinfo id="NAMEE" size="256" summ="default" type="STRING"/>
					<colinfo id="PROWRK" size="256" summ="default" type="STRING"/>
					<colinfo id="TOT_PRO" size="256" summ="default" type="STRING"/>
					<colinfo id="NAME1" size="256" summ="default" type="STRING"/>
					<colinfo id="NAMET" size="256" summ="default" type="STRING"/>
					<colinfo id="NAMET2" size="256" summ="default" type="STRING"/>
					<colinfo id="CHECK" size="256" summ="default" type="STRING"/>
					<colinfo id="TYPE" size="256" summ="default" type="STRING"/>
					<colinfo id="APPR_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="APP_PRO" size="256" summ="default" type="STRING"/>
					<colinfo id="S_PRO" size="256" summ="default" type="STRING"/>
					<colinfo id="TXT30" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZILSIC" size="256" summ="default" type="STRING"/>
					<colinfo id="TEXT30" size="256" summ="default" type="STRING"/>
					<colinfo id="STEP1_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="STEP2_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="STEP3_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="SAFE" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSPEC" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID_DONG" size="256" summ="default" type="STRING"/>
					<colinfo id="S_PRO_TMP" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond1">
				<Contents>
					<colinfo id="PSPID" size="255" summ="default" type="STRING"/>
					<colinfo id="INP_DTF" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
					<colinfo id="SAFE" size="256" summ="default" type="STRING"/>
					<colinfo id="VER" size="256" summ="default" type="STRING"/>
					<record>
						<INP_DTF></INP_DTF>
						<POSID></POSID>
						<PSPID></PSPID>
						<SAFE></SAFE>
						<VER></VER>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list3">
				<Contents>
					<colinfo id="PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
					<colinfo id="GUBUN" size="256" summ="default" type="STRING"/>
					<colinfo id="PRONR" size="256" summ="default" type="STRING"/>
					<colinfo id="PROWRK" size="256" summ="default" type="STRING"/>
					<colinfo id="PRO_R" size="256" summ="default" type="STRING"/>
					<colinfo id="SAFE" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list3_tmp">
				<Contents>
					<colinfo id="PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
					<colinfo id="GUBUN" size="256" summ="default" type="STRING"/>
					<colinfo id="PRONR" size="256" summ="default" type="STRING"/>
					<colinfo id="PROWRK" size="256" summ="default" type="STRING"/>
					<colinfo id="PRO_R" size="256" summ="default" type="STRING"/>
					<colinfo id="SAFE" size="256" summ="default" type="STRING"/>
					<colinfo id="VER" size="256" summ="default" type="STRING"/>
					<colinfo id="SAFE_CK" size="256" summ="default" type="STRING"/>
					<colinfo id="APPR1_YN" size="256" summ="default" type="STRING"/>
					<colinfo id="APPR2_YN" size="256" summ="default" type="STRING"/>
					<colinfo id="APPR3_YN" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_beforeType">
				<Contents>
					<colinfo id="TYPE" size="256" summ="default" type="STRING"/>
					<record>
						<TYPE>EL01</TYPE>
					</record>
					<record>
						<TYPE>EL02</TYPE>
					</record>
					<record>
						<TYPE>EL03</TYPE>
					</record>
					<record>
						<TYPE>EL04</TYPE>
					</record>
					<record>
						<TYPE>EL05</TYPE>
					</record>
					<record>
						<TYPE>ES01</TYPE>
					</record>
					<record>
						<TYPE>JC01</TYPE>
					</record>
					<record>
						<TYPE>JC02</TYPE>
					</record>
					<record>
						<TYPE>JC03</TYPE>
					</record>
					<record>
						<TYPE>JC04</TYPE>
					</record>
					<record>
						<TYPE>MW01</TYPE>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_lifnr_grid">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_condLifnr">
				<Contents>
					<colinfo id="LIFNR" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_save_ck">
				<Contents>
					<colinfo id="PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
					<colinfo id="GUBUN" size="256" summ="default" type="STRING"/>
					<colinfo id="PRONR" size="256" summ="default" type="STRING"/>
					<colinfo id="PROWRK" size="256" summ="default" type="STRING"/>
					<colinfo id="PRO_R" size="256" summ="default" type="STRING"/>
					<colinfo id="SAFE" size="256" summ="default" type="STRING"/>
					<colinfo id="VER" size="256" summ="default" type="STRING"/>
					<colinfo id="SAFE_CK" size="256" summ="default" type="STRING"/>
					<colinfo id="APPR1_YN" size="256" summ="default" type="STRING"/>
					<colinfo id="APPR2_YN" size="256" summ="default" type="STRING"/>
					<colinfo id="APPR3_YN" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
		</Datasets>
		<Shape BKColor="user0" Bottom="56" Height="56" Id="Shape0" Left="0" LineColor="user1" Right="978" TabOrder="1" Top="0" Type="Rectangle" Width="978"></Shape>
		<Static Align="Right" DomainID="com.pjtno" Height="20" Id="st_pjt" Left="8" Style="sty_lb_search" TabOrder="2" Text="프로젝트번호&#32;" Top="29" VAlign="Middle" Width="92"></Static>
		<Edit BindDataset="ds_cond" Border="Flat" CheckLength="Byte" Column="PSPID" Height="20" Id="ed_pspid" ImeMode="english" Left="104" MaxLength="6" Style="sty_ipt_search" TabOrder="3" Top="29" UpperOnly="TRUE" Width="78"></Edit>
		<Button Height="18" Id="Button0" ImageID="btn_icon_search" Left="185" OnClick="btn_pjt_OnClick" TabOrder="4" Text="Button0" Top="30" Width="18"></Button>
		<Static Align="Right" Height="20" Id="Static18" Left="208" Style="sty_lb_search" TabOrder="5" Text="사무소&#32;" Top="5" VAlign="Middle" Width="92"></Static>
		<Static Align="Right" Border="Flat" Enable="FALSE" Height="20" Id="Static19" Left="1014" Style="sty_ipt_search" TabOrder="6" Top="4" VAlign="Middle" Visible="FALSE" Width="138"></Static>
		<Checkbox BindDataset="ds_cond" Column="SO4" Enable="FALSE" FalseValue="0" Height="18" Id="chk_so4" Left="1087" Style="sty_ipt_search_chk" TabOrder="8" Text="강북팀" Top="5" TrueValue="1" Visible="FALSE" Width="61"></Checkbox>
		<Checkbox BindDataset="ds_cond" Column="SO3" Enable="FALSE" FalseValue="0" Height="18" Id="chk_so3" Left="1018" Style="sty_ipt_search_chk" TabOrder="7" Text="강남팀" Top="5" TrueValue="1" Visible="FALSE" Width="58"></Checkbox>
		<Static Align="Right" Height="20" Id="st_date" Left="8" Style="sty_lb_search" TabOrder="9" Text="조회일자&#32;" Top="5" VAlign="Middle" Width="92"></Static>
		<Calendar BindDataset="ds_cond" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="INP_DTF" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="ed_inpday_f" Left="104" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_search" SundayTextColor="user35" TabOrder="10" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="5" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="94"></Calendar>
		<Grid AreaSelect="TRUE" AutoFitEndLine="Hide" BindDataset="ds_list1" BkColor2="default" BoldHead="true" Border="Flat" Bottom="558" CellMoving="TRUE" ColSelect="TRUE" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="478" Id="grd_list1" InputPanel="FALSE" Left="8" LineColor="user20" LineType="ExHORZ" OnCellClick="grd_list1_OnCellClick" OnHeadClick="grd_list1_OnHeadClick" Right="968" RowHeight="20" Style="sty_grid" TabOrder="11" TabStop="true" Top="80" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="960">
			<contents>
				<format id="Default">
					<columns>
						<col fix="left" width="30"/>
						<col fix="left" width="70"/>
						<col fix="left" width="181"/>
						<col fix="left" width="70"/>
						<col fix="left" width="70"/>
						<col fix="left" width="60"/>
						<col fix="left" width="60"/>
						<col fix="left" width="118"/>
						<col width="70"/>
						<col width="70"/>
						<col width="60"/>
						<col width="73"/>
						<col width="106"/>
						<col width="70"/>
						<col width="80"/>
						<col width="70"/>
						<col width="80"/>
						<col width="158"/>
						<col width="50"/>
						<col width="50"/>
						<col width="70"/>
						<col width="76"/>
						<col width="76"/>
						<col width="0"/>
						<col width="0"/>
						<col width="76"/>
						<col width="70"/>
						<col width="60"/>
					</columns>
					<head>
						<cell bkimageid="icon_grid_sel" col="0" display="text" rowspan="2"/>
						<cell align="center" col="1" color="user21" display="text" font="굴림,9" rowspan="2" text="프로젝트"/>
						<cell align="center" col="2" color="user21" display="text" font="굴림,9" rowspan="2" text="현장명"/>
						<cell align="center" col="3" color="user21" display="text" font="굴림,9" rowspan="2" text="호기"/>
						<cell align="center" col="4" color="user21" display="text" font="굴림,9" rowspan="2" text="동정보"/>
						<cell align="center" col="5" color="user21" display="text" font="굴림,9" rowspan="2" text="기종"/>
						<cell align="center" col="6" color="user21" display="text" font="굴림,9" rowspan="2" text="TYPE"/>
						<cell align="center" col="7" color="user21" display="text" font="굴림,9" rowspan="2" text="사양"/>
						<cell align="center" col="8" color="user21" display="text" font="굴림,9" rowspan="2" text="착공예정일"/>
						<cell align="center" col="9" color="user21" display="text" font="굴림,9" rowspan="2" text="준공예정일"/>
						<cell align="center" col="10" color="user21" display="text" font="굴림,9" rowspan="2" text="사무소"/>
						<cell align="center" col="11" color="user21" display="text" font="굴림,9" rowspan="2" text="PM"/>
						<cell align="center" col="12" color="user21" display="text" font="굴림,9" rowspan="2" text="협력업체"/>
						<cell align="center" col="13" color="user21" display="text" font="굴림,9" rowspan="2" text="팀장"/>
						<cell align="center" col="14" color="user21" colspan="4" display="text" font="굴림,9" text="작업일보&#32;투입일자&#32;기준&#32;신청율"/>
						<cell align="center" col="18" color="user21" colspan="2" display="text" font="굴림,9" text="PM수정/승인"/>
						<cell align="center" col="20" color="user21" display="text" font="굴림,9" rowspan="2" text="승인일"/>
						<cell col="18" color="user21" display="text" font="굴림,9" row="1" text="수정"/>
						<cell col="21" color="user21" colspan="5" display="text" font="굴림,9" text="단계별&#32;안전단계"/>
						<cell col="14" color="user21" display="text" font="굴림,9" row="1" text="전월기성(%)"/>
						<cell col="15" color="user21" display="text" font="굴림,9" row="1" text="신청율(%)"/>
						<cell col="16" color="user21" display="text" font="굴림,9" row="1" text="일보누계(%)"/>
						<cell col="17" color="user21" display="text" font="굴림,9" row="1" text="진행단계"/>
						<cell col="19" color="user21" display="text" font="굴림,9" row="1" text="승인율"/>
						<cell col="21" color="user21" display="text" font="굴림,9" row="1" text="1단계"/>
						<cell col="22" color="user21" display="text" font="굴림,9" row="1" text="2단계"/>
						<cell col="23" color="user21" display="text" font="굴림,9" row="1"/>
						<cell col="24" color="user21" display="text" font="굴림,9" row="1"/>
						<cell col="25" color="user21" display="text" font="굴림,9" row="1" text="3단계"/>
						<cell align="center" col="26" color="user21" display="text" font="굴림,9" rowspan="2" text="상태(일식)"/>
						<cell align="center" col="27" color="user21" display="text" font="굴림,9" rowspan="2" text="일식외주"/>
					</head>
					<body>
						<cell align="center" col="0" colid="CHECK" display="checkbox" edit='expr:iif(S_PRO&#32;&lt;&#32;0.0&#32;OR&#32;TOT_PRO&#32;==&#32;PRO_R&#32;&#32;,&quot;none&quot;&#32;,&quot;checkbox&quot;)'/>
						<cell align="center" bkcolor2="user22" col="1" colid="PSPID" color="expr:iif(DELEF&#32;==&#32;&apos;X&apos;,&#32;&apos;red&apos;,&#32;&apos;black&apos;)" display="text" suppress="1"/>
						<cell align="left" bkcolor2="user22" col="2" colid="ZSITE_NM" color="expr:iif(DELEF&#32;==&#32;&apos;X&apos;,&#32;&apos;red&apos;,&#32;&apos;black&apos;)" display="text" suppress="2"/>
						<cell align="center" bkcolor2="user22" col="3" colid="POSID" color="expr:iif(DELEF&#32;==&#32;&apos;X&apos;,&#32;&apos;red&apos;,&#32;&apos;black&apos;)" display="text"/>
						<cell align="center" bkcolor2="user22" col="4" colid="POSID_DONG" color="expr:iif(DELEF&#32;==&#32;&apos;X&apos;,&#32;&apos;red&apos;,&#32;&apos;black&apos;)" display="text"/>
						<cell align="center" bkcolor2="user22" col="5" colid="ZSPEC1" color="expr:iif(DELEF&#32;==&#32;&apos;X&apos;,&#32;&apos;red&apos;,&#32;&apos;black&apos;)" display="text"/>
						<cell align="center" bkcolor2="user22" col="6" colid="TYPE" color="expr:iif(DELEF&#32;==&#32;&apos;X&apos;,&#32;&apos;red&apos;,&#32;&apos;black&apos;)" display="text"/>
						<cell bkcolor2="user22" col="7" colid="ZSPEC2" color="expr:iif(DELEF&#32;==&#32;&apos;X&apos;,&#32;&apos;red&apos;,&#32;&apos;black&apos;)" display="text"/>
						<cell align="center" bkcolor2="user22" col="8" colid="ZZSHIP1" color="expr:iif(DELEF&#32;==&#32;&apos;X&apos;,&#32;&apos;red&apos;,&#32;&apos;black&apos;)" display="text" Mask="####.##.##"/>
						<cell align="center" bkcolor2="user22" col="9" colid="ZZCOMP2" color="expr:iif(DELEF&#32;==&#32;&apos;X&apos;,&#32;&apos;red&apos;,&#32;&apos;black&apos;)" display="text" Mask="####.##.##"/>
						<cell align="center" bkcolor2="user22" col="10" colid="TEXT30" color="expr:iif(DELEF&#32;==&#32;&apos;X&apos;,&#32;&apos;red&apos;,&#32;&apos;black&apos;)" display="text"/>
						<cell align="center" bkcolor2="user22" col="11" colid="NAMET" color="expr:iif(DELEF&#32;==&#32;&apos;X&apos;,&#32;&apos;red&apos;,&#32;&apos;black&apos;)" display="text"/>
						<cell align="left" bkcolor2="user22" col="12" colid="NAME1" color="expr:iif(DELEF&#32;==&#32;&apos;X&apos;,&#32;&apos;red&apos;,&#32;&apos;black&apos;)" display="text"/>
						<cell align="center" bkcolor2="user22" col="13" colid="NAMET2" color="expr:iif(DELEF&#32;==&#32;&apos;X&apos;,&#32;&apos;red&apos;,&#32;&apos;black&apos;)" display="text"/>
						<cell align="right" bkcolor2="user22" col="14" colid="PRO_R" color="expr:iif(DELEF&#32;==&#32;&apos;X&apos;,&#32;&apos;red&apos;,&#32;&apos;black&apos;)" display="number" Mask="##0.00"/>
						<cell align="right" bkcolor2="user22" col="15" colid="S_PRO" color="expr:iif(DELEF&#32;==&#32;&apos;X&apos;,&#32;&apos;red&apos;,&#32;&apos;black&apos;)" display="number" Mask="##0.00"/>
						<cell align="right" bkcolor2="user22" col="16" colid="TOT_PRO" color="expr:iif(DELEF&#32;==&#32;&apos;X&apos;,&#32;&apos;red&apos;,&#32;&apos;black&apos;)" display="number" Mask="##0.00"/>
						<cell align="left" bkcolor2="user22" bkimagealign="left" col="17" colid="PROWRK" color="expr:iif(DELEF&#32;==&#32;&apos;X&apos;,&#32;&apos;red&apos;,&#32;&apos;black&apos;)" display="text"/>
						<cell align="center" bkcolor2="user22" col="18" color="expr:iif(DELEF&#32;==&#32;&apos;X&apos;,&#32;&apos;red&apos;,&#32;&apos;black&apos;)" display="button" edit="button" text="공정표"/>
						<cell align="right" bkcolor="yellow" col="19" colid="SUM_PRO_R" color="expr:iif(DELEF&#32;==&#32;&apos;X&apos;,&#32;&apos;red&apos;,&#32;&apos;black&apos;)" display="number" Mask="##0.00"/>
						<cell align="center" bkcolor2="user22" col="20" colid="APPR_DT" color="expr:iif(DELEF&#32;==&#32;&apos;X&apos;,&#32;&apos;red&apos;,&#32;&apos;black&apos;)" display="text" Mask="####.##.##"/>
						<cell align="center" col="21" colid="STEP1_DT" color="expr:iif(DELEF&#32;==&#32;&apos;X&apos;,&#32;&apos;red&apos;,&#32;&apos;black&apos;)" display="text" Mask="####.##.##"/>
						<cell align="center" col="22" colid="STEP2_DT" color="expr:iif(DELEF&#32;==&#32;&apos;X&apos;,&#32;&apos;red&apos;,&#32;&apos;black&apos;)" display="text" Mask="####.##.##"/>
						<cell align="center" bkcolor2="user22" col="23" colid="ZZGUBUN" color="expr:iif(DELEF&#32;==&#32;&apos;X&apos;,&#32;&apos;red&apos;,&#32;&apos;black&apos;)" display="text"/>
						<cell bkcolor2="user22" bkimagealign="left" col="24" colid="MI_PERNO" color="expr:iif(DELEF&#32;==&#32;&apos;X&apos;,&#32;&apos;red&apos;,&#32;&apos;black&apos;)" display="text" edit="number"/>
						<cell align="center" col="25" colid="STEP3_DT" color="expr:iif(DELEF&#32;==&#32;&apos;X&apos;,&#32;&apos;red&apos;,&#32;&apos;black&apos;)" display="text" Mask="####.##.##"/>
						<cell align="center" bkcolor2="user22" col="26" colid="TXT30" color="expr:iif(DELEF&#32;==&#32;&apos;X&apos;,&#32;&apos;red&apos;,&#32;&apos;black&apos;)" display="text"/>
						<cell align="center" bkcolor2="user22" col="27" colid="ZZILSIC" color="expr:iif(DELEF&#32;==&#32;&apos;X&apos;,&#32;&apos;red&apos;,&#32;&apos;black&apos;)" display="text"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Static Align="Right" Height="20" Id="st_zzpmnum" Left="209" Style="sty_lb_search" TabOrder="12" Text="PM&#32;" Top="29" VAlign="Middle" Width="92"></Static>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="CODE" Column="ZZPMNUM" DataColumn="CODE_NAME" Height="20" Id="cb_zzpmnum" InnerDataset="ds_zzpmnum_cd" Left="303" Style="sty_ipt_search" TabOrder="13" Top="29" Width="120"></Combo>
		<Static Align="Right" Height="20" Id="Static2" Left="400" Style="sty_lb_search" TabOrder="14" Text="설치협력사&#32;" Top="5" VAlign="Middle" Width="92"></Static>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="CODE" Column="ZZLIFNR" DataColumn="CODE_NAME" Height="20" Id="cb_zzlifnr" InnerDataset="ds_zzlifnr" Left="1032" Style="sty_ipt_search" TabOrder="15" Top="5" Visible="FALSE" Width="162"></Combo>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="CODE" Column="ZZACTSS" DataColumn="CODE_NAME" Height="20" Id="cb_zzactss" InnerDataset="ds_zzactss" Left="302" OnChanged="cb_zzactss_OnChanged" Style="sty_ipt_search" TabOrder="16" Top="5" Width="94"></Combo>
		<Edit BindDataset="ds_cond" Border="Flat" CheckLength="Byte" Column="ZZLIFNR_NM" Height="20" Id="edt_lifnr" ImeMode="native" Left="496" MaxLength="30" OnKeyDown="edt_lifnr_OnKeyDown" Style="sty_ipt_search" TabOrder="17" Top="5" UpperOnly="TRUE" Width="151"></Edit>
		<Button Height="18" Id="btn_lifnr" ImageID="btn_icon_search" Left="650" OnClick="btn_lifnr_OnClick" TabOrder="18" Text="btn_lifnr" Top="6" Width="18"></Button>
		<Checkbox BindDataset="ds_cond" Column="COMP_SHOW_YN" FalseValue="0" Height="18" Id="chk_show" Left="452" Style="sty_ipt_search_chk" TabOrder="19" Text="기성체크&#32;100%&#32;현장&#32;보기" Top="31" TrueValue="1" Width="157"></Checkbox>
		<Static Color="user8" Font="Default,9,Bold" Height="14" Id="Static12" Left="11" Style="sty_ipt_form_read" TabOrder="20" Text="※&#32;호기의&#32;협력사&#32;팀장이&#32;퇴사한&#32;경우는&#32;데이터가&#32;빨간색으로&#32;표기됩니다.&#32;신속히&#32;협력사&#32;팀장을&#32;재지정&#32;바랍니다." Top="64" Width="679"></Static>
	</Form>
	<Script><![CDATA[/*
 *****************************************************************************************
 * 기      능   : 
 * 작  성  자   : 
 * 작성  일자   : 
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
#include "LIB::commons.js";	// 공통 스크립트 
//=========================================================================================
// [ PART 1 ]
// Form에서 사용될 전역변수를 선언
// FORM에서 사용되는 전역변수는 대문자로 작성하며, F_XXX 의 형태를 갖도록 한다. 
//=========================================================================================
var userGroup = "";
var args = "";
var curr_date = "";
var F_POSID="";
var F_GUBUN="";
var F_TYPE="";
var F_SAFE="";
var F_ZSPEC="";  //기존 공정표 이용을 위하여
var F_CHK = ""; // 사무소 프로젝트 필터 체크 
//var userGroup = "";
//=========================================================================================
// [ PART 2 ]
// Form Loading / Unloading 시 작업 정의
//=========================================================================================
function fn_OnLoadCompleted(obj) 
{

	// Form 로드 이벤트 맨 첫줄에 기술 
	gfn_initForm(true);	
	
	userGroup = gfn_getUserGroup();


  // 저장  버튼명을 승인으로 변경
	btn_save.DomainID = "";
	btn_save.Text     = "승인";
	
	//trace("userGroup== " + userGroup);
  // 일보누계 100% 현장보기 Unchecked
  chk_show.Value = 0;
  
	if(userGroup == '10' || userGroup == '20')
	{	
		cb_zzpmnum.Enable = true;
		btn_save.visible = false;
	}
	else if( userGroup == '30' )
	{

		cb_zzpmnum.Enable = true;
        btn_save.visible = true;
        
		tit_clearActionInfo();		
		tit_addSearchActionInfo("ps02:PS0201001A_S32");
		tit_callService(
		""
		, ""
		, "ds_cond=ds_cond"
		, "ds_zzpmnum_cd=ds_zzpmnum_cd"  // ds_pronr=ds_pronr"
		, ""
		, ""   //"fn_afterQueryC"
		, ""
		, ""
		, true);
		
		
	}
	else if( userGroup == '40' )
	{
		cb_zzpmnum.Enable = true;
		btn_save.visible = true;
	}
	
		
	ed_inpday_f.value = gfn_getCurrDate();
	

	ds_cond.SetColumn(0,"USER_GRUP",userGroup);
	if (userGroup == "10")
	{
		ds_cond.SetColumn(0,"USER_CODE",G_VEND_CODE_E);
	}
	else if (userGroup == "20")
	{
		ds_cond.SetColumn(0,"USER_CODE",G_USER_ID);
	}
	else if (userGroup == "30")
	{
		ds_cond.SetColumn(0,"USER_CODE",G_AREA_CODE_E);
	}
	
	var codeArr = ["PS003"];
    var dsObjArr = [ds_zzactss];
    var addTypeArr = [G_CODE_ALL];
    gfn_searchCommCode(codeArr, dsObjArr, addTypeArr);
	
	tit_clearActionInfo();
	tit_addSearchActionInfo("wb01:SEOLCHI_VEND_S2");
	//tit_addSearchActionInfo("ps02:PS0205001A_S8");      //공정 코드

	tit_callService(
		""
		, ""
		, "ds_cond=ds_cond"
		, "ds_zzlifnr=ds_lifnr_cd"  // ds_pronr=ds_pronr"
		, ""
		, "fn_afterQueryC"
		, ""
		, ""
		, true);

	
	
	ed_inpday_f.SETFOCUS();
	gfn_showMsg("CI00007");
					
}

/********************************************************************************
* 기      능   :  협력사 조회 Callback  
********************************************************************************/
function fn_afterQueryC(errCode, errMsg) {
	cb_zzlifnr.Index = 0;

	if ( userGroup == "10" )
	{
		//cb_zzlifnr.Enable = false;
	}
	else if ( userGroup == "30" || userGroup == "40")
	{
					
		ds_zzlifnr.filter("LOEVM!='X'" );		
		gfn_insertEmptyRow( ds_zzlifnr, G_CODE_ALL );
		cb_zzlifnr.value = "";
	}
}


/********************************************************************************
* 기      능   : 공통코드가 조회된 후의 Callback 함수 
********************************************************************************/
function fn_completeInit(sCode, sDsObj, sCodeType) 
{


	if(userGroup == "40")
	{
		cb_zzactss.Index = 0;
		cb_zzactss.Enable = true;
	}
	else if(userGroup == "30")
	{
		ds_zzactss.Filter("CODE="+quote(G_AREA_CODE_E));
		cb_zzactss.Index = 0;
		cb_zzactss.Enable = false;
	}
	else if(userGroup == "10")
	{
		cb_zzactss.Index = 0;
		cb_zzactss.Enable = false;
	}

}


/********************************************************************************
* 기      능   : form UnloadCompleted 
********************************************************************************/
function fn_OnUnloadCompleted(obj) 
{
	return gfn_isFormUnload(obj);
}




/********************************************************************************
* 기      능   : 조회 Callback  - 설치협력사 로그인시 협력업체코드 첫번째 선택
********************************************************************************/
function fn_afterQueryA(errCode, errMsg) 
{
   
}

//=========================================================================================
// [ PART 3 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,form닫기)
//=========================================================================================
/********************************************************************************
* 기      능   : 조회
********************************************************************************/
function fn_query() 
{

    // 투입일자 필수 
   if(gfn_isNull(ed_inpday_f, true, st_date.value))  return;	

    
	tit_clearActionInfo();	
	//tit_addSearchActionInfo("ps02:PS0207003A_S1");
	tit_addSearchActionInfo("ps02:PS0207003A_S3");  	  //==> PS0207003A_S1 기존파일  --> 작업일보 일일작업내역(NEW) 반영 시 필요 
	//tit_addCsvSearchActionInfo("ps02:PS0207003A_S1"); 
	
	tit_callService(
          ""
        , ""
        , "ds_cond=ds_cond"
        , "ds_list1=ds_list1"  
        , ""
        , "fn_afterQuery"  
        , ""
        , ""
        , true);
        
}

/********************************************************************************
* 기      능   : DS_LIST1 데이터셋 변경
********************************************************************************/
function ds_list1_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{
			
	obj.fireevent = false;
		
	switch( strColumnID ) 
	{
	
								
		/*case "SAFE1":
			ds_list1.SetColumn(nRow,"CHECK","1");
		case "SAFE2":
			ds_list1.SetColumn(nRow,"CHECK","1");
		case "SAFE3":
        	ds_list1.SetColumn(nRow,"CHECK","1");	
		*/						
								
									
	}
	
	obj.fireevent = true;
	
}

/********************************************************************************
* 기      능   : 닫기 
********************************************************************************/
function fn_close() 
{
	close();
}

//=========================================================================================
// [ PART 4]
// Callback 함수 정의 : callback 함수명은 메인 함수의 fn_xxxx() 에서 xxxx 부분은 fn_afterXXXX()
// 형태가 되도록 작성 
//=========================================================================================
/********************************************************************************
* 기      능   : 조회 Callback 
********************************************************************************/
function fn_afterQuery(errCode, errMsg) 
{
	gfn_showSearchMsg(grd_list1, errCode, errMsg);
	
}
//=========================================================================================
// [ PART 5 ]
// Detail Process Event 정의 ( User Define function )
// 사용자 정의 함수는 ufn_xxxx() 형태로 작성 
//=========================================================================================

/********************************************************************************
* 기      능   : 액셀  
********************************************************************************/
function fn_excel() 
{
	if( ds_list1.rowcount > 0 )
	{
		gfn_saveToExcel(grd_list1, true );
		break;
	}
}
//=========================================================================================
// [ PART 6 ]
// component Event 정의 : 각 Component 별 이벤트 
//=========================================================================================
/********************************************************************************
* 기      능   : 텝 선택시
********************************************************************************/
function Tab00_OnChanged(obj, nOldIndex, nNewIndex)
{

}
/********************************************************************************
* 기      능   : 원프로젝트 팝업
********************************************************************************/
function btn_pjt_OnClick(obj)
{
	var arg = "pjt="+quote(ed_pjt.Text);
	
	gfn_openPopup("PS9601002A",true,arg);
	
	//fn_query();
}
/********************************************************************************
* 기      능   : 리스트의 타이틀 클릭  
********************************************************************************/
function grd_list1_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
{
	if ( nCell == 0 ) {
		return;
	}
	else if ( nCell == 1 ) {
		// 그리드 표시할 컬럼 선택 
		gfn_selectAllGrid(obj,nCell,nCell,true);
	} else {
		// 그리드 정렬 처리 
		gfn_sortGrid(obj,nCell);
	}	
}
/********************************************************************************
* 기      능   : 프로젝트에서 엔터키 처리 
********************************************************************************/
function ed_pjt_OnKeyDown(obj,nChar,bShift,bCtrl, bAlt,LLParam,HLParam)
{
}
/********************************************************************************
* 기      능   : 저장
********************************************************************************/
function fn_save() 
{
 
  // 그리드 저장 대상 로우
	if(ds_list1.FindRow("CHECK", 1)==-1){
		gfn_showMsg('CW00046');
		return;
	}
   
   if (!gfn_showConfirm("CW10025","승인하시겠습니까?")) 
	{
		return;
	}
     ds_list3_tmp.ClearData();	
	 ds_list1.Filter("CHECK==1");
	 ds_list2.copyF(ds_list1);
     ds_list1.unFilter();
     
     
    for(var i=0;i<ds_list2.GetRowCount();i++)
    {
       if(ds_cond1.GetRowCount()==0)	ds_cond1.AddRow();
      
        ds_list3.ClearData();
        
        ds_cond1.SetColumn(0,"INP_DTF",ds_cond.GetColumn(0,"INP_DTF"));
        ds_cond1.SetColumn(0,"PSPID",ds_list2.GetColumn(i,"PSPID"));
        ds_cond1.SetColumn(0,"POSID",ds_list2.GetColumn(i,"POSID"));
        //ds_cond1.SetColumn(0,"SAFE",ds_list2.GetColumn(i,"SAFE")); 2021-06-30 고범석책임 요청 (안전에 상관없이 체크된 만큼 기성)
        ds_cond1.SetColumn(0,"VER",ds_list2.GetColumn(i,"VER"));    
              
         tit_clearActionInfo();
		 tit_addSearchActionInfo("ps02:PS0207003A_S2");
		 tit_callService(
		    ""
		  , ""
		  , "ds_cond1=ds_cond1"
		  , "ds_list3=ds_list3"
		  , ""
		  , ""
		  , ""
          , ""
		  , true);	
		  
		  
		  
  	  ds_list3_tmp.AppendDataset(ds_list3);
  	  
    }
    
    ds_save_ck.ClearData();
    nAddRow = 0;
    for(var i=0;i<ds_list3_tmp.GetRowCount();i++)
    {
		// 1단계 안전 승인
		if(ds_list3_tmp.GetColumn(i, "SAFE_CK") == 'X' && ds_list3_tmp.GetColumn(i, "SAFE") == 'A')
		{
			nAddRow = ds_save_ck.AddRow();
			ds_save_ck.CopyRow(nAddRow, ds_list3_tmp, i);
			ds_save_ck.SetColumn(nAddRow, "APPR1_YN", 'Y');
		}
		// 2단계 안전 승인
		if(ds_list3_tmp.GetColumn(i, "SAFE_CK") == 'X' && ds_list3_tmp.GetColumn(i, "SAFE") == 'B')
		{
			nAddRow = ds_save_ck.AddRow();
			ds_save_ck.CopyRow(nAddRow, ds_list3_tmp, i);
			ds_save_ck.SetColumn(nAddRow, "APPR2_YN", 'Y');
		}
		// 3단계 안전 승인
		if(ds_list3_tmp.GetColumn(i, "SAFE_CK") == 'X' && ds_list3_tmp.GetColumn(i, "SAFE") == 'C')
		{
			nAddRow = ds_save_ck.AddRow();
			ds_save_ck.CopyRow(nAddRow, ds_list3_tmp, i);
			ds_save_ck.SetColumn(nAddRow, "APPR3_YN", 'Y');
		}
    }
    
	
	
	if(ds_save_ck.GetRowCount() > 0)
	{
		tit_clearActionInfo();
        tit_addMultiActionInfo("ps02:PS0209001A_U1");//zpstw1502 update 
        tit_callService(
		  ""	
		, ""
		, "ds_save_ck=ds_save_ck"
		, ""
		, ""
		, "" //"fn_afterToTinsert"//"fn_afterSave"
		, ""
		, ""
		, true  // ""
       );
	}
	if(ds_list3_tmp.GetRowCount() > 0){

	    tit_clearActionInfo();
        tit_addMultiActionInfo("ps02:PS0207003A_I2");
        tit_callService(
		  ""	
		, ""
		, "ds_list3_tmp=ds_list3_tmp"
		, ""
		, ""
		, "fn_afterSave" //"fn_afterToTinsert"//"fn_afterSave"
		, ""
		, ""
		, true  // ""
       );
    
   }
   
    
   //trace(ds_list3_tmp.SaveXML());
}

function fn_afterSave()
{
	ds_list2.SetColumn(0,"INP_DT",ds_cond.GetColumn(0,"INP_DTF"));
	Trace(ds_list2.saveXML());
	if(ds_list2.GetRowCount() > 0){

	    tit_clearActionInfo();
        tit_addMultiActionInfo("ps02:PS0207003A_I5");
        tit_callService(
		  ""	
		, ""
		, "ds_list2=ds_list2"
		, ""
		, ""
		, ""//"fn_afterSave"
		, ""
		, ""
		, true  // ""
       );
    
   }
   
   fn_query();
}
/********************************************************************************
* 기      능   : 삭제 Callback  
********************************************************************************/
function fn_afterToTinsert(errCode, errMsg)
{

		tit_clearActionInfo();
        tit_addMultiActionInfo("ps02:PS0207003A_I2");
        tit_callService(
		  ""	
		, ""
		, "ds_list3_tmp=ds_list3_tmp"
		, ""
		, ""
		, ""//"fn_afterSave"
		, ""
		, ""
		, true  // ""
       );
}
/********************************************************************************
* 기      능   : 삭제 Callback  
********************************************************************************/
function fn_afterDelete(errCode, errMsg) 
{
}

/********************************************************************************
* 기      능   : 사무소콤보 변경시 설치PM 콤보값 생성
********************************************************************************/
function cb_zzactss_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
  if(userGroup == "40" || userGroup == "30"){
    ds_cond.SetColumn(0,"ZZLIFNR",''); }

    if(ds_cond.GetColumn(0,"ZZACTSS") == '')
    {
       ds_zzlifnr.UnFilter();
    }
    else
    {
      var arr = ds_cond.GetColumn(0,"ZZACTSS");
	  ds_zzlifnr.Filter("ZZACTSS ==" +quote(arr));
    }
	
	ds_cond_cd.SetColumn(0,"ZZACTSS",strCode);
	cb_zzpmnum.value = "";

	tit_clearActionInfo();
	tit_addSearchActionInfo("ps02:PS0201001A_S41");
	
	tit_callService(
		""
		, ""
		, "ds_cond_cd=ds_cond_cd"
		, "ds_zzpmnum_cd=ds_zzpmnum_cd"  // ds_pronr=ds_pronr"
		, ""
		, "fn_afterZzactssChange"
		, ""
		, ""
		, true);	
				
}

/********************************************************************************
* 기      능   : 조회 Callback  - 사무소 변경시
********************************************************************************/
function fn_afterZzactssChange(errCode, errMsg) {
	gfn_insertEmptyRow( ds_zzpmnum_cd, G_CODE_ALL );
	cb_zzpmnum.value = "";
}
/********************************************************************************
* 기      능   : 조회 Callback  - 공정진행현황 연동
********************************************************************************/
function grd_list1_OnCellClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
	var chk = "";
	//alert(length(ed_pspid.Text));
	//alert(length(cb_zzactss.Value));
    if(length(ed_pspid.Text) <= 0 && length(cb_zzactss.Value) <= 0 )
    {
       chk = 'N';
    }
    else
    {
        chk = 'Y';
    }
	//alert(chk);
	//gfn_openPopup("PS0207001B");//, true, args);
	if ( nCell == 18 ) 
	{
		// var arr = gfn_openWin('PS0204001A');
		var args = ' F_POSID='+quote(ds_list1.getColumn(nRow, "POSID"));
			args +=' F_GUBUN='+quote(ds_list1.getColumn(nRow, "ZZGUBUN"));
			args +=' F_TYPE='+quote(ds_list1.getColumn(nRow, "TYPE"));
			args +=' F_SAFE='+quote(ds_list1.getColumn(nRow, "SAFE"));
			args +=' F_ZSPEC='+quote(ds_list1.getColumn(nRow, "ZSPEC"));
			args +=' F_PSPID='+quote(ds_list1.getColumn(nRow, "PSPID"));
			args +=' F_CHK='+quote(chk);
			args +=' F_INP_DTF='+quote(ds_cond.GetColumn(0, "INP_DTF"));
			args +=' F_S_PRO2='+quote(ds_list1.getColumn(nRow, "S_PRO2"));
			args +=' F_VER='+quote(ds_list1.GetColumn(nRow, "VER"));//2019.03.13 강민석K 추가
		
		var pType = ds_list1.getColumn(nRow, "TYPE"); 

			 
		if( pType == "EL01" || pType == "EL02" || pType == "EL03" || pType == "EL04" || pType == "EL05" || pType == "ES01" ||
			 pType == "JC01" || pType == "JC02" || pType == "JC03" || pType == "JC04" || pType == "MW01" || pType == "")  //기존타입
		{// 기존타입 ( 일정기간 동안 신규타입 기존 타입을 같이사용)
			//Trace("## TYPE : " + ds_list3.getColumn(ds_list3.row, "TYPE"));
			if( ds_list3.getColumn(ds_list3.row, "TYPE") == '')// 기존 타입
			{
				gfn_openPopup("PS0207003B", true, args);
			}else{  
				if(ds_list1.getColumn(nRow, "ZZGUBUN") == "10"){
					gfn_openPopup("PS0207003C", true, args);
				}else if(ds_list1.getColumn(nRow, "ZZGUBUN") == "11"){
					gfn_openPopup("PS0207003D", true, args);
				}else if(ds_list1.getColumn(nRow, "ZZGUBUN") == "12"){
					gfn_openPopup("PS0207003E", true, args);
				}
			}
		}else{ //신규타입은 링크
			gfn_openWin("PS0209001A",args);  
		}
	}
}


function edt_lifnr_OnKeyDown(obj,nChar,bShift,bCtrl, bAlt,LLParam,HLParam)
{
	if(nChar == 13)
	{
		applyData();
	}
}

function btn_lifnr_OnClick(obj)
{
	//var arg = ds_list.GetColumn(nRow, "WRKLFN");
	var arg = 'F_ZZACTSS='+quote(ds_cond.getColumn(0, "ZZACTSS"));
	var arr = gfn_openPopup("PS0208001D", true, arg);
	
	if(Length(arr) > 0)
	{
		//ds_list.fireevent = false;
		ds_cond.SetColumn(0, "ZZLIFNR", arr[0]);
		ds_cond.SetColumn(0, "ZZLIFNR_NM", arr[1]);
		//ds_list.fireevent = true;
	}
}

function ds_cond_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{
	if(strColumnID == 'ZZLIFNR_NM')
	{
		if(length(Trim(varNewValue)) == 0)
		{
			ds_cond.SetColumn(0, "ZZLIFNR", "");
			ds_cond.SetColumn(0, "ZZLIFNR_NM", "");
			return;
		}
		
		// 존재하는 사업자번호 체크 (미존재시 팝업)
		nFindRow = ufn_chkLifnr(varNewValue);
		
		if(nFindRow < 0)	// 사업자 번호 미존재시 팝업을 띄워준다.
		{
			var arg = "";
			var arr = gfn_openPopup("PS0208001D", true, arg);
			
			if(Length(arr) > 0)
			{
				ds_cond.SetColumn(0, "ZZLIFNR", arr[0]);
				ds_cond.SetColumn(0, "ZZLIFNR_NM", arr[1]);
			}

		}
		else
		{
			if(nFindRow == 1)
			{
				ds_cond.SetColumn(0, "ZZLIFNR", ds_lifnr_grid.GetColumn(0, "CODE"));
				ds_cond.SetColumn(0, "ZZLIFNR_NM", ds_lifnr_grid.GetColumn(0, "CODE_NAME"));
			}
			else
			{
				var arg = "F_LIFNR_N="+quote(varNewValue);
				var arr = gfn_openPopup("PS0208001D", true, arg);
				
				if(Length(arr) > 0)
				{
					ds_cond.SetColumn(0, "ZZLIFNR", arr[0]);
					ds_cond.SetColumn(0, "ZZLIFNR_NM", arr[1]);
				}
			}
			
		}
	}
}

function ufn_chkLifnr(lifnr)
{
	var rValue = 0;
	
	ds_condLifnr.ClearData();
	ds_condLifnr.addRow();
	ds_condLifnr.SetColumn(0, "LIFNR", lifnr);
	
	tit_clearActionInfo();
	tit_addSearchActionInfo("ps02:PS0208001D_S2");
	tit_callService(
		""
		, ""
		, "ds_cond=ds_condLifnr"
		, "ds_lifnr_grid=ds_lifnr_grid"
		, ""
		, "" // fn_afterQueryC
		, ""
		, ""
		, true);
	
	if(ds_lifnr_grid.GetRowCount() == 0)
	{
		rValue = -1;
	}
	else
	{
		rValue = ds_lifnr_grid.GetRowCount();
	}
	
	return rValue;
}]]></Script>
</Window>