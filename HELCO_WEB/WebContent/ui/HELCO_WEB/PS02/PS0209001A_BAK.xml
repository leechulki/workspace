<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="562" Id="PS0209001A" Left="8" OnLoadCompleted="fn_OnLoadCompleted" OnUnloadCompleted="fn_OnUnloadCompleted" PidAttrib="7" Title="투입일자별&#32;작업일&#32;조회&#32;및&#32;승인(2019)" Top="8" Ver="1.0" Width="978" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_cond">
				<Contents>
					<colinfo id="PSPID" size="255" summ="default" type="STRING"/>
					<colinfo id="ZZLIFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="INP_DTF" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZACTSS" size="256" summ="default" type="STRING"/>
					<colinfo id="CURR_DATE" size="256" summ="default" type="STRING"/>
					<colinfo id="USER_GRUP" size="256" summ="default" type="STRING"/>
					<colinfo id="USER_CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="G_USER_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZPMNUM" size="256" summ="default" type="STRING"/>
					<colinfo id="POPID" size="256" summ="default" type="STRING"/>
					<colinfo id="SO3" size="256" summ="default" type="STRING"/>
					<colinfo id="SO4" size="256" summ="default" type="STRING"/>
					<record>
						<CURR_DATE></CURR_DATE>
						<G_USER_ID></G_USER_ID>
						<INP_DTF></INP_DTF>
						<POPID></POPID>
						<PSPID></PSPID>
						<SO3></SO3>
						<SO4></SO4>
						<USER_CODE></USER_CODE>
						<USER_GRUP></USER_GRUP>
						<ZZACTSS></ZZACTSS>
						<ZZLIFNR></ZZLIFNR>
						<ZZPMNUM></ZZPMNUM>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_zzactss">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME></CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_zzlifnr">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
					<colinfo id="SORTL" size="256" type="STRING"/>
					<colinfo id="LOEVM" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_zzpmnum_cd">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME></CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond_cd">
				<Contents>
					<colinfo id="TEMNO" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZACTSS" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZSAWONNUM" size="256" summ="default" type="STRING"/>
					<colinfo id="TMCD" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZLIFNR" size="256" summ="default" type="STRING"/>
					<record>
						<TEMNO></TEMNO>
						<TMCD></TMCD>
						<ZZACTSS></ZZACTSS>
						<ZZLIFNR></ZZLIFNR>
						<ZZSAWONNUM></ZZSAWONNUM>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list2">
				<Contents>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSPEC1" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSPEC2" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZSHIP1" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZCOMP2" size="256" summ="default" type="STRING"/>
					<colinfo id="PMCD" size="256" summ="default" type="STRING"/>
					<colinfo id="TMCD" size="256" summ="default" type="STRING"/>
					<colinfo id="PRONR" size="256" summ="default" type="STRING"/>
					<colinfo id="PRO_R" size="256" summ="default" type="STRING"/>
					<colinfo id="PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSITE_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZGUBUN" size="256" summ="default" type="STRING"/>
					<colinfo id="INIT_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="M_MH" size="256" summ="default" type="STRING"/>
					<colinfo id="N_MH" size="256" summ="default" type="STRING"/>
					<colinfo id="A_MH" size="256" summ="default" type="STRING"/>
					<colinfo id="SUM_MH" size="256" summ="default" type="STRING"/>
					<colinfo id="NAMEE" size="256" summ="default" type="STRING"/>
					<colinfo id="PROWRK" size="256" summ="default" type="STRING"/>
					<colinfo id="TOT_PRO" size="256" summ="default" type="STRING"/>
					<colinfo id="NAME1" size="256" summ="default" type="STRING"/>
					<colinfo id="NAMET" size="256" summ="default" type="STRING"/>
					<colinfo id="NAMET2" size="256" summ="default" type="STRING"/>
					<colinfo id="CHECK" size="256" summ="default" type="STRING"/>
					<colinfo id="TYPE" size="256" summ="default" type="STRING"/>
					<colinfo id="APPR_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="APP_PRO" size="256" summ="default" type="STRING"/>
					<colinfo id="S_PRO" size="256" summ="default" type="STRING"/>
					<colinfo id="TXT30" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZILSIC" size="256" summ="default" type="STRING"/>
					<colinfo id="TEXT30" size="256" summ="default" type="STRING"/>
					<colinfo id="STEP1_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="STEP2_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="STEP3_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="SAFE" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSPEC" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID_DONG" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond1">
				<Contents>
					<colinfo id="PSPID" size="255" summ="default" type="STRING"/>
					<colinfo id="INP_DTF" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
					<colinfo id="SAFE" size="256" summ="default" type="STRING"/>
					<record>
						<INP_DTF></INP_DTF>
						<POSID></POSID>
						<PSPID></PSPID>
						<SAFE></SAFE>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list3">
				<Contents>
					<colinfo id="PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
					<colinfo id="GUBUN" size="256" summ="default" type="STRING"/>
					<colinfo id="PRONR" size="256" summ="default" type="STRING"/>
					<colinfo id="PROWRK" size="256" summ="default" type="STRING"/>
					<colinfo id="PRO_R" size="256" summ="default" type="STRING"/>
					<colinfo id="SAFE" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list3_tmp">
				<Contents>
					<colinfo id="PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
					<colinfo id="GUBUN" size="256" summ="default" type="STRING"/>
					<colinfo id="PRONR" size="256" summ="default" type="STRING"/>
					<colinfo id="PROWRK" size="256" summ="default" type="STRING"/>
					<colinfo id="PRO_R" size="256" summ="default" type="STRING"/>
					<colinfo id="SAFE" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_pop1"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_pop2"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_pop3"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_pop">
				<Contents></Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list1" OnColumnChanged="ds_list1_OnColumnChanged">
				<Contents>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSPEC1" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSPEC2" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZSHIP1" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZCOMP2" size="256" summ="default" type="STRING"/>
					<colinfo id="PMCD" size="256" summ="default" type="STRING"/>
					<colinfo id="TMCD" size="256" summ="default" type="STRING"/>
					<colinfo id="PRONR" size="256" summ="default" type="STRING"/>
					<colinfo id="PRO_R" size="256" summ="default" type="STRING"/>
					<colinfo id="PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSITE_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZGUBUN" size="256" summ="default" type="STRING"/>
					<colinfo id="INIT_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="M_MH" size="256" summ="default" type="STRING"/>
					<colinfo id="N_MH" size="256" summ="default" type="STRING"/>
					<colinfo id="A_MH" size="256" summ="default" type="STRING"/>
					<colinfo id="SUM_MH" size="256" summ="default" type="STRING"/>
					<colinfo id="NAMEE" size="256" summ="default" type="STRING"/>
					<colinfo id="PROWRK" size="256" summ="default" type="STRING"/>
					<colinfo id="TOT_PRO" size="256" summ="default" type="STRING"/>
					<colinfo id="NAME1" size="256" summ="default" type="STRING"/>
					<colinfo id="NAMET" size="256" summ="default" type="STRING"/>
					<colinfo id="NAMET2" size="256" summ="default" type="STRING"/>
					<colinfo id="CHECK" size="256" summ="default" type="STRING"/>
					<colinfo id="TYPE" size="256" summ="default" type="STRING"/>
					<colinfo id="APPR_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="APP_PRO" size="256" summ="default" type="STRING"/>
					<colinfo id="S_PRO" size="256" summ="default" type="STRING"/>
					<colinfo id="TXT30" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZILSIC" size="256" summ="default" type="STRING"/>
					<colinfo id="TEXT30" size="256" summ="default" type="STRING"/>
					<colinfo id="STEP1_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="STEP2_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="STEP3_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="SAFE" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSPEC" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID_DONG" size="256" summ="default" type="STRING"/>
					<colinfo id="HO_CNT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_save">
				<Contents>
					<colinfo id="FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID_1" size="256" summ="default" type="STRING"/>
					<colinfo id="GUBUN" size="256" summ="default" type="STRING"/>
					<colinfo id="PRONR" size="256" summ="default" type="STRING"/>
					<colinfo id="PROWRK" size="256" summ="default" type="STRING"/>
					<colinfo id="PRO_R" size="256" summ="default" type="STRING"/>
					<colinfo id="CRDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="VER" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_save1">
				<Contents>
					<colinfo id="FLAG" size="256" type="STRING"/>
					<colinfo id="POSID" size="256" type="STRING"/>
					<colinfo id="POSID_1" size="256" type="STRING"/>
					<colinfo id="GUBUN" size="256" type="STRING"/>
					<colinfo id="PRONR" size="256" type="STRING"/>
					<colinfo id="PROWRK" size="256" type="STRING"/>
					<colinfo id="PRO_R" size="256" type="STRING"/>
					<colinfo id="CRDAT" size="256" type="STRING"/>
					<colinfo id="VER" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_save2">
				<Contents>
					<colinfo id="FLAG" size="256" type="STRING"/>
					<colinfo id="POSID" size="256" type="STRING"/>
					<colinfo id="POSID_1" size="256" type="STRING"/>
					<colinfo id="GUBUN" size="256" type="STRING"/>
					<colinfo id="PRONR" size="256" type="STRING"/>
					<colinfo id="PROWRK" size="256" type="STRING"/>
					<colinfo id="PRO_R" size="256" type="STRING"/>
					<colinfo id="CRDAT" size="256" type="STRING"/>
					<colinfo id="VER" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list4">
				<Contents>
					<colinfo id="PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
					<colinfo id="GUBUN" size="256" summ="default" type="STRING"/>
					<colinfo id="PRONR" size="256" summ="default" type="STRING"/>
					<colinfo id="PROWRK" size="256" summ="default" type="STRING"/>
					<colinfo id="PRO_R" size="256" summ="default" type="STRING"/>
					<colinfo id="SAFE" size="256" summ="default" type="STRING"/>
					<colinfo id="POSIDCNT" size="256" summ="default" type="INT"/>
					<colinfo id="POSID_DONG" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list5">
				<Contents></Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond2">
				<Contents>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond3">
				<Contents>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
					<colinfo id="PSPID" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
		</Datasets>
		<Tab Height="496" Id="Tab0" OnChanged="Tab0_OnChanged" TabOrder="18" Top="56" Width="977">
			<Contents>
				<TabPage BorderColor="black" Height="470" Id="tab1" ImageID="tab_form_11" Left="2" TabOrder="19" Text="기성&#32;공정&#32;관리" Top="24" Width="973">
					<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_gisung_save" ImageID="btn_user_03" Left="911" LeftMargin="12" OnClick="btn_gisung_save_OnClick" Style="sty_btn" TabOrder="17" TabStop="FALSE" Text="&#32;저장" Top="1" Transparent="TRUE" Width="59"></Button>
					<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_picture" ImageID="btn_user_05" Left="831" LeftMargin="12" OnClick="btn_picture_OnClick" Style="sty_btn" TabOrder="18" TabStop="FALSE" Text="&#32;사진보기" Top="1" Transparent="TRUE" Width="80"></Button>
					<Grid AreaSelect="TRUE" AutoFitEndLine="Hide" BindDataset="ds_list1" BkColor2="default" BoldHead="true" Border="Flat" Bottom="464" CellMoving="TRUE" ColSelect="TRUE" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="440" Id="Grid1" InputPanel="FALSE" Left="4" LineColor="user20" LineType="ExHORZ" OnCellClick="grd_list1_OnCellClick" OnHeadClick="grd_list1_OnHeadClick" Right="374" RowHeight="20" Style="sty_grid" TabOrder="18" TabStop="true" Top="24" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="370">
						<contents>
							<format id="Default">
								<columns>
									<col fix="left" width="30"/>
									<col fix="left" width="70"/>
									<col fix="left" width="146"/>
									<col fix="left" width="104"/>
								</columns>
								<head>
									<cell col="0" display="text" font="굴림,9" text="No"/>
									<cell align="center" col="1" color="user21" display="text" font="굴림,9" text="프로젝트"/>
									<cell align="center" col="2" color="user21" display="text" font="굴림,9" text="현장명"/>
									<cell align="center" col="3" color="user21" display="text" font="굴림,9" text="호기"/>
								</head>
								<body>
									<cell align="center" col="0" colid="no" display="text" edit="normal" expr="currow+1"/>
									<cell align="center" bkcolor2="user22" col="1" colid="PSPID" display="text" suppress="1"/>
									<cell align="left" bkcolor2="user22" col="2" colid="ZSITE_NM" display="text" suppress="2"/>
									<cell align="center" bkcolor2="user22" col="3" colid="POSID" display="text"/>
								</body>
							</format>
						</contents>
					</Grid>
					<Grid AreaSelect="true" AutoFitEndLine="Hide" BindDataset="ds_pop" BkColor2="default" BoldHead="true" Border="Flat" Bottom="464" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="440" HScrollCell="TRUE" Id="grd_pop" InputPanel="FALSE" Left="376" LineColor="user20" LineType="ExHORZ" MinWidth="50" OnCellClick="grd_pop_OnCellClick" Right="974" ScrollCell="true" Style="sty_grid" TabOrder="4" TabStop="true" Top="24" UseAutoSizing="Row" UseDBuff="true" UseExprCache="Row" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="598">
						<contents>
							<format id="Default">
								<columns>
									<col fix="left" width="30"/>
									<col fix="left" width="227"/>
									<col fix="left" width="80"/>
									<col fix="left" width="80"/>
									<col fix="left" width="60"/>
									<col fix="left" width="93"/>
								</columns>
								<head>
									<cell col="0" display="text" font="굴림,9" text="NO"/>
									<cell col="1" display="text" font="굴림,9" text="DESCRIPTION"/>
									<cell col="2" display="text" font="굴림,9" text="공정율"/>
									<cell col="3" display="text" font="굴림,9" text="누계"/>
									<cell col="4" display="text" font="굴림,9" text="완료"/>
									<cell col="5" display="text" edit="expr:decode(COL0,&#32;&apos;0&apos;,&#32;&apos;checkbox&apos;,&#32;&apos;1&apos;,decode(JCOL0,&apos;0&apos;,&apos;none&apos;,&#32;&apos;1&apos;,&#32;&apos;checkbox&apos;,&apos;none&apos;),&#32;&apos;none&apos;)" font="굴림,9" text="기성"/>
								</head>
								<body>
									<cell align="center" bkcolor="expr:decode(ZCHECK,&#32;&apos;X&apos;,&#32;&apos;user20&apos;,&#32;&apos;default&apos;)" col="0" display="text" expr="currow+1"/>
									<cell bkcolor="expr:decode(ZCHECK,&#32;&apos;X&apos;,&#32;&apos;user20&apos;,&#32;&apos;default&apos;)" col="1" colid="PROWRK" display="text"/>
									<cell align="right" bkcolor="expr:decode(ZCHECK,&#32;&apos;X&apos;,&#32;&apos;user20&apos;,&#32;&apos;default&apos;)" col="2" colid="PRO_R" display="number"/>
									<cell align="right" bkcolor="expr:decode(ZCHECK,&#32;&apos;X&apos;,&#32;&apos;user20&apos;,&#32;&apos;default&apos;)" col="3" colid="PRO_SUM" display="number"/>
									<cell bkcolor="expr:decode(COM_CHK,&#32;&apos;1&apos;,&#32;&apos;user34&apos;,&#32;&apos;default&apos;)" bkcolor2="expr:decode(COM_CHK,&#32;&apos;1&apos;,&#32;&apos;user34&apos;,&#32;&apos;user22&apos;)" col="4" colid="JCOL4" display="checkbox" edit="expr:iif(COM_CHK&#32;==&#32;&apos;1&apos;,&#32;&apos;checkbox&apos;,&#32;&apos;none&apos;)"/>
									<cell bkcolor="expr:iif(COM_CHK&#32;==&#32;&apos;1&apos;&#32;&amp;&amp;&#32;&#32;JCOL&#32;==&#32;&apos;1&apos;&#32;&#32;,&#32;&apos;user27&apos;,&#32;&apos;default&apos;&#32;&#32;)" col="5" colid="COL" display="expr:iif(&#32;parseInt(F_SAFE_NUM)&#32;&lt;&#32;parseInt(PROCESS_BY_SAFE_NUM)&#32;,&#32;&apos;normal&apos;&#32;,&#32;&apos;checkbox&apos;)" edit='expr:iif(COM_CHK=&apos;1&apos;&#32;OR&#32;DIR=&apos;1&apos;&#32;OR&#32;GISUNG_CHK=&apos;X&apos;,decode(COL,&#32;&apos;0&apos;,&#32;&apos;checkbox&apos;,&#32;&apos;1&apos;,&#32;&apos;checkbox&apos;,&#32;&apos;none&apos;),&quot;none&quot;)' Mask="&apos;&apos;"/>
								</body>
								<summary>
									<cell align="center" bkcolor="user27" col="0" color="user26" colspan="4" display="text" text="전일&#32;누계&#32;공정율"/>
									<cell bkcolor="user27" col="4" color="user26" display="number"/>
									<cell bkcolor="user27" col="5" color="user26" display="number"/>
									<cell align="center" bkcolor="user27" col="0" color="user26" colspan="4" display="text" row="1" text="당일&#32;공정율"/>
									<cell bkcolor="user27" col="4" color="user26" display="number" row="1"/>
									<cell bkcolor="user27" col="5" color="user26" display="number" row="1"/>
									<cell align="center" bkcolor="user27" col="0" color="user26" colspan="4" display="text" row="2" text="당일&#32;누계&#32;공정율"/>
									<cell bkcolor="user27" col="4" color="user26" display="number" row="2"/>
									<cell bkcolor="user27" col="5" color="user26" display="number" row="2"/>
								</summary>
							</format>
						</contents>
					</Grid>
				</TabPage>
				<TabPage BorderColor="black" Height="470" Id="tab2" ImageID="tab_form_11" Left="2" TabOrder="21" Text="프로젝트별&#32;일보공정&#32;사진" Top="24" Width="973">
					<Grid AreaSelect="TRUE" AutoFitEndLine="Hide" BindDataset="ds_list1" BkColor2="default" BoldHead="true" Border="Flat" Bottom="624" CellMoving="TRUE" ColSelect="TRUE" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="592" Id="Grid1" InputPanel="FALSE" Left="6" LineColor="user20" LineType="ExHORZ" OnCellClick="tab2_grd_list1_OnCellClick" OnHeadClick="grd_list1_OnHeadClick" Right="382" RowHeight="20" Style="sty_grid" TabOrder="1" TabStop="true" Top="32" UseAutoSizing="Row" UseDBuff="true" UseExprCache="Row" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="376">
						<contents>
							<format id="Default">
								<columns>
									<col fix="left" width="30"/>
									<col fix="left" width="70"/>
									<col fix="left" width="181"/>
									<col fix="left" width="74"/>
								</columns>
								<head>
									<cell col="0" display="text" font="굴림,9" text="No"/>
									<cell align="center" col="1" color="user21" display="text" font="굴림,9" text="프로젝트"/>
									<cell align="center" col="2" color="user21" display="text" font="굴림,9" text="현장명"/>
									<cell align="center" col="3" color="user21" display="text" font="굴림,9" text="대수"/>
								</head>
								<body>
									<cell align="center" col="0" colid="no" display="text" edit="normal" expr="currow+1"/>
									<cell align="center" bkcolor2="user22" col="1" colid="PSPID" display="text" suppress="1"/>
									<cell align="left" bkcolor2="user22" col="2" colid="ZSITE_NM" display="text" suppress="2"/>
									<cell align="center" bkcolor2="user22" col="3" colid="HO_CNT" display="text"/>
								</body>
							</format>
						</contents>
					</Grid>
					<Static Color="user7" Font="굴림,9,Bold" Height="24" Id="Static0" Left="30" TabOrder="2" Text="보기&#32;버튼을&#32;클릭하면&#32;완료&#32;공정&#32;현장&#32;사진을&#32;볼&#32;수&#32;있습니다.&#32;현장&#32;사진을&#32;더블클릭하면&#32;큰&#32;사진을&#32;볼&#32;수&#32;있습니다." Top="3" VAlign="Middle" Width="752"></Static>
					<Div Height="440" Id="div_image" Left="390" scroll="true" SyncContents="true" TabOrder="3" Text="Div0" Top="32" Width="576">
						<Contents>
							<Div Border="RaisedEdge" Height="100" Id="Div3" TabOrder="1" Text="Div0" Top="472" Width="577">
								<Contents>
									<Static Color="user7" Font="굴림,8" Height="24" Id="st_dong0" Left="7" TabOrder="1" Text="101동" Top="10" VAlign="Middle" Width="56"></Static>
									<Static Color="user7" Font="굴림,8" Height="24" Id="st_0" Left="7" TabOrder="2" Text="호기&#32;:" Top="30" VAlign="Middle" Width="56"></Static>
									<Static Color="user7" Font="굴림,8" Height="24" Id="st_1" Left="7" TabOrder="3" Text="호기&#32;:" Top="50" VAlign="Middle" Visible="FALSE" Width="56"></Static>
									<Image Height="23" Id="btn_showImg0" ImageID="icon_grid_modify" Left="44" TabOrder="4" Top="10" UserData="139331L01" Width="48"></Image>
								</Contents>
							</Div>
						</Contents>
					</Div>
				</TabPage>
			</Contents>
		</Tab>
		<Shape BKColor="user0" Bottom="56" Height="56" Id="Shape0" Left="2" LineColor="user1" Right="972" TabOrder="1" Top="0" Type="Rectangle" Width="970"></Shape>
		<Static Align="Right" DomainID="com.pjtno" Height="20" Id="st_pjt" Left="8" Style="sty_lb_search" TabOrder="2" Text="프로젝트번호&#32;" Top="29" VAlign="Middle" Width="92"></Static>
		<Edit BindDataset="ds_cond" Border="Flat" CheckLength="Byte" Column="PSPID" Height="20" Id="ed_pspid" ImeMode="english" Left="104" MaxLength="6" Style="sty_ipt_search" TabOrder="3" Top="29" UpperOnly="TRUE" Width="78"></Edit>
		<Button Height="18" Id="Button0" ImageID="btn_icon_search" Left="185" OnClick="btn_pjt_OnClick" TabOrder="4" Text="Button0" Top="30" Width="18"></Button>
		<Static Align="Right" Height="20" Id="Static18" Left="208" Style="sty_lb_search" TabOrder="5" Text="사무소&#32;" Top="5" VAlign="Middle" Width="92"></Static>
		<Static Align="Right" Border="Flat" Enable="FALSE" Height="20" Id="Static19" Left="1062" Style="sty_ipt_search" TabOrder="6" Top="4" VAlign="Middle" Visible="FALSE" Width="138"></Static>
		<Checkbox BindDataset="ds_cond" Column="SO4" Enable="FALSE" FalseValue="0" Height="18" Id="chk_so4" Left="1167" Style="sty_ipt_search_chk" TabOrder="8" Text="강북팀" Top="5" TrueValue="1" Visible="FALSE" Width="61"></Checkbox>
		<Checkbox BindDataset="ds_cond" Column="SO3" Enable="FALSE" FalseValue="0" Height="18" Id="chk_so3" Left="1098" Style="sty_ipt_search_chk" TabOrder="7" Text="강남팀" Top="5" TrueValue="1" Visible="FALSE" Width="58"></Checkbox>
		<Static Align="Right" Height="20" Id="st_date" Left="8" Style="sty_lb_search" TabOrder="9" Text="조회일자&#32;" Top="5" VAlign="Middle" Width="92"></Static>
		<Calendar BindDataset="ds_cond" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="INP_DTF" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="ed_inpday_f" Left="104" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_search" SundayTextColor="user35" TabOrder="10" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="5" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="94"></Calendar>
		<Static Align="Right" Height="20" Id="st_zzpmnum" Left="668" Style="sty_lb_search" TabOrder="11" Text="PM&#32;" Top="5" VAlign="Middle" Width="92"></Static>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="CODE" Column="ZZPMNUM" DataColumn="CODE_NAME" Height="20" Id="cb_zzpmnum" InnerDataset="ds_zzpmnum_cd" Left="762" Style="sty_ipt_search" TabOrder="12" Top="5" Width="120"></Combo>
		<Static Align="Right" Height="20" Id="Static2" Left="400" Style="sty_lb_search" TabOrder="13" Text="설치협력사&#32;" Top="5" VAlign="Middle" Width="92"></Static>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="CODE" Column="ZZLIFNR" DataColumn="CODE_NAME" Height="20" Id="cb_zzlifnr" InnerDataset="ds_zzlifnr" Left="496" Style="sty_ipt_search" TabOrder="14" Top="5" Width="162"></Combo>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="CODE" Column="ZZACTSS" DataColumn="CODE_NAME" Height="20" Id="cb_zzactss" InnerDataset="ds_zzactss" Left="302" OnChanged="cb_zzactss_OnChanged" Style="sty_ipt_search" TabOrder="15" Top="5" Width="94"></Combo>
		<Div Border="RaisedEdge" Height="150" Id="Div0" Left="1048" TabOrder="17" Text="Div0" Top="40" Visible="FALSE" Width="577">
			<Contents>
				<Static Color="user7" Font="굴림,8" Height="24" Id="st_dong0" Left="7" TabOrder="1" Text="101동" Top="10" VAlign="Middle" Visible="FALSE" Width="56"></Static>
				<Static Color="user7" Font="굴림,8" Height="24" Id="st_0" Left="7" TabOrder="2" Text="호기&#32;:" Top="50" VAlign="Middle" Visible="FALSE" Width="56"></Static>
				<Static Color="user7" Font="굴림,8" Height="24" Id="st_1" Left="7" TabOrder="3" Text="호기&#32;:" Top="100" VAlign="Middle" Visible="FALSE" Width="56"></Static>
				<Static Align="Center" Color="user7" Font="굴림,9" Height="24" Id="Div0Date0" Left="71" TabOrder="4" Text="2019-01-01" Top="4" VAlign="Middle" Visible="FALSE" Width="144"></Static>
				<Static Align="Center" BKColor="ACTIVECAPTION" Color="user22" Font="굴림,9" Height="20" Id="Div0Title0" Left="71" TabOrder="5" Text="&#32;형판작업" Top="27" VAlign="Middle" Visible="FALSE" Width="144"></Static>
				<Image Border="Flat" Cursor="HAND" FillType="STRETCH" Height="85" Id="Div0Image0" Left="71" OnClick="images_onClickOpenPopup" Static="FALSE" TabOrder="6" TabStop="FALSE" Top="54" UserData="0" Visible="FALSE" Width="144"></Image>
				<Button Cursor="HAND" Height="18" Id="btn_openFile" ImageID="btn_icon_search" Left="47" OnClick="btn_openFile_OnClick" TabOrder="7" Text="Button0" Top="6" Visible="FALSE" Width="18"></Button>
			</Contents>
		</Div>
	</Form>
	<Script><![CDATA[/*
 *****************************************************************************************
 * 기      능   : 
 * 작  성  자   : 
 * 작성  일자   : 
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
#include "LIB::commons.js";	// 공통 스크립트 
//=========================================================================================
// [ PART 1 ]
// Form에서 사용될 전역변수를 선언
// FORM에서 사용되는 전역변수는 대문자로 작성하며, F_XXX 의 형태를 갖도록 한다. 
//=========================================================================================
var userGroup = "";
var args = "";
var curr_date = "";
var _GUBUN = "";
var _P_POSID = "";
var _P_GUBUN = "";
var _P_TYPE = "";
var _P_VER = "";
var _P_SAFE = "";
var _P_ZSPEC = "";
var _P_CHK = "";
var E_FLAG; = "";
var _TABGUBUN = "";

//var userGroup = "";
//=========================================================================================
// [ PART 2 ]
// Form Loading / Unloading 시 작업 정의
//=========================================================================================
function fn_OnLoadCompleted(obj) 
{

	// Form 로드 이벤트 맨 첫줄에 기술 
	gfn_initForm(true);	
	
	userGroup = gfn_getUserGroup();
	
	ed_inpday_f.value = gfn_getCurrDate();

	ds_cond.SetColumn(0,"USER_GRUP",userGroup);
	if (userGroup == "10")
	{
		ds_cond.SetColumn(0,"USER_CODE",G_VEND_CODE_E);
	}
	else if (userGroup == "20")
	{
		ds_cond.SetColumn(0,"USER_CODE",G_USER_ID);
	}
	else if (userGroup == "30")
	{
		ds_cond.SetColumn(0,"USER_CODE",G_AREA_CODE_E);
	}
	
	var codeArr = ["PS003"];
    var dsObjArr = [ds_zzactss];
    var addTypeArr = [G_CODE_ALL];
    gfn_searchCommCode(codeArr, dsObjArr, addTypeArr);
	
	tit_clearActionInfo();
	tit_addSearchActionInfo("wb01:SEOLCHI_VEND_S2");
	//tit_addSearchActionInfo("ps02:PS0205001A_S8");      //공정 코드

	tit_callService(
		""
		, ""
		, "ds_cond=ds_cond"
		, "ds_zzlifnr=ds_lifnr_cd"  // ds_pronr=ds_pronr"
		, ""
		, "fn_afterQueryC"
		, ""
		, ""
		, true);

	
	
	ed_inpday_f.SETFOCUS();
	gfn_showMsg("CI00007");
	
	if( length(F_PSPID) > 0 )  //프로젝트 번호가 넘어왔을때
	{
		ds_cond.SetColumn(ds_cond.row, "PSPID", F_PSPID);
		fn_query();
	}
					
}

/********************************************************************************
* 기      능   :  협력사 조회 Callback  
********************************************************************************/
function fn_afterQueryC(errCode, errMsg) {
	cb_zzlifnr.Index = 0;

	if ( userGroup == "10" )
	{
		cb_zzlifnr.Enable = false;
	}
	else if ( userGroup == "30" || userGroup == "40")
	{
		ds_zzlifnr.filter("LOEVM!='X'" );		
		gfn_insertEmptyRow( ds_zzlifnr, G_CODE_ALL );
		cb_zzlifnr.value = "";
	}
}


/********************************************************************************
* 기      능   : 공통코드가 조회된 후의 Callback 함수 
********************************************************************************/
function fn_completeInit(sCode, sDsObj, sCodeType) 
{


	if(userGroup == "40")
	{
		cb_zzactss.Index = 0;
		cb_zzactss.Enable = true;
	}
	else if(userGroup == "30")
	{
		ds_zzactss.Filter("CODE="+quote(G_AREA_CODE_E));
		cb_zzactss.Index = 0;
		cb_zzactss.Enable = false;
	}
	else if(userGroup == "10")
	{
		cb_zzactss.Index = 0;
		cb_zzactss.Enable = false;
	}

}


/********************************************************************************
* 기      능   : form UnloadCompleted 
********************************************************************************/
function fn_OnUnloadCompleted(obj) 
{
	return gfn_isFormUnload(obj);
}


//=========================================================================================
// [ PART 3 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,form닫기)
//=========================================================================================
/********************************************************************************
* 기      능   : 조회
********************************************************************************/
function fn_query() 
{

	var sqlName = "";
	var afterFunction = "";
	
	if (Tab0.TabIndex == 0) 
	{
		sqlName = "ps02:PS0209003A_S1";
		afterFunction = "fn_afterQuery";
	}else{
		sqlName = "ps02:PS0209003A_S2";
		afterFunction = "fn_faterQuerytab1"; //프로젝트별 일보공정 사진 탭
	}
	
	// 투입일자 필수 
   if(gfn_isNull(ed_inpday_f, true, st_date.value))  return;	

    
	tit_clearActionInfo();	
	tit_addSearchActionInfo(sqlName);  	  //==> 예전 PS0207003A_S1.xml
	//tit_addCsvSearchActionInfo("ps02:PS0207003A_S1"); 
	
	tit_callService(
          ""
        , ""
        , "ds_cond=ds_cond"
        , "ds_list1=ds_list1"  
        , ""
        , afterFunction
        , ""
        , ""
        , true);
        
}
/********************************************************************************
* 기      능   : 조회 Callback 
********************************************************************************/
function fn_afterQuery(errCode, errMsg) 
{
	
	if( length(F_POSID) > 0 )  //호기번호가 있을때 
	{
		ds_list1.row = ds_list1.FindRow("POSID", F_POSID);
		Tab0.tab1.Grid1.SetCellPos(3);
		
		grd_list1_OnCellClick('',ds_list1.row ,3 ,'','',''); //공정표 그리기 호출
	}
	gfn_showSearchMsg(grd_list1, errCode, errMsg);
	
}

function fn_faterQuerytab1(errCode, errMsg) 
{
	ds_list1.row = 0; //첫번째
	Tab0.tab2.Grid1.SetCellPos(2);
	tab2_grd_list1_OnCellClick('', 0 ,2 , '','','');
	
}
/********************************************************************************
* 기      능   : DS_LIST1 데이터셋 변경
********************************************************************************/
function ds_list1_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{
			
	obj.fireevent = false;
		
	switch( strColumnID ) 
	{
	
								
		/*case "SAFE1":
			ds_list1.SetColumn(nRow,"CHECK","1");
		case "SAFE2":
			ds_list1.SetColumn(nRow,"CHECK","1");
		case "SAFE3":
        	ds_list1.SetColumn(nRow,"CHECK","1");	
		*/						
								
									
	}
	
	obj.fireevent = true;
	
}

/********************************************************************************
* 기      능   : 닫기 
********************************************************************************/
function fn_close() 
{
	close();
}

//=========================================================================================
// [ PART 4]
// Callback 함수 정의 : callback 함수명은 메인 함수의 fn_xxxx() 에서 xxxx 부분은 fn_afterXXXX()
// 형태가 되도록 작성 
//=========================================================================================

//=========================================================================================
// [ PART 5 ]
// Detail Process Event 정의 ( User Define function )
// 사용자 정의 함수는 ufn_xxxx() 형태로 작성 
//=========================================================================================

/********************************************************************************
* 기      능   : 액셀  
********************************************************************************/
function fn_excel() 
{
	if( ds_list1.rowcount > 0 )
	{
		gfn_saveToExcel(grd_list1, true );
		break;
	}
}
//=========================================================================================
// [ PART 6 ]
// component Event 정의 : 각 Component 별 이벤트 
//=========================================================================================
/********************************************************************************
* 기      능   : 원프로젝트 팝업
********************************************************************************/
function btn_pjt_OnClick(obj)
{
	var arg = "pjt="+quote(ed_pjt.Text);
	
	gfn_openPopup("CS9601002A",true,arg);
	
	fn_query();
}
/********************************************************************************
* 기      능   : 리스트의 타이틀 클릭  
********************************************************************************/
function grd_list1_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
{
	if ( nCell == 0 ) {
		return;
	}
	else if ( nCell == 1 ) {
		// 그리드 표시할 컬럼 선택 
		gfn_selectAllGrid(obj,nCell,nCell,true);
	} else {
		// 그리드 정렬 처리 
		gfn_sortGrid(obj,nCell);
	}	
}
/********************************************************************************
* 기      능   : 프로젝트에서 엔터키 처리 
********************************************************************************/
function ed_pjt_OnKeyDown(obj,nChar,bShift,bCtrl, bAlt,LLParam,HLParam)
{
}
/********************************************************************************
* 기      능   : 승인
********************************************************************************/
function fn_save() 
{
 
  // 그리드 저장 대상 로우
	if(ds_list1.FindRow("CHECK", 1)==-1){
		gfn_showMsg('CW00046');
		return;
	}
   
    if (!gfn_showConfirm("CW10025","승인하시겠습니까?")) 
	{
		return;
	}
     ds_list3_tmp.ClearData();	
	 ds_list1.Filter("CHECK==1");
	 ds_list2.copyF(ds_list1);
     ds_list1.unFilter();
     
     
    for(var i=0;i<ds_list2.GetRowCount();i++)
    {
       if(ds_cond1.GetRowCount()==0)	ds_cond1.AddRow();
      
        ds_list3.ClearData();
        
        ds_cond1.SetColumn(0,"INP_DTF",ds_cond.GetColumn(0,"INP_DTF"));
        ds_cond1.SetColumn(0,"PSPID",ds_list2.GetColumn(i,"PSPID"));
        ds_cond1.SetColumn(0,"POSID",ds_list2.GetColumn(i,"POSID"));
        ds_cond1.SetColumn(0,"SAFE",ds_list2.GetColumn(i,"SAFE"));
           
              
         tit_clearActionInfo();
		 tit_addSearchActionInfo("ps02:PS0207003A_S2");
		 tit_callService(
		    ""
		  , ""
		  , "ds_cond1=ds_cond1"
		  , "ds_list3=ds_list3"
		  , ""
		  , ""
		  , ""
          , ""
		  , true);	
		  
		  
		  
  	  ds_list3_tmp.AppendDataset(ds_list3);
  	  
    }
    
     
       if(ds_list2.GetRowCount() > 0){

	    tit_clearActionInfo();
        tit_addMultiActionInfo("ps02:PS0207003A_I1");
        tit_callService(
		  ""	
		, ""
		, "ds_list2=ds_list2"
		, ""
		, ""
		, ""//"fn_afterSave"
		, ""
		, ""
		, true  // ""
       );
    
   }
   
    
     if(ds_list3_tmp.GetRowCount() > 0){

	    tit_clearActionInfo();
        tit_addMultiActionInfo("ps02:PS0207003A_I2");
        tit_callService(
		  ""	
		, ""
		, "ds_list3_tmp=ds_list3_tmp"
		, ""
		, ""
		, ""//"fn_afterSave"
		, ""
		, ""
		, true  // ""
       );
    
   }
   
 
   fn_query();
    
}
/********************************************************************************
* 기      능   : 삭제 Callback  
********************************************************************************/
function fn_afterDelete(errCode, errMsg) 
{
}

/********************************************************************************
* 기      능   : 사무소콤보 변경시 설치PM 콤보값 생성
********************************************************************************/
function cb_zzactss_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
  if(userGroup == "40" || userGroup == "30"){
    ds_cond.SetColumn(0,"ZZLIFNR",''); }

    if(ds_cond.GetColumn(0,"ZZACTSS") == '')
    {
       ds_zzlifnr.UnFilter();
    }
    else
    {
      var arr = ds_cond.GetColumn(0,"ZZACTSS");
	  ds_zzlifnr.Filter("ZZACTSS ==" +quote(arr));
    }
	
	ds_cond_cd.SetColumn(0,"ZZACTSS",strCode);
	cb_zzpmnum.value = "";

	tit_clearActionInfo();
	tit_addSearchActionInfo("ps02:PS0201001A_S41");
	
	tit_callService(
		""
		, ""
		, "ds_cond_cd=ds_cond_cd"
		, "ds_zzpmnum_cd=ds_zzpmnum_cd"  // ds_pronr=ds_pronr"
		, ""
		, "fn_afterZzactssChange"
		, ""
		, ""
		, true);	
				
}

/********************************************************************************
* 기      능   : 조회 Callback  - 사무소 변경시
********************************************************************************/
function fn_afterZzactssChange(errCode, errMsg) {
	gfn_insertEmptyRow( ds_zzpmnum_cd, G_CODE_ALL );
	cb_zzpmnum.value = "";
}
/********************************************************************************
* 기      능   : 조회 Callback  - 공정진행현황 연동
********************************************************************************/
function grd_list1_OnCellClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
	var chk = "";
	
	if(length(ed_pspid.Text) <= 0 && length(cb_zzactss.Value) <= 0 )
    {
       chk = 'N';
    }
    else
    {
       chk = 'Y';
    }
   
     _P_POSID = ds_list1.getColumn(nRow, "POSID");
	 _P_GUBUN = ds_list1.getColumn(nRow, "ZZGUBUN");
	 _P_TYPE = ds_list1.getColumn(nRow, "TYPE");
	 _P_VER = ds_list1.getColumn(nRow, "VER");
	 _P_SAFE = ds_list1.getColumn(nRow, "SAFE");
	 _P_ZSPEC = ds_list1.getColumn(nRow, "ZSPEC");
	 
	 _P_CHK = chk;

	 select_construction_process(); 
	 
}

/********************************************************************************
* 기      능   : 프로젝트별 일보공정 사진 탭 그리드 선택 시
********************************************************************************/
function tab2_grd_list1_OnCellClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
	if(length(ds_list1.GetColumn(nRow, "PSPID")) == 0)  
	{
		return;
	}
	var row = ds_cond3.AddRow();
	ds_cond3.SetColumn(row, "PSPID", ds_list1.GetColumn(nRow, "PSPID")); 
	
	tit_clearActionInfo();	
	tit_addSearchActionInfo("ps02:PS0209003A_S3");  	
	
	tit_callService(
          ""
        , ""
        , "ds_cond3=ds_cond3"
        , "ds_list4=ds_list4"  
        , ""
        , "fn_afterSeletePopidInfo"  
        , ""
        , ""
        , true);
	
	
}

function fn_afterSeletePopidInfo()
{
	var content = "";
	var addDivTop = 0;
	//이미지 가로:세로 비율 수정(9:16)에 따른 이미지 가운데 정렬 처리 - 2019.03.05 강민석K
	var imageLeftArea = 100;
	//var imageLeftArea = 150;
	
	content += ' <Contents> \n';
	
	for (var i = 0 ; i < ds_list4.GetRowCount(); i ++)
	{
		content += '<Div Border="RaisedEdge" Height="150" Id="Div'+i+'" Left="-1" TabOrder="1" Top="'+addDivTop+'" Width="3000">\n';
		content += 	'<Contents>\n';
		content += 		'<Static Color="user7" Font="굴림,8" Height="24" Id="st_dong'+i+'" Left="7" TabOrder="1" Text="'+ds_list4.GetColumn(i, "POSID_DONG")+'" Top="10" VAlign="Middle" Width="56"></Static>\n';
		content += 		'<Static Color="user7" Font="굴림,8" Height="24" Id="st_0" Left="7" TabOrder="2" Text="호기&#32;:" Top="50" VAlign="Middle" Width="56"></Static>\n';
		content += 		'<Static Color="user7" Font="굴림,8" Height="24" Id="st_1" Left="7" TabOrder="3" Text="공정율&#32;:" Top="100" VAlign="Middle" Width="56"></Static>\n';
		//content +=		'<Image Height="23" Id="btn_showImg'+i+'" OnClick="btn_showImg_OnClick" ImageID="icon_grid_modify" Left="44" TabOrder="4" Top="10" UserData="'+ ds_list4.GetColumn(i, "POSID") + '" Width="48"></Image>\n';
		content +=      '<Button Cursor="HAND" Height="18" Id="btn_showImg'+i+'" ImageID="btn_icon_search" Left="65" OnClick="btn_OnoffImg_OnClick" UserData="'+ ds_list4.GetColumn(i, "POSID") + '"  TabOrder="7" Text="Button0" Top="10" Width="18"></Button>\n';
		content +=      '<Static Color="user7" Font="굴림,8" Height="24" Id="Static0" Left="51" TabOrder="9" Text="'+right(ds_list4.GetColumn(i, "POSID"),3)+'"  Top="50" VAlign="Middle" Width="32"></Static>\n';
	    content +=      '<Static Color="user7" Font="굴림,8" Height="24" Id="Static1" Left="55" TabOrder="10" Text="'+ds_list4.GetColumn(i, "PRO_R")+'%" Top="102" VAlign="Middle" Width="32"></Static>\n';
		//TODO 호기별 완료사진 데이터로 돌리기
		for(var j = 0 ; j < ds_list4.GetColumn(i, "POSIDCNT") ; j ++)
		{
			content += '<Static Align="Center" Color="user7" Font="굴림,9" Height="24" Id="Date'+j+'" Left="'+imageLeftArea+'" TabOrder="5" Text="2019-01-0'+j+'" Top="4" VAlign="Middle" Width="144" Visible="FALSE" ></Static>\n';
			
			content += '<Static Align="Center" BKColor="ACTIVECAPTION" Color="user22" Font="굴림,9" Height="20" Id="Title'+j+'" Left="'+imageLeftArea+'" TabOrder="6" Text="&#32;형판작업'+j+'" Top="27" VAlign="Middle" Width="144" Visible="FALSE"></Static>\n';
			//이미지 가로:세로 비율 수정(9:16) - 2019.03.05 강민석K
			//content += '<Image FillType="STRETCH" Cursor="HAND" Border="Flat" Height="85" Id="Image'+j+'" Left="'+imageLeftArea+'" OnClick="images_onClickOpenPopup" Static="FALSE" TabOrder="7" Top="54" UserData="0" Width="144" Visible="FALSE"></Image>\n';
			content += '<Image FillType="STRETCH" Cursor="HAND" Border="Flat" Height="85" Id="Image'+j+'" Left="'+(imageLeftArea + 50)+'" OnClick="images_onClickOpenPopup" Static="FALSE" TabOrder="7" Top="54" UserData="0" Width="48" Visible="FALSE"></Image>\n';
			
			//이미지 가로:세로 비율 수정(9:16)에 따른 이미지 가운데 정렬 처리 - 2019.03.05 강민석K
			//imageLeftArea = imageLeftArea + 149; // Image Width(144) + 5
			imageLeftArea = imageLeftArea + 250; // Image Width(144) + 5
		}
		
		//이미지 가로:세로 비율 수정(9:16)에 따른 이미지 가운데 정렬 처리 - 2019.03.05 강민석K
		//imageLeftArea = 100;
		imageLeftArea = 100;
		
		content += 	'</Contents>\n'; 
		content += '</Div>\n';
		
		addDivTop = addDivTop + 155; // DIV Height(150) + 5
	}
	
	content += '</Contents> \n';
	Tab0.tab2.div_image.Contents = content;
}

/********************************************************************************
* 기      능   : 이미지 온오프
********************************************************************************/
function btn_OnoffImg_OnClick(obj)
{
	// 호기별 완료사진 불러오기
	var row = ds_cond2.AddRow();
	ds_cond2.SetColumn(0, "POSID", obj.userData);  //TODO 선택된 호기로 변경해야됨 166536L02
	
	tit_clearActionInfo();	
	tit_addSearchActionInfo("ps02:PS0209003A_S4");  	
	
	tit_callService(
          ""
        , ""
        , "ds_cond2=ds_cond2"
        , "ds_list5=ds_list5"  
        , ""
        , ""  
        , ""
        , ""
        , true);

	if(ds_list5.GetRowCount() == 0)
	{
		gfn_showAlert("해당 호기에 아직 완료사진이 없습니다.");
		return;
	}
	
	var i = replace(obj.ID, "btn_showImg", '');
	var fa_serverFileName = "";
	
	//TODO 호기별 완료사진 데이터로 돌리기
	for(var j = 0 ; j < ds_list5.GetRowCount() ; j ++)
	{
		ufn_makeTile(eval("Tab0.tab2.div_image.Div"+i+".Title"+j), ds_list5.GetColumn(j, "PROWRK"));
		ufn_makeDate(eval("Tab0.tab2.div_image.Div"+i+".Date"+j), ds_list5.GetColumn(j, "EDATE"));
		fa_serverFileName = ds_list5.GetColumn(j, "FNAME");
				
		if(IndexOf(tit_getServerDir("PS", fa_serverFileName),'localhost') > 0) //로컬
		{
			ufn_getLocalImage(eval("Tab0.tab2.div_image.Div"+i+".Image"+j), fa_serverFileName);
		}else{
			var idx = IndexOf(tit_getServerDir("PS", fa_serverFileName),'/',10); //운영
			ufn_getImage(eval("Tab0.tab2.div_image.Div"+i+".Image"+j), fa_serverFileName, idx);
		}
		
		ufn_VisibleOnOff(eval("Tab0.tab2.div_image.Div"+i+".Date"+j));
		ufn_VisibleOnOff(eval("Tab0.tab2.div_image.Div"+i+".Title"+j));
		ufn_VisibleOnOff(eval("Tab0.tab2.div_image.Div"+i+".Image"+j));
		
		
	}
	
	
}

/********************************************************************************
* 기      능   : 공정별 작업이름
********************************************************************************/
function ufn_makeTile(obj, value) 
{
	if(length(value) > 12) value = left(value,12) + "..." ; 
	obj.Text = value;
}

/********************************************************************************
* 기      능   : 공절별 작업 날짜
********************************************************************************/
function ufn_makeDate(obj, value) 
{
	obj.Text = value;
}

/********************************************************************************
* 기      능   : 이미지 출력
********************************************************************************/
function ufn_getLocalImage(obj, fa_serverFileName)
{
	obj.ImageID = tit_getServerDir("PS", fa_serverFileName);
	obj.UserData = tit_getServerDir("PS", fa_serverFileName);
}

/********************************************************************************
* 기      능   : 이미지 출력
********************************************************************************/
function ufn_getImage(obj, fileName, idx)
{
	obj.ImageID = substr(tit_getServerDir("PS", fileName),0,idx)+substr(tit_getServerDir("PS", fileName),idx);
	obj.UserData = substr(tit_getServerDir("PS", fileName),0,idx)+substr(tit_getServerDir("PS", fileName),idx);
}

/********************************************************************************
* 기      능   : 온오프 
********************************************************************************/
function ufn_VisibleOnOff(obj)
{
	var value = iif (obj.Visible == 0 , 1 , 0);
	obj.Visible = value;
}
/********************************************************************************
* 기      능   : 이미지 큰팝업 호출
********************************************************************************/
function images_onClickOpenPopup(obj,nX,nY)
{
	var arg = "IMGURL=" + quote(obj.UserData);
	var arr = gfn_openPopupUrl("PS02::PS0209001C.xml", true, arg); 
}


/********************************************************************************
* 기      능   : 조회 Callback  - 공정표 불러오기
********************************************************************************/
function select_construction_process()
{
	//ufn_initProcessForm();
	
	tit_clearActionInfo();
	tit_callService(
		  "COMM_ACT"
		, "getSdReturnDate"
		, ""
		, ""
		, "I_PSPID="+quote(substr(_P_POSID,0,6)) + " I_GUBUN='D' I_DATE="+quote(gfn_getCurrDate())
		, "fn_afterDate"
		,true,true,true);

	//수금전 진행상태가 'P'(진행)이 아닐경우 공정진행 입력 금지 20100820 sjy
	if(E_FLAG != 'P'  || _P_CHK == 'N')
	{
     //	div_btn.btn_save.enable = false;
     //Tab0.tab1.btn_gisung_save.visible = false;
	}
	_P_CHK2 = 'N'; //기본 셋팅 
	fn_query_process();

}



/********************************************************************************
* 기      능   : 조회 Callback  - 공정표 그리기
********************************************************************************/

function fn_query_process()
{

	gfn_clearGridSortMark(Tab0.tab1.grd_pop);
	ds_pop.row = -1;
	ds_pop.ClearData();

	var args = "POSID="+quote(_P_POSID);
		args += " GUBUN="+quote(_P_GUBUN);
		args += " ZSEPC="+quote(_P_ZSPEC);
		args += " SAFE="+quote(_P_SAFE);
		args += " TYPE="+quote(_P_TYPE);
		args += " VER="+quote(_P_VER);
		

	var q1="";	
	var q2="";	
	var q3="";	
	
	var cRow=0;

			q1 += ", '0' COL"
			   + ", 'N' B_COL"
				
				//추가(안전검사관련)//
				+ ",  '" + _P_SAFE + "' SAFE"
				+ "\n ,VALUE(MIN((CASE WHEN RIGHT(R03.POSID_1, 3)='"+right(_P_POSID,3)+"' THEN "
				+ "\n (CASE  WHEN (T13.MDATE)  <> '' THEN '1' ELSE '0' END)  "
				+ "\n END)), '0') JCOL";
			
			q1 += "\n ,CASE WHEN (SELECT X.LIFNR FROM SAPHEE.ZMASTER02 AS X WHERE X.MANDT = A.MANDT "
			   + "\n  AND X.POSID= '"+ SUBSTR(_P_POSID,0,6) +"' AND X.POSID_1 = '"+ _P_POSID+"') = '0000008001' THEN '1' ELSE '0' END AS DIR";		
			
			q2 += "\n , VALUE(MIN((CASE WHEN RIGHT(R02.POSID_1, 3)='"+right(_P_POSID,3)+"' THEN "
				+ "\n (CASE WHEN (T12.CRDAT)='00000000' THEN '0'" 
				+ "\n WHEN  (T12.CRDAT)=HEX(CURRENT DATE) THEN '1' ELSE CHAR(T12.CRDAT) END) "
				+ "\n END)), '0') COL";
				
			q2 += "\n , 'N' B_COL";
			
			//추가(안전검사관련)//						
			q2 += "\n,  '" + _P_SAFE + "' SAFE" 
				+ "\n ,VALUE(MIN((CASE WHEN RIGHT(R03.POSID_1, 3)='"+right(_P_POSID,3)+"' THEN "
				+ "\n (CASE  WHEN (T13.MDATE)  <> '' THEN '1' ELSE '0' END)  "
				+ "\n END)), '0') JCOL";
			
			q2 += "\n ,CASE WHEN (SELECT X.LIFNR FROM SAPHEE.ZMASTER02 AS X WHERE X.MANDT = T11.MANDT "
			   + "\n  AND X.POSID= '"+ SUBSTR(_P_POSID,0,6) +"' AND X.POSID_1 = '"+ _P_POSID +"') = '0000008001' THEN '1' ELSE '0' END AS DIR";
			
			q3 += "\n , T.COL"
			   + "\n , T.B_COL"
			   + "\n , T.SAFE"
			   + "\n , T.JCOL"
			   + "\n , T.DIR";
			
			cRow++;


		
	args += " S1_QUERY="+quote(q1);
	args += " S2_QUERY="+quote(q2);
	args += " S3_QUERY="+quote(q3);
		
	tit_clearActionInfo();	
	tit_addSearchActionInfo("ps02:PS0207003B_S1");
	tit_addSearchActionInfo("ps02:PS0209003B_S2"); //NEW PS0207003B_S2
	tit_addSearchActionInfo("ps02:PS0207003B_S3");
	
	
	
	tit_callService(
		""
		, ""
		, ""
		, "ds_pop1=ds_pop1 ds_pop2=ds_pop2 ds_pop3=ds_pop3"
		, args
		, "fn_processAfterQuery"
		, true);
		


}
/********************************************************************************
* 기      능   : 조회 Callback  - fn_processAfterQuery
********************************************************************************/
function fn_processAfterQuery(errCode, errMsg)
{
	// 메시지 처리 
	gfn_showSearchMsg(Tab0.tab1.grd_pop);
	
	if(ds_pop1.FindRow('UD', 'A')!='-1')
	{
		trace("trace1");
		Tab0.tab1.grd_pop.Redraw = false;
		ds_pop.copy(ds_pop2);
		Tab0.tab1.grd_pop.Redraw = true;
	}else {
		trace("trace2");
		Tab0.tab1.grd_pop.Redraw = false;	
		ds_pop.copy(ds_pop1);
		Tab0.tab1.grd_pop.Redraw = true;		
	}
	
	//=================================TODO::안전검사===========================================
	
	
	if( parseInt(ds_pop.GetColumn(nRow,'F_SAFE_NUM')) < parseInt(ds_pop.GetColumn(nRow,'PROCESS_BY_SAFE_NUM')) ) // 공정별 안전검사단계가 실시된 안점검사보다 크면
	{
		ds_pop.SetColumn(nRow, "SAVE_COM_CHK", "0");
		gfn_showAlert("안전검사 후 완료체크 할 수 있습니다.");
		return;
	}

	for(var r=0; r<ds_pop.GetRowCount(); r++)
	{
		for(var c=0; c<ds_pop.GetColCount(); c++)
		{
			if(left(ds_pop.GetColID(c), 3)=="COL")
			{				
				if(ds_pop.GetColumn(r, c)=="1")
				{			
					ds_pop.SetColumn(r,"B_COL"+substr(ds_pop.GetColID(c), 3),"Y");					
				}
			}
		}
	}	
	
	var endd = parseInt(Tab0.tab1.grd_pop.GetColCount()) - 2 + parseInt(Tab0.tab1.grd_pop.GetColCount()) - 2;	
	var posid_1 = "";
	var cRow=1;

	posid_1 = _P_POSID ;
	Tab0.tab1.grd_pop.SetCellProp("summary", cRow+1, "Text", ds_pop3.GetColumn(ds_pop3.FindRow("POSID", posid_1), "TOT"));
	Tab0.tab1.grd_pop.SetCellProp("summary", endd+cRow-1, "Text", ds_pop3.GetColumn(ds_pop3.FindRow("POSID", posid_1), "TOT"));
	
	cRow++;

	//수금전 진행상태가 'P'(진행)이 아닐경우 공정진행 입력 금지 20100820 sjy
	if(E_FLAG != 'P')
	{
		Tab0.tab1.grd_pop.Editable = false;	
	}

	if(E_FLAG != 'P')
	{
		Tab0.tab1.grd_pop.Editable = false;	
	}
	
	
	//협력사는 조회만 가능
	if(gfn_getUserGroup()=="10")
	{
		Tab0.tab1.grd_pop.Editable = false;
		//Tab0.tab1.btn_gisung_save.visible = false;
	}
	else
	{
		Tab0.tab1.grd_pop.Editable = true;
		//Tab0.tab1.btn_gisung_save.visible = false;
	}
	
	
	
}

/********************************************************************************
* 기      능   : 조회 Callback
********************************************************************************/
function fn_afterDate(errCode, errMsg) {
	
}

/********************************************************************************
* 기      능   : 그리드 셀 클릭 시 이벤트
********************************************************************************/
function grd_pop_OnCellClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{	
	var curCol = Tab0.tab1.grd_pop.GetCellProp("body",nCell,"COLID");
	
	if(nCell == "5")
	{
		if(ds_pop.getColumn(nRow, "COM_CHK") <> "1") // 완료가 되지 않았을때
		{
			gfn_showAlert("완료되지않은 공정은 기성체크 할 수 없습니다.");
			return;
		}
	}
	
	

	//수금전 진행상태가 'P':진행이 아닐경우 공정진행 입력 금지 20100820 sjy
	if(E_FLAG != 'P') return;
	//협력사는 조회만
	if(gfn_getUserGroup()=="10") return;
	//=================================
	
	
	if(left(curCol, 3)=='COL'){
	
		if(ds_pop.GetColumn(nRow, "ZCHECK")=='X' && ds_pop.GetColumn(nRow, curCol)=='0' && ds_pop.GetColumn(nRow, "GISUNG_CHK" ) <> 'X')
		{
			for(var i=nRow; i>=0; i--)
			{
				if(ds_pop.GetColumn(i, curCol)==0  &&  ( ds_pop.GetColumn(nRow, "J" + curCol ) == '1'))
				{
					if(i!=nRow) ds_pop.SetColumn(i, curCol, '1');			
					ufn_setTodaysVal(i, nCell, 0);
				} 	
				if(ds_pop.GetColumn(i-1, "ZCHECK")=='X' && i!=nRow)
				{
					return;
				}
				
			}			
		}else{// alert("c");
			ufn_setTodaysVal(nRow, nCell, ds_pop.GetColumn(nRow, curCol));
		}
	  }
}

/********************************************************************************
* 기      능   : 당일 공정률 계산
********************************************************************************/
function ufn_setTodaysVal(nRow, nCell, val)
{
	var curCol = Tab0.tab1.grd_pop.GetCellProp("body",nCell,"COLID");	
	var pree = nCell-4+1;
	var midd = pree + parseInt(Tab0.tab1.grd_pop.GetColCount()) - 3;
	var endd = parseInt(Tab0.tab1.grd_pop.GetColCount()) - 3 + midd;	
	var preVal = ParseFloat(Tab0.tab1.grd_pop.GetCellProp("summary", pree, "Text"));
	var curVal = ParseFloat(Tab0.tab1.grd_pop.GetCellProp("summary", midd, "Text"));		

	if(left(curCol, 3)=='COL'){
        
		if(val==0 && ( ds_pop.GetColumn(nRow, "J" + curCol ) == '1' or  ds_pop.GetColumn(nRow, "GISUNG_CHK" ) == 'X')  ){
	
			curVal = ParseFloat(curVal) + ParseFloat(ds_pop.GetColumn(nRow, "PRO_R"));

		} else if(val==1  && ( ds_pop.GetColumn(nRow, "J" + curCol ) == '1' or  ds_pop.GetColumn(nRow, "GISUNG_CHK" ) ==  'X') ) {
		
			curVal = ParseFloat(curVal) - ParseFloat(ds_pop.GetColumn(nRow, "PRO_R"));
		
		}		
	} 	
	
	Tab0.tab1.grd_pop.SetCellProp("summary", midd, "Text", curVal);
	Tab0.tab1.grd_pop.SetCellProp("summary", endd, "Text", preVal + curVal);


}

/********************************************************************************
* 기      능   : 사진보기 버튼
********************************************************************************/
function btn_picture_OnClick(obj)
{
	if(length(_P_POSID) <> 0)  //호기가 선택되었을때
	{
		var arg = "P_POSID=" + quote(_P_POSID);
		var arr = gfn_openPopupUrl("PS02::PS0209001B.xml", true, arg); 
		
	}else{
		gfn_showAlert("선택된 호기가 없습니다. 확인바랍니다.");
		return;
	}
	
}

/********************************************************************************
* 기      능   : 저장 버튼
********************************************************************************/
function btn_gisung_save_OnClick(obj)
{

	if (!gfn_showConfirm("CW10025","저장하시겠습니까?")) 
    {
	 return;
    }
   
	if(length(_P_POSID) <> 0)  //호기가 선택되었을때
	{
		ds_save.deleteAll();
	    ds_save.copyF(ds_pop);
	   
	    for(var j=0; j<ds_save.GetRowCount(); j++)
	    {
		    ds_save.SetColumn(j,"PSPID", substr(_P_POSID,0,6));
		    ds_save.SetColumn(j,"POSID", _P_POSID);
		    ds_save.SetColumn(j,"GUBUN", _P_GUBUN);
		    
				
			if(ds_save.GetColumn(j, "COL")=="1"  && ds_save.GetColumn(j, "B_COL")=="N")
			{
				ds_save.SetColumn(j, "FLAG", "I");
			} 
			else if(ds_save.GetColumn(j, "COL")=="0" && ds_save.GetColumn(j, "B_COL")=="Y") 
			{
				ds_save.SetColumn(j, "FLAG", "D");
			} 	
	    }
	  
	    ds_save1.deleteAll();
	    ds_save.Filter("FLAG == 'I'");
	    ds_save1.copyF(ds_save);
	    ds_pop.unFilter();
	 
		ds_save2.deleteAll();
		ds_save.Filter("FLAG == 'D'");
		ds_save2.copyF(ds_save); 
		ds_pop.unFilter();
		
	    if(ds_save1.rowcount > 0) 
		{
			tit_clearActionInfo();
			tit_addMultiActionInfo("ps02:PS0207003C_I1");//zpst0112
			tit_callService(
						""
					    , ""
					    , "ds_save1=ds_save1"
					    , ""
						, ""
						, ""
						, ""
						, ""
						, true  // ""
						);
		 }
			
	     if(ds_save2.rowcount > 0) 
		 {
			tit_clearActionInfo();
		    tit_addMultiActionInfo("ps02:PS0207003C_D1");//zpst0112
		    tit_callService(
					""
					, ""
					, "ds_save2=ds_save2"
					, ""
					, ""
					, ""
					, ""
					, ""
					, true  // ""
					);
		  }  
		//쿼리재실행 TODO::
		select_construction_process();
	}else{
		gfn_showAlert("선택된 호기가 없습니다. 확인바랍니다.");
		return;
	}
}




function Tab0_OnChanged(obj,nOldIndex,nNewindex)
{
	//탭 선택을 변경해도 초기화 하지 않도록 수정하려고 했으나,
	//두 탭의 그리드 모두 같은 ds_list1을 사용하고 있어 활성화된 탭에 따라 ds_list1을 재활용하고 있음.
	//시간을 갖고 수정할 예정 - 2019.03.05 강민석K
	ds_list1.Clear();
	ds_pop.Clear();
	_TABGUBUN = nNewindex;
	if( length(ds_cond.GetColumn(ds_cond.row, "PSPID")) > 0 )
	{
		fn_query();
	}
	
}


]]></Script>
</Window>