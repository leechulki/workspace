<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="562" Id="PS0204001A" OnLoadCompleted="fn_OnLoadCompleted" OnUnloadCompleted="fn_OnUnloadCompleted" PidAttrib="7" Title="공정진행현황" Ver="1.0" Width="978" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_gbn">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_status">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_combo1">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_combo2">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_combo3">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
					<colinfo id="SORTL" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_combo">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond">
				<Contents>
					<colinfo id="FROM_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="TO_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="UPN" size="256" summ="default" type="STRING"/>
					<colinfo id="COMBO1" size="256" summ="default" type="STRING"/>
					<colinfo id="COMBO2" size="256" summ="default" type="STRING"/>
					<colinfo id="COMBO3" size="256" summ="default" type="STRING"/>
					<colinfo id="AREA_CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="SO2" size="256" summ="default" type="STRING"/>
					<colinfo id="SO3" size="256" summ="default" type="STRING"/>
					<colinfo id="SO4" size="256" summ="default" type="STRING"/>
					<colinfo id="SO5" size="256" summ="default" type="STRING"/>
					<colinfo id="SO_GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="SO6" size="256" summ="default" type="STRING"/>
					<colinfo id="SO7" size="256" summ="default" type="STRING"/>
					<colinfo id="SO8" size="256" summ="default" type="STRING"/>
					<colinfo id="SO9" size="256" summ="default" type="STRING"/>
					<colinfo id="SO_GBN2" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZGUBUN" size="256" summ="default" type="STRING"/>
					<colinfo id="column0" size="256" summ="default" type="STRING"/>
					<record>
						<AREA_CODE></AREA_CODE>
						<column0></column0>
						<COMBO1></COMBO1>
						<COMBO2></COMBO2>
						<COMBO3></COMBO3>
						<FROM_DT></FROM_DT>
						<SO2></SO2>
						<SO3></SO3>
						<SO4></SO4>
						<SO5></SO5>
						<SO6></SO6>
						<SO7></SO7>
						<SO8></SO8>
						<SO9></SO9>
						<SO_GBN></SO_GBN>
						<SO_GBN2></SO_GBN2>
						<TO_DT></TO_DT>
						<UPN></UPN>
						<ZZGUBUN></ZZGUBUN>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list">
				<Contents>
					<colinfo id="EDATE" size="24" summ="default" type="STRING"/>
					<colinfo id="ETIME" size="18" summ="default" type="STRING"/>
					<colinfo id="LIFNR" size="30" summ="default" type="STRING"/>
					<colinfo id="MANDT" size="9" summ="default" type="STRING"/>
					<colinfo id="MDATE" size="24" summ="default" type="STRING"/>
					<colinfo id="MTIME" size="18" summ="default" type="STRING"/>
					<colinfo id="NAMET" size="60" summ="default" type="STRING"/>
					<colinfo id="NAMET2" size="60" summ="default" type="STRING"/>
					<colinfo id="POSID" size="72" summ="default" type="STRING"/>
					<colinfo id="POSID_1" size="72" summ="default" type="STRING"/>
					<colinfo id="POSID_M" size="72" summ="default" type="STRING"/>
					<colinfo id="POSID_OLD" size="72" summ="default" type="STRING"/>
					<colinfo id="PRART" size="6" summ="default" type="STRING"/>
					<colinfo id="TEMNO" size="18" summ="default" type="STRING"/>
					<colinfo id="TEMNO2" size="18" summ="default" type="STRING"/>
					<colinfo id="TEXT30" size="90" summ="default" type="STRING"/>
					<colinfo id="TXT04" size="12" summ="default" type="STRING"/>
					<colinfo id="TXT30" size="90" summ="default" type="STRING"/>
					<colinfo id="VDATU" size="24" summ="default" type="STRING"/>
					<colinfo id="ZBEPJEO" size="24" summ="default" type="STRING"/>
					<colinfo id="ZBOSUIN" size="24" summ="default" type="STRING"/>
					<colinfo id="ZBOSUOUT" size="24" summ="default" type="STRING"/>
					<colinfo id="ZFLAG01" size="3" summ="default" type="STRING"/>
					<colinfo id="ZGUBUN" size="6" summ="default" type="STRING"/>
					<colinfo id="ZMUSAOCNT" size="6" summ="default" type="STRING"/>
					<colinfo id="ZMUSAOCNT2" size="6" summ="default" type="STRING"/>
					<colinfo id="ZMUSAUCNT" size="6" summ="default" type="STRING"/>
					<colinfo id="ZMUSAUCNT2" size="6" summ="default" type="STRING"/>
					<colinfo id="ZOIPSU" size="24" summ="default" type="STRING"/>
					<colinfo id="ZQEGEMSA" size="24" summ="default" type="STRING"/>
					<colinfo id="ZQEMIDDL" size="24" summ="default" type="STRING"/>
					<colinfo id="ZSPEC1" size="15" summ="default" type="STRING"/>
					<colinfo id="ZSPEC10" size="9" summ="default" type="STRING"/>
					<colinfo id="ZSPEC2" size="75" summ="default" type="STRING"/>
					<colinfo id="ZSPEC3" size="12" summ="default" type="STRING"/>
					<colinfo id="ZSPEC4" size="6" summ="default" type="STRING"/>
					<colinfo id="ZSPEC5" size="9" summ="default" type="STRING"/>
					<colinfo id="ZSPEC6" size="12" summ="default" type="STRING"/>
					<colinfo id="ZSPEC7" size="9" summ="default" type="STRING"/>
					<colinfo id="ZSPEC8" size="12" summ="default" type="STRING"/>
					<colinfo id="ZSPEC9" size="9" summ="default" type="STRING"/>
					<colinfo id="ZZACTSS" size="9" summ="default" type="STRING"/>
					<colinfo id="ZZBPM" size="30" summ="default" type="STRING"/>
					<colinfo id="ZZBSU" size="15" summ="default" type="STRING"/>
					<colinfo id="ZZCHAKD" size="24" summ="default" type="STRING"/>
					<colinfo id="ZZCHAKG" size="3" summ="default" type="STRING"/>
					<colinfo id="ZZCOMP2" size="24" summ="default" type="STRING"/>
					<colinfo id="ZZDAT01" size="24" summ="default" type="STRING"/>
					<colinfo id="ZZFKEYD" size="3" summ="default" type="STRING"/>
					<colinfo id="ZZFKEYP" size="3" summ="default" type="STRING"/>
					<colinfo id="ZZFKEYP2" size="3" summ="default" type="STRING"/>
					<colinfo id="ZZFMAGA" size="3" summ="default" type="STRING"/>
					<colinfo id="ZZGUBUN" size="6" summ="default" type="STRING"/>
					<colinfo id="ZZILSIC" size="3" summ="default" type="STRING"/>
					<colinfo id="ZZINTER" size="3" summ="default" type="STRING"/>
					<colinfo id="ZZJUNGD" size="24" summ="default" type="STRING"/>
					<colinfo id="ZZJUNGO" size="3" summ="default" type="STRING"/>
					<colinfo id="ZZPMJID" size="24" summ="default" type="STRING"/>
					<colinfo id="ZZSHIP1" size="24" summ="default" type="STRING"/>
					<colinfo id="ZZSHIP2" size="24" summ="default" type="STRING"/>
					<colinfo id="ZZSHIP3" size="24" summ="default" type="STRING"/>
					<colinfo id="ZZSHIP4" size="24" summ="default" type="STRING"/>
					<colinfo id="ZZSHIP5" size="24" summ="default" type="STRING"/>
					<colinfo id="ZZSHIP6" size="24" summ="default" type="STRING"/>
					<colinfo id="ZZSTAN1" size="3" summ="default" type="STRING"/>
					<colinfo id="ZZSTAN2" size="3" summ="default" type="STRING"/>
					<colinfo id="ZSITE_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSPEC" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_error">
				<Contents>
					<colinfo id="IDX" size="256" type="STRING"/>
					<colinfo id="ERRMSG" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list2">
				<Contents>
					<colinfo id="ADDR" size="210" type="STRING"/>
					<colinfo id="CONTR_DA" size="24" type="STRING"/>
					<colinfo id="KUNNR_NM" size="105" type="STRING"/>
					<colinfo id="TXT30" size="90" type="STRING"/>
					<colinfo id="VDATU" size="24" type="STRING"/>
					<colinfo id="ZQNTY" size="6" type="STRING"/>
					<colinfo id="ZSITE_NM" size="105" type="STRING"/>
					<colinfo id="ZSITE_TEL" size="60" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list3">
				<Contents>
					<colinfo id="CHECK" size="1" summ="default" type="STRING"/>
					<colinfo id="LIF_NAME" size="105" summ="default" type="STRING"/>
					<colinfo id="NAMET" size="60" summ="default" type="STRING"/>
					<colinfo id="NAMET2" size="60" summ="default" type="STRING"/>
					<colinfo id="POSID" size="72" summ="default" type="STRING"/>
					<colinfo id="POSID_1" size="72" summ="default" type="STRING"/>
					<colinfo id="POSID_OLD" size="72" summ="default" type="STRING"/>
					<colinfo id="PRO_R" size="33" summ="default" type="DECIMAL"/>
					<colinfo id="PRONR" size="6" summ="default" type="STRING"/>
					<colinfo id="PROWRK" size="150" summ="default" type="STRING"/>
					<colinfo id="TEXT30" size="90" summ="default" type="STRING"/>
					<colinfo id="TXT30" size="90" summ="default" type="STRING"/>
					<colinfo id="VER" size="9" summ="default" type="STRING"/>
					<colinfo id="ZSPEC1" size="15" summ="default" type="STRING"/>
					<colinfo id="ZSPEC2" size="75" summ="default" type="STRING"/>
					<colinfo id="ZZCOMP2" size="24" summ="default" type="STRING"/>
					<colinfo id="ZZDAT01" size="24" summ="default" type="STRING"/>
					<colinfo id="ZZJUNGD" size="24" summ="default" type="STRING"/>
					<colinfo id="SAFE" size="256" summ="default" type="STRING"/>
					<colinfo id="PRO_SUM" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSPEC" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSPEC12" size="15" summ="default" type="STRING"/>
					<colinfo id="ZZILSIC" size="256" summ="default" type="STRING"/>
					<colinfo id="ZQEGEMSA" size="256" summ="default" type="STRING"/>
					<colinfo id="ZBOSUOUT" size="256" summ="default" type="STRING"/>
					<colinfo id="SAFE2" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_detail" OnLoadCompleted="ds_detail_OnLoadCompleted"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_save">
				<Contents>
					<colinfo id="FLAG" size="256" type="STRING"/>
					<colinfo id="POSID" size="256" type="STRING"/>
					<colinfo id="POSID_1" size="256" type="STRING"/>
					<colinfo id="GUBUN" size="256" type="STRING"/>
					<colinfo id="PRONR" size="256" type="STRING"/>
					<colinfo id="PROWRK" size="256" type="STRING"/>
					<colinfo id="PRO_R" size="256" type="STRING"/>
					<colinfo id="CRDAT" size="256" type="STRING"/>
					<colinfo id="VER" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_pin">
				<Contents>
					<colinfo id="VALUE" size="256" type="STRING"/>
					<colinfo id="XVALUE" size="256" type="STRING"/>
					<colinfo id="LIFNR" size="256" type="STRING"/>
					<colinfo id="PINYN" size="256" type="STRING"/>
					<colinfo id="PSPID" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_pinyn">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
					<record>
						<CODE>Y</CODE>
						<CODE_NAME>완료</CODE_NAME>
					</record>
					<record>
						<CODE>N</CODE>
						<CODE_NAME>미완료</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list4">
				<Contents>
					<colinfo id="CHECK" size="256" summ="default" type="STRING"/>
					<colinfo id="PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSPEC1" size="256" summ="default" type="STRING"/>
					<colinfo id="STEP1" size="256" summ="default" type="STRING"/>
					<colinfo id="STEP1_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="STEP2" size="256" summ="default" type="STRING"/>
					<colinfo id="STEP2_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="STEP3" size="256" summ="default" type="STRING"/>
					<colinfo id="STEP3_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="SAFE1_CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="SAFE2_CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="PHOTO1" size="256" summ="default" type="STRING"/>
					<colinfo id="PHOTO2" size="256" summ="default" type="STRING"/>
					<colinfo id="PHOTO3" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
		</Datasets>
		<Shape BKColor="user0" Bottom="52" Height="52" Id="Shape0" Left="0" LineColor="user1" Right="978" TabOrder="1" Top="0" Type="Rectangle" Width="978"></Shape>
		<Static Align="Right" Height="20" Id="Static0" Left="5" Style="sty_lb_search" TabOrder="2" Text="착공일&#32;" Top="5" VAlign="Middle" Width="88"></Static>
		<Calendar BindDataset="ds_cond" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="FROM_DT" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_from" Left="97" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_search" SundayTextColor="user35" TabOrder="4" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="5" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="97"></Calendar>
		<Static Align="Center" Border="None" Color="user7" Font="굴림,9" Height="20" Id="Static13" Left="197" TabOrder="3" Text="~" Top="5" VAlign="Middle" Width="18"></Static>
		<Calendar BindDataset="ds_cond" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="TO_DT" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_to" Left="217" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_search" SundayTextColor="user35" TabOrder="5" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="5" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="97"></Calendar>
		<Static Align="Right" Height="20" Id="Static1" Left="5" Style="sty_lb_search" TabOrder="6" Text="프로젝트번호&#32;" Top="27" VAlign="Middle" Width="88"></Static>
		<Edit BindDataset="ds_cond" Border="Flat" CheckLength="Byte" Column="UPN" Height="20" Id="ed_pjt" ImeMode="english" Left="97" MaxLength="6" Style="sty_ipt_search" TabOrder="7" Top="27" UpperOnly="TRUE" Width="73"></Edit>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="CODE" Column="COMBO1" DataColumn="CODE_NAME" Height="20" Id="cb_combo1" InnerDataset="ds_combo1" Left="442" OnChanged="cb_combo1_OnChanged" Style="sty_ipt_search" TabOrder="8" Top="26" Width="97"></Combo>
		<Static Align="Right" Height="20" Id="Static2" Left="350" Style="sty_lb_search" TabOrder="9" Text="사무소&#32;" Top="27" VAlign="Middle" Width="88"></Static>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="CODE" Column="COMBO2" DataColumn="CODE_NAME" Height="20" Id="cb_combo2" InnerDataset="ds_combo2" Left="634" Style="sty_ipt_search" TabOrder="10" Top="26" Width="97"></Combo>
		<Static Align="Right" Height="20" Id="Static3" Left="542" Style="sty_lb_search" TabOrder="11" Text="PM&#32;" Top="27" VAlign="Middle" Width="88"></Static>
		<Static Align="Right" Height="20" Id="Static4" Left="734" Style="sty_lb_search" TabOrder="13" Text="협력업체&#32;" Top="27" VAlign="Middle" Width="88"></Static>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="CODE" Column="COMBO3" DataColumn="CODE_NAME" Height="20" Id="cb_combo3" InnerDataset="ds_combo3" Left="826" Style="sty_ipt_search" TabOrder="12" Top="26" Width="120"></Combo>
		<Tab Border="Flat" Font="굴림,9" Height="502" Id="Tab00" Left="10" MouseOverColor="user16" SelColor="user15" SelectFont="굴림,9" Style="sty_tab" TabIndex="1" TabOrder="14" Top="58" Width="958">
			<Contents>
				<TabPage BorderColor="black" Height="476" Id="tab1" ImageID="tab_form_08" Left="2" TabOrder="19" Text="공정진행현황" Top="24" Width="954">
					<Grid AreaSelect="TRUE" AutoFitEndLine="Hide" BindDataset="ds_list" BkColor2="default" BoldHead="true" Border="Flat" Bottom="478" ColSelect="TRUE" ColSizing="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="472" Id="grd_list" InputPanel="FALSE" Left="4" LineColor="user20" LineType="ExHORZ" OnCellDBLClick="Tab00_tab1_grd_list_OnCellDblClick" OnHeadClick="grd_list_OnHeadClick" Right="952" RowHeight="20" Style="sty_grid" TabOrder="1" TabStop="true" Top="6" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="948">
						<contents>
							<format id="Default">
								<columns>
									<col width="60"/>
									<col width="140"/>
									<col width="70"/>
									<col width="60"/>
									<col width="70"/>
									<col width="70"/>
									<col width="120"/>
									<col width="70"/>
									<col width="70"/>
									<col width="70"/>
									<col width="80"/>
									<col width="50"/>
									<col width="106"/>
									<col width="60"/>
									<col width="60"/>
									<col width="109"/>
									<col width="50"/>
									<col width="70"/>
								</columns>
								<head>
									<cell col="0" display="text" font="굴림,9" text="프로젝트"/>
									<cell col="1" display="text" font="굴림,9" text="프로젝트명"/>
									<cell col="2" display="text" font="굴림,9" text="호기번호"/>
									<cell col="3" display="text" font="굴림,9" text="현장호기"/>
									<cell col="4" display="text" font="굴림,9" text="기종"/>
									<cell col="5" display="text" font="굴림,9" text="기종"/>
									<cell col="6" display="text" font="굴림,9" text="사양"/>
									<cell col="7" display="text" font="굴림,9" text="착공일"/>
									<cell col="8" display="text" font="굴림,9" text="준공예정일"/>
									<cell col="9" display="text" font="굴림,9" text="준공일"/>
									<cell col="10" display="text" font="굴림,9" text="사무소"/>
									<cell col="11" display="text" font="굴림,9" text="PM"/>
									<cell col="12" display="text" font="굴림,9" text="협력업체"/>
									<cell col="13" display="text" font="굴림,9" text="작업팀장"/>
									<cell col="14" display="text" font="굴림,9" text="진행율(%)"/>
									<cell col="15" display="text" font="굴림,9" text="진행단계"/>
									<cell col="16" display="text" font="굴림,9" text="상태"/>
									<cell col="17" display="text" font="굴림,9" text="일식외주"/>
								</head>
								<body>
									<cell align="center" bkcolor2="user22" col="0" colid="POSID" display="text"/>
									<cell bkcolor2="user22" col="1" colid="ZSITE_NM" display="text"/>
									<cell align="center" bkcolor2="user22" col="2" colid="POSID_1" display="text"/>
									<cell bkcolor2="user22" col="3" colid="POSID_OLD" display="text"/>
									<cell bkcolor2="user22" col="4" colid="ZSPEC1" display="text"/>
									<cell bkcolor2="user22" col="5" colid="ZSPEC" display="text"/>
									<cell bkcolor2="user22" col="6" colid="ZSPEC2" display="text"/>
									<cell align="center" bkcolor2="user22" col="7" colid="ZZDAT01" display="text" Mask="####.##.##"/>
									<cell align="center" bkcolor2="user22" col="8" colid="ZZCOMP2" display="text" Mask="####.##.##"/>
									<cell align="center" bkcolor2="user22" col="9" colid="ZZJUNGD" display="text" Mask="####.##.##"/>
									<cell bkcolor2="user22" col="10" colid="TEXT30" display="text"/>
									<cell align="center" bkcolor2="user22" col="11" colid="NAMET" display="text"/>
									<cell bkcolor2="user22" col="12" colid="LIF_NAME" display="text"/>
									<cell align="center" bkcolor2="user22" col="13" colid="NAMET2" display="text"/>
									<cell align="right" bkcolor2="user22" col="14" colid="PRO_R" display="number" Mask="##0.0"/>
									<cell bkcolor2="user22" col="15" colid="PROWRK" display="text"/>
									<cell align="center" bkcolor2="user22" col="16" colid="TXT30" display="text"/>
									<cell align="center" bkcolor2="user22" col="17" colid="ZZILSIC" display="text"/>
								</body>
							</format>
						</contents>
					</Grid>
				</TabPage>
				<TabPage BorderColor="black" Height="476" Id="tab2" ImageID="tab_form_08" Left="2" TabOrder="26" Text="공정진행입력/수정" Top="24" Width="954">
					<Shape BKColor="user12" Bottom="78" Height="26" Id="Shape0" Left="3" LineColor="user13" Right="951" TabOrder="5" Top="52" Type="Rectangle" Width="948"></Shape>
					<Grid AreaSelect="TRUE" AutoFitEndLine="Hide" BindDataset="ds_list3" BkColor2="default" BoldHead="true" Border="Flat" Bottom="464" ColSelect="TRUE" ColSizing="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="354" Id="grd_list3" InputPanel="FALSE" Left="4" LineColor="user20" LineType="ExHORZ" OnHeadClick="Tab00_tab2_grd_list3_OnHeadClick" Right="952" RowHeight="20" Style="sty_grid" TabOrder="1" TabStop="true" Top="110" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="948">
						<contents>
							<format id="Default">
								<columns>
									<col width="21"/>
									<col width="80"/>
									<col width="80"/>
									<col width="60"/>
									<col width="80"/>
									<col width="80"/>
									<col width="120"/>
									<col width="80"/>
									<col width="80"/>
									<col width="80"/>
									<col width="80"/>
									<col width="80"/>
									<col width="106"/>
									<col width="80"/>
									<col width="60"/>
									<col width="100"/>
									<col width="70"/>
									<col width="68"/>
									<col width="0"/>
									<col width="0"/>
								</columns>
								<head>
									<cell col="0" display="checkbox" edit="checkbox" font="굴,9"/>
									<cell col="1" display="text" font="굴림,9" text="프로젝트"/>
									<cell col="2" display="text" font="굴림,9" text="호기번호"/>
									<cell col="3" display="text" font="굴림,9" text="현장호기"/>
									<cell col="4" display="text" font="굴림,9" text="기종"/>
									<cell col="5" display="text" font="굴림,9" text="기종"/>
									<cell col="6" display="text" font="굴림,9" text="사양"/>
									<cell col="7" display="text" font="굴림,9" text="착공일"/>
									<cell col="8" display="text" font="굴림,9" text="준공예정일"/>
									<cell col="9" display="text" font="굴림,9" text="준공일"/>
									<cell col="10" display="text" font="굴림,9" text="사무소"/>
									<cell col="11" display="text" font="굴림,9" text="PM"/>
									<cell col="12" display="text" font="굴림,9" text="협력업체"/>
									<cell col="13" display="text" font="굴림,9" text="작업팀장"/>
									<cell col="14" display="text" font="굴림,9" text="진행율"/>
									<cell col="15" display="text" font="굴림,9" text="진행단계"/>
									<cell col="16" display="text" font="굴림,9" text="상태"/>
									<cell col="17" display="text" font="굴림,9" text="일식외주"/>
									<cell col="18" display="text" font="굴림,9" text="QE검사일"/>
									<cell col="19" display="text" font="굴림,9" text="보수인계일"/>
								</head>
								<body>
									<cell bkcolor2="user22" col="0" colid="CHECK" display="checkbox" edit="checkbox"/>
									<cell align="center" bkcolor2="user22" col="1" colid="POSID" display="text"/>
									<cell align="center" bkcolor2="user22" col="2" colid="POSID_1" display="text"/>
									<cell align="center" bkcolor2="user22" col="3" colid="POSID_OLD" display="text"/>
									<cell bkcolor2="user22" col="4" colid="zSPEC1" display="text"/>
									<cell bkcolor2="user22" col="5" colid="ZSPEC" display="text"/>
									<cell bkcolor2="user22" col="6" colid="ZSPEC2" display="text"/>
									<cell bkcolor2="user22" col="7" colid="zzdAT01" display="text" Mask="####.##.##"/>
									<cell bkcolor2="user22" col="8" colid="ZZCOMP2" display="text" Mask="####.##.##"/>
									<cell bkcolor2="user22" col="9" colid="ZZJUNGD" display="text" Mask="####.##.##"/>
									<cell bkcolor2="user22" col="10" colid="TEXT30" display="text"/>
									<cell bkcolor2="user22" col="11" colid="NAMET" display="text"/>
									<cell bkcolor2="user22" col="12" colid="LIF_NAME" display="text"/>
									<cell bkcolor2="user22" col="13" colid="NAMET2" display="text"/>
									<cell bkcolor2="user22" col="14" colid="PRO_R" display="text"/>
									<cell bkcolor2="user22" col="15" colid="PROWRK" display="text"/>
									<cell bkcolor2="user22" col="16" colid="TXT30" display="text"/>
									<cell bkcolor2="user22" col="17" colid="ZZILSIC" display="text"/>
									<cell bkcolor2="user22" col="18" colid="ZQEGEMSA" display="date"/>
									<cell bkcolor2="user22" col="19" colid="ZBOSUOUT" display="date"/>
								</body>
							</format>
						</contents>
					</Grid>
					<Shape BKColor="user12" Bottom="53" Height="26" Id="Shape1" Left="3" LineColor="user13" Right="951" TabOrder="2" Top="27" Type="Rectangle" Width="948"></Shape>
					<Static Align="Right" Height="24" Id="Static4" Left="4" Style="sty_lb_form_basic" TabOrder="3" Text="공사명&#32;" Top="28" VAlign="Middle" Width="100"></Static>
					<Edit BindDataset="ds_list2" Border="Flat" Column="ZSITE_NM" Height="20" Id="Edit2" Left="106" LeftMargin="4" Readonly="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="4" Top="30" Width="590"></Edit>
					<Static Align="Right" Height="24" Id="Static0" Left="4" Style="sty_lb_form_basic" TabOrder="6" Text="수주처&#32;" Top="53" VAlign="Middle" Width="100"></Static>
					<Edit BindDataset="ds_list2" Border="Flat" Column="KUNNR_NM" Height="20" Id="Edit0" Left="106" LeftMargin="4" Readonly="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="7" Top="55" Width="338"></Edit>
					<Static Align="Right" Height="24" Id="Static1" Left="446" Style="sty_lb_form_basic" TabOrder="8" Text="대수&#32;" Top="53" VAlign="Middle" Width="100"></Static>
					<Static Align="Right" Height="24" Id="Static2" Left="698" Style="sty_lb_form_basic" TabOrder="9" Text="납기일&#32;" Top="53" VAlign="Middle" Width="100"></Static>
					<Calendar BindDataset="ds_list2" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="VDATU" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Enable="FALSE" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="Calendar2" Left="800" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="10" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="55" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="148"></Calendar>
					<Static Align="Right" Height="24" Id="Static3" Left="698" Style="sty_lb_form_basic" TabOrder="11" Text="계약일&#32;" Top="28" VAlign="Middle" Width="100"></Static>
					<Calendar BindDataset="ds_list2" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="CONTR_DA" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Enable="FALSE" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="Calendar0" Left="800" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="12" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="30" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="148"></Calendar>
					<Shape BKColor="user12" Bottom="103" Height="26" Id="Shape2" Left="3" LineColor="user13" Right="951" TabOrder="13" Top="77" Type="Rectangle" Width="948"></Shape>
					<Static Align="Right" Height="24" Id="Static5" Left="4" Style="sty_lb_form_basic" TabOrder="14" Text="설치지&#32;" Top="78" VAlign="Middle" Width="100"></Static>
					<Edit BindDataset="ds_list2" Border="Flat" Column="ADDR" Height="20" Id="Edit3" Left="106" LeftMargin="4" Readonly="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="15" Top="80" Width="338"></Edit>
					<Static Align="Right" Height="24" Id="Static6" Left="446" Style="sty_lb_form_basic" TabOrder="16" Text="현장전화&#32;" Top="78" VAlign="Middle" Width="100"></Static>
					<Edit BindDataset="ds_list2" Border="Flat" Column="ZSITE_TEL" Height="20" Id="Edit4" Left="548" LeftMargin="4" Readonly="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="17" Top="80" Width="148"></Edit>
					<Static Align="Right" Height="24" Id="Static7" Left="698" Style="sty_lb_form_basic" TabOrder="18" Text="상태&#32;" Top="78" VAlign="Middle" Width="100"></Static>
					<MaskEdit BindDataset="ds_list2" Border="Flat" Column="ZQNTY" Height="20" Id="MaskEdit0" Left="548" Readonly="TRUE" Style="sty_ipt_form" TabOrder="19" Top="55" Width="148"></MaskEdit>
					<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_workProc" ImageID="btn_sub_05" Left="868" LeftMargin="12" OnClick="Tab00_tab2_btn_workProc_OnClick" Style="sty_btn" TabOrder="20" Text="공정진행표" Top="3" Transparent="TRUE" Width="83"></Button>
					<Edit BindDataset="ds_list2" Border="Flat" Column="TXT30" Height="20" Id="Edit1" Left="800" LeftMargin="4" Readonly="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="21" Top="80" Width="148"></Edit>
					<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_save" ImageID="btn_sub_02" Left="820" LeftMargin="12" OnClick="fn_save" Style="sty_btn" TabOrder="22" Text="저장" Top="3" Transparent="TRUE" Width="47"></Button>
					<Static Align="Center" Height="24" Id="Static11" Left="4" Style="sty_lb_form_basic" TabOrder="23" Text="승강로핀제거&#32;" Top="1" VAlign="Middle" Width="86"></Static>
					<Combo BindDataset="ds_pin" Border="Flat" CodeColumn="CODE" Column="PINYN" DataColumn="CODE_NAME" Height="22" Id="cb_pinyn" InnerDataset="ds_pinyn" Left="90" Style="sty_ipt_search" TabOrder="24" Top="2" Width="82"></Combo>
					<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btn_pin" ImageID="btn_sub_09" Left="292" LeftMargin="12" OnClick="Tab00_tab2_btn_pin_OnClick" Style="sty_btn" TabOrder="25" Text="핀제거확인서&#32;LINK" Top="3" Transparent="TRUE" Width="132"></Button>
					<Static Align="Right" Height="24" Id="Static10" Left="430" Style="sty_lb_form_basic" TabOrder="26" Text="전체층&#32;" Top="1" VAlign="Middle" Width="80"></Static>
					<Edit Align="RIGHT" BindDataset="ds_pin" BKColor="user5" Border="Flat" CheckLength="Byte" Column="VALUE" Height="21" Id="Edit7" Left="518" LeftMargin="4" MaxLength="40" Number="TRUE" Readonly="TRUE" RightMargin="4" Style="sty_ipt_form_ind" TabOrder="29" Top="2" Width="80"></Edit>
					<Static Align="Right" Height="24" Id="Static12" Left="610" Style="sty_lb_form_basic" TabOrder="27" Text="핀제거층&#32;" Top="1" VAlign="Middle" Width="80"></Static>
					<Edit Align="RIGHT" BindDataset="ds_pin" BKColor="user5" Border="Flat" CheckLength="Byte" Column="XVALUE" Height="21" Id="Edit6" Left="695" LeftMargin="4" MaxLength="40" Number="TRUE" Readonly="TRUE" RightMargin="4" Style="sty_ipt_form_ind" TabOrder="28" Top="2" Width="80"></Edit>
					<Button ButtonStyle="TRUE" Color="user8" Cursor="HAND" Height="22" Id="btn_pin_save" ImageID="btn_sub_07" Left="178" OnClick="Tab00_tab2_btn_pin_save_OnClick" Style="sty_btn" TabOrder="30" Text="핀제거완료저장" Top="3" Width="107"></Button>
				</TabPage>
			</Contents>
		</Tab>
		<Button Height="18" Id="btn_popProj" ImageID="btn_icon_search" Left="174" OnClick="btn_popProj_OnClick" TabOrder="15" Text="Button0" Top="28" Transparent="TRUE" Width="18"></Button>
		<Static Align="Right" Height="20" Id="Static5" Left="350" Style="sty_lb_search" TabOrder="16" Text="사업부&#32;" Top="5" VAlign="Middle" Width="88"></Static>
		<Checkbox BindDataset="ds_cond" Column="SO2" FalseValue="0" Height="18" Id="chk_so2" Left="449" OnClick="chk_so2_OnClick" Style="sty_ipt_search_chk" TabOrder="17" Text="설치" Top="6" TrueValue="1" Width="50"></Checkbox>
		<Checkbox BindDataset="ds_cond" Column="SO3" FalseValue="0" Height="18" Id="chk_so3" Left="502" OnClick="chk_so2_OnClick" Style="sty_ipt_search_chk" TabOrder="18" Text="양중" Top="6" TrueValue="1" Width="50"></Checkbox>
		<Checkbox BindDataset="ds_cond" Column="SO5" FalseValue="0" Height="18" Id="chk_so5" Left="605" OnClick="chk_so2_OnClick" Style="sty_ipt_search_chk" TabOrder="19" Text="외주" Top="6" TrueValue="1" Width="50"></Checkbox>
		<Static Align="Right" Border="Flat" Height="20" Id="Static6" Left="444" Style="sty_ipt_search" TabOrder="20" Top="5" VAlign="Middle" Width="264"></Static>
		<Checkbox BindDataset="ds_cond" Column="SO4" FalseValue="0" Height="18" Id="chk_so4" Left="555" OnClick="chk_so2_OnClick" Style="sty_ipt_search_chk" TabOrder="21" Text="보수" Top="6" TrueValue="1" Width="50"></Checkbox>
		<Checkbox BindDataset="ds_cond" Column="SO6" FalseValue="0" Height="18" Id="chk_so6" Left="656" OnClick="chk_so2_OnClick" Style="sty_ipt_search_chk" TabOrder="22" Text="폐업" Top="6" TrueValue="1" Width="42"></Checkbox>
		<Checkbox BindDataset="ds_cond" Column="SO7" FalseValue="0" Height="18" Id="chk_so7" Left="832" Style="sty_ipt_search_chk" TabOrder="23" Text="일식외주" Top="6" TrueValue="1" Width="65"></Checkbox>
		<Static Align="Right" Height="20" Id="Static7" Left="734" Style="sty_lb_search" TabOrder="24" Text="일식외주&#32;" Top="3" VAlign="Middle" Width="88"></Static>
		<Static Align="Right" Border="Flat" Height="20" Id="Static8" Left="828" Style="sty_ipt_search" TabOrder="25" Top="5" VAlign="Middle" Width="76"></Static>
	</Form>
	<Script><![CDATA[﻿﻿﻿﻿﻿﻿﻿﻿/*
 ******************************************************************************************
 * 기      능   : 
 * 작  성  자   : 
 * 작성  일자   : 
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
#include "LIB::commons.js";	// 공통 스크립트 
//=========================================================================================
// [ PART 1 ]
// Form에서 사용될 전역변수를 선언
// FORM에서 사용되는 전역변수는 대문자로 작성하며, F_XXX 의 형태를 갖도록 한다. 
//=========================================================================================
var F_POSID="";
var F_LIFNR="";
var F_GUBUN="";
var F_ZSPEC="";
var E_FLAG; //수금전 진행현황
//=========================================================================================
// [ PART 2 ]
// Form Loading / Unloading 시 작업 정의
//=========================================================================================
function fn_OnLoadCompleted(obj) {
	gfn_initForm(true);
	if(ds_cond.GetRowCount()<1) ds_cond.AddRow();
	cal_from.Value = left(gfn_getCurrDate(), 6)+"01";
	cal_to.Value = gfn_getCurrDate();
	
    var user_grp = gfn_getUserGroup();

	if(user_grp == '10')
	{
		chk_so2.Enable = false;
		chk_so3.Enable = false;
		chk_so4.Enable = false;
		chk_so5.Enable = false;
		chk_so6.Enable = false;
	}
	else
	{
		chk_so2.Enable = true;
		chk_so3.Enable = true;
		chk_so4.Enable = true;
		chk_so5.Enable = true;
		chk_so6.Enable = true;
	}
    
	//	설치협력사
	if(user_grp=="10"){
		cb_combo1.Enable = false;
		cb_combo2.Enable = false;
		cb_combo3.Enable = false;
		
		tit_clearActionInfo();	
		tit_addSearchActionInfo("ps02:PS0204001A_S1");		
		tit_callService(
			""
			, ""
			, "ds_cond=ds_cond"
			, "ds_combo3=ds_list"
			, ""
			, "fn_afterCombo"
			, true);
			
	//	설치사무소
	} else if(user_grp=="20" || user_grp=="30"){	
		cb_combo1.Enable = false;
		tit_clearActionInfo();
		tit_addSearchActionInfo("ps02:PS0201001A_S31");
		tit_addSearchActionInfo("ps02:PS0201001A_S32");
		tit_addSearchActionInfo("ps02:PS0201001A_S33");
		tit_callService(
			""
			, ""
			, "ds_cond_cd=ds_cond"
			, "ds_combo1=ds_zzactss_cd ds_combo2=ds_zzpmnum_cd ds_combo3=ds_zzlifnr_cd"
			, ""
			, "fn_after30"
			, true,true);
		
		
	//	설치부
	} else if(user_grp=="40") {
		//코드콤보 설정 : 지역, 구분2 
		var codeArr = ["PS003"];
		var dsObjArr = [ds_combo1];
		var addTypeArr = [G_CODE_ALL];
		gfn_searchCommCode(codeArr, dsObjArr, addTypeArr);
		
		tit_clearActionInfo();
		tit_addSearchActionInfo("ps02:PS0201001A_S33");
		tit_callService(
			""
			, ""
			, "ds_cond=ds_cond"
			, "ds_combo3=ds_zzlifnr_cd"
			, ""
			, "fn_after40"
			, true,true);
	}
}
/********************************************************************************
* 기      능   : 조회 Callback  - 설치사무소 로그인시 사무소코드 첫번째 선택
********************************************************************************/
function fn_after30(errCode, errMsg) {
	cb_combo1.Index = 0;

	gfn_insertEmptyRow( ds_combo2, G_CODE_ALL );
	cb_combo2.value = "";	
	
	ds_combo3.Filter("LOEVM==''");
	gfn_insertEmptyRow( ds_combo3, G_CODE_ALL );
	cb_combo3.value = "";	
}

/********************************************************************************
* 기      능   : 조회 Callback  - 협력업체 전체추가
********************************************************************************/
function fn_after40(errCode, errMsg) {
	ds_combo3.Filter("LOEVM==''");
	gfn_insertEmptyRow( ds_combo3, G_CODE_ALL );
	cb_combo3.value = "";	
}

/********************************************************************************
* 기      능   : 조회 Callback  - 협력업체 전체추가
********************************************************************************/
function fn_after41(errCode, errMsg) {
	gfn_insertEmptyRow( ds_combo2, G_CODE_ALL );
	cb_combo2.value = "";	
}

function fn_afterCombo(sId, errCode, errDesc) {
	if(ds_combo1.rowcount > 0) cb_combo1.Index = 0;
	if(ds_combo2.rowcount > 0) cb_combo2.Index = 0;
	if(ds_combo3.rowcount > 0) cb_combo3.Index = 0;
}
/********************************************************************************
* 기      능   : 사무소콤보 변경시 설치PM 콤보값 생성
********************************************************************************/
function cb_combo1_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	cb_combo2.value = "";

	tit_clearActionInfo();
	tit_addSearchActionInfo("ps02:PS0201001A_S41");
	tit_callService(
		""
		, ""
		, "ds_cond=ds_cond"
		, "ds_combo2=ds_zzpmnum_cd"
		, "ZZACTSS="+quote(strCode)
		, "fn_after41"
		, true,true);
}
function cb_combo2_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	tit_clearActionInfo();	
	tit_addSearchActionInfo("ps02:PS0204001A_S4");
	tit_callService(
		""
		, ""
		, "ds_cond=ds_cond"
		, "ds_combo3=ds_list"
		, " ZZACTSS="+quote(strCode)
		, "fn_afterCombo"
		, true);
}

/********************************************************************************
* 기      능   : 공통코드가 조회된 후의 Callback 함수 
********************************************************************************/
function fn_completeInit(sCode, sDsObj, sCodeType) {
	cb_combo1.Index = 0;
}
/********************************************************************************
* 기      능   : form UnloadCompleted 
********************************************************************************/
function fn_OnUnloadCompleted(obj) {
	return gfn_isFormUnload(obj);
}
//=========================================================================================
// [ PART 3 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,form닫기)
//=========================================================================================
/********************************************************************************
* 기      능   : 조회 1
********************************************************************************/
function fn_query() {
	if(tab00.TabIndex!=0) tab00.TabIndex = 0;
	
	var user_grp = gfn_getUserGroup();	
	ds_cond.SetColumn(0, "AREA_CODE", '');
	
	
	//	보수협력사   
	if(user_grp=="10"){
		ds_cond.SetColumn(0, "COMBO3", G_VEND_CODE_E);
	
	//	보수PM
	} else if(user_grp=="20"){		
		ds_cond.SetColumn(0, "AREA_CODE", G_AREA_CODE_E);
		
	//	지방사무소
	} else if(user_grp=="30") {					
		ds_cond.SetColumn(0, "AREA_CODE", G_AREA_CODE_E);
		
	//	고객지원부
	} else if(user_grp=="40") {
		
	}

	// sort mark 삭제 
	gfn_clearGridSortMark(tab00.tab1.grd_list);
	ds_list.row = -1;
	ds_list.ClearData();

	tit_clearActionInfo();	
	tit_addSearchActionInfo("ps02:PS0204001A_S5");
	
	tit_callService(
        ""
        , ""
        , "ds_cond=ds_cond"
        , "ds_list=ds_list"
        , ""
        , "fn_afterQuery"
        , true);
}
/********************************************************************************
* 기      능   : 그리드 셀 더블 클릭 시 공정진행 입력/수정 조회
********************************************************************************/
function fn_query2(posid, lifnr) {
	if(tab00.TabIndex!=1) tab00.TabIndex = 1;	
	var uGroup = gfn_getUserGroup();
	
	// sort mark 삭제 
	gfn_clearGridSortMark(tab00.tab2.grd_list3);
	ds_list3.row = -1;
	ds_list3.ClearData();
	ds_list2.ClearData();

	tit_clearActionInfo();	
	tit_addSearchActionInfo("ps12:PS1205001A_S7");	
	tit_addSearchActionInfo("ps02:PS0204001A_S6");
	tit_addSearchActionInfo("ps02:PS0204001A_S7");
	
	//==================핀제거 추가==================
	tit_addSearchActionInfo("ps02:PS0204001A_S8");
	
	//===============================================
	
	var args = " POSID="+quote(posid);
	
	if(uGroup=="10"){
		args+= " LIFNR="+quote(lifnr);
	}	
	
	tit_callService(
        ""
        , ""
        , "ds_cond=ds_cond"
        , "ds_list4=ds_list4 ds_list2=ds_list2 ds_list3=ds_list3 ds_pin=ds_pin"
        , args
        , "fn_afterQuery2"
        , "" //추가
        , "" //추가
        , true);
//trace(ds_list3.SaveXML());
//alert("조회");	
	//수금전 진행여부 조회 rfc function호출
	tit_clearActionInfo();
	tit_callService(
		"COMM_ACT"
		, "getSdReturnDate"
		, ""
		, ""
		, "I_PSPID="+quote(ds_list.getColumn(0,"POSID")) + " I_GUBUN='D' I_DATE="+quote(gfn_getCurrDate())
		, "fn_afterDate"
		,true,true,true);
		
		
		
	
		
}
/********************************************************************************
* 기      능   : 조회 Callback
********************************************************************************/
function fn_afterDate(errCode, errMsg) {
	
}
/********************************************************************************
* 기      능   : 삽입 20
********************************************************************************/
function fn_insert() {
	// 그리드에 row 추가 
	// var newRow = gfn_addGridRow(grd_list, -1, "FLAG");
}
/********************************************************************************
* 기      능   : Delete 
********************************************************************************/
function fn_delete() {
	if ( ds_list.rowCount() < 1 ) {
		// 삭제할 정보 없음. 
		
		return;
	}
	
	// Grid 삭제 처리 
	// gfn_deleteGridRow( grd_list, ds_list.row, "FLAG" );
}
/********************************************************************************
* 기      능   : 저장 
********************************************************************************/
function fn_save() {
	if(ds_list3.FindRow("CHECK", "1")==-1){
		Trace("-- TODO / msg");
		return;
	}

	ufn_setSaveDataset();
	
	tit_clearActionInfo();
	tit_addSaveActionInfo(
		"ps02:PS0204001A_I1"
		, "ps02:PS0204001A_U1"
		, "ps02:PS0204001A_D1"
		, "FLAG");
	
	// 
	tit_callService(
        ""
        , ""
        , "ds_save=ds_save"
        , ""
        , ""
        , "fn_afterSave"
        , true);

}
/********************************************************************************
* 기      능   : 닫기  
********************************************************************************/
function fn_close() {	
	close();
}
/********************************************************************************
* 기      능   : 액셀  
********************************************************************************/
function fn_excel() {
	if(Tab00.TabIndex == 0) {
		gfn_saveToExcel( Tab00.tab1.grd_list, true );
	} else if(Tab00.TabIndex == 1) {
		gfn_saveToExcel( tab00.tab2.grd_list3, true );
	}
}
/********************************************************************************
* 기      능   : 접수 5
********************************************************************************/
function fn_receipt() {

}
/********************************************************************************
* 기      능   : 승인 10
********************************************************************************/
function fn_approval() {

}
/********************************************************************************
* 기      능   : d결재 15
********************************************************************************/
function fn_decide() {

}
/********************************************************************************
* 기      능   : 취소 35
********************************************************************************/
function fn_cancel() {

}
/********************************************************************************
* 기      능   : print 40
********************************************************************************/
function fn_print() {

}
/********************************************************************************
* 기      능   : 발행 50
********************************************************************************/
function fn_out() {

}
/********************************************************************************
* 기      능   : 신청 55
********************************************************************************/
function fn_request() {

}
/********************************************************************************
* 기      능   : 전송 60
********************************************************************************/
function fn_trans() {

}
/********************************************************************************
* 기      능   : 반송 65
********************************************************************************/
function fn_sendback() {

}
/********************************************************************************
* 기      능   : 계산 70
********************************************************************************/
function fn_cal() {

}
/********************************************************************************
* 기      능   : 복사 75
********************************************************************************/
function fn_copy() {

}
/********************************************************************************
* 기      능   : 확인 80
********************************************************************************/
function fn_confirm() {

}
//=========================================================================================
// [ PART 4]
// Callback 함수 정의 : callback 함수명은 메인 함수의 fn_xxxx() 에서 xxxx 부분은 fn_afterXXXX()
// 형태가 되도록 작성 
//=========================================================================================
/********************************************************************************
* 기      능   : 조회 Callback  
********************************************************************************/
function fn_afterQuery(errCode, errMsg) {
	// 메시지 처리 
	gfn_showSearchMsg(tab00.tab1.grd_list);
}

function fn_afterQuery2(errCode, errMsg) {
	// 메시지 처리 
	//gfn_showSearchMsg(tab00.tab2.grd_list3);
	//trace(ds_list4.SaveXML());
	if( F_GUBUN == '10' ){
	  for(var i=0;  i<ds_list3.GetRowCount();  i++)
	  {
	     if(ds_list4.GetColumn(i,"PHOTO1")  =='' && ds_list4.GetColumn(i,"PHOTO2")  =='X' && ds_list4.GetColumn(i,"PHOTO3")  =='X') 
	     {
	       ds_list3.SetColumn(i,"SAFE" , "A");
	     }
	   
	     else if(ds_list4.GetColumn(i,"PHOTO1")  =='' && ds_list4.GetColumn(i,"PHOTO2")  =='' && ds_list4.GetColumn(i,"PHOTO3")  =='X')
	     {
	       ds_list3.SetColumn(i,"SAFE" , "B");
	     }
	     else if(ds_list4.GetColumn(i,"PHOTO1")  =='' && ds_list4.GetColumn(i,"PHOTO2")  =='' && ds_list4.GetColumn(i,"PHOTO3")  =='' ) 
	     {
	       //alert("A");
	       ds_list3.SetColumn(i,"SAFE" , "Z");
	 
	     }
	  }
	  }
	  
	 
	fn_afterQuery3();

 // trace(ds_list3.SaveXML());
	 	 
}

/********************************************************************************
* 기      능   :  QE 검사일 , 보수인계일 값의 유무에 따른 공정율 조건 추가 --고희수sw 요청
********************************************************************************/

function fn_afterQuery3(errCode, errMsg) {

  for(var i= 0; i<ds_list3.GetRowCount(); i++)
   {
 //alert(substr(ds_list3.GetColumn(i,"POSID_1"),6,1));
     if(substr(ds_list3.GetColumn(i,"POSID_1"),6,1) =='L')
     {
  	   if(ds_list3.GetColumn(i,"SAFE") == "Z" )
	    {
	      if(ds_list3.GetColumn(i,"ZQEGEMSA") > 19990101  && ds_list3.GetColumn(i,"ZBOSUOUT") < 19990101)
	      {
	        ds_list3.SetColumn(i,"SAFE" , "Q");
	      }
	      else if(ds_list3.GetColumn(i,"ZQEGEMSA") > 19990101  && ds_list3.GetColumn(i,"ZBOSUOUT") > 19990101)
	      {
	        ds_list3.SetColumn(i,"SAFE" , "I");
	      }
         }
      }
    else if(substr(ds_list3.GetColumn(i,"POSID_1"),6,1) =='S' || substr(ds_list3.GetColumn(i,"POSID_1"),6,1) =='W')
    { 
  	  if(ds_list3.GetColumn(i,"SAFE") == "B" )
	   {
	     if(ds_list3.GetColumn(i,"ZQEGEMSA") > 19990101  && ds_list3.GetColumn(i,"ZBOSUOUT") < 19990101)
	     {
	       ds_list3.SetColumn(i,"SAFE" , "Q");
	     }
	     else if(ds_list3.GetColumn(i,"ZQEGEMSA") > 19990101  && ds_list3.GetColumn(i,"ZBOSUOUT") > 19990101)
	     {
	       ds_list3.SetColumn(i,"SAFE" , "I");
	     }
       }
    }
  }
}

/********************************************************************************
* 기      능   : 저장 Callback  
********************************************************************************/
function fn_afterSave(errCode, errMsg) {
	if ( ds_error.rowcount() > 0 ) {
		gfn_showMsg("CE00001");
	} else {
		gfn_showMsg("CI00003");
	}
}
//=========================================================================================
// [ PART 5 ]
// Detail Process Event 정의 ( User Define function )
// 사용자 정의 함수는 ufn_xxxx() 형태로 작성 
//=========================================================================================
/********************************************************************************
* 기      능   : 사용자 정의 함수  
********************************************************************************/
function ufn_userfunction() {

}
function ufn_setSaveDataset(){


//trace(ds_detail.SaveXML());
//alert("A");

	var row=0;	
	for(var i=0; i<ds_list3.getRowCount(); i++){
		if(ds_list3.getColumn(i, "CHECK")==1){		
			for(var j=0; j<ds_detail.getRowCount(); j++){
				row = ds_save.AddRow();
				ds_save.SetColumn(row, "POSID", ds_list3.GetColumn(i, "POSID"));
				ds_save.SetColumn(row, "POSID_1", ds_list3.GetColumn(i, "POSID_1"));
				ds_save.SetColumn(row, "GUBUN", ds_list3.GetColumn(i, "ZZGUBUN"));
				ds_save.SetColumn(row, "PRONR", ds_detail.GetColumn(j, "PRONR"));
				ds_save.SetColumn(row, "PROWRK", ds_detail.GetColumn(j, "PROWRK"));
				ds_save.SetColumn(row, "PRO_R", ds_detail.GetColumn(j, "PRO_R"));
				ds_save.SetColumn(row, "CRDAT", gfn_getCurrDate());

				ds_save.SetColumn(row, "VER", decode(length(trim(ds_detail.GetColumn(j, "VER"))), 0, '000', ds_detail.GetColumn(j, "VER")));
				//ds_save.SetColumn(row, "VER", decode(ds_detail.GetColumn(j, "VER"), null, '000', ds_detail.GetColumn(j, "VER")));

				if(ds_detail.GetColumn(j, "COL"+i)=="1"  && ds_detail.GetColumn(j, "B_COL"+i)=="N"){
					ds_save.SetColumn(row, "FLAG", "I");
				} else if(ds_detail.GetColumn(j, "COL"+i)=="0" && ds_detail.GetColumn(j, "B_COL"+i)=="Y") {
					ds_save.SetColumn(row, "FLAG", "D");
				} 	
			}	
		}
		
	}
	
//trace(ds_save.SaveXML());
//alert("B");	
	
//trace(ds_detail.SaveXML());
//alert("C");		
	
	
	// tab00.tab2.Grid1.CreateFormat();	
}
//=========================================================================================
// [ PART 6 ]
// component Event 정의 : 각 Component 별 이벤트 
//=========================================================================================
/********************************************************************************
* 기      능   : 그리드 헤더 클릭시 정렬 처리 
********************************************************************************/
function grd_list_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
{
	if ( nCell == 0 ) {
		// 그리드 표시할 컬럼 선택 
		// gfn_selectGridCol(obj);
	} else {
		// 그리드 정렬 처리 
		gfn_sortGrid(obj,nCell);
	}
}
function Tab00_tab2_grd_list3_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
{
	if ( nCell == 0 ) {
		//gfn_selectAllGrid(obj,nCell,nCell,true);
		// 현재 처리할 format 기억
		//gfn_selectGridCol("grd_list");
	} else {
		gfn_sortGrid(obj,nCell);
	}
}
/********************************************************************************
* 기      능   : 데이터셋 값 변경 시 - Flag 처리 
********************************************************************************/
function ds_list_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{
	gfn_changeFlag( obj, strColumnID, nRow, "FLAG" );
}

/********************************************************************************
* 기      능   : 그리드 셀 클릭 시 이벤트
********************************************************************************/
function grd_list_OnCellClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
	//	상세 버튼 클릭 시
	if(nCell==8){
		var arg = "F_UPN=" + quote(ds_list.GetColumn(nRow,"CS141_UPN"))
			+ " F_CST=" + quote(ds_list.GetColumn(nRow,"CS141_CST"))
			+ " F_NAM=" + quote(ds_list.GetColumn(nRow,"UPN_NAME"))
			+ " F_SPT=" + quote(ds_list.GetColumn(nRow,"SPT_NAME"))
			+ " F_PFORM=CS1302";
		
		gfn_openPopup("CS1301001B", true, arg);
	}
}

/********************************************************************************
* 기      능   : 그리드 셀 더블 클릭 시 이벤트
********************************************************************************/
function Tab00_tab1_grd_list_OnCellDblClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
	tab00.TabIndex = 1;
	ds_list3.DeleteAll();
	ds_detail.DeleteAll();
	ds_save.DeleteAll();
	
	F_POSID = ds_list.GetColumn(nRow, "POSID");
	F_LIFNR = ds_list.GetColumn(nRow, "LIFNR");
	F_GUBUN = ds_list.GetColumn(nRow, "ZZGUBUN");
	F_ZSPEC = ds_list.GetColumn(nRow, "ZSPEC");
	
	fn_query2(F_POSID, F_LIFNR);
	//alert(F_ZSPEC);
	//alert(F_GUBUN);
}

/********************************************************************************
* 기      능   : 통합프로젝트 검색 팝업
********************************************************************************/
function btn_popProj_OnClick(obj)
{
	var arg = "pjt="+quote(ed_pjt.Text);
	gfn_openPopup("CS9601002A", true, arg);
}
/********************************************************************************
* 기      능   : 공정진행 입력 팝업
********************************************************************************/
function Tab00_tab2_btn_workProc_OnClick(obj)
{	
	var args = ' F_POSID='+quote(ds_list3.getColumn(ds_list3.row, "POSID"));
		args +=' F_GUBUN='+quote(ds_list3.getColumn(ds_list3.row, "ZZGUBUN"));
		args +=' F_ZSPEC='+quote(ds_list3.getColumn(ds_list3.row, "ZSPEC"));		
		
		args +=' E_FLAG='+quote(E_FLAG);
//trace(ds_list3.SaveXML());
//alert("팝업");		
	gfn_openPopup("PS0204001C", true, args);
}
/********************************************************************************
* 기      능   : 공정진행 입력 팝업
********************************************************************************/
function ds_detail_OnLoadCompleted(obj,nErrorCode,strErrorMsg,nReason)
{
	// tab00.tab2.Grid0.CreateFormat();
	if(nReason!=2){
		return;
	}
	
	var bCols = "";
	for(var o=0; o<ds_detail.GetColCount(); o++){
		if(left(ds_detail.GetColID(o), 2)=="B_"){
			bCols += ds_detail.GetColID(o)+";";
		}
	}
	var arrCols = split(bCols, ";");
	
	for(var l=0; l<ds_list3.getRowCount(); l++){
		
		if(ds_detail.FindRow("COL"+l, "1")!=-1){
			ds_List3.SetColumn(l,"CHECK",1);
		} else {
			ds_List3.SetColumn(l,"CHECK",0);
		}		
	}	
	
//trace(ds_detail.SaveXML());
//alert("ds_detail.SaveXML");
//alert(arrCols);
//alert("length(arrCols) = " + length(arrCols));
	for(var d=0; d<ds_detail.GetRowCount(); d++){
		for(var p=0; p<length(arrCols); p++){

//alert(arrCols[p]);		
			if(ds_detail.GetColumn(d, arrCols[p])=="Y" 
				&& ds_detail.GetColumn(d, substr(arrCols[p], 2))==0){
			
				ds_List3.SetColumn(substr(arrCols[p], 5),"CHECK",1);	
			}
		}		
	}	
}
/********************************************************************************
* 기      능   : 사업부 선택시 ds_lifnr 데이터셋 값 filtering
********************************************************************************/
function chk_so2_OnClick(obj,strValue)
{
	var so2 = "";
	var so3 = "";
	var so4 = "";
	var so5 = "";
	var so6 = "";
	
	if(chk_so2.Value == '1') so2 = "설치협력업체";
	if(chk_so3.Value == '1') so3 = "설치양중업체";
	if(chk_so4.Value == '1') so4 = "설치협력보수업체";
	if(chk_so5.Value == '1') so5 = "설치외주업체";
	if(chk_so6.Value == '1') so6 = "설치업체협력(폐업)";

	if(chk_so2.Value+chk_so3.Value+chk_so4.Value+chk_so5.Value+chk_so6.Value == "00000")
	{
		ds_combo3.Filter("LOEVM=='' || CODE==''");
	}	
	else
		ds_combo3.Filter("CODE='' || SORTL="+quote(so2) +" || SORTL="+quote(so3) +" || SORTL="+quote(so4) +" || SORTL="+quote(so5) +" || SORTL="+quote(so6));
	
	cb_combo3.Index = 0;	
}


/********************************************************************************
* 기      능   : 핀제거확인서 버튼 클릭시
********************************************************************************/
function Tab00_tab2_btn_pin_OnClick(obj)
{
	var arg = "POSID=" + quote(ds_list.GetColumn(ds_list.currow, "POSID")) ; //+ 
              //" LIFNR=" + quote(ds_pin.GetColumn(0, "LIFNR")) ;
	gfn_openPopup("PS0407002B", true, arg);
	fn_pin();
}


/********************************************************************************
* 기      능   : 조회(핀정보)
********************************************************************************/
function fn_pin() 
{
	tit_clearActionInfo();
	tit_addSearchActionInfo("ps02:PS0204001A_S8");	
	
	var args = " POSID="+quote(posid);
	tit_callService(
        ""
        , ""
        , "ds_cond=ds_cond2"
        , "ds_pin=ds_pin"
        , args
        , ""
        , ""
        , ""
        , true);
                    
        
}

/********************************************************************************
* 기      능   : 핀제거 상태 업데이트
********************************************************************************/
function Tab00_tab2_btn_pin_save_OnClick(obj)
{
	tit_clearActionInfo();
	tit_addSingleActionInfo("ps02:PS0204001A_U2"); //핀제거 완료/미완료 여부
	tit_callService(
		""
		, ""
		, "ds_pin=ds_pin"
		, ""
		, ""
		, "fn_afterSave1"
		, ""
		, ""
		, true);		
	
}


/********************************************************************************
* 기      능   : 핀제거 저장 Callback  
********************************************************************************/
function fn_afterSave1(errCode, errMsg) {
	if ( ds_error.rowcount() > 0 ) {
		gfn_showMsg("CE00001");
	} else {
		gfn_showMsg("CI00003");
	}
}

]]></Script>
</Window>