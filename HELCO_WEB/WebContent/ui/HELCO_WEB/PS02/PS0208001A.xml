<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Face3dColor="user5" Height="576" Id="PS0207001A" Left="8" OnLoadCompleted="fn_OnLoadCompleted" OnUnloadCompleted="fn_OnUnloadCompleted" PidAttrib="7" ShadowColor="user5" Title="협력사&#32;일일&#32;작업내역(2019)" Top="8" Ver="1.0" Width="978" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_cond" OnColumnChanged="ds_cond_OnColumnChanged">
				<Contents>
					<colinfo id="PSPID" size="255" summ="default" type="STRING"/>
					<colinfo id="ZZLIFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZLIFNR_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="SO2" size="256" summ="default" type="STRING"/>
					<colinfo id="SO3" size="256" summ="default" type="STRING"/>
					<colinfo id="SO4" size="256" summ="default" type="STRING"/>
					<colinfo id="SO5" size="256" summ="default" type="STRING"/>
					<colinfo id="INP_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZACTSS" size="256" summ="default" type="STRING"/>
					<colinfo id="SO6" size="256" summ="default" type="STRING"/>
					<colinfo id="CURR_DATE" size="256" summ="default" type="STRING"/>
					<colinfo id="G_USER_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="TMCD" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
					<colinfo id="GUBUN" size="256" summ="default" type="STRING"/>
					<colinfo id="PRONR" size="256" summ="default" type="STRING"/>
					<colinfo id="DATE_CHK" size="256" summ="default" type="STRING"/>
					<record>
						<CHK></CHK>
						<CURR_DATE></CURR_DATE>
						<DATE_CHK></DATE_CHK>
						<G_USER_ID></G_USER_ID>
						<GUBUN></GUBUN>
						<INP_DT></INP_DT>
						<POSID></POSID>
						<PRONR></PRONR>
						<PSPID></PSPID>
						<SO2></SO2>
						<SO3></SO3>
						<SO4></SO4>
						<SO5></SO5>
						<SO6></SO6>
						<TMCD></TMCD>
						<ZZACTSS></ZZACTSS>
						<ZZLIFNR></ZZLIFNR>
						<ZZLIFNR_NM></ZZLIFNR_NM>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_head">
				<Contents>
					<colinfo id="LIFNR" size="20" type="STRING"/>
					<colinfo id="INDIRECT" size="24" type="STRING"/>
					<colinfo id="DIRECT_EL" size="24" type="STRING"/>
					<colinfo id="DIRECT_ES" size="24" type="STRING"/>
					<colinfo id="TUIP" size="24" type="STRING"/>
					<colinfo id="MI_TUIP" size="90" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list1" OnColumnChanged="ds_list1_OnColumnChanged">
				<Contents>
					<colinfo id="PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="INP_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSPEC1" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSPEC2" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZCOMP2" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZSHIP1" size="256" summ="default" type="STRING"/>
					<colinfo id="M_MH" size="256" summ="default" type="STRING"/>
					<colinfo id="A_MH" size="256" summ="default" type="STRING"/>
					<colinfo id="N_MH" size="256" summ="default" type="STRING"/>
					<colinfo id="M" size="256" summ="default" type="STRING"/>
					<colinfo id="A" size="256" summ="default" type="STRING"/>
					<colinfo id="N" size="256" summ="default" type="STRING"/>
					<colinfo id="BIGO" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSITE_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="TYPE" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZGUBUN" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="OUTS" size="256" summ="default" type="STRING"/>
					<colinfo id="PERNO" size="256" summ="default" type="STRING"/>
					<colinfo id="BEFORE_R" size="256" summ="default" type="STRING"/>
					<colinfo id="DAY_R" size="256" summ="default" type="STRING"/>
					<colinfo id="PROC" size="256" summ="default" type="STRING"/>
					<colinfo id="SAFE" size="256" summ="default" type="STRING"/>
					<colinfo id="MH" size="256" summ="default" type="STRING"/>
					<colinfo id="INIT_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="PRO_B" size="256" summ="default" type="STRING"/>
					<colinfo id="HOGI" size="256" summ="default" type="STRING"/>
					<colinfo id="INWON_CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="OM" size="256" summ="default" type="STRING"/>
					<colinfo id="ON" size="256" summ="default" type="STRING"/>
					<colinfo id="OA" size="256" summ="default" type="STRING"/>
					<colinfo id="OM_MH" size="256" summ="default" type="STRING"/>
					<colinfo id="OA_MH" size="256" summ="default" type="STRING"/>
					<colinfo id="ON_MH" size="256" summ="default" type="STRING"/>
					<colinfo id="OUT" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID_DONG" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK2" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_zzlifnr">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<colinfo id="SORTL" size="256" summ="default" type="STRING"/>
					<colinfo id="LOEVM" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="PCNT" size="256" summ="default" type="STRING"/>
					<colinfo id="DATE_CHK" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list" OnColumnChanged="ds_list_OnColumnChanged">
				<Contents>
					<colinfo id="LIFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="PERNO" size="256" summ="default" type="STRING"/>
					<colinfo id="INP_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="TMCD" size="256" summ="default" type="STRING"/>
					<colinfo id="M_MH" size="256" summ="default" type="STRING"/>
					<colinfo id="A_MH" size="256" summ="default" type="STRING"/>
					<colinfo id="N_MH" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="TUIP_CHKA" size="256" summ="default" type="STRING"/>
					<colinfo id="SAYU" size="256" summ="default" type="STRING"/>
					<colinfo id="BIGO" size="256" summ="default" type="STRING"/>
					<colinfo id="GUBUN" size="256" summ="default" type="STRING"/>
					<colinfo id="NAMEE" size="256" summ="default" type="STRING"/>
					<colinfo id="TUIP_CHKB" size="256" summ="default" type="STRING"/>
					<colinfo id="POSIT" size="256" summ="default" type="STRING"/>
					<colinfo id="TUIP_CHKC" size="256" summ="default" type="STRING"/>
					<colinfo id="DAEGI" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="CHKS" size="256" summ="default" type="STRING"/>
					<colinfo id="TUIP" size="256" summ="default" type="STRING"/>
					<colinfo id="ACT" size="256" summ="default" type="STRING"/>
					<colinfo id="INTO" size="256" summ="default" type="STRING"/>
					<colinfo id="STORED_TUIP_CHKA" size="256" summ="default" type="STRING"/>
					<colinfo id="STORED_TUIP_CHKB" size="256" summ="default" type="STRING"/>
					<colinfo id="OLD_SAYU" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_pmcd">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="RETIF" size="256" summ="default" type="STRING"/>
					<colinfo id="PCNT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_zzactss">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_time">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE>0</CODE>
						<CODE_NAME></CODE_NAME>
					</record>
					<record>
						<CODE>1</CODE>
						<CODE_NAME>1</CODE_NAME>
					</record>
					<record>
						<CODE>2</CODE>
						<CODE_NAME>2</CODE_NAME>
					</record>
					<record>
						<CODE>3</CODE>
						<CODE_NAME>3</CODE_NAME>
					</record>
					<record>
						<CODE>4</CODE>
						<CODE_NAME>4</CODE_NAME>
					</record>
					<record>
						<CODE>5</CODE>
						<CODE_NAME>5</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_time2">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE>0</CODE>
						<CODE_NAME></CODE_NAME>
					</record>
					<record>
						<CODE>1</CODE>
						<CODE_NAME>1</CODE_NAME>
					</record>
					<record>
						<CODE>2</CODE>
						<CODE_NAME>2</CODE_NAME>
					</record>
					<record>
						<CODE>3</CODE>
						<CODE_NAME>3</CODE_NAME>
					</record>
					<record>
						<CODE>4</CODE>
						<CODE_NAME>4</CODE_NAME>
					</record>
					<record>
						<CODE>5</CODE>
						<CODE_NAME>5</CODE_NAME>
					</record>
					<record>
						<CODE>6</CODE>
						<CODE_NAME>6</CODE_NAME>
					</record>
					<record>
						<CODE>7</CODE>
						<CODE_NAME>7</CODE_NAME>
					</record>
					<record>
						<CODE>8</CODE>
						<CODE_NAME>8</CODE_NAME>
					</record>
					<record>
						<CODE>9</CODE>
						<CODE_NAME>9</CODE_NAME>
					</record>
					<record>
						<CODE>10</CODE>
						<CODE_NAME>10</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_sayu">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_N" size="256" summ="default" type="STRING"/>
					<colinfo id="DEL" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_tmcd">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NM" size="256" type="STRING"/>
					<colinfo id="LIFNR" size="256" type="STRING"/>
					<colinfo id="DELEF" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_chk">
				<Contents>
					<colinfo id="CNT" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond2">
				<Contents>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
					<colinfo id="INP_DT" size="256" summ="default" type="STRING"/>
					<record>
						<INP_DT></INP_DT>
						<POSID></POSID>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list2">
				<Contents>
					<colinfo id="PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="INP_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSPEC1" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSPEC2" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZCOMP2" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZSHIP1" size="256" summ="default" type="STRING"/>
					<colinfo id="M_MH" size="256" summ="default" type="STRING"/>
					<colinfo id="A_MH" size="256" summ="default" type="STRING"/>
					<colinfo id="N_MH" size="256" summ="default" type="STRING"/>
					<colinfo id="M" size="256" summ="default" type="STRING"/>
					<colinfo id="A" size="256" summ="default" type="STRING"/>
					<colinfo id="N" size="256" summ="default" type="STRING"/>
					<colinfo id="BIGO" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSITE_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="PROC" size="256" summ="default" type="STRING"/>
					<colinfo id="SAFE" size="256" summ="default" type="STRING"/>
					<colinfo id="MH" size="256" summ="default" type="STRING"/>
					<colinfo id="INIT_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="PRO_B" size="256" summ="default" type="STRING"/>
					<colinfo id="HOGI" size="256" summ="default" type="STRING"/>
					<colinfo id="INWON_CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="OM" size="256" summ="default" type="STRING"/>
					<colinfo id="ON" size="256" summ="default" type="STRING"/>
					<colinfo id="OA" size="256" summ="default" type="STRING"/>
					<colinfo id="OM_MH" size="256" summ="default" type="STRING"/>
					<colinfo id="OA_MH" size="256" summ="default" type="STRING"/>
					<colinfo id="ON_MH" size="256" summ="default" type="STRING"/>
					<colinfo id="OUT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list1_tmp">
				<Contents>
					<colinfo id="PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="INP_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSPEC1" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSPEC2" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZCOMP2" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZSHIP1" size="256" summ="default" type="STRING"/>
					<colinfo id="M_MH" size="256" summ="default" type="STRING"/>
					<colinfo id="A_MH" size="256" summ="default" type="STRING"/>
					<colinfo id="N_MH" size="256" summ="default" type="STRING"/>
					<colinfo id="M" size="256" summ="default" type="STRING"/>
					<colinfo id="A" size="256" summ="default" type="STRING"/>
					<colinfo id="N" size="256" summ="default" type="STRING"/>
					<colinfo id="BIGO" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSITE_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="OUTS" size="256" summ="default" type="STRING"/>
					<colinfo id="PERNO" size="256" summ="default" type="STRING"/>
					<colinfo id="BEFORE_R" size="256" summ="default" type="STRING"/>
					<colinfo id="DAY_R" size="256" summ="default" type="STRING"/>
					<colinfo id="PROC" size="256" summ="default" type="STRING"/>
					<colinfo id="SAFE" size="256" summ="default" type="STRING"/>
					<colinfo id="MH" size="256" summ="default" type="STRING"/>
					<colinfo id="HOGI" size="256" summ="default" type="STRING"/>
					<colinfo id="OM" size="256" summ="default" type="STRING"/>
					<colinfo id="ON" size="256" summ="default" type="STRING"/>
					<colinfo id="OA" size="256" summ="default" type="STRING"/>
					<colinfo id="OM_MH" size="256" summ="default" type="STRING"/>
					<colinfo id="OA_MH" size="256" summ="default" type="STRING"/>
					<colinfo id="ON_MH" size="256" summ="default" type="STRING"/>
					<colinfo id="OUT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_sum" OnColumnChanged="ds_sum_OnColumnChanged">
				<Contents>
					<colinfo id="M_MH" size="256" summ="default" type="STRING"/>
					<colinfo id="A_MH" size="256" summ="default" type="STRING"/>
					<colinfo id="N_MH" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_detail"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_save">
				<Contents>
					<colinfo id="FLAG" size="256" type="STRING"/>
					<colinfo id="POSID" size="256" type="STRING"/>
					<colinfo id="POSID_1" size="256" type="STRING"/>
					<colinfo id="GUBUN" size="256" type="STRING"/>
					<colinfo id="PRONR" size="256" type="STRING"/>
					<colinfo id="PROWRK" size="256" type="STRING"/>
					<colinfo id="PRO_R" size="256" type="STRING"/>
					<colinfo id="CRDAT" size="256" type="STRING"/>
					<colinfo id="VER" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list_tmp">
				<Contents>
					<colinfo id="LIFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="PERNO" size="256" summ="default" type="STRING"/>
					<colinfo id="INP_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="TMCD" size="256" summ="default" type="STRING"/>
					<colinfo id="M_MH" size="256" summ="default" type="STRING"/>
					<colinfo id="A_MH" size="256" summ="default" type="STRING"/>
					<colinfo id="N_MH" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="TUIP_CHKA" size="256" summ="default" type="STRING"/>
					<colinfo id="SAYU" size="256" summ="default" type="STRING"/>
					<colinfo id="BIGO" size="256" summ="default" type="STRING"/>
					<colinfo id="GUBUN" size="256" summ="default" type="STRING"/>
					<colinfo id="NAMEE" size="256" summ="default" type="STRING"/>
					<colinfo id="TUIP_CHKB" size="256" summ="default" type="STRING"/>
					<colinfo id="POSIT" size="256" summ="default" type="STRING"/>
					<colinfo id="TUIP_CHKC" size="256" summ="default" type="STRING"/>
					<colinfo id="DAEGI" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="TUIP" size="256" summ="default" type="STRING"/>
					<colinfo id="CHKS" size="256" summ="default" type="STRING"/>
					<colinfo id="ACT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_out">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_N" size="256" summ="default" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_N></CODE_N>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list3">
				<Contents>
					<colinfo id="PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="INP_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSPEC1" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSPEC2" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZCOMP2" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZSHIP1" size="256" summ="default" type="STRING"/>
					<colinfo id="M_MH" size="256" summ="default" type="STRING"/>
					<colinfo id="A_MH" size="256" summ="default" type="STRING"/>
					<colinfo id="N_MH" size="256" summ="default" type="STRING"/>
					<colinfo id="M" size="256" summ="default" type="STRING"/>
					<colinfo id="A" size="256" summ="default" type="STRING"/>
					<colinfo id="N" size="256" summ="default" type="STRING"/>
					<colinfo id="BIGO" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSITE_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="TYPE" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZGUBUN" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="OUTS" size="256" summ="default" type="STRING"/>
					<colinfo id="NAMEE" size="256" summ="default" type="STRING"/>
					<colinfo id="SAFE" size="256" summ="default" type="STRING"/>
					<colinfo id="MH" size="256" summ="default" type="STRING"/>
					<colinfo id="PRO_B" size="256" summ="default" type="STRING"/>
					<colinfo id="OM" size="256" summ="default" type="STRING"/>
					<colinfo id="ON" size="256" summ="default" type="STRING"/>
					<colinfo id="OA" size="256" summ="default" type="STRING"/>
					<colinfo id="OM_MH" size="256" summ="default" type="STRING"/>
					<colinfo id="OA_MH" size="256" summ="default" type="STRING"/>
					<colinfo id="ON_MH" size="256" summ="default" type="STRING"/>
					<colinfo id="OUT" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID_DONG" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK2" size="256" summ="default" type="STRING"/>
					<colinfo id="VER" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list_tmp2">
				<Contents>
					<colinfo id="LIFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="PERNO" size="256" summ="default" type="STRING"/>
					<colinfo id="INP_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="TMCD" size="256" summ="default" type="STRING"/>
					<colinfo id="M_MH" size="256" summ="default" type="STRING"/>
					<colinfo id="A_MH" size="256" summ="default" type="STRING"/>
					<colinfo id="N_MH" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="TUIP_CHKA" size="256" summ="default" type="STRING"/>
					<colinfo id="SAYU" size="256" summ="default" type="STRING"/>
					<colinfo id="BIGO" size="256" summ="default" type="STRING"/>
					<colinfo id="GUBUN" size="256" summ="default" type="STRING"/>
					<colinfo id="NAMEE" size="256" summ="default" type="STRING"/>
					<colinfo id="TUIP_CHKB" size="256" summ="default" type="STRING"/>
					<colinfo id="POSIT" size="256" summ="default" type="STRING"/>
					<colinfo id="TUIP_CHKC" size="256" summ="default" type="STRING"/>
					<colinfo id="DAEGI" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="CHKS" size="256" summ="default" type="STRING"/>
					<colinfo id="TUIP" size="256" summ="default" type="STRING"/>
					<colinfo id="ACT" size="256" summ="default" type="STRING"/>
					<colinfo id="VER" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list_tmp3">
				<Contents>
					<colinfo id="LIFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="PERNO" size="256" summ="default" type="STRING"/>
					<colinfo id="INP_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="TMCD" size="256" summ="default" type="STRING"/>
					<colinfo id="M_MH" size="256" summ="default" type="STRING"/>
					<colinfo id="A_MH" size="256" summ="default" type="STRING"/>
					<colinfo id="N_MH" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="TUIP_CHKA" size="256" summ="default" type="STRING"/>
					<colinfo id="SAYU" size="256" summ="default" type="STRING"/>
					<colinfo id="BIGO" size="256" summ="default" type="STRING"/>
					<colinfo id="GUBUN" size="256" summ="default" type="STRING"/>
					<colinfo id="NAMEE" size="256" summ="default" type="STRING"/>
					<colinfo id="TUIP_CHKB" size="256" summ="default" type="STRING"/>
					<colinfo id="POSIT" size="256" summ="default" type="STRING"/>
					<colinfo id="TUIP_CHKC" size="256" summ="default" type="STRING"/>
					<colinfo id="DAEGI" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="CHKS" size="256" summ="default" type="STRING"/>
					<colinfo id="TUIP" size="256" summ="default" type="STRING"/>
					<colinfo id="ACT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list_tmp4">
				<Contents>
					<colinfo id="LIFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="PERNO" size="256" summ="default" type="STRING"/>
					<colinfo id="INP_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="TMCD" size="256" summ="default" type="STRING"/>
					<colinfo id="M_MH" size="256" summ="default" type="STRING"/>
					<colinfo id="A_MH" size="256" summ="default" type="STRING"/>
					<colinfo id="N_MH" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="TUIP_CHKA" size="256" summ="default" type="STRING"/>
					<colinfo id="SAYU" size="256" summ="default" type="STRING"/>
					<colinfo id="BIGO" size="256" summ="default" type="STRING"/>
					<colinfo id="GUBUN" size="256" summ="default" type="STRING"/>
					<colinfo id="NAMEE" size="256" summ="default" type="STRING"/>
					<colinfo id="TUIP_CHKB" size="256" summ="default" type="STRING"/>
					<colinfo id="POSIT" size="256" summ="default" type="STRING"/>
					<colinfo id="TUIP_CHKC" size="256" summ="default" type="STRING"/>
					<colinfo id="DAEGI" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="CHKS" size="256" summ="default" type="STRING"/>
					<colinfo id="TUIP" size="256" summ="default" type="STRING"/>
					<colinfo id="ACT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_detail2"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_detail3"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_del">
				<Contents>
					<colinfo id="INP_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="PERNO" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_del2">
				<Contents>
					<colinfo id="INP_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list1_tmp2">
				<Contents>
					<colinfo id="PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="INP_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSPEC1" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSPEC2" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZCOMP2" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZSHIP1" size="256" summ="default" type="STRING"/>
					<colinfo id="M_MH" size="256" summ="default" type="STRING"/>
					<colinfo id="A_MH" size="256" summ="default" type="STRING"/>
					<colinfo id="N_MH" size="256" summ="default" type="STRING"/>
					<colinfo id="M" size="256" summ="default" type="STRING"/>
					<colinfo id="A" size="256" summ="default" type="STRING"/>
					<colinfo id="N" size="256" summ="default" type="STRING"/>
					<colinfo id="BIGO" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSITE_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="OUTS" size="256" summ="default" type="STRING"/>
					<colinfo id="PERNO" size="256" summ="default" type="STRING"/>
					<colinfo id="BEFORE_R" size="256" summ="default" type="STRING"/>
					<colinfo id="DAY_R" size="256" summ="default" type="STRING"/>
					<colinfo id="PROC" size="256" summ="default" type="STRING"/>
					<colinfo id="SAFE" size="256" summ="default" type="STRING"/>
					<colinfo id="MH" size="256" summ="default" type="STRING"/>
					<colinfo id="HOGI" size="256" summ="default" type="STRING"/>
					<colinfo id="OM" size="256" summ="default" type="STRING"/>
					<colinfo id="ON" size="256" summ="default" type="STRING"/>
					<colinfo id="OA" size="256" summ="default" type="STRING"/>
					<colinfo id="OM_MH" size="256" summ="default" type="STRING"/>
					<colinfo id="OA_MH" size="256" summ="default" type="STRING"/>
					<colinfo id="ON_MH" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cnt">
				<Contents>
					<colinfo id="CNT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list_p">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE2" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE3" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE2_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE3_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="ITEM" size="256" summ="default" type="STRING"/>
					<colinfo id="ITEM_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="INP_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list_tmp5">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE2" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE3" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE2_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE3_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="ITEM" size="256" summ="default" type="STRING"/>
					<colinfo id="ITEM_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="INP_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_resign">
				<Contents>
					<colinfo id="LIFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="PERNO" size="256" summ="default" type="STRING"/>
					<colinfo id="RSN1" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond1">
				<Contents>
					<colinfo id="PSPID" size="255" summ="default" type="STRING"/>
					<colinfo id="INP_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
					<colinfo id="GUBUN" size="256" summ="default" type="STRING"/>
					<colinfo id="PRONR" size="256" summ="default" type="STRING"/>
					<colinfo id="COM_CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="FPATH" size="256" summ="default" type="STRING"/>
					<colinfo id="ORGFNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="FNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="FSIZE" size="256" summ="default" type="INT"/>
					<colinfo id="FDATR" size="256" summ="default" type="STRING"/>
					<colinfo id="TYPE" size="256" summ="default" type="STRING"/>
					<colinfo id="VER" size="256" summ="default" type="STRING"/>
					<colinfo id="VER" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="GNO" size="256" summ="default" type="STRING"/>
					<colinfo id="GNO_STEP" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond3">
				<Contents>
					<colinfo id="PSPID" size="255" summ="default" type="STRING"/>
					<colinfo id="INP_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
					<colinfo id="GUBUN" size="256" summ="default" type="STRING"/>
					<colinfo id="PRONR" size="256" summ="default" type="STRING"/>
					<colinfo id="COM_CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="FPATH" size="256" summ="default" type="STRING"/>
					<colinfo id="ORGFNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="FNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="FSIZE" size="999" summ="default" type="INT"/>
					<colinfo id="FDATR" size="256" summ="default" type="STRING"/>
					<colinfo id="TYPE" size="256" summ="default" type="STRING"/>
					<colinfo id="VER" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_comChk"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_initComChk"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_detail_n"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_detail3_n"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_lifnr_grid">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<colinfo id="DATE_CHK" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_condLifnr">
				<Contents>
					<colinfo id="LIFNR" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
		</Datasets>
		<Shape BKColor="user0" Bottom="32" Height="32" Id="Shape0" Left="0" LineColor="user1" Right="978" TabOrder="1" Top="0" Type="Rectangle" Width="978"></Shape>
		<Shape BKColor="user12" Bottom="64" Height="26" Id="Shape9" Left="9" LineColor="user13" Right="967" TabOrder="2" Top="38" Type="Rectangle" Width="958"></Shape>
		<Static Align="Right" Height="24" Id="Static1" Left="10" Style="sty_lb_form_basic" TabOrder="3" Text="간접인원&#32;" Top="39" VAlign="Middle" Width="98"></Static>
		<Static Align="Right" Height="24" Id="Static2" Left="185" Style="sty_lb_form_basic" TabOrder="4" Text="직접인원(E/L)&#32;" Top="39" VAlign="Middle" Width="98"></Static>
		<Static Align="Right" Height="24" Id="Static3" Left="363" Style="sty_lb_form_basic" TabOrder="5" Text="직접인원(E/S)&#32;" Top="39" VAlign="Middle" Width="98"></Static>
		<Edit Align="RIGHT" BindDataset="ds_head" Border="Flat" Column="DIRECT_ES" Height="20" Id="ed_DIRECT_ES" Left="463" LeftMargin="4" Readonly="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="6" Top="41" Width="66"></Edit>
		<Edit Align="RIGHT" BindDataset="ds_head" Border="Flat" Column="DIRECT_EL" Height="20" Id="ed_DIRECT_EL" Left="285" LeftMargin="4" Readonly="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="7" Top="41" Width="66"></Edit>
		<Edit Align="RIGHT" BindDataset="ds_head" Border="Flat" Column="INDIRECT" Height="20" Id="ed_INDIRECT" Left="110" LeftMargin="4" Readonly="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="8" Top="41" Width="66"></Edit>
		<Static Align="Right" Height="20" Id="st_lifnr" Left="216" Style="sty_lb_search" TabOrder="9" Text="설치협력사&#32;" Top="5" VAlign="Middle" Width="92"></Static>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="CODE" Column="ZZLIFNR" DataColumn="CODE_NAME" Height="20" Id="cb_zzlifnr" InnerDataset="ds_zzlifnr" Left="1014" Style="sty_ipt_search" TabOrder="10" Top="44" Visible="FALSE" Width="169"></Combo>
		<Static Align="Right" Height="20" Id="st_inpday" Left="488" Style="sty_lb_search" TabOrder="11" Text="투입일자&#32;" Top="5" VAlign="Middle" Width="92"></Static>
		<Calendar BindDataset="ds_cond" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="INP_DT" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cb_inpday" Left="582" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" OnChanged="cb_inpday_OnChanged" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_search" SundayTextColor="user35" TabOrder="12" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="5" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="94"></Calendar>
		<Static Align="Right" Height="20" Id="st_tmcd" Left="680" Style="sty_lb_search" TabOrder="13" Text="설치팀장&#32;" Top="5" VAlign="Middle" Width="92"></Static>
		<Static Align="Right" Height="24" Id="Static4" Left="539" Style="sty_lb_form_basic" TabOrder="14" Text="투입인원&#32;" Top="39" VAlign="Middle" Width="98"></Static>
		<Edit Align="RIGHT" BindDataset="ds_head" Border="Flat" Column="TUIP" Height="20" Id="ed_TUIP" Left="639" LeftMargin="4" Readonly="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="15" Top="41" Width="66"></Edit>
		<Static Align="Right" Height="24" Id="Static5" Left="715" Style="sty_lb_form_basic" TabOrder="16" Text="미투입인원&#32;" Top="39" VAlign="Middle" Width="98"></Static>
		<Edit Align="RIGHT" BindDataset="ds_head" Border="Flat" Column="MI_TUIP" Height="20" Id="ed_MI_TUIP" Left="815" LeftMargin="4" Readonly="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="17" Top="41" Width="66"></Edit>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="CODE" Column="TMCD" DataColumn="CODE_NM" Height="20" Id="cb_tmcd" InnerDataset="ds_tmcd" Left="774" Style="sty_ipt_search" TabOrder="18" Top="4" Width="106"></Combo>
		<Static Align="Right" Height="20" Id="st_zzactss" Left="7" Style="sty_lb_search" TabOrder="19" Text="사무소&#32;" Top="5" VAlign="Middle" Width="80"></Static>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="CODE" Column="ZZACTSS" DataColumn="CODE_NAME" Height="20" Id="cb_zzactss" InnerDataset="ds_zzactss" Left="91" OnChanged="cb_zzactss_OnChanged" Style="sty_ipt_search" TabOrder="20" Top="5" Width="116"></Combo>
		<Grid AreaSelect="TRUE" AutoEnter="TRUE" AutoFitEndLine="Hide" AutoSelect="TRUE" BindDataset="ds_list" BkColor2="default" BoldHead="true" Border="Flat" Bottom="256" CellMoving="TRUE" ColSelect="TRUE" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="184" Id="grd_list" InputPanel="FALSE" Left="8" LineColor="user20" LineType="ExHORZ" OnCellClick="grd_list_OnCellClick" OnHeadClick="Tab00_tab1_grd_list1_OnHeadClick" Right="976" RowHeight="20" Style="sty_grid" TabOrder="21" TabStop="true" Top="72" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="968">
			<contents>
				<format id="Default">
					<columns>
						<col fix="left" width="36"/>
						<col fix="left" width="33"/>
						<col fix="left" width="60"/>
						<col fix="left" width="60"/>
						<col fix="left" width="80"/>
						<col fix="left" width="0"/>
						<col fix="left" width="0"/>
						<col width="70"/>
						<col width="70"/>
						<col width="65"/>
						<col width="65"/>
						<col width="65"/>
						<col width="120"/>
						<col width="220"/>
					</columns>
					<head>
						<cell col="0" display="text"/>
						<cell align="center" col="1" color="user21" display="text" font="굴림,9" text="삭제&#32;"/>
						<cell col="2" color="user21" display="text" font="굴림,9" text="구분"/>
						<cell col="3" color="user21" display="text" font="굴림,9" text="직급"/>
						<cell col="4" color="user21" display="text" font="굴림,9" text="이름"/>
						<cell col="5" display="text"/>
						<cell col="6" display="text"/>
						<cell col="7" color="user21" display="text" font="굴림,9" text="투입"/>
						<cell col="8" color="user21" display="text" font="굴림,9" text="미투입"/>
						<cell col="9" color="user21" display="text" font="굴림,9" text="AM"/>
						<cell col="10" color="user21" display="text" font="굴림,9" text="PM"/>
						<cell col="11" color="user21" display="text" font="굴림,9" text="야간"/>
						<cell align="center" col="12" color="user21" display="text" font="굴림,9" text="미투입사유"/>
						<cell align="center" col="13" color="user21" display="text" font="굴림,9" text="비고"/>
					</head>
					<body>
						<cell align="center" col="0" display="text" expr="currow&#32;+&#32;1"/>
						<cell align="center" bkcolor='expr:iif(TUIP==&quot;Y&quot;,&quot;blue&quot;,&quot;default&quot;)' col="1" colid="CHK" color='expr:iif(TUIP==&quot;Y&quot;,&quot;white&quot;,&quot;default&quot;)' display='expr:iif(ACT=&apos;N&apos;&#32;,&quot;checkbox&quot;&#32;,&quot;none&quot;)' edit='expr:iif(ACT=&apos;N&apos;&#32;,&quot;checkbox&quot;&#32;,&quot;none&quot;)'/>
						<cell align="center" bkcolor='expr:iif(TUIP==&quot;Y&quot;,&quot;blue&quot;,&quot;default&quot;)' col="2" colid="GUBUN" color='expr:iif(TUIP==&quot;Y&quot;,&quot;white&quot;,&quot;default&quot;)' display="text"/>
						<cell align="center" bkcolor='expr:iif(TUIP==&quot;Y&quot;,&quot;blue&quot;,&quot;default&quot;)' col="3" colid="POSIT" color='expr:iif(TUIP==&quot;Y&quot;,&quot;white&quot;,&quot;default&quot;)' display="text"/>
						<cell align="center" bkcolor='expr:iif(TUIP==&quot;Y&quot;,&quot;blue&quot;,&quot;default&quot;)' col="4" colid="NAMEE" color='expr:iif(TUIP==&quot;Y&quot;,&quot;white&quot;,&quot;default&quot;)' display="text"/>
						<cell align="center" bkcolor2="user22" col="5" colid="ZSPEC1" display="text"/>
						<cell bkcolor2="user22" col="6" colid="ZSPEC2" display="text"/>
						<cell align="center" bkcolor='expr:iif(TUIP==&quot;Y&quot;,&quot;blue&quot;,&quot;default&quot;)' col="7" colid="TUIP_CHKA" color='expr:iif(TUIP==&quot;Y&quot;,&quot;white&quot;,&quot;default&quot;)' display="checkbox" edit='expr:iif(TUIP=&apos;N&apos;&#32;,&quot;checkbox&quot;&#32;,&quot;none&quot;)'/>
						<cell align="center" bkcolor='expr:iif(TUIP==&quot;Y&quot;,&quot;blue&quot;,&quot;default&quot;)' col="8" colid="TUIP_CHKB" color='expr:iif(TUIP==&quot;Y&quot;,&quot;white&quot;,&quot;default&quot;)' display="checkbox" edit='expr:iif(TUIP=&apos;N&apos;&#32;,&quot;checkbox&quot;&#32;,&quot;none&quot;)'/>
						<cell align="center" bkcolor='expr:iif(TUIP==&quot;Y&quot;,&quot;blue&quot;,&quot;default&quot;)' col="9" colid="M_MH" color='expr:iif(TUIP==&quot;Y&quot;,&quot;white&quot;,&quot;default&quot;)' display="number"/>
						<cell align="center" bkcolor='expr:iif(TUIP==&quot;Y&quot;,&quot;blue&quot;,&quot;default&quot;)' col="10" colid="A_MH" color='expr:iif(TUIP==&quot;Y&quot;,&quot;white&quot;,&quot;default&quot;)' display="number"/>
						<cell align="center" bkcolor='expr:iif(TUIP==&quot;Y&quot;,&quot;blue&quot;,&quot;default&quot;)' col="11" colid="N_MH" color='expr:iif(TUIP==&quot;Y&quot;,&quot;white&quot;,&quot;default&quot;)' combodisplayrowcnt="0" display="number"/>
						<cell bkcolor='expr:iif(TUIP==&quot;Y&quot;,&quot;blue&quot;,&quot;default&quot;)' bkimagealign="right" bkimageid="icon_grid_edit" col="12" colid="SAYU" color='expr:iif(TUIP==&quot;Y&quot;,&quot;white&quot;,&quot;default&quot;)' combocol="CODE" combodataset="ds_sayu" combodisplayrowcnt="20" combofilter='expr:&quot;DEL!=&apos;X&apos;&quot;' combotext="CODE_N" display="combo" edit='expr:iif(TUIP_CHKB=&apos;1&apos;&#32;&amp;&amp;&#32;OLD_SAYU&#32;==&#32;null&#32;&#32;,&quot;combo&quot;&#32;,&quot;none&quot;)'/>
						<cell align="left" bkcolor='expr:iif(TUIP==&quot;Y&quot;,&quot;blue&quot;,&quot;default&quot;)' bkimagealign="right" bkimageid="icon_grid_edit" col="13" colid="BIGO" color='expr:iif(TUIP==&quot;Y&quot;,&quot;white&quot;,&quot;default&quot;)' display="normal" edit='expr:iif(STORED_TUIP_CHKA=&apos;1&apos;&#32;||&#32;STORED_TUIP_CHKB=&apos;1&apos;&#32;&#32;,&quot;none&quot;&#32;,&quot;normal&quot;)'/>
					</body>
				</format>
			</contents>
		</Grid>
		<Static Color="user35" Font="굴림,10,Bold,UnderLine" Height="24" Id="Static6" Left="120" TabOrder="24" Text="설치기성과&#32;연계" Top="520" VAlign="Middle" Width="105"></Static>
		<Static Color="user7" Font="굴림,9,Bold" Height="24" Id="Static8" Left="400" TabOrder="25" Text="하시기&#32;바랍니다." Top="520" VAlign="Middle" Width="100"></Static>
		<Button Cursor="HAND" Height="20" Id="btn_add" ImageID="btn_icon_plus" Left="328" LeftMargin="12" OnClick="fn_insert" Style="sty_btn" TabOrder="23" Top="270" Transparent="TRUE" Width="22"></Button>
		<Button Cursor="HAND" Height="20" Id="btn_del" ImageID="btn_icon_minus" Left="352" LeftMargin="12" OnClick="fn_delete2" Style="sty_btn" TabOrder="22" Top="270" Transparent="TRUE" Width="22"></Button>
		<Button Height="22" Id="btn_popProj" ImageID="btn_icon_search" Left="376" OnClick="btn_popProj_OnClick" TabOrder="26" Text="Button0" Top="272" Transparent="TRUE" Width="24"></Button>
		<Tab Border="Flat" Font="굴림,9" Height="240" Id="Tab00" Left="8" MouseOverColor="user16" OnChanged="Tab00_OnChanged" SelColor="user15" SelectFont="굴림,9" Style="sty_tab" TabOrder="27" Top="280" Width="1312">
			<Contents>
				<TabPage BorderColor="black" Height="214" Id="tab1" ImageID="tab_form_04" Left="2" TabOrder="19" Text="미입력분" Top="24" Width="1308">
					<Grid AreaSelect="TRUE" AutoFitEndLine="Hide" BindDataset="ds_list1" BkColor2="default" BoldHead="true" Border="Flat" Bottom="216" CellMoving="TRUE" ColSelect="TRUE" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="216" Id="grd_list1" InputPanel="FALSE" Left="-2" LineColor="user20" LineType="ExHORZ" OnCellClick="grd_list1_OnCellClick" OnCellPosChanged="grd_list1_OnCellPosChanged" OnChar="grd_list1_OnChar" OnHeadClick="Tab00_tab1_grd_list1_OnHeadClick" Right="1294" RowHeight="20" Style="sty_grid" TabOrder="0" TabStop="true" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="1296">
						<contents>
							<format id="Default">
								<columns>
									<col fix="left" width="25"/>
									<col fix="left" width="0"/>
									<col fix="left" width="70"/>
									<col fix="left" width="150"/>
									<col fix="left" width="0"/>
									<col fix="left" width="0"/>
									<col width="60"/>
									<col width="55"/>
									<col width="110"/>
									<col width="65"/>
									<col width="65"/>
									<col width="30"/>
									<col width="45"/>
									<col width="30"/>
									<col width="46"/>
									<col width="30"/>
									<col width="45"/>
									<col width="45"/>
									<col width="43"/>
									<col width="74"/>
									<col width="0"/>
									<col width="30"/>
									<col width="45"/>
									<col width="30"/>
									<col width="46"/>
									<col width="30"/>
									<col width="45"/>
									<col width="74"/>
									<col width="0"/>
								</columns>
								<head>
									<cell col="0" display="text" rowspan="2"/>
									<cell col="1" display="text" rowspan="2"/>
									<cell col="2" color="user21" display="text" font=".,9" rowspan="2" text="호기"/>
									<cell col="3" color="user21" display="text" font=".,9" rowspan="2" text="현장명"/>
									<cell col="4" display="text"/>
									<cell col="5" display="text"/>
									<cell col="6" color="user21" display="text" font=".,9" rowspan="2" text="동정보"/>
									<cell col="7" color="user21" display="text" font=".,9" rowspan="2" text="기종"/>
									<cell col="8" color="user21" display="text" font=".,9" rowspan="2" text="사양"/>
									<cell col="9" color="user21" display="text" font=".,9" rowspan="2" text="착공예정일"/>
									<cell col="10" color="user21" display="text" font=".,9" rowspan="2" text="준공예정일"/>
									<cell col="11" color="user21" colspan="8" display="text" font=".,9" text="설치작업"/>
									<cell col="21" color="user21" colspan="6" display="text" font=".,9" text="상주&#32;및&#32;외주작업"/>
									<cell col="18" color="user21" display="text" font=".,9" row="1" text="공정"/>
									<cell align="center" col="19" color="user21" display="text" font=".,9" rowspan="2" text="설치공정"/>
									<cell align="center" col="20" color="user21" display="text" font="굴림,9" text="외주작업"/>
									<cell col="4" display="text" row="1"/>
									<cell col="5" display="text" row="1"/>
									<cell col="11" color="user21" display="text" font=".,9" row="1" text="AM"/>
									<cell col="12" color="user21" display="text" font=".,9" row="1" text="HOUR"/>
									<cell col="13" color="user21" display="text" font=".,9" row="1" text="PM"/>
									<cell col="14" color="user21" display="text" font=".,9" row="1" text="HOUR"/>
									<cell col="15" color="user21" display="text" font=".,9" row="1" text="돌관"/>
									<cell col="16" color="user21" display="text" font=".,9" row="1" text="HOUR"/>
									<cell col="17" color="user21" display="text" font=".,9" row="1" text="누계"/>
									<cell col="20" display="text" row="1"/>
									<cell align="center" col="27" color="user21" display="text" font=".,9" rowspan="2" text="외주공정"/>
									<cell col="28" display="text" rowspan="2"/>
									<cell col="21" color="user21" display="text" font=".,9" row="1" text="AM"/>
									<cell col="22" color="user21" display="text" font=".,9" row="1" text="HOUR"/>
									<cell col="23" color="user21" display="text" font=".,9" row="1" text="PM"/>
									<cell col="24" color="user21" display="text" font=".,9" row="1" text="HOUR"/>
									<cell col="25" color="user21" display="text" font=".,9" row="1" text="돌관"/>
									<cell col="26" color="user21" display="text" font=".,9" row="1" text="HOUR"/>
								</head>
								<body>
									<cell align="center" col="0" display="text" expr="currow&#32;+&#32;1"/>
									<cell align="center" col="1" colid="CHECK" display="checkbox"/>
									<cell align="center" bkcolor2="user22" col="2" colid="POSID" display="text" edit='expr:iif(FLAG=&apos;I&apos;,&quot;normal&quot;&#32;,&quot;none&quot;)'/>
									<cell align="left" bkcolor2="user22" col="3" colid="ZSITE_NM" display="text"/>
									<cell align="center" bkcolor2="user22" col="4" colid="ZSPEC1" display="text"/>
									<cell bkcolor2="user22" col="5" colid="ZSPEC2" display="text"/>
									<cell align="center" bkcolor2="user22" col="6" colid="POSID_DONG" display="text"/>
									<cell align="center" bkcolor2="user22" col="7" colid="ZSPEC1" display="text"/>
									<cell align="left" bkcolor2="user22" col="8" colid="ZSPEC2" display="text"/>
									<cell align="center" bkcolor2="user22" col="9" colid="ZZSHIP1" display="text" Mask="####.##.##"/>
									<cell align="center" bkcolor2="user22" col="10" colid="ZZCOMP2" display="text" Mask="####.##.##"/>
									<cell align="center" bkcolor2="user22" col="11" colid="M" display="checkbox" edit='expr:iif(CHK=&apos;Y&apos;&#32;&amp;&amp;&#32;HOGI&#32;=&apos;B&apos;&#32;,&quot;checkbox&quot;&#32;,&quot;none&quot;)'/>
									<cell align="center" bkcolor2="user22" col="12" colid="M_MH" combocol="CODE" combodataset="ds_time" combotext="CODE_NAME" display="combo" edit='expr:iif(M=&apos;1&apos;,&quot;combo&quot;&#32;,&quot;none&quot;)'/>
									<cell bkcolor2="user22" col="13" colid="A" display="checkbox" edit='expr:iif(CHK=&apos;Y&apos;&#32;&amp;&amp;&#32;HOGI&#32;=&apos;B&apos;&#32;,&quot;checkbox&quot;&#32;,&quot;none&quot;)'/>
									<cell align="center" bkcolor2="user22" col="14" colid="A_MH" combocol="CODE" combodataset="ds_time" combotext="CODE_NAME" display="combo" edit='expr:iif(A=&apos;1&apos;,&quot;combo&quot;&#32;,&quot;none&quot;)'/>
									<cell bkcolor2="user22" col="15" colid="N" display="checkbox" edit='expr:iif(CHK=&apos;Y&apos;&#32;&amp;&amp;&#32;HOGI&#32;=&apos;B&apos;&#32;&amp;&amp;&#32;CHK2&#32;=&#32;&apos;&apos;&#32;,&quot;checkbox&quot;&#32;,&quot;none&quot;)'/>
									<cell align="center" bkcolor2="user22" col="16" colid="N_MH" combocol="CODE" combodataset="ds_time2" combotext="CODE_NAME" display="combo" edit='expr:iif(N=&apos;1&apos;,&quot;combo&quot;&#32;,&quot;none&quot;)'/>
									<cell col="17" colid="PRO_B" display="number"/>
									<cell col="18" colid="DAY_R" display="number"/>
									<cell align="center" bkcolor="user0" bkcolor2="user22" col="19" display="button" edit='expr:iif(CHK=&apos;Y&apos;&#32;&amp;&amp;&#32;HOGI&#32;=&apos;B&apos;&#32;,&quot;button&quot;&#32;,&quot;none&quot;)' text="공정표"/>
									<cell bkcolor2="user22" bkimagealign="right" bkimageid="icon_grid_edit" col="20" colid="OUTS" combocol="CODE" combodataset="ds_out" combotext="CODE_N" display="combo" edit='expr:iif(CHK=&apos;Y&apos;,&quot;combo&quot;&#32;,&quot;none&quot;)'/>
									<cell align="center" bkcolor2="user22" col="21" colid="OM" display="checkbox" edit='expr:iif(CHK=&apos;Y&apos;&#32;&amp;&amp;&#32;HOGI&#32;=&apos;B&apos;&#32;,&quot;checkbox&quot;&#32;,&quot;none&quot;)'/>
									<cell align="center" bkcolor2="user22" col="22" colid="OM_MH" combocol="CODE" combodataset="ds_time" combotext="CODE_NAME" display="combo" edit='expr:iif(OM=&apos;1&apos;,&quot;combo&quot;&#32;,&quot;none&quot;)'/>
									<cell bkcolor2="user22" col="23" colid="OA" display="checkbox" edit='expr:iif(CHK=&apos;Y&apos;&#32;&amp;&amp;&#32;HOGI&#32;=&apos;B&apos;&#32;,&quot;checkbox&quot;&#32;,&quot;none&quot;)'/>
									<cell align="center" bkcolor2="user22" col="24" colid="OA_MH" combocol="CODE" combodataset="ds_time" combotext="CODE_NAME" display="combo" edit='expr:iif(OA=&apos;1&apos;,&quot;combo&quot;&#32;,&quot;none&quot;)'/>
									<cell bkcolor2="user22" col="25" colid="ON" display="checkbox" edit='expr:iif(CHK=&apos;Y&apos;&#32;&amp;&amp;&#32;HOGI&#32;=&apos;B&apos;&#32;,&quot;checkbox&quot;&#32;,&quot;none&quot;)'/>
									<cell align="center" bkcolor2="user22" col="26" colid="ON_MH" combocol="CODE" combodataset="ds_time2" combotext="CODE_NAME" display="combo" edit='expr:iif(ON=&apos;1&apos;,&quot;combo&quot;&#32;,&quot;none&quot;)'/>
									<cell align="center" bkcolor="user0" bkcolor2="user22" col="27" display="button" edit="button" text="공정표"/>
									<cell col="28" colid="OUT" display="text"/>
								</body>
							</format>
						</contents>
					</Grid>
				</TabPage>
				<TabPage BorderColor="black" Height="214" Id="tab2" ImageID="tab_form_04" Left="2" TabOrder="26" Text="입력분" Top="24" Width="1308">
					<Grid AreaSelect="TRUE" AutoFitEndLine="Hide" BindDataset="ds_list3" BkColor2="default" BoldHead="true" Border="Flat" Bottom="216" CellMoving="TRUE" ColSelect="TRUE" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="216" Id="grd_list2" InputPanel="FALSE" Left="-2" LineColor="user20" LineType="ExHORZ" OnCellClick="Tab00_tab2_grd_list2_OnCellClick" Right="1302" RowHeight="20" Style="sty_grid" TabOrder="1" TabStop="true" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="1304">
						<contents>
							<format id="Default">
								<columns>
									<col fix="left" width="25"/>
									<col fix="left" width="0"/>
									<col fix="left" width="54"/>
									<col fix="left" width="70"/>
									<col fix="left" width="150"/>
									<col fix="left" width="0"/>
									<col fix="left" width="0"/>
									<col width="60"/>
									<col width="55"/>
									<col width="110"/>
									<col width="65"/>
									<col width="65"/>
									<col width="30"/>
									<col width="45"/>
									<col width="30"/>
									<col width="45"/>
									<col width="30"/>
									<col width="45"/>
									<col width="43"/>
									<col width="74"/>
									<col width="0"/>
									<col width="30"/>
									<col width="45"/>
									<col width="30"/>
									<col width="45"/>
									<col width="30"/>
									<col width="45"/>
									<col width="74"/>
								</columns>
								<head>
									<cell col="0" display="text" rowspan="2"/>
									<cell col="1" display="text" rowspan="2"/>
									<cell col="2" color="user21" display="text" font=".,9" rowspan="2" text="성명"/>
									<cell col="3" color="user21" display="text" font=".,9" rowspan="2" text="호기"/>
									<cell col="4" color="user21" display="text" font=".,9" rowspan="2" text="현장명"/>
									<cell col="5" display="text"/>
									<cell col="6" display="text"/>
									<cell col="7" color="user21" display="text" font=".,9" rowspan="2" text="동정보"/>
									<cell col="8" color="user21" display="text" font=".,9" rowspan="2" text="기종"/>
									<cell col="9" color="user21" display="text" font=".,9" rowspan="2" text="사양"/>
									<cell col="10" color="user21" display="text" font=".,9" rowspan="2" text="착공예정일"/>
									<cell col="11" color="user21" display="text" font=".,9" rowspan="2" text="준공예정일"/>
									<cell col="12" color="user21" colspan="7" display="text" font=".,9" text="설치작업"/>
									<cell align="center" col="19" color="user21" display="text" font=".,9" rowspan="2" text="설치공정"/>
									<cell align="center" col="20" color="user21" display="text" font="굴림,9" text="외주작업"/>
									<cell col="21" color="user21" colspan="6" display="text" font=".,9" text="상주&#32;및&#32;외주작업"/>
									<cell align="center" col="27" color="user21" display="text" font=".,9" rowspan="2" text="외주공정"/>
									<cell col="5" display="text" row="1"/>
									<cell col="6" display="text" row="1"/>
									<cell col="12" color="user21" display="text" font=".,9" row="1" text="AM"/>
									<cell col="13" color="user21" display="text" font=".,9" row="1" text="HOUR"/>
									<cell align="center" col="14" color="user21" display="text" font="굴림,9" row="1" text="PM"/>
									<cell col="15" color="user21" display="text" font=".,9" row="1" text="HOUR"/>
									<cell align="center" col="16" color="user21" display="text" font="굴림,9" row="1" text="돌관"/>
									<cell col="17" color="user21" display="text" font=".,9" row="1" text="HOUR"/>
									<cell col="18" color="user21" display="text" font=".,9" row="1" text="공정"/>
									<cell align="center" col="20" color="user21" display="text" font="굴림,9" row="1" text="외주작업"/>
									<cell col="21" color="user21" display="text" font=".,9" row="1" text="AM"/>
									<cell col="22" color="user21" display="text" font=".,9" row="1" text="HOUR"/>
									<cell align="center" col="23" color="user21" display="text" font="굴림,9" row="1" text="PM"/>
									<cell col="24" color="user21" display="text" font=".,9" row="1" text="HOUR"/>
									<cell align="center" col="25" color="user21" display="text" font="굴림,9" row="1" text="돌관"/>
									<cell col="26" color="user21" display="text" font=".,9" row="1" text="HOUR"/>
								</head>
								<body>
									<cell col="0" display="text"/>
									<cell align="center" col="1" display="text" expr="currow&#32;+&#32;1"/>
									<cell align="center" col="2" colid="NAMEE" display="text"/>
									<cell align="center" bkcolor2="user22" col="3" colid="POSID" display="text"/>
									<cell align="left" bkcolor2="user22" col="4" colid="ZSITE_NM" display="text"/>
									<cell align="center" bkcolor2="user22" col="5" colid="ZSPEC1" display="text"/>
									<cell bkcolor2="user22" col="6" colid="ZSPEC2" display="text"/>
									<cell align="center" bkcolor2="user22" col="7" colid="POSID_DONG" display="text"/>
									<cell align="center" bkcolor2="user22" col="8" colid="ZSPEC1" display="text"/>
									<cell align="left" bkcolor2="user22" col="9" colid="ZSPEC2" display="text"/>
									<cell align="center" bkcolor2="user22" col="10" colid="ZZSHIP1" display="text" Mask="####.##.##"/>
									<cell align="center" bkcolor2="user22" col="11" colid="ZZCOMP2" display="text" Mask="####.##.##"/>
									<cell align="center" bkcolor2="user22" col="12" colid="M" display="checkbox"/>
									<cell align="center" bkcolor2="user22" col="13" colid="M_MH" combocol="CODE" combodataset="ds_time" combotext="CODE_NAME" display="combo"/>
									<cell bkcolor2="user22" col="14" colid="A" display="checkbox"/>
									<cell align="center" bkcolor2="user22" col="15" colid="A_MH" combocol="CODE" combodataset="ds_time" combotext="CODE_NAME" display="combo"/>
									<cell bkcolor2="user22" col="16" colid="N" display="checkbox"/>
									<cell align="center" bkcolor2="user22" col="17" colid="N_MH" combocol="CODE" combodataset="ds_time2" combotext="CODE_NAME" display="combo"/>
									<cell col="18" colid="DAY_R" display="number"/>
									<cell align="center" bkcolor="user0" bkcolor2="user22" col="19" display="button" edit="button" text="공정표"/>
									<cell bkcolor2="user22" bkimagealign="right" bkimageid="icon_grid_edit" col="20" colid="OUTS" combocol="CODE" combodataset="ds_out" combotext="CODE_N" display="combo"/>
									<cell align="center" bkcolor2="user22" col="21" colid="OM" display="checkbox"/>
									<cell align="center" bkcolor2="user22" col="22" colid="OM_MH" combocol="CODE" combodataset="ds_time" combotext="CODE_NAME" display="combo"/>
									<cell bkcolor2="user22" col="23" colid="OA" display="checkbox"/>
									<cell align="center" bkcolor2="user22" col="24" colid="OA_MH" combocol="CODE" combodataset="ds_time" combotext="CODE_NAME" display="combo"/>
									<cell bkcolor2="user22" col="25" colid="ON" display="checkbox"/>
									<cell align="center" bkcolor2="user22" col="26" colid="ON_MH" combocol="CODE" combodataset="ds_time2" combotext="CODE_NAME" display="combo"/>
									<cell align="center" bkcolor="user0" bkcolor2="user22" col="27" display="button" edit="button" text="공정표"/>
								</body>
							</format>
						</contents>
					</Grid>
				</TabPage>
			</Contents>
		</Tab>
		<Button BKColor="BACKGROUND" Color="user5" DisableBKColor="user7" DisableColor="user7" Height="25" Id="Button0" Left="158" TabOrder="28" Text="미배정&#32;프로젝트&#32;호기&#32;추가" Top="267" Width="160"></Button>
		<Static Color="user7" Font="굴림,9,Bold,UnderLine" Height="24" Id="Static7" Left="230" TabOrder="29" Text="됩니다.]&#32;꼭" Top="520" VAlign="Middle" Width="70"></Static>
		<Static Color="user35" Font="굴림,10,Bold,UnderLine" Height="24" Id="Static9" Left="304" TabOrder="30" Text="당일까지&#32;입력" Top="520" VAlign="Middle" Width="90"></Static>
		<Static Color="user7" Font="굴림,9,Bold,UnderLine" Height="24" Id="Static0" Left="16" TabOrder="31" Text="[일일작업일보는" Top="520" VAlign="Middle" Width="98"></Static>
		<Static Color="user7" Font="굴림,9" Height="24" Id="Static10" Left="16" TabOrder="32" Text="미투입&#32;사유중&#32;" Top="544" VAlign="Middle" Width="75"></Static>
		<Static Color="user34" Font="굴림,9,Bold" Height="24" Id="Static11" Left="96" TabOrder="33" Text="교육,&#32;사무실근무,&#32;해외지원,&#32;외주작업" Top="544" VAlign="Middle" Width="225"></Static>
		<Static Color="user7" Font="굴림,9" Height="24" Id="Static12" Left="328" TabOrder="34" Text="은&#32;미투입으로&#32;입력하지만&#32;투입인원으로&#32;집계됩니다." Top="544" VAlign="Middle" Width="300"></Static>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_input" ImageID="btn_sub_04" Left="888" LeftMargin="12" OnClick="btn_input_OnClick" Style="sty_btn" TabOrder="35" TabStop="FALSE" Text="입력현황" Top="41" Transparent="TRUE" Width="76"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_copy" ImageID="btn_sub_06" Left="880" LeftMargin="12" OnClick="btn_copy_OnClick" Style="sty_btn" TabOrder="36" TabStop="FALSE" Text="COPY&#32;TOOL" Top="4" Transparent="TRUE" Width="100"></Button>
		<Static Color="user8" Font="Default,9,Bold" Height="15" Id="Static13" Left="416" TabOrder="37" Text="이미지&#32;등록&#32;시,&#32;한글&#32;파일명은&#32;등록이&#32;불가합니다." Top="275" Width="300"></Static>
		<Edit BindDataset="ds_cond" Border="Flat" CheckLength="Byte" Column="ZZLIFNR_NM" Height="20" Id="edt_lifnr" ImeMode="native" Left="312" MaxLength="30" OnChanged="edt_lifnr_OnChanged" OnKeyDown="edt_lifnr_OnKeyDown" Style="sty_ipt_search" TabOrder="38" Top="5" UpperOnly="TRUE" Width="151"></Edit>
		<Button Height="18" Id="btn_lifnr" ImageID="btn_icon_search" Left="466" OnClick="btn_lifnr_OnClick" TabOrder="39" Text="btn_lifnr" Top="6" Width="18"></Button>
	</Form>
	<Script><![CDATA[/*
 *****************************************************************************************
 * 기      능   :
 * 작  성  자   : BANG GI TAE
 * 작성  일자   : 2012.04.03
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
#include "LIB::commons.js";	// 공통 스크립트
#include "LIB::common_hdel.js";	// 공통 스크립트
//=========================================================================================
// [ PART 1 ]
// Form에서 사용될 전역변수를 선언
// FORM에서 사용되는 전역변수는 대문자로 작성하며, F_XXX 의 형태를 갖도록 한다.
//=========================================================================================
var user_grp = "";
var args = "";
var curr_date = "";
var tm_cd = "";
var zzgubun = "";
var tuip_cnt = "";
var zztype= "";
var currRow = "";
var F_POSID="";
var F_GUBUN="";
var F_TYPE="";
var F_INP = "";
var F_TMCD = "";
var F_CHK= "";
var F_PRO = 0;
var F_SAFE = "";
var F_MH = 0.0;
var F_PSUM = 0.0;
var F_INWON = 0;
var F_INWON_CHK = '';
var F_LIFNR = "";
var F_PCNT = 0.0;
var F_ACTIVE = '';
var F_COPY = '';


//var userGroup = "";
//=========================================================================================
// [ PART 2 ]
// Form Loading / Unloading 시 작업 정의
//=========================================================================================
function fn_OnLoadCompleted(obj)
{
	gfn_initForm();

	user_grp = gfn_getUserGroup();

	var codeArr = ["PS003"];
    var dsObjArr = [ds_zzactss];
    var addTypeArr = [G_CODE_ALL];
    gfn_searchCommCode(codeArr, dsObjArr, addTypeArr);

    cb_inpday.Value = gfn_getCurrDate();

    //trace("gfn_getCurrDate() == " +gfn_getCurrDate());

	tit_clearActionInfo();
	tit_addSearchActionInfo("ps02:PS0206001A_S1");		//업체 코드
	tit_addSearchActionInfo("ps02:PS0206001A_S5");      //PM 코드

	tit_callService(
		""
		, ""
		, "ds_cond=ds_cond"
		, "ds_zzlifnr=ds_zzlifnr ds_pmcd=ds_pmcd"
		, ""
		, "fn_afterQueryA"
		, ""  //true
		, ""
		, true);

	cb_inpday.SETFOCUS();
	gfn_showMsg("CI00007");
	//정태성GJ 고범석 GJ(관리자) OR 협력사 인원 저장 버튼 활성화  -- 정태성 DR 요청 (2016.6.29)
	if( G_USER_ID = '2016940' or G_USER_ID = '2028786' or  G_USER_ID = '2022702' or  G_USER_ID = '2018900'  or  G_USER_ID = '2028891'or user_grp = '10')
	{ btn_delete.enable = true ; } else{
	  btn_delete.enable = false; }
}

/********************************************************************************
* 기      능   : 업체별 팀장코드 함수
********************************************************************************/
function fn_tmcd()
{
    tit_clearActionInfo();
	tit_addSearchActionInfo("ps02:PS0206001A_S6");      //팀장 코드

	tit_callService(
		""
		, ""
		, "ds_cond=ds_cond"
		, "ds_tmcd=ds_tmcd"
		, ""
		, ""   //"fn_afterQueryA"
		, ""  //true
		, ""
		, true);

		 ds_zzlifnr.SetColumn(0,"PCNT" , ds_tmcd.GetColumn(0,"PCNT"));
}
/********************************************************************************
* 기      능   : 협력업체 변경시 팀장코드 재검색
********************************************************************************/
function cb_zzlifnr_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	fn_tmcd();
}

/********************************************************************************
* 기      능   : 조회 Callback  - 설치협력사 로그인시 협력업체코드 첫번째 선택
********************************************************************************/
function fn_afterQueryA(errCode, errMsg)
{
	if( user_grp == "10")
	{
		//ds_zzlifnr.filter("CODE == " + quote( G_VEND_CODE_E) );
		//cb_zzlifnr.Index = 0;
		//cb_zzlifnr.Enable = false;

		//ds_cond.SetColumn(0, "ZZLIFNR", G_VEND_CODE_E);
		ds_cond.fireevent = false;
		ds_cond.SetColumn(0, "ZZLIFNR", G_VEND_CODE_E);
		ds_cond.SetColumn(0, "ZZLIFNR_NM", G_VEND_NAME);
		ds_cond.fireevent = true;

		edt_lifnr.Enable = false;
		btn_lifnr.Enable = false;
		cb_zzactss.Index = 0;
		cb_zzactss.Enable = false;
	    btn_add.Visible = true;
	    btn_del.Visible = true;

		fn_tmcd();

	}
	else if ( user_grp == "40" )
	{
		edt_lifnr.Enable = true;
		btn_lifnr.Enable = true;


		//cb_zzlifnr.Enable = true;
		//ds_zzlifnr.Filter("LOEVM==''");
		//gfn_insertEmptyRow( ds_zzlifnr, G_CODE_ALL );
		//cb_zzlifnr.value = "";
	    cb_zzactss.value = "";
		cb_zzactss.Enable = true;
        btn_add.Visible = true;
	    btn_del.Visible = true;
	}

	else if ( user_grp == "30" )  //임시로 열어줌
	{
		edt_lifnr.Enable = true;
		btn_lifnr.Enable = true;

		//cb_zzlifnr.Enable = true;
		//ds_zzlifnr.Filter("LOEVM==''");
		//gfn_insertEmptyRow( ds_zzlifnr, G_CODE_ALL );
		//cb_zzlifnr.value = "";
   	    cb_zzactss.value = "";
		cb_zzactss.Enable = true;
        btn_add.Visible = false;
	    btn_del.Visible = false;
	}

	else
	{
		//ds_cond.SetColumn(0, "LIFNR", G_VEND_CODE_E);
		edt_lifnr.Enable = false;
		btn_lifnr.Enable = false;

		//cb_zzlifnr.value = "";
		//cb_zzlifnr.Enable = false;
 	    cb_zzactss.value = "";
		cb_zzactss.Enable = false;
        btn_add.Visible = false;
	    btn_del.Visible = false;

		fn_tmcd();
	}
}

/********************************************************************************
* 기      능   : form UnloadCompleted
********************************************************************************/
function fn_OnUnloadCompleted(obj)
{
	return gfn_isFormUnload(obj);
}

/********************************************************************************
* 기      능   : hedquery 조회
********************************************************************************/
function fn_query()
{
	ApplyData();
	ds_comChk.Clear(); //임시저장된 완료체크 삭제

	//ds_comChk2.Clear(); //임시저장된 공정표 변경내역 삭제

	tit_clearActionInfo();
	tit_addSearchActionInfo("ps02:PS0207001A_S8");
	tit_addSearchActionInfo("ps02:PS0207001A_S5");
	tit_addSearchActionInfo("ps02:PS0207001A_S6");
	tit_callService(
		""
		, ""
		, "ds_cond=ds_cond"
		, "ds_head=ds_head ds_sayu=ds_sayu ds_out=ds_out"
		, ""
		, "fn_aftersql"
		, ""  //true
		, ""
		, true);
}
/********************************************************************************
* 기      능   : 조회
********************************************************************************/
function fn_aftersql()
{
	// 2018.09.18 정태성 GJ 요청 휴가/휴직 -> 휴가 , 휴직 으로 분리
	//ds_sayu.Filter("DEL <> 'X'");

	//설치협력사 조회시 협력업체 필수체크
	if(gfn_isNull(cb_zzlifnr, true, st_lifnr.value))  return;
	//투입일 필수체크
	if(gfn_isNull(cb_inpday,  true, st_inpday.value)) return;

    //팀장 필수체크
    if(gfn_isNull(cb_tmcd,   true, st_tmcd.value))	  return;

    tit_clearActionInfo();
	tit_addSearchActionInfo("ps02:PS0207001A_S1");
	tit_addSearchActionInfo("ps02:PS0207001A_S2");
	tit_callService(
		""
		, ""
		, "ds_cond=ds_cond"
		, "ds_list=ds_list ds_resign=ds_resign"
		, ""
		, "fn_aftersql2"
		, ""  //true
		, ""
		, true);

 }
/********************************************************************************
* 기      능   : 조회
********************************************************************************/
function fn_aftersql2()
{//ds_list_p
    //2019.03.18 nwtns lhl 구 공정표 dataset
    ds_detail.deleteAll();
   	ds_detail3.deleteAll();

   	//2019.03.18 nwtns lhl 신 공정표 dataset
   	ds_detail_n.deleteAll();
   	ds_detail3_n.deleteAll();
   	// 신공정표 end

   	ds_list_p.deleteAll();
   	ds_cond1.DeleteAll();
   	ds_cond3.DeleteAll();
    tit_clearActionInfo();
	tit_addSearchActionInfo("ps02:PS0208001A_S3"); //PS0207001A_S3 기존파일
	tit_addSearchActionInfo("ps02:PS0207001A_S10");
	tit_callService(
		""
		, ""
		, "ds_cond=ds_cond"
		, "ds_list1=ds_list1 ds_list3=ds_list3"
		, ""
		, ""//"fn_aftersql2"
		, ""  //true
		, ""
		, true);


	for(var j=0; j<ds_list.GetRowCount(); j++)
	{
	   if(Tab00.TabIndex == 0)
	   {
	      ds_list.SetColumn(j,"ACT", 'Y');
	      ds_list.SetColumn(j,"CHK", '');
	      btn_add.Visible = true;
	      btn_del.Visible = true;
			//퇴사인원 셋팅 추가 (2017.10.24)
			if(ds_list.GetColumn(j,"TUIP_CHKA") == '' && ds_list.GetColumn(j,"TUIP_CHKB") == '' )
			{

			}
	   }else{
	      ds_list.SetColumn(j,"ACT", 'N');
	      ds_list.SetColumn(j,"CHK", '');
   	      btn_add.Visible = false;
	      btn_del.Visible = false;
	   }
	}

	// HEAD 정렬 팀장, 이름 순
	ds_list.Sort("POSIT:D,NAMEE");
}
/********************************************************************************
* 기      능   : 닫기
********************************************************************************/
function fn_close()
{
	close();
}

/********************************************************************************
* 기      능   : 원프로젝트 팝업
********************************************************************************/
function btn_pjt_OnClick(obj)
{
	var arg = "pjt="+quote(ed_pjt.Text);
	gfn_openPopup("CS9601002A",true,arg);
	fn_query();
}

/********************************************************************************
* 기      능   : 리스트의 타이틀 클릭
********************************************************************************/
function Tab00_tab1_grd_list1_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
{
	if ( nCell == 0 ) {
		return;
	}
	else if ( nCell == 1 ) {
		// 그리드 표시할 컬럼 선택
		gfn_selectAllGrid(obj,nCell,nCell,true);
	} else {
		// 그리드 정렬 처리
		gfn_sortGrid(obj,nCell);
	}
}
function Tab00_tab2_grd_list2_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
{

	if ( nCell == 0 )
	{
		return;
	}
	else if ( nCell == 1 ) {
		// 그리드 표시할 컬럼 선택
		gfn_selectAllGrid(obj,nCell,nCell,true);
	} else {
		// 그리드 정렬 처리
		gfn_sortGrid(obj,nCell);
	}
}
/********************************************************************************
* 기      능   : 저장
********************************************************************************/
function fn_save()
{
/*	2019.03.10 nwtns lhl 완료데이터 셋 처리는 공정표 팝업화면에서 확인 버튼을 누른 후 폼을 닫고 나서
    맨 하단의 fn_comCheck_save() 에서 처리한다.

    if(ds_cond1.rowcount > 0) //완료 데이터셋이 있을때 업데이트
	{
	  tit_clearActionInfo();
 	  tit_addMultiActionInfo("ps02:PS0208001A_U4");   //zpstW0301 HEAD
 	  tit_callService(
 		 ""
 	   , ""
 	   , "ds_cond1=ds_cond1"
 	   , ""
 	   , ""
 	   , "fn_afterUpdates"
 	   , ""
 	   , ""
 	   , true);

 	}

 	trace("gogo");
 */
 //	trace("ds_list1 : " + ds_list1.SaveXML());
	//trace("---------------------------------------------------------------------------------------------" );
	//trace("fn_save()  :  start" );
	var sDateChk  = ds_cond.GetColumn(0, "DATE_CHK");
    var sComp_day = gfn_getAfterDate(gfn_getCurrDate(),-3);
    var sInp_dt  = ds_cond.GetColumn(0, "INP_DT");
    //Trace(sDateChk);
    //Trace(sComp_day);
    //Trace(sInp_dt);
    if(sDateChk == 'X' && sComp_day > sInp_dt)
    {
		gfn_openMsgWin("3일 이전 작업일보는 입력 할 수 없습니다.\n담당 PM또는 설치기획팀에 문의 바랍니다.");
		return;
    }
    
  
    
 	for(var i=0; i<ds_list1.GetRowCount(); i++)
	{
	   if(ds_list1.GetColumn(i, "CHECK") == 1)
	   {
	       if(ds_list1.GetColumn(i, "DAY_R") <= 0  && ds_list1.GetColumn(i, "OUT") <> 'X')
	        {
	              var txt = (parseInt(i) + 1) + "행 공정표를 입력하세요.";
  	               gfn_showMsg("CW00114", txt);
	               return;
	        }
	        if(ds_list1.GetColumn(i, "N_MH") = 0 && ds_list1.GetColumn(i, "A_MH") = 0 && ds_list1.GetColumn(i, "M_MH") = 0 && ds_list1.GetColumn(i, "ON_MH") = 0 && ds_list1.GetColumn(i, "OA_MH") = 0 && ds_list1.GetColumn(i, "OM_MH") = 0)
	        {
	              var txt = (parseInt(i) + 1) + "행 설치작업 투입시간을 입력하세요.";
  	               gfn_showMsg("CW00114", txt);
	               return;
	        }
   	       if(length(ds_list1.GetColumn(i, "ZSITE_NM")) <= 0 )
	        {
	              var txt = (parseInt(i) + 1) + "행 프로젝트는 입력할 수 없는 프로젝트입니다. 삭제하시기 바랍니다.";
  	               gfn_showMsg("CW00114", txt);
	               return;
	        }
	       if(ds_list1.GetColumn(i, "ON_MH") = 0 && ds_list1.GetColumn(i, "OA_MH") = 0 && ds_list1.GetColumn(i, "OM_MH") = 0 && ds_list1.GetColumn(i, "OUT") == 'X')
	       {
	               var txt = (parseInt(i) + 1) + "행 외주작업 투입시간을 입력하세요.";
  	               gfn_showMsg("CW00114", txt);
	               return;
	       }
	       if((ds_list1.GetColumn(i, "ON_MH") <> 0 || ds_list1.GetColumn(i, "OA_MH") <> 0 || ds_list1.GetColumn(i, "OM_MH") <> 0 ) && ds_list1.GetColumn(i, "OUT") == '' )
	       {
	               var txt = (parseInt(i) + 1) + "행 외주작업 공정표를 입력하세요.";
  	               gfn_showMsg("CW00114", txt);
	               return;
	       }

	   }


	}

	// 미투입 대시 시 미투입 사유 체크
	for(var i=0; i<ds_list.GetRowCount(); i++)
	{
	    ds_list.SetColumn(i,"INP_DT", ds_cond.GetColumn(0,"INP_DT"));

	  if( ds_list.GetColumn(i, "TUIP_CHKB") == 1  &&  ds_list.GetColumn(i, "TUIP") == "N" )
	  {

		 if(length(ds_list.GetColumn(i, "SAYU")) == 0 )
		 {
		   	var arr = [parseInt(i) + 1, "미투입사유"];
			gfn_showMsg("CW00224", arr);

	     	return;
		 }

	   }
		 // 투입 시 미 입력분에 대해 am/pm/야간 시간 체크
	  if( ds_list.GetColumn(i, "TUIP_CHKA") == 1 &&  ds_list.GetColumn(i, "TUIP") == "N" )
	   {
	        //LIST1 저장시 필터 위해
            ds_list.SetColumn(i,"CHKS", 1 );
	        if(ds_list.GetColumn(i, "M_MH") > 5)
		    {
		      gfn_showMsg("CW00022","AM 의 경우 5시간을 넘길 수 없습니다.");
	     	  return;
	        }
	        if(ds_list.GetColumn(i, "A_MH") > 5)
		    {
		      gfn_showMsg("CW00022","PM 의 경우 5시간을 넘길 수 없습니다.");
	     	  return;
	        }
	        if(ds_list.GetColumn(i, "N_MH") > 10)
		    {
		      gfn_showMsg("CW00022","야간의 경우 10시간을 넘길 수 없습니다.");
	     	  return;
	        }
	        if(ds_list.GetColumn(i, "N_MH") = 0 && ds_list.GetColumn(i, "A_MH") = 0 && ds_list.GetColumn(i, "M_MH") = 0)
		    {
		      gfn_showMsg("CW00022","현장을 선택하여 시간을 입력하여 주세요.");
	     	  return;
	        }
	   }
   }

       //투입인원 필터 및 담기
       ds_list.Filter("TUIP=='N'&& (TUIP_CHKA =='1'|| TUIP_CHKB =='1')");
	   ds_list_tmp2.copyF(ds_list);
	   ds_list.unFilter();

       // 인원 미 선택시 저장 불가
       if(ds_list_tmp2.RowCount() == 0)
       {
         gfn_showMsg("CW00022","입력 인원을 선택히세요.");
	     return;
       }
       else
       {

          for(var i=0; i<ds_list_tmp2.GetRowCount(); i++)
	     {

	         if( ds_list_tmp2.GetColumn(i, "TUIP_CHKA") == 1 &&  ds_list_tmp2.GetColumn(i, "TUIP") == "N" )
	         {
	            ds_list_tmp2.SetColumn(i,"TUIP_CHKA","X");
                ds_list_tmp2.SetColumn(i,"TUIP_CHKB","");
	         }
	         else if( ds_list_tmp2.GetColumn(i, "TUIP_CHKB") == 1 &&  ds_list_tmp2.GetColumn(i, "TUIP") == "N" )
	         {
	             ds_list_tmp2.SetColumn(i,"TUIP_CHKB","X");
	             ds_list_tmp2.SetColumn(i,"TUIP_CHKA","");
	         }
	      }
       }


      //투입인원 INSERT / UPDATE
	  tit_clearActionInfo();
	  tit_addSelectExActionInfo("ps02:PS0207001A_S7", "ps02:PS0207001A_I1", "ps02:PS0207001A_U2");   //zpstW0301 HEAD
	  tit_callService(
		 ""
	   , ""
	   , "ds_list_tmp2=ds_list_tmp2"
	   , ""
	   , ""
	   , "fn_afterSave"
	   , ""
	   , ""
	   , true);

}
/********************************************************************************
* 기      능   : 삭제
********************************************************************************/
function fn_delete()
{
   	// 금일 입력분보다 작으면 삭제 불가

   var day = gfn_getCurrDate();

 /*  if(G_USER_ID = '2016940' or G_USER_ID = '2028786' or  G_USER_ID = '2022702' or  G_USER_ID = '2018900'  or  G_USER_ID = '2028891')
   {
   }
   else{
    if(ds_cond.GetColumn(0,"INP_DT") < day && ds_zzlifnr.GetColumn(0,"CHK") <> 'X' )
    {
      gfn_showMsg("CW00022","이전 작업 내역은 삭제 할 수 없습니다.");
      return;
     }
   }
  */
   if(ds_list.FindRow("CHK", 1)==-1){
		gfn_showMsg('CW00046');
		return;
	}


	for(var i=0; i<ds_list.GetRowCount(); i++)
	{
	    ds_list.SetColumn(i,"INP_DT", ds_cond.GetColumn(0,"INP_DT"));

    }

       ds_list_tmp4.ClearData();
  	   ds_list.Filter("CHK==1");
	   ds_list_tmp4.copyF(ds_list);
	   ds_list.unFilter();

      if(ds_list_tmp4.RowCount() > 1)
      {
        ds_list_tmp4.ClearData();
        gfn_showAlert("인원 삭제 시 한 명씩 가능합니다.");
        return;
       }

       	if (!gfn_showConfirm("CI00015","작업내역과 관련된 모든 인원/호기 내역"))
	   {
	 	return;
	   }

	    tit_clearActionInfo();
	    if(ds_list_tmp4.GetColumn(0,"TUIP_CHKA") == '1' ||  ds_list_tmp4.GetColumn(0,"TUIP_CHKA") == 'X' )
	    {
	     //alert("a");
			tit_addSearchActionInfo("ps02:PS0207001A_S11");		//인원
			tit_addSearchActionInfo("ps02:PS0207001A_S12");	     // 현장
			 tit_callService(
				""
				, ""
				, "ds_list_tmp4=ds_list_tmp4"
				, "ds_del=ds_del ds_del2=ds_del2"
				, ""
				, "fn_afterDelete"
				, ""
				, ""
				,true  // ""
			);
	    }
	    else if(ds_list_tmp4.GetColumn(0,"TUIP_CHKB") == '1' or ds_list_tmp4.GetColumn(0,"TUIP_CHKB") == 'X' )
	    {
	     tit_addSingleActionInfo("ps02:PS0207001A_D6");
	     tit_callService(
			""
			, ""
			, "ds_list_tmp4=ds_list_tmp4"
			, ""
			, ""
			, "fn_afterDelete2"
			, ""
			, ""
			,true  // ""
	   	);

	  }
}
/********************************************************************************
* 기      능   : 삭제
********************************************************************************/
function fn_delete2()
{
   if(ds_list1.GetColumn(ds_list1.row,"FLAG") == 'N')
	{
		gfn_showMsg("CW00212",ds_list1.GetColumn(ds_list1.row,"POSID"));
		return;
	}
    else
    {
      ds_list1.DeleteRow(ds_list1.row);
    }
}

/********************************************************************************
* 기      능   : 완료처리 후 Callback
********************************************************************************/
function fn_afterUpdates(errCode, errMsg) {

	//trace("fn_afterUpdates == " + errCode);
	if ( errCode != 0 ) {
		gfn_showAlert("CE00001");
	} else {
		gfn_showAlert("CI00003");
	}
}

/********************************************************************************
* 기      능   : 저장 Callback
********************************************************************************/
function fn_afterSave(errCode, errMsg)
{

   	if ( errCode != 0 )
	{
		gfn_showAlert("CE00001");
	}
	else
	{
		gfn_showMsg("CI00003");

		//ds_list1 저장
		ds_list_tmp2.Filter("CHKS==1");
    	ds_list_tmp3.copyF(ds_list_tmp2);
	    ds_list_tmp2.unFilter();

	    ds_list1.Filter("CHECK==1");
    	ds_list1_tmp2.copyF(ds_list1);
	    ds_list1.unFilter();


	    /*  각 구, 신 공정(표)내역 저장 :  이하 설명 참고 바람 (기존 ds_detail 에 구.신 내역을 같이 담을 수 없습니다.)
	     *  1. 구 공정(표)내역 저장 데이터 셋: 원래 ds_detail 입니다.
	     *  2. 신 공정(표)내역 저장 데이터 셋 : ds_detail_n 으로 새로 만들어 담습니다.(컬럼 이름 과 갯수 가 기존 ds_detail 과 다릅니다.)
	     *     그래서 구. 신 공정내역을 같이 ds_detail 에 담을 수 가 없으며, 저장시 에러가 발생 됩니다.
	     */


	    // 투입 해당 현장 저장
	    if(ds_list_tmp3.rowcount > 0 ) {

			for(var i=0; i<ds_list_tmp3.GetRowCount(); i++)
			{
			   for(var j=0; j<ds_list1_tmp2.GetRowCount(); j++)
			   {
				  ds_list1_tmp2.SetColumn(j, "PERNO", ds_list_tmp3.GetColumn(i,"PERNO"));
				  ds_list1_tmp2.SetColumn(j, "INP_DT", ds_cond.GetColumn(0,"INP_DT"));

			   }

				  tit_clearActionInfo();
				  tit_addMultiActionInfo("ps02:PS0207001A_I2"); //현장내역 ZPSTW0302 INSERT
				  tit_addSingleActionInfo("ps02:PS0207001A_U3");
				  tit_callService(
					""
					, ""
					, "ds_list1_tmp2=ds_list1_tmp2"
					, ""
					, ""
					, "fn_afterSave2"
					, ""
					, ""
					, true  // ""
					);
			}


		   for(var k=0; k < ds_detail.GetRowCount(); k++)
		   {
			  ds_detail.SetColumn(k, "INP_DT", ds_cond.GetColumn(0,"INP_DT"));
		   }


		  if(ds_detail.rowcount > 0) //공정내역 (구 공정표)
		  {
		      //trace('fn_afterSave()_구 공정 : : ' + ds_detail.rowcount);

				  tit_clearActionInfo();
				  tit_addMultiActionInfo("ps02:PS0207001A_D4");  //zpstW0304 DELETE
				  tit_addMultiActionInfo("ps02:PS0207001A_I3");	// ZPSTW0304 INSERT
				  tit_addMultiActionInfo("ps02:PS0207001A_I5");  //집계테이블 MERGE

				  tit_callService(
					""
					, ""
					, "ds_detail=ds_detail"
					, ""
					, ""
					, "fn_afterSave2"
					, ""
					, ""
					, true  // ""
					);
			}

 	      //신 공정표 처리
		   for(var k=0; k < ds_detail_n.GetRowCount(); k++) // 다시 원래 데이터 셋에 담은 건
		   {
			  ds_detail_n.SetColumn(k, "INP_DT", ds_cond.GetColumn(0,"INP_DT"));

		   }


		  if(ds_detail_n.rowcount > 0) //공정내역 (신 공정표)
		  {
		      //trace('fn_afterSave()_신 공정 : : ' + ds_detail_n.rowcount);

				  // 처리 구문 확인
				  tit_clearActionInfo();
				  tit_addMultiActionInfo("ps02:PS0207001A_D4");  //zpstW0304DETAIL
				  tit_addMultiActionInfo("ps02:PS0207001A_I3");
				  tit_addMultiActionInfo("ps02:PS0207001A_I5");  //집계테이블 MERGE

				  tit_callService(
					""
					, ""
					, "ds_detail=ds_detail_n"       //다시 원래 데이터 셋 이름으로  넘김
					, ""
					, ""
					, "fn_afterSave2"
					, ""
					, ""
					, true  // ""
					);
			}

		   if(ds_list_p.rowcount > 0) //외주공정내역
		   {
			 tit_clearActionInfo();
				  tit_addMultiActionInfo("ps02:PS0207001A_D7");  //zpstW0307
				  tit_addMultiActionInfo("ps02:PS0207001A_I4");
				  tit_callService(
					""
					, ""
					, "ds_list_p=ds_list_p"
					, ""
					, ""
					, "fn_afterSave2"
					, ""
					, ""
					, true  // ""
					);
		   }

	  }

	}

	fn_query();
}
/********************************************************************************
* 기      능   : 저장 Callback
********************************************************************************/
function fn_afterSave2(errCode, errMsg)
{
   	if ( errCode != 0 )
	{
		gfn_showAlert("CE00001");
		return;
	}
	else
	{

	//	gfn_showAlert("CI00003");
    }
}
/********************************************************************************
* 기      능   : 삭제 Callback  //인원삭제
********************************************************************************/
function fn_afterDelete(errCode, errMsg)
{

  	  tit_clearActionInfo();

      if(ds_del.GetRowCount() > 0 )
      {
       tit_addMultiActionInfo("ps02:PS0207001A_D2");
	   tit_addMultiActionInfo("ps02:PS0207001A_D3");

			tit_callService(
			""
			, ""
			, "ds_del=ds_del"// ds_del2=ds_del2"
			, ""
			, ""
			, "fn_afterDelete2"
			, ""
			, ""
			,true  // ""
			);
	  }
	  else
      {
	     tit_addSingleActionInfo("ps02:PS0207001A_D6");
	     tit_callService(
			""
			, ""
			, "ds_list_tmp4=ds_list_tmp4"
			, ""
			, ""
			, "fn_afterDelete3"
			, ""
			, ""
			,true  // ""
			);
	  }
}

/********************************************************************************
* 기      능   : 삭제 Callback  //현장삭제
********************************************************************************/
function fn_afterDelete2(errCode, errMsg)
{
     tit_clearActionInfo();
     tit_addSelectExActionInfo("ps02:PS0207001A_S13", "ps02:PS0207001A_D5", "");   //zpstW0304 공정표
     tit_addSelectExActionInfo("ps02:PS0207001A_S14", "ps02:PS0207001A_D8", "");   //zpstW00307외주공정

     //2019.03.21 nwtns lhl 일자별 집계 row data 삭제
     tit_addSelectExActionInfo("ps02:PS0207001A_S13", "ps02:PS0208001A_D1", "");   //zpstW0304 공정표

     tit_callService(
		 ""
	   , ""
	   , "ds_del2=ds_del2"
	   , ""
	   , ""
	   , "fn_afterDelete3"
	   , ""
	   , ""
	   , true);
}
/********************************************************************************
* 기      능   : 삭제 Callback
********************************************************************************/
function fn_afterDelete3()
{
    if ( errCode!= 0 ) {
		gfn_showMsg("CE00001");
	} else {
		gfn_showMsg("CI00003");
		fn_query();
	}
}


/********************************************************************************
* 기      능   : 사무소 별 협력업체 필터
********************************************************************************/
function cb_zzactss_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
     if(user_grp == "40" || user_grp == "30"){
     ds_cond.SetColumn(0,"ZZLIFNR",''); }

    if(ds_cond.GetColumn(0,"ZZACTSS") == '')
    {
       ds_zzlifnr.UnFilter();
    }
    else
    {
      var arr = ds_cond.GetColumn(0,"ZZACTSS");
	  ds_zzlifnr.Filter("ZZACTSS ==" +quote(arr));
    }
}
/********************************************************************************
* 기      능   : 추가
********************************************************************************/
function fn_insert(obj)
{

	ds_list1.fireevent = false;
	ds_list1.AddRow();
	ds_list1.SetColumn(ds_list1.currow,"FLAG","I");
	ds_list1.SetColumn(ds_list1.currow,"LIFNR",ds_cond.GetColumn(0,"ZZLIFNR"));
	ds_list1.SetColumn(ds_list1.currow,"INP_DT",ds_cond.GetColumn(0,"INP_DT"));
	ds_list1.fireevent = true;
}

/********************************************************************************
* 기      능   : cell이동시 프로젝트정보 자동검색
********************************************************************************/
function grd_list1_OnCellPosChanged(obj,nRow,nCell,nOldRow,nOldCell,nPivotIndex,nOldPivotIndex)
{
	if(nOldCell = 2 && length(ds_list1.GetColumn(nOldRow,"POSID")) >0 && ds_list1.GetColumn(nOldRow,"FLAG") == "I")
	{
		currRow = nOldRow;
		fn_posid(ds_list1.GetColumn(nOldRow,"POSID"));
	}

	 ufn_sum();

}

/********************************************************************************
* 기      능   : 조회 (header 조회)
********************************************************************************/
function fn_posid(posid) {

	ds_cond2.SetColumn(0,"POSID",posid);
    ds_cond2.SetColumn(0,"INP_DT",ds_cond.GetColumn(0,"INP_DT"));

	tit_clearActionInfo();
	tit_addSearchActionInfo("ps02:PS0207001A_S4");

	tit_callService(
        ""
        , ""
        , "ds_cond=ds_cond2"
        , "ds_list2=ds_list2"
        , ""
        , "fn_afterPosid"
        , true);
}

/********************************************************************************
* 기      능   : 조회 Callback
********************************************************************************/
function fn_afterPosid(errCode, errMsg) {

	if(ds_list2.RowCount() > 0)
	{
		ds_list1.SetColumn(currRow,"PSPID",ds_list2.GetColumn(0,"PSPID"));
		ds_list1.SetColumn(currRow,"POSID",ds_list2.GetColumn(0,"POSID"));
		ds_list1.SetColumn(currRow,"ZSITE_NM",ds_list2.GetColumn(0,"ZSITE_NM"));
		ds_list1.SetColumn(currRow,"ZSPEC1",ds_list2.GetColumn(0,"ZSPEC1"));
		ds_list1.SetColumn(currRow,"ZZSHIP1",ds_list2.GetColumn(0,"ZZSHIP1"));
		ds_list1.SetColumn(currRow,"FLAG",ds_list2.GetColumn(0,"FLAG"));
		ds_list1.SetColumn(currRow,"ZSPEC2",ds_list2.GetColumn(0,"ZSPEC2"));
		ds_list1.SetColumn(currRow,"ZZCOMP2",ds_list2.GetColumn(0,"ZZCOMP2"));
		ds_list1.SetColumn(currRow,"INP_DT",ds_cond.GetColumn(0,"INP_DT"));
		ds_list1.SetColumn(currRow,"LIFNR",ds_cond.GetColumn(0,"ZZLIFNR"));
		ds_list1.SetColumn(currRow,"ZZCOMP",ds_list2.GetColumn(0,"ZZCOMP"));
		ds_list1.SetColumn(currRow,"ZZGUBUN",ds_list2.GetColumn(0,"ZZGUBUN"));
		ds_list1.SetColumn(currRow,"TYPE",ds_list2.GetColumn(0,"TYPE"));
		ds_list1.SetColumn(currRow,"SAFE",ds_list2.GetColumn(0,"SAFE"));
		ds_list1.SetColumn(currRow,"INIT_DT",ds_list2.GetColumn(0,"INIT_DT"));
		ds_list1.SetColumn(currRow,"PRO_B",ds_list2.GetColumn(0,"PRO_B"));
		ds_list1.SetColumn(currRow,"INWON_CHK",ds_list2.GetColumn(0,"INWON_CHK"));
		ds_list1.SetColumn(currRow,"VER",ds_list2.GetColumn(0,"VER"));
		ds_list1.SetColumn(currRow,"CHECK",0);
		ds_list1.SetColumn(currRow,"A","");
		ds_list1.SetColumn(currRow,"M","");
		ds_list1.SetColumn(currRow,"N","");
		ds_list1.SetColumn(currRow,"A_MH",0);
		ds_list1.SetColumn(currRow,"M_MH",0);
		ds_list1.SetColumn(currRow,"N_MH",0);
		ds_list1.SetColumn(currRow,"OA","");
		ds_list1.SetColumn(currRow,"OM","");
		ds_list1.SetColumn(currRow,"ON","");
		ds_list1.SetColumn(currRow,"OA_MH",0);
		ds_list1.SetColumn(currRow,"OM_MH",0);
		ds_list1.SetColumn(currRow,"ON_MH",0);
	    ds_list1.SetColumn(currRow,"HOGI","B");
	    ds_list1.SetColumn(currRow,"OUT","");


	}
	else
	{
		ds_list1.SetColumn(currRow,"PSPID","");
		ds_list1.SetColumn(currRow,"ZSITE_NM","");
		ds_list1.SetColumn(currRow,"ZZACTSS","");
        ds_list1.SetColumn(currRow,"ZSPEC1","");
		ds_list1.SetColumn(currRow,"ZZSHIP1","");
		ds_list1.SetColumn(currRow,"FLAG","I");
		ds_list1.SetColumn(currRow,"ZSPEC2","");
		ds_list1.SetColumn(currRow,"ZZCOMP2","");
		ds_list1.SetColumn(currRow,"INP_DT","");
		ds_list1.SetColumn(currRow,"LIFNR","");
		ds_list1.SetColumn(currRow,"ZZCOMP","");
		ds_list1.SetColumn(currRow,"CHECK",0);
		ds_list1.SetColumn(currRow,"INIT_DT","");
		ds_list1.SetColumn(currRow,"A","");
		ds_list1.SetColumn(currRow,"M","");
		ds_list1.SetColumn(currRow,"N","");
		ds_list1.SetColumn(currRow,"A_MH",0);
		ds_list1.SetColumn(currRow,"M_MH",0);
		ds_list1.SetColumn(currRow,"N_MH",0);
		ds_list1.SetColumn(currRow,"OA","");
		ds_list1.SetColumn(currRow,"OM","");
		ds_list1.SetColumn(currRow,"ON","");
		ds_list1.SetColumn(currRow,"OA_MH",0);
		ds_list1.SetColumn(currRow,"OM_MH",0);
		ds_list1.SetColumn(currRow,"ON_MH",0);
	    ds_list1.SetColumn(currRow,"SAFE","");
   	    ds_list1.SetColumn(currRow,"HOGI","A");
   	    ds_list1.SetColumn(currRow,"INWON_CHK",0);
   	    ds_list1.SetColumn(currRow,"OUT","");
		gfn_showMsg("CW00022","입력하신 프로젝트 호기를 확인바랍니다.");
	}
}

/********************************************************************************
* 기      능   : cell에 텍스트입력시 프로젝트정보 자동검색
********************************************************************************/
function grd_list1_OnChar(obj,strPreText,nChar,strPostText,nLLParam,nHLParam,nRow,nCell,nPivotIndex)
{
	if(length(strPostText) > 8 && nCell = 2 && ds_list.GetColumn(nRow,"FLAG") == "I")
	{
		currRow = nRow;
		fn_posid(trim(strPostText));
	}
}
/********************************************************************************
* 기      능   : 투입/ 미투입 중복 체킹
********************************************************************************/
function ds_list_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{
   //투입/ 미투입 중복 체킹
   if((ds_list.GetColumn(nRow,"TUIP_CHKA") == '1' && ds_list.GetColumn(nRow,"TUIP_CHKB") == '1'))
   {
      ds_list.SetColumn(nRow,"TUIP_CHKA", "");
      ds_list.SetColumn(nRow,"TUIP_CHKB", "");
      ds_list.SetColumn(nRow,"M_MH",0 );
      ds_list.SetColumn(nRow,"A_MH",0 );
      ds_list.SetColumn(nRow,"N_MH",0 );
      ds_list.SetColumn(nRow,"BIGO",'' );
      ds_list.SetColumn(nRow,"SAYU",'' );

      gfn_showMsg("CW00022","투입/미투입 하나만 체크하세요.");
   }


  // 투입인원 체크 시 list1 입력 가능
  ds_list_tmp.ClearData();

  for(var i=0; i<ds_list.GetRowCount(); i++)
	{
		if( ds_list.GetColumn(i, "TUIP_CHKA") == 1 && ds_list.GetColumn(i, "TUIP") == 'N' )
		{
			ds_list_tmp.addRow();
			ds_list_tmp.CopyRow(ds_list_tmp.row, "ds_list", i);
		}
	}


    for(var i=0; i<ds_list1.GetRowCount(); i++)
     {
       if(ds_list_tmp.rowcount > 0 ){
            ds_list1.SetColumn(i,"CHK", 'Y' ); }
     }

   	obj.fireevent = false;

	switch( strColumnID )
	{
		case "TUIP_CHKA":

		       ds_list.SetColumn(nRow,"BIGO",'' );
               ds_list.SetColumn(nRow,"SAYU",'' );
			   ufn_sum();

			break;

		case "TUIP_CHKB":

			   ds_list.SetColumn(nRow,"M_MH",0 );
               ds_list.SetColumn(nRow,"A_MH",0 );
               ds_list.SetColumn(nRow,"N_MH",0 );
   			   ds_list.SetColumn(nRow,"OM_MH",0 );
               ds_list.SetColumn(nRow,"OA_MH",0 );
               ds_list.SetColumn(nRow,"ON_MH",0 );

			break;
	}


	obj.fireevent = true;

 }
/********************************************************************************
* 기      능   : 호기 입력에 따른 시간 max관리
********************************************************************************/
function ds_list1_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{
    obj.fireevent = false;

	switch( strColumnID )
	{
	    case "M" :
	          if(ds_list1.GetColumn(nRow,"M") = 1)
	          {
	            ds_list1.SetColumn(nRow, "CHECK", 1);
	            ds_list1.SetColumn(nRow, "M_MH", 4);
	            ufn_sum();
	          } else {
                   if(ds_list1.GetColumn(nRow,"N") <> 1 && ds_list1.GetColumn(nRow,"A") <> 1 )
	              {
						if(ds_list1.GetColumn(nRow,"ON") <> 1 && ds_list1.GetColumn(nRow,"OA") <> 1 && ds_list1.GetColumn(nRow,"OM") <> 1 )
						{
						  ds_list1.SetColumn(nRow, "CHECK", '');
						  ds_list1.SetColumn(nRow, "OUT", '');
						}
						ds_list1.SetColumn(nRow, "DAY_R", 0);
						ds_list1.SetColumn(nRow, "BEFORE_R", 0);

						  for (var i= ds_detail.rowcount(); i>=0; i--) { //구 공정(표)내역
								if(ds_detail.GetColumn(i, "POSID") ==  ds_list1.GetColumn(nRow,"POSID") ) {
									 ds_detail.DeleteRow(i);
								}
						   }

						  //2019.03.18 nwtns lhl 신 공정(표)내역 처리
						   for (var i= ds_detail_n.rowcount(); i>=0; i--) { //신 공정(표)내역
								if(ds_detail_n.GetColumn(i, "POSID") ==  ds_list1.GetColumn(nRow,"POSID") ) {
									 ds_detail_n.DeleteRow(i);
								}
						   }


	               }
                ds_list1.SetColumn(nRow, "M_MH", 0);
                ufn_sum();
	          }
	          break;
	    case "A" :
	         if(ds_list1.GetColumn(nRow,"A") = 1)
	          {
	            ds_list1.SetColumn(nRow, "CHECK", 1);
                ds_list1.SetColumn(nRow, "A_MH", 5);
                ufn_sum();
	          } else {
	              if(ds_list1.GetColumn(nRow,"N") <> 1 && ds_list1.GetColumn(nRow,"M") <> 1 )
	              {
	                if(ds_list1.GetColumn(nRow,"ON") <> 1 && ds_list1.GetColumn(nRow,"OA") <> 1 && ds_list1.GetColumn(nRow,"OM") <> 1 )
	                {
	                  ds_list1.SetColumn(nRow, "CHECK", '');
	                  ds_list1.SetColumn(nRow, "OUT", '');
	                }
                    ds_list1.SetColumn(nRow, "DAY_R", 0);
		            ds_list1.SetColumn(nRow, "BEFORE_R", 0);


					 for (var i= ds_detail.rowcount(); i>=0; i--) {
							if(ds_detail.GetColumn(i, "POSID") ==  ds_list1.GetColumn(nRow,"POSID") ) {
								 ds_detail.DeleteRow(i);
							}
					   }

					 //2019.03.18 nwtns lhl 신 공정(표)내역 처리
					 for (var i= ds_detail_n.rowcount(); i>=0; i--) {
							if(ds_detail_n.GetColumn(i, "POSID") ==  ds_list1.GetColumn(nRow,"POSID") ) {
								 ds_detail_n.DeleteRow(i);
							}
					   }

	              }

                 ds_list1.SetColumn(nRow, "A_MH", 0);
                ufn_sum();
	          }

	          break;
	    case "N" :
	          if(ds_list1.GetColumn(nRow,"N") = 1)
	          {
	            ds_list1.SetColumn(nRow, "CHECK", 1);
	            ds_list1.SetColumn(nRow, "N_MH", 3);
	            ufn_sum();
	          } else {
	              if(ds_list1.GetColumn(nRow,"A") <> 1 && ds_list1.GetColumn(nRow,"M") <> 1 )
	              {
	                 if(ds_list1.GetColumn(nRow,"ON") <> 1 && ds_list1.GetColumn(nRow,"OA") <> 1 && ds_list1.GetColumn(nRow,"OM") <> 1 )
	                {
	                  ds_list1.SetColumn(nRow, "CHECK", '');
	                  ds_list1.SetColumn(nRow, "OUT", '');
	                }
	                ds_list1.SetColumn(nRow, "DAY_R", 0);
		            ds_list1.SetColumn(nRow, "BEFORE_R", 0);

					 for (var i= ds_detail.rowcount(); i>=0; i--) {
							if(ds_detail.GetColumn(i, "POSID") ==  ds_list1.GetColumn(nRow,"POSID") ) {
								 ds_detail.DeleteRow(i);           }
					   }

					  //2019.03.18 nwtns lhl 신 공정(표)내역 처리
					   for (var i= ds_detail_n.rowcount(); i>=0; i--) {
							if(ds_detail_n.GetColumn(i, "POSID") ==  ds_list1.GetColumn(nRow,"POSID") ) {
								 ds_detail_n.DeleteRow(i);           }
					   }


	              }
                ds_list1.SetColumn(nRow, "N_MH", 0);
                ufn_sum();
	          }

	          break;
	    case "OM" ://외주시간
	          if(ds_list1.GetColumn(nRow,"OM") = 1)
	          {
	            ds_list1.SetColumn(nRow, "CHECK", 1);
	            ds_list1.SetColumn(nRow, "OM_MH", 5);
	            ufn_sum();
	          } else {
                   if(ds_list1.GetColumn(nRow,"ON") <> 1 && ds_list1.GetColumn(nRow,"OA") <> 1 )
	              {
	                if(ds_list1.GetColumn(nRow,"N") <> 1 && ds_list1.GetColumn(nRow,"A") <> 1 && ds_list1.GetColumn(nRow,"M") <> 1 )
	                {
	                  ds_list1.SetColumn(nRow, "CHECK", '');
	                  ds_list1.SetColumn(nRow, "OUT", '');
	                }
  		              for (var j= ds_list_p.rowcount(); j>=0; j--) {
                            if(ds_list_p.GetColumn(j, "POSID") ==  ds_list1.GetColumn(nRow,"POSID") ) {
                                 ds_list_p.DeleteRow(j);           }
	                   }
	               }
                ds_list1.SetColumn(nRow, "OM_MH", 0);
                ufn_sum();
	          }
	          break;
	    case "OA" :
	         if(ds_list1.GetColumn(nRow,"OA") = 1)
	          {
	            ds_list1.SetColumn(nRow, "CHECK", 1);
                ds_list1.SetColumn(nRow, "OA_MH", 5);
                ufn_sum();
	          } else {
	              if(ds_list1.GetColumn(nRow,"ON") <> 1 && ds_list1.GetColumn(nRow,"OM") <> 1 )
	              {
	                 if(ds_list1.GetColumn(nRow,"N") <> 1 && ds_list1.GetColumn(nRow,"A") <> 1 && ds_list1.GetColumn(nRow,"M") <> 1 )
	                {
	                  ds_list1.SetColumn(nRow, "CHECK", '');
	                  ds_list1.SetColumn(nRow, "OUT", '');
	                }
  		              for (var j= ds_list_p.rowcount(); j>=0; j--) {
                            if(ds_list_p.GetColumn(j, "POSID") ==  ds_list1.GetColumn(nRow,"POSID") ) {
                                 ds_list_p.DeleteRow(j);           }
	                   }
	              }
                 ds_list1.SetColumn(nRow, "OA_MH", 0);
                ufn_sum();
	          }

	          break;
	    case "ON" :
	          if(ds_list1.GetColumn(nRow,"ON") = 1)
	          {
	            ds_list1.SetColumn(nRow, "CHECK", 1);
	            ufn_sum();
	          } else {
	              if(ds_list1.GetColumn(nRow,"OA") <> 1 && ds_list1.GetColumn(nRow,"OM") <> 1 )
	              {
	                 if(ds_list1.GetColumn(nRow,"N") <> 1 && ds_list1.GetColumn(nRow,"A") <> 1 && ds_list1.GetColumn(nRow,"M") <> 1 )
	                {
	                  ds_list1.SetColumn(nRow, "CHECK", '');
	                  ds_list1.SetColumn(nRow, "OUT", '');
	                }
  		              for (var j= ds_list_p.rowcount(); j>=0; j--) {
                            if(ds_list_p.GetColumn(j, "POSID") ==  ds_list1.GetColumn(nRow,"POSID") ) {
                                 ds_list_p.DeleteRow(j);           }
	                   }
	              }
                ds_list1.SetColumn(nRow, "ON_MH", 0);
                ufn_sum();
	          }

	          break;
		case "CHECK":
		      if(ds_list1.GetColumn(nRow,"CHECK") == '1')
		      {
		          ufn_sum();
		      }
		      else
		      {
                  ds_list1.SetColumn(nRow, "A_MH", 0);
		          ds_list1.SetColumn(nRow, "A", '');
		          ds_list1.SetColumn(nRow, "M_MH", 0);
		          ds_list1.SetColumn(nRow, "M", '');
		          ds_list1.SetColumn(nRow, "N_MH", 0);
		          ds_list1.SetColumn(nRow, "N", '');
		          ds_list1.SetColumn(nRow, "OA_MH", 0);
		          ds_list1.SetColumn(nRow, "OA", '');
		          ds_list1.SetColumn(nRow, "OM_MH", 0);
		          ds_list1.SetColumn(nRow, "OM", '');
		          ds_list1.SetColumn(nRow, "ON_MH", 0);
		          ds_list1.SetColumn(nRow, "ON", '');
		          ds_list1.SetColumn(nRow, "DAY_R", 0);
		          ds_list1.SetColumn(nRow, "BEFORE_R", 0);
		          ds_list1.SetColumn(nRow, "OUT", '');

		          	for (var i= ds_detail.rowcount(); i>=0; i--) {
						if(ds_detail.GetColumn(i, "POSID") ==  ds_list1.GetColumn(nRow,"POSID") ) {
							 ds_detail.DeleteRow(i);           }
				   }

	              //2019.03.18 nwtns lhl 신 공정(표)내역 처리
					for (var i= ds_detail_n.rowcount(); i>=0; i--) {
						if(ds_detail_n.GetColumn(i, "POSID") ==  ds_list1.GetColumn(nRow,"POSID") ) {
							 ds_detail_n.DeleteRow(i);           }
				   }



	              //외주 공정표
	              for (var j= ds_list_p.rowcount(); j>=0; j--) {
                            if(ds_list_p.GetColumn(j, "POSID") ==  ds_list1.GetColumn(nRow,"POSID") ) {
                                 ds_list_p.DeleteRow(j);           }
	                   }

		          ufn_sum();
		      }
			  break;
		case "M_MH" :
              ufn_sum();
	    case "A_MH" :
	          ufn_sum();
	          break;
	    case "N_MH" :
	          ufn_sum();
              break;
        case "OM_MH" :
              ufn_sum();
	    case "OA_MH" :
	          ufn_sum();
	          break;
	    case "ON_MH" :
	          ufn_sum();
              break;

	}


	obj.fireevent = true;


}
/********************************************************************************
* 기      능   : ds_list1 체크시 ds_list 수량 sum
********************************************************************************/
function ufn_sum()
{

  var M  = 0;
  var A  = 0;
  var N  = 0;
  var OM = 0;
  var OA = 0;
  var ON = 0;

  ds_list1_tmp.ClearData();

  for(var i=0; i<ds_list1.GetRowCount(); i++)
	{
		if( ds_list1.GetColumn(i, "CHECK") == 1 )
		{
			ds_list1_tmp.addRow();
			ds_list1_tmp.CopyRow(ds_list1_tmp.row, "ds_list1", i);
		}
	}

   for(var i=0; i<ds_list1_tmp.GetRowCount(); i++)
   {
	 if( ds_list1_tmp.GetColumn(i, "M") == 1 || ds_list1_tmp.GetColumn(i, "OM") == 1)
	 {
	    M = toNumber(M)  + toNumber(ds_list1_tmp.GetColumn(i, "M_MH")) + toNumber(ds_list1_tmp.GetColumn(i, "OM_MH")) ;
     }
     if( ds_list1_tmp.GetColumn(i, "N") == 1 || ds_list1_tmp.GetColumn(i, "ON") == 1 )
	 {
	    N = toNumber(N)  + toNumber(ds_list1_tmp.GetColumn(i, "N_MH")) + toNumber(ds_list1_tmp.GetColumn(i, "ON_MH"));
     }
     if( ds_list1_tmp.GetColumn(i, "A") == 1 ||  ds_list1_tmp.GetColumn(i, "OA") == 1)
     {
	    A = toNumber(A)  + toNumber(ds_list1_tmp.GetColumn(i, "A_MH")) + toNumber(ds_list1_tmp.GetColumn(i, "OA_MH"));
     }

   }

    for(var j=0; j<ds_list.GetRowCount(); j++)
	{
		if( ds_list.GetColumn(j, "TUIP_CHKA") == 1 &&  ds_list.GetColumn(j, "TUIP") == "N")  // 투입인 경우(미입력분에 대해)
		{
		   ds_list.SetColumn(j,"M_MH", M);
	       ds_list.SetColumn(j,"N_MH", N);
	       ds_list.SetColumn(j,"A_MH", A);
		}
    }


}

/********************************************************************************
* 기      능   : 공정표 연동 (미입력분)
********************************************************************************/
function grd_list1_OnCellClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
    var chk = 'Y' ; // 미입력 현장의 경우
    var inwon  = '';
    var active = '' ; // 투입에 따른 공정표 활성화 플레그 (신규 공정표 화면(PS0208001B)의 확인버튼 보이게/안보게 처리)
    var percnt = ds_zzlifnr.GetColumn(0,"PCNT") ;
    var pro = (ds_list1.getColumn(nRow, "M_MH") + ds_list1.getColumn(nRow, "A_MH") + ds_list1.getColumn(nRow, "ON_MH") +ds_list1.getColumn(nRow, "OM_MH") + ds_list1.getColumn(nRow, "OA_MH") + ds_list1.getColumn(nRow, "N_MH")) * (ds_list_tmp.rowcount() + ds_list1.getColumn(nRow, "INWON_CHK"));

	//trace("pro : " + pro);

	if(ds_list1.getColumn(nRow, "INWON_CHK") > 0) // 입력된 PTJ 구분
	{
	    inwon = 'Y' ;
	}
	else
	{
	   inwon = 'N' ;
	}
	if(nCell == 19) //설치 - 공정표 눌렀을 때
	{

         //trace("inwon : " + inwon);


		if(ds_list1.GetColumn(nRow,"CHECK") == '1' && ds_list1.GetColumn(nRow,"HOGI") == 'B' && (ds_list1.GetColumn(nRow,"M") == 1 || ds_list1.GetColumn(nRow,"N") == 1 || ds_list1.GetColumn(nRow,"A") == 1 ))
		{
			active = 'Y';
		}else{
			active = 'N';
		}


		var nChkInwon = ds_list.CaseCount("TUIP_CHKA == '1'");
		var nChkTime  = ToNumber(ds_list1.getColumn(ds_list1.rowposition, "M_MH")) + ToNumber(ds_list1.getColumn(ds_list1.rowposition, "A_MH"));

     	var args = ' F_POSID='+quote(ds_list1.getColumn(nRow, "POSID"));    // 호기번호
		args +=' F_GUBUN='+quote(ds_list1.getColumn(nRow, "ZZGUBUN"));
		args +=' F_TYPE='+quote(ds_list1.getColumn(nRow, "TYPE"));
		args +=' F_VER='+quote(ds_list1.getColumn(nRow, "VER"));	         //버전
	    args +=' F_INP='+quote(ds_cond.getColumn(0, "INP_DT"));
	    args +=' F_CHK='+quote(chk);										//미입력분, 입력분 구분
        args +=' F_PRO='+quote(ds_list1.getColumn(nRow, "DAY_R"));
        args +=' F_SAFE='+quote(ds_list1.getColumn(nRow, "SAFE"));
        args +=' F_PSUM='+quote(pro);
        args +=' F_PCNT='+quote(percnt);
        args +=' F_INWON='+quote(ds_list_tmp.rowcount());
        args +=' F_INWON_CHK='+quote(inwon);
        args +=' F_ACTIVE='+quote(active);

        args +=' F_CHKTIME='+quote(nChkTime);
        args +=' F_CHKINWON='+quote(nChkInwon);

        args +=' F_PSPID='+quote(Substr(ds_list1.getColumn(nRow, "POSID"),0,6));

        //공정표 팝업의 확인버튼 보여 줄 경우 (N: 보여줌)

        //trace("args : " + args);

        //구공정과 신공정 구분 기준을 type에서 ver으로 수정 - 2019.03.24 강민석K
        var pType = ds_list1.getColumn(nRow, "TYPE");
        var pVer = ds_list1.getColumn(nRow, "VER");
		
		Trace("type,ver : "+pType+","+pVer);
		//134763 예외처리 --20171122조용준과장
		//if( pType == "EL01" || pType == "EL02" || pType == "EL03" || pType == "EL04" || pType == "EL05" || pType == "ES01" ||
        //    pType == "JC01" || pType == "JC02" || pType == "JC03" || pType == "JC04" || pType == "MW01")  //기존타입
        if(pVer == "000")
	    { // 기존타입 ( 일정기간 동안 신규타입 기존 타입을 같이사용)

	       // F_PCHART = 'OLD'; //2019.03.18 nwtns lhl 구 공정표 , 신 공정표 구분
		   // if(ds_list1.getColumn(nRow, "TYPE") <> '' or ds_list1.getColumn(nRow, "PSPID") == '134763' or ds_list1.getColumn(nRow, "PSPID") == '124876'  or ds_list1.getColumn(nRow, "PSPID") == '124806')
			if(ds_list1.getColumn(nRow, "TYPE") <> '' or ds_list1.getColumn(nRow, "PSPID") == '134763' or ds_list1.getColumn(nRow, "PSPID") == '124876'  or ds_list1.getColumn(nRow, "PSPID") == '124806')
			{

				if(ds_list1.getColumn(nRow, "ZZGUBUN") == "10")
	            {
					gfn_openPopup("PS0207001B", true, args);
				}
				else if(ds_list1.getColumn(nRow, "ZZGUBUN") == "11")
				{
					gfn_openPopup("PS0207001C", true, args);
				}
				else if(ds_list1.getColumn(nRow, "ZZGUBUN") == "12")
				{
					gfn_openPopup("PS0207001D", true, args);
				}


				//2019.03.21  nwtns lhl
				for(var i = 0 ; i < ds_detail.RowCount(); i++) //집계테이블 MERGE 를 위한 협력사 번호 , 팀장코드
				{
					ds_detail.SetColumn(i, "LIFNR", ds_tmcd.getColumn(ds_tmcd.findRow("CODE", cb_tmcd.value), "LIFNR"));
					ds_detail.SetColumn(i, "TEMNO2", ds_tmcd.getColumn(ds_tmcd.findRow("CODE", cb_tmcd.value), "CODE"));

					//trace("ds_detail_LIFNR : " + ds_tmcd.getColumn(i, "LIFNR") );
					//trace("ds_detail_TEMNO2 : " + ds_tmcd.getColumn(i, "TEMNO2") );
				}




			}
	    }else{

	       // F_PCHART = 'NEW'; //2019.03.18 nwtns lhl 구 공정표 , 신 공정표 구분


			if(ds_list1.getColumn(nRow, "TYPE") <> '' or ds_list1.getColumn(nRow, "PSPID") == '134763' or ds_list1.getColumn(nRow, "PSPID") == '124876'  or ds_list1.getColumn(nRow, "PSPID") == '124806')
			{
				gfn_openPopUpUrlHdel("PS02::PS0208001B.xml", true, args);

			    //trace("미입력분_신 공정(표)내역 : " +  ds_detail_n.rowcount );
			}

	    }
    }

  //외주공정표
   	if(nCell == 27)
	{

	    if(ds_list1.GetColumn(nRow,"CHECK") == '1' && (ds_list1.GetColumn(nRow,"OM") == 1 || ds_list1.GetColumn(nRow,"ON") == 1 || ds_list1.GetColumn(nRow,"OA") == 1 ))
	    { //ALERT("A");
	       var args = ' F_POSID='+quote(ds_list1.getColumn(nRow, "POSID"));
	           args +=' F_INP='+quote(ds_cond.getColumn(0, "INP_DT"));
	           args +=' F_CHK='+quote(chk);

			gfn_openPopup("PS0207001E", true, args);
	    }
	     else { gfn_showMsg("CW00022","외주 공정표 입력할 호기를 체크해주세요.");}
	}
}


/********************************************************************************
* 기      능   : 프로젝트 검색
********************************************************************************/
function btn_popProj_OnClick(obj)
{
    var arg = "pjt="+quote(ed_pjt.Text);
	gfn_openPopup("CS9601002A",true,arg);
}
/********************************************************************************
* 기      능   : TAB 변경 시 CHECK 박스 활성화
********************************************************************************/
function Tab00_OnChanged(obj,nOldIndex,nNewindex)
{
	for(var j=0; j<ds_list.GetRowCount(); j++)
	{
	   if(Tab00.TabIndex == 0)
	   {
	      ds_list.SetColumn(j,"ACT", 'Y');
	      ds_list.SetColumn(j,"CHK", '');
	      btn_add.Visible = true;
	      btn_del.Visible = true;
	   }
	   else
	   {
	      ds_list.SetColumn(j,"ACT", 'N');
	      ds_list.SetColumn(j,"CHK", '');
   	      btn_add.Visible = false;
	      btn_del.Visible = false;
	   }
	}
}

/********************************************************************************
* 기      능   : 공정표 연동 (입력분)
********************************************************************************/
function Tab00_tab2_grd_list2_OnCellClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
	 // 입력의 경우 비활성화 처리
	 var chk = 'N' ;
	 var inwon  = '';
     var percnt = ds_zzlifnr.GetColumn(0,"PCNT") ;
     var pro = (ds_list3.getColumn(nRow, "M_MH") + ds_list3.getColumn(nRow, "A_MH") + ds_list3.getColumn(nRow, "ON_MH") +ds_list3.getColumn(nRow, "OM_MH") + ds_list3.getColumn(nRow, "OA_MH") + ds_list3.getColumn(nRow, "N_MH")) *  ds_list3.getColumn(nRow, "INWON_CHK");
	 var nChkInwon = ds_list.CaseCount("TUIP_CHKA == '1'");
	 var nChkTime  = ToNumber(ds_list3.getColumn(ds_list1.rowposition, "M_MH")) + ToNumber(ds_list1.getColumn(ds_list1.rowposition, "A_MH"));
	//trace("pro : " + pro);

	if(ds_list3.getColumn(nRow, "INWON_CHK") > 0) // 입력된 PTJ 구분
	{
	   inwon = 'Y' ;
	}
	else
	{
	   inwon = 'N' ;
	}


  	 if(nCell == 19)
  	 {
	  var args = ' F_POSID='+quote(ds_list3.getColumn(nRow, "POSID"));
	    args +=' F_PSPID='+quote(Substr(ds_list3.getColumn(nRow, "POSID"),0,6));
		args +=' F_GUBUN='+quote(ds_list3.getColumn(nRow, "ZZGUBUN"));
		args +=' F_TYPE='+quote(ds_list3.getColumn(nRow, "TYPE"));
		args +=' F_VER='+quote(ds_list3.getColumn(nRow, "VER"));
	    args +=' F_INP='+quote(ds_cond.getColumn(0, "INP_DT"));
        args +=' F_PRO='+quote(ds_list3.getColumn(nRow, "DAY_R"));
	    args +=' F_CHK='+quote(chk);
        args +=' F_PSUM='+quote(pro);
	    args +=' F_PCNT='+quote(percnt);
        args +=' F_INWON='+quote(ds_list3.getColumn(nRow, "INWON_CHK"));
        args +=' F_INWON_CHK='+quote(inwon);
        args +=' F_CHKTIME='+quote(nChkTime);
        args +=' F_CHKINWON='+quote(nChkInwon);
	    args +=' F_SAFE='+quote(ds_list3.getColumn(nRow, "SAFE"));
        args +=' F_COPY='+quote(ds_list3.getColumn(nRow, "C_CHK"));		 // COPY현장의 경우 확인버튼 활성화

        //구공정과 신공정 구분 기준을 type에서 ver으로 수정 - 2019.03.24 강민석K
        var pType = ds_list3.getColumn(nRow, "TYPE");
        var pVer = ds_list3.getColumn(nRow, "VER");

        trace("pType == " + pType);
		trace("pVer == " + pVer);
        //if( pType == "EL01" || pType == "EL02" || pType == "EL03" || pType == "EL04" || pType == "EL05" || pType == "ES01" ||
	    //    pType == "JC01" || pType == "JC02" || pType == "JC03" || pType == "JC04" || pType == "MW01")  //기존타입
	    if(pVer == "000" || pVer == "")
	    {

			if(ds_list3.getColumn(nRow, "ZZGUBUN") == "10")
			{
				gfn_openPopup("PS0207001B", true, args);
			}
			else if(ds_list3.getColumn(nRow, "ZZGUBUN") == "11")
			{
				gfn_openPopup("PS0207001C", true, args);
			}
			else if(ds_list3.getColumn(nRow, "ZZGUBUN") == "12")
			{
			gfn_openPopup("PS0207001D", true, args);
			}
	   }else{

	      	gfn_openPopUpUrlHdel("PS02::PS0208001B.xml", true, args);

			//trace("입력분_신 공정(표)내역 : " +  ds_detail_n.rowcount );

	   }
    }

     //외주공정표
   	if(nCell == 27)
	{
	       var args = ' F_POSID='+quote(ds_list3.getColumn(nRow, "POSID"));
	           args +=' F_INP='+quote(ds_cond.getColumn(0, "INP_DT"));
	           args +=' F_CHK='+quote(chk);

	      gfn_openPopup("PS0207001E", true, args);

	}

}

}
/********************************************************************************
* 기      능   : 인원 체크 시 투입/ 미투입 /시간 체킹
********************************************************************************/
function grd_list_OnCellClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
     if(nCell == 1)
        {	//  ALERT(ds_list.GetColumn(nRow,"TUIP"));
           if(ds_list.GetColumn(nRow,"CHK") == '1' && ds_list.GetColumn(nRow,"TUIP") <> "Y")
	        {
	            ds_list.SetColumn(nRow, "M_MH", 0);
                ds_list.SetColumn(nRow, "A_MH", 0);
                ds_list.SetColumn(nRow, "N_MH", 0);
                ds_list.SetColumn(nRow, "TUIP_CHKA", '');
                ds_list.SetColumn(nRow, "TUIP_CHKB", '');
                ds_list.SetColumn(nRow, "BIGO", '');
                ds_list.SetColumn(nRow, "SAYU", '');

	           // fn_aftersql2();
	         } else {
                 ufn_sum();
	         }

	    }
}
/********************************************************************************
* 기      능   : 현재 일자 이전 데이터 저장 버튼 비활성화 처리
********************************************************************************/
function cb_inpday_OnChanged(obj,strOldText,strNewText)
{

   var day = gfn_getCurrDate();
   
 //  if(ds_zzlifnr.GetColumn(0,"CHK") == 'X')
   if(ds_cond.GetColumn(0,"INP_DT") < day && ds_zzlifnr.GetColumn(0,"CHK") <> 'X')
   {
      //btn_save.enable = false;
      btn_delete.enable  = false;
   }
   else{
       btn_save.enable = true;
       btn_delete.enable = true;
   }

   if(G_USER_ID = '2016940' or G_USER_ID = '2028786' or  G_USER_ID = '2022702' or  G_USER_ID = '2018900'  or  G_USER_ID = '2028891')
   {
      btn_save.enable = true;
      btn_delete.enable = true;
   }

   fn_tmcd();
}

/********************************************************************************
* 기      능   : 입력 현황 버튼
********************************************************************************/
function btn_input_OnClick(obj)
{
     if(length(ds_cond.getColumn(0, "ZZLIFNR")) <= 0 )
     {
        gfn_showAlert("설치협력사가 선택되지 않았습니다.");
        return;
     }
     if(length(ds_cond.getColumn(0, "INP_DT")) <= 0 )
     {
        gfn_showAlert("투입일자가 선택되지 않았습니다.");
        return;
     }

	      var args  = ' F_LIFNR='+quote(ds_cond.getColumn(0, "ZZLIFNR"));
         args += ' F_INP='+quote(ds_cond.getColumn(0, "INP_DT"));

	     gfn_openPopup("PS0207001G", true, args);
}
/********************************************************************************
* 기      능   : COPY TOOL 추가 --2017.10.24
********************************************************************************/
function btn_copy_OnClick(obj)
{
   //if(G_USER_ID == '2016940' or G_USER_ID == '2022702' or G_USER_ID == '2018900' or G_USER_ID =='2028891')
     //{
       if(length(ds_cond.getColumn(0, "ZZLIFNR")) <= 0 )
        {
          gfn_showAlert("설치협력사가 선택되지 않았습니다.");
           return;
        }
        if(length(ds_cond.getColumn(0, "INP_DT")) <= 0 )
        {
          gfn_showAlert("투입일자가 선택되지 않았습니다.");
          return;
        }
        if(length(ds_cond.getColumn(0, "TMCD")) <= 0 )
        {
          gfn_showAlert("팀장이 선택되지 않았습니다.");
          return;
        }

        var args  = ' F_LIFNR='+quote(ds_cond.getColumn(0, "ZZLIFNR"));
            args += ' F_INP='+quote(ds_cond.getColumn(0, "INP_DT"));
            args += ' F_TMCD='+quote(ds_cond.getColumn(0, "TMCD"));

 	       gfn_openPopup("PS0207001F", true, args);
}





function btn_lifnr_OnClick(obj)
{
	//var arg = ds_list.GetColumn(nRow, "WRKLFN");
	var arg = 'F_ZZACTSS='+quote(ds_cond.getColumn(0, "ZZACTSS"));
	var arr = gfn_openPopup("PS0208001D", true, arg);

	if(Length(arr) > 0)
	{
		//ds_list.fireevent = false;
		ds_cond.SetColumn(0, "ZZLIFNR", arr[0]);
		ds_cond.SetColumn(0, "ZZLIFNR_NM", arr[1]);
		ds_cond.SetColumn(0, "DATE_CHK", arr[2]);
		fn_tmcd();
		//ds_list.fireevent = true;
	}
}

function ds_cond_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{
	if(strColumnID == 'ZZLIFNR_NM')
	{
		if(length(Trim(varNewValue)) == 0)
		{
			ds_cond.SetColumn(0, "ZZLIFNR", "");
			ds_cond.SetColumn(0, "ZZLIFNR_NM", "");
			ds_cond.SetColumn(0, "DATE_CHK", "");
			return;
		}

		// 존재하는 사업자번호 체크 (미존재시 팝업)
		nFindRow = ufn_chkLifnr(varNewValue);

		if(nFindRow < 0)	// 사업자 번호 미존재시 팝업을 띄워준다.
		{
			var arg = "";
			var arr = gfn_openPopup("PS0208001D", true, arg);

			if(Length(arr) > 0)
			{
				ds_cond.SetColumn(0, "ZZLIFNR", arr[0]);
				ds_cond.SetColumn(0, "ZZLIFNR_NM", arr[1]);
				ds_cond.SetColumn(0, "DATE_CHK", arr[2]);
			}

		}
		else
		{
			if(nFindRow == 1)
			{
				ds_cond.SetColumn(0, "ZZLIFNR", ds_lifnr_grid.GetColumn(0, "CODE"));
				ds_cond.SetColumn(0, "ZZLIFNR_NM", ds_lifnr_grid.GetColumn(0, "CODE_NAME"));
				ds_cond.SetColumn(0, "DATE_CHK", ds_lifnr_grid.GetColumn(0, "DATE_CHK"));
			}
			else
			{
				var arg = "F_LIFNR_N="+quote(varNewValue);
				var arr = gfn_openPopup("PS0208001D", true, arg);

				if(Length(arr) > 0)
				{
					ds_cond.SetColumn(0, "ZZLIFNR", arr[0]);
					ds_cond.SetColumn(0, "ZZLIFNR_NM", arr[1]);
					ds_cond.SetColumn(0, "DATE_CHK", arr[2]);
				}
			}

		}
	}
}

function ufn_chkLifnr(lifnr)
{
	var rValue = 0;

	ds_condLifnr.ClearData();
	ds_condLifnr.addRow();
	ds_condLifnr.SetColumn(0, "LIFNR", lifnr);

	tit_clearActionInfo();
	tit_addSearchActionInfo("ps02:PS0208001D_S2");
	tit_callService(
		""
		, ""
		, "ds_cond=ds_condLifnr"
		, "ds_lifnr_grid=ds_lifnr_grid"
		, ""
		, "" // fn_afterQueryC
		, ""
		, ""
		, true);

	if(ds_lifnr_grid.GetRowCount() == 0)
	{
		rValue = -1;
	}
	else
	{
		rValue = ds_lifnr_grid.GetRowCount();
	}

	return rValue;
}

function edt_lifnr_OnKeyDown(obj,nChar,bShift,bCtrl, bAlt,LLParam,HLParam)
{
	if(nChar == 13)
	{
		applyData();
	}
}

function edt_lifnr_OnChanged(obj,strText)
{
	fn_tmcd();
}
]]></Script>
</Window>