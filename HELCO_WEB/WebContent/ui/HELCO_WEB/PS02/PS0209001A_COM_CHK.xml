<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="562" Id="PS209001A" Left="8" OnLoadCompleted="fn_OnLoadCompleted" OnSize="PS0209001A_OnSize" OnUnloadCompleted="fn_OnUnloadCompleted" PidAttrib="7" Title="투입일자별&#32;작업일&#32;조회&#32;및&#32;승인(2019)" Top="8" Ver="1.0" Width="976" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_cond">
				<Contents>
					<colinfo id="PSPID" size="255" summ="default" type="STRING"/>
					<colinfo id="ZZLIFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="INP_DTF" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZACTSS" size="256" summ="default" type="STRING"/>
					<colinfo id="CURR_DATE" size="256" summ="default" type="STRING"/>
					<colinfo id="USER_GRUP" size="256" summ="default" type="STRING"/>
					<colinfo id="USER_CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="G_USER_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZPMNUM" size="256" summ="default" type="STRING"/>
					<colinfo id="POPID" size="256" summ="default" type="STRING"/>
					<colinfo id="SO3" size="256" summ="default" type="STRING"/>
					<colinfo id="SO4" size="256" summ="default" type="STRING"/>
					<colinfo id="CLSSFY" size="256" summ="default" type="STRING"/>
					<record>
						<CLSSFY></CLSSFY>
						<CURR_DATE></CURR_DATE>
						<G_USER_ID></G_USER_ID>
						<INP_DTF></INP_DTF>
						<POPID></POPID>
						<PSPID></PSPID>
						<SO3></SO3>
						<SO4></SO4>
						<USER_CODE></USER_CODE>
						<USER_GRUP></USER_GRUP>
						<ZZACTSS></ZZACTSS>
						<ZZLIFNR></ZZLIFNR>
						<ZZPMNUM></ZZPMNUM>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_zzactss">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME></CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_zzlifnr">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
					<colinfo id="SORTL" size="256" type="STRING"/>
					<colinfo id="LOEVM" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_zzpmnum_cd">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME></CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond_cd">
				<Contents>
					<colinfo id="TEMNO" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZACTSS" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZSAWONNUM" size="256" summ="default" type="STRING"/>
					<colinfo id="TMCD" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZLIFNR" size="256" summ="default" type="STRING"/>
					<record>
						<TEMNO></TEMNO>
						<TMCD></TMCD>
						<ZZACTSS></ZZACTSS>
						<ZZLIFNR></ZZLIFNR>
						<ZZSAWONNUM></ZZSAWONNUM>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond1">
				<Contents>
					<colinfo id="PSPID" size="255" summ="default" type="STRING"/>
					<colinfo id="INP_DTF" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
					<colinfo id="SAFE" size="256" summ="default" type="STRING"/>
					<record>
						<INP_DTF></INP_DTF>
						<POSID></POSID>
						<PSPID></PSPID>
						<SAFE></SAFE>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list3">
				<Contents>
					<colinfo id="PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
					<colinfo id="GUBUN" size="256" summ="default" type="STRING"/>
					<colinfo id="PRONR" size="256" summ="default" type="STRING"/>
					<colinfo id="PROWRK" size="256" summ="default" type="STRING"/>
					<colinfo id="PRO_R" size="256" summ="default" type="STRING"/>
					<colinfo id="SAFE" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list3_tmp">
				<Contents>
					<colinfo id="PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
					<colinfo id="GUBUN" size="256" summ="default" type="STRING"/>
					<colinfo id="PRONR" size="256" summ="default" type="STRING"/>
					<colinfo id="PROWRK" size="256" summ="default" type="STRING"/>
					<colinfo id="PRO_R" size="256" summ="default" type="STRING"/>
					<colinfo id="SAFE" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_pop1"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_pop2"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_pop3"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_pop">
				<Contents></Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list1" OnColumnChanged="ds_list1_OnColumnChanged">
				<Contents>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSPEC1" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSPEC2" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZSHIP1" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZCOMP2" size="256" summ="default" type="STRING"/>
					<colinfo id="PMCD" size="256" summ="default" type="STRING"/>
					<colinfo id="TMCD" size="256" summ="default" type="STRING"/>
					<colinfo id="PRONR" size="256" summ="default" type="STRING"/>
					<colinfo id="PRO_R" size="256" summ="default" type="STRING"/>
					<colinfo id="PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSITE_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZGUBUN" size="256" summ="default" type="STRING"/>
					<colinfo id="INIT_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="M_MH" size="256" summ="default" type="STRING"/>
					<colinfo id="N_MH" size="256" summ="default" type="STRING"/>
					<colinfo id="A_MH" size="256" summ="default" type="STRING"/>
					<colinfo id="SUM_MH" size="256" summ="default" type="STRING"/>
					<colinfo id="NAMEE" size="256" summ="default" type="STRING"/>
					<colinfo id="PROWRK" size="256" summ="default" type="STRING"/>
					<colinfo id="TOT_PRO" size="256" summ="default" type="STRING"/>
					<colinfo id="NAME1" size="256" summ="default" type="STRING"/>
					<colinfo id="NAMET" size="256" summ="default" type="STRING"/>
					<colinfo id="NAMET2" size="256" summ="default" type="STRING"/>
					<colinfo id="CHECK" size="256" summ="default" type="STRING"/>
					<colinfo id="TYPE" size="256" summ="default" type="STRING"/>
					<colinfo id="APPR_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="APP_PRO" size="256" summ="default" type="STRING"/>
					<colinfo id="S_PRO" size="256" summ="default" type="STRING"/>
					<colinfo id="TXT30" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZILSIC" size="256" summ="default" type="STRING"/>
					<colinfo id="TEXT30" size="256" summ="default" type="STRING"/>
					<colinfo id="STEP1_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="STEP2_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="STEP3_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="SAFE" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSPEC" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID_DONG" size="256" summ="default" type="STRING"/>
					<colinfo id="HO_CNT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_save">
				<Contents>
					<colinfo id="FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID_1" size="256" summ="default" type="STRING"/>
					<colinfo id="GUBUN" size="256" summ="default" type="STRING"/>
					<colinfo id="PRONR" size="256" summ="default" type="STRING"/>
					<colinfo id="PROWRK" size="256" summ="default" type="STRING"/>
					<colinfo id="PRO_R" size="256" summ="default" type="STRING"/>
					<colinfo id="CRDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="VER" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_save1">
				<Contents>
					<colinfo id="FLAG" size="256" type="STRING"/>
					<colinfo id="POSID" size="256" type="STRING"/>
					<colinfo id="POSID_1" size="256" type="STRING"/>
					<colinfo id="GUBUN" size="256" type="STRING"/>
					<colinfo id="PRONR" size="256" type="STRING"/>
					<colinfo id="PROWRK" size="256" type="STRING"/>
					<colinfo id="PRO_R" size="256" type="STRING"/>
					<colinfo id="CRDAT" size="256" type="STRING"/>
					<colinfo id="VER" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_save2">
				<Contents>
					<colinfo id="FLAG" size="256" type="STRING"/>
					<colinfo id="POSID" size="256" type="STRING"/>
					<colinfo id="POSID_1" size="256" type="STRING"/>
					<colinfo id="GUBUN" size="256" type="STRING"/>
					<colinfo id="PRONR" size="256" type="STRING"/>
					<colinfo id="PROWRK" size="256" type="STRING"/>
					<colinfo id="PRO_R" size="256" type="STRING"/>
					<colinfo id="CRDAT" size="256" type="STRING"/>
					<colinfo id="VER" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list4">
				<Contents>
					<colinfo id="PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
					<colinfo id="GUBUN" size="256" summ="default" type="STRING"/>
					<colinfo id="PRONR" size="256" summ="default" type="STRING"/>
					<colinfo id="PROWRK" size="256" summ="default" type="STRING"/>
					<colinfo id="PRO_R" size="256" summ="default" type="STRING"/>
					<colinfo id="SAFE" size="256" summ="default" type="STRING"/>
					<colinfo id="POSIDCNT" size="256" summ="default" type="INT"/>
					<colinfo id="POSID_DONG" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list5">
				<Contents></Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond2">
				<Contents>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
					<colinfo id="GUBUN" size="256" summ="default" type="STRING"/>
					<colinfo id="TYPE" size="256" summ="default" type="STRING"/>
					<colinfo id="VER" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond3">
				<Contents>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
					<colinfo id="PSPID" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list2_0">
				<Contents>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSPEC1" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSPEC2" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZSHIP1" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZCOMP2" size="256" summ="default" type="STRING"/>
					<colinfo id="PMCD" size="256" summ="default" type="STRING"/>
					<colinfo id="TMCD" size="256" summ="default" type="STRING"/>
					<colinfo id="PRONR" size="256" summ="default" type="STRING"/>
					<colinfo id="PRO_R" size="256" summ="default" type="STRING"/>
					<colinfo id="PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSITE_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZGUBUN" size="256" summ="default" type="STRING"/>
					<colinfo id="INIT_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="M_MH" size="256" summ="default" type="STRING"/>
					<colinfo id="N_MH" size="256" summ="default" type="STRING"/>
					<colinfo id="A_MH" size="256" summ="default" type="STRING"/>
					<colinfo id="SUM_MH" size="256" summ="default" type="STRING"/>
					<colinfo id="NAMEE" size="256" summ="default" type="STRING"/>
					<colinfo id="PROWRK" size="256" summ="default" type="STRING"/>
					<colinfo id="TOT_PRO" size="256" summ="default" type="STRING"/>
					<colinfo id="NAME1" size="256" summ="default" type="STRING"/>
					<colinfo id="NAMET" size="256" summ="default" type="STRING"/>
					<colinfo id="NAMET2" size="256" summ="default" type="STRING"/>
					<colinfo id="CHECK" size="256" summ="default" type="STRING"/>
					<colinfo id="TYPE" size="256" summ="default" type="STRING"/>
					<colinfo id="APPR_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="APP_PRO" size="256" summ="default" type="STRING"/>
					<colinfo id="S_PRO" size="256" summ="default" type="STRING"/>
					<colinfo id="TXT30" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZILSIC" size="256" summ="default" type="STRING"/>
					<colinfo id="TEXT30" size="256" summ="default" type="STRING"/>
					<colinfo id="STEP1_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="STEP2_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="STEP3_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="SAFE" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSPEC" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID_DONG" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list2" OnColumnChanged="ds_list2_OnColumnChanged">
				<Contents>
					<colinfo id="BUJ" size="30" summ="default" type="STRING"/>
					<colinfo id="CH_FLG" size="0" summ="default" type="STRING"/>
					<colinfo id="CS101_ABG" size="60" summ="default" type="STRING"/>
					<colinfo id="CS101_AGB" size="60" summ="default" type="STRING"/>
					<colinfo id="CS101_BYD" size="24" summ="default" type="STRING"/>
					<colinfo id="CS101_FDT" size="24" summ="default" type="STRING"/>
					<colinfo id="CS101_FYN" size="3" summ="default" type="STRING"/>
					<colinfo id="CS101_HNA" size="90" summ="default" type="STRING"/>
					<colinfo id="CS101_HNO" size="9" summ="default" type="STRING"/>
					<colinfo id="CS101_IJY" size="24" summ="default" type="STRING"/>
					<colinfo id="CS101_PJT" size="18" summ="default" type="STRING"/>
					<colinfo id="CS101_VSD" size="24" summ="default" type="STRING"/>
					<colinfo id="DATE1" size="1" summ="default" type="STRING"/>
					<colinfo id="FLAG" size="0" summ="default" type="STRING"/>
					<colinfo id="IJD" size="24" summ="default" type="STRING"/>
					<colinfo id="JUJ" size="30" summ="default" type="STRING"/>
					<colinfo id="LIFNR" size="1" summ="default" type="STRING"/>
					<colinfo id="NAME1" size="256" summ="default" type="STRING"/>
					<colinfo id="NAMET" size="60" summ="default" type="STRING"/>
					<colinfo id="CELLPT" size="256" summ="default" type="STRING"/>
					<colinfo id="TELF1" size="256" summ="default" type="STRING"/>
					<colinfo id="TELFX" size="256" summ="default" type="STRING"/>
					<colinfo id="NAMET2" size="256" summ="default" type="STRING"/>
					<colinfo id="CELLPT2" size="256" summ="default" type="STRING"/>
					<colinfo id="ORG" size="1" summ="default" type="STRING"/>
					<colinfo id="ORG_BUJ" size="0" summ="default" type="STRING"/>
					<colinfo id="ORG_JUJ" size="0" summ="default" type="STRING"/>
					<colinfo id="PAPRID" size="30" summ="default" type="STRING"/>
					<colinfo id="TEMNO" size="18" summ="default" type="STRING"/>
					<colinfo id="ZMUSAOCNT" size="6" summ="default" type="STRING"/>
					<colinfo id="ZMUSAOCNT2" size="6" summ="default" type="STRING"/>
					<colinfo id="ZMUSAOCNT3" size="11" summ="default" type="INT"/>
					<colinfo id="ZQEGEMSA" size="24" summ="default" type="STRING"/>
					<colinfo id="ZSPEC1" size="15" summ="default" type="STRING"/>
					<colinfo id="ZSPEC2" size="75" summ="default" type="STRING"/>
					<colinfo id="ZSPEC9" size="9" summ="default" type="STRING"/>
					<colinfo id="POSID_OLD" size="256" summ="default" type="STRING"/>
					<colinfo id="DSCODE" size="256" summ="default" type="STRING"/>
					<colinfo id="FNM1" size="256" summ="default" type="STRING"/>
					<colinfo id="FNM2" size="256" summ="default" type="STRING"/>
					<colinfo id="FNM3" size="256" summ="default" type="STRING"/>
					<colinfo id="FNM4" size="256" summ="default" type="STRING"/>
					<colinfo id="FNM1_APP" size="256" summ="default" type="STRING"/>
					<colinfo id="FNM2_APP" size="256" summ="default" type="STRING"/>
					<colinfo id="FNM3_APP" size="256" summ="default" type="STRING"/>
					<colinfo id="FNM4_APP" size="256" summ="default" type="STRING"/>
					<colinfo id="SID" size="256" summ="default" type="STRING"/>
					<colinfo id="STN" size="256" summ="default" type="STRING"/>
					<colinfo id="FDT" size="256" summ="default" type="STRING"/>
					<colinfo id="TDT" size="256" summ="default" type="STRING"/>
					<colinfo id="GAO" size="256" summ="default" type="STRING"/>
					<colinfo id="PUB" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK_HNOINFO" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK_CSTINFO" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
		</Datasets>
		<Shape BKColor="user0" Bottom="56" Height="56" Id="Shape0" Left="2" LineColor="user1" Right="1517" TabOrder="1" Top="0" Type="Rectangle" Width="1515"></Shape>
		<Static Align="Right" DomainID="com.pjtno" Height="20" Id="st_pjt" Left="8" Style="sty_lb_search" TabOrder="2" Text="프로젝트번호&#32;" Top="29" VAlign="Middle" Width="92"></Static>
		<Edit BindDataset="ds_cond" Border="Flat" CheckLength="Byte" Column="PSPID" Height="20" Id="ed_pspid" ImeMode="english" Left="104" MaxLength="6" Style="sty_ipt_search" TabOrder="3" Top="29" UpperOnly="TRUE" Width="78"></Edit>
		<Button Height="18" Id="Button0" ImageID="btn_icon_search" Left="185" OnClick="btn_pjt_OnClick" TabOrder="4" Text="Button0" Top="30" Width="18"></Button>
		<Static Align="Right" Height="20" Id="Static18" Left="208" Style="sty_lb_search" TabOrder="5" Text="사무소&#32;" Top="5" VAlign="Middle" Width="92"></Static>
		<Static Align="Right" Border="Flat" Enable="FALSE" Height="20" Id="Static19" Left="30" Style="sty_ipt_search" TabOrder="6" Top="1668" VAlign="Middle" Visible="FALSE" Width="138"></Static>
		<Checkbox BindDataset="ds_cond" Column="SO4" Enable="FALSE" FalseValue="0" Height="18" Id="chk_so4" Left="135" Style="sty_ipt_search_chk" TabOrder="8" Text="강북팀" Top="1669" TrueValue="1" Visible="FALSE" Width="61"></Checkbox>
		<Checkbox BindDataset="ds_cond" Column="SO3" Enable="FALSE" FalseValue="0" Height="18" Id="chk_so3" Left="66" Style="sty_ipt_search_chk" TabOrder="7" Text="강남팀" Top="1669" TrueValue="1" Visible="FALSE" Width="58"></Checkbox>
		<Static Align="Right" Height="20" Id="st_date" Left="8" Style="sty_lb_search" TabOrder="9" Text="조회일자&#32;" Top="5" VAlign="Middle" Width="92"></Static>
		<Calendar BindDataset="ds_cond" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="INP_DTF" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="ed_inpday_f" Left="104" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_search" SundayTextColor="user35" TabOrder="10" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="5" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="94"></Calendar>
		<Static Align="Right" Height="20" Id="st_zzpmnum" Left="668" Style="sty_lb_search" TabOrder="11" Text="PM&#32;" Top="5" VAlign="Middle" Width="92"></Static>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="CODE" Column="ZZPMNUM" DataColumn="CODE_NAME" Height="20" Id="cb_zzpmnum" InnerDataset="ds_zzpmnum_cd" Left="762" Style="sty_ipt_search" TabOrder="12" Top="5" Width="120"></Combo>
		<Static Align="Right" Height="20" Id="Static2" Left="400" Style="sty_lb_search" TabOrder="13" Text="설치협력사&#32;" Top="5" VAlign="Middle" Width="92"></Static>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="CODE" Column="ZZLIFNR" DataColumn="CODE_NAME" Height="20" Id="cb_zzlifnr" InnerDataset="ds_zzlifnr" Left="496" Style="sty_ipt_search" TabOrder="14" Top="5" Width="162"></Combo>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="CODE" Column="ZZACTSS" DataColumn="CODE_NAME" Height="20" Id="cb_zzactss" InnerDataset="ds_zzactss" Left="302" OnChanged="cb_zzactss_OnChanged" Style="sty_ipt_search" TabOrder="15" Top="5" Width="94"></Combo>
		<Div Border="RaisedEdge" Height="150" Id="Div0" Left="16" TabOrder="16" Text="Div0" Top="1704" Visible="FALSE" Width="577">
			<Contents>
				<Static Color="user7" Font="굴림,8" Height="24" Id="st_dong0" Left="7" TabOrder="1" Text="101동" Top="10" VAlign="Middle" Visible="FALSE" Width="56"></Static>
				<Static Color="user7" Font="굴림,8" Height="24" Id="st_0" Left="7" TabOrder="2" Text="호기&#32;:" Top="50" VAlign="Middle" Visible="FALSE" Width="56"></Static>
				<Static Color="user7" Font="굴림,8" Height="24" Id="st_1" Left="7" TabOrder="3" Text="호기&#32;:" Top="100" VAlign="Middle" Visible="FALSE" Width="56"></Static>
				<Static Align="Center" Color="user7" Font="굴림,9" Height="24" Id="Div0Date0" Left="71" TabOrder="4" Text="2019-01-01" Top="4" VAlign="Middle" Visible="FALSE" Width="144"></Static>
				<Static Align="Center" BKColor="ACTIVECAPTION" Color="user22" Font="굴림,9" Height="20" Id="Div0Title0" Left="71" TabOrder="5" Text="&#32;형판작업" Top="27" VAlign="Middle" Visible="FALSE" Width="144"></Static>
				<Image Border="Flat" Cursor="HAND" FillType="STRETCH" Height="85" Id="Div0Image0" Left="71" OnClick="images_onClickOpenPopup" Static="FALSE" TabOrder="6" TabStop="FALSE" Top="54" UserData="0" Visible="FALSE" Width="144"></Image>
				<Button Cursor="HAND" Height="18" Id="btn_openFile" ImageID="btn_icon_search" Left="47" OnClick="btn_openFile_OnClick" TabOrder="7" Text="Button0" Top="6" Visible="FALSE" Width="18"></Button>
			</Contents>
		</Div>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_picture" ImageID="btn_user_05" Left="1376" LeftMargin="12" OnClick="btn_picture_OnClick" Style="sty_btn" TabOrder="18" TabStop="FALSE" Text="&#32;사진보기" Top="8" Transparent="TRUE" Visible="FALSE" Width="80"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_gisung_save" ImageID="btn_user_03" Left="1456" LeftMargin="12" OnClick="btn_gisung_save_OnClick" Style="sty_btn" TabOrder="17" TabStop="FALSE" Text="&#32;저장" Top="8" Transparent="TRUE" Visible="FALSE" Width="59"></Button>
		<Div Border="RaisedEdge" BorderColor="user23" Height="808" Id="divImage" Left="1208" scroll="true" TabOrder="19" Text="Div0" Top="80" Visible="FALSE" Width="309">
			<Contents>
				<Static Align="Center" Color="user7" Font="굴림,9" Height="24" Id="div_date1" Left="7" TabOrder="1" Text="2019-01-01" Top="2" VAlign="Middle" Visible="FALSE" Width="135"></Static>
				<Static Align="Center" BKColor="ACTIVECAPTION" Color="user22" Font="굴림,9" Height="20" Id="div_pro_name1" Left="7" TabOrder="2" Text="&#32;형판작업" Top="25" VAlign="Middle" Visible="FALSE" Width="135"></Static>
				<Image Border="Flat" Cursor="HAND" FillType="STRETCH" Height="240" Id="Image1" Left="7" OnClick="images_onClickOpenPopup" Static="FALSE" TabOrder="3" TabStop="FALSE" Top="49" UserData="0" Visible="FALSE" Width="135"></Image>
				<Image Border="Flat" Cursor="HAND" FillType="STRETCH" Height="240" Id="Image2" Left="148" OnClick="images_onClickOpenPopup" Static="FALSE" TabOrder="4" TabStop="FALSE" Top="49" UserData="0" Visible="FALSE" Width="135"></Image>
				<Static Align="Center" Color="user7" Font="굴림,9" Height="24" Id="div_date2" Left="147" TabOrder="5" Text="2019-01-01" Top="2" VAlign="Middle" Visible="FALSE" Width="135"></Static>
				<Static Align="Center" BKColor="ACTIVECAPTION" Color="user22" Font="굴림,9" Height="20" Id="div_pro_name2" Left="147" TabOrder="6" Text="&#32;형판작업" Top="25" VAlign="Middle" Visible="FALSE" Width="135"></Static>
				<Static Align="Center" Color="user7" Font="굴림,9" Height="24" Id="div_date3" Left="7" TabOrder="7" Text="2019-01-01" Top="290" VAlign="Middle" Visible="FALSE" Width="135"></Static>
				<Static Align="Center" BKColor="ACTIVECAPTION" Color="user22" Font="굴림,9" Height="20" Id="div_pro_name3" Left="7" TabOrder="8" Text="&#32;형판작업" Top="313" VAlign="Middle" Visible="FALSE" Width="135"></Static>
				<Image Border="Flat" Cursor="HAND" FillType="STRETCH" Height="240" Id="Image3" Left="7" OnClick="images_onClickOpenPopup" Static="FALSE" TabOrder="9" TabStop="FALSE" Top="337" UserData="0" Visible="FALSE" Width="135"></Image>
				<Image Border="Flat" Cursor="HAND" FillType="STRETCH" Height="240" Id="Image4" Left="148" OnClick="images_onClickOpenPopup" Static="FALSE" TabOrder="10" TabStop="FALSE" Top="337" UserData="0" Visible="FALSE" Width="135"></Image>
				<Static Align="Center" Color="user7" Font="굴림,9" Height="24" Id="div_date4" Left="147" TabOrder="11" Text="2019-01-01" Top="290" VAlign="Middle" Visible="FALSE" Width="135"></Static>
				<Static Align="Center" BKColor="ACTIVECAPTION" Color="user22" Font="굴림,9" Height="20" Id="div_pro_name4" Left="147" TabOrder="12" Text="&#32;형판작업" Top="313" VAlign="Middle" Visible="FALSE" Width="135"></Static>
				<Static Align="Center" Color="user7" Font="굴림,9" Height="24" Id="div_date5" Left="7" TabOrder="13" Text="2019-01-01" Top="580" VAlign="Middle" Visible="FALSE" Width="135"></Static>
				<Static Align="Center" BKColor="ACTIVECAPTION" Color="user22" Font="굴림,9" Height="20" Id="div_pro_name5" Left="11" TabOrder="14" Text="&#32;형판작업" Top="602" VAlign="Middle" Visible="FALSE" Width="135"></Static>
				<Image Border="Flat" Cursor="HAND" FillType="STRETCH" Height="240" Id="Image5" Left="7" OnClick="images_onClickOpenPopup" Static="FALSE" TabOrder="15" TabStop="FALSE" Top="626" UserData="0" Visible="FALSE" Width="135"></Image>
				<Image Border="Flat" Cursor="HAND" FillType="STRETCH" Height="240" Id="Image6" Left="148" OnClick="images_onClickOpenPopup" Static="FALSE" TabOrder="16" TabStop="FALSE" Top="626" UserData="0" Visible="FALSE" Width="135"></Image>
				<Static Align="Center" Color="user7" Font="굴림,9" Height="24" Id="div_date6" Left="147" TabOrder="17" Text="2019-01-01" Top="580" VAlign="Middle" Visible="FALSE" Width="135"></Static>
				<Static Align="Center" BKColor="ACTIVECAPTION" Color="user22" Font="굴림,9" Height="20" Id="div_pro_name6" Left="147" TabOrder="18" Text="&#32;형판작업" Top="602" VAlign="Middle" Visible="FALSE" Width="135"></Static>
				<Image Border="Flat" Cursor="HAND" FillType="STRETCH" Height="240" Id="Image8" Left="150" OnClick="images_onClickOpenPopup" Static="FALSE" TabOrder="22" TabStop="FALSE" Top="914" UserData="0" Visible="FALSE" Width="135"></Image>
				<Static Align="Center" BKColor="ACTIVECAPTION" Color="user22" Font="굴림,9" Height="20" Id="div_pro_name8" Left="149" TabOrder="24" Text="&#32;형판작업" Top="891" VAlign="Middle" Visible="FALSE" Width="135"></Static>
				<Image Border="Flat" Cursor="HAND" FillType="STRETCH" Height="240" Id="Image10" Left="150" OnClick="images_onClickOpenPopup" Static="FALSE" TabOrder="28" TabStop="FALSE" Top="1201" UserData="0" Visible="FALSE" Width="135"></Image>
				<Static Align="Center" Color="user7" Font="굴림,9" Height="24" Id="div_date10" Left="149" TabOrder="29" Text="2019-01-01" Top="1155" VAlign="Middle" Visible="FALSE" Width="135"></Static>
				<Static Align="Center" BKColor="ACTIVECAPTION" Color="user22" Font="굴림,9" Height="20" Id="div_pro_name10" Left="149" TabOrder="30" Text="&#32;형판작업" Top="1178" VAlign="Middle" Visible="FALSE" Width="135"></Static>
				<Static Align="Center" Color="user7" Font="굴림,9" Height="24" Id="div_date12" Left="149" TabOrder="34" Text="2019-01-01" Top="1443" VAlign="Middle" Visible="FALSE" Width="135"></Static>
				<Static Align="Center" BKColor="ACTIVECAPTION" Color="user22" Font="굴림,9" Height="20" Id="div_pro_name12" Left="149" TabOrder="35" Text="&#32;형판작업" Top="1465" VAlign="Middle" Visible="FALSE" Width="135"></Static>
				<Static Align="Center" Color="user7" Font="굴림,9" Height="24" Id="div_date7" Left="9" TabOrder="19" Text="2019-01-01" Top="868" VAlign="Middle" Visible="FALSE" Width="135"></Static>
				<Static Align="Center" BKColor="ACTIVECAPTION" Color="user22" Font="굴림,9" Height="20" Id="div_pro_name7" Left="9" TabOrder="20" Text="&#32;형판작업" Top="891" VAlign="Middle" Visible="FALSE" Width="135"></Static>
				<Image Border="Flat" Cursor="HAND" FillType="STRETCH" Height="240" Id="Image7" Left="9" OnClick="images_onClickOpenPopup" Static="FALSE" TabOrder="21" TabStop="FALSE" Top="914" UserData="0" Visible="FALSE" Width="135"></Image>
				<Static Align="Center" Color="user7" Font="굴림,9" Height="24" Id="div_date8" Left="149" TabOrder="23" Text="2019-01-01" Top="868" VAlign="Middle" Visible="FALSE" Width="135"></Static>
				<Static Align="Center" Color="user7" Font="굴림,9" Height="24" Id="div_date9" Left="9" TabOrder="25" Text="2019-01-01" Top="1155" VAlign="Middle" Visible="FALSE" Width="135"></Static>
				<Static Align="Center" BKColor="ACTIVECAPTION" Color="user22" Font="굴림,9" Height="20" Id="div_pro_name9" Left="9" TabOrder="26" Text="&#32;형판작업" Top="1178" VAlign="Middle" Visible="FALSE" Width="135"></Static>
				<Image Border="Flat" Cursor="HAND" FillType="STRETCH" Height="240" Id="Image9" Left="9" OnClick="images_onClickOpenPopup" Static="FALSE" TabOrder="27" TabStop="FALSE" Top="1201" UserData="0" Visible="FALSE" Width="135"></Image>
				<Static Align="Center" Color="user7" Font="굴림,9" Height="24" Id="div_date11" Left="9" TabOrder="31" Text="2019-01-01" Top="1443" VAlign="Middle" Visible="FALSE" Width="135"></Static>
				<Image Border="Flat" Cursor="HAND" FillType="STRETCH" Height="240" Id="Image12" Left="150" OnClick="images_onClickOpenPopup" Static="FALSE" TabOrder="33" TabStop="FALSE" Top="1488" UserData="0" Visible="FALSE" Width="135"></Image>
				<Static Align="Center" BKColor="ACTIVECAPTION" Color="user22" Font="굴림,9" Height="20" Id="div_pro_name11" Left="13" TabOrder="32" Text="&#32;형판작업" Top="1465" VAlign="Middle" Visible="FALSE" Width="135"></Static>
				<Image Border="Flat" Cursor="HAND" FillType="STRETCH" Height="240" Id="Image11" Left="9" OnClick="images_onClickOpenPopup" Static="FALSE" TabOrder="36" TabStop="FALSE" Top="1488" UserData="0" Visible="FALSE" Width="135"></Image>
			</Contents>
		</Div>
		<Grid AreaSelect="TRUE" AutoFitEndLine="Hide" BindDataset="ds_list1" BkColor2="default" BoldHead="true" Border="Flat" Bottom="888" ColSelect="TRUE" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="30" Height="828" Id="grd_list1" InputPanel="FALSE" Left="2" LineColor="user20" LineType="ExHORZ" OnCellClick="ds_list1_OnCellClick" OnCellDBLClick="grd_list1_OnCellDblClick" OnHeadClick="grd_list1_OnHeadClick" OnKeyDown="grd_list1_OnKeyDown" Right="608" RowHeight="20" Style="sty_grid" TabOrder="20" TabStop="true" Top="60" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="606">
			<contents>
				<format id="Default">
					<columns>
						<col fix="left" width="30"/>
						<col fix="left" width="58"/>
						<col fix="left" width="153"/>
						<col fix="left" width="80"/>
						<col fix="left" width="128"/>
						<col fix="left" width="59"/>
						<col fix="left" width="73"/>
					</columns>
					<head>
						<cell col="0" display="text" font="굴림,9" text="No"/>
						<cell align="center" col="1" color="user21" display="text" font="굴림,9" text="프로젝트"/>
						<cell align="center" col="2" color="user21" display="text" font="굴림,9" text="현장명"/>
						<cell align="center" col="3" color="user21" display="text" font="굴림,9" text="호기"/>
						<cell align="center" col="4" color="user21" display="text" font="굴림,9" scrollbar="both" text="협력업체"/>
						<cell align="center" col="5" color="user21" display="text" font="굴림,9" scrollbar="both" text="작업팀장"/>
						<cell align="center" col="6" color="user21" display="text" font="굴림,9" text="일보누계(%)"/>
					</head>
					<body>
						<cell align="center" col="0" colid="no" display="text" edit="normal" expr="currow+1"/>
						<cell align="center" bkcolor2="user22" col="1" colid="PSPID" display="text" suppress="1"/>
						<cell align="left" bkcolor2="user22" col="2" colid="ZSITE_NM" display="text" suppress="2"/>
						<cell align="center" bkcolor2="user22" col="3" colid="POSID" display="text"/>
						<cell align="left" bkcolor2="user22" col="4" colid="NAME1" display="text"/>
						<cell align="center" bkcolor2="user22" col="5" colid="NAMET2" display="text"/>
						<cell align="right" bkcolor2="user22" col="6" colid="TOT_PRO" display="number" Mask="expr:&apos;#0.0&apos;"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Tab Height="58" Id="Tab00" Left="608" TabIndex="1" TabOrder="21" Top="1706" Visible="FALSE" Width="81">
			<Contents>
				<TabPage Height="35" Id="tab00" Left="2" TabOrder="22" Text="tab1" Top="21" Width="77"></TabPage>
				<TabPage Height="35" Id="tab2" Left="2" TabOrder="22" Text="tab2" Top="21" Width="77"></TabPage>
			</Contents>
		</Tab>
		<Static Height="16" Id="Static16" Left="632" TabOrder="22" Text="Static0" Top="1793" Visible="FALSE" Width="67"></Static>
		<Grid AreaSelect="true" AutoFitEndLine="Hide" BindDataset="ds_pop" BkColor2="default" BoldHead="true" Border="Flat" Bottom="888" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="828" HScrollCell="TRUE" Id="grd_pop" InputPanel="FALSE" Left="612" LineColor="user20" LineType="ExHORZ" OnCellClick="grd_pop_OnCellClick" Right="1205" ScrollCell="true" Style="sty_grid" TabOrder="23" TabStop="true" Top="60" UseAutoSizing="Row" UseDBuff="true" UseExprCache="Row" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="593">
			<contents>
				<format id="Default">
					<columns>
						<col fix="left" width="30"/>
						<col fix="left" width="263"/>
						<col fix="left" width="65"/>
						<col fix="left" width="65"/>
						<col fix="left" width="65"/>
						<col fix="left" width="80"/>
					</columns>
					<head>
						<cell col="0" display="text" font="굴림,9" text="NO"/>
						<cell col="1" display="text" font="굴림,9" text="DESCRIPTION"/>
						<cell col="2" display="text" font="굴림,9" text="공정율"/>
						<cell col="3" display="text" font="굴림,9" text="누계"/>
						<cell col="4" display="text" font="굴림,9" text="완료"/>
						<cell col="5" display="text" edit="expr:decode(COL0,&#32;&apos;0&apos;,&#32;&apos;checkbox&apos;,&#32;&apos;1&apos;,decode(JCOL0,&apos;0&apos;,&apos;none&apos;,&#32;&apos;1&apos;,&#32;&apos;checkbox&apos;,&apos;none&apos;),&#32;&apos;none&apos;)" font="굴림,9" text="기성"/>
					</head>
					<body>
						<cell align="center" bkcolor="expr:decode(UPLOAD_YN,&#32;&apos;Y&apos;,&#32;&apos;pink&apos;,&#32;&apos;F&apos;,&#32;&apos;lightgreen&apos;,&#32;&apos;default&apos;)" col="0" display="text" expr="currow+1"/>
						<cell bkcolor="expr:decode(UPLOAD_YN,&#32;&apos;Y&apos;,&#32;&apos;pink&apos;,&#32;&apos;F&apos;,&#32;&apos;lightgreen&apos;,&#32;&apos;default&apos;)" col="1" colid="PROWRK" display="text"/>
						<cell align="right" bkcolor="expr:decode(UPLOAD_YN,&#32;&apos;Y&apos;,&#32;&apos;pink&apos;,&#32;&apos;F&apos;,&#32;&apos;lightgreen&apos;,&#32;&apos;default&apos;)" col="2" colid="PRO_R" display="number" Mask="expr:&apos;#0.0&apos;"/>
						<cell align="right" bkcolor="expr:decode(UPLOAD_YN,&#32;&apos;Y&apos;,&#32;&apos;pink&apos;,&#32;&apos;F&apos;,&#32;&apos;lightgreen&apos;,&#32;&apos;default&apos;)" col="3" colid="PRO_SUM" display="number" Mask="expr:&apos;#0.0&apos;"/>
						<cell bkcolor="expr:decode(COM_CHK,&#32;&apos;1&apos;,&#32;&apos;user34&apos;,&#32;&apos;default&apos;)" bkcolor2="expr:decode(COM_CHK,&#32;&apos;1&apos;,&#32;&apos;user34&apos;,&#32;&apos;user22&apos;)" col="4" colid="COM_CHK" display="checkbox"/>
						<cell bkcolor="expr:iif(COM_CHK&#32;==&#32;&apos;1&apos;&#32;&amp;&amp;&#32;PROCESS_BY_SAFE_NUM&#32;&lt;=&#32;F_SAFE_NUM,&#32;&apos;user34&apos;,&#32;&apos;default&apos;)" col="5" colid="COL" color="expr:iif(COM_CHK&#32;==&#32;&apos;1&apos;&#32;&amp;&amp;&#32;parseInt(PROCESS_BY_SAFE_NUM)&#32;&lt;=&#32;parseInt(F_SAFE_NUM),&#32;&apos;white&apos;,&#32;&apos;default&apos;)" display='expr:decode(COL,&#32;&apos;1&apos;,&#32;&quot;checkbox&quot;,&#32;&apos;0&apos;,iif(COM_CHK&#32;==&#32;&apos;1&apos;&#32;&amp;&amp;&#32;toNumber(PROCESS_BY_SAFE_NUM)&#32;&lt;=&#32;toNumber(F_SAFE_NUM),&#32;&quot;checkbox&quot;,&#32;&quot;normal&quot;),&#32;&apos;normal&apos;)' edit='expr:decode(COL,&#32;&apos;1&apos;,&#32;&quot;checkbox&quot;,&#32;&apos;0&apos;,&#32;iif(COM_CHK&#32;==&#32;&apos;1&apos;&#32;&amp;&amp;&#32;toNumber(PROCESS_BY_SAFE_NUM)&#32;&lt;=&#32;toNumber(F_SAFE_NUM),&#32;&quot;checkbox&quot;,&#32;&quot;none&quot;),&#32;&apos;none&apos;)' expr="decode(COL,&#32;&apos;0&apos;,&#32;&apos;&apos;,&#32;&apos;1&apos;,&#32;&apos;1&apos;,&#32;COL)" Mask="expr:decode(COL,&#32;&apos;0&apos;,&#32;&apos;0&apos;,&#32;&apos;1&apos;,&#32;&apos;1&apos;,&#32;&apos;####.##.##&apos;)"/>
					</body>
					<summary>
						<cell align="center" bkcolor="user27" col="0" color="user26" colspan="4" display="text" text="당일&#32;누계&#32;공정율"/>
						<cell bkcolor="user27" col="4" color="user26" display="number" Mask="expr:&apos;#0.0&apos;"/>
						<cell bkcolor="user27" col="5" color="user26" display="number" Mask="expr:&apos;#0.0&apos;"/>
					</summary>
				</format>
			</contents>
		</Grid>
		<Static Align="Center" BKColor="#daedf5" Border="Flat" BorderColor="user13" Color="black" Font="굴림,9" Height="22" Id="Static0" Left="1208" TabOrder="23" Text="작업완료&#32;사진" Top="60" VAlign="Middle" Width="309"></Static>
		<FileDialog Bottom="24" Filter="All(*.*)|*.*|jpg&#32;File(*.jpg)|*.jpg|jpeg&#32;File(*.jpeg)|*.jpeg|bmp&#32;File(*.bmp)|*.jpeg|gif&#32;File(*.gif)|*.gif|png&#32;File(*.png)|*.png|pdf&#32;File(*.pdf)|*.pdf|" Height="24" Id="saveDialog" Left="1528" Right="1552" TabOrder="24" Type="Save" Width="24"></FileDialog>
		<CyHttpFile Height="24" Id="httpFile" Left="1560" Width="24"></CyHttpFile>
		<Static BKColor="pink" Height="16" Id="Static1" Left="613" TabOrder="25" Top="36" Width="30"></Static>
		<Static BKColor="lightgreen" Height="16" Id="Static3" Left="790" TabOrder="26" Top="36" Width="30"></Static>
		<Static Height="16" Id="Static4" Left="650" TabOrder="27" Text="사진" Top="36" VAlign="Middle" Width="27"></Static>
		<Static Height="16" Id="Static5" Left="756" TabOrder="28" Text="공정" Top="36" VAlign="Middle" Width="30"></Static>
		<Static Color="red" Font="Tahoma,9,Bold,Italic" Height="16" Id="Static6" Left="678" TabOrder="29" Text="업로드&#32;대상" Top="36" VAlign="Middle" Width="72"></Static>
		<Static Height="16" Id="Static7" Left="930" TabOrder="31" Text="공정" Top="36" VAlign="Middle" Width="27"></Static>
		<Static Color="red" Font="Tahoma,9,Bold,Italic" Height="16" Id="Static8" Left="855" TabOrder="32" Text="업로드&#32;완료" Top="36" VAlign="Middle" Width="72"></Static>
		<Static Height="16" Id="Static9" Left="827" TabOrder="30" Text="사진" Top="36" VAlign="Middle" Width="27"></Static>
	</Form>
	<Script><![CDATA[/*
 *****************************************************************************************
 * 기      능   : 
 * 작  성  자   : 
 * 작성  일자   : 
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
#include "LIB::commons.js";	// 공통 스크립트 
//=========================================================================================
// [ PART 1 ]
// Form에서 사용될 전역변수를 선언
// FORM에서 사용되는 전역변수는 대문자로 작성하며, F_XXX 의 형태를 갖도록 한다. 
//=========================================================================================
var userGroup = "";
var args = "";
var curr_date = "";
var _GUBUN = "";
var _P_POSID = "";
var _P_GUBUN = "";
var _P_TYPE = "";
var _P_VER = "";
var _P_SAFE = "";
var _P_ZSPEC = "";
var _P_CHK = "";
var E_FLAG = "";
var _TABGUBUN = "";
var prev_row = -1;//호기 리스트에서 키보드 이동 시 조회 기능 추가 - 2019.03.14 강민석K
var dblclick_row = -1;//협력업체, 작업팀장 선택 시 선택한 협력업체 정보가 표시되도록 수정 - 2019.03.21 강민석K

//var userGroup = "";
//=========================================================================================
// [ PART 2 ]
// Form Loading / Unloading 시 작업 정의
//=========================================================================================
function fn_OnLoadCompleted(obj) 
{
	// Form 로드 이벤트 맨 첫줄에 기술 
	gfn_initForm(false);
	
	userGroup = gfn_getUserGroup();
	
	ed_inpday_f.value = gfn_getCurrDate();

	ds_cond.SetColumn(0,"USER_GRUP",userGroup);
	if (userGroup == "10")
	{
		ds_cond.SetColumn(0,"USER_CODE",G_VEND_CODE_E);
	}
	else if (userGroup == "20")
	{
		ds_cond.SetColumn(0,"USER_CODE",G_USER_ID);
	}
	else if (userGroup == "30")
	{
		ds_cond.SetColumn(0,"USER_CODE",G_AREA_CODE_E);
	}
	
	var codeArr = ["PS003"];
    var dsObjArr = [ds_zzactss];
    var addTypeArr = [G_CODE_ALL];
    gfn_searchCommCode(codeArr, dsObjArr, addTypeArr);
	
	initImage();
	
	ds_cond.SetColumn(0, "CLSSFY", 'A');
	
	tit_clearActionInfo();
	tit_addSearchActionInfo("ps02:PS0201001A_S34");
	//tit_addSearchActionInfo("ps02:PS0205001A_S8");      //공정 코드

	tit_callService(
		""
		, ""
		, "ds_cond=ds_cond"
		, "ds_zzlifnr=ds_zzlifnr_cd"  // ds_pronr=ds_pronr"
		, ""
		, "fn_afterQueryC"
		, ""
		, ""
		, true);
	
	ed_inpday_f.SETFOCUS();
	gfn_showMsg("CI00007");
	
	//trace("AS-IS 투입일자별 작업일보 조회 및 승인 화면에서 넘겨준 프로젝트 번호(F_PSPID) : " + F_PSPID);
	if( length(F_PSPID) > 0 )  //프로젝트 번호가 넘어왔을때
	{
		ds_cond.SetColumn(ds_cond.row, "PSPID", F_PSPID);
		fn_query();
	}
}

/********************************************************************************
* 기      능   :  이미지 초기화 - 추가 2019.03.11 강민석K
********************************************************************************/
function initImage() {
	for(var i = 0; i < 12; i++)
	{
		//투입일자
		eval("divImage.div_date" + (i + 1)).Text = "";
		eval("divImage.div_date" + (i + 1)).Visible = false;
		
		//공정명
		eval("divImage.div_pro_name" + (i + 1)).Text = "";
		eval("divImage.div_pro_name" + (i + 1)).Visible = false;
		
		//이미지
		eval("divImage.Image" + (i + 1)).ImageID = "";
		eval("divImage.Image" + (i + 1)).Visible = false;
		divImage.Visible = true;
	}

	divImage.SetScroll(0, 0);
}

/********************************************************************************
* 기      능   :  협력사 조회 Callback  
********************************************************************************/
function fn_afterQueryC(errCode, errMsg) {
	cb_zzlifnr.Index = 0;

	if ( userGroup == "10" )
	{
		cb_zzlifnr.Enable = false;
	}
	else if ( userGroup == "30" || userGroup == "40")
	{
		ds_zzlifnr.filter("LOEVM!='X'" );		
		gfn_insertEmptyRow( ds_zzlifnr, G_CODE_ALL );
		cb_zzlifnr.value = "";
	}
}

/********************************************************************************
* 기      능   : 공통코드가 조회된 후의 Callback 함수 
********************************************************************************/
function fn_completeInit(sCode, sDsObj, sCodeType) 
{
	if(userGroup == "40")
	{
		cb_zzactss.Index = 0;
		cb_zzactss.Enable = true;
	}
	else if(userGroup == "30")
	{
		ds_zzactss.Filter("CODE="+quote(G_AREA_CODE_E));
		cb_zzactss.Index = 0;
		cb_zzactss.Enable = false;
	}
	else if(userGroup == "10")
	{
		cb_zzactss.Index = 0;
		cb_zzactss.Enable = false;
	}
}

/********************************************************************************
* 기      능   : form UnloadCompleted 
********************************************************************************/
function fn_OnUnloadCompleted(obj) 
{
	return gfn_isFormUnload(obj);
}

//=========================================================================================
// [ PART 3 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,form닫기)
//=========================================================================================
/********************************************************************************
* 기      능   : 조회
********************************************************************************/
function fn_query() 
{
	// 투입일자 필수 
	if(gfn_isNull(ed_inpday_f, true, st_date.value))  return;	
   
	tit_clearActionInfo();	
	tit_addSearchActionInfo("ps02:PS0209003A_S1");//==> 예전 PS0207003A_S1.xml
	//tit_addCsvSearchActionInfo("ps02:PS0207003A_S1"); 
	
	tit_callService(
          ""
        , ""
        , "ds_cond=ds_cond"
        , "ds_list1=ds_list1"  
        , ""
        , "fn_afterQuery"
        , ""
        , ""
        , true);
}

/********************************************************************************
* 기      능   : 조회 Callback 
********************************************************************************/
function fn_afterQuery(errCode, errMsg)
{
	//trace("fn_afterQuery F_POSID (이전화면에서 넘겨준 호기번호) : " + F_POSID);
	//trace("fn_afterQuery _P_POSID (최근에 리스트에서 선택했던 호기번호) : " + _P_POSID);
	
	if( length(_P_POSID) > 0 || length(F_POSID) > 0 )  //호기번호가 있을때 
	{
		var POSID = "";
		if(length(F_POSID) > 0){
			POSID = F_POSID;
			F_POSID = "";//이전화면에서 넘겨준 호기번호는 한번 쓰고 초기화해야 재조회 시 사요하지 않는다 - 2019.03.15 강민석K
		}else{
			POSID = _P_POSID;
		}
		
		ds_list1.row = ds_list1.FindRow("POSID", POSID);
		grd_list1.SetCellPos(3);
		
		ds_list1_OnCellClick('', ds_list1.row, 3, '', '', '');//공정표 그리기 호출
	}
	
	gfn_showSearchMsg(ds_list1, errCode, errMsg);
}

/********************************************************************************
* 기      능   : 닫기 
********************************************************************************/
function fn_close() 
{
	close();
}

//=========================================================================================
// [ PART 6 ]
// component Event 정의 : 각 Component 별 이벤트 
//=========================================================================================
/********************************************************************************
* 기      능   : 원프로젝트 팝업
********************************************************************************/
function btn_pjt_OnClick(obj)
{
	var arg = "pjt="+quote(ed_pjt.Text);
	
	gfn_openPopup("CS9601002A",true,arg);
	
	fn_query();
}

/********************************************************************************
* 기      능   : 리스트의 타이틀 클릭  
********************************************************************************/
function grd_list1_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
{
	if ( nCell == 0 ) {
		return;
	}
	else if ( nCell == 1 ) {
		// 그리드 표시할 컬럼 선택 
		gfn_selectAllGrid(obj,nCell,nCell,true);
	} else {
		// 그리드 정렬 처리 
		gfn_sortGrid(obj,nCell);
	}	
}

/********************************************************************************
* 기      능   : 프로젝트에서 엔터키 처리 
********************************************************************************/
function ed_pjt_OnKeyDown(obj,nChar,bShift,bCtrl, bAlt,LLParam,HLParam)
{
}

/********************************************************************************
* 기      능   : 저장
********************************************************************************/
function fn_save() 
{
	//강민석K 수정
	if (!gfn_showConfirm("CW10025","저장하시겠습니까?")) 
	{
		return;
	}
	
	//trace(ds_pop.SaveXML());	
	ds_save.deleteAll();
	// ds_pop.Filter("COL=='1'");
	ds_save.copyF(ds_pop);
	//ds_pop.unFilter();
	
	//trace("ds_save GetRowCount : " + ds_save.GetRowCount());
   
	for(var j=0; j<ds_save.GetRowCount(); j++)
	{
		ds_save.SetColumn(j,"PSPID", substr(_P_POSID,0,6));
		ds_save.SetColumn(j,"POSID", _P_POSID);
		ds_save.SetColumn(j,"GUBUN", _P_GUBUN);
       	if(ds_save.GetColumn(j, "COL")=="1"  && ds_save.GetColumn(j, "B_COL")=="N"){
       		//alert("a");
			ds_save.SetColumn(j, "FLAG", "I");
		} else if(ds_save.GetColumn(j, "COL")=="0" && ds_save.GetColumn(j, "B_COL")=="Y") {
			//alert("b");
			ds_save.SetColumn(j, "FLAG", "D");
		}
	}
	
	//trace("ds_save : " + ds_save.SaveXML());

	//trace(ds_save.SaveXML());	
	//trace(ds_pop.SaveXML());	
	ds_save1.deleteAll();
	ds_save.Filter("FLAG == 'I'");
	ds_save1.copyF(ds_save);
	ds_pop.unFilter();
 
	ds_save2.deleteAll();
	ds_save.Filter("FLAG == 'D'");
	ds_save2.copyF(ds_save); 
	ds_pop.unFilter();
  
	//trace(ds_save1.SaveXML());	
	//trace(ds_save2.SaveXML());	
	if(ds_save1.rowcount > 0) 
	{
		tit_clearActionInfo();
		tit_addMultiActionInfo("ps02:PS0207003C_I1");//zpst0112
		tit_callService(
			""
			, ""
			, "ds_save1=ds_save1"
			, ""
			, ""
			, ""
			, ""
			, ""
			, true  // ""
		);
	}
	
	if(ds_save2.rowcount > 0) 
	{
		tit_clearActionInfo();
		tit_addMultiActionInfo("ps02:PS0207003C_D1");//zpst0112
		tit_callService(
			""
			, ""
			, "ds_save2=ds_save2"
			, ""
			, ""
			, ""
			, ""
			, ""
			, true  // ""
		);
	}
    
    F_CHK2 = 'Y'; // 저장 시 체크값 변경 
	fn_query();
	
	/*
	//기존 김기석K 개발 소스
	// 그리드 저장 대상 로우
	if(ds_list1.FindRow("CHECK", 1)==-1){
		gfn_showMsg('CW00046');
		return;
	}
   
    if (!gfn_showConfirm("CW10025","승인하시겠습니까?")) 
	{
		return;
	}
	
    ds_list3_tmp.ClearData();	
	ds_list1.Filter("CHECK==1");
	ds_list2_0.copyF(ds_list1);
    ds_list1.unFilter();
     
    for(var i=0;i<ds_list2_0.GetRowCount();i++)
    {
		if(ds_cond1.GetRowCount()==0)	ds_cond1.AddRow();
      
        ds_list3.ClearData();
        
        ds_cond1.SetColumn(0,"INP_DTF",ds_cond.GetColumn(0,"INP_DTF"));
        ds_cond1.SetColumn(0,"PSPID",ds_list2_0.GetColumn(i,"PSPID"));
        ds_cond1.SetColumn(0,"POSID",ds_list2_0.GetColumn(i,"POSID"));
        ds_cond1.SetColumn(0,"SAFE",ds_list2_0.GetColumn(i,"SAFE"));
           
              
        tit_clearActionInfo();
		tit_addSearchActionInfo("ps02:PS0207003A_S2");
		tit_callService(
			  ""
			, ""
			, "ds_cond1=ds_cond1"
			, "ds_list3=ds_list3"
			, ""
			, ""
			, ""
			, ""
			, true);
		 
		ds_list3_tmp.AppendDataset(ds_list3);
    }
    
	if(ds_list2_0.GetRowCount() > 0){
	    tit_clearActionInfo();
        tit_addMultiActionInfo("ps02:PS0207003A_I1");
        tit_callService(
			  ""	
			, ""
			, "ds_list2_0=ds_list2"
			, ""
			, ""
			, ""//"fn_afterSave"
			, ""
			, ""
			, true  // ""
        );
	}
	
	if(ds_list3_tmp.GetRowCount() > 0){
		tit_clearActionInfo();
        tit_addMultiActionInfo("ps02:PS0207003A_I2");
        tit_callService(
			  ""	
			, ""
			, "ds_list3_tmp=ds_list3_tmp"
			, ""
			, ""
			, ""//"fn_afterSave"
			, ""
			, ""
			, true  // ""
        );
	}
	
	fn_query();
	*/
}

/********************************************************************************
* 기      능   : 삭제 Callback  
********************************************************************************/
function fn_afterDelete(errCode, errMsg) 
{
}

/********************************************************************************
* 기      능   : 사무소콤보 변경시 설치PM 콤보값 생성
********************************************************************************/
function cb_zzactss_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	if(userGroup == "40" || userGroup == "30"){
		ds_cond.SetColumn(0,"ZZLIFNR",'');
	}

    if(ds_cond.GetColumn(0,"ZZACTSS") == ''){
		ds_zzlifnr.UnFilter();
    }else{
		var arr = ds_cond.GetColumn(0,"ZZACTSS");
		ds_zzlifnr.Filter("ZZACTSS ==" +quote(arr));
    }
	
	ds_cond_cd.SetColumn(0,"ZZACTSS",strCode);
	cb_zzpmnum.value = "";

	tit_clearActionInfo();
	tit_addSearchActionInfo("ps02:PS0201001A_S41");
	
	tit_callService(
		""
		, ""
		, "ds_cond_cd=ds_cond_cd"
		, "ds_zzpmnum_cd=ds_zzpmnum_cd"  // ds_pronr=ds_pronr"
		, ""
		, "fn_afterZzactssChange"
		, ""
		, ""
		, true);
}

/********************************************************************************
* 기      능   : 조회 Callback  - 사무소 변경시
********************************************************************************/
function fn_afterZzactssChange(errCode, errMsg) {
	gfn_insertEmptyRow( ds_zzpmnum_cd, G_CODE_ALL );
	cb_zzpmnum.value = "";
}

/********************************************************************************
* 기      능   : 현장 호기 리스트의 셀 클릭
********************************************************************************/
function ds_list1_OnCellClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
	//협력업체 셀 클릭 시 업체정보 팝업 추가 - 2019.03.12 강민석
	//업체정보 팝업(PS0101001C) 화면을 띄우기 위해 Tab00과 Static16을 화면에 추가 함.
	//Tab00과 Static16은 화면에 실제 표시하진 않는다.
	/*
	var chk = "";
	
	if(length(ed_pspid.Text) <= 0 && length(cb_zzactss.Value) <= 0 ){
		chk = 'N';
	}else{
		chk = 'Y';
	}
	
	_P_POSID = ds_list1.getColumn(nRow, "POSID");
	_P_GUBUN = ds_list1.getColumn(nRow, "ZZGUBUN");
	_P_TYPE = ds_list1.getColumn(nRow, "TYPE");
	_P_VER = ds_list1.getColumn(nRow, "VER");
	_P_SAFE = ds_list1.getColumn(nRow, "SAFE");
	_P_ZSPEC = ds_list1.getColumn(nRow, "ZSPEC");
	 
	_P_CHK = chk;

	select_construction_process();
	*/
	
	//협력업체 정보 표시는 더블클릭 이벤트로 변경 - 2019.03.14 강민석K
	if(nCell != 4 && nCell != 5) {
		var chk = "";
		
		if(length(ed_pspid.Text) <= 0 && length(cb_zzactss.Value) <= 0 ){
			chk = 'N';
		}else{
			chk = 'Y';
		}
		
		_P_POSID = ds_list1.getColumn(nRow, "POSID");
		_P_GUBUN = ds_list1.getColumn(nRow, "ZZGUBUN");
		_P_TYPE = ds_list1.getColumn(nRow, "TYPE");
		_P_VER = ds_list1.getColumn(nRow, "VER");
		_P_SAFE = ds_list1.getColumn(nRow, "SAFE");
		_P_ZSPEC = ds_list1.getColumn(nRow, "ZSPEC");
		
		//trace("현재 선택한 호기 : " + _P_POSID);
		 
		_P_CHK = chk;
	
		select_construction_process();
		/*
	}else{
		var row = ds_cond2.AddRow();
		ds_cond2.SetColumn(0, "POSID", SUBSTR(ds_list1.getColumn(nRow, "POSID"), 0, 6));
		//trace("부모창 ds_cond2 : " + ds_cond2.SaveXML());
		
		tit_clearActionInfo();
		tit_addSearchActionInfo("ps01:PS0101001A_S2");
		tit_callService(
			""
			, ""
			, "ds_cond=ds_cond2"
			, "ds_list2=ds_list2"
			, ""
			, "fn_afterQuery2"
			, true);
		*/
	}
}

/********************************************************************************
* 기      능   : 협력사 업체정보 팝업 표시 기능
********************************************************************************/
function fn_afterQuery2(){
	//trace("dblclick_row : " + dblclick_row);
	
	var LIFNR = ds_list2.GetColumn(dblclick_row, "LIFNR");
	ds_list2.Filter("LIFNR=" + quote(LIFNR));
	// ds_list2
	
	//trace("LIFNR : " + LIFNR);
	gfn_openPopup("PS0101001C",true);
}

/********************************************************************************
* 기      능   : 공정별 작업이름
********************************************************************************/
function ufn_makeTile(obj, value) 
{
	if(length(value) > 12) value = left(value,12) + "..." ; 
	obj.Text = value;
}

/********************************************************************************
* 기      능   : 공절별 작업 날짜
********************************************************************************/
function ufn_makeDate(obj, value) 
{
	obj.Text = value;
}

/********************************************************************************
* 기      능   : 이미지 출력
********************************************************************************/
function ufn_getLocalImage(obj, fa_serverFileName, fa_orgFileName)
{
	//큰 이미지 표시방법 수정 - 2019.03.14 강민석K
	obj.ImageID = tit_getServerDir("PS", fa_serverFileName);//이미지 표시
	//obj.UserData = tit_getServerDir("PS", fa_serverFileName);
	//obj.ImageID = fa_serverFileName;
	obj.UserData = fa_orgFileName;//클릭 했을 때 사용할 원본 파일명 저장
}

/********************************************************************************
* 기      능   : 이미지 출력
********************************************************************************/
function ufn_getImage(obj, fileName, idx, fa_orgFileName)
{
	//큰 이미지 표시방법 수정 - 2019.03.14 강민석K
	obj.ImageID = substr(tit_getServerDir("PS", fileName),0,idx)+substr(tit_getServerDir("PS", fileName),idx);//이미지 표시
	//obj.UserData = substr(tit_getServerDir("PS", fileName),0,idx)+substr(tit_getServerDir("PS", fileName),idx);
	//obj.ImageID = fa_serverFileName;
	obj.UserData = fa_orgFileName;//클릭 했을 때 사용할 원본 파일명 저장
}

/********************************************************************************
* 기      능   : 조회 Callback  - 공정표 불러오기
********************************************************************************/
function select_construction_process()
{
	//ufn_initProcessForm();
	
	tit_clearActionInfo();
	tit_callService(
		  "COMM_ACT"
		, "getSdReturnDate"
		, ""
		, ""
		, "I_PSPID="+quote(substr(_P_POSID,0,6)) + " I_GUBUN='D' I_DATE="+quote(gfn_getCurrDate())
		, "fn_afterDate"
		,true,true,true);

	//수금전 진행상태가 'P'(진행)이 아닐경우 공정진행 입력 금지 20100820 sjy
	if(E_FLAG != 'P'  || _P_CHK == 'N'){
     //	div_btn.btn_save.enable = false;
     //Tab0.tab1.btn_gisung_save.visible = false;
	}
	
	_P_CHK2 = 'N'; //기본 셋팅 
	fn_query_process();
}

/********************************************************************************
* 기      능   : 조회 Callback  - 공정표 그리기
********************************************************************************/
function fn_query_process()
{
	gfn_clearGridSortMark(grd_pop);
	ds_pop.row = -1;//공정표 리스트의 데이터셋
	ds_pop.ClearData();

	var args = "POSID="+quote(_P_POSID);
		args += " GUBUN="+quote(_P_GUBUN);
		args += " ZSEPC="+quote(_P_ZSPEC);
		args += " SAFE="+quote(_P_SAFE);
		args += " TYPE="+quote(_P_TYPE);
		args += " VER="+quote(_P_VER);

	var q1="";
	var q2="";
	var q3="";
	
	var cRow=0;

	q1	+= ", '0' COL"
		+ ", 'N' B_COL"
	
	//추가(안전검사관련)//
		+ ",  '" + _P_SAFE + "' SAFE"
		+ "\n ,VALUE(MIN((CASE WHEN RIGHT(R03.POSID_1, 3)='"+right(_P_POSID,3)+"' THEN "
		+ "\n (CASE  WHEN (T13.MDATE)  <> '' THEN '1' ELSE '0' END)  "
		+ "\n END)), '0') JCOL";
		
	q1	+= "\n ,CASE WHEN (SELECT X.LIFNR FROM SAPHEE.ZMASTER02 AS X WHERE X.MANDT = A.MANDT "
		+ "\n  AND X.POSID= '"+ SUBSTR(_P_POSID,0,6) +"' AND X.POSID_1 = '"+ _P_POSID+"') = '0000008001' THEN '1' ELSE '0' END AS DIR";		
			
	q2 	+= "\n , VALUE(MIN((CASE WHEN RIGHT(R02.POSID_1, 3)='"+right(_P_POSID,3)+"' THEN "
		+ "\n (CASE WHEN (T12.CRDAT)='00000000' THEN '0'" 
		+ "\n WHEN  (T12.CRDAT)=HEX(CURRENT DATE) THEN '1' ELSE CHAR(T12.CRDAT) END) "
//		+ "\n ELSE T12.CRDAT END) "
		+ "\n END)), '0') COL";
				
	q2 += "\n , 'N' B_COL";
			
	//추가(안전검사관련)//						
	q2  += "\n,  '" + _P_SAFE + "' SAFE" 
		+ "\n ,VALUE(MIN((CASE WHEN RIGHT(R03.POSID_1, 3)='"+right(_P_POSID,3)+"' THEN "
		+ "\n (CASE  WHEN (T13.MDATE)  <> '' THEN '1' ELSE '0' END)  "
		+ "\n END)), '0') JCOL";
			
	q2 	+= "\n ,CASE WHEN (SELECT X.LIFNR FROM SAPHEE.ZMASTER02 AS X WHERE X.MANDT = T11.MANDT "
		+ "\n  AND X.POSID= '"+ SUBSTR(_P_POSID,0,6) +"' AND X.POSID_1 = '"+ _P_POSID +"') = '0000008001' THEN '1' ELSE '0' END AS DIR";
			
	q3  += "\n , T.COL"
		+ "\n , T.B_COL"
		+ "\n , T.SAFE"
		+ "\n , T.JCOL"
		+ "\n , T.DIR";
			
	cRow++;
	
	args += " S1_QUERY="+quote(q1);
	args += " S2_QUERY="+quote(q2);
	args += " S3_QUERY="+quote(q3);
		
	tit_clearActionInfo();	
	tit_addSearchActionInfo("ps02:PS0207003B_S1");
	tit_addSearchActionInfo("ps02:PS0209003B_S2"); //NEW PS0207003B_S2
	tit_addSearchActionInfo("ps02:PS0207003B_S3");
	
	tit_callService(
		""
		, ""
		, ""
		, "ds_pop1=ds_pop1 ds_pop2=ds_pop2 ds_pop3=ds_pop3"
		, args
		, "fn_processAfterQuery"
		, true);
}

/********************************************************************************
* 기      능   : 조회 Callback  - fn_processAfterQuery
********************************************************************************/
function fn_processAfterQuery(errCode, errMsg)
{

	// 메시지 처리 
	gfn_showSearchMsg(grd_pop);
	
	grd_pop.Redraw = false;
	
	if(ds_pop1.FindRow('UD', 'A')!='-1'){
		//trace("trace1");
		ds_pop.copy(ds_pop2);
	}else{
		//trace("trace2");
		ds_pop.copy(ds_pop1);
	}
	
	grd_pop.Redraw = true;
	//trace("ds_pop : \n" + ds_pop.SaveXML());
	
	for(var r=0; r<ds_pop.GetRowCount(); r++)
	{
		for(var c=0; c<ds_pop.GetColCount(); c++)
		{
			//trace("ds_pop GetColID : " + ds_pop.GetColID(c));
			if(left(ds_pop.GetColID(c), 3)=="COL")
			{
				//trace("ds_pop GetColumn : " + ds_pop.GetColumn(r, c));
				//if(ds_pop.GetColumn(r, c)=="1")
				if(ds_pop.GetColumn(r, c) != "0")
				{
					//trace("GetColID1 : " + ds_pop.GetColID(c));
					//trace("GetColID2 : " + "B_COL" + substr(ds_pop.GetColID(c), 3));
					ds_pop.SetColumn(r,"B_COL"+substr(ds_pop.GetColID(c), 3),"Y");
				}
			}
		}
	}	
	
	var endd = parseInt(grd_pop.GetColCount()) - 2 + parseInt(grd_pop.GetColCount()) - 2;	
	var posid_1 = "";
	//var cRow=1;

	//trace("posid_1 : " + posid_1);
	//trace("cRow : " + cRow);
	//trace("endd : " + endd);
	//trace("POSID1 : " + ds_pop3.FindRow("POSID", posid_1));
	//trace("TOT_F : " + ds_pop3.GetColumn(ds_pop3.FindRow("POSID", posid_1), "TOT_F"));
	//trace("TOT_G : " + ds_pop3.GetColumn(ds_pop3.FindRow("POSID", posid_1), "TOT_G"));

	posid_1 = _P_POSID ;
	//grd_pop.SetCellProp("summary", cRow,     "Text", ds_pop3.GetColumn(ds_pop3.FindRow("POSID", posid_1), "TOT_F"));
	//grd_pop.SetCellProp("summary", cRow + 1, "Text", ds_pop3.GetColumn(ds_pop3.FindRow("POSID", posid_1), "TOT_G"));
	grd_pop.SetCellProp("summary", 1, "Text", ds_pop3.GetColumn(ds_pop3.FindRow("POSID", posid_1), "TOT_F"));
	grd_pop.SetCellProp("summary", 2, "Text", ds_pop3.GetColumn(ds_pop3.FindRow("POSID", posid_1), "TOT_G"));
	
	//cRow++;

	//수금전 진행상태가 'P'(진행)이 아닐경우 공정진행 입력 금지 20100820 sjy
	if(E_FLAG != 'P'){
		grd_pop.Editable = false;	
	}

	if(E_FLAG != 'P'){
		grd_pop.Editable = false;	
	}
	
	//협력사는 조회만 가능
	if(gfn_getUserGroup()=="10"){
		grd_pop.Editable = false;
	}else{
		grd_pop.Editable = true;
	}
	
	//-------------------------------------------------------------------------------------
	//호기리스트에서 호기 선택 -> 공정표 표시 -> 이미지 조회 기능 추가 - 2019.03.11 강민석K
	var row = ds_cond2.AddRow();
	ds_cond2.SetColumn(0, "POSID", _P_POSID);
	ds_cond2.SetColumn(0, "GUBUN", _P_GUBUN);
	ds_cond2.SetColumn(0, "TYPE", _P_TYPE);
	ds_cond2.SetColumn(0, "VER", _P_VER);
	//trace("선택된 ds_cond2 : " + ds_cond2.SaveXML());
	
	tit_clearActionInfo();	
	tit_addSearchActionInfo("ps02:PS0209003A_S4");  	
	
	tit_callService(
          ""
        , ""
        , "ds_cond2=ds_cond2"
        , "ds_list5=ds_list5"  
        , ""
        , "fn_afterSeletePopidInfo"  
        , ""
        , ""
        , true);
	//-------------------------------------------------------------------------------------
}

/********************************************************************************
* 기      능   : 조회 Callback
********************************************************************************/
function fn_afterDate(errCode, errMsg) {
}

/********************************************************************************
* 기      능   : 이미지 조회 Callback 추가 - 2019.03.11 강민석K
********************************************************************************/
function fn_afterSeletePopidInfo() {
	//trace("이미지 조회 결과 : " + ds_list5.SaveXML());
	
	initImage();
	if(ds_list5.GetRowCount() == 0)
	{
		//gfn_showAlert("해당 호기에 아직 완료사진이 없습니다.");
		gfn_showMsg("해당 호기에 아직 완료사진이 없습니다.");
		return;
	}
	
	var lastIndex = 0;
	for(var i = 0; i < ds_list5.GetRowCount(); i++)
	{
		//trace("투입일 : " + ds_list5.GetColumn(i, "EDATE"));
		//trace("공정명 : " + ds_list5.GetColumn(i, "PROWRK"));
		//trace("공정율 : " + ds_list5.GetColumn(i, "PRO_R"));
		//trace("파일명(FNAME) : " + ds_list5.GetColumn(i, "FNAME"));
		//trace("파일명(FNAME_APP) : " + ds_list5.GetColumn(i, "ORGFNAME"));
		
		//투입일자 static 세팅
		ufn_makeDate(eval("divImage.div_date" + (i + 1)), ds_list5.GetColumn(i, "EDATE") + " (" + ds_list5.GetColumn(i, "PRO_SUM") + "%)");
		
		//공정명 static 세팅
		ufn_makeTile(eval("divImage.div_pro_name" + (i + 1)), ToNumber(ds_list5.GetColumn(i, "PRONR")) + "." + ds_list5.GetColumn(i, "PROWRK"));
		
		//이미지 파일명이 있는 공정만 이미지 표시
		if(length(ds_list5.GetColumn(i, "FNAME")) != 0)
		{
			//이미지 세팅
			fa_serverFileName = ds_list5.GetColumn(i, "FNAME");//파일명
			//trace("fa_serverFileName : " + fa_serverFileName);
			//trace("ServerDir : " + tit_getServerDir("PS", fa_serverFileName));
			if(IndexOf(tit_getServerDir("PS", fa_serverFileName),'localhost') > 0) //로컬
			{
				//이미지 클릭 시 표시방법 수정 - 2019.03.14 강민석K (고범석K 요청사항)
				ufn_getLocalImage(eval("divImage.Image" + (i + 1)), fa_serverFileName, ds_list5.GetColumn(i, "ORGFNAME"));
			}else{
				//이미지 클릭 시 표시방법 수정 - 2019.03.14 강민석K (고범석K 요청사항)
				var idx = IndexOf(tit_getServerDir("PS", fa_serverFileName),'/',10); //운영
				ufn_getImage(eval("divImage.Image" + (i + 1)), fa_serverFileName, idx, ds_list5.GetColumn(i, "ORGFNAME"));
			}
			
			lastIndex = i + 1;
		}
		
		eval("divImage.div_date" + (i + 1)).Visible = true;
		eval("divImage.div_pro_name" + (i + 1)).Visible = true;
		eval("divImage.Image" + (i + 1)).Visible = true;
	}
	
	//trace("lastIndex : " + lastIndex);
	//마지막 공정 이후의 컨트롤들은 숨김처리
	for(var j = lastIndex + 1; j <= ds_list5.GetRowCount(); j++){
		eval("divImage.div_date" + j).Visible = false;
		eval("divImage.div_pro_name" + j).Visible = false;
		eval("divImage.Image" + j).Visible = false;
	}
	divImage.ResizeScroll();//스크롤바 표시를 동적으로 할 때 사용 -> 송광용D 가이드
	
	//trace("lastIndex : " + lastIndex);
	if(lastIndex != 0){
		var lastImage_Top = eval("divImage.Image" + lastIndex).Top;
		var lastImage_Height = eval("divImage.Image" + lastIndex).Height;
		//trace("lastIndex : " + lastIndex + ", lastImage_Top : " + lastImage_Top + ", lastImage_Height : " + lastImage_Height);
	
		divImage.SetScroll(0, lastImage_Top + lastImage_Height);
	}
}

/********************************************************************************
* 기      능   : 그리드 셀 클릭 시 이벤트
********************************************************************************/
function grd_pop_OnCellClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{	
	//trace("COL : " + ds_pop.GetColumn(nRow, "COL"));
	//trace("COM_CHK : " + ds_pop.GetColumn(nRow, "COM_CHK"));
	//trace("PROCESS_BY_SAFE_NUM : " + ds_pop.GetColumn(nRow, "PROCESS_BY_SAFE_NUM"));
	//trace("F_SAFE_NUM : " + ds_pop.GetColumn(nRow, "F_SAFE_NUM"));

	var curCol = grd_pop.GetCellProp("body",nCell,"COLID");

	//trace("COL : " + length(ds_pop.GetColumn(nRow, "COL")));
	
	if(nCell == "5" && length(ds_pop.GetColumn(nRow, "COL")) < 8){
		//trace("PROCESS_BY_SAFE_NUM : " + parseInt(ds_pop.GetColumn(nRow,'PROCESS_BY_SAFE_NUM')));
		//trace("F_SAFE_NUM : " + parseInt(ds_pop.GetColumn(nRow,'F_SAFE_NUM')));
		
		/*
		if( parseInt(ds_pop.GetColumn(nRow,'PROCESS_BY_SAFE_NUM')) <= parseInt(ds_pop.GetColumn(nRow,'F_SAFE_NUM')) ){//기성컬럼 체크박스 표시 상태
			if(ds_pop.getColumn(nRow, "COM_CHK") <> "1"){// 완료가 되지 않았을때
				gfn_showAlert("완료되지 않은 공정은 기성체크 할 수 없습니다.");
				return;
			}
		}else{// 공정별 안전검사단계가 실시된 안점검사보다 크면
			ds_pop.SetColumn(nRow, "SAVE_COM_CHK", "0");
			gfn_showAlert("안전검사 후 완료체크 할 수 있습니다.");
			return;
		}
		*/
		//trace("COL : " + ds_pop.GetColumn(nRow, "COL"));
		if(ds_pop.GetColumn(nRow, "COM_CHK") <> "1"){
			gfn_showMsg("완료되지 않은 공정은 기성체크 할 수 없습니다.");
			return;
		}else if(parseInt(ds_pop.GetColumn(nRow,'F_SAFE_NUM')) < parseInt(ds_pop.GetColumn(nRow,'PROCESS_BY_SAFE_NUM'))){
			gfn_showMsg("안전검사 후 완료체크 할 수 있습니다.");
			return;
		}
	}else{
		return;
	}
	
	//수금전 진행상태가 'P':진행이 아닐경우 공정진행 입력 금지 20100820 sjy
	if(E_FLAG != 'P') return;
	
	//협력사는 조회만
	if(gfn_getUserGroup()=="10") return;
	
	//trace("COL : " + ds_pop.GetColumn(nRow, "COL"));
	//trace("gfn_getCurrDate : " + gfn_getCurrDate());

	//trace("nRow : " + nRow);
	//trace("curCol : " + curCol);
	if(left(curCol, 3)=='COL'){
		//trace("ZCHECK : " + ds_pop.GetColumn(nRow, "ZCHECK") + ", " + ds_pop.GetColumn(nRow, curCol) + ", GISUNG_CHK : " + ds_pop.GetColumn(nRow, "GISUNG_CHK"));
		if(ds_pop.GetColumn(nRow, "ZCHECK")=='X' && ds_pop.GetColumn(nRow, curCol)=='0' && ds_pop.GetColumn(nRow, "GISUNG_CHK" ) <> 'X'){
			for(var i=nRow; i>=0; i--){
				if(ds_pop.GetColumn(i, curCol)==0  &&  ( ds_pop.GetColumn(nRow, "J" + curCol ) == '1')){
					if(i!=nRow) ds_pop.SetColumn(i, curCol, '1');
					//if(i!=nRow) ds_pop.SetColumn(i, curCol,  gfn_getCurrDate());
					ufn_setTodaysVal(i, nCell, 0);
				}
				 	
				if(ds_pop.GetColumn(i-1, "ZCHECK")=='X' && i!=nRow){
					return;
				}
			}
		}else{
			ufn_setTodaysVal(nRow, nCell, ds_pop.GetColumn(nRow, curCol));
		}
	}
	//trace("COL : " + ds_pop.GetColumn(nRow, "COL"));
}

/********************************************************************************
* 기      능   : 당일 공정률 계산
********************************************************************************/
function ufn_setTodaysVal(nRow, nCell, val)
{
	//trace("nRow : " + nRow + ", nCell : " + nCell + ", val : " + val);
	
	//trace("summary 0 : " + grd_pop.GetCellProp("summary", 0, "Text"));
	//trace("summary 1 : " + grd_pop.GetCellProp("summary", 1, "Text"));
	//trace("summary 2 : " + grd_pop.GetCellProp("summary", 2, "Text"));
	
	
	//누계공정율 항목이 당일 누계 공정율만 보이도록 변경되어 아래 기능 수정 - 2019.03.15 강민석K
	/*
	var curCol = grd_pop.GetCellProp("body",nCell,"COL");
	var pree = nCell-4+1;
	var midd = pree + parseInt(grd_pop.GetColCount()) - 3;
	var endd = parseInt(grd_pop.GetColCount()) - 3 + midd;	
	var preVal = ParseFloat(grd_pop.GetCellProp("summary", pree, "Text"));
	var curVal = ParseFloat(grd_pop.GetCellProp("summary", midd, "Text"));
	

	if(left(curCol, 3)=='COL'){
		if(val==0 && ( ds_pop.GetColumn(nRow, "J" + curCol ) == '1' or  ds_pop.GetColumn(nRow, "GISUNG_CHK" ) == 'X')  ){
			curVal = ParseFloat(curVal) + ParseFloat(ds_pop.GetColumn(nRow, "PRO_R"));
		} else if(val==1  && ( ds_pop.GetColumn(nRow, "J" + curCol ) == '1' or  ds_pop.GetColumn(nRow, "GISUNG_CHK" ) ==  'X') ) {
			curVal = ParseFloat(curVal) - ParseFloat(ds_pop.GetColumn(nRow, "PRO_R"));
		}		
	} 	
	
	grd_pop.SetCellProp("summary", midd, "Text", curVal);
	grd_pop.SetCellProp("summary", endd, "Text", preVal + curVal);
	*/
	
	if(nCell == 5){
		var curVal = ParseFloat(grd_pop.GetCellProp("summary", 2, "Text"));
		var pro_r_val = ParseFloat(ds_pop.GetColumn(nRow, "PRO_R"));
		
		//trace("curVal : " + curVal);
		//trace("pro_r_val : " + pro_r_val);
		
		if(val == 0){//기성 체크박스 체크 했을 경우
			curVal = curVal + pro_r_val;
		}else if(val == 1){//기성 체크박스 체크해제 했을 경우
			curVal = curVal - pro_r_val;
		}
		
		grd_pop.SetCellProp("summary", 2, "Text", curVal);
	}
}

/********************************************************************************
* 기      능   : 사진보기 버튼
********************************************************************************/
function btn_picture_OnClick(obj)
{
	if(length(_P_POSID) <> 0){//호기가 선택되었을때
		var arg = "P_POSID=" + quote(_P_POSID);
		var arr = gfn_openPopupUrl("PS02::PS0209001B.xml", true, arg); 
	}else{
		gfn_showAlert("선택된 호기가 없습니다. 확인바랍니다.");
		return;
	}
}

/********************************************************************************
* 기      능   : 이미지 큰팝업 호출
********************************************************************************/
function images_onClickOpenPopup(obj,nX,nY)
{
	//var arg = "IMGURL=" + quote(obj.UserData);
	//trace("userdata : " + obj.UserData);
	//var arr = gfn_openPopupUrl("PS02::PS0209001C.xml", true, arg);
	
	//PS0209001C에 이미지를 표시하던 방식을 PC의 툴을 사용하도록 수정 - 2019.03.14 강민석K (고범석K 요청사항)
	var OGRFNAME = obj.UserData;
	var FNAME = obj.ImageID;

	var idx = ufn_lastIndexOf(FNAME);
	FNAME = substr(FNAME, idx, Length(FNAME));
	
	if(length(OGRFNAME) > 0){
		fn_createWait("", this);

		var FilePath = "c:\\Temp" ;		
		var FileExec = "c:\\Temp\\" + obj.UserData;
		
		saveDialog.FileName = obj.UserData;
		
		var rMsg = tit_fileRead(
						httpFile
						, "PS"  	// 저장 디렉토리
						, FNAME		// 서버에서 전송받을 이름
						, FilePath  // 로컬 경로
						, OGRFNAME  // 로컬 파일명
					   );
		fn_destroyWait();
		if ( rMsg[0] == "E" ) {
			if ( length(trim(rMsg[1])) > 0 ) {
				//  ExecShell(FileExec);
				//gfn_showAlert("CW10025", rMsg[1]);
				gfn_showMsg("CW10025", rMsg[1]);
			} else {
				gfn_showAlert("CW10025", "파일 다운로드에 실패하였습니다.");
			}
		} else {	
			ExecShell(FileExec);		
		}
	}
	
	/*
	if(nCell != 0)
	{
		if( length(ds_file.getColumn(nRow, "FNAME")) > 0) {
		   // 첨부 파일 처리 
		   fn_createWait("", this);
		
			var FilePath = "c:\\Temp" ;		
			var FileExec = "c:\\Temp\\" + ds_file.getColumn(nRow, "FNAME");
	
			saveDialog.FileName = ds_file.getColumn(nRow, "FNAME");
			
			var rMsg = tit_fileRead(
										httpFile
										, "PS"  	  // 저장 디렉토리
										, ds_file.getColumn(nRow, "FNAME_APP")	// 서버에서 전송받을 이름
										, FilePath    // 로컬 경로
										, ds_file.getColumn(nRow, "FNAME")    // 로컬 파일명
									   );
	
				fn_destroyWait();
				if ( rMsg[0] == "E" ) {
					if ( length(trim(rMsg[1])) > 0 ) {
					  //  ExecShell(FileExec);
						gfn_showAlert("CW10025", rMsg[1]);
					} else {
	
						gfn_showAlert("CW10025", "파일 다운로드에 실패하였습니다.");
					}
				} else {	
					ExecShell(FileExec);		
				}	
					
					
			 }
	}
	*/
}

/********************************************************************************
* 기      능   : 저장 버튼
********************************************************************************/
function btn_gisung_save_OnClick(obj)
{
	if (!gfn_showConfirm("CW10025","저장하시겠습니까?")){
	 return;
    }
   
	if(length(_P_POSID) <> 0){//호기가 선택되었을때
		ds_save.deleteAll();
	    ds_save.copyF(ds_pop);
	   
	    for(var j=0; j<ds_save.GetRowCount(); j++){
		    ds_save.SetColumn(j,"PSPID", substr(_P_POSID,0,6));
		    ds_save.SetColumn(j,"POSID", _P_POSID);
		    ds_save.SetColumn(j,"GUBUN", _P_GUBUN);
		    
			if(ds_save.GetColumn(j, "COL")=="1"  && ds_save.GetColumn(j, "B_COL")=="N"){
				ds_save.SetColumn(j, "FLAG", "I");
			}else if(ds_save.GetColumn(j, "COL")=="0" && ds_save.GetColumn(j, "B_COL")=="Y"){
				ds_save.SetColumn(j, "FLAG", "D");
			} 	
	    }
	  
	    ds_save1.deleteAll();
	    ds_save.Filter("FLAG == 'I'");
	    ds_save1.copyF(ds_save);
	    ds_pop.unFilter();
	 
		ds_save2.deleteAll();
		ds_save.Filter("FLAG == 'D'");
		ds_save2.copyF(ds_save); 
		ds_pop.unFilter();
		
	    if(ds_save1.rowcount > 0){
			tit_clearActionInfo();
			tit_addMultiActionInfo("ps02:PS0207003C_I1");//zpst0112
			tit_callService(
				  ""
				, ""
				, "ds_save1=ds_save1"
				, ""
				, ""
				, ""
				, ""
				, ""
				, true
			);
		}
			
	    if(ds_save2.rowcount > 0) {
			tit_clearActionInfo();
		    tit_addMultiActionInfo("ps02:PS0207003C_D1");//zpst0112
		    tit_callService(
				  ""
				, ""
				, "ds_save2=ds_save2"
				, ""
				, ""
				, ""
				, ""
				, ""
				, true
				);
		  }  
		//쿼리재실행 TODO::
		select_construction_process();
	}else{
		gfn_showAlert("선택된 호기가 없습니다. 확인바랍니다.");
		return;
	}
}

/*
function Tab0_OnChanged(obj,nOldIndex,nNewindex)
{
	//탭 선택을 변경해도 초기화 하지 않도록 수정하려고 했으나,
	//두 탭의 그리드 모두 같은 ds_list1을 사용하고 있어 활성화된 탭에 따라 ds_list1을 재활용하고 있음.
	//시간을 갖고 수정할 예정 - 2019.03.05 강민석K
	ds_list1.Clear();
	ds_pop.Clear();
	_TABGUBUN = nNewindex;
	if( length(ds_cond.GetColumn(ds_cond.row, "PSPID")) > 0 ){
		fn_query();
	}
}
*/

/********************************************************************************
* 기      능   : 폼 사이즈가 변경될때 상단 검색항목의 shape0 컴포넌트만 width 변
********************************************************************************/
function PS0209001A_OnSize(obj,nCx,nCy,nState)
{
	//trace("PS0209001A_OnSize : "+this.width+","+this.height);  
		
	if(this.width > 1502){	
	    var chgWidth = this.width - 1502;
		Shape0.Width = 1502 + chgWidth; 
	}
	else{
		Shape0.Width = 1502; 
	}
}

/*******************************************************************************
* 기      능   : 협력업체 또는 작업팀장 셀을 더블클릭 시 협력업체 정보가 표시되도록 추가 - 2019.03.14 강민석K
********************************************************************************/
function grd_list1_OnCellDblClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
	if(nCell == 4 || nCell == 5) {
		dblclick_row = nRow;
		
		var row = ds_cond2.AddRow();
		ds_cond2.SetColumn(0, "POSID", SUBSTR(ds_list1.getColumn(nRow, "POSID"), 0, 6));
		//trace("부모창 ds_cond2 : " + ds_cond2.SaveXML());
		
		tit_clearActionInfo();
		tit_addSearchActionInfo("ps01:PS0101001A_S2");
		tit_callService(
			""
			, ""
			, "ds_cond=ds_cond2"
			, "ds_list2=ds_list2"
			, ""
			, "fn_afterQuery2"
			, true);
	}
}

/*******************************************************************************
* 기      능   : 키보드 방향키로 이동 시 조회되도록 추가 - 2019.03.14 강민석K
********************************************************************************/
function grd_list1_OnKeyDown(obj,nChar,bShift,bCtrl,bAlt,nLLParam,nHLParam)
{
	//trace("nChar : " + nChar);
	//trace("prev_row : " + prev_row);
	//trace("obj CurrentRow : " + obj.CurrentRow);
	//trace("obj CurrentCell : " + obj.CurrentCell);
	
	if(prev_row != obj.CurrentRow){
		prev_row = obj.CurrentRow;
		ds_list1_OnCellClick(obj, obj.CurrentRow, obj.CurrentCell, 'key');
	}
}

function ufn_lastIndexOf(sParmString)
{
	var j = 0;//.위치 
	var k = 0;// 결과위치 
	var k = 0;//.위치 -1 
	
	
	while(true) 
	{ 
		r = pos(sParmString,"/",j);
		
		if (r == -1) 
		{ 
			break; 
		} 
		
		j=r+1; 
	
	} 
	k = j; 
	
	return k;
}]]></Script>
</Window>