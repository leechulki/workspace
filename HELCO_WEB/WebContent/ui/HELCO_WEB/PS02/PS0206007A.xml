<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="562" Id="PS0206007A" Left="8" OnLoadCompleted="fn_OnLoadCompleted" OnUnloadCompleted="fn_OnUnloadCompleted" PidAttrib="7" Title="품목별&#32;&#32;STOCK&#32;자재&#32;입출현황&#32;등록&#32;및&#32;조회" Top="8" Ver="1.0" Width="978" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_cond">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE2" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE3" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE4" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE5" size="256" summ="default" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE2></CODE2>
						<CODE3></CODE3>
						<CODE4></CODE4>
						<CODE5></CODE5>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond2">
				<Contents>
					<colinfo id="SERIAL" size="256" summ="default" type="STRING"/>
					<colinfo id="SPEC" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
					<colinfo id="SCNT" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZACTSS" size="256" summ="default" type="STRING"/>
					<colinfo id="SERIAL2" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="SPRT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list">
				<Contents>
					<colinfo id="SPEC" size="256" summ="default" type="STRING"/>
					<colinfo id="SERIAL" size="256" summ="default" type="STRING"/>
					<colinfo id="MTART" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSPEC1" size="256" summ="default" type="STRING"/>
					<colinfo id="SPRT" size="256" summ="default" type="STRING"/>
					<colinfo id="SCNT" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZACTSS" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="SERIAL_CH" size="256" summ="default" type="STRING"/>
					<colinfo id="SERIAL2" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK2" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list2" OnColumnChanged="ds_list2_OnColumnChanged">
				<Contents>
					<colinfo id="RELDATE" size="256" summ="default" type="STRING"/>
					<colinfo id="PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
					<colinfo id="SPEC" size="256" summ="default" type="STRING"/>
					<colinfo id="SERIAL" size="256" summ="default" type="STRING"/>
					<colinfo id="MTART" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSPEC1" size="256" summ="default" type="STRING"/>
					<colinfo id="SPRT" size="256" summ="default" type="STRING"/>
					<colinfo id="SCNT" size="256" summ="default" type="STRING"/>
					<colinfo id="COLDATE" size="256" summ="default" type="STRING"/>
					<colinfo id="RELMAN" size="256" summ="default" type="STRING"/>
					<colinfo id="COLMAN" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZACTSS" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="NAMET" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSITE_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="CHECK" size="256" summ="default" type="STRING"/>
					<colinfo id="SERIAL2" size="256" summ="default" type="STRING"/>
					<colinfo id="SCNT2" size="256" summ="default" type="STRING"/>
					<colinfo id="SERIAL_CH" size="256" summ="default" type="STRING"/>
					<colinfo id="SERIAL3" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list3">
				<Contents>
					<colinfo id="RELDATE" size="256" summ="default" type="STRING"/>
					<colinfo id="PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
					<colinfo id="SPEC" size="256" summ="default" type="STRING"/>
					<colinfo id="SERIAL" size="256" summ="default" type="STRING"/>
					<colinfo id="MTART" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSPEC1" size="256" summ="default" type="STRING"/>
					<colinfo id="SPRT" size="256" summ="default" type="STRING"/>
					<colinfo id="SCNT" size="256" summ="default" type="STRING"/>
					<colinfo id="COLDATE" size="256" summ="default" type="STRING"/>
					<colinfo id="RELMAN" size="256" summ="default" type="STRING"/>
					<colinfo id="COLMAN" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZACTSS" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="NAMET" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSITE_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="CHECK" size="256" summ="default" type="STRING"/>
					<colinfo id="SERIAL2" size="256" summ="default" type="STRING"/>
					<colinfo id="SCNT2" size="256" summ="default" type="STRING"/>
					<colinfo id="SERIAL_CH" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_error_cd">
				<Contents>
					<colinfo id="GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN2" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE2" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN_NAME" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN_NAME2" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME2" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_code">
				<Contents>
					<colinfo id="CODE" size="255" summ="default" type="STRING"/>
					<colinfo id="CODE_NM" size="255" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_code2">
				<Contents>
					<colinfo id="CODE" size="255" summ="default" type="STRING"/>
					<colinfo id="CODE_NM" size="255" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_code3">
				<Contents>
					<colinfo id="CODE" size="255" summ="default" type="STRING"/>
					<colinfo id="CODE_NM" size="255" summ="default" type="STRING"/>
					<colinfo id="CODE2" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_code4">
				<Contents>
					<colinfo id="CODE" size="255" summ="default" type="STRING"/>
					<colinfo id="CODE_NM" size="255" summ="default" type="STRING"/>
					<colinfo id="CODE3" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_code5">
				<Contents>
					<colinfo id="CODE" size="255" summ="default" type="STRING"/>
					<colinfo id="CODE_NM" size="255" summ="default" type="STRING"/>
					<colinfo id="CODE4" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond3">
				<Contents>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_gbn">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE>O</CODE>
						<CODE_NAME></CODE_NAME>
					</record>
					<record>
						<CODE>X</CODE>
						<CODE_NAME>변경</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_zzactss">
				<Contents>
					<colinfo id="CODE" size="255" summ="default" type="STRING"/>
					<colinfo id="CODE_NM" size="255" summ="default" type="STRING"/>
					<colinfo id="ZZACTSS" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_trans">
				<Contents>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
					<colinfo id="SERIAL" size="256" summ="default" type="STRING"/>
					<colinfo id="MESGACCP" size="256" summ="default" type="STRING"/>
					<colinfo id="MESGTITL" size="256" summ="default" type="STRING"/>
					<colinfo id="MESGDESC" size="256" summ="default" type="STRING"/>
					<colinfo id="MESGCHEK" size="256" summ="default" type="STRING"/>
					<colinfo id="MESGACDE" size="256" summ="default" type="STRING"/>
					<colinfo id="MESGSEDE" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
		</Datasets>
		<Shape BKColor="user0" Bottom="52" Height="52" Id="Shape0" Left="0" LineColor="user1" Right="978" TabOrder="1" Top="0" Type="Rectangle" Width="978"></Shape>
		<Static Align="Right" Height="20" Id="Static5" Left="9" Style="sty_lb_search" TabOrder="2" Text="지사구분&#32;" Top="4" VAlign="Middle" Width="80"></Static>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="CODE" Column="CODE" DataColumn="CODE_NM" Height="20" Id="cb_gbn" InnerDataset="ds_code" Left="93" Style="sty_ipt_search" TabOrder="3" Top="3" Width="100"></Combo>
		<Grid AutoFitEndLine="Hide" BindDataset="ds_list" BkColor2="default" BoldHead="true" Border="Flat" Bottom="446" ColSizing="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="390" Id="grd_list" InputPanel="FALSE" Left="8" LineColor="user20" LineType="ExHORZ" OnCellClick="grd_list_OnCellClick" OnHeadClick="grd_list_OnHeadClick" Right="966" RowHeight="20" Style="sty_grid" TabOrder="4" TabStop="true" Top="56" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="958">
			<contents>
				<format id="Default">
					<columns>
						<col width="28"/>
						<col width="78"/>
						<col width="70"/>
						<col width="70"/>
						<col width="200"/>
						<col width="200"/>
						<col width="124"/>
						<col width="70"/>
						<col width="93"/>
					</columns>
					<head>
						<cell align="center" col="0" color="user21" display="text" font="굴림,9" text="NO"/>
						<cell align="center" col="1" color="user21" display="text" font="굴림,9" text="지사구분"/>
						<cell align="center" col="2" color="user21" display="text" font="굴림,9" text="자재구분"/>
						<cell align="center" col="3" color="user21" display="text" font="굴림,9" text="기종"/>
						<cell align="center" col="4" color="user21" display="text" font="굴림,9" text="파트명"/>
						<cell align="center" col="5" color="user21" display="text" font="굴림,9" text="품명(SPEC)"/>
						<cell align="center" col="6" color="user21" display="text" font="굴림,9" text="시리얼번호"/>
						<cell align="center" col="7" color="user21" display="text" font="굴림,9" text="수량"/>
						<cell align="center" col="8" color="user21" display="text" font="굴림,9" text="가용여부"/>
					</head>
					<body>
						<cell align="center" bkcolor2="user22" col="0" display="text" expr="currow+1"/>
						<cell align="center" bkcolor2="user22" col="1" colid="ZZACTSS" combocol="CODE" combodataset="ds_code" combotext="CODE_NM" display="combo" suppress="1"/>
						<cell align="center" bkcolor2="user22" col="2" colid="MTART" combocol="CODE" combodataset="ds_code2" combotext="CODE_NM" display="combo"/>
						<cell align="center" bkcolor2="user22" col="3" colid="ZSPEC1" combocol="CODE" combodataset="ds_code3" combotext="CODE_NM" display="combo"/>
						<cell align="left" bkcolor2="user22" col="4" colid="SPRT" combocol="CODE" combodataset="ds_code4" combotext="CODE_NM" display="combo"/>
						<cell align="left" bkcolor2="user22" col="5" colid="SPEC" combocol="CODE" combodataset="ds_code5" combotext="CODE_NM" display="combo"/>
						<cell align="left" bkcolor2="user22" col="6" colid="SERIAL" display="text"/>
						<cell align="center" bkcolor2="user22" col="7" colid="SCNT" display="number"/>
						<cell align="center" bkcolor2="user22" col="8" colid="CHK" color='expr:iif(SCNT&#32;==&#32;0&#32;,&quot;red&quot;,&quot;default&quot;)' display="text"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Grid AutoEnter="TRUE" AutoFitEndLine="Hide" BindDataset="ds_list2" BkColor2="default" BoldHead="true" Border="Flat" Bottom="558" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="110" Id="grd_list2" InputPanel="FALSE" Left="8" LineColor="user20" LineType="ExHORZ" OnCellClick="grd_list2_OnCellClick" OnCellPosChanged="grd_list2_OnCellPosChanged" OnExpandEdit="grd_list2_OnExpandEdit" OnHeadClick="grd_list2_OnHeadClick" Right="966" RowHeight="20" Style="sty_grid" TabOrder="5" TabStop="true" Top="448" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="958">
			<contents>
				<format id="Default">
					<columns>
						<col width="28"/>
						<col width="95"/>
						<col width="225"/>
						<col width="85"/>
						<col width="160"/>
						<col width="0"/>
						<col width="85"/>
						<col width="95"/>
						<col width="89"/>
						<col width="95"/>
						<col width="0"/>
						<col width="0"/>
					</columns>
					<head>
						<cell align="center" col="0" color="user34" display="text" font="굴림,9" text="NO"/>
						<cell align="center" col="1" color="user21" display="text" font="굴림,9" text="프로젝트&#32;L&#32;No."/>
						<cell align="center" col="2" color="user21" display="text" font="굴림,9" text="현장명"/>
						<cell align="center" col="3" color="user21" display="text" font="굴림,9" text="PM"/>
						<cell align="center" col="4" color="user21" display="text" font="굴림,9" text="시리얼&#32;넘버"/>
						<cell align="center" col="5" color="user21" display="text" font="굴림,9" text="시리얼&#32;넘버"/>
						<cell align="center" bkcolor="user23" col="6" color="user21" display="text" font="굴림,9" text="출고일"/>
						<cell align="center" bkcolor="user23" col="7" color="user21" display="text" font="굴림,9" text="자재&#32;출고자"/>
						<cell align="center" col="8" color="user21" display="text" font="굴림,9" text="회수일"/>
						<cell align="center" col="9" color="user21" display="text" font="굴림,9" text="자재&#32;회수자"/>
						<cell align="center" col="10" color="user21" display="text" font="굴림,9" text="수량"/>
						<cell align="center" col="11" color="user21" display="text" font="굴림,9" text="자재&#32;회수자"/>
					</head>
					<body>
						<cell align="center" bkcolor2="user22" col="0" display="text" expr="CURROW+1"/>
						<cell align="center" bkcolor2="user22" col="1" colid="POSID" display="text" edit='expr:iif(SCNT&#32;=&#32;1,&quot;uppernumchar&quot;,&quot;none&quot;)' limit="9"/>
						<cell align="left" bkcolor2="user22" col="2" colid="ZSITE_NM" combodisplayrowcnt="10" display="text" edit="normal" limit="30"/>
						<cell align="center" bkcolor2="user22" col="3" colid="NAMET" display="text"/>
						<cell align="left" bkcolor2="user22" col="4" colid="SERIAL" combodisplayrowcnt="6" display="text"/>
						<cell align="left" bkcolor2="user22" col="5" colid="SERIAL2" combodisplayrowcnt="6" display="text"/>
						<cell align="center" bkcolor2="user22" col="6" colid="RELDATE" display="text" expandimage="btn_grid_icon_pen" expandshow='expr:iif(SCNT&#32;=&#32;0&#32;,&quot;false&quot;&#32;,&quot;true&quot;)' Mask="####.##.##" suppress="1"/>
						<cell align="center" bkcolor2="user22" col="7" colid="RELMAN" display="text" edit="expr:iif(SCNT&#32;=&#32;0&#32;,&#32;&apos;none&apos;,&#32;&apos;normal&apos;)" limit="5" suppress="1"/>
						<cell align="center" bkcolor2="user22" col="8" colid="COLDATE" display="text" expandimage="btn_grid_icon_pen" expandshow='expr:iif(SCNT&#32;=&#32;0&#32;,&quot;true&quot;,&quot;false&quot;&#32;)' Mask="####.##.##" suppress="2"/>
						<cell align="center" bkcolor2="user22" col="9" colid="COLMAN" display="text" edit="expr:iif(SCNT&#32;=&#32;0&#32;,&#32;&apos;normal&apos;,&#32;&apos;none&apos;)" suppress="3"/>
						<cell align="center" bkcolor2="user22" col="10" colid="SCNT" display="number" edit="normal" suppress="3"/>
						<cell align="center" bkcolor2="user22" col="11" colid="SPEC" display="text" edit="normal" suppress="3"/>
					</body>
				</format>
				<format id="Default0">
					<columns>
						<col width="28"/>
						<col width="95"/>
						<col width="225"/>
						<col width="80"/>
						<col width="0"/>
						<col width="0"/>
						<col width="85"/>
						<col width="95"/>
						<col width="0"/>
						<col width="63"/>
					</columns>
					<head>
						<cell align="center" col="0" color="user34" display="text" font="굴림,9" text="NO"/>
						<cell align="center" col="1" color="user21" display="text" font="굴림,9" text="프로젝트&#32;L&#32;No."/>
						<cell align="center" col="2" color="user21" display="text" font="굴림,9" text="현장명"/>
						<cell align="center" col="3" color="user21" display="text" font="굴림,9" text="PM"/>
						<cell align="center" col="4" color="user21" display="text" font="굴림,9" text="수량"/>
						<cell align="center" col="5" color="user21" display="text" font="굴림,9" text="자재&#32;회수자"/>
						<cell align="center" bkcolor="user23" col="6" color="user21" display="text" font="굴림,9" text="출고일"/>
						<cell align="center" bkcolor="user23" col="7" color="user21" display="text" font="굴림,9" text="자재&#32;출고자"/>
						<cell align="center" col="8" color="user21" display="text" font="굴림,9" text="출고수량"/>
						<cell align="center" bkcolor="user23" col="9" color="user21" display="text" font="굴림,9" text="출고수량"/>
					</head>
					<body>
						<cell align="center" bkcolor2="user22" col="0" display="text" expr="CURROW+1"/>
						<cell align="center" bkcolor2="user22" col="1" colid="POSID" display="text" edit="uppernumchar" limit="9"/>
						<cell align="left" bkcolor2="user22" col="2" colid="ZSITE_NM" combodisplayrowcnt="10" display="text" edit="normal" limit="30"/>
						<cell align="center" bkcolor2="user22" col="3" colid="NAMET" display="text"/>
						<cell align="center" bkcolor2="user22" col="4" colid="SCNT" display="number" edit="normal" suppress="3"/>
						<cell align="center" bkcolor2="user22" col="5" colid="SPEC" display="text" edit="normal" suppress="3"/>
						<cell align="center" bkcolor2="user22" col="6" colid="RELDATE" display="text" expandimage="btn_grid_icon_pen" expandshow="true" Mask="####.##.##" suppress="1"/>
						<cell align="center" bkcolor2="user22" col="7" colid="RELMAN" display="text" edit="normal" limit="5" suppress="1"/>
						<cell align="center" bkcolor2="user22" col="8" colid="ZZACTSS" display="number" edit="normal" limit="6" suppress="3"/>
						<cell align="center" bkcolor2="user22" col="9" colid="SCNT2" display="number" edit="normal" limit="6" suppress="3"/>
					</body>
				</format>
				<format id="Default1">
					<columns>
						<col width="28"/>
						<col width="0"/>
						<col width="0"/>
						<col width="0"/>
						<col width="0"/>
						<col width="0"/>
						<col width="1"/>
						<col width="0"/>
						<col width="85"/>
						<col width="0"/>
						<col width="95"/>
						<col width="0"/>
						<col width="0"/>
						<col width="63"/>
					</columns>
					<head>
						<cell align="center" col="0" color="user34" display="text" font="굴림,9" text="NO"/>
						<cell col="1" display="text"/>
						<cell align="center" col="2" color="user21" display="text" font="굴림,9" text="입고일"/>
						<cell align="center" col="3" color="user21" display="text" font="굴림,9" text="프로젝트&#32;L&#32;No."/>
						<cell align="center" col="4" color="user21" display="text" font="굴림,9" text="현장명"/>
						<cell align="center" col="5" color="user21" display="text" font="굴림,9" text="작업팀장"/>
						<cell align="center" col="6" color="user21" display="text" font="굴림,9" text="수량"/>
						<cell col="7" display="text"/>
						<cell align="center" bkcolor="user23" col="8" color="user21" display="text" font="굴림,9" text="입고일"/>
						<cell col="9" display="text"/>
						<cell align="center" bkcolor="user23" col="10" color="user21" display="text" font="굴림,9" text="자재&#32;입고자"/>
						<cell align="center" col="11" color="user21" display="text" font="굴림,9" text="자재&#32;회수자"/>
						<cell align="center" col="12" color="user21" display="text" font="굴림,9" text="출고수량"/>
						<cell align="center" bkcolor="user23" col="13" color="user21" display="text" font="굴림,9" text="입고수량"/>
					</head>
					<body>
						<cell align="center" bkcolor2="user22" col="0" display="text" expr="CURROW+1"/>
						<cell col="1" display="text"/>
						<cell align="center" bkcolor2="user22" col="2" colid="COLDATE" display="text" expandimage="btn_grid_icon_pen" expandshow="true" Mask="####.##.##" suppress="1"/>
						<cell align="center" bkcolor2="user22" col="3" colid="POSID" display="text" edit="uppernumchar" limit="9"/>
						<cell align="left" bkcolor2="user22" col="4" colid="ZSITE_NM" combodisplayrowcnt="10" display="text"/>
						<cell align="center" bkcolor2="user22" col="5" colid="NAMET" display="text"/>
						<cell align="center" bkcolor2="user22" col="6" colid="SCNT" display="number" edit="normal" suppress="3"/>
						<cell col="7" display="text"/>
						<cell align="center" bkcolor2="user22" col="8" colid="COLDATE" display="text" expandimage="btn_grid_icon_pen" expandshow="true" Mask="####.##.##" suppress="1"/>
						<cell col="9" display="text"/>
						<cell align="center" bkcolor2="user22" col="10" colid="COLMAN" display="text" edit="normal" limit="5" suppress="1"/>
						<cell align="center" bkcolor2="user22" col="11" colid="SPEC" display="text" edit="normal" suppress="3"/>
						<cell align="center" bkcolor2="user22" col="12" colid="ZZACTSS" display="number" edit="normal" limit="6" suppress="3"/>
						<cell align="center" bkcolor2="user22" col="13" colid="SCNT2" display="number" edit="number" limit="5" suppress="3"/>
					</body>
				</format>
				<format id="Default2">
					<columns>
						<col width="28"/>
						<col width="95"/>
						<col width="160"/>
						<col width="80"/>
						<col width="150"/>
						<col width="0"/>
						<col width="85"/>
						<col width="85"/>
						<col width="80"/>
						<col width="85"/>
						<col width="0"/>
						<col width="0"/>
						<col width="108"/>
					</columns>
					<head>
						<cell align="center" col="0" color="user34" display="text" font="굴림,9" text="NO"/>
						<cell align="center" col="1" color="user21" display="text" font="굴림,9" text="프로젝트&#32;L&#32;No."/>
						<cell align="center" col="2" color="user21" display="text" font="굴림,9" text="현장명"/>
						<cell align="center" col="3" color="user21" display="text" font="굴림,9" text="PM"/>
						<cell align="center" bkcolor="user23" col="4" color="user21" display="text" font="굴림,9" text="시리얼&#32;넘버"/>
						<cell align="center" col="5" color="user21" display="text" font="굴림,9" text="시리얼&#32;넘버"/>
						<cell align="center" col="6" color="user21" display="text" font="굴림,9" text="출고일"/>
						<cell align="center" col="7" color="user21" display="text" font="굴림,9" text="자재&#32;출고자"/>
						<cell align="center" bkcolor="user23" col="8" color="user21" display="text" font="굴림,9" text="회수일"/>
						<cell align="center" bkcolor="user23" col="9" color="user21" display="text" font="굴림,9" text="자재&#32;회수자"/>
						<cell align="center" col="10" color="user21" display="text" font="굴림,9" text="수량"/>
						<cell align="center" col="11" color="user21" display="text" font="굴림,9" text="자재&#32;회수자"/>
						<cell align="center" bkcolor="user23" col="12" color="user21" display="text" font="굴림,9" text="시리얼&#32;번호&#32;변경"/>
					</head>
					<body>
						<cell align="center" bkcolor2="user22" col="0" display="text" expr="CURROW+1"/>
						<cell align="center" bkcolor2="user22" col="1" colid="POSID" display="text" edit='expr:iif(SCNT&#32;=&#32;1,&quot;uppernumchar&quot;,&quot;none&quot;)' limit="9"/>
						<cell align="left" bkcolor2="user22" col="2" colid="ZSITE_NM" combodisplayrowcnt="10" display="text"/>
						<cell align="center" bkcolor2="user22" col="3" colid="NAMET" display="text"/>
						<cell align="left" bkcolor2="user22" col="4" colid="SERIAL3" combodisplayrowcnt="6" display="text" edit='expr:iif(SERIAL_CH&#32;=&#32;&quot;X&quot;,&quot;uppernumchar&quot;,&quot;none&quot;)' limit="40"/>
						<cell align="left" bkcolor2="user22" col="5" colid="SERIAL2" combodisplayrowcnt="6" display="text" edit="normal"/>
						<cell align="center" bkcolor2="user22" col="6" colid="RELDATE" display="text" expandimage="btn_grid_icon_pen" expandshow='expr:iif(SCNT&#32;=&#32;0&#32;,&quot;false&quot;&#32;,&quot;true&quot;)' Mask="####.##.##" suppress="1"/>
						<cell align="center" bkcolor2="user22" col="7" colid="RELMAN" display="text" edit="expr:iif(SCNT&#32;=&#32;0&#32;,&#32;&apos;none&apos;,&#32;&apos;normal&apos;)" limit="5" suppress="1"/>
						<cell align="center" bkcolor2="user22" col="8" colid="COLDATE" display="text" expandimage="btn_grid_icon_pen" expandshow='expr:iif(SCNT&#32;=&#32;0&#32;,&quot;true&quot;,&quot;false&quot;&#32;)' Mask="####.##.##" suppress="2"/>
						<cell align="center" bkcolor2="user22" col="9" colid="COLMAN" display="text" edit="expr:iif(SCNT&#32;=&#32;0&#32;,&#32;&apos;normal&apos;,&#32;&apos;none&apos;)" suppress="3"/>
						<cell align="center" bkcolor2="user22" col="10" colid="SCNT" display="number" edit="normal" suppress="3"/>
						<cell align="center" bkcolor2="user22" col="11" colid="SPEC" display="text" edit="normal" suppress="3"/>
						<cell align="center" bkcolor2="user22" col="12" colid="SERIAL_CH" combocol="CODE" combodataset="ds_gbn" combotext="CODE_NAME" display="combo" edit="combo" suppress="3"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Static Align="Right" Height="20" Id="Static0" Left="200" Style="sty_lb_search" TabOrder="6" Text="자재구분&#32;" Top="3" VAlign="Middle" Width="80"></Static>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="CODE" Column="CODE2" DataColumn="CODE_Nm" Height="20" Id="cb_gbn2" InnerDataset="ds_code2" Left="285" OnChanged="cb_gbn2_OnChanged" Style="sty_ipt_search" TabOrder="7" Top="3" Width="80"></Combo>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="CODE" Column="CODE3" DataColumn="CODE_NM" Height="20" Id="cb_gbn3" InnerDataset="ds_code3" Left="458" OnChanged="cb_gbn3_OnChanged" Style="sty_ipt_search" TabOrder="8" Top="4" Width="80"></Combo>
		<Static Align="Right" Height="20" Id="Static1" Left="374" Style="sty_lb_search" TabOrder="9" Text="기종&#32;" Top="4" VAlign="Middle" Width="80"></Static>
		<Static Align="Right" Height="20" Id="Static2" Left="9" Style="sty_lb_search" TabOrder="11" Text="파트명&#32;" Top="28" VAlign="Middle" Width="80"></Static>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="CODE" Column="CODE4" DataColumn="CODE_NM" Height="20" Id="cb_code4" InnerDataset="ds_code4" Left="93" OnChanged="cb_code4_OnChanged" Style="sty_ipt_search" TabOrder="10" Top="27" Width="200"></Combo>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="CODE" Column="CODE5" DataColumn="CODE_NM" Height="20" Id="cb_code5" InnerDataset="ds_code5" Left="458" Style="sty_ipt_search" TabOrder="12" Top="27" Width="200"></Combo>
		<Static Align="Right" Height="20" Id="Static3" Left="374" Style="sty_lb_search" TabOrder="13" Text="품명&#32;" Top="28" VAlign="Middle" Width="80"></Static>
		<Calendar Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="146" Id="cal_temp" Left="1064" MonthOnly="TRUE" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" OnDayClick="cal_temp_OnDayClick" OnKillFocus="cal_temp_OnKillFocus" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="14" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="168" Value="20080401" Visible="FALSE" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="152"></Calendar>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_sms" ImageID="btn_sub_04" Left="889" LeftMargin="12" OnClick="btn_sms_OnClick" Style="sty_btn" TabOrder="15" Text="쪽지발송" Top="27" Transparent="TRUE" Width="75"></Button>
	</Form>
	<Script><![CDATA[﻿﻿﻿﻿﻿﻿/*
 ******************************************************************************************
 * 기      능   : 
 * 작  성  자   : 
 * 작성  일자   : 
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
#include "LIB::commons.js";	// 공통 스크립트 
//=========================================================================================
// [ PART 1 ]
// Form에서 사용될 전역변수를 선언
// FORM에서 사용되는 전역변수는 대문자로 작성하며, F_XXX 의 형태를 갖도록 한다. 
//=========================================================================================
var userGroup;
var nRows;
var preTemno;
//=========================================================================================
// [ PART 2 ]
// Form Loading / Unloading 시 작업 정의
//=========================================================================================
function fn_OnLoadCompleted(obj) {
	// Form 로드 이벤트 맨 첫줄에 기술 
	gfn_initForm();

	userGroup = gfn_getUserGroup();
	
	//fn_makeYear(substr(gfn_getCurrDate(),0,4),-10,0);
	//cb_month.index = parseInt(substr(gfn_getCurrDate(),4,2))-1;
	//var codeArr = ["PS003"];
    //var dsObjArr = [ds_zzactss];
    //var addTypeArr = [G_CODE_ALL];
    //gfn_searchCommCode(codeArr, dsObjArr, addTypeArr);
    if( G_USER_ID == '2022702' or G_USER_ID == '2018900'or G_USER_ID == '2021102') //미입고 자제 경고 쪽지 발송 권한
    {
       btn_sms.Visible = true;
    }
    else
    { 
       btn_sms.Visible = false;
    }
    if(userGroup == '10')
	{
		
	}
	else
	{

	}

	tit_clearActionInfo();
	tit_addSearchActionInfo("ps02:PS0206007A_S1");
	tit_addSearchActionInfo("ps02:PS0206007A_S2");
	tit_addSearchActionInfo("ps02:PS0206007A_S3");
	tit_addSearchActionInfo("ps02:PS0206007A_S4");
	tit_addSearchActionInfo("ps02:PS0206007A_S5");
	tit_addSearchActionInfo("ps02:PS0206007A_S14");	
    
	tit_callService(
		""
		, ""
		, "ds_cond_cd=ds_cond"
		, "ds_code=ds_code ds_code2=ds_code2 ds_code3=ds_code3 ds_code4=ds_code4 ds_code5=ds_code5 ds_zzactss=ds_zzactss"//"ds_error_cd=ds_error_cd"
		, ""
		, ""//"fn_aftercode"
		, true,true);
		
	//	trace(ds_code.SaveXML));

}
/********************************************************************************
* 기      능   : 지급예정년 계산(현재년도,당해년도에서 뺄 년수, 당해년도에서 더할 년수
********************************************************************************/
function fn_makeYear(curYear,sNum,eNum)
{

}
/********************************************************************************
* 기      능   : 공통코드가 조회된 후의 Callback 함수 
********************************************************************************/
function fn_completeInit(sCode, sDsObj, sCodeType) {
}
/********************************************************************************
* 기      능   : form UnloadCompleted 
********************************************************************************/
function fn_OnUnloadCompleted(obj) {
	return gfn_isFormUnload(obj);
}
//=========================================================================================
// [ PART 3 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,form닫기)
//=========================================================================================
/********************************************************************************
* 기      능   : 조회 
********************************************************************************/
function fn_query() {
//	ds_list2.Clear();

	tit_clearActionInfo();
	tit_addSearchActionInfo("ps02:PS0206007A_S6");

	tit_callService(
        ""
        , ""
        , "ds_cond=ds_cond"
        , "ds_list=ds_list"
        , ""//arg
        , ""//"fn_afterQuery"
        , true);
}

/********************************************************************************
* 기      능   : grid double click 시 조회  -- 전기
********************************************************************************/
function fn_query2(nRow) {
//alert("b");
	ds_list2.ClearData();
	
	ds_cond2.ClearData();
	ds_cond2.AddRow();

    ds_cond2.SetColumn(0,"SERIAL",ds_list.GetColumn(nRow,"SERIAL"));
    ds_cond2.SetColumn(0,"SERIAL3",ds_list.GetColumn(nRow,"SERIAL"));
    ds_cond2.SetColumn(0,"ZZACTSS",ds_list.GetColumn(nRow,"ZZACTSS"));
    ds_cond2.SetColumn(0,"CHK",ds_zzactss.GetColumn(0,"CHK"));
    ds_cond2.SetColumn(0,"SPRT",ds_list.GetColumn(nRow,"SPRT"));
   // ds_cond2.SetColumn(0,"SERIAL2",ds_list.GetColumn(nRow,"SERIAL"));
 //    ds_cond2.SetColumn(0,"SERIAL2",ds_list.GetColumn(nRow,"SERIAL"));
	ds_cond2.SetColumn(0,"SPEC",ds_list.GetColumn(nRow,"SPEC"));
	ds_cond2.SetColumn(0,"SCNT",ds_list.GetColumn(nRow,"SCNT"));	
	tit_clearActionInfo();
	if(ds_list.GetColumn(nRow,"SCNT") > 0)
	{ //alert("2");
	  tit_addSearchActionInfo("ps02:PS0206007A_S9", null, true);
	}
	else
	{//ALERT("c");
	  tit_addSearchActionInfo("ps02:PS0206007A_S7", null, true);
	}
	tit_callService(
        ""
        , ""
        , "ds_cond2=ds_cond2"
        , "ds_list2=ds_list2"
        , ""
        , ""//"fn_afterQuery2"
        , true);
}
/********************************************************************************
* 기      능   : grid double click 시 조회  -- 기계
********************************************************************************/
function fn_query3(nRow) {

	ds_list2.ClearData();
	
	ds_cond2.ClearData();
	ds_cond2.AddRow();

    //ds_cond2.SetColumn(0,"SERIAL",ds_list.GetColumn(nRow,"SERIAL"));
   // ds_cond2.SetColumn(0,"SERIAL2",ds_list.GetColumn(nRow,"SERIAL"));
	ds_cond2.SetColumn(0,"SPEC",ds_list.GetColumn(nRow,"SPEC"));
	ds_cond2.SetColumn(0,"SCNT",ds_list.GetColumn(nRow,"SCNT"));	
	
	ds_cond2.SetColumn(0,"ZZACTSS",ds_list.GetColumn(nRow,"ZZACTSS"));	
	
	tit_clearActionInfo();
	//if(ds_list.GetColumn(nRow,"SCNT") > 0)
	//{
	  tit_addSearchActionInfo("ps02:PS0206007A_S11", null, true);
	//}
	//else
	//{
	 // tit_addSearchActionInfo("ps02:PS0206007A_S7", null, true);
	//}
	tit_callService(
        ""
        , ""
        , "ds_cond2=ds_cond2"
        , "ds_list2=ds_list2"
        , ""
        , ""//"fn_afterQuery2"
        , true);
    
  
        
}
/********************************************************************************
* 기      능   : 저장 전 필수값 확인
********************************************************************************/
function fn_save() {
//trace(ds_list2.SaveXML());
  /*  if(length(ds_list2.GetColumn(0,"POSID")) < 9 )
    {
    	gfn_showMsg("CW00038","프로젝트호기"); 
		return;
    }
 */  
	if(grd_list2.Format = "Default" )
	{// alert("1");     			
      if(length(ds_list2.GetColumn(0, "RELDATE"))<=0 || ds_list2.GetColumn(0, "RELDATE")=='00000000'|| ds_list2.GetColumn(0, "RELDATE")=='' || length(ds_list2.GetColumn(0, "RELMAN"))<=0 )
      {
		gfn_showMsg('CW10027', "출고일ㆍ출고자");
		return;
  	  } 
	  else 
	   {
	   	ds_list2.SetColumn(0,"SCNT", 0 );
	   }	
    }
	else if (grd_list2.Format = "Default2" )
    {//alert("c");
       if(length(ds_list2.GetColumn(0, "COLDATE"))<=0 || ds_list2.GetColumn(0, "COLDATE")=='00000000'|| ds_list2.GetColumn(0, "COLDATE")=='' || length(ds_list2.GetColumn(0, "COLMAN"))<=0 )
      {
		gfn_showMsg('CW10027',  "회수일ㆍ회수자" );
		return;
  	  } 
	  else 
	   {
	   	 ds_list2.SetColumn(0,"SCNT", 1 );
	   }
	   if( ds_list2.GetColumn(0, "RELDATE") > ds_list2.GetColumn(0, "COLDATE"))
	   {
	     var arrs = ['회수일', '출고일'];
	     gfn_showMsg('CW00024',arrs);
	     return;
	   }
	}
	else if(grd_list2.Format = "Default0")
	{
	  if(length(ds_list2.GetColumn(0, "RELDATE"))<=0 || ds_list2.GetColumn(0, "RELDATE")=='00000000'|| ds_list2.GetColumn(0, "RELDATE")=='' || length(ds_list2.GetColumn(0, "RELMAN"))<=0  || ds_list2.GetColumn(0, "SCNT2") =='')
      {
		gfn_showMsg('CW10027', "입고일ㆍ입고수량ㆍ입고자");
		return;
  	  } 
	
	}
	else if(grd_list2.Format = "Default1")
	{
	  if(length(ds_list2.GetColumn(0, "COLDATE"))<=0 || ds_list2.GetColumn(0, "COLDATE")=='00000000'|| ds_list2.GetColumn(0, "COLDATE")=='' || length(ds_list2.GetColumn(0, "COLMAN"))<=0  ||  ds_list2.GetColumn(0, "SCNT2") =='')
      {
		gfn_showMsg('CW10027', "출고일ㆍ출고수량ㆍ출고자");
		return;
  	  } 
	}
	
  //해당데이타를 저장하시겠습니까?
  if(!gfn_showConfirm( "CI00014", "해당 데이터" )) return;
	
//alert("끝");
//trace(ds_list2.SaveXML());
//alert(length(ds_list2.GetColumn(0,"POSID")));
 fn_afterSave();
/*


alert(ds_list3.GetColumn(0,"MTART"));
	tit_clearActionInfo();
	if(ds_list2.GetColumn(i,"MTART") == "Q")
	{ alert("a");
      if(ds_list2.GetColumn(i,"SCNT") = 1 )
       {alert("b");
          ds_list2.SetColumn(i,"SCNT", 0 );
	     //alert(ds_list2.GetColumn(i,"SCNT"));
	      tit_addMultiActionInfo("ps02:PS0206007A_I1");
	      tit_addMultiActionInfo("ps02:PS0206007A_U1");
	   }
	   else 
       {   alert("c");
         ds_list2.SetColumn(i,"SCNT", 1 );
	     // alert(ds_list2.GetColumn(i,"SCNT"));
	     tit_addMultiActionInfo("ps02:PS0206007A_U2");
  	     tit_addMultiActionInfo("ps02:PS0206007A_U1");
	   }
	}
	else
	{alert("d");
	 //  if(ds_list2.GetColumn(i,"SCNT") > 0 )
      // {
	     //alert(ds_list2.GetColumn(i,"SCNT"));
	      tit_addMultiActionInfo("ps02:PS0206007A_I2");
	      tit_addMultiActionInfo("ps02:PS0206007A_U3");
	  
	
	
	}
	tit_callService(
	""
		, ""
		, "ds_list2=ds_list3"
		, ""
		, ""
		, "fn_afterSave"
		, ""
		, ""
	    , true);
		
*/
}
//trace(ds_list2.SaveXML());

}
/********************************************************************************
* 기      능   : 닫기  
********************************************************************************/
function fn_close() {
	close();
}

//=========================================================================================
// [ PART 4]
// Callback 함수 정의 : callback 함수명은 메인 함수의 fn_xxxx() 에서 xxxx 부분은 fn_afterXXXX()
// 형태가 되도록 작성 
//=========================================================================================
/********************************************************************************
* 기      능   : 조회 Callback  
********************************************************************************/
function fn_afterQuery(errCode, errMsg) {

}
/********************************************************************************
* 기      능   : 조회 Callback  
********************************************************************************/
function fn_afterQuery2(errCode, errMsg) {
	//grd_list2.SetCellProp("head",1,"text",ds_list2.rowcount+" 명");
	//gfn_showMsg("CI00002",ds_list2.RowCount()+"");
}

/********************************************************************************
* 기      능   : 저장 Callback  
********************************************************************************/
function fn_afterSave(errCode, errMsg) {

//trace(ds_list2.SaveXML());
	ds_list2.Filter();
	ds_list3.copyF(ds_list2);
	ds_list2.unFilter();
	//trace(ds_list2.SaveXML());

  if(grd_list2.Format = "Default" )
   {//alert("b");
    //alert(ds_list2.GetColumn(i,"SCNT"));
	tit_addMultiActionInfo("ps02:PS0206007A_I1");
	tit_addMultiActionInfo("ps02:PS0206007A_U1");
   }
   else if(grd_list2.Format = "Default2")
   {//alert("c");
	// alert(ds_list2.GetColumn(i,"SCNT"));
	if(ds_list2.GetColumn(0,"SERIAL_CH") == "X")
	{ //alert("d");
  	 tit_addMultiActionInfo("ps02:PS0206007A_U4");
  	 tit_addMultiActionInfo("ps02:PS0206007A_I3");
	 tit_addMultiActionInfo("ps02:PS0206007A_U2");
	}
	else
	{
 	 tit_addMultiActionInfo("ps02:PS0206007A_U2");
  	 tit_addMultiActionInfo("ps02:PS0206007A_U1");
	}
	}
	
	else if(grd_list2.Format = "Default1")
	{
     tit_addMultiActionInfo("ps02:PS0206007A_I4");
  	 tit_addMultiActionInfo("ps02:PS0206007A_U3");
	}
	else
	{
     tit_addMultiActionInfo("ps02:PS0206007A_I2");
  	 tit_addMultiActionInfo("ps02:PS0206007A_U3");
	}

       tit_callService(
          ""
		, ""
		, "ds_list2=ds_list3"
		, ""
		, ""
		, "fn_afterSave2"
		, ""
		, ""
	    , true);
	/*if ( errCode!= 0 ) {
		gfn_showMsg("CE00001");
	} else {
		gfn_showMsg("CI00003");
		fn_query();
	}
*/	

}
/********************************************************************************
* 기      능   : 저장 Callback  
********************************************************************************/
function fn_afterSave2(errCode, errMsg) {

  if ( errCode!= 0 ) {
	   gfn_showMsg("CE00001");
	} else {
		gfn_showMsg("CI00003");
		ds_list2.ClearData();
		fn_query();
	}

}
/********************************************************************************
* 기      능   : 조회 Callback  - 설치협력사 로그인시 협력업체코드 첫번째 선택
********************************************************************************/
function fn_afterLifnr(errCode, errMsg) {

 
}
//=========================================================================================
// [ PART 5 ]
// Detail Process Event 정의 ( User Define function )
// 사용자 정의 함수는 ufn_xxxx() 형태로 작성 
//=========================================================================================
/********************************************************************************
* 기      능   : 사용자 정의 함수  
********************************************************************************/
function ufn_userfunction() {
}
//=========================================================================================
// [ PART 6 ]
// component Event 정의 : 각 Component 별 이벤트 
//=========================================================================================
/********************************************************************************
* 기      능   : 액셀  
********************************************************************************/
function fn_excel() {
	gfn_saveToExcel(grd_list, true );
}
/********************************************************************************
* 기      능   : 데이터셋 값 변경 시
********************************************************************************/

/********************************************************************************
* 기      능   : 협력업체 FILTERING
********************************************************************************/
function grd_list_OnCellClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
//ALERT(ds_zzactss.GetColumn(0,"CODE"));
 if(length(ds_zzactss.GetColumn(0,"CODE")) > 0 )
{
   if(ds_list.GetColumn(nRow,"MTART") == "Q" )
   {
     if(ds_list.GetColumn(nRow,"SCNT") > 0)
     {// alert("1");
        grd_list2.Format = "Default";
        fn_query2(nRow);
     }
     else
     { //alert("a");
       grd_list2.Format = "Default2";
       fn_query2(nRow);
     }
   }
   else
   {
     if(ds_list.GetColumn(nRow,"SCNT") > 0 )
     {
       grd_list2.Format = "Default0";
     }
     else
     { 
       grd_list2.Format = "Default1";
     }
     
    fn_query3(nRow);
   }
}
else
{           
  //ds_list2.ClearData();
  ds_list2.ClearData();
  global.FRM_BOTTOM.img_msgType.imageId = "bottom_icon_caution";
  global.FRM_BOTTOM.st_msg.color = "yellow";       
  global.FRM_BOTTOM.st_msg.value = "STOCK 자재 출고 담당자만 입력 가능합니다.";
 // ds_list2.ClearData();
}
}
/********************************************************************************
* 기      능   : 헤더클릭
********************************************************************************/
function grd_list_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
{
	if ( nCell == 0 ) {
		// 그리드 표시할 컬럼 선택 
		gfn_selectGridCol(obj);
	} else {
		// 그리드 정렬 처리 
		gfn_sortGrid(obj,nCell);
	}
}
/********************************************************************************
* 기      능   : 헤더클릭
********************************************************************************/
function grd_list2_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
{
	if ( nCell == 0 ) {
		// 그리드 표시할 컬럼 선택 
		gfn_selectGridCol(obj);
	} else {
		// 그리드 정렬 처리 
		gfn_sortGrid(obj,nCell);
	}
}
/********************************************************************************
* 기      능   : 데이터셋 값 변경 시 - Flag 처리
********************************************************************************/

function cb_gbn2_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
 //   code2 = (ds_cond.GetColumn(0,"CODE2"));
 //   ds_code3.FILTER("CODE2==" + quote( code2));	
}

function cb_gbn3_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	// code3 = (ds_cond.GetColumn(0,"CODE3"));
    // ds_code4.FILTER("CODE3==" + quote( code3));	
}

function cb_code4_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	 //code4 = substr(ds_cond.GetColumn(0,"CODE4"),0,3);
	 //alert(code4);
    // ds_code5.FILTER("CODE4==" + quote( code4));	
}

/********************************************************************************
* 기      능   : cell이동시 프로젝트정보 자동검색
********************************************************************************/
function grd_list2_OnCellPosChanged(obj,nRow,nCell,nOldRow,nOldCell,nPivotIndex,nOldPivotIndex)
{
  if(grd_list2.Format <> "Default2" && grd_list2.Format <> "Default1" )
  {
	  if(nOldCell = 1 && length(ds_list2.GetColumn(nOldRow,"POSID")) = 9 )
	  {// alert("a");
		currRow = nOldRow;
		fn_posid(ds_list2.GetColumn(nOldRow,"POSID"));
	  }
   }
   else
  {//alert("b");
  fn_afterPosid();
  }
}

/********************************************************************************
* 기      능   : 조회 (header 조회)
********************************************************************************/
function fn_posid(posid) {

	
	ds_list2.SetColumn(0,"POSID",posid);
	ds_list2.SetColumn(0,"MTART",ds_list.GetColumn(nRow,"MTART"));	
	ds_list2.SetColumn(0,"SCNT",ds_list.GetColumn(nRow,"SCNT"));
	ds_list2.SetColumn(0,"ZZACTSS",ds_list.GetColumn(nRow,"ZZACTSS"));	
	
	
//alert(ds_list2.GetColumn(0,"MTART"));
	tit_clearActionInfo();
	if(ds_list2.GetColumn(0,"MTART") == "Q") //전기
	{//alert("1");
	  if(ds_list2.GetColumn(0,"SCNT") > 0)
	  {//alert("2");
	    tit_addSearchActionInfo("ps02:PS0206007A_S8");
	  }
	  else
	  {//alert("3");
	    tit_addSearchActionInfo("ps02:PS0206007A_S10");
	  }
	 }
	 else if(ds_list2.GetColumn(0,"MTART") == "P")//기계
	 {//alert("4");
	//   alert(ds_list2.GetColumn(0,"SCNT"));
	//  if(ds_list2.GetColumn(0,"SCNT") > 0)
	 // {//alert("5");
	    tit_addSearchActionInfo("ps02:PS0206007A_S13");
	  //}
	 // else
	  //{//alert("6");
	   // tit_addSearchActionInfo("ps02:PS0206007A_S10");
	 // }
	 }
	
	 
	tit_callService(
        ""
        , ""
        , "ds_list2=ds_list2"
        , "ds_list2=ds_list3"
        , ""
        , "fn_afterPosid"
        , true);
        
  //alert(ds_list2.GetColumn(0,"ZZACTSS"));
}

function fn_afterPosid(errCode, errMsg) {
     
     ds_list2.SetColumn(0,"SERIAL",ds_cond2.GetColumn(0,"SERIAL"));
     ds_list2.SetColumn(0,"SERIAL2",ds_cond2.GetColumn(0,"SERIAL"));
     ds_list2.SetColumn(0,"SPEC",ds_cond2.GetColumn(0,"SPEC"));
     ds_list2.SetColumn(0,"SCNT",ds_cond2.GetColumn(0,"SCNT"));
}

// grd_list2 달력 처리 부분 
/********************************************************************************
* 기      능   : 그리드에서 날짜 입력시 
********************************************************************************/
function grd_list2_OnExpandEdit(obj,nRow,nCell,strVal,nPivotIndex)
{
	var rect = obj.GetCellRect(nRow, ncell);
	var widths = this.Width - 160;
	var heights = this.Height - 160;

	cal_temp.top = rect[1] + 60;
	if (cal_temp.top > heights)
	{
		cal_temp.top = heights;
	}
	cal_temp.Left = rect[0] + 10;
	if (cal_temp.Left > widths)
	{
		cal_temp.Left = widths;
	}	
	
	cal_temp.Visible = true;

	if(nCell == 6)	{
		cal_temp.value = ds_list2.getColumn(nRow, "RELDATE");	
	} else if(nCell == 2)	{
		cal_temp.value = ds_list2.getColumn(nRow, "COLDATE");	
	} else if(nCell == 8)	{
		cal_temp.value = ds_list2.getColumn(nRow, "COLDATE");	
	}	
	cal_temp.SetFocus();
//	trace(ds_list2.SaveXML());
}
/********************************************************************************
* 기      능   : 달력에서 일자 선택했을 경우 
********************************************************************************/
function cal_temp_OnDayClick(obj,strText)
{
	gfn_clearMsgBar();

	if(grd_list2.GetClickedCell() == 6)	{
		ds_list2.setColumn(ds_list2.row, "RELDATE", strText);
	} else if(grd_list2.GetClickedCell() == 2)	{
		ds_list2.setColumn(ds_list2.row, "COLDATE", strText);
    } else if(grd_list2.GetClickedCell() == 8)	{
	    ds_list2.setColumn(ds_list2.row, "COLDATE", strText);
	} 
	obj.Visible = false;
}
/********************************************************************************
* 기      능   : 달력에서 포커스 잃었을 경우 
********************************************************************************/
function cal_temp_OnKillFocus(obj)
{
	obj.Visible = false;
}


function ds_list2_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{
  var arr;
	if(strColumnID == "SCNT2") {
       if(ds_list2.GetColumn(0,"SCNT") > 0 )
       {
           arr = ToNumber(ds_list2.GetColumn(0,"SCNT")) - ToNumber(ds_list2.GetColumn(0,"SCNT2"));	     
	   }
	   else
	    {
	       arr = ToNumber(ds_list2.GetColumn(0,"SCNT2"));
	    }
	        ds_list2.SetColumn(0, "SCNT", arr);
	 }
	 
//trace(ds_list2.SaveXML());	  
}

function grd_list2_OnCellClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{ //ALERT("A");
//	if(strColumnID == "SERIAL_CH") {
//	ds_list2.SetColumn(0,"SERIAL",'');
	//}
//ALERT(ds_list2.GetColumn(0,"SERIAL"));
}




/********************************************************************************
* 기      능   : 자재신청
********************************************************************************/
//function fn_request() 
function fn_request()
{    	

   if(ds_zzactss.GetColumn(0,"CHK") == "X")
   {   
      var chk 	= ds_zzactss.GetColumn(0,"ZZACTSS"); 
	  gfn_openPopup("PS0206007B", true, chk);
   }
   else
   { 
     global.FRM_BOTTOM.img_msgType.imageId = "bottom_icon_caution";
     global.FRM_BOTTOM.st_msg.color = "yellow";       
     global.FRM_BOTTOM.st_msg.value = "STOCK 자재 담당자만 신청 가능합니다.";
   }
	 

}



/********************************************************************************
* 기      능   : 출고일 기준 30일 이상 미 입고시 쪽지 발송 
********************************************************************************/
function btn_sms_OnClick(obj)
{ // alert("a");
    
    tit_clearActionInfo();
	tit_addSearchActionInfo("ps02:PS0206007A_S16");
	tit_callService(
       ""
     , ""
     , "ds_cond=ds_cond"
     , "ds_trans=ds_trans"
     , ""
     , "fn_sms()"
     , true);
}

function fn_sms()
{//alert("B");
  	for(var i=0; i< ds_trans.GetRowCount(); i++)
  	{
  	 
	   var lv_mesgdesc = "";
	   var arr = ds_trans.GetColumn(i,"POSID");
			
	  // lv_mesgdesc = arr + '\n' + '호기의 시리얼 번호 [' + ds_trans.GetColumn(i, "ds_trans") + '] 자재가 1달 이상 입고되지 않았습니다.';
        lv_mesgdesc = '출고 후 30일이 지난 미회수 STOCK 자재가 있으니 확인하시고, STOCK 자재 관리 바랍니다.' ;
	    lv_mesgdesc = lv_mesgdesc + 'STOCK 자재 회수시, 반드시 회수일 및 자재 회수자 등록 해주시기 바랍니다.';
	    ds_trans.setcolumn(i, "MESGDESC", lv_mesgdesc);
       

  	}
  		 	
	   tit_clearActionInfo();		
	   tit_addMultiActionInfo("ps12:PS1205001A_I1");			
	   tit_callService(
		""
	  , ""
	  , "ds_trans=ds_trans"
	  , ""
	  , ""
   	  , ""  //"fn_afterQuery"
	  , "" //true
	  , ""
  	  , true);
  	
    }
 //  trace(ds_trans.SaveXML());
}
]]></Script>
</Window>