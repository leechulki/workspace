<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="584" Id="CS8001001B" Left="8" OnLoadCompleted="fn_OnLoadCompleted" OnUnloadCompleted="fn_OnUnloadCompleted" PidAttrib="7" Title="해외-견적&#32;작성" Top="8" Ver="1.0" Width="978" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_docno_gen">
				<Contents>
					<colinfo id="PFX" size="256" type="STRING"/>
					<colinfo id="DOCNO" size="256" type="STRING"/>
					<record>
						<PFX></PFX>
						<DOCNO></DOCNO>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_reqkind_cd">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE>1</CODE>
						<CODE_NAME>해외부품</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond">
				<Contents>
					<colinfo id="CST" size="256" summ="default" type="STRING"/>
					<colinfo id="QTNUM" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQNO" size="256" summ="default" type="STRING"/>
					<colinfo id="SPART" size="256" summ="default" type="STRING"/>
					<colinfo id="UPN" size="256" summ="default" type="STRING"/>
					<colinfo id="KUNNR" size="256" summ="default" type="STRING"/>
					<record>
						<CST></CST>
						<KUNNR></KUNNR>
						<QTNUM></QTNUM>
						<SEQ></SEQ>
						<SEQNO></SEQNO>
						<SPART></SPART>
						<UPN></UPN>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_pjt_det">
				<Contents>
					<colinfo id="ADDR" size="256" summ="default" type="STRING"/>
					<colinfo id="ADDRBILL" size="256" summ="default" type="STRING"/>
					<colinfo id="ARA" size="256" summ="default" type="STRING"/>
					<colinfo id="BLD" size="256" summ="default" type="STRING"/>
					<colinfo id="BLDNM" size="256" summ="default" type="STRING"/>
					<colinfo id="BPM" size="256" summ="default" type="STRING"/>
					<colinfo id="BPMNM" size="256" summ="default" type="STRING"/>
					<colinfo id="BSU" size="256" summ="default" type="STRING"/>
					<colinfo id="BSUNM" size="256" summ="default" type="STRING"/>
					<colinfo id="CST" size="256" summ="default" type="STRING"/>
					<colinfo id="ENAME" size="256" summ="default" type="STRING"/>
					<colinfo id="FAILYN" size="256" summ="default" type="STRING"/>
					<colinfo id="GNO" size="256" summ="default" type="STRING"/>
					<colinfo id="HNA" size="256" summ="default" type="STRING"/>
					<colinfo id="HNO" size="256" summ="default" type="STRING"/>
					<colinfo id="KUNNR" size="256" summ="default" type="STRING"/>
					<colinfo id="KUNNRNM" size="256" summ="default" type="STRING"/>
					<colinfo id="MNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="PNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="RATE" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="RATE2" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="SITENM" size="256" summ="default" type="STRING"/>
					<colinfo id="SPART" size="256" summ="default" type="STRING"/>
					<colinfo id="SPARTNM" size="256" summ="default" type="STRING"/>
					<colinfo id="TEL" size="256" summ="default" type="STRING"/>
					<colinfo id="TGB" size="256" summ="default" type="STRING"/>
					<colinfo id="UPN" size="256" summ="default" type="STRING"/>
					<colinfo id="VKBUR" size="256" summ="default" type="STRING"/>
					<colinfo id="VKBURNM" size="256" summ="default" type="STRING"/>
					<colinfo id="VKGRP" size="256" summ="default" type="STRING"/>
					<colinfo id="VKGRPNM" size="256" summ="default" type="STRING"/>
					<colinfo id="WAERS" size="256" summ="default" type="STRING"/>
					<colinfo id="WERKS" size="256" summ="default" type="STRING"/>
					<colinfo id="ZTERM" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_taxk1">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_zterm">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<colinfo id="DTEXT1" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_kvgr1">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_kvgr2">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_bwtar_cd">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset CanColumnChange="ds_list_CanColumnChange" DataSetType="Dataset" Id="ds_list" OnColumnChanged="ds_list_OnColumnChanged">
				<Contents>
					<colinfo id="AMOUNT" size="256" summ="default" type="STRING"/>
					<colinfo id="AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="BANNAB" size="256" summ="default" type="STRING"/>
					<colinfo id="BISMT" size="256" summ="default" type="STRING"/>
					<colinfo id="BLOCK_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="BRGEW" size="256" summ="default" type="STRING"/>
					<colinfo id="BWTAR" size="256" summ="default" type="STRING"/>
					<colinfo id="CGBN" size="256" summ="default" type="STRING"/>
					<colinfo id="CGBNNM" size="256" summ="default" type="STRING"/>
					<colinfo id="CGUBN" size="256" summ="default" type="STRING"/>
					<colinfo id="CHAR1" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="DZEINR" size="256" summ="default" type="STRING"/>
					<colinfo id="EXEDT" size="256" summ="default" type="STRING"/>
					<colinfo id="EXEID" size="256" summ="default" type="STRING"/>
					<colinfo id="EXTWG" size="256" summ="default" type="STRING"/>
					<colinfo id="EXXETM" size="256" summ="default" type="STRING"/>
					<colinfo id="FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="GEWEI" size="256" summ="default" type="STRING"/>
					<colinfo id="HNA" size="256" summ="default" type="STRING"/>
					<colinfo id="HNO" size="256" summ="default" type="STRING"/>
					<colinfo id="HTY" size="256" summ="default" type="STRING"/>
					<colinfo id="JOBHOUR" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="LCOSTC" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="LCOSTS" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="LGFSB" size="256" summ="default" type="STRING"/>
					<colinfo id="LVORM" size="256" summ="default" type="STRING"/>
					<colinfo id="MAKTX" size="256" summ="default" type="STRING"/>
					<colinfo id="MAN" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="MATKL" size="256" summ="default" type="STRING"/>
					<colinfo id="MATNR" size="256" summ="default" type="STRING"/>
					<colinfo id="MATNRNM" size="256" summ="default" type="STRING"/>
					<colinfo id="MATNRNM2" size="256" summ="default" type="STRING"/>
					<colinfo id="MEINS" size="256" summ="default" type="STRING"/>
					<colinfo id="MENGE" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="MTART" size="256" summ="default" type="STRING"/>
					<colinfo id="NETPR" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="NETPR_ORG" size="256" summ="default" type="STRING"/>
					<colinfo id="NETWR" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="NTGEW" size="256" summ="default" type="STRING"/>
					<colinfo id="OFRHOUR" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="PARLAB" size="256" summ="default" type="STRING"/>
					<colinfo id="PARLAB1" size="256" summ="default" type="STRING"/>
					<colinfo id="QTNUM" size="256" summ="default" type="STRING"/>
					<colinfo id="REQKIND" size="256" summ="default" type="STRING"/>
					<colinfo id="REQKIND_CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="REQKINDNM" size="256" summ="default" type="STRING"/>
					<colinfo id="RGBN" size="256" summ="default" type="STRING"/>
					<colinfo id="RGBNNM" size="256" summ="default" type="STRING"/>
					<colinfo id="SAMT2" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="SPEC" size="256" summ="default" type="STRING"/>
					<colinfo id="UCOST" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="UCOSTA" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="UCOSTR" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="UPR" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="VOLEH" size="256" summ="default" type="STRING"/>
					<colinfo id="VOLUM" size="256" summ="default" type="STRING"/>
					<colinfo id="WAERS" size="256" summ="default" type="STRING"/>
					<colinfo id="WEBAZ" size="256" summ="default" type="STRING"/>
					<colinfo id="WERKS" size="256" summ="default" type="STRING"/>
					<colinfo id="WRKST" size="256" summ="default" type="STRING"/>
					<colinfo id="ZGUBN" size="256" summ="default" type="STRING"/>
					<colinfo id="ZGUBN_CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSIZE" size="256" summ="default" type="STRING"/>
					<colinfo id="MRRAT" size="256" summ="default" type="STRING"/>
					<colinfo id="MAT_CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="MRGUBUN" size="256" summ="default" type="STRING"/>
					<colinfo id="KRWUSD" size="256" summ="default" type="STRING"/>
					<colinfo id="KRWEUR" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_gbn">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ma_list" OnColumnChanged="ds_list_OnColumnChanged">
				<Contents>
					<colinfo id="BANNAB" size="256" summ="default" type="STRING"/>
					<colinfo id="BISMT" size="256" summ="default" type="STRING"/>
					<colinfo id="BLOCK_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="BRGEW" size="256" summ="default" type="STRING"/>
					<colinfo id="DZEINR" size="256" summ="default" type="STRING"/>
					<colinfo id="EXEDT" size="256" summ="default" type="STRING"/>
					<colinfo id="EXEID" size="256" summ="default" type="STRING"/>
					<colinfo id="EXTWG" size="256" summ="default" type="STRING"/>
					<colinfo id="EXXETM" size="256" summ="default" type="STRING"/>
					<colinfo id="FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="GEWEI" size="256" summ="default" type="STRING"/>
					<colinfo id="JOBHOUR" size="256" summ="default" type="STRING"/>
					<colinfo id="LGFSB" size="256" summ="default" type="STRING"/>
					<colinfo id="LVORM" size="256" summ="default" type="STRING"/>
					<colinfo id="MAKTX" size="256" summ="default" type="STRING"/>
					<colinfo id="MAN" size="256" summ="default" type="STRING"/>
					<colinfo id="MATKL" size="256" summ="default" type="STRING"/>
					<colinfo id="MATNR" size="256" summ="default" type="STRING"/>
					<colinfo id="MATNRNM" size="256" summ="default" type="STRING"/>
					<colinfo id="MATNRNM2" size="256" summ="default" type="STRING"/>
					<colinfo id="MEINS" size="256" summ="default" type="STRING"/>
					<colinfo id="MENGE" size="256" summ="default" type="STRING"/>
					<colinfo id="MTART" size="256" summ="default" type="STRING"/>
					<colinfo id="NTGEW" size="256" summ="default" type="STRING"/>
					<colinfo id="PARLAB" size="256" summ="default" type="STRING"/>
					<colinfo id="PARLAB1" size="256" summ="default" type="STRING"/>
					<colinfo id="RGBN" size="256" summ="default" type="STRING"/>
					<colinfo id="RGBNNM" size="256" summ="default" type="STRING"/>
					<colinfo id="SAMT1" size="256" summ="default" type="STRING"/>
					<colinfo id="SAMT2" size="256" summ="default" type="STRING"/>
					<colinfo id="SAMT3" size="256" summ="default" type="STRING"/>
					<colinfo id="SPEC" size="256" summ="default" type="STRING"/>
					<colinfo id="UPR" size="256" summ="default" type="STRING"/>
					<colinfo id="VOLEH" size="256" summ="default" type="STRING"/>
					<colinfo id="VOLUM" size="256" summ="default" type="STRING"/>
					<colinfo id="WAERS" size="256" summ="default" type="STRING"/>
					<colinfo id="WEBAZ" size="256" summ="default" type="STRING"/>
					<colinfo id="WRKST" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSIZE" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ma_cond">
				<Contents>
					<colinfo id="BWTAR" size="256" summ="default" type="STRING"/>
					<colinfo id="LGORT" size="256" summ="default" type="STRING"/>
					<colinfo id="MATNR" size="256" summ="default" type="STRING"/>
					<colinfo id="NROW" size="256" summ="default" type="STRING"/>
					<colinfo id="SPART" size="256" summ="default" type="STRING"/>
					<colinfo id="WAERS" size="256" summ="default" type="STRING"/>
					<record>
						<BWTAR></BWTAR>
						<LGORT></LGORT>
						<MATNR></MATNR>
						<NROW></NROW>
						<SPART></SPART>
						<WAERS></WAERS>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_di_stk">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME></CODE_NAME>
					</record>
					<record>
						<CODE>Y</CODE>
						<CODE_NAME>Y</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_out_master">
				<Contents>
					<colinfo id="BILAMT1" size="256" summ="default" type="STRING"/>
					<colinfo id="BILAMT2" size="256" summ="default" type="STRING"/>
					<colinfo id="BILAMT3" size="256" summ="default" type="STRING"/>
					<colinfo id="BILDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="BILDAT2" size="256" summ="default" type="STRING"/>
					<colinfo id="BILDAT3" size="256" summ="default" type="STRING"/>
					<colinfo id="BSU" size="256" summ="default" type="STRING"/>
					<colinfo id="BSUNM" size="256" summ="default" type="STRING"/>
					<colinfo id="BUSSI" size="256" summ="default" type="STRING"/>
					<colinfo id="CHGBN" size="256" summ="default" type="STRING"/>
					<colinfo id="CRNAM" size="256" summ="default" type="STRING"/>
					<colinfo id="CRNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="CS001_GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="CST" size="256" summ="default" type="STRING"/>
					<colinfo id="CSTNM" size="256" summ="default" type="STRING"/>
					<colinfo id="DOC1" size="256" summ="default" type="STRING"/>
					<colinfo id="DOC1DEC" size="256" summ="default" type="STRING"/>
					<colinfo id="DOC1DRA" size="256" summ="default" type="STRING"/>
					<colinfo id="DOC1STAT" size="256" summ="default" type="STRING"/>
					<colinfo id="DOC1STATNM" size="256" summ="default" type="STRING"/>
					<colinfo id="DOC2" size="256" summ="default" type="STRING"/>
					<colinfo id="DOC2DEC" size="256" summ="default" type="STRING"/>
					<colinfo id="DOC2STAT" size="256" summ="default" type="STRING"/>
					<colinfo id="DOC2STATNM" size="256" summ="default" type="STRING"/>
					<colinfo id="DOC3" size="256" summ="default" type="STRING"/>
					<colinfo id="DOC3DEC" size="256" summ="default" type="STRING"/>
					<colinfo id="DOC3STAT" size="256" summ="default" type="STRING"/>
					<colinfo id="DOC3STATNM" size="256" summ="default" type="STRING"/>
					<colinfo id="DOC4" size="256" summ="default" type="STRING"/>
					<colinfo id="DOC4DEC" size="256" summ="default" type="STRING"/>
					<colinfo id="DOC4STAT" size="256" summ="default" type="STRING"/>
					<colinfo id="DOC4STATNM" size="256" summ="default" type="STRING"/>
					<colinfo id="DOC5" size="256" summ="default" type="STRING"/>
					<colinfo id="DOC5DEC" size="256" summ="default" type="STRING"/>
					<colinfo id="DOC5STAT" size="256" summ="default" type="STRING"/>
					<colinfo id="DOC5STATNM" size="256" summ="default" type="STRING"/>
					<colinfo id="FAILYN" size="256" summ="default" type="STRING"/>
					<colinfo id="FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="ID_RATE" size="256" summ="default" type="STRING"/>
					<colinfo id="KUNNR" size="256" summ="default" type="STRING"/>
					<colinfo id="KVGR1" size="256" summ="default" type="STRING"/>
					<colinfo id="KVGR2" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="MA_PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="NETWR_DC" size="256" summ="default" type="STRING"/>
					<colinfo id="NETWR_OFR" size="256" summ="default" type="STRING"/>
					<colinfo id="NETWR_STD" size="256" summ="default" type="STRING"/>
					<colinfo id="PGBN" size="256" summ="default" type="STRING"/>
					<colinfo id="PNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="QSTAT" size="256" summ="default" type="STRING"/>
					<colinfo id="QTAPDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="QTNAM" size="256" summ="default" type="STRING"/>
					<colinfo id="QTNUM" size="256" summ="default" type="STRING"/>
					<colinfo id="RATE" size="256" summ="default" type="STRING"/>
					<colinfo id="REMARK" size="256" summ="default" type="STRING"/>
					<colinfo id="REQKIND" size="256" summ="default" type="STRING"/>
					<colinfo id="REQKINDNM" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="SHDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="SOAPDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="SOCADAT" size="256" summ="default" type="STRING"/>
					<colinfo id="SOCHDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="SODAT" size="256" summ="default" type="STRING"/>
					<colinfo id="SPART" size="256" summ="default" type="STRING"/>
					<colinfo id="SPARTNM" size="256" summ="default" type="STRING"/>
					<colinfo id="SPT" size="256" summ="default" type="STRING"/>
					<colinfo id="SUM_OFR" size="256" summ="default" type="STRING"/>
					<colinfo id="SUM_STD" size="256" summ="default" type="STRING"/>
					<colinfo id="TAXK1" size="256" summ="default" type="STRING"/>
					<colinfo id="UPN" size="256" summ="default" type="STRING"/>
					<colinfo id="VKBUR" size="256" summ="default" type="STRING"/>
					<colinfo id="VKBURNM" size="256" summ="default" type="STRING"/>
					<colinfo id="VKGRP" size="256" summ="default" type="STRING"/>
					<colinfo id="VKGRPNM" size="256" summ="default" type="STRING"/>
					<colinfo id="WERKS" size="256" summ="default" type="STRING"/>
					<colinfo id="ZTERM" size="256" summ="default" type="STRING"/>
					<colinfo id="ENDYN" size="256" summ="default" type="STRING"/>
					<colinfo id="INCO1" size="256" summ="default" type="STRING"/>
					<colinfo id="INCO2" size="256" summ="default" type="STRING"/>
					<colinfo id="LAND1" size="256" summ="default" type="STRING"/>
					<colinfo id="WAERS" size="256" summ="default" type="STRING"/>
					<colinfo id="PERNR" size="256" summ="default" type="STRING"/>
					<colinfo id="STATUS" size="256" summ="default" type="STRING"/>
					<colinfo id="TRANSPORT" size="256" summ="default" type="STRING"/>
					<colinfo id="REQUESTCO" size="256" summ="default" type="STRING"/>
					<colinfo id="PARTIALSHIP" size="256" summ="default" type="STRING"/>
					<colinfo id="TRANSSHIP" size="256" summ="default" type="STRING"/>
					<colinfo id="NETWR_SHIP" size="256" summ="default" type="STRING"/>
					<colinfo id="ZTERM2" size="256" summ="default" type="STRING"/>
					<colinfo id="TERMSOFPAYMENT" size="256" summ="default" type="STRING"/>
					<colinfo id="TO_1" size="256" summ="default" type="STRING"/>
					<colinfo id="TO_2" size="256" summ="default" type="STRING"/>
					<colinfo id="TO_3" size="256" summ="default" type="STRING"/>
					<colinfo id="TO_4" size="256" summ="default" type="STRING"/>
					<colinfo id="TO_5" size="256" summ="default" type="STRING"/>
					<colinfo id="SHIPTO" size="256" summ="default" type="STRING"/>
					<colinfo id="QTGB" size="256" summ="default" type="STRING"/>
					<colinfo id="HIS_UCOST_FN" size="256" summ="default" type="STRING"/>
					<colinfo id="HIS_LOG_FN" size="256" summ="default" type="STRING"/>
					<colinfo id="HIS_DIRSUM_FN" size="256" summ="default" type="STRING"/>
					<colinfo id="HIS_INDSUM_FN" size="256" summ="default" type="STRING"/>
					<colinfo id="HIS_TOTCOST_FN" size="256" summ="default" type="STRING"/>
					<colinfo id="HIS_RATE_FN" size="256" summ="default" type="STRING"/>
					<colinfo id="EMYN" size="256" summ="default" type="STRING"/>
					<colinfo id="QTRCDAT" size="256" summ="default" type="STRING"/>
					<record>
						<BILAMT1></BILAMT1>
						<BILAMT2></BILAMT2>
						<BILAMT3></BILAMT3>
						<BILDAT></BILDAT>
						<BILDAT2></BILDAT2>
						<BILDAT3></BILDAT3>
						<BSU></BSU>
						<BSUNM></BSUNM>
						<BUSSI></BUSSI>
						<CHGBN></CHGBN>
						<CRNAM></CRNAM>
						<CRNAME></CRNAME>
						<CS001_GBN></CS001_GBN>
						<CST></CST>
						<CSTNM></CSTNM>
						<DOC1></DOC1>
						<DOC1DEC></DOC1DEC>
						<DOC1DRA></DOC1DRA>
						<DOC1STAT></DOC1STAT>
						<DOC1STATNM></DOC1STATNM>
						<DOC2></DOC2>
						<DOC2DEC></DOC2DEC>
						<DOC2STAT></DOC2STAT>
						<DOC2STATNM></DOC2STATNM>
						<DOC3></DOC3>
						<DOC3DEC></DOC3DEC>
						<DOC3STAT></DOC3STAT>
						<DOC3STATNM></DOC3STATNM>
						<DOC4></DOC4>
						<DOC4DEC></DOC4DEC>
						<DOC4STAT></DOC4STAT>
						<DOC4STATNM></DOC4STATNM>
						<DOC5></DOC5>
						<DOC5DEC></DOC5DEC>
						<DOC5STAT></DOC5STAT>
						<DOC5STATNM></DOC5STATNM>
						<EMYN></EMYN>
						<ENDYN></ENDYN>
						<FAILYN></FAILYN>
						<FLAG></FLAG>
						<HIS_DIRSUM_FN></HIS_DIRSUM_FN>
						<HIS_INDSUM_FN></HIS_INDSUM_FN>
						<HIS_LOG_FN></HIS_LOG_FN>
						<HIS_RATE_FN></HIS_RATE_FN>
						<HIS_TOTCOST_FN></HIS_TOTCOST_FN>
						<HIS_UCOST_FN></HIS_UCOST_FN>
						<ID_RATE></ID_RATE>
						<INCO1></INCO1>
						<INCO2></INCO2>
						<KUNNR></KUNNR>
						<KVGR1></KVGR1>
						<KVGR2></KVGR2>
						<LAND1></LAND1>
						<LIFNR></LIFNR>
						<MA_PSPID></MA_PSPID>
						<NETWR_DC></NETWR_DC>
						<NETWR_OFR></NETWR_OFR>
						<NETWR_SHIP></NETWR_SHIP>
						<NETWR_STD></NETWR_STD>
						<PARTIALSHIP></PARTIALSHIP>
						<PERNR></PERNR>
						<PGBN></PGBN>
						<PNAME></PNAME>
						<QSTAT></QSTAT>
						<QTAPDAT></QTAPDAT>
						<QTGB></QTGB>
						<QTNAM></QTNAM>
						<QTNUM></QTNUM>
						<QTRCDAT></QTRCDAT>
						<RATE></RATE>
						<REMARK></REMARK>
						<REQKIND></REQKIND>
						<REQKINDNM></REQKINDNM>
						<REQUESTCO></REQUESTCO>
						<SEQ></SEQ>
						<SHDAT></SHDAT>
						<SHIPTO></SHIPTO>
						<SOAPDAT></SOAPDAT>
						<SOCADAT></SOCADAT>
						<SOCHDAT></SOCHDAT>
						<SODAT></SODAT>
						<SPART></SPART>
						<SPARTNM></SPARTNM>
						<SPT></SPT>
						<STATUS></STATUS>
						<SUM_OFR></SUM_OFR>
						<SUM_STD></SUM_STD>
						<TAXK1></TAXK1>
						<TERMSOFPAYMENT></TERMSOFPAYMENT>
						<TO_1></TO_1>
						<TO_2></TO_2>
						<TO_3></TO_3>
						<TO_4></TO_4>
						<TO_5></TO_5>
						<TRANSPORT></TRANSPORT>
						<TRANSSHIP></TRANSSHIP>
						<UPN></UPN>
						<VKBUR></VKBUR>
						<VKBURNM></VKBURNM>
						<VKGRP></VKGRP>
						<VKGRPNM></VKGRPNM>
						<WAERS></WAERS>
						<WERKS></WERKS>
						<ZTERM></ZTERM>
						<ZTERM2></ZTERM2>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_days">
				<Contents>
					<colinfo id="DAYS" size="256" type="STRING"/>
					<record>
						<DAYS></DAYS>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_key">
				<Contents>
					<colinfo id="QTNUM" size="31" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="MAX_SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="TYPE" size="256" summ="default" type="STRING"/>
					<colinfo id="BOMDATE" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond_del">
				<Contents>
					<colinfo id="QTNUM" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQNO" size="256" summ="default" type="STRING"/>
					<record>
						<QTNUM></QTNUM>
						<SEQ></SEQ>
						<SEQNO></SEQNO>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_seq">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE>0</CODE>
						<CODE_NAME>0</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_hna">
				<Contents>
					<colinfo id="CST" size="256" summ="default" type="STRING"/>
					<colinfo id="HNA" size="256" summ="default" type="STRING"/>
					<colinfo id="HNO" size="256" summ="default" type="STRING"/>
					<colinfo id="HTY" size="256" summ="default" type="STRING"/>
					<colinfo id="PJT" size="256" summ="default" type="STRING"/>
					<colinfo id="UPN" size="256" summ="default" type="STRING"/>
					<colinfo id="WBS" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_dec">
				<Contents>
					<colinfo id="APPGUBN" size="256" summ="default" type="STRING"/>
					<colinfo id="APSTAT" size="256" summ="default" type="STRING"/>
					<colinfo id="DOCKIND" size="256" summ="default" type="STRING"/>
					<colinfo id="DOCNO" size="256" summ="default" type="STRING"/>
					<colinfo id="REIRUM" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQNO" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQSTAT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_rgbn_cd">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE>1</CODE>
						<CODE_NAME>보수자재</CODE_NAME>
					</record>
					<record>
						<CODE>2</CODE>
						<CODE_NAME>내작자재</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list_req">
				<Contents>
					<colinfo id="AMOUNT" size="256" summ="default" type="STRING"/>
					<colinfo id="AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="BANNAB" size="256" summ="default" type="STRING"/>
					<colinfo id="BISMT" size="256" summ="default" type="STRING"/>
					<colinfo id="BLOCK_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="BRGEW" size="256" summ="default" type="STRING"/>
					<colinfo id="BWTAR" size="256" summ="default" type="STRING"/>
					<colinfo id="CGBN" size="256" summ="default" type="STRING"/>
					<colinfo id="CGBNNM" size="256" summ="default" type="STRING"/>
					<colinfo id="CGUBN" size="256" summ="default" type="STRING"/>
					<colinfo id="CHAR1" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="DZEINR" size="256" summ="default" type="STRING"/>
					<colinfo id="EXEDT" size="256" summ="default" type="STRING"/>
					<colinfo id="EXEID" size="256" summ="default" type="STRING"/>
					<colinfo id="EXTWG" size="256" summ="default" type="STRING"/>
					<colinfo id="EXXETM" size="256" summ="default" type="STRING"/>
					<colinfo id="FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="GEWEI" size="256" summ="default" type="STRING"/>
					<colinfo id="HNA" size="256" summ="default" type="STRING"/>
					<colinfo id="HNO" size="256" summ="default" type="STRING"/>
					<colinfo id="HTY" size="256" summ="default" type="STRING"/>
					<colinfo id="JOBHOUR" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="LCOSTC" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="LCOSTS" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="LGFSB" size="256" summ="default" type="STRING"/>
					<colinfo id="LVORM" size="256" summ="default" type="STRING"/>
					<colinfo id="MAKTX" size="256" summ="default" type="STRING"/>
					<colinfo id="MAN" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="MATKL" size="256" summ="default" type="STRING"/>
					<colinfo id="MATNR" size="256" summ="default" type="STRING"/>
					<colinfo id="MATNRNM" size="256" summ="default" type="STRING"/>
					<colinfo id="MATNRNM2" size="256" summ="default" type="STRING"/>
					<colinfo id="MEINS" size="256" summ="default" type="STRING"/>
					<colinfo id="MENGE" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="MTART" size="256" summ="default" type="STRING"/>
					<colinfo id="NETPR" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="NETPR_ORG" size="256" summ="default" type="STRING"/>
					<colinfo id="NETWR" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="NTGEW" size="256" summ="default" type="STRING"/>
					<colinfo id="OFRHOUR" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="PARLAB" size="256" summ="default" type="STRING"/>
					<colinfo id="PARLAB1" size="256" summ="default" type="STRING"/>
					<colinfo id="QTNUM" size="256" summ="default" type="STRING"/>
					<colinfo id="REQKIND" size="256" summ="default" type="STRING"/>
					<colinfo id="REQKIND_CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="REQKINDNM" size="256" summ="default" type="STRING"/>
					<colinfo id="RGBN" size="256" summ="default" type="STRING"/>
					<colinfo id="RGBNNM" size="256" summ="default" type="STRING"/>
					<colinfo id="SAMT2" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="SPEC" size="256" summ="default" type="STRING"/>
					<colinfo id="UCOST" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="UCOSTA" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="UCOSTR" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="UPR" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="VOLEH" size="256" summ="default" type="STRING"/>
					<colinfo id="VOLUM" size="256" summ="default" type="STRING"/>
					<colinfo id="WAERS" size="256" summ="default" type="STRING"/>
					<colinfo id="WERKS" size="256" summ="default" type="STRING"/>
					<colinfo id="WRKST" size="256" summ="default" type="STRING"/>
					<colinfo id="ZGUBN" size="256" summ="default" type="STRING"/>
					<colinfo id="ZGUBN_CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSIZE" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_detail_prt">
				<Contents>
					<colinfo id="AMOUNT" size="256" summ="default" type="STRING"/>
					<colinfo id="AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="BANNAB" size="256" summ="default" type="STRING"/>
					<colinfo id="BISMT" size="256" summ="default" type="STRING"/>
					<colinfo id="BLOCK_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="BRGEW" size="256" summ="default" type="STRING"/>
					<colinfo id="BWTAR" size="256" summ="default" type="STRING"/>
					<colinfo id="CGBN" size="256" summ="default" type="STRING"/>
					<colinfo id="CGBNNM" size="256" summ="default" type="STRING"/>
					<colinfo id="CGUBN" size="256" summ="default" type="STRING"/>
					<colinfo id="CHAR1" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="DZEINR" size="256" summ="default" type="STRING"/>
					<colinfo id="EXEDT" size="256" summ="default" type="STRING"/>
					<colinfo id="EXEID" size="256" summ="default" type="STRING"/>
					<colinfo id="EXTWG" size="256" summ="default" type="STRING"/>
					<colinfo id="EXXETM" size="256" summ="default" type="STRING"/>
					<colinfo id="FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="GEWEI" size="256" summ="default" type="STRING"/>
					<colinfo id="HNA" size="256" summ="default" type="STRING"/>
					<colinfo id="HNO" size="256" summ="default" type="STRING"/>
					<colinfo id="HTY" size="256" summ="default" type="STRING"/>
					<colinfo id="JOBHOUR" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="LGFSB" size="256" summ="default" type="STRING"/>
					<colinfo id="LVORM" size="256" summ="default" type="STRING"/>
					<colinfo id="MAKTX" size="256" summ="default" type="STRING"/>
					<colinfo id="MAN" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="MATKL" size="256" summ="default" type="STRING"/>
					<colinfo id="MATNR" size="256" summ="default" type="STRING"/>
					<colinfo id="MATNRNM" size="256" summ="default" type="STRING"/>
					<colinfo id="MATNRNM2" size="256" summ="default" type="STRING"/>
					<colinfo id="MEINS" size="256" summ="default" type="STRING"/>
					<colinfo id="MENGE" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="MTART" size="256" summ="default" type="STRING"/>
					<colinfo id="NETPR" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="NETPR_ORG" size="256" summ="default" type="STRING"/>
					<colinfo id="NETWR" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="NTGEW" size="256" summ="default" type="STRING"/>
					<colinfo id="OFRHOUR" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="PARLAB" size="256" summ="default" type="STRING"/>
					<colinfo id="PARLAB1" size="256" summ="default" type="STRING"/>
					<colinfo id="QTNUM" size="256" summ="default" type="STRING"/>
					<colinfo id="REQKIND" size="256" summ="default" type="STRING"/>
					<colinfo id="REQKIND_CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="REQKINDNM" size="256" summ="default" type="STRING"/>
					<colinfo id="RGBN" size="256" summ="default" type="STRING"/>
					<colinfo id="RGBNNM" size="256" summ="default" type="STRING"/>
					<colinfo id="SAMT2" size="256" summ="default" type="STRING"/>
					<colinfo id="SPEC" size="256" summ="default" type="STRING"/>
					<colinfo id="UCOST" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="UCOSTA" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="UCOSTR" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="UPR" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="VOLEH" size="256" summ="default" type="STRING"/>
					<colinfo id="VOLUM" size="256" summ="default" type="STRING"/>
					<colinfo id="WAERS" size="256" summ="default" type="STRING"/>
					<colinfo id="WERKS" size="256" summ="default" type="STRING"/>
					<colinfo id="WRKST" size="256" summ="default" type="STRING"/>
					<colinfo id="ZGUBN" size="256" summ="default" type="STRING"/>
					<colinfo id="ZGUBN_CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSIZE" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_plan">
				<Contents>
					<colinfo id="MANDT" size="256" summ="default" type="STRING"/>
					<colinfo id="ARA" size="256" summ="default" type="STRING"/>
					<colinfo id="BLD" size="256" summ="default" type="STRING"/>
					<colinfo id="GBNA" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="MAGM" size="256" summ="default" type="STRING"/>
					<colinfo id="MDT" size="256" summ="default" type="STRING"/>
					<colinfo id="MID" size="256" summ="default" type="STRING"/>
					<colinfo id="NAM" size="256" summ="default" type="STRING"/>
					<colinfo id="QTNUM" size="256" summ="default" type="STRING"/>
					<colinfo id="QTY" size="256" summ="default" type="STRING"/>
					<colinfo id="SDT" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="SHDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="TEXT" size="256" summ="default" type="STRING"/>
					<colinfo id="UPN" size="256" summ="default" type="STRING"/>
					<colinfo id="VKGRP" size="256" summ="default" type="STRING"/>
					<colinfo id="YDA" size="256" summ="default" type="STRING"/>
					<colinfo id="YDR" size="256" summ="default" type="STRING"/>
					<colinfo id="YDT" size="256" summ="default" type="STRING"/>
					<colinfo id="YYMM" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_plan_cnt">
				<Contents>
					<colinfo id="CNT" size="256" summ="default" type="STRING"/>
					<record>
						<CNT></CNT>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list_parts">
				<Contents>
					<colinfo id="AMOUNT" size="256" summ="default" type="STRING"/>
					<colinfo id="AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="BANNAB" size="256" summ="default" type="STRING"/>
					<colinfo id="BISMT" size="256" summ="default" type="STRING"/>
					<colinfo id="BLOCK_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="BRGEW" size="256" summ="default" type="STRING"/>
					<colinfo id="BWTAR" size="256" summ="default" type="STRING"/>
					<colinfo id="CGBN" size="256" summ="default" type="STRING"/>
					<colinfo id="CGBNNM" size="256" summ="default" type="STRING"/>
					<colinfo id="CGUBN" size="256" summ="default" type="STRING"/>
					<colinfo id="CHAR1" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="DZEINR" size="256" summ="default" type="STRING"/>
					<colinfo id="EXEDT" size="256" summ="default" type="STRING"/>
					<colinfo id="EXEID" size="256" summ="default" type="STRING"/>
					<colinfo id="EXTWG" size="256" summ="default" type="STRING"/>
					<colinfo id="EXXETM" size="256" summ="default" type="STRING"/>
					<colinfo id="FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="GEWEI" size="256" summ="default" type="STRING"/>
					<colinfo id="HNA" size="256" summ="default" type="STRING"/>
					<colinfo id="HNO" size="256" summ="default" type="STRING"/>
					<colinfo id="HTY" size="256" summ="default" type="STRING"/>
					<colinfo id="JOBHOUR" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="LGFSB" size="256" summ="default" type="STRING"/>
					<colinfo id="LVORM" size="256" summ="default" type="STRING"/>
					<colinfo id="MAKTX" size="256" summ="default" type="STRING"/>
					<colinfo id="MAN" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="MATKL" size="256" summ="default" type="STRING"/>
					<colinfo id="MATNR" size="256" summ="default" type="STRING"/>
					<colinfo id="MATNRNM" size="256" summ="default" type="STRING"/>
					<colinfo id="MATNRNM2" size="256" summ="default" type="STRING"/>
					<colinfo id="MEINS" size="256" summ="default" type="STRING"/>
					<colinfo id="MENGE" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="MTART" size="256" summ="default" type="STRING"/>
					<colinfo id="NETPR" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="NETPR_ORG" size="256" summ="default" type="STRING"/>
					<colinfo id="NETWR" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="NTGEW" size="256" summ="default" type="STRING"/>
					<colinfo id="OFRHOUR" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="PARLAB" size="256" summ="default" type="STRING"/>
					<colinfo id="PARLAB1" size="256" summ="default" type="STRING"/>
					<colinfo id="QTNUM" size="256" summ="default" type="STRING"/>
					<colinfo id="REQKIND" size="256" summ="default" type="STRING"/>
					<colinfo id="REQKIND_CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="REQKINDNM" size="256" summ="default" type="STRING"/>
					<colinfo id="RGBN" size="256" summ="default" type="STRING"/>
					<colinfo id="RGBNNM" size="256" summ="default" type="STRING"/>
					<colinfo id="SAMT2" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="SPEC" size="256" summ="default" type="STRING"/>
					<colinfo id="UCOST" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="UCOSTA" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="UCOSTR" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="UPR" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="VOLEH" size="256" summ="default" type="STRING"/>
					<colinfo id="VOLUM" size="256" summ="default" type="STRING"/>
					<colinfo id="WAERS" size="256" summ="default" type="STRING"/>
					<colinfo id="WERKS" size="256" summ="default" type="STRING"/>
					<colinfo id="WRKST" size="256" summ="default" type="STRING"/>
					<colinfo id="ZGUBN" size="256" summ="default" type="STRING"/>
					<colinfo id="ZGUBN_CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSIZE" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_reject_wb">
				<Contents>
					<colinfo id="APNUM1" size="256" summ="default" type="STRING"/>
					<colinfo id="APNUM2" size="256" summ="default" type="STRING"/>
					<colinfo id="APDESC" size="256" summ="default" type="STRING"/>
					<record>
						<APDESC></APDESC>
						<APNUM1></APNUM1>
						<APNUM2></APNUM2>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_reject_cond">
				<Contents>
					<colinfo id="DOCNO" size="256" summ="default" type="STRING"/>
					<record>
						<DOCNO></DOCNO>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_reject_list">
				<Contents>
					<colinfo id="MESGSEND" size="256" summ="default" type="STRING"/>
					<colinfo id="MESGACCP" size="256" summ="default" type="STRING"/>
					<colinfo id="MESGTITL" size="256" summ="default" type="STRING"/>
					<colinfo id="MESGDESC" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_spartnm">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE>10</CODE>
						<CODE_NAME>승강기</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_qtm">
				<Contents>
					<colinfo id="QTNUM" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="256" summ="default" type="STRING"/>
					<record>
						<QTNUM></QTNUM>
						<SEQ></SEQ>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_customer_prt">
				<Contents>
					<colinfo id="QTNUM" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="256" summ="default" type="STRING"/>
					<record>
						<QTNUM></QTNUM>
						<SEQ></SEQ>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_inco1">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE>EXW</CODE>
						<CODE_NAME>EXW</CODE_NAME>
					</record>
					<record>
						<CODE>FOB</CODE>
						<CODE_NAME>FOB</CODE_NAME>
					</record>
					<record>
						<CODE>FCA</CODE>
						<CODE_NAME>FCA</CODE_NAME>
					</record>
					<record>
						<CODE>FAS</CODE>
						<CODE_NAME>FAS</CODE_NAME>
					</record>
					<record>
						<CODE>CFR</CODE>
						<CODE_NAME>CFR</CODE_NAME>
					</record>
					<record>
						<CODE>CIF</CODE>
						<CODE_NAME>CIF</CODE_NAME>
					</record>
					<record>
						<CODE>CPT</CODE>
						<CODE_NAME>CPT</CODE_NAME>
					</record>
					<record>
						<CODE>CIP</CODE>
						<CODE_NAME>CIP</CODE_NAME>
					</record>
					<record>
						<CODE>DDU</CODE>
						<CODE_NAME>DDU</CODE_NAME>
					</record>
					<record>
						<CODE>DDP</CODE>
						<CODE_NAME>DDP</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_land1">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_qstat">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_status">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_transport_cd">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE>VESSEL</CODE>
						<CODE_NAME>VESSEL</CODE_NAME>
					</record>
					<record>
						<CODE>AIR</CODE>
						<CODE_NAME>AIR</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_yn_cd">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE>Y</CODE>
						<CODE_NAME>Yes</CODE_NAME>
					</record>
					<record>
						<CODE>N</CODE>
						<CODE_NAME>No</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_yn2_cd">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE>Y</CODE>
						<CODE_NAME>ALLOWED</CODE_NAME>
					</record>
					<record>
						<CODE>N</CODE>
						<CODE_NAME>NOT&#32;ALLOWED</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_zterm2">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE>in&#32;advance</CODE>
						<CODE_NAME>in&#32;advance</CODE_NAME>
					</record>
					<record>
						<CODE>30days</CODE>
						<CODE_NAME>30days</CODE_NAME>
					</record>
					<record>
						<CODE>60days</CODE>
						<CODE_NAME>60days</CODE_NAME>
					</record>
					<record>
						<CODE>90days</CODE>
						<CODE_NAME>90days</CODE_NAME>
					</record>
					<record>
						<CODE>120days</CODE>
						<CODE_NAME>120days</CODE_NAME>
					</record>
					<record>
						<CODE>180days</CODE>
						<CODE_NAME>180days</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond_prt">
				<Contents>
					<colinfo id="QTNUM" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="KUNNR" size="256" summ="default" type="STRING"/>
					<colinfo id="UPN" size="256" summ="default" type="STRING"/>
					<colinfo id="CST" size="256" summ="default" type="STRING"/>
					<colinfo id="STATUS" size="256" summ="default" type="STRING"/>
					<record>
						<CST></CST>
						<KUNNR></KUNNR>
						<QTNUM></QTNUM>
						<SEQ></SEQ>
						<STATUS></STATUS>
						<UPN></UPN>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_header_prt">
				<Contents></Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_031_cnt">
				<Contents>
					<colinfo id="CNT" size="256" summ="default" type="STRING"/>
					<record>
						<CNT></CNT>
					</record>
				</Contents>
			</Dataset>
		</Datasets>
		<Shape BKColor="user12" Bottom="229" Height="26" Id="Shape9" Left="7" LineColor="user13" Right="969" TabOrder="98" Top="203" Type="Rectangle" Width="962"></Shape>
		<Shape BKColor="user12" Bottom="574" Height="32" Id="Shape10" Left="7" LineColor="user13" Right="969" TabOrder="78" Top="542" Type="Rectangle" Width="962"></Shape>
		<Shape BKColor="user12" Bottom="171" Height="26" Id="Shape2" Left="7" LineColor="user13" Right="969" TabOrder="11" Top="145" Type="Rectangle" Width="962"></Shape>
		<Shape BKColor="user12" Bottom="196" Height="26" Id="Shape22" Left="7" LineColor="user13" Right="969" TabOrder="54" Top="170" Type="Rectangle" Width="962"></Shape>
		<Shape BKColor="user12" Bottom="146" Height="26" Id="Shape1" Left="7" LineColor="user13" Right="969" TabOrder="10" Top="120" Type="Rectangle" Width="962"></Shape>
		<Shape BKColor="user12" Bottom="533" Height="54" Id="Shape6" Left="7" LineColor="user13" Right="104" TabOrder="43" Top="479" Type="Rectangle" Width="97"></Shape>
		<Static Align="Center" DomainID="csh.remark" Height="52" Id="Static53" Left="8" Style="sty_lb_form_basic" TabOrder="44" Text="특기사항&#32;&#10;&#32;(500자)&#32;" Top="480" VAlign="Middle" Width="95"></Static>
		<Shape BKColor="user12" Bottom="121" Height="27" Id="Shape4" Left="7" LineColor="user13" Right="704" TabOrder="49" Top="94" Type="Rectangle" Width="697"></Shape>
		<Div Height="36" Id="div_btn" TabOrder="1" Text="Div0" ToolTipFont="Default,0" Url="WB01::CommBtnForm.xml" Width="976">
			<Contents></Contents>
		</Div>
		<Button ButtonStyle="TRUE" Cursor="HAND" DomainID="csh.print_quotation" Height="20" Id="btn_print_ofr" ImageID="btn_sub_07" Left="713" LeftMargin="12" OnClick="btn_print_ofr_OnClick" Style="sty_btn" TabOrder="2" Text="견적서출력" Top="94" Transparent="TRUE" Width="111"></Button>
		<Shape BKColor="user12" Bottom="254" Height="26" Id="Shape0" Left="7" LineColor="user13" Right="969" TabOrder="3" Top="228" Type="Rectangle" Width="962"></Shape>
		<Static Align="Center" Height="24" Id="Static5" Left="8" Style="sty_lb_form_basic" TabOrder="4" Text="Proj.&#32;No" Top="229" VAlign="Middle" Width="90"></Static>
		<Edit Align="CENTER" BindDataset="ds_out_master" Border="Flat" Column="MA_PSPID" Enable="FALSE" Height="20" Id="ed_pjt" Left="99" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="5" Top="231" Width="78"></Edit>
		<Static Align="Center" DomainID="csh.quotation_no" Height="24" Id="Static1" Left="372" Style="sty_lb_form_basic" TabOrder="6" Text="견적번호" Top="95" VAlign="Middle" Width="80"></Static>
		<Edit Align="CENTER" BindDataset="ds_out_master" Border="Flat" Column="QTNUM" Enable="FALSE" Height="20" Id="ed_qtnum" Left="454" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="7" Top="97" Width="100"></Edit>
		<Static Align="Center" DomainID="csh.edition" Height="24" Id="Static2" Left="556" Style="sty_lb_form_basic" TabOrder="8" Text="차수" Top="95" VAlign="Middle" Width="80"></Static>
		<Edit Align="CENTER" BindDataset="ds_out_master" Border="Flat" Column="SEQ" Enable="FALSE" Height="20" Id="ed_seq" Left="984" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="9" Width="36"></Edit>
		<Edit BindDataset="ds_out_master" Border="Flat" Column="SPT" Enable="FALSE" Height="20" Id="ed_spt" Left="201" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="12" Top="231" Width="176"></Edit>
		<Static Align="Center" DomainID="csh.company_code" Height="24" Id="Static0" Left="381" Style="sty_lb_form_basic" TabOrder="13" Text="고객번호" Top="229" VAlign="Middle" Width="90"></Static>
		<Edit Align="CENTER" BindDataset="ds_out_master" Border="Flat" Column="KUNNR" Enable="FALSE" Height="19" Id="ed_cus" Left="473" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="14" Top="232" Width="80"></Edit>
		<Edit BindDataset="ds_out_master" Border="Flat" Column="CSTNM" Enable="FALSE" Height="20" Id="ed_cstnm" Left="556" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="15" Text="(지급인명)" Top="231" Width="276"></Edit>
		<Static Align="Center" Height="24" Id="Static6" Left="14" Style="sty_lb_form_basic" TabOrder="16" Text="제품군" Top="624" VAlign="Middle" Width="80"></Static>
		<Static Align="Center" Height="24" Id="Static7" Left="208" Style="sty_lb_form_basic" TabOrder="17" Text="팀명" Top="624" VAlign="Middle" Width="80"></Static>
		<Edit Align="CENTER" BindDataset="ds_out_master" Border="Flat" Column="VKGRPNM" Enable="FALSE" Height="20" Id="ed_vkgrpnm" Left="290" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="18" Top="626" Width="180"></Edit>
		<Static Align="Center" DomainID="csh.company_name" Height="24" Id="Static8" Left="8" Style="sty_lb_form_basic" TabOrder="19" Text="법인명" Top="204" VAlign="Middle" Width="90"></Static>
		<Edit Align="CENTER" BindDataset="ds_out_master" Border="Flat" Column="BSUNM" Enable="FALSE" Height="20" Id="ed_bsunm" Left="99" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="20" Top="206" Width="198"></Edit>
		<Static Align="Center" Height="24" Id="adm_st_mid" Left="381" Style="sty_lb_form_basic" TabOrder="21" Text="작성자" Top="204" VAlign="Middle" Width="90"></Static>
		<Edit Align="CENTER" BindDataset="ds_out_master" Border="Flat" Column="CRNAME" Enable="FALSE" Height="20" Id="adm_ed_pname" Left="473" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="22" Top="206" Width="80"></Edit>
		<Static Align="Center" Height="24" Id="Static10" Left="14" Style="sty_lb_form_basic" TabOrder="23" Text="청구구분" Top="649" VAlign="Middle" Width="80"></Static>
		<Static Align="Center" Height="24" Id="Static11" Left="208" Style="sty_lb_form_basic" TabOrder="24" Text="견적구분" Top="649" VAlign="Middle" Width="80"></Static>
		<Calendar BindDataset="ds_out_master" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="QTRCDAT" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_qtrcdat" Left="683" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="26" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="148" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="90"></Calendar>
		<Static Align="Center" Height="24" Id="adm_st_shdat" Left="776" Style="sty_lb_form_basic" TabOrder="27" Text="납기일" Top="146" VAlign="Middle" Width="80"></Static>
		<Calendar BindDataset="ds_out_master" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="SHDAT" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="adm_cal_shdat" Left="857" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="28" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="148" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="105"></Calendar>
		<Static Align="Center" Height="30" Id="adm_st_netwr_std" Left="8" Style="sty_lb_form_basic" TabOrder="29" Text="표준금액" Top="543" VAlign="Middle" Width="95"></Static>
		<Static Align="Center" Height="30" Id="adm_st_netwr_ofr" Left="383" Style="sty_lb_form_basic" TabOrder="30" Text="견적금액" Top="543" VAlign="Middle" Width="95"></Static>
		<Static Height="17" Id="adm_st_dc" Left="207" TabOrder="31" Text="판매할인액" Top="551" Width="58"></Static>
		<Grid AreaSelect="TRUE" AutoEnter="TRUE" AutoFitEndLine="Hide" BindDataset="ds_list" BkColor2="default" BoldHead="true" Border="Flat" Bottom="475" CellMoving="TRUE" ColSelect="TRUE" ColSizing="TRUE" DragMode="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="189" Id="grd_list" InputPanel="FALSE" Left="8" LineColor="user20" LineType="ExHORZ" OnCellClick="grd_list_OnCellClick" OnExpandUp="grd_list_OnExpandUp" OnHeadClick="grd_list_OnHeadClick" Right="968" RowHeight="20" Style="sty_grid" TabOrder="32" TabStop="true" Top="286" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="960">
			<contents>
				<format id="Default">
					<columns>
						<col width="18"/>
						<col width="90"/>
						<col width="0"/>
						<col width="0"/>
						<col width="90"/>
						<col width="284"/>
						<col width="110"/>
						<col width="50"/>
						<col width="30"/>
						<col width="80"/>
						<col width="80"/>
						<col width="0"/>
						<col width="0"/>
						<col width="0"/>
						<col width="0"/>
						<col width="0"/>
						<col width="150"/>
						<col width="0"/>
						<col width="0"/>
						<col width="80"/>
						<col width="80"/>
						<col width="0"/>
						<col width="52"/>
						<col width="80"/>
						<col width="50"/>
						<col width="30"/>
						<col width="50"/>
					</columns>
					<head>
						<cell col="0" display="checkbox" edit="checkbox" font="굴림,9" text="선택"/>
						<cell col="1" display="text" domainid="csh.wbs" font="굴림,9" text="호기(WBS)"/>
						<cell col="2" display="text" font="굴림,9" text="호기명"/>
						<cell col="3" display="text" font="굴림,9" text="청구유형"/>
						<cell col="4" display="text" domainid="csh.part_no" font="굴림,9" text="자재번호"/>
						<cell col="5" display="text" domainid="csh.part_name" font="굴림,9" text="자재내역"/>
						<cell col="6" display="text" domainid="csh.product_type" font="굴림,9" text="평가유형"/>
						<cell col="7" display="text" domainid="csh.quantity" font="굴림,9" text="수량"/>
						<cell col="8" display="text" domainid="csh.unit" font="굴림,9" text="단위"/>
						<cell col="9" display="text" domainid="csh.unit_price" font="굴림,9" text="판매단가"/>
						<cell col="10" display="text" domainid="csh.total_price" font="굴림,9" text="판매금액"/>
						<cell col="11" display="text" font="굴림,9" text="투입인원"/>
						<cell col="12" display="text" font="굴림,9" text="표준공수"/>
						<cell col="13" display="text" font="굴림,9" text="견적공수"/>
						<cell col="14" display="text" font="굴림,9" text="인건비(표준)"/>
						<cell col="15" display="text" font="굴림,9" text="인건비(견적)"/>
						<cell col="16" display="text" domainid="csh.part_detail" font="굴림,9" text="자재특성치"/>
						<cell col="17" display="text" font="굴림,9" text="직영재고"/>
						<cell col="18" display="text" font="굴림,9" text="변동구분"/>
						<cell bkcolor="khaki" col="19" display="text" font="굴림,9" text="LEADTIME"/>
						<cell bkcolor="khaki" col="20" display="text" font="굴림,9" text="자재원가"/>
						<cell bkcolor="khaki" col="21" display="text" font="굴림,9" text="FLAG"/>
						<cell bkcolor="khaki" col="22" display="text" font="굴림,9" text="청구종류"/>
						<cell bkcolor="khaki" col="23" display="text" font="굴림,9" text="견적가"/>
						<cell bkcolor="khaki" col="24" display="text" font="굴림,9" text="품명그룹"/>
						<cell bkcolor="khaki" col="25" display="text" font="굴림,9" text="군"/>
						<cell bkcolor="khaki" col="26" display="text" font="굴림,9" text="요율"/>
					</head>
					<body>
						<cell align="center" col="0" colid="CHK" display="checkbox" edit="checkbox"/>
						<cell bkcolor="user27" bkimagealign="right" bkimageid="icon_grid_edit" col="1" colid="HNO" combocol="WBS" combodataset="ds_hna" combodisplayrowcnt="20" combotext="WBS" display="combo" edit="combo" expandsize="18"/>
						<cell bkcolor="user27" bkimagealign="right" bkimageid="icon_grid_edit" col="2" colid="HNA" combocol="HNA" combodataset="ds_hna" combodisplayrowcnt="20" combotext="HNA" display="combo" edit="combo"/>
						<cell bkcolor="user27" bkimagealign="right" bkimageid="icon_grid_edit" col="3" colid="RGBN" combocol="CODE" combodataset="ds_rgbn_cd" combotext="CODE_NAME" display="combo" edit="combo"/>
						<cell bkcolor="user27" col="4" colid="MATNR" display="text" edit="normal" expandimage="btn_icon_search" expandshow="true" expandsize="18"/>
						<cell bkcolor="user27" bkimagealign="right" bkimageid="icon_grid_edit" col="5" colid="MAKTX" display="text" edit="normal" limit="120"/>
						<cell align="center" bkcolor="user27" bkimagealign="right" bkimageid="icon_grid_edit" col="6" colid="BWTAR" combocol="CODE" combodataset="ds_bwtar_cd" combotext="CODE_NAME" display="combo" edit="combo"/>
						<cell align="right" bkcolor="user27" bkimagealign="left" bkimageid="icon_grid_edit" col="7" colid="MENGE" display="number" edit="number" LimitDec="2"/>
						<cell align="center" col="8" colid="MEINS" display="text"/>
						<cell align="right" bkimagealign="left" col="9" colid="NETPR" display="number" Mask="###,###.#0"/>
						<cell align="right" col="10" colid="NETWR" display="number" Mask="###,###.#0"/>
						<cell align="right" col="11" colid="MAN" display="text"/>
						<cell align="right" col="12" colid="JOBHOUR" display="text"/>
						<cell align="right" bkcolor="user27" bkimagealign="left" bkimageid="icon_grid_edit" col="13" colid="OFRHOUR" display="number" edit="number"/>
						<cell align="right" col="14" colid="LCOSTS" display="currency"/>
						<cell align="right" col="15" colid="LCOSTC" display="currency"/>
						<cell bkcolor="user27" bkimagealign="right" bkimageid="icon_grid_edit" col="16" colid="CHAR1" display="text" edit="normal" limit="140"/>
						<cell align="center" bkcolor="user27" bkimagealign="right" bkimageid="icon_grid_edit" col="17" colid="ZGUBN_CHK" display="checkbox" text="Y"/>
						<cell align="center" col="18" colid="CGBNNM" display="text"/>
						<cell align="right" bkcolor="user0" col="19" colid="WEBAZ" display="text"/>
						<cell align="right" bkcolor="user0" col="20" colid="UCOST" display="number" Mask="###,###.#0"/>
						<cell align="center" bkcolor="user0" col="21" colid="FLAG" display="text"/>
						<cell bkcolor="user0" col="22" colid="REQKIND" display="text"/>
						<cell align="right" bkcolor="user0" col="23" colid="AMOUNT" display="number" Mask="###,###.#0"/>
						<cell align="center" bkcolor="user0" col="24" colid="MAT_CODE" display="text"/>
						<cell align="center" bkcolor="user0" col="25" colid="MRGUBUN" display="text"/>
						<cell align="right" bkcolor="user0" col="26" colid="MRRAT" display="number" Mask="0.#0"/>
					</body>
					<summary>
						<cell col="0" display="text"/>
						<cell align="center" col="1" display="text"/>
						<cell col="2" display="text"/>
						<cell col="3" display="text"/>
						<cell col="4" display="text"/>
						<cell col="5" display="text"/>
						<cell col="6" display="text"/>
						<cell col="7" display="text"/>
						<cell col="8" display="text"/>
						<cell align="center" col="9" display="text" domainid="csh.sum_total" text="소계"/>
						<cell align="right" bkcolor="user25" col="10" display="number" expr='sum(&quot;NETWR&quot;)' Mask="###,###.#0"/>
						<cell align="right" bkcolor="user25" col="11" display="number" expr='sum(&quot;MAN&quot;)'/>
						<cell align="right" bkcolor="user25" col="12" display="number" expr='sum(&quot;JOBHOUR&quot;)'/>
						<cell align="right" bkcolor="user25" col="13" display="number" expr='sum(&quot;OFRHOUR&quot;)'/>
						<cell align="right" bkcolor="user25" col="14" display="currency" expr='sum(&quot;LCOSTS&quot;)'/>
						<cell align="right" bkcolor="user25" col="15" display="currency" expr='sum(&quot;LCOSTC&quot;)'/>
						<cell col="16" display="text"/>
						<cell col="17" display="text"/>
						<cell col="18" display="text"/>
						<cell col="19" display="text"/>
						<cell align="right" bkcolor="user25" col="20" display="number" expr='sum(&quot;UCOST&quot;)' Mask="###,###.#0"/>
						<cell col="21" display="text"/>
						<cell col="22" display="text"/>
						<cell col="23" display="text"/>
						<cell col="24" display="text"/>
						<cell col="25" display="text"/>
						<cell col="26" display="text"/>
					</summary>
				</format>
			</contents>
		</Grid>
		<Static Align="Center" Height="24" Id="Static43" Left="713" Style="sty_lb_form_basic" TabOrder="33" Text="계산서&#32;구분" Top="624" VAlign="Middle" Width="80"></Static>
		<Static Align="Center" Height="24" Id="Static44" Left="480" Style="sty_lb_form_basic" TabOrder="34" Text="발송구분" Top="624" VAlign="Middle" Width="80"></Static>
		<Static Align="Center" Height="24" Id="Static45" Left="416" Style="sty_lb_form_basic" TabOrder="35" Text="세금구분" Top="648" VAlign="Middle" Width="80"></Static>
		<Static Align="Center" DomainID="csh.terms_of_payment" Height="24" Id="st_zterm" Left="8" Style="sty_lb_form_basic" TabOrder="36" Text="수금조건" Top="146" VAlign="Middle" Width="110"></Static>
		<Static Align="Center" Height="24" Id="Static47" Left="16" Style="sty_lb_form_basic" TabOrder="37" Text="계산서발행일&#32;1)" Top="680" VAlign="Middle" Width="95"></Static>
		<Static Align="Center" Height="24" Id="Static48" Left="16" Style="sty_lb_form_basic" TabOrder="38" Text="계산서발행금액1)" Top="705" VAlign="Middle" Width="95"></Static>
		<Static Align="Center" Height="24" Id="Static49" Left="256" Style="sty_lb_form_basic" TabOrder="39" Text="계산서발행일&#32;2)" Top="680" VAlign="Middle" Width="95"></Static>
		<Static Align="Center" Height="24" Id="Static50" Left="256" Style="sty_lb_form_basic" TabOrder="40" Text="계산서발행금액2)" Top="705" VAlign="Middle" Width="95"></Static>
		<Static Align="Center" Height="24" Id="Static51" Left="496" Style="sty_lb_form_basic" TabOrder="41" Text="계산서발행일&#32;3)" Top="680" VAlign="Middle" Width="95"></Static>
		<Static Align="Center" Height="24" Id="Static52" Left="496" Style="sty_lb_form_basic" TabOrder="42" Text="계산서발행금액3)" Top="705" VAlign="Middle" Width="95"></Static>
		<Combo BindDataset="ds_out_master" Border="Flat" CodeColumn="CODE" Column="CS001_GBN" DataColumn="CODE_NAME" DisableBKColor="user5" Height="20" Id="cb_cs001gbn" InnerDataset="ds_gbn" Left="290" OnChanged="cb_cs001gbn_OnChanged" Style="sty_ipt_form" TabOrder="45" Top="650" Width="110"></Combo>
		<Combo BindDataset="ds_out_master" Border="Flat" CodeColumn="CODE" Column="REQKIND" DataColumn="CODE_NAME" DisableBKColor="user5" Height="20" Id="cb_reqkind" InnerDataset="ds_reqkind_cd" Left="95" OnChanged="cb_reqkind_OnChanged" Style="sty_ipt_form" TabOrder="46" Top="650" Width="110"></Combo>
		<Button Cursor="HAND" Height="18" Id="btn_pjt" ImageID="btn_icon_search" Left="180" OnClick="btn_pjt_OnClick" TabOrder="47" Text="Button0" Top="233" Width="18"></Button>
		<Edit BindDataset="ds_out_master" Border="Flat" Column="QTNAM" Height="20" Id="ed_qtnam" Left="120" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="48" Top="97" Width="250"></Edit>
		<Static Align="Center" DomainID="csh.wbs3" Height="24" Id="Static24" Left="8" Style="sty_lb_form_basic" TabOrder="50" Text="견적&#32;명" Top="96" VAlign="Middle" Width="110"></Static>
		<Button ButtonStyle="TRUE" Cursor="HAND" DomainID="csh.add" Height="20" Id="bt_addMaterial" ImageID="btn_sub_05" Left="8" LeftMargin="12" OnClick="bt_addMaterial_OnClick" Style="sty_btn" TabOrder="51" Text="자재추가" Top="261" Transparent="TRUE" Width="86"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" DomainID="csh.delete" Height="20" Id="bt_removeMaterial" ImageID="btn_sub_05" Left="95" LeftMargin="12" OnClick="bt_removeMaterial_OnClick" Style="sty_btn" TabOrder="52" Text="자재삭제" Top="261" Transparent="TRUE" Width="86"></Button>
		<Combo BindDataset="ds_out_master" Border="Flat" CodeColumn="CODE" Column="KVGR1" DataColumn="CODE_NAME" DisableBKColor="user5" Height="20" Id="cb_kvgr1" InnerDataset="ds_kvgr1" Left="794" Style="sty_ipt_form" TabOrder="53" Top="625" Width="110"></Combo>
		<Combo BindDataset="ds_out_master" Border="Flat" CodeColumn="CODE" Column="KVGR2" DataColumn="CODE_NAME" DisableBKColor="user5" Height="20" Id="cb_kvgr2" InnerDataset="ds_kvgr2" Left="562" Style="sty_ipt_form" TabOrder="55" Top="625" Width="141"></Combo>
		<Combo BindDataset="ds_out_master" Border="Flat" CodeColumn="CODE" Column="TAXK1" DataColumn="CODE_NAME" DisableBKColor="user5" Height="20" Id="cb_taxk1" InnerDataset="ds_taxk1" Left="498" Style="sty_ipt_form" TabOrder="56" Top="649" Width="110"></Combo>
		<Combo BindDataset="ds_out_master" Border="Flat" CodeColumn="CODE" Column="ZTERM" DataColumn="CODE_NAME" DisableBKColor="user5" Height="20" Id="cb_zterm" ImeMode="none" InnerDataset="ds_zterm" Left="119" OnChanged="cb_zterm_OnChanged" Style="sty_ipt_form_ind" TabOrder="57" Top="147" Width="160"></Combo>
		<Calendar BindDataset="ds_out_master" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="BILDAT" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_bildat1" Left="114" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="58" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="682" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="139"></Calendar>
		<Calendar BindDataset="ds_out_master" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="BILDAT2" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Enable="FALSE" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_bildat2" Left="354" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="59" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="682" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="139"></Calendar>
		<Calendar BindDataset="ds_out_master" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="BILDAT3" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Enable="FALSE" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_bildat3" Left="594" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="60" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="682" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="139"></Calendar>
		<MaskEdit BindDataset="ds_out_master" Border="Flat" Column="BILAMT1" Enable="FALSE" Height="20" Id="me_bilamt1" Left="114" Style="sty_ipt_form" TabOrder="61" Top="707" Width="139"></MaskEdit>
		<MaskEdit BindDataset="ds_out_master" Border="Flat" Column="BILAMT2" Enable="FALSE" Height="20" Id="me_bilamt2" Left="355" OnChanged="me_bilamt2_OnChanged" Style="sty_ipt_form" TabOrder="62" Top="707" Width="139"></MaskEdit>
		<MaskEdit BindDataset="ds_out_master" Border="Flat" Column="BILAMT3" Enable="FALSE" Height="20" Id="me_bilamt3" Left="594" OnChanged="me_bilamt3_OnChanged" Style="sty_ipt_form" TabOrder="63" Top="707" Width="139"></MaskEdit>
		<MaskEdit BindDataset="ds_out_master" BKColor="user40" Border="Flat" Column="NETWR_DC" DecimalLen="2" Height="26" Id="ed_netwr_dc" Left="272" OnChanged="ed_netwr_dc_OnChanged" Style="sty_ipt_form" TabOrder="64" Top="544" Width="90"></MaskEdit>
		<MaskEdit BindDataset="ds_out_master" Border="Flat" Column="NETWR_OFR" DecimalLen="2" Enable="FALSE" Height="26" Id="ed_netwr_ofr" Left="487" Style="sty_ipt_form" TabOrder="65" TabStop="FALSE" Top="545" Width="97"></MaskEdit>
		<MaskEdit BindDataset="ds_out_master" Border="Flat" Column="NETWR_STD" DecimalLen="2" Enable="FALSE" Height="26" Id="ed_netwr_std" Left="105" Style="sty_ipt_form" TabOrder="66" TabStop="FALSE" Top="545" Width="97"></MaskEdit>
		<Button ButtonStyle="TRUE" Cursor="HAND" DomainID="csh.quotation_copy" Height="20" Id="btn_copy_ofr" ImageID="btn_sub_07" Left="856" LeftMargin="12" OnClick="btn_copy_offer_OnClick" Style="sty_btn" TabOrder="67" Text="견적복사" Top="48" Transparent="TRUE" Width="112"></Button>
		<TextArea BindDataset="ds_out_master" Border="Flat" Column="REMARK" Height="54" Id="ed_remark" Left="103" MaxLength="500" Style="sty_ipt_form" TabOrder="68" Top="479" Width="865"></TextArea>
		<Combo BindDataset="ds_out_master" Border="Flat" CodeColumn="CODE" Column="SEQ" DataColumn="CODE_NAME" DisableBKColor="user5" Height="20" Id="cb_seq" InnerDataset="ds_seq" Left="638" OnChanged="cb_seq_OnChanged" Style="sty_ipt_form" TabOrder="69" Top="96" Width="57"></Combo>
		<Static Align="Center" DomainID="csh.estimated_order_date" Height="24" Id="Static12" Left="556" Style="sty_lb_form_basic" TabOrder="25" Text="견적접수일" Top="146" VAlign="Middle" Width="125"></Static>
		<Combo BindDataset="ds_out_master" Border="Flat" CodeColumn="CODE" Column="SPARTNM" DataColumn="CODE_NAME" DisableBKColor="user5" Height="20" Id="cb_spartnm" InnerDataset="ds_spartnm" Left="95" OnChanged="cb_spartnm_OnChanged" Style="sty_ipt_form" TabOrder="70" Top="625" Width="110"></Combo>
		<Static Align="Center" DomainID="csh.currency" Height="24" Id="st_waers" Left="556" Style="sty_lb_form_basic" TabOrder="71" Text="통화&#32;" Top="204" VAlign="Middle" Width="80"></Static>
		<Static Align="Center" DomainID="csh.port" Height="24" Id="st_inco1_text" Left="242" Style="sty_lb_form_basic" TabOrder="73" Text="인도조건2&#32;" Top="121" VAlign="Middle" Width="130"></Static>
		<Static Align="Center" DomainID="csh.terms_of_trade" Height="24" Id="st_inco1" Left="8" Style="sty_lb_form_basic" TabOrder="72" Text="인도조건1&#32;" Top="121" VAlign="Middle" Width="110"></Static>
		<Edit Align="CENTER" BindDataset="ds_out_master" Border="Flat" Column="WAERS" Enable="FALSE" Height="20" Id="ed_waers" Left="638" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="74" Top="206" Width="120"></Edit>
		<Edit BindDataset="ds_out_master" Border="Flat" Column="INCO2" Height="20" Id="ed_inco2" ImeMode="none" Left="374" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="75" Top="123" Width="122"></Edit>
		<Combo BindDataset="ds_out_master" Border="Flat" CodeColumn="CODE" Column="INCO1" DataColumn="CODE_NAME" DisableBKColor="user5" Height="20" Id="cb_inco1" InnerDataset="ds_inco1" Left="119" OnChanged="cb_inco1_OnChanged" Style="sty_ipt_form" TabOrder="76" Top="123" Width="120"></Combo>
		<Static Align="Center" DomainID="csh.country" Height="24" Id="Static33" Left="760" Style="sty_lb_form_basic" TabOrder="77" Text="국가&#32;정보&#32;" Top="204" VAlign="Middle" Width="80"></Static>
		<Combo BindDataset="ds_out_master" Border="Flat" CodeColumn="CODE" Column="LAND1" DataColumn="CODE_NAME" DisableBKColor="user5" Enable="FALSE" Height="20" Id="cb_land1" InnerDataset="ds_land1" Left="841" Style="sty_ipt_form" TabOrder="79" Top="205" Width="110"></Combo>
		<Shape BKColor="user12" Bottom="72" Height="26" Id="Shape5" Left="7" LineColor="user13" Right="704" TabOrder="80" Top="46" Type="Rectangle" Width="697"></Shape>
		<Static Align="Center" Height="24" Id="Static14" Left="8" Style="sty_lb_form_basic" TabOrder="81" Text="Status" Top="47" VAlign="Middle" Width="80"></Static>
		<Static Align="Center" Height="24" Id="adm_st_status" Left="372" Style="sty_lb_form_basic" TabOrder="82" Text="자재청구진행" Top="47" VAlign="Middle" Width="80"></Static>
		<Combo BindDataset="ds_out_master" Border="Flat" CodeColumn="CODE" Column="QSTAT" DataColumn="CODE_NAME" DisableBKColor="user5" Enable="FALSE" Height="20" Id="adm_cb_qstat" ImeMode="none" InnerDataset="ds_qstat" Left="454" OnChanged="cb_seq_OnChanged" Style="sty_ipt_form" TabOrder="83" Top="48" Width="186"></Combo>
		<Combo BindDataset="ds_out_master" Border="Flat" CodeColumn="CODE" Column="STATUS" DataColumn="CODE_NAME" DisableBKColor="user5" Enable="FALSE" Height="20" Id="cb_status" InnerDataset="ds_status" Left="96" OnChanged="cb_spartnm_OnChanged" Style="sty_ipt_form" TabOrder="84" Top="48" Width="186"></Combo>
		<Button ButtonStyle="TRUE" Cursor="HAND" DomainID="csh.order" Height="20" Id="btn_purchase" ImageID="btn_sub_04" Left="824" LeftMargin="12" OnClick="btn_purchase_OnClick" Style="sty_btn" TabOrder="85" Text="주문하기" Top="94" Transparent="TRUE" Visible="FALSE" Width="72"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_purchase_accept" ImageID="btn_sub_04" Left="712" LeftMargin="12" OnClick="btn_purchase_accept_OnClick" Style="sty_btn" TabOrder="86" Text="주문수락" Top="48" Transparent="TRUE" Visible="FALSE" Width="72"></Button>
		<Static Align="Center" Height="24" Id="Static15" Left="370" Style="sty_lb_form_basic" TabOrder="87" Text="TRANSPORT" Top="146" VAlign="Middle" Width="80"></Static>
		<Combo BindDataset="ds_out_master" Border="Flat" CodeColumn="CODE" Column="TRANSPORT" DataColumn="CODE_NAME" DisableBKColor="user5" Height="20" Id="cb_transport" InnerDataset="ds_transport_cd" Left="452" Style="sty_ipt_form" TabOrder="88" Top="147" Width="100"></Combo>
		<Static Align="Center" Height="24" Id="Static23" Left="8" Style="sty_lb_form_basic" TabOrder="89" Text="REQUEST&#32;C/O" Top="171" VAlign="Middle" Width="110"></Static>
		<Combo BindDataset="ds_out_master" Border="Flat" CodeColumn="CODE" Column="REQUESTCO" DataColumn="CODE_NAME" DisableBKColor="user5" Height="20" Id="cb_requestco" InnerDataset="ds_yn_cd" Left="119" Style="sty_ipt_form" TabOrder="90" Top="173" Width="120"></Combo>
		<Static Align="Center" Height="24" Id="Static31" Left="242" Style="sty_lb_form_basic" TabOrder="91" Text="PARTIAL&#32;SHIPMENT&#32;" Top="171" VAlign="Middle" Width="130"></Static>
		<Combo BindDataset="ds_out_master" Border="Flat" CodeColumn="CODE" Column="PARTIALSHIP" DataColumn="CODE_NAME" DisableBKColor="user5" Height="20" Id="cb_partialshipment" InnerDataset="ds_yn2_cd" Left="374" Style="sty_ipt_form" TabOrder="92" Top="173" Width="120"></Combo>
		<Static Align="Center" Height="24" Id="Static32" Left="556" Style="sty_lb_form_basic" TabOrder="93" Text="TRANSSHIPMENT&#32;" Top="171" VAlign="Middle" Width="125"></Static>
		<Combo BindDataset="ds_out_master" Border="Flat" CodeColumn="CODE" Column="TRANSSHIP" DataColumn="CODE_NAME" DisableBKColor="user5" Height="20" Id="cb_transshipment" InnerDataset="ds_yn2_cd" Left="682" Style="sty_ipt_form" TabOrder="94" Top="173" Width="120"></Combo>
		<Static Align="Center" DomainID="csh.freight_cost" Height="30" Id="Static34" Left="591" Style="sty_lb_form_basic" TabOrder="95" Text="운임" Top="543" VAlign="Middle" Width="95"></Static>
		<MaskEdit BindDataset="ds_out_master" Border="Flat" Column="NETWR_SHIP" DecimalLen="2" DecimalMinLen="2" Height="26" Id="ed_netwr_ship" Left="695" OnChanged="ed_netwr_ship_OnChanged" Style="sty_ipt_form" TabOrder="96" TabStop="FALSE" Top="545" Value="0" Width="97"></MaskEdit>
		<TextArea Align="Center" Border="None" Height="16" Id="ta_remark" Left="800" Readonly="TRUE" TabOrder="97" Text="remark" ToolTipText="r" Top="552" Width="56"></TextArea>
		<Combo BindDataset="ds_out_master" Border="Flat" CodeColumn="CODE" Column="ZTERM2" DataColumn="CODE_NAME" DisableBKColor="user5" Enable="FALSE" Height="20" Id="cb_zterm2" ImeMode="none" InnerDataset="ds_zterm2" Left="281" Style="sty_ipt_form_ind" TabOrder="99" Top="147" Width="80"></Combo>
		<Static Align="Center" Border="Flat" BorderColor="user13" Height="26" Id="Static20" Left="1000" Style="sty_lb_form_basic" TabOrder="103" Text="합계" Top="199" VAlign="Middle" Width="97"></Static>
		<Static Align="Center" Border="Flat" BorderColor="user13" Height="26" Id="Static21" Left="1096" Style="sty_lb_form_basic" TabOrder="104" Text="증감율" Top="199" VAlign="Middle" Width="97"></Static>
		<MaskEdit Align="Center" BindDataset="ds_out_master" Border="Flat" Column="ID_RATE" DecimalLen="1" DecimalMinLen="1" Enable="FALSE" Height="51" Id="ed_id_rate" Left="1096" Mask="##.#%" Style="sty_ipt_form" TabOrder="102" TabStop="FALSE" Top="224" Width="97"></MaskEdit>
		<MaskEdit BindDataset="ds_out_master" Border="Flat" Column="SUM_STD" DecimalLen="0" Enable="FALSE" Height="26" Id="ed_sum_std" Left="1000" Style="sty_ipt_form" TabOrder="101" TabStop="FALSE" Top="224" Width="97"></MaskEdit>
		<MaskEdit BindDataset="ds_out_master" Border="Flat" Column="SUM_OFR" DecimalLen="0" Enable="FALSE" Height="26" Id="ed_sum_ofr" Left="1000" Style="sty_ipt_form" TabOrder="100" TabStop="FALSE" Top="249" Width="97"></MaskEdit>
		<MaskEdit Border="Flat" DecimalLen="1" Enable="FALSE" Height="26" Id="ed_netwr_pct" Left="304" Mask="##.#%" Style="sty_ipt_form" TabOrder="105" TabStop="FALSE" Top="592" Width="49"></MaskEdit>
		<Static Align="Center" Height="24" Id="adm_st_bildat" Left="1000" Style="sty_lb_form_basic" TabOrder="106" Text="청구계획일" Top="168" VAlign="Middle" Visible="FALSE" Width="80"></Static>
		<Calendar BindDataset="ds_out_master" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="BILDAT" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="adm_cal_bildat" Left="1081" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="107" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="170" Visible="FALSE" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="105"></Calendar>
		<Checkbox BindDataset="ds_out_master" BKColor="user5" Column="QTGB" Enable="FALSE" Height="21" Id="chk_pjtorder" Left="856" TabOrder="108" Text="프로젝트용" Top="232" Width="96"></Checkbox>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_print_po" ImageID="btn_sub_04" Left="712" LeftMargin="12" OnClick="btn_print_po_OnClick" Style="sty_btn" TabOrder="109" Text="Print&#32;PO" Top="72" Transparent="TRUE" Width="80"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="Button1" ImageID="btn_sub_04" Left="992" LeftMargin="12" OnClick="Button1_OnClick" Style="sty_btn" TabOrder="110" Text="재청구" Top="40" Transparent="TRUE" Width="72"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_discount_new" ImageID="btn_sub_06" Left="832" LeftMargin="12" OnClick="btn_discount_new_OnClick" Style="sty_btn" TabOrder="111" Text="상해법인견적" Top="261" Transparent="TRUE" Width="95"></Button>
		<Checkbox Height="15" Id="chk_emyn" Left="815" TabOrder="112" Text="Checkbox0" Top="176" Value="FALSE" Width="12"></Checkbox>
		<TextArea Align="Center" Border="None" Height="16" Id="TextArea0" Left="832" Readonly="TRUE" TabOrder="113" Text="긴급여부" ToolTipText="r" Top="177" Width="56"></TextArea>
	</Form>
	<Script><![CDATA[/*
 ******************************************************************************************
 * 기      능   : 해외부품 견적 작성 
 * 작  성  자   : 
 * 작성  일자   : 
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
#include "LIB::commons.js";	// 공통 스크립트 
#include "LIB::common_cs.js";	// 서비스 공통 스크립트
//=========================================================================================
// [ PART 1 ]
// Form에서 사용될 전역변수를 선언
// FORM에서 사용되는 전역변수는 대문자로 작성하며, F_XXX 의 형태를 갖도록 한다. 
//=========================================================================================

var componentStore;																//enable 상태인 컴포넌트들의 ID를 저장한다. 
var selfFlag;																	//자기자신의 견적인지의 여부를 세팅한다. setPermissions()에서 세팅
var orgPrintFlag;																//견적서, 부품요청서 출력 버튼이 원래 활성화 되었었는지의 여부
var copyFlag = false;															//견적복사 여부
var shdatFlag = false;															//수주등록 시 납기일체크로직에 걸리는지 확인하기 위해 세팅.
var adminFlag ;
var PjtOrderFlag = false ; // 중국의 경우 프로젝트 판매용인 경우 
var lastFlag = false; // 최종견적 여부
//=========================================================================================
// [ PART 2 ]
// Form Loading / Unloading 시 작업 정의
//=========================================================================================
function fn_OnLoadCompleted(obj) {
	gfn_initForm();
	
	//관리자 이외에는 원가항목을 감춘다. 
	//원가관련 항목은 DataSet이 채워지기 전에 처리해야 하므로, Form의 Loading이 완료된 직후 값이 Assign되기 전에 Hide한다.
	
	adminFlag = gfn_getUserGroup();											//사용자 권한그룹
	
	ds_cond.SetColumn(0,"USER_GROUP", adminFlag);
	if(adminFlag != "40")														//그룹이 40인 경우를 제외하고는 해당 항목을 감춘다.
	{
		ufn_hideUnitCostComponents();
	}
	
	//컴포넌트 중 enable 상태인 컴포넌트들을 전역변수에 저장한다.
	//ufn_saveEnabledComponents();	
	
	if(isExistVar("ar_new", true))												//신규견적일 경우
	{
		ds_out_master.SetColumn(0, "CRNAM", G_USER_ID);							//사용자 ID로 세팅
	}
	else if ( isExistVar("ar_qtnum", true) && isExistVar("ar_upn", true)) 		//이전화면에서 견적번호/차수(기존데이터의 경우 '')/upn/cst가 넘어옴
	{
		if(length(ar_qtnum) < 10 || length(ar_upn) < 1 || length(ar_cst) < 1)
		{
			gfn_showAlert("CI30001", "잘못된 접근입니다.");
			fn_close();		
		}
	
		ds_cond.SetColumn(0, "QTNUM", ar_qtnum);								//견적번호
		ds_cond.SetColumn(0, "SEQ", ar_seq);									//차수
		ds_cond.SetColumn(0, "UPN", ar_upn);									//통합프로젝트번호
		ds_cond.SetColumn(0, "CST", ar_cst);									//거래선

		ds_qtm.SetColumn(0, "QTNUM", ar_qtnum);									//견적번호
		ds_qtm.SetColumn(0, "SEQ", ar_seq);										//차수
	}
	else if( isExistVar("ar_qtnum", true) || isExistVar("ar_seq", true))		//이전화면에서 견적번호 또는 차수만 넘어옴
	{
		gfn_showAlert("CI30001", "견적번호 또는 차수가 올바르지 않습니다.");
		fn_close();
	}
	else
	{
		gfn_showAlert("CI30001", "잘못된 접근입니다.");
		fn_close();
	}
	
	ufn_initParameters();
}

/********************************************************************************
* 기      능   : form UnloadCompleted 
********************************************************************************/
function fn_OnUnloadCompleted(obj) {
	return gfn_isFormUnload(obj);
}

//=========================================================================================
// [ PART 3 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,form닫기)
//=========================================================================================

/********************************************************************************
* 기      능   : Delete 
********************************************************************************/
function fn_delete() {
	if(ds_out_master.GetColumn(0, "QTNUM").length <= 0)
	{	// 저장 후 삭제가 가능합니다.
		gfn_showAlert("CI30007");
		return;
	}

	if(!gfn_showConfirm("CI00015", "Quotation")) 
	{
		return;
	}
		
	tit_clearActionInfo();
	tit_addMultiActionInfo("cs80:CS8001001B_D1"); // ZCST001G 
	tit_addMultiActionInfo("cs80:CS8001001B_D2"); // ZCST002G 
	tit_addMultiActionInfo("cs80:CS8001001B_D5"); // ZCST003G 
	tit_addMultiActionInfo("cs80:CS8001001B_D6"); // ZCST00R 
	tit_callService(
		"",
		"",
		"ds_cond=ds_cond",
		"",
		"",
		"fn_afterDeleteAll");	
}

/********************************************************************************
* 기      능   : Delete Callback
********************************************************************************/
function fn_afterDeleteAll(errCode, errMsg)
{
	if ( errCode!= 0 ) 
	{
		gfn_showAlert("CE00001");
	} 
	else 
	{
		ufn_updateLastQtnum2();													//최종견적여부를 업데이트한다.
		gfn_showAlert("CI00004");

		parent.ds_list_master.clearData();										//부모창의 마스터 리스트를 클리어한다.
		parent.ds_list_detail.clearData();										//부모창의 디테일 리스트를 클리어한다.	
		parent.fn_query();
		fn_close();
	}
}

/********************************************************************************
* 기      능   : 저장 
********************************************************************************/
function fn_save() {
	
	var a =0 ;
	//자재가 존재하지 않으면 return. 
	if(ds_list.count <= 0)
	{	// 견적 자재가 존재하지 않습니다.
		gfn_showAlert("CI30008");
		return;
	}	
	
	//데이터가 존재하지 않는 Row를 삭제한다.
	for(iCnt = ds_list.count - 1;iCnt >= 0;iCnt--)
	{

		if(length(ds_list.GetColumn(iCnt, "MATNR")) == 0)
		{
			ds_list.DeleteRow(iCnt);
		}
		ds_list.SetColumn(iCnt, "REQKIND", ds_out_master.GetColumn(0, "REQKIND"));
		
		if(ds_list.GetColumn(iCnt, "REQKIND_CHK") == "1")
		
		if(ds_list.GetColumn(iCnt, "REQKIND") == "")								//자재의 REQKIND가 없을 경우 마스터의 reqkind로 설정한다.
		{
			ds_list.SetColumn(iCnt, "REQKIND", ds_out_master.GetColumn(0, "REQKIND"));
		}
	}


	ds_out_master.SetColumn(0, "DOC1", "");									//단순 저장으로 처리
	ds_out_master.SetColumn(0, "DOC1STAT", "");								//계산서관련항목 체크 Pass
	
	// 견적상태 저장 
	//ds_out_master.SetColumn(0, "STATUS", "A");	 // 견적 저장 
	
	//입력사항에 문  제가 있을 경우 return. 
	if(!ufn_checkInputForSave())
	{
		return;
	}
	
	//자재별 견적가를 설정한다.
	ufn_setMatAmount();		

	ds_list.fireevent = true;
	
	if (!gfn_showConfirm("CI00008")) return;
	
	//저장한다....
	ufn_saveData();
}

function ufn_setMatAmount()
{
	var totalAmt; 																	//표준견적금액
	var dcAmt;																		//견적금액
	var totalMatAmt; 																//표준자재견적금액
	var dcMatAmt;																	//자재견적금액	
	var dcPercent;																	//판가할인비율
	var reqKind = ds_out_master.GetColumn(0, "REQKIND");

	totalAmt = toNumber(ds_out_master.GetColumn(0, "SUM_STD"));
	dcAmt = toNumber(ds_out_master.GetColumn(0, "SUM_OFR"));
	totalMatAmt = toNumber(ds_out_master.GetColumn(0, "NETWR_STD"));
	dcMatAmt = toNumber(ds_out_master.GetColumn(0, "NETWR_OFR"));
	dcPercent = dcAmt / totalAmt;													//판가할인비율
		
	ds_list.fireevent = false;
	
	var tmpAmt = 0;
	var tmpAmtSum = 0;
	var tmpAmtSum2 = 0;
	var orgAmtSum = 0;
	
	//견적상세데이터에 견적합계금액 및 플랜트를 추가한다.
	for(iCnt=0;iCnt < ds_list.rowcount;iCnt++)
	{
		ds_list.SetColumn(iCnt, "WERKS", ds_out_master.GetColumn(0, "WERKS"));	//플랜트
		
		if(reqKind == "1")														//부품판매일경우
		{
			tmpAmt = ds_list.GetColumn(iCnt, "NETWR") * dcPercent;				//자재별 견적(제안)금액 = 할인비율적용 자재판가
		}
		
		ds_list.SetColumn(iCnt, "AMT", 0);		//임율
		ds_list.SetColumn(iCnt, "AMOUNT", tmpAmt);
		
		tmpAmtSum += tmpAmt;
		tmpAmtSum2 += tmpAmt;
		orgAmtSum += tmpAmt;
		
		}
	
	}

}

/********************************************************************************
* 기      능   : DB 저장 루틴
********************************************************************************/
function ufn_saveData()
{
	// 저장 처리 
	tit_clearActionInfo();

	//alert("cb_kvgr2  1  :: "+ cb_kvgr2.Index);
	//신규견적 - 견적번호가 없을 경우 신규로 생성한다. 
	//if (ds_out_master.GetColumn(0,"QTNUM") == "")
	if (ds_out_master.GetColumn(0, "QTNUM") == "" || length(ds_out_master.GetColumn(0, "QTNUM")) < 10)
	{	
		ds_cond.SetColumn(0, "SEQ", "0");											//차수를 0으로 저장한다.
		tit_addSearchActionInfo("cs80:CS8001001B_T1",true);
		tit_addSearchActionInfo("cs80:CS8001001B_S3",true);
	}

	//기 존재 견적 - 견적번호가 존재하므로 update한다.
	else 
	{
		ds_key.clearData();
		ds_key.AddRow();
		ds_key.SetColumn(0, "QTNUM", ds_out_master.GetColumn(0, "QTNUM"));
		ds_key.SetColumn(0, "SEQ", ds_out_master.GetColumn(0, "SEQ"));


		//자재 디테일 정보의 견적번호, SEQ가 비어있을 경우 채운다(이런 경우는 발생하지 않지만, 예전 화면에서 가져온것을 남겨둠)
		for (var i = 0; i < ds_list.rowcount; i++) 
		{
			if (ds_list.GetColumn(i, "FLAG") == "") 
			{
				ds_list.SetColumn(i, "FLAG", "U");
			}
			if (ds_list.GetColumn(i, "QTNUM") == "") 
			{
				ds_list.SetColumn(i, "QTNUM", ds_out_master.GetColumn(0,"QTNUM"));
				ds_list.SetColumn(i, "SEQ", ds_out_master.GetColumn(0,"SEQ"));
		
			}
		}
	}

	//입력된 자재가 내작자재만 있는 경우를 체크(2015.07.02 LJH)
	var tmp_rgbn = "Y";
	
	for(var i=0; i<ds_list.rowcount; i++) {
		if(ds_list.GetColumn(i, "RGBN") == "1") { //보수자재
			tmp_rgbn = "N";
		}
	}
	//자재유형 체크 추가 (2015.12.28 JYW)
	for(var i=0; i<ds_list.rowcount; i++) {
		
		if((ds_list.GetColumn(i,"MATNR") == "NS-100" || ds_list.GetColumn(i,"MATNR") == "ns-100") && 
		    ds_list.GetColumn(i,"MTART") != "Z001")
		{
			gfn_showMsg("CW00114","자재 유형 저장이");
			return;
		}
		if((ds_list.GetColumn(i,"MATNR") == "NB-100" || ds_list.GetColumn(i,"MATNR") == "nb-100") && 
		    ds_list.GetColumn(i,"MTART") != "Z001")
		{
			gfn_showMsg("CW00114","자재 유형 저장이");
			return;
		}
		if((ds_list.GetColumn(i,"MATNR") == "NC-100" || ds_list.GetColumn(i,"MATNR") == "nc-100") && 
		    ds_list.GetColumn(i,"MTART") != "Z001")
		{
			gfn_showMsg("CW00114","자재 유형 저장이");
			return;
		}
	}
	
	// 긴급여부 선택 시 해당값 세팅
	// 2018.10.15 J.H Han
	if(chk_emyn.Value == '0') {
		ds_out_master.SetColumn(0, "EMYN", "N");
	} else if(chk_emyn.Value == '1') {
		ds_out_master.SetColumn(0, "EMYN", "Y");
	}
	
	//ZCST001에 마스터 데이터를 저장(업데이트)한다.
	tit_addSaveActionInfo(
         "cs80:CS8001001B_I1",
         "cs80:CS8001001B_U1",
         "",
         "FLAG",
         "",
         0,
         "");

	//ZCST002에 디테일 데이터를 저장(업데이트)한다.
	tit_addSaveActionInfo(
        "cs80:CS8001001B_I2",
        "cs80:CS8001001B_U2",
        "",
        "FLAG",
        "",
        0,
        "");
        
	//ZCST003에 디테일 데이터를 저장(업데이트)한다.  견적상태관리
	tit_addSaveActionInfo(
        "cs80:CS8001001B_I8",
        "cs80:CS8001001B_U8",
        "",
        "FLAG",
        "",
        0,
        "");
        
	// ZCST001R  시행예산 관리 
	tit_addSaveActionInfo(
        "cs80:CS8001001B_I9",
        "cs80:CS8001001B_U9",
        "",
        "FLAG",
        "",
        0,
        "");

	tit_callService(
        ""
        , ""
        , "ds_out_master=ds_out_master ds_list=ds_list:A ds_cond=ds_cond ds_key=ds_key"
        , "ds_key = ds_key"
        , ""
        , "fn_afterSave");
}

/********************************************************************************
* 기      능   : 저장 Callback  
********************************************************************************/
function fn_afterSave(errCode, errMsg) {
	if ( errCode!= 0 ) {
		gfn_showAlert("CE00001");
	} else {

		var newFlag = false;													//신규견적여부

		if(length(ds_cond.GetColumn(0,"QTNUM")) > 1)							//기존에 있던 데이터를 저장한 경우
		{
			ed_qtnum.value = ds_cond.GetColumn(0,"QTNUM");
			ed_SEQ.value = ds_cond.GetColumn(0,"SEQ");
		}
		else																	//신규저장일 경우
		{
			ed_qtnum.value = ds_key.GetColumn(0,"QTNUM");
			ds_cond.SetColumn(0, "QTNUM", ds_key.GetColumn(0,"QTNUM"));
			ds_out_master.SetColumn(0, "QTNUM", ds_key.GetColumn(0,"QTNUM"));
			
			ed_seq.value = ds_key.GetColumn(0, "SEQ");
			ds_cond.SetColumn(0, "SEQ", ds_key.GetColumn(0,"SEQ"));
			ds_out_master.SetColumn(0, "SEQ", ds_key.GetColumn(0,"SEQ"));
			newFlag = true;														//신규견적 플래그 세팅
		}

		
		ufn_updateLastQtnum();													//최종견적여부를 업데이트한다.
		//저장
		gfn_showInform("CI00003");

		parent.ds_list_master.clearData();										//부모창의 마스터 리스트를 클리어한다.
		parent.ds_list_detail.clearData();										//부모창의 디테일 리스트를 클리어한다.
		parent.fn_query();
		ufn_initParameters();													//Parameter를 초기화한다.
	}
}

/********************************************************************************
* 기      능   : 최종견적여부 UPDATE(2015.02.23 LJH 변경처리)
********************************************************************************/
function ufn_updateLastQtnum()
{
	//최종견적여부를 업데이트한다.
	tit_clearActionInfo();
	tit_addSingleActionInfo("cs80:CS8001001B_U6");
	tit_callService(
        ""
        , ""
        , "ds_key=ds_key"
        , ""
        , ""
        , ""
        , false
        , false
        , true);
}

function ufn_updateLastQtnum2()
{
	//최종견적여부를 업데이트한다.
	tit_clearActionInfo();
	tit_addSingleActionInfo("cs80:CS8001001B_U7");
	tit_callService(
        ""
        , ""
        , "ds_qtm=ds_qtm"
        , ""
        , ""
        , ""
        , false
        , false
        , true);
}

/********************************************************************************
* 기      능   : 닫기  
********************************************************************************/
function fn_close() {
	
	var saveFlag = false;

	for(var iCnt = 0;iCnt < ds_list.rowcount;iCnt++)							//저장된 견적에는 자재가 1개 이상 존재해야 하므로, 자재 없이 종료는 불가능하다. 
	{
		if(ds_list.GetColumn(iCnt, "FLAG") != "I") saveFlag = true;				//자재중 신규자재가 아닌 자재가 존재할 경우에만 종료 가능(기 저장 자재 존재시)
	}
	
	if(ds_out_master.GetColumn(0, "QTNUM").length <= 0) saveFlag = true;		//견적번호가 없을 경우 저장 가능(신규견적시) 

	if(!saveFlag)
	{
	//	gfn_showAlert("CI30001", "견적에 자재가 존재하지 않습니다. 견적을 삭제하거나 자재추가-저장 후 종료하세요.");
	//	return;
	}
	
	close();
}

/********************************************************************************
* 기      능   : 반송 65
********************************************************************************/
function fn_sendback() {
	var docNo1, docNo2;															//견적결재문서번호, 수주결재문서번호
	var docNo1Stat, docNo2Stat;													//결재상태1, 결재상태2
		
	docNo1 = ds_out_master.GetColumn(0, "DOC1");								//견적결재문서번호
	docNo2 = ds_out_master.GetColumn(0, "DOC2");								//수주결재문서번호
	docNo1Stat = ds_out_master.GetColumn(0, "DOC1STAT");						//견적결재상태
	docNo2Stat = ds_out_master.GetColumn(0, "DOC2STAT");						//수주결재상태
	
	if(docNo1.length <= 0)														//견적번호가 제대로 입력되지 않았으면..
	{
		gfn_showAlert("CI30001", "기안이 완료되지 않았습니다.");
		return;
	}
	
	if(!gfn_showConfirm("CI30001", "본 건을 반송처리 하시겠습니까?"))			//반송처리하시겠습니까?
	{
		gfn_showAlert("CI30001", "반송처리가 취소되었습니다.");
		return;
	}	
	
	ds_dec.ClearData();
	ds_dec.AddRow();
	ds_dec.SetColumn(0, "REIRUM", G_USER_NAME);									//결재자 이름
	ds_dec.SetColumn(0, "SEQSTAT", "2");
	
	if(toNumber(docNo2Stat) > 3)
	{
		ds_dec.SetColumn(0, "APPGUBN", "R");									//수신부서결재플래그
		ds_dec.SetColumn(0, "APSTAT", "5");										//결재마스터 상태 - 반송(2)
	}
	else
	{
		ds_dec.SetColumn(0, "APPGUBN", "S");									//기안부서결재플래그
		ds_dec.SetColumn(0, "APSTAT", "2");										//결재마스터 상태 - 반송(2)
	}

	if(docNo2.length <= 0)														//견적결재시
	{
		ds_dec.SetColumn(0, "DOCNO", docNo1);									
		ds_dec.SetColumn(0, "SEQNO", ds_out_master.GetColumn(0, "DOC1CURSEQ"));
		ds_dec.SetColumn(0, "DOCKIND", "12");									//문서종류(수리공사견적)
	}
	else																		//수주결재시
	{
		ds_dec.SetColumn(0, "DOCNO", docNo2);
		ds_dec.SetColumn(0, "SEQNO", ds_out_master.GetColumn(0, "DOC2CURSEQ"));
		ds_dec.SetColumn(0, "DOCKIND", "13");									//문서종류(수리공사계약(수주))
	}
	
	ds_reject_wb.clearData();													//반송의견을 반송쪽지로 전송하기 위해 데이터셋을 클리어하고, 행을 추가한다.
	ds_reject_wb.AddRow();
	
	if(gfn_showConfirm("CI30001","반송 의견을 입력하시겠습니까?") )				//반송 의견 입력
	{
		var arg = "";
		arg = "fa_docno=" + quote(ds_dec.GetColumn(0,"DOCNO")) + 
		      " fa_dockind=" + quote(ds_dec.GetColumn(0,"DOCKIND"));
		var rtn_yn = gfn_openPopup2("CS0401001C", true , arg);
	}
	
	//반송메시지를 생성한다.
	ufn_sendSendbackMessage();
	
	//결재마스터(zwbap01)와 결재디테일(zwbap02)을 업데이트 해준다.
	tit_clearActionInfo();
	tit_addSearchActionInfo("80:CS8001001B_T3",true);							//쪽지테이블 Lock (중복번호 채번 방지)
	tit_addMultiActionInfo("cs80:CS8001001B_I5", "cs80:CS8001001B_S16", 1);		//쪽지전송
	tit_addMultiActionInfo("cs04:CS0401001A_U1");								//결재마스터 Update
	tit_addMultiActionInfo("cs04:CS0401002A_U2");								//결재디테일 Update
	tit_callService(
		"",
		"",
		"ds_head=ds_dec ds_list_0=ds_dec ds_reject_list=ds_reject_list",
		"",
		"",
		"", 
		true, 
		false,
		true);	

	gfn_showAlert("CI30001", "반송처리가 완료되었습니다.");
	fn_close();	
}

/********************************************************************************
* 기      능   : 반송메시지 작성
********************************************************************************/
function ufn_sendSendbackMessage()
{
	var docNo2 = ds_out_master.GetColumn(0, "DOC2");							//수주결재문서번호
	var msgDocNo = ds_dec.GetColumn(0,"DOCNO");
	var msgTitle = "견적번호 " + ds_out_master.GetColumn(0, "QTNUM") + "인 문서가 ";
	
	if(docNo2.length <= 0)
		msgTitle += "견적 결재중 반송되었습니다.";
	else
		msgTitle += "수주 결재중 반송되었습니다.";

	var msgBody = "견적명 : " + ds_out_master.GetColumn(0, "QTNAM") + "\n" +
				  "견적번호 : " + ds_out_master.GetColumn(0, "QTNUM") + "\n" +
				  "견적차수 : " + ds_out_master.GetColumn(0, "SEQ") + "\n" +
				  "프로젝트 : " + ds_out_master.GetColumn(0, "SPT") + "\n" +
				  "현장정보 : " + ds_out_master.GetColumn(0, "KUNNR") + "(" + ds_out_master.GetColumn(0, "CSTNM") + ")\n" +
				  "반송정보 : " + ds_reject_wb.GetColumn(0, "APDESC");			//반송메시지를 추가한다.
				  
	//반송쪽지 전송 검색조건 세팅(문서번호)
	ds_reject_cond.clearData();
	ds_reject_cond.AddRow();
	ds_reject_cond.SetColumn(0, "DOCNO", msgDocNo);								//문서번호 설정
	
	ds_reject_list.ClearData();													//전송대상 리스트를 클리어한다.

	tit_clearActionInfo();					
	tit_addSearchActionInfo("cs80:CS8001001B_S15");								//반송 기안자 
	tit_callService("", "", "ds_reject_cond=ds_reject_cond", "ds_reject_wb=ds_reject_wb", "", "", true, false, true);	
	
	ds_reject_list.AddRow();													//작성자
	ds_reject_list.SetColumn(0, "MESGSEND", G_USER_ID);							//반송자
	ds_reject_list.SetColumn(0, "MESGACCP", ds_out_master.GetColumn(0,"CRNAM"));//작성자
	ds_reject_list.SetColumn(0, "MESGTITL", msgTitle);							//제목
	ds_reject_list.SetColumn(0, "MESGDESC", msgBody);							//반송문구
	
	//기안부서 기안자가 존재하고, 작성자가 기안부서 기안자가 아닐 경우(이미 전송된 사용자에게 중복전송되지 않도록)
	if(length(ds_reject_wb.GetColumn(0, "APNUM1")) > 1 
		&&ds_out_master.GetColumn(0, "CRNAM") != ds_reject_wb.GetColumn(0, "APNUM1"))
	{
		ds_reject_list.AddRow();												//기안부서 기안자
		ds_reject_list.SetColumn(1, "MESGSEND", G_USER_ID);
		ds_reject_list.SetColumn(1, "MESGACCP", ds_reject_wb.GetColumn(0, "APNUM1"));
		ds_reject_list.SetColumn(1, "MESGTITL", msgTitle);
		ds_reject_list.SetColumn(1, "MESGDESC", msgBody);
	}
		
	//관리부서 기안자 존재하고 관리부서 기안자 작성자 또는 기안부서 기안자가 아닌 경우(이미 전송된 사용자에게 중복전송되지 않도록)
	if( length(ds_reject_wb.GetColumn(0, "APNUM2")) > 1 
		&& (ds_out_master.GetColumn(0, "CRNAM") != ds_reject_wb.GetColumn(0, "APNUM2"))
		&& (ds_reject_wb.GetColumn(0, "APNUM1") != ds_reject_wb.GetColumn(0, "APNUM2")) )
	{
		ds_reject_list.AddRow();												//관리부서 기안자
		ds_reject_list.SetColumn(2, "MESGSEND", G_USER_ID);
		ds_reject_list.SetColumn(2, "MESGACCP", ds_reject_wb.GetColumn(0, "APNUM2"));
		ds_reject_list.SetColumn(2, "MESGTITL", msgTitle);
		ds_reject_list.SetColumn(2, "MESGDESC", msgBody);
	}
	
}

/********************************************************************************
* 기      능   : 승인 
********************************************************************************/
function fn_approval() {

//alert("승인 >> 청구 i/f"); return;
		//저장 SEQ와 QTNUM을 설정한다.
		ds_cond.ClearData();
		ds_cond.AddRow();
		ds_cond.SetColumn(0, "QTNUM", ds_out_master.GetColumn(0, "QTNUM"));
		ds_cond.SetColumn(0, "SEQ", ds_out_master.GetColumn(0, "SEQ"));
		

		
		ds_out_master.SetColumn(0, "FLAG", "I");								//FLAG를 바꿔준다.
		
		for (var iCnt = 0;iCnt < ds_list.rowcount;iCnt++) 
		{
			if(ds_list.getColumn(iCnt, "RGBN") == "1")							//자재 중 보수자재만 전송한다. 내작(BOM)자재는 미전송
			{
				ds_list.SetColumn(iCnt, "FLAG", "I");
			}
			else
			{	
				ds_list.SetColumn(iCnt, "FLAG", "");
			}
		}
				

		ds_out_master.SetColumn(0, "QSTAT", "2");								//ZCST001의 QSTAT를 청구접수로 바꾼다.
		ds_out_master.SetColumn(0, "CHGBN", "0");								//ZCST001의 청구구분을 청구접수(0)으로 바꿔준다. 1:수주변경, 2:수주취소, 3:재청구		
		
		
		ds_out_master.SetColumn(0, "STATUS", "C");	 // 견적 저장 
		gfn_copyDs(ds_list, ds_list_req, "FLAG=" + quote("I"));				//청구전송 데이터셋에 데이터를 카피한다.


		tit_addSearchActionInfo("cs80:CS8001001B_T2", true);				//청구번호 채번용 Exclusive Lock
		tit_addSearchActionInfo("cs80:CS8001001B_S8", true);				//청구번호 채번(ds_key)
		
		tit_addMultiActionInfo("cs80:CS8001001B_I3");						//ZMMT031에 데이터를 INSERT 한다.
		tit_addMultiActionInfo("cs80:CS8001001B_U3");						//ZCST001을 UPDATE해 준다(REQNO)


		tit_addMultiActionInfo("cs80:CS8001001B_U8");                       // ZCST003G 견적 상태 변경 


		tit_callService(
			"" 
			, ""
			, "ds_head=ds_dec ds_list_0=ds_dec ds_out_master=ds_out_master ds_list=ds_list_req ds_cond=ds_cond ds_key=ds_key"
			, "ds_key = ds_key"
			, ""
			, "fn_afterSaveRequest");	


}

function fn_afterSaveRequest(errCode, errMsg)
{
	if ( errCode!= 0 ) {
		gfn_showAlert("CE00001");
	} else {
	
		gfn_showInform("CI00003");	
		
		if (reOrder == true) {
			gfn_showInform("CI30001", "재청구 완료되었습니다.");
		
		} else {
			gfn_showInform("CI30001", "견적 승인이 완료되었습니다.");
		}
		
		
		for (var iCnt = 0;iCnt < ds_list.rowcount;iCnt++) 						//종료를 위해 데이터셋의 플래그를 복구한다.
		{
			ds_list.SetColumn(iCnt, "FLAG", "");
		}
		
		fn_close();		
	}
}

/********************************************************************************
* 기      능   : 기안 
********************************************************************************/
function fn_draft() {
	
}

/********************************************************************************
* 기      능   : 재견적
********************************************************************************/
function fn_recost() 
{
	//수주등록으로 납기일변경 활성화 되어있는 상태에서 재견적진행하려는 경우 처리불가능
	if(shdatFlag){
		gfn_showAlert("CI30001", "수주등록 작업진행 중으로 재견적이 불가합니다.");
		return;
	}
	//재견적은 마지막 차수만 가능
	if(cb_seq.Value != ds_seq.max("CODE")) 
	{
		gfn_showAlert("CI30001", "최종차수가 아니므로 재견적이 불가능합니다.");
		return;
	}
	
	//재견적여부 확인
	//현재 견적을 재견적 하시겠습니까?
	if(!gfn_showConfirm("CI30011")) return;
	
	
	//수주등록 기안올리기 전까지만 재견적이 가능하다. 2015.09.18 YAR
	if(length(ds_out_master.GetColumn(0, "DOC2")) > 0) //수주등록기안 올렸거나, 반송상태인경우 재견적 불가
	{
		gfn_showAlert("CI30001", "수주등록 진행 중으로 재견적이 불가합니다.");
		return;
	}

	//차수를 증가시킨다
	var newSeq = toString(toNumber(ds_out_master.GetColumn(0, "SEQ")) + 1);
	
	//증가된 차수를 적용한다.
	ds_seq.AddRow();
	ds_seq.SetColumn(ds_seq.rowcount - 1, "CODE", newSeq);
	ds_seq.SetColumn(ds_seq.rowcount - 1, "CODE_NAME", newSeq + "차");
	
	ds_out_master.SetColumn(0, "SEQ", newSeq);									//마스터데이터 차수 증가
	ds_out_master.SetColumn(0, "FLAG", "I");									//마스터데이터 Insert를 위한 Flag 설정(I)
	ds_cond.SetColumn(0, "SEQ", newSeq);										//검색데이터셋의 차수 증가
	
	for(var iCnt = 0; iCnt < ds_list.rowcount; iCnt++)
	{
		ds_list.SetColumn(iCnt, "SEQ", newSeq);									//자재리스트 차수 증가
		ds_list.SetColumn(iCnt, "FLAG", "I");									//자재리스트 Insert Flag 설정
		ds_list.SetColumn(iCnt, "REQKIND", ds_out_master.GetColumn(0, "REQKIND"));
	}
	
	//새로운 차수의 레코드를 생성하는 것이므로, 결재 관련 사항을 리셋한다.
	ds_out_master.SetColumn(0, "DOC1", "");
	ds_out_master.SetColumn(0, "DOC2", "");
	ds_out_master.SetColumn(0, "DOC3", "");
	ds_out_master.SetColumn(0, "DOC4", "");
	ds_out_master.SetColumn(0, "DOC5", "");
	ds_out_master.SetColumn(0, "DOC1STAT", "");
	ds_out_master.SetColumn(0, "DOC2STAT", "");
	ds_out_master.SetColumn(0, "DOC3STAT", "");
	ds_out_master.SetColumn(0, "DOC4STAT", "");
	ds_out_master.SetColumn(0, "DOC5STAT", "");
	ds_out_master.SetColumn(0, "DOC1STATNM", "");
	ds_out_master.SetColumn(0, "DOC2STATNM", "");
	ds_out_master.SetColumn(0, "DOC3STATNM", "");
	ds_out_master.SetColumn(0, "DOC4STATNM", "");
	ds_out_master.SetColumn(0, "DOC5STATNM", "");
	ds_out_master.SetColumn(0, "DOC1DEC", "");
	ds_out_master.SetColumn(0, "DOC2DEC", "");
	ds_out_master.SetColumn(0, "DOC3DEC", "");
	ds_out_master.SetColumn(0, "DOC4DEC", "");
	ds_out_master.SetColumn(0, "DOC5DEC", "");
	
	//새로운 차수의 레코드를 생성하는 것이므로, 견적 관련 사항을 리셋한다.
	ds_out_master.SetColumn(0, "PS_PSPID", "");									//원WBS
	ds_out_master.SetColumn(0, "QSTAT", "");									//청구상태
	ds_out_master.SetColumn(0, "CHGBN", "");									//견적상태
	

	ufn_saveData();																//데이터를 저장한다.
}	

/********************************************************************************
* 기      능   : 리셋 85
********************************************************************************/
function fn_reset() 
{
	if(gfn_showConfirm("CI30001", "입력을 취소하고 모든 정보를 초기화 하시겠습니까?"))
	{
		ufn_resetAll();															//모든 정보를 리셋한다.
		ufn_initParameters();													//Parameter를 초기화한다.
	}
}

//=========================================================================================
// [ PART 4]
// Callback 함수 정의 : callback 함수명은 메인 함수의 fn_xxxx() 에서 xxxx 부분은 fn_afterXXXX()
// 형태가 되도록 작성 
//=========================================================================================

/********************************************************************************
* 기      능   : 공통코드 조회 Callback
********************************************************************************/
function fn_completeInit(sCode, sDsObj, sCodeType) {
	// 지급 조건 정렬 
	ds_zterm.Sort("DTEXT1");
}

//=========================================================================================
// [ PART 5 ]
// Detail Process Event 정의 ( User Define function )
// 사용자 정의 함수는 ufn_xxxx() 형태로 작성 
//=========================================================================================

/********************************************************************************
* 기      능   : 모든 정보를 리셋(ds_cond는 초기화 및 재조회를 위해 남겨둠)
********************************************************************************/
function ufn_resetAll()
{
	ds_list.clearData();														//ds_list를 삭제한다.
	ds_out_master.clearData();													//ds_out_master를 삭제한다. 
	ds_out_master.addRow();														//ds_out_master에 새 Row를 Insert한다.
	ds_pjt_det.clearData();
	ds_key.clearData();															//ds_key를 clear한다.
	ds_key.AddRow();															//ds_key에 새 Rwo를 Insert한다.
	
	//Mask Edit Box를 모두 Clear한다.
	var comps = Components["MaskEdit"];
	for(iCnt=0;iCnt < comps.count();iCnt++)
	{
		comps[iCnt].value = "";
	}
}

/********************************************************************************
* 기      능   : 누락 항목 Check
********************************************************************************/
function ufn_checkInputForSave()
{
	var newSaveFlag = true;														//신규견적인경우 true, 수주등록시 사용할 기등록견적인경우 false

	if(toNumber(ds_out_master.GetColumn(0, "DOC1STAT")) >= 3) 			 		//견적결재가 완료된경우 newflag를 false로 설정하여 계산서 관련항목 입력토록
	{
		newSaveFlag = false;
	}


	//----------------------------------------------------------------------
	//입력필드 확인
	
	if(ufn_isNull(ed_qtnam, true, "견적명", ed_qtnam)) return false;			//견적명
	if(ufn_isNull(ed_pjt, true, "Proj. No", ed_pjt)) return false;				//프로젝트번호
	if(ufn_isNull(cb_spartnm, true, "제품군", cb_spartnm)) return false;		//제품군
	//if(ufn_isNull(cal_sodat, true, "수주예정일", cal_sodat)) return false;		//수주예정일
	if(ufn_isNull(cal_qtrcdat, true, "견적접수일", cal_qtrcdat)) return false;		//견적접수일 2020.02.03 견적접수일 항목 추가. 이지원 요청. Han J.H
	if(ufn_isNull(adm_cal_shdat, true, "납기일", adm_cal_shdat)) return false;		//수주예정일
	if(ufn_isNull(cb_inco1, true, "인도조건1", cb_inco1)) return false;			//인도조건1
	
	// EXW,  FCA, FAS, DDU, DDP  의 경우 인도조건 2 값 조정
	if(gfn_isNull(ed_inco2)) {
		if(cb_inco1.value == "EXW" or cb_inco1.value == "FCA"
		   or cb_inco1.value == "FAS" or cb_inco1.value == "DDU" or cb_inco1.value == "DDP" ) 
		{
			ed_inco2.Text = ".";	
		}
	}
	
	if(ufn_isNull(ed_inco2, true, "인도조건2", ed_inco2)) return false;			//인도조건2
//	if(ufn_isNull(cb_zterm, true, "수금조건", cb_zterm)) return false;			//수금조건
	if(ufn_isNull(cb_zterm, true, st_zterm.Text, cb_zterm)) return false;			//수금조건

	if(newSaveFlag)																//신규견적일 경우에만 체크
	{
		// 수주예정일 컬럼삭제로 인한 주석처리. 2020.02.03 이지원 요청. Han J.H
		//if(!gfn_checkDate(gfn_getCurrDate(), ds_out_master.GetColumn(0,"SODAT"), true, cal_sodat,"수주예정일")) return false;		//수주예정일
		
		if(!gfn_checkDate(gfn_getCurrDate(),ds_out_master.GetColumn(0,"SHDAT"), true, adm_cal_shdat,"납기일")) return false;			//납기일		
	}
	//납기일 체크로직
	if(!check_Rdate())		return false;

	//20150208 - 판매단가가 0일경우 저장불가, 20150603 LJH 보완(최초값 체크)
	 for(var iCnt=0;iCnt<ds_list.rowcount;iCnt++)
	 {
		 if(toNumber(ds_list.GetColumn(iCnt, "NETPR") == 0) || toNumber(ds_list.GetOrgColumn(iCnt, "NETPR") == 0) || 
		    toNumber(ds_list.GetColumn(iCnt, "NETPR_ORG") == 0) || toNumber(ds_list.GetOrgColumn(iCnt, "NETPR_ORG") == 0))
		 {
			//판매단가가 0인 자재가 존재하여 저장이 불가능합니다.
			 gfn_showAlert("CI30012");
			 return false;
		 }

		 if(toNumber(ds_list.GetColumn(iCnt, "MENGE") == 0) || toNumber(ds_list.GetOrgColumn(iCnt, "MENGE") == 0))
		 {	//"수량이 0인 자재가 존재하여 저장이 불가능합니다."
			 gfn_showAlert("CI30013");
			 return false;
		 }
	 }
	
	//20150209 - 한가지 아이템을 여러 호기에 적용할때
	var matnrCd, bwtarCd, zgubnYn, reqkindCd, hNo;								//자재코드(번호), 평가유형코드, 직영재고구분(Y or ''), 자재청구유형(1, 6, 7, 8, G), 호기번호
	for(var iCnt=0;iCnt<ds_list.rowcount;iCnt++)
	{
		matnrCd = ds_list.GetColumn(iCnt, "MATNR");								//자재번호
		bwtarCd = ds_list.GetColumn(iCnt, "BWTAR");								//평가유형
		zgubnYn = ds_list.GetColumn(iCnt, "ZGUBN");								//직영재고구분
		reqkindCd = ds_list.GetColumn(iCnt, "REQKIND");							//자재청구유형(업체재고소진시 6)
		hNo = ds_list.GetColumn(iCnt, "HNO");									//호기번호		
		
		for(var iCnt2=0;iCnt2<ds_list.rowcount;iCnt2++)
		{
			if(iCnt != iCnt2)													//자신이 아닐 경우에만 비교
			{
				if(matnrCd == ds_list.GetColumn(iCnt2, "MATNR"))				//동일 자재인가?
				{
					if(bwtarCd != ds_list.GetColumn(iCnt2, "BWTAR"))			//평가유형이 다른 자재인가?
					{
						gfn_showAlert("CI30001", "평가유형은 자재별로 동일하게 설정하셔야 합니다.");
						return false;
					}
					
					if(zgubnYn != ds_list.GetColumn(iCnt2, "ZGUBN"))			//직영재고구분이 다른 자재인가?
					{
						gfn_showAlert("CI30001", "직영재고여부는 자재별로 동일하게 설정하셔야 합니다.");
						return false;
					}
					
					if((reqkindCd != ds_list.GetColumn(iCnt2, "REQKIND")) 
														&& reqkindCd == "6")	//업체재고소진여부가 다른 자재인가?
					{
						gfn_showAlert("CI30001", "업체재고소진여부는 자재별로 동일하게 설정하셔야 합니다.");
						return false;
					}		
								
					if(hNo == ds_list.GetColumn(iCnt2, "HNO"))					//호기별로 동일자재가 2번이상 견적되었는가?
					{	//호기별로 동일자재는 중복견적하실 수 없습니다."
						gfn_showAlert("CI30014");
						return false;
					}
				}
			}
		}
	}

	/* 20150114-최인식GJ-유지보수대장 항목20 참고-아래 항목은 견적작성시 옵션, 수주등록시 필수로 처리해야함 */
	
	if(!newSaveFlag)																//견적이 신규일 경우 옵션으로 처리하고, 신규가 아닐경우 필수로 처리한다.
	{ 
		if(cb_kvgr1.Index < 0)													//계산서구분(Index:1의 value가 ''임.. 즉, code가 ''임.. 이따위 코드가 어딨어 --;)
		{	
			gfn_showAlert("CW00001", "계산서구분");
			cb_kvgr1.setFocus();
			return false;
		}
		
		if(cb_kvgr2.Index < 0)													//발송구분(역시 코드가 ''임 --;)
		{	
			gfn_showAlert("CW00001", "발송구분");
			cb_kvgr2.setFocus();
			return false;
		}
		
		if(ufn_isNull(cb_taxk1, true, "세금구분", cb_taxk1)) return false;		//세금구분
		if(ufn_isNull(cb_zterm, true, "수금조건", cb_zterm)) return false;		//수금조건
		
		if (!gfn_checkDate(gfn_getCurrDate(),ds_out_master.GetColumn(0,"BILDAT"), true, cal_bildat1,"계산서발행일1")) return false;	//계산서발행일1
	

	 }
	//----------------------------------------------------------------------
	//청구구분에 따른 판매할인액 적용
	//ed_netwr_dc.Text = "0";
	//ed_netwr_ship.Text = "0";
	if(cb_reqkind.value == 1) 												//부품판매
	{
		if(ufn_isNull(ed_netwr_dc, true, "판매할인액", ed_netwr_dc)) return false;
	}
	else
	{
		ed_netwr_dc.Text = "0";
	}

	
	//----------------------------------------------------------------------
	//계산값 확인
	
	if(length(ed_netwr_std.value) == 0 || length(ed_netwr_ofr.value) == 0 || length(ed_sum_std.value) == 0 ||length(ed_sum_ofr.value) == 0)
	{	
		gfn_showAlert("CI30001", "표준금액 또는 견적금액상에 오류가 있습니다. 자재리스트를 확인해주세요.");
		return false;
	}

	//그리드상의 자재 판매단가 합계금액과 헤더의 표준금액(자재판매가) 동일여부 체크
	if(ds_list.Sum("NETWR") <> ed_netwr_std.value)
	{	//ALERT("NETWR  :" + ds_list.Sum("NETWR") );ALERT("ED   :" + ed_netwr_std.value );
		gfn_showAlert("CI30001", "자재 판매단가 합계금액과 헤더의 견적금액(자재판매가)이 동일하지 않습니다.");
		return false;
	}

	//----------------------------------------------------------------------
	//자재리스트값 확인
	//프로젝트 여부 확인
	var listFlag = true;
	for(iCnt=0;iCnt < ds_list.count;iCnt++)
	{
		if(length(ds_list.GetColumn(iCnt, "HNO")) == 0 							//호기번호
				|| length(ds_list.GetColumn(iCnt, "MATNR")) == 0 				//자재번호
				|| length(ds_list.GetColumn(iCnt, "BWTAR")) == 0 				//평가유형
				|| length(toString(ds_list.GetColumn(iCnt, "MENGE"))) == 0 	)	//수량
		{
			listFlag = false;
		}
		if(ds_list.GetColumn(iCnt, "MATNR") != "NB-100") {
			if(length(ds_list.GetColumn(iCnt, "MAT_CODE")) == 0 	) {
				//자재 품명그룹 지정이 안되어 있습니다. 저장을 취소합니다.
				gfn_showAlert("CI30015");
				return false;
			}
		}


	}
	if(!listFlag)
	{	//자재 리스트의 자재 중 필수입력값이 비어있는 자재가 존재합니다.
		gfn_showAlert("CI30016");
		return false;
	}
	
	return true;
}

/********************************************************************************
* 기      능   : Null여부 확인 gfn_isNull을 Status에서 Alert방식으로 바꿈(팝업이므로 메세지창이 없음)
********************************************************************************/
function ufn_isNull(chkObj, isShowMsg, lbTxt, focusObj) {

	if( length( chkObj.value) > 0 ) {
		return false;
	}

	if( isShowMsg ) {
		// 메시지 처리
		if( length( lbTxt) == 0 ) {
			// 필수 입력항목 입니다. 확인하여 주십시오.
			gfn_showAlert("CW00002");
		} else {
			// lbTxt + " 항목에 값이 누락되어 있습니다. 확인하여 주십시오."
			gfn_showAlert("CW00001", lbTxt);
		}
	}

	if( focusObj == null ) {
		focusObj = chkObj;
	}

	focusObj.setFocus();
	return true;
}

/********************************************************************************
* 기      능   : 화면상의 조건들을 초기화 한다
********************************************************************************/
function ufn_initParameters()
{
	//검색조건 Combo Initialize
	var codeArr = ["TAXK1",  "KVGR1","KVGR2", "2", "CS001_GBN", "LAND1", "7","CS003G","CSZTERM"];
    var dsObjArr = [ds_taxk1,  ds_kvgr1, ds_kvgr2, ds_bwtar_cd, ds_gbn, ds_land1,ds_qstat,ds_status,ds_zterm];
    var addTypeArr = [G_CODE_SELECT, G_CODE_NONE, G_CODE_NONE, G_CODE_SELECT, G_CODE_SELECT, G_CODE_SELECT, G_CODE_SELECT, G_CODE_SELECT, G_CODE_SELECT];
    gfn_searchCommCode(codeArr, dsObjArr, addTypeArr,true);
		

		
	if(length(ds_cond.GetColumn(0, "QTNUM")) > 0) 								//수정/삭제/조회를 위해 QTNUM이 넘어온 경우이므로 프로젝트 조회 및 데이터셋 설정 작업을 여기서 수행한다.
	{
		ufn_getOfferInfo();														//프로젝트정보 및 자재정보를 가져온다
	}
	else																		//견적을 신규생성해야하므로 데이터를 리셋한다.
	{		
		//제품구분선택 콤보 Initialize
	
		cb_spartnm.Index = 0;
		
		// 인도조건이 exw fob 의 경우 운임료 등록 안되도록 처리 
		cb_inco1.Index = 0;
		
		cb_transport.Index = 0;
		cb_requestco.Index = 1;
		cb_partialshipment.Index = 1;
		cb_transshipment.Index = 1;
		
		//청구구분 선택 콤보 Initialize
		cb_reqkind.Index = 0;
	
		cb_taxk1.Index = 0;
		cb_kvgr1.Index = 0;
		cb_kvgr2.Index = 0;
		cb_cs001gbn.Index = 0;
		cb_zterm.Index = 0;
		cb_seq.Index = 0;		
		
		//견적 관련 텍스트박스 클리어
		ed_qtnum.text = "";
		ed_pjt.text = "";
		ed_qtnam.text = "";
		
		//판매할인액,운임료 초기화
		ed_netwr_dc.Text = "0";
		ed_netwr_ship.Text = "0";
				
		//캘린더 클리어
		//cal_sodat.value = gfn_getLeapLastDay(gfn_getCurrDate());
		cal_qtrcdat.value = "";
		
		adm_cal_shdat.value = gfn_getAfterDate(gfn_getCurrDate(),61); // 납기일 현재일자 기준 2달 후 
		
		cal_bildat1.value = "";
		cal_bildat2.value = "";
		cal_bildat3.value = "";
		
		//각종 텍스트박스
		me_bilamt2.value = "";
		me_bilamt3.value = "";
		ed_remark.text = "";
				
		//권한을 설정한다.
		ufn_setPermissions();
	}
}

/********************************************************************************
* 기      능   : 선택된 견적 정보를 Retrieve (추가/수정/삭제 시)
********************************************************************************/
function ufn_getOfferInfo()
{
	ufn_resetAll();																//현재 견적사항을 리셋한다.
	
	fn_createWait("",this);														//처리중 윈도우 create
	grd_list.Redraw = false;													//Grid의 모든 컬럼이 다 채워진 후 refresh하기 위해 redrew를 false로 설정한다.

	tit_clearActionInfo();	
	tit_addSearchActionInfo("cs80:CS8001001B_S4", true);						//견적 마스터 정보
	tit_addSearchActionInfo("cs80:CS8001001B_S1", true);						//프로젝트 상세정보(호기명/호기id)
	tit_addSearchActionInfo("cs80:CS8001001B_S5", true);  						//견적 디테일 정보
	tit_addSearchActionInfo("cs80:CS8001001B_S6", true);  						//차수 정보
	tit_addSearchActionInfo("cs80:CS8001001B_S7", true); 	 					//호기선택 콤보박스용 호기정보
	tit_addSearchActionInfo("cs80:CS8001001B_S19", true); 	 					//보수자재청구상태, 2018.08.30 Han J.H

				
	tit_callService(	
        ""
        , ""
        , "ds_cond=ds_cond"
        , "ds_out_master=ds_out_master ds_pjt_det=ds_pjt_det ds_list=ds_list ds_seq=ds_seq ds_hna=ds_hna ds_031_cnt=ds_031_cnt"
        , ""
        , "fn_afterOfferInfoQuery"
        , true);
}

/********************************************************************************
* 기      능   : 선택된 견적정보 Retrieve Callback
********************************************************************************/
function fn_afterOfferInfoQuery()
{
	fn_destroyWait();															//처리중 윈도우 destroy
	grd_list.Redraw = true;														//Grid Redraw!!

	//만약 시스템 신규 제작 이전 데이터이면, 비어있는 컬럼들을 채운다.
	if(ds_Out_master.GetColumn(0, "UPN") == "")
	{
		//마스터 리스트의 값을 채운다.
		ds_out_master.SetColumn(0, "KUNNR",ds_pjt_det.GetColumn(0, "KUNNR"));					//고객번호
		ds_out_master.SetColumn(0, "SPT",ds_pjt_det.GetColumn(0, "SPT"));						//현장명
		ds_out_master.SetColumn(0, "CST",ds_pjt_det.GetColumn(0, "CST"));						//거래선
		ds_out_master.SetColumn(0, "CSTNM",ds_pjt_det.GetColumn(0, "CSTNM"));					//거래선명
		ds_out_master.SetColumn(0, "VKGRP", ds_pjt_det.GetColumn(0, "VKGRP"));					//팀
		ds_out_master.SetColumn(0, "VKBUR", ds_pjt_det.GetColumn(0, "VKBUR"));					//사업장
		ds_out_master.SetColumn(0, "BSU", ds_pjt_det.GetColumn(0, "BSU"));						//업체코드
		ds_out_master.SetColumn(0, "BSUNM", ds_pjt_det.GetColumn(0, "BSUNM"));					//업체명
		ds_out_master.SetColumn(0, "PNAME", ds_pjt_det.GetColumn(0, "PNAME"));					//담당자명
		ds_out_master.SetColumn(0, "LIFNR", ds_pjt_det.GetColumn(0, "LIFNR"));					//공급업체
		ds_out_master.SetColumn(0, "SH_ADDR", ds_pjt_det.GetColumn(0, "ADDR"));					//납품처주소
		ds_out_master.SetColumn(0, "UPN", ds_pjt_det.GetColumn(0, "UPN"));						//프로젝트번호
		ds_out_master.SetColumn(0, "VKBUR", ds_pjt_det.GetColumn(0, "VKBUR"));					//사업장	
		ds_out_master.SetColumn(0, "RATE", ds_pjt_det.GetColumn(0, "RATE"));					//임율	
		ds_out_master.SetColumn(0, "LAND1", ds_pjt_det.GetColumn(0, "REGIO"));					//국가정보 
		//TRACE(ds_pjt_det.SaveXML());
		//자재리스트의 값을 채운다.	
		var nHRow = 0;
		for(var iCnt=0;iCnt < ds_list.rowcount;iCnt++)
		{
			nHRow = ds_hna.SearchRow("WBS=\"" +  ds_list.GetColumn(iCnt, "HNO") + "\"");
			ds_list.SetColumn(iCnt, "HNA", ds_hna.GetColumn(nHRow, "HNA"));
		}
		
		//이후 필요에 따라 다른 작업을 수행한다.	
	}
	

	
	//판매할인액 %를 계산한다. 
	ed_netwr_pct.text = ((toNumber(ed_sum_ofr.Value) - toNumber(ed_sum_std.Value)) / toNumber(ed_sum_std.Value)) * 100;
	
	
	var workStage = ds_out_master.GetColumn(0, "CHGBN");						//결재상태를 가져온다.

	if(ds_out_master.GetColumn(0, "ENDYN") == "Y") { //종료된 견적일 경우
		workStage = "99";
	}
	
	if(ds_out_master.GetColumn(0, "EMYN") == "Y") { // 긴급여부 값체크 후 세팅함. 2018.10.15 J.H Han
		chk_emyn.Value = '1';
	}

	fn_check_china();
	//권한을 설정한다.
	ufn_setPermissions();
	
	ufn_setStatus();
}
/********************************************************************************
* 기      능   : 중국 법인 경우 프로젝트 판매 요율 적용을 위한 체크 
********************************************************************************/
function fn_check_china() {
	if (cb_land1.value == "CN" && ed_cus.Text == "0000500000") {
		PjtOrderFlag = true;
	} else {
		PjtOrderFlag = false;
	}
}

/********************************************************************************
* 기      능   : 선택된 프로젝트의 기본정보를 Retrieve
********************************************************************************/
function ufn_getProjectInfo()
{	
	if(ed_pjt.value == "")
	{	//"프로젝트 정보가 올바르지 않습니다."
		gfn_showMsg("CI30017");
		ufn_resetAll();
		ufn_initParameters();
		return;
	}

	tit_clearActionInfo();
	
	tit_addSearchActionInfo("cs80:CS8001001B_S1");
	tit_addSearchActionInfo("cs80:CS8001001B_S7");

	tit_callService(
        ""
        , ""
        , "ds_cond=ds_cond"
        , "ds_pjt_det=ds_pjt_det ds_hna=ds_hna"
        , ""
        , "fn_afterProjectQuery"
        , true);		
	
}

/********************************************************************************
* 기      능   : 신규 프로젝트 조회 Callback  
********************************************************************************/
function fn_afterProjectQuery(errCode, errMsg) 
{	
	if(ds_pjt_det.count <= 0)
	{	//  "프로젝트 상세정보가 존재하지 않습니다."
		gfn_showAlert("CI30018");
		ed_pjt.text = "";
		ed_spt.text = "";
		ufn_resetAll();
		ufn_initParameters();
		return;		
	}

	if(length(ds_pjt_det.GetColumn(0, "KUNNR")) < 1)
	{	// "고객정보가 존재하지 않습니다."
		gfn_showAlert("CI30019");
		ed_pjt.text = "";
		ed_spt.text = "";
		ufn_resetAll();
		ufn_initParameters();
		return;		
	}
	
	if(ds_hna.rowcount < 1)
	{	//"호기정보가 존재하지 않습니다."
		gfn_showAlert("CI30020");
		ed_pjt.text = "";
		ed_spt.text = "";
		ufn_resetAll();
		ufn_initParameters();
		return;
	}


	//화면 상단 처리
	ds_out_master.SetColumn(0, "FLAG", "I");									//저장플래그 "I"
	ds_out_master.SetColumn(0, "KUNNR",ds_pjt_det.GetColumn(0, "KUNNR"));		//고객번호
	ds_out_master.SetColumn(0, "SPT",ds_pjt_det.GetColumn(0, "SPT"));			//현장명
	ds_out_master.SetColumn(0, "CST",ds_pjt_det.GetColumn(0, "CST"));			//거래선
	ds_out_master.SetColumn(0, "CSTNM",ds_pjt_det.GetColumn(0, "CSTNM"));		//거래선명
	ds_out_master.SetColumn(0, "VKGRP", ds_pjt_det.GetColumn(0, "VKGRP"));		//팀
	ds_out_master.SetColumn(0, "VKBUR", ds_pjt_det.GetColumn(0, "VKBUR"));		//사업장
	ds_out_master.SetColumn(0, "BSU", ds_pjt_det.GetColumn(0, "BSU"));			//업체코드
	ds_out_master.SetColumn(0, "BSUNM", ds_pjt_det.GetColumn(0, "BSUNM"));		//업체명
	ds_out_master.SetColumn(0, "PNAME", ds_pjt_det.GetColumn(0, "PNAME"));		//담당자명
	ds_out_master.SetColumn(0, "PERNR", ds_pjt_det.GetColumn(0, "PERNR"));		//영업사원
	ds_out_master.SetColumn(0, "LIFNR", ds_pjt_det.GetColumn(0, "LIFNR"));		//공급업체
	ds_out_master.SetColumn(0, "SH_ADDR", ds_pjt_det.GetColumn(0, "ADDR"));		//납품처주소
	ds_out_master.SetColumn(0, "UPN", ds_pjt_det.GetColumn(0, "UPN"));			//프로젝트번호
	ds_out_master.SetColumn(0, "VKBUR", ds_pjt_det.GetColumn(0, "VKBUR"));		//사업장
	ds_out_master.SetColumn(0, "RATE", ds_pjt_det.GetColumn(0, "RATE"));		//당해년도 임율	
	ds_out_master.SetColumn(0, "FAILYN", ds_pjt_det.GetColumn(0, "FAILYN"));	//실패현장여부
	ds_out_master.SetColumn(0, "CRNAME", G_USER_NAME);							//작성자이름
	ds_out_master.SetColumn(0, "LAND1", ds_pjt_det.GetColumn(0, "REGIO"));	    //국가 정보 
	ds_out_master.SetColumn(0, "WAERS", ds_pjt_det.GetColumn(0, "WAERS"));                               //국가 정보 
	ds_out_master.SetColumn(0, "TO_1", ds_pjt_det.GetColumn(0, "TO_1"));	//
	ds_out_master.SetColumn(0, "TO_2", ds_pjt_det.GetColumn(0, "TO_2"));	//
	ds_out_master.SetColumn(0, "TO_3", ds_pjt_det.GetColumn(0, "TO_3"));	//
	ds_out_master.SetColumn(0, "TO_4", ds_pjt_det.GetColumn(0, "TO_4"));	//
	ds_out_master.SetColumn(0, "TO_5", ds_pjt_det.GetColumn(0, "TO_5"));	//
	ds_out_master.SetColumn(0, "SHIPTO", ds_pjt_det.GetColumn(0, "SHIPTO"));	//

	//화면 하단 처리

	ds_out_master.SetColumn(0, "REQNO", "");									//데이터셋 내부 컬럼 처리-청구번호
	ds_out_master.SetColumn(0, "QSTAT", "0");									//데이터셋 내부 컬럼 처리-청구상태

	gfn_showSearchMsg(grd_list);												// 메시지 처리 
	
	fn_check_china();

}

/********************************************************************************
* 기      능   : grd_list_OnExpandUp의 자재검색팝업(2)에서 자재코드로 자재상세정보 검색 완료 시
********************************************************************************/
function ufn_setMatnr()
{


	if (ds_ma_list.rowcount > 0)
	{
	    ds_list.fireevent = false;		//데이터리스트의 이벤트를 disable한다.
	    
	    if (ds_ma_list.GetColumn(0,"LVORM") == 'X')
	    {
	   		gfn_showAlert("CI30001", "삭제 표기된 자재번호 입니다. 확인하십시요.");
	   		ds_ma_list.clearData();
			return;
     	}

     	nRow = ds_ma_cond.GetColumn(0,"NROW");
     	
		ufn_clearDsList(nRow);

		ds_list.SetColumn(nRow,"MATNR",ds_ma_list.GetColumn(0,"MATNR"));		//자재번호
		ds_list.SetColumn(nRow,"MAKTX",ds_ma_list.GetColumn(0,"MAKTX")); 		//자재내역
		ds_list.SetColumn(nRow,"JOBHOUR",ds_ma_list.GetColumn(0,"JOBHOUR"));	//작업시간
		ds_list.SetColumn(nRow,"MAN",ds_ma_list.GetColumn(0,"MAN"));			//투입인원
		ds_list.SetColumn(nRow,"MTART",ds_ma_list.GetColumn(0,"MTART")); 		//자재유형
		ds_list.SetColumn(nRow,"GEWEI",ds_ma_list.GetColumn(0,"GEWEI")); 		//기본단위
		ds_list.SetColumn(nRow,"MEINS",ds_ma_list.GetColumn(0,"MEINS")); 		//자재단위
		
		ds_list.SetColumn(nRow,"NETPR_ORG",ds_ma_list.GetColumn(0,"SAMT1")); 	//판매단가
		ds_list.SetColumn(nRow,"UCOST",ds_ma_list.GetColumn(0,"UCOST")); 		//원가
		ds_list.SetColumn(nRow,"UCOSTA",ds_ma_list.GetColumn(0,"SAMT2")); 		// 단위 원가 원화
		ds_list.SetColumn(nRow,"UCOSTR",ds_ma_list.GetColumn(0,"UCOST")); 		// 단위 원가 통화
		
		ds_list.SetColumn(nRow,"RGBN",ds_ma_list.GetColumn(0,"RGBN")); 			//청구유형(1:보수/2:BOM)
		ds_list.SetColumn(nRow,"RGBNNM",ds_ma_list.GetColumn(0,"RGBNNM"));		//청구유형명
		ds_list.SetColumn(nRow,"BANNAB",ds_ma_list.GetColumn(0,"BANNAB")); 		//반납자재여부
		ds_list.SetColumn(nRow,"SPEC",ds_ma_list.GetColumn(0,"SPEC")); 			//제품SPEC
		ds_list.SetColumn(nRow,"MATNRNM",ds_ma_list.GetColumn(0,"MATNRNM")); 	//제품명
		ds_list.SetColumn(nRow,"WEBAZ",ds_ma_list.GetColumn(0,"WEBAZ")); 		//LEADTIME
		ds_list.SetColumn(nRow,"MRRAT",ds_ma_list.GetColumn(0,"MRRAT")); 			//
		ds_list.SetColumn(nRow,"MRGUBUN",ds_ma_list.GetColumn(0,"MRGUBUN")); 		//
		ds_list.SetColumn(nRow,"MAT_CODE",ds_ma_list.GetColumn(0,"MAT_CODE")); 		//
		ds_list.SetColumn(nRow,"KRWUSD",ds_ma_list.GetColumn(0,"KRWUSD")); 		//
		ds_list.SetColumn(nRow,"KRWEUR",ds_ma_list.GetColumn(0,"KRWEUR")); 		//
		ds_list.SetColumn(nRow,"WAERS",ds_out_master.GetColumn(0,"WAERS"));


		if(ds_ma_list.GetColumn(0,"RGBN") == "2") 								//BOM자재이면 아래 값들을 기본값으로 넣어준다(Insert시 error방지)
		{
			ds_list.SetColumn(nRow, "BANNAB", "");								//반납자재여부(미반납)
			ds_list.SetColumn(nRow, "GEWEI", "");								//기본단위
			ds_list.SetColumn(nRow, "UCOSTA", "0");								//수리품원가
			ds_list.SetColumn(nRow, "UCOSTR", "0");								//수리품원가
			ds_list.SetColumn(nRow,"UPR", "0"); 								//원가인상율
		}

		if ( parseInt(ds_list.GetColumn(nRow,"MENGE")) < 1)						//기초수량을 1로 세팅한다.
		{
			ds_list.SetColumn(nRow,"MENGE",1);
		}

		ds_list.SetColumn(nRow, "ZGUBN", "");									//직영재고 Index를 초기화한다.

		//xkwh:인건비 및 자재비 합계 계산을 위해 견적공수에 표준공수를 대입
		
		if(ds_ma_list.GetColumn(0,"JOBHOUR") == ""){
			ds_list.SetColumn(nRow,"OFRHOUR",0);
			ds_list.SetColumn(nRow,"JOBHOUR",0);
		} else {
			ds_list.SetColumn(nRow,"OFRHOUR",ds_ma_list.GetColumn(0,"JOBHOUR"));	//작업시간
		}
		if(ds_ma_list.GetColumn(0,"UPR") == ""){
			ds_list.SetColumn(nRow,"UPR",0);
		} else {
			ds_list.SetColumn(nRow,"UPR",ds_ma_list.GetColumn(0,"UPR"));	// 인상율 
		}



		//xkwh:수량*단가=합계를 계산한다.
		//소수점 두자리 이하 버림 처리 ************************************************************************************
		ds_list.SetColumn(nRow, "NETWR",  Truncate(ds_list.GetColumn(nRow, "MENGE") * ds_list.GetColumn(nRow, "NETPR"),2));
		ds_list.SetColumn(nRow, "AMOUNT", Truncate(ds_list.GetColumn(nRow, "MENGE") * ds_list.GetColumn(nRow, "NETPR"),2));
		

		// 최초 입력시 평가유형 초기값 입력
		if (length(ds_list.GetColumn(nRow,"BWTAR")) < 1) {
			if(ds_list.GetColumn(nRow, "MTART") == "PALB"){
				ds_list.SetColumn(nRow,"BWTAR","PA");
			} else if(ds_list.GetColumn(nRow, "MTART") == "HALB") {
				ds_list.SetColumn(nRow,"BWTAR","HA");
			} else {
				ds_list.SetColumn(nRow,"BWTAR","RA");
			}
		}

		//평가유형별 판매가 변경
		// if(SubStr(ds_list.GetColumn(nRow, "BWTAR"),1) == "B"){
			// ds_list.SetColumn(nRow,"NETPR",ds_ma_list.GetColumn(0,"SAMT1")*0.4); 
		// } else if (SubStr(ds_list.GetColumn(nRow, "BWTAR"),1) == "A") {
			// ds_list.SetColumn(nRow,"NETPR", ds_ma_list.GetColumn(0,"SAMT1")); 
		// } else {
			// ds_list.SetColumn(nRow,"NETPR", "0"); 
		//}
		ds_list.SetColumn(nRow,"NETPR", ds_ma_list.GetColumn(0,"SAMT1")); 
		
		
		ufn_calcListValues(nRow);												//xkwh:각종 계산식을 업데이트 한다.	
		ufn_calcCostValues("ufn_setMatnr");										//xkwh:청구구분에 따른 계산값을 다시 계산한다.
		ds_list.fireevent = true;												//데이터리스트의 이벤트를 enable한다.
		//trace(ds_list.SaveXML());
	}
	else
	{
		ds_list.fireevent = false;	
		ds_list.SetColumn(ds_ma_cond.GetColumn(0,"NROW"), "MATNR", "");
		ds_list.fireevent = true;
	}
}

/********************************************************************************
* 기      능   : 메인 리스트의 내용을 클리어
********************************************************************************/
function ufn_clearDsList(nRow)
{
	if (ds_list.rowcount > 0)
	{
		ds_list.SetColumn(nRow,"MATNR",""); 									//자재번호
		ds_list.SetColumn(nRow,"MAKTX",""); 									//자재번호
		ds_list.SetColumn(nRow,"MATNRNM","");									//자재명
		ds_list.SetColumn(nRow,"JOBHOUR",""); 									//표준공수
		ds_list.SetColumn(nRow,"MAN",""); 										//투입인원
		ds_list.SetColumn(nRow,"MTART",""); 									//자재유형
		ds_list.SetColumn(nRow,"GEWEI",""); 									//자재단위
		ds_list.SetColumn(nRow,"MEINS",""); 									//기본단위
		ds_list.SetColumn(nRow,"MENGE",""); 									//수량
		ds_list.SetColumn(nRow,"OFRHOUR",""); 									//견적공수
		ds_list.SetColumn(nRow,"NETWR",""); 									//판매금액
		
		ds_list.SetColumn(nRow,"BWTAR","");										//평가유형
		ds_list.SetColumn(nRow,"NETPR","");										//판매단가
		ds_list.SetColumn(nRow,"UCOSTA",""); 									//정품원가
		ds_list.SetColumn(nRow,"UCOSTR",""); 									//수리품원가
		ds_list.SetColumn(nRow,"UPR",""); 										//원가인상율
		ds_list.SetColumn(nRow,"WEBAZ","");										//LEADTIME
	}
}

/********************************************************************************
* 기      능   : 비용 및 원가 내역을 산정
********************************************************************************/
function ufn_calcCostValues(callerId)
{
	if(ds_list.count <= 0)														//데이터가 입력되어있지 않으면 계산하지 않는다.
	{
		return;
	}	

	if(cb_reqkind.value = "")													//청구구분을 선택해야 판가할인액 적용이 가능
	{
		if(callerId.length > 0 )
		{
			gfn_showAlert("CI30001", "청구구분을 선택해주세요." + "\n" + "Caller:" + callerId);
		}
		else
		{
			gfn_showAlert("CI30001", "청구구분을 선택해주세요.");
		}
		return;
	}

	ds_list.fireevent = false;
	
	//변수를 선언한다.
	
	var netwr_std, netwr_ofr, netwr_dc, netwr_ship;								//자재판매가(표준), 자재판매가(견적), 판매가할인액, 운임
	var netwr_pct;																//판매할인율
	var sum_std, sum_ofr;														//합계(표준), 합계(견적)
	var id_rate;																//증감율


	//----------------------------------------------------------------------
	//기초 금액을 산출한다.
	for(iCnt=0;iCnt < ds_list.Count;iCnt++)										
	{	//TRACE("iCnt  "+ iCnt + " ;; " + ds_list.getColumn(iCnt, "NETWR"));
		netwr_std += ds_list.getColumn(iCnt, "NETWR"); // 표준
		netwr_ofr += ds_list.getColumn(iCnt, "NETWR"); // 견적 
	}
	
	//----------------------------------------------------------------------
	//판매할인액
	netwr_dc = toNumber(ed_netwr_dc.Value);									

	//견적금액 자재판매가에 판가할인액을 적용한다 
	netwr_ofr -= netwr_dc;	
	
	//----------------------------------------------------------------------
	//운임 
	netwr_ship = toNumber(ed_netwr_ship.Value);									

	//견적금액 자재판매가에 판가할인액을 적용한다 
	netwr_ofr += netwr_ship;	
	
	//합계를 산정한다.
	sum_std = netwr_std ;
	sum_ofr = netwr_ofr ;
	
	//판매할인율을 계산한다.
	netwr_pct = round(((sum_ofr - sum_std) / sum_std) * 100, 1);	
	

	//증감율을 계산한다.
	id_rate = round(((sum_ofr - sum_std) / sum_std) * 100, 1);
	
	
	//값을 텍스트박스에 채워넣는다.
	ed_netwr_std.text = netwr_std;												//자재판매가(표준)
	ed_netwr_ofr.text = netwr_ofr;												//자재판매가(견적)
	ed_sum_std.text = sum_std;													//합계(표준)
	ed_sum_ofr.text = sum_ofr;													//합계(견적)
	ed_id_rate.text = id_rate;													//증감율
	ed_netwr_pct.text = netwr_pct;  											//판매할인율
	
	//----------------------------------------------------------------------
	//재료비(자재원가합계)를 계산한다.
	var ucost_sum = 0;
	
	for(iCnt=0;iCnt < ds_list.Count;iCnt++)
	{
		ucost_sum += toNumber(ds_list.getColumn(iCnt, "UCOST"));
	}

	//----------------------------------------------------------------------
	//원가내역을 계산한다.
	//	인건비	, 	일반노무비,	일식외주,  	운반비		직접비계		간접비		총원가			원가율
	var ch_lcost, ch_labor  ,ch_log  ,ch_inspec  ,ch_etc ; // 추가 입력항목
	var his_lcost, 	his_labor, 	his_oem, 	his_log, 	his_dirsum, 	his_indsum, his_totcost, 	his_his_rate;	
	var his_inspec, his_etc;
	
	// 추가금액 셋팅
	var his_ucost_add  = 0 ;
	var his_log_add    = netwr_ship ;
	// 추가금액 적용 원가산출 
	var add_cal_cost_add = gfn_calculate_cost_zc01( ucost_sum // 재료비 
	                                         , sum_ofr   // 견적가
	                                         , netwr_ofr // 자재 판매가 
	                                         , his_ucost_add // 추가 재료비 
	                                         , his_log_add // 운임 
											 ); 
	var his_final_list = split(add_cal_cost_add, "^", true);
	
	ds_out_master.SetColumn(0, "HIS_UCOST_FN"   , his_final_list[0]) ;  
	ds_out_master.SetColumn(0, "HIS_LOG_FN"     , his_final_list[1]) ; 
	ds_out_master.SetColumn(0, "HIS_DIRSUM_FN"  , his_final_list[2]) ; 
	ds_out_master.SetColumn(0, "HIS_INDSUM_FN"  , his_final_list[3]) ; 
	ds_out_master.SetColumn(0, "HIS_TOTCOST_FN" , his_final_list[4]) ; 
	ds_out_master.SetColumn(0, "HIS_RATE_FN"    , his_final_list[5]) ; 	
	
	//----------------------------------------------------------------------
	// 납기일 변경  최대 리드티임으로 설정
	var n_days = 0;
	var max_days = 0;
	for(iCnt=0;iCnt < ds_list.Count;iCnt++)										
	{
		if(iCnt==0) {
			n_days   = ds_list.getColumn(iCnt, "WEBAZ"); 
			max_days = ds_list.getColumn(iCnt, "WEBAZ"); 
		}
		n_days = ds_list.getColumn(iCnt, "WEBAZ"); 
		
		if(parseInt(max_days) <= parseInt(n_days)){
			max_days = n_days ;
		}

	}
	
	max_days = parseInt(max_days) + 1;
	adm_cal_shdat.Value = gfn_getAfterDate(gfn_getCurrDate(),max_days) ;

	//----------------------------------------------------------------------
	//계산서 발행금액을 설정한다.
	me_bilamt1.value = sum_ofr;
	cal_bildat2.value = "";
	me_bilamt2.value = 0;
	cal_bildat3.value = "";
	me_bilamt3.value = 0;
		
	//----------------------------------------------------------------------
	//자재별 최종견적가를 설정한다.
	ufn_setMatAmount();																
	
	ds_list.fireevent = true;
}
/********************************************************************************
* 기      능   : 버튼 컨트롤 
********************************************************************************/
function ufn_setStatus(){

	var rowCount = ds_031_cnt.GetColumn(0, "CNT"); // 2018.08.30 보수자재청구내역 체크

	var qtnumStatus = ds_out_master.GetColumn(0, "STATUS") ;

	if(lastFlag == false) return;
	
	ufn_setObjectVisibility("btn_print_ofr", true);	
	
	if(qtnumStatus == "A") {
		// 1. 견적생성 견적 저장 상태
		ufn_setObjectVisibility("btn_purchase_accept", false);
		ufn_setObjectVisibility("btn_purchase", true);	
	
		if(PjtOrderFlag && adminFlag == "40") {
			ufn_setObjectVisibility("btn_discount", true);				// 중국 프로젝트 판매 용 재계산 
			ufn_setObjectVisibility("btn_discount_new", true);			// 중국 프로젝트 판매 용 재계산 
		}
				
	} else if(qtnumStatus == "B") {
		if (adminFlag == "40" && rowCount < 1) { // 2018.08.30 관리자 그룹이라도 보수자재청구내역이 1건이상 존재시 주문수락 버튼 비활성화(해외서비스 정우성DL 요청)
			ufn_setObjectVisibility("btn_purchase_accept", true);
			//ufn_enableCommBtn("draft", true);										//기안 disable
		} else {
			ufn_setObjectVisibility("btn_purchase_accept", false);
			// 법인에서 주문 완료 한 이후에는 data 수정 불가
			// 관리자는 운임 등 견적 정보 수정 가능 
			ufn_disableAllInput();	
			ufn_enableCommBtn("close", true);

		}
		ufn_setObjectVisibility("btn_purchase", false);
		ufn_setObjectVisibility("btn_print_ofr", true);	
		ufn_setObjectVisibility("btn_print_po", true);
	
	}	else {
	
		ufn_setObjectVisibility("btn_purchase_accept", false);
		ufn_setObjectVisibility("btn_purchase", false);
		ufn_setObjectVisibility("btn_print_po", true);
	}

			ufn_setObjectVisibility("Button1", true);
}

/********************************************************************************
* 기      능   : ds_list의 값들을 계산한다.
********************************************************************************/
function ufn_calcListValues(nRow)
{
	ds_list.fireevent = false;

	//판매금액(수량*단가)을 계산한다.
	ds_list.SetColumn(nRow, "NETWR", ds_list.GetColumn(nRow, "MENGE") * ds_list.GetColumn(nRow, "NETPR"));
	
	//자재원가를 계산한다.
	var ucost = 0;
	var ucost_usd = 0;
	// TRACE("UCOST ::  " +ds_ma_list.GetColumn(0,"UCOST"));

	ucost     = toNumber(ds_list.GetColumn(nRow,"UCOSTR")) * toNumber(ds_list.GetColumn(nRow, "MENGE"));	//원가에 수량을 곱해준다(견적전체원가)

	ds_list.SetColumn(nRow, "UCOST", Truncate(ucost, 2));							//데이터리스트의 원가 컬럼에 원가를 설정한다.

	ds_list.fireevent = true;
}

/********************************************************************************
* 기      능   : 디버그 문자열을 trace로 출력한다.
********************************************************************************/
function DEBUG(srcFunc, outStr)
{
	var outputString = "";

    outputString = "DEBUG " + 
				  this.title + " " + 
				  substr(getDate(), 8, 2) + ":" + 
				  substr(getDate(), 10, 2) + ":" + 
				  substr(getDate(), 12, 2) + ">";
	
	if(DEBUG_FLAG)
	{
		if(outStr.length == 0)
		{	
			outputString += srcFunc;
		}
		else
		{
			outputString += srcFunc + "() - " + outStr;
		}
	
		trace(outputString);
	}
}

/********************************************************************************
* 기      능   : 원가관련 항목을 감춘다.
********************************************************************************/
function ufn_hideUnitCostComponents()
{
	var comps = Components;

	for(iCnt=0;iCnt < comps.count();iCnt++)
	{
		if(indexOf(comps[iCnt].ID, "st_adm") >= 0 || 
				indexOf(comps[iCnt].ID, "ed_netwr") >= 0 || 
				indexOf(comps[iCnt].ID, "adm_") >= 0)
		{
			comps[iCnt].visible = false;
		}
	}

	ed_netwr_ship.visible = true;
	// 견적 승인 버튼 관리자용 
	btn_purchase_accept.Visible = false ;

	//관리자 이외에는 원가 및 설정, 디버깅 관련 항목들을 볼 수 없도록 한다.
	for(var iCnt = 20; iCnt < grd_list.GetCellCount("BODY");iCnt++)
	{
		grd_list.SetCellProp("Head", iCnt, "Display", "null");						//20:자재원가
		grd_list.SetCellProp("Body", iCnt, "Display", "null");
		grd_list.ChangeColWidth("", iCnt, 0);
	}
}

/********************************************************************************
* 기      능   : enable 상태인 컴포넌트의 이름을 저장한다.
********************************************************************************/
function ufn_saveEnabledComponents()
{
	var comps = Components;														//form의 component collection 
	var compCnt = 0;															//갯수 카운트
	
	//컴포넌트 수 카운트
	for(iCnt=0;iCnt < comps.count();iCnt++)
	{
		if(comps[iCnt].GetType() == "MaskEdit" 
			|| comps[iCnt].GetType() == "Combo" 
			|| comps[iCnt].GetType() == "Checkbox"
			|| comps[iCnt].GetType() == "Edit" 
			|| comps[iCnt].GetType() == "Calendar" 
			|| comps[iCnt].GetType() == "TextArea"
			|| comps[iCnt].GetType() == "Radio")
		{
			if(comps[iCnt].Enable == true)
			{
				compCnt++;
			}
		}
	} 
	
	componentStore = Array(compCnt);
	
	compCnt = 0;
	
	//컴포넌트명 저장
	for(iCnt=0;iCnt < comps.count();iCnt++)
	{
		
		if(comps[iCnt].GetType() == "MaskEdit" 
				|| comps[iCnt].GetType() == "Combo" 
				|| comps[iCnt].GetType() == "Checkbox"
				|| comps[iCnt].GetType() == "Edit" 
				|| comps[iCnt].GetType() == "Calendar" 
				|| comps[iCnt].GetType() == "TextArea"
				|| comps[iCnt].GetType() == "Radio")
		{
			if(comps[iCnt].Enable == true)
			{
				componentStore[compCnt] = comps[iCnt].ID;
				compCnt++;
			}
		}
	} 
	return;
}

/********************************************************************************
* 기      능   : 초기에 Enable상태였던 컴포넌트들을 Restore한다.
********************************************************************************/
function ufn_restoreEnabledComponents()
{
	for(var iCnt = 0;iCnt < length(componentStore);iCnt++)						//컴포넌트 Enable상태 Restore	
	{
		object(componentStore[iCnt]).Enable = true;
	}
	
	grd_list.Editable = true;													//그리드 Editable 속성 Restore

	return;
}

/********************************************************************************
* 기      능   : 모든 입력 및 클릭이 가능한 컴포넌트를 Disable한다.
********************************************************************************/
function ufn_disableAllInput()
{
	ufn_enableGroup("MaskEdit", false);
	ufn_enableGroup("Combo", false);
	ufn_enableGroup("Checkbox", false);
	ufn_enableGroup("Edit", false);
	ufn_enableGroup("Calendar", false);
	ufn_enableGroup("TextArea", false);
	ufn_enableGroup("Radio", false);
	ufn_enableCommBtnGroup(false);
	ufn_setGroupVisiblity("Button", false);
	grd_list.Editable = false;	
}

/********************************************************************************
* 기      능   : 공통버튼을 모두 Enable/Disable한다.
********************************************************************************/
function ufn_enableCommBtnGroup(setFlag)
{
	comps = div_btn.Components["Button"];
	
	if(!IsValidObject(comps)) return;
	
	for(iCnt=0;iCnt < comps.count();iCnt++)
	{			
		comps[iCnt].Enable = setFlag;
	}
	return;
}

/********************************************************************************
* 기      능   : 공통버튼을 Enable/Disable 한다.
********************************************************************************/
function ufn_enableCommBtn(btnStr, setFlag)
{
	object("div_btn.btn_" + btnStr).Enable = setFlag;
	return;
}

/********************************************************************************
* 기      능   : 특정 컴포넌트 그룹을 Enable/Disable 한다.
********************************************************************************/
function ufn_enableGroup(componentGroup, setFlag)
{
	var comps;
	if(componentGroup == "")
	{
		comps = Components;
	}
	else
	{
		comps = Components[componentGroup];	
	}

	if(!IsValidObject(comps)) return;

	for(iCnt=0;iCnt < comps.count();iCnt++)
	{
		comps[iCnt].Enable = setFlag;
	} 
	
	return;
}

/********************************************************************************
* 기      능   : 특정 컴포넌트를 Enable/Disable 한다.
********************************************************************************/
function ufn_enableComponent(componentName, setFlag)
{
	if(IsValidObject(object(componentName)))
	{
		object(componentName).Enable = setFlag;	
	}
	else
	{	
		object("div_btn.btn_" + componentName).Enable = setFlag;
	}
	
	return;
}

/********************************************************************************
* 기      능   : 특정 컴포넌트 그룹을 show/hide 한다.
********************************************************************************/
function ufn_setGroupVisiblity(componentGroup, setFlag)
{
	var comps;
	if(componentGroup == "")
	{
		comps = Components;
	}
	else
	{
		comps = Components[componentGroup];	
	}

	if(!IsValidObject(comps)) return;

	for(iCnt=0;iCnt < comps.count();iCnt++)
	{
		comps[iCnt].Visible = setFlag;
	}

	return;
}


/********************************************************************************
* 기      능   : Object를 보이게 하거나 감춘다.
********************************************************************************/
function ufn_setObjectVisibility(btnStr, hideFlag)
{
	if(hideFlag == "hide" || hideFlag == false)
	{
		if(IsValidObject(object(btnStr)))
		{
			object(btnStr).visible = false;	
		}
		else
		{	
			object("div_btn.btn_" + btnStr).enable = false;
		}
	}
	else
	{
		if(IsValidObject(object(btnStr)))
		{
			object(btnStr).visible = true;	
		}
		else
		{	
			object("div_btn.btn_" + btnStr).enable = true;
		}
	}
}


/********************************************************************************
* 기      능   : 공통버튼을 보이게 하거나 감춘다.
********************************************************************************/
function ufn_setCommBtnVisibility(btnStr, hideFlag)
{
	if(hideFlag == "hide" || hideFlag == false)
	{
		object("div_btn.btn_" + btnStr).visible = false;
	}
	else
	{
		object("div_btn.btn_" + btnStr).visible = true;
	}
}

/********************************************************************************
* 기      능   : 이용권한을 설정한다.
********************************************************************************/
function ufn_setPermissions()
{
	//return;
	var userGroup = gfn_getUserGroup();											//사용자 권한그룹
	var docNo1, docNo2, docNo3, docNo4, docNo5;									//전자결재 문서번호(견적(1), 수주(2), 재청구(3), 수주변경(4), 수주취소(5))	
	
	var qtUserID, logUserID;													//견적 사용자 ID, 로그인 사용자 ID;
	var recostFlag;																//재견적 플래그
	var workStage;																//견적 현재 결재 상태
	var currentUser, currentFlag;									//현재 결재자, 사용자=차순위결재자일경우, 사용자 직영플래그 
	var draftUserID, draftFlag;													//기안자, 사용자=기안자플래그
	
	docNo1 = ds_out_master.GetColumn(0, "DOC1");								//견적결재문서번호
	docNo2 = ds_out_master.GetColumn(0, "DOC2");								//수주결재문서번호

	workStage = ds_out_master.GetColumn(0, "CHGBN");							//견적 현재 결재 상태

	if(ds_out_master.GetColumn(0, "ENDYN") == "Y") { 							//종료된 견적일 경우
		workStage = "99";
	}

	lastFlag = false;
	if(ds_out_master.GetColumn(0, "ASTAT") == "Y") { 		
		lastFlag = true;
	}

	recostFlag = false;															//재견적플래그를 Clear 한다.


	
	if(workStage == "")															//견적상태 재견적 플래그 세팅
	{
		recostFlag = true;													//재견적은 수주승인 상태가 되기 전이면 언제든 가능
	}
	else if(workStage == "0")													//청구상태 재견적 플레그 세팅
	{	
		recostFlag = true;
	}	
	else if(workStage == "1")													//수주변경
	{
		recostFlag = true; 			//수주변경반려(2, 5)일 경우 가능. 수주변경완료(6)시는 재청구 가능
	}
	else if(workStage == "2")													//수주취소
	{
		recostFlag = true;			//수주취소반려(2, 5)일 경우 가능.
	}
	else if(workStage == "3")													//재청구
	{
		recostFlag = true;								//재청구반려(2)시 가능. 재청구는 기안부서 전결이므로 수신부서반려(5)는 무시
	}
	

	ufn_restoreEnabledComponents();												//초기에 Enable 상태였던 모든 컴포넌트들을 Restore한다.
	
	ufn_enableCommBtnGroup(false);												//공통버튼을 모두 Disable 한다
//alert(workStage);
	/*-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=- 견적 종료 -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=--=-=-=-=-*/
	if(workStage == "99")														// 종료된 견적일 경우
	{
		ufn_disableAllInput();													//모든 입력을 disable한다. 버튼은 감춘다.
		ufn_enableCommBtn("draft", false);										//기안 disable
		ufn_enableCommBtn("close", true);										//닫기 enable
		ufn_setObjectVisibility("btn_print_ofr", false);						//견적서출력 disable
		ufn_setObjectVisibility("btn_copy_ofr", true);							//견적복사 enable
		ufn_enableComponent("cb_seq", false);									//차수선택 disable
		
	}

	/*-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=- 수주변경, 수주취소 단계 -=-=-=-=-=-=-=-=-=-=-=-=-=-=--=-=-=-=-*/
	//청구등록완료, 재청구, 수주변경, 수주취소 상태 -> 전송완료. 견적수정불가
	//if(docNo3.length > 0 || docNo4.length > 0 || docNo5.length > 0)			//수정불가. 버튼 enable가능.
	else if(isDigit(workStage))													//작업상태가 숫자면(ZCST001의 CHGBN : 0:청구등록완료/1:수주변경/2:수주취소/3:재청구) 수정불가. 버튼 enable가능.
	{ //alert("전송상태");
		ufn_disableAllInput();													//모든 입력을 disable한다. 버튼은 감춘다. 
		ufn_enableCommBtn("close", true);										//닫기 enable		
		ufn_enableCommBtn("approval", true);									//승인 enable		
		ufn_enableCommBtn("purchase_accept", true);									//승인 enable		
		ufn_setObjectVisibility("btn_purchase", false);								//승인 enable				
		ufn_setObjectVisibility("btn_print_ofr", true);							//견적서출력 enable
		ufn_setObjectVisibility("btn_copy_ofr", true);							//견적복사 enable
		ufn_enableComponent("cb_seq", true);									//차수선택 enable

	}

	/*-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=- 수주승인단계 -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-*/
	
	/*-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=- 견적작성/저장단계 -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-*/
	//견적작성 단계(기안 상신 이전 단계)
	else if(docNo1.length <= 0)
	{ 
		ufn_setGroupVisiblity("Button", false);									//버튼을 감춘다
		ufn_enableCommBtn("close", true);										//닫기 enable
		
		if(ds_out_master.GetColumn(0, "STATUS") < "C"){	
			selfFlag = true;
		}
		if(ds_out_master.GetColumn(0, "QTNUM").length > 0)						//저장된 견적이면
		{
			if(selfFlag)														//자신의 견적이면
			{
				ufn_enableCommBtn("delete", true);				//삭제 enable (업데이트 이전 견적은 삭제불가)
				ufn_enableCommBtn("save", true);								//저장 enable
				ufn_enableCommBtn("reset", true);								//리셋 enable
				ufn_enableCommBtn("recost", true);								//재견적 enable
				ufn_enableCommBtn("trans", true);								//전송 enable
				ufn_setObjectVisibility("bt_addMaterial", true);				//자재추가 enable
				ufn_setObjectVisibility("bt_removeMaterial", true);				//자재삭제 enable
				
				ufn_setObjectVisibility("btn_pjt", true);						//프로젝트검색 enable
			}
			else																//타인의 견적이면
			{
				ufn_disableAllInput();											//모든 입력을 disable한다. 버튼은 감춘다. 
			}	

			ufn_enableComponent("cb_seq", true);								//차수선택 enable
			ufn_setObjectVisibility("btn_copy_ofr", true);						//견적복사 enable		
			
		}
		else																	//신규 견적이면(저장 이전) - 차수선택 하지 않음
		{
			ufn_enableCommBtn("save", true);									//저장 enable
			ufn_enableCommBtn("reset", true);									//리셋 enable
			ufn_setObjectVisibility("bt_addMaterial", true);					//자재추가 enable
			ufn_setObjectVisibility("bt_removeMaterial", true);					//자재삭제 enable
			
			ufn_setObjectVisibility("btn_pjt", true);							//프로젝트검색 enable
		}		
		ufn_enableCommBtn("close", true);										//닫기 enable
	}
	/*-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=- 예외상황 발생시  -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-*/
	else
	{
		ufn_disableAllInput();													//모든 입력을 disable한다. 버튼은 감춘다. 
		ufn_enableCommBtn("close", true);										//닫기 enable		
	}	

	if(cb_seq.Value != ds_seq.max("CODE")) 										//최종차수가 아닌경우 단순 View만 가능하다. 
	{
		ufn_disableAllInput();													//모든 입력을 disable한다. 버튼은 감춘다. 
		ufn_enableCommBtn("close", true);										//닫기 enable		
		ufn_setObjectVisibility("btn_copy_ofr", true);							//견적복사 enable
		ufn_enableComponent("cb_seq", true);									//차수선택 enable
		return;
	}
	
	ta_remark.Enable = true;	
	ta_remark.readOnly = true;
	ta_remark.ToolTipText = "In case of trade term is not EXW/FOB, \n"
	                          + " 1. Save the inquiry\n"
	                          + " 2. Send detailed info by e-mail(inquiry no., trade term, destination port)\n"
	                          + " 3. Require freight cost.\n"
								;

}

//=========================================================================================
// [ PART 6 ]
// component Event 정의 : 각 Component 별 이벤트 
//=========================================================================================
/********************************************************************************
* 기      능   : 그리드 헤더 클릭시 정렬 처리 
********************************************************************************/
function grd_list_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
{
	if ( nCell == 0 ) {
		// 그리드 표시할 컬럼 선택 
		//gfn_selectGridCol(obj);
		ds_list.fireEvent = false;
		if(grd_list.Editable) gfn_selectAllGrid(obj,nCell,"CHK",true);
		ds_list.fireEvent = true;
	} else {
		// 그리드 정렬 처리 
		gfn_sortGrid(obj,nCell);
	}
}

/********************************************************************************
* 기      능   : 프로젝트 검색 버튼 클릭
********************************************************************************/
function btn_pjt_OnClick(obj){

	if(ds_list.rowcount > 0) {
		//"선택된 자재를 모두 삭제하신 후 변경 가능합니다."
		gfn_showAlert("CI30021");
		return;
	}

	var arg = "vkgrp=" + quote(G_SAP_USER_VGCD) + " cst=1";					//지사 사용자의 작업그룹별 필터링 조건, 거래선이 있는 것만 

	//var kunnr = gfn_openPopup("CS9601001A", true, arg);
	var kunnr = gfn_openPopup("CS8002003A", true, arg);
	
	
	//============고객에 대한 영업사원 지정이 없을경우 - 2018.10.26 추가============
	if( kunnr[6] == '')
	 {	
		gfn_showAlert("CI30001", "해당 고객의 정확한 담당자(영업사원)을  '해외 고객정보 현황' 에서 먼저 지정하여 주세요.");
		ed_pjt.value = '';
		ed_spt.value = '';
		return;
	 }
	//==============================================================================	


	if (kunnr != null) {
		if (kunnr[0] == null || length(kunnr[0]) < 3) {
			return;
		}
	
			
		if (kunnr[1] == null || length(kunnr[1]) < 3) {
			gfn_showAlert("CW00022","거래선");
			return;
		}
		
		ed_pjt.value = kunnr[0] + kunnr[1];
		ed_spt.value = kunnr[2];
		ds_cond.SetColumn(0, "UPN", kunnr[0]);
		ds_cond.SetColumn(0, "CST", kunnr[1]);		
	}
	else
	{
		return;
	}
	
	if(kunnr[5] == "X") {
		gfn_showAlert(kunnr[4] + " : 해외 고객정보 현황에서 등록해주세요.");
		ed_pjt.text = "";
		ed_spt.text = "";
		ufn_resetAll();
		ufn_initParameters();
		return;			
	}
	
    //견적 그리드를 클리어한다.
    //ds_list.clearData();
    
    //해당 프로젝트 번호로 나머지 정보를 가져온다.
    ufn_getProjectInfo();
}
/********************************************************************************
* 기      능   : 납기일 체크로직
********************************************************************************/
function check_Rdate(obj)
{
	var tmp_webaz = 0;
	var max_webaz = 0;
	var cal_date_fr, cal_date_to;
		
	for(var iCnt=0;iCnt<ds_list.rowcount;iCnt++)
	{
		tmp_webaz = ds_list.GetColumn(iCnt, "WEBAZ");
	
		if(parseInt(tmp_webaz) > parseInt(max_webaz)) {
			max_webaz = tmp_webaz;
		}
		if(tmp_webaz == "") tmp_webaz = 0;	
	}
	max_webaz = parseInt(max_webaz) + 1;
	//cal_date_to = gfn_getWorkingDate(max_webaz, '2000', gfn_getCurrDate());
	cal_date_to = gfn_getAfterDate(gfn_getCurrDate(), parseInt(max_webaz));
	if(adm_cal_shdat.Value < cal_date_to) {
		var arg = ToString(cal_date_to);
		adm_cal_shdat.Enable = true;
		//납기일은 자재의 LEADTIME을 계산하여 입력하시기 바랍니다.
		gfn_showAlert("CI30022", arg);
		return false;
	}
	return true;
}

/********************************************************************************
* 기      능   : 자재추가 버튼 클릭
********************************************************************************/
function bt_addMaterial_OnClick(obj)
{
	// 견적 요율 변경 시행 2018-05-01 
	var o_qtdat = ds_out_master.GetColumn(0,"QTDAT");
	if(o_qtdat < "20180508") {
		gfn_showAlert("2018-05-08 이전 작성된 견적은 수정이 불가능 합니다.");
		return;
	}

	if(ed_pjt.value.length <= 0)
	{	//"프로젝트를 선택해주세요."
		gfn_showAlert("CI30023");
		return;
	}

	ds_list.addRow();
	ds_list.SetColumn(ds_list.count - 1, "FLAG", "I");
	ds_list.SetColumn(ds_list.count - 1, "HNO", ds_hna.GetColumn(0,"WBS") );
	// 자재 특성치에 호기 WBS 기본 셋팅 
	ds_list.SetColumn(ds_list.count - 1, "CHAR1", ds_hna.GetColumn(0,"WBS")+", " );

}

/********************************************************************************
* 기      능   : 자재삭제 버튼 클릭
********************************************************************************/
function bt_removeMaterial_OnClick(obj)
{
	if(ds_list.count <= 0)
	{
		return;
	}

	if(ed_pjt.value.length <= 0)
	{
		gfn_showAlert("CI30001", "프로젝트를 선택해주세요.");
		return;
	}
	
	ds_cond_del.clearData();
	
	for(iCnt=ds_list.rowcount - 1;iCnt >= 0;iCnt--)
	{
		if(ds_list.getColumn(iCnt, "CHK") == 1)
		{
			//저장된 행일 경우 해당행을 삭제하기 위한 IN 조건을 구성한다.
			if(ds_list.GetColumn(iCnt, "FLAG") != "I" && length(ds_cond.GetColumn(0, "QTNUM")) > 0)
			{
				ds_cond_del.AddRow();
				ds_cond_del.SetColumn(ds_cond_del.rowcount - 1, "QTNUM", ds_cond.GetColumn(0, "QTNUM"));
				ds_cond_del.SetColumn(ds_cond_del.rowcount - 1, "SEQ", ds_cond.GetColumn(0, "SEQ"));
				ds_cond_del.SetColumn(ds_cond_del.rowcount - 1, "SEQNO", ds_list.GetColumn(iCnt, "SEQNO"));
			}
			
			ds_list.deleteRow(iCnt);
		}
	}

	if(ds_list.count == 0)
	{
		/** 2015.02.26 LJH : Header의 청구구분 활성화 **/
		cb_reqkind.Enable = true;
	
		
		/** 2015.02.26 LJH **/
	}

	
	//청구구분에 따른 계산값을 다시 계산한다.
	ufn_calcCostValues("bt_removeMaterial_OnClick");
	
	//DB에 저장된 행을 삭제한다.
	if(ds_cond_del.rowcount > 0)
	{
		tit_clearActionInfo();
		tit_addMultiActionInfo("cs80:CS8001001B_D2");
		tit_callService(
		"",
		"",
		"ds_cond=ds_cond_del",
		"",
		"",
		"fn_afterDeleteMaterial"
		);
	}		
}

/********************************************************************************
* 기      능   : 자재 삭제 콜백
********************************************************************************/
function fn_afterDeleteMaterial(errCode, errMsg) 
{
	if ( errCode!= 0 ) 
	{
		gfn_showAlert("CE00001");
	} 
	else 
	{
		ds_cond_del.clearData();
		gfn_showInform("CI00003");
	}
}

/********************************************************************************
* 기      능   : 자재 리스트 Expand Up 시
********************************************************************************/
function grd_list_OnExpandUp(obj,nRow,nCell,strVal,nPivotIndex)
{	
	if(ed_pjt.value.length <= 0)
	{
		gfn_showAlert("CI30001", "프로젝트를 선택해주세요.");
		return;
	}

	switch(nCell)
	{
		case 1: 																//호기번호
			break;
		case 4:																	//자재검색팝업
			var matType = ds_list.GetColumn(nRow, "RGBN");
			var arg = "";
			var targetQuery = "";
			var mat;

			if(ds_list.GetColumn(nRow, "HNO").length == 0)
			{
				gfn_showAlert("CI30001", "호기(WBS) 또는 호기명을 선택해주세요.");
				return;
			}

			if(cb_spartnm.Value == "" || length(cb_spartnm.Value) == 0)
			{
				gfn_showAlert("CI30001", "제품군을 선택해주세요.");
				return;
			}
			
			// ES, MW 팝업화면 변경 2016.10.21 YW 
			if(substr(ds_list.GetColumn(nRow, "HNO"),6,1) == "S" || substr(ds_list.GetColumn(nRow, "HNO"),6,1) == "W")
			{
				arg = "fa_hty=" + quote(ds_list.GetColumn(nRow, "HTY")) + " fa_hogin=" + quote(ds_list.GetColumn(nRow, "HNO"));
				mat = gfn_openPopup("MM0103004A",true, arg); 
				targetQuery = "cs80:CS8001001B_S10";
					
			} else {
				arg = "fa_hty=" + quote(ds_list.GetColumn(nRow, "HTY")) + " fa_hogin=" + quote(ds_list.GetColumn(nRow, "HNO"))
					    +" fa_lgort=" + quote(ds_out_master.GetColumn(0, "BSU"))
					    +" fa_waers=" + quote(ds_out_master.GetColumn(0, "WAERS"));
					mat = gfn_openPopup("CS9614002A",true, arg); 				
					targetQuery = "cs80:CS8001001B_S2";
			}

			if(mat == "NS-100" || mat == "ns-100")	 							//NS-100은 견적에는 추가불가하고 sap전송시에만 사용됨
			{
				gfn_showAlert("CI30001", "해당 자재는 직접 사용불가 자재입니다.");
				return;
			}

			if(cb_reqkind.Value <> "S" && (mat == "NC-100" || mat == "nc-100"))	//시스템공사는 NC-100만 사용
			{
				gfn_showAlert("CI30001", "NC-100은 시스템공사에만 입력가능합니다.");
				return;
			}

			if(cb_reqkind.Value == "S" && (mat == "NB-100" || mat == "nb-100"))	//시스템공사는 NC-100만 사용
			{
				gfn_showAlert("CI30001", "시스템공사는 NC-100만 입력가능합니다.");
				return;
			}

			if(mat.length <= 1)
			{
				return;
			}

			ds_list.SetColumn(nRow, "MATNR",mat);

			ds_ma_cond.SetColumn(0, "MATNR", mat);
			ds_ma_cond.SetColumn(0, "NROW", nRow);
			ds_ma_cond.SetColumn(0, "LGORT", ds_pjt_det.GetColumn(0, "BSU"));
			ds_ma_cond.SetColumn(0, "WAERS", ds_pjt_det.GetColumn(0, "WAERS"));
			ds_ma_cond.SetColumn(0, "SPART", cb_spartnm.Value);

			if (ds_list.GetColumn(nRow,"MATNR") == "0")
			{
				ds_list.SetColumn(nRow,"MATNR","");
			}
			else
			{
				tit_clearActionInfo();
				tit_addSearchActionInfo(targetQuery);
				tit_callService(
					""
					,""
					, "ds_ma_cond=ds_ma_cond"
					, "ds_ma_list=ds_ma_list"
					, ""
					, "ufn_setMatnr"
					, false
					, true);
			}

			break;
		default:
			break;
	}
}

/********************************************************************************
* 기      능   : 자재리스트의 컬럼 값 변경 시
********************************************************************************/
function ds_list_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{
	switch(strColumnID)
	{
		case "HNO":																//호기번호컬럼의 값이 변경되면, 호기명컬럼도 세팅해준다.
			ds_list.FireEvent = false;
			nHRow = ds_hna.SearchRow("WBS=\"" +  ds_list.GetColumn(nRow, "HNO") + "\"");
			ds_list.SetColumn(nRow, "HNA", ds_hna.GetColumn(nHRow, "HNA")); 	//ufn_clearDsList(nRow)
			ds_list.SetColumn(nRow, "HTY", ds_hna.GetColumn(nHRow, "HTY"));		//호기특성
			ds_list.SetColumn(nRow, "CHAR1", ds_hna.GetColumn(nHRow,"WBS")+", " );
			ds_list.FireEvent = true;
			break;
		case "HNA":																//호기명컬럼의 값이 변경되면, 호기번호컬럼도 세팅해준다.
			ds_list.FireEvent = false;
			nHRow = ds_hna.SearchRow("HNA=\"" +  ds_list.GetColumn(nRow, "HNA") + "\"");
			ds_list.SetColumn(nRow, "HNO", ds_hna.GetColumn(nHRow, "WBS"));
			ds_list.SetColumn(nRow, "HTY", ds_hna.GetColumn(nHRow, "HTY"));		//나중에 변경 불가 하도록 FILTERING할 것
			ds_list.FireEvent = true;
			break;
		case "RGBN":															//보수/BOM구분
			if(toNumber(varOldValue) > 0)										//신규입력이 아닌 경우에만 Clear
			{
				ufn_clearDsList(nRow);
			}
			
			ds_list.fireevent = false;
			
			//BOM타입으로 변경되었을 경우에는 업체재고소진 직영재고구분에 체크가 불가하도록(요구사항 62번)
			grd_list.SetCellProp("BODY", 18, "edit", "expr:decode(RGBN,2,'none','checkbox')");
			grd_list.SetCellProp("BODY", 19, "edit", "expr:decode(RGBN,2,'none','checkbox')");
			grd_list.SetCellProp("BODY", 18, "bkcolor", "expr:decode(RGBN,2,'white','user27')");
			grd_list.SetCellProp("BODY", 19, "bkcolor", "expr:decode(RGBN,2,'white','user27')");
			
			if(toNumber(varNewValue) == 2)										//BOM으로 변경되었을 경우 REQKIND 및 ZGUBN을 클리어한다.
			{
				ds_list.SetColumn(nRow, "REQKIND_CHK", "0");
				ds_list.SetColumn(nRow, "ZGUBN_CHK", "");
			}
			ds_list.SetColumn(nRow, "REQKIND", ds_out_master.GetColumn(0, "REQKIND"));
			ds_list.SetColumn(nRow, "ZGUBN", "");
			
			ds_list.fireevent = true;

			break;
		case "MATNR":
			var matType = ds_list.GetColumn(nRow, "RGBN");
			ds_list.fireevent = false;
			
			if(matType == "2")													//BOM자재일경우에는 직접입력은 의미가 없음
			{
				ds_list.SetColumn(nRow, "MATNR", "");
				ds_list.fireevent = true;
				return;
			}

			if(cb_spartnm.Value == "" || length(cb_spartnm.Value) == 0)
			{
				gfn_showAlert("CI30001", "제품군을 선택해주세요.");
				ds_list.fireevent = true;
				return;
			}

			if(ds_list.GetColumn(nRow, "HNO").length == 0)
			{
				gfn_showAlert("CI30001", "호기(WBS) 또는 호기명을 선택해주세요.");
				ds_list.SetColumn(nRow, "MATNR", "");
				ds_list.fireevent = true;
				return;
			}
			
			if(ds_list.GetColumn(nRow,"MATNR") == "NS-100" || ds_list.GetColumn(nRow,"MATNR") == "ns-100") 	//NS-100은 견적에는 추가불가하고 sap전송시에만 사용됨
			{
				ds_list.SetColumn(nRow, "MATNR", "");
				gfn_showAlert("CI30001", "해당 자재는 직접 사용불가 자재입니다.");
				ds_list.fireevent = true;
				return;
			}

			if(cb_reqkind.Value <> "S" && (ds_list.GetColumn(nRow,"MATNR") == "NC-100" || ds_list.GetColumn(nRow,"MATNR") == "nc-100"))	//시스템공사는 NC-100만 사용
			{
				ds_list.SetColumn(nRow, "MATNR", "");
				gfn_showAlert("CI30001", "NC-100은 시스템공사에만 입력가능합니다.");
				ds_list.fireevent = true;
				return;
			}

			if(cb_reqkind.Value == "S" && (ds_list.GetColumn(nRow,"MATNR") == "NB-100" || ds_list.GetColumn(nRow,"MATNR") == "nb-100"))	//시스템공사는 NC-100만 사용
			{
				ds_list.SetColumn(nRow, "MATNR", "");
				gfn_showAlert("CI30001", "시스템공사는 NC-100만 입력가능합니다.");
				ds_list.fireevent = true;
				return;
			}

			if(length(ds_list.GetColumn(nRow, "MATNR")) > 0)					//입력된 자재번호로 Query
			{
				ds_ma_cond.SetColumn(0, "MATNR", ToUpper(ds_list.Getcolumn(nRow, "MATNR")));
				ds_ma_cond.SetColumn(0, "NROW", nRow);
				ds_ma_cond.SetColumn(0, "LGORT", ds_pjt_det.GetColumn(0, "BSU"));
				ds_ma_cond.SetColumn(0, "WAERS", ds_pjt_det.GetColumn(0, "WAERS"));
				ds_ma_cond.SetColumn(0, "SPART", cb_spartnm.Value);
			//TRACE(ds_ma_cond.SaveXML());
				tit_clearActionInfo();
				tit_addSearchActionInfo("cs80:CS8001001B_S2");
				tit_callService("","", "ds_ma_cond=ds_ma_cond", "ds_ma_list=ds_ma_list", "", "ufn_setMatnr", false, true);
			}
			ds_list.fireevent = true;
			break;
		case "BWTAR":															//자재유형
			//논리적 오류로 평가유형 선택 후 다른 ROW로 이동 시 해당 ROW의 평가유형이 바뀌는 문제를 해결하기 위해 for문 추가
			for(var iCnt=0;iCnt < ds_list.rowcount;iCnt++)
			{
				ds_list.SetColumn(iCnt, "BWTAR", substr(ds_list.GetColumn(iCnt, "MTART"), 0, 1) + substr(ds_list.GetColumn(iCnt, "BWTAR"), 1));
			}

			if(substr(ds_list.GetColumn(nRow, "BWTAR"), 1, 1) == "A")
			{
				ds_list.SetColumn(nRow, "NETPR", ds_list.GetColumn(nRow, "NETPR_ORG"));
			}
			else if(substr(ds_list.GetColumn(nRow, "BWTAR"), 1, 1) == "B")			
			{
				ds_list.SetColumn(nRow, "NETPR", round(toNumber(ds_list.GetColumn(nRow, "NETPR_ORG")) * 0.4, 0));
			}
			else
			{
				ds_list.SetColumn(nRow, "NETPR", "0");
			}
		case "NETPR":
		case "MENGE":															//수량
		case "OFRHOUR":															//견적공수
			ds_list.FireEvent = false;
			ufn_calcListValues(nRow);											//각종 계산식을 업데이트 한다.
			ds_list.FireEvent = true;
			ufn_calcCostValues("ds_list_OnColumnChanged");
			break;
		case "ZGUBN_CHK": 														//직영구분체크
			if(ds_list.GetColumn(nRow, "ZGUBN_CHK") == "1")
			{
				ds_list.SetColumn(nRow, "ZGUBN", "Y");
			}
			else
			{
				ds_list.SetColumn(nRow, "ZGUBN", "");
			}
			////DEBUG("ds_list_OnColumnChanged", "ZGUBN_CHK:" + ds_list.GetColumn(nRow, "ZGUBN_CHK") + "/ZGUBN:" + ds_list.GetColumn(nRow, "ZGUBN"));
			break;		
		default:
			break;
	}
}

/********************************************************************************
* 기      능   : 청구구분이 바뀔 경우
********************************************************************************/
function cb_reqkind_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	//인덱스가 같으므로 변화가 없음
	if(nOldIndex == nNewIndex)
	{
		return;
	}
	
	if(strCode =="")
	{
		gfn_showAlert("CI30001", "청구구분을 선택해주세요.");
		return;
	}
	//청구구분에 따른 계산값을 다시 계산한다.
	ufn_calcCostValues("cb_reqkind_OnChanged");
}

/********************************************************************************
* 기      능   : 판가할인액이 변경될 경우
********************************************************************************/
function ed_netwr_dc_OnChanged(obj,strText)
{
	//할인액 적용에 따른 계산값을 다시 계산한다.
	ufn_calcCostValues("ed_netwr_dc_OnChanged");	
}





/********************************************************************************
* 기      능   : 견적구분 체크박스의 값이 변경될 경우
********************************************************************************/
function cb_cs001gbn_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{

}

/********************************************************************************
* 기      능   : 계산서발행금액 2가 변경될 경우
********************************************************************************/
function me_bilamt2_OnChanged(obj,strText)
{
/*		me_bilamt1.value = ed_sum_ofr.Value;
		cal_bildat2.value = "";
		me_bilamt2.value = 0;
		cal_bildat3.value = "";
		me_bilamt3.value = 0;
*/
	me_bilamt1.value = toNumber(ed_sum_ofr.Value) - (toNumber(me_bilamt2.value) + toNumber(me_bilamt3.value));
}

/********************************************************************************
* 기      능   : 계산서 발행금액 3이 변경될 경우
********************************************************************************/
function me_bilamt3_OnChanged(obj,strText)
{
	me_bilamt1.value = toNumber(ed_sum_ofr.Value) - (toNumber(me_bilamt2.value) + toNumber(me_bilamt3.value));	
}

/********************************************************************************
* 기      능   : 자재리스트 클릭 시 해당 행의 평가유형별 필터링 정보를 세팅한다.
********************************************************************************/
function grd_list_OnCellClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
	switch(nCell)
	{
		case 6:																	//평가유형
		
			//논리적 오류로 평가유형 선택 후 다른 ROW로 이동 시 해당 ROW의 평가유형이 바뀌는 문제를 해결하기 위해 for문 추가
			for(var iCnt=0;iCnt < ds_list.rowcount;iCnt++)					
			{
				ds_list.SetColumn(iCnt, "BWTAR", substr(ds_list.GetColumn(iCnt, "MTART"), 0, 1) + substr(ds_list.GetColumn(iCnt, "BWTAR"), 1));
			}
			//평가유형별 필터링정보를 설정한다.
			if(ds_list.GetColumn(nRow, "MTART") == "PALB")
			{
				if(ds_list.GetColumn(nRow, "BANNAB") == "0")					//반납대상자재가 아닐경우
				{
					ds_bwtar_cd.Filter(" CODE>=" +quote("PA") +"&&CODE<" +quote("PR") + "&&CODE!="+quote("PB"));  //반납품제외 16.08.01 이동진dl요청
				}
				else															//반납대상자재일경우
				{
					ds_bwtar_cd.Filter(" CODE>=" +quote("PA") + "&&CODE!="+quote("PR"));
				}
			} 
			else if(ds_list.GetColumn(nRow, "MTART") == "HALB") 
			{
			
				if(ds_list.GetColumn(nRow, "BANNAB") == "0")					//반납대상자재가 아닐경우
				{
					ds_bwtar_cd.Filter(" CODE>=" +quote("HA") +"&&CODE<" +quote("HR") + "&&CODE!="+quote("HB"));
				}
				else															//반납대상자재일경우
				{
					ds_bwtar_cd.Filter(" CODE>=" +quote("HA") + "&&CODE!="+quote("HR"));
				}			
			} 
			else 
			{
				if(ds_list.GetColumn(nRow, "BANNAB") == "0")					//반납대상자재가 아닐경우
				{
					ds_bwtar_cd.Filter(" CODE>=" +quote("RA") +"&&CODE<" +quote("RR") + "&&CODE!="+quote("RB"));
				}
				else															//반납대상자재일경우
				{
					ds_bwtar_cd.Filter(" CODE>=" +quote("RA") + "&&CODE!="+quote("RR"));
				}	
			}	
			break;
		default:
			break;
	}
}

/********************************************************************************
* 기      능   : 견적복사기능을 수행한다.
********************************************************************************/
function btn_copy_offer_OnClick(obj)
{
	if(ds_out_master.GetColumn(0, "FLAG") == "I")
	{	//"저장되지 않은 견적입니다."
		gfn_showAlert("CI30025"); 
		return;
	}
	//"현재 견적을 복사하여 새로운 견적을 생성하시겠습니까?"
	if(!gfn_showConfirm("CI30024"))
	{
		return;
	}
		
	
	//이후 계산에 필요한 부분은 남겨둔다.
	var tmpReqkind = cb_reqkind.value;											//청구구분
	
	//ds_out_master.fireevent = false;
	
	//계산에 필요한 부분을 초기화 한다(초기화 하지 않으면 이후 ufn_initParameters의 ufn_calcCostValues 호출 시 Warning 발생)
	
	//ed_netwr_dc.value = "";														//판매할인액
	
	//복사를 위해 ds_out_master의 값을 삭제한다.
	ds_out_master.SetColumn(0, "FLAG", "I");									//저장플래그 "I"
	//ds_out_master.SetColumn(0, "SODAT",gfn_getCurrDate() );
	ds_out_master.SetColumn(0, "QTRCDAT",gfn_getCurrDate() );						//견적접수일
	// ds_out_master.SetColumn(0, "KUNNR","");										//고객번호
	// ds_out_master.SetColumn(0, "SPT","");										//현장명
	// ds_out_master.SetColumn(0, "CST","");										//거래선
	// ds_out_master.SetColumn(0, "CSTNM","");										//거래선명
	// ds_out_master.SetColumn(0, "SPART","");										//제품군
	// ds_out_master.SetColumn(0, "SPARTNM","");									//제품군명
	// ds_out_master.SetColumn(0, "VKGRP","");										//팀
	// ds_out_master.SetColumn(0, "VKBUR","");										//사업장
	// ds_out_master.SetColumn(0, "BSU","");										//업체코드
	// ds_out_master.SetColumn(0, "BSUNM","");										//업체명
	// ds_out_master.SetColumn(0, "PNAME","");										//담당자명
	// ds_out_master.SetColumn(0, "PERNR","");									
	// ds_out_master.SetColumn(0, "LIFNR","");										//수리업체???
	// ds_out_master.SetColumn(0, "BUSSI","");										//사업부구분(1:승강기/2:주차)
	// ds_out_master.SetColumn(0, "SH_ADDR","");									//납품처주소
	// ds_out_master.SetColumn(0, "UPN","");										//통합프로젝트번호
	// ds_out_master.SetColumn(0, "VKBUR","");										//사업장
	// ds_out_master.SetColumn(0, "LIFNR","");										//수리업체
	ds_out_master.SetColumn(0, "QTNUM","");									
	ds_out_master.SetColumn(0, "REQNO","");										//청구번호	
	ds_out_master.SetColumn(0, "CHDAT","");										//변경일자
	ds_out_master.SetColumn(0, "CHTIM","");										//변경시간
	ds_out_master.SetColumn(0, "CRDAT","");										//작성일자
	ds_out_master.SetColumn(0, "CRNAME","");									//작성자명
	ds_out_master.SetColumn(0, "CRTIM","");										//작성시간
	
	//새로운 레코드를 생성하는 것이므로, 결재 관련 사항을 리셋한다.
	ds_out_master.SetColumn(0, "DOC1", "");
	ds_out_master.SetColumn(0, "DOC2", "");
	ds_out_master.SetColumn(0, "DOC3", "");
	ds_out_master.SetColumn(0, "DOC4", "");
	ds_out_master.SetColumn(0, "DOC5", "");
	ds_out_master.SetColumn(0, "DOC1STAT", "");
	ds_out_master.SetColumn(0, "DOC2STAT", "");
	ds_out_master.SetColumn(0, "DOC3STAT", "");
	ds_out_master.SetColumn(0, "DOC4STAT", "");
	ds_out_master.SetColumn(0, "DOC5STAT", "");
	ds_out_master.SetColumn(0, "DOC1STATNM", "");
	ds_out_master.SetColumn(0, "DOC2STATNM", "");
	ds_out_master.SetColumn(0, "DOC3STATNM", "");
	ds_out_master.SetColumn(0, "DOC4STATNM", "");
	ds_out_master.SetColumn(0, "DOC5STATNM", "");
	ds_out_master.SetColumn(0, "DOC1DEC", "");
	ds_out_master.SetColumn(0, "DOC2DEC", "");
	ds_out_master.SetColumn(0, "DOC3DEC", "");
	ds_out_master.SetColumn(0, "DOC4DEC", "");
	ds_out_master.SetColumn(0, "DOC5DEC", "");
	
	//새로운 레코드를 생성하는 것이므로, 견적 관련 사항을 리셋한다.
	ds_out_master.SetColumn(0, "PS_PSPID", "");									//원WBS
	ds_out_master.SetColumn(0, "QSTAT", "0");									//청구상태
	ds_out_master.SetColumn(0, "CHGBN", "");									//견적상태
	ds_out_master.SetColumn(0, "ENDYN", "");									//견적종료여부

	for(var iCnt=0;iCnt < ds_list.rowcount;iCnt++)								//ds_list값 중 HNA, HNO를 삭제하고 FLAG를 신규(I)로 설정한다.
	{
		//ds_list.SetColumn(iCnt, "HNO", "");
		ds_list.SetColumn(iCnt, "FLAG", "I");
	}
	
	//ds_pjt_det.clearData();														//프로젝트 상세 정보를 클리어한다.
	ds_key.clearData();															//ds_key를 clear한다.
	ds_key.AddRow();															
	ds_cond.clearData();														//검색조건을 clear한다.
	ds_cond.addRow();
	//ds_hna.clearData();															//자재 신청용 호기정보를 Clear한다.
	ds_seq.clearData();															//차수정보를 clear한다.
	ds_seq.addRow();															//차수정보를 신규와 동일하게 설정한다.
	ds_seq.SetColumn(0, "CODE", "0");
	ds_seq.SetColumn(0, "CODE_NAME", "0");
	
	
	//ufn_initParameters();														//값을 초기화 한다.
	
	cb_reqkind.value = tmpReqkind;												//청구구분값을 설정한다.(계산을 위해 필요함)
	//ed_netwr_dc.value = tmpNetwrDc;											//판매할인액을 설정한다.


	//ds_out_master.fireevent = true;
	ufn_calcCostValues("btn_copy_offer_OnClick");								//값을 다시 계산한다.
	
	//ufn_setPermissions();
	
	ufn_enableCommBtn("save", true);
	copyFlag = true;
}

/********************************************************************************
* 기      능   : 변경된 차수를 반영한다.
********************************************************************************/
function cb_seq_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	if(nOldIndex == ds_seq.max("CODE") && selfFlag) 							//본인인 경우 최종차수에서만 confirm 출력. 나머지 경우는 confirm없음( 본인 이외 editing 불가)
	{	//다른 차수를 검색하시겠습니까?\n저장되지 않은 모든 작업이 취소됩니다.
		if(!gfn_showConfirm("CI30026")) return;
	}

	ds_cond.SetColumn(0, "SEQ", cb_seq.Value);									//검색조건을 설정한다.
	if(nNewIndex != ds_seq.max("CODE")){
	
	}
	ufn_resetAll();																//모든 정보를 리셋한다.
	ufn_initParameters();														//Parameter를 초기화한다.
	
}


/********************************************************************************
* 기      능   : 견적서를 출력한다.  OFFER SHEET 
********************************************************************************/
function btn_print_ofr_OnClick(obj)
{
	if(ds_list.Count <= 0)
	{	//"출력할 부품이 존재하지 않습니다."
		gfn_showAlert("CI30027");
		return;
	}

	//if(!gfn_showConfirm("CI30001", "견적을 인쇄합니다. \n견적 인쇄 후 초기 화면에서 주문하세요.")) 

	// 견적을 인쇄합니다.
	if(!gfn_showConfirm("CI30028")) 
	{
		return;
	}

	ds_cond.SetColumn(0, "KUNNR", ds_out_master.GetColumn(0, "KUNNR"));
	ds_cond.SetColumn(0, "UPN", ds_out_master.GetColumn(0, "UPN"));
	ds_cond.SetColumn(0, "CST", ds_out_master.GetColumn(0, "CST"));
	ds_cond.SetColumn(0, "QTNUM", ds_out_master.GetColumn(0, "QTNUM"));
	ds_cond.SetColumn(0, "SEQ", ds_out_master.GetColumn(0, "SEQ"));
	
	//-----------------------------------------------
	// offer sheet 견적 유효기간 조정 
	var o_qtdat = ds_out_master.GetColumn(0,"QTDAT");
	var n_qtdat = gfn_getAfterDate(o_qtdat,30) ;
	ds_out_master.SetColumn(0,"QTDAT",n_qtdat);
	
	tit_clearActionInfo();					
	//tit_addSearchActionInfo("cs80:CS8001001B_S11");		// 견적 헤더 정보	
	tit_addSearchActionInfo("cs80:CS8001001B_S13");			// 자재 디테일 			
	tit_addSearchActionInfo("cs80:CS8001001B_S17");		 // 고객	
	tit_callService("", "", "ds_cond=ds_cond", "ds_detail_prt=ds_detail_prt ds_customer_prt=ds_customer_prt", "", "", true, false, true);	
	

//	TRACE(ds_out_master.SaveXML());

	Dialog("CS80::CS8001001G.xml", "");
	
	
	ds_out_master.SetColumn(0,"QTDAT",o_qtdat);
}

function cb_spartnm_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	if(cb_spartnm.Value == "10") { //승강기
		ds_out_master.SetColumn(0, "SPART", "10");
		ds_out_master.SetColumn(0, "BUSSI", "1");
	} else if(cb_spartnm.Value == "20") { //주차
		ds_out_master.SetColumn(0, "SPART", "20");
		ds_out_master.SetColumn(0, "BUSSI", "2");
	} else if(cb_spartnm.Value == "40") { //PSD
		ds_out_master.SetColumn(0, "SPART", "40");
		ds_out_master.SetColumn(0, "BUSSI", "4");
	}
}
/********************************************************************************
* 기      능   :  전송 
 작성 상태값 변경 
 법인장 승인 대상 
********************************************************************************/
function fn_trans() {
		ds_out_master.SetColumn(0, "FLAG", "U");								//FLAG를 바꿔준다.
		

		ds_out_master.SetColumn(0, "QSTAT", "1");								//ZCST001의 QSTAT를 작성 상태로 변경 ( 견적승인대상 )
		ds_out_master.SetColumn(0, "CHGBN", "0");								//ZCST001의 청구구분을 청구접수(0)으로 바꿔준다. 1:수주변경, 2:수주취소, 3:재청구		
		
			// 견적상태 저장 
		ds_out_master.SetColumn(0, "STATUS", "B");	 // 견적 저장 
		
		
		gfn_copyDs(ds_list, ds_list_req, "FLAG=" + quote("U"));				//청구전송 데이터셋에 데이터를 카피한다.
		
		tit_addMultiActionInfo("cs80:CS8001001B_U1");						// ZCST001G   
		tit_addMultiActionInfo("cs80:CS8001001B_U2");                       // ZCST002G  
		tit_addMultiActionInfo("cs80:CS8001001B_U8");                       // ZCST003G 견적 상태 변경 
		tit_callService(
			"" 
			, ""
			, "ds_head=ds_dec ds_list_0=ds_dec ds_out_master=ds_out_master ds_list=ds_list_req ds_cond=ds_cond ds_key=ds_key"
			, "ds_key = ds_key"
			, ""
			, "fn_afterTrans");
}
function fn_afterTrans(errCode, errMsg)
{
	if ( errCode!= 0 ) {
		gfn_showAlert("CE00001");
	} else {
		gfn_showInform("CI00003");
		//gfn_showAlert("CI30001", "주문이 접수되었습니다.");
		gfn_showAlert("CI30006");
		
		for (var iCnt = 0;iCnt < ds_list.rowcount;iCnt++) 						//종료를 위해 데이터셋의 플래그를 복구한다.
		{
			ds_list.SetColumn(iCnt, "FLAG", "");
		}
		
		fn_close();		
	}
}

/********************************************************************************
* 기      능   :  주문하기 (견적 전송) 
********************************************************************************/
function btn_purchase_OnClick(obj)
{

	//fn_trans() ;  // CS8001001F 에서 처리 
	var arg = "fa_qtnum=" + quote(ds_out_master.GetColumn(0, "QTNUM"))
		+ " fa_seq=" + quote(ds_out_master.GetColumn(0, "SEQ"))
		;
	gfn_openPopup("CS8001001F", true, arg);
}

/********************************************************************************
* 기      능   :  주문 수락 (견적 승인) 
********************************************************************************/
function btn_purchase_accept_OnClick(obj)
{
	if(!gfn_showConfirm("CI30001", "주문 승인을 완료합니다.")) 
	{
		return;
	}
	
	fn_approval();
}


function cb_zterm_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	if(strCode == "TB01") {
		cb_zterm2.Enable = false;
		ds_zterm2.UnFilter();
		cb_zterm2.index = 0;
	} else if(strCode == "TF01") {
		cb_zterm2.Enable = true;
		ds_zterm2.Filter("CODE <> 'in advance'");
		cb_zterm2.index = 0;
	} else if(strCode == "LC01") {
		cb_zterm2.Enable = false;
		ds_zterm2.UnFilter();
		cb_zterm2.index = -1;
	} else{
		cb_zterm2.Enable = false;
		ds_zterm2.UnFilter();
		cb_zterm2.index = -1;
	}  
}

function ed_netwr_ship_OnChanged(obj,strText)
{
	//EXW FOB
	if(cb_inco1.index == 0 or cb_inco1.index == 1 or cb_inco1.index == 2 ) { 
		
//		ed_netwr_ship.Value = 0 ;
//		ed_netwr_ship.Enable = false ;
	
	} else {

	}
	//운임 적용에 따른 계산값을 다시 계산한다.
	ufn_calcCostValues("ed_netwr_ship_OnChanged");	
}

function cb_inco1_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	// EXW FOB
	if(nNewIndex == 1 ) { 
	//	ed_netwr_ship = 0;
	}
}

/********************************************************************************
* 기      능   :  중국 법인 할인율 변경 
********************************************************************************/
function btn_discount_new_OnClick(obj)
{	
	var reNetpr = 0;
	var ucost = 0;
	for (var i = 0; i < ds_list.rowcount; i++) {
		ucost = ds_list.GetColumn(i, "UCOSTR");
		// 2자리 이하 버림
		
		/* new 20180601 적용  */
		// 해외원가÷1.30(기존 간접비)×1.162(신규 적용 간접비)×1.1 (신규 마진)

		reNetpr = Truncate((ucost / 1.3 ) * 1.162 * 1.1, 2) ;		
		ds_list.SetColumn(i, "NETPR", reNetpr);

	}

	chk_pjtorder.value = true;
//	btn_discount.Visible = false;
}

function btn_print_po_OnClick(obj)
{
	ds_cond_prt.SetColumn(0, "KUNNR", ds_out_master.GetColumn(0, "KUNNR"));
	ds_cond_prt.SetColumn(0, "UPN", ds_out_master.GetColumn(0, "UPN"));
	ds_cond_prt.SetColumn(0, "CST", ds_out_master.GetColumn(0, "CST"));
	ds_cond_prt.SetColumn(0, "QTNUM", ds_out_master.GetColumn(0, "QTNUM"));
	ds_cond_prt.SetColumn(0, "SEQ", ds_out_master.GetColumn(0, "SEQ"));
	// 상태가 B 이하인 경우 현대 직인 출력 불가 
	ds_cond_prt.SetColumn(0, "STATUS", ds_out_master.GetColumn(0, "STATUS"));
	
	
	tit_clearActionInfo();					
	tit_addSearchActionInfo("cs80:CS8001001B_S11");			// 견적 헤더 정보	 ds_header_prt
	tit_addSearchActionInfo("cs80:CS8001001B_S13");			// 견적 자재 디테일   ds_detail_prt	 		
	tit_addSearchActionInfo("cs80:CS8001001B_S17");			// 고객 정보	 
	tit_callService("", "", "ds_cond=ds_cond_prt", "ds_header_prt=ds_header_prt ds_detail_prt=ds_detail_prt ds_customer_prt=ds_customer_prt", "", "", true, false, true);	

	var o_qtdat = ds_header_prt.GetColumn(0,"QTDAT");
	var n_qtdat = gfn_getAfterDate(o_qtdat,30) ;
	ds_header_prt.SetColumn(0,"QTDAT",n_qtdat);
	
	Dialog("CS80::CS8001001H.xml", ""); // PO SHEET  출력 
}


/********************************************************************************
* 기      능   :  재청구 테스트 중 
********************************************************************************/
var reOrder = false;
function Button1_OnClick(obj)
{
	//저장 SEQ와 QTNUM을 설정한다.
	ds_cond.ClearData();
	ds_cond.AddRow();
	ds_cond.SetColumn(0, "QTNUM", ds_out_master.GetColumn(0, "QTNUM"));
	ds_cond.SetColumn(0, "SEQ", ds_out_master.GetColumn(0, "SEQ"));
	
	
	
	//FLAG를 바꿔준다.
	ds_out_master.SetColumn(0, "FLAG", "U");
//		ds_out_master.SetColumn(0, "FLAG", "I");								//FLAG를 바꿔준다.
	
	gfn_copyDS(ds_list, ds_list_req, "CGBN==1");								//재청구 자재만 전송하기 위해 데이터셋을 복사한다.	
	
	
	//재청구 자재만 전송한다.
	for (var iCnt = 0;iCnt < ds_list_req.rowcount;iCnt++) 
	{
		if(ds_list_req.GetColumn(iCnt, "CGBN") == "1")
		{
			ds_list_req.SetColumn(iCnt, "FLAG", "I");							//재청구자재만 전송한다. 
			ds_list_req.SetColumn(iCnt, "QTNUM", "");							//재청구자재의 견적번호는 비운다(이중청구 가능성있음:이동진SA)
			ds_list_req.SetColumn(iCnt,"POSID2", 
									ds_out_master.GetColumn(0, "PS_PSPID")); 	//원WBS를 적어준다. (SAP전송 번호)
			if(ds_list_req.GetColumn(iCnt, "REQKIND") != "6" &&					//청구구분이 업체재고소진청구나 실패현장청구가 아닌 경우에는...
					ds_list_req.GetColumn(iCnt, "REQKIND") != "G")
			{	
				ds_list_req.SetColumn(iCnt, "REQKIND", "8");					//청구구분을 재청구로 세팅한다.
			}
		}
		else
		{
			ds_list_req.SetColumn(iCnt, "FLAG", "");	
		}
	}
	// QSTAT 변경사항없음
	ds_out_master.SetColumn(0, "QSTAT", "3");									//ZCST001G 의 QSTAT 변경사항없음
	ds_out_master.SetColumn(0, "CHGBN", "3");									//ZCST001G의 청구구분을 재청구(3)로 바꿔준다. 1:수주변경, 2:수주취소, 3:재청구

	trace(ds_cond.saveXml());
	trace(ds_out_master.saveXml());
	trace(ds_list.saveXml());
	trace(ds_list_req.saveXml());

	reOrder = true;
	

	tit_clearActionInfo();

	tit_addSearchActionInfo("cs80:CS8001001B_T2", true);				//청구번호 채번용 Exclusive Lock
	tit_addSearchActionInfo("cs80:CS8001001B_S8", true);				//청구번호 채번(ds_key)
	
	tit_addMultiActionInfo("cs80:CS8001001B_I3");						//ZMMT031에 데이터를 INSERT 한다.
	tit_addMultiActionInfo("cs80:CS8001001B_U3");						//ZCST001을 UPDATE해 준다(REQNO)
	
	tit_callService(
        ""
        , ""
        , "ds_out_master=ds_out_master ds_list=ds_list_req ds_cond=ds_cond ds_key=ds_key"
        , "ds_key = ds_key"
        , ""
        , "fn_afterSaveRequest");
              
}
function ds_list_CanColumnChange(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{
	// 2019.03.18 자재 특성치 최대 100글자만 입력되도록 Validation 로직 추가. 해외서비스 정우성 GJ 요청.
	if(strColumnID == 'CHAR1') {
		if( length(trim(varNewValue)) > 100) {
			gfn_showAlert(nRow + "행 - 자재 특성치 입력 제한치 초과");
			return false;
		}
	}
}
]]></Script>
</Window>