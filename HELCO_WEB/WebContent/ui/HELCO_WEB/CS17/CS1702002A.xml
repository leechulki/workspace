<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="558" Id="CS1702002A" Left="8" OnLoadCompleted="fn_OnLoadCompleted" OnUnloadCompleted="fn_OnUnloadCompleted" PidAttrib="7" Title="호기&#32;생성(NEW)" ToolTipFont="Default,0" Top="8" Ver="1.0" Width="968" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_zgubun">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME></CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_spec4">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME></CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_bsu">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME></CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_juj">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME></CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_buj">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME></CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cyGubun">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME></CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond">
				<Contents>
					<colinfo id="PJT" size="256" summ="default" type="STRING"/>
					<colinfo id="ARA" size="256" summ="default" type="STRING"/>
					<colinfo id="VKGRP" size="256" summ="default" type="STRING"/>
					<colinfo id="BPM" size="256" summ="default" type="STRING"/>
					<record>
						<ARA></ARA>
						<BPM></BPM>
						<PJT></PJT>
						<VKGRP></VKGRP>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_pjt">
				<Contents>
					<colinfo id="NAM" size="256" type="STRING"/>
					<colinfo id="SPT" size="256" type="STRING"/>
					<colinfo id="ADDR" size="256" type="STRING"/>
					<colinfo id="TEL" size="256" type="STRING"/>
					<colinfo id="CYGUBUN" size="256" type="STRING"/>
					<record>
						<ADDR></ADDR>
						<CYGUBUN></CYGUBUN>
						<NAM></NAM>
						<SPT></SPT>
						<TEL></TEL>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cnt">
				<Contents>
					<colinfo id="COUNT" size="256" type="INT"/>
					<record>
						<COUNT/>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cnt2">
				<Contents>
					<colinfo id="COUNT" size="256" type="INT"/>
					<record>
						<COUNT/>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_bpm">
				<Contents>
					<colinfo id="BPM" size="256" type="STRING"/>
					<colinfo id="BPMTEXT" size="256" type="STRING"/>
					<record>
						<BPM></BPM>
						<BPMTEXT></BPMTEXT>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_spec1">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_bld">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list" OnColumnChanged="ds_list_OnColumnChanged">
				<Contents>
					<colinfo id="CHECK" size="256" summ="default" type="STRING"/>
					<colinfo id="HNO" size="256" summ="default" type="STRING"/>
					<colinfo id="SPEC1" size="256" summ="default" type="STRING"/>
					<colinfo id="SPEC2" size="256" summ="default" type="STRING"/>
					<colinfo id="SPEC3" size="256" summ="default" type="STRING"/>
					<colinfo id="SPEC4" size="256" summ="default" type="STRING"/>
					<colinfo id="SPEC6" size="256" summ="default" type="STRING"/>
					<colinfo id="SPEC7" size="256" summ="default" type="STRING"/>
					<colinfo id="JUJ" size="256" summ="default" type="STRING"/>
					<colinfo id="BUJ" size="256" summ="default" type="STRING"/>
					<colinfo id="IJD" size="256" summ="default" type="STRING"/>
					<colinfo id="PST_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="PST" size="256" summ="default" type="STRING"/>
					<colinfo id="ZGUBUN" size="256" summ="default" type="STRING"/>
					<colinfo id="BLD" size="256" summ="default" type="STRING"/>
					<colinfo id="CCG" size="256" summ="default" type="STRING"/>
					<colinfo id="RSN" size="256" summ="default" type="STRING"/>
					<colinfo id="FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="BPM" size="256" summ="default" type="STRING"/>
					<colinfo id="BPMTEXT" size="256" summ="default" type="STRING"/>
					<colinfo id="BSU" size="256" summ="default" type="STRING"/>
					<colinfo id="ZGUBUN_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="BLD_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="SPEC4_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="JUJ_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="BUJ_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="BSU_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="RSN_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="SID" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_rsn">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME>-&#32;선택&#32;-</CODE_NAME>
					</record>
					<record>
						<CODE>A</CODE>
						<CODE_NAME>계산서&#32;분리청구</CODE_NAME>
					</record>
					<record>
						<CODE>B</CODE>
						<CODE_NAME>보수자재&#32;청구</CODE_NAME>
					</record>
					<record>
						<CODE>C</CODE>
						<CODE_NAME>보수회수계약&#32;청구</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_gbn">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME>-&#32;선택&#32;-</CODE_NAME>
					</record>
					<record>
						<CODE>A</CODE>
						<CODE_NAME>자사</CODE_NAME>
					</record>
					<record>
						<CODE>B</CODE>
						<CODE_NAME>타사</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list2" OnColumnChanged="ds_list_OnColumnChanged">
				<Contents>
					<colinfo id="HNO" size="256" summ="default" type="STRING"/>
					<colinfo id="SPEC1" size="256" summ="default" type="STRING"/>
					<colinfo id="SPEC2" size="256" summ="default" type="STRING"/>
					<colinfo id="SPEC3" size="256" summ="default" type="STRING"/>
					<colinfo id="SPEC4" size="256" summ="default" type="STRING"/>
					<colinfo id="SPEC6" size="256" summ="default" type="STRING"/>
					<colinfo id="SPEC7" size="256" summ="default" type="STRING"/>
					<colinfo id="JUJ" size="256" summ="default" type="STRING"/>
					<colinfo id="BUJ" size="256" summ="default" type="STRING"/>
					<colinfo id="IJD" size="256" summ="default" type="STRING"/>
					<colinfo id="PST" size="256" summ="default" type="STRING"/>
					<colinfo id="ZGUBUN" size="256" summ="default" type="STRING"/>
					<colinfo id="BLD" size="256" summ="default" type="STRING"/>
					<colinfo id="CCG" size="256" summ="default" type="STRING"/>
					<colinfo id="RSN" size="256" summ="default" type="STRING"/>
					<colinfo id="FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="BPM" size="256" summ="default" type="STRING"/>
					<colinfo id="BSU" size="256" summ="default" type="STRING"/>
					<colinfo id="PJT" size="256" summ="default" type="STRING"/>
					<colinfo id="SID" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_chk">
				<Contents>
					<colinfo id="HNO" size="256" summ="default" type="STRING"/>
					<colinfo id="PJT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cnt3">
				<Contents>
					<colinfo id="COUNT" size="256" type="INT"/>
					<record>
						<COUNT/>
					</record>
				</Contents>
			</Dataset>
		</Datasets>
		<Shape BKColor="user12" Bottom="238" Height="26" Id="Shape5" Left="8" LineColor="user13" Right="960" TabOrder="55" Top="212" Type="Rectangle" Width="952"></Shape>
		<Shape BKColor="user12" Bottom="213" Height="26" Id="Shape4" Left="8" LineColor="user13" Right="960" TabOrder="36" Top="187" Type="Rectangle" Width="952"></Shape>
		<Shape BKColor="user12" Bottom="188" Height="26" Id="Shape3" Left="8" LineColor="user13" Right="960" TabOrder="27" Top="162" Type="Rectangle" Width="952"></Shape>
		<Shape BKColor="user12" Bottom="163" Height="26" Id="Shape2" Left="8" LineColor="user13" Right="960" TabOrder="26" Top="137" Type="Rectangle" Width="952"></Shape>
		<Shape BKColor="user0" Bottom="88" Height="52" Id="Shape0" Left="0" LineColor="user1" Right="968" TabOrder="18" Top="36" Type="Rectangle" Width="968"></Shape>
		<Static Align="Right" Height="20" Id="st_pjt" Left="5" Style="sty_lb_search" TabOrder="19" Text="Proj&#32;No&#32;" Top="41" VAlign="Middle" Width="80"></Static>
		<Static Align="Right" Height="20" Id="st_addr" Left="5" Style="sty_lb_search" TabOrder="23" Text="현장주소&#32;" Top="63" VAlign="Middle" Width="80"></Static>
		<Static Align="Right" Height="20" Id="st_nam" Left="191" Style="sty_lb_search" TabOrder="20" Text="고객명&#32;" Top="41" VAlign="Middle" Width="80"></Static>
		<Static Align="Right" Height="20" Id="st_spt" Left="468" Style="sty_lb_search" TabOrder="21" Text="현장명&#32;" Top="41" VAlign="Middle" Width="80"></Static>
		<Static Align="Right" Height="20" Id="st_cyGubun" Left="468" Style="sty_lb_search" TabOrder="24" Text="시내외구분&#32;" Top="63" VAlign="Middle" Width="80"></Static>
		<Static Align="Right" Height="20" Id="st_tel" Left="663" Style="sty_lb_search" TabOrder="22" Text="전화번호&#32;" Top="63" VAlign="Middle" Width="80"></Static>
		<Edit BindDataset="ds_cond" Border="Flat" Column="PJT" Enable="FALSE" Height="20" Id="ed_pjt" Left="87" Style="sty_ipt_search" TabOrder="1" Top="41" UpperOnly="TRUE" Width="102"></Edit>
		<Edit BindDataset="ds_pjt" Border="Flat" Column="NAM" Enable="FALSE" Height="20" Id="ed_nam" Left="273" Style="sty_ipt_search" TabOrder="2" Top="41" Width="193"></Edit>
		<Edit BindDataset="ds_pjt" Border="Flat" Column="SPT" Enable="FALSE" Height="20" Id="ed_spt" Left="550" Style="sty_ipt_search" TabOrder="3" Top="41" Width="193"></Edit>
		<Edit BindDataset="ds_pjt" Border="Flat" Column="ADDR" Enable="FALSE" Height="20" Id="ed_addr" Left="87" Style="sty_ipt_search" TabOrder="4" Top="63" Width="379"></Edit>
		<Edit BindDataset="ds_pjt" Border="Flat" Column="TEL" Enable="FALSE" Height="20" Id="ed_tel" Left="745" Style="sty_ipt_search" TabOrder="6" Top="63" Width="113"></Edit>
		<Combo BindDataset="ds_pjt" Border="Flat" CodeColumn="CODE" Column="CYGUBUN" DataColumn="CODE_NAME" Enable="FALSE" Height="20" Id="cb_cyGubun" InnerDataset="ds_cyGubun" Left="549" Style="sty_ipt_search" TabOrder="5" Top="62" Width="113"></Combo>
		<Shape BKColor="user12" Bottom="138" Height="26" Id="Shape1" Left="8" LineColor="user13" Right="960" TabOrder="25" Top="112" Type="Rectangle" Width="952"></Shape>
		<Combo BindDataset="ds_list" Border="Flat" CodeColumn="CODE" Column="ZGUBUN" DataColumn="CODE_NAME" Height="20" Id="cb_zgubun" ImeMode="none" InnerDataset="ds_zgubun" Left="575" Style="sty_ipt_form" TabOrder="9" Top="114" Width="151"></Combo>
		<Static Align="Right" Height="24" Id="st_pjt2" Left="9" Style="sty_lb_form_basic" TabOrder="28" Text="Proj&#32;" Top="113" VAlign="Middle" Width="86"></Static>
		<Edit BindDataset="ds_list" Border="Flat" Column="PJT" Enable="FALSE" Height="20" Id="ed_pjt2" Left="97" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="7" Top="115" UpperOnly="TRUE" Width="149"></Edit>
		<Static Align="Right" Height="24" Id="st_hno" Left="248" Style="sty_lb_form_basic" TabOrder="29" Text="호기번호&#32;" Top="113" VAlign="Middle" Width="86"></Static>
		<Static Align="Right" Height="24" Id="st_zgubun" Left="488" Style="sty_lb_form_basic" TabOrder="30" Text="빌딩구분&#32;" Top="113" VAlign="Middle" Width="86"></Static>
		<Static Align="Right" Height="24" Id="st_spec1" Left="9" Style="sty_lb_form_basic" TabOrder="31" Text="기종&#32;" Top="188" VAlign="Middle" Width="86"></Static>
		<Static Align="Right" Height="24" Id="st_spec2" Left="248" Style="sty_lb_form_basic" TabOrder="32" Text="사양&#32;" Top="188" VAlign="Middle" Width="86"></Static>
		<Static Align="Right" Height="24" Id="st_spec4" Left="488" Style="sty_lb_form_basic" TabOrder="33" Text="용도&#32;" Top="138" VAlign="Middle" Width="86"></Static>
		<Static Align="Right" Height="24" Id="st_bpm" Left="248" Style="sty_lb_form_basic" TabOrder="34" Text="보수PM&#32;" Top="163" VAlign="Middle" Width="86"></Static>
		<Static Align="Right" Height="24" Id="st_bsu" Left="9" Style="sty_lb_form_basic" TabOrder="35" Text="보수업체&#32;" Top="163" VAlign="Middle" Width="86"></Static>
		<Static Align="Right" Height="24" Id="st_juj" Left="488" Style="sty_lb_form_basic" TabOrder="37" Text="주점검자&#32;" Top="163" VAlign="Middle" Width="86"></Static>
		<Static Align="Right" Height="24" Id="st_spec6" Left="727" Style="sty_lb_form_basic" TabOrder="38" Text="용량&#32;" Top="188" VAlign="Middle" Width="86"></Static>
		<Static Align="Right" Height="24" Id="st_spec3" Left="488" Style="sty_lb_form_basic" TabOrder="39" Text="속도&#32;" Top="188" VAlign="Middle" Width="86"></Static>
		<Edit BindDataset="ds_list" Border="Flat" Column="HNO" Height="20" Id="ed_hno" Left="336" LeftMargin="4" MaxLength="3" RightMargin="4" Style="sty_ipt_form" TabOrder="8" Top="115" UpperOnly="TRUE" Width="150"></Edit>
		<Edit BindDataset="ds_list" Border="Flat" Column="SPEC2" Height="20" Id="ed_spec2" Left="336" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="10" Top="190" Width="149"></Edit>
		<Edit BindDataset="ds_list" Border="Flat" Column="BPMTEXT" Enable="FALSE" Height="20" Id="ed_bpm" Left="336" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="12" Top="165" Width="149"></Edit>
		<Edit BindDataset="ds_list" Border="Flat" Column="SPEC3" Height="20" Id="ed_spec3" Left="576" LeftMargin="4" Number="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="15" Top="190" Width="150"></Edit>
		<Combo BindDataset="ds_list" Border="Flat" CodeColumn="CODE" Column="BSU" DataColumn="CODE_NAME" Height="20" Id="cb_bsu" InnerDataset="ds_bsu" Left="95" OnChanged="ufn_chgBsu" Style="sty_ipt_form" TabOrder="13" Top="164" Width="152"></Combo>
		<Combo BindDataset="ds_list" Border="Flat" CodeColumn="CODE" Column="JUJ" DataColumn="CODE_NAME" Height="20" Id="cb_juj" InnerDataset="ds_juj" Left="575" Style="sty_ipt_form" TabOrder="14" Top="164" Width="151"></Combo>
		<Div Height="36" Id="div_btn" TabOrder="40" ToolTipFont="Default,0" Url="WB01::CommBtnForm.xml" Width="968">
			<Contents></Contents>
		</Div>
		<Combo BindDataset="ds_list" Border="Flat" CodeColumn="CODE" Column="SPEC4" DataColumn="CODE_NAME" Height="20" Id="cb_spec4" InnerDataset="ds_spec4" Left="575" Style="sty_ipt_form" TabOrder="11" Top="139" Width="151"></Combo>
		<Edit BindDataset="ds_list" Border="Flat" Column="SPEC7" Height="20" Id="ed_spec7" Left="97" LeftMargin="4" Number="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="16" Top="215" Width="149"></Edit>
		<Static Align="Right" Height="24" Id="st_ipjuDate" Left="727" Style="sty_lb_form_basic" TabOrder="42" Text="입주일&#32;" Top="138" VAlign="Middle" Width="86"></Static>
		<Calendar BindDataset="ds_list" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="IJD" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="med_ipjuDate" Left="815" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="17" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="140" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="142"></Calendar>
		<Combo BindDataset="ds_list" Border="Flat" CodeColumn="CODE" Column="SPEC1" DataColumn="CODE_NAME" Height="20" Id="cb_spec1" InnerDataset="ds_spec1" Left="96" Style="sty_ipt_form" TabOrder="43" Top="189" Width="100"></Combo>
		<Static Align="Right" Height="24" Id="st_bld" Left="727" Style="sty_lb_form_basic" TabOrder="45" Text="건물용도&#32;" Top="113" VAlign="Middle" Width="86"></Static>
		<Combo BindDataset="ds_list" Border="Flat" CodeColumn="CODE" Column="BLD" DataColumn="CODE_NAME" Height="20" Id="cb_bld" InnerDataset="ds_bld" Left="814" Style="sty_ipt_form" TabOrder="44" Top="114" Width="144"></Combo>
		<Static Align="Right" Height="24" Id="st_buj" Left="727" Style="sty_lb_form_basic" TabOrder="47" Text="부점검자&#32;" Top="163" VAlign="Middle" Width="86"></Static>
		<Combo BindDataset="ds_list" Border="Flat" CodeColumn="CODE" Column="BUJ" DataColumn="CODE_NAME" Height="20" Id="cb_buj" InnerDataset="ds_buj" Left="814" Style="sty_ipt_form" TabOrder="46" Top="164" Width="144"></Combo>
		<Grid AutoFitEndLine="Hide" BindDataset="ds_list" BkColor2="default" BoldHead="true" Border="Flat" Bottom="552" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="312" Id="grd_list" InputPanel="FALSE" Left="8" LineColor="user20" LineType="ExHORZ" OnHeadClick="grd_list_OnHeadClick" Right="960" RowHeight="20" Style="sty_grid" TabOrder="48" TabStop="true" Top="240" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="952">
			<contents>
				<format id="Default">
					<columns>
						<col width="28"/>
						<col width="40"/>
						<col width="62"/>
						<col width="180"/>
						<col width="80"/>
						<col width="140"/>
						<col width="80"/>
						<col width="60"/>
						<col width="60"/>
						<col width="60"/>
						<col width="70"/>
						<col width="70"/>
						<col width="90"/>
						<col width="80"/>
						<col width="72"/>
						<col width="80"/>
						<col width="80"/>
						<col width="90"/>
						<col width="62"/>
					</columns>
					<head>
						<cell align="center" col="0" color="user21" display="checkbox" font="굴림,9"/>
						<cell align="center" col="1" color="user21" display="text" font="굴림,9" text="No"/>
						<cell align="center" col="2" color="user21" display="text" font="굴림,9" text="호기번호"/>
						<cell align="center" col="3" color="user21" display="text" font="굴림,9" text="협력사"/>
						<cell align="center" col="4" color="user21" display="text" font="굴림,9" text="기종"/>
						<cell align="center" col="5" color="user21" display="text" font="굴림,9" text="사양"/>
						<cell align="center" col="6" color="user21" display="text" font="굴림,9" text="용도"/>
						<cell col="7" color="user21" display="text" font="굴림,9" text="용량"/>
						<cell align="center" col="8" color="user21" display="text" font="굴림,9" text="속도"/>
						<cell align="center" col="9" color="user21" display="text" font="굴림,9" text="층수"/>
						<cell align="center" col="10" color="user21" display="text" font="굴림,9" text="주점검자"/>
						<cell col="11" color="user21" display="text" font="굴림,9" text="부점검자"/>
						<cell align="center" col="12" color="user21" display="text" font="굴림,9" text="건물용도"/>
						<cell align="center" col="13" color="user21" display="text" font="굴림,9" text="빌딩구분"/>
						<cell align="center" col="14" color="user21" display="text" font="굴림,9" text="승강기번호"/>
						<cell align="center" col="15" color="user21" display="text" font="굴림,9" text="입주일"/>
						<cell col="16" color="user21" display="text" font="굴림,9" text="자사기종여부"/>
						<cell align="center" col="17" color="user21" display="text" font="굴림,9" text="생성사유"/>
						<cell col="18" color="user21" display="text" font="굴림,9" text="진행상태"/>
					</head>
					<body>
						<cell bkcolor2="user22" col="0" colid="CHECK" display="expr:iif(PST&#32;==&#32;&apos;A6&apos;,&#32;&apos;none&apos;,&#32;&apos;checkbox&apos;)" edit="expr:iif(PST&#32;==&#32;&apos;A6&apos;,&#32;&apos;none&apos;,&#32;&apos;checkbox&apos;)"/>
						<cell align="center" bkcolor2="user22" col="1" display="text" expr="currow+1"/>
						<cell align="center" bkcolor2="user22" col="2" colid="HNO" display="text"/>
						<cell align="left" bkcolor2="user22" col="3" colid="BSU_NM" display="text"/>
						<cell align="center" bkcolor2="user22" col="4" colid="SPEC1" display="text"/>
						<cell align="center" bkcolor2="user22" col="5" colid="SPEC2" display="text"/>
						<cell align="center" bkcolor2="user22" col="6" colid="SPEC4_NM" display="text"/>
						<cell align="center" bkcolor2="user22" col="7" colid="SPEC6" display="text"/>
						<cell align="center" bkcolor2="user22" col="8" colid="SPEC3" display="text"/>
						<cell align="center" bkcolor2="user22" col="9" colid="SPEC7" display="text"/>
						<cell align="center" bkcolor2="user22" col="10" colid="JUJ_NM" display="text"/>
						<cell align="center" bkcolor2="user22" col="11" colid="BUJ_NM" display="text"/>
						<cell align="center" bkcolor2="user22" col="12" colid="BLD_NM" display="text"/>
						<cell align="center" bkcolor2="user22" col="13" colid="ZGUBUN_NM" display="text"/>
						<cell align="center" bkcolor2="user22" col="14" colid="SID" display="text" Mask="###-####"/>
						<cell align="center" bkcolor2="user22" col="15" colid="IJD" display="text" Mask="####.##.##"/>
						<cell align="center" bkcolor2="user22" col="16" colid="GBN_NM" display="text"/>
						<cell align="left" bkcolor2="user22" col="17" colid="RSN_NM" display="text"/>
						<cell align="center" bkcolor2="user22" col="18" colid="PST_NM" display="text"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Edit BindDataset="ds_list" Border="Flat" Column="SPEC6" Height="21" Id="ed_spec6" Left="815" LeftMargin="4" Number="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="49" Top="189" Width="143"></Edit>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_create_hno" ImageID="btn_sub_04" Left="808" LeftMargin="12" OnClick="btn_create_hno_OnClick" Style="sty_btn" TabOrder="50" Text="호기생성" Top="91" Transparent="TRUE" Width="72"></Button>
		<Static Align="Right" Height="24" Id="st_ccg" Left="9" Style="sty_lb_form_basic" TabOrder="52" Text="자사기종여부&#32;" Top="138" VAlign="Middle" Width="86"></Static>
		<Combo BindDataset="ds_list" Border="Flat" CodeColumn="CODE" Column="CCG" DataColumn="CODE_NAME" Height="20" Id="cb_ccg" InnerDataset="ds_gbn" Left="95" Style="sty_ipt_form" TabOrder="51" Top="139" Width="151"></Combo>
		<Static Align="Right" Height="24" Id="st_rsn" Left="248" Style="sty_lb_form_basic" TabOrder="54" Text="생성사유&#32;" Top="138" VAlign="Middle" Width="86"></Static>
		<Combo BindDataset="ds_list" Border="Flat" CodeColumn="CODE" Column="RSN" DataColumn="CODE_NAME" Height="20" Id="cb_rsn" InnerDataset="ds_rsn" Left="335" OnChanged="ufn_chgBsu" Style="sty_ipt_form" TabOrder="53" Top="139" Width="151"></Combo>
		<Static Align="Right" Height="24" Id="Static0" Left="248" Style="sty_lb_form_basic" TabOrder="56" Text="승강기번호" Top="213" VAlign="Middle" Width="86"></Static>
		<Edit BindDataset="ds_list" Border="Flat" Column="SID" Height="20" Id="ed_sid" Left="336" LeftMargin="4" Number="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="57" Top="215" Width="150"></Edit>
		<Static Align="Right" Height="24" Id="st_spec7" Left="9" Style="sty_lb_form_basic" TabOrder="41" Text="층수&#32;" Top="213" VAlign="Middle" Width="86"></Static>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_modify" ImageID="btn_sub_04" Left="888" LeftMargin="12" OnClick="fn_save" Style="sty_btn" TabOrder="58" Text="수정" Top="91" Transparent="TRUE" Width="72"></Button>
	</Form>
	<Script><![CDATA[﻿﻿﻿﻿﻿﻿﻿﻿/*
 ******************************************************************************************
 * 기      능   :
 * 작  성  자   :
 * 작성  일자   :
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
#include "LIB::commons.js";	// 공통 스크립트
//=========================================================================================
// [ PART 1 ]
// Form에서 사용될 전역변수를 선언
// FORM에서 사용되는 전역변수는 대문자로 작성하며, F_XXX 의 형태를 갖도록 한다.
//=========================================================================================

//=========================================================================================
// [ PART 2 ]
// Form Loading / Unloading 시 작업 정의
//=========================================================================================
var pjt, ara;
var nRow;

function fn_OnLoadCompleted(obj) {
	gfn_initForm();
	
	ed_pjt.Text = pjt;
	ed_pjt2.Text = pjt;
	
	var codeArr = ["CS116","CS112","CS121","CS123","CSSPEC"];
	var dsObjArr = [ds_cyGubun,ds_zgubun,ds_spec4,ds_bld, ds_spec1];
	var addTypeArr = [G_CODE_NONE,G_CODE_BLANK,G_CODE_BLANK,G_CODE_NONE,G_CODE_SELECT];
	gfn_searchCommCode(codeArr, dsObjArr, addTypeArr);

	ds_cond.SetColumn(0, "PJT", pjt);
	ds_cond.SetColumn(0, "ARA", ara);
}
/********************************************************************************
* 기      능   : 공통코드가 조회된 후의 Callback 함수
********************************************************************************/
function fn_completeInit(sCode, sDsObj, sCodeType) {
	
	var uGroup = gfn_getUserGroup();
	
	if(uGroup == '20') {
		ds_cond.SetColumn(0, "ARA", ara);
		ds_cond.SetColumn(0, "BPM",G_USER_ID);
		btn_create_hno.Enable = true;			// 호기생성
		btn_modify.enable = true;			// 저장(수정)
		div_btn.btn_input.enable = true;		// 입력
		div_btn.btn_approval.enable = false;	// 승인
		div_btn.btn_sendback.enable = false;	// 반송
		div_btn.btn_delete.enable = false;		// 삭제	
	}else if(uGroup == '30') {
		ds_cond.SetColumn(0, "ARA", ara);
		ds_cond.SetColumn(0, "VKGRP",G_SAP_USER_VGCD);
		btn_create_hno.Enable = true;			// 호기생성
		btn_modify.enable = true;			// 저장(수정)
		div_btn.btn_input.enable = true;		// 입력
		div_btn.btn_approval.enable = false;	// 승인
		div_btn.btn_sendback.enable = false;	// 반송
		div_btn.btn_delete.enable = false;		// 삭제	
	}else if(uGroup == '40') {
		ds_cond.SetColumn(0, "ARA", ara);
		btn_create_hno.Enable = true;			// 호기생성
		btn_modify.enable = true;		// 저장(수정)
		div_btn.btn_input.enable = true;		// 입력
		div_btn.btn_approval.enable = true;		// 승인
		div_btn.btn_sendback.enable = true;		// 반송
		div_btn.btn_delete.enable = true;		// 삭제	
	}else{
		btn_create_hno.Enable = false;			// 호기생성
		btn_modify.enable = false;		// 저장(수정)
		div_btn.btn_input.enable = false;		// 입력
		div_btn.btn_approval.enable = false;	// 승인
		div_btn.btn_sendback.enable = false;	// 반송
		div_btn.btn_delete.enable = false;		// 삭제		
	} 
	if (G_USER_ID == "3018741") {			// psd 손동훈 직장 
		btn_create_hno.Enable = true;			// 호기생성
		btn_modify.enable = true;		// 저장(수정)
		div_btn.btn_input.enable = true;		// 입력
		div_btn.btn_approval.enable = true;		// 승인
		div_btn.btn_sendback.enable = true;		// 반송
		div_btn.btn_delete.enable = true;		// 삭제	
	} 
	cb_cyGubun.Index = 0;
	cb_zgubun.Index = 0;
	cb_spec4.Index = 0;
	cb_bld.Index = 0;
	cb_rsn.Index = 0;
	cb_ccg.Index = 0;
	
	ufn_initCombo();
	

}
/********************************************************************************
* 기      능   : form UnloadCompleted
********************************************************************************/
function fn_OnUnloadCompleted(obj) {
	return gfn_isFormUnload(obj);
}
//=========================================================================================
// [ PART 3 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,form닫기)
//=========================================================================================
/********************************************************************************
* 기      능   : 조회 1
********************************************************************************/
function fn_query() {

	tit_clearActionInfo();
	tit_addSearchActionInfo("cs17:CS1702002A_S4");
	tit_addSearchActionInfo("cs17:CS1702002A_S5");

	tit_callService(
        ""
        , ""
        , "ds_cond=ds_cond"
        , "ds_pjt=ds_pjt ds_list=ds_list"
        , ""
        , "fn_afterQuery"
        , true);
}

/********************************************************************************
* 기      능   : 호기생성
********************************************************************************/
function btn_create_hno_OnClick(obj)
{	
	ds_list2.ClearData();
	
	//== 이유는 모르겠으나 loop를 사용했지만 마지막 호기 한건만 inser 되도록 되어 있어서 멀티로 입력되도록 수정
    var j = 0;
    
    
	for(var i=0; i<ds_list.RowCount(); i++) {					
		if(ds_list.GetColumn(i, "CHECK") == true) { //체크박스가 true 일 경우				
			/* 20120817 전현정 사원의 요청으로 기존 데이터 활용하여 호기 생성 가능 */
			/*if(ds_list.GetColumn(i, "GBN") == "S"){				
				var arr = [i + 1];
				gfn_showMsg("CW00235", arr );
				return false;
			}*/
		
		
//== 이유는 모르겠으나 loop를 사용했지만 마지막 호기 한건만 inser 되도록 되어 있어서 멀티로 입력되도록 수정
/*
			if(fn_saveCheck(i)==true){				
				ds_list2.AddRow();
				ds_list2.SetColumn(0, "PJT",    ds_cond.GetColumn(0, "PJT"));
				ds_list2.SetColumn(0, "HNO",    ds_list.GetColumn(i, "HNO"));
				ds_list2.SetColumn(0, "SPEC1",  ds_list.GetColumn(i, "SPEC1"));
				ds_list2.SetColumn(0, "SPEC2",  ds_list.GetColumn(i, "SPEC2"));
				ds_list2.SetColumn(0, "SPEC3",  ds_list.GetColumn(i, "SPEC3"));
				ds_list2.SetColumn(0, "SPEC4",  ds_list.GetColumn(i, "SPEC4"));
				ds_list2.SetColumn(0, "SPEC6",  ds_list.GetColumn(i, "SPEC6"));
				ds_list2.SetColumn(0, "SPEC7",  ds_list.GetColumn(i, "SPEC7"));
				ds_list2.SetColumn(0, "JUJ",    ds_list.GetColumn(i, "JUJ"));
				ds_list2.SetColumn(0, "BUJ",    ds_list.GetColumn(i, "BUJ"));
				ds_list2.SetColumn(0, "IJD",    ds_list.GetColumn(i, "IJD"));
				ds_list2.SetColumn(0, "ZGUBUN", ds_list.GetColumn(i, "ZGUBUN"));
				ds_list2.SetColumn(0, "BLD",    ds_list.GetColumn(i, "BLD"));				
				ds_list2.SetColumn(0, "CCG",    ds_list.GetColumn(i, "CCG"));
				ds_list2.SetColumn(0, "RSN",    ds_list.GetColumn(i, "RSN"));
				ds_list2.SetColumn(0, "IJD",    ds_list.GetColumn(i, "IJD"));
				ds_list2.SetColumn(0, "BPM",    ds_list.GetColumn(i, "BPM"));
				ds_list2.SetColumn(0, "BSU",    ds_list.GetColumn(i, "BSU"));
				ds_list2.SetColumn(0, "SID",    ds_list.GetColumn(i, "SID"));
			} else {
				return false;
			}
		}
	}
	
	tit_clearActionInfo();	
	tit_addSingleActionInfo("cs17:CS1702002A_I1"); // zmaster02
	tit_addSingleActionInfo("cs17:CS1702002A_I2"); // zcst101
	tit_addSingleActionInfo("cs17:CS1702002A_I3"); // zcst122
	tit_addSingleActionInfo("cs17:CS1702002A_I4"); // zcst111
	tit_addSingleActionInfo("cs17:CS1702002A_I5"); // zcst202
	tit_addSingleActionInfo("cs17:CS1702002A_U3"); // zmaster01
	tit_addSingleActionInfo("cs17:CS1702002A_U4"); // zcst121
*/	
			if(fn_saveCheck(i, "I")==true){				
				ds_list2.AddRow();
				ds_list2.SetColumn(j, "PJT",    ds_cond.GetColumn(0, "PJT"));
				ds_list2.SetColumn(j, "HNO",    ds_list.GetColumn(i, "HNO"));
				ds_list2.SetColumn(j, "SPEC1",  ds_list.GetColumn(i, "SPEC1"));
				ds_list2.SetColumn(j, "SPEC2",  ds_list.GetColumn(i, "SPEC2"));
				ds_list2.SetColumn(j, "SPEC3",  ds_list.GetColumn(i, "SPEC3"));
				ds_list2.SetColumn(j, "SPEC4",  ds_list.GetColumn(i, "SPEC4"));
				ds_list2.SetColumn(j, "SPEC6",  ds_list.GetColumn(i, "SPEC6"));
				ds_list2.SetColumn(j, "SPEC7",  ds_list.GetColumn(i, "SPEC7"));
				ds_list2.SetColumn(j, "JUJ",    ds_list.GetColumn(i, "JUJ"));
				ds_list2.SetColumn(j, "BUJ",    ds_list.GetColumn(i, "BUJ"));
				ds_list2.SetColumn(j, "IJD",    ds_list.GetColumn(i, "IJD"));
				ds_list2.SetColumn(j, "ZGUBUN", ds_list.GetColumn(i, "ZGUBUN"));
				ds_list2.SetColumn(j, "BLD",    ds_list.GetColumn(i, "BLD"));				
				ds_list2.SetColumn(j, "CCG",    ds_list.GetColumn(i, "CCG"));
				ds_list2.SetColumn(j, "RSN",    ds_list.GetColumn(i, "RSN"));
				ds_list2.SetColumn(j, "IJD",    ds_list.GetColumn(i, "IJD"));
				ds_list2.SetColumn(j, "BPM",    ds_list.GetColumn(i, "BPM"));
				ds_list2.SetColumn(j, "BSU",    ds_list.GetColumn(i, "BSU"));
				ds_list2.SetColumn(j, "SID",    ds_list.GetColumn(i, "SID"));
				
				j++;
			} else {
				return false;
			}
		}
	}
	
	tit_clearActionInfo();	
	tit_addMultiActionInfo("cs17:CS1702002A_I1"); // zmaster02
	tit_addMultiActionInfo("cs17:CS1702002A_I2"); // zcst101
	tit_addMultiActionInfo("cs17:CS1702002A_I3"); // zcst122
	tit_addMultiActionInfo("cs17:CS1702002A_I4"); // zcst111
	tit_addMultiActionInfo("cs17:CS1702002A_I5"); // zcst202
	tit_addMultiActionInfo("cs17:CS1702002A_U3"); // zmaster01
	tit_addMultiActionInfo("cs17:CS1702002A_U4"); // zcst121


	
	
	
	tit_callService(
	""
	, ""
	, "ds_list2=ds_list2"
	, ""
	, ""
	, "fn_afterSave"
	, true
	, true
	, true
	);      	
	
}
/********************************************************************************
* 기      능   : 수정
********************************************************************************/
function fn_save() {
    if(ds_list.FindRow("CHECK", 1) == -1) {
		gfn_showMsg("CW00013");
		return;
	}	
	
	ds_list2.ClearData();
	var j = 0;
	for(var i=0; i<ds_list.RowCount(); i++){				
		if(ds_list.GetColumn(i, "CHECK") == true) {//체크박스가 true 일 경우	
			if(ds_list.GetColumn(i, "PST") != "A1" && ds_list.GetColumn(i, "PST") != "A2"){
				var arr = [ i + 1 , "수정" ];
				gfn_showMsg("CW00236", arr);
				return;
			}
			
			if(fn_saveCheck(i ,"U")==true){

				ds_list2.AddRow();
				ds_list2.SetColumn(j, "PJT",    ds_cond.GetColumn(0, "PJT"));
				ds_list2.SetColumn(j, "HNO",    ds_list.GetColumn(i, "HNO"));
				ds_list2.SetColumn(j, "SPEC1",  ds_list.GetColumn(i, "SPEC1"));
				ds_list2.SetColumn(j, "SPEC2",  ds_list.GetColumn(i, "SPEC2"));
				ds_list2.SetColumn(j, "SPEC3",  ds_list.GetColumn(i, "SPEC3"));
				ds_list2.SetColumn(j, "SPEC4",  ds_list.GetColumn(i, "SPEC4"));
				ds_list2.SetColumn(j, "SPEC6",  ds_list.GetColumn(i, "SPEC6"));
				ds_list2.SetColumn(j, "SPEC7",  ds_list.GetColumn(i, "SPEC7"));
				ds_list2.SetColumn(j, "JUJ",    ds_list.GetColumn(i, "JUJ"));
				ds_list2.SetColumn(j, "BUJ",    ds_list.GetColumn(i, "BUJ"));
				ds_list2.SetColumn(j, "IJD",    ds_list.GetColumn(i, "IJD"));
				ds_list2.SetColumn(j, "ZGUBUN", ds_list.GetColumn(i, "ZGUBUN"));
				ds_list2.SetColumn(j, "BLD",    ds_list.GetColumn(i, "BLD"));				
				ds_list2.SetColumn(j, "CCG",    ds_list.GetColumn(i, "CCG"));
				ds_list2.SetColumn(j, "RSN",    ds_list.GetColumn(i, "RSN"));
				ds_list2.SetColumn(j, "IJD",    ds_list.GetColumn(i, "IJD"));
				ds_list2.SetColumn(j, "BPM",    ds_list.GetColumn(i, "BPM"));
				ds_list2.SetColumn(j, "BSU",    ds_list.GetColumn(i, "BSU"));
				ds_list2.SetColumn(j, "SID",    ds_list.GetColumn(i, "SID"));
				
				j++;
			}else {
				return false;
			}
		}
	}
		
	tit_clearActionInfo();
	tit_addMultiActionInfo("cs17:CS1702002A_U7");
	tit_addMultiActionInfo("cs17:CS1702002A_U8");
	tit_addMultiActionInfo("cs17:CS1702002A_U9"); 
	tit_addMultiActionInfo("cs17:CS1702002A_U10"); // 'A1' '작성'
	tit_callService(
		""
		, ""
		, "ds_list2=ds_list2"
		, ""
		, ""
		, "fn_afterSave"
		, true);
}
function fn_saveCheck(i, m){
	
	var seq = i + 1 + "번째 호기의 ";
		
	if(length(trim(ds_list.GetColumn(i, "HNO"))) == 0){		
		var arr = [seq + trim(st_hno.Text)];
		gfn_showMsg("CW00001", arr);
		return false;
	}
	if(length(trim(ds_list.GetColumn(i, "ZGUBUN"))) == 0){		
		var arr = [seq + trim(st_zgubun.Text)];
		gfn_showMsg("CW00001", arr);
		return false;
	}
	if(length(trim(ds_list.GetColumn(i, "BLD"))) == 0){		
		var arr = [seq + trim(st_bld.Text)];
		gfn_showMsg("CW00001", arr);
		return false;
	}
	if(length(trim(ds_list.GetColumn(i, "CCG"))) == 0){		
		var arr = [seq + trim(st_ccg.Text)];
		gfn_showMsg("CW00001", arr);
		return false;
	}
	if(length(trim(ds_list.GetColumn(i, "RSN"))) == 0){		
		var arr = [seq + trim(st_rsn.Text)];
		gfn_showMsg("CW00001", arr);
		return false;
	}
	if(length(trim(ds_list.GetColumn(i, "SPEC4"))) == 0){		
		var arr = [seq + trim(st_spec4.Text)];
		gfn_showMsg("CW00001", arr);
		return false;
	}
	if(length(trim(ds_list.GetColumn(i, "IJD"))) == 0){		
		var arr = [seq + trim(st_ipjuDate.Text)];
		gfn_showMsg("CW00001", arr);
		return false;
	}	
	if(length(trim(ds_list.GetColumn(i, "BSU"))) == 0){		
		var arr = [seq + trim(st_bsu.Text)];
		gfn_showMsg("CW00001", arr);
		return false;
	}			
	if(length(trim(ds_list.GetColumn(i, "JUJ"))) == 0){		
		var arr = [seq + trim(st_juj.Text)];
		gfn_showMsg("CW00001", arr);
		return false;
	}
	if(length(trim(ds_list.GetColumn(i, "BUJ"))) == 0){		
		var arr = [seq + trim(st_buj.Text)];
		gfn_showMsg("CW00001", arr);
		return false;
	}			
	if(length(trim(ds_list.GetColumn(i, "SPEC1"))) == 0){		
		var arr = [seq + trim(st_spec1.Text)];
		gfn_showMsg("CW00001", arr);
		return false;
	}
	if(length(trim(ds_list.GetColumn(i, "SPEC2"))) == 0){		
		var arr = [seq + trim(st_spec2.Text)];
		gfn_showMsg("CW00001", arr);
		return false;
	}
	if(length(trim(ds_list.GetColumn(i, "SPEC3"))) == 0){		
		var arr = [seq + trim(st_spec3.Text)];
		gfn_showMsg("CW00001", arr);
		return false;
	}
	if(length(trim(ds_list.GetColumn(i, "SPEC6"))) == 0){		
		var arr = [seq + trim(st_spec6.Text)];
		gfn_showMsg("CW00001", arr);
		return false;
	}
	if(length(trim(ds_list.GetColumn(i, "SPEC7"))) == 0){		
		var arr = [seq + trim(st_spec7.Text)];
		gfn_showMsg("CW00001", arr);
		return false;
	}
	
	//============================기입력된 호기 인지 체그============================
	if ( m == "I" )
	{
		ds_chk.ClearData();
		ds_chk.AddRow();
		ds_chk.SetColumn(0,"PJT",ds_cond.GetColumn(0, "PJT"));
		ds_chk.SetColumn(0,"HNO",ds_list.GetColumn(i, "HNO"));
	
		tit_clearActionInfo();
		tit_addSearchActionInfo("cs17:CS1702002A_S8");
		tit_callService(
			""
			, ""
			, "ds_chk=ds_chk"
			, "ds_cnt3=ds_cnt3"
			, ""
			, ""
			, ""
			, ""
			, true);	
	
		if (ds_cnt3.getColumn(0,"COUNT") >= 1) 
		{
			gfn_showAlert("CW10025", ds_list.GetColumn(i, "HNO") + "호기는 이미 생성 되어 있습니다. ");
			return false;
		}	
	}
    //===============================================================================
	
	
	return true;
}
/********************************************************************************
* 기      능   : Delete
********************************************************************************/
function fn_delete() {
    if(ds_list.FindRow("CHECK", 1) == -1) {
		gfn_showMsg("CW00013");
		return false;
	}
			
	ds_list2.ClearData();

	var j = 0;
	
	for(var i=0; i<ds_list.RowCount(); i++) {
					
		if(ds_list.GetColumn(i, "CHECK") == true) { //체크박스가 true 일 경우
				
			if(ds_list.GetColumn(i, "PST") != "A1" && ds_list.GetColumn(i, "PST") != "A2"){				
				var arr = [ i + 1 , "삭제" ];
				gfn_showMsg("CW00236", arr);
				return false;
			}
			
			ds_list2.AddRow();
			ds_list2.SetColumn(j, "PJT", ds_cond.GetColumn(0, "PJT"));
			ds_list2.SetColumn(j, "HNO", ds_list.GetColumn(i, "HNO"));		
		
			j++;
		}
	}
		
	tit_clearActionInfo();
	tit_addMultiActionInfo("cs17:CS1702002A_D1");
	tit_addMultiActionInfo("cs17:CS1702002A_D2");
	tit_addMultiActionInfo("cs17:CS1702002A_D3");
	tit_addMultiActionInfo("cs17:CS1702002A_D4");
	tit_addMultiActionInfo("cs17:CS1702002A_D5");
	
	tit_addMultiActionInfo("cs17:CS1702002A_U5");
	tit_addMultiActionInfo("cs17:CS1702002A_U6");
	
	tit_callService(
		""
		, ""
		, "ds_list2=ds_list2"
		, ""
		, ""
		, "fn_afterSave"
		, true);
		
}
/********************************************************************************
* 기      능   : 승인
********************************************************************************/
function fn_approval(){
    if(ds_list.FindRow("CHECK", 1) == -1) {
		gfn_showMsg("CW00013");
		return false;
	}
	
	ds_list2.ClearData();

	var j = 0;
	
	for(var i=0; i<ds_list.RowCount(); i++) {
					
		if(ds_list.GetColumn(i, "CHECK") == true){
			if(ds_list.GetColumn(i, "PST") != "A1"){
				var arr = [ i + 1 , "승인" ];
				gfn_showMsg("CW00236", arr);
				return false;
			}
			
			ds_list2.AddRow();
			ds_list2.SetColumn(j, "PJT", ds_cond.GetColumn(0, "PJT"));
			ds_list2.SetColumn(j, "HNO", ds_list.GetColumn(i, "HNO"));		
		
			j++;
		}
	}

	tit_clearActionInfo();
	tit_addMultiActionInfo("cs17:CS1702002A_U1");	 					
	tit_callService(
	""
	, ""
	, "ds_list2=ds_list2"
	, ""
	, ""
	, "fn_afterSave"
	, true);
}
/********************************************************************************
* 기      능   : 반송
********************************************************************************/
function fn_sendback(){
    if(ds_list.FindRow("CHECK", 1) == -1) {
		gfn_showMsg("CW00013");
		return false;
	}
	ds_list2.ClearData();

	var j = 0;
	
	for(var i=0; i<ds_list.RowCount(); i++) {
					
		if(ds_list.GetColumn(i, "CHECK") == true){
			
			if(ds_list.GetColumn(i, "PST") != "A1"){
				var arr = [ i + 1 , "반송" ];
				gfn_showMsg("CW00236", arr);
				return false;
			}
			
			ds_list2.AddRow();
			ds_list2.SetColumn(j, "PJT", ds_cond.GetColumn(0, "PJT"));
			ds_list2.SetColumn(j, "HNO", ds_list.GetColumn(i, "HNO"));		
		
			j++;
		}
	}

	tit_clearActionInfo();
	tit_addMultiActionInfo("cs17:CS1702002A_U2");	
	tit_callService(
		""
		, ""
		, "ds_list2=ds_list2"
		, ""
		, ""
		, "fn_afterSave"
		, true);
			
}
/********************************************************************************
* 기      능   : 닫기
********************************************************************************/
function fn_close() {
	parent.fn_query();
	close();
}
/********************************************************************************
* 기      능   : 입력
********************************************************************************/
function fn_input()
{
	gfn_addGridRow(grd_list, -1, "FLAG");
	
	ed_pjt2.Value = ds_cond.GetColumn(0, "PJT");
	ds_list.SetColumn(ds_list.currow, "CHECK", "1");
}
//=========================================================================================
// [ PART 4]
// Callback 함수 정의 : callback 함수명은 메인 함수의 fn_xxxx() 에서 xxxx 부분은 fn_afterXXXX()
// 형태가 되도록 작성
//=========================================================================================
/********************************************************************************
* 기      능   : 조회 Callback
********************************************************************************/
function fn_afterQuery(errCode, errMsg) {
	// 메시지 처리
	gfn_showSearchMsg(grd_list);
	if(ds_pjt.GetRowCount()==0) ds_pjt.AddRow();
	if(ds_list.GetRowCount()==0){
		ds_list.AddRow(); 
		ds_list.SetColumn(ds_list.currow, "CHECK", "1");
	} 
	ed_pjt2.Text = ed_pjt.Text;
	ufn_chgBsu();
}
/********************************************************************************
* 기      능   : 저장 Callback
********************************************************************************/
function fn_afterSave(errCode, errMsg) {
	if ( errCode!= 0 ) {
		gfn_showMsg("CE00001");
	} else {
		gfn_showMsg("CI00003");
	}
	fn_query();
}
//=========================================================================================
// [ PART 5 ]
// Detail Process Event 정의 ( User Define function )
// 사용자 정의 함수는 ufn_xxxx() 형태로 작성
//=========================================================================================
/********************************************************************************
* 기      능   : 사용자 정의 함수
********************************************************************************/
function ufn_initCombo(){
	tit_clearActionInfo();
	tit_addSearchActionInfo("cs17:CS1702002A_S1");

	tit_callService(
        ""
        , ""
        , "ds_cond=ds_cond"
        , "ds_bsu=ds_bsu"
        , ""
        , "fn_query"
        , true
        , true
        , true	
        );
}
function ufn_chgBsu(){
	tit_clearActionInfo();
	tit_addSearchActionInfo("cs17:CS1702002A_S7");
	tit_addSearchActionInfo("cs17:CS1702002A_S2");
	tit_addSearchActionInfo("cs17:CS1702002A_S3");

	tit_callService(
        ""
        , ""
        , ""
        , "ds_bpm=ds_bpm ds_juj=ds_juj ds_buj=ds_buj"
        , "BSU="+quote(cb_bsu.Value)
        , "ufn_afterChgBsu"
        , true
        , true
        , true
        );
}
function ufn_afterChgBsu(){
	for(var i=0; i<ds_list.RowCount(); i++) {
		ds_list.SetColumn(i, "BPM", ds_bpm.GetColumn(0, "BPM"));
		ds_list.SetColumn(i, "BPMTEXT", ds_bpm.GetColumn(0, "BPMTEXT"));
	}
}

//=========================================================================================
// [ PART 6 ]
// component Event 정의 : 각 Component 별 이벤트
//=========================================================================================
/********************************************************************************
* 기      능   : 데이터셋 값 변경 시 - Flag 처리
********************************************************************************/
function ds_list_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{
	gfn_changeFlag( obj, strColumnID, nRow, "FLAG" );
	
	var str = substr(varNewValue, 0, 1);
	if(strColumnID == "HNO" && varNewValue != ""){
//		if(!(str=="L" || str=="S" || str=="W" || str=="J" || str=="G")){
		// 물류 분사 G 호기 생성 불가 
		// 물류 분사 PSD 트랜젝션 제어 20170831 *****//
		if(!(str=="L" || str=="S" || str=="W" || str=="J" )){
			if( str=="G"){
				gfn_showAlert("CW00246");
			} else {
				gfn_showAlert("CW00247");
			}
			// CW00112 -->> CW00247 
			// gfn_showAlert("CW00112");
			ds_list.FireEvent=false;
			ds_list.SetColumn(nRow, "HNO", "");
			ds_list.FireEvent=true;
			ed_hno.SetFocus();
		} else {
			gfn_clearMsgBar();
		}
		if(length(trim(varNewValue)) < 3){
			gfn_showAlert("CW00237");
			ds_list.FireEvent=false;
			ds_list.SetColumn(nRow, "HNO", "");
			ds_list.FireEvent=true;
			ed_hno.SetFocus();
		} else {
			gfn_clearMsgBar();
		}
	}	
}

function grd_list_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
{
	if ( nCell == 0 ){
		// 그리드 표시할 컬럼 선택 
		//gfn_selectGridCol(obj);
		for(var i=0; i<ds_list.RowCount(); i++) {
			if(ds_list.GetColumn(i, "PST") != "A6"){		
				ds_list.SetColumn(i, "CHECK", true);
			}
		}	
	}else{
		// 그리드 정렬 처리 
		gfn_sortGrid(obj,nCell);
	}
}]]></Script>
</Window>