<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form DropMode="TRUE" Height="268" Id="WB0199021G" Left="8" OnKeyDown="gfn_EnterInForm" OnLoadCompleted="fn_OnLoadCompleted" OnUnloadCompleted="fn_OnUnloadCompleted" PidAttrib="7" Title="사용자신청정보" Top="8" Ver="1.0" Width="565" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_master">
				<Contents>
					<colinfo id="COMP_YN" size="1" summ="default" type="STRING"/>
					<colinfo id="APP_DT" size="20" summ="default" type="STRING"/>
					<colinfo id="APP_NM" size="30" summ="default" type="STRING"/>
					<colinfo id="REG_DT" size="20" summ="default" type="STRING"/>
					<colinfo id="REG_NM" size="30" summ="default" type="STRING"/>
					<colinfo id="REG_RM" size="200" summ="default" type="STRING"/>
					<colinfo id="SMATRY" size="30" summ="default" type="STRING"/>
					<colinfo id="REGDPT" size="1" summ="default" type="STRING"/>
					<colinfo id="USERMAIL" size="150" summ="default" type="STRING"/>
					<colinfo id="USERMBPN" size="60" summ="default" type="STRING"/>
					<colinfo id="USERTELE" size="60" summ="default" type="STRING"/>
					<colinfo id="USERCODE" size="30" summ="default" type="STRING"/>
					<colinfo id="USERNAME" size="90" summ="default" type="STRING"/>
					<colinfo id="USERNUMB" size="30" summ="default" type="STRING"/>
					<colinfo id="USERGBN" size="1" summ="default" type="STRING"/>
					<colinfo id="MANDT" size="256" summ="default" type="STRING"/>
					<colinfo id="TEMP" size="256" summ="default" type="STRING"/>
					<colinfo id="USERTEAM" size="256" summ="default" type="STRING"/>
					<colinfo id="TEMP_ST" size="256" summ="default" type="STRING"/>
					<colinfo id="BIRTH" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_dpt_cd">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME></CODE_NAME>
					</record>
					<record>
						<CODE>R</CODE>
						<CODE_NAME>보수</CODE_NAME>
					</record>
					<record>
						<CODE>B</CODE>
						<CODE_NAME>영업</CODE_NAME>
					</record>
					<record>
						<CODE>M</CODE>
						<CODE_NAME>자재</CODE_NAME>
					</record>
					<record>
						<CODE>E</CODE>
						<CODE_NAME>설치</CODE_NAME>
					</record>
					<record>
						<CODE>P</CODE>
						<CODE_NAME>생산</CODE_NAME>
					</record>
					<record>
						<CODE>D</CODE>
						<CODE_NAME>설계</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_email">
				<Contents>
					<colinfo id="EMAIL_CNT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond">
				<Contents>
					<colinfo id="USERCODE" size="255" summ="default" type="STRING"/>
					<colinfo id="USERNAME" size="255" summ="default" type="STRING"/>
					<colinfo id="USERNUMB" size="255" summ="default" type="STRING"/>
					<colinfo id="BIRTH" size="256" summ="default" type="STRING"/>
					<record>
						<BIRTH></BIRTH>
						<USERCODE></USERCODE>
						<USERNAME></USERNAME>
						<USERNUMB></USERNUMB>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_email_sub">
				<Contents>
					<colinfo id="USERMAIL" size="256" summ="default" type="STRING"/>
					<record>
						<USERMAIL></USERMAIL>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_vkgrp">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_numb">
				<Contents>
					<colinfo id="NUMB_CNT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_smat">
				<Contents>
					<colinfo id="SMAT_CNT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
		</Datasets>
		<Shape BKColor="user12" Bottom="195" Height="26" Id="Shape2" Left="8" LineColor="user13" Right="557" TabOrder="5" Top="169" Type="Rectangle" Width="549"></Shape>
		<Static Font="Default,8" Height="24" Id="Radm" Left="208" TabOrder="34" Text="담당자&#32;:&#32;한정훈DL" Top="177" Visible="FALSE" Width="176"></Static>
		<Static Font="Default,8" Height="24" Id="Badm" Left="208" TabOrder="35" Text="담당자&#32;:&#32;오서택SW" Top="177" Visible="FALSE" Width="176"></Static>
		<Static Font="Default,8" Height="24" Id="Madm" Left="208" TabOrder="36" Text="담당자&#32;:&#32;정연재SW" Top="177" Visible="FALSE" Width="176"></Static>
		<Static Font="Default,8" Height="24" Id="Eadm" Left="208" TabOrder="37" Text="담당자&#32;:&#32;송광용DL" Top="177" Visible="FALSE" Width="176"></Static>
		<Static Font="Default,8" Height="24" Id="Padm" Left="208" TabOrder="45" Text="담당자&#32;:&#32;이석재SW" Top="177" Visible="FALSE" Width="176"></Static>
		<Static Font="Default,8" Height="24" Id="Dadm" Left="208" TabOrder="46" Text="담당자&#32;:&#32;정기혁SW" Top="177" Visible="FALSE" Width="176"></Static>
		<Shape BKColor="user12" Bottom="70" Height="26" Id="Shape8" Left="8" LineColor="user13" Right="557" TabOrder="39" Top="44" Type="Rectangle" Width="549"></Shape>
		<Shape BKColor="user12" Bottom="95" Height="26" Id="Shape3" Left="8" LineColor="user13" Right="557" TabOrder="14" Top="69" Type="Rectangle" Width="549"></Shape>
		<Shape BKColor="user12" Bottom="170" Height="26" Id="Shape0" Left="8" LineColor="user13" Right="557" TabOrder="11" Top="144" Type="Rectangle" Width="549"></Shape>
		<Shape BKColor="user12" Bottom="120" Height="26" Id="Shape5" Left="8" LineColor="user13" Right="557" TabOrder="1" Top="94" Type="Rectangle" Width="549"></Shape>
		<Shape BKColor="user12" Bottom="145" Height="26" Id="Shape6" Left="8" LineColor="user13" Right="557" TabOrder="1" Top="119" Type="Rectangle" Width="549"></Shape>
		<Shape BKColor="user12" Bottom="145" Height="26" Id="Shape4" Left="8" LineColor="user13" Right="557" TabOrder="1" Top="119" Type="Rectangle" Width="549"></Shape>
		<Static Align="Right" Height="24" Id="st_userName" Left="9" Style="sty_lb_form_basic" TabOrder="1" Text="사용자명" Top="95" VAlign="Middle" Width="100"></Static>
		<Static Align="Right" Height="24" Id="st_userNumb" Left="297" Style="sty_lb_form_basic" TabOrder="1" Text="사번" Top="95" VAlign="Middle" Width="55"></Static>
		<Static Align="Right" Height="24" Id="st_tele" Left="60" Style="sty_lb_form_detail" TabOrder="1" Text="TEL&#32;" Top="120" VAlign="Middle" Width="49"></Static>
		<Static Align="Right" Height="24" Id="st_userMail" Left="60" Style="sty_lb_form_detail" TabOrder="1" Text="E-Mail&#32;" Top="146" VAlign="Middle" Width="49"></Static>
		<Static Align="Right" Height="24" Id="st_userMbpn" Left="297" Style="sty_lb_form_detail" TabOrder="1" Text="H.P" Top="120" VAlign="Middle" Width="55"></Static>
		<Static Align="Center" Height="49" Id="Static17" Left="9" Style="sty_lb_form_basic" TabOrder="4" Text="연락처&#32;" Top="120" VAlign="Middle" Width="51"></Static>
		<Static Align="Right" Height="24" Id="st_regDpt" Left="9" Style="sty_lb_form_basic" TabOrder="6" Text="담당업무" Top="170" VAlign="Middle" Width="100"></Static>
		<Static Align="Right" Height="24" Id="st_pSearch2" Left="9" Style="sty_lb_form_basic" TabOrder="13" Text="부서/업체" Top="70" VAlign="Middle" Width="100"></Static>
		<Static Font="Default,8" Height="24" Id="Static1" Left="478" TabOrder="15" Text="*&#32;직원만&#32;입력" Top="103" Width="77"></Static>
		<Shape BKColor="user12" Bottom="220" Height="26" Id="Shape1" Left="8" LineColor="user13" Right="557" TabOrder="16" Top="194" Type="Rectangle" Width="549"></Shape>
		<Static Align="Right" Height="24" Id="st_smaTry" Left="9" Style="sty_lb_form_basic" TabOrder="17" Text="동일권한자" Top="195" VAlign="Middle" Width="100"></Static>
		<Shape BKColor="user12" Bottom="245" Height="26" Id="Shape7" Left="8" LineColor="user13" Right="557" TabOrder="18" Top="219" Type="Rectangle" Width="549"></Shape>
		<Static Align="Right" Height="24" Id="Static3" Left="9" Style="sty_lb_form_basic" TabOrder="19" Text="추가요청사항" Top="220" VAlign="Middle" Width="100"></Static>
		<Static Font="Default,8" Height="24" Id="Static4" Left="256" TabOrder="20" Text="*&#32;직원만&#32;입력(사번&#32;입력)" Top="202" Width="136"></Static>
		<Static Font="Default,8" Height="24" Id="Static5" Left="16" TabOrder="21" Text="*&#32;문의사항은&#32;해당&#32;담당자에게&#32;연락&#32;바랍니다." Top="249" Width="224"></Static>
		<Radio BindDataset="ds_master" BKColor="user0" Column="USERGBN" Font="굴림,9" Height="24" Id="rd_chk" INDEX="0" Left="111" OnChanged="rd_chk_OnChanged" Style="sty_ipt_form_radio" TabOrder="32" Top="45" Value="1" Width="163">
			<Contents>
				<Layout code="1" height="20" left="10" text="사내직원" top="0" width="80"/>
				<Layout code="2" height="20" left="90" text="협력사" top="0" width="60"/>
			</Contents>
		</Radio>
		<Edit BindDataset="ds_master" Border="Flat" CheckLength="Byte" Column="REG_RM" Height="20" Id="ed_reg_rm" ImeMode="english" Left="111" LeftMargin="4" MaxLength="50" RightMargin="4" Style="sty_ipt_form" TabOrder="31" Top="222" Width="401"></Edit>
		<Edit BindDataset="ds_master" Border="Flat" CheckLength="Byte" Column="SMATRY" Height="20" Id="ed_Smatry" ImeMode="english" Left="111" LeftMargin="4" MaxLength="7" Number="TRUE" OnCharChanged="ed_Smatry_OnCharChanged" RightMargin="4" Style="sty_ipt_form" TabOrder="30" Top="197" Width="89"></Edit>
		<Combo BindDataset="ds_master" Border="Flat" CodeColumn="CODE" Column="REGDPT" DataColumn="CODE_NAME" Height="20" Id="cb_dpt" InnerDataset="ds_dpt_cd" Left="110" OnChanged="cb_dpt_OnChanged" Style="sty_ipt_form" TabOrder="29" Top="171" Width="92"></Combo>
		<Edit BindDataset="ds_master" Border="Flat" CheckLength="Byte" Column="USERMAIL" Height="20" Id="ed_userMail" ImeMode="english" Left="111" LeftMargin="4" LowerOnly="TRUE" MaxLength="50" RightMargin="4" Style="sty_ipt_form" TabOrder="27" Top="147" Width="185"></Edit>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_overlabChk" ImageID="btn_sub_04" ImageStatus="PUSH" Left="298" LeftMargin="12" OnClick="fn_emailCheck" Style="sty_btn" TabOrder="28" Text="중복확인" Top="147" Transparent="TRUE" Width="71"></Button>
		<Edit BindDataset="ds_master" Border="Flat" CheckLength="Byte" Column="USERNUMB" Height="20" Id="ed_userNumb" ImeMode="english" Left="354" LeftMargin="4" MaxLength="7" RightMargin="4" Style="sty_ipt_form" TabOrder="24" Top="97" Width="118"></Edit>
		<Edit BindDataset="ds_master" Border="Flat" CheckLength="Byte" Column="USERMBPN" Height="20" Id="ed_userMbpn" ImeMode="english" Left="354" LeftMargin="4" MaxLength="11" OnChar="ed_userTele_OnChar" OnFocus="ed_userTele_OnFocus" OnKillFocus="ed_userMbpn_OnKillFocus" RightMargin="4" Style="sty_ipt_form" TabOrder="26" Top="122" Width="118"></Edit>
		<Edit BindDataset="ds_master" Border="Flat" CheckLength="Byte" Column="USERTELE" Height="20" Id="ed_userTele" ImeMode="english" Left="111" LeftMargin="4" MaxLength="11" OnChar="ed_userTele_OnChar" OnFocus="ed_userTele_OnFocus" OnKillFocus="ed_userTele_OnKillFocus" RightMargin="4" Style="sty_ipt_form" TabOrder="25" Top="122" Width="118"></Edit>
		<Edit BindDataset="ds_master" Border="Flat" CheckLength="Byte" Column="USERNAME" Height="20" Id="ed_userName" ImeMode="native" Left="111" LeftMargin="4" MaxLength="30" RightMargin="4" Style="sty_ipt_form" TabOrder="23" Top="97" Width="118"></Edit>
		<Edit BindDataset="ds_cond" Border="Flat" CheckLength="Byte" Column="USERCODE" Height="20" Id="ed_userCode_s" ImeMode="english" Left="111" LeftMargin="4" MaxLength="10" Readonly="TRUE" RightMargin="4" Style="sty_ipt_form_ind" TabOrder="33" TabStop="FALSE" Top="72" UpperOnly="TRUE" Width="160"></Edit>
		<Button Cursor="HAND" Enable="FALSE" Height="18" Id="btn_pSearch" ImageID="btn_icon_search" Left="272" OnClick="btn_pSearch_OnClick" TabOrder="22" Text="Button0" Top="73" Width="18"></Button>
		<Static Align="Right" Height="24" Id="Static0" Left="9" Style="sty_lb_form_basic" TabOrder="38" Text="신청자&#32;구분" Top="45" VAlign="Middle" Width="100"></Static>
		<Static Height="13" Id="st_title" Left="64" TabOrder="40" Text="사용자&#32;신청&#32;정보" Top="328" Visible="FALSE" Width="40"></Static>
		<Div Height="36" Id="div_btn" TabOrder="41" Text="Div0" Url="WB01::CommBtnForm.xml" Width="565">
			<Contents></Contents>
		</Div>
		<Static Font="Default,8" Height="24" Id="Static2" Left="280" TabOrder="42" Text="*&#32;구분을&#32;선택하세요." Top="52" Width="136"></Static>
		<Combo BindDataset="ds_master" Border="Flat" CodeColumn="CODE" Column="USERTEAM" DataColumn="CODE_NAME" Height="20" Id="cb_vkgrp" InnerDataset="ds_vkgrp" Left="417" Style="sty_ipt_form" TabOrder="43" Top="172" Visible="FALSE" Width="137"></Combo>
		<Static Align="Right" Height="24" Id="st_vkgrp" Left="316" Style="sty_lb_form_basic" TabOrder="44" Text="영업팀코드" Top="170" VAlign="Middle" Visible="FALSE" Width="100"></Static>
		<Button ButtonStyle="TRUE" Cursor="HAND" Enable="FALSE" Height="20" Id="btn_memberChk" ImageID="btn_sub_02" ImageStatus="PUSH" Left="202" LeftMargin="12" OnClick="btn_memberChk_OnClick" Style="sty_btn" TabOrder="47" Text="확인" Top="197" Transparent="TRUE" Width="54"></Button>
		<Static Align="Right" Height="24" Id="Static6" Left="372" Style="sty_lb_form_detail" TabOrder="48" Text="생년월일&#32;" Top="145" VAlign="Middle" Width="79"></Static>
		<Calendar BindDataset="ds_master" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="BIRTH" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_birth" Left="455" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_search" SundayTextColor="user35" TabOrder="49" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="147" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="97"></Calendar>
	</Form>
	<Script><![CDATA[/*
 ******************************************************************************************
 * 기      능   : 사용자 정보 입력 - 일반 사용자 용 
 * 작  성  자   : 
 * 작성  일자   : 
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
#include "LIB::commons.js";	// 공통 스크립트 
#include "LIB::utility.js";	// 다중 선택 
//=========================================================================================
// [ PART 1 ]
// Form에서 사용될 전역변수를 선언
// FORM에서 사용되는 전역변수는 대문자로 작성하며, F_XXX 의 형태를 갖도록 한다. 
//=========================================================================================

//=========================================================================================
// [ PART 2 ]
// Form Loading / Unloading 시 작업 정의
//=========================================================================================
function fn_OnLoadCompleted(obj) {
	// Form 로드 이벤트 맨 첫줄에 기술 
	gfn_initFormNotAuth("WB0199021G", st_title.value, "30");
	ds_master.AddRow();
	cb_dpt.Index = 0;
	
	btn_pSearch.Enable = false;
	ed_userCode_s.Enable = false;
	ed_userName.Enable = false;
	ed_userNumb.Enable = false;
	ed_userTele.Enable = false;
	ed_userMbpn.Enable = false;
	ed_userMail.Enable = false;
	btn_overlabChk.Enable = false;
	cb_dpt.Enable = false;
	ed_Smatry.Enable = false;
	ed_reg_rm.Enable = false;
	cal_birth.Enable = false;
	
	// fn_query();
	if(G_USER_ID > '700000') {
		rd_chk.Index = '1';
		rd_chk.Enable = false;
		
		btn_pSearch.Enable = true;
		ed_userCode_s.Enable = true;
		ed_userName.Enable = true;
		ed_userNumb.Enable = false;
		ed_userTele.Enable = true;
		ed_userMbpn.Enable = true;
		ed_userMail.Enable = true;
		btn_overlabChk.Enable = true;
		cb_dpt.Enable = true;
		ed_Smatry.Enable = false;
		ed_Smatry.Value = null;
		ed_reg_rm.Enable = true;
		ds_master.SetColumn(0,"TEMP","");
		ds_master.SetColumn(0,"TEMP_ST","");
		cal_birth.Enable = true;
		
		cb_dpt.Value = "E";
		cb_dpt.Enable = false;
		Radm.Visible = false;
		Badm.Visible = false;
		Madm.Visible = false;
		Eadm.Visible = true;
		Padm.visible = false;
		Dadm.Visible = false;
		st_vkgrp.Visible = false;
		cb_vkgrp.Visible = false;
	}
	
	fn_searchCode();
	// Form 로드 이벤트 맨 첫줄에 기술   
	
		tit_clearActionInfo();
		
		tit_addSingleActionInfo("wb01:WB0199021G_S2");
		
		tit_callService(
			""
			, ""
			, "ds_master=ds_master"
			, "ds_email_sub=ds_email_sub"
			, ""
			, ""
			, true);
			
		
}
/********************************************************************************
* 기      능   : 공통코드가 조회된 후의 Callback 함수 
********************************************************************************/
function fn_completeInit(sCode, sDsObj, sCodeType) {

}
/********************************************************************************
* 기      능   : form UnloadCompleted 
********************************************************************************/
function fn_OnUnloadCompleted(obj) {

}
//=========================================================================================
// [ PART 3 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,form닫기)
//=========================================================================================
/********************************************************************************
* 기      능   : 조회 
********************************************************************************/
function fn_query() {
	// tit_clearActionInfo();
	// tit_addSearchActionInfo("wb01:WB0199021A_S1");
	
	// tit_callService(
        // ""
        // , ""
        // , ""
        // , "ds_master=ds_list"
        // , "USER_ID=" + quote( G_USER_ID )
        // , "fn_afterQuery"
        // , true
        // , true);	
}
/********************************************************************************
* 기      능   : 저장  
********************************************************************************/

//var _ENC_PWD = "";

	//trace(ds_master.saveXML()); //Output에 저장DB 확인

	// 변경 정보 
	
	// 사용명 
	// if( gfn_isNull(ed_userName, true, st_userName.value) ) {
		// return;
	// }
	function fn_save() {
		
	// CHECK 로직
		if(ds_master.GetColumn(0,"USERGBN") == null ){
			gfn_showAlert("CW00001",'신청자 구분' );
			return;
		}
		if(ds_master.GetColumn(0,"USERCODE") == null ){
			gfn_showAlert("CW00001",st_pSearch2.value );
			return;
		}
		if(length(ds_master.GetColumn(0,"USERNAME")) < 2 ){
			gfn_showAlert("CW00001",st_userName.value );
			ed_userName.SetFocus();
			return;
		}
		if(length(ds_master.GetColumn(0,"USERNUMB")) != 7 && ds_master.GetColumn(0,"USERGBN") == 1 ){
			gfn_showAlert("CW00001",st_userNumb.value );
			ed_userNumb.SetFocus();
			return;
		}
		if(ds_master.GetColumn(0,"USERMBPN") == null || ds_master.GetColumn(0,"USERMBPN") == "" ){
			gfn_showAlert("CW00001",st_userMbpn.value );
			ed_userMbpn.SetFocus();
			return;
		}
		if(length(ds_master.GetColumn(0,"USERMAIL")) < 10 ){
			gfn_showAlert("CW00001",st_userMail.value );
			ed_userMail.SetFocus();
			return;
		}
		if(ds_master.GetColumn(0,"REGDPT") == "" ){
			gfn_showAlert("CW00001",st_regDpt.value );
			cb_dpt.SetFocus();
			return;
		}
		if(ds_master.GetColumn(0,"TEMP") != "Y"){
			gfn_showAlert("E-mail 중복확인 바랍니다.");
			return;
		} 	
		if(length(ed_Smatry.value) > 0 && length(ed_Smatry.value) < 7){
			gfn_showAlert("동일권한자 사번은 7자리 입니다.");
			return;
		}
		if(length(ed_smatry.value) = 7 && (ds_master.GetColumn(0,"TEMP_ST") != "Y")){
			gfn_showAlert("동일권한자 확인 체크 바랍니다.");
			return;
		}
		
		if(length(Trim(cal_birth.Value)) != 8 && cb_dpt.Value == 'E' && rd_chk.Index == '1')	// 설치 협력사이고, 생년월일이 8자리 입력 안되어있으면
		{
			gfn_OpenMsgWin("설치협력사 인원의 경우\n생년월일은 필수입력사항입니다.");
			return;
		}
		
		if(!gfn_showConfirm("CI00008")) {
			return;
		}
		
		tit_clearActionInfo();
		
		tit_addSingleActionInfo("wb01:WB0199021G_I1");
		
		tit_callService(
			""
			, ""
			, "ds_master=ds_master"
			, ""
			, ""
			, "fn_afterSave"
			, true);
		//=====================업무담당자에게 메일 전송====================
	var body;
	var title;
	var zkun_email;
	//trace(ds_header.savexml());
	
	if(cb_dpt.Value == "R") {
		zkun_email = "junghoon.han@hdel.co.kr";
	}else if(cb_dpt.Value == "B") {
		zkun_email = "Seotaek.Oh@hdel.co.kr";
	}else if(cb_dpt.Value == "M") {
		zkun_email = "yj.jung@hdel.co.kr";
	}else if(cb_dpt.Value == "P") {
		zkun_email = "sjlee@hdel.co.kr";
	}else if(cb_dpt.Value == "D") {
		zkun_email = "kihyuck.jung@hdel.co.kr";
	}else {
		zkun_email = "kwangyong.song@hdel.co.kr";
	}
	
	
	//zkun_email = ds_master.GetColumn(0,"USERMAIL");
	
	//trace(zkun_email);
	title = "SRM ID 신청접수";
	body = ed_userName.text + "님의 SRM ID 신청이 접수 되었습니다.\n확인 후 처리 바랍니다."
		+ "\n감사합니다.\n" ;
	body = body + " 발송일 : " + gfn_getCurrDate();    
			    
		tit_clearActionInfo();	
		tit_callService(
			"COMM_ACT"
			, "sendmail"
			, ""
			, ""
			//, "USER_JUMIN=" + quote(med_jumin1.value+med_jumin2.value)
			//	+ 
			," SEND_USER=ADMIN@HDEL.CO.KR"
				//+ " RECE_USER=SK.KANG@HDEL.CO.KR"
				+ " RECE_USER=" + quote( zkun_email )  
				+ " MESGTITL=" + quote( title ) 
				+ " MESGBODY=" + quote( body ) 
			, ""  //"fn_afterQuery"
			, false
			, true);				
	    //=====================메일끝====================	      
	    
	//=====================신청자에게 메일 전송====================
	var body1;
	var title1;
	var zkun_email1;
	
	zkun_email1 = ds_master.GetColumn(0,"USERMAIL");
	
	title1 = "SRM ID 신청접수 완료";
	body1 = "안녕하십니까. SRM 시스템관리자 입니다.\n" + ed_userName.text + "님의 SRM ID 신청접수가 완료 되었습니다.\n등록 완료 시 E-mail 발송 됩니다.\n감사합니다." ;
	body1 = body1 + " 발송일 : " + gfn_getCurrDate();    
			    
		tit_clearActionInfo();	
		tit_callService(
			"COMM_ACT"
			, "sendmail"
			, ""
			, ""
			," SEND_USER=ADMIN@HDEL.CO.KR"
				+ " RECE_USER=" + quote( zkun_email1 )  
				+ " MESGTITL=" + quote( title1 ) 
				+ " MESGBODY=" + quote( body1 ) 
			, ""
			, false
			, true);				
	    //=====================메일끝====================	 
	         
	//=====================요청자에게 메일 전송====================
	var body2;
	var title2;
	var zkun_email2;
	
	zkun_email2 = ds_email_sub.GetColumn(0,"USERMAIL");
	
	title2 = "SRM ID 신청접수 완료";
	body2 = "안녕하십니까. SRM 시스템관리자 입니다.\n" + ed_userName.text + "님의 SRM ID 신청접수가 완료 되었습니다.\n등록 완료 시 E-mail 발송 됩니다.\n감사합니다." ;
	body2 = body2 + " 발송일 : " + gfn_getCurrDate();    
			    
		tit_clearActionInfo();	
		tit_callService(
			"COMM_ACT"
			, "sendmail"
			, ""
			, ""
			," SEND_USER=ADMIN@HDEL.CO.KR"
				+ " RECE_USER=" + quote( zkun_email2 )  
				+ " MESGTITL=" + quote( title2 ) 
				+ " MESGBODY=" + quote( body2 ) 
			, ""
			, false
			, true);				
	    //=====================메일끝====================	 
	 
	//=====================업무담당자에게 메일 전송====================
	var body4;
	var title4;
	var zkun_email4;

	if(cb_dpt.Value == "R") {
		for (var i = 0; i < 2; i++){
			if (i == 0){
				zkun_email4 = "gitae.bang@hdel.co.kr";
			} else if (i == 1){
				zkun_email4 = "dkyjn6939@hdel.co.kr";
			}
			
		title4 = "SRM ID 신청접수";
		body4 = ed_userName.text + "님의 SRM ID 신청이 접수 되었습니다.\n확인 후 처리 바랍니다."
			+ "\n감사합니다.\n" ;
		body4 = body4 + " 발송일 : " + gfn_getCurrDate();    
				
		tit_clearActionInfo();	
		tit_callService(
	  		  "COMM_ACT"
			, "sendmail"
			, ""
			, ""
			," SEND_USER=ADMIN@HDEL.CO.KR"
				+ " RECE_USER=" + quote( zkun_email4 )  
				+ " MESGTITL=" + quote( title4 ) 
				+ " MESGBODY=" + quote( body4 ) 
			, ""
			, false
			, true);	
		}
	}
	//=====================메일끝====================	 
	//=====================업무담당자에게 메일 전송====================
	var body5;
	var title5;
	var zkun_email5;

	if(cb_dpt.Value == "B") {
		for (var i = 0; i < 2; i++){
			if (i == 0){
				zkun_email5 = "MJ.SHIN@hdel.co.kr";
			} else if (i == 1){
				zkun_email5 = "eunha.kim@hdel.co.kr";
			}
			

		title5 = "SRM ID 신청접수";
		body5 = ed_userName.text + "님의 SRM ID 신청이 접수 되었습니다.\n확인 후 처리 바랍니다."
			+ "\n감사합니다.\n" ;
		body5 = body5 + " 발송일 : " + gfn_getCurrDate();    
				
		tit_clearActionInfo();	
		tit_callService(
	  		  "COMM_ACT"
			, "sendmail"
			, ""
			, ""
			," SEND_USER=ADMIN@HDEL.CO.KR"
				+ " RECE_USER=" + quote( zkun_email5 )  
				+ " MESGTITL=" + quote( title5 ) 
				+ " MESGBODY=" + quote( body5 ) 
			, ""
			, false
			, true);
		}
	}
	//=====================메일끝====================
}
/********************************************************************************
* 기      능   : 닫기   
********************************************************************************/
function fn_close() {
	close();
}
//=========================================================================================
// [ PART 4]
// Callback 함수 정의 : callback 함수명은 메인 함수의 fn_xxxx() 에서 xxxx 부분은 fn_afterXXXX()
// 형태가 되도록 작성 
//=========================================================================================
/********************************************************************************
* 기      능   : 저장 Callback  
********************************************************************************/
function fn_afterSave(errCode, errMsg) {
	// gfn_showMsg("CI00003");
	// }
	if ( errCode!= 0 ) {
		gfn_showMsg("CE00001");
	} else {
		gfn_showMsg("CI00003");
		ds_master.ClearData();
		ds_cond.ClearData();
		
		btn_pSearch.Enable = false;
		ed_userCode_s.Enable = false;
		ed_userName.Enable = false;
		ed_userNumb.Enable = false;
		ed_userTele.Enable = false;
		ed_userMbpn.Enable = false;
		ed_userMail.Enable = false;
		btn_overlabChk.Enable = false;
		cb_dpt.Enable = false;
		ed_Smatry.Enable = false;
		ed_reg_rm.Enable = false;
		
		Radm.Visible = false;
		Badm.Visible = false;
		Madm.Visible = false;
		Eadm.Visible = false;
		Padm.Visible = false;
		Dadm.Visible = false;
		
		ds_master.AddRow();
	}
}
//=========================================================================================
// [ PART 5 ]
// Detail Process Event 정의 ( User Define function )
// 사용자 정의 함수는 ufn_xxxx() 형태로 작성 
//=========================================================================================

//=========================================================================================
// [ PART 6 ]
// component Event 정의 : 각 Component 별 이벤트 
//=========================================================================================
/********************************************************************************
* 기      능   :  휴대폰, 전화번호 입력 가능 글자 유무 확인 
********************************************************************************/
function ed_userTele_OnChar(obj,strPreText,nChar,strPostText,LLParam,HLParam)
{
	return gfn_canInputTelNo(obj, nChar,LLParam,HLParam );
}
/********************************************************************************
* 기      능   :  휴대폰, 전화번호focus 왔을 경우 
********************************************************************************/
function ed_userTele_OnFocus(obj)
{
	gfn_setFocusTelNo(obj);
}
/********************************************************************************
* 기      능   :  전화번호focus 잃을 경우 
********************************************************************************/
function ed_userTele_OnKillFocus(obj)
{
	if ( obj.value == "" ) {
		return;
	}
	
	obj.value = gfn_formatTelNo2( obj.value, obj);
	if ( length( obj.value ) == 0 ) {
		gfn_showMsg("CW00037", st_tele.value);
		obj.setFocus();
	}
}
/******************************************************
*  전화번호 Format 처리  
* @param  telStr  전화번호 String 
* @param  telObj  전화번호 입력 객체 명 
* @return  전화번호가 올바를 경우 "-" 가 들어간 전화번호 String 
*******************************************************/
function gfn_formatTelNo2( telStr, telObj) {
    telStr = replace( telStr, "-", "");
	var len = length( telStr );

	// 7, 8 자리이면 기본적으로 02 로 설정 
	if ( len == 7 && left( telStr, 1 ) != "0") {
		return "02-" + left( telStr , 3 ) + "-" + substr(telStr, 3 );
	} else if ( len == 8 && left( telStr, 1 ) != "0" ) {
		return "02-" + left( telStr , 4 ) + "-" + substr(telStr, 4 );
	}

	if ( len < 9 || len > 11 ) {
		// 형식이 올바르지 않음. 
		return "";
	}
	
	if ( len == 12 ) {
        return telStr;
	}
	
	var startStr = fn_checkTelNo2(telStr);

	// 잘못된 경우 지움. 
	if ( length (startStr) == 0 ) {
		return "";
	}
	
	if ( startStr == "02" &&  len == 11 ) {
		return "";
	}
	
	return startStr + "-" 
		+ substr(telStr, length(startStr), len-4-length(startStr) )
		+ "-" + right( telStr, 4 );
}
/******************************************************
*  전화번호 앞자리 확인 
* @param  telStr  전화번호 String 
* @return  전화번호 앞자리 
*******************************************************/
function fn_checkTelNo2(telNo) {
	if ( left( telNo, 2 ) == "02") {
		return left( telNo, 2 ) ;
	}
	
	var fullStr = "02,031,032,033,041,042,043,044,051,052,053,054,055,061,062,063,064,070";
	
	var str = left( telNo, 3 );
	
	if ( indexOf( fullStr, str ) != -1 ) {
		return str;
	}
	return "";
}
/********************************************************************************
* 기      능   :  휴대폰 focus 잃을 경우 
********************************************************************************/
function ed_userMbpn_OnKillFocus(obj)
{
	if ( obj.value == "" ) {
		return;
	}
	
	obj.value = gfn_formatHpNo( obj.value, obj);
	if ( length( obj.value ) == 0 ) {
		gfn_showMsg("CW00038", st_userMbpn.value);
		obj.setFocus();
	}
}
/********************************************************************************
* 기      능   :  Email 중복체크
********************************************************************************/
function fn_emailCheck()
{
	if(length(ds_master.GetColumn(0,"USERMAIL")) < 10 ){
			gfn_showAlert("CW00001",st_userMail.value );
			ed_userMail.SetFocus();
			return;
	}		//빈값 검사
	if( length(ed_userMail.value) > 0 ) {
		if ( !gfn_isValidEmail(ed_userMail.value) ) {
			gfn_showAlert("CW00038", st_userMail.value);
			ed_userMail.SetFocus();
			return;
		}
	}			//이메일 형식 체크
	if(length(ds_master.GetColumn(0,"USERNAME")) < 2 ){
			gfn_showAlert("CW00001",st_userName.value );
			return;
	}
	
	tit_clearActionInfo();
	tit_addSearchActionInfo("wb01:WB0199021G_S1");
	//tit_addSearchActionInfo("wb01:WB0199021G_S3");
	
	tit_callService(
        ""
        , ""
        , "ds_master=ds_master"
        , "ds_email=ds_email ds_numb=ds_numb"
        , ""
        , "fn_afterEmailCheck"
        , true);
}
/********************************************************************************
* 기      능   : Email 중복체크 Callback  
********************************************************************************/
function fn_afterEmailCheck()
{
	if(ds_numb.GetColumn(0, "NUMB_CNT") >= 1 ){
		gfn_showAlert("등록된 사번입니다.");
		ed_userNumb.SetFocus();
		return;
	}if(length(ds_master.GetColumn(0,"USERNUMB")) != 7 && ds_master.GetColumn(0,"USERGBN") == 1 ){
		gfn_showAlert("CW00001",st_userNumb.value );
		ed_userNumb.SetFocus();
		return;
	}else if(ds_email.GetColumn(0, "EMAIL_CNT") >= 1 ){
		gfn_showAlert("중복된 E-mail입니다.");
		ed_userMail.SetFocus();
		return;
	} else {
		gfn_showAlert("사용가능한 E-mail입니다.");
		ds_master.SetColumn(0,"TEMP","Y");
		ed_userName.Enable = false;
		ed_userMail.Enable = false;
		ed_userNumb.Enable = false;
	}
}
/********************************************************************************
* 기      능   : 동일권한자 체크 Callback  
********************************************************************************/
function fn_afterSmatryCheck()
{
	if(ds_smat.GetColumn(0, "SMAT_CNT") != 1 ){
		gfn_showAlert("동일권한자 정보가 올바르지 않습니다.");
		ed_Smatry.SetFocus();
		return;
	}else if(ed_Smatry!="" && ds_smat.GetColumn(0, "SMAT_CNT") == 1 ){
		gfn_showAlert("동일권한자가 확인되었습니다.");
		ds_master.SetColumn(0,"TEMP_ST","Y");
		ed_Smatry.Enable = false;
	}
}
/********************************************************************************
* 기      능   :  협력업체 찾기 
********************************************************************************/
function btn_pSearch_OnClick(obj)
{
	var arg = "comName=''";
	var rtn = gfn_openPopup("WB0101001C",true,arg);
	
	if ( rtn != null ) 
	{
		ds_master.setColumn(0, "USERCODE", rtn[0]);
		ed_userCode_s.value = rtn[1];
	}
}
/********************************************************************************
* 기      능   :  사내직원/협력업체 구분 
********************************************************************************/
function rd_chk_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	// 협력사 일 때 
	if(rd_chk.Index == "1"){
		btn_pSearch.Enable = true;
		ed_userCode_s.Enable = true;
		ed_userName.Enable = true;
		ed_userNumb.Enable = false;
		ed_userTele.Enable = true;
		ed_userMbpn.Enable = true;
		ed_userMail.Enable = true;
		btn_overlabChk.Enable = true;
		cb_dpt.Enable = true;
		ed_Smatry.Enable = false;
		ed_Smatry.Value = null;
		ed_reg_rm.Enable = true;
		ds_master.SetColumn(0,"TEMP","");
		ds_master.SetColumn(0,"TEMP_ST","");
		cal_birth.Enable = true;
	}
	 // 사내직원 일 때 
	 else {
		btn_pSearch.Enable = true;
		ed_userCode_s.Enable = true;
		ed_userName.Enable = true;
		ed_userNumb.Enable = true;
		ed_userTele.Enable = true;
		ed_userMbpn.Enable = true;
		ed_userMail.Enable = true;
		btn_overlabChk.Enable = true;
		cb_dpt.Enable = true;
		ed_Smatry.Enable = true;
		ed_reg_rm.Enable = true;
		ds_master.SetColumn(0,"TEMP","");
		ds_master.SetColumn(0,"TEMP_ST","");
		cal_birth.Enable = true;
	}
}
/********************************************************************************
* 기      능   :  사용자명/E-mail 공백 Check
********************************************************************************/
function btn_overlabChk_OnClick(obj)
{
	if( ed_userName = "" OR ed_userMail = "" )
	{
		gfn_showAlert("사용자명/E-Mail 입력 바랍니다.");
	} else {
			fn_emailCheck();
	}	
}
/********************************************************************************
* 기      능   :  담당처리자 알림
********************************************************************************/
function cb_dpt_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	if(cb_dpt.Value == "R") {
		Radm.Visible = true;
		Badm.Visible = false;
		Madm.Visible = false;
		Eadm.Visible = false;
		Padm.visible = false;
		Dadm.Visible = false;
		st_vkgrp.Visible = true;
		cb_vkgrp.Visible = true;
	} else if(cb_dpt.Value == "B") {
		Radm.Visible = false;
		Badm.Visible = true;
		Madm.Visible = false;
		Eadm.Visible = false;
		Padm.visible = false;
		Dadm.Visible = false;
		st_vkgrp.Visible = false;
		cb_vkgrp.Visible = false;
	} else if(cb_dpt.Value == "M") {
		Radm.Visible = false;
		Badm.Visible = false;
		Madm.Visible = true;
		Eadm.Visible = false;
		Padm.visible = false;
		Dadm.Visible = false;
		st_vkgrp.Visible = false;
		cb_vkgrp.Visible = false;
	} else if(cb_dpt.Value == "E") {
		Radm.Visible = false;
		Badm.Visible = false;
		Madm.Visible = false;
		Eadm.Visible = true;
		Padm.visible = false;
		Dadm.Visible = false;
		st_vkgrp.Visible = false;
		cb_vkgrp.Visible = false;
	} else if(cb_dpt.Value == "P") {
		Radm.Visible = false;
		Badm.Visible = false;
		Madm.Visible = false;
		Eadm.Visible = false;
		Padm.visible = true;
		Dadm.Visible = false;
		st_vkgrp.Visible = false;
		cb_vkgrp.Visible = false;
	} else if(cb_dpt.Value == "D") {
		Radm.Visible = false;
		Badm.Visible = false;
		Madm.Visible = false;
		Eadm.Visible = false;
		Padm.Visible = false;
		Dadm.Visible = true;
		st_vkgrp.Visible = false;
		cb_vkgrp.Visible = false;
	} else {
		Radm.Visible = false;
		Badm.Visible = false;
		Madm.Visible = false;
		Eadm.Visible = false;
		Padm.visible = false;
		Dadm.Visible = false;
		st_vkgrp.Visible = false;
		cb_vkgrp.Visible = false;
	}
}
/********************************************************************************
* 기      능   :  E-mail 보내는 function
********************************************************************************/
function ufn_send_email(email_to, title, body) {
	tit_clearActionInfo();	
	tit_callService(
		"COMM_ACT"
		, "sendmail"
		, ""
		, ""
		," SEND_USER=ADMIN@HDEL.CO.KR"
			+ " RECE_USER=" + quote(email_to)
			+ " MESGTITL=" + quote( title ) 
			+ " MESGBODY=" + quote( body ) 
		, ""  //"fn_afterQuery"
		, false
		, true);			
}
/********************************************************************************
* 기      능   :  사용자코드 찾기
********************************************************************************/
function fn_searchCode() {
	tit_clearActionInfo();
	tit_addSearchActionInfo("bs04:BS0401001A_S8");
	tit_callService(
		""
		, ""
		, ""
		, "ds_vkgrp=ds_vkgrp"
		, ""
		, ""
		, true
		, true);
}
function btn_memberChk_OnClick(obj)
{
	if(ds_master.GetColumn(0,"SMATRY") != null || ds_master.GetColumn(0,"SMATRY") != "" ){
		tit_clearActionInfo();
		
		tit_addSearchActionInfo("wb01:WB0199021G_S4");
	
		tit_callService(
			""
			, ""
			, "ds_master=ds_master"
			, "ds_smat=ds_smat"
			, ""
			, "fn_afterSmatryCheck"
			, true);
		return;
	}
}

function ed_Smatry_OnCharChanged(obj,strPreText,strPostText)
{
	if(length(ed_Smatry.value) = 7){
			btn_memberChk.Enable = true;
		}else{
			btn_memberChk.Enable = false;
		}
}
]]></Script>
</Window>