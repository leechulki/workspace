<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="562" Id="Sbp0020" Left="8" OnLoadCompleted="fn_OnLoadCompleted" OnUnloadCompleted="fn_OnUnloadCompleted" PidAttrib="7" Title="사업계획관리" Top="8" Ver="1.0" Width="978" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_cond">
				<Contents>
					<colinfo id="ZPYEAR" size="4" type="STRING"/>
					<colinfo id="ZPYM" size="6" type="STRING"/>
					<colinfo id="SPART" size="2" type="STRING"/>
					<colinfo id="VKBUR_FR" size="4" type="STRING"/>
					<colinfo id="VKBUR_TO" size="4" type="STRING"/>
					<colinfo id="VKGRP_FR" size="3" type="STRING"/>
					<colinfo id="VKGRP_TO" size="3" type="STRING"/>
					<colinfo id="ZKUNNR" size="10" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset CanRowPosChange="ds_list_CanRowPosChange" DataSetType="Dataset" Id="ds_list" OnColumnChanged="ds_list_OnColumnChanged" OnRowPosChanged="ds_list_OnRowPosChanged">
				<Contents>
					<colinfo id="SAVE_YN" size="1" type="STRING"/>
					<colinfo id="CHK" size="1" type="STRING"/>
					<colinfo id="FLAG" size="1" type="STRING"/>
					<colinfo id="NEW_YN" size="1" type="STRING"/>
					<colinfo id="MANDT" size="1" type="STRING"/>
					<colinfo id="ZBPNNR" size="1" type="STRING"/>
					<colinfo id="ZPYEAR" size="4" type="STRING"/>
					<colinfo id="ZPYM" size="6" type="STRING"/>
					<colinfo id="SPART" size="2" type="STRING"/>
					<colinfo id="AUART" size="4" type="STRING"/>
					<colinfo id="MATNR" size="18" type="STRING"/>
					<colinfo id="VKBUR" size="4" type="STRING"/>
					<colinfo id="VKGRP" size="3" type="STRING"/>
					<colinfo id="ZKUNNR" size="10" type="STRING"/>
					<colinfo id="ZKUNNR_NM" size="30" type="STRING"/>
					<colinfo id="GTYPE" size="20" type="STRING"/>
					<colinfo id="TYPE1" size="5" type="STRING"/>
					<colinfo id="TYPE2" size="5" type="STRING"/>
					<colinfo id="TYPE3" size="5" type="STRING"/>
					<colinfo id="ZNUMBER" size="5" type="INT"/>
					<colinfo id="KUNNR" size="10" type="STRING"/>
					<colinfo id="KUNNR_NM" size="30" type="STRING"/>
					<colinfo id="GSNAM" size="50" type="STRING"/>
					<colinfo id="REGION" size="2" type="STRING"/>
					<colinfo id="ZDELI" size="1" type="STRING"/>
					<colinfo id="SHANGH" size="4" type="STRING"/>
					<colinfo id="ZINTER" size="1" type="STRING"/>
					<colinfo id="SOFOCA" size="15" type="DECIMAL"/>
					<colinfo id="ZFORE" size="4" type="DECIMAL"/>
					<colinfo id="WAERK" size="5" type="STRING"/>
					<colinfo id="DELDAT" size="8" type="STRING"/>
					<colinfo id="ZRMK" size="100" type="STRING"/>
					<colinfo id="ZRMK1" size="100" type="STRING"/>
					<colinfo id="CDATE" size="8" type="STRING"/>
					<colinfo id="CTIME" size="6" type="STRING"/>
					<colinfo id="CUSER" size="10" type="STRING"/>
					<colinfo id="UDATE" size="8" type="STRING"/>
					<colinfo id="UTIME" size="6" type="STRING"/>
					<colinfo id="UUSER" size="10" type="STRING"/>
					<colinfo id="DDATE" size="8" type="STRING"/>
					<colinfo id="DTIME" size="6" type="STRING"/>
					<colinfo id="DUSER" size="10" type="STRING"/>
					<colinfo id="NEW_YN0" size="1" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_error">
				<Contents>
					<colinfo id="IDX" size="10" type="STRING"/>
					<colinfo id="ERRMSG" size="200" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list_spart">
				<Contents>
					<colinfo id="CODE" size="2" type="STRING"/>
					<colinfo id="CODE_NAME" size="50" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list_vb" OnRowPosChanged="ds_list_vb_OnRowPosChanged">
				<Contents>
					<colinfo id="CODE" size="12" type="STRING"/>
					<colinfo id="CODE_NAME" size="60" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list_vg">
				<Contents>
					<colinfo id="CODE" size="12" type="STRING"/>
					<colinfo id="CODE_NAME" size="60" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list_spart_grid">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_obj_list">
				<Contents>
					<colinfo id="DS_VB" size="20" type="STRING"/>
					<colinfo id="DS_VG" size="20" type="STRING"/>
					<colinfo id="DS_COND_VG" size="20" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list_sman">
				<Contents>
					<colinfo id="SMAN_CD" size="256" type="STRING"/>
					<colinfo id="SMAN_NM" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond_sman">
				<Contents>
					<colinfo id="SMAN_CD" size="10" type="STRING"/>
					<colinfo id="SMAN_NM" size="105" type="STRING"/>
					<record>
						<SMAN_CD></SMAN_CD>
						<SMAN_NM></SMAN_NM>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list_buyr">
				<Contents>
					<colinfo id="BUYR_CD" size="256" type="STRING"/>
					<colinfo id="BUYR_NM" size="256" type="STRING"/>
					<colinfo id="BUYR_NM_SORT" size="256" type="STRING"/>
					<colinfo id="BUYR_ADDR" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond_buyr">
				<Contents>
					<colinfo id="BUYR_CD" size="10" type="STRING"/>
					<colinfo id="BUYR_NM" size="105" type="STRING"/>
					<record>
						<BUYR_CD></BUYR_CD>
						<BUYR_NM></BUYR_NM>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond_opendtm">
				<Contents>
					<colinfo id="ZPYEAR" size="4" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list_opendtm">
				<Contents>
					<colinfo id="OPENDTM" size="14" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list_save">
				<Contents>
					<colinfo id="FLAG" size="1" type="STRING"/>
					<colinfo id="MANDT" size="1" type="STRING"/>
					<colinfo id="ZBPNNR" size="1" type="STRING"/>
					<colinfo id="ZPYEAR" size="4" type="STRING"/>
					<colinfo id="ZPYM" size="6" type="STRING"/>
					<colinfo id="SPART" size="2" type="STRING"/>
					<colinfo id="AUART" size="4" type="STRING"/>
					<colinfo id="MATNR" size="18" type="STRING"/>
					<colinfo id="VKBUR" size="4" type="STRING"/>
					<colinfo id="VKGRP" size="3" type="STRING"/>
					<colinfo id="ZKUNNR" size="10" type="STRING"/>
					<colinfo id="GTYPE" size="20" type="STRING"/>
					<colinfo id="TYPE1" size="5" type="STRING"/>
					<colinfo id="TYPE2" size="5" type="STRING"/>
					<colinfo id="TYPE3" size="5" type="STRING"/>
					<colinfo id="ZNUMBER" size="5" type="STRING"/>
					<colinfo id="KUNNR" size="10" type="STRING"/>
					<colinfo id="GSNAM" size="50" type="STRING"/>
					<colinfo id="REGION" size="2" type="STRING"/>
					<colinfo id="ZDELI" size="1" type="STRING"/>
					<colinfo id="SHANGH" size="4" type="STRING"/>
					<colinfo id="ZINTER" size="1" type="STRING"/>
					<colinfo id="SOFOCA" size="15" type="DECIMAL"/>
					<colinfo id="ZFORE" size="4" type="DECIMAL"/>
					<colinfo id="WAERK" size="5" type="STRING"/>
					<colinfo id="DELDAT" size="8" type="STRING"/>
					<colinfo id="ZRMK" size="100" type="STRING"/>
					<colinfo id="CDATE" size="8" type="STRING"/>
					<colinfo id="CTIME" size="6" type="STRING"/>
					<colinfo id="CUSER" size="10" type="STRING"/>
					<colinfo id="UDATE" size="8" type="STRING"/>
					<colinfo id="UTIME" size="6" type="STRING"/>
					<colinfo id="UUSER" size="10" type="STRING"/>
					<colinfo id="DDATE" size="8" type="STRING"/>
					<colinfo id="DTIME" size="6" type="STRING"/>
					<colinfo id="DUSER" size="10" type="STRING"/>
					<colinfo id="USER_ID" size="1" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond_vg">
				<Contents>
					<colinfo id="VB" size="4" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list_detail" OnColumnChanged="ds_list_detail_OnColumnChanged">
				<Contents>
					<colinfo id="MANDT" size="3" type="STRING"/>
					<colinfo id="GBN" size="1" type="STRING"/>
					<colinfo id="GBN_NM" size="10" type="STRING"/>
					<colinfo id="AMT00" size="13" type="DECIMAL"/>
					<colinfo id="AMT01" size="13" type="DECIMAL"/>
					<colinfo id="AMT02" size="13" type="DECIMAL"/>
					<colinfo id="AMT03" size="13" type="DECIMAL"/>
					<colinfo id="AMT04" size="13" type="DECIMAL"/>
					<colinfo id="AMT05" size="13" type="DECIMAL"/>
					<colinfo id="AMT06" size="13" type="DECIMAL"/>
					<colinfo id="AMT07" size="13" type="DECIMAL"/>
					<colinfo id="AMT08" size="13" type="DECIMAL"/>
					<colinfo id="AMT09" size="13" type="DECIMAL"/>
					<colinfo id="AMT10" size="13" type="DECIMAL"/>
					<colinfo id="AMT11" size="13" type="DECIMAL"/>
					<colinfo id="AMT12" size="13" type="DECIMAL"/>
					<colinfo id="AMT13" size="13" type="DECIMAL"/>
					<colinfo id="AMT14" size="13" type="DECIMAL"/>
					<colinfo id="AMT15" size="13" type="DECIMAL"/>
					<colinfo id="AMT16" size="13" type="DECIMAL"/>
					<colinfo id="AMT17" size="13" type="DECIMAL"/>
					<colinfo id="USER_ID" size="10" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_detail">
				<Contents>
					<colinfo id="FLAG" size="1" type="STRING"/>
					<colinfo id="MANDT" size="3" type="STRING"/>
					<colinfo id="ZBPNNR" size="1" type="STRING"/>
					<colinfo id="ZPYEAR" size="4" type="STRING"/>
					<colinfo id="ZPYM" size="6" type="STRING"/>
					<colinfo id="SPART" size="2" type="STRING"/>
					<colinfo id="AUART" size="4" type="STRING"/>
					<colinfo id="MATNR" size="18" type="STRING"/>
					<colinfo id="VKBUR" size="4" type="STRING"/>
					<colinfo id="VKGRP" size="3" type="STRING"/>
					<colinfo id="ZKUNNR" size="10" type="STRING"/>
					<colinfo id="GTYPE" size="20" type="STRING"/>
					<colinfo id="TYPE1" size="5" type="STRING"/>
					<colinfo id="TYPE2" size="5" type="STRING"/>
					<colinfo id="TYPE3" size="5" type="STRING"/>
					<colinfo id="ZNUMBER" size="5" type="INT"/>
					<colinfo id="KUNNR" size="10" type="STRING"/>
					<colinfo id="GSNAM" size="50" type="STRING"/>
					<colinfo id="REGION" size="2" type="STRING"/>
					<colinfo id="ZDELI" size="1" type="STRING"/>
					<colinfo id="SHANGH" size="4" type="STRING"/>
					<colinfo id="ZINTER" size="1" type="STRING"/>
					<colinfo id="SOFOCA" size="15" type="DECIMAL"/>
					<colinfo id="ZFORE" size="4" type="DECIMAL"/>
					<colinfo id="WAERK" size="5" type="STRING"/>
					<colinfo id="DELDAT" size="8" type="STRING"/>
					<colinfo id="ZRMK" size="100" type="STRING"/>
					<colinfo id="CDATE" size="8" type="STRING"/>
					<colinfo id="CTIME" size="6" type="STRING"/>
					<colinfo id="CUSER" size="10" type="STRING"/>
					<colinfo id="UDATE" size="8" type="STRING"/>
					<colinfo id="UTIME" size="6" type="STRING"/>
					<colinfo id="UUSER" size="10" type="STRING"/>
					<colinfo id="DDATE" size="8" type="STRING"/>
					<colinfo id="DTIME" size="6" type="STRING"/>
					<colinfo id="DUSER" size="10" type="STRING"/>
					<colinfo id="USER_ID" size="10" type="STRING"/>
					<record>
						<AUART></AUART>
						<CDATE></CDATE>
						<CTIME></CTIME>
						<CUSER></CUSER>
						<DDATE></DDATE>
						<DELDAT></DELDAT>
						<DTIME></DTIME>
						<DUSER></DUSER>
						<FLAG></FLAG>
						<GSNAM></GSNAM>
						<GTYPE></GTYPE>
						<KUNNR></KUNNR>
						<MANDT></MANDT>
						<MATNR></MATNR>
						<REGION></REGION>
						<SHANGH></SHANGH>
						<SOFOCA/>
						<SPART></SPART>
						<TYPE1></TYPE1>
						<TYPE2></TYPE2>
						<TYPE3></TYPE3>
						<UDATE></UDATE>
						<USER_ID></USER_ID>
						<UTIME></UTIME>
						<UUSER></UUSER>
						<VKBUR></VKBUR>
						<VKGRP></VKGRP>
						<WAERK></WAERK>
						<ZBPNNR></ZBPNNR>
						<ZDELI></ZDELI>
						<ZFORE/>
						<ZINTER></ZINTER>
						<ZKUNNR></ZKUNNR>
						<ZNUMBER/>
						<ZPYEAR></ZPYEAR>
						<ZPYM></ZPYM>
						<ZRMK></ZRMK>
					</record>
					<record>
						<AUART></AUART>
						<CDATE></CDATE>
						<CTIME></CTIME>
						<CUSER></CUSER>
						<DDATE></DDATE>
						<DELDAT></DELDAT>
						<DTIME></DTIME>
						<DUSER></DUSER>
						<FLAG></FLAG>
						<GSNAM></GSNAM>
						<GTYPE></GTYPE>
						<KUNNR></KUNNR>
						<MANDT></MANDT>
						<MATNR></MATNR>
						<REGION></REGION>
						<SHANGH></SHANGH>
						<SOFOCA/>
						<SPART></SPART>
						<TYPE1></TYPE1>
						<TYPE2></TYPE2>
						<TYPE3></TYPE3>
						<UDATE></UDATE>
						<USER_ID></USER_ID>
						<UTIME></UTIME>
						<UUSER></UUSER>
						<VKBUR></VKBUR>
						<VKGRP></VKGRP>
						<WAERK></WAERK>
						<ZBPNNR></ZBPNNR>
						<ZDELI></ZDELI>
						<ZFORE/>
						<ZINTER></ZINTER>
						<ZKUNNR></ZKUNNR>
						<ZNUMBER/>
						<ZPYEAR></ZPYEAR>
						<ZPYM></ZPYM>
						<ZRMK></ZRMK>
					</record>
					<record>
						<AUART></AUART>
						<CDATE></CDATE>
						<CTIME></CTIME>
						<CUSER></CUSER>
						<DDATE></DDATE>
						<DELDAT></DELDAT>
						<DTIME></DTIME>
						<DUSER></DUSER>
						<FLAG></FLAG>
						<GSNAM></GSNAM>
						<GTYPE></GTYPE>
						<KUNNR></KUNNR>
						<MANDT></MANDT>
						<MATNR></MATNR>
						<REGION></REGION>
						<SHANGH></SHANGH>
						<SOFOCA/>
						<SPART></SPART>
						<TYPE1></TYPE1>
						<TYPE2></TYPE2>
						<TYPE3></TYPE3>
						<UDATE></UDATE>
						<USER_ID></USER_ID>
						<UTIME></UTIME>
						<UUSER></UUSER>
						<VKBUR></VKBUR>
						<VKGRP></VKGRP>
						<WAERK></WAERK>
						<ZBPNNR></ZBPNNR>
						<ZDELI></ZDELI>
						<ZFORE/>
						<ZINTER></ZINTER>
						<ZKUNNR></ZKUNNR>
						<ZNUMBER/>
						<ZPYEAR></ZPYEAR>
						<ZPYM></ZPYM>
						<ZRMK></ZRMK>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond_detail">
				<Contents>
					<colinfo id="ZBPNNR" size="10" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_yearm">
				<Contents>
					<colinfo id="YEARM" size="6" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_result">
				<Contents>
					<colinfo id="ZBPNNR" size="10" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list_gtype">
				<Contents>
					<colinfo id="gtype" size="20" type="STRING"/>
					<colinfo id="auart" size="4" type="STRING"/>
					<colinfo id="matnr" size="18" type="STRING"/>
					<colinfo id="spart" size="2" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_region_cd">
				<Contents>
					<colinfo id="CODE" size="2" type="STRING"/>
					<colinfo id="CODE_NAME" size="20" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_zdeli_cd">
				<Contents>
					<colinfo id="CODE" size="2" type="STRING"/>
					<colinfo id="CODE_NAME" size="50" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond_dd07t">
				<Contents>
					<colinfo id="DOMNAME" size="50" type="STRING"/>
					<colinfo id="DOMVALUE_L" size="50" type="STRING"/>
					<colinfo id="CONCAT_YN" size="1" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_error_dd07t">
				<Contents>
					<colinfo id="IDX" size="256" type="STRING"/>
					<colinfo id="ERRMSG" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_shangh_cd">
				<Contents>
					<colinfo id="CODE" size="2" type="STRING"/>
					<colinfo id="CODE_NAME" size="50" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_zinter_cd">
				<Contents>
					<colinfo id="CODE" size="2" type="STRING"/>
					<colinfo id="CODE_NAME" size="50" type="STRING"/>
					<record>
						<CODE>X</CODE>
						<CODE_NAME>중계무역</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_gtype_cd">
				<Contents>
					<colinfo id="CODE" size="2" type="STRING"/>
					<colinfo id="CODE_NAME" size="50" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_waerk_cd">
				<Contents>
					<colinfo id="CODE" size="2" type="STRING"/>
					<colinfo id="CODE_NAME" size="50" type="STRING"/>
				</Contents>
			</Dataset>
		</Datasets>
		<Shape BKColor="user0" Bottom="51" Height="51" Id="Shape1" Left="0" LineColor="user1" Right="978" TabOrder="1" Top="0" Type="Rectangle" Width="978"></Shape>
		<Div Border="Flat" BorderColor="user13" Height="187" Id="div_detail" Left="8" TabOrder="18" Text="Div0" Top="368" Width="971">
			<Contents>
				<Static Align="Center" Height="22" Id="Static17" Left="752" Style="sty_lb_form_basic" TabOrder="37" Text="비고" Top="64" VAlign="Middle" Width="218"></Static>
				<Grid AutoEnter="TRUE" AutoFitEndLine="Hide" BindDataset="ds_list_detail" BkColor2="default" BoldHead="true" Border="Flat" Bottom="186" ColSelect="TRUE" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="98" Id="grd_list_detail" InputPanel="FALSE" Left="-2" LineColor="user20" LineType="ExHORZ" OnKeyDown="div_detail_grd_list_detail_OnKeyDown" Right="970" RowHeight="20" Style="sty_grid" TabOrder="1" TabStop="true" Top="88" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="972">
					<contents>
						<format id="Default">
							<columns>
								<col width="44"/>
								<col width="100"/>
								<col width="60"/>
								<col width="60"/>
								<col width="60"/>
								<col width="60"/>
								<col width="60"/>
								<col width="60"/>
								<col width="60"/>
								<col width="60"/>
								<col width="60"/>
								<col width="60"/>
								<col width="60"/>
								<col width="60"/>
								<col width="60"/>
								<col width="60"/>
								<col width="60"/>
								<col width="60"/>
								<col width="60"/>
								<col width="60"/>
							</columns>
							<head>
								<cell align="center" col="0" display="text" font="굴림,9" text="구분"/>
								<cell align="center" col="1" display="text" font="굴림,9" text="합계"/>
								<cell align="center" col="2" color='expr:decode(F_CLOSE_YN,&quot;Y&quot;,GC_FONTCOLOR_EDITABLE_F,GC_FONTCOLOR_EDITABLE_T)' display="text" font="굴림,9" text="M+0"/>
								<cell align="center" col="3" color='expr:decode(F_CLOSE_YN,&quot;Y&quot;,GC_FONTCOLOR_EDITABLE_F,GC_FONTCOLOR_EDITABLE_T)' display="text" font="굴림,9" text="M+1"/>
								<cell align="center" col="4" color='expr:decode(F_CLOSE_YN,&quot;Y&quot;,GC_FONTCOLOR_EDITABLE_F,GC_FONTCOLOR_EDITABLE_T)' display="text" font="굴림,9" text="M+2"/>
								<cell align="center" col="5" color='expr:decode(F_CLOSE_YN,&quot;Y&quot;,GC_FONTCOLOR_EDITABLE_F,GC_FONTCOLOR_EDITABLE_T)' display="text" font="굴림,9" text="M+3"/>
								<cell align="center" col="6" color='expr:decode(F_CLOSE_YN,&quot;Y&quot;,GC_FONTCOLOR_EDITABLE_F,GC_FONTCOLOR_EDITABLE_T)' display="text" font="굴림,9" text="M+4"/>
								<cell align="center" col="7" color='expr:decode(F_CLOSE_YN,&quot;Y&quot;,GC_FONTCOLOR_EDITABLE_F,GC_FONTCOLOR_EDITABLE_T)' display="text" font="굴림,9" text="M+5"/>
								<cell align="center" col="8" color='expr:decode(F_CLOSE_YN,&quot;Y&quot;,GC_FONTCOLOR_EDITABLE_F,GC_FONTCOLOR_EDITABLE_T)' display="text" font="굴림,9" text="M+6"/>
								<cell align="center" col="9" color='expr:decode(F_CLOSE_YN,&quot;Y&quot;,GC_FONTCOLOR_EDITABLE_F,GC_FONTCOLOR_EDITABLE_T)' display="text" font="굴림,9" text="M+7"/>
								<cell align="center" col="10" color='expr:decode(F_CLOSE_YN,&quot;Y&quot;,GC_FONTCOLOR_EDITABLE_F,GC_FONTCOLOR_EDITABLE_T)' display="text" font="굴림,9" text="M+8"/>
								<cell align="center" col="11" color='expr:decode(F_CLOSE_YN,&quot;Y&quot;,GC_FONTCOLOR_EDITABLE_F,GC_FONTCOLOR_EDITABLE_T)' display="text" font="굴림,9" text="M+9"/>
								<cell align="center" col="12" color='expr:decode(F_CLOSE_YN,&quot;Y&quot;,GC_FONTCOLOR_EDITABLE_F,GC_FONTCOLOR_EDITABLE_T)' display="text" font="굴림,9" text="M+10"/>
								<cell align="center" col="13" color='expr:decode(F_CLOSE_YN,&quot;Y&quot;,GC_FONTCOLOR_EDITABLE_F,GC_FONTCOLOR_EDITABLE_T)' display="text" font="굴림,9" text="M+11"/>
								<cell align="center" col="14" color='expr:decode(F_CLOSE_YN,&quot;Y&quot;,GC_FONTCOLOR_EDITABLE_F,GC_FONTCOLOR_EDITABLE_T)' display="text" font="굴림,9" text="M+12"/>
								<cell align="center" col="15" color='expr:decode(F_CLOSE_YN,&quot;Y&quot;,GC_FONTCOLOR_EDITABLE_F,GC_FONTCOLOR_EDITABLE_T)' display="text" font="굴림,9" text="M+13"/>
								<cell align="center" col="16" color='expr:decode(F_CLOSE_YN,&quot;Y&quot;,GC_FONTCOLOR_EDITABLE_F,GC_FONTCOLOR_EDITABLE_T)' display="text" font="굴림,9" text="M+14"/>
								<cell align="center" col="17" color='expr:decode(F_CLOSE_YN,&quot;Y&quot;,GC_FONTCOLOR_EDITABLE_F,GC_FONTCOLOR_EDITABLE_T)' display="text" font="굴림,9" text="M+15"/>
								<cell align="center" col="18" color='expr:decode(F_CLOSE_YN,&quot;Y&quot;,GC_FONTCOLOR_EDITABLE_F,GC_FONTCOLOR_EDITABLE_T)' display="text" font="굴림,9" text="M+16"/>
								<cell align="center" col="19" color='expr:decode(F_CLOSE_YN,&quot;Y&quot;,GC_FONTCOLOR_EDITABLE_F,GC_FONTCOLOR_EDITABLE_T)' display="text" font="굴림,9" text="M+17"/>
							</head>
							<body>
								<cell align="center" bkcolor2="user22" col="0" colid="GBN_NM"/>
								<cell align="right" bkcolor2="user22" col="1" display="number" expr="AMT00+AMT01+AMT02+AMT03+AMT04+AMT05+AMT06+AMT07+AMT08+AMT09+AMT10+AMT11+AMT12+AMT13+AMT14+AMT15+AMT16+AMT17" limit="13" LimitDec="0"/>
								<cell align="right" bkcolor2="user22" col="2" colid="AMT00" display="number" edit='expr:decode(F_CLOSE_YN,&quot;Y&quot;,&quot;none&quot;,&#32;&quot;normal&quot;)' limit="13" LimitDec="0"/>
								<cell align="right" bkcolor2="user22" col="3" colid="AMT01" display="number" edit='expr:decode(F_CLOSE_YN,&quot;Y&quot;,&quot;none&quot;,&#32;&quot;normal&quot;)' limit="13" LimitDec="0"/>
								<cell align="right" bkcolor2="user22" col="4" colid="AMT02" display="number" edit='expr:decode(F_CLOSE_YN,&quot;Y&quot;,&quot;none&quot;,&#32;&quot;normal&quot;)' limit="13" LimitDec="0"/>
								<cell align="right" bkcolor2="user22" col="5" colid="AMT03" display="number" edit='expr:decode(F_CLOSE_YN,&quot;Y&quot;,&quot;none&quot;,&#32;&quot;normal&quot;)' limit="13" LimitDec="0"/>
								<cell align="right" bkcolor2="user22" col="6" colid="AMT04" display="number" edit='expr:decode(F_CLOSE_YN,&quot;Y&quot;,&quot;none&quot;,&#32;&quot;normal&quot;)' limit="13" LimitDec="0"/>
								<cell align="right" bkcolor2="user22" col="7" colid="AMT05" display="number" edit='expr:decode(F_CLOSE_YN,&quot;Y&quot;,&quot;none&quot;,&#32;&quot;normal&quot;)' limit="13" LimitDec="0"/>
								<cell align="right" bkcolor2="user22" col="8" colid="AMT06" display="number" edit='expr:decode(F_CLOSE_YN,&quot;Y&quot;,&quot;none&quot;,&#32;&quot;normal&quot;)' limit="13" LimitDec="0"/>
								<cell align="right" bkcolor2="user22" col="9" colid="AMT07" display="number" edit='expr:decode(F_CLOSE_YN,&quot;Y&quot;,&quot;none&quot;,&#32;&quot;normal&quot;)' limit="13" LimitDec="0"/>
								<cell align="right" bkcolor2="user22" col="10" colid="AMT08" display="number" edit='expr:decode(F_CLOSE_YN,&quot;Y&quot;,&quot;none&quot;,&#32;&quot;normal&quot;)' limit="13" LimitDec="0"/>
								<cell align="right" bkcolor2="user22" col="11" colid="AMT09" display="number" edit='expr:decode(F_CLOSE_YN,&quot;Y&quot;,&quot;none&quot;,&#32;&quot;normal&quot;)' limit="13" LimitDec="0"/>
								<cell align="right" bkcolor2="user22" col="12" colid="AMT10" display="number" edit='expr:decode(F_CLOSE_YN,&quot;Y&quot;,&quot;none&quot;,&#32;&quot;normal&quot;)' limit="13" LimitDec="0"/>
								<cell align="right" bkcolor2="user22" col="13" colid="AMT11" display="number" edit='expr:decode(F_CLOSE_YN,&quot;Y&quot;,&quot;none&quot;,&#32;&quot;normal&quot;)' limit="13" LimitDec="0"/>
								<cell align="right" bkcolor2="user22" col="14" colid="AMT12" display="number" edit='expr:decode(F_CLOSE_YN,&quot;Y&quot;,&quot;none&quot;,&#32;&quot;normal&quot;)' limit="13" LimitDec="0"/>
								<cell align="right" bkcolor2="user22" col="15" colid="AMT13" display="number" edit='expr:decode(F_CLOSE_YN,&quot;Y&quot;,&quot;none&quot;,&#32;&quot;normal&quot;)' limit="13" LimitDec="0"/>
								<cell align="right" bkcolor2="user22" col="16" colid="AMT14" display="number" edit='expr:decode(F_CLOSE_YN,&quot;Y&quot;,&quot;none&quot;,&#32;&quot;normal&quot;)' limit="13" LimitDec="0"/>
								<cell align="right" bkcolor2="user22" col="17" colid="AMT15" display="number" edit='expr:decode(F_CLOSE_YN,&quot;Y&quot;,&quot;none&quot;,&#32;&quot;normal&quot;)' limit="13" LimitDec="0"/>
								<cell align="right" bkcolor2="user22" col="18" colid="AMT16" display="number" edit='expr:decode(F_CLOSE_YN,&quot;Y&quot;,&quot;none&quot;,&#32;&quot;normal&quot;)' limit="13" LimitDec="0"/>
								<cell align="right" bkcolor2="user22" col="19" colid="AMT17" display="number" edit='expr:decode(F_CLOSE_YN,&quot;Y&quot;,&quot;none&quot;,&#32;&quot;normal&quot;)' limit="13" LimitDec="0"/>
							</body>
						</format>
					</contents>
				</Grid>
				<Static Align="Right" Height="20" Id="Static3" Left="302" Style="sty_lb_form_basic" TabOrder="3" Text="기종&#32;" VAlign="Middle" Width="86"></Static>
				<Combo BindDataset="ds_list" Border="Flat" CodeColumn="CODE" Column="GTYPE" DataColumn="CODE_NAME" Height="20" Id="cb_gtype" InnerDataset="ds_gtype_cd" Left="388" OnChanged="div_detail_cb_gtype_OnChanged" Style="sty_ipt_form_ind" TabOrder="2" Width="175"></Combo>
				<Static Align="Right" Height="20" Id="Static4" Left="302" Style="sty_lb_form_basic" TabOrder="5" Text="인승&#32;" Top="44" VAlign="Middle" Width="86"></Static>
				<Edit Align="RIGHT" BindDataset="ds_list" Border="Flat" CheckLength="Byte" Column="TYPE3" Height="20" Id="ed_type3" ImeMode="none" Left="389" LeftMargin="4" MaxLength="5" OnKeyDown="ed_buyr_nm_OnKeyDown" RightMargin="4" Style="sty_ipt_form" TabOrder="4" Top="66" UpperOnly="TRUE" Width="42"></Edit>
				<Static Align="Right" Height="20" Id="Static5" Left="433" Style="sty_lb_form_basic" TabOrder="7" Text="속도&#32;" Top="44" VAlign="Middle" Width="86"></Static>
				<Edit Align="RIGHT" BindDataset="ds_list" Border="Flat" CheckLength="Byte" Column="TYPE2" Height="20" Id="ed_type2" ImeMode="none" Left="520" LeftMargin="4" MaxLength="5" OnKeyDown="ed_buyr_nm_OnKeyDown" RightMargin="4" Style="sty_ipt_form" TabOrder="6" Top="44" UpperOnly="TRUE" Width="42"></Edit>
				<Static Align="Right" Height="20" Id="Static6" Left="302" Style="sty_lb_form_basic" TabOrder="9" Text="층수&#32;" Top="66" VAlign="Middle" Width="86"></Static>
				<Edit Align="RIGHT" BindDataset="ds_list" Border="Flat" CheckLength="Byte" Column="TYPE1" Height="20" Id="ed_type1" ImeMode="none" Left="389" LeftMargin="4" MaxLength="5" OnKeyDown="ed_buyr_nm_OnKeyDown" RightMargin="4" Style="sty_ipt_form" TabOrder="8" Text="12345" Top="44" UpperOnly="TRUE" Width="42"></Edit>
				<Combo BindDataset="ds_list" Border="Flat" CodeColumn="CODE" Column="REGION" DataColumn="CODE_NAME" Height="20" Id="cb_region" ImeMode="none" InnerDataset="ds_region_cd" Left="87" Style="sty_ipt_form" TabOrder="10" Top="43" Width="64"></Combo>
				<Static Align="Right" Height="20" Id="Static1" Style="sty_lb_form_basic" TabOrder="11" Text="설치지역&#32;" Top="44" VAlign="Middle" Width="86"></Static>
				<Edit BindDataset="ds_list" Border="Flat" CheckLength="Byte" Column="GSNAM" Height="20" Id="ed_gsnam" ImeMode="none" Left="88" LeftMargin="4" MaxLength="50" OnKeyDown="ed_buyr_nm_OnKeyDown" RightMargin="4" Style="sty_ipt_form" TabOrder="12" Top="22" UpperOnly="TRUE" Width="212"></Edit>
				<Static Align="Right" Height="20" Id="Static0" Style="sty_lb_form_basic" TabOrder="13" Text="공사명&#32;" Top="22" VAlign="Middle" Width="86"></Static>
				<Div BKColor="user0" Height="20" Id="div_buyr" Left="88" OnLoadCompleted="fn_OnLoadCompleted" TabOrder="14" Text="Div0" Top="1" Url="COM::Coms003.xml" Width="212">
					<Contents></Contents>
				</Div>
				<Static Align="Right" Height="20" Id="Static2" Style="sty_lb_form_basic" TabOrder="15" Text="거래선&#32;" VAlign="Middle" Width="86"></Static>
				<Static Align="Right" Height="20" Id="Static7" Left="433" Style="sty_lb_form_basic" TabOrder="17" Text="대수&#32;" Top="66" VAlign="Middle" Width="86"></Static>
				<Edit Align="RIGHT" BindDataset="ds_list" Border="Flat" CheckLength="Byte" Column="ZNUMBER" Height="20" Id="ed_znumber" ImeMode="none" Left="520" LeftMargin="4" MaxLength="5" OnKeyDown="ed_buyr_nm_OnKeyDown" RightMargin="4" Style="sty_ipt_form" TabOrder="16" Top="66" UpperOnly="TRUE" Width="42"></Edit>
				<Static Align="Right" Height="20" Id="Static8" Style="sty_lb_form_basic" TabOrder="18" Text="단납구분&#32;" Top="66" VAlign="Middle" Width="86"></Static>
				<Combo BindDataset="ds_list" Border="Flat" CodeColumn="CODE" Column="SHANGH" DataColumn="CODE_NAME" Height="20" Id="cb_shangh" InnerDataset="ds_shangh_cd" Left="239" Style="sty_ipt_form" TabOrder="19" Top="43" Width="62"></Combo>
				<Static Align="Right" Height="20" Id="Static9" Left="152" Style="sty_lb_form_basic" TabOrder="20" Text="국내/상해&#32;" Top="44" VAlign="Middle" Width="86"></Static>
				<Static Align="Right" Height="20" Id="Static10" Left="152" Style="sty_lb_form_basic" TabOrder="21" Text="중계무역구분&#32;" Top="66" VAlign="Middle" Width="86"></Static>
				<Static Align="Right" Height="20" Id="Static11" Left="564" Style="sty_lb_form_basic" TabOrder="22" Text="수주예상액&#32;" Top="22" VAlign="Middle" Width="86"></Static>
				<Edit Align="RIGHT" BindDataset="ds_list" Border="Flat" CheckLength="Byte" Column="ZFORE" Height="20" Id="ed_zfore" ImeMode="none" Left="652" LeftMargin="4" MaxLength="105" Number="TRUE" OnKeyDown="ed_buyr_nm_OnKeyDown" RightMargin="4" Style="sty_ipt_form" TabOrder="23" Top="44" UpperOnly="TRUE" Width="96"></Edit>
				<Static Align="Right" Height="20" Id="Static12" Left="564" Style="sty_lb_form_basic" TabOrder="24" Text="예상시행율&#32;" Top="44" VAlign="Middle" Width="86"></Static>
				<Combo BindDataset="ds_list" Border="Flat" CodeColumn="CODE" Column="WAERK" DataColumn="CODE_NAME" Height="20" Id="cb_waerk" InnerDataset="ds_waerk_cd" Left="651" Style="sty_ipt_form_ind" TabOrder="25" Width="99"></Combo>
				<Static Align="Right" Height="20" Id="Static13" Left="564" Style="sty_lb_form_basic" TabOrder="26" Text="통화&#32;" VAlign="Middle" Width="86"></Static>
				<Static Align="Right" Height="20" Id="Static14" Left="564" Style="sty_lb_form_basic" TabOrder="27" Text="납기예정일&#32;" Top="66" VAlign="Middle" Width="86"></Static>
				<Static Align="Center" Height="20" Id="Static15" Left="750" Style="sty_lb_form_basic" TabOrder="28" Text="비고" VAlign="Middle" Width="218"></Static>
				<Static Align="Right" Height="20" Id="Static16" Left="302" Style="sty_lb_form_basic" TabOrder="29" Text="기종정보&#32;" Top="22" VAlign="Middle" Width="86"></Static>
				<Calendar BindDataset="ds_list" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="DELDAT" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_deldat" Left="652" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form_ind" SundayTextColor="user35" TabOrder="30" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="66" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="99"></Calendar>
				<TextArea BindDataset="ds_list" CheckLength="Byte" Column="ZRMK" Height="41" Id="ta_zrmk" Left="749" MaxLength="100" Style="sty_ipt_form" TabOrder="31" Text="TextArea0" Top="22" Width="219"></TextArea>
				<Button Height="20" Id="btn_autocal" Left="752" OnClick="btn_update_reason_OnClick" TabOrder="32" Text="매출/청구/수금&#32;자동산출" Top="65" Width="154"></Button>
				<Edit Border="Flat" Column="NAME1" Enable="FALSE" Height="20" Id="ed_gtype_info" Left="389" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="33" Top="22" Width="173"></Edit>
				<MaskEdit BindDataset="ds_list" Border="Flat" Column="SOFOCA" Cursor="IBEAM" DecimalLen="1" Height="20" Id="med_sofoca" Left="652" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="34" Top="22" Width="96"></MaskEdit>
				<Checkbox BindDataset="ds_list" Column="ZDELI" Height="21" Id="chk_zdeli" Left="112" RightMargin="4" TabOrder="35" Top="66" TrueValue="X" Width="16"></Checkbox>
				<Checkbox BindDataset="ds_list" Column="ZINTER" Height="21" Id="chk_zinter" Left="263" TabOrder="36" Top="66" TrueValue="X" Width="14"></Checkbox>
			</Contents>
		</Div>
		<Grid AreaSelect="true" AutoEnter="TRUE" AutoFitEndLine="Hide" BindDataset="ds_list" BkColor2="default" BoldHead="true" Border="Flat" Bottom="356" ColSizing="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="300" Id="grd_list" InputPanel="FALSE" Left="8" LineColor="user20" LineType="ExHORZ" OnHeadClick="grd_list_OnHeadClick" OnKeyDown="grd_list_OnKeyDown" Right="971" RowHeight="20" Style="sty_grid" TabOrder="0" TabStop="true" Top="56" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="963">
			<contents>
				<format id="Default">
					<columns>
						<col width="40"/>
						<col width="0"/>
						<col width="33"/>
						<col width="77"/>
						<col width="55"/>
						<col width="55"/>
						<col width="63"/>
						<col width="99"/>
						<col width="99"/>
						<col width="77"/>
						<col width="79"/>
						<col width="61"/>
						<col width="124"/>
						<col width="105"/>
						<col width="69"/>
						<col width="87"/>
						<col width="77"/>
						<col width="54"/>
						<col width="51"/>
						<col width="50"/>
						<col width="64"/>
						<col width="72"/>
						<col width="78"/>
						<col width="109"/>
						<col width="80"/>
						<col width="78"/>
						<col width="83"/>
						<col width="257"/>
					</columns>
					<head>
						<cell align="center" col="0" color="user21" display="text" font="굴림,9" text="No"/>
						<cell align="center" bkimageid="icon_grid_sel" col="1" color="user21" display="text" font="굴림,9"/>
						<cell align="center" col="2" color="user21" display="text" font="굴림,9" text="변경"/>
						<cell align="center" col="3" color="user21" display="text" font="굴림,9" text="사업계획번호"/>
						<cell align="center" col="4" color="user21" display="text" font="굴림,9" text="편성년도"/>
						<cell align="center" col="5" color="user21" display="text" font="굴림,9" text="계획년월"/>
						<cell align="center" col="6" color="user21" display="text" font="굴림,9" text="제품군"/>
						<cell align="center" col="7" color="user21" display="text" font="굴림,9" text="부서팀"/>
						<cell align="center" col="8" color="user21" display="text" font="굴림,9" text="팀"/>
						<cell align="center" col="9" color="user21" display="text" font="굴림,9" text="담당자"/>
						<cell align="center" col="10" color="user21" display="text" font="굴림,9" text="담당자명"/>
						<cell align="center" col="11" color="user21" display="text" font="굴림,9" text="고객"/>
						<cell align="center" col="12" color="user21" display="text" font="굴림,9" text="고객명"/>
						<cell align="center" col="13" color="expr:GC_FONTCOLOR_EDITABLE_T" display="text" font="굴림,9" text="공사명"/>
						<cell align="center" col="14" color="expr:GC_FONTCOLOR_EDITABLE_T" display="text" font="굴림,9" text="설치지역"/>
						<cell align="center" col="15" color="expr:GC_FONTCOLOR_EDITABLE_T" display="text" font="굴림,9" text="기종"/>
						<cell align="center" col="16" color="expr:GC_FONTCOLOR_EDITABLE_T" display="text" font="굴림,9" text="인승"/>
						<cell align="center" col="17" color="expr:GC_FONTCOLOR_EDITABLE_T" display="text" font="굴림,9" text="속도"/>
						<cell align="center" col="18" color="expr:GC_FONTCOLOR_EDITABLE_T" display="text" font="굴림,9" text="층수"/>
						<cell align="center" col="19" color="expr:GC_FONTCOLOR_EDITABLE_T" display="text" font="굴림,9" text="대수"/>
						<cell align="center" col="20" color="expr:GC_FONTCOLOR_EDITABLE_T" display="text" font="굴림,9" text="단납구분"/>
						<cell align="center" col="21" color="expr:GC_FONTCOLOR_EDITABLE_T" display="text" font="굴림,9" text="국내/상해"/>
						<cell align="center" col="22" color="expr:GC_FONTCOLOR_EDITABLE_T" display="text" font="굴림,9" text="중계무역구분"/>
						<cell align="center" col="23" color="expr:GC_FONTCOLOR_EDITABLE_T" display="text" font="굴림,9" text="수주예상액"/>
						<cell align="center" col="24" color="expr:GC_FONTCOLOR_EDITABLE_T" display="text" font="굴림,9" text="예상시행율"/>
						<cell align="center" col="25" color="expr:GC_FONTCOLOR_EDITABLE_T" display="text" font="굴림,9" text="통화"/>
						<cell align="center" col="26" color="expr:GC_FONTCOLOR_EDITABLE_T" display="text" font="굴림,9" text="납기예정일"/>
						<cell align="center" col="27" color="expr:GC_FONTCOLOR_EDITABLE_T" display="text" font="굴림,9" text="비고"/>
					</head>
					<body>
						<cell align="center" col="0" expr="currow+1"/>
						<cell align="center" bkcolor2="user22" col="1" colid="CHK" display='expr:decode(F_CLOSE_YN,&quot;Y&quot;,&quot;text&quot;,&quot;checkbox&quot;)' edit='expr:decode(F_CLOSE_YN,&quot;Y&quot;,&quot;none&quot;,&quot;checkbox&quot;)' expr="iif(currow=ds_list.row,&#32;1,&#32;0)"/>
						<cell align="center" bkcolor2="user22" bkimageid='expr:gfn_getFlagBkImageID(getColumn(currow,&#32;&quot;FLAG&quot;))' col="2" colid="FLAG" display="image"/>
						<cell align="center" autosizing="none" bkcolor2="user22" col="3" colid="ZBPNNR"/>
						<cell align="center" autosizing="none" bkcolor2="user22" col="4" colid="ZPYEAR"/>
						<cell align="center" autosizing="none" bkcolor2="user22" col="5" colid="ZPYM" Mask="expr:gfn_getMaskDate(F_FORM_ID,6)"/>
						<cell align="center" autosizing="none" bkcolor2="user22" col="6" colid="SPART" combocol="CODE" combodataset="ds_list_spart_grid" combodisplayrowcnt="20" combotext="CODE_NAME" display="combo"/>
						<cell align="left" autosizing="none" bkcolor2="user22" col="7" colid="VKBUR" combocol="CODE" combodataset="ds_list_vb" combodisplayrowcnt="20" combotext="CODE_NAME" display="combo"/>
						<cell align="left" autosizing="none" bkcolor2="user22" col="8" colid="VKGRP" combocol="CODE" combodataset="ds_list_vg" combodisplayrowcnt="20" combotext="CODE_NAME" display="combo"/>
						<cell align="center" autosizing="none" bkcolor2="user22" col="9" colid="ZKUNNR" display="text"/>
						<cell align="left" autosizing="none" bkcolor2="user22" col="10" colid="ZKUNNR_NM"/>
						<cell align="center" autosizing="none" bkcolor2="user22" col="11" colid="KUNNR" display="text"/>
						<cell align="left" autosizing="none" bkcolor2="user22" col="12" colid="KUNNR_NM"/>
						<cell align="left" autosizing="none" bkcolor2="user22" checklength="Byte" col="13" colid="GSNAM" display="text"/>
						<cell align="center" autosizing="none" bkcolor2="user22" col="14" colid="REGION" combocol="CODE" combodataset="ds_region_cd" combotext="CODE_NAME" display="combo"/>
						<cell align="left" autosizing="none" bkcolor2="user22" checklength="Byte" col="15" colid="GTYPE" display="text"/>
						<cell align="center" autosizing="none" bkcolor2="user22" checklength="Byte" col="16" colid="TYPE1" display="text"/>
						<cell align="center" autosizing="none" bkcolor2="user22" checklength="Byte" col="17" colid="TYPE2" display="text"/>
						<cell align="center" autosizing="none" bkcolor2="user22" checklength="Byte" col="18" colid="TYPE3" display="text"/>
						<cell align="center" autosizing="none" bkcolor2="user22" checklength="Byte" col="19" colid="ZNUMBER" display="number"/>
						<cell align="center" autosizing="none" bkcolor2="user22" col="20" colid="ZDELI" combocol="CODE" combodataset="ds_zdeli_cd" combotext="CODE_NAME" display="combo"/>
						<cell align="center" autosizing="none" bkcolor2="user22" col="21" colid="SHANGH" combocol="CODE" combodataset="ds_shangh_cd" combotext="CODE_NAME" display="combo"/>
						<cell align="center" autosizing="none" bkcolor2="user22" col="22" colid="ZINTER" combocol="CODE" combodataset="ds_zinter_cd" combotext="CODE_NAME" display="combo"/>
						<cell align="right" autosizing="none" bkcolor2="user22" col="23" colid="SOFOCA" display="number"/>
						<cell align="right" autosizing="none" bkcolor2="user22" col="24" colid="ZFORE" display="text"/>
						<cell align="center" autosizing="none" bkcolor2="user22" col="25" colid="WAERK" display="text"/>
						<cell align="center" autosizing="none" bkcolor2="user22" col="26" colid="DELDAT" display="text" Mask="expr:gfn_getMaskDate(F_FORM_ID)"/>
						<cell align="left" autosizing="none" bkcolor2="user22" checklength="Byte" col="27" colid="ZRMK1" display="text"/>
					</body>
					<summary>
						<cell bkcolor="user25" col="0" color="user26" display="text">
							<cell align="center" col="0" color="user26" colspan="4" display="text" text="합계"/>
						</cell>
						<cell align="right" bkcolor="user25" col="1" color="user26" display="text"/>
						<cell align="right" bkcolor="user25" col="2" color="user26" display="text"/>
						<cell align="right" bkcolor="user25" col="3" color="user26" display="text"/>
						<cell align="right" bkcolor="user25" col="4" color="user26" display="text"/>
						<cell align="right" bkcolor="user25" col="5" color="user26" display="text"/>
						<cell align="right" bkcolor="user25" col="6" color="user26" display="text"/>
						<cell align="right" bkcolor="user25" col="7" color="user26" display="text"/>
						<cell align="right" bkcolor="user25" col="8" color="user26" display="text"/>
						<cell align="right" bkcolor="user25" col="9" color="user26" display="text"/>
						<cell align="right" bkcolor="user25" col="10" color="user26" display="text"/>
						<cell align="right" bkcolor="user25" col="11" color="user26" display="text"/>
						<cell align="right" bkcolor="user25" col="12" color="user26" display="text"/>
						<cell align="right" bkcolor="user25" col="13" color="user26" display="text"/>
						<cell align="right" bkcolor="user25" col="14" color="user26" display="text"/>
						<cell align="right" bkcolor="user25" col="15" color="user26" display="text"/>
						<cell align="right" bkcolor="user25" col="16" color="user26" display="text"/>
						<cell align="right" bkcolor="user25" col="17" color="user26" display="text"/>
						<cell align="right" bkcolor="user25" col="18" color="user26" display="text"/>
						<cell align="right" bkcolor="user25" col="19" color="user26" display="number" expr='SUM(&quot;ZNUMBER&quot;)'/>
						<cell align="right" bkcolor="user25" col="20" color="user26" display="text"/>
						<cell align="right" bkcolor="user25" col="21" color="user26" display="text"/>
						<cell align="right" bkcolor="user25" col="22" color="user26" display="text"/>
						<cell align="right" bkcolor="user25" col="23" color="user26" display="number" expr='SUM(&quot;SOFOCA&quot;)'/>
						<cell align="right" bkcolor="user25" col="24" color="user26" display="text"/>
						<cell align="right" bkcolor="user25" col="25" color="user26" display="text"/>
						<cell align="right" bkcolor="user25" col="26" color="user26" display="text"/>
						<cell align="right" bkcolor="user25" col="27" color="user26" display="text"/>
					</summary>
				</format>
			</contents>
		</Grid>
		<Calendar Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Dateformat="yyyy.MM" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="22" Id="cal_zpym" Left="87" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_search_ind" SundayTextColor="user35" TabOrder="2" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="27" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="77"></Calendar>
		<Static Align="Right" Height="20" Id="st_i_ymd" Left="5" Style="sty_lb_search" TabOrder="3" Text="계획년월&#32;" Top="27" VAlign="Middle" Width="80"></Static>
		<Button Appearance="FLAT" ButtonStyle="TRUE" Color="user5" Cursor="HAND" DomainID="btn.query" Height="22" Id="btn_query" ImageID="btn_comm_query_k" Left="713" LeftMargin="20" OnClick="fn_OnClick_btn" TabOrder="4" Text="조회" Top="4" Visible="FALSE" Width="52"></Button>
		<Div BKColor="user0" Height="22" Id="div_sman" Left="794" OnLoadCompleted="fn_OnLoadCompleted" TabOrder="7" Text="Div0" Top="27" Url="COM::Coms002.xml" Width="164">
			<Contents></Contents>
		</Div>
		<Static Align="Right" Height="20" Id="Static1" Left="712" Style="sty_lb_search" TabOrder="9" Text="담당자&#32;" Top="27" VAlign="Middle" Width="80"></Static>
		<Static Align="Right" Height="20" Id="Static4" Left="351" Style="sty_lb_search" TabOrder="10" Text="팀&#32;" Top="27" VAlign="Middle" Width="80"></Static>
		<Static Align="Right" Height="20" Id="Static3" Left="351" Style="sty_lb_search" TabOrder="10" Text="부서&#32;" Top="5" VAlign="Middle" Width="80"></Static>
		<Static Align="Right" Height="20" Id="st_i_spart" Left="166" Style="sty_lb_search" TabOrder="11" Text="제품군&#32;" Top="27" VAlign="Middle" Width="80"></Static>
		<Combo Border="Flat" CodeColumn="CODE" DataColumn="CODE_NAME" Height="20" Id="cb_spart" InnerDataset="ds_list_spart" Left="247" Style="sty_ipt_form" TabOrder="12" Top="26" Width="104"></Combo>
		<Button Appearance="FLAT" ButtonStyle="TRUE" Color="user5" Cursor="HAND" DomainID="btn.save" Height="22" Id="btn_save" ImageID="btn_comm_save_k" Left="869" LeftMargin="20" OnClick="fn_OnClick_btn" TabOrder="13" Text="저장" Top="4" Visible="FALSE" Width="52"></Button>
		<Div BKColor="user0" Height="43" Id="div_vbvg" Left="433" OnLoadCompleted="fn_OnLoadCompleted" OnTimer="WB0199010A_OnTimer" TabOrder="14" Text="Div0" Top="5" Url="COM::Coms001.xml" Width="280">
			<Contents></Contents>
		</Div>
		<Edit Border="Flat" Enable="FALSE" Height="20" Id="ed_opendtm" Left="166" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="15" Text="오픈일시&#32;:&#32;" Top="5" Width="183"></Edit>
		<Calendar Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Dateformat="yyyy" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_zpyear" Left="87" MonthPickerFormat="yyyy년" MonthPopupBorder="FLAT" OnChanged="cal_zpyear_OnChanged" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_search_ind" SundayTextColor="user35" TabOrder="16" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="5" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="77"></Calendar>
		<Static Align="Right" Height="20" Id="Static0" Left="5" Style="sty_lb_search" TabOrder="17" Text="편성년도&#32;" Top="5" VAlign="Middle" Width="80"></Static>
		<Button Appearance="FLAT" ButtonStyle="TRUE" Color="user5" Cursor="HAND" DomainID="btn.input" Height="22" Id="btn_input" ImageID="btn_comm_input_k" Left="765" LeftMargin="20" OnClick="fn_OnClick_btn" TabOrder="19" Text="입력" Top="4" Visible="FALSE" Width="52"></Button>
		<Button Appearance="FLAT" ButtonStyle="TRUE" Color="user5" Cursor="HAND" DomainID="btn.delete" Height="22" Id="btn_delete" ImageID="btn_comm_delete_k" Left="817" LeftMargin="20" OnClick="fn_OnClick_btn" TabOrder="20" Text="삭제" Top="4" Visible="FALSE" Width="52"></Button>
		<Button Appearance="FLAT" ButtonStyle="TRUE" Color="user5" Cursor="HAND" DomainID="btn.excel" Height="22" Id="btn_excel" ImageID="btn_comm_excel_k" Left="920" LeftMargin="20" OnClick="fn_OnClick_btn" TabOrder="21" Text="엑셀" Top="5" Visible="FALSE" Width="52"></Button>
		<Button Appearance="FLAT" ButtonStyle="TRUE" Color="user5" Cursor="HAND" DomainID="btn.close" Height="22" Id="btn_close" ImageID="btn_comm_close_k" Left="921" LeftMargin="20" OnClick="fn_OnClick_btn" TabOrder="5" Text="닫기" Top="28" Visible="FALSE" Width="52"></Button>
	</Form>
	<Script><![CDATA[/*
 ******************************************************************************************
 * 기      능   : 사업계획등록 (Sbp0010)
 * 작  성  자   : 구란이
 * 작성  일자   : 2012.06.11
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 * COMMENT
   0. T-CODE                : 
   1. WFC URL 				: 
   2. WFC OPERATION NAME 	: 
   3. WFC OBJ NAME 			: 
   4. 개발자료 :   
 ******************************************************************************************
*/
#include "LIB::commons.js";			// 공통 스크립트  
#include "LIB::nsfRequest.js";		// 공통 스크립트  /* GNY 추가 */
#include "LIB::common_hdel.js";		// 공통 스크립트  /* GNY 추가 */

//=========================================================================================
// [ PART 1 ]
// Form에서 사용될 전역변수를 선언
// FORM에서 사용되는 전역변수는 대문자로 작성하며, F_XXX 의 형태를 갖도록 한다. 
//=========================================================================================
var F_FORM_ID 			= "Sbp0010";   

// 컬럼번호
var F_COLNUM_CHK		= "";  	// 선택여부
var F_COLNUM_FLAG		= "";  	// 변경구분
var F_COLNUM_ZPYM		= "";  	// 계획년월
var F_COLNUM_SPART 		= "";  	// 제품군
var F_COLNUM_VKBUR 		= "";  	// 사업장 
var F_COLNUM_VKGRP 		= "";  	// 영업그룹
var F_COLNUM_ZKUNNR 	= "";  	// 담당자  
var F_COLNUM_ZKUNNR_NM 	= "";  	// 담당자명
var F_COLNUM_KUNNR 		= "";  	// 거래선
var F_COLNUM_KUNNR_NM 	= "";  	// 거래선명 
var F_COLNUM_GSNAM      = ""; 	// 공사명
var F_COLNUM_REGION     = ""; 	// 설치지역
var F_COLNUM_GTYPE      = ""; 	// 기종
var F_COLNUM_TYPE1      = ""; 	// TYPE1 (인승)
var F_COLNUM_TYPE2      = ""; 	// TYPE2 (속도)
var F_COLNUM_TYPE3      = "";   // TYPE3 (층수)
var F_COLNUM_ZNUMBER    = ""; 	// 대수
var F_COLNUM_ZDELI      = ""; 	// 단납기구분
var F_COLNUM_SHANGH     = ""; 	// 국내/상해구분
var F_COLNUM_ZINTER     = ""; 	// 중계무역구분
var F_COLNUM_SOFOCA     = ""; 	// 수주예상액
var F_COLNUM_ZFORE      = ""; 	// 예상시행율
var F_COLNUM_WAERK      = ""; 	// 통화
var F_COLNUM_DELDAT     = ""; 	// 납기예정일
var F_COLNUM_ZRMK       = ""; 	// 비고
 
var F_COLNUM_TOT1      	 = 1;  // 매출청구수금 그리드 합계 
var F_COLNUM_YEAYM     	 = 2;  // 매출청구수금 그리드 기준년월
 
var F_CLOSE_YN 			= "Y";  		// 계획년월의 마감여부
var F_ZBPNNR			= "";			// 사업계획번호
var F_SYSDATE           = ""; 			// 현재년월일(8자리)
var F_CHG_ROWNUM        = "";			// 최종 변경된 헹번호
var F_CHG_COLNUM        = "";			// 최종 변경된 컬럼번호
var F_USER_GROUP_B 		= "";  			// 사용자권한 (G_USER_GROUP_B)
var F_WORK_GBN          = "";			// 어떤 버튼을 클릭했는지 구분(Q:조회, S:저장, D:삭제, E:엑셀)

var F_SAVE_ARR          = [ 
							"FLAG"
							,"ZPYEAR"
							,"ZPYM"
							,"SPART"
							,"VKBUR"
							,"VKGRP"
							,"ZKUNNR"
							,"GTYPE"
							,"TYPE1"
							,"TYPE2"
							,"TYPE3"
							,"ZNUMBER"
							,"KUNNR"
							,"GSNAM"
							,"REGIO"
							,"ZDELI"
							,"SHANGH"
							,"ZINTER"
							,"SOFOCA"
							,"ZFORE"
							,"WAERK"
							,"DELDAT"
							,"ZRMK"
							];    // 저장 시 변경여부 체크할 항목들
var F_CHG_ARR          	= [
							 "ZPYEAR"
							,"ZPYM"
							,"SPART"
							,"VKBUR"
							,"VKGRP"
							,"ZKUNNR"
							,"GTYPE"
							,"TYPE1"
							,"TYPE2"
							,"TYPE3"
							,"ZNUMBER"
							,"KUNNR"
							,"GSNAM"
							,"REGIO"
							,"ZDELI"
							,"SHANGH"
							,"ZINTER"
							,"SOFOCA"
							,"ZFORE"
							,"WAERK"
							,"DELDAT"
							,"ZRMK"
							];		   // 변경 시 변경여부 체크할 항목들


// 서브화면 조정 필요시 값 입력, 불필요 시 ""   
var F_SMAN_WIDTH 	= "132";  	// 담당자코드 서브화면 폼 WIDTH
var F_SMAN_CD_WIDTH	= "111";  	// 담당자코드 서브화면 코드 WIDTH
var F_SMAN_NM_WIDTH	= "";  		// 담당자코드 서브화면 코드명 WIDTH 
// var F_VBVG_WIDTH 	= "";  	// 부서/팀코드 서브화면 폼 WIDTH
// var F_VBVG_VB_WIDTH	= "";  	// 부서/팀코드 서브화면 부서코드 WIDTH
// var F_VBVG_VG_WIDTH	= "";  	// 부서/팀코드 서브화면 팀코드 WIDTH
// var F_FRVB_ESSN_YN  = "";	// 시작부서코드 필수여부
// var F_TOVB_ESSN_YN  = "";	// 종료부서코드 필수여부
// var F_TOVB_HIDDEN_YN = "";	// 종료부서코드 숨김 여부

//=========================================================================================
// [ PART 2 ]
// Form Loading / Unloading 시 작업 정의
//=========================================================================================
function fn_OnLoadCompleted(obj) {
	
	gfn_initForm(true);   
	
	// 폼 초기화
	fn_init_form();
	
	/* list 코드 LOAD */ 
	gfn_SetListCode(F_FORM_ID, GC_CDGB_SPART	, ds_list_spart	, cb_spart 				, 0, "N", "Y");  	// 제품군_검색조건
	gfn_SetListCode(F_FORM_ID, GC_CDGB_REGION	, ds_region_cd	, div_detail.cb_region	, 0, "N", "Y");  	// 설치지역_저장항목
	gfn_SetListCode(F_FORM_ID, GC_CDGB_WAERK	, ds_waerk_cd	, div_detail.cb_waerk	, 0, "N", "Y");  	// 설치지역_저장항목
 	//
 	
 	// 공통코드 콤보목록 조회
 	fn_query_DD07T("ZGTYPE"	, ds_gtype_cd	);		// 기종
 	fn_query_DD07T("ZDELI"	, ds_zdeli_cd	);		// 단납구분
 	fn_query_DD07T("ZSHANG"	, ds_shangh_cd	);		// 국내/상해
 	//fn_query_DD07T("ZSHANG"	, ds_zinter_cd	);		// 중계무역 
 	 

 	// 사용자권한별 그리드의 사업장,영업그룹 콤보 설정
 	fn_init_auth_grid_vbvg();
 	
 	// 제품군 그리드 콤보 조회
 	gfn_SetListCode(F_FORM_ID, GC_CDGB_SPART, ds_list_spart_grid, grd_list, 0, "N", "N");  	// 제품군_그리드 
}

/********************************************************************************
* 기      능   : 공통코드가 조회된 후의 Callback 함수 (common.js에서 호출됨)
********************************************************************************/
function fn_completeInit(sCode, sDsObj, sCodeType) {
	gfn_showMsg("CI00007");  
}

/********************************************************************************
* 기      능   : form UnloadCompleted 
********************************************************************************/
function fn_OnUnloadCompleted(obj) {
	return gfn_isFormUnload(obj);
}
 
//=========================================================================================
// [ PART 3 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,form닫기)
//=========================================================================================
/********************************************************************************
* 기      능   : 조회 1
********************************************************************************/
function fn_query() { 
	
	trace("fn_query()호출 start");
	
	gfn_clearMsgBar(); 
	
	// sort mark 삭제 
	gfn_clearGridSortMark(grd_list); 
	
	// 조회조건 항목오류검증
	if (fn_valid_chk("query") == false)  return;
	 
	// 조회조건 설정
	ds_cond.ClearData();   
	if (fn_param_set("query") == false)  return;   
	trace(ds_cond.SaveXML());
	
	// 그리드헤더 년월 (18개월)Set
	fn_grid_header_set();
	
	// 데이타셋 이벤트 비활성화
	ds_list.Fireevent = false; 
	
	// 사업계획번호 초기화
	F_ZBPNNR = "";
	
	// 최종 변경된 셀정보 초기화
	F_CHG_COLNUM	= "";	 // 변경된 컬럼번호
	F_CHG_ROWNUM	= "";	 // 변경된 행번호 
	  
	// 서비스 호출
	ds_detail.ClearData();  
	ds_list_detail.ClearData();  
	ds_list.ClearData();   
	ds_error.ClearData();
	fn_createWait("",this);     // 처리중입니다. 메시지 처리
	nsfRequest("query"													// srvId
				, "sbp0010/find"										// url
				, "ds_cond=ds_cond ds_list=ds_list "					// inDsList
				, "ds_list=ds_list ds_error=ds_error"					// outDsList
				, ""													// strParam
				, "fn_afterQuery"										// CallBackFunc
				);
 
}

/********************************************************************************
* 기      능   : 조회 1
********************************************************************************/
function fn_query_detail() { 
	 
	trace("fn_query_detail()호출 start");
	
	gfn_clearMsgBar();  
	
	// 조회조건 항목오류검증
	if (fn_valid_chk("query_detail") == false)  return;
	 
	// 조회조건 설정
	ds_cond_detail.ClearData();   
	if (fn_param_set("query_detail") == false)  return;   
	trace(ds_cond_detail.SaveXML()); 
	
	// 사업계획번호 초기화
	F_ZBPNNR = "";
	
	// 데이타셋 이벤트 비활성화
	ds_list_detail.Fireevent = false; 
	  
	// 서비스 호출
	fn_createWait("",this);     // 처리중입니다. 메시지 처리
	ds_detail.ClearData();  
	ds_list_detail.ClearData();   
	ds_error.ClearData();  
	
	nsfRequest("query"													// srvId
				, "sbp0010/find_detail"									// url
				, "ds_cond_detail=ds_cond_detail ds_list_detail=ds_list_detail ds_yearm=ds_yearm"	// inDsList
				, "ds_detail=ds_detail ds_list_detail=ds_list_detail ds_error=ds_error"				// outDsList
				, ""													// strParam
				, "fn_afterQuery_detail"								// CallBackFunc
				);
 
}


// INPUT PARAM SET
// pProcGb : 처리구분 (query:조회)
function fn_param_set(pProcGb)
{   
	
	switch(pProcGb)
	{
		case "query" :  // 조회 시
			 
			ds_cond.AddRow();  
			
			ds_cond.SetColumn(0, "ZPYEAR"	, replace(trim(cal_zpyear.text),".","")	); 	// 편성년도   
			ds_cond.SetColumn(0, "ZPYM"		, replace(trim(cal_zpym.text),".","")	); 	// 계획년월   
			ds_cond.SetColumn(0, "SPART"	, trim(cb_spart.value)					);  // 제품군
			ds_cond.SetColumn(0, "VKBUR_FR"	, trim(div_vbvg.cb_frvb.Value)			);  // 부서코드_FR
			ds_cond.SetColumn(0, "VKBUR_TO"	, trim(div_vbvg.cb_tovb.Value)			);  // 부서코드_TO
			ds_cond.SetColumn(0, "VKGRP_FR"	, trim(div_vbvg.cb_frvg.Value)			);  // 팀코드_FR  
			ds_cond.SetColumn(0, "VKGRP_TO"	, trim(div_vbvg.cb_tovg.Value)			);  // 팀코드_TO  
			ds_cond.SetColumn(0, "ZKUNNR"	, trim(div_sman.ed_sman_cd.text)		);  // 담당자
			
			break;  
			
		case "query_detail" :  // 상세조회 시
			 
			ds_cond_detail.AddRow();  
			
			// 사업계획번호
			ds_cond_detail.SetColumn(0, "ZBPNNR", ds_list.GetColumn(ds_list.row, "ZBPNNR"));
			 	
			break;  	
			
		case "save" :  // 사업계획 저장 시  
			
			// 수주목록에서 선택한 사업계획번호에 해당하는 수주 항목을
			// 상세항목 데이타셋에 복사한다. (ds_list-->ds_detail) 
			ds_detail.AddRow(); 
			ds_list.CopyToRow(ds_list.row, ds_detail, ds_detail.row); 
			break;    
			
		default: 
			break; 
	}   

	return true;
	
}
/********************************************************************************
* 기      능   : 닫기  
********************************************************************************/
function fn_close() {
	close();
}

/********************************************************************************
* 기      능   : 액셀  
********************************************************************************/
function fn_excel() {
	
	trace("fn_excel()호출 start");
 	
 	gfn_clearMsgBar(); 
 	
	// 조회조건 항목오류검증
	if (fn_valid_chk("excel") == false)  return; 
	
	// Excel Export  
	gfn_saveToExcel(grd_list, true); 
	
}


//=========================================================================================
// [ PART 3 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,form닫기)
//=========================================================================================
/********************************************************************************
* 기      능   : 저장 : 사업계획 등록, 수정, 삭제
********************************************************************************/
function fn_save() { 
	
	trace("fn_save() start");
	
	gfn_clearMsgBar();   
	
	// 저장항목 오류검증
	if (fn_valid_chk("save") == false)  return false;
	
	// 저장여부 확인
	if (!gfn_showConfirm("CI00014", "사업계획 변경사항"))  return false; 
	
	// 저장항목 값설정  
	ds_detail.ClearData();
	if (fn_param_set("save") == false)  return false;    
	trace(ds_detail.SaveXML());
	
	// 서비스 호출 후 사업계획번호 GET
	ds_result.ClearData(); 
	ds_error.ClearData(); 
	fn_createWait("",this);     // 처리중입니다. 메시지 처리
	nsfRequest("update"																	// srvId
				, "sbp0010/save_detail"													// url
				, "ds_detail=ds_detail ds_list_detail=ds_list_detail ds_yearm=ds_yearm"	// inDsList
				, "ds_result=ds_result ds_error=ds_error"								// outDsList
				, ""																	// strParam
				, "fn_afterSave"														// CallBackFunc
				);

}
 
//=========================================================================================
// [ PART 4]
// Callback 함수 정의 : callback 함수명은 메인 함수의 fn_xxxx() 에서 xxxx 부분은 fn_afterXXXX()
// 형태가 되도록 작성 
//=========================================================================================
/********************************************************************************
* 기      능   : 조회 Callback  
********************************************************************************/
function fn_afterQuery(errCode, errMsg) {   
	
	fn_destroyWait(); 

	// 결과값 trace
	trace("fn_afterQuery 호출 start"); 
	trace(ds_list.SaveXML()); 
	trace(ds_error.SaveXML());
	
	// Action 버튼 구분자 SET
	F_WORK_GBN = "";
	
	// 데이타셋 이벤트 활성화
	ds_list.Fireevent = true;
	
	if(ds_error.rowcount() > 0) {   
	
		gfn_showMsgBar(ds_error.GetColumn(0,"ERRMSG"));   
		
	} else {
	 
		// 조회된 자료가 있을 경우 
		if (ds_list.RowCount() > 0) 
		{  
			gfn_showMsg("CI00003");  // CI00003 : "조회를 완료했습니다
			
			grd_list.SetFocus();
			
			// 상세조회 실행  (강제로 매출/청구/수금 이벤트 발생시킴)
			ds_list_OnRowPosChanged(ds_list, -1, 0); 
			
		} 
		else 
		{	 
			gfn_showMsg("CW00010"); 					// CW00010 : "데이터가 없습니다."
		}
		 
	}
	
	trace("fn_afterQuery 호출 end");
} 

/********************************************************************************
* 기      능   : 상세조회 Callback  
********************************************************************************/
function fn_afterQuery_detail(errCode, errMsg) {   
	
	fn_destroyWait(); 

	// 결과값 trace
	trace("fn_afterQuery_detail 호출 start"); 
	trace(ds_list_detail.SaveXML()); 
	trace(ds_error.SaveXML()); 
	
	// 데이타셋 이벤트 활성화
	ds_list_detail.Fireevent = true;
	
	if(ds_error.rowcount() > 0) {   
	
		gfn_showMsgBar(ds_error.GetColumn(0,"ERRMSG"));   
		
	} else {  
		
		// 조회된 자료가 있을 경우 
		if (ds_list_detail.RowCount() > 0) 
		{ 
			gfn_showMsg("CI00003");  // CI00002 : "조회를 완료했습니다.
		} 
		else 
		{	 
			gfn_showMsg("CW00010"); 		// CW00010 : "데이터가 없습니다."
		} 
		
		// 상세정보 SET
		fn_setDetailInfo(); 
	}
	
	trace("fn_afterQuery_detail 호출 end");
} 


/********************************************************************************
* 기      능   : 저장 Callback  
********************************************************************************/
function fn_afterSave(errCode, errMsg) { 

	fn_destroyWait();
	 
	trace("fn_afterSave 호출 start");  
	
	// alert("fn_afterSave.errCode : " + errCode);
	// alert("fn_afterSave.errMsg : " + errMsg);
	
	trace(ds_error.SaveXML());
	trace(ds_result.SaveXML());
	
	if(ds_error.rowcount() > 0) {   
	
		gfn_showMsgBar(ds_error.GetColumn(0,"ERRMSG"));   
		
	} else {
	
		// 사업번호SET
		F_ZBPNNR = ds_result.GetColumn(ds_result.row, "ZBPNNR");
	
		//alert("fn_afterSave.F_ZBPNNR : " + F_ZBPNNR);
	
		// 재조회
		fn_query(); 
	}
	
	trace("fn_afterSave 호출 end");
} 
 
// 임시코딩
function fn_OnClick_btn(obj)
{ 
	var fncName = "fn_" + substr(obj.id, 4); 
	eval( fncName + "()");
}

// 항목 오류 검증
// pProcGb : 처리구분 (query:조회,excel:엑셀)
function fn_valid_chk(pProcGb)
{    

	trace("fn_valid_chk.pProcGb : " + pProcGb);	

	var arr   = "";
	var ChgYn = "N"; 
	var SaveCount = 0;
	
 	switch(pProcGb)
	{
		case "input" :       // 입력버튼 클릭 시
		
			if (length(trim(cal_zpyear.text)) == 0)
			{ 
				// CW00208 : "[${}]은/는 필수입력 입니다.확인바랍니다.")
				gfn_showAlert("CW00208","편성년도");
				gfn_SetFocus(cal_zpyear,"Y"); 
				return false;
			}     
			if (length(trim(cal_zpym.Value)) == 0)
			{ 
				// CW00208 : "[${}]은/는 필수입력 입니다.확인바랍니다.")
				gfn_showAlert("CW00208","계획년월");
				gfn_SetFocus(cal_zpym,"Y"); 
				return false;
			}    
			/*
			if (length(trim(cb_spart.value)) == "0")
			{ 
				// CW00208 : "[${}]은/는 필수입력 입니다.확인바랍니다.")
				gfn_showAlert("CW00208","제품군");
				gfn_SetFocus(cb_spart,"Y"); 
				return false;
			}    
			*/
			if (length(trim(div_vbvg.cb_frvb.Value))==0)
			{ 
				// CW00208 : "[${}]은/는 필수입력 입니다.확인바랍니다.")
				gfn_showAlert("CW00208","부서");
				gfn_SetFocus(div_vbvg.cb_frvb,"Y"); 
				return false;
			}
			if (length(trim(div_vbvg.cb_frvg.Value))==0)
			{ 
				// CW00208 : "[${}]은/는 필수입력 입니다.확인바랍니다.")
				gfn_showAlert("CW00208","팀");
				gfn_SetFocus(div_vbvg.cb_frvg,"Y"); 
				return false;
			}
			if (length(trim(div_sman.ed_sman_cd.text))==0)
			{ 
				// CW00208 : "[${}]은/는 필수입력 입니다.확인바랍니다.")
				gfn_showAlert("CW00208","담당자");
				gfn_SetFocus(div_sman.ed_sman_cd,"Y"); 
				return false;
			}
			
			// 한건씩만 저장해야 하므로 신규행은 한 건만 존재해야 함
			var nRow = ds_list.FindRow("FLAG", "I");
			if (nRow >= 0)
			{ 
				alert("이미 추가되어 있습니다.");
				return false;
			}
			
			// 매출/수금/계획년월의 18개월이 SET 되어 있어야 함 
			if (ds_yearm.RowCount()== 0)
			{ 
				alert("조회 후 입력하시기 바랍니다.");
				return false;
			}
			
			break;  
			
		case "query" :    	// 조회 버튼 클릭 시
		
			if (length(trim(cal_zpyear.text)) == 0)
			{ 
				// CW00208 : "[${}]은/는 필수입력 입니다.확인바랍니다.")
				gfn_showAlert("CW00208","편성년도");
				gfn_SetFocus(cal_zpyear,"Y"); 
				return false;
			}     
			if (length(trim(cal_zpym.Value)) == 0)
			{ 
				// CW00208 : "[${}]은/는 필수입력 입니다.확인바랍니다.")
				gfn_showAlert("CW00208","계획년월");
				gfn_SetFocus(cal_zpym,"Y"); 
				return false;
			}     
			
			/*
			임시 주석처리
			if (length(trim(cb_spart.value)) == "0")
			{ 
				// CW00208 : "[${}]은/는 필수입력 입니다.확인바랍니다.")
				gfn_showAlert("CW00208","제품군");
				gfn_SetFocus(cb_spart,"Y"); 
				return false;
			}    
			if (length(trim(div_vbvg.cb_frvb.Value))==0)
			{ 
				// CW00208 : "[${}]은/는 필수입력 입니다.확인바랍니다.")
				gfn_showAlert("CW00208","부서");
				gfn_SetFocus(div_vbvg.cb_frvb,"Y"); 
				return false;
			}
			if (length(trim(div_vbvg.cb_frvg.Value))==0)
			{ 
				// CW00208 : "[${}]은/는 필수입력 입니다.확인바랍니다.")
				gfn_showAlert("CW00208","팀");
				gfn_SetFocus(div_vbvg.cb_frvg,"Y"); 
				return false;
			}
			if (length(trim(div_sman.ed_sman_cd.text))==0)
			{ 
				// CW00208 : "[${}]은/는 필수입력 입니다.확인바랍니다.")
				gfn_showAlert("CW00208","담당자");
				gfn_SetFocus(div_sman.ed_sman_cd,"Y"); 
				return false;
			} 
			*/
			
			break;  
		
		case "query_detail" : // 상세조회 시
			
			if (length(ds_list.GetColumn(ds_list.row, "ZBPNNR"))==0)
			{
				return false;
			}
			break;
			
		case "excel" :   // 엑셀
			 
			if (ds_list.RowCount() <=0)
			{ 
				// CW00010 : "데이터가 없습니다."
				gfn_showAlert("CW00010");
				return false;
			} 
			 
			// 변경된 내역이 존재할 경우 엑셀출력 불가처리
			if(gfn_isChangeDs(ds_list, false, "FLAG", "사업계획")== true) 
			{  
				//"CW10003", "변경된 ${}이 존재하여 ${}이 불가능합니다. 변경된 정보를 저장후 다시 실행하여 주십시오.");  // 2012.06.13 : GRY : 추가
				arr = ["사업계획", "엑셀출력"];
				gfn_showAlert("CW10003", arr);
				return false;
			}   
			
			break; 
			
		case "save":   	// 사업계획저장
		 
			if (length(ds_list.GetColumn(ds_list.row, "FLAG"))==0)
			{
				// CW00006=${}에 변경된 정보가 없습니다.
				gfn_showAlert("CW00006", "사업계획");
				return false; 
			}
			
			
			if (length(trim(cal_zpyear.text)) == 0)
			{ 
				// CW00208 : "[${}]은/는 필수입력 입니다.확인바랍니다.")
				gfn_showAlert("CW00208","편성년도");
				gfn_SetFocus(cal_zpyear,"Y"); 
				return false;
			}     
			if (length(trim(cal_zpym.Value)) == 0)
			{ 
				// CW00208 : "[${}]은/는 필수입력 입니다.확인바랍니다.")
				gfn_showAlert("CW00208","계획년월");
				gfn_SetFocus(cal_zpym,"Y"); 
				return false;
			}    
			
			// 선택된 행 존재여부 체크
			// alert("ds_list.FindRow(CHK,1) : " + ds_list.FindRow("CHK",1));
			// alert("ds_list.GetColumn(CHK) : " + ds_list.GetColumn(0, "CHK"));  
			// if (ds_list.FindRow("CHK",1) < 0)
			// { 
				//CW00013 : "처리할 자료를 먼저 선택해 주십시오."
				// gfn_showAlert("CW00013"); 
				// return false; 
			// }   
			 
			//alert("ds_list.GetColumn(FLAG) : " + ds_list.GetColumn(ds_list.row, "FLAG"));
			
			// 신규입력인 경우 필수입력 체크
			if (ds_list.GetColumn(ds_list.row, "FLAG") == "I" )
			{
				if (length(trim(div_vbvg.cb_frvb.Value))==0)
				{ 
					// CW00208 : "[${}]은/는 필수입력 입니다.확인바랍니다.")
					gfn_showAlert("CW00208","부서");
					gfn_SetFocus(div_vbvg.cb_frvb,"Y"); 
					return false;
				}
				if (length(trim(div_vbvg.cb_frvg.Value))==0)
				{ 
					// CW00208 : "[${}]은/는 필수입력 입니다.확인바랍니다.")
					gfn_showAlert("CW00208","팀");
					gfn_SetFocus(div_vbvg.cb_frvg,"Y"); 
					return false;
				}
				if (length(trim(div_sman.ed_sman_cd.text))==0)
				{ 
					// CW00208 : "[${}]은/는 필수입력 입니다.확인바랍니다.")
					gfn_showAlert("CW00208","담당자");
					gfn_SetFocus(div_sman.ed_sman_cd,"Y"); 
					return false;
				} 
			}
			
			// 변경항목 체크
			if (ds_list.GetColumn(ds_list.row, "FLAG") == "I" ||
			      ds_list.GetColumn(ds_list.row, "FLAG") == "U"
				)
			{ 
				if(gfn_isChangeDs(ds_list_detail, false, "FLAG", "사업계획")== false
					&& gfn_isChangeDs(ds_list, false, "FLAG", "사업계획")== false) 
				{ 
					gfn_showAlert("CW00006", "사업계획");
					return false; 
				}     
				
				// 필수입력 체크
				if (length(trim(div_detail.cb_gtype.value))==0)
				{ 
					// CW00208 : "[${}]은/는 필수입력 입니다.확인바랍니다.")
					gfn_showAlert("CW00208","기종");
					gfn_SetFocus(div_detail.cb_gtype,"Y"); 
					return false;
				} 
				if (length(trim(div_detail.cb_waerk.value))==0)
				{ 
					// CW00208 : "[${}]은/는 필수입력 입니다.확인바랍니다.")
					gfn_showAlert("CW00208","통화");
					gfn_SetFocus(div_detail.cb_waerk,"Y"); 
					return false;
				} 
				if (length(trim(div_detail.cal_deldat.value))==0)
				{ 
					// CW00208 : "[${}]은/는 필수입력 입니다.확인바랍니다.")
					gfn_showAlert("CW00208","납기예정일");
					gfn_SetFocus(div_detail.cal_deldat,"Y"); 
					return false;
				} 
				
				// 수주예상액(sofoca) 대비 매출(sa_tot), 청구(rq_tot), 수금(ys_tot) 합계 체크
				var sofoca = ds_list.GetColumn(ds_list.row, "SOFOCA") ;  // 수주예상액 
				var sa_tot = parseInt(replace(div_detail.grd_list_detail.GetCellText("Body",0,1),",",""));
				var rq_tot = parseInt(replace(div_detail.grd_list_detail.GetCellText("Body",1,1),",",""));
				var ys_tot = parseInt(replace(div_detail.grd_list_detail.GetCellText("Body",2,1),",",""));
				if (sa_tot > sofoca)
				{
					alert(div_detail.grd_list_detail.GetCellText("Body",0,0)
							+ "합계금액(" + sa_tot + ")이 수주예상액(" + sofoca + ")보다 큽니다.");
					gfn_SetFocusGrid(div_detail.grd_list_detail, 0, 1);
					return false;
				}		
				if (rq_tot > sofoca)
				{ 
					alert(div_detail.grd_list_detail.GetCellText("Body",1,0)
							+ "합계금액(" + rq_tot + ")이 수주예상액(" + sofoca + ")보다 큽니다.");
					gfn_SetFocusGrid(div_detail.grd_list_detail, 1, 1);
					return false;
				}
				if (ys_tot > sofoca)
				{ 
					alert(div_detail.grd_list_detail.GetCellText("Body",2,0)
							+ "합계금액(" + ys_tot + ")이 수주예상액(" + sofoca + ")보다 큽니다.");
					gfn_SetFocusGrid(div_detail.grd_list_detail, 2, 1);
					return false;
				}		 
				
			}
		
			break; 
			
		case "delete":   	// 사업계획삭제 
			
			// 조회된 행 존재여부 체크
			if (ds_list.row < 0 || ds_list.rowCount() < 1)
			{ 
				// CW00010 : "데이터가 없습니다."
				gfn_showAlert("CW00010");
				return false; 
			}  
			
		default: 
			break; 
	}   

	return true;
}

/********************************************************************************
* 기      능   : 새로고침
********************************************************************************/
function fn_refresh() {

	// 폼초기화
	//fn_init_form();
	
}  

// 폼 초기화 
function fn_init_form()
{ 
	// 임시코딩 
	if (length(G_SESSION_ID)==0)
	{
		btn_query.Visible = true;
		btn_input.Visible = true;
		btn_delete.Visible = true;
		btn_save.Visible = true;
		btn_excel.Visible = true;
		btn_close.Visible = true;
	}
	else
	{ 
		btn_query.Visible = false;
		btn_input.Visible = false;
		btn_delete.Visible = false;
		btn_save.Visible = false;
		btn_excel.Visible = false;
		btn_close.Visible = false;
	}
	
	// 메세지바 초기화
	gfn_clearMsgBar();   
	
	// 폼변수 초기화 
	F_ZBPNNR		= "";	// 사업계획번호
	F_CHG_COLNUM	= "";	// 변경된 컬럼번호
	F_CHG_ROWNUM	= "";	// 변경된 행번호  
	F_USER_GROUP_B  = G_USER_GROUP_B;  // 임시 추가
	F_SYSDATE   	= substr(gfn_getCurrDate(),0,8); // 현재년월일(8자리)
	
	// 데이타셋 초기화
	ds_list_opendtm.ClearData(); 	// 검색결과 마감일자 데이타셋 초기화   
	ds_list.ClearData(); 			// 검색결과 그리드 데이타셋 초기화   
	ds_detail.ClearData(); 			// 검색결과 상세  데이타셋 초기화   
	ds_list_detail.ClearData(); 	// 검색결과 매출/청구/수금목록  데이타셋 초기화   
	ds_list_save.ClearData(); 		// 저장 데이타셋 초기화
	
	// 거래선 입력항목 초기화
	div_detail.div_buyr.fn_setShowBuyrNM("Y");									// 거래선명 항목을 보여준다
	div_detail.div_buyr.fn_rsetSize(212, 62, 130);								// 거래선코드, 거래선명 사이즈 조정
	gfn_BindColumn(div_detail.div_buyr.ed_buyr_cd, "ds_list", "KUNNR"		); 	// 거래선코드 데이타셋 바인드
	gfn_BindColumn(div_detail.div_buyr.ed_buyr_nm, "ds_list", "KUNNR_NM"	); 	// 거래선명 데이타셋 바인드
	div_detail.div_buyr.ed_buyr_cd.Style = "sty_ipt_form";						// 거래선코드 스타일 SET
	div_detail.div_buyr.ed_buyr_nm.Style = "sty_ipt_form";						// 거래선명 스타일 SET
	
	// 기종정보 목록 조회 (기종코드, 제품명, 판매문서유형, 자재번호)
	fn_query_gtype(); 

	// 익년
	var zpyear = parseInt(substr(F_SYSDATE,0,4))+1; 					// 현재년월
	
	// 편성년도
	cal_zpyear.Value = zpyear + "0101"; 		// 편성년도 = 익년도
	 
	// 계획년월 기본값 SETTING
	cal_zpym.Value 	 = zpyear + "0101"; 		// 계획년월 = 익년월 
	
	// dataset 목록 설정
	ds_obj_list.ClearData();
	ds_obj_list.AddRow();
	ds_obj_list.SetColumn(0, "DS_VB"		, "ds_list_vb");  	// 그리드 부서 출력 데이타셋
	ds_obj_list.SetColumn(0, "DS_VG"		, "ds_list_vg");	// 그리드 팀콤보 출력 데이타셋
	ds_obj_list.SetColumn(0, "DS_COND_VG"	, "ds_cond_vg");	// 그리드 팀콤보출력 조건 데이타셋
	ds_obj_list.ApplyChange();
	
	// 검색조건 div의 border 삭제
	div_vbvg.Border 	= "none";  	// 부서 div
	div_sman.Border 	= "none";	// 담당자_FR div   
	
	// 코딩 시 필요한 그리드 컬럼 인덱스	   
	F_COLNUM_CHK 		= gfn_getColIdx(grd_list,"CHK"		);  // 선택여부  
	F_COLNUM_FLAG 		= gfn_getColIdx(grd_list,"FLAG"		);  // 변경구분   
	F_COLNUM_ZPYM 		= gfn_getColIdx(grd_list,"ZPYM"		);  // 계획년월  
	F_COLNUM_SPART 		= gfn_getColIdx(grd_list,"SPART"	);  // 제품군  
	F_COLNUM_VKBUR 		= gfn_getColIdx(grd_list,"VKBUR"	);  // 사업장    
	F_COLNUM_VKGRP		= gfn_getColIdx(grd_list,"VKGRP"	);  // 영업그룹    
	F_COLNUM_ZKUNNR		= gfn_getColIdx(grd_list,"ZKUNNR"	);  // 담당자
	F_COLNUM_ZKUNNR_NM	= gfn_getColIdx(grd_list,"ZKUNNR_NM");  // 담당자명
	F_COLNUM_KUNNR		= gfn_getColIdx(grd_list,"KUNNR"	);  // 거래선  
	F_COLNUM_KUNNR_NM	= gfn_getColIdx(grd_list,"KUNNR_NM"	);  // 거래선명   
	F_COLNUM_GSNAM      = gfn_getColIdx(grd_list,"GSNAM"	);	// 공사명
	F_COLNUM_REGION     = gfn_getColIdx(grd_list,"REGION"	);	// 설치지역
	F_COLNUM_GTYPE      = gfn_getColIdx(grd_list,"GTYPE"	);	// 기종
	F_COLNUM_TYPE1      = gfn_getColIdx(grd_list,"TYPE1"	);	// TYPE1 (인승)
	F_COLNUM_TYPE2      = gfn_getColIdx(grd_list,"TYPE2"	);	// TYPE2 (속도)
	F_COLNUM_TYPE3      = gfn_getColIdx(grd_list,"TYPE3"	);	// TYPE3 (층수)
	F_COLNUM_ZNUMBER    = gfn_getColIdx(grd_list,"ZNUMBER"	);	// 대수
	F_COLNUM_ZDELI      = gfn_getColIdx(grd_list,"ZDELI"	);	// 단납기구분
	F_COLNUM_SHANGH     = gfn_getColIdx(grd_list,"SHANGH"	);	// 국내/상해구분
	F_COLNUM_ZINTER     = gfn_getColIdx(grd_list,"ZINTER"	);	// 중계무역구분
	F_COLNUM_SOFOCA     = gfn_getColIdx(grd_list,"SOFOCA"	);	// 수주예상액
	F_COLNUM_ZFORE      = gfn_getColIdx(grd_list,"ZFORE"	);	// 예상시행율
	F_COLNUM_WAERK      = gfn_getColIdx(grd_list,"WAERK"	);	// 통화
	F_COLNUM_DELDAT     = gfn_getColIdx(grd_list,"DELDAT"	);	// 납기예정일
	F_COLNUM_ZRMK       = gfn_getColIdx(grd_list,"ZRMK"		);	// 비고

	// 그리드 FIX
	gfn_grid_fix(grd_list					, F_COLNUM_SPART);	// 제품군에서 fix
	gfn_grid_fix(div_detail.grd_list_detail	, F_COLNUM_TOT1);	// 합계에서 fix
	
	// 버튼 제어
	// ufn_enableBtn("input",  false);  	// 입력
	// ufn_enableBtn("delete", false);		// 삭제
	// ufn_enableBtn("save",   false);		// 저장
	// ufn_enableBtn("reset",  false);		// 리셋
	 
} 

// 팝업화면 호출
// obj : 버튼obj
function fn_OnClick_popup(obj)
{
	switch (obj.id)
	{
		case "" :  
			break; 
				
		default:
			break;
	}
	return; 
}
   

// 제품군목록 조회 CALL BACK함수
function fn_afterQuery_spart(errCode, errMsg) 
{   
	//gfn_InsertRowCombo(ds_spart_cd, 0, "Y", "N", "Y"); // 제품군목록 전체 행 추가
	//cb_spart.index = 0; 
}   
   

// 그리드 헤더 클릭 시
function grd_list_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
{
	if (nCell == 1) { 						// 선택 CELL 인 경우
		gfn_selectAllGrid2(obj,1,1,true);	// 전체 선택  
	} else { 								// 그 외 CELL 인 경우
		gfn_sortGrid(obj,nCell);			// 그리드 정렬 처리 
	} 
}

// 그리드에서 키 입력 시
function grd_list_OnKeyDown(obj,nChar,bShift,bCtrl,bAlt,nLLParam,nHLParam)
{
	trace("grd_list_OnKeyDown.nChar : " + nChar); 
	
	var ds = object(obj.BindDataset);  
	
	// 엔터키이면
	if (nChar==13)
	{ 
		ds.row = ds.row + 1;  // 다음 행으로 이동
	} 
	// Esc 키이면 변경전 자료로 되돌린다.
	else if (nChar==27)
	{  
		var nCol 	= obj.GetCellPos();
		gfn_SetOrgColumn(obj, ds.row, nCol); 
		// switch (nCol)					// 변경된 셀 인덱스
		// {
			// case F_COLNUM_DISGBN_CHK:	// 표시여부 
			// case F_COLNUM_INGTEXT:		// 진행사항 
				// gfn_SetOrgColumn(obj, ds.row, nCol); 		 
				// break; 
		// }  
	} 
	else {
		gfn_GrdCellCopyPasteReset(obj, ds, bCtrl, nChar);
		
	} 
	
	
}
 

// 행추가 버튼 클릭 시
function btn_append_OnClick(obj)
{     
	
	fn_input();   // 신규 행 추가
	
}

// 행삭제 버튼 클릭 시
function btn_cancel_OnClick(obj)
{   
	fn_delete();	// 삭제 실행  (신규행 삭제, 기존 행 FLAG처리)
} 

// 삭제 버튼 클릭 시
function fn_delete()
{
	// trace("fn_delete()호출 start"); 
	 
	// 조건 항목오류검증
	if (fn_valid_chk("delete") == false) return false; 
	
	// if (!gfn_showConfirm("CI00015","사업계획")) 
	// {
		// return;
	// }	
	
	// Grid 현재행 삭제 처리  (FLAG:D)
	// 삭제(신규행), 삭제FLAG처리(기등록자료)
	gfn_deleteGridRow( grd_list, ds_list.row, "FLAG" );	 
	if ( ds_list.GetColumn(ds_list.row, "FLAG") <> "I") 
	{ 
		ds_list.SetColumn(ds_list.row, "CHK", 1); 
		ds_detail.SetColumn(ds_detail.row, "FLAG", "D");
	}
	else 
	{
	
	}
	
}


// 사용자 권한별 그리드 부서,팀 설정
function fn_init_auth_grid_vbvg()
{  
	fn_query_grid_vb();			// 부서코드 목록 조회   
	fn_query_grid_vg("","");	// 전체 팀목록 조회 (콜백없음)
			
	/*		
	// 사용자권한에 따라 
	switch (F_USER_GROUP_B)  
	{
		case "B40" :   	// 부서, 팀 제어 가능  
			fn_query_grid_vb();			// 부서코드 목록 조회  
			fn_query_grid_vg("","");	// 전체 팀목록 조회 (콜백없음)
			break;
		  
		case "B30" : 	// 팀 제어 가능 
			fn_init_vbcd();						// 부서콤보 = 소속부서로 강제설정 
			fn_query_grid_vg(G_SAP_USER_VBCD, "");  	// 소속부서로 팀목록 조회 (콜백없음)
			break;
			
		case "B20" : 	// 제어 불가능 
			fn_init_vbcd();						// 부서콤보 = 소속부서로 강제설정 
			fn_init_vgcd();						// 팀콤보   = 소속팀으로 강제설정 
			break; 
			  
		default: 
			fn_init_vbcd();						// 부서콤보 = 소속부서로 강제설정 
			fn_init_vgcd();						// 팀콤보 = 소속팀으로 강제설정 
			break;
	} 
	*/
} 

// 그리드 부서코드 초기화
function fn_init_vbcd()
{ 
	ds_list_vb.Fireevent = false;
	ds_list_vb.ClearData();
	ds_list_vb.AddRow();
	ds_list_vb.SetColumn(0, "CODE"		, G_SAP_USER_VBCD); // 소속부서코드
	ds_list_vb.SetColumn(0, "CODE_NAME"	, G_SAP_USER_VBNM);	// 소속부서명  
	ds_list_vb.Fireevent = true; 
} 

// 그리드 팀코드 초기화
function fn_init_vgcd()
{ 
	// 시작팀코드
	ds_list_vg.Fireevent = false;
	ds_list_vg.ClearData();
	ds_list_vg.AddRow();
	ds_list_vg.SetColumn(0, "CODE"		, G_SAP_USER_VGCD); // 팀코드
	ds_list_vg.SetColumn(0, "CODE_NAME"	, G_SAP_USER_VGNM);	// 팀명 
	ds_list_vg.Fireevent = true; 
} 

// 그리드 부서코드목록 조회
function fn_query_grid_vb()
{
	// 부서 콤보목록 데이타셋 이벤트 비활성화
	ds_list_vb.Fireevent = false;   
	
	// 서비스 호출
	//fn_createWait("",this);     // 처리중입니다. 메시지 처리
	ds_list_vb.ClearData(); 
	ds_error.ClearData();
	trace(ds_obj_list.SaveXML()); 
	nsfRequest("query"												// srvId
				, "combo/gridVb"									// url
				, "ds_obj_list=ds_obj_list ds_list_vb=ds_list_vb"	// inDsList
				, "ds_list_vb=ds_list_vb ds_error=ds_error"			// outDsList
				, ""												// strParam
				, "fn_afterQuery_grid_vb"								// CallBackFunc
				);
}

// 그리드 팀코드목록 조회
// pVbCd : 부서코드
function fn_query_grid_vg(pVbCd, pCallback)
{  
	trace("fn_query_grid_vg.pVbCd : " + pVbCd);
	
	// 팀 콤보목록 조회   
	ds_cond_vg.ClearData();
	ds_cond_vg.AddRow();  
	ds_cond_vg.SetColumn(0,"VB", pVbCd);  // 부서코드 null 이면 전체 팀목록 조회
	trace(ds_cond_vg.SaveXML());
		
	// 서비스 호출 (팀목록조회) 
	fn_createWait("",this);     // 처리중입니다. 메시지 처리
	ds_list_vg.ClearData();
	ds_error.ClearData();
	nsfRequest("query"												// srvId
				, "combo/gridVg"									// url
				, "ds_obj_list=ds_obj_list ds_cond_vg=ds_cond_vg ds_list_vg=ds_list_vg"	// inDsList
				, "ds_list_vg=ds_list_vg ds_error=ds_error"			// outDsList
				, ""												// strParam
				, pCallback											// CallBackFunc
				);
} 
 
// 그리드 부서코드목록 조회 CALL BACK
function fn_afterQuery_grid_vb(errCode, errMsg) {  

	fn_destroyWait();
	 
	// 그리드 부서코드 데이타셋 이벤트 활성화
	ds_list_vb.Fireevent = true;
	
	// 결과값 trace
	// trace("fn_afterQuery_grid_vb 호출 start"); 
	// trace(ds_list_vb.SaveXML()); 
	// trace(ds_error.SaveXML()); 
	
	if(ds_error.rowcount() > 0) {   
	
		gfn_showMsgBar(ds_error.GetColumn(0,"ERRMSG"));   
		
	} else {
	  
		if (ds_list_vb.RowCount() > 0) {  	 
		} else {			 
			trace("fn_afterQuery_grid_vb SUCCESS!!! 건수없음"); 
		} 
		 
	}
	
	
	trace("fn_afterQuery_grid_vb 호출 end");
	
}  

// 그리드 팀코드목록 조회 CALL BACK (폼 로드시는 호출되지 않도록 되어 있음)
function fn_afterQuery_grid_vg(errCode, errMsg) {  

	fn_destroyWait();
	 
	// 결과값 trace
	// trace("fn_afterQuery_grid_vg 호출 start"); 
	// trace(ds_list_vg.SaveXML()); 
	// trace(ds_error.SaveXML()); 
	
	if(ds_error.rowcount() > 0) {   
	
		gfn_showMsgBar(ds_error.GetColumn(0,"ERRMSG"));   
		
	} else {
	 
		// 조회된 자료가 있을 경우
		if (ds_list_vg.RowCount() > 0) 
		{  	 
			// 선택된 부서가 소속부서인 경우 소속팀을 기본값으로 설정한다. 
			if (ds_list.GetColumn(F_CHG_ROWNUM, "VKBUR") == G_SAP_USER_VBCD) 
			{
				ds_list.SetColumn(F_CHG_ROWNUM, "VKGRP", G_SAP_USER_VGCD);  
			} 
		} 
		else 
		{			 
			trace("fn_afterQuery_grid_vg SUCCESS!!! 건수없음"); 
		}  
	}   
	
	trace("fn_afterQuery_grid_vg 호출 end");
	
}  


// 담당자코드로 담당자명 조회
// pSmanCd : 담당자코드
function fn_query_sman(pSmanCd) { 
	
	trace("fn_query_sman");
	
	gfn_clearMsgBar();   
	 
	// 조건설정 
	ds_cond_sman.ClearData(); 
	ds_cond_sman.AddRow();
	ds_cond_sman.SetColumn(ds_cond_sman.row, "sman_cd", pSmanCd); 
	trace(ds_cond_sman.SaveXML());
	
	// 서비스호출
	fn_createWait("",this);     // 처리중입니다. 메시지 처리
	ds_list_sman.ClearData(); 
	ds_error.ClearData();
	nsfRequest("query"														// srvId
				, "com0030/find"											// url
				, "ds_cond_sman=ds_cond_sman ds_list_sman=ds_list_sman"		// inDsList
				, "ds_list_sman=ds_list_sman ds_error=ds_error"				// outDsList
				, ""														// strParam
				, "fn_afterQuery_sman");									// CallBackFunc
}


/********************************************************************************
* 기      능   :  담당자 조회 Callback  
********************************************************************************/ 
function fn_afterQuery_sman(errCode, errMsg) {

	fn_destroyWait();

	// trace(ds_list_sman.SaveXML());
	
	if(ds_error.rowcount() > 0) {   
	
		gfn_showMsgBar(ds_error.GetColumn(0,"ERRMSG"));   
		
	} else {
		
		if (ds_list_sman.RowCount() == 1) { // 한 건 조회된 경우
		
			trace("F_CHG_ROWNUM 	: " + F_CHG_ROWNUM);
			trace("F_COLNUM_SMAN_NM : " + F_COLNUM_SMAN_NM);
			
			// 조회해 온 값으로 담당자명 SET 
			ds_list.Fireevent = false;
			ds_list.SetColumn(F_CHG_ROWNUM,"ZKUNNR_NM", ds_list_sman.GetColumn(ds_list_sman.row, "SMAN_NM")); 
			ds_list.Fireevent = true;
		}  
		if (ds_list_sman.RowCount() == 0) { // 자료가 없는 경우
		
			var arr = ["담당자ID", ds_list.GetColumn(F_CHG_ROWNUM, "ZKUNNR")];
			gfn_showAlert("CW10001", arr);
		}
	}
}


// 거래선코드로 거래선명 조회
// pbuyrCd : 거래선코드
function fn_query_buyr(pbuyrCd) { 
	
	trace("fn_query_buyr.pbuyrCd : " + pbuyrCd);
	
	gfn_clearMsgBar();   
	  
	// 조회조건 설정
	ds_cond_buyr.ClearData();
	ds_cond_buyr.AddRow();
	var buyr_cd = gfn_SetStrPad(trim(pbuyrCd), "0", 6, "L");
	ds_cond_buyr.SetColumn(ds_cond_buyr.row, "BUYR_CD", buyr_cd);    
	trace(ds_cond_buyr.SaveXML());
	
	// 서비스호출
	fn_createWait("",this);     // 처리중입니다. 메시지 처리
	ds_list_buyr.ClearData();
	ds_error.ClearData(); 
	nsfRequest("query"														// srvId
				, "com0040/find"											// url
				, "ds_cond_buyr=ds_cond_buyr ds_list_buyr=ds_list_buyr"		// inDsList
				, "ds_list_buyr=ds_list_buyr ds_error=ds_error"				// outDsList
				, ""														// strParam
				, "fn_afterQuery_buyr");									// CallBackFunc
}


/********************************************************************************
* 기      능   : 거래선명 조회 Callback  
********************************************************************************/ 
function fn_afterQuery_buyr(errCode, errMsg) {

	fn_destroyWait();

	trace(ds_error.SaveXML());
	trace(ds_list_buyr.SaveXML());
	
	if(ds_error.rowcount() > 0) {   
	
		gfn_showMsgBar(ds_error.GetColumn(0,"ERRMSG"));   
		
	} else {
		
		if (ds_list_buyr.RowCount() == 1) { // 한 건 조회된 경우 
			// 조회해 온 값으로 거래선명 SET 
			ds_list.SetColumn(F_CHG_ROWNUM,"KUNNR_NM", ds_list_buyr.GetColumn(ds_list_buyr.row, "BUYR_NM")); 
		}  
		if (ds_list_buyr.RowCount() == 0) { // 자료가 없는 경우 
			var arr = ["거래선코드", ds_list.GetColumn(F_CHG_ROWNUM, "KUNNR")];
			gfn_showAlert("CW10001", arr);
		}
	}
}   

// 기종목록 조회 
function fn_query_gtype() { 
	
	trace("fn_query_gtype");
	
	gfn_clearMsgBar();   
	  
	// 조회조건 설정 
	
	// 서비스호출
	fn_createWait("",this);     // 처리중입니다. 메시지 처리
	ds_list_gtype.ClearData();
	ds_error.ClearData(); 
	nsfRequest("query"												// srvId
				, "sbp0010/find_gtype"								// url
				, "ds_list_gtype=ds_list_gtype"						// inDsList
				, "ds_list_gtype=ds_list_gtype ds_error=ds_error"	// outDsList
				, ""												// strParam
				, "fn_afterQuery_gtype");							// CallBackFunc
}


/********************************************************************************
* 기      능   : 기종목록 조회 Callback  
********************************************************************************/ 
function fn_afterQuery_gtype(errCode, errMsg) {

	fn_destroyWait();

	trace(ds_error.SaveXML());
	trace(ds_list_gtype.SaveXML());
	
	if(ds_error.rowcount() > 0) {    
		gfn_showMsgBar(ds_error.GetColumn(0,"ERRMSG"));    
	}
	
}   


/********************************************************************************
* 기      능   : 기종목록에서 특정 기종정보 조회
********************************************************************************/ 
function fn_getGtypeInfo(pGType) {
 
	trace("fn_getGtypeInfo.pGType : " + pGType);
	
	// 기종정보 GET
	var nRow  = ds_list_gtype.FindRow  ("gtype",pGType);
	var spart = ds_list_gtype.GetColumn(nRow, "spart");	// 제품군
	var auart = ds_list_gtype.GetColumn(nRow, "auart");	// 판매문서유형
	var matnr = ds_list_gtype.GetColumn(nRow, "matnr");	// 자재번호 
	
	// 찾아온 정보로 상세 데이타셋 SET
	ds_list.SetColumn(ds_list.row, "SPART", spart);		// 제품군
	ds_list.SetColumn(ds_list.row, "AUART", auart);		// 판매문서유형
	ds_list.SetColumn(ds_list.row, "MATNR", matnr);		// 자재번호
	
	// 찾아온 정보로 기종정보 DISPLAY
	div_detail.cb_gtype.ToolTipText =  "제품군       ["			+gfn_GetListCodeName(F_FORM_ID, GC_CDGB_SPART, spart)+"]\n"
	                                 + "판매문서유형 ["	+auart+"]\n"
									 + "자재번호     ["	+matnr+"]"
											; 
	div_detail.ed_gtype_info.Text =   "[" + gfn_GetListCodeName(F_FORM_ID, GC_CDGB_SPART, spart) +"] "
	                                + "[" + auart + "] "
	                                + "[" + matnr + "]"
	                                ;
								 

}   

// 계획년월의 오픈일자  조회 
function fn_query_opendtm()
{ 
	trace("fn_query_opendtm ");
	
	F_CLOSE_YN = "Y";  // 마감여부 초기화	
	
	// 조건 설정
	ds_cond_opendtm.ClearData(); 
	ds_cond_opendtm.AddRow();
	ds_cond_opendtm.SetColumn(ds_cond_opendtm.row, "ZPYEAR"	, replace(cal_zpyear.text,".",""));  // 편성년도 
	trace(ds_cond_opendtm.SaveXML());
		
	// 서비스 호출 (계획년월의 오픈일시 조회)
	fn_createWait("",this);     // 처리중입니다. 메시지 처리
	ds_list_opendtm.ClearData();	
	ds_error.ClearData();
	nsfRequest("query"									// srvId
				, "sbp0010/find_opendtm"					// url
				, "ds_cond_opendtm=ds_cond_opendtm ds_list_opendtm=ds_list_opendtm"	// inDsList
				, "ds_list_opendtm=ds_list_opendtm ds_error=ds_error"				// outDsList
				, ""									// strParam
				, "fn_afterQuery_opendtm"				// CallBackFunc
				);
}

// 계획년월의 오픈일시 조회 CALL BACK
function fn_afterQuery_opendtm(errCode, errMsg) 
{   
	fn_destroyWait();

	// trace("fn_afterQuery_opendtm 호출 start"); 
	// trace(ds_error.SaveXML());
	// trace(ds_list_opendtm.SaveXML()); 
	
	if(ds_error.RowCount() > 0) 	// 조회실패
	{ 
		gfn_showMsgBar(ds_error.GetColumn(0,"ERRMSG"));   
	} 
	else 
	{ 
		// 조회된 자료가 있을 경우 
		if (ds_list_opendtm.RowCount() > 0) 
		{ 
			F_CLOSE_YN = "N"; // 마감여부
			ed_opendtm.Text = "오픈일시 : " + gfn_formatDate(ds_list_opendtm.GetColumn(0, "OPENDTM"));
			grd_list.SetFocus();  						 // 그리드 첫번째 행에 포커스 위치시킨다.
			gfn_showMsg("CI00002", ds_list_opendtm.RowCount());  // CI00002 : "조회를 완료했습니다.조회건수 [${}건]"
			
		} 
		else 
		{	
			ed_opendtm.Text = "오픈일시 : " + "없음";	 
			F_CLOSE_YN = "Y";	// 마감여부  
			gfn_showMsg("CW00010"); 					// CW00010 : "데이터가 없습니다."
		}
	}   
	
	trace("fn_afterQuery_opendtm 호출 end");
} 

// 편성년월 변경 시
function cal_zpyear_OnChanged(obj,strOldText,strNewText)
{
	trace("cal_zpyear_OnChanged.strNewText : " + strNewText);
	
	if ( length(strNewText) >= 4 )
	{
		fn_query_opendtm();	// 계획년도의 마감일자 조회
	}
}

function ds_list_OnRowPosChanged(obj,nOldRow,nRow)
{
	if (ds_list.RowCount()==0) return;
	if (ds_list.row<0) return;   
	
	// 기종 콤보 변경 이벤트 강제 실행 
	div_detail_cb_gtype_OnChanged(div_detail.cb_gtype
									,ds_list.GetColumn(ds_list.row, "GTYPE")
									,""
									,-1
									,-1);
	
	// 매출/청구/수금 상세조회 
	fn_query_detail();
}


// 기준년월에 따른 그리드 헤더(계획년월) 재설정
// YYYY.MM
function fn_grid_header_set()
{

	// trace("fn_grid_header_set.cal_zpym.text : " + cal_zpym.text);
	
	var bef_month = cal_zpyear.text + "01";  // 편성년도의 1월
	var aft_month = "";    
	
	ds_yearm.ClearData();
	
	// 편성년도의 01월부터 18개월 생성
	for (var i=0; i<18; i++)
	{
		
		// 한달 씩 더한다. 
		aft_month = gfn_getAfterMonth (bef_month, i); 
		
		//F_COLNUM_YEAYM 컬럼에 기준년월계획이 위치함
		div_detail.grd_list_detail.SetCellProp("Head"
										, parseInt(F_COLNUM_YEAYM) + i	
										, "Text"
										, substr(aft_month,0,4)+"."+substr(aft_month,4,2)+""  // YYYY.MM
										);

		// 예상년월 Dataset에 Add
		ds_yearm.AddRow();
		ds_yearm.SetColumn(i, "YEARM", aft_month);
	}
	
	trace(ds_yearm.SaveXML());
	
}


/********************************************************************************
* 기      능   : 입력 : 맨뒤에 행추가하고 상세정보 항목 초기화
********************************************************************************/
function fn_input() 
{ 
 
	// 행추가 조건 항목 오류검증
	if (fn_valid_chk("input") == false)  return;  
	
	// 행추가 (맨뒤에 추가됨 :  FLAG(I))
	var newRow = gfn_addGridRow(grd_list, -1, "FLAG");	// 추가된 행번호를 받아옴  
	  
	/// 새로 추가된 행에 기본값을 설정한다.   
	ds_list.Fireevent = false;
	ds_list.SetColumn(newRow, "NEW_YN"  	, "Y");											// 신규여부
	ds_list.SetColumn(newRow, "MANDT"	    , G_MANDT);
	ds_list.SetColumn(newRow, "ZPYEAR"		, replace(cal_zpyear.text,".",""));				// 편성년도 : 조건년도
	ds_list.SetColumn(newRow, "ZPYM"		, replace(cal_zpym.text,".",""));	 			// 제품군	:조건 제품군
	ds_list.SetColumn(newRow, "VKBUR"		, trim(div_vbvg.cb_frvb.Value));   				// 부서		:선택한 부서를 기본값으로 올려준다.
	ds_list.SetColumn(newRow, "VKGRP"		, trim(div_vbvg.cb_frvg.Value));  
	ds_list.SetColumn(newRow, "ZKUNNR"		, trim(div_sman.ed_sman_cd.text));   		   // 부서		:선택한 부서를 기본값으로 올려준다.
	ds_list.SetColumn(newRow, "ZKUNNR_NM"  , trim(div_sman.ed_sman_nm.text));   			// 부서		:선택한 부서를 기본값으로 올려준다.
	ds_list.Fireevent = true;			// 담당자코드:조건 담당자 
	   
	// 상세정보 SET
	ds_detail.ClearData();
	ds_list_detail.ClearData();
	fn_setDetailInfo(); 
	
	// 거래선 코드에 강제 focus처리
	div_detail.div_buyr.ed_buyr_cd.SetFocus(); 
	
}


/********************************************************************************
* 기      능   : 기종콤보 선택 변경 시
********************************************************************************/
function div_detail_cb_gtype_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{ 
	// 기종에 해당하는 기종정보(제품군,판매문서유형,재재번호)  조회하여 
	// 화면에 DISPLAY
	fn_getGtypeInfo(strCode);	
}

// 공통코드 조회
function fn_query_DD07T(pDomainId, pDs)
{  
	// 데이타셋 초기화
	ds_cond_dd07t.ClearData();	
	pDs.ClearData();
	
	// 데이타셋 설정
	ds_cond_dd07t.AddRow();
	ds_cond_dd07t.SetColumn(ds_cond_dd07t.row, "DOMNAME"	, pDomainId);  
	ds_cond_dd07t.SetColumn(ds_cond_dd07t.row, "CONCAT_YN"	, "N");  
	trace(ds_cond_dd07t.SaveXML());
	
	//trace("fn_afterQuery_DD07T_DomainId : " + "fn_afterQuery_DD07T_"+pDomainId); 
	
	
	// 서비스 호출
	nsfRequest("query", "combo/comboDD07T"	, "ds_cond_dd07t=ds_cond_dd07t " + pDs.ID+"="+pDs.ID
											, pDs.ID+"="+pDs.ID +" ds_error_dd07t=ds_error_dd07t"
											, ""
											, "fn_afterQuery_DD07T_"+pDomainId); 
}

// 기종 조회 CALL BACK
function fn_afterQuery_DD07T_ZGTYPE(errCode, errMsg) 
{  
	//trace("fn_afterQuery_DD07T_ZGTYPE"); 
	gfn_InsertRowCombo(ds_gtype_cd, 0, "N", "Y"); // 선택 행 추가
	div_detail.cb_gtype.index = 0;
}  

// 국내/상해 조회 CALL BACK
function fn_afterQuery_DD07T_SHANGH(errCode, errMsg) 
{  
	//trace("fn_afterQuery_DD07T_SHANGH"); 
	gfn_InsertRowCombo(ds_shangh_cd, 0, "N", "Y"); // 선택 행 추가
	div_detail.cb_shangh.index = 0;
}  

// 단납구분 조회 CALL BACK
function fn_afterQuery_DD07T_ZDELI(errCode, errMsg) 
{  
	//trace("fn_afterQuery_DD07T_ZDELI"); 
	gfn_InsertRowCombo(ds_zdeli_cd, 0, "N", "Y"); // 선택 행 추가
	div_detail.cb_zdeli.index = 0;
}  

// 중계무역구분 조회 CALL BACK
function fn_afterQuery_DD07T_ZINTER(errCode, errMsg) 
{  
	//trace("fn_afterQuery_DD07T_ZINTER"); 
	gfn_InsertRowCombo(ds_zinter_cd, 0, "N", "Y"); // 선택 행 추가
	div_detail.cb_zinter.index = 0;
}  


// 상세정보 조회 후처리 로직
function fn_setDetailInfo()
{
	trace("fn_setDetailInfo");
	
	// 사업계획번호
	F_ZBPNNR = ds_list.GetColumn(ds_list.row, "ZBPNNR");	 
	
	/*
	if (ds_list.GetRowType(ds_list.row) == "insert")
	{	
		// 신규 행인 경우 기본정보 SET 
		ds_detail.AddRow(); 
		ds_detail.SetColumn(ds_detail.row, "FLAG"	, "I");
		ds_detail.SetColumn(ds_detail.row, "MANDT"	, G_MANDT);
		ds_detail.SetColumn(ds_detail.row, "ZPYEAR"	, replace(trim(cal_zpyear.text	),".",""));
		ds_detail.SetColumn(ds_detail.row, "ZPYM"	, replace(trim(cal_zpym.text	),".",""));
		ds_detail.SetColumn(ds_detail.row, "VKBUR"	, trim(div_vbvg.cb_frvb.Value			));	// 부서		:선택한 부서를 기본값으로 올려준다.
		ds_detail.SetColumn(ds_detail.row, "VKGRP"	, trim(div_vbvg.cb_frvg.Value			)); // 부서		:선택한 부서를 기본값으로 올려준다.
		ds_detail.SetColumn(ds_detail.row, "ZKUNNR"	, trim(div_sman.ed_sman_cd.text			)); // 담당자코드:조건 담당자
		ds_detail.row = 0;
 	}
	else
	{ 
		// 수주목록에서 선택한 사업계획번호에 해당하는 수주 항목을
		// 상세항목 데이타셋에 복사한다. (ds_list-->ds_detail) 
		ds_detail.AddRow(); 
		ds_list.CopyToRow(ds_list.row, ds_detail, ds_detail.row); 
	}
	*/
	 
	// 매출, 청구, 수금 행 미존재시 강제로 1행씩 추가한다.
	var nSaRow = ds_list_detail.FindRow("GBN","1");	// 매출 행 존재여부
	var nRqRow = ds_list_detail.FindRow("GBN","2");	// 청구 행 존재여부
	var nYsRow = ds_list_detail.FindRow("GBN","3");	// 수금 행 존재여부 
	
	ds_list_detail.Fireevent = false;
	if (nSaRow < 0) 
	{
		ds_list_detail.InsertRow(0); 
		ds_list_detail.SetColumn(ds_list_detail.row, "GBN"		, "1");
		ds_list_detail.SetColumn(ds_list_detail.row, "GBN_NM"	, "매출");
	}
	if (nRqRow < 0) 
	{
		ds_list_detail.InsertRow(1); 
		ds_list_detail.SetColumn(ds_list_detail.row, "GBN"		, "2");
		ds_list_detail.SetColumn(ds_list_detail.row, "GBN_NM"	, "청구");
	}
	if (nYsRow < 0) 
	{
		ds_list_detail.InsertRow(2); 
		ds_list_detail.SetColumn(ds_list_detail.row, "GBN"		, "3");
		ds_list_detail.SetColumn(ds_list_detail.row, "GBN_NM"	, "수금");
	}
	
	// 매출의 01월에 포커싱
	ds_list_detail.row = 0; 
	div_detail.grd_list_detail.SetCellPos(2);  
	
	ds_list_detail.Fireevent = true;
	
	trace("********** 상세 조회 후 ***********"); 
	trace(ds_list_detail.SaveXML()); 
	
	
}

function ds_list_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{
	var nCol = grd_list.GetCellPos();  // 현재 컬럼번호
	
	// trace("ds_list_OnColumnChanged.row,col : " + nRow + ", " + nCol);  
	
	// Display구분, 진행하상에 대해 변경여부를 체크
	if (strColumnID = "CHK" || strColumnID == "FLAG" 
							 || strColumnID == "NEW_YN"
							 || strColumnID == "SAVE_YN") return;
							 
 
	// 값이 변경되었을 경우 변경구분 컬럼 자동 SET 
	if (varNewValue != varOldValue)  
	{  
		switch (strColumnID)
		{  
			case "GTYPE": 		// 기종인 경우   
				break;   
		} 
		
		obj.Fireevent = false; 
		obj.SetColumn(nRow, "CHK" , "1");	// 선택여부   
		obj.Fireevent = true; 
		
		// FLAG 변경 : U
		gfn_changeFlag( obj, strColumnID, nRow, "FLAG");
		
		// 변경된 현재 행번호,컬럼번호
		F_CHG_COLNUM = nCol; 	// 현재 컬럼번호
		F_CHG_ROWNUM = nRow;	// 현재 행번호 
	} 
	
}

// 목록에서 행이 변경되려고 할 때
function ds_list_CanRowPosChange(obj,nOldRow,nRow)
{
	
	var flag = obj.GetColumn(nOldRow, "FLAG"); 
	
	// 변경된 자료가 존재할 경우 이동하지 않는다.
	if (flag=="I" || flag=="U")
	{
		if(Confirm("변경된 자료가 존재합니다. \n행을 이동할 경우 변경된 정보가가 모두 삭제됩니다.\n행을 이동하시겠습니까?")=false)
		{ 
			// 행 이동하지 않기
			return false;
		} 
		else
		{
				
			// 기존 값으로 복원처리 
			ds_list.Fireevent = false;
			gfn_SetOrgColumn(grd_list, nOldRow, -1) ;
			ds_list.SetColumn(nOldRow, "FLAG", "");
			ds_list.ApplyChange();
			ds_list_detail.ClearData();
			ds_list_detail.ApplyChange();
			ds_list.Fireevent = true;
			return true;  // 행 이동하기
		}
	}
	
	
}
 
// 매출/청구/수금 항목 변경 시
function ds_list_detail_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{
	// FLAG 변경 : U 
	ds_list.SetColumn(ds_list.row, "CHK", "1");
	gfn_changeFlag( ds_list, "CHK", ds_list.row, "FLAG"); 
	
}

function div_detail_grd_list_detail_OnKeyDown(obj,nChar,bShift,bCtrl,bAlt,nLLParam,nHLParam)
{
	trace("div_detail_grd_list_detail_OnKeyDown.nChar : " + nChar); 
	
	var ds = object(obj.BindDataset);  
	
	// 엔터키이면
	if (nChar==13)
	{ 
		ds.row = ds.row + 1;  // 다음 행으로 이동
	} 
	// Esc 키이면 변경전 자료로 되돌린다.
	else if (nChar==27)
	{  
		var nCol 	= obj.GetCellPos();
		gfn_SetOrgColumn(obj, ds.row, nCol);  
	} 
	else {
		gfn_GrdCellCopyPasteReset(obj, ds, bCtrl, nChar); 
	} 
}
]]></Script>
</Window>