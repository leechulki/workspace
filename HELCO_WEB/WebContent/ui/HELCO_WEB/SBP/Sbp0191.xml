<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="562" Id="Sbp0191" Left="8" OnLoadCompleted="fn_OnLoadCompleted" OnUnloadCompleted="fn_OnUnloadCompleted" PidAttrib="7" Title="월&#32;수주계획&#32;관리-매출/청구/수금(보수)" Top="8" Ver="1.0" Width="978" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_frvb_cd">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_frvg_cd">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list_sman">
				<Contents>
					<colinfo id="SMAN_CD" size="256" type="STRING"/>
					<colinfo id="SMAN_NM" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond_sman">
				<Contents>
					<colinfo id="SMAN_CD" size="256" type="STRING"/>
					<colinfo id="SMAN_NM" size="256" type="STRING"/>
					<record>
						<SMAN_CD></SMAN_CD>
						<SMAN_NM></SMAN_NM>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond">
				<Contents>
					<colinfo id="FR_ZPYM" size="256" type="STRING"/>
					<colinfo id="TO_ZPYM" size="256" type="STRING"/>
					<colinfo id="ZPYM" size="256" type="STRING"/>
					<colinfo id="SPART" size="256" type="STRING"/>
					<colinfo id="ZKUNNR" size="256" type="STRING"/>
					<colinfo id="VKBUR" size="256" type="STRING"/>
					<colinfo id="VKGRP" size="256" type="STRING"/>
					<colinfo id="ZMPFLG" size="256" type="STRING"/>
					<colinfo id="SORLT" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list" OnColumnChanged="ds_list_OnColumnChanged" OnRowPosChanged="ds_list_OnRowPosChanged">
				<Contents>
					<colinfo id="ZMPFLG" size="256" type="STRING"/>
					<colinfo id="MANDT" size="256" type="STRING"/>
					<colinfo id="SONNR" size="256" type="STRING"/>
					<colinfo id="ZPYM" size="256" type="STRING"/>
					<colinfo id="SPART" size="256" type="STRING"/>
					<colinfo id="AUART" size="256" type="STRING"/>
					<colinfo id="MATNR" size="256" type="STRING"/>
					<colinfo id="VKBUR" size="256" type="STRING"/>
					<colinfo id="VKGRP" size="256" type="STRING"/>
					<colinfo id="ZKUNNR" size="256" type="STRING"/>
					<colinfo id="GTYPE" size="256" type="STRING"/>
					<colinfo id="ZNUMBER" size="5" type="DECIMAL"/>
					<colinfo id="KUNNR" size="256" type="STRING"/>
					<colinfo id="KUNNR_NM" size="256" type="STRING"/>
					<colinfo id="GSNAM" size="256" type="STRING"/>
					<colinfo id="REGION" size="256" type="STRING"/>
					<colinfo id="ZDELI" size="256" type="STRING"/>
					<colinfo id="SOFOCA" size="15" type="DECIMAL"/>
					<colinfo id="ZFORE" size="4" type="DECIMAL"/>
					<colinfo id="WAERK" size="256" type="STRING"/>
					<colinfo id="PSPIDSV" size="256" type="STRING"/>
					<colinfo id="ZHOGISV" size="256" type="STRING"/>
					<colinfo id="ZRMK" size="256" type="STRING"/>
					<colinfo id="SOABLE" size="256" type="STRING"/>
					<colinfo id="SORLT" size="256" type="STRING"/>
					<colinfo id="SOPRICE" size="15" type="DECIMAL"/>
					<colinfo id="SHANG" size="4" type="DECIMAL"/>
					<colinfo id="ZBPNNR" size="256" type="STRING"/>
					<colinfo id="CDATE" size="256" type="STRING"/>
					<colinfo id="CTIME" size="256" type="STRING"/>
					<colinfo id="CUSER" size="256" type="STRING"/>
					<colinfo id="UDATE" size="256" type="STRING"/>
					<colinfo id="UTIME" size="256" type="STRING"/>
					<colinfo id="UUSER" size="256" type="STRING"/>
					<colinfo id="DDATE" size="256" type="STRING"/>
					<colinfo id="DTIME" size="256" type="STRING"/>
					<colinfo id="DUSER" size="256" type="STRING"/>
					<colinfo id="ZSVCGBN" size="256" type="STRING"/>
					<colinfo id="ZAGNT" size="256" type="STRING"/>
					<colinfo id="LAND1_NM" size="256" type="STRING"/>
					<colinfo id="ZAREA_NM" size="256" type="STRING"/>
					<colinfo id="CHK" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list_detail">
				<Contents>
					<colinfo id="MANDT" size="3" type="STRING"/>
					<colinfo id="GBN" size="1" type="STRING"/>
					<colinfo id="GBN_NM" size="10" type="STRING"/>
					<colinfo id="AMT00" size="13" type="DECIMAL"/>
					<colinfo id="AMT01" size="13" type="DECIMAL"/>
					<colinfo id="AMT02" size="13" type="DECIMAL"/>
					<colinfo id="AMT03" size="13" type="DECIMAL"/>
					<colinfo id="AMT04" size="13" type="DECIMAL"/>
					<colinfo id="AMT05" size="13" type="DECIMAL"/>
					<colinfo id="AMT06" size="13" type="DECIMAL"/>
					<colinfo id="AMT07" size="13" type="DECIMAL"/>
					<colinfo id="AMT08" size="13" type="DECIMAL"/>
					<colinfo id="AMT09" size="13" type="DECIMAL"/>
					<colinfo id="AMT10" size="13" type="DECIMAL"/>
					<colinfo id="AMT11" size="13" type="DECIMAL"/>
					<colinfo id="AMT12" size="13" type="DECIMAL"/>
					<colinfo id="AMT13" size="13" type="DECIMAL"/>
					<colinfo id="AMT14" size="13" type="DECIMAL"/>
					<colinfo id="AMT15" size="13" type="DECIMAL"/>
					<colinfo id="AMT16" size="13" type="DECIMAL"/>
					<colinfo id="AMT17" size="13" type="DECIMAL"/>
					<colinfo id="AMT18" size="13" type="DECIMAL"/>
					<colinfo id="AMT19" size="13" type="DECIMAL"/>
					<colinfo id="AMT20" size="13" type="DECIMAL"/>
					<colinfo id="AMT21" size="13" type="DECIMAL"/>
					<colinfo id="AMT22" size="13" type="DECIMAL"/>
					<colinfo id="AMT23" size="13" type="DECIMAL"/>
					<colinfo id="AMT24" size="13" type="DECIMAL"/>
					<colinfo id="AMT25" size="13" type="DECIMAL"/>
					<colinfo id="AMT26" size="13" type="DECIMAL"/>
					<colinfo id="AMT27" size="13" type="DECIMAL"/>
					<colinfo id="AMT28" size="13" type="DECIMAL"/>
					<colinfo id="AMT29" size="13" type="DECIMAL"/>
					<colinfo id="USER_ID" size="10" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_yearf_cd">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_monthf_cd">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
					<record>
						<CODE>01</CODE>
						<CODE_NAME>1월</CODE_NAME>
					</record>
					<record>
						<CODE>02</CODE>
						<CODE_NAME>2월</CODE_NAME>
					</record>
					<record>
						<CODE>03</CODE>
						<CODE_NAME>3월</CODE_NAME>
					</record>
					<record>
						<CODE>04</CODE>
						<CODE_NAME>4월</CODE_NAME>
					</record>
					<record>
						<CODE>05</CODE>
						<CODE_NAME>5월</CODE_NAME>
					</record>
					<record>
						<CODE>06</CODE>
						<CODE_NAME>6월</CODE_NAME>
					</record>
					<record>
						<CODE>07</CODE>
						<CODE_NAME>7월</CODE_NAME>
					</record>
					<record>
						<CODE>08</CODE>
						<CODE_NAME>8월</CODE_NAME>
					</record>
					<record>
						<CODE>09</CODE>
						<CODE_NAME>9월</CODE_NAME>
					</record>
					<record>
						<CODE>10</CODE>
						<CODE_NAME>10월</CODE_NAME>
					</record>
					<record>
						<CODE>11</CODE>
						<CODE_NAME>11월</CODE_NAME>
					</record>
					<record>
						<CODE>12</CODE>
						<CODE_NAME>12월</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_auart_cd">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_yearm">
				<Contents>
					<colinfo id="YEARM" size="6" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_result">
				<Contents>
					<colinfo id="PSPID" size="10" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond_detail">
				<Contents>
					<colinfo id="PSPID" size="10" type="STRING"/>
					<colinfo id="ZMPFLG" size="10" type="STRING"/>
					<colinfo id="WAERK" size="10" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_spart_cd">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
					<record>
						<CODE>10</CODE>
						<CODE_NAME>승강기</CODE_NAME>
					</record>
					<record>
						<CODE>20</CODE>
						<CODE_NAME>주차</CODE_NAME>
					</record>
					<record>
						<CODE>30</CODE>
						<CODE_NAME>물류</CODE_NAME>
					</record>
					<record>
						<CODE>40</CODE>
						<CODE_NAME>PSD</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_land_cd">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_zarea_cd">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
					<record>
						<CODE>NEA</CODE>
						<CODE_NAME>동북아</CODE_NAME>
					</record>
					<record>
						<CODE>SEA</CODE>
						<CODE_NAME>동남아</CODE_NAME>
					</record>
					<record>
						<CODE>SWA</CODE>
						<CODE_NAME>서남아</CODE_NAME>
					</record>
					<record>
						<CODE>MES</CODE>
						<CODE_NAME>중동</CODE_NAME>
					</record>
					<record>
						<CODE>AFR</CODE>
						<CODE_NAME>아프리카</CODE_NAME>
					</record>
					<record>
						<CODE>CIS</CODE>
						<CODE_NAME>CIS지역</CODE_NAME>
					</record>
					<record>
						<CODE>AME</CODE>
						<CODE_NAME>미주</CODE_NAME>
					</record>
					<record>
						<CODE>EUR</CODE>
						<CODE_NAME>유럽</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_shangh">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
					<record>
						<CODE>국내</CODE>
						<CODE_NAME>국내</CODE_NAME>
					</record>
					<record>
						<CODE>상해</CODE>
						<CODE_NAME>상해</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_waerk">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
					<record>
						<CODE>KRW</CODE>
						<CODE_NAME>KRW</CODE_NAME>
					</record>
					<record>
						<CODE>USD</CODE>
						<CODE_NAME>USD</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_sorlt">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
					<record>
						<CODE>수주</CODE>
						<CODE_NAME>수주</CODE_NAME>
					</record>
					<record>
						<CODE>이월</CODE>
						<CODE_NAME>이월</CODE_NAME>
					</record>
					<record>
						<CODE>실패</CODE>
						<CODE_NAME>실패</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_soable">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
					<record>
						<CODE>A</CODE>
						<CODE_NAME>A</CODE_NAME>
					</record>
					<record>
						<CODE>B</CODE>
						<CODE_NAME>B</CODE_NAME>
					</record>
					<record>
						<CODE>C</CODE>
						<CODE_NAME>C</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_delete">
				<Contents>
					<colinfo id="ID" size="256" type="STRING"/>
					<colinfo id="ROW" size="256" type="STRING"/>
					<record>
						<ID>delete</ID>
						<ROW></ROW>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_error">
				<Contents>
					<colinfo id="IDX" size="256" type="STRING"/>
					<colinfo id="ERRMSG" size="256" type="STRING"/>
				</Contents>
			</Dataset>
		</Datasets>
		<Grid AutoEnter="TRUE" AutoFitEndLine="Hide" BindDataset="ds_list" BkColor2="default" BoldHead="true" Border="Flat" Bottom="448" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="384" Id="grd_list" InputPanel="FALSE" Left="8" LineColor="user20" LineType="ExHORZ" OnCellClick="grd_list_OnCellClick" Right="973" RowHeight="20" Style="sty_grid" TabOrder="1" TabStop="true" Top="64" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="965">
			<contents>
				<format id="Default">
					<columns>
						<col fix="left" width="60"/>
						<col fix="left" width="0"/>
						<col fix="left" width="60"/>
						<col fix="left" width="0"/>
						<col fix="left" width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="0"/>
						<col width="80"/>
						<col width="0"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="90"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="0"/>
						<col width="0"/>
						<col width="0"/>
						<col width="0"/>
						<col width="0"/>
						<col width="0"/>
						<col width="0"/>
						<col width="0"/>
						<col width="0"/>
						<col width="0"/>
						<col width="0"/>
						<col width="0"/>
					</columns>
					<head>
						<cell bkimageid="icon_window_03" col="0" display="text"/>
						<cell align="center" col="1" display="text" font="굴림,9" text="선택"/>
						<cell align="center" col="2" display="text" font="굴림,9" text="이동계획"/>
						<cell align="center" col="3" display="text" font="굴림,9" text="클라이언트"/>
						<cell align="center" col="4" display="text" font="굴림,9" text="수주계획번호"/>
						<cell align="center" col="5" display="text" font="굴림,9" text="계획년월"/>
						<cell align="center" col="6" display="text" font="굴림,9" text="제품군"/>
						<cell align="center" col="7" display="text" font="굴림,9" text="판매문서유형"/>
						<cell align="center" col="8" display="text" font="굴림,9" text="보수구분"/>
						<cell align="center" col="9" display="text" font="굴림,9" text="자재번호"/>
						<cell align="center" col="10" display="text" font="굴림,9" text="사업장"/>
						<cell align="center" col="11" display="text" font="굴림,9" text="영업그룹"/>
						<cell align="center" col="12" display="text" font="굴림,9" text="영업사원"/>
						<cell align="center" col="13" display="text" font="굴림,9" text="협력사"/>
						<cell align="center" col="14" display="text" font="굴림,9" text="대표기종"/>
						<cell align="center" col="15" display="text" font="굴림,9" text="대수"/>
						<cell align="center" col="16" display="text" font="굴림,9" text="고객번호"/>
						<cell align="center" col="17" display="text" font="굴림,9" text="고객명"/>
						<cell align="center" col="18" display="text" font="굴림,9" text="국가"/>
						<cell align="center" col="19" display="text" font="굴림,9" text="권역"/>
						<cell align="center" col="20" display="text" font="굴림,9" text="공사명"/>
						<cell align="center" col="21" display="text" font="굴림,9" text="설치지역"/>
						<cell align="center" col="22" display="text" font="굴림,9" text="단납기구분"/>
						<cell align="center" col="23" display="text" font="굴림,9" text="수주예상액"/>
						<cell align="center" col="24" display="text" font="굴림,9" text="예상시행율"/>
						<cell align="center" col="25" display="text" font="굴림,9" text="통화"/>
						<cell align="center" col="26" display="text" font="굴림,9" text="보수프로젝트"/>
						<cell align="center" col="27" display="text" font="굴림,9" text="보수호기번호"/>
						<cell align="center" col="28" display="text" font="굴림,9" text="비고"/>
						<cell align="center" col="29" display="text" font="굴림,9" text="수주가능성"/>
						<cell align="center" col="30" display="text" font="굴림,9" text="수주결과"/>
						<cell align="center" col="31" display="text" font="굴림,9" text="수주금액"/>
						<cell align="center" col="32" display="text" font="굴림,9" text="시행율"/>
						<cell align="center" col="33" display="text" font="굴림,9" text="사업계획번호"/>
						<cell align="center" col="34" display="text" font="굴림,9" text="입력일"/>
						<cell align="center" col="35" display="text" font="굴림,9" text="입력시간"/>
						<cell align="center" col="36" display="text" font="굴림,9" text="입력자"/>
						<cell align="center" col="37" display="text" font="굴림,9" text="변경일"/>
						<cell align="center" col="38" display="text" font="굴림,9" text="변경시간"/>
						<cell align="center" col="39" display="text" font="굴림,9" text="변경자"/>
						<cell align="center" col="40" display="text" font="굴림,9" text="삭제일"/>
						<cell align="center" col="41" display="text" font="굴림,9" text="삭제시간"/>
						<cell align="center" col="42" display="text" font="굴림,9" text="삭제자"/>
					</head>
					<body>
						<cell align="center" bkcolor2="user22" col="0" display="text" expr="currow+1"/>
						<cell align="center" bkcolor2="user22" col="1" colid="CHK" display="checkbox"/>
						<cell align="center" bkcolor2="user22" col="2" colid="ZMPFLG" display="checkbox" expr="decode(ZMPFLG,&apos;X&apos;,1,1,1)"/>
						<cell align="center" bkcolor2="user22" col="3" colid="MANDT" display="text"/>
						<cell align="center" bkcolor2="user22" col="4" colid="SONNR" display="text"/>
						<cell align="center" bkcolor2="user22" col="5" colid="ZPYM" display="text" Mask="####-##"/>
						<cell align="center" bkcolor2="user22" col="6" colid="SPART" combocol="CODE" combodataset="ds_spart_cd" combotext="CODE_NAME" display="combo"/>
						<cell align="center" bkcolor2="user22" col="7" colid="AUART" display="text"/>
						<cell align="center" bkcolor2="user22" col="8" colid="ZSVCGBN" display="text"/>
						<cell align="center" bkcolor2="user22" col="9" colid="MATNR" display="text"/>
						<cell align="center" bkcolor2="user22" col="10" colid="VKBUR" combocol="CODE" combodataset="ds_frvb_cd" combotext="CODE_NAME" display="combo"/>
						<cell align="center" bkcolor2="user22" col="11" colid="VKGRP" combocol="CODE" combodataset="ds_frvg_cd" combotext="CODE_NAME" display="combo"/>
						<cell align="center" bkcolor2="user22" col="12" colid="ZKUNNR" display="text"/>
						<cell align="center" bkcolor2="user22" col="13" colid="ZAGNT" display="text"/>
						<cell align="center" bkcolor2="user22" col="14" colid="GTYPE" combocol="CODE" combodataset="ds_gtype" combotext="CODE" display="combo"/>
						<cell align="right" bkcolor2="user22" col="15" colid="ZNUMBER" display="number"/>
						<cell align="center" bkcolor2="user22" col="16" colid="KUNNR" display="text" expandshow="true"/>
						<cell align="center" bkcolor2="user22" col="17" colid="KUNNR_NM" display="text"/>
						<cell align="center" bkcolor2="user22" col="18" colid="LAND1_NM" display="text"/>
						<cell align="center" bkcolor2="user22" col="19" colid="ZAREA_NM" display="text"/>
						<cell align="center" bkcolor2="user22" col="20" colid="GSNAM" display="text"/>
						<cell align="center" bkcolor2="user22" col="21" colid="REGION" combocol="CODE" combodataset="ds_region" combotext="CODE_NAME" display="combo"/>
						<cell align="center" bkcolor2="user22" col="22" colid="ZDELI" display="checkbox"/>
						<cell align="right" bkcolor2="user22" col="23" colid="SOFOCA" display="number"/>
						<cell align="right" bkcolor2="user22" col="24" colid="ZFORE" display="number"/>
						<cell align="center" bkcolor2="user22" col="25" colid="WAERK" combocol="CODE_NAME" combodataset="ds_waerk" combotext="CODE_NAME" display="text"/>
						<cell align="center" bkcolor2="user22" col="26" colid="PSPIDSV" display="text"/>
						<cell align="center" bkcolor2="user22" col="27" colid="ZHOGISV" display="text"/>
						<cell align="center" bkcolor2="user22" col="28" colid="ZRMK" display="text"/>
						<cell align="center" bkcolor2="user22" col="29" colid="SOABLE" combocol="CODE" combodataset="ds_soable" combotext="CODE_NAME" display="combo"/>
						<cell align="center" bkcolor2="user22" col="30" colid="SORLT" combocol="CODE" combodataset="ds_sorlt" combotext="CODE_NAME" display="combo"/>
						<cell align="center" bkcolor2="user22" col="31" colid="SOPRICE" display="text"/>
						<cell align="center" bkcolor2="user22" col="32" colid="SHANG" display="text"/>
						<cell align="center" bkcolor2="user22" col="33" colid="ZBPNNR" display="text"/>
						<cell align="center" bkcolor2="user22" col="34" colid="CDATE" display="text"/>
						<cell align="center" bkcolor2="user22" col="35" colid="CTIME" display="text"/>
						<cell align="center" bkcolor2="user22" col="36" colid="CUSER" display="text"/>
						<cell align="center" bkcolor2="user22" col="37" colid="UDATE" display="text"/>
						<cell align="center" bkcolor2="user22" col="38" colid="UTIME" display="text"/>
						<cell align="center" bkcolor2="user22" col="39" colid="UUSER" display="text"/>
						<cell align="center" bkcolor2="user22" col="40" colid="DDATE" display="text"/>
						<cell align="center" bkcolor2="user22" col="41" colid="DTIME" display="text"/>
						<cell align="center" bkcolor2="user22" col="42" colid="DUSER" display="text"/>
					</body>
					<summary>
						<cell align="center" bkcolor="user25" col="0" colspan="5" text="합계"/>
						<cell bkcolor="user25" col="5" colspan="10"/>
						<cell align="right" bkcolor="user25" col="15" display="number" expr='SUM(&quot;ZNUMBER&quot;)'/>
						<cell bkcolor="user25" col="16" colspan="7"/>
						<cell align="right" bkcolor="user25" col="23" display="number" expr='CASESUM(&quot;WAERK==&apos;KRW&apos;&quot;,&#32;&quot;SOFOCA&quot;)'/>
						<cell align="right" bkcolor="user25" col="24" display="number" expr='ROUND(SUM(&quot;ZFORE&quot;)&#32;/&#32;parseInt(ds_list.Rowcount()),&#32;2)'/>
						<cell bkcolor="user25" col="25" colspan="6"/>
						<cell bkcolor="user25" col="31"/>
						<cell bkcolor="user25" col="32"/>
						<cell bkcolor="user25" col="33"/>
						<cell bkcolor="user25" col="34"/>
						<cell bkcolor="user25" col="35"/>
						<cell bkcolor="user25" col="36"/>
						<cell bkcolor="user25" col="37"/>
						<cell bkcolor="user25" col="38"/>
						<cell bkcolor="user25" col="39"/>
						<cell bkcolor="user25" col="40"/>
						<cell bkcolor="user25" col="41"/>
						<cell bkcolor="user25" col="42"/>
					</summary>
				</format>
			</contents>
		</Grid>
		<Grid AutoEnter="TRUE" AutoFitEndLine="Hide" BindDataset="ds_list_detail" BkColor2="default" BoldHead="true" Border="Flat" Bottom="554" ColSelect="TRUE" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="98" Id="grd_list_detail" InputPanel="FALSE" Left="8" LineColor="user20" LineType="ExHORZ" OnCellPosChanged="grd_list_detail_OnCellPosChanged" OnChar="grd_list_detail_OnChar" OnKeyDown="grd_list_detail_OnKeyDown" Right="973" RowHeight="20" Style="sty_grid" TabOrder="2" TabStop="true" Top="456" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="965">
			<contents>
				<format id="Default">
					<columns>
						<col width="44"/>
						<col width="100"/>
						<col width="60"/>
						<col width="60"/>
						<col width="60"/>
						<col width="60"/>
						<col width="60"/>
						<col width="60"/>
						<col width="60"/>
						<col width="60"/>
						<col width="60"/>
						<col width="60"/>
						<col width="60"/>
						<col width="60"/>
						<col width="60"/>
						<col width="60"/>
						<col width="60"/>
						<col width="60"/>
						<col width="60"/>
						<col width="60"/>
						<col width="60"/>
						<col width="60"/>
						<col width="60"/>
						<col width="60"/>
						<col width="60"/>
						<col width="60"/>
						<col width="60"/>
						<col width="60"/>
						<col width="60"/>
						<col width="60"/>
						<col width="60"/>
						<col width="60"/>
					</columns>
					<head>
						<cell align="center" col="0" display="text" font="굴림,9" text="구분"/>
						<cell align="center" col="1" display="text" font="굴림,9" text="합계"/>
						<cell align="center" col="2" display="text" font="굴림,9" text="M+0"/>
						<cell align="center" col="3" display="text" font="굴림,9" text="M+1"/>
						<cell align="center" col="4" display="text" font="굴림,9" text="M+2"/>
						<cell align="center" col="5" display="text" font="굴림,9" text="M+3"/>
						<cell align="center" col="6" display="text" font="굴림,9" text="M+4"/>
						<cell align="center" col="7" display="text" font="굴림,9" text="M+5"/>
						<cell align="center" col="8" display="text" font="굴림,9" text="M+6"/>
						<cell align="center" col="9" display="text" font="굴림,9" text="M+7"/>
						<cell align="center" col="10" display="text" font="굴림,9" text="M+8"/>
						<cell align="center" col="11" display="text" font="굴림,9" text="M+9"/>
						<cell align="center" col="12" display="text" font="굴림,9" text="M+10"/>
						<cell align="center" col="13" display="text" font="굴림,9" text="M+11"/>
						<cell align="center" col="14" display="text" font="굴림,9" text="M+12"/>
						<cell align="center" col="15" display="text" font="굴림,9" text="M+13"/>
						<cell align="center" col="16" display="text" font="굴림,9" text="M+14"/>
						<cell align="center" col="17" display="text" font="굴림,9" text="M+15"/>
						<cell align="center" col="18" display="text" font="굴림,9" text="M+16"/>
						<cell align="center" col="19" display="text" font="굴림,9" text="M+17"/>
						<cell align="center" col="20" display="text" font="굴림,9" text="M+18"/>
						<cell align="center" col="21" display="text" font="굴림,9" text="M+19"/>
						<cell align="center" col="22" display="text" font="굴림,9" text="M+20"/>
						<cell align="center" col="23" display="text" font="굴림,9" text="M+21"/>
						<cell align="center" col="24" display="text" font="굴림,9" text="M+22"/>
						<cell align="center" col="25" display="text" font="굴림,9" text="M+23"/>
						<cell align="center" col="26" display="text" font="굴림,9" text="M+24"/>
						<cell align="center" col="27" display="text" font="굴림,9" text="M+25"/>
						<cell align="center" col="28" display="text" font="굴림,9" text="M+26"/>
						<cell align="center" col="29" display="text" font="굴림,9" text="M+27"/>
						<cell align="center" col="30" display="text" font="굴림,9" text="M+28"/>
						<cell align="center" col="31" display="text" font="굴림,9" text="M+29"/>
					</head>
					<body>
						<cell align="center" bkcolor2="user22" col="0" colid="GBN_NM"/>
						<cell align="right" bkcolor2="user22" col="1" display="number" expr="AMT00+AMT01+AMT02+AMT03+AMT04+AMT05+AMT06+AMT07+AMT08+AMT09+AMT10+AMT11+AMT12+AMT13+AMT14+AMT15+AMT16+AMT17+AMT18+AMT19+AMT20+AMT21+AMT22+AMT23+AMT24+AMT25+AMT26+AMT27+AMT28+AMT29" limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="2" colid="AMT00" display="number" edit='expr:decode(F_CLOSE_YN,&quot;Y&quot;,&quot;none&quot;,&#32;&quot;normal&quot;)' limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="3" colid="AMT01" display="number" edit='expr:decode(F_CLOSE_YN,&quot;Y&quot;,&quot;none&quot;,&#32;&quot;normal&quot;)' limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="4" colid="AMT02" display="number" edit='expr:decode(F_CLOSE_YN,&quot;Y&quot;,&quot;none&quot;,&#32;&quot;normal&quot;)' limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="5" colid="AMT03" display="number" edit='expr:decode(F_CLOSE_YN,&quot;Y&quot;,&quot;none&quot;,&#32;&quot;normal&quot;)' limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="6" colid="AMT04" display="number" edit='expr:decode(F_CLOSE_YN,&quot;Y&quot;,&quot;none&quot;,&#32;&quot;normal&quot;)' limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="7" colid="AMT05" display="number" edit='expr:decode(F_CLOSE_YN,&quot;Y&quot;,&quot;none&quot;,&#32;&quot;normal&quot;)' limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="8" colid="AMT06" display="number" edit='expr:decode(F_CLOSE_YN,&quot;Y&quot;,&quot;none&quot;,&#32;&quot;normal&quot;)' limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="9" colid="AMT07" display="number" edit='expr:decode(F_CLOSE_YN,&quot;Y&quot;,&quot;none&quot;,&#32;&quot;normal&quot;)' limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="10" colid="AMT08" display="number" edit='expr:decode(F_CLOSE_YN,&quot;Y&quot;,&quot;none&quot;,&#32;&quot;normal&quot;)' limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="11" colid="AMT09" display="number" edit='expr:decode(F_CLOSE_YN,&quot;Y&quot;,&quot;none&quot;,&#32;&quot;normal&quot;)' limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="12" colid="AMT10" display="number" edit='expr:decode(F_CLOSE_YN,&quot;Y&quot;,&quot;none&quot;,&#32;&quot;normal&quot;)' limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="13" colid="AMT11" display="number" edit='expr:decode(F_CLOSE_YN,&quot;Y&quot;,&quot;none&quot;,&#32;&quot;normal&quot;)' limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="14" colid="AMT12" display="number" edit='expr:decode(F_CLOSE_YN,&quot;Y&quot;,&quot;none&quot;,&#32;&quot;normal&quot;)' limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="15" colid="AMT13" display="number" edit='expr:decode(F_CLOSE_YN,&quot;Y&quot;,&quot;none&quot;,&#32;&quot;normal&quot;)' limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="16" colid="AMT14" display="number" edit='expr:decode(F_CLOSE_YN,&quot;Y&quot;,&quot;none&quot;,&#32;&quot;normal&quot;)' limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="17" colid="AMT15" display="number" edit='expr:decode(F_CLOSE_YN,&quot;Y&quot;,&quot;none&quot;,&#32;&quot;normal&quot;)' limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="18" colid="AMT16" display="number" edit='expr:decode(F_CLOSE_YN,&quot;Y&quot;,&quot;none&quot;,&#32;&quot;normal&quot;)' limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="19" colid="AMT17" display="number" edit='expr:decode(F_CLOSE_YN,&quot;Y&quot;,&quot;none&quot;,&#32;&quot;normal&quot;)' limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="20" colid="AMT18" display="number" edit='expr:decode(F_CLOSE_YN,&quot;Y&quot;,&quot;none&quot;,&#32;&quot;normal&quot;)' limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="21" colid="AMT19" display="number" edit='expr:decode(F_CLOSE_YN,&quot;Y&quot;,&quot;none&quot;,&#32;&quot;normal&quot;)' limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="22" colid="AMT20" display="number" edit='expr:decode(F_CLOSE_YN,&quot;Y&quot;,&quot;none&quot;,&#32;&quot;normal&quot;)' limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="23" colid="AMT21" display="number" edit='expr:decode(F_CLOSE_YN,&quot;Y&quot;,&quot;none&quot;,&#32;&quot;normal&quot;)' limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="24" colid="AMT22" display="number" edit='expr:decode(F_CLOSE_YN,&quot;Y&quot;,&quot;none&quot;,&#32;&quot;normal&quot;)' limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="25" colid="AMT23" display="number" edit='expr:decode(F_CLOSE_YN,&quot;Y&quot;,&quot;none&quot;,&#32;&quot;normal&quot;)' limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="26" colid="AMT24" display="number" edit='expr:decode(F_CLOSE_YN,&quot;Y&quot;,&quot;none&quot;,&#32;&quot;normal&quot;)' limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="27" colid="AMT25" display="number" edit='expr:decode(F_CLOSE_YN,&quot;Y&quot;,&quot;none&quot;,&#32;&quot;normal&quot;)' limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="28" colid="AMT26" display="number" edit='expr:decode(F_CLOSE_YN,&quot;Y&quot;,&quot;none&quot;,&#32;&quot;normal&quot;)' limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="29" colid="AMT27" display="number" edit='expr:decode(F_CLOSE_YN,&quot;Y&quot;,&quot;none&quot;,&#32;&quot;normal&quot;)' limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="30" colid="AMT28" display="number" edit='expr:decode(F_CLOSE_YN,&quot;Y&quot;,&quot;none&quot;,&#32;&quot;normal&quot;)' limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="31" colid="AMT29" display="number" edit='expr:decode(F_CLOSE_YN,&quot;Y&quot;,&quot;none&quot;,&#32;&quot;normal&quot;)' limit="13" LimitDec="0"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Shape BKColor="user0" Bottom="60" Height="52" Id="Shape1" Left="8" LineColor="user1" Right="970" TabOrder="3" Top="8" Type="Rectangle" Width="962"></Shape>
		<Div BKColor="user0" Height="24" Id="div_vbvg" Left="9" OnLoadCompleted="fn_OnLoadCompleted" OnTimer="WB0199010A_OnTimer" TabOrder="9" Text="Div0" Top="34" Url="COM::Coms013.xml" Width="959">
			<Contents></Contents>
		</Div>
		<Static Align="Right" Height="24" Id="st_frymd" Left="9" Style="sty_lb_search" TabOrder="4" Text="수주년월&#32;" Top="9" VAlign="Middle" Width="80"></Static>
		<Static Align="Right" Height="24" Id="st_spart" Left="385" Style="sty_lb_search" TabOrder="5" Text="제품군&#32;" Top="8" VAlign="Middle" Width="80"></Static>
		<Combo Border="Flat" CodeColumn="CODE" Column="YEARF" DataColumn="CODE_NAME" Height="20" Id="cb_fr_yearf" InnerDataset="ds_yearf_cd" Left="92" Style="sty_ipt_search" TabOrder="6" Top="10" Width="70"></Combo>
		<Combo Border="Flat" CodeColumn="CODE" Column="MONTHF" DataColumn="CODE_NAME" Height="20" Id="cb_fr_monthf" InnerDataset="ds_monthf_cd" Left="167" Style="sty_ipt_search" TabOrder="7" Top="10" Width="55"></Combo>
		<Static Align="Center" Border="None" Color="user7" Font="굴림,9" Height="20" Id="Static20" Left="222" TabOrder="12" Text="~" Top="10" VAlign="Middle" Width="18"></Static>
		<Combo Border="Flat" CodeColumn="CODE" Column="YEARF" DataColumn="CODE_NAME" Height="20" Id="cb_to_yearf" InnerDataset="ds_yearf_cd" Left="244" Style="sty_ipt_search" TabOrder="17" Top="10" Width="70"></Combo>
		<Combo Border="Flat" CodeColumn="CODE" Column="MONTHF" DataColumn="CODE_NAME" Height="20" Id="cb_to_monthf" InnerDataset="ds_monthf_cd" Left="317" Style="sty_ipt_search" TabOrder="18" Top="10" Width="55"></Combo>
		<Combo Border="Flat" CodeColumn="CODE" Column="CODE_NAME" DataColumn="CODE_NAME" Height="20" Id="cb_spart" InnerDataset="ds_spart_cd" Left="468" Style="sty_ipt_form" TabOrder="8" Top="10" Width="100"></Combo>
		<Checkbox BindDataset="ds_cond" BKColor="user0" Column="ZMPFLG" FalseValue="&#32;" Height="20" Id="chk_zmpflg" Left="668" TabOrder="16" Top="10" TrueValue="X" Width="20"></Checkbox>
		<Static Align="Right" Height="24" Id="Static1" Left="585" Style="sty_lb_search" TabOrder="15" Text="이동계획&#32;" Top="8" VAlign="Middle" Width="80"></Static>
		<Static Align="Right" Height="24" Id="Static0" Left="705" Style="sty_lb_search" TabOrder="14" Text="수주결과&#32;" Top="8" VAlign="Middle" Width="80"></Static>
		<Combo Border="Flat" CodeColumn="CODE" Column="CODE_NAME" DataColumn="CODE_NAME" Height="20" Id="cb_sorlt" InnerDataset="ds_sorlt" Left="788" Style="sty_ipt_form" TabOrder="13" Top="10" Width="100"></Combo>
	</Form>
	<Script><![CDATA[/*
 ******************************************************************************************
 * 기      능   : 
 * 작  성  자   : 
 * 작성  일자   : 
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
#include "LIB::commons.js";	// 공통 스크립트
#include "LIB::nsfRequest.js";	// 공통 스크립트 
#include "LIB::common_hdel.js";	// 공통 스크립트  /* GNY 추가 */
//=========================================================================================
// [ PART 1 ]
// Form에서 사용될 전역변수를 선언
// FORM에서 사용되는 전역변수는 대문자로 작성하며, F_XXX 의 형태를 갖도록 한다. 
//=========================================================================================
var F_MERGE = false;
var F_COLNUM_TOT1 = 1;  // 매출청구수금 그리드 합계 
var F_COLNUM_YEAYM = 2;  // 매출청구수금 그리드 기준년월
var F_CLOSE_YN = "";
var F_PSPID = "";
var F_ROW_PSPIDSV = 0;
var F_SOFOCA = 0;
var F_ROW = 0;
var F_COLUMN = 0;

//=========================================================================================
// [ PART 2 ]
// Form Loading / Unloading 시 작업 정의
//=========================================================================================
function fn_OnLoadCompleted(obj) {
	// Form 로드 이벤트 맨 첫줄에 기술 
	gfn_initForm(true);

	gfn_translation(obj, G_LANG);

	fn_init_form(); 	// 폼 초기화
}

/********************************************************************************
* 기      능   : 지급예정년 계산(현재년도,당해년도에서 뺄 년수, 당해년도에서 더할 년수
********************************************************************************/
function fn_makeYear(curYear,sNum,eNum) {
	var rowCnt = eNum-sNum;
	var row = 0;

	for(var i=rowCnt; i>-1; i--) {
		ds_yearf_cd.AddRow();
		ds_yearf_cd.SetColumn(row,"CODE",parseInt(curYear)+i+parseInt(sNum));
		ds_yearf_cd.SetColumn(row,"CODE_NAME",(parseInt(curYear)+i+parseInt(sNum))+"년");
		row++;
	}

	cb_fr_yearf.index = eNum;
	cb_to_yearf.index = eNum;
}

/********************************************************************************
* 기      능   : form UnloadCompleted 
********************************************************************************/
function fn_OnUnloadCompleted(obj) {
	return gfn_isFormUnload(obj);
}

//=========================================================================================
// [ PART 3 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,form닫기)
//=========================================================================================
/********************************************************************************
* 기      능   : 조회
********************************************************************************/
function fn_query() {
	F_MERGE = false;
	fn_param_query();
	
	// 서비스 호출
	nsfRequest("query"									// srvId
				, "sbp0190/find"						// url
				, "ds_cond=ds_cond ds_list=ds_list"		// inDsList
				, "ds_list=ds_list ds_error=ds_error"	// outDsList
				, ""									// strParam
				, "fn_afterQuery"						// CallBackFunc
				);

    fn_createWait("",this);     // 처리중입니다. 메시지 처리
}

/********************************************************************************
* 기      능   : 매출/청구/수금 조회  
********************************************************************************/
function fn_query_detail(nRow) {
	fn_param_detail();

	// 그리드헤더 년월 (18개월)Set
	fn_grid_header_set(nRow);

	// 서비스 호출
	fn_createWait("",this);     // 처리중입니다. 메시지 처리
	//ds_detail.DeleteAll();
	ds_list_detail.DeleteAll();
	ds_error.DeleteAll();
	
	nsfRequest("query"													// srvId
				, "sbp0191/find_detail"									// url
				, "ds_cond_detail=ds_cond_detail ds_list_detail=ds_list_detail ds_yearm=ds_yearm"	// inDsList
				, "ds_detail=ds_detail ds_list_detail=ds_list_detail ds_error=ds_error"				// outDsList
				, ""													// strParam
				, "fn_afterQuery_detail"								// CallBackFunc
				);
}

/********************************************************************************
* 기      능   : 저장 : 사업계획 등록, 수정, 삭제
********************************************************************************/
function fn_save() {
	gfn_clearMsgBar();
	
	fn_param_detail();
	
	// 서비스 호출 후 사업계획번호 GET
	ds_result.DeleteAll(); 
	ds_error.DeleteAll(); 
	fn_createWait("",this);     // 처리중입니다. 메시지 처리
	nsfRequest("query"																	// srvId
				, "sbp0191/save"													// url
				, "ds_cond_detail=ds_cond_detail ds_list_detail=ds_list_detail ds_yearm=ds_yearm ds_result=ds_result"	// inDsList
				, "ds_result=ds_result ds_error=ds_error"								// outDsList
				, ""																	// strParam
				, "fn_afterQuery_save"														// CallBackFunc
				);

}

/********************************************************************************
* 기      능   : 닫기  
********************************************************************************/
function fn_close() {
	close();
}

//=========================================================================================
// [ PART 4]
// Callback 함수 정의 : callback 함수명은 메인 함수의 fn_xxxx() 에서 xxxx 부분은 fn_afterXXXX()
// 형태가 되도록 작성 
//=========================================================================================
/********************************************************************************
* 기      능   : 조회 Callback  
********************************************************************************/
function fn_afterQuery(svcId, errCode, errMsg) {

	fn_destroyWait();
	
	if(ds_error.rowcount() > 0) {   
	
		gfn_showMsgBar(ds_error.GetColumn(0,"ERRMSG"));   
		
	} else {
	 
		// 조회된 자료가 있을 경우 
		if (ds_list.RowCount() > 0) 
		{ 
			gfn_showMsg("CI00002", ds_list.RowCount()+"");  // CI00002 : "조회를 완료했습니다.조회건수 [${}건]"
			
			grd_list.SetFocus();
			
			// 상세조회 실행  (강제로 매출/청구/수금 이벤트 발생시킴)
			var nRow = ds_delete.GetColumn(0,'ROW');
			ds_list_OnRowPosChanged(ds_list, -1, iif(nRow<0, 0, nRow)); 
		} 
		else 
		{	 
			gfn_showMsg("CW00010"); 					// CW00010 : "데이터가 없습니다."
		}
		 
	}
}

function fn_afterQuery_detail(svcId, errCode, errMsg) {

	fn_destroyWait();
	
	if (ds_list.GetColumn(F_ROW_PSPIDSV,'PSPIDSV') == null or ds_list.GetColumn(F_ROW_PSPIDSV,'PSPIDSV') == '' or ds_list.GetColumn(F_ROW_PSPIDSV,'PSPIDSV') == ' ') {
		gfn_showMsgBar('보수프로젝트 번호가 없습니다.','');
		return;
	}
	
	// 데이타셋 이벤트 활성화
	ds_list_detail.Fireevent = true;
	
	if(ds_error.rowcount() > 0) {   
	
		gfn_showMsgBar(ds_error.GetColumn(0,"ERRMSG"));   
		
	} else {  
		
		// 조회된 자료가 있을 경우 
		if (ds_list_detail.RowCount() > 0) 
		{ 
			gfn_showMsg("CI00003");  // CI00002 : "조회를 완료했습니다.
		} 
		else 
		{	 
			gfn_showMsg("CW00010"); 		// CW00010 : "데이터가 없습니다."
		} 
		
		// 상세정보 SET
		fn_setDetailInfo(); 
	}
}

function fn_afterQuery_save(svcId, errCode, errMsg) {

	fn_destroyWait();
	
	
	// 데이타셋 이벤트 활성화
	ds_list_detail.Fireevent = true;
	
	if(ds_error.rowcount() > 0) {   
	
		gfn_showMsgBar(ds_error.GetColumn(0,"ERRMSG"));   
		
	} else {  
		
		F_PSPID = ds_result.GetColumn(ds_result.row, "PSPID"); 
		
		fn_query();
	}
}

function fn_afterAuart(svcId, errCode, errMsg) {
	gfn_insertEmptyRow(ds_auart_cd, G_CODE_ALL);
	cb_auart.index = 0;
}

function fn_afterQuery_sorlt(svcId, errCode, errMsg) {
	gfn_insertEmptyRow(ds_sorlt, G_CODE_ALL);
	cb_sorlt.index = 0;
}

//=========================================================================================
// [ PART 5 ]
// 사용자정의 함수
//=========================================================================================
/********************************************************************************
* 기      능   : 폼 초기화
********************************************************************************/
function fn_init_form() {
	ds_save.DeleteAll();
	ds_cond.DeleteAll();
	ds_cond.AddRow();

	var curYear = substr(gfn_getCurrDate(),0,4);
//	fn_makeYear(curYear,-1,10);
	fn_makeYear(curYear,-4,1);
	cb_fr_monthf.index = parseInt(substr(gfn_getCurrDate(),4,2))-1;
	cb_to_monthf.index = parseInt(substr(gfn_getCurrDate(),4,2))-1;

	cal_stada.Text = gfn_getCurrDate();

	fn_grid_header_set(-1);

	// 오더유형 콤보목록 조회
	nsfRequest("query", "combo/comboAuart", "ds_auart_cd=ds_auart_cd"
										  , "ds_auart_cd=ds_auart_cd ds_error=ds_error"
										  , ""
										  , "fn_afterAuart");

	// 수주결과 콤보목록 조회
	ds_sorlt.DeleteAll();
	ds_sorlt.AddRow();
	ds_sorlt.SetColumn(0,"CODE","SD111");
	ds_sorlt.SetColumn(0,"CODE_NAME","SD111");
	// 서비스 호출
	nsfRequest("query"					// srvId
				, "combo/comboXml"		// url
				, "ds_sorlt=ds_sorlt"	// inDsList
				, "ds_sorlt=ds_sorlt"	// outDsList
				, ""					// strParam
				, "fn_afterQuery_sorlt"	// CallBackFunc
				);

	div_vbvg.Static1.left = 376;
	div_vbvg.cb_frvg.left = 459;
	div_vbvg.Static2.left = 696;
	div_vbvg.ed_sman_cd.left = 777;
	div_vbvg.btn_popSman.left = 894;
	
	gfn_insertEmptyRow(ds_spart_cd, G_CODE_ALL);
	cb_spart.index  = 0;

	cb_fr_yearf.SetFocus();
} 

/********************************************************************************
* 기      능   : 조회 변수 설정
********************************************************************************/
function fn_param_query() {
	var frzpym = SubStr(cb_fr_yearf.Text,0,cb_fr_yearf.Text.Length(cb_fr_yearf.Text)-1) + Lpad(SubStr(cb_fr_monthf.Text,0,cb_fr_monthf.Text.Length(cb_fr_monthf.Text)-1),"0",2);
	var tozpym = SubStr(cb_to_yearf.Text,0,cb_to_yearf.Text.Length(cb_to_yearf.Text)-1) + Lpad(SubStr(cb_to_monthf.Text,0,cb_to_monthf.Text.Length(cb_to_monthf.Text)-1),"0",2);
	var spart = ds_spart_cd.GetColumn(cb_spart.Index, "CODE");
	var zmpflg = chk_zmpflg.Value;

	ds_cond.DeleteAll();
	ds_cond.AddRow();

	ds_cond.SetColumn(0, "FR_ZPYM", frzpym);
	ds_cond.SetColumn(0, "TO_ZPYM", tozpym);
	ds_cond.SetColumn(0, "ZPYM", substr(gfn_getCurrDate(),0,6));
	ds_cond.SetColumn(0, "SPART", spart);
	ds_cond.SetColumn(0, "ZKUNNR" , div_vbvg.ed_sman_cd.Text);
	ds_cond.SetColumn(0, "VKBUR", div_vbvg.cb_frvb.Value);
	ds_cond.SetColumn(0, "VKGRP", div_vbvg.cb_frvg.Value);
	ds_cond.SetColumn(0, "ZMPFLG", zmpflg);
	ds_cond.SetColumn(0, "SORLT", cb_sorlt.Value);
}

/********************************************************************************
* 기      능   : 조회 변수 설정
********************************************************************************/
function fn_param_detail() {
	ds_cond_detail.DeleteAll();
	ds_cond_detail.AddRow();  
	
	// 수주계획번호
	ds_cond_detail.SetColumn(0, "PSPID", ds_list.GetColumn(ds_list.row, "PSPIDSV"));
	ds_cond_detail.SetColumn(0, "ZMPFLG", ds_list.GetColumn(ds_list.row, "ZMPFLG"));
	ds_cond_detail.SetColumn(0, "WAERK", ds_list.GetColumn(ds_list.row, "WAERK"));
}

/********************************************************************************
* 기      능   : 상세정보 조회 후처리 로직
********************************************************************************/
function fn_setDetailInfo()
{
	// 수주계획번호
	F_PSPID = ds_list.GetColumn(ds_list.row, "PSPIDSV");	 
	 
	// 매출, 청구, 수금 행 미존재시 강제로 1행씩 추가한다.
	var nSaRow = ds_list_detail.FindRow("GBN","1");	// 매출 행 존재여부
	var nRqRow = ds_list_detail.FindRow("GBN","2");	// 청구 행 존재여부
	var nYsRow = ds_list_detail.FindRow("GBN","3");	// 수금 행 존재여부 
	
	ds_list_detail.Fireevent = false;
	if (nSaRow < 0) 
	{
		ds_list_detail.InsertRow(0); 
		ds_list_detail.SetColumn(ds_list_detail.row, "GBN"		, "1");
		ds_list_detail.SetColumn(ds_list_detail.row, "GBN_NM"	, "매출");
	}
	if (nRqRow < 0) 
	{
		ds_list_detail.InsertRow(1); 
		ds_list_detail.SetColumn(ds_list_detail.row, "GBN"		, "2");
		ds_list_detail.SetColumn(ds_list_detail.row, "GBN_NM"	, "청구");
	}
	if (nYsRow < 0) 
	{
		ds_list_detail.InsertRow(2); 
		ds_list_detail.SetColumn(ds_list_detail.row, "GBN"		, "3");
		ds_list_detail.SetColumn(ds_list_detail.row, "GBN_NM"	, "수금");
	}
	
	// 매출의 01월에 포커싱
	ds_list_detail.row = 0; 
	grd_list_detail.SetCellPos(2);  
	
	ds_list_detail.Fireevent = true;
}

/********************************************************************************
* 기      능   : 기준년월에 따른 그리드 헤더(계획년월) 재설정
********************************************************************************/
function fn_grid_header_set(nRow) {
	var bef_month = 0;
	if (nRow == -1) {
		bef_month = substr(gfn_getCurrDate(),0,6) + '01';
	} else {
		bef_month = ds_list.GetColumn(nRow,'ZPYM') + '01';
	}
	var aft_month = "";    
	
	ds_yearm.DeleteAll();
	
	// 편성년도의 01월부터 18개월 생성
	for (var i=0; i<19; i++)
	{
		
		// 한달 씩 더한다.
		aft_month = AddMonth(bef_month,i);
		
		//F_COLNUM_YEAYM 컬럼에 기준년월계획이 위치함
		grd_list_detail.SetCellProp("Head"
									, parseInt(F_COLNUM_YEAYM) + i	
									, "Text"
									, substr(aft_month,0,4)+"."+substr(aft_month,4,2)+""  // YYYY.MM
									);

		// 예상년월 Dataset에 Add
		ds_yearm.AddRow();
		ds_yearm.SetColumn(i, "YEARM", substr(aft_month,0,6));
	}
}

//=========================================================================================
// [ PART 6 ]
// component Event 정의 : 각 Component 별 이벤트 
//=========================================================================================
/********************************************************************************
* 기      능   : 조회
********************************************************************************/
function fn_OnClick_btn(obj) {
	var fncName = "fn_" + substr(obj.id, 4); 
	eval( fncName + "()");
}

/********************************************************************************
* 기      능   : 그리드 헤드 정렬 처리 
********************************************************************************/
function grd_list_OnHeadClick(obj,nCell,nX,nY,nPivotIndex) {
	if( nCell == 0 ) {
		gfn_selectAllGrid(obj,nCell,nCell,true);
	} else {
		gfn_sortGrid(obj, nCell);
	}	
}

/********************************************************************************
* 기      능   : 그리드 셀클릭
********************************************************************************/
function grd_list_OnCellClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
	ds_delete.SetColumn(0,'ROW',nRow);
}

function ds_list_OnRowPosChanged(obj,nOldRow,nRow)
{
	if (ds_list.RowCount()==0) return;
	if (ds_list.row<0) return;
	
	F_ROW_PSPIDSV = nRow;
	F_SOFOCA = ds_list.GetColumn(nRow,'SOFOCA');
	
	// 매출/청구/수금 상세조회 
	fn_query_detail(nRow);
}

function grd_list_detail_OnChar(obj,strPreText,nChar,strPostText,nLLParam,nHLParam,nRow,nCell,nPivotIndex)
{
	if (substr(grd_list_detail.GetCellProp("body",nCell,"ColId"),0,3) == 'AMT') {
		F_Row = nRow;
		F_COLUMN = nCell;
	}
}

function grd_list_detail_OnCellPosChanged(obj,nRow,nCell,nOldRow,nOldCell,nPivotIndex,nOldPivotIndex)
{
	if (F_Row == nRow && F_COLUMN == nCell) return;

	if (F_Row != nRow && F_COLUMN == nCell) return;

	fn_sumchk();
}

function grd_list_detail_OnKeyDown(obj,nChar,bShift,bCtrl,bAlt,nLLParam,nHLParam)
{
	if (nChar == 38) fn_sumchk(F_Row + 1);
	if (nChar == 40) fn_sumchk(F_Row - 1);
}

function fn_sumchk() {
	var sum = 0;
	var colid = '';
	var str = '';

	for (var i = 0; i < 19; i++) {
		colid = 'AMT'+LPad(i,'0',2);
		sum += parseInt(ds_list_detail.GetColumn(F_Row,colid));
	}

	if (sum > F_SOFOCA) {
		switch (nRow) {
			case 0 :
				str = '매출';
				break;
			case 1 :
				str = '청구';
				break;
			case 2 :
				str = '수금';
				break;
		}
		// CW10031=${}금액 합계가 수주예상금액보다 큽니다.
		gfn_showAlert('CW10031',str);
		gfn_SetFocusGrid(grd_list_detail,F_Row,F_COLUMN);
	}
}
]]></Script>
</Window>