<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="562" Id="Sbp0010" Left="8" OnLoadCompleted="fn_OnLoadCompleted" OnUnloadCompleted="fn_OnUnloadCompleted" PidAttrib="7" Title="사업계획관리" Top="8" Ver="1.0" Width="978" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_cond">
				<Contents>
					<colinfo id="ZPYEAR" size="4" type="STRING"/>
					<colinfo id="ZPYM" size="6" type="STRING"/>
					<colinfo id="SPART" size="2" type="STRING"/>
					<colinfo id="VKBUR_FR" size="4" type="STRING"/>
					<colinfo id="VKBUR_TO" size="4" type="STRING"/>
					<colinfo id="VKGRP_FR" size="3" type="STRING"/>
					<colinfo id="VKGRP_TO" size="3" type="STRING"/>
					<colinfo id="ZKUNNR" size="10" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset CanRowPosChange="ds_list_CanRowPosChange" DataSetType="Dataset" Id="ds_list" OnColumnChanged="ds_list_OnColumnChanged" OnRowPosChanged="ds_list_OnRowPosChanged">
				<Contents>
					<colinfo id="SAVE_YN" size="1" type="STRING"/>
					<colinfo id="CHK" size="1" type="STRING"/>
					<colinfo id="FLAG" size="1" type="STRING"/>
					<colinfo id="NEW_YN" size="1" type="STRING"/>
					<colinfo id="MANDT" size="1" type="STRING"/>
					<colinfo id="ZBPNNR" size="10" type="STRING"/>
					<colinfo id="ZPYEAR" size="4" type="STRING"/>
					<colinfo id="ZPYM" size="6" type="STRING"/>
					<colinfo id="SPART" size="2" type="STRING"/>
					<colinfo id="AUART" size="4" type="STRING"/>
					<colinfo id="MATNR" size="18" type="STRING"/>
					<colinfo id="VKBUR" size="4" type="STRING"/>
					<colinfo id="VKGRP" size="3" type="STRING"/>
					<colinfo id="ZKUNNR" size="10" type="STRING"/>
					<colinfo id="ZKUNNR_NM" size="30" type="STRING"/>
					<colinfo id="GTYPE" size="20" type="STRING"/>
					<colinfo id="TYPE1" size="5" type="STRING"/>
					<colinfo id="TYPE2" size="5" type="STRING"/>
					<colinfo id="TYPE3" size="5" type="STRING"/>
					<colinfo id="ZNUMBER" size="5" type="INT"/>
					<colinfo id="KUNNR" size="10" type="STRING"/>
					<colinfo id="KUNNR_NM" size="30" type="STRING"/>
					<colinfo id="GSNAM" size="50" type="STRING"/>
					<colinfo id="REGION" size="2" type="STRING"/>
					<colinfo id="ZDELI" size="1" type="STRING"/>
					<colinfo id="SHANGH" size="4" type="STRING"/>
					<colinfo id="ZINTER" size="1" type="STRING"/>
					<colinfo id="SOFOCA" size="15" type="DECIMAL"/>
					<colinfo id="ZFORE" size="4" type="DECIMAL"/>
					<colinfo id="WAERK" size="5" type="STRING"/>
					<colinfo id="DELDAT" size="8" type="STRING"/>
					<colinfo id="ZRMK" size="100" type="STRING"/>
					<colinfo id="ZRMK1" size="100" type="STRING"/>
					<colinfo id="ZAGNT" size="10" type="STRING"/>
					<colinfo id="ZAGNT_NM" size="50" type="STRING"/>
					<colinfo id="LAND1" size="3" type="STRING"/>
					<colinfo id="LAND1_NM" size="50" type="STRING"/>
					<colinfo id="ZAREA" size="3" type="STRING"/>
					<colinfo id="ZAREA_NM" size="50" type="STRING"/>
					<colinfo id="ZCOST" size="15" type="DECIMAL"/>
					<colinfo id="ZPCOST" size="15" type="DECIMAL"/>
					<colinfo id="CDATE" size="8" type="STRING"/>
					<colinfo id="CTIME" size="6" type="STRING"/>
					<colinfo id="CUSER" size="10" type="STRING"/>
					<colinfo id="UDATE" size="8" type="STRING"/>
					<colinfo id="UTIME" size="6" type="STRING"/>
					<colinfo id="UUSER" size="10" type="STRING"/>
					<colinfo id="DDATE" size="8" type="STRING"/>
					<colinfo id="DTIME" size="6" type="STRING"/>
					<colinfo id="DUSER" size="10" type="STRING"/>
					<colinfo id="RTYPE" size="256" type="STRING"/>
					<colinfo id="UFLAG" size="1" type="STRING"/>
					<colinfo id="ZBDTYP" size="256" type="STRING"/>
					<colinfo id="ZBDTYP_LNM" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_error">
				<Contents>
					<colinfo id="ERRCODE" size="10" type="STRING"/>
					<colinfo id="ERRMSG" size="200" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list_spart">
				<Contents>
					<colinfo id="CODE" size="2" type="STRING"/>
					<colinfo id="CODE_NAME" size="50" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list_vb" OnRowPosChanged="ds_list_vb_OnRowPosChanged">
				<Contents>
					<colinfo id="CODE" size="12" type="STRING"/>
					<colinfo id="CODE_NAME" size="60" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list_vg">
				<Contents>
					<colinfo id="CODE" size="12" type="STRING"/>
					<colinfo id="CODE_NAME" size="60" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list_spart_grid">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_obj_list">
				<Contents>
					<colinfo id="DS_VB" size="20" type="STRING"/>
					<colinfo id="DS_VG" size="20" type="STRING"/>
					<colinfo id="DS_COND_VG" size="20" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list_sman">
				<Contents>
					<colinfo id="SMAN_CD" size="256" type="STRING"/>
					<colinfo id="SMAN_NM" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond_sman">
				<Contents>
					<colinfo id="SMAN_CD" size="10" type="STRING"/>
					<colinfo id="SMAN_NM" size="105" type="STRING"/>
					<record>
						<SMAN_CD></SMAN_CD>
						<SMAN_NM></SMAN_NM>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond_opendtm">
				<Contents>
					<colinfo id="ZPYEAR" size="4" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list_opendtm">
				<Contents>
					<colinfo id="OPENDTM" size="14" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond_vg">
				<Contents>
					<colinfo id="VB" size="4" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list_detail" OnColumnChanged="ds_list_detail_OnColumnChanged">
				<Contents>
					<colinfo id="MANDT" size="3" type="STRING"/>
					<colinfo id="GBN" size="1" type="STRING"/>
					<colinfo id="GBN_NM" size="10" type="STRING"/>
					<colinfo id="AMT00" size="15" type="DECIMAL"/>
					<colinfo id="AMT01" size="15" type="DECIMAL"/>
					<colinfo id="AMT02" size="15" type="DECIMAL"/>
					<colinfo id="AMT03" size="15" type="DECIMAL"/>
					<colinfo id="AMT04" size="15" type="DECIMAL"/>
					<colinfo id="AMT05" size="15" type="DECIMAL"/>
					<colinfo id="AMT06" size="15" type="DECIMAL"/>
					<colinfo id="AMT07" size="15" type="DECIMAL"/>
					<colinfo id="AMT08" size="15" type="DECIMAL"/>
					<colinfo id="AMT09" size="15" type="DECIMAL"/>
					<colinfo id="AMT10" size="15" type="DECIMAL"/>
					<colinfo id="AMT11" size="15" type="DECIMAL"/>
					<colinfo id="AMT12" size="15" type="DECIMAL"/>
					<colinfo id="AMT13" size="15" type="DECIMAL"/>
					<colinfo id="AMT14" size="15" type="DECIMAL"/>
					<colinfo id="AMT15" size="15" type="DECIMAL"/>
					<colinfo id="AMT16" size="15" type="DECIMAL"/>
					<colinfo id="AMT17" size="15" type="DECIMAL"/>
					<colinfo id="AMT18" size="15" type="DECIMAL"/>
					<colinfo id="AMT19" size="15" type="DECIMAL"/>
					<colinfo id="AMT20" size="15" type="DECIMAL"/>
					<colinfo id="AMT21" size="15" type="DECIMAL"/>
					<colinfo id="AMT22" size="15" type="DECIMAL"/>
					<colinfo id="AMT23" size="15" type="DECIMAL"/>
					<colinfo id="AMT24" size="15" type="DECIMAL"/>
					<colinfo id="AMT25" size="15" type="DECIMAL"/>
					<colinfo id="AMT26" size="15" type="DECIMAL"/>
					<colinfo id="AMT27" size="15" type="DECIMAL"/>
					<colinfo id="AMT28" size="15" type="DECIMAL"/>
					<colinfo id="AMT29" size="15" type="DECIMAL"/>
					<colinfo id="USER_ID" size="10" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_detail">
				<Contents>
					<colinfo id="FLAG" size="1" summ="default" type="STRING"/>
					<colinfo id="MANDT" size="3" summ="default" type="STRING"/>
					<colinfo id="ZBPNNR" size="1" summ="default" type="STRING"/>
					<colinfo id="ZPYEAR" size="4" summ="default" type="STRING"/>
					<colinfo id="ZPYM" size="6" summ="default" type="STRING"/>
					<colinfo id="SPART" size="2" summ="default" type="STRING"/>
					<colinfo id="AUART" size="4" summ="default" type="STRING"/>
					<colinfo id="MATNR" size="18" summ="default" type="STRING"/>
					<colinfo id="VKBUR" size="4" summ="default" type="STRING"/>
					<colinfo id="VKGRP" size="3" summ="default" type="STRING"/>
					<colinfo id="ZKUNNR" size="10" summ="default" type="STRING"/>
					<colinfo id="GTYPE" size="20" summ="default" type="STRING"/>
					<colinfo id="ZBDTYP" size="2" summ="default" type="STRING"/>
					<colinfo id="TYPE1" size="5" summ="default" type="STRING"/>
					<colinfo id="TYPE2" size="5" summ="default" type="STRING"/>
					<colinfo id="TYPE3" size="5" summ="default" type="STRING"/>
					<colinfo id="ZNUMBER" size="5" summ="default" type="INT"/>
					<colinfo id="KUNNR" size="10" summ="default" type="STRING"/>
					<colinfo id="GSNAM" size="50" summ="default" type="STRING"/>
					<colinfo id="REGION" size="2" summ="default" type="STRING"/>
					<colinfo id="ZDELI" size="1" summ="default" type="STRING"/>
					<colinfo id="SHANGH" size="4" summ="default" type="STRING"/>
					<colinfo id="ZINTER" size="1" summ="default" type="STRING"/>
					<colinfo id="SOFOCA" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="ZFORE" size="4" summ="default" type="DECIMAL"/>
					<colinfo id="WAERK" size="5" summ="default" type="STRING"/>
					<colinfo id="DELDAT" size="8" summ="default" type="STRING"/>
					<colinfo id="ZRMK" size="100" summ="default" type="STRING"/>
					<colinfo id="ZAGNT" size="10" summ="default" type="STRING"/>
					<colinfo id="CDATE" size="8" summ="default" type="STRING"/>
					<colinfo id="CTIME" size="6" summ="default" type="STRING"/>
					<colinfo id="CUSER" size="10" summ="default" type="STRING"/>
					<colinfo id="UDATE" size="8" summ="default" type="STRING"/>
					<colinfo id="UTIME" size="6" summ="default" type="STRING"/>
					<colinfo id="UUSER" size="10" summ="default" type="STRING"/>
					<colinfo id="DDATE" size="8" summ="default" type="STRING"/>
					<colinfo id="DTIME" size="6" summ="default" type="STRING"/>
					<colinfo id="DUSER" size="10" summ="default" type="STRING"/>
					<colinfo id="USER_ID" size="10" summ="default" type="STRING"/>
					<colinfo id="RTYPE" size="256" summ="default" type="STRING"/>
					<colinfo id="UFLAG" size="1" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond_detail">
				<Contents>
					<colinfo id="ZBPNNR" size="10" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_yearm">
				<Contents>
					<colinfo id="YEARM" size="6" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_result">
				<Contents>
					<colinfo id="ZBPNNR" size="10" type="STRING"/>
					<colinfo id="SAVE_STAT" size="1" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list_gtype">
				<Contents>
					<colinfo id="gtype" size="20" type="STRING"/>
					<colinfo id="auart" size="4" type="STRING"/>
					<colinfo id="matnr" size="18" type="STRING"/>
					<colinfo id="spart" size="2" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_region_cd">
				<Contents>
					<colinfo id="CODE" size="2" type="STRING"/>
					<colinfo id="CODE_NAME" size="20" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_zdeli_cd">
				<Contents>
					<colinfo id="CODE" size="2" type="STRING"/>
					<colinfo id="CODE_NAME" size="50" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond_dd07t">
				<Contents>
					<colinfo id="DOMNAME" size="50" type="STRING"/>
					<colinfo id="DOMVALUE_L" size="50" type="STRING"/>
					<colinfo id="CONCAT_YN" size="1" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_error_dd07t">
				<Contents>
					<colinfo id="IDX" size="256" type="STRING"/>
					<colinfo id="ERRMSG" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_shangh_cd">
				<Contents>
					<colinfo id="CODE" size="2" type="STRING"/>
					<colinfo id="CODE_NAME" size="50" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_zinter_cd">
				<Contents>
					<colinfo id="CODE" size="2" type="STRING"/>
					<colinfo id="CODE_NAME" size="50" type="STRING"/>
					<record>
						<CODE>Y</CODE>
						<CODE_NAME>중계무역</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_gtype_cd">
				<Contents>
					<colinfo id="CODE" size="2" type="STRING"/>
					<colinfo id="CODE_NAME" size="50" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_waerk_cd">
				<Contents>
					<colinfo id="CODE" size="2" type="STRING"/>
					<colinfo id="CODE_NAME" size="50" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset CanRowPosChange="ds_list_CanRowPosChange" DataSetType="Dataset" Id="ds_list_sum" OnColumnChanged="ds_list_OnColumnChanged" OnRowPosChanged="ds_list_OnRowPosChanged">
				<Contents></Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_region_cd_grid">
				<Contents>
					<colinfo id="CODE" size="2" type="STRING"/>
					<colinfo id="CODE_NAME" size="20" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_shangh_cd_grid">
				<Contents>
					<colinfo id="CODE" size="2" type="STRING"/>
					<colinfo id="CODE_NAME" size="50" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_compute_cond">
				<Contents>
					<colinfo id="SONNR" size="10" type="STRING"/>
					<colinfo id="PLANYM" size="6" type="STRING"/>
					<colinfo id="POSID" size="24" type="STRING"/>
					<colinfo id="VKBUR" size="4" type="STRING"/>
					<colinfo id="VKGRP" size="3" type="STRING"/>
					<colinfo id="AUART" size="4" type="STRING"/>
					<colinfo id="SPART" size="2" type="STRING"/>
					<colinfo id="GTYPE" size="20" type="STRING"/>
					<colinfo id="MATNR" size="18" type="STRING"/>
					<colinfo id="ZINTER" size="1" type="STRING"/>
					<colinfo id="SHANGH" size="4" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_compute_out">
				<Contents>
					<colinfo id="SONNR" size="10" type="STRING"/>
					<colinfo id="PLANTP" size="2" type="STRING"/>
					<colinfo id="PLANYM" size="6" type="STRING"/>
					<colinfo id="PLANAMT" size="15" type="STRING"/>
					<colinfo id="WAERK" size="5" type="DECIMAL"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_zagnt">
				<Contents>
					<colinfo id="ZAGNT" size="10" type="STRING"/>
					<colinfo id="ZAGNT_NM" size="100" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_save_stat">
				<Contents>
					<colinfo id="save_stat" size="1" type="STRING"/>
					<colinfo id="save_stat_nm" size="50" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_deldat">
				<Contents>
					<colinfo id="C_WORKINGDAY" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond_deldat">
				<Contents>
					<colinfo id="I_DATE_FROM" size="256" type="STRING"/>
					<colinfo id="I_DAYS" size="256" type="STRING"/>
					<colinfo id="I_WERKS" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_combo">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_combo_gubun">
				<Contents>
					<colinfo id="GUBUN" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_gtypes">
				<Contents>
					<colinfo id="Zgtype" size="256" type="STRING"/>
					<colinfo id="Auart" size="256" type="STRING"/>
					<colinfo id="Matnr" size="256" type="STRING"/>
					<colinfo id="Spart" size="256" type="STRING"/>
					<colinfo id="Zprdgbn" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_gtype">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
					<colinfo id="AUART" size="256" type="STRING"/>
					<colinfo id="SPART" size="256" type="STRING"/>
					<colinfo id="MATNR" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond_gtype">
				<Contents>
					<colinfo id="VKBUR" size="256" type="STRING"/>
					<colinfo id="VKGRP" size="256" type="STRING"/>
					<colinfo id="ZKUNNR" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list_build">
				<Contents>
					<colinfo id="BUILDUSE" size="256" type="STRING"/>
					<colinfo id="STEXT" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond_build">
				<Contents>
					<colinfo id="BUILDUSE" size="6" type="STRING"/>
					<colinfo id="STEXT" size="120" type="STRING"/>
					<colinfo id="WHERE" size="256" type="STRING"/>
					<record>
						<BUILDUSE></BUILDUSE>
						<STEXT></STEXT>
						<WHERE></WHERE>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_error_build">
				<Contents>
					<colinfo id="IDX" size="256" type="STRING"/>
					<colinfo id="ERRMSG" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list_build_grid">
				<Contents>
					<colinfo id="BUILDUSE" size="256" type="STRING"/>
					<colinfo id="STEXT" size="256" type="STRING"/>
				</Contents>
			</Dataset>
		</Datasets>
		<Shape BKColor="user0" Bottom="51" Height="51" Id="Shape1" Left="0" LineColor="user1" Right="978" TabOrder="0" Top="0" Type="Rectangle" Width="978"></Shape>
		<Div Border="Flat" BorderColor="user13" Height="112" Id="div_detail" Left="8" TabOrder="7" Text="Div0" Top="344" Width="971">
			<Contents>
				<Static Align="Right" Height="20" Id="Static3" Left="302" Style="sty_lb_form_basic" TabOrder="1" Text="기종&#32;" VAlign="Middle" Width="86"></Static>
				<Combo BindDataset="ds_list" Border="Flat" CodeColumn="CODE" Column="RTYPE" DataColumn="CODE" Height="20" Id="cb_gtype" InnerDataset="ds_gtype" Left="388" OnChanged="div_detail_cb_gtype_OnChanged" Style="sty_ipt_form_ind" TabOrder="5" Width="175"></Combo>
				<Static Align="Right" Height="20" Id="Static4" Left="302" Style="sty_lb_form_basic" TabOrder="3" Text="인승&#32;" Top="44" VAlign="Middle" Width="86"></Static>
				<Edit Align="RIGHT" BindDataset="ds_list" Border="Flat" CheckLength="Byte" Column="TYPE3" Height="20" Id="ed_type3" ImeMode="none" Left="389" LeftMargin="4" MaxLength="5" RightMargin="4" Style="sty_ipt_form" TabOrder="7" Top="66" UpperOnly="TRUE" Width="42"></Edit>
				<Static Align="Right" Height="20" Id="Static5" Left="433" Style="sty_lb_form_basic" TabOrder="10" Text="속도&#32;" Top="44" VAlign="Middle" Width="86"></Static>
				<Edit Align="RIGHT" BindDataset="ds_list" Border="Flat" CheckLength="Byte" Column="TYPE2" Height="20" Id="ed_type2" ImeMode="none" Left="520" LeftMargin="4" MaxLength="5" RightMargin="4" Style="sty_ipt_form" TabOrder="9" Top="44" UpperOnly="TRUE" Width="42"></Edit>
				<Static Align="Right" Height="20" Id="Static6" Left="302" Style="sty_lb_form_basic" TabOrder="13" Text="층수&#32;" Top="66" VAlign="Middle" Width="86"></Static>
				<Edit Align="RIGHT" BindDataset="ds_list" Border="Flat" CheckLength="Byte" Column="TYPE1" Height="20" Id="ed_type1" ImeMode="none" Left="389" LeftMargin="4" MaxLength="5" RightMargin="4" Style="sty_ipt_form" TabOrder="6" Text="12345" Top="44" UpperOnly="TRUE" Width="42"></Edit>
				<Combo BindDataset="ds_list" Border="Flat" CodeColumn="CODE" Column="REGION" DataColumn="CODE_NAME" Height="20" Id="cb_region" ImeMode="none" InnerDataset="ds_region_cd" Left="87" Style="sty_ipt_form" TabOrder="3" Top="87" Width="80"></Combo>
				<Static Align="Right" Height="20" Id="Static1" Style="sty_lb_form_basic" TabOrder="13" Text="설치지역&#32;" Top="88" VAlign="Middle" Width="86"></Static>
				<Edit BindDataset="ds_list" Border="Flat" CheckLength="Byte" Column="GSNAM" Height="20" Id="ed_gsnam" ImeMode="none" Left="88" LeftMargin="4" MaxLength="50" RightMargin="4" Style="sty_ipt_form_ind" TabOrder="2" Top="66" UpperOnly="TRUE" Width="212"></Edit>
				<Static Align="Right" Height="20" Id="Static0" Style="sty_lb_form_basic" TabOrder="13" Text="공사명&#32;" Top="66" VAlign="Middle" Width="86"></Static>
				<Div BKColor="user0" Height="20" Id="div_buyr" Left="88" OnLoadCompleted="fn_OnLoadCompleted" TabOrder="1" Text="Div0" Top="1" Url="COM::Coms003.xml" Width="212">
					<Contents></Contents>
				</Div>
				<Static Align="Right" Height="20" Id="Static2" Style="sty_lb_form_basic" TabOrder="14" Text="거래선&#32;" VAlign="Middle" Width="86"></Static>
				<Static Align="Right" Height="20" Id="Static7" Left="433" Style="sty_lb_form_basic" TabOrder="14" Text="대수&#32;" Top="66" VAlign="Middle" Width="86"></Static>
				<Edit Align="RIGHT" BindDataset="ds_list" Border="Flat" CheckLength="Byte" Column="ZNUMBER" Height="20" Id="ed_znumber" ImeMode="none" Left="520" LeftMargin="4" MaxLength="5" RightMargin="4" Style="sty_ipt_form" TabOrder="10" Top="66" UpperOnly="TRUE" Width="42"></Edit>
				<Static Align="Right" Height="20" Id="Static8" Left="433" Style="sty_lb_form_basic" TabOrder="14" Text="단납구분&#32;" Top="88" VAlign="Middle" Width="86"></Static>
				<Combo BindDataset="ds_list" Border="Flat" CodeColumn="CODE" Column="SHANGH" DataColumn="CODE_NAME" Height="20" Id="cb_shangh" InnerDataset="ds_shangh_cd" Left="238" OnChanged="div_detail_cb_shangh_OnChanged" Style="sty_ipt_form" TabOrder="4" Top="87" Width="64"></Combo>
				<Static Align="Right" Height="20" Id="Static9" Left="167" Style="sty_lb_form_basic" TabOrder="19" Text="국내/상해&#32;" Top="88" VAlign="Middle" Width="70"></Static>
				<Static Align="Right" Height="20" Id="Static10" Left="302" Style="sty_lb_form_basic" TabOrder="20" Text="중계무역구분&#32;" Top="88" VAlign="Middle" Width="86"></Static>
				<Static Align="Right" Height="20" Id="Static11" Left="750" Style="sty_lb_form_basic" TabOrder="21" Text="수주예상액&#32;" VAlign="Middle" Width="102"></Static>
				<Static Align="Right" Height="20" Id="Static12" Left="564" Style="sty_lb_form_basic" TabOrder="22" Text="예상시행율&#32;" Top="22" VAlign="Middle" Width="86"></Static>
				<Combo BindDataset="ds_list" Border="Flat" CodeColumn="CODE" Column="WAERK" DataColumn="CODE_NAME" Height="20" Id="cb_waerk" InnerDataset="ds_waerk_cd" Left="651" Style="sty_ipt_form_ind" TabOrder="14" Top="43" Width="99"></Combo>
				<Static Align="Right" Height="20" Id="Static13" Left="564" Style="sty_lb_form_basic" TabOrder="24" Text="통화&#32;" Top="44" VAlign="Middle" Width="86"></Static>
				<Static Align="Right" Height="20" Id="Static14" Left="751" Style="sty_lb_form_basic" TabOrder="25" Text="납기예정일&#32;" Top="44" VAlign="Middle" Width="101"></Static>
				<Static Align="Right" Height="20" Id="Static16" Left="302" Style="sty_lb_form_basic" TabOrder="26" Text="기종정보&#32;" Top="22" VAlign="Middle" Width="86"></Static>
				<Calendar BindDataset="ds_list" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="DELDAT" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_deldat" Left="854" LeftMargin="4" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" OnChanged="div_detail_cal_deldat_OnChanged" RightMargin="4" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form_ind" SundayTextColor="user35" TabOrder="15" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="44" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="113"></Calendar>
				<Edit Border="Flat" Column="NAME1" Enable="FALSE" Height="20" Id="ed_gtype_info" Left="389" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="18" TabStop="FALSE" Top="22" Width="173"></Edit>
				<MaskEdit BindDataset="ds_list" Border="Flat" Column="SOFOCA" Cursor="IBEAM" DecimalLen="0" Height="20" Id="med_sofoca" Left="854" LeftMargin="4" MaxLength="13" RightMargin="4" Style="sty_ipt_form_ind" TabOrder="12" Top="1" Width="112"></MaskEdit>
				<Checkbox BindDataset="ds_list" Column="ZDELI" Height="20" Id="chk_zdeli" Left="521" LeftMargin="15" RightMargin="15" Style="sty_ipt_form_chk" TabOrder="11" Top="88" TrueValue="X" Value="FALSE" Width="41"></Checkbox>
				<Checkbox BindDataset="ds_list" Column="ZINTER" Enable="FALSE" Height="20" Id="chk_zinter" Left="389" LeftMargin="15" RightMargin="15" Style="sty_ipt_form_chk" TabOrder="8" Top="88" TrueValue="Y" Value="FALSE" Width="42"></Checkbox>
				<MaskEdit BindDataset="ds_list" Border="Flat" Column="ZFORE" Cursor="IBEAM" DecimalLen="1" Height="20" Id="med_zfore" Left="652" LeftMargin="4" Mask="###.#" MaxLength="4" RightMargin="4" Style="sty_ipt_form_ind" TabOrder="13" Top="22" Width="96"></MaskEdit>
				<Edit BindDataset="ds_list" Border="Flat" CheckLength="Byte" Column="ZRMK" Height="20" Id="ed_zrmk" ImeMode="none" Left="652" LeftMargin="4" MaxLength="100" RightMargin="4" Style="sty_ipt_form" TabOrder="17" Top="88" UpperOnly="TRUE" Width="314"></Edit>
				<Static Align="Right" Height="20" Id="Static17" Left="564" Style="sty_lb_form_basic" TabOrder="35" Text="대리점&#32;" Top="66" VAlign="Middle" Width="86"></Static>
				<Static Align="Right" Height="20" Id="Static15" Left="564" Style="sty_lb_form_basic" TabOrder="36" Text="비고&#32;" Top="88" VAlign="Middle" Width="86"></Static>
				<Static Align="Right" Height="20" Id="Static19" Style="sty_lb_form_basic" TabOrder="37" Text="국가&#32;" Top="22" VAlign="Middle" Width="86"></Static>
				<Edit BindDataset="ds_list" Border="Flat" CheckLength="Byte" Column="LAND1" Enable="FALSE" Height="20" Id="ed_land1" ImeMode="none" Left="88" LeftMargin="4" MaxLength="2" RightMargin="4" Style="sty_ipt_form" TabOrder="38" Text="1234567890" Top="22" UpperOnly="TRUE" Width="62"></Edit>
				<Edit BindDataset="ds_list" Border="Flat" CheckLength="Byte" Column="LAND1_NM" Enable="FALSE" Height="20" Id="ed_land1_nm" ImeMode="none" Left="151" LeftMargin="4" MaxLength="100" RightMargin="4" Style="sty_ipt_form" TabOrder="39" Top="22" UpperOnly="TRUE" Width="149"></Edit>
				<Static Align="Right" Height="20" Id="Static18" Style="sty_lb_form_basic" TabOrder="40" Text="권역&#32;" Top="44" VAlign="Middle" Width="86"></Static>
				<Edit BindDataset="ds_list" Border="Flat" CheckLength="Byte" Column="ZAREA" Enable="FALSE" Height="20" Id="ed_zarea" ImeMode="none" Left="88" LeftMargin="4" MaxLength="2" RightMargin="4" Style="sty_ipt_form" TabOrder="41" Text="1234567890" Top="44" UpperOnly="TRUE" Width="62"></Edit>
				<Edit BindDataset="ds_list" Border="Flat" CheckLength="Byte" Column="ZAREA_NM" Enable="FALSE" Height="20" Id="ed_zarea_nm" ImeMode="none" Left="151" LeftMargin="4" MaxLength="100" RightMargin="4" Style="sty_ipt_form" TabOrder="42" Top="44" UpperOnly="TRUE" Width="149"></Edit>
				<MaskEdit BindDataset="ds_list" Border="Flat" Column="ZCOST" Cursor="IBEAM" DecimalLen="0" Enable="FALSE" Height="20" Id="med_zcost" Left="854" LeftMargin="4" MaxLength="13" RightMargin="4" Style="sty_ipt_form" TabOrder="43" Top="22" Width="112"></MaskEdit>
				<Static Align="Right" Height="20" Id="Static20" Left="750" Style="sty_lb_form_basic" TabOrder="44" Text="시행예산산출금액" Top="22" VAlign="Middle" Width="102"></Static>
				<Div BKColor="user0" Height="20" Id="div_lifn" Left="652" OnLoadCompleted="fn_OnLoadCompleted" TabOrder="16" Text="협력업체&#32;" Top="66" Url="COM::Coms004.xml" Width="314">
					<Contents></Contents>
				</Div>
				<Static Align="Right" Height="20" Id="Static21" Left="564" Style="sty_lb_form_basic" TabOrder="45" Text="건물용도&#32;" VAlign="Middle" Width="86"></Static>
				<Combo BindDataset="ds_list" Border="Flat" CodeColumn="BUILDUSE" Column="ZBDTYP" DataColumn="STEXT" Height="20" Id="cb_bdtyp" InnerDataset="ds_list_build" Left="651" Style="sty_ipt_form_ind" TabOrder="46" Width="99"></Combo>
			</Contents>
		</Div>
		<Grid AutoEnter="TRUE" AutoFitEndLine="Hide" BindDataset="ds_list" BkColor2="default" BoldHead="true" Border="Flat" Bottom="339" ColSizing="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="275" Id="grd_list" InputPanel="FALSE" Left="8" LineColor="user20" LineType="ExHORZ" OnHeadClick="grd_list_OnHeadClick" OnKeyDown="grd_list_OnKeyDown" Right="971" RowHeight="20" Style="sty_grid" TabOrder="6" TabStop="true" Top="64" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="963">
			<contents>
				<format id="Default">
					<columns>
						<col width="55"/>
						<col width="0"/>
						<col width="33"/>
						<col width="77"/>
						<col width="55"/>
						<col width="55"/>
						<col width="52"/>
						<col width="87"/>
						<col width="99"/>
						<col width="65"/>
						<col width="73"/>
						<col width="48"/>
						<col width="124"/>
						<col width="87"/>
						<col width="87"/>
						<col width="105"/>
						<col width="69"/>
						<col width="87"/>
						<col width="74"/>
						<col width="94"/>
						<col width="45"/>
						<col width="45"/>
						<col width="45"/>
						<col width="45"/>
						<col width="53"/>
						<col width="58"/>
						<col width="78"/>
						<col width="41"/>
						<col width="108"/>
						<col width="63"/>
						<col width="106"/>
						<col width="69"/>
						<col width="73"/>
						<col width="125"/>
						<col width="257"/>
					</columns>
					<head>
						<cell align="center" bkimageid="icon_grid_sel" col="0" color="user21" display="text" font="굴림,9"/>
						<cell align="center" bkimageid="icon_grid_sel" col="1" color="user21" display="text" font="굴림,9"/>
						<cell align="center" col="2" color="user21" display="text" font="굴림,9" text="변경"/>
						<cell align="center" col="3" color="user21" display="text" font="굴림,9" text="사업계획번호"/>
						<cell align="center" col="4" color="user21" display="text" font="굴림,9" text="편성년도"/>
						<cell align="center" col="5" color="user21" display="text" font="굴림,9" text="계획년월"/>
						<cell align="center" col="6" color="user21" display="text" font="굴림,9" text="제품군"/>
						<cell align="center" col="7" color="user21" display="text" font="굴림,9" text="부서"/>
						<cell align="center" col="8" color="user21" display="text" font="굴림,9" text="팀"/>
						<cell align="center" col="9" color="user21" display="text" font="굴림,9" text="담당자"/>
						<cell align="center" col="10" color="user21" display="text" font="굴림,9" text="담당자명"/>
						<cell align="center" col="11" color="user21" display="text" font="굴림,9" text="고객"/>
						<cell align="center" col="12" color="user21" display="text" font="굴림,9" text="고객명"/>
						<cell align="center" col="13" color="expr:GC_FONTCOLOR_EDITABLE_T" display="text" font="굴림,9" text="국가명"/>
						<cell align="center" col="14" color="expr:GC_FONTCOLOR_EDITABLE_T" display="text" font="굴림,9" text="권역명"/>
						<cell align="center" col="15" color="expr:GC_FONTCOLOR_EDITABLE_T" display="text" font="굴림,9" text="공사명"/>
						<cell align="center" col="16" color="expr:GC_FONTCOLOR_EDITABLE_T" display="text" font="굴림,9" text="설치지역"/>
						<cell align="center" col="17" color="expr:GC_FONTCOLOR_EDITABLE_T" display="text" font="굴림,9" text="기종"/>
						<cell align="center" col="18" color="expr:GC_FONTCOLOR_EDITABLE_T" display="text" font="굴림,9" text="건물용도"/>
						<cell align="center" col="19" color="expr:GC_FONTCOLOR_EDITABLE_T" display="text" font="굴림,9" text="건물용도대분류"/>
						<cell align="center" col="20" color="expr:GC_FONTCOLOR_EDITABLE_T" display="text" font="굴림,9" text="인승"/>
						<cell align="center" col="21" color="expr:GC_FONTCOLOR_EDITABLE_T" display="text" font="굴림,9" text="속도"/>
						<cell align="center" col="22" color="expr:GC_FONTCOLOR_EDITABLE_T" display="text" font="굴림,9" text="층수"/>
						<cell align="center" col="23" color="expr:GC_FONTCOLOR_EDITABLE_T" display="text" font="굴림,9" text="대수"/>
						<cell align="center" col="24" color="expr:GC_FONTCOLOR_EDITABLE_T" display="text" font="굴림,9" text="단납구분"/>
						<cell align="center" col="25" color="expr:GC_FONTCOLOR_EDITABLE_T" display="text" font="굴림,9" text="국내/상해"/>
						<cell align="center" col="26" color="expr:GC_FONTCOLOR_EDITABLE_T" display="text" font="굴림,9" text="중계무역구분"/>
						<cell align="center" col="27" color="expr:GC_FONTCOLOR_EDITABLE_T" display="text" font="굴림,9" text="통화"/>
						<cell align="center" col="28" color="expr:GC_FONTCOLOR_EDITABLE_T" display="text" font="굴림,9" text="수주예상액"/>
						<cell align="center" col="29" color="expr:GC_FONTCOLOR_EDITABLE_T" display="text" font="굴림,9" text="예상시행율"/>
						<cell align="center" col="30" color="expr:GC_FONTCOLOR_EDITABLE_T" display="text" font="굴림,9" text="시행예산산출금액"/>
						<cell align="center" col="31" color="expr:GC_FONTCOLOR_EDITABLE_T" display="text" font="굴림,9" text="납기예정일"/>
						<cell align="center" col="32" color="expr:GC_FONTCOLOR_EDITABLE_T" display="text" font="굴림,9" text="대리점코드"/>
						<cell align="center" col="33" color="expr:GC_FONTCOLOR_EDITABLE_T" display="text" font="굴림,9" text="대리점명"/>
						<cell align="center" col="34" color="expr:GC_FONTCOLOR_EDITABLE_T" display="text" font="굴림,9" text="비고"/>
					</head>
					<body>
						<cell align="center" col="0" display="text" expr="currow+1"/>
						<cell align="center" bkcolor2="user22" col="1" colid="CHK" display='expr:decode(F_CLOSE_YN,&quot;Y&quot;,&quot;text&quot;,&quot;checkbox&quot;)' edit='expr:decode(F_CLOSE_YN,&quot;Y&quot;,&quot;none&quot;,&quot;checkbox&quot;)' expr="iif(currow=ds_list.row,&#32;1,&#32;0)"/>
						<cell align="center" bkcolor2="user22" bkimageid='expr:gfn_getFlagBkImageID(getColumn(currow,&#32;&quot;FLAG&quot;))' col="2" colid="FLAG" display="image"/>
						<cell align="center" autosizing="none" bkcolor2="user22" col="3" colid="ZBPNNR" display="text"/>
						<cell align="center" autosizing="none" bkcolor2="user22" col="4" colid="ZPYEAR" display="text"/>
						<cell align="center" autosizing="none" bkcolor2="user22" col="5" colid="ZPYM" display="text" Mask="expr:gfn_getMaskDate(F_FORM_ID,6)"/>
						<cell align="center" autosizing="none" bkcolor2="user22" col="6" colid="SPART" combocol="CODE" combodataset="ds_list_spart_grid" combodisplayrowcnt="20" combotext="CODE_NAME" display="combo"/>
						<cell align="left" autosizing="none" bkcolor2="user22" col="7" colid="VKBUR" combocol="CODE" combodataset="ds_list_vb" combodisplayrowcnt="20" combotext="CODE_NAME" display="combo"/>
						<cell align="left" autosizing="none" bkcolor2="user22" col="8" colid="VKGRP" combocol="CODE" combodataset="ds_list_vg" combodisplayrowcnt="20" combotext="CODE_NAME" display="combo"/>
						<cell align="center" autosizing="none" bkcolor2="user22" col="9" colid="ZKUNNR" display="text"/>
						<cell align="left" autosizing="none" bkcolor2="user22" col="10" colid="ZKUNNR_NM" display="text"/>
						<cell align="center" autosizing="none" bkcolor2="user22" col="11" colid="KUNNR" display="text"/>
						<cell align="left" autosizing="none" bkcolor2="user22" col="12" colid="KUNNR_NM" display="text"/>
						<cell align="center" autosizing="none" bkcolor2="user22" checklength="Byte" col="13" colid="LAND1_NM" display="text"/>
						<cell align="center" autosizing="none" bkcolor2="user22" checklength="Byte" col="14" colid="ZAREA_NM" display="text"/>
						<cell align="left" autosizing="none" bkcolor2="user22" checklength="Byte" col="15" colid="GSNAM" display="text"/>
						<cell align="center" autosizing="none" bkcolor2="user22" col="16" colid="REGION" combocol="CODE" combodataset="ds_region_cd_grid" combotext="CODE_NAME" display="combo"/>
						<cell align="left" autosizing="none" bkcolor2="user22" checklength="Byte" col="17" colid="RTYPE" display="text"/>
						<cell align="left" autosizing="none" bkcolor2="user22" col="18" colid="ZBDTYP" combocol="BUILDUSE" combodataset="ds_list_build_grid" combodisplayrowcnt="20" combotext="STEXT" display="combo"/>
						<cell align="left" autosizing="none" bkcolor2="user22" checklength="Byte" col="19" colid="ZBDTYP_LNM" display="text"/>
						<cell align="center" autosizing="none" bkcolor2="user22" checklength="Byte" col="20" colid="TYPE1" display="text"/>
						<cell align="center" autosizing="none" bkcolor2="user22" checklength="Byte" col="21" colid="TYPE2" display="text"/>
						<cell align="center" autosizing="none" bkcolor2="user22" checklength="Byte" col="22" colid="TYPE3" display="text"/>
						<cell align="center" autosizing="none" bkcolor2="user22" checklength="Byte" col="23" colid="ZNUMBER" display="number"/>
						<cell align="center" autosizing="none" bkcolor2="user22" col="24" colid="ZDELI" combocol="CODE" combodataset="ds_zdeli_cd" combotext="CODE_NAME" display="combo"/>
						<cell align="center" autosizing="none" bkcolor2="user22" col="25" colid="SHANGH" combocol="CODE" combodataset="ds_shangh_cd_grid" combotext="CODE_NAME" display="combo"/>
						<cell align="center" autosizing="none" bkcolor2="user22" col="26" colid="ZINTER" combocol="CODE" combodataset="ds_zinter_cd" combotext="CODE_NAME" display="combo"/>
						<cell align="center" autosizing="none" bkcolor2="user22" col="27" colid="WAERK" display="text"/>
						<cell align="right" autosizing="none" bkcolor2="user22" col="28" colid="SOFOCA" display="number"/>
						<cell align="right" autosizing="none" bkcolor2="user22" col="29" colid="ZFORE" display="text"/>
						<cell align="right" autosizing="none" bkcolor2="user22" col="30" colid="ZCOST" display="number"/>
						<cell align="center" autosizing="none" bkcolor2="user22" col="31" colid="DELDAT" display="text" Mask="expr:gfn_getMaskDate(F_FORM_ID)"/>
						<cell align="center" autosizing="none" bkcolor2="user22" checklength="Byte" col="32" colid="ZAGNT" display="text"/>
						<cell align="left" autosizing="none" bkcolor2="user22" checklength="Byte" col="33" colid="ZAGNT_NM" display="text"/>
						<cell align="left" autosizing="none" bkcolor2="user22" checklength="Byte" col="34" colid="ZRMK" display="text"/>
					</body>
					<summary>
						<cell align="center" bkcolor="user25" col="0" display="text" text="합계"/>
						<cell bkcolor="user25" col="1" display="text"/>
						<cell bkcolor="user25" col="2" display="text"/>
						<cell bkcolor="user25" col="3" color="user26" display="text"/>
						<cell bkcolor="user25" col="4" color="user26" display="text"/>
						<cell bkcolor="user25" col="5" display="text"/>
						<cell bkcolor="user25" col="6" display="text"/>
						<cell bkcolor="user25" col="7" display="text"/>
						<cell bkcolor="user25" col="8" display="text"/>
						<cell bkcolor="user25" col="9" display="text"/>
						<cell bkcolor="user25" col="10" display="text"/>
						<cell bkcolor="user25" col="11" display="text"/>
						<cell bkcolor="user25" col="12" display="text"/>
						<cell bkcolor="user25" col="13" display="text"/>
						<cell bkcolor="user25" col="14" display="text"/>
						<cell bkcolor="user25" col="15" display="text"/>
						<cell bkcolor="user25" col="16" display="text"/>
						<cell bkcolor="user25" col="17" display="text"/>
						<cell bkcolor="user25" col="18" display="text"/>
						<cell bkcolor="user25" col="19" display="text"/>
						<cell bkcolor="user25" col="20" display="text"/>
						<cell bkcolor="user25" col="21" display="text"/>
						<cell bkcolor="user25" col="22" display="text"/>
						<cell align="center" bkcolor="user25" col="23" display="number" expr='sum(&quot;ZNUMBER&quot;)'/>
						<cell bkcolor="user25" col="24" display="text"/>
						<cell bkcolor="user25" col="25" display="text"/>
						<cell bkcolor="user25" col="26" display="text"/>
						<cell align="center" bkcolor="user25" col="27" display="text"/>
						<cell align="right" bkcolor="user25" col="28" display="number" expr='SUM(&quot;SOFOCA&quot;)'/>
						<cell align="right" bkcolor="user25" col="29" display="number" expr='ROUND(SUM(&quot;ZFORE&quot;)&#32;/&#32;parseInt(ds_list.Rowcount()),&#32;2)'/>
						<cell align="right" bkcolor="user25" col="30" display="number" expr='SUM(&quot;ZCOST&quot;)'/>
						<cell bkcolor="user25" col="31" display="text"/>
						<cell bkcolor="user25" col="32" display="text"/>
						<cell bkcolor="user25" col="33" display="text"/>
						<cell bkcolor="user25" col="34" display="text"/>
					</summary>
				</format>
			</contents>
		</Grid>
		<Calendar Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Dateformat="yyyy.MM" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="22" Id="cal_zpym" Left="78" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_search_ind" SundayTextColor="user35" TabOrder="2" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="27" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="77"></Calendar>
		<Static Align="Right" Height="20" Id="st_i_ymd" Left="5" Style="sty_lb_search" TabOrder="2" Text="계획년월&#32;" Top="27" VAlign="Middle" Width="70"></Static>
		<Div BKColor="user0" Height="22" Id="div_sman" Left="731" OnLoadCompleted="fn_OnLoadCompleted" TabOrder="5" Text="Div0" Top="27" Url="COM::Coms002.xml" Width="220">
			<Contents></Contents>
		</Div>
		<Static Align="Right" Height="20" Id="Static1" Left="658" Style="sty_lb_search" TabOrder="8" Text="담당자&#32;" Top="27" VAlign="Middle" Width="70"></Static>
		<Static Align="Right" Height="20" Id="st_i_spart" Left="158" Style="sty_lb_search" TabOrder="8" Text="제품군&#32;" Top="27" VAlign="Middle" Width="70"></Static>
		<Combo Border="Flat" CodeColumn="CODE" DataColumn="CODE_NAME" Height="20" Id="cb_spart" InnerDataset="ds_list_spart" Left="231" Style="sty_ipt_form" TabOrder="3" Top="27" Width="70"></Combo>
		<Div BKColor="user0" Height="20" Id="div_vbvg" Left="377" OnLoadCompleted="fn_OnLoadCompleted" OnTimer="WB0199010A_OnTimer" TabOrder="4" Text="Div0" Top="27" Url="COM::Coms011.xml" Width="280">
			<Contents></Contents>
		</Div>
		<Edit Align="CENTER" Border="Flat" Enable="FALSE" Height="20" Id="ed_opendtm" Left="158" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="9" TabStop="FALSE" Text="사업계획&#32;오픈&#32;:&#32;" Top="5" Width="183"></Edit>
		<Calendar Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Dateformat="yyyy" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_zpyear" Left="78" MonthPickerFormat="yyyy년" MonthPopupBorder="FLAT" OnChanged="cal_zpyear_OnChanged" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_search_ind" SundayTextColor="user35" TabOrder="1" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="5" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="77"></Calendar>
		<Static Align="Right" Height="20" Id="Static0" Left="5" Style="sty_lb_search" TabOrder="9" Text="편성년도&#32;" Top="5" VAlign="Middle" Width="70"></Static>
		<Grid AutoEnter="TRUE" AutoFitEndLine="Hide" BindDataset="ds_list_detail" BkColor2="default" BoldHead="true" Border="Flat" Bottom="554" ColSelect="TRUE" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="98" Id="grd_list_detail" InputPanel="FALSE" Left="8" LineColor="user20" LineType="ExHORZ" OnHeadClick="grd_list_detail_OnHeadClick" OnKeyDown="grd_list_detail_OnKeyDown" Right="980" RowHeight="20" Style="sty_grid" TabOrder="8" TabStop="true" Top="456" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="972">
			<contents>
				<format id="Default">
					<columns>
						<col width="36"/>
						<col width="100"/>
						<col width="68"/>
						<col width="68"/>
						<col width="68"/>
						<col width="68"/>
						<col width="68"/>
						<col width="68"/>
						<col width="68"/>
						<col width="68"/>
						<col width="68"/>
						<col width="68"/>
						<col width="68"/>
						<col width="68"/>
						<col width="68"/>
						<col width="68"/>
						<col width="68"/>
						<col width="68"/>
						<col width="68"/>
						<col width="68"/>
						<col width="68"/>
						<col width="68"/>
						<col width="68"/>
						<col width="68"/>
						<col width="68"/>
						<col width="68"/>
						<col width="68"/>
						<col width="68"/>
						<col width="68"/>
						<col width="68"/>
						<col width="68"/>
						<col width="68"/>
					</columns>
					<head>
						<cell align="center" bkimageid="icon_grid_sel" col="0" display="text" font="굴림,9"/>
						<cell align="center" col="1" display="text" font="굴림,9" text="합계"/>
						<cell align="center" col="2" color='expr:decode(F_CLOSE_YN,&quot;Y&quot;,GC_FONTCOLOR_EDITABLE_F,GC_FONTCOLOR_EDITABLE_T)' display="text" font="굴림,9" text="M+0"/>
						<cell align="center" col="3" color='expr:decode(F_CLOSE_YN,&quot;Y&quot;,GC_FONTCOLOR_EDITABLE_F,GC_FONTCOLOR_EDITABLE_T)' display="text" font="굴림,9" text="M+1"/>
						<cell align="center" col="4" color='expr:decode(F_CLOSE_YN,&quot;Y&quot;,GC_FONTCOLOR_EDITABLE_F,GC_FONTCOLOR_EDITABLE_T)' display="text" font="굴림,9" text="M+2"/>
						<cell align="center" col="5" color='expr:decode(F_CLOSE_YN,&quot;Y&quot;,GC_FONTCOLOR_EDITABLE_F,GC_FONTCOLOR_EDITABLE_T)' display="text" font="굴림,9" text="M+3"/>
						<cell align="center" col="6" color='expr:decode(F_CLOSE_YN,&quot;Y&quot;,GC_FONTCOLOR_EDITABLE_F,GC_FONTCOLOR_EDITABLE_T)' display="text" font="굴림,9" text="M+4"/>
						<cell align="center" col="7" color='expr:decode(F_CLOSE_YN,&quot;Y&quot;,GC_FONTCOLOR_EDITABLE_F,GC_FONTCOLOR_EDITABLE_T)' display="text" font="굴림,9" text="M+5"/>
						<cell align="center" col="8" color='expr:decode(F_CLOSE_YN,&quot;Y&quot;,GC_FONTCOLOR_EDITABLE_F,GC_FONTCOLOR_EDITABLE_T)' display="text" font="굴림,9" text="M+6"/>
						<cell align="center" col="9" color='expr:decode(F_CLOSE_YN,&quot;Y&quot;,GC_FONTCOLOR_EDITABLE_F,GC_FONTCOLOR_EDITABLE_T)' display="text" font="굴림,9" text="M+7"/>
						<cell align="center" col="10" color='expr:decode(F_CLOSE_YN,&quot;Y&quot;,GC_FONTCOLOR_EDITABLE_F,GC_FONTCOLOR_EDITABLE_T)' display="text" font="굴림,9" text="M+8"/>
						<cell align="center" col="11" color='expr:decode(F_CLOSE_YN,&quot;Y&quot;,GC_FONTCOLOR_EDITABLE_F,GC_FONTCOLOR_EDITABLE_T)' display="text" font="굴림,9" text="M+9"/>
						<cell align="center" col="12" color='expr:decode(F_CLOSE_YN,&quot;Y&quot;,GC_FONTCOLOR_EDITABLE_F,GC_FONTCOLOR_EDITABLE_T)' display="text" font="굴림,9" text="M+10"/>
						<cell align="center" col="13" color='expr:decode(F_CLOSE_YN,&quot;Y&quot;,GC_FONTCOLOR_EDITABLE_F,GC_FONTCOLOR_EDITABLE_T)' display="text" font="굴림,9" text="M+11"/>
						<cell align="center" col="14" color='expr:decode(F_CLOSE_YN,&quot;Y&quot;,GC_FONTCOLOR_EDITABLE_F,GC_FONTCOLOR_EDITABLE_T)' display="text" font="굴림,9" text="M+12"/>
						<cell align="center" col="15" color='expr:decode(F_CLOSE_YN,&quot;Y&quot;,GC_FONTCOLOR_EDITABLE_F,GC_FONTCOLOR_EDITABLE_T)' display="text" font="굴림,9" text="M+13"/>
						<cell align="center" col="16" color='expr:decode(F_CLOSE_YN,&quot;Y&quot;,GC_FONTCOLOR_EDITABLE_F,GC_FONTCOLOR_EDITABLE_T)' display="text" font="굴림,9" text="M+14"/>
						<cell align="center" col="17" color='expr:decode(F_CLOSE_YN,&quot;Y&quot;,GC_FONTCOLOR_EDITABLE_F,GC_FONTCOLOR_EDITABLE_T)' display="text" font="굴림,9" text="M+15"/>
						<cell align="center" col="18" color='expr:decode(F_CLOSE_YN,&quot;Y&quot;,GC_FONTCOLOR_EDITABLE_F,GC_FONTCOLOR_EDITABLE_T)' display="text" font="굴림,9" text="M+16"/>
						<cell align="center" col="19" color='expr:decode(F_CLOSE_YN,&quot;Y&quot;,GC_FONTCOLOR_EDITABLE_F,GC_FONTCOLOR_EDITABLE_T)' display="text" font="굴림,9" text="M+17"/>
						<cell align="center" col="20" color='expr:decode(F_CLOSE_YN,&quot;Y&quot;,GC_FONTCOLOR_EDITABLE_F,GC_FONTCOLOR_EDITABLE_T)' display="text" font="굴림,9" text="M+18"/>
						<cell align="center" col="21" color='expr:decode(F_CLOSE_YN,&quot;Y&quot;,GC_FONTCOLOR_EDITABLE_F,GC_FONTCOLOR_EDITABLE_T)' display="text" font="굴림,9" text="M+19"/>
						<cell align="center" col="22" color='expr:decode(F_CLOSE_YN,&quot;Y&quot;,GC_FONTCOLOR_EDITABLE_F,GC_FONTCOLOR_EDITABLE_T)' display="text" font="굴림,9" text="M+20"/>
						<cell align="center" col="23" color='expr:decode(F_CLOSE_YN,&quot;Y&quot;,GC_FONTCOLOR_EDITABLE_F,GC_FONTCOLOR_EDITABLE_T)' display="text" font="굴림,9" text="M+21"/>
						<cell align="center" col="24" color='expr:decode(F_CLOSE_YN,&quot;Y&quot;,GC_FONTCOLOR_EDITABLE_F,GC_FONTCOLOR_EDITABLE_T)' display="text" font="굴림,9" text="M+22"/>
						<cell align="center" col="25" color='expr:decode(F_CLOSE_YN,&quot;Y&quot;,GC_FONTCOLOR_EDITABLE_F,GC_FONTCOLOR_EDITABLE_T)' display="text" font="굴림,9" text="M+23"/>
						<cell align="center" col="26" color='expr:decode(F_CLOSE_YN,&quot;Y&quot;,GC_FONTCOLOR_EDITABLE_F,GC_FONTCOLOR_EDITABLE_T)' display="text" font="굴림,9" text="M+24"/>
						<cell align="center" col="27" color='expr:decode(F_CLOSE_YN,&quot;Y&quot;,GC_FONTCOLOR_EDITABLE_F,GC_FONTCOLOR_EDITABLE_T)' display="text" font="굴림,9" text="M+25"/>
						<cell align="center" col="28" color='expr:decode(F_CLOSE_YN,&quot;Y&quot;,GC_FONTCOLOR_EDITABLE_F,GC_FONTCOLOR_EDITABLE_T)' display="text" font="굴림,9" text="M+26"/>
						<cell align="center" col="29" color='expr:decode(F_CLOSE_YN,&quot;Y&quot;,GC_FONTCOLOR_EDITABLE_F,GC_FONTCOLOR_EDITABLE_T)' display="text" font="굴림,9" text="M+27"/>
						<cell align="center" col="30" color='expr:decode(F_CLOSE_YN,&quot;Y&quot;,GC_FONTCOLOR_EDITABLE_F,GC_FONTCOLOR_EDITABLE_T)' display="text" font="굴림,9" text="M+28"/>
						<cell align="center" col="31" color='expr:decode(F_CLOSE_YN,&quot;Y&quot;,GC_FONTCOLOR_EDITABLE_F,GC_FONTCOLOR_EDITABLE_T)' display="text" font="굴림,9" text="M+29"/>
					</head>
					<body>
						<cell align="center" bkcolor="aliceblue" col="0" colid="GBN_NM"/>
						<cell align="right" bkcolor="user25" col="1" display="number" expr="AMT00+AMT01+AMT02+AMT03+AMT04+AMT05+AMT06+AMT07+AMT08+AMT09+AMT10+AMT11+AMT12+AMT13+AMT14+AMT15+AMT16+AMT17+AMT18+AMT19+AMT20+AMT21+AMT22+AMT23+AMT24+AMT25+AMT26+AMT27+AMT28+AMT29" limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="2" colid="AMT00" display="number" edit='expr:decode(F_CLOSE_YN,&quot;Y&quot;,&quot;none&quot;,&#32;&quot;normal&quot;)' limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="3" colid="AMT01" display="number" edit='expr:decode(F_CLOSE_YN,&quot;Y&quot;,&quot;none&quot;,&#32;&quot;normal&quot;)' limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="4" colid="AMT02" display="number" edit='expr:decode(F_CLOSE_YN,&quot;Y&quot;,&quot;none&quot;,&#32;&quot;normal&quot;)' limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="5" colid="AMT03" display="number" edit='expr:decode(F_CLOSE_YN,&quot;Y&quot;,&quot;none&quot;,&#32;&quot;normal&quot;)' limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="6" colid="AMT04" display="number" edit='expr:decode(F_CLOSE_YN,&quot;Y&quot;,&quot;none&quot;,&#32;&quot;normal&quot;)' limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="7" colid="AMT05" display="number" edit='expr:decode(F_CLOSE_YN,&quot;Y&quot;,&quot;none&quot;,&#32;&quot;normal&quot;)' limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="8" colid="AMT06" display="number" edit='expr:decode(F_CLOSE_YN,&quot;Y&quot;,&quot;none&quot;,&#32;&quot;normal&quot;)' limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="9" colid="AMT07" display="number" edit='expr:decode(F_CLOSE_YN,&quot;Y&quot;,&quot;none&quot;,&#32;&quot;normal&quot;)' limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="10" colid="AMT08" display="number" edit='expr:decode(F_CLOSE_YN,&quot;Y&quot;,&quot;none&quot;,&#32;&quot;normal&quot;)' limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="11" colid="AMT09" display="number" edit='expr:decode(F_CLOSE_YN,&quot;Y&quot;,&quot;none&quot;,&#32;&quot;normal&quot;)' limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="12" colid="AMT10" display="number" edit='expr:decode(F_CLOSE_YN,&quot;Y&quot;,&quot;none&quot;,&#32;&quot;normal&quot;)' limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="13" colid="AMT11" display="number" edit='expr:decode(F_CLOSE_YN,&quot;Y&quot;,&quot;none&quot;,&#32;&quot;normal&quot;)' limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="14" colid="AMT12" display="number" edit='expr:decode(F_CLOSE_YN,&quot;Y&quot;,&quot;none&quot;,&#32;&quot;normal&quot;)' limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="15" colid="AMT13" display="number" edit='expr:decode(F_CLOSE_YN,&quot;Y&quot;,&quot;none&quot;,&#32;&quot;normal&quot;)' limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="16" colid="AMT14" display="number" edit='expr:decode(F_CLOSE_YN,&quot;Y&quot;,&quot;none&quot;,&#32;&quot;normal&quot;)' limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="17" colid="AMT15" display="number" edit='expr:decode(F_CLOSE_YN,&quot;Y&quot;,&quot;none&quot;,&#32;&quot;normal&quot;)' limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="18" colid="AMT16" display="number" edit='expr:decode(F_CLOSE_YN,&quot;Y&quot;,&quot;none&quot;,&#32;&quot;normal&quot;)' limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="19" colid="AMT17" display="number" edit='expr:decode(F_CLOSE_YN,&quot;Y&quot;,&quot;none&quot;,&#32;&quot;normal&quot;)' limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="20" colid="AMT18" display="number" edit='expr:decode(F_CLOSE_YN,&quot;Y&quot;,&quot;none&quot;,&#32;&quot;normal&quot;)' limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="21" colid="AMT19" display="number" edit='expr:decode(F_CLOSE_YN,&quot;Y&quot;,&quot;none&quot;,&#32;&quot;normal&quot;)' limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="22" colid="AMT20" display="number" edit='expr:decode(F_CLOSE_YN,&quot;Y&quot;,&quot;none&quot;,&#32;&quot;normal&quot;)' limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="23" colid="AMT21" display="number" edit='expr:decode(F_CLOSE_YN,&quot;Y&quot;,&quot;none&quot;,&#32;&quot;normal&quot;)' limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="24" colid="AMT22" display="number" edit='expr:decode(F_CLOSE_YN,&quot;Y&quot;,&quot;none&quot;,&#32;&quot;normal&quot;)' limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="25" colid="AMT23" display="number" edit='expr:decode(F_CLOSE_YN,&quot;Y&quot;,&quot;none&quot;,&#32;&quot;normal&quot;)' limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="26" colid="AMT24" display="number" edit='expr:decode(F_CLOSE_YN,&quot;Y&quot;,&quot;none&quot;,&#32;&quot;normal&quot;)' limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="27" colid="AMT25" display="number" edit='expr:decode(F_CLOSE_YN,&quot;Y&quot;,&quot;none&quot;,&#32;&quot;normal&quot;)' limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="28" colid="AMT26" display="number" edit='expr:decode(F_CLOSE_YN,&quot;Y&quot;,&quot;none&quot;,&#32;&quot;normal&quot;)' limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="29" colid="AMT27" display="number" edit='expr:decode(F_CLOSE_YN,&quot;Y&quot;,&quot;none&quot;,&#32;&quot;normal&quot;)' limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="30" colid="AMT28" display="number" edit='expr:decode(F_CLOSE_YN,&quot;Y&quot;,&quot;none&quot;,&#32;&quot;normal&quot;)' limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="31" colid="AMT29" display="number" edit='expr:decode(F_CLOSE_YN,&quot;Y&quot;,&quot;none&quot;,&#32;&quot;normal&quot;)' limit="13" LimitDec="0"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Static Align="Right" Height="20" Id="Static4" Left="303" Style="sty_lb_search" TabOrder="15" Text="부서/팀&#32;" Top="27" VAlign="Middle" Width="70"></Static>
		<Checkbox Height="20" Id="chk_enter" Left="993" TabOrder="16" Top="8" Visible="FALSE" Width="20"></Checkbox>
	</Form>
	<Script><![CDATA[
/*******************************************************************************************
 * 기      능   : 사업계획관리 (Sbp0010)
 * 작  성  자   : 구란이
 * 작성  일자   : 2012.07.09
 * ----------------------------------------------------------------------------------------
 * HISTORY    : V1.0 : 2012.09.03 : 신규
 * COMMENT
   0. T-CODE                : 
   1. WFC URL 				: 
   2. WFC OPERATION NAME 	: 
   3. WFC OBJ NAME 			: 
   4. 개발자료 :   
 *******************************************************************************************/
#include "LIB::commons.js";			// 공통 스크립트  
#include "LIB::nsfRequest.js";		// 공통 스크립트  /* GNY 추가 */
#include "LIB::common_hdel.js";		// 공통 스크립트  /* GNY 추가 */

//=========================================================================================
// [ PART 1 ]
// Form에서 사용될 전역변수를 선언
// FORM에서 사용되는 전역변수는 대문자로 작성하며, F_XXX 의 형태를 갖도록 한다. 
//=========================================================================================
var F_FORM_ID 			= "Sbp0010";   

// 컬럼번호
var F_COLNUM_CHK		= "";  	// 선택여부
var F_COLNUM_FLAG		= "";  	// 변경구분
var F_COLNUM_ZBPNNR		= "";  	// 사업계획번호
var F_COLNUM_ZPYEAR		= "";  	// 편성년도
var F_COLNUM_ZPYM		= "";  	// 계획년월
var F_COLNUM_SPART 		= "";  	// 제품군
var F_COLNUM_VKBUR 		= "";  	// 사업장 
var F_COLNUM_VKGRP 		= "";  	// 영업그룹
var F_COLNUM_ZKUNNR 	= "";  	// 담당자  
var F_COLNUM_ZKUNNR_NM 	= "";  	// 담당자명
var F_COLNUM_KUNNR 		= "";  	// 거래선
var F_COLNUM_KUNNR_NM 	= "";  	// 거래선명 
var F_COLNUM_GSNAM      = ""; 	// 공사명
var F_COLNUM_REGION     = ""; 	// 설치지역
var F_COLNUM_GTYPE      = ""; 	// 기종
var F_COLNUM_TYPE1      = ""; 	// TYPE1 (인승)
var F_COLNUM_TYPE2      = ""; 	// TYPE2 (속도)
var F_COLNUM_TYPE3      = "";   // TYPE3 (층수)
var F_COLNUM_ZNUMBER    = ""; 	// 대수
var F_COLNUM_ZDELI      = ""; 	// 단납기구분
var F_COLNUM_SHANGH     = ""; 	// 국내/상해구분
var F_COLNUM_ZINTER     = ""; 	// 중계무역구분
var F_COLNUM_SOFOCA     = ""; 	// 수주예상액
var F_COLNUM_ZFORE      = ""; 	// 예상시행율
var F_COLNUM_WAERK      = ""; 	// 통화
var F_COLNUM_DELDAT     = ""; 	// 납기예정일
var F_COLNUM_ZRMK       = ""; 	// 비고 
var F_COLNUM_ZAGNT      = "";	// 대리점
 
var F_COLNUM_TOT1      	= 1;   // 매출청구수금 그리드 합계 
var F_COLNUM_YEAYM     	= 2;   // 매출청구수금 그리드 기준년월
 
var F_CLOSE_YN 			= "Y"; // 계획년월의 마감여부
var F_ZBPNNR			= "";  // 사업계획번호
var F_SYSDATE           = "";  // 현재년월일(8자리) 
var F_USER_GROUP_B 		= "";  // 사용자권한 (G_USER_GROUP_B)
var F_WORK_GBN          = "";  // 어떤 버튼을 클릭했는지 구분(Q:조회, S:저장, D:삭제, E:엑셀)

var F_ZAGNT				= "";  // 대리점사용자의 경우 대리점코드
var F_ZAGNT_NM			= "";  // 대리점사용자의 경우 대리점명

// 저장 시 매출/청구/수금 자동산출여부 체크할 항목들
var F_AUTO_COMPUTE_ARR   = [ "AUART", "SPART", "GTYPE", "MATNR", "ZINTER", "SHANGH", "SOFOCA"];	// 오더유형, 제품군, 기종, 자재번호, 중계무역구분, 국내/상해, 수주예상액

// 서브화면 조정 필요시 값 입력, 불필요 시 ""   
var F_SMAN_WIDTH 	= "132";  	// 담당자코드 서브화면 폼 WIDTH
var F_SMAN_CD_WIDTH	= "111";  	// 담당자코드 서브화면 코드 WIDTH
var F_SMAN_NM_WIDTH	= "";  		// 담당자코드 서브화면 코드명 WIDTH 
// var F_VBVG_WIDTH 	= "";  	// 부서/팀코드 서브화면 폼 WIDTH
// var F_VBVG_VB_WIDTH	= "";  	// 부서/팀코드 서브화면 부서코드 WIDTH
// var F_VBVG_VG_WIDTH	= "";  	// 부서/팀코드 서브화면 팀코드 WIDTH
// var F_FRVB_ESSN_YN  = "";	// 시작부서코드 필수여부
// var F_TOVB_ESSN_YN  = "";	// 종료부서코드 필수여부
// var F_TOVB_HIDDEN_YN = "";	// 종료부서코드 숨김 여부

//=========================================================================================
// [ PART 2 ]
// Form Loading / Unloading 시 작업 정의
//=========================================================================================
function fn_OnLoadCompleted(obj) {
	
	gfn_initForm(true);
	fn_init_form();	// 폼 초기화
	
	/* list 코드 LOAD */ 
	gfn_SetListCode(F_FORM_ID, GC_CDGB_SPART			, ds_list_spart	, cb_spart 				, 0, "Y", "N");  	// 제품군_검색조건
	gfn_SetListCode(F_FORM_ID, GC_CDGB_REGION			, ds_region_cd	, div_detail.cb_region	, 0, "N", "Y");  	// 설치지역_저장항목
	gfn_SetListCode(F_FORM_ID, GC_CDGB_WAERK			, ds_waerk_cd	, div_detail.cb_waerk	, 0, "N", "Y");  	// 통화지역_저장항목
 	gfn_SetListCode(F_FORM_ID, GC_CDGB_PSPID_SAVE_STAT	, ds_save_stat	, ""					, 0, "N", "N");  	// 사업계획저장상태
 	
 	// 그리드용 list 코드 지역데이타셋
 	gfn_copyDs(ds_region_cd, ds_region_cd_grid, "CODE <> ''");	
 	gfn_copyDs(ds_list_spart, ds_list_spart_grid, "CODE <> ''");	
 	
 	// 공통코드 콤보목록 조회
 	fn_query_dd07t("ZDELI"	, ds_zdeli_cd	);		// 단납구분
 	fn_query_dd07t("ZSHANG"	, ds_shangh_cd	);		// 국내/상해
 //	fn_query_dd07t("ZGTYPE"	, ds_gtype_cd	);		// 기종
// 	fn_query_dd07t("ZSHANG"	, ds_zinter_cd	);		// 중계무역

 	// 기종- RYPE  시작 
	ds_combo.DeleteAll();
	ds_combo_gubun.DeleteAll();
	ds_combo_gubun.AddRow();
	ds_combo_gubun.SetColumn(0, "GUBUN", 'ds_cond_gtype');
	ds_cond_gtype.DeleteAll();
	ds_cond_gtype.AddRow();

	if (G_SAP_USER_VBCD == null || G_SAP_USER_VBCD == '') ds_cond_gtype.SetColumn(0, "VKBUR", '');
	else                                                  ds_cond_gtype.SetColumn(0, "VKBUR", G_SAP_USER_VBCD);

	if (G_SAP_USER_VGCD == null || G_SAP_USER_VGCD == '') ds_cond_gtype.SetColumn(0, "VKGRP", '');
	else 	                                              ds_cond_gtype.SetColumn(0, "VKGRP", G_SAP_USER_VGCD);

	if (G_SAP_USER_ID == null || G_SAP_USER_ID == '')     ds_cond_gtype.SetColumn(0, "ZKUNNR", '');
	else 		                                          ds_cond_gtype.SetColumn(0, "ZKUNNR", G_SAP_USER_ID);

	// 서비스 호출
	nsfRequest("GTYPE"																								// srvId
				, "sbp0160/combo"																					// url
				, "ds_combo_gubun=ds_combo_gubun ds_combo=ds_combo ds_cond_gtype=ds_cond_gtype ds_gtype=ds_gtype ds_gtypes=ds_gtypes"	// inDsList
				, "ds_combo=ds_combo ds_gtype=ds_gtype ds_gtypes=ds_gtypes"															// outDsList
				, ""																								// strParam
				, "fn_afterQuery_combo"																				// CallBackFunc
				);
	// 기종- RTYPE  종료 
    
 	fn_query_grid_vb();	// 부서전체목록	콤보
 	fn_query_grid_vg();	// 팀  전체목록 콤보
	fn_query_zagnt(G_ORG_VEND_CODE_B); 	// 대리점명 조회
	fn_query_bdtyp(); //건물용도 콤보
}

function fn_afterQuery_combo(svcId, errCode, errMsg) { // 콤보 
/*
	switch(svcId) {
		case "GTYPE" : ds_gtype.Copy(ds_combo); break; // 기종
	}*/
}

/********************************************************************************
* 기      능   : 공통코드가 조회된 후의 Callback 함수 (common.js에서 호출됨)
********************************************************************************/
function fn_completeInit(sCode, sDsObj, sCodeType) {
	gfn_showMsg("CI00007");  
}

/********************************************************************************
* 기      능   : form UnloadCompleted 
********************************************************************************/
function fn_OnUnloadCompleted(obj) {
	return gfn_isFormUnload(obj);
}
 
//=========================================================================================
// [ PART 3 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,form닫기)
//=========================================================================================
/********************************************************************************
* 기      능   : 조회 1
********************************************************************************/
var fn_query_chk = false; //중복 조회방지용 flag

function fn_query() { 
	
	gfn_clearMsgBar();
	gfn_clearGridSortMark(grd_list); 	// sort mark 삭제 
	
	if (fn_valid_chk("query") == false)  return; 	// 조회조건 항목오류검증
	
	// 조회조건에 해당하는 그리드 항목의 Width = 0 처리 
	var sman_cd = trim(div_sman.ed_sman_cd.text); 
	grd_list.SetColProp(F_COLNUM_SPART		, "Width", iif(length(cb_spart.Value)==0,52,0));	 	// 제품군
	grd_list.SetColProp(F_COLNUM_VKBUR		, "Width", iif(length(div_vbvg.cb_frvb.Value)==0,87,0));// 부서
	grd_list.SetColProp(F_COLNUM_VKGRP		, "Width", iif(length(div_vbvg.cb_frvg.Value)==0,99,0));// 팀
	grd_list.SetColProp(F_COLNUM_ZKUNNR		, "Width", iif(length(sman_cd)==0,65,0));				// 담당자코드
	grd_list.SetColProp(F_COLNUM_ZKUNNR_NM	, "Width", iif(length(sman_cd)==0,73,0));				// 담당자명 
 
	// 조회조건 설정
	ds_cond.ClearData();   
	if (fn_param_set("query") == false)  return; // trace(ds_cond.SaveXML());

	if(!fn_query_chk) {
		fn_query_chk = true;
	} else {
		gfn_showAlert("CW10025", "조회중입니다..");
		return;
	}

	fn_grid_header_set(); 	// 그리드헤더 년월 (18개월)Set
	F_ZBPNNR = "";  	// 사업계획번호 초기화
	
	// 임시로 관리자에게 입력권한 부여 20130115  by 김선호 -> 홍수봉DL 요청 
	if ( G_USER_ID <> '2018144' and G_USER_ID <> '2019116' and G_USER_ID <> '2018080' and
	     G_USER_ID <> '2020483' and G_USER_ID <> '2020564' and G_USER_ID <> '2020254') {
		fn_enable_set(false); // 오픈인 경우 수정가능, 마감 인 경우 수정불가
	}
	
	fn_createWait("",this);     // 처리중입니다. 메시지 처리
	fn_query_saveAfter("fn_afterQuery");
}

/********************************************************************************
* 기      능   : 조회 1
********************************************************************************/
function fn_query_saveAfter(pCallback) { 
	
	ds_list.Fireevent = false;
	
	// 조회조건 설정
	ds_cond.ClearData();   
	if (fn_param_set("query") == false)  return; // trace(ds_cond.SaveXML()); 

	// 임시로 관리자에게 입력권한 부여 20130115  by 김선호 -> 홍수봉DL 요청 
	if ( G_USER_ID <> '2018144' and G_USER_ID <> '2019116' and G_USER_ID <> '2018080' and
	     G_USER_ID <> '2020483' and G_USER_ID <> '2020564' and G_USER_ID <> '2020254' ) {
		fn_enable_set(false); // 오픈인 경우 수정가능, 마감인 경우 수정불가
	}
	div_detail.ed_gtype_info.Text = "";	// 기종정보 초기화
	
	// 서비스 호출
	ds_detail.ClearData();  
	ds_list_detail.ClearData();  
	ds_list.ClearData();   
	ds_error.ClearData();
	nsfRequest("query", "sbp0010/find", "ds_cond=ds_cond ds_list=ds_list ", "ds_list=ds_list ds_error=ds_error", "", pCallback);
}

/********************************************************************************
* 기      능   : 조회 1
********************************************************************************/
function fn_query_bill() {  
	
	gfn_clearMsgBar();  
	
	if (fn_valid_chk("query_bill") == false)  return;	// 조회조건 항목오류검증
	 
	// 조회조건 설정
	ds_cond_detail.ClearData();   
	if (fn_param_set("query_bill") == false)  return; //trace(ds_cond_detail.SaveXML()); 

	F_ZBPNNR = "";	// 사업계획번호 초기화
	
	ds_list_detail.Fireevent = false; 	// 데이타셋 이벤트 비활성화
	  
	// 서비스 호출
	fn_createWait("",this);     // 처리중입니다. 메시지 처리
	ds_detail.ClearData();  
	ds_list_detail.ClearData();   
	ds_error.ClearData();  
	
	nsfRequest("query"													// srvId
				, "sbp0010/find_detail"									// url
				, "ds_cond_detail=ds_cond_detail ds_list_detail=ds_list_detail ds_yearm=ds_yearm"	// inDsList
				, "ds_detail=ds_detail ds_list_detail=ds_list_detail ds_error=ds_error"				// outDsList
				, ""													// strParam
				, "fn_afterQuery_bill"								// CallBackFunc
				);
}

function fn_param_set(pProcGb) { // INPUT PARAM SET, pProcGb : 처리구분 (query:조회)

	switch(pProcGb)	{
		case "query" :  // 조회 시
			ds_cond.AddRow();
			ds_cond.SetColumn(0, "ZPYEAR"	, replace(trim(cal_zpyear.text),".","")	); 	// 편성년도   
			ds_cond.SetColumn(0, "ZPYM"		, replace(trim(cal_zpym.text),".","")	); 	// 계획년월   
			ds_cond.SetColumn(0, "SPART"	, trim(cb_spart.value)					);  // 제품군
			ds_cond.SetColumn(0, "VKBUR_FR"	, trim(div_vbvg.cb_frvb.Value)			);  // 부서코드_FR
			ds_cond.SetColumn(0, "VKBUR_TO"	, trim(div_vbvg.cb_frvb.Value)			);  // 부서코드_TO
			ds_cond.SetColumn(0, "VKGRP_FR"	, trim(div_vbvg.cb_frvg.Value)			);  // 팀코드_FR  
			ds_cond.SetColumn(0, "VKGRP_TO"	, trim(div_vbvg.cb_frvg.Value)			);  // 팀코드_TO  
			ds_cond.SetColumn(0, "ZKUNNR"	, trim(div_sman.ed_sman_cd.text)		);  // 담당자
			break;  
			
		case "query_bill" :  // 상세조회 시
			ds_cond_detail.AddRow();
			ds_cond_detail.SetColumn(0, "ZBPNNR", ds_list.GetColumn(ds_list.row, "ZBPNNR")); // 사업계획번호
			break;  	
			
		case "save" :  // 사업계획 저장 시  
			// 수주목록에서 선택한 사업계획번호에 해당하는 수주 항목을 상세항목 데이타셋에 복사(ds_list-->ds_detail) 
			ds_detail.AddRow(); 
			ds_list.CopyToRow(ds_list.row, ds_detail, ds_detail.row);  
			
			// 매출/청구/수금 자동산출용 데이타셋 설정
			ds_compute_cond.AddRow();
			ds_compute_cond.SetColumn(0, "SONNR"  , ds_detail.Getcolumn(0, "ZBPNNR" )); // 사업계획번호             
			ds_compute_cond.SetColumn(0, "PLANYM" , ds_detail.Getcolumn(0, "ZPYM"	)); // 계획년월                
			ds_compute_cond.SetColumn(0, "VKBUR"  , ds_detail.Getcolumn(0, "VKBUR"	)); // 부서코드                 
			ds_compute_cond.SetColumn(0, "VKGRP"  , ds_detail.Getcolumn(0, "VKGRP" 	)); // 팀코드                   
			ds_compute_cond.SetColumn(0, "AUART"  , ds_detail.Getcolumn(0, "AUART" 	)); // 오더유형(판매문서유형)   
			ds_compute_cond.SetColumn(0, "SPART"  , ds_detail.Getcolumn(0, "SPART" 	)); // 제품군                   
			ds_compute_cond.SetColumn(0, "GTYPE"  , ds_detail.Getcolumn(0, "GTYPE" 	)); // 기종                     
			ds_compute_cond.SetColumn(0, "MATNR"  , ds_detail.Getcolumn(0, "MATNR" 	)); // 자재코드                 
			ds_compute_cond.SetColumn(0, "ZINTER" , ""								 ); // 중계무역구분(보수:'')   
			ds_compute_cond.SetColumn(0, "SHANGH" , ""								 ); // 국내/상해구분(보수:국내)
			break;    
			
		default: break; 
	}
	return true;
}
/********************************************************************************
* 기      능   : 닫기  
********************************************************************************/
function fn_close() {

	if (fn_valid_chk("close") == false) return false;
	close();
}

/********************************************************************************
* 기      능   : 복원 
********************************************************************************/
function fn_reset() {
	ds_list.Reset(); 
	ds_list_detail.Reset(); 
}

/********************************************************************************
* 기      능   : 액셀  
********************************************************************************/
function fn_excel() {
	
 	gfn_clearMsgBar();
	if (fn_valid_chk("excel") == false)  return; 	// 조회조건 항목오류검증
	gfn_saveToExcel(grd_list, true); 	// Excel Export  
}

//=========================================================================================
// [ PART 3 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,form닫기)
//=========================================================================================
/********************************************************************************
* 기      능   : 저장 : 사업계획 등록, 수정, 삭제
********************************************************************************/
function fn_save() { 
	
	gfn_clearMsgBar();   

	//대리점코드입력체크  jss
	if(ds_list.GetColumn(ds_list.row, "FLAG") != "D"){
		fn_getGtypeInfo(trim(div_detail.cb_gtype.value));
	}
	
	
	if (fn_valid_chk("save") == false)  return false;	// 저장항목 오류검증
	
	var ChgYn = gfn_GetDatasetChgYN(grd_list, ds_list.row, F_AUTO_COMPUTE_ARR, "Y");   	// arr에 선언된 컬럼에 대해서만 변경여부 체크 (Y)  
	var Msg = iif (ChgYn=="N","","매출/청구/수금 정보가 자동 재산출됩니다. \n");

	if (ds_list.GetColumn(ds_list.row, "FLAG") == "D") Msg = ""; 
	if (!gfn_showConfirm("CI00014", Msg + "사업계획 변경사항"))  return false; 	// 저장여부 확인
	
	F_ZBPNNR = "";	// 사업번호 초기화
		
	// 저장항목 값설정  
	ds_detail.ClearData();
	ds_compute_cond.ClearData();
	if (fn_param_set("save") == false)  return false;

	// 서비스 호출 후 사업계획번호 GET
	ds_result.ClearData(); 
	ds_error.ClearData();  
	var in_ds_list =  " ds_detail=ds_detail" 				// IN_상세 저장항목
					+ " ds_compute_cond=ds_compute_cond"	// IN_매출/청구/수금 자동산출용 항목
					+ " ds_list_detail=ds_list_detail"		// IN_매출/청구/수금 항목
					+ " ds_yearm=ds_yearm"					// IN_매출/청구/수금년월
					+ " ds_result=ds_result" 				// OUT_저장완료된 사업계획번호
					;
	var out_ds_list = " ds_result=ds_result" + " ds_error=ds_error";

	fn_createWait("",this);     // 처리중입니다. 메시지 처리
	nsfRequest("update", "sbp0010/save", in_ds_list, out_ds_list, "", "fn_afterSave");
}
 
//=========================================================================================
// [ PART 4]
// Callback 함수 정의 : callback 함수명은 메인 함수의 fn_xxxx() 에서 xxxx 부분은 fn_afterXXXX()
// 형태가 되도록 작성 
//=========================================================================================
/********************************************************************************
* 기      능   : 조회 Callback  
********************************************************************************/
function fn_afterQuery(errCode, errMsg) {   
	
	fn_query_chk = false; //중복조회 방지용 flag
	fn_destroyWait(); 

	ds_list.ApplyChange();
	ds_list.Fireevent = true; //trace(ds_list.SaveXML()); //trace(ds_error.SaveXML());

	F_WORK_GBN = ""; 	// Action 버튼 구분자 SET
	
	if(ds_error.rowcount() > 0) {
		gfn_showMsgBar(ds_error.GetColumn(0,"ERRMSG"));   
		
	} else {
	 
		if (ds_list.RowCount() > 0) {		// 조회된 자료가 있을 경우 

			gfn_showMsg("CI00001");  // CI00001 : "조회를 완료했습니다
			grd_list.SetFocus();    
			
			// 상세조회 실행  (강제로 매출/청구/수금 이벤트 발생시킴)
			var nRow = ds_list.FindRow("ZBPNNR", F_ZBPNNR);  // 기 작업한 사업계획번호의 행번호
			ds_list.Fireevent = false;
			ds_list.row = iif(nRow > 0, nRow, 0); 
			ds_list.Fireevent = true;
			ds_list_OnRowPosChanged(ds_list, -1, ds_list.row); // trace("F_ZBPNNR : " + F_ZBPNNR); trace("nRow : " + nRow);
		} else {
			gfn_showMsg("CW00010"); // CW00010 : "데이터가 없습니다."
		}

		F_CLOSE_YN = iif(ds_list_opendtm.RowCount() > 0, "N", "Y");	// 마감여부   (오픈일시 존재 시 마감여부='N')
		
	// 임시로 관리자에게 입력권한 부여 20130115  by 김선호 -> 홍수봉DL 요청 
		if ( G_USER_ID == '2018144' or G_USER_ID == '2019116' or G_USER_ID == '2018080' or
			G_USER_ID == '2020483' or G_USER_ID == '2020564' or G_USER_ID == '2020254' ) {
			F_CLOSE_YN = 'N';  // 관리자는 사업계획 마감과 상관없음 
		}	
		fn_enable_set(iif(F_CLOSE_YN=="Y", false, true)); // 사업계획 오픈 여부에 따른 항목 enable setting, 오픈인 경우 수정가능, 마감인 경우 수정불가
	}
} 

/********************************************************************************
* 기      능   : 상세조회 Callback  
********************************************************************************/
function fn_afterQuery_bill(errCode, errMsg) {   
	
	fn_destroyWait(); //trace(ds_list_detail.SaveXML()); trace(ds_error.SaveXML());

	ds_list_detail.ApplyChange(); 
	ds_list_detail.Fireevent = true;	// 데이타셋 이벤트 활성화	
	
	if(ds_error.rowcount() > 0) {
		gfn_showMsgBar(ds_error.GetColumn(0,"ERRMSG"));   
		
	} else {
		if (ds_list_detail.RowCount() > 0) gfn_showMsg("CI00001"); // 조회된 자료가 있을 경우 CI00001 : "조회를 완료했습니다.
		else 			                   gfn_showMsg("CW00010"); // CW00010 : "데이터가 없습니다."

		fn_setDetailInfo();	// 상세정보 SET
	}
} 

/********************************************************************************
* 기      능   : 복사 
********************************************************************************/
function fn_copy() {
	var row_original = ds_list.row;
	
	if (ds_list.row == null) {
		alert("복사할 행을 선택해주세요.");
		return;
	}
	
	if (fn_valid_chk("input") == false)  return;  	// 행추가 조건 항목 오류검증
	
	fn_input();

	var newrow = ds_list.rowcount()-1;
	TRACE("eunha debugging newrow: "+newrow);
	
	// 복사
	ds_list.CopyRow(newrow, ds_list, row_original);
	// 세부정보 불러옴
	ds_list_OnRowPosChanged(ds_list, row_original, newrow);
	
	// 세부정보 불러온 뒤 flag, 사업계획번호 재변경
	gfn_changeFlag( ds_list, "CHK", newrow, "FLAG"); // FLAG 변경 : U
	ds_list.SetColumn(ds_list.row, "ZPBNNR", "");
}

/********************************************************************************
* 기      능   : 저장 Callback  
********************************************************************************/
function fn_afterSave(errCode, errMsg) {  
	 
// alert("errCode : " + errCode); alert("errMsg : " + errMsg); // trace(ds_error.SaveXML()); trace(ds_result.SaveXML()); 
// 사업계획저장단계(A:사업계획, C:원가정보, 1:매출정보1, 2:매출정보2, 3:매출정보3, S:매출정보, Z:정상종료, E:비정상종료)
	var save_stat = ds_result.GetColumn(0, "SAVE_STAT");

	if (save_stat == "Z") {	// 사업계획저장 완료(Z)

		gfn_showAlert("CI00003");  // CI00003: "저장을 완료했습니다.
		F_ZBPNNR = ds_result.GetColumn(ds_result.row, "ZBPNNR");  		// 사업번호SET
		ds_list.ApplyChange();
		fn_query_saveAfter("fn_afterSave_requery"); // 저장완료 후 재조회

	} else {
		fn_destroyWait();  		// 처리중 메세지바 종료처리
	
		if (save_stat <> "A") { // 사업계획이 저장은 진행된 상태인 경우

			// CE00002 : ${} 처리에 실패했습니다.\n확인 후 다시 처리해 주십시오.
			gfn_showAlert("CE00002", "사업계획정보는 정상처리되었으나 " + gfn_GetListCodeName(F_FORM_ID, GC_CDGB_PSPID_SAVE_STAT, save_stat));
			F_ZBPNNR = ds_result.GetColumn(ds_result.row, "ZBPNNR"); // 사업번호SET	//trace("fn_afterSave.F_ZBPNNR : " + F_ZBPNNR);

			ds_list.ApplyChange();
			fn_query_saveAfter("fn_afterSave_requery");	// 저장완료 후 재조회

		} else {
			gfn_showMsgBar(ds_error.GetColumn(0,"ERRMSG"), ds_error.GetColumn(0,"ERRCODE")); // 그 외 오류 종료 시
		}
	}
}

function fn_OnClick_btn(obj) { // 임시코딩
	var fncName = "fn_" + substr(obj.id, 4); 
	eval( fncName + "()");
}

/********************************************************************************
* 기      능   : 저장 후 재조회 Callback  
********************************************************************************/
function fn_afterSave_requery(errCode, errMsg) { 

	fn_destroyWait();
	ds_list.Fireevent = true;
	
	if(ds_error.rowcount() > 0) {
		gfn_showMsgBar(ds_error.GetColumn(0,"ERRMSG"), ds_error.GetColumn(0,"ERRCODE"));   
		
	} else { 
			
		gfn_showMsg("CI00003");  // CI00003: "저장을 완료했습니다
		grd_list.SetFocus();
		
		// 상세조회 실행  (강제로 매출/청구/수금 이벤트 발생시킴)
		var nRow = ds_list.FindRow("ZBPNNR", F_ZBPNNR);  // 기 작업한 사업계획번호의 행번호
		ds_list.Fireevent = false;
		ds_list.row = iif(nRow > 0, nRow, 0); 
		ds_list.Fireevent = true;
		ds_list_OnRowPosChanged(ds_list, -1, nRow);	// trace("F_ZBPNNR : " + F_ZBPNNR); // alert("nRow : " + nRow);

		F_CLOSE_YN = iif(ds_list_opendtm.RowCount() > 0, "N", "Y"); // 마감여부   (오픈일시 존재 시 마감여부='N')
		
	// 임시로 관리자에게 입력권한 부여 20130115  by 김선호 -> 홍수봉DL 요청 
		if ( G_USER_ID == '2018144' or G_USER_ID == '2019116' or G_USER_ID == '2018080' or
			G_USER_ID == '2020483' or G_USER_ID == '2020564' or  G_USER_ID == '2020254' ) {
			F_CLOSE_YN = 'N';  // 관리자는 사업계획 마감과 상관없음 
		}	
		
		fn_enable_set(iif(F_CLOSE_YN=="Y", false, true)); // 사업계획 오픈 여부에 따른 항목 enable setting, 오픈인 경우 수정가능, 마감인 경우 수정불가
		
	}
	ds_list.ApplyChange();
} 

function fn_valid_chk(pProcGb) { // 항목 오류 검증, pProcGb : 처리구분 (query:조회,excel:엑셀)

	//trace("fn_valid_chk.pProcGb : " + pProcGb);
	var arr   		= "";
	var ChgYn 		= "N"; 
	var SaveCount 	= 0; 
	var nRow   		= -1;
	var flag 		= "";
			
 	switch(pProcGb)	{
		case "query" :    	// 조회 버튼 클릭 시
		
			if (length(trim(cal_zpyear.Value)) == 0) { // CW00208 : "[${}]은/는 필수입력 입니다.확인바랍니다.")
				gfn_showAlert("CW00208","편성년도"); gfn_SetFocus(cal_zpyear,"Y"); return false;
			}
			if (length(trim(cal_zpym.Value)) == 0) {
				gfn_showAlert("CW00208","계획년월"); gfn_SetFocus(cal_zpym,"Y"); return false;
			}
			if (ds_list.GetUpdate()==true) {
				arr = ["조회","계속"];
				if (gfn_showConfirm("CI10001", arr) == false) {	// "CI10001", "변경된 자료가 존재합니다. \n${} 할 경우 기존에 변경된 정보가 모두 소실됩니다.\n\n{} 하시겠습니까?");
					gfn_SetFocusGrid(grd_list, ds_list.row, 0);  // 변경된 행에 포커싱처리
					return false;					// 조회하지 않기 
				}   
			}
			/*임시 주석처리 	// CW00208 : "[${}]은/는 필수입력 입니다.확인바랍니다.")
			if (length(trim(cb_spart.value))        =="0") { gfn_showAlert("CW00208","제품군"); gfn_SetFocus(cb_spart,"Y"); return false;	}
			if (length(trim(div_vbvg.cb_frvb.Value))  ==0) { gfn_showAlert("CW00208","부서"  ); gfn_SetFocus(div_vbvg.cb_frvb,"Y"); return false; }
			if (length(trim(div_vbvg.cb_frvg.Value))  ==0) { gfn_showAlert("CW00208","팀"    ); gfn_SetFocus(div_vbvg.cb_frvg,"Y"); return false; }
			if (length(trim(div_sman.ed_sman_cd.text))==0) { gfn_showAlert("CW00208","담당자"); gfn_SetFocus(div_sman.ed_sman_cd,"Y"); return false; } */
			break;

		case "query_bill" : // 상세조회 시
			if (length(ds_list.GetColumn(ds_list.row, "ZBPNNR"))==0) {
				return false;
			} break;
			
		case "excel" :   // 엑셀
			if (ds_list.RowCount() <=0) {
				gfn_showAlert("CW00010"); return false; // CW00010 : "데이터가 없습니다."
			} 
			 
			if(gfn_isChangeDs(ds_list, false, "FLAG", "사업계획")== true) {			// 변경된 내역이 존재할 경우 엑셀출력 불가처리
				arr = ["사업계획", "엑셀출력"];
				gfn_showAlert("CW10003", arr); //"CW10003", "변경된 ${}이 존재하여 ${}이 불가능합니다. 변경된 정보를 저장후 다시 실행하여 주십시오.");  // 2012.06.13 : GRY : 추가
				return false;
			} break;
			
		case "input" :       // 입력버튼 클릭 시 
			
			// 매출/수금/계획년월의 18개월이 SET 되어 있어야 함 
			if (ds_yearm.RowCount()== 0) {
				gfn_showAlert("CW00054"); return false; // "CW00054", "조회 후 작업이 가능합니다.");
			}
			
			if (F_CLOSE_YN == "Y") {
			// 임시로 관리자에게 입력권한 부여 20130115  by 김선호 -> 홍수봉DL 요청 
	          if ( G_USER_ID <> '2018144' and G_USER_ID <> '2019116' and G_USER_ID <> '2018080' and
	               G_USER_ID <> '2020483' and G_USER_ID <> '2020564' and G_USER_ID <> '2020254'  ) {	
				  arr = [cal_zpyear.Text+"년 사업계획", "오픈", "입력"];   
				  gfn_showAlert("CW10004", arr); // "CW10004", "${}은(는) ${}되지 않아 ${} 할 수 없습니다."
				  gfn_SetFocus(cal_zpyear,"Y"); return false;
			   }
			} // CW00208 : "[${}]은/는 필수입력 입니다.확인바랍니다.")
			if (length(trim(cal_zpyear.Value))        ==0) { gfn_showAlert("CW00208","편성년도"); gfn_SetFocus(cal_zpyear         ,"Y"); return false; }     
			if (length(trim(cal_zpym.Value))          ==0) { gfn_showAlert("CW00208","계획년월"); gfn_SetFocus(cal_zpym           ,"Y"); return false; }
			if (length(trim(div_vbvg.cb_frvb.Value))  ==0) { gfn_showAlert("CW00208","부서"    ); gfn_SetFocus(div_vbvg.cb_frvb   ,"Y"); return false; }
			if (length(trim(div_vbvg.cb_frvg.Value))  ==0) { gfn_showAlert("CW00208","팀"      ); gfn_SetFocus(div_vbvg.cb_frvg   ,"Y"); return false; }

			if (length(trim(div_sman.ed_sman_cd.text))==0) { gfn_showAlert("CW00208","담당자"  ); gfn_SetFocus(div_sman.ed_sman_cd,"Y"); return false; 
			} 
			//else if (length(trim(div_sman.ed_sman_nm.text))==0) {
			else {
				if (fn_query_sman(trim(div_sman.ed_sman_cd.text))==false) return false; // 담당자코드에 해당하는 담당자명 조회하여 유효성 체크
			}
			
			nRow = fn_findRow(true, false, false);	// 한건씩만 저장해야 하므로 신규행은 한 건만 존재해야 함 
			if (nRow >= 0) {
				gfn_showAlert("CW10010");			// "CW10010", "이미 입력되어 있습니다."
				gfn_SetFocusGrid(grd_list, nRow, 0); return false;
			}
	
			nRow = fn_findRow(false, true, true);	// 기존에 변경이나 삭제로 선택한 행이 있는지 체크 

			if (nRow >= 0) {
				arr = ["입력","계속"];

				if (gfn_showConfirm("CI10001", arr) == false) {	// "CI10001", "변경된 자료가 존재합니다. \n${} 할 경우 기존에 변경된 정보가 모두 소실됩니다.\n\n{} 하시겠습니까?");
					gfn_SetFocusGrid(grd_list, nRow, 0); return false; // 행 이동하지 않기 
				} else {
					fn_recorverToOldDataset(nRow); // 기존 값으로 복원처리 
					return true;  				   // 행 이동하기
				}
			} break;   

		case "save":   	// 사업계획저장
		 
			if (F_CLOSE_YN == "Y") {
			// 임시로 관리자에게 입력권한 부여 20130115  by 김선호 -> 홍수봉DL 요청 
	          if ( G_USER_ID <> '2018144' and G_USER_ID <> '2019116' and G_USER_ID <> '2018080' and
	               G_USER_ID <> '2020483' and G_USER_ID <> '2020564' and G_USER_ID <> '2020254' ) {
				arr = [cal_zpyear.Text+"년 사업계획", "오픈", "저장"];   
				gfn_showAlert("CW10004", arr);	// "CW10004", "${}은(는) ${}되지 않아 ${} 할 수 없습니다."
				gfn_SetFocus(cal_zpyear,"Y"); return false;
				}
			}
			
			if (length(ds_list.GetColumn(ds_list.row, "FLAG"))==0) {
				gfn_showAlert("CW00006", "사업계획"); return false; // CW00006=${}에 변경된 정보가 없습니다.
			}
			if (div_detail.cal_deldat.Value < cal_zpym.Value) {
				arr = ['납기예정일','계획년월'];
				gfn_showAlert('CW10036',arr);	// CW10036=${}은 ${} 이후로 입력하세요.
			}
			
			if (length(trim(cal_zpyear.Value)) == 0) { gfn_showAlert("CW00208","편성년도"); gfn_SetFocus(cal_zpyear,"Y"); return false;	} // CW00208 : "[${}]은/는 필수입력 입니다.확인바랍니다.")
			if (length(trim(cal_zpym.Value))   == 0) { gfn_showAlert("CW00208","계획년월"); gfn_SetFocus(cal_zpym  ,"Y"); return false; }
	
			if (div_detail.cal_deldat.Value < cal_zpym.Value) {
				arr = ['납기예정일','계획년월'];
				gfn_showAlert('CW10036',arr);				// CW10036=${}은 ${} 이후로 입력하세요.
				div_detail.cal_deldat.SetFocus();
			}
			
			// 선택된 행 존재여부 체크
			// alert("ds_list.FindRow(CHK,1) : " + ds_list.FindRow("CHK",1)); alert("ds_list.GetColumn(CHK) : " + ds_list.GetColumn(0, "CHK"));  
			// if (ds_list.FindRow("CHK",1) < 0) { 
				// gfn_showAlert("CW00013"); //CW00013 : "처리할 자료를 먼저 선택해 주십시오."
				// return false; 
			// }
			//alert("ds_list.GetColumn(FLAG) : " + ds_list.GetColumn(ds_list.row, "FLAG"));
			
			if (ds_list.GetColumn(ds_list.row, "FLAG") == "I" ) { // 신규입력인 경우 필수입력 체크 // CW00208 : "[${}]은/는 필수입력 입니다.확인바랍니다.")

				if (length(trim(div_vbvg.cb_frvb.Value))  ==0) { gfn_showAlert("CW00208","부서"  ); gfn_SetFocus(div_vbvg.cb_frvb   ,"Y"); return false; }
				if (length(trim(div_vbvg.cb_frvg.Value))  ==0) { gfn_showAlert("CW00208","팀"    ); gfn_SetFocus(div_vbvg.cb_frvg   ,"Y"); return false; }
				if (length(trim(div_sman.ed_sman_cd.text))==0) { gfn_showAlert("CW00208","담당자");	gfn_SetFocus(div_sman.ed_sman_cd,"Y"); return false; }
			}
			
			if (ds_list.GetColumn(ds_list.row, "FLAG") == "I" || ds_list.GetColumn(ds_list.row, "FLAG") == "U") { // 변경항목 체크

				if(gfn_isChangeDs(ds_list_detail, false, "FLAG", "사업계획")== false && gfn_isChangeDs(ds_list, false, "FLAG", "사업계획")== false) {
					gfn_showAlert("CW00006", "사업계획"); return false; 
				}
				
				if (length(trim(div_detail.div_buyr.ed_buyr_cd.value))==0) { // 필수입력 체크
					gfn_showAlert("CW00208","거래선"); gfn_SetFocus(div_detail.div_buyr.ed_buyr_cd,"Y"); return false;
				}
				
				//2017.10.20 딜러가 사업계획 입력 시 대리점 필수 입력 체크 추가 by mj.Shin 
				if (left(trim(ds_list.GetColumn(ds_list.row, "ZKUNNR")), 1) == 'A' && length(trim(div_detail.div_lifn.ed_lifnr.value)) == 0) {
					gfn_showAlert("CW00208","대리점"); gfn_SetFocus(div_detail.div_buyr.ed_buyr_cd,"Y"); return false;
				}
				
				// else if (length(trim(div_detail.div_buyr.ed_buyr_nm.value))==0) {
					// gfn_showAlert("CW00208","거래선"); gfn_SetFocus(div_detail.div_buyr.ed_buyr_cd,"Y"); return false;
				// }
				if (length(trim(div_detail.ed_gsnam.Text))==0) { gfn_showAlert("CW00208","공사명"); gfn_SetFocus(div_detail.ed_gsnam,"Y"); return false; }
				if (length(trim(div_detail.cb_shangh.Value))==0) { gfn_showAlert("CW00208","국내/상해 구분"); gfn_SetFocus(div_detail.cb_shangh,"Y"); return false; }

				if (ds_list.GetColumn(ds_list.row, "VKBUR") <> "B500" && ds_list.GetColumn(ds_list.row, "VKBUR") <> "B600" &&
				    ds_list.GetColumn(ds_list.row, "VKBUR") <> "B700" && ds_list.GetColumn(ds_list.row, "VKBUR") <> "B900" && 
				    ds_list.GetColumn(ds_list.row, "VKBUR") <> "BA00" &&  ds_list.GetColumn(ds_list.row, "VKBUR") <> "BB00" )	
				{ // 해외영업부가 아닌 경우
					
					if (length(trim(div_detail.cb_region.value))==0) { gfn_showAlert("CW00208","설치지역"); gfn_SetFocus(div_detail.cb_region,"Y"); return false; }
				}
				if (length(trim(div_detail.cb_gtype.value))==0)	{ gfn_showAlert("CW00208","기종"      ); gfn_SetFocus(div_detail.cb_gtype,"Y"); return false; }
				if (length(trim(div_detail.cb_waerk.value))==0)	{ gfn_showAlert("CW00208","통화"      ); gfn_SetFocus(div_detail.cb_waerk,"Y"); return false; }
				if (length(trim(div_detail.med_sofoca.value))==0 || div_detail.med_sofoca.value==0)	{
					gfn_showAlert("CW00208","수주예상액"); gfn_SetFocus(div_detail.med_sofoca,"Y"); return false;
				}
				if (length(trim(div_detail.med_zfore.value))==0 || div_detail.med_zfore.value==0) {
					gfn_showAlert("CW00208","예상시행율"); gfn_SetFocus(div_detail.med_zfore,"Y"); return false;
				}

				if (length(trim(div_detail.cal_deldat.value))==0) { gfn_showAlert("CW00208","납기예정일"); gfn_SetFocus(div_detail.cal_deldat,"Y"); return false; }

				if (ds_list.GetColumn(ds_list.row, "ZPYM") > substr(ds_list.GetColumn(ds_list.row, "DELDAT"),0,6)) { // 계획년월(ZPYM)과 납기예정일(DELDAT)의 년월보다 크면 오류
					arr = ["납기예정일의 년월","계획년월"];
					gfn_showAlert("CW00007",arr);			// CW00007=[${}]은/는 [${}] 보다 같거나 이후 일자로 입력하여 주십시오.
					gfn_SetFocus(div_detail.cal_deldat,"Y"); return false;
				}

				ChgYn = gfn_GetDatasetChgYN(grd_list, ds_list.row, F_AUTO_COMPUTE_ARR, "Y");   // arr에 선언된 컬럼에 대해서만 변경여부 체크 (Y)
//				 alert("ChgYn : " + ChgYn);  alert("ds_list.GetRowType(ds_list.row) : " + ds_list.GetRowType(ds_list.row)); 

				if (ds_list.GetColumn(ds_list.row, "FLAG") == "U" && ChgYn == "N" )	{ // 사업계획변경(update)이고 수주예상액 변경이 아닌 경우(ChgYn == "N")

					// 수주예상액(sofoca) 대비 매출(sa_tot), 청구(rq_tot), 수금(ys_tot) 합계 체크
					var sofoca = ds_list.GetColumn(ds_list.row, "SOFOCA") ;  // 수주예상액 

					var sa_tot = replace(grd_list_detail.GetCellText("Body",0,1),",","");
					var rq_tot = replace(grd_list_detail.GetCellText("Body",1,1),",","");
					var ys_tot = replace(grd_list_detail.GetCellText("Body",2,1),",","");
					
//					var sa_tot = parseInt(replace(grd_list_detail.GetCellText("Body",0,1),",",""));
//					var rq_tot = parseInt(replace(grd_list_detail.GetCellText("Body",1,1),",",""));
//					var ys_tot = parseInt(replace(grd_list_detail.GetCellText("Body",2,1),",",""));

					if (sa_tot > 0 && sa_tot != sofoca)	{
						arr = [ grd_list_detail.GetCellText("Body",0,0), "합계금액(" + sa_tot + ")", "수주예상액(" + sofoca + ")"];
						gfn_showAlert("CW10011",arr); 			//"CW10011", "${}의 [${}]은 [${}]과 동일해야 합니다." 
						gfn_SetFocusGrid(grd_list_detail, 0, 1); return false;
					}
					if (rq_tot > 0 && rq_tot != sofoca)	{
						arr = [ grd_list_detail.GetCellText("Body",1,0), "합계금액(" + rq_tot + ")", "수주예상액(" + sofoca + ")"];
						gfn_showAlert("CW10011",arr);  			//"CW10011", "${}의 [${}]은 [${}]과 동일해야 합니다." 
						gfn_SetFocusGrid(grd_list_detail, 1, 1); return false;
					}
					if (ys_tot > 0 && ys_tot != sofoca)	{
						arr = [ grd_list_detail.GetCellText("Body",2,0), "합계금액(" + ys_tot + ")", "수주예상액(" + sofoca + ")"];
						gfn_showAlert("CW10011",arr);  			//"CW10011", "${}의 [${}]은 [${}]과 동일해야 합니다." 
						gfn_SetFocusGrid(grd_list_detail, 2, 1); return false;
					}
				} 
			} break;

		case "delete": // 사업계획삭제 

			if (ds_list.row < 0 || ds_list.rowCount() < 1) { // 조회된 행 존재여부 체크
				gfn_showAlert("CW00010"); return false; // CW00010 : "데이터가 없습니다."
			}   
			if (F_CLOSE_YN == "Y") {
			// 임시로 관리자에게 입력권한 부여 20130115  by 김선호 -> 홍수봉DL 요청 
	          if ( G_USER_ID <> '2018144' and G_USER_ID <> '2019116' and G_USER_ID <> '2018080' and
	               G_USER_ID <> '2020483' and G_USER_ID <> '2020564' and G_USER_ID <> '2020254' ) {
				arr = [cal_zpyear.Text+"년 사업계획", "오픈", "삭제"];  
				gfn_showAlert("CW10004", arr); 			// "CW10004", "${}은(는) ${}되지 않아 ${} 할 수 없습니다."
				gfn_SetFocus(cal_zpyear,"Y"); return false;
				}
			}
			nRow = fn_findRow(true, true, true);		// 기존에 입력,변경,삭제로 선택한 행이 있는지 체크

			if (nRow >= 0) {
				var arr = ["삭제","계속"];
				if (gfn_showConfirm("CI10001", arr) == false) { // "CI10001", "변경된 자료가 존재합니다. \n${} 할 경우 기존에 변경된 정보가 모두 소실됩니다.\n\n{} 하시겠습니까?");
					gfn_SetFocusGrid(grd_list, nRow, 0); return false; // 행 이동하지 않기

				} else {
					if (ds_list.GetRowType(ds_list.row) == "insert") {
						fn_recorverToOldDataset(nRow); // 기존 값으로 복원처리 
						return false;		// 삭제 플래그 처리 제외하기 위함
					} else {
						fn_recorverToOldDataset(nRow); // 기존 값으로 복원처리 
						return true;		// 삭제 플래그 처리하기 위함
					}
				}
			} break;

		case "close":   	// 사업계획 화면 닫기
			  
			nRow = fn_findRow(true, true, true); // 기존에 입력,변경,삭제로 선택한 행이 있는지 체크

			if (nRow >= 0) {
				var arr = ["닫기","계속"];
				if (gfn_showConfirm("CI10001", arr) == false) { // "CI10001", "변경된 자료가 존재합니다. \n${} 할 경우 기존에 변경된 정보가 모두 소실됩니다.\n\n{} 하시겠습니까?");
					return false;
				}   
			} break;
		default: break; 
	}
	return true;
}

/********************************************************************************
* 기      능   : 새로고침
********************************************************************************/
function fn_refresh() {
	//fn_init_form();	// 폼초기화
}  

function fn_init_form() { // 폼 초기화 

	gfn_clearMsgBar();   	// 메세지바 초기화
	
	// 항목 위치 재조정
	grd_list.top 			= 56;
	grd_list.height 		= 275; 
	div_detail.top 			= grd_list.top + grd_list.height + 5;
	div_detail.height 		= 112;
	grd_list_detail.top 	= div_detail.top + div_detail.height -1;
	grd_list_detail.height 	= 98; 
	
	// 폼변수 초기화 
	F_ZBPNNR		= "";								// 사업계획번호 
	F_USER_GROUP_B  = G_USER_GROUP_B;  					// 임시 추가
	F_SYSDATE   	= substr(gfn_getCurrDate(),0,8); 	// 현재년월일(8자리) 
	
	div_detail.ed_gtype_info.Text = "";	// 기종정보 초기화
	
	// 데이타셋 초기화
	ds_list_opendtm.ClearData(); 	// 검색결과 마감일자 데이타셋 초기화   
	ds_list.ClearData(); 			// 검색결과 그리드 데이타셋 초기화   
	ds_detail.ClearData(); 			// 검색결과 상세  데이타셋 초기화   
	ds_list_detail.ClearData(); 	// 검색결과 매출/청구/수금목록  데이타셋 초기화   
	
	// 부서/팀 검색조건 리사이징 및 스타일 적용
	div_vbvg.fn_rsetSize(280, 140, 140);	 									// 디비전사이즈, 부서콤보 사이즈, 팀콤보 사이즈
	div_detail.div_vbvg.cb_frvb.Style = "sty_ipt_search_ind";					// 거래선코드 스타일 SET
	div_detail.div_vbvg.cb_frvg.Style = "sty_ipt_search_ind";					// 거래선명 스타일 SET
	
	// 담당자코드  스타일변경
	div_detail.div_sman.ed_sman_cd.Style = "sty_ipt_search_ind";				// 거래선코드 스타일 SET
 	
	// 거래선 입력항목 초기화
	div_detail.div_buyr.fn_setShowBuyrNM("Y");									// 거래선명 항목을 보여준다
	div_detail.div_buyr.fn_rsetSize(212, 62, 130);								// 거래선코드, 거래선명 사이즈 조정
	gfn_BindColumn(div_detail.div_buyr.ed_buyr_cd, "ds_list", "KUNNR"		); 	// 거래선코드 데이타셋 바인드
	gfn_BindColumn(div_detail.div_buyr.ed_buyr_nm, "ds_list", "KUNNR_NM"	); 	// 거래선명 데이타셋 바인드
	div_detail.div_buyr.ed_buyr_cd.Style = "sty_ipt_form_ind";					// 거래선코드 스타일 SET
	div_detail.div_buyr.ed_buyr_nm.Style = "sty_ipt_form_ind";					// 거래선명 스타일 SET
	div_detail.div_buyr.ed_buyr_nm.enable = false;								// 거래선명 수정불가
	 
	// 대리점(협력업체) 입력항목 초기화
	div_detail.div_lifn.fn_setShowLifnrNM("Y");									// 대리점명 항목을 보여준다
	div_detail.div_lifn.fn_rsetSize(314, 77, 217);								// 대리점코드, 대리점명 사이즈 조정
	gfn_BindColumn(div_detail.div_lifn.ed_lifnr, "ds_list", "ZAGNT"			); 	// 대리점코드 데이타셋 바인드
	gfn_BindColumn(div_detail.div_lifn.ed_name1, "ds_list", "ZAGNT_NM"		); 	// 대리점명 데이타셋 바인드
	div_detail.div_lifn.ed_lifnr.Style = "sty_ipt_form";						// 대리점코드 스타일 SET
	div_detail.div_lifn.ed_name1.Style = "sty_ipt_form";						// 대리점명 스타일 SET
	div_detail.div_lifn.ed_name1.enable = false;								// 대리점명 수정불가
	
	fn_query_gtype(); 	// 기종정보 목록 조회 (기종코드, 제품명, 판매문서유형, 자재번호)

	var zpyear = parseInt(substr(F_SYSDATE,0,4))+1; // 익년
	cal_zpyear.Value = zpyear + "0101"; 		// 편성년도 = 익년도
	cal_zpym.Value 	 = zpyear + "0101"; 		// 계획년월 = 익년월 
	
	// dataset 목록 설정
	ds_obj_list.ClearData();
	ds_obj_list.AddRow();
	ds_obj_list.SetColumn(0, "DS_VB"		, "ds_list_vb");  	// 그리드 부서 출력 데이타셋
	ds_obj_list.SetColumn(0, "DS_VG"		, "ds_list_vg");	// 그리드 팀콤보 출력 데이타셋
	ds_obj_list.SetColumn(0, "DS_COND_VG"	, "ds_cond_vg");	// 그리드 팀콤보출력 조건 데이타셋
	ds_obj_list.ApplyChange();
	
	div_vbvg.Border 	= "none";  	// 부서 div border 삭제
	div_sman.Border 	= "none";	// 담당자_FR div border 삭제
	div_sman.ed_sman_nm.Visible = true;
	div_sman.ed_sman_nm.Width   = 80;
	div_sman.ed_sman_nm.Enable  = false;
	
	// 코딩 시 필요한 그리드 컬럼 인덱스	   
	F_COLNUM_CHK 		= gfn_getColIdx(grd_list,"CHK"		);  // 선택여부  
	F_COLNUM_FLAG 		= gfn_getColIdx(grd_list,"FLAG"		);  // 변경구분   
	F_COLNUM_ZBPNNR 	= gfn_getColIdx(grd_list,"ZBPNNR"	);  // 사업계획번호   
	F_COLNUM_ZPYEAR 	= gfn_getColIdx(grd_list,"ZPYEAR"	);  // 편성년도  
	F_COLNUM_ZPYM 		= gfn_getColIdx(grd_list,"ZPYM"		);  // 계획년월  
	F_COLNUM_SPART 		= gfn_getColIdx(grd_list,"SPART"	);  // 제품군  
	F_COLNUM_VKBUR 		= gfn_getColIdx(grd_list,"VKBUR"	);  // 사업장    
	F_COLNUM_VKGRP		= gfn_getColIdx(grd_list,"VKGRP"	);  // 영업그룹    
	F_COLNUM_ZKUNNR		= gfn_getColIdx(grd_list,"ZKUNNR"	);  // 담당자
	F_COLNUM_ZKUNNR_NM	= gfn_getColIdx(grd_list,"ZKUNNR_NM");  // 담당자명
	F_COLNUM_KUNNR		= gfn_getColIdx(grd_list,"KUNNR"	);  // 거래선  
	F_COLNUM_KUNNR_NM	= gfn_getColIdx(grd_list,"KUNNR_NM"	);  // 거래선명   
	F_COLNUM_GSNAM      = gfn_getColIdx(grd_list,"GSNAM"	);	// 공사명
	F_COLNUM_REGION     = gfn_getColIdx(grd_list,"REGION"	);	// 설치지역
	F_COLNUM_GTYPE      = gfn_getColIdx(grd_list,"GTYPE"	);	// 기종
	F_COLNUM_TYPE1      = gfn_getColIdx(grd_list,"TYPE1"	);	// TYPE1 (인승)
	F_COLNUM_TYPE2      = gfn_getColIdx(grd_list,"TYPE2"	);	// TYPE2 (속도)
	F_COLNUM_TYPE3      = gfn_getColIdx(grd_list,"TYPE3"	);	// TYPE3 (층수)
	F_COLNUM_ZNUMBER    = gfn_getColIdx(grd_list,"ZNUMBER"	);	// 대수
	F_COLNUM_ZDELI      = gfn_getColIdx(grd_list,"ZDELI"	);	// 단납기구분
	F_COLNUM_SHANGH     = gfn_getColIdx(grd_list,"SHANGH"	);	// 국내/상해구분
	F_COLNUM_ZINTER     = gfn_getColIdx(grd_list,"ZINTER"	);	// 중계무역구분
	F_COLNUM_SOFOCA     = gfn_getColIdx(grd_list,"SOFOCA"	);	// 수주예상액
	F_COLNUM_ZFORE      = gfn_getColIdx(grd_list,"ZFORE"	);	// 예상시행율
	F_COLNUM_WAERK      = gfn_getColIdx(grd_list,"WAERK"	);	// 통화
	F_COLNUM_DELDAT     = gfn_getColIdx(grd_list,"DELDAT"	);	// 납기예정일
	F_COLNUM_ZRMK       = gfn_getColIdx(grd_list,"ZRMK"		);	// 비고 
	F_COLNUM_ZAGNT      = gfn_getColIdx(grd_list,"ZAGNT"	);	// 대리점
	
	// 그리드 FIX
	gfn_grid_fix(grd_list			, F_COLNUM_ZBPNNR);			// 사업계획번호에서 fix
	gfn_grid_fix(grd_list_detail	, F_COLNUM_TOT1);			// 합계에서 fix 
	grd_list.SetColProp(F_COLNUM_ZPYEAR , "Width", 0 );			// 편성년도 안보이게
	grd_list.SetColProp(F_COLNUM_ZPYM	, "Width", 0 );			// 계획년월 안보이게 
	
	// ufn_enableBtn("input", false); ufn_enableBtn("delete", false); ufn_enableBtn("save",false); ufn_enableBtn("reset",false); // 버튼 제어(입력, 삭제, 저장, 리셋)
}

// 제품군목록 조회 CALL BACK함수
function fn_afterQuery_spart(errCode, errMsg) {
	//gfn_InsertRowCombo(ds_spart_cd, 0, "Y", "N", "Y"); // 제품군목록 전체 행 추가
	//cb_spart.index = 0; 
}

function grd_list_OnHeadClick(obj,nCell,nX,nY,nPivotIndex) { // 그리드 헤더 클릭 시

	if      ( nCell == 0 ) gfn_selectGridCol(obj); 
	else if ( nCell > 1  ) gfn_sortGrid(obj, nCell);
}

function grd_list_OnKeyDown(obj,nChar,bShift,bCtrl,bAlt,nLLParam,nHLParam) { // 그리드에서 키 입력 시

	var ds = object(obj.BindDataset);  
	
	if (nChar==13) { // 엔터키
		ds.row = ds.row + 1;  // 다음 행으로 이동
	} else if (nChar==27)	{ // Esc 키이면 변경전 자료로 되돌린다. 
		var nCol 	= obj.GetCellPos();
		gfn_SetOrgColumn(obj, ds.row, nCol);  
	} else {
		gfn_GrdCellCopyPasteReset(obj, ds, bCtrl, nChar);
	} 
} 

function fn_delete() { // 삭제 버튼 클릭 시

	if (fn_valid_chk("delete") == false) return false;	// 조건 항목오류검증
	
	// if (!gfn_showConfirm("CI00015","사업계획")) return;
	// Grid 현재행 삭제 처리  (FLAG:D), 삭제(신규행), 삭제FLAG처리(기등록자료)  
	gfn_deleteGridRow( grd_list, ds_list.row, "FLAG" );
	ds_list_OnRowPosChanged(ds_list, -1, ds_list.row); 
} 

function fn_query_grid_vb() { // 그리드 부서코드목록 조회

	ds_list_vb.Fireevent = false; // 부서 콤보목록 데이타셋 이벤트 비활성화
	
	// 서비스 호출 
	ds_list_vb.ClearData(); 
	ds_error.ClearData(); //trace(ds_obj_list.SaveXML()); 
	nsfRequest("query", "combo/gridVb", "ds_obj_list=ds_obj_list ds_list_vb=ds_list_vb", "ds_list_vb=ds_list_vb ds_error=ds_error", "", "fn_afterQuery_grid_vb");
}

function fn_query_grid_vg() { // 그리드 팀코드목록 조회

	// 팀 콤보목록 조회   
	ds_cond_vg.ClearData();
	ds_cond_vg.AddRow();  
	ds_cond_vg.SetColumn(0,"VB", "");  // 부서코드 null 이면 전체 팀목록 조회
	//trace(ds_cond_vg.SaveXML());
		
	// 서비스 호출 (팀목록조회)  
	ds_list_vg.ClearData();
	ds_error.ClearData();
	nsfRequest("query"												// srvId
				, "combo/gridVg"									// url
				, "ds_obj_list=ds_obj_list ds_cond_vg=ds_cond_vg ds_list_vg=ds_list_vg"	// inDsList
				, "ds_list_vg=ds_list_vg ds_error=ds_error"			// outDsList
				, ""												// strParam
				, ""											// CallBackFunc
				);
}  

// 담당자코드로 담당자명 조회, pSmanCd : 담당자코드
function fn_query_sman(pSmanCd) { 
	
	gfn_clearMsgBar();

	// 조건설정 
	ds_cond_sman.ClearData(); 
	ds_cond_sman.AddRow();
	ds_cond_sman.SetColumn(ds_cond_sman.row, "sman_cd", pSmanCd);
	
	// 서비스호출
	ds_list_sman.ClearData(); 
	ds_error.ClearData();
	fn_createWait("",this);     // 처리중입니다. 메시지 처리
	http.sync = true;			// 반드시 sync call 해야 함
	nsfRequest("query"														// srvId
				, "com0030/find"											// url
				, "ds_cond_sman=ds_cond_sman ds_list_sman=ds_list_sman"		// inDsList
				, "ds_list_sman=ds_list_sman ds_error=ds_error"				// outDsList
				, ""														// strParam
				, "");														// CallBackFunc
     
	http.sync = false;			// 반드시 sync call 해제 해야 함
    fn_destroyWait(); 			// 처리중입니다. 메시지 처리 해제
	
	if(ds_error.rowcount() > 0) {    
		gfn_showMsgBar(ds_error.GetColumn(0,"ERRMSG"));   
		return false;
	} else { 
		if (ds_list_sman.RowCount() == 0) { // 자료가 없는 경우
		
			var arr = ["담당자ID", pSmanCd];
			gfn_showAlert("CW10001", arr); // "CW10001", "[${}:${}] 해당 정보를 찾을 수 없습니다.\n확인하여 주십시오."
			return false;
		}
	}
	return true;
}  
 
function fn_query_zagnt(pZagnt) { // 대리점코드로 대리점명 조회
	
//	trace("fn_query_zagnt.pZagnt : " + pZagnt);
	
	if (length(pZagnt) == 0 ) return;  	// 대리점코드가 없는 경우 조회하지 않는다.
	
	ds_zagnt.ClearData();
	ds_zagnt.AddRow();  
	ds_zagnt.SetColumn(0, "ZAGNT", pZagnt);
		
	ds_error.ClearData(); 
	nsfRequest("query", "sbp0010/find_zagnt", "ds_zagnt=ds_zagnt", "ds_zagnt=ds_zagnt ds_error=ds_error", "", "fn_afterQuery_zagnt");	// 서비스 호출 (대리점명조회) 
}   
				
function fn_query_gtype() { //  실기종 정보 
	
 	// 기종- RYPE  시작 
	ds_cond_gtype.DeleteAll();
	ds_cond_gtype.AddRow();
	if (G_SAP_USER_VBCD == null || G_SAP_USER_VBCD == '') {
		ds_cond_gtype.SetColumn(0, "VKBUR", '');
	} else {
		ds_cond_gtype.SetColumn(0, "VKBUR", G_SAP_USER_VBCD);
	}
	if (G_SAP_USER_VGCD == null || G_SAP_USER_VGCD == '') {
		ds_cond_gtype.SetColumn(0, "VKGRP", '');
	} else {
		ds_cond_gtype.SetColumn(0, "VKGRP", G_SAP_USER_VGCD);
	}
	if (G_SAP_USER_ID == null || G_SAP_USER_ID == '') {
		ds_cond_gtype.SetColumn(0, "ZKUNNR", '');
	} else {
		ds_cond_gtype.SetColumn(0, "ZKUNNR", G_SAP_USER_ID);
	}
//	trace("ds_cond_gtype" + ds_cond_gtype.savexml());
	gfn_clearMsgBar();   

	  
	// 서비스호출
	//fn_createWait("",this);     // 처리중입니다. 메시지 처리
	ds_list_gtype.ClearData();
	ds_error.ClearData(); 
	nsfRequest("query"												         // srvId
				, "sbp0010/find_rgtype"								         // url
				, "ds_list_gtype=ds_list_gtype ds_cond_gtype=ds_cond_gtype"	 // inDsList
				, "ds_list_gtype=ds_list_gtype ds_error=ds_error"	         // outDsList
				, ""												         // strParam
				, "fn_afterQuery_gtype");							         // CallBackFunc
}

/********************************************************************************
* 기      능   : 기종목록 조회 Callback  
********************************************************************************/ 
function fn_afterQuery_gtype(errCode, errMsg) {

	//fn_destroyWait(); // trace("실기종 " + ds_list_gtype.SaveXML());
	if(ds_error.rowcount() > 0) {    
		gfn_showMsgBar(ds_error.GetColumn(0,"ERRMSG"));    
	}
}   

/********************************************************************************
* 기      능   : 기종목록에서 특정 기종정보 조회
********************************************************************************/ 
function fn_getGtypeInfo(pGType) {

	// 기종정보 GET
	var nRow  = ds_list_gtype.FindRow  ("gtype",pGType);
	var rtype = ds_list_gtype.GetColumn(nRow, "gtype");		// 실기종
	var spart = ds_list_gtype.GetColumn(nRow, "spart");		// 제품군
	var auart = ds_list_gtype.GetColumn(nRow, "auart");		// 판매문서유형
	var matnr = ds_list_gtype.GetColumn(nRow, "matnr");		// 자재번호 
	var zkunnr = ds_list.GetColumn(ds_list.row, "ZKUNNR");	//담당자코드 
	
	//대리점코드입력시 jss
	if(auart == "ZJ01" || auart == "ZN01" || auart == "ZS01" || auart == "ZS02" || auart == "ZS02" || auart == "ZS02" ){
		if(length(trim(div_detail.div_lifn.ed_lifnr.value)) > 0 ){
			auart = left(auart,3) + '2';
		}else{
			auart = left(auart,3) + '1';
		}
	}
	
	//2017.10.20 딜러가 사업계획 입력 시 오더유형 조정 by mj.Shin 
	if ( left(zkunnr, 1) == 'A' && right(auart, 1) <> '2' ) {
		auart = left(auart,3) + '2';	
	}
	
	// 찾아온 정보로 상세 데이타셋 SET
	ds_list.SetColumn(ds_list.row, "RTYPE", rtype);		// 실기종
	ds_list.SetColumn(ds_list.row, "SPART", spart);		// 제품군
	ds_list.SetColumn(ds_list.row, "AUART", auart);		// 판매문서유형
	ds_list.SetColumn(ds_list.row, "MATNR", matnr);		// 자재번호
	
	// 찾아온 정보로 기종정보 DISPLAY
	div_detail.cb_gtype.ToolTipText = "제품군       ["+gfn_GetListCodeName(F_FORM_ID, GC_CDGB_SPART, spart)+"]\n" + "판매문서유형 ["+auart+"]\n" + "자재번호     ["+matnr+"]";
	div_detail.ed_gtype_info.Text =   "[" + gfn_GetListCodeName(F_FORM_ID, GC_CDGB_SPART, spart) +"] " + "[" + auart + "] " + "[" + matnr + "]";

    // 인승, 속도 , 층수 
	if (spart == '30') {
		div_detail.ed_type1.Enable = false;
		div_detail.ed_type2.Enable = false;
		div_detail.ed_type3.Enable = false;
		
	} else {
		div_detail.ed_type1.Enable = true;
		div_detail.ed_type2.Enable = true;
		div_detail.ed_type3.Enable = true;
	}
	
    // 국내 상행 중계무역, 단납기. 
	if (spart == '10') {
		div_detail.cb_shangh.Enable  = true;
		div_detail.chk_zdeli.Enable  = true;
	} else {
		div_detail.cb_shangh.Enable  = false;
		div_detail.chk_zdeli.Enable  = false;
	}	

	if (spart == '20') {
		div_detail.Static4.Text = '사양 ';
		div_detail.Static5.Text = '단수 ';
		div_detail.Static6.Text = '팔렛트 수 ';
	} else if (spart == '30') {
		div_detail.Static4.Text = 'TYPE1 ';
		div_detail.Static5.Text = 'TYPE2 ';
		div_detail.Static6.Text = 'TYPE3 ';
	} else if (spart == '40') {
		div_detail.Static4.Text = '사양 ';
		div_detail.Static5.Text = '량/도어수 ';
		div_detail.Static6.Text = '역사수 ';
	} else if (matnr == "L-1000" || matnr == "L-2000") {
		div_detail.Static4.Text = '인승 ';
		div_detail.Static5.Text = '속도 ';
		div_detail.Static6.Text = '층수 ';
	} else if (matnr == "S-1000" || matnr == "W-1000") {
		div_detail.Static4.Text = '폭 ';
		div_detail.Static5.Text = '각도 ';
		div_detail.Static6.Text = '높이 ';
	} else {
		div_detail.Static4.Text = 'TYPE1 ';
		div_detail.Static5.Text = 'TYPE2 ';
		div_detail.Static6.Text = 'TYPE3 ';
	}
}   

function fn_query_opendtm() { // 계획년월의 오픈일자  조회 
	//F_CLOSE_YN = "Y";  // 마감여부 초기화	
	
	// 조건 설정
	ds_cond_opendtm.ClearData(); 
	ds_cond_opendtm.AddRow();
	ds_cond_opendtm.SetColumn(ds_cond_opendtm.row, "ZPYEAR"	, replace(cal_zpyear.text,".",""));  // 편성년도 
		
	// 서비스 호출 (계획년월의 오픈일시 조회)
	fn_createWait("",this);     // 처리중입니다. 메시지 처리
	ds_list_opendtm.ClearData();	
	ds_error.ClearData();
	nsfRequest("query"									// srvId
				, "sbp0010/find_opendtm"					// url
				, "ds_cond_opendtm=ds_cond_opendtm ds_list_opendtm=ds_list_opendtm"	// inDsList
				, "ds_list_opendtm=ds_list_opendtm ds_error=ds_error"				// outDsList
				, ""									// strParam
				, "fn_afterQuery_opendtm"				// CallBackFunc
				);
}

function fn_afterQuery_opendtm(errCode, errMsg) { // 계획년월의 오픈일시 조회 CALL BACK
	TRACE("eunha debugging");
	TRACE(ds_list_opendtm.RowCount());
	fn_destroyWait(); // trace(ds_error.SaveXML()); // trace(ds_list_opendtm.SaveXML()); 

	if(ds_error.RowCount() > 0) {	// 조회실패
		gfn_showMsgBar(ds_error.GetColumn(0,"ERRMSG"));   
	} else {
		if (ds_list_opendtm.RowCount() > 0) {		// 조회된 자료가 있을 경우 
			//F_CLOSE_YN = "N"; // 마감여부
			ed_opendtm.Text = "사업계획 오픈 : Y";
			grd_list.SetFocus();  		// 그리드 첫번째 행에 포커스 위치시킨다.
			gfn_showMsg("CI00001");  	// CI00001 : "조회를 완료했습니다.

		} else {
			ed_opendtm.Text = "사업계획 오픈 : N";	 
			//F_CLOSE_YN = "Y";	// 마감여부  
			gfn_showMsg("CW00010"); 	// CW00010 : "데이터가 없습니다."
		}
	}
} 

function cal_zpyear_OnChanged(obj,strOldText,strNewText) { // 편성년월 변경 시
	
	if ( length(strNewText) >= 4 ) fn_query_opendtm();	// 계획년도의 마감일자 조회	//trace("trNewText : " + strNewText);
}

function ds_list_OnRowPosChanged(obj,nOldRow,nRow) {

	if (ds_list.RowCount()==0) return;
	if (ds_list.row<0) return;

	ds_list_detail.ClearData(); // 매출, 청구, 수금 데이타 초지화
	fn_style_set(nRow); // 부서별 style 적용
	
	// 기종 콤보 정보 SETTING
	var spart = ds_list.GetColumn(ds_list.row, "spart");	// 제품군
	var auart = ds_list.GetColumn(ds_list.row, "auart");	// 판매문서유형
	var matnr = ds_list.GetColumn(ds_list.row, "matnr");	// 자재번호 
	
	div_detail.cb_gtype.ToolTipText =  "제품군       ["	+gfn_GetListCodeName(F_FORM_ID, GC_CDGB_SPART, spart)+"]\n" + "판매문서유형 [" +auart+"]\n" + "자재번호     ["+matnr+"]"; 
	div_detail.ed_gtype_info.Text =   "[" + gfn_GetListCodeName(F_FORM_ID, GC_CDGB_SPART, spart) +"] " + "[" + auart + "] " + "[" + matnr + "]";
	
	//대리점 입력 활성화 (FALSE : 대리점, 해외사용자, TRUE : 일반 사용자)
	div_detail_div_lifn_Enable(F_USER_GROUP_B, ds_list.GetColumn(ds_list.row, "VKBUR") );	                                
	
	fn_query_bill(); // 매출/청구/수금 상세조회 
}

function fn_grid_header_set() { // 기준년월에 따른 그리드 헤더(계획년월) 재설정// YYYY.MM

	var bef_month = replace(cal_zpym.Text,".","");  // 편성년월
	var aft_month = ""; // trace("fn_grid_header_set.bef_month : " + bef_month);

	ds_yearm.ClearData();
	
	for (var i=0; i<30; i++) {	// 편성년도의 01월부터 30개월 생성
		
		aft_month = substr(AddMonth(bef_month+"01", i),0,6); // 한달 씩 더한다. 
		
		//F_COLNUM_YEAYM 컬럼에 기준년월계획이 위치함
		grd_list_detail.SetCellProp("Head", parseInt(F_COLNUM_YEAYM) + i, "Text", substr(aft_month,0,4)+"."+substr(aft_month,4,2)+"");  // YYYY.MM

		ds_yearm.AddRow();		// 예상년월 Dataset에 Add
		ds_yearm.SetColumn(i, "YEARM", aft_month);
	}
}

/********************************************************************************
* 기      능   : 입력 : 맨뒤에 행추가하고 상세정보 항목 초기화
********************************************************************************/
function fn_input() {
        
	if (fn_valid_chk("input") == false)  return;  	// 행추가 조건 항목 오류검증
	
	var newRow = gfn_addGridRow(grd_list, -1, "FLAG"); // 행추가 (맨뒤에 추가됨:FLAG(I)) // 추가된 행번호를 받아옴

	/// 새로 추가된 행에 기본값을 설정한다.   
	ds_list.Fireevent = false;
	ds_list.SetColumn(newRow, "NEW_YN"  	, "Y");											// 신규여부
	ds_list.SetColumn(newRow, "MANDT"	    , G_MANDT);
	ds_list.SetColumn(newRow, "ZPYEAR"		, replace(cal_zpyear.text,".",""));				// 편성년도 : 조건년도
	ds_list.SetColumn(newRow, "ZPYM"		, replace(cal_zpym.text,".",""));	 			// 제품군	:조건 제품군
	ds_list.SetColumn(newRow, "VKBUR"		, trim(div_vbvg.cb_frvb.Value));   				// 부서		:선택한 부서를 기본값으로 올려준다.
	ds_list.SetColumn(newRow, "VKGRP"		, trim(div_vbvg.cb_frvg.Value));  				// 팀       : 선택한 팀을 기본값으로 올려준다.
	ds_list.SetColumn(newRow, "ZKUNNR"		, trim(div_sman.ed_sman_cd.text));				// 담당자코드 : 선택한 담당자코드를 기본값으로 올려준다.
	ds_list.SetColumn(newRow, "ZKUNNR_NM"	, ds_list_sman.GetColumn(ds_list_sman.row, "SMAN_NM")); 
	if (div_vbvg.cb_frvb.Value == "B500" || div_vbvg.cb_frvb.Value == "B600" || 
		div_vbvg.cb_frvb.Value == "B700" || div_vbvg.cb_frvb.Value == "B900" || 
	    div_vbvg.cb_frvb.Value == "BA00" || div_vbvg.cb_frvb.Value == "BB00")
	{
		ds_list.SetColumn(newRow, "WAERK"		, "USD"); 
	}else{
		ds_list.SetColumn(newRow, "WAERK"		, "KRW"); 
	}
	

	if (G_VEND_WGBN == 'A' || G_VEND_WGBN == 'B' || G_VEND_WGBN == 'C' || G_VEND_WGBN == 'D' || G_VEND_WGBN == 'E') {
		ds_list.SetColumn(newRow, "ZAGNT"		, G_VEND_CODE); 	// 대리점코드
		ds_list.SetColumn(newRow, "ZAGNT_NM"	, G_VEND_NAME); 	// 대리점명 
	} else {
		ds_list.SetColumn(newRow, "ZAGNT"		, ' '); 	// 대리점코드
		ds_list.SetColumn(newRow, "ZAGNT_NM"	, ' '); 	// 대리점명 
	}
	
	//대리점 입력 활성화 (FALSE : 대리점, 해외사용자, TRUE : 일반 사용자)
	div_detail_div_lifn_Enable(F_USER_GROUP_B, ds_list.GetColumn(ds_list.row, "VKBUR") );
	
	ds_list.Fireevent = true;																		 
	   
	// 상세정보 SET
	ds_detail.ClearData();
	ds_list_detail.ClearData();
	
	// 신규 인 경우 매출/청구/수금 정보 입력 불가하도록 주석처리, 저장 시 자동산출 RFC FUNCTION호출하여 결과 데이타로 자동 등록로직 추가
	//fn_setDetailInfo();
	
	div_detail.div_buyr.ed_buyr_cd.SetFocus(); 	// 거래선 코드에 강제 focus처리
	fn_style_set(newRow);	// 부서별 style 적용
}

/********************************************************************************
* 기      능   : 기종콤보 선택 변경 시
********************************************************************************/
function div_detail_cb_gtype_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex) {
	
	if (ds_list.GetColumn(ds_list.row, "VKBUR") == "B500" || ds_list.GetColumn(ds_list.row, "VKBUR") == "B600" ||
	    ds_list.GetColumn(ds_list.row, "VKBUR") == "B700" || ds_list.GetColumn(ds_list.row, "VKBUR") == "B900" ||
	    ds_list.GetColumn(ds_list.row, "VKBUR") == "BA00" || ds_list.GetColumn(ds_list.row, "VKBUR") == "BB00" )
	 {	// 해외영업부인 경우

		if (IndexOf(strCode, "(중계)") >= 0) { 	// 기종코드 like (중계) 인 경우 기본값으로 설정하고 수정불가 처리
			div_detail.cb_shangh.Value   = "상해";
			div_detail.chk_zinter.Value  = "Y";
			div_detail.cb_shangh.Enable  = false; // div_detail.chk_zinter.Enable = false;
		} else {
			div_detail.cb_shangh.Enable  = true;  // div_detail.chk_zinter.Enable = true;
		}
	}
	fn_getGtypeInfo(strCode); // 기종에 해당하는 기종정보(제품군,판매문서유형,재재번호)  조회하여 화면에 DISPLAY
}

function fn_query_dd07t(pDomainId, pDs) {  // 공통코드 조회

	ds_cond_dd07t.ClearData();		// 데이타셋 초기화
	pDs.ClearData();
	
	// 데이타셋 설정
	ds_cond_dd07t.AddRow();
	ds_cond_dd07t.SetColumn(ds_cond_dd07t.row, "DOMNAME"  , pDomainId);  
	ds_cond_dd07t.SetColumn(ds_cond_dd07t.row, "CONCAT_YN", "N");  
	//trace(ds_cond_dd07t.SaveXML()); trace("fn_afterQuery_dd07t_DomainId : " + "fn_afterQuery_dd07t_"+pDomainId); 
	
	// 서비스 호출
	nsfRequest("query", "combo/comboDD07T"	, "ds_cond_dd07t=ds_cond_dd07t " + pDs.ID+"="+pDs.ID
											, pDs.ID+"="+pDs.ID +" ds_error_dd07t=ds_error_dd07t"
											, "", "fn_afterQuery_dd07t_"+pDomainId);
}

function fn_afterQuery_dd07t_ZGTYPE(errCode, errMsg) { // 기종 조회 CALL BACK

	gfn_InsertRowCombo(ds_gtype_cd, 0, "N", "Y"); // 선택 행 추가
	div_detail.cb_gtype.index = 0;
}  

function fn_afterQuery_dd07t_ZSHANG(errCode, errMsg) {  // 국내/상해 조회 CALL BACK

	gfn_copyDs(ds_shangh_cd, ds_shangh_cd_grid, "CODE <> ''");		// 그리드용 국내/상해 데이타셋
	gfn_InsertRowCombo(ds_shangh_cd, 0, "N", "Y"); // 선택 행 추가
	div_detail.cb_shangh.index = 0;
}  

function fn_afterQuery_dd07t_ZDELI(errCode, errMsg) { // 단납구분 조회 CALL BACK
}  

function fn_afterQuery_dd07t_ZINTER(errCode, errMsg) { // 중계무역구분 조회 CALL BACK
}  

function fn_afterQuery_zagnt(errCode, errMsg) { // 대리점명 조회 CALL BACK

	F_ZAGNT 	= ds_zagnt.GetColumn(0, "ZAGNT");	 // 대리점코드
	F_ZAGNT_NM 	= ds_zagnt.GetColumn(0, "ZAGNT_NM"); // 대리점명 //	trace("_ZAGNT:" + F_ZAGNT); trace("F_ZAGNT_NM:" + F_ZAGNT_NM);
}

function fn_setDetailInfo() { // 상세정보 조회 후처리 로직

	//F_ZBPNNR = ds_list.GetColumn(ds_list.row, "ZBPNNR"); 	//// 사업계획번호
	if (ds_list_detail.RowCount() == 0) {	// 매출, 청구, 수금 행 미존재 시 강제로 1행씩 추가한다. 

		ds_list_detail.Fireevent = false;
		ds_list_detail.InsertRow(0); 
		ds_list_detail.SetColumn(ds_list_detail.row, "GBN"		, "1");
		ds_list_detail.SetColumn(ds_list_detail.row, "GBN_NM"	, "매출"); 
		ds_list_detail.InsertRow(1); 
		ds_list_detail.SetColumn(ds_list_detail.row, "GBN"		, "2");
		ds_list_detail.SetColumn(ds_list_detail.row, "GBN_NM"	, "청구");
		ds_list_detail.InsertRow(2); 
		ds_list_detail.SetColumn(ds_list_detail.row, "GBN"		, "3");
		ds_list_detail.SetColumn(ds_list_detail.row, "GBN_NM"	, "수금");
		ds_list_detail.Fireevent = true;
	}
	
	gfn_SetFocus(div_detail.div_buyr.ed_buyr_cd, "Y") ;	// 거래선 코드에 포커싱
	ds_list_detail.row = -1;	// 매출/청구/수금 그리드에 포커싱 제거
}

function ds_list_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex) {

	var nCol = grd_list.GetCellPos();  // 현재 컬럼번호
	
	// Display구분, 진행하상에 대해 변경여부를 체크
	if (strColumnID = "CHK" || strColumnID == "FLAG" || strColumnID == "NEW_YN" || strColumnID == "SAVE_YN") return;
 
	if (varNewValue != varOldValue) {	// 값이 변경되었을 경우 변경구분 컬럼 자동 SET
		obj.Fireevent = false; 
		obj.SetColumn(nRow, "CHK" , "1");	// 선택여부   
		obj.Fireevent = true; 
		
		gfn_changeFlag( obj, strColumnID, nRow, "FLAG");  // FLAG 변경 : U
	}
	
	//대리점 입력 활성화 (FALSE : 대리점, 해외사용자, TRUE : 일반 사용자)
	div_detail_div_lifn_Enable(F_USER_GROUP_B, ds_list.GetColumn(ds_list.row, "VKBUR") );
		
	//  기종, 인승, 속도, 층수, 수주예상액, 납기예정일, 중계무역구분
	if( strColumnID == "TYPE1" || strColumnID == "TYPE2" || strColumnID == "TYPE3" || strColumnID == "RTYPE" || strColumnID == "SOFOCA" ||
		strColumnID == "DELDAT" || strColumnID == "ZINTER") {
		obj.Fireevent = false;
		if(ds_list.getOrgColumn(nRow, "RTYPE" ) == ds_list.GetColumn(nRow, "RTYPE") 
			&& ds_list.getOrgColumn(nRow, "TYPE1" ) == ds_list.GetColumn(nRow, "TYPE1")
			&& ds_list.getOrgColumn(nRow, "TYPE2" ) == ds_list.GetColumn(nRow, "TYPE2") 
			&& ds_list.getOrgColumn(nRow, "TYPE3" ) == ds_list.GetColumn(nRow, "TYPE3")
			&& ds_list.getOrgColumn(nRow, "SOFOCA" ) == ds_list.GetColumn(nRow, "SOFOCA")
			&& ds_list.getOrgColumn(nRow, "DELDAT" ) == ds_list.GetColumn(nRow, "DELDAT")
			&& ds_list.getOrgColumn(nRow, "ZINTER" ) == ds_list.GetColumn(nRow, "ZINTER")) {
			obj.SetColumn(nRow, "UFLAG" , " ");	
		} else {
			obj.SetColumn(nRow, "UFLAG" , "X");
		}
		obj.Fireevent = true;
		gfn_changeFlag( obj, strColumnID, nRow, "FLAG"); // FLAG 변경 : U
	}
}

function ds_list_CanRowPosChange(obj,nOldRow,nRow) { // 목록에서 행이 변경되려고 할 때
	 
	//var flag = obj.GetColumn(nOldRow, "FLAG"); 
	var chgRow = fn_findRow(true, true, true);  
	
	if (chgRow >= 0) {	// 다른 행에 변경된 자료가 존재할 경우

		var arr = ["행이동을","계속"];
		if (gfn_showConfirm("CI10001", arr) == false) { // "CI10001", "변경된 자료가 존재합니다. \n${} 할 경우 기존에 변경된 정보가 모두 소실됩니다.\n\n{} 하시겠습니까?");
			gfn_SetFocusGrid(grd_list, chgRow, 0) ;  // 변경된 행에 포커싱 처리
			return false;			// 행 이동하지 않기
		} else {
			fn_recorverToOldDataset(nOldRow); 	// 기존 값으로 복원처리 
			return true;  			// 행 이동하기
		}
	}
}
 
function ds_list_detail_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex) { // 매출/청구/수금 항목 변경 시

	ds_list.SetColumn(ds_list.row, "CHK", "1");	// FLAG 변경 : U 
	gfn_changeFlag( ds_list, "CHK", ds_list.row, "FLAG"); 
}

function grd_list_detail_OnKeyDown(obj,nChar,bShift,bCtrl,bAlt,nLLParam,nHLParam) { // 매출/청구/수금 그리드에서 키 입력 시
	
	var ds = object(obj.BindDataset);
	
	if (nChar==13) { 	// 엔터키이면
		ds.row = ds.row + 1;  // 다음 행으로 이동
	} else if (nChar==27) {	// Esc 키이면 변경전 자료로 되돌린다.
		var nCol 	= obj.GetCellPos();
		gfn_SetOrgColumn(obj, ds.row, nCol);  
	} else {
		gfn_GrdCellCopyPasteReset(obj, ds, bCtrl, nChar); 
	}
}

function grd_list_detail_OnHeadClick(obj,nCell,nX,nY,nPivotIndex) { // 매출/청구/수금 그리드 헤더 클릭 시

	if ( nCell == 0 ) gfn_selectGridCol(grd_list_detail);
}

function fn_recorverToOldDataset(pRowNum) { // 기존 값으로 복원처리 
	 
	ds_list.Fireevent = false;
	
	if (ds_list.GetColumn(pRowNum, "FLAG") == "I") { 	// 입력 행인 경우 행만 삭제

		gfn_deleteGridRow( grd_list, pRowNum, "FLAG" );	 
		ds_list_OnRowPosChanged(ds_list, -1, pRowNum);

	} else {	// 그 외는 기존 값으로 원복
		gfn_SetOrgColumn(grd_list, pRowNum, -1) ;
		ds_list.SetColumn(pRowNum, "FLAG", "");
		ds_list.ApplyChange();
		ds_list_detail.ClearData();
		ds_list_detail.ApplyChange();
	}
	ds_list_detail.ClearData();
	ds_list.ApplyChange();
	ds_list_detail.ApplyChange();
	ds_list.Fireevent = true; 
}

function fn_findRow(pInsert, pUpdate, pDelete) { // 그리드에서 특정 행 찾기

	var nRow = -1; 
	
	if (pInsert == true) 				nRow = ds_list.FindRow("FLAG", "I");	// 입력
	if (nRow < 0 && pUpdate == true) 	nRow = ds_list.FindRow("FLAG", "U");	// 변경
	if (nRow < 0 && pDelete == true) 	nRow = ds_list.FindRow("FLAG", "D");	// 삭제

	return nRow;
}     

function fn_enable_set(pEnable) { // 사업계획 오픈여부에 따른 데이타 수정가능여부 SETTING

	div_detail.div_buyr.ed_buyr_cd	.Enable = pEnable;	// 거래처코드
	div_detail.div_buyr.btn_popBuyr	.Enable = pEnable; 	// 거래처팝업
	div_detail.ed_gsnam				.Enable = pEnable;	// 공사명
	div_detail.cb_region			.Enable = pEnable;	// 설치지역
	div_detail.cb_shangh			.Enable = pEnable;	// 국내/상해
	//div_detail.chk_zinter			.Enable = pEnable;	// 중계무역구분
	div_detail.chk_zdeli			.Enable = pEnable;	// 단납기구분
	div_detail.cb_gtype				.Enable = pEnable;	// 기종
	div_detail.ed_type1				.Enable = pEnable;	//
	div_detail.ed_type2				.Enable = pEnable;
	div_detail.ed_type3				.Enable = pEnable;
	div_detail.ed_znumber			.Enable = pEnable;	// 대수
	div_detail.cb_waerk				.Enable = pEnable;	// 통화
	div_detail.med_sofoca			.Enable = pEnable;	// 수주예상액
	div_detail.med_zfore			.Enable = pEnable;	// 시행율
	div_detail.cal_deldat			.Enable = pEnable;	// 납기예정일
	div_detail.ed_zrmk				.Enable = pEnable;	// 비고
	div_detail.div_lifn.ed_lifnr	.Enable = pEnable;	// 대리점코드
	div_detail.div_lifn.btn_popLifnr.Enable = pEnable;	// 대리점코드 팝업
	
	// 임시로 관리자에게 입력권한 부여 20130115  by 김선호 -> 홍수봉DL 요청 
	if ( G_USER_ID <> '2018144' and G_USER_ID <> '2019116' and G_USER_ID <> '2018080' and
	     G_USER_ID <> '2020483' and G_USER_ID <> '2020564' and G_USER_ID <> '2020254' ) 
	{
		grd_list_detail					.Editable= pEnable; // 매출/청구/수금
		trace("AAAAAAAAAAAAAAAAAA " + pEnable );
	}else
	{
		grd_list_detail					.Editable= 1; // 매출/청구/수금		
		trace("bbbbbbbbbbbbbbbbbb " + pEnable );
	}
	 
	if (pEnable == true) { 	// 사용가능으로 처리 시

		if (ds_list.GetColumn(ds_list.row, "VKBUR") == "B500" || ds_list.GetColumn(ds_list.row, "VKBUR") == "B600" ||
		    ds_list.GetColumn(ds_list.row, "VKBUR") == "B700" || ds_list.GetColumn(ds_list.row, "VKBUR") == "B900" ||
		    ds_list.GetColumn(ds_list.row, "VKBUR") == "BA00" || ds_list.GetColumn(ds_list.row, "VKBUR") == "BB00" )
			{ // 해외영업부인 경우

			if (IndexOf(ds_list.GetColumn(ds_list.row, "GTYPE"), "(중계)") >= 0) {	// 기종코드 like (중계) 인 경우 수정불가 처리
				div_detail.cb_shangh .Enable = false;
				div_detail.chk_zinter.Enable = false; 
			}
		}
		if (G_USER_GRP_B == "B10") {		// 대리점 사용자의 경우 B10의 권한이면 대리점코드 수정 불가처리
			div_detail.div_lifn.ed_lifnr	.Enable = false;	// 대리점코드
			div_detail.div_lifn.btn_popLifnr.Enable = false;	// 대리점코드 팝업
		}
	}
	// 임시로 관리자에게 입력권한 부여 20130115  by 김선호 -> 홍수봉DL 요청 
	if ( G_USER_ID <> '2018144' and G_USER_ID <> '2019116' and G_USER_ID <> '2018080' and
	     G_USER_ID <> '2020483' and G_USER_ID <> '2020564' and G_USER_ID <> '2020254' ) 
	{
		ufn_enableBtn("input",pEnable); ufn_enableBtn("delete",pEnable); ufn_enableBtn("save",pEnable); //ufn_enableBtn("reset",pEnable);// 버튼 제어(입력, 삭제, 저장, 리셋)
	}	
}

function fn_style_set(pRowNum) { // 부서별로 특정항목의 style 적용

	if (ds_list.GetColumn(pRowNum, "VKBUR") == "B500" || ds_list.GetColumn(pRowNum, "VKBUR") == "B600" ||
	    ds_list.GetColumn(pRowNum, "VKBUR") == "B700" || ds_list.GetColumn(pRowNum, "VKBUR") == "B900" || 
	    ds_list.GetColumn(pRowNum, "VKBUR") == "BA00" || ds_list.GetColumn(pRowNum, "VKBUR") == "BB00")
	{	// 해외영업부인 경우
		div_detail.cb_region.Style = "sty_ipt_form";		// 설치지역 필수 아님
	} else {
		div_detail.cb_region.Style = "sty_ipt_form_ind";	// 설치지역 필수
	}
} 

function fn_buyer_set(pBuyrInfoArr) {  // 거래선 팝업에서 선택한 값이 설정됨, Coms003 에서 자동 호출되는 Reserved 함수
	div_detail.ed_land1.text 			= pBuyrInfoArr[4];	// 국가코드
	div_detail.ed_land1_nm.text 		= pBuyrInfoArr[5];	// 국가명
	div_detail.ed_zarea.text 			= pBuyrInfoArr[6];	// 권역코드
	div_detail.ed_zarea_nm.text 		= pBuyrInfoArr[7];	// 권역명  
	div_detail.ed_gsnam.SetFocus();							// 공사명에 포커싱
} 
 
function fn_afterQuery_deldat(svcId, errCode, errMsg) {
 
	if(ds_error.rowcount() > 0) {
		gfn_showMsgBar(ds_error.GetColumn(0,"ERRMSG"));
	} else {

		if (parseInt(ds_deldat.GetColumn(0,'C_WORKINGDAY')) > parseInt(div_detail.cal_deldat.Value)) {

			gfn_showAlert('CE10005',ds_deldat.GetColumn(0,'C_WORKINGDAY'));
			div_detail.cal_deldat.setFocus();
			ds_list.setColumn(ds_list.row, "DELDAT", ds_deldat.GetColumn(0,'C_WORKINGDAY'));
		}
	}
}

function div_detail_cal_deldat_OnChanged(obj,strOldText,strNewText) {

	arr = ['납기예정일','계획년월'];

	if (substr(ds_list.GetColumn(ds_list.row,'AUART'),0,2) != 'ZR') {
		if (parseInt(ds_list.GetColumn(ds_list.row,'ZPYM')) > parseInt(substr(ds_list.GetColumn(ds_list.row,'DELDAT'),0,6))) {

			gfn_showAlert('CW10036',arr); div_detail.cal_deldat.setFocus(); return;
		}

		var datefrom = substr(cal_zpym.Value, 0,4) + '-' + substr(cal_zpym.Value,4,2) + '-01';
		var days = '';

		if (parseInt(ds_list.GetColumn(ds_list.row,'ZNUMBER')) <= 2	|| ds_list.GetColumn(ds_list.row,'ZDELI') == 'X'|| ds_list.GetColumn(ds_list.row,'ZDELI') == '1') {
			days = '45';
		} else if (parseInt(ds_list.GetColumn(ds_list.row,'ZNUMBER')) <= 5) {
			days = '65';
		} else if (parseInt(ds_list.GetColumn(ds_list.row,'ZNUMBER')) <= 10) {
			days = '80';
		} else if (parseInt(ds_list.GetColumn(ds_list.row,'ZNUMBER')) <= 20) {
			days = '100';
		} else {
			days = '140';
		}

		ds_deldat.clearData();
		ds_cond_deldat.clearData();
		var nRow = ds_cond_deldat.AddRow();
		ds_cond_deldat.SetColumn(nRow, 'I_DATE_FROM' ,datefrom);
		ds_cond_deldat.SetColumn(nRow, 'I_DAYS' ,days);
		ds_cond_deldat.SetColumn(nRow, 'I_WERKS' ,'1000');	

		nsfRequest("query", "sbp0160/deldat", "ds_cond_deldat=ds_cond_deldat ds_deldat=ds_deldat", "ds_deldat=ds_deldat ds_error=ds_error", "", "fn_afterQuery_deldat"); // 서비스 호출
	}	
}

function div_detail_cb_shangh_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex) {

	if(strText == "상해") div_detail.chk_zinter.Value = "Y";
	else 		          div_detail.chk_zinter.Value = "";
}

function div_detail_div_lifn_Enable(strGroupb, strVkbur) {
	//대리점 정보 Enable 적용 함수
	if (strGroupb == "B10" || strVkbur == "B500" || StrVkbur == "B600" ||
	    StrVkbur == "B700" || StrVkbur == "B900" || StrVkbur == "BA00" || StrVkbur == "BB00")
		div_detail.div_lifn.Enable = false; 				//대리점 일반사용자, 해외영업부의 경우 대리점코드 수정불가
	else
		div_detail.div_lifn.Enable = true; 				 	// 대리점코드 수정가능
}



function fn_query_bdtyp() {
	// 건물용도 콤보목록 조회
	nsfRequest("query"									// srvId
				, "com0160/find"						// url
				, "ds_cond_build=ds_cond_build ds_list_build=ds_list_build"		// inDsList
				, "ds_list_build=ds_list_build ds_error_build=ds_error_build"	// outDsList
				, ""									// strParam
				, "fn_afterQuery_bdtyp"						// CallBackFunc
				);  

}


// 건물용도 코드목록 조회 CALL BACK함수
function fn_afterQuery_bdtyp(errCode, errMsg) 
{   
	// 그리드용 건물용도데이타셋
 	gfn_copyDs(ds_list_build, ds_list_build_grid, "BUILDUSE <> ''");	
	gfn_InsertRowCombo(ds_list_build, 0, "N", "Y", "BUILDUSE", "STEXT"); // 선택 행 추가
	div_detail.cb_bdtyp.index = 0;
	 
}   ]]></Script>
</Window>