<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="562" Id="Sbp0050" Left="8" OnLoadCompleted="fn_OnLoadCompleted" OnUnloadCompleted="fn_OnUnloadCompleted" PidAttrib="7" Title="수금계획&#32;관리" Top="8" Ver="1.0" Width="978" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_cond">
				<Contents>
					<colinfo id="FR_YM" size="8" type="STRING"/>
					<colinfo id="FR_VB" size="4" type="STRING"/>
					<colinfo id="FR_VG" size="3" type="STRING"/>
					<colinfo id="SMAN" size="10" type="STRING"/>
					<colinfo id="SPART" size="2" type="STRING"/>
					<record>
						<FR_VB></FR_VB>
						<FR_VG></FR_VG>
						<FR_YM></FR_YM>
						<SMAN></SMAN>
						<SPART></SPART>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list">
				<Contents>
					<colinfo id="AGENT" size="30" type="STRING"/>
					<colinfo id="AUART" size="4" type="STRING"/>
					<colinfo id="BISNE" size="13" type="DECIMAL"/>
					<colinfo id="BISP01" size="13" type="DECIMAL"/>
					<colinfo id="BISP02" size="13" type="DECIMAL"/>
					<colinfo id="BISP03" size="13" type="DECIMAL"/>
					<colinfo id="BISP04" size="13" type="DECIMAL"/>
					<colinfo id="BISP05" size="13" type="DECIMAL"/>
					<colinfo id="BISP06" size="13" type="DECIMAL"/>
					<colinfo id="BISP07" size="13" type="DECIMAL"/>
					<colinfo id="BISP08" size="13" type="DECIMAL"/>
					<colinfo id="BISP09" size="13" type="DECIMAL"/>
					<colinfo id="BISP10" size="13" type="DECIMAL"/>
					<colinfo id="BISP11" size="13" type="DECIMAL"/>
					<colinfo id="BISP12" size="13" type="DECIMAL"/>
					<colinfo id="BISP13" size="13" type="DECIMAL"/>
					<colinfo id="BISP14" size="13" type="DECIMAL"/>
					<colinfo id="BISP15" size="13" type="DECIMAL"/>
					<colinfo id="BISP16" size="13" type="DECIMAL"/>
					<colinfo id="BISP17" size="13" type="DECIMAL"/>
					<colinfo id="BISP18" size="13" type="DECIMAL"/>
					<colinfo id="BISP19" size="13" type="DECIMAL"/>
					<colinfo id="BISP20" size="13" type="DECIMAL"/>
					<colinfo id="BISP21" size="13" type="DECIMAL"/>
					<colinfo id="BISP22" size="13" type="DECIMAL"/>
					<colinfo id="BISP23" size="13" type="DECIMAL"/>
					<colinfo id="BISP24" size="13" type="DECIMAL"/>
					<colinfo id="BISRE" size="13" type="DECIMAL"/>
					<colinfo id="BSTKD" size="35" type="STRING"/>
					<colinfo id="CHEON" size="13" type="DECIMAL"/>
					<colinfo id="FKDAT" size="8" type="STRING"/>
					<colinfo id="JMGBN" size="8" type="STRING"/>
					<colinfo id="KUNNR_RGT" size="30" type="STRING"/>
					<colinfo id="KUNNRT" size="30" type="STRING"/>
					<colinfo id="KUNWET" size="30" type="STRING"/>
					<colinfo id="LAND1" size="3" type="STRING"/>
					<colinfo id="LANDX" size="15" type="STRING"/>
					<colinfo id="MISU" size="13" type="DECIMAL"/>
					<colinfo id="NCOLD" size="8" type="STRING"/>
					<colinfo id="NCOLD02" size="8" type="STRING"/>
					<colinfo id="NCOLD03" size="8" type="STRING"/>
					<colinfo id="NCOLD04" size="8" type="STRING"/>
					<colinfo id="NETWR" size="13" type="DECIMAL"/>
					<colinfo id="NOTCO" size="13" type="DECIMAL"/>
					<colinfo id="RE_NOTCO" size="13" type="DECIMAL"/>
					<colinfo id="SPART" size="2" type="STRING"/>
					<colinfo id="STATUS" size="4" type="STRING"/>
					<colinfo id="STATUS_PLAN" size="4" type="STRING"/>
					<colinfo id="SUNCO" size="13" type="DECIMAL"/>
					<colinfo id="UNOTCO" size="13" type="DECIMAL"/>
					<colinfo id="USDKY" size="5" type="STRING"/>
					<colinfo id="VBELN" size="10" type="STRING"/>
					<colinfo id="VDATU" size="8" type="STRING"/>
					<colinfo id="VKBUR" size="4" type="STRING"/>
					<colinfo id="VKBURT" size="20" type="STRING"/>
					<colinfo id="VKGRP" size="3" type="STRING"/>
					<colinfo id="VKGRPT" size="20" type="STRING"/>
					<colinfo id="VTWEG" size="2" type="STRING"/>
					<colinfo id="WAERK" size="5" type="STRING"/>
					<colinfo id="ZAREA" size="3" type="STRING"/>
					<colinfo id="ZAREAT" size="30" type="STRING"/>
					<colinfo id="ZDETAIL" size="2" type="STRING"/>
					<colinfo id="ZKUNNRT" size="30" type="STRING"/>
					<colinfo id="ZTERMT" size="20" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_error">
				<Contents>
					<colinfo id="IDX" size="256" type="STRING"/>
					<colinfo id="ERRMSG" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_yearf_cd">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_yeart_cd">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_monthf_cd">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
					<record>
						<CODE>01</CODE>
						<CODE_NAME>1월</CODE_NAME>
					</record>
					<record>
						<CODE>02</CODE>
						<CODE_NAME>2월</CODE_NAME>
					</record>
					<record>
						<CODE>03</CODE>
						<CODE_NAME>3월</CODE_NAME>
					</record>
					<record>
						<CODE>04</CODE>
						<CODE_NAME>4월</CODE_NAME>
					</record>
					<record>
						<CODE>05</CODE>
						<CODE_NAME>5월</CODE_NAME>
					</record>
					<record>
						<CODE>06</CODE>
						<CODE_NAME>6월</CODE_NAME>
					</record>
					<record>
						<CODE>07</CODE>
						<CODE_NAME>7월</CODE_NAME>
					</record>
					<record>
						<CODE>08</CODE>
						<CODE_NAME>8월</CODE_NAME>
					</record>
					<record>
						<CODE>09</CODE>
						<CODE_NAME>9월</CODE_NAME>
					</record>
					<record>
						<CODE>10</CODE>
						<CODE_NAME>10월</CODE_NAME>
					</record>
					<record>
						<CODE>11</CODE>
						<CODE_NAME>11월</CODE_NAME>
					</record>
					<record>
						<CODE>12</CODE>
						<CODE_NAME>12월</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_montht_cd">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
					<record>
						<CODE>01</CODE>
						<CODE_NAME>1월</CODE_NAME>
					</record>
					<record>
						<CODE>02</CODE>
						<CODE_NAME>2월</CODE_NAME>
					</record>
					<record>
						<CODE>03</CODE>
						<CODE_NAME>3월</CODE_NAME>
					</record>
					<record>
						<CODE>04</CODE>
						<CODE_NAME>4월</CODE_NAME>
					</record>
					<record>
						<CODE>05</CODE>
						<CODE_NAME>5월</CODE_NAME>
					</record>
					<record>
						<CODE>06</CODE>
						<CODE_NAME>6월</CODE_NAME>
					</record>
					<record>
						<CODE>07</CODE>
						<CODE_NAME>7월</CODE_NAME>
					</record>
					<record>
						<CODE>08</CODE>
						<CODE_NAME>8월</CODE_NAME>
					</record>
					<record>
						<CODE>09</CODE>
						<CODE_NAME>9월</CODE_NAME>
					</record>
					<record>
						<CODE>10</CODE>
						<CODE_NAME>10월</CODE_NAME>
					</record>
					<record>
						<CODE>11</CODE>
						<CODE_NAME>11월</CODE_NAME>
					</record>
					<record>
						<CODE>12</CODE>
						<CODE_NAME>12월</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_auart_cd">
				<Contents>
					<colinfo id="CODE" size="1" type="STRING"/>
					<colinfo id="CODE_NAME" size="1" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_spart_cd">
				<Contents>
					<colinfo id="CODE" size="1" type="STRING"/>
					<colinfo id="CODE_NAME" size="1" type="STRING"/>
					<record>
						<CODE>10</CODE>
						<CODE_NAME>승강기</CODE_NAME>
					</record>
					<record>
						<CODE>20</CODE>
						<CODE_NAME>주차</CODE_NAME>
					</record>
					<record>
						<CODE>30</CODE>
						<CODE_NAME>물류</CODE_NAME>
					</record>
					<record>
						<CODE>40</CODE>
						<CODE_NAME>PSD</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_result">
				<Contents></Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_param">
				<Contents>
					<colinfo id="FR_YM" size="8" type="STRING"/>
					<colinfo id="FR_VB" size="4" type="STRING"/>
					<colinfo id="FR_VG" size="3" type="STRING"/>
					<colinfo id="SMAN" size="10" type="STRING"/>
					<colinfo id="SPART" size="2" type="STRING"/>
					<record>
						<FR_VB></FR_VB>
						<FR_VG></FR_VG>
						<FR_YM></FR_YM>
						<SMAN></SMAN>
						<SPART></SPART>
					</record>
				</Contents>
			</Dataset>
		</Datasets>
		<Shape BKColor="user0" Bottom="34" Height="26" Id="Shape1" Left="8" LineColor="user1" Right="970" TabOrder="1" Top="8" Type="Rectangle" Width="962"></Shape>
		<Shape BKColor="user0" Bottom="59" Height="26" Id="Shape3" Left="8" LineColor="user1" Right="970" TabOrder="2" Top="33" Type="Rectangle" Width="962"></Shape>
		<Static Align="Right" Height="24" Id="st_frymd" Left="9" Style="sty_lb_search" TabOrder="3" Text="수주년월&#32;" Top="9" VAlign="Middle" Width="61"></Static>
		<Static Align="Right" Height="24" Id="st_spart" Left="9" Style="sty_lb_search" TabOrder="4" Text="제품군&#32;" Top="34" VAlign="Middle" Width="61"></Static>
		<Combo Border="Flat" CodeColumn="CODE" Column="YEARF" DataColumn="CODE_NAME" Height="20" Id="cb_yearf" InnerDataset="ds_yearf_cd" Left="71" Style="sty_ipt_search" TabOrder="5" Top="11" Width="62"></Combo>
		<Combo Border="Flat" CodeColumn="CODE" Column="MONTHF" DataColumn="CODE_NAME" Height="20" Id="cb_monthf" InnerDataset="ds_monthf_cd" Left="132" OnChanged="cb_monthf_OnChanged" Style="sty_ipt_search" TabOrder="6" Top="11" Width="50"></Combo>
		<Combo Border="Flat" CodeColumn="CODE" Column="CODE_NAME" DataColumn="CODE_NAME" Height="20" Id="cb_spart" InnerDataset="ds_spart_cd" Left="72" Style="sty_ipt_form" TabOrder="7" Top="35" Width="94"></Combo>
		<Static Align="Right" Height="24" Id="Static3" Left="392" Style="sty_lb_search" TabOrder="9" Text="담당자&#32;" Top="9" VAlign="Middle" Width="61"></Static>
		<Div BKColor="user0" Border="Flat" Height="22" Id="div_sman" Left="455" OnLoadCompleted="fn_OnLoadCompleted" OnTimer="WB0199010A_OnTimer" TabOrder="8" Text="Div0" Top="11" Url="COM::Coms002.xml" Width="280">
			<Contents></Contents>
		</Div>
		<Static Align="Right" Height="24" Id="Static4" Left="185" Style="sty_lb_search" TabOrder="11" Text="부서&#32;" Top="9" VAlign="Middle" Width="61"></Static>
		<Static Align="Right" Height="24" Id="Static5" Left="185" Style="sty_lb_search" TabOrder="12" Text="팀&#32;" Top="34" VAlign="Middle" Width="61"></Static>
		<Div BKColor="user0" Height="44" Id="div_vbvg" Left="248" OnLoadCompleted="fn_OnLoadCompleted" OnTimer="WB0199010A_OnTimer" TabOrder="10" Text="Div0" Top="12" Url="COM::Coms001.xml" Width="132">
			<Contents></Contents>
		</Div>
		<Grid AutoFitEndLine="Hide" BindDataset="ds_list" BkColor2="default" BoldHead="true" Border="Flat" Bottom="550" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="486" Id="grd_list" InputPanel="FALSE" Left="8" LineColor="user20" LineType="ExHORZ" OnCellDBLClick="grd_list_OnCellDblClick" OnHeadClick="grd_list_OnHeadClick" Right="974" RowHeight="20" Style="sty_grid" TabOrder="13" TabStop="true" Top="64" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="966">
			<contents>
				<format id="Default">
					<columns>
						<col fix="left" width="40"/>
						<col fix="left" width="40"/>
						<col fix="left" width="53"/>
						<col fix="left" width="77"/>
						<col fix="left" width="153"/>
						<col width="56"/>
						<col width="54"/>
						<col width="41"/>
						<col width="53"/>
						<col width="77"/>
						<col width="47"/>
						<col width="78"/>
						<col width="51"/>
						<col width="150"/>
						<col width="150"/>
						<col width="140"/>
						<col width="85"/>
						<col width="150"/>
						<col width="54"/>
						<col width="51"/>
						<col width="64"/>
						<col width="51"/>
						<col width="54"/>
						<col width="85"/>
						<col width="58"/>
						<col width="99"/>
						<col width="92"/>
						<col width="92"/>
						<col width="92"/>
						<col width="92"/>
						<col width="92"/>
						<col width="92"/>
						<col width="92"/>
						<col width="81"/>
						<col width="81"/>
						<col width="81"/>
						<col width="81"/>
						<col width="81"/>
						<col width="81"/>
						<col width="81"/>
						<col width="81"/>
						<col width="81"/>
						<col width="81"/>
						<col width="81"/>
						<col width="81"/>
						<col width="81"/>
						<col width="81"/>
						<col width="81"/>
						<col width="81"/>
						<col width="81"/>
						<col width="81"/>
						<col width="81"/>
						<col width="81"/>
						<col width="81"/>
						<col width="81"/>
						<col width="81"/>
						<col width="92"/>
						<col width="58"/>
						<col width="45"/>
						<col width="70"/>
						<col width="92"/>
						<col width="77"/>
					</columns>
					<head>
						<cell align="center" col="0" color="user21" display="text" font="굴림,9" text="No"/>
						<cell align="center" col="1" color="user21" display="text" font="굴림,9" text="상태"/>
						<cell align="center" col="2" color="user21" display="text" font="굴림,9" text="계획상태"/>
						<cell align="center" col="3" color="user21" display="text" font="굴림,9" text="프로젝트번호"/>
						<cell align="center" col="4" color="user21" display="text" font="굴림,9" text="현장명&#32;"/>
						<cell align="center" col="5" color="user21" display="text" font="굴림,9" text="오더유형"/>
						<cell align="center" col="6" color="user21" display="text" font="굴림,9" text="유통경로"/>
						<cell align="center" col="7" color="user21" display="text" font="굴림,9" text="제품군"/>
						<cell align="center" col="8" color="user21" display="text" font="굴림,9" text="부서코드"/>
						<cell align="center" col="9" color="user21" display="text" font="굴림,9" text="부서명"/>
						<cell align="center" col="10" color="user21" display="text" font="굴림,9" text="팀코드"/>
						<cell align="center" col="11" color="user21" display="text" font="굴림,9" text="팀명"/>
						<cell align="center" col="12" color="user21" display="text" font="굴림,9" text="담당자"/>
						<cell align="center" col="13" color="user21" display="text" font="굴림,9" text="거래선"/>
						<cell align="center" col="14" color="user21" display="text" font="굴림,9" text="지급처"/>
						<cell align="center" col="15" color="user21" display="text" font="굴림,9" text="대리점"/>
						<cell align="center" col="16" color="user21" display="text" font="굴림,9" text="장기미수&#32;구분"/>
						<cell align="center" col="17" color="user21" display="text" font="굴림,9" text="납부처"/>
						<cell align="center" col="18" color="user21" display="text" font="굴림,9" text="국가코드"/>
						<cell align="center" col="19" color="user21" display="text" font="굴림,9" text="국가명"/>
						<cell align="center" col="20" color="user21" display="text" font="굴림,9" text="권역코드"/>
						<cell align="center" col="21" color="user21" display="text" font="굴림,9" text="권역명"/>
						<cell align="center" col="22" color="user21" display="text" font="굴림,9" text="부가세분"/>
						<cell align="center" col="23" color="user21" display="text" font="굴림,9" text="납기일"/>
						<cell align="center" col="24" color="user21" display="text" font="굴림,9" text="수금조건"/>
						<cell align="center" col="25" color="user21" display="text" font="굴림,9" text="수주금액"/>
						<cell align="center" col="26" color="user21" display="text" font="굴림,9" text="수금액"/>
						<cell align="center" col="27" color="user21" display="text" font="굴림,9" text="전월미수잔액"/>
						<cell align="center" col="28" color="user21" display="text" font="굴림,9" text="&#32;월&#32;계획"/>
						<cell align="center" col="29" color="user21" display="text" font="굴림,9" text="&#32;월&#32;실적"/>
						<cell align="center" col="30" color="user21" display="text" font="굴림,9" text="미수잔액"/>
						<cell align="center" col="31" color="user21" display="text" font="굴림,9" text="이월금액&#32;19"/>
						<cell align="center" col="32" color="user21" display="text" font="굴림,9" text="수금예정일"/>
						<cell align="center" col="33" color="user21" display="text" font="굴림,9" text="BISP02"/>
						<cell align="center" col="34" color="user21" display="text" font="굴림,9" text="BISP03"/>
						<cell align="center" col="35" color="user21" display="text" font="굴림,9" text="BISP04"/>
						<cell align="center" col="36" color="user21" display="text" font="굴림,9" text="BISP05"/>
						<cell align="center" col="37" color="user21" display="text" font="굴림,9" text="BISP06"/>
						<cell align="center" col="38" color="user21" display="text" font="굴림,9" text="BISP07"/>
						<cell align="center" col="39" color="user21" display="text" font="굴림,9" text="BISP08"/>
						<cell align="center" col="40" color="user21" display="text" font="굴림,9" text="BISP09"/>
						<cell align="center" col="41" color="user21" display="text" font="굴림,9" text="BISP10"/>
						<cell align="center" col="42" color="user21" display="text" font="굴림,9" text="BISP11"/>
						<cell align="center" col="43" color="user21" display="text" font="굴림,9" text="BISP12"/>
						<cell align="center" col="44" color="user21" display="text" font="굴림,9" text="BISP13"/>
						<cell align="center" col="45" color="user21" display="text" font="굴림,9" text="BISP14"/>
						<cell align="center" col="46" color="user21" display="text" font="굴림,9" text="BISP15"/>
						<cell align="center" col="47" color="user21" display="text" font="굴림,9" text="BISP16"/>
						<cell align="center" col="48" color="user21" display="text" font="굴림,9" text="BISP17"/>
						<cell align="center" col="49" color="user21" display="text" font="굴림,9" text="BISP18"/>
						<cell align="center" col="50" color="user21" display="text" font="굴림,9" text="BISP19"/>
						<cell align="center" col="51" color="user21" display="text" font="굴림,9" text="BISP20"/>
						<cell align="center" col="52" color="user21" display="text" font="굴림,9" text="BISP21"/>
						<cell align="center" col="53" color="user21" display="text" font="굴림,9" text="BISP22"/>
						<cell align="center" col="54" color="user21" display="text" font="굴림,9" text="BISP23"/>
						<cell align="center" col="55" color="user21" display="text" font="굴림,9" text="BISP24"/>
						<cell align="center" col="56" color="user21" display="text" font="굴림,9" text="미수잔액($)"/>
						<cell align="center" col="57" color="user21" display="text" font="굴림,9" text="통화구분"/>
						<cell align="center" col="58" color="user21" display="text" font="굴림,9" text="달러키"/>
						<cell align="center" col="59" color="user21" display="text" font="굴림,9" text="청구일"/>
						<cell align="center" col="60" color="user21" display="text" font="굴림,9" text="청구금액"/>
						<cell align="center" col="61" color="user21" display="text" font="굴림,9" text="청구대비미수"/>
					</head>
					<body>
						<cell align="center" col="0" display="text" expr="currow+1"/>
						<cell align="center" col="1" colid="STATUS" display="text"/>
						<cell align="center" col="2" colid="STATUS_PLAN" display="text"/>
						<cell align="center" col="3" colid="VBELN" display="text"/>
						<cell align="left" bkcolor2="user22" col="4" colid="BSTKD" display="text"/>
						<cell align="center" bkcolor2="user22" col="5" colid="AUART" display="text"/>
						<cell align="center" bkcolor2="user22" col="6" colid="VTWEG" display="text"/>
						<cell align="center" bkcolor2="user22" col="7" colid="SPART" display="text"/>
						<cell align="center" bkcolor2="user22" col="8" colid="VKBUR" display="text"/>
						<cell align="center" bkcolor2="user22" col="9" colid="VKBURT" display="text"/>
						<cell align="center" bkcolor2="user22" col="10" colid="VKGRP" display="text"/>
						<cell align="center" bkcolor2="user22" col="11" colid="VKGRPT" display="text"/>
						<cell align="center" bkcolor2="user22" col="12" colid="ZKUNNRT" display="text"/>
						<cell align="left" bkcolor2="user22" col="13" colid="KUNNRT" display="text"/>
						<cell align="left" bkcolor2="user22" col="14" colid="KUNNR_RGT" display="text"/>
						<cell align="left" bkcolor2="user22" col="15" colid="AGENT" display="text"/>
						<cell align="center" bkcolor2="user22" col="16" colid="JMGBN" display="text"/>
						<cell align="left" bkcolor2="user22" col="17" colid="KUNWET" display="text"/>
						<cell align="center" bkcolor2="user22" col="18" colid="LAND1" display="text"/>
						<cell align="center" bkcolor2="user22" col="19" colid="LANDX" display="text"/>
						<cell align="center" bkcolor2="user22" col="20" colid="ZAREA" display="text"/>
						<cell align="left" bkcolor2="user22" col="21" colid="ZAREAT" display="text"/>
						<cell align="center" bkcolor2="user22" col="22" colid="ZDETAIL" display="text"/>
						<cell align="center" bkcolor2="user22" col="23" colid="VDATU"/>
						<cell align="center" bkcolor2="user22" col="24" colid="ZTERMT" display="text"/>
						<cell align="right" bkcolor2="user22" col="25" colid="NETWR" display="number"/>
						<cell align="right" bkcolor2="user22" col="26" colid="SUNCO" display="number"/>
						<cell align="right" bkcolor2="user22" col="27" colid="NOTCO" display="number"/>
						<cell align="right" bkcolor2="user22" col="28" colid="BISP01" display="number"/>
						<cell align="right" bkcolor2="user22" col="29" colid="BISRE" display="number"/>
						<cell align="right" bkcolor2="user22" col="30" colid="RE_NOTCO" display="number"/>
						<cell align="right" bkcolor2="user22" col="31" colid="BISNE" display="number"/>
						<cell align="center" bkcolor2="user22" col="32" colid="NCOLD"/>
						<cell align="right" bkcolor2="user22" col="33" colid="BISP02" display="numberexp" edit="masknumber" limit="10" LimitDec="2" Mask="###,###,##0.#0"/>
						<cell align="right" bkcolor2="user22" col="34" colid="BISP03" display="numberexp" edit="masknumber" limit="10" LimitDec="2" Mask="###,###,##0.#0"/>
						<cell align="right" bkcolor2="user22" col="35" colid="BISP04" display="numberexp" edit="masknumber" limit="10" LimitDec="2" Mask="###,###,##0.#0"/>
						<cell align="right" bkcolor2="user22" col="36" colid="BISP05" display="numberexp" edit="masknumber" limit="10" LimitDec="2" Mask="###,###,##0.#0"/>
						<cell align="right" bkcolor2="user22" col="37" colid="BISP06" display="numberexp" edit="masknumber" limit="10" LimitDec="2" Mask="###,###,##0.#0"/>
						<cell align="right" bkcolor2="user22" col="38" colid="BISP07" display="numberexp" edit="masknumber" limit="10" LimitDec="2" Mask="###,###,##0.#0"/>
						<cell align="right" bkcolor2="user22" col="39" colid="BISP08" display="numberexp" edit="masknumber" limit="10" LimitDec="2" Mask="###,###,##0.#0"/>
						<cell align="right" bkcolor2="user22" col="40" colid="BISP09" display="numberexp" edit="masknumber" limit="10" LimitDec="2" Mask="###,###,##0.#0"/>
						<cell align="right" bkcolor2="user22" col="41" colid="BISP10" display="numberexp" edit="masknumber" limit="10" LimitDec="2" Mask="###,###,##0.#0"/>
						<cell align="right" bkcolor2="user22" col="42" colid="BISP11" display="numberexp" edit="masknumber" limit="10" LimitDec="2" Mask="###,###,##0.#0"/>
						<cell align="right" bkcolor2="user22" col="43" colid="BISP12" display="numberexp" edit="masknumber" limit="10" LimitDec="2" Mask="###,###,##0.#0"/>
						<cell align="right" bkcolor2="user22" col="44" colid="BISP13" display="numberexp" edit="masknumber" limit="10" LimitDec="2" Mask="###,###,##0.#0"/>
						<cell align="right" bkcolor2="user22" col="45" colid="BISP14" display="numberexp" edit="masknumber" limit="10" LimitDec="2" Mask="###,###,##0.#0"/>
						<cell align="right" bkcolor2="user22" col="46" colid="BISP15" display="numberexp" edit="masknumber" limit="10" LimitDec="2" Mask="###,###,##0.#0"/>
						<cell align="right" bkcolor2="user22" col="47" colid="BISP16" display="numberexp" edit="masknumber" limit="10" LimitDec="2" Mask="###,###,##0.#0"/>
						<cell align="right" bkcolor2="user22" col="48" colid="BISP17" display="numberexp" edit="masknumber" limit="10" LimitDec="2" Mask="###,###,##0.#0"/>
						<cell align="right" bkcolor2="user22" col="49" colid="BISP18" display="numberexp" edit="masknumber" limit="10" LimitDec="2" Mask="###,###,##0.#0"/>
						<cell align="right" bkcolor2="user22" col="50" colid="BISP19" display="numberexp" edit="masknumber" limit="10" LimitDec="2" Mask="###,###,##0.#0"/>
						<cell align="right" bkcolor2="user22" col="51" colid="BISP20" display="numberexp" edit="masknumber" limit="10" LimitDec="2" Mask="###,###,##0.#0"/>
						<cell align="right" bkcolor2="user22" col="52" colid="BISP21" display="numberexp" edit="masknumber" limit="10" LimitDec="2" Mask="###,###,##0.#0"/>
						<cell align="right" bkcolor2="user22" col="53" colid="BISP22" display="numberexp" edit="masknumber" limit="10" LimitDec="2" Mask="###,###,##0.#0"/>
						<cell align="right" bkcolor2="user22" col="54" colid="BISP23" display="numberexp" edit="masknumber" limit="10" LimitDec="2" Mask="###,###,##0.#0"/>
						<cell align="right" bkcolor2="user22" col="55" colid="BISP24" display="number" edit="masknumber" limit="10" LimitDec="2" Mask="###,###,##0.#0"/>
						<cell align="right" bkcolor2="user22" col="56" colid="UNOTCO" display="number"/>
						<cell align="center" bkcolor2="user22" col="57" colid="WAERK"/>
						<cell align="center" bkcolor2="user22" col="58" colid="USDKY"/>
						<cell align="center" bkcolor2="user22" col="59" colid="FKDAT"/>
						<cell align="right" bkcolor2="user22" col="60" colid="CHEON" display="number"/>
						<cell align="right" bkcolor2="user22" col="61" colid="MISU" display="number"/>
					</body>
				</format>
			</contents>
		</Grid>
	</Form>
	<Script><![CDATA[/*
 ******************************************************************************************
 * 기      능   : 
 * 작  성  자   : 
 * 작성  일자   : 
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
#include "LIB::commons.js";	// 공통 스크립트 
#include "LIB::nsfRequest.js";	// 공통 스크립트 
#include "LIB::common_hdel.js";	// 공통 스크립트  /* GNY 추가 */
//=========================================================================================
// [ PART 1 ]
// Form에서 사용될 전역변수를 선언
// FORM에서 사용되는 전역변수는 대문자로 작성하며, F_XXX 의 형태를 갖도록 한다. 
//=========================================================================================

 // 저장 후  재 조회시  저장한 row  선택 
var nSelectRow = 0; 
//=========================================================================================
// [ PART 2 ]
// Form Loading / Unloading 시 작업 정의
//=========================================================================================
function fn_OnLoadCompleted(obj) {
	// Form 로드 이벤트 맨 첫줄에 기술 
	gfn_initForm(true);

	fn_init_form(); 	// 폼 초기화

}

/********************************************************************************
* 기      능   : 지급예정년 계산(현재년도,당해년도에서 뺄 년수, 당해년도에서 더할 년수
********************************************************************************/
function fn_makeYear(curYear,sNum,eNum) {
	var rowCnt = eNum-sNum;
	var row = 0;

	for(var i=rowCnt; i>-1; i--) {
		ds_yearf_cd.AddRow();
		ds_yearf_cd.SetColumn(row,"CODE",parseInt(curYear)+i+parseInt(sNum));
		ds_yearf_cd.SetColumn(row,"CODE_NAME",(parseInt(curYear)+i+parseInt(sNum))+"년");
		ds_yeart_cd.AddRow();
		ds_yeart_cd.SetColumn(row,"CODE",parseInt(curYear)+i+parseInt(sNum));
		ds_yeart_cd.SetColumn(row,"CODE_NAME",(parseInt(curYear)+i+parseInt(sNum))+"년");
		row++;
	}

	cb_yearf.index = eNum;

}

/********************************************************************************
* 기      능   : form UnloadCompleted 
********************************************************************************/
function fn_OnUnloadCompleted(obj) {
	return gfn_isFormUnload(obj);
}

//=========================================================================================
// [ PART 3 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,form닫기)
//=========================================================================================
/********************************************************************************
* 기      능   : 조회 1
********************************************************************************/
function fn_query() {


	if (length(div_vbvg.cb_frvb.Value) == 0)
	{
		alert("부서코드는 필수입력 입니다.");
		gfn_SetFocus(div_vbvg.cb_frvb,"Y"); 
		return false;
	}
	
	if (length(div_vbvg.cb_frvg.Value) == 0)
	{
		alert("팀코드는 필수입력 입니다.");
		gfn_SetFocus(div_vbvg.cb_frvg,"Y"); 
		return false;
	}
	
	if (length(div_sman.ed_sman_cd.Value) == 0)
	{
		alert("담당자는 필수입력 입니다.");
		gfn_SetFocus(div_sman.ed_sman_cd,"Y"); 
		return false;
	}
	
	if (length(cb_spart.Value) == 0)
	{
		alert("제품군는 필수입력 입니다.");
		gfn_SetFocus(cb_spart,"Y"); 
		return false;
	}	

	var frYear  = ds_yearf_cd.GetColumn(cb_yearf.Index, "CODE");
	var frMonth = ds_monthf_cd.GetColumn(cb_monthf.Index, "CODE");


	var spart   = ds_spart_cd.GetColumn(cb_spart.Index, "CODE");
	
	ds_cond.ClearData();
	ds_cond.AddRow();
	
	ds_cond.SetColumn(0, "FR_VB", div_vbvg.cb_frvb.Value);
	ds_cond.SetColumn(0, "FR_VG", div_vbvg.cb_frvg.Value);	
	ds_cond.SetColumn(0, "FR_YM", frYear + frMonth);
	ds_cond.SetColumn(0, "SMAN" , div_sman.ed_sman_cd.Text);
	ds_cond.SetColumn(0, "SPART", spart);
	
	
	//ds_cond.SetColumn(0, "FR_VB", "1100");
	//ds_cond.SetColumn(0, "FR_VG", "111");	
	//ds_cond.SetColumn(0, "FR_YM", "200801");
	//ds_cond.SetColumn(0, "SMAN" , "H2016362");
	//ds_cond.SetColumn(0, "SPART", "10");

	// 서비스 호출
	nsfRequest("query"									// srvId
				, "sbp0170/find"						// url
				, "ds_cond=ds_cond"						// inDsList
				, "ds_list=ds_list ds_error=ds_error"	// outDsList
				, ""									// strParam
				, "fn_afterQuery"						// CallBackFunc
				);

    fn_createWait("",this);     // 처리중입니다. 메시지 처리
}

//=========================================================================================
// [ PART 3 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,form닫기)
//=========================================================================================
/********************************************************************************
* 기      능   : 저장 1
********************************************************************************/
function fn_save() {



    if(ds_list.GetUpdate() == false) {
		 alert("변경 된사항 이 없습니다." ); 

		 return false; 
    } 
    
	// 저장확인
	// if (!gfn_showConfirm("CI00010")) {
		// return;
	// }
	
	if(!Confirm("저장하시겠습니까?")){
	   return;
	}

	// 서비스 호출
	nsfRequest("update"									// srvId
				, "sbp0170/update"						// url
				, "ds_param = ds_param ds_list=ds_list:u"						// inDsList
				, "ds_result=ds_result ds_error=ds_error"	// outDsList
				, ""									// strParam
				, "fn_afterQuery"						// CallBackFunc
				);

    fn_createWait("",this);     // 처리중입니다. 메시지 처리
}

/********************************************************************************
* 기      능   : 폼 초기화
********************************************************************************/
function fn_init_form() {

	var curYear = substr(gfn_getCurrDate(),0,4);
//	fn_makeYear(curYear,-1,10);
	fn_makeYear(curYear,-4,1);
	cb_monthf.index = parseInt(substr(gfn_getCurrDate(),4,2))-1;

	div_sman.Border = "none";


	gfn_insertEmptyRow(ds_spart_cd, G_CODE_ALL);
	cb_spart.index  = 0;

	cb_yearf.SetFocus();
	
	//  헤드 타이틀 변경 
	fn_changeTitle(); 	
	
} 

/********************************************************************************
* 기      능   : 닫기  
********************************************************************************/
function fn_close() {
	close();
}

/********************************************************************************
* 기      능   : 액셀  
********************************************************************************/
function fn_excel() {
}

//=========================================================================================
// [ PART 4]
// Callback 함수 정의 : callback 함수명은 메인 함수의 fn_xxxx() 에서 xxxx 부분은 fn_afterXXXX()
// 형태가 되도록 작성 
//=========================================================================================
/********************************************************************************
* 기      능   : 조회 Callback  
********************************************************************************/
function fn_afterQuery(svcId, errCode, errMsg) {

	fn_destroyWait();

	if(ds_error.rowcount() > 0) {
		gfn_showMsg("CE00001");
		// error 정보 표시 
		gfn_openWSErrorWin(grd_list, ds_list, ds_error, "FLAG");
	} else {
		if(errCode != 0) {
			gfn_showMsg("CE00001");
		} else {
			gfn_showMsg("CI00002", ds_list.RowCount() + "");
		}
	}

	if(svcId == "query") {
	    // 저장 후  선택한 row 찾아가기 
		ds_list.row = nSelectRow;
		
		// 저장  하기 위해  필요한 값  셋팅  FR_YM 
		var frYear  = ds_yearf_cd.GetColumn(cb_yearf.Index, "CODE");
		var frMonth = ds_monthf_cd.GetColumn(cb_monthf.Index, "CODE");
	
		ds_param.SetColumn(0, "FR_YM", frYear + frMonth);
	
	}
	
	if(svcId == "update") {
	    nSelectRow  = ds_list.currow; 
		fn_query();
		
	}
	
}


//=========================================================================================
// [ PART 6 ]
// component Event 정의 : 각 Component 별 이벤트 
//=========================================================================================
/********************************************************************************
* 기      능   : 정렬 처리 
********************************************************************************/
function grd_list_OnHeadClick(obj,nCell,nX,nY,nPivotIndex) {
	if( nCell == 0 ) {
		gfn_selectAllGrid(obj,nCell,nCell,true);
	} else {
		gfn_sortGrid(obj, nCell);
	}	
}

/********************************************************************************
* 기      능   : 조회
********************************************************************************/
function fn_OnClick_btn(obj) {
	var fncName = "fn_" + substr(obj.id, 4); 
	eval( fncName + "()");
}



function cb_monthf_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	fn_changeTitle(); 
	
}

// 헤더 타이틀 변경 
function fn_changeTitle() { 
	var bNextFalg = false; 
	var nMM = toNumber(cb_monthf.Value);
	var nYY = toNumber(substr(cb_yearf.Value,2,2));	
	var nYYMM =  "";	
	
	// if( cb_monthf.Value == "01") { 
		// nYYMM = nYY  + "12";
	// } else {
	 
		// nYYMM = nYY +  "" + toNumber(nMM);
    // }	
    
    nYYMM = nYY +  "" + toNumber(nMM);
	
	grd_list.SetCellProp("head", 28, "text",  nYYMM + " 월 계획");
	grd_list.SetCellProp("head", 29, "text",  nYYMM + " 월 실적");
	
	for( var i = 1 ;  i < 24; i++ ) {    
	  
		if(bNextFalg == true) { 
		
			nYY = toNumber(nYY) + 1; 
			bNextFalg = false; 
		} 

		// if( i == 1 ) {
		
			// nMM = toNumber(nMM);
		// } else { 
			// nMM = toNumber(nMM) + 1;
		// }
		nMM = toNumber(nMM) + 1;

		nPYY = lpad(nYY, "0", 2);    
		nPMM = lpad(nMM, "0", 2); 	
		nYYMM = nPYY + nPMM;	        	
		
		grd_list.SetCellProp("head", 32 + i, "text",  nYYMM + "월 계획");		
		
		if( nMM == 12 || nMM == 24) { 
			bNextFalg = true; 
			
			nMM = 0; 
		} 	    	
	
	}		

} 
]]></Script>
</Window>