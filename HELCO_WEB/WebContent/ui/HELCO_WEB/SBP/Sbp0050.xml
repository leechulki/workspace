<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="562" Id="Sbp0050" Left="8" OnLoadCompleted="fn_OnLoadCompleted" OnUnloadCompleted="fn_OnUnloadCompleted" PidAttrib="7" Title="사업계획매출채권관리(정기보수)" Top="8" Ver="1.0" Width="978" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_cond">
				<Contents>
					<colinfo id="ZPYEAR" size="4" type="STRING"/>
					<colinfo id="ZPYM" size="6" type="STRING"/>
					<colinfo id="SPART" size="2" type="STRING"/>
					<colinfo id="VKBUR_FR" size="4" type="STRING"/>
					<colinfo id="VKBUR_TO" size="4" type="STRING"/>
					<colinfo id="VKGRP_FR" size="3" type="STRING"/>
					<colinfo id="VKGRP_TO" size="3" type="STRING"/>
					<colinfo id="ZKUNNR" size="10" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset CanRowPosChange="ds_list_CanRowPosChange" DataSetType="Dataset" Id="ds_list" OnColumnChanged="ds_list_OnColumnChanged" OnRowPosChanged="ds_list_OnRowPosChanged">
				<Contents>
					<colinfo id="SAVE_YN" size="1" type="STRING"/>
					<colinfo id="CHK" size="1" type="STRING"/>
					<colinfo id="FLAG" size="1" type="STRING"/>
					<colinfo id="NEW_YN" size="1" type="STRING"/>
					<colinfo id="MANDT" size="1" type="STRING"/>
					<colinfo id="ZPYEAR" size="4" type="STRING"/>
					<colinfo id="ZPYM" size="6" type="STRING"/>
					<colinfo id="SPART" size="2" type="STRING"/>
					<colinfo id="AUART" size="4" type="STRING"/>
					<colinfo id="MATNR" size="18" type="STRING"/>
					<colinfo id="VKBUR" size="4" type="STRING"/>
					<colinfo id="VKGRP" size="3" type="STRING"/>
					<colinfo id="ZKUNNR" size="10" type="STRING"/>
					<colinfo id="ZKUNNR_NM" size="30" type="STRING"/>
					<colinfo id="GTYPE" size="20" type="STRING"/>
					<colinfo id="ZNUMBER" size="5" type="INT"/>
					<colinfo id="KUNNR" size="10" type="STRING"/>
					<colinfo id="KUNNR_NM" size="30" type="STRING"/>
					<colinfo id="GSNAM" size="50" type="STRING"/>
					<colinfo id="REGION" size="2" type="STRING"/>
					<colinfo id="ZBDGBN" size="3" type="STRING"/>
					<colinfo id="ZBDTYP" size="6" type="STRING"/>
					<colinfo id="ZDELI" size="1" type="STRING"/>
					<colinfo id="SOFOCA" size="15" type="DECIMAL"/>
					<colinfo id="ZFORE" size="4" type="DECIMAL"/>
					<colinfo id="WAERK" size="5" type="STRING"/>
					<colinfo id="CDATE" size="8" type="STRING"/>
					<colinfo id="CTIME" size="6" type="STRING"/>
					<colinfo id="CUSER" size="10" type="STRING"/>
					<colinfo id="UDATE" size="8" type="STRING"/>
					<colinfo id="UTIME" size="6" type="STRING"/>
					<colinfo id="UUSER" size="10" type="STRING"/>
					<colinfo id="DDATE" size="8" type="STRING"/>
					<colinfo id="DTIME" size="6" type="STRING"/>
					<colinfo id="DUSER" size="10" type="STRING"/>
					<colinfo id="ZSVCGBN" size="2" type="STRING"/>
					<colinfo id="PSPIDSV" size="24" type="STRING"/>
					<colinfo id="ZHOGISV" size="24" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_error">
				<Contents>
					<colinfo id="ERRCODE" size="10" type="STRING"/>
					<colinfo id="ERRMSG" size="200" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list_spart">
				<Contents>
					<colinfo id="CODE" size="2" type="STRING"/>
					<colinfo id="CODE_NAME" size="50" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list_vb" OnRowPosChanged="ds_list_vb_OnRowPosChanged">
				<Contents>
					<colinfo id="CODE" size="12" type="STRING"/>
					<colinfo id="CODE_NAME" size="60" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list_vg">
				<Contents>
					<colinfo id="CODE" size="12" type="STRING"/>
					<colinfo id="CODE_NAME" size="60" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_obj_list">
				<Contents>
					<colinfo id="DS_VB" size="20" type="STRING"/>
					<colinfo id="DS_VG" size="20" type="STRING"/>
					<colinfo id="DS_COND_VG" size="20" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list_sman">
				<Contents>
					<colinfo id="SMAN_CD" size="256" type="STRING"/>
					<colinfo id="SMAN_NM" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond_sman">
				<Contents>
					<colinfo id="SMAN_CD" size="10" type="STRING"/>
					<colinfo id="SMAN_NM" size="105" type="STRING"/>
					<record>
						<SMAN_CD></SMAN_CD>
						<SMAN_NM></SMAN_NM>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list_buyr">
				<Contents>
					<colinfo id="BUYR_CD" size="256" type="STRING"/>
					<colinfo id="BUYR_NM" size="256" type="STRING"/>
					<colinfo id="BUYR_NM_SORT" size="256" type="STRING"/>
					<colinfo id="BUYR_ADDR" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond_buyr">
				<Contents>
					<colinfo id="BUYR_CD" size="10" type="STRING"/>
					<colinfo id="BUYR_NM" size="105" type="STRING"/>
					<record>
						<BUYR_CD></BUYR_CD>
						<BUYR_NM></BUYR_NM>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond_opendtm">
				<Contents>
					<colinfo id="ZPYEAR" size="4" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list_opendtm">
				<Contents>
					<colinfo id="OPENDTM" size="14" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond_vg">
				<Contents>
					<colinfo id="VB" size="4" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_detail">
				<Contents>
					<colinfo id="FLAG" size="1" type="STRING"/>
					<colinfo id="MANDT" size="3" type="STRING"/>
					<colinfo id="ZPYEAR" size="4" type="STRING"/>
					<colinfo id="ZPYM" size="6" type="STRING"/>
					<colinfo id="SPART" size="2" type="STRING"/>
					<colinfo id="AUART" size="4" type="STRING"/>
					<colinfo id="MATNR" size="18" type="STRING"/>
					<colinfo id="VKBUR" size="4" type="STRING"/>
					<colinfo id="VKGRP" size="3" type="STRING"/>
					<colinfo id="ZKUNNR" size="10" type="STRING"/>
					<colinfo id="GTYPE" size="20" type="STRING"/>
					<colinfo id="ZNUMBER" size="5" type="INT"/>
					<colinfo id="KUNNR" size="10" type="STRING"/>
					<colinfo id="GSNAM" size="50" type="STRING"/>
					<colinfo id="REGION" size="2" type="STRING"/>
					<colinfo id="ZBDGBN" size="3" type="STRING"/>
					<colinfo id="ZBDTYP" size="4" type="STRING"/>
					<colinfo id="ZDELI" size="1" type="STRING"/>
					<colinfo id="SOFOCA" size="15" type="DECIMAL"/>
					<colinfo id="ZFORE" size="4" type="DECIMAL"/>
					<colinfo id="WAERK" size="5" type="STRING"/>
					<colinfo id="ZRMK" size="100" type="STRING"/>
					<colinfo id="CDATE" size="8" type="STRING"/>
					<colinfo id="CTIME" size="6" type="STRING"/>
					<colinfo id="CUSER" size="10" type="STRING"/>
					<colinfo id="UDATE" size="8" type="STRING"/>
					<colinfo id="UTIME" size="6" type="STRING"/>
					<colinfo id="UUSER" size="10" type="STRING"/>
					<colinfo id="DDATE" size="8" type="STRING"/>
					<colinfo id="DTIME" size="6" type="STRING"/>
					<colinfo id="DUSER" size="10" type="STRING"/>
					<colinfo id="USER_ID" size="10" type="STRING"/>
					<colinfo id="ZSVCGBN" size="2" type="STRING"/>
					<colinfo id="PSPIDSV" size="24" type="STRING"/>
					<colinfo id="ZHOGISV" size="24" type="STRING"/>
					<colinfo id="BILL_SAVE_YN" size="1" type="STRING"/>
					<record>
						<AUART></AUART>
						<BILL_SAVE_YN></BILL_SAVE_YN>
						<CDATE></CDATE>
						<CTIME></CTIME>
						<CUSER></CUSER>
						<DDATE></DDATE>
						<DTIME></DTIME>
						<DUSER></DUSER>
						<FLAG></FLAG>
						<GSNAM></GSNAM>
						<GTYPE></GTYPE>
						<KUNNR></KUNNR>
						<MANDT></MANDT>
						<MATNR></MATNR>
						<PSPIDSV></PSPIDSV>
						<REGION></REGION>
						<SOFOCA/>
						<SPART></SPART>
						<UDATE></UDATE>
						<USER_ID></USER_ID>
						<UTIME></UTIME>
						<UUSER></UUSER>
						<VKBUR></VKBUR>
						<VKGRP></VKGRP>
						<WAERK></WAERK>
						<ZBDGBN></ZBDGBN>
						<ZBDTYP></ZBDTYP>
						<ZDELI></ZDELI>
						<ZFORE/>
						<ZHOGISV></ZHOGISV>
						<ZKUNNR></ZKUNNR>
						<ZNUMBER/>
						<ZPYEAR></ZPYEAR>
						<ZPYM></ZPYM>
						<ZRMK></ZRMK>
						<ZSVCGBN></ZSVCGBN>
					</record>
					<record>
						<AUART></AUART>
						<BILL_SAVE_YN></BILL_SAVE_YN>
						<CDATE></CDATE>
						<CTIME></CTIME>
						<CUSER></CUSER>
						<DDATE></DDATE>
						<DTIME></DTIME>
						<DUSER></DUSER>
						<FLAG></FLAG>
						<GSNAM></GSNAM>
						<GTYPE></GTYPE>
						<KUNNR></KUNNR>
						<MANDT></MANDT>
						<MATNR></MATNR>
						<PSPIDSV></PSPIDSV>
						<REGION></REGION>
						<SOFOCA/>
						<SPART></SPART>
						<UDATE></UDATE>
						<USER_ID></USER_ID>
						<UTIME></UTIME>
						<UUSER></UUSER>
						<VKBUR></VKBUR>
						<VKGRP></VKGRP>
						<WAERK></WAERK>
						<ZBDGBN></ZBDGBN>
						<ZBDTYP></ZBDTYP>
						<ZDELI></ZDELI>
						<ZFORE/>
						<ZHOGISV></ZHOGISV>
						<ZKUNNR></ZKUNNR>
						<ZNUMBER/>
						<ZPYEAR></ZPYEAR>
						<ZPYM></ZPYM>
						<ZRMK></ZRMK>
						<ZSVCGBN></ZSVCGBN>
					</record>
					<record>
						<AUART></AUART>
						<BILL_SAVE_YN></BILL_SAVE_YN>
						<CDATE></CDATE>
						<CTIME></CTIME>
						<CUSER></CUSER>
						<DDATE></DDATE>
						<DTIME></DTIME>
						<DUSER></DUSER>
						<FLAG></FLAG>
						<GSNAM></GSNAM>
						<GTYPE></GTYPE>
						<KUNNR></KUNNR>
						<MANDT></MANDT>
						<MATNR></MATNR>
						<PSPIDSV></PSPIDSV>
						<REGION></REGION>
						<SOFOCA/>
						<SPART></SPART>
						<UDATE></UDATE>
						<USER_ID></USER_ID>
						<UTIME></UTIME>
						<UUSER></UUSER>
						<VKBUR></VKBUR>
						<VKGRP></VKGRP>
						<WAERK></WAERK>
						<ZBDGBN></ZBDGBN>
						<ZBDTYP></ZBDTYP>
						<ZDELI></ZDELI>
						<ZFORE/>
						<ZHOGISV></ZHOGISV>
						<ZKUNNR></ZKUNNR>
						<ZNUMBER/>
						<ZPYEAR></ZPYEAR>
						<ZPYM></ZPYM>
						<ZRMK></ZRMK>
						<ZSVCGBN></ZSVCGBN>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond_detail">
				<Contents>
					<colinfo id="PSPIDSV" size="24" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_yearm">
				<Contents>
					<colinfo id="YEARM" size="6" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_result">
				<Contents>
					<colinfo id="PSPIDSV" size="24" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list_gtype">
				<Contents>
					<colinfo id="gtype" size="20" type="STRING"/>
					<colinfo id="auart" size="4" type="STRING"/>
					<colinfo id="matnr" size="18" type="STRING"/>
					<colinfo id="spart" size="2" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_region_cd">
				<Contents>
					<colinfo id="CODE" size="2" type="STRING"/>
					<colinfo id="CODE_NAME" size="20" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_zdeli_cd">
				<Contents>
					<colinfo id="CODE" size="2" type="STRING"/>
					<colinfo id="CODE_NAME" size="50" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond_dd07t">
				<Contents>
					<colinfo id="DOMNAME" size="50" type="STRING"/>
					<colinfo id="DOMVALUE_L" size="50" type="STRING"/>
					<colinfo id="CONCAT_YN" size="1" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_error_dd07t">
				<Contents>
					<colinfo id="IDX" size="256" type="STRING"/>
					<colinfo id="ERRMSG" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_shangh_cd">
				<Contents>
					<colinfo id="CODE" size="2" type="STRING"/>
					<colinfo id="CODE_NAME" size="50" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_zinter_cd">
				<Contents>
					<colinfo id="CODE" size="2" type="STRING"/>
					<colinfo id="CODE_NAME" size="50" type="STRING"/>
					<record>
						<CODE>X</CODE>
						<CODE_NAME>중계무역</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_gtype_cd">
				<Contents>
					<colinfo id="CODE" size="2" type="STRING"/>
					<colinfo id="CODE_NAME" size="50" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_waerk_cd">
				<Contents>
					<colinfo id="CODE" size="2" type="STRING"/>
					<colinfo id="CODE_NAME" size="50" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_bdgbn_cd">
				<Contents>
					<colinfo id="CODE" size="2" type="STRING"/>
					<colinfo id="CODE_NAME" size="50" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list_build">
				<Contents>
					<colinfo id="BUILDUSE" size="256" type="STRING"/>
					<colinfo id="STEXT" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond_build">
				<Contents>
					<colinfo id="BUILDUSE" size="6" type="STRING"/>
					<colinfo id="STEXT" size="120" type="STRING"/>
					<colinfo id="WHERE" size="256" type="STRING"/>
					<record>
						<BUILDUSE></BUILDUSE>
						<STEXT></STEXT>
						<WHERE></WHERE>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_error_build">
				<Contents>
					<colinfo id="IDX" size="256" type="STRING"/>
					<colinfo id="ERRMSG" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_bdgbn_cd_grid">
				<Contents>
					<colinfo id="CODE" size="2" type="STRING"/>
					<colinfo id="CODE_NAME" size="50" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_region_cd_grid">
				<Contents>
					<colinfo id="CODE" size="2" type="STRING"/>
					<colinfo id="CODE_NAME" size="20" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list_build_grid">
				<Contents>
					<colinfo id="BUILDUSE" size="256" type="STRING"/>
					<colinfo id="STEXT" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list_zsvcgbn">
				<Contents>
					<colinfo id="CODE" size="2" type="STRING"/>
					<colinfo id="CODE_NAME" size="50" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list_zsvcgbn_grid">
				<Contents>
					<colinfo id="CODE" size="2" type="STRING"/>
					<colinfo id="CODE_NAME" size="50" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list_bill" OnColumnChanged="ds_list_bill_OnColumnChanged">
				<Contents>
					<colinfo id="MANDT" size="3" type="STRING"/>
					<colinfo id="GBN" size="1" type="STRING"/>
					<colinfo id="GBN_NM" size="10" type="STRING"/>
					<colinfo id="AMT00" size="15" type="DECIMAL"/>
					<colinfo id="AMT01" size="15" type="DECIMAL"/>
					<colinfo id="AMT02" size="15" type="DECIMAL"/>
					<colinfo id="AMT03" size="15" type="DECIMAL"/>
					<colinfo id="AMT04" size="15" type="DECIMAL"/>
					<colinfo id="AMT05" size="15" type="DECIMAL"/>
					<colinfo id="AMT06" size="15" type="DECIMAL"/>
					<colinfo id="AMT07" size="15" type="DECIMAL"/>
					<colinfo id="AMT08" size="15" type="DECIMAL"/>
					<colinfo id="AMT09" size="15" type="DECIMAL"/>
					<colinfo id="AMT10" size="15" type="DECIMAL"/>
					<colinfo id="AMT11" size="15" type="DECIMAL"/>
					<colinfo id="AMT12" size="15" type="DECIMAL"/>
					<colinfo id="AMT13" size="15" type="DECIMAL"/>
					<colinfo id="AMT14" size="15" type="DECIMAL"/>
					<colinfo id="AMT15" size="15" type="DECIMAL"/>
					<colinfo id="AMT16" size="15" type="DECIMAL"/>
					<colinfo id="AMT17" size="15" type="DECIMAL"/>
					<colinfo id="AMT18" size="15" type="DECIMAL"/>
					<colinfo id="AMT19" size="15" type="DECIMAL"/>
					<colinfo id="AMT20" size="15" type="DECIMAL"/>
					<colinfo id="AMT21" size="15" type="DECIMAL"/>
					<colinfo id="AMT22" size="15" type="DECIMAL"/>
					<colinfo id="AMT23" size="15" type="DECIMAL"/>
					<colinfo id="AMT24" size="15" type="DECIMAL"/>
					<colinfo id="AMT25" size="15" type="DECIMAL"/>
					<colinfo id="AMT26" size="15" type="DECIMAL"/>
					<colinfo id="AMT27" size="15" type="DECIMAL"/>
					<colinfo id="AMT28" size="15" type="DECIMAL"/>
					<colinfo id="AMT29" size="15" type="DECIMAL"/>
					<colinfo id="USER_ID" size="10" type="STRING"/>
					<record>
						<AMT00/>
						<AMT01/>
						<AMT02/>
						<AMT03/>
						<AMT04/>
						<AMT05/>
						<AMT06/>
						<AMT07/>
						<AMT08/>
						<AMT09/>
						<AMT10/>
						<AMT11/>
						<AMT12/>
						<AMT13/>
						<AMT14/>
						<AMT15/>
						<AMT16/>
						<AMT17/>
						<AMT18/>
						<AMT19/>
						<AMT20/>
						<AMT21/>
						<AMT22/>
						<AMT23/>
						<AMT24/>
						<AMT25/>
						<AMT26/>
						<AMT27/>
						<AMT28/>
						<AMT29/>
						<GBN></GBN>
						<GBN_NM></GBN_NM>
						<MANDT></MANDT>
						<USER_ID></USER_ID>
					</record>
					<record>
						<AMT00/>
						<AMT01/>
						<AMT02/>
						<AMT03/>
						<AMT04/>
						<AMT05/>
						<AMT06/>
						<AMT07/>
						<AMT08/>
						<AMT09/>
						<AMT10/>
						<AMT11/>
						<AMT12/>
						<AMT13/>
						<AMT14/>
						<AMT15/>
						<AMT16/>
						<AMT17/>
						<AMT18/>
						<AMT19/>
						<AMT20/>
						<AMT21/>
						<AMT22/>
						<AMT23/>
						<AMT24/>
						<AMT25/>
						<AMT26/>
						<AMT27/>
						<AMT28/>
						<AMT29/>
						<GBN></GBN>
						<GBN_NM></GBN_NM>
						<MANDT></MANDT>
						<USER_ID></USER_ID>
					</record>
				</Contents>
			</Dataset>
		</Datasets>
		<Shape BKColor="user0" Bottom="51" Height="51" Id="Shape1" Left="0" LineColor="user1" Right="978" TabOrder="1" Top="0" Type="Rectangle" Width="978"></Shape>
		<Grid AutoEnter="TRUE" AutoFitEndLine="Hide" BindDataset="ds_list" BkColor2="default" BoldHead="true" Border="Flat" Bottom="459" ColSizing="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="403" Id="grd_list" InputPanel="FALSE" Left="8" LineColor="user20" LineType="ExHORZ" OnHeadClick="grd_list_OnHeadClick" OnKeyDown="grd_list_OnKeyDown" Right="971" RowHeight="20" Style="sty_grid" TabOrder="6" TabStop="true" Top="56" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="963">
			<contents>
				<format id="Default">
					<columns>
						<col width="40"/>
						<col width="0"/>
						<col width="33"/>
						<col width="149"/>
						<col width="158"/>
						<col width="55"/>
						<col width="55"/>
						<col width="52"/>
						<col width="87"/>
						<col width="99"/>
						<col width="65"/>
						<col width="73"/>
						<col width="48"/>
						<col width="124"/>
						<col width="105"/>
						<col width="69"/>
						<col width="69"/>
						<col width="69"/>
						<col width="69"/>
						<col width="87"/>
						<col width="45"/>
						<col width="53"/>
						<col width="86"/>
						<col width="63"/>
						<col width="41"/>
					</columns>
					<head>
						<cell align="center" bkimageid="icon_grid_sel" col="0" color="user21" display="text" font="굴림,9"/>
						<cell align="center" bkimageid="icon_grid_sel" col="1" color="user21" display="text" font="굴림,9"/>
						<cell align="center" col="2" color="user21" display="text" font="굴림,9" text="변경"/>
						<cell align="center" col="3" color="user21" display="text" font="굴림,9" text="보수프로젝트"/>
						<cell align="center" col="4" color="user21" display="text" font="굴림,9" text="보수호기번호"/>
						<cell align="center" col="5" color="user21" display="text" font="굴림,9" text="편성년도"/>
						<cell align="center" col="6" color="user21" display="text" font="굴림,9" text="계획년월"/>
						<cell align="center" col="7" color="user21" display="text" font="굴림,9" text="제품군"/>
						<cell align="center" col="8" color="user21" display="text" font="굴림,9" text="부서"/>
						<cell align="center" col="9" color="user21" display="text" font="굴림,9" text="팀"/>
						<cell align="center" col="10" color="user21" display="text" font="굴림,9" text="담당자"/>
						<cell align="center" col="11" color="user21" display="text" font="굴림,9" text="담당자명"/>
						<cell align="center" col="12" color="user21" display="text" font="굴림,9" text="고객"/>
						<cell align="center" col="13" color="user21" display="text" font="굴림,9" text="고객명"/>
						<cell align="center" col="14" color="user21" display="text" font="굴림,9" text="공사명"/>
						<cell align="center" col="15" color="user21" display="text" font="굴림,9" text="설치지역"/>
						<cell align="center" col="16" color="user21" display="text" font="굴림,9" text="빌딩구분"/>
						<cell align="center" col="17" color="user21" display="text" font="굴림,9" text="건물용도"/>
						<cell align="center" col="18" color="user21" display="text" font="굴림,9" text="보수구분"/>
						<cell align="center" col="19" color="user21" display="text" font="굴림,9" text="기종"/>
						<cell align="center" col="20" color="user21" display="text" font="굴림,9" text="대수"/>
						<cell align="center" col="21" color="user21" display="text" font="굴림,9" text="단납구분"/>
						<cell align="center" col="22" color="user21" display="text" font="굴림,9" text="수주예상액"/>
						<cell align="center" col="23" color="user21" display="text" font="굴림,9" text="예상시행율"/>
						<cell align="center" col="24" color="user21" display="text" font="굴림,9" text="통화"/>
					</head>
					<body>
						<cell align="center" col="0" expr="currow+1"/>
						<cell align="center" bkcolor2="user22" col="1" colid="CHK" display='expr:decode(F_CLOSE_YN,&quot;Y&quot;,&quot;text&quot;,&quot;checkbox&quot;)' edit='expr:decode(F_CLOSE_YN,&quot;Y&quot;,&quot;none&quot;,&quot;checkbox&quot;)' expr="iif(currow=ds_list.row,&#32;1,&#32;0)"/>
						<cell align="center" bkcolor2="user22" bkimageid='expr:gfn_getFlagBkImageID(getColumn(currow,&#32;&quot;FLAG&quot;))' col="2" colid="FLAG" display="image"/>
						<cell align="left" autosizing="none" bkcolor2="user22" checklength="Byte" col="3" colid="PSPIDSV" display="text"/>
						<cell align="left" autosizing="none" bkcolor2="user22" checklength="Byte" col="4" colid="ZHOGISV" display="text"/>
						<cell align="center" autosizing="none" bkcolor2="user22" col="5" colid="ZPYEAR"/>
						<cell align="center" autosizing="none" bkcolor2="user22" col="6" colid="ZPYM" Mask="expr:gfn_getMaskDate(F_FORM_ID,6)"/>
						<cell align="center" autosizing="none" bkcolor2="user22" col="7" colid="SPART" combocol="CODE" combodataset="ds_list_spart" combodisplayrowcnt="20" combotext="CODE_NAME" display="combo"/>
						<cell align="left" autosizing="none" bkcolor2="user22" col="8" colid="VKBUR" combocol="CODE" combodataset="ds_list_vb" combodisplayrowcnt="20" combotext="CODE_NAME" display="combo"/>
						<cell align="left" autosizing="none" bkcolor2="user22" col="9" colid="VKGRP" combocol="CODE" combodataset="ds_list_vg" combodisplayrowcnt="20" combotext="CODE_NAME" display="combo"/>
						<cell align="center" autosizing="none" bkcolor2="user22" col="10" colid="ZKUNNR" display="text"/>
						<cell align="left" autosizing="none" bkcolor2="user22" col="11" colid="ZKUNNR_NM"/>
						<cell align="center" autosizing="none" bkcolor2="user22" col="12" colid="KUNNR" display="text"/>
						<cell align="left" autosizing="none" bkcolor2="user22" col="13" colid="KUNNR_NM"/>
						<cell align="left" autosizing="none" bkcolor2="user22" checklength="Byte" col="14" colid="GSNAM" display="text"/>
						<cell align="center" autosizing="none" bkcolor2="user22" col="15" colid="REGION" combocol="CODE" combodataset="ds_region_cd_grid" combodisplayrowcnt="20" combotext="CODE_NAME" display="combo"/>
						<cell align="center" autosizing="none" bkcolor2="user22" col="16" colid="ZBDGBN" combocol="CODE" combodataset="ds_bdgbn_cd_grid" combodisplayrowcnt="20" combotext="CODE_NAME" display="combo"/>
						<cell align="center" autosizing="none" bkcolor2="user22" col="17" colid="ZBDTYP" combocol="BUILDUSE" combodataset="ds_list_build_grid" combodisplayrowcnt="20" combotext="STEXT" display="combo"/>
						<cell align="center" autosizing="none" bkcolor2="user22" col="18" colid="ZSVCGBN" combocol="CODE" combodataset="ds_list_zsvcgbn_grid" combodisplayrowcnt="20" combotext="CODE_NAME" display="combo"/>
						<cell align="left" autosizing="none" bkcolor2="user22" checklength="Byte" col="19" colid="GTYPE" display="text"/>
						<cell align="center" autosizing="none" bkcolor2="user22" checklength="Byte" col="20" colid="ZNUMBER" display="number"/>
						<cell align="center" autosizing="none" bkcolor2="user22" col="21" colid="ZDELI" combocol="CODE" combodataset="ds_zdeli_cd" combodisplayrowcnt="20" combotext="CODE_NAME" display="combo"/>
						<cell align="right" autosizing="none" bkcolor2="user22" col="22" colid="SOFOCA" display="number"/>
						<cell align="right" autosizing="none" bkcolor2="user22" col="23" colid="ZFORE" display="text"/>
						<cell align="center" autosizing="none" bkcolor2="user22" col="24" colid="WAERK" combodisplayrowcnt="20" display="text"/>
					</body>
					<summary>
						<cell bkcolor="user25" col="0" color="user26" display="text">
							<cell align="center" col="0" color="user26" colspan="4" display="text" text="합계"/>
						</cell>
						<cell align="right" bkcolor="user25" col="1" color="user26" display="text"/>
						<cell align="right" bkcolor="user25" col="2" color="user26" display="text"/>
						<cell align="right" bkcolor="user25" col="3" color="user26" display="text"/>
						<cell align="right" bkcolor="user25" col="4" color="user26" display="text"/>
						<cell align="right" bkcolor="user25" col="5" color="user26" display="text"/>
						<cell align="right" bkcolor="user25" col="6" color="user26" display="text"/>
						<cell align="right" bkcolor="user25" col="7" color="user26" display="text"/>
						<cell align="right" bkcolor="user25" col="8" color="user26" display="text"/>
						<cell align="right" bkcolor="user25" col="9" color="user26" display="text"/>
						<cell align="right" bkcolor="user25" col="10" color="user26" display="text"/>
						<cell align="right" bkcolor="user25" col="11" color="user26" display="text"/>
						<cell align="right" bkcolor="user25" col="12" color="user26" display="text"/>
						<cell align="right" bkcolor="user25" col="13" color="user26" display="text"/>
						<cell align="right" bkcolor="user25" col="14" color="user26" display="text"/>
						<cell align="right" bkcolor="user25" col="15" color="user26" display="text"/>
						<cell align="right" bkcolor="user25" col="16" color="user26" display="text"/>
						<cell align="right" bkcolor="user25" col="17" color="user26" display="text"/>
						<cell align="right" bkcolor="user25" col="18" color="user26" display="text"/>
						<cell align="right" bkcolor="user25" col="19" color="user26" display="text"/>
						<cell align="right" bkcolor="user25" col="20" color="user26" display="number" expr='SUM(&quot;ZNUMBER&quot;)'/>
						<cell align="right" bkcolor="user25" col="21" color="user26" display="text"/>
						<cell align="right" bkcolor="user25" col="22" color="user26" display="number" expr='SUM(&quot;SOFOCA&quot;)'/>
						<cell align="right" bkcolor="user25" col="23" color="user26" display="number" expr='ROUND(SUM(&quot;ZFORE&quot;)&#32;/&#32;parseInt(ds_list.Rowcount()),&#32;2)'/>
						<cell align="right" bkcolor="user25" col="24" color="user26" display="text"/>
					</summary>
				</format>
			</contents>
		</Grid>
		<Calendar Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Dateformat="yyyy.MM" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="22" Id="cal_zpym" Left="87" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_search_ind" SundayTextColor="user35" TabOrder="2" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="27" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="77"></Calendar>
		<Static Align="Right" Height="20" Id="st_cal_zpym" Left="5" Style="sty_lb_search" TabOrder="3" Text="계획년월&#32;" Top="27" VAlign="Middle" Width="80"></Static>
		<Button Appearance="FLAT" ButtonStyle="TRUE" Color="user5" Cursor="HAND" DomainID="btn.query" Height="22" Id="btn_query" ImageID="btn_comm_query_k" Left="817" LeftMargin="20" OnClick="fn_OnClick_btn" TabOrder="7" TabStop="FALSE" Text="조회" Top="4" Visible="FALSE" Width="52"></Button>
		<Div BKColor="user0" Height="22" Id="div_sman" Left="794" OnLoadCompleted="fn_OnLoadCompleted" TabOrder="5" Text="Div0" Top="27" Url="COM::Coms002.xml" Width="164">
			<Contents></Contents>
		</Div>
		<Static Align="Right" Height="20" Id="st_sman" Left="712" Style="sty_lb_search" TabOrder="6" Text="담당자&#32;" Top="27" VAlign="Middle" Width="80"></Static>
		<Static Align="Right" Height="20" Id="st_i_spart" Left="166" Style="sty_lb_search" TabOrder="7" Text="제품군&#32;" Top="27" VAlign="Middle" Width="80"></Static>
		<Combo Border="Flat" CodeColumn="CODE" DataColumn="CODE_NAME" Height="20" Id="cb_spart" InnerDataset="ds_list_spart" Left="247" Style="sty_ipt_form" TabOrder="3" Top="26" Width="104"></Combo>
		<Button Appearance="FLAT" ButtonStyle="TRUE" Color="user5" Cursor="HAND" DomainID="btn.save" Height="22" Id="btn_save" ImageID="btn_comm_save_k" Left="869" LeftMargin="20" OnClick="fn_OnClick_btn" TabOrder="9" TabStop="FALSE" Text="저장" Top="4" Visible="FALSE" Width="52"></Button>
		<Edit Align="CENTER" Border="Flat" Enable="FALSE" Height="20" Id="ed_opendtm" Left="166" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="10" TabStop="FALSE" Text="사업계획&#32;오픈&#32;:&#32;" Top="5" Width="183"></Edit>
		<Calendar Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Dateformat="yyyy" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_zpyear" Left="87" MonthPickerFormat="yyyy년" MonthPopupBorder="FLAT" OnChanged="cal_zpyear_OnChanged" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_search_ind" SundayTextColor="user35" TabOrder="1" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="5" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="77"></Calendar>
		<Static Align="Right" Height="20" Id="st_cal_zpyear" Left="5" Style="sty_lb_search" TabOrder="10" Text="편성년도&#32;" Top="5" VAlign="Middle" Width="80"></Static>
		<Button Appearance="FLAT" ButtonStyle="TRUE" Color="user5" Cursor="HAND" DomainID="btn.excel" Height="22" Id="btn_excel" ImageID="btn_comm_excel_k" Left="920" LeftMargin="20" OnClick="fn_OnClick_btn" TabOrder="11" TabStop="FALSE" Text="엑셀" Top="5" Visible="FALSE" Width="52"></Button>
		<Button Appearance="FLAT" ButtonStyle="TRUE" Color="user5" Cursor="HAND" DomainID="btn.close" Height="22" Id="btn_close" ImageID="btn_comm_close_k" Left="921" LeftMargin="20" OnClick="fn_OnClick_btn" TabOrder="8" TabStop="FALSE" Text="닫기" Top="28" Visible="FALSE" Width="52"></Button>
		<Static Align="Right" Height="20" Id="Static4" Left="351" Style="sty_lb_search" TabOrder="17" Text="부서/팀&#32;" Top="27" VAlign="Middle" Width="80"></Static>
		<Div BKColor="user0" Height="20" Id="div_vbvg" Left="433" OnLoadCompleted="fn_OnLoadCompleted" OnTimer="WB0199010A_OnTimer" TabOrder="4" Text="Div0" Top="27" Url="COM::Coms011.xml" Width="280">
			<Contents></Contents>
		</Div>
		<Grid AutoEnter="TRUE" AutoFitEndLine="Hide" BindDataset="ds_list_bill" BkColor2="default" BoldHead="true" Border="Flat" Bottom="543" ColSelect="TRUE" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="79" Id="grd_list_detail" InputPanel="FALSE" Left="8" LineColor="user20" LineType="ExHORZ" OnHeadClick="grd_list_detail_OnHeadClick" OnKeyDown="grd_list_detail_OnKeyDown" Right="980" RowHeight="20" Style="sty_grid" TabOrder="18" TabStop="true" Top="464" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="972">
			<contents>
				<format id="Default">
					<columns>
						<col width="36"/>
						<col width="100"/>
						<col width="68"/>
						<col width="68"/>
						<col width="68"/>
						<col width="68"/>
						<col width="68"/>
						<col width="68"/>
						<col width="68"/>
						<col width="68"/>
						<col width="68"/>
						<col width="68"/>
						<col width="68"/>
						<col width="68"/>
						<col width="68"/>
						<col width="68"/>
						<col width="68"/>
						<col width="68"/>
						<col width="68"/>
						<col width="68"/>
						<col width="68"/>
						<col width="68"/>
						<col width="68"/>
						<col width="68"/>
						<col width="68"/>
						<col width="68"/>
						<col width="68"/>
						<col width="68"/>
						<col width="68"/>
						<col width="68"/>
						<col width="68"/>
						<col width="68"/>
					</columns>
					<head>
						<cell align="center" bkimageid="icon_grid_sel" col="0" display="text" font="굴림,9"/>
						<cell align="center" col="1" display="text" font="굴림,9" text="합계"/>
						<cell align="center" col="2" color='expr:decode(F_CLOSE_YN,&quot;Y&quot;,GC_FONTCOLOR_EDITABLE_F,GC_FONTCOLOR_EDITABLE_T)' display="text" font="굴림,9" text="M+0"/>
						<cell align="center" col="3" color='expr:decode(F_CLOSE_YN,&quot;Y&quot;,GC_FONTCOLOR_EDITABLE_F,GC_FONTCOLOR_EDITABLE_T)' display="text" font="굴림,9" text="M+1"/>
						<cell align="center" col="4" color='expr:decode(F_CLOSE_YN,&quot;Y&quot;,GC_FONTCOLOR_EDITABLE_F,GC_FONTCOLOR_EDITABLE_T)' display="text" font="굴림,9" text="M+2"/>
						<cell align="center" col="5" color='expr:decode(F_CLOSE_YN,&quot;Y&quot;,GC_FONTCOLOR_EDITABLE_F,GC_FONTCOLOR_EDITABLE_T)' display="text" font="굴림,9" text="M+3"/>
						<cell align="center" col="6" color='expr:decode(F_CLOSE_YN,&quot;Y&quot;,GC_FONTCOLOR_EDITABLE_F,GC_FONTCOLOR_EDITABLE_T)' display="text" font="굴림,9" text="M+4"/>
						<cell align="center" col="7" color='expr:decode(F_CLOSE_YN,&quot;Y&quot;,GC_FONTCOLOR_EDITABLE_F,GC_FONTCOLOR_EDITABLE_T)' display="text" font="굴림,9" text="M+5"/>
						<cell align="center" col="8" color='expr:decode(F_CLOSE_YN,&quot;Y&quot;,GC_FONTCOLOR_EDITABLE_F,GC_FONTCOLOR_EDITABLE_T)' display="text" font="굴림,9" text="M+6"/>
						<cell align="center" col="9" color='expr:decode(F_CLOSE_YN,&quot;Y&quot;,GC_FONTCOLOR_EDITABLE_F,GC_FONTCOLOR_EDITABLE_T)' display="text" font="굴림,9" text="M+7"/>
						<cell align="center" col="10" color='expr:decode(F_CLOSE_YN,&quot;Y&quot;,GC_FONTCOLOR_EDITABLE_F,GC_FONTCOLOR_EDITABLE_T)' display="text" font="굴림,9" text="M+8"/>
						<cell align="center" col="11" color='expr:decode(F_CLOSE_YN,&quot;Y&quot;,GC_FONTCOLOR_EDITABLE_F,GC_FONTCOLOR_EDITABLE_T)' display="text" font="굴림,9" text="M+9"/>
						<cell align="center" col="12" color='expr:decode(F_CLOSE_YN,&quot;Y&quot;,GC_FONTCOLOR_EDITABLE_F,GC_FONTCOLOR_EDITABLE_T)' display="text" font="굴림,9" text="M+10"/>
						<cell align="center" col="13" color='expr:decode(F_CLOSE_YN,&quot;Y&quot;,GC_FONTCOLOR_EDITABLE_F,GC_FONTCOLOR_EDITABLE_T)' display="text" font="굴림,9" text="M+11"/>
						<cell align="center" col="14" color='expr:decode(F_CLOSE_YN,&quot;Y&quot;,GC_FONTCOLOR_EDITABLE_F,GC_FONTCOLOR_EDITABLE_T)' display="text" font="굴림,9" text="M+12"/>
						<cell align="center" col="15" color='expr:decode(F_CLOSE_YN,&quot;Y&quot;,GC_FONTCOLOR_EDITABLE_F,GC_FONTCOLOR_EDITABLE_T)' display="text" font="굴림,9" text="M+13"/>
						<cell align="center" col="16" color='expr:decode(F_CLOSE_YN,&quot;Y&quot;,GC_FONTCOLOR_EDITABLE_F,GC_FONTCOLOR_EDITABLE_T)' display="text" font="굴림,9" text="M+14"/>
						<cell align="center" col="17" color='expr:decode(F_CLOSE_YN,&quot;Y&quot;,GC_FONTCOLOR_EDITABLE_F,GC_FONTCOLOR_EDITABLE_T)' display="text" font="굴림,9" text="M+15"/>
						<cell align="center" col="18" color='expr:decode(F_CLOSE_YN,&quot;Y&quot;,GC_FONTCOLOR_EDITABLE_F,GC_FONTCOLOR_EDITABLE_T)' display="text" font="굴림,9" text="M+16"/>
						<cell align="center" col="19" color='expr:decode(F_CLOSE_YN,&quot;Y&quot;,GC_FONTCOLOR_EDITABLE_F,GC_FONTCOLOR_EDITABLE_T)' display="text" font="굴림,9" text="M+17"/>
						<cell align="center" col="20" color='expr:decode(F_CLOSE_YN,&quot;Y&quot;,GC_FONTCOLOR_EDITABLE_F,GC_FONTCOLOR_EDITABLE_T)' display="text" font="굴림,9" text="M+18"/>
						<cell align="center" col="21" color='expr:decode(F_CLOSE_YN,&quot;Y&quot;,GC_FONTCOLOR_EDITABLE_F,GC_FONTCOLOR_EDITABLE_T)' display="text" font="굴림,9" text="M+19"/>
						<cell align="center" col="22" color='expr:decode(F_CLOSE_YN,&quot;Y&quot;,GC_FONTCOLOR_EDITABLE_F,GC_FONTCOLOR_EDITABLE_T)' display="text" font="굴림,9" text="M+20"/>
						<cell align="center" col="23" color='expr:decode(F_CLOSE_YN,&quot;Y&quot;,GC_FONTCOLOR_EDITABLE_F,GC_FONTCOLOR_EDITABLE_T)' display="text" font="굴림,9" text="M+21"/>
						<cell align="center" col="24" color='expr:decode(F_CLOSE_YN,&quot;Y&quot;,GC_FONTCOLOR_EDITABLE_F,GC_FONTCOLOR_EDITABLE_T)' display="text" font="굴림,9" text="M+22"/>
						<cell align="center" col="25" color='expr:decode(F_CLOSE_YN,&quot;Y&quot;,GC_FONTCOLOR_EDITABLE_F,GC_FONTCOLOR_EDITABLE_T)' display="text" font="굴림,9" text="M+23"/>
						<cell align="center" col="26" color='expr:decode(F_CLOSE_YN,&quot;Y&quot;,GC_FONTCOLOR_EDITABLE_F,GC_FONTCOLOR_EDITABLE_T)' display="text" font="굴림,9" text="M+24"/>
						<cell align="center" col="27" color='expr:decode(F_CLOSE_YN,&quot;Y&quot;,GC_FONTCOLOR_EDITABLE_F,GC_FONTCOLOR_EDITABLE_T)' display="text" font="굴림,9" text="M+25"/>
						<cell align="center" col="28" color='expr:decode(F_CLOSE_YN,&quot;Y&quot;,GC_FONTCOLOR_EDITABLE_F,GC_FONTCOLOR_EDITABLE_T)' display="text" font="굴림,9" text="M+26"/>
						<cell align="center" col="29" color='expr:decode(F_CLOSE_YN,&quot;Y&quot;,GC_FONTCOLOR_EDITABLE_F,GC_FONTCOLOR_EDITABLE_T)' display="text" font="굴림,9" text="M+27"/>
						<cell align="center" col="30" color='expr:decode(F_CLOSE_YN,&quot;Y&quot;,GC_FONTCOLOR_EDITABLE_F,GC_FONTCOLOR_EDITABLE_T)' display="text" font="굴림,9" text="M+28"/>
						<cell align="center" col="31" color='expr:decode(F_CLOSE_YN,&quot;Y&quot;,GC_FONTCOLOR_EDITABLE_F,GC_FONTCOLOR_EDITABLE_T)' display="text" font="굴림,9" text="M+29"/>
					</head>
					<body>
						<cell align="center" bkcolor="aliceblue" col="0" colid="GBN_NM"/>
						<cell align="right" bkcolor="user25" col="1" display="number" expr="AMT00+AMT01+AMT02+AMT03+AMT04+AMT05+AMT06+AMT07+AMT08+AMT09+AMT10+AMT11+AMT12+AMT13+AMT14+AMT15+AMT16+AMT17+AMT18+AMT19+AMT20+AMT21+AMT22+AMT23+AMT24+AMT25+AMT26+AMT27+AMT28+AMT29" limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="2" colid="AMT00" display="number" edit='expr:decode(F_CLOSE_YN,&quot;Y&quot;,&quot;none&quot;,&#32;&quot;normal&quot;)' limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="3" colid="AMT01" display="number" edit='expr:decode(F_CLOSE_YN,&quot;Y&quot;,&quot;none&quot;,&#32;&quot;normal&quot;)' limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="4" colid="AMT02" display="number" edit='expr:decode(F_CLOSE_YN,&quot;Y&quot;,&quot;none&quot;,&#32;&quot;normal&quot;)' limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="5" colid="AMT03" display="number" edit='expr:decode(F_CLOSE_YN,&quot;Y&quot;,&quot;none&quot;,&#32;&quot;normal&quot;)' limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="6" colid="AMT04" display="number" edit='expr:decode(F_CLOSE_YN,&quot;Y&quot;,&quot;none&quot;,&#32;&quot;normal&quot;)' limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="7" colid="AMT05" display="number" edit='expr:decode(F_CLOSE_YN,&quot;Y&quot;,&quot;none&quot;,&#32;&quot;normal&quot;)' limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="8" colid="AMT06" display="number" edit='expr:decode(F_CLOSE_YN,&quot;Y&quot;,&quot;none&quot;,&#32;&quot;normal&quot;)' limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="9" colid="AMT07" display="number" edit='expr:decode(F_CLOSE_YN,&quot;Y&quot;,&quot;none&quot;,&#32;&quot;normal&quot;)' limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="10" colid="AMT08" display="number" edit='expr:decode(F_CLOSE_YN,&quot;Y&quot;,&quot;none&quot;,&#32;&quot;normal&quot;)' limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="11" colid="AMT09" display="number" edit='expr:decode(F_CLOSE_YN,&quot;Y&quot;,&quot;none&quot;,&#32;&quot;normal&quot;)' limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="12" colid="AMT10" display="number" edit='expr:decode(F_CLOSE_YN,&quot;Y&quot;,&quot;none&quot;,&#32;&quot;normal&quot;)' limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="13" colid="AMT11" display="number" edit='expr:decode(F_CLOSE_YN,&quot;Y&quot;,&quot;none&quot;,&#32;&quot;normal&quot;)' limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="14" colid="AMT12" display="number" edit='expr:decode(F_CLOSE_YN,&quot;Y&quot;,&quot;none&quot;,&#32;&quot;normal&quot;)' limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="15" colid="AMT13" display="number" edit='expr:decode(F_CLOSE_YN,&quot;Y&quot;,&quot;none&quot;,&#32;&quot;normal&quot;)' limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="16" colid="AMT14" display="number" edit='expr:decode(F_CLOSE_YN,&quot;Y&quot;,&quot;none&quot;,&#32;&quot;normal&quot;)' limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="17" colid="AMT15" display="number" edit='expr:decode(F_CLOSE_YN,&quot;Y&quot;,&quot;none&quot;,&#32;&quot;normal&quot;)' limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="18" colid="AMT16" display="number" edit='expr:decode(F_CLOSE_YN,&quot;Y&quot;,&quot;none&quot;,&#32;&quot;normal&quot;)' limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="19" colid="AMT17" display="number" edit='expr:decode(F_CLOSE_YN,&quot;Y&quot;,&quot;none&quot;,&#32;&quot;normal&quot;)' limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="20" colid="AMT18" display="number" edit='expr:decode(F_CLOSE_YN,&quot;Y&quot;,&quot;none&quot;,&#32;&quot;normal&quot;)' limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="21" colid="AMT19" display="number" edit='expr:decode(F_CLOSE_YN,&quot;Y&quot;,&quot;none&quot;,&#32;&quot;normal&quot;)' limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="22" colid="AMT20" display="number" edit='expr:decode(F_CLOSE_YN,&quot;Y&quot;,&quot;none&quot;,&#32;&quot;normal&quot;)' limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="23" colid="AMT21" display="number" edit='expr:decode(F_CLOSE_YN,&quot;Y&quot;,&quot;none&quot;,&#32;&quot;normal&quot;)' limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="24" colid="AMT22" display="number" edit='expr:decode(F_CLOSE_YN,&quot;Y&quot;,&quot;none&quot;,&#32;&quot;normal&quot;)' limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="25" colid="AMT23" display="number" edit='expr:decode(F_CLOSE_YN,&quot;Y&quot;,&quot;none&quot;,&#32;&quot;normal&quot;)' limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="26" colid="AMT24" display="number" edit='expr:decode(F_CLOSE_YN,&quot;Y&quot;,&quot;none&quot;,&#32;&quot;normal&quot;)' limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="27" colid="AMT25" display="number" edit='expr:decode(F_CLOSE_YN,&quot;Y&quot;,&quot;none&quot;,&#32;&quot;normal&quot;)' limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="28" colid="AMT26" display="number" edit='expr:decode(F_CLOSE_YN,&quot;Y&quot;,&quot;none&quot;,&#32;&quot;normal&quot;)' limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="29" colid="AMT27" display="number" edit='expr:decode(F_CLOSE_YN,&quot;Y&quot;,&quot;none&quot;,&#32;&quot;normal&quot;)' limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="30" colid="AMT28" display="number" edit='expr:decode(F_CLOSE_YN,&quot;Y&quot;,&quot;none&quot;,&#32;&quot;normal&quot;)' limit="13" LimitDec="0"/>
						<cell align="right" bkcolor2="user22" col="31" colid="AMT29" display="number" edit='expr:decode(F_CLOSE_YN,&quot;Y&quot;,&quot;none&quot;,&#32;&quot;normal&quot;)' limit="13" LimitDec="0"/>
					</body>
				</format>
			</contents>
		</Grid>
	</Form>
	<Script><![CDATA[/*
 ******************************************************************************************
 * 기      능   : 사업계획매출채권관리(정기보수) (Sbp0050)
 * 작  성  자   : 구란이
 * 작성  일자   : 2012.08.21
 * ----------------------------------------------------------------------------------------
 * HISTORY    : V1.0 : 2012.09.03 : 신규
 * COMMENT
   0. T-CODE                : 
   1. WFC URL 				: 
   2. WFC OPERATION NAME 	: 
   3. WFC OBJ NAME 			: 
   4. 개발자료 :   
 ******************************************************************************************
*/
#include "LIB::commons.js";			// 공통 스크립트  
#include "LIB::nsfRequest.js";		// 공통 스크립트  /* GNY 추가 */
#include "LIB::common_hdel.js";		// 공통 스크립트  /* GNY 추가 */

//=========================================================================================
// [ PART 1 ]
// Form에서 사용될 전역변수를 선언
// FORM에서 사용되는 전역변수는 대문자로 작성하며, F_XXX 의 형태를 갖도록 한다. 
//=========================================================================================
var F_FORM_ID 			= "Sbp0050";   

// 컬럼번호
var F_COLNUM_CHK		= "";  	// 선택여부
var F_COLNUM_FLAG		= "";  	// 변경구분
var F_COLNUM_PSPIDSV 	= "";   // 보수프로젝트번호   
var F_COLNUM_ZHOGISV 	= "";   // 보수호기번호 
var F_COLNUM_ZPYEAR		= "";  	// 편성년도
var F_COLNUM_ZPYM		= "";  	// 계획년월
var F_COLNUM_SPART 		= "";  	// 제품군
var F_COLNUM_VKBUR 		= "";  	// 사업장 
var F_COLNUM_VKGRP 		= "";  	// 영업그룹
var F_COLNUM_ZKUNNR 	= "";  	// 담당자  
var F_COLNUM_ZKUNNR_NM 	= "";  	// 담당자명
var F_COLNUM_KUNNR 		= "";  	// 거래선
var F_COLNUM_KUNNR_NM 	= "";  	// 거래선명 
var F_COLNUM_GSNAM      = ""; 	// 공사명
var F_COLNUM_REGION     = ""; 	// 설치지역
var F_COLNUM_1     		= ""; 	// 빌딩구분
var F_COLNUM_2     		= ""; 	// 건물용도
var F_COLNUM_GTYPE      = ""; 	// 기종 
var F_COLNUM_ZNUMBER    = ""; 	// 대수
var F_COLNUM_ZDELI      = ""; 	// 단납기구분 
var F_COLNUM_SOFOCA     = ""; 	// 수주예상액
var F_COLNUM_ZFORE      = ""; 	// 예상시행율
var F_COLNUM_WAERK      = ""; 	// 통화 
var F_COLNUM_ZRMK       = ""; 	// 비고
 
var F_COLNUM_TOT1      	 = 1;  // 매출청구수금 그리드 합계 
var F_COLNUM_YEAYM     	 = 2;  // 매출청구수금 그리드 기준년월
 
var F_CLOSE_YN 			= "Y";  		// 계획년월의 마감여부
var F_PSPIDSV			= "";			// 사업계획번호
var F_SYSDATE           = ""; 			// 현재년월일(8자리) 
var F_USER_GROUP_B 		= "";  			// 사용자권한 (G_USER_GROUP_B)
var F_WORK_GBN          = "";			// 어떤 버튼을 클릭했는지 구분(Q:조회, S:저장, D:삭제, E:엑셀)

var F_SAVE_ARR          = [ 
							"FLAG"
							,"ZPYEAR"
							,"ZPYM"
							,"SPART"
							,"VKBUR"
							,"VKGRP"
							,"ZKUNNR"
							,"GTYPE" 
							,"ZNUMBER"
							,"KUNNR"
							,"GSNAM"
							,"REGIO"
							,"1"
							,"2"
							,"ZDELI" 
							,"SOFOCA"
							,"ZFORE"
							,"WAERK" 
							,"ZRMK"
							];    // 저장 시 변경여부 체크할 항목들
var F_CHG_ARR          	= [
							 "ZPYEAR"
							,"ZPYM"
							,"SPART"
							,"VKBUR"
							,"VKGRP"
							,"ZKUNNR"
							,"GTYPE"
							,"TYPE1"
							,"TYPE2"
							,"TYPE3"
							,"ZNUMBER"
							,"KUNNR"
							,"GSNAM"
							,"REGIO"
							,"1"
							,"2"
							,"ZDELI" 
							,"SOFOCA"
							,"ZFORE"
							,"WAERK" 
							,"ZRMK"
							];		   // 변경 시 변경여부 체크할 항목들


// 서브화면 조정 필요시 값 입력, 불필요 시 ""   
var F_SMAN_WIDTH 	= "132";  	// 담당자코드 서브화면 폼 WIDTH
var F_SMAN_CD_WIDTH	= "111";  	// 담당자코드 서브화면 코드 WIDTH
var F_SMAN_NM_WIDTH	= "";  		// 담당자코드 서브화면 코드명 WIDTH 
// var F_VBVG_WIDTH 	= "";  	// 부서/팀코드 서브화면 폼 WIDTH
// var F_VBVG_VB_WIDTH	= "";  	// 부서/팀코드 서브화면 부서코드 WIDTH
// var F_VBVG_VG_WIDTH	= "";  	// 부서/팀코드 서브화면 팀코드 WIDTH
// var F_FRVB_ESSN_YN  = "";	// 시작부서코드 필수여부
// var F_TOVB_ESSN_YN  = "";	// 종료부서코드 필수여부
// var F_TOVB_HIDDEN_YN = "";	// 종료부서코드 숨김 여부

//=========================================================================================
// [ PART 2 ]
// Form Loading / Unloading 시 작업 정의
//=========================================================================================
function fn_OnLoadCompleted(obj) {
	
	gfn_initForm(true);   
	
	// 폼 초기화
	fn_init_form();
	
	/* list 코드 LOAD */ 
	gfn_SetListCode(F_FORM_ID, GC_CDGB_SPART	, ds_list_spart	, cb_spart 				, 0, "N", "Y");  	// 제품군_검색조건
	gfn_SetListCode(F_FORM_ID, GC_CDGB_REGION	, ds_region_cd	, div_detail.cb_region	, 0, "N", "Y");  	// 설치지역_저장항목
	gfn_SetListCode(F_FORM_ID, GC_CDGB_WAERK	, ds_waerk_cd	, div_detail.cb_waerk	, 0, "N", "Y");  	// 통화_저장항목
	gfn_SetListCode(F_FORM_ID, GC_CDGB_BDGBN	, ds_bdgbn_cd	, div_detail.cb_bdgbn	, 0, "N", "Y");  	// 빌딩구분_저장항목
 	
 	// 그리드용 list 코드 데이타셋
 	gfn_copyDs(ds_region_cd, ds_region_cd_grid, "CODE <> ''");	// 지역
 	gfn_copyDs(ds_bdgbn_cd , ds_bdgbn_cd_grid , "CODE <> ''");	// 빌딩구분
 
 	// 건물용도 콤보목록 조회
	nsfRequest("query"									// srvId
				, "com0160/find"						// url
				, "ds_cond_build=ds_cond_build ds_list_build=ds_list_build"		// inDsList
				, "ds_list_build=ds_list_build ds_error_build=ds_error_build"	// outDsList
				, ""									// strParam
				, "fn_afterQuery_bdtyp"						// CallBackFunc
				); 
				
	// 보수구분 콤보목록 조회
	ds_list_zsvcgbn.ClearData();
	ds_list_zsvcgbn.AddRow();
	ds_list_zsvcgbn.SetColumn(0, "CODE", "SD110");
	ds_list_zsvcgbn.SetColumn(0, "CODE_NAME", "SD110");
	nsfRequest("query"									// srvId 
				, "combo/comboXml"						// url
				, "ds_list_zsvcgbn=ds_list_zsvcgbn"		// inDsList
				, "ds_list_zsvcgbn=ds_list_zsvcgbn"	    // outDsList
				, ""									// strParam
				, "fn_afterQuery_zsvcgbn"				// CallBackFunc
				); 
	 
	
 	// 공통코드 콤보목록 조회
 	fn_query_dd07t("ZGTYPE"	, ds_gtype_cd	);		// 기종
 	fn_query_dd07t("ZDELI"	, ds_zdeli_cd	);		// 단납구분  

	// 그리드 콤보 조회 
 	fn_query_grid_vb();	// 부서전체목록	
 	fn_query_grid_vg();	// 팀전체목록 
}

/********************************************************************************
* 기      능   : 공통코드가 조회된 후의 Callback 함수 (common.js에서 호출됨)
********************************************************************************/
function fn_completeInit(sCode, sDsObj, sCodeType) {
	gfn_showMsg("CI00007");  
}

/********************************************************************************
* 기      능   : form UnloadCompleted 
********************************************************************************/
function fn_OnUnloadCompleted(obj) {
	return gfn_isFormUnload(obj);
}
 
//=========================================================================================
// [ PART 3 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,form닫기)
//=========================================================================================
/********************************************************************************
* 기      능   : 조회 1
********************************************************************************/
function fn_query() { 
	
	//trace("fn_query()호출 start");
	
	gfn_clearMsgBar(); 
	
	// sort mark 삭제 
	gfn_clearGridSortMark(grd_list); 
	
	// 조회조건 항목오류검증
	if (fn_valid_chk("query") == false)  return;
	
	// 조회조건에 해당하는 그리드 항목의 Width = 0 처리 
	var sman_cd = trim(div_sman.ed_sman_cd.text); 
	grd_list.SetColProp(F_COLNUM_SPART		, "Width", iif(length(cb_spart.Value)==0,52,0));	 	// 제품군
	grd_list.SetColProp(F_COLNUM_VKBUR		, "Width", iif(length(div_vbvg.cb_frvb.Value)==0,87,0));// 부서
	grd_list.SetColProp(F_COLNUM_VKGRP		, "Width", iif(length(div_vbvg.cb_frvg.Value)==0,99,0));// 팀
	grd_list.SetColProp(F_COLNUM_ZKUNNR		, "Width", iif(length(sman_cd)==0,65,0));				// 담당자코드
	grd_list.SetColProp(F_COLNUM_ZKUNNR_NM	, "Width", iif(length(sman_cd)==0,73,0));				// 담당자명 
  
	// 조회조건 설정
	ds_cond.ClearData();    
	if (fn_param_set("query") == false)  return;   
	//trace(ds_cond.SaveXML());
	
	// 그리드헤더 년월 (18개월)Set
	fn_grid_header_set();
	
	// 사업계획번호 초기화
	F_PSPIDSV = ""; 
	
	// 오픈인 경우 수정가능, 마감인 경우 수정불가
	fn_enable_set(false);   	
	
	// 서비스 호출
	fn_createWait("",this);     // 처리중입니다. 메시지 처리
	fn_query_saveAfter("fn_afterQuery");
 
}

/********************************************************************************
* 기      능   : 조회 1
********************************************************************************/
function fn_query_saveAfter(pCallback) { 
	
	//trace("fn_query_saveAfter()호출 start");
 
	// 데이타셋 이벤트 비활성화
	ds_list.Fireevent = false;  
	
	// 조회조건 설정
	ds_cond.ClearData();   
	if (fn_param_set("query") == false)  return;   
	//trace(ds_cond.SaveXML()); 
	
	// 오픈인 경우 수정가능, 마감인 경우 수정불가(default = false)
	fn_enable_set(false);    
	
	// 기종정보 초기화
	div_detail.ed_gtype_info.Text = ""; 
	 
	// 서비스 호출
	ds_list.ClearData();   
	ds_detail.ClearData();  
	ds_list_bill.ClearData();  
	ds_error.ClearData(); 
	nsfRequest("query"													// srvId
				, "sbp0050/find"										// url
				, "ds_cond=ds_cond ds_list=ds_list "					// inDsList
				, "ds_list=ds_list ds_error=ds_error"					// outDsList
				, ""													// strParam
				, pCallback												// CallBackFunc
				);
 
}
 
 

/********************************************************************************
* 기      능   : 매출/청구/수금 정보 조회
********************************************************************************/
function fn_query_bill() { 
	 
	trace("fn_query_bill()호출 start"); 
	
	gfn_clearMsgBar();  
	
	// 특정 판매문서유형인 경우 매출/청구/수금 정보조회 불필요
	//if (fn_bill_saveyn()=="N") return;
	
	// 조회조건 항목오류검증
	if (fn_valid_chk("query_bill") == false)  return;
	
	
	trace("fn_query_bill() fn_valid_chk ok"); 
	
	
	// 조회조건 설정
	ds_cond_detail.ClearData();   
	if (fn_param_set("query_bill") == false)  return;   
	trace(ds_cond_detail.SaveXML()); 
	
	// 사업계획번호 초기화
	F_PSPIDSV = "";
	
	// 데이타셋 이벤트 비활성화
	ds_list_bill.Fireevent = false; 
	  
	// 서비스 호출
	fn_createWait("",this);     // 처리중입니다. 메시지 처리
	ds_detail.ClearData();  
	ds_list_bill.ClearData();   
	ds_error.ClearData();  
	
	nsfRequest("query"													// srvId
				, "sbp0050/find_detail"									// url
				, "ds_cond_detail=ds_cond_detail ds_list_bill=ds_list_bill ds_yearm=ds_yearm"	// inDsList
				, "ds_detail=ds_detail ds_list_bill=ds_list_bill ds_error=ds_error"				// outDsList
				, ""													// strParam
				, "fn_afterQuery_bill"									// CallBackFunc
				);
 
}


// INPUT PARAM SET
// pProcGb : 처리구분 (query:조회)
function fn_param_set(pProcGb)
{   
	
	switch(pProcGb)
	{
		case "query" :  // 조회 시
			 
			ds_cond.AddRow();  
			
			ds_cond.SetColumn(0, "ZPYEAR"	, replace(trim(cal_zpyear.text),".","")	); 	// 편성년도   
			ds_cond.SetColumn(0, "ZPYM"		, replace(trim(cal_zpym.text),".","")	); 	// 계획년월   
			ds_cond.SetColumn(0, "SPART"	, trim(cb_spart.value)					);  // 제품군
			ds_cond.SetColumn(0, "VKBUR_FR"	, trim(div_vbvg.cb_frvb.Value)			);  // 부서코드_FR
			ds_cond.SetColumn(0, "VKBUR_TO"	, trim(div_vbvg.cb_frvb.Value)			);  // 부서코드_TO
			ds_cond.SetColumn(0, "VKGRP_FR"	, trim(div_vbvg.cb_frvg.Value)			);  // 팀코드_FR  
			ds_cond.SetColumn(0, "VKGRP_TO"	, trim(div_vbvg.cb_frvg.Value)			);  // 팀코드_TO  
			ds_cond.SetColumn(0, "ZKUNNR"	, trim(div_sman.ed_sman_cd.text)		);  // 담당자
			
			break;  
			
		case "query_bill" :  // 상세조회 시
			 
			ds_cond_detail.AddRow();  
			
			// 사업계획번호
			ds_cond_detail.SetColumn(0, "PSPIDSV", ds_list.GetColumn(ds_list.row, "PSPIDSV"));
			 	
			break;  	
			
		case "save" :  // 사업계획 저장 시  
			
			// 수주목록에서 선택한 사업계획번호에 해당하는 수주 항목을
			// 상세항목 데이타셋에 복사한다. (ds_list-->ds_detail) 
			ds_detail.AddRow(); 
			ds_list.CopyToRow(ds_list.row, ds_detail, ds_detail.row); 
			 
			// 매출/청구/수금 데이타 저장 여부 
			ds_detail.SetColumn(ds_detail.row, "BILL_SAVE_YN", fn_bill_saveyn()); 
				
			break;    
			
		default: 
			break; 
	}   

	return true;
	
}
/********************************************************************************
* 기      능   : 닫기  
********************************************************************************/
function fn_close() { 

	if (fn_valid_chk("close") == false) return false;

	close();
}

/********************************************************************************
* 기      능   : 복원 
********************************************************************************/
function fn_reset() 
{
	ds_list.Reset(); 
	ds_list_bill.Reset(); 
}

/********************************************************************************
* 기      능   : 액셀  
********************************************************************************/
function fn_excel() {
	
	//trace("fn_excel()호출 start");
 	
 	gfn_clearMsgBar(); 
 	
	// 조회조건 항목오류검증
	if (fn_valid_chk("excel") == false)  return; 
	
	// Excel Export  
	gfn_saveToExcel(grd_list, true); 
	
}


//=========================================================================================
// [ PART 3 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,form닫기)
//=========================================================================================
/********************************************************************************
* 기      능   : 저장 : 사업계획 등록, 수정, 삭제
********************************************************************************/
function fn_save() { 
	
	//trace("fn_save() start");
	
	gfn_clearMsgBar();   
	
	// 저장항목 오류검증
	if (fn_valid_chk("save") == false)  return false;
	
	// 저장여부 확인
	if (!gfn_showConfirm("CI00014", "사업계획 변경사항"))  return false;  
	
	// 사업계획번호 초기화
	F_PSPIDSV = "";
	
	// 저장항목 값설정  
	ds_detail.ClearData();
	if (fn_param_set("save") == false)  return false;    
	trace(ds_detail.SaveXML());
	
	// 서비스 호출 후 사업계획번호 GET
	ds_result.ClearData(); 
	ds_error.ClearData(); 
	fn_createWait("",this);     // 처리중입니다. 메시지 처리
	nsfRequest("update"																	// srvId
				, "sbp0050/save"													// url
				, "ds_detail=ds_detail ds_list_bill=ds_list_bill ds_yearm=ds_yearm ds_result=ds_result"	// inDsList
				, "ds_result=ds_result ds_error=ds_error"								// outDsList
				, ""																	// strParam
				, "fn_afterSave"														// CallBackFunc
				);

}
 
//=========================================================================================
// [ PART 4]
// Callback 함수 정의 : callback 함수명은 메인 함수의 fn_xxxx() 에서 xxxx 부분은 fn_afterXXXX()
// 형태가 되도록 작성 
//=========================================================================================
/********************************************************************************
* 기      능   : 조회 Callback  
********************************************************************************/
function fn_afterQuery(errCode, errMsg) {   
	
	fn_destroyWait(); 

	// 결과값 trace
	trace("fn_afterQuery 호출 start"); 
	trace(ds_list.SaveXML()); 
	trace(ds_error.SaveXML());
	
	// Action 버튼 구분자 SET
	F_WORK_GBN = "";
	
	ds_list.ApplyChange();
	
	// 데이타셋 이벤트 활성화
	ds_list.Fireevent = true;
	
	if(ds_error.rowcount() > 0) {   
	
		gfn_showMsgBar(ds_error.GetColumn(0,"ERRMSG"));   
		
	} else {
	 
		// 조회된 자료가 있을 경우 
		if (ds_list.RowCount() > 0) 
		{  
			gfn_showMsg("CI00001");  // CI00001: "조회를 완료했습니다
			
			grd_list.SetFocus();
			
			// 상세조회 실행  (강제로 매출/청구/수금 이벤트 발생시킴)
			var nRow = ds_list.FindRow("PSPIDSV", F_PSPIDSV);  // 기 작업한 보수프로젝트번호의 행번호
			ds_list.Fireevent = false;
			ds_list.row = iif(nRow > 0, nRow, 0); 
			ds_list.Fireevent = true;
			ds_list_OnRowPosChanged(ds_list, iif(nRow>0, -1, nRow), nRow);
			
		} 
		else 
		{	 
			gfn_showMsg("CW00010"); 					// CW00010 : "데이터가 없습니다."
		}
		 
		// 마감여부   
		F_CLOSE_YN = iif(ds_list_opendtm.RowCount() > 0, "N", "Y");  
			
		// 사업계획 오픈 여부에 따른 항목 enable setting
		// 오픈인 경우 수정가능, 마감인 경우 수정불가
		fn_enable_set(iif(F_CLOSE_YN=="Y", false, true));   	
	}
	
	//trace("fn_afterQuery 호출 end");
} 

/********************************************************************************
* 기      능   : 상세조회 Callback  
********************************************************************************/
function fn_afterQuery_bill(errCode, errMsg) {   
	
	fn_destroyWait(); 

	// 결과값 trace
	trace("fn_afterQuery_bill 호출 start"); 
	trace(ds_list_bill.SaveXML()); 
	trace(ds_error.SaveXML()); 
	
	ds_list_bill.ApplyChange();
	
	// 데이타셋 이벤트 활성화
	ds_list_bill.Fireevent = true;
	
	if(ds_error.rowcount() > 0) {   
	
		gfn_showMsgBar(ds_error.GetColumn(0,"ERRMSG"));   
		
	} else {  
		
		// 조회된 자료가 있을 경우 
		if (ds_list_bill.RowCount() > 0) 
		{ 
			gfn_showMsg("CI00001");  // CI00001: "조회를 완료했습니다.
		} 
		else 
		{	 
			gfn_showMsg("CW00010"); 		// CW00010 : "데이터가 없습니다."
		} 
		
		// 상세정보 SET
		fn_setDetailInfo(); 
	}
	
	//trace("fn_afterquery_bill 호출 end");
} 


/********************************************************************************
* 기      능   : 저장 Callback  
********************************************************************************/
function fn_afterSave(errCode, errMsg) {  
	 
	//trace("fn_afterSave 호출 start");  
	
	// alert("fn_afterSave.errCode : " + errCode);
	// alert("fn_afterSave.errMsg : " + errMsg);
	
	// trace(ds_error.SaveXML());
	// trace(ds_result.SaveXML());
	
	if(ds_error.rowcount() > 0) {   
	
		fn_destroyWait();
		gfn_showMsgBar(ds_error.GetColumn(0,"ERRMSG"), ds_error.GetColumn(0,"ERRCODE"));   
		
	} else {
	
		// 보수프로젝트번호 SET
		F_PSPIDSV = ds_result.GetColumn(ds_result.row, "PSPIDSV"); 
		
		//trace("fn_afterSave.F_PSPIDSV : " + F_PSPIDSV);  
		
		ds_list.ApplyChange(); 
		
		// 저장완료 후 재조회
		fn_query_saveAfter("fn_afterSave_requery");
	}
	
	//trace("fn_afterSave 호출 end");
}  


/********************************************************************************
* 기      능   : 저장 후 재조회 Callback  
********************************************************************************/
function fn_afterSave_requery(errCode, errMsg) { 

	fn_destroyWait(); 
	
	ds_list.Fireevent = true;
	
	//trace("fn_afterSave_requery 호출 start");    
	
	if(ds_error.rowcount() > 0) {   
	
		gfn_showMsgBar(ds_error.GetColumn(0,"ERRMSG"), ds_error.GetColumn(0,"ERRCODE"));   
		
	} else { 
			
		gfn_showMsg("CI00003");  // CI00003: "저장을 완료했습니다
		
		grd_list.SetFocus(); 
		
		// 상세조회 실행  (강제로 매출/청구/수금 이벤트 발생시킴)
		var nRow = ds_list.FindRow("PSPIDSV", F_PSPIDSV);  // 기 작업한 보수프로젝트번호의 행번호
		ds_list.Fireevent = false;
		ds_list.row = iif(nRow > 0, nRow, 0); 
		ds_list.Fireevent = true;
		ds_list_OnRowPosChanged(ds_list, iif(nRow>0, -1, nRow), nRow);
		
		// trace("fn_afterSave_requery.F_PSPIDSV : " + F_PSPIDSV);
		// trace("fn_afterSave_requery.nRow : " + nRow); 
		
		// 마감여부   (오픈일시 존재 시 마감여부='N')
		F_CLOSE_YN = iif(ds_list_opendtm.RowCount() > 0, "N", "Y");  
			
		// 사업계획 오픈 여부에 따른 항목 enable setting
		// 오픈인 경우 수정가능, 마감인 경우 수정불가
		fn_enable_set(iif(F_CLOSE_YN=="Y", false, true));   		
			
			
	}
	
	//trace("fn_afterSave_requery 호출 end");
} 
 
 
// 임시코딩
function fn_OnClick_btn(obj)
{ 
	var fncName = "fn_" + substr(obj.id, 4); 
	eval( fncName + "()");
}

// 항목 오류 검증
// pProcGb : 처리구분 (query:조회,excel:엑셀)
function fn_valid_chk(pProcGb)
{     

	var arr   		= "";
	var ChgYn 		= "N"; 
	var SaveCount 	= 0; 
	var nRow   		= -1;
	var flag 		= "";
			
 	switch(pProcGb)
	{
		
		case "query" :    	// 조회 버튼 클릭 시
		
			if (length(trim(cal_zpyear.Value)) == 0)
			{ 
				// CW00208 : "[${}]은/는 필수입력 입니다.확인바랍니다.")
				gfn_showAlert("CW00208","편성년도");
				gfn_SetFocus(cal_zpyear,"Y"); 
				return false;
			}     
			if (length(trim(cal_zpym.Value)) == 0)
			{ 
				// CW00208 : "[${}]은/는 필수입력 입니다.확인바랍니다.")
				gfn_showAlert("CW00208","계획년월");
				gfn_SetFocus(cal_zpym,"Y"); 
				return false;
			}    
			
			if (ds_list.GetUpdate()==true)
			{ 
				arr = ["조회","계속"];
				// "CI10001", "변경된 자료가 존재합니다. \n${} 할 경우 기존에 변경된 정보가 모두 소실됩니다.\n\n{} 하시겠습니까?"); 			 
				if (gfn_showConfirm("CI10001", arr) == false)   
				{ 
					// 조회하지 않기 
					gfn_SetFocusGrid(grd_list, ds_list.row, 0);  // 변경된 행에 포커싱처리
					return false;
				}   
			}
			
			/*
			임시 주석처리
			if (length(trim(cb_spart.value)) == "0")
			{ 
				// CW00208 : "[${}]은/는 필수입력 입니다.확인바랍니다.")
				gfn_showAlert("CW00208","제품군");
				gfn_SetFocus(cb_spart,"Y"); 
				return false;
			}    
			if (length(trim(div_vbvg.cb_frvb.Value))==0)
			{ 
				// CW00208 : "[${}]은/는 필수입력 입니다.확인바랍니다.")
				gfn_showAlert("CW00208","부서");
				gfn_SetFocus(div_vbvg.cb_frvb,"Y"); 
				return false;
			}
			if (length(trim(div_vbvg.cb_frvg.Value))==0)
			{ 
				// CW00208 : "[${}]은/는 필수입력 입니다.확인바랍니다.")
				gfn_showAlert("CW00208","팀");
				gfn_SetFocus(div_vbvg.cb_frvg,"Y"); 
				return false;
			}
			if (length(trim(div_sman.ed_sman_cd.text))==0)
			{ 
				// CW00208 : "[${}]은/는 필수입력 입니다.확인바랍니다.")
				gfn_showAlert("CW00208","담당자");
				gfn_SetFocus(div_sman.ed_sman_cd,"Y"); 
				return false;
			} 
			*/
			
			break;  
		
		case "query_bill" : // 상세조회 시
			
			if (length(ds_list.GetColumn(ds_list.row, "PSPIDSV"))==0)
			{
				return false;
			}
			break;
			
		case "excel" :   // 엑셀
			 
			if (ds_list.RowCount() <=0)
			{ 
				// CW00010 : "데이터가 없습니다."
				gfn_showAlert("CW00010");
				return false;
			} 
			 
			// 변경된 내역이 존재할 경우 엑셀출력 불가처리
			if(gfn_isChangeDs(ds_list, false, "FLAG", "사업계획")== true) 
			{  
				//"CW10003", "변경된 ${}이 존재하여 ${}이 불가능합니다. 변경된 정보를 저장후 다시 실행하여 주십시오.");  // 2012.06.13 : GRY : 추가
				arr = ["사업계획", "엑셀출력"];
				gfn_showAlert("CW10003", arr);
				return false;
			}   
			
			break; 
			
		case "input" :       // 입력버튼 클릭 시 
			
			
			// 매출/수금/계획년월의 18개월이 SET 되어 있어야 함 
			if (ds_yearm.RowCount()== 0)
			{  
				// "CW00054", "조회 후 작업이 가능합니다.");				
				gfn_showAlert("CW00054");
				return false;
			} 
			if (F_CLOSE_YN == "Y")
			{
				// "CW10004", "${}은(는) ${}되지 않아 ${} 할 수 없습니다."
				arr = [cal_zpyear.Text+"년 사업계획", "오픈", "입력"];   
				gfn_showAlert("CW10004", arr);
				gfn_SetFocus(cal_zpyear,"Y"); 
				return false;
			}
			
			
			if (length(trim(cal_zpyear.Value)) == 0)
			{ 
				// CW00208 : "[${}]은/는 필수입력 입니다.확인바랍니다.")
				gfn_showAlert("CW00208","편성년도");
				gfn_SetFocus(cal_zpyear,"Y"); 
				return false;
			}     
			if (length(trim(cal_zpym.Value)) == 0)
			{ 
				// CW00208 : "[${}]은/는 필수입력 입니다.확인바랍니다.")
				gfn_showAlert("CW00208","계획년월");
				gfn_SetFocus(cal_zpym,"Y"); 
				return false;
			}     
			if (length(trim(div_vbvg.cb_frvb.Value))==0)
			{ 
				// CW00208 : "[${}]은/는 필수입력 입니다.확인바랍니다.")
				gfn_showAlert("CW00208","부서");
				gfn_SetFocus(div_vbvg.cb_frvb,"Y"); 
				return false;
			}
			if (length(trim(div_vbvg.cb_frvg.Value))==0)
			{ 
				// CW00208 : "[${}]은/는 필수입력 입니다.확인바랍니다.")
				gfn_showAlert("CW00208","팀");
				gfn_SetFocus(div_vbvg.cb_frvg,"Y"); 
				return false;
			}
			if (length(trim(div_sman.ed_sman_cd.text))==0)
			{ 
				// CW00208 : "[${}]은/는 필수입력 입니다.확인바랍니다.")
				gfn_showAlert("CW00208","담당자");
				gfn_SetFocus(div_sman.ed_sman_cd,"Y"); 
				return false;
			}
			else
			{
				// 담당자코드에 해당하는 담당자명 조회하여 유효성 체크
				if (fn_query_sman(trim(div_sman.ed_sman_cd.text))==false)
				{
					return false;
				}
			} 
			
			// 한건씩만 저장해야 하므로 신규행은 한 건만 존재해야 함
			nRow = fn_findRow(true, false, false);
			if (nRow >= 0)
			{ 
				// "CW10010", "이미 입력되어 있습니다."
				gfn_showAlert("CW10010");
				gfn_SetFocusGrid(grd_list, nRow, 0);
				return false;
			}
			
			// 기존에 변경이나 삭제로 선택한 행이 있는지 체크  
			nRow = fn_findRow(false, true, true);
			if (nRow >= 0)
			{
				arr = ["입력","계속"];
				// "CI10001", "변경된 자료가 존재합니다. \n${} 할 경우 기존에 변경된 정보가 모두 소실됩니다.\n\n{} 하시겠습니까?"); 			 
				if (gfn_showConfirm("CI10001", arr) == false)  
				{ 
					// 행 이동하지 않기 
					gfn_SetFocusGrid(grd_list, nRow, 0);
					return false;
				} 
				else
				{ 
					// 기존 값으로 복원처리 
					fn_recorverToOldDataset(nRow);
					
					// 행 이동하기
					return true;  
				}
			} 
			
			
			break;  
				
		case "save":   	// 사업계획저장
		 
			if (F_CLOSE_YN == "Y")
			{
				// "CW10004", "${}은(는) ${}되지 않아 ${} 할 수 없습니다."
				arr = [cal_zpyear.Text+"년 사업계획", "오픈", "저장"]; 
				gfn_showAlert("CW10004", arr);
				gfn_SetFocus(cal_zpyear,"Y"); 
				return false;
			}
			
			if (length(ds_list.GetColumn(ds_list.row, "FLAG"))==0)
			{
				// CW00006=${}에 변경된 정보가 없습니다.
				gfn_showAlert("CW00006", "사업계획");
				return false; 
			}
			
			
			if (length(trim(cal_zpyear.Value)) == 0)
			{ 
				// CW00208 : "[${}]은/는 필수입력 입니다.확인바랍니다.")
				gfn_showAlert("CW00208","편성년도");
				gfn_SetFocus(cal_zpyear,"Y"); 
				return false;
			}     
			if (length(trim(cal_zpym.Value)) == 0)
			{ 
				// CW00208 : "[${}]은/는 필수입력 입니다.확인바랍니다.")
				gfn_showAlert("CW00208","계획년월");
				gfn_SetFocus(cal_zpym,"Y"); 
				return false;
			}    
			
			// 선택된 행 존재여부 체크
			// alert("ds_list.FindRow(CHK,1) : " + ds_list.FindRow("CHK",1));
			// alert("ds_list.GetColumn(CHK) : " + ds_list.GetColumn(0, "CHK"));  
			// if (ds_list.FindRow("CHK",1) < 0)
			// { 
				//CW00013 : "처리할 자료를 먼저 선택해 주십시오."
				// gfn_showAlert("CW00013"); 
				// return false; 
			// }   
			 
			//alert("ds_list.GetColumn(FLAG) : " + ds_list.GetColumn(ds_list.row, "FLAG"));
			
			// 신규입력인 경우 필수입력 체크
			if (ds_list.GetColumn(ds_list.row, "FLAG") == "I" )
			{
				if (length(trim(div_vbvg.cb_frvb.Value))==0)
				{ 
					// CW00208 : "[${}]은/는 필수입력 입니다.확인바랍니다.")
					gfn_showAlert("CW00208",trim(st_vb.Text));
					gfn_SetFocus(div_vbvg.cb_frvb,"Y"); 
					return false;
				}
				if (length(trim(div_vbvg.cb_frvg.Value))==0)
				{ 
					// CW00208 : "[${}]은/는 필수입력 입니다.확인바랍니다.")
					gfn_showAlert("CW00208",trim(st_vg.Text));
					gfn_SetFocus(div_vbvg.cb_frvg,"Y"); 
					return false;
				}
				if (length(trim(div_sman.ed_sman_cd.text))==0)
				{ 
					// CW00208 : "[${}]은/는 필수입력 입니다.확인바랍니다.")
					gfn_showAlert("CW00208",trim(st_sman.Text));
					gfn_SetFocus(div_sman.ed_sman_cd,"Y"); 
					return false;
				} 
			}
			
			// 변경항목 체크
			if (ds_list.GetColumn(ds_list.row, "FLAG") == "I" ||
			      ds_list.GetColumn(ds_list.row, "FLAG") == "U"
				)
			{ 
				if(gfn_isChangeDs(ds_list_bill, false, "FLAG", "사업계획")== false
					&& gfn_isChangeDs(ds_list, false, "FLAG", "사업계획")== false) 
				{ 
					gfn_showAlert("CW00006", "사업계획");
					return false; 
				}     
				 
				
				// 수주예상액(sofoca) 대비 매출(sa_tot), 청구(rq_tot), 수금(ys_tot) 합계 체크
				var sofoca = ds_list.GetColumn(ds_list.row, "SOFOCA") ;  // 수주예상액 
				var sa_tot = parseInt(replace(grd_list_detail.GetCellText("Body",0,1),",",""));
				var rq_tot = parseInt(replace(grd_list_detail.GetCellText("Body",1,1),",",""));
				var ys_tot = parseInt(replace(grd_list_detail.GetCellText("Body",2,1),",",""));
				if (sa_tot > 0 && sa_tot != sofoca)
				{
					arr = [ grd_list_detail.GetCellText("Body",0,0),
							"합계금액(" + sa_tot + ")",
							"수주예상액(" + sofoca + ")"
							]; 
					//"CW10011", "${}의 [${}]은 [${}]과 동일해야 합니다. 
					gfn_showAlert("CW10011",arr); 
					gfn_SetFocusGrid(grd_list_detail, 0, 1);
					return false;
				}		
				if (rq_tot > 0 && rq_tot != sofoca)
				{ 
					arr = [ grd_list_detail.GetCellText("Body",1,0),
							"합계금액(" + rq_tot + ")",
							"수주예상액(" + sofoca + ")"
							]; 
					//"CW10011", "${}의 [${}]은 [${}]과 동일해야 합니다.
					gfn_showAlert("CW10011",arr);  
					gfn_SetFocusGrid(grd_list_detail, 1, 1);
					return false;
				}
				if (ys_tot > 0 && ys_tot != sofoca)
				{ 
					arr = [ grd_list_detail.GetCellText("Body",2,0),
							"합계금액(" + ys_tot + ")",
							"수주예상액(" + sofoca + ")"
							]; 
					//"CW10011", "${}의 [${}]은 [${}]과 동일해야 합니다. 
					gfn_showAlert("CW10011",arr);  
					gfn_SetFocusGrid(grd_list_detail, 2, 1);
					return false;
				}		 
				
			}
		
			break; 
		
		case "delete":   	// 사업계획삭제 
			
			if (F_CLOSE_YN == "Y")
			{
				// "CW10004", "${}은(는) ${}되지 않아 ${} 할 수 없습니다."
				arr = [cal_zpyear.Text+"년 사업계획", "오픈", "삭제"];  
				gfn_showAlert("CW10004", arr);
				gfn_SetFocus(cal_zpyear,"Y"); 
				return false;
			}
			
			// 조회된 행 존재여부 체크
			if (ds_list.row < 0 || ds_list.rowCount() < 1)
			{ 
				// CW00010 : "데이터가 없습니다."
				gfn_showAlert("CW00010");
				return false; 
			}  
			
			// 기존에 입력,변경,삭제로 선택한 행이 있는지 체크
			nRow = fn_findRow(true, true, true);
			if (nRow >= 0)
			{
				var arr = ["삭제","계속"];
				// "CI10001", "변경된 자료가 존재합니다. \n${} 할 경우 기존에 변경된 정보가 모두 소실됩니다.\n\n{} 하시겠습니까?"); 			 
				if (gfn_showConfirm("CI10001", arr) == false)  
				{
					// 행 이동하지 않기 
					gfn_SetFocusGrid(grd_list, nRow, 0);
					return false;
				} 
				else
				{ 
					if (ds_list.GetRowType(ds_list.row) == "insert")
					{
						// 기존 값으로 복원처리 
						fn_recorverToOldDataset(nRow);   
						return false;		// 삭제 플래그 처리 제외하기 위함
					}
					else
					{
						// 기존 값으로 복원처리 
						fn_recorverToOldDataset(nRow);   
						return true;		// 삭제 플래그 처리하기 위함
					}
				}
				
				
				
			} 
			
			break;  
			
		case "close":   	// 사업계획(보수) 화면 닫기
			  
			// 기존에 입력,변경,삭제로 선택한 행이 있는지 체크
			nRow = fn_findRow(true, true, true);
			if (nRow >= 0)
			{
				var arr = ["닫기","계속"];
				// "CI10001", "변경된 자료가 존재합니다. \n${} 할 경우 기존에 변경된 정보가 모두 소실됩니다.\n\n{} 하시겠습니까?"); 			 
				if (gfn_showConfirm("CI10001", arr) == false)  
				{ 
					return false;
				}   
			} 
			
			break; 
				
		default: 
			break; 
	}   

	return true;
}

/********************************************************************************
* 기      능   : 새로고침
********************************************************************************/
function fn_refresh() {

	// 폼초기화
	//fn_init_form();
	
}  

// 폼 초기화 
function fn_init_form()
{ 
	// 임시코딩 
	if (length(G_SESSION_ID)==0)
	{
		btn_query.Visible = true;
		btn_input.Visible = true;
		btn_delete.Visible = true;
		btn_save.Visible = true;
		btn_excel.Visible = true;
		btn_close.Visible = true;
	}
	else
	{ 
		btn_query.Visible = false;
		btn_input.Visible = false;
		btn_delete.Visible = false;
		btn_save.Visible = false;
		btn_excel.Visible = false;
		btn_close.Visible = false;
	}
	
	// 메세지바 초기화
	gfn_clearMsgBar();   
	
	// 항목 위치 재조정
	grd_list.top 			= 56;
	grd_list.height 		= 403; 
	//div_detail.top 			= grd_list.top + grd_list.height + 5;
	//div_detail.height 		= 90;
	grd_list_detail.top 	= grd_list.top + grd_list.height + 2;
	grd_list_detail.height 	= 98; 
	
	// 폼변수 초기화 
	F_PSPIDSV		= "";	// 사업계획번호  
	F_USER_GROUP_B  = G_USER_GROUP_B;  // 임시 추가
	F_SYSDATE   	= substr(gfn_getCurrDate(),0,8); // 현재년월일(8자리)
	
	// 기종정보 초기화 
	div_detail.ed_gtype_info.Text = ""; 
	
	// 데이타셋 초기화
	ds_list_opendtm.ClearData(); 	// 검색결과 마감일자 데이타셋 초기화   
	ds_list.ClearData(); 			// 검색결과 그리드 데이타셋 초기화   
	ds_detail.ClearData(); 			// 검색결과 상세  데이타셋 초기화   
	ds_list_bill.ClearData(); 	// 검색결과 매출/청구/수금목록  데이타셋 초기화   
	
	// 부서/팀 검색조건 리사이징 및 스타일 적용
	div_vbvg.fn_rsetSize(280, 140, 140);	 									// 디비전사이즈, 부서콤보 사이즈, 팀콤보 사이즈
	div_detail.div_vbvg.cb_frvb.Style = "sty_ipt_search_ind";					// 거래선코드 스타일 SET
	div_detail.div_vbvg.cb_frvg.Style = "sty_ipt_search_ind";					// 거래선명 스타일 SET
 	 
	// 담당자코드  스타일변경
	div_detail.div_sman.ed_sman_cd.Style = "sty_ipt_search_ind";					// 거래선코드 스타일 SET
 	 
	// 거래선 입력항목 초기화
	div_detail.div_buyr.fn_setShowBuyrNM("Y");									// 거래선명 항목을 보여준다
	div_detail.div_buyr.fn_rsetSize(212, 62, 130);								// 거래선코드, 거래선명 사이즈 조정
	gfn_BindColumn(div_detail.div_buyr.ed_buyr_cd, "ds_list", "KUNNR"		); 	// 거래선코드 데이타셋 바인드
	gfn_BindColumn(div_detail.div_buyr.ed_buyr_nm, "ds_list", "KUNNR_NM"	); 	// 거래선명 데이타셋 바인드
	div_detail.div_buyr.ed_buyr_cd.Style = "sty_ipt_form_ind";					// 거래선코드 스타일 SET
	div_detail.div_buyr.ed_buyr_nm.Style = "sty_ipt_form_ind";					// 거래선명 스타일 SET
	div_detail.div_buyr.ed_buyr_nm.enable = false;								// 거래선명 수정불가
	
	// 기종정보 목록 조회 (기종코드, 제품명, 판매문서유형, 자재번호)
	fn_query_gtype(); 

	// 익년
	var zpyear = parseInt(substr(F_SYSDATE,0,4))+1; 					// 현재년월
	
	// 편성년도
	cal_zpyear.Value = zpyear + "0101"; 		// 편성년도 = 익년도
	 
	// 계획년월 기본값 SETTING
	cal_zpym.Value 	 = zpyear + "0101"; 		// 계획년월 = 익년월 
	
	// dataset 목록 설정
	ds_obj_list.ClearData();
	ds_obj_list.AddRow();
	ds_obj_list.SetColumn(0, "DS_VB"		, "ds_list_vb");  	// 그리드 부서 출력 데이타셋
	ds_obj_list.SetColumn(0, "DS_VG"		, "ds_list_vg");	// 그리드 팀콤보 출력 데이타셋
	ds_obj_list.SetColumn(0, "DS_COND_VG"	, "ds_cond_vg");	// 그리드 팀콤보출력 조건 데이타셋
	ds_obj_list.ApplyChange();
	
	// 검색조건 div의 border 삭제
	div_vbvg.Border 	= "none";  	// 부서 div
	div_sman.Border 	= "none";	// 담당자_FR div   
	
	// 코딩 시 필요한 그리드 컬럼 인덱스	   
	F_COLNUM_CHK 		= gfn_getColIdx(grd_list,"CHK"		);  // 선택여부  
	F_COLNUM_FLAG 		= gfn_getColIdx(grd_list,"FLAG"		);  // 변경구분   
	F_COLNUM_PSPIDSV 	= gfn_getColIdx(grd_list,"PSPIDSV"	);  // 보수프로젝트번호   
	F_COLNUM_ZHOGISV 	= gfn_getColIdx(grd_list,"ZHOGISV"	);  // 보수호기번호
	F_COLNUM_ZPYEAR 	= gfn_getColIdx(grd_list,"ZPYEAR"	);  // 편성년도  
	F_COLNUM_ZPYM 		= gfn_getColIdx(grd_list,"ZPYM"		);  // 계획년월  
	F_COLNUM_SPART 		= gfn_getColIdx(grd_list,"SPART"	);  // 제품군  
	F_COLNUM_VKBUR 		= gfn_getColIdx(grd_list,"VKBUR"	);  // 사업장    
	F_COLNUM_VKGRP		= gfn_getColIdx(grd_list,"VKGRP"	);  // 영업그룹    
	F_COLNUM_ZKUNNR		= gfn_getColIdx(grd_list,"ZKUNNR"	);  // 담당자
	F_COLNUM_ZKUNNR_NM	= gfn_getColIdx(grd_list,"ZKUNNR_NM");  // 담당자명
	F_COLNUM_KUNNR		= gfn_getColIdx(grd_list,"KUNNR"	);  // 거래선  
	F_COLNUM_KUNNR_NM	= gfn_getColIdx(grd_list,"KUNNR_NM"	);  // 거래선명   
	F_COLNUM_GSNAM      = gfn_getColIdx(grd_list,"GSNAM"	);	// 공사명
	F_COLNUM_REGION     = gfn_getColIdx(grd_list,"REGION"	);	// 설치지역
	F_COLNUM_GTYPE      = gfn_getColIdx(grd_list,"GTYPE"	);	// 기종
	F_COLNUM_TYPE1      = gfn_getColIdx(grd_list,"TYPE1"	);	// TYPE1 (인승)
	F_COLNUM_TYPE2      = gfn_getColIdx(grd_list,"TYPE2"	);	// TYPE2 (속도)
	F_COLNUM_TYPE3      = gfn_getColIdx(grd_list,"TYPE3"	);	// TYPE3 (층수)
	F_COLNUM_ZNUMBER    = gfn_getColIdx(grd_list,"ZNUMBER"	);	// 대수
	F_COLNUM_ZDELI      = gfn_getColIdx(grd_list,"ZDELI"	);	// 단납기구분
	F_COLNUM_SHANGH     = gfn_getColIdx(grd_list,"SHANGH"	);	// 국내/상해구분
	F_COLNUM_ZINTER     = gfn_getColIdx(grd_list,"ZINTER"	);	// 중계무역구분
	F_COLNUM_SOFOCA     = gfn_getColIdx(grd_list,"SOFOCA"	);	// 수주예상액
	F_COLNUM_ZFORE      = gfn_getColIdx(grd_list,"ZFORE"	);	// 예상시행율
	F_COLNUM_WAERK      = gfn_getColIdx(grd_list,"WAERK"	);	// 통화
	F_COLNUM_DELDAT     = gfn_getColIdx(grd_list,"DELDAT"	);	// 납기예정일
	F_COLNUM_ZRMK       = gfn_getColIdx(grd_list,"ZRMK"		);	// 비고

	// 그리드 FIX
	gfn_grid_fix(grd_list			, F_COLNUM_SPART);			// 제품군에서 fix
	gfn_grid_fix(grd_list_detail	, F_COLNUM_TOT1);			// 합계에서 fix
	grd_list.SetColProp(F_COLNUM_ZPYEAR , "Width", 0 );			// 편성년도 안보이게
	grd_list.SetColProp(F_COLNUM_ZPYM	, "Width", 0 );			// 계획년월 안보이게
	
	// 버튼 제어
	// ufn_enableBtn("input",  false);  	// 입력
	// ufn_enableBtn("delete", false);		// 삭제
	// ufn_enableBtn("save",   false);		// 저장
	// ufn_enableBtn("reset",  false);		// 리셋
	 
}  

// 제품군목록 조회 CALL BACK함수
function fn_afterQuery_spart(errCode, errMsg) 
{   
	//gfn_InsertRowCombo(ds_spart_cd, 0, "Y", "N", "Y"); // 제품군목록 전체 행 추가
	//cb_spart.index = 0; 
}   
   

// 그리드 헤더 클릭 시
function grd_list_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
{
	if ( nCell == 0 ) 
	{
		gfn_selectGridCol(obj); 
	} 
	else if ( nCell > 1 ) 
	{
		gfn_sortGrid(obj, nCell);
	}	 
}

// 그리드에서 키 입력 시
function grd_list_OnKeyDown(obj,nChar,bShift,bCtrl,bAlt,nLLParam,nHLParam)
{
	//trace("grd_list_OnKeyDown.nChar : " + nChar); 
	
	var ds = object(obj.BindDataset);  
	
	// 엔터키이면
	if (nChar==13)
	{ 
		ds.row = ds.row + 1;  // 다음 행으로 이동
	} 
	// Esc 키이면 변경전 자료로 되돌린다.
	else if (nChar==27)
	{  
		var nCol 	= obj.GetCellPos();
		gfn_SetOrgColumn(obj, ds.row, nCol);  
	} 
	else {
		gfn_GrdCellCopyPasteReset(obj, ds, bCtrl, nChar); 
	} 
	
	
} 

// 삭제 버튼 클릭 시
function fn_delete()
{
	// trace("fn_delete()호출 start"); 
	 
	// 조건 항목오류검증
	if (fn_valid_chk("delete") == false) return false;
	
	// if (!gfn_showConfirm("CI00015","사업계획"))
	// {
		// return;
	// }
	
	// Grid 현재행 삭제 처리  (FLAG:D)
	// 삭제(신규행), 삭제FLAG처리(기등록자료)
	gfn_deleteGridRow( grd_list, ds_list.row, "FLAG" );	 
	ds_list_OnRowPosChanged(ds_list, -1, ds_list.row);
	
} 

// 그리드 부서코드목록 조회
function fn_query_grid_vb()
{
	// 부서 콤보목록 데이타셋 이벤트 비활성화
	ds_list_vb.Fireevent = false;   
	
	// 서비스 호출 
	ds_list_vb.ClearData(); 
	ds_error.ClearData();
	//trace(ds_obj_list.SaveXML()); 
	nsfRequest("query"												// srvId
				, "combo/gridVb"									// url
				, "ds_obj_list=ds_obj_list ds_list_vb=ds_list_vb"	// inDsList
				, "ds_list_vb=ds_list_vb ds_error=ds_error"			// outDsList
				, ""												// strParam
				, "fn_afterQuery_grid_vb"								// CallBackFunc
				);
				
}

// 그리드 팀코드목록 조회 
function fn_query_grid_vg()
{   
	
	// 팀 콤보목록 조회   
	ds_cond_vg.ClearData();
	ds_cond_vg.AddRow();  
	ds_cond_vg.SetColumn(0,"VB", "");  // 부서코드 null 이면 전체 팀목록 조회
	//trace(ds_cond_vg.SaveXML());
		
	// 서비스 호출 (팀목록조회)  
	ds_list_vg.ClearData();
	ds_error.ClearData();
	nsfRequest("query"												// srvId
				, "combo/gridVg"									// url
				, "ds_obj_list=ds_obj_list ds_cond_vg=ds_cond_vg ds_list_vg=ds_list_vg"	// inDsList
				, "ds_list_vg=ds_list_vg ds_error=ds_error"			// outDsList
				, ""												// strParam
				, ""											// CallBackFunc
				);
				
}  

// 담당자코드로 담당자명 조회
// pSmanCd : 담당자코드
// 담당자코드로 담당자명 조회
// pSmanCd : 담당자코드
function fn_query_sman(pSmanCd) { 
	
	//trace("fn_query_sman.pSmanCd : " + pSmanCd);
	
	gfn_clearMsgBar();   
	 
	// 조건설정 
	ds_cond_sman.ClearData(); 
	ds_cond_sman.AddRow();
	ds_cond_sman.SetColumn(ds_cond_sman.row, "sman_cd", pSmanCd); 
	//trace(ds_cond_sman.SaveXML());
	
	// 서비스호출
	ds_list_sman.ClearData(); 
	ds_error.ClearData();
	fn_createWait("",this);     // 처리중입니다. 메시지 처리
	http.sync = true;			// 반드시 sync call 해야 함
	nsfRequest("query"														// srvId
				, "com0030/find"											// url
				, "ds_cond_sman=ds_cond_sman ds_list_sman=ds_list_sman"		// inDsList
				, "ds_list_sman=ds_list_sman ds_error=ds_error"				// outDsList
				, ""														// strParam
				, "");														// CallBackFunc
     
	http.sync = false;			// 반드시 sync call 해제 해야 함
    fn_destroyWait(); 			// 처리중입니다. 메시지 처리 해제
	
	//trace(ds_list_sman.SaveXML());
	
	if(ds_error.rowcount() > 0) {    
		gfn_showMsgBar(ds_error.GetColumn(0,"ERRMSG"));   
		return false;
	} else { 
		if (ds_list_sman.RowCount() == 0) { // 자료가 없는 경우
		
			var arr = ["담당자ID", pSmanCd];
			// "CW10001", "[${}:${}] 해당 정보를 찾을 수 없습니다.\n확인하여 주십시오."
			gfn_showAlert("CW10001", arr);
			return false;
		}
	}
	
	return true;
	
}  


/********************************************************************************
* 기      능   :  담당자 조회 Callback  
********************************************************************************/ 
/*function fn_afterQuery_sman(errCode, errMsg) {

	fn_destroyWait();

	// trace(ds_list_sman.SaveXML());
	
	if(ds_error.rowcount() > 0) {   
	
		gfn_showMsgBar(ds_error.GetColumn(0,"ERRMSG"));   
		
	} else {
		
		if (ds_list_sman.RowCount() == 1) { // 한 건 조회된 경우
		 
			// 조회해 온 값으로 담당자명 SET 
			ds_list.Fireevent = false;
			ds_list.SetColumn(ds_list.row,"ZKUNNR_NM", ds_list_sman.GetColumn(ds_list_sman.row, "SMAN_NM")); 
			ds_list.Fireevent = true;
		}  
		if (ds_list_sman.RowCount() == 0) { // 자료가 없는 경우
		
			var arr = ["담당자ID", ds_list.GetColumn(ds_list.row, "ZKUNNR")];
			gfn_showAlert("CW10001", arr);
		}
	}
}
*/

// 거래선코드로 거래선명 조회
// pbuyrCd : 거래선코드
function fn_query_buyr(pbuyrCd) { 
	
	//trace("fn_query_buyr.pbuyrCd : " + pbuyrCd);
	
	gfn_clearMsgBar();   
	  
	// 조회조건 설정
	ds_cond_buyr.ClearData();
	ds_cond_buyr.AddRow();
	var buyr_cd = gfn_SetStrPad(trim(pbuyrCd), "0", 6, "L");
	ds_cond_buyr.SetColumn(ds_cond_buyr.row, "BUYR_CD", buyr_cd);    
	//trace(ds_cond_buyr.SaveXML());
	
	// 서비스호출
	fn_createWait("",this);     // 처리중입니다. 메시지 처리
	ds_list_buyr.ClearData();
	ds_error.ClearData(); 
	nsfRequest("query"														// srvId
				, "com0040/find"											// url
				, "ds_cond_buyr=ds_cond_buyr ds_list_buyr=ds_list_buyr"		// inDsList
				, "ds_list_buyr=ds_list_buyr ds_error=ds_error"				// outDsList
				, ""														// strParam
				, "fn_afterQuery_buyr");									// CallBackFunc
}


/********************************************************************************
* 기      능   : 거래선명 조회 Callback  
********************************************************************************/ 
function fn_afterQuery_buyr(errCode, errMsg) {

	fn_destroyWait();

	// trace(ds_error.SaveXML());
	// trace(ds_list_buyr.SaveXML());
	
	if(ds_error.rowcount() > 0) {   
	
		gfn_showMsgBar(ds_error.GetColumn(0,"ERRMSG"));   
		
	} else {
		
		if (ds_list_buyr.RowCount() == 1) { // 한 건 조회된 경우 
			// 조회해 온 값으로 거래선명 SET 
			ds_list.SetColumn(ds_list.row,"KUNNR_NM", ds_list_buyr.GetColumn(ds_list_buyr.row, "BUYR_NM")); 
		}  
		if (ds_list_buyr.RowCount() == 0) { // 자료가 없는 경우 
			var arr = ["거래선코드", ds_list.GetColumn(ds_list.row, "KUNNR")];
			gfn_showAlert("CW10001", arr);
		}
	}
}   

// 기종목록 조회 
function fn_query_gtype() { 
	
	//trace("fn_query_gtype");
	
	gfn_clearMsgBar();   
	  
	// 조회조건 설정 
	
	// 서비스호출
	fn_createWait("",this);     // 처리중입니다. 메시지 처리
	ds_list_gtype.ClearData();
	ds_error.ClearData(); 
	nsfRequest("query"												// srvId
				, "sbp0050/find_gtype"								// url
				, "ds_list_gtype=ds_list_gtype"						// inDsList
				, "ds_list_gtype=ds_list_gtype ds_error=ds_error"	// outDsList
				, ""												// strParam
				, "fn_afterQuery_gtype");							// CallBackFunc
}


/********************************************************************************
* 기      능   : 기종목록 조회 Callback  
********************************************************************************/ 
function fn_afterQuery_gtype(errCode, errMsg) {

	fn_destroyWait();

	// trace(ds_error.SaveXML());
	// trace(ds_list_gtype.SaveXML());
	
	if(ds_error.rowcount() > 0) {    
		gfn_showMsgBar(ds_error.GetColumn(0,"ERRMSG"));    
	}
	
}   


/********************************************************************************
* 기      능   : 기종목록에서 특정 기종정보 조회
********************************************************************************/ 
function fn_getGtypeInfo(pGType) {
 
	//trace("fn_getGtypeInfo.pGType : " + pGType);
	
	// 기종정보 GET
	var nRow  = ds_list_gtype.FindRow  ("gtype",pGType);
	var spart = ds_list_gtype.GetColumn(nRow, "spart");	// 제품군
	var auart = ds_list_gtype.GetColumn(nRow, "auart");	// 판매문서유형
	var matnr = ds_list_gtype.GetColumn(nRow, "matnr");	// 자재번호 
	
	// 찾아온 정보로 상세 데이타셋 SET
	ds_list.SetColumn(ds_list.row, "SPART", spart);		// 제품군
	ds_list.SetColumn(ds_list.row, "AUART", auart);		// 판매문서유형
	ds_list.SetColumn(ds_list.row, "MATNR", matnr);		// 자재번호
	
	div_detail.cb_gtype.ToolTipText =  "제품군       ["			+gfn_GetListCodeName(F_FORM_ID, GC_CDGB_SPART, spart)+"]\n"
	                                 + "판매문서유형 ["	+auart+"]\n"
									 + "자재번호     ["	+matnr+"]"
											; 
	div_detail.ed_gtype_info.Text =   "[" + gfn_GetListCodeName(F_FORM_ID, GC_CDGB_SPART, spart) +"] "
	                                + "[" + auart + "] "
	                                + "[" + matnr + "]"
	                                ;
	                                
	// 정기보수 판매문서유형인 경우 매출/청구/수금 자료를 입력/수정할 수 없다.
	if (fn_bill_saveyn()=="Y")
	{
		grd_list_detail.Editable = true;
		div_detail.ed_pspidsv.Style = "sty_ipt_form";
	}
	else
	{
		grd_list_detail.Editable = false;
		div_detail.ed_pspidsv.Style = "sty_ipt_form_ind";
	} 

}   

// 계획년월의 오픈일자  조회 
function fn_query_opendtm()
{ 
	//trace("fn_query_opendtm ");
	
	//F_CLOSE_YN = "Y";  // 마감여부 초기화	
	
	// 조건 설정
	ds_cond_opendtm.ClearData(); 
	ds_cond_opendtm.AddRow();
	ds_cond_opendtm.SetColumn(ds_cond_opendtm.row, "ZPYEAR"	, replace(cal_zpyear.text,".",""));  // 편성년도 
	//trace(ds_cond_opendtm.SaveXML());
		
	// 서비스 호출 (계획년월의 오픈일시 조회)
	fn_createWait("",this);     // 처리중입니다. 메시지 처리
	ds_list_opendtm.ClearData();	
	ds_error.ClearData();
	nsfRequest("query"									// srvId
				, "sbp0050/find_opendtm"					// url
				, "ds_cond_opendtm=ds_cond_opendtm ds_list_opendtm=ds_list_opendtm"	// inDsList
				, "ds_list_opendtm=ds_list_opendtm ds_error=ds_error"				// outDsList
				, ""									// strParam
				, "fn_afterQuery_opendtm"				// CallBackFunc
				);
}

// 계획년월의 오픈일시 조회 CALL BACK
function fn_afterQuery_opendtm(errCode, errMsg) 
{   
	fn_destroyWait();

	// trace("fn_afterQuery_opendtm 호출 start"); 
	// trace(ds_error.SaveXML());
	// trace(ds_list_opendtm.SaveXML()); 
	
	if(ds_error.RowCount() > 0) 	// 조회실패
	{ 
		gfn_showMsgBar(ds_error.GetColumn(0,"ERRMSG"));   
	} 
	else 
	{ 
		// 조회된 자료가 있을 경우 
		if (ds_list_opendtm.RowCount() > 0) 
		{ 
			//F_CLOSE_YN = "N"; // 마감여부
			ed_opendtm.Text = "사업계획 오픈 : Y";
			grd_list.SetFocus();  		// 그리드 첫번째 행에 포커스 위치시킨다.
			gfn_showMsg("CI00001");  	// CI00002 : "조회를 완료했습니다. 
		} 
		else 
		{	
			ed_opendtm.Text = "사업계획 오픈 : N";	 
			//F_CLOSE_YN = "Y";			// 마감여부  
			gfn_showMsg("CW00010"); 	// CW00010 : "데이터가 없습니다." 
		}
	}   
	
	//trace("fn_afterQuery_opendtm 호출 end");
} 

// 편성년월 변경 시
function cal_zpyear_OnChanged(obj,strOldText,strNewText)
{
	//trace("cal_zpyear_OnChanged.strNewText : " + strNewText);
	
	if ( length(strNewText) >= 4 )
	{
		fn_query_opendtm();	// 계획년도의 마감일자 조회
	}
}

function ds_list_OnRowPosChanged(obj,nOldRow,nRow)
{
 
	if (ds_list.RowCount()==0) return;
	if (ds_list.row<0) return;   
	
	// 매출, 청구, 수금 데이타 초지화
	ds_list_bill.ClearData();   
	 
	// 부서별 style 적용
	fn_style_set(nRow);
	
	// 기종 콤보 변경 이벤트 강제 실행 
	div_detail_cb_gtype_OnChanged(div_detail.cb_gtype
									,ds_list.GetColumn(ds_list.row, "GTYPE")
									,""
									,-1
									,-1);
	
	// 매출/청구/수금 상세조회  
	fn_query_bill();
}


// 기준년월에 따른 그리드 헤더(계획년월) 재설정
// YYYY.MM
function fn_grid_header_set()
{

	// trace("fn_grid_header_set.cal_zpym.text : " + cal_zpym.text);
	
	var bef_month = replace(cal_zpym.Text,".","");  // 편성년월
	var aft_month = "";    
	
	trace("fn_grid_header_set.bef_month : " + bef_month);
	
	ds_yearm.ClearData();
	
	// 편성년도의 01월부터 30개월 생성
	for (var i=0; i<30; i++)
	{
		
		// 한달 씩 더한다. 
		aft_month = substr(AddMonth(bef_month+"01", i),0,6);  
		
		
		//F_COLNUM_YEAYM 컬럼에 기준년월계획이 위치함
		grd_list_detail.SetCellProp("Head"
										, parseInt(F_COLNUM_YEAYM) + i	
										, "Text"
										, substr(aft_month,0,4)+"."+substr(aft_month,4,2)+""  // YYYY.MM
										);

		// 예상년월 Dataset에 Add
		ds_yearm.AddRow();
		ds_yearm.SetColumn(i, "YEARM", aft_month);
	}
	
	//trace(ds_yearm.SaveXML());
	
}


/********************************************************************************
* 기      능   : 입력 : 맨뒤에 행추가하고 상세정보 항목 초기화
********************************************************************************/
function fn_input() 
{ 
 
	// 행추가 조건 항목 오류검증
	if (fn_valid_chk("input") == false)  return;  
	
	// 행추가 (맨뒤에 추가됨 :  FLAG(I))
	var newRow = gfn_addGridRow(grd_list, -1, "FLAG");	// 추가된 행번호를 받아옴  
	  
	/// 새로 추가된 행에 기본값을 설정한다.   
	ds_list.Fireevent = false;
	ds_list.SetColumn(newRow, "NEW_YN"  	, "Y");											// 신규여부
	ds_list.SetColumn(newRow, "MANDT"	    , G_MANDT);
	ds_list.SetColumn(newRow, "ZPYEAR"		, replace(cal_zpyear.text,".",""));				// 편성년도 : 조건년도
	ds_list.SetColumn(newRow, "ZPYM"		, replace(cal_zpym.text,".",""));	 			// 제품군	:조건 제품군
	ds_list.SetColumn(newRow, "VKBUR"		, trim(div_vbvg.cb_frvb.Value));   				// 부서		:선택한 부서를 기본값으로 올려준다.
	ds_list.SetColumn(newRow, "VKGRP"		, trim(div_vbvg.cb_frvg.Value));  				// 팀 		: 선택한 팀을 기본값으로 올려준다.
	ds_list.SetColumn(newRow, "ZKUNNR"		, trim(div_sman.ed_sman_cd.text));   		   // 담당자코드:선택한 담당자코드를 기본값으로 올려준다.
	ds_list.SetColumn(newRow, "ZKUNNR_NM"	, ds_list_sman.GetColumn(ds_list_sman.row, "SMAN_NM")); 
	ds_list.SetColumn(newRow, "WAERK"		, "KRW"); 
	ds_list.Fireevent = true;			 
	   
	// 상세정보 SET
	ds_detail.ClearData();
	ds_list_bill.ClearData();
	fn_setDetailInfo(); 
	
	// 거래선 코드에 강제 focus처리
	div_detail.div_buyr.ed_buyr_cd.SetFocus(); 
	
	// 부서별 style 적용
	fn_style_set(newRow);
	
}


/********************************************************************************
* 기      능   : 기종콤보 선택 변경 시
********************************************************************************/
function div_detail_cb_gtype_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{ 
	// 기종에 해당하는 기종정보(제품군,판매문서유형,재재번호)  조회하여 
	// 화면에 DISPLAY
	fn_getGtypeInfo(strCode);	
}

// 공통코드 조회
function fn_query_dd07t(pDomainId, pDs)
{  
	// 데이타셋 초기화
	ds_cond_dd07t.ClearData();	
	pDs.ClearData();
	
	// 데이타셋 설정
	ds_cond_dd07t.AddRow();
	ds_cond_dd07t.SetColumn(ds_cond_dd07t.row, "DOMNAME"	, pDomainId);  
	ds_cond_dd07t.SetColumn(ds_cond_dd07t.row, "CONCAT_YN"	, "N");  
	//trace(ds_cond_dd07t.SaveXML());
	
	//trace("fn_afterQuery_dd07t_DomainId : " + "fn_afterQuery_dd07t_"+pDomainId); 
	
	
	// 서비스 호출
	nsfRequest("query", "combo/comboDD07T"	, "ds_cond_dd07t=ds_cond_dd07t " + pDs.ID+"="+pDs.ID
											, pDs.ID+"="+pDs.ID +" ds_error_dd07t=ds_error_dd07t"
											, ""
											, "fn_afterQuery_dd07t_"+pDomainId); 
}

// 기종 조회 CALL BACK
function fn_afterQuery_dd07t_ZGTYPE(errCode, errMsg) 
{  
	//trace("fn_afterQuery_dd07t_ZGTYPE"); 
	gfn_InsertRowCombo(ds_gtype_cd, 0, "N", "Y"); // 선택 행 추가
	div_detail.cb_gtype.index = 0;
}   

// 단납구분 조회 CALL BACK
function fn_afterQuery_dd07t_ZDELI(errCode, errMsg) 
{  
	//trace("fn_afterQuery_dd07t_ZDELI"); 
	//gfn_InsertRowCombo(ds_zdeli_cd, 0, "N", "Y"); // 선택 행 추가 
}     

// 건물용도 코드목록 조회 CALL BACK함수
function fn_afterQuery_bdtyp(errCode, errMsg) 
{   
	// 그리드용 건물용도데이타셋
 	gfn_copyDs(ds_list_build, ds_list_build_grid, "CODE <> ''");	
 	
	gfn_InsertRowCombo(ds_list_build, 0, "N", "Y", "BUILDUSE", "STEXT"); // 선택 행 추가
	div_detail.cb_bdtyp.index = 0;
	 
}   

// 보수구분 코드목록 조회 CALL BACK함수
function fn_afterQuery_zsvcgbn(errCode, errMsg) 
{   
	// 그리드용 건물용도데이타셋
 	gfn_copyDs(ds_list_zsvcgbn, ds_list_zsvcgbn_grid, "CODE <> ''");	
 	
	gfn_InsertRowCombo(ds_list_zsvcgbn, 0, "N", "Y", "CODE", "CODE_NAME"); // 선택 행 추가
	div_detail.cb_zsvcgbn.index = 0;
	 
}   

// 상세정보 조회 후처리 로직
function fn_setDetailInfo()
{
	//trace("fn_setDetailInfo");
	
	//// 보수프로젝트번호
	//F_PSPIDSV = ds_list.GetColumn(ds_list.row, "PSPIDSV");	 
	
	// 매출, 청구, 수금 행 미존재 시 강제로 1행씩 추가한다. 
	if (ds_list_bill.RowCount() == 0) 
	{
		ds_list_bill.Fireevent = false;
		ds_list_bill.InsertRow(0); 
		ds_list_bill.SetColumn(ds_list_bill.row, "GBN"		, "1");
		ds_list_bill.SetColumn(ds_list_bill.row, "GBN_NM"	, "매출"); 
		ds_list_bill.InsertRow(1); 
		ds_list_bill.SetColumn(ds_list_bill.row, "GBN"		, "2");
		ds_list_bill.SetColumn(ds_list_bill.row, "GBN_NM"	, "청구");
		ds_list_bill.InsertRow(2); 
		ds_list_bill.SetColumn(ds_list_bill.row, "GBN"		, "3");
		ds_list_bill.SetColumn(ds_list_bill.row, "GBN_NM"	, "수금");
		ds_list_bill.Fireevent = true;
	} 
	
	// 거래선 코드에 포커싱
	gfn_SetFocus(div_detail.div_buyr.ed_buyr_cd, "Y") ;
	
	// 매출/청구/수금 그리드에 포커싱 제거
	ds_list_bill.row = -1;
	
	//trace("********** 상세 조회 후 ***********"); 
	//trace(ds_list_bill.SaveXML()); 
	
	/*
	// 매출, 청구, 수금 행 미존재시 강제로 1행씩 추가한다.
	var nSaRow = ds_list_bill.FindRow("GBN","1");	// 매출 행 존재여부
	var nRqRow = ds_list_bill.FindRow("GBN","2");	// 청구 행 존재여부
	var nYsRow = ds_list_bill.FindRow("GBN","3");	// 수금 행 존재여부 
	
	ds_list_bill.Fireevent = false;
	if (nSaRow < 0) 
	{
		ds_list_bill.InsertRow(0); 
		ds_list_bill.SetColumn(ds_list_bill.row, "GBN"		, "1");
		ds_list_bill.SetColumn(ds_list_bill.row, "GBN_NM"	, "매출");
	}
	if (nRqRow < 0) 
	{
		ds_list_bill.InsertRow(1); 
		ds_list_bill.SetColumn(ds_list_bill.row, "GBN"		, "2");
		ds_list_bill.SetColumn(ds_list_bill.row, "GBN_NM"	, "청구");
	}
	if (nYsRow < 0) 
	{
		ds_list_bill.InsertRow(2); 
		ds_list_bill.SetColumn(ds_list_bill.row, "GBN"		, "3");
		ds_list_bill.SetColumn(ds_list_bill.row, "GBN_NM"	, "수금");
	}
	
	// 매출의 01월에 포커싱
	ds_list_bill.row = 0; 
	grd_list_detail.SetCellPos(2);  
	
	ds_list_bill.Fireevent = true;
	*/
	
	
	
}

function ds_list_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{
	var nCol = grd_list.GetCellPos();  // 현재 컬럼번호
	
	// trace("ds_list_OnColumnChanged.row,col : " + nRow + ", " + nCol);  
	
	// Display구분, 진행사항에 대해 변경여부를 체크
	if (strColumnID = "CHK" || strColumnID == "FLAG" 
							 || strColumnID == "NEW_YN"
							 || strColumnID == "SAVE_YN") return;
							 
 
	// 값이 변경되었을 경우 변경구분 컬럼 자동 SET 
	if (varNewValue != varOldValue)  
	{   
		obj.Fireevent = false; 
		obj.SetColumn(nRow, "CHK" , "1");	// 선택여부   
		obj.Fireevent = true; 
		
		// FLAG 변경 : U
		gfn_changeFlag( obj, strColumnID, nRow, "FLAG");
		 
	} 
	
}

// 목록에서 행이 변경되려고 할 때
function ds_list_CanRowPosChange(obj,nOldRow,nRow)
{
	
	//var flag = obj.GetColumn(nOldRow, "FLAG"); 
	var nRow = fn_findRow(true, true, false);  
	
	// 변경된 자료가 존재할 경우 이동하지 않는다.
	if (nRow >= 0)
	{ 
		var arr = ["행이동을","계속"];
		// "CI10001", "변경된 자료가 존재합니다. \n${} 할 경우 기존에 변경된 정보가 모두 소실됩니다.\n\n{} 하시겠습니까?"); 			 
		if (gfn_showConfirm("CI10001", arr) == false)  		
		{ 
			// 행 이동하지 않기
			gfn_SetFocusGrid(grd_list, nRow, 0) ;  // 변경된 행에 포커싱 처리
			return false;
		} 
		else
		{ 
			// 기존 값으로 복원처리 
			fn_recorverToOldDataset(nOldRow); 
			
			// 행 이동하기
			return true;  
		}
	}
	
	
}
 
// 매출/청구/수금 항목 변경 시
function ds_list_bill_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{
	// FLAG 변경 : U 
	ds_list.SetColumn(ds_list.row, "CHK", "1");
	gfn_changeFlag( ds_list, "CHK", ds_list.row, "FLAG"); 
	
}

// 매출/청구/수금 그리드에서 키 입력 시
function grd_list_detail_OnKeyDown(obj,nChar,bShift,bCtrl,bAlt,nLLParam,nHLParam)
{
	//trace("grd_list_detail_OnKeyDown.nChar : " + nChar); 
	
	var ds = object(obj.BindDataset);  
	
	// 엔터키이면
	if (nChar==13)
	{ 
		ds.row = ds.row + 1;  // 다음 행으로 이동
	} 
	// Esc 키이면 변경전 자료로 되돌린다.
	else if (nChar==27)
	{  
		var nCol 	= obj.GetCellPos();
		gfn_SetOrgColumn(obj, ds.row, nCol);  
	} 
	else { 
		gfn_GrdCellCopyPasteReset(obj, ds, bCtrl, nChar); 
	} 
}

// 매출/청구/수금 그리드 헤더 클릭 시
function grd_list_detail_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
{
	if ( nCell == 0 ) 
	{
		gfn_selectGridCol(grd_list_detail); 
	}  
}


// 기존 값으로 복원처리   
function fn_recorverToOldDataset(pRowNum)
{
	ds_list.Fireevent = false;
	
	// 입력 행인 경우 행만 삭제
	if (ds_list.GetColumn(pRowNum, "FLAG") == "I")
	{
		gfn_deleteGridRow( grd_list, pRowNum, "FLAG" );	 
		ds_list_OnRowPosChanged(ds_list, -1, pRowNum);
	}
	// 그 외는 기존 값으로 원복
	else
	{
		gfn_SetOrgColumn(grd_list, pRowNum, -1) ;
		ds_list.SetColumn(pRowNum, "FLAG", "");
		ds_list.ApplyChange();
		ds_list_bill.ClearData();
		ds_list_bill.ApplyChange();
	} 
	ds_list_bill.ClearData();
	ds_list.ApplyChange();
	ds_list_bill.ApplyChange();
	ds_list.Fireevent = true;
	
}

// 그리드에서 특정 행 찾기
function fn_findRow(pInsert, pUpdate, pDelete)
{
	var nRow = -1; 
	
	if (pInsert == true) 		nRow = ds_list.FindRow("FLAG", "I");		// 입력
	if (nRow < 0)
	{
		if (pUpdate == true) 	nRow = ds_list.FindRow("FLAG", "U");		// 변경
	}  
	if (nRow < 0)
	{
		if (pDelete == true) 	nRow = ds_list.FindRow("FLAG", "D");		// 삭제
	}  
	
	return nRow;
}
 

// 사업계획 오픈여부에 따른 데이타 수정가능여부 SETTING
function fn_enable_set(pEnable)
{ 
	div_detail.div_buyr.ed_buyr_cd	.Enable = pEnable;
	div_detail.div_buyr.btn_popBuyr	.Enable = pEnable; 
	div_detail.ed_gsnam				.Enable = pEnable;
	div_detail.cb_region			.Enable = pEnable;
	div_detail.chk_zdeli			.Enable = pEnable;
	div_detail.cb_bdgbn				.Enable = pEnable;
	div_detail.cb_bdtyp				.Enable = pEnable;
	div_detail.cb_gtype				.Enable = pEnable;
	div_detail.cb_waerk				.Enable = pEnable;
	div_detail.med_sofoca			.Enable = pEnable;
	div_detail.med_zfore			.Enable = pEnable;
	div_detail.ed_znumber			.Enable = pEnable;
	div_detail.ed_zrmk				.Enable = pEnable; 
	grd_list_detail					.Editable= pEnable; 
	
	// 버튼 제어
	ufn_enableBtn("input",  pEnable);  	// 입력
	ufn_enableBtn("delete", pEnable);	// 삭제
	ufn_enableBtn("save",   pEnable);	// 저장 
	//ufn_enableBtn("reset",  pEnable);	// 리셋
}

// 부서별로 특정항목의 style 적용
function fn_style_set(pRowNum)
{ 
	// 해외영업부가 아닌  경우
	if (ds_list.GetColumn(pRowNum, "VKBUR") <> "B500" &&
		ds_list.GetColumn(pRowNum, "VKBUR") <> "B600" &&
		ds_list.GetColumn(pRowNum, "VKBUR") <> "B700" &&
		ds_list.GetColumn(pRowNum, "VKBUR") <> "B900" &&
		ds_list.GetColumn(pRowNum, "VKBUR") <> "BA00" &&
		ds_list.GetColumn(pRowNum, "VKBUR") <> "BB00"
		)
	{ 
		// 설치지역 필수임
		div_detail.cb_region.Style = "sty_ipt_form_ind";
	}
	else
	{
		// 설치지역 필수 아님
		div_detail.cb_region.Style = "sty_ipt_form";
	}
}

// 매출/청구/수금 그리드 수정불가, 조회불가, 저장불가 여부
function fn_bill_saveyn(pCd)
{ 
	// 특정 판매문서유형인 경우 수정불가
	if (ds_list.GetColumn(ds_list.row, "AUART") == "ZR11")
	{ 
		return "N";
	}  
	return "Y";
}
 
]]></Script>
</Window>