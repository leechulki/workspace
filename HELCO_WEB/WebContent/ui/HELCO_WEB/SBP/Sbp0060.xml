<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="562" Id="Sbp0050" Left="8" OnLoadCompleted="fn_OnLoadCompleted" OnUnloadCompleted="fn_OnUnloadCompleted" PidAttrib="7" Title="청구계획&#32;관리" Top="8" Ver="1.0" Width="978" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_cond">
				<Contents>
					<colinfo id="FR_YM" size="8" type="STRING"/>
					<colinfo id="FR_VB" size="4" type="STRING"/>
					<colinfo id="FR_VG" size="3" type="STRING"/>
					<colinfo id="SMAN" size="10" type="STRING"/>
					<colinfo id="SPART" size="2" type="STRING"/>
					<record>
						<FR_VB></FR_VB>
						<FR_VG></FR_VG>
						<FR_YM></FR_YM>
						<SMAN></SMAN>
						<SPART></SPART>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list" OnColumnChanged="ds_list_OnColumnChanged">
				<Contents>
					<colinfo id="STATUS" size="256" type="STRING"/>
					<colinfo id="STATUS_PLAN" size="256" type="STRING"/>
					<colinfo id="VBELN" size="256" type="STRING"/>
					<colinfo id="BSTKD" size="256" type="STRING"/>
					<colinfo id="AUART" size="256" type="STRING"/>
					<colinfo id="VTWEG" size="256" type="STRING"/>
					<colinfo id="SPART" size="256" type="STRING"/>
					<colinfo id="VKBUR" size="256" type="STRING"/>
					<colinfo id="VKBURT" size="256" type="STRING"/>
					<colinfo id="VKGRP" size="256" type="STRING"/>
					<colinfo id="VKGRPT" size="256" type="STRING"/>
					<colinfo id="ZKUNNRT" size="256" type="STRING"/>
					<colinfo id="KUNNRT" size="256" type="STRING"/>
					<colinfo id="KUNNR_RGT" size="256" type="STRING"/>
					<colinfo id="KUNWET" size="256" type="STRING"/>
					<colinfo id="LAND1" size="256" type="STRING"/>
					<colinfo id="LANDX" size="256" type="STRING"/>
					<colinfo id="ZAREA" size="256" type="STRING"/>
					<colinfo id="ZAREAT" size="256" type="STRING"/>
					<colinfo id="ZDETAIL" size="256" type="STRING"/>
					<colinfo id="PEDAT" size="256" type="STRING"/>
					<colinfo id="VDATU" size="256" type="STRING"/>
					<colinfo id="EDATE" size="256" type="STRING"/>
					<colinfo id="ZTERMT" size="256" type="STRING"/>
					<colinfo id="NETWR" size="256" type="STRING"/>
					<colinfo id="RK_NETWR" size="256" type="STRING"/>
					<colinfo id="MI_NETWR" size="256" type="STRING"/>
					<colinfo id="RE_NETWR" size="256" type="STRING"/>
					<colinfo id="BISP01" size="13" type="DECIMAL"/>
					<colinfo id="BISRE" size="256" type="STRING"/>
					<colinfo id="BISNE" size="256" type="STRING"/>
					<colinfo id="NCOLD" size="256" type="STRING"/>
					<colinfo id="BISP02" size="13" type="DECIMAL"/>
					<colinfo id="BISP03" size="13" type="DECIMAL"/>
					<colinfo id="BISP04" size="13" type="DECIMAL"/>
					<colinfo id="BISP05" size="13" type="DECIMAL"/>
					<colinfo id="BISP06" size="13" type="DECIMAL"/>
					<colinfo id="BISP07" size="13" type="DECIMAL"/>
					<colinfo id="BISP08" size="13" type="DECIMAL"/>
					<colinfo id="BISP09" size="13" type="DECIMAL"/>
					<colinfo id="BISP10" size="13" type="DECIMAL"/>
					<colinfo id="BISP11" size="13" type="DECIMAL"/>
					<colinfo id="BISP12" size="13" type="DECIMAL"/>
					<colinfo id="BISP13" size="13" type="DECIMAL"/>
					<colinfo id="BISP14" size="13" type="DECIMAL"/>
					<colinfo id="BISP15" size="13" type="DECIMAL"/>
					<colinfo id="BISP16" size="13" type="DECIMAL"/>
					<colinfo id="BISP17" size="13" type="DECIMAL"/>
					<colinfo id="BISP18" size="13" type="DECIMAL"/>
					<colinfo id="BISP19" size="13" type="DECIMAL"/>
					<colinfo id="BISP20" size="13" type="DECIMAL"/>
					<colinfo id="BISP21" size="13" type="DECIMAL"/>
					<colinfo id="BISP22" size="13" type="DECIMAL"/>
					<colinfo id="BISP23" size="13" type="DECIMAL"/>
					<colinfo id="BISP24" size="13" type="DECIMAL"/>
					<colinfo id="WAERK" size="256" type="STRING"/>
					<colinfo id="FLAG" size="1" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_error">
				<Contents>
					<colinfo id="IDX" size="256" type="STRING"/>
					<colinfo id="ERRMSG" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_yearf_cd">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_yeart_cd">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_monthf_cd">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
					<record>
						<CODE>01</CODE>
						<CODE_NAME>1월</CODE_NAME>
					</record>
					<record>
						<CODE>02</CODE>
						<CODE_NAME>2월</CODE_NAME>
					</record>
					<record>
						<CODE>03</CODE>
						<CODE_NAME>3월</CODE_NAME>
					</record>
					<record>
						<CODE>04</CODE>
						<CODE_NAME>4월</CODE_NAME>
					</record>
					<record>
						<CODE>05</CODE>
						<CODE_NAME>5월</CODE_NAME>
					</record>
					<record>
						<CODE>06</CODE>
						<CODE_NAME>6월</CODE_NAME>
					</record>
					<record>
						<CODE>07</CODE>
						<CODE_NAME>7월</CODE_NAME>
					</record>
					<record>
						<CODE>08</CODE>
						<CODE_NAME>8월</CODE_NAME>
					</record>
					<record>
						<CODE>09</CODE>
						<CODE_NAME>9월</CODE_NAME>
					</record>
					<record>
						<CODE>10</CODE>
						<CODE_NAME>10월</CODE_NAME>
					</record>
					<record>
						<CODE>11</CODE>
						<CODE_NAME>11월</CODE_NAME>
					</record>
					<record>
						<CODE>12</CODE>
						<CODE_NAME>12월</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_montht_cd">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
					<record>
						<CODE>01</CODE>
						<CODE_NAME>1월</CODE_NAME>
					</record>
					<record>
						<CODE>02</CODE>
						<CODE_NAME>2월</CODE_NAME>
					</record>
					<record>
						<CODE>03</CODE>
						<CODE_NAME>3월</CODE_NAME>
					</record>
					<record>
						<CODE>04</CODE>
						<CODE_NAME>4월</CODE_NAME>
					</record>
					<record>
						<CODE>05</CODE>
						<CODE_NAME>5월</CODE_NAME>
					</record>
					<record>
						<CODE>06</CODE>
						<CODE_NAME>6월</CODE_NAME>
					</record>
					<record>
						<CODE>07</CODE>
						<CODE_NAME>7월</CODE_NAME>
					</record>
					<record>
						<CODE>08</CODE>
						<CODE_NAME>8월</CODE_NAME>
					</record>
					<record>
						<CODE>09</CODE>
						<CODE_NAME>9월</CODE_NAME>
					</record>
					<record>
						<CODE>10</CODE>
						<CODE_NAME>10월</CODE_NAME>
					</record>
					<record>
						<CODE>11</CODE>
						<CODE_NAME>11월</CODE_NAME>
					</record>
					<record>
						<CODE>12</CODE>
						<CODE_NAME>12월</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_auart_cd">
				<Contents>
					<colinfo id="CODE" size="1" type="STRING"/>
					<colinfo id="CODE_NAME" size="1" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_spart_cd">
				<Contents>
					<colinfo id="CODE" size="1" type="STRING"/>
					<colinfo id="CODE_NAME" size="1" type="STRING"/>
					<record>
						<CODE>10</CODE>
						<CODE_NAME>승강기</CODE_NAME>
					</record>
					<record>
						<CODE>20</CODE>
						<CODE_NAME>주차</CODE_NAME>
					</record>
					<record>
						<CODE>30</CODE>
						<CODE_NAME>물류</CODE_NAME>
					</record>
					<record>
						<CODE>40</CODE>
						<CODE_NAME>PSD</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_param">
				<Contents>
					<colinfo id="FR_YM" size="8" type="STRING"/>
					<colinfo id="FR_VB" size="4" type="STRING"/>
					<colinfo id="FR_VG" size="3" type="STRING"/>
					<colinfo id="SMAN" size="10" type="STRING"/>
					<colinfo id="SPART" size="2" type="STRING"/>
					<record>
						<FR_VB></FR_VB>
						<FR_VG></FR_VG>
						<FR_YM></FR_YM>
						<SMAN></SMAN>
						<SPART></SPART>
					</record>
				</Contents>
			</Dataset>
		</Datasets>
		<Shape BKColor="user0" Bottom="34" Height="26" Id="Shape1" Left="8" LineColor="user1" Right="970" TabOrder="1" Top="8" Type="Rectangle" Width="962"></Shape>
		<Shape BKColor="user0" Bottom="59" Height="26" Id="Shape3" Left="8" LineColor="user1" Right="970" TabOrder="2" Top="33" Type="Rectangle" Width="962"></Shape>
		<Static Align="Right" Height="24" Id="st_frymd" Left="9" Style="sty_lb_search" TabOrder="3" Text="기준년월&#32;" Top="9" VAlign="Middle" Width="61"></Static>
		<Static Align="Right" Height="24" Id="st_spart" Left="9" Style="sty_lb_search" TabOrder="4" Text="제품군&#32;" Top="34" VAlign="Middle" Width="61"></Static>
		<Combo Border="Flat" CodeColumn="CODE" Column="YEARF" DataColumn="CODE_NAME" Height="20" Id="cb_yearf" InnerDataset="ds_yearf_cd" Left="71" Style="sty_ipt_search" TabOrder="5" Top="11" Width="62"></Combo>
		<Combo Border="Flat" CodeColumn="CODE" Column="MONTHF" DataColumn="CODE_NAME" Height="20" Id="cb_monthf" InnerDataset="ds_monthf_cd" Left="132" Style="sty_ipt_search" TabOrder="6" Top="11" Width="50"></Combo>
		<Combo Border="Flat" CodeColumn="CODE" Column="CODE_NAME" DataColumn="CODE_NAME" Height="20" Id="cb_spart" InnerDataset="ds_spart_cd" Left="72" Style="sty_ipt_form" TabOrder="7" Top="34" Width="94"></Combo>
		<Static Align="Right" Height="24" Id="Static3" Left="392" Style="sty_lb_search" TabOrder="9" Text="담당자&#32;" Top="9" VAlign="Middle" Width="61"></Static>
		<Div BKColor="user0" Border="Flat" Height="22" Id="div_sman" Left="455" OnLoadCompleted="fn_OnLoadCompleted" OnTimer="WB0199010A_OnTimer" TabOrder="8" Text="Div0" Top="10" Url="COM::Coms002.xml" Width="280">
			<Contents></Contents>
		</Div>
		<Static Align="Right" Height="24" Id="Static4" Left="185" Style="sty_lb_search" TabOrder="11" Text="부서&#32;" Top="9" VAlign="Middle" Width="61"></Static>
		<Static Align="Right" Height="24" Id="Static5" Left="185" Style="sty_lb_search" TabOrder="12" Text="팀&#32;" Top="34" VAlign="Middle" Width="61"></Static>
		<Div BKColor="user0" Height="44" Id="div_vbvg" Left="248" OnLoadCompleted="fn_OnLoadCompleted" OnTimer="WB0199010A_OnTimer" TabOrder="10" Text="Div0" Top="9" Url="COM::Coms001.xml" Width="132">
			<Contents></Contents>
		</Div>
		<Grid AutoFitEndLine="Hide" BindDataset="ds_list" BkColor2="default" BoldHead="true" Border="Flat" Bottom="552" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="488" Id="grd_list" InputPanel="FALSE" Left="8" LineColor="user20" LineType="ExHORZ" OnHeadClick="grd_list_OnHeadClick" Right="974" RowHeight="20" Style="sty_grid" TabOrder="13" TabStop="true" Top="64" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="966">
			<contents>
				<format id="Default">
					<columns>
						<col fix="left" width="30"/>
						<col fix="left" width="40"/>
						<col fix="left" width="38"/>
						<col fix="left" width="53"/>
						<col fix="left" width="100"/>
						<col fix="left" width="135"/>
						<col width="100"/>
						<col width="95"/>
						<col width="99"/>
						<col width="92"/>
						<col width="127"/>
						<col width="86"/>
						<col width="139"/>
						<col width="92"/>
						<col width="119"/>
						<col width="119"/>
						<col width="81"/>
						<col width="81"/>
						<col width="81"/>
						<col width="81"/>
						<col width="81"/>
						<col width="81"/>
						<col width="81"/>
						<col width="81"/>
						<col width="81"/>
						<col width="81"/>
						<col width="81"/>
						<col width="81"/>
						<col width="81"/>
						<col width="81"/>
						<col width="81"/>
						<col width="81"/>
						<col width="81"/>
						<col width="81"/>
						<col width="110"/>
						<col width="110"/>
						<col width="110"/>
						<col width="110"/>
						<col width="110"/>
						<col width="110"/>
						<col width="110"/>
						<col width="110"/>
						<col width="110"/>
						<col width="110"/>
						<col width="110"/>
						<col width="110"/>
						<col width="110"/>
						<col width="110"/>
						<col width="110"/>
						<col width="110"/>
						<col width="110"/>
						<col width="110"/>
						<col width="110"/>
						<col width="110"/>
						<col width="110"/>
						<col width="110"/>
						<col width="110"/>
						<col width="80"/>
					</columns>
					<head>
						<cell bkimageid="icon_grid_sel" col="0" display="text"/>
						<cell align="center" col="1" color="user21" display="text" font="굴림,9" text="No"/>
						<cell align="center" col="2" color="user21" display="text" font="굴림,9" text="상태"/>
						<cell align="center" col="3" color="user21" display="text" font="굴림,9" text="계획상태"/>
						<cell align="center" col="4" color="user21" display="text" font="굴림,9" text="S/O&#32;번호"/>
						<cell align="center" col="5" color="user21" display="text" font="굴림,9" text="현장명&#32;"/>
						<cell align="center" col="6" color="user21" display="text" font="굴림,9" text="오더유형"/>
						<cell align="center" col="7" color="user21" display="text" font="굴림,9" text="유통경로"/>
						<cell align="center" col="8" color="user21" display="text" font="굴림,9" text="제품군"/>
						<cell col="9" color="user21" display="text" font="굴림,9" text="부서코드"/>
						<cell align="center" col="10" color="user21" display="text" font="굴림,9" text="부서명"/>
						<cell align="center" col="11" color="user21" display="text" font="굴림,9" text="팀코드"/>
						<cell align="center" col="12" color="user21" display="text" font="굴림,9" text="팀명"/>
						<cell align="center" col="13" color="user21" display="text" font="굴림,9" text="담당자"/>
						<cell align="center" col="14" color="user21" display="text" font="굴림,9" text="거래선"/>
						<cell align="center" col="15" color="user21" display="text" font="굴림,9" text="지급처"/>
						<cell align="center" col="16" color="user21" display="text" font="굴림,9" text="납품처"/>
						<cell align="center" col="17" color="user21" display="text" font="굴림,9" text="국가"/>
						<cell align="center" col="18" color="user21" display="text" font="굴림,9" text="국가"/>
						<cell align="center" col="19" color="user21" display="text" font="굴림,9" text="권역"/>
						<cell align="center" col="20" color="user21" display="text" font="굴림,9" text="권역명"/>
						<cell align="center" col="21" color="user21" display="text" font="굴림,9" text="부서세분"/>
						<cell align="center" col="22" color="user21" display="text" font="굴림,9" text="이전납기일"/>
						<cell align="center" col="23" color="user21" display="text" font="굴림,9" text="납기일"/>
						<cell align="center" col="24" color="user21" display="text" font="굴림,9" text="납기변경일"/>
						<cell align="center" col="25" color="user21" display="text" font="굴림,9" text="수금조건"/>
						<cell align="center" col="26" color="user21" display="text" font="굴림,9" text="수주금액"/>
						<cell align="center" col="27" color="user21" display="text" font="굴림,9" text="청구금액"/>
						<cell align="center" col="28" color="user21" display="text" font="굴림,9" text="전월미청구액"/>
						<cell align="center" col="29" color="user21" display="text" font="굴림,9" text="미청구액"/>
						<cell align="center" col="30" color="user21" display="text" font="굴림,9" text="기준월실적"/>
						<cell align="center" col="31" color="user21" display="text" font="굴림,9" text="미수잔액"/>
						<cell align="center" col="32" color="user21" display="text" font="굴림,9" text="이월금액"/>
						<cell align="center" col="33" color="user21" display="text" font="굴림,9" text="수금예정일"/>
						<cell align="center" col="34" color="user21" display="text" font="굴림,9" text="BISP02"/>
						<cell align="center" col="35" color="user21" display="text" font="굴림,9" text="BISP03"/>
						<cell align="center" col="36" color="user21" display="text" font="굴림,9" text="BISP04"/>
						<cell col="37" color="user21" display="text" expandfont="굴림,9" font="굴림,9" text="BISP05"/>
						<cell col="38" color="user21" display="text" font="굴림,9" text="BISP06"/>
						<cell col="39" color="user21" display="text" font="굴림,9" text="BISP07"/>
						<cell col="40" color="user21" display="text" font="굴림,9" text="BISP08"/>
						<cell col="41" color="user21" display="text" font="굴림,9" text="BISP09"/>
						<cell col="42" color="user21" display="text" font="굴림,9" text="BISP10"/>
						<cell col="43" color="user21" display="text" font="굴림,9" text="BISP11"/>
						<cell col="44" color="user21" display="text" font="굴림,9" text="BISP12"/>
						<cell col="45" color="user21" display="text" font="굴림,9" text="BISP13"/>
						<cell col="46" color="user21" display="text" font="굴림,9" text="BISP14"/>
						<cell col="47" color="user21" display="text" font="굴림,9" text="BISP15"/>
						<cell col="48" color="user21" display="text" font="굴림,9" text="BISP16"/>
						<cell col="49" color="user21" display="text" font="굴림,9" text="BISP17"/>
						<cell col="50" color="user21" display="text" font="굴림,9" text="BISP18"/>
						<cell col="51" color="user21" display="text" font="굴림,9" text="BISP19"/>
						<cell col="52" color="user21" display="text" font="굴림,9" text="BISP20"/>
						<cell col="53" color="user21" display="text" font="굴림,9" text="BISP21"/>
						<cell col="54" color="user21" display="text" font="굴림,9" text="BISP22"/>
						<cell col="55" color="user21" display="text" font="굴림,9" text="BISP23"/>
						<cell col="56" color="user21" display="text" font="굴림,9" text="BISP24"/>
						<cell col="57" color="user21" display="text" font="굴림,9" text="통화단위"/>
					</head>
					<body>
						<cell bkimageid='expr:gfn_getFlagBkImageID(getColumn(currow,&#32;&quot;FLAG&quot;))' col="0" display="text"/>
						<cell align="center" col="1" display="text" expr="currow+1"/>
						<cell align="center" col="2" colid="STATUS" display="text">
							<cell align="right" col="0" colid="VBELN" display="text"/>
							<cell col="0" display="text" row="1"/>
						</cell>
						<cell align="center" col="3" colid="STATUS_PLAN" display="text">
							<cell align="right" col="0" colid="VBELN" display="text"/>
							<cell col="0" display="text" row="1"/>
						</cell>
						<cell align="left" col="4" colid="VBELN" display="text">
							<cell align="right" col="0" colid="VBELN" display="text"/>
							<cell col="0" display="text" row="1"/>
						</cell>
						<cell align="left" bkcolor2="user22" col="5" colid="BSTKD" display="text"/>
						<cell align="left" bkcolor2="user22" col="6" colid="AUART" display="text"/>
						<cell align="center" bkcolor2="user22" col="7" colid="VTWEG" display="text"/>
						<cell align="right" bkcolor2="user22" col="8" colid="SPART" display="text"/>
						<cell col="9" colid="VKBUR" display="text"/>
						<cell align="right" bkcolor2="user22" col="10" colid="VKBURT" display="text"/>
						<cell align="right" bkcolor2="user22" col="11" colid="VKGRP" display="text"/>
						<cell align="right" bkcolor2="user22" col="12" colid="VKGRPT" display="text"/>
						<cell align="right" bkcolor2="user22" col="13" colid="ZKUNNRT" display="text"/>
						<cell align="right" bkcolor2="user22" col="14" colid="KUNNRT" display="text"/>
						<cell align="center" bkcolor2="user22" col="15" colid="KUNNR_RGT" display="text"/>
						<cell align="right" bkcolor2="user22" col="16" colid="KUNWET" display="text"/>
						<cell align="right" bkcolor2="user22" col="17" colid="LAND1" display="text"/>
						<cell align="right" bkcolor2="user22" col="18" colid="LANDX" display="text"/>
						<cell align="right" bkcolor2="user22" col="19" colid="ZAREA" display="text"/>
						<cell align="right" bkcolor2="user22" col="20" colid="ZAREAT" display="text"/>
						<cell align="right" bkcolor2="user22" col="21" colid="ZDETAIL" display="text"/>
						<cell align="right" bkcolor2="user22" col="22" colid="PEDAT" display="date"/>
						<cell align="right" bkcolor2="user22" col="23" colid="VDATU" display="date"/>
						<cell align="right" bkcolor2="user22" col="24" colid="EDATE" display="date"/>
						<cell align="right" bkcolor2="user22" col="25" colid="ZTERMT" display="text"/>
						<cell align="right" bkcolor2="user22" col="26" colid="NETWR" display="number"/>
						<cell align="right" bkcolor2="user22" col="27" colid="RK_NETWR" display="number"/>
						<cell align="right" bkcolor2="user22" col="28" colid="MI_NETWR" display="number"/>
						<cell align="right" bkcolor2="user22" col="29" colid="RE_NETWR" display="number"/>
						<cell align="right" bkcolor2="user22" col="30" colid="BISP01" display="number"/>
						<cell align="right" bkcolor2="user22" col="31" colid="BISRE" display="number"/>
						<cell align="right" bkcolor2="user22" col="32" colid="BISNE" display="number"/>
						<cell align="right" bkcolor2="user22" col="33" colid="NCOLD" display="date"/>
						<cell align="right" bkcolor2="user22" col="34" colid="BISP02" display="numberexp" edit="masknumber" Mask="###,###,##0.#0"/>
						<cell align="right" bkcolor2="user22" col="35" colid="BISP03" display="numberexp" edit="masknumber" Mask="###,###,##0.#0"/>
						<cell align="right" bkcolor2="user22" col="36" colid="BISP04" display="numberexp" edit="masknumber" Mask="###,###,##0.#0"/>
						<cell col="37" colid="BISP05" display="numberexp" edit="masknumber" Mask="###,###,##0.#0"/>
						<cell col="38" colid="BISP06" display="numberexp" edit="masknumber" Mask="###,###,##0.#0"/>
						<cell col="39" colid="BISP07" display="numberexp" edit="masknumber" Mask="###,###,##0.#0"/>
						<cell col="40" colid="BISP08" display="numberexp" edit="masknumber" Mask="###,###,##0.#0"/>
						<cell col="41" colid="BISP09" display="numberexp" edit="masknumber" Mask="###,###,##0.#0"/>
						<cell col="42" colid="BISP10" display="numberexp" edit="masknumber" Mask="###,###,##0.#0"/>
						<cell col="43" colid="BISP11" display="numberexp" edit="masknumber" Mask="###,###,##0.#0"/>
						<cell col="44" colid="BISP12" display="numberexp" edit="masknumber" Mask="###,###,##0.#0"/>
						<cell col="45" colid="BISP13" display="numberexp" edit="masknumber" Mask="###,###,##0.#0"/>
						<cell col="46" colid="BISP14" display="numberexp" edit="masknumber" Mask="###,###,##0.#0"/>
						<cell col="47" colid="BISP15" display="numberexp" edit="masknumber" Mask="###,###,##0.#0"/>
						<cell col="48" colid="BISP16" display="numberexp" edit="masknumber" Mask="###,###,##0.#0"/>
						<cell col="49" colid="BISP17" display="numberexp" edit="masknumber" Mask="###,###,##0.#0"/>
						<cell col="50" colid="BISP18" display="numberexp" edit="masknumber" Mask="###,###,##0.#0"/>
						<cell col="51" colid="BISP19" display="numberexp" edit="masknumber" Mask="###,###,##0.#0"/>
						<cell col="52" colid="BISP20" display="numberexp" edit="masknumber" Mask="###,###,##0.#0"/>
						<cell col="53" colid="BISP21" display="numberexp" edit="masknumber" Mask="###,###,##0.#0"/>
						<cell col="54" colid="BISP22" display="numberexp" edit="masknumber" Mask="###,###,##0.#0"/>
						<cell col="55" colid="BISP23" display="numberexp" edit="masknumber" Mask="###,###,##0.#0"/>
						<cell col="56" colid="BISP24" display="numberexp" edit="masknumber" Mask="###,###,##0.#0"/>
						<cell col="57" colid="WAERK" display="text"/>
					</body>
				</format>
			</contents>
		</Grid>
	</Form>
	<Script><![CDATA[/*
 ******************************************************************************************
 * 기      능   : 
 * 작  성  자   : 
 * 작성  일자   : 
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
#include "LIB::commons.js";	// 공통 스크립트 
#include "LIB::nsfRequest.js";	// 공통 스크립트 
#include "LIB::common_hdel.js";	// 공통 스크립트  /* GNY 추가 */
//=========================================================================================
// [ PART 1 ]
// Form에서 사용될 전역변수를 선언
// FORM에서 사용되는 전역변수는 대문자로 작성하며, F_XXX 의 형태를 갖도록 한다. 
//=========================================================================================
 // 저장 후  재 조회시  저장한 row  선택 
var nSelectRow = 0; 
//=========================================================================================
// [ PART 2 ]
// Form Loading / Unloading 시 작업 정의
//=========================================================================================
function fn_OnLoadCompleted(obj) {
	// Form 로드 이벤트 맨 첫줄에 기술 
	gfn_initForm(true);

	fn_init_form(); 	// 폼 초기화

}

/********************************************************************************
* 기      능   : 지급예정년 계산(현재년도,당해년도에서 뺄 년수, 당해년도에서 더할 년수
********************************************************************************/
function fn_makeYear(curYear,sNum,eNum) {
	var rowCnt = eNum-sNum;
	var row = 0;

	for(var i=rowCnt; i>-1; i--) {
		ds_yearf_cd.AddRow();
		ds_yearf_cd.SetColumn(row,"CODE",parseInt(curYear)+i+parseInt(sNum));
		ds_yearf_cd.SetColumn(row,"CODE_NAME",(parseInt(curYear)+i+parseInt(sNum))+"년");
		row++;
	}

	cb_yearf.index = eNum;
}

/********************************************************************************
* 기      능   : form UnloadCompleted 
********************************************************************************/
function fn_OnUnloadCompleted(obj) {
	return gfn_isFormUnload(obj);
}

//=========================================================================================
// [ PART 3 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,form닫기)
//=========================================================================================
/********************************************************************************
* 기      능   : 조회 1
********************************************************************************/
function fn_query() {

	if (fn_valid_chk("query") == false)  return;
	
	var frYear  = ds_yearf_cd.GetColumn(cb_yearf.Index, "CODE");
	var frMonth = ds_monthf_cd.GetColumn(cb_monthf.Index, "CODE");
	var spart   = ds_spart_cd.GetColumn(cb_spart.Index, "CODE");
	
	ds_cond.ClearData();
	ds_cond.AddRow();
	
	

	ds_cond.SetColumn(0, "FR_VB", div_vbvg.cb_frvb.Value);
	ds_cond.SetColumn(0, "FR_VG", div_vbvg.cb_frvg.Value);	
	ds_cond.SetColumn(0, "FR_YM", frYear + frMonth);
	ds_cond.SetColumn(0, "SMAN" , div_sman.ed_sman_cd.Text);
	ds_cond.SetColumn(0, "SPART", spart);


	// 서비스 호출
	nsfRequest("query"									// srvId
				, "Sbp0060/find"						// url
				, "ds_cond=ds_cond"						// inDsList
				, "ds_list=ds_list ds_error=ds_error"	// outDsList
				, ""									// strParam
				, "fn_afterQuery"						// CallBackFunc
				);

    fn_createWait("",this);     // 처리중입니다. 메시지 처리
}

/********************************************************************************
* 기      능   : 폼 초기화
********************************************************************************/
function fn_init_form() {

	var curYear = substr(gfn_getCurrDate(),0,4);
//	fn_makeYear(curYear,-1,10);
	fn_makeYear(curYear,-4,1);
	cb_monthf.index = parseInt(substr(gfn_getCurrDate(),4,2))-1;

	// 오더유형 콤보목록 조회
	nsfRequest("query", "combo/comboAuart", "ds_auart_cd=ds_auart_cd"
										  , "ds_auart_cd=ds_auart_cd ds_error=ds_error"
										  , ""
										  , "fn_afterAuart");
	div_sman.Border = "none";

	gfn_insertEmptyRow(ds_spart_cd, G_CODE_ALL);
	cb_spart.index  = 0;

	cb_yearf.SetFocus();
} 

/********************************************************************************
* 기      능   : 닫기  
********************************************************************************/
function fn_close() {
	close();
}

/********************************************************************************
* 기      능   : 액셀  
********************************************************************************/
function fn_excel() {
}

//=========================================================================================
// [ PART 4]
// Callback 함수 정의 : callback 함수명은 메인 함수의 fn_xxxx() 에서 xxxx 부분은 fn_afterXXXX()
// 형태가 되도록 작성 
//=========================================================================================
/********************************************************************************
* 기      능   : 조회 Callback  
********************************************************************************/
function fn_afterQuery(svcId, errCode, errMsg) { 

	fn_destroyWait();
	
	trace(ds_list.SaveXML());
	trace("svcId = " + svcId);
	
	if(ds_error.rowcount() > 0) {  
		trace("fn_Query FAILED!!! "
		       + "[idx : " 			+ ds_error.GetColumn(0,"IDX") + "] "
		       + "[error message : "+ ds_error.GetColumn(0,"ERRMSG") + "]"
		       );		       
		gfn_showMsg("CE00001");
		// error 정보 표시 
		gfn_openWSErrorWin(grd_list, ds_list, ds_error, "FLAG");
	} else {
	
		if(svcId == "query") {
			// 저장 후  선택한 row 찾아가기 
			ds_list.row = nSelectRow;
			
			// 저장  하기 위해  필요한 값  셋팅  FR_YM 
			var frYear  = ds_yearf_cd.GetColumn(cb_yearf.Index, "CODE");
			var frMonth = ds_monthf_cd.GetColumn(cb_monthf.Index, "CODE");
		
			ds_param.SetColumn(0, "FR_YM", frYear + frMonth);
			
			trace("query trace List");
		
		}
		
		if(svcId == "update") {
			nSelectRow  = ds_list.currow; 
			fn_query();
			
			trace("update trace List");
		}
		
		// 조회된 자료가 있을 경우 그리드 첫번째 행에 포커스 위치시킨다.
		if (ds_list.RowCount() > 0) 
		{
			var iCnt = 34;

			var nMM = toNumber(cb_monthf.Value);
			var nYY = toNumber(substr(cb_yearf.Value,2,2));

			for( var i = 0 ;  i < 23; i++ ) { 

				if (nMM == 12) {
					nYY = toNumber(nYY) + 1;
					nMM = "1";
				} else {
					nMM = toNumber(nMM) + 1; 
				}
				
				if (toNumber(nYY) < 10) {
					nYY = lpad(nYY, "0", 2); 
				}
				if (toNumber(nMM) < 10) {
					nMM = lpad(nMM, "0", 2); 
				}

				var Yyyymm = toString(nYY) + toString(nMM) + "월 계획금액";

				grd_list.SetCellProp("head", iCnt, "text", Yyyymm);

				iCnt++;
			}

			grd_list.SetFocus();
			trace("fn_Query SUCCESS!!! [건수 : " + ds_list.RowCount() + "]");
			gfn_showMsg("CE00001");
		} else {			
			trace("fn_Query SUCCESS!!! 건수없음");
			gfn_showMsg("CI00002", ds_list.RowCount() + "");
		}
	}
	
	trace("fn_afterQuery 호출 end");
}


// 항목 오류 검증
// pProcGb : 처리구분 (query:조회,excel:엑셀)
function fn_valid_chk(pProcGb)
{   
 	switch(pProcGb)
	{
		case "query" :   
			if (length(cb_yearf.Value) == 0)
			{
				alert("기준년을 선택하시기 바랍니다.");
				gfn_SetFocus(cb_yearf,"Y"); 
				return false;
			} 
			if (length(cb_monthf.Value) == 0)
			{
				alert("기준월을 선택하시기 바랍니다.");
				gfn_SetFocus(cb_monthf,"Y"); 
				return false;
			}
			if (length(cb_spart.Value) == 0)
			{
				alert("제품군을 선택하시기 바랍니다.");
				gfn_SetFocus(cb_spart,"Y"); 
				return false;
			} 
			if (length(div_vbvg.cb_frvb.Value) == 0)
			{
				alert("부서를 선택하시기 바랍니다.");
				gfn_SetFocus(div_vbvg.cb_frvb,"Y"); 
				return false;
			} 
			if (length(div_vbvg.cb_frvg.Value) == 0)
			{
				alert("팀을 선택하시기 바랍니다.");
				gfn_SetFocus(div_vbvg.cb_frvg,"Y"); 
				return false;
			} 
			if (length(div_sman.ed_sman_cd.Text) == 0)
			{
				alert("담당자명으로 조회하실 수 없습니다. 담당자를 선택하시기 바랍니다.");
				gfn_SetFocus(div_sman.ed_sman_nm,"Y"); 
				return false;
			} 
			break;  
			
		case "excel" :   // 엑셀
			
			if (ds_list.RowCount() <=0)
			{
				alert("조회된 자료가 없습니다.");
				//gfn_showMsg("CI00002", ds_list.RowCount() + "");
				return false;
			}
			break;
		default: 
			break; 
	}   

	return true;
}

//=========================================================================================
// [ PART 6 ]
// component Event 정의 : 각 Component 별 이벤트 
//=========================================================================================
/********************************************************************************
* 기      능   : 정렬 처리 
********************************************************************************/
function grd_list_OnHeadClick(obj,nCell,nX,nY,nPivotIndex) {
	if( nCell == 0 ) {
		gfn_selectAllGrid(obj,nCell,nCell,true);
	} else {
		gfn_sortGrid(obj, nCell);
	}	
}

/********************************************************************************
* 기      능   : 데이터셋 값 변경 시 - Flag 처리 
********************************************************************************/
function ds_list_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{
	gfn_changeFlag( obj, strColumnID, nRow, "FLAG" );
}

/********************************************************************************
* 기      능   : 조회
********************************************************************************/
function fn_OnClick_btn(obj) {
	var fncName = "fn_" + substr(obj.id, 4); 
	eval( fncName + "()");
}

/********************************************************************************
* 기      능   : 저장 
********************************************************************************/
function fn_save() 
{
	if(ds_list.GetUpdate() == false) {
		 alert("변경 된사항 이 없습니다." ); 

		 return false; 
    } 

	if(!Confirm("저장하시겠습니까?")){
	   return;
	}

	// 서비스 호출
	nsfRequest("update"									// srvId
				, "Sbp0060/update"						// url
				, "ds_param = ds_param ds_list=ds_list:u"						// inDsList
				, "ds_result=ds_result ds_error=ds_error"	// outDsList
				, ""									// strParam
				, "fn_afterQuery"						// CallBackFunc
				);

    fn_createWait("",this);     // 처리중입니다. 메시지 처리
}

/********************************************************************************
* 기      능   : 저장 Callback  
********************************************************************************/
function fn_afterSave(errCode, errMsg) 
{
	gfn_showMsg("CI00003");
}]]></Script>
</Window>