<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="496" Id="CS1242001D" Left="8" OnLoadCompleted="fn_OnLoadCompleted" OnUnloadCompleted="fn_OnUnloadCompleted" PidAttrib="7" Title="매출변경기안&#32;상세" Top="8" Ver="1.0" Width="792" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_list_d">
				<Contents>
					<colinfo id="GNO" size="256" summ="default" type="STRING"/>
					<colinfo id="TEM" size="256" summ="default" type="STRING"/>
					<colinfo id="TEM_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="BSU" size="256" summ="default" type="STRING"/>
					<colinfo id="UPN" size="256" summ="default" type="STRING"/>
					<colinfo id="CST" size="256" summ="default" type="STRING"/>
					<colinfo id="PJT" size="256" summ="default" type="STRING"/>
					<colinfo id="PJTNO" size="256" summ="default" type="STRING"/>
					<colinfo id="BSU_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="SPT" size="256" summ="default" type="STRING"/>
					<colinfo id="NAM" size="256" summ="default" type="STRING"/>
					<colinfo id="USD" size="256" summ="default" type="STRING"/>
					<colinfo id="UMR" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN1" size="256" summ="default" type="STRING"/>
					<colinfo id="CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="TOTMT" size="256" summ="default" type="STRING"/>
					<colinfo id="DRAFT_DATE" size="256" summ="default" type="STRING"/>
					<colinfo id="D_NAME" size="256" summ="default" type="STRING"/>
					<colinfo id="BDGBN" size="256" summ="default" type="STRING"/>
					<record>
						<BDGBN></BDGBN>
						<BSU></BSU>
						<BSU_NM></BSU_NM>
						<CNT></CNT>
						<CST></CST>
						<D_NAME></D_NAME>
						<DRAFT_DATE></DRAFT_DATE>
						<GBN1></GBN1>
						<GNO></GNO>
						<NAM></NAM>
						<PJT></PJT>
						<PJTNO></PJTNO>
						<SPT></SPT>
						<TEM></TEM>
						<TEM_NM></TEM_NM>
						<TOTMT></TOTMT>
						<UMR></UMR>
						<UPN></UPN>
						<USD></USD>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond_d">
				<Contents>
					<colinfo id="GNO" size="256" summ="default" type="STRING"/>
					<colinfo id="DOCNO" size="256" summ="default" type="STRING"/>
					<colinfo id="DOCKIND" size="256" summ="default" type="STRING"/>
					<record>
						<DOCKIND></DOCKIND>
						<DOCNO></DOCNO>
						<GNO></GNO>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list_bd">
				<Contents>
					<colinfo id="YYM" size="256" summ="default" type="STRING"/>
					<colinfo id="YDT" size="256" summ="default" type="STRING"/>
					<colinfo id="HCT" size="256" summ="default" type="STRING"/>
					<colinfo id="AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="HMT" size="256" summ="default" type="STRING"/>
					<colinfo id="DMT" size="256" summ="default" type="STRING"/>
					<colinfo id="TMT" size="256" summ="default" type="STRING"/>
					<colinfo id="BAM" size="256" summ="default" type="STRING"/>
					<colinfo id="GNO" size="256" summ="default" type="STRING"/>
					<colinfo id="DOCNO" size="256" summ="default" type="STRING"/>
					<colinfo id="YYM_B" size="256" summ="default" type="STRING"/>
					<colinfo id="YYM_A" size="256" summ="default" type="STRING"/>
					<colinfo id="YDT_A" size="256" summ="default" type="STRING"/>
					<colinfo id="AMT_A" size="256" summ="default" type="STRING"/>
					<colinfo id="HMT_A" size="256" summ="default" type="STRING"/>
					<colinfo id="DMT_A" size="256" summ="default" type="STRING"/>
					<colinfo id="TMT_A" size="256" summ="default" type="STRING"/>
					<colinfo id="BAM_A" size="256" summ="default" type="STRING"/>
					<colinfo id="TMT_CA" size="256" summ="default" type="STRING"/>
					<colinfo id="HIS" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN_TX" size="256" summ="default" type="STRING"/>
					<colinfo id="REQC" size="256" summ="default" type="STRING"/>
					<colinfo id="REQ" size="256" summ="default" type="STRING"/>
					<colinfo id="UDT" size="256" summ="default" type="STRING"/>
					<colinfo id="MDT" size="256" summ="default" type="STRING"/>
					<colinfo id="CHG" size="256" summ="default" type="STRING"/>
					<colinfo id="TIS" size="256" summ="default" type="STRING"/>
					<colinfo id="BDGBN" size="256" summ="default" type="STRING"/>
					<colinfo id="ACMT" size="256" summ="default" type="STRING"/>
					<colinfo id="ACMT_A" size="256" summ="default" type="STRING"/>
					<record>
						<ACMT></ACMT>
						<ACMT_A></ACMT_A>
						<AMT></AMT>
						<AMT_A></AMT_A>
						<BAM></BAM>
						<BAM_A></BAM_A>
						<BDGBN></BDGBN>
						<CHG></CHG>
						<DMT></DMT>
						<DMT_A></DMT_A>
						<DOCNO></DOCNO>
						<GBN></GBN>
						<GBN_TX></GBN_TX>
						<GNO></GNO>
						<HCT></HCT>
						<HIS></HIS>
						<HMT></HMT>
						<HMT_A></HMT_A>
						<MDT></MDT>
						<REQ></REQ>
						<REQC></REQC>
						<TIS></TIS>
						<TMT></TMT>
						<TMT_A></TMT_A>
						<TMT_CA></TMT_CA>
						<UDT></UDT>
						<YDT></YDT>
						<YDT_A></YDT_A>
						<YYM></YYM>
						<YYM_A></YYM_A>
						<YYM_B></YYM_B>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond_amt">
				<Contents>
					<colinfo id="UPN" size="256" summ="default" type="STRING"/>
					<colinfo id="CST" size="256" summ="default" type="STRING"/>
					<colinfo id="PJT" size="256" summ="default" type="STRING"/>
					<colinfo id="USD" size="256" summ="default" type="STRING"/>
					<colinfo id="UMR" size="256" summ="default" type="STRING"/>
					<colinfo id="CA" size="256" summ="default" type="STRING"/>
					<record>
						<CA></CA>
						<CST></CST>
						<PJT></PJT>
						<UMR></UMR>
						<UPN></UPN>
						<USD></USD>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list_amt">
				<Contents>
					<colinfo id="GNO" size="256" summ="default" type="STRING"/>
					<colinfo id="UPN" size="256" summ="default" type="STRING"/>
					<colinfo id="CST" size="256" summ="default" type="STRING"/>
					<colinfo id="TOT_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="REQ_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="REM_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="REM_AMT2" size="256" summ="default" type="STRING"/>
					<colinfo id="PER_AMT" size="256" summ="default" type="STRING"/>
					<record>
						<CST></CST>
						<GNO></GNO>
						<PER_AMT></PER_AMT>
						<REM_AMT></REM_AMT>
						<REM_AMT2></REM_AMT2>
						<REQ_AMT></REQ_AMT>
						<TOT_AMT></TOT_AMT>
						<UPN></UPN>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_conf_cond">
				<Contents>
					<colinfo id="DOCNO" size="256" summ="default" type="STRING"/>
					<record>
						<DOCNO></DOCNO>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_conf_list">
				<Contents>
					<colinfo id="APRNK_S1" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM_S1" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE_S1" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK_S2" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM_S2" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE_S2" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK_S3" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM_S3" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE_S3" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK_S4" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM_S4" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE_S4" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK_S5" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM_S5" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE_S5" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK_R1" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM_R1" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE_R1" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK_R2" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM_R2" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE_R2" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK_R3" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM_R3" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE_R3" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK_R4" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM_R4" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE_R4" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK_R5" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM_R5" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE_R5" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_draftpers_list">
				<Contents>
					<colinfo id="D_TEM" size="256" summ="default" type="STRING"/>
					<colinfo id="D_RANK" size="256" summ="default" type="STRING"/>
					<colinfo id="D_NAME" size="256" summ="default" type="STRING"/>
					<colinfo id="D_DATE" size="256" summ="default" type="STRING"/>
					<colinfo id="DOCNO" size="256" summ="default" type="STRING"/>
					<colinfo id="D_TOTEM" size="256" summ="default" type="STRING"/>
					<record>
						<D_DATE></D_DATE>
						<D_NAME></D_NAME>
						<D_RANK></D_RANK>
						<D_TEM></D_TEM>
						<D_TOTEM></D_TOTEM>
						<DOCNO></DOCNO>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond_req">
				<Contents>
					<colinfo id="DOCNO" size="256" summ="default" type="STRING"/>
					<record>
						<DOCNO></DOCNO>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list_req">
				<Contents>
					<colinfo id="GNO" size="256" summ="default" type="STRING"/>
					<colinfo id="APSTAT" size="256" summ="default" type="STRING"/>
					<colinfo id="REDPT1" size="256" summ="default" type="STRING"/>
					<colinfo id="DOCNO" size="256" summ="default" type="STRING"/>
					<colinfo id="DOCKIND" size="256" summ="default" type="STRING"/>
					<record>
						<APSTAT></APSTAT>
						<DOCKIND></DOCKIND>
						<DOCNO></DOCNO>
						<GNO></GNO>
						<REDPT1></REDPT1>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list4">
				<Contents>
					<colinfo id="FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="GNO" size="256" summ="default" type="STRING"/>
					<colinfo id="DOCNO" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list_req2">
				<Contents>
					<colinfo id="DOCNO" size="256" summ="default" type="STRING"/>
					<colinfo id="DOCKIND" size="256" summ="default" type="STRING"/>
					<colinfo id="APPGUBN" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQNO" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQSTAT" size="256" summ="default" type="STRING"/>
					<colinfo id="APDPT1" size="256" summ="default" type="STRING"/>
					<colinfo id="APDPT1_N" size="256" summ="default" type="STRING"/>
					<colinfo id="APNUM" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE" size="256" summ="default" type="STRING"/>
					<colinfo id="APTIM" size="256" summ="default" type="STRING"/>
					<colinfo id="APDESC" size="256" summ="default" type="STRING"/>
					<record>
						<APDATE></APDATE>
						<APDESC></APDESC>
						<APDPT1></APDPT1>
						<APDPT1_N></APDPT1_N>
						<APNUM></APNUM>
						<APPGUBN></APPGUBN>
						<APRNK></APRNK>
						<APTIM></APTIM>
						<DOCKIND></DOCKIND>
						<DOCNO></DOCNO>
						<SEQNO></SEQNO>
						<SEQSTAT></SEQSTAT>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_decide">
				<Contents>
					<colinfo id="APDATE" size="24" summ="default" type="STRING"/>
					<colinfo id="APDESC" size="0" summ="default" type="STRING"/>
					<colinfo id="APDPT1" size="24" summ="default" type="STRING"/>
					<colinfo id="APDPT1_N" size="60" summ="default" type="STRING"/>
					<colinfo id="APIRUM" size="60" summ="default" type="STRING"/>
					<colinfo id="APNUM" size="24" summ="default" type="STRING"/>
					<colinfo id="APPGUBN" size="6" summ="default" type="STRING"/>
					<colinfo id="APRNK" size="60" summ="default" type="STRING"/>
					<colinfo id="APTIM" size="18" summ="default" type="STRING"/>
					<colinfo id="DOCKIND" size="3" summ="default" type="STRING"/>
					<colinfo id="DOCNO" size="30" summ="default" type="STRING"/>
					<colinfo id="SEQNO" size="6" summ="default" type="STRING"/>
					<colinfo id="SEQSTAT" size="3" summ="default" type="STRING"/>
					<colinfo id="FLAG" size="3" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list_0">
				<Contents>
					<colinfo id="APDATE" size="24" summ="default" type="STRING"/>
					<colinfo id="APDESC" size="0" summ="default" type="STRING"/>
					<colinfo id="APDPT1" size="24" summ="default" type="STRING"/>
					<colinfo id="APDPT1_N" size="60" summ="default" type="STRING"/>
					<colinfo id="APIRUM" size="60" summ="default" type="STRING"/>
					<colinfo id="APNUM" size="24" summ="default" type="STRING"/>
					<colinfo id="APPGUBN" size="6" summ="default" type="STRING"/>
					<colinfo id="APRNK" size="60" summ="default" type="STRING"/>
					<colinfo id="APTIM" size="18" summ="default" type="STRING"/>
					<colinfo id="DOCKIND" size="3" summ="default" type="STRING"/>
					<colinfo id="DOCNO" size="30" summ="default" type="STRING"/>
					<colinfo id="SEQNO" size="6" summ="default" type="STRING"/>
					<colinfo id="SEQSTAT" size="3" summ="default" type="STRING"/>
					<colinfo id="FLAG" size="3" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list_chk">
				<Contents>
					<colinfo id="DOCNO" size="256" summ="default" type="STRING"/>
					<colinfo id="APPGUBN" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQNO" size="256" summ="default" type="STRING"/>
					<colinfo id="CHKSEQ" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list_final">
				<Contents>
					<colinfo id="FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="GNO" size="256" summ="default" type="STRING"/>
					<colinfo id="HIS" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_gbn">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME></CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_head_0">
				<Contents>
					<colinfo id="MANDT" size="256" summ="default" type="STRING"/>
					<colinfo id="DOCNO" size="256" summ="default" type="STRING"/>
					<colinfo id="DOCKIND" size="256" summ="default" type="STRING"/>
					<colinfo id="APPGUBN" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQNO" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_decide_s">
				<Contents>
					<colinfo id="APDATE" size="24" summ="default" type="STRING"/>
					<colinfo id="APDESC" size="0" summ="default" type="STRING"/>
					<colinfo id="APDPT1" size="24" summ="default" type="STRING"/>
					<colinfo id="APDPT1_N" size="60" summ="default" type="STRING"/>
					<colinfo id="APIRUM" size="60" summ="default" type="STRING"/>
					<colinfo id="APNUM" size="24" summ="default" type="STRING"/>
					<colinfo id="APPGUBN" size="6" summ="default" type="STRING"/>
					<colinfo id="APRNK" size="60" summ="default" type="STRING"/>
					<colinfo id="APTIM" size="18" summ="default" type="STRING"/>
					<colinfo id="DOCKIND" size="3" summ="default" type="STRING"/>
					<colinfo id="DOCNO" size="30" summ="default" type="STRING"/>
					<colinfo id="SEQNO" size="6" summ="default" type="STRING"/>
					<colinfo id="SEQSTAT" size="3" summ="default" type="STRING"/>
					<colinfo id="FLAG" size="3" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond_tis">
				<Contents>
					<colinfo id="GNO" size="256" summ="default" type="STRING"/>
					<colinfo id="HIS" size="256" summ="default" type="STRING"/>
					<record>
						<GNO></GNO>
						<HIS></HIS>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list_tis">
				<Contents>
					<colinfo id="CNT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_rcond">
				<Contents>
					<colinfo id="ZPROGRAM" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN" size="256" summ="default" type="STRING"/>
					<record>
						<GBN></GBN>
						<ZPROGRAM></ZPROGRAM>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_wbap01">
				<Contents>
					<colinfo id="APSTAT" size="3" summ="default" type="STRING"/>
					<colinfo id="CRDATE" size="24" summ="default" type="STRING"/>
					<colinfo id="CRDPT1" size="24" summ="default" type="STRING"/>
					<colinfo id="CRDPT1_N" size="60" summ="default" type="STRING"/>
					<colinfo id="CRIRUM" size="60" summ="default" type="STRING"/>
					<colinfo id="CRTIM" size="18" summ="default" type="STRING"/>
					<colinfo id="DOCKIND" size="3" summ="default" type="STRING"/>
					<colinfo id="DOCNO" size="30" summ="default" type="STRING"/>
					<colinfo id="DOCSEQ" size="6" summ="default" type="STRING"/>
					<colinfo id="REDATE" size="24" summ="default" type="STRING"/>
					<colinfo id="REDPT1" size="24" summ="default" type="STRING"/>
					<colinfo id="REDPT1_N" size="60" summ="default" type="STRING"/>
					<colinfo id="REIRUM" size="60" summ="default" type="STRING"/>
					<colinfo id="RETIM" size="18" summ="default" type="STRING"/>
					<colinfo id="FNAM" size="256" summ="default" type="STRING"/>
					<colinfo id="FSIZE" size="256" summ="default" type="STRING"/>
					<colinfo id="FILE_PATH" size="256" summ="default" type="STRING"/>
					<colinfo id="TELH" size="30" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_wbap02">
				<Contents>
					<colinfo id="APDATE" size="24" summ="default" type="STRING"/>
					<colinfo id="APDESC" size="0" summ="default" type="STRING"/>
					<colinfo id="APDPT1" size="24" summ="default" type="STRING"/>
					<colinfo id="APDPT1_N" size="60" summ="default" type="STRING"/>
					<colinfo id="APIRUM" size="60" summ="default" type="STRING"/>
					<colinfo id="APNUM" size="24" summ="default" type="STRING"/>
					<colinfo id="APPGUBN" size="6" summ="default" type="STRING"/>
					<colinfo id="APRNK" size="60" summ="default" type="STRING"/>
					<colinfo id="APTIM" size="18" summ="default" type="STRING"/>
					<colinfo id="DOCKIND" size="3" summ="default" type="STRING"/>
					<colinfo id="DOCNO" size="30" summ="default" type="STRING"/>
					<colinfo id="DOCSEQ" size="6" summ="default" type="STRING"/>
					<colinfo id="SEQNO" size="6" summ="default" type="STRING"/>
					<colinfo id="SEQSTAT" size="3" summ="default" type="STRING"/>
					<colinfo id="TELH" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
		</Datasets>
		<Shape BKColor="user12" Bottom="346" Height="26" Id="Shape9" Left="10" LineColor="user13" Right="782" TabOrder="39" Top="320" Type="Rectangle" Width="772"></Shape>
		<Shape BKColor="user12" Bottom="472" Height="52" Id="Shape3" Left="10" LineColor="user13" Right="782" TabOrder="11" Top="420" Type="Rectangle" Width="772"></Shape>
		<Shape BKColor="user12" Bottom="66" Height="26" Id="Shape1" Left="10" LineColor="user13" Right="782" TabOrder="3" Top="40" Type="Rectangle" Width="772"></Shape>
		<Grid AutoEnter="TRUE" AutoFitEndLine="Hide" BindDataset="ds_list_bd" BkColor2="default" BoldHead="true" Border="Flat" Bottom="318" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="206" Id="grd_list2" InputPanel="FALSE" Left="8" LineColor="user20" LineType="ExHORZ" Right="780" RowHeight="20" Style="sty_grid" TabOrder="1" TabStop="true" Top="112" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="772">
			<contents>
				<format id="Default">
					<columns>
						<col width="58"/>
						<col width="30"/>
						<col width="45"/>
						<col width="60"/>
						<col width="60"/>
						<col width="60"/>
						<col width="65"/>
						<col width="60"/>
						<col width="58"/>
						<col width="30"/>
						<col width="45"/>
						<col width="60"/>
						<col width="60"/>
						<col width="60"/>
						<col width="65"/>
						<col width="60"/>
						<col width="60"/>
					</columns>
					<head>
						<cell col="0" colspan="8" display="text" font="굴림,9" text="변경전"/>
						<cell col="0" display="text" font="굴림,9" row="1" text="계획연월"/>
						<cell col="1" display="text" font="굴림,9" row="1" text="일자"/>
						<cell col="2" display="text" font="굴림,9" row="1" text="대수"/>
						<cell col="3" display="text" font="굴림,9" row="1" text="유지관리"/>
						<cell col="4" display="text" font="굴림,9" row="1" text="HRTS"/>
						<cell col="5" display="text" font="굴림,9" row="1" text="DI-PBX"/>
						<cell col="6" display="text" font="굴림,9" row="1" text="공기청정기"/>
						<cell col="7" display="text" font="굴림,9" row="1" text="합계"/>
						<cell col="8" colspan="8" display="text" font="굴림,9" text="변경후"/>
						<cell col="16" display="text" font="굴림,9" rowspan="2" text="차이"/>
						<cell col="8" display="text" font="굴림,9" row="1" text="계획연월"/>
						<cell col="9" display="text" font="굴림,9" row="1" text="일자"/>
						<cell col="10" display="text" font="굴림,9" row="1" text="대수"/>
						<cell col="11" display="text" font="굴림,9" row="1" text="유지관리"/>
						<cell col="12" display="text" font="굴림,9" row="1" text="HRTS"/>
						<cell col="13" display="text" font="굴림,9" row="1" text="DI-PBX"/>
						<cell col="14" display="text" font="굴림,9" row="1" text="공기청정기"/>
						<cell col="15" display="text" font="굴림,9" row="1" text="합계"/>
					</head>
					<body>
						<cell align="center" col="0" colid="YYM" display="text" limit="6" Mask="####.##"/>
						<cell align="center" col="1" colid="YDT" display="text" limit="6"/>
						<cell col="2" colid="HCT" display="normal"/>
						<cell col="3" colid="AMT" display="number"/>
						<cell col="4" colid="HMT" display="number"/>
						<cell col="5" colid="DMT" display="number"/>
						<cell col="6" colid="ACMT" display="number"/>
						<cell col="7" colid="TMT" display="number"/>
						<cell align="center" col="8" colid="YYM_A" display="text" limit="6" Mask="####.##"/>
						<cell align="center" col="9" colid="YDT_A" display="text" limit="6"/>
						<cell col="10" colid="HCT" display="normal"/>
						<cell col="11" colid="AMT_A" display="number"/>
						<cell col="12" colid="HMT_A" display="number"/>
						<cell col="13" colid="DMT_A" display="number"/>
						<cell col="14" colid="ACMT_A" display="number"/>
						<cell col="15" colid="TMT_A" display="number"/>
						<cell col="16" colid="TMT_CA" display="number"/>
					</body>
					<summary>
						<cell align="center" bkcolor="user25" col="0" colspan="2" display="text" text="합&#32;&#32;계"/>
						<cell bkcolor="user25" col="2" display="number"/>
						<cell bkcolor="user25" col="3" display="number" expr='ds_list_bd.Sum(&quot;AMT&quot;)'/>
						<cell bkcolor="user25" col="4" display="number" expr='ds_list_bd.Sum(&quot;HMT&quot;)'/>
						<cell bkcolor="user25" col="5" display="number" expr='ds_list_bd.Sum(&quot;DMT&quot;)'/>
						<cell bkcolor="user25" col="6" display="number" expr='ds_list_bd.Sum(&quot;ACMT&quot;)'/>
						<cell bkcolor="user25" col="7" display="number" expr='ds_list_bd.Sum(&quot;TMT&quot;)'/>
						<cell align="center" bkcolor="user25" col="8" colspan="2" display="number"/>
						<cell bkcolor="user25" col="10" display="number"/>
						<cell bkcolor="user25" col="11" display="number" expr='ds_list_bd.Sum(&quot;AMT_A&quot;)'/>
						<cell bkcolor="user25" col="12" display="number" expr='ds_list_bd.Sum(&quot;HMT_A&quot;)'/>
						<cell bkcolor="user25" col="13" display="number" expr='ds_list_bd.Sum(&quot;DMT_A&quot;)'/>
						<cell bkcolor="user25" col="14" display="number" expr='ds_list_bd.Sum(&quot;ACMT_A&quot;)'/>
						<cell bkcolor="user25" col="15" display="number" expr='ds_list_bd.Sum(&quot;TMT_A&quot;)'/>
						<cell bkcolor="user25" col="16" display="number" expr='ds_list_bd.Sum(&quot;TMT_CA&quot;)'/>
					</summary>
				</format>
			</contents>
		</Grid>
		<Div Height="36" Id="div_btn" TabOrder="2" Text="Div0" ToolTipFont="Default,0" Url="WB01::CommBtnForm.xml" Width="792">
			<Contents></Contents>
		</Div>
		<Static Align="Center" Height="24" Id="Static0" Left="299" Style="sty_lb_form_basic" TabOrder="4" Text="보수업체명" Top="41" VAlign="Middle" Width="80"></Static>
		<Edit Align="CENTER" BindDataset="ds_list_d" Border="Flat" Column="BSU_NM" Enable="FALSE" Height="20" Id="ed_vkgrp" Left="381" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="5" Top="43" Width="200"></Edit>
		<Static Align="Center" Height="24" Id="Static2" Left="11" Style="sty_lb_form_basic" TabOrder="6" Text="지사명" Top="41" VAlign="Middle" Width="80"></Static>
		<Shape BKColor="user12" Bottom="421" Height="51" Id="Shape6" Left="10" LineColor="user13" Right="782" TabOrder="7" Top="370" Type="Rectangle" Width="772"></Shape>
		<Static Align="Center" Height="49" Id="st_vkgrp" Left="92" Style="sty_lb_form_basic" TabOrder="8" Text="고객요구안&#32;&#10;&#32;(150자)&#32;" Top="371" VAlign="Middle" Width="80"></Static>
		<Static Align="Center" Height="49" Id="st_cdate" Left="92" Style="sty_lb_form_basic" TabOrder="10" Text="협의결과&#32;&#10;&#32;(150자)&#32;" Top="421" VAlign="Middle" Width="80"></Static>
		<Static Align="Center" Height="99" Id="st_gbn" Left="11" Style="sty_lb_form_basic" TabOrder="9" Text="사유" Top="371" VAlign="Middle" Width="80"></Static>
		<Shape BKColor="user12" Bottom="371" Height="26" Id="Shape2" Left="10" LineColor="user13" Right="782" TabOrder="12" Top="345" Type="Rectangle" Width="772"></Shape>
		<Static Align="Center" Height="24" Id="Static1" Left="92" Style="sty_lb_form_basic" TabOrder="13" Text="사유" Top="346" VAlign="Middle" Width="80"></Static>
		<Static Align="Center" Height="24" Id="Static4" Left="586" Style="sty_lb_form_basic" TabOrder="14" Text="작성일" Top="41" VAlign="Middle" Width="80"></Static>
		<Static Align="Center" Height="24" Id="Static6" Left="11" Style="sty_lb_form_basic" TabOrder="15" Text="구분&#32;" Top="346" VAlign="Middle" Width="80"></Static>
		<Calendar BindDataset="ds_list_bd" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="MDT" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Enable="FALSE" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_draft" Left="669" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="16" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="43" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="110"></Calendar>
		<Edit Align="CENTER" BindDataset="ds_list_d" Border="Flat" Column="TEM_NM" Enable="FALSE" Height="20" Id="ed_tem" Left="93" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="17" Top="43" Width="200"></Edit>
		<Shape BKColor="user12" Bottom="91" Height="26" Id="Shape0" Left="10" LineColor="user13" Right="782" TabOrder="18" Top="65" Type="Rectangle" Width="772"></Shape>
		<Edit Align="CENTER" BindDataset="ds_list_d" Border="Flat" Column="SPT" Enable="FALSE" Height="20" Id="ed_spt" Left="381" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="20" Top="68" Width="200"></Edit>
		<Static Align="Center" Height="24" Id="Static3" Left="299" Style="sty_lb_form_basic" TabOrder="19" Text="현장명" Top="66" VAlign="Middle" Width="80"></Static>
		<Edit Align="CENTER" BindDataset="ds_list_d" Border="Flat" Column="PJTNO" Enable="FALSE" Height="20" Id="ed_pjtno" Left="93" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="23" Top="68" Width="200"></Edit>
		<Static Align="Center" Height="24" Id="Static5" Left="11" Style="sty_lb_form_basic" TabOrder="21" Text="Proj.&#32;No" Top="66" VAlign="Middle" Width="80"></Static>
		<Static Align="Center" Height="24" Id="Static7" Left="586" Style="sty_lb_form_basic" TabOrder="22" Text="대수" Top="66" VAlign="Middle" Width="80"></Static>
		<Edit Align="CENTER" BindDataset="ds_list_d" Border="Flat" Enable="FALSE" Height="20" Id="ed_hct" Left="669" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="24" Top="68" Width="108"></Edit>
		<Shape BKColor="user12" Bottom="116" Height="26" Id="Shape4" Left="10" LineColor="user13" Right="782" TabOrder="25" Top="90" Type="Rectangle" Width="772"></Shape>
		<Static Align="Center" Height="24" Id="Static8" Left="299" Style="sty_lb_form_basic" TabOrder="26" Text="계약기간" Top="91" VAlign="Middle" Width="80"></Static>
		<Edit Align="CENTER" BindDataset="ds_list_d" Border="Flat" Column="NAM" Enable="FALSE" Height="20" Id="ed_nam" Left="93" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="29" Top="93" Width="200"></Edit>
		<Static Align="Center" Height="24" Id="Static9" Left="11" Style="sty_lb_form_basic" TabOrder="27" Text="거래선&#32;명" Top="91" VAlign="Middle" Width="80"></Static>
		<Static Align="Center" Height="24" Id="Static10" Left="586" Style="sty_lb_form_basic" TabOrder="28" Text="계약상품" Top="91" VAlign="Middle" Width="80"></Static>
		<Edit Align="CENTER" BindDataset="ds_list_d" Border="Flat" Column="GBN1" Enable="FALSE" Height="20" Id="ed_gbn" Left="669" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="30" Top="93" Width="108"></Edit>
		<Static Align="Center" Border="None" Color="user7" Font="굴림,9" Height="20" Id="st_btw" Left="472" TabOrder="31" Text="~" Top="93" VAlign="Middle" Width="18"></Static>
		<Calendar BindDataset="ds_list_d" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="USD" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Enable="FALSE" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal-usd" Left="381" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="32" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="93" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="94"></Calendar>
		<Calendar BindDataset="ds_list_d" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="UMR" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Enable="FALSE" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal-umr" Left="487" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="33" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="93" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="94"></Calendar>
		<TextArea BindDataset="ds_list_bd" Border="Flat" Column="REQC" Height="46" Id="tx_reqc" ImeMode="none" Left="173" MaxLength="150" Style="sty_ipt_form" TabOrder="34" Top="372" Width="606"></TextArea>
		<MaskEdit BindDataset="ds_list_amt" Border="Flat" Column="REM_AMT" DisableBKColor="user5" Enable="FALSE" Height="20" Id="me_remamt" Left="492" Style="sty_ipt_form" TabOrder="35" Top="323" Value="0" Width="92"></MaskEdit>
		<MaskEdit BindDataset="ds_list_amt" Border="Flat" Column="TOT_AMT" DisableBKColor="user5" Enable="FALSE" Height="20" Id="me_totamt" Left="108" Style="sty_ipt_form" TabOrder="36" Top="323" Value="0" Width="92"></MaskEdit>
		<MaskEdit BindDataset="ds_list_amt" Border="Flat" Column="REQ_AMT" DisableBKColor="user5" Enable="FALSE" Height="20" Id="me_reqamt" Left="300" Style="sty_ipt_form" TabOrder="37" Top="323" Value="0" Width="92"></MaskEdit>
		<MaskEdit BindDataset="ds_list_amt" Border="Flat" Column="PER_AMT" DecimalLen="1" DisableBKColor="user5" Enable="FALSE" Height="20" Id="me_peramt" Left="684" Style="sty_ipt_form" TabOrder="38" Top="323" Value="0" Width="92"></MaskEdit>
		<Edit Height="27" Id="ed_docno" Left="-1" TabOrder="40" Text="DOCNO" Top="506" Width="71"></Edit>
		<Combo Border="Flat" CodeColumn="CODE" DataColumn="CODE_NAME" Height="20" Id="cb_gbn" INDEX="0" InnerDataset="ds_gbn" Left="173" Style="sty_ipt_form" TabOrder="41" Top="347" Width="220"></Combo>
		<Edit Height="27" Id="ed_chg" Left="73" TabOrder="42" Text="CHG" Top="507" Width="71"></Edit>
		<Static Align="Center" Height="24" Id="Static26" Left="11" Style="sty_lb_form_basic" TabOrder="43" Text="총계약금액" Top="320" VAlign="Middle" Width="95"></Static>
		<Static Align="Center" Height="24" Id="Static13" Left="587" Style="sty_lb_form_basic" TabOrder="44" Text="인하율" Top="321" VAlign="Middle" Width="95"></Static>
		<Static Align="Center" Height="24" Id="Static12" Left="395" Style="sty_lb_form_basic" TabOrder="45" Text="대상액" Top="321" VAlign="Middle" Width="95"></Static>
		<Static Align="Center" Height="24" Id="Static11" Left="202" Style="sty_lb_form_basic" TabOrder="46" Text="청구액" Top="320" VAlign="Middle" Width="95"></Static>
		<TextArea BindDataset="ds_list_bd" Border="Flat" Column="REQ" Height="46" Id="tx_req" ImeMode="none" Left="173" MaxLength="150" Style="sty_ipt_form" TabOrder="47" Top="423" Width="606"></TextArea>
		<Button ButtonStyle="TRUE" Cursor="HAND" Enable="FALSE" Height="20" Id="btn_tmp_accpt" ImageID="btn_sub_16" Left="10" LeftMargin="12" OnClick="bt_imsiaccpt_OnClick" Style="sty_btn" TabOrder="48" Text="수신결재완료&#32;확인후&#32;강제실행" Top="473" Transparent="TRUE" Visible="FALSE" Width="216"></Button>
	</Form>
	<Script><![CDATA[/*
 ******************************************************************************************
 * 기      능   : 
 * 작  성  자   : 
 * 작성  일자   : 
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
#include "LIB::commons.js";	// 공통 스크립트 
#include "LIB::common_cs.js";	// 서비스 공통 스크립트
//=========================================================================================
// [ PART 1 ]
// Form에서 사용될 전역변수를 선언
// FORM에서 사용되는 전역변수는 대문자로 작성하며, F_XXX 의 형태를 갖도록 한다. 
//=========================================================================================

var fa_gno;
var fa_doc;
var fa_docno;
var g_docno;
var cnt = 0;
var seungin_auth = false;
var vDPT = "";
var vVkbur = "";
//=========================================================================================
// [ PART 2 ]
// Form Loading / Unloading 시 작업 정의
//=========================================================================================
function fn_OnLoadCompleted(obj) {
	gfn_initForm();
	
	var codeArr = ["CS184"];
	var dsObjArr = [ds_gbn];
	var addTypeArr = [G_CODE_SELECT];
	gfn_searchCommCode(codeArr, dsObjArr, addTypeArr);
	
	div_btn.btn_decide.Enable = false;
	div_btn.btn_draft.Enable = true;
	div_btn.btn_sendback.Enable = false;

	//ufn_btnControl();
	
	// 강제승인 버튼 권한부여
	gfn_initDs(ds_rcond, true);
	ds_rcond.SetColumn(0, "ZPROGRAM", "CS1242001D");
	ds_rcond.SetColumn(0, "GBN", "01");	
	seungin_auth = gfn_getAuth(ds_rcond);
	ds_rcond.ClearData();
	
	if(seungin_auth == true) {
		btn_tmp_accpt.Visible =true;
		btn_tmp_accpt.Enable = true;
	}
	//============== 수신부서 결재그룹 체크 ===============================	
	gfn_initDs(ds_rcond, true);
	ds_rcond.SetColumn(0, "ZPROGRAM", "WBAP_DOCKIND");
	ds_rcond.SetColumn(0, "GBN", "01");	
	vDPT = gfn_getAuthDpt(ds_rcond);
	ds_rcond.ClearData();
    //=========================================================    
	
	ds_cond_d.SetColumn(0, "GNO", fa_gno);
	ds_cond_d.setColumn(0, "DOCNO", fa_doc);  //입력
	
	ds_cond_req.setColumn(0, "DOCNO", fa_docno);  //결재
	
	if(length(ds_cond_req.getColumn(0, "DOCNO")) > 0) {     //결재 상세창
		g_docno = fa_docno;
		fn_reqDoc();
	} else {   												//기안 상세창
		g_docno = fa_doc;
		fn_query1();
	}
}

/********************************************************************************
* 기      능   : 결재 문서 확인 상세
********************************************************************************/		
function fn_reqDoc() {
	tit_clearActionInfo();
	tit_addSearchActionInfo("cs12:CS1242001D_S4");
	tit_addSearchActionInfo("cs12:CS1242001D_S5");	//기안부서 결재자정보조회
	tit_addSearchActionInfo("wb01:APP_STATUS");		//결재자정보조회
	tit_callService(
	""
	, ""
	, "ds_cond_req=ds_cond_req ds_cond=ds_cond_req"
	, "ds_list_req=ds_list_req ds_decide=ds_decide ds_decide_s=ds_decide_s"
	, ""
	, "fn_afterReqDoc"
	, false
	, true);	
}

function fn_afterReqDoc() {
	ds_cond_d.SetColumn(0, "DOCNO", ds_list_req.getColumn(0, "DOCNO"));
	ds_cond_d.setColumn(0, "GNO", ds_list_req.getColumn(0, "GNO")); 
	ds_cond_d.setColumn(0, "DOCKIND", ds_list_req.getColumn(0, "DOCKIND"));

	//******************** 버튼 활성화
	//if (parseInt(ds_list_req.GetColumn(0,"APSTAT")) < 1 || (ds_list_req.GetColumn(0,"APSTAT") == "3" && ds_list_req.GetColumn(0,"REDPT1") == G_DPT1)) {
	if (parseInt(ds_list_req.GetColumn(0,"APSTAT")) < 1 || (ds_list_req.GetColumn(0,"APSTAT") == "3" && ds_list_req.GetColumn(0,"REDPT1") == vDPT)) {
		div_btn.btn_draft.Enable = true; 
		div_btn.btn_sendback.Enable = false;
		div_btn.btn_decide.Enable = false;
	} else if((ds_list_req.GetColumn(0,"APSTAT") > '0' && ds_list_req.GetColumn(0,"APSTAT") != '3' && ds_list_req.GetColumn(0,"APSTAT") < '6') && G_USER_ID == substr(ds_decide.GetColumn(0, "APNUM"),1) ) {
		div_btn.btn_draft.Enable   = false;	
		div_btn.btn_sendback.Enable = true;	
		div_btn.btn_decide.Enable = true;
	} else if (ds_list_req.GetColumn(0,"APSTAT") == "4" && ds_decide.GetColumn(ds_decide.FindRow("APNUM","H"+G_USER_ID),"SEQSTAT") == "1" ) {
		div_btn.btn_decide.enable = true ; 
	}
	else {
		div_btn.btn_decide.Enable = false;
		div_btn.btn_sendback.Enable = false;
		div_btn.btn_draft.Enable = false;
	}
	tx_reqc.Enable = false;
	tx_req.Enable = false;
	cb_gbn.Enable = false;
	
	fn_query1();   
}

/********************************************************************************
* 기      능   : 매출변경 문서 확인 상세
********************************************************************************/		
function fn_query1() {	//프로젝트정보
	tit_clearActionInfo();
	tit_addSearchActionInfo("cs12:CS1242001D_S1");	//기안상세 헤더 정보조회
	tit_callService(
        ""
        , ""
        , "ds_cond_d=ds_cond_d"
        , "ds_list_d=ds_list_d"
        , ""
        , "fn_query2"
        , true
        , true
        , true);

	vVkbur = gfn_getBsu(ds_list_d.GetColumn(0, "BSU"), "VKBUR");
}

function fn_query2() {	
	if(length(ds_cond_req.getColumn(0, "DOCNO")) > 0) {     //결재라인 상세창
		ed_docno.Text = ds_cond_req.getColumn(0, "DOCNO") ;
		fn_query2_2();
	} else {   												//기안 상세창
		ed_docno.Text = ds_cond_d.getColumn(0, "DOCNO") ;											
		fn_query2_1();   
	}
}

// 부모창에서 매출계획변경 데이터셋 가지고 와서 세팅
function fn_query2_1() {
	ds_list_bd.ClearData();
	
	//ds_list_copy2 매출계획변경상세화면에서 선택한 그리드 정보를 가지고 있는 데이터셋
	ds_list_copy2.fireevent = false;
	var j = 0;

	for (var i=0; i<ds_list_copy2.RowCount(); i++) {
		ds_list_bd.AddRow();
		ds_list_bd.SetColumn(j, "DOCNO", ed_docno.Text);
		ds_list_bd.SetColumn(j, "YYM", ds_list_copy2.GetColumn(i, "YYM"));	//매출계획변경상세 화면에서 가져옴
		ds_list_bd.SetColumn(j, "YDT", ds_list_copy2.GetColumn(i, "YDT"));
		ds_list_bd.SetColumn(j, "GNO", ds_list_copy2.GetColumn(i, "GNO"));
		
		//금액변경여부 확인을 위한 로직추가 2015.03.20 YAR
		var hct = parseInt(ds_list_copy2.GetColumn(i, "CNT"));
		var amt = parseInt(ds_list_copy2.GetColumn(i, "AMT"));
		var hmt = parseInt(ds_list_copy2.GetColumn(i, "HMT"));
		var dmt = parseInt(ds_list_copy2.GetColumn(i, "DMT"));
		//===========================공기청정기 추가 20200515 Han.JH====================================
		var acmt = parseInt(ds_list_copy2.GetColumn(i, "ACMT"));
		//==============================================================================================
		var tmt = parseInt(amt + hmt + dmt + acmt);
		
		ds_list_bd.SetColumn(j, "HCT", hct);
		ds_list_bd.SetColumn(j, "AMT", amt);
		ds_list_bd.SetColumn(j, "HMT", hmt);
		ds_list_bd.SetColumn(j, "DMT", dmt);
		//===========================공기청정기 추가 20200515 Han.JH====================================
		ds_list_bd.SetColumn(j, "ACMT", acmt);
		//==============================================================================================
		ds_list_bd.SetColumn(j, "TMT", tmt);
		
		ds_list_bd.SetColumn(j, "YYM_A", ds_list_copy2.GetColumn(i, "YYM_A"));
		ds_list_bd.SetColumn(j, "YDT_A", ds_list_copy2.GetColumn(i, "YDT_A"));
		
		var amt_a = parseInt(ds_list_copy2.GetColumn(i, "AMT_A"));
		var hmt_a = parseInt(ds_list_copy2.GetColumn(i, "HMT_A"));
		var dmt_a = parseInt(ds_list_copy2.GetColumn(i, "DMT_A"));
		//===========================공기청정기 추가 20200515 Han.JH====================================
		var acmt_a = parseInt(ds_list_copy2.GetColumn(i, "ACMT_A"));
		//==============================================================================================
		var tmt_a = parseInt(amt_a + hmt_a + dmt_a + acmt_a);
		var tmt_ca = parseInt(tmt_a - tmt);
		
		ds_list_bd.SetColumn(j, "AMT_A", amt_a);
		ds_list_bd.SetColumn(j, "HMT_A", hmt_a);
		ds_list_bd.SetColumn(j, "DMT_A", dmt_a);
		//===========================공기청정기 추가 20200515 Han.JH====================================
		ds_list_bd.SetColumn(j, "ACMT_A", acmt_a);
		//==============================================================================================
		ds_list_bd.SetColumn(j, "TMT_A", tmt_a);
		ds_list_bd.SetColumn(j, "TMT_CA", tmt_ca);
		
		j++;
	} 
	ed_chg.Text = cnt;		
	ds_list_copy2.fireevent = true;
	cal_draft.Value = "TODAY" ;
	fn_query3();
}

function fn_query2_2() {	
	tit_clearActionInfo();
	tit_addSearchActionInfo("cs12:CS1242001D_S2");
	tit_callService(
        ""
        , ""
        , "ds_cond=ds_cond_d"
        , "ds_list_bd=ds_list"
        , ""
        , "fn_query3"
        , true
        , true
        , true);  
}

////합계금액조회(기안등록, 결재상세 공통)
function fn_query3() {	
	if (length(trim(ds_list_bd.GetColumn(0, "GBN"))) != 0) {
		cb_gbn.Value = ds_list_bd.GetColumn(0, "GBN");
	}
	ds_cond_amt.SetColumn(0, "UPN", ds_list_d.GetColumn(0, "UPN"));
	ds_cond_amt.SetColumn(0, "CST", ds_list_d.GetColumn(0, "CST"));
	ds_cond_amt.SetColumn(0, "PJT", ds_list_d.GetColumn(0, "PJT"));
	ds_cond_amt.SetColumn(0, "USD", substr(ds_list_d.GetColumn(0, "USD"),0,6));
	ds_cond_amt.SetColumn(0, "UMR", substr(ds_list_d.GetColumn(0, "UMR"),0,6));
	ds_cond_amt.SetColumn(0, "CA", ds_list_bd.Sum("TMT_CA"));

	tit_clearActionInfo();
	tit_addSearchActionInfo("cs12:CS1242001D_S3");	//합계금액 조회 
	tit_callService(
        ""
        , ""
        , "ds_cond=ds_cond_amt"
        , "ds_list_amt=ds_list"
        , ""
        , "fn_afterQuery3"
        , true
        , true
        , true);  
}

function fn_afterQuery3() {	
	ed_hct.value = ds_list_bd.GetColumn(0, "HCT");

	//2015.03.20 YAR 매출변경사유-금액변경 CHECK 로직 추가
	for (var i=0; i<ds_list_bd.RowCount(); i++) {
		//ds_list_bd.AddRow();
		ds_list_bd.SetColumn(i, "DOCNO", ed_docno.Text);
		//매출계획변경상세 화면에서 가져옴
		//ds_list_bd.SetColumn(i, "YYM", ds_list_copy2.GetColumn(i, "YYM"));	
		//ds_list_bd.SetColumn(i, "YDT", ds_list_copy2.GetColumn(i, "YDT"));	
		var amt = parseInt(ds_list_bd.GetColumn(i, "AMT"));
		var hmt = parseInt(ds_list_bd.GetColumn(i, "HMT"));
		var dmt = parseInt(ds_list_bd.GetColumn(i, "DMT"));
		//===========================공기청정기 추가 20200515 Han.JH====================================
		var acmt = parseInt(ds_list_bd.GetColumn(i, "ACMT"));
		//==============================================================================================
		var amt_a = parseInt(ds_list_bd.GetColumn(i, "AMT_A"));
		var hmt_a = parseInt(ds_list_bd.GetColumn(i, "HMT_A"));
		var dmt_a = parseInt(ds_list_bd.GetColumn(i, "DMT_A"));
		//===========================공기청정기 추가 20200515 Han.JH====================================
		var acmt_a = parseInt(ds_list_bd.GetColumn(i, "ACMT_A"));
		//==============================================================================================
		
		//금액변경여부 확인하기 위한 로직
		if((ds_list_bd.GetColumn(i, "HMT") != ds_list_bd.GetColumn(i, "HMT_A")) or (ds_list_bd.GetColumn(i, "AMT") != ds_list_bd.GetColumn(i, "AMT_A"))
		   or (ds_list_bd.GetColumn(i, "DMT") != ds_list_bd.GetColumn(i, "DMT_A")) or (ds_list_bd.GetColumn(i, "ACMT") != ds_list_bd.GetColumn(i, "ACMT_A"))){
			cnt += 1;
		} 
		else{
			cnt += 0;
			}
	} 
	ed_chg.Text = cnt;
	
	if(ds_list_req.GetColumn(0,"APSTAT") < "6") {
		fn_checkTIS();
	}

	//총계약금액
	//var totm = parseInt(ds_list_amt.GetColumn(0, "TOT_AMT"));
	//청구액
	//var reqm = parseInt(ds_list_amt.GetColumn(0, "REQ_AMT"));
	//차이액
	//var ca = parseInt(ds_list_bd.Sum("TMT_CA"));
	//대상액
	//var remm =  totm - reqm + ca
	//인하율
	//var perm = round((1 - ((reqm + remm) * 1.0) / totm  ) * 100, 1);
	
	//ds_list_amt.SetColumn(0, "REM_AMT", remm);
	//ds_list_amt.SetColumn(0, "PER_AMT", perm);
}
/********************************************************************************
* 기      능   : 20160615 결재 시 매출발생 체크
********************************************************************************/
function fn_checkTIS() {
	var yyyymm = "";
	var tis = "";
	var text = "";
	for (var i=0; i<ds_list_bd.RowCount(); i++) {
		tis = ds_list_bd.GetColumn(0,"TIS") ;
		yyyymm = ds_list_bd.GetColumn(0,"YYM") ;
		if(length(tis) >0) {
			text = "계획년월 : " + yyyymm + "\n"
				            + "매출 발생" + "\n"
				            + "반송 처리 바랍니다.";
				            
			gfn_openMsgWin( text ,"W"); 	            
			return false;	
		}
	}
	return true;
}
/********************************************************************************
* 기      능   : 공통코드가 조회된 후의 Callback 함수 
********************************************************************************/
function fn_completeInit(sCode, sDsObj, sCodeType) {
	gfn_showMsg("CI00007");
	cb_gbn.Index = 0;
}
/********************************************************************************
* 기      능   : form UnloadCompleted 
********************************************************************************/
function fn_OnUnloadCompleted(obj) {
	return gfn_isFormUnload(obj);
}
//=========================================================================================
// [ PART 3 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,form닫기)
//=========================================================================================
/********************************************************************************
* 기      능   : 조회 1
********************************************************************************/
function fn_query() {
}
/********************************************************************************
* 기      능   : 삽입 20
********************************************************************************/
function fn_insert() {
	// 그리드에 row 추가 
	var newRow = gfn_addGridRow(grd_list, -1, "FLAG");
}
/********************************************************************************
* 기      능   : Delete 
********************************************************************************/
function fn_delete() {
	if ( ds_list.rowCount() < 1 ) {
		// 삭제할 정보 없음. 
		
		return;
	}
	// Grid 삭제 처리 
	gfn_deleteGridRow( grd_list, ds_list.row, "FLAG" );
}

/********************************************************************************
* 기      능   : 기안 16
********************************************************************************/
function fn_draft() {	
	
	gfn_clearMsgBar();
	if (vVkbur ==  "H100"){	                              // 자회사의 매출변경일때
		// 결재정보 처리
		ds_wbap01.ClearData();
		ds_wbap02.ClearData();
		ds_wbap01.AddRow();
		ds_wbap01.SetColumn(0, "DOCNO"   , g_docno);
		ds_wbap01.SetColumn(0, "DOCKIND" , "5");
		 
		ds_wbap02.AddRow();
		ds_wbap02.SetColumn(0, "DOCNO"   , g_docno);
		ds_wbap02.SetColumn(0, "DOCKIND" , "5");
 
		// 결재정보 공통함수
		gfn_setZwbap(ds_wbap01, ds_wbap02, true);
		// 매출변경자료 저장
		fn_save();
		// 매출변경차수(HIS 정보 조회)
		tit_clearActionInfo();
		tit_addSearchActionInfo("cs12:CS1242001D_S2");
		tit_callService(
			""
			, ""
			, "ds_cond=ds_cond_d"
			, "ds_list_bd=ds_list"
			, ""
			, ""
			, true
			, true
			, true);  
		// 최종 결재처리
		ufn_approval();
	} else {
		// TXT 필수 체크 누락 되는 경우 부서기안 담당자는 예외처리 201510 BY 이하림 
		if(fn_reqNullcheck() == true or (G_USER_ID == "2021153")) {

			var appgubn = "S";
			if(ds_list_req.GetColumn(0, "APSTAT") == "3") {
				appgubn = "R";
			}
			var arg = "fa_docno=" + quote(g_docno)
					+ " fa_dockind=" + quote("5") 
					+ " fa_appgubn=" + quote(appgubn);
					
			var rtn = gfn_openPopup2("CS0401001A", true, arg);
		 
			if( rtn[0] == "S" ) {
			//	gfn_showAlert("CI00003");
				gfn_showMsg("CI00003", '전자결재문서번호:' + g_docno);
				div_btn.btn_draft.Enable = false;

				ds_cond_req.setColumn(0, "DOCNO", g_docno);  //결재번호 세팅
				 
				if (parseInt(ds_list_req.GetColumn(0, "APSTAT")) < 1) //최초기안처리시
					fn_save();
			}
			if(appgubn = "R"){	//수신부서결재, 결재버튼 활성화
				fn_reqDoc();
			//	gfn_showAlert("CE00001"); 
				gfn_showMsg("CE00001");
			}	
		}
	}
}

/********************************************************************************
* 기      능   : 저장 
********************************************************************************/
function fn_save() {
	
	ds_list.FireEvent = false;

	gfn_clearMsgBar();
	ds_list2.ClearData();
	ds_list3.ClearData();

	var j = 0;
	var k = 0;
	for(var i=0; i<ds_list.RowCount(); i++) {
		if(ds_list.GetColumn(i, "CHK") == true) { //체크박스가 true 일 경우
			if(length(trim(ds_list.GetColumn(i, "YDT_A"))) < 2) {
				gfn_showAlert("일자는 두자리로 입력하셔야 합니다.");
				return;
			}

	/*		if(length(trim(ds_list.GetColumn(i, "GBN"))) == 0) {
				gfn_showAlert("변경사유를 입력하십시요.");
				return;
			}
	*/	
			ds_list2.AddRow();
			ds_list2.SetColumn(j, "FLAG", "U");
			ds_list2.SetColumn(j, "UPN", ds_list.GetColumn(i, "UPN"));
			ds_list2.SetColumn(j, "CST", ds_list.GetColumn(i, "CST"));
			ds_list2.SetColumn(j, "PJT", ds_list.GetColumn(i, "PJT"));
			ds_list2.SetColumn(j, "HNO", ds_list.GetColumn(i, "HNO"));
			ds_list2.SetColumn(j, "SEQ", ds_list.GetColumn(i, "SEQ"));
			ds_list2.SetColumn(j, "GND", ds_list.GetColumn(i, "GND"));
			ds_list2.SetColumn(j, "MYM", ds_list.GetColumn(i, "MYM"));
			ds_list2.SetColumn(j, "ISR", ds_list.GetColumn(i, "ISR"));
			ds_list2.SetColumn(j, "GNO", ds_list.GetColumn(i, "GNO"));
			ds_list2.SetColumn(j, "HIS", his);
			//2015.03.26 YAR 변경 전 정보 저장
			ds_list2.SetColumn(j, "YYM", ds_list.GetColumn(i, "YYM")); // ds_list2.SetColumn(j, "AMT", ds_list.GetColumn(i, "AMT_A"));
			ds_list2.SetColumn(j, "YDT", ds_list.GetColumn(i, "YDT"));
			ds_list2.SetColumn(j, "AMT", ds_list.GetColumn(i, "AMT")); 
			ds_list2.SetColumn(j, "HMT", ds_list.GetColumn(i, "HMT"));
			ds_list2.SetColumn(j, "DMT", ds_list.GetColumn(i, "DMT"));
			ds_list2.SetColumn(j, "BAM", ds_list.GetColumn(i, "BAM"));
			ds_list2.SetColumn(j, "RMK", ds_list.GetColumn(i, "RMK"));
			//===========================공기청정기 추가 20200515 Han.JH====================================
			ds_list2.SetColumn(j, "ACMT", ds_list.GetColumn(i, "ACMT"));
			//==============================================================================================
			//2015.03.26 YAR 변경 후 정보 저장
			ds_list2.SetColumn(j, "AMT_A", ds_list.GetColumn(i, "AMT_A"));
			ds_list2.SetColumn(j, "HMT_A", ds_list.GetColumn(i, "HMT_A"));
			ds_list2.SetColumn(j, "DMT_A", ds_list.GetColumn(i, "DMT_A"));
			ds_list2.SetColumn(j, "YYM_A", ds_list.GetColumn(i, "YYM_A")); 
			ds_list2.SetColumn(j, "YDT_A", ds_list.GetColumn(i, "YDT_A"));
			ds_list2.SetColumn(j, "BAM_A", ds_list.GetColumn(i, "BAM_A"));		
			//===========================공기청정기 추가 20200515 Han.JH====================================
			ds_list2.SetColumn(j, "ACMT_A", ds_list.GetColumn(i, "ACMT_A"));
			//==============================================================================================
			ds_list2.SetColumn(j, "DOCNO", g_docno);
			ds_list2.SetColumn(j, "GBN", cb_gbn.value);
			ds_list2.SetColumn(j, "REQC", tx_reqc.value);
			ds_list2.SetColumn(j, "REQ", tx_req.value);

			var decAmt, decVat, decTot;

			decAmt = ToNumber(ds_list.GetColumn(i, "AMT_A")) + ToNumber(ds_list.GetColumn(i, "HMT_A")) + ToNumber(ds_list.GetColumn(i, "DMT_A")) + ToNumber(ds_list.GetColumn(i, "ACMT_A"));
			decVat = parseInt(round((decAmt * 1.1),1) / 10) * 10;
			decVat = round((decAmt * 0.1) + (decVat - (decAmt * 1.1)),1);
			decTot = (ToNumber(decAmt) + ToNumber(decVat));

			ds_list2.SetColumn(j, "VAT", decVat);
			ds_list2.SetColumn(j, "TOT", decTot);

			j++;

			if(k == 0) {
				ds_list3.AddRow();
				ds_list3.SetColumn(0, "FLAG", "U");
				ds_list3.SetColumn(0, "GNO", ds_list.GetColumn(0, "GNO"));

				k++;
			}
		}
	}

	ds_list.FireEvent = true;
	
	if(j == 0) {
		gfn_showMsg("CW00005");
		return;		
	}

	if(frm == "A") {
		ds_key_cond.SetColumn(0, "GNO", ds_list.GetColumn(0, "GNO"));
	} else {
		ds_key_cond.SetColumn(0, "GNO", gno);
	}

	tit_clearActionInfo();

	tit_addSingleActionInfo("cs12:CS1242001B_U1");			//402에서 해당 계약번호 로 매출변경내역이 작성중건 사용안함으로 업데이트
	tit_addSearchActionInfo("cs12:CS1242001B_S3", true);	//402 CS402_HIS MAX +1  
	tit_addSaveActionInfo(
        ""
        , "cs12:CS1242001B_I1"
        , ""
        , "FLAG");

	tit_callService(
        ""
        , ""
        , "ds_list3=ds_list3:A ds_key_cond=ds_key_cond ds_list2=ds_list2:A"
        , ""
        , ""
        , "fn_afterSave"
        , true
        , true
        , true);
}

function fn_afterSave(errCode, errMsg) {
	if(errCode != 0) {
		deleteDecide(); 
		gfn_showConfirm("CE00001"); 
		gfn_showMsg("CE00001");
	} else {
		if (vVkbur != "H100"){				// 자회사의 경우 실행하지 않는다.
			fn_reqDoc();
			gfn_showMsg("CI00005");
			
			if (length(fa_docno)>0) {	//결재함을 통해 접근한 경우 
				parent.fn_query();
			}
		}
	}

}

/********************************************************************************
* 기      능   : 닫기  
********************************************************************************/
function fn_close() {
	close();
}

/********************************************************************************
* 기      능   : 액셀  
********************************************************************************/
function fn_excel() {
	// Excel Export 
	gfn_saveToExcel(grd_list, true );
}
/********************************************************************************
* 기      능   : 접수 5
********************************************************************************/
function fn_receipt() {

}
/********************************************************************************
* 기      능   : 승인 10
********************************************************************************/
function fn_approval() {

}
/********************************************************************************
* 기      능   : 결재 15
********************************************************************************/
function fn_decide() {
	gfn_clearMsgBar();
	if( ds_decide.rowCount() < 1 ) {
		// 승인할 정보 없음. 
		return;
	}

	if(fn_checkTIS()){
	
	} else {
		alert("반송 처리 바랍니다.");
		return;
	} // 매출 발생 체크 

	if( !gfn_showConfirm("CI00014", "문서번호 : "+ quote(ed_docno.Text)+ "결재") ) return;
	
	//----------------------------------------------------------------------
	// 의견 입력 팝업 추가 
	// f팝업 전달 변수 fa_docno : 문서번호 ,fa_dockind : 문서종류 
	// return 값 : rtn_yn (Y:의견입력됨 N:의견입력안됨)
	if(gfn_showConfirm("CW10025","의견을 입력하시겠습니까?") )
	{
		var arg = "";
		arg = " fa_docno=" + quote(ds_decide.GetColumn(0,"DOCNO")) +" fa_dockind=" + quote(ds_decide.GetColumn(0,"DOCKIND"));
		var rtn_yn = gfn_openPopup2("CS0401001C", true , arg);
	}
	//alert("rtn_yn:"+rtn_yn);
	// 의견입력 팝업 종료
	//----------------------------------------------------------------------
	ds_decide.setColumn(ds_decide.FindRow("APNUM","H"+G_USER_ID),"SEQSTAT","3");
	//trace(ds_decide_s.SaveXML());
	// 결재상태변경
	//ds_decide.SetColumn(0, "SEQSTAT", "3");
	
	tit_clearActionInfo();
	//결재자 저장
 	tit_addMultiActionInfo("cs04:CS0401002A_U2");
 	tit_addMultiActionInfo("cs04:CS0401002A_U3");
	
	//매출계획변경-금액변경인 경우, 수신부서결재진행 2015.03.02 YAR 
	if(ed_chg.Text >= 1 && ds_decide_s.GetColumn(0, "APPGUBN") == "S" && ds_decide_s.GetColumn(0, "APNUM") == "H"+G_USER_ID) {
	}
	//금액변경 제외한 경우, 기안부서결재 로직변경 
	else if(ds_decide_s.GetColumn(0, "APPGUBN") == "S" && ds_decide_s.GetColumn(0, "APNUM") == "H"+G_USER_ID){		
		tit_addMultiActionInfo("cs04:CS0401002A_U4");	//ZWBAP02_APSTAT = 6으로 세팅
	}
	tit_callService(
		""
		, ""
		, "ds_list_0=ds_decide"
		, ""
		, ""
		, "fn_afterDecide"
		, true);
}

/********************************************************************************
* 기      능   : 취소 35
********************************************************************************/
function fn_cancel() {

}
/********************************************************************************
* 기      능   : print 40
********************************************************************************/
function fn_print() {
	if(fn_reqNullcheck() == true) {
		ds_conf_cond.SetColumn(0, "DOCNO", ed_docno.Text);	
	
		tit_clearActionInfo();
		tit_addSearchActionInfo("wb01:DOC_CONF_S1");
		tit_addSearchActionInfo("wb01:DOC_CONF_S2");
		tit_callService(
			""
			, ""
			, "ds_conf_cond=ds_conf_cond"
			, "ds_conf_list=ds_conf_list ds_draftpers_list=ds_draftpers_list"
			, ""
			, "fn_afterprint"
			, true); 
		}
}
function fn_afterprint() {
	ds_draftpers_list.SetColumn(0, "DOCNO", ed_docno.Text);
	ds_draftpers_list.SetColumn(0, "D_TOTEM", "서비스 관리부");
	ds_list_d.SetColumn(0, "DRAFT_DATE", ds_list_bd.GetColumn(0, "MDT"));
	ds_list_d.SetColumn(0, "D_NAME", ds_draftpers_list.GetColumn(0, "D_NAME"));
	ds_list_bd.SetColumn(0, "GBN_TX", cb_gbn.Text);
	// UbiReport Call
		Dialog("CS12::CS1242001E.xml", "");
}
/********************************************************************************
* 기      능   : 발행 50
********************************************************************************/
function fn_out() {

}
/********************************************************************************
* 기      능   : 신청 55
********************************************************************************/
function fn_request() {

}
/********************************************************************************
* 기      능   : 전송 60
********************************************************************************/
function fn_trans() {

}
/********************************************************************************
* 기      능   : 반송 65
********************************************************************************/
function fn_sendback() {
	gfn_clearMsgBar();
	
	if( ds_decide.rowCount() < 1 ) {
		// 승인할 정보 없음. 
		return;
	}
	
	if(!gfn_showConfirm("CI00014", "문서번호 : "+ quote(ed_docno.Text) + "반송")) return;
	
	//----------------------------------------------------------------------
	// 의견 입력 팝업 추가 
	// f팝업 전달 변수 fa_docno : 문서번호 ,fa_dockind : 문서종류 
	// return 값 : rtn_yn (Y:의견입력됨 N:의견입력안됨)
	if(gfn_showConfirm("CW10025","의견을 입력하시겠습니까?") )
	{
		var arg = "";
		arg = " fa_docno=" + quote(ds_decide.GetColumn(0,"DOCNO")) +" fa_dockind=" + quote(ds_decide.GetColumn(0,"DOCKIND"));
		var rtn_yn = gfn_openPopup2("CS0401001C", true , arg);
	}
	//alert("rtn_yn:"+rtn_yn);
	// 의견입력 팝업 종료
	//----------------------------------------------------------------------
	fn_okSendback();	
}

function fn_okSendback() {	
	// 결재상태변경
	ds_decide.SetColumn(0, "SEQSTAT", "2");
	
	tit_clearActionInfo();
	//결재자 저장
 	tit_addMultiActionInfo("cs04:CS0401002A_U2");
 	tit_addMultiActionInfo("cs04:CS0401002A_U3");
	
	tit_callService(
		""
		, ""
		, "ds_list_0=ds_decide"
		, ""
		, ""
		, "fn_afterDecide"
		, true);
}
/********************************************************************************
* 기      능   : 결재, 반송  Callback
********************************************************************************/
function fn_afterDecide(errCode, errMsg) {
	if ( errCode!= 0 ) {
		gfn_showMsg("CE00001");
	} else {
		gfn_showMsg("CI00003");
		div_btn.btn_decide.Enable = false;		// 결재버튼
		div_btn.btn_draft.Enable  = false;		// 기안버튼
	//	div_btn.btn_print.Enable  = false;		// 출력버튼
		div_btn.btn_sendback.Enable = false; 	// 반송버튼	
		fn_beApproval();
	}
}

/********************************************************************************
* 기      능   : 계산 70
********************************************************************************/
function fn_cal() {

}
/********************************************************************************
* 기      능   : 복사 75
********************************************************************************/
function fn_copy() {

}
/********************************************************************************
* 기      능   : 확인 80
********************************************************************************/
function fn_confirm() {

}
//=========================================================================================
// [ PART 4]
// Callback 함수 정의 : callback 함수명은 메인 함수의 fn_xxxx() 에서 xxxx 부분은 fn_afterXXXX()
// 형태가 되도록 작성 
//=========================================================================================
/********************************************************************************
* 기      능   : 조회 Callback  
********************************************************************************/
function fn_afterQuery(errCode, errMsg) {
	// 메시지 처리 
	gfn_showSearchMsg(grd_list);
}
/********************************************************************************
* 기      능   : 저장 Callback  
********************************************************************************/
// function fn_afterSave(errCode, errMsg) {

	// if(errCode != 0) {
		// gfn_showMsg("CE00001");
	// } else {
		// fn_reqDoc();
		// gfn_showMsg("CI00005");

		// if (length(fa_docno)>0) {	//결재함을 통해 접근한 경
			// parent.fn_query();
		// }
	// }
// }
/********************************************************************************
* 기      능   : 삭제 Callback
********************************************************************************/
function fn_afterDelete(errCode, errMsg) {
	if(errCode != 0) {
		gfn_showMsg("CE00001");
	} else {
		gfn_showMsg("CI00003");
	}
}
//=========================================================================================
// [ PART 5 ]
// Detail Process Event 정의 ( User Define function )
// 사용자 정의 함수는 ufn_xxxx() 형태로 작성 
//=========================================================================================
/********************************************************************************
* 기      능   : 사용자 정의 함수  
********************************************************************************/
function ufn_userfunction() {

}

//=========================================================================================
// [ PART 6 ]
// component Event 정의 : 각 Component 별 이벤트 
//=========================================================================================
/********************************************************************************
* 기      능   : 그리드 헤더 클릭시 정렬 처리 
********************************************************************************/
function grd_list_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
{
	if ( nCell == 0 ) {
		// 그리드 표시할 컬럼 선택 
		gfn_selectGridCol(obj);
	} else {
		// 그리드 정렬 처리 
		gfn_sortGrid(obj,nCell);
	}
}
/********************************************************************************
* 기      능   : 데이터셋 값 변경 시 - Flag 처리 
********************************************************************************/
function ds_list_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{
	gfn_changeFlag( obj, strColumnID, nRow, "FLAG" );
}


/********************************************************************************
* 기      능   : NULL CHECK
********************************************************************************/
// 사유
function fn_reqNullcheck() {
	if(length(trim(cb_gbn.Value)) == 0) {
		gfn_showAlert("CW00001","사유");
		return false;
	}
	if(length(trim(tx_reqc.value)) == 0) {
		gfn_showAlert("CW00001","고객요구안");
		return false;
	}
	if(length(trim(tx_req.value)) == 0) {
		gfn_showAlert("CW00001","협의결과");
		return false;
	}
	return true;
}


/********************************************************************************
* 기      능   : 기안된 문서 버튼 제어
********************************************************************************/
 function ufn_btnControl() {
	var user_grp = gfn_getUserGroup();	
	if( user_grp == "30" ) {
		div_btn.btn_decide.Enable = false;
		div_btn.btn_draft.Enable = true;
		div_btn.btn_sendback.Enable = false;
	}
	if( user_grp == "20" || user_grp == "40" ) {
		div_btn.btn_decide.Enable = true;
		div_btn.btn_draft.Enable = true;
		div_btn.btn_sendback.Enable = true;
	}
 }
/********************************************************************************
* 기      능   : 최종결재자 결재후 승인처리
********************************************************************************/
function fn_beApproval() {

	tit_clearActionInfo();
	tit_addSearchActionInfo("cs12:CS1242001D_S4");
	tit_callService(
	""
	, ""
	, "ds_cond_req=ds_list_req"
	, "ds_list_req=ds_list_req"
	, ""
	, "fn_chkApproval"
	, false
	, true);
}

function fn_chkApproval() {	

	if (ds_list_req.GetColumn(0,"APSTAT") == "6") {
		// 2015.06.19 LJH 수신부서 최종결재시 해당월 매출계획 생성여부 체크 로직 추가
		//ufn_approval();
		ufn_chkTis();
	} else {
		return;
	}
}

function ufn_chkTis() {
	ds_cond_tis.ClearData();
	ds_cond_tis.SetColumn(0, "GNO", ds_list_bd.GetColumn(0, "GNO"));
	ds_cond_tis.SetColumn(0, "HIS", ds_list_bd.GetColumn(0, "HIS"));

	tit_clearActionInfo();
	tit_addSearchActionInfo("cs12:CS1242001D_S6");
	tit_callService(
	""
	, ""
	, "ds_cond_tis=ds_cond_tis"
	, "ds_list_tis=ds_list_tis"
	, ""
	, "ufn_approval"
	, false
	, true);
}

function ufn_approval() {	
	if(parseInt(ds_list_tis.GetColumn(0, "CNT")) > 0) {
		rollbackDecide(); // 매출계획 생성시 결재상태 원복
		return false;
	}

	gfn_clearMsgBar();
	ds_list_final.ClearData();
	ds_list_final.AddRow();
	ds_list_final.SetColumn(0, "FLAG", "U");
	ds_list_final.SetColumn(0, "GNO", ds_list_bd.GetColumn(0, "GNO"));
	ds_list_final.SetColumn(0, "HIS", ds_list_bd.GetColumn(0, "HIS"));

	tit_clearActionInfo();

	// Update(zcst402)
	tit_addSaveActionInfo(
		""
		, "cs12:CS1242001A_U1"
		, ""
		, "FLAG");

	tit_addSaveActionInfo(
		""
		, "cs12:CS1242001A_U2"
		, ""
		, "FLAG");

	tit_addSaveActionInfo(
		""
		, "cs12:CS1242001A_U3"
		, ""
		, "FLAG");

	tit_callService(
		""
		, ""
		, "ds_list=ds_list_final"
		, ""
		, ""
		, "fn_afterApproval"
		, false
        , false
        , true);
}

function fn_afterApproval(errCode, errMsg) {
	if(errCode != 0) {
		rollbackDecide();
		gfn_showMsg("CE00001");
	} else {
		gfn_showMsg("CI00003");
		if (vVkbur == "H100"){				//자회사의 경우 기안창을 닫고, 상세창을 조회
			parent.ufn_selData();
			close();
		}
		//parent.fn_query();
	}
}

function rollbackDecide() {
	tit_clearActionInfo();
	
	ds_head_0.ClearData();
	ds_head_0.AddRow();
	ds_head_0.SetColumn(0, "DOCNO", g_docno);
	ds_head_0.SetColumn(0, "DOCKIND", "5");
	
	tit_addMultiActionInfo("cs04:CS0401002A_U6"); //결재상태 복구 ZWBAP01
	tit_addMultiActionInfo("cs04:CS0401002A_U7"); //결재상태 복구 ZWBAP02
	tit_callService( 
		  ""
		, ""
		, "ds_list_0=ds_decide"
		, ""
		, ""
		, ""
		, true
		, true);
}

function deleteDecide(){
	tit_clearActionInfo();
	
	ds_head_0.ClearData();
	ds_head_0.AddRow();
	ds_head_0.SetColumn(0, "DOCNO", g_docno);
	ds_head_0.SetColumn(0, "DOCKIND", "5");
	
	tit_addMultiActionInfo("cs04:CS0401002A_D1"); 
	tit_addMultiActionInfo("cs04:CS0401002A_D2"); 
	tit_callService( 
		  ""
		, ""
		, "ds_head_0=ds_head_0" 
		, ""
		, ""
		, ""
		, true
		, true);
}
function bt_imsiaccpt_OnClick(obj)
{
	if(!gfn_showConfirm("CW10025","강제로 매출계획변경 처리를 진행합니까?") ) {
		return false;
	}
	ufn_approval();
}
]]></Script>
</Window>