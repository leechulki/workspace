<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="736" Id="CS1240001B" Left="8" OnLoadCompleted="fn_OnLoadCompleted" OnUnloadCompleted="fn_OnUnloadCompleted" PidAttrib="7" Title="견적상세(승강기)" Top="8" Ver="1.0" Width="856" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_cond2">
				<Contents>
					<colinfo id="GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="TEM" size="256" summ="default" type="STRING"/>
					<colinfo id="RDT" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="SIR" size="256" summ="default" type="STRING"/>
					<colinfo id="DOC" size="256" summ="default" type="STRING"/>
					<colinfo id="DOCNO" size="256" summ="default" type="STRING"/>
					<colinfo id="PGMID" size="256" summ="default" type="STRING"/>
					<record>
						<DOC></DOC>
						<DOCNO></DOCNO>
						<GBN></GBN>
						<PGMID></PGMID>
						<RDT></RDT>
						<SEQ></SEQ>
						<SIR></SIR>
						<TEM></TEM>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_prd">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME>-&#32;선택&#32;-</CODE_NAME>
					</record>
					<record>
						<CODE>A</CODE>
						<CODE_NAME>매월</CODE_NAME>
					</record>
					<record>
						<CODE>B</CODE>
						<CODE_NAME>격월</CODE_NAME>
					</record>
					<record>
						<CODE>C</CODE>
						<CODE_NAME>분기</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_head" OnColumnChanged="ds_head_OnColumnChanged">
				<Contents>
					<colinfo id="ETN" size="256" summ="default" type="STRING"/>
					<colinfo id="SIR" size="256" summ="default" type="STRING"/>
					<colinfo id="PST" size="256" summ="default" type="STRING"/>
					<colinfo id="PST_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="MDT" size="256" summ="default" type="STRING"/>
					<colinfo id="MID" size="256" summ="default" type="STRING"/>
					<colinfo id="MID_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="CDT" size="256" summ="default" type="STRING"/>
					<colinfo id="NAM" size="256" summ="default" type="STRING"/>
					<colinfo id="SPT" size="256" summ="default" type="STRING"/>
					<colinfo id="ADR" size="256" summ="default" type="STRING"/>
					<colinfo id="PJT" size="256" summ="default" type="STRING"/>
					<colinfo id="TEM" size="256" summ="default" type="STRING"/>
					<colinfo id="BSU" size="256" summ="default" type="STRING"/>
					<colinfo id="SPC" size="256" summ="default" type="STRING"/>
					<colinfo id="FMG" size="256" summ="default" type="STRING"/>
					<colinfo id="POG" size="256" summ="default" type="STRING"/>
					<colinfo id="HGB" size="256" summ="default" type="STRING"/>
					<colinfo id="DGB" size="256" summ="default" type="STRING"/>
					<colinfo id="PRD" size="256" summ="default" type="STRING"/>
					<colinfo id="CDY" size="256" summ="default" type="STRING"/>
					<colinfo id="CPD" size="256" summ="default" type="STRING"/>
					<colinfo id="CND" size="256" summ="default" type="STRING"/>
					<colinfo id="SRG" size="256" summ="default" type="STRING"/>
					<colinfo id="GBU" size="256" summ="default" type="STRING"/>
					<colinfo id="YGB" size="256" summ="default" type="STRING"/>
					<colinfo id="BLD" size="256" summ="default" type="STRING"/>
					<colinfo id="PDT" size="256" summ="default" type="STRING"/>
					<colinfo id="CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="FLR" size="256" summ="default" type="STRING"/>
					<colinfo id="SPD" size="256" summ="default" type="STRING"/>
					<colinfo id="SYR" size="256" summ="default" type="STRING"/>
					<colinfo id="HYN" size="256" summ="default" type="STRING"/>
					<colinfo id="DYN" size="256" summ="default" type="STRING"/>
					<colinfo id="ACYN" size="256" summ="default" type="STRING"/>
					<colinfo id="CYN" size="256" summ="default" type="STRING"/>
					<colinfo id="RMK" size="256" summ="default" type="STRING"/>
					<colinfo id="DOC" size="256" summ="default" type="STRING"/>
					<colinfo id="APSTAT" size="256" summ="default" type="STRING"/>
					<colinfo id="MASTAT" size="256" summ="default" type="STRING"/>
					<colinfo id="MATOT" size="256" summ="default" type="STRING"/>
					<colinfo id="AMG" size="256" summ="default" type="STRING"/>
					<colinfo id="RA1" size="256" summ="default" type="STRING"/>
					<colinfo id="RA2" size="256" summ="default" type="STRING"/>
					<colinfo id="MMN" size="256" summ="default" type="STRING"/>
					<colinfo id="DAT" size="256" summ="default" type="STRING"/>
					<colinfo id="COF" size="256" summ="default" type="STRING"/>
					<colinfo id="COF2" size="256" summ="default" type="STRING"/>
					<colinfo id="OPN" size="256" summ="default" type="STRING"/>
					<colinfo id="STD" size="256" summ="default" type="STRING"/>
					<colinfo id="ETD" size="256" summ="default" type="STRING"/>
					<colinfo id="ZMAN" size="256" summ="default" type="STRING"/>
					<colinfo id="PNT" size="256" summ="default" type="STRING"/>
					<colinfo id="SAJ" size="256" summ="default" type="STRING"/>
					<colinfo id="GIS" size="256" summ="default" type="STRING"/>
					<colinfo id="TRAT" size="256" summ="default" type="STRING"/>
					<colinfo id="PGMID" size="256" summ="default" type="STRING"/>
					<colinfo id="ZTERM" size="256" summ="default" type="STRING"/>
					<colinfo id="NIGHT" size="256" summ="default" type="STRING"/>
					<colinfo id="WEND" size="256" summ="default" type="STRING"/>
					<colinfo id="CONGB" size="256" summ="default" type="STRING"/>
					<colinfo id="HMT_S" size="256" summ="default" type="STRING"/>
					<colinfo id="AMT_S" size="256" summ="default" type="STRING"/>
					<colinfo id="EL_DEPH" size="256" summ="default" type="STRING"/>
					<colinfo id="DMT_S" size="256" summ="default" type="STRING"/>
					<colinfo id="ACMT_S" size="256" summ="default" type="STRING"/>
					<colinfo id="BDGBN" size="256" summ="default" type="STRING"/>
					<colinfo id="AMBT_S" size="256" summ="default" type="STRING"/>
					<colinfo id="AMTT_S" size="256" summ="default" type="STRING"/>
					<colinfo id="DISCRULE" size="256" summ="default" type="STRING"/>
					<record>
						<ACMT_S></ACMT_S>
						<ACYN></ACYN>
						<ADR></ADR>
						<AMBT_S></AMBT_S>
						<AMG></AMG>
						<AMT_S></AMT_S>
						<AMTT_S></AMTT_S>
						<APSTAT></APSTAT>
						<BDGBN></BDGBN>
						<BLD></BLD>
						<BSU></BSU>
						<CDT></CDT>
						<CDY></CDY>
						<CND></CND>
						<CNT></CNT>
						<COF></COF>
						<COF2></COF2>
						<CONGB></CONGB>
						<CPD></CPD>
						<CYN></CYN>
						<DAT></DAT>
						<DGB></DGB>
						<DISCRULE></DISCRULE>
						<DMT_S></DMT_S>
						<DOC></DOC>
						<DYN></DYN>
						<EL_DEPH></EL_DEPH>
						<ETD></ETD>
						<ETN></ETN>
						<FLR></FLR>
						<FMG></FMG>
						<GBU></GBU>
						<GIS></GIS>
						<HGB></HGB>
						<HMT_S></HMT_S>
						<HYN></HYN>
						<MASTAT></MASTAT>
						<MATOT></MATOT>
						<MDT></MDT>
						<MID></MID>
						<MID_NM></MID_NM>
						<MMN></MMN>
						<NAM></NAM>
						<NIGHT></NIGHT>
						<OPN></OPN>
						<PDT></PDT>
						<PGMID></PGMID>
						<PJT></PJT>
						<PNT></PNT>
						<POG></POG>
						<PRD></PRD>
						<PST></PST>
						<PST_NM></PST_NM>
						<RA1></RA1>
						<RA2></RA2>
						<RMK></RMK>
						<SAJ></SAJ>
						<SIR></SIR>
						<SPC></SPC>
						<SPD></SPD>
						<SPT></SPT>
						<SRG></SRG>
						<STD></STD>
						<SYR></SYR>
						<TEM></TEM>
						<TRAT></TRAT>
						<WEND></WEND>
						<YGB></YGB>
						<ZMAN></ZMAN>
						<ZTERM></ZTERM>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list2" OnColumnChanged="ds_list2_OnColumnChanged">
				<Contents>
					<colinfo id="ETN" size="256" summ="default" type="STRING"/>
					<colinfo id="SIR" size="256" summ="default" type="STRING"/>
					<colinfo id="PJT" size="256" summ="default" type="STRING"/>
					<colinfo id="HNO" size="256" summ="default" type="STRING"/>
					<colinfo id="UPN" size="256" summ="default" type="STRING"/>
					<colinfo id="TEM" size="256" summ="default" type="STRING"/>
					<colinfo id="TBLD" size="256" summ="default" type="STRING"/>
					<colinfo id="SPT" size="256" summ="default" type="STRING"/>
					<colinfo id="SPC" size="256" summ="default" type="STRING"/>
					<colinfo id="SPC2" size="256" summ="default" type="STRING"/>
					<colinfo id="TYN" size="256" summ="default" type="STRING"/>
					<colinfo id="FMT" size="256" summ="default" type="STRING"/>
					<colinfo id="PMT" size="256" summ="default" type="STRING"/>
					<colinfo id="HMT" size="256" summ="default" type="STRING"/>
					<colinfo id="DMT" size="256" summ="default" type="STRING"/>
					<colinfo id="ACMT" size="256" summ="default" type="STRING"/>
					<colinfo id="AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="FMG" size="256" summ="default" type="STRING"/>
					<colinfo id="POG" size="256" summ="default" type="STRING"/>
					<colinfo id="HGB" size="256" summ="default" type="STRING"/>
					<colinfo id="DGB" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="HWR" size="256" summ="default" type="STRING"/>
					<colinfo id="DND" size="256" summ="default" type="STRING"/>
					<colinfo id="VKGRP" size="256" summ="default" type="STRING"/>
					<colinfo id="BSUGB" size="256" summ="default" type="STRING"/>
					<colinfo id="KND" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSPEC12" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSPEC7" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSPEC3" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSPEC2" size="256" summ="default" type="STRING"/>
					<colinfo id="BLD" size="256" summ="default" type="STRING"/>
					<colinfo id="FDT" size="256" summ="default" type="STRING"/>
					<colinfo id="HEP" size="256" summ="default" type="STRING"/>
					<colinfo id="UMS" size="256" summ="default" type="STRING"/>
					<colinfo id="ABG" size="256" summ="default" type="STRING"/>
					<colinfo id="FMS" size="256" summ="default" type="STRING"/>
					<colinfo id="FHG" size="256" summ="default" type="STRING"/>
					<colinfo id="HYN" size="256" summ="default" type="STRING"/>
					<colinfo id="TVR" size="256" summ="default" type="STRING"/>
					<colinfo id="CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="ACD" size="256" summ="default" type="STRING"/>
					<colinfo id="ISD" size="256" summ="default" type="STRING"/>
					<colinfo id="WDT" size="256" summ="default" type="STRING"/>
					<colinfo id="DCE" size="256" summ="default" type="STRING"/>
					<colinfo id="F10" size="256" summ="default" type="STRING"/>
					<colinfo id="SEG" size="256" summ="default" type="STRING"/>
					<colinfo id="AGEK" size="256" summ="default" type="STRING"/>
					<colinfo id="P10" size="256" summ="default" type="STRING"/>
					<colinfo id="FRAT" size="256" summ="default" type="STRING"/>
					<colinfo id="PRAT" size="256" summ="default" type="STRING"/>
					<colinfo id="DAT" size="256" summ="default" type="STRING"/>
					<colinfo id="PGMID" size="256" summ="default" type="STRING"/>
					<colinfo id="ABR_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="HFR" size="256" summ="default" type="STRING"/>
					<colinfo id="MATNR" size="256" summ="default" type="STRING"/>
					<colinfo id="CNT_HRTS" size="256" summ="default" type="STRING"/>
					<colinfo id="BDGBN" size="256" summ="default" type="STRING"/>
					<colinfo id="FMBT" size="256" summ="default" type="STRING"/>
					<colinfo id="PMBT" size="256" summ="default" type="STRING"/>
					<colinfo id="FMTT" size="256" summ="default" type="STRING"/>
					<colinfo id="PMTT" size="256" summ="default" type="STRING"/>
					<colinfo id="AMBT" size="256" summ="default" type="STRING"/>
					<colinfo id="AMTT" size="256" summ="default" type="STRING"/>
					<colinfo id="ACYN" size="256" summ="default" type="STRING"/>
					<colinfo id="ACND" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_hwr">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME>-&#32;선택&#32;-</CODE_NAME>
					</record>
					<record>
						<CODE>A</CODE>
						<CODE_NAME>유선</CODE_NAME>
					</record>
					<record>
						<CODE>B</CODE>
						<CODE_NAME>무선</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_dnd">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME>-&#32;선택&#32;-</CODE_NAME>
					</record>
					<record>
						<CODE>A</CODE>
						<CODE_NAME>Mini-PBX</CODE_NAME>
					</record>
					<record>
						<CODE>B</CODE>
						<CODE_NAME>Di-PBX2</CODE_NAME>
					</record>
					<record>
						<CODE>C</CODE>
						<CODE_NAME>Hybrid-PBX</CODE_NAME>
					</record>
					<record>
						<CODE>Z</CODE>
						<CODE_NAME>통신료</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond_tvr">
				<Contents>
					<colinfo id="TEM" size="256" summ="default" type="STRING"/>
					<colinfo id="RDT" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="SIR" size="256" summ="default" type="STRING"/>
					<record>
						<RDT></RDT>
						<SEQ></SEQ>
						<SIR></SIR>
						<TEM></TEM>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond_cnt">
				<Contents>
					<colinfo id="TEM" size="256" summ="default" type="STRING"/>
					<colinfo id="RDT" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="SIR" size="256" summ="default" type="STRING"/>
					<colinfo id="DOC" size="256" summ="default" type="STRING"/>
					<record>
						<DOC></DOC>
						<RDT></RDT>
						<SEQ></SEQ>
						<SIR></SIR>
						<TEM></TEM>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_gno">
				<Contents>
					<colinfo id="GNO" size="256" summ="default" type="STRING"/>
					<colinfo id="SIR" size="256" summ="default" type="STRING"/>
					<record>
						<GNO></GNO>
						<SIR></SIR>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cdy">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME>-&#32;선택&#32;-</CODE_NAME>
					</record>
					<record>
						<CODE>1</CODE>
						<CODE_NAME>1년</CODE_NAME>
					</record>
					<record>
						<CODE>2</CODE>
						<CODE_NAME>2년</CODE_NAME>
					</record>
					<record>
						<CODE>3</CODE>
						<CODE_NAME>3년</CODE_NAME>
					</record>
					<record>
						<CODE>4</CODE>
						<CODE_NAME>4년</CODE_NAME>
					</record>
					<record>
						<CODE>5</CODE>
						<CODE_NAME>5년</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cnd">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME>-&#32;선택&#32;-</CODE_NAME>
					</record>
					<record>
						<CODE>A</CODE>
						<CODE_NAME>Conversion</CODE_NAME>
					</record>
					<record>
						<CODE>B</CODE>
						<CODE_NAME>Renewal</CODE_NAME>
					</record>
					<record>
						<CODE>C</CODE>
						<CODE_NAME>Recapture</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_gbu">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME>-&#32;선택&#32;-</CODE_NAME>
					</record>
					<record>
						<CODE>A</CODE>
						<CODE_NAME>직영</CODE_NAME>
					</record>
					<record>
						<CODE>B</CODE>
						<CODE_NAME>협력사</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ygb">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME>-&#32;선택&#32;-</CODE_NAME>
					</record>
					<record>
						<CODE>A</CODE>
						<CODE_NAME>직영</CODE_NAME>
					</record>
					<record>
						<CODE>B</CODE>
						<CODE_NAME>협력사</CODE_NAME>
					</record>
					<record>
						<CODE>C</CODE>
						<CODE_NAME>직영&amp;협력사</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cyn">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME>-&#32;선택&#32;-</CODE_NAME>
					</record>
					<record>
						<CODE>Y</CODE>
						<CODE_NAME>Y</CODE_NAME>
					</record>
					<record>
						<CODE>N</CODE>
						<CODE_NAME>N</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_hyn">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME>-&#32;선택&#32;-</CODE_NAME>
					</record>
					<record>
						<CODE>Y</CODE>
						<CODE_NAME>Y</CODE_NAME>
					</record>
					<record>
						<CODE>N</CODE>
						<CODE_NAME>N</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_dyn">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME>-&#32;선택&#32;-</CODE_NAME>
					</record>
					<record>
						<CODE>Y</CODE>
						<CODE_NAME>Y</CODE_NAME>
					</record>
					<record>
						<CODE>N</CODE>
						<CODE_NAME>N</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cpd">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME>-&#32;선택&#32;-</CODE_NAME>
					</record>
					<record>
						<CODE>A</CODE>
						<CODE_NAME>FM</CODE_NAME>
					</record>
					<record>
						<CODE>B</CODE>
						<CODE_NAME>POG</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_spd">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME>-&#32;선택&#32;-</CODE_NAME>
					</record>
					<record>
						<CODE>A</CODE>
						<CODE_NAME>60m/m</CODE_NAME>
					</record>
					<record>
						<CODE>B</CODE>
						<CODE_NAME>90m/m이상</CODE_NAME>
					</record>
					<record>
						<CODE>C</CODE>
						<CODE_NAME>120m/m이상</CODE_NAME>
					</record>
					<record>
						<CODE>D</CODE>
						<CODE_NAME>180m/m이상</CODE_NAME>
					</record>
					<record>
						<CODE>E</CODE>
						<CODE_NAME>기타기종</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_bld">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME>-&#32;선택&#32;-</CODE_NAME>
					</record>
					<record>
						<CODE>A</CODE>
						<CODE_NAME>아파트</CODE_NAME>
					</record>
					<record>
						<CODE>B</CODE>
						<CODE_NAME>근린생활</CODE_NAME>
					</record>
					<record>
						<CODE>C</CODE>
						<CODE_NAME>주상복합</CODE_NAME>
					</record>
					<record>
						<CODE>D</CODE>
						<CODE_NAME>기타</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_srg">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME>-&#32;선택&#32;-</CODE_NAME>
					</record>
					<record>
						<CODE>A</CODE>
						<CODE_NAME>1:1Roping</CODE_NAME>
					</record>
					<record>
						<CODE>B</CODE>
						<CODE_NAME>2:1Roping</CODE_NAME>
					</record>
					<record>
						<CODE>C</CODE>
						<CODE_NAME>4:1Roping</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_pdt">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME>-&#32;선택&#32;-</CODE_NAME>
					</record>
					<record>
						<CODE>A</CODE>
						<CODE_NAME>EL</CODE_NAME>
					</record>
					<record>
						<CODE>B</CODE>
						<CODE_NAME>ES</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_syr">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME>-&#32;선택&#32;-</CODE_NAME>
					</record>
					<record>
						<CODE>01</CODE>
						<CODE_NAME>1년차</CODE_NAME>
					</record>
					<record>
						<CODE>02</CODE>
						<CODE_NAME>2년차</CODE_NAME>
					</record>
					<record>
						<CODE>03</CODE>
						<CODE_NAME>3년차</CODE_NAME>
					</record>
					<record>
						<CODE>04</CODE>
						<CODE_NAME>4년차</CODE_NAME>
					</record>
					<record>
						<CODE>05</CODE>
						<CODE_NAME>5년차</CODE_NAME>
					</record>
					<record>
						<CODE>06</CODE>
						<CODE_NAME>6년차</CODE_NAME>
					</record>
					<record>
						<CODE>07</CODE>
						<CODE_NAME>7년차</CODE_NAME>
					</record>
					<record>
						<CODE>08</CODE>
						<CODE_NAME>8년차</CODE_NAME>
					</record>
					<record>
						<CODE>09</CODE>
						<CODE_NAME>9년차</CODE_NAME>
					</record>
					<record>
						<CODE>10</CODE>
						<CODE_NAME>10년차</CODE_NAME>
					</record>
					<record>
						<CODE>11</CODE>
						<CODE_NAME>11년차</CODE_NAME>
					</record>
					<record>
						<CODE>12</CODE>
						<CODE_NAME>12년차</CODE_NAME>
					</record>
					<record>
						<CODE>13</CODE>
						<CODE_NAME>13년차</CODE_NAME>
					</record>
					<record>
						<CODE>14</CODE>
						<CODE_NAME>14년차</CODE_NAME>
					</record>
					<record>
						<CODE>15</CODE>
						<CODE_NAME>15년차</CODE_NAME>
					</record>
					<record>
						<CODE>16</CODE>
						<CODE_NAME>16년차</CODE_NAME>
					</record>
					<record>
						<CODE>17</CODE>
						<CODE_NAME>17년차</CODE_NAME>
					</record>
					<record>
						<CODE>18</CODE>
						<CODE_NAME>18년차</CODE_NAME>
					</record>
					<record>
						<CODE>19</CODE>
						<CODE_NAME>19년차</CODE_NAME>
					</record>
					<record>
						<CODE>20</CODE>
						<CODE_NAME>20년차</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_apstat">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<colinfo id="DTEXT1" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_tbld">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_mmn">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE>0</CODE>
						<CODE_NAME>0개월</CODE_NAME>
					</record>
					<record>
						<CODE>1</CODE>
						<CODE_NAME>1개월</CODE_NAME>
					</record>
					<record>
						<CODE>2</CODE>
						<CODE_NAME>2개월</CODE_NAME>
					</record>
					<record>
						<CODE>3</CODE>
						<CODE_NAME>3개월</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_his">
				<Contents>
					<colinfo id="AVR1" size="256" summ="default" type="STRING"/>
					<colinfo id="AVR2" size="256" summ="default" type="STRING"/>
					<colinfo id="AVR3" size="256" summ="default" type="STRING"/>
					<colinfo id="LAS" size="256" summ="default" type="STRING"/>
					<colinfo id="LKND" size="256" summ="default" type="STRING"/>
					<record>
						<AVR1></AVR1>
						<AVR2></AVR2>
						<AVR3></AVR3>
						<LAS></LAS>
						<LKND></LKND>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond3">
				<Contents>
					<colinfo id="DOC" size="256" summ="default" type="STRING"/>
					<record>
						<DOC></DOC>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cnt3">
				<Contents>
					<colinfo id="CNT" size="256" summ="default" type="STRING"/>
					<record>
						<CNT></CNT>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cost_o">
				<Contents>
					<colinfo id="NMT" size="256" summ="default" type="STRING"/>
					<colinfo id="JMT" size="256" summ="default" type="STRING"/>
					<colinfo id="JMT2" size="256" summ="default" type="STRING"/>
					<colinfo id="KMT" size="256" summ="default" type="STRING"/>
					<colinfo id="HMT" size="256" summ="default" type="STRING"/>
					<colinfo id="DMT" size="256" summ="default" type="STRING"/>
					<colinfo id="CMT" size="256" summ="default" type="STRING"/>
					<colinfo id="GMT" size="256" summ="default" type="STRING"/>
					<colinfo id="GMT2" size="256" summ="default" type="STRING"/>
					<colinfo id="COS1" size="256" summ="default" type="STRING"/>
					<colinfo id="COS2" size="256" summ="default" type="STRING"/>
					<colinfo id="PER" size="256" summ="default" type="STRING"/>
					<colinfo id="AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="TAMT" size="256" summ="default" type="STRING"/>
					<colinfo id="COSTT" size="256" summ="default" type="STRING"/>
					<colinfo id="COSTT2" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cost_sum">
				<Contents>
					<colinfo id="NMT" size="256" summ="default" type="STRING"/>
					<colinfo id="JMT" size="256" summ="default" type="STRING"/>
					<colinfo id="JMT2" size="256" summ="default" type="STRING"/>
					<colinfo id="KMT" size="256" summ="default" type="STRING"/>
					<colinfo id="HMT" size="256" summ="default" type="STRING"/>
					<colinfo id="DMT" size="256" summ="default" type="STRING"/>
					<colinfo id="CMT" size="256" summ="default" type="STRING"/>
					<colinfo id="GMT" size="256" summ="default" type="STRING"/>
					<colinfo id="GMT2" size="256" summ="default" type="STRING"/>
					<colinfo id="COS1" size="256" summ="default" type="STRING"/>
					<colinfo id="COS2" size="256" summ="default" type="STRING"/>
					<colinfo id="COSTT" size="256" summ="default" type="STRING"/>
					<colinfo id="COSTT2" size="256" summ="default" type="STRING"/>
					<colinfo id="AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="TAMT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cost_sum_i">
				<Contents>
					<colinfo id="COS1" size="256" summ="default" type="STRING"/>
					<colinfo id="COS2" size="256" summ="default" type="STRING"/>
					<colinfo id="COSTT" size="256" summ="default" type="STRING"/>
					<colinfo id="COSTT2" size="256" summ="default" type="STRING"/>
					<colinfo id="AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="TAMT" size="256" summ="default" type="STRING"/>
					<colinfo id="KND" size="256" summ="default" type="STRING"/>
					<colinfo id="GBU" size="256" summ="default" type="STRING"/>
					<colinfo id="ZYEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="STD" size="256" summ="default" type="STRING"/>
					<colinfo id="ETD" size="256" summ="default" type="STRING"/>
					<colinfo id="DOCNO" size="256" summ="default" type="STRING"/>
					<colinfo id="ETN" size="256" summ="default" type="STRING"/>
					<colinfo id="SIR" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cost_sum_o">
				<Contents>
					<colinfo id="GMT" size="256" summ="default" type="STRING"/>
					<colinfo id="GM2" size="256" summ="default" type="STRING"/>
					<colinfo id="COST" size="256" summ="default" type="STRING"/>
					<colinfo id="COS2" size="256" summ="default" type="STRING"/>
					<colinfo id="RAT" size="256" summ="default" type="STRING"/>
					<colinfo id="RA2" size="256" summ="default" type="STRING"/>
					<colinfo id="PER" size="256" summ="default" type="STRING"/>
					<colinfo id="INC" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cost">
				<Contents>
					<colinfo id="GNO" size="256" summ="default" type="STRING"/>
					<colinfo id="SIR" size="256" summ="default" type="STRING"/>
					<colinfo id="NMT" size="256" summ="default" type="STRING"/>
					<colinfo id="JMT" size="256" summ="default" type="STRING"/>
					<colinfo id="JM2" size="256" summ="default" type="STRING"/>
					<colinfo id="KMT" size="256" summ="default" type="STRING"/>
					<colinfo id="HMT" size="256" summ="default" type="STRING"/>
					<colinfo id="DMT" size="256" summ="default" type="STRING"/>
					<colinfo id="ACMT" size="256" summ="default" type="STRING"/>
					<colinfo id="CMT" size="256" summ="default" type="STRING"/>
					<colinfo id="GMT" size="256" summ="default" type="STRING"/>
					<colinfo id="GM2" size="256" summ="default" type="STRING"/>
					<colinfo id="COST" size="256" summ="default" type="STRING"/>
					<colinfo id="COS2" size="256" summ="default" type="STRING"/>
					<colinfo id="RAT" size="256" summ="default" type="STRING"/>
					<colinfo id="RA2" size="256" summ="default" type="STRING"/>
					<colinfo id="PER" size="256" summ="default" type="STRING"/>
					<colinfo id="INC" size="256" summ="default" type="STRING"/>
					<colinfo id="SJT" size="256" summ="default" type="STRING"/>
					<colinfo id="ZYEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="INCENTIVE" size="256" summ="default" type="STRING"/>
					<record>
						<ACMT></ACMT>
						<CMT></CMT>
						<COS2></COS2>
						<COST></COST>
						<DMT></DMT>
						<GM2></GM2>
						<GMT></GMT>
						<GNO></GNO>
						<HMT></HMT>
						<INC></INC>
						<INCENTIVE></INCENTIVE>
						<JM2></JM2>
						<JMT></JMT>
						<KMT></KMT>
						<NMT></NMT>
						<PER></PER>
						<RA2></RA2>
						<RAT></RAT>
						<SIR></SIR>
						<SJT></SJT>
						<ZYEAR></ZYEAR>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_plan_i">
				<Contents>
					<colinfo id="ZDATE" size="256" summ="default" type="STRING"/>
					<colinfo id="UPN" size="256" summ="default" type="STRING"/>
					<colinfo id="PJT" size="256" summ="default" type="STRING"/>
					<colinfo id="SPC2" size="256" summ="default" type="STRING"/>
					<colinfo id="SPC" size="256" summ="default" type="STRING"/>
					<colinfo id="SPC3" size="256" summ="default" type="STRING"/>
					<colinfo id="SPC7" size="256" summ="default" type="STRING"/>
					<colinfo id="PRO" size="256" summ="default" type="STRING"/>
					<colinfo id="BSU" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_plan_o">
				<Contents>
					<colinfo id="HNO" size="256" summ="default" type="STRING"/>
					<colinfo id="PJT" size="256" summ="default" type="STRING"/>
					<colinfo id="SPC1" size="256" summ="default" type="STRING"/>
					<colinfo id="SPC2" size="256" summ="default" type="STRING"/>
					<colinfo id="SPC3" size="256" summ="default" type="STRING"/>
					<colinfo id="SPC4" size="256" summ="default" type="STRING"/>
					<colinfo id="SPT" size="256" summ="default" type="STRING"/>
					<colinfo id="ADR" size="256" summ="default" type="STRING"/>
					<colinfo id="TEM" size="256" summ="default" type="STRING"/>
					<colinfo id="BSU" size="256" summ="default" type="STRING"/>
					<colinfo id="BLD" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="GBU" size="256" summ="default" type="STRING"/>
					<colinfo id="FDT" size="256" summ="default" type="STRING"/>
					<colinfo id="MNT" size="256" summ="default" type="STRING"/>
					<colinfo id="UPN" size="256" summ="default" type="STRING"/>
					<colinfo id="ISD" size="256" summ="default" type="STRING"/>
					<colinfo id="TBLD" size="256" summ="default" type="STRING"/>
					<colinfo id="BDT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_plan_list">
				<Contents>
					<colinfo id="ZDATE" size="256" summ="default" type="STRING"/>
					<colinfo id="UPN" size="256" summ="default" type="STRING"/>
					<colinfo id="PJT" size="256" summ="default" type="STRING"/>
					<colinfo id="SPC2" size="256" summ="default" type="STRING"/>
					<colinfo id="SPC" size="256" summ="default" type="STRING"/>
					<colinfo id="SPC3" size="256" summ="default" type="STRING"/>
					<colinfo id="SPC7" size="256" summ="default" type="STRING"/>
					<colinfo id="PRO" size="256" summ="default" type="STRING"/>
					<colinfo id="BSU" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_detail_pri">
				<Contents>
					<colinfo id="SEQ2" size="256" summ="default" type="STRING"/>
					<colinfo id="STD" size="256" summ="default" type="STRING"/>
					<colinfo id="ETD" size="256" summ="default" type="STRING"/>
					<colinfo id="TOT" size="256" summ="default" type="STRING"/>
					<colinfo id="TEM" size="256" summ="default" type="STRING"/>
					<colinfo id="RDT" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="SIR" size="256" summ="default" type="STRING"/>
					<colinfo id="MON" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_print1">
				<Contents>
					<colinfo id="UPN" size="256" summ="default" type="STRING"/>
					<colinfo id="ETN" size="256" summ="default" type="STRING"/>
					<colinfo id="SPT" size="256" summ="default" type="STRING"/>
					<colinfo id="TEM_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="BSU_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="WDT" size="256" summ="default" type="STRING"/>
					<colinfo id="ISD" size="256" summ="default" type="STRING"/>
					<colinfo id="CDT" size="256" summ="default" type="STRING"/>
					<colinfo id="STD" size="256" summ="default" type="STRING"/>
					<colinfo id="ETD" size="256" summ="default" type="STRING"/>
					<colinfo id="CPD" size="256" summ="default" type="STRING"/>
					<colinfo id="CND" size="256" summ="default" type="STRING"/>
					<colinfo id="CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="TOT" size="256" summ="default" type="STRING"/>
					<colinfo id="DYN" size="256" summ="default" type="STRING"/>
					<colinfo id="HYN" size="256" summ="default" type="STRING"/>
					<colinfo id="PRD" size="256" summ="default" type="STRING"/>
					<colinfo id="BLD" size="256" summ="default" type="STRING"/>
					<record>
						<BLD></BLD>
						<BSU_NM></BSU_NM>
						<CDT></CDT>
						<CND></CND>
						<CNT></CNT>
						<CPD></CPD>
						<DYN></DYN>
						<ETD></ETD>
						<ETN></ETN>
						<HYN></HYN>
						<ISD></ISD>
						<PRD></PRD>
						<SPT></SPT>
						<STD></STD>
						<TEM_NM></TEM_NM>
						<TOT></TOT>
						<UPN></UPN>
						<WDT></WDT>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_print1_result">
				<Contents>
					<colinfo id="UPN" size="256" summ="default" type="STRING"/>
					<colinfo id="ETN" size="256" summ="default" type="STRING"/>
					<colinfo id="SPT" size="256" summ="default" type="STRING"/>
					<colinfo id="TEM_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="BSU_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="WDT" size="256" summ="default" type="STRING"/>
					<colinfo id="ISD" size="256" summ="default" type="STRING"/>
					<colinfo id="CDT" size="256" summ="default" type="STRING"/>
					<colinfo id="STD" size="256" summ="default" type="STRING"/>
					<colinfo id="ETD" size="256" summ="default" type="STRING"/>
					<colinfo id="CPD" size="256" summ="default" type="STRING"/>
					<colinfo id="CND" size="256" summ="default" type="STRING"/>
					<colinfo id="CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="TOT" size="256" summ="default" type="STRING"/>
					<colinfo id="DYN" size="256" summ="default" type="STRING"/>
					<colinfo id="HYN" size="256" summ="default" type="STRING"/>
					<colinfo id="PRD" size="256" summ="default" type="STRING"/>
					<colinfo id="BLD" size="256" summ="default" type="STRING"/>
					<record>
						<BLD></BLD>
						<BSU_NM></BSU_NM>
						<CDT></CDT>
						<CND></CND>
						<CNT></CNT>
						<CPD></CPD>
						<DYN></DYN>
						<ETD></ETD>
						<ETN></ETN>
						<HYN></HYN>
						<ISD></ISD>
						<PRD></PRD>
						<SPT></SPT>
						<STD></STD>
						<TEM_NM></TEM_NM>
						<TOT></TOT>
						<UPN></UPN>
						<WDT></WDT>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_print2_result">
				<Contents>
					<colinfo id="TOT" size="256" summ="default" type="STRING"/>
					<colinfo id="NMT" size="256" summ="default" type="STRING"/>
					<colinfo id="JMT" size="256" summ="default" type="STRING"/>
					<colinfo id="JM2" size="256" summ="default" type="STRING"/>
					<colinfo id="KMT" size="256" summ="default" type="STRING"/>
					<colinfo id="HMT" size="256" summ="default" type="STRING"/>
					<colinfo id="DMT" size="256" summ="default" type="STRING"/>
					<colinfo id="CMT" size="256" summ="default" type="STRING"/>
					<colinfo id="INC" size="256" summ="default" type="STRING"/>
					<colinfo id="GMT" size="256" summ="default" type="STRING"/>
					<colinfo id="GM2" size="256" summ="default" type="STRING"/>
					<colinfo id="COS" size="256" summ="default" type="STRING"/>
					<colinfo id="CO2" size="256" summ="default" type="STRING"/>
					<colinfo id="RAT" size="256" summ="default" type="STRING"/>
					<colinfo id="RA2" size="256" summ="default" type="STRING"/>
					<colinfo id="SMT" size="256" summ="default" type="STRING"/>
					<colinfo id="SM2" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_print2">
				<Contents>
					<colinfo id="RAT1" size="256" summ="default" type="STRING"/>
					<colinfo id="RAT2" size="256" summ="default" type="STRING"/>
					<colinfo id="RAT3" size="256" summ="default" type="STRING"/>
					<colinfo id="RAT4" size="256" summ="default" type="STRING"/>
					<colinfo id="RAT5" size="256" summ="default" type="STRING"/>
					<colinfo id="RAT6" size="256" summ="default" type="STRING"/>
					<colinfo id="RAT7" size="256" summ="default" type="STRING"/>
					<colinfo id="RAT8" size="256" summ="default" type="STRING"/>
					<colinfo id="RAT9" size="256" summ="default" type="STRING"/>
					<colinfo id="RAT10" size="256" summ="default" type="STRING"/>
					<colinfo id="RAT11" size="256" summ="default" type="STRING"/>
					<colinfo id="RAT12" size="256" summ="default" type="STRING"/>
					<colinfo id="RAT13" size="256" summ="default" type="STRING"/>
					<colinfo id="RAT14" size="256" summ="default" type="STRING"/>
					<colinfo id="RAT15" size="256" summ="default" type="STRING"/>
					<colinfo id="RAT16" size="256" summ="default" type="STRING"/>
					<colinfo id="RAT17" size="256" summ="default" type="STRING"/>
					<colinfo id="RAT18" size="256" summ="default" type="STRING"/>
					<colinfo id="RAT19" size="256" summ="default" type="STRING"/>
					<colinfo id="RAT20" size="256" summ="default" type="STRING"/>
					<colinfo id="RAT21" size="256" summ="default" type="STRING"/>
					<colinfo id="RAT22" size="256" summ="default" type="STRING"/>
					<colinfo id="RAT23" size="256" summ="default" type="STRING"/>
					<colinfo id="RAT24" size="256" summ="default" type="STRING"/>
					<record>
						<RAT1></RAT1>
						<RAT10></RAT10>
						<RAT11></RAT11>
						<RAT12></RAT12>
						<RAT13></RAT13>
						<RAT14></RAT14>
						<RAT15></RAT15>
						<RAT16></RAT16>
						<RAT17></RAT17>
						<RAT18></RAT18>
						<RAT19></RAT19>
						<RAT2></RAT2>
						<RAT20></RAT20>
						<RAT21></RAT21>
						<RAT22></RAT22>
						<RAT23></RAT23>
						<RAT24></RAT24>
						<RAT3></RAT3>
						<RAT4></RAT4>
						<RAT5></RAT5>
						<RAT6></RAT6>
						<RAT7></RAT7>
						<RAT8></RAT8>
						<RAT9></RAT9>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_print3">
				<Contents>
					<colinfo id="FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="TEM" size="256" summ="default" type="STRING"/>
					<colinfo id="RDT" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="SIR" size="256" summ="default" type="STRING"/>
					<colinfo id="MATNR" size="256" summ="default" type="STRING"/>
					<colinfo id="MAKTX" size="256" summ="default" type="STRING"/>
					<colinfo id="MTART" size="256" summ="default" type="STRING"/>
					<colinfo id="MENGE" size="256" summ="default" type="STRING"/>
					<colinfo id="MEINS" size="256" summ="default" type="STRING"/>
					<colinfo id="SAMT1" size="256" summ="default" type="STRING"/>
					<colinfo id="SAMT2" size="256" summ="default" type="STRING"/>
					<colinfo id="TAMT" size="256" summ="default" type="STRING"/>
					<colinfo id="MTART_NM" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_print4">
				<Contents>
					<colinfo id="PJT" size="256" summ="default" type="STRING"/>
					<colinfo id="HNO" size="256" summ="default" type="STRING"/>
					<colinfo id="SPC" size="256" summ="default" type="STRING"/>
					<colinfo id="SPC2" size="256" summ="default" type="STRING"/>
					<colinfo id="ISD" size="256" summ="default" type="STRING"/>
					<colinfo id="BLD" size="256" summ="default" type="STRING"/>
					<colinfo id="TAMT" size="256" summ="default" type="STRING"/>
					<colinfo id="COSTT2" size="256" summ="default" type="STRING"/>
					<colinfo id="RAT" size="256" summ="default" type="STRING"/>
					<record>
						<BLD></BLD>
						<COSTT2></COSTT2>
						<HNO></HNO>
						<ISD></ISD>
						<PJT></PJT>
						<RAT></RAT>
						<SPC></SPC>
						<SPC2></SPC2>
						<TAMT></TAMT>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_conf_list">
				<Contents>
					<colinfo id="APRNK_S1" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM_S1" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE_S1" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK_S2" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM_S2" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE_S2" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK_S3" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM_S3" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE_S3" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK_S4" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM_S4" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE_S4" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK_S5" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM_S5" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE_S5" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK_R1" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM_R1" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE_R1" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK_R2" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM_R2" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE_R2" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK_R3" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM_R3" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE_R3" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK_R4" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM_R4" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE_R4" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK_R5" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM_R5" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE_R5" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_draftpers_list">
				<Contents>
					<colinfo id="D_TEM" size="256" summ="default" type="STRING"/>
					<colinfo id="D_RANK" size="256" summ="default" type="STRING"/>
					<colinfo id="D_NAME" size="256" summ="default" type="STRING"/>
					<colinfo id="D_DATE" size="256" summ="default" type="STRING"/>
					<colinfo id="DOCNO" size="256" summ="default" type="STRING"/>
					<colinfo id="D_TOTEM" size="256" summ="default" type="STRING"/>
					<record>
						<D_DATE></D_DATE>
						<D_NAME></D_NAME>
						<D_RANK></D_RANK>
						<D_TEM></D_TEM>
						<D_TOTEM></D_TOTEM>
						<DOCNO></DOCNO>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_docno_gen">
				<Contents>
					<colinfo id="PFX" size="256" type="STRING"/>
					<colinfo id="DOCNO" size="256" type="STRING"/>
					<record>
						<PFX></PFX>
						<DOCNO></DOCNO>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_decide">
				<Contents>
					<colinfo id="MANDT" size="256" summ="default" type="STRING"/>
					<colinfo id="DOCNO" size="256" summ="default" type="STRING"/>
					<colinfo id="DOCKIND" size="256" summ="default" type="STRING"/>
					<colinfo id="APPGUBN" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQNO" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQSTAT" size="256" summ="default" type="STRING"/>
					<colinfo id="APDPT1" size="256" summ="default" type="STRING"/>
					<colinfo id="APDPT1_N" size="256" summ="default" type="STRING"/>
					<colinfo id="APNUM" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE" size="256" summ="default" type="STRING"/>
					<colinfo id="APTIM" size="256" summ="default" type="STRING"/>
					<colinfo id="APDESC" size="256" summ="default" type="STRING"/>
					<colinfo id="APPGUBN2" size="256" summ="default" type="STRING"/>
					<record>
						<APDATE></APDATE>
						<APDESC></APDESC>
						<APDPT1></APDPT1>
						<APDPT1_N></APDPT1_N>
						<APNUM></APNUM>
						<APPGUBN></APPGUBN>
						<APPGUBN2></APPGUBN2>
						<APRNK></APRNK>
						<APTIM></APTIM>
						<DOCKIND></DOCKIND>
						<DOCNO></DOCNO>
						<MANDT></MANDT>
						<SEQNO></SEQNO>
						<SEQSTAT></SEQSTAT>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_count">
				<Contents>
					<colinfo id="CNT" size="256" summ="default" type="STRING"/>
					<record>
						<CNT></CNT>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cost_i">
				<Contents>
					<colinfo id="STD" size="256" summ="default" type="STRING"/>
					<colinfo id="ETD" size="256" summ="default" type="STRING"/>
					<colinfo id="ZYEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="MMN" size="256" summ="default" type="STRING"/>
					<colinfo id="HEP" size="256" summ="default" type="STRING"/>
					<colinfo id="CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="GBU" size="256" summ="default" type="STRING"/>
					<colinfo id="HNO" size="256" summ="default" type="STRING"/>
					<colinfo id="HMT" size="256" summ="default" type="STRING"/>
					<colinfo id="DMT" size="256" summ="default" type="STRING"/>
					<colinfo id="SPC" size="256" summ="default" type="STRING"/>
					<colinfo id="FLR" size="256" summ="default" type="STRING"/>
					<colinfo id="SPD" size="256" summ="default" type="STRING"/>
					<colinfo id="FDT" size="256" summ="default" type="STRING"/>
					<colinfo id="BLD" size="256" summ="default" type="STRING"/>
					<colinfo id="TEM" size="256" summ="default" type="STRING"/>
					<colinfo id="TYN" size="256" summ="default" type="STRING"/>
					<colinfo id="KND" size="256" summ="default" type="STRING"/>
					<colinfo id="AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="ACD" size="256" summ="default" type="STRING"/>
					<colinfo id="HWR" size="256" summ="default" type="STRING"/>
					<colinfo id="DND" size="256" summ="default" type="STRING"/>
					<colinfo id="FHRM" size="256" summ="default" type="STRING"/>
					<colinfo id="FHRU" size="256" summ="default" type="STRING"/>
					<colinfo id="FDPX" size="256" summ="default" type="STRING"/>
					<colinfo id="ABG" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_etn">
				<Contents>
					<colinfo id="TEM" size="256" summ="default" type="STRING"/>
					<colinfo id="RDT" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="SIR" size="256" summ="default" type="STRING"/>
					<record>
						<RDT></RDT>
						<SEQ></SEQ>
						<SIR></SIR>
						<TEM></TEM>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cost_sum_sj">
				<Contents>
					<colinfo id="GMT" size="256" summ="default" type="STRING"/>
					<colinfo id="GM2" size="256" summ="default" type="STRING"/>
					<colinfo id="COST" size="256" summ="default" type="STRING"/>
					<colinfo id="COS2" size="256" summ="default" type="STRING"/>
					<colinfo id="RAT" size="256" summ="default" type="STRING"/>
					<colinfo id="RA2" size="256" summ="default" type="STRING"/>
					<colinfo id="PER" size="256" summ="default" type="STRING"/>
					<colinfo id="SJT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_days">
				<Contents>
					<colinfo id="DAYS" size="256" type="STRING"/>
					<record>
						<DAYS></DAYS>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_costT">
				<Contents></Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_zterm">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_congb">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME>-&#32;선택&#32;-</CODE_NAME>
					</record>
					<record>
						<CODE>A</CODE>
						<CODE_NAME>표준</CODE_NAME>
					</record>
					<record>
						<CODE>B</CODE>
						<CODE_NAME>비표준</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cnt">
				<Contents>
					<colinfo id="CNT" size="256" summ="default" type="STRING"/>
					<record>
						<CNT></CNT>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_rcond">
				<Contents>
					<colinfo id="ZPROGRAM" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN" size="256" summ="default" type="STRING"/>
					<record>
						<GBN></GBN>
						<ZPROGRAM></ZPROGRAM>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_wbap01">
				<Contents>
					<colinfo id="APSTAT" size="3" summ="default" type="STRING"/>
					<colinfo id="CRDATE" size="24" summ="default" type="STRING"/>
					<colinfo id="CRDPT1" size="24" summ="default" type="STRING"/>
					<colinfo id="CRDPT1_N" size="60" summ="default" type="STRING"/>
					<colinfo id="CRIRUM" size="60" summ="default" type="STRING"/>
					<colinfo id="CRTIM" size="18" summ="default" type="STRING"/>
					<colinfo id="DOCKIND" size="3" summ="default" type="STRING"/>
					<colinfo id="DOCNO" size="30" summ="default" type="STRING"/>
					<colinfo id="DOCSEQ" size="6" summ="default" type="STRING"/>
					<colinfo id="REDATE" size="24" summ="default" type="STRING"/>
					<colinfo id="REDPT1" size="24" summ="default" type="STRING"/>
					<colinfo id="REDPT1_N" size="60" summ="default" type="STRING"/>
					<colinfo id="REIRUM" size="60" summ="default" type="STRING"/>
					<colinfo id="RETIM" size="18" summ="default" type="STRING"/>
					<colinfo id="FNAM" size="256" summ="default" type="STRING"/>
					<colinfo id="FSIZE" size="256" summ="default" type="STRING"/>
					<colinfo id="FILE_PATH" size="256" summ="default" type="STRING"/>
					<colinfo id="TELH" size="30" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_wbap02">
				<Contents>
					<colinfo id="APDATE" size="24" summ="default" type="STRING"/>
					<colinfo id="APDESC" size="0" summ="default" type="STRING"/>
					<colinfo id="APDPT1" size="24" summ="default" type="STRING"/>
					<colinfo id="APDPT1_N" size="60" summ="default" type="STRING"/>
					<colinfo id="APIRUM" size="60" summ="default" type="STRING"/>
					<colinfo id="APNUM" size="24" summ="default" type="STRING"/>
					<colinfo id="APPGUBN" size="6" summ="default" type="STRING"/>
					<colinfo id="APRNK" size="60" summ="default" type="STRING"/>
					<colinfo id="APTIM" size="18" summ="default" type="STRING"/>
					<colinfo id="DOCKIND" size="3" summ="default" type="STRING"/>
					<colinfo id="DOCNO" size="30" summ="default" type="STRING"/>
					<colinfo id="DOCSEQ" size="6" summ="default" type="STRING"/>
					<colinfo id="SEQNO" size="6" summ="default" type="STRING"/>
					<colinfo id="SEQSTAT" size="3" summ="default" type="STRING"/>
					<colinfo id="TELH" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_acyn">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME>-&#32;선택&#32;-</CODE_NAME>
					</record>
					<record>
						<CODE>Y</CODE>
						<CODE_NAME>Y</CODE_NAME>
					</record>
					<record>
						<CODE>N</CODE>
						<CODE_NAME>N</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_acnd">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
		</Datasets>
		<Shape BKColor="user12" Bottom="372" Height="26" Id="Shape17" Left="8" LineColor="user13" Right="848" TabOrder="153" Top="346" Type="Rectangle" Width="840"></Shape>
		<Shape BKColor="user12" Bottom="140" Height="26" Id="Shape9" Left="8" LineColor="user13" Right="848" TabOrder="75" Top="114" Type="Rectangle" Width="840"></Shape>
		<Grid AutoEnter="TRUE" AutoFitEndLine="Hide" BindDataset="ds_list2" BkColor2="default" BoldHead="true" Border="Flat" Bottom="616" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="168" Id="grd_list2" InputPanel="FALSE" Left="8" LineColor="user20" LineType="ExHORZ" Right="848" RowHeight="20" Style="sty_grid" TabOrder="1" TabStop="true" Top="448" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="840">
			<contents>
				<format id="Default">
					<columns>
						<col width="30"/>
						<col width="50"/>
						<col width="50"/>
						<col width="40"/>
						<col width="140"/>
						<col width="70"/>
						<col width="60"/>
						<col width="110"/>
						<col width="70"/>
						<col width="70"/>
						<col width="45"/>
						<col width="45"/>
						<col width="60"/>
						<col width="65"/>
						<col width="65"/>
						<col width="65"/>
						<col width="65"/>
						<col width="40"/>
						<col width="65"/>
						<col width="65"/>
						<col width="65"/>
						<col width="65"/>
						<col width="40"/>
						<col width="60"/>
						<col width="60"/>
						<col width="65"/>
						<col width="70"/>
						<col width="65"/>
						<col width="0"/>
						<col width="75"/>
						<col width="65"/>
					</columns>
					<head>
						<cell align="center" col="0" color="user21" display="text" font="굴림,9" text="No"/>
						<cell align="center" col="1" color="user21" display="text" font="굴림,9" text="통합PJT"/>
						<cell align="center" col="2" color="user21" display="text" font="굴림,9" text="원PJT"/>
						<cell align="center" col="3" color="user21" display="text" font="굴림,9" text="호기"/>
						<cell align="center" col="4" color="user21" display="text" font="굴림,9" text="현장명"/>
						<cell align="center" col="5" color="user21" display="text" font="굴림,9" text="건물용도"/>
						<cell align="center" col="6" color="user21" display="text" font="굴림,9" text="전기기종"/>
						<cell align="center" col="7" color="user21" display="text" font="굴림,9" text="사양"/>
						<cell align="center" col="8" color="user21" display="text" font="굴림,9" text="완성검사일"/>
						<cell align="center" col="9" color="user21" display="text" font="굴림,9" text="인수일"/>
						<cell align="center" col="10" color="user21" display="text" font="굴림,9" text="감시반"/>
						<cell align="center" col="11" color="user21" display="text" font="굴림,9" text="통합형"/>
						<cell align="center" bkcolor="user13" col="12" color="user21" display="text" font="굴림,9" text="SEG"/>
						<cell align="center" bkcolor="user13" col="13" color="user21" display="text" font="굴림,9" text="기준&#32;FM"/>
						<cell align="center" col="14" color="user21" display="text" font="굴림,9" text="FM보수료"/>
						<cell align="center" col="15" color="user21" display="text" font="굴림,9" text="FM직영"/>
						<cell align="center" col="16" color="user21" display="text" font="굴림,9" text="FM협력사"/>
						<cell align="center" bkcolor="user37" col="17" color="user21" display="text" font="굴림,9" text="달성율"/>
						<cell align="center" bkcolor="user13" col="18" color="user21" display="text" font="굴림,9" text="기준&#32;POG"/>
						<cell align="center" col="19" color="user21" display="text" font="굴림,9" text="POG보수료"/>
						<cell align="center" col="20" color="user21" display="text" font="굴림,9" text="POG직영"/>
						<cell align="center" col="21" color="user21" display="text" font="굴림,9" text="POG협력사"/>
						<cell align="center" bkcolor="user37" col="22" color="user21" display="text" font="굴림,9" text="달성율"/>
						<cell align="center" col="23" color="user21" display="text" font="굴림,9" text="HRTS무상"/>
						<cell align="center" col="24" color="user21" display="text" font="굴림,9" text="유무선"/>
						<cell align="center" col="25" color="user21" display="text" font="굴림,9" text="HRTS료"/>
						<cell align="center" col="26" color="user21" display="text" font="굴림,9" text="DI-PBX종류"/>
						<cell align="center" col="27" color="user21" display="text" font="굴림,9" text="DI-PBX료"/>
						<cell align="center" col="28" color="user21" display="text" font="굴림,9" text="공기청정기종류"/>
						<cell align="center" col="29" color="user21" display="text" font="굴림,9" text="공기청정기료"/>
						<cell align="center" col="30" color="user21" display="text" font="굴림,9" text="합계"/>
					</head>
					<body>
						<cell align="center" bkcolor2="user22" col="0" display="text" expr="currow+1"/>
						<cell align="center" bkcolor2="user22" col="1" colid="UPN" combodisplayrowcnt="6" display="text"/>
						<cell align="center" bkcolor2="user22" col="2" colid="PJT" combodisplayrowcnt="6" display="text"/>
						<cell align="center" bkcolor2="user22" col="3" colid="HNO" display="text"/>
						<cell align="left" bkcolor2="user22" col="4" colid="SPT" display="text"/>
						<cell align="center" bkcolor2="user22" col="5" colid="TBLD" combocol="CODE" combodataset="ds_tbld" combotext="CODE_NAME" display="combo"/>
						<cell align="center" bkcolor2="user22" col="6" colid="SPC" display="text"/>
						<cell bkcolor2="user22" col="7" colid="SPC2" display="text"/>
						<cell align="center" bkcolor2="user22" col="8" colid="WDT" display="text" Mask="####.##.##"/>
						<cell align="center" bkcolor2="user22" col="9" colid="ISD" display="text" Mask="####.##.##"/>
						<cell align="center" bkcolor2="user22" col="10" colid="TYN" display="text" limit="3"/>
						<cell align="center" bkcolor2="user22" col="11" colid="MATNR" display="text" limit="3"/>
						<cell align="center" bkcolor2="user22" col="12" colid="SEG" display="text" limit="3"/>
						<cell align="right" bkcolor2="user22" col="13" colid="F10" display="number"/>
						<cell align="right" bkcolor2="user22" col="14" colid="FMTT" display="number" edit="number"/>
						<cell align="right" bkcolor2="user22" col="15" colid="FMT" display="number" edit="number"/>
						<cell align="right" bkcolor2="user22" col="16" colid="FMBT" display="number"/>
						<cell align="right" bkcolor2="user22" col="17" colid="FRAT" display="number"/>
						<cell align="right" bkcolor2="user22" col="18" colid="P10" display="number"/>
						<cell align="right" bkcolor2="user22" col="19" colid="PMTT" display="number" edit="number"/>
						<cell align="right" bkcolor2="user22" col="20" colid="PMT" display="number" edit="number"/>
						<cell align="right" bkcolor2="user22" col="21" colid="PMBT" display="number"/>
						<cell align="right" bkcolor2="user22" col="22" colid="PRAT" display="number"/>
						<cell align="center" bkcolor2="user22" col="23" colid="HFR" display="checkbox" edit="checkbox"/>
						<cell align="center" bkcolor2="user22" col="24" colid="HWR" combocol="CODE" combodataset="ds_hwr" combotext="CODE_NAME" display="combo" edit="combo"/>
						<cell align="right" bkcolor2="user22" col="25" colid="HMT" display="number" edit='expr:iif(HFR==&#32;&quot;1&quot;,&apos;none&apos;,&apos;number&apos;)'/>
						<cell align="center" bkcolor2="user22" col="26" colid="DND" combocol="CODE" combodataset="ds_dnd" combotext="CODE_NAME" display="combo" edit="combo"/>
						<cell align="right" bkcolor2="user22" col="27" colid="DMT" display="number" edit="number"/>
						<cell align="center" bkcolor2="user22" col="28" colid="ACND" combocol="CODE" combodataset="ds_acnd" combotext="CODE_NAME" display="combo" edit="combo"/>
						<cell align="right" bkcolor2="user22" col="29" colid="ACMT" display="number" edit="number"/>
						<cell align="right" bkcolor2="user22" col="30" colid="AMT" display="number" edit="number"/>
					</body>
					<summary>
						<cell align="center" bkcolor="user25" col="0" color="user26" colspan="4" display="text" font="굴림,9" text="합&#32;계"/>
						<cell align="center" bkcolor="user25" col="4" color="user26" display="text"/>
						<cell align="center" bkcolor="user25" col="5" color="user26" display="text"/>
						<cell align="center" bkcolor="user25" col="6" color="user26" display="text"/>
						<cell align="center" bkcolor="user25" col="7" color="user26" display="text"/>
						<cell align="center" bkcolor="user25" col="8" color="user26" display="text"/>
						<cell align="center" bkcolor="user25" col="9" color="user26" display="text"/>
						<cell align="center" bkcolor="user25" col="10" color="user26" display="text"/>
						<cell align="center" bkcolor="user25" col="11" color="user26" display="text"/>
						<cell align="center" bkcolor="user25" col="12" color="user26" display="text"/>
						<cell align="right" bkcolor="user25" col="13" color="user26" display="number" expr='sum(&quot;F10&quot;)'/>
						<cell align="right" bkcolor="user25" col="14" color="user26" display="number" expr='sum(&quot;FMTT&quot;)'/>
						<cell align="right" bkcolor="user25" col="15" color="user26" display="number" expr='sum(&quot;FMT&quot;)'/>
						<cell align="right" bkcolor="user25" col="16" color="user26" display="number" expr='sum(&quot;FMBT&quot;)'/>
						<cell align="right" bkcolor="user25" col="17" color="user26" display="number" expr='round(sum(&quot;FMTT&quot;)/sum(&quot;F10&quot;)*100,1)'/>
						<cell align="right" bkcolor="user25" col="18" color="user26" display="number" expr='sum(&quot;P10&quot;)'/>
						<cell align="right" bkcolor="user25" col="19" color="user26" display="number" expr='sum(&quot;PMTT&quot;)'/>
						<cell align="right" bkcolor="user25" col="20" color="user26" display="number" expr='sum(&quot;PMT&quot;)'/>
						<cell align="right" bkcolor="user25" col="21" color="user26" display="number" expr='sum(&quot;PMBT&quot;)'/>
						<cell align="right" bkcolor="user25" col="22" color="user26" display="number" expr='round(sum(&quot;PMTT&quot;)/sum(&quot;P10&quot;)*100,1)'/>
						<cell align="center" bkcolor="user25" col="23" color="user26" display="text"/>
						<cell align="center" bkcolor="user25" col="24" color="user26" display="text"/>
						<cell align="right" bkcolor="user25" col="25" color="user26" display="number" expr='sum(&quot;HMT&quot;)'/>
						<cell align="center" bkcolor="user25" col="26" color="user26" display="text"/>
						<cell align="right" bkcolor="user25" col="27" color="user26" display="number" expr='sum(&quot;DMT&quot;)'/>
						<cell align="center" bkcolor="user25" col="28" color="user26" display="text"/>
						<cell align="right" bkcolor="user25" col="29" color="user26" display="number" expr='sum(&quot;ACMT&quot;)'/>
						<cell align="right" bkcolor="user25" col="30" color="user26" display="number" expr='sum(&quot;AMT&quot;)'/>
					</summary>
				</format>
			</contents>
		</Grid>
		<Shape BKColor="user12" Bottom="194" Height="26" Id="Shape14" Left="8" LineColor="user13" Right="848" TabOrder="128" Top="168" Type="Rectangle" Width="840"></Shape>
		<Shape BKColor="user12" Bottom="219" Height="26" Id="Shape15" Left="8" LineColor="user13" Right="848" TabOrder="129" Top="193" Type="Rectangle" Width="840"></Shape>
		<Shape BKColor="user12" Bottom="268" Height="26" Id="Shape12" Left="8" LineColor="user13" Right="848" TabOrder="100" Top="242" Type="Rectangle" Width="840"></Shape>
		<Shape BKColor="user12" Bottom="65" Height="26" Id="Shape13" Left="8" LineColor="user13" Right="848" TabOrder="124" Top="39" Type="Rectangle" Width="840"></Shape>
		<Shape BKColor="user12" Bottom="90" Height="26" Id="Shape8" Left="8" LineColor="user13" Right="848" TabOrder="68" Top="64" Type="Rectangle" Width="840"></Shape>
		<Shape BKColor="user12" Bottom="115" Height="26" Id="Shape5" Left="8" LineColor="user13" Right="848" TabOrder="43" Top="89" Type="Rectangle" Width="840"></Shape>
		<Shape BKColor="user12" Bottom="672" Height="52" Id="Shape6" Left="7" LineColor="user13" Right="847" TabOrder="52" Top="620" Type="Rectangle" Width="840"></Shape>
		<Shape BKColor="user12" Bottom="347" Height="26" Id="Shape1" Left="8" LineColor="user13" Right="848" TabOrder="4" Top="321" Type="Rectangle" Width="840"></Shape>
		<Shape BKColor="user12" Bottom="297" Height="26" Id="Shape2" Left="8" LineColor="user13" Right="848" TabOrder="5" Top="271" Type="Rectangle" Width="840"></Shape>
		<Shape BKColor="user12" Bottom="397" Height="26" Id="Shape4" Left="8" LineColor="user13" Right="848" TabOrder="19" Top="371" Type="Rectangle" Width="840"></Shape>
		<Shape BKColor="user12" Bottom="169" Height="26" Id="Shape0" Left="8" LineColor="user13" Right="848" TabOrder="14" Top="143" Type="Rectangle" Width="840"></Shape>
		<Shape BKColor="user12" Bottom="322" Height="26" Id="Shape3" Left="8" LineColor="user13" Right="848" TabOrder="18" Top="296" Type="Rectangle" Width="840"></Shape>
		<Div Height="36" Id="div_btn" TabOrder="2" Text="Div0" ToolTipFont="Default,0" Url="WB01::CommBtnForm.xml" Width="856">
			<Contents></Contents>
		</Div>
		<Calendar Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="146" Id="cal_temp" Left="1032" MonthOnly="TRUE" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" OnChanged="cal_temp_OnChanged" OnDayClick="cal_temp_OnDayClick" OnKillFocus="cal_temp_OnKillFocus" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="3" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="152" Value="20130101" Visible="FALSE" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="152"></Calendar>
		<Static Align="Center" Height="24" Id="st_etn" Left="262" Style="sty_lb_form_basic" TabOrder="6" Text="견적번호&#32;" Top="272" VAlign="Middle" Width="80"></Static>
		<Static Align="Center" Height="24" Id="st_mdt" Left="658" Style="sty_lb_form_basic" TabOrder="8" Text="견적작성일&#32;" Top="272" VAlign="Middle" Width="80"></Static>
		<Static Align="Center" Height="24" Id="st_midnm" Left="64" Style="sty_lb_form_basic" TabOrder="9" Text="견적작성자&#32;" Top="272" VAlign="Middle" Width="80"></Static>
		<Edit BindDataset="ds_head" Border="Flat" Column="ETN" Enable="FALSE" Height="20" Id="ed_etn" Left="346" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="7" Top="274" Width="110"></Edit>
		<Edit BindDataset="ds_head" Border="Flat" Column="SPT" Height="20" Id="ed_spt" Left="544" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="13" Top="146" Width="110"></Edit>
		<Static Align="Center" Height="24" Id="st_spt" Left="460" Style="sty_lb_form_basic" TabOrder="12" Text="현장명&#32;" Top="144" VAlign="Middle" Width="80"></Static>
		<Edit BindDataset="ds_head" Border="Flat" Column="NAM" Height="20" Id="ed_nam" Left="346" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="11" Top="146" Width="110"></Edit>
		<Static Align="Center" Height="24" Id="st_nam" Left="262" Style="sty_lb_form_basic" TabOrder="10" Text="고객명&#32;" Top="144" VAlign="Middle" Width="80"></Static>
		<Static Align="Center" Height="24" Id="st_adr" Left="64" Style="sty_lb_form_basic" TabOrder="15" Text="현장주소" Top="169" VAlign="Middle" Width="80"></Static>
		<Edit BindDataset="ds_head" Border="Flat" CheckLength="Byte" Column="ADR" Height="20" Id="ed_adr" Left="148" LeftMargin="4" MaxLength="100" Style="sty_ipt_form" TabOrder="16" Top="171" Width="310"></Edit>
		<Calendar BindDataset="ds_head" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="MDT" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Enable="FALSE" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_mdt" Left="742" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="17" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="274" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="104"></Calendar>
		<Edit BindDataset="ds_head" Border="Flat" Column="MID_NM" Enable="FALSE" Height="20" Id="ed_midnm" Left="148" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="20" Top="274" Width="110"></Edit>
		<Static Align="Center" Height="24" Id="st_sir" Left="460" Style="sty_lb_form_basic" TabOrder="21" Text="차수&#32;" Top="272" VAlign="Middle" Width="80"></Static>
		<Edit BindDataset="ds_head" Border="Flat" Column="SIR" Enable="FALSE" Height="20" Id="ed_sir" ImeMode="none" Left="544" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="22" Top="274" Width="110"></Edit>
		<Static Align="Center" Height="24" Id="st_cdt" Left="262" Style="sty_lb_form_basic" TabOrder="23" Text="계약예정일&#32;" Top="322" VAlign="Middle" Width="80"></Static>
		<Calendar BindDataset="ds_head" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="CDT" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_cdt" Left="346" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" OnChanged="cal_cdt_OnChanged" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="24" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="324" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="110"></Calendar>
		<Static Align="Center" Height="24" Id="st_prd" Left="658" Style="sty_lb_form_basic" TabOrder="25" Text="점검주기&#32;" Top="169" VAlign="Middle" Width="80"></Static>
		<Combo BindDataset="ds_head" Border="Flat" CodeColumn="CODE" Column="PRD" DataColumn="CODE_NAME" Height="20" Id="cb_prd" InnerDataset="ds_prd" Left="741" OnChanged="cb_prd_OnChanged" Style="sty_ipt_form" TabOrder="26" Top="170" Width="105"></Combo>
		<Static Align="Center" Height="24" Id="st_pjt" Left="64" Style="sty_lb_form_basic" TabOrder="27" Text="프로젝트" Top="144" VAlign="Middle" Width="80"></Static>
		<Edit BindDataset="ds_head" Border="Flat" Column="PJT" Height="20" Id="ed_pjt" Left="148" LeftMargin="4" MaxLength="6" RightMargin="4" Style="sty_ipt_form" TabOrder="28" Top="146" Width="110"></Edit>
		<Static Align="Center" Height="24" Id="st_spc" Left="460" Style="sty_lb_form_basic" TabOrder="29" Text="기종&#32;" Top="169" VAlign="Middle" Width="80"></Static>
		<Edit BindDataset="ds_head" Border="Flat" Column="SPC" Height="20" Id="ed_spc" Left="544" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="30" Top="171" Width="110"></Edit>
		<Static Height="21" Id="st_hwr" Left="848" TabOrder="31" Text="HRTS&#32;회선종류" Top="744" Visible="FALSE" Width="88"></Static>
		<Static Height="21" Id="st_dnd" Left="944" TabOrder="32" Text="DI-PBX&#32;종류" Top="744" Visible="FALSE" Width="78"></Static>
		<Static Align="Right" Height="24" Id="st_cdy" Left="460" Style="sty_lb_form_basic" TabOrder="33" Text="유상계약기간&#32;" Top="322" VAlign="Middle" Width="80"></Static>
		<Static Align="Center" Height="24" Id="st_cnd" Left="64" Style="sty_lb_form_basic" TabOrder="34" Text="계약유형&#32;" Top="90" VAlign="Middle" Width="80"></Static>
		<Static Align="Center" Height="24" Id="st_ygb" Left="262" Style="sty_lb_form_basic" TabOrder="35" Text="영업주체&#32;" Top="297" VAlign="Middle" Width="80"></Static>
		<Combo BindDataset="ds_head" Border="Flat" CodeColumn="CODE" Column="CND" DataColumn="CODE_NAME" Enable="FALSE" Height="20" Id="cb_cnd" InnerDataset="ds_cnd" Left="147" Style="sty_ipt_form" TabOrder="36" Top="91" Width="93"></Combo>
		<Combo BindDataset="ds_head" Border="Flat" CodeColumn="CODE" Column="YGB" DataColumn="CODE_NAME" Height="20" Id="cb_ygb" InnerDataset="ds_ygb" Left="345" Style="sty_ipt_form" TabOrder="37" Top="298" Width="110"></Combo>
		<Static Align="Center" Height="24" Id="st_cnt" Left="64" Style="sty_lb_form_basic" TabOrder="38" Text="대수" Top="194" VAlign="Middle" Width="80"></Static>
		<Edit BindDataset="ds_head" Border="Flat" Column="CNT" Enable="FALSE" Height="20" Id="ed_cnt" Left="148" LeftMargin="3" MaxLength="3" Number="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="39" Top="196" Width="110"></Edit>
		<Static Align="Center" Height="24" Id="st_flr" Left="262" Style="sty_lb_form_basic" TabOrder="40" Text="층수&#32;" Top="194" VAlign="Middle" Width="80"></Static>
		<Edit BindDataset="ds_head" Border="Flat" Column="FLR" Height="20" Id="ed_flr" Left="346" LeftMargin="3" MaxLength="3" Number="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="41" Top="196" Width="110"></Edit>
		<Static Align="Center" Height="24" Id="st_spd" Left="460" Style="sty_lb_form_basic" TabOrder="42" Text="속도&#32;" Top="194" VAlign="Middle" Width="80"></Static>
		<Combo BindDataset="ds_head" Border="Flat" CodeColumn="CODE" Column="ACYN" DataColumn="CODE_NAME" Enable="FALSE" Height="20" Id="cb_acyn" InnerDataset="ds_acyn" Left="147" Style="sty_ipt_form" TabOrder="45" Top="244" Width="110"></Combo>
		<Static Align="Center" Height="24" Id="st_acyn" Left="64" Style="sty_lb_form_basic" TabOrder="44" Text="공기청정기유무" Top="243" VAlign="Middle" Width="80"></Static>
		<Static Align="Center" Height="24" Id="st_hyn" Left="262" Style="sty_lb_form_basic" TabOrder="46" Text="HRTS유무&#32;" Top="243" VAlign="Middle" Width="80"></Static>
		<Combo BindDataset="ds_head" Border="Flat" CodeColumn="CODE" Column="HYN" DataColumn="CODE_NAME" Enable="FALSE" Height="20" Id="cb_hyn" InnerDataset="ds_hyn" Left="345" Style="sty_ipt_form" TabOrder="47" Top="244" Width="110"></Combo>
		<Static Align="Center" Height="24" Id="st_dyn" Left="460" Style="sty_lb_form_basic" TabOrder="48" Text="DI-PBX유무&#32;" Top="243" VAlign="Middle" Width="80"></Static>
		<Combo BindDataset="ds_head" Border="Flat" CodeColumn="CODE" Column="DYN" DataColumn="CODE_NAME" Enable="FALSE" Height="20" Id="cb_dyn" InnerDataset="ds_dyn" Left="543" Style="sty_ipt_form" TabOrder="49" Top="244" Width="110"></Combo>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_matnr" ImageID="btn_sub_06" Left="544" LeftMargin="12" OnClick="btn_matnr_OnClick" Style="sty_btn" TabOrder="50" Text="투입예상자재" Top="117" Transparent="TRUE" Width="95"></Button>
		<TextArea BindDataset="ds_head" Border="Flat" Column="RMK" Height="52" Id="txt_rmk" Left="88" MaxLength="500" Style="sty_ipt_form" TabOrder="51" Top="620" VScroll="TRUE" Width="584"></TextArea>
		<Static Align="Right" Height="50" Id="Static0" Left="8" Style="sty_lb_form_basic" TabOrder="53" Text="특이사항&#32;&#10;&#32;(500자)&#32;" Top="621" VAlign="Middle" Width="80"></Static>
		<Static Align="Center" Height="24" Id="st_cpd" Left="64" Style="sty_lb_form_basic" TabOrder="54" Text="계약상품" Top="322" VAlign="Middle" Width="80"></Static>
		<Combo BindDataset="ds_head" Border="Flat" CodeColumn="CODE" Column="CPD" DataColumn="CODE_NAME" Height="20" Id="cb_cpd" InnerDataset="ds_cpd" Left="147" OnChanged="cb_cpd_OnChanged" Style="sty_ipt_form" TabOrder="55" Top="323" Width="110"></Combo>
		<Combo BindDataset="ds_head" Border="Flat" CodeColumn="CODE" Column="SPD" DataColumn="CODE_NAME" Height="20" Id="cb_spd" InnerDataset="ds_spd" Left="543" Style="sty_ipt_form" TabOrder="56" Top="195" Width="110"></Combo>
		<Shape BKColor="user12" Bottom="243" Height="26" Id="Shape7" Left="8" LineColor="user13" Right="848" TabOrder="57" Top="217" Type="Rectangle" Width="840"></Shape>
		<Static Align="Center" Height="24" Id="st_bld" Left="64" Style="sty_lb_form_basic" TabOrder="58" Text="건물용도&#32;" Top="218" VAlign="Middle" Width="80"></Static>
		<Combo BindDataset="ds_head" Border="Flat" CodeColumn="CODE" Column="BLD" DataColumn="CODE_NAME" Height="20" Id="cb_bld" InnerDataset="ds_bld" Left="147" Style="sty_ipt_form" TabOrder="59" Top="219" Width="110"></Combo>
		<Static Align="Center" Height="24" Id="st_srg" Left="262" Style="sty_lb_form_basic" TabOrder="60" Text="Roping&#32;방식" Top="218" VAlign="Middle" Width="80"></Static>
		<Combo BindDataset="ds_head" Border="Flat" CodeColumn="CODE" Column="SRG" DataColumn="CODE_NAME" Height="20" Id="cb_srg" InnerDataset="ds_srg" Left="345" Style="sty_ipt_form" TabOrder="61" Top="219" Width="110"></Combo>
		<Static Align="Center" Height="24" Id="st_pdt" Left="460" Style="sty_lb_form_basic" TabOrder="62" Text="제품군&#32;" Top="218" VAlign="Middle" Width="80"></Static>
		<Combo BindDataset="ds_head" Border="Flat" CodeColumn="CODE" Column="PDT" DataColumn="CODE_NAME" Height="20" Id="cb_pdt" InnerDataset="ds_pdt" Left="543" Style="sty_ipt_form" TabOrder="63" Top="219" Width="110"></Combo>
		<Static Align="Center" Height="24" Id="st_syr" Left="658" Style="sty_lb_form_basic" TabOrder="64" Text="설치연령&#32;" Top="194" VAlign="Middle" Width="80"></Static>
		<Combo BindDataset="ds_head" Border="Flat" CodeColumn="CODE" Column="SYR" DataColumn="CODE_NAME" Height="20" Id="cb_syr" InnerDataset="ds_syr" Left="741" Style="sty_ipt_form" TabOrder="65" Top="195" Width="105"></Combo>
		<Static Align="Center" Height="24" Id="st_app" Left="460" Style="sty_lb_form_basic" TabOrder="66" Text="결재상태&#32;" Top="65" VAlign="Middle" Width="80"></Static>
		<Combo BindDataset="ds_head" Border="Flat" CodeColumn="CODE" Column="APSTAT" DataColumn="DTEXT1" Enable="FALSE" Height="20" Id="cb_apstat" InnerDataset="ds_apstat" Left="543" Style="sty_ipt_search" TabOrder="66" Top="66" Width="110"></Combo>
		<Static Align="Right" Height="24" Id="st_ra1" Left="870" Style="sty_lb_form_basic" TabOrder="69" Text="시행율1&#32;" Top="38" VAlign="Middle" Width="80"></Static>
		<Edit Align="RIGHT" BindDataset="ds_head" Border="Flat" Column="RA1" Enable="FALSE" Height="20" Id="ed_ra1" Left="952" LeftMargin="4" RightMargin="3" Style="sty_ipt_form" TabOrder="70" Top="40" Width="120"></Edit>
		<Static Align="Center" Height="24" Id="st_ra2" Left="658" Style="sty_lb_form_basic" TabOrder="71" Text="시행율&#32;" Top="65" VAlign="Middle" Width="80"></Static>
		<Edit Align="RIGHT" BindDataset="ds_head" Border="Flat" Column="RA2" Enable="FALSE" Height="20" Id="ed_ra2" Left="742" LeftMargin="4" RightMargin="3" Style="sty_ipt_form" TabOrder="72" Top="67" Width="104"></Edit>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_addmat" ImageID="btn_sub_05" Left="642" LeftMargin="12" OnClick="btn_addmat_OnClick" Style="sty_btn" TabOrder="73" Text="추가자재" Top="117" Transparent="TRUE" Width="83"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_cos" ImageID="btn_sub_06" Left="736" LeftMargin="12" OnClick="btn_cos_OnClick" Style="sty_btn" TabOrder="74" Text="원가내역조회" Top="117" Transparent="TRUE" Width="95"></Button>
		<Static Align="Center" Height="24" Id="Static1" Left="64" Style="sty_lb_form_basic" TabOrder="75" Text="전결규정&#32;" Top="65" VAlign="Middle" Width="80"></Static>
		<Static Align="Center" Height="24" Id="st_mmn" Left="460" Style="sty_lb_form_basic" TabOrder="76" Text="무상개월수&#32;" Top="90" VAlign="Middle" Width="80"></Static>
		<Static Align="Center" Height="24" Id="st_dat" Left="658" Style="sty_lb_form_basic" TabOrder="77" Text="할인율&#32;" Top="90" VAlign="Middle" Width="80"></Static>
		<Edit Align="RIGHT" BindDataset="ds_head" Border="Flat" Column="DAT" Enable="FALSE" Height="20" Id="ed_dat" Left="742" LeftMargin="4" RightMargin="3" Style="sty_ipt_form" TabOrder="78" Top="92" Width="104"></Edit>
		<Shape BKColor="user12" Bottom="769" Height="26" Id="Shape10" Left="-1" LineColor="user13" Right="821" TabOrder="80" Top="743" Type="Rectangle" Width="822"></Shape>
		<Static Align="Right" Height="24" Id="st_1st" Style="sty_lb_form_basic" TabOrder="81" Text="1차견적&#32;" Top="744" VAlign="Middle" Width="80"></Static>
		<Static Align="Right" Height="24" Id="st_2nd" Left="205" Style="sty_lb_form_basic" TabOrder="82" Text="2차견적&#32;" Top="744" VAlign="Middle" Width="80"></Static>
		<Static Align="Right" Height="24" Id="st_3rd" Left="410" Style="sty_lb_form_basic" TabOrder="83" Text="3차견적&#32;" Top="744" VAlign="Middle" Width="80"></Static>
		<Static Align="Center" Height="24" Id="st_lat" Left="64" Style="sty_lb_form_basic" TabOrder="84" Text="종전보수료&#32;" Top="115" VAlign="Middle" Width="80"></Static>
		<Edit Align="CENTER" BindDataset="ds_head" Border="Flat" Column="COF" Enable="FALSE" Height="20" Id="ed_cof" Left="148" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="85" Top="43" Visible="FALSE" Width="100"></Edit>
		<Shape BKColor="user12" Bottom="723" Height="52" Id="Shape11" Left="7" LineColor="user13" Right="847" TabOrder="87" Top="671" Type="Rectangle" Width="840"></Shape>
		<TextArea BindDataset="ds_head" Border="Flat" Column="OPN" Height="52" Id="txt_opn" Left="88" MaxLength="250" Style="sty_ipt_form" TabOrder="86" Top="671" VScroll="TRUE" Width="689"></TextArea>
		<Static Align="Right" Height="50" Id="st_opn" Left="8" Style="sty_lb_form_basic" TabOrder="88" Text="검토의견&#32;&#10;&#32;(250자)&#32;" Top="672" VAlign="Middle" Width="80"></Static>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_saveopn" ImageID="btn_sub_02" Left="779" LeftMargin="12" OnClick="btn_saveopn_OnClick" Style="sty_btn" TabOrder="89" Text="저장" Top="688" Transparent="TRUE" Width="47"></Button>
		<MaskEdit BindDataset="ds_his" Border="Flat" Column="AVR1" Enable="FALSE" Height="20" Id="med_1st" Left="82" Mask="###,###" Style="sty_ipt_form" TabOrder="90" Top="746" Width="70"></MaskEdit>
		<MaskEdit BindDataset="ds_his" Border="Flat" Column="AVR2" Enable="FALSE" Height="20" Id="med_avr2" Left="287" Mask="###,###" Style="sty_ipt_form" TabOrder="91" Top="746" Width="70"></MaskEdit>
		<MaskEdit BindDataset="ds_his" Border="Flat" Column="AVR3" Enable="FALSE" Height="20" Id="med_avr3" Left="492" Mask="###,###" Style="sty_ipt_form" TabOrder="92" Top="746" Width="70"></MaskEdit>
		<MaskEdit BindDataset="ds_his" Border="Flat" Column="LAS" Enable="FALSE" Height="20" Id="med_las" Left="148" Mask="###,###" Style="sty_ipt_form" TabOrder="93" Top="117" Width="70"></MaskEdit>
		<Static Align="Center" Height="24" Id="Static2" Left="64" Style="sty_lb_form_basic" TabOrder="94" Text="영업담당자&#32;" Top="297" VAlign="Middle" Width="80"></Static>
		<Edit BindDataset="ds_head" Border="Flat" Column="ZMAN" Enable="FALSE" Height="20" Id="Edit0" Left="148" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="95" Top="299" Width="110"></Edit>
		<Button Cursor="HAND" Height="18" Id="btn_pri" ImageID="btn_icon_search" Left="785" OnClick="btn_pri_OnClick" TabOrder="96" Text="Button0" Top="325" Width="18"></Button>
		<Static Height="15" Id="Static3" Left="660" TabOrder="97" Text="~" Top="328" Width="17"></Static>
		<Static Align="Center" Height="24" Id="Static4" Left="460" Style="sty_lb_form_basic" TabOrder="99" Text="상주금액" Top="372" VAlign="Middle" Width="80"></Static>
		<Static Align="Center" Height="24" Id="Static5" Left="262" Style="sty_lb_form_basic" TabOrder="98" Text="인원상주조건" Top="372" VAlign="Middle" Width="80"></Static>
		<Static Align="Center" Height="24" Id="Static6" Left="658" Style="sty_lb_form_basic" TabOrder="101" Text="기성지급율" Top="372" VAlign="Middle" Width="80"></Static>
		<Static Align="Right" Height="24" Id="st_gbu" Left="864" Style="sty_lb_form_basic" TabOrder="102" Text="직영구분&#32;" Top="160" VAlign="Middle" Width="80"></Static>
		<Combo BindDataset="ds_head" Border="Flat" CodeColumn="CODE" Column="GBU" DataColumn="CODE_NAME" Enable="FALSE" Height="20" Id="cb_gbu" InnerDataset="ds_gbu" Left="947" Style="sty_ipt_form" TabOrder="103" Top="161" Width="104"></Combo>
		<Calendar BindDataset="ds_head" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="STD" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_from" Left="544" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" OnChanged="cal_from_OnChanged" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="104" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="324" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="110"></Calendar>
		<Calendar BindDataset="ds_head" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="ETD" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_to" Left="673" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" OnChanged="cal_to_OnChanged" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="105" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="324" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="110"></Calendar>
		<Static Height="13" Id="Static7" Left="396" TabOrder="106" Text="인원수" Top="378" Width="36"></Static>
		<Static Height="15" Id="Static8" Left="155" TabOrder="107" Text="(증감율)" Top="750" Width="56"></Static>
		<Static Height="15" Id="Static9" Left="360" TabOrder="108" Text="(증감율)" Top="750" Width="56"></Static>
		<Static Height="15" Id="Static10" Left="563" TabOrder="109" Text="(증감율)" Top="750" Width="56"></Static>
		<Static Height="15" Id="Static12" Left="822" TabOrder="110" Text="%" Top="377" Width="17"></Static>
		<MaskEdit BindDataset="ds_head" Border="Flat" Column="GIS" DecimalLen="1" DigitLen="3" Enable="FALSE" Height="20" Id="MaskEdit0" Left="742" Mask="####.#" NullValue="90.0" Style="sty_ipt_form" TabOrder="111" Top="374" Value="90.0" Width="78"></MaskEdit>
		<MaskEdit BindDataset="ds_head" Border="Flat" Column="SAJ" Enable="FALSE" Height="20" Id="med_sangjuAmt" Left="544" Mask="###,###" NullValue="0" Style="sty_ipt_form" TabOrder="112" Top="374" Value="0" Width="110"></MaskEdit>
		<MaskEdit BindDataset="ds_head" Border="Flat" Column="PNT" Enable="FALSE" Height="20" Id="ed_pnt" Left="434" Mask="###,###" NullValue="0" Style="sty_ipt_form" TabOrder="113" Top="374" Value="0" Width="25"></MaskEdit>
		<Edit Align="CENTER" BindDataset="ds_head" Border="Flat" Column="COF2" Enable="FALSE" Height="20" Id="ed_cof2" Left="249" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="114" Top="43" Visible="FALSE" Width="100"></Edit>
		<Edit Align="RIGHT" BindDataset="ds_head" Border="Flat" Column="MMN" Enable="FALSE" Height="20" Id="ed_mmn" Left="544" LeftMargin="4" RightMargin="3" Style="sty_ipt_form" TabOrder="115" Top="92" Width="110"></Edit>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_sangju" ImageID="btn_sub_02" Left="346" LeftMargin="12" OnClick="btn_sangju_OnClick" Style="sty_btn" TabOrder="116" Text="입력" Top="374" Transparent="TRUE" Width="48"></Button>
		<Static Align="Center" Height="24" Id="st_trat" Left="252" Style="sty_lb_form_basic" TabOrder="117" Text="기준단가달성율" Top="90" VAlign="Middle" Width="90"></Static>
		<MaskEdit BindDataset="ds_head" Border="Flat" Column="TRAT" DecimalLen="1" DigitLen="3" Enable="FALSE" Height="20" Id="med_trat" Left="346" Mask="####.#" Style="sty_ipt_form" TabOrder="118" Top="92" Width="110"></MaskEdit>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_calRat" ImageID="btn_sub_04" Left="880" LeftMargin="12" OnClick="btn_calRat_OnClick" Style="sty_btn" TabOrder="120" Text="전송" Top="200" Transparent="TRUE" Visible="FALSE" Width="72"></Button>
		<Edit BindDataset="ds_head" Border="Flat" Column="COF3" Enable="FALSE" Height="20" Id="ed_cof3" Left="952" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="119" Top="88" Width="100"></Edit>
		<Static Align="Right" Height="24" Id="Static13" Left="864" Style="sty_lb_form_basic" TabOrder="121" Text="전결(pog갱신)" Top="86" VAlign="Middle" Width="80"></Static>
		<Static Align="Right" Height="24" Id="Static14" Left="864" Style="sty_lb_form_basic" TabOrder="122" Text="전결(pog갱신)" Top="118" VAlign="Middle" Width="80"></Static>
		<Edit BindDataset="ds_head" Border="Flat" Column="TRAT_B" Enable="FALSE" Height="20" Id="ed_trt_b" Left="952" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="123" Top="120" Width="100"></Edit>
		<Edit BindDataset="ds_head" Border="Flat" DisableColor="user8" Enable="FALSE" Font="Default,9,Bold" Height="20" Id="ed_cof_cfo" Left="368" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="125" Top="67" Width="75"></Edit>
		<Static Align="Center" Height="24" Id="Static15" Left="252" Style="sty_lb_form_basic" TabOrder="126" Text="종전단가달성율" Top="115" VAlign="Middle" Width="90"></Static>
		<MaskEdit BindDataset="ds_head" Border="Flat" Column="TRAT_B" DecimalLen="1" DigitLen="3" Enable="FALSE" Height="20" Id="MaskEdit1" Left="346" Mask="####.#" Style="sty_ipt_form" TabOrder="127" Top="117" Width="110"></MaskEdit>
		<Static Align="Center" BKColor="user20" Height="123" Id="Static16" Left="9" Style="sty_lb_form_basic" TabOrder="130" Text="현장정보" Top="144" VAlign="Middle" Width="55"></Static>
		<Static Align="Center" BKColor="user20" Height="74" Id="Static18" Left="9" Style="sty_lb_form_basic" TabOrder="132" Text="결재정보" Top="65" VAlign="Middle" Width="55"></Static>
		<Shape BKColor="user12" Bottom="422" Height="26" Id="Shape16" Left="8" LineColor="user13" Right="848" TabOrder="133" Top="396" Type="Rectangle" Width="840"></Shape>
		<Static Align="Center" BKColor="user20" Height="174" Id="Static17" Left="9" Style="sty_lb_form_basic" TabOrder="131" Text="견적정보" Top="272" VAlign="Middle" Width="55"></Static>
		<Static Align="Center" Height="24" Id="Static19" Left="602" Style="sty_lb_form_basic" TabOrder="134" Text="수금조건" Top="397" VAlign="Middle" Width="80"></Static>
		<Static Align="Center" Height="24" Id="Static20" Left="658" Style="sty_lb_form_basic" TabOrder="135" Text="DI-PBX타입&#32;" Top="243" VAlign="Middle" Width="80"></Static>
		<Static Align="Center" Height="24" Id="Static21" Left="658" Style="sty_lb_form_basic" TabOrder="136" Text="유지관리업체" Top="144" VAlign="Middle" Width="80"></Static>
		<Static Align="Center" Height="24" Id="Static22" Left="350" Style="sty_lb_form_basic" TabOrder="137" Text="점검특이사항" Top="397" VAlign="Middle" Width="80"></Static>
		<Static Align="Center" Height="24" Id="Static23" Left="64" Style="sty_lb_form_basic" TabOrder="138" Text="HRTS견적가" Top="372" VAlign="Middle" Width="80"></Static>
		<Static Align="Center" Height="24" Id="Static24" Left="64" Style="sty_lb_form_basic" TabOrder="139" Text="견적단가" Top="347" VAlign="Middle" Width="80"></Static>
		<Static Align="Center" Height="24" Id="Static25" Left="460" Style="sty_lb_form_basic" TabOrder="140" Text="비표준여부" Top="297" VAlign="Middle" Width="80"></Static>
		<Combo BindDataset="ds_head" Border="Flat" CodeColumn="CODE" Column="ZTERM" DataColumn="CODE_NAME" Height="20" Id="cb_zterm" InnerDataset="ds_zterm" Left="684" Style="sty_ipt_form" TabOrder="141" Top="398" Width="159"></Combo>
		<Combo BindDataset="ds_head" Border="Flat" CodeColumn="CODE" Column="CONGB" DataColumn="CODE_NAME" Height="20" Id="cb_congb" INDEX="0" InnerDataset="ds_congb" Left="543" Style="sty_ipt_form" TabOrder="142" Top="298" Width="110"></Combo>
		<Checkbox BindDataset="ds_head" Column="NIGHT" Height="22" Id="chk_night" Left="440" TabOrder="143" Text="야간점검" Top="397" Width="75"></Checkbox>
		<Checkbox BindDataset="ds_head" Column="WEND" Height="22" Id="chk_wend" Left="528" TabOrder="144" Text="휴일점검" Top="397" Width="75"></Checkbox>
		<MaskEdit BindDataset="ds_head" Border="Flat" Column="AMTT_S" Enable="FALSE" Height="20" Id="MaskEdit2" Left="148" Mask="###,###" NullValue="0" Style="sty_ipt_form" TabOrder="145" Top="349" Value="0" Width="110"></MaskEdit>
		<MaskEdit BindDataset="ds_head" Border="Flat" Column="HMT_S" Enable="FALSE" Height="20" Id="MaskEdit3" Left="148" Mask="###,###" NullValue="0" Style="sty_ipt_form" TabOrder="146" Top="374" Value="0" Width="110"></MaskEdit>
		<Edit BindDataset="ds_list2" Border="Flat" Column="ABR_NM" Enable="FALSE" Height="20" Id="ed_abr_nm" Left="742" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="147" Top="146" Width="104"></Edit>
		<Edit BindDataset="ds_head" Border="Flat" Column="EL_DEPH" Enable="FALSE" Height="20" Id="Edit1" Left="742" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="148" Top="245" Width="104"></Edit>
		<Edit Align="CENTER" BindDataset="ds_head" Border="Flat" Enable="FALSE" Height="20" Id="ed_cof_final" Left="148" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="149" Top="67" Width="75"></Edit>
		<Edit BindDataset="ds_head" Border="Flat" Enable="FALSE" Height="20" Id="ed_cof_final_tx" Left="225" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="150" Top="67" Width="140"></Edit>
		<Edit Align="CENTER" Border="Flat" Enable="FALSE" Height="20" Id="ed_knddif" Left="460" LeftMargin="4" RightMargin="3" Style="sty_ipt_form" TabOrder="151" Top="117" Width="80"></Edit>
		<Edit Align="CENTER" Border="Flat" DisableBKColor="yellow" DisableColor="user17" Enable="FALSE" Height="20" Id="ed_hrtsFreeText" Left="264" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="152" Text="무상제공" Top="399" Visible="FALSE" Width="80"></Edit>
		<MaskEdit BindDataset="ds_head" Border="Flat" Column="DMT_S" Enable="FALSE" Height="20" Id="MaskEdit4" Left="148" Mask="###,###" NullValue="0" Style="sty_ipt_form" TabOrder="155" Top="399" Value="0" Width="110"></MaskEdit>
		<Static Align="Center" Height="24" Id="Static11" Left="64" Style="sty_lb_form_basic" TabOrder="154" Text="DI-PBX견적가" Top="397" VAlign="Middle" Width="80"></Static>
		<Static Align="Center" Height="24" Id="Static26" Left="460" Style="sty_lb_form_basic" TabOrder="156" Text="직영견적단가" Top="347" VAlign="Middle" Width="80"></Static>
		<MaskEdit BindDataset="ds_head" Border="Flat" Column="AMT_S" Enable="FALSE" Height="20" Id="MaskEdit5" Left="544" Mask="###,###" NullValue="0" Style="sty_ipt_form" TabOrder="158" Top="349" Value="0" Width="110"></MaskEdit>
		<Static Align="Center" Height="24" Id="Static27" Left="658" Style="sty_lb_form_basic" TabOrder="157" Text="협력사견적단가" Top="347" VAlign="Middle" Width="80"></Static>
		<MaskEdit BindDataset="ds_head" Border="Flat" Column="AMBT_S" Enable="FALSE" Height="20" Id="MaskEdit6" Left="742" Mask="###,###" NullValue="0" Style="sty_ipt_form" TabOrder="159" Top="349" Value="0" Width="104"></MaskEdit>
		<Checkbox BindDataset="ds_head" Column="BDGBN" DisableBKColor="user5" Enable="FALSE" Height="22" Id="chk_BDGBN" Left="346" TabOrder="160" Top="348" Width="75"></Checkbox>
		<Static Align="Center" Height="24" Id="Static28" Left="262" Style="sty_lb_form_basic" TabOrder="161" Text="분담이행방식" Top="347" VAlign="Middle" Width="80"></Static>
		<Static Align="Center" Height="23" Id="Static29" Left="658" Style="sty_lb_form_basic" TabOrder="162" Text="감시반유무&#32;" Top="219" VAlign="Middle" Width="80"></Static>
		<Combo BindDataset="ds_head" Border="Flat" CodeColumn="CODE" Column="CYN" DataColumn="CODE_NAME" Enable="FALSE" Height="20" Id="Combo0" InnerDataset="ds_cyn" Left="740" Style="sty_ipt_form" TabOrder="163" Top="219" Width="110"></Combo>
		<MaskEdit BindDataset="ds_head" Border="Flat" Column="ACMT_S" Enable="FALSE" Height="20" Id="MaskEdit7" Left="148" Mask="###,###" NullValue="0" Style="sty_ipt_form" TabOrder="165" Top="424" Value="0" Width="110"></MaskEdit>
		<Static Align="Center" Height="24" Id="Static32" Left="64" Style="sty_lb_form_basic" TabOrder="164" Text="공기청정기료" Top="422" VAlign="Middle" Width="80"></Static>
	</Form>
	<Script><![CDATA[/*
 ******************************************************************************************
 * 기      능   : 
 * 작  성  자   : 
 * 작성  일자   : 
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
#include "LIB::commons.js";	// 공통 스크립트 
#include "LIB::utility.js";	// 다중 선택 
#include "LIB::common_cs.js";	// 서비스 공통 스크립트
//=========================================================================================
// [ PART 1 ]
// Form에서 사용될 전역변수를 선언
// FORM에서 사용되는 전역변수는 대문자로 작성하며, F_XXX 의 형태를 갖도록 한다. 
//=========================================================================================
var userGroup;
var gRow = null;
var t_costT; //원가
var t_costT2; //원가(투입예상자재)
var t_cos1; //간접비제외 원가
var t_cos2; //간접비제외 원가(투입예상자재)
var t_costA; //직접비
var t_costA_2; //직접비(투입예상자재)
var t_costB; //간접비
var t_costB_2; //간접비(투입예상자재)
var t_costC; //HRTS
var t_costD; //DI-PBX
var t_nmt; //직접노무비
var t_jmt; //직접재료비
var t_jmt2; //직접재료비(투입예상자재)
var t_kmt; //직접경비
var t_hmt; //HRTS비용
var t_dmt; //DI-PBX비용
var t_cmt; //검사수수료
var t_gmt; //간접비
var t_gmt2; //간접비(투입예상자재)
var chk_fst = 0;
var chk_fst2 = 0;
var chk_fst3 = 0;
var chk_fst4 = 0;
var fa_reqno;
var currRow = 0;
var mode;
var lnk;
var flag_hrtsFree ; 

var vBdgbn = 1;	//분담이행방식여부

var vCalRat_auth = false; // 전송버튼
var vCos_auth = false; // 원가내역출력물
//=========================================================================================
// [ PART 2 ]
// Form Loading / Unloading 시 작업 정의
//=========================================================================================
function fn_OnLoadCompleted(obj) {
	gfn_initForm();

    var codeArr = ["WBAP_STAT","CS123","ZTERM","CS_AIR_KND"];
    var dsObjArr = [ds_apstat,ds_tbld,ds_zterm,ds_acnd];
    var addTypeArr = [G_CODE_NONE,G_CODE_NONE,G_CODE_SELECT,G_CODE_NONE];
    gfn_searchCommCode(codeArr, dsObjArr, addTypeArr, true);
    
    // 버튼초기화
	div_btn.btn_decide.Enable 	= false;	// 결재버튼
	div_btn.btn_sendback.Enable = false;  	// 반송버튼

	// if(G_USER_ID == "2021200" || G_USER_ID == "2023687" || G_USER_ID == "2018900" || G_USER_ID == "2029758" || G_USER_ID == "2999999" ){
		// btn_calRat.Visible = true;
	// }
	//+==========================전송버튼 권한  =======================
	gfn_initDs(ds_rcond, true);
	ds_rcond.SetColumn(0, "ZPROGRAM", "CS1240001B");
	ds_rcond.SetColumn(0, "GBN", "01");	
	vCalRat_auth = gfn_getAuth(ds_rcond);
	ds_rcond.ClearData();
	if (vCalRat_auth == true){
		btn_calRat.Visible = true;
	}
	//+==========================원가내역출력물버튼 권한  =======================
	gfn_initDs(ds_rcond, true);
	ds_rcond.SetColumn(0, "ZPROGRAM", "CS1240001B");
	ds_rcond.SetColumn(0, "GBN", "02");	
	vCos_auth = gfn_getAuth(ds_rcond);
	ds_rcond.ClearData();
	//+===========================================================================
	
	
	if(lnk == "INS") { //신규견적 작성시
		div_btn.btn_recost.Enable = false;
		div_btn.btn_delete.Enable = false;
		div_btn.btn_print.Enable = false;
		div_btn.btn_trans.Enable = false;
		div_btn.btn_draft.Enable = false;
		fn_setHno();
	} else if(lnk == "PLN") { //이동계획에서 작성시
		div_btn.btn_recost.Enable = false;
		div_btn.btn_delete.Enable = false;
		div_btn.btn_print.Enable = false;
		div_btn.btn_trans.Enable = false;
		div_btn.btn_draft.Enable = false;
		fn_setPlnHno();
	} else { //기존견적 수정시
		fn_selHno();
	}
	
}

/********************************************************************************
* 기      능   : 공통코드가 조회된 후의 Callback 함수 
********************************************************************************/
function fn_completeInit(sCode, sDsObj, sCodeType) {
	var user_grp = gfn_getUserGroup();

	if(user_grp == "40") {
		btn_saveopn.Visible = true;
	} else {
		btn_saveopn.Visible = false;
	}
	
}

/********************************************************************************
* 기      능   : form UnloadCompleted 
********************************************************************************/
function fn_OnUnloadCompleted(obj) {
	return gfn_isFormUnload(obj);
}


function fn_btnInit() {
	userGroup = gfn_getUserGroup();

	if(ds_head.GetColumn(0, "PST") == "A1") {
		div_btn.btn_save.Enable = true;
		div_btn.btn_delete.Enable = true;
		div_btn.btn_trans.Enable = true;
		div_btn.btn_recost.Enable = false;
		div_btn.btn_print.Enable = false;
		div_btn.btn_draft.Enable = false;

		cal_cdt.Enable = true;
		ed_nam.Enable = true;
		ed_spt.Enable = true;
		ed_pjt.Enable = true;
		ed_adr.Enable = true;
		ed_spc.Enable = true;
		cb_prd.Enable = true;

		grd_list2.Editable = true;
	} else if((ds_head.GetColumn(0, "PST") == "A2" || ds_head.GetColumn(0, "PST") == "A6")) {
		div_btn.btn_save.Enable = false;		
		div_btn.btn_draft.Enable = false;
		// 삭제 기능 불가처리 201606
		//div_btn.btn_delete.Enable = true;
		div_btn.btn_delete.Enable = false;		 
		div_btn.btn_trans.Enable = false;
		if(isExistVar("fa_popgbn", true))
			div_btn.btn_recost.Enable = false;
		else
			div_btn.btn_recost.Enable = true;

		cal_cdt.Enable = true;
		ed_nam.Enable = true;
		ed_spt.Enable = true;
		ed_pjt.Enable = true;
		ed_adr.Enable = true;
		ed_spc.Enable = true;
		cb_prd.Enable = true;

		grd_list2.Editable = true;
	} else if(ds_head.GetColumn(0, "PST") > "A2" && ds_head.GetColumn(0, "PST") < "A3") {
		div_btn.btn_save.Enable = false;	
		div_btn.btn_draft.Enable = false;	
		div_btn.btn_draft.Enable = false;
		// 삭제 기능 불가처리 201606
		//div_btn.btn_delete.Enable = true;
		div_btn.btn_delete.Enable = false;	
		div_btn.btn_trans.Enable = false;
		div_btn.btn_recost.Enable = false;

		cal_cdt.Enable = false;
		ed_nam.Enable = false;
		ed_spt.Enable = false;
		ed_pjt.Enable = false;
		ed_adr.Enable = false;
		ed_spc.Enable = false;
		cb_prd.Enable = false;

		grd_list2.Editable = false;
	} else if(ds_head.GetColumn(0, "PST") == "A3") {
		div_btn.btn_save.Enable = false;
		div_btn.btn_trans.Enable = false;
		
		if(ds_head.GetColumn(0,"APSTAT") == '' || ds_head.GetColumn(0,"APSTAT") == '2' || ds_head.GetColumn(0,"APSTAT") == '4') //결재전, 내부반송, 수신반송 상태 
			div_btn.btn_recost.Enable = true; 
		else
			div_btn.btn_recost.Enable = false;
			
		grd_list2.Editable = true;
		
		if(length(trim(fa_reqno)) > 0) {
			div_btn.btn_recost.enable = false;
			div_btn.btn_delete.enable = false;
			div_btn.btn_save.enable = false;
			div_btn.btn_trans.enable = false;
			
			if(ds_head.GetColumn(0, "APSTAT") == ""){ 
				div_btn.btn_draft.Enable = true;
			}else if(ds_head.GetColumn(0, "APSTAT") == "3") {
				if(trim(fa_popgbn) == "B") { //부서수신함
					div_btn.btn_draft.Enable = true;
				} else { //결재문서함
					div_btn.btn_draft.Enable = false;
				}
			} else {
				div_btn.btn_draft.Enable = false;
			}
			
			btn_matnr.Visible = false;
			btn_addmat.Visible = false;
		}
	} 
	// 원가내역 출력물  >> 개발 예정
	// 최인식 전현정 이하림 용아름
	//if(G_USER_ID == "2017938" || G_USER_ID == "2021056" || G_USER_ID == "2021200" || 
	//   G_USER_ID == "2023687" || G_USER_ID == "2018900" || G_USER_ID == "2029758" || G_USER_ID == "2999999") {
	if (vCos_auth == true  || userGroup >= "20") {                // 공통권한에 있던지 또는 "20" 권한 이상일시 (2021.01.14 이준석 책임 요청)
		div_btn.btn_cos.Visible = true;
		//div_btn.btn_print.Enable = true;
		div_btn.btn_print.Enable = false;
	} else{
		div_btn.btn_cos.Visible = false;
		div_btn.btn_print.Enable = false;
	}
	
	if( (ds_head.GetColumn(0,"APSTAT") > '0' && ds_head.GetColumn(0,"APSTAT") != '3' && ds_head.GetColumn(0,"APSTAT") < '6') && ds_decide.rowcount > 0 && G_USER_ID == substr(ds_decide.GetColumn(0, "APNUM"),1) ) {
		div_btn.btn_decide.Enable   = true;		// 결재버튼
		div_btn.btn_sendback.Enable = true;		// 반송버튼
	} else {
		div_btn.btn_decide.Enable = false;		// 결재버튼
		div_btn.btn_sendback.Enable = false;	// 반송버튼
	}
	// 반송 건, 버튼 비활성
	if( ds_head.GetColumn(0,"APSTAT") == '2' or ds_head.GetColumn(0,"APSTAT") == '5'  ) {
		div_btn.btn_decide.Enable   = false;	// 결재버튼
		div_btn.btn_sendback.Enable = false;	// 반송버튼
	} 
	ratModifyFlag = false; // 시행률만 저장 처리 
	fn_calcAmt();
}

/********************************************************************************
* 기      능   : 조회 
********************************************************************************/
function fn_queryIns() {
	tit_clearActionInfo();
	tit_addSearchActionInfo("cs12:CS1240001B_S1");
	tit_addSearchActionInfo("cs12:CS1240001B_S2");
	
	tit_callService(
        ""
        , ""
        , "ds_cond=ds_cond2"
        , "ds_head=ds_head ds_list2=ds_list2"
        , ""
        , "fn_afterQueryIns"
        , true
        , true);
}

function fn_queryUpd() {
	tit_clearActionInfo();
	
	if(fa_reqno == null || length(trim(fa_reqno)) == 0) {
		tit_addSearchActionInfo("cs12:CS1240001B_S3");
		tit_addSearchActionInfo("cs12:CS1240001B_S4");
		tit_addSearchActionInfo("cs12:CS1240001B_S12");
		tit_addSearchActionInfo("cs12:CS1240001B_S19");
		
		tit_callService(
				""
				, ""
				, "ds_cond=ds_cond2"
				, "ds_head=ds_head ds_list2=ds_list2 ds_his=ds_his ds_detail_pri=ds_detail_pri"
				, ""
				, "fn_afterQueryUpd"
				, true
				, true);
        
	} else {
		tit_addSearchActionInfo("cs12:CS1240001B_S8");
		tit_addSearchActionInfo("cs12:CS1240001B_S9");
		tit_addSearchActionInfo("cs12:CS1240001B_S13");
		tit_addSearchActionInfo("cs12:CS1240001B_S19");
		
		
		tit_addSearchActionInfo("wb01:APP_STATUS");
		
		tit_callService(
				""
				, ""
				, "ds_cond=ds_cond2"
				, "ds_head=ds_head ds_list2=ds_list2 ds_his=ds_his ds_detail_pri=ds_detail_pri ds_decide=ds_decide"
				, ""
				, "fn_afterQueryUpd"
				, true
				, true);
	}	
}

/********************************************************************************
* 기      능   : 조회 Callback  
********************************************************************************/
function fn_afterQueryIns(errCode, errMsg) {
	gfn_showMsg("CI00002",ds_list2.RowCount()+"");
	
	if(ds_head.GetColumn(0, "PST") == "A3") {
		div_btn.btn_recost.enable = true;
	}
	
	// 유지관리업체 협력사인 경우 무상서비스 체크 불가 
	if(ds_list2.GetColumn(0, "BSUGB") == "3" || cb_prd.value == "A") {		//협력업체이거나, 점검주기가 매월점검인 경우 HRTS 무상 CHECK  불가
		grd_list2.SetCellProp("body",grd_list2.GetBindCellIndex("BODY","HFR"),"Edit","none");
	}
}

function fn_afterQueryUpd(errCode, errMsg) {
	gfn_showMsg("CI00002",ds_list2.RowCount()+"");

	chk_fst = 0;
	chk_fst2 = 0;
	chk_fst3 = 0;
	chk_fst4 = 0;
	
	var lknd  = ds_his.GetColumn(0,"LKND");
	var las  = toNumber(ds_his.GetColumn(0,"LAS"));
	if(las > 0) {
		ed_knddif.Text = lknd + " to " + ds_cpd.GetColumn(ds_cpd.FindRow("CODE",cb_cpd.Value),"CODE_NAME");
	}
	//trace(ds_head.SaveXML());
    //trace(ds_list2.SaveXML());
    //trace(ds_his.SaveXML());
    //trace(ds_detail_pri.SaveXML());

	if(ds_head.GetColumn(0, "MATOT") > 0 && ds_head.GetColumn(0, "AMG") == "Y") { // 투입예상자재
		btn_matnr.Visible = false;
		btn_addmat.Visible = true;
	} else if (ds_head.GetColumn(0, "MATOT") > 0 && ds_head.GetColumn(0, "AMG") == "N") {	// 추가자재
		btn_matnr.Visible = true;
		btn_addmat.Visible = false;
	}
	vBdgbn = ds_head.GetColumn(0, "BDGBN");		// 분담이행방식 
	// 무상서비스 체크 불가 
	if(ds_list2.GetColumn(0, "BSUGB") == "3" || cb_prd.value == "A") {
		grd_list2.SetCellProp("body",grd_list2.GetBindCellIndex("BODY","HFR"),"Edit","none");
	}
	
	// HRTS 무상제공 문구 DISPLAY 
	ed_hrtsFreeText.Visible = false ;
	flag_hrtsFree = false;
	for(var i=0; i<ds_list2.rowcount; i++) {
		if(ds_list2.GetColumn(i, "HFR") == "1") {
			ed_hrtsFreeText.Visible = true ;
			flag_hrtsFree = true ;
		}
	}
	
	fn_setCof(); // 전결규정 셋팅 
	fn_btnInit();
}

/********************************************************************************
* 기      능   : 전결규정
********************************************************************************/
function fn_setCof(){
// ed_cof - 기준단가 달성율
// ed_cof2 - 할인율
// ed_cof3 - 종전단가 달성율
// 높은 전결규정으로 표시 20170309 

	if(ds_head.RowCount() > 0) {
		if(cb_cpd.Value == "B" and cb_cnd.Value == "B") { // pog 갱신의 경우 전결규정 변경
			ed_cof.Text = ed_cof3.Text ;
		}
		if(med_sangjuAmt.value > 0 ) {
			ed_cof.Text = "본부장" ;
		}
	}
	/*
	// 2020.07.31 전결규정 변경전
	var rank_cof, rank_cof2; //  달성율 , 할인율 
	if(ed_cof.Text=="부문장")      rank_cof = 1;
	else if(ed_cof.Text=="담당")   rank_cof = 2;
	else if(ed_cof.Text=="팀장")   rank_cof = 3;
	else if(ed_cof.Text=="지사장") rank_cof = 4;
	
	if(ed_cof2.Text=="부문장")      rank_cof2 = 1;
	else if(ed_cof2.Text=="담당")   rank_cof2 = 2;
	else if(ed_cof2.Text=="팀장")   rank_cof2 = 3;
	else if(ed_cof2.Text=="지사장") rank_cof2 = 4;
	*/
	/*=============================================================================*/
	// 2020.07.31 전결규정 변경후
	var rank_cof, rank_cof2; //  달성율 , 할인율 
	if(ed_cof.Text=="본부장" || ed_cof.Text=="본부장(월보고)") rank_cof = 1;
	else if(ed_cof.Text=="담당")                               rank_cof = 2;
	else if(ed_cof.Text=="지사장(팀장)")                       rank_cof = 3;
	
	if(ed_cof2.Text=="본부장")      rank_cof2 = 1;
	else if(ed_cof2.Text=="담당")   rank_cof2 = 2;
	else if(ed_cof2.Text=="지사장(팀장)")   rank_cof2 = 3;
	/*=============================================================================*/
	
	if(rank_cof <= rank_cof2) {
		ed_cof_final.Text = ed_cof.Text;
		ed_cof_final_tx.Text = "기준단가 달성율 기준";
		if(cb_cpd.Value == "B" and cb_cnd.value == "B") { // pog 갱신
			ed_cof_final_tx.Text = "종전단가 달성율 기준";
		}
	} else {
		ed_cof_final.Text = ed_cof2.Text;
		ed_cof_final_tx.Text = "할인율 기준";
	}
	
	// cfo 전결 규정 대상 체크
	// 보수료 + hrts + dipbx + 상주 1천만원 초과 및 달성율 85 이하 
	var monthly_amt = 0 ;
	if(ds_head.GetColumn(0,"CPD") == "A") {		//FM계약
		monthly_amt = ds_list2.Sum("FMT") + ds_list2.Sum("FMBT");
	} else {									//POG계약
		monthly_amt = ds_list2.Sum("PMT") + ds_list2.Sum("PMBT");
	}
	var monthly_hmt = ds_list2.Sum("HMT") ;
	var monthly_dmt = ds_list2.Sum("DMT") ;
	//===========================공기청정기 추가 20200515 Han.JH==================================
	var monthly_acmt = ds_list2.Sum("ACMT") ;
	//============================================================================================
	var monthly_smt = toNumber(med_sangjuAmt.Text) ;
	var trt = toNumber(med_trat.Text);
	var total_monthly = monthly_amt+monthly_hmt+monthly_dmt+monthly_acmt+monthly_smt ;
	// trace("보수료  : " +monthly_amt);
	// trace("hrts  : " +monthly_hmt);
	// trace("dipbx  : " +monthly_dmt);
	// trace("상주  : " +monthly_smt);
	// trace("trt  : " +trt);
	// trace(monthly_amt+monthly_hmt+monthly_dmt+monthly_smt);
	
	if (total_monthly > 10000000 && trt <= 85) {
		// "(비고) 1천만원 초과 & 표준판가 기준 15% 이상 인하시, CFO 확인(월 계약금액 기준)" ;
		//ed_cof_cfo.Text = "COF 확인" ;
		ed_cof_cfo.Text = "재경본부장 확인";								// 2020.02.11 최선경씨 변경요청
		// ed_cof_final.Text =  "CFO 확인" ;
		// ed_cof_final_tx.Text = "1천만원 초과 & 표준판가 15% 이상 인하";	
	}


	//==================전결규정 관련 추가(기안시 저장된 전결규정이 있으면)==================
	if( length(trim(ds_head.GetColumn(0,"DISCRULE"))) > 0 ) 
	{
		ed_cof_final.Text = ds_head.GetColumn(0,"DISCRULE");
	}
    //=======================================================================================
}
/********************************************************************************
* 기      능   : 저장
********************************************************************************/
function fn_save() {
	if(length(ds_head.GetColumn(0, "APSTAT")) > 0) {
		gfn_showAlert("결재상신후 수정은 불가능합니다.");
		return false;
	}
	if(length(trim(ds_head.GetColumn(0, "ETN"))) == 0 && ds_head.GetColumn(0, "PST") >= "A1") {
		gfn_showAlert("진행상태를 확인하십시요.");
		return false;
	}
	if(length(trim(ds_head.GetColumn(0, "ETN"))) > 0 && (length(trim(ds_head.GetColumn(0, "PST"))) == 0 || ds_head.GetColumn(0, "PST") > "A2")) {
		gfn_showAlert("진행상태를 확인하십시요.");
		return false;
	}
	
	if(ds_head.GetColumn(0, "CDT") == "") {
		gfn_showAlert("계약예정일을 확인하십시요.");
		return false;
	}
	
	if(ds_head.GetColumn(0, "STD") == "") {
		gfn_showAlert("계약시작일을 확인하십시요.");
		return false;
	}
	
	if(ds_head.GetColumn(0, "ETD") == "") {
		gfn_showAlert("계약종료일을 확인하십시요.");
		return false;
	}
	
	if(parseInt(ds_head.GetColumn(0, "STD")) < parseInt(ds_head.GetColumn(0, "CDT"))){
		gfn_showAlert("계약기간을 확인하십시오.");
		return false;
	}
	
	if(parseInt(ds_head.GetColumn(0, "ETD")) <= parseInt(ds_head.GetColumn(0, "STD"))){
		gfn_showAlert("계약기간을 확인하십시오.");
		return false;
	}
	
	if(ds_head.GetColumn(0, "CDT") == "") {
		gfn_showAlert("계약예정일을 확인하십시요.");
		return false;
	}
	if(ds_head.GetColumn(0, "CPD") == "") {
		gfn_showAlert("계약상품을 확인하십시요.");
		return false;
	}
	if(ds_head.GetColumn(0, "NAM") == "") {
		gfn_showAlert("고객명을 확인하십시요.");
		return false;
	}
	// 2020.01.06 Dictionary 초과로 인한 예외조건 추가. Han JH
	if(Lengthb(Trim(ds_head.GetColumn(0, "NAM"))) > 150) {
		gfn_showAlert("고객명의 입력내용이 너무 깁니다.\n150 bytes 이하로 입력하십시요.");
		return false;
	}	
	if(ds_head.GetColumn(0, "SPT") == "") {
		gfn_showAlert("현장명을 확인하십시요.");
		return false;
	}
	if(ds_head.GetColumn(0, "CND") == "") {
		gfn_showAlert("계약유형을 확인하십시요.");
		return false;
	}
	if(ds_head.GetColumn(0, "ADR") == "") {
		gfn_showAlert("현장주소를 확인하십시요.");
		return false;
	}
	if(ds_head.GetColumn(0, "GBU") == "") {
		gfn_showAlert("직영구분을 확인하십시요.");
		return false;
	}
	if(ds_head.GetColumn(0, "CNT") == "") {
		gfn_showAlert("대수를 확인하십시요.");
		return false;
	}
	if(ds_head.GetColumn(0, "FLR") == "") {
		gfn_showAlert("층수를 확인하십시요.");
		return false;
	}
	if(ds_head.GetColumn(0, "SPD") == "") {
		gfn_showAlert("속도를 확인하십시요.");
		return false;
	}
	if(ds_head.GetColumn(0, "YGB") == "") {
		gfn_showAlert("영업주체를 확인하십시요.");
		return false;
	}
	if(ds_head.GetColumn(0, "CYN") == "") {
		gfn_showAlert("CRT유무를 확인하십시요.");
		return false;
	}
	if(ds_head.GetColumn(0, "PRD") == "") {
		gfn_showAlert("점검주기를 확인하십시요.");
		return false;
	}
	if(ds_head.GetColumn(0, "BLD") == "") {
		gfn_showAlert("건물용도를 확인하십시요.");
		return false;
	}
	if(ds_head.GetColumn(0, "SRG") == "") {
		gfn_showAlert("Sheave/Rope를 확인하십시요.");
		return false;
	}
	if(ds_head.GetColumn(0, "PDT") == "") {
		gfn_showAlert("제품군을 확인하십시요.");
		return false;
	}
	if(ds_head.GetColumn(0, "SYR") == "") {
		gfn_showAlert("설치연령을 확인하십시요.");
		return false;
	}
	if(ds_head.GetColumn(0, "ZMAN") == "") {			
		gfn_showAlert("영업담당자를 확인하십시요.");
		return false;
	}
	if(ds_head.GetColumn(0, "RMK") == "") {
		gfn_showAlert("특이사항을 확인하십시요.");
		return false;
	}
	// 2020.10.07 10년 이상 견적기간 저장되지 않도록 제약조건 추가. Han J.H
	if(gfn_getMonthCnt(ds_head.GetColumn(0, "STD"), ds_head.GetColumn(0, "ETD")) > 240) {
		gfn_showAlert("견적기간의 경우 20년 이하의 견적기간만 저장 가능합니다.");
		cal_to.SetFocus();
		return false;
	}
	
	var chkAcyn = false; // 저장 및 재견적 시 공기청정기 유무를 저장하기 위해 사용되는 변수 2020.05.15 Han JH		
	
	for(var i=0; i<ds_list2.rowcount; i++) {
		// E/S 경우, HRTS 입력 불가, 매월점검만 입력 가능 2017.11
		// E/S 경우, 공기청정기 입력 불가 20200515 Han J.H
		if(substr(ds_list2.GetColumn(i, "HNO"),0,1) == "S" || substr(ds_list2.GetColumn(i, "HNO"),0,1) == "W"){
			if(ds_list2.GetColumn(i, "HMT") > 0 || ds_list2.GetColumn(i, "HWR") >0 ) {
				gfn_showAlert("E/S호기는 HRTS 입력이 불가합니다.\n호기 재확인 바랍니다.");
				return;
			}
			if(ds_head.GetColumn(0, "PRD") <> "A") {
				gfn_showAlert("E/S호기는 격월/분기 점검 입력이 불가합니다.\n호기 재확인 바랍니다.");
				return;
			}
			//===========================공기청정기 추가 20200515 Han.JH==================================
			if(ds_list2.GetColumn(i, "ACMT") > 0 || ds_list2.GetColumn(i, "ACYN") >0 ) {
				gfn_showAlert("E/S호기는 공기청정기 입력이 불가합니다.\n호기 재확인 바랍니다.");
				return;
			}
			//============================================================================================
		}
	
		if(ds_head.GetColumn(0, "CPD") == "A" && (ds_list2.GetColumn(0, "FMT") == 0 || length(trim(ds_list2.GetColumn(0, "FMT"))) == "" )) {
			gfn_showAlert("FM보수료는 필수입력 사항입니다.");
			return false;
		}

		if(ds_head.GetColumn(0, "CPD") == "B" && (ds_list2.GetColumn(0, "PMT") == 0 || length(trim(ds_list2.GetColumn(0, "PMT"))) == "")) {
			gfn_showAlert("POG보수료는 필수입력 사항입니다.");
			return false;
		}
		
		// 무상서비스 아닌 경우만 금액 체크 
		if(trim(ds_list2.GetColumn(i, "HFR")) == "0") {
			if(length(trim(ds_list2.GetColumn(i, "HWR"))) > 0 && ds_list2.GetColumn(i, "HMT") == 0) {
				gfn_showAlert("HRTS료는 필수입력 사항입니다.");
				return false;
			}
		} 
		// 무상서비스인 경우
		if(trim(ds_list2.GetColumn(i, "HFR")) == "1") {
			// 유무선 체크 
			if(length(trim(ds_list2.GetColumn(i, "HWR"))) == 0 ) {
				gfn_showAlert("HRTS 유무선은 필수입력 사항입니다.");
				return false;
			}
		} 

		if(length(trim(ds_list2.GetColumn(i, "DND"))) > 0 && ds_list2.GetColumn(i, "DMT") == 0) {
			gfn_showAlert("DI-PBX료는 필수입력 사항입니다.");
			return false;
		}

		ds_list2.SetColumn(i, "ETN", ds_head.GetColumn(0, "ETN"));
		ds_list2.SetColumn(i, "SIR", ds_head.GetColumn(0, "SIR"));

		if(parseInt(ds_list2.GetColumn(i, "FMT")) == 0 || length(trim(ds_list2.GetColumn(i, "FMT"))) == 0) {
			ds_list2.SetColumn(i, "FMT", 0);
			ds_list2.SetColumn(i, "FMG", "N");
		} else {
			ds_list2.SetColumn(i, "FMG", "Y");
		}

		if(parseInt(ds_list2.GetColumn(i, "PMT")) == 0 || length(trim(ds_list2.GetColumn(i, "PMT"))) == 0) {
			ds_list2.SetColumn(i, "PMT", 0);
			ds_list2.SetColumn(i, "POG", "N");
		} else {
			ds_list2.SetColumn(i, "POG", "Y");
		}

		// 가끔 분담이행으로 협력사금액(FMBT or PMBT)가 입력되었으나, 분담이행 CHECK가 안된 정보를 위해서 추가함
		if(toNumber(ds_list2.GetColumn(i, "PMBT")) + toNumber(ds_list2.GetColumn(i, "FMBT")) > 0){
			
			/*==========================기존로직=========================================
			if (ds_head.GetColumn(0, "YGB") == "B" || ds_head.GetColumn(0, "YGB") == "C"){
			============================================================================*/
			if ( ds_list2.GetColumn(0, "BSUGB") == '3') {
			
			
				if (i == 0){
					if (ds_head.GetColumn(0, "BDGBN") != "1"){
						ds_head.fireEvent = false;
						ds_head.SetColumn(0, "BDGBN", "1");
						ds_head.fireEvent = true;
					}
				}
				if (ds_list2.GetColumn(i, "BDGBN") != "1"){
					ds_list2.fireEvent = false;
					ds_list2.SetColumn(i, "BDGBN", "1");
					ds_list2.fireEvent = true;
				}
			}
		}
		
		if(parseInt(ds_list2.GetColumn(i, "HMT")) == 0 || length(trim(ds_list2.GetColumn(i, "HMT"))) == 0) {
			ds_list2.SetColumn(i, "HMT", 0);
			ds_list2.SetColumn(i, "HGB", "N");
			if(length(ds_list2.GetColumn(i, "HWR")) != 0 && ds_list2.GetColumn(i, "HFR") == "1"){ // 회선종류
				ds_list2.SetColumn(i, "HGB", "Y");
			}
		} else {
			if(length(ds_list2.GetColumn(i, "HWR")) == 0 ){ // 회선종류
				var arr = [parseInt(i) + 1, st_hwr.value];
				gfn_showMsg("CW00055", arr);
				return;
			} else {
				ds_list2.SetColumn(i, "HGB", "Y");
			}
		}

		if(parseInt(ds_list2.GetColumn(i, "DMT")) == 0 || length(trim(ds_list2.GetColumn(i, "DMT"))) == 0) {
			ds_list2.SetColumn(i, "DMT", 0);
			ds_list2.SetColumn(i, "DGB", "N");
		} else {
			if(length(ds_list2.GetColumn(i, "DND")) == 0 ){ // DI-PBX종류
				var arr = [parseInt(i) + 1, st_dnd.value];
				gfn_showMsg("CW00055", arr);
				return;
			} else {
				ds_list2.SetColumn(i, "DGB", "Y");
			}
		}
		
		//===========================공기청정기 추가 20200515 Han.JH==================================
		if(parseInt(ds_list2.GetColumn(i, "ACMT")) == 0) {
			//ds_head.SetColumn(0, "ACYN", "N");
			if(!chkAcyn){ // 공기청정기 여부가 True 아니면 N으로 셋팅
				ds_head.SetColumn(0, "ACYN", "N");
			}			
		} else {
			//ds_head.SetColumn(0, "ACYN", "Y");
			if(!chkAcyn) { // 공기청정기 여부가 False 이면 Y로 셋팅
				ds_head.SetColumn(0, "ACYN", "Y");
				chkAcyn = true;
			}			
		}	
		//============================================================================================	

		if(length(trim(ds_list2.GetColumn(i, "HWR"))) > 0) {
			ds_head.SetColumn(0, "HYN", "Y");
		} else {
			ds_head.SetColumn(0, "HYN", "N");
		}

		if(length(trim(ds_list2.GetColumn(i, "DND"))) > 0) {
			ds_head.SetColumn(0, "DYN", "Y");
		} else {
			ds_head.SetColumn(0, "DYN", "N");
		}
	}

	//=======================이준석 과장 요청으로 프로모션 확대적용 해지 20200717 ================================
	/*
	// 무상서비스인 경우	
	if(flag_hrtsFree) {
		//  표준(기준)보수료 대비 금액 체크 80%   2018 . 01  Promotion 확대 적용 
		if(!fn_checkAmtOfHrtsFree()) {
			return false;
		}
	}		
	*/
	//============================================================================================================
		
		
	var str_dat = 0.0;
	str_dat = round((parseInt(ds_head.GetColumn(0, "MMN")) / gfn_getMonthCnt(ds_head.GetColumn(0, "STD"), ds_head.GetColumn(0, "ETD"))) * 100,1);

	ds_head.SetColumn(0, "DAT", str_dat);

	if(ds_detail_pri.rowcount <= 0) {
		fn_make_period();
	} else {
	//  문제 없는 경우 삭제 할것   201801 
		// var tot=0;
		// var tot2=0;
		// var _amt;
		// var _hmt;
		// var _isHmt;
		// var _dmt;
		// var _isDmt;
		// /* 호기별 금액 합과 연차별 금액 합의 비교 로직 수정  20150330 이하림
		   // 그리드 셀 row 인덱스 변수로 변경 , 호기별 합산
		// */		
		// if(cb_cpd.Value != "") {
			// for(var i=0 ; i < ds_list2.rowcount; i++){
			
				// if(cb_cpd.Value == 'A') { // FM
					// _amt =grd_list2.GetCellValue(i,14); 
				// }else if (cb_cpd.Value == 'B') { // POG
					// _amt =grd_list2.GetCellValue(i,17);
				// }
				
				// _hmt = grd_list2.GetCellValue(i,21);
				// _dmt = grd_list2.GetCellValue(i,23); 
				// _isHmt = grd_list2.GetCellValue(i,21); 
				// _isDmt = grd_list2.GetCellValue(i,23); 
				
				// if(_amt != "") tot += parseInt(_amt);
				// if(_isHmt != "" && _hmt != "") tot += parseInt(_hmt);
				// if(_isDmt != "" && _dmt != "") tot += parseInt(_dmt);
			// }
			
			// tot = tot * gfn_getMonthCnt(cal_from.Value,cal_to.Value);
		// }

		// for(var i=0; i < ds_detail_pri.rowcount; i++){
			// tot2 += parseInt(ds_detail_pri.GetColumn(i,"TOT")) * parseInt(ds_detail_pri.GetColumn(i,"MON"));
		// }


		// if(tot == 0 || tot2 == 0 || tot != tot2){
			// alert('계약기간 별 금액을 확인하십시요.');
			// return;
		// }
	}
	if(ds_head.GetColumn(0, "PNT") = "") ds_head.SetColumn(0, "PNT", "0");
	if(ds_head.GetColumn(0, "SAJ") = "") ds_head.SetColumn(0, "SAJ", "0");
	if(ds_head.GetColumn(0, "GIS") = "") ds_head.SetColumn(0, "GIS", "90.0");
	
	if(length(trim(ds_head.GetColumn(0, "ETN"))) == 0) {
		ds_docno_gen.ClearData();													//결재번호생성 데이터셋을 클리어한다
		ds_docno_gen.AddRow();																
		ds_docno_gen.SetColumn(0,"PFX","H01");										//Prefix
		
		tit_clearActionInfo();					
		tit_addSearchActionInfo("wb01:DOC_CODE_GEN_S1",true);					
		tit_addSearchActionInfo("wb01:DOC_CODE_GEN_U1");					
		tit_callService(															//동기화 방식으로 서비스를 콜한다.	
			, ""				
			, "ds_docno_gen_i=ds_docno_gen"				
			, "ds_docno_gen=ds_docno_gen_o"				
			, ""				
			, ""				
			, true
			, false
			, true);		
		
		var newDocNo = ds_docno_gen.GetColumn(0, "DOCNO");
		if(length(newDocNo) <= 1)
		{
			gfn_showMsg("CW10025", "결재문서번호 생성에 실패했습니다. 잠시 후 다시 시도해주세요.");
			return;
		}			
	
		ds_head.SetColumn(0,"DOC",newDocNo);
		tit_clearActionInfo();
//		tit_addSingleActionInfo("cs12:CS1240001B_U4");
		tit_addSingleActionInfo("cs12:CS1240001B_I1");		//ZCST301
		tit_addMultiActionInfo("cs12:CS1240001B_I2");		//ZCST302
		tit_addMultiActionInfo("cs12:CS1240001B_I6");		//ZCST624 (정기보수 견적 계약기간 정보)
		tit_addSearchActionInfo("cs12:CS1240001B_S22");
		
		tit_callService(
			""
			, ""
			, "ds_head=ds_head ds_list2=ds_list2 ds_detail_pri=ds_detail_pri"
			, "ds_etn=ds_etn"
			, ""
			, "fn_afterSave"
			, true
			, false
			, true);
	} else {
		tit_clearActionInfo();
		tit_addSingleActionInfo("cs12:CS1240001B_U2");
		tit_addMultiActionInfo("cs12:CS1240001B_U3");
		tit_addMultiActionInfo("cs12:CS1240001B_D1");
		tit_addMultiActionInfo("cs12:CS1240001B_I8");
//		tit_addSingleActionInfo("cs12:CS1240001B_I5"); 
		
		tit_callService(
			""
			, ""
			, "ds_head=ds_head ds_list2=ds_list2 ds_detail_pri=ds_detail_pri"
			, ""
			, ""
			, "fn_afterSave"
			, true
			, false
			, true);
	}
}
/********************************************************************************
* 기      능   : hrts 무상 Promotion 표준보수료 대비 견적가 80 % 이상 체크 
* pog의 경우만 금액 체크 
********************************************************************************/
function fn_checkAmtOfHrtsFree(){
	// 기준단가 , 견적가 , 제한 
	var stdAmt , inpAmt , limitA, hrts_b ; 
	
	if(ds_head.GetColumn(0, "CPD") == "A") {
		stdAmt = parseInt(ds_list2.Sum("F10"));
		inpAmt = parseInt(ds_list2.Sum("FMT")) + parseInt(ds_list2.Sum("FMBT"));
	} else {
		stdAmt = parseInt(ds_list2.Sum("P10"));
		inpAmt = parseInt(ds_list2.Sum("PMT")) + parseInt(ds_list2.Sum("PMBT"));
	}
	hrts_b = ds_list2.Sum("CNT_HRTS");
	limitA = stdAmt * 0.8 ;

    //========================================기존소스=================================================
    /*
	if((inpAmt < limitA && ds_head.GetColumn(0, "CPD") == "B" ) && hrts_b == 0) {
		gfn_showAlert("HRTS Promotion은 견적단가가 기준단가 대비 80% 이상인 경우에만 적용 가능합니다.");
		return false;
	} else {
		return true;
	}
	*/
	//=================================================================================================
	

	//========================================변경소스=================================================
	//=======================직영 and (격월 or 분기) 점거시 체크 제외==================================
/*
	if( ds_list2.GetColumn(0, "BSUGB") == '1'  && (cb_prd.Value == 'B' || cb_prd.Value == 'C') ) {
		return true;
	} else {
		gfn_showAlert("HRTS Promotion은 직영현장의 격월or분기 점검인 경우에만 적용 가능합니다.");
		return false;
	}	
*/	
	//=================================================================================================
	
	
}
/********************************************************************************
* 기      능   : 삭제
********************************************************************************/
function fn_delete() {
	if(length(ds_head.GetColumn(0, "APSTAT")) > 0) {
		gfn_showAlert("결재상신후 삭제는 불가능합니다.");
		return false;
	}

	if(G_USER_ID = "2020882") {	// 이동진 - 이천보수창고

	} else {
		if(ds_head.GetColumn(0, "PST") > "A1") {
			gfn_showAlert("작성상태에서만 삭제가 가능합니다.");
			return false;
		}		
	}

	tit_clearActionInfo();
	tit_addSingleActionInfo("cs12:CS1240001B_U1");
	tit_addSingleActionInfo("cs12:CS1240001B_U7"); //재견적 이후 작성데이터 삭제시 이전승인데이터 복구
	tit_callService(
		""
		, ""
		, "ds_head=ds_head"
		, ""
		, ""
		, "fn_afterDelete"
		, true);
}

/********************************************************************************
* 기      능   : 재견적
********************************************************************************/
function fn_recost() {
	if(ds_head.GetColumn(0, "PST") != "A2" && ds_head.GetColumn(0, "PST") != "A6") {
		gfn_showAlert("재견적이 가능한 상태가 아닙니다.");
		return false;
	}
	if(ds_head.GetColumn(0, "STD") == "") {
		gfn_showAlert("계약시작일을 확인하십시요.");
		return false;
	}
	
	if(ds_head.GetColumn(0, "ETD") == "") {
		gfn_showAlert("계약종료일을 확인하십시요.");
		return false;
	}
	
	if(parseInt(ds_head.GetColumn(0, "ETD")) <= parseInt(ds_head.GetColumn(0, "STD"))){
		gfn_showAlert("계약기간을 확인하십시오.");
		return false;
	}
	if(ds_head.GetColumn(0, "CDT") == "") {
		gfn_showAlert("계약예정일을 확인하십시요.");
		return false;
	}
	if(ds_head.GetColumn(0, "CPD") == "") {
		gfn_showAlert("계약상품을 확인하십시요.");
		return false;
	}
	if(ds_head.GetColumn(0, "NAM") == "") {
		gfn_showAlert("고객명을 확인하십시요.");
		return false;
	}
	if(ds_head.GetColumn(0, "SPT") == "") {
		gfn_showAlert("현장명을 확인하십시요.");
		return false;
	}
	if(ds_head.GetColumn(0, "CND") == "") {
		gfn_showAlert("계약유형을 확인하십시요.");
		return false;
	}
	if(ds_head.GetColumn(0, "ADR") == "") {
		gfn_showAlert("현장주소를 확인하십시요.");
		return false;
	}
	if(ds_head.GetColumn(0, "GBU") == "") {
		gfn_showAlert("직영구분을 확인하십시요.");
		return false;
	}
	if(ds_head.GetColumn(0, "CNT") == "") {
		gfn_showAlert("대수를 확인하십시요.");
		return false;
	}
	if(ds_head.GetColumn(0, "FLR") == "") {
		gfn_showAlert("층수를 확인하십시요.");
		return false;
	}
	if(ds_head.GetColumn(0, "SPD") == "") {
		gfn_showAlert("속도를 확인하십시요.");
		return false;
	}
	if(ds_head.GetColumn(0, "YGB") == "") {
		gfn_showAlert("영업주체를 확인하십시요.");
		return false;
	}
	if(ds_head.GetColumn(0, "CYN") == "") {
		gfn_showAlert("CRT유무를 확인하십시요.");
		return false;
	}
	if(ds_head.GetColumn(0, "PRD") == "") {
		gfn_showAlert("점검주기를 확인하십시요.");
		return false;
	}
	if(ds_head.GetColumn(0, "BLD") == "") {
		gfn_showAlert("건물용도를 확인하십시요.");
		return false;
	}
	if(ds_head.GetColumn(0, "SRG") == "") {
		gfn_showAlert("Sheave/Rope를 확인하십시요.");
		return false;
	}
	if(ds_head.GetColumn(0, "PDT") == "") {
		gfn_showAlert("제품군을 확인하십시요.");
		return false;
	}
	if(ds_head.GetColumn(0, "SYR") == "") {
		gfn_showAlert("설치연령을 확인하십시요.");
		return false;
	}
	if(ds_head.GetColumn(0, "RMK") == "") {
		gfn_showAlert("특이사항을 확인하십시요.");
		return false;
	}
	
	var chkAcyn = false; // 저장 및 재견적 시 공기청정기 유무를 저장하기 위해 사용되는 변수 2020.05.15 Han JH
	
	for(var i=0; i<ds_list2.rowcount; i++) {
		if(ds_head.GetColumn(0, "CPD") == "A" && (ds_list2.GetColumn(0, "FMT") == 0 || length(trim(ds_list2.GetColumn(0, "FMT"))) == "" )) {
			gfn_showAlert("FM보수료는 필수입력 사항입니다.");
			return false;
		}

		if(ds_head.GetColumn(0, "CPD") == "B" && (ds_list2.GetColumn(0, "PMT") == 0 || length(trim(ds_list2.GetColumn(0, "PMT"))) == "")) {
			gfn_showAlert("POG보수료는 필수입력 사항입니다.");
			return false;
		}
		// 무상서비스 아닌 경우만 금액 체크 
		if(trim(ds_list2.GetColumn(i, "HFR")) == "0") {
			if(length(trim(ds_list2.GetColumn(i, "HWR"))) > 0 && ds_list2.GetColumn(i, "HMT") == 0) {
				gfn_showAlert("HRTS료는 필수입력 사항입니다.");
				return false;
			}
		} 
		// 무상서비스인 경우만 유무선 체크 
		if(trim(ds_list2.GetColumn(i, "HFR")) == "1") {
			if(length(trim(ds_list2.GetColumn(i, "HWR"))) == 0 ) {
				gfn_showAlert("HRTS 유무선은 필수입력 사항입니다.");
				return false;
			}
		} 
		if(length(trim(ds_list2.GetColumn(i, "DND"))) > 0 && ds_list2.GetColumn(i, "DMT") == 0) {
			gfn_showAlert("DI-PBX료는 필수입력 사항입니다.");
			return false;
		}

		ds_list2.SetColumn(i, "ETN", ds_head.GetColumn(0, "ETN"));
		ds_list2.SetColumn(i, "SIR", ds_head.GetColumn(0, "SIR"));

		if(parseInt(ds_list2.GetColumn(i, "FMT")) == 0 || length(trim(ds_list2.GetColumn(i, "FMT"))) == 0) {
			ds_list2.SetColumn(i, "FMT", 0);
			ds_list2.SetColumn(i, "FMG", "N");
		} else {
			ds_list2.SetColumn(i, "FMG", "Y");
		}

		if(parseInt(ds_list2.GetColumn(i, "PMT")) == 0 || length(trim(ds_list2.GetColumn(i, "PMT"))) == 0) {
			ds_list2.SetColumn(i, "PMT", 0);
			ds_list2.SetColumn(i, "POG", "N");
		} else {
			ds_list2.SetColumn(i, "POG", "Y");
		}

		if(parseInt(ds_list2.GetColumn(i, "HMT")) == 0 || length(trim(ds_list2.GetColumn(i, "HMT"))) == 0) {
			ds_list2.SetColumn(i, "HMT", 0);
			ds_list2.SetColumn(i, "HGB", "N");
			if(length(ds_list2.GetColumn(i, "HWR")) != 0 && ds_list2.GetColumn(i, "HFR") == "1"){ // 회선종류
				ds_list2.SetColumn(i, "HGB", "Y");
			}
		} else {
			if(length(ds_list2.GetColumn(i, "HWR")) == 0 ){ // 회선종류
				var arr = [parseInt(i) + 1, st_hwr.value];
				gfn_showMsg("CW00055", arr);
				return;
			} else {
				ds_list2.SetColumn(i, "HGB", "Y");
			}
		}
		
		//===========================공기청정기 추가 20200515 Han.JH==================================
		if(parseInt(ds_list2.GetColumn(i, "ACMT")) == 0) {
			ds_list2.SetColumn(i, "ACMT", 0);
			ds_list2.SetColumn(i, "ACND", "");
			if(!chkAcyn){ // 공기청정기 여부가 True 아니면 N으로 셋팅
				ds_head.SetColumn(0, "ACYN", "N");
			}
		} else {
			ds_list2.SetColumn(i, "ACND", ds_list2.GetColumn(i, "ACND"));
			if(!chkAcyn) { // 공기청정기 여부가 False 이면 Y로 셋팅
				ds_head.SetColumn(0, "ACYN", "Y");
				chkAcyn = true;
			}
		}		
		//============================================================================================

		if(parseInt(ds_list2.GetColumn(i, "DMT")) == 0 || length(trim(ds_list2.GetColumn(i, "DMT"))) == 0) {
			ds_list2.SetColumn(i, "DMT", 0);
			ds_list2.SetColumn(i, "DGB", "N");
		} else {
			if(length(ds_list2.GetColumn(i, "DND")) == 0 ){ // DI-PBX종류
				var arr = [parseInt(i) + 1, st_dnd.value];
				gfn_showMsg("CW00055", arr);
				return;
			} else {
				ds_list2.SetColumn(i, "DGB", "Y");
			}
		}

		if(length(trim(ds_list2.GetColumn(i, "HWR"))) > 0) {
			ds_head.SetColumn(0, "HYN", "Y");
		} else {
			ds_head.SetColumn(0, "HYN", "N");
		}

		if(length(trim(ds_list2.GetColumn(i, "DND"))) > 0) {
			ds_head.SetColumn(0, "DYN", "Y");
		} else {
			ds_head.SetColumn(0, "DYN", "N");
		}
	}

	//=======================이준석 과장 요청으로 프로모션 확대적용 해지 20200717 ================================
	/*
	// 무상서비스인 경우
	if(flag_hrtsFree) {
		//  표준(기준)보수료 대비 금액 체크 80%   2018 . 01  Promotion 확대 적용 
		if(!fn_checkAmtOfHrtsFree()) {
			return false;
		}
		
	}	
	*/
	//=============================================================================================================
		
		
	var str_dat = 0.0;
	str_dat = round((parseInt(ds_head.GetColumn(0, "MMN")) / gfn_getMonthCnt(ds_head.GetColumn(0, "STD"), ds_head.GetColumn(0, "ETD"))) * 100,1);
	
	ds_head.SetColumn(0, "DAT", str_dat);
	
	if(ds_head.GetColumn(0, "GIS") = "") ds_head.SetColumn(0, "GIS", "90.0");

	if(!gfn_showConfirm("CI00024","재견적")) {
		return;
	}
	
	if(ds_detail_pri.rowcount <= 0) {
		fn_make_period();
	} else {
	//  문제 없는 경우 삭제 할것   201801 
		// var tot=0;
		// var tot2=0;
		// var _amt;
		// var _hmt;
		// var _isHmt;
		// var _dmt;
		// var _isDmt;
		// /* 호기별 금액 합과 연차별 금액 합의 비교 로직 수정  20150330 이하림
		   // 그리드 셀 row 인덱스 변수로 변경 , 호기별 합산
		// */
		// if(cb_cpd.Value != "") {
			// for(var i=0 ; i < ds_list2.rowcount; i++){
			
				// if(cb_cpd.Value == 'A') {
					// _amt =grd_list2.GetCellValue(i,13); 
				// }else if (cb_cpd.Value == 'B') {
					// _amt =grd_list2.GetCellValue(i,16);
				// }
				
				// _hmt = grd_list2.GetCellValue(i,19);
				// _dmt = grd_list2.GetCellValue(i,21); 
				// _isHmt = grd_list2.GetCellValue(i,19); 
				// _isDmt = grd_list2.GetCellValue(i,20); 
				
				// if(_amt != "") tot += parseInt(_amt);
				// if(_isHmt != "" && _hmt != "") tot += parseInt(_hmt);
				// if(_isDmt != "" && _dmt != "") tot += parseInt(_dmt);
			// }
			// alert("tot = "+tot+" 개월수 ="+gfn_getMonthCnt(cal_from.Value,cal_to.Value));
			// tot = tot * gfn_getMonthCnt(cal_from.Value,cal_to.Value);
		// }
		
		// for(var i=0; i < ds_detail_pri.rowcount; i++){ 
			// alert("tot = " + ds_detail_pri.GetColumn(i,"TOT") + " mon = " +ds_detail_pri.GetColumn(i,"MON"));
			// tot2 += parseInt(ds_detail_pri.GetColumn(i,"TOT")) * parseInt(ds_detail_pri.GetColumn(i,"MON"));
		// }
		
		// if(tot == 0 || tot2 == 0 || tot != tot2){
			// alert('계약기간 별 금액을 확인하십시요.');
			// return;
		// }
	} 
	if(ds_head.GetColumn(0, "PNT") = "") ds_head.SetColumn(0, "PNT", "0");
	if(ds_head.GetColumn(0, "SAJ") = "") ds_head.SetColumn(0, "SAJ", "0");
	if(ds_head.GetColumn(0, "GIS") = "") ds_head.SetColumn(0, "GIS", "90.0");
	
	ds_docno_gen.ClearData();													//결재번호생성 데이터셋을 클리어한다
	ds_docno_gen.AddRow();																
	ds_docno_gen.SetColumn(0,"PFX","H01");										//Prefix
		
	tit_clearActionInfo();					
	tit_addSearchActionInfo("wb01:DOC_CODE_GEN_S1",true);					
	tit_addSearchActionInfo("wb01:DOC_CODE_GEN_U1");					
	tit_callService(														//동기화 방식으로 서비스를 콜한다.	
		, ""				
		, "ds_docno_gen_i=ds_docno_gen"				
		, "ds_docno_gen=ds_docno_gen_o"				
		, ""				
		, ""				
		, true
		, false
		, true);				
	
	var newDocNo = ds_docno_gen.GetColumn(0, "DOCNO");
	if(length(newDocNo) <= 1)
	{
		gfn_showMsg("CW10025", "결재문서번호 생성에 실패했습니다. 잠시 후 다시 시도해주세요.");
		return;
	}			

	ds_head.SetColumn(0,"DOC",newDocNo);
	
	/*
	ds_cond3.SetColumn(0, "DOC", ds_head.GetColumn(0, "DOC"));

	tit_clearActionInfo();
	tit_addSearchActionInfo("cs12:CS1240001B_S14");
	tit_callService(
        ""
        , ""
        , "ds_cond3=ds_cond3"
        , "ds_cnt3=ds_cnt3"
        , ""
        , "fn_afterCnt"
        , true
        , true);
    */

    fn_savRecost();
}

function fn_savRecost() {
	tit_clearActionInfo(); 
	tit_addSingleActionInfo("cs12:CS1240001B_U6");
	tit_addSingleActionInfo("cs12:CS1240001B_I3"); // zcst301
	tit_addMultiActionInfo("cs12:CS1240001B_I4"); // zcst302
	tit_addMultiActionInfo("cs12:CS1240001B_I7");
	tit_addMultiActionInfo("cs12:CS1240001B_I12"); // ZCST313 상주
	tit_callService(
		""
		, ""
		, "ds_head=ds_head ds_list2=ds_list2 ds_detail_pri=ds_detail_pri"
		, ""
		, ""
		, "fn_afterRecost"
		, true);
}

/********************************************************************************
* 기      능   : 전송
********************************************************************************/
function fn_trans() {

	if(ds_head.GetColumn(0, "PST") > "A1") {
		gfn_showAlert("작성상태에서만 전송이 가능합니다.");
		return false;
	}
	
	mode = "trans";
	
	if(!gfn_showConfirm("CI00024","전송")) {
		return;
	}
	// 시행율 구하기
	fn_calRat();
}

/********************************************************************************
* 기      능   : 저장 Callback  
********************************************************************************/
function fn_afterSave(errCode, errMsg) {
	if(errCode != 0) {
		gfn_showMsg("CE00001");
	} else {
		gfn_showMsg("CI00005");

		if(lnk == "INS" || lnk == "PLN") {
			fn_selHno2();
		} else {
			fn_selHno();
		}		
	}
}

/********************************************************************************
* 기      능   : 삭제 Callback  
********************************************************************************/
function fn_afterDelete(errCode, errMsg) {
	if(errCode != 0) {
		gfn_showMsg("CE00001");
	} else {
		gfn_showMsg("CI00005");
		close();
	}
}

/********************************************************************************
* 기      능   : 재견적 Callback
********************************************************************************/
function fn_afterRecost(errCode, errMsg) {
	if(errCode != 0) {
		gfn_showMsg("CE00001");
	} else {
		gfn_showMsg("CI00003");
		close();
	}
}


/********************************************************************************
* 기      능   : 닫기  
********************************************************************************/
function fn_close() {
	close();
}

//=========================================================================================
// [ PART 4]
// Callback 함수 정의 : callback 함수명은 메인 함수의 fn_xxxx() 에서 xxxx 부분은 fn_afterXXXX()
// 형태가 되도록 작성 
//=========================================================================================

/********************************************************************************
* 기      능   : 액셀  
********************************************************************************/
function fn_excel() {
	gfn_saveToExcel(grd_list2, true);
}

/********************************************************************************
* 기      능   : 출력 
********************************************************************************/
function fn_print() {
	
	if(ds_head.GetColumn(0, "PST") < "A3") {
		gfn_showAlert("전송 후 출력이 가능합니다.");
		return false;
	}
	
	ds_print1.ClearData();
	ds_print2.ClearData();
	ds_print3.ClearData();
	ds_print4.ClearData();
	ds_print1.AddRow();
	ds_print2.AddRow();
	//ds_print3.AddRow();
	
	ds_cond2.SetColumn(0,"DOCNO",ds_head.GetColumn(0,"DOC"));
	
	tit_clearActionInfo();
	
	tit_addSearchActionInfo("cs12:CS1240001B_S20");
	tit_addSearchActionInfo("cs12:CS1240001D_S1");
	tit_addSearchActionInfo("cs12:CS1240001C_S1");
	tit_addSearchActionInfo("wb01:DOC_CONF_S1");
	tit_addSearchActionInfo("wb01:DOC_CONF_S2");
	
	tit_callService(
        "" 
        , ""
        , "ds_cond=ds_cond2 ds_cond4=ds_cond2 ds_cond3=ds_cond2 ds_conf_cond=ds_cond2"
        , "ds_print1_result=ds_print1 ds_print2_result=ds_list5 ds_print3=ds_list3 ds_conf_list=ds_conf_list ds_draftpers_list=ds_draftpers_list"
        , ""
        , "fn_afterPrint"
        , true
        , true);
}

function fn_afterPrint() {
	mode = "print";
	
	ds_print1.SetColumn(0,"CDT",cal_cdt.Value);
	ds_print1.SetColumn(0,"STD",cal_from.Value);
	ds_print1.SetColumn(0,"ETD",cal_to.Value);
	ds_print1.SetColumn(0,"CPD",cb_cpd.Text);
	ds_print1.SetColumn(0,"CND",cb_cnd.Text);
	ds_print1.SetColumn(0,"PRD",cb_prd.Text);
	ds_print1.SetColumn(0,"BLD",cb_bld.Text);
	
	ds_print1.SetColumn(0,"BSU_NM",ds_print1_result.GetColumn(0,"BSU_NM"));
	ds_print1.SetColumn(0,"CNT",ds_print1_result.GetColumn(0,"CNT"));
	ds_print1.SetColumn(0,"SIR",ds_print1_result.GetColumn(0,"SIR"));
	ds_print1.SetColumn(0,"DYN",ds_print1_result.GetColumn(0,"DYN"));
	ds_print1.SetColumn(0,"ETN",ds_print1_result.GetColumn(0,"ETN"));
	ds_print1.SetColumn(0,"HYN",ds_print1_result.GetColumn(0,"HYN"));
	ds_print1.SetColumn(0,"ISD",ds_print1_result.GetColumn(0,"ISD"));
	ds_print1.SetColumn(0,"PJT",ds_print1_result.GetColumn(0,"PJT"));
	ds_print1.SetColumn(0,"SPT",ds_print1_result.GetColumn(0,"SPT"));
	ds_print1.SetColumn(0,"TEM_NM",ds_print1_result.GetColumn(0,"TEM_NM"));
	ds_print1.SetColumn(0,"TOT",ds_print1_result.GetColumn(0,"TOT"));
	ds_print1.SetColumn(0,"UPN",ds_print1_result.GetColumn(0,"UPN"));
	ds_print1.SetColumn(0,"WDT",ds_print1_result.GetColumn(0,"WDT"));
	//trace(ds_print1.SaveXml());
	ds_print2.SetColumn(0,"RAT1",ds_print2_result.GetColumn(0,"TOT"));
	ds_print2.SetColumn(0,"RAT2",ds_print2_result.GetColumn(0,"TOT"));
	ds_print2.SetColumn(0,"RAT3",ds_print2_result.GetColumn(0,"NMT"));
	ds_print2.SetColumn(0,"RAT4",ds_print2_result.GetColumn(0,"NMT"));
	ds_print2.SetColumn(0,"RAT5",ds_print2_result.GetColumn(0,"JMT"));
	ds_print2.SetColumn(0,"RAT6",ds_print2_result.GetColumn(0,"JM2"));
	ds_print2.SetColumn(0,"RAT7",ds_print2_result.GetColumn(0,"KMT"));
	ds_print2.SetColumn(0,"RAT8",ds_print2_result.GetColumn(0,"KMT"));
	ds_print2.SetColumn(0,"RAT9",ds_print2_result.GetColumn(0,"HMT"));
	ds_print2.SetColumn(0,"RAT10",ds_print2_result.GetColumn(0,"HMT"));
	ds_print2.SetColumn(0,"RAT11",ds_print2_result.GetColumn(0,"DMT"));
	ds_print2.SetColumn(0,"RAT12",ds_print2_result.GetColumn(0,"DMT"));
	ds_print2.SetColumn(0,"RAT13",ds_print2_result.GetColumn(0,"CMT"));
	ds_print2.SetColumn(0,"RAT14",ds_print2_result.GetColumn(0,"CMT"));
	ds_print2.SetColumn(0,"RAT15","0");
	ds_print2.SetColumn(0,"RAT16",ds_print2_result.GetColumn(0,"INC"));
	ds_print2.SetColumn(0,"RAT17",ds_print2_result.GetColumn(0,"SMT"));
	ds_print2.SetColumn(0,"RAT19",ds_print2_result.GetColumn(0,"SM2"));
	ds_print2.SetColumn(0,"RAT19",ds_print2_result.GetColumn(0,"GMT"));
	ds_print2.SetColumn(0,"RAT20",ds_print2_result.GetColumn(0,"GM2"));
	ds_print2.SetColumn(0,"RAT21",ds_print2_result.GetColumn(0,"COS"));
	ds_print2.SetColumn(0,"RAT22",ds_print2_result.GetColumn(0,"CO2"));
	ds_print2.SetColumn(0,"RAT23",ds_print2_result.GetColumn(0,"RAT"));
	ds_print2.SetColumn(0,"RAT24",ds_print2_result.GetColumn(0,"RA2"));
	
}

function fn_afterPrint2() {

	fn_printAct();
}

function fn_setHno() {
	ds_list2.ClearData();

	ds_head.SetColumn(0, "MDT", gfn_getCurrDate());
	ds_head.SetColumn(0, "MID", G_USER_ID);
	ds_head.SetColumn(0, "MID_NM", G_USER_NAME);
	ds_head.SetColumn(0, "ZMAN", G_USER_NAME);
	ds_head.SetColumn(0, "CDT","");
	ds_head.SetColumn(0, "PRD", "A");
	ds_head.SetColumn(0, "MMN", "0");
	ds_head.SetColumn(0, "DAT", 0);
	ds_head.SetColumn(0, "ZTERM", "");
	
	j = 0;
	k = 0;
	var t_hno, t_spc, t_flr, t_spd;

	for(var i=0; i<ds_list.RowCount(); i++) {		// parent.ds_list
		if(ds_list.GetColumn(i, "CHK") == true) { //체크박스가 true 일 경우
			if(k == 0) {
				t_hno = substr(ds_list.GetColumn(i, "HNO"),0,1);
				t_spc = substr(ds_list.GetColumn(i, "SPC1"),0,2);
				t_spc4 = substr(ds_list.GetColumn(i, "SPC1"),0,4);
				t_flr = toNumber(ds_list.GetColumn(i, "SPC4"));
				t_spd = toNumber(ds_list.GetColumn(i, "SPC3"));

				if(t_hno == "L") {
					t_hno = "A";
				} else {
					t_hno = "B";
				}

				if(t_spc == "LX" || t_spc == "SS" || t_spc4 == "WBLX" || t_spc4 == "WBSS") { // 2:1Roping
					t_spc = "B";
				} else { // 1:1Roping
					t_spc = "A";
				}

				if(substr(ds_list.GetColumn(i, "HNO"),0,1) == "L") {
					if(t_spd > 0 && t_spd <= 60) {
						t_spd = "A";
					} else if(t_spd > 60 && t_spd < 90) {
						t_spd = "A";
					} else if(t_spd >= 90 && t_spd < 120) {
						t_spd = "B";
					} else if(t_spd >= 120 && t_spd < 190) {
						t_spd = "C";
					} else if(t_spd >= 190) {
						t_spd = "D";
					} else {
						t_spd = "E";
					}
				} else {
					t_spd = "E";
				}

				ds_head.SetColumn(0, "SPT", ds_list.GetColumn(i, "SPT"));
				ds_head.SetColumn(0, "ADR", ds_list.GetColumn(i, "ADR"));
				ds_head.SetColumn(0, "PJT", ds_list.GetColumn(i, "PJT"));
				ds_head.SetColumn(0, "TEM", ds_list.GetColumn(i, "TEM"));
				ds_head.SetColumn(0, "BSU", ds_list.GetColumn(i, "BSU"));
				ds_head.SetColumn(0, "SPC", ds_list.GetColumn(i, "SPC1"));
				ds_head.SetColumn(0, "BLD", ds_list.GetColumn(i, "BLD"));
				ds_head.SetColumn(0, "CND", ds_list.GetColumn(i, "GBN"));
				ds_head.SetColumn(0, "GBU", ds_list.GetColumn(i, "GBU"));
				ds_head.SetColumn(0, "YGB", ds_list.GetColumn(i, "GBU"));
				ds_head.SetColumn(0, "SYR", ds_list.GetColumn(i, "FDT"));
				ds_head.SetColumn(0, "CYN", ds_list.GetColumn(i, "MNT"));
				ds_head.SetColumn(0, "PDT", t_hno);
				ds_head.SetColumn(0, "SRG", t_spc);
				ds_head.SetColumn(0, "FLR", t_flr);
				ds_head.SetColumn(0, "SPD", t_spd);
				ds_head.SetColumn(0, "BDGBN", "1");
				/*====================기존로직========================
				if (ds_head.GetColumn(0, "YGB") == "A"){
					ds_head.SetColumn(0, "BDGBN", "0");
					chk_BDGBN.Enable = false;
				}
				======================================================*/
				///*
				if (ds_head.GetColumn(0, "GBU") == "A") {
					ds_head.SetColumn(0, "BDGBN", "0");
					chk_BDGBN.Enable = false;
				}
				//*/
				
				
			}

			ds_list2.AddRow();

			ds_list2.SetColumn(j, "PJT", ds_list.GetColumn(i, "PJT"));
			ds_list2.SetColumn(j, "HNO", ds_list.GetColumn(i, "HNO"));
			ds_list2.SetColumn(j, "UPN", ds_list.GetColumn(i, "UPN"));
			ds_list2.SetColumn(j, "TEM", ds_list.GetColumn(i, "TEM"));
			ds_list2.SetColumn(j, "ISD", ds_list.GetColumn(i, "ISD"));
			ds_list2.SetColumn(j, "SPT", ds_list.GetColumn(i, "SPT"));
			ds_list2.SetColumn(j, "TBLD",ds_list.GetColumn(i, "TBLD"));
			ds_list2.SetColumn(j, "SPC", ds_list.GetColumn(i, "SPC1"));
			ds_list2.SetColumn(j, "SPC2",ds_list.GetColumn(i, "SPC2"));
			ds_list2.SetColumn(j, "WDT", ds_list.GetColumn(i, "BDT"));
			ds_list2.SetColumn(j, "TYN", ds_list.GetColumn(i, "MNT"));
			ds_list2.SetColumn(j, "FMT", 0);
			ds_list2.SetColumn(j, "FMBT", 0);
			ds_list2.SetColumn(j, "PMT", 0);
			ds_list2.SetColumn(j, "PMBT", 0);
			ds_list2.SetColumn(j, "HMT", 0);
			ds_list2.SetColumn(j, "DMT", 0);
			ds_list2.SetColumn(j, "AMT", 0);
			//===========================공기청정기 추가 20200515 Han.JH==================================
			ds_list2.SetColumn(j, "ACMT", 0);
			//============================================================================================
			ds_list2.SetColumn(j, "GBN", ds_list.GetColumn(i, "GBN"));
			ds_list2.SetColumn(j, "ABR_NM", ds_list.GetColumn(i, "BSU_NM"));
			ds_list2.SetColumn(j, "BSUGB", ds_list.GetColumn(i, "BSU_GB"));
			ds_list2.SetColumn(j, "MATNR", ds_list.GetColumn(i, "MATNR"));
			ds_list2.SetColumn(j, "BDGBN", ds_head.GetColumn(0, "BDGBN"));
			ds_head.SetColumn(0, "CNT", j+1);

			j++;
			k++;
		}
	}

	if(ds_list2.GetColumn(0, "BSUGB") == "3" || cb_prd.value == "A") {		// 협력사 & FM
		grd_list2.SetCellProp("body",grd_list2.GetBindCellIndex("BODY","HFR"),"Edit","none");
	}

}

function fn_selHno() {
	ds_cond2.SetColumn(0, "TEM", substr(ds_list.GetColumn(ds_list.row, "ETN"),0,3));
	ds_cond2.SetColumn(0, "RDT", substr(ds_list.GetColumn(ds_list.row, "ETN"),4,4));
	ds_cond2.SetColumn(0, "SEQ", substr(ds_list.GetColumn(ds_list.row, "ETN"),9,4));
	ds_cond2.SetColumn(0, "SIR", ds_list.GetColumn(ds_list.row, "SIR"));
	fn_selHno3();
}

function fn_selHno2() {
	ds_cond2.SetColumn(0, "TEM", ds_etn.GetColumn(0,"TEM"));
	ds_cond2.SetColumn(0, "RDT", ds_etn.GetColumn(0,"RDT"));
	ds_cond2.SetColumn(0, "SEQ", ds_etn.GetColumn(0,"SEQ"));
	ds_cond2.SetColumn(0, "SIR", ds_etn.GetColumn(0,"SIR"));
	fn_selHno3();
}

function fn_selHno3() {
	
	if(fa_reqno == null || length(trim(fa_reqno)) == 0) {
		tit_clearActionInfo();
		tit_addSearchActionInfo("cs12:CS1240001B_S21");
		
		tit_callService(
			""
			, ""
			, "ds_cond2=ds_cond2"
			, "ds_decide=ds_decide"
			, ""
			, ""
			, true
			, false
			, true);	
		
		if(ds_decide.rowcount > 0 && length(trim(ds_decide.GetColumn(0,"DOCNO"))) > 0)
			fa_reqno = ds_decide.GetColumn(0,"DOCNO");
	}

	ds_cond2.SetColumn(0, "DOC", fa_reqno);
	ds_cond2.SetColumn(0, "DOCNO", fa_reqno);

	fn_queryUpd();
}

// 달력 처리 부분 
/********************************************************************************
* 기      능   : 달력에서 일자 선택했을 경우 
********************************************************************************/
function cal_temp_OnDayClick(obj,strText) {
	ds_list.setColumn(ds_head.row, col, strText);
	col = "";
	obj.Visible = false;
}

/********************************************************************************
* 기      능   : 달력에서 포커스 잃었을 경우 
********************************************************************************/
function cal_temp_OnKillFocus(obj) {
	obj.Visible = false;
}

function btn_matnr_OnClick(obj) {
	if(length(ds_head.GetColumn(0, "ETN")) == 0) {
		gfn_showAlert("견적작성후 자재입력 가능합니다.");
		return false;
	}

	var arg = "t_pst=" + quote(ds_head.GetColumn(0, "PST")) + " t_apstat=" + quote(ds_head.GetColumn(0, "APSTAT")) + " t_amg=N";
	gfn_openPopup("CS1240001C", true, arg);

	fn_queryUpd();
}

/********************************************************************************
* 기      능   : 기안
********************************************************************************/
function fn_draft() {
	if(ds_head.GetColumn(0, "PST") < "A3") {
		gfn_showAlert("전송 후 기안 가능합니다.");
		return false;
	}
	var user_grp = gfn_getUserGroup();

	var vVkbur = gfn_getBsu(ds_head.GetColumn(0, "BSU"), "VKBUR"); 
	//if (G_SAP_USER_VBCD == "H100"){
	if (vVkbur == "H100"){
		ds_wbap01.ClearData();
		ds_wbap02.ClearData();
		ds_wbap01.AddRow();
		ds_wbap01.SetColumn(0, "DOCNO"   , ds_head.GetColumn(0,"DOC"));
		ds_wbap01.SetColumn(0, "DOCKIND" , "3");
		
		ds_wbap02.AddRow();
		ds_wbap02.SetColumn(0, "DOCNO"   , ds_head.GetColumn(0,"DOC"));
		ds_wbap02.SetColumn(0, "DOCKIND" , "3");

		// 결재정보 공통함수
		gfn_setZwbap(ds_wbap01, ds_wbap02, true);

		tit_clearActionInfo();
		tit_addSingleActionInfo("cs12:CS1240001B_U9");
		tit_callService(
			  ""
			, ""
			, "ds_list_0=ds_wbap01"
			, ""
			, ""
			, "fn_afterDecide"
			, true);
	
	} else {
		if( user_grp == '10' && substr(G_USER_ID,0,1) == '8') {
			var arg = "fa_docno=" + quote(ds_head.GetColumn(0, "DOC")) + " fa_dockind=3";
			var returnArgs = gfn_openPopup2("CS0401001B", true, arg);
			if( returnArgs[0] == "S" ) {
				fn_queryUpd();
			}
		} else {
			if(length(ds_head.GetColumn(0, "APSTAT")) > 0 || !gfn_showConfirm("CI00024", "투입 예상자재 입력")) {
		/*
				if(trim(ds_head.GetColumn(0, "CPD")) == "A" && length(ds_head.GetColumn(0, "MASTAT")) == 0) {
					gfn_showAlert("자재입력후 결재선 지정이 가능합니다.");
					return false;
				}
		*/
				var appgubn = "S";
		
				if(ds_head.GetColumn(0, "APSTAT") == "3") appgubn = "R";
		        //===============================================전결규정 저장으로 수정===============================================
				//var arg = "fa_docno=" + quote(ds_head.GetColumn(0, "DOC")) + " fa_dockind=3" + " fa_appgubn=" + quote(appgubn);
				var arg = "fa_docno=" + quote(ds_head.GetColumn(0, "DOC")) + " fa_dockind=3" + " fa_appgubn=" + quote(appgubn) + " fa_discrule=" + quote(ed_cof_final.Text);		
				//====================================================================================================================
				var rslt = gfn_openPopup2("CS0401001A", true, arg);
				
				if(rslt[0] = "S") {
					div_btn.btn_decide.Enable = true;	// 결재버튼 활성화
					div_btn.btn_draft.Enable = false;	// 기안버튼 비활성화
				}
		
				fn_queryUpd();
			} else {
				if(ds_head.GetColumn(0, "AMG") == "N") { // 투입예상자재
					btn_matnr_OnClick();
				} else {
					gfn_showAlert("추가자재만 입력가능 합니다.");
				return false;
				}
			}
		}
	}
}

function ds_list2_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex) {
	// if(strColumnID == "FMT" || strColumnID == "PMT" || strColumnID == "HMT" || strColumnID == "DMT") {	
		// fn_calcAmt();		
	// }
	if(strColumnID == "FMT" || strColumnID == "FMTT" || strColumnID == "PMT" || strColumnID == "PMTT" || strColumnID == "HMT" || strColumnID == "DMT"|| strColumnID == "ACMT") {
		var vIamt = 0, vTamt = 0, v1Amt = 0, v3Amt = 0, vRate = 0.0;
		var vSamt = 0, vS10  = 0; 
		if (strColumnID == "FMTT"){
			ds_list2.SetColumn(nRow, "FMT", ceil(toNumber(ds_list2.GetColumn(nRow,"FMTT")) * gfn_bdgbnRate(vBdgbn,"A")));
		} else if (strColumnID == "PMTT"){
			ds_list2.SetColumn(nRow, "PMT", ceil(toNumber(ds_list2.GetColumn(nRow,"PMTT")) * gfn_bdgbnRate(vBdgbn,"B", ds_head.GetColumn(0, "BLD"))));
		} else if (strColumnID == "FMT"){
			if (chk_BDGBN.value == "1"){
				if (toNumber(ds_list2.GetColumn(nRow,"FMTT")) == 0){
					ds_list2.FireEvent = false;
					ds_list2.SetColumn(nRow, "FMTT", toNumber(ds_list2.GetColumn(nRow,"FMT")));
					ds_list2.FireEvent = true;
				} else {
					ds_list2.SetColumn(nRow, "FMBT", toNumber(ds_list2.GetColumn(nRow,"FMTT")) - toNumber(ds_list2.GetColumn(nRow,"FMT")));
				}
			} else {
				ds_list2.FireEvent = false;
				ds_list2.SetColumn(nRow, "FMTT", toNumber(ds_list2.GetColumn(nRow,"FMT")));
				ds_list2.FireEvent = true;
			}
			ds_list2.SetColumn(nRow, "BDGBN", chk_BDGBN.value);
		} else if (strColumnID == "PMT"){
			if (chk_BDGBN.value == "1"){
				if (toNumber(ds_list2.GetColumn(nRow,"PMTT")) == 0){
					ds_list2.FireEvent = false;
					ds_list2.SetColumn(nRow, "PMTT", toNumber(ds_list2.GetColumn(nRow,"PMT")));
					ds_list2.FireEvent = true;
				} else {
					ds_list2.SetColumn(nRow, "PMBT", toNumber(ds_list2.GetColumn(nRow,"PMTT")) - toNumber(ds_list2.GetColumn(nRow,"PMT")));
				}
			} else {
				ds_list2.FireEvent = false;
				ds_list2.SetColumn(nRow, "PMTT", toNumber(ds_list2.GetColumn(nRow,"PMT")));
				ds_list2.FireEvent = true;
			}
			ds_list2.SetColumn(nRow, "BDGBN", chk_BDGBN.value);
		} else if (strColumnID == "ACMT") {
			// 금액이 0 이상이면 화면에 보이지 않는 공기청정기 종류의 컬럼값 셋팅
			if(toNumber(ds_list2.GetColumn(nRow,"ACMT")) == 0) {
				ds_list2.SetColumn(nRow, "ACND", "");
			} else {
				if(toNumber(ds_list2.GetColumn(nRow,"ACMT")) < 25000) { // 월 임대료 25000원 이하이면 사용자 안내 후 값 0으로 셋팅
					gfn_showAlert("공기청정기 임대료의 경우 25,000원 미만으로 입력이 불가능합니다. 서비스경영관리팀에 문의 바랍니다.");
					ds_list2.SetColumn(nRow, "ACND", "");
					ds_list2.SetColumn(nRow, "ACMT", "0");
				} else {
					ds_list2.SetColumn(nRow, "ACND", "A");
				}
			}
		}
		fn_calcAmt();
	} else 
	// HRTS 무상 서비스의 경우 금액 0 
	if(strColumnID == "HFR") {

		if(varNewValue == "1") {
			ds_list2.SetColumn(nRow, "HMT", 0);
		}
		// HRTS 무상제공 문구 DISPLAY 
		ed_hrtsFreeText.Visible = false ;
		flag_hrtsFree = false ;
		for(var i=0; i<ds_list2.rowcount; i++) {
			if(ds_list2.GetColumn(i, "HFR") == 1 ) {
				ed_hrtsFreeText.Visible = true ;
				flag_hrtsFree = true ;
			}
		}
	}
}

function fn_calcAmt() {
	var tmp_fmt = 0, tmp_fmtt = 0;
	var tmp_pmt = 0, tmp_pmtt = 0;
	var tmp_hmt = 0;
	var tmp_dmt = 0;
	//===========================공기청정기 추가 20200515 Han.JH==================================
	var tmp_acmt = 0;
	//============================================================================================
	var tmp_tot = 0, tmp_tott = 0;
	
	var tmp_f10  = 0; // 표준단가
	var tmp_frat = 0; // 달성율
	var tmp_p10  = 0;
	var tmp_prat = 0;

	var sum_amt = 0, sum_ambt = 0, sum_amtt = 0, sum_hmt = 0, sum_dmt = 0, sum_acmt = 0;
	for(var i=0; i < ds_list2.RowCount(); i++) {
		tmp_fmt  = toNumber(ds_list2.GetColumn(i, "FMT"));
		tmp_fmbt = toNumber(ds_list2.GetColumn(i, "FMBT"));
		tmp_fmtt = toNumber(ds_list2.GetColumn(i, "FMTT"));
		tmp_pmt  = toNumber(ds_list2.GetColumn(i, "PMT"));
		tmp_pmbt = toNumber(ds_list2.GetColumn(i, "PMBT"));
		tmp_pmtt = toNumber(ds_list2.GetColumn(i, "PMTT"));
		tmp_hmt  = toNumber(ds_list2.GetColumn(i, "HMT"));
		tmp_dmt  = toNumber(ds_list2.GetColumn(i, "DMT"));
		//===========================공기청정기 추가 20200515 Han.JH==================================
		tmp_acmt  = toNumber(ds_list2.GetColumn(i, "ACMT"));
		//============================================================================================

		/***********************************************************
		달성율 산출 방식 수정   20170627    이하림 
		호기별 달성율 평균 --->> 전체 기준단가 대비 견적가 달성율 
		***********************************************************/
		if(cb_cpd.Value == "A") { // FM
			tmp_pmt = 0;
		} else if (cb_cpd.Value == "B") { // POG
			tmp_fmt = 0;
		}

		tmp_tot = tmp_fmt + tmp_pmt + tmp_hmt + tmp_dmt + tmp_acmt;
		ds_list2.SetColumn(i, "AMT", tmp_tot);

		if(tmp_fmt <> 0) {
			tmp_f10 = toNumber(ds_list2.GetColumn(i, "F10"));
			tmp_frat = tmp_fmtt /tmp_f10 ;
			tmp_frat = round(tmp_frat*100,1) ;
	
			ds_list2.SetColumn(i, "FRAT", tmp_frat);	
			
			sum_amt = sum_amt + tmp_fmt;
			sum_ambt= sum_ambt + tmp_fmbt;
			sum_amtt= sum_amtt + tmp_fmtt;
		}
		if(tmp_pmt <> 0) {
			tmp_p10 = toNumber(ds_list2.GetColumn(i, "P10"));
			tmp_prat = tmp_pmtt /tmp_p10 ;
			tmp_prat = round(tmp_prat*100,1) ;
	
			ds_list2.SetColumn(i, "PRAT", tmp_prat);

			sum_amt = sum_amt + tmp_pmt;
			sum_ambt= sum_ambt + tmp_pmbt;
			sum_amtt= sum_amtt + tmp_pmtt;
		}
		sum_hmt = sum_hmt + tmp_hmt;
		sum_dmt = sum_dmt + tmp_dmt;
		//===========================공기청정기 추가 20200515 Han.JH==================================
		sum_acmt = sum_acmt + tmp_acmt;
		//============================================================================================
	}
	if (cb_cpd.Value == "A"){
		med_trat.Text = round(ds_list2.Sum("FMTT")/ds_list2.Sum("F10")*100,1) ;
	} else if (cb_cpd.Value == "B") { // POG
		med_trat.Text = round(ds_list2.Sum("PMTT")/ds_list2.Sum("P10")*100,1) ;
	}
	// ds_head.SetColumn(0, "AMT_S", sum_amt);
	// ds_head.SetColumn(0, "AMBT_S", sum_ambt);
	// ds_head.SetColumn(0, "AMTT_S", sum_amtt);
	// ds_head.SetColumn(0, "HMT_S", sum_hmt);
	// ds_head.SetColumn(0, "DMT_S", sum_dmt);
}

function cb_cpd_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex) {
	// 무상서비스 체크 불가 처리 
	var vHfrIdx = grd_list2.GetBindCellIndex("BODY","HFR");
    var vFmtIdx = grd_list2.GetBindCellIndex("BODY","FMT");
    var vFmttIdx = grd_list2.GetBindCellIndex("BODY","FMTT");
    var vPmtIdx = grd_list2.GetBindCellIndex("BODY","PMT");
    var vPmttIdx = grd_list2.GetBindCellIndex("BODY","PMTT");

	if(strCode == "0") {
		grd_list2.SetCellProp("body",vHfrIdx,"Edit","none");
		grd_list2.SetCellProp("body",vFmtIdx,"Edit","none");
		grd_list2.SetCellProp("body",vFmttIdx,"Edit","none");
		grd_list2.SetCellProp("body",vPmtIdx,"Edit","none");
		grd_list2.SetCellProp("body",vPmttIdx,"Edit","none");
		for(var i=0; i < ds_list2.rowcount; i++){
			ds_list2.SetColumn(i, "HFR", "0" );
		}
	} else {
		if (strCode == "A"){
			grd_list2.SetCellProp("body",vFmtIdx ,"Edit","number");
			grd_list2.SetCellProp("body",vFmttIdx,"Edit","number");
			grd_list2.SetCellProp("body",vPmtIdx ,"Edit","none");
			grd_list2.SetCellProp("body",vPmttIdx,"Edit","none");
		} else {
			grd_list2.SetCellProp("body",vFmtIdx ,"Edit","none");
			grd_list2.SetCellProp("body",vFmttIdx,"Edit","none");
			grd_list2.SetCellProp("body",vPmtIdx ,"Edit","number");
			grd_list2.SetCellProp("body",vPmttIdx,"Edit","number");
		}
		if(ds_list2.GetColumn(0, "BSUGB") == "3" || cb_prd.Value == "A") {
			grd_list2.SetCellProp("body",vHfrIdx,"Edit","none");
		} else {
			grd_list2.SetCellProp("body",vHfrIdx,"Edit","checkbox");
		}
	}
	
	fn_calcAmt();
}

function btn_cos_OnClick(obj) {
	var arg = "t_etn="  + quote(ds_head.GetColumn(0, "ETN")) 
	        + " t_sir=" + quote(ds_head.GetColumn(0, "SIR")) 
	        + " t_doc=" + quote(ds_head.GetColumn(0, "DOC"))
			+ " c=" + quote(0);
			
	gfn_openPopup("CS1240001D", true, arg);
}

function btn_addmat_OnClick(obj) {
	if(length(ds_head.GetColumn(0, "ETN")) == 0) {
		gfn_showAlert("견적작성후 자재입력 가능합니다.");
		return false;
	}

	var arg = "t_pst=" + quote(ds_head.GetColumn(0, "PST")) + " t_apstat=" + quote(ds_head.GetColumn(0, "APSTAT")) + " t_amg=Y";
	gfn_openPopup("CS1240001C", true, arg);

	fn_queryUpd();
}

function btn_saveopn_OnClick(obj) {
	var user_grp = gfn_getUserGroup();

	if(user_grp < "40") {
		return;
	}

	tit_clearActionInfo();
	tit_addSingleActionInfo("cs12:CS1240001B_U8");
	tit_callService(
		""
		, ""
		, "ds_head=ds_head"
		, ""
		, ""
		, "fn_afterSaveOpn"
		, true);
}

/********************************************************************************
* 기      능   : 검토의견 저장 Callback  
********************************************************************************/
function fn_afterSaveOpn(errCode, errMsg) {
	if(errCode != 0) {
		gfn_showMsg("CE00001");
	} else {
		gfn_showMsg("CI00005");
	}
}

function fn_updateRat(){
	ds_cost.SetColumn(0, "GNO", replace(ds_head.GetColumn(0, "ETN"),"-",""));
	ds_cost.SetColumn(0, "SIR", ds_head.GetColumn(0, "SIR"));
	ds_cost.SetColumn(0, "GMT", ds_cost_sum_o.GetColumn(0,"GMT"));
	ds_cost.SetColumn(0, "GM2", ds_cost_sum_o.GetColumn(0,"GM2"));
	ds_cost.SetColumn(0, "COST", ds_cost_sum_o.GetColumn(0,"COST"));
	ds_cost.SetColumn(0, "COS2", ds_cost_sum_o.GetColumn(0,"COS2"));
	ds_cost.SetColumn(0, "RAT", ds_cost_sum_o.GetColumn(0,"RAT"));
	ds_cost.SetColumn(0, "RA2", ds_cost_sum_o.GetColumn(0,"RA2"));
	ds_cost.SetColumn(0, "PER", ds_cost_sum_o.GetColumn(0,"PER"));
	ds_cost.SetColumn(0, "INC", ds_cost_sum_o.GetColumn(0,"INC"));
	ds_cost.SetColumn(0, "SJT", 0); // 후속 프로세스에서 상주 계산, 디폴드 금액 0
	
	tit_clearActionInfo();
	tit_addSingleActionInfo("cs12:CS1240001B_U5");
	tit_callService(
		""
		, ""
		, "ds_head=ds_head"
		, ""
		, ""
		, "fn_afterTrans"
		, true);
}

var currRow;
var dsList2Cnt;
function fn_setPlnHno(){
	ds_list2.ClearData();
	ds_plan_list.ClearData();
	dsList2Cnt = 0;
	
	ds_head.SetColumn(0, "MDT", gfn_getCurrDate());
	ds_head.SetColumn(0, "MID", G_USER_ID);
	ds_head.SetColumn(0, "MID_NM", G_USER_NAME);
	ds_head.SetColumn(0, "ZMAN", G_USER_NAME);
	ds_head.SetColumn(0, "CDT","");
	ds_head.SetColumn(0, "PRD", "A");
	ds_head.SetColumn(0, "MMN", "0");
	ds_head.SetColumn(0, "DAT", 0);

	var k=0;
	for(var i=0; i<ds_list.RowCount(); i++) {
		if(ds_list.GetColumn(i, "CHK") == true) { //체크박스가 true 일 경우
			ds_plan_list.AddRow();
			ds_plan_list.SetColumn(k, "ZDATE", cal_dat.Value);
			ds_plan_list.SetColumn(k, "UPN", ds_list.GetColumn(i, "UPN"));
			ds_plan_list.SetColumn(k, "PJT", ds_list.GetColumn(i, "PJT"));
			ds_plan_list.SetColumn(k, "SPC2", ds_list.GetColumn(i, "SPC2"));
			ds_plan_list.SetColumn(k, "SPC", ds_list.GetColumn(i, "SPC"));
			ds_plan_list.SetColumn(k, "SPC3", ds_list.GetColumn(i, "SPC3"));
			ds_plan_list.SetColumn(k, "SPC7", ds_list.GetColumn(i, "SPC7"));
			ds_plan_list.SetColumn(k, "PRO", ds_list.GetColumn(i, "PRO"));
			ds_plan_list.SetColumn(k, "BSU", ds_list.GetColumn(i, "BSU"));
			k++;
		}
	}
	
	if(ds_plan_list.rowcount > 0)
		fn_setPlnHnoList(0);
}

function fn_setPlnHnoList(i){
	
	currRow = i;
	
	if(currRow >= ds_plan_list.rowcount) return;
	
	ds_plan_i.ClearData();
	ds_plan_i.AddRow();
	ds_plan_i.SetColumn(0, "ZDATE", ds_plan_list.GetColumn(currRow, "ZDATE"));
	ds_plan_i.SetColumn(0, "UPN", ds_plan_list.GetColumn(currRow, "UPN"));
	ds_plan_i.SetColumn(0, "PJT", ds_plan_list.GetColumn(currRow, "PJT"));
	ds_plan_i.SetColumn(0, "SPC2", ds_plan_list.GetColumn(currRow, "SPC2"));
	ds_plan_i.SetColumn(0, "SPC", ds_plan_list.GetColumn(currRow, "SPC"));
	ds_plan_i.SetColumn(0, "SPC3", ds_plan_list.GetColumn(currRow, "SPC3"));
	ds_plan_i.SetColumn(0, "SPC7", ds_plan_list.GetColumn(currRow, "SPC7"));
	ds_plan_i.SetColumn(0, "PRO", ds_plan_list.GetColumn(currRow, "PRO"));
	ds_plan_i.SetColumn(0, "BSU", ds_plan_list.GetColumn(currRow, "BSU"));
	
	tit_clearActionInfo();
	tit_addSingleActionInfo("cs12:CS1240001B_S17");
	tit_callService(
		""
		, ""
		, "ds_plan_i=ds_plan_i"
		, "ds_plan_o=ds_plan_o"
		, ""
		, "fn_afterPlnHnoList"
		, true);
}

function fn_afterPlnHnoList(errCode, errMsg) {
	if(errCode != 0) {
		gfn_showMsg("CE00001");
	} else {
		
		var t_hno, t_spc, t_flr, t_spd;
		
		if(currRow == 0 && ds_plan_o.rowcount > 0){
			t_hno = substr(ds_plan_o.GetColumn(0, "HNO"),0,1);
			t_spc = substr(ds_plan_o.GetColumn(0, "SPC1"),0,2);
			t_spc4 = substr(ds_plan_o.GetColumn(0, "SPC1"),0,4);
			t_flr = toNumber(ds_plan_o.GetColumn(0, "SPC4"));
			t_spd = toNumber(ds_plan_o.GetColumn(0, "SPC3"));

			if(t_hno == "L") {
				t_hno = "A";
			} else {
				t_hno = "B";
			}

			if(t_spc == "LX" || t_spc == "SS" || t_spc4 == "WBLX" || t_spc4 == "WBSS") { // 2:1Roping
				t_spc = "B";
			} else { // 1:1Roping
				t_spc = "A";
			}
			
			if(substr(ds_plan_o.GetColumn(0, "HNO"),0,1) == "L") {
				if(t_spd > 0 && t_spd <= 60) {
					t_spd = "A";
				} else if(t_spd > 60 && t_spd < 90) {
					t_spd = "A";
				} else if(t_spd >= 90 && t_spd < 120) {
					t_spd = "B";
				} else if(t_spd >= 120 && t_spd < 190) {
					t_spd = "C";
				} else if(t_spd >= 190) {
					t_spd = "D";
				} else {
					t_spd = "E";
				}
			} else {
				t_spd = "E";
			}
			
			ds_head.SetColumn(0, "SPT", ds_plan_o.GetColumn(0, "SPT"));
			ds_head.SetColumn(0, "ADR", ds_plan_o.GetColumn(0, "ADR"));
			ds_head.SetColumn(0, "PJT", ds_plan_o.GetColumn(0, "PJT"));
			ds_head.SetColumn(0, "TEM", ds_plan_o.GetColumn(0, "TEM"));
			ds_head.SetColumn(0, "BSU", ds_plan_o.GetColumn(0, "BSU"));
			ds_head.SetColumn(0, "SPC", ds_plan_o.GetColumn(0, "SPC1"));
			ds_head.SetColumn(0, "BLD", ds_plan_o.GetColumn(0, "BLD"));
			ds_head.SetColumn(0, "CND", ds_plan_o.GetColumn(0, "GBN"));
			ds_head.SetColumn(0, "GBU", ds_plan_o.GetColumn(0, "GBU"));
			ds_head.SetColumn(0, "YGB", ds_plan_o.GetColumn(0, "GBU"));
			ds_head.SetColumn(0, "SYR", ds_plan_o.GetColumn(0, "FDT"));
			ds_head.SetColumn(0, "CYN", ds_plan_o.GetColumn(0, "MNT"));
			ds_head.SetColumn(0, "PDT", t_hno);
			ds_head.SetColumn(0, "SRG", t_spc);
			ds_head.SetColumn(0, "FLR", t_flr);
			ds_head.SetColumn(0, "SPD", t_spd);
			if (ds_plan_o.GetColumn(0, "GBU") == "B"){
				ds_head.SetColumn(0, "BDGBN", "1");
			}
		}
		
		for(var i=0; i < ds_plan_o.rowcount; i++){
			ds_list2.AddRow();
			ds_list2.SetColumn(dsList2Cnt, "PJT", ds_plan_o.GetColumn(i, "PJT"));
			ds_list2.SetColumn(dsList2Cnt, "HNO", ds_plan_o.GetColumn(i, "HNO"));
			ds_list2.SetColumn(dsList2Cnt, "UPN", ds_plan_o.GetColumn(i, "UPN"));
			ds_list2.SetColumn(dsList2Cnt, "TEM", ds_plan_o.GetColumn(i, "TEM"));
			ds_list2.SetColumn(dsList2Cnt, "ISD", ds_plan_o.GetColumn(i, "ISD"));
			ds_list2.SetColumn(dsList2Cnt, "SPT", ds_plan_o.GetColumn(i, "SPT"));
			ds_list2.SetColumn(dsList2Cnt, "TBLD",ds_plan_o.GetColumn(i, "TBLD"));
			ds_list2.SetColumn(dsList2Cnt, "SPC", ds_plan_o.GetColumn(i, "SPC1"));
			ds_list2.SetColumn(dsList2Cnt, "SPC2",ds_plan_o.GetColumn(i, "SPC2"));
			ds_list2.SetColumn(dsList2Cnt, "WDT", ds_plan_o.GetColumn(i, "BDT"));
			ds_list2.SetColumn(dsList2Cnt, "TYN", ds_plan_o.GetColumn(i, "MNT"));
			ds_list2.SetColumn(dsList2Cnt, "FMT", 0);
			ds_list2.SetColumn(dsList2Cnt, "PMT", 0);
			ds_list2.SetColumn(dsList2Cnt, "HMT", 0);
			//===========================공기청정기 추가 20200515 Han.JH==================================
			ds_list2.SetColumn(dsList2Cnt, "ACMT", 0);
			//============================================================================================
			ds_list2.SetColumn(dsList2Cnt, "DMT", 0);
			ds_list2.SetColumn(dsList2Cnt, "AMT", 0);
			ds_list2.SetColumn(dsList2Cnt, "GBN", ds_plan_o.GetColumn(i, "GBN"));
			ds_list2.SetColumn(dsList2Cnt, "BDGBN", ds_head.GetColumn(0, "BDGBN"));
			ds_list2.SetColumn(dsList2Cnt, "FMTT", 0);
			ds_list2.SetColumn(dsList2Cnt, "FMBT", 0);
			ds_list2.SetColumn(dsList2Cnt, "PMTT", 0);
			ds_list2.SetColumn(dsList2Cnt, "PMBT", 0);
			ds_list2.SetColumn(dsList2Cnt, "AMTT", 0);
			ds_list2.SetColumn(dsList2Cnt, "AMTB", 0);
			dsList2Cnt++;
		}
		if(currRow + 1 >= ds_plan_list.rowcount){
			ds_head.SetColumn(0, "CNT", ds_list2.rowcount);
		}else{
			fn_setPlnHnoList(currRow+1);
		}

	}
}


function btn_pri_OnClick(obj)
{
	gfn_clearMsgBar();
	
	if(ds_head.GetColumn(0, "STD") == "") {
		gfn_showAlert("계약시작일을 확인하십시요.");
		return false;
	}
	
	if(ds_head.GetColumn(0, "ETD") == "") {
		gfn_showAlert("계약종료일을 확인하십시요.");
		return false;
	}
	
	if(parseInt(ds_head.GetColumn(0, "ETD")) <= parseInt(ds_head.GetColumn(0, "STD"))){
		gfn_showAlert("계약기간을 확인하십시오.");
		return false;
	}
	
	if(ds_detail_pri.rowcount <= 0) fn_make_period();

	gfn_openPopup("CS1240001H");
}


function fn_make_period(){

	var nrow = 0;
	var toDt = cal_to.Value;
	var prDt = AddDate(AddMonth(cal_from.Value,12),-1);
	var fromDt = cal_from.Value;
	var tot=0;
	
	var _amt;
	var _hmt;
	var _isHmt;
	var _dmt;
	var _isDmt;
	//===========================공기청정기 추가 20200515 Han.JH==================================
	var _acmt;
	var _isAcmt;
	//============================================================================================
	
	if(cb_cpd.Value != "") {
		for(var i=0 ; i < ds_list2.rowcount; i++){
		
			if(cb_cpd.Value == 'A') {
				_amt =grd_list2.GetCellValue(0,grd_list2.GetBindCellIndex("BODY","FMT")); 
			}else if (cb_cpd.Value == 'B') {
				_amt =grd_list2.GetCellValue(0,grd_list2.GetBindCellIndex("BODY","PMT"));
			}
			
			_hmt = grd_list2.GetCellValue(0,grd_list2.GetBindCellIndex("BODY","HMT"));
			_dmt = grd_list2.GetCellValue(0,grd_list2.GetBindCellIndex("BODY","DMT")); 
			//===========================공기청정기 추가 20200515 Han.JH==================================
			_acmt = grd_list2.GetCellValue(0,grd_list2.GetBindCellIndex("BODY","ACMT"));
			//============================================================================================
			_isHmt = grd_list2.GetCellValue(0,grd_list2.GetBindCellIndex("BODY","HMT")); 
			_isDmt = grd_list2.GetCellValue(0,grd_list2.GetBindCellIndex("BODY","DMT")); 
			//===========================공기청정기 추가 20200515 Han.JH==================================
			_isAcmt = grd_list2.GetCellValue(0,grd_list2.GetBindCellIndex("BODY","ACMT")); 
			//============================================================================================
			
			if(_amt != "") tot += parseInt(_amt);
			if(_isHmt != "" && _hmt != "") tot += parseInt(_hmt);
			if(_isDmt != "" && _dmt != "") tot += parseInt(_dmt);
			//===========================공기청정기 추가 20200515 Han.JH==================================
			if(_isAcmt != "" && _acmt != "") tot += parseInt(_acmt);
			//============================================================================================
		}
	}
	
	if(parseInt(toDt) <= parseInt(prDt)){
		ds_detail_pri.AddRow();
		ds_detail_pri.SetColumn(nrow, "SEQ2", 1);
		ds_detail_pri.SetColumn(nrow, "STD", fromDt);
		ds_detail_pri.SetColumn(nrow, "ETD", toDt);
		ds_detail_pri.SetColumn(nrow, "TOT", tot);
		ds_detail_pri.SetColumn(nrow, "MON", gfn_getMonthCnt(fromDt,toDt));
	} else {
		while(parseInt(toDt) > parseInt(prDt)){
			ds_detail_pri.AddRow();
			ds_detail_pri.SetColumn(nrow, "SEQ2", nrow+1);
			ds_detail_pri.SetColumn(nrow, "STD", fromDt);
			ds_detail_pri.SetColumn(nrow, "ETD", prDt);
			ds_detail_pri.SetColumn(nrow, "TOT", tot);
			ds_detail_pri.SetColumn(nrow, "MON", 12);
			fromDt = AddDate(prDt,1);
			prDt = AddDate(AddMonth(fromDt,12),-1);
			nrow++;
		}
		
		if(parseInt(toDt) <= parseInt(prDt)){
			ds_detail_pri.AddRow();
			ds_detail_pri.SetColumn(nrow, "SEQ2", nrow+1);
			ds_detail_pri.SetColumn(nrow, "STD", fromDt);
			ds_detail_pri.SetColumn(nrow, "ETD", toDt);
			ds_detail_pri.SetColumn(nrow, "TOT", tot);
			ds_detail_pri.SetColumn(nrow, "MON", gfn_getMonthCnt(fromDt,toDt));
		}
	}
}

function cal_cdt_OnChanged(obj,strOldText,strNewText)
{
	ds_detail_pri.ClearData();
	if(cal_from.Value > '' && cal_cdt.Value > ''){
		var mmn = gfn_getMonthCnt(cal_cdt.Value, cal_from.Value);
		if(mmn <= 1 ) 
			mmn = 0;
		else if(mmn > 0 ) 
			mmn = gfn_getMonthCnt(cal_cdt.Value, AddDate(cal_from.Value, -1));
		ed_mmn.Text = mmn;
	}
	if( ds_list2.rowcount() > 0 ) { 
		if(strOldText <> strNewText) {		
			fn_getStdPrice(); // 표준단가 가져오기
		}
	}
}

function cal_from_OnChanged(obj,strOldText,strNewText)
{
	if(cal_from.Value > '' && cal_cdt.Value > ''){
		var mmn = gfn_getMonthCnt(cal_cdt.Value, cal_from.Value);
		if(mmn <= 1 ) 
			mmn = 0;
		else if(mmn > 0 ) 
			mmn = gfn_getMonthCnt(cal_cdt.Value, AddDate(cal_from.Value, -1));
		ed_mmn.Text = mmn;
	}
}

function cal_to_OnChanged(obj,strOldText,strNewText)
{
	ds_detail_pri.ClearData();
}

function fn_printAct(){
	Dialog("CS12::CS1240001I.xml", "");
}

/********************************************************************************
* 기      능   : 결재 15
********************************************************************************/
function fn_decide() {
	var decidertn;   // 결재 팝업 리턴코드
	
	gfn_clearMsgBar();
	
	if( ds_decide.rowCount() < 1 ) {
		return;
	}
	
	//if( !gfn_showConfirm("CI00014", "문서번호 : "+ quote(ds_decide.GetColumn(0,"DOCNO"))+ "결재") ) return;
	decidertn = gfn_showConfirm_decide("CI00014", "문서번호 : "+ quote(ds_decide.GetColumn(0,"DOCNO"))+ "결재") ;	
	if(decidertn == "C") return; //A : 승인, C : 취소 , W : 의견승인
	
	//----------------------------------------------------------------------
	// 의견 입력 팝업 추가 
	// f팝업 전달 변수 fa_docno : 문서번호 ,fa_dockind : 문서종류 
	// return 값 : rtn_yn (Y:의견입력됨 N:의견입력안됨)
	
	//if(gfn_showConfirm("CW10025","의견을 입력하시겠습니까?") )
	if( decidertn == "W" )    //의견입력 승인시
	{
		var arg = "";
		arg = " fa_docno=" + quote(ds_decide.GetColumn(0,"DOCNO")) +" fa_dockind=" + quote(ds_decide.GetColumn(0,"DOCKIND"));
		var rtn_yn = gfn_openPopup2("CS0401001C", true , arg);
	}

	// 의견입력 팝업 종료
	//----------------------------------------------------------------------
	// 팀장 의견입력 필수 체크 
	if(! gfn_decideCommentCheck(quote(ds_cond2.GetColumn(0,"DOCNO")) )) 
		return;   	
	//----------------------------------------------------------------------
	// 결재상태변경
	//팀장 전결의 경우 투입자재가 없거나 투입예상자재인 경우는 기안결재 완료 처리
	//CS311_AMG = 'Y' 추가 자재, 시행율2에 반영됨
	//CS311_AMG = 'N' 투입예상 자재 
	var app_end = "R";
	ds_decide.SetColumn(0, "SEQSTAT", "3"); 
	if(ed_cof.Text == '팀장' && ed_cof2.Text == '팀장' && 
			(ds_head.GetColumn(0, "MATOT") == '' || parseInt(ds_head.GetColumn(0, "MATOT")) == 0 
				|| ( ds_head.GetColumn(0, "MATOT") > 0 && ds_head.GetColumn(0, "AMG") == "N" ) ) )
		app_end = "S";
		    
	tit_clearActionInfo();
	tit_addMultiActionInfo("cs04:CS0401002A_U2");
 	tit_addMultiActionInfo("cs04:CS0401002A_U3");
 	//if(app_end == "S")
	tit_addMultiActionInfo("cs04:CS0401002A_U5");
 	tit_addMultiActionInfo("cs12:CS1240001B_U9");
 	//승인메시지(SMS)
 	tit_addMultiActionInfo("cs12:CS1240001B_I9");
 	tit_callService(
		  ""
		, ""
		, "ds_list_0=ds_decide"
		, ""
		, ""
		, "fn_afterDecide"
		, true);
 } 	 
/********************************************************************************
* 기      능   : 결재 Callback  
********************************************************************************/
function fn_afterDecide(errCode, errMsg) {
	if ( ds_error.rowcount() > 0 ) {
		gfn_showAlert("CE00001");
	} else {
		//gfn_showAlert("CI00003");
		div_btn.btn_decide.Enable 	= false;	// 결재버튼
		div_btn.btn_sendback.Enable = false;  	// 반송버튼
		//parent.fn_query();
		fn_close();
	}
}

/********************************************************************************
* 기      능   : 반송 65
********************************************************************************/
function fn_sendback() {
	var decidertn;   // 결재 팝업 리턴코드
	
	gfn_clearMsgBar();
	
	if( ds_decide.rowCount() < 1 ) {
		// 승인할 정보 없음. 
		return;
	}
	
	if( !gfn_showConfirm("CI00014", "문서번호 : "+ quote(ds_decide.GetColumn(0,"DOCNO"))+ "반송") ) return;
	decidertn = gfn_showConfirm_decide("CI00014", "문서번호 : "+ quote(ds_decide.GetColumn(0,"DOCNO"))+ "반송") ;	
	if(decidertn == "C") return; //A : 승인, C : 취소 , W : 의견승인
	 
	//----------------------------------------------------------------------
	// 의견 입력 팝업 추가 
	// f팝업 전달 변수 fa_docno : 문서번호 ,fa_dockind : 문서종류 
	// return 값 : rtn_yn (Y:의견입력됨 N:의견입력안됨)
	
	//if(gfn_showConfirm("CW10025","의견을 입력하시겠습니까?") )
	if( decidertn == "W" )    //의견입력 승인시
	{
		var arg = "";
		arg = " fa_docno=" + quote(ds_decide.GetColumn(0,"DOCNO")) +" fa_dockind=" + quote(ds_decide.GetColumn(0,"DOCKIND"));
		var rtn_yn = gfn_openPopup2("CS0401001C", true , arg);
	}
	//alert("rtn_yn:"+rtn_yn);
	// 의견입력 팝업 종료
	//----------------------------------------------------------------------
	
	tit_clearActionInfo();
	
	// 결재상태변경
	ds_decide.SetColumn(0, "SEQSTAT", "2");
	// 결재정보 관리 - 차순별 결재정보  update(zwbap02)
 	tit_addMultiActionInfo("cs04:CS0401002A_U2");
 	// 현장지원 결재 정보 관리 update(zwbap01)
 	tit_addMultiActionInfo("cs04:CS0401002A_U3");
 	tit_addMultiActionInfo("cs12:CS1240001B_U10");
	//반송메시지(SMS)
	tit_addMultiActionInfo("cs12:CS1240001B_I10");
	
	tit_callService(
		  ""
		, ""
		, "ds_list_0=ds_decide" 
		, ""
		, ""
		, "fn_afterSendback"
		, true);
}

/********************************************************************************
* 기      능   : 반송 Callback  
********************************************************************************/
function fn_afterSendback(errCode, errMsg) {
	if ( ds_error.rowcount() > 0 ) {
		gfn_showAlert("CE00001");
	} else {
		//gfn_showAlert("CI00003");
		div_btn.btn_decide.Enable 	= false;	// 결재버튼
		div_btn.btn_sendback.Enable = false;  	// 반송버튼
		
		//parent.fn_query();
		fn_close();
	}
}


/********************************************************************************
* 기      능   : 인원상주 정보 입력 201512 이하림
상태별 권한 체크할것
********************************************************************************/
function btn_sangju_OnClick(obj)
{
	gfn_clearMsgBar();
	
	if(length(ds_head.GetColumn(0, "ETN")) == 0) {
		gfn_showAlert("견적작성후 상주입력 가능합니다.");
		return false;
	}
	
	var arg = "t_pst=" + quote(ds_head.GetColumn(0, "PST")) + " t_apstat=" + quote(ds_head.GetColumn(0, "APSTAT")) + " t_amg=N t_bsu=" + quote(ds_head.GetColumn(0, "BSU"));

	gfn_openPopup("CS1240001J", true, arg);
	
	
}

/********************************************************************************
* 기      능   : 표준단가 가져오기
********************************************************************************/
function fn_getStdPrice(){

	var gdat = cal_cdt.Value;
	//계약예정일 기준 연령 계산
	for(var i=0; i < ds_list2.rowcount; i++){
		ds_list2.SetColumn(i, "DAT", gdat );
		ds_list2.SetColumn(i, "PRAT", 0 );
		ds_list2.SetColumn(i, "FRAT", 0 );
	}
	
	// 계약예정일의 값이 Null로 들어가 표준단가 구하는 경우가 있어 제약조건 추가. 2020.09.04 Han J.H
	// 윤철중 부장님 지시사항
	if(length(trim(cal_cdt.Value)) <> 8) { // 계약예정일의 값이 없다면
		gfn_showAlert("올바른 계약예정일을 입력해주세요.");
		return;
	}	

	tit_callService(
        "CS1299001A_ACT"
        , "getStdPrice2"
        , "ds_list=ds_list2"
        , "ds_list2=ds_list"
        , ""
        , "fn_aftergetStdPrice");	
}
function fn_aftergetStdPrice() {
	fn_calcAmt();
}
var ratModifyFlag ;
/********************************************************************************
* 기      능   : 시행률 산출 
********************************************************************************/
function btn_calRat_OnClick(obj)
{	
// ZCST301  상태 변경 후 시행율 계산
	if(gfn_showConfirm("CI30001", "확인:시행율 조회"+ "\n" + "\n" 
	                             + "취소:시행율 조회 및 저장"))
	{
		ratModifyFlag = true;
	}

	fn_calRat();
}
function fn_calRat() {
	ds_costT.ClearData();
	ds_head.SetColumn(0,"PGMID","ESTIMATE");	
	ds_head.SetColumn(0,"ETN",replace(ds_head.GetColumn(0,"ETN"),"-",""));
	
	//trace(ds_head.SaveXML());
	
	tit_callService(
        "CS1299001A_ACT"
        , "getSujuRat"
        , "ds_cond=ds_head"
        , "ds_costT=ds_list"
        , ""
        , "fn_afterCalRat");	
        
} 

function fn_afterCalRat(errCode, errMsg) {
	//trace(ds_costT.SaveXML());
	
	if(errCode != 0) {
		gfn_showAlert("전송처리를 취소합니다. 다시 시도해주세요.");
	} else {
		if(ratModifyFlag == true) {
			fn_selHno();
		} else {
			fn_setDsCost();
			fn_saveRat(); // 시행률 저장
		}
	}
	
}

/********************************************************************************
* 기      능   : 시행율 정보 생성
********************************************************************************/
function fn_saveRat() {
//trace(ds_cost.SaveXml());
	if(ds_costT.RowCount() == 0 ) {
		gfn_showAlert("시행율 정보가 없습니다. 전송 처리를 취소합니다.");
	} else {
		if(ratModifyFlag == true) {
			fn_selHno();
		} else {
			//alert("insert");
			//TRACE(ds_cost.SaveXML());
			tit_clearActionInfo();
			tit_addSingleActionInfo("cs12:CS1240001B_I5");
			tit_callService(
				""
				, ""
				, "ds_cost=ds_cost"
				, ""
				, ""
				, "fn_afterSaveRat"
				, true);
		}
	}
}
/********************************************************************************
* 기      능   : 시행율 Callback
********************************************************************************/
function fn_afterSaveRat(errCode, errMsg) {
	if(errCode != 0) {
		gfn_showMsg("CE00001");
	} else {
	
		tit_clearActionInfo();
		tit_addSingleActionInfo("cs12:CS1240001B_U5");
		tit_callService(
			""
			, ""
			, "ds_head=ds_head"
			, ""
			, ""
			, "fn_afterTrans"
			, true);
	}
}

/********************************************************************************
* 기      능   : 전송 Callback
********************************************************************************/
function fn_afterTrans(errCode, errMsg) {
	if(errCode != 0) {
		gfn_showMsg("CE00001");
	} else {
		gfn_showMsg("CI00006", "전송");
		fn_selHno();
	}
}
function fn_setDsCost() {

	ds_cost.ClearData();
	ds_cost.AddRow();
	ds_cost.SetColumn(0, "ZYEAR", substr(ds_head.GetColumn(0, "STD"),0,4));
	ds_cost.SetColumn(0, "GNO", replace(ds_head.GetColumn(0, "ETN"),"-",""));
	ds_cost.SetColumn(0, "SIR",  ds_head.GetColumn(0, "SIR"));
	ds_cost.SetColumn(0, "NMT",  ds_costT.GetColumn(0,"G_NMT"));
	ds_cost.SetColumn(0, "JMT",  ds_costT.GetColumn(0,"G_JMT"));
	ds_cost.SetColumn(0, "JM2", ds_costT.GetColumn(0,"G_JMT2"));
	ds_cost.SetColumn(0, "KMT",  ds_costT.GetColumn(0,"G_KMT"));
	ds_cost.SetColumn(0, "HMT",  ds_costT.GetColumn(0,"G_HMT"));
	//===========================공기청정기 추가 20200515 Han.JH==================================
	ds_cost.SetColumn(0, "ACMT",  ds_costT.GetColumn(0,"G_ACMT"));
	//============================================================================================
	ds_cost.SetColumn(0, "DMT",  ds_costT.GetColumn(0,"G_DMT"));
	ds_cost.SetColumn(0, "CMT",  ds_costT.GetColumn(0,"G_CMT"));
	ds_cost.SetColumn(0, "GMT",  ds_costT.GetColumn(0,"G_GMT"));
	ds_cost.SetColumn(0, "GM2",  ds_costT.GetColumn(0,"G_GMT2"));
	ds_cost.SetColumn(0, "COST", ds_costT.GetColumn(0,"G_COS"));
	ds_cost.SetColumn(0, "COS2", ds_costT.GetColumn(0,"G_COS2"));
	ds_cost.SetColumn(0, "RAT",  ds_costT.GetColumn(0,"G_RAT"));
	ds_cost.SetColumn(0, "RA2",  ds_costT.GetColumn(0,"G_RAT2"));
	ds_cost.SetColumn(0, "PER",  ds_costT.GetColumn(0,"G_PER"));
	ds_cost.SetColumn(0, "INC",  ds_costT.GetColumn(0,"G_INC"));
	ds_cost.SetColumn(0, "SJT",  ds_costT.GetColumn(0,"G_SJT"));
	ds_cost.SetColumn(0, "INCENTIVE",  ds_costT.GetColumn(0,"G_INCENTIVE"));

}

/********************************************************************************
* 기      능   : 점검주기 변경시
               : 매월 점검 / 협력사의 경우 HRTS 무상 서비스 제공 불가 처리
********************************************************************************/
function cb_prd_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{ 
	var vHfrIdx = grd_list2.GetBindCellIndex("BODY","HFR");
	if(nNewIndex == 1 ) {
		grd_list2.SetCellProp("body",vHfrIdx,"Edit","none");
		for(var i=0; i < ds_list2.rowcount; i++){
			ds_list2.SetColumn(i, "HFR", "0" );
		}
	} else {
		if(ds_list2.GetColumn(0, "BSUGB") == "3" ) {
			grd_list2.SetCellProp("body",vHfrIdx,"Edit","none");
		} else {
			grd_list2.SetCellProp("body",vHfrIdx,"Edit","checkbox");
		}
	}	
}


function ds_head_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{
	if (strColumnID == "CPD" || strColumnID == "BDGBN" || strColumnID == "BLD" ) {
		vBdgbn = ds_head.GetColumn(nRow, "BDGBN");
		for (i = 0; i < ds_list2.GetRowCount(); i++){
			ds_list2.SetColumn(i, "BDGBN", vBdgbn);
			if (toNumber(ds_list2.GetColumn(i,"FMTT")) != 0){
				vBdgbnRate = gfn_bdgbnRate(vBdgbn,"A");
				ds_list2.SetColumn(i, "FMT", ceil(toNumber(ds_list2.GetColumn(i, "FMTT")) * vBdgbnRate));
				ds_list2.SetColumn(i, "FMBT", toNumber(ds_list2.GetColumn(i, "FMTT")) - toNumber(ds_list2.GetColumn(i, "FMT")));
			}
			if (toNumber(ds_list2.GetColumn(i,"PMTT")) != 0){
				vBdgbnRate = gfn_bdgbnRate(vBdgbn,"B", ds_head.GetColumn(0, "BLD"));
				ds_list2.SetColumn(i, "PMT", ceil(toNumber(ds_list2.GetColumn(i, "PMTT")) * vBdgbnRate));
				ds_list2.SetColumn(i, "PMBT", toNumber(ds_list2.GetColumn(i, "PMTT")) - toNumber(ds_list2.GetColumn(i, "PMT")));
			} 
		}
	} else if (strColumnID == "YGB"){
	
		/*================기존 로직======================
		if (varNewValue == "" || varNewValue == "A"){
			ds_head.SetColumn(nRow, "BDGBN", "0");
			chk_BDGBN.Enable = false;
		} else {
			ds_head.SetColumn(nRow, "BDGBN", "1");
			chk_BDGBN.Enable = true;
		}
	    =============================================*/
		if ( ds_list2.GetColumn(0, "BSUGB") == '1') {
			ds_head.SetColumn(nRow, "BDGBN", "0");
			chk_BDGBN.Enable = false;
		} else {					
			ds_head.SetColumn(nRow, "BDGBN", "1");
			chk_BDGBN.Enable = true;						
		}
		
		
		
		
	}
}
]]></Script>
</Window>