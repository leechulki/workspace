<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="544" Id="CS1201001C" Left="8" OnLoadCompleted="fn_OnLoadCompleted" OnUnloadCompleted="fn_OnUnloadCompleted" PidAttrib="7" Title="Copy&#32;Tool" Top="8" Ver="1.0" Width="376" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_code_cond">
				<Contents>
					<colinfo id="UPN" size="256" type="STRING"/>
					<colinfo id="CST" size="256" type="STRING"/>
					<record>
						<CST></CST>
						<UPN></UPN>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_hno">
				<Contents>
					<colinfo id="HNO" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_fmkind_cd">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_hep_cd">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_fmy_cd">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_fms_cd">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE>01</CODE>
						<CODE_NAME>01년차</CODE_NAME>
					</record>
					<record>
						<CODE>02</CODE>
						<CODE_NAME>02년차</CODE_NAME>
					</record>
					<record>
						<CODE>03</CODE>
						<CODE_NAME>03년차</CODE_NAME>
					</record>
					<record>
						<CODE>04</CODE>
						<CODE_NAME>04년차</CODE_NAME>
					</record>
					<record>
						<CODE>05</CODE>
						<CODE_NAME>05년차</CODE_NAME>
					</record>
					<record>
						<CODE>06</CODE>
						<CODE_NAME>06년차</CODE_NAME>
					</record>
					<record>
						<CODE>07</CODE>
						<CODE_NAME>07년차</CODE_NAME>
					</record>
					<record>
						<CODE>08</CODE>
						<CODE_NAME>08년차</CODE_NAME>
					</record>
					<record>
						<CODE>09</CODE>
						<CODE_NAME>09년차</CODE_NAME>
					</record>
					<record>
						<CODE>10</CODE>
						<CODE_NAME>10년차</CODE_NAME>
					</record>
					<record>
						<CODE>11</CODE>
						<CODE_NAME>11년차</CODE_NAME>
					</record>
					<record>
						<CODE>12</CODE>
						<CODE_NAME>12년차</CODE_NAME>
					</record>
					<record>
						<CODE>13</CODE>
						<CODE_NAME>13년차</CODE_NAME>
					</record>
					<record>
						<CODE>14</CODE>
						<CODE_NAME>14년차</CODE_NAME>
					</record>
					<record>
						<CODE>15</CODE>
						<CODE_NAME>15년차</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_crs_cd">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_hwr_cd">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE>A</CODE>
						<CODE_NAME>유선</CODE_NAME>
					</record>
					<record>
						<CODE>B</CODE>
						<CODE_NAME>무선</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_gbn_cd">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_dnd">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE>A</CODE>
						<CODE_NAME>Mini-PBX</CODE_NAME>
					</record>
					<record>
						<CODE>B</CODE>
						<CODE_NAME>Di-PBX2</CODE_NAME>
					</record>
					<record>
						<CODE>C</CODE>
						<CODE_NAME>Hybrid-PBX</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_acnd">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
		</Datasets>
		<Shape BKColor="user12" Bottom="95" Height="26" Id="Shape16" Left="7" LineColor="user13" Right="367" TabOrder="85" Top="69" Type="Rectangle" Width="360"></Shape>
		<Shape BKColor="user12" Bottom="269" Height="26" Id="Shape10" Left="7" LineColor="user13" Right="367" TabOrder="69" Top="243" Type="Rectangle" Width="360"></Shape>
		<Shape BKColor="user12" Bottom="391" Height="26" Id="Shape4" Left="7" LineColor="user13" Right="367" TabOrder="44" Top="365" Type="Rectangle" Width="360"></Shape>
		<Shape BKColor="user12" Bottom="170" Height="26" Id="Shape3" Left="7" LineColor="user13" Right="367" TabOrder="41" Top="144" Type="Rectangle" Width="360"></Shape>
		<Shape BKColor="user12" Bottom="145" Height="26" Id="Shape2" Left="7" LineColor="user13" Right="367" TabOrder="39" Top="119" Type="Rectangle" Width="360"></Shape>
		<Shape BKColor="user12" Bottom="70" Height="26" Id="Shape1" Left="7" LineColor="user13" Right="367" TabOrder="33" Top="44" Type="Rectangle" Width="360"></Shape>
		<Combo Border="Flat" CodeColumn="HNO" DataColumn="HNO" Height="20" Id="cb_hno_fm" INDEX="0" InnerDataset="ds_hno" Left="114" Style="sty_ipt_form" TabOrder="1" Top="46" Width="102"></Combo>
		<Static Align="Right" Height="24" Id="st_hno" Left="8" Style="sty_lb_form_basic" TabOrder="34" Text="적용호기&#32;" Top="45" VAlign="Middle" Width="105"></Static>
		<Static Align="Center" Border="None" Color="user7" Font="굴림,9" Height="20" Id="Static17" Left="218" TabOrder="35" Text="~" Top="122" VAlign="Middle" Width="18"></Static>
		<Shape BKColor="user12" Bottom="120" Height="26" Id="Shape0" Left="7" LineColor="user13" Right="367" TabOrder="36" Top="94" Type="Rectangle" Width="360"></Shape>
		<Static Align="Right" Height="24" Id="st_usd" Left="8" Style="sty_lb_form_basic" TabOrder="37" Text="계약개시일&#32;" Top="95" VAlign="Middle" Width="105"></Static>
		<Calendar Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DisableBKColor="user5" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_ugs_fm" Left="115" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="6" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="122" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="100"></Calendar>
		<Static Align="Center" Border="None" Color="user7" Font="굴림,9" Height="20" Id="Static1" Left="218" TabOrder="38" Text="~" Top="47" VAlign="Middle" Width="18"></Static>
		<Calendar Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DisableBKColor="user5" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_ugs_to" Left="238" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="7" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="122" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="102"></Calendar>
		<Combo Border="Flat" CodeColumn="HNO" DataColumn="HNO" Height="20" Id="cb_hno_to" INDEX="0" InnerDataset="ds_hno" Left="238" Style="sty_ipt_form" TabOrder="2" Top="46" Width="103"></Combo>
		<Calendar Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DisableBKColor="user5" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_usd" Left="115" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="5" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="97" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="100"></Calendar>
		<Static Align="Right" Height="24" Id="st_ugs" Left="8" Style="sty_lb_form_basic" TabOrder="40" Text="유상계약기간&#32;" Top="120" VAlign="Middle" Width="105"></Static>
		<Static Align="Right" Height="24" Id="st_amt" Left="8" Style="sty_lb_form_basic" TabOrder="42" Text="유지관리비&#32;" Top="145" VAlign="Middle" Width="105"></Static>
		<MaskEdit Border="Flat" Height="20" Id="med_amtt" Left="115" OnChanged="med_amtt_OnChanged" Style="sty_ipt_form" TabOrder="8" Top="147" Width="100"></MaskEdit>
		<Static Align="Center" Border="None" Color="user7" Font="굴림,9" Height="20" Id="Static4" Left="218" TabOrder="43" Text="(부가세&#32;별도)" Top="147" VAlign="Middle" Width="82"></Static>
		<Static Align="Right" Height="24" Id="st_fm" Left="8" Style="sty_lb_form_basic" TabOrder="45" Text="FM&#32;계약여부&#32;" Top="366" VAlign="Middle" Width="105"></Static>
		<Checkbox BKColor="user5" DisableBKColor="user5" Height="20" Id="chk_fm" Left="117" OnClick="chk_fm_OnClick" Style="sty_ipt_form_chk" TabOrder="23" Top="368" Value="FALSE" Width="16"></Checkbox>
		<Static Align="Right" Height="24" Id="st_fmkind" Left="138" Style="sty_lb_form_basic" TabOrder="46" Text="FM상품종류&#32;" Top="366" VAlign="Middle" Width="105"></Static>
		<Combo Border="Flat" CodeColumn="CODE" DataColumn="CODE_NAME" DisableBKColor="user5" Height="20" Id="cb_fmkind" INDEX="0" InnerDataset="ds_fmkind_cd" Left="244" Style="sty_ipt_form" TabOrder="24" Top="367" Width="111"></Combo>
		<Shape BKColor="user12" Bottom="441" Height="26" Id="Shape5" Left="7" LineColor="user13" Right="367" TabOrder="47" Top="415" Type="Rectangle" Width="360"></Shape>
		<Static Align="Right" Height="24" Id="st_rgb" Left="8" Style="sty_lb_form_basic" TabOrder="48" Text="비율제계약여부&#32;" Top="416" VAlign="Middle" Width="105"></Static>
		<Checkbox BKColor="user5" DisableBKColor="user5" Height="20" Id="chk_rgb" Left="117" OnClick="chk_rgb_OnClick" Style="sty_ipt_form_chk" TabOrder="27" Top="418" Value="FALSE" Width="16"></Checkbox>
		<Static Align="Right" Height="24" Id="st_rto" Left="138" Style="sty_lb_form_basic" TabOrder="49" Text="기성비지급율&#32;" Top="416" VAlign="Middle" Width="105"></Static>
		<Div Height="36" Id="div_btn" Left="-8" TabOrder="50" Text="Div0" ToolTipFont="Default,0" Url="WB01::CommBtnForm.xml" Width="378">
			<Contents></Contents>
		</Div>
		<Edit Height="23" Id="ed_upn" Left="400" TabOrder="51" Top="64" Visible="FALSE" Width="56"></Edit>
		<Edit Height="23" Id="ed_cst" Left="400" TabOrder="52" Top="88" Visible="FALSE" Width="56"></Edit>
		<Edit Height="23" Id="ed_kind" Left="400" TabOrder="53" Top="112" Visible="FALSE" Width="56"></Edit>
		<Edit Height="23" Id="ed_gbn" Left="400" TabOrder="54" Top="136" Visible="FALSE" Width="56"></Edit>
		<Shape BKColor="user12" Bottom="466" Height="26" Id="Shape6" Left="7" LineColor="user13" Right="367" TabOrder="55" Top="440" Type="Rectangle" Width="360"></Shape>
		<Static Align="Right" Height="24" Id="st_iyn" Left="8" Style="sty_lb_form_basic" TabOrder="56" Text="인센티브지급여부&#32;" Top="441" VAlign="Middle" Width="105"></Static>
		<Checkbox BKColor="user5" DisableBKColor="user5" Height="20" Id="chk_iyn" Left="117" Style="sty_ipt_form_chk" TabOrder="29" Top="443" Value="FALSE" Width="16"></Checkbox>
		<MaskEdit Border="Flat" DisableBKColor="user5" Height="20" Id="med_rto" Left="245" MaxLength="3" OnKillFocus="med_rto_OnKillFocus" Style="sty_ipt_form" TabOrder="28" Top="418" Width="109"></MaskEdit>
		<Shape BKColor="user12" Bottom="491" Height="26" Id="Shape7" Left="7" LineColor="user13" Right="367" TabOrder="57" Top="465" Type="Rectangle" Width="360"></Shape>
		<Checkbox BKColor="user5" DisableBKColor="user5" Height="20" Id="chk_can" Left="117" OnClick="chk_can_OnClick" Style="sty_ipt_form_chk" TabOrder="30" Top="468" Value="FALSE" Width="16"></Checkbox>
		<Static Align="Right" Height="24" Id="st_can_yn" Left="8" Style="sty_lb_form_basic" TabOrder="58" Text="중도해지여부&#32;" Top="466" VAlign="Middle" Width="105"></Static>
		<Static Align="Right" Height="24" Id="st_can_date" Left="138" Style="sty_lb_form_basic" TabOrder="59" Text="중도해지일&#32;" Top="466" VAlign="Middle" Width="105"></Static>
		<Calendar Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DisableBKColor="user5" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_can" Left="245" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="31" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="468" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="109"></Calendar>
		<Static Height="22" Id="st_cur_date" Left="400" TabOrder="60" Text="현재일" Top="235" Width="58"></Static>
		<Shape BKColor="user12" Bottom="245" Height="26" Id="Shape8" Left="7" LineColor="user13" Right="367" TabOrder="61" Top="219" Type="Rectangle" Width="360"></Shape>
		<Static Align="Right" Height="24" Id="st_hyn" Left="8" Style="sty_lb_form_basic" TabOrder="62" Text="HRTS&#32;여부&#32;" Top="245" VAlign="Middle" Width="105"></Static>
		<MaskEdit Border="Flat" Enable="FALSE" Height="20" Id="med_hmt" Left="200" Style="sty_ipt_form" TabOrder="14" Top="246" Value="0" Width="80"></MaskEdit>
		<Static Align="Center" Border="None" Color="user7" Font="굴림,9" Height="20" Id="Static2" Left="282" TabOrder="63" Text="(부가세&#32;별도)" Top="246" VAlign="Middle" Width="82"></Static>
		<Shape BKColor="user12" Bottom="317" Height="26" Id="Shape9" Left="7" LineColor="user13" Right="367" TabOrder="64" Top="291" Type="Rectangle" Width="360"></Shape>
		<Static Align="Right" Height="24" Id="st_dyn" Left="8" Style="sty_lb_form_basic" TabOrder="65" Text="DI-PBX&#32;여부&#32;" Top="292" VAlign="Middle" Width="105"></Static>
		<MaskEdit Border="Flat" Enable="FALSE" Height="20" Id="med_dmt" Left="200" Style="sty_ipt_form" TabOrder="17" Top="294" Value="0" Width="80"></MaskEdit>
		<Static Align="Center" Border="None" Color="user7" Font="굴림,9" Height="20" Id="Static5" Left="282" TabOrder="66" Text="(부가세&#32;별도)" Top="295" VAlign="Middle" Width="82"></Static>
		<Checkbox BKColor="user5" DisableBKColor="user5" Height="20" Id="chk_dyn" Left="120" OnClick="chk_dyn_OnClick" Style="sty_ipt_form_chk" TabOrder="16" Top="295" Value="FALSE" Width="16"></Checkbox>
		<Checkbox BKColor="user5" DisableBKColor="user5" Height="20" Id="chk_hyn" Left="117" OnClick="chk_hyn_OnClick" Style="sty_ipt_form_chk" TabOrder="13" Top="247" Value="FALSE" Width="16"></Checkbox>
		<Static Align="Right" Height="24" Id="st_dmt" Left="138" Style="sty_lb_form_basic" TabOrder="67" Text="공급가액&#32;" Top="292" VAlign="Middle" Width="60"></Static>
		<Static Align="Right" Height="23" Id="st_hmt" Left="138" Style="sty_lb_form_basic" TabOrder="68" Text="공급가액&#32;" Top="245" VAlign="Middle" Width="60"></Static>
		<Static Align="Right" Height="24" Id="Static0" Left="8" Style="sty_lb_form_basic" TabOrder="70" Text="HRTS&#32;여부&#32;" Top="245" VAlign="Middle" Width="105"></Static>
		<Static Align="Right" Height="24" Id="st_hep" Left="8" Style="sty_lb_form_basic" TabOrder="71" Text="점검주기&#32;" Top="220" VAlign="Middle" Width="105"></Static>
		<Combo Border="Flat" CodeColumn="CODE" DataColumn="CODE_NAME" DisableBKColor="user5" Height="20" Id="cb_hep" INDEX="0" InnerDataset="ds_hep_cd" Left="114" Style="sty_ipt_form" TabOrder="11" Top="221" Width="100"></Combo>
		<Shape BKColor="user12" Bottom="416" Height="26" Id="Shape11" Left="7" LineColor="user13" Right="367" TabOrder="72" Top="390" Type="Rectangle" Width="360"></Shape>
		<Static Align="Right" Height="24" Id="st_fmy" Left="8" Style="sty_lb_form_basic" TabOrder="73" Text="FM&#32;계약연차&#32;" Top="391" VAlign="Middle" Width="105"></Static>
		<Combo Border="Flat" CodeColumn="CODE" DataColumn="CODE_NAME" DisableBKColor="user5" Height="20" Id="cb_fmy" INDEX="0" InnerDataset="ds_fmy_cd" Left="114" Style="sty_ipt_form" TabOrder="25" Top="392" Width="80"></Combo>
		<Combo Border="Flat" CodeColumn="CODE" DataColumn="CODE_NAME" DisableBKColor="user5" Height="20" Id="cb_fms" INDEX="0" InnerDataset="ds_fms_cd" Left="194" Style="sty_ipt_form" TabOrder="26" Top="392" Width="80"></Combo>
		<Shape BKColor="user12" Bottom="516" Height="26" Id="Shape12" Left="7" LineColor="user13" Right="367" TabOrder="74" Top="490" Type="Rectangle" Width="360"></Shape>
		<Combo Border="Flat" CodeColumn="CODE" DataColumn="CODE_NAME" DisableBKColor="user5" Height="20" Id="cb_crs" INDEX="0" InnerDataset="ds_crs_cd" Left="114" Style="sty_ipt_form" TabOrder="32" Top="492" Width="150"></Combo>
		<Static Align="Right" Height="24" Id="st_crs" Left="8" Style="sty_lb_form_basic" TabOrder="75" Text="중도해지사유&#32;" Top="491" VAlign="Middle" Width="105"></Static>
		<Shape BKColor="user12" Bottom="293" Height="26" Id="Shape13" Left="7" LineColor="user13" Right="367" TabOrder="76" Top="267" Type="Rectangle" Width="360"></Shape>
		<Static Align="Right" Height="24" Id="st_hwr" Left="8" Style="sty_lb_form_basic" TabOrder="77" Text="HRTS&#32;회선종류&#32;" Top="268" VAlign="Middle" Width="105"></Static>
		<Combo Border="Flat" CodeColumn="CODE" DataColumn="CODE_NAME" DisableBKColor="user5" Enable="FALSE" Height="20" Id="cb_hwr" INDEX="0" InnerDataset="ds_hwr_cd" Left="114" Style="sty_ipt_form" TabOrder="15" Top="269" Width="100"></Combo>
		<Static Align="Right" Height="24" Id="Static3" Left="222" Style="sty_lb_form_basic" TabOrder="78" Text="계약변동&#32;" Top="220" VAlign="Middle" Width="60"></Static>
		<Combo Border="Flat" CodeColumn="CODE" DataColumn="CODE_NAME" DisableBKColor="user5" Height="20" Id="cb_gbn" INDEX="0" InnerDataset="ds_gbn_cd" Left="283" Style="sty_ipt_form" TabOrder="12" Top="221" Width="80"></Combo>
		<Shape BKColor="user12" Bottom="342" Height="26" Id="Shape14" Left="7" LineColor="user13" Right="367" TabOrder="79" Top="316" Type="Rectangle" Width="360"></Shape>
		<Combo Border="Flat" CodeColumn="CODE" DataColumn="CODE_NAME" DisableBKColor="user5" Enable="FALSE" Height="20" Id="cb_dnd" INDEX="0" InnerDataset="ds_dnd" Left="244" Style="sty_ipt_form" TabOrder="19" Top="318" Width="100"></Combo>
		<Static Align="Right" Height="24" Id="st_dnd" Left="138" Style="sty_lb_form_basic" TabOrder="80" Text="DI-PBX&#32;종류&#32;" Top="317" VAlign="Middle" Width="105"></Static>
		<Checkbox BKColor="user5" DisableBKColor="user5" Height="20" Id="chk_dce" Left="117" OnClick="chk_dce_OnClick" Style="sty_ipt_form_chk" TabOrder="18" Top="319" Value="FALSE" Width="16"></Checkbox>
		<Static Align="Right" Height="24" Id="st_dce" Left="8" Style="sty_lb_form_basic" TabOrder="81" Text="DI-PBX&#32;통신료&#32;" Top="317" VAlign="Middle" Width="106"></Static>
		<Shape BKColor="user12" Bottom="366" Height="26" Id="Shape15" Left="7" LineColor="user13" Right="367" TabOrder="82" Top="340" Type="Rectangle" Width="360"></Shape>
		<Combo Border="Flat" CodeColumn="CODE" DataColumn="CODE_NAME" DisableBKColor="user5" Height="20" Id="cb_lts" INDEX="0" InnerDataset="ds_fms_cd" Left="218" Style="sty_ipt_form" TabOrder="22" Top="342" Width="80"></Combo>
		<Combo Border="Flat" CodeColumn="CODE" DataColumn="CODE_NAME" DisableBKColor="user5" Height="20" Id="cb_lty" INDEX="0" InnerDataset="ds_fmy_cd" Left="138" Style="sty_ipt_form" TabOrder="21" Top="342" Width="80"></Combo>
		<Checkbox BKColor="user5" DisableBKColor="user5" Height="20" Id="chk_ltc" Left="117" OnClick="chk_ltc_OnClick" Style="sty_ipt_form_chk" TabOrder="20" Top="343" Value="FALSE" Width="16"></Checkbox>
		<Static Align="Right" Height="24" Id="st_ltc" Left="8" Style="sty_lb_form_basic" TabOrder="83" Text="장기계약여부&#32;" Top="341" VAlign="Middle" Width="105"></Static>
		<Calendar Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DisableBKColor="user5" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_rgs_fm" Left="115" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="3" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="72" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="100"></Calendar>
		<Static Align="Center" Border="None" Color="user7" Font="굴림,9" Height="20" Id="Static7" Left="218" TabOrder="84" Text="~" Top="72" VAlign="Middle" Width="18"></Static>
		<Calendar Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DisableBKColor="user5" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_rgs_to" Left="238" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="4" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="72" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="102"></Calendar>
		<Static Align="Right" Height="24" Id="st_rgs" Left="8" Style="sty_lb_form_basic" TabOrder="86" Text="실계약기간&#32;" Top="70" VAlign="Middle" Width="105"></Static>
		<Shape BKColor="user12" Bottom="195" Height="26" Id="Shape17" Left="7" LineColor="user13" Right="367" TabOrder="90" Top="169" Type="Rectangle" Width="360"></Shape>
		<Static Align="Right" Height="24" Id="Static6" Left="8" Style="sty_lb_form_basic" TabOrder="91" Text="분담이행방식&#32;" Top="170" VAlign="Middle" Width="105"></Static>
		<Checkbox BKColor="user5" DisableBKColor="user5" Height="20" Id="chk_bdgbn" Left="117" OnClick="chk_bdgbn_OnClick" Style="sty_ipt_form_chk" TabOrder="9" Top="172" Value="FALSE" Width="16"></Checkbox>
		<Static Align="Right" Height="23" Id="Static8" Left="138" Style="sty_lb_form_basic" TabOrder="92" Text="당사관리비&#32;" Top="170" VAlign="Middle" Width="60"></Static>
		<MaskEdit Border="Flat" Enable="FALSE" Height="20" Id="med_amt" Left="200" OnChanged="med_amt_OnChanged" Style="sty_ipt_form" TabOrder="10" Top="171" Value="0" Width="80"></MaskEdit>
		<Static Align="Center" Border="None" Color="user7" Font="굴림,9" Height="20" Id="Static9" Left="282" TabOrder="92" Text="(부가세&#32;별도)" Top="171" VAlign="Middle" Width="82"></Static>
		<MaskEdit Border="Flat" Enable="FALSE" Height="20" Id="med_ambt" Left="400" Style="sty_ipt_form" TabOrder="92" Top="171" Value="0" Width="80"></MaskEdit>
		<Shape BKColor="user12" Bottom="220" Height="26" Id="Shape18" Left="7" LineColor="user13" Right="367" TabOrder="92" Top="194" Type="Rectangle" Width="360"></Shape>
		<Static Align="Right" Height="24" Id="Static10" Left="8" Style="sty_lb_form_basic" TabOrder="93" Top="195" VAlign="Middle" Width="105"></Static>
		<Static Align="Right" Height="23" Id="Static11" Left="112" Style="sty_lb_form_basic" TabOrder="94" Text="당사비율&#32;" Top="195" VAlign="Middle" Width="86"></Static>
		<Edit Align="RIGHT" Border="Flat" BorderColor="user13" Enable="FALSE" Height="20" Id="ed_rate" Left="200" TabOrder="95" Top="197" Width="80"></Edit>
		<Shape BKColor="user12" Bottom="540" Height="26" Id="Shape19" Left="7" LineColor="user13" Right="367" TabOrder="96" Top="514" Type="Rectangle" Width="360"></Shape>
		<Static Align="Right" Height="24" Id="Static12" Left="8" Style="sty_lb_form_basic" TabOrder="97" Text="공기청정기&#32;여부" Top="515" VAlign="Middle" Width="105"></Static>
		<MaskEdit Border="Flat" Enable="FALSE" Height="20" Id="med_acmt" Left="200" Style="sty_ipt_form" TabOrder="99" Top="518" Value="0" Width="80"></MaskEdit>
		<Static Align="Center" Border="None" Color="user7" Font="굴림,9" Height="20" Id="Static13" Left="282" TabOrder="100" Text="(부가세&#32;별도)" Top="519" VAlign="Middle" Width="82"></Static>
		<Checkbox BKColor="user5" DisableBKColor="user5" Height="20" Id="chk_acyn" Left="117" OnClick="chk_acyn_OnClick" Style="sty_ipt_form_chk" TabOrder="98" Top="519" Value="FALSE" Width="16"></Checkbox>
		<Static Align="Right" Height="24" Id="st_acmt" Left="138" Style="sty_lb_form_basic" TabOrder="101" Text="공급가액&#32;" Top="516" VAlign="Middle" Width="60"></Static>
		<Combo Border="Flat" CodeColumn="CODE" DataColumn="CODE_NAME" DisableBKColor="user5" Enable="FALSE" Height="20" Id="cb_acnd" INDEX="0" InnerDataset="ds_acnd" Left="400" Style="sty_ipt_form" TabOrder="102" Top="264" Width="100"></Combo>
	</Form>
	<Script><![CDATA[/*
 ******************************************************************************************
 * 기      능   : 
 * 작  성  자   : 
 * 작성  일자   : 
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
#include "LIB::commons.js";	// 공통 스크립트 
//=========================================================================================
// [ PART 1 ]
// Form에서 사용될 전역변수를 선언
// FORM에서 사용되는 전역변수는 대문자로 작성하며, F_XXX 의 형태를 갖도록 한다. 
//=========================================================================================
//var vAbg = "A";	// 빌딩구분 : A:아파트,  B: 그외
//var vFM  = "";  //FM 여부 : 1:FM, '' : POG
var vBdgRate = 1; // 직영 분담비율
var vKndYn   = "";
var vAbg     = "";
//=========================================================================================
// [ PART 2 ]
// Form Loading / Unloading 시 작업 정의
//=========================================================================================
function fn_OnLoadCompleted(obj) {
	// Form 로드 이벤트 맨 첫줄에 기술 
	gfn_initForm();
	
	ed_upn.value = upn;
	ed_cst.value = cst;
	ed_kind.value = kind;
	chk_bdgbn.Value = bdgbn;
	vKndYn = knd_yn;
	vAbg   = abg;
	if (gbu == "1"){
		chk_bdgbn.Enable = false;
	} else {
		if (hno == "J" || hno == "G"){
			chk_bdgbn.Enable = false;
		} else {
			chk_bdgbn.Enable = true;
		}
	}
	if (chk_bdgbn.Value == "1"){
		med_amt.Enable = true;
	} else {
		med_amt.Enable = false;
	}
//	cal_usd.value = gfn_getCurrDate();
//	cal_ugs_fm.value = gfn_getCurrDate();
//	cal_ugs_to.value = gfn_getCurrDate();

	ds_fmkind_cd.AddRow();
	ds_fmkind_cd.SetColumn(0, "CODE", "");
	ds_fmkind_cd.SetColumn(0, "CODE_NAME", "");

	var curYear = substr(gfn_getCurrDate(),0,4);
	fn_makeYear(curYear,-14,8);
	cb_fmy.SetFocus();


	var codeArr = ["CS129","CS179","CS180","CS185","CS_AIR_KND"];
	var dsObjArr = [ds_fmkind_cd,ds_hep_cd,ds_crs_cd,ds_gbn_cd,ds_acnd];
	var addTypeArr = [G_CODE_NONE,G_CODE_SELECT,G_CODE_NONE,G_CODE_SELECT,G_CODE_NONE];
	gfn_searchCommCode(codeArr, dsObjArr, addTypeArr);
	
	fn_searchHno();
}

/************************************************************************************
* 기      능   : 작업기간 계산(현재년도,당해년도에서 뺄 년수, 당해년도에서 더할 년수
************************************************************************************/
function fn_makeYear(curYear,sNum,eNum) {
	var rowCnt = eNum-sNum;
	var row = 0;

	for(var i=rowCnt; i>-1; i--) {
		ds_fmy_cd.AddRow();
		ds_fmy_cd.SetColumn(row,"CODE",parseInt(curYear)+i+parseInt(sNum));
		ds_fmy_cd.SetColumn(row,"CODE_NAME",(parseInt(curYear)+i+parseInt(sNum)));
		row++;
	}
}

/********************************************************************************
* 기      능   : 공통코드가 조회된 후의 Callback 함수 
********************************************************************************/
function fn_completeInit(sCode, sDsObj, sCodeType) {
//	cb_fmkind.index = 0;

	if(kind == "C") { //계약종류가 유상공사일 경우
		cb_fmkind.Enable = false;
		chk_fm.Enable = false;
		chk_rgb.Enable = false;
	} else if(kind == "D") { //계약종류가 유상일반일 경우
		cb_fmkind.Enable = false;
	}
	
	cb_fmy.Enable = false;
	cb_fms.Enable = false;
	cb_crs.Enable = false;
	med_rto.Enable = false;
	cal_can.Enable = false;	
	cb_lty.Enable = false;
	cb_lts.Enable = false;

	cb_hep.Index = 0;
	cb_hwr.Value = "";
	cb_dnd.Value = "";
	cb_fmy.Value = "";
	cb_fms.Value = "";
	cb_crs.Value = "";
	cb_gbn.Index = 0;
	cb_lty.Value = "";
	cb_lts.Value = "";
	
	//===========================공기청정기 추가 20200515 Han.JH====================================
	cb_acnd.Value = "";
	//==============================================================================================

	gfn_showMsg("CI00007");
}
/********************************************************************************
* 기      능   : form UnloadCompleted 
********************************************************************************/
function fn_OnUnloadCompleted(obj) {
	return gfn_isFormUnload(obj);
}
//=========================================================================================
// [ PART 3 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,form닫기)
//=========================================================================================
function fn_searchHno() {
	gfn_initDs(ds_code_cond, true);
	ds_code_cond.setColumn(0, "UPN", upn);
	ds_code_cond.setColumn(0, "CST", cst);

	tit_clearActionInfo();
	tit_addSearchActionInfo("cs12:CS1201001C_S1");

	tit_callService(
        ""
        , ""
        , "ds_cond=ds_code_cond"
        , "ds_hno=ds_list"
        , ""
        , "fn_afterSearchHno"
        , true);
}

/********************************************************************************
* 기      능   : 조회 1
********************************************************************************/
function fn_query() {

	tit_clearActionInfo();
	tit_addSearchActionInfo("mm04:MM0401001A_S1");
	
	tit_callService(
        ""
        , ""
        , "ds_cond=ds_cond"
        , "ds_list=ds_list"
        , ""
        , "fn_afterQuery"
        , true);
}
/********************************************************************************
* 기      능   : 삽입 20
********************************************************************************/
function fn_insert() {
	// 그리드에 row 추가 
	var newRow = gfn_addGridRow(grd_list, -1, "FLAG");
}
/********************************************************************************
* 기      능   : Delete 
********************************************************************************/
function fn_delete() {
	if ( ds_list.rowCount() < 1 ) {
		// 삭제할 정보 없음. 
		return;
	}
	
	// Grid 삭제 처리 
	gfn_deleteGridRow( grd_list, ds_list.row, "FLAG" );
}
/********************************************************************************
* 기      능   : 저장 
********************************************************************************/
function fn_save() {

}
/********************************************************************************
* 기      능   : 닫기  
********************************************************************************/
function fn_close() {
	close();
}
/********************************************************************************
* 기      능   : 액셀  
********************************************************************************/
function fn_excel() {
	// Excel Export 
	gfn_saveToExcel(grd_list, true );
}
/********************************************************************************
* 기      능   : 접수 5
********************************************************************************/
function fn_receipt() {

}
/********************************************************************************
* 기      능   : 승인 10
********************************************************************************/
function fn_approval() {

}
/********************************************************************************
* 기      능   : d결재 15
********************************************************************************/
function fn_decide() {

}
/********************************************************************************
* 기      능   : 취소 35
********************************************************************************/
function fn_cancel() {

}
/********************************************************************************
* 기      능   : print 40
********************************************************************************/
function fn_print() {

}
/********************************************************************************
* 기      능   : 발행 50
********************************************************************************/
function fn_out() {

}
/********************************************************************************
* 기      능   : 신청 55
********************************************************************************/
function fn_request() {

}
/********************************************************************************
* 기      능   : 전송 60
********************************************************************************/
function fn_trans() {

}
/********************************************************************************
* 기      능   : 반송 65
********************************************************************************/
function fn_sendback() {

}
/********************************************************************************
* 기      능   : 계산 70
********************************************************************************/
function fn_cal() {

}
/********************************************************************************
* 기      능   : 복사 75
********************************************************************************/
function fn_copy() {
	gfn_clearMsgBar();

	var t_pjt_fm = substr(cb_hno_fm.value,0,6);
	var t_pjt_to = substr(cb_hno_to.value,0,6);
	var t_hno_fm = substr(cb_hno_fm.value,7,3);
	var t_hno_to = substr(cb_hno_to.value,7,3);
	var hno_fm = cb_hno_fm.value;
	var hno_to = cb_hno_to.value;
	var usd = cal_usd.value;
	var ugs_fm = cal_ugs_fm.value;
	var ugs_to = cal_ugs_to.value;
	var rgs_fm = cal_rgs_fm.value; //실계약개시일
	var rgs_to = cal_rgs_to.value; //실계약만료일
	var fmkind = cb_fmkind.value;
	var fmy = cb_fmy.value;
	var fms = cb_fms.value;
	var chkfm = chk_fm.value;
	var chkcan = chk_can.value;
	var can_date = cal_can.value;
	var crs = cb_crs.value;
	var cur_date = gfn_getCurrDate();
	var hep = cb_hep.value;
	var gbn = cb_gbn.value;

	var chkltc = chk_ltc.value;
	var lty = cb_lty.value;
	var lts = cb_lts.value;
	
	if(chkcan == false) {
		if(length(hno_fm) == 0 || length(hno_to) == 0) {
			gfn_showMsg("CW00010");
			return;
		}

		if(length(usd) == 0) {
			var arr = [trim(st_usd.value)];
			gfn_showMsg("CW00001", arr);
			return;
		}

		if(length(ugs_fm) == 0) {
			var arr = [trim(st_ugs.value)];
			gfn_showMsg("CW00001", arr);
			return;
		}

		if(length(ugs_to) == 0) {
			var arr = [trim(st_ugs.value)];
			gfn_showMsg("CW00001", arr);
			return;
		}

		if(length(rgs_fm) == 0) {
			var arr = [trim(st_rgs.value)];
			gfn_showMsg("CW00001", arr);
			return;
		}

		if(length(rgs_to) == 0) {
			var arr = [trim(st_rgs.value)];
			gfn_showMsg("CW00001", arr);
			return;
		}

		if(chkltc == true && (length(lty) == 0 || length(lts) == 0)) {
			var arr = ["장기계약 연차"];
			gfn_showMsg("CW00001", arr);
			return;
		}

		if(length(hep) == 0) {
			var arr = [trim(st_hep.value)];
			gfn_showMsg("CW00001", arr);
			return;
		}

		if(hno_fm > hno_to) {
			gfn_showMsg("CW00012");
			return;
		}

		if(usd > ugs_fm) {
			var arr = [trim(st_usd.value), trim(st_ugs.value)];
			gfn_showMsg("CW00036", arr);
			return;
		}

		if(ugs_fm > ugs_to) {
			gfn_showMsg("CW00012");
			return;
		}

		if(rgs_fm > rgs_to) {
			gfn_showMsg("CW00012");
			return;
		}
		// 실계약기간 내에 유상계약기간 포함되어야 함 20141215 이하림
		if(ugs_fm < rgs_fm || ugs_to > rgs_to ) {
			gfn_showMsg("실계약기간과 유상계약기간을 확인하십시오.");
			return;
		}

		if(chkfm == true && length(fmkind) == 0) {
			var arr = [trim(st_fmkind.value)];
			gfn_showMsg("CW00001", arr);
			return;
		}

		if(chkfm == true && (length(fmy) == 0 || length(fms) == 0)) {
			var arr = [trim(st_fmy.value)];
			gfn_showMsg("CW00001", arr);
			return;
		}

		var ugs_flag = cal_UgsChk();
		var umr_flag = cal_UmrChk();

		if(ugs_flag == false) {
			var arr = [trim(st_ugs.value)];
			gfn_showMsg("CW00022", arr);
			return;
		}

		if(umr_flag == false) {
			var arr = [trim(st_ugs.value)];
			gfn_showMsg("CW00022", arr);
			return;
		}

		if(parseInt(med_rto.value) > 100) {
			var arr = [trim(st_rto.value)];
			gfn_showMsg("CW00118", arr);
			return;
		}

		if(length(trim(med_amt.Value)) == 0){
			var arr = [trim(st_amt.value)];
			gfn_showMsg("CW00001", arr);
			return;		
		}

		if(chk_hyn.value == true &&  med_hmt.Value == 0){
			var arr = ["HRTS "+trim(st_hmt.value)];
			gfn_showMsg("CW00001", arr);
			return;		
		}

		if(chk_dyn.value == true && med_dmt.Value == 0){
			var arr = ["DI-PBX "+trim(st_dmt.value)];
			gfn_showMsg("CW00001", arr);
			return;		
		}
		//===========================공기청정기 추가 20200515 Han.JH====================================
		if(chk_acyn.value == true && med_acmt.Value == 0){
			var arr = ["공기청정기여부 "+trim(st_acmt.value)];
			gfn_showMsg("CW00001", arr);
			return;		
		}
		if(chk_acyn.value == true && med_acmt.Value < 25000){
			gfn_showMsg("공기청정기 공급가는 25,000원 미만 일 수 없습니다.");
			return;
		}		
		//==============================================================================================
		if(chk_dce.value == true && med_dmt.Value == 0){
			var arr = ["DI-PBX "+trim(st_dmt.value)];
			gfn_showMsg("CW00001", arr);
			return;		
		}
	} else {
		if(length(can_date) == 0) {
			var arr = [trim(st_can_date.value)];
			gfn_showMsg("CW00001", arr);
			return;
		}

		if(length(crs) == 0) {
			var arr = [trim(st_crs.value)];
			gfn_showMsg("CW00001", arr);
			return;
		}
	}

	var g_cnt = parent.ds_list.RowCount();
	var g_amt = med_amt.value; 
	var g_ambt= med_ambt.value;
	var g_amtt= med_amtt.value;
	var g_hmt = med_hmt.value;
	var g_dmt = med_dmt.value;
	//===========================공기청정기 추가 20200515 Han.JH====================================
	var g_acmt = med_acmt.value;
	//==============================================================================================
	var g_sut = g_amt + g_hmt + g_dmt + g_acmt;	
	var g_vat = Truncate((g_sut / 10),0);
	var g_vabt = Truncate((g_ambt / 10),0);
	var g_vatt = Truncate(((g_sut + g_ambt) / 10),0);
	var g_tot = g_sut + g_vat;
	var g_tobt = g_sut + g_vabt;
	var g_tott = g_sut + g_ambt + g_vatt;
    var g_bdgbn = chk_bdgbn.Value;
    parent.chk_bdgbn.value = g_bdgbn;
    parent.copytool_flag = true; // 이전 보수협력사의 영업그룹을 구하기 위한 flag 변수 2020.06.15 Han JH
	parent.grd_list.Redraw = false;
	for(var i=0; i<g_cnt; i++) {
/*
		if(t_pjt_fm <= parent.ds_list.GetColumn(i, "PJT") && t_pjt_to >= parent.ds_list.GetColumn(i, "PJT")) {
			if(t_hno_fm <= parent.ds_list.GetColumn(i, "HNO") && t_hno_to >= parent.ds_list.GetColumn(i, "HNO")) {
				var g_chk = trim(parent.ds_list.GetColumn(i, "CHK"));
		
				if(g_chk == null || g_chk == '' || g_chk == false || g_chk == 0) {
					parent.ds_list.SetColumn(i, "CHK", true);
				}
				
				parent.ds_list.SetColumn(i, "USD", usd);
				parent.ds_list.SetColumn(i, "UGS", ugs_fm);
				parent.ds_list.SetColumn(i, "UMR", ugs_to);
				
				parent.ds_list.SetColumn(i, "TOT", g_tot);
				
				parent.ds_list.SetColumn(i, "RGB", chk_rgb.value);
				parent.ds_list.SetColumn(i, "KND_YN", chk_fm.value);
				parent.ds_list.SetColumn(i, "KND", cb_fmkind.value);
				parent.ds_list.SetColumn(i, "IYN", chk_iyn.value);
			}
		}
*/
		var s_dif, s_dibf, s_ditf;

		if(parent.ds_list.GetOrgColumn(i, "AMTT") > 0) {
			s_dif  = abs(ParseFloat(parent.ds_list.GetOrgColumn(i, "AMT")) - ParseFloat(med_amt.Value));
			s_dibf = abs(ParseFloat(parent.ds_list.GetOrgColumn(i, "AMBT")) - ParseFloat(med_ambt.Value));
			s_ditf = abs(ParseFloat(parent.ds_list.GetOrgColumn(i, "AMTT")) - ParseFloat(med_amtt.Value));
		} else {
			s_dif  = 0;
			s_dibf = 0;
			s_ditf = 0;
		}

		var p_hno = parent.ds_list.GetColumn(i, "PJT") + parent.ds_list.GetColumn(i, "HNO");
		var t_hno_s = t_pjt_fm + t_hno_fm;
		var t_hno_e = t_pjt_to + t_hno_to;
		var t_med_rto = 0;
		t_med_rto = med_rto.value;
		if(t_med_rto == "") t_med_rto = 0;

		if(t_hno_s <= p_hno && t_hno_e >= p_hno) {
			var g_chk = trim(parent.ds_list.GetColumn(i, "CHK"));
			if(g_chk == null || g_chk == '' || g_chk == false || g_chk == 0) {
				parent.ds_list.SetColumn(i, "CHK", true);
			}

			if(chkcan == true) { //중도해지여부 체크시
				parent.ds_list.SetColumn(i, "UMR", can_date);
				parent.ds_list.SetColumn(i, "CRS", cb_crs.value);
				parent.ds_list.SetColumn(i, "CRS_NM", cb_crs.text);
			} else {
				parent.ds_list.SetColumn(i, "USD", usd);
				parent.ds_list.SetColumn(i, "UGS", ugs_fm);
				parent.ds_list.SetColumn(i, "UMR", ugs_to);
				parent.ds_list.SetColumn(i, "RGS", rgs_fm);
				parent.ds_list.SetColumn(i, "RMR", rgs_to);
				parent.ds_list.SetColumn(i, "BDGBN", g_bdgbn);
				parent.ds_list.SetColumn(i, "AMTT", g_amtt);
				parent.ds_list.SetColumn(i, "AMT", g_amt);
				parent.ds_list.SetColumn(i, "AMBT", g_ambt);
				parent.ds_list.SetColumn(i, "RGB", chk_rgb.value);
				parent.ds_list.SetColumn(i, "RTO", t_med_rto);
				parent.ds_list.SetColumn(i, "KND_YN", chk_fm.value);
				parent.ds_list.SetColumn(i, "KND", cb_fmkind.value);
				parent.ds_list.SetColumn(i, "IYN", chk_iyn.value);
				parent.ds_list.SetColumn(i, "HYN", chk_hyn.value);
				parent.ds_list.SetColumn(i, "HEP", cb_hep.value);
				parent.ds_list.SetColumn(i, "HWR", cb_hwr.value);
				parent.ds_list.SetColumn(i, "DND", cb_dnd.value);
				parent.ds_list.SetColumn(i, "DYN", chk_dyn.value);
				parent.ds_list.SetColumn(i, "DCE", chk_dce.value); // DI-PBX 통신료 여부 
				parent.ds_list.SetColumn(i, "HMT", g_hmt);
				parent.ds_list.SetColumn(i, "DMT", g_dmt);
				parent.ds_list.SetColumn(i, "FMY", cb_fmy.value);
				parent.ds_list.SetColumn(i, "FMS", cb_fms.value);
				parent.ds_list.SetColumn(i, "CBN", cb_gbn.value);
				parent.ds_list.SetColumn(i, "DIF", s_dif);
				parent.ds_list.SetColumn(i, "LTC", chk_ltc.value); // 장기계약여부
				parent.ds_list.SetColumn(i, "LTY", cb_lty.value); // 장기계약연도
				parent.ds_list.SetColumn(i, "LTS", cb_lts.value); // 장기계약연차
				//===========================공기청정기 추가 20200515 Han.JH====================================
				parent.ds_list.SetColumn(i, "ACYN", chk_acyn.value); // 공기청정기 여부
				parent.ds_list.SetColumn(i, "ACND", cb_acnd.value); // 공기청정기 종류(A : 기본형)
				parent.ds_list.SetColumn(i, "ACMT", g_acmt); // 공기청정기 공급가액
				//==============================================================================================
			}
		}
	}
	
	parent.grd_list.Redraw = true;
	fn_close();
}
/********************************************************************************
* 기      능   : 확인 80
********************************************************************************/
function fn_confirm() {

}
//=========================================================================================
// [ PART 4]
// Callback 함수 정의 : callback 함수명은 메인 함수의 fn_xxxx() 에서 xxxx 부분은 fn_afterXXXX()
// 형태가 되도록 작성 
//=========================================================================================
function fn_afterSearchHno(errCode, errMsg) {
}

/********************************************************************************
* 기      능   : 조회 Callback  
********************************************************************************/
function fn_afterQuery(errCode, errMsg) {
	// 메시지 처리 
	gfn_showMsg("CI00002", ds_list.RowCount()+"");
}
/********************************************************************************
* 기      능   : 저장 Callback  
********************************************************************************/
function fn_afterSave(errCode, errMsg) {
	if ( errCode!= 0 ) {
		gfn_showMsg("CE00001");
	} else {
		gfn_showMsg("CI00003");
	}
}
//=========================================================================================
// [ PART 5 ]
// Detail Process Event 정의 ( User Define function )
// 사용자 정의 함수는 ufn_xxxx() 형태로 작성 
//=========================================================================================
/********************************************************************************
* 기      능   : 사용자 정의 함수  
********************************************************************************/
function ufn_userfunction() {

}

//=========================================================================================
// [ PART 6 ]
// component Event 정의 : 각 Component 별 이벤트 
//=========================================================================================
/********************************************************************************
* 기      능   : 그리드 헤더 클릭시 정렬 처리 
********************************************************************************/
function grd_list_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
{
	if ( nCell == 0 ) {
		// 그리드 표시할 컬럼 선택 
		gfn_selectGridCol(obj);
	} else {
		// 그리드 정렬 처리 
		gfn_sortGrid(obj,nCell);
	}
}
/********************************************************************************
* 기      능   : 데이터셋 값 변경 시 - Flag 처리 
********************************************************************************/
function ds_list_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{
	gfn_changeFlag( obj, strColumnID, nRow, "FLAG" );
}

function chk_fm_OnClick(obj,strValue)
{
	if(obj.value == true) {
		cb_fmkind.Enable = true;
		cb_fmkind.Enable = true;
		cb_fmy.Enable = true;
		cb_fmy.index = 0;
		cb_fms.Enable = true;
		chk_rgb.value = 0;
		chk_rgb.Enable = false;
		med_rto.Enable = false;
		med_rto.value = "";
		cb_crs.value = "";

		cb_fmy.Value = substr(gfn_getCurrDate(),0,4);
		vKndYn = "1";
	} else {
		cb_fmkind.value = "";
		cb_fmkind.Enable = false;
		cb_fmy.value = "";
		cb_fmy.Enable = false;
		cb_fms.value = "";
		cb_fms.Enable = false;
		chk_rgb.Enable = true;
		med_rto.Enable = true;

		cb_fmy.Value = "";
		vKndYn = "0";
	}
	med_amtt_OnChanged();
}

/********************************************************************************
* 기      능   : 달력에서 일자 선택했을 경우 
********************************************************************************/
function cal_UgsChk()
{
	gfn_clearMsgBar();

	var flag_ugs = false;
	var str_usd = cal_usd.value;
	var str_usd_yymm = substr(cal_usd.value,0,6);
	var str_usd_mm = substr(cal_usd.value,4,2);
	var str_usd_day = substr(cal_usd.value,6,2);
	var str_ugs = cal_ugs_fm.value;
	var str_ugs_yymm = substr(str_ugs,0,6);
	var str_ugs_mm = substr(str_ugs,4,2);
	var str_ugs_day = substr(str_ugs,6,2);
	var str_ugs_lastday = gfn_getLastDayByStr(substr(str_ugs,0,6));

	if(parseInt(str_usd <= str_ugs)) {
		flag_ugs = true;
	} else {
		flag_ugs = false;
	}

	if(gfn_getMonthCnt(str_ugs, cal_ugs_to.value) > 12) {
		flag_ugs = false;
	}

	if(flag_ugs) {
		cal_ugs_fm.value = str_ugs;
		return true;
	} else {
		return false;
	}
}

function cal_UmrChk()
{
	gfn_clearMsgBar();

	var flag_umr = false;
	var str_ugs = cal_ugs_fm.value;
	var str_ugs_yymm = substr(cal_ugs_fm.value,0,6);
	var str_ugs_mm = substr(cal_ugs_fm.value,4,2);
	var str_ugs_day = substr(cal_ugs_fm.value,6,2);
	var str_umr = cal_ugs_to.value;
	var str_umr_after = gfn_getAfterDate(str_umr, 1);
	var str_umr_yymm = substr(str_umr_after,0,6);
	var str_umr_mm = substr(str_umr_after,4,2);
	var str_umr_day = substr(str_umr_after,6,2);
	var str_umr_lastday = gfn_getLastDayByStr(substr(str_umr,0,6));

	if(parseInt(str_ugs <= str_umr)) {
		if(parseInt(str_ugs_day) == parseInt(str_umr_day)) {
			flag_umr = true;
		} else {
			if(str_ugs_mm < str_umr_mm && str_ugs_day >= 28) {
				if(parseInt(str_umr_day) == parseInt(str_umr_lastday)) {
					if(parseInt(str_ugs_day) == parseInt(substr(str_umr,6,2))) {
						flag_umr = false;
					} else {
						flag_umr = true;
					}
				} else {
					if(substr(str_umr,4,2) == '02') {
						if(parseInt(substr(str_umr,6,2)) == parseInt(str_umr_lastday)) {
							flag_umr = true;
						} else {
							flag_umr = false;
						}
					} else {
						flag_ugs = false;
					}
				}
			} else {
				flag_umr = false;
			}
			if(substr(str_umr,4,2) <> '02' && str_ugs_day < substr(str_umr,6,2)) {
				flag_umr = false;
			}
			// 계약기간이 개월수 미만인 경우 20170626 
			if(str_ugs < str_umr) {
				flag_umr = true; 
			}
		}
	} else {
		flag_umr = false;
	}

	if(gfn_getMonthCnt(str_ugs, str_umr) > 12) {
		flag_umr = false;
	}

	if(flag_umr) {
		if(substr(str_umr,4,2) == '02') {
			cal_ugs_to.value = substr(str_umr,0,6) + str_umr_lastday;
		} else {
			cal_ugs_to.value = str_umr;
		}
		
		return true;
	} else {
		return false;
	}
}

function chk_rgb_OnClick(obj,strValue)
{
	if(obj.value == true) {
		med_rto.Enable = true;
	} else {
		med_rto.Enable = false;
		med_rto.value = "";
	}
}

function med_rto_OnKillFocus(obj)
{
	gfn_clearMsgBar();
	
	if(parseInt(obj.value) > 100) {
		var arr = [st_rto.value];
		gfn_showMsg("CW00118", arr);
		return;
	}
}

function chk_can_OnClick(obj,strValue)
{
	if(obj.value == true) {
		cal_can.Enable = true;
		cb_crs.Enable = true;
		cal_usd.Enable = false;
		cal_ugs_fm.Enable = false;
		cal_ugs_to.Enable = false;
		cal_rgs_fm.Enable = false;
		cal_rgs_to.Enable = false;
		med_amt.Enable = false;
		chk_fm.Enable = false;
		chk_fm.Value = "";
		cb_fmkind.Enable = false;
		cb_fmy.Enable = false;
		cb_fms.Enable = false;
		chk_rgb.Enable = false;
		med_rto.Enable = false;
		chk_iyn.Enable = false;
		chk_hyn.Enable = false;
		chk_dyn.Enable = false;
		//===========================공기청정기 추가 20200515 Han.JH====================================
		chk_acyn.Enable = false;
		//==============================================================================================
	} else {
		cal_can.Enable = false;
		cb_crs.Enable = false;
		cal_usd.Enable = true;
		cal_ugs_fm.Enable = true;
		cal_ugs_to.Enable = true;
		cal_rgs_fm.Enable = true;
		cal_rgs_to.Enable = true;
		med_amt.Enable = true;
		chk_fm.Enable = true;
//		cb_fmkind.Enable = true;
//		cb_fmy.Enable = true;
//		cb_fms.Enable = true;
		chk_rgb.Enable = true;
		med_rto.Enable = true;
		chk_iyn.Enable = true;
		chk_hyn.Enable = true;
		chk_dyn.Enable = true;
		cb_crs.Value = "";
		//===========================공기청정기 추가 20200515 Han.JH====================================
		chk_acyn.Enable = true;
		//==============================================================================================
	}
}

function chk_hyn_OnClick(obj,strValue)
{
	if(obj.value == true) {
		med_hmt.Enable = true;
//		cb_hep.Enable = true;
//		cb_hep.Index = 0;
		cb_hwr.Enable = true;
		cb_hwr.Index = 1;
		chk_ltc.Value = true;
		chk_ltc.Enable = false;
		cb_lty.Enable = true;
		cb_lts.Enable = true;	
		cb_lty.Value = substr(gfn_getCurrDate(),0,4);
	} else {
		med_hmt.Value = "";
		med_hmt.Enable = false;
//		cb_hep.Enable = false;
//		cb_hep.Value = "";
		cb_hwr.Enable = false;
		cb_hwr.Value = "";
		
		if(chk_dyn.Value == false){	
			chk_ltc.Value = false;
			chk_ltc.Enable = true;
			cb_lty.Enable = false;
			cb_lts.Enable = false;
			cb_lty.Value = "";
			cb_lts.Value = "";
		}
	}
}

function chk_dyn_OnClick(obj,strValue)
{
	if(obj.value == true) {
		med_dmt.Enable = true;
		cb_dnd.Enable = true;
		cb_dnd.Index = 0;
		chk_ltc.Value = true;
		chk_ltc.Enable = false;
		cb_lty.Enable = true;
		cb_lts.Enable = true;	
		cb_lty.Value = substr(gfn_getCurrDate(),0,4);
		med_dmt.Value = 0;
		chk_dce.Value = false;
	} else {
		med_dmt.Value = "";
		med_dmt.Enable = false;
		cb_dnd.Enable = false;
		cb_dnd.Value = "";
		chk_dce.Enable = true;
		
		if(chk_hyn.Value == false){
			chk_ltc.Value = false;
			chk_ltc.Enable = true;	
			cb_lty.Enable = false;
			cb_lts.Enable = false;
			cb_lty.Value = "";
			cb_lts.Value = "";
		}
	}
}
//===========================공기청정기 추가 20200515 Han.JH====================================
function chk_acyn_OnClick(obj,strValue)
{
	if(obj.value == true) {
		med_acmt.Enable = true;
		med_acmt.Value = 0;
		cb_acnd.Enable = true;
		cb_acnd.Index = 0;		
	} else {
		med_acmt.Value = "";
		med_acmt.Enable = false;
		cb_acnd.Enable = false;
		cb_acnd.Value = "";		
	}
}
//==============================================================================================
function chk_ltc_OnClick(obj,strValue)
{
	if(obj.value == true) {
		cb_lty.Enable = true;
		cb_lts.Enable = true;	
		cb_lty.Value = substr(gfn_getCurrDate(),0,4);
	} else {
		cb_lty.Enable = false;
		cb_lts.Enable = false;
		cb_lty.Value = "";
		cb_lts.Value = "";
	}	
}
function chk_dce_OnClick(obj,strValue)
{
	if(obj.value == true) {
		med_dmt.Enable = true;
		med_dmt.Value = 0;
		cb_dnd.Enable = false;
		cb_dnd.Value = "";
		chk_dyn.Value = false;
		
		if(chk_hyn.Value == false and chk_dce.Value == false ){
			chk_ltc.Value = false;
			chk_ltc.Enable = false;	
			cb_lty.Enable = false;
			cb_lts.Enable = false;
			cb_lty.Value = "";
			cb_lts.Value = "";
		}
	} else {
		med_dmt.Value = "";
		med_dmt.Enable = false;
		
		if(chk_hyn.Value == false and chk_dce.Value == false ){
			chk_ltc.Value = false;
			chk_ltc.Enable = false;	
			cb_lty.Enable = false;
			cb_lts.Enable = false;
			cb_lty.Value = "";
			cb_lts.Value = "";
		}
	}	
}

function med_amtt_OnChanged(obj,strText)
{
	vBdgRate = gfn_bdgbnRate(chk_bdgbn.Value, vKndYn, vAbg);

	if (chk_bdgbn.Value == "1"){
		med_amt.Enable = true;
		med_amt.Value = ceil(toNumber(med_amtt.Value) * vBdgRate);
		med_ambt.Value= toNumber(med_amtt.Value) - toNumber(med_amt.Value);
		ed_rate.value = (vBdgRate * 100) + "%";
	} else {
		med_amt.Enable = false;
		med_amt.Value = toNumber(med_amtt.Value);
		med_ambt.Value= 0;
		ed_rate.value =  "100%";
	}
}

function chk_bdgbn_OnClick(obj,strValue)
{
	med_amtt_OnChanged();
}

function med_amt_OnChanged(obj,strText)
{
	med_ambt.Value= toNumber(med_amtt.Value) - toNumber(med_amt.Value);
	var vRate = round(toNumber(med_amt.Value) / toNumber(med_amtt.Value) * 100);
	ed_rate.Value = vRate + "%";
}

// function fn_calRate()
// {
    // if (vKndYn == "1"){
		// vBdgRate = 0.47;
    // } else {
		// if (vAbg == "A"){
			// vBdgRate = 0.2;
		// } else {
			// vBdgRate = 0.3;
		// }
    // }
// }]]></Script>
</Window>