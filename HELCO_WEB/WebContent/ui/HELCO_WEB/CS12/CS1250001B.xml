<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="532" Id="st_fdt" Left="8" OnLoadCompleted="fn_OnLoadCompleted" OnUnloadCompleted="fn_OnUnloadCompleted" PidAttrib="7" Title="DI-PBX&#32;견적상세" Top="8" Ver="1.0" Width="778" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_cond2">
				<Contents>
					<colinfo id="GBN" size="256" type="STRING"/>
					<colinfo id="TEM" size="256" type="STRING"/>
					<colinfo id="RDT" size="256" type="STRING"/>
					<colinfo id="SEQ" size="256" type="STRING"/>
					<colinfo id="SIR" size="256" type="STRING"/>
					<record>
						<GBN></GBN>
						<RDT></RDT>
						<SEQ></SEQ>
						<SIR></SIR>
						<TEM></TEM>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_knd">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_head">
				<Contents>
					<colinfo id="ETN" size="256" summ="default" type="STRING"/>
					<colinfo id="SIR" size="256" summ="default" type="STRING"/>
					<colinfo id="PST" size="256" summ="default" type="STRING"/>
					<colinfo id="PST_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="MDT" size="256" summ="default" type="STRING"/>
					<colinfo id="MID" size="256" summ="default" type="STRING"/>
					<colinfo id="MID_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="CDT" size="256" summ="default" type="STRING"/>
					<colinfo id="NAM" size="256" summ="default" type="STRING"/>
					<colinfo id="SPT" size="256" summ="default" type="STRING"/>
					<colinfo id="ADR" size="256" summ="default" type="STRING"/>
					<colinfo id="PJT" size="256" summ="default" type="STRING"/>
					<colinfo id="TEM" size="256" summ="default" type="STRING"/>
					<colinfo id="BSU" size="256" summ="default" type="STRING"/>
					<colinfo id="SPC" size="256" summ="default" type="STRING"/>
					<colinfo id="HNT" size="256" summ="default" type="STRING"/>
					<colinfo id="KND" size="256" summ="default" type="STRING"/>
					<colinfo id="SNT" size="256" summ="default" type="STRING"/>
					<colinfo id="JMT" size="256" summ="default" type="STRING"/>
					<colinfo id="SMT" size="256" summ="default" type="STRING"/>
					<colinfo id="GMT" size="256" summ="default" type="STRING"/>
					<colinfo id="NMT" size="256" summ="default" type="STRING"/>
					<colinfo id="CMT" size="256" summ="default" type="STRING"/>
					<colinfo id="AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="VAT" size="256" summ="default" type="STRING"/>
					<colinfo id="TOT" size="256" summ="default" type="STRING"/>
					<record>
						<ADR></ADR>
						<AMT></AMT>
						<BSU></BSU>
						<CDT></CDT>
						<CMT></CMT>
						<ETN></ETN>
						<GMT></GMT>
						<HNT></HNT>
						<JMT></JMT>
						<KND></KND>
						<MDT></MDT>
						<MID></MID>
						<MID_NM></MID_NM>
						<NAM></NAM>
						<NMT></NMT>
						<PJT></PJT>
						<PST></PST>
						<PST_NM></PST_NM>
						<SIR></SIR>
						<SMT></SMT>
						<SNT></SNT>
						<SPC></SPC>
						<SPT></SPT>
						<TEM></TEM>
						<TOT></TOT>
						<VAT></VAT>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list2" OnColumnChanged="ds_list2_OnColumnChanged">
				<Contents>
					<colinfo id="ETN" size="256" summ="default" type="STRING"/>
					<colinfo id="SIR" size="256" summ="default" type="STRING"/>
					<colinfo id="PJT" size="256" summ="default" type="STRING"/>
					<colinfo id="HNO" size="256" summ="default" type="STRING"/>
					<colinfo id="UPN" size="256" summ="default" type="STRING"/>
					<colinfo id="TEM" size="256" summ="default" type="STRING"/>
					<colinfo id="SPC" size="256" summ="default" type="STRING"/>
					<colinfo id="SPC2" size="256" summ="default" type="STRING"/>
					<colinfo id="FLR" size="256" summ="default" type="STRING"/>
					<colinfo id="ACD" size="256" summ="default" type="STRING"/>
					<colinfo id="ENT" size="256" summ="default" type="STRING"/>
					<colinfo id="ENT2" size="256" summ="default" type="STRING"/>
					<colinfo id="EMT" size="256" summ="default" type="STRING"/>
					<colinfo id="LNT" size="256" summ="default" type="STRING"/>
					<colinfo id="LMT" size="256" summ="default" type="STRING"/>
					<colinfo id="CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="CNT2" size="256" summ="default" type="STRING"/>
					<colinfo id="CMT" size="256" summ="default" type="STRING"/>
					<colinfo id="KNT" size="256" summ="default" type="STRING"/>
					<colinfo id="KMT" size="256" summ="default" type="STRING"/>
					<colinfo id="ZMT" size="256" summ="default" type="STRING"/>
					<colinfo id="TOT" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_308">
				<Contents>
					<colinfo id="KND" size="256" summ="default" type="STRING"/>
					<colinfo id="EXC" size="256" summ="default" type="STRING"/>
					<colinfo id="LPP" size="256" summ="default" type="STRING"/>
					<colinfo id="CPP" size="256" summ="default" type="STRING"/>
					<colinfo id="KEP" size="256" summ="default" type="STRING"/>
					<colinfo id="SMA" size="256" summ="default" type="STRING"/>
					<colinfo id="SMB" size="256" summ="default" type="STRING"/>
					<colinfo id="JJT" size="256" summ="default" type="STRING"/>
					<colinfo id="WAG" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_309">
				<Contents>
					<colinfo id="FLR" size="256" summ="default" type="STRING"/>
					<colinfo id="COS" size="256" summ="default" type="STRING"/>
					<colinfo id="PRC" size="256" summ="default" type="STRING"/>
					<colinfo id="ENM" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
		</Datasets>
		<Shape BKColor="user12" Bottom="66" Height="26" Id="Shape1" Left="7" LineColor="user13" Right="769" TabOrder="4" Top="40" Type="Rectangle" Width="762"></Shape>
		<Shape BKColor="user12" Bottom="91" Height="26" Id="Shape2" Left="7" LineColor="user13" Right="769" TabOrder="5" Top="65" Type="Rectangle" Width="762"></Shape>
		<Shape BKColor="user12" Bottom="166" Height="26" Id="Shape4" Left="7" LineColor="user13" Right="769" TabOrder="19" Top="140" Type="Rectangle" Width="762"></Shape>
		<Shape BKColor="user12" Bottom="116" Height="26" Id="Shape0" Left="7" LineColor="user13" Right="769" TabOrder="14" Top="90" Type="Rectangle" Width="762"></Shape>
		<Shape BKColor="user12" Bottom="141" Height="26" Id="Shape3" Left="7" LineColor="user13" Right="769" TabOrder="18" Top="115" Type="Rectangle" Width="762"></Shape>
		<Grid AutoEnter="TRUE" AutoFitEndLine="Hide" BindDataset="ds_list2" BkColor2="default" BoldHead="true" Border="Flat" Bottom="525" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="277" Id="grd_list2" InputPanel="FALSE" Left="8" LineColor="user20" LineType="ExHORZ" OnFocus="grd_list2_OnFocus" Right="770" RowHeight="20" Style="sty_grid" TabOrder="1" TabStop="true" Top="248" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="762">
			<contents>
				<format id="Default">
					<columns>
						<col width="30"/>
						<col width="50"/>
						<col width="50"/>
						<col width="40"/>
						<col width="60"/>
						<col width="110"/>
						<col width="80"/>
						<col width="40"/>
						<col width="80"/>
						<col width="40"/>
						<col width="80"/>
						<col width="40"/>
						<col width="80"/>
						<col width="40"/>
						<col width="80"/>
						<col width="80"/>
						<col width="90"/>
					</columns>
					<head>
						<cell align="center" col="0" color="user21" display="text" font="굴림,9" rowspan="2" text="No"/>
						<cell align="center" col="1" color="user21" display="text" font="굴림,9" rowspan="2" text="통합PJT"/>
						<cell align="center" col="2" color="user21" display="text" font="굴림,9" rowspan="2" text="원PJT"/>
						<cell align="center" col="3" color="user21" display="text" font="굴림,9" rowspan="2" text="호기"/>
						<cell align="center" col="4" color="user21" display="text" font="굴림,9" rowspan="2" text="전기기종"/>
						<cell align="center" col="5" color="user21" display="text" font="굴림,9" rowspan="2" text="사양"/>
						<cell align="center" col="6" color="user21" display="text" font="굴림,9" rowspan="2" text="EN-TYPE"/>
						<cell align="center" col="7" color="user21" colspan="2" display="text" font="굴림,9" text="교환기"/>
						<cell align="center" col="9" color="user21" colspan="2" display="text" font="굴림,9" text="LP-OPB&#32;Phone"/>
						<cell align="center" col="11" color="user21" colspan="2" display="text" font="굴림,9" text="CP&#32;Phone"/>
						<cell align="center" col="13" color="user21" colspan="2" display="text" font="굴림,9" text="Key&#32;Phone"/>
						<cell align="center" col="15" color="user21" display="text" font="굴림,9" rowspan="2" text="잡자재비"/>
						<cell align="center" col="16" color="user21" display="text" font="굴림,9" rowspan="2" text="합계"/>
						<cell align="center" col="7" color="user21" display="text" font="굴림,9" row="1" text="수량"/>
						<cell align="center" col="8" color="user21" display="text" font="굴림,9" row="1" text="금액"/>
						<cell align="center" col="9" color="user21" display="text" font="굴림,9" row="1" text="수량"/>
						<cell align="center" col="10" color="user21" display="text" font="굴림,9" row="1" text="금액"/>
						<cell align="center" col="11" color="user21" display="text" font="굴림,9" row="1" text="수량"/>
						<cell align="center" col="12" color="user21" display="text" font="굴림,9" row="1" text="금액"/>
						<cell align="center" col="13" color="user21" display="text" font="굴림,9" row="1" text="수량"/>
						<cell align="center" col="14" color="user21" display="text" font="굴림,9" row="1" text="금액"/>
					</head>
					<body>
						<cell align="center" bkcolor2="user22" col="0" display="text" expr="currow+1"/>
						<cell align="center" bkcolor2="user22" col="1" colid="UPN" combodisplayrowcnt="6" display="text"/>
						<cell align="center" bkcolor2="user22" col="2" colid="PJT" combodisplayrowcnt="6" display="text"/>
						<cell align="center" bkcolor2="user22" col="3" colid="HNO" display="text"/>
						<cell align="center" bkcolor2="user22" col="4" colid="SPC" display="text"/>
						<cell bkcolor2="user22" col="5" colid="SPC2" display="text"/>
						<cell align="center" bkcolor2="user22" col="6" colid="ACD" display="text" limit="3"/>
						<cell align="right" bkcolor2="user22" col="7" colid="ENT" display="number" edit="expr:iif(currow&#32;==&#32;0,&#32;&apos;number&apos;,&#32;&apos;none&apos;)" limit="2"/>
						<cell align="right" bkcolor2="user22" col="8" colid="EMT" display="number" limit="10"/>
						<cell align="right" bkcolor2="user22" col="9" colid="LNT" display="number" edit="number" limit="2"/>
						<cell align="right" bkcolor2="user22" col="10" colid="LMT" display="number" limit="10"/>
						<cell align="right" bkcolor2="user22" col="11" colid="CNT" display="number" edit="number" limit="2"/>
						<cell align="right" bkcolor2="user22" col="12" colid="CMT" display="number" limit="10"/>
						<cell align="right" bkcolor2="user22" col="13" colid="KNT" display="number" edit="number" limit="2"/>
						<cell align="right" bkcolor2="user22" col="14" colid="KMT" display="number" limit="10"/>
						<cell align="right" bkcolor2="user22" col="15" colid="ZMT" display="number" edit="number" limit="10"/>
						<cell align="right" bkcolor2="user22" col="16" colid="TOT" display="number" expr="ParseCurrency(EMT)+ParseCurrency(LMT)+ParseCurrency(CMT)+ParseCurrency(KMT)+ParseCurrency(ZMT)"/>
					</body>
					<summary>
						<cell align="center" bkcolor="user25" col="0" color="user26" colspan="7" display="text" font="굴림,9" text="합&#32;계"/>
						<cell align="right" bkcolor="user25" col="7" color="user26" display="number" expr='sum(&quot;ENT&quot;)'/>
						<cell align="right" bkcolor="user25" col="8" color="user26" display="number" expr='sum(&quot;EMT&quot;)'/>
						<cell align="right" bkcolor="user25" col="9" color="user26" display="number" expr='sum(&quot;LNT&quot;)'/>
						<cell align="right" bkcolor="user25" col="10" color="user26" display="number" expr='sum(&quot;LMT&quot;)'/>
						<cell align="right" bkcolor="user25" col="11" color="user26" display="number" expr='sum(&quot;CNT&quot;)'/>
						<cell align="right" bkcolor="user25" col="12" color="user26" display="number" expr='sum(&quot;CMT&quot;)'/>
						<cell align="right" bkcolor="user25" col="13" color="user26" display="number" expr='sum(&quot;KNT&quot;)'/>
						<cell align="right" bkcolor="user25" col="14" color="user26" display="number" expr='sum(&quot;KMT&quot;)'/>
						<cell align="right" bkcolor="user25" col="15" color="user26" display="number" expr='sum(&quot;ZMT&quot;)'/>
						<cell align="right" bkcolor="user25" col="16" color="user26" display="number" expr='sum(&quot;EMT&quot;)+sum(&quot;LMT&quot;)+sum(&quot;CMT&quot;)+sum(&quot;KMT&quot;)+sum(&quot;ZMT&quot;)'/>
					</summary>
				</format>
			</contents>
		</Grid>
		<Div Height="36" Id="div_btn" TabOrder="2" Text="Div0" Url="WB01::CommBtnForm.xml" Width="778">
			<Contents></Contents>
		</Div>
		<Calendar Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="146" Id="cal_temp" Left="784" MonthOnly="TRUE" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" OnChanged="cal_temp_OnChanged" OnDayClick="cal_temp_OnDayClick" OnKillFocus="cal_temp_OnKillFocus" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="3" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="172" Value="20130101" Visible="FALSE" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="152"></Calendar>
		<Static Align="Right" Height="24" Id="st_etn" Left="8" Style="sty_lb_form_basic" TabOrder="6" Text="견적번호&#32;" Top="41" VAlign="Middle" Width="95"></Static>
		<Static Align="Right" Height="24" Id="st_mdt" Left="8" Style="sty_lb_form_basic" TabOrder="8" Text="견적작성일&#32;" Top="66" VAlign="Middle" Width="95"></Static>
		<Static Align="Right" Height="24" Id="st_midnm" Left="261" Style="sty_lb_form_basic" TabOrder="9" Text="견적작성자&#32;" Top="66" VAlign="Middle" Width="95"></Static>
		<Edit BindDataset="ds_head" Border="Flat" Column="ETN" Enable="FALSE" Height="20" Id="ed_etn" Left="105" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="7" Top="43" Width="150"></Edit>
		<Edit BindDataset="ds_head" Border="Flat" Column="SPT" Height="20" Id="ed_spt" Left="358" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="13" Top="93" Width="150"></Edit>
		<Static Align="Right" Height="24" Id="st_spt" Left="261" Style="sty_lb_form_basic" TabOrder="12" Text="현장명&#32;" Top="91" VAlign="Middle" Width="95"></Static>
		<Edit BindDataset="ds_head" Border="Flat" Column="NAM" Height="20" Id="ed_nam" Left="105" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="11" Top="93" Width="150"></Edit>
		<Static Align="Right" Height="24" Id="st_nam" Left="8" Style="sty_lb_form_basic" TabOrder="10" Text="고객명&#32;" Top="91" VAlign="Middle" Width="95"></Static>
		<Static Align="Right" Height="24" Id="st_adr" Left="8" Style="sty_lb_form_basic" TabOrder="15" Text="현장주소&#32;" Top="116" VAlign="Middle" Width="95"></Static>
		<Edit BindDataset="ds_head" Border="Flat" CheckLength="Byte" Column="ADR" Height="20" Id="ed_adr" Left="105" LeftMargin="4" MaxLength="100" Style="sty_ipt_form" TabOrder="16" Top="118" Width="403"></Edit>
		<Calendar BindDataset="ds_head" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="MDT" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Enable="FALSE" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_mdt" Left="105" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="17" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="68" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="150"></Calendar>
		<Static Align="Right" Height="24" Id="st_pstnm" Left="515" Style="sty_lb_form_basic" TabOrder="20" Text="진행상태&#32;" Top="41" VAlign="Middle" Width="95"></Static>
		<Edit BindDataset="ds_head" Border="Flat" Column="PST_NM" Enable="FALSE" Height="20" Id="ed_pstnm" Left="612" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="21" Top="43" Width="150"></Edit>
		<Edit BindDataset="ds_head" Border="Flat" Column="MID_NM" Enable="FALSE" Height="20" Id="ed_midnm" Left="358" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="22" Top="68" Width="150"></Edit>
		<Static Align="Right" Height="24" Id="st_sir" Left="261" Style="sty_lb_form_basic" TabOrder="23" Text="차수&#32;" Top="41" VAlign="Middle" Width="95"></Static>
		<Edit BindDataset="ds_head" Border="Flat" Column="SIR" Enable="FALSE" Height="20" Id="ed_sir" ImeMode="none" Left="358" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="24" Top="43" Width="150"></Edit>
		<Static Align="Right" Height="24" Id="st_cdt" Left="515" Style="sty_lb_form_basic" TabOrder="25" Text="계약예정일&#32;" Top="66" VAlign="Middle" Width="95"></Static>
		<Calendar BindDataset="ds_head" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="CDT" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_cdt" Left="612" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="26" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="68" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="150"></Calendar>
		<Static Align="Right" Height="24" Id="st_prd" Left="8" Style="sty_lb_form_basic" TabOrder="27" Text="판매상품&#32;" Top="141" VAlign="Middle" Width="95"></Static>
		<Combo BindDataset="ds_head" Border="Flat" CodeColumn="CODE" Column="KND" DataColumn="CODE_NAME" Height="20" Id="cb_knd" InnerDataset="ds_knd" Left="104" OnChanged="cb_knd_OnChanged" Style="sty_ipt_form" TabOrder="28" Top="142" Width="153"></Combo>
		<Static Align="Right" Height="24" Id="st_pjt" Left="515" Style="sty_lb_form_basic" TabOrder="29" Text="프로젝트&#32;" Top="91" VAlign="Middle" Width="95"></Static>
		<Edit BindDataset="ds_head" Border="Flat" Column="PJT" Height="20" Id="ed_pjt" Left="612" LeftMargin="4" MaxLength="6" Number="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="30" Top="93" Width="150"></Edit>
		<Static Align="Right" Height="24" Id="st_spc" Left="515" Style="sty_lb_form_basic" TabOrder="31" Text="기종&#32;" Top="116" VAlign="Middle" Width="95"></Static>
		<Edit BindDataset="ds_head" Border="Flat" Column="SPC" Height="20" Id="ed_spc" Left="612" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="32" Top="118" Width="150"></Edit>
		<Static Align="Right" Height="24" Id="st_snt" Left="261" Style="sty_lb_form_basic" TabOrder="33" Text="경비실개소&#32;" Top="141" VAlign="Middle" Width="95"></Static>
		<Shape BKColor="user12" Bottom="191" Height="26" Id="Shape5" Left="7" LineColor="user13" Right="769" TabOrder="34" Top="165" Type="Rectangle" Width="762"></Shape>
		<Shape BKColor="user12" Bottom="216" Height="26" Id="Shape6" Left="7" LineColor="user13" Right="769" TabOrder="35" Top="190" Type="Rectangle" Width="762"></Shape>
		<Shape BKColor="user12" Bottom="241" Height="26" Id="Shape7" Left="7" LineColor="user13" Right="769" TabOrder="36" Top="215" Type="Rectangle" Width="762"></Shape>
		<MaskEdit BindDataset="ds_head" Border="Flat" Column="SNT" Height="20" Id="med_snt" Left="358" MaxLength="2" OnChanged="med_snt_OnChanged" RightMargin="3" Style="sty_ipt_form" TabOrder="37" Top="143" Width="150"></MaskEdit>
		<Static Align="Right" Height="24" Id="st_jmt" Left="8" Style="sty_lb_form_basic" TabOrder="38" Text="자재판매가&#32;" Top="166" VAlign="Middle" Width="95"></Static>
		<MaskEdit BindDataset="ds_head" Border="Flat" Column="JMT" Enable="FALSE" Height="20" Id="med_jmt" Left="105" MaxLength="10" RightMargin="3" Style="sty_ipt_form" TabOrder="39" Top="168" Width="150"></MaskEdit>
		<MaskEdit BindDataset="ds_head" Border="Flat" Column="SMT" Enable="FALSE" Height="20" Id="med_smt" Left="358" MaxLength="10" RightMargin="3" Style="sty_ipt_form" TabOrder="41" Top="168" Width="150"></MaskEdit>
		<Static Align="Right" Height="24" Id="st_smt" Left="261" Style="sty_lb_form_basic" TabOrder="40" Text="설치비&#32;" Top="166" VAlign="Middle" Width="95"></Static>
		<Static Align="Right" Height="24" Id="st_gmt" Left="514" Style="sty_lb_form_basic" TabOrder="42" Text="제경비&#32;" Top="166" VAlign="Middle" Width="95"></Static>
		<MaskEdit BindDataset="ds_head" Border="Flat" Column="GMT" Enable="FALSE" Height="20" Id="med_gmt" Left="611" MaxLength="10" RightMargin="3" Style="sty_ipt_form" TabOrder="43" Top="168" Width="150"></MaskEdit>
		<Static Align="Right" Height="24" Id="st_nmt" Left="8" Style="sty_lb_form_basic" TabOrder="44" Text="일반관리비&#32;" Top="191" VAlign="Middle" Width="95"></Static>
		<MaskEdit BindDataset="ds_head" Border="Flat" Column="NMT" Enable="FALSE" Height="20" Id="med_nmt" Left="105" MaxLength="10" RightMargin="3" Style="sty_ipt_form" TabOrder="45" Top="193" Width="150"></MaskEdit>
		<Static Align="Right" Height="24" Id="st_cmt" Left="261" Style="sty_lb_form_basic" TabOrder="46" Text="기업이윤&#32;" Top="191" VAlign="Middle" Width="95"></Static>
		<MaskEdit BindDataset="ds_head" Border="Flat" Column="CMT" Enable="FALSE" Height="20" Id="med_cmt" Left="358" MaxLength="10" RightMargin="3" Style="sty_ipt_form" TabOrder="47" Top="193" Width="150"></MaskEdit>
		<Static Align="Right" Height="24" Id="st_amt" Left="514" Style="sty_lb_form_basic" TabOrder="48" Text="소계&#32;" Top="191" VAlign="Middle" Width="95"></Static>
		<MaskEdit BindDataset="ds_head" Border="Flat" Column="AMT" Enable="FALSE" Height="20" Id="med_amt" Left="611" MaxLength="10" RightMargin="3" Style="sty_ipt_form" TabOrder="49" Top="193" Width="150"></MaskEdit>
		<Static Align="Right" Height="24" Id="st_vat" Left="8" Style="sty_lb_form_basic" TabOrder="50" Text="VAT&#32;" Top="216" VAlign="Middle" Width="95"></Static>
		<MaskEdit BindDataset="ds_head" Border="Flat" Column="VAT" Enable="FALSE" Height="20" Id="med_vat" Left="105" MaxLength="10" RightMargin="3" Style="sty_ipt_form" TabOrder="51" Top="218" Width="150"></MaskEdit>
		<Static Align="Right" Height="24" Id="st_tot" Left="261" Style="sty_lb_form_basic" TabOrder="52" Text="합계(VAT포함)&#32;" Top="216" VAlign="Middle" Width="95"></Static>
		<MaskEdit BindDataset="ds_head" Border="Flat" Column="TOT" Enable="FALSE" Height="20" Id="med_tot" Left="358" MaxLength="10" RightMargin="3" Style="sty_ipt_form" TabOrder="53" Top="218" Width="150"></MaskEdit>
	</Form>
	<Script><![CDATA[﻿﻿﻿﻿﻿﻿﻿﻿/*
 ******************************************************************************************
 * 기      능   : 
 * 작  성  자   : 
 * 작성  일자   : 
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
#include "LIB::commons.js";	// 공통 스크립트 
#include "LIB::utility.js";	// 다중 선택 
//=========================================================================================
// [ PART 1 ]
// Form에서 사용될 전역변수를 선언
// FORM에서 사용되는 전역변수는 대문자로 작성하며, F_XXX 의 형태를 갖도록 한다. 
//=========================================================================================
var userGroup;
var gRow = null;
var g_flr, g_emt, g_lmt, g_cmt, g_kmt, g_jjt;
var chk_flag = false;
//=========================================================================================
// [ PART 2 ]
// Form Loading / Unloading 시 작업 정의
//=========================================================================================
function fn_OnLoadCompleted(obj) {
	gfn_initForm();

	var codeArr = ["CS187"];
	var dsObjArr = [ds_knd];
	var addTypeArr = [G_CODE_SELECT];
	gfn_searchCommCode(codeArr, dsObjArr, addTypeArr);

	if(lnk == "INS") { //신규견적 작성시
		fn_setHno();
	} else { //기존견적 수정시
		fn_selHno();
	}
}

/********************************************************************************
* 기      능   : 공통코드가 조회된 후의 Callback 함수 
********************************************************************************/
function fn_completeInit(sCode, sDsObj, sCodeType) {
	cb_knd.Index = 0;
	fn_InitSet();
}

/********************************************************************************
* 기      능   : form UnloadCompleted 
********************************************************************************/
function fn_OnUnloadCompleted(obj) {
	return gfn_isFormUnload(obj);
}

function fn_InitSet() {
	tit_clearActionInfo();
	tit_addSearchActionInfo("cs12:CS1250001B_S5", null, true); //ZCST308
	tit_addSearchActionInfo("cs12:CS1250001B_S6", null, true); //ZCST309
	tit_callService(
        ""
        , ""
        , ""
        , "ds_308=ds_308 ds_309=ds_309"
        , ""
        , "fn_afterInitSet"
        , true);
}

function fn_afterInitSet(errCode, errMsg) {
	if(lnk == "INS") { //신규견적 작성시
	} else { //기존견적 수정시
		g_flr = ds_list2.GetRowCount();

		g_lmt = ds_308.GetColumn(ds_308.FindRow("KND", cb_knd.Value), "LPP");
		g_cmt = ds_308.GetColumn(ds_308.FindRow("KND", cb_knd.Value), "CPP");
		g_kmt = ds_308.GetColumn(ds_308.FindRow("KND", cb_knd.Value), "KEP");
		g_jjt = ds_308.GetColumn(ds_308.FindRow("KND", cb_knd.Value), "JJT");
	}

	calc_Exc();
}

//=========================================================================================
// [ PART 3 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,form닫기)
//=========================================================================================
/********************************************************************************
* 기      능   : 조회 
********************************************************************************/
function fn_queryIns() {
	tit_clearActionInfo();
	tit_addSearchActionInfo("cs12:CS1250001B_S1");
	tit_addSearchActionInfo("cs12:CS1250001B_S2");
	tit_callService(
        ""
        , ""
        , "ds_cond=ds_cond2"
        , "ds_head=ds_head ds_list2=ds_list2"
        , ""
        , "fn_afterQueryIns"
        , true
        , true);
}

function fn_queryUpd() {
	tit_clearActionInfo();
	tit_addSearchActionInfo("cs12:CS1250001B_S3");
	tit_addSearchActionInfo("cs12:CS1250001B_S4");
	tit_callService(
        ""
        , ""
        , "ds_cond=ds_cond2"
        , "ds_head=ds_head ds_list2=ds_list2"
        , ""
        , "fn_afterQueryUpd"
        , true
        , true);
}

/********************************************************************************
* 기      능   : 조회 Callback  
********************************************************************************/
function fn_afterQueryIns(errCode, errMsg) {
	gfn_showMsg("CI00002",ds_list2.RowCount()+"");

	if(ds_head.GetColumn(0, "PST") == "A6") {
		div_btn.btn_recost.enable = true;
	}
}

function fn_afterQueryUpd(errCode, errMsg) {
	gfn_showMsg("CI00002",ds_list2.RowCount()+"");

	userGroup = gfn_getUserGroup();

	if(ds_head.GetColumn(0, "PST") == "A1") {
		div_btn.btn_save.Enable = true;
		div_btn.btn_delete.Enable = true;
		div_btn.btn_trans.Enable = true;
		div_btn.btn_recost.Enable = false;

		cal_cdt.Enable = true;
		ed_nam.Enable = true;
		ed_spt.Enable = true;
		ed_pjt.Enable = true;
		ed_adr.Enable = true;
		ed_spc.Enable = true;
		cb_knd.Enable = true;
		med_snt.Enable = true;

		grd_list2.Editable = true;
	} else if(ds_head.GetColumn(0, "PST") == "A2") {
		div_btn.btn_save.Enable = true;		
		if(G_USER_ID = "2021056"){
			div_btn.btn_delete.Enable = true;
		} else{
			div_btn.btn_delete.Enable = false;		
		}
		div_btn.btn_trans.Enable = false;
		div_btn.btn_recost.Enable = false;

		cal_cdt.Enable = true;
		ed_nam.Enable = true;
		ed_spt.Enable = true;
		ed_pjt.Enable = true;
		ed_adr.Enable = true;
		ed_spc.Enable = true;
		cb_knd.Enable = true;
		med_snt.Enable = true;

		grd_list2.Editable = true;
	} else if(ds_head.GetColumn(0, "PST") > "A2" && ds_head.GetColumn(0, "PST") < "A6") {
		div_btn.btn_save.Enable = false;	
		if(G_USER_ID = "2021056"){
			div_btn.btn_delete.Enable = true;
		} else{
			div_btn.btn_delete.Enable = false;		
		}
		div_btn.btn_trans.Enable = false;
		div_btn.btn_recost.Enable = false;

		cal_cdt.Enable = false;
		ed_nam.Enable = false;
		ed_spt.Enable = false;
		ed_pjt.Enable = false;
		ed_adr.Enable = false;
		ed_spc.Enable = false;
		cb_knd.Enable = false;
		med_snt.Enable = false;

		grd_list2.Editable = false;
	} else if(ds_head.GetColumn(0, "PST") == "A6") {
		div_btn.btn_save.Enable = false;	
		if(G_USER_ID = "2021056"){
			div_btn.btn_delete.Enable = true;
		} else{
			div_btn.btn_delete.Enable = false;		
		}
		div_btn.btn_trans.Enable = false;
		div_btn.btn_recost.Enable = true;

		grd_list2.Editable = true;
	}
}

/********************************************************************************
* 기      능   : 저장
********************************************************************************/
function fn_save() {
	if(length(trim(ds_head.GetColumn(0, "ETN"))) == 0 && ds_head.GetColumn(0, "PST") >= "A1") {
		gfn_showAlert("진행상태를 확인하십시요.");
		return false;
	}
	if(length(trim(ds_head.GetColumn(0, "ETN"))) > 0 && (length(trim(ds_head.GetColumn(0, "PST"))) == 0 || ds_head.GetColumn(0, "PST") > "A2")) {
		gfn_showAlert("진행상태를 확인하십시요.");
		return false;
	}
	if(ds_head.GetColumn(0, "CDT") == "") {
		gfn_showAlert("계약예정일을 확인하십시요.");
		return false;
	}
	if(ds_head.GetColumn(0, "NAM") == "") {
		gfn_showAlert("고객명을 확인하십시요.");
		return false;
	}
	if(ds_head.GetColumn(0, "SPT") == "") {
		gfn_showAlert("현장명을 확인하십시요.");
		return false;
	}
	if(ds_head.GetColumn(0, "ADR") == "") {
		gfn_showAlert("현장주소를 확인하십시요.");
		return false;
	}
	if(ds_head.GetColumn(0, "KND") == "") {
		gfn_showAlert("판매상품을 확인하십시요.");
		return false;
	}

	for(var i=0; i<ds_list2.rowcount; i++) {
		ds_list2.SetColumn(i, "ETN", ds_head.GetColumn(0, "ETN"));
		ds_list2.SetColumn(i, "SIR", ds_head.GetColumn(0, "SIR"));
	}

	tit_clearActionInfo();

	if(length(trim(ds_head.GetColumn(0, "ETN"))) == 0) {
		tit_addSingleActionInfo("cs12:CS1250001B_I1");
		tit_addMultiActionInfo("cs12:CS1250001B_I2");
	} else {
		tit_addSingleActionInfo("cs12:CS1250001B_U2");
		tit_addMultiActionInfo("cs12:CS1250001B_U3");
	}

	tit_callService(
		""
		, ""
		, "ds_head=ds_head ds_list2=ds_list2"
		, ""
		, ""
		, "fn_afterSave"
		, true);
}

/********************************************************************************
* 기      능   : 삭제
********************************************************************************/
function fn_delete() {	
	if(G_USER_ID = "2021056"){

	} else{
		if(ds_head.GetColumn(0, "PST") > "A1") {
			gfn_showAlert("작성상태에서만 삭제가 가능합니다.");
			return false;
		}		
	}

	tit_clearActionInfo();
	tit_addSingleActionInfo("cs12:CS1250001B_U1");
	tit_addSingleActionInfo("cs12:CS1250001B_U7"); //재견적 이후 작성데이터 삭제시 이전승인데이터 복구
	tit_callService(
		""
		, ""
		, "ds_head=ds_head"
		, ""
		, ""
		, "fn_afterDelete"
		, true);
}

/********************************************************************************
* 기      능   : 재견적
********************************************************************************/
function fn_recost() {
	if(ds_head.GetColumn(0, "PST") <> "A6") {
		gfn_showAlert("승인상태에서만 재견적이 가능합니다.");
		return false;
	}
	if(ds_head.GetColumn(0, "CDT") == "") {
		gfn_showAlert("계약예정일을 확인하십시요.");
		return false;
	}
	if(ds_head.GetColumn(0, "NAM") == "") {
		gfn_showAlert("고객명을 확인하십시요.");
		return false;
	}
	if(ds_head.GetColumn(0, "SPT") == "") {
		gfn_showAlert("현장명을 확인하십시요.");
		return false;
	}
	if(ds_head.GetColumn(0, "ADR") == "") {
		gfn_showAlert("현장주소를 확인하십시요.");
		return false;
	}
	if(ds_head.GetColumn(0, "KND") == "") {
		gfn_showAlert("판매상품을 확인하십시요.");
		return false;
	}

	for(var i=0; i<ds_list2.rowcount; i++) {
		ds_list2.SetColumn(i, "ETN", ds_head.GetColumn(0, "ETN"));
		ds_list2.SetColumn(i, "SIR", ds_head.GetColumn(0, "SIR"));
	}

	if(!gfn_showConfirm("CI00024","재견적")) {
		return;
	}

	tit_clearActionInfo();

	tit_addSingleActionInfo("cs12:CS1250001B_U6");
	tit_addSingleActionInfo("cs12:CS1250001B_I3");
	tit_addMultiActionInfo("cs12:CS1250001B_I4");
	tit_callService(
		""
		, ""
		, "ds_head=ds_head ds_list2=ds_list2"
		, ""
		, ""
		, "fn_afterRecost"
		, true);
}

/********************************************************************************
* 기      능   : 전송
********************************************************************************/
function fn_trans() {
	if(ds_head.GetColumn(0, "PST") > "A1") {
		gfn_showAlert("작성상태에서만 전송이 가능합니다.");
		return false;
	}

	if(!gfn_showConfirm("CI00024","전송")) {
		return;
	}

	tit_clearActionInfo();
	tit_addSingleActionInfo("cs12:CS1250001B_U5");
	tit_callService(
		""
		, ""
		, "ds_head=ds_head"
		, ""
		, ""
		, "fn_afterTrans"
		, true);
}

/********************************************************************************
* 기      능   : 저장 Callback  
********************************************************************************/
function fn_afterSave(errCode, errMsg) {
	if(errCode != 0) {
		gfn_showMsg("CE00001");
	} else {
		gfn_showMsg("CI00005");

		if(lnk == "INS") {
			fn_queryIns();
		} else {
			close();
		}
	}
}

/********************************************************************************
* 기      능   : 삭제 Callback  
********************************************************************************/
function fn_afterDelete(errCode, errMsg) {
	if(errCode != 0) {
		gfn_showMsg("CE00001");
	} else {
		gfn_showMsg("CI00005");
		close();
	}
}

/********************************************************************************
* 기      능   : 재견적 Callback
********************************************************************************/
function fn_afterRecost(errCode, errMsg) {
	if(errCode != 0) {
		gfn_showMsg("CE00001");
	} else {
		gfn_showMsg("CI00003");
		close();
	}
}

/********************************************************************************
* 기      능   : 전송 Callback
********************************************************************************/
function fn_afterTrans(errCode, errMsg) {
	if(errCode != 0) {
		gfn_showMsg("CE00001");
	} else {
		gfn_showMsg("CI00006", "전송");
		close();
	}
}

/********************************************************************************
* 기      능   : 닫기  
********************************************************************************/
function fn_close() {
	close();
}

//=========================================================================================
// [ PART 4]
// Callback 함수 정의 : callback 함수명은 메인 함수의 fn_xxxx() 에서 xxxx 부분은 fn_afterXXXX()
// 형태가 되도록 작성 
//=========================================================================================

/********************************************************************************
* 기      능   : 엑셀
********************************************************************************/
function fn_excel() {
	gfn_saveToExcel(grd_list2, true);
}

function fn_setHno() {
	ds_list2.ClearData();

	ds_head.SetColumn(0, "MDT", gfn_getCurrDate());
	ds_head.SetColumn(0, "MID", G_USER_ID);
	ds_head.SetColumn(0, "MID_NM", G_USER_NAME);
	ds_head.SetColumn(0, "CDT","");

	j = 0;
	k = 0;
	for(var i=0; i<ds_list.RowCount(); i++) {
		if(ds_list.GetColumn(i, "CHK") == true) { //체크박스가 true 일 경우
			if(k == 0) {
				ds_head.SetColumn(0, "SPT", ds_list.GetColumn(i, "SPT"));
				ds_head.SetColumn(0, "ADR", ds_list.GetColumn(i, "ADR"));
				ds_head.SetColumn(0, "PJT", ds_list.GetColumn(i, "PJT"));
				ds_head.SetColumn(0, "TEM", ds_list.GetColumn(i, "TEM"));
				ds_head.SetColumn(0, "BSU", ds_list.GetColumn(i, "BSU"));
				ds_head.SetColumn(0, "SPC", ds_list.GetColumn(i, "SPC1"));
			}

			ds_list2.AddRow();

			ds_list2.SetColumn(j, "PJT", ds_list.GetColumn(i, "PJT"));
			ds_list2.SetColumn(j, "HNO", ds_list.GetColumn(i, "HNO"));
			ds_list2.SetColumn(j, "UPN", ds_list.GetColumn(i, "UPN"));
			ds_list2.SetColumn(j, "TEM", ds_list.GetColumn(i, "TEM"));
			ds_list2.SetColumn(j, "SPT", ds_list.GetColumn(i, "SPT"));
			ds_list2.SetColumn(j, "SPC", ds_list.GetColumn(i, "SPC1"));
			ds_list2.SetColumn(j, "SPC2",ds_list.GetColumn(i, "SPC2"));
			ds_list2.SetColumn(j, "FLR", ds_list.GetColumn(i, "FLR"));
			ds_list2.SetColumn(j, "GBN", ds_list.GetColumn(i, "GBN"));

			j++;
			k++;
		}
	}

	ds_head.SetColumn(0, "HNT", ds_list2.GetRowCount());
}

function fn_selHno() {
	ds_cond2.SetColumn(0, "TEM", substr(ds_list.GetColumn(ds_list.row, "ETN"),0,3));
	ds_cond2.SetColumn(0, "RDT", substr(ds_list.GetColumn(ds_list.row, "ETN"),4,4));
	ds_cond2.SetColumn(0, "SEQ", substr(ds_list.GetColumn(ds_list.row, "ETN"),9,4));
	ds_cond2.SetColumn(0, "SIR", ds_list.GetColumn(ds_list.row, "SIR"));

	fn_queryUpd();
}

// 달력 처리 부분 
/********************************************************************************
* 기      능   : 달력에서 일자 선택했을 경우 
********************************************************************************/
function cal_temp_OnDayClick(obj,strText) {
	ds_head.SetColumn(ds_head.row, "CDT", strText);
	obj.Visible = false;
}

/********************************************************************************
* 기      능   : 달력에서 포커스 잃었을 경우 
********************************************************************************/
function cal_temp_OnKillFocus(obj) {
	obj.Visible = false;
}

function ds_list2_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex) {
	if(chk_flag == true) {
		if(strColumnID == "ENT") {
			calc_Grid();
		} else if(strColumnID == "LNT") {
			calc_Grid();
		} else if(strColumnID == "CNT") {
			calc_Grid();
		} else if(strColumnID == "KNT") {
			calc_Grid();
		} else if(strColumnID == "ZMT") {
			calc_Grid();
		} else {
		}
	}
}

function cb_knd_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex) {
	chk_flag = false;
	var t_cnt = ds_list2.GetRowCount();
	var t_knd = cb_knd.Value;
	var tmp_ent, tmp_lnt, tmp_cnt, tmp_knt;
	var tmp_emt, tmp_lmt, tmp_cmt, tmp_kmt, tmp_jjt, tmp_tot;
	var org_cnt, org_cmt;
	var t_acd;

	if(t_knd == "A") { // Mini-PBX
		tmp_ent = t_cnt;
		tmp_lnt = 1;
		tmp_cnt = 1;
		tmp_knt = 0;
	} else if(t_knd == "B") { // DI-PBX2
/*
		if(t_cnt < 4) {
			gfn_showAlert("DI-PBX2 상품은 설치대수 4대 이상일\n경우에만 선택 가능합니다.");
			cb_knd.Index = 0;
			return false;
		} else {
			tmp_ent = Truncate((t_cnt / 29), 0);

			if(tmp_ent < 1) {
				tmp_ent = 1;
			}
		}
*/
		if(t_cnt < 4) {
			gfn_showAlert("DI-PBX2 상품은 설치대수 4대 이상일\n경우에만 선택 가능합니다.");
			cb_knd.Index = 0;
			return false;
		}

		tmp_ent = 1;
		tmp_lnt = 1;
		tmp_cnt = 1;
		tmp_knt = 1;
	} else if(t_knd == "C") { // Hybrid-PBX(CH1)
		tmp_ent = t_cnt;
		tmp_lnt = 1;
		tmp_cnt = 1 * 2;
		tmp_knt = 0;
	} else if(t_knd == "D") { // Hybrid-PBX(CH2)
		tmp_ent = Truncate((t_cnt / 2), 0);

		if(tmp_ent < 1) {
			tmp_ent = 1;
		}

		tmp_lnt = 1;
		tmp_cnt = 1 * 2;
		tmp_knt = 0;
	} else {
	}

	if(t_knd == "B") { // DI-PBX2
		tmp_emt = ds_309.GetColumn(ds_309.FindRow("FLR", g_flr), "PRC");
	} else { // Mini-PBX, Hybrid-PBX(CH1), Hybrid-PBX(CH2)
		tmp_emt = tmp_ent * ds_308.GetColumn(ds_308.FindRow("KND", t_knd), "EXC");
	}
	tmp_lmt = tmp_lnt * ds_308.GetColumn(ds_308.FindRow("KND", t_knd), "LPP");
	tmp_cmt = tmp_cnt * ds_308.GetColumn(ds_308.FindRow("KND", t_knd), "CPP");
	tmp_kmt = tmp_knt * ds_308.GetColumn(ds_308.FindRow("KND", t_knd), "KEP");
	tmp_jjt = ds_308.GetColumn(ds_308.FindRow("KND", t_knd), "JJT");

	g_lmt = ds_308.GetColumn(ds_308.FindRow("KND", cb_knd.Value), "LPP");
	g_cmt = ds_308.GetColumn(ds_308.FindRow("KND", cb_knd.Value), "CPP");
	g_kmt = ds_308.GetColumn(ds_308.FindRow("KND", cb_knd.Value), "KEP");
	g_jjt = ds_308.GetColumn(ds_308.FindRow("KND", cb_knd.Value), "JJT");

	org_cnt = tmp_cnt;
	org_cmt = tmp_cmt;

	ds_list2.SetColumn(0, "ENT", tmp_ent);
	ds_list2.SetColumn(0, "EMT", tmp_emt);

	for(var i=0; i<t_cnt; i++) {
		t_acd = ds_list2.GetColumn(i, "ACD");

		if(t_acd == "EN81") { // EN-CODE : EN81 인 경우 CP Phone 2대 추가
			tmp_cnt = org_cnt + 2;
		} else {
			tmp_cnt = org_cnt;
		}

		tmp_cmt = tmp_cnt * ds_308.GetColumn(ds_308.FindRow("KND", t_knd), "CPP");
		tmp_tot = tmp_emt + tmp_lmt + tmp_cmt + tmp_kmt + tmp_jjt;

		if(i > 0) {
			ds_list2.SetColumn(i, "ENT", 0);
			ds_list2.SetColumn(i, "EMT", 0);

			tmp_tot = tmp_lmt + tmp_cmt + tmp_kmt + tmp_jjt;
		}
		ds_list2.SetColumn(i, "LNT", tmp_lnt);
		ds_list2.SetColumn(i, "LMT", tmp_lmt);
		ds_list2.SetColumn(i, "CNT", tmp_cnt);
		ds_list2.SetColumn(i, "CNT2", tmp_cnt);
		ds_list2.SetColumn(i, "CMT", tmp_cmt);
		ds_list2.SetColumn(i, "KNT", tmp_knt);
		ds_list2.SetColumn(i, "KMT", tmp_kmt);
		ds_list2.SetColumn(i, "ZMT", tmp_jjt);
		ds_list2.SetColumn(i, "TOT", tmp_tot);
	}

	med_snt.Value = 0;

	calc_Smt();
	calc_Tot();
}

function med_snt_OnChanged(obj,strText) { // 경비실개소당 CP Phone 1대씩 추가
	var t_snt, t_cnt, t_cmt;
	var t_knd = cb_knd.Value;

	if(ds_head.GetColumn(0, "KND") == "" && ds_head.GetColumn(0, "SNT") > "") {
		gfn_showAlert("판매상품을 입력하신 후 경비실개소를 입력하시기 바랍니다.");
		med_snt.Value = "";
		return false;
	}

	t_snt = med_snt.Value;

	if(t_snt == "") {
		t_snt = "0";
	}

	t_snt = parseInt(t_snt);

	for(var i=0; i<ds_list2.GetRowCount(); i++) {
		t_cnt = parseInt(ds_list2.GetOrgColumn(i, "CNT2"));

		if(t_snt > 0) {
			t_cnt = t_cnt + t_snt;
		}

		t_cmt = t_cnt * ds_308.GetColumn(ds_308.FindRow("KND", t_knd), "CPP");

		ds_list2.SetColumn(i, "CNT", t_cnt);
		ds_list2.SetColumn(i, "CMT", t_cmt);
	}

	calc_Tot();
}

function calc_Tot() { // 헤더 합계
	var sum_jmt, sum_amt;

	for(var i=0; i<ds_list2.RowCount(); i++) {
		sum_jmt = sum_jmt + parseCurrency(ds_list2.GetColumn(i, "EMT")) + parseCurrency(ds_list2.GetColumn(i, "LMT")) + parseCurrency(ds_list2.GetColumn(i, "CMT")) + parseCurrency(ds_list2.GetColumn(i, "KMT")) + parseCurrency(ds_list2.GetColumn(i, "ZMT"));
	}

	// 자재판매가(A)
	med_jmt.Value = Round(sum_jmt, 0);

	// 설치비(B)
	//med_smt.Value;

	// 제경비(C) : A + B 의 5%
	med_gmt.Value = Round(((parseCurrency(med_jmt.Value) + parseCurrency(med_smt.Value)) * 0.05), 0);

	// 일반관리비(D) : A + B + C 의 10%
	med_nmt.Value = Round(((parseCurrency(med_jmt.Value) + parseCurrency(med_smt.Value)) + parseCurrency(med_gmt.Value)) * 0.10, 0);

	// 기업이윤(E) : A + B + C + D 의 10%
	med_cmt.Value = Round(((parseCurrency(med_jmt.Value) + parseCurrency(med_smt.Value)) + parseCurrency(med_gmt.Value) + parseCurrency(med_nmt.Value)) * 0.10, 0);

	// 소계(F) : A + B + C + D + E
	sum_amt = Round((parseCurrency(med_jmt.Value) + parseCurrency(med_smt.Value)) + parseCurrency(med_gmt.Value) + parseCurrency(med_nmt.Value) + parseCurrency(med_cmt.Value), 0);
	med_amt.Value = parseCurrency(Truncate((sum_amt / 1000),0)) * 1000; // 천단위 이하 절사

	// VAT(G) : F 의 10%
	med_vat.Value = Round((parseCurrency(med_amt.Value) * 0.10), 0);

	// 합계(VAT포함) : F + G
	med_tot.Value = parseCurrency(med_amt.Value) + parseCurrency(med_vat.Value);
}

function calc_Grid() { // 그리드 합계
	var k_emt, k_lmt, k_cmt, k_kmt, k_tot;
	var t_knd = cb_knd.Value;

	for(var i=0; i<ds_list2.GetRowCount(); i++) {
		if(t_knd == "B") { // DI-PBX2
			k_emt = parseCurrency(g_emt);
		} else { // Mini-PBX, Hybrid-PBX(CH1), Hybrid-PBX(CH2)
			k_emt = parseInt(ds_list2.GetColumn(i, "ENT")) * parseCurrency(g_emt);
		}
		k_lmt = parseInt(ds_list2.GetColumn(i, "LNT")) * parseCurrency(g_lmt);
		k_cmt = parseInt(ds_list2.GetColumn(i, "CNT")) * parseCurrency(g_cmt);
		k_kmt = parseInt(ds_list2.GetColumn(i, "KNT")) * parseCurrency(g_kmt);
		k_tot = parseCurrency(k_emt) + parseCurrency(k_lmt) + parseCurrency(k_cmt) + parseCurrency(k_kmt) + parseCurrency(ds_list2.GetColumn(i, "ZMT"));

		if(i > 0) {
			k_emt = 0;
		}

		ds_list2.SetColumn(i, "EMT", k_emt);
		ds_list2.SetColumn(i, "LMT", k_lmt);
		ds_list2.SetColumn(i, "CMT", k_cmt);
		ds_list2.SetColumn(i, "KMT", k_kmt);
		ds_list2.SetColumn(i, "TOT", k_tot);
	}

	calc_Tot();
	calc_Exc();
}

function calc_Smt() { // 설치기성
	var s_cnt = ds_list2.GetRowCount();
	var s_knd = cb_knd.Value;
	var s_smt, s_sma, s_smb, s_wag;

	s_sma = ds_308.GetColumn(ds_308.FindRow("KND", s_knd), "SMA");
	s_smb = ds_308.GetColumn(ds_308.FindRow("KND", s_knd), "SMB");
	s_wag = ds_308.GetColumn(ds_308.FindRow("KND", s_knd), "WAG");
	s_smt = (s_sma * s_wag * s_cnt) + (s_smb * s_wag);

	med_smt.Value = s_smt;
}

function calc_Exc() {
	if(g_flr == "") {
		g_flr = "0";
	}

	g_flr = parseInt(ds_list2.GetRowCount());

	if(g_flr <= 3) {
		g_flr = 3;
	} else if(g_flr <= 7) {
		g_flr = 7;
	} else if(g_flr <= 11) {
		g_flr = 11;
	} else if(g_flr <= 13) {
		g_flr = 13;
	} else if(g_flr <= 16) {
		g_flr = 16;
	} else if(g_flr <= 21) {
		g_flr = 21;
	} else if(g_flr <= 25) {
		g_flr = 25;
	} else if(g_flr <= 29) {
		g_flr = 29;
	} else if(g_flr <= 33) {
		g_flr = 33;
	} else if(g_flr <= 37) {
		g_flr = 37;
	} else if(g_flr <= 41) {
		g_flr = 41;
	} else if(g_flr <= 45) {
		g_flr = 45;
	} else if(g_flr <= 49) {
		g_flr = 49;
	} else if(g_flr <= 53) {
		g_flr = 53;
	} else if(g_flr <= 57) {
		g_flr = 57;
	} else if(g_flr <= 61) {
		g_flr = 61;
	} else {
		g_flr = 61;
	}

	var t_knd = cb_knd.Value;

	if(t_knd == "B") { // DI-PBX2
		g_emt = ds_309.GetColumn(ds_309.FindRow("FLR", g_flr), "PRC");
	} else { // Mini-PBX, Hybrid-PBX(CH1), Hybrid-PBX(CH2)
		g_emt = ds_308.GetColumn(ds_308.FindRow("KND", t_knd), "EXC");
	}
}

function grd_list2_OnFocus(obj) {
	chk_flag = true;
}
]]></Script>
</Window>