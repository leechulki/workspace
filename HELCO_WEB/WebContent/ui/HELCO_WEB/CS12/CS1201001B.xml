<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="558" Id="cal_endda" Left="8" OnKeyDown="gfn_EnterInForm" OnLoadCompleted="fn_OnLoadCompleted" OnUnloadCompleted="fn_OnUnloadCompleted" PidAttrib="7" Title="유상보수계약상세" Top="8" Ver="1.0" Width="978" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_cond">
				<Contents>
					<colinfo id="UPN" size="256" summ="default" type="STRING"/>
					<colinfo id="CST" size="256" summ="default" type="STRING"/>
					<colinfo id="ARA" size="256" summ="default" type="STRING"/>
					<colinfo id="JPGBN" size="256" summ="default" type="STRING"/>
					<colinfo id="GND" size="256" summ="default" type="STRING"/>
					<colinfo id="UHJ_FM" size="256" summ="default" type="STRING"/>
					<colinfo id="UHJ_TO" size="256" summ="default" type="STRING"/>
					<colinfo id="USD" size="256" summ="default" type="STRING"/>
					<colinfo id="UHJ" size="256" summ="default" type="STRING"/>
					<colinfo id="GNO" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="DOCNO" size="256" summ="default" type="STRING"/>
					<colinfo id="PGMID" size="256" summ="default" type="STRING"/>
					<colinfo id="T_UGS" size="256" summ="default" type="STRING"/>
					<record>
						<ARA></ARA>
						<CST></CST>
						<DOCNO></DOCNO>
						<GBN></GBN>
						<GND></GND>
						<GNO></GNO>
						<JPGBN></JPGBN>
						<PGMID></PGMID>
						<T_UGS></T_UGS>
						<UHJ></UHJ>
						<UHJ_FM></UHJ_FM>
						<UHJ_TO></UHJ_TO>
						<UPN></UPN>
						<USD></USD>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cst_cd">
				<Contents>
					<colinfo id="CST" size="256" type="STRING"/>
					<record>
						<CST></CST>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_code_cond">
				<Contents>
					<colinfo id="MANDT" size="256" type="STRING"/>
					<colinfo id="UPN" size="256" type="STRING"/>
					<colinfo id="CST" size="256" type="STRING"/>
					<record>
						<CST></CST>
						<MANDT></MANDT>
						<UPN></UPN>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_jpgbn_cd">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_conkind_cd">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
					<record>
						<CODE>C</CODE>
						<CODE_NAME>유상공사</CODE_NAME>
					</record>
					<record>
						<CODE>D</CODE>
						<CODE_NAME>유상일반</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_bsgbn_cd">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_bhcycle_cd">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_bhday_cd">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
					<record>
						<CODE>01</CODE>
						<CODE_NAME>1</CODE_NAME>
					</record>
					<record>
						<CODE>02</CODE>
						<CODE_NAME>2</CODE_NAME>
					</record>
					<record>
						<CODE>03</CODE>
						<CODE_NAME>3</CODE_NAME>
					</record>
					<record>
						<CODE>04</CODE>
						<CODE_NAME>4</CODE_NAME>
					</record>
					<record>
						<CODE>05</CODE>
						<CODE_NAME>5</CODE_NAME>
					</record>
					<record>
						<CODE>06</CODE>
						<CODE_NAME>6</CODE_NAME>
					</record>
					<record>
						<CODE>07</CODE>
						<CODE_NAME>7</CODE_NAME>
					</record>
					<record>
						<CODE>08</CODE>
						<CODE_NAME>8</CODE_NAME>
					</record>
					<record>
						<CODE>09</CODE>
						<CODE_NAME>9</CODE_NAME>
					</record>
					<record>
						<CODE>10</CODE>
						<CODE_NAME>10</CODE_NAME>
					</record>
					<record>
						<CODE>11</CODE>
						<CODE_NAME>11</CODE_NAME>
					</record>
					<record>
						<CODE>12</CODE>
						<CODE_NAME>12</CODE_NAME>
					</record>
					<record>
						<CODE>13</CODE>
						<CODE_NAME>13</CODE_NAME>
					</record>
					<record>
						<CODE>14</CODE>
						<CODE_NAME>14</CODE_NAME>
					</record>
					<record>
						<CODE>15</CODE>
						<CODE_NAME>15</CODE_NAME>
					</record>
					<record>
						<CODE>16</CODE>
						<CODE_NAME>16</CODE_NAME>
					</record>
					<record>
						<CODE>17</CODE>
						<CODE_NAME>17</CODE_NAME>
					</record>
					<record>
						<CODE>18</CODE>
						<CODE_NAME>18</CODE_NAME>
					</record>
					<record>
						<CODE>19</CODE>
						<CODE_NAME>19</CODE_NAME>
					</record>
					<record>
						<CODE>20</CODE>
						<CODE_NAME>20</CODE_NAME>
					</record>
					<record>
						<CODE>21</CODE>
						<CODE_NAME>21</CODE_NAME>
					</record>
					<record>
						<CODE>22</CODE>
						<CODE_NAME>22</CODE_NAME>
					</record>
					<record>
						<CODE>23</CODE>
						<CODE_NAME>23</CODE_NAME>
					</record>
					<record>
						<CODE>24</CODE>
						<CODE_NAME>24</CODE_NAME>
					</record>
					<record>
						<CODE>25</CODE>
						<CODE_NAME>25</CODE_NAME>
					</record>
					<record>
						<CODE>26</CODE>
						<CODE_NAME>26</CODE_NAME>
					</record>
					<record>
						<CODE>27</CODE>
						<CODE_NAME>27</CODE_NAME>
					</record>
					<record>
						<CODE>28</CODE>
						<CODE_NAME>28</CODE_NAME>
					</record>
					<record>
						<CODE>29</CODE>
						<CODE_NAME>29</CODE_NAME>
					</record>
					<record>
						<CODE>30</CODE>
						<CODE_NAME>30</CODE_NAME>
					</record>
					<record>
						<CODE>31</CODE>
						<CODE_NAME>31</CODE_NAME>
					</record>
					<record>
						<CODE>99</CODE>
						<CODE_NAME>99</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_jgcnt_cd">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
					<record>
						<CODE>01</CODE>
						<CODE_NAME>1</CODE_NAME>
					</record>
					<record>
						<CODE>02</CODE>
						<CODE_NAME>2</CODE_NAME>
					</record>
					<record>
						<CODE>03</CODE>
						<CODE_NAME>3</CODE_NAME>
					</record>
					<record>
						<CODE>04</CODE>
						<CODE_NAME>4</CODE_NAME>
					</record>
					<record>
						<CODE>05</CODE>
						<CODE_NAME>5</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_pergbn_cd">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
					<record>
						<CODE>Y</CODE>
						<CODE_NAME>예</CODE_NAME>
					</record>
					<record>
						<CODE>N</CODE>
						<CODE_NAME>아니오</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_fmkind_cd">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list" OnColumnChanged="ds_list_OnColumnChanged">
				<Contents>
					<colinfo id="ABG" size="3" summ="default" type="STRING"/>
					<colinfo id="ABG_NM" size="60" summ="default" type="STRING"/>
					<colinfo id="AGB" size="3" summ="default" type="STRING"/>
					<colinfo id="AGB_NM" size="60" summ="default" type="STRING"/>
					<colinfo id="ARA" size="6" summ="default" type="STRING"/>
					<colinfo id="ARA_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="BJG" size="3" summ="default" type="STRING"/>
					<colinfo id="BPM" size="30" summ="default" type="STRING"/>
					<colinfo id="BSU" size="12" summ="default" type="STRING"/>
					<colinfo id="BSU_NM" size="105" summ="default" type="STRING"/>
					<colinfo id="BUJ" size="0" summ="default" type="STRING"/>
					<colinfo id="BUJ_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK" size="0" summ="default" type="STRING"/>
					<colinfo id="CST" size="9" summ="default" type="STRING"/>
					<colinfo id="FLAG" size="0" summ="default" type="STRING"/>
					<colinfo id="FSD" size="24" summ="default" type="STRING"/>
					<colinfo id="HNA" size="90" summ="default" type="STRING"/>
					<colinfo id="HNO" size="9" summ="default" type="STRING"/>
					<colinfo id="HTY" size="3" summ="default" type="STRING"/>
					<colinfo id="IYN" size="3" summ="default" type="STRING"/>
					<colinfo id="JUJ" size="0" summ="default" type="STRING"/>
					<colinfo id="JUJ_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="KND_YN" size="256" summ="default" type="STRING"/>
					<colinfo id="KND" size="3" summ="default" type="STRING"/>
					<colinfo id="KND_NM" size="60" summ="default" type="STRING"/>
					<colinfo id="MCHK" size="256" summ="default" type="STRING"/>
					<colinfo id="PJT" size="15" summ="default" type="STRING"/>
					<colinfo id="RGB" size="3" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="6" summ="default" type="STRING"/>
					<colinfo id="AMT" size="13" summ="default" type="DECIMAL"/>
					<colinfo id="VAT" size="13" summ="default" type="DECIMAL"/>
					<colinfo id="TOT" size="13" summ="default" type="DECIMAL"/>
					<colinfo id="AMBT" size="13" summ="default" type="DECIMAL"/>
					<colinfo id="VABT" size="13" summ="default" type="DECIMAL"/>
					<colinfo id="TOBT" size="13" summ="default" type="DECIMAL"/>
					<colinfo id="AMTT" size="13" summ="default" type="DECIMAL"/>
					<colinfo id="VATT" size="13" summ="default" type="DECIMAL"/>
					<colinfo id="TOTT" size="13" summ="default" type="DECIMAL"/>
					<colinfo id="ORG_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="ORG_VAT" size="256" summ="default" type="STRING"/>
					<colinfo id="ORG_TOT" size="256" summ="default" type="STRING"/>
					<colinfo id="ORG_AMBT" size="256" summ="default" type="STRING"/>
					<colinfo id="ORG_VABT" size="256" summ="default" type="STRING"/>
					<colinfo id="ORG_TOBT" size="256" summ="default" type="STRING"/>
					<colinfo id="ORG_AMTT" size="256" summ="default" type="STRING"/>
					<colinfo id="ORG_VATT" size="256" summ="default" type="STRING"/>
					<colinfo id="ORG_TOTT" size="256" summ="default" type="STRING"/>
					<colinfo id="ORG_BJG" size="256" summ="default" type="STRING"/>
					<colinfo id="ORG_USD" size="256" summ="default" type="STRING"/>
					<colinfo id="ORG_KND_YN" size="256" summ="default" type="STRING"/>
					<colinfo id="UGS" size="24" summ="default" type="STRING"/>
					<colinfo id="UMR" size="24" summ="default" type="STRING"/>
					<colinfo id="UPN" size="15" summ="default" type="STRING"/>
					<colinfo id="USD" size="24" summ="default" type="STRING"/>
					<colinfo id="SGBN" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSPEC" size="9" summ="default" type="STRING"/>
					<colinfo id="ZSPEC1" size="15" summ="default" type="STRING"/>
					<colinfo id="ZSPEC2" size="75" summ="default" type="STRING"/>
					<colinfo id="ZSPEC3" size="12" summ="default" type="STRING"/>
					<colinfo id="PST" size="256" summ="default" type="STRING"/>
					<colinfo id="PRO" size="256" summ="default" type="STRING"/>
					<colinfo id="TYP" size="256" summ="default" type="STRING"/>
					<colinfo id="GKD" size="256" summ="default" type="STRING"/>
					<colinfo id="GKD_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="T_GKD" size="256" summ="default" type="STRING"/>
					<colinfo id="GYB" size="256" summ="default" type="STRING"/>
					<colinfo id="CGB" size="256" summ="default" type="STRING"/>
					<colinfo id="GND" size="256" summ="default" type="STRING"/>
					<colinfo id="UMS" size="256" summ="default" type="STRING"/>
					<colinfo id="MMN" size="256" summ="default" type="STRING"/>
					<colinfo id="UHJ" size="256" summ="default" type="STRING"/>
					<colinfo id="BGB" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="TIS" size="256" summ="default" type="STRING"/>
					<colinfo id="JKH" size="256" summ="default" type="STRING"/>
					<colinfo id="YYB" size="256" summ="default" type="STRING"/>
					<colinfo id="RMK" size="256" summ="default" type="STRING"/>
					<colinfo id="ZER" size="256" summ="default" type="STRING"/>
					<colinfo id="SLA" size="256" summ="default" type="STRING"/>
					<colinfo id="WYB" size="256" summ="default" type="STRING"/>
					<colinfo id="RTO" size="256" summ="default" type="STRING"/>
					<colinfo id="GBM" size="256" summ="default" type="STRING"/>
					<colinfo id="WIL" size="256" summ="default" type="STRING"/>
					<colinfo id="REQ" size="256" summ="default" type="STRING"/>
					<colinfo id="EXP" size="256" summ="default" type="STRING"/>
					<colinfo id="CS2" size="256" summ="default" type="STRING"/>
					<colinfo id="IS2" size="256" summ="default" type="STRING"/>
					<colinfo id="BHD" size="256" summ="default" type="STRING"/>
					<colinfo id="MYT" size="256" summ="default" type="STRING"/>
					<colinfo id="GBU" size="256" summ="default" type="STRING"/>
					<colinfo id="SQL_FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="MAXSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="HST" size="256" summ="default" type="STRING"/>
					<colinfo id="GRP" size="256" summ="default" type="STRING"/>
					<colinfo id="SLR" size="256" summ="default" type="STRING"/>
					<colinfo id="CYN" size="256" summ="default" type="STRING"/>
					<colinfo id="HMT" size="256" summ="default" type="STRING"/>
					<colinfo id="DMT" size="256" summ="default" type="STRING"/>
					<colinfo id="ACMT" size="256" summ="default" type="STRING"/>
					<colinfo id="SUT" size="256" summ="default" type="STRING"/>
					<colinfo id="HYN" size="256" summ="default" type="STRING"/>
					<colinfo id="DYN" size="256" summ="default" type="STRING"/>
					<colinfo id="ACYN" size="256" summ="default" type="STRING"/>
					<colinfo id="HEP" size="256" summ="default" type="STRING"/>
					<colinfo id="FMY" size="256" summ="default" type="STRING"/>
					<colinfo id="FMS" size="256" summ="default" type="STRING"/>
					<colinfo id="CRS" size="256" summ="default" type="STRING"/>
					<colinfo id="CRS_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="FHG" size="256" summ="default" type="STRING"/>
					<colinfo id="FDG" size="256" summ="default" type="STRING"/>
					<colinfo id="ADT" size="256" summ="default" type="STRING"/>
					<colinfo id="CTP" size="256" summ="default" type="STRING"/>
					<colinfo id="HWR" size="256" summ="default" type="STRING"/>
					<colinfo id="CFG" size="256" summ="default" type="STRING"/>
					<colinfo id="SID" size="256" summ="default" type="STRING"/>
					<colinfo id="SNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="CBN" size="256" summ="default" type="STRING"/>
					<colinfo id="DIF" size="256" summ="default" type="STRING"/>
					<colinfo id="DIBF" size="256" summ="default" type="STRING"/>
					<colinfo id="DITF" size="256" summ="default" type="STRING"/>
					<colinfo id="VKGRP" size="256" summ="default" type="STRING"/>
					<colinfo id="BSUGB" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSPEC7" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSPEC12" size="256" summ="default" type="STRING"/>
					<colinfo id="BLD" size="256" summ="default" type="STRING"/>
					<colinfo id="FDT" size="256" summ="default" type="STRING"/>
					<colinfo id="DND" size="256" summ="default" type="STRING"/>
					<colinfo id="ACND" size="256" summ="default" type="STRING"/>
					<colinfo id="ACD" size="256" summ="default" type="STRING"/>
					<colinfo id="LTC" size="256" summ="default" type="STRING"/>
					<colinfo id="LTY" size="256" summ="default" type="STRING"/>
					<colinfo id="LTS" size="256" summ="default" type="STRING"/>
					<colinfo id="FCM" size="256" summ="default" type="STRING"/>
					<colinfo id="DCE" size="256" summ="default" type="STRING"/>
					<colinfo id="GNO" size="256" summ="default" type="STRING"/>
					<colinfo id="RGS" size="256" summ="default" type="STRING"/>
					<colinfo id="RMR" size="256" summ="default" type="STRING"/>
					<colinfo id="APSTAT" size="256" summ="default" type="STRING"/>
					<colinfo id="REDPT1" size="256" summ="default" type="STRING"/>
					<colinfo id="DAT" size="256" summ="default" type="STRING"/>
					<colinfo id="ZMAN" size="256" summ="default" type="STRING"/>
					<colinfo id="CSE" size="256" summ="default" type="STRING"/>
					<colinfo id="HFR" size="256" summ="default" type="STRING"/>
					<colinfo id="BDGBN" size="256" summ="default" type="STRING"/>
					<colinfo id="DISCRULE" size="256" summ="default" type="STRING"/>
					<colinfo id="ETC" size="256" summ="default" type="STRING"/>
					<colinfo id="ETCBG" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_per_val">
				<Contents>
					<colinfo id="PERCNT" size="256" summ="default" type="STRING"/>
					<colinfo id="SUMAMT" size="256" summ="default" type="STRING"/>
					<colinfo id="SUMAMBT" size="256" summ="default" type="STRING"/>
					<colinfo id="SUMAMTT" size="256" summ="default" type="STRING"/>
					<colinfo id="GAMAMT" size="256" summ="default" type="STRING"/>
					<colinfo id="MAXSEQ" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_gbn">
				<Contents>
					<colinfo id="KIND" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="EXCEPT" size="256" summ="default" type="STRING"/>
					<colinfo id="AF_BSU" size="256" summ="default" type="STRING"/>
					<colinfo id="BF_BSU" size="256" summ="default" type="STRING"/>
					<record>
						<AF_BSU></AF_BSU>
						<BF_BSU></BF_BSU>
						<EXCEPT></EXCEPT>
						<GBN></GBN>
						<KIND></KIND>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_emp_cd">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_nam_cd">
				<Contents>
					<colinfo id="NAM" size="256" type="STRING"/>
					<colinfo id="SPT" size="256" type="STRING"/>
					<record>
						<NAM></NAM>
						<SPT></SPT>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_days">
				<Contents>
					<colinfo id="DAYS" size="256" type="STRING"/>
					<record>
						<DAYS></DAYS>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_slagbn_cd">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
					<record>
						<CODE>N</CODE>
						<CODE_NAME>아니오</CODE_NAME>
					</record>
					<record>
						<CODE>Y</CODE>
						<CODE_NAME>예</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_grp_cd">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond_grp">
				<Contents>
					<colinfo id="UPN" size="256" summ="default" type="STRING"/>
					<colinfo id="CST" size="256" summ="default" type="STRING"/>
					<record>
						<CST></CST>
						<UPN></UPN>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_slarsn_cd">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cyn_cd">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME>-&#32;선택&#32;-</CODE_NAME>
					</record>
					<record>
						<CODE>Y</CODE>
						<CODE_NAME>예</CODE_NAME>
					</record>
					<record>
						<CODE>N</CODE>
						<CODE_NAME>아니오</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_hep_cd">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_fmy_cd">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_fms_cd">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE>01</CODE>
						<CODE_NAME>01년차</CODE_NAME>
					</record>
					<record>
						<CODE>02</CODE>
						<CODE_NAME>02년차</CODE_NAME>
					</record>
					<record>
						<CODE>03</CODE>
						<CODE_NAME>03년차</CODE_NAME>
					</record>
					<record>
						<CODE>04</CODE>
						<CODE_NAME>04년차</CODE_NAME>
					</record>
					<record>
						<CODE>05</CODE>
						<CODE_NAME>05년차</CODE_NAME>
					</record>
					<record>
						<CODE>06</CODE>
						<CODE_NAME>06년차</CODE_NAME>
					</record>
					<record>
						<CODE>07</CODE>
						<CODE_NAME>07년차</CODE_NAME>
					</record>
					<record>
						<CODE>08</CODE>
						<CODE_NAME>08년차</CODE_NAME>
					</record>
					<record>
						<CODE>09</CODE>
						<CODE_NAME>09년차</CODE_NAME>
					</record>
					<record>
						<CODE>10</CODE>
						<CODE_NAME>10년차</CODE_NAME>
					</record>
					<record>
						<CODE>11</CODE>
						<CODE_NAME>11년차</CODE_NAME>
					</record>
					<record>
						<CODE>12</CODE>
						<CODE_NAME>12년차</CODE_NAME>
					</record>
					<record>
						<CODE>13</CODE>
						<CODE_NAME>13년차</CODE_NAME>
					</record>
					<record>
						<CODE>14</CODE>
						<CODE_NAME>14년차</CODE_NAME>
					</record>
					<record>
						<CODE>15</CODE>
						<CODE_NAME>15년차</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ctp_cd">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_dateCnt">
				<Contents>
					<colinfo id="CNT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_umr">
				<Contents>
					<colinfo id="UMR" size="256" summ="default" type="STRING"/>
					<record>
						<UMR></UMR>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_hwr_cd">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE>A</CODE>
						<CODE_NAME>유선</CODE_NAME>
					</record>
					<record>
						<CODE>B</CODE>
						<CODE_NAME>무선</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_gbn_cd">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cost">
				<Contents>
					<colinfo id="GNO" size="256" summ="default" type="STRING"/>
					<colinfo id="NMT" size="256" summ="default" type="STRING"/>
					<colinfo id="JMT" size="256" summ="default" type="STRING"/>
					<colinfo id="KMT" size="256" summ="default" type="STRING"/>
					<colinfo id="HMT" size="256" summ="default" type="STRING"/>
					<colinfo id="DMT" size="256" summ="default" type="STRING"/>
					<colinfo id="CMT" size="256" summ="default" type="STRING"/>
					<colinfo id="GMT" size="256" summ="default" type="STRING"/>
					<colinfo id="COST" size="256" summ="default" type="STRING"/>
					<colinfo id="RAT" size="256" summ="default" type="STRING"/>
					<colinfo id="TAMT" size="256" summ="default" type="STRING"/>
					<colinfo id="SJT" size="256" summ="default" type="STRING"/>
					<colinfo id="ZYEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="INC" size="256" summ="default" type="STRING"/>
					<colinfo id="ACMT" size="256" summ="default" type="STRING"/>
					<record>
						<CMT></CMT>
						<COST></COST>
						<DMT></DMT>
						<GMT></GMT>
						<GNO></GNO>
						<HMT></HMT>
						<INC></INC>
						<JMT></JMT>
						<KMT></KMT>
						<NMT></NMT>
						<RAT></RAT>
						<SJT></SJT>
						<TAMT></TAMT>
						<ZYEAR></ZYEAR>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond_tvr">
				<Contents>
					<colinfo id="GNO" size="256" summ="default" type="STRING"/>
					<colinfo id="UPN" size="256" summ="default" type="STRING"/>
					<colinfo id="CST" size="256" summ="default" type="STRING"/>
					<colinfo id="DOCNO" size="256" summ="default" type="STRING"/>
					<record>
						<GNO></GNO>
						<UPN></UPN>
						<CST></CST>
						<DOCNO></DOCNO>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_tvr">
				<Contents>
					<colinfo id="TVR" size="256" summ="default" type="STRING"/>
					<record>
						<TVR></TVR>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cnt">
				<Contents>
					<colinfo id="CNT" size="256" summ="default" type="STRING"/>
					<record>
						<CNT></CNT>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond_cnt">
				<Contents>
					<colinfo id="GNO" size="256" summ="default" type="STRING"/>
					<colinfo id="UPN" size="256" summ="default" type="STRING"/>
					<colinfo id="CST" size="256" summ="default" type="STRING"/>
					<colinfo id="DOCNO" size="256" summ="default" type="STRING"/>
					<record>
						<GNO></GNO>
						<UPN></UPN>
						<CST></CST>
						<DOCNO></DOCNO>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_dnd">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE>A</CODE>
						<CODE_NAME>Mini-PBX</CODE_NAME>
					</record>
					<record>
						<CODE>B</CODE>
						<CODE_NAME>Di-PBX2</CODE_NAME>
					</record>
					<record>
						<CODE>C</CODE>
						<CODE_NAME>Hybrid-PBX</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond_est">
				<Contents>
					<colinfo id="UPN" size="256" summ="default" type="STRING"/>
					<colinfo id="CST" size="256" summ="default" type="STRING"/>
					<colinfo id="TEM" size="256" summ="default" type="STRING"/>
					<colinfo id="RDT" size="256" summ="default" type="STRING"/>
					<colinfo id="SIR" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="ARA" size="256" summ="default" type="STRING"/>
					<colinfo id="JPGBN" size="256" summ="default" type="STRING"/>
					<colinfo id="GND" size="256" summ="default" type="STRING"/>
					<colinfo id="UHJ_FM" size="256" summ="default" type="STRING"/>
					<colinfo id="UHJ_TO" size="256" summ="default" type="STRING"/>
					<colinfo id="USD" size="256" summ="default" type="STRING"/>
					<colinfo id="UHJ" size="256" summ="default" type="STRING"/>
					<colinfo id="GNO" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN" size="256" summ="default" type="STRING"/>
					<record>
						<ARA></ARA>
						<CST></CST>
						<GBN></GBN>
						<GND></GND>
						<GNO></GNO>
						<JPGBN></JPGBN>
						<RDT></RDT>
						<SEQ></SEQ>
						<SIR></SIR>
						<TEM></TEM>
						<UHJ></UHJ>
						<UHJ_FM></UHJ_FM>
						<UHJ_TO></UHJ_TO>
						<UPN></UPN>
						<USD></USD>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_docno_gen">
				<Contents>
					<colinfo id="PFX" size="256" type="STRING"/>
					<colinfo id="DOCNO" size="256" type="STRING"/>
					<record>
						<PFX></PFX>
						<DOCNO></DOCNO>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_detail_pri">
				<Contents>
					<colinfo id="SEQ2" size="256" summ="default" type="STRING"/>
					<colinfo id="STD" size="256" summ="default" type="STRING"/>
					<colinfo id="ETD" size="256" summ="default" type="STRING"/>
					<colinfo id="TOT" size="256" summ="default" type="STRING"/>
					<colinfo id="TEM" size="256" summ="default" type="STRING"/>
					<colinfo id="RDT" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="SIR" size="256" summ="default" type="STRING"/>
					<colinfo id="MON" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond_req">
				<Contents>
					<colinfo id="DOCNO" size="256" summ="default" type="STRING"/>
					<record>
						<DOCNO></DOCNO>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list_req">
				<Contents>
					<colinfo id="UPN" size="256" summ="default" type="STRING"/>
					<colinfo id="CST" size="256" summ="default" type="STRING"/>
					<colinfo id="PJT" size="256" summ="default" type="STRING"/>
					<colinfo id="GND" size="256" summ="default" type="STRING"/>
					<colinfo id="USD" size="256" summ="default" type="STRING"/>
					<colinfo id="UHJ" size="256" summ="default" type="STRING"/>
					<colinfo id="GNO" size="256" summ="default" type="STRING"/>
					<colinfo id="APSTAT" size="256" summ="default" type="STRING"/>
					<colinfo id="REDPT1" size="256" summ="default" type="STRING"/>
					<colinfo id="DOCNO" size="256" summ="default" type="STRING"/>
					<colinfo id="DOCKIND" size="256" summ="default" type="STRING"/>
					<record>
						<APSTAT></APSTAT>
						<DOCKIND></DOCKIND>
						<DOCNO></DOCNO>
						<GNO></GNO>
						<REDPT1></REDPT1>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_decide">
				<Contents>
					<colinfo id="MANDT" size="256" summ="default" type="STRING"/>
					<colinfo id="DOCNO" size="256" summ="default" type="STRING"/>
					<colinfo id="DOCKIND" size="256" summ="default" type="STRING"/>
					<colinfo id="APPGUBN" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQNO" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQSTAT" size="256" summ="default" type="STRING"/>
					<colinfo id="APDPT1" size="256" summ="default" type="STRING"/>
					<colinfo id="APDPT1_N" size="256" summ="default" type="STRING"/>
					<colinfo id="APNUM" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE" size="256" summ="default" type="STRING"/>
					<colinfo id="APTIM" size="256" summ="default" type="STRING"/>
					<colinfo id="APDESC" size="256" summ="default" type="STRING"/>
					<colinfo id="UPN" size="256" summ="default" type="STRING"/>
					<colinfo id="CST" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cost_o">
				<Contents>
					<colinfo id="NMT" size="256" summ="default" type="STRING"/>
					<colinfo id="JMT" size="256" summ="default" type="STRING"/>
					<colinfo id="JMT2" size="256" summ="default" type="STRING"/>
					<colinfo id="KMT" size="256" summ="default" type="STRING"/>
					<colinfo id="HMT" size="256" summ="default" type="STRING"/>
					<colinfo id="DMT" size="256" summ="default" type="STRING"/>
					<colinfo id="ACMT" size="256" summ="default" type="STRING"/>
					<colinfo id="CMT" size="256" summ="default" type="STRING"/>
					<colinfo id="GMT" size="256" summ="default" type="STRING"/>
					<colinfo id="GMT2" size="256" summ="default" type="STRING"/>
					<colinfo id="COS1" size="256" summ="default" type="STRING"/>
					<colinfo id="COS2" size="256" summ="default" type="STRING"/>
					<colinfo id="PER" size="256" summ="default" type="STRING"/>
					<colinfo id="AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="TAMT" size="256" summ="default" type="STRING"/>
					<colinfo id="COSTT" size="256" summ="default" type="STRING"/>
					<colinfo id="COSTT2" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cost_sum">
				<Contents>
					<colinfo id="NMT" size="256" summ="default" type="STRING"/>
					<colinfo id="JMT" size="256" summ="default" type="STRING"/>
					<colinfo id="JMT2" size="256" summ="default" type="STRING"/>
					<colinfo id="KMT" size="256" summ="default" type="STRING"/>
					<colinfo id="HMT" size="256" summ="default" type="STRING"/>
					<colinfo id="DMT" size="256" summ="default" type="STRING"/>
					<colinfo id="ACMT" size="256" summ="default" type="STRING"/>
					<colinfo id="CMT" size="256" summ="default" type="STRING"/>
					<colinfo id="GMT" size="256" summ="default" type="STRING"/>
					<colinfo id="GMT2" size="256" summ="default" type="STRING"/>
					<colinfo id="COS1" size="256" summ="default" type="STRING"/>
					<colinfo id="COS2" size="256" summ="default" type="STRING"/>
					<colinfo id="COSTT" size="256" summ="default" type="STRING"/>
					<colinfo id="COSTT2" size="256" summ="default" type="STRING"/>
					<colinfo id="AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="TAMT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cost_i">
				<Contents>
					<colinfo id="STD" size="256" summ="default" type="STRING"/>
					<colinfo id="ETD" size="256" summ="default" type="STRING"/>
					<colinfo id="ZYEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="MMN" size="256" summ="default" type="STRING"/>
					<colinfo id="HEP" size="256" summ="default" type="STRING"/>
					<colinfo id="CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="GBU" size="256" summ="default" type="STRING"/>
					<colinfo id="HNO" size="256" summ="default" type="STRING"/>
					<colinfo id="HMT" size="256" summ="default" type="STRING"/>
					<colinfo id="DMT" size="256" summ="default" type="STRING"/>
					<colinfo id="ACMT" size="256" summ="default" type="STRING"/>
					<colinfo id="SPC" size="256" summ="default" type="STRING"/>
					<colinfo id="FLR" size="256" summ="default" type="STRING"/>
					<colinfo id="SPD" size="256" summ="default" type="STRING"/>
					<colinfo id="FDT" size="256" summ="default" type="STRING"/>
					<colinfo id="BLD" size="256" summ="default" type="STRING"/>
					<colinfo id="TEM" size="256" summ="default" type="STRING"/>
					<colinfo id="TYN" size="256" summ="default" type="STRING"/>
					<colinfo id="KND" size="256" summ="default" type="STRING"/>
					<colinfo id="AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="ACD" size="256" summ="default" type="STRING"/>
					<colinfo id="HWR" size="256" summ="default" type="STRING"/>
					<colinfo id="DND" size="256" summ="default" type="STRING"/>
					<colinfo id="ACND" size="256" summ="default" type="STRING"/>
					<colinfo id="FHRM" size="256" summ="default" type="STRING"/>
					<colinfo id="FHRU" size="256" summ="default" type="STRING"/>
					<colinfo id="FDPX" size="256" summ="default" type="STRING"/>
					<colinfo id="ABG" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_apstat">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<colinfo id="DTEXT1" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_doc_update">
				<Contents>
					<colinfo id="UPN" size="256" summ="default" type="STRING"/>
					<colinfo id="CST" size="256" summ="default" type="STRING"/>
					<colinfo id="PJT" size="256" summ="default" type="STRING"/>
					<colinfo id="HNO" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="DOC" size="256" summ="default" type="STRING"/>
					<colinfo id="DNO" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_doc_status">
				<Contents>
					<colinfo id="APSTAT" size="256" summ="default" type="STRING"/>
					<record>
						<CNT></CNT>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond_rate">
				<Contents>
					<colinfo id="GNO" size="256" summ="default" type="STRING"/>
					<record>
						<GNO></GNO>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_rate">
				<Contents>
					<colinfo id="RAT" size="256" summ="default" type="STRING"/>
					<record>
						<RAT></RAT>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_lists">
				<Contents>
					<colinfo id="BSU" size="15" summ="default" type="STRING"/>
					<colinfo id="CQT" size="13" summ="default" type="DECIMAL"/>
					<colinfo id="ISR" size="6" summ="default" type="STRING"/>
					<colinfo id="RTO" size="7" summ="default" type="DECIMAL"/>
					<colinfo id="SEQ" size="6" summ="default" type="STRING"/>
					<colinfo id="SFR" size="24" summ="default" type="STRING"/>
					<colinfo id="STO" size="24" summ="default" type="STRING"/>
					<colinfo id="FLAG" size="0" summ="default" type="STRING"/>
					<colinfo id="DBYN" size="256" summ="default" type="STRING"/>
					<colinfo id="CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="GND" size="256" summ="default" type="STRING"/>
					<colinfo id="SYO" size="256" summ="default" type="STRING"/>
					<colinfo id="UYO" size="256" summ="default" type="STRING"/>
					<colinfo id="AMT" size="13" summ="default" type="DECIMAL"/>
					<colinfo id="VAT" size="256" summ="default" type="STRING"/>
					<colinfo id="TOT" size="13" summ="default" type="DECIMAL"/>
					<colinfo id="VABT" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="AMBT" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="TOBT" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="AMTT" size="13" summ="default" type="DECIMAL"/>
					<colinfo id="VATT" size="256" summ="default" type="STRING"/>
					<colinfo id="TOTT" size="13" summ="default" type="DECIMAL"/>
					<colinfo id="UPN" size="256" summ="default" type="STRING"/>
					<colinfo id="CST" size="256" summ="default" type="STRING"/>
					<colinfo id="G_CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="PST" size="256" summ="default" type="STRING"/>
					<colinfo id="TMP" size="256" summ="default" type="STRING"/>
					<colinfo id="HUR" size="256" summ="default" type="STRING"/>
					<colinfo id="TGB" size="256" summ="default" type="STRING"/>
					<colinfo id="M_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="CS604_US" size="256" summ="default" type="STRING"/>
					<colinfo id="CDY" size="256" summ="default" type="STRING"/>
					<colinfo id="BDGBN" size="256" summ="default" type="STRING"/>
					<colinfo id="ABG" size="256" summ="default" type="STRING"/>
					<colinfo id="CPD" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_doc_status_add">
				<Contents>
					<colinfo id="CHK_GKD" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK_FM" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK_HRTS" size="256" summ="default" type="STRING"/>
					<colinfo id="APSTAT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_chkUms">
				<Contents>
					<colinfo id="CHK_GKD" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK_FM" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK_HRTS" size="256" summ="default" type="STRING"/>
					<colinfo id="APSTAT" size="256" summ="default" type="STRING"/>
					<colinfo id="TGB" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_costT">
				<Contents></Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cst_cd1">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME>-&#32;선택&#32;-</CODE_NAME>
					</record>
					<record>
						<CODE>Y</CODE>
						<CODE_NAME>예</CODE_NAME>
					</record>
					<record>
						<CODE>N</CODE>
						<CODE_NAME>아니오</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_rcond">
				<Contents>
					<colinfo id="ZPROGRAM" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN" size="256" summ="default" type="STRING"/>
					<record>
						<GBN></GBN>
						<ZPROGRAM></ZPROGRAM>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list_tmp" OnColumnChanged="ds_list_OnColumnChanged">
				<Contents>
					<colinfo id="ABG" size="3" summ="default" type="STRING"/>
					<colinfo id="ABG_NM" size="60" summ="default" type="STRING"/>
					<colinfo id="AGB" size="3" summ="default" type="STRING"/>
					<colinfo id="AGB_NM" size="60" summ="default" type="STRING"/>
					<colinfo id="ARA" size="6" summ="default" type="STRING"/>
					<colinfo id="ARA_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="BJG" size="3" summ="default" type="STRING"/>
					<colinfo id="BPM" size="30" summ="default" type="STRING"/>
					<colinfo id="BSU" size="12" summ="default" type="STRING"/>
					<colinfo id="BSU_NM" size="105" summ="default" type="STRING"/>
					<colinfo id="BUJ" size="0" summ="default" type="STRING"/>
					<colinfo id="BUJ_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK" size="0" summ="default" type="STRING"/>
					<colinfo id="CST" size="9" summ="default" type="STRING"/>
					<colinfo id="FLAG" size="0" summ="default" type="STRING"/>
					<colinfo id="FSD" size="24" summ="default" type="STRING"/>
					<colinfo id="HNA" size="90" summ="default" type="STRING"/>
					<colinfo id="HNO" size="9" summ="default" type="STRING"/>
					<colinfo id="HTY" size="3" summ="default" type="STRING"/>
					<colinfo id="IYN" size="3" summ="default" type="STRING"/>
					<colinfo id="JUJ" size="0" summ="default" type="STRING"/>
					<colinfo id="JUJ_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="KND_YN" size="256" summ="default" type="STRING"/>
					<colinfo id="KND" size="3" summ="default" type="STRING"/>
					<colinfo id="KND_NM" size="60" summ="default" type="STRING"/>
					<colinfo id="MCHK" size="256" summ="default" type="STRING"/>
					<colinfo id="PJT" size="15" summ="default" type="STRING"/>
					<colinfo id="RGB" size="3" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="6" summ="default" type="STRING"/>
					<colinfo id="AMT" size="13" summ="default" type="DECIMAL"/>
					<colinfo id="VAT" size="13" summ="default" type="DECIMAL"/>
					<colinfo id="TOT" size="13" summ="default" type="DECIMAL"/>
					<colinfo id="AMBT" size="13" summ="default" type="DECIMAL"/>
					<colinfo id="VABT" size="13" summ="default" type="DECIMAL"/>
					<colinfo id="TOBT" size="13" summ="default" type="DECIMAL"/>
					<colinfo id="AMTT" size="13" summ="default" type="DECIMAL"/>
					<colinfo id="VATT" size="13" summ="default" type="DECIMAL"/>
					<colinfo id="TOTT" size="13" summ="default" type="DECIMAL"/>
					<colinfo id="ORG_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="ORG_VAT" size="256" summ="default" type="STRING"/>
					<colinfo id="ORG_TOT" size="256" summ="default" type="STRING"/>
					<colinfo id="ORG_AMBT" size="256" summ="default" type="STRING"/>
					<colinfo id="ORG_VABT" size="256" summ="default" type="STRING"/>
					<colinfo id="ORG_TOBT" size="256" summ="default" type="STRING"/>
					<colinfo id="ORG_AMTT" size="256" summ="default" type="STRING"/>
					<colinfo id="ORG_VATT" size="256" summ="default" type="STRING"/>
					<colinfo id="ORG_TOTT" size="256" summ="default" type="STRING"/>
					<colinfo id="ORG_BJG" size="256" summ="default" type="STRING"/>
					<colinfo id="ORG_USD" size="256" summ="default" type="STRING"/>
					<colinfo id="ORG_KND_YN" size="256" summ="default" type="STRING"/>
					<colinfo id="UGS" size="24" summ="default" type="STRING"/>
					<colinfo id="UMR" size="24" summ="default" type="STRING"/>
					<colinfo id="UPN" size="15" summ="default" type="STRING"/>
					<colinfo id="USD" size="24" summ="default" type="STRING"/>
					<colinfo id="SGBN" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSPEC" size="9" summ="default" type="STRING"/>
					<colinfo id="ZSPEC1" size="15" summ="default" type="STRING"/>
					<colinfo id="ZSPEC2" size="75" summ="default" type="STRING"/>
					<colinfo id="ZSPEC3" size="12" summ="default" type="STRING"/>
					<colinfo id="PST" size="256" summ="default" type="STRING"/>
					<colinfo id="PRO" size="256" summ="default" type="STRING"/>
					<colinfo id="TYP" size="256" summ="default" type="STRING"/>
					<colinfo id="GKD" size="256" summ="default" type="STRING"/>
					<colinfo id="GKD_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="T_GKD" size="256" summ="default" type="STRING"/>
					<colinfo id="GYB" size="256" summ="default" type="STRING"/>
					<colinfo id="CGB" size="256" summ="default" type="STRING"/>
					<colinfo id="GND" size="256" summ="default" type="STRING"/>
					<colinfo id="UMS" size="256" summ="default" type="STRING"/>
					<colinfo id="MMN" size="256" summ="default" type="STRING"/>
					<colinfo id="UHJ" size="256" summ="default" type="STRING"/>
					<colinfo id="BGB" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="TIS" size="256" summ="default" type="STRING"/>
					<colinfo id="JKH" size="256" summ="default" type="STRING"/>
					<colinfo id="YYB" size="256" summ="default" type="STRING"/>
					<colinfo id="RMK" size="256" summ="default" type="STRING"/>
					<colinfo id="ZER" size="256" summ="default" type="STRING"/>
					<colinfo id="SLA" size="256" summ="default" type="STRING"/>
					<colinfo id="WYB" size="256" summ="default" type="STRING"/>
					<colinfo id="RTO" size="256" summ="default" type="STRING"/>
					<colinfo id="GBM" size="256" summ="default" type="STRING"/>
					<colinfo id="WIL" size="256" summ="default" type="STRING"/>
					<colinfo id="REQ" size="256" summ="default" type="STRING"/>
					<colinfo id="EXP" size="256" summ="default" type="STRING"/>
					<colinfo id="CS2" size="256" summ="default" type="STRING"/>
					<colinfo id="IS2" size="256" summ="default" type="STRING"/>
					<colinfo id="BHD" size="256" summ="default" type="STRING"/>
					<colinfo id="MYT" size="256" summ="default" type="STRING"/>
					<colinfo id="GBU" size="256" summ="default" type="STRING"/>
					<colinfo id="SQL_FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="MAXSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="HST" size="256" summ="default" type="STRING"/>
					<colinfo id="GRP" size="256" summ="default" type="STRING"/>
					<colinfo id="SLR" size="256" summ="default" type="STRING"/>
					<colinfo id="CYN" size="256" summ="default" type="STRING"/>
					<colinfo id="HMT" size="256" summ="default" type="STRING"/>
					<colinfo id="DMT" size="256" summ="default" type="STRING"/>
					<colinfo id="SUT" size="256" summ="default" type="STRING"/>
					<colinfo id="HYN" size="256" summ="default" type="STRING"/>
					<colinfo id="DYN" size="256" summ="default" type="STRING"/>
					<colinfo id="HEP" size="256" summ="default" type="STRING"/>
					<colinfo id="FMY" size="256" summ="default" type="STRING"/>
					<colinfo id="FMS" size="256" summ="default" type="STRING"/>
					<colinfo id="CRS" size="256" summ="default" type="STRING"/>
					<colinfo id="CRS_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="FHG" size="256" summ="default" type="STRING"/>
					<colinfo id="FDG" size="256" summ="default" type="STRING"/>
					<colinfo id="ADT" size="256" summ="default" type="STRING"/>
					<colinfo id="CTP" size="256" summ="default" type="STRING"/>
					<colinfo id="HWR" size="256" summ="default" type="STRING"/>
					<colinfo id="CFG" size="256" summ="default" type="STRING"/>
					<colinfo id="SID" size="256" summ="default" type="STRING"/>
					<colinfo id="SNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="CBN" size="256" summ="default" type="STRING"/>
					<colinfo id="DIF" size="256" summ="default" type="STRING"/>
					<colinfo id="DIBF" size="256" summ="default" type="STRING"/>
					<colinfo id="DITF" size="256" summ="default" type="STRING"/>
					<colinfo id="VKGRP" size="256" summ="default" type="STRING"/>
					<colinfo id="BSUGB" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSPEC7" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSPEC12" size="256" summ="default" type="STRING"/>
					<colinfo id="BLD" size="256" summ="default" type="STRING"/>
					<colinfo id="FDT" size="256" summ="default" type="STRING"/>
					<colinfo id="DND" size="256" summ="default" type="STRING"/>
					<colinfo id="ACD" size="256" summ="default" type="STRING"/>
					<colinfo id="LTC" size="256" summ="default" type="STRING"/>
					<colinfo id="LTY" size="256" summ="default" type="STRING"/>
					<colinfo id="LTS" size="256" summ="default" type="STRING"/>
					<colinfo id="FCM" size="256" summ="default" type="STRING"/>
					<colinfo id="DCE" size="256" summ="default" type="STRING"/>
					<colinfo id="GNO" size="256" summ="default" type="STRING"/>
					<colinfo id="RGS" size="256" summ="default" type="STRING"/>
					<colinfo id="RMR" size="256" summ="default" type="STRING"/>
					<colinfo id="APSTAT" size="256" summ="default" type="STRING"/>
					<colinfo id="REDPT1" size="256" summ="default" type="STRING"/>
					<colinfo id="DAT" size="256" summ="default" type="STRING"/>
					<colinfo id="ZMAN" size="256" summ="default" type="STRING"/>
					<colinfo id="CSE" size="256" summ="default" type="STRING"/>
					<colinfo id="HFR" size="256" summ="default" type="STRING"/>
					<colinfo id="BDGBN" size="256" summ="default" type="STRING"/>
					<colinfo id="ETC" size="256" summ="default" type="STRING"/>
					<colinfo id="ETCBG" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_halfcancle">
				<Contents>
					<colinfo id="DOCNO" size="256" summ="default" type="STRING"/>
					<colinfo id="APSTAT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_halfcond">
				<Contents>
					<colinfo id="UPN" size="256" summ="default" type="STRING"/>
					<colinfo id="CST" size="256" summ="default" type="STRING"/>
					<colinfo id="GNO" size="256" summ="default" type="STRING"/>
					<record>
						<CST></CST>
						<GNO></GNO>
						<UPN></UPN>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_isonhand_result">
				<Contents>
					<colinfo id="CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="UPN" size="256" summ="default" type="STRING"/>
					<colinfo id="CST" size="256" summ="default" type="STRING"/>
					<colinfo id="MIN_UGS" size="256" summ="default" type="STRING"/>
					<colinfo id="MAX_UMR" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_isonhand_cond">
				<Contents>
					<colinfo id="PJT" size="256" summ="default" type="STRING"/>
					<colinfo id="HNO" size="256" summ="default" type="STRING"/>
					<colinfo id="UGS" size="256" summ="default" type="STRING"/>
					<colinfo id="UMR" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list_copy">
				<Contents>
					<colinfo id="ABG" size="3" summ="default" type="STRING"/>
					<colinfo id="ABG_NM" size="60" summ="default" type="STRING"/>
					<colinfo id="AGB" size="3" summ="default" type="STRING"/>
					<colinfo id="AGB_NM" size="60" summ="default" type="STRING"/>
					<colinfo id="ARA" size="6" summ="default" type="STRING"/>
					<colinfo id="ARA_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="BJG" size="3" summ="default" type="STRING"/>
					<colinfo id="BPM" size="30" summ="default" type="STRING"/>
					<colinfo id="BSU" size="12" summ="default" type="STRING"/>
					<colinfo id="BSU_NM" size="105" summ="default" type="STRING"/>
					<colinfo id="BUJ" size="0" summ="default" type="STRING"/>
					<colinfo id="BUJ_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK" size="0" summ="default" type="STRING"/>
					<colinfo id="CST" size="9" summ="default" type="STRING"/>
					<colinfo id="FLAG" size="0" summ="default" type="STRING"/>
					<colinfo id="FSD" size="24" summ="default" type="STRING"/>
					<colinfo id="HNA" size="90" summ="default" type="STRING"/>
					<colinfo id="HNO" size="9" summ="default" type="STRING"/>
					<colinfo id="HTY" size="3" summ="default" type="STRING"/>
					<colinfo id="IYN" size="3" summ="default" type="STRING"/>
					<colinfo id="JUJ" size="0" summ="default" type="STRING"/>
					<colinfo id="JUJ_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="KND_YN" size="256" summ="default" type="STRING"/>
					<colinfo id="KND" size="3" summ="default" type="STRING"/>
					<colinfo id="KND_NM" size="60" summ="default" type="STRING"/>
					<colinfo id="MCHK" size="256" summ="default" type="STRING"/>
					<colinfo id="PJT" size="15" summ="default" type="STRING"/>
					<colinfo id="RGB" size="3" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="6" summ="default" type="STRING"/>
					<colinfo id="AMT" size="13" summ="default" type="DECIMAL"/>
					<colinfo id="VAT" size="13" summ="default" type="DECIMAL"/>
					<colinfo id="TOT" size="13" summ="default" type="DECIMAL"/>
					<colinfo id="AMBT" size="13" summ="default" type="DECIMAL"/>
					<colinfo id="VABT" size="13" summ="default" type="DECIMAL"/>
					<colinfo id="TOBT" size="13" summ="default" type="DECIMAL"/>
					<colinfo id="AMTT" size="13" summ="default" type="DECIMAL"/>
					<colinfo id="VATT" size="13" summ="default" type="DECIMAL"/>
					<colinfo id="TOTT" size="13" summ="default" type="DECIMAL"/>
					<colinfo id="ORG_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="ORG_VAT" size="256" summ="default" type="STRING"/>
					<colinfo id="ORG_TOT" size="256" summ="default" type="STRING"/>
					<colinfo id="ORG_AMBT" size="256" summ="default" type="STRING"/>
					<colinfo id="ORG_VABT" size="256" summ="default" type="STRING"/>
					<colinfo id="ORG_TOBT" size="256" summ="default" type="STRING"/>
					<colinfo id="ORG_AMTT" size="256" summ="default" type="STRING"/>
					<colinfo id="ORG_VATT" size="256" summ="default" type="STRING"/>
					<colinfo id="ORG_TOTT" size="256" summ="default" type="STRING"/>
					<colinfo id="ORG_BJG" size="256" summ="default" type="STRING"/>
					<colinfo id="ORG_USD" size="256" summ="default" type="STRING"/>
					<colinfo id="ORG_KND_YN" size="256" summ="default" type="STRING"/>
					<colinfo id="UGS" size="24" summ="default" type="STRING"/>
					<colinfo id="UMR" size="24" summ="default" type="STRING"/>
					<colinfo id="UPN" size="15" summ="default" type="STRING"/>
					<colinfo id="USD" size="24" summ="default" type="STRING"/>
					<colinfo id="SGBN" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSPEC" size="9" summ="default" type="STRING"/>
					<colinfo id="ZSPEC1" size="15" summ="default" type="STRING"/>
					<colinfo id="ZSPEC2" size="75" summ="default" type="STRING"/>
					<colinfo id="ZSPEC3" size="12" summ="default" type="STRING"/>
					<colinfo id="PST" size="256" summ="default" type="STRING"/>
					<colinfo id="PRO" size="256" summ="default" type="STRING"/>
					<colinfo id="TYP" size="256" summ="default" type="STRING"/>
					<colinfo id="GKD" size="256" summ="default" type="STRING"/>
					<colinfo id="GKD_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="T_GKD" size="256" summ="default" type="STRING"/>
					<colinfo id="GYB" size="256" summ="default" type="STRING"/>
					<colinfo id="CGB" size="256" summ="default" type="STRING"/>
					<colinfo id="GND" size="256" summ="default" type="STRING"/>
					<colinfo id="UMS" size="256" summ="default" type="STRING"/>
					<colinfo id="MMN" size="256" summ="default" type="STRING"/>
					<colinfo id="UHJ" size="256" summ="default" type="STRING"/>
					<colinfo id="BGB" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="TIS" size="256" summ="default" type="STRING"/>
					<colinfo id="JKH" size="256" summ="default" type="STRING"/>
					<colinfo id="YYB" size="256" summ="default" type="STRING"/>
					<colinfo id="RMK" size="256" summ="default" type="STRING"/>
					<colinfo id="ZER" size="256" summ="default" type="STRING"/>
					<colinfo id="SLA" size="256" summ="default" type="STRING"/>
					<colinfo id="WYB" size="256" summ="default" type="STRING"/>
					<colinfo id="RTO" size="256" summ="default" type="STRING"/>
					<colinfo id="GBM" size="256" summ="default" type="STRING"/>
					<colinfo id="WIL" size="256" summ="default" type="STRING"/>
					<colinfo id="REQ" size="256" summ="default" type="STRING"/>
					<colinfo id="EXP" size="256" summ="default" type="STRING"/>
					<colinfo id="CS2" size="256" summ="default" type="STRING"/>
					<colinfo id="IS2" size="256" summ="default" type="STRING"/>
					<colinfo id="BHD" size="256" summ="default" type="STRING"/>
					<colinfo id="MYT" size="256" summ="default" type="STRING"/>
					<colinfo id="GBU" size="256" summ="default" type="STRING"/>
					<colinfo id="SQL_FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="MAXSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="HST" size="256" summ="default" type="STRING"/>
					<colinfo id="GRP" size="256" summ="default" type="STRING"/>
					<colinfo id="SLR" size="256" summ="default" type="STRING"/>
					<colinfo id="CYN" size="256" summ="default" type="STRING"/>
					<colinfo id="HMT" size="256" summ="default" type="STRING"/>
					<colinfo id="DMT" size="256" summ="default" type="STRING"/>
					<colinfo id="SUT" size="256" summ="default" type="STRING"/>
					<colinfo id="HYN" size="256" summ="default" type="STRING"/>
					<colinfo id="DYN" size="256" summ="default" type="STRING"/>
					<colinfo id="HEP" size="256" summ="default" type="STRING"/>
					<colinfo id="FMY" size="256" summ="default" type="STRING"/>
					<colinfo id="FMS" size="256" summ="default" type="STRING"/>
					<colinfo id="CRS" size="256" summ="default" type="STRING"/>
					<colinfo id="CRS_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="FHG" size="256" summ="default" type="STRING"/>
					<colinfo id="FDG" size="256" summ="default" type="STRING"/>
					<colinfo id="ADT" size="256" summ="default" type="STRING"/>
					<colinfo id="CTP" size="256" summ="default" type="STRING"/>
					<colinfo id="HWR" size="256" summ="default" type="STRING"/>
					<colinfo id="CFG" size="256" summ="default" type="STRING"/>
					<colinfo id="SID" size="256" summ="default" type="STRING"/>
					<colinfo id="SNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="CBN" size="256" summ="default" type="STRING"/>
					<colinfo id="DIF" size="256" summ="default" type="STRING"/>
					<colinfo id="DIBF" size="256" summ="default" type="STRING"/>
					<colinfo id="DITF" size="256" summ="default" type="STRING"/>
					<colinfo id="VKGRP" size="256" summ="default" type="STRING"/>
					<colinfo id="BSUGB" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSPEC7" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSPEC12" size="256" summ="default" type="STRING"/>
					<colinfo id="BLD" size="256" summ="default" type="STRING"/>
					<colinfo id="FDT" size="256" summ="default" type="STRING"/>
					<colinfo id="DND" size="256" summ="default" type="STRING"/>
					<colinfo id="ACD" size="256" summ="default" type="STRING"/>
					<colinfo id="LTC" size="256" summ="default" type="STRING"/>
					<colinfo id="LTY" size="256" summ="default" type="STRING"/>
					<colinfo id="LTS" size="256" summ="default" type="STRING"/>
					<colinfo id="FCM" size="256" summ="default" type="STRING"/>
					<colinfo id="DCE" size="256" summ="default" type="STRING"/>
					<colinfo id="GNO" size="256" summ="default" type="STRING"/>
					<colinfo id="RGS" size="256" summ="default" type="STRING"/>
					<colinfo id="RMR" size="256" summ="default" type="STRING"/>
					<colinfo id="APSTAT" size="256" summ="default" type="STRING"/>
					<colinfo id="REDPT1" size="256" summ="default" type="STRING"/>
					<colinfo id="DAT" size="256" summ="default" type="STRING"/>
					<colinfo id="ZMAN" size="256" summ="default" type="STRING"/>
					<colinfo id="CSE" size="256" summ="default" type="STRING"/>
					<colinfo id="HFR" size="256" summ="default" type="STRING"/>
					<colinfo id="BDGBN" size="256" summ="default" type="STRING"/>
					<colinfo id="ETC" size="256" summ="default" type="STRING"/>
					<colinfo id="ETCBG" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_wbap01">
				<Contents>
					<colinfo id="APSTAT" size="3" summ="default" type="STRING"/>
					<colinfo id="CRDATE" size="24" summ="default" type="STRING"/>
					<colinfo id="CRDPT1" size="24" summ="default" type="STRING"/>
					<colinfo id="CRDPT1_N" size="60" summ="default" type="STRING"/>
					<colinfo id="CRIRUM" size="60" summ="default" type="STRING"/>
					<colinfo id="CRTIM" size="18" summ="default" type="STRING"/>
					<colinfo id="DOCKIND" size="3" summ="default" type="STRING"/>
					<colinfo id="DOCNO" size="30" summ="default" type="STRING"/>
					<colinfo id="DOCSEQ" size="6" summ="default" type="STRING"/>
					<colinfo id="REDATE" size="24" summ="default" type="STRING"/>
					<colinfo id="REDPT1" size="24" summ="default" type="STRING"/>
					<colinfo id="REDPT1_N" size="60" summ="default" type="STRING"/>
					<colinfo id="REIRUM" size="60" summ="default" type="STRING"/>
					<colinfo id="RETIM" size="18" summ="default" type="STRING"/>
					<colinfo id="FNAM" size="256" summ="default" type="STRING"/>
					<colinfo id="FSIZE" size="256" summ="default" type="STRING"/>
					<colinfo id="FILE_PATH" size="256" summ="default" type="STRING"/>
					<colinfo id="TELH" size="30" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_wbap02">
				<Contents>
					<colinfo id="APDATE" size="24" summ="default" type="STRING"/>
					<colinfo id="APDESC" size="0" summ="default" type="STRING"/>
					<colinfo id="APDPT1" size="24" summ="default" type="STRING"/>
					<colinfo id="APDPT1_N" size="60" summ="default" type="STRING"/>
					<colinfo id="APIRUM" size="60" summ="default" type="STRING"/>
					<colinfo id="APNUM" size="24" summ="default" type="STRING"/>
					<colinfo id="APPGUBN" size="6" summ="default" type="STRING"/>
					<colinfo id="APRNK" size="60" summ="default" type="STRING"/>
					<colinfo id="APTIM" size="18" summ="default" type="STRING"/>
					<colinfo id="DOCKIND" size="3" summ="default" type="STRING"/>
					<colinfo id="DOCNO" size="30" summ="default" type="STRING"/>
					<colinfo id="DOCSEQ" size="6" summ="default" type="STRING"/>
					<colinfo id="SEQNO" size="6" summ="default" type="STRING"/>
					<colinfo id="SEQSTAT" size="3" summ="default" type="STRING"/>
					<colinfo id="TELH" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_zseq">
				<Contents>
					<colinfo id="BEGO" size="256" summ="default" type="STRING"/>
					<record>
						<BEGO></BEGO>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_vbeln">
				<Contents>
					<colinfo id="UPN" size="256" summ="default" type="STRING"/>
					<colinfo id="CST" size="256" summ="default" type="STRING"/>
					<colinfo id="GDN" size="256" summ="default" type="STRING"/>
					<colinfo id="GNO" size="256" summ="default" type="STRING"/>
					<colinfo id="VBELN" size="256" summ="default" type="STRING"/>
					<colinfo id="VKBUR" size="256" summ="default" type="STRING"/>
					<colinfo id="VKGRP" size="256" summ="default" type="STRING"/>
					<record>
						<CST></CST>
						<GDN></GDN>
						<GNO></GNO>
						<UPN></UPN>
						<VBELN></VBELN>
						<VKBUR></VKBUR>
						<VKGRP></VKGRP>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_beforecontract">
				<Contents>
					<colinfo id="PJT" size="256" summ="default" type="STRING"/>
					<colinfo id="HNO" size="256" summ="default" type="STRING"/>
					<colinfo id="BSU_B" size="256" summ="default" type="STRING"/>
					<colinfo id="BSU_B_VKBUR" size="256" summ="default" type="STRING"/>
					<colinfo id="BSU" size="256" summ="default" type="STRING"/>
					<colinfo id="BSU_VKBUR" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_beforecontract_cond">
				<Contents>
					<colinfo id="PJT" size="256" summ="default" type="STRING"/>
					<colinfo id="HNO" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_acnd">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_etc_cd">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
		</Datasets>
		<Shape BKColor="user12" Bottom="239" Height="36" Id="Shape4" Left="8" LineColor="user13" Right="966" TabOrder="39" Top="203" Type="Rectangle" Width="958"></Shape>
		<Shape BKColor="user12" Bottom="264" Height="26" Id="Shape5" Left="8" LineColor="user13" Right="966" TabOrder="47" Top="238" Type="Rectangle" Width="958"></Shape>
		<Shape BKColor="user12" Bottom="314" Height="26" Id="Shape7" Left="8" LineColor="user13" Right="966" TabOrder="126" Top="288" Type="Rectangle" Width="958"></Shape>
		<Shape BKColor="user12" Bottom="129" Height="26" Id="Shape1" Left="8" LineColor="user13" Right="966" TabOrder="122" Top="103" Type="Rectangle" Width="958"></Shape>
		<Shape BKColor="user12" Bottom="179" Height="26" Id="Shape6" Left="8" LineColor="user13" Right="966" TabOrder="78" Top="153" Type="Rectangle" Width="958"></Shape>
		<Shape BKColor="user0" Bottom="73" Height="30" Id="Shape0" Left="0" LineColor="user1" Right="978" TabOrder="1" Top="43" Type="Rectangle" Width="978"></Shape>
		<Static Align="Right" Height="20" Id="st_upn" Left="5" Style="sty_lb_search" TabOrder="2" Text="통합&#32;Proj&#32;" Top="48" VAlign="Middle" Width="80"></Static>
		<Edit BindDataset="ds_cond" Border="Flat" Column="UPN" Height="20" Id="ed_upn" Left="87" MaxLength="6" OnKillFocus="fn_searchComboCst" Style="sty_ipt_search" TabOrder="4" Top="48" UpperOnly="TRUE" Width="70"></Edit>
		<Static Align="Center" Border="None" Color="user7" Font="굴림,9" Height="20" Id="Static13" Left="160" TabOrder="5" Text="-" Top="48" VAlign="Middle" Width="16"></Static>
		<Static Align="Right" Height="20" Id="st_nam" Left="423" Style="sty_lb_search" TabOrder="6" Text="고객명&#32;" Top="48" VAlign="Middle" Width="80"></Static>
		<Edit Border="Flat" DisableBKColor="user5" Enable="FALSE" Height="20" Id="ed_nam" Left="505" Style="sty_ipt_search" TabOrder="8" Top="48" Width="193"></Edit>
		<Static Align="Right" Height="20" Id="st_spt" Left="700" Style="sty_lb_search" TabOrder="7" Text="현장명&#32;" Top="48" VAlign="Middle" Width="80"></Static>
		<Edit Border="Flat" DisableBKColor="user5" Enable="FALSE" Height="20" Id="ed_spt" Left="782" Style="sty_ipt_search" TabOrder="9" Top="48" Width="191"></Edit>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="CST" Column="CST" DataColumn="CST" Height="20" Id="cb_cst" INDEX="0" InnerDataset="ds_cst_cd" Left="178" OnChanged="fn_searchNamSpt" Style="sty_ipt_search" TabOrder="10" Top="47" Width="69"></Combo>
		<Static Align="Right" Height="20" Id="st_jpgbn" Left="248" Style="sty_lb_search" TabOrder="11" Text="제품구분&#32;" Top="48" VAlign="Middle" Width="80"></Static>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="CODE" Column="JPGBN" DataColumn="CODE_NAME" Height="20" Id="cb_jpgbn" INDEX="0" InnerDataset="ds_jpgbn_cd" Left="329" Style="sty_ipt_search" TabOrder="12" Top="47" Width="93"></Combo>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_set" ImageID="btn_sub_09" Left="835" LeftMargin="12" OnClick="btn_set_OnClick" Style="sty_btn" TabOrder="13" Text="매출&#32;및&#32;기성비&#32;조정" Top="79" Transparent="TRUE" Width="131"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_auto" ImageID="btn_sub_04" Left="689" LeftMargin="12" OnClick="btn_auto_OnClick" Style="sty_btn" TabOrder="14" Text="자동연장" Top="79" Transparent="TRUE" Width="71"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_del" ImageID="btn_sub_02" Left="640" LeftMargin="12" OnClick="btn_del_OnClick" Style="sty_btn" TabOrder="15" Text="삭제" Top="79" Transparent="TRUE" Width="47"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_save" ImageID="btn_sub_02" Left="592" LeftMargin="12" OnClick="btn_save_OnClick" Style="sty_btn" TabOrder="16" Text="저장" Top="80" Transparent="TRUE" Width="47"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_copy" ImageID="btn_sub_05" Left="166" LeftMargin="12" OnClick="btn_copy_OnClick" Style="sty_btn" TabOrder="17" Text="Copy&#32;Tool" Top="106" Transparent="TRUE" Width="83"></Button>
		<Static Align="Right" Height="24" Id="st_conkind" Left="9" Style="sty_lb_form_basic" TabOrder="18" Text="계약종류&#32;" Top="104" VAlign="Middle" Width="70"></Static>
		<Combo Border="Flat" CodeColumn="CODE" DataColumn="CODE_NAME" DisableBKColor="user5" Height="20" Id="cb_conkind" InnerDataset="ds_conkind_cd" Left="80" OnChanged="cb_conkind_OnChanged" Style="sty_ipt_form" TabOrder="19" Top="105" Width="85"></Combo>
		<Shape BKColor="user12" Bottom="154" Height="26" Id="Shape2" Left="8" LineColor="user13" Right="966" TabOrder="20" Top="128" Type="Rectangle" Width="958"></Shape>
		<Static Align="Right" Height="24" Id="st_bhcycle" Left="9" Style="sty_lb_form_basic" TabOrder="21" Text="발행주기&#32;" Top="129" VAlign="Middle" Width="70"></Static>
		<Combo Border="Flat" CodeColumn="CODE" DataColumn="CODE_NAME" DisableBKColor="user5" Height="20" Id="cb_bhcycle" InnerDataset="ds_bhcycle_cd" Left="80" Style="sty_ipt_form" TabOrder="22" Top="130" Width="85"></Combo>
		<Combo Border="Flat" CodeColumn="CODE" DataColumn="CODE_NAME" DisableBKColor="user5" Height="20" Id="cb_bhday" InnerDataset="ds_bhday_cd" Left="165" Style="sty_ipt_form" TabOrder="23" Top="130" Width="60"></Combo>
		<Static Align="Center" Border="None" Color="user7" Font="굴림,9" Height="20" Id="Static17" Left="227" TabOrder="24" Text="일" Top="131" VAlign="Middle" Width="18"></Static>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_per" ImageID="btn_user_06" Left="247" OnClick="btn_per_OnClick" Style="sty_btn" TabOrder="25" Text="인원상주정보" Top="131" Transparent="TRUE" Width="87"></Button>
		<Static Align="Right" Height="24" Id="st_jgcnt" Left="336" Style="sty_lb_form_basic" TabOrder="26" Text="점검회수&#32;" Top="129" VAlign="Middle" Width="80"></Static>
		<Combo Border="Flat" CodeColumn="CODE" DataColumn="CODE_NAME" DisableBKColor="user5" Height="20" Id="cb_jgcnt" InnerDataset="ds_jgcnt_cd" Left="418" Style="sty_ipt_form" TabOrder="27" Top="130" Width="41"></Combo>
		<Combo Border="Flat" CodeColumn="CODE" DataColumn="CODE_NAME" DisableBKColor="user5" Height="20" Id="cb_bsgbn" InnerDataset="ds_bsgbn_cd" Left="689" Style="sty_ipt_form" TabOrder="29" Top="105" Width="104"></Combo>
		<Static Align="Right" Height="24" Id="st_bsgbn" Left="588" Style="sty_lb_form_basic" TabOrder="28" Text="발송구분&#32;" Top="104" VAlign="Middle" Width="100"></Static>
		<Static Align="Right" Height="24" Id="st_nightgbn" Left="486" Style="sty_lb_form_basic" TabOrder="30" Text="야간점검여부&#32;" Top="129" VAlign="Middle" Width="82"></Static>
		<Checkbox BKColor="user5" DisableBKColor="user12" Height="20" Id="chk_nightgbn" Left="572" Style="sty_ipt_form_chk" TabOrder="31" Top="131" Width="16"></Checkbox>
		<Static Align="Right" Height="24" Id="st_pergbn" Left="588" Style="sty_lb_form_basic" TabOrder="32" Text="영세율&#32;적용여부&#32;" Top="129" VAlign="Middle" Width="100"></Static>
		<Combo Border="Flat" CodeColumn="CODE" DataColumn="CODE_NAME" DisableBKColor="user5" Enable="FALSE" Height="20" Id="cb_pergbn" InnerDataset="ds_pergbn_cd" Left="689" OnChanged="cb_pergbn_OnChanged" Style="sty_ipt_form" TabOrder="33" Top="130" Width="104"></Combo>
		<Static Align="Center" Border="None" Color="user7" Font="굴림,9" Height="20" Id="Static11" Left="461" TabOrder="34" Text="회" Top="131" VAlign="Middle" Width="18"></Static>
		<Shape BKColor="user12" Bottom="204" Height="26" Id="Shape3" Left="8" LineColor="user13" Right="966" TabOrder="35" Top="178" Type="Rectangle" Width="958"></Shape>
		<Static Align="Right" Height="34" Id="st_remark" Left="9" Style="sty_lb_form_basic" TabOrder="36" Text="특이사항&#32;&#10;&#32;(500자)&#32;" Top="204" VAlign="Middle" Width="70"></Static>
		<Edit Border="Flat" DisableBKColor="user5" Height="30" Id="ed_remark" Left="81" LeftMargin="4" MaxLength="500" RightMargin="4" Style="sty_ipt_form" TabOrder="3" Top="206" VAlign="TOP" Width="711"></Edit>
		<MaskEdit Border="Flat" DisableBKColor="user5" Enable="FALSE" Height="20" Id="med_supamtt" Left="164" Style="sty_ipt_form" TabOrder="38" Top="241" Value="0" Width="170"></MaskEdit>
		<Static Align="Right" Height="24" Id="st_regbosu" Left="9" Style="sty_lb_form_basic" TabOrder="37" Text="정기보수&#32;" Top="239" VAlign="Middle" Width="70"></Static>
		<Static Align="Right" Height="24" Id="st_supamt" Left="79" Style="sty_lb_form_detail" TabOrder="40" Text="공급가액&#32;" Top="239" VAlign="Middle" Width="81"></Static>
		<Static Align="Right" Height="24" Id="st_supvat" Left="336" Style="sty_lb_form_detail" TabOrder="42" Text="VAT&#32;" Top="239" VAlign="Middle" Width="108"></Static>
		<MaskEdit Border="Flat" DisableBKColor="user5" Enable="FALSE" Height="20" Id="med_supvatt" Left="444" Style="sty_ipt_form" TabOrder="41" Top="241" Value="0" Width="114"></MaskEdit>
		<Static Align="Right" Height="24" Id="st_suptot" Left="560" Style="sty_lb_form_detail" TabOrder="44" Text="합계&#32;" Top="239" VAlign="Middle" Width="116"></Static>
		<MaskEdit Border="Flat" DisableBKColor="user5" Enable="FALSE" Height="20" Id="med_suptott" Left="678" Style="sty_ipt_form" TabOrder="43" Top="241" Value="0" Width="114"></MaskEdit>
		<MaskEdit BindDataset="ds_per_val" Border="Flat" Column="PERCNT" DisableBKColor="user5" Enable="FALSE" Height="20" Id="med_percnt" Left="164" Style="sty_ipt_form" TabOrder="46" Top="291" Value="0" Width="170"></MaskEdit>
		<Static Align="Right" Height="24" Id="st_persangju" Left="9" Style="sty_lb_form_basic" TabOrder="45" Text="인원상주&#32;" Top="289" VAlign="Middle" Width="70"></Static>
		<Static Align="Right" Height="24" Id="st_percnt" Left="79" Style="sty_lb_form_detail" TabOrder="48" Text="인원수&#32;" Top="289" VAlign="Middle" Width="81"></Static>
		<Static Align="Right" Height="24" Id="st_sumamt" Left="336" Style="sty_lb_form_detail" TabOrder="50" Text="상주금액(VAT포함)&#32;" Top="289" VAlign="Middle" Width="108"></Static>
		<MaskEdit BindDataset="ds_per_val" Border="Flat" Column="SUMAMT" DisableBKColor="user5" Enable="FALSE" Height="20" Id="med_sumamt" Left="444" Style="sty_ipt_form" TabOrder="49" Top="291" Value="0" Width="114"></MaskEdit>
		<Grid AutoEnter="TRUE" AutoFitEndLine="Hide" BindDataset="ds_list" BkColor2="default" BoldHead="true" Border="Flat" Bottom="548" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="228" Id="grd_list" InputPanel="FALSE" Left="8" LineColor="user20" LineType="ExHORZ" OnCellClick="grd_list_OnCellClick" OnExpandEdit="grd_list_OnExpandEdit" OnHeadClick="grd_list_OnHeadClick" OnKillFocus="grd_list_OnKillFocus" Right="966" RowHeight="20" Style="sty_grid" TabOrder="51" TabStop="true" Top="320" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="958">
			<contents>
				<format id="Default">
					<columns>
						<col fix="left" width="20"/>
						<col fix="left" width="30"/>
						<col fix="left" width="41"/>
						<col fix="left" width="60"/>
						<col fix="left" width="51"/>
						<col fix="left" width="120"/>
						<col width="80"/>
						<col width="100"/>
						<col width="100"/>
						<col width="60"/>
						<col width="70"/>
						<col width="70"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="0"/>
						<col width="0"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="50"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="50"/>
						<col width="80"/>
						<col width="50"/>
						<col width="80"/>
						<col width="90"/>
						<col width="0"/>
						<col width="90"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="70"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="70"/>
						<col width="60"/>
						<col width="50"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="70"/>
						<col width="75"/>
						<col width="75"/>
						<col width="100"/>
						<col width="80"/>
						<col width="80"/>
						<col width="55"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="60"/>
						<col width="80"/>
						<col width="50"/>
					</columns>
					<head>
						<cell col="0" display="text" font="굴림,9"/>
						<cell col="1" display="checkbox" edit="checkbox" font="굴림,9"/>
						<cell col="2" display="text" font="굴림,9" text="No"/>
						<cell col="3" display="text" font="굴림,9" text="Proj&#32;No."/>
						<cell col="4" display="text" font="굴림,9" text="호기"/>
						<cell col="5" display="text" font="굴림,9" text="협력사"/>
						<cell col="6" display="text" font="굴림,9" text="실패승인일"/>
						<cell col="7" display="text" font="굴림,9" text="호기명"/>
						<cell col="8" display="text" font="굴림,9" text="사양"/>
						<cell col="9" display="text" font="굴림,9" text="PLT수"/>
						<cell col="10" display="text" font="굴림,9" text="기종"/>
						<cell col="11" display="text" font="굴림,9" text="전기기종"/>
						<cell col="12" display="text" font="굴림,9" text="계약개시일"/>
						<cell col="13" display="text" font="굴림,9" text="유상개시일"/>
						<cell col="14" display="text" font="굴림,9" text="계약만기일"/>
						<cell col="15" display="text" font="굴림,9" text="청구주기"/>
						<cell col="16" display="text" font="굴림,9" text="분담이행"/>
						<cell col="17" display="text" font="굴림,9" text="유지관리비"/>
						<cell col="18" display="text" font="굴림,9" text="당사관리비"/>
						<cell col="19" display="text" font="굴림,9" text="협력사관리비"/>
						<cell col="20" display="text" font="굴림,9" text="HRTS"/>
						<cell col="21" display="text" font="굴림,9" text="HRTS&#32;금액"/>
						<cell col="22" display="text" font="굴림,9" text="점검주기"/>
						<cell col="23" display="text" font="굴림,9" text="회선종류"/>
						<cell col="24" display="text" font="굴림,9" text="DI-PBX"/>
						<cell col="25" display="text" font="굴림,9" text="DI-PBX종류"/>
						<cell col="26" display="text" font="굴림,9" text="통신료"/>
						<cell col="27" display="text" font="굴림,9" text="DI-PBX&#32;금액"/>
						<cell col="28" display="text" font="굴림,9" text="공기청정기"/>
						<cell col="29" display="text" font="굴림,9" text="공기청정기종류"/>
						<cell col="30" display="text" font="굴림,9" text="공기청정기&#32;금액"/>
						<cell col="31" display="text" font="굴림,9" text="소계"/>
						<cell col="32" display="text" font="굴림,9" text="VAT"/>
						<cell col="33" display="text" font="굴림,9" text="합계"/>
						<cell align="center" col="34" display="text" font="굴림,9" text="지역"/>
						<cell col="35" display="text" font="굴림,9" text="고속기종여부"/>
						<cell col="36" display="text" font="굴림,9" text="시내외구분"/>
						<cell col="37" display="text" font="굴림,9" text="빌딩구분"/>
						<cell col="38" display="text" font="굴림,9" text="비율제계약"/>
						<cell align="center" col="39" display="text" font="굴림,9" text="지급율"/>
						<cell col="40" display="text" font="굴림,9" text="FM계약"/>
						<cell col="41" display="text" font="굴림,9" text="FM상품"/>
						<cell col="42" display="text" font="굴림,9" text="인센티브지급"/>
						<cell col="43" display="text" font="굴림,9" text="주점검자"/>
						<cell col="44" display="text" font="굴림,9" text="부점검자"/>
						<cell col="45" display="text" font="굴림,9" text="계약구분"/>
						<cell col="46" display="text" font="굴림,9" text="FM계약연도"/>
						<cell col="47" display="text" font="굴림,9" text="FM계약차수"/>
						<cell col="48" display="text" font="굴림,9" text="중도해지사유"/>
						<cell col="49" display="text" font="굴림,9" text="계약변동구분"/>
						<cell col="50" display="text" font="굴림,9" text="차액"/>
						<cell col="51" display="text" font="굴림,9" text="장기계약"/>
						<cell col="52" display="text" font="굴림,9" text="장기계약연도"/>
						<cell col="53" display="text" font="굴림,9" text="장기계약차수"/>
						<cell col="54" display="text" font="굴림,9" text="실계약개시일"/>
						<cell col="55" display="text" font="굴림,9" text="실계약만기일"/>
						<cell col="56" display="text" font="굴림,9" text="SEG"/>
						<cell col="57" display="text" font="굴림,9" text="표준단가"/>
						<cell col="58" display="text" font="굴림,9" text="달성율"/>
					</head>
					<body>
						<cell align="center" bkcolor2="user22" col="0" display="text"/>
						<cell align="center" bkcolor2="user22" col="1" colid="CHK" display="expr:iif(MCHK&#32;==&#32;&apos;N&apos;,&#32;&apos;checkbox&apos;,&#32;&apos;null&apos;)" edit="expr:iif(MCHK&#32;==&#32;&apos;N&apos;,&#32;&apos;checkbox&apos;,&#32;&apos;none&apos;)"/>
						<cell align="center" bkcolor2="user22" col="2" display="text" expr="currow+1"/>
						<cell align="center" bkcolor2="user22" col="3" colid="PJT" display="text"/>
						<cell align="center" col="4" colid="HNO" display="text"/>
						<cell bkcolor2="user22" col="5" colid="BSU_NM" display="text"/>
						<cell align="center" col="6" colid="FSD" display="text" Mask="####.##.##"/>
						<cell bkcolor2="user22" col="7" colid="HNA" display="text"/>
						<cell align="center" bkcolor2="user22" col="8" colid="ZSPEC2" display="text"/>
						<cell align="right" bkcolor2="user22" col="9" colid="ZSPEC" display="number"/>
						<cell align="center" bkcolor2="user22" col="10" colid="ZSPEC1" display="text"/>
						<cell align="center" bkcolor2="user22" col="11" colid="ZSPEC12" display="text"/>
						<cell align="center" bkcolor2="user22" col="12" colid="USD" display="text" expandimage="btn_grid_icon_pen" expandshow="true" expandsize="18" Mask="####.##.##"/>
						<cell align="center" bkcolor2="user22" col="13" colid="UGS" display="text" expandimage="btn_grid_icon_pen" expandshow="true" expandsize="18" Mask="####.##.##"/>
						<cell align="center" bkcolor2="user22" col="14" colid="UMR" display="text" expandimage="btn_grid_icon_pen" expandshow="true" expandsize="18" Mask="####.##.##"/>
						<cell align="center" col="15" colid="BJG" display="text"/>
						<cell col="16" colid="BDGBN" display="checkbox"/>
						<cell align="right" bkcolor2="user22" col="17" colid="AMTT" display="number" edit="masknumber"/>
						<cell align="right" bkcolor2="user22" col="18" colid="AMT" display="number" edit="masknumber"/>
						<cell align="right" bkcolor2="user22" col="19" colid="AMBT" display="number"/>
						<cell align="center" col="20" colid="HYN" display="checkbox" edit="checkbox"/>
						<cell align="right" bkcolor2="user22" col="21" colid="HMT" display="number" edit="masknumber" text="0"/>
						<cell align="center" bkcolor2="user22" col="22" colid="HEP" combocol="CODE" combodataset="ds_hep_cd" combotext="CODE_NAME" display="combo" edit="combo"/>
						<cell align="center" bkcolor2="user22" col="23" colid="HWR" combocol="CODE" combodataset="ds_hwr_cd" combotext="CODE_NAME" display="combo" edit="combo"/>
						<cell align="center" col="24" colid="DYN" display="checkbox" edit="checkbox"/>
						<cell align="center" bkcolor2="user22" col="25" colid="DND" combocol="CODE" combodataset="ds_dnd" combotext="CODE_NAME" display="combo" edit="combo"/>
						<cell align="center" col="26" colid="DCE" display="checkbox" edit="checkbox"/>
						<cell align="right" bkcolor2="user22" col="27" colid="DMT" display="number" edit="masknumber" text="0"/>
						<cell align="center" col="28" colid="ACYN" display="checkbox" edit="checkbox"/>
						<cell align="center" bkcolor2="user22" col="29" colid="ACND" combocol="CODE" combodataset="ds_acnd" combotext="CODE_NAME" display="combo" edit="combo"/>
						<cell align="right" bkcolor2="user22" col="30" colid="ACMT" display="number" edit="masknumber" text="0"/>
						<cell align="right" bkcolor2="user22" col="31" colid="SUT" display="number" expr="AMTT+HMT+DMT+ACMT"/>
						<cell align="right" bkcolor2="user22" col="32" colid="VATT" display="number"/>
						<cell align="right" bkcolor2="user22" col="33" colid="TOTT" display="number"/>
						<cell align="center" col="34" colid="ARA_NM" display="text"/>
						<cell align="center" col="35" colid="HTY" display="text"/>
						<cell align="center" col="36" colid="AGB_NM" display="text"/>
						<cell align="center" col="37" colid="ABG_NM" display="text"/>
						<cell align="center" col="38" colid="RGB" display="checkbox"/>
						<cell align="right" col="39" colid="RTO" display="number" edit="expr:iif(substr(HNO,0,1)&#32;==&#32;&apos;P&apos;&#32;||&#32;substr(HNO,0,1)&#32;==&#32;&apos;G&apos;&#32;||&#32;substr(HNO,0,1)&#32;==&#32;&apos;S&apos;,&#32;&apos;none&apos;,&#32;&apos;number&apos;)" limit="3" LimitDec="0" Mask="##0.0"/>
						<cell align="center" col="40" colid="KND_YN" display="checkbox" edit="checkbox"/>
						<cell align="center" bkcolor2="user22" col="41" colid="KND" combocol="CODE" combodataset="ds_fmkind_cd" combotext="CODE_NAME" display="combo" edit="combo"/>
						<cell align="center" col="42" colid="IYN" display="checkbox" edit="checkbox"/>
						<cell align="center" col="43" colid="JUJ_NM" display="text"/>
						<cell align="center" col="44" colid="BUJ_NM" display="text"/>
						<cell align="center" bkcolor2="user22" col="45" colid="GKD_NM" display="text"/>
						<cell align="center" bkcolor2="user22" col="46" colid="FMY" combocol="CODE" combodataset="ds_fmy_cd" combotext="CODE_NAME" display="combo" edit="combo"/>
						<cell align="center" bkcolor2="user22" col="47" colid="FMS" combocol="CODE" combodataset="ds_fms_cd" combotext="CODE_NAME" display="combo" edit="combo"/>
						<cell bkcolor2="user22" col="48" colid="CRS_NM" display="text"/>
						<cell align="center" bkcolor2="user22" col="49" colid="CBN" combocol="CODE" combodataset="ds_gbn_cd" combotext="CODE_NAME" display="combo" edit="combo"/>
						<cell align="right" bkcolor2="user22" col="50" colid="DIF" display="number" edit="masknumber"/>
						<cell align="center" col="51" colid="LTC" display="checkbox" edit="checkbox"/>
						<cell align="center" bkcolor2="user22" col="52" colid="LTY" combocol="CODE" combodataset="ds_fmy_cd" combotext="CODE_NAME" display="combo" edit="combo"/>
						<cell align="center" bkcolor2="user22" col="53" colid="LTS" combocol="CODE" combodataset="ds_fms_cd" combotext="CODE_NAME" display="combo" edit="combo"/>
						<cell align="center" bkcolor2="user22" col="54" colid="RGS" display="text" expandimage="btn_grid_icon_pen" expandshow="true" expandsize="18" Mask="####.##.##"/>
						<cell align="center" bkcolor2="user22" col="55" colid="RMR" display="text" expandimage="btn_grid_icon_pen" expandshow="true" expandsize="18" Mask="####.##.##"/>
						<cell align="center" bkcolor2="user22" col="56" colid="SEG" display="text"/>
						<cell align="right" bkcolor2="user22" col="57" colid="STDAMT" display="number"/>
						<cell align="right" bkcolor2="user22" col="58" colid="TRT" display="number"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Div Height="35" Id="div_btn" TabOrder="52" Text="Div0" ToolTipFont="Default,0" Url="WB01::CommBtnForm.xml" Width="976">
			<Contents></Contents>
		</Div>
		<Static Height="21" Id="st_ugs" Left="488" TabOrder="53" Text="유상개시일" Top="561" Visible="FALSE" Width="78"></Static>
		<Static Height="21" Id="st_umr" Left="550" TabOrder="54" Text="계약만기일" Top="560" Visible="FALSE" Width="78"></Static>
		<Static Height="21" Id="st_usd" Left="406" TabOrder="55" Text="계약개시일" Top="560" Visible="FALSE" Width="78"></Static>
		<Static Height="21" Id="st_cst" Left="326" TabOrder="56" Text="거래처" Top="560" Visible="FALSE" Width="78"></Static>
		<Static Height="21" Id="st_amt" Left="606" TabOrder="57" Text="공급가액" Top="560" Visible="FALSE" Width="78"></Static>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_gd_query" ImageID="btn_sub_05" Left="506" LeftMargin="12" OnClick="btn_gd_query_OnClick" Style="sty_btn" TabOrder="58" Text="계약대상조회" Top="79" Transparent="TRUE" Width="84"></Button>
		<Static Height="18" Id="st_pst" Left="653" TabOrder="61" Text="진행상태" Top="561" Visible="FALSE" Width="60"></Static>
		<Static Height="20" Id="st_rto" Left="707" TabOrder="62" Text="지급율" Top="561" Visible="FALSE" Width="58"></Static>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_can" ImageID="btn_sub_04" Left="762" LeftMargin="12" OnClick="btn_can_OnClick" Style="sty_btn" TabOrder="63" Text="중도해지" Top="79" Transparent="TRUE" Width="71"></Button>
		<Static Height="22" Id="st_cur_date" Left="270" TabOrder="64" Text="현재일" Top="560" Visible="FALSE" Width="58"></Static>
		<Static Height="22" Id="st_can" Left="214" TabOrder="65" Text="중도해지일" Top="560" Visible="FALSE" Width="58"></Static>
		<Static Align="Right" Height="24" Id="st_gamamt" Left="560" Style="sty_lb_form_detail" TabOrder="67" Text="감시반금액(VAT포함)&#32;" Top="289" VAlign="Middle" Visible="FALSE" Width="116"></Static>
		<MaskEdit BindDataset="ds_per_val" Border="Flat" Column="GAMAMT" DisableBKColor="user5" Enable="FALSE" Height="20" Id="med_gamamt" Left="678" Style="sty_ipt_form" TabOrder="68" Top="291" Value="0" Visible="FALSE" Width="114"></MaskEdit>
		<Static Height="21" Id="st_bsu_chk" Left="245" TabOrder="69" Text="보수협력사" Top="575" Visible="FALSE" Width="91"></Static>
		<Static Height="21" Id="st_bpm_chk" Left="309" TabOrder="70" Text="보수PM" Top="575" Visible="FALSE" Width="91"></Static>
		<Static Height="21" Id="st_ara_chk" Left="357" TabOrder="71" Text="대지역" Top="575" Visible="FALSE" Width="91"></Static>
		<Static Height="21" Id="st_juj_chk" Left="397" TabOrder="72" Text="주점검자" Top="575" Visible="FALSE" Width="91"></Static>
		<Static Height="21" Id="st_buj_chk" Left="448" TabOrder="73" Text="부점검자" Top="575" Visible="FALSE" Width="91"></Static>
		<Edit BindDataset="ds_per_val" Border="Flat" Column="MAXSEQ" DisableBKColor="user5" Enable="FALSE" Height="20" Id="ed_maxseq" Left="1016" MaxLength="2" Style="sty_ipt_search" TabOrder="74" Top="424" Visible="FALSE" Width="50"></Edit>
		<Static Height="21" Id="st_hst" Left="504" TabOrder="75" Text="호기상태" Top="576" Visible="FALSE" Width="91"></Static>
		<Static Align="Right" Height="24" Id="st_slagbn" Left="336" Style="sty_lb_form_basic" TabOrder="76" Text="용역여부&#32;" Top="154" VAlign="Middle" Width="80"></Static>
		<Combo Border="Flat" CodeColumn="CODE" DataColumn="CODE_NAME" DisableBKColor="user5" Enable="FALSE" Height="20" Id="cb_slagbn" InnerDataset="ds_slagbn_cd" Left="418" OnChanged="cb_slagbn_OnChanged" Style="sty_ipt_form" TabOrder="77" Top="155" Width="62"></Combo>
		<PopupDiv Border="Flat" Height="146" Id="PopupDiv0" Left="1016" TabOrder="79" TabStop="FALSE" Top="272" Width="154">
			<Contents>
				<Calendar Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="146" Id="cal_temp" MonthOnly="TRUE" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" OnDayClick="PopupDiv0_cal_temp_OnDayClick" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="1" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="-1" Value="20140625" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="152"></Calendar>
			</Contents>
		</PopupDiv>
		<Static Align="Right" Height="24" Id="st_grp" Left="336" Style="sty_lb_form_basic" TabOrder="80" Text="그룹계약번호&#32;" Top="104" VAlign="Middle" Width="80"></Static>
		<Combo Border="Flat" CodeColumn="CODE" DataColumn="CODE_NAME" Height="20" Id="cb_grp" InnerDataset="ds_grp_cd" Left="418" Style="sty_ipt_form" TabOrder="81" Top="105" Width="150"></Combo>
		<Combo Border="Flat" CodeColumn="CODE" DataColumn="CODE_NAME" DisableBKColor="user5" Height="20" Id="cb_slarsn" InnerDataset="ds_slarsn_cd" Left="483" Style="sty_ipt_form" TabOrder="82" Top="155" Width="149"></Combo>
		<Combo Border="Flat" CodeColumn="CODE" DataColumn="CODE_NAME" DisableBKColor="user5" Height="20" Id="cb_cyn" InnerDataset="ds_cyn_cd" Left="80" OnChanged="cb_cyn_OnChanged" Style="sty_ipt_form" TabOrder="84" Top="155" Width="85"></Combo>
		<Static Align="Right" Height="24" Id="st_cyn" Left="9" Style="sty_lb_form_basic" TabOrder="83" Text="계약서유무&#32;" Top="154" VAlign="Middle" Width="71"></Static>
		<Static Height="21" Id="st_hmt" Left="664" TabOrder="85" Text="HRTS금액" Top="608" Visible="FALSE" Width="78"></Static>
		<Static Height="21" Id="st_dmt" Left="744" TabOrder="86" Text="DI-PBX금액" Top="600" Visible="FALSE" Width="78"></Static>
		<Static Height="21" Id="st_hep" Left="824" TabOrder="87" Text="점검주기" Top="600" Visible="FALSE" Width="78"></Static>
		<Static Height="21" Id="st_fmy" Left="424" TabOrder="88" Text="FM계약연도" Top="600" Visible="FALSE" Width="78"></Static>
		<Static Height="21" Id="st_fms" Left="504" TabOrder="89" Text="FM계약차수" Top="600" Visible="FALSE" Width="78"></Static>
		<Combo Border="Flat" CodeColumn="CODE" DataColumn="CODE_NAME" DisableBKColor="user5" Enable="FALSE" Height="20" Id="cb_ctp" InnerDataset="ds_ctp_cd" Left="168" Style="sty_ipt_form" TabOrder="90" Top="152" Width="85"></Combo>
		<Static Height="21" Id="st_ctp" Left="256" TabOrder="91" Text="계약서유형" Top="608" Visible="FALSE" Width="78"></Static>
		<Checkbox BKColor="user5" DisableBKColor="user12" Enable="FALSE" Height="20" Id="chk_cfg" Left="252" Style="sty_ipt_form_chk" TabOrder="92" Top="155" Value="FALSE" Width="16"></Checkbox>
		<Static Height="16" Id="st_cfg" Left="269" TabOrder="93" Text="최초계약서" Top="160" Width="78"></Static>
		<Static Height="21" Id="st_hwr" Left="832" TabOrder="94" Text="HRTS&#32;회선종류" Top="624" Visible="FALSE" Width="78"></Static>
		<Static Align="Right" Height="24" Id="st_sname" Left="1000" Style="sty_lb_form_basic" TabOrder="95" Text="영업사원&#32;" Top="216" VAlign="Middle" Width="60"></Static>
		<Edit Align="CENTER" BindDataset="ds_list" Border="Flat" Column="ZMAN" DisableBKColor="user5" Enable="FALSE" Height="20" Id="ed_sname" Left="1062" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="96" Top="218" Width="105"></Edit>
		<Button Cursor="HAND" Height="18" Id="btn_sid" ImageID="btn_icon_search" Left="1233" OnClick="btn_sid_OnClick" TabOrder="97" Text="Button0" Top="131" Transparent="TRUE" Width="18"></Button>
		<Edit BindDataset="ds_list" Border="Flat" Column="SID" DisableBKColor="user5" Enable="FALSE" Height="20" Id="ed_sid" Left="1152" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="98" Top="160" VAlign="TOP" Width="80"></Edit>
		<Edit Border="Flat" DisableBKColor="user5" Enable="FALSE" Height="20" Id="ed_sla_yn" ImeMode="none" Left="992" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="99" Top="104" VAlign="TOP" Width="80"></Edit>
		<Static Height="21" Id="st_dnd" Left="728" TabOrder="100" Text="DI-PBX&#32;종류" Top="632" Visible="FALSE" Width="78"></Static>
		<Static Height="21" Id="st_lty" Left="424" TabOrder="101" Text="장기계약연도" Top="640" Visible="FALSE" Width="78"></Static>
		<Static Height="21" Id="st_lts" Left="504" TabOrder="102" Text="장기계약차수" Top="640" Visible="FALSE" Width="78"></Static>
		<Static Align="Right" Height="24" Id="st_fcm" Left="633" Style="sty_lb_form_basic" TabOrder="103" Text="검사비용&#32;미포함&#32;&#32;" Top="154" VAlign="Middle" Width="100"></Static>
		<Checkbox BKColor="user5" DisableBKColor="user12" Enable="FALSE" Height="20" Id="chk_fcm" Left="734" Style="sty_ipt_form_chk" TabOrder="104" Top="155" Value="FALSE" Width="16"></Checkbox>
		<Static Height="21" Id="st_rgs" Left="176" TabOrder="105" Text="실계약개시일" Top="632" Visible="FALSE" Width="78"></Static>
		<Static Height="21" Id="st_rmr" Left="256" TabOrder="106" Text="실계약만료일" Top="632" Visible="FALSE" Width="78"></Static>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_est_search" ImageID="btn_sub_04" Left="9" LeftMargin="12" OnClick="btn_est_search_OnClick" Style="sty_btn" TabOrder="107" Text="견적조회" Top="79" Transparent="TRUE" Width="71"></Button>
		<Edit Border="Flat" DisableBKColor="user5" Enable="FALSE" Height="20" Id="ed_estno" Left="84" Style="sty_ipt_search" TabOrder="108" Top="79" Width="116"></Edit>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_upload_doc" ImageID="btn_sub_04" Left="433" LeftMargin="12" OnClick="btn_upload_doc_OnClick" Style="sty_btn" TabOrder="109" Text="첨부문서" Top="79" Transparent="TRUE" Width="71"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_seungin_cancel" ImageID="btn_sub_04" Left="289" LeftMargin="12" OnClick="btn_seungin_cancel_OnClick" Style="sty_btn" TabOrder="66" Text="승인취소" Top="79" Transparent="TRUE" Width="71"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_seungin" ImageID="btn_sub_02" Left="1088" LeftMargin="12" OnClick="btn_seungin_OnClick" Style="sty_btn" TabOrder="59" Text="승인" Top="48" Transparent="TRUE" Width="47"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_sd_query" ImageID="btn_sub_06" Left="992" LeftMargin="12" OnClick="btn_sd_query_OnClick" Style="sty_btn" TabOrder="60" Text="승인대상조회" Top="48" Transparent="TRUE" Width="95"></Button>
		<Edit Align="CENTER" Border="Flat" Height="20" Id="ed_docno" ImeMode="none" Left="859" LeftMargin="4" OnClick="ed_docno_OnClick" Readonly="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="110" Top="156" Width="105"></Edit>
		<Edit Align="CENTER" Border="Flat" Enable="FALSE" Height="20" Id="ed_doc" ImeMode="none" Left="992" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="111" Top="80" Width="123"></Edit>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_cont_period" ImageID="btn_sub_08" Left="802" LeftMargin="12" OnClick="btn_cont_period_OnClick" Style="sty_btn" TabOrder="112" Text="계약연차별상세" Top="290" Transparent="TRUE" Visible="FALSE" Width="120"></Button>
		<Static Align="Center" Height="24" Id="st_app" Left="797" Style="sty_lb_form_basic" TabOrder="113" Text="결재상태&#32;" Top="104" VAlign="Middle" Width="60"></Static>
		<Combo BindDataset="ds_list" Border="Flat" CodeColumn="CODE" Column="APSTAT" DataColumn="DTEXT1" Enable="FALSE" Height="20" Id="cb_apstat" InnerDataset="ds_apstat" Left="858" Style="sty_ipt_search" TabOrder="113" Top="104" Width="95"></Combo>
		<Static Align="Center" Height="24" Id="Static1" Left="797" Style="sty_lb_form_basic" TabOrder="114" Text="전결규정&#32;" Top="129" VAlign="Middle" Width="60"></Static>
		<Edit Border="Flat" Enable="FALSE" Height="20" Id="ed_cof" Left="859" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="115" Top="131" Width="92"></Edit>
		<Static Align="Center" Height="24" Id="Static0" Left="797" Style="sty_lb_form_basic" TabOrder="117" Text="결재번호" Top="154" VAlign="Middle" Width="60"></Static>
		<Button ButtonStyle="TRUE" Cursor="HAND" Enable="FALSE" Height="20" Id="btn_admin" ImageID="btn_sub_05" Left="204" LeftMargin="12" OnClick="btn_admin_OnClick" Style="sty_btn" TabOrder="118" Text="승인(관리자용)" Top="79" Transparent="TRUE" Visible="FALSE" Width="84"></Button>
		<Static Align="Center" Height="34" Id="st_trt" Left="797" Style="sty_lb_form_basic" TabOrder="119" Text="달성율&#32;" Top="204" VAlign="Middle" Width="80"></Static>
		<MaskEdit Border="Flat" Column="TRT_T" DisableBKColor="user5" Enable="FALSE" Height="25" Id="med_trt_t" Left="1088" Mask="##.#" Style="sty_ipt_form" TabOrder="120" Top="184" Value="0" Width="52"></MaskEdit>
		<Edit Border="Flat" DisableBKColor="user5" Enable="FALSE" Height="20" Id="ed_slaBsu" Left="992" Style="sty_ipt_search" TabOrder="121" Top="8" Width="64"></Edit>
		<Static Align="Center" Height="24" Id="Static2" Left="797" Style="sty_lb_form_basic" TabOrder="123" Text="전&#32;계약&#32;대비" Top="239" VAlign="Middle" Width="80"></Static>
		<MaskEdit Border="Flat" Column="TRT_T" DisableBKColor="user5" Enable="FALSE" Height="20" Id="med_trt_tB" Left="880" Mask="##.#" Style="sty_ipt_form" TabOrder="124" Top="242" Value="0" Width="52"></MaskEdit>
		<MaskEdit Border="Flat" Column="TRT_T" DisableBKColor="user5" Enable="FALSE" Height="25" Id="med_trt_tS" Left="880" Mask="##.#" Style="sty_ipt_form" TabOrder="125" Top="209" Value="0" Width="52"></MaskEdit>
		<Static Align="Center" Font="Default,8" Height="24" Id="st_cse" Left="208" Style="sty_lb_form_basic" TabOrder="127" Text="거래선증빙유무" Top="179" VAlign="Middle" Width="81"></Static>
		<Combo Border="Flat" CodeColumn="CODE" DataColumn="CODE_NAME" DisableBKColor="user5" Height="20" Id="cb_cse" InnerDataset="ds_cst_cd1" Left="289" Style="sty_ipt_form" TabOrder="128" Top="180" Width="83"></Combo>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_pdchang" ImageID="btn_sub_05" Left="879" LeftMargin="12" OnClick="btn_pdchang_OnClick" Style="sty_btn" TabOrder="129" Text="FM상품변경" Top="181" Transparent="TRUE" Width="82"></Button>
		<Shape BKColor="user12" Bottom="289" Height="26" Id="Shape8" Left="8" LineColor="user13" Right="966" TabOrder="130" Top="263" Type="Rectangle" Width="958"></Shape>
		<Static Align="Right" Height="24" Id="Static3" Left="9" Style="sty_lb_form_basic" TabOrder="131" Text="분담이행&#32;" Top="264" VAlign="Middle" Width="70"></Static>
		<Checkbox BKColor="user5" DisableBKColor="user12" Height="20" Id="chk_bdgbn" Left="84" OnClick="chk_bdgbn_OnClick" Style="sty_ipt_form_chk" TabOrder="132" Top="267" Width="16"></Checkbox>
		<Static Align="Right" Height="24" Id="Static5" Left="336" Style="sty_lb_form_detail" TabOrder="134" Text="직영공급가액&#32;" Top="264" VAlign="Middle" Width="108"></Static>
		<MaskEdit Border="Flat" DisableBKColor="user5" Enable="FALSE" Height="20" Id="med_supamt" Left="444" Style="sty_ipt_form" TabOrder="133" Top="266" Value="0" Width="114"></MaskEdit>
		<Static Align="Right" Height="24" Id="Static6" Left="560" Style="sty_lb_form_detail" TabOrder="136" Text="협력사공급가액&#32;" Top="264" VAlign="Middle" Width="116"></Static>
		<MaskEdit Border="Flat" DisableBKColor="user5" Enable="FALSE" Height="20" Id="med_supambt" Left="678" Style="sty_ipt_form" TabOrder="135" Top="266" Value="0" Width="114"></MaskEdit>
		<MaskEdit BindDataset="ds_per_val" Border="Flat" Column="SUMAMBT" DisableBKColor="user5" Enable="FALSE" Height="20" Id="med_sumambt" Left="1000" Style="sty_ipt_form" TabOrder="137" Top="472" Value="0" Width="114"></MaskEdit>
		<MaskEdit BindDataset="ds_per_val" Border="Flat" Column="SUMAMTT" DisableBKColor="user5" Enable="FALSE" Height="20" Id="med_sumamtt" Left="1000" Style="sty_ipt_form" TabOrder="138" Top="496" Value="0" Width="114"></MaskEdit>
		<Button ButtonStyle="TRUE" Cursor="HAND" Enable="FALSE" Height="20" Id="btn_vbeln" ImageID="btn_sub_04" Left="361" LeftMargin="12" OnClick="btn_vbeln_OnClick" Style="sty_btn" TabOrder="139" Text="수주확정" Top="79" Transparent="TRUE" Visible="FALSE" Width="71"></Button>
		<Static Height="21" Id="st_acmt" Left="632" TabOrder="140" Text="공기청정기&#32;금액" Top="632" Visible="FALSE" Width="88"></Static>
		<Combo Border="Flat" CodeColumn="CODE" DataColumn="CODE_NAME" DisableBKColor="user5" Enable="FALSE" Height="20" Id="cb_etc" InnerDataset="ds_etc_cd" Left="80" OnChanged="cb_etc_OnChanged" Style="sty_ipt_form" TabOrder="141" Top="180" Width="125"></Combo>
		<Static Align="Right" Height="24" Id="st_etc" Left="9" Style="sty_lb_form_basic" TabOrder="142" Text="전자계약&#32;" Top="178" VAlign="Middle" Width="71"></Static>
		<Edit Border="Flat" Enable="FALSE" Height="20" Id="ed_etcbg" ImeMode="none" Left="444" LeftMargin="4" MaxLength="50" RightMargin="4" Style="sty_ipt_form" TabOrder="143" Top="181" Width="434"></Edit>
		<Static Align="Right" Font="Default,8" Height="24" Id="st_etcbg" Left="375" Style="sty_lb_form_basic" TabOrder="144" Text="종이계약사유" Top="179" VAlign="Middle" Width="68"></Static>
	</Form>
	<Script><![CDATA[/*
 ******************************************************************************************
 * 기      능   :
 * 작  성  자   :
 * 작성  일자   :
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
#include "LIB::commons.js";	// 공통 스크립트
#include "LIB::common_cs.js";	// 서비스 공통 스크립트
//=========================================================================================
// [ PART 1 ]
// Form에서 사용될 전역변수를 선언
// FORM에서 사용되는 전역변수는 대문자로 작성하며, F_XXX 의 형태를 갖도록 한다.
//=========================================================================================
var page_flag = false;	//저장여부 확인 플래그	
var chk_flag = false;	//영세율적용 플래그
var query_flag = false;	//부모창 리프레시 용 플래그
var fsd_flag = false;	//실패승인 여부 플래그
var chk_save = false;	//저장 후 조회하는 경우처리를 위한 구분값
var chk_first = 0;
var chk_auto_first = 0;
var chk_query = "query";
var tmp_usd, tmp_uhj;
var temp_usd, temp_uhj;
var chk_fst = 0;
var chk_fst2 = 0;
var chk_fst3 = 0;

var upn, cst, nam, spt, gnd, usd, uhj, gno, vbeln;
var fa_docno;
var est_flag = false; // 견적조회를 통한 계약 여부 체크하기 , default false
var except_flag = false; //  수주 12개월 초과 확인 로직 제외 임시처리, 20170829

var pdchang_visible = true;

var chk_halfcancle = false; // 승인취소 및 삭제 시 중도해지 체크 FLAG
var chk_isOnHand = false; // 저장시 온핸드 현장 체크 FLAG

var vDPT = "";

var vBdgRateA = 1;
var vBdgRateB = 0;

var vAutoBdgbnFlag = "";	// 자동연장시 주계약, 분담이행으로 계약할지 여부 flag : 승강기 협력사의 경우에만 사용
                            // ''1 : 주계약, '': 분담이행
                            
var vVkbur = "", vVkgrp = "";
var vVbeln_auth = "";

var copytool_flag = false; // 카피툴 사용시 이전계약의 영업그룹을 구하기 위한 flag 20200612 Han JH
var bf_vVkbur = ""; // 이전계약 영업그룹. 모회사 -> 자회사 계약시 이전 영업그룹을 구하여 모회사에서 자회사로 이관하는 경우에만 수주차감 보전로직 비활성화 되도록 처리하기 위한 변수. 20200612 Han JH

var doubleSaveChk = false; // 저장 시 중복실행 방지 체크 변수. 20210924 Han JH
//====================================================================================
// [ PART 2 ]
// Form Loading / Unloading 시 작업 정의
//=========================================================================================
function fn_OnLoadCompleted(obj) 
{
	// Form 로드 이벤트 맨 첫줄에 기술
	gfn_initForm();
	
	div_btn.btn_draft.Enable = false; 
	div_btn.btn_sendback.Enable = false;
	div_btn.btn_decide.Enable = false;
	
	var orgUserId = split(G_ORG_USER_INFO, "^", true);
	//이하림 방기태 
	if (orgUserId[0] == "2029758"  or orgUserId[0] == "2018900" or orgUserId[0] == "2999999" ) {
		btn_admin.Visible = true;
		btn_admin.Enable = true;
	}
	
	
	var curYear = substr(gfn_getCurrDate(),0,4);
	fn_makeYear(curYear,-14,5);

	if (length(fa_docno) > 0) {     //결재 상세창에서 호출한 경우
		ds_cond_req.setColumn(0, "DOCNO", fa_docno);  //결재
		ed_docno.Text = fa_docno;
		fn_reqDoc();	//결재화면으로 접근한 경우 기존 로직을 태우기 위해 계약키를 가지고 와서 동기식으로 처리 2015.01
	} 
	
	if(upn <> 'XXXXXX') 
	{
		ed_upn.value = upn;
		ed_nam.value = nam;
		ed_spt.value = spt;
		temp_usd = usd;
		temp_uhj = uhj;
	}	
	
	var codeArr    = ["CS131","CS126","CS127","CS129","CS171","CS179","CS182","CS185","WBAP_STAT","CS_AIR_KND","CS140"]; //공통코드 "CS171" 추가 20120621
	var dsObjArr   = [ds_jpgbn_cd,ds_bsgbn_cd,ds_bhcycle_cd,ds_fmkind_cd,ds_slarsn_cd,ds_hep_cd,ds_ctp_cd,ds_gbn_cd,ds_apstat,ds_acnd,ds_etc_cd];
	var addTypeArr = [G_CODE_ALL,G_CODE_NONE,G_CODE_NONE,G_CODE_NONE,G_CODE_SELECT,G_CODE_SELECT,G_CODE_SELECT,G_CODE_NONE,G_CODE_NONE,G_CODE_NONE,G_CODE_SELECT];
	gfn_searchCommCode(codeArr, dsObjArr, addTypeArr,true); //동기처리, 수행후 fn_completeInit 처리

	ds_ctp_cd.Filter(" CODE!=" +quote("B") + "&&CODE!="+quote("D"));
	
	//==============FM 상품변경 버튼 권한==============	
	gfn_initDs(ds_rcond, true);
	ds_rcond.SetColumn(0, "ZPROGRAM", "CS1201001B");
	ds_rcond.SetColumn(0, "GBN", "01");	
	pdchang_visible = gfn_getAuth(ds_rcond);
	ds_rcond.ClearData();
	
	if ( pdchang_visible == false) {	
		btn_pdchang.Visible = false;
	}
	//=================================================
	

	//====== fn_completeInit 의  권한 로직 권한테이블 형식으로 변경(sync 미 설정으로 데이터 나오지 않으므로 위로 올림 ======
	//승인취소 권한 
	gfn_initDs(ds_rcond, true);
	ds_rcond.SetColumn(0, "ZPROGRAM", "CS1201001B");
	ds_rcond.SetColumn(0, "GBN", "02");	
	pdchang_visible = gfn_getAuth(ds_rcond);
	ds_rcond.ClearData();
	
	if ( pdchang_visible == true) {	
		btn_seungin_cancel.visible = true;
		btn_can.Enable = true;
	} else {
		btn_seungin_cancel.visible = false;
	}
	//=====================================================		
	
	//============== 수신부서 결재그룹 체크 ===============================	
	gfn_initDs(ds_rcond, true);
	ds_rcond.SetColumn(0, "ZPROGRAM", "WBAP_DOCKIND");
	ds_rcond.SetColumn(0, "GBN", "01");	
	vDPT = gfn_getAuthDpt(ds_rcond);
	ds_rcond.ClearData();
    //=========================================================    
	
	//============== 자회사 수주확정 버튼 권한 ===============================	
	gfn_initDs(ds_rcond, true);
	ds_rcond.SetColumn(0, "ZPROGRAM", "CS1201001B");
	ds_rcond.SetColumn(0, "GBN", "03");	
	vVbeln_auth = gfn_getAuth(ds_rcond);
	ds_rcond.ClearData();
    //=========================================================    
	
	fn_query();
}

/************************************************************************************
* 기      능   : 작업기간 계산(현재년도,당해년도에서 뺄 년수, 당해년도에서 더할 년수
************************************************************************************/
function fn_makeYear(curYear,sNum,eNum) {
	var rowCnt = eNum-sNum;
	var row = 0;

	for(var i=rowCnt; i>-1; i--) {
		ds_fmy_cd.AddRow();
		ds_fmy_cd.SetColumn(row,"CODE",parseInt(curYear)+i+parseInt(sNum));
		ds_fmy_cd.SetColumn(row,"CODE_NAME",(parseInt(curYear)+i+parseInt(sNum)));
		row++;
	}
}

/********************************************************************************
* 기      능   : 공통코드가 조회된 후의 Callback 함수
********************************************************************************/
function fn_completeInit(sCode, sDsObj, sCodeType) 
{
//	trace("#fn_completeInit#");
	
	cb_jpgbn.index = 0;
	cb_jgcnt.index = 0;
	cb_pergbn.value = "N";
	cb_slagbn.index = 0;
	cb_slarsn.index = 0;
	cb_cyn.index = 0; 
	cb_ctp.index = 0;
	cb_etc.Index = 0;
	btn_seungin.Enable = false;
	cb_bsgbn.Enable = false;
	cb_bhcycle.Enable = false;
	cb_bhday.Enable = false;
	
	
	
/*	
	//승인취소 권한 
	if(G_USER_ID == "2017938" || G_USER_ID == "2021056"     // 최인식 전현정 
	 || G_USER_ID == "2019523" || G_USER_ID = "2016869"     // 윤아로 신은정 
	 || G_USER_ID == "2027607" || G_USER_ID = "2019191"     // 조성인 이주엽 
	 || G_USER_ID == "2019175" || G_USER_ID = "2020971"     // 박준성 이준석 
	 || G_USER_ID == "2029758" || G_USER_ID == "2018900"  || G_USER_ID == "2999999"){ // 한정훈 방기태 김종남 
		btn_seungin_cancel.visible = true;
		btn_can.Enable = true;
	} else {
		btn_seungin_cancel.visible = false;
	//	btn_can.Enable = false;
	}
*/	
		

	
	cb_slagbn.Enable = true;
	if(cb_slagbn.Value == "Y"){
		cb_slarsn.Enable = true;
	} else {
		cb_slarsn.Enable = false;	
	}

	if(cb_conkind.value == 'C') //유상공사
	{	//Cell 번호 수정 20121030 LHR
		grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","RGB"),"Display","null");	//비율제계약여부//32
		grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","RGB"),"Edit","none");						//32
		grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","RTO"),"Edit","none");		//지급율		//33
		grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","KND_YN"),"Display","null");	//FM계약여부//34
		grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","KND_YN"),"Edit","none");					//34
		grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","KND"),"Display","null");	//FM상품		//35
		grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","KND"),"Edit","none");						//35
		grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","IYN"),"Display","null");	//인센티브지급	//36
		grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","IYN"),"Edit","none");						//36
	}

	if(upn <> 'XXXXXX') 
	{
		fn_searchComboCst();
//		fn_query();
//		fn_searchEmp();
//		fn_searchPersonInfo();
	}
}
/********************************************************************************
* 기      능   : form UnloadCompleted
********************************************************************************/
function fn_OnUnloadCompleted(obj) 
{
	return gfn_isFormUnload(obj);
}

//=========================================================================================
// [ PART 3 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,form닫기)
//=========================================================================================

//t_grp:팀, t_bgb:직영구분, t_knd:계약상품, t_spc:기종, t_flr:층수
//t_spd:속도, t_hno:호기, t_bld:건물용도, t_fdt:설치연령, t_hep:점검주기
//t_ums:수주개월수, t_amt:매출액, t_abg:아파트빌딩구분, t_fms:FM계약차수, t_hwr:유무선구분
//t_fhg:HRTS최초여부, t_hyn:HRTS여부, t_tvr:감시반구분, t_cnt:전체계약대수, t_dnd:DI-PBX종류
//t_acd:특성코드

var fhrm = 0;
var fhru = 0;
var fdpx = 0;
function fn_CalRat2(crow, t_grp, t_bgb, t_knd, t_spc, t_flr, t_spd, t_hno, t_bld, t_fdt, t_hep, t_ums, t_amt, t_abg, t_fms, t_hwr, t_fhg, t_hyn, t_tvr, t_cnt, t_dnd, t_acd, t_acnd) {
	
	ds_cost_i.ClearData();
	
	if(substr(t_hno,0,1) <> "L" && substr(t_hno,0,1) <> "S" && substr(t_hno,0,1) <> "W") { // EL, ES, MW만 원가계산
		return;
	}
	
	ds_cost_i.AddRow();
	ds_cost_i.SetColumn(0,"STD", ds_list.GetColumn(crow, "RGS"));
	ds_cost_i.SetColumn(0,"ETD", ds_list.GetColumn(crow, "RMR"));
	// 시행율 기준연월
	// 견적 - 계약개시일
	// 계약 - 매 계약의 유상 개시일
	var usd = substr(ds_list.GetColumn(crow, "USD"),0,6) ;
	var adt = substr(gfn_getCurrDate(),0,6);
	var zyear ;
	if(usd >= adt) {
		zyear = substr(usd,0,4);
	} else {
		zyear = substr(adt,0,4);
	}
	ds_cost_i.SetColumn(0,"ZYEAR", zyear);
	ds_cost_i.SetColumn(0,"MMN", 0);
	
	if(t_hep == '02')
		ds_cost_i.SetColumn(0,"HEP", "B");
	else if(t_hep == '03')
		ds_cost_i.SetColumn(0,"HEP", "C"); 	
	else
		ds_cost_i.SetColumn(0,"HEP", "A"); 

	if(t_cnt <> '' && t_cnt > 0)
		ds_cost_i.SetColumn(0,"CNT", t_cnt); 	//대수
	else
		ds_cost_i.SetColumn(0,"CNT", 0); 		//대수
	
	if(t_bgb == "1")  //직영
		ds_cost_i.SetColumn(0,"GBU", "A"); 		//직영구분 A:직영
	else
		ds_cost_i.SetColumn(0,"GBU", "B"); 
		
	ds_cost_i.SetColumn(0,"HNO", t_hno);
	ds_cost_i.SetColumn(0,"HMT", ds_list.GetColumn(crow, "HMT"));
	
	//===========================공기청정기 추가 20200515 Han.JH==================================
	ds_cost_i.SetColumn(0,"ACMT", ds_list.GetColumn(crow, "ACMT"));
	//======================================================================================
		
	// 통신료 수주의 경우 시행율 계산시 수주금액에서 제외처리
	if(ds_list.GetColumn(crow, "DCE") == 1) {
		ds_cost_i.SetColumn(0,"DMT", 0);
	} else {	
		ds_cost_i.SetColumn(0,"DMT", ds_list.GetColumn(crow, "DMT"));
	}
	ds_cost_i.SetColumn(0,"SPC", t_spc);
	ds_cost_i.SetColumn(0,"FLR", t_flr);
	ds_cost_i.SetColumn(0,"SPD", t_spd);
	ds_cost_i.SetColumn(0,"FDT", t_fdt); 		//설치연령
	ds_cost_i.SetColumn(0,"ABG", t_abg); 		//건물구분
	ds_cost_i.SetColumn(0,"BLD", t_bld); 		//건물구분
	ds_cost_i.SetColumn(0,"TEM", t_grp); 
	ds_cost_i.SetColumn(0,"TYN", t_tvr);		//감시반
	
	if(length(trim(t_knd)) > 0) { 				//FM
		ds_cost_i.SetColumn(0,"KND", "1");		//FM
		ds_cost_i.SetColumn(0,"AMT", ds_list.GetColumn(crow, "AMT"));
	} else { 
		ds_cost_i.SetColumn(0,"KND", "2");		//POG
		ds_cost_i.SetColumn(0,"AMT", ds_list.GetColumn(crow, "AMT"));
	}
	
	if(t_acd == "EN81") ds_cost_i.SetColumn(0,"ACD", "2");
	else ds_cost_i.SetColumn(0,"ACD", "0");
	
	if(ds_list.GetColumn(crow, "HYN") == true){ 
		ds_cost_i.SetColumn(0,"HWR",t_hwr); 	//HRTS 유/뮤선 구분
		ds_cost_i.SetColumn(0,"FHRM",fhrm);		//HTRS 최초 무선 여부
		if(t_hwr == 'B') fhrm = 1;
		ds_cost_i.SetColumn(0,"FHRU",fhru); 	//HTRS 최초 유선 여부
		if(t_hwr == 'A') fhru = 1;
	} else {
		ds_cost_i.SetColumn(0,"FHRM",fhrm);	
		ds_cost_i.SetColumn(0,"FHRU",fhru); 
		ds_cost_i.SetColumn(0,"HWR","");
	}
	
	
	
	if(ds_list.GetColumn(crow, "DYN") == true){ 
		ds_cost_i.SetColumn(0,"DND",t_dnd); 	//DIPBX종류
		ds_cost_i.SetColumn(0,"FDPX",fdpx);		//DIPBX 최초 여부
		if(t_dnd == 'B') fdpx = 1;
	} else {
		ds_cost_i.SetColumn(0,"DND","");
		ds_cost_i.SetColumn(0,"FDPX",fdpx);
	}
	
	//===========================공기청정기 추가 20200515 Han.JH==================================
	if(ds_list.GetColumn(crow, "ACYN") == true){ 
		ds_cost_i.SetColumn(0,"ACND",t_acnd); 	//DIPBX종류
	} else {
		ds_cost_i.SetColumn(0,"ACND","");
	}	
	//============================================================================================
		
	tit_clearActionInfo();
	tit_addSingleActionInfo("cs12:CS1240001B_S15");
	tit_callService(
		""
		, ""
		, "ds_cost_i=ds_cost_i"
		, "ds_cost_o=ds_cost_o"
		, ""
		, "fn_afterHnoCostCal"
		, true
		, false
		, true);
}

var ds_cost_sum_cnt = 0;
function fn_afterHnoCostCal(errCode, errMsg) {
	if(errCode != 0) {
		gfn_showMsg("CE00001");
		fhrm = 0;
		fhru = 0;
		fdpx = 0;
		ds_cost_o.ClearData();
		ds_cost_sum.ClearData();
	} else {
		ds_cost_sum.AddRow();
		ds_cost_sum.SetColumn(ds_cost_sum_cnt,"NMT",ds_cost_o.GetColumn(0,"NMT"));
		ds_cost_sum.SetColumn(ds_cost_sum_cnt,"JMT",ds_cost_o.GetColumn(0,"JMT"));
		ds_cost_sum.SetColumn(ds_cost_sum_cnt,"JMT2",ds_cost_o.GetColumn(0,"JMT2"));
		ds_cost_sum.SetColumn(ds_cost_sum_cnt,"KMT",ds_cost_o.GetColumn(0,"KMT"));
		ds_cost_sum.SetColumn(ds_cost_sum_cnt,"HMT",ds_cost_o.GetColumn(0,"HMT"));
		ds_cost_sum.SetColumn(ds_cost_sum_cnt,"DMT",ds_cost_o.GetColumn(0,"DMT"));
		//===========================공기청정기 추가 20200515 Han.JH==================================
		ds_cost_sum.SetColumn(ds_cost_sum_cnt,"ACMT",ds_cost_o.GetColumn(0,"ACMT"));
		//======================================================================================
		ds_cost_sum.SetColumn(ds_cost_sum_cnt,"CMT",ds_cost_o.GetColumn(0,"CMT"));
		ds_cost_sum.SetColumn(ds_cost_sum_cnt,"GMT",ds_cost_o.GetColumn(0,"GMT"));
		ds_cost_sum.SetColumn(ds_cost_sum_cnt,"GMT2",ds_cost_o.GetColumn(0,"GMT2"));
		ds_cost_sum.SetColumn(ds_cost_sum_cnt,"COS1",ds_cost_o.GetColumn(0,"COS1"));
		ds_cost_sum.SetColumn(ds_cost_sum_cnt,"COS2",ds_cost_o.GetColumn(0,"COS2"));
		ds_cost_sum.SetColumn(ds_cost_sum_cnt,"COSTT",ds_cost_o.GetColumn(0,"COSTT"));
		ds_cost_sum.SetColumn(ds_cost_sum_cnt,"COSTT2",ds_cost_o.GetColumn(0,"COSTT2"));
		ds_cost_sum.SetColumn(ds_cost_sum_cnt,"AMT",ds_cost_o.GetColumn(0,"AMT"));
		ds_cost_sum.SetColumn(ds_cost_sum_cnt,"TAMT",ds_cost_o.GetColumn(0,"TAMT"));
		ds_cost_sum_cnt = ds_cost_sum_cnt + 1;
	}
	
}

function fn_searchComboCst() 
{
	if(length(ed_upn.value) > 0) 
	{
		gfn_initDs(ds_code_cond, true);
		ds_code_cond.setColumn(0, "MANDT", G_MANDT);
		ds_code_cond.setColumn(0, "UPN", ed_upn.value);

		tit_callService(
			"CS1201001B_ACT"
			, "searchComboCst"
			, "ds_cond=ds_code_cond"
			, "ds_cst_cd=ds_list"
			, ""
			, "fn_afterSearchComboCst"
			, true);
	}
}

function fn_searchNamSpt() 
{
	gfn_initDs(ds_code_cond, true);
	ds_code_cond.setColumn(0, "MANDT", G_MANDT);
	ds_code_cond.setColumn(0, "UPN", ed_upn.value);
	ds_code_cond.setColumn(0, "CST", cb_cst.value);

	tit_callService(
		"CS1201001B_ACT"
		, "searchNamSpt"
		, "ds_cond=ds_code_cond"
		, "ds_nam_cd=ds_list"
		, ""
		, "fn_afterSearchNamSpt"
		, true);
}

function fn_searchEmp() 
{
	tit_clearActionInfo();
	tit_addSearchActionInfo("cs12:CS1201001B_S9", null, true);

	tit_callService(
        ""
        , ""
        , "ds_cond=ds_cond"
        , "ds_emp_cd=ds_list"
        , ""
        , "fn_afterSearchEmp"
        , true);
}

function fn_searchPersonInfo() 
{
	tit_clearActionInfo();
	tit_addSearchActionInfo("cs12:CS1201001B_S3", null, true);

	tit_callService(
        ""
        , ""
        , "ds_cond=ds_cond"
        , "ds_per_val=ds_list"
        , ""
        , "fn_afterSearchPersonInfo"
        
        , ""
        , ""
        
        , true);
}

function fn_searchGrp_bak() {
	gfn_initDs(ds_cond_grp, true);
	ds_cond_grp.setColumn(0, "UPN", ed_upn.value);
	ds_cond_grp.setColumn(0, "CST", cb_cst.value);

	//그룹계약번호 SELECT
	tit_clearActionInfo();
	tit_addSearchActionInfo("cs12:CS1201001B_S27", null, true);
	tit_callService(
		""
		, ""
		, "ds_cond=ds_cond_grp"
		, "ds_grp_cd=ds_list"
		, ""
		, "fn_afterSearchGrp"
		, true);

	cb_grp.SetFocus();
}

function fn_queryTvr_bak() {
	gfn_initDs(ds_cond_tvr, true);
	gfn_initDs(ds_cond_cnt, true);
	ds_cond_tvr.setColumn(0, "GNO", gno);
	ds_cond_cnt.setColumn(0, "GNO", gno);

	tit_clearActionInfo();
	tit_addSearchActionInfo("cs12:CS1201001B_S48", null, true);
	tit_addSearchActionInfo("cs12:CS1201001B_S49", null, true);
	tit_callService(
		""
		, ""
		, "ds_cond=ds_cond_tvr ds_cond=ds_cond_cnt"
		, "ds_tvr=ds_tvr ds_cnt=ds_cnt"
		, ""
		, "fn_afterSearchTvr"
		, true);
}

/********************************************************************************
* 기      능   : 조회 1
********************************************************************************/
function fn_query()  //계약대상조회
{
	gfn_clearMsgBar();

	// sort mark 삭제
	gfn_clearGridSortMark(grd_list);
	ds_list.row = -1;
	ds_list.ClearData();

//	fn_chkFirst();

	if (chk_save == false) {	
		if(upn <> 'XXXXXX') // 현황 화면에서 계약건을 선택하여 넘어온 경우
		{
			ds_cond.SetColumn(0, "UPN", upn);
			ds_cond.SetColumn(0, "GND", gnd);
			ds_cond.SetColumn(0, "USD", usd);
			ds_cond.SetColumn(0, "UHJ", uhj);
			ds_cond.SetColumn(0, "GNO", gno);
			ds_cond.SetColumn(0, "GBN", "A");
		} 
		else	//계약데이터 상세등록 버튼을 클릭하여  넘어온 경우 
		{
			gnd = 'C';	//유상공사
			ds_cond.SetColumn(0, "UPN", ed_upn.value);
			ds_cond.SetColumn(0, "GND", gnd);
			ds_cond.SetColumn(0, "USD", '');
			ds_cond.SetColumn(0, "UHJ", '');
			ds_cond.SetColumn(0, "GNO", '');
			ds_cond.SetColumn(0, "GBN", "B");
		}
	} else {
		
		ds_cond.SetColumn(0, "UPN", ed_upn.value);
		ds_cond.SetColumn(0, "GND", cb_conkind.value);
		ds_cond.SetColumn(0, "USD", '');
		ds_cond.SetColumn(0, "UHJ", '');
		ds_cond.SetColumn(0, "GNO", '');
		ds_cond.SetColumn(0, "GBN", '');		
	}
	
	ds_cond.SetColumn(0, "CST", cb_cst.value);
	ds_cond.SetColumn(0, "JPGBN", cb_jpgbn.value);
	
	ds_cond.SetColumn(0, "DOCNO", fa_docno); //결재건을 삭제했을 경우 결재화면에서 조회가능하도록 
	
	var user_grp = gfn_getUserGroup();
	
	if(user_grp == "30") // 지방사무소일 경우
	{
		ds_cond.SetColumn(0, "ARA", '');
	} 
	else if(user_grp == "40") // 고객지원부일 경우
	{
		ds_cond.SetColumn(0, "ARA", '');
		//20200609 40권한 이상일 경우에는 동작하지 않으므로 동작하도록 주석처리 Han JH
		//except_flag = true; // 수주 12개월 초과 확인 로직 , 전국 권한에 대해 해제 20170829
	}

	var sql;

	if(gnd == 'C') {        // 유상공사일 경우
		sql = "cs12:CS1201001B_S1";
	} else if(gnd == 'D') { // 유상일반일 경우
		sql = "cs12:CS1201001B_S2";
	} else if(gnd == 'A') {
		sql = "cs12:CS1201001B_S8";
	} else if(gnd == 'B') {
		sql = "cs12:CS1201001B_S8";
	}

	tit_clearActionInfo();
	tit_addSearchActionInfo(sql, null, true);

	tit_callService(
        ""
        , ""
        , "ds_cond=ds_cond"
        , "ds_list=ds_list"
        , ""
        , "fn_afterQuery"
        , true);
}

function fn_query2() { //자동연장 조회
	gfn_clearMsgBar();

	// sort mark 삭제
	gfn_clearGridSortMark(grd_list);
	ds_list.row = -1;
	ds_list.ClearData();

	if(upn <> 'XXXXXX') {
		ds_cond.SetColumn(0, "UPN", upn);
		ds_cond.SetColumn(0, "GND", gnd);
		ds_cond.SetColumn(0, "USD", usd);
		ds_cond.SetColumn(0, "UHJ", uhj);
		ds_cond.SetColumn(0, "GNO", gno);
	} else {
//		gnd = 'D';
		gnd = cb_conkind.value;
		ds_cond.SetColumn(0, "UPN", ed_upn.value);
//		ds_cond.SetColumn(0, "GND", 'D');
		ds_cond.SetColumn(0, "GND", cb_conkind.value);
		ds_cond.SetColumn(0, "USD", '');
		ds_cond.SetColumn(0, "UHJ", '');
		ds_cond.SetColumn(0, "GNO", '');
	}
	ds_cond.SetColumn(0, "CST", cb_cst.value);
	ds_cond.SetColumn(0, "JPGBN", cb_jpgbn.value);

	var user_grp = gfn_getUserGroup();

	if(user_grp == "30") { // 지방사무소일 경우
		ds_cond.SetColumn(0, "ARA", '');
	} else if(user_grp == "40") { // 고객지원부일 경우
		ds_cond.SetColumn(0, "ARA", '');
	}

	var uhj_fm, uhj_to;

	if(chk_auto_first == 0) {
		uhj_fm = gfn_getBeforeMonth(substr(gfn_getCurrDate(),0,6),1) + "01";
		// uhj_fm = gfn_getBeforeMonth(substr(gfn_getCurrDate(),0,6),1) + "27";
		uhj_to = substr(gfn_getCurrDate(),0,6) + "26";
	} else {
		if (vAutoBdgbnFlag == "1"){			// 협력사인데 주계약으로 자동연장
			uhj_fm = substr(gfn_getCurrDate(),0,6) + "01";
			// uhj_fm = gfn_getBeforeMonth(substr(gfn_getAfterDate(gfn_getCurrDate(),365),0,6),1) + "27";
			uhj_to = substr(gfn_getAfterDate(gfn_getCurrDate(),31),0,6) + "26";
		} else {
			uhj_fm = gfn_getBeforeMonth(substr(gfn_getAfterDate(gfn_getCurrDate(),365),0,6),1) + "01";
			// uhj_fm = gfn_getBeforeMonth(substr(gfn_getAfterDate(gfn_getCurrDate(),365),0,6),1) + "27";
			uhj_to = substr(gfn_getAfterDate(gfn_getCurrDate(),365),0,6) + "26";
		}
	}
	
	ds_cond.SetColumn(0, "UHJ_FM", uhj_fm);
	ds_cond.SetColumn(0, "UHJ_TO", uhj_to);

	ds_chkUms.ClearData() ; // 수주 개월수 체크 201610

	tit_clearActionInfo();
	tit_addSearchActionInfo("cs12:CS1201001B_S5", null, true);
	tit_addSearchActionInfo("cs12:CS1201001B_S62", null, true);

	tit_callService(
        ""
        , ""
        , "ds_cond=ds_cond"
        , "ds_list=ds_list  ds_chkUms=ds_chkUms"
        , ""
        , "fn_afterQuery2"
        , true);
}

/* fn_query에 통합하여 불필요

function fn_query3() { //승인대상조회
	trace("************* fn_query3() : 승인대상조회");
	gfn_clearMsgBar();
	
	// sort mark 삭제
	gfn_clearGridSortMark(grd_list);
	ds_list.row = -1;
	ds_list.ClearData();

	if(upn <> 'XXXXXX') {
		ds_cond.SetColumn(0, "UPN", upn);
		ds_cond.SetColumn(0, "GND", gnd);
		ds_cond.SetColumn(0, "USD", usd);
		ds_cond.SetColumn(0, "UHJ", uhj);
		ds_cond.SetColumn(0, "GNO", gno);
		ds_cond.SetColumn(0, "GBN", "A");
	} else {
//		gnd = 'D';
		gnd = cb_conkind.value;
		ds_cond.SetColumn(0, "UPN", ed_upn.value);
//		ds_cond.SetColumn(0, "GND", 'D');
		ds_cond.SetColumn(0, "GND", cb_conkind.value);
		ds_cond.SetColumn(0, "USD", '');
		ds_cond.SetColumn(0, "UHJ", '');
		ds_cond.SetColumn(0, "GNO", '');
		ds_cond.SetColumn(0, "GBN", "B");
	}

	var user_grp = gfn_getUserGroup();

	if(user_grp == "30") { // 지방사무소일 경우
		ds_cond.SetColumn(0, "ARA", G_AREA_CODE);
	} else if(user_grp == "40") { // 고객지원부일 경우
		ds_cond.SetColumn(0, "ARA", '');
	}

	var sql;

	if(gnd == 'C') {        // 유상공사일 경우
		sql = "cs12:CS1201001B_S6";
	} else if(gnd == 'D') { // 유상일반일 경우
		sql = "cs12:CS1201001B_S7";
	} else { //저장 작업이 없으면 승인대상이 없으므로 아무 sql이나 사용
		sql = "cs12:CS1201001B_S6";
	}

	tit_clearActionInfo();
	tit_addSearchActionInfo(sql, null, true);

	tit_callService(
        ""
        , ""
        , "ds_cond=ds_cond"
        , "ds_list=ds_list"
        , ""
        , "fn_afterQuery3"
        , true
        , false
        , true);	//승인대상조회후 승인 처리를 한번에 하기 위해 동기식으로 변경. 2015.01
}
*/

/********************************************************************************
* 기      능   : 삽입 20
********************************************************************************/
function fn_insert() 
{
	// 그리드에 row 추가
	var newRow = gfn_addGridRow(grd_list, -1, "FLAG");
}
/********************************************************************************
* 기      능   : Delete
********************************************************************************/
function fn_delete() 
{
	gfn_clearMsgBar();

	if ( ds_list.rowCount() < 1 ) 
	{
		// 삭제할 정보 없음.
		gfn_showMsg("CW00010");
		return;
	}

	if(ds_list.FindRow("CHK", 1) == -1) {
		gfn_showMsg("CW00013");
		return;
	}

	for(var i=0; i<ds_list.RowCount(); i++) {
		if(ds_list.GetColumn(i, "CHK") == true) { //체크박스가 true 일 경우
			if(ds_list.GetColumn(i, "PST") == 'A6') {
				var arr = [parseInt(i) + 1, st_pst.value];
				gfn_showMsg("CW00132", arr);
				return;
			}

			ds_list.SetColumn(i, "FLAG", "U");
		}
	}

	chk_flag = true;
	calc_Amt("B");

	tit_callService(
        "CS1201001B_ACT"
        , "delete"
        , "ds_list=ds_list"
        , ""
        , ""
        , "fn_afterDelete");
}
/********************************************************************************
* 기      능   : 저장
********************************************************************************/
function fn_save() {
	gfn_clearMsgBar();
	
	//var posid = ed_upn.value + cb_cst.Value;
	//if(gfn_psdCheck(posid))	{
	//	gfn_showAlert("CW00245");		
	//	return;
	//}
	
	if(doubleSaveChk == true) {
		gfn_showAlert("이미 저장버튼을 클릭 하셨습니다. 해당 팝업 종료 후 재 조회를 통해 저장여부 확인하시기 바랍니다.");		//데이터가 없습니다.
		return;
	}

	if(ds_list.rowCount() < 1) {
		// 저장할 정보 없음.
		gfn_showAlert("CW00010");		//데이터가 없습니다.
		return;
	}

	if(ds_list.FindRow("CHK", 1) == -1) {
		gfn_showAlert("CW00013");		//처리할 자료를 먼저 선택해 주십시오.
		return;
	}
	
	if(page_flag == true) {
		gfn_showAlert("CW00149");		//이미 저장을 하셨습니다. 다시 저장하시려면 현재 창을 다시 열어주십시요.
		return;
	}
	
	if(length(cb_cst.value) == 0) {
		gfn_showAlert("CW00162");		//거래선을 선택하십시요.
		return;
	}

	gnd = cb_conkind.value;
	if(chk_query == 'query') { //계약 대상
		if ( !gfn_isChangeDs(ds_list, true) ) {
			return;
		}

		if(gnd == 'C' || gnd == 'D') {
			if(cb_conkind.value == 'D') { //유상일반
				if(substr(cb_cst.value,0,1) == 'C') {
					gfn_showAlert("CW00086");
					return;
				}
/*
				if(length(ed_remark.value) == 0) { //특이사항
					var arr = [st_remark.value];
					gfn_showMsg("CW00001", arr);
					return;
				}
*/
			} else { //유상공사
				if(substr(cb_cst.value,0,1) <> 'C') {
					var arr = [st_cst.value];
					gfn_showAlert("CW00086", arr);
					return;
				}
			}
		} else {
			if(length(cb_cst.value) == 0) {
				var arr = [st_cst.value];
				gfn_showAlert("CW00086", arr);
				return;
			}
		}

		if(length(cb_bsgbn.value) == 0) {
			var arr = [st_bsgbn.value];
			gfn_showAlert("CW00001", arr);
			return;
		}

		if(length(cb_bhcycle.value) == 0) {
			var arr = [st_bhcycle.value];
			gfn_showAlert("CW00001", arr);
			return;
		}

		if(length(cb_bhday.value) == 0) {
			var arr = [st_bhcycle.value];
			gfn_showAlert("CW00001", arr);
			return;
		}

		if(length(cb_jgcnt.value) == 0) {
			var arr = [st_jgcnt.value];
			gfn_showAlert("CW00001", arr);
			return;
		}

		if(length(cb_pergbn.value) == 0) {
			var arr = [st_pergbn.value];
			gfn_showAlert("CW00001", arr);
			return;
		}
		//계약서유무 필수값 20120731
		if(length(cb_cyn.value) == 0) {
			var arr = [st_cyn.value];
			gfn_showAlert("CW00001", arr);
			return;
		}

		if(cb_cyn.value == "Y" && length(cb_ctp.value) == 0) {
			var arr = [st_ctp.value];
			gfn_showAlert("CW00001", arr);
			return;
		}
		
		if(cb_cyn.value == "Y" && length(cb_etc.value) == 0) {
			var arr = [st_etc.value];
			gfn_showAlert("CW00001", arr);
			return;
		}		
		
		//=====종이계약시 비고입력====
		if(cb_etc.value = "1" && length(trim(ed_etcbg.value)) == 0 ) {
			var arr = [st_etcbg.value];
			gfn_showAlert("CW00001", arr);
			return;
		}		
		
		
		if(length(cb_cse.value) == 0) {
			var arr = [st_cse.value];
			gfn_showAlert("CW00001", arr);
			return;
		}
		// 용역여부
		if(length(cb_slagbn.value) == 0) {
			var arr = [st_slagbn.value];
			gfn_showAlert("CW00001", arr);
			return;
		}

		//용역사유 필수값 설정 20120621
		if(cb_slagbn.Value == "Y" && length(cb_slarsn.value) == 0) {
			var arr = ["용역 사유"];
			gfn_showAlert("CW00001", arr);
			return;
		}
		// 기술용역  등록 여부 체크 20161102 이하림 
		if(ed_slaBsu.Text == "Y" && cb_slagbn.Value != "Y") {
			gfn_showAlert("기술용역 계약 대상입니다.");
			return;
		}

		/*  20130719 주석제거 할것
		// 보수 영업사원 입력 필수값
		if(length(trim(ed_sname.value)) == 0 && length(trim(ed_sid.value)) == 0) {
			var arr = [st_sname.value];
			gfn_showMsg("CW00001", arr);
			return;
		}*/
	}
	
	if(chk_query == "auto_query")
	{
		if(cb_cyn.value == "Y" && length(cb_ctp.value) == 0) {
			var arr = [st_ctp.value];
			gfn_showAlert("CW00001", arr);
			return;
		}		
	
		if(cb_cyn.value == "Y" && length(cb_etc.value) == 0) {
			var arr = [st_etc.value];
			gfn_showAlert("CW00001", arr);
			return;
		}	
		
		
		//=====종이계약시 비고입력====
		if(cb_etc.value = "1" && length(trim(ed_etcbg.value)) == 0 ) {
			var arr = [st_etcbg.value];
			gfn_showAlert("CW00001", arr);
			return;
		}		
		
	}
	
	
	var t_bsu_b = "";
	var t_bsu_a = "";
	var chk_i = 0;
	var pre_i = 0;
	
	// 2019.03.29 Han J.H
	// 유상계약 저장시 온핸드 현장 체크
	fn_isOnHandChk();

	if(chk_isOnHand) { // 온핸드 현장이 존재한다면 저장처리 하지 않음.
		chk_isOnHand = false; // 온핸드 체크플래그 초기화
		return;
	}

	for(var i=0; i<ds_list.RowCount(); i++) {
		if(ds_list.GetColumn(i, "CHK") == true) { //체크박스가 true 일 경우
			var str_usd_day = substr(ds_list.GetColumn(i, "USD"),6,2);

			//물류/psd  현대무벡스 분사 작업 2017.08.31
			if(substr(ds_list.GetColumn(i, "HNO"),0,1) == "G") {
				gfn_showAlert("CW00245");
				return;
			}

			if(trim(ds_list.GetColumn(i, "BSU")) == "") {
				var arr = [parseInt(i) + 1, st_bsu_chk.value];
				gfn_showMsg("CW00170", arr);
				ds_list.row = i;
				return;
			}
			
			if(trim(ds_list.GetColumn(i, "BPM")) == "") {
				var arr = [parseInt(i) + 1, st_bpm_chk.value];
				gfn_showMsg("CW00170", arr);
				ds_list.row = i;
				return;
			}
			
			if(trim(ds_list.GetColumn(i, "ARA")) == "") {
				var arr = [parseInt(i) + 1, st_ara_chk.value];
				gfn_showMsg("CW00170", arr);
				ds_list.row = i;
				return;
			}
			
			if(trim(ds_list.GetColumn(i, "JUJ")) == "") {
				var arr = [parseInt(i) + 1, st_juj_chk.value];
				gfn_showMsg("CW00170", arr);
				ds_list.row = i;
				return;
			}
			
			if(trim(ds_list.GetColumn(i, "BUJ")) == "") {
				var arr = [parseInt(i) + 1, st_buj_chk.value];
				gfn_showMsg("CW00170", arr);
				ds_list.row = i;
				return;
			}

			if(length(trim(ds_list.GetColumn(i, "HEP"))) == 0) {
				var arr = [parseInt(i) + 1, st_hep.value];
				gfn_showMsg("CW00055", arr);
				ds_list.row = i;
				return;
			}

			if(parseInt(ds_list.GetColumn(i, "USD")) > parseInt(ds_list.GetColumn(i, "UGS"))) {
				var arr = [parseInt(i) + 1, st_ugs.value];
				gfn_showMsg("CW00055", arr);
				return;
			}

			if(parseInt(ds_list.GetColumn(i, "UGS")) > parseInt(ds_list.GetColumn(i, "UMR"))) {
				var arr = [parseInt(i) + 1, st_umr.value];
				gfn_showMsg("CW00055", arr);
				return;
			}
			//실계약기간 내에 유상계약기간이 포함되어야 한다 20141215 이하림
			if(parseInt(ds_list.GetColumn(i, "USD")) < parseInt(ds_list.GetColumn(i, "RGS"))) {
				var arr = [parseInt(i) + 1, st_rgs.value];
				gfn_showMsg("CW00055", arr);
				return;
			}
			if(parseInt(ds_list.GetColumn(i, "UMR")) > parseInt(ds_list.GetColumn(i, "RMR"))) {
				var arr = [parseInt(i) + 1, st_rmr.value];
				gfn_showMsg("CW00055", arr);
				return;
			}
/*
			if(chk_query == "query") { //자동연장이 아닌 경우
				// 작업월 ( 시스템 일자 ) 이전 월로 계약 만료일 입력 불가 20140428
				if(parseInt( SUBSTR(ds_list.GetColumn(i, "UMR"),0,6)) < parseInt(substr(TODAY(),0,6)) ) {
					gfn_showAlert("현재월의 이전월로 만료일을 입력할 수 없습니다.");
					return;
				}
			}
*/
			// 미입주 M프로젝트는 실패회수 및 타사신규 등록 불가(사업계획 진행현황 대수때문)
			if(ds_list.GetColumn(i, "HST") == "" || ds_list.GetColumn(i, "HST") == "K") {
				if(substr(ds_list.GetColumn(i, "PJT"),0,1) == "M") {

				}
			} else if(ds_list.GetColumn(i, "HST") == "D") { // 상태가 'D'이면서 M프로젝트인 경우 타사신규로만 등록 가능

				if(substr(ds_list.GetColumn(i, "PJT"),0,1) <> "M") {
					var arr = [parseInt(i) + 1, st_hst.value];
					gfn_showMsg("CW00055", arr);
					return;
				} else {

				}
			}

			// FM계약구분 선택시 FM계약연도 필수입력 체크
			if(ds_list.GetColumn(i, "KND_YN") == "1" && length(trim(ds_list.GetColumn(i, "FMY"))) == 0) {
				var arr = [parseInt(i) + 1, st_fmy.value];
				gfn_showMsg("CW00055", arr);
				return;
			}

			// FM계약구분 선택시 FM계약차수 필수입력 체크
			if(ds_list.GetColumn(i, "KND_YN") == "1" && length(trim(ds_list.GetColumn(i, "FMS"))) == 0) {
				var arr = [parseInt(i) + 1, st_fms.value];
				gfn_showMsg("CW00055", arr);
				return;
			}
			// 장기계약구분 선택시 장기계약연도 필수입력 체크
			if(ds_list.GetColumn(i, "LTC") == "1" && length(trim(ds_list.GetColumn(i, "LTY"))) == 0) {
				var arr = [parseInt(i) + 1, st_lty.value];
				gfn_showMsg("CW00055", arr);
				return;
			}

			// 장기계약구분 선택시 장기계약차수 필수입력 체크
			if(ds_list.GetColumn(i, "LTC") == "1" && length(trim(ds_list.GetColumn(i, "LTS"))) == 0) {
				var arr = [parseInt(i) + 1, st_lts.value];
				gfn_showMsg("CW00055", arr);
				return;
			}
			// E/S 경우, HRTS 입력 불가, 매월점검만 입력 가능 2017.11
			if(substr(ds_list.GetColumn(i, "HNO"),0,1) == "S" || substr(ds_list.GetColumn(i, "HNO"),0,1) == "W"){
				if(ds_list.GetColumn(i, "HYN") == "1") {
					gfn_showAlert("E/S호기는 HRTS 입력이 불가합니다.\n호기 재확인 바랍니다.");
					return;
				}
				if(ds_list.GetColumn(i, "HEP") <> "01") {
					gfn_showAlert("E/S호기는 격월/분기 점검 입력이 불가합니다.\n호기 재확인 바랍니다.");
					return;
				}
			}
			//===========================공기청정기 추가 20200515 Han.JH==================================
			// E/S 경우, 공기청정기 입력 불가
			if(substr(ds_list.GetColumn(i, "HNO"),0,1) == "S" || substr(ds_list.GetColumn(i, "HNO"),0,1) == "W"){
				if(ds_list.GetColumn(i, "ACYN") == "1") {
					gfn_showAlert("E/S호기는 공기청정기 입력이 불가합니다.\n호기 재확인 바랍니다.");
					return;
				}
			}
			//======================================================================================
/*
			// 2009.08.04 LJH  실패회수 및 타사신규 입력시 계약개시월이 현재월보다 2개월전인 데이터는 입력 불가능 하도록
			if(cb_congbn.value == '4' || cb_congbn.value == '5') {
				if(substr(ds_list.GetColumn(i,"USD"),0,6) <= gfn_getBeforeMonth(substr(gfn_getCurrDate(),0,6),2)) {
					var arr = [parseInt(i) + 1, st_usd.value];
					gfn_showMsg("CW00055", arr);
					return;
				}
			}
*/
			if(chk_query == 'query') { //자동연장이 아닌 경우
				/* 이전년도 유상계약 불가(EIS 장표 대수 오류) */
				/* 이준석대리 요청 2018.01 */
				//var bYear = substr(ds_list.GetColumn(i, "USD"),0,4);
				//var cYear = substr(gfn_getCurrDate(),0,4);
					
				// if(bYear < cYear) {
					// if(substr(ds_list.GetColumn(i, "HNO"),0,1) != "J"){ 
						// gfn_showAlert("이전년도로 유상계약입력이 불가능합니다.\n판매관리팀에 문의바랍니다.");
						// return;
					// }
				// }

				// 작업월 ( 시스템 일자 ) 이전 월로 계약 만료일 입력 불가 20140428
				// if(parseInt( SUBSTR(ds_list.GetColumn(i, "UMR"),0,6)) < parseInt(substr(TODAY(),0,6)) ) {
					// gfn_showAlert("현재월의 이전월로 만료일을 입력할 수 없습니다.");
					// return;
				// }

				if(length(ds_list.GetColumn(i, "BSU_NM")) == 0 || 
				   length(ds_list.GetColumn(i, "ARA_NM")) == 0 || 
				   length(ds_list.GetColumn(i, "AGB_NM")) == 0 || 
				   length(ds_list.GetColumn(i, "ABG_NM")) == 0) {
					var arr = [parseInt(i) + 1];
					gfn_showMsg("CW00150", arr);
					return;
				}
				
				if(length(ds_list.GetColumn(i, "USD")) == 0) {
					var arr = [parseInt(i) + 1, st_usd.value];
					gfn_showMsg("CW00055", arr);
					return;
				}

				if(length(ds_list.GetColumn(i, "UGS")) == 0) {
					var arr = [parseInt(i) + 1, st_ugs.value];
					gfn_showMsg("CW00055", arr);
					return;
				}

				if(length(ds_list.GetColumn(i, "UMR")) == 0) {
					var arr = [parseInt(i) + 1, st_umr.value];
					gfn_showMsg("CW00055", arr);
					return;
				}

				if(ds_list.GetColumn(i, "AMT") == 0) {
					var arr = [parseInt(i) + 1, st_amt.value];
					gfn_showMsg("CW00055", arr);
					return;
				}

				if(ds_list.GetColumn(i, "HYN") == "1") {
					// HRTS 무상 서비스의 경우 금액 체크 해제 
					if(ds_list.GetColumn(i, "HFR") == "0" ) {
						if(ds_list.GetColumn(i, "HMT") == 0 ){ // 금액확인
							var arr = [parseInt(i) + 1, st_hmt.value];
							gfn_showMsg("CW00055", arr);
							return;
						}	
					}						
					if(length(ds_list.GetColumn(i, "HEP")) == 0 ){ //  점검주기
						var arr = [parseInt(i) + 1, st_hep.value];
						gfn_showMsg("CW00055", arr);
						return;
					}				
					if(length(ds_list.GetColumn(i, "HWR")) == 0 ){ // 회선종류
						var arr = [parseInt(i) + 1, st_hwr.value];
						gfn_showMsg("CW00055", arr);
						return;
					}
				} else {
					ds_list.SetColumn(i, "HMT", 0);
				}
				
				//===========================공기청정기 추가 20200515 Han.JH==================================
				if(ds_list.GetColumn(i, "ACYN") == "1") {
					if(ds_list.GetColumn(i, "ACMT") == 0 ){ // 금액확인
						var arr = [parseInt(i) + 1, st_acmt.value];
						gfn_showMsg("CW00055", arr);
						return;
					}	
				} else {
					ds_list.SetColumn(i, "ACMT", 0);
				}
				//======================================================================================

				if(ds_list.GetColumn(i, "DYN") == "1") {	
					if(ds_list.GetColumn(i, "DMT") == 0) {
						var arr = [parseInt(i) + 1, st_dmt.value];
						gfn_showMsg("CW00055", arr);
						return;
					}
					if(length(ds_list.GetColumn(i, "DND")) == 0 ){ // DI-PBX종류
						var arr = [parseInt(i) + 1, st_dnd.value];
						gfn_showMsg("CW00055", arr);
						return;
					}
				} else {
				
					if(ds_list.GetColumn(i, "DCE") == "1") {	 // DI-PBX 통신료 계약 
						if(ds_list.GetColumn(i, "DMT") == 0) {
							var arr = [parseInt(i) + 1, st_dmt.value];
							gfn_showMsg("CW00055", arr);
							return;
						}
					} else {
					
						ds_list.SetColumn(i, "DMT", 0);
					}
				
				}


				var t_exp = ds_list.GetColumn(i, "EXP");
				var t_usd = ds_list.GetColumn(i, "USD");
				var t_fsd = ds_list.GetColumn(i, "FSD");
				var t_gkd = ds_list.GetColumn(i, "GKD");
				var t_pjt = substr(ds_list.GetColumn(i, "PJT"),0,1);

				if(cb_conkind.value == "C") { //유상공사
					if(t_exp >= t_usd) {
						var arr = [parseInt(i) + 1];
						gfn_showMsg("CW00057", arr);
						return;
					}
				} else if(cb_conkind.value == "D") { //유상일반

				}
			} else { //자동연장일 경우
				/* 이전년도 유상계약 불가(EIS 장표 대수 오류) */
				//var bYear = substr(gfn_getAfterDate(ds_list.GetColumn(i, "UMR"),1),0,4);
				//var cYear = substr(gfn_getCurrDate(),0,4);

				//if(bYear < cYear) {
				//	if(substr(ds_list.GetColumn(i, "HNO"),0,1) != "J") {
				//		gfn_showAlert("이전년도로 유상계약입력이 불가능합니다.\n판매관리팀에 문의바랍니다.");
				//		return;
				//	}
				//}
			}
/*  2014.06.16 LJH 수정 : 유상개시일과 계약만료일을 최대 1년으로 입력가능하도록 처리, 무상기간 입력 가능(최인식과장 요청) */
//			if(gfn_getDayCnt(ds_days, ds_list.GetColumn(i, "USD"),ds_list.GetColumn(i, "UMR")) > 366) {
			if(gfn_getDayCnt(ds_days, ds_list.GetColumn(i, "UGS"),ds_list.GetColumn(i, "UMR")) > 366) {
				var arr = [parseInt(i) + 1];
				gfn_showMsg("CW00079", arr);
				return;
			}

			if(parseInt(ds_list.GetColumn(i, "RTO")) > 100 || parseInt(ds_list.GetColumn(i, "RTO")) < 0) {
				var arr = [parseInt(i) + 1, st_rto.value];
				gfn_showMsg("CW00120", arr);
				return;
			}
/*
			if(chk_query == 'query' && ds_list.GetColumn(i, "PST") == 'A5') {
				ds_list.SetColumn(i, "FLAG", "U");
			} else {
				ds_list.SetColumn(i, "FLAG", "I");
			}
*/
			if(chk_query == 'query') {
				if(ds_list.GetColumn(i, "PST") == 'A5') {
//					ds_list.SetColumn(i, "FLAG", "U"); //2009.10.29 LJH 수정(중복저장방지)
				} else {
					ds_list.SetColumn(i, "FLAG", "I");
				}
			} else if(chk_query == 'auto_query') {
				if(ds_list.GetColumn(i, "PST") == 'A6') {
					ds_list.SetColumn(i, "FLAG", "I");
				} else {
//					ds_list.SetColumn(i, "FLAG", "U"); //2009.10.29 LJH 수정(중복저장방지)
				}
			}

			if(chk_i == 0) {
				t_bsu_b = ds_list.GetColumn(i, "BSU");
			} else {
//				t_bsu_b = ds_list.GetColumn(i-1, "BSU");
				t_bsu_b = ds_list.GetColumn(pre_i, "BSU");
			}

			t_bsu_a = ds_list.GetColumn(i, "BSU");

			if(i > 0 && t_bsu_b <> t_bsu_a) {
				gfn_showAlert("호기별 협력사가 동일하지 않습니다.\n확인하시기 바랍니다.");
				return;
			}

			ds_list.SetColumn(i, "SQL_FLAG", "Y");
			ds_list.SetColumn(i, "MANDT", G_MANDT);
			ds_list.SetColumn(i, "UPN", ed_upn.value);
			ds_list.SetColumn(i, "CST", cb_cst.value);
			ds_list.SetColumn(i, "PST", "A5");

			var hgb = substr(ds_list.GetColumn(i, "HNO"),0,1);
			if(hgb == "L" || hgb == "S" || hgb == "W") {
				ds_list.SetColumn(i, "PRO", "A");
			} else if(hgb == "J") {
				ds_list.SetColumn(i, "PRO", "B");
			} else if(hgb == "G") {
				ds_list.SetColumn(i, "PRO", "C");
			} else if(hgb == "F") {
				ds_list.SetColumn(i, "PRO", "D");
			}

			ds_list.SetColumn(i, "TYP", ds_list.GetColumn(i, "ZSPEC1"));

			if(chk_query == "query") { //자동연장이 아닌 경우
//				ds_list.SetColumn(i, "GKD", cb_congbn.value);
				ds_list.SetColumn(i, "GYB", "");

				var c_cycle = 0;
				var o_cycle = 0;
				if(ds_list.GetColumn(i, "BJG") == "4") {
					c_cycle = 6;
					o_cycle = 6;
				} else if(ds_list.GetColumn(i, "BJG") == "5") {
					c_cycle = 12;
					o_cycle = 12;
				} else {
					c_cycle = parseInt(ds_list.GetColumn(i, "BJG"));
//					o_cycle = parseInt(ds_list.GetOrgColumn(i, "BJG"));
					o_cycle = parseInt(ds_list.GetColumn(i, "ORG_BJG"));
				}
				var c_cgb = parseInt(ds_list.GetColumn(i, "TOT")) / c_cycle;
//				var o_cgb = parseInt(ds_list.GetOrgColumn(i, "TOT")) / o_cycle;
				var o_cgb = parseInt(ds_list.GetColumn(i, "ORG_TOT")) / o_cycle;
//				if(ds_list.GetOrgColumn(i, "TOT") == 0 || ds_list.GetOrgColumn(i, "TOT") == "") {

				if(parseInt(ds_list.GetColumn(i, "ORG_TOT")) == 0 || ds_list.GetColumn(i, "ORG_TOT") == "") {
					ds_list.SetColumn(i, "CGB", "A"); //신규
				} else {
					if(c_cgb > o_cgb) {
						ds_list.SetColumn(i, "CGB", "F"); //인상
					} else if(c_cgb == o_cgb) {
						ds_list.SetColumn(i, "CGB", "G"); //동결
					} else if(c_cgb < o_cgb) {
						ds_list.SetColumn(i, "CGB", "H"); //인하
					}
				}

				var t_ugs = gfn_getBeforeDate(ds_list.GetColumn(i, "UGS"),1) + "";

				ds_list.SetColumn(i, "GND", cb_conkind.value);
/*  2014.06.16 LJH 수정 : 유상개시일과 계약만료일을 최대 1년으로 입력가능하도록 처리, 무상기간 입력 가능(최인식과장 요청) */
//				ds_list.SetColumn(i, "UMS", gfn_getMonthCnt(ds_list.GetColumn(i, "USD"),ds_list.GetColumn(i, "UMR")));
				ds_list.SetColumn(i, "UMS", gfn_getMonthCnt(ds_list.GetColumn(i, "UGS"),ds_list.GetColumn(i, "UMR")));
				if(parseInt(ds_list.GetColumn(i, "USD")) == parseInt(ds_list.GetColumn(i, "UGS"))) {
					ds_list.SetColumn(i, "MMN", 0);
				} else {
					ds_list.SetColumn(i, "MMN", gfn_getMonthCnt(ds_list.GetColumn(i, "USD"),t_ugs));
				}
				ds_list.SetColumn(i, "UHJ", ds_list.GetColumn(i, "UMR"));

				if(cb_conkind.value == "D") {
//					if(length(ds_list.GetOrgColumn(i, "USD")) == 0 && ds_list.GetColumn(i, "KND_YN") == "0") {
					if(length(ds_list.GetColumn(i, "ORG_USD")) == 0 && ds_list.GetColumn(i, "KND_YN") == "0") {
						ds_list.SetColumn(i, "GBM", "11"); //신규(POG)
//					} else if(length(ds_list.GetOrgColumn(i, "USD")) == 0 && ds_list.GetColumn(i, "KND_YN") == "1") {
					} else if(length(ds_list.GetColumn(i, "ORG_USD")) == 0 && ds_list.GetColumn(i, "KND_YN") == "1") {
						ds_list.SetColumn(i, "GBM", "12"); //신규(FM)
//					} else if(ds_list.GetOrgColumn(i, "KND_YN") == "0" && ds_list.GetColumn(i, "KND_YN") == "0") {
					} else if(ds_list.GetColumn(i, "ORG_KND_YN") == "0" && ds_list.GetColumn(i, "KND_YN") == "0") {
						ds_list.SetColumn(i, "GBM", "21"); //POG재계약
//					} else if(ds_list.GetOrgColumn(i, "KND_YN") == "1" && ds_list.GetColumn(i, "KND_YN") == "1") {
					} else if(ds_list.GetColumn(i, "ORG_KND_YN") == "1" && ds_list.GetColumn(i, "KND_YN") == "1") {
						ds_list.SetColumn(i, "GBM", "22"); //FM재계약
//					} else if(ds_list.GetOrgColumn(i, "KND_YN") == "1" && ds_list.GetColumn(i, "KND_YN") == "0") {
					} else if(ds_list.GetColumn(i, "ORG_KND_YN") == "1" && ds_list.GetColumn(i, "KND_YN") == "0") {
						ds_list.SetColumn(i, "GBM", "31"); //FM ==> POG
//					} else if(ds_list.GetOrgColumn(i, "KND_YN") == "0" && ds_list.GetColumn(i, "KND_YN") == "1") {
					} else if(ds_list.GetColumn(i, "ORG_KND_YN") == "0" && ds_list.GetColumn(i, "KND_YN") == "1") {
						ds_list.SetColumn(i, "GBM", "32"); //POG ==> FM
					}
				} else {
					ds_list.SetColumn(i, "GBM", "11");
				}

				if(cb_conkind.value == "D") {
					if(ds_list.GetColumn(i, "IYN") == "1") {
						ds_list.SetColumn(i, "IYN", "Y");
					} else {
						ds_list.SetColumn(i, "IYN", "N");
					}
				} else {
					ds_list.SetColumn(i, "IYN", "");
				}
			} else if(chk_query == "auto_query") { //자동연장인 경우
				if(ds_list.GetColumn(i, "FLAG") == "I") { //자동연장 첫 조회후 저장시
					var a_usd = gfn_getAfterDate(ds_list.GetOrgColumn(i, "UMR"),1) + "";
					var a_gbm = ds_list.GetColumn(i, "GBM");
					var t_umr = ds_list.GetOrgColumn(i, "UMR");
					if(a_gbm == "11" || a_gbm == "21" || a_gbm == "31") {
						a_gbm = "21";
					} else if(a_gbm == "12" || a_gbm == "22" || a_gbm == "32") {
						a_gbm = "22";
					}

					if(fsd_flag == true) { //실패승인일이 있을시
//						ds_list.SetColumn(i, "GKD", "4");
					} else {
//						ds_list.SetColumn(i, "GKD", "2");
					}
					ds_list.SetColumn(i, "GYB", "Y");
					ds_list.SetColumn(i, "CGB", "G");
					ds_list.SetColumn(i, "GND", "D");
					ds_list.SetColumn(i, "USD", a_usd);
					ds_list.SetColumn(i, "UGS", a_usd);
					
					// 연수주 최대 12개월 입력 제한 관련
					// 자동연장 입력 가능 개월 수 에 따라 계약기간 조정 201610 이하림 
					// 입력 가능 개월수 P_UMS
					
					var org_umr_day = substr(t_umr,6,2) ;    // 전계약 만료일자
					var org_umr_yearm = substr(t_umr,0,6) ;  // 전계약 만료년월
					
					var new_usd_day = substr(a_usd,6,2) ;   // 자동연장 만료일자
					var new_umr_yearm = gfn_getAfterMonth( substr(t_umr,0,6), P_UMS) ; // 자동연장 만료년월

					if(P_UMS == 12) {
						new_umr_yearm = substr(gfn_getAfterDate(t_umr,365),0,6);
					}
					var new_umr ;  // 자동연장 만료일자

					if(new_usd_day == "01") {
						new_umr = gfn_getLeapLastDay( new_umr_yearm+'01' );
						// alert("new 계약개시일 :  " + a_usd);
						//  alert("new 계약만료일 :  " + new_umr);
						
					} else {
						new_umr = new_umr_yearm + org_umr_day ;
						// alert("new 계약개시일 :  " + a_usd);
						// alert("new 계약만료일 :  " + new_umr);
					}
					// 날짜 유효성 체크  201706 
					new_umr = _fn_getCorrectDate(new_umr);

					ds_list.SetColumn(i, "UMS", gfn_getMonthCnt(a_usd,new_umr));
					//ds_list.SetColumn(i, "UMS", gfn_getMonthCnt(a_usd,gfn_getAfterDate(t_umr,365)+""));
//					ds_list.SetColumn(i, "UMS", gfn_getMonthCnt(a_usd,gfn_getAfterDate(t_umr,366)+"")); //윤년
					ds_list.SetColumn(i, "MMN", 0);
					ds_list.SetColumn(i, "UMR", new_umr);
					ds_list.SetColumn(i, "UHJ", new_umr);
					//ds_list.SetColumn(i, "UMR", gfn_getAfterDate(t_umr,365));
					//ds_list.SetColumn(i, "UHJ", gfn_getAfterDate(t_umr,365));
//					ds_list.SetColumn(i, "UMR", gfn_getAfterDate(t_umr,366)); //윤년
//					ds_list.SetColumn(i, "UHJ", gfn_getAfterDate(t_umr,366)); //윤년
					ds_list.SetColumn(i, "GBM", a_gbm);
					ds_list.SetColumn(i, "IYN", "");
					ds_list.SetColumn(i, "WIL", "");
					ds_list.SetColumn(i, "RGS", a_usd);
					ds_list.SetColumn(i, "RMR", new_umr);
					//ds_list.SetColumn(i, "RMR", gfn_getAfterDate(t_umr,365));
//					ds_list.SetColumn(i, "RMR", gfn_getAfterDate(t_umr,366)); //윤년
					
					tmp_usd = a_usd;
					tmp_uhj = new_umr;
					//tmp_uhj = gfn_getAfterDate(t_umr,365);
//					tmp_uhj = gfn_getAfterDate(t_umr,366); //윤년
	
					if(tmp_usd < a_usd) {
						tmp_usd = a_usd;
					}

					if(tmp_uhj < new_umr) {
						tmp_uhj = new_umr;
					}
					//if(tmp_uhj < gfn_getAfterDate(t_umr,365)) {
					//	tmp_uhj = gfn_getAfterDate(t_umr,365);
					//}

//					if(tmp_uhj < gfn_getAfterDate(t_umr,366)) { //윤년
//						tmp_uhj = gfn_getAfterDate(t_umr,366);
//					}
				}
			}
			// 비율제 사용안함 201610
			if(cb_conkind.value == "D") {
				ds_list.SetColumn(i, "RGB", "N");
				ds_list.SetColumn(i, "RTO", 0);
			}

			ds_list.SetColumn(i, "BGB", cb_bsgbn.value);
			ds_list.SetColumn(i, "BJG", cb_bhcycle.value);
			ds_list.SetColumn(i, "TIS", cb_bhday.value);
			ds_list.SetColumn(i, "JKH", parseInt(cb_jgcnt.value));

			if(chk_nightgbn.value == "0") {
				ds_list.SetColumn(i, "YYB", "N");
			} else {
				ds_list.SetColumn(i, "YYB", "Y");
			}

			ds_list.SetColumn(i, "RMK", ed_remark.value);
			ds_list.SetColumn(i, "ZER", cb_pergbn.value);
			ds_list.SetColumn(i, "CYN", cb_cyn.value);
			ds_list.SetColumn(i, "CTP", cb_ctp.value);
			ds_list.SetColumn(i, "ETC", cb_etc.value);
			ds_list.SetColumn(i, "CSE", cb_cse.value);
			
			ds_list.SetColumn(i, "ETCBG", trim(ed_etcbg.value)); //=====종이계약시 비고입력====
			
			
			
			if(chk_cfg.value == "0") {
				ds_list.SetColumn(i, "CFG", "");
			} else {
				ds_list.SetColumn(i, "CFG", "Y");
			}
			ds_list.SetColumn(i, "WYB", "Y");

			if(cb_pergbn.value == "Y") {
				ds_list.SetColumn(i, "VAT", 0);
			} else {
				ds_list.SetColumn(i, "VAT", ds_list.GetColumn(i, "VAT"));
			}

			if(ds_list.GetColumn(i, "RGB") == "1") {
				//ds_list.SetColumn(i, "RTO", 60); //비율제 계약
			} else if(ds_list.GetColumn(i, "KND_YN") == "1") {
				ds_list.SetColumn(i, "RTO", 53); //FM 계약
			}

			if(hgb == "J") { //주차일 경우 57
				ds_list.SetColumn(i, "RGB", "Y");
			//	ds_list.SetColumn(i, "RTO", 57);
				ds_list.SetColumn(i, "RTO", 60);
			} else if(hgb == "G") { //PSD일 경우 0
				ds_list.SetColumn(i, "RTO", 0);
			} else if(hgb == "S" || hgb == "W") { //ES, MW일 경우 60
				ds_list.SetColumn(i, "RTO", 64.2);
			}

			if(cb_conkind.value == "C") {
				ds_list.SetColumn(i, "KND_YN", "");
				ds_list.SetColumn(i, "KND", "");
			}

			if(ds_list.GetColumn(i, "KND_YN") == "0" || ds_list.GetColumn(i, "KND_YN") == "") {
				ds_list.SetColumn(i, "KND", "");
			}

			ds_list.SetColumn(i, "REQ", G_USER_ID);

			if(cb_conkind.value == "C" && ds_list.GetColumn(i, "CS2") == "1") {
				ds_list.SetColumn(i, "GBN", "A");
			} else if(cb_conkind.value == "C" && ds_list.GetColumn(i, "CS2") <> "1") {
				ds_list.SetColumn(i, "GBN", "B");
			} else if(cb_conkind.value == "D" && ds_list.GetColumn(i, "IS2") == "1") {
				ds_list.SetColumn(i, "GBN", "C");
			} else if(cb_conkind.value == "D" && ds_list.GetColumn(i, "IS2") <> "1") {
				ds_list.SetColumn(i, "GBN", "D");
			}

//			ds_list.SetColumn(i, "BHD", gfn_getBeforeDate(ds_list.GetOrgColumn(i, "USD"),1));
//			ds_list.SetColumn(i, "MYT", gfn_getBeforeDate(ds_list.GetOrgColumn(i, "USD"),1));
			ds_list.SetColumn(i, "BHD", gfn_getBeforeDate(ds_list.GetColumn(i, "ORG_USD"),1));
			ds_list.SetColumn(i, "MYT", gfn_getBeforeDate(ds_list.GetColumn(i, "ORG_USD"),1));

			var c_gkd = ds_list.GetColumn(i, "GKD");
			var c_fsd = ds_list.GetColumn(i, "FSD");
			var c_ccg = ds_list.GetColumn(i, "CCG");
			var c_hst = ds_list.GetColumn(i, "HST");
			var c_pjt = substr(ds_list.GetColumn(i, "PJT"),0,1);
			var a_gkd = "";
			var t_gbn = ds_list.GetColumn(i, "CBN");
			var t_dif = ds_list.GetColumn(i, "DIF");

			if(length(trim(c_gkd)) > 0) {
				if(length(trim(c_fsd)) > 0 || c_hst == "F") { //실패회수
					ds_list.SetColumn(i, "GKD", "4");
					ds_list.SetColumn(i, "CGB", "R");
					a_gkd = "4";
				} else { //재계약
					ds_list.SetColumn(i, "GKD", "2");
					a_gkd = "2";
				}
			} else {
				if(length(trim(c_fsd)) > 0 || c_hst == "F") { //실패회수
					ds_list.SetColumn(i, "GKD", "4");
					ds_list.SetColumn(i, "CGB", "R");
					a_gkd = "4";
				} else if(c_pjt == "M") {
					if(c_hst == "U") { //재계약
						ds_list.SetColumn(i, "GKD", "2");
						a_gkd = "2";
					} else { //실패회수, 타사신규
						ds_list.SetColumn(i, "GKD", "5");
						a_gkd = "5";
						if(c_ccg == "A") {
							ds_list.SetColumn(i, "GKD", "4");
							ds_list.SetColumn(i, "CGB", "R");
							a_gkd = "4";
						}
					}
				} else {
					if(c_hst == "U") { //재계약
						ds_list.SetColumn(i, "GKD", "2");
						a_gkd = "2";
					} else { //자사신규
						ds_list.SetColumn(i, "GKD", "1");
						a_gkd = "1";
					}
				}
			}

			// 2013.09.28 LJH 갱신계약(GKD : 2)인 현장에 대하여 인상/인하/동결을 사용자가 선택하여 등록
//			if(a_gkd <> "2" || length(trim(c_gkd)) == 0) {
			if(a_gkd <> "2") {
				ds_list.SetColumn(i, "CBN", "");
				ds_list.SetColumn(i, "DIF", 0);
			} 
			else {
			if(length(trim(t_gbn)) == 0) {
					gfn_showAlert("계약변동구분이 누락되었습니다.\n확인하시기 바랍니다.");
					return;
				}

				if(t_dif < 0) {
					gfn_showAlert("차액금액이 누락되었습니다.\n확인하시기 바랍니다.");
					return;
				}

			}

			/* 20120905  LHR 용역계약과 일반계약간의 용역계약여부 변경 확인*/
			/*20121019 LHR 상태값 체크 추가 */
		/*2	if(ds_list.GetColumn(i, "GKD") == "2" && ds_list.GetOrgColumn(i, "PST") > "") { // 현재 계약이 재계약 상태인 경우
				if(cb_slagbn.value != ds_list.GetOrgColumn(i, "SLA")) { //이전계약과 현재계약의 SLA 값이 상이한 경우
					gfn_showAlert("호기상태를 확인하십시오.");
					return;
				}
			}*/

			ds_list.SetColumn(i, "SLA", cb_slagbn.value);
			ds_list.SetColumn(i, "SLR", cb_slarsn.value);

			if(cb_conkind.value == "D") {
				if(c_pjt == "0" || c_pjt == "1" || c_pjt == "2" || c_pjt == "3") {
					if(length(trim(c_fsd)) > 0) {
						if(a_gkd == "4") {
							if(gfn_getDayCnt(ds_days, ds_list.GetColumn(i, "USD"), ds_list.GetColumn(i, "UMR")) <= 365) {
								ds_list.SetColumn(i, "WIL", "1"); //자사 1년미만 회수
							} else {
								ds_list.SetColumn(i, "WIL", "2"); //자사 2년이상 회수
							}
						} else {
							ds_list.SetColumn(i, "WIL", "");
						}
					} else {
						ds_list.SetColumn(i, "WIL", "");
					}
				} else if(c_pjt == "M") {
					if(length(trim(c_fsd)) > 0) {
						if(a_gkd == "4" || a_gkd == "5") {
							ds_list.SetColumn(i, "WIL", "3"); //타사 회수
						} else {
							ds_list.SetColumn(i, "WIL", "");
						}
					} else {
						ds_list.SetColumn(i, "WIL", "");
					}
				} else {
					ds_list.SetColumn(i, "WIL", "");
				}
			} else {
				ds_list.SetColumn(i, "WIL", "");
			}
			// /*HRTS 여부*/
			// if(ds_list.GetColumn(i,"HYN") == true){
				// ds_list.SetColumn(i,"HYN", "Y");
			// } else {
				// ds_list.SetColumn(i,"HYN", "N");
			// }
			// /*DI-PBX 여부*/			
			// if(ds_list.GetColumn(i,"DYN") == true){
				// ds_list.SetColumn(i,"DYN", "Y");
			// } else {
				// ds_list.SetColumn(i,"DYN", "N");
			// }
			/*DI-PBX 통신료 계약 여부*/		
			// if(ds_list.GetColumn(i,"DCE") == true){
				// ds_list.SetColumn(i,"DCE", "Y");
			// } else {
				// ds_list.SetColumn(i,"DCE", "N");
			// }
			//장기계약 여부 1 >> 'Y' 
			if(ds_list.GetColumn(i,"LTC") == "0") {
				ds_list.SetColumn(i, "LTC", "N");
			} else {
				ds_list.SetColumn(i, "LTC", "Y");
			}
			if(chk_fcm.Value == "0") {
				ds_list.SetColumn(i, "FCM", "");
			} else {
				ds_list.SetColumn(i, "FCM", "Y");
			}
			
			pre_i = i;
			chk_i++;
		}
	}
	// 견적조회, 계약생성 이 아닌 경우는 견적번호 지우기 201511 이하림
	if(est_flag == false) {
		ed_estno.Text = "";
	}

//	if (ed_estno.Text<>'') {
		ds_list.AddColumn("SIR"); 
		
		for(var i=0; i<ds_list.RowCount(); i++) {
			/*견적번호_차수  추가*/
			
			ds_list.SetColumn(i, "SIR", ed_estno.Text);
		}
//	}
	
	//결재번호생성
	//fn_docgen();
	ed_docno.Text = ds_docno_gen.GetColumn(0, "DOCNO");		
	for(var i=0; i<ds_list.RowCount(); i++) {	
		ds_list.SetColumn(i, "DNO", ed_docno.Text);
	}
		
	ds_gbn.SetColumn(0, "KIND", cb_conkind.value); //C:유상공사 , D:유상일반
	ds_gbn.SetColumn(0, "GBN", "");
	chk_flag = true;
	calc_Amt("B");
	
	for(var i=0; i<ds_list.RowCount(); i++) {
		if(ds_list.GetColumn(i, "CHK") != true) { 
			ds_list.DeleteRow(i);
		}
	}
	
	// 표준단가 산출용 기준일자 DAT 
	for(var i=0; i<ds_list.RowCount(); i++) {
		if(ds_list.GetColumn(i, "CHK") == true) { 
			ds_list.SetColumn(i, "DAT", ds_list.getColumn(i, "USD") );
		} else {
			ds_list.SetColumn(i, "DAT", gfn_getCurrDate());
		}
		// 견적연계 등록의 경우 견적의 영업담당자
		// copytool 및 자동연장의 경우 작성자 
		if(length(ed_estno.Text) == 0) {
			ds_list.SetColumn(i, "SID", G_USER_ID );
			ds_list.SetColumn(i, "ZMAN", G_USER_NAME );
		}
	}
	//  수주 12개월 초과 확인 로직 , 전국 권한에 대해 해제 20170829
	// 20200609 40권한 이상일 경우에는 동작하지 않으므로 동작하도록 주석처리 Han JH
	//if(except_flag == true) {
		//ds_gbn.SetColumn(0, "EXCEPT", "Y" );
	//}
	
	// 2020.06.29 이준석 과장 일때 수주보전로직 동작하지 않도록 SAP ID 셋팅 Han JH
	if(G_SAP_USER_ID = "H2020971") {
		ds_gbn.SetColumn(0, "EXCEPT", "Y" );
	} else {
		ds_gbn.SetColumn(0, "EXCEPT", "N" );
	}
	
	//=========================================20200615 이전 보수협력사의 영업그룹과 현 보수협력사의 영업그룹을 세팅한다======================
	//========================================================================================================================================
	ds_gbn.SetColumn(0, "BF_BSU", bf_vVkbur ); // 이전 협력사의 영업그룹 세팅
	ds_gbn.SetColumn(0, "AF_BSU", vVkbur ); // 계약대상 협력사의 영업그룹 세팅
	//========================================================================================================================================
	
	doubleSaveChk = true;
	
	tit_callService(
        "CS1201001B_ACT"
        , "save"
        , "ds_gbn=ds_gbn ds_list=ds_list ds_lists=ds_lists"
        , ""
        , ""
        , "fn_afterSave");
}

//fn_save3() backup 12050223
function fn_save3_bak() { //승인
	gfn_clearMsgBar();

	if ( ds_list.rowCount() < 1 ) {
		// 저장할 정보 없음.
		gfn_showMsg("CW00010");
		return;
	}

	if(ds_list.FindRow("CHK", 1) == -1) {
		gfn_showMsg("CW00013");
		return;
	}
			
	gnd = cb_conkind.value;
	if(chk_query == 'seungin_query') { //승인 대상
		if ( !gfn_isChangeDs(ds_list, true) ) {
			return;
		}
	}

	var tmp_amt = 0; //호기별 금액
	var tot_amt = 0; //계약 전체 금액
	
	ds_cost_o.ClearData();
	ds_cost_sum.ClearData();
	// trace("###############################");
	// trace("%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%");
	// trace("시행율 계산 ds_list.saveXml()");
	// trace(ds_list.saveXml());
	// trace("%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%");
				
	for(var i=0; i<ds_list.RowCount(); i++) {
		var t_grp = "";

		if(ds_list.GetColumn(i, "CHK") == true) { //체크박스가 true 일 경우
			// if(ds_list.GetColumn(i, "PST") == "A6") {
				// var arr = [parseInt(i) + 1, st_pst.value];
				// gfn_showMsg("CW00055", arr);
				// return;
			// }

			ds_list.SetColumn(i, "FLAG", "U");
			ds_list.SetColumn(i, "SQL_FLAG", "Y");
			ds_list.SetColumn(i, "MANDT", G_MANDT);
			ds_list.SetColumn(i, "UPN", ed_upn.value);
			ds_list.SetColumn(i, "CST", cb_cst.value);
			ds_list.SetColumn(i, "GND", cb_conkind.value);
			ds_list.SetColumn(i, "JKH", parseInt(cb_jgcnt.value));
			ds_list.SetColumn(i, "PST", "A6");
			ds_list.SetColumn(i, "BHD", gfn_getBeforeDate(ds_list.GetColumn(i, "USD"),1));
			ds_list.SetColumn(i, "REQ", G_USER_ID);

			t_grp = cb_grp.value;

			if(parseInt(ds_list.GetColumn(i, "UMS")) < 12) {
				if(length(trim(cb_grp.value)) > 0) {
					ds_list.SetColumn(i, "GRP", t_grp);
				} else {
					ds_list.SetColumn(i, "GRP", "");
				}
			} else {
				ds_list.SetColumn(i, "GRP", "");
			}

			if(cb_conkind.value == "C") {
				ds_list.SetColumn(i, "GBN", "C");
			} else if(cb_conkind.value == "D") {
				ds_list.SetColumn(i, "GBN", "D");
			}

			tmp_amt = 0;
			var t_mon_fm, t_mon_to, s_ums;

			t_mon_fm = ds_list.GetColumn(i, "RGS");
			t_mon_to = ds_list.GetColumn(i, "RMR");

			s_ums = parseInt(gfn_getMonthCnt(t_mon_fm, t_mon_to));

			if(length(trim(ds_list.GetColumn(i, "KND"))) > 0) { //FM
				//tmp_amt = (ds_list.GetColumn(i, "AMT") + ds_list.GetColumn(i, "HMT") + ds_list.GetColumn(i, "DMT")) * s_ums;
				
				//===========================공기청정기 추가 20200515 Han.JH==================================
				tmp_amt = (ds_list.GetColumn(i, "AMT") + ds_list.GetColumn(i, "HMT") + ds_list.GetColumn(i, "DMT") + ds_list.GetColumn(i, "ACMT")) * s_ums;
				//======================================================================================
			} else { //POG
				//tmp_amt = (ds_list.GetColumn(i, "AMT") + ds_list.GetColumn(i, "HMT") + ds_list.GetColumn(i, "DMT")) * s_ums;
				
				//===========================공기청정기 추가 20200515 Han.JH==================================
				tmp_amt = (ds_list.GetColumn(i, "AMT") + ds_list.GetColumn(i, "HMT") + ds_list.GetColumn(i, "DMT") + ds_list.GetColumn(i, "ACMT")) * s_ums;
				//======================================================================================
			}

			tot_amt = tot_amt + tmp_amt;

			//s_grp:팀, s_bgb:직영구분, s_knd:계약상품, s_spc:기종, s_flr:층수
			//s_spd:속도, s_hno:호기, s_bld:건물용도, s_fdt:설치연령, s_hep:점검주기
			//s_ums:수주개월수, s_amt:매출액, s_abg:아파트빌딩구분, s_fms:FM계약차수, s_hwr:유무선구분
			//s_fhg:HRTS최초여부, s_hyn:HRTS여부, s_tvr:감시반구분, s_cnt:계약대수(EL), s_dnd:DI-PBX종류
			//s_acd:특성코드
			//s_acnd:공기청정기종류
			var s_grp, s_bgb, s_knd, s_spc, s_flr;
			var s_spd, s_hno, s_bld, s_fdt, s_hep;
			var s_amt, s_abg, s_fms, s_hwr, s_fhg;
			var s_hyn, s_tvr, s_cnt, s_dnd, s_acd;
			var s_acnd;

			s_grp = ds_list.GetColumn(i, "VKGRP");
			s_bgb = ds_list.GetColumn(i, "BSUGB");
			s_knd = ds_list.GetColumn(i, "KND");
			s_spc = ds_list.GetColumn(i, "ZSPEC12");
			s_flr = ds_list.GetColumn(i, "ZSPEC7");
			s_spd = ds_list.GetColumn(i, "ZSPEC3");
			s_hno = ds_list.GetColumn(i, "HNO");
			s_bld = ds_list.GetColumn(i, "BLD");
			s_fdt = ds_list.GetColumn(i, "FDT");
			s_hep = ds_list.GetColumn(i, "HEP");
			//s_ums = ds_list.GetColumn(i, "UMS");
			s_amt = ds_list.GetColumn(i, "AMT");
			s_abg = ds_list.GetColumn(i, "ABG");
			s_fms = ds_list.GetColumn(i, "FMS");
			s_hwr = ds_list.GetColumn(i, "HWR");
			s_fhg = ds_list.GetColumn(i, "FHG");
			s_hyn = ds_list.GetColumn(i, "HYN");
			s_tvr = ds_tvr.GetColumn(0, "TVR");
			s_cnt = ds_cnt.GetColumn(0, "CNT");
			s_dnd = ds_list.GetColumn(i, "DND");
			s_acd = ds_list.GetColumn(i, "ACD");
			s_acnd = ds_list.GetColumn(i, "ACND");
			
			trace("fn_CalRat2(i="+i+", s_grp="+s_grp+", s_bgb="+s_bgb+", s_knd="+s_knd+", s_spc="+s_spc+", s_flr="+s_flr+", "+
			      "s_spd="+s_spd+", s_hno="+s_hno+", s_bld="+s_bld+", s_fdt="+s_fdt+", s_hep="+s_hep+", "+
			      "s_ums="+s_ums+", s_amt="+s_amt+", s_abg="+s_abg+", s_fms="+s_fms+", s_hwr="+s_hwr+","+
			      "s_fhg="+s_fhg+", s_hyn="+s_hyn+", s_tvr="+s_tvr+", s_cnt="+s_cnt+", s_dnd="+s_dnd+","+
			      "s_acd="+s_acd+", s_acnd="+s_acnd);
			//시행율 계산
			/*
			fn_CalRat(s_grp, s_bgb, s_knd, s_spc, s_flr, 
			          s_spd, s_hno, s_bld, s_fdt, s_hep, 
			          s_ums, s_amt, s_abg, s_fms, s_hwr,
			          s_fhg, s_hyn, s_tvr, s_cnt, s_dnd,
			          s_acd);
			 */
			 
			fn_CalRat2(i, s_grp, s_bgb, s_knd, s_spc, s_flr, 
			          s_spd, s_hno, s_bld, s_fdt, s_hep, 
			          s_ums, s_amt, s_abg, s_fms, s_hwr,
			          s_fhg, s_hyn, s_tvr, s_cnt, s_dnd,
			          s_acd, s_acnd);
			
		}
	}

	ds_gbn.SetColumn(0, "KIND", cb_conkind.value);
	ds_gbn.SetColumn(0, "GBN", "");

	ds_umr.SetColumn(0, "UMR", ds_list.GetColumn(0, "UMR"));
	
	fn_incentiveCal();
	
	tit_clearActionInfo();
	tit_addSearchActionInfo("cs12:CS1201001B_S38");	//유상보수 만료일 체크
	tit_callService(
        ""
        , ""
        , "ds_umr=ds_umr"
        , "ds_dateCnt=ds_dateCnt"
        , ""
        , "fn_checkUmr"
        , true);
        
}

function fn_incentiveCal(){
	trace("###############################fn_incentiveCal()");
	var nmt = 0;
	var jmt = 0;
	var jmt2 = 0; 
	var kmt = 0;
	var hmt = 0;
	var dmt = 0;
	var cmt = 0;
	var gmt = 0;
	var gmt2 = 0;
	var cos1 = 0;
	var cos2 = 0;
	var costt = 0;
	var costt2 = 0;
	var amt = 0;
	var tamt = 0;
	
	//===========================공기청정기 추가 20200515 Han.JH==================================
	var acmt = 0;
	//======================================================================================
	
	for(var i=0; i <= ds_cost_sum.rowcount; i++){
		nmt += parseInt(ds_cost_sum.GetColumn(i, "NMT"));
		jmt += parseInt(ds_cost_sum.GetColumn(i, "JMT"));
		//jmt2 += parseInt(ds_cost_sum.GetColumn(i, "JMT2"));
		kmt += parseInt(ds_cost_sum.GetColumn(i, "KMT"));
		hmt += parseInt(ds_cost_sum.GetColumn(i, "HMT"));
		//===========================공기청정기 추가 20200515 Han.JH==================================
		acmt += parseInt(ds_cost_sum.GetColumn(i, "ACMT"));
		//======================================================================================
		dmt += parseInt(ds_cost_sum.GetColumn(i, "DMT"));
		cmt += parseInt(ds_cost_sum.GetColumn(i, "CMT"));
		gmt += parseInt(ds_cost_sum.GetColumn(i, "GMT"));
		//gmt2 += parseInt(ds_cost_sum.GetColumn(i, "GMT2"));
		cos1 += parseInt(ds_cost_sum.GetColumn(i, "COS1"));
		cos2 += parseInt(ds_cost_sum.GetColumn(i, "COS2"));
		costt += parseInt(ds_cost_sum.GetColumn(i, "COSTT"));
		costt2 += parseInt(ds_cost_sum.GetColumn(i, "COSTT2"));
		amt += parseInt(ds_cost_sum.GetColumn(i, "AMT"));
		tamt += parseInt(ds_cost_sum.GetColumn(i, "TAMT"));
	}

	var rat = round((costt / tamt * 100),1);
	ds_cost.SetColumn(0, "ZYEAR", ds_cost_i.GetColumn(0,"ZYEAR"));
	ds_cost.SetColumn(0, "NMT", nmt);
	ds_cost.SetColumn(0, "JMT", jmt); 
	ds_cost.SetColumn(0, "KMT", kmt);
	ds_cost.SetColumn(0, "HMT", hmt);
	//===========================공기청정기 추가 20200515 Han.JH==================================
	ds_cost.SetColumn(0, "ACMT", acmt);
	//======================================================================================
	ds_cost.SetColumn(0, "DMT", dmt);
	ds_cost.SetColumn(0, "CMT", cmt);
	ds_cost.SetColumn(0, "GMT", gmt);
	ds_cost.SetColumn(0, "COST", costt);
	ds_cost.SetColumn(0, "RAT", rat);
	ds_cost.SetColumn(0, "TAMT", tamt);
	ds_cost.SetColumn(0, "SJT", 0); // 후속 프로세스에서 상주 포함 시행율 산출 
}

/********************************************************************************
* 기      능   : 만료일-승인일 체크 후 승인처리
********************************************************************************/
function fn_checkUmr() {
	
/*	if(ds_dateCnt.GetColumn(0, "CNT") >= 1 ){
		gfn_showAlert("만료일자가 승일일자 보다 작습니다. 승인처리를 1취소합니다.");
		return;
	}
*/
	tit_callService(
        "CS1201001B_ACT"
        , "save3"
        , "ds_gbn=ds_gbn ds_list=ds_list ds_cost=ds_cost"
        , ""
        , ""
        , "fn_afterSave3");

}
/********************************************************************************
* 기      능   : 닫기
********************************************************************************/
function fn_close() {
	if(query_flag == true) {
		parent.ed_upn.value = ed_upn.value;
		parent.ed_cst.value = ed_cst.value;
		parent.fn_query();
	}
	
	close();
}
/********************************************************************************
* 기      능   : 액셀
********************************************************************************/
function fn_excel() {
	// Excel Export
	gfn_saveToExcel(grd_list, true);
}
/********************************************************************************
* 기      능   : 접수 5
********************************************************************************/
function fn_receipt() {

}
/********************************************************************************
* 기      능   : 승인 10
********************************************************************************/
function fn_approval() {

}

/********************************************************************************
* 기      능   : 취소 35
********************************************************************************/
function fn_cancel() {

}
/********************************************************************************
* 기      능   : print 40
********************************************************************************/
function fn_print() {

}
/********************************************************************************
* 기      능   : 발행 50
********************************************************************************/
function fn_out() {

}
/********************************************************************************
* 기      능   : 신청 55
********************************************************************************/
function fn_request() {

}
/********************************************************************************
* 기      능   : 전송 60
********************************************************************************/
function fn_trans() {

}
/********************************************************************************
* 기      능   : 계산 70
********************************************************************************/
function fn_cal() {

}
/********************************************************************************
* 기      능   : 복사 75
********************************************************************************/
function fn_copy() {

}
/********************************************************************************
* 기      능   : 확인 80
********************************************************************************/
function fn_confirm() {

}
//=========================================================================================
// [ PART 4]
// Callback 함수 정의 : callback 함수명은 메인 함수의 fn_xxxx() 에서 xxxx 부분은 fn_afterXXXX()
// 형태가 되도록 작성
//=========================================================================================
/********************************************************************************
* 기      능   : 조회 Callback
********************************************************************************/
function fn_afterSearchComboCst(errCode, errMsg) {
//	trace("#fn_afterSearchComboCst#");
	cb_cst.value = cst;
	fn_searchNamSpt();
}

function fn_afterSearchNamSpt(errCode, errMsg) {
	ed_nam.value = ds_nam_cd.GetColumn(0, "NAM");
	ed_spt.value = ds_nam_cd.GetColumn(0, "SPT");
	ed_slaBsu.value = ds_nam_cd.GetColumn(0, "SLA_BSU");
}

function fn_afterSearchPersonInfo(errCode, errMsg) {
	calc_Amt("A");
}

function fn_afterSearchEmp(errCode, errMsg) {

}

function fn_afterSearchGrp(errCode, errMsg) {
	fn_queryTvr();
}

function fn_afterSearchTvr(errCode, errMsg) {

}

function fn_afterCodeSearch(errCode, errMsg) {
	ds_temno_cd.insertRow(0);
	ds_temno_cd.setColumn(0, "TEMNO", "");
	ds_temno_cd.setColumn(0, "NAMET", "ALL");

	cb_temno.value = "";
}

function fn_afterQuery(errCode, errMsg) {
	fn_searchPersonInfo();

	chk_query = "query";
	fsd_flag = false;
	cb_conkind.value = gnd;
	btn_copy.Enable = true;
	cb_grp.Enable = false;
	cb_grp.Index = 0;

	cb_apstat.Value = ds_list.GetColumn(0, "APSTAT");
	ed_docno.Text = ds_list.GetColumn(0, "DOCNO");


	if(ds_list.GetColumn(0, "CFG") == "Y") {
		chk_cfg.Enable = true;
	} else {
		chk_cfg.Enable = false;
	}
	if(ds_list.GetColumn(0, "FCM") == "Y") {
		chk_fcm.Value = true;
	} else {
		chk_fcm.Value = false;
	}
	if(ds_list.GetColumn(0, "KND_YN") == "1") {
		chk_fcm.Enable = true;
	} else {
		chk_fcm.Enable = false;
	}
	if(ds_list.GetColumn(0, "SLA") == "Y") {
		btn_per.Enable = false;
	} else {
		btn_per.Enable = true;
	}
	if(ds_list.GetColumn(0, "PST") == "A5") {
		btn_save.Enable = false;
	} else {
		btn_save.Enable = true;
	}
	btn_del.Enable = true;
	btn_seungin.Enable = false;

	if(gnd == 'D') {
		cb_conkind.Enable = false;
	} else {
		cb_conkind.Enable = true;
	}
	
	if(ds_list.GetColumn(0, "BDGBN") == "1") {
		chk_bdgbn.Value = true;
	} else {
		if (ds_list.GetColumn(0, "GBU") == "3"){
			if (substr(ds_list.GetColumn(0, "HNO"),0,1) == "J" || substr(ds_list.GetColumn(0, "HNO"),0,1) == "G"){
				chk_bdgbn.Value = false;
			} else {
				if (ds_cond.GetColumn(0, "GBN") == "A"){
					chk_bdgbn.Value = false;
				} else {
					chk_bdgbn.Value = true;
				}
			}
		} else {
			chk_bdgbn.Value = false;
		}
	}

	if(ds_list.GetColumn(0, "GBU") == "1") {
		chk_bdgbn.Enable = false;
	} else {
		if (substr(ds_list.GetColumn(0, "HNO"),0,1) == "J" || substr(ds_list.GetColumn(0, "HNO"),0,1) == "G"){
				chk_bdgbn.Enable = false;
		} else {
			if (length(ds_list.GetColumn(0, "PST")) == 0 || ds_list.GetColumn(0, "PST") == "A5") {
				chk_bdgbn.Enable = true;
			} else {
				chk_bdgbn.Enable = false;
			}
		}
	}
	
	grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","AMTT"),"Edit","number");
	if (chk_bdgbn.Value == true){
		grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","AMT"),"Edit","number");								//16
	}
	//===========================공기청정기 추가 20200515 Han.JH==================================
	grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","ACMT"),"Edit","none");
	grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","ACND"),"Edit","none");
	//============================================================================================
	grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","HMT"),"Edit","none");	//hrts 추가 20121113 LHR		//18
	grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","HWR"),"Edit","none");									//20
	grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","DND"),"Edit","none");	//di-pbx종류 추가 20131104 LJH	//22
	grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","DMT"),"Edit","none");	//di-pbx 금액 추가 20121113 LHR	//24

	grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","KND_YN"),"Display","checkbox");	//FM계약여부		//34
	grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","KND_YN"),"Edit","checkbox");							//34
	grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","KND"),"Display","combo");	//FM상품					//35
	grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","KND"),"Edit","combo");								//35
	grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","IYN"),"Edit","checkbox");	//인센티브지급				//36

	grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","LTY"),"Edit","none");	//장기계약연도					//46
	grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","LTS"),"Edit","none");	//장기계약연차					//47

	calc_Amt("A");

	if(ds_list.RowCount() > 0) {
//		cb_congbn.value    = ds_list.GetColumn(0, "GKD");
		cb_bsgbn.value     = ds_list.GetColumn(0, "BGB");
		cb_bhcycle.value   = ds_list.GetColumn(0, "BJG");
		cb_bhday.value     = ds_list.GetColumn(0, "TIS");
		cb_jgcnt.value     = "0" + ds_list.GetColumn(0, "JKH");
		if(ds_list.GetColumn(0, "YYB") == "Y") {
			chk_nightgbn.value = "1";
		} else {
			chk_nightgbn.value = "0";
		}
		cb_pergbn.value    = ds_list.GetColumn(0, "ZER");
		cb_slagbn.value    = ds_list.GetColumn(0, "SLA");
		cb_slarsn.value    = ds_list.GetColumn(0, "SLR");
		cb_cyn.value       = ds_list.GetColumn(0, "CYN");
		cb_ctp.value       = ds_list.GetColumn(0, "CTP");
		cb_etc.value       = ds_list.GetColumn(0, "ETC");
		ed_etcbg.value     = ds_list.GetColumn(0, "ETCBG");//=====종이계약시 비고입력====
		cb_cse.value       = ds_list.GetColumn(0, "CSE");
		ed_remark.value    = ds_list.GetColumn(0, "RMK");
		
		if(ds_list.GetColumn(0, "CFG") == "Y") {
			chk_cfg.value = "1";
		} else {
			chk_cfg.value = "0";
		}
		
		ed_docno.Text = ds_list.GetColumn(0, "DNO");	//전자결재번호
		ed_doc.Text = ds_list.GetColumn(0, "DOC");	//문서관리번호		
		
		//견적을 통해 생성한 계약의 경우 처리 2015.01
		var estno = ds_list.GetColumn(0, "SIR");	//견적번호+차수
		ed_estno.Text = estno;
			
		if(est_flag == true) {
//		if (length(estno)>0) {		
			
			//fn_get_cont_period(); //견적의 계약연차별 상세 가져오기			
			// btn_cont_period.Text = "계약연차별상세" + "(" + ds_detail_pri.RowCount() + ")";
			// btn_cont_period.Visible=true;
			
			//견적을 통한 계약이면서 저장 한 경우
			if(ds_list.GetColumn(0, "PST") >= "A5") {	
				ds_list.FireEvent = false;
				
				for (var i=0; i<ds_list.rowcount ; i++) {
					if(length(ds_list.GetColumn(i, "SEQ"))==0) {
						ds_list.SelectRow(i);
					}
				}

			//	ds_list.DeleteSelected();
				ds_list.FireEvent = true;
			} else {
				fn_make_period(); // 수주 12개월 제한에 따른 계약 연차 생성 20161012
				// 견적 내용 수정 불가하도록 처리 201703029
				grd_list.Editable = false;
			}
			

		} else {
			//ed_estno.Text = "";
			//btn_cont_period.Visible=false; //계약연차별상세 버튼 숨기기
		}
		var sum_trt = 0 ;
		var row_trt = 0 ;
		var sum_sut = 0 ;
		var sum_std = 0 ;
		var sum_pre = 0 ;
		for (var i=0; i<ds_list.rowcount ; i++) {
			if(ds_list.GetColumn(i, "TRT") > 0) {
				row_trt = row_trt + 1;
				sum_trt = sum_trt + ds_list.GetColumn(i, "TRT");
				sum_sut = sum_sut + ds_list.GetColumn(i, "AMTT"); //소계
				sum_std = sum_std + ds_list.GetColumn(i, "STDAMT");
				sum_pre = sum_pre + ds_list.GetColumn(i, "PREAMT");
			}
		}
		med_trt_t.value   = round(sum_trt / row_trt,1) ; // 전체 달성율
		med_trt_tB.value  = round(sum_sut / sum_pre *100 ,1) ; // 전계약 대비  달성율
		med_trt_tS.value  = round(sum_sut / sum_std *100 ,1) ; // 표준  달성율

	}

	cb_bsgbn.Enable = false;
	cb_bhcycle.Enable = false;
	cb_bhday.Enable = false;
	cb_jgcnt.Enable = true;
	chk_nightgbn.Enable = true;
	//cb_pergbn.Enable = true;
	//cb_slagbn.Enable = true;
	ed_remark.Enable = true;
	btn_seungin_cancel.Enable = true;
	
	// if(G_USER_ID == "2017938" || G_USER_ID == "2010984" //최인식 김재순
	 // || G_USER_ID == "2018438" || G_USER_ID == "2021056" //권지예 전현정
	 // || G_USER_ID == "2017750" || G_USER_ID == "2021200" ){ //이주형 이하림
		cb_slagbn.Enable = true;
		if(cb_slagbn.Value == "Y"){
			cb_slarsn.Enable = true;
		} else {
			cb_slarsn.Enable = false;	
		}

	// } else {
		// cb_slagbn.Enable = false;
		// cb_slarsn.Enable = false;
	// }
	
	ed_sla_yn.value = ds_list.GetColumn(0, "SLA");

	// 메시지 처리
	gfn_showMsg("CI00002", ds_list.RowCount()+"");

	fn_get_app_status();	//결재자정보 가져오기

	// 결재 버튼 처리
	// if ((parseInt(ds_list.GetColumn(0,"APSTAT")) < 1 && (ds_list.GetColumn(0,"PST") == "A5")) || 
		// (ds_list.GetColumn(0,"APSTAT") == "3" && ds_list.GetColumn(0,"REDPT1") == G_DPT1)) 
	if ((parseInt(ds_list.GetColumn(0,"APSTAT")) < 1 && (ds_list.GetColumn(0,"PST") == "A5")) || 
		(ds_list.GetColumn(0,"APSTAT") == "3" && ds_list.GetColumn(0,"REDPT1") == vDPT)) 
	
	{
		div_btn.btn_draft.Enable = true; 
		div_btn.btn_sendback.Enable = false;
		div_btn.btn_decide.Enable = false;
	// // 판매관리팀 최종원 이상윤 임경진 추가(호기정보가 주차인 경우) --20191023,2999999(김종남)
	} 
	// else if ((parseInt(ds_list.GetColumn(0,"APSTAT")) < 1 && (ds_list.GetColumn(0,"PST") == "A5")) || 
	//	 (ds_list.GetColumn(0,"APSTAT") == "3" && ds_list.GetColumn(0,"REDPT1") != G_DPT1 
	//	                                       && ((G_USER_ID == "2027089" || G_USER_ID == "2020521") 
	//	                                       && substr(ds_list.GetColumn(0, "HNO"),0,1) == "J" 
	//	                                       && ds_list.GetColumn(0,"REDPT1") == "EK" ))) {
	else if ((parseInt(ds_list.GetColumn(0,"APSTAT")) < 1 && (ds_list.GetColumn(0,"PST") == "A5")) || 
		(ds_list.GetColumn(0,"APSTAT") == "3" && ds_list.GetColumn(0,"REDPT1") != vDPT 
		                                      && ((G_USER_ID == "2027089" || G_USER_ID == "2020521" || G_USER_ID == "2028719") 
		                                      && substr(ds_list.GetColumn(0, "HNO"),0,1) == "J" 
		                                      && ds_list.GetColumn(0,"REDPT1") == "EK" ))) {
		div_btn.btn_draft.Enable = true; 
		div_btn.btn_sendback.Enable = false;
		div_btn.btn_decide.Enable = false;
	} else if((ds_list.GetColumn(0,"APSTAT") > '0' && ds_list.GetColumn(0,"APSTAT") != '3' && ds_list.GetColumn(0,"APSTAT") < '6') 
			   && G_USER_ID == substr(ds_decide.GetColumn(0, "APNUM"),1) ) {
		div_btn.btn_draft.Enable   = false;	
		div_btn.btn_sendback.Enable = true;	
		div_btn.btn_decide.Enable = true;
	} else {
		div_btn.btn_draft.Enable = false;
		div_btn.btn_decide.Enable = false;
		div_btn.btn_sendback.Enable = false;
	}	
/*
	//업무처리 버튼을 비활성화 한다.
	if (ds_list.GetColumn(0,"APSTAT")>=1 || ds_list.GetColumn(0,"PST") == "A6") {
		btn_gd_query.Enable = false;
		//btn_auto.Enable = false;
		btn_copy.Enable = false;
		btn_save.Enable = false;
		btn_del.Enable = false;
		//btn_seungin.Enable = false;
		//btn_can.Enable = false;
		//btn_set.Enable = false;
		
	//Cell 번호 수정 20121030 LHR
		grd_list.SetCellProp("body",11,"Edit","none");
		grd_list.SetCellProp("body",12,"Edit","none");
		grd_list.SetCellProp("body",13,"Edit","none");
		grd_list.SetCellProp("body",15,"Edit","none");
		grd_list.SetCellProp("body",16,"Edit","none");
		grd_list.SetCellProp("body",17,"Edit","none");	//hrts 추가 20121113 LHR
	//	grd_list.SetCellProp("body",18,"Edit","none");	//hrts 점검주기
		grd_list.SetCellProp("body",19,"Edit","none");	//hrts 회선종류
		grd_list.SetCellProp("body",20,"Edit","none");
		grd_list.SetCellProp("body",21,"Edit","none");	//di-pbx종류 추가 20131104 LJH
		grd_list.SetCellProp("body",23,"Edit","none");	//di-pbx금액  추가 20121113 LHR
		grd_list.SetCellProp("body",31,"Edit","none");	//비율제계약여부
		grd_list.SetCellProp("body",32,"Edit","none");	//지급율
		grd_list.SetCellProp("body",33,"Edit","none");	//FM계약여부
		grd_list.SetCellProp("body",34,"Edit","none");	//FM상품
		grd_list.SetCellProp("body",35,"Edit","none");	//인센티브지급
	
		grd_list.SetCellProp("body",45,"Edit","none");	//장기계약연도
		grd_list.SetCellProp("body",46,"Edit","none");	//장기계약연차		
	}
	
	if(ds_list.GetColumn(0,"APSTAT")=="2" || ds_list.GetColumn(0,"APSTAT")=="5") {
		btn_del.Enable = true;
	}	
*/	
	//시행율가져오기
	fn_getRat();
	
	
	if(div_btn.btn_draft.Enable == false ) {
		btn_pdchang.Enable = true;
	} else {
		btn_pdchang.Enable = false;
	}
	
	//협력사정보가 자회사인경우, 그리고, 승인된 계약을 조회한 경우에만 '수주확정'버튼 활성화
	vVkbur = gfn_getBsu(ds_list.GetColumn(0, "BSU"), "VKBUR");
	vVkgrp = gfn_getBsu(ds_list.GetColumn(0, "BSU"), "VKGRP");

	btn_vbeln.Visible = false;
	btn_vbeln.Enable  = false;
	if (vVkbur == "H100"){
		if (G_SAP_USER_VBCD == "H100" || vVbeln_auth == "1")
			if (length(trim(gno)) > 0 && gno != 'X'){
				if (length(vbeln) == 0)
					btn_vbeln.Visible = true;
					btn_vbeln.Enable  = true;
				}
			}
//		}
//	}
	

	if ( length(cb_ctp.value) != 0 and length(cb_etc.value) == 0 )
	{	
		cb_etc.Enable = true;
	}	
	
	//=====종이계약시 비고입력====
	if ( cb_etc.value == "1" && length(trim(ed_etcbg.value)) == 0  )
	{	
		ed_etcbg.Enable = true;
	}	
	
	
}

function fn_afterQuery2(errCode, errMsg) {
	chk_query = "auto_query";
	cb_conkind.value = gnd;
	btn_copy.Enable = false;
	btn_save.Enable = true;
	btn_del.Enable = false;
	btn_seungin.Enable = false;
	cb_grp.Enable = false;
	cb_grp.Index = 0;
//	cb_conkind.Enable = true;

	med_supamt.value = 0;
	med_supvat.value = 0;
	med_suptot.value = 0;
//Cell 번호 수정 20121030 LHR
	grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","USD"),"Edit","none");										//12
	grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","UGS"),"Edit","none");										//13
	grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","UMR"),"Edit","none");										//14
	grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","AMT"),"Edit","none");										//16
	grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","AMTT"),"Edit","none");									
	grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","HYN"),"Edit","none");										//17
	grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","HMT"),"Edit","none");	//hrts 추가 20121113 LHR			//18
	grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","HWR"),"Edit","none");	//hrts 회선종류						//2
	grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","DYN"),"Edit","none");										//21
	grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","DND"),"Edit","none");	//di-pbx종류 추가 20131104 LJH		//22
	grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","DMT"),"Edit","none");	//di-pbx금액  추가 20121113 LHR		//24
	grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","RGB"),"Edit","none");	//비율제계약여부					//32
	grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","RTO"),"Edit","none");	//지급율							//33
	grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","KND_YN"),"Edit","none");	//FM계약여부					//34
	grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","KND"),"Edit","none");	//FM상품							//35
	grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","IYN"),"Edit","none");	//인센티브지급						//36

	grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","LTY"),"Edit","none");	//장기계약연도						//46
	grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","LTS"),"Edit","none");	//장기계약연차						//47
	
	//===========================공기청정기 추가 20200515 Han.JH==================================
	grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","ACYN"),"Edit","none");
	grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","ACMT"),"Edit","none");
	grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","ACND"),"Edit","none");
	//============================================================================================

	calc_Amt("A");

	if(ds_list.GetColumn(0, "FCM") == "Y") {
		chk_fcm.Value = true;
	} else {
		chk_fcm.Value = false;
	}
	if(ds_list.GetColumn(0, "KND_YN") == "1") {
		chk_fcm.Enable = true;
	} else {
		chk_fcm.Enable = false;
	}
	if(ds_list.RowCount() > 0) {
//		cb_congbn.value    = ds_list.GetColumn(0, "GKD");
		cb_bsgbn.value     = ds_list.GetColumn(0, "BGB");
		cb_bhcycle.value   = ds_list.GetColumn(0, "BJG");
		cb_bhday.value     = ds_list.GetColumn(0, "TIS");
		cb_jgcnt.value     = "0" + ds_list.GetColumn(0, "JKH");
		if(ds_list.GetColumn(0, "YYB") == "Y") {
			chk_nightgbn.value = "1";
		} else {
			chk_nightgbn.value = "0";
		}
		cb_pergbn.value    = ds_list.GetColumn(0, "ZER");
		cb_slagbn.value    = ds_list.GetColumn(0, "SLA");
		cb_slarsn.value    = ds_list.GetColumn(0, "SLR");			
		ed_remark.value    = ds_list.GetColumn(0, "RMK");
		
		if(ds_list.GetColumn(0, "CFG") == "Y") {
			chk_cfg.value = "1";
		} else {
			chk_cfg.value = "0";
		}
	}

	for(var i=0; i<ds_list.RowCount(); i++) {
		var k_fsd = ds_list.GetColumn(i, "FSD");

		if(length(k_fsd) > 0) {	//실패승인일이 존재하면
			fsd_flag = true;
		}
	}
	
	if(ds_list.GetColumn(0, "SLA") == "Y") {
		btn_per.Enable = false;
	} else {
		btn_per.Enable = true;
	}
	
	cb_conkind.Enable = false;

	if(fsd_flag == true) { //실패승인일이 있을때
	} else {
	}

	cb_bsgbn.Enable = false;
	cb_bhcycle.Enable = false;
	cb_bhday.Enable = false;
	cb_jgcnt.Enable = false;
	chk_nightgbn.Enable = false;
	cb_pergbn.Enable = false;
	cb_slagbn.Enable = false;
	cb_slarsn.Enable = false;
	ed_remark.Enable = false;
	btn_seungin_cancel.Enable = false;
	fsd_flag = false;

	div_btn.btn_draft.Enable = false;
	div_btn.btn_decide.Enable = false;
	div_btn.btn_sendback.Enable = false;
	
	// 자동연장 시 견적번호 지우기 201511 이하림
	ed_estno.Text = "";
	
	// 수주 최대 12개월 입력 제한 201610 이하림 
	P_UMS = 0 ;
	
	var org_ums = parseInt(ds_chkUms.GetColumn(0, "CHK_UMS")) ;   // 자동연장 대상 유상 개월 수 
	var min_ums = parseInt(ds_chkUms.GetColumn(0, "MINUS_UMS")) ; // 전년도 수주 중도해지 차감 개월 수	

	//======================================================================================================================================
	// 자동연장 시 자회사이면 수주보전 개월수 적용하지 않음. 무조건 12개월씩 연장. 20200612 Han JH
	if (bf_vVkbur != "H100" && vVkbur == "H100"){ // 이전계약이 모회사이고 현계약이 자회사인 경우 수주보전 하지 않음
	// 자회사 수주보전 안함
	//if (vVkbur == "H100") { // 이관(ZCST157) 데이터의 정합성 문제로 이관전 보수협력사의 값이 부정확 할 시 사용.
		P_UMS = 12;
	} else {
		// 전년도 수주 중도해지 차감 기간 보전  201710 이하림
		//org_ums : 금년도 신규 수주 개월수
		//min_ums : 전년도 수주 금년 중도해지 차감 개월수
		if(org_ums + min_ums < 0) {
			P_UMS = Abs( org_ums + min_ums ) ;
		} else if (org_ums + min_ums = 0) {
			P_UMS = 12 ;
		} else {
			P_UMS = 12 - org_ums ;
		}		
	}
	//======================================================================================================================================
	if (vAutoBdgbnFlag == "1"){
		P_UMS = 1;
	}
	//alert("P_UMS = " + P_UMS);
	
	// if(P_UMS < 12 ) {
		// alert("자동연장 가능 개월 수 " + P_UMS + " 개월 입니다.");	
	// }
	
	// 분담이행정보 처리하기
	chk_bdgbn.value = ds_list.GetColumn(0, "BDGBN");
	
	if (chk_auto_first = 0 )
	{	
		if (ds_chkUms.GetColumn(0, "TGB") == "1" || substr(ds_list.GetColumn(0, "HNO"),0,1) == "J" || substr(ds_list.GetColumn(0, "HNO"),0,1) == "G"){				//직영 or 주차
			chk_bdgbn.Enable = false;
			if (chk_bdgbn.value == "1"){
				chk_bdgbn.value = "";
				chk_bdgbn_OnClick();
			}
		} else {
			if (vAutoBdgbnFlag == "1"){
				chk_bdgbn.Enable = false;
				if (chk_bdgbn.value == "1"){
					chk_bdgbn.value = "";
					chk_bdgbn_OnClick();
				}
			} else {
				if (chk_bdgbn.value != "1"){
					chk_bdgbn.Enable = true;
					chk_bdgbn.value = "1";
					chk_bdgbn_OnClick();				
				}
			}
		}
	}
	// 메시지 처리
	gfn_showMsg("CI00002", ds_list.RowCount()+"");
	
	//시행율가져오기
	fn_getRat();
	
}
var P_UMS = 0 ; // 자동연장 시 체크 , 최대 입력 가능 개월 수 
function fn_afterQuery3(errCode, errMsg) {
	chk_query = "seungin_query";
	cb_conkind.value = gnd;
	btn_copy.Enable = false;
	btn_save.Enable = false;
	btn_del.Enable = false;
	btn_seungin.Enable = true;
	cb_conkind.Enable = false;
	btn_seungin_cancel.Enable = false;
	cb_grp.Enable = true;
//Cell 번호 수정 20121030 LHR
	grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","USD"),"Edit","none");										//12
	grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","UGS"),"Edit","none");										//13
	grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","UMR"),"Edit","none");										//14
	grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","AMT"),"Edit","none");										//16
	grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","HYN"),"Edit","none");										//17
	grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","HMT"),"Edit","none");	//hrts 추가 20121113 LHR			//18
	grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","HEP"),"Edit","none");	//hrts 점검주기						//19
	grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","HWR"),"Edit","none");	//hrts 회선종류						//20
	grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","DYN"),"Edit","none");										//21
	grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","DND"),"Edit","none");	//di-pbx종류 추가 20131104 LJH		//22
	grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","DMT"),"Edit","none");	//di-pbx 추가 20121113 LHR			//24
	grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","RGB"),"Edit","none");	//비율제계약여부					//32
	grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","RTO"),"Edit","none");	//지급율							//33
	grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","KND_YN"),"Edit","none");	//FM계약여부					//34
	grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","KND"),"Edit","none");	//FM상품							//35
	grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","IYN"),"Edit","none");	//인센티브지급						//36

	grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","LTY"),"Edit","none");	//장기계약연도						//46
	grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","LTS"),"Edit","none");	//장기계약연차						//47
	
	//===========================공기청정기 추가 20200515 Han.JH============================
	grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","ACYN"),"Edit","none");
	grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","ACMT"),"Edit","none");
	grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","ACND"),"Edit","none");
	//======================================================================================

	calc_Amt("A");
	fn_searchGrp();

	if(ds_list.GetColumn(0, "FCM") == "Y") {
		chk_fcm.Value = true;
	} else {
		chk_fcm.Value = false;
	}
	if(ds_list.GetColumn(0, "KND_YN") == "1") {
		chk_fcm.Enable = true;
	} else {
		chk_fcm.Enable = false;
	}
	if(ds_list.RowCount() > 0) {
//		cb_congbn.value    = ds_list.GetColumn(0, "GKD");
		cb_bsgbn.value     = ds_list.GetColumn(0, "BGB");
		cb_bhcycle.value   = ds_list.GetColumn(0, "BJG");
		cb_bhday.value     = ds_list.GetColumn(0, "TIS");
		cb_jgcnt.value     = "0" + ds_list.GetColumn(0, "JKH");
		if(ds_list.GetColumn(0, "YYB") == "Y") {
			chk_nightgbn.value = "1";
		} else {
			chk_nightgbn.value = "0";
		}
		cb_pergbn.value    = ds_list.GetColumn(0, "ZER");
		cb_slagbn.value    = ds_list.GetColumn(0, "SLA");
		cb_slarsn.value    = ds_list.GetColumn(0, "SLR");		
		ed_remark.value    = ds_list.GetColumn(0, "RMK");
		
		if(ds_list.GetColumn(0, "CFG") == "Y") {
			chk_cfg.value = "1";
		} else {
			chk_cfg.value = "0";
		}
	}

	if(ds_list.GetColumn(0, "SLA") == "Y") {
		btn_per.Enable = false;
	} else {
		btn_per.Enable = true;
	}

	cb_bsgbn.Enable = false;
	cb_bhcycle.Enable = false;
	cb_bhday.Enable = false;
	cb_jgcnt.Enable = false;
	chk_nightgbn.Enable = false;
	cb_pergbn.Enable = false;
	cb_slagbn.Enable = false;
	cb_slarsn.Enable = false;
	ed_remark.Enable = false;

	chk_fst = 0;

	// 메시지 처리
	gfn_showMsg("CI00002", ds_list.RowCount()+"");
}

/********************************************************************************
* 기      능   : 저장 Callback
********************************************************************************/
function fn_afterSave(errCode, errMsg) {
	if ( errCode!= 0 ) {
		for(var i=0; i<ds_list.RowCount(); i++) {
			if(ds_list.GetColumn(i, "CHK") == true) {
				ds_list.SetColumn(i, "FLAG", ds_list.GetOrgColumn(i, "FLAG"));
				ds_list.SetColumn(i, "PST", ds_list.GetOrgColumn(i, "PST"));
			}
		}
		gfn_showMsg("CE00001");
		ds_list.Reset();
	} else {
		//  시행율 저장 ( ZCST128 )
		fn_saveCost();

		//견적을 통해 저장한 경우 년차별 계약을 추가로 저장 
		// 연차별 계약정보 저장 ( ZCST126 ) 및 연차별 시행율 저장 ( ZCST128 )
		if ( length(ed_estno.Text) > 0 ) {
			fn_saveFromEstNo();	
		}
						
		trace("#############################");
		gfn_showMsg("CI00003");
		chk_first++;
//		fn_chkFirst(); 
		if(chk_first > 0) {
			gnd = cb_conkind.value;
//			usd = '';
//			uhj = '';
		}

		if(chk_query == "auto_query") {
//			usd = tmp_usd;
//			uhj = tmp_uhj;
			btn_save.Enable = false;
			chk_auto_first++;
		}

		if(chk_query == "query") {
			chk_save = true;	//저장 후 조회하는 경우 구분값
			fn_query();
			
		} else if(chk_query == "auto_query") {
			fn_query2();
		}
		
		query_flag = true;
		page_flag = true;
		fsd_flag = false;
		

	}
	
	doubleSaveChk = false; // 중복체크변수 After로직에서 해제 처리. 20210924 Han JH
}

//fn_afterSave3 backup 12050223
function fn_afterSave3_bak(errCode, errMsg) {
	if(errCode != 0) {
		for(var i=0; i<ds_list.RowCount(); i++) {
			if(ds_list.GetColumn(i, "CHK") == true) {
				ds_list.SetColumn(i, "FLAG", ds_list.GetOrgColumn(i, "FLAG"));
				ds_list.SetColumn(i, "PST", ds_list.GetOrgColumn(i, "PST"));
			}
		}

		gfn_showMsg("CE00001");
		ds_list.Reset();
	} else {

		gfn_showMsg("CI00003");
		fn_query3();
		query_flag = true;
	}
}

function fn_afterDelete(errCode, errMsg) {
	if(errCode != 0) {
		for(var i=0; i<ds_list.RowCount(); i++) {
			if(ds_list.GetColumn(i, "CHK") == true) {
				ds_list.SetColumn(i, "FLAG", ds_list.GetOrgColumn(i, "FLAG"));
			}
		}

		gfn_showMsg("CE00001");
		ds_list.Reset();
	} else {
		gfn_showMsg("CI00003");
		fn_query();
		query_flag = true;
	}
}

function fn_afterCancel(errCode, errMsg) {
	if(errCode != 0) {
		for(var i=0; i<ds_list.RowCount(); i++) {
			if(ds_list.GetColumn(i, "CHK") == true) {
				ds_list.SetColumn(i, "FLAG", ds_list.GetOrgColumn(i, "FLAG"));
				ds_list.SetColumn(i, "UMR", ds_list.GetOrgColumn(i, "UMR"));
				ds_list.SetColumn(i, "UHJ", ds_list.GetOrgColumn(i, "UHJ"));
			}
		}

		gfn_showMsg("CE00001");
		ds_list.Reset();
	} else {
		gfn_showMsg("CI00003");
		fn_query();
		query_flag = true;
	}
}

function fn_afterSeunginCancel(errCode, errMsg) {
	if(errCode != 0) {
		gfn_showMsg("CE00001");
		ds_list.Reset();
	} else {
		gfn_showMsg("CI00005");
		fn_query();
		query_flag = true;
	}
}

//=========================================================================================
// [ PART 5 ]
// Detail Process Event 정의 ( User Define function )
// 사용자 정의 함수는 ufn_xxxx() 형태로 작성
//=========================================================================================
/********************************************************************************
* 기      능   : 사용자 정의 함수
********************************************************************************/
function ufn_userfunction() {

}

//=========================================================================================
// [ PART 6 ]
// component Event 정의 : 각 Component 별 이벤트
//=========================================================================================
/********************************************************************************
* 기      능   : 그리드 헤더 클릭시 정렬 처리
********************************************************************************/
function grd_list_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
{
	var vColId = grd_list.GetCellProp("BODY",nCell, "colid");
	if (vColID == "CHK") {					//if(nCell == 1) {
		// 전체 선택
		gfn_selectAllGrid2(obj,1,1,true);
		//calc_Amt();
	} else {
		// 그리드 정렬 처리
		gfn_sortGrid(obj,nCell);
	}
}

/********************************************************************************
* 기      능   : 데이터셋 값 변경 시 - Flag 처리
********************************************************************************/
function ds_list_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{
//	obj.FireEvent = false;
	if(strColumnID == "CHK") {
		calc_Amt("B");
	} else if(strColumnID == "AMTT") {
		vBdgRateA = gfn_bdgbnRate(ds_list.GetColumn(nRow, "BDGBN"), 
								  ds_list.GetColumn(nRow, "KND_YN"), 
								  ds_list.GetColumn(nRow, "ABG"), 
								  "1");
		ds_list.SetColumn(nRow, "AMT", ceil(toNumber(varNewValue) * vBdgRateA));
		calc_Amt("B");
	} else if(strColumnID == "AMT") {
		if (ds_list.GetColumn(nRow, "BDGBN") == "1"){
			if (toNumber(ds_list.GetColumn(nRow, "AMTT")) != 0){
				ds_list.SetColumn(nRow, "AMBT", toNumber(ds_list.GetColumn(nRow, "AMTT")) - toNumber(varNewValue));
			}
		} else {
			ds_list.SetColumn(nRow, "AMTT", toNumber(varNewValue));
		}
		ds_list.SetColumn(nRow, "AMBT", toNumber(ds_list.GetColumn(nRow, "AMTT")) - toNumber(varNewValue));
		calc_Amt("B");
	} else if(strColumnID == "HMT") {
		calc_Amt("B");
	} else if(strColumnID == "DMT") {
		calc_Amt("B");
	//===========================공기청정기 추가 20200515 Han.JH============================
	} else if(strColumnID == "ACMT") { 
		calc_Amt("B");
	} else if(strColumnID == "ACYN") {
		if(ds_list.GetColumn(nRow, "ACYN") == "1") {
			grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","ACMT"),"Edit","number");
			grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","ACND"),"Edit","combo");
		} else if(ds_list.GetColumn(nRow, "ACYN") == "0") {
			ds_list.SetColumn(nRow, "ACND", "");
			ds_list.SetColumn(nRow, "ACMT", 0);
			grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","ACMT"),"Edit","none");
		}	
	//======================================================================================
	} else if(strColumnID == "HYN") {
		if(ds_list.GetColumn(nRow, "HYN") == "1") {
			grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","HMT"),"Edit","number");									//18
			grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","HEP"),"Edit","combo");										//19
			grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","HWR"),"Edit","combo");										//20
		} else {
	//		grd_list.SetCellProp("body",17,"Edit","none");
		}
	} else if(strColumnID == "DYN") {
		if(ds_list.GetColumn(nRow, "DYN") == "1") {
			grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","DND"),"Edit","combo");										//22
			grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","DCE"),"Edit","number");									//24
			ds_list.SetColumn(nRow, "DCE", "0");
			//ds_list.SetColumn(nRow, "DND", "A");
		} else if(ds_list.GetColumn(nRow, "DYN") == "0") {
			ds_list.SetColumn(nRow, "DND", "");
			ds_list.SetColumn(nRow, "DMT", 0);
			grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","DMT"),"Edit","none");										//24
		}		
	} else if(strColumnID == "DCE") { // DI-PBX 통신료 계약 여부 20140715 harim.lee
		if(ds_list.GetColumn(nRow, "DCE") == "1") {
			grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","DMT"),"Edit","number");									//24
			ds_list.SetColumn(nRow, "DYN", "0");
			ds_list.SetColumn(nRow, "DMT", 0);
		} else{
			ds_list.SetColumn(nRow, "DMT", 0);
			grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","DMT"),"Edit","none");										//24
		}		
	} else if(strColumnID == "RGB") {
		obj.FireEvent = false;
		if(ds_list.GetColumn(nRow, "RGB") == "1") {
			ds_list.SetColumn(nRow, "RTO", 0);
			ds_list.SetColumn(nRow, "KND_YN", "0");
			ds_list.SetColumn(nRow, "KND", "");
			//Cell 번호 수정 20121030 LHR			
//			grd_list.SetCellProp("body",23,"Display","number");
			grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","RTO"),"Edit","number");	//지급율						//33
//			grd_list.SetCellProp("body",24,"Display","null");
//			grd_list.SetCellProp("body",24,"Edit","none");
//			grd_list.SetCellProp("body",25,"Display","null");
//			grd_list.SetCellProp("body",25,"Edit","none");
			grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","IYN"),"Display","checkbox");	//인센티브지급				//36
			grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","IYN"),"Edit","checkbox");									//36

			// if(substr(ds_list.GetColumn(nRow, "HNO"),0,1) == "J") {
				// ds_list.SetColumn(nRow, "RTO", 57);
			// } else if(substr(ds_list.GetColumn(nRow, "HNO"),0,1) == "G") {
				// ds_list.SetColumn(nRow, "RTO", 0);
			// } else if(substr(ds_list.GetColumn(nRow, "HNO"),0,1) == "S") {
				// ds_list.SetColumn(nRow, "RTO", 64.2);
			// } else if(substr(ds_list.GetColumn(nRow, "HNO"),0,1) == "W") {
				// ds_list.SetColumn(nRow, "RTO", 64.2);
			// }
		} else if(ds_list.GetColumn(nRow, "RGB") == "0") {
			if(ds_list.GetColumn(nRow, "KND_YN") == "0") {
				ds_list.SetColumn(nRow, "RTO", 0);
			}
//			grd_list.SetCellProp("body",23,"Display","null");
			grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","RTO"),"Edit","none");	//지급율							//33

			if(chk_query == "query") {
				grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","KND_YN"),"Display","checkbox");	//FM계약여부			//34
				grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","KND_YN"),"Edit","checkbox");								//34
//				grd_list.SetCellProp("body",25,"Display","combo");
//				grd_list.SetCellProp("body",25,"Edit","combo");
			} else if(chk_query == "auto_query") {
				grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","KND_YN"),"Display","null");								//34
				grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","KND_YN"),"Edit","none");									//34
//				grd_list.SetCellProp("body",25,"Display","combo");
//				grd_list.SetCellProp("body",25,"Edit","combo");
			}
		}
		obj.FireEvent = true;
	} else if(strColumnID == "KND_YN") { // FM 계약의 경우
		obj.FireEvent = false;
		if(ds_list.GetColumn(nRow, "KND_YN") == "1") {
			chk_fcm.Enable = true;   // FM 계약의 경우 정기검사비용 미포함 여부 항목 활성화 20140628
			ds_list.SetColumn(nRow, "RGB", "0");
			ds_list.SetColumn(nRow, "RTO", 53);
//			grd_list.SetCellProp("body",23,"Display","null");
			grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","KND_YN"),"Edit","none");	//지급율							//34
			grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","KND"),"Display","combo");	//FM상품						//35
			grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","KND"),"Edit","combo");										//35
			ds_list.SetColumn(nRow, "KND", "A");
//			grd_list.SetCellProp("body",28,"Display","null");
//			grd_list.SetCellProp("body",26,"Edit","none");
		} else if(ds_list.GetColumn(nRow, "KND_YN") == "0") {
			chk_fcm.Enable = false;   // FM 계약이 아닌 경우 정기검사비용 미포함 여부 항목 비활성화 20140628
			chk_fcm.Value = 0;   
			ds_list.SetColumn(nRow, "KND", "");
			if(ds_list.GetColumn(nRow, "RGB") == "0") {
				//ds_list.SetColumn(nRow, "RGB", ds_list.GetOrgColumn(nRow, "RGB"));
				if(ds_list.GetColumn(nRow, "RTO") == 53) {
					ds_list.SetColumn(nRow, "RTO", 0);
				} else {
					ds_list.SetColumn(nRow, "RTO", 0);
					//ds_list.SetColumn(nRow, "RTO", ds_list.GetOrgColumn(nRow, "RTO"));
				}
			}
//			grd_list.SetCellProp("body",25,"Display","null");
//			grd_list.SetCellProp("body",25,"Edit","none");
//			grd_list.SetCellProp("body",26,"Display","checkbox");
//			grd_list.SetCellProp("body",26,"Edit","checkbox");
		}
		obj.FireEvent = true;
	} else if(strColumnID == "LTC") {
		obj.FireEvent = false;
		if(ds_list.GetColumn(nRow, "LTC") == "1") {
			grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","LTY"),"Edit","combo");	//장기계약연도						//46
			grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","LTS"),"Edit","combo");	//장기계약연차						//47

		} else if(ds_list.GetColumn(nRow, "LTC") == "0") {
			grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","LTY"),"Edit","none");	//장기계약연도						//46
			grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","LTS"),"Edit","none");	//장기계약연차						//47
			ds_list.SetColumn(nRow, "LTY", "");
			ds_list.SetColumn(nRow, "LTS", "");
		}
		obj.FireEvent = true;
	}
//	obj.FireEvent = true;
}

/********************************************************************************
* 기      능   : 체크박스 확인
********************************************************************************/


// 달력 처리 부분
/********************************************************************************
* 기      능   : 그리드에서 날짜 입력시
********************************************************************************/
function grd_list_OnExpandEdit(obj,nRow,nCell,strVal,nPivotIndex)
{
	var rect = obj.GetCellRect(nRow, ncell);

//	var nX = ClientToScreenX(obj,rect[0]);
//	var nY = ClientToScreenY(obj,rect[1] + 20);

//	PopupDiv0.TrackPopup(nX,nY);
//	PopupDiv0.cal_temp.Visible = true;

	if(chk_query == "query") {
		/*
		cal_temp.top = rect[1] + 295;
		cal_temp.Left = rect[0] + 10;
		cal_temp.Visible = true;
		*/

		var nX = ClientToScreenX(obj,rect[0]);
		var nY = ClientToScreenY(obj,rect[1] + 20);

		PopupDiv0.TrackPopup(nX,nY);
//		PopupDiv0.cal_temp.Visible = true;

		var vColId = grd_list.GetCellProp("body",nCell,"ColId");
		if (vColId == "USD" ){											//if(nCell == 12) {
			PopupDiv0.cal_temp.value = ds_list.getColumn(nRow, "USD");
		} else if (vColId == "UGS" ){									//if(nCell == 13) {
			PopupDiv0.cal_temp.value = ds_list.getColumn(nRow, "UGS");
		} else if (vColId == "UMR" ){									//iif(nCell == 14) {
			PopupDiv0.cal_temp.value = ds_list.getColumn(nRow, "UMR");
		} else if (vColId == "RGS" ){									//iif(nCell == 48) {
			PopupDiv0.cal_temp.value = ds_list.getColumn(nRow, "RGS");
		} else if (vColId == "RMR" ){									//iif(nCell == 49) {
			PopupDiv0.cal_temp.value = ds_list.getColumn(nRow, "RMR");
		}
	}

	PopupDiv0.cal_temp.SetFocus();
}
/********************************************************************************
* 기      능   : 달력에서 일자 선택했을 경우
********************************************************************************/
function PopupDiv0_cal_temp_OnDayClick(obj,strText)
{
	gfn_clearMsgBar();
/*
	if(grd_list.GetClickedCell() == 11) {
	//계약개시일 - 유상개시일 체크
		var flag_ugs = false;
		var str_usd = ds_list.GetColumn(ds_list.row, "USD");
		var str_usd_yymm = substr(ds_list.GetColumn(ds_list.row, "USD"),0,6);
		var str_usd_mm = substr(ds_list.GetColumn(ds_list.row, "USD"),4,2);
		var str_usd_day = substr(ds_list.GetColumn(ds_list.row, "USD"),6,2);
		var str_ugs = strText;
		var str_ugs_yymm = substr(str_ugs,0,6);
		var str_ugs_mm = substr(str_ugs,4,2);
		var str_ugs_day = substr(str_ugs,6,2);
		var str_ugs_lastday = gfn_getLastDayByStr(substr(str_ugs,0,6));

		if(parseInt(str_usd <= str_ugs)) {
			if(parseInt(str_usd_day) == parseInt(str_ugs_day)) {
				flag_ugs = true;
			} else {
				if(str_usd_mm < str_ugs_mm && str_usd_day >= 28) {
					if(parseInt(str_ugs_day) == parseInt(str_ugs_lastday)) {
						flag_ugs = true;
					} else {
						flag_ugs = false;
					}
				} else {
					flag_ugs = false;
				}

				if(str_usd_day < str_ugs_day) {
					flag_ugs = false;
				}
			}
		} else {
			flag_ugs = false;
		}

		if(flag_ugs) {
			ds_list.SetColumn(ds_list.row, "USD", strText);
		} else {
			var arr = [st_usd.value];
			gfn_showMsg("CW00022", arr);
			PopupDiv0.ClosePopup();
//			PopupDiv0.cal_temp.Visible = false;
			return;
		}
	
//		ds_list.SetColumn(ds_list.row, "USD", strText);
	} else if(grd_list.GetClickedCell() == 12) {
		if(length(ds_list.GetColumn(ds_list.row, "USD")) == 0) {
			var arr = [st_usd.value];
			gfn_showMsg("CW00022", arr);
			PopupDiv0.ClosePopup();
//			PopupDiv0.cal_temp.Visible = false;
			return;
		}

		var flag_ugs = false;
		var str_usd = ds_list.GetColumn(ds_list.row, "USD");
		var str_usd_yymm = substr(ds_list.GetColumn(ds_list.row, "USD"),0,6);
		var str_usd_mm = substr(ds_list.GetColumn(ds_list.row, "USD"),4,2);
		var str_usd_day = substr(ds_list.GetColumn(ds_list.row, "USD"),6,2);
		var str_ugs = strText;
		var str_ugs_yymm = substr(str_ugs,0,6);
		var str_ugs_mm = substr(str_ugs,4,2);
		var str_ugs_day = substr(str_ugs,6,2);
		var str_ugs_lastday = gfn_getLastDayByStr(substr(str_ugs,0,6));

		if(parseInt(str_usd <= str_ugs)) {
			if(parseInt(str_usd_day) == parseInt(str_ugs_day)) {
				flag_ugs = true;
			} else {
				if(str_usd_mm < str_ugs_mm && str_usd_day >= 28) {
					if(parseInt(str_ugs_day) == parseInt(str_ugs_lastday)) {
						flag_ugs = true;
					} else {
						flag_ugs = false;
					}
				} else {
					flag_ugs = false;
				}

				if(str_usd_day < str_ugs_day) {
					flag_ugs = false;
				}
			}
		} else {
			flag_ugs = false;
		}

		if(flag_ugs) {
			ds_list.SetColumn(ds_list.row, "UGS", str_ugs);
		} else {
			var arr = [st_ugs.value];
			gfn_showMsg("CW00022", arr);
			PopupDiv0.ClosePopup();
//			PopupDiv0.cal_temp.Visible = false;
			return;
		}
	} else if(grd_list.GetClickedCell() == 13) {
		if(length(ds_list.GetColumn(ds_list.row, "USD")) == 0) {
			var arr = [st_usd.value];
			gfn_showMsg("CW00022", arr);
			PopupDiv0.ClosePopup();
//			PopupDiv0.cal_temp.Visible = false;
			return;
		}

		var flag_umr = false;
		var str_usd = ds_list.GetColumn(ds_list.row, "USD");
		var str_usd_yymm = substr(ds_list.GetColumn(ds_list.row, "USD"),0,6);
		var str_usd_mm = substr(ds_list.GetColumn(ds_list.row, "USD"),4,2);
		var str_usd_day = substr(ds_list.GetColumn(ds_list.row, "USD"),6,2);
		var str_umr = strText;
		var str_umr_after = gfn_getAfterDate(str_umr, 1);
		var str_umr_yymm = substr(str_umr_after,0,6);
		var str_umr_mm = substr(str_umr_after,4,2);
		var str_umr_day = substr(str_umr_after,6,2);
		var str_umr_lastday = gfn_getLastDayByStr(substr(str_umr,0,6));

		if(parseInt(str_usd <= str_umr)) {
			if(parseInt(str_usd_day) == parseInt(str_umr_day)) {
				flag_umr = true;
			} else {
				if(str_usd_mm < str_umr_mm && str_usd_day >= 28) {
					if(parseInt(str_umr_day) == parseInt(str_umr_lastday)) {
						if(parseInt(str_usd_day) == parseInt(substr(str_umr,6,2))) {
							flag_umr = false;
						} else {
							flag_umr = true;
						}
					} else {
						if(substr(str_umr,4,2) == '02') {
							if(parseInt(substr(str_umr,6,2)) == parseInt(str_umr_lastday)) {
								flag_umr = true;
							} else {
								flag_umr = false;
							}
						} else {
							flag_ugs = false;
						}
					}
				} else {
					flag_umr = false;
				}
				if(substr(str_umr,4,2) <> '02' && str_usd_day < substr(str_umr,6,2)) {
					flag_umr = false;
				}
			}
		} else {
			flag_umr = false;
		}

		if(flag_umr) {
			if(substr(str_umr,4,2) == '02') {
				ds_list.SetColumn(ds_list.row, "UMR", substr(str_umr,0,6) + str_umr_lastday);
			} else {
				ds_list.SetColumn(ds_list.row, "UMR", strText);
			}
		} else {
			var arr = [st_umr.value];
			gfn_showMsg("CW00022", arr);
			PopupDiv0.ClosePopup();
//			PopupDiv0.cal_temp.Visible = false;
			return;
		}
	}
*/
	if(grd_list.GetClickedCell() == 12) {
		var flag_ugs = false;
		var str_usd = strText;

		flag_ugs = true;

		ds_list.SetColumn(ds_list.row, "UGS", "");
		ds_list.SetColumn(ds_list.row, "UHJ", "");

		if(flag_ugs) {
			ds_list.SetColumn(ds_list.row, "USD", strText);
		} else {
			var arr = [st_usd.value];
			gfn_showMsg("CW00022", arr);
			PopupDiv0.ClosePopup();
			return;
		}
	} else if(grd_list.GetClickedCell() == 13) {
		if(length(ds_list.GetColumn(ds_list.row, "USD")) == 0) {
			var arr = [st_usd.value];
			gfn_showMsg("CW00022", arr);
			PopupDiv0.ClosePopup();
			return;
		}

		var flag_ugs = false;
		var str_usd = ds_list.GetColumn(ds_list.row, "USD");
		var str_usd_yymm = substr(ds_list.GetColumn(ds_list.row, "USD"),0,6);
		var str_usd_mm = substr(ds_list.GetColumn(ds_list.row, "USD"),4,2);
		var str_usd_day = substr(ds_list.GetColumn(ds_list.row, "USD"),6,2);
		var str_ugs = strText;
		var str_ugs_yymm = substr(str_ugs,0,6);
		var str_ugs_mm = substr(str_ugs,4,2);
		var str_ugs_day = substr(str_ugs,6,2);
		var str_ugs_lastday = gfn_getLastDayByStr(substr(str_ugs,0,6));

		if(parseInt(str_usd) <= parseInt(str_ugs)) {
			flag_ugs = true;
		} else {
			flag_ugs = false;
		}

		if(gfn_getMonthCnt(str_ugs,ds_list.GetColumn(ds_list.row, "UMR")) > 12) {
			flag_ugs = false;
		}

		if(flag_ugs) {
			ds_list.SetColumn(ds_list.row, "UGS", str_ugs);
		} else {
			var arr = [st_ugs.value];
			gfn_showMsg("CW00022", arr);
			PopupDiv0.ClosePopup();
			return;
		}
	} else if(grd_list.GetClickedCell() == 14) {
		if(length(ds_list.GetColumn(ds_list.row, "USD")) == 0) {
			var arr = [st_usd.value];
			gfn_showMsg("CW00022", arr);
			PopupDiv0.ClosePopup();
			return;
		}

		if(length(ds_list.GetColumn(ds_list.row, "UGS")) == 0) {
			var arr = [st_ugs.value];
			gfn_showMsg("CW00022", arr);
			PopupDiv0.ClosePopup();
			return;
		}

		var flag_umr = false;
		var str_ugs = ds_list.GetColumn(ds_list.row, "UGS");
		var str_ugs_yymm = substr(ds_list.GetColumn(ds_list.row, "UGS"),0,6);
		var str_ugs_mm = substr(ds_list.GetColumn(ds_list.row, "UGS"),4,2);
		var str_ugs_day = substr(ds_list.GetColumn(ds_list.row, "UGS"),6,2);
		var str_umr = strText;
		var str_umr_after = gfn_getAfterDate(str_umr, 1);
		var str_umr_yymm = substr(str_umr_after,0,6);
		var str_umr_mm = substr(str_umr_after,4,2);
		var str_umr_day = substr(str_umr_after,6,2);
		var str_umr_lastday = gfn_getLastDayByStr(substr(str_umr,0,6));

		if(parseInt(str_ugs) <= parseInt(str_umr)) {
			if(parseInt(str_ugs_day) == parseInt(str_umr_day)) {
				flag_umr = true;
			} else {
				if(str_ugs_mm < str_umr_mm && str_ugs_day >= 28) {
					if(parseInt(str_umr_day) == parseInt(str_umr_lastday)) {
						if(parseInt(str_ugs_day) == parseInt(substr(str_umr,6,2))) {
							flag_umr = false;
						} else {
							flag_umr = true;
						}
					} else {
						if(substr(str_umr,4,2) == '02') {
							if(parseInt(substr(str_umr,6,2)) == parseInt(str_umr_lastday)) {
								flag_umr = true;
							} else {
								flag_umr = false;
							}
						} else {
							flag_ugs = false;
						}
					}
				} else {
					flag_umr = false;
				}
				if(substr(str_umr,4,2) <> '02' && str_ugs_day < substr(str_umr,6,2)) {
					flag_umr = false;
				}
			}
		} else {
			flag_umr = false;
		}

		if(gfn_getMonthCnt(str_ugs,str_umr) > 12) {
			flag_umr = false;
		}

		if(flag_umr) {
			if(substr(str_umr,4,2) == '02') {
				ds_list.SetColumn(ds_list.row, "UMR", substr(str_umr,0,6) + str_umr_lastday);
			} else {
				ds_list.SetColumn(ds_list.row, "UMR", strText);
			}
		} else {
			var arr = [st_umr.value];
			gfn_showMsg("CW00022", arr);
			PopupDiv0.ClosePopup();
			return;
		}
	} else if(grd_list.GetClickedCell() == 48) {
		var str_rgs = strText;

		ds_list.SetColumn(ds_list.row, "RGS", str_rgs);
		ds_list.SetColumn(ds_list.row, "RMR", "");
	} else if(grd_list.GetClickedCell() == 49) {
		if(length(ds_list.GetColumn(ds_list.row, "RGS")) == 0) {
			var arr = [st_rgs.value];
			gfn_showMsg("CW00022", arr);
			PopupDiv0.ClosePopup();
			return;
		}

		var flag_rmr = false;
		var str_rgs = ds_list.GetColumn(ds_list.row, "RGS");
		var str_rmr = strText;

		if(parseInt(str_rgs) <= parseInt(str_rmr)) {
			flag_rmr = true;
		} else {
			flag_rmr = false;
		}

		if(flag_rmr) {
			ds_list.SetColumn(ds_list.row, "RMR", str_rmr);
		} else {
			var arr = [st_rmr.value];
			gfn_showMsg("CW00022", arr);
			PopupDiv0.ClosePopup();
			return;
		}
	}

	PopupDiv0.ClosePopup();
}

/********************************************************************************
* 기      능   : 달력에서 포커스 잃었을 경우
********************************************************************************/
function PopupDiv0_cal_temp_OnKillFocus(obj)
{
	PopupDiv0.ClosePopup();
//	PopupDiv0.cal_temp.Visible = false;
}

function cb_pergbn_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	calc_Amt("B");
}

function calc_Amt(gbn) {
	var tmp_pergnd = cb_pergbn.value;	//영세율적용여부
	var sum_tot, sum_amt, sum_vat, sumamt, gamamt, t_vat, a_amt, a_vat, a_tot, tmp_vat;
	var sum_tobt, sum_ambt, sum_vabt, sumambt, t_vabt, a_ambt, a_vabt, a_tobt, tmp_vabt;
	var sum_tott, sum_amtt, sum_vatt, sumamtt, t_vatt, a_amtt, a_vatt, a_tott, tmp_vatt;
	sumamt = parseInt(med_sumamt.value);
	sumambt = parseInt(med_sumambt.value);
	sumamtt = parseInt(med_sumamtt.value);
	gamamt = parseInt(med_gamamt.value);

	if (chk_bdgbn.value == "1"){			// 분담이행방식
		if(tmp_pergnd == 'Y') {				// 영세율적용여부
			for(var i=0; i<ds_list.RowCount(); i++) {
				var s_dif = 0, s_dibf = 0, s_ditf = 0;
	
				if (gbn == "B") {
					if (ds_list.GetOrgColumn(i, "AMTT") > 0 > 0) {
						s_dif  = abs(ds_list.GetOrgColumn(i, "AMT")  - ds_list.GetColumn(i, "AMT"));
						s_dibf = abs(ds_list.GetOrgColumn(i, "AMBT") - ds_list.GetColumn(i, "AMBT"));
						s_ditf = abs(ds_list.GetOrgColumn(i, "AMTT") - ds_list.GetColumn(i, "AMTT"));
					} else {
						s_dif = 0;
						s_dibf = 0;
						s_ditf = 0;
					}
	
					ds_list.SetColumn(i, "DIF" , s_dif);
					ds_list.SetColumn(i, "DIBF", s_dif);
					ds_list.SetColumn(i, "DITF", s_dif);
				}
	
				if(chk_flag = false) {
					//직영분
					ds_list.SetColumn(i, "VAT", 0);
					ds_list.SetColumn(i, "TOT", ds_list.GetColumn(i, "AMT")+ds_list.GetColumn(i, "HMT")+ds_list.GetColumn(i, "DMT")+ds_list.GetColumn(i, "ACMT"));
	
					sum_amt = sum_amt + ds_list.GetColumn(i, "AMT")+ds_list.GetColumn(i, "HMT")+ds_list.GetColumn(i, "DMT")+ds_list.GetColumn(i, "ACMT");
					sum_vat = sum_vat + ds_list.GetColumn(i, "VAT");
					sum_tot = sum_tot + ds_list.GetColumn(i, "TOT");
					//협력사분
					ds_list.SetColumn(i, "VABT", 0);
					ds_list.SetColumn(i, "TOBT", ds_list.GetColumn(i, "AMBT"));
	
					sum_ambt = sum_ambt + ds_list.GetColumn(i, "AMBT");
					sum_vabt = sum_vabt + ds_list.GetColumn(i, "VABT");
					sum_tobt = sum_tobt + ds_list.GetColumn(i, "TOBT");

					//합계 ( = 직영 + 협력사)
					ds_list.SetColumn(i, "VATT", 0);
					ds_list.SetColumn(i, "TOTT", ds_list.GetColumn(i, "AMTT")+ds_list.GetColumn(i, "HMT")+ds_list.GetColumn(i, "DMT")+ds_list.GetColumn(i, "ACMT"));
	
					sum_amtt = sum_amtt + ds_list.GetColumn(i, "AMTT") + ds_list.GetColumn(i, "HMT") + ds_list.GetColumn(i, "DMT") + ds_list.GetColumn(i, "ACMT");
					sum_vatt = sum_vatt + ds_list.GetColumn(i, "VATT");
					sum_tott = sum_tott + ds_list.GetColumn(i, "TOTT");
					
				} else {
					if(ds_list.GetColumn(i, "CHK") == true) {
						// 직영분
						ds_list.SetColumn(i, "VAT", 0);
						ds_list.SetColumn(i, "TOT", ds_list.GetColumn(i, "AMT")+ds_list.GetColumn(i, "HMT")+ds_list.GetColumn(i, "DMT")+ds_list.GetColumn(i, "ACMT"));
	
						sum_amt = sum_amt + ds_list.GetColumn(i, "AMT") + ds_list.GetColumn(i, "HMT") + ds_list.GetColumn(i, "DMT") + ds_list.GetColumn(i, "ACMT");
						sum_vat = sum_vat + ds_list.GetColumn(i, "VAT");
						sum_tot = sum_tot + ds_list.GetColumn(i, "TOT");

						// 협력사분
						ds_list.SetColumn(i, "VABT", 0);
						ds_list.SetColumn(i, "TOBT", ds_list.GetColumn(i, "AMBT"));
	
						sum_ambt = sum_ambt + ds_list.GetColumn(i, "AMBT");
						sum_vabt = sum_vabt + ds_list.GetColumn(i, "VABT");
						sum_tobt = sum_tobt + ds_list.GetColumn(i, "TOBT");
						
						//합계 ( = 직영 + 협력사)
						ds_list.SetColumn(i, "VATT", 0);
						ds_list.SetColumn(i, "TOTT", ds_list.GetColumn(i, "AMTT")+ds_list.GetColumn(i, "HMT")+ds_list.GetColumn(i, "DMT")+ds_list.GetColumn(i, "ACMT"));
	
						sum_amtt = sum_amtt + ds_list.GetColumn(i, "AMTT")+ds_list.GetColumn(i, "HMT")+ds_list.GetColumn(i, "DMT")+ds_list.GetColumn(i, "ACMT");
						sum_vatt = sum_vatt + ds_list.GetColumn(i, "VATT");
						sum_tott = sum_tott + ds_list.GetColumn(i, "TOTT");
					} else {
						// 직영분
						ds_list.SetColumn(i, "AMT", ds_list.GetColumn(i, "ORG_AMT"));
						ds_list.SetColumn(i, "VAT", ds_list.GetColumn(i, "ORG_VAT"));
						ds_list.SetColumn(i, "TOT", ds_list.GetColumn(i, "ORG_TOT"));
						// 협력사분
						ds_list.SetColumn(i, "AMBT", ds_list.GetColumn(i, "ORG_AMBT"));
						ds_list.SetColumn(i, "VABT", ds_list.GetColumn(i, "ORG_VABT"));
						ds_list.SetColumn(i, "TOBT", ds_list.GetColumn(i, "ORG_TOBT"));
						//합계 ( = 직영 + 협력사)
						ds_list.SetColumn(i, "AMTT", ds_list.GetColumn(i, "ORG_AMTT"));
						ds_list.SetColumn(i, "VATT", ds_list.GetColumn(i, "ORG_VATT"));
						ds_list.SetColumn(i, "TOTT", ds_list.GetColumn(i, "ORG_TOTT"));
					}
				}
			}
			//직영분
			sum_amt = sum_tot + sumamt + gamamt;
			sum_tot = sum_tot + sumamt + gamamt;
			//협력사분
			sum_ambt = sum_tobt;
			sum_tobt = sum_tobt;
			//합계 ( = 직영 + 협력사)
			sum_amtt = sum_tott + sumamt + gamamt;
			sum_tott = sum_tott + sumamt + gamamt;
		
		} else {							// 과세
			for(var i=0; i<ds_list.RowCount(); i++) {
				var s_dif = 0, s_dibf = 0, s_ditf = 0;
	
				if(gbn == "B") {
					if(ds_list.GetOrgColumn(i, "AMTT") > 0) {
						s_dif  = abs(ds_list.GetOrgColumn(i, "AMT")  - ds_list.GetColumn(i, "AMT"));
						s_dibf = abs(ds_list.GetOrgColumn(i, "AMBT") - ds_list.GetColumn(i, "AMBT"));
						s_ditf = abs(ds_list.GetOrgColumn(i, "AMTT") - ds_list.GetColumn(i, "AMTT"));
					} else {
						s_dif  = 0;
						s_dibf = 0;
						s_ditf = 0;
					}
	
					ds_list.SetColumn(i, "DIF" , s_dif);
					ds_list.SetColumn(i, "DIBF", s_dibf);
					ds_list.SetColumn(i, "DITF", s_ditf);
				}
				//직영분
				a_amt = ds_list.GetColumn(i, "AMT")+ds_list.GetColumn(i, "HMT")+ds_list.GetColumn(i, "DMT")+ds_list.GetColumn(i, "ACMT");
				a_vat = parseInt((a_amt * 1.1) / 10) * 10;
				a_vat = (a_amt * 0.1) + (a_vat - (a_amt * 1.1));
				a_tot = a_amt + a_vat;

				//협력사분
				a_ambt = ds_list.GetColumn(i, "AMBT");
				a_vabt = parseInt((a_ambt * 1.1) / 10) * 10;
				a_vabt = (a_ambt * 0.1) + (a_vabt - (a_ambt * 1.1));
				a_tobt = a_ambt + a_vabt;
				
				//합계 ( = 직영 + 협력사)
				a_amtt = ds_list.GetColumn(i, "AMTT")+ds_list.GetColumn(i, "HMT")+ds_list.GetColumn(i, "DMT")+ds_list.GetColumn(i, "ACMT");
				a_vatt = parseInt((a_amtt * 1.1) / 10) * 10;
				a_vatt = (a_amtt * 0.1) + (a_vatt - (a_amtt * 1.1));
				a_tott = a_amtt + a_vatt;
	
				if(chk_flag = false) {
					//직영분
					ds_list.SetColumn(i, "VAT", round(a_vat));
					ds_list.SetColumn(i, "TOT", a_tot);
	
					sum_amt = sum_amt + ds_list.GetColumn(i, "AMT")+ds_list.GetColumn(i, "HMT")+ds_list.GetColumn(i, "DMT")+ds_list.GetColumn(i, "ACMT");
					sum_vat = sum_vat + ds_list.GetColumn(i, "VAT");
					sum_tot = sum_tot + ds_list.GetColumn(i, "TOT");
					//협력사분
					ds_list.SetColumn(i, "VABT", round(a_vabt));
					ds_list.SetColumn(i, "TOBT", a_tobt);
	
					sum_ambt = sum_ambt + ds_list.GetColumn(i, "AMBT");
					sum_vabt = sum_vabt + ds_list.GetColumn(i, "VABT");
					sum_tobt = sum_tobt + ds_list.GetColumn(i, "TOBT");
				
					//합계 ( = 직영 + 협력사)
					ds_list.SetColumn(i, "VATT", round(a_vatt));
					ds_list.SetColumn(i, "TOTT", a_tott);
	
					sum_amtt = sum_amtt + ds_list.GetColumn(i, "AMTT")+ds_list.GetColumn(i, "HMT")+ds_list.GetColumn(i, "DMT")+ds_list.GetColumn(i, "ACMT");
					sum_vatt = sum_vatt + ds_list.GetColumn(i, "VATT");
					sum_tott = sum_tott + ds_list.GetColumn(i, "TOTT");
				} else {
					if(ds_list.GetColumn(i, "CHK") == true) {
						//직영분
						ds_list.SetColumn(i, "VAT", round(a_vat));
						ds_list.SetColumn(i, "TOT", a_tot);
	
						sum_tot = sum_tot + ds_list.GetColumn(i, "TOT");
						sum_amt = sum_amt + ds_list.GetColumn(i, "AMT")+ds_list.GetColumn(i, "HMT")+ds_list.GetColumn(i, "DMT")+ds_list.GetColumn(i, "ACMT");
						sum_vat = sum_vat + ds_list.GetColumn(i, "VAT");
					
						//협력사분
						ds_list.SetColumn(i, "VABT", round(a_vabt));
						ds_list.SetColumn(i, "TOBT", a_tobt);
	
						sum_ambt = sum_ambt + ds_list.GetColumn(i, "AMBT");
						sum_vabt = sum_vabt + ds_list.GetColumn(i, "VABT");
						sum_tobt = sum_tobt + ds_list.GetColumn(i, "TOBT");
						//합계 ( = 직영 + 협력사)
						ds_list.SetColumn(i, "VATT", round(a_vatt));
						ds_list.SetColumn(i, "TOTT", a_tott);
	
						sum_amtt = sum_amtt + ds_list.GetColumn(i, "AMTT")+ds_list.GetColumn(i, "HMT")+ds_list.GetColumn(i, "DMT")+ds_list.GetColumn(i, "ACMT");
						sum_vatt = sum_vatt + ds_list.GetColumn(i, "VATT");
						sum_tott = sum_tott + ds_list.GetColumn(i, "TOTT");
					} else {
						// 체크박스 해제 한 경우  calc_Amt 무한 루프 됨 , 삭제 처리 예정
						//ds_list.SetColumn(i, "TOT", ds_list.GetColumn(i, "ORG_TOT"));
						//ds_list.SetColumn(i, "AMT", ds_list.GetColumn(i, "ORG_AMT"));
						//ds_list.SetColumn(i, "VAT", ds_list.GetColumn(i, "ORG_VAT"));
					}
				}
			}
			/* 2008.10.07 LJH - SAP에서 공급가액 데이터 가져갈때 공급가액 * 1.1 을 하므로 정확한 합계가 되도록 로직 수정
			sum_tot = sum_tot + sumamt + gamamt;
			sum_amt = sum_amt + Round(((sumamt + gamamt) / 1.1),0);
			sum_vat = sum_vat + Round(((sumamt + gamamt) - ((sumamt + gamamt) / 1.1)),0);
			*/
			// 직영분
			sum_amt = sum_amt + Round(((sumamt + gamamt) / 1.1),0);
			tmp_vat = Round(((sumamt) / 1.1),0);
			tmp_vat = sumamt - tmp_vat;
			sum_vat = sum_vat + tmp_vat;
			sum_tot = sum_amt + sum_vat;
			// 협력사분
			sum_ambt = sum_ambt + Round(((sumambt) / 1.1),0);
			tmp_vabt = Round(((sumambt) / 1.1),0);
			tmp_vabt = sumambt - tmp_vabt;
			sum_vabt = sum_vabt + tmp_vabt;
			sum_tobt = sum_ambt + sum_vabt;
			// 합계 ( = 직영 + 협력사)
			sum_amtt = sum_amtt + Round(((sumamtt + gamamt) / 1.1),0);
			tmp_vatt = Round(((sumamtt) / 1.1),0);
			tmp_vatt = sumamtt - tmp_vatt;
			sum_vatt = sum_vatt + tmp_vatt;
			sum_tott = sum_amtt + sum_vatt;
			
		}
		// 직영분
		med_supamt.value  = Round(sum_amt,0);
		// 협력사분
		med_supambt.value = Round(sum_ambt,0);
		// 합계
		med_suptott.value = Round(sum_tott,0);
		med_supamtt.value = Round(sum_amtt,0);
		med_supvatt.value = Round(sum_vatt,0);

	
	} else {								// 주계약방식
		if(tmp_pergnd == 'Y') {				//영세율적용여부
			for(var i=0; i<ds_list.RowCount(); i++) {
				var s_dif = 0, s_dibf = 0, s_ditf = 0;
	
				if(gbn == "B") {
					if(ds_list.GetOrgColumn(i, "AMTT") > 0) {
						s_dif  = abs(ds_list.GetOrgColumn(i, "AMT") - ds_list.GetColumn(i, "AMT"));
						s_dibf = 0;
						s_ditf = abs(ds_list.GetOrgColumn(i, "AMT") - ds_list.GetColumn(i, "AMT"));
					} else {
						s_dif  = 0;
						s_dibf = 0;
						s_ditf = 0;
					}
	
					ds_list.SetColumn(i, "DIF",  s_dif);
					ds_list.SetColumn(i, "DIBF", s_dibf);
					ds_list.SetColumn(i, "DITF", s_ditf);
				}
	
				if(chk_flag = false) {
					// 직영분
					ds_list.SetColumn(i, "TOT", ds_list.GetColumn(i, "AMT")+ds_list.GetColumn(i, "HMT")+ds_list.GetColumn(i, "DMT")+ds_list.GetColumn(i, "ACMT"));
					ds_list.SetColumn(i, "VAT", 0);
	
					sum_tot = sum_tot + ds_list.GetColumn(i, "TOT");
					sum_amt = sum_amt + ds_list.GetColumn(i, "AMT")+ds_list.GetColumn(i, "HMT")+ds_list.GetColumn(i, "DMT")+ds_list.GetColumn(i, "ACMT");
					sum_vat = sum_vat + ds_list.GetColumn(i, "VAT");
					// 협력사분
					ds_list.SetColumn(i, "TOBT", 0);
					ds_list.SetColumn(i, "VABT", 0);
	
					sum_tobt = sum_tobt + 0;
					sum_ambt = sum_ambt + 0;
					sum_vabt = sum_vabt + 0;

					// 합계 (= 직영)
					ds_list.SetColumn(i, "TOTT", ds_list.GetColumn(i, "AMT")+ds_list.GetColumn(i, "HMT")+ds_list.GetColumn(i, "DMT")+ds_list.GetColumn(i, "ACMT"));
					ds_list.SetColumn(i, "VATT", 0);
	
					sum_tott = sum_tott + ds_list.GetColumn(i, "TOTT");
					sum_amtt = sum_amtt + ds_list.GetColumn(i, "AMTT")+ds_list.GetColumn(i, "HMT")+ds_list.GetColumn(i, "DMT")+ds_list.GetColumn(i, "ACMT");
					sum_vatt = sum_vatt + ds_list.GetColumn(i, "VATT");
				} else {
					if(ds_list.GetColumn(i, "CHK") == true) {
						// 직영분
						ds_list.SetColumn(i, "TOT", ds_list.GetColumn(i, "AMT")+ds_list.GetColumn(i, "HMT")+ds_list.GetColumn(i, "DMT")+ds_list.GetColumn(i, "ACMT"));
						ds_list.SetColumn(i, "VAT", 0);
	
						sum_tot = sum_tot + ds_list.GetColumn(i, "TOT");
						sum_amt = sum_amt + ds_list.GetColumn(i, "AMT")+ds_list.GetColumn(i, "HMT")+ds_list.GetColumn(i, "DMT")+ds_list.GetColumn(i, "ACMT");
						sum_vat = sum_vat + ds_list.GetColumn(i, "VAT");
						// 협력사분
						ds_list.SetColumn(i, "TOBT", 0);
						ds_list.SetColumn(i, "VABT", 0);
	
						sum_tobt = sum_tobt + 0;
						sum_ambt = sum_ambt + 0;
						sum_vabt = sum_vabt + 0;
						// 합계 ( = 직영)
						ds_list.SetColumn(i, "TOTT", ds_list.GetColumn(i, "AMTT")+ds_list.GetColumn(i, "HMT")+ds_list.GetColumn(i, "DMT")+ds_list.GetColumn(i, "ACMT"));
						ds_list.SetColumn(i, "VATT", 0);
	
						sum_tott = sum_tott + ds_list.GetColumn(i, "TOTT");
						sum_amtt = sum_amtt + ds_list.GetColumn(i, "AMTT")+ds_list.GetColumn(i, "HMT")+ds_list.GetColumn(i, "DMT")+ds_list.GetColumn(i, "ACMT");
						sum_vatt = sum_vatt + ds_list.GetColumn(i, "VATT");
					} else {
						// 직영분
						ds_list.SetColumn(i, "TOT", ds_list.GetColumn(i, "ORG_TOT"));
						ds_list.SetColumn(i, "AMT", ds_list.GetColumn(i, "ORG_AMT"));
						ds_list.SetColumn(i, "VAT", ds_list.GetColumn(i, "ORG_VAT"));
						// 협력사분
						ds_list.SetColumn(i, "TOBT", 0);
						ds_list.SetColumn(i, "AMBT", 0);
						ds_list.SetColumn(i, "VABT", 0);
						// 합계 ( = 직영)
						ds_list.SetColumn(i, "TOTT", ds_list.GetColumn(i, "ORG_TOTT"));
						ds_list.SetColumn(i, "AMTT", ds_list.GetColumn(i, "ORG_AMTT"));
						ds_list.SetColumn(i, "VATT", ds_list.GetColumn(i, "ORG_VATT"));
					}
				}
			}
			// 직영분
			sum_amt = sum_tot + sumamt + gamamt;
			sum_tot = sum_tot + sumamt + gamamt;
			// 협력사
			sum_ambt = 0;
			sum_tobt = 0;
			// 합계 ( = 직영)
			sum_amtt = sum_tott + sumamtt + gamamt;
			sum_tott = sum_tott + sumamtt + gamamt;
		} else {						    // 과세
			for(var i=0; i<ds_list.RowCount(); i++) {
				var s_dif = 0, s_dibf = 0, s_ditf = 0;
	
				if(gbn == "B") {
					if(ds_list.GetOrgColumn(i, "AMTT") > 0) {
						s_dif  = abs(ds_list.GetOrgColumn(i, "AMT") - ds_list.GetColumn(i, "AMT"));
						s_dibf = 0;
						s_ditf = abs(ds_list.GetOrgColumn(i, "AMTT") - ds_list.GetColumn(i, "AMTT"));
					} else {
						s_dif  = 0;
						s_dibf = 0;
						s_ditf = 0;
					}
	
					ds_list.SetColumn(i, "DIF" , s_dif);
					ds_list.SetColumn(i, "DIBF", s_dibf);
					ds_list.SetColumn(i, "DITF", s_ditf);
				}

				// 직영분
				a_amt = ds_list.GetColumn(i, "AMT")+ds_list.GetColumn(i, "HMT")+ds_list.GetColumn(i, "DMT")+ds_list.GetColumn(i, "ACMT");
				a_vat = parseInt((a_amt * 1.1) / 10) * 10;
				a_vat = (a_amt * 0.1) + (a_vat - (a_amt * 1.1));
				a_tot = a_amt + a_vat;
				// 협려사분
				a_ambt = 0;
				a_vabt = 0;
				a_tobt = a_ambt + a_vabt;
				// 합계 ( = 직영)
				a_amtt = ds_list.GetColumn(i, "AMTT")+ds_list.GetColumn(i, "HMT")+ds_list.GetColumn(i, "DMT")+ds_list.GetColumn(i, "ACMT");
				a_vatt = parseInt((a_amtt * 1.1) / 10) * 10;
				a_vatt = (a_amtt * 0.1) + (a_vatt - (a_amtt * 1.1));
				a_tott = a_amtt + a_vatt;

				if(chk_flag = false) {
					// 직영분
					ds_list.SetColumn(i, "VAT", round(a_vat));
					ds_list.SetColumn(i, "TOT", a_tot);
	
					sum_tot = sum_tot + ds_list.GetColumn(i, "TOT");
					sum_amt = sum_amt + ds_list.GetColumn(i, "AMT")+ds_list.GetColumn(i, "HMT")+ds_list.GetColumn(i, "DMT")+ds_list.GetColumn(i, "ACMT");
					sum_vat = sum_vat + ds_list.GetColumn(i, "VAT");
					// 협력사분
					ds_list.SetColumn(i, "VABT", 0);
					ds_list.SetColumn(i, "TOBT", 0);
	
					sum_tobt = sum_tobt + 0;
					sum_ambt = sum_ambt + 0;
					sum_vabt = sum_vabt + 0;
					// 합계 ( = 직영)
					ds_list.SetColumn(i, "VATT", round(a_vatt));
					ds_list.SetColumn(i, "TOTT", a_tott);
	
					sum_tott = sum_tott + ds_list.GetColumn(i, "TOTT");
					sum_amtt = sum_amtt + ds_list.GetColumn(i, "AMTT")+ds_list.GetColumn(i, "HMT")+ds_list.GetColumn(i, "DMT")+ds_list.GetColumn(i, "ACMT");
					sum_vatt = sum_vatt + ds_list.GetColumn(i, "VATT");
				} else {
					if(ds_list.GetColumn(i, "CHK") == true) {
						// 직영분
						ds_list.SetColumn(i, "VAT", round(a_vat));
						ds_list.SetColumn(i, "TOT", a_tot);
	
						sum_tot = sum_tot + ds_list.GetColumn(i, "TOT");
						sum_amt = sum_amt + ds_list.GetColumn(i, "AMT")+ds_list.GetColumn(i, "HMT")+ds_list.GetColumn(i, "DMT")+ds_list.GetColumn(i, "ACMT");
						sum_vat = sum_vat + ds_list.GetColumn(i, "VAT");
						// 협력사분
						ds_list.SetColumn(i, "VABT", round(a_vat));
						ds_list.SetColumn(i, "TOBT", a_tot);
	
						sum_tobt = 0;
						sum_ambt = 0;
						sum_vabt = 0;
						// 합계 ( = 직영)
						ds_list.SetColumn(i, "VATT", round(a_vatt));
						ds_list.SetColumn(i, "TOTT", a_tott);
	
						sum_tott = sum_tott + ds_list.GetColumn(i, "TOTT");
						sum_amtt = sum_amtt + ds_list.GetColumn(i, "AMTT")+ds_list.GetColumn(i, "HMT")+ds_list.GetColumn(i, "DMT")+ds_list.GetColumn(i, "ACMT");
						sum_vatt = sum_vatt + ds_list.GetColumn(i, "VATT");
					} else {
						// 체크박스 해제 한 경우  calc_Amt 무한 루프 됨 , 삭제 처리 예정
						//ds_list.SetColumn(i, "TOT", ds_list.GetColumn(i, "ORG_TOT"));
						//ds_list.SetColumn(i, "AMT", ds_list.GetColumn(i, "ORG_AMT"));
						//ds_list.SetColumn(i, "VAT", ds_list.GetColumn(i, "ORG_VAT"));
					}
				}
			}
			/* 2008.10.07 LJH - SAP에서 공급가액 데이터 가져갈때 공급가액 * 1.1 을 하므로 정확한 합계가 되도록 로직 수정
			sum_tot = sum_tot + sumamt + gamamt;
			sum_amt = sum_amt + Round(((sumamt + gamamt) / 1.1),0);
			sum_vat = sum_vat + Round(((sumamt + gamamt) - ((sumamt + gamamt) / 1.1)),0);
			*/
			// 직영분
			sum_amt = sum_amt + Round(((sumamt + gamamt) / 1.1),0);
			tmp_vat = Round(((sumamt) / 1.1),0);
			tmp_vat = sumamt - tmp_vat;
			sum_vat = sum_vat + tmp_vat;
			sum_tot = sum_amt + sum_vat;
			// 협력사분
			sum_ambt = 0;
			tmp_vabt = 0;
			sum_tobt = 0;
			// 합계 ( = 직영)
			sum_amtt = sum_amtt + Round(((sumamtt + gamamt) / 1.1),0);
			tmp_vatt = Round(((sumamtt) / 1.1),0);
			tmp_vatt = sumamtt - tmp_vatt;
			sum_vatt = sum_vatt + tmp_vatt;
			sum_tott = sum_amtt + sum_vatt;
		}
	
	//	med_suptot.value = parseInt(sum_tot);
	//	med_supamt.value = parseInt(sum_amt);
	//	med_supvat.value = parseInt(sum_vat);
		// 직영분
		med_supamt.value = Round(sum_amt,0);
		// 협력사분
		med_supambt.value = Round(sum_ambt,0);
		// 합계
		med_suptott.value = Round(sum_tott,0);
		med_supamtt.value = Round(sum_amtt,0);
		med_supvatt.value = Round(sum_vatt,0);
	}
	chk_flag = false;
	
	// 모회사 -> 자회사 이관시 에만 수주보전 로직을 타지 않도록 하기 위해 이전의 보수협력사 값을 구한다.
	// 자동연장 혹은 견적 혹은 카피툴을 통한 계약시에만 로직을 수행하도록
	if(length(trim(bf_vVkbur)) <= 0) { // 한번만 가져오도록 처리
		if(chk_query == "auto_query" || est_flag == true || copytool_flag == true) {
			fn_getBeforeVkbur();
			
			// 2020.07.30 Han J.H
			// 계약데이터 상세등록 버튼으로 계약등록 시 저장위치 셋팅이 안되어
			// 모회사-> 자회사 계약인대도 불구하고 이전 보수협력사의 값이 불명확하여
			// 수주차감되는 경우가 있어 이후 보수협력사를 구할 때 같이 이전 보수협력사를 구함.
			vVkbur = gfn_getBsu(ds_list.GetColumn(0, "BSU"), "VKBUR");			
		}	
	}
}
function cb_conkind_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	if(cb_conkind.value == 'C') { //유상공사
		grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","RGB"),"Display","null");	//비율제계약여부				//32
		grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","RGB"),"Edit","none");										//32
//		grd_list.SetCellProp("body",23,"Display","null");
		grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","RTO"),"Edit","none");		//지급율						//33
		grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","KND_YN"),"Display","null");	//FM계약여부					//34
		grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","KND_YN"),"Edit","none");										//34
		grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","KND"),"Display","null");									//35
		grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","KND"),"Edit","none");		//FM상품						//35
		grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","IYN"),"Display","null");	//인센티브지급					//36
		grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","IYN"),"Edit","none");										//36
	} else { //유상일반
	
//		grd_list.SetCellProp("body",23,"Display","number");
		grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","KND"),"Display","combo");		//FM상품					//35
		grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","KND"),"Edit","combo");										//35

		for(var i=0; i<ds_list.RowCount(); i++) {
			if(ds_list.getColumn(i, "RGB") == "1") {
				grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","KND_YN"),"Display","null");	//FM계약여부			//34
				grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","KND_YN"),"Edit","none");								//34
			} else {
				grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","KND_YN"),"Display","checkbox");						//34
				grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","KND_YN"),"Edit","checkbox");							//34
			}

			if(ds_list.getColumn(i, "KND_YN") == "1") {
				grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","IYN"),"Display","null");	//인센티브지급			//36
				grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","IYN"),"Edit","none");								//36
			} else {
				grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","IYN"),"Display","checkbox");						//36
				grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","IYN"),"Edit","checkbox");							//36
			}
		}
	}
}

function grd_list_OnKillFocus(obj)
{
	calc_Amt("B");
}

function btn_per_OnClick(obj)
{
	var arg = "upn=" + quote(ed_upn.value) +
			  " cst=" + quote(cb_cst.value) +
			  " nam=" + quote(ed_nam.value) +
			  " spt=" + quote(ed_spt.value) +
			  " gnd=" + quote(cb_conkind.value) + 
			  " usd=" + quote(temp_usd) + 
			  " uhj=" + quote(temp_uhj) + 
			  " gno=" + quote(ds_list.GetColumn(0, "GNO")) +
			  " bsu=" + quote(ds_list.GetColumn(0, "BSU")) +
			  " gbu=" + quote(ds_list.GetColumn(0, "GBU")) +
			  " bdgbn=" + quote(chk_bdgbn.Value);

	if (length(ds_list.GetColumn(0, "GNO")) == 0 || ds_list.GetColumn(0, "GNO") == "X"){
		gfn_showMsg("승인되지 않은 유상계약은 '상주인원'정보를 입력할 수 없습니다.");
		return;
	}
	gfn_openPopup("CS1201001D", true, arg);
}

function btn_copy_OnClick(obj)
{
	var cRow = 0;
	for (i = 0; i < ds_list.GetRowCount();i++){
		if (ds_list.GetColumn(i, "CHK") == "1"){
			cRow = i;
			break;
		}
	}
	var arg = "upn="     + quote(ed_upn.value) +
			  " cst="    + quote(cb_cst.value) +
			  " kind="   + quote(cb_conkind.value) +
			  " bdgbn="  + quote(chk_bdgbn.value) +
			  " knd_yn=" + quote(ds_list.GetColumn(cRow, "KND_YN")) +
			  " abg="    + quote(ds_list.GetColumn(cRow, "ABG")) +
			  " hno="    + quote(substr(ds_list.GetColumn(cRow, "HNO"),0,1)) +
			  " gbu="    + quote(ds_list.GetColumn(cRow, "GBU"));
	if (ds_list.GetRowCount() == 0){
		return;
	}
	gfn_openPopup("CS1201001C", true, arg);
}

function btn_gd_query_OnClick(obj)
{
	ed_estno.Text = ""; //견적번호 초기화
	gnd = cb_conkind.value;
	fn_query();
}

function btn_auto_OnClick(obj)
{ 
	if(ed_sla_yn.Value == "Y") {
		gfn_showAlert("기술용역계약은 자동연장을 할 수 없습니다.");
	} else if(parseInt(med_percnt.Value) > 0) {
		gfn_showAlert("인원상주 포함계약은 자동연장으로 입력할 수 없습니다.");
	} else {
		if (G_CURR_DATE < "20211231"){
			if (ds_list.GetColumn(0, "GBU") == "3"){
				if (substr(ds_list.GetColumn(0, "HNO"),0,1) != "J" && substr(ds_list.GetColumn(0, "HNO"),0,1) != "G"){
					if (chk_bdgbn.value != "1"){
						vAutoBdgbnFlag = confirm("'주계약' 방식으로 자동연장 하시겠습니까?");
						if (vAutoBdgbnFlag == "1"){
							alert("자동연장기간을 '1'개월로 제한합니다.");
						} else {
							alert("'분담이행방식'으로 자동연장을 진행합니다.");
						}
					}
				}
			}
		}
		fn_query2();
	}
	
	// 자동연장시  계약서가 있으면 계약서 종류 및 전자결재 확성화
	if ( cb_cyn.index == 1 )
	{
		cb_ctp.Enable = true;
		cb_etc.Enable = true;
		
		//=====종이계약시 비고입력====
		if(cb_etc.value = "1")
		{
			ed_etcbg.Enable = true;
		}
		
	}
	//=================================
	
}

function btn_sd_query_OnClick(obj)
{
	fn_query3();
}

function btn_save_OnClick(obj)
{
	fn_save();
}

function btn_seungin_OnClick(obj)
{
	fn_save3();
}

function btn_del_OnClick(obj)
{
	var apstat = parseInt(ds_list.GetColumn(0, "APSTAT")) ;
//	trace("apstat="+apstat );
	if(apstat>=1 && apstat<>2 && apstat<>5) {
		gfn_showAlert("기안을 올린 경우 반송상태가 아니면 삭제할 수 없습니다.");
		return;
	}
	
	// 승인삭제 시 중도해지 결재상태 검증 로직(반송 및 수신결재완료 상태가 아닌경우 리턴처리)
	// 2019.01.22 Han J.H
	halfCancleChk();
	if(chk_halfcancle) {
		return;
	}
	
	fn_delete();
}

function btn_set_OnClick(obj)
{
	var arg = "upn=" + quote(ed_upn.value) +
			  " cst=" + quote(cb_cst.value) +
			  " nam=" + quote(ed_nam.value) +
			  " spt=" + quote(ed_spt.value) +
			  " gnd=" + quote(cb_conkind.value) +
			  " gbn=" + quote(cb_pergbn.value) +
			  " gno=" + quote(gno) +
			  " vbeln=" + quote(vbeln) +
			  " vkbur=" + quote(vVkbur) +
			  " vkgrp=" + quote(vVkgrp);

	gfn_openPopup("CS3301001A", true, arg);
}

function fn_chkFirst() {
	if(chk_first > 0) {
		gnd = cb_conkind.value;
		usd = '';
		uhj = '';
	}
}

function grd_list_OnCellClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
/*
	if(nCell == '22') {
		if(substr(ds_list.GetColumn(nRow, "HNO"),0,1) == "J" || substr(ds_list.GetColumn(nRow, "HNO"),0,1) == "G") {
			grd_list.SetCellProp("body",22,"Edit","none");

			if(substr(ds_list.GetColumn(nRow, "HNO"),0,1) == "J") {
				ds_list.GetColumn(nRow, "RTO", 57);
			} else if(substr(ds_list.GetColumn(nRow, "HNO"),0,1) == "G") {
				ds_list.GetColumn(nRow, "RTO", 0);
			} else if(substr(ds_list.GetColumn(nRow, "HNO"),0,1) == "S") {
				ds_list.GetColumn(nRow, "RTO", 60);
			}
			return;
		} else {
			grd_list.SetCellProp("body",22,"Edit","checkbox");
			return;
		}
	}
*/
	var vColId = grd_list.GetCellProp("body",nCell,"ColId");
	if (vColId == "HYN"){		 								//if(nCell == '17') {	//HRTS 여부
		if(ds_list.GetColumn(nRow, "HYN") == "") {
			grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","HMT"),"Edit","number");									//18
			grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","HEP"),"Edit","combo");										//19
			grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","HWR"),"Edit","combo");										//20
			return;
		} else {
			grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","HMT"),"Edit","none");										//18
			grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","HEP"),"Edit","combo");										//49
			grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","HWR"),"Edit","none");										//20
			ds_list.SetColumn(nRow, "HMT", 0);
			ds_list.SetColumn(nRow, "HEP", "");
			ds_list.SetColumn(nRow, "HWR", "");
			return;
		}
	}
	
	//===========================공기청정기 추가 20200515 Han.JH====================================
	if (vColId == "ACYN"){
		if(ds_list.GetColumn(nRow, "ACYN") == "") {
			grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","ACND"),"Edit","combo");
			grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","ACMT"),"Edit","number");
			return;
		} else {
			grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","ACND"),"Edit","none");
			grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","ACMT"),"Edit","none");
			ds_list.SetColumn(nRow, "ACMT", 0);
			ds_list.SetColumn(nRow, "ACND", "");
			return;
		}
	}
	//==============================================================================================	

	if (vColId == "DYN"){		 								//if(nCell == '21') {	//DI-PBX 여부
		if(ds_list.GetColumn(nRow, "DYN") == "") {
			grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","DND"),"Edit","combo");										//22
			grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","DMT"),"Edit","number");									//24
			return;
		} else {
			grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","DND"),"Edit","none");										//22
			grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","DMT"),"Edit","none");										//24
			ds_list.SetColumn(nRow, "DMT", 0);
			ds_list.SetColumn(nRow, "DND", "");
			return;
		}
	}

	if (vColId == "DCE"){		 								//if(nCell == '23') {	//DI-PBX 통신료 계약 여부 20140715 HARIM.LEE
		if(ds_list.GetColumn(nRow, "DCE") == "") {
			grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","DMT"),"Edit","number");									//24
			return;
		} else {
			grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","DND"),"Edit","none");										//22
			grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","DMT"),"Edit","none");										//24
			ds_list.SetColumn(nRow, "DMT", 0);
			return;
		}
	}
	if (vColId == "RTO"){		 								//if(nCell == '33') {	//지급율
		if(chk_query == "query" && ds_list.GetColumn(nRow, "RGB") == "1" && !(substr(ds_list.GetColumn(nRow, "HNO"),0,1) == "J" || substr(ds_list.GetColumn(nRow, "HNO"),0,1) == "G" || substr(ds_list.GetColumn(nRow, "HNO"),0,1) == "S")) {
			grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","RTO"),"Edit","number");									//33
			return;
		} else {
			grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","RTO"),"Edit","none");										//33
			return;
		}
	}

	if (vColId == "KND_YN"){		 								//if(nCell == '34') {	//FM계약여부
		if(ds_list.GetColumn(nRow, "KND_YN") == "1") {
			grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","KND"),"Edit","combo");										//35
			ds_list.SetColumn(nRow, "IYN", "0");	
			return;
		} else {	
			grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","KND"),"Edit","none");										//35
			ds_list.SetColumn(nRow, "IYN", "0");
			return;
		}
	}



	if (vColId == "KND"){		 								//if(nCell == '35') {	//FM상품
		if(ds_list.GetColumn(nRow, "KND_YN") == "1") {
			grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","KND"),"Edit","combo");										//35
			return;
		} else {
			grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","KND"),"Edit","none");										//35
			return;
		}
	}

	if (vColId == "IYN"){		 								//if(nCell == '36') {	//인센티브지급
		if(ds_list.GetColumn(nRow, "KND_YN") == "1" || chk_query <> "query") {
			grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","IYN"),"Edit","none");										//36
			return;
		} else {
			grd_list.SetCellProp("body",grd_list.GetBindCellIndex("body","IYN"),"Edit","checkbox");									//36
			return;
		}
	}

	//if(nCell <> '1' && nCell <> '12' && nCell <> '13' && nCell <> '14' && nCell <> '16' && nCell <> '32' && nCell <> '33' && nCell <> '34' && nCell <> '35' && nCell <> '36') {//Cell 번호 수정 20121030 LHR
	if (vColId <> 'CHK' && vColId <> 'USD' && vColId <> 'UGS'    && vColId <> 'UMR' && vColId <> 'AMT' && 
	    vColId <> 'RGB' && vColId <> 'RTO' && vColId <> 'KND_YN' && vColId <> 'KND' && vColId <> 'IYN') {//Cell 번호 수정 20121030 LHR

//		if(cb_congbn.value <> "3") { //계약변경이 아닌 경우만 입력조건을 바인딩 처리
//			cb_congbn.value  = ds_list.GetColumn(nRow, "GKD");
//		}
		cb_bsgbn.value   = ds_list.GetColumn(nRow, "BGB");
		cb_bhcycle.value = ds_list.GetColumn(nRow, "BJG");
		cb_bhday.value   = ds_list.GetColumn(nRow, "TIS");
		cb_jgcnt.value   = "0" + ds_list.GetColumn(nRow, "JKH");
		if(ds_list.GetColumn(nRow, "YYB") == "Y") {
			chk_nightgbn.value = "1";
		} else {
			chk_nightgbn.value = "0";
		}
		cb_pergbn.value  = ds_list.GetColumn(nRow, "ZER");
//		cb_slagbn.value  = ds_list.GetColumn(nRow, "SLA");
		ed_remark.value  = ds_list.GetColumn(nRow, "RMK");
		cb_cyn.value  	 = ds_list.GetColumn(nRow, "CYN"); 
		cb_ctp.value  	 = ds_list.GetColumn(nRow, "CTP");
		cb_etc.value  	 = ds_list.GetColumn(nRow, "ETC");
		ed_etcbg.value   = ds_list.GetColumn(nRow, "ETCBG");//=====종이계약시 비고입력====
		
		cb_cse.value  	 = ds_list.GetColumn(nRow, "CSE");
//		cb_slarsn.value  = ds_list.GetColumn(nRow, "SLR"); 
	}
}

function btn_can_OnClick(obj)
{
	// if (vVkbur == "H100"){
		// if (length(vbeln) == 0 || vbeln == "X"){
			// gfn_showAlert("수주가 안된 유상계약은 '승인취소' 처리 바랍니다.");
			// return;
		// }
	// }
	    
    // 유상계약 테이블 전체 조회 되는 오류 수정조건 추가(2019.05.02  bgt)
	if( length(trim(ds_list.GetColumn(0,"GNO"))) <= 0 )
	{
		gfn_showAlert("유상계약내용이 없는 경우 중도해지가 불가능합니다.");
		return;
	}

	var arg = " gno=" + quote(ds_list.GetColumn(0,"GNO")) +
		      " upn=" + quote(ds_list.GetColumn(0,"UPN")) +
		      " cst=" + quote(ds_list.GetColumn(0,"CST")) +
		      " maxseq=" + quote(ed_maxseq.value) +
		      " fa_popgbn=D" ;	
		   
	var pop_obj = gfn_openPopup("CS1201001H", true , arg);
}

	
/*
	gfn_clearMsgBar();

	if ( ds_list.rowCount() < 1 ) {
		// 저장할 정보 없음.
		gfn_showMsg("CW00010");
		return;
	}

	if(ds_list.FindRow("CHK", 1) == -1) {
		gfn_showMsg("CW00013");
		return;
	}

	for(var i=0; i<ds_list.RowCount(); i++) {
		if(ds_list.GetColumn(i, "CHK") == true) { //체크박스가 true 일 경우
			var usd_date = ds_list.GetOrgColumn(i, "USD");
			var org_date = ds_list.GetOrgColumn(i, "UMR");
			var can_date = ds_list.GetColumn(i, "UMR");
			var cur_date = gfn_getCurrDate();

			if(ds_list.GetColumn(i, "HST") == "F" || length(trim(ds_list.GetColumn(i, "FSD"))) > 0) { //실패된 호기를 중도해지 처리 하지 못하도록 20100114 LJH
				gfn_showMsg("CW00200");
				return;
			}

			if(length(can_date) == 0) {
				var arr = [parseInt(i) + 1, st_umr.value];
				gfn_showMsg("CW00055", arr);
				return;
			}

			//if(can_date < cur_date) {
			//	var arr = [parseInt(i) + 1, st_umr.value, st_cur_date.value];
			//	gfn_showMsg("CW00037", arr);
			//	return;
			//}

			if(can_date < usd_date) {
				var arr = [parseInt(i) + 1, st_can.value, st_usd.value];
				gfn_showMsg("CW00037", arr);
				return;
			}
			
			if(can_date >= org_date) {
				var arr = [parseInt(i) + 1, st_can.value, st_umr.value];
				gfn_showMsg("CW00062", arr);
				return;
			}

			if(ds_list.GetColumn(i, "PST") <> 'A6') {
				var arr = [parseInt(i) + 1];
				gfn_showMsg("CW00140", arr);
				return;
			}
			
			if(G_USER_ID == "2017938" || G_USER_ID == "2010984" //최인식 김재순
			 || G_USER_ID == "2018438" || G_USER_ID == "2021056" || G_USER_ID == "2023466" //권지예 전현정 이경해
			 || G_USER_ID == "2017750" || G_USER_ID == "2021200" || G_USER_ID == "2023687" ){ //이주형 이하림 용아름
			//중도해지가능
			} else {			
				if(ds_list.GetColumn(i, "HYN") == "1"){ // 2014_01_07 관리부에 한해 중도해지 가능
					gfn_showAlert("HRTS 중도해지는 관리부의 승인이 필요합니다.");
					return;
				}
				if(ds_list.GetColumn(i, "DYN") == "1"){ // 2014_01_07 관리부에 한해 중도해지 가능
					gfn_showAlert("DI-PBX 중도해지는 관리부의 승인이 필요합니다.");
					return;
				}
			}

			ds_list.SetColumn(i, "FLAG", "U");
			ds_list.SetColumn(i, "UPN", ed_upn.value);
			ds_list.SetColumn(i, "CST", cb_cst.value);
			ds_list.SetColumn(i, "UHJ", ds_list.GetOrgColumn(i, "UMR"));
			ds_list.SetColumn(i, "RMK", ed_remark.value);
			ds_list.SetColumn(i, "MAXSEQ", ed_maxseq.value);
			if(usd_date == can_date) {
				ds_list.SetColumn(i, "UMS", 0);
			} else {
				ds_list.SetColumn(i, "UMS", gfn_getMonthCnt(ds_list.GetColumn(i, "USD"),ds_list.GetColumn(i, "UMR")));
			}
		}
	}
	
	tit_callService(
        "CS1201001B_ACT"
        , "cancel"
        , "ds_list=ds_list"
        , ""
        , ""
        , "fn_afterCancel");
        */
}

function btn_seungin_cancel_OnClick(obj)
{
	gfn_clearMsgBar();

	if(ds_list.rowCount() < 1) {
		// 저장할 정보 없음.
		gfn_showMsg("CW00010");
		return;
	}
	
	// 승인삭제 시 중도해지 결재상태 검증 로직(반송 및 수신결재완료 상태가 아닌경우 리턴처리)
	// 2019.01.22 Han J.H
	halfCancleChk();
	if(chk_halfcancle) {
		return;
	}

	if(gfn_confirm("승인취소 처리 하시겠습니까?") == true) {
		for(var i=0; i<ds_list.RowCount(); i++) {
			if(ds_list.GetColumn(i, "CHK") == true) { //체크박스가 true 일 경우			
				ds_list.SetColumn(i, "FLAG", "U");
				ds_list.SetColumn(i, "MAXSEQ", ed_maxseq.value);
			}
		}

		tit_callService(
			"CS1201001B_ACT"
			, "seungin_cancel"
			, "ds_list=ds_list"
			, ""
			, ""
			, "fn_afterSeunginCancel");
	} else {
		gfn_showMsg("CW00005");
		return;
	}
}
function btn_vbeln_OnClick(obj)
{
	if (vVkbur != "H100" && vVbeln_auth != "1"){
		return;
	}

	if (length(vbeln) > 0){
		alert("수주가 진행된 계약정보 입니다.");
		return;
	}
	if (length(gno) == 0){
		alert("유상보수 계약번호 생성 후 작업하세요.");
		return;
	}
	
	ds_cond.SetColumn(0, "UPN", upn);
	ds_cond.SetColumn(0, "CST", cst);
	ds_cond.SetColumn(0, "GND", gnd);
	ds_cond.SetColumn(0, "GNO", gno);

	tit_clearActionInfo();

	tit_addSearchActionInfo("cs12:CS1201001B_S66");
	tit_addSearchActionInfo("cs12:CS1201001B_S67");	
	tit_callService(
        ""
        , ""
        , "ds_cond=ds_cond"
        , "ds_zseq=ds_zseq ds_vbeln=ds_vbeln"
        , ""
        , ""
		, false
        , false
        , true);     
        

    if (ds_vbeln.GetRowCount() == 0){
		var vBigo  = toString(toNumber(ds_zseq.GetColumn(0, "BIGO")) + 1);
		var vVbeln = "Z" + lpad(vBigo,"0",9);
		
		ds_zseq.SetColumn(0, "BIGO", vBigo);
		
		ds_vbeln.AddRow();
		ds_vbeln.SetColumn(0, "UPN", upn);
		ds_vbeln.SetColumn(0, "CST", cst);
		ds_vbeln.SetColumn(0, "GND", gnd);
		ds_vbeln.SetColumn(0, "GNO", gno);
		ds_vbeln.SetColumn(0, "VBELN", vVbeln);
		ds_vbeln.SetColumn(0, "VKBUR", vVkbur);
		ds_vbeln.SetColumn(0, "VKGRP", vVkgrp);
    }

	tit_clearActionInfo();
 	tit_addMultiActionInfo("cs12:CS1201001B_U32");	// ZCST126
 	tit_addMultiActionInfo("cs12:CS1201001B_U33");	// ZCST127
 	tit_addMultiActionInfo("cs12:CS1201001B_U34");	// ZCST0999
	tit_callService(
		""
		, ""
		, "ds_vbeln=ds_vbeln ds_vbeln_0=ds_vbeln ds_zseq=ds_zseq"
		, ""
		, ""
		, "fn_afterVbeln"
		, true
		, false
		, false);
	
}

//용역사유 추가 20120621
function cb_slagbn_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex){
	if(cb_slagbn.Value == "N") {
		cb_slarsn.Enable = false;
		cb_slarsn.index = 0;
		
	} else {
		cb_slarsn.Enable = true;
		cb_slarsn.SetFocus();
	}
	
}

function cb_cyn_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	if(cb_cyn.Value == "N") {
		cb_ctp.Enable = false;
		cb_ctp.index = 0;
		cb_etc.Enable = false;
		cb_etc.index = 0;
		
		//=====종이계약시 비고입력====
		ed_etcbg.value  = '';
		ed_etcbg.Enable = false;
		
		
		chk_cfg.Enable = false;
		chk_cfg.Value = false;
		
	} else {
		cb_ctp.Enable = true;		
		cb_ctp.SetFocus();
		cb_etc.Enable = true;
		chk_cfg.Enable = true;
		
		//=====종이계약시 비고입력====
		if(cb_etc.value = "1" ) {
			ed_etcbg.Enable = true;
		}

	}
}


//=====종이계약시 비고입력====
function cb_etc_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	if(cb_etc.value = "1" ) {
		ed_etcbg.Enable = true;
	} else {
		ed_etcbg.value  = '';
		ed_etcbg.Enable = false;
	}
}


function btn_sid_OnClick(obj)
{
	var arg = "sid=" + quote(ed_sid.value) + " sname=" + quote(ed_sname.value);
	var rtn = gfn_openPopup("CS1201001F",true, arg);	
	
	if( rtn != null ) {
		ed_sid.value   = rtn[0];
		ed_sname.value = rtn[1];
	} else{
		return;
	}
}

//계약정보로 사용할 견적조회하기 : 리턴값 - 견적번호,차수
function btn_est_search_OnClick(obj)
{
	var arg = "fa_upn=" + quote(ed_upn.Text) + 
			  " fa_cst=" + quote(cb_cst.Value);
	// 견적 계약 여부 확인   
	est_flag = false;

	var rtn = gfn_openPopup("CS1201001I", true, arg);	

	if (rtn != null ) {
		cs301_tem = rtn[0];
		cs301_rdt = rtn[1];
		cs301_seq = rtn[2];
		cs301_sir = rtn[3];		
		cs301_upn = rtn[4];		
		cs301_cst = rtn[5];		
		
		/*
		trace("cs301_tem="+cs301_tem);
		trace("cs301_rdt="+cs301_rdt);
		trace("cs301_seq="+cs301_seq);
		trace("cs301_sir="+cs301_sir);
		trace("cs301_upn="+cs301_upn);
		trace("cs301_cst="+cs301_cst);
		*/
		
		ds_cond_est.SetColumn(0, "UPN", cs301_upn);
		ds_cond_est.SetColumn(0, "CST", cs301_cst);
		ds_cond_est.SetColumn(0, "TEM", cs301_tem);
		ds_cond_est.SetColumn(0, "RDT", cs301_rdt);
		ds_cond_est.SetColumn(0, "SEQ", cs301_seq);
		ds_cond_est.SetColumn(0, "SIR", cs301_sir);
		
		ed_upn.Text = cs301_upn;		
		/*
		cb_cst.Value = cs301_cst;
		cb_cst.Text = cs301_cst;
		ds_cst_cd.ClearData();
		ds_cst_cd.AddRow();
		*/
		ds_cst_cd.ClearData();
		ds_cst_cd.AddRow();
		//견적에서 선택한 거래처로 세팅
		ds_cst_cd.SetColumn(0, "CST", cs301_cst);
		cb_cst.Index=0;
		
		ed_estno.Text = cs301_tem + "-" + cs301_rdt + "-" + cs301_seq + "-" + cs301_sir;
		est_flag = true; // 견적 조회로 가져올 경우 flag 셋팅
		
		gnd = 'D';
		cb_conkind.Value = gnd;
		
		fn_searchNamSpt();	//고객명 가져오기
		
		fn_estiQuery(); 	//선택한 견적정보를 조회하여 계약정보로 세팅한다.
		
	} else{
		return;
	}
	
}


/********************************************************************************
* 기      능   : 견적정보를 가져와서 계약정보로 세팅조회
********************************************************************************/
function fn_estiQuery()  //견적정보조회
{
	gfn_clearMsgBar();

	// sort mark 삭제
	gfn_clearGridSortMark(grd_list);
	ds_list.row = -1;
	ds_list.ClearData();

	ds_chkUms.ClearData();

	tit_clearActionInfo();
	tit_addSearchActionInfo("cs12:CS1201001B_S52", null, true);
	tit_addSearchActionInfo("cs12:CS1201001B_S56", null, true);
	tit_addSearchActionInfo("cs12:CS1201001B_S61", null, true);

	tit_callService(
        ""
        , ""
        , "ds_cond=ds_cond_est"
        , "ds_list=ds_list ds_lists=ds_lists ds_chkUms=ds_chkUms"
        , ""
        , "fn_afterQuery"
        , true
	);
}

function btn_upload_doc_OnClick(obj)
{
	if(ds_list.GetColumn(0, "PST") < "A5") {
		gfn_showAlert("저장 후 문서첨부가 가능합니다.");
		return false;
	}
	
	file_save_open();
}

/********************************************************************************
* 기      능   : 파일업로드 
********************************************************************************/
function file_save_open() {
	
	var a = "";  //문서관리번호 신규추가시 NULL , 수정시 저장된 해당 문서관리번호
	var b = "1"; //오더유형코드(1:정기보수, 2:수리공사, :부품판매)
	var c = "1"; //문서구문코드(1:계약서, 2:발주서, 3:계약변경합의서, 4:작업완료확인서, 5:추가약정서)

	if (length(ed_doc.Text) > 0) {
		a = ed_doc.Text;
	}
	
	var arg = "";
	arg = " fa_docno="+quote(a);
	arg = arg +" fa_oknno="+quote(b);
	arg = arg +" fa_dknno="+quote(c);
	
	var rtn_doc = gfn_openPopup2("CS9615001B", true , arg);
	trace("rtn_doc = " + rtn_doc); // return된 문서 관리번호를 저장하면 됨.
	
	if (rtn_doc<>'S' && length(ed_doc.Text)==0) {
		ed_doc.Text = rtn_doc;
		fn_doc_update();
	}	
}

// 결재번호 생성
function fn_docgen() {	
	ds_docno_gen.ClearData();									
	ds_docno_gen.AddRow();									
	ds_docno_gen.SetColumn(0,"PFX","H02");					// H01, H02 … R01, R02 …				
										
	tit_clearActionInfo();									
	tit_addSearchActionInfo("wb01:DOC_CODE_GEN_S1",true);									
	tit_addSearchActionInfo("wb01:DOC_CODE_GEN_U1");									
	tit_callService(		
			""
			, ""							
			, "ds_docno_gen_i=ds_docno_gen"							
			, "ds_docno_gen=ds_docno_gen_o"							
			, ""							
			, ""							
			, true							
			, false							
			, true); //동기화 방식으로 서비스를 콜한다.
}

/********************************************************************************
* 기      능   : 기안 
********************************************************************************/
function fn_draft() {

	if(ds_list.GetColumn(0, "PST") < "A5") {
		gfn_showAlert("저장 후 결재선 지정이 가능합니다.");
		return false;
	}

	//결재번호생성
	if (length(ds_list.GetColumn(0, "DNO")) < 1 && ds_list.GetColumn(0, "APSTAT") < "3") {
		fn_docgen();
		ed_docno.Text = ds_docno_gen.GetColumn(0, "DOCNO");		
	}

	if (length(ed_docno.Text) < 1) {
		alert("결재번호가 생성되지 않았습니다.");
		return false;
	}		

	// 협력업체의 부서정보가 "자회사"이면 기안동시 결재처리
	var vVkbur = gfn_getBsu(ds_list.GetColumn(0, "BSU"), "VKBUR");
	if (vVkbur == "H100"){
		if ( ds_list.rowCount() < 1 ) {
			// 저장할 정보 없음.
			gfn_showMsg("CW00010");
			return;
		}
		
		ds_wbap01.ClearData();
		ds_wbap02.ClearData();
		ds_wbap01.AddRow();
		ds_wbap01.SetColumn(0, "DOCNO"   , ed_docno.Text);
		ds_wbap01.SetColumn(0, "DOCKIND" , "4");
		
		ds_wbap02.AddRow();
		ds_wbap02.SetColumn(0, "DOCNO"   , ed_docno.Text);
		ds_wbap02.SetColumn(0, "DOCKIND" , "4");

		// 결재정보 공통함수
		gfn_setZwbap(ds_wbap01, ds_wbap02, false);
		// 결재번호 update
		fn_doc_update();		
		
		for (i = 0; i < ds_list.GetRowCount(); i++){
			if (toNumber(ds_list.GetColumn(i, "AMT")) > 0){
				ds_list.SetColumn(i, "DNO"   , ed_docno.Text);
				ds_list.SetColumn(i, "APSTAT", "6");
				ds_list.SetColumn(i, "CHK"   , "1");
			}
		}

		// 결재처리
		fn_save3();
		
	} else {
		
		var appgubn = "S";
		var dockind = "4";
		var docNo = ed_docno.Text;
		
		if (ds_list.GetColumn(0, "APSTAT") == "3") { 
			appgubn = "R";
		}
		//===============================================전결규정 저장으로 수정===============================================
		//var arg = "fa_docno=" + quote(docNo) + " fa_dockind=" + quote(dockind) + " fa_appgubn=" + quote(appgubn);
		var arg = "fa_docno=" + quote(docNo) + " fa_dockind=" + quote(dockind) + " fa_appgubn=" + quote(appgubn) + " fa_discrule=" + quote(ed_cof.Text);	
		//====================================================================================================================
		var rtn = gfn_openPopup2("CS0401001A", true, arg);
		
		if( rtn[0] == "S" ) {
			gfn_showMsg("CI00003", '전자결재문서번호:' + ed_docno.Text);
			div_btn.btn_draft.Enable = false;
			
			if (parseInt(ds_list.GetColumn(0, "APSTAT")) < 1) {	//기안처리시
				fn_doc_update();		
				fn_query();
			} else {
				fn_query();
			}
		} else {
			//if (parseInt(ds_list.getcolumn(0, "APSTAT")) < 1) {
			//	ed_docno.Text = "";
			//}
		//	gfn_showAlert("CE00001"); 
			gfn_showMsg("CE00001");
		}	
	}
}

/********************************************************************************
* 기      능   : 결재 15
********************************************************************************/
function fn_decide() {
	var decidertn;   // 결재 팝업 리턴코드

	gfn_clearMsgBar();
	if( ds_decide.rowCount() < 1 ) {
		// 승인할 정보 없음. 
		return;
	}

	//if( !gfn_showConfirm("CI00014", "문서번호 : "+ quote(ed_docno.Text)+ "결재") ) return;
	decidertn = gfn_showConfirm_decide("CI00014", "문서번호 : "+ quote(ed_docno.Text)+ "결재") ;	
	if(decidertn == "C") return; //A : 승인, C : 취소 , W : 의견승인

	//----------------------------------------------------------------------
	// 의견 입력 팝업 추가 
	// f팝업 전달 변수 fa_docno : 문서번호 ,fa_dockind : 문서종류 
	// return 값 : rtn_yn (Y:의견입력됨 N:의견입력안됨)
	
	//if(gfn_showConfirm("CW10025","의견을 입력하시겠습니까?"))
	if( decidertn == "W" )    //의견입력 승인시
	{
		var arg = "";
		arg = " fa_docno=" + quote(ds_decide.GetColumn(0,"DOCNO")) +" fa_dockind=" + quote(ds_decide.GetColumn(0,"DOCKIND"));
		var rtn_yn = gfn_openPopup2("CS0401001C", true , arg);
	}
	//alert("rtn_yn:"+rtn_yn);
	// 의견입력 팝업 종료
	//----------------------------------------------------------------------	

	// 결재상태변경
	ds_decide.SetColumn(0, "SEQSTAT", "3");
	ds_decide.SetColumn(0, "UPN", ed_upn.Text);
	ds_decide.SetColumn(0, "CST", cb_cst.Value);
	
	if(ed_upn.Text == "" && cb_cst.Value = "") {
		alert("결재 진행을 취소합니다. 정보기술부에 문의주세요.");
		return false;
	}
	
	ds_doc_status_add.ClearData();
	
	tit_clearActionInfo();
	//결재자 저장
 	tit_addMultiActionInfo("cs04:CS0401002A_U2");  // ZWBAP02 
 	tit_addMultiActionInfo("cs04:CS0401002A_U3");	// ZWBAP01
 	//tit_addMultiActionInfo("cs04:CS0401002A_U5"); //내부결재처리    >> 일부 수신 부서 결재 완료 처리 위해 사용 안함 201610
	tit_addSearchActionInfo("wb01:DOC_STATUS");//결재처리후 결재진행상태 확인 
	tit_addSearchActionInfo("cs12:CS1201001B_S59");//결재완료 시점 여부 판단 위한 계약정보 GET 20161006
	
	tit_callService(
		""
		, ""
		, "ds_list_0=ds_decide ds_cond=ds_decide"
		, "ds_doc_status=ds_doc_status ds_doc_status_add=ds_doc_status_add"
		, ""
		, "fn_afterDecide"
		, true
		, false
		, true);
}

/********************************************************************************
* 기      능   : 반송 65
********************************************************************************/
function fn_sendback() {
	var decidertn;   // 결재 팝업 리턴코드
	
	gfn_clearMsgBar();
	
	if( ds_decide.rowCount() < 1 ) {
		// 반송할 정보 없음. 
		return;
	}

	//if(!gfn_showConfirm("CI00014", "문서번호 : "+ quote(ed_docno.Text) + "반송")) return;
	decidertn = gfn_showConfirm_decide("CI00014", "문서번호 : "+ quote(ed_docno.Text) + "반송") ;	
	if(decidertn == "C") return; //A : 승인, C : 취소 , W : 의견승인
	
	//----------------------------------------------------------------------
	// 의견 입력 팝업 추가 
	// f팝업 전달 변수 fa_docno : 문서번호 ,fa_dockind : 문서종류 
	// return 값 : rtn_yn (Y:의견입력됨 N:의견입력안됨)
	
	//if(gfn_showConfirm("CW10025","의견을 입력하시겠습니까?"))
	if( decidertn == "W" )    //의견입력 승인시
	{
		var arg = "";
		arg = " fa_docno=" + quote(ds_decide.GetColumn(0,"DOCNO")) +" fa_dockind=" + quote(ds_decide.GetColumn(0,"DOCKIND")) +" sendbackClick=" + quote('Y');
		var rtn_yn = gfn_openPopup2("CS0401001C", true , arg);
		
		if( (rtn_yn == 'N' || rtn_yn == '') && (ds_decide.GetColumn(0,"DOCKIND") == '4' || ds_decide.GetColumn(0,"DOCKIND") == '13') ) { // 정기보수계약 및 수리공사계약의 경우 반송사유 입력창에서 닫기버튼을 눌렀을때 리턴시킴.
			gfn_showAlert("정기보수계약의 경우 반송사유 입력을 확인해주시기 바랍니다.");
			return;
		}
	} else {
		if(ds_decide.GetColumn(0,"DOCKIND") == '4' || ds_decide.GetColumn(0,"DOCKIND") == '13') { 
		// 정기보수계약 및 수리공사계약의 경우 반송사유 필수입력
		// 2019.04.11 전략마케팅 조성인 DL 요청
			gfn_showAlert("정기보수계약의 경우 반송사유 입력을 확인해주시기 바랍니다.");
			return;
		}
	}
	//alert("rtn_yn:"+rtn_yn);
	// 의견입력 팝업 종료
	//----------------------------------------------------------------------	
	
	// 결재상태변경
	ds_decide.SetColumn(0, "SEQSTAT", "2");
	
	tit_clearActionInfo();
	//결재자 저장
 	tit_addMultiActionInfo("cs04:CS0401002A_U2");
 	tit_addMultiActionInfo("cs04:CS0401002A_U3");
 	//결재처리후 결재진행상태 확인 
 	tit_addSearchActionInfo("wb01:DOC_STATUS");
	
	tit_callService(
		""
		, ""
		, "ds_list_0=ds_decide ds_cond=ds_decide"
		, "ds_doc_status=ds_doc_status"
		, ""
		, "fn_afterSendback"
		, true);
}

/********************************************************************************
* 기      능   : 결재, 반송  Callback
********************************************************************************/
function fn_afterDecide(errCode, errMsg) {
	if ( errCode!= 0 ) {
		gfn_showMsg("CE00001");
	} else {
		gfn_showMsg("CI00003");
		div_btn.btn_decide.Enable = false;		// 결재버튼
		div_btn.btn_draft.Enable  = false;		// 기안버튼
	//	div_btn.btn_print.Enable  = false;		// 출력버튼
		div_btn.btn_sendback.Enable = false; 	// 반송버튼	
		
		
		var gyb = ds_list.GetColumn(0, "GYB");	           //자동계약여부
		var apstat = ds_doc_status_add.GetColumn(0, "APSTAT"); //결재문서 상태
		var apText = ed_cof.Text;                          //전결
		var chk_gkd  = ds_doc_status_add.GetColumn(0,"CHK_GKD");  //전환,회수계약의 경우 수신부서 결재완료
		var chk_fm   = ds_doc_status_add.GetColumn(0,"CHK_FM");   //POG TO FM 경우 수신부서 결재완료
		var chk_hrts = ds_doc_status_add.GetColumn(0,"CHK_HRTS"); //갱신 HRTS 전환인 경우 수신부서 결재완료
		var gbn_hno = substr( ds_list.GetColumn(0, "HNO"),0 ,1 );
		var chk_total = chk_gkd + chk_fm + chk_hrts ;
		/*
		chk_total == 0  기안부서 내 결재완료 처리
		chk_total > 0   수신부서 결재완료 처리
		*/
		
		// ******  계약 승인 처리 ******  //  
		// 기안결재 완료 + chk_total == 0 
		// 수신결재완료
		// 기안결재 완료 + 자동계약 
		// psd 인 경우 기안결재 완료
		
		// ******  계약 승인 처리 20180221 ******  //  
		// 모든 문서 수신 부서 에서 최종 승인 처리  20180221 이하림 
		

//		if ( (apstat == "3" && chk_total == 0) || apstat=="6" || (apstat=="3" && gyb=="Y")  || (apstat=="3" && gbn_hno =="G")  ) { 

        //======이준석 책임 요청으로  직영은 기안결재 완료시 최종처리 되도록 변경======
		var chk_gbu = ds_list.GetColumn(0, "GBU") ; //직영1, 협력3
		if( chk_gbu == "1" && apstat == "3" )  apstat = "6";		
		      //====이준석 책임 요청 (협력 + 분담이행) 인경우 기안결재로 최종완료===2021.03.18
		var chk_gbu2 = ds_list.GetColumn(0, "BDGBN") ;
		if( chk_gbu == "3" && chk_gbu2 == "1" && apstat == "3" )  apstat = "6";	
		
	    //===================================변경 끝===================================
		if ( apstat=="6") { 

			tit_clearActionInfo();
			tit_addMultiActionInfo("cs04:CS0401002A_U4"); //수신결재완료 상태로 변경 zwbap01
			tit_callService( 
				  ""
				, ""
				, "ds_list_0=ds_decide" 
				, ""
				, ""
				, ""
				, true
				, true);

			gfn_clearMsgBar();
			/*
			전자결재 변경으로 자동승인 처리를 하기 위해 조회결과 모두 선택처리후 승인처리를 함 2015.01
			*/
	
				
			//승인대상 조회
			//fn_query3();	//fn_query로 통합하여 불필요.
			
			for(var i=0; i<ds_list.RowCount(); i++) {
				ds_list.SetColumn(i, "CHK", "1");
			}
			alert("최종 결재가 완료되어 해당 계약의 승인처리를 합니다.");			
			fn_save3();

			/*
			전자결재 변경으로 자동승인 처리를 하기 위해 조회결과 모두 선택처리후 승인처리를 함 2015.01
			*/

		} else {
			fn_query();
		}	
	}
}

/********************************************************************************
* 기      능   : 결재, 반송  Callback
********************************************************************************/
function fn_afterSendBack(errCode, errMsg) {
	if ( errCode!= 0 ) {
		gfn_showMsg("CE00001");
	} else {
		gfn_showMsg("CI00003");
		div_btn.btn_decide.Enable = false;		// 결재버튼
		div_btn.btn_draft.Enable  = false;		// 기안버튼
	//	div_btn.btn_print.Enable  = false;		// 출력버튼
		div_btn.btn_sendback.Enable = false; 	// 반송버튼	
	}
	
	if (ds_doc_status.GetColumn(0,"APSTAT") == "2" || ds_doc_status.GetColumn(0,"APSTAT") == "5") {
		//반송 후처리..
		//사용자가 처리하도록 함...
	}
}

//견적을 통해 생성한 계약의 경우 기간별 금액을 볼 수 있다.
function btn_cont_period_OnClick(obj)
{
	var arg = "caller=cont";

	gfn_openPopup("CS1240001H", true, arg);	
}


/********************************************************************************
* 기      능   : 견적 등록을 위한 연차별 일자 및 금액 계획 
********************************************************************************/
function fn_make_period() {
	// 계약 개시년 수주 개월수 체크
	var chk_ums   = parseInt(ds_chkUms.GetColumn(0, "CHK_UMS"));   // 기준년도 기 수주개월
	var eseq1_ums = parseInt(ds_chkUms.GetColumn(0, "ESEQ1_UMS")); // 견적 전체 개월 수
	var min_ums   = parseInt(ds_chkUms.GetColumn(0, "MINUS_UMS")); 
	
	P_UMS = 0;	
	
	//======================================================================================================================================
	// 견적을 통한 기간 생성시 자회사이면 수주보전 개월수 적용하지 않음. 무조건 12개월씩 연장. 20200612 Han JH
	if (bf_vVkbur != "H100" && vVkbur == "H100"){ // 이전계약이 모회사이고 현계약이 자회사인 경우 수주보전 하지 않음
	// 자회사 수주보전 안함
	//if (vVkbur == "H100") { // 이관(ZCST157) 데이터의 정합성 문제로 이관전 보수협력사의 값이 부정확 할 시 사용.
		if(eseq1_ums >= 12) {
			P_UMS = 12 ;
		} else {
			P_UMS = eseq1_ums ;
		}
	} else {
		if(eseq1_ums >= 12) {
			if(chk_ums + min_ums < 0) {
				P_UMS = Abs( chk_ums + min_ums ) ;
			} else if (chk_ums + min_ums == 0) {
				P_UMS = 12 ;
			} else {
				P_UMS = 12 - chk_ums ;
			}
		} else { // 12개월 미만 견적의 경우 
			if(chk_ums + min_ums < 0) {
				P_UMS = Abs(chk_ums + min_ums);
			} else {
				if(12 - (chk_ums + eseq1_ums) < 0) {
					P_UMS = 12 - chk_ums ;
				} else {
					P_UMS = eseq1_ums ;
				}
			}
		}	
	}
	//======================================================================================================================================

	ds_detail_pri.ClearData();
	if( chk_ums + min_ums < 0 && chk_ums + eseq1_ums < 12 ){
		//fn_get_cont_period()  ; // 1년차 수주 12개월 미초과 시 기존 계획 사용 == >> 보완 
		fn_get_cont_period2(P_UMS) ;
	} else {
		fn_get_cont_period2(P_UMS) ; // 1년차 수주 12개월 초과하는 경우 연차별 계획 재생성
	}
}
/********************************************************************************
* 기      능   : 년차 수주 12개월 초과하는 경우 연차별 계획 재생성 20161012
********************************************************************************/
function fn_get_cont_period2(P_UMS) {
	var nrow = 0;
	var toDt = ds_chkUms.GetColumn(0, "ETD")  ;
	var prDt ;
	if(P_UMS == 0) {
		prDt = ds_chkUms.GetColumn(0, "ETD")  ;
	} else {
		prDt = AddDate(AddMonth(ds_chkUms.GetColumn(0, "STD"), P_UMS),-1);
	}
		
	var fromDt = ds_chkUms.GetColumn(0, "STD");
	var tot = ds_list.GetColumn(0, "AMT");
	
	if(parseInt(toDt) <= parseInt(prDt)){
		ds_detail_pri.AddRow();
		ds_detail_pri.SetColumn(nrow, "SEQ2", 1);
		ds_detail_pri.SetColumn(nrow, "STD", fromDt);
		ds_detail_pri.SetColumn(nrow, "ETD", toDt);
		//ds_detail_pri.SetColumn(nrow, "ETD", prDt);
		ds_detail_pri.SetColumn(nrow, "TOT", tot);
		ds_detail_pri.SetColumn(nrow, "MON", gfn_getMonthCnt(fromDt,toDt));
	} else {
		while(parseInt(toDt) > parseInt(prDt)){
			ds_detail_pri.AddRow();
			ds_detail_pri.SetColumn(nrow, "SEQ2", nrow+1);
			ds_detail_pri.SetColumn(nrow, "STD", fromDt);
			ds_detail_pri.SetColumn(nrow, "ETD", prDt);
			ds_detail_pri.SetColumn(nrow, "TOT", tot);
			ds_detail_pri.SetColumn(nrow, "MON", gfn_getMonthCnt(fromDt,prDt));
			fromDt = AddDate(prDt,1);
			prDt = AddDate(AddMonth(fromDt,12),-1);
			nrow++;
		}
		
		if(parseInt(toDt) <= parseInt(prDt)){
			ds_detail_pri.AddRow();
			ds_detail_pri.SetColumn(nrow, "SEQ2", nrow+1);
			ds_detail_pri.SetColumn(nrow, "STD", fromDt);
			ds_detail_pri.SetColumn(nrow, "ETD", toDt);
			ds_detail_pri.SetColumn(nrow, "TOT", tot);
			ds_detail_pri.SetColumn(nrow, "MON", gfn_getMonthCnt(fromDt,toDt));
		}
	}
	
	// ds_list 변경
	for(var i=0 ; i < ds_list.rowcount; i++){
		ds_list.SetColumn(i, "UGS", ds_detail_pri.GetColumn(0,"STD")) ;
		ds_list.SetColumn(i, "UMR", ds_detail_pri.GetColumn(0,"ETD")) ;
	}
	// ds_lists 변경
	for(var i=0 ; i < ds_lists.rowcount; i++){
		ds_lists.SetColumn(i, "SFR", ds_detail_pri.GetColumn(0,"STD")) ;
		ds_lists.SetColumn(i, "STO", ds_detail_pri.GetColumn(0,"ETD")) ;	
		ds_lists.SetColumn(i, "SYO", gfn_getMonthCnt(ds_detail_pri.GetColumn(0,"STD"),ds_detail_pri.GetColumn(0,"ETD"))); 
		ds_lists.SetColumn(i, "UYO", gfn_getMonthCnt(ds_detail_pri.GetColumn(0,"STD"),ds_detail_pri.GetColumn(0,"ETD"))); 
	}
	
	//2019.03.29
	//온핸드 현장 체크를 위해 데이터셋 복사
	//연차별 계약 셋팅하기 전에 데이터셋 카피하는 경우 이전 시작일로 체크되는 오류가 있어 수정. Han JH
	gfn_copyDs(ds_list, ds_list_copy);

	fn_after_get_cont_period();
}
/********************************************************************************
* 기      능   : 견적에서 기간별 계약상세 금액정보를 가지고 온다.
********************************************************************************/
function fn_get_cont_period() {
	var arrEstno = split(ds_list.GetColumn(0, "SIR") , "-"); //견적번호+차수
	
	ds_cond_est.SetColumn(0, "UPN", ds_list.GetColumn(0, "UPN"));
	ds_cond_est.SetColumn(0, "CST", ds_list.GetColumn(0, "CST"));
	ds_cond_est.SetColumn(0, "TEM", arrEstno[0]);
	ds_cond_est.SetColumn(0, "RDT", arrEstno[1]);
	ds_cond_est.SetColumn(0, "SEQ", arrEstno[2]);
	ds_cond_est.SetColumn(0, "SIR", arrEstno[3]);
		
	tit_clearActionInfo();
	tit_addSearchActionInfo("cs12:CS1240001B_S18");	
	tit_callService(
		""
		, ""
		, "ds_cond=ds_cond_est"
		, "ds_detail_pri=ds_detail_pri"
		, ""
		, "fn_after_get_cont_period()"
		, true
		, true);
}

function fn_after_get_cont_period() {
	btn_cont_period.Text = "계약연차별상세" + "(" + ds_detail_pri.RowCount() + ")";
	if(est_flag == true) {
		btn_cont_period.Visible=true;
	}
}

//전자결재번호, 문서관리번호 저장
function fn_doc_update() {
	trace("#fn_doc_update()#");
	
	ds_list.FireEvent = false;
	
	var rowCnt = ds_list.RowCount();
	
	//컬럼이 없는 경우를 위해 추가
	ds_list.AddColumn("DNO");
	ds_list.AddColumn("DOC");
	ds_doc_update.ClearData();
	//프로젝트 호기정보를 모두 입력하지 않은 케이스가 있음. 해당 건들은 프로젝트에 left outter join 되어 있음.
	//seq가 있는 것은 계약정보 저장된 건임
	for(var i=0; i<rowCnt; i++) {
		if (length(ds_list.getcolumn(i, "SEQ"))<>0) {
			var nRow = ds_doc_update.AddRow();
			ds_doc_update.SetColumn(nRow, "UPN", ds_list.GetColumn(i, "UPN"));
			ds_doc_update.SetColumn(nRow, "CST", ds_list.GetColumn(i, "CST"));
			ds_doc_update.SetColumn(nRow, "PJT", ds_list.GetColumn(i, "PJT"));
			ds_doc_update.SetColumn(nRow, "HNO", ds_list.GetColumn(i, "HNO"));
			ds_doc_update.SetColumn(nRow, "SEQ", ds_list.GetColumn(i, "SEQ"));
			ds_doc_update.SetColumn(nRow, "DNO", ed_docno.Text);	//전자결재번호
			ds_doc_update.SetColumn(nRow, "DOC", ed_doc.Text);	//문서관리번호
			ds_list.SetColumn(nRow, "DNO", ed_docno.Text);	//전자결재번호
			ds_list.SetColumn(nRow, "DOC", ed_doc.Text);	//문서관리번호
			
		}
	}
			
	ds_list.FireEvent = true;
	
	tit_clearActionInfo();
	tit_addMultiActionInfo("cs12:CS1201001B_U28");
	tit_callService(
		""
		, ""
		, "ds_list=ds_doc_update"
		, "" 
		, "" 
		, ""	//fn_query
		, true
		, false
		, true);
		
}

/********************************************************************************
* 기      능   : 결재 문서 확인 상세
********************************************************************************/		
function fn_reqDoc() {
	trace("#fn_reqDoc()#");
	//trace(ds_cond_req.SaveXML());
	tit_clearActionInfo();
	tit_addSearchActionInfo("cs12:CS1201001B_S53");	//결재번호로 계약정보 가지고 오기
	//tit_addSearchActionInfo("wb01:APP_STATUS");	//결재자정보조회
	tit_callService(
	""
	, ""
	, "ds_cond_req=ds_cond_req"	//, "ds_cond_req=ds_cond_req ds_cond=ds_cond_req"
	, "ds_list_req=ds_list_req"	//, "ds_list_req=ds_list_req ds_decide=ds_decide"
	, ""
	, ""
	, true
	, true
	, true);	
	
	if (ds_list_req.rowcount>0) {
		upn = ds_list_req.GetColumn(0, "UPN");
		cst = ds_list_req.GetColumn(0, "CST"); 
	//	nam = ds_list_req.GetColumn(0, "NAM"); 
	//	spt = ds_list_req.GetColumn(0, "SPT"); 
		gnd = ds_list_req.GetColumn(0, "GND");
		usd = ds_list_req.GetColumn(0, "USD"); 
		uhj = ds_list_req.GetColumn(0, "UHJ"); 
		gno = ds_list_req.GetColumn(0, "GNO");
		return true;
	} else {
		alert("결재정보가 없습니다.");
		fn_close();
	}		
}	

function fn_afterReqDoc() {
	if (ds_list_req.rowcount>0) {
		upn = ds_list_req.GetColumn(0, "UPN");
		cst = ds_list_req.GetColumn(0, "CST"); 
	//	nam = ds_list_req.GetColumn(0, "NAM"); 
	//	spt = ds_list_req.GetColumn(0, "SPT"); 
		gnd = ds_list_req.GetColumn(0, "GND");
		usd = ds_list_req.GetColumn(0, "USD"); 
		uhj = ds_list_req.GetColumn(0, "UHJ"); 
		gno = ds_list_req.GetColumn(0, "GNO");
		return true;
	} else {
		alert("결재정보가 없습니다.");
		fn_close();
	}			
}

/********************************************************************************
* 기      능   : 결재자정보가져오기
********************************************************************************/
function fn_get_app_status() {
//	trace("###fn_get_app_status#");
	
	ds_cond.setColumn(0, "DOCNO", ed_docno.Text);

	tit_clearActionInfo();
	tit_addSearchActionInfo("wb01:APP_STATUS");		//결재자조회
	tit_callService(
		""
		, ""
		, "ds_cond=ds_cond"
		, "ds_decide=ds_decide"
		, ""
		, ""
		, true
		, false
		, true);	
}

//견적에서 계약을 가지고 온 경우 계약기간 상세 만큼 계약을 추가 생성한다.
// 연차별 정기보수 계약정보 및 시행율 저장
// 연차별 인원상주 계약정보 및 시행율 저장 201601 이하림
function fn_saveFromEstNo() {
	trace("#################################################");
	//trace(ds_detail_pri.RowCount()); 
	//trace(ds_list.RowCount());
	trace("#################################################");
	trace("1차년도 저장후");
	//trace(ds_list.SaveXml());
	//첫해 계약정보는 이미 저장했음. 2년차 부터 처리
	if (ds_detail_pri.RowCount()>1) { 

		ds_list.fireevent=false;
	
		for (var i=0; i<ds_detail_pri.RowCount(); i++) {
			// 2년차 부터 계약정보 및 시행율 저장
			if (ds_detail_pri.GetColumn(i, "SEQ2")>1) {
			
				var std = ds_detail_pri.GetColumn(i, "STD");	//계약시작일
				var etd = ds_detail_pri.GetColumn(i, "ETD");	//계약종료일
				var seq2 = ds_detail_pri.GetColumn(i, "SEQ2");	//계약연차
				var mon = ds_detail_pri.GetColumn(i, "MON");	//계약연차
				
				// 연차별 호기 리스트 셋팅
				for (var j=0; j<ds_list.RowCount(); j++) {
					ds_list.SetColumn(j, "USD", std);	//계약개시일
					ds_list.SetColumn(j, "UGS", std);	//유상보수개시일
					ds_list.SetColumn(j, "UMR", etd); 	//유상보수만기일
					ds_list.SetColumn(j, "UHJ", etd);	//유상보수해지일
					ds_list.SetColumn(j, "UMS", gfn_getMonthCnt(ds_list.GetColumn(j, "UGS"),ds_list.GetColumn(j, "UMR")));
					ds_list.SetColumn(j, "MMN", 0); //무상개월
					ds_list.SetColumn(j, "DNO", ed_docno.Text); //결재번호
					ds_list.SetColumn(j, "CFG", ""); // 최초 계약서 여부 , 1년차 값이 Y로 들어간 경우 2년차부터 초기화
					ds_list.SetColumn(j, "FHG", ""); // 최초 HRTS
					ds_list.SetColumn(j, "FDG", ""); // 최초 DIPBX
					ds_list.SetColumn(j, "FFG", ""); // 최초 FM
					//ds_list.SetColumn(j, "GKD", "2"); // 계약구분 갱신
				
					//FM년도
					if ( length(ds_list.GetColumn(j, "FMY")) > 0 ) {
						ds_list.SetColumn(j, "FMS", LPAD(seq2, "0", 2));
					}
					//장기계약 연도
					if ( length(ds_list.GetColumn(j, "LTY")) > 0 ) {
						ds_list.SetColumn(j, "LTS", LPAD(seq2, "0", 2));
					}			
				}
				// 연차별 인원상주 계약 리스트 셋팅 201601 이하림
				for (var j=0; j<ds_lists.RowCount(); j++) {
					ds_lists.SetColumn(j, "SFR", std);	
					ds_lists.SetColumn(j, "STO", etd);	
					var jseq = parseInt(ds_lists.GetColumn(j, "SEQ")) ;
					jseq = jseq + 1 ;
					//ds_lists.SetColumn(j, "SEQ", LPAD(jseq, "0", 2));	
					//=======================2019.08.08 SEQ 정합성 문제로 인한 변경============================
					ds_lists.SetColumn(j, "SEQ", LPAD(jseq, "0", 4));	
					//=========================================================================================
					ds_lists.SetColumn(j, "SYO", gfn_getMonthCnt(ds_lists.GetColumn(j, "SFR"),ds_lists.GetColumn(j, "STO"))); 	//
					ds_lists.SetColumn(j, "UYO", gfn_getMonthCnt(ds_lists.GetColumn(j, "SFR"),ds_lists.GetColumn(j, "STO")));	//	
				}
				trace(seq2 + "차년도 변경후 후");
				//trace(ds_lists.SaveXml());
				
				ds_cost_sum_cnt = 0;
			
				tit_callService(
					"CS1201001B_ACT"
					, "save"
					, "ds_gbn=ds_gbn ds_list=ds_list ds_lists=ds_lists"
					, ""
					, ""
					, "" 		//fn_afterSave
					, true		//isErrorNotCall
					, false		//isNotShow 
					, true		//isSync	
				);	
				
				// 호기별 원가 저장 DATASET 인덱스 초기화
				// 연차별 시행율 계산
				fn_saveCost();
			}
		}		
		ds_list.fireevent=true;
	}
}

//fn_searchGrp 수정 : after처리 제거
function fn_searchGrp() {
	gfn_initDs(ds_cond_grp, true);
	ds_cond_grp.setColumn(0, "UPN", ed_upn.value);
	ds_cond_grp.setColumn(0, "CST", cb_cst.value);

	//그룹계약번호 SELECT
	tit_clearActionInfo();
	tit_addSearchActionInfo("cs12:CS1201001B_S27", null, true);
	tit_callService(
		""
		, ""
		, "ds_cond=ds_cond_grp"
		, "ds_grp_cd=ds_list"
		, ""
		, ""						
		, true
		, false
		, true); 

	cb_grp.SetFocus();
}

//fn_queryTvr 수정 : 계약번호 대신, UPN CST DOCNO로 변경
function fn_queryTvr() {
	gfn_initDs(ds_cond_tvr, true);
	gfn_initDs(ds_cond_cnt, true);
	//ds_cond_tvr.setColumn(0, "GNO", gno);

	ds_cond_tvr.setColumn(0, "UPN", ed_upn.value);
	ds_cond_tvr.setColumn(0, "CST", cb_cst.value);
	ds_cond_tvr.setColumn(0, "DOCNO", ed_docno.Text);
	//ds_cond_cnt.setColumn(0, "GNO", gno);
	ds_cond_cnt.setColumn(0, "UPN", ed_upn.value);
	ds_cond_cnt.setColumn(0, "CST", cb_cst.value);
	ds_cond_cnt.setColumn(0, "DOCNO", ed_docno.Text);
	
	tit_clearActionInfo();
	tit_addSearchActionInfo("cs12:CS1201001B_S48", null, true);
	tit_addSearchActionInfo("cs12:CS1201001B_S49", null, true);
	tit_callService(
		""
		, ""
		, "ds_cond=ds_cond_tvr ds_cond=ds_cond_cnt"
		, "ds_tvr=ds_tvr ds_cnt=ds_cnt"
		, ""
		, ""
        , true
        , false
        , true);	//동기식으로 변경. 2015.01
}


//시행율 계산
function fn_saveCost() {
	gfn_clearMsgBar();

	if ( ds_list.rowCount() < 1 ) {
		// 저장할 정보 없음.
		gfn_showMsg("CW00010");
		return;
	}

/*
	if(ds_list.FindRow("CHK", 1) == -1) {
		gfn_showMsg("CW00013");
		return;
	}
*/	

	fn_queryTvr();

	ds_cost_o.ClearData();
	ds_cost_sum.ClearData();
				
	for(var i=0; i<ds_list.RowCount(); i++) {
		
		//if(ds_list.GetColumn(i, "CHK") == true) { //체크박스가 true 일 경우
		
		var seq = ds_list.getcolumn(i, "SEQ");
		var sir = ds_list.getcolumn(i, "SIR");
		var ltc = ds_list.getcolumn(i, "LTC");
		var lts = ds_list.getcolumn(i, "LTS");
		
		trace("# i = " + i + ", seq="+seq+", sir="+sir+", ltc="+ltc+", lts="+lts+", length(seq)="+length(seq)+", length(sir)="+length(sir));
		if (
		 length(sir) > 0 && ( (ltc == "1" && lts == "01") || (ltc == "0") ) 
		) {
			trace("$$$$$$");
		}
		
		
		trace("### i="+i);
		var t_mon_fm, t_mon_to, s_ums;
		t_mon_fm = ds_list.GetColumn(i, "RGS");
		t_mon_to = ds_list.GetColumn(i, "RMR");
		s_ums = parseInt(gfn_getMonthCnt(t_mon_fm, t_mon_to));
	

		//s_grp:팀, s_bgb:직영구분, s_knd:계약상품, s_spc:기종, s_flr:층수
		//s_spd:속도, s_hno:호기, s_bld:건물용도, s_fdt:설치연령, s_hep:점검주기
		//s_ums:수주개월수, s_amt:매출액, s_abg:아파트빌딩구분, s_fms:FM계약차수, s_hwr:유무선구분
		//s_fhg:HRTS최초여부, s_hyn:HRTS여부, s_tvr:감시반구분, s_cnt:계약대수(EL), s_dnd:DI-PBX종류
		//s_acd:특성코드, s_acnd:공기청정기종류
		var s_grp, s_bgb, s_knd, s_spc, s_flr;
		var s_spd, s_hno, s_bld, s_fdt, s_hep;
		var s_amt, s_abg, s_fms, s_hwr, s_fhg;
		var s_hyn, s_tvr, s_cnt, s_dnd, s_acd;
		var s_acnd;

		s_grp = ds_list.GetColumn(i, "VKGRP");
		s_bgb = ds_list.GetColumn(i, "BSUGB");
		s_knd = ds_list.GetColumn(i, "KND");
		s_spc = ds_list.GetColumn(i, "ZSPEC12");
		s_flr = ds_list.GetColumn(i, "ZSPEC7");
		s_spd = ds_list.GetColumn(i, "ZSPEC3");
		s_hno = ds_list.GetColumn(i, "HNO");
		s_bld = ds_list.GetColumn(i, "BLD");
		s_fdt = ds_list.GetColumn(i, "FDT");
		s_hep = ds_list.GetColumn(i, "HEP");
		//s_ums = ds_list.GetColumn(i, "UMS");
		s_amt = ds_list.GetColumn(i, "AMT");
		s_ambt = ds_list.GetColumn(i, "AMBT");
		s_abg = ds_list.GetColumn(i, "ABG");
		s_fms = ds_list.GetColumn(i, "FMS");
		s_hwr = ds_list.GetColumn(i, "HWR");
		s_fhg = ds_list.GetColumn(i, "FHG");
		s_hyn = ds_list.GetColumn(i, "HYN");
		s_tvr = ds_tvr.GetColumn(0, "TVR");
		s_cnt = ds_cnt.GetColumn(0, "CNT");
		s_dnd = ds_list.GetColumn(i, "DND");
		s_acd = ds_list.GetColumn(i, "ACD");
		s_acnd = ds_list.GetColumn(i, "ACND");
		
//		trace("fn_CalRat2(i="+i+", s_grp="+s_grp+", s_bgb="+s_bgb+", s_knd="+s_knd+", s_spc="+s_spc+", s_flr="+s_flr+", "+
//			  "s_spd="+s_spd+", s_hno="+s_hno+", s_bld="+s_bld+", s_fdt="+s_fdt+", s_hep="+s_hep+", "+
//			  "s_ums="+s_ums+", s_amt="+s_amt+", s_abg="+s_abg+", s_fms="+s_fms+", s_hwr="+s_hwr+","+
//			  "s_fhg="+s_fhg+", s_hyn="+s_hyn+", s_tvr="+s_tvr+", s_cnt="+s_cnt+", s_dnd="+s_dnd+","+
//			  "s_acd="+s_acd);
		//시행율 계산		
//		fn_CalRat2(i, s_grp, s_bgb, s_knd, s_spc, s_flr, 
//				  s_spd, s_hno, s_bld, s_fdt, s_hep, 
//				  s_ums, s_amt, s_abg, s_fms, s_hwr,
//				  s_fhg, s_hyn, s_tvr, s_cnt, s_dnd,
//				  s_acd);
			          
		
	}

	
	ds_costT.ClearData();
	ds_cond.SetColumn(0,"PGMID","ContractRat");	
	ds_cond.SetColumn(0, "T_UGS",ds_list.GetColumn(0, "UGS"));	

	tit_callService(
        "CS1299001A_ACT"
        , "getSujuRat"
        , "ds_cond=ds_cond"
        , "ds_costT=ds_list"
        , ""
        , ""						
			, true							
			, false							
			, true );	



//	fn_incentiveCal(); // 201706 삭제 예정
	
	if(ds_lists.rowcount() > 0){
	// 201706 삭제 예정
//		fn_sangjuCal(); // 인원상주 견적 인 경우 시행율 산출 201601 이하림
	}

	// zcst128 유상계약번호 미리 생성해서 시행율데이타 생성 201504 이하림
	// 시행율 자료 생성할 때 주차의 경우 row가 없으므로 ds_cost의 금액에 ''값으로 입력되어
	// zcst128 insert 시 오류발생함. 그램서 ds_costT가 없는 경우  생성안하도록 변경  2020.01.22 김종남(feat 방기태)
	if (ds_costT.GetRowCount() > 0){
		var t_gno = "";
		t_gno = ds_list.getColumn(0, "UPN") + 
							"U" + 
							substr(ds_list.getColumn(0, "UGS"),2,4) + 
							"-" + 
							ds_list.getColumn(0, "CST");
		
		ds_cost.setColumn(0, "GNO", t_gno);		
		ds_cost.SetColumn(0, "ZYEAR", substr(ds_list.GetColumn(0, "UGS"),0,4));
		ds_cost.SetColumn(0, "NMT",  toNumber(ds_costT.GetColumn(0,"G_NMT"))); // 노무비
		ds_cost.SetColumn(0, "JMT",  toNumber(ds_costT.GetColumn(0,"G_JMT"))); // 자재비
		ds_cost.SetColumn(0, "KMT",  toNumber(ds_costT.GetColumn(0,"G_KMT"))); // 직접경비
		ds_cost.SetColumn(0, "HMT",  toNumber(ds_costT.GetColumn(0,"G_HMT"))); // HRTS
		//===========================공기청정기 추가 20200515 Han.JH============================
		ds_cost.SetColumn(0, "ACMT",  toNumber(ds_costT.GetColumn(0,"G_ACMT"))); // 공기청정기
		//======================================================================================
		ds_cost.SetColumn(0, "DMT",  toNumber(ds_costT.GetColumn(0,"G_DMT"))); // DI-PBX
		ds_cost.SetColumn(0, "CMT",  toNumber(ds_costT.GetColumn(0,"G_CMT"))); // 검사수수료
		ds_cost.SetColumn(0, "GMT",  toNumber(ds_costT.GetColumn(0,"G_GMT"))); // 간접비
		ds_cost.SetColumn(0, "COST", toNumber(ds_costT.GetColumn(0,"G_COS"))); // 원가(직접비+간접비)
		ds_cost.SetColumn(0, "RAT",  toNumber(ds_costT.GetColumn(0,"G_RAT"))); // 
		ds_cost.SetColumn(0, "INC",  toNumber(ds_costT.GetColumn(0,"G_INC"))); // 인센티브
		ds_cost.SetColumn(0, "SJT",  toNumber(ds_costT.GetColumn(0,"G_SJT"))); // 인원상주비
	
		tit_clearActionInfo();
		tit_addSearchActionInfo("cs12:CS1201001B_I6");	
		tit_callService(
			""
			, ""
			, "ds_cost=ds_cost"
			, ""
			, ""
			, ""
			, false
			, false
			, true);
     }
	// tit_callService(
        // "CS1201001B_ACT"
        // , "saveCost"
        // , "ds_list=ds_list ds_cost=ds_cost"
        // , ""
        // , ""
        // , "fn_query"
        // , false
        // , false
        // , true);
        
}
function fn_sangjuCal() {
	var m_amt    = parseInt(ds_lists.GetColumn(0, "M_AMT")) ;         // 임금
	var cs604_us = ds_lists.GetColumn(0, "CS604_US") ;  // 정기보수 간접비율
	var tmp_amt = 2700000 ;  // 계약직 임금
	var wday = 20 ;
	var sjt = 0 ;    //  전체 상주 원가 
	var sjt_t = 0 ;  //  업체별 상주 원가 
	var smt = 0 ;  // 전체 상주 수주 ( vat 포함 )
	var smt_t = 0 ;  // 업체별 상주 수주 ( vat 포함 )
	var ums = 0 ;  // 개월수
	
	// 연차별 상주 정보 합산
	for(var i=0; i<ds_lists.rowcount ; i++) {
	
		ums = parseInt(ds_lists.GetColumn(i, "CDY"));
		smt_t = ds_lists.GetColumn(i, "TOT") * ums ;
		if(ds_lists.GetColumn(i, "TGB") == "1") {
			if(ds_lists.GetColumn(i, "TMP") == "N"){
				sjt_t = parseInt(ds_lists.GetColumn(i, "HUR")) * m_amt * wday;
				sjt_t = sjt_t * ums;
			} else {
				sjt_t = tmp_amt;
				sjt_t = sjt_t * ums;
			}
		
		} else if(ds_lists.GetColumn(i, "TGB") == "3") {
			sjt_t = ( parseInt(ds_lists.GetColumn(i, "TOT")) * parseInt(ds_lists.GetColumn(i, "RTO")) ) / 100 ;
			sjt_t = sjt_t * ums;
		
		} else {
			sjt_t = 0;
		} 
		sjt += sjt_t ;
		smt += smt_t ;		
	}

	var nmt = parseInt(ds_cost.GetColumn(0, "NMT"));
	var jmt = parseInt(ds_cost.GetColumn(0, "JMT"));
	var kmt = parseInt(ds_cost.GetColumn(0, "KMT"));
	//===========================공기청정기 추가 20200515 Han.JH====================================
	var acmt = parseInt(ds_cost.GetColumn(0, "ACMT"));
	//======================================================================================
	var hmt = parseInt(ds_cost.GetColumn(0, "HMT"));	
	var dmt = parseInt(ds_cost.GetColumn(0, "DMT"));
	var cmt = parseInt(ds_cost.GetColumn(0, "CMT"));
	var cost  = 0;
	var costt = 0;
	var gmt = 0;
	var rat = 0 ;
	var tamt = parseInt(ds_cost.GetColumn(0, "TAMT"));
	
	cost =  nmt + jmt + kmt + hmt + dmt + cmt + sjt + acmt ; // 정기보수 직접비 + 상주 원가
	gmt = ( cost * cs604_us ) / 100;                 // 상주 원가 포함 간접비	
	costt = cost + gmt ;							  // 상주 총원가 ( 간접비 포함 )	
	tamt = tamt + smt ;                               // 정기보수 수주 + 인원상주 수주
	rat = round((costt / tamt * 100),1);

	ds_cost.SetColumn(0, "SJT", sjt);	
	ds_cost.SetColumn(0, "GMT", gmt);
	ds_cost.SetColumn(0, "COST", costt);
	ds_cost.SetColumn(0, "RAT", rat);
	ds_cost.SetColumn(0, "TAMT", tamt);

}
//fn_save3 수정 : 시행율 처리순서 변경으로 시행율 저장 제거
function fn_save3() { //승인
	gfn_clearMsgBar();

	if ( ds_list.rowCount() < 1 ) {
		rollbackDecide();
		// 저장할 정보 없음.
		gfn_showMsg("CW00010");
		return;
	}

	if(ds_list.FindRow("CHK", 1) == -1) {
		rollbackDecide();
		gfn_showMsg("CW00013");
		return;
	}
		
	//계약에 저장 안한 마스터 정보는 제거
	if(ds_list.GetColumn(0, "PST") == "A5") {	

		ds_list.FireEvent = false;
		
		for (var i=0; i<ds_list.rowcount ; i++) {
			if(length(ds_list.GetColumn(i, "SEQ"))==0) {
				ds_list.SelectRow(i);
			}
		}

		ds_list.DeleteSelected();
		ds_list.FireEvent = true;
	}	
	
	fn_searchGrp(); //3 에서 호출했던것 삽입.  실제로는 사용 안한다고 함.
		
	if(chk_query == 'seungin_query') { //승인 대상
		if ( !gfn_isChangeDs(ds_list, true) ) {
			rollbackDecide();
			return;
		}
	}

	for(var i=0; i<ds_list.RowCount(); i++) {
		var t_grp = "";

		if(ds_list.GetColumn(i, "CHK") == true) { //체크박스가 true 일 경우
			/* 대수 마감 오류 이전년도 계약개시 입력 불가 처리 20170306*/	
			// var bYear = substr(gfn_getAfterDate(ds_list.GetColumn(i, "USD"),1),0,4);
			// var cYear = substr(gfn_getCurrDate(),0,4);

			// if(bYear < cYear) {
				// if(substr(ds_list.GetColumn(i, "HNO"),0,1) != "J") {
					// gfn_showAlert("이전년도로 유상계약입력이 불가능합니다.\n판매관리팀에 문의바랍니다.");
					// return;
				// }
			// }
			/* 대수 마감 오류 이전년도 계약개시 입력 불가 처리 20170306*/	
			
			ds_list.SetColumn(i, "FLAG", "U");
			ds_list.SetColumn(i, "SQL_FLAG", "Y");
			ds_list.SetColumn(i, "MANDT", G_MANDT);
			ds_list.SetColumn(i, "UPN", ed_upn.value);
			ds_list.SetColumn(i, "CST", cb_cst.value);
			ds_list.SetColumn(i, "GND", cb_conkind.value);
			ds_list.SetColumn(i, "JKH", parseInt(cb_jgcnt.value));
			ds_list.SetColumn(i, "PST", "A6");
			ds_list.SetColumn(i, "BHD", gfn_getBeforeDate(ds_list.GetColumn(i, "USD"),1));
			ds_list.SetColumn(i, "REQ", G_USER_ID);

			t_grp = cb_grp.value;

			if(parseInt(ds_list.GetColumn(i, "UMS")) < 12) {
				if(length(trim(cb_grp.value)) > 0) {
					ds_list.SetColumn(i, "GRP", t_grp);
				} else {
					ds_list.SetColumn(i, "GRP", "");
				}
			} else {
				ds_list.SetColumn(i, "GRP", "");
			}

			if(cb_conkind.value == "C") {
				ds_list.SetColumn(i, "GBN", "C");
			} else if(cb_conkind.value == "D") {
				ds_list.SetColumn(i, "GBN", "D");
			}
		}
	}

	ds_gbn.SetColumn(0, "KIND", cb_conkind.value);
	ds_gbn.SetColumn(0, "GBN", "");


	fn_getDslists(); // 상주 승인 대상 가져오기

	// trace(ds_gbn.SaveXML());
	// trace(ds_list.SaveXML());
	// trace(ds_lists.SaveXML());
	tit_clearActionInfo();
    tit_callService(
        "CS1201001B_ACT"
        , "save3"
        , "ds_gbn=ds_gbn ds_list=ds_list ds_lists=ds_lists"
        , ""
        , ""
        , "fn_afterSave3"
        , false
        , false
        , true);
        
        
}
// 자회사 승인 후 수주번호 생성 'Z000000000'

// 승인 처리 시 견적 상주 계약 입력 내용 가져오기 201601 이하림
function fn_getDslists() {
	ds_lists.ClearData();

	if (upn == "XXXXXX" || upn == ""){
		ds_cond.SetColumn(0, "UPN", ds_list.GetColumn(0, "UPN"));
		ds_cond.SetColumn(0, "CST", ds_list.GetColumn(0, "CST"));
	} else {
		ds_cond.SetColumn(0, "UPN", upn);
		ds_cond.SetColumn(0, "CST", cst);
	}
	tit_clearActionInfo();
	tit_addSearchActionInfo("cs12:CS1201001B_S57");
	
	tit_callService(
        ""
        , ""
        , "ds_cond=ds_cond"
        , "ds_lists=ds_lists"
        , ""
        , ""
		, false
        , false
        , true);     
           
}
function fn_afterSave3(errCode, errMsg) {
	if(errCode != 0) {

		rollbackDecide();			
		/*
		for(var i=0; i<ds_list.RowCount(); i++) {
			if(ds_list.GetColumn(i, "CHK") == true) {
				ds_list.SetColumn(i, "FLAG", ds_list.GetOrgColumn(i, "FLAG"));
				ds_list.SetColumn(i, "PST", ds_list.GetOrgColumn(i, "PST"));
			}
		}
		*/
		gfn_showMsg("CE00001");
		ds_list.Reset();
	} else {

		gfn_showMsg("CI00003");
		if (vVkbur == "H100"){
			upn = ds_list.GetColumn(0, "UPN");
			cst = ds_list.GetColumn(0, "CST");
			gnd = ds_list.GetColumn(0, "GND");
			usd = ds_list.GetColumn(0, "USD");
			uhj = ds_list.GetColumn(0, "UHJ");
			gno = upn + "U" + substr(usd,2,4) + "-" + cst;
			chk_save = false;	//저장 후 조회하는 경우 구분값
		}
		fn_query();
		//query_flag = true; 최종결재 완료 후에 리프레시 방지 
	}
}

function fn_afterVbeln(errCode, errMsg) {
	if(errCode != 0) {

		gfn_showMsg("CE00001");
	} else {
		gfn_showMsg("CI00003");
		vbeln = ds_vbeln.GetColumn(0, "VBELN");
		btn_vbeln.Enable = false;
		fn_query();
	}
}

//시행율 가져오기
function fn_getRat() {
	//결재번호로 시행율 조회, 승인전에는 결재번호가 생성되지 않아, 미리 결재번호를 조합하여 조회.
	//1년 이상의 계약의 경우 여러건의 계약으로 분리됨. 시행율은 전체기간,금액으로 계산하므로 첫번쨰 계약으로 조회하면 됨.
	var s_gno = ds_list.GetColumn(0,"UPN") + "U" + 
	            substr(ds_list.GetColumn(0,"UGS"), 2, 4) + "-" +
	            ds_list.GetColumn(0,"CST"); 
	
	ds_cond_rate.SetColumn(0, "GNO", s_gno);

	tit_clearActionInfo();
	tit_addSearchActionInfo("cs12:CS1201001B_S54", null, true);
	tit_callService(
		""
		, ""
		, "ds_cond_rate=ds_cond_rate"
		, "ds_rate=ds_rate"
		, ""
		, "fn_calcApproval"
        , true);
}

/********************************************************************************
* 기      능   : 전결규정 계산
********************************************************************************/	
function fn_calcApproval() {
	// 주차의 경우 달성율 및 시행율 로직 미적용
	// 주차인 경우 지사장으로 전결규정 표현  ( 주차 박준성 요청 )
	// 주차의 달성율 로직 적용 시 전결규정 변경 필요 20170607 이하림

	var hno = substr(ds_list.GetColumn(0,"HNO"),0,1);

	if(hno == "J") {
		ed_cof.Text = "지사장";
	} else {
		if(ToFloat(med_trt_t.Value) > 0) {
			fn_ratio_std(); // 달성율에 따른 전결규정
		} else {
			fn_ratio_cost(); // 시행율에 따른 전결규정
		}
	}
	
	//==================전결규정 관련 추가(기안시 저장된 전결규정이 있으면)==================
	if( length(trim(ds_list.GetColumn(0,"DISCRULE"))) > 0 ) 
	{
		ed_cof.Text = ds_list.GetColumn(0,"DISCRULE");
	}
    //=======================================================================================	
	
	
	
}	
/********************************************************************************
* 기      능   : 달성율에 따른 전결규정 20161012 생성
********************************************************************************/	
function fn_ratio_std(){
	
	//pog 갱신의 경우 종전 단가 대비 달성율 기준 
	var trt_T = 0  ;
	var knd = ds_list.GetColumn(0,"KND");
	var gkd = ds_list.GetColumn(0,"GKD");
	var cnt = ds_list.Sum("CNT"); // 2020.07.29 전결규정을 구하기 위해 계약 호기의 전체 대수 구함. Han JH
	//ALERT("knd :: "+knd+" gkd  :: " + gkd );
	
	/* 변경전
	if(knd == "" && gkd == "2") {
		trt_T = ToFloat(med_trt_tB.Value);	
	} else {
		trt_T = ToFloat(med_trt_tS.Value);	
	}
	
	var s_result = "";	

	if (trt_T > 95) {
		s_result = "지사장";
	} else if (trt_T > 90 && trt_T <= 95) {
		s_result = "팀장";
	} else if (trt_T > 85 && trt_T <= 90) {
		s_result = "담당";
	} else if (trt_T <= 85) {
		s_result = "부문장";
	}

	ed_cof.Text = s_result;
	*/ 
	/* 변경 후 2020.02.11 최선경 요청 pog이면서 갱신계약인경우만 */
	
	// 2020.07.29 변경전
	/*var s_result = "";	
	if(knd == "" && gkd == "2") {										// POG계야깅면서 갱신계약인 경우
		trt_T = ToFloat(med_trt_tB.Value);	
		if (trt_T >= 100) {												//인상~ 동결
			s_result = "지사장";
		} else if (trt_T > 95 && trt_T < 100) {							// 5% 미만 인하
			s_result = "팀장";
		} else if (trt_T > 90 && trt_T <= 95) {							// 5% 이상 ~ 10% 미만 인하
			s_result = "담당";
		} else if (trt_T <= 90) {										// 10% 이상 인한
			s_result = "부문장";
		}
	} else {
		trt_T = ToFloat(med_trt_tS.Value);	
		if (trt_T > 95) {
			s_result = "지사장";
		} else if (trt_T > 90 && trt_T <= 95) {
			s_result = "팀장";
		} else if (trt_T > 85 && trt_T <= 90) {
			s_result = "담당";
		} else if (trt_T <= 85) {
			s_result = "부문장";
		}
	}*/
	
	// 2020.07.29 변경후
	var s_result = "";
	if(knd == "" && gkd == "2") {										// POG계약이면서 갱신계약인 경우
		trt_T = ToFloat(med_trt_tB.Value);	
		if(cnt > 10) {
			// 10대를 초과하는 경우
			if (trt_T >= 100) {												// 인상~ 동결(100~)
				s_result = "지사장(팀장)";
			} else if (trt_T > 95 && trt_T < 100) {							// 5% 미만 인하(96~99)
				s_result = "지사장(팀장)";
			} else if (trt_T > 90 && trt_T <= 95) {							// 5% 이상 ~ 10% 미만 인하(91~95)
				s_result = "담당";
			} else if (trt_T <= 90) {										// 10% 이상 인하(0~90)
				s_result = "본부장";
			}
		} else {
			// 10대 이하인 경우
			if (trt_T >= 100) {												// 인상~ 동결(100~)
				s_result = "지사장(팀장)";
			} else if (trt_T > 90 && trt_T < 100) {							// 10% 미만 인하(91~99)
				s_result = "지사장(팀장)";
			} else if (trt_T > 85 && trt_T <= 90) {							// 10% 이상 ~ 15% 미만 인하(86~90)
				s_result = "담당";
			} else if (trt_T <= 85) {										// 15% 이상 인하(0~85)
				s_result = "본부장(월보고)";
			}			
		}
	} else {
		trt_T = ToFloat(med_trt_tS.Value);
		if(cnt > 10) {
			// 10대 초과인 경우
			if (trt_T >= 100) {												// 인상~ 동결(100~)
				s_result = "지사장(팀장)";
			} else if (trt_T > 90 && trt_T < 100) {							// 10% 미만 인하(91~99)
				s_result = "지사장(팀장)";
			} else if (trt_T > 85 && trt_T <= 90) {							// 10% 이상 ~ 15% 미만 인하(86~90)
				s_result = "담당";
			} else if (trt_T <= 85) {										// 15% 이상 인하(0~85)
				s_result = "본부장";
			}
		} else {
			// 10대 이하인 경우
			if (trt_T >= 100) {												// 인상~ 동결(100~)
				s_result = "지사장(팀장)";
			} else if (trt_T > 90 && trt_T < 100) {							// 10% 미만 인하(91~99)
				s_result = "지사장(팀장)";
			} else if (trt_T > 85 && trt_T <= 90) {							// 10% 이상 ~ 15% 미만 인하(86~90)
				s_result = "담당";
			} else if (trt_T <= 85) {										// 15% 이상 인하(0~85)
				s_result = "본부장(월보고)";
			}
		}
	}
	
	ed_cof.Text = s_result;
	
	
	// cfo 전결 규정 대상 체크    20170524
	// 보수료 + hrts + dipbx + 상주 1천만원 초과 및 달성율 85 이하 
	// 견적은 상주 포함, 계약승인시 상주 미포함 
	var monthly_amt = ds_list.Sum("AMT") ;
	var monthly_ambt = ds_list.Sum("AMBT") ;
	var monthly_hmt = ds_list.Sum("HMT") ;
	//===========================공기청정기 추가 20200515 Han.JH====================================
	var monthly_acmt = ds_list.Sum("ACMT") ;
	//======================================================================================
	var monthly_dmt = ds_list.Sum("DMT") ;
	var monthly_smt = 0 ;

	var total_monthly = monthly_amt+monthly_ambt+monthly_hmt+monthly_dmt+monthly_smt+monthly_acmt ;
	if (total_monthly > 10000000 && trt_T <= 85) {
		//ed_cof.Text = "CFO 확인" ;
		ed_cof.Text = "재경본부장 확인" ;
	}

}

/********************************************************************************
* 기      능   : 시행율에 따른 전결규정
********************************************************************************/	
function fn_ratio_cost() {

	var tot_amt = 0;
	var rate = 0;

	if (ds_rate.GetColumn(0, "RAT") >0) {
		rate = ds_rate.GetColumn(0, "RAT");
	}
	
	for(var i=0; i<ds_list.RowCount(); i++) {

		var seq = ds_list.getcolumn(i, "SEQ");
		var sir = ds_list.getcolumn(i, "SIR");
		var ltc = ds_list.getcolumn(i, "LTC");
		var lts = ds_list.getcolumn(i, "LTS");
		
		if ((length(seq) <> 0) &&
			(
			( length(sir) > 0 && ( (ltc == "1" && lts == "01") || (ltc == "0") ) ) || // 견적을통한 계약이고 장기계약인 경우 01차년도만 계산 장기계약이 아니면 모두 계산
			( length(sir) == 0 ) //견적을통한 계약이 아닌경우 계산
			)
		   )
		{	
			var tmp_amt = 0;
			var t_mon_fm, t_mon_to, s_ums;

			t_mon_fm = ds_list.GetColumn(i, "RGS");
			t_mon_to = ds_list.GetColumn(i, "RMR");
						
			s_ums = parseInt(gfn_getMonthCnt(t_mon_fm, t_mon_to));			
			
			tmp_amt = (ds_list.GetColumn(i, "AMT") + ds_list.GetColumn(i, "AMBT") + ds_list.GetColumn(i, "HMT") + ds_list.GetColumn(i, "DMT")+ ds_list.GetColumn(i, "ACMT")) * s_ums;

			tot_amt = tot_amt + tmp_amt;

			// trace(i + ". " +
			// " amt="+ds_list.GetColumn(i, "AMT") + 
			// " / hmt="+ds_list.GetColumn(i, "HMT") + 
			// " / dmt="+ds_list.GetColumn(i, "DMT") +
			// " / ums="+s_ums+
			// " / t_mon_fm="+t_mon_fm +
			// " / t_mon_to="+t_mon_to
			// );
		}
	}
	
	var s_bgb = ds_list.GetColumn(0, "BSUGB");	//직영구분	1:직영
	var s_knd = ds_list.GetColumn(0, "KND_YN");	//계약상품 1 :FM 0:POG			
	var s_result = "";
	
	if (s_bgb == "1") {  //직영
		if (tot_amt < 50000000) {
			if (rate < 85) {
				s_result = "팀장";
			} else if (rate >= 85 && rate <90) {
				s_result = "담당";
			} else if (rate >= 90 && rate <95) {
				s_result = "본부장";
			} else if (rate >= 95) {
				s_result = "본부장";
			}
		} else if (tot_amt >= 50000000 && tot_amt < 200000000) {
			if (rate < 80) {
				s_result = "팀장";
			} else if (rate >= 80 && rate <85) {
				s_result = "담당";
			} else if (rate >= 85 && rate <90) {
				s_result = "본부장";
			} else if (rate >= 90) {
				s_result = "대표이사";
			}
		} else if (tot_amt >= 200000000) {
				s_result = "대표이사";
		}				
	} else {	//협력사
		if (tot_amt < 50000000) {
			if (rate < 90) {
				s_result = "팀장";
			} else if (rate >= 90 && rate < 95) {
				s_result = "담당";
			} else if (rate >= 95) {
				s_result = "본부장";
			}
		} else if (tot_amt >= 50000000 && tot_amt < 200000000) {
			if (rate < 85) {
				s_result = "팀장";
			} else if (rate >= 85 && rate < 90) {
				s_result = "담당";
			} else if (rate >= 90 && rate < 95) {
				s_result = "본부장";
			} else if (rate >= 95) {
				s_result = "대표이사";
			}
		} else if (tot_amt >= 200000000) {
				s_result = "대표이사";
		}				
	}
//	trace("s_bgb="+s_bgb+" / s_knd = " + s_knd + "/  tot_amt = "+ tot_amt + " / rate =" + rate + " / s_result="+s_result);
	ed_cof.Text = s_result;
}

function rollbackDecide() {
		trace("errCode="+errCode, "errMsg="+ errMsg);
		tit_clearActionInfo();
		tit_addMultiActionInfo("cs04:CS0401002A_U6"); //결재상태 복구 ZWBAP01
		tit_addMultiActionInfo("cs04:CS0401002A_U7"); //결재상태 복구 ZWBAP02
		tit_callService( 
			  ""
			, ""
			, "ds_list_0=ds_decide" 
			, ""
			, ""
			, ""
			, true
			, true);
}

function btn_admin_OnClick(obj)
{	//  전산 관리자 사용 
	// 강제 승인 처리
	// 사용 사례 - 결재 완료 후 승인 미처리 된 경우
	fn_save3();
}

function ed_docno_OnClick(obj)
{		
	if(length(ed_docno.Text) > 0 )  {

		var arg = "fa_docno=" + quote(ed_docno.Text);
	
		gfn_openPopup("CS0405001A", true, arg);	
	}
}

function btn_pdchang_OnClick(obj)
{
	
	if(ds_list.FindRow("CHK", 1) == -1) {
		gfn_showAlert("CW00013");		//처리할 자료를 먼저 선택해 주십시오.
		return;
	}
	
	for(var i=0; i<ds_list.RowCount(); i++) {
		if(ds_list.GetColumn(i, "CHK") == true) { //체크박스가 true 일 경우	
			//if(ds_list.GetColumn(i, "KND_YN") != "1") {				
			if(ds_list.GetOrgColumn(i,"KND_YN") != "1") {			
				gfn_showAlert('CW00116','FM계약 체크건만');
				return;
			}
			
			if(length(trim(ds_list.GetColumn(i,"KND"))) <= 0) {			
				gfn_showAlert('CW00116','FM상품을');
				return;
			}
			
		}	
	}	
	
	ds_list_tmp.ClearData();
	ds_list.Filter("CHK==1");
	ds_list_tmp.copyF(ds_list);
	ds_list.unFilter();		
		
	
	//for(var i=0; i<ds_list.RowCount(); i++) {
	//	if(ds_list.GetColumn(i, "CHK") == true) { //체크박스가 true 일 경우
	//		if(ds_list.GetOrgColumn(i, "KND_YN") == "1") {					
				tit_clearActionInfo();
				tit_addMultiActionInfo("cs12:CS1201001B_U31"); //FM 상품 변경
				tit_callService( 
									""
									, ""
									, "ds_list=ds_list_tmp" 
									, ""
									, ""
									, "fn_afterSave4"
									, ""
									, ""
									, true);												
	//		}	
	//	}
	//}

	
}


/********************************************************************************
* 기      능   : 저장 Callback  
********************************************************************************/
function fn_afterSave4(errCode, errMsg) 
{
	if ( errCode != 0 ) 
	{
		ds_list_tmp.ClearData();
		gfn_showMsg("CE00001");
	} 
	else 
	{
		ds_list_tmp.ClearData();
		gfn_showMsg("CI00003");
	}
}	

/********************************************************************************
* 기      능   : 유상보수계약 승인취소 및 삭제 시, 중도해지기안 체크로직
				기안반송, 수신반송, 수신결재완료가 아닌경우 승인취소 및 삭제하지 않도록 처리. 2019.01.22 Han J.H
********************************************************************************/
function halfCancleChk() {
	tit_clearActionInfo();
	tit_addSearchActionInfo("cs12:CS1201001B_S64");
	
	if(ds_list.GetColumn(0,"GNO") == '') { // 유상계약이 승인 혹은 체결되지 않는경우. 즉 유상계약번호가 존재하지 않는 경우는 해당 로직 수행하지 않음.
		return true;
	}
	
	if(ds_list.GetColumn(0,"UPN") != '') {
		ds_halfcond.SetColumn(0, "UPN", ds_list.GetColumn(0,"UPN"));
	}
	
	if(ds_list.GetColumn(0,"CST") != '') {
		ds_halfcond.SetColumn(0, "CST", ds_list.GetColumn(0,"CST"));
	}
	
	if(ds_list.GetColumn(0,"GNO") != '') {
		ds_halfcond.SetColumn(0, "GNO", ds_list.GetColumn(0,"GNO"));
	}
	
	tit_callService(
		""
		, ""
		, "ds_halfcond=ds_halfcond"
		, "ds_halfcancle=ds_halfcancle"
		, ""
		, "halfCancleChk_afterQuery"
        , true
        , false
        , true);
}

/********************************************************************************
* 기      능   : 유상보수계약 승인취소 및 삭제 Callback
********************************************************************************/
function halfCancleChk_afterQuery(errCode, errMsg) {
	if ( errCode != 0 ) 
	{
		gfn_showMsg("CE00001");
	} 
	else 
	{
		if(ds_halfcancle.GetRowCount() > 0 && !(ds_halfcancle.GetColumn(0,"DOCNO") == null)) {
		
			if(!(ds_halfcancle.GetColumn(0,"APSTAT") == '2' || ds_halfcancle.GetColumn(0,"APSTAT") == '5' || ds_halfcancle.GetColumn(0,"APSTAT") == '6')) { 
				// 기안반송(2), 수신반송(5), 수신결재완료(6)가 아니면 리턴시킴.
				gfn_showAlert("현재 중도해지건이 있어 승인취소 및 삭제를 처리 할 수 없습니다.\n반송처리 후 재진행 부탁드립니다.\n문서번호 : " + ds_halfcancle.GetColumn(0,"DOCNO"));
				chk_halfcancle = true;
			}
		}
	}
}

/********************************************************************************
* 기      능   : 온핸드 현장 체크
********************************************************************************/
function fn_isOnHandChk() {
	for(var i=0; i<ds_list_copy.rowcount; i++) {
		tit_clearActionInfo();
		tit_addSearchActionInfo("cs12:CS1201001B_S65");
		
		ds_isonhand_cond.ClearData();
		ds_isonhand_cond.AddRow();
		
		ds_isonhand_cond.SetColumn(0, "PJT", ds_list_copy.GetColumn(i, "PJT"));
		ds_isonhand_cond.SetColumn(0, "HNO", ds_list_copy.GetColumn(i, "HNO"));
		ds_isonhand_cond.SetColumn(0, "UGS", ds_list_copy.GetColumn(i, "UGS"));
		ds_isonhand_cond.SetColumn(0, "UMR", ds_list_copy.GetColumn(i, "UMR"));
		
		// PJT 또는 HNO 없을 시 비즈니스 로직 타지 않도록 예외처리
		if(length(ds_isonhand_cond.GetColumn(0, "PJT")) < 1 || length(ds_isonhand_cond.GetColumn(0, "HNO")) < 1) {
			return;
		}
		
		tit_callService(
		""
		, ""
		, "ds_isonhand_cond=ds_isonhand_cond"
		, "ds_isonhand_result=ds_isonhand_result"
		, ""
		, "isOnHandChk_afterQuery"
		, true
		, false
		, true
		);
		
		if(chk_isOnHand) { // 온핸드 현장 종료시 break
			break;
		}
	}

}

/********************************************************************************
* 기      능   : 온핸드 체크 Callback
********************************************************************************/
function isOnHandChk_afterQuery(errCode, errMsg) {
	if ( errCode != 0 ) 
	{
		gfn_showMsg("CE00001");
	} 
	else 
	{
		if(ds_isonhand_result.GetRowCount() > 0 && ds_isonhand_result.GetColumn(0,"CNT") > 0 ) {
			gfn_showAlert("현재 해당 원프로젝트로 온핸드 현장이 존재합니다.\n해당 거래선을 확인해주세요.\n통합프로젝트 : " + ds_isonhand_result.GetColumn(0,"UPN") + " / " + "거래선 : " + ds_isonhand_result.GetColumn(0,"CST"));
			chk_isOnHand = true;
		}
	}
}
function chk_bdgbn_OnClick(obj,strValue)
{ 
	for ( i = 0; i < ds_list.GetRowCount();i++){
		ds_list.SetColumn(i, "BDGBN", strValue);
		vBdgRateA = gfn_bdgbnRate(ds_list.GetColumn(i, "BDGBN"), 
								  ds_list.GetColumn(i, "KND_YN"), 
								  ds_list.GetColumn(i, "ABG"), 
								  "1");

		if (toNumber(ds_list.GetColumn(i, "AMTT")) > 0){
			ds_list.SetColumn(i, "AMT", ceil(toNumber(ds_list.GetColumn(i, "AMTT")) * vBdgRateA));
		}
	}

} 
/********************************************************************************
* 기      능   : 기존 계약의 보수 협력사에 해당하는 영업그룹 가져오기
********************************************************************************/
function fn_getBeforeVkbur() {
	ds_beforecontract_cond.ClearData();
	ds_beforecontract_cond.AddRow();	
	
	ds_beforecontract_cond.setColumn(0, "PJT", ds_list.GetColumn(1, "PJT"));
	ds_beforecontract_cond.setColumn(0, "HNO", ds_list.GetColumn(1, "HNO"));
	
	// PJT 또는 HNO 없을 시 비즈니스 로직 타지 않도록 예외처리
	if(length(ds_beforecontract_cond.GetColumn(0, "PJT")) < 1 || length(ds_beforecontract_cond.GetColumn(0, "HNO")) < 1) {
		return;
	}	
	
	tit_clearActionInfo();
	tit_addSearchActionInfo("cs12:CS1201001B_S68");
	tit_callService(
		""
		, ""
		, "ds_beforecontract_cond=ds_beforecontract_cond"
		, "ds_beforecontract=ds_beforecontract"
		, ""
		, ""
		, true
		, false
		, true);
	
	if(ds_beforecontract.GetRowCount() > 0) {
		bf_vVkbur = ds_beforecontract.GetColumn(0,"BSU_B_VKBUR");
		copytool_flag = false; // 카피툴 통한 입력시 무한루프 현상이 있어 비활성화 처리
	}
	
}

]]></Script>
</Window>