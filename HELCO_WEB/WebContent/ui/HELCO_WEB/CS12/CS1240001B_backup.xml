<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="650" Id="CS1240001B" Left="8" OnLoadCompleted="fn_OnLoadCompleted" OnUnloadCompleted="fn_OnUnloadCompleted" PidAttrib="7" Title="견적상세(승강기)" Top="8" Ver="1.0" Width="838" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_cond2">
				<Contents>
					<colinfo id="GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="TEM" size="256" summ="default" type="STRING"/>
					<colinfo id="RDT" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="SIR" size="256" summ="default" type="STRING"/>
					<colinfo id="DOC" size="256" summ="default" type="STRING"/>
					<colinfo id="DOCNO" size="256" summ="default" type="STRING"/>
					<record>
						<DOC></DOC>
						<DOCNO></DOCNO>
						<GBN></GBN>
						<RDT></RDT>
						<SEQ></SEQ>
						<SIR></SIR>
						<TEM></TEM>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_prd">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME>-&#32;선택&#32;-</CODE_NAME>
					</record>
					<record>
						<CODE>A</CODE>
						<CODE_NAME>매월</CODE_NAME>
					</record>
					<record>
						<CODE>B</CODE>
						<CODE_NAME>격월</CODE_NAME>
					</record>
					<record>
						<CODE>C</CODE>
						<CODE_NAME>분기</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_head">
				<Contents>
					<colinfo id="ETN" size="256" summ="default" type="STRING"/>
					<colinfo id="SIR" size="256" summ="default" type="STRING"/>
					<colinfo id="PST" size="256" summ="default" type="STRING"/>
					<colinfo id="PST_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="MDT" size="256" summ="default" type="STRING"/>
					<colinfo id="MID" size="256" summ="default" type="STRING"/>
					<colinfo id="MID_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="CDT" size="256" summ="default" type="STRING"/>
					<colinfo id="NAM" size="256" summ="default" type="STRING"/>
					<colinfo id="SPT" size="256" summ="default" type="STRING"/>
					<colinfo id="ADR" size="256" summ="default" type="STRING"/>
					<colinfo id="PJT" size="256" summ="default" type="STRING"/>
					<colinfo id="TEM" size="256" summ="default" type="STRING"/>
					<colinfo id="BSU" size="256" summ="default" type="STRING"/>
					<colinfo id="SPC" size="256" summ="default" type="STRING"/>
					<colinfo id="FMG" size="256" summ="default" type="STRING"/>
					<colinfo id="POG" size="256" summ="default" type="STRING"/>
					<colinfo id="HGB" size="256" summ="default" type="STRING"/>
					<colinfo id="DGB" size="256" summ="default" type="STRING"/>
					<colinfo id="PRD" size="256" summ="default" type="STRING"/>
					<colinfo id="CDY" size="256" summ="default" type="STRING"/>
					<colinfo id="CPD" size="256" summ="default" type="STRING"/>
					<colinfo id="CND" size="256" summ="default" type="STRING"/>
					<colinfo id="SRG" size="256" summ="default" type="STRING"/>
					<colinfo id="GBU" size="256" summ="default" type="STRING"/>
					<colinfo id="YGB" size="256" summ="default" type="STRING"/>
					<colinfo id="BLD" size="256" summ="default" type="STRING"/>
					<colinfo id="PDT" size="256" summ="default" type="STRING"/>
					<colinfo id="CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="FLR" size="256" summ="default" type="STRING"/>
					<colinfo id="SPD" size="256" summ="default" type="STRING"/>
					<colinfo id="SYR" size="256" summ="default" type="STRING"/>
					<colinfo id="HYN" size="256" summ="default" type="STRING"/>
					<colinfo id="DYN" size="256" summ="default" type="STRING"/>
					<colinfo id="CYN" size="256" summ="default" type="STRING"/>
					<colinfo id="RMK" size="256" summ="default" type="STRING"/>
					<colinfo id="DOC" size="256" summ="default" type="STRING"/>
					<colinfo id="APSTAT" size="256" summ="default" type="STRING"/>
					<colinfo id="MASTAT" size="256" summ="default" type="STRING"/>
					<colinfo id="MATOT" size="256" summ="default" type="STRING"/>
					<colinfo id="AMG" size="256" summ="default" type="STRING"/>
					<colinfo id="RA1" size="256" summ="default" type="STRING"/>
					<colinfo id="RA2" size="256" summ="default" type="STRING"/>
					<colinfo id="MMN" size="256" summ="default" type="STRING"/>
					<colinfo id="DAT" size="256" summ="default" type="STRING"/>
					<colinfo id="COF" size="256" summ="default" type="STRING"/>
					<colinfo id="COF2" size="256" summ="default" type="STRING"/>
					<colinfo id="OPN" size="256" summ="default" type="STRING"/>
					<colinfo id="STD" size="256" summ="default" type="STRING"/>
					<colinfo id="ETD" size="256" summ="default" type="STRING"/>
					<colinfo id="ZMAN" size="256" summ="default" type="STRING"/>
					<colinfo id="PNT" size="256" summ="default" type="STRING"/>
					<colinfo id="SAJ" size="256" summ="default" type="STRING"/>
					<colinfo id="GIS" size="256" summ="default" type="STRING"/>
					<colinfo id="TRAT" size="256" summ="default" type="STRING"/>
					<record>
						<ADR></ADR>
						<AMG></AMG>
						<APSTAT></APSTAT>
						<BLD></BLD>
						<BSU></BSU>
						<CDT></CDT>
						<CDY></CDY>
						<CND></CND>
						<CNT></CNT>
						<COF></COF>
						<COF2></COF2>
						<CPD></CPD>
						<CYN></CYN>
						<DAT></DAT>
						<DGB></DGB>
						<DOC></DOC>
						<DYN></DYN>
						<ETD></ETD>
						<ETN></ETN>
						<FLR></FLR>
						<FMG></FMG>
						<GBU></GBU>
						<GIS></GIS>
						<HGB></HGB>
						<HYN></HYN>
						<MASTAT></MASTAT>
						<MATOT></MATOT>
						<MDT></MDT>
						<MID></MID>
						<MID_NM></MID_NM>
						<MMN></MMN>
						<NAM></NAM>
						<OPN></OPN>
						<PDT></PDT>
						<PJT></PJT>
						<PNT></PNT>
						<POG></POG>
						<PRD></PRD>
						<PST></PST>
						<PST_NM></PST_NM>
						<RA1></RA1>
						<RA2></RA2>
						<RMK></RMK>
						<SAJ></SAJ>
						<SIR></SIR>
						<SPC></SPC>
						<SPD></SPD>
						<SPT></SPT>
						<SRG></SRG>
						<STD></STD>
						<SYR></SYR>
						<TEM></TEM>
						<TRAT></TRAT>
						<YGB></YGB>
						<ZMAN></ZMAN>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list2" OnColumnChanged="ds_list2_OnColumnChanged">
				<Contents>
					<colinfo id="ETN" size="256" summ="default" type="STRING"/>
					<colinfo id="SIR" size="256" summ="default" type="STRING"/>
					<colinfo id="PJT" size="256" summ="default" type="STRING"/>
					<colinfo id="HNO" size="256" summ="default" type="STRING"/>
					<colinfo id="UPN" size="256" summ="default" type="STRING"/>
					<colinfo id="TEM" size="256" summ="default" type="STRING"/>
					<colinfo id="TBLD" size="256" summ="default" type="STRING"/>
					<colinfo id="SPT" size="256" summ="default" type="STRING"/>
					<colinfo id="SPC" size="256" summ="default" type="STRING"/>
					<colinfo id="SPC2" size="256" summ="default" type="STRING"/>
					<colinfo id="TYN" size="256" summ="default" type="STRING"/>
					<colinfo id="FMT" size="256" summ="default" type="STRING"/>
					<colinfo id="PMT" size="256" summ="default" type="STRING"/>
					<colinfo id="HMT" size="256" summ="default" type="STRING"/>
					<colinfo id="DMT" size="256" summ="default" type="STRING"/>
					<colinfo id="AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="FMG" size="256" summ="default" type="STRING"/>
					<colinfo id="POG" size="256" summ="default" type="STRING"/>
					<colinfo id="HGB" size="256" summ="default" type="STRING"/>
					<colinfo id="DGB" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="HWR" size="256" summ="default" type="STRING"/>
					<colinfo id="DND" size="256" summ="default" type="STRING"/>
					<colinfo id="VKGRP" size="256" summ="default" type="STRING"/>
					<colinfo id="BSUGB" size="256" summ="default" type="STRING"/>
					<colinfo id="KND" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSPEC12" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSPEC7" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSPEC3" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSPEC2" size="256" summ="default" type="STRING"/>
					<colinfo id="BLD" size="256" summ="default" type="STRING"/>
					<colinfo id="FDT" size="256" summ="default" type="STRING"/>
					<colinfo id="HEP" size="256" summ="default" type="STRING"/>
					<colinfo id="UMS" size="256" summ="default" type="STRING"/>
					<colinfo id="ABG" size="256" summ="default" type="STRING"/>
					<colinfo id="FMS" size="256" summ="default" type="STRING"/>
					<colinfo id="FHG" size="256" summ="default" type="STRING"/>
					<colinfo id="HYN" size="256" summ="default" type="STRING"/>
					<colinfo id="TVR" size="256" summ="default" type="STRING"/>
					<colinfo id="CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="ACD" size="256" summ="default" type="STRING"/>
					<colinfo id="ISD" size="256" summ="default" type="STRING"/>
					<colinfo id="WDT" size="256" summ="default" type="STRING"/>
					<colinfo id="DCE" size="256" summ="default" type="STRING"/>
					<colinfo id="F10" size="256" summ="default" type="STRING"/>
					<colinfo id="SEG" size="256" summ="default" type="STRING"/>
					<colinfo id="AGEK" size="256" summ="default" type="STRING"/>
					<colinfo id="P10" size="256" summ="default" type="STRING"/>
					<colinfo id="FRAT" size="256" summ="default" type="STRING"/>
					<colinfo id="PRAT" size="256" summ="default" type="STRING"/>
					<colinfo id="DAT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_hwr">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME>-&#32;선택&#32;-</CODE_NAME>
					</record>
					<record>
						<CODE>A</CODE>
						<CODE_NAME>유선</CODE_NAME>
					</record>
					<record>
						<CODE>B</CODE>
						<CODE_NAME>무선</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_dnd">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME>-&#32;선택&#32;-</CODE_NAME>
					</record>
					<record>
						<CODE>A</CODE>
						<CODE_NAME>Mini-PBX</CODE_NAME>
					</record>
					<record>
						<CODE>B</CODE>
						<CODE_NAME>Di-PBX2</CODE_NAME>
					</record>
					<record>
						<CODE>C</CODE>
						<CODE_NAME>Hybrid-PBX</CODE_NAME>
					</record>
					<record>
						<CODE>Z</CODE>
						<CODE_NAME>통신료</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond_tvr">
				<Contents>
					<colinfo id="TEM" size="256" summ="default" type="STRING"/>
					<colinfo id="RDT" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="SIR" size="256" summ="default" type="STRING"/>
					<record>
						<RDT></RDT>
						<SEQ></SEQ>
						<SIR></SIR>
						<TEM></TEM>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond_cnt">
				<Contents>
					<colinfo id="TEM" size="256" summ="default" type="STRING"/>
					<colinfo id="RDT" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="SIR" size="256" summ="default" type="STRING"/>
					<colinfo id="DOC" size="256" summ="default" type="STRING"/>
					<record>
						<DOC></DOC>
						<RDT></RDT>
						<SEQ></SEQ>
						<SIR></SIR>
						<TEM></TEM>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_gno">
				<Contents>
					<colinfo id="GNO" size="256" summ="default" type="STRING"/>
					<colinfo id="SIR" size="256" summ="default" type="STRING"/>
					<record>
						<GNO></GNO>
						<SIR></SIR>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cdy">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME>-&#32;선택&#32;-</CODE_NAME>
					</record>
					<record>
						<CODE>1</CODE>
						<CODE_NAME>1년</CODE_NAME>
					</record>
					<record>
						<CODE>2</CODE>
						<CODE_NAME>2년</CODE_NAME>
					</record>
					<record>
						<CODE>3</CODE>
						<CODE_NAME>3년</CODE_NAME>
					</record>
					<record>
						<CODE>4</CODE>
						<CODE_NAME>4년</CODE_NAME>
					</record>
					<record>
						<CODE>5</CODE>
						<CODE_NAME>5년</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cnd">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME>-&#32;선택&#32;-</CODE_NAME>
					</record>
					<record>
						<CODE>A</CODE>
						<CODE_NAME>Conversion</CODE_NAME>
					</record>
					<record>
						<CODE>B</CODE>
						<CODE_NAME>Renewal</CODE_NAME>
					</record>
					<record>
						<CODE>C</CODE>
						<CODE_NAME>Recapture</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_gbu">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME>-&#32;선택&#32;-</CODE_NAME>
					</record>
					<record>
						<CODE>A</CODE>
						<CODE_NAME>직영</CODE_NAME>
					</record>
					<record>
						<CODE>B</CODE>
						<CODE_NAME>협력사</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ygb">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME>-&#32;선택&#32;-</CODE_NAME>
					</record>
					<record>
						<CODE>A</CODE>
						<CODE_NAME>직영</CODE_NAME>
					</record>
					<record>
						<CODE>B</CODE>
						<CODE_NAME>협력사</CODE_NAME>
					</record>
					<record>
						<CODE>C</CODE>
						<CODE_NAME>직영&amp;협력사</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cyn">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME>-&#32;선택&#32;-</CODE_NAME>
					</record>
					<record>
						<CODE>Y</CODE>
						<CODE_NAME>Y</CODE_NAME>
					</record>
					<record>
						<CODE>N</CODE>
						<CODE_NAME>N</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_hyn">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME>-&#32;선택&#32;-</CODE_NAME>
					</record>
					<record>
						<CODE>Y</CODE>
						<CODE_NAME>Y</CODE_NAME>
					</record>
					<record>
						<CODE>N</CODE>
						<CODE_NAME>N</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_dyn">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME>-&#32;선택&#32;-</CODE_NAME>
					</record>
					<record>
						<CODE>Y</CODE>
						<CODE_NAME>Y</CODE_NAME>
					</record>
					<record>
						<CODE>N</CODE>
						<CODE_NAME>N</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cpd">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME>-&#32;선택&#32;-</CODE_NAME>
					</record>
					<record>
						<CODE>A</CODE>
						<CODE_NAME>FM</CODE_NAME>
					</record>
					<record>
						<CODE>B</CODE>
						<CODE_NAME>POG</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_spd">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME>-&#32;선택&#32;-</CODE_NAME>
					</record>
					<record>
						<CODE>A</CODE>
						<CODE_NAME>60m/m</CODE_NAME>
					</record>
					<record>
						<CODE>B</CODE>
						<CODE_NAME>90m/m이상</CODE_NAME>
					</record>
					<record>
						<CODE>C</CODE>
						<CODE_NAME>120m/m이상</CODE_NAME>
					</record>
					<record>
						<CODE>D</CODE>
						<CODE_NAME>180m/m이상</CODE_NAME>
					</record>
					<record>
						<CODE>E</CODE>
						<CODE_NAME>기타기종</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_bld">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME>-&#32;선택&#32;-</CODE_NAME>
					</record>
					<record>
						<CODE>A</CODE>
						<CODE_NAME>아파트</CODE_NAME>
					</record>
					<record>
						<CODE>B</CODE>
						<CODE_NAME>근린생활</CODE_NAME>
					</record>
					<record>
						<CODE>C</CODE>
						<CODE_NAME>주상복합</CODE_NAME>
					</record>
					<record>
						<CODE>D</CODE>
						<CODE_NAME>기타</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_srg">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME>-&#32;선택&#32;-</CODE_NAME>
					</record>
					<record>
						<CODE>A</CODE>
						<CODE_NAME>1:1Roping</CODE_NAME>
					</record>
					<record>
						<CODE>B</CODE>
						<CODE_NAME>2:1Roping</CODE_NAME>
					</record>
					<record>
						<CODE>C</CODE>
						<CODE_NAME>4:1Roping</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_pdt">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME>-&#32;선택&#32;-</CODE_NAME>
					</record>
					<record>
						<CODE>A</CODE>
						<CODE_NAME>EL</CODE_NAME>
					</record>
					<record>
						<CODE>B</CODE>
						<CODE_NAME>ES</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_syr">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME>-&#32;선택&#32;-</CODE_NAME>
					</record>
					<record>
						<CODE>01</CODE>
						<CODE_NAME>1년차</CODE_NAME>
					</record>
					<record>
						<CODE>02</CODE>
						<CODE_NAME>2년차</CODE_NAME>
					</record>
					<record>
						<CODE>03</CODE>
						<CODE_NAME>3년차</CODE_NAME>
					</record>
					<record>
						<CODE>04</CODE>
						<CODE_NAME>4년차</CODE_NAME>
					</record>
					<record>
						<CODE>05</CODE>
						<CODE_NAME>5년차</CODE_NAME>
					</record>
					<record>
						<CODE>06</CODE>
						<CODE_NAME>6년차</CODE_NAME>
					</record>
					<record>
						<CODE>07</CODE>
						<CODE_NAME>7년차</CODE_NAME>
					</record>
					<record>
						<CODE>08</CODE>
						<CODE_NAME>8년차</CODE_NAME>
					</record>
					<record>
						<CODE>09</CODE>
						<CODE_NAME>9년차</CODE_NAME>
					</record>
					<record>
						<CODE>10</CODE>
						<CODE_NAME>10년차</CODE_NAME>
					</record>
					<record>
						<CODE>11</CODE>
						<CODE_NAME>11년차</CODE_NAME>
					</record>
					<record>
						<CODE>12</CODE>
						<CODE_NAME>12년차</CODE_NAME>
					</record>
					<record>
						<CODE>13</CODE>
						<CODE_NAME>13년차</CODE_NAME>
					</record>
					<record>
						<CODE>14</CODE>
						<CODE_NAME>14년차</CODE_NAME>
					</record>
					<record>
						<CODE>15</CODE>
						<CODE_NAME>15년차</CODE_NAME>
					</record>
					<record>
						<CODE>16</CODE>
						<CODE_NAME>16년차</CODE_NAME>
					</record>
					<record>
						<CODE>17</CODE>
						<CODE_NAME>17년차</CODE_NAME>
					</record>
					<record>
						<CODE>18</CODE>
						<CODE_NAME>18년차</CODE_NAME>
					</record>
					<record>
						<CODE>19</CODE>
						<CODE_NAME>19년차</CODE_NAME>
					</record>
					<record>
						<CODE>20</CODE>
						<CODE_NAME>20년차</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_apstat">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<colinfo id="DTEXT1" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_tbld">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_mmn">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE>0</CODE>
						<CODE_NAME>0개월</CODE_NAME>
					</record>
					<record>
						<CODE>1</CODE>
						<CODE_NAME>1개월</CODE_NAME>
					</record>
					<record>
						<CODE>2</CODE>
						<CODE_NAME>2개월</CODE_NAME>
					</record>
					<record>
						<CODE>3</CODE>
						<CODE_NAME>3개월</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_his">
				<Contents>
					<colinfo id="AVR1" size="256" summ="default" type="STRING"/>
					<colinfo id="AVR2" size="256" summ="default" type="STRING"/>
					<colinfo id="AVR3" size="256" summ="default" type="STRING"/>
					<colinfo id="LAS" size="256" summ="default" type="STRING"/>
					<record>
						<AVR1></AVR1>
						<AVR2></AVR2>
						<AVR3></AVR3>
						<LAS></LAS>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond3">
				<Contents>
					<colinfo id="DOC" size="256" summ="default" type="STRING"/>
					<record>
						<DOC></DOC>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cnt3">
				<Contents>
					<colinfo id="CNT" size="256" summ="default" type="STRING"/>
					<record>
						<CNT></CNT>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cost_o">
				<Contents>
					<colinfo id="NMT" size="256" summ="default" type="STRING"/>
					<colinfo id="JMT" size="256" summ="default" type="STRING"/>
					<colinfo id="JMT2" size="256" summ="default" type="STRING"/>
					<colinfo id="KMT" size="256" summ="default" type="STRING"/>
					<colinfo id="HMT" size="256" summ="default" type="STRING"/>
					<colinfo id="DMT" size="256" summ="default" type="STRING"/>
					<colinfo id="CMT" size="256" summ="default" type="STRING"/>
					<colinfo id="GMT" size="256" summ="default" type="STRING"/>
					<colinfo id="GMT2" size="256" summ="default" type="STRING"/>
					<colinfo id="COS1" size="256" summ="default" type="STRING"/>
					<colinfo id="COS2" size="256" summ="default" type="STRING"/>
					<colinfo id="PER" size="256" summ="default" type="STRING"/>
					<colinfo id="AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="TAMT" size="256" summ="default" type="STRING"/>
					<colinfo id="COSTT" size="256" summ="default" type="STRING"/>
					<colinfo id="COSTT2" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cost_sum">
				<Contents>
					<colinfo id="NMT" size="256" summ="default" type="STRING"/>
					<colinfo id="JMT" size="256" summ="default" type="STRING"/>
					<colinfo id="JMT2" size="256" summ="default" type="STRING"/>
					<colinfo id="KMT" size="256" summ="default" type="STRING"/>
					<colinfo id="HMT" size="256" summ="default" type="STRING"/>
					<colinfo id="DMT" size="256" summ="default" type="STRING"/>
					<colinfo id="CMT" size="256" summ="default" type="STRING"/>
					<colinfo id="GMT" size="256" summ="default" type="STRING"/>
					<colinfo id="GMT2" size="256" summ="default" type="STRING"/>
					<colinfo id="COS1" size="256" summ="default" type="STRING"/>
					<colinfo id="COS2" size="256" summ="default" type="STRING"/>
					<colinfo id="COSTT" size="256" summ="default" type="STRING"/>
					<colinfo id="COSTT2" size="256" summ="default" type="STRING"/>
					<colinfo id="AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="TAMT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cost_sum_i">
				<Contents>
					<colinfo id="COS1" size="256" summ="default" type="STRING"/>
					<colinfo id="COS2" size="256" summ="default" type="STRING"/>
					<colinfo id="COSTT" size="256" summ="default" type="STRING"/>
					<colinfo id="COSTT2" size="256" summ="default" type="STRING"/>
					<colinfo id="AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="TAMT" size="256" summ="default" type="STRING"/>
					<colinfo id="KND" size="256" summ="default" type="STRING"/>
					<colinfo id="GBU" size="256" summ="default" type="STRING"/>
					<colinfo id="ZYEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="STD" size="256" summ="default" type="STRING"/>
					<colinfo id="ETD" size="256" summ="default" type="STRING"/>
					<colinfo id="DOCNO" size="256" summ="default" type="STRING"/>
					<colinfo id="ETN" size="256" summ="default" type="STRING"/>
					<colinfo id="SIR" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cost_sum_o">
				<Contents>
					<colinfo id="GMT" size="256" summ="default" type="STRING"/>
					<colinfo id="GM2" size="256" summ="default" type="STRING"/>
					<colinfo id="COST" size="256" summ="default" type="STRING"/>
					<colinfo id="COS2" size="256" summ="default" type="STRING"/>
					<colinfo id="RAT" size="256" summ="default" type="STRING"/>
					<colinfo id="RA2" size="256" summ="default" type="STRING"/>
					<colinfo id="PER" size="256" summ="default" type="STRING"/>
					<colinfo id="INC" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cost">
				<Contents>
					<colinfo id="GNO" size="256" summ="default" type="STRING"/>
					<colinfo id="SIR" size="256" summ="default" type="STRING"/>
					<colinfo id="NMT" size="256" summ="default" type="STRING"/>
					<colinfo id="JMT" size="256" summ="default" type="STRING"/>
					<colinfo id="JM2" size="256" summ="default" type="STRING"/>
					<colinfo id="KMT" size="256" summ="default" type="STRING"/>
					<colinfo id="HMT" size="256" summ="default" type="STRING"/>
					<colinfo id="DMT" size="256" summ="default" type="STRING"/>
					<colinfo id="CMT" size="256" summ="default" type="STRING"/>
					<colinfo id="GMT" size="256" summ="default" type="STRING"/>
					<colinfo id="GM2" size="256" summ="default" type="STRING"/>
					<colinfo id="COST" size="256" summ="default" type="STRING"/>
					<colinfo id="COS2" size="256" summ="default" type="STRING"/>
					<colinfo id="RAT" size="256" summ="default" type="STRING"/>
					<colinfo id="RA2" size="256" summ="default" type="STRING"/>
					<colinfo id="PER" size="256" summ="default" type="STRING"/>
					<colinfo id="INC" size="256" summ="default" type="STRING"/>
					<colinfo id="SJT" size="256" summ="default" type="STRING"/>
					<colinfo id="ZYEAR" size="256" summ="default" type="STRING"/>
					<record>
						<CMT></CMT>
						<COS2></COS2>
						<COST></COST>
						<DMT></DMT>
						<GM2></GM2>
						<GMT></GMT>
						<GNO></GNO>
						<HMT></HMT>
						<INC></INC>
						<JM2></JM2>
						<JMT></JMT>
						<KMT></KMT>
						<NMT></NMT>
						<PER></PER>
						<RA2></RA2>
						<RAT></RAT>
						<SIR></SIR>
						<SJT></SJT>
						<ZYEAR></ZYEAR>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_plan_i">
				<Contents>
					<colinfo id="ZDATE" size="256" summ="default" type="STRING"/>
					<colinfo id="UPN" size="256" summ="default" type="STRING"/>
					<colinfo id="PJT" size="256" summ="default" type="STRING"/>
					<colinfo id="SPC2" size="256" summ="default" type="STRING"/>
					<colinfo id="SPC" size="256" summ="default" type="STRING"/>
					<colinfo id="SPC3" size="256" summ="default" type="STRING"/>
					<colinfo id="SPC7" size="256" summ="default" type="STRING"/>
					<colinfo id="PRO" size="256" summ="default" type="STRING"/>
					<colinfo id="BSU" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_plan_o">
				<Contents>
					<colinfo id="HNO" size="256" summ="default" type="STRING"/>
					<colinfo id="PJT" size="256" summ="default" type="STRING"/>
					<colinfo id="SPC1" size="256" summ="default" type="STRING"/>
					<colinfo id="SPC2" size="256" summ="default" type="STRING"/>
					<colinfo id="SPC3" size="256" summ="default" type="STRING"/>
					<colinfo id="SPC4" size="256" summ="default" type="STRING"/>
					<colinfo id="SPT" size="256" summ="default" type="STRING"/>
					<colinfo id="ADR" size="256" summ="default" type="STRING"/>
					<colinfo id="TEM" size="256" summ="default" type="STRING"/>
					<colinfo id="BSU" size="256" summ="default" type="STRING"/>
					<colinfo id="BLD" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="GBU" size="256" summ="default" type="STRING"/>
					<colinfo id="FDT" size="256" summ="default" type="STRING"/>
					<colinfo id="MNT" size="256" summ="default" type="STRING"/>
					<colinfo id="UPN" size="256" summ="default" type="STRING"/>
					<colinfo id="ISD" size="256" summ="default" type="STRING"/>
					<colinfo id="TBLD" size="256" summ="default" type="STRING"/>
					<colinfo id="BDT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_plan_list">
				<Contents>
					<colinfo id="ZDATE" size="256" summ="default" type="STRING"/>
					<colinfo id="UPN" size="256" summ="default" type="STRING"/>
					<colinfo id="PJT" size="256" summ="default" type="STRING"/>
					<colinfo id="SPC2" size="256" summ="default" type="STRING"/>
					<colinfo id="SPC" size="256" summ="default" type="STRING"/>
					<colinfo id="SPC3" size="256" summ="default" type="STRING"/>
					<colinfo id="SPC7" size="256" summ="default" type="STRING"/>
					<colinfo id="PRO" size="256" summ="default" type="STRING"/>
					<colinfo id="BSU" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_detail_pri">
				<Contents>
					<colinfo id="SEQ2" size="256" summ="default" type="STRING"/>
					<colinfo id="STD" size="256" summ="default" type="STRING"/>
					<colinfo id="ETD" size="256" summ="default" type="STRING"/>
					<colinfo id="TOT" size="256" summ="default" type="STRING"/>
					<colinfo id="TEM" size="256" summ="default" type="STRING"/>
					<colinfo id="RDT" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="SIR" size="256" summ="default" type="STRING"/>
					<colinfo id="MON" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_print1">
				<Contents>
					<colinfo id="UPN" size="256" summ="default" type="STRING"/>
					<colinfo id="ETN" size="256" summ="default" type="STRING"/>
					<colinfo id="SPT" size="256" summ="default" type="STRING"/>
					<colinfo id="TEM_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="BSU_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="WDT" size="256" summ="default" type="STRING"/>
					<colinfo id="ISD" size="256" summ="default" type="STRING"/>
					<colinfo id="CDT" size="256" summ="default" type="STRING"/>
					<colinfo id="STD" size="256" summ="default" type="STRING"/>
					<colinfo id="ETD" size="256" summ="default" type="STRING"/>
					<colinfo id="CPD" size="256" summ="default" type="STRING"/>
					<colinfo id="CND" size="256" summ="default" type="STRING"/>
					<colinfo id="CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="TOT" size="256" summ="default" type="STRING"/>
					<colinfo id="DYN" size="256" summ="default" type="STRING"/>
					<colinfo id="HYN" size="256" summ="default" type="STRING"/>
					<colinfo id="PRD" size="256" summ="default" type="STRING"/>
					<colinfo id="BLD" size="256" summ="default" type="STRING"/>
					<record>
						<BLD></BLD>
						<BSU_NM></BSU_NM>
						<CDT></CDT>
						<CND></CND>
						<CNT></CNT>
						<CPD></CPD>
						<DYN></DYN>
						<ETD></ETD>
						<ETN></ETN>
						<HYN></HYN>
						<ISD></ISD>
						<PRD></PRD>
						<SPT></SPT>
						<STD></STD>
						<TEM_NM></TEM_NM>
						<TOT></TOT>
						<UPN></UPN>
						<WDT></WDT>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_print1_result">
				<Contents>
					<colinfo id="UPN" size="256" summ="default" type="STRING"/>
					<colinfo id="ETN" size="256" summ="default" type="STRING"/>
					<colinfo id="SPT" size="256" summ="default" type="STRING"/>
					<colinfo id="TEM_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="BSU_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="WDT" size="256" summ="default" type="STRING"/>
					<colinfo id="ISD" size="256" summ="default" type="STRING"/>
					<colinfo id="CDT" size="256" summ="default" type="STRING"/>
					<colinfo id="STD" size="256" summ="default" type="STRING"/>
					<colinfo id="ETD" size="256" summ="default" type="STRING"/>
					<colinfo id="CPD" size="256" summ="default" type="STRING"/>
					<colinfo id="CND" size="256" summ="default" type="STRING"/>
					<colinfo id="CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="TOT" size="256" summ="default" type="STRING"/>
					<colinfo id="DYN" size="256" summ="default" type="STRING"/>
					<colinfo id="HYN" size="256" summ="default" type="STRING"/>
					<colinfo id="PRD" size="256" summ="default" type="STRING"/>
					<colinfo id="BLD" size="256" summ="default" type="STRING"/>
					<record>
						<BLD></BLD>
						<BSU_NM></BSU_NM>
						<CDT></CDT>
						<CND></CND>
						<CNT></CNT>
						<CPD></CPD>
						<DYN></DYN>
						<ETD></ETD>
						<ETN></ETN>
						<HYN></HYN>
						<ISD></ISD>
						<PRD></PRD>
						<SPT></SPT>
						<STD></STD>
						<TEM_NM></TEM_NM>
						<TOT></TOT>
						<UPN></UPN>
						<WDT></WDT>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_print2_result">
				<Contents>
					<colinfo id="TOT" size="256" summ="default" type="STRING"/>
					<colinfo id="NMT" size="256" summ="default" type="STRING"/>
					<colinfo id="JMT" size="256" summ="default" type="STRING"/>
					<colinfo id="JM2" size="256" summ="default" type="STRING"/>
					<colinfo id="KMT" size="256" summ="default" type="STRING"/>
					<colinfo id="HMT" size="256" summ="default" type="STRING"/>
					<colinfo id="DMT" size="256" summ="default" type="STRING"/>
					<colinfo id="CMT" size="256" summ="default" type="STRING"/>
					<colinfo id="INC" size="256" summ="default" type="STRING"/>
					<colinfo id="GMT" size="256" summ="default" type="STRING"/>
					<colinfo id="GM2" size="256" summ="default" type="STRING"/>
					<colinfo id="COS" size="256" summ="default" type="STRING"/>
					<colinfo id="CO2" size="256" summ="default" type="STRING"/>
					<colinfo id="RAT" size="256" summ="default" type="STRING"/>
					<colinfo id="RA2" size="256" summ="default" type="STRING"/>
					<colinfo id="SMT" size="256" summ="default" type="STRING"/>
					<colinfo id="SM2" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_print2">
				<Contents>
					<colinfo id="RAT1" size="256" summ="default" type="STRING"/>
					<colinfo id="RAT2" size="256" summ="default" type="STRING"/>
					<colinfo id="RAT3" size="256" summ="default" type="STRING"/>
					<colinfo id="RAT4" size="256" summ="default" type="STRING"/>
					<colinfo id="RAT5" size="256" summ="default" type="STRING"/>
					<colinfo id="RAT6" size="256" summ="default" type="STRING"/>
					<colinfo id="RAT7" size="256" summ="default" type="STRING"/>
					<colinfo id="RAT8" size="256" summ="default" type="STRING"/>
					<colinfo id="RAT9" size="256" summ="default" type="STRING"/>
					<colinfo id="RAT10" size="256" summ="default" type="STRING"/>
					<colinfo id="RAT11" size="256" summ="default" type="STRING"/>
					<colinfo id="RAT12" size="256" summ="default" type="STRING"/>
					<colinfo id="RAT13" size="256" summ="default" type="STRING"/>
					<colinfo id="RAT14" size="256" summ="default" type="STRING"/>
					<colinfo id="RAT15" size="256" summ="default" type="STRING"/>
					<colinfo id="RAT16" size="256" summ="default" type="STRING"/>
					<colinfo id="RAT17" size="256" summ="default" type="STRING"/>
					<colinfo id="RAT18" size="256" summ="default" type="STRING"/>
					<colinfo id="RAT19" size="256" summ="default" type="STRING"/>
					<colinfo id="RAT20" size="256" summ="default" type="STRING"/>
					<colinfo id="RAT21" size="256" summ="default" type="STRING"/>
					<colinfo id="RAT22" size="256" summ="default" type="STRING"/>
					<colinfo id="RAT23" size="256" summ="default" type="STRING"/>
					<colinfo id="RAT24" size="256" summ="default" type="STRING"/>
					<record>
						<RAT1></RAT1>
						<RAT10></RAT10>
						<RAT11></RAT11>
						<RAT12></RAT12>
						<RAT13></RAT13>
						<RAT14></RAT14>
						<RAT15></RAT15>
						<RAT16></RAT16>
						<RAT17></RAT17>
						<RAT18></RAT18>
						<RAT19></RAT19>
						<RAT2></RAT2>
						<RAT20></RAT20>
						<RAT21></RAT21>
						<RAT22></RAT22>
						<RAT23></RAT23>
						<RAT24></RAT24>
						<RAT3></RAT3>
						<RAT4></RAT4>
						<RAT5></RAT5>
						<RAT6></RAT6>
						<RAT7></RAT7>
						<RAT8></RAT8>
						<RAT9></RAT9>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_print3">
				<Contents>
					<colinfo id="FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="TEM" size="256" summ="default" type="STRING"/>
					<colinfo id="RDT" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="SIR" size="256" summ="default" type="STRING"/>
					<colinfo id="MATNR" size="256" summ="default" type="STRING"/>
					<colinfo id="MAKTX" size="256" summ="default" type="STRING"/>
					<colinfo id="MTART" size="256" summ="default" type="STRING"/>
					<colinfo id="MENGE" size="256" summ="default" type="STRING"/>
					<colinfo id="MEINS" size="256" summ="default" type="STRING"/>
					<colinfo id="SAMT1" size="256" summ="default" type="STRING"/>
					<colinfo id="SAMT2" size="256" summ="default" type="STRING"/>
					<colinfo id="TAMT" size="256" summ="default" type="STRING"/>
					<colinfo id="MTART_NM" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_print4">
				<Contents>
					<colinfo id="PJT" size="256" summ="default" type="STRING"/>
					<colinfo id="HNO" size="256" summ="default" type="STRING"/>
					<colinfo id="SPC" size="256" summ="default" type="STRING"/>
					<colinfo id="SPC2" size="256" summ="default" type="STRING"/>
					<colinfo id="ISD" size="256" summ="default" type="STRING"/>
					<colinfo id="BLD" size="256" summ="default" type="STRING"/>
					<colinfo id="TAMT" size="256" summ="default" type="STRING"/>
					<colinfo id="COSTT2" size="256" summ="default" type="STRING"/>
					<colinfo id="RAT" size="256" summ="default" type="STRING"/>
					<record>
						<BLD></BLD>
						<COSTT2></COSTT2>
						<HNO></HNO>
						<ISD></ISD>
						<PJT></PJT>
						<RAT></RAT>
						<SPC></SPC>
						<SPC2></SPC2>
						<TAMT></TAMT>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_conf_list">
				<Contents>
					<colinfo id="APRNK_S1" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM_S1" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE_S1" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK_S2" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM_S2" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE_S2" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK_S3" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM_S3" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE_S3" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK_S4" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM_S4" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE_S4" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK_S5" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM_S5" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE_S5" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK_R1" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM_R1" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE_R1" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK_R2" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM_R2" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE_R2" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK_R3" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM_R3" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE_R3" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK_R4" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM_R4" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE_R4" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK_R5" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM_R5" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE_R5" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_draftpers_list">
				<Contents>
					<colinfo id="D_TEM" size="256" summ="default" type="STRING"/>
					<colinfo id="D_RANK" size="256" summ="default" type="STRING"/>
					<colinfo id="D_NAME" size="256" summ="default" type="STRING"/>
					<colinfo id="D_DATE" size="256" summ="default" type="STRING"/>
					<colinfo id="DOCNO" size="256" summ="default" type="STRING"/>
					<colinfo id="D_TOTEM" size="256" summ="default" type="STRING"/>
					<record>
						<D_DATE></D_DATE>
						<D_NAME></D_NAME>
						<D_RANK></D_RANK>
						<D_TEM></D_TEM>
						<D_TOTEM></D_TOTEM>
						<DOCNO></DOCNO>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_docno_gen">
				<Contents>
					<colinfo id="PFX" size="256" type="STRING"/>
					<colinfo id="DOCNO" size="256" type="STRING"/>
					<record>
						<PFX></PFX>
						<DOCNO></DOCNO>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_decide">
				<Contents>
					<colinfo id="MANDT" size="256" summ="default" type="STRING"/>
					<colinfo id="DOCNO" size="256" summ="default" type="STRING"/>
					<colinfo id="DOCKIND" size="256" summ="default" type="STRING"/>
					<colinfo id="APPGUBN" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQNO" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQSTAT" size="256" summ="default" type="STRING"/>
					<colinfo id="APDPT1" size="256" summ="default" type="STRING"/>
					<colinfo id="APDPT1_N" size="256" summ="default" type="STRING"/>
					<colinfo id="APNUM" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE" size="256" summ="default" type="STRING"/>
					<colinfo id="APTIM" size="256" summ="default" type="STRING"/>
					<colinfo id="APDESC" size="256" summ="default" type="STRING"/>
					<colinfo id="APPGUBN2" size="256" summ="default" type="STRING"/>
					<record>
						<APDATE></APDATE>
						<APDESC></APDESC>
						<APDPT1></APDPT1>
						<APDPT1_N></APDPT1_N>
						<APNUM></APNUM>
						<APPGUBN></APPGUBN>
						<APPGUBN2></APPGUBN2>
						<APRNK></APRNK>
						<APTIM></APTIM>
						<DOCKIND></DOCKIND>
						<DOCNO></DOCNO>
						<MANDT></MANDT>
						<SEQNO></SEQNO>
						<SEQSTAT></SEQSTAT>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_count">
				<Contents>
					<colinfo id="CNT" size="256" summ="default" type="STRING"/>
					<record>
						<CNT></CNT>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cost_i">
				<Contents>
					<colinfo id="STD" size="256" summ="default" type="STRING"/>
					<colinfo id="ETD" size="256" summ="default" type="STRING"/>
					<colinfo id="ZYEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="MMN" size="256" summ="default" type="STRING"/>
					<colinfo id="HEP" size="256" summ="default" type="STRING"/>
					<colinfo id="CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="GBU" size="256" summ="default" type="STRING"/>
					<colinfo id="HNO" size="256" summ="default" type="STRING"/>
					<colinfo id="HMT" size="256" summ="default" type="STRING"/>
					<colinfo id="DMT" size="256" summ="default" type="STRING"/>
					<colinfo id="SPC" size="256" summ="default" type="STRING"/>
					<colinfo id="FLR" size="256" summ="default" type="STRING"/>
					<colinfo id="SPD" size="256" summ="default" type="STRING"/>
					<colinfo id="FDT" size="256" summ="default" type="STRING"/>
					<colinfo id="BLD" size="256" summ="default" type="STRING"/>
					<colinfo id="TEM" size="256" summ="default" type="STRING"/>
					<colinfo id="TYN" size="256" summ="default" type="STRING"/>
					<colinfo id="KND" size="256" summ="default" type="STRING"/>
					<colinfo id="AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="ACD" size="256" summ="default" type="STRING"/>
					<colinfo id="HWR" size="256" summ="default" type="STRING"/>
					<colinfo id="DND" size="256" summ="default" type="STRING"/>
					<colinfo id="FHRM" size="256" summ="default" type="STRING"/>
					<colinfo id="FHRU" size="256" summ="default" type="STRING"/>
					<colinfo id="FDPX" size="256" summ="default" type="STRING"/>
					<colinfo id="ABG" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_etn">
				<Contents>
					<colinfo id="TEM" size="256" summ="default" type="STRING"/>
					<colinfo id="RDT" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="SIR" size="256" summ="default" type="STRING"/>
					<record>
						<RDT></RDT>
						<SEQ></SEQ>
						<SIR></SIR>
						<TEM></TEM>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cost_sum_sj">
				<Contents>
					<colinfo id="GMT" size="256" summ="default" type="STRING"/>
					<colinfo id="GM2" size="256" summ="default" type="STRING"/>
					<colinfo id="COST" size="256" summ="default" type="STRING"/>
					<colinfo id="COS2" size="256" summ="default" type="STRING"/>
					<colinfo id="RAT" size="256" summ="default" type="STRING"/>
					<colinfo id="RA2" size="256" summ="default" type="STRING"/>
					<colinfo id="PER" size="256" summ="default" type="STRING"/>
					<colinfo id="SJT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_days">
				<Contents>
					<colinfo id="DAYS" size="256" type="STRING"/>
					<record>
						<DAYS></DAYS>
					</record>
				</Contents>
			</Dataset>
		</Datasets>
		<Shape BKColor="user12" Bottom="66" Height="26" Id="Shape8" Left="7" LineColor="user13" Right="829" TabOrder="68" Top="40" Type="Rectangle" Width="822"></Shape>
		<Shape BKColor="user12" Bottom="241" Height="26" Id="Shape5" Left="7" LineColor="user13" Right="829" TabOrder="43" Top="215" Type="Rectangle" Width="822"></Shape>
		<Shape BKColor="user12" Bottom="592" Height="52" Id="Shape6" Left="7" LineColor="user13" Right="829" TabOrder="52" Top="540" Type="Rectangle" Width="822"></Shape>
		<Shape BKColor="user12" Bottom="116" Height="26" Id="Shape1" Left="7" LineColor="user13" Right="829" TabOrder="4" Top="90" Type="Rectangle" Width="822"></Shape>
		<Shape BKColor="user12" Bottom="141" Height="26" Id="Shape2" Left="7" LineColor="user13" Right="829" TabOrder="5" Top="115" Type="Rectangle" Width="822"></Shape>
		<Shape BKColor="user12" Bottom="216" Height="26" Id="Shape4" Left="7" LineColor="user13" Right="829" TabOrder="19" Top="190" Type="Rectangle" Width="822"></Shape>
		<Shape BKColor="user12" Bottom="166" Height="26" Id="Shape0" Left="7" LineColor="user13" Right="829" TabOrder="14" Top="140" Type="Rectangle" Width="822"></Shape>
		<Shape BKColor="user12" Bottom="191" Height="26" Id="Shape3" Left="7" LineColor="user13" Right="829" TabOrder="18" Top="165" Type="Rectangle" Width="822"></Shape>
		<Grid AutoEnter="TRUE" AutoFitEndLine="Hide" BindDataset="ds_list2" BkColor2="default" BoldHead="true" Border="Flat" Bottom="536" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="216" Id="grd_list2" InputPanel="FALSE" Left="8" LineColor="user20" LineType="ExHORZ" Right="830" RowHeight="20" Style="sty_grid" TabOrder="1" TabStop="true" Top="320" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="822">
			<contents>
				<format id="Default">
					<columns>
						<col width="30"/>
						<col width="50"/>
						<col width="50"/>
						<col width="40"/>
						<col width="140"/>
						<col width="70"/>
						<col width="60"/>
						<col width="110"/>
						<col width="70"/>
						<col width="70"/>
						<col width="45"/>
						<col width="60"/>
						<col width="65"/>
						<col width="65"/>
						<col width="40"/>
						<col width="65"/>
						<col width="65"/>
						<col width="40"/>
						<col width="60"/>
						<col width="65"/>
						<col width="70"/>
						<col width="65"/>
						<col width="70"/>
					</columns>
					<head>
						<cell align="center" col="0" color="user21" display="text" font="굴림,9" text="No"/>
						<cell align="center" col="1" color="user21" display="text" font="굴림,9" text="통합PJT"/>
						<cell align="center" col="2" color="user21" display="text" font="굴림,9" text="원PJT"/>
						<cell align="center" col="3" color="user21" display="text" font="굴림,9" text="호기"/>
						<cell align="center" col="4" color="user21" display="text" font="굴림,9" text="현장명"/>
						<cell align="center" col="5" color="user21" display="text" font="굴림,9" text="건물용도"/>
						<cell align="center" col="6" color="user21" display="text" font="굴림,9" text="전기기종"/>
						<cell align="center" col="7" color="user21" display="text" font="굴림,9" text="사양"/>
						<cell align="center" col="8" color="user21" display="text" font="굴림,9" text="완성검사일"/>
						<cell align="center" col="9" color="user21" display="text" font="굴림,9" text="인수일"/>
						<cell align="center" col="10" color="user21" display="text" font="굴림,9" text="감시반"/>
						<cell align="center" bkcolor="user13" col="11" color="user21" display="text" font="굴림,9" text="SEG"/>
						<cell align="center" bkcolor="user13" col="12" color="user21" display="text" font="굴림,9" text="표준&#32;FM"/>
						<cell align="center" col="13" color="user21" display="text" font="굴림,9" text="FM보수료"/>
						<cell align="center" bkcolor="user37" col="14" color="user21" display="text" font="굴림,9" text="달성율"/>
						<cell align="center" bkcolor="user13" col="15" color="user21" display="text" font="굴림,9" text="표준&#32;POG"/>
						<cell align="center" col="16" color="user21" display="text" font="굴림,9" text="POG보수료"/>
						<cell align="center" bkcolor="user37" col="17" color="user21" display="text" font="굴림,9" text="달성율"/>
						<cell align="center" col="18" color="user21" display="text" font="굴림,9" text="유무선"/>
						<cell align="center" col="19" color="user21" display="text" font="굴림,9" text="HRTS료"/>
						<cell align="center" col="20" color="user21" display="text" font="굴림,9" text="DI-PBX종류"/>
						<cell align="center" col="21" color="user21" display="text" font="굴림,9" text="DI-PBX료"/>
						<cell align="center" col="22" color="user21" display="text" font="굴림,9" text="합계"/>
					</head>
					<body>
						<cell align="center" bkcolor2="user22" col="0" display="text" expr="currow+1"/>
						<cell align="center" bkcolor2="user22" col="1" colid="UPN" combodisplayrowcnt="6" display="text"/>
						<cell align="center" bkcolor2="user22" col="2" colid="PJT" combodisplayrowcnt="6" display="text"/>
						<cell align="center" bkcolor2="user22" col="3" colid="HNO" display="text"/>
						<cell align="left" bkcolor2="user22" col="4" colid="SPT" display="text"/>
						<cell align="center" bkcolor2="user22" col="5" colid="TBLD" combocol="CODE" combodataset="ds_tbld" combotext="CODE_NAME" display="combo"/>
						<cell align="center" bkcolor2="user22" col="6" colid="SPC" display="text"/>
						<cell bkcolor2="user22" col="7" colid="SPC2" display="text"/>
						<cell align="center" bkcolor2="user22" col="8" colid="WDT" display="text" Mask="####.##.##"/>
						<cell align="center" bkcolor2="user22" col="9" colid="ISD" display="text" Mask="####.##.##"/>
						<cell align="center" bkcolor2="user22" col="10" colid="TYN" display="text" limit="3"/>
						<cell align="center" bkcolor2="user22" col="11" colid="SEG" display="text" limit="3"/>
						<cell align="right" bkcolor2="user22" col="12" colid="F10" display="number"/>
						<cell align="right" bkcolor2="user22" col="13" colid="FMT" display="number" edit="number"/>
						<cell align="right" bkcolor2="user22" col="14" colid="FRAT" display="number"/>
						<cell align="right" bkcolor2="user22" col="15" colid="P10" display="number"/>
						<cell align="right" bkcolor2="user22" col="16" colid="PMT" display="number" edit="number"/>
						<cell align="right" bkcolor2="user22" col="17" colid="PRAT" display="number"/>
						<cell align="center" bkcolor2="user22" col="18" colid="HWR" combocol="CODE" combodataset="ds_hwr" combotext="CODE_NAME" display="combo" edit="combo"/>
						<cell align="right" bkcolor2="user22" col="19" colid="HMT" display="number" edit="number"/>
						<cell align="center" bkcolor2="user22" col="20" colid="DND" combocol="CODE" combodataset="ds_dnd" combotext="CODE_NAME" display="combo" edit="combo"/>
						<cell align="right" bkcolor2="user22" col="21" colid="DMT" display="number" edit="number"/>
						<cell align="right" bkcolor2="user22" col="22" colid="AMT" display="number"/>
					</body>
					<summary>
						<cell align="center" bkcolor="user25" col="0" color="user26" colspan="4" display="text" font="굴림,9" text="합&#32;계"/>
						<cell align="center" bkcolor="user25" col="4" color="user26" display="text"/>
						<cell align="center" bkcolor="user25" col="5" color="user26" display="text"/>
						<cell align="center" bkcolor="user25" col="6" color="user26" display="text"/>
						<cell align="center" bkcolor="user25" col="7" color="user26" display="text"/>
						<cell align="center" bkcolor="user25" col="8" color="user26" display="text"/>
						<cell align="center" bkcolor="user25" col="9" color="user26" display="text"/>
						<cell align="center" bkcolor="user25" col="10" color="user26" display="text"/>
						<cell align="center" bkcolor="user25" col="11" color="user26" display="text"/>
						<cell align="right" bkcolor="user25" col="12" color="user26" display="number" expr='sum(&quot;F10&quot;)'/>
						<cell align="right" bkcolor="user25" col="13" color="user26" display="number" expr='sum(&quot;FMT&quot;)'/>
						<cell align="right" bkcolor="user25" col="14" color="user26" display="number" expr='round(avg(&quot;FRAT&quot;),1)'/>
						<cell align="right" bkcolor="user25" col="15" color="user26" display="number" expr='sum(&quot;P10&quot;)'/>
						<cell align="right" bkcolor="user25" col="16" color="user26" display="number" expr='sum(&quot;PMT&quot;)'/>
						<cell align="right" bkcolor="user25" col="17" color="user26" display="number" expr='round(avg(&quot;PRAT&quot;),1)'/>
						<cell align="center" bkcolor="user25" col="18" color="user26" display="text"/>
						<cell align="right" bkcolor="user25" col="19" color="user26" display="number" expr='sum(&quot;HMT&quot;)'/>
						<cell align="center" bkcolor="user25" col="20" color="user26" display="text"/>
						<cell align="right" bkcolor="user25" col="21" color="user26" display="number" expr='sum(&quot;DMT&quot;)'/>
						<cell align="right" bkcolor="user25" col="22" color="user26" display="number" expr='sum(&quot;AMT&quot;)'/>
					</summary>
				</format>
			</contents>
		</Grid>
		<Div Height="36" Id="div_btn" TabOrder="2" Text="Div0" ToolTipFont="Default,0" Url="WB01::CommBtnForm.xml" Width="837">
			<Contents></Contents>
		</Div>
		<Calendar Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="146" Id="cal_temp" Left="1032" MonthOnly="TRUE" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" OnChanged="cal_temp_OnChanged" OnDayClick="cal_temp_OnDayClick" OnKillFocus="cal_temp_OnKillFocus" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="3" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="152" Value="20130101" Visible="FALSE" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="152"></Calendar>
		<Static Align="Right" Height="24" Id="st_etn" Left="8" Style="sty_lb_form_basic" TabOrder="6" Text="견적번호&#32;" Top="91" VAlign="Middle" Width="80"></Static>
		<Static Align="Right" Height="24" Id="st_mdt" Left="418" Style="sty_lb_form_basic" TabOrder="8" Text="견적작성일&#32;" Top="91" VAlign="Middle" Width="80"></Static>
		<Static Align="Right" Height="24" Id="st_midnm" Left="8" Style="sty_lb_form_basic" TabOrder="9" Text="견적작성자&#32;" Top="116" VAlign="Middle" Width="80"></Static>
		<Edit BindDataset="ds_head" Border="Flat" Column="ETN" Enable="FALSE" Height="20" Id="ed_etn" Left="90" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="7" Top="93" Width="120"></Edit>
		<Edit BindDataset="ds_head" Border="Flat" Column="SPT" Height="20" Id="ed_spt" Left="295" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="13" Top="143" Width="120"></Edit>
		<Static Align="Right" Height="24" Id="st_spt" Left="213" Style="sty_lb_form_basic" TabOrder="12" Text="현장명&#32;" Top="141" VAlign="Middle" Width="80"></Static>
		<Edit BindDataset="ds_head" Border="Flat" Column="NAM" Height="20" Id="ed_nam" Left="90" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="11" Top="143" Width="120"></Edit>
		<Static Align="Right" Height="24" Id="st_nam" Left="8" Style="sty_lb_form_basic" TabOrder="10" Text="고객명&#32;" Top="141" VAlign="Middle" Width="80"></Static>
		<Static Align="Right" Height="24" Id="st_adr" Left="8" Style="sty_lb_form_basic" TabOrder="15" Text="현장주소&#32;" Top="166" VAlign="Middle" Width="80"></Static>
		<Edit BindDataset="ds_head" Border="Flat" CheckLength="Byte" Column="ADR" Height="20" Id="ed_adr" Left="90" LeftMargin="4" MaxLength="100" Style="sty_ipt_form" TabOrder="16" Top="168" Width="325"></Edit>
		<Calendar BindDataset="ds_head" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="MDT" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Enable="FALSE" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_mdt" Left="500" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="17" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="93" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="118"></Calendar>
		<Edit BindDataset="ds_head" Border="Flat" Column="MID_NM" Enable="FALSE" Height="20" Id="ed_midnm" Left="90" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="20" Top="118" Width="120"></Edit>
		<Static Align="Right" Height="24" Id="st_sir" Left="213" Style="sty_lb_form_basic" TabOrder="21" Text="차수&#32;" Top="91" VAlign="Middle" Width="80"></Static>
		<Edit BindDataset="ds_head" Border="Flat" Column="SIR" Enable="FALSE" Height="20" Id="ed_sir" ImeMode="none" Left="295" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="22" Top="93" Width="120"></Edit>
		<Static Align="Right" Height="24" Id="st_cdt" Left="213" Style="sty_lb_form_basic" TabOrder="23" Text="계약예정일&#32;" Top="116" VAlign="Middle" Width="80"></Static>
		<Calendar BindDataset="ds_head" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="CDT" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_cdt" Left="295" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" OnChanged="cal_cdt_OnChanged" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="24" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="118" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="120"></Calendar>
		<Static Align="Right" Height="24" Id="st_prd" Left="621" Style="sty_lb_form_basic" TabOrder="25" Text="점검주기&#32;" Top="216" VAlign="Middle" Width="80"></Static>
		<Combo BindDataset="ds_head" Border="Flat" CodeColumn="CODE" Column="PRD" DataColumn="CODE_NAME" Height="20" Id="cb_prd" InnerDataset="ds_prd" Left="704" Style="sty_ipt_form" TabOrder="26" Top="217" Width="123"></Combo>
		<Static Align="Right" Height="24" Id="st_pjt" Left="418" Style="sty_lb_form_basic" TabOrder="27" Text="프로젝트&#32;" Top="141" VAlign="Middle" Width="80"></Static>
		<Edit BindDataset="ds_head" Border="Flat" Column="PJT" Height="20" Id="ed_pjt" Left="500" LeftMargin="4" MaxLength="6" RightMargin="4" Style="sty_ipt_form" TabOrder="28" Top="143" Width="118"></Edit>
		<Static Align="Right" Height="24" Id="st_spc" Left="418" Style="sty_lb_form_basic" TabOrder="29" Text="기종&#32;" Top="166" VAlign="Middle" Width="80"></Static>
		<Edit BindDataset="ds_head" Border="Flat" Column="SPC" Height="20" Id="ed_spc" Left="500" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="30" Top="168" Width="118"></Edit>
		<Static Height="21" Id="st_hwr" Left="296" TabOrder="31" Text="HRTS&#32;회선종류" Top="656" Visible="FALSE" Width="88"></Static>
		<Static Height="21" Id="st_dnd" Left="392" TabOrder="32" Text="DI-PBX&#32;종류" Top="656" Visible="FALSE" Width="78"></Static>
		<Static Align="Right" Height="24" Id="st_cdy" Left="418" Style="sty_lb_form_basic" TabOrder="33" Text="유상계약기간&#32;" Top="116" VAlign="Middle" Width="80"></Static>
		<Static Align="Right" Height="24" Id="st_cnd" Left="621" Style="sty_lb_form_basic" TabOrder="34" Text="계약유형&#32;" Top="141" VAlign="Middle" Width="80"></Static>
		<Static Align="Right" Height="24" Id="st_ygb" Left="621" Style="sty_lb_form_basic" TabOrder="35" Text="영업주체&#32;" Top="191" VAlign="Middle" Width="80"></Static>
		<Combo BindDataset="ds_head" Border="Flat" CodeColumn="CODE" Column="CND" DataColumn="CODE_NAME" Enable="FALSE" Height="20" Id="cb_cnd" InnerDataset="ds_cnd" Left="704" Style="sty_ipt_form" TabOrder="36" Top="142" Width="123"></Combo>
		<Combo BindDataset="ds_head" Border="Flat" CodeColumn="CODE" Column="YGB" DataColumn="CODE_NAME" Height="20" Id="cb_ygb" InnerDataset="ds_ygb" Left="704" Style="sty_ipt_form" TabOrder="37" Top="192" Width="123"></Combo>
		<Static Align="Right" Height="24" Id="st_cnt" Left="8" Style="sty_lb_form_basic" TabOrder="38" Text="대수&#32;" Top="191" VAlign="Middle" Width="80"></Static>
		<Edit BindDataset="ds_head" Border="Flat" Column="CNT" Enable="FALSE" Height="20" Id="ed_cnt" Left="90" LeftMargin="3" MaxLength="3" Number="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="39" Top="193" Width="120"></Edit>
		<Static Align="Right" Height="24" Id="st_flr" Left="213" Style="sty_lb_form_basic" TabOrder="40" Text="층수&#32;" Top="191" VAlign="Middle" Width="80"></Static>
		<Edit BindDataset="ds_head" Border="Flat" Column="FLR" Height="20" Id="ed_flr" Left="295" LeftMargin="3" MaxLength="3" Number="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="41" Top="193" Width="120"></Edit>
		<Static Align="Right" Height="24" Id="st_spd" Left="418" Style="sty_lb_form_basic" TabOrder="42" Text="속도&#32;" Top="191" VAlign="Middle" Width="80"></Static>
		<Combo BindDataset="ds_head" Border="Flat" CodeColumn="CODE" Column="CYN" DataColumn="CODE_NAME" Enable="FALSE" Height="20" Id="cb_cyn" InnerDataset="ds_cyn" Left="89" Style="sty_ipt_form" TabOrder="45" Top="217" Width="123"></Combo>
		<Static Align="Right" Height="24" Id="st_cyn" Left="8" Style="sty_lb_form_basic" TabOrder="44" Text="CRT유무&#32;" Top="216" VAlign="Middle" Width="80"></Static>
		<Static Align="Right" Height="24" Id="st_hyn" Left="213" Style="sty_lb_form_basic" TabOrder="46" Text="HRTS유무&#32;" Top="216" VAlign="Middle" Width="80"></Static>
		<Combo BindDataset="ds_head" Border="Flat" CodeColumn="CODE" Column="HYN" DataColumn="CODE_NAME" Enable="FALSE" Height="20" Id="cb_hyn" InnerDataset="ds_hyn" Left="294" Style="sty_ipt_form" TabOrder="47" Top="217" Width="123"></Combo>
		<Static Align="Right" Height="24" Id="st_dyn" Left="418" Style="sty_lb_form_basic" TabOrder="48" Text="DI-PBX유무&#32;" Top="216" VAlign="Middle" Width="80"></Static>
		<Combo BindDataset="ds_head" Border="Flat" CodeColumn="CODE" Column="DYN" DataColumn="CODE_NAME" Enable="FALSE" Height="20" Id="cb_dyn" InnerDataset="ds_dyn" Left="499" Style="sty_ipt_form" TabOrder="49" Top="217" Width="118"></Combo>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_matnr" ImageID="btn_sub_06" Left="644" LeftMargin="12" OnClick="btn_matnr_OnClick" Style="sty_btn" TabOrder="50" Text="투입예상자재" Top="43" Transparent="TRUE" Width="95"></Button>
		<TextArea BindDataset="ds_head" Border="Flat" Column="RMK" Height="52" Id="txt_rmk" Left="88" MaxLength="500" Style="sty_ipt_form" TabOrder="51" Top="540" VScroll="TRUE" Width="584"></TextArea>
		<Static Align="Right" Height="50" Id="Static0" Left="8" Style="sty_lb_form_basic" TabOrder="53" Text="특이사항&#32;&#10;&#32;(500자)&#32;" Top="541" VAlign="Middle" Width="80"></Static>
		<Static Align="Right" Height="24" Id="st_cpd" Left="621" Style="sty_lb_form_basic" TabOrder="54" Text="계약상품&#32;" Top="91" VAlign="Middle" Width="80"></Static>
		<Combo BindDataset="ds_head" Border="Flat" CodeColumn="CODE" Column="CPD" DataColumn="CODE_NAME" Height="20" Id="cb_cpd" InnerDataset="ds_cpd" Left="704" OnChanged="cb_cpd_OnChanged" Style="sty_ipt_form" TabOrder="55" Top="92" Width="123"></Combo>
		<Combo BindDataset="ds_head" Border="Flat" CodeColumn="CODE" Column="SPD" DataColumn="CODE_NAME" Height="20" Id="cb_spd" InnerDataset="ds_spd" Left="499" Style="sty_ipt_form" TabOrder="56" Top="192" Width="118"></Combo>
		<Shape BKColor="user12" Bottom="266" Height="26" Id="Shape7" Left="7" LineColor="user13" Right="829" TabOrder="57" Top="240" Type="Rectangle" Width="822"></Shape>
		<Static Align="Right" Height="24" Id="st_bld" Left="8" Style="sty_lb_form_basic" TabOrder="58" Text="건물용도&#32;" Top="241" VAlign="Middle" Width="80"></Static>
		<Combo BindDataset="ds_head" Border="Flat" CodeColumn="CODE" Column="BLD" DataColumn="CODE_NAME" Height="20" Id="cb_bld" InnerDataset="ds_bld" Left="89" Style="sty_ipt_form" TabOrder="59" Top="242" Width="123"></Combo>
		<Static Align="Right" Height="24" Id="st_srg" Left="213" Style="sty_lb_form_basic" TabOrder="60" Text="S/R&#32;" Top="241" VAlign="Middle" Width="80"></Static>
		<Combo BindDataset="ds_head" Border="Flat" CodeColumn="CODE" Column="SRG" DataColumn="CODE_NAME" Height="20" Id="cb_srg" InnerDataset="ds_srg" Left="294" Style="sty_ipt_form" TabOrder="61" Top="242" Width="123"></Combo>
		<Static Align="Right" Height="24" Id="st_pdt" Left="418" Style="sty_lb_form_basic" TabOrder="62" Text="제품군&#32;" Top="241" VAlign="Middle" Width="80"></Static>
		<Combo BindDataset="ds_head" Border="Flat" CodeColumn="CODE" Column="PDT" DataColumn="CODE_NAME" Height="20" Id="cb_pdt" InnerDataset="ds_pdt" Left="499" Style="sty_ipt_form" TabOrder="63" Top="242" Width="118"></Combo>
		<Static Align="Right" Height="24" Id="st_syr" Left="621" Style="sty_lb_form_basic" TabOrder="64" Text="설치연령&#32;" Top="241" VAlign="Middle" Width="80"></Static>
		<Combo BindDataset="ds_head" Border="Flat" CodeColumn="CODE" Column="SYR" DataColumn="CODE_NAME" Height="20" Id="cb_syr" InnerDataset="ds_syr" Left="704" Style="sty_ipt_form" TabOrder="65" Top="242" Width="123"></Combo>
		<Static Align="Right" Height="24" Id="st_app" Left="418" Style="sty_lb_form_basic" TabOrder="66" Text="결재상태&#32;" Top="41" VAlign="Middle" Width="80"></Static>
		<Combo BindDataset="ds_head" Border="Flat" CodeColumn="CODE" Column="APSTAT" DataColumn="DTEXT1" Enable="FALSE" Height="20" Id="cb_apstat" InnerDataset="ds_apstat" Left="499" Style="sty_ipt_search" TabOrder="66" Top="42" Width="118"></Combo>
		<Static Align="Right" Height="24" Id="st_ra1" Left="870" Style="sty_lb_form_basic" TabOrder="69" Text="시행율1&#32;" Top="38" VAlign="Middle" Width="80"></Static>
		<Edit Align="RIGHT" BindDataset="ds_head" Border="Flat" Column="RA1" Enable="FALSE" Height="20" Id="ed_ra1" Left="952" LeftMargin="4" RightMargin="3" Style="sty_ipt_form" TabOrder="70" Top="40" Width="120"></Edit>
		<Static Align="Right" Height="24" Id="st_ra2" Left="213" Style="sty_lb_form_basic" TabOrder="71" Text="시행율2&#32;" Top="41" VAlign="Middle" Width="80"></Static>
		<Edit Align="RIGHT" BindDataset="ds_head" Border="Flat" Column="RA2" Enable="FALSE" Height="20" Id="ed_ra2" Left="295" LeftMargin="4" RightMargin="3" Style="sty_ipt_form" TabOrder="72" Top="43" Width="120"></Edit>
		<Shape BKColor="user12" Bottom="91" Height="26" Id="Shape9" Left="7" LineColor="user13" Right="829" TabOrder="75" Top="65" Type="Rectangle" Width="822"></Shape>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_addmat" ImageID="btn_sub_05" Left="742" LeftMargin="12" OnClick="btn_addmat_OnClick" Style="sty_btn" TabOrder="73" Text="추가자재" Top="43" Transparent="TRUE" Width="83"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_cos" ImageID="btn_sub_06" Left="731" LeftMargin="12" OnClick="btn_cos_OnClick" Style="sty_btn" TabOrder="74" Text="원가내역조회" Top="68" Transparent="TRUE" Width="95"></Button>
		<Static Align="Right" Height="24" Id="Static1" Left="418" Style="sty_lb_form_basic" TabOrder="75" Text="전결규정&#32;" Top="66" VAlign="Middle" Width="80"></Static>
		<Static Align="Right" Height="24" Id="st_mmn" Left="8" Style="sty_lb_form_basic" TabOrder="76" Text="무상개월수&#32;" Top="66" VAlign="Middle" Width="80"></Static>
		<Static Align="Right" Height="24" Id="st_dat" Left="213" Style="sty_lb_form_basic" TabOrder="77" Text="인하율&#32;" Top="66" VAlign="Middle" Width="80"></Static>
		<Edit Align="RIGHT" BindDataset="ds_head" Border="Flat" Column="DAT" Enable="FALSE" Height="20" Id="ed_dat" Left="295" LeftMargin="4" RightMargin="3" Style="sty_ipt_form" TabOrder="78" Top="68" Width="120"></Edit>
		<Shape BKColor="user12" Bottom="316" Height="26" Id="Shape10" Left="7" LineColor="user13" Right="829" TabOrder="80" Top="290" Type="Rectangle" Width="822"></Shape>
		<Static Align="Right" Height="24" Id="st_1st" Left="8" Style="sty_lb_form_basic" TabOrder="81" Text="1차견적&#32;" Top="291" VAlign="Middle" Width="80"></Static>
		<Static Align="Right" Height="24" Id="st_2nd" Left="213" Style="sty_lb_form_basic" TabOrder="82" Text="2차견적&#32;" Top="291" VAlign="Middle" Width="80"></Static>
		<Static Align="Right" Height="24" Id="st_3rd" Left="418" Style="sty_lb_form_basic" TabOrder="83" Text="3차견적&#32;" Top="291" VAlign="Middle" Width="80"></Static>
		<Static Align="Right" Height="24" Id="st_lat" Left="621" Style="sty_lb_form_basic" TabOrder="84" Text="종전보수료&#32;" Top="291" VAlign="Middle" Width="80"></Static>
		<Edit BindDataset="ds_head" Border="Flat" Column="COF" Enable="FALSE" Height="20" Id="ed_cof" Left="500" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="85" Top="68" Width="100"></Edit>
		<Shape BKColor="user12" Bottom="643" Height="52" Id="Shape11" Left="7" LineColor="user13" Right="829" TabOrder="87" Top="591" Type="Rectangle" Width="822"></Shape>
		<TextArea BindDataset="ds_head" Border="Flat" Column="OPN" Height="52" Id="txt_opn" Left="88" MaxLength="250" Style="sty_ipt_form" TabOrder="86" Top="591" VScroll="TRUE" Width="689"></TextArea>
		<Static Align="Right" Height="50" Id="st_opn" Left="8" Style="sty_lb_form_basic" TabOrder="88" Text="검토의견&#32;&#10;&#32;(250자)&#32;" Top="592" VAlign="Middle" Width="80"></Static>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_saveopn" ImageID="btn_sub_02" Left="779" LeftMargin="12" OnClick="btn_saveopn_OnClick" Style="sty_btn" TabOrder="89" Text="저장" Top="608" Transparent="TRUE" Width="47"></Button>
		<MaskEdit BindDataset="ds_his" Border="Flat" Column="AVR1" Enable="FALSE" Height="20" Id="med_1st" Left="90" Mask="###,###" Style="sty_ipt_form" TabOrder="90" Top="293" Width="70"></MaskEdit>
		<MaskEdit BindDataset="ds_his" Border="Flat" Column="AVR2" Enable="FALSE" Height="20" Id="med_avr2" Left="295" Mask="###,###" Style="sty_ipt_form" TabOrder="91" Top="293" Width="70"></MaskEdit>
		<MaskEdit BindDataset="ds_his" Border="Flat" Column="AVR3" Enable="FALSE" Height="20" Id="med_avr3" Left="500" Mask="###,###" Style="sty_ipt_form" TabOrder="92" Top="293" Width="70"></MaskEdit>
		<MaskEdit BindDataset="ds_his" Border="Flat" Column="LAS" Enable="FALSE" Height="20" Id="med_las" Left="705" Mask="###,###" Style="sty_ipt_form" TabOrder="93" Top="293" Width="70"></MaskEdit>
		<Static Align="Right" Height="24" Id="Static2" Left="621" Style="sty_lb_form_basic" TabOrder="94" Text="영업담당자" Top="166" VAlign="Middle" Width="80"></Static>
		<Edit BindDataset="ds_head" Border="Flat" Column="ZMAN" Height="20" Id="Edit0" Left="704" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="95" Top="168" Width="120"></Edit>
		<Button Cursor="HAND" Height="18" Id="btn_pri" ImageID="btn_icon_search" Left="777" OnClick="btn_pri_OnClick" TabOrder="96" Text="Button0" Top="119" Width="18"></Button>
		<Static Height="15" Id="Static3" Left="632" TabOrder="97" Text="~" Top="120" Width="17"></Static>
		<Shape BKColor="user12" Bottom="291" Height="26" Id="Shape12" Left="7" LineColor="user13" Right="829" TabOrder="100" Top="265" Type="Rectangle" Width="822"></Shape>
		<Static Align="Right" Height="24" Id="Static4" Left="213" Style="sty_lb_form_basic" TabOrder="99" Text="상주금액" Top="266" VAlign="Middle" Width="80"></Static>
		<Static Align="Right" Height="24" Id="Static5" Left="8" Style="sty_lb_form_basic" TabOrder="98" Text="인원상주조건&#32;" Top="266" VAlign="Middle" Width="80"></Static>
		<Static Align="Right" Height="24" Id="Static6" Left="418" Style="sty_lb_form_basic" TabOrder="101" Text="기성지급율" Top="266" VAlign="Middle" Width="80"></Static>
		<Static Align="Right" Height="24" Id="st_gbu" Left="621" Style="sty_lb_form_basic" TabOrder="102" Text="직영구분&#32;" Top="266" VAlign="Middle" Width="80"></Static>
		<Combo BindDataset="ds_head" Border="Flat" CodeColumn="CODE" Column="GBU" DataColumn="CODE_NAME" Enable="FALSE" Height="20" Id="cb_gbu" InnerDataset="ds_gbu" Left="704" Style="sty_ipt_form" TabOrder="103" Top="267" Width="123"></Combo>
		<Calendar BindDataset="ds_head" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="STD" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_from" Left="501" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" OnChanged="cal_from_OnChanged" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="104" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="118" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="120"></Calendar>
		<Calendar BindDataset="ds_head" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="ETD" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_to" Left="651" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" OnChanged="cal_to_OnChanged" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="105" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="118" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="120"></Calendar>
		<Static Height="13" Id="Static7" Left="142" TabOrder="106" Text="인원수" Top="271" Width="40"></Static>
		<Static Height="15" Id="Static8" Left="163" TabOrder="107" Text="(증감율)" Top="297" Width="56"></Static>
		<Static Height="15" Id="Static9" Left="368" TabOrder="108" Text="(증감율)" Top="297" Width="56"></Static>
		<Static Height="15" Id="Static10" Left="571" TabOrder="109" Text="(증감율)" Top="297" Width="56"></Static>
		<Static Height="15" Id="Static11" Left="779" TabOrder="110" Text="(증감율)" Top="297" Width="56"></Static>
		<Static Height="15" Id="Static12" Left="600" TabOrder="111" Text="%" Top="272" Width="17"></Static>
		<MaskEdit BindDataset="ds_head" Border="Flat" Column="GIS" DecimalLen="1" DigitLen="3" Enable="FALSE" Height="20" Id="MaskEdit0" Left="500" Mask="####.#" NullValue="90.0" Style="sty_ipt_form" TabOrder="112" Top="268" Value="90.0" Width="92"></MaskEdit>
		<MaskEdit BindDataset="ds_head" Border="Flat" Column="SAJ" Enable="FALSE" Height="20" Id="MaskEdit2" Left="294" Mask="###,###" NullValue="0" Style="sty_ipt_form" TabOrder="113" Top="268" Value="0" Width="123"></MaskEdit>
		<MaskEdit BindDataset="ds_head" Border="Flat" Column="PNT" Enable="FALSE" Height="20" Id="ed_pnt" Left="180" Mask="###,###" NullValue="0" Style="sty_ipt_form" TabOrder="114" Top="268" Value="0" Width="30"></MaskEdit>
		<Edit BindDataset="ds_head" Border="Flat" Column="COF2" Enable="FALSE" Height="20" Id="ed_cof2" Left="603" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="115" Top="68" Width="100"></Edit>
		<Edit Align="RIGHT" BindDataset="ds_head" Border="Flat" Column="MMN" Enable="FALSE" Height="20" Id="ed_mmn" Left="90" LeftMargin="4" RightMargin="3" Style="sty_ipt_form" TabOrder="116" Top="67" Width="120"></Edit>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_sangju" ImageID="btn_sub_02" Left="90" LeftMargin="12" OnClick="btn_sangju_OnClick" Style="sty_btn" TabOrder="117" Text="입력" Top="268" Transparent="TRUE" Width="48"></Button>
		<Static Align="Right" Height="24" Id="st_trat" Left="8" Style="sty_lb_form_basic" TabOrder="118" Text="달성율&#32;" Top="41" VAlign="Middle" Width="80"></Static>
		<MaskEdit BindDataset="ds_head" Border="Flat" Column="TRAT" DecimalLen="1" DigitLen="3" Enable="FALSE" Height="20" Id="med_trat" Left="90" Mask="####.#" Style="sty_ipt_form" TabOrder="119" Top="43" Width="120"></MaskEdit>
		<Edit BindDataset="ds_head" Border="Flat" Column="COF3" Enable="FALSE" Height="20" Id="ed_cof3" Left="952" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="121" Top="80" Width="100"></Edit>
		<Static Align="Right" Height="24" Id="Static13" Left="870" Style="sty_lb_form_basic" TabOrder="120" Text="전결규정&#32;" Top="78" VAlign="Middle" Width="80"></Static>
	</Form>
	<Script><![CDATA[﻿﻿﻿﻿﻿﻿﻿﻿/*
 ******************************************************************************************
 * 기      능   : 
 * 작  성  자   : 
 * 작성  일자   : 
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
#include "LIB::commons.js";	// 공통 스크립트 
#include "LIB::utility.js";	// 다중 선택 
//=========================================================================================
// [ PART 1 ]
// Form에서 사용될 전역변수를 선언
// FORM에서 사용되는 전역변수는 대문자로 작성하며, F_XXX 의 형태를 갖도록 한다. 
//=========================================================================================
var userGroup;
var gRow = null;
var t_costT; //원가
var t_costT2; //원가(투입예상자재)
var t_cos1; //간접비제외 원가
var t_cos2; //간접비제외 원가(투입예상자재)
var t_costA; //직접비
var t_costA_2; //직접비(투입예상자재)
var t_costB; //간접비
var t_costB_2; //간접비(투입예상자재)
var t_costC; //HRTS
var t_costD; //DI-PBX
var t_nmt; //직접노무비
var t_jmt; //직접재료비
var t_jmt2; //직접재료비(투입예상자재)
var t_kmt; //직접경비
var t_hmt; //HRTS비용
var t_dmt; //DI-PBX비용
var t_cmt; //검사수수료
var t_gmt; //간접비
var t_gmt2; //간접비(투입예상자재)
var chk_fst = 0;
var chk_fst2 = 0;
var chk_fst3 = 0;
var chk_fst4 = 0;
var fa_reqno;
var currRow = 0;
var mode;
var lnk;
//=========================================================================================
// [ PART 2 ]
// Form Loading / Unloading 시 작업 정의
//=========================================================================================
function fn_OnLoadCompleted(obj) {
	gfn_initForm();

    var codeArr = ["WBAP_STAT","CS123"];
    var dsObjArr = [ds_apstat,ds_tbld];
    var addTypeArr = [G_CODE_NONE,G_CODE_NONE];
    gfn_searchCommCode(codeArr, dsObjArr, addTypeArr, true);
    
    // 버튼초기화
	div_btn.btn_decide.Enable 	= false;	// 결재버튼
	div_btn.btn_sendback.Enable = false;  	// 반송버튼

	if(lnk == "INS") { //신규견적 작성시
		div_btn.btn_recost.Enable = false;
		div_btn.btn_delete.Enable = false;
		div_btn.btn_print.Enable = false;
		div_btn.btn_trans.Enable = false;
		div_btn.btn_draft.Enable = false;
		fn_setHno();
	} else if(lnk == "PLN") { //이동계획에서 작성시
		div_btn.btn_recost.Enable = false;
		div_btn.btn_delete.Enable = false;
		div_btn.btn_print.Enable = false;
		div_btn.btn_trans.Enable = false;
		div_btn.btn_draft.Enable = false;
		fn_setPlnHno();
	} else { //기존견적 수정시
		fn_selHno();
	}
}

/********************************************************************************
* 기      능   : 공통코드가 조회된 후의 Callback 함수 
********************************************************************************/
function fn_completeInit(sCode, sDsObj, sCodeType) {
	var user_grp = gfn_getUserGroup();

	if(user_grp == "40") {
		btn_saveopn.Visible = true;
	} else {
		btn_saveopn.Visible = false;
	}
}

/********************************************************************************
* 기      능   : form UnloadCompleted 
********************************************************************************/
function fn_OnUnloadCompleted(obj) {
	return gfn_isFormUnload(obj);
}


function fn_btnInit() {
	userGroup = gfn_getUserGroup();

	if(ds_head.GetColumn(0, "PST") == "A1") {
		div_btn.btn_save.Enable = true;
		div_btn.btn_delete.Enable = true;
		div_btn.btn_trans.Enable = true;
		div_btn.btn_recost.Enable = false;
		div_btn.btn_print.Enable = false;
		div_btn.btn_draft.Enable = false;

		cal_cdt.Enable = true;
		ed_nam.Enable = true;
		ed_spt.Enable = true;
		ed_pjt.Enable = true;
		ed_adr.Enable = true;
		ed_spc.Enable = true;
		cb_prd.Enable = true;

		grd_list2.Editable = true;
	} else if((ds_head.GetColumn(0, "PST") == "A2" || ds_head.GetColumn(0, "PST") == "A6")) {
		div_btn.btn_save.Enable = false;		
		div_btn.btn_draft.Enable = false;
		if(G_USER_ID = "2020882") {
			div_btn.btn_delete.Enable = true;
		} else{
			div_btn.btn_delete.Enable = false;		
		}    
		div_btn.btn_trans.Enable = false;
		if(isExistVar("fa_popgbn", true))
			div_btn.btn_recost.Enable = false;
		else
			div_btn.btn_recost.Enable = true;

		cal_cdt.Enable = true;
		ed_nam.Enable = true;
		ed_spt.Enable = true;
		ed_pjt.Enable = true;
		ed_adr.Enable = true;
		ed_spc.Enable = true;
		cb_prd.Enable = true;

		grd_list2.Editable = true;
	} else if(ds_head.GetColumn(0, "PST") > "A2" && ds_head.GetColumn(0, "PST") < "A3") {
		div_btn.btn_save.Enable = false;	
		div_btn.btn_draft.Enable = false;
		if(G_USER_ID = "2020882") {
			div_btn.btn_delete.Enable = true;
		} else{
			div_btn.btn_delete.Enable = false;
		}
		div_btn.btn_trans.Enable = false;
		div_btn.btn_recost.Enable = false;

		cal_cdt.Enable = false;
		ed_nam.Enable = false;
		ed_spt.Enable = false;
		ed_pjt.Enable = false;
		ed_adr.Enable = false;
		ed_spc.Enable = false;
		cb_prd.Enable = false;

		grd_list2.Editable = false;
	} else if(ds_head.GetColumn(0, "PST") == "A3") {
		div_btn.btn_save.Enable = false;
		
		if(G_USER_ID = "2020882") {
//			div_btn.btn_delete.Enable = true;
		} else{
			div_btn.btn_delete.Enable = false;
		}
		div_btn.btn_trans.Enable = false;
		
		if(ds_head.GetColumn(0,"APSTAT") == '' || ds_head.GetColumn(0,"APSTAT") == '2' || ds_head.GetColumn(0,"APSTAT") == '4') //결재전, 내부반송, 수신반송 상태 
			div_btn.btn_recost.Enable = true; 
		else
			div_btn.btn_recost.Enable = false;
			
		grd_list2.Editable = true;
		
		if(length(trim(fa_reqno)) > 0) {
			div_btn.btn_recost.enable = false;
			div_btn.btn_delete.enable = false;
			div_btn.btn_save.enable = false;
			div_btn.btn_trans.enable = false;
			
			if(ds_head.GetColumn(0, "APSTAT") == ""){ 
				div_btn.btn_draft.Enable = true;
			}else if(ds_head.GetColumn(0, "APSTAT") == "3") {
				if(trim(fa_popgbn) == "B") { //부서수신함
					div_btn.btn_draft.Enable = true;
				} else { //결재문서함
					div_btn.btn_draft.Enable = false;
				}
			} else {
				div_btn.btn_draft.Enable = false;
			}
			
			btn_matnr.Visible = false;
			btn_addmat.Visible = false;
		}
	} 

	if(G_USER_ID == "1001329" || G_USER_ID == "2010984" || G_USER_ID == "2017938" || 
	   G_USER_ID == "2021056" || G_USER_ID == "2017750" || G_USER_ID == "2021200" || 
	   G_USER_ID == "2023687" || G_USER_ID == "2018900" || G_USER_ID == "2029758" || 
	   G_USER_ID == "2999999") {
		div_btn.btn_cos.Visible = true;
		div_btn.btn_print.Enable = true;
	} else{
		div_btn.btn_cos.Visible = false;
		div_btn.btn_print.Enable = false;
	}
	
	if( (ds_head.GetColumn(0,"APSTAT") > '0' && ds_head.GetColumn(0,"APSTAT") != '3' && ds_head.GetColumn(0,"APSTAT") < '6') && ds_decide.rowcount > 0 && G_USER_ID == substr(ds_decide.GetColumn(0, "APNUM"),1) ) {
		div_btn.btn_decide.Enable   = true;		// 결재버튼
		div_btn.btn_sendback.Enable = true;		// 반송버튼
	} else {
		div_btn.btn_decide.Enable = false;		// 결재버튼
		div_btn.btn_sendback.Enable = false;	// 반송버튼
	}
	fn_calcAmt();
}

/********************************************************************************
* 기      능   : 조회 
********************************************************************************/
function fn_queryIns() {
	tit_clearActionInfo();
	tit_addSearchActionInfo("cs12:CS1240001B_S1");
	tit_addSearchActionInfo("cs12:CS1240001B_S2");
	tit_callService(
        ""
        , ""
        , "ds_cond=ds_cond2"
        , "ds_head=ds_head ds_list2=ds_list2"
        , ""
        , "fn_afterQueryIns"
        , true
        , true);
}

function fn_queryUpd() {
	tit_clearActionInfo();
	
	//trace(ds_cond2.SaveXml());
	if(fa_reqno == null || length(trim(fa_reqno)) == 0) {
		tit_addSearchActionInfo("cs12:CS1240001B_S3");
		tit_addSearchActionInfo("cs12:CS1240001B_S4");
		tit_addSearchActionInfo("cs12:CS1240001B_S12");
		tit_addSearchActionInfo("cs12:CS1240001B_S18");
		
		tit_callService(
				""
				, ""
				, "ds_cond=ds_cond2"
				, "ds_head=ds_head ds_list2=ds_list2 ds_his=ds_his ds_detail_pri=ds_detail_pri"
				, ""
				, "fn_afterQueryUpd"
				, true
				, true);
        
	} else {
		tit_addSearchActionInfo("cs12:CS1240001B_S8");
		tit_addSearchActionInfo("cs12:CS1240001B_S9");
		tit_addSearchActionInfo("cs12:CS1240001B_S13");
		tit_addSearchActionInfo("cs12:CS1240001B_S19");
		
		tit_addSearchActionInfo("wb01:APP_STATUS");
		
		tit_callService(
				""
				, ""
				, "ds_cond=ds_cond2"
				, "ds_head=ds_head ds_list2=ds_list2 ds_his=ds_his ds_detail_pri=ds_detail_pri ds_decide=ds_decide"
				, ""
				, "fn_afterQueryUpd"
				, true
				, true);
	}

	
}

/********************************************************************************
* 기      능   : 조회 Callback  
********************************************************************************/
function fn_afterQueryIns(errCode, errMsg) {
	gfn_showMsg("CI00002",ds_list2.RowCount()+"");
	
	if(ds_head.GetColumn(0, "PST") == "A3") {
		div_btn.btn_recost.enable = true;
	}
}

function fn_afterQueryUpd(errCode, errMsg) {
	gfn_showMsg("CI00002",ds_list2.RowCount()+"");

	chk_fst = 0;
	chk_fst2 = 0;
	chk_fst3 = 0;
	chk_fst4 = 0;
	
	//trace(ds_head.SaveXML());
    //trace(ds_list2.SaveXML());
    //trace(ds_his.SaveXML());
    //trace(ds_detail_pri.SaveXML());

	if(ds_head.GetColumn(0, "MATOT") > 0 && ds_head.GetColumn(0, "AMG") == "Y") { // 투입예상자재
		btn_matnr.Visible = false;
		btn_addmat.Visible = true;
	} else if (ds_head.GetColumn(0, "MATOT") > 0 && ds_head.GetColumn(0, "AMG") == "N") {	// 추가자재
		btn_matnr.Visible = true;
		btn_addmat.Visible = false;
	}

	fn_btnInit();
}

/********************************************************************************
* 기      능   : 저장
********************************************************************************/
function fn_save() {
	if(length(ds_head.GetColumn(0, "APSTAT")) > 0) {
		gfn_showAlert("결재상신후 수정은 불가능합니다.");
		return false;
	}
	if(length(trim(ds_head.GetColumn(0, "ETN"))) == 0 && ds_head.GetColumn(0, "PST") >= "A1") {
		gfn_showAlert("진행상태를 확인하십시요.");
		return false;
	}
	if(length(trim(ds_head.GetColumn(0, "ETN"))) > 0 && (length(trim(ds_head.GetColumn(0, "PST"))) == 0 || ds_head.GetColumn(0, "PST") > "A2")) {
		gfn_showAlert("진행상태를 확인하십시요.");
		return false;
	}
	
	if(ds_head.GetColumn(0, "CDT") == "") {
		gfn_showAlert("계약예정일을 확인하십시요.");
		return false;
	}
	
	if(ds_head.GetColumn(0, "STD") == "") {
		gfn_showAlert("계약시작일을 확인하십시요.");
		return false;
	}
	
	if(ds_head.GetColumn(0, "ETD") == "") {
		gfn_showAlert("계약종료일을 확인하십시요.");
		return false;
	}
	
	if(parseInt(ds_head.GetColumn(0, "STD")) < parseInt(ds_head.GetColumn(0, "CDT"))){
		gfn_showAlert("계약기간을 확인하십시오.");
		return false;
	}
	
	if(parseInt(ds_head.GetColumn(0, "ETD")) <= parseInt(ds_head.GetColumn(0, "STD"))){
		gfn_showAlert("계약기간을 확인하십시오.");
		return false;
	}
	
	if(ds_head.GetColumn(0, "CDT") == "") {
		gfn_showAlert("계약예정일을 확인하십시요.");
		return false;
	}
	if(ds_head.GetColumn(0, "CPD") == "") {
		gfn_showAlert("계약상품을 확인하십시요.");
		return false;
	}
	if(ds_head.GetColumn(0, "NAM") == "") {
		gfn_showAlert("고객명을 확인하십시요.");
		return false;
	}
	if(ds_head.GetColumn(0, "SPT") == "") {
		gfn_showAlert("현장명을 확인하십시요.");
		return false;
	}
	if(ds_head.GetColumn(0, "CND") == "") {
		gfn_showAlert("계약유형을 확인하십시요.");
		return false;
	}
	if(ds_head.GetColumn(0, "ADR") == "") {
		gfn_showAlert("현장주소를 확인하십시요.");
		return false;
	}
	if(ds_head.GetColumn(0, "GBU") == "") {
		gfn_showAlert("직영구분을 확인하십시요.");
		return false;
	}
	if(ds_head.GetColumn(0, "CNT") == "") {
		gfn_showAlert("대수를 확인하십시요.");
		return false;
	}
	if(ds_head.GetColumn(0, "FLR") == "") {
		gfn_showAlert("층수를 확인하십시요.");
		return false;
	}
	if(ds_head.GetColumn(0, "SPD") == "") {
		gfn_showAlert("속도를 확인하십시요.");
		return false;
	}
	if(ds_head.GetColumn(0, "YGB") == "") {
		gfn_showAlert("영업주체를 확인하십시요.");
		return false;
	}
	if(ds_head.GetColumn(0, "CYN") == "") {
		gfn_showAlert("CRT유무를 확인하십시요.");
		return false;
	}
	if(ds_head.GetColumn(0, "PRD") == "") {
		gfn_showAlert("점검주기를 확인하십시요.");
		return false;
	}
	if(ds_head.GetColumn(0, "BLD") == "") {
		gfn_showAlert("건물용도를 확인하십시요.");
		return false;
	}
	if(ds_head.GetColumn(0, "SRG") == "") {
		gfn_showAlert("Sheave/Rope를 확인하십시요.");
		return false;
	}
	if(ds_head.GetColumn(0, "PDT") == "") {
		gfn_showAlert("제품군을 확인하십시요.");
		return false;
	}
	if(ds_head.GetColumn(0, "SYR") == "") {
		gfn_showAlert("설치연령을 확인하십시요.");
		return false;
	}
	if(ds_head.GetColumn(0, "ZMAN") == "") {			//이준석DL 요청 2016.04.01 YAR
		gfn_showAlert("영업담당자를 확인하십시요.");
		return false;
	}
	if(ds_head.GetColumn(0, "RMK") == "") {
		gfn_showAlert("특이사항을 확인하십시요.");
		return false;
	}
	
	for(var i=0; i<ds_list2.rowcount; i++) {
		if(ds_head.GetColumn(0, "CPD") == "A" && (ds_list2.GetColumn(0, "FMT") == 0 || length(trim(ds_list2.GetColumn(0, "FMT"))) == "" )) {
			gfn_showAlert("FM보수료는 필수입력 사항입니다.");
			return false;
		}

		if(ds_head.GetColumn(0, "CPD") == "B" && (ds_list2.GetColumn(0, "PMT") == 0 || length(trim(ds_list2.GetColumn(0, "PMT"))) == "")) {
			gfn_showAlert("POG보수료는 필수입력 사항입니다.");
			return false;
		}

		if(length(trim(ds_list2.GetColumn(0, "HWR"))) > 0 && ds_list2.GetColumn(0, "HMT") == 0) {
			gfn_showAlert("HRTS료는 필수입력 사항입니다.");
			return false;
		}

		if(length(trim(ds_list2.GetColumn(0, "DND"))) > 0 && ds_list2.GetColumn(0, "DMT") == 0) {
			gfn_showAlert("DI-PBX료는 필수입력 사항입니다.");
			return false;
		}

		ds_list2.SetColumn(i, "ETN", ds_head.GetColumn(0, "ETN"));
		ds_list2.SetColumn(i, "SIR", ds_head.GetColumn(0, "SIR"));

		if(parseInt(ds_list2.GetColumn(i, "FMT")) == 0 || length(trim(ds_list2.GetColumn(i, "FMT"))) == 0) {
			ds_list2.SetColumn(i, "FMT", 0);
			ds_list2.SetColumn(i, "FMG", "N");
		} else {
			ds_list2.SetColumn(i, "FMG", "Y");
		}

		if(parseInt(ds_list2.GetColumn(i, "PMT")) == 0 || length(trim(ds_list2.GetColumn(i, "PMT"))) == 0) {
			ds_list2.SetColumn(i, "PMT", 0);
			ds_list2.SetColumn(i, "POG", "N");
		} else {
			ds_list2.SetColumn(i, "POG", "Y");
		}

		if(parseInt(ds_list2.GetColumn(i, "HMT")) == 0 || length(trim(ds_list2.GetColumn(i, "HMT"))) == 0) {
			ds_list2.SetColumn(i, "HMT", 0);
			ds_list2.SetColumn(i, "HGB", "N");
		} else {
			if(length(ds_list2.GetColumn(i, "HWR")) == 0 ){ // 회선종류
				var arr = [parseInt(i) + 1, st_hwr.value];
				gfn_showMsg("CW00055", arr);
				return;
			} else {
				ds_list2.SetColumn(i, "HGB", "Y");
			}
		}

		if(parseInt(ds_list2.GetColumn(i, "DMT")) == 0 || length(trim(ds_list2.GetColumn(i, "DMT"))) == 0) {
			ds_list2.SetColumn(i, "DMT", 0);
			ds_list2.SetColumn(i, "DGB", "N");
		} else {
			if(length(ds_list2.GetColumn(i, "DND")) == 0 ){ // DI-PBX종류
				var arr = [parseInt(i) + 1, st_dnd.value];
				gfn_showMsg("CW00055", arr);
				return;
			} else {
				ds_list2.SetColumn(i, "DGB", "Y");
			}
		}

		if(length(trim(ds_list2.GetColumn(i, "HWR"))) > 0) {
			ds_head.SetColumn(0, "HYN", "Y");
		} else {
			ds_head.SetColumn(0, "HYN", "N");
		}

		if(length(trim(ds_list2.GetColumn(i, "DND"))) > 0) {
			ds_head.SetColumn(0, "DYN", "Y");
		} else {
			ds_head.SetColumn(0, "DYN", "N");
		}
	}
	
	var str_dat = 0.0;
	str_dat = round((parseInt(ds_head.GetColumn(0, "MMN")) / gfn_getMonthCnt(ds_head.GetColumn(0, "STD"), ds_head.GetColumn(0, "ETD"))) * 100,1);

	ds_head.SetColumn(0, "DAT", str_dat);

	if(ds_detail_pri.rowcount <= 0) {
		fn_make_period();
	} else {
		var tot=0;
		var tot2=0;
		var _amt;
		var _hmt;
		var _isHmt;
		var _dmt;
		var _isDmt;
		/* 호기별 금액 합과 연차별 금액 합의 비교 로직 수정  20150330 이하림
		   그리드 셀 row 인덱스 변수로 변경 , 호기별 합산
		*/		
		if(cb_cpd.Value != "") {
			for(var i=0 ; i < ds_list2.rowcount; i++){
			
				if(cb_cpd.Value == 'A') { // FM
					_amt =grd_list2.GetCellValue(i,11); 
				}else if (cb_cpd.Value == 'B') { // POG
					_amt =grd_list2.GetCellValue(i,12);
				}
				
				_hmt = grd_list2.GetCellValue(i,14);
				_dmt = grd_list2.GetCellValue(i,16); 
				_isHmt = grd_list2.GetCellValue(i,13); 
				_isDmt = grd_list2.GetCellValue(i,15); 
				
				if(_amt != "") tot += parseInt(_amt);
				if(_isHmt != "" && _hmt != "") tot += parseInt(_hmt);
				if(_isDmt != "" && _dmt != "") tot += parseInt(_dmt);
			}
			
			tot = tot * gfn_getMonthCnt(cal_from.Value,cal_to.Value);
		}
		
		for(var i=0; i < ds_detail_pri.rowcount; i++){
			tot2 += parseInt(ds_detail_pri.GetColumn(i,"TOT")) * parseInt(ds_detail_pri.GetColumn(i,"MON"));
		}

		if(tot == 0 || tot2 == 0 || tot != tot2){
			alert('계약기간 별 금액을 확인하십시요.');
			return;
		}
	}
	if(ds_head.GetColumn(0, "PNT") = "") ds_head.SetColumn(0, "PNT", "0");
	if(ds_head.GetColumn(0, "SAJ") = "") ds_head.SetColumn(0, "SAJ", "0");
	if(ds_head.GetColumn(0, "GIS") = "") ds_head.SetColumn(0, "GIS", "90.0");
	
	if(length(trim(ds_head.GetColumn(0, "ETN"))) == 0) {
		ds_docno_gen.ClearData();													//결재번호생성 데이터셋을 클리어한다
		ds_docno_gen.AddRow();																
		ds_docno_gen.SetColumn(0,"PFX","H01");										//Prefix
		
		tit_clearActionInfo();					
		tit_addSearchActionInfo("wb01:DOC_CODE_GEN_S1",true);					
		tit_addSearchActionInfo("wb01:DOC_CODE_GEN_U1");					
		tit_callService(															//동기화 방식으로 서비스를 콜한다.	
			, ""				
			, "ds_docno_gen_i=ds_docno_gen"				
			, "ds_docno_gen=ds_docno_gen_o"				
			, ""				
			, ""				
			, true
			, false
			, true);		
		
		var newDocNo = ds_docno_gen.GetColumn(0, "DOCNO");
		if(length(newDocNo) <= 1)
		{
			gfn_showMsg("CW10025", "결재문서번호 생성에 실패했습니다. 잠시 후 다시 시도해주세요.");
			return;
		}			
	
		ds_head.SetColumn(0,"DOC",newDocNo);
//		TRACE(ds_list2.SaveXML());
		tit_clearActionInfo();
//		tit_addSingleActionInfo("cs12:CS1240001B_U4");
		tit_addSingleActionInfo("cs12:CS1240001B_I1");
		tit_addMultiActionInfo("cs12:CS1240001B_I2");
		tit_addMultiActionInfo("cs12:CS1240001B_I6");
		tit_addSearchActionInfo("cs12:CS1240001B_S22");
		
		tit_callService(
			""
			, ""
			, "ds_head=ds_head ds_list2=ds_list2 ds_detail_pri=ds_detail_pri"
			, "ds_etn=ds_etn"
			, ""
			, "fn_afterSave"
			, true
			, false
			, true);
	} else {
		tit_clearActionInfo();
		tit_addSingleActionInfo("cs12:CS1240001B_U2");
		tit_addMultiActionInfo("cs12:CS1240001B_U3");
		tit_addMultiActionInfo("cs12:CS1240001B_D1");
		tit_addMultiActionInfo("cs12:CS1240001B_I8");
//		tit_addSingleActionInfo("cs12:CS1240001B_I5"); 
		
		tit_callService(
			""
			, ""
			, "ds_head=ds_head ds_list2=ds_list2 ds_detail_pri=ds_detail_pri"
			, ""
			, ""
			, "fn_afterSave"
			, true
			, false
			, true);
	}
}

/********************************************************************************
* 기      능   : 삭제
********************************************************************************/
function fn_delete() {
	if(length(ds_head.GetColumn(0, "APSTAT")) > 0) {
		gfn_showAlert("결재상신후 삭제는 불가능합니다.");
		return false;
	}

	if(G_USER_ID = "2020882") {

	} else {
		if(ds_head.GetColumn(0, "PST") > "A1") {
			gfn_showAlert("작성상태에서만 삭제가 가능합니다.");
			return false;
		}		
	}

	tit_clearActionInfo();
	tit_addSingleActionInfo("cs12:CS1240001B_U1");
	tit_addSingleActionInfo("cs12:CS1240001B_U7"); //재견적 이후 작성데이터 삭제시 이전승인데이터 복구
	tit_callService(
		""
		, ""
		, "ds_head=ds_head"
		, ""
		, ""
		, "fn_afterDelete"
		, true);
}

/********************************************************************************
* 기      능   : 재견적
********************************************************************************/
function fn_recost() {
	if(ds_head.GetColumn(0, "PST") != "A2" && ds_head.GetColumn(0, "PST") != "A6") {
		gfn_showAlert("재견적이 가능한 상태가 아닙니다.");
		return false;
	}
	if(ds_head.GetColumn(0, "STD") == "") {
		gfn_showAlert("계약시작일을 확인하십시요.");
		return false;
	}
	
	if(ds_head.GetColumn(0, "ETD") == "") {
		gfn_showAlert("계약종료일을 확인하십시요.");
		return false;
	}
	
	if(parseInt(ds_head.GetColumn(0, "ETD")) <= parseInt(ds_head.GetColumn(0, "STD"))){
		gfn_showAlert("계약기간을 확인하십시오.");
		return false;
	}
	if(ds_head.GetColumn(0, "CDT") == "") {
		gfn_showAlert("계약예정일을 확인하십시요.");
		return false;
	}
	if(ds_head.GetColumn(0, "CPD") == "") {
		gfn_showAlert("계약상품을 확인하십시요.");
		return false;
	}
	if(ds_head.GetColumn(0, "NAM") == "") {
		gfn_showAlert("고객명을 확인하십시요.");
		return false;
	}
	if(ds_head.GetColumn(0, "SPT") == "") {
		gfn_showAlert("현장명을 확인하십시요.");
		return false;
	}
	if(ds_head.GetColumn(0, "CND") == "") {
		gfn_showAlert("계약유형을 확인하십시요.");
		return false;
	}
	if(ds_head.GetColumn(0, "ADR") == "") {
		gfn_showAlert("현장주소를 확인하십시요.");
		return false;
	}
	if(ds_head.GetColumn(0, "GBU") == "") {
		gfn_showAlert("직영구분을 확인하십시요.");
		return false;
	}
	if(ds_head.GetColumn(0, "CNT") == "") {
		gfn_showAlert("대수를 확인하십시요.");
		return false;
	}
	if(ds_head.GetColumn(0, "FLR") == "") {
		gfn_showAlert("층수를 확인하십시요.");
		return false;
	}
	if(ds_head.GetColumn(0, "SPD") == "") {
		gfn_showAlert("속도를 확인하십시요.");
		return false;
	}
	if(ds_head.GetColumn(0, "YGB") == "") {
		gfn_showAlert("영업주체를 확인하십시요.");
		return false;
	}
	if(ds_head.GetColumn(0, "CYN") == "") {
		gfn_showAlert("CRT유무를 확인하십시요.");
		return false;
	}
	if(ds_head.GetColumn(0, "PRD") == "") {
		gfn_showAlert("점검주기를 확인하십시요.");
		return false;
	}
	if(ds_head.GetColumn(0, "BLD") == "") {
		gfn_showAlert("건물용도를 확인하십시요.");
		return false;
	}
	if(ds_head.GetColumn(0, "SRG") == "") {
		gfn_showAlert("Sheave/Rope를 확인하십시요.");
		return false;
	}
	if(ds_head.GetColumn(0, "PDT") == "") {
		gfn_showAlert("제품군을 확인하십시요.");
		return false;
	}
	if(ds_head.GetColumn(0, "SYR") == "") {
		gfn_showAlert("설치연령을 확인하십시요.");
		return false;
	}
	if(ds_head.GetColumn(0, "RMK") == "") {
		gfn_showAlert("특이사항을 확인하십시요.");
		return false;
	}

	for(var i=0; i<ds_list2.rowcount; i++) {
		if(ds_head.GetColumn(0, "CPD") == "A" && (ds_list2.GetColumn(0, "FMT") == 0 || length(trim(ds_list2.GetColumn(0, "FMT"))) == "" )) {
			gfn_showAlert("FM보수료는 필수입력 사항입니다.");
			return false;
		}

		if(ds_head.GetColumn(0, "CPD") == "B" && (ds_list2.GetColumn(0, "PMT") == 0 || length(trim(ds_list2.GetColumn(0, "PMT"))) == "")) {
			gfn_showAlert("POG보수료는 필수입력 사항입니다.");
			return false;
		}

		if(length(trim(ds_list2.GetColumn(0, "HWR"))) > 0 && ds_list2.GetColumn(0, "HMT") == 0) {
			gfn_showAlert("HRTS료는 필수입력 사항입니다.");
			return false;
		}

		if(length(trim(ds_list2.GetColumn(0, "DND"))) > 0 && ds_list2.GetColumn(0, "DMT") == 0) {
			gfn_showAlert("DI-PBX료는 필수입력 사항입니다.");
			return false;
		}

		ds_list2.SetColumn(i, "ETN", ds_head.GetColumn(0, "ETN"));
		ds_list2.SetColumn(i, "SIR", ds_head.GetColumn(0, "SIR"));

		if(parseInt(ds_list2.GetColumn(i, "FMT")) == 0 || length(trim(ds_list2.GetColumn(i, "FMT"))) == 0) {
			ds_list2.SetColumn(i, "FMT", 0);
			ds_list2.SetColumn(i, "FMG", "N");
		} else {
			ds_list2.SetColumn(i, "FMG", "Y");
		}

		if(parseInt(ds_list2.GetColumn(i, "PMT")) == 0 || length(trim(ds_list2.GetColumn(i, "PMT"))) == 0) {
			ds_list2.SetColumn(i, "PMT", 0);
			ds_list2.SetColumn(i, "POG", "N");
		} else {
			ds_list2.SetColumn(i, "POG", "Y");
		}

		if(parseInt(ds_list2.GetColumn(i, "HMT")) == 0 || length(trim(ds_list2.GetColumn(i, "HMT"))) == 0) {
			ds_list2.SetColumn(i, "HMT", 0);
			ds_list2.SetColumn(i, "HGB", "N");
		} else {
			if(length(ds_list2.GetColumn(i, "HWR")) == 0 ){ // 회선종류
				var arr = [parseInt(i) + 1, st_hwr.value];
				gfn_showMsg("CW00055", arr);
				return;
			} else {
				ds_list2.SetColumn(i, "HGB", "Y");
			}
		}

		if(parseInt(ds_list2.GetColumn(i, "DMT")) == 0 || length(trim(ds_list2.GetColumn(i, "DMT"))) == 0) {
			ds_list2.SetColumn(i, "DMT", 0);
			ds_list2.SetColumn(i, "DGB", "N");
		} else {
			if(length(ds_list2.GetColumn(i, "DND")) == 0 ){ // DI-PBX종류
				var arr = [parseInt(i) + 1, st_dnd.value];
				gfn_showMsg("CW00055", arr);
				return;
			} else {
				ds_list2.SetColumn(i, "DGB", "Y");
			}
		}

		if(length(trim(ds_list2.GetColumn(i, "HWR"))) > 0) {
			ds_head.SetColumn(0, "HYN", "Y");
		} else {
			ds_head.SetColumn(0, "HYN", "N");
		}

		if(length(trim(ds_list2.GetColumn(i, "DND"))) > 0) {
			ds_head.SetColumn(0, "DYN", "Y");
		} else {
			ds_head.SetColumn(0, "DYN", "N");
		}
	}

	var str_dat = 0.0;
	str_dat = round((parseInt(ds_head.GetColumn(0, "MMN")) / gfn_getMonthCnt(ds_head.GetColumn(0, "STD"), ds_head.GetColumn(0, "ETD"))) * 100,1);
	
	ds_head.SetColumn(0, "DAT", str_dat);
	
	if(ds_head.GetColumn(0, "GIS") = "") ds_head.SetColumn(0, "GIS", "90.0");

	if(!gfn_showConfirm("CI00024","재견적")) {
		return;
	}
	
	if(ds_detail_pri.rowcount <= 0) {
		fn_make_period();
	} else {
		var tot=0;
		var tot2=0;
		var _amt;
		var _hmt;
		var _isHmt;
		var _dmt;
		var _isDmt;
		/* 호기별 금액 합과 연차별 금액 합의 비교 로직 수정  20150330 이하림
		   그리드 셀 row 인덱스 변수로 변경 , 호기별 합산
		*/
		if(cb_cpd.Value != "") {
			for(var i=0 ; i < ds_list2.rowcount; i++){
			
				if(cb_cpd.Value == 'A') {
					_amt =grd_list2.GetCellValue(i,11); 
				}else if (cb_cpd.Value == 'B') {
					_amt =grd_list2.GetCellValue(i,12);
				}
				
				_hmt = grd_list2.GetCellValue(i,14);
				_dmt = grd_list2.GetCellValue(i,16); 
				_isHmt = grd_list2.GetCellValue(i,13); 
				_isDmt = grd_list2.GetCellValue(i,15); 
				
				if(_amt != "") tot += parseInt(_amt);
				if(_isHmt != "" && _hmt != "") tot += parseInt(_hmt);
				if(_isDmt != "" && _dmt != "") tot += parseInt(_dmt);
			}
			//alert("tot = "+tot+" 개월수 ="+gfn_getMonthCnt(cal_from.Value,cal_to.Value));
			tot = tot * gfn_getMonthCnt(cal_from.Value,cal_to.Value);
		}
		
		for(var i=0; i < ds_detail_pri.rowcount; i++){ 
			//alert("tot = " + ds_detail_pri.GetColumn(i,"TOT") + " mon = " +ds_detail_pri.GetColumn(i,"MON"));
			tot2 += parseInt(ds_detail_pri.GetColumn(i,"TOT")) * parseInt(ds_detail_pri.GetColumn(i,"MON"));
		}
		
		if(tot == 0 || tot2 == 0 || tot != tot2){
			alert('계약기간 별 금액을 확인하십시요.');
			return;
		}
	} 
	if(ds_head.GetColumn(0, "PNT") = "") ds_head.SetColumn(0, "PNT", "0");
	if(ds_head.GetColumn(0, "SAJ") = "") ds_head.SetColumn(0, "SAJ", "0");
	if(ds_head.GetColumn(0, "GIS") = "") ds_head.SetColumn(0, "GIS", "90.0");
	
	ds_docno_gen.ClearData();													//결재번호생성 데이터셋을 클리어한다
	ds_docno_gen.AddRow();																
	ds_docno_gen.SetColumn(0,"PFX","H01");										//Prefix
		
	tit_clearActionInfo();					
	tit_addSearchActionInfo("wb01:DOC_CODE_GEN_S1",true);					
	tit_addSearchActionInfo("wb01:DOC_CODE_GEN_U1");					
	tit_callService(														//동기화 방식으로 서비스를 콜한다.	
		, ""				
		, "ds_docno_gen_i=ds_docno_gen"				
		, "ds_docno_gen=ds_docno_gen_o"				
		, ""				
		, ""				
		, true
		, false
		, true);				
	
	var newDocNo = ds_docno_gen.GetColumn(0, "DOCNO");
	if(length(newDocNo) <= 1)
	{
		gfn_showMsg("CW10025", "결재문서번호 생성에 실패했습니다. 잠시 후 다시 시도해주세요.");
		return;
	}			

	ds_head.SetColumn(0,"DOC",newDocNo);
	
	/*
	ds_cond3.SetColumn(0, "DOC", ds_head.GetColumn(0, "DOC"));

	tit_clearActionInfo();
	tit_addSearchActionInfo("cs12:CS1240001B_S14");
	tit_callService(
        ""
        , ""
        , "ds_cond3=ds_cond3"
        , "ds_cnt3=ds_cnt3"
        , ""
        , "fn_afterCnt"
        , true
        , true);
    */
    fn_savRecost();
}
/*
function fn_afterCnt(errCode, errMsg) {
	if(errCode != 0) {
		gfn_showMsg("CE00001");
	} else {
		if(ds_cnt3.GetColumn(0, "CNT") > 0 && ds_head.GetColumn(0,"APSTAT") != '2' && ds_head.GetColumn(0,"APSTAT") != '4') {
			gfn_showAlert("이미 상신을 완료하여 재견적이 불가능 합니다.");
			return false;
		} else {
			fn_savRecost();
		}
	}
}
*/
function fn_savRecost() {
	tit_clearActionInfo(); 
	tit_addSingleActionInfo("cs12:CS1240001B_U6");
	tit_addSingleActionInfo("cs12:CS1240001B_I3"); // zcst301
	tit_addMultiActionInfo("cs12:CS1240001B_I4"); // zcst302
	tit_addMultiActionInfo("cs12:CS1240001B_I7");
	tit_addMultiActionInfo("cs12:CS1240001B_I12"); // ZCST313 상주
	tit_callService(
		""
		, ""
		, "ds_head=ds_head ds_list2=ds_list2 ds_detail_pri=ds_detail_pri"
		, ""
		, ""
		, "fn_afterRecost"
		, true);
}

/********************************************************************************
* 기      능   : 전송
********************************************************************************/
function fn_trans() {

	if(ds_head.GetColumn(0, "PST") > "A1") {
		gfn_showAlert("작성상태에서만 전송이 가능합니다.");
		return false;
	}
	
	mode = "trans";

/*
	if(trim(ds_head.GetColumn(0, "CPD")) == "A" && length(ds_head.GetColumn(0, "MASTAT")) == 0) {
		gfn_showAlert("자재입력후 전송 가능합니다.");
		return false;
	}

	if(length(ds_head.GetColumn(0, "APSTAT")) == 0) {
		gfn_showAlert("결재상신후 전송 가능합니다.");
		return false;
	}
*/
	if(!gfn_showConfirm("CI00024","전송")) {
		return;
	}
	
	ds_cost_o.ClearData();
	ds_cost_sum.ClearData();
	
	fn_HnoCostCal(0);
}

/********************************************************************************
* 기      능   : 시행율 계산
********************************************************************************/
function fn_saveRat() {
//trace(ds_cost.SaveXml());
	tit_clearActionInfo();
	tit_addSingleActionInfo("cs12:CS1240001B_I5");
	tit_callService(
		""
		, ""
		, "ds_cost=ds_cost"
		, ""
		, ""
		, "fn_afterSaveRat"
		, true);
}

/********************************************************************************
* 기      능   : 저장 Callback  
********************************************************************************/
function fn_afterSave(errCode, errMsg) {
	if(errCode != 0) {
		gfn_showMsg("CE00001");
	} else {
		gfn_showMsg("CI00005");

		if(lnk == "INS" || lnk == "PLN") {
			fn_selHno2();
		} else {
			fn_selHno();
		}
		
	}
}

/********************************************************************************
* 기      능   : 삭제 Callback  
********************************************************************************/
function fn_afterDelete(errCode, errMsg) {
	if(errCode != 0) {
		gfn_showMsg("CE00001");
	} else {
		gfn_showMsg("CI00005");
		close();
	}
}

/********************************************************************************
* 기      능   : 재견적 Callback
********************************************************************************/
function fn_afterRecost(errCode, errMsg) {
	if(errCode != 0) {
		gfn_showMsg("CE00001");
	} else {
		gfn_showMsg("CI00003");
		close();
	}
}

/********************************************************************************
* 기      능   : 전송 Callback
********************************************************************************/
function fn_afterTrans(errCode, errMsg) {
	if(errCode != 0) {
		gfn_showMsg("CE00001");
	} else {
		fn_saveRat();
	}
}

/********************************************************************************
* 기      능   : 시행율 Callback
********************************************************************************/
function fn_afterSaveRat(errCode, errMsg) {
	if(errCode != 0) {
		gfn_showMsg("CE00001");
	} else {
		fn_calCostS(); // 상주 원가 구하기
		gfn_showMsg("CI00006", "전송");
		//close();
//		fn_selHno();
	}
}

/********************************************************************************
* 기      능   : 닫기  
********************************************************************************/
function fn_close() {
	close();
}

//=========================================================================================
// [ PART 4]
// Callback 함수 정의 : callback 함수명은 메인 함수의 fn_xxxx() 에서 xxxx 부분은 fn_afterXXXX()
// 형태가 되도록 작성 
//=========================================================================================

/********************************************************************************
* 기      능   : 액셀  
********************************************************************************/
function fn_excel() {
	gfn_saveToExcel(grd_list2, true);
}

/********************************************************************************
* 기      능   : 출력 
********************************************************************************/
function fn_print() {
	
	if(ds_head.GetColumn(0, "PST") < "A3") {
		gfn_showAlert("전송 후 출력이 가능합니다.");
		return false;
	}
	
	ds_print1.ClearData();
	ds_print2.ClearData();
	ds_print3.ClearData();
	ds_print4.ClearData();
	ds_print1.AddRow();
	ds_print2.AddRow();
	//ds_print3.AddRow();
	
	ds_cond2.SetColumn(0,"DOCNO",ds_head.GetColumn(0,"DOC"));
	
	tit_clearActionInfo();
	
	tit_addSearchActionInfo("cs12:CS1240001B_S20");
	tit_addSearchActionInfo("cs12:CS1240001D_S1");
	tit_addSearchActionInfo("cs12:CS1240001C_S1");
	tit_addSearchActionInfo("wb01:DOC_CONF_S1");
	tit_addSearchActionInfo("wb01:DOC_CONF_S2");
	
	tit_callService(
        "" 
        , ""
        , "ds_cond=ds_cond2 ds_cond4=ds_cond2 ds_cond3=ds_cond2 ds_conf_cond=ds_cond2"
        , "ds_print1_result=ds_print1 ds_print2_result=ds_list5 ds_print3=ds_list3 ds_conf_list=ds_conf_list ds_draftpers_list=ds_draftpers_list"
        , ""
        , "fn_afterPrint"
        , true
        , true);
}

function fn_afterPrint() {
	mode = "print";
	
	ds_print1.SetColumn(0,"CDT",cal_cdt.Value);
	ds_print1.SetColumn(0,"STD",cal_from.Value);
	ds_print1.SetColumn(0,"ETD",cal_to.Value);
	ds_print1.SetColumn(0,"CPD",cb_cpd.Text);
	ds_print1.SetColumn(0,"CND",cb_cnd.Text);
	ds_print1.SetColumn(0,"PRD",cb_prd.Text);
	ds_print1.SetColumn(0,"BLD",cb_bld.Text);
	
	ds_print1.SetColumn(0,"BSU_NM",ds_print1_result.GetColumn(0,"BSU_NM"));
	ds_print1.SetColumn(0,"CNT",ds_print1_result.GetColumn(0,"CNT"));
	ds_print1.SetColumn(0,"SIR",ds_print1_result.GetColumn(0,"SIR"));
	ds_print1.SetColumn(0,"DYN",ds_print1_result.GetColumn(0,"DYN"));
	ds_print1.SetColumn(0,"ETN",ds_print1_result.GetColumn(0,"ETN"));
	ds_print1.SetColumn(0,"HYN",ds_print1_result.GetColumn(0,"HYN"));
	ds_print1.SetColumn(0,"ISD",ds_print1_result.GetColumn(0,"ISD"));
	ds_print1.SetColumn(0,"PJT",ds_print1_result.GetColumn(0,"PJT"));
	ds_print1.SetColumn(0,"SPT",ds_print1_result.GetColumn(0,"SPT"));
	ds_print1.SetColumn(0,"TEM_NM",ds_print1_result.GetColumn(0,"TEM_NM"));
	ds_print1.SetColumn(0,"TOT",ds_print1_result.GetColumn(0,"TOT"));
	ds_print1.SetColumn(0,"UPN",ds_print1_result.GetColumn(0,"UPN"));
	ds_print1.SetColumn(0,"WDT",ds_print1_result.GetColumn(0,"WDT"));
	//trace(ds_print1.SaveXml());
	ds_print2.SetColumn(0,"RAT1",ds_print2_result.GetColumn(0,"TOT"));
	ds_print2.SetColumn(0,"RAT2",ds_print2_result.GetColumn(0,"TOT"));
	ds_print2.SetColumn(0,"RAT3",ds_print2_result.GetColumn(0,"NMT"));
	ds_print2.SetColumn(0,"RAT4",ds_print2_result.GetColumn(0,"NMT"));
	ds_print2.SetColumn(0,"RAT5",ds_print2_result.GetColumn(0,"JMT"));
	ds_print2.SetColumn(0,"RAT6",ds_print2_result.GetColumn(0,"JM2"));
	ds_print2.SetColumn(0,"RAT7",ds_print2_result.GetColumn(0,"KMT"));
	ds_print2.SetColumn(0,"RAT8",ds_print2_result.GetColumn(0,"KMT"));
	ds_print2.SetColumn(0,"RAT9",ds_print2_result.GetColumn(0,"HMT"));
	ds_print2.SetColumn(0,"RAT10",ds_print2_result.GetColumn(0,"HMT"));
	ds_print2.SetColumn(0,"RAT11",ds_print2_result.GetColumn(0,"DMT"));
	ds_print2.SetColumn(0,"RAT12",ds_print2_result.GetColumn(0,"DMT"));
	ds_print2.SetColumn(0,"RAT13",ds_print2_result.GetColumn(0,"CMT"));
	ds_print2.SetColumn(0,"RAT14",ds_print2_result.GetColumn(0,"CMT"));
	ds_print2.SetColumn(0,"RAT15","0");
	ds_print2.SetColumn(0,"RAT16",ds_print2_result.GetColumn(0,"INC"));
	ds_print2.SetColumn(0,"RAT17",ds_print2_result.GetColumn(0,"SMT"));
	ds_print2.SetColumn(0,"RAT18",ds_print2_result.GetColumn(0,"SM2"));
	ds_print2.SetColumn(0,"RAT19",ds_print2_result.GetColumn(0,"GMT"));
	ds_print2.SetColumn(0,"RAT20",ds_print2_result.GetColumn(0,"GM2"));
	ds_print2.SetColumn(0,"RAT21",ds_print2_result.GetColumn(0,"COS"));
	ds_print2.SetColumn(0,"RAT22",ds_print2_result.GetColumn(0,"CO2"));
	ds_print2.SetColumn(0,"RAT23",ds_print2_result.GetColumn(0,"RAT"));
	ds_print2.SetColumn(0,"RAT24",ds_print2_result.GetColumn(0,"RA2"));
	
	fn_HnoCostCal(0);
	
}

function fn_afterPrint2() {
	for(var i=0; i < ds_list2.rowcount; i++){
		ds_print4.AddRow();
		ds_print4.SetColumn(i,"PJT",ds_list2.GetColumn(i,"PJT"));
		ds_print4.SetColumn(i,"HNO",ds_list2.GetColumn(i,"HNO"));
		ds_print4.SetColumn(i,"SPC",ds_list2.GetColumn(i,"SPC"));
		ds_print4.SetColumn(i,"SPC2",ds_list2.GetColumn(i,"SPC2"));
		ds_print4.SetColumn(i,"ISD",ds_list2.GetColumn(i,"ISD"));
		ds_print4.SetColumn(i,"BLD",cb_bld.Text);
		ds_print4.SetColumn(i,"TAMT",ds_cost_sum.GetColumn(i,"TAMT"));
		ds_print4.SetColumn(i,"COSTT2", Round(ds_cost_sum.GetColumn(i,"COSTT2"),0));
		if(ds_print4.GetColumn(i,"TAMT") != "" && ds_print4.GetColumn(i,"TAMT") != "0")
			ds_print4.SetColumn(i,"RAT", Round( parseInt(ds_print4.GetColumn(i,"COSTT2")) / parseInt(ds_print4.GetColumn(i,"TAMT")) * 100, 1));
		else
			ds_print4.SetColumn(i,"RAT","0");
	}
	//trace(ds_print4.SaveXml()); 
	fn_printAct();
}

function fn_setHno() {
	ds_list2.ClearData();

	ds_head.SetColumn(0, "MDT", gfn_getCurrDate());
	ds_head.SetColumn(0, "MID", G_USER_ID);
	ds_head.SetColumn(0, "MID_NM", G_USER_NAME);
	ds_head.SetColumn(0, "CDT","");
	ds_head.SetColumn(0, "PRD", "A");
	ds_head.SetColumn(0, "MMN", "0");
	ds_head.SetColumn(0, "DAT", 0);

	j = 0;
	k = 0;
	var t_hno, t_spc, t_flr, t_spd;

	for(var i=0; i<ds_list.RowCount(); i++) {
		if(ds_list.GetColumn(i, "CHK") == true) { //체크박스가 true 일 경우
			if(k == 0) {
				t_hno = substr(ds_list.GetColumn(i, "HNO"),0,1);
				t_spc = substr(ds_list.GetColumn(i, "SPC1"),0,2);
				t_flr = toNumber(ds_list.GetColumn(i, "SPC4"));
				t_spd = toNumber(ds_list.GetColumn(i, "SPC3"));

				if(t_hno == "L") {
					t_hno = "A";
				} else {
					t_hno = "B";
				}

				if(t_spc == "LX" || t_spc == "SS" || t_spc == "WBLX" || t_spc == "WBSS") { // 2:1Roping
					t_spc = "B";
				} else { // 1:1Roping
					t_spc = "A";
				}

				if(substr(ds_list.GetColumn(i, "HNO"),0,1) == "L") {
					if(t_spd > 0 && t_spd <= 60) {
						t_spd = "A";
					} else if(t_spd > 60 && t_spd < 90) {
						t_spd = "A";
					} else if(t_spd >= 90 && t_spd < 120) {
						t_spd = "B";
					} else if(t_spd >= 120 && t_spd < 180) {
						t_spd = "C";
					} else if(t_spd >= 180) {
						t_spd = "D";
					} else {
						t_spd = "E";
					}
				} else {
					t_spd = "E";
				}

				ds_head.SetColumn(0, "SPT", ds_list.GetColumn(i, "SPT"));
				ds_head.SetColumn(0, "ADR", ds_list.GetColumn(i, "ADR"));
				ds_head.SetColumn(0, "PJT", ds_list.GetColumn(i, "PJT"));
				ds_head.SetColumn(0, "TEM", ds_list.GetColumn(i, "TEM"));
				ds_head.SetColumn(0, "BSU", ds_list.GetColumn(i, "BSU"));
				ds_head.SetColumn(0, "SPC", ds_list.GetColumn(i, "SPC1"));
				ds_head.SetColumn(0, "BLD", ds_list.GetColumn(i, "BLD"));
				ds_head.SetColumn(0, "CND", ds_list.GetColumn(i, "GBN"));
				ds_head.SetColumn(0, "GBU", ds_list.GetColumn(i, "GBU"));
				ds_head.SetColumn(0, "YGB", ds_list.GetColumn(i, "GBU"));
				ds_head.SetColumn(0, "SYR", ds_list.GetColumn(i, "FDT"));
				ds_head.SetColumn(0, "CYN", ds_list.GetColumn(i, "MNT"));
				ds_head.SetColumn(0, "PDT", t_hno);
				ds_head.SetColumn(0, "SRG", t_spc);
				ds_head.SetColumn(0, "FLR", t_flr);
				ds_head.SetColumn(0, "SPD", t_spd);
			}

			ds_list2.AddRow();

			ds_list2.SetColumn(j, "PJT", ds_list.GetColumn(i, "PJT"));
			ds_list2.SetColumn(j, "HNO", ds_list.GetColumn(i, "HNO"));
			ds_list2.SetColumn(j, "UPN", ds_list.GetColumn(i, "UPN"));
			ds_list2.SetColumn(j, "TEM", ds_list.GetColumn(i, "TEM"));
			ds_list2.SetColumn(j, "ISD", ds_list.GetColumn(i, "ISD"));
			ds_list2.SetColumn(j, "SPT", ds_list.GetColumn(i, "SPT"));
			ds_list2.SetColumn(j, "TBLD",ds_list.GetColumn(i, "TBLD"));
			ds_list2.SetColumn(j, "SPC", ds_list.GetColumn(i, "SPC1"));
			ds_list2.SetColumn(j, "SPC2",ds_list.GetColumn(i, "SPC2"));
			ds_list2.SetColumn(j, "WDT", ds_list.GetColumn(i, "BDT"));
			ds_list2.SetColumn(j, "TYN", ds_list.GetColumn(i, "MNT"));
			ds_list2.SetColumn(j, "FMT", 0);
			ds_list2.SetColumn(j, "PMT", 0);
			ds_list2.SetColumn(j, "HMT", 0);
			ds_list2.SetColumn(j, "DMT", 0);
			ds_list2.SetColumn(j, "AMT", 0);
			ds_list2.SetColumn(j, "GBN", ds_list.GetColumn(i, "GBN"));

			ds_head.SetColumn(0, "CNT", j+1);

			j++;
			k++;
		}
	}
}

function fn_selHno() {
	ds_cond2.SetColumn(0, "TEM", substr(ds_list.GetColumn(ds_list.row, "ETN"),0,3));
	ds_cond2.SetColumn(0, "RDT", substr(ds_list.GetColumn(ds_list.row, "ETN"),4,4));
	ds_cond2.SetColumn(0, "SEQ", substr(ds_list.GetColumn(ds_list.row, "ETN"),9,4));
	ds_cond2.SetColumn(0, "SIR", ds_list.GetColumn(ds_list.row, "SIR"));
	fn_selHno3();
}

function fn_selHno2() {
	ds_cond2.SetColumn(0, "TEM", ds_etn.GetColumn(0,"TEM"));
	ds_cond2.SetColumn(0, "RDT", ds_etn.GetColumn(0,"RDT"));
	ds_cond2.SetColumn(0, "SEQ", ds_etn.GetColumn(0,"SEQ"));
	ds_cond2.SetColumn(0, "SIR", ds_etn.GetColumn(0,"SIR"));
	fn_selHno3();
}

function fn_selHno3() {
	
	if(fa_reqno == null || length(trim(fa_reqno)) == 0) {
		tit_clearActionInfo();
		tit_addSearchActionInfo("cs12:CS1240001B_S21");
		
		tit_callService(
			""
			, ""
			, "ds_cond2=ds_cond2"
			, "ds_decide=ds_decide"
			, ""
			, ""
			, true
			, false
			, true);	
		
		if(ds_decide.rowcount > 0 && length(trim(ds_decide.GetColumn(0,"DOCNO"))) > 0)
			fa_reqno = ds_decide.GetColumn(0,"DOCNO");
	}

	ds_cond2.SetColumn(0, "DOC", fa_reqno);
	ds_cond2.SetColumn(0, "DOCNO", fa_reqno);

	fn_queryUpd();
}

// 달력 처리 부분 
/********************************************************************************
* 기      능   : 달력에서 일자 선택했을 경우 
********************************************************************************/
function cal_temp_OnDayClick(obj,strText) {
	ds_list.setColumn(ds_head.row, col, strText);
	col = "";
	obj.Visible = false;
}

/********************************************************************************
* 기      능   : 달력에서 포커스 잃었을 경우 
********************************************************************************/
function cal_temp_OnKillFocus(obj) {
	obj.Visible = false;
}

function btn_matnr_OnClick(obj) {
	if(length(ds_head.GetColumn(0, "ETN")) == 0) {
		gfn_showAlert("견적작성후 자재입력 가능합니다.");
		return false;
	}
/*
	if(ds_head.GetColumn(0, "PST") > "A1") {
		gfn_showAlert("작성상태에서만 자재입력 가능합니다.");
		return false;
	}

	if(length(ds_head.GetColumn(0, "APSTAT")) > 0) {
		gfn_showAlert("결재상신후 수정은 불가능합니다.");
		return false;
	}
*/
	var arg = "t_pst=" + quote(ds_head.GetColumn(0, "PST")) + " t_apstat=" + quote(ds_head.GetColumn(0, "APSTAT")) + " t_amg=N";
	gfn_openPopup("CS1240001C", true, arg);

	fn_queryUpd();
}

// 기안
function fn_draft() {
	if(ds_head.GetColumn(0, "PST") < "A3") {
		gfn_showAlert("전송 후 기안 가능합니다.");
		return false;
	}
	var user_grp = gfn_getUserGroup();
	
	if( user_grp == '10' && substr(G_USER_ID,0,1) == '8') {
		var arg = "fa_docno=" + quote(ds_head.GetColumn(0, "DOC")) + " fa_dockind=3";
		var returnArgs = gfn_openPopup2("CS0401001B", true, arg);
		if( returnArgs[0] == "S" ) {
			fn_queryUpd();
		}
	} else {
		if(length(ds_head.GetColumn(0, "APSTAT")) > 0 || !gfn_showConfirm("CI00024", "투입 예상자재 입력")) {
	/*
			if(trim(ds_head.GetColumn(0, "CPD")) == "A" && length(ds_head.GetColumn(0, "MASTAT")) == 0) {
				gfn_showAlert("자재입력후 결재선 지정이 가능합니다.");
				return false;
			}
	*/
			var appgubn = "S";
	
			if(ds_head.GetColumn(0, "APSTAT") == "3") appgubn = "R";
	
			var arg = "fa_docno=" + quote(ds_head.GetColumn(0, "DOC")) + " fa_dockind=3" + " fa_appgubn=" + quote(appgubn);
	
			var rslt = gfn_openPopup2("CS0401001A", true, arg);
			
			if(rslt[0] = "S") {
				div_btn.btn_decide.Enable = true;	// 결재버튼 활성화
				div_btn.btn_draft.Enable = false;	// 기안버튼 비활성화
			}
	
			fn_queryUpd();
		} else {
			if(ds_head.GetColumn(0, "AMG") == "N") { // 투입예상자재
				btn_matnr_OnClick();
			} else {
				gfn_showAlert("추가자재만 입력가능 합니다.");
			return false;
			}
		}
	}
}

function ds_list2_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex) {
	if(strColumnID == "FMT" || strColumnID == "PMT" || strColumnID == "HMT" || strColumnID == "DMT") {
		fn_calcAmt();
	}
}

function fn_calcAmt() {
	var tmp_fmt = 0;
	var tmp_pmt = 0;
	var tmp_hmt = 0;
	var tmp_dmt = 0;
	var tmp_tot = 0;
	
	var tmp_f10  = 0; // 표준단가
	var tmp_frat = 0; // 달성율
	var tmp_p10  = 0;
	var tmp_prat = 0;

	for(var i=0; i<ds_list2.RowCount(); i++) {
		tmp_fmt = toNumber(ds_list2.GetColumn(i, "FMT"));
		tmp_pmt = toNumber(ds_list2.GetColumn(i, "PMT"));
		tmp_hmt = toNumber(ds_list2.GetColumn(i, "HMT"));
		tmp_dmt = toNumber(ds_list2.GetColumn(i, "DMT"));

		if(tmp_fmt <> 0) {
			tmp_f10 = toNumber(ds_list2.GetColumn(i, "F10"));
			tmp_frat = tmp_fmt /tmp_f10 ;
			tmp_frat = round(tmp_frat*100,1) ;
	
			ds_list2.SetColumn(i, "FRAT", tmp_frat);	
		}
		if(tmp_pmt <> 0) {
			tmp_p10 = toNumber(ds_list2.GetColumn(i, "P10"));
			tmp_prat = tmp_pmt /tmp_p10 ;
			tmp_prat = round(tmp_prat*100,1) ;
	
			ds_list2.SetColumn(i, "PRAT", tmp_prat);
		}
		
		if(cb_cpd.Value == "A") { // FM
			tmp_pmt = 0;
			med_trat.Text = round(ds_list2.Avg("FRAT"),1) ;
		} else if (cb_cpd.Value == "B") { // POG
			tmp_fmt = 0;
			med_trat.Text = round(ds_list2.Avg("PRAT"),1) ;
		}

		tmp_tot = tmp_fmt + tmp_pmt + tmp_hmt + tmp_dmt;

		ds_list2.SetColumn(i, "AMT", tmp_tot);
	}
}

function cb_cpd_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex) {
	fn_calcAmt();
}

function btn_cos_OnClick(obj) {
	var arg = "t_etn=" + quote(ds_head.GetColumn(0, "ETN")) + " t_sir=" + quote(ds_head.GetColumn(0, "SIR")) + " t_doc=" + quote(ds_head.GetColumn(0, "DOC"));

	gfn_openPopup("CS1240001D", true, arg);
}

function btn_addmat_OnClick(obj) {
	if(length(ds_head.GetColumn(0, "ETN")) == 0) {
		gfn_showAlert("견적작성후 자재입력 가능합니다.");
		return false;
	}

	var arg = "t_pst=" + quote(ds_head.GetColumn(0, "PST")) + " t_apstat=" + quote(ds_head.GetColumn(0, "APSTAT")) + " t_amg=Y";
	gfn_openPopup("CS1240001C", true, arg);

	fn_queryUpd();
}

function btn_saveopn_OnClick(obj) {
	var user_grp = gfn_getUserGroup();

	if(user_grp < "40") {
		return;
	}

	tit_clearActionInfo();
	tit_addSingleActionInfo("cs12:CS1240001B_U8");
	tit_callService(
		""
		, ""
		, "ds_head=ds_head"
		, ""
		, ""
		, "fn_afterSaveOpn"
		, true);
}

/********************************************************************************
* 기      능   : 검토의견 저장 Callback  
********************************************************************************/
function fn_afterSaveOpn(errCode, errMsg) {
	if(errCode != 0) {
		gfn_showMsg("CE00001");
	} else {
		gfn_showMsg("CI00005");
	}
}

var fhrm = 0;
var fhru = 0;
var fdpx = 0;
function fn_HnoCostCal(i){
	
	currRow = i;
	
	var s_hno = ds_list2.GetColumn(i, "HNO");
	
	ds_cost_i.ClearData();
	
	if(substr(s_hno,0,1) <> "L" && substr(s_hno,0,1) <> "S" && substr(s_hno,0,1) <> "W") { // EL, ES, MW만 원가계산
		if(currRow  >= ds_list2.rowcount){
			fn_incentiveCal();
			return;
		}else{
			fn_HnoCostCal(i+1);
		}
	}
	
	ds_cost_i.AddRow();
	ds_cost_i.SetColumn(0,"STD", ds_head.GetColumn(0, "STD"));
	ds_cost_i.SetColumn(0,"ETD", ds_head.GetColumn(0, "ETD"));
	ds_cost_i.SetColumn(0,"ZYEAR", substr(ds_head.GetColumn(0, "STD"),0,4));
	ds_cost_i.SetColumn(0,"MMN", ds_head.GetColumn(0, "MMN"));
	ds_cost_i.SetColumn(0,"HEP", ds_head.GetColumn(0, "PRD")); 	
	ds_cost_i.SetColumn(0,"CNT", ds_head.GetColumn(0, "CNT")); 	//대수
	if(ds_list2.GetColumn(i, "BSUGB") == '1')
		ds_cost_i.SetColumn(0,"GBU", "A"); //직영구분 A:직영
	else
		ds_cost_i.SetColumn(0,"GBU", "B"); 
	ds_cost_i.SetColumn(0,"HNO", ds_list2.GetColumn(i, "HNO"));
	ds_cost_i.SetColumn(0,"HMT", ds_list2.GetColumn(i, "HMT"));
	
	if(ds_list2.GetColumn(i, "DND") == "Z") { // 통신료 수주의 경우 수주금액에서 제외 처리 201511
		ds_cost_i.SetColumn(0,"DMT", 0);
	} else {
		ds_cost_i.SetColumn(0,"DMT", ds_list2.GetColumn(i, "DMT"));
	}
	ds_cost_i.SetColumn(0,"SPC", ds_list2.GetColumn(i, "ZSPEC12"));
	ds_cost_i.SetColumn(0,"FLR", ds_list2.GetColumn(i, "ZSPEC7"));
	ds_cost_i.SetColumn(0,"SPD", ds_list2.GetColumn(i, "ZSPEC3"));
	ds_cost_i.SetColumn(0,"FDT", ds_list2.GetColumn(i, "FDT")); //설치연령
	ds_cost_i.SetColumn(0,"ABG", ds_list2.GetColumn(i, "ABG")); //건물구분
	ds_cost_i.SetColumn(0,"BLD", ds_list2.GetColumn(i, "BLD")); //건물구분
	ds_cost_i.SetColumn(0,"TEM", ds_list2.GetColumn(i, "VKGRP")); 
	ds_cost_i.SetColumn(0,"TYN", ds_list2.GetColumn(i, "TYN"));	//감시반
	
	if(ds_head.GetColumn(0, "CPD") == "A"){ 
		ds_cost_i.SetColumn(0,"KND", "1");		//FM
		ds_cost_i.SetColumn(0,"AMT", ds_list2.GetColumn(i, "FMT"));
	} else {
		ds_cost_i.SetColumn(0,"KND", "2");		//POG
		ds_cost_i.SetColumn(0,"AMT", ds_list2.GetColumn(i, "PMT"));
	}
	
	if(ds_list2.GetColumn(i, "ACD") == "EN81") ds_cost_i.SetColumn(0,"ACD", "2");
	else ds_cost_i.SetColumn(0,"ACD", "0");
	
	ds_cost_i.SetColumn(0,"HWR",ds_list2.GetColumn(i, "HWR")); //HRTS 유/뮤선 구분
	ds_cost_i.SetColumn(0,"FHRM",fhrm);	//HTRS 최초 무선 여부
	if(ds_list2.GetColumn(i, "HWR") == 'B') fhrm = 1;
	ds_cost_i.SetColumn(0,"FHRU",fhru); //HTRS 최초 유선 여부
	if(ds_list2.GetColumn(i, "HWR") == 'A') fhru = 1;
	
	ds_cost_i.SetColumn(0,"DND",ds_list2.GetColumn(i, "DND")); //DIPBX종류
	ds_cost_i.SetColumn(0,"FDPX",fdpx);	//DIPBX 최초 여부
	if(ds_list2.GetColumn(i, "DND") == 'B') fdpx = 1;
	
	tit_clearActionInfo();
	tit_addSingleActionInfo("cs12:CS1240001B_S15");
	tit_callService(
		""
		, ""
		, "ds_cost_i=ds_cost_i"
		, "ds_cost_o=ds_cost_o"
		, ""
		, "fn_afterHnoCostCal"
		, true);
}


function fn_afterHnoCostCal(errCode, errMsg) {
	if(errCode != 0) {
		gfn_showMsg("CE00001");
		fhrm = 0;
		fhru = 0;
		fdpx = 0;
		ds_cost_o.ClearData();
		ds_cost_sum.ClearData();
	} else {
		ds_cost_sum.AddRow();
		ds_cost_sum.SetColumn(ds_cost_sum.currow,"NMT",ds_cost_o.GetColumn(0,"NMT"));
		ds_cost_sum.SetColumn(ds_cost_sum.currow,"JMT",ds_cost_o.GetColumn(0,"JMT"));
		ds_cost_sum.SetColumn(ds_cost_sum.currow,"JMT2",ds_cost_o.GetColumn(0,"JMT2"));
		ds_cost_sum.SetColumn(ds_cost_sum.currow,"KMT",ds_cost_o.GetColumn(0,"KMT"));
		ds_cost_sum.SetColumn(ds_cost_sum.currow,"HMT",ds_cost_o.GetColumn(0,"HMT"));
		ds_cost_sum.SetColumn(ds_cost_sum.currow,"DMT",ds_cost_o.GetColumn(0,"DMT"));
		ds_cost_sum.SetColumn(ds_cost_sum.currow,"CMT",ds_cost_o.GetColumn(0,"CMT"));
		ds_cost_sum.SetColumn(ds_cost_sum.currow,"GMT",ds_cost_o.GetColumn(0,"GMT"));
		ds_cost_sum.SetColumn(ds_cost_sum.currow,"GMT2",ds_cost_o.GetColumn(0,"GMT2"));
		ds_cost_sum.SetColumn(ds_cost_sum.currow,"COS1",ds_cost_o.GetColumn(0,"COS1"));
		ds_cost_sum.SetColumn(ds_cost_sum.currow,"COS2",ds_cost_o.GetColumn(0,"COS2"));
		ds_cost_sum.SetColumn(ds_cost_sum.currow,"COSTT",ds_cost_o.GetColumn(0,"COSTT"));
		ds_cost_sum.SetColumn(ds_cost_sum.currow,"COSTT2",ds_cost_o.GetColumn(0,"COSTT2"));
		ds_cost_sum.SetColumn(ds_cost_sum.currow,"AMT",ds_cost_o.GetColumn(0,"AMT"));
		ds_cost_sum.SetColumn(ds_cost_sum.currow,"TAMT",ds_cost_o.GetColumn(0,"TAMT"));
		if(currRow + 1 >= ds_list2.rowcount){
			if(mode == "trans")
				fn_incentiveCal();
			else if(mode == "print")
				fn_afterPrint2();
		}else{
			fn_HnoCostCal(currRow+1);
		}
	}
}

function fn_incentiveCal(){
	var nmt = 0;
	var jmt = 0;
	var jmt2 = 0;
	var kmt = 0;
	var hmt = 0;
	var dmt = 0;
	var cmt = 0;
	var gmt = 0;
	var gmt2 = 0;
	var cos1 = 0;
	var cos2 = 0;
	var costt = 0;
	var costt2 = 0;
	var amt = 0;
	var tamt = 0;
	for(var i=0; i <= ds_cost_sum.rowcount; i++){
		nmt += parseInt(ds_cost_sum.GetColumn(i, "NMT"));
		jmt += parseInt(ds_cost_sum.GetColumn(i, "JMT"));
		//jmt2 += parseInt(ds_cost_sum.GetColumn(i, "JMT2"));
		kmt += parseInt(ds_cost_sum.GetColumn(i, "KMT"));
		hmt += parseInt(ds_cost_sum.GetColumn(i, "HMT"));
		dmt += parseInt(ds_cost_sum.GetColumn(i, "DMT"));
		cmt += parseInt(ds_cost_sum.GetColumn(i, "CMT"));
		//gmt += parseInt(ds_cost_sum.GetColumn(i, "GMT"));
		//gmt2 += parseInt(ds_cost_sum.GetColumn(i, "GMT2"));
		cos1 += parseInt(ds_cost_sum.GetColumn(i, "COS1"));
		cos2 += parseInt(ds_cost_sum.GetColumn(i, "COS2"));
		costt += parseInt(ds_cost_sum.GetColumn(i, "COSTT"));
		costt2 += parseInt(ds_cost_sum.GetColumn(i, "COSTT2"));
		amt += parseInt(ds_cost_sum.GetColumn(i, "AMT"));
		tamt += parseInt(ds_cost_sum.GetColumn(i, "TAMT"));
	}
	
	ds_cost.ClearData();
	ds_cost.AddRow();
	ds_cost.SetColumn(0, "ZYEAR", substr(ds_head.GetColumn(0, "STD"),0,4));
	ds_cost.SetColumn(0, "NMT", nmt);
	ds_cost.SetColumn(0, "JMT", jmt);
	ds_cost.SetColumn(0, "KMT", kmt);
	ds_cost.SetColumn(0, "HMT", hmt);
	ds_cost.SetColumn(0, "DMT", dmt);
	ds_cost.SetColumn(0, "CMT", cmt);
	
	ds_cost_sum_i.ClearData();
	ds_cost_sum_i.AddRow();
	//trace(ds_head.SaveXml());
	if(ds_head.GetColumn(0, "AMG") == "N" &&  parseInt(ds_head.GetColumn(0, "MATOT")) > 0) {
		cos2 = cos2 + parseInt(ds_head.GetColumn(0, "MATOT")); //현장별(투입예상자재)
		ds_cost.SetColumn(0, "JM2", parseInt(ds_head.GetColumn(0, "MATOT")));
	} else if(ds_head.GetColumn(0, "AMG") == "Y" &&  parseInt(ds_head.GetColumn(0, "MATOT")) > 0) {
		cos2 = cos2 + jmt + parseInt(ds_head.GetColumn(0, "MATOT")); //현장별(추가자재)
		ds_cost.SetColumn(0, "JM2", jmt + parseInt(ds_head.GetColumn(0, "MATOT")));
	} else {
		cos2 = cos2 + jmt;
		ds_cost.SetColumn(0, "JM2", jmt);
	}
	
	ds_cost_sum_i.SetColumn(0,"STD", ds_head.GetColumn(0, "STD"));
	ds_cost_sum_i.SetColumn(0,"ETD", ds_head.GetColumn(0, "ETD"));
	
	ds_cost_sum_i.SetColumn(0, "COS1", cos1);
	ds_cost_sum_i.SetColumn(0, "COS2", cos2);
	ds_cost_sum_i.SetColumn(0, "COSTT", costt);
	//ds_cost_sum_i.SetColumn(0, "COSTT2", costt2);
	ds_cost_sum_i.SetColumn(0, "AMT", amt);
	ds_cost_sum_i.SetColumn(0, "TAMT", tamt);
	if(ds_head.GetColumn(0, "CPD") == "A"){ 
		ds_cost_sum_i.SetColumn(0,"KND", "1");	
	} else {
		ds_cost_sum_i.SetColumn(0,"KND", "2");		//POG
	}
	ds_cost_sum_i.SetColumn(0, "GBU", ds_head.GetColumn(0, "GBU"));	//직영구분
	ds_cost_sum_i.SetColumn(0, "ZYEAR", substr(ds_head.GetColumn(0, "STD"),0,4));
	ds_cost_sum_i.SetColumn(0, "DOCNO", ds_head.GetColumn(0,"DOC"));

	ds_cost_sum_i.SetColumn(0, "ETN", replace(ds_head.GetColumn(0, "ETN"),"-",""));
	ds_cost_sum_i.SetColumn(0, "SIR", ds_head.GetColumn(0, "SIR"));
	
	tit_clearActionInfo();
	tit_addSingleActionInfo("cs12:CS1240001B_S16");
	tit_callService(
		""
		, ""
		, "ds_cost_sum_i=ds_cost_sum_i"
		, "ds_cost_sum_o=ds_cost_sum_o"
		, ""
		, "fn_afterIncentiveCal"
		, true);
	
}

function fn_afterIncentiveCal(errCode, errMsg) {
	if(errCode != 0) {
		gfn_showMsg("CE00001");
	} else {
		fn_updateRat();
	}
}

function fn_updateRat(){
	ds_cost.SetColumn(0, "GNO", replace(ds_head.GetColumn(0, "ETN"),"-",""));
	ds_cost.SetColumn(0, "SIR", ds_head.GetColumn(0, "SIR"));
	ds_cost.SetColumn(0, "GMT", ds_cost_sum_o.GetColumn(0,"GMT"));
	ds_cost.SetColumn(0, "GM2", ds_cost_sum_o.GetColumn(0,"GM2"));
	ds_cost.SetColumn(0, "COST", ds_cost_sum_o.GetColumn(0,"COST"));
	ds_cost.SetColumn(0, "COS2", ds_cost_sum_o.GetColumn(0,"COS2"));
	ds_cost.SetColumn(0, "RAT", ds_cost_sum_o.GetColumn(0,"RAT"));
	ds_cost.SetColumn(0, "RA2", ds_cost_sum_o.GetColumn(0,"RA2"));
	ds_cost.SetColumn(0, "PER", ds_cost_sum_o.GetColumn(0,"PER"));
	ds_cost.SetColumn(0, "INC", ds_cost_sum_o.GetColumn(0,"INC"));
	ds_cost.SetColumn(0, "SJT", 0); // 후속 프로세스에서 상주 계산, 디폴드 금액 0
	
	tit_clearActionInfo();
	tit_addSingleActionInfo("cs12:CS1240001B_U5");
	tit_callService(
		""
		, ""
		, "ds_head=ds_head"
		, ""
		, ""
		, "fn_afterTrans"
		, true);
}

var currRow;
var dsList2Cnt;
function fn_setPlnHno(){
	ds_list2.ClearData();
	ds_plan_list.ClearData();
	dsList2Cnt = 0;
	
	ds_head.SetColumn(0, "MDT", gfn_getCurrDate());
	ds_head.SetColumn(0, "MID", G_USER_ID);
	ds_head.SetColumn(0, "MID_NM", G_USER_NAME);
	ds_head.SetColumn(0, "CDT","");
	ds_head.SetColumn(0, "PRD", "A");
	ds_head.SetColumn(0, "MMN", "0");
	ds_head.SetColumn(0, "DAT", 0);

	var k=0;
	for(var i=0; i<ds_list.RowCount(); i++) {
		if(ds_list.GetColumn(i, "CHK") == true) { //체크박스가 true 일 경우
			ds_plan_list.AddRow();
			ds_plan_list.SetColumn(k, "ZDATE", cal_dat.Value);
			ds_plan_list.SetColumn(k, "UPN", ds_list.GetColumn(i, "UPN"));
			ds_plan_list.SetColumn(k, "PJT", ds_list.GetColumn(i, "PJT"));
			ds_plan_list.SetColumn(k, "SPC2", ds_list.GetColumn(i, "SPC2"));
			ds_plan_list.SetColumn(k, "SPC", ds_list.GetColumn(i, "SPC"));
			ds_plan_list.SetColumn(k, "SPC3", ds_list.GetColumn(i, "SPC3"));
			ds_plan_list.SetColumn(k, "SPC7", ds_list.GetColumn(i, "SPC7"));
			ds_plan_list.SetColumn(k, "PRO", ds_list.GetColumn(i, "PRO"));
			ds_plan_list.SetColumn(k, "BSU", ds_list.GetColumn(i, "BSU"));
			k++;
		}
	}
	
	if(ds_plan_list.rowcount > 0)
		fn_setPlnHnoList(0);
}

function fn_setPlnHnoList(i){
	
	currRow = i;
	
	if(currRow >= ds_plan_list.rowcount) return;
	
	ds_plan_i.ClearData();
	ds_plan_i.AddRow();
	ds_plan_i.SetColumn(0, "ZDATE", ds_plan_list.GetColumn(currRow, "ZDATE"));
	ds_plan_i.SetColumn(0, "UPN", ds_plan_list.GetColumn(currRow, "UPN"));
	ds_plan_i.SetColumn(0, "PJT", ds_plan_list.GetColumn(currRow, "PJT"));
	ds_plan_i.SetColumn(0, "SPC2", ds_plan_list.GetColumn(currRow, "SPC2"));
	ds_plan_i.SetColumn(0, "SPC", ds_plan_list.GetColumn(currRow, "SPC"));
	ds_plan_i.SetColumn(0, "SPC3", ds_plan_list.GetColumn(currRow, "SPC3"));
	ds_plan_i.SetColumn(0, "SPC7", ds_plan_list.GetColumn(currRow, "SPC7"));
	ds_plan_i.SetColumn(0, "PRO", ds_plan_list.GetColumn(currRow, "PRO"));
	ds_plan_i.SetColumn(0, "BSU", ds_plan_list.GetColumn(currRow, "BSU"));
	
	tit_clearActionInfo();
	tit_addSingleActionInfo("cs12:CS1240001B_S17");
	tit_callService(
		""
		, ""
		, "ds_plan_i=ds_plan_i"
		, "ds_plan_o=ds_plan_o"
		, ""
		, "fn_afterPlnHnoList"
		, true);
}

function fn_afterPlnHnoList(errCode, errMsg) {
	if(errCode != 0) {
		gfn_showMsg("CE00001");
	} else {
		
		var t_hno, t_spc, t_flr, t_spd;
		
		if(currRow == 0 && ds_plan_o.rowcount > 0){
			t_hno = substr(ds_plan_o.GetColumn(0, "HNO"),0,1);
			t_spc = substr(ds_plan_o.GetColumn(0, "SPC1"),0,2);
			t_flr = toNumber(ds_plan_o.GetColumn(0, "SPC4"));
			t_spd = toNumber(ds_plan_o.GetColumn(0, "SPC3"));

			if(t_hno == "L") {
				t_hno = "A";
			} else {
				t_hno = "B";
			}

			if(t_spc == "LX" || t_spc == "SS" || t_spc == "WBLX" || t_spc == "WBSS") { // 2:1Roping
				t_spc = "B";
			} else { // 1:1Roping
				t_spc = "A";
			}
			
			if(substr(ds_plan_o.GetColumn(0, "HNO"),0,1) == "L") {
				if(t_spd > 0 && t_spd <= 60) {
					t_spd = "A";
				} else if(t_spd > 60 && t_spd < 90) {
					t_spd = "A";
				} else if(t_spd >= 90 && t_spd < 120) {
					t_spd = "B";
				} else if(t_spd >= 120 && t_spd < 180) {
					t_spd = "C";
				} else if(t_spd >= 180) {
					t_spd = "D";
				} else {
					t_spd = "E";
				}
			} else {
				t_spd = "E";
			}
			
			ds_head.SetColumn(0, "SPT", ds_plan_o.GetColumn(0, "SPT"));
			ds_head.SetColumn(0, "ADR", ds_plan_o.GetColumn(0, "ADR"));
			ds_head.SetColumn(0, "PJT", ds_plan_o.GetColumn(0, "PJT"));
			ds_head.SetColumn(0, "TEM", ds_plan_o.GetColumn(0, "TEM"));
			ds_head.SetColumn(0, "BSU", ds_plan_o.GetColumn(0, "BSU"));
			ds_head.SetColumn(0, "SPC", ds_plan_o.GetColumn(0, "SPC1"));
			ds_head.SetColumn(0, "BLD", ds_plan_o.GetColumn(0, "BLD"));
			ds_head.SetColumn(0, "CND", ds_plan_o.GetColumn(0, "GBN"));
			ds_head.SetColumn(0, "GBU", ds_plan_o.GetColumn(0, "GBU"));
			ds_head.SetColumn(0, "YGB", ds_plan_o.GetColumn(0, "GBU"));
			ds_head.SetColumn(0, "SYR", ds_plan_o.GetColumn(0, "FDT"));
			ds_head.SetColumn(0, "CYN", ds_plan_o.GetColumn(0, "MNT"));
			ds_head.SetColumn(0, "PDT", t_hno);
			ds_head.SetColumn(0, "SRG", t_spc);
			ds_head.SetColumn(0, "FLR", t_flr);
			ds_head.SetColumn(0, "SPD", t_spd);
		}
		
		for(var i=0; i < ds_plan_o.rowcount; i++){
			ds_list2.AddRow();
			ds_list2.SetColumn(dsList2Cnt, "PJT", ds_plan_o.GetColumn(i, "PJT"));
			ds_list2.SetColumn(dsList2Cnt, "HNO", ds_plan_o.GetColumn(i, "HNO"));
			ds_list2.SetColumn(dsList2Cnt, "UPN", ds_plan_o.GetColumn(i, "UPN"));
			ds_list2.SetColumn(dsList2Cnt, "TEM", ds_plan_o.GetColumn(i, "TEM"));
			ds_list2.SetColumn(dsList2Cnt, "ISD", ds_plan_o.GetColumn(i, "ISD"));
			ds_list2.SetColumn(dsList2Cnt, "SPT", ds_plan_o.GetColumn(i, "SPT"));
			ds_list2.SetColumn(dsList2Cnt, "TBLD",ds_plan_o.GetColumn(i, "TBLD"));
			ds_list2.SetColumn(dsList2Cnt, "SPC", ds_plan_o.GetColumn(i, "SPC1"));
			ds_list2.SetColumn(dsList2Cnt, "SPC2",ds_plan_o.GetColumn(i, "SPC2"));
			ds_list2.SetColumn(dsList2Cnt, "WDT", ds_plan_o.GetColumn(i, "BDT"));
			ds_list2.SetColumn(dsList2Cnt, "TYN", ds_plan_o.GetColumn(i, "MNT"));
			ds_list2.SetColumn(dsList2Cnt, "FMT", 0);
			ds_list2.SetColumn(dsList2Cnt, "PMT", 0);
			ds_list2.SetColumn(dsList2Cnt, "HMT", 0);
			ds_list2.SetColumn(dsList2Cnt, "DMT", 0);
			ds_list2.SetColumn(dsList2Cnt, "AMT", 0);
			ds_list2.SetColumn(dsList2Cnt, "GBN", ds_plan_o.GetColumn(i, "GBN"));
			dsList2Cnt++;
		}
		if(currRow + 1 >= ds_plan_list.rowcount){
			ds_head.SetColumn(0, "CNT", ds_list2.rowcount);
		}else{
			fn_setPlnHnoList(currRow+1);
		}
	}
}


function btn_pri_OnClick(obj)
{
	gfn_clearMsgBar();
	
	if(ds_head.GetColumn(0, "STD") == "") {
		gfn_showAlert("계약시작일을 확인하십시요.");
		return false;
	}
	
	if(ds_head.GetColumn(0, "ETD") == "") {
		gfn_showAlert("계약종료일을 확인하십시요.");
		return false;
	}
	
	if(parseInt(ds_head.GetColumn(0, "ETD")) <= parseInt(ds_head.GetColumn(0, "STD"))){
		gfn_showAlert("계약기간을 확인하십시오.");
		return false;
	}
	
	if(ds_detail_pri.rowcount <= 0) fn_make_period();

	gfn_openPopup("CS1240001H");
}


function fn_make_period(){

	var nrow = 0;
	var toDt = cal_to.Value;
	var prDt = AddDate(AddMonth(cal_from.Value,12),-1);
	var fromDt = cal_from.Value;
	var tot=0;
	
	var _amt;
	var _hmt;
	var _isHmt;
	var _dmt;
	var _isDmt;
	
	if(cb_cpd.Value != "") {
		for(var i=0 ; i < ds_list2.rowcount; i++){
		
			if(cb_cpd.Value == 'A') {
				_amt =grd_list2.GetCellValue(0,11); 
			}else if (cb_cpd.Value == 'B') {
				_amt =grd_list2.GetCellValue(0,12);
			}
			
			_hmt = grd_list2.GetCellValue(0,14);
			_dmt = grd_list2.GetCellValue(0,16); 
			_isHmt = grd_list2.GetCellValue(0,13); 
			_isDmt = grd_list2.GetCellValue(0,15); 
			
			if(_amt != "") tot += parseInt(_amt);
			if(_isHmt != "" && _hmt != "") tot += parseInt(_hmt);
			if(_isDmt != "" && _dmt != "") tot += parseInt(_dmt);
		}
	}
	
	if(parseInt(toDt) <= parseInt(prDt)){
		ds_detail_pri.AddRow();
		ds_detail_pri.SetColumn(nrow, "SEQ2", 1);
		ds_detail_pri.SetColumn(nrow, "STD", fromDt);
		ds_detail_pri.SetColumn(nrow, "ETD", toDt);
		ds_detail_pri.SetColumn(nrow, "TOT", tot);
		ds_detail_pri.SetColumn(nrow, "MON", gfn_getMonthCnt(fromDt,toDt));
	} else {
		while(parseInt(toDt) > parseInt(prDt)){
			ds_detail_pri.AddRow();
			ds_detail_pri.SetColumn(nrow, "SEQ2", nrow+1);
			ds_detail_pri.SetColumn(nrow, "STD", fromDt);
			ds_detail_pri.SetColumn(nrow, "ETD", prDt);
			ds_detail_pri.SetColumn(nrow, "TOT", tot);
			ds_detail_pri.SetColumn(nrow, "MON", 12);
			fromDt = AddDate(prDt,1);
			prDt = AddDate(AddMonth(fromDt,12),-1);
			nrow++;
		}
		
		if(parseInt(toDt) <= parseInt(prDt)){
			ds_detail_pri.AddRow();
			ds_detail_pri.SetColumn(nrow, "SEQ2", nrow+1);
			ds_detail_pri.SetColumn(nrow, "STD", fromDt);
			ds_detail_pri.SetColumn(nrow, "ETD", toDt);
			ds_detail_pri.SetColumn(nrow, "TOT", tot);
			ds_detail_pri.SetColumn(nrow, "MON", gfn_getMonthCnt(fromDt,toDt));
		}
	}
}

function cal_cdt_OnChanged(obj,strOldText,strNewText)
{
	ds_detail_pri.ClearData();
	if(cal_from.Value > '' && cal_cdt.Value > ''){
		var mmn = gfn_getMonthCnt(cal_cdt.Value, cal_from.Value);
		if(mmn <= 1 ) 
			mmn = 0;
		else if(mmn > 0 ) 
			mmn = gfn_getMonthCnt(cal_cdt.Value, AddDate(cal_from.Value, -1));
		ed_mmn.Text = mmn;
	}
	if( ds_list2.rowcount() > 0 ) { 
		if(strOldText <> strNewText) {		
			fn_getStdPrice(); // 표준단가 가져오기
		}
	}
}

function cal_from_OnChanged(obj,strOldText,strNewText)
{
	if(cal_from.Value > '' && cal_cdt.Value > ''){
		var mmn = gfn_getMonthCnt(cal_cdt.Value, cal_from.Value);
		if(mmn <= 1 ) 
			mmn = 0;
		else if(mmn > 0 ) 
			mmn = gfn_getMonthCnt(cal_cdt.Value, AddDate(cal_from.Value, -1));
		ed_mmn.Text = mmn;
	}
}

function cal_to_OnChanged(obj,strOldText,strNewText)
{
	ds_detail_pri.ClearData();
}

function fn_printAct(){
	Dialog("CS12::CS1240001I.xml", "");
}

/********************************************************************************
* 기      능   : 결재 15
********************************************************************************/
function fn_decide() {
	
	gfn_clearMsgBar();
	
	if( ds_decide.rowCount() < 1 ) {
		return;
	}
	
	if( !gfn_showConfirm("CI00014", "문서번호 : "+ quote(ds_decide.GetColumn(0,"DOCNO"))+ "결재") ) return;
	
	//----------------------------------------------------------------------
	// 의견 입력 팝업 추가 
	// f팝업 전달 변수 fa_docno : 문서번호 ,fa_dockind : 문서종류 
	// return 값 : rtn_yn (Y:의견입력됨 N:의견입력안됨)
	if(gfn_showConfirm("CW10025","의견을 입력하시겠습니까?") )
	{
		var arg = "";
		arg = " fa_docno=" + quote(ds_decide.GetColumn(0,"DOCNO")) +" fa_dockind=" + quote(ds_decide.GetColumn(0,"DOCKIND"));
		var rtn_yn = gfn_openPopup2("CS0401001C", true , arg);
	}
	//alert("rtn_yn:"+rtn_yn);
	// 의견입력 팝업 종료
	//----------------------------------------------------------------------
	    
	// 결재상태변경
	//부서장 전결의 경우 투입자재가 없거나 투입예상자재인 경우는 기안결재 완료 처리
	//CS311_AMG = 'Y' 추가 자재, 시행율2에 반영됨
	//CS311_AMG = 'N' 투입예상 자재 
	var app_end = "R";
	ds_decide.SetColumn(0, "SEQSTAT", "3"); 
	if(ed_cof.Text == '부서장' && ed_cof2.Text == '부서장' && 
			(ds_head.GetColumn(0, "MATOT") == '' || parseInt(ds_head.GetColumn(0, "MATOT")) == 0 
				|| ( ds_head.GetColumn(0, "MATOT") > 0 && ds_head.GetColumn(0, "AMG") == "N" ) ) )
		app_end = "S";
		    
	tit_clearActionInfo();
	tit_addMultiActionInfo("cs04:CS0401002A_U2");
 	tit_addMultiActionInfo("cs04:CS0401002A_U3");
 	//if(app_end == "S")
		tit_addMultiActionInfo("cs04:CS0401002A_U5");
 	tit_addMultiActionInfo("cs12:CS1240001B_U9");
 	//승인메시지(SMS)
 	tit_addMultiActionInfo("cs12:CS1240001B_I9");
 	tit_callService(
		  ""
		, ""
		, "ds_list_0=ds_decide"
		, ""
		, ""
		, "fn_afterDecide"
		, true);
 } 	 
/********************************************************************************
* 기      능   : 결재 Callback  
********************************************************************************/
function fn_afterDecide(errCode, errMsg) {
	if ( ds_error.rowcount() > 0 ) {
		gfn_showAlert("CE00001");
	} else {
		gfn_showAlert("CI00003");
		div_btn.btn_decide.Enable 	= false;	// 결재버튼
		div_btn.btn_sendback.Enable = false;  	// 반송버튼
		//parent.fn_query();
		fn_close();
	}
}

/********************************************************************************
* 기      능   : 반송 65
********************************************************************************/
function fn_sendback() {
	gfn_clearMsgBar();
	
	if( ds_decide.rowCount() < 1 ) {
		// 승인할 정보 없음. 
		return;
	}
	
	if( !gfn_showConfirm("CI00014", "문서번호 : "+ quote(ds_decide.GetColumn(0,"DOCNO"))+ "반송") ) return;
	 
	//----------------------------------------------------------------------
	// 의견 입력 팝업 추가 
	// f팝업 전달 변수 fa_docno : 문서번호 ,fa_dockind : 문서종류 
	// return 값 : rtn_yn (Y:의견입력됨 N:의견입력안됨)
	if(gfn_showConfirm("CW10025","의견을 입력하시겠습니까?") )
	{
		var arg = "";
		arg = " fa_docno=" + quote(ds_decide.GetColumn(0,"DOCNO")) +" fa_dockind=" + quote(ds_decide.GetColumn(0,"DOCKIND"));
		var rtn_yn = gfn_openPopup2("CS0401001C", true , arg);
	}
	//alert("rtn_yn:"+rtn_yn);
	// 의견입력 팝업 종료
	//----------------------------------------------------------------------
	
	tit_clearActionInfo();
	
	// 결재상태변경
	ds_decide.SetColumn(0, "SEQSTAT", "2");
	// 결재정보 관리 - 차순별 결재정보  update(zwbap02)
 	tit_addMultiActionInfo("cs04:CS0401002A_U2");
 	// 현장지원 결재 정보 관리 update(zwbap01)
 	tit_addMultiActionInfo("cs04:CS0401002A_U3");
 	tit_addMultiActionInfo("cs12:CS1240001B_U10");
	//반송메시지(SMS)
	tit_addMultiActionInfo("cs12:CS1240001B_I10");
	
	tit_callService(
		  ""
		, ""
		, "ds_list_0=ds_decide" 
		, ""
		, ""
		, "fn_afterSendback"
		, true);
}

/********************************************************************************
* 기      능   : 반송 Callback  
********************************************************************************/
function fn_afterSendback(errCode, errMsg) {
	if ( ds_error.rowcount() > 0 ) {
		gfn_showAlert("CE00001");
	} else {
		gfn_showAlert("CI00003");
		div_btn.btn_decide.Enable 	= false;	// 결재버튼
		div_btn.btn_sendback.Enable = false;  	// 반송버튼
		
		//parent.fn_query();
		fn_close();
	}
}


/********************************************************************************
* 기      능   : 인원상주 정보 입력 201512 이하림
상태별 권한 체크할것
********************************************************************************/
function btn_sangju_OnClick(obj)
{
	gfn_clearMsgBar();
	
	if(length(ds_head.GetColumn(0, "ETN")) == 0) {
		gfn_showAlert("견적작성후 상주입력 가능합니다.");
		return false;
	}
	
	var arg = "t_pst=" + quote(ds_head.GetColumn(0, "PST")) + " t_apstat=" + quote(ds_head.GetColumn(0, "APSTAT")) + " t_amg=N";

	gfn_openPopup("CS1240001J", true, arg);
	
	
}
/********************************************************************************
* 기      능   : 상주 포함 원가 구하기
********************************************************************************/		
function fn_calCostS(){

	tit_clearActionInfo();
	tit_addSingleActionInfo("cs12:CS1240001B_S23");
	tit_callService(
		""
		, ""
		, "ds_cost_sum_i=ds_cost_sum_i"
		, "ds_cost_sum_sj=ds_cost_sum_sj"
		, ""
		, "fn_saveRat2"
		, true);
		
}
/********************************************************************************
* 기      능   : 시행율 계산
********************************************************************************/
function fn_saveRat2() {
	// 상주금액이 없는 경우는 시행율 계산 시 제외
	
	var chk_samt = ParseInt(ds_cost_sum_sj.GetColumn(0,"SJT"));
	
	if(chk_samt == "" or chk_samt == 0) {
		gfn_showMsg("CI00006", "전송");
		fn_selHno();
	} else {
		trace("인원상주 포함 시행율 재계산");
		ds_cost.SetColumn(0, "GMT", ds_cost_sum_sj.GetColumn(0,"GMT"));
		ds_cost.SetColumn(0, "GM2", ds_cost_sum_sj.GetColumn(0,"GM2"));
		ds_cost.SetColumn(0, "COST", ds_cost_sum_sj.GetColumn(0,"COST"));
		ds_cost.SetColumn(0, "COS2", ds_cost_sum_sj.GetColumn(0,"COS2"));
		ds_cost.SetColumn(0, "RAT", ds_cost_sum_sj.GetColumn(0,"RAT"));
		ds_cost.SetColumn(0, "RA2", ds_cost_sum_sj.GetColumn(0,"RA2"));
		ds_cost.SetColumn(0, "PER", ds_cost_sum_sj.GetColumn(0,"PER"));
		ds_cost.SetColumn(0, "SJT", ds_cost_sum_sj.GetColumn(0,"SJT"));
	
//		Trace(ds_cost.SaveXml());
		tit_clearActionInfo();
		tit_addSingleActionInfo("cs12:CS1240001B_I5");
		tit_callService(
			""
			, ""
			, "ds_cost=ds_cost"
			, ""
			, ""
			, "fn_afterSaveRat2"
			, true);
		
	}
}
function fn_afterSaveRat2(errCode, errMsg) {
	if(errCode != 0) {
		gfn_showMsg("CE00001");
	} else {
		gfn_showMsg("CI00006", "전송");
		//close();
		fn_selHno();
	}
}
/********************************************************************************
* 기      능   : 표준단가 가져오기
********************************************************************************/
function fn_getStdPrice(){

	var gdat = cal_cdt.Value;
	//계약예정일 기준 연령 계산
	for(var i=0; i < ds_list2.rowcount; i++){
		ds_list2.SetColumn(i, "DAT", gdat );
		ds_list2.SetColumn(i, "PRAT", 0 );
		ds_list2.SetColumn(i, "FRAT", 0 );
	}
 // TRACE("hno  >>  "+ds_list2.GetColumn(0,"HNO"));
 // TRACE("ZSPEC2  >>  "+ds_list2.GetColumn(0,"ZSPEC2"));
 // TRACE("ZSPEC12  >>  "+ds_list2.GetColumn(0,"ZSPEC12"));
 // TRACE("ABG  >>  "+ds_list2.GetColumn(0,"ABG"));
 // TRACE("CNT  >>  "+ds_list2.GetColumn(0,"CNT"));
 // TRACE("AGEK  >>  "+ds_list2.GetColumn(0,"AGEK"));
 // TRACE("ZSPEC3  >>  "+ds_list2.GetColumn(0,"ZSPEC3"));
 // TRACE("ZSPEC7  >>  "+ds_list2.GetColumn(0,"ZSPEC7"));

	tit_callService(
        "CS1299001A_ACT"
        , "getStdPrice2"
        , "ds_list=ds_list2"
        , "ds_list2=ds_list"
        , ""
        , "fn_aftergetStdPrice");	
}
function fn_aftergetStdPrice() {
	fn_calcAmt();
}
]]></Script>
</Window>