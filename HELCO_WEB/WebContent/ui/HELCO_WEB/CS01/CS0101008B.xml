<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="812" Id="form" Left="8" OnLoadCompleted="fn_OnLoadCompleted" OnUnloadCompleted="fn_OnUnloadCompleted" PidAttrib="7" Title="견적&#32;작성/조회" Top="8" Ver="1.0" Width="1008" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_docno_gen">
				<Contents>
					<colinfo id="PFX" size="256" type="STRING"/>
					<colinfo id="DOCNO" size="256" type="STRING"/>
					<record>
						<PFX></PFX>
						<DOCNO></DOCNO>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_reqkind_cd">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME>-&#32;선택&#32;-</CODE_NAME>
					</record>
					<record>
						<CODE>1</CODE>
						<CODE_NAME>부품판매</CODE_NAME>
					</record>
					<record>
						<CODE>7</CODE>
						<CODE_NAME>수리공사</CODE_NAME>
					</record>
					<record>
						<CODE>S</CODE>
						<CODE_NAME>시스템공사</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond">
				<Contents>
					<colinfo id="CST" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="QTNUM" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQNO" size="256" summ="default" type="STRING"/>
					<colinfo id="SPART" size="256" summ="default" type="STRING"/>
					<colinfo id="UPN" size="256" summ="default" type="STRING"/>
					<colinfo id="USERID" size="256" summ="default" type="STRING"/>
					<colinfo id="USER_GROUP" size="256" summ="default" type="STRING"/>
					<record>
						<CST></CST>
						<LIFNR></LIFNR>
						<QTNUM></QTNUM>
						<SEQ></SEQ>
						<SEQNO></SEQNO>
						<SPART></SPART>
						<UPN></UPN>
						<USER_GROUP></USER_GROUP>
						<USERID></USERID>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_pjt_det">
				<Contents>
					<colinfo id="ADDR" size="256" summ="default" type="STRING"/>
					<colinfo id="ADDRBILL" size="256" summ="default" type="STRING"/>
					<colinfo id="ARA" size="256" summ="default" type="STRING"/>
					<colinfo id="BLD" size="256" summ="default" type="STRING"/>
					<colinfo id="BLDNM" size="256" summ="default" type="STRING"/>
					<colinfo id="BPM" size="256" summ="default" type="STRING"/>
					<colinfo id="BPMNM" size="256" summ="default" type="STRING"/>
					<colinfo id="BSU" size="256" summ="default" type="STRING"/>
					<colinfo id="BSUNM" size="256" summ="default" type="STRING"/>
					<colinfo id="CST" size="256" summ="default" type="STRING"/>
					<colinfo id="ENAME" size="256" summ="default" type="STRING"/>
					<colinfo id="FAILYN" size="256" summ="default" type="STRING"/>
					<colinfo id="GNO" size="256" summ="default" type="STRING"/>
					<colinfo id="HNA" size="256" summ="default" type="STRING"/>
					<colinfo id="HNO" size="256" summ="default" type="STRING"/>
					<colinfo id="KUNNR" size="256" summ="default" type="STRING"/>
					<colinfo id="KUNNRNM" size="256" summ="default" type="STRING"/>
					<colinfo id="MNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="PNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="RATE" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="RATE2" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="SITENM" size="256" summ="default" type="STRING"/>
					<colinfo id="SPART" size="256" summ="default" type="STRING"/>
					<colinfo id="SPARTNM" size="256" summ="default" type="STRING"/>
					<colinfo id="TEL" size="256" summ="default" type="STRING"/>
					<colinfo id="TGB" size="256" summ="default" type="STRING"/>
					<colinfo id="UPN" size="256" summ="default" type="STRING"/>
					<colinfo id="VKBUR" size="256" summ="default" type="STRING"/>
					<colinfo id="VKBURNM" size="256" summ="default" type="STRING"/>
					<colinfo id="VKGRP" size="256" summ="default" type="STRING"/>
					<colinfo id="VKGRPNM" size="256" summ="default" type="STRING"/>
					<colinfo id="WAERS" size="256" summ="default" type="STRING"/>
					<colinfo id="WERKS" size="256" summ="default" type="STRING"/>
					<colinfo id="ZTERM" size="256" summ="default" type="STRING"/>
					<colinfo id="DC_RATE" size="256" summ="default" type="DECIMAL"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_taxk1">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_zterm">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_kvgr1">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_kvgr2">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_bwtar_cd">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list" OnColumnChanged="ds_list_OnColumnChanged">
				<Contents>
					<colinfo id="AMOUNT" size="256" summ="default" type="STRING"/>
					<colinfo id="AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="BANNAB" size="256" summ="default" type="STRING"/>
					<colinfo id="BISMT" size="256" summ="default" type="STRING"/>
					<colinfo id="BLOCK_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="BRGEW" size="256" summ="default" type="STRING"/>
					<colinfo id="BWTAR" size="256" summ="default" type="STRING"/>
					<colinfo id="CGBN" size="256" summ="default" type="STRING"/>
					<colinfo id="CGBNNM" size="256" summ="default" type="STRING"/>
					<colinfo id="CGUBN" size="256" summ="default" type="STRING"/>
					<colinfo id="CHAR1" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="DZEINR" size="256" summ="default" type="STRING"/>
					<colinfo id="EXEDT" size="256" summ="default" type="STRING"/>
					<colinfo id="EXEID" size="256" summ="default" type="STRING"/>
					<colinfo id="EXTWG" size="256" summ="default" type="STRING"/>
					<colinfo id="EXXETM" size="256" summ="default" type="STRING"/>
					<colinfo id="FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="GEWEI" size="256" summ="default" type="STRING"/>
					<colinfo id="HNA" size="256" summ="default" type="STRING"/>
					<colinfo id="HNO" size="256" summ="default" type="STRING"/>
					<colinfo id="HTY" size="256" summ="default" type="STRING"/>
					<colinfo id="JOBHOUR" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="LCOSTC" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="LCOSTS" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="LGFSB" size="256" summ="default" type="STRING"/>
					<colinfo id="LVORM" size="256" summ="default" type="STRING"/>
					<colinfo id="MAKTX" size="256" summ="default" type="STRING"/>
					<colinfo id="MAN" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="MATKL" size="256" summ="default" type="STRING"/>
					<colinfo id="MATNR" size="256" summ="default" type="STRING"/>
					<colinfo id="MATNRNM" size="256" summ="default" type="STRING"/>
					<colinfo id="MATNRNM2" size="256" summ="default" type="STRING"/>
					<colinfo id="MEINS" size="256" summ="default" type="STRING"/>
					<colinfo id="MENGE" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="MTART" size="256" summ="default" type="STRING"/>
					<colinfo id="NETPR" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="NETPR_ORG" size="256" summ="default" type="STRING"/>
					<colinfo id="NETWR" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="NTGEW" size="256" summ="default" type="STRING"/>
					<colinfo id="OFRHOUR" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="PARLAB" size="256" summ="default" type="STRING"/>
					<colinfo id="PARLAB1" size="256" summ="default" type="STRING"/>
					<colinfo id="QTNUM" size="256" summ="default" type="STRING"/>
					<colinfo id="REQKIND" size="256" summ="default" type="STRING"/>
					<colinfo id="REQKIND_CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="REQKINDNM" size="256" summ="default" type="STRING"/>
					<colinfo id="RGBN" size="256" summ="default" type="STRING"/>
					<colinfo id="RGBNNM" size="256" summ="default" type="STRING"/>
					<colinfo id="SAMT2" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="SPEC" size="256" summ="default" type="STRING"/>
					<colinfo id="UCOST" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="UCOSTA" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="UCOSTR" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="UPR" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="VOLEH" size="256" summ="default" type="STRING"/>
					<colinfo id="VOLUM" size="256" summ="default" type="STRING"/>
					<colinfo id="WAERS" size="256" summ="default" type="STRING"/>
					<colinfo id="WEBAZ" size="256" summ="default" type="STRING"/>
					<colinfo id="WERKS" size="256" summ="default" type="STRING"/>
					<colinfo id="WRKST" size="256" summ="default" type="STRING"/>
					<colinfo id="ZGUBN" size="256" summ="default" type="STRING"/>
					<colinfo id="ZGUBN_CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSIZE" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_gbn">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ma_list" OnColumnChanged="ds_list_OnColumnChanged">
				<Contents>
					<colinfo id="BANNAB" size="256" summ="default" type="STRING"/>
					<colinfo id="BISMT" size="256" summ="default" type="STRING"/>
					<colinfo id="BLOCK_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="BRGEW" size="256" summ="default" type="STRING"/>
					<colinfo id="DZEINR" size="256" summ="default" type="STRING"/>
					<colinfo id="EXEDT" size="256" summ="default" type="STRING"/>
					<colinfo id="EXEID" size="256" summ="default" type="STRING"/>
					<colinfo id="EXTWG" size="256" summ="default" type="STRING"/>
					<colinfo id="EXXETM" size="256" summ="default" type="STRING"/>
					<colinfo id="FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="GEWEI" size="256" summ="default" type="STRING"/>
					<colinfo id="JOBHOUR" size="256" summ="default" type="STRING"/>
					<colinfo id="LGFSB" size="256" summ="default" type="STRING"/>
					<colinfo id="LVORM" size="256" summ="default" type="STRING"/>
					<colinfo id="MAKTX" size="256" summ="default" type="STRING"/>
					<colinfo id="MAN" size="256" summ="default" type="STRING"/>
					<colinfo id="MATKL" size="256" summ="default" type="STRING"/>
					<colinfo id="MATNR" size="256" summ="default" type="STRING"/>
					<colinfo id="MATNRNM" size="256" summ="default" type="STRING"/>
					<colinfo id="MATNRNM2" size="256" summ="default" type="STRING"/>
					<colinfo id="MEINS" size="256" summ="default" type="STRING"/>
					<colinfo id="MENGE" size="256" summ="default" type="STRING"/>
					<colinfo id="MTART" size="256" summ="default" type="STRING"/>
					<colinfo id="NTGEW" size="256" summ="default" type="STRING"/>
					<colinfo id="PARLAB" size="256" summ="default" type="STRING"/>
					<colinfo id="PARLAB1" size="256" summ="default" type="STRING"/>
					<colinfo id="RGBN" size="256" summ="default" type="STRING"/>
					<colinfo id="RGBNNM" size="256" summ="default" type="STRING"/>
					<colinfo id="SAMT1" size="256" summ="default" type="STRING"/>
					<colinfo id="SAMT2" size="256" summ="default" type="STRING"/>
					<colinfo id="SAMT3" size="256" summ="default" type="STRING"/>
					<colinfo id="SPEC" size="256" summ="default" type="STRING"/>
					<colinfo id="UPR" size="256" summ="default" type="STRING"/>
					<colinfo id="VOLEH" size="256" summ="default" type="STRING"/>
					<colinfo id="VOLUM" size="256" summ="default" type="STRING"/>
					<colinfo id="WAERS" size="256" summ="default" type="STRING"/>
					<colinfo id="WEBAZ" size="256" summ="default" type="STRING"/>
					<colinfo id="WRKST" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSIZE" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ma_cond">
				<Contents>
					<colinfo id="BWTAR" size="256" summ="default" type="STRING"/>
					<colinfo id="LGORT" size="256" summ="default" type="STRING"/>
					<colinfo id="MATNR" size="256" summ="default" type="STRING"/>
					<colinfo id="NROW" size="256" summ="default" type="STRING"/>
					<colinfo id="SPART" size="256" summ="default" type="STRING"/>
					<record>
						<BWTAR></BWTAR>
						<LGORT></LGORT>
						<MATNR></MATNR>
						<NROW></NROW>
						<SPART></SPART>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_di_stk">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME></CODE_NAME>
					</record>
					<record>
						<CODE>Y</CODE>
						<CODE_NAME>Y</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_out_master" OnColumnChanged="ds_out_master_OnColumnChanged">
				<Contents>
					<colinfo id="ADMCOST1" size="256" summ="default" type="STRING"/>
					<colinfo id="ADMCOST2" size="256" summ="default" type="STRING"/>
					<colinfo id="BGUBN" size="256" summ="default" type="STRING"/>
					<colinfo id="BIL_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="BILAMT1" size="256" summ="default" type="STRING"/>
					<colinfo id="BILAMT2" size="256" summ="default" type="STRING"/>
					<colinfo id="BILAMT3" size="256" summ="default" type="STRING"/>
					<colinfo id="BILDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="BILDAT2" size="256" summ="default" type="STRING"/>
					<colinfo id="BILDAT3" size="256" summ="default" type="STRING"/>
					<colinfo id="BSU" size="256" summ="default" type="STRING"/>
					<colinfo id="BSUNM" size="256" summ="default" type="STRING"/>
					<colinfo id="BUSSI" size="256" summ="default" type="STRING"/>
					<colinfo id="CHGBN" size="256" summ="default" type="STRING"/>
					<colinfo id="CRNAM" size="256" summ="default" type="STRING"/>
					<colinfo id="CRNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="CS001_GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="CST" size="256" summ="default" type="STRING"/>
					<colinfo id="CSTNM" size="256" summ="default" type="STRING"/>
					<colinfo id="DOC1" size="256" summ="default" type="STRING"/>
					<colinfo id="DOC1DEC" size="256" summ="default" type="STRING"/>
					<colinfo id="DOC1DRA" size="256" summ="default" type="STRING"/>
					<colinfo id="DOC1STAT" size="256" summ="default" type="STRING"/>
					<colinfo id="DOC1STATNM" size="256" summ="default" type="STRING"/>
					<colinfo id="DOC2" size="256" summ="default" type="STRING"/>
					<colinfo id="DOC2DEC" size="256" summ="default" type="STRING"/>
					<colinfo id="DOC2STAT" size="256" summ="default" type="STRING"/>
					<colinfo id="DOC2STATNM" size="256" summ="default" type="STRING"/>
					<colinfo id="DOC3" size="256" summ="default" type="STRING"/>
					<colinfo id="DOC3DEC" size="256" summ="default" type="STRING"/>
					<colinfo id="DOC3STAT" size="256" summ="default" type="STRING"/>
					<colinfo id="DOC3STATNM" size="256" summ="default" type="STRING"/>
					<colinfo id="DOC4" size="256" summ="default" type="STRING"/>
					<colinfo id="DOC4DEC" size="256" summ="default" type="STRING"/>
					<colinfo id="DOC4STAT" size="256" summ="default" type="STRING"/>
					<colinfo id="DOC4STATNM" size="256" summ="default" type="STRING"/>
					<colinfo id="DOC5" size="256" summ="default" type="STRING"/>
					<colinfo id="DOC5DEC" size="256" summ="default" type="STRING"/>
					<colinfo id="DOC5STAT" size="256" summ="default" type="STRING"/>
					<colinfo id="DOC5STATNM" size="256" summ="default" type="STRING"/>
					<colinfo id="EXP_PCT" size="256" summ="default" type="STRING"/>
					<colinfo id="EXPENSE1" size="256" summ="default" type="STRING"/>
					<colinfo id="EXPENSE2" size="256" summ="default" type="STRING"/>
					<colinfo id="FAILYN" size="256" summ="default" type="STRING"/>
					<colinfo id="FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="HIS_DIRSUM" size="256" summ="default" type="STRING"/>
					<colinfo id="HIS_INDSUM" size="256" summ="default" type="STRING"/>
					<colinfo id="HIS_LABOR" size="256" summ="default" type="STRING"/>
					<colinfo id="HIS_LCOST" size="256" summ="default" type="STRING"/>
					<colinfo id="HIS_LOG" size="256" summ="default" type="STRING"/>
					<colinfo id="HIS_OEM" size="256" summ="default" type="STRING"/>
					<colinfo id="HIS_INSPEC" size="256" summ="default" type="STRING"/>
					<colinfo id="HIS_ETC" size="256" summ="default" type="STRING"/>
					<colinfo id="HIS_RATE" size="256" summ="default" type="STRING"/>
					<colinfo id="HIS_TOTCOST" size="256" summ="default" type="STRING"/>
					<colinfo id="HIS_UCOST" size="256" summ="default" type="STRING"/>
					<colinfo id="HIS_DLAB" size="256" summ="default" type="STRING"/>
					<colinfo id="HIS_BETC" size="256" summ="default" type="STRING"/>
					<colinfo id="HIS_MMOD" size="256" summ="default" type="STRING"/>
					<colinfo id="HIS_SAFE" size="256" summ="default" type="STRING"/>
					<colinfo id="HIS_LIFT" size="256" summ="default" type="STRING"/>
					<colinfo id="HIS_EMACID" size="256" summ="default" type="STRING"/>
					<colinfo id="ID_RATE" size="256" summ="default" type="STRING"/>
					<colinfo id="KUNNR" size="256" summ="default" type="STRING"/>
					<colinfo id="KVGR1" size="256" summ="default" type="STRING"/>
					<colinfo id="KVGR2" size="256" summ="default" type="STRING"/>
					<colinfo id="LCOST_OFR" size="256" summ="default" type="STRING"/>
					<colinfo id="LCOST_STD" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="MA_PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="MNG_PCT" size="256" summ="default" type="STRING"/>
					<colinfo id="NETWR_DC" size="256" summ="default" type="STRING"/>
					<colinfo id="NETWR_OFR" size="256" summ="default" type="STRING"/>
					<colinfo id="NETWR_STD" size="256" summ="default" type="STRING"/>
					<colinfo id="NIGHT_WGT" size="256" summ="default" type="STRING"/>
					<colinfo id="PGBN" size="256" summ="default" type="STRING"/>
					<colinfo id="PNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="PRO_PCT" size="256" summ="default" type="STRING"/>
					<colinfo id="QSTAT" size="256" summ="default" type="STRING"/>
					<colinfo id="QTAPDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="QTNAM" size="256" summ="default" type="STRING"/>
					<colinfo id="QTNUM" size="256" summ="default" type="STRING"/>
					<colinfo id="RATE" size="256" summ="default" type="STRING"/>
					<colinfo id="REMARK" size="256" summ="default" type="STRING"/>
					<colinfo id="REQKIND" size="256" summ="default" type="STRING"/>
					<colinfo id="REQKINDNM" size="256" summ="default" type="STRING"/>
					<colinfo id="REVENUE1" size="256" summ="default" type="STRING"/>
					<colinfo id="REVENUE2" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="SHDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="SOAPDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="SOCADAT" size="256" summ="default" type="STRING"/>
					<colinfo id="SOCHDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="SODAT" size="256" summ="default" type="STRING"/>
					<colinfo id="SPART" size="256" summ="default" type="STRING"/>
					<colinfo id="SPARTNM" size="256" summ="default" type="STRING"/>
					<colinfo id="SPT" size="256" summ="default" type="STRING"/>
					<colinfo id="SUM_OFR" size="256" summ="default" type="STRING"/>
					<colinfo id="SUM_STD" size="256" summ="default" type="STRING"/>
					<colinfo id="TAXK1" size="256" summ="default" type="STRING"/>
					<colinfo id="UPN" size="256" summ="default" type="STRING"/>
					<colinfo id="VKBUR" size="256" summ="default" type="STRING"/>
					<colinfo id="VKBURNM" size="256" summ="default" type="STRING"/>
					<colinfo id="VKGRP" size="256" summ="default" type="STRING"/>
					<colinfo id="VKGRPNM" size="256" summ="default" type="STRING"/>
					<colinfo id="WEEKEND_WGT" size="256" summ="default" type="STRING"/>
					<colinfo id="WERKS" size="256" summ="default" type="STRING"/>
					<colinfo id="ZTERM" size="256" summ="default" type="STRING"/>
					<colinfo id="ENDYN" size="256" summ="default" type="STRING"/>
					<colinfo id="BOMYN" size="256" summ="default" type="STRING"/>
					<colinfo id="BOMDATE" size="256" summ="default" type="STRING"/>
					<colinfo id="HIS_UCOST_CH" size="256" summ="default" type="STRING"/>
					<colinfo id="HIS_LCOST_CH" size="256" summ="default" type="STRING"/>
					<colinfo id="HIS_INSPEC_CH" size="256" summ="default" type="STRING"/>
					<colinfo id="HIS_LOG_CH" size="256" summ="default" type="STRING"/>
					<colinfo id="HIS_ETC_CH" size="256" summ="default" type="STRING"/>
					<colinfo id="HIS_BETC_CH" size="256" summ="default" type="STRING"/>
					<colinfo id="HIS_LIFT_CH" size="256" summ="default" type="STRING"/>
					<colinfo id="HIS_MMOD_CH" size="256" summ="default" type="STRING"/>
					<colinfo id="HIS_SAFE_CH" size="256" summ="default" type="STRING"/>
					<colinfo id="HIS_UCOST_FN" size="256" summ="default" type="STRING"/>
					<colinfo id="HIS_LCOST_FN" size="256" summ="default" type="STRING"/>
					<colinfo id="HIS_INSPEC_FN" size="256" summ="default" type="STRING"/>
					<colinfo id="HIS_LOG_FN" size="256" summ="default" type="STRING"/>
					<colinfo id="HIS_ETC_FN" size="256" summ="default" type="STRING"/>
					<colinfo id="HIS_LABOR_FN" size="256" summ="default" type="STRING"/>
					<colinfo id="HIS_DIRSUM_FN" size="256" summ="default" type="STRING"/>
					<colinfo id="HIS_INDSUM_FN" size="256" summ="default" type="STRING"/>
					<colinfo id="HIS_TOTCOST_FN" size="256" summ="default" type="STRING"/>
					<colinfo id="HIS_RATE_FN" size="256" summ="default" type="STRING"/>
					<colinfo id="HIS_DLAB_FN" size="256" summ="default" type="STRING"/>
					<colinfo id="HIS_BETC_FN" size="256" summ="default" type="STRING"/>
					<colinfo id="HIS_MMOD_FN" size="256" summ="default" type="STRING"/>
					<colinfo id="HIS_SAFE_FN" size="256" summ="default" type="STRING"/>
					<colinfo id="HIS_LIFT_FN" size="256" summ="default" type="STRING"/>
					<colinfo id="HIS_EMACID_FN" size="256" summ="default" type="STRING"/>
					<colinfo id="MODGBN" size="256" summ="default" type="STRING"/>
					<colinfo id="NETWRDC_RATE" size="256" summ="default" type="STRING"/>
					<colinfo id="AGENT" size="256" summ="default" type="STRING"/>
					<colinfo id="CYN" size="256" summ="default" type="STRING"/>
					<colinfo id="CTP" size="256" summ="default" type="STRING"/>
					<colinfo id="CSE" size="256" summ="default" type="STRING"/>
					<colinfo id="CST_JUDGE" size="1" summ="default" type="STRING"/>
					<colinfo id="HIS_UCOST_SS" size="256" summ="default" type="STRING"/>
					<colinfo id="HIS_LAB_SS" size="256" summ="default" type="STRING"/>
					<colinfo id="HIS_ETC_SS" size="256" summ="default" type="STRING"/>
					<colinfo id="HIS_INDSUM_SS" size="256" summ="default" type="STRING"/>
					<colinfo id="HIS_LOG_SS" size="256" summ="default" type="STRING"/>
					<colinfo id="HIS_ORE_SS" size="256" summ="default" type="STRING"/>
					<colinfo id="HIS_INSPEC_SS" size="256" summ="default" type="STRING"/>
					<colinfo id="HIS_UCOST_FN_SS" size="256" summ="default" type="STRING"/>
					<colinfo id="HIS_LAB_FN_SS" size="256" summ="default" type="STRING"/>
					<colinfo id="HIS_ETC_FN_SS" size="256" summ="default" type="STRING"/>
					<colinfo id="HIS_INDSUM_FN_SS" size="256" summ="default" type="STRING"/>
					<colinfo id="HIS_LOG_FN_SS" size="256" summ="default" type="STRING"/>
					<colinfo id="HIS_ORE_FN_SS" size="256" summ="default" type="STRING"/>
					<colinfo id="HIS_INSPEC_FN_SS" size="256" summ="default" type="STRING"/>
					<colinfo id="ILSIC_YN" size="256" summ="default" type="STRING"/>
					<colinfo id="DC_RATE" size="256" summ="default" type="DECIMAL"/>
					<record>
						<ADMCOST1></ADMCOST1>
						<ADMCOST2></ADMCOST2>
						<AGENT></AGENT>
						<BGUBN></BGUBN>
						<BIL_AMT></BIL_AMT>
						<BILAMT1></BILAMT1>
						<BILAMT2></BILAMT2>
						<BILAMT3></BILAMT3>
						<BILDAT></BILDAT>
						<BILDAT2></BILDAT2>
						<BILDAT3></BILDAT3>
						<BOMDATE></BOMDATE>
						<BOMYN></BOMYN>
						<BSU></BSU>
						<BSUNM></BSUNM>
						<BUSSI></BUSSI>
						<CHGBN></CHGBN>
						<CRNAM></CRNAM>
						<CRNAME></CRNAME>
						<CS001_GBN></CS001_GBN>
						<CSE></CSE>
						<CST></CST>
						<CST_JUDGE></CST_JUDGE>
						<CSTNM></CSTNM>
						<CTP></CTP>
						<CYN></CYN>
						<DC_RATE/>
						<DOC1></DOC1>
						<DOC1DEC></DOC1DEC>
						<DOC1DRA></DOC1DRA>
						<DOC1STAT></DOC1STAT>
						<DOC1STATNM></DOC1STATNM>
						<DOC2></DOC2>
						<DOC2DEC></DOC2DEC>
						<DOC2STAT></DOC2STAT>
						<DOC2STATNM></DOC2STATNM>
						<DOC3></DOC3>
						<DOC3DEC></DOC3DEC>
						<DOC3STAT></DOC3STAT>
						<DOC3STATNM></DOC3STATNM>
						<DOC4></DOC4>
						<DOC4DEC></DOC4DEC>
						<DOC4STAT></DOC4STAT>
						<DOC4STATNM></DOC4STATNM>
						<DOC5></DOC5>
						<DOC5DEC></DOC5DEC>
						<DOC5STAT></DOC5STAT>
						<DOC5STATNM></DOC5STATNM>
						<ENDYN></ENDYN>
						<EXP_PCT></EXP_PCT>
						<EXPENSE1></EXPENSE1>
						<EXPENSE2></EXPENSE2>
						<FAILYN></FAILYN>
						<FLAG></FLAG>
						<HIS_BETC></HIS_BETC>
						<HIS_BETC_CH></HIS_BETC_CH>
						<HIS_BETC_FN></HIS_BETC_FN>
						<HIS_DIRSUM></HIS_DIRSUM>
						<HIS_DIRSUM_FN></HIS_DIRSUM_FN>
						<HIS_DLAB></HIS_DLAB>
						<HIS_DLAB_FN></HIS_DLAB_FN>
						<HIS_EMACID></HIS_EMACID>
						<HIS_EMACID_FN></HIS_EMACID_FN>
						<HIS_ETC></HIS_ETC>
						<HIS_ETC_CH></HIS_ETC_CH>
						<HIS_ETC_FN></HIS_ETC_FN>
						<HIS_ETC_FN_SS></HIS_ETC_FN_SS>
						<HIS_ETC_SS></HIS_ETC_SS>
						<HIS_INDSUM></HIS_INDSUM>
						<HIS_INDSUM_FN></HIS_INDSUM_FN>
						<HIS_INDSUM_FN_SS></HIS_INDSUM_FN_SS>
						<HIS_INDSUM_SS></HIS_INDSUM_SS>
						<HIS_INSPEC></HIS_INSPEC>
						<HIS_INSPEC_CH></HIS_INSPEC_CH>
						<HIS_INSPEC_FN></HIS_INSPEC_FN>
						<HIS_INSPEC_FN_SS></HIS_INSPEC_FN_SS>
						<HIS_INSPEC_SS></HIS_INSPEC_SS>
						<HIS_LAB_FN_SS></HIS_LAB_FN_SS>
						<HIS_LAB_SS></HIS_LAB_SS>
						<HIS_LABOR></HIS_LABOR>
						<HIS_LABOR_FN></HIS_LABOR_FN>
						<HIS_LCOST></HIS_LCOST>
						<HIS_LCOST_CH></HIS_LCOST_CH>
						<HIS_LCOST_FN></HIS_LCOST_FN>
						<HIS_LIFT></HIS_LIFT>
						<HIS_LIFT_CH></HIS_LIFT_CH>
						<HIS_LIFT_FN></HIS_LIFT_FN>
						<HIS_LOG></HIS_LOG>
						<HIS_LOG_CH></HIS_LOG_CH>
						<HIS_LOG_FN></HIS_LOG_FN>
						<HIS_LOG_FN_SS></HIS_LOG_FN_SS>
						<HIS_LOG_SS></HIS_LOG_SS>
						<HIS_MMOD></HIS_MMOD>
						<HIS_MMOD_CH></HIS_MMOD_CH>
						<HIS_MMOD_FN></HIS_MMOD_FN>
						<HIS_OEM></HIS_OEM>
						<HIS_ORE_FN_SS></HIS_ORE_FN_SS>
						<HIS_ORE_SS></HIS_ORE_SS>
						<HIS_RATE></HIS_RATE>
						<HIS_RATE_FN></HIS_RATE_FN>
						<HIS_SAFE></HIS_SAFE>
						<HIS_SAFE_CH></HIS_SAFE_CH>
						<HIS_SAFE_FN></HIS_SAFE_FN>
						<HIS_TOTCOST></HIS_TOTCOST>
						<HIS_TOTCOST_FN></HIS_TOTCOST_FN>
						<HIS_UCOST></HIS_UCOST>
						<HIS_UCOST_CH></HIS_UCOST_CH>
						<HIS_UCOST_FN></HIS_UCOST_FN>
						<HIS_UCOST_FN_SS></HIS_UCOST_FN_SS>
						<HIS_UCOST_SS></HIS_UCOST_SS>
						<ID_RATE></ID_RATE>
						<ILSIC_YN></ILSIC_YN>
						<KUNNR></KUNNR>
						<KVGR1></KVGR1>
						<KVGR2></KVGR2>
						<LCOST_OFR></LCOST_OFR>
						<LCOST_STD></LCOST_STD>
						<LIFNR></LIFNR>
						<MA_PSPID></MA_PSPID>
						<MNG_PCT></MNG_PCT>
						<MODGBN></MODGBN>
						<NETWR_DC></NETWR_DC>
						<NETWR_OFR></NETWR_OFR>
						<NETWR_STD></NETWR_STD>
						<NETWRDC_RATE></NETWRDC_RATE>
						<NIGHT_WGT></NIGHT_WGT>
						<PGBN></PGBN>
						<PNAME></PNAME>
						<PRO_PCT></PRO_PCT>
						<QSTAT></QSTAT>
						<QTAPDAT></QTAPDAT>
						<QTNAM></QTNAM>
						<QTNUM></QTNUM>
						<RATE></RATE>
						<REMARK></REMARK>
						<REQKIND></REQKIND>
						<REQKINDNM></REQKINDNM>
						<REVENUE1></REVENUE1>
						<REVENUE2></REVENUE2>
						<SEQ></SEQ>
						<SHDAT></SHDAT>
						<SOAPDAT></SOAPDAT>
						<SOCADAT></SOCADAT>
						<SOCHDAT></SOCHDAT>
						<SODAT></SODAT>
						<SPART></SPART>
						<SPARTNM></SPARTNM>
						<SPT></SPT>
						<SUM_OFR></SUM_OFR>
						<SUM_STD></SUM_STD>
						<TAXK1></TAXK1>
						<UPN></UPN>
						<VKBUR></VKBUR>
						<VKBURNM></VKBURNM>
						<VKGRP></VKGRP>
						<VKGRPNM></VKGRPNM>
						<WEEKEND_WGT></WEEKEND_WGT>
						<WERKS></WERKS>
						<ZTERM></ZTERM>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_days">
				<Contents>
					<colinfo id="DAYS" size="256" type="STRING"/>
					<record>
						<DAYS></DAYS>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_key">
				<Contents>
					<colinfo id="QTNUM" size="31" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="MAX_SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="TYPE" size="256" summ="default" type="STRING"/>
					<colinfo id="BOMDATE" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond_del">
				<Contents>
					<colinfo id="QTNUM" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQNO" size="256" summ="default" type="STRING"/>
					<record>
						<QTNUM></QTNUM>
						<SEQ></SEQ>
						<SEQNO></SEQNO>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_seq">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE>0</CODE>
						<CODE_NAME>원본</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_hna">
				<Contents>
					<colinfo id="CST" size="256" summ="default" type="STRING"/>
					<colinfo id="HNA" size="256" summ="default" type="STRING"/>
					<colinfo id="HNO" size="256" summ="default" type="STRING"/>
					<colinfo id="HTY" size="256" summ="default" type="STRING"/>
					<colinfo id="PJT" size="256" summ="default" type="STRING"/>
					<colinfo id="UPN" size="256" summ="default" type="STRING"/>
					<colinfo id="WBS" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_dec">
				<Contents>
					<colinfo id="APPGUBN" size="256" summ="default" type="STRING"/>
					<colinfo id="APSTAT" size="256" summ="default" type="STRING"/>
					<colinfo id="DOCKIND" size="256" summ="default" type="STRING"/>
					<colinfo id="DOCNO" size="256" summ="default" type="STRING"/>
					<colinfo id="REIRUM" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQNO" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQSTAT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_jhgbn">
				<Contents>
					<colinfo id="JHGBN" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_rgbn_cd">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE>1</CODE>
						<CODE_NAME>보수자재</CODE_NAME>
					</record>
					<record>
						<CODE>2</CODE>
						<CODE_NAME>내작자재</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list_req">
				<Contents>
					<colinfo id="AMOUNT" size="256" summ="default" type="STRING"/>
					<colinfo id="AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="BANNAB" size="256" summ="default" type="STRING"/>
					<colinfo id="BISMT" size="256" summ="default" type="STRING"/>
					<colinfo id="BLOCK_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="BRGEW" size="256" summ="default" type="STRING"/>
					<colinfo id="BWTAR" size="256" summ="default" type="STRING"/>
					<colinfo id="CGBN" size="256" summ="default" type="STRING"/>
					<colinfo id="CGBNNM" size="256" summ="default" type="STRING"/>
					<colinfo id="CGUBN" size="256" summ="default" type="STRING"/>
					<colinfo id="CHAR1" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="DZEINR" size="256" summ="default" type="STRING"/>
					<colinfo id="EXEDT" size="256" summ="default" type="STRING"/>
					<colinfo id="EXEID" size="256" summ="default" type="STRING"/>
					<colinfo id="EXTWG" size="256" summ="default" type="STRING"/>
					<colinfo id="EXXETM" size="256" summ="default" type="STRING"/>
					<colinfo id="FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="GEWEI" size="256" summ="default" type="STRING"/>
					<colinfo id="HNA" size="256" summ="default" type="STRING"/>
					<colinfo id="HNO" size="256" summ="default" type="STRING"/>
					<colinfo id="HTY" size="256" summ="default" type="STRING"/>
					<colinfo id="JOBHOUR" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="LCOSTC" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="LCOSTS" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="LGFSB" size="256" summ="default" type="STRING"/>
					<colinfo id="LVORM" size="256" summ="default" type="STRING"/>
					<colinfo id="MAKTX" size="256" summ="default" type="STRING"/>
					<colinfo id="MAN" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="MATKL" size="256" summ="default" type="STRING"/>
					<colinfo id="MATNR" size="256" summ="default" type="STRING"/>
					<colinfo id="MATNRNM" size="256" summ="default" type="STRING"/>
					<colinfo id="MATNRNM2" size="256" summ="default" type="STRING"/>
					<colinfo id="MEINS" size="256" summ="default" type="STRING"/>
					<colinfo id="MENGE" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="MTART" size="256" summ="default" type="STRING"/>
					<colinfo id="NETPR" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="NETPR_ORG" size="256" summ="default" type="STRING"/>
					<colinfo id="NETWR" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="NTGEW" size="256" summ="default" type="STRING"/>
					<colinfo id="OFRHOUR" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="PARLAB" size="256" summ="default" type="STRING"/>
					<colinfo id="PARLAB1" size="256" summ="default" type="STRING"/>
					<colinfo id="QTNUM" size="256" summ="default" type="STRING"/>
					<colinfo id="REQKIND" size="256" summ="default" type="STRING"/>
					<colinfo id="REQKIND_CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="REQKINDNM" size="256" summ="default" type="STRING"/>
					<colinfo id="RGBN" size="256" summ="default" type="STRING"/>
					<colinfo id="RGBNNM" size="256" summ="default" type="STRING"/>
					<colinfo id="SAMT2" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="SPEC" size="256" summ="default" type="STRING"/>
					<colinfo id="UCOST" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="UCOSTA" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="UCOSTR" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="UPR" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="VOLEH" size="256" summ="default" type="STRING"/>
					<colinfo id="VOLUM" size="256" summ="default" type="STRING"/>
					<colinfo id="WAERS" size="256" summ="default" type="STRING"/>
					<colinfo id="WERKS" size="256" summ="default" type="STRING"/>
					<colinfo id="WRKST" size="256" summ="default" type="STRING"/>
					<colinfo id="ZGUBN" size="256" summ="default" type="STRING"/>
					<colinfo id="ZGUBN_CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSIZE" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_vkdet">
				<Contents>
					<colinfo id="ADR1" size="256" summ="default" type="STRING"/>
					<colinfo id="ED_PERNR" size="256" summ="default" type="STRING"/>
					<colinfo id="FAX" size="256" summ="default" type="STRING"/>
					<colinfo id="MBPN" size="256" summ="default" type="STRING"/>
					<colinfo id="PERNR" size="256" summ="default" type="STRING"/>
					<colinfo id="TEL" size="256" summ="default" type="STRING"/>
					<colinfo id="VAT" size="256" summ="default" type="STRING"/>
					<colinfo id="VKBUR" size="256" summ="default" type="STRING"/>
					<colinfo id="VKGRP" size="256" summ="default" type="STRING"/>
					<colinfo id="VKGRPNM" size="256" summ="default" type="STRING"/>
					<colinfo id="ADR2" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list_sum">
				<Contents>
					<colinfo id="AMOUNT" size="256" summ="default" type="STRING"/>
					<colinfo id="AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="BANNAB" size="256" summ="default" type="STRING"/>
					<colinfo id="BISMT" size="256" summ="default" type="STRING"/>
					<colinfo id="BLOCK_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="BRGEW" size="256" summ="default" type="STRING"/>
					<colinfo id="BWTAR" size="256" summ="default" type="STRING"/>
					<colinfo id="CGBN" size="256" summ="default" type="STRING"/>
					<colinfo id="CGBNNM" size="256" summ="default" type="STRING"/>
					<colinfo id="CGUBN" size="256" summ="default" type="STRING"/>
					<colinfo id="CHAR1" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="DZEINR" size="256" summ="default" type="STRING"/>
					<colinfo id="EXEDT" size="256" summ="default" type="STRING"/>
					<colinfo id="EXEID" size="256" summ="default" type="STRING"/>
					<colinfo id="EXTWG" size="256" summ="default" type="STRING"/>
					<colinfo id="EXXETM" size="256" summ="default" type="STRING"/>
					<colinfo id="FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="GEWEI" size="256" summ="default" type="STRING"/>
					<colinfo id="HNA" size="256" summ="default" type="STRING"/>
					<colinfo id="HNO" size="256" summ="default" type="STRING"/>
					<colinfo id="HTY" size="256" summ="default" type="STRING"/>
					<colinfo id="JOBHOUR" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="LCOSTC" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="LCOSTS" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="LGFSB" size="256" summ="default" type="STRING"/>
					<colinfo id="LVORM" size="256" summ="default" type="STRING"/>
					<colinfo id="MAKTX" size="256" summ="default" type="STRING"/>
					<colinfo id="MAN" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="MATKL" size="256" summ="default" type="STRING"/>
					<colinfo id="MATNR" size="256" summ="default" type="STRING"/>
					<colinfo id="MATNRNM" size="256" summ="default" type="STRING"/>
					<colinfo id="MATNRNM2" size="256" summ="default" type="STRING"/>
					<colinfo id="MEINS" size="256" summ="default" type="STRING"/>
					<colinfo id="MENGE" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="MTART" size="256" summ="default" type="STRING"/>
					<colinfo id="NETPR" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="NETPR_ORG" size="256" summ="default" type="STRING"/>
					<colinfo id="NETWR" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="NTGEW" size="256" summ="default" type="STRING"/>
					<colinfo id="OFRHOUR" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="PARLAB" size="256" summ="default" type="STRING"/>
					<colinfo id="PARLAB1" size="256" summ="default" type="STRING"/>
					<colinfo id="QTNUM" size="256" summ="default" type="STRING"/>
					<colinfo id="REQKIND" size="256" summ="default" type="STRING"/>
					<colinfo id="REQKIND_CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="REQKINDNM" size="256" summ="default" type="STRING"/>
					<colinfo id="RGBN" size="256" summ="default" type="STRING"/>
					<colinfo id="RGBNNM" size="256" summ="default" type="STRING"/>
					<colinfo id="SAMT2" size="256" summ="default" type="STRING"/>
					<colinfo id="SPEC" size="256" summ="default" type="STRING"/>
					<colinfo id="UCOST" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="UCOSTA" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="UCOSTR" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="UPR" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="VOLEH" size="256" summ="default" type="STRING"/>
					<colinfo id="VOLUM" size="256" summ="default" type="STRING"/>
					<colinfo id="WAERS" size="256" summ="default" type="STRING"/>
					<colinfo id="WERKS" size="256" summ="default" type="STRING"/>
					<colinfo id="WRKST" size="256" summ="default" type="STRING"/>
					<colinfo id="ZGUBN" size="256" summ="default" type="STRING"/>
					<colinfo id="ZGUBN_CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSIZE" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_plan">
				<Contents>
					<colinfo id="MANDT" size="256" summ="default" type="STRING"/>
					<colinfo id="ARA" size="256" summ="default" type="STRING"/>
					<colinfo id="BLD" size="256" summ="default" type="STRING"/>
					<colinfo id="GBNA" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="MAGM" size="256" summ="default" type="STRING"/>
					<colinfo id="MDT" size="256" summ="default" type="STRING"/>
					<colinfo id="MID" size="256" summ="default" type="STRING"/>
					<colinfo id="NAM" size="256" summ="default" type="STRING"/>
					<colinfo id="QTNUM" size="256" summ="default" type="STRING"/>
					<colinfo id="QTY" size="256" summ="default" type="STRING"/>
					<colinfo id="SDT" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="SHDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="TEXT" size="256" summ="default" type="STRING"/>
					<colinfo id="UPN" size="256" summ="default" type="STRING"/>
					<colinfo id="VKGRP" size="256" summ="default" type="STRING"/>
					<colinfo id="YDA" size="256" summ="default" type="STRING"/>
					<colinfo id="YDR" size="256" summ="default" type="STRING"/>
					<colinfo id="YDT" size="256" summ="default" type="STRING"/>
					<colinfo id="YYMM" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_plan_cnt">
				<Contents>
					<colinfo id="CNT" size="256" summ="default" type="STRING"/>
					<record>
						<CNT></CNT>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list_parts">
				<Contents>
					<colinfo id="AMOUNT" size="256" summ="default" type="STRING"/>
					<colinfo id="AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="BANNAB" size="256" summ="default" type="STRING"/>
					<colinfo id="BISMT" size="256" summ="default" type="STRING"/>
					<colinfo id="BLOCK_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="BRGEW" size="256" summ="default" type="STRING"/>
					<colinfo id="BWTAR" size="256" summ="default" type="STRING"/>
					<colinfo id="CGBN" size="256" summ="default" type="STRING"/>
					<colinfo id="CGBNNM" size="256" summ="default" type="STRING"/>
					<colinfo id="CGUBN" size="256" summ="default" type="STRING"/>
					<colinfo id="CHAR1" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="DZEINR" size="256" summ="default" type="STRING"/>
					<colinfo id="EXEDT" size="256" summ="default" type="STRING"/>
					<colinfo id="EXEID" size="256" summ="default" type="STRING"/>
					<colinfo id="EXTWG" size="256" summ="default" type="STRING"/>
					<colinfo id="EXXETM" size="256" summ="default" type="STRING"/>
					<colinfo id="FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="GEWEI" size="256" summ="default" type="STRING"/>
					<colinfo id="HNA" size="256" summ="default" type="STRING"/>
					<colinfo id="HNO" size="256" summ="default" type="STRING"/>
					<colinfo id="HTY" size="256" summ="default" type="STRING"/>
					<colinfo id="JOBHOUR" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="LCOSTC" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="LCOSTS" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="LGFSB" size="256" summ="default" type="STRING"/>
					<colinfo id="LVORM" size="256" summ="default" type="STRING"/>
					<colinfo id="MAKTX" size="256" summ="default" type="STRING"/>
					<colinfo id="MAN" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="MATKL" size="256" summ="default" type="STRING"/>
					<colinfo id="MATNR" size="256" summ="default" type="STRING"/>
					<colinfo id="MATNRNM" size="256" summ="default" type="STRING"/>
					<colinfo id="MATNRNM2" size="256" summ="default" type="STRING"/>
					<colinfo id="MEINS" size="256" summ="default" type="STRING"/>
					<colinfo id="MENGE" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="MTART" size="256" summ="default" type="STRING"/>
					<colinfo id="NETPR" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="NETPR_ORG" size="256" summ="default" type="STRING"/>
					<colinfo id="NETWR" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="NTGEW" size="256" summ="default" type="STRING"/>
					<colinfo id="OFRHOUR" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="PARLAB" size="256" summ="default" type="STRING"/>
					<colinfo id="PARLAB1" size="256" summ="default" type="STRING"/>
					<colinfo id="QTNUM" size="256" summ="default" type="STRING"/>
					<colinfo id="REQKIND" size="256" summ="default" type="STRING"/>
					<colinfo id="REQKIND_CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="REQKINDNM" size="256" summ="default" type="STRING"/>
					<colinfo id="RGBN" size="256" summ="default" type="STRING"/>
					<colinfo id="RGBNNM" size="256" summ="default" type="STRING"/>
					<colinfo id="SAMT2" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="SPEC" size="256" summ="default" type="STRING"/>
					<colinfo id="UCOST" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="UCOSTA" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="UCOSTR" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="UPR" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="VOLEH" size="256" summ="default" type="STRING"/>
					<colinfo id="VOLUM" size="256" summ="default" type="STRING"/>
					<colinfo id="WAERS" size="256" summ="default" type="STRING"/>
					<colinfo id="WERKS" size="256" summ="default" type="STRING"/>
					<colinfo id="WRKST" size="256" summ="default" type="STRING"/>
					<colinfo id="ZGUBN" size="256" summ="default" type="STRING"/>
					<colinfo id="ZGUBN_CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSIZE" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_reject_wb">
				<Contents>
					<colinfo id="APNUM1" size="256" summ="default" type="STRING"/>
					<colinfo id="APNUM2" size="256" summ="default" type="STRING"/>
					<colinfo id="APDESC" size="256" summ="default" type="STRING"/>
					<record>
						<APDESC></APDESC>
						<APNUM1></APNUM1>
						<APNUM2></APNUM2>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_reject_cond">
				<Contents>
					<colinfo id="DOCNO" size="256" summ="default" type="STRING"/>
					<record>
						<DOCNO></DOCNO>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_reject_list">
				<Contents>
					<colinfo id="MESGSEND" size="256" summ="default" type="STRING"/>
					<colinfo id="MESGACCP" size="256" summ="default" type="STRING"/>
					<colinfo id="MESGTITL" size="256" summ="default" type="STRING"/>
					<colinfo id="MESGDESC" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_spartnm">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME>-&#32;선택&#32;-</CODE_NAME>
					</record>
					<record>
						<CODE>10</CODE>
						<CODE_NAME>승강기</CODE_NAME>
					</record>
					<record>
						<CODE>20</CODE>
						<CODE_NAME>주차</CODE_NAME>
					</record>
					<record>
						<CODE>40</CODE>
						<CODE_NAME>PSD</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_qtm">
				<Contents>
					<colinfo id="QTNUM" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="256" summ="default" type="STRING"/>
					<record>
						<QTNUM></QTNUM>
						<SEQ></SEQ>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_prtCustomer">
				<Contents>
					<colinfo id="QTNUM" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="256" summ="default" type="STRING"/>
					<record>
						<QTNUM></QTNUM>
						<SEQ></SEQ>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_draft">
				<Contents>
					<colinfo id="DOC" size="256" summ="default" type="STRING"/>
					<colinfo id="DKN" size="256" summ="default" type="STRING"/>
					<colinfo id="STA" size="256" summ="default" type="STRING"/>
					<colinfo id="FNA" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_bom">
				<Contents>
					<colinfo id="BOMNUM" size="256" summ="default" type="STRING"/>
					<colinfo id="MDT" size="256" summ="default" type="STRING"/>
					<colinfo id="MTM" size="256" summ="default" type="STRING"/>
					<colinfo id="MID" size="256" summ="default" type="STRING"/>
					<record>
						<BOMNUM></BOMNUM>
						<MDT></MDT>
						<MID></MID>
						<MTM></MTM>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_modgbn">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_agent">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ctp_cd">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cst_cd1">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME>-&#32;선택&#32;-</CODE_NAME>
					</record>
					<record>
						<CODE>Y</CODE>
						<CODE_NAME>예</CODE_NAME>
					</record>
					<record>
						<CODE>N</CODE>
						<CODE_NAME>아니오</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cyn_cd">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME>-&#32;선택&#32;-</CODE_NAME>
					</record>
					<record>
						<CODE>Y</CODE>
						<CODE_NAME>예</CODE_NAME>
					</record>
					<record>
						<CODE>N</CODE>
						<CODE_NAME>아니오</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ind">
				<Contents></Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_j_depart">
				<Contents>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="J_VKBUR" size="256" summ="default" type="STRING"/>
					<colinfo id="J_VKBURNM" size="256" summ="default" type="STRING"/>
					<colinfo id="J_VKGRP" size="256" summ="default" type="STRING"/>
					<colinfo id="J_VKGRPNM" size="256" summ="default" type="STRING"/>
					<record>
						<CHK></CHK>
						<J_VKBUR></J_VKBUR>
						<J_VKBURNM></J_VKBURNM>
						<J_VKGRP></J_VKGRP>
						<J_VKGRPNM></J_VKGRPNM>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond_j">
				<Contents>
					<colinfo id="LANG" size="256" summ="default" type="STRING"/>
					<record>
						<LANG></LANG>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_rcond">
				<Contents>
					<colinfo id="ZPROGRAM" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN" size="256" summ="default" type="STRING"/>
					<record>
						<GBN></GBN>
						<ZPROGRAM></ZPROGRAM>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_out_elj" OnColumnChanged="ds_out_master_OnColumnChanged">
				<Contents>
					<colinfo id="QTNUM" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="REQKIND" size="256" summ="default" type="STRING"/>
					<colinfo id="MA_PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="ZTERM" size="256" summ="default" type="STRING"/>
					<colinfo id="REMARK" size="256" summ="default" type="STRING"/>
					<colinfo id="WAERS" size="256" summ="default" type="STRING"/>
					<colinfo id="TAXK1" size="256" summ="default" type="STRING"/>
					<colinfo id="KVGR1" size="256" summ="default" type="STRING"/>
					<colinfo id="KVGR2" size="256" summ="default" type="STRING"/>
					<colinfo id="WERKS" size="256" summ="default" type="STRING"/>
					<colinfo id="BILDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="BILDAT2" size="256" summ="default" type="STRING"/>
					<colinfo id="BILDAT3" size="256" summ="default" type="STRING"/>
					<colinfo id="BILAMT1" size="256" summ="default" type="STRING"/>
					<colinfo id="BILAMT2" size="256" summ="default" type="STRING"/>
					<colinfo id="BILAMT3" size="256" summ="default" type="STRING"/>
					<colinfo id="BGUBN" size="256" summ="default" type="STRING"/>
					<colinfo id="PS_PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="PARTAMT" size="256" summ="default" type="STRING"/>
					<colinfo id="LABOAMT" size="256" summ="default" type="STRING"/>
					<colinfo id="SPT" size="256" summ="default" type="STRING"/>
					<colinfo id="CSTNM" size="256" summ="default" type="STRING"/>
					<colinfo id="KUNNR" size="256" summ="default" type="STRING"/>
					<colinfo id="FLAG" size="256" summ="default" type="STRING"/>
					<record>
						<BGUBN></BGUBN>
						<BILAMT1></BILAMT1>
						<BILAMT2></BILAMT2>
						<BILAMT3></BILAMT3>
						<BILDAT></BILDAT>
						<BILDAT2></BILDAT2>
						<BILDAT3></BILDAT3>
						<CSTNM></CSTNM>
						<FLAG></FLAG>
						<KUNNR></KUNNR>
						<KVGR1></KVGR1>
						<KVGR2></KVGR2>
						<LABOAMT></LABOAMT>
						<MA_PSPID></MA_PSPID>
						<PARTAMT></PARTAMT>
						<PS_PSPID></PS_PSPID>
						<QTNUM></QTNUM>
						<REMARK></REMARK>
						<REQKIND></REQKIND>
						<SEQ></SEQ>
						<SPT></SPT>
						<TAXK1></TAXK1>
						<WAERS></WAERS>
						<WERKS></WERKS>
						<ZTERM></ZTERM>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_reqkind_cd2">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME>-&#32;선택&#32;-</CODE_NAME>
					</record>
					<record>
						<CODE>1</CODE>
						<CODE_NAME>유상청구</CODE_NAME>
					</record>
					<record>
						<CODE>7</CODE>
						<CODE_NAME>수리공사</CODE_NAME>
					</record>
					<record>
						<CODE>9</CODE>
						<CODE_NAME>FM청구</CODE_NAME>
					</record>
					<record>
						<CODE>A</CODE>
						<CODE_NAME>무상청구</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_prohibit_cond">
				<Contents>
					<colinfo id="MANDT" size="256" summ="default" type="STRING"/>
					<colinfo id="MATNR" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_prohibit_result">
				<Contents>
					<colinfo id="MANDT" size="256" summ="default" type="STRING"/>
					<colinfo id="MATNR" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_bom_ck">
				<Contents>
					<colinfo id="BM_CNT" size="256" summ="default" type="STRING"/>
					<record>
						<BM_CNT></BM_CNT>
					</record>
				</Contents>
			</Dataset>
		</Datasets>
		<Grid AreaSelect="TRUE" AutoEnter="TRUE" AutoFitEndLine="Hide" BindDataset="ds_list" BkColor2="default" BoldHead="true" Border="Flat" Bottom="712" CellMoving="TRUE" ColSelect="TRUE" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="131" Id="grd_list" InputPanel="FALSE" Left="72" LineColor="user20" LineType="ExHORZ" OnCellClick="grd_list_OnExpandUp" OnExpandUp="grd_list_OnExpandUp" OnHeadClick="grd_list_OnHeadClick" Right="996" RowHeight="20" Style="sty_grid" TabOrder="35" TabStop="true" Top="581" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="924">
			<contents>
				<format id="Default">
					<columns>
						<col width="18"/>
						<col width="90"/>
						<col width="76"/>
						<col width="71"/>
						<col width="90"/>
						<col width="268"/>
						<col width="96"/>
						<col width="50"/>
						<col width="30"/>
						<col width="80"/>
						<col width="80"/>
						<col width="60"/>
						<col width="60"/>
						<col width="60"/>
						<col width="80"/>
						<col width="80"/>
						<col width="150"/>
						<col width="0"/>
						<col width="80"/>
						<col width="80"/>
						<col width="70"/>
						<col width="80"/>
						<col width="36"/>
						<col width="52"/>
						<col width="80"/>
					</columns>
					<head>
						<cell col="0" display="checkbox" edit="checkbox" font="굴림,9" text="선택"/>
						<cell col="1" display="text" font="굴림,9" text="호기(WBS)"/>
						<cell col="2" display="text" font="굴림,9" text="호기명"/>
						<cell col="3" display="text" font="굴림,9" text="청구유형"/>
						<cell col="4" display="text" font="굴림,9" text="자재번호"/>
						<cell col="5" display="text" font="굴림,9" text="자재내역"/>
						<cell col="6" display="text" font="굴림,9" text="평가유형"/>
						<cell col="7" display="text" font="굴림,9" text="수량"/>
						<cell col="8" display="text" font="굴림,9" text="단위"/>
						<cell col="9" display="text" font="굴림,9" text="판매단가"/>
						<cell col="10" display="text" font="굴림,9" text="판매금액"/>
						<cell col="11" display="text" font="굴림,9" text="투입인원"/>
						<cell col="12" display="text" font="굴림,9" text="표준공수"/>
						<cell col="13" display="text" font="굴림,9" text="견적공수"/>
						<cell col="14" display="text" font="굴림,9" text="인건비(표준)"/>
						<cell col="15" display="text" font="굴림,9" text="인건비(견적)"/>
						<cell col="16" display="text" font="굴림,9" text="자재특성치"/>
						<cell col="17" display="text" font="굴림,9" text="직영재고"/>
						<cell col="18" display="text" font="굴림,9" text="업체재고소진"/>
						<cell col="19" display="text" font="굴림,9" text="변동구분"/>
						<cell col="20" display="text" font="굴림,9" text="LEADTIME"/>
						<cell bkcolor="khaki" col="21" display="text" font="굴림,9" text="자재원가"/>
						<cell bkcolor="khaki" col="22" display="text" font="굴림,9" text="FLAG"/>
						<cell bkcolor="khaki" col="23" display="text" font="굴림,9" text="청구종류"/>
						<cell bkcolor="khaki" col="24" display="text" font="굴림,9" text="AMOUNT"/>
					</head>
					<body>
						<cell align="center" col="0" colid="CHK" display="checkbox" edit="checkbox"/>
						<cell bkcolor="user27" bkimagealign="right" bkimageid="icon_grid_edit" col="1" colid="HNO" combocol="WBS" combodataset="ds_hna" combodisplayrowcnt="20" combotext="WBS" display="combo" edit="combo" expandsize="18"/>
						<cell bkcolor="user27" bkimagealign="right" bkimageid="icon_grid_edit" col="2" colid="HNA" combocol="HNA" combodataset="ds_hna" combodisplayrowcnt="20" combotext="HNA" display="combo" edit="combo"/>
						<cell bkcolor="user27" bkimagealign="right" bkimageid="icon_grid_edit" col="3" colid="RGBN" combocol="CODE" combodataset="ds_rgbn_cd" combotext="CODE_NAME" display="combo" edit="combo"/>
						<cell bkcolor="user27" col="4" colid="MATNR" display="text" edit="normal" expandimage="btn_icon_search" expandshow="true" expandsize="18"/>
						<cell bkcolor="user27" bkimagealign="right" bkimageid="icon_grid_edit" col="5" colid="MAKTX" display="text" edit="normal" limit="120"/>
						<cell align="center" bkcolor="user27" bkimagealign="right" bkimageid="icon_grid_edit" col="6" colid="BWTAR" combocol="CODE" combodataset="ds_bwtar_cd" combotext="CODE_NAME" display="combo" edit="combo"/>
						<cell align="right" bkcolor="user27" bkimagealign="left" bkimageid="icon_grid_edit" col="7" colid="MENGE" display="number" edit="number" LimitDec="2"/>
						<cell align="center" col="8" colid="MEINS" display="text"/>
						<cell align="right" bkimagealign="left" col="9" colid="NETPR" display="currency"/>
						<cell align="right" col="10" colid="NETWR" display="currency"/>
						<cell align="right" col="11" colid="MAN" display="text"/>
						<cell align="right" col="12" colid="JOBHOUR" display="text"/>
						<cell align="right" bkcolor="user27" bkimagealign="left" bkimageid="icon_grid_edit" col="13" colid="OFRHOUR" display="number" edit="number"/>
						<cell align="right" col="14" colid="LCOSTS" display="currency"/>
						<cell align="right" col="15" colid="LCOSTC" display="currency"/>
						<cell bkcolor="user27" bkimagealign="right" bkimageid="icon_grid_edit" col="16" colid="CHAR1" display="text" edit="normal" limit="140"/>
						<cell align="center" bkcolor="user27" bkimagealign="right" bkimageid="icon_grid_edit" col="17" colid="ZGUBN_CHK" display="checkbox" text="Y"/>
						<cell align="center" bkcolor="user27" bkimagealign="right" bkimageid="icon_grid_edit" col="18" colid="REQKIND_CHK" display="checkbox" edit="checkbox" text="Y"/>
						<cell align="center" col="19" colid="CGBNNM" display="text"/>
						<cell align="right" col="20" colid="WEBAZ" display="text"/>
						<cell bkcolor="user0" col="21" colid="UCOST" display="currency"/>
						<cell align="center" bkcolor="user0" col="22" colid="FLAG" display="text"/>
						<cell bkcolor="user0" col="23" colid="REQKIND" display="text"/>
						<cell bkcolor="user0" col="24" colid="AMOUNT" display="number"/>
					</body>
					<summary>
						<cell col="0" display="text"/>
						<cell align="center" col="1" display="text"/>
						<cell col="2" display="text"/>
						<cell col="3" display="text"/>
						<cell col="4" display="text"/>
						<cell col="5" display="text"/>
						<cell col="6" display="text"/>
						<cell col="7" display="text"/>
						<cell col="8" display="text"/>
						<cell align="center" col="9" display="text" text="소계"/>
						<cell align="right" bkcolor="user25" col="10" display="currency" expr='sum(&quot;NETWR&quot;)'/>
						<cell align="right" bkcolor="user25" col="11" display="number" expr='sum(&quot;MAN&quot;)'/>
						<cell align="right" bkcolor="user25" col="12" display="number" expr='sum(&quot;JOBHOUR&quot;)'/>
						<cell align="right" bkcolor="user25" col="13" display="number" expr='sum(&quot;OFRHOUR&quot;)'/>
						<cell align="right" bkcolor="user25" col="14" display="currency" expr='sum(&quot;LCOSTS&quot;)'/>
						<cell align="right" bkcolor="user25" col="15" display="currency" expr='sum(&quot;LCOSTC&quot;)'/>
						<cell col="16" display="text"/>
						<cell col="17" display="text"/>
						<cell col="18" display="text"/>
						<cell col="19" display="text"/>
						<cell col="20" display="text"/>
						<cell align="right" bkcolor="user25" col="21" display="currency" expr='sum(&quot;UCOST&quot;)'/>
						<cell col="22" display="text"/>
						<cell col="23" display="text"/>
						<cell col="24" display="text"/>
					</summary>
				</format>
			</contents>
		</Grid>
		<Static Align="Center" BKColor="user13" Height="219" Id="st_new_office_01" Style="sty_lb_form_basic" TabOrder="236" Text="원가정보&#32;&#32;&#32;&#32;&#32;&#32;(상&#32;&#32;&#32;&#32;세)" Top="335" VAlign="Middle" Width="69" WordWrap="TRUE"></Static>
		<Shape BKColor="user12" Bottom="789" Height="48" Id="Shape4" Left="73" LineColor="user13" Right="950" TabOrder="283" Top="741" Type="Rectangle" Width="877"></Shape>
		<Shape BKColor="user12" Bottom="764" Height="23" Id="Shape24" Left="819" LineColor="user13" Right="950" TabOrder="304" Top="741" Type="Rectangle" Width="131"></Shape>
		<Shape BKColor="user12" Bottom="786" Height="23" Id="Shape19" Left="819" LineColor="user13" Right="950" TabOrder="303" Top="763" Type="Rectangle" Width="131"></Shape>
		<Shape BKColor="user12" Bottom="786" Height="23" Id="Shape13" Left="527" LineColor="user13" Right="658" TabOrder="296" Top="763" Type="Rectangle" Width="131"></Shape>
		<Shape BKColor="user12" Bottom="764" Height="23" Id="Shape14" Left="527" LineColor="user13" Right="658" TabOrder="295" Top="741" Type="Rectangle" Width="131"></Shape>
		<Shape BKColor="user12" Bottom="786" Height="23" Id="Shape22" Left="235" LineColor="user13" Right="366" TabOrder="288" Top="763" Type="Rectangle" Width="131"></Shape>
		<Shape BKColor="user12" Bottom="764" Height="23" Id="Shape11" Left="235" LineColor="user13" Right="366" TabOrder="287" Top="741" Type="Rectangle" Width="131"></Shape>
		<Shape BKColor="user12" Bottom="764" Height="23" Id="Shape9" Left="155" LineColor="user13" Right="236" TabOrder="286" Top="741" Type="Rectangle" Width="81"></Shape>
		<Shape BKColor="user12" Bottom="742" Height="24" Id="Shape3" Left="73" LineColor="user13" Right="950" TabOrder="281" Top="718" Type="Rectangle" Width="877"></Shape>
		<Shape BKColor="user23" Bottom="345" Height="10" Id="st_adm27" Left="384" LineColor="user13" Right="973" TabOrder="249" Top="335" Type="Rectangle" Width="589"></Shape>
		<Shape BKColor="user23" Bottom="352" Height="8" Id="st_adm28" Left="384" LineColor="user13" Right="973" TabOrder="250" Top="344" Type="Rectangle" Width="589"></Shape>
		<Shape BKColor="user12" Bottom="330" Height="24" Id="Shape37" Left="73" LineColor="user13" Right="995" TabOrder="233" Top="306" Type="Rectangle" Width="922"></Shape>
		<Shape BKColor="user12" Bottom="327" Height="23" Id="Shape26" Left="239" LineColor="user13" Right="319" TabOrder="235" Top="304" Type="Rectangle" Width="80"></Shape>
		<Shape BKColor="user12" Bottom="330" Height="24" Id="Shape38" Left="239" LineColor="user13" Right="319" TabOrder="234" Top="306" Type="Rectangle" Width="80"></Shape>
		<Shape BKColor="user12" Bottom="284" Height="24" Id="Shape8" Left="73" LineColor="user13" Right="995" TabOrder="231" Top="260" Type="Rectangle" Width="922"></Shape>
		<Shape BKColor="user12" Bottom="307" Height="24" Id="Shape7" Left="73" LineColor="user13" Right="995" TabOrder="232" Top="283" Type="Rectangle" Width="922"></Shape>
		<Shape BKColor="user12" Bottom="254" Height="24" Id="Shape36" Left="73" LineColor="user13" Right="995" TabOrder="228" Top="230" Type="Rectangle" Width="922"></Shape>
		<Shape BKColor="user12" Bottom="205" Height="24" Id="Shape35" Left="73" LineColor="user13" Right="995" TabOrder="227" Top="181" Type="Rectangle" Width="922"></Shape>
		<Shape BKColor="user12" Bottom="182" Height="24" Id="Shape34" Left="73" LineColor="user13" Right="995" TabOrder="226" Top="158" Type="Rectangle" Width="922"></Shape>
		<Shape BKColor="user12" Bottom="159" Height="24" Id="Shape33" Left="73" LineColor="user13" Right="995" TabOrder="225" Top="135" Type="Rectangle" Width="922"></Shape>
		<Shape BKColor="user12" Bottom="129" Height="24" Id="Shape32" Left="73" LineColor="user13" Right="995" TabOrder="221" Top="105" Type="Rectangle" Width="922"></Shape>
		<Shape BKColor="user12" Bottom="106" Height="24" Id="Shape31" Left="73" LineColor="user13" Right="995" TabOrder="220" Top="82" Type="Rectangle" Width="922"></Shape>
		<Shape BKColor="user12" Bottom="656" Height="24" Id="Shape6" Left="1336" LineColor="user13" Right="1433" TabOrder="42" Top="632" Type="Rectangle" Width="97"></Shape>
		<Shape BKColor="user12" Bottom="808" Height="23" Id="Shape25" Left="73" LineColor="user13" Right="165" TabOrder="181" Top="785" Type="Rectangle" Width="92"></Shape>
		<Static Align="Center" Height="21" Id="Static53" Left="74" Style="sty_lb_form_basic" TabOrder="43" Text="특기사항(100자)" Top="786" VAlign="Middle" Width="90"></Static>
		<Shape BKColor="user12" Bottom="330" Height="24" Id="Shape5" Left="318" LineColor="user13" Right="398" TabOrder="146" Top="306" Type="Rectangle" Width="80"></Shape>
		<Shape BKColor="user12" Bottom="330" Height="24" Id="Shape10" Left="397" LineColor="user13" Right="477" TabOrder="148" Top="306" Type="Rectangle" Width="80"></Shape>
		<Checkbox BindDataset="ds_out_master" Column="FAILYN" FalseValue="N" Height="13" Id="chk_fail" Left="872" OnClick="chk_fail_OnClick" TabOrder="115" Text="실패현장청구" Top="164" TrueValue="Y" Value="FALSE" Width="92"></Checkbox>
		<Div Height="29" Id="div_btn" TabOrder="1" Text="Div0" ToolTipFont="Default,0" Url="WB01::CommBtnForm.xml" Width="1004">
			<Contents></Contents>
		</Div>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="19" Id="btn_print_ofr" ImageID="btn_sub_05" Left="149" LeftMargin="12" OnClick="btn_print_ofr_OnClick" Style="sty_btn" TabOrder="3" Text="견적서출력" Top="208" Transparent="TRUE" Width="85"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="19" Id="btn_print_req" ImageID="btn_sub_07" Left="236" LeftMargin="12" OnClick="btn_print_req_OnClick" Style="sty_btn" TabOrder="4" Text="부품요청서출력" Top="208" Transparent="TRUE" Width="107"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="bt_hogiInput" ImageID="btn_sub_05" Left="912" LeftMargin="12" OnClick="bt_hogiInput_OnClick" Style="sty_btn" TabOrder="5" Text="호기별견적" Top="560" Transparent="TRUE" Width="85"></Button>
		<Shape BKColor="user12" Bottom="54" Height="24" Id="Shape0" Left="73" LineColor="user13" Right="995" TabOrder="6" Top="30" Type="Rectangle" Width="922"></Shape>
		<Static Align="Center" Height="22" Id="Static5" Left="74" Style="sty_lb_form_basic" TabOrder="7" Text="Proj.&#32;No" Top="83" VAlign="Middle" Width="71"></Static>
		<Edit Align="CENTER" BindDataset="ds_out_master" Border="Flat" Column="MA_PSPID" Enable="FALSE" Height="20" Id="ed_pjt" Left="147" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="8" Top="84" Width="94"></Edit>
		<Static Align="Center" Height="22" Id="Static1" Left="521" Style="sty_lb_form_basic" TabOrder="9" Text="견적번호" Top="136" VAlign="Middle" Width="71"></Static>
		<Edit Align="CENTER" BindDataset="ds_out_master" Border="Flat" Column="QTNUM" Enable="FALSE" Height="20" Id="ed_qtnum" Left="594" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="10" Top="137" Width="88"></Edit>
		<Static Align="Center" Height="22" Id="Static2" Left="683" Style="sty_lb_form_basic" TabOrder="11" Text="차수" Top="136" VAlign="Middle" Width="31"></Static>
		<Edit Align="CENTER" BindDataset="ds_out_master" Border="Flat" Column="SEQ" Enable="FALSE" Height="20" Id="ed_seq" Left="1376" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="12" Width="36"></Edit>
		<Static Align="Center" Height="22" Id="Static4" Left="367" Style="sty_lb_form_basic" TabOrder="13" Text="결재상태" Top="31" VAlign="Middle" Width="71"></Static>
		<Edit Align="CENTER" Border="Flat" Enable="FALSE" Height="20" Id="ed_wf_stat" Left="440" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="14" Top="32" Width="101"></Edit>
		<Edit Align="CENTER" Border="Flat" Height="20" Id="ed_reg" Left="147" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="15" Text="(전결규정)" Top="32" Width="80"></Edit>
		<Edit BindDataset="ds_out_master" Border="Flat" Column="SPT" Enable="FALSE" Height="20" Id="ed_spt" Left="440" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="16" Top="84" Width="187"></Edit>
		<Edit Align="CENTER" BindDataset="ds_out_master" Border="Flat" Column="KUNNR" Enable="FALSE" Height="20" Id="ed_cus" Left="917" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="17" Top="84" Width="76"></Edit>
		<Edit BindDataset="ds_out_master" Border="Flat" Column="CSTNM" Enable="FALSE" Height="20" Id="ed_cstnm" Left="756" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="18" Text="(지급인명)" Top="84" Width="160"></Edit>
		<Static Align="Center" Height="22" Id="Static6" Left="74" Style="sty_lb_form_basic" TabOrder="19" Text="제품군" Top="106" VAlign="Middle" Width="71"></Static>
		<Static Align="Center" Height="21" Id="Static7" Left="367" Style="sty_lb_form_basic" TabOrder="20" Text="지사명" Top="106" VAlign="Middle" Width="71"></Static>
		<Edit Align="CENTER" BindDataset="ds_out_master" Border="Flat" Column="VKGRPNM" Enable="FALSE" Height="20" Id="ed_vkgrpnm" Left="440" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="21" Top="107" Width="138"></Edit>
		<Static Align="Center" Height="22" Id="Static8" Left="683" Style="sty_lb_form_basic" TabOrder="22" Text="업체명" Top="106" VAlign="Middle" Width="71"></Static>
		<Edit Align="CENTER" BindDataset="ds_out_master" Border="Flat" Column="BSUNM" Enable="FALSE" Height="20" Id="ed_bsunm" Left="756" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="23" Top="107" Width="143"></Edit>
		<Static Align="Center" Height="22" Id="Static9" Left="367" Style="sty_lb_form_basic" TabOrder="24" Text="견적작성자" Top="136" VAlign="Middle" Width="71"></Static>
		<Edit Align="CENTER" BindDataset="ds_out_master" Border="Flat" Column="CRNAME" Enable="FALSE" Height="20" Id="ed_pname" Left="440" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="25" Top="137" Width="78"></Edit>
		<Static Align="Center" Height="22" Id="Static11" Left="74" Style="sty_lb_form_basic" TabOrder="26" Text="견적구분" Top="159" VAlign="Middle" Width="71"></Static>
		<Calendar BindDataset="ds_out_master" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="SODAT" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="19" Id="cal_sodat" Left="440" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="28" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="160" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="101"></Calendar>
		<Static Align="Center" Height="22" Id="Static13" Left="688" Style="sty_lb_form_basic" TabOrder="29" Text="출고요청일" Top="160" VAlign="Middle" Width="71"></Static>
		<Calendar BindDataset="ds_out_master" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="SHDAT" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_shdat" Left="756" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="30" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="160" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="100"></Calendar>
		<Checkbox BindDataset="ds_out_master" Column="PGBN" Height="13" Id="chk_pgubn" Left="272" TabOrder="31" Text="이동계획생성" Top="164" Width="92"></Checkbox>
		<Static Align="Center" Height="24" Id="Static25" Left="1400" Style="sty_lb_form_basic" TabOrder="32" Text="표준금액" Top="264" VAlign="Middle" Width="95"></Static>
		<Checkbox BindDataset="ds_out_master" Column="NIGHT_WGT" FalseValue="1" Height="15" Id="chk_night" Left="767" OnClick="chk_night_OnClick" TabOrder="68" Text="야간작업" Top="234" TrueValue="1.5" Value="FALSE" Width="76"></Checkbox>
		<Checkbox BindDataset="ds_out_master" Column="WEEKEND_WGT" FalseValue="1" Height="15" Id="chk_weekend" Left="870" OnClick="chk_weekend_OnClick" TabOrder="70" Text="휴일철야작업" Top="235" TrueValue="2" Value="FALSE" Width="89"></Checkbox>
		<Static Height="13" Id="Static28" Left="286" TabOrder="33" Text="%" Top="314" Width="10"></Static>
		<Static Align="Center" Border="Flat" BorderColor="user13" Height="40" Id="st_adm1" Left="1032" Style="sty_lb_form_basic" TabOrder="34" Text="구분" Top="489" VAlign="Middle" Width="67"></Static>
		<Static Align="Center" Height="22" Id="Static43" Left="501" Style="sty_lb_form_basic" TabOrder="36" Text="계산서&#32;구분" Top="719" VAlign="Middle" Width="81"></Static>
		<Static Align="Center" Height="22" Id="Static44" Left="686" Style="sty_lb_form_basic" TabOrder="37" Text="발송구분" Top="719" VAlign="Middle" Width="81"></Static>
		<Static Align="Center" Height="22" Id="Static45" Left="74" Style="sty_lb_form_basic" TabOrder="38" Text="세금구분" Top="719" VAlign="Middle" Width="81"></Static>
		<Static Align="Center" Height="22" Id="Static46" Left="267" Style="sty_lb_form_basic" TabOrder="39" Text="수금조건" Top="719" VAlign="Middle" Width="81"></Static>
		<Shape BKColor="user12" Bottom="786" Height="45" Id="Shape16" Left="73" LineColor="user13" Right="156" TabOrder="40" Top="741" Type="Rectangle" Width="83"></Shape>
		<Shape BKColor="user12" Bottom="786" Height="23" Id="Shape17" Left="155" LineColor="user13" Right="236" TabOrder="41" Top="763" Type="Rectangle" Width="81"></Shape>
		<Checkbox BindDataset="ds_out_master" Column="BGUBN" Height="19" Id="chk_spbill" Left="863" OnClick="chk_spbill_OnClick" TabOrder="44" Text="분할&#32;발행" Top="719" Value="FALSE" Width="71"></Checkbox>
		<Combo BindDataset="ds_out_master" Border="Flat" CodeColumn="CODE" Column="CS001_GBN" DataColumn="CODE_NAME" DisableBKColor="user5" Height="19" Id="cb_cs001gbn" InnerDataset="ds_gbn" Left="145" OnChanged="cb_cs001gbn_OnChanged" Style="sty_ipt_form" TabOrder="45" Top="159" Width="125"></Combo>
		<Button Cursor="HAND" Font="Default,9" Height="16" Id="btn_pjt" ImageID="btn_icon_search" Left="248" OnClick="btn_pjt_OnClick" TabOrder="46" Text="Button0" Top="88" Width="18"></Button>
		<Edit BindDataset="ds_out_master" Border="Flat" Column="QTNAM" Height="20" Id="ed_qtnam" Left="146" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="47" Top="137" Width="211"></Edit>
		<Static Align="Center" Height="22" Id="Static24" Left="74" Style="sty_lb_form_basic" TabOrder="48" Text="견적&#32;명" Top="136" VAlign="Middle" Width="71"></Static>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="bt_addMaterial" ImageID="btn_sub_05" Left="738" LeftMargin="12" OnClick="bt_addMaterial_OnClick" Style="sty_btn" TabOrder="49" Text="자재추가" Top="559" Transparent="TRUE" Width="86"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_upload_con" ImageID="btn_sub_07" Left="1377" LeftMargin="12" OnClick="btn_upload_con_OnClick" Style="sty_btn" TabOrder="50" Text="계약서&#32;Up-Load" Top="49" Transparent="TRUE" Width="107"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="bt_removeMaterial" ImageID="btn_sub_05" Left="825" LeftMargin="12" OnClick="bt_removeMaterial_OnClick" Style="sty_btn" TabOrder="51" Text="자재삭제" Top="559" Transparent="TRUE" Width="86"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="19" Id="btn_save_con" ImageID="btn_sub_04" Left="474" LeftMargin="12" OnClick="btn_save_con_OnClick" Style="sty_btn" TabOrder="52" Text="수주등록" Top="208" Transparent="TRUE" Width="72"></Button>
		<Combo BindDataset="ds_out_master" Border="Flat" CodeColumn="CODE" Column="KVGR1" DataColumn="CODE_NAME" DisableBKColor="user5" Height="20" Id="cb_kvgr1" InnerDataset="ds_kvgr1" Left="582" Style="sty_ipt_form" TabOrder="53" Top="719" Width="103"></Combo>
		<Combo BindDataset="ds_out_master" Border="Flat" CodeColumn="CODE" Column="KVGR2" DataColumn="CODE_NAME" DisableBKColor="user5" Height="20" Id="cb_kvgr2" InnerDataset="ds_kvgr2" Left="767" Style="sty_ipt_form" TabOrder="54" Top="719" Width="92"></Combo>
		<Combo BindDataset="ds_out_master" Border="Flat" CodeColumn="CODE" Column="TAXK1" DataColumn="CODE_NAME" DisableBKColor="user5" Height="20" Id="cb_taxk1" ImeMode="none" InnerDataset="ds_taxk1" Left="155" Style="sty_ipt_form" TabOrder="55" Top="719" Width="111"></Combo>
		<Combo BindDataset="ds_out_master" Border="Flat" CodeColumn="CODE" Column="ZTERM" DataColumn="CODE_NAME" DisableBKColor="user5" Height="20" Id="cb_zterm" ImeMode="none" InnerDataset="ds_zterm" Left="349" Style="sty_ipt_form_ind" TabOrder="56" Top="719" Width="151"></Combo>
		<Calendar BindDataset="ds_out_master" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="BILDAT" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="19" Id="cal_bildat1" Left="237" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="57" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="743" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="125"></Calendar>
		<Calendar BindDataset="ds_out_master" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="BILDAT2" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Enable="FALSE" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="19" Id="cal_bildat2" Left="529" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="58" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="743" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="125"></Calendar>
		<Calendar BindDataset="ds_out_master" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="BILDAT3" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Enable="FALSE" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="19" Id="cal_bildat3" Left="822" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="59" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="743" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="125"></Calendar>
		<MaskEdit BindDataset="ds_out_master" Border="Flat" Column="BILAMT1" Enable="FALSE" Height="19" Id="me_bilamt1" Left="238" Style="sty_ipt_form" TabOrder="60" Top="765" Width="123"></MaskEdit>
		<MaskEdit BindDataset="ds_out_master" Border="Flat" Column="BILAMT2" Enable="FALSE" Height="19" Id="me_bilamt2" Left="529" OnChanged="me_bilamt2_OnChanged" Style="sty_ipt_form" TabOrder="61" Top="765" Width="123"></MaskEdit>
		<MaskEdit BindDataset="ds_out_master" Border="Flat" Column="BILAMT3" Enable="FALSE" Height="19" Id="me_bilamt3" Left="822" OnChanged="me_bilamt3_OnChanged" Style="sty_ipt_form" TabOrder="62" Top="765" Width="123"></MaskEdit>
		<MaskEdit BindDataset="ds_out_master" BKColor="user40" Border="Flat" Column="NETWR_DC" Height="24" Id="ed_netwr_dc" Left="555" OnChanged="ed_netwr_dc_OnChanged" Style="sty_ipt_form" TabOrder="63" Top="283" Width="80"></MaskEdit>
		<MaskEdit Border="Flat" DecimalLen="1" Enable="FALSE" Height="26" Id="ed_netwr_pct" Left="1400" Mask="##.#%" Style="sty_ipt_form" TabOrder="67" TabStop="FALSE" Top="200" Width="49"></MaskEdit>
		<MaskEdit BindDataset="ds_out_master" Border="Flat" Column="NETWR_OFR" DecimalLen="0" Enable="FALSE" Height="24" Id="ed_netwr_ofr" Left="73" Style="sty_ipt_form" TabOrder="69" TabStop="FALSE" Top="283" Width="88"></MaskEdit>
		<MaskEdit BindDataset="ds_out_master" Border="Flat" Column="NETWR_STD" DecimalLen="0" Enable="FALSE" Height="26" Id="ed_netwr_std" Left="1495" Style="sty_ipt_form" TabOrder="71" TabStop="FALSE" Top="263" Width="97"></MaskEdit>
		<MaskEdit BindDataset="ds_out_master" Border="Flat" Column="LCOST_STD" DecimalLen="0" Enable="FALSE" Height="26" Id="ed_lcost_std" Left="1591" Style="sty_ipt_form" TabOrder="73" TabStop="FALSE" Top="263" Width="97"></MaskEdit>
		<MaskEdit BindDataset="ds_out_master" Border="Flat" Column="LCOST_OFR" DecimalLen="0" Enable="FALSE" Height="24" Id="ed_lcost_ofr" Left="160" Style="sty_ipt_form" TabOrder="72" TabStop="FALSE" Top="283" Width="80"></MaskEdit>
		<MaskEdit BindDataset="ds_out_master" Border="Flat" Column="EXPENSE1" DecimalLen="0" Enable="FALSE" Height="26" Id="ed_exp_std" Left="1687" Style="sty_ipt_form" TabOrder="75" TabStop="FALSE" Top="263" Width="97"></MaskEdit>
		<MaskEdit BindDataset="ds_out_master" Border="Flat" Column="EXPENSE2" DecimalLen="0" Enable="FALSE" Height="24" Id="ed_exp_ofr" Left="239" Style="sty_ipt_form" TabOrder="74" TabStop="FALSE" Top="283" Width="80"></MaskEdit>
		<MaskEdit BindDataset="ds_out_master" BKColor="user40" Border="Flat" Column="EXP_PCT" Height="19" Id="ed_exp_pct" Left="242" OnChanged="ed_exp_pct_OnChanged" Style="sty_ipt_form" TabOrder="64" Top="308" Width="40"></MaskEdit>
		<MaskEdit BindDataset="ds_out_master" Border="Flat" Column="ADMCOST1" DecimalLen="0" Enable="FALSE" Height="26" Id="ed_mng_std" Left="1783" Style="sty_ipt_form" TabOrder="77" TabStop="FALSE" Top="263" Width="97"></MaskEdit>
		<MaskEdit BindDataset="ds_out_master" Border="Flat" Column="ADMCOST2" DecimalLen="0" Enable="FALSE" Height="24" Id="ed_mng_ofr" Left="318" Style="sty_ipt_form" TabOrder="76" TabStop="FALSE" Top="283" Width="80"></MaskEdit>
		<MaskEdit BindDataset="ds_out_master" BKColor="user40" Border="Flat" Column="MNG_PCT" Height="19" Id="ed_mng_pct" Left="321" OnChanged="ed_mng_pct_OnChanged" Style="sty_ipt_form" TabOrder="65" Top="308" Width="40"></MaskEdit>
		<MaskEdit BindDataset="ds_out_master" BKColor="user40" Border="Flat" Column="PRO_PCT" Height="19" Id="ed_pro_pct" Left="400" OnChanged="ed_pro_pct_OnChanged" Style="sty_ipt_form" TabOrder="66" Top="308" Width="40"></MaskEdit>
		<MaskEdit BindDataset="ds_out_master" Border="Flat" Column="REVENUE1" DecimalLen="0" Enable="FALSE" Height="26" Id="ed_pro_std" Left="1879" Style="sty_ipt_form" TabOrder="79" TabStop="FALSE" Top="263" Width="97"></MaskEdit>
		<MaskEdit BindDataset="ds_out_master" Border="Flat" Column="REVENUE2" DecimalLen="0" Enable="FALSE" Height="24" Id="ed_pro_ofr" Left="397" Style="sty_ipt_form" TabOrder="78" TabStop="FALSE" Top="283" Width="80"></MaskEdit>
		<MaskEdit BindDataset="ds_out_master" Border="Flat" Column="SUM_STD" DecimalLen="0" Enable="FALSE" Height="26" Id="ed_sum_std" Left="1975" Style="sty_ipt_form" TabOrder="81" TabStop="FALSE" Top="263" Width="97"></MaskEdit>
		<MaskEdit BindDataset="ds_out_master" Border="Flat" Column="SUM_OFR" DecimalLen="0" Enable="FALSE" Height="24" Id="ed_sum_ofr" Left="634" Style="sty_ipt_form" TabOrder="80" TabStop="FALSE" Top="283" Width="88"></MaskEdit>
		<MaskEdit Align="Center" BindDataset="ds_out_master" Border="Flat" Column="ID_RATE" DecimalLen="1" DecimalMinLen="1" Enable="FALSE" Height="24" Id="ed_id_rate" Left="721" Mask="##.#%" Style="sty_ipt_form" TabOrder="82" TabStop="FALSE" Top="283" Width="80"></MaskEdit>
		<MaskEdit BindDataset="ds_out_master" Border="Flat" Column="BIL_AMT" Enable="FALSE" Height="26" Id="ed_bil_amt" Left="1032" Style="sty_ipt_form" TabOrder="83" TabStop="FALSE" Top="576" Width="80"></MaskEdit>
		<MaskEdit BindDataset="ds_out_master" Border="Flat" Column="HIS_UCOST" DecimalLen="0" Enable="FALSE" Font="Default,9" Height="23" Id="ed_his_ucost" Left="309" Style="sty_ipt_form" TabOrder="84" TabStop="FALSE" Top="443" Width="86"></MaskEdit>
		<MaskEdit BindDataset="ds_out_master" Border="Flat" Column="HIS_LCOST" DecimalLen="0" Enable="FALSE" Font="Default,9" Height="23" Id="ed_his_lcost" Left="309" Style="sty_ipt_form" TabOrder="85" TabStop="FALSE" Top="465" Width="86"></MaskEdit>
		<MaskEdit BindDataset="ds_out_master" Border="Flat" Column="HIS_LABOR" DecimalLen="0" Enable="FALSE" Font="Default,9" Height="23" Id="ed_his_labor" Left="804" Style="sty_ipt_form" TabOrder="86" TabStop="FALSE" Top="371" Width="85"></MaskEdit>
		<MaskEdit BindDataset="ds_out_master" Border="Flat" Column="HIS_INSPEC" DecimalLen="0" Enable="FALSE" Font="Default,9" Height="23" Id="ed_his_inspec" Left="715" Style="sty_ipt_form" TabOrder="87" TabStop="FALSE" Top="443" Width="86"></MaskEdit>
		<MaskEdit BindDataset="ds_out_master" Border="Flat" Column="HIS_LOG" DecimalLen="0" Enable="FALSE" Font="Default,9" Height="23" Id="ed_his_log" Left="715" Style="sty_ipt_form" TabOrder="88" TabStop="FALSE" Top="465" Width="86"></MaskEdit>
		<MaskEdit BindDataset="ds_out_master" Border="Flat" Column="HIS_DIRSUM" DecimalLen="0" Enable="FALSE" Font="Default,9" Height="23" Id="ed_his_dirsum" Left="720" Style="sty_ipt_form" TabOrder="89" TabStop="FALSE" Top="371" Width="85"></MaskEdit>
		<MaskEdit BindDataset="ds_out_master" Border="Flat" Column="HIS_INDSUM" DecimalLen="0" Enable="FALSE" Font="Default,9" Height="23" Id="ed_his_indsum" Left="888" Style="sty_ipt_form" TabOrder="90" TabStop="FALSE" Top="371" Width="85"></MaskEdit>
		<MaskEdit BindDataset="ds_out_master" Border="Flat" Column="HIS_TOTCOST" DecimalLen="0" Enable="FALSE" Height="23" Id="ed_his_totcost" Left="300" Style="sty_ipt_form" TabOrder="91" TabStop="FALSE" Top="371" Width="85"></MaskEdit>
		<MaskEdit BindDataset="ds_out_master" Border="Flat" Column="HIS_RATE" DecimalLen="1" DecimalMinLen="1" Enable="FALSE" Height="23" Id="ed_his_rate" Left="231" Mask="##.0%" Style="sty_ipt_form" TabOrder="92" TabStop="FALSE" Top="371" Width="70"></MaskEdit>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="19" Id="btn_copy_ofr" ImageID="btn_sub_04" Left="549" LeftMargin="12" OnClick="btn_copy_offer_OnClick" Style="sty_btn" TabOrder="93" Text="견적복사" Top="208" Transparent="TRUE" Width="75"></Button>
		<TextArea BindDataset="ds_out_master" Border="Flat" Column="REMARK" Height="23" Id="ed_remark" Left="164" MaxLength="100" Style="sty_ipt_form" TabOrder="94" Top="785" Width="786"></TextArea>
		<Combo BindDataset="ds_out_master" Border="Flat" CodeColumn="CODE" Column="SEQ" DataColumn="CODE_NAME" DisableBKColor="user5" Height="20" Id="cb_seq" InnerDataset="ds_seq" Left="714" OnChanged="cb_seq_OnChanged" Style="sty_ipt_form" TabOrder="95" Top="136" Width="55"></Combo>
		<Static Align="Center" Border="Flat" BorderColor="user13" Height="26" Id="st_adm2" Left="210" Style="sty_lb_form_basic" TabOrder="96" Text="자재비" Top="1285" VAlign="Middle" Width="78"></Static>
		<Static Align="Center" Border="Flat" BorderColor="user13" Height="26" Id="st_adm3" Left="287" Style="sty_lb_form_basic" TabOrder="97" Text="설치비" Top="1285" VAlign="Middle" Width="71"></Static>
		<Static Align="Center" BKColor="user23" Border="Flat" BorderColor="user13" Height="28" Id="st_adm4" Left="804" Style="sty_lb_form_basic" TabOrder="98" Text="제조간접비" Top="344" VAlign="Middle" Width="85"></Static>
		<Static Align="Center" Border="Flat" BorderColor="user13" Height="26" Id="st_adm5" Left="702" Style="sty_lb_form_basic" TabOrder="99" Text="검사비" Top="1285" VAlign="Middle" Width="70"></Static>
		<Static Align="Center" Border="Flat" BorderColor="user13" Height="26" Id="st_adm6" Left="633" Style="sty_lb_form_basic" TabOrder="100" Text="운반비" Top="1285" VAlign="Middle" Width="70"></Static>
		<Static Align="Center" BKColor="user23" Border="Flat" BorderColor="user13" Height="28" Id="st_adm7" Left="720" Style="sty_lb_form_basic" TabOrder="101" Text="직접비&#32;계" Top="344" VAlign="Middle" Width="85"></Static>
		<Static Align="Center" BKColor="user23" Border="Flat" BorderColor="user13" Height="28" Id="st_adm8" Left="888" Style="sty_lb_form_basic" TabOrder="102" Text="간접비" Top="344" VAlign="Middle" Width="85"></Static>
		<Static Align="Center" Border="Flat" BorderColor="user13" Height="40" Id="st_adm9" Left="1213" Style="sty_lb_form_basic" TabOrder="103" Text="총원가" Top="490" VAlign="Middle" Width="61"></Static>
		<Static Align="Center" Border="Flat" BorderColor="user13" Height="40" Id="st_adm10" Left="1166" Style="sty_lb_form_basic" TabOrder="104" Text="시행율" Top="490" VAlign="Middle" Width="46"></Static>
		<Static Align="Center" Border="Flat" BorderColor="user13" Height="24" Id="Static15" Left="73" Style="sty_lb_form_basic" TabOrder="105" Text="자재판가" Top="260" VAlign="Middle" Width="88"></Static>
		<Static Align="Center" Border="Flat" BorderColor="user13" Height="24" Id="Static16" Left="160" Style="sty_lb_form_basic" TabOrder="106" Text="인건비" Top="260" VAlign="Middle" Width="80"></Static>
		<Static Align="Center" Border="Flat" BorderColor="user13" Height="24" Id="Static17" Left="239" Style="sty_lb_form_basic" TabOrder="107" Text="제경비" Top="260" VAlign="Middle" Width="80"></Static>
		<Static Align="Center" Border="Flat" BorderColor="user13" Height="24" Id="Static18" Left="318" Style="sty_lb_form_basic" TabOrder="108" Text="일반관리비" Top="260" VAlign="Middle" Width="80"></Static>
		<Static Align="Center" Border="Flat" BorderColor="user13" Height="24" Id="Static19" Left="397" Style="sty_lb_form_basic" TabOrder="109" Text="기업이윤" Top="260" VAlign="Middle" Width="80"></Static>
		<Static Align="Center" Border="Flat" BorderColor="user13" Height="24" Id="Static20" Left="634" Style="sty_lb_form_basic" TabOrder="110" Text="견적금액ⓐ-ⓑ" Top="260" VAlign="Middle" Width="88"></Static>
		<Static Align="Center" Border="Flat" BorderColor="user13" Height="24" Id="Static21" Left="721" Style="sty_lb_form_basic" TabOrder="111" Text="증감율" Top="260" VAlign="Middle" Width="80"></Static>
		<Static Align="Center" Border="Flat" BorderColor="user13" Height="24" Id="Static22" Left="683" Style="sty_lb_form_basic" TabOrder="112" Text="특이사항" Top="230" VAlign="Middle" Width="71"></Static>
		<Static Align="Center" Border="Flat" BorderColor="user13" Height="26" Id="st_bil_amt" Left="1032" Style="sty_lb_form_basic" TabOrder="113" Text="외주예상비용" Top="551" VAlign="Middle" Width="80"></Static>
		<Button ButtonStyle="TRUE" Color="blueviolet" Cursor="HAND" Height="20" Id="debug_btn_xfer" ImageID="btn_sub_06" Left="1418" LeftMargin="12" OnClick="debug_btn_xfer_OnClick" Style="sty_btn" TabOrder="114" Text="SAP전송처리" Top="1" Transparent="TRUE" Visible="FALSE" Width="98"></Button>
		<Static Align="Center" Height="22" Id="Static12" Left="367" Style="sty_lb_form_basic" TabOrder="27" Text="수주예정일" Top="159" VAlign="Middle" Width="71"></Static>
		<Static Height="17" Id="Static31" Left="1378" TabOrder="116" Text="(천단위&#32;절사)" Top="83" Width="80"></Static>
		<Combo BindDataset="ds_out_master" Border="Flat" CodeColumn="CODE" Column="SPARTNM" DataColumn="CODE_NAME" DisableBKColor="user5" Height="19" Id="cb_spartnm" InnerDataset="ds_spartnm" Left="146" OnChanged="cb_spartnm_OnChanged" Style="sty_ipt_form" TabOrder="117" Top="106" Width="91"></Combo>
		<Edit Align="CENTER" Border="Flat" Enable="FALSE" Height="24" Id="ed_ing" Left="1376" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="118" Top="104" Width="80"></Edit>
		<Checkbox BindDataset="ds_out_master" Column="BOMYN" FalseValue="N" Height="14" Id="chk_bom" Left="581" OnClick="chk_bom_OnClick" TabOrder="119" Text="BOM청구여부" Top="186" TrueValue="Y" Value="FALSE" Width="94"></Checkbox>
		<Static Font="Default,9,Bold" Height="14" Id="Static23" Left="657" TabOrder="120" Text="※BOM현장인&#32;경우&#32;BOM청구여부에&#32;체크해주시기&#32;바랍니다." Top="-254" Width="376"></Static>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="19" Id="btn_bom" ImageID="btn_sub_04" Left="74" LeftMargin="12" OnClick="btn_bom_OnClick" Style="sty_btn" TabOrder="121" Text="BOM등록" Top="208" Transparent="TRUE" Width="72"></Button>
		<Calendar BindDataset="ds_out_master" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="BOMDATE" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="19" Id="cal_bomdat" Left="779" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="123" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="183" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="100"></Calendar>
		<Static Align="Center" Height="22" Id="Static32" Left="683" Style="sty_lb_form_basic" TabOrder="122" Text="BOM청구예정일" Top="182" VAlign="Middle" Width="94"></Static>
		<Static Align="Center" Border="Flat" BorderColor="user13" Height="23" Id="st_adm14" Left="394" Style="sty_lb_form_basic" TabOrder="124" Text="변경원가" Top="421" VAlign="Middle" Width="86"></Static>
		<MaskEdit BindDataset="ds_out_master" Border="Flat" Column="HIS_UCOST_FN" DecimalLen="0" Enable="FALSE" Font="Default,9" Height="23" Id="ed_his_ucost_fn" Left="394" Style="sty_ipt_form" TabOrder="125" TabStop="FALSE" Top="443" Width="86"></MaskEdit>
		<MaskEdit BindDataset="ds_out_master" Border="Flat" Column="HIS_LCOST_FN" DecimalLen="0" Enable="FALSE" Font="Default,9" Height="23" Id="ed_his_lcost_fn" Left="394" Style="sty_ipt_form" TabOrder="126" TabStop="FALSE" Top="465" Width="86"></MaskEdit>
		<MaskEdit BindDataset="ds_out_master" Border="Flat" Column="HIS_LABOR_FN" DecimalLen="0" Enable="FALSE" Font="Default,9" Height="23" Id="ed_his_labor_fn" Left="804" Style="sty_ipt_form" TabOrder="127" TabStop="FALSE" Top="393" Width="85"></MaskEdit>
		<MaskEdit BindDataset="ds_out_master" Border="Flat" Column="HIS_INSPEC_FN" DecimalLen="0" Enable="FALSE" Font="Default,9" Height="23" Id="ed_his_inspec_fn" Left="800" Style="sty_ipt_form" TabOrder="128" TabStop="FALSE" Top="443" Width="86"></MaskEdit>
		<MaskEdit BindDataset="ds_out_master" Border="Flat" Column="HIS_LOG_FN" DecimalLen="0" Enable="FALSE" Font="Default,9" Height="23" Id="ed_his_log_fn" Left="800" Style="sty_ipt_form" TabOrder="129" TabStop="FALSE" Top="465" Width="86"></MaskEdit>
		<MaskEdit BindDataset="ds_out_master" Border="Flat" Column="HIS_DIRSUM_FN" DecimalLen="0" Enable="FALSE" Font="Default,9" Height="23" Id="ed_his_dirsum_fn" Left="720" Style="sty_ipt_form" TabOrder="130" TabStop="FALSE" Top="393" Width="85"></MaskEdit>
		<MaskEdit BindDataset="ds_out_master" Border="Flat" Column="HIS_INDSUM_FN" DecimalLen="0" Enable="FALSE" Font="Default,9" Height="23" Id="ed_his_indsum_fn" Left="888" Style="sty_ipt_form" TabOrder="131" TabStop="FALSE" Top="393" Width="85"></MaskEdit>
		<MaskEdit BindDataset="ds_out_master" Border="Flat" Column="HIS_TOTCOST_FN" DecimalLen="0" Enable="FALSE" Height="23" Id="ed_his_totcost_fn" Left="300" Style="sty_ipt_form" TabOrder="132" TabStop="FALSE" Top="393" Width="85"></MaskEdit>
		<MaskEdit BindDataset="ds_out_master" Border="Flat" Column="HIS_RATE_FN" DecimalLen="1" DecimalMinLen="1" Enable="FALSE" Height="23" Id="ed_his_rate_fn" Left="231" Mask="##.0%" Style="sty_ipt_form" TabOrder="133" TabStop="FALSE" Top="393" Width="70"></MaskEdit>
		<MaskEdit BindDataset="ds_out_master" Border="Flat" Column="HIS_ETC" DecimalLen="0" Enable="FALSE" Font="Default,9" Height="23" Id="ed_his_etc" Left="715" Style="sty_ipt_form" TabOrder="134" TabStop="FALSE" Top="531" Width="86"></MaskEdit>
		<Static Align="Center" Border="Flat" BorderColor="user13" Height="26" Id="st_adm11" Left="771" Style="sty_lb_form_basic" TabOrder="135" Text="기타경비" Top="1285" VAlign="Middle" Width="70"></Static>
		<MaskEdit BindDataset="ds_out_master" Border="Flat" Column="HIS_ETC_CH" DecimalLen="0" Height="23" Id="ed_his_etc_ch" Left="630" OnChanged="ed_his_etc_ch_OnChanged" Style="sty_ipt_form" TabOrder="136" TabStop="FALSE" Top="531" Width="86"></MaskEdit>
		<MaskEdit BindDataset="ds_out_master" Border="Flat" Column="HIS_ETC_FN" DecimalLen="0" Enable="FALSE" Font="Default,9" Height="23" Id="ed_his_etc_fn" Left="800" Style="sty_ipt_form" TabOrder="137" TabStop="FALSE" Top="531" Width="86"></MaskEdit>
		<Static Align="Center" Border="Flat" BorderColor="user13" Height="26" Id="Static34" Left="1400" Style="sty_lb_form_basic" TabOrder="139" Text="일식외주" Top="369" VAlign="Middle" Width="97"></Static>
		<MaskEdit BindDataset="ds_out_master" Border="Flat" Column="HIS_OEM" DecimalLen="0" Enable="FALSE" Height="28" Id="ed_his_oem" Left="1400" Style="sty_ipt_form" TabOrder="138" TabStop="FALSE" Top="392" Width="97"></MaskEdit>
		<MaskEdit BindDataset="ds_out_master" Border="Flat" Column="HIS_LOG_CH" DecimalLen="0" Height="23" Id="ed_his_log_ch" Left="630" OnChanged="ed_his_etc_ch_OnChanged" Style="sty_ipt_form" TabOrder="140" TabStop="FALSE" Top="465" Width="86"></MaskEdit>
		<MaskEdit BindDataset="ds_out_master" Border="Flat" Column="HIS_INSPEC_CH" DecimalLen="0" Height="23" Id="ed_his_inspec_ch" Left="630" OnChanged="ed_his_etc_ch_OnChanged" Style="sty_ipt_form" TabOrder="141" TabStop="FALSE" Top="443" Width="86"></MaskEdit>
		<MaskEdit BindDataset="ds_out_master" Border="Flat" Column="HIS_LCOST_CH" DecimalLen="0" Height="23" Id="ed_his_lcost_ch" Left="224" OnChanged="ed_his_etc_ch_OnChanged" Style="sty_ipt_form" TabOrder="142" TabStop="FALSE" Top="465" Width="86"></MaskEdit>
		<MaskEdit BindDataset="ds_out_master" Border="Flat" Column="HIS_UCOST_CH" DecimalLen="0" Height="23" Id="ed_his_ucost_ch" Left="224" OnChanged="ed_his_etc_ch_OnChanged" Style="sty_ipt_form" TabOrder="143" TabStop="FALSE" Top="443" Width="86"></MaskEdit>
		<Static Align="Center" Border="Flat" BorderColor="user13" Height="24" Id="Static35" Left="555" Style="sty_lb_form_basic" TabOrder="144" Text="할인금액ⓑ" Top="260" VAlign="Middle" Width="80"></Static>
		<Static Height="13" Id="Static27" Left="365" TabOrder="145" Text="%" Top="314" Width="10"></Static>
		<Static Height="13" Id="Static29" Left="444" TabOrder="147" Text="%" Top="314" Width="10"></Static>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_writeCost" ImageID="btn_sub_05" Left="889" LeftMargin="12" OnClick="btn_writeCost_OnClick" Style="sty_btn" TabOrder="149" Text="추가&#32;입력" Top="443" Transparent="TRUE" Width="90"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_saveCost" ImageID="btn_sub_05" Left="889" LeftMargin="12" OnClick="btn_saveCost_OnClick" Style="sty_btn" TabOrder="150" Text="예산&#32;수정" Top="464" Transparent="TRUE" Width="88"></Button>
		<MaskEdit BindDataset="ds_out_master" Border="Flat" Column="HIS_RATE_FN" DecimalLen="1" DecimalMinLen="1" Enable="FALSE" Height="20" Id="ed_his_rate_fn2" Left="756" Mask="##.0%" Style="sty_ipt_form" TabOrder="151" TabStop="FALSE" Top="32" Width="74"></MaskEdit>
		<Static Align="Center" Border="Flat" BorderColor="user13" Height="26" Id="st_office_2" Left="114" Style="sty_lb_form_basic" TabOrder="152" Text="자재비" Top="1224" VAlign="Middle" Width="80"></Static>
		<Static Align="Center" Border="Flat" BorderColor="user13" Height="26" Id="st_office_3" Left="193" Style="sty_lb_form_basic" TabOrder="153" Text="설치비" Top="1224" VAlign="Middle" Width="80"></Static>
		<Static Align="Center" Border="Flat" BorderColor="user13" Height="26" Id="st_office_4" Left="588" Style="sty_lb_form_basic" TabOrder="154" Text="검사비" Top="1224" VAlign="Middle" Width="80"></Static>
		<Static Align="Center" Border="Flat" BorderColor="user13" Height="26" Id="st_office_5" Left="667" Style="sty_lb_form_basic" TabOrder="155" Text="운반비" Top="1224" VAlign="Middle" Width="80"></Static>
		<Static Align="Center" Border="Flat" BorderColor="user13" Height="26" Id="st_office_6" Left="746" Style="sty_lb_form_basic" TabOrder="156" Text="기타경비" Top="1224" VAlign="Middle" Width="80"></Static>
		<Static Align="Center" Border="Flat" BorderColor="user13" Height="40" Id="st_adm12" Left="1100" Style="sty_lb_form_basic" TabOrder="158" Text="견적금액" Top="490" VAlign="Middle" Width="65"></Static>
		<MaskEdit BindDataset="ds_out_master" Border="Flat" Column="SUM_OFR" DecimalLen="0" Enable="FALSE" Height="23" Id="ed_his_netwr" Left="143" Style="sty_ipt_form" TabOrder="157" TabStop="FALSE" Top="371" Width="89"></MaskEdit>
		<MaskEdit BindDataset="ds_out_master" Border="Flat" Column="SUM_OFR" DecimalLen="0" Enable="FALSE" Height="23" Id="ed_his_netwr_fn" Left="143" Style="sty_ipt_form" TabOrder="159" TabStop="FALSE" Top="393" Width="89"></MaskEdit>
		<Static Align="Center" Border="Flat" BorderColor="user13" Height="23" Id="st_adm13" Left="309" Style="sty_lb_form_basic" TabOrder="160" Text="기본원가" Top="421" VAlign="Middle" Width="86"></Static>
		<Static Align="Center" Border="Flat" BorderColor="user13" Height="51" Id="st_office_1" Left="8" Style="sty_lb_form_basic" TabOrder="161" Text="추가비용란" Top="1224" VAlign="Middle" Width="107"></Static>
		<Static Align="Center" Border="Flat" BorderColor="user13" Height="26" Id="Static41" Left="1496" Style="sty_lb_form_basic" TabOrder="162" Text="자재판매가" Top="232" VAlign="Middle" Width="97"></Static>
		<Static Align="Center" Border="Flat" BorderColor="user13" Height="26" Id="Static42" Left="1592" Style="sty_lb_form_basic" TabOrder="163" Text="인건비" Top="232" VAlign="Middle" Width="97"></Static>
		<Static Align="Center" Border="Flat" BorderColor="user13" Height="26" Id="Static54" Left="1688" Style="sty_lb_form_basic" TabOrder="164" Text="제경비" Top="232" VAlign="Middle" Width="97"></Static>
		<Static Align="Center" Border="Flat" BorderColor="user13" Height="26" Id="Static55" Left="1784" Style="sty_lb_form_basic" TabOrder="165" Text="일반관리비" Top="232" VAlign="Middle" Width="97"></Static>
		<Static Align="Center" Border="Flat" BorderColor="user13" Height="26" Id="Static56" Left="1880" Style="sty_lb_form_basic" TabOrder="166" Text="기업이윤" Top="232" VAlign="Middle" Width="97"></Static>
		<Static Align="Center" Border="Flat" BorderColor="user13" Height="26" Id="Static57" Left="1976" Style="sty_lb_form_basic" TabOrder="167" Text="합계" Top="232" VAlign="Middle" Width="97"></Static>
		<Static Align="Center" Border="Flat" BorderColor="user13" Height="24" Id="Static58" Left="476" Style="sty_lb_form_basic" TabOrder="169" Text="표준판가ⓐ" Top="260" VAlign="Middle" Width="80"></Static>
		<MaskEdit BindDataset="ds_out_master" Border="Flat" Column="SUM_STD" DecimalLen="0" Enable="FALSE" Height="24" Id="MaskEdit3" Left="476" Style="sty_ipt_form" TabOrder="168" TabStop="FALSE" Top="283" Width="80"></MaskEdit>
		<Static Align="Center" Height="22" Id="st_agent" Left="784" Style="sty_lb_form_basic" TabOrder="170" Text="영업주체" Top="136" VAlign="Middle" Width="71"></Static>
		<Combo BindDataset="ds_out_master" Border="Flat" CodeColumn="CODE" Column="AGENT" DataColumn="CODE_NAME" DisableBKColor="user5" Enable="FALSE" Height="20" Id="cb_agent" InnerDataset="ds_agent" Left="856" Style="sty_ipt_form" TabOrder="171" Top="136" Width="119"></Combo>
		<Combo BindDataset="ds_out_master" Border="Flat" CodeColumn="CODE" Column="REQKIND" DataColumn="CODE_NAME" DisableBKColor="user5" Height="19" Id="cb_reqkind" InnerDataset="ds_reqkind_cd" Left="145" OnChanged="cb_reqkind_OnChanged" Style="sty_ipt_form" TabOrder="172" Top="183" Width="103"></Combo>
		<Static Align="Center" Height="22" Id="Static10" Left="74" Style="sty_lb_form_basic" TabOrder="173" Text="청구구분" Top="182" VAlign="Middle" Width="71"></Static>
		<Static Align="Center" Height="22" Id="st_modgbn" Left="358" Style="sty_lb_form_basic" TabOrder="175" Text="Package구분" Top="182" VAlign="Middle" Width="80"></Static>
		<Combo BindDataset="ds_out_master" Border="Flat" CodeColumn="CODE" Column="MODGBN" DataColumn="CODE_NAME" DisableBKColor="user5" Enable="FALSE" Height="19" Id="cb_modgbn" InnerDataset="ds_modgbn" Left="439" OnChanged="cb_modgbn_OnChanged" Style="sty_ipt_form" TabOrder="174" Top="183" Width="136"></Combo>
		<Combo BindDataset="ds_out_master" Border="Flat" CodeColumn="CODE" Column="CYN" DataColumn="CODE_NAME" DisableBKColor="user5" Height="19" Id="cb_cyn" InnerDataset="ds_cyn_cd" Left="147" OnChanged="cb_cyn_OnChanged" Style="sty_ipt_form" TabOrder="177" Top="232" Width="61"></Combo>
		<Combo BindDataset="ds_out_master" Border="Flat" CodeColumn="CODE" Column="CTP" DataColumn="CODE_NAME" DisableBKColor="user5" Enable="FALSE" Height="19" Id="cb_ctp" InnerDataset="ds_ctp_cd" Left="206" Style="sty_ipt_form" TabOrder="178" Top="232" Width="85"></Combo>
		<Combo BindDataset="ds_out_master" Border="Flat" CodeColumn="CODE" Column="CSE" DataColumn="CODE_NAME" DisableBKColor="user5" Height="19" Id="cb_cse" InnerDataset="ds_cst_cd1" Left="439" Style="sty_ipt_form" TabOrder="179" Top="232" Width="140"></Combo>
		<Static Height="21" Id="st_ctp" Left="1432" TabOrder="180" Text="계약서유형" Top="432" Visible="FALSE" Width="78"></Static>
		<Static Align="Center" Height="22" Id="st_cyn" Left="74" Style="sty_lb_form_basic" TabOrder="176" Text="계약서유무&#32;" Top="231" VAlign="Middle" Width="71"></Static>
		<Static Align="Center" Height="22" Id="st_cse" Left="345" Style="sty_lb_form_basic" TabOrder="2" Text="거래선증빙유무" Top="231" VAlign="Middle" Width="93"></Static>
		<Edit BindDataset="ds_out_master" Border="Flat" Column="CST_JUDGE" Enable="FALSE" Height="17" Id="ed_judge" Left="1017" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="182" Text="(지급인명)" Top="85" Width="20"></Edit>
		<MaskEdit BindDataset="ds_out_master" Border="Flat" Column="HIS_MMOD_CH" DecimalLen="0" Height="23" Id="ed_his_mmod_ch" Left="224" OnChanged="ed_his_mmod_ch_OnChanged" Style="sty_ipt_form" TabOrder="183" TabStop="FALSE" Top="509" Width="86"></MaskEdit>
		<MaskEdit BindDataset="ds_out_master" Border="Flat" Column="HIS_LIFT_CH" DecimalLen="0" Height="23" Id="ed_his_lift_ch" Left="224" OnChanged="ed_his_lift_ch_OnChanged" Style="sty_ipt_form" TabOrder="184" TabStop="FALSE" Top="531" Width="86"></MaskEdit>
		<Static Align="Center" Border="Flat" BorderColor="user13" Height="26" Id="st_office_9" Left="351" Style="sty_lb_form_basic" TabOrder="187" Text="양중비" Top="1224" VAlign="Middle" Width="80"></Static>
		<Static Align="Center" Border="Flat" BorderColor="user13" Height="26" Id="st_office_10" Left="430" Style="sty_lb_form_basic" TabOrder="188" Text="무상(MOD)" Top="1224" VAlign="Middle" Width="80"></Static>
		<Static Align="Center" Border="Flat" BorderColor="user13" Height="26" Id="st_office_8" Left="272" Style="sty_lb_form_basic" TabOrder="186" Text="건축부대" Top="1224" VAlign="Middle" Width="80"></Static>
		<MaskEdit BindDataset="ds_out_master" Border="Flat" Column="HIS_BETC_CH" DecimalLen="0" Height="23" Id="ed_his_betc_ch" Left="224" OnChanged="ed_his_betc_ch_OnChanged" Style="sty_ipt_form" TabOrder="185" TabStop="FALSE" Top="487" Width="86"></MaskEdit>
		<Static Align="Center" Border="Flat" BorderColor="user13" Height="26" Id="st_office_11" Left="509" Style="sty_lb_form_basic" TabOrder="190" Text="안전관리비" Top="1224" VAlign="Middle" Width="80"></Static>
		<MaskEdit BindDataset="ds_out_master" Border="Flat" Column="HIS_SAFE_CH" DecimalLen="0" Height="23" Id="ed_his_safe_ch" Left="630" OnChanged="ed_his_safe_ch_OnChanged" Style="sty_ipt_form" TabOrder="189" TabStop="FALSE" Top="487" Width="86"></MaskEdit>
		<Static Align="Center" Border="Flat" BorderColor="user13" Height="26" Id="st_adm15" Left="141" Style="sty_lb_form_basic" TabOrder="192" Text="직접노무비" Top="1285" VAlign="Middle" Width="70"></Static>
		<MaskEdit BindDataset="ds_out_master" Border="Flat" Column="HIS_DLAB" DecimalLen="0" Enable="FALSE" Font="Default,9" Height="26" Id="ed_his_dlab" Left="141" Style="sty_ipt_form" TabOrder="191" TabStop="FALSE" Top="1310" Width="70"></MaskEdit>
		<MaskEdit BindDataset="ds_out_master" Border="Flat" Column="HIS_DLAB_FN" DecimalLen="0" Enable="FALSE" Font="Default,9" Height="26" Id="ed_his_dlab_fn" Left="141" Style="sty_ipt_form" TabOrder="193" TabStop="FALSE" Top="1335" Width="70"></MaskEdit>
		<Static Align="Center" Border="Flat" BorderColor="user13" Height="26" Id="st_adm16" Left="357" Style="sty_lb_form_basic" TabOrder="195" Text="건축부대" Top="1285" VAlign="Middle" Width="70"></Static>
		<MaskEdit BindDataset="ds_out_master" Border="Flat" Column="HIS_BETC" DecimalLen="0" Enable="FALSE" Font="Default,9" Height="23" Id="ed_his_betc" Left="309" Style="sty_ipt_form" TabOrder="194" TabStop="FALSE" Top="487" Width="86"></MaskEdit>
		<MaskEdit BindDataset="ds_out_master" Border="Flat" Column="HIS_BETC_FN" DecimalLen="0" Enable="FALSE" Font="Default,9" Height="23" Id="ed_his_betc_fn" Left="394" Style="sty_ipt_form" TabOrder="196" TabStop="FALSE" Top="487" Width="86"></MaskEdit>
		<Static Align="Center" Border="Flat" BorderColor="user13" Height="26" Id="st_adm17" Left="426" Style="sty_lb_form_basic" TabOrder="198" Text="무상(MOD)" Top="1285" VAlign="Middle" Width="70"></Static>
		<MaskEdit BindDataset="ds_out_master" Border="Flat" Column="HIS_MMOD" DecimalLen="0" Enable="FALSE" Font="Default,9" Height="23" Id="ed_his_mmod" Left="309" Style="sty_ipt_form" TabOrder="197" TabStop="FALSE" Top="509" Width="86"></MaskEdit>
		<MaskEdit BindDataset="ds_out_master" Border="Flat" Column="HIS_MMOD_FN" DecimalLen="0" Enable="FALSE" Font="Default,9" Height="23" Id="ed_his_mmod_fn" Left="394" Style="sty_ipt_form" TabOrder="199" TabStop="FALSE" Top="509" Width="86"></MaskEdit>
		<Static Align="Center" Border="Flat" BorderColor="user13" Height="26" Id="st_adm18" Left="495" Style="sty_lb_form_basic" TabOrder="201" Text="안전관리비" Top="1285" VAlign="Middle" Width="70"></Static>
		<MaskEdit BindDataset="ds_out_master" Border="Flat" Column="HIS_SAFE" DecimalLen="0" Enable="FALSE" Font="Default,9" Height="23" Id="ed_his_safe" Left="715" Style="sty_ipt_form" TabOrder="200" TabStop="FALSE" Top="487" Width="86"></MaskEdit>
		<MaskEdit BindDataset="ds_out_master" Border="Flat" Column="HIS_SAFE_FN" DecimalLen="0" Enable="FALSE" Font="Default,9" Height="23" Id="ed_his_safe_fn" Left="800" Style="sty_ipt_form" TabOrder="202" TabStop="FALSE" Top="487" Width="86"></MaskEdit>
		<Static Align="Center" Border="Flat" BorderColor="user13" Height="26" Id="st_adm19" Left="564" Style="sty_lb_form_basic" TabOrder="204" Text="양중비" Top="1285" VAlign="Middle" Width="70"></Static>
		<MaskEdit BindDataset="ds_out_master" Border="Flat" Column="HIS_LIFT" DecimalLen="0" Enable="FALSE" Font="Default,9" Height="23" Id="ed_his_lift" Left="309" Style="sty_ipt_form" TabOrder="203" TabStop="FALSE" Top="531" Width="86"></MaskEdit>
		<MaskEdit BindDataset="ds_out_master" Border="Flat" Column="HIS_LIFT_FN" DecimalLen="0" Enable="FALSE" Font="Default,9" Height="23" Id="ed_his_lift_fn" Left="394" Style="sty_ipt_form" TabOrder="205" TabStop="FALSE" Top="531" Width="86"></MaskEdit>
		<Static Align="Center" Border="Flat" BorderColor="user13" Height="26" Id="st_adm20" Left="840" Style="sty_lb_form_basic" TabOrder="207" Text="고용산재" Top="1285" VAlign="Middle" Width="70"></Static>
		<MaskEdit BindDataset="ds_out_master" Border="Flat" Column="HIS_EMACID" DecimalLen="0" Enable="FALSE" Font="Default,9" Height="23" Id="ed_his_emacid" Left="715" Style="sty_ipt_form" TabOrder="206" TabStop="FALSE" Top="509" Width="86"></MaskEdit>
		<MaskEdit BindDataset="ds_out_master" Border="Flat" Column="HIS_EMACID_FN" DecimalLen="0" Enable="FALSE" Font="Default,9" Height="23" Id="ed_his_emacid_fn" Left="800" Style="sty_ipt_form" TabOrder="208" TabStop="FALSE" Top="509" Width="86"></MaskEdit>
		<Static Align="Center" BKColor="user13" Height="47" Id="Static14" Style="sty_lb_form_basic" TabOrder="209" Text="결재정보" Top="30" VAlign="Middle" Width="69"></Static>
		<Static Align="Center" Height="22" Id="Static26" Left="74" Style="sty_lb_form_basic" TabOrder="210" Text="전결규정" Top="31" VAlign="Middle" Width="71"></Static>
		<Static Align="Center" Height="22" Id="Static38" Left="683" Style="sty_lb_form_basic" TabOrder="211" Text="시행율" Top="31" VAlign="Middle" Width="71"></Static>
		<Shape BKColor="user12" Bottom="77" Height="24" Id="Shape30" Left="73" LineColor="user13" Right="995" TabOrder="212" Top="53" Type="Rectangle" Width="922"></Shape>
		<Static Align="Center" Height="22" Id="Static30" Left="74" Style="sty_lb_form_basic" TabOrder="213" Text="공사유형" Top="54" VAlign="Middle" Width="71"></Static>
		<Combo BindDataset="ds_out_master" Border="Flat" CodeColumn="CODE" Column="REQKIND" DataColumn="CODE_NAME" DisableBKColor="user5" Enable="FALSE" Height="18" Id="cb_reqkind_2" InnerDataset="ds_reqkind_cd" Left="146" Style="sty_ipt_form" TabOrder="214" Top="55" Width="103"></Combo>
		<Static Align="Center" Height="22" Id="Static33" Left="367" Style="sty_lb_form_basic" TabOrder="215" Text="수주금액" Top="54" VAlign="Middle" Width="71"></Static>
		<MaskEdit BindDataset="ds_out_master" Border="Flat" Column="SUM_OFR" DecimalLen="0" Enable="FALSE" Height="20" Id="ed_sum_ofr_2" Left="440" Style="sty_ipt_form" TabOrder="216" TabStop="FALSE" Top="55" Width="84"></MaskEdit>
		<Static Align="Center" Height="22" Id="Static36" Left="683" Style="sty_lb_form_basic" TabOrder="217" Text="수주율" Top="54" VAlign="Middle" Width="71"></Static>
		<MaskEdit BindDataset="ds_out_master" Border="Flat" Column="NETWRDC_RATE" DecimalLen="1" DecimalMinLen="1" Enable="FALSE" Height="20" Id="MaskEdit0" Left="756" Mask="##.0%" Style="sty_ipt_form" TabOrder="218" TabStop="FALSE" Top="55" Width="74"></MaskEdit>
		<Static Align="Center" BKColor="user13" Height="47" Id="Static37" Style="sty_lb_form_basic" TabOrder="219" Text="현장정보" Top="82" VAlign="Middle" Width="69"></Static>
		<Static Align="Center" Height="22" Id="Static39" Left="367" Style="sty_lb_form_basic" TabOrder="222" Text="현장명" Top="83" VAlign="Middle" Width="71"></Static>
		<Static Align="Center" Height="22" Id="Static40" Left="683" Style="sty_lb_form_basic" TabOrder="223" Text="고객명" Top="83" VAlign="Middle" Width="71"></Static>
		<Static Align="Center" BKColor="user13" Height="119" Id="Static0" Style="sty_lb_form_basic" TabOrder="224" Text="견적정보" Top="135" VAlign="Middle" Width="69"></Static>
		<Static Font="Default,9,Bold" Height="13" Id="Static3" Left="630" TabOrder="229" Text="※BOM현장인&#32;경우&#32;BOM청구여부에&#32;체크해주시기&#32;바랍니다." Top="211" Width="358"></Static>
		<Static Align="Center" BKColor="user13" Height="71" Id="Static59" Style="sty_lb_form_basic" TabOrder="230" Text="견적정보&#32;&#32;&#32;&#32;&#32;&#32;(상&#32;&#32;&#32;&#32;세)" Top="259" VAlign="Middle" Width="69" WordWrap="TRUE"></Static>
		<Static Align="Center" BKColor="user23" Border="Flat" BorderColor="user13" Height="21" Id="st_new_office_06" Left="384" Style="sty_lb_form_basic" TabOrder="237" Text="외주비" Top="351" VAlign="Middle" Width="85"></Static>
		<MaskEdit BindDataset="ds_out_master" Border="Flat" Column="HIS_ORE_SS" DecimalLen="0" Enable="FALSE" Height="23" Id="ed_his_ore_ss" Left="384" Style="sty_ipt_form" TabOrder="238" TabStop="FALSE" Top="371" Width="85"></MaskEdit>
		<MaskEdit BindDataset="ds_out_master" Border="Flat" Column="HIS_ORE_FN_SS" DecimalLen="0" Enable="FALSE" Height="23" Id="ed_his_ore_fn_ss" Left="384" Style="sty_ipt_form" TabOrder="239" TabStop="FALSE" Top="393" Width="85"></MaskEdit>
		<Static Align="Center" BKColor="user23" Border="Flat" BorderColor="user13" Height="21" Id="st_adm22_ss" Left="468" Style="sty_lb_form_basic" TabOrder="240" Text="재료비" Top="351" VAlign="Middle" Width="85"></Static>
		<MaskEdit BindDataset="ds_out_master" Border="Flat" Column="HIS_UCOST_SS" DecimalLen="0" Enable="FALSE" Height="23" Id="ed_his_ucost_ss" Left="468" Style="sty_ipt_form" TabOrder="241" TabStop="FALSE" Top="371" Width="85"></MaskEdit>
		<MaskEdit BindDataset="ds_out_master" Border="Flat" Column="HIS_UCOST_FN_SS" DecimalLen="0" Enable="FALSE" Height="23" Id="ed_his_ucost_fn_ss" Left="468" Style="sty_ipt_form" TabOrder="242" TabStop="FALSE" Top="393" Width="85"></MaskEdit>
		<Static Align="Center" BKColor="user23" Border="Flat" BorderColor="user13" Height="21" Id="st_adm23_ss" Left="552" Style="sty_lb_form_basic" TabOrder="243" Text="노무비" Top="351" VAlign="Middle" Width="85"></Static>
		<MaskEdit BindDataset="ds_out_master" Border="Flat" Column="HIS_LAB_SS" DecimalLen="0" Enable="FALSE" Height="23" Id="ed_his_lab_ss" Left="552" Style="sty_ipt_form" TabOrder="244" TabStop="FALSE" Top="371" Width="85"></MaskEdit>
		<MaskEdit BindDataset="ds_out_master" Border="Flat" Column="HIS_LAB_FN_SS" DecimalLen="0" Enable="FALSE" Height="23" Id="ed_his_lab_fn_ss" Left="552" Style="sty_ipt_form" TabOrder="245" TabStop="FALSE" Top="393" Width="85"></MaskEdit>
		<Static Align="Center" BKColor="user23" Border="Flat" BorderColor="user13" Height="21" Id="st_adm24_ss" Left="636" Style="sty_lb_form_basic" TabOrder="246" Text="경비" Top="351" VAlign="Middle" Width="85"></Static>
		<MaskEdit BindDataset="ds_out_master" Border="Flat" Column="HIS_ETC_SS" DecimalLen="0" Enable="FALSE" Height="23" Id="ed_his_etc_ss" Left="636" Style="sty_ipt_form" TabOrder="247" TabStop="FALSE" Top="371" Width="85"></MaskEdit>
		<MaskEdit BindDataset="ds_out_master" Border="Flat" Column="HIS_ETC_FN_SS" DecimalLen="0" Enable="FALSE" Height="23" Id="ed_his_etc_fn_ss" Left="636" Style="sty_ipt_form" TabOrder="248" TabStop="FALSE" Top="393" Width="85"></MaskEdit>
		<Static Align="Center" Border="Flat" BorderColor="user13" Height="37" Id="st_new_office_02" Left="73" Style="sty_lb_form_basic" TabOrder="251" Text="구분" Top="335" VAlign="Middle" Width="71"></Static>
		<Static Align="Center" Border="Flat" BorderColor="user13" Height="37" Id="st_new_office_03" Left="143" Style="sty_lb_form_basic" TabOrder="255" Text="견적금액" Top="335" VAlign="Middle" Width="89"></Static>
		<Static Align="Center" Border="Flat" BorderColor="user13" Height="37" Id="st_new_office_04" Left="231" Style="sty_lb_form_basic" TabOrder="253" Text="시행율" Top="335" VAlign="Middle" Width="70"></Static>
		<Static Align="Center" Border="Flat" BorderColor="user13" Height="37" Id="st_new_office_05" Left="300" Style="sty_lb_form_basic" TabOrder="252" Text="총원가" Top="335" VAlign="Middle" Width="85"></Static>
		<Static Align="Center" Border="Flat" BorderColor="user13" Height="23" Id="st_new_office_07" Left="73" Style="sty_lb_form_basic" TabOrder="256" Text="기본원가" Top="371" VAlign="Middle" Width="71"></Static>
		<Static Align="Center" Border="Flat" BorderColor="user13" Height="23" Id="st_new_office_08" Left="73" Style="sty_lb_form_basic" TabOrder="254" Text="변경원가" Top="393" VAlign="Middle" Width="71"></Static>
		<Static Align="Center" Border="Flat" BorderColor="user13" Height="23" Id="st_new_office_09" Left="73" Style="sty_lb_form_basic" TabOrder="257" Text="구분" Top="421" VAlign="Middle" Width="71"></Static>
		<Static Align="Center" Border="Flat" BorderColor="user13" Height="23" Id="st_new_office_12" Left="143" Style="sty_lb_form_basic" TabOrder="258" Text="원가상세" Top="421" VAlign="Middle" Width="82"></Static>
		<Static Align="Center" Border="Flat" BorderColor="user13" Height="23" Id="st_new_office_18" Left="224" Style="sty_lb_form_basic" TabOrder="259" Text="추가원가" Top="421" VAlign="Middle" Width="86"></Static>
		<Static Align="Center" Border="Flat" BorderColor="user13" Height="23" Id="st_new_office_19" Left="479" Style="sty_lb_form_basic" TabOrder="260" Text="구분" Top="421" VAlign="Middle" Width="71"></Static>
		<Static Align="Center" Border="Flat" BorderColor="user13" Height="23" Id="st_new_office_21" Left="549" Style="sty_lb_form_basic" TabOrder="261" Text="원가상세" Top="421" VAlign="Middle" Width="82"></Static>
		<Static Align="Center" Border="Flat" BorderColor="user13" Height="23" Id="st_new_office_27" Left="630" Style="sty_lb_form_basic" TabOrder="262" Text="추가원가" Top="421" VAlign="Middle" Width="86"></Static>
		<Static Align="Center" BKColor="MENU" Border="Flat" BorderColor="user13" Height="23" Id="st_new_office_10" Left="73" Style="sty_lb_form_basic" TabOrder="263" Text="재료비" Top="443" VAlign="Middle" Width="71"></Static>
		<Static Align="Center" BKColor="MENU" Border="Flat" BorderColor="user13" Height="23" Id="st_new_office_13" Left="143" Style="sty_lb_form_basic" TabOrder="264" Text="자재비" Top="443" VAlign="Middle" Width="82"></Static>
		<Static Align="Center" BKColor="MENU" Border="Flat" BorderColor="user13" Height="23" Id="st_new_office_14" Left="143" Style="sty_lb_form_basic" TabOrder="265" Text="설치비" Top="465" VAlign="Middle" Width="82"></Static>
		<Static Align="Center" BKColor="MENU" Border="Flat" BorderColor="user13" Height="23" Id="st_new_office_15" Left="143" Style="sty_lb_form_basic" TabOrder="266" Text="건축부대" Top="487" VAlign="Middle" Width="82"></Static>
		<Static Align="Center" BKColor="MENU" Border="Flat" BorderColor="user13" Height="23" Id="st_new_office_16" Left="143" Style="sty_lb_form_basic" TabOrder="267" Text="무상보수" Top="509" VAlign="Middle" Width="82"></Static>
		<Static Align="Center" BKColor="MENU" Border="Flat" BorderColor="user13" Height="23" Id="st_new_office_17" Left="143" Style="sty_lb_form_basic" TabOrder="268" Text="양중비" Top="531" VAlign="Middle" Width="82"></Static>
		<Static Align="Center" BKColor="MENU" Border="Flat" BorderColor="user13" Height="89" Id="st_new_office_11" Left="73" Style="sty_lb_form_basic" TabOrder="269" Text="외주비" Top="465" VAlign="Middle" Width="71"></Static>
		<Static Align="Center" BKColor="MENU" Border="Flat" BorderColor="user13" Height="23" Id="st_new_office_22" Left="549" Style="sty_lb_form_basic" TabOrder="270" Text="검사비" Top="443" VAlign="Middle" Width="82"></Static>
		<Static Align="Center" BKColor="MENU" Border="Flat" BorderColor="user13" Height="111" Id="st_new_office_20" Left="479" Style="sty_lb_form_basic" TabOrder="275" Text="경비" Top="443" VAlign="Middle" Width="71"></Static>
		<Static Align="Center" BKColor="MENU" Border="Flat" BorderColor="user13" Height="23" Id="st_new_office_23" Left="549" Style="sty_lb_form_basic" TabOrder="271" Text="운반비" Top="465" VAlign="Middle" Width="82"></Static>
		<Static Align="Center" BKColor="MENU" Border="Flat" BorderColor="user13" Height="23" Id="st_new_office_24" Left="549" Style="sty_lb_form_basic" TabOrder="272" Text="안전관리비" Top="487" VAlign="Middle" Width="82"></Static>
		<Static Align="Center" BKColor="MENU" Border="Flat" BorderColor="user13" Height="23" Id="st_new_office_25" Left="549" Style="sty_lb_form_basic" TabOrder="273" Text="고용산재" Top="509" VAlign="Middle" Width="82"></Static>
		<Static Align="Center" BKColor="MENU" Border="Flat" BorderColor="user13" Height="23" Id="st_new_office_26" Left="549" Style="sty_lb_form_basic" TabOrder="274" Text="기타경비" Top="531" VAlign="Middle" Width="82"></Static>
		<Static Align="Center" BKColor="MENU" Border="Flat" BorderColor="user13" Height="23" Id="st_new_office_28" Left="630" Style="sty_lb_form_basic" TabOrder="276" Top="509" VAlign="Middle" Width="86"></Static>
		<Static Align="Center" Border="Flat" BorderColor="user13" Height="23" Id="st_adm25" Left="715" Style="sty_lb_form_basic" TabOrder="278" Text="기본원가" Top="421" VAlign="Middle" Width="86"></Static>
		<Static Align="Center" Border="Flat" BorderColor="user13" Height="23" Id="st_adm26" Left="800" Style="sty_lb_form_basic" TabOrder="277" Text="변경원가" Top="421" VAlign="Middle" Width="86"></Static>
		<Static Align="Center" BKColor="user13" Height="133" Id="Static87" Style="sty_lb_form_basic" TabOrder="279" Text="청구자재" Top="580" VAlign="Middle" Width="69" WordWrap="TRUE"></Static>
		<Static Align="Center" BKColor="user13" Height="93" Id="Static88" Style="sty_lb_form_basic" TabOrder="280" Text="청구조건" Top="716" VAlign="Middle" Width="69" WordWrap="TRUE"></Static>
		<Static Align="Center" Height="43" Id="Static89" Left="74" Style="sty_lb_form_basic" TabOrder="282" Text="계약금" Top="742" VAlign="Middle" Width="81"></Static>
		<Static Align="Center" Height="21" Id="Static90" Left="156" Style="sty_lb_form_basic" TabOrder="284" Text="발행일" Top="742" VAlign="Middle" Width="79"></Static>
		<Static Align="Center" Height="21" Id="Static91" Left="156" Style="sty_lb_form_basic" TabOrder="285" Text="발행금액" Top="764" VAlign="Middle" Width="79"></Static>
		<Shape BKColor="user12" Bottom="789" Height="48" Id="Shape12" Left="365" LineColor="user13" Right="448" TabOrder="289" Top="741" Type="Rectangle" Width="83"></Shape>
		<Static Align="Center" Height="46" Id="Static47" Left="366" Style="sty_lb_form_basic" TabOrder="290" Text="중도금" Top="742" VAlign="Middle" Width="81"></Static>
		<Shape BKColor="user12" Bottom="764" Height="23" Id="Shape15" Left="447" LineColor="user13" Right="528" TabOrder="294" Top="741" Type="Rectangle" Width="81"></Shape>
		<Shape BKColor="user12" Bottom="786" Height="23" Id="Shape23" Left="447" LineColor="user13" Right="528" TabOrder="291" Top="763" Type="Rectangle" Width="81"></Shape>
		<Static Align="Center" Height="21" Id="Static48" Left="448" Style="sty_lb_form_basic" TabOrder="292" Text="발행일" Top="742" VAlign="Middle" Width="79"></Static>
		<Static Align="Center" Height="21" Id="Static92" Left="448" Style="sty_lb_form_basic" TabOrder="293" Text="발행금액" Top="764" VAlign="Middle" Width="79"></Static>
		<Shape BKColor="user12" Bottom="789" Height="48" Id="Shape18" Left="657" LineColor="user13" Right="740" TabOrder="297" Top="741" Type="Rectangle" Width="83"></Shape>
		<Static Align="Center" Height="46" Id="Static49" Left="658" Style="sty_lb_form_basic" TabOrder="298" Text="중도금" Top="742" VAlign="Middle" Width="81"></Static>
		<Shape BKColor="user12" Bottom="764" Height="23" Id="Shape27" Left="739" LineColor="user13" Right="820" TabOrder="302" Top="741" Type="Rectangle" Width="81"></Shape>
		<Shape BKColor="user12" Bottom="786" Height="23" Id="Shape28" Left="739" LineColor="user13" Right="820" TabOrder="299" Top="763" Type="Rectangle" Width="81"></Shape>
		<Static Align="Center" Height="21" Id="Static50" Left="740" Style="sty_lb_form_basic" TabOrder="300" Text="발행일" Top="742" VAlign="Middle" Width="79"></Static>
		<Static Align="Center" Height="21" Id="Static93" Left="740" Style="sty_lb_form_basic" TabOrder="301" Text="발행금액" Top="764" VAlign="Middle" Width="79"></Static>
		<Static Align="Center" Border="Flat" BorderColor="user13" Height="26" Id="Static51" Left="48" Style="sty_lb_form_basic" TabOrder="305" Text="기본원가" Top="1304" VAlign="Middle" Width="86"></Static>
		<Static Align="Center" Border="Flat" BorderColor="user13" Height="26" Id="Static52" Left="48" Style="sty_lb_form_basic" TabOrder="306" Text="변경원가" Top="1336" VAlign="Middle" Width="86"></Static>
		<MaskEdit BindDataset="ds_out_master" Border="Flat" Column="HIS_INDSUM_SS" DecimalLen="0" Enable="FALSE" Height="26" Id="ed_his_indsum_ss" Left="120" Style="sty_ipt_form" TabOrder="307" TabStop="FALSE" Top="1160" Width="85"></MaskEdit>
		<Static Align="Center" BKColor="MENU" Border="Flat" BorderColor="user13" Height="26" Id="Static94" Left="120" Style="sty_lb_form_basic" TabOrder="308" Text="간접비&#32;계" Top="1136" VAlign="Middle" Width="86"></Static>
		<Static Align="Center" Border="Flat" BorderColor="user13" Height="26" Id="Static95" Left="24" Style="sty_lb_form_basic" TabOrder="309" Text="기본원가" Top="1160" VAlign="Middle" Width="86"></Static>
		<Static Align="Center" Border="Flat" BorderColor="user13" Height="26" Id="Static96" Left="24" Style="sty_lb_form_basic" TabOrder="310" Text="변경원가" Top="1184" VAlign="Middle" Width="86"></Static>
		<MaskEdit BindDataset="ds_out_master" Border="Flat" Column="HIS_INDSUM_FN_SS&#32;" DecimalLen="0" Enable="FALSE" Height="26" Id="ed_his_indsum_fn_ss" Left="120" Style="sty_ipt_form" TabOrder="311" TabStop="FALSE" Top="1184" Width="85"></MaskEdit>
		<Static Align="Center" BKColor="MENU" Border="Flat" BorderColor="user13" Height="26" Id="Static97" Left="216" Style="sty_lb_form_basic" TabOrder="313" Text="운반비&#32;계" Top="1136" VAlign="Middle" Width="86"></Static>
		<MaskEdit BindDataset="ds_out_master" Border="Flat" Column="HIS_LOG_SS" DecimalLen="0" Enable="FALSE" Height="26" Id="ed_his_log_ss" Left="216" Style="sty_ipt_form" TabOrder="312" TabStop="FALSE" Top="1160" Width="85"></MaskEdit>
		<MaskEdit BindDataset="ds_out_master" Border="Flat" Column="HIS_LOG_FN_SS" DecimalLen="0" Enable="FALSE" Height="26" Id="ed_his_log_fn_ss" Left="216" Style="sty_ipt_form" TabOrder="314" TabStop="FALSE" Top="1184" Width="85"></MaskEdit>
		<Static Align="Center" BKColor="MENU" Border="Flat" BorderColor="user13" Height="26" Id="Static98" Left="312" Style="sty_lb_form_basic" TabOrder="316" Text="검사비&#32;계" Top="1136" VAlign="Middle" Width="86"></Static>
		<MaskEdit BindDataset="ds_out_master" Border="Flat" Column="HIS_INSPEC_SS&#32;" DecimalLen="0" Enable="FALSE" Height="26" Id="ed_his_inspec_ss" Left="312" Style="sty_ipt_form" TabOrder="315" TabStop="FALSE" Top="1160" Width="85"></MaskEdit>
		<MaskEdit BindDataset="ds_out_master" Border="Flat" Column="HIS_INSPEC_FN_SS" DecimalLen="0" Enable="FALSE" Height="26" Id="ed_his_inspec_fn_ss" Left="312" Style="sty_ipt_form" TabOrder="317" TabStop="FALSE" Top="1184" Width="85"></MaskEdit>
		<Checkbox Height="21" Id="chk_elj" Left="5" OnClick="chk_elj_OnClick" TabOrder="319" Text="자회사" Top="556" Value="FALSE" Width="59"></Checkbox>
		<Checkbox BindDataset="ds_out_master" Column="ILSIC_YN" Enable="FALSE" Height="13" Id="chk_ilsic" Left="271" OnClick="chk_ilsic_OnClick" TabOrder="320" Text="일식외주" Top="188" Value="FALSE" Visible="FALSE" Width="70"></Checkbox>
		<Div BKColor="user27" Border="Flat" Height="253" Id="Div0" Left="70" TabOrder="318" Text="Div0" Top="558" Width="937">
			<Contents>
				<Static Align="Center" Height="22" Id="Static5" Left="2" Style="sty_lb_form_basic" TabOrder="1" Text="Proj.&#32;No" Top="34" VAlign="Middle" Width="71"></Static>
				<Edit Align="CENTER" BindDataset="ds_out_elj" Border="Flat" Column="MA_PSPID" Enable="FALSE" Height="20" Id="ed_pjt_2" Left="75" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="2" Top="35" Width="94"></Edit>
				<Button Cursor="HAND" Font="Default,9" Height="16" Id="btn_pjt_2" ImageID="btn_icon_search" Left="171" OnClick="Div0_btn_pjt_2_OnClick" TabOrder="4" Text="Button0" Top="37" Width="18"></Button>
				<Static Align="Center" Height="22" Id="Static39" Left="199" Style="sty_lb_form_basic" TabOrder="5" Text="현장명" Top="34" VAlign="Middle" Width="71"></Static>
				<Edit BindDataset="ds_out_elj" Border="Flat" Column="SPT" Enable="FALSE" Height="20" Id="ed_spt_2" Left="272" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="3" Top="35" Width="187"></Edit>
				<Static Align="Center" Height="22" Id="Static40" Left="469" Style="sty_lb_form_basic" TabOrder="8" Text="고객명" Top="34" VAlign="Middle" Width="71"></Static>
				<Edit BindDataset="ds_out_elj" Border="Flat" Column="CSTNM" Enable="FALSE" Height="20" Id="ed_cstnm_2" Left="542" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="7" Text="(지급인명)" Top="35" Width="154"></Edit>
				<Edit Align="CENTER" BindDataset="ds_out_elj" Border="Flat" Column="KUNNR" Enable="FALSE" Height="20" Id="ed_cus_2" Left="696" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="6" Top="35" Width="70"></Edit>
				<Static Align="Center" Height="22" Id="Static10" Left="2" Style="sty_lb_form_basic" TabOrder="10" Text="청구구분" Top="56" VAlign="Middle" Width="71"></Static>
				<Combo BindDataset="ds_out_elj" Border="Flat" CodeColumn="CODE" Column="REQKIND" DataColumn="CODE_NAME" DisableBKColor="user5" Height="19" Id="cb_reqkind_2" InnerDataset="ds_reqkind_cd2" Left="73" OnChanged="Div0_cb_reqkind_2_OnChanged" Style="sty_ipt_form" TabOrder="9" Top="57" Width="103"></Combo>
				<MaskEdit BindDataset="ds_out_elj" Border="Flat" Column="PARTAMT" DecimalLen="0" Height="23" Id="ed_partamt" Left="272" OnChanged="Div0_ed_partamt_OnChanged" Style="sty_ipt_form" TabOrder="11" TabStop="FALSE" Top="55" Width="86"></MaskEdit>
				<MaskEdit BindDataset="ds_out_elj" Border="Flat" Column="LABOAMT" DecimalLen="0" Height="23" Id="ed_laboamt" Left="542" OnChanged="Div0_ed_laboamt_OnChanged" Style="sty_ipt_form" TabOrder="12" TabStop="FALSE" Top="55" Width="86"></MaskEdit>
				<Static Align="Center" Height="22" Id="Static0" Left="199" Style="sty_lb_form_basic" TabOrder="13" Text="부&#32;&#32;&#32;품" Top="56" VAlign="Middle" Width="71"></Static>
				<Static Align="Center" Height="22" Id="Static1" Left="469" Style="sty_lb_form_basic" TabOrder="14" Text="인&#32;건&#32;비" Top="56" VAlign="Middle" Width="71"></Static>
				<Shape BKColor="user12" Bottom="685" Height="48" Id="Shape4" Left="81" LineColor="user13" Right="958" TabOrder="37" Top="637" Type="Rectangle" Width="877"></Shape>
				<Shape BKColor="user12" Bottom="660" Height="23" Id="Shape24" Left="827" LineColor="user13" Right="958" TabOrder="58" Top="637" Type="Rectangle" Width="131"></Shape>
				<Shape BKColor="user12" Bottom="682" Height="23" Id="Shape19" Left="827" LineColor="user13" Right="958" TabOrder="57" Top="659" Type="Rectangle" Width="131"></Shape>
				<Shape BKColor="user12" Bottom="682" Height="23" Id="Shape13" Left="535" LineColor="user13" Right="666" TabOrder="50" Top="659" Type="Rectangle" Width="131"></Shape>
				<Shape BKColor="user12" Bottom="660" Height="23" Id="Shape14" Left="535" LineColor="user13" Right="666" TabOrder="49" Top="637" Type="Rectangle" Width="131"></Shape>
				<Shape BKColor="user12" Bottom="682" Height="23" Id="Shape22" Left="243" LineColor="user13" Right="374" TabOrder="42" Top="659" Type="Rectangle" Width="131"></Shape>
				<Shape BKColor="user12" Bottom="660" Height="23" Id="Shape11" Left="243" LineColor="user13" Right="374" TabOrder="41" Top="637" Type="Rectangle" Width="131"></Shape>
				<Shape BKColor="user12" Bottom="660" Height="23" Id="Shape9" Left="163" LineColor="user13" Right="244" TabOrder="40" Top="637" Type="Rectangle" Width="81"></Shape>
				<Shape BKColor="user12" Bottom="638" Height="24" Id="Shape3" Left="81" LineColor="user13" Right="958" TabOrder="35" Top="614" Type="Rectangle" Width="877"></Shape>
				<Shape BKColor="user12" Bottom="704" Height="23" Id="Shape25" Left="81" LineColor="user13" Right="173" TabOrder="34" Top="681" Type="Rectangle" Width="92"></Shape>
				<Static Align="Center" Height="21" Id="Static53" Left="82" Style="sty_lb_form_basic" TabOrder="21" Text="특기사항(100자)" Top="682" VAlign="Middle" Width="90"></Static>
				<Static Align="Center" Height="22" Id="Static43" Left="509" Style="sty_lb_form_basic" TabOrder="15" Text="계산서&#32;구분" Top="615" VAlign="Middle" Width="81"></Static>
				<Static Align="Center" Height="22" Id="Static44" Left="694" Style="sty_lb_form_basic" TabOrder="16" Text="발송구분" Top="615" VAlign="Middle" Width="81"></Static>
				<Static Align="Center" Height="22" Id="Static45" Left="82" Style="sty_lb_form_basic" TabOrder="17" Text="세금구분" Top="615" VAlign="Middle" Width="81"></Static>
				<Static Align="Center" Height="22" Id="Static46" Left="275" Style="sty_lb_form_basic" TabOrder="18" Text="수금조건" Top="615" VAlign="Middle" Width="81"></Static>
				<Shape BKColor="user12" Bottom="682" Height="45" Id="Shape16" Left="81" LineColor="user13" Right="164" TabOrder="19" Top="637" Type="Rectangle" Width="83"></Shape>
				<Shape BKColor="user12" Bottom="682" Height="23" Id="Shape17" Left="163" LineColor="user13" Right="244" TabOrder="20" Top="659" Type="Rectangle" Width="81"></Shape>
				<Checkbox BindDataset="ds_out_master" Column="BGUBN" Height="19" Id="chk_spbill" Left="871" OnClick="chk_spbill_OnClick" TabOrder="22" Text="분할&#32;발행" Top="615" Value="FALSE" Width="71"></Checkbox>
				<Combo BindDataset="ds_out_master" Border="Flat" CodeColumn="CODE" Column="KVGR1" DataColumn="CODE_NAME" DisableBKColor="user5" Height="20" Id="cb_kvgr1" InnerDataset="ds_kvgr1" Left="590" Style="sty_ipt_form" TabOrder="23" Top="615" Width="103"></Combo>
				<Combo BindDataset="ds_out_master" Border="Flat" CodeColumn="CODE" Column="KVGR2" DataColumn="CODE_NAME" DisableBKColor="user5" Height="20" Id="cb_kvgr2" InnerDataset="ds_kvgr2" Left="775" Style="sty_ipt_form" TabOrder="24" Top="615" Width="92"></Combo>
				<Combo BindDataset="ds_out_master" Border="Flat" CodeColumn="CODE" Column="TAXK1" DataColumn="CODE_NAME" DisableBKColor="user5" Height="20" Id="cb_taxk1" InnerDataset="ds_taxk1" Left="163" Style="sty_ipt_form" TabOrder="25" Top="615" Width="111"></Combo>
				<Combo BindDataset="ds_out_master" Border="Flat" CodeColumn="CODE" Column="ZTERM" DataColumn="CODE_NAME" DisableBKColor="user5" Height="20" Id="cb_zterm" ImeMode="none" InnerDataset="ds_zterm" Left="357" Style="sty_ipt_form_ind" TabOrder="26" Top="615" Width="151"></Combo>
				<Calendar BindDataset="ds_out_master" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="BILDAT" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="19" Id="cal_bildat1" Left="245" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="27" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="639" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="125"></Calendar>
				<Calendar BindDataset="ds_out_master" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="BILDAT2" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Enable="FALSE" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="19" Id="cal_bildat2" Left="537" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="28" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="639" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="125"></Calendar>
				<Calendar BindDataset="ds_out_master" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="BILDAT3" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Enable="FALSE" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="19" Id="cal_bildat3" Left="830" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="29" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="639" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="125"></Calendar>
				<MaskEdit BindDataset="ds_out_master" Border="Flat" Column="BILAMT1" Enable="FALSE" Height="19" Id="me_bilamt1" Left="246" Style="sty_ipt_form" TabOrder="30" Top="661" Width="123"></MaskEdit>
				<MaskEdit BindDataset="ds_out_master" Border="Flat" Column="BILAMT2" Enable="FALSE" Height="19" Id="me_bilamt2" Left="536" OnChanged="me_bilamt2_OnChanged" Style="sty_ipt_form" TabOrder="31" Top="664" Width="123"></MaskEdit>
				<MaskEdit BindDataset="ds_out_master" Border="Flat" Column="BILAMT3" Enable="FALSE" Height="19" Id="me_bilamt3" Left="830" OnChanged="me_bilamt3_OnChanged" Style="sty_ipt_form" TabOrder="32" Top="661" Width="123"></MaskEdit>
				<TextArea BindDataset="ds_out_master" Border="Flat" Column="REMARK" Height="23" Id="ed_remark" Left="172" MaxLength="100" Style="sty_ipt_form" TabOrder="33" Top="681" Width="786"></TextArea>
				<Static Align="Center" Height="43" Id="Static89" Left="82" Style="sty_lb_form_basic" TabOrder="36" Text="계약금" Top="638" VAlign="Middle" Width="81"></Static>
				<Static Align="Center" Height="21" Id="Static90" Left="164" Style="sty_lb_form_basic" TabOrder="38" Text="발행일" Top="638" VAlign="Middle" Width="79"></Static>
				<Static Align="Center" Height="21" Id="Static91" Left="164" Style="sty_lb_form_basic" TabOrder="39" Text="발행금액" Top="660" VAlign="Middle" Width="79"></Static>
				<Shape BKColor="user12" Bottom="685" Height="48" Id="Shape12" Left="373" LineColor="user13" Right="456" TabOrder="43" Top="637" Type="Rectangle" Width="83"></Shape>
				<Static Align="Center" Height="46" Id="Static47" Left="374" Style="sty_lb_form_basic" TabOrder="44" Text="중도금" Top="638" VAlign="Middle" Width="81"></Static>
				<Shape BKColor="user12" Bottom="660" Height="23" Id="Shape15" Left="455" LineColor="user13" Right="536" TabOrder="48" Top="637" Type="Rectangle" Width="81"></Shape>
				<Shape BKColor="user12" Bottom="682" Height="23" Id="Shape23" Left="455" LineColor="user13" Right="536" TabOrder="45" Top="659" Type="Rectangle" Width="81"></Shape>
				<Static Align="Center" Height="21" Id="Static48" Left="456" Style="sty_lb_form_basic" TabOrder="46" Text="발행일" Top="638" VAlign="Middle" Width="79"></Static>
				<Static Align="Center" Height="21" Id="Static92" Left="456" Style="sty_lb_form_basic" TabOrder="47" Text="발행금액" Top="660" VAlign="Middle" Width="79"></Static>
				<Shape BKColor="user12" Bottom="685" Height="48" Id="Shape18" Left="665" LineColor="user13" Right="748" TabOrder="51" Top="637" Type="Rectangle" Width="83"></Shape>
				<Static Align="Center" Height="46" Id="Static49" Left="666" Style="sty_lb_form_basic" TabOrder="52" Text="중도금" Top="638" VAlign="Middle" Width="81"></Static>
				<Shape BKColor="user12" Bottom="660" Height="23" Id="Shape27" Left="747" LineColor="user13" Right="828" TabOrder="56" Top="637" Type="Rectangle" Width="81"></Shape>
				<Shape BKColor="user12" Bottom="682" Height="23" Id="Shape28" Left="747" LineColor="user13" Right="828" TabOrder="53" Top="659" Type="Rectangle" Width="81"></Shape>
				<Static Align="Center" Height="21" Id="Static50" Left="748" Style="sty_lb_form_basic" TabOrder="54" Text="발행일" Top="638" VAlign="Middle" Width="79"></Static>
				<Static Align="Center" Height="21" Id="Static93" Left="748" Style="sty_lb_form_basic" TabOrder="55" Text="발행금액" Top="660" VAlign="Middle" Width="79"></Static>
				<Static Align="Center" BKColor="user13" Height="28" Id="Static87" Left="1" Style="sty_lb_form_basic" TabOrder="59" Text="[자회사&#32;수주정보]" Top="2" VAlign="Middle" Width="101" WordWrap="TRUE"></Static>
				<Static Align="Center" BKColor="user13" Height="28" Id="Static2" Left="1" Style="sty_lb_form_basic" TabOrder="60" Text="[자회사&#32;청구조건]" Top="102" VAlign="Middle" Width="101" WordWrap="TRUE"></Static>
				<Shape BKColor="user12" Bottom="204" Height="48" Id="Shape0" Left="1" LineColor="user13" Right="878" TabOrder="83" Top="156" Type="Rectangle" Width="877"></Shape>
				<Shape BKColor="user12" Bottom="179" Height="23" Id="Shape1" Left="747" LineColor="user13" Right="878" TabOrder="104" Top="156" Type="Rectangle" Width="131"></Shape>
				<Shape BKColor="user12" Bottom="201" Height="23" Id="Shape2" Left="747" LineColor="user13" Right="878" TabOrder="103" Top="178" Type="Rectangle" Width="131"></Shape>
				<Shape BKColor="user12" Bottom="201" Height="23" Id="Shape5" Left="455" LineColor="user13" Right="586" TabOrder="96" Top="178" Type="Rectangle" Width="131"></Shape>
				<Shape BKColor="user12" Bottom="179" Height="23" Id="Shape6" Left="455" LineColor="user13" Right="586" TabOrder="95" Top="156" Type="Rectangle" Width="131"></Shape>
				<Shape BKColor="user12" Bottom="201" Height="23" Id="Shape7" Left="163" LineColor="user13" Right="294" TabOrder="88" Top="178" Type="Rectangle" Width="131"></Shape>
				<Shape BKColor="user12" Bottom="179" Height="23" Id="Shape8" Left="163" LineColor="user13" Right="294" TabOrder="87" Top="156" Type="Rectangle" Width="131"></Shape>
				<Shape BKColor="user12" Bottom="179" Height="23" Id="Shape10" Left="83" LineColor="user13" Right="164" TabOrder="86" Top="156" Type="Rectangle" Width="81"></Shape>
				<Shape BKColor="user12" Bottom="157" Height="24" Id="Shape20" Left="1" LineColor="user13" Right="878" TabOrder="81" Top="133" Type="Rectangle" Width="877"></Shape>
				<Shape BKColor="user12" Bottom="223" Height="23" Id="Shape21" Left="1" LineColor="user13" Right="93" TabOrder="80" Top="200" Type="Rectangle" Width="92"></Shape>
				<Static Align="Center" Height="21" Id="Static3" Left="2" Style="sty_lb_form_basic" TabOrder="67" Text="특기사항(100자)" Top="201" VAlign="Middle" Width="90"></Static>
				<Static Align="Center" Height="22" Id="Static4" Left="429" Style="sty_lb_form_basic" TabOrder="61" Text="계산서&#32;구분" Top="134" VAlign="Middle" Width="81"></Static>
				<Static Align="Center" Height="22" Id="Static6" Left="614" Style="sty_lb_form_basic" TabOrder="62" Text="발송구분" Top="134" VAlign="Middle" Width="81"></Static>
				<Static Align="Center" Height="22" Id="Static7" Left="2" Style="sty_lb_form_basic" TabOrder="63" Text="세금구분" Top="134" VAlign="Middle" Width="81"></Static>
				<Static Align="Center" Height="22" Id="Static8" Left="195" Style="sty_lb_form_basic" TabOrder="64" Text="수금조건" Top="134" VAlign="Middle" Width="81"></Static>
				<Shape BKColor="user12" Bottom="201" Height="45" Id="Shape26" Left="1" LineColor="user13" Right="84" TabOrder="65" Top="156" Type="Rectangle" Width="83"></Shape>
				<Shape BKColor="user12" Bottom="201" Height="23" Id="Shape29" Left="83" LineColor="user13" Right="164" TabOrder="66" Top="178" Type="Rectangle" Width="81"></Shape>
				<Checkbox BindDataset="ds_out_elj" Column="BGUBN" Height="19" Id="chk_spbill_2" Left="791" OnClick="Div0_chk_spbill_2_OnClick" TabOrder="68" Text="분할&#32;발행" Top="134" Value="FALSE" Width="71"></Checkbox>
				<Combo BindDataset="ds_out_elj" Border="Flat" CodeColumn="CODE" Column="KVGR1" DataColumn="CODE_NAME" DisableBKColor="user5" Height="20" Id="cb_kvgr1_2" InnerDataset="ds_kvgr1" Left="510" Style="sty_ipt_form" TabOrder="69" Top="134" Width="103"></Combo>
				<Combo BindDataset="ds_out_elj" Border="Flat" CodeColumn="CODE" Column="KVGR2" DataColumn="CODE_NAME" DisableBKColor="user5" Height="20" Id="cb_kvgr2_2" InnerDataset="ds_kvgr2" Left="695" Style="sty_ipt_form" TabOrder="70" Top="134" Width="92"></Combo>
				<Combo BindDataset="ds_out_elj" Border="Flat" CodeColumn="CODE" Column="TAXK1" DataColumn="CODE_NAME" DisableBKColor="user5" Height="20" Id="cb_taxk1_2" InnerDataset="ds_taxk1" Left="83" Style="sty_ipt_form" TabOrder="71" Top="134" Width="111"></Combo>
				<Combo BindDataset="ds_out_elj" Border="Flat" CodeColumn="CODE" Column="ZTERM" DataColumn="CODE_NAME" DisableBKColor="user5" Height="20" Id="cb_zterm_2" ImeMode="none" InnerDataset="ds_zterm" Left="277" Style="sty_ipt_form_ind" TabOrder="72" Top="134" Width="151"></Combo>
				<Calendar BindDataset="ds_out_elj" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="BILDAT" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="19" Id="cal_bildat1_2" Left="165" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="73" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="158" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="125"></Calendar>
				<Calendar BindDataset="ds_out_elj" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="BILDAT2" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Enable="FALSE" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="19" Id="cal_bildat2_2" Left="457" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="74" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="158" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="125"></Calendar>
				<Calendar BindDataset="ds_out_elj" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="BILDAT3" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Enable="FALSE" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="19" Id="cal_bildat3_2" Left="750" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="75" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="158" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="125"></Calendar>
				<MaskEdit BindDataset="ds_out_elj" Border="Flat" Column="BILAMT1" Enable="FALSE" Height="19" Id="me_bilamt1_2" Left="166" Style="sty_ipt_form" TabOrder="76" Top="180" Width="123"></MaskEdit>
				<MaskEdit BindDataset="ds_out_elj" Border="Flat" Column="BILAMT2" Enable="FALSE" Height="19" Id="me_bilamt2_2" Left="457" OnChanged="Div0_me_bilamt2_2_OnChanged" Style="sty_ipt_form" TabOrder="77" Top="180" Width="123"></MaskEdit>
				<MaskEdit BindDataset="ds_out_elj" Border="Flat" Column="BILAMT3" Enable="FALSE" Height="19" Id="me_bilamt3_2" Left="750" OnChanged="Div0_me_bilamt3_2_OnChanged" Style="sty_ipt_form" TabOrder="78" Top="180" Width="123"></MaskEdit>
				<TextArea BindDataset="ds_out_elj" Border="Flat" Column="REMARK" Height="23" Id="ed_remark_2" Left="92" MaxLength="100" Style="sty_ipt_form" TabOrder="79" Top="199" Width="786"></TextArea>
				<Static Align="Center" Height="43" Id="Static9" Left="2" Style="sty_lb_form_basic" TabOrder="82" Text="계약금" Top="157" VAlign="Middle" Width="81"></Static>
				<Static Align="Center" Height="21" Id="Static11" Left="84" Style="sty_lb_form_basic" TabOrder="84" Text="발행일" Top="157" VAlign="Middle" Width="79"></Static>
				<Static Align="Center" Height="21" Id="Static12" Left="84" Style="sty_lb_form_basic" TabOrder="85" Text="발행금액" Top="179" VAlign="Middle" Width="79"></Static>
				<Shape BKColor="user12" Bottom="204" Height="48" Id="Shape30" Left="293" LineColor="user13" Right="376" TabOrder="89" Top="156" Type="Rectangle" Width="83"></Shape>
				<Static Align="Center" Height="46" Id="Static13" Left="294" Style="sty_lb_form_basic" TabOrder="90" Text="중도금" Top="157" VAlign="Middle" Width="81"></Static>
				<Shape BKColor="user12" Bottom="179" Height="23" Id="Shape31" Left="375" LineColor="user13" Right="456" TabOrder="94" Top="156" Type="Rectangle" Width="81"></Shape>
				<Shape BKColor="user12" Bottom="201" Height="23" Id="Shape32" Left="375" LineColor="user13" Right="456" TabOrder="91" Top="178" Type="Rectangle" Width="81"></Shape>
				<Static Align="Center" Height="21" Id="Static14" Left="376" Style="sty_lb_form_basic" TabOrder="92" Text="발행일" Top="157" VAlign="Middle" Width="79"></Static>
				<Static Align="Center" Height="21" Id="Static15" Left="376" Style="sty_lb_form_basic" TabOrder="93" Text="발행금액" Top="179" VAlign="Middle" Width="79"></Static>
				<Shape BKColor="user12" Bottom="204" Height="48" Id="Shape33" Left="585" LineColor="user13" Right="668" TabOrder="97" Top="156" Type="Rectangle" Width="83"></Shape>
				<Static Align="Center" Height="46" Id="Static16" Left="586" Style="sty_lb_form_basic" TabOrder="98" Text="중도금" Top="157" VAlign="Middle" Width="81"></Static>
				<Shape BKColor="user12" Bottom="179" Height="23" Id="Shape34" Left="667" LineColor="user13" Right="748" TabOrder="102" Top="156" Type="Rectangle" Width="81"></Shape>
				<Shape BKColor="user12" Bottom="201" Height="23" Id="Shape35" Left="667" LineColor="user13" Right="748" TabOrder="99" Top="178" Type="Rectangle" Width="81"></Shape>
				<Static Align="Center" Height="21" Id="Static17" Left="668" Style="sty_lb_form_basic" TabOrder="100" Text="발행일" Top="157" VAlign="Middle" Width="79"></Static>
				<Static Align="Center" Height="21" Id="Static18" Left="668" Style="sty_lb_form_basic" TabOrder="101" Text="발행금액" Top="179" VAlign="Middle" Width="79"></Static>
				<Button ButtonStyle="TRUE" Height="23" Id="bt_elj_save" ImageID="btn_sub_05" Left="123" OnClick="Div0_bt_elj_save_OnClick" TabOrder="105" Text="자회사&#32;저장" Top="5" Width="93"></Button>
				<Static Align="Center" Height="22" Id="Static19" Left="695" Style="sty_lb_form_basic" TabOrder="106" Text="WBS(자회사)" Top="56" VAlign="Middle" Width="79"></Static>
				<Edit BindDataset="ds_out_elj" Border="Flat" Column="PS_PSPID" Height="20" Id="ed_pspid" Left="774" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="107" Top="56" Width="131"></Edit>
			</Contents>
		</Div>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="19" Id="btn_discount" ImageID="btn_sub_10" Left="813" LeftMargin="12" OnClick="btn_discount_OnClick" Style="sty_btn" TabOrder="321" Text="고객할인율&#32;적용" Top="285" Transparent="TRUE" Width="144"></Button>
	</Form>
	<Script><![CDATA[/*
 ******************************************************************************************
 * 기      능   : 보수자재 견적 신규작성, 상세확인, 수정, 삭제, 결재 및 열람
 * 작  성  자   : 이종석
 * 작성  일자   : 2014.11 
 * ----------------------------------------------------------------------------------------
 * HISTORY    : 
 ******************************************************************************************
 */
#include "LIB::commons.js";	// 공통 스크립트 
#include "LIB::common_cs.js";	// 서비스 공통 스크립트
#include "LIB::nsfRequest.js";
#include "LIB::common_sd.js";
//=========================================================================================
// [ PART 1 ]
// Form에서 사용될 전역변수를 선언
// FORM에서 사용되는 전역변수는 대문자로 작성하며, F_XXX 의 형태를 갖도록 한다. 
//=========================================================================================

var DEBUG_FLAG 	= true;															//디버그 기능 사용을 위한 플래그를 설정한다.
var componentStore;																//enable 상태인 컴포넌트들의 ID를 저장한다. 
var selfFlag;																	//자기자신의 견적인지의 여부를 세팅한다. setPermissions()에서 세팅
var orgPrintFlag;																//견적서, 부품요청서 출력 버튼이 원래 활성화 되었었는지의 여부
var copyFlag = false;															//견적복사 여부
var shdatFlag = false;															//수주등록 시 납기일체크로직에 걸리는지 확인하기 위해 세팅.
var adminCostFlag = true;														//시행예산 공개 여부 
var cnt = 0;																	//보수자재시 HALB자재 청구불가처리를 위해 세팅.

var pdchang_visible = false;
var vBomCheck = false;
var vWriteCost = false;
var lejchk;
var dcchk;
var netwr_dc = 0;
var dcfix;
//=========================================================================================
// [ PART 2 ]
// Form Loading / Unloading 시 작업 정의
//=========================================================================================
function fn_OnLoadCompleted(obj) {
	gfn_initForm();
	Div0.Visible = false;
	//if(DEBUG_FLAG) SHOW_ENV();
	if(fa_bom == 'Y')	//BOM청구PGM에서 조회시 버튼비활성화	2015.07.08 YAR
	{
		btn_print_ofr.Enable 	= false;	
		btn_print_req.Enable  	= false;	
		btn_copy_ofr.Enable  	= false;
		div_btn.btn_sendback.Enable = false;  	// 반송버튼
	}
	//관리자 이외에는 원가항목을 감춘다. 
	//원가관련 항목은 DataSet이 채워지기 전에 처리해야 하므로, Form의 Loading이 완료된 직후 값이 Assign되기 전에 Hide한다.
	var userGroup = gfn_getUserGroup();											//사용자 권한그룹
	ds_cond.SetColumn(0,"USER_GROUP", userGroup);
	
	
/*	
	//if(userGroup != "40")														//그룹이 40인 경우를 제외하고는 해당 항목을 감춘다.
	//201502120840-원가관련항목은 아무도 볼 수 없도록
	if(G_USER_ID != "1001361" && G_USER_ID != "2017938" && G_USER_ID != "2012804"     // 부문장, 최인식, 김성수담당
	    && G_USER_ID != "3011038" && G_USER_ID != "2020882" && G_USER_ID != "2018209" // 윤경환 이동진 최선경
	    && G_USER_ID != "2021056" && G_USER_ID != "2020971" && G_USER_ID != "2025418" // 전현정 이준석 이세호
	    && G_USER_ID != "2021200" && G_USER_ID != "2023687" 
	    && G_USER_ID != "2018900" && G_USER_ID != "2029758" && G_USER_ID != "2999999"  // 정보기술부	    
	    && G_USER_ID != "2023890" && G_USER_ID != "2022796") // MOD 담당 추가 정현우 임창석				
	{
		adminCostFlag = false; //시행예산 공개 여부 
		ufn_hideUnitCostComponents();
	}	
*/
	//====== 위의 권한 로직 권한테이블 형식으로 변경 ======
	gfn_initDs(ds_rcond, true);
	ds_rcond.SetColumn(0, "ZPROGRAM", "CS0101008B");
	ds_rcond.SetColumn(0, "GBN", "03");	
	pdchang_visible = gfn_getAuth(ds_rcond);
	ds_rcond.ClearData();
	
	if ( pdchang_visible == false) {	
		adminCostFlag = false; //시행예산 공개 여부 
		ufn_hideUnitCostComponents();
	}
	//=====================================================
	//======= 결재 후 BOM 버튼 활성화 권한 ===============
	gfn_initDs(ds_rcond, true);
	ds_rcond.SetColumn(0, "ZPROGRAM", "CS0101008B");
	ds_rcond.SetColumn(0, "GBN", "04");	
	vBomCheck = gfn_getAuth(ds_rcond);
	ds_rcond.ClearData();
	//=====================================================
	//======= 시행율 재계산 버튼 활성화 권한 ===============
	gfn_initDs(ds_rcond, true);
	ds_rcond.SetColumn(0, "ZPROGRAM", "CS0101008B");
	ds_rcond.SetColumn(0, "GBN", "05");	
	vWriteCost = gfn_getAuth(ds_rcond);
	ds_rcond.ClearData();
	//=====================================================
	
	
	
	
	
	// 협력사 직원 외에 시행예산 공개 및 입력 추가 
	if(substr(G_USER_ID,0,1) != "8" && adminCostFlag = false) 
	{
		ufn_showUnitCostComponents();
	}
	// 추가 예산 등록 버튼 
	ufn_setObjectVisibility("btn_writeCost", false);
	ufn_setObjectVisibility("btn_saveCost", false);
	


	//기성 예상 비용은 30번 이상 권한만 열람이 가능하도록 한다.
	if(toNumber(userGroup) < 30)
	{
		ufn_setObjectVisibility("st_bil_amt", false);
		ufn_setObjectVisibility("ed_bil_amt", false);
	}	
	
	//컴포넌트 중 enable 상태인 컴포넌트들을 전역변수에 저장한다.
	ufn_saveEnabledComponents();
	
	if(isExistVar("ar_new", true))												//신규견적일 경우
	{
		ds_out_master.SetColumn(0, "CRNAM", G_USER_ID);							//사용자 ID로 세팅
	}
	else if ( isExistVar("ar_qtnum", true) && isExistVar("ar_upn", true)) 		//이전화면에서 견적번호/차수(기존데이터의 경우 '')/upn/cst가 넘어옴
	{
		if(length(ar_qtnum) < 10 || length(ar_upn) < 1 || length(ar_cst) < 1)
		{
			gfn_showAlert("CW10025", "잘못된 접근입니다.");
			fn_close();		
		}
	
		ds_cond.SetColumn(0, "QTNUM", ar_qtnum);								//견적번호
		ds_cond.SetColumn(0, "SEQ", ar_seq);									//차수
		ds_cond.SetColumn(0, "UPN", ar_upn);									//통합프로젝트번호
		ds_cond.SetColumn(0, "CST", ar_cst);									//거래선

		ds_qtm.SetColumn(0, "QTNUM", ar_qtnum);									//견적번호
		ds_qtm.SetColumn(0, "SEQ", ar_seq);										//차수
	}
	else if( isExistVar("ar_qtnum", true) || isExistVar("ar_seq", true))		//이전화면에서 견적번호 또는 차수만 넘어옴
	{
		gfn_showAlert("CW10025", "견적번호 또는 차수가 올바르지 않습니다.");
		fn_close();
	}
	else
	{
		gfn_showAlert("CW10025", "잘못된 접근입니다.");
		fn_close();
	}
	
	ufn_initParameters();
	
	//==================전현정대리요청 추가20181012==================//
	if (cb_reqkind.Value == "1")
	{
		MaskEdit0.Visible = true;
	}else
	{
		MaskEdit0.Visible = false;
	}
	//===============================================================//
	
	fn_getIndirectRate();
	
	//자회사 인경우  자회사 정보 입력가능토록 버튼 활성화(조회)
	//ufn_eljchk(ds_out_master.GetColumn(0, "KUNNR"));	
	ufn_eljchk(ds_out_master.GetColumn(0, "KUNNR"), ds_out_master.GetColumn(0, "DC_RATE"));
	
	chk_elj.Enable = true;
	
	//==================최선경팀원요청 추가20200813==================//
	if (cb_reqkind.Value == "7") {
		chk_ilsic.Visible = true;
	} else {
		chk_ilsic.Visible = false;
	}

}

/********************************************************************************
* 기      능   : form UnloadCompleted 
********************************************************************************/
function fn_OnUnloadCompleted(obj) {
	return gfn_isFormUnload(obj);
}

//=========================================================================================
// [ PART 3 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,form닫기)
//=========================================================================================

/********************************************************************************
* 기      능   : 시스템일자 기준 간접비 정보 가져오기 ZCST604 
********************************************************************************/
function fn_getIndirectRate() {
	ds_ind.ClearData();
	tit_clearActionInfo();																	
	tit_addSearchActionInfo("wb01:GET_INDIRECT_RATE");									
	tit_callService(		
			""
			, ""							
			, ""							
			, "ds_ind=ds_ind"						
			, "GDATE="+quote(gfn_getCurrDate())					
			, ""							
			, true							
			, false							
			, true); 
}

/********************************************************************************
* 기      능   : Delete 
********************************************************************************/
function fn_delete() {
	if(ds_out_master.GetColumn(0, "QTNUM").length <= 0)
	{
		gfn_showAlert("CW10025", "저장 후 삭제가 가능합니다.");
		return;
	}

	if(!gfn_showConfirm("CI00015", "견적")) 
	{
		return;
		
	}
	//DEBUG("fn_delete", ds_cond.SaveXml());

	tit_clearActionInfo();
	tit_addMultiActionInfo("cs01:CS0101008B_D1"); // ZCST001 
	tit_addMultiActionInfo("cs01:CS0101008B_D2"); // ZCST002
	tit_addMultiActionInfo("cs01:CS0101008B_D5"); // ZCST001R 삭제 추가 20170615
	tit_addSingleActionInfo("cs01:CS0101008B_U7"); // ZCST001 최종 견적 여부
	
	tit_addSingleActionInfo("cs01:CS0101008B_D3");						//이동계획 삭제 (장애로 추가:2020.08.21)
	
	tit_addMultiActionInfo("cs01:CS0101008B_D6"); // ZCST001J  
	
	tit_callService(
		"",
		"",
		"ds_cond=ds_cond ds_qtm=ds_qtm",
		"",
		"",
		"fn_afterDeleteAll");	
}

/********************************************************************************
* 기      능   : Delete Callback
********************************************************************************/
function fn_afterDeleteAll(errCode, errMsg)
{
	if ( errCode!= 0 ) 
	{
		gfn_showMsg("CE00001");
	} 
	else 
	{
		//ufn_updateLastQtnum2();													//최종견적여부를 업데이트한다.
		gfn_showAlert("CI00004");

		parent.ds_list_master.clearData();										//부모창의 마스터 리스트를 클리어한다.
		parent.ds_list_detail.clearData();										//부모창의 디테일 리스트를 클리어한다.	
		
		fn_close();
	}
}

/********************************************************************************
* 기      능   : 저장 
********************************************************************************/
function fn_save() {
	
	var a =0 ;
	var UniFlag = false;
	//자재가 존재하지 않으면 return. 
	if(ds_list.count <= 0)
	{
		gfn_showAlert("CW10025", "견적 자재가 존재하지 않습니다.");
		return;
	}	
	
	//데이터가 존재하지 않는 Row를 삭제한다.
	for(iCnt = ds_list.count - 1;iCnt >= 0;iCnt--)
	{	
		//물류/psd 현대무벡스 분사 작업 2017.08.31
		if(cb_spartnm.Value == "40" && substr(ds_list.GetColumn(iCnt, "HNO"),6,1) == "G")
		{
			//alert(ds_list.GetColumn(iCnt, "HNO"));
			gfn_showAlert("CW00245");
			return;
		}
		//시스템공사 BOM청구인 경우, NC-100 입력 필수 2015.11.23 YAR
		if(chk_bom.Value == "Y" && cb_reqkind.Value == "S") {
			if(ds_list.GetColumn(iCnt, "MATNR") == 'NC-100'){
				a = a + 1;
			}
		}
		if(length(ds_list.GetColumn(iCnt, "MATNR")) == 0)
		{
			ds_list.DeleteRow(iCnt);
		}	
		if(ds_list.GetColumn(iCnt, "REQKIND_CHK") == "1")	ds_list.SetColumn(iCnt, "REQKIND", ds_list.GetColumn(iCnt, "REQKIND"));
		
		if(ds_list.GetColumn(iCnt, "REQKIND") == "")								//자재의 REQKIND가 없을 경우 마스터의 reqkind로 설정한다.
		{
			ds_list.SetColumn(iCnt, "REQKIND", ds_out_master.GetColumn(0, "REQKIND"));
		}
	}

	if (cb_reqkind.Value == "S")
	{
		if(a == 0 && chk_bom.Value == "Y")
		{	
			gfn_showAlert("CW10025", "시스템공사 BOM 청구 건은 NC-100 자재 입력이 필수입니다.");
		}
		if(chk_bom.value <> "Y")
		{
			gfn_showAlert("CW10025", "시스템공사는 BOM청구가 필수입니다.");
		}
		
		if(cb_spartnm.Value == "10" && cb_modgbn.Value == ""){
			gfn_showAlert("CW10025", "시스템공사는 Package 구분값이 필수입니다.");
			return;
		}
	}
	if(chk_bom.Value == "Y")
	{
		if(length(cal_bomdat.Value) == 0)
		{
			gfn_showAlert("CW10025", "BOM 청구예정일자를 입력해주세요.");
			return;
		}
	}
	else
	{
		cal_bomdat.Value = '0000-00-00';
	}

	//======================================협력사 할인율 체크======================================
	if(dcfix != 'Y' && ds_out_master.GetColumn(0, "DC_RATE") > 0 && dcchk == 'Y' )
	{
		gfn_showAlert("CW10025", "해당고객사는 '고객할인율 적용'버튼 필수 클릭.");
		return;
	}
    
	if(toNumber(netwr_dc) > toNumber(ed_netwr_dc.Value) && ds_out_master.GetColumn(0, "DC_RATE") > 0 && dcchk == 'Y')
	{
		var tmp_rate = ds_out_master.GetColumn(0, "DC_RATE") * 100;
		gfn_showAlert("CW10025", "해당고객사는 " + tmp_rate + "% 이상의 할인이 적용되어야 합니다."  );
		return;
	}
	//===============================================================================================


	//입력사항에 문제가 있을 경우 return. 
	if(!ufn_checkInputForSave())
	{
		return;
	}

	var confirmMsg =  "최종 계약확정이 된 경우, 견적결재없이 수주등록이 가능합니다. <br>" +
					 "저장 후 수주등록을 진행하시겠습니까? <br>" +
					 "확인  :  수주등록진행 | 취소  :  견적등록진행";
	if(gfn_showConfirm("CI30001", confirmMsg))
	{
		ds_out_master.SetColumn(0, "DOC1", "R01000201502001");					//더미 DOCNO를 부여하여 견적결재가 완료된 것 처럼 보이게 함
		ds_out_master.SetColumn(0, "DOC1STAT", "6");							//계산서관련항목 체크해야함
		UniFlag = true;
	}
	else
	{
		ds_out_master.SetColumn(0, "DOC1", "");									//단순 저장으로 처리
		ds_out_master.SetColumn(0, "DOC1STAT", "");								//계산서관련항목 체크 Pass
	}
	
	if(UniFlag){
		if(!Check_Suju())	return false;
	}
	//자재별 견적가를 설정한다.
	ufn_setMatAmount();		

	ds_list.fireevent = true;
	
	if (!gfn_showConfirm("CI00010")) return;
	
	//DEBUG("fn_save", ds_out_master.SaveXml());
	//DEBUG("fn_save", ds_list.SaveXml());

	//저장한다....
	ufn_saveData();
}

function ufn_setMatAmount()
{
	var totalAmt; 																	//표준견적금액
	var dcAmt;																		//견적금액
	var totalMatAmt; 																//표준자재견적금액
	var dcMatAmt;																	//자재견적금액	
	var dcPercent;																	//판가할인비율
	var reqKind = ds_out_master.GetColumn(0, "REQKIND");

	totalAmt = toNumber(ds_out_master.GetColumn(0, "SUM_STD"));
	dcAmt = toNumber(ds_out_master.GetColumn(0, "SUM_OFR"));
	totalMatAmt = toNumber(ds_out_master.GetColumn(0, "NETWR_STD"));
	dcMatAmt = toNumber(ds_out_master.GetColumn(0, "NETWR_OFR"));
	dcPercent = dcAmt / totalAmt;													//판가할인비율
	
	//DEBUG("fn_save", "totalAmt is " + totalAmt + ", dcAmt is " + dcAmt + ", dcPercent is " + dcPercent);
	//DEBUG("fn_save", "totalMatAmt is " + totalMatAmt + ", dcMatAmt is " + dcMatAmt);
	
	ds_list.fireevent = false;
	
	var tmpAmt = 0;
	var tmpAmtSum = 0;
	var tmpAmtSum2 = 0;
	var orgAmtSum = 0;
	
	//견적상세데이터에 견적합계금액 및 플랜트를 추가한다.
	for(iCnt=0;iCnt < ds_list.rowcount;iCnt++)
	{
		ds_list.SetColumn(iCnt, "WERKS", ds_out_master.GetColumn(0, "WERKS"));	//플랜트
		
		if(reqKind == "1")														//부품판매일경우
		{
			tmpAmt = ds_list.GetColumn(iCnt, "NETWR") * dcPercent;				//자재별 견적(제안)금액 = 할인비율적용 자재판가
		}
		else																	//수리공사일경우
		{
			tmpAmt = dcAmt * (ds_list.GetColumn(iCnt, "NETWR") / dcMatAmt); 	//자재별 견적(제안)금액 = 견적금액 * (자재별판매가/자재견적총액)
		}
		
		ds_list.SetColumn(iCnt, "AMT", ds_out_master.GetColumn(0, "RATE"));		//임율
		
		ds_list.SetColumn(iCnt, "AMOUNT", round(tmpAmt));
		
		if(ds_list.GetColumn(iCnt, "REQKIND_CHK") == "1")	ds_list.SetColumn(iCnt, "REQKIND", ds_list.GetColumn(iCnt, "REQKIND"));
		else	ds_list.SetColumn(iCnt, "REQKIND", ds_out_master.GetColumn(0, "REQKIND"));

		tmpAmtSum += round(tmpAmt);
		tmpAmtSum2 += tmpAmt;
		orgAmtSum += tmpAmt;
				
		//DEBUG("fn_save", "tmpAmt is " + tmpAmt + ", AMOUNT is " + ds_list.GetColumn(iCnt, "AMOUNT"));
	}
	
	//DEBUG("fn_save", "orgAmtSum is " + orgAmtSum + ", tmpAmtSum is " + tmpAmtSum);
/*
	if(tmpAmtSum < orgAmtSum)													//값을 보정한다. (실수연산에서 버림 되는 값이 있을 수 있으므로)
	{   
		ds_list.SetColumn(ds_list.SetColumn(ds_list.rowcount - 1, "AMOUNT", round(tmpAmt) + 1));
	}
*/
/**********  2015.05.13 LJH 수주생성시 끝전 차이 보정 로직 추가 : 시작  **********/
	var tmpSumOfr = 0;
	var tmpDiff = 0;

	tmpSumOfr = Truncate(ed_sum_ofr.Value);
//alert(" tmpSumOfr ==> " + toNumber(tmpSumOfr) + "\n tmpAmtSum ==> " + toNumber(tmpAmtSum));
	if(toNumber(tmpSumOfr) <> toNumber(tmpAmtSum)) {
		tmpDiff = toNumber(tmpAmtSum) - toNumber(tmpSumOfr);
//alert("tmpDiff ==> " + tmpDiff);
//alert("tmpAmt ==> " + round(tmpAmt));
		ds_list.SetColumn(ds_list.SetColumn(ds_list.rowcount - 1, "AMOUNT", round(tmpAmt) - tmpDiff));
	}
/**********  2015.05.13 LJH 수주생성시 끝전 차이 보정 로직 추가 : 종료  **********/
//alert("AMOUNT ==> " + ds_list.GetColumn(ds_list.rowcount - 1, "AMOUNT"));
//	trace(ed_sum_ofr.Value);
//	trace("tmpAmtSum ==> [" + tmpAmtSum + "]");
//	trace("orgAmtSum ==> [" + orgAmtSum + "]");
//	trace("ds_list.rowcount ==> [" + ds_list.rowcount + "]");
//	trace("ds_list.GetColumn(ds_list.rowcount - 1, 'AMOUNT') ==> [" + ds_list.GetColumn(ds_list.rowcount - 1, 'AMOUNT') + "]");
}

/********************************************************************************
* 기      능   : DB 저장 루틴
********************************************************************************/
function ufn_saveData()
{
	// 저장 처리 
	tit_clearActionInfo();
	//신규견적 - 견적번호가 없을 경우 신규로 생성한다. 
	if (ds_out_master.GetColumn(0, "QTNUM") == "" || length(ds_out_master.GetColumn(0, "QTNUM")) < 10)
	{	
		ds_cond.SetColumn(0, "SEQ", "0");											//차수를 0으로 저장한다.
		tit_addSearchActionInfo("cs01:CS0101008B_T1",true);
		tit_addSearchActionInfo("cs01:CS0101008B_S3",true);
	}
	//기 존재 견적 - 견적번호가 존재하므로 update한다.
	else 
	{
		ds_key.clearData();
		ds_key.AddRow();
		ds_key.SetColumn(0, "QTNUM", ds_out_master.GetColumn(0, "QTNUM"));
		ds_key.SetColumn(0, "SEQ", ds_out_master.GetColumn(0, "SEQ"));

		// ******* BOM 사양 타입 구분 201610  ******  //
		// var tmp_wbs = ds_list.GetColumn(i, "HNO") ;
		// var tmp_typ = substr(tmp_wbs, 6 , 1) ;
		// var typ = "EL"; 
		
		// if(tmp_typ == "L") { typ = "EL"; } 
		// else if(tmp_typ == "S") { typ = "ES"; }
		// else if(tmp_typ == "W") { typ = "MW"; }
		// else if(tmp_typ == "J") { typ = "AP"; }
		
		// ds_key.SetColumn(0, "TYPE", typ );
		// ds_key.SetColumn(0, "BOMDATE", XXX );

		//자재 디테일 정보의 견적번호, SEQ가 비어있을 경우 채운다(이런 경우는 발생하지 않지만, 예전 화면에서 가져온것을 남겨둠)
		for (var i = 0; i < ds_list.rowcount; i++) 
		{
			if (ds_list.GetColumn(i, "FLAG") == "") 
			{
				ds_list.SetColumn(i, "FLAG", "U");
			}
			if (ds_list.GetColumn(i, "QTNUM") == "") 
			{
				ds_list.SetColumn(i, "QTNUM", ds_out_master.GetColumn(0,"QTNUM"));
				ds_list.SetColumn(i, "SEQ", ds_out_master.GetColumn(0,"SEQ"));
		
			}
		}
	}
	//입력된 자재가 내작자재만 있는 경우를 체크(2015.07.02 LJH)
	var tmp_rgbn = "Y";
	
	for(var i=0; i<ds_list.rowcount; i++) {
		if(ds_list.GetColumn(i, "RGBN") == "1") { //보수자재
			tmp_rgbn = "N";
		}
	}
	//자재유형 체크 추가 (2015.12.28 JYW)
	for(var i=0; i<ds_list.rowcount; i++) {
		
		if((ds_list.GetColumn(i,"MATNR") == "NS-100" || ds_list.GetColumn(i,"MATNR") == "ns-100") && 
		    ds_list.GetColumn(i,"MTART") != "Z001")
		{
			gfn_showMsg("CW00114","자재 유형 저장이");
			return;
		}
		if((ds_list.GetColumn(i,"MATNR") == "NB-100" || ds_list.GetColumn(i,"MATNR") == "nb-100") && 
		    ds_list.GetColumn(i,"MTART") != "Z001")
		{
			gfn_showMsg("CW00114","자재 유형 저장이");
			return;
		}
		if((ds_list.GetColumn(i,"MATNR") == "NC-100" || ds_list.GetColumn(i,"MATNR") == "nc-100") && 
		    ds_list.GetColumn(i,"MTART") != "Z001")
		{
			gfn_showMsg("CW00114","자재 유형 저장이");
			return;
		}
		// 20171110 제품군에 따라 호기 정보 체크 이하림 
		if( cb_spartnm.Value == "20" && substr(ds_list.GetColumn(i, "HNO"), 6, 1) <> "J" )
		{
			gfn_showAlert("CW10025", "제품군이 주차인 경우, J호기만 청구 가능합니다.");
			return;
		}		
		
	}
	
	//DEBUG("fn_save", ds_out_master.SaveXml());


	//ZCST001에 마스터 데이터를 저장(업데이트)한다.
	tit_addSaveActionInfo(
         "cs01:CS0101008B_I1",
         "cs01:CS0101008B_U1",
         "",
         "FLAG",
         "",
         0,
         "");

	//ZCST002에 디테일 데이터를 저장(업데이트)한다.
	tit_addSaveActionInfo(
        "cs01:CS0101008B_I2",
        "cs01:CS0101008B_U2",
        "",
        "FLAG",
        "",
        0,
        "");
      
    // 자회사 정보 입력
	if(lejchk == 'Y') {
		tit_addSaveActionInfo( "cs01:CS0101008B_I9",  "cs01:CS0101008B_U10",  "",  "FLAG",   "",   0,   "");    
	}
      
	// ZCST001R  시행예산 관리 
	tit_addSaveActionInfo(
        "cs01:CS0101008B_I8",
        "cs01:CS0101008B_U8",
        "",
        "FLAG",
        "",
        0,
        "");


	//ZMMT124에 BOM청구 데이터를 저장한다.(DELETE 후 INSERT)
	tit_addSingleActionInfo("cs01:CS0101008B_D4");
	if(chk_bom.Value == "Y") {
		if(tmp_rgbn == "N") {
			tit_addSingleActionInfo("cs01:CS0101008B_I6");
		} else {
			tit_addSingleActionInfo("cs01:CS0101008B_I7");
		}
	}
	
	
	//최종견적여부를 업데이트한다.
	tit_addSingleActionInfo("cs01:CS0101008B_U6");
	
//----> 여기서 부터 	ds_out_elj 의 키값을 따로 입력 받아서 해야 할것 같음
	if(lejchk == 'Y') {

//trace(ds_out_elj.SaveXML());
//trace(ds_key.SaveXML());
//alert("b");	
		tit_callService(
			""
			, ""			
			, "ds_out_master=ds_out_master ds_list=ds_list:A ds_cond=ds_cond ds_key=ds_key ds_out_elj=ds_out_elj"        			
			, "ds_key = ds_key"        			
			, ""
			, "fn_afterSave");	
	} 
	else {	
		tit_callService(
			""
			, ""			
			, "ds_out_master=ds_out_master ds_list=ds_list:A ds_cond=ds_cond ds_key=ds_key"        			
			, "ds_key = ds_key"        			
			, ""
			, "fn_afterSave");
    }
        
}
/********************************************************************************
* 기      능   : 저장 Callback  
********************************************************************************/
function fn_afterSave(errCode, errMsg) {
	if ( errCode!= 0 ) {
		gfn_showMsg("CE00001");
	} else {
		gfn_showMsg("CI00003");

		var newFlag = false;													//신규견적여부

		if(length(ds_cond.GetColumn(0,"QTNUM")) > 1)							//기존에 있던 데이터를 저장한 경우
		{
			ed_qtnum.value = ds_cond.GetColumn(0,"QTNUM");
			ed_SEQ.value = ds_cond.GetColumn(0,"SEQ");
		}
		else																	//신규저장일 경우
		{
			ed_qtnum.value = ds_key.GetColumn(0,"QTNUM");
			ds_cond.SetColumn(0, "QTNUM", ds_key.GetColumn(0,"QTNUM"));
			ds_out_master.SetColumn(0, "QTNUM", ds_key.GetColumn(0,"QTNUM"));
			
			ed_seq.value = ds_key.GetColumn(0, "SEQ");
			ds_cond.SetColumn(0, "SEQ", ds_key.GetColumn(0,"SEQ"));
			ds_out_master.SetColumn(0, "SEQ", ds_key.GetColumn(0,"SEQ"));
			
			//=========자회사 관련 추가 =======
			ds_out_elj.SetColumn(0, "QTNUM", ds_key.GetColumn(0,"QTNUM"));
			ds_out_elj.SetColumn(0, "SEQ", ds_key.GetColumn(0,"SEQ"));
			//=================================
			
			newFlag = true;														//신규견적 플래그 세팅
		}


		
		ufn_makeTransferPlan(newFlag);											//이동계획을 저장한다.
		//ufn_updateLastQtnum();													//최종견적여부를 업데이트한다.
		gfn_showAlert("CI00003");

		parent.ds_list_master.clearData();										//부모창의 마스터 리스트를 클리어한다.
		parent.ds_list_detail.clearData();										//부모창의 디테일 리스트를 클리어한다.
		ufn_resetAll();															//모든 정보를 리셋한다.
		ufn_initParameters();													//Parameter를 초기화한다.
	}
}

/********************************************************************************
* 기      능   : 최종견적여부 UPDATE(2015.02.23 LJH 변경처리)
********************************************************************************/
function ufn_updateLastQtnum()
{
	//최종견적여부를 업데이트한다.
	tit_clearActionInfo();
	tit_addSingleActionInfo("cs01:CS0101008B_U6");
	tit_callService(
        ""
        , ""
        , "ds_key=ds_key"
        , ""
        , ""
        , ""
        , false
        , false
        , true);
}

function ufn_updateLastQtnum2()
{
	//최종견적여부를 업데이트한다.
	tit_clearActionInfo();
	tit_addSingleActionInfo("cs01:CS0101008B_U7");
	tit_callService(
        ""
        , ""
        , "ds_qtm=ds_qtm"
        , ""
        , ""
        , ""
        , false
        , false
        , true);
}

/********************************************************************************
* 기      능   : 이동계획 작성/삭제/수정
********************************************************************************/
function ufn_makeTransferPlan(newFlag)
{
	var planExistFlag = false;
	if(!newFlag)																//기존견적이면 해당 견적/차수의 이동계획 존재여부를 확인한다.
	{
		ds_plan_cnt.clearData();
		ds_plan_cnt.AddRow();
	
		tit_clearActionInfo();					
		tit_addSearchActionInfo("cs01:CS0101008B_S14");							//이미 이동계획이 작성되어 있는가?			
		tit_callService("", "", "ds_cond=ds_cond", "ds_plan_cnt=ds_plan_cnt", "", "", true, false, true);	
				
		if(toNumber(ds_plan_cnt.GetColumn(0, "CNT")) > 0) planExistFlag = true;
	}

	//DEBUG("ufn_makeTransferPlan", "newFlag is " + newFlag + "/planExistFlag is " + planExistFlag);

	if(chk_pgubn.Value == "1")													//이동계획 생성여부가 1이면 이동계획을 생성/수정한다.
	{
		ds_plan.ClearData();
		ds_plan.AddRow();
		
		ds_plan.SetColumn(0, "ARA", ds_pjt_det.GetColumn(0, "ARA"));			//지역
		ds_plan.SetColumn(0, "BLD", ds_pjt_det.GetColumn(0, "BLD"));			//건물용도
		if(ds_out_master.GetColumn(0, "REQKIND") == "1")						//부품판매(1)이면
		{
			ds_plan.SetColumn(0, "GBNA", "B");
		}
		else																	//수리공사(7)이면
		{
			ds_plan.SetColumn(0, "GBNA", "A");
		}
		
		//DEBUG("ufn_makeTransferPlan", "Length of LIFNR is " + length(ds_out_master.GetColumn(0, "LIFNR")));
		
		if(length(ds_out_master.GetColumn(0, "LIFNR")) < 1)						//PK인 LIFNR 미입력시 오류 방지를 위해 설정
		{
			ds_plan.SetColumn(0, "LIFNR", G_VEND_CODE_R);						//의미 없음. ADMIN디버깅 시 에러방지를 위해 G_VEND_CODE_R을 넣음
		}
		else
		{
			ds_plan.SetColumn(0, "LIFNR", ds_out_master.GetColumn(0, "LIFNR")); //공급업체 또는 채권자의 계정번호
		}
		ds_plan.SetColumn(0, "MAGM", "");										//마감여부
		if(newFlag)																//신규견적이면		
		{
			ds_plan.SetColumn(0, "MDT", gfn_getCurrDate());						//전산입력일:오늘날짜
		}
		else
		{
			ds_plan.SetColumn(0, "MDT", ds_out_master.GetColumn(0, "CRDAT"));	//전산입력일:견적생성날짜
		}
		ds_plan.SetColumn(0, "MID", ds_out_master.GetColumn(0, "CRNAM"));		//입력자
		ds_plan.SetColumn(0, "NAM", ds_pjt_det.GetColumn(0, "SPT"));			//현장명
		ds_plan.SetColumn(0, "QTNUM", ds_out_master.GetColumn(0, "QTNUM"));		//견적변호
		ds_plan.SetColumn(0, "QTY", ds_list.rowcount);							//대수(?)
		ds_plan.SetColumn(0, "SDT", "");										//수주완료일(?)
		ds_plan.SetColumn(0, "SEQ", ds_out_master.GetColumn(0, "SEQ"));			//견적차수
		ds_plan.SetColumn(0, "SHDAT", ds_out_master.GetColumn(0, "SHDAT"));		//납기일자
		ds_plan.SetColumn(0, "TEXT", ds_out_master.GetColumn(0, "QTNAM"));		//견적명
		ds_plan.SetColumn(0, "UPN", ds_out_master.GetColumn(0, "UPN"));			//통합프로젝트번호
		ds_plan.SetColumn(0, "VKGRP", ds_out_master.GetColumn(0, "VKGRP"));		//영업그룹
		ds_plan.SetColumn(0, "YDA", ds_out_master.GetColumn(0, "SUM_OFR"));		//수주예상금액
		ds_plan.SetColumn(0, "YDR", "");										//예상이익율(?)
		ds_plan.SetColumn(0, "YDT", ds_out_master.GetColumn(0, "SODAT"));		//수주예상일자
		ds_plan.SetColumn(0, "YYMM", 
							substr(ds_out_master.GetColumn(0, "SODAT"), 0, 6));	//기준년월(수주예상일 기준)
		
		//DEBUG("ufn_makeTransferPlan", "ds_plan is " + ds_plan.SaveXml());
		
		tit_clearActionInfo();
		if(newFlag)																//신규견적인경우
		{
			tit_addSingleActionInfo("cs01:CS0101008B_I4");						//이동계획 Insert
		}	
		else if(planExistFlag)													//이동계획이 존재할경우
		{
			tit_addSingleActionInfo("cs01:CS0101008B_U5");						//이동계획 Update
		}
		else																	//신규견적이 아닌데 이동계획이 존재하지 않는 경우 - 기존에 이동계획 체크박스 언체크로 저장된 견적에 이동계획 체크박스 체크 후 저장 시
		{
			tit_addSingleActionInfo("cs01:CS0101008B_I4");						//이동계획 Insert
		}
		tit_callService("", "", "ds_plan=ds_plan", "", "", "",  true, false, true);	
	}
	else																		//이동계획 생성여부가 0이면 이동계획을 삭제한다.
	{
		if(planExistFlag)														//이동계획이 이미 존재하는 경우에만 삭제한다.
		{
			tit_clearActionInfo();
			tit_addSingleActionInfo("cs01:CS0101008B_D3");						//이동계획 삭제
			tit_callService("", "", "ds_cond=ds_cond", "", "", "",  true, false, true);	
		}
	}
}


/********************************************************************************
* 기      능   : 닫기  
********************************************************************************/
function fn_close() {
	
	var saveFlag = false;

	for(var iCnt = 0;iCnt < ds_list.rowcount;iCnt++)							//저장된 견적에는 자재가 1개 이상 존재해야 하므로, 자재 없이 종료는 불가능하다. 
	{
		if(ds_list.GetColumn(iCnt, "FLAG") != "I") saveFlag = true;				//자재중 신규자재가 아닌 자재가 존재할 경우에만 종료 가능(기 저장 자재 존재시)
	}
	
	if(ds_out_master.GetColumn(0, "QTNUM").length <= 0) saveFlag = true;		//견적번호가 없을 경우 저장 가능(신규견적시) 

	//DEBUG("fn_close", "Length of QTNUM is " + ds_out_master.GetColumn(0, "QTNUM").length + " and saveFlag is " + saveFlag);
	
	if(!saveFlag)
	{
		gfn_showAlert("CW10025", "견적에 자재가 존재하지 않습니다. 견적을 삭제하거나 자재추가-저장 후 종료하세요.");
		return;
	}
	
	close();
}

/********************************************************************************
* 기      능   : 반송 65
********************************************************************************/
function fn_sendback() {
	var docNo1, docNo2;															//견적결재문서번호, 수주결재문서번호
	var docNo1Stat, docNo2Stat;													//결재상태1, 결재상태2
	var decidertn;   // 결재 팝업 리턴코드
		
	docNo1 = ds_out_master.GetColumn(0, "DOC1");								//견적결재문서번호
	docNo2 = ds_out_master.GetColumn(0, "DOC2");								//수주결재문서번호
	docNo1Stat = ds_out_master.GetColumn(0, "DOC1STAT");						//견적결재상태
	docNo2Stat = ds_out_master.GetColumn(0, "DOC2STAT");						//수주결재상태
	
	if(docNo1.length <= 0)														//견적번호가 제대로 입력되지 않았으면..
	{
		gfn_showAlert("CW10025", "기안이 완료되지 않았습니다.");
		return;
	}
	
		
	//if(!gfn_showConfirm("CI30001", "본 건을 반송처리 하시겠습니까?"))			//반송처리하시겠습니까?
	decidertn = gfn_showConfirm_decide("CI30001", "본 건을 반송처리 하시겠습니까?");	
	if(decidertn == "C")  //A : 승인, C : 취소 , W : 의견승인
	{
		gfn_showAlert("CW10025", "반송처리가 취소되었습니다.");
		return;
	}	
	
	ds_dec.ClearData();
	ds_dec.AddRow();
	ds_dec.SetColumn(0, "REIRUM", G_USER_NAME);									//결재자 이름
	ds_dec.SetColumn(0, "SEQSTAT", "2");
	
	if(toNumber(docNo2Stat) > 3)
	{
		ds_dec.SetColumn(0, "APPGUBN", "R");									//수신부서결재플래그
		ds_dec.SetColumn(0, "APSTAT", "5");										//결재마스터 상태 - 반송(2)
	}
	else
	{
		ds_dec.SetColumn(0, "APPGUBN", "S");									//기안부서결재플래그
		ds_dec.SetColumn(0, "APSTAT", "2");										//결재마스터 상태 - 반송(2)
	}

	if(docNo2.length <= 0)														//견적결재시
	{
		ds_dec.SetColumn(0, "DOCNO", docNo1);									
		ds_dec.SetColumn(0, "SEQNO", ds_out_master.GetColumn(0, "DOC1CURSEQ"));
		ds_dec.SetColumn(0, "DOCKIND", "12");									//문서종류(수리공사견적)
	}
	else																		//수주결재시
	{
		ds_dec.SetColumn(0, "DOCNO", docNo2);
		ds_dec.SetColumn(0, "SEQNO", ds_out_master.GetColumn(0, "DOC2CURSEQ"));
		ds_dec.SetColumn(0, "DOCKIND", "13");									//문서종류(수리공사계약(수주))
	}
	
	ds_reject_wb.clearData();													//반송의견을 반송쪽지로 전송하기 위해 데이터셋을 클리어하고, 행을 추가한다.
	ds_reject_wb.AddRow();
	
	//if(gfn_showConfirm("CI30001","반송 의견을 입력하시겠습니까?") )				//반송 의견 입력
	if( decidertn == "W" )    //의견입력 승인시
	{
		var arg = "";
		arg = "fa_docno=" + quote(ds_dec.GetColumn(0,"DOCNO")) + 
		      " fa_dockind=" + quote(ds_dec.GetColumn(0,"DOCKIND"));
		var rtn_yn = gfn_openPopup2("CS0401001C", true , arg);
	}
	
	//DEBUG("fn_sendback", "ds_dec is " + ds_dec.SaveXml());	
	
	//반송메시지를 생성한다.
	ufn_sendSendbackMessage();
	//결재마스터(zwbap01)와 결재디테일(zwbap02)을 업데이트 해준다.
	tit_clearActionInfo();
	tit_addSearchActionInfo("cs01:CS0101008B_T3",true);							//쪽지전송테이블 Lock (중복번호 채번 방지)
	tit_addMultiActionInfo("cs01:CS0101008B_I5", "cs01:CS0101008B_S16", 1);		//쪽지전송
	tit_addMultiActionInfo("cs04:CS0401001A_U1");								//결재마스터 Update
	tit_addMultiActionInfo("cs04:CS0401002A_U2");								//결재디테일 Update
	tit_callService(
		"",
		"",
		"ds_head=ds_dec ds_list_0=ds_dec ds_reject_list=ds_reject_list",
		"",
		"",
		"", 
		true, 
		false,
		true);	

	//gfn_showAlert("CI30001", "반송처리가 완료되었습니다.");
	fn_close();	
}

/********************************************************************************
* 기      능   : 반송메시지 작성
********************************************************************************/
function ufn_sendSendbackMessage()
{
	var docNo1 = ds_out_master.GetColumn(0, "DOC1");							//견적결재문서번호
	var docNo2 = ds_out_master.GetColumn(0, "DOC2");							//수주결재문서번호
	var msgDocNo = ds_dec.GetColumn(0,"DOCNO");
	var i = 0;
	var msgTitle = "견적번호 " + ds_out_master.GetColumn(0, "QTNUM") + "인 문서가 ";
	
	if(docNo2.length <= 0) {
		msgTitle += "견적 결재중 반송되었습니다.";
		//========================2019.04.26 견적반송 시 결재문서번호 추가 시작==================================
		msgTitle += "(결재문서번호 : " + docNo1+ ")";
		//========================2019.04.26 견적반송 시 결재문서번호 추가 종료==================================	
	} else {
		msgTitle += "수주 결재중 반송되었습니다.";
		//========================2019.04.26 견적반송 시 결재문서번호 추가 시작==================================
		msgTitle += "(결재문서번호 : " + docNo2 + ")";
		//========================2019.04.26 견적반송 시 결재문서번호 추가 종료==================================	
	}

	var msgBody = "견적명 : " + ds_out_master.GetColumn(0, "QTNAM") + "\n" +
				  "견적번호 : " + ds_out_master.GetColumn(0, "QTNUM") + "\n" +
				  "견적차수 : " + ds_out_master.GetColumn(0, "SEQ") + "\n" +
				  "프로젝트 : " + ds_out_master.GetColumn(0, "SPT") + "\n" +
				  "현장정보 : " + ds_out_master.GetColumn(0, "KUNNR") + "(" + ds_out_master.GetColumn(0, "CSTNM") + ")\n" +
				  "반송정보 : " + ds_reject_wb.GetColumn(0, "APDESC");			//반송메시지를 추가한다.
				  
	//반송쪽지 전송 검색조건 세팅(문서번호)
	ds_reject_cond.clearData();
	ds_reject_cond.AddRow();
	ds_reject_cond.SetColumn(0, "DOCNO", msgDocNo);								//문서번호 설정
	
	ds_reject_list.ClearData();													//전송대상 리스트를 클리어한다.

	tit_clearActionInfo();					
	tit_addSearchActionInfo("cs01:CS0101008B_S15");								//반송 기안자 
	tit_callService("", "", "ds_reject_cond=ds_reject_cond", "ds_reject_wb=ds_reject_wb", "", "", true, false, true);	

	ds_reject_list.AddRow();													//작성자
	ds_reject_list.SetColumn(i, "MESGSEND", G_USER_ID);							//반송자
	ds_reject_list.SetColumn(i, "MESGACCP", ds_out_master.GetColumn(0,"CRNAM"));//작성자
	ds_reject_list.SetColumn(i, "MESGTITL", msgTitle);							//제목
	ds_reject_list.SetColumn(i, "MESGDESC", msgBody);							//반송문구

	//기안부서 기안자가 존재하고, 작성자가 기안부서 기안자가 아닐 경우(이미 전송된 사용자에게 중복전송되지 않도록)
	if(length(ds_reject_wb.GetColumn(0, "APNUM1")) > 1 
		&&ds_out_master.GetColumn(0, "CRNAM") != ds_reject_wb.GetColumn(0, "APNUM1"))
	{
		i = i + 1;
		ds_reject_list.AddRow();												//기안부서 기안자
		ds_reject_list.SetColumn(i, "MESGSEND", G_USER_ID);
		ds_reject_list.SetColumn(i, "MESGACCP", ds_reject_wb.GetColumn(0, "APNUM1"));
		ds_reject_list.SetColumn(i, "MESGTITL", msgTitle);
		ds_reject_list.SetColumn(i, "MESGDESC", msgBody);
	}
		
	//관리부서 기안자 존재하고 관리부서 기안자 작성자 또는 기안부서 기안자가 아닌 경우(이미 전송된 사용자에게 중복전송되지 않도록)
	if( length(ds_reject_wb.GetColumn(0, "APNUM2")) > 1 
		&& (ds_out_master.GetColumn(0, "CRNAM") != ds_reject_wb.GetColumn(0, "APNUM2"))
		&& (ds_reject_wb.GetColumn(0, "APNUM1") != ds_reject_wb.GetColumn(0, "APNUM2")) )
	{
		i = i + 1;
		ds_reject_list.AddRow();												//관리부서 기안자
		ds_reject_list.SetColumn(i, "MESGSEND", G_USER_ID);
		ds_reject_list.SetColumn(i, "MESGACCP", ds_reject_wb.GetColumn(0, "APNUM2"));
		ds_reject_list.SetColumn(i, "MESGTITL", msgTitle);
		ds_reject_list.SetColumn(i, "MESGDESC", msgBody);
	}
	//DEBUG("ufn_sendSendbackMessage", "ds_reject_list is " + ds_reject_list.SaveXml());
}

/********************************************************************************
* 기      능   : 결재 15
********************************************************************************/
function fn_decide() {
	var docNo1, docNo2;															//견적결재문서번호, 수주결재문서번호
	var docNo1Stat, docNo2Stat;													//결재상태1, 결재상태2
	var decidertn;   // 결재 팝업 리턴코드
		
	docNo1 = ds_out_master.GetColumn(0, "DOC1");								//견적결재문서번호
	docNo2 = ds_out_master.GetColumn(0, "DOC2");								//수주결재문서번호
	docNo1Stat = ds_out_master.GetColumn(0, "DOC1STAT");						//견적결재상태
	docNo2Stat = ds_out_master.GetColumn(0, "DOC2STAT");						//수주결재상태
	
	//DEBUG("fn_decide", "ds_list is " + ds_list.saveXml());
	
	if(docNo1.length <= 0)														//견적번호가 제대로 입력되지 않았으면..
	{
		gfn_showAlert("CW10025", "기안이 완료되지 않았습니다.");
		return;
	}

	//if(!gfn_showConfirm("CI30001", "본 건을 결재처리 하시겠습니까?"))			//결재처리하시겠습니까?
	decidertn = gfn_showConfirm_decide("CI30001", "본 건을 결재처리 하시겠습니까?");	
	if(decidertn == "C")  //A : 승인, C : 취소 , W : 의견승인
	{
		gfn_showAlert("CW10025", "결재처리가 취소되었습니다.");
		return;
	}
    // 계약서 체크 
    /*
	 if(docNo2.length > 0 && ds_out_master.GetColumn(0, "SUM_OFR") >= 10000000)						
	 {																			//수주금액 1,000만원 이상인 경우 계약서첨부 필수 2016.04.19 YAR
		 if(length(ds_out_master.GetColumn(0, "FNAME")) == 0)
		 {
			 gfn_showAlert("CW10025", "수주금액 1천만원 이상 현장으로 기안 시 계약서 첨부가 필수입니다.");
			 return;
		 }
	 }
	*/
	ufn_enableCommBtn("decide", false);											//결재버튼 비활성화(문서번호이중생성 방지) 2016.01.04 YAR
	
	ds_dec.ClearData();
	ds_dec.AddRow();
	
	ds_dec.SetColumn(0, "APPGUBN", "S");										//기안부서결재플래그
	ds_dec.SetColumn(0, "SEQSTAT", "3");										//결재자 정상결재 완료 플래그
	ds_dec.SetColumn(0, "REIRUM", G_USER_NAME);									//결재자 이름
	
	var requestFlag = false;													//청구입력 플래그
	var updateQTFlag = false;													//견적 업데이트 플래그
	
	if(toNumber(docNo2Stat) > 3)
	{
		ds_dec.SetColumn(0, "APPGUBN", "R");									//수신부서결재플래그
	}
	else
	{
		ds_dec.SetColumn(0, "APPGUBN", "S");									//기안부서결재플래그
	}
	
	if(docNo2.length <= 0)														//견적결재시
	{
		ds_dec.SetColumn(0, "DOCNO", docNo1);									//견적결재문서번호								
		
		ds_dec.SetColumn(0, "SEQNO", ds_out_master.GetColumn(0, "DOC1CURSEQ"));	//결재자순번
		ds_dec.SetColumn(0, "DOCKIND", "12");									//문서종류(수리공사견적)
		
		if(ds_out_master.GetColumn(0, "DOC1CURSEQ") == ds_out_master.GetColumn(0, "DOC1MAXSEQ"))
		{
			ds_dec.SetColumn(0, "APSTAT", "3");									//견적결재상태를 3으로 변경(6으로는 수주등록시 변경)
			ds_out_master.SetColumn(0, "QTAPDAT", gfn_getCurrDate());			//견적마스터의 견적승인일에 오늘일자를 등록한다.
			updateQTFlag = true;												//견적마스터를 업데이트한다.
		}
		else
		{
			ds_dec.SetColumn(0, "APSTAT", "1");									//최종결재자가 아니면 ZWBAP01의 APSTAT는 1로 남겨둠
		}
	}
	else																		//수주결재시
	{	
		ds_dec.SetColumn(0, "DOCNO", docNo2);									//수주결재문서번호
		ds_dec.SetColumn(0, "SEQNO", ds_out_master.GetColumn(0, "DOC2CURSEQ"));	//결재자순번
		ds_dec.SetColumn(0, "DOCKIND", "13");									//문서종류(수리공사계약(수주))
		
		updateQTFlag = true;
		if(ds_out_master.GetColumn(0, "DOC2CURSEQ") == ds_out_master.GetColumn(0, "DOC2MAXSEQ"))
		{
			if(toNumber(docNo2Stat) > 3 || cb_reqkind.value == "1" || cb_spartnm.Value == "40")
			{
				ds_dec.SetColumn(0, "APSTAT", "6");								//수주결재상태를 6으로 변경
				ds_out_master.SetColumn(0, "SOAPDAT", gfn_getCurrDate());		//견적마스터의 수주승인일에 오늘일자를 등록한다.
				requestFlag = true;												//청구등록을 수행한다.									
				updateQTFlag = true;											//견적마스터를 업데이트한다.
			}
			else 
			{
				ds_dec.SetColumn(0, "APSTAT", "3");
			}
		}
		else
		{
			if(toNumber(docNo2Stat) > 3)
			{
				ds_dec.SetColumn(0, "APSTAT", "4");								//최종결재자가 아니면 ZWBAP01의 APSTAT는 1로 남겨둠
			}
			else
			{
				ds_dec.SetColumn(0, "APSTAT", "1");								//최종결재자가 아니면 ZWBAP01의 APSTAT는 1로 남겨둠
			}
		}
	}
	
	//if(gfn_showConfirm("CI30001","결재 의견을 입력하시겠습니까?") )				//결재 의견 입력
	if( decidertn == "W" )    //의견입력 승인시
	{
		var arg = "";
		arg = "fa_docno=" + quote(ds_dec.GetColumn(0,"DOCNO")) + 
		      " fa_dockind=" + quote(ds_dec.GetColumn(0,"DOCKIND"));
		var rtn_yn = gfn_openPopup2("CS0401001C", true , arg);
	}

	//----------------------------------------------------------------------
	// 팀장 의견입력 필수 체크 20170718
	// 수리공사 견적건에 대해서만 체크할 것
	if(ds_dec.GetColumn(0,"DOCKIND") == "12") {
		if(! gfn_decideCommentCheck(quote(ds_dec.GetColumn(0,"DOCNO")) )) 
			return;   
	}	
	//----------------------------------------------------------------------

	//DEBUG("fn_decide", ds_dec.SaveXml());
	
	//결재마스터(zwbap01)와 결재디테일(zwbap02)을 업데이트 해준다.
	tit_clearActionInfo();
	tit_addMultiActionInfo("cs04:CS0401001A_U1");								//결재마스터 Update
	tit_addMultiActionInfo("cs04:CS0401002A_U2");								//결재디테일 Update
	if(updateQTFlag) tit_addMultiActionInfo("cs01:CS0101008B_U1");				//견적마스터 Update (견적승인일 또는 수주승인일 업데이트가 필요할때)
	
	if(requestFlag)																//수주결재 완료로 청구입력이 필요한 경우 청구에 데이터를 입력한다.
	{
		//ufn_saveRequest(); -> 트랜잭션 중복 실행 문제 방지를 위해 루틴 변경
		//                      이전루틴은 백업파일(CS0101008B_201502121453.xml) 참조
	
	
		//저장 SEQ와 QTNUM을 설정한다.
		ds_cond.ClearData();
		ds_cond.AddRow();
		ds_cond.SetColumn(0, "QTNUM", ds_out_master.GetColumn(0, "QTNUM"));
		ds_cond.SetColumn(0, "SEQ", ds_out_master.GetColumn(0, "SEQ"));
		
		//DEBUG("fn_decide", "ds_cond is " + ds_cocnd.saveXml());
		//DEBUG("fn_decide", "ds_out_master is " + ds_out_master.saveXml());
		//DEBUG("fn_decide", "ds_list is " + ds_list.saveXml());
		
		ds_out_master.SetColumn(0, "FLAG", "I");								//FLAG를 바꿔준다.
		ds_out_elj.SetColumn(0, "FLAG", "I");								//FLAG를 바꿔준다.
		
		var bomOnlyFlag = true;													//BOM자재만 존재하는 견적인가?
		
		for (var iCnt = 0;iCnt < ds_list.rowcount;iCnt++) 
		{
			if(ds_list.getColumn(iCnt, "RGBN") == "1")							//자재 중 보수자재만 전송한다. 내작(BOM)자재는 미전송
			{
				ds_list.SetColumn(iCnt, "FLAG", "I");
				bomOnlyFlag = false;
			}
			else
			{	
				ds_list.SetColumn(iCnt, "FLAG", "");
			}
		}
		
		ds_out_master.SetColumn(0, "QSTAT", "2");								//ZCST001의 QSTAT를 청구접수로 바꾼다.
		ds_out_master.SetColumn(0, "CHGBN", "0");								//ZCST001의 청구구분을 청구접수(0)으로 바꿔준다. 1:수주변경, 2:수주취소, 3:재청구		
		
		if(!bomOnlyFlag)														//보수자재 포함견적일경우
		{

			gfn_copyDs(ds_list, ds_list_req, "FLAG=" + quote("I"));				//청구전송 데이터셋에 데이터를 카피한다.
			
			//DEBUG("fn_decide", "ds_list_req is " + ds_list_req.SaveXml());
			
			tit_addSearchActionInfo("cs01:CS0101008B_T2", true);				//청구번호 채번용 Exclusive Lock
			tit_addSearchActionInfo("cs01:CS0101008B_S8", true);				//청구번호 채번(ds_key)
			tit_addMultiActionInfo("cs01:CS0101008B_I3");						//ZMMT031에 데이터를 INSERT 한다.
			tit_addMultiActionInfo("cs01:CS0101008B_U3");						//ZCST001을 UPDATE해 준다(REQNO)
		}
		else																	//BOM자재만 포함한 견적일경우
		{
			ds_key.AddRow();
			ds_key.SetColumn(0, "REQNO", "");
			ds_out_master.SetColumn(0, "QSTAT", "3");                        	//ZCST001의 QSTAT를 청구접수로 바꾼다.
			tit_addMultiActionInfo("cs01:CS0101008B_U3");						//BOM자재만 있는 경우이므로 ZCST001만 UPDATE해준다.
		}

		tit_callService(
			"" 
			, ""
			, "ds_head=ds_dec ds_list_0=ds_dec ds_out_master=ds_out_master ds_list=ds_list_req ds_cond=ds_cond ds_key=ds_key"
			, "ds_key = ds_key"
			, ""
			, "fn_afterSaveRequest");	
	}
	else
	{
		tit_callService("", "", "ds_head=ds_dec ds_list_0=ds_dec ds_out_master=ds_out_master", "",  "", "", true, false, true);	
		//gfn_showAlert("CI30001", "결재가 완료되었습니다.");
		fn_close();
	}	
}

/********************************************************************************
* 기      능   : 승인완료자재를 청구테이블에 등록(승인완료후자동등록으로 변경예정)
********************************************************************************
function ufn_saveRequest()
{
	//저장 SEQ와 QTNUM을 설정한다.
	ds_cond.ClearData();
	ds_cond.AddRow();
	ds_cond.SetColumn(0, "QTNUM", ds_out_master.GetColumn(0, "QTNUM"));
	ds_cond.SetColumn(0, "SEQ", ds_out_master.GetColumn(0, "SEQ"));
	
	DEBUG("ufn_saveRequest", "ds_cond is " + ds_cond.saveXml());
	DEBUG("ufn_saveRequest", "ds_out_master is " + ds_out_master.saveXml());
	DEBUG("ufn_saveRequest", "ds_list is " + ds_list.saveXml());
	
	ds_out_master.SetColumn(0, "FLAG", "I");									//FLAG를 바꿔준다.
	
	for (var iCnt = 0;iCnt < ds_list.rowcount;iCnt++) 
	{
		if(ds_list.getColumn(iCnt, "RGBN") == "1")								//자재 중 보수자재만 전송한다. 내작(BOM)자재는 미전송
		{
			ds_list.SetColumn(iCnt, "FLAG", "I");
		}
		else
		{	
			ds_list.SetColumn(iCnt, "FLAG", "");
		}
	}
	
	ds_out_master.SetColumn(0, "QSTAT", "2");									//ZCST001의 QSTAT를 청구접수로 바꾼다.
	ds_out_master.SetColumn(0, "CHGBN", "0");									//ZCST001의 청구구분을 청구접수(0)으로 바꿔준다. 1:수주변경, 2:수주취소, 3:재청구
	gfn_copyDs(ds_list, ds_list_req, "FLAG=" + quote("I"));						//청구전송 데이터셋에 데이터를 카피한다.
	
	DEBUG("ufn_saveRequest", "ds_list_req is " + ds_list_req.SaveXml());
	
	tit_clearActionInfo();
	tit_addSearchActionInfo("cs01:CS0101008B_T2", true);						//청구번호 채번용 Exclusive Lock
	tit_addSearchActionInfo("cs01:CS0101008B_S8", true);						//청구번호 채번

	tit_addMultiActionInfo("cs01:CS0101008B_I3");								//ZMMT031에 데이터를 INSERT 한다.
	tit_addMultiActionInfo("cs01:CS0101008B_U3");								//ZCST001을 UPDATE해 준다(REQNO)

	tit_callService(
        ""
        , ""
        , "ds_out_master=ds_out_master ds_list=ds_list_req ds_cond=ds_cond ds_key=ds_key"
        , "ds_key = ds_key"
        , ""
        , "fn_afterSaveRequest");	
}
*/

function fn_afterSaveRequest(errCode, errMsg)
{
	if ( errCode!= 0 ) {
		gfn_showMsg("CE00001");
	} else {
		gfn_showMsg("CI00003");
		gfn_showAlert("CI30001", "결재 및 청구전송이 완료되었습니다.");
		
		for (var iCnt = 0;iCnt < ds_list.rowcount;iCnt++) 						//종료를 위해 데이터셋의 플래그를 복구한다.
		{
			ds_list.SetColumn(iCnt, "FLAG", "");
		}
		
		fn_close();		
	}
}

/********************************************************************************
* 기      능   : 기안 16 - 견적 기안만 이루어짐. 수주 기안은 수주등록 버튼에서
********************************************************************************/
function fn_draft() {
	var docNo1, docNo2;															//견적결재문서번호, 수주결재문서번호
	var docNo1Stat, docNo2Stat;													//견적결재상태, 수주결재상태
	var workStage;																//수주이후작업단계(0:청구전송완료/1:수주변경결재/2:수주취소결재/3:수주재청구결재)
	var docNo, docKind;															//결재문서번호, 결재종류
	var appGubn;																//결재종류(S는 기안부서, R는 수신부서)
	var inputArg;																//결재선지정창에 넘길 arguments
	var newDocNo;																//신규 결재문서번호
	var sum_ofr;																//수주금액 1천만원초과 여부
	var newDocNo;
	docNo1 = ds_out_master.GetColumn(0, "DOC1");								//견적결재문서번호
	docNo2 = ds_out_master.GetColumn(0, "DOC2");								//수주결재문서번호
	docNo1Stat = ds_out_master.GetColumn(0, "DOC1STAT");						//견적결재상태
	docNo2Stat = ds_out_master.GetColumn(0, "DOC2STAT");						//수주결재상태
	workStage = ds_out_master.GetColumn(0, "CHGBN");							//견적 현재 결재 상태
					
	if(workStage != "")
	{
		gfn_showAlert("CW10025", "견적 및 수주승인이 완료된 건입니다.");
		return;
	}
	if(ds_out_master.GetColumn(0, "SUM_OFR") >= 10000000)	sum_ofr = true;
	if(sum_ofr) 																//수시검사 대상현장-> 수주금액 1천만원이상 2016.06 yar
	{
		gfn_showAlert("CW10025", "수시검사 대상 현장 공사시 설치업등록업체에 발주하시기 바랍니다.");
	}
			
	var docPrefix;
	if(docNo1.length <= 0)														//견적 결재이면
	{
		appGubn = "S";	
		docKind = "12";
		docPrefix = "R01";
	}
	else																		//수주 결재이면 
	{
		docKind = "13";
		docPrefix = "R02";
		if(docNo2Stat == "3") appGubn = "R";									//기안부서결재종료시 수신부서결재시 결재구분 R
		else appGubn = "S";														//미종료시 기안부서결재 결재구분 S
	}
	if(!Check_Rdate())	return false;
	
	//10번 권한 사용자면 기안접수함에 데이터를 넣고 끝낸다.
	var user_grp = gfn_getUserGroup();
	if( user_grp == '10' && substr(G_USER_ID,0,1) == '8' ) 
	{
		var arg = "fa_docno=" + quote(ds_out_master.GetColumn(0, "QTNUM") + ds_out_master.GetColumn(0, "SEQ")) + 
				  " fa_dockind=" + quote(docKind) +
				  " fa_sumofr=" + quote(sum_ofr) + 
				  " fa_fna=" + quote(ds_draft.GetColumn(0, "FNA")) +
				  " fa_reqkind=" + quote(cb_reqkind.value) +
				  " fa_doc=" + docprefix;
		var returnArgs = gfn_openPopup2("CS0401001B", true, arg);
		if( returnArgs[0] == "S" ) 
		{
			gfn_showAlert("CI30001", "기안 접수가 완료되었습니다.");
		}
		else
		{
			gfn_showAlert("CW10025", "기안접수에 실패했습니다. 확인 후 다시 시도해주세요.");
		}
		ufn_resetAll();															//모든 정보를 리셋한다.
		ufn_initParameters();													//Parameter를 초기화한다.
		return;
	}
	if(appGubn == "S")															    //기안부서결재시에만 문서번호 신규생성
	{
		ds_docno_gen.ClearData();													//결재번호생성 데이터셋을 클리어한다
		ds_docno_gen.AddRow();																
		ds_docno_gen.SetColumn(0,"PFX",docPrefix);									//Prefix는 R01또는 R02로 세팅
		tit_clearActionInfo();					
		tit_addSearchActionInfo("wb01:DOC_CODE_GEN_S1",true);					
		tit_addSearchActionInfo("wb01:DOC_CODE_GEN_U1");					
		tit_callService("", "", "ds_docno_gen_i=ds_docno_gen", "ds_docno_gen=ds_docno_gen_o", "", "", true, false, true);				

		newDocNo = ds_docno_gen.GetColumn(0, "DOCNO");
	}
	else
	{
		newDocNo = docNo2;
	}

	if(length(newDocNo) <= 1)
	{
		gfn_showMsg("CW10025", "결재문서번호 생성에 실패했습니다. 잠시 후 다시 시도해주세요.");
		return;
	}
	
	//appGubn = "S";																//appGubn은 무조건 S (R은 수신부서결재)
	inputArg = "fa_docno=" + quote(newDocNo) + 							    		//결재선생성창을 위한 Argument를 설정한다.
			   " fa_dockind=" + quote(docKind) + 
			   " fa_appgubn=" + quote(appGubn) +
			   " fa_sumofr="  + quote(sum_ofr) +
			   " fa_reqkind=" + quote(cb_reqkind.value) +
			   " fa_modgbn="  + quote(cb_modgbn.value) +
			   " fa_doc=" + docprefix;
	
	var ret = gfn_openPopup("CS0401001A",true, inputArg);
	
	if(ret[0] == "S")															//상신 성공시 작업 - 견적결재번호(doc1) update
	{
		if(docKind == "12")
		{
			ds_out_master.SetColumn(0, "DOC1", newDocNo);						//견적결재번호에 신규생성된 결재번호를 넣음
		}
		else
		{
			ds_out_master.SetColumn(0, "DOC2", newDocNo);						//수주결재번호에 신규생성된 결재번호를 넣음
		}
		
		ds_out_master.SetColumn(0, "CHGBN", "");

		tit_clearActionInfo();
		tit_addMultiActionInfo("cs01:CS0101008B_U1");							//결재번호를 ZCST001에 Update한다.
		tit_callService("", "", "ds_out_master=ds_out_master", "", "", "", true, false, true);
		
		gfn_showAlert("CI30001", "기안이 완료되었습니다.");
		
		ufn_resetAll();															//모든 정보를 리셋한다.
		ufn_initParameters();													//Parameter를 초기화한다.
	}
	else																		//상신 실패시 작업
	{
		gfn_showAlert("CW10025", "기안이 취소되었습니다.");
	}
}

/********************************************************************************
* 기      능   : 재견적
********************************************************************************/
function fn_recost() 
{
	//수주등록으로 납기일변경 활성화 되어있는 상태에서 재견적진행하려는 경우 처리불가능
	if(shdatFlag){
		gfn_showAlert("CW10025", "수주등록 작업진행 중으로 재견적이 불가합니다.");
		return;
	}
	DEBUG("fn_recost", "cb_seq.Value:" + cb_seq.Value + "/ds_seq.max(CODE):" + ds_seq.max("CODE"));
	//재견적은 마지막 차수만 가능
	if(cb_seq.Value != ds_seq.max("CODE")) 
	{
		gfn_showAlert("CW10025", "최종차수가 아니므로 재견적이 불가능합니다.");
		return;
	}
	
	//재견적여부 확인
	if(!gfn_showConfirm("CI30001", "현재 견적을 재견적 하시겠습니까?")) return;
	
	
	//수주등록 기안올리기 전까지만 재견적이 가능하다. 2015.09.18 YAR
	if(length(ds_out_master.GetColumn(0, "DOC2")) > 0) //수주등록기안 올렸거나, 반송상태인경우 재견적 불가
	{
		gfn_showAlert("CW10025", "수주등록 진행 중으로 재견적이 불가합니다.");
		return;
	}

	//차수를 증가시킨다
	var newSeq = toString(toNumber(ds_out_master.GetColumn(0, "SEQ")) + 1);
	
	//증가된 차수를 적용한다.
	ds_seq.AddRow();
	ds_seq.SetColumn(ds_seq.rowcount - 1, "CODE", newSeq);
	ds_seq.SetColumn(ds_seq.rowcount - 1, "CODE_NAME", newSeq + "차");
	
	ds_out_master.SetColumn(0, "SEQ", newSeq);									//마스터데이터 차수 증가
	ds_out_master.SetColumn(0, "FLAG", "I");									//마스터데이터 Insert를 위한 Flag 설정(I)
	ds_out_elj.SetColumn(0, "FLAG", "I");								
	ds_cond.SetColumn(0, "SEQ", newSeq);										//검색데이터셋의 차수 증가
	
	for(var iCnt = 0; iCnt < ds_list.rowcount; iCnt++)
	{
		ds_list.SetColumn(iCnt, "SEQ", newSeq);									//자재리스트 차수 증가
		ds_list.SetColumn(iCnt, "FLAG", "I");									//자재리스트 Insert Flag 설정
//   	ds_list.SetColumn(iCnt, "REQKIND", ds_out_master.GetColumn(0, "REQKIND"));
	}
	
	//새로운 차수의 레코드를 생성하는 것이므로, 결재 관련 사항을 리셋한다.
	ds_out_master.SetColumn(0, "DOC1", "");
	ds_out_master.SetColumn(0, "DOC2", "");
	ds_out_master.SetColumn(0, "DOC3", "");
	ds_out_master.SetColumn(0, "DOC4", "");
	ds_out_master.SetColumn(0, "DOC5", "");
	ds_out_master.SetColumn(0, "DOC1STAT", "");
	ds_out_master.SetColumn(0, "DOC2STAT", "");
	ds_out_master.SetColumn(0, "DOC3STAT", "");
	ds_out_master.SetColumn(0, "DOC4STAT", "");
	ds_out_master.SetColumn(0, "DOC5STAT", "");
	ds_out_master.SetColumn(0, "DOC1STATNM", "");
	ds_out_master.SetColumn(0, "DOC2STATNM", "");
	ds_out_master.SetColumn(0, "DOC3STATNM", "");
	ds_out_master.SetColumn(0, "DOC4STATNM", "");
	ds_out_master.SetColumn(0, "DOC5STATNM", "");
	ds_out_master.SetColumn(0, "DOC1DEC", "");
	ds_out_master.SetColumn(0, "DOC2DEC", "");
	ds_out_master.SetColumn(0, "DOC3DEC", "");
	ds_out_master.SetColumn(0, "DOC4DEC", "");
	ds_out_master.SetColumn(0, "DOC5DEC", "");
	
	//새로운 차수의 레코드를 생성하는 것이므로, 견적 관련 사항을 리셋한다.
	ds_out_master.SetColumn(0, "PS_PSPID", "");									//원WBS
	ds_out_master.SetColumn(0, "QSTAT", "");									//청구상태
	ds_out_master.SetColumn(0, "CHGBN", "");									//견적상태

	// 2021.03.22 BOM 체크 시 납기일의 경우 캘린더데이 기준 +23일 세팅. 서비스자재 최병준 요청. Han JH
	if(ds_out_master.GetColumn(0, "BOMYN") == 'Y' ) {
		cal_shdat.Value = gfn_getAfterDate(gfn_getCurrDate(),23);	
	}	
	
	//DEBUG("fn_recost", ds_list.SaveXml());
	
	ufn_saveData();																//데이터를 저장한다.
}	

/********************************************************************************
* 기      능   : 리셋 85
********************************************************************************/
function fn_reset() 
{
	if(gfn_showConfirm("CW10025", "입력을 취소하고 모든 정보를 초기화 하시겠습니까?"))
	{
		ufn_resetAll();															//모든 정보를 리셋한다.
		ufn_initParameters();													//Parameter를 초기화한다.
	}
}

//=========================================================================================
// [ PART 4]
// Callback 함수 정의 : callback 함수명은 메인 함수의 fn_xxxx() 에서 xxxx 부분은 fn_afterXXXX()
// 형태가 되도록 작성 
//=========================================================================================

/********************************************************************************
* 기      능   : 공통코드 조회 Callback
********************************************************************************/
function fn_completeInit(sCode, sDsObj, sCodeType) {

}

//=========================================================================================
// [ PART 5 ]
// Detail Process Event 정의 ( User Define function )
// 사용자 정의 함수는 ufn_xxxx() 형태로 작성 
//=========================================================================================

/********************************************************************************
* 기      능   : 모든 정보를 리셋(ds_cond는 초기화 및 재조회를 위해 남겨둠)
********************************************************************************/
function ufn_resetAll()
{
	ds_list.clearData();														//ds_list를 삭제한다.
	ds_out_master.clearData();													//ds_out_master를 삭제한다. 
	ds_out_master.addRow();														//ds_out_master에 새 Row를 Insert한다.
	ds_pjt_det.clearData();
	ds_key.clearData();															//ds_key를 clear한다.
	ds_key.AddRow();															//ds_key에 새 Rwo를 Insert한다.
	
	ds_out_elj.clearData();													
	ds_out_elj.addRow();														
	
	//Mask Edit Box를 모두 Clear한다.
	var comps = Components["MaskEdit"];
	for(iCnt=0;iCnt < comps.count();iCnt++)
	{
		comps[iCnt].value = "";
	}
}

/********************************************************************************
* 기      능   : 누락 항목 Check
********************************************************************************/
function ufn_checkInputForSave()
{
	var newSaveFlag = true;														//신규견적인경우 true, 수주등록시 사용할 기등록견적인경우 false

	if(toNumber(ds_out_master.GetColumn(0, "DOC1STAT")) >= 3) 			 		//견적결재가 완료된경우 newflag를 false로 설정하여 계산서 관련항목 입력토록
	{
		newSaveFlag = false;
	}
	
	//DEBUG("ufn_checkInputForSave", "DOC1STAT is " + toNumber(ds_out_master.GetColumn(0, "DOC1STAT")));
	//----------------------------------------------------------------------
	//입력필드 확인
	
	if(ufn_isNull(ed_qtnam, true, "견적명", ed_qtnam)) return false;			//견적명
	if(ufn_isNull(ed_pjt, true, "Proj. No", ed_pjt)) return false;				//프로젝트번호
	if(ufn_isNull(cb_spartnm, true, "제품군", cb_spartnm)) return false;		//제품군
	if(ufn_isNull(cb_reqkind, true, "청구종류", cb_reqkind)) return false;		//청구종류
	if(ufn_isNull(cal_sodat, true, "수주예정일", cal_sodat)) return false;		//수주예정일
	if(ufn_isNull(cb_cs001gbn, true, "견적구분", cb_cs001gbn)) return false;	//견적구분
	if(ufn_isNull(cal_shdat, true, "납기일", cal_shdat)) return false;			//납기일
	if(ufn_isNull(cb_agent, true, "영업주체", cb_agent)) return false;			//영업주체
	
	if(newSaveFlag)																//신규견적일 경우에만 체크
	{
		if(!gfn_checkDate(gfn_getCurrDate(), ds_out_master.GetColumn(0,"SODAT"), true, cal_sodat,"수주예정일")) return false;		//수주예정일
		if(!gfn_checkDate(gfn_getCurrDate(),ds_out_master.GetColumn(0,"SHDAT"), true, cal_shdat,"납기일")) return false;			//납기일
	}
	//납기일 체크로직
	if(!Check_Rdate())		return false;
	
	//20150208 - 판매단가가 0일경우 저장불가, 20150603 LJH 보완(최초값 체크)
	 for(var iCnt=0;iCnt<ds_list.rowcount;iCnt++)
	 {
		 if(toNumber(ds_list.GetColumn(iCnt, "NETPR") == 0) || toNumber(ds_list.GetOrgColumn(iCnt, "NETPR") == 0) || 
		    toNumber(ds_list.GetColumn(iCnt, "NETPR_ORG") == 0) || toNumber(ds_list.GetOrgColumn(iCnt, "NETPR_ORG") == 0))
		 {
			 gfn_showAlert("CW10025", "판매단가가 0인 자재가 존재하여 저장이 불가능합니다.");
			 return false;
		 }

		 if(toNumber(ds_list.GetColumn(iCnt, "MENGE") == 0) || toNumber(ds_list.GetOrgColumn(iCnt, "MENGE") == 0))
		 {
			 gfn_showAlert("CW10025", "수량이 0인 자재가 존재하여 저장이 불가능합니다.");
			 return false;
		 }
	 }
	
	//20150209 - 한가지 아이템을 여러 호기에 적용할때
	var matnrCd, bwtarCd, zgubnYn, reqkindCd, hNo;								//자재코드(번호), 평가유형코드, 직영재고구분(Y or ''), 자재청구유형(1, 6, 7, 8, G), 호기번호
	for(var iCnt=0;iCnt<ds_list.rowcount;iCnt++)
	{
		matnrCd = ds_list.GetColumn(iCnt, "MATNR");								//자재번호
		bwtarCd = ds_list.GetColumn(iCnt, "BWTAR");								//평가유형
		zgubnYn = ds_list.GetColumn(iCnt, "ZGUBN");								//직영재고구분
		reqkindCd = ds_list.GetColumn(iCnt, "REQKIND");							//자재청구유형(업체재고소진시 6)
		hNo = ds_list.GetColumn(iCnt, "HNO");									//호기번호		
		
		for(var iCnt2=0;iCnt2<ds_list.rowcount;iCnt2++)
		{
			if(iCnt != iCnt2)													//자신이 아닐 경우에만 비교
			{
				if(matnrCd == ds_list.GetColumn(iCnt2, "MATNR"))				//동일 자재인가?
				{
					if(bwtarCd != ds_list.GetColumn(iCnt2, "BWTAR"))			//평가유형이 다른 자재인가?
					{
						gfn_showAlert("CW10025", "평가유형은 자재별로 동일하게 설정하셔야 합니다.");
						return false;
					}
					
					if(zgubnYn != ds_list.GetColumn(iCnt2, "ZGUBN"))			//직영재고구분이 다른 자재인가?
					{
						gfn_showAlert("CW10025", "직영재고여부는 자재별로 동일하게 설정하셔야 합니다.");
						return false;
					}
					
					if((reqkindCd != ds_list.GetColumn(iCnt2, "REQKIND")) 
														&& reqkindCd == "6")	//업체재고소진여부가 다른 자재인가?
					{
						gfn_showAlert("CW10025", "업체재고소진여부는 자재별로 동일하게 설정하셔야 합니다.");
						return false;
					}		
								
					if(hNo == ds_list.GetColumn(iCnt2, "HNO"))					//호기별로 동일자재가 2번이상 견적되었는가?
					{
						gfn_showAlert("CW10025", "호기별로 동일자재는 중복견적하실 수 없습니다.");
						return false;
					}
				}
			}
		}
	}	
	//----------------------------------------------------------------------
	//청구구분에 따른 판매할인액 적용
	if(cb_reqkind.value == 7 || cb_reqkind.value == 'S') 						//수리공사 / 시스템공사
	{
		if(ufn_isNull(ed_netwr_dc, true, "판매할인액", ed_netwr_dc)) return false;	//판가할인액 수리공사도 적용 -> 최인식GJ(20150209)
	}
	else if(cb_reqkind.value == 1) 												//부품판매
	{
		if(ufn_isNull(ed_netwr_dc, true, "판매할인액", ed_netwr_dc)) return false;
	}
	else
	{
		ed_netwr_dc.Text = "0";
	}

	//----------------------------------------------------------------------
	//금액산출 %값 확인
	if(ufn_isNull(ed_exp_pct, true, "제경비 적용%", ed_exp_pct)) return false;		//견적명
	if(ufn_isNull(ed_mng_pct, true, "일반관리비 적용%", ed_mng_pct)) return false;	//프로젝트번호
	if(ufn_isNull(ed_pro_pct, true, "기업이윤 적용%", ed_pro_pct)) return false;	//청구종류	


	//----------------------------------------------------------------------
	//계산값 확인
	
	if(length(ed_netwr_std.value) == 0 || length(ed_netwr_ofr.value) == 0 || length(ed_sum_std.value) == 0 ||length(ed_sum_ofr.value) == 0)
	{	
		gfn_showAlert("CW10025", "표준금액 또는 견적금액상에 오류가 있습니다. 자재리스트를 확인해주세요.");
		return false;
	}

	//그리드상의 자재 판매단가 합계금액과 헤더의 표준금액(자재판매가) 동일여부 체크
	if(ds_list.Sum("NETWR") <> ed_netwr_std.value)
	{	
		gfn_showAlert("CW10025", "자재 판매단가 합계금액과 헤더의 견적금액(자재판매가)이 동일하지 않습니다.");
		return false;
	}

	//----------------------------------------------------------------------
	//자재리스트값 확인
	var listFlag = true;
	for(iCnt=0;iCnt < ds_list.count;iCnt++)
	{
		if(length(ds_list.GetColumn(iCnt, "HNO")) == 0 							//호기번호
				//|| length(ds_list.GetColumn(iCnt, "HNA")) == 0 				//호기명 --호기명이 비어있는 경우도 있음
				|| length(ds_list.GetColumn(iCnt, "MATNR")) == 0 				//자재번호
				|| length(ds_list.GetColumn(iCnt, "BWTAR")) == 0 				//평가유형
				|| length(toString(ds_list.GetColumn(iCnt, "MENGE"))) == 0 		//수량
				|| length(toString(ds_list.GetColumn(iCnt, "OFRHOUR"))) == 0)	//견적공수
		{
			listFlag = false;
		}
	}
	if(!listFlag)
	{
		gfn_showAlert("CW10025", "자재 리스트의 자재 중 필수입력값이 비어있는 자재가 존재합니다.");
		return false;
	}
	
	//====================================자회사 체크========================
	if(lejchk == 'Y') {
		/*
		if(ufn_isNull(Div0.ed_pjt_2,     	true, "Proj. No(자회사)", 		Div0.ed_pjt_2))      return false;		//프로젝트번호
		if(ufn_isNull(Div0.cb_reqkind_2, 	true, "청구종류(자회사)", 		Div0.cb_reqkind_2))  return false;		//청구종류
		if(ufn_isNull(Div0.ed_pspid,     	true, "수주번호(자회사)", 		Div0.ed_pspid))      return false;		//수주번호	
		//if(ufn_isNull(Div0.me_bilamt1_2, 	true, "부품or인건비(자회사)", 	Div0.me_bilamt1_2))  return false;	
		if(ufn_isNull(Div0.cal_bildat1_2,   true, "발행일(자회사)", 		Div0.cal_bildat1_2)) return false;	
		*/
		
		//ufn_checkInputForSave_elj();
		if(!ufn_checkInputForSave_elj())
		 {
			return false;
		 }
				
	}
	
	return true;
}

/********************************************************************************
* 기      능   : Null여부 확인 gfn_isNull을 Status에서 Alert방식으로 바꿈(팝업이므로 메세지창이 없음)
********************************************************************************/
function ufn_isNull(chkObj, isShowMsg, lbTxt, focusObj) {
	if( length( chkObj.value) > 0 ) {
		return false;
	}

	if( isShowMsg ) {
		// 메시지 처리
		if( length( lbTxt) == 0 ) {
			// 필수 입력항목 입니다. 확인하여 주십시오.
			gfn_showAlert("CW00002");
		} else {
			// lbTxt + " 항목에 값이 누락되어 있습니다. 확인하여 주십시오."
			gfn_showAlert("CW00001", lbTxt);
		}
	}

	if( focusObj == null ) {
		focusObj = chkObj;
	}

	focusObj.setFocus();
	return true;
}




/********************************************************************************
* 기      능   : 제품군이 주차인경우 업체의 조직정보가 아닌 특정 조직 지정
********************************************************************************/
function ufn_j_dataset()
{	
//alert("aaa");

	if ( G_LANG == 'ko')
	{ ds_cond_j.setColumn(0, "LANG", "3")	; }
	else if ( G_LANG == 'en')
	{ ds_cond_j.setColumn(0, "LANG", "E")	; }


	tit_clearActionInfo();
	tit_addSearchActionInfo("cs01:CS0101008B_20");                        
	
	tit_callService(	
        ""
        , ""
        , "ds_cond_j=ds_cond_j"
        , "ds_j_depart=ds_j_depart"
        , ""
        , ""
        , ""
        , ""
        , true);   		
}




/********************************************************************************
* 기      능   : 화면상의 조건들을 초기화 한다
********************************************************************************/
function ufn_initParameters()
{
	//검색조건 Combo Initialize
	var codeArr = ["TAXK1", "ZTERM", "KVGR1","KVGR2", "2", "CS001_GBN", "CS182"];
    var dsObjArr = [ds_taxk1, ds_zterm, ds_kvgr1, ds_kvgr2, ds_bwtar_cd, ds_gbn, ds_ctp_cd];
    var addTypeArr = [G_CODE_NONE, G_CODE_NONE, G_CODE_NONE, G_CODE_NONE, G_CODE_SELECT, G_CODE_SELECT, G_CODE_SELECT];
    gfn_searchCommCode(codeArr, dsObjArr, addTypeArr,true);
	
	gfn_queryDD07T("ZCS_MODGBN", ds_modgbn, "N");
	gfn_queryDD07T("ZCS_AGENT", ds_agent, "N");	
		
    //==========================
	ufn_j_dataset();	//제품군이 주차인경우 업체의 조직정보가 아닌 특정 조직 지정으로 인하여 추가(2018.07.23)
	//==========================
		
	ds_ctp_cd.Filter(" CODE!=" +quote("B") + "&&CODE!="+quote("D"));
	if(length(ds_cond.GetColumn(0, "QTNUM")) > 0) 								//수정/삭제/조회를 위해 QTNUM이 넘어온 경우이므로 프로젝트 조회 및 데이터셋 설정 작업을 여기서 수행한다.
	{
		ufn_getOfferInfo();														//프로젝트정보 및 자재정보를 가져온다
	}
	else																		//견적을 신규생성해야하므로 데이터를 리셋한다.
	{			
		//제품구분선택 콤보 Initialize
		cb_jpgbn.Index = 0;
		cb_spartnm.Index = 0;
		
		//청구구분 선택 콤보 Initialize
		if(ds_list.rowcount > 0)												//견적복사에서 왔을 경우 무조건 유상청구로 설정(리셋 후 초기계산시 알림창 방지)
		{
			cb_reqkind.Index = 1;
		}	
		else
		{
			cb_reqkind.Index = 0;
		}
	
		cb_taxk1.Index = 1;
		cb_kvgr1.Index = 1;
		cb_kvgr2.Index = 0;
		cb_cs001gbn.Index = 0;
		cb_zterm.Index = -1;
		cb_seq.Index = 0;		
	
		//체크박스 클리어
		chk_pgubn.value = 0;
		chk_spbill.value = 0;
		chk_night.value = 1;
		chk_weekend.value = 1;
		
		//제경비, 일반관리비, 기업이윤 % 기본설정
		ed_exp_pct.value = 5;
		ed_mng_pct.value = 10;
		ed_pro_pct.value = 10;
		
		//견적 관련 텍스트박스 클리어
		ed_qtnum.text = "";
		ed_pjt.text = "";
		ed_qtnam.text = "";
		
		//휴일 및 야간 플래그
		ds_out_master.SetColumn(0, "NIGHT_WGT", 1);
		ds_out_master.SetColumn(0, "WEEKEND_WGT", 1);
		
		//캘린더 클리어
		cal_sodat.value = "";
		cal_shdat.value = "";	//납기일 default: 현재일자 	2015.07.16 yar
		cal_bildat1.value = "";
		cal_bildat2.value = "";
		cal_bildat3.value = "";
		
		//각종 텍스트박스
		me_bilamt2.value = "";
		me_bilamt3.value = "";
		ed_remark.text = "";
		
		//전자결재 상태를 update한다.
		ed_wf_stat.Text = "신규";
		
		//권한을 설정한다.
		ufn_setPermissions();
		
		//예산 추가 입력 제어 
		ufn_setWriteCost(false);
		ufn_setObjectVisibility("btn_writeCost", false);
		ufn_setObjectVisibility("btn_saveCost", false);
	}
	
}
function fn_afterQueryDD07T_ZCS_AGENT(){
	ds_agent.Filter("CODE != 'C'");
}
/********************************************************************************
* 기      능   : 선택된 견적 정보를 Retrieve (추가/수정/삭제 시)
********************************************************************************/
function ufn_getOfferInfo()
{
	ufn_resetAll();																//현재 견적사항을 리셋한다.
	
	fn_createWait("",this);														//처리중 윈도우 create
	grd_list.Redraw = false;													//Grid의 모든 컬럼이 다 채워진 후 refresh하기 위해 redrew를 false로 설정한다.

	tit_clearActionInfo();	
	tit_addSearchActionInfo("cs01:CS0101008B_S4", true);						//견적 마스터 정보
	tit_addSearchActionInfo("cs01:CS0101008B_S1", true);						//프로젝트 상세정보(호기명/호기id)
	tit_addSearchActionInfo("cs01:CS0101008B_S5", true);  						//견적 디테일 정보
	tit_addSearchActionInfo("cs01:CS0101008B_S6", true);  						//차수 정보
	tit_addSearchActionInfo("cs01:CS0101008B_S7", true); 	 					//호기선택 콤보박스용 호기정보
	//tit_addSearchActionInfo("cs01:CS0101008B_S19", true); 	 				//협력사 기안 계약서 첨부유무
	
	tit_addSearchActionInfo("cs01:CS0101008B_S20", true); 	//자회사 정보 읽어 오기
	
				
//===================================기존소스========================================//				
	/*
	tit_callService(	
        ""
        , ""
        , "ds_cond=ds_cond"
        , "ds_out_master=ds_out_master ds_pjt_det=ds_pjt_det ds_list=ds_list ds_seq=ds_seq ds_hna=ds_hna ds_draft=ds_draft"
        , ""
        , "fn_afterOfferInfoQuery"
        , true);
    */    
//===================================변경소스(sync)========================================//		        
	tit_callService(	
        ""
        , ""
        , "ds_cond=ds_cond"
        , "ds_out_master=ds_out_master ds_pjt_det=ds_pjt_det ds_list=ds_list ds_seq=ds_seq ds_hna=ds_hna ds_draft=ds_draft ds_out_elj=ds_out_elj"
        , ""
        , "fn_afterOfferInfoQuery"
        ,""
        ,""
        , true);        
        

//trace(ds_out_elj.SaveXML());
//alert("a");        
}

/********************************************************************************
* 기      능   : 선택된 견적정보 Retrieve Callback
********************************************************************************/
function fn_afterOfferInfoQuery()
{
	fn_destroyWait();															//처리중 윈도우 destroy
	grd_list.Redraw = true;														//Grid Redraw!!
		
	
	//==================전현정대리요청 추가20181012==================//		
	var HIS_UCOST_SS = ds_out_master.GetColumn(0, "HIS_UCOST");
	ds_out_master.SetColumn(0, "HIS_UCOST_SS",HIS_UCOST_SS);			
	var HIS_UCOST_FN_SS = ds_out_master.GetColumn(0, "HIS_UCOST_FN");
	ds_out_master.SetColumn(0, "HIS_UCOST_FN_SS",HIS_UCOST_FN_SS);		
		   
	var HIS_LAB_SS = ds_out_master.GetColumn(0, "HIS_DLAB");
	ds_out_master.SetColumn(0, "HIS_LAB_SS",HIS_LAB_SS);			
	var HIS_LAB_FN_SS = ds_out_master.GetColumn(0, "HIS_DLAB_FN");
	ds_out_master.SetColumn(0, "HIS_LAB_FN_SS",HIS_LAB_FN_SS);			   
	
    //경비합
	var HIS_ETC_SS = ds_out_master.GetColumn(0, "HIS_ETC") + ds_out_master.GetColumn(0, "HIS_EMACID") + ds_out_master.GetColumn(0, "HIS_SAFE") + 
	                 ds_out_master.GetColumn(0, "HIS_LOG") + ds_out_master.GetColumn(0, "HIS_INSPEC");
	ds_out_master.SetColumn(0, "HIS_ETC_SS",HIS_ETC_SS);			
	var HIS_ETC_FN_SS = ds_out_master.GetColumn(0, "HIS_ETC_FN") + ds_out_master.GetColumn(0, "HIS_EMACID_FN") + ds_out_master.GetColumn(0, "HIS_SAFE_FN") +
	                    ds_out_master.GetColumn(0, "HIS_LOG_FN") + ds_out_master.GetColumn(0, "HIS_INSPEC_FN");
	ds_out_master.SetColumn(0, "HIS_ETC_FN_SS",HIS_ETC_FN_SS);			   
		   
	var HIS_INDSUM_SS = ds_out_master.GetColumn(0, "HIS_INDSUM") + ds_out_master.GetColumn(0, "HIS_LABOR") ;
	ds_out_master.SetColumn(0, "HIS_INDSUM_SS",HIS_INDSUM_SS);			
	var HIS_INDSUM_FN_SS = ds_out_master.GetColumn(0, "HIS_INDSUM_FN") + ds_out_master.GetColumn(0, "HIS_LABOR_FN") ;
	ds_out_master.SetColumn(0, "HIS_INDSUM_FN_SS",HIS_INDSUM_FN_SS);			   
    
    //운반비합
	var HIS_LOG_SS = ds_out_master.GetColumn(0, "HIS_LOG");
	ds_out_master.SetColumn(0, "HIS_LOG_SS",HIS_LOG_SS);			
	var HIS_LOG_FN_SS = ds_out_master.GetColumn(0, "HIS_LOG_FN");
	ds_out_master.SetColumn(0, "HIS_LOG_FN_SS",HIS_LOG_FN_SS);
	
	//검사비합	   
	var HIS_INSPEC_SS = ds_out_master.GetColumn(0, "HIS_INSPEC");
	ds_out_master.SetColumn(0, "HIS_INSPEC_SS",HIS_INSPEC_SS);			
	var HIS_INSPEC_FN_SS = ds_out_master.GetColumn(0, "HIS_INSPEC_FN");
	ds_out_master.SetColumn(0, "HIS_INSPEC_FN_SS",HIS_INSPEC_FN_SS);		
		   
	var HIS_ORE_SS = ds_out_master.GetColumn(0, "HIS_LCOST") + ds_out_master.GetColumn(0, "HIS_BETC") + ds_out_master.GetColumn(0, "HIS_MMOD") + ds_out_master.GetColumn(0, "HIS_LIFT");
	ds_out_master.SetColumn(0, "HIS_ORE_SS",HIS_ORE_SS);			
	var HIS_ORE_FN_SS = ds_out_master.GetColumn(0, "HIS_LCOST_FN") + ds_out_master.GetColumn(0, "HIS_BETC_FN") + ds_out_master.GetColumn(0, "HIS_MMOD_FN") + ds_out_master.GetColumn(0, "HIS_LIFT_FN");
	ds_out_master.SetColumn(0, "HIS_ORE_FN_SS",HIS_ORE_FN_SS);			   		   
	//===============================================================//
	
	
	
	//만약 시스템 신규 제작 이전 데이터이면, 비어있는 컬럼들을 채운다.
	if(ds_out_master.GetColumn(0, "UPN") == "")
	{
		//마스터 리스트의 값을 채운다.
		ds_out_master.SetColumn(0, "KUNNR",ds_pjt_det.GetColumn(0, "KUNNR"));					//고객번호
		ds_out_master.SetColumn(0, "SPT",ds_pjt_det.GetColumn(0, "SPT"));						//현장명
		ds_out_master.SetColumn(0, "CST",ds_pjt_det.GetColumn(0, "CST"));						//거래선
		ds_out_master.SetColumn(0, "CSTNM",ds_pjt_det.GetColumn(0, "CSTNM"));					//거래선명
		ds_out_master.SetColumn(0, "CST_JUDGE",ds_pjt_det.GetColumn(0, "CST_JUDGE"));			//거래선 등급		
//		ds_out_master.SetColumn(0, "SPART", ds_pjt_det.GetColumn(0, "SPART"));					//제품군
//		ds_out_master.SetColumn(0, "SPARTNM",ds_pjt_det.GetColumn(0, "SPARTNM"));				//제품군명

		//제품군이 주차인경우 업체의 조직정보가 아닌 특정 조직 지정으로 인하여 추가(2018.07.23)
		//=======================================시작=======================================
        if ( ds_out_master.GetColumn(0, "SPARTNM") == '20' )
        {
			ds_out_master.SetColumn(0, "VKGRP", ds_j_depart.GetColumn(0, "J_VKGRP"));					//팀
			ds_out_master.SetColumn(0, "VKGRPNM", ds_j_depart.GetColumn(0, "J_VKGRPNM"));				//팀명
			ds_out_master.SetColumn(0, "VKBUR", ds_j_depart.GetColumn(0, "J_VKBUR"));					//사업장
			ds_out_master.SetColumn(0, "VKBURNM", ds_j_depart.GetColumn(0, "J_VKBURNM"));				//사업장명        
        }
        else
        {
			ds_out_master.SetColumn(0, "VKGRP", ds_pjt_det.GetColumn(0, "VKGRP"));					//팀
			ds_out_master.SetColumn(0, "VKGRPNM", ds_pjt_det.GetColumn(0, "VKGRPNM"));				//팀명
			ds_out_master.SetColumn(0, "VKBUR", ds_pjt_det.GetColumn(0, "VKBUR"));					//사업장
			ds_out_master.SetColumn(0, "VKBURNM", ds_pjt_det.GetColumn(0, "VKBURNM"));				//사업장명
		}
		//=======================================끝=========================================
		
		
		ds_out_master.SetColumn(0, "BSU", ds_pjt_det.GetColumn(0, "BSU"));						//업체코드
		ds_out_master.SetColumn(0, "BSUNM", ds_pjt_det.GetColumn(0, "BSUNM"));					//업체명
		ds_out_master.SetColumn(0, "PNAME", ds_pjt_det.GetColumn(0, "PNAME"));					//담당자명
		ds_out_master.SetColumn(0, "LIFNR", ds_pjt_det.GetColumn(0, "LIFNR"));					//공급업체
//		ds_out_master.SetColumn(0, "BUSSI",  substr(ds_pjt_det.GetColumn(0, "SPART"), 0, 1));	//사업부구분(1:승강기/2:주차/4:PSD)
		ds_out_master.SetColumn(0, "SH_ADDR", ds_pjt_det.GetColumn(0, "ADDR"));					//납품처주소
		ds_out_master.SetColumn(0, "UPN", ds_pjt_det.GetColumn(0, "UPN"));						//프로젝트번호
		ds_out_master.SetColumn(0, "RATE", ds_pjt_det.GetColumn(0, "RATE"));					//임율	
			
		
		//자재리스트의 값을 채운다.
		var nHRow = 0;
		for(var iCnt=0;iCnt < ds_list.rowcount;iCnt++)
		{
			nHRow = ds_hna.SearchRow("WBS=\"" +  ds_list.GetColumn(iCnt, "HNO") + "\"");
			ds_list.SetColumn(iCnt, "HNA", ds_hna.GetColumn(nHRow, "HNA"));
		}
		
		//이후 필요에 따라 다른 작업을 수행한다.	
	}
//trace(ds_j_depart.SaveXML());
//trace(ds_pjt_det.SaveXML());
//alert("변경2");	
	
	//계산서 분할발행 조건(chk_spbill)이 설정되어있는 경우 발행일2, 발행일3, 금액2, 금액3을 ENABLE 해 준다.
	chk_spbill_OnClick();
	
	//판매할인액 %를 계산한다. 
	ed_netwr_pct.text = ((toNumber(ed_sum_ofr.Value) - toNumber(ed_sum_std.Value)) / toNumber(ed_sum_std.Value)) * 100;
	
	//DEBUG("fn_afterOfferInfoQuery", "ed_netwr_pct is " + ed_netwr_pct.value);
	
	var workStage = ds_out_master.GetColumn(0, "CHGBN");						//결재상태를 가져온다.

	if(ds_out_master.GetColumn(0, "ENDYN") == "Y") { //종료된 견적일 경우
		workStage = "99";
	}

	//실패현장 여부에 따라 청구종류를 제한한다.
	if(chk_fail.Value == "Y") ufn_checkFailSite();
	
	//전자결재 상태를 Update한다.
	switch (workStage)
	{
		case "":																//저장, 견적승인, 수주승인 단계
			if(ds_out_master.GetColumn(0, "DOC2STATNM").length > 0)
			{
				ed_wf_stat.Text = ds_out_master.GetColumn(0, "DOC2STATNM");
			}
			else if(ds_out_master.GetColumn(0, "DOC1STATNM").length > 0)
			{
				ed_wf_stat.Text = ds_out_master.GetColumn(0, "DOC1STATNM");
			}
			else
			{
				ed_wf_stat.Text = "견적 저장 완료";
			}
			break;
		case "0": 																//청구등록 단계
			if(ds_out_master.GetColumn(0, "PS_PSPID").length > 0)
			{
				ed_wf_stat.Text = "청구 전송 완료";								//SAP전송 후 원 WBS가 입력된 경우 전송완료로 표시
			}
			else
			{
				ed_wf_stat.Text = "청구 등록 완료";
			}
			break;
		case "1":																//수주변경 단계
			ed_wf_stat.Text = ds_out_master.GetColumn(0, "DOC4STATNM");
			break;
		case "2":																//수주취소 단계
			ed_wf_stat.Text = ds_out_master.GetColumn(0, "DOC5STATNM");
			break;
		case "3":																//재청구 단계
			if(ds_out_master.GetColumn(0, "DOC3STATNM").length > 0)
			{
				ed_wf_stat.Text = ds_out_master.GetColumn(0, "DOC3STATNM");
			}
			else
			{
				ed_wf_stat.Text = "재청구 저장완료";
			}			
			break;
		case "99":																//견적 종료
			ed_wf_stat.Text = "견적 종료";
			break;
	}

	//권한을 설정한다.
	ufn_setPermissions();

	//전결규정을 표시한다.
	ufn_setRegulation();
	
	//견적가에 따른 견적서/부품요청서 출력 조건 설정(현재 700만원이하는 모두)
	ufn_setPrintOfr();

	//예산 추가 입력 제어 
	ufn_setWriteCost(false);
	
	chk_elj.Enable = true;
}

/********************************************************************************
* 기      능   : 선택된 프로젝트의 기본정보를 Retrieve
********************************************************************************/
function ufn_getProjectInfo()
{
	if(ed_pjt.value == "")
	{
		gfn_showMsg("프로젝트 정보가 올바르지 않습니다.");
		ufn_resetAll();
		ufn_initParameters();
		return;
	}
	
/* 2015.05.12 LJH 기타자재청구의 FM청구, FM재고소진청구시 OnHand여부 체크
	if(length(ed_ing.value) < 1){
		gfn_showAlert("OnHand 현장이 아닙니다");	//프로젝트검색시, onhand 아닌 거래선 선택한경우 2015.04.15 YAR
		ufn_resetAll();
		ufn_initParameters();
		return;
	}
*/
	tit_clearActionInfo();
	
	tit_addSearchActionInfo("cs01:CS0101008B_S1");
	tit_addSearchActionInfo("cs01:CS0101008B_S7");

	tit_callService(
        ""
        , ""
        , "ds_cond=ds_cond"
        , "ds_pjt_det=ds_pjt_det ds_hna=ds_hna"
        , ""
        , "fn_afterProjectQuery"
        , true);		
	
}

/********************************************************************************
* 기      능   : 신규 프로젝트 조회 Callback  
********************************************************************************/
function fn_afterProjectQuery(errCode, errMsg) 
{
	//var posid = ed_pjt.value;
	
	//if(gfn_psdCheck(posid))	{
	//	gfn_showAlert("CW00245");
	//	ed_pjt.text = "";
	//	ed_spt.text = "";
	//	ufn_resetAll();
	//	ufn_initParameters();
	//	return;
	//}

	if(ds_pjt_det.count <= 0)
	{
		gfn_showAlert("CW10025", "프로젝트 상세정보가 존재하지 않습니다.");
		ed_pjt.text = "";
		ed_spt.text = "";
		ufn_resetAll();
		ufn_initParameters();
		return;		
	}

	if(length(ds_pjt_det.GetColumn(0, "KUNNR")) < 1)
	{
		gfn_showAlert("CW10025", "고객정보가 존재하지 않습니다.");
		ed_pjt.text = "";
		ed_spt.text = "";
		ufn_resetAll();
		ufn_initParameters();
		return;		
	}
	
	if(ds_hna.rowcount < 1)
	{
		gfn_showAlert("CW10025", "호기정보가 존재하지 않습니다.");
		ed_pjt.text = "";
		ed_spt.text = "";
		ufn_resetAll();
		ufn_initParameters();
		return;
	}
	


//trace(ds_j_depart.SaveXML());
//trace(ds_pjt_det.SaveXML());
//alert("신규");
	//DEBUG("fn_afterProjectQuery", "errCode is " + errCode + ", errMsg is " + errMsg);

	//화면 상단 처리
	ds_out_master.SetColumn(0, "FLAG", "I");									//저장플래그 "I"
	ds_out_elj.SetColumn(0, "FLAG", "I");
	ds_out_master.SetColumn(0, "KUNNR",ds_pjt_det.GetColumn(0, "KUNNR"));		//고객번호	
	//======================고객사 할인율 추가=============================
	ds_out_master.SetColumn(0, "DC_RATE",ds_pjt_det.GetColumn(0, "DC_RATE"));
	//=====================================================================
	ds_out_master.SetColumn(0, "SPT",ds_pjt_det.GetColumn(0, "SPT"));			//현장명
	ds_out_master.SetColumn(0, "CST",ds_pjt_det.GetColumn(0, "CST"));			//거래선
	ds_out_master.SetColumn(0, "CSTNM",ds_pjt_det.GetColumn(0, "CSTNM"));		//거래선명
	ds_out_master.SetColumn(0, "CST_JUDGE",ds_pjt_det.GetColumn(0, "CST_JUDGE"));			//거래선 등급
//	ds_out_master.SetColumn(0, "SPART", ds_pjt_det.GetColumn(0, "SPART"));		//제품군
//	ds_out_master.SetColumn(0, "SPARTNM",ds_pjt_det.GetColumn(0, "SPARTNM"));	//제품군명

	//제품군이 주차인경우 업체의 조직정보가 아닌 특정 조직 지정으로 인하여 추가(2018.07.23)
	//=======================================시작=======================================
    if ( ds_out_master.GetColumn(0, "SPARTNM") == '20' )
    {
		ds_out_master.SetColumn(0, "VKGRP", ds_j_depart.GetColumn(0, "J_VKGRP"));		//팀
		ds_out_master.SetColumn(0, "VKGRPNM", ds_j_depart.GetColumn(0, "J_VKGRPNM"));	//팀명
		ds_out_master.SetColumn(0, "VKBUR", ds_j_depart.GetColumn(0, "J_VKBUR"));		//사업장
		ds_out_master.SetColumn(0, "VKBURNM", ds_j_depart.GetColumn(0, "J_VKBURNM"));	//사업장명
	}
	else
	{
		ds_out_master.SetColumn(0, "VKGRP", ds_pjt_det.GetColumn(0, "VKGRP"));		//팀
		ds_out_master.SetColumn(0, "VKGRPNM", ds_pjt_det.GetColumn(0, "VKGRPNM"));	//팀명
		ds_out_master.SetColumn(0, "VKBUR", ds_pjt_det.GetColumn(0, "VKBUR"));		//사업장
		ds_out_master.SetColumn(0, "VKBURNM", ds_pjt_det.GetColumn(0, "VKBURNM"));	//사업장명	
	}
	//=======================================끝=========================================
	
	
	ds_out_master.SetColumn(0, "BSU", ds_pjt_det.GetColumn(0, "BSU"));			//업체코드
	ds_out_master.SetColumn(0, "BSUNM", ds_pjt_det.GetColumn(0, "BSUNM"));		//업체명
	ds_out_master.SetColumn(0, "PNAME", ds_pjt_det.GetColumn(0, "PNAME"));		//담당자명
	ds_out_master.SetColumn(0, "LIFNR", ds_pjt_det.GetColumn(0, "LIFNR"));		//공급업체
//	ds_out_master.SetColumn(0, "BUSSI",  
//							substr(ds_pjt_det.GetColumn(0, "SPART"), 0, 1));	//사업부구분(1:승강기/2:주차/4:PSD)
	ds_out_master.SetColumn(0, "SH_ADDR", ds_pjt_det.GetColumn(0, "ADDR"));		//납품처주소
	ds_out_master.SetColumn(0, "UPN", ds_pjt_det.GetColumn(0, "UPN"));			//프로젝트번호
	//ds_out_master.SetColumn(0, "VKBUR", ds_pjt_det.GetColumn(0, "VKBUR"));		//사업장
	//ds_out_master.SetColumn(0, "VKBURNM", ds_pjt_det.GetColumn(0, "VKBURNM"));	//사업장명	
	ds_out_master.SetColumn(0, "RATE", ds_pjt_det.GetColumn(0, "RATE"));		//당해년도 임율	
	ds_out_master.SetColumn(0, "FAILYN", ds_pjt_det.GetColumn(0, "FAILYN"));	//실패현장여부
	ds_out_master.SetColumn(0, "CRNAME", G_USER_NAME);							//작성자이름
	
	// 영업주체 기본 셋팅 
	if(ds_pjt_det.GetColumn(0, "TGB") == "1"){
		ds_out_master.SetColumn(0, "AGENT","A");
	} else {
		ds_out_master.SetColumn(0, "AGENT","B");
	}
	
	//DEBUG("fn_afterProjectQuery", "G_USER_NAME is " + G_USER_NAME);

	//화면 하단 처리

	ds_out_master.SetColumn(0, "REQNO", "");									//데이터셋 내부 컬럼 처리-청구번호
	ds_out_master.SetColumn(0, "QSTAT", "0");									//데이터셋 내부 컬럼 처리-청구상태

	gfn_showSearchMsg(grd_list);												// 메시지 처리 
	
	if(chk_fail.Value == "Y") ufn_checkFailSite();								//실패현장여부에 따라 업체재고소진 청구 가능여부 세팅
	
	//DEBUG("fn_afterProjectQuery", ds_out_master.savexml());
	//DEBUG("fn_afterProjectQuery", ds_hna.savexml());
	
	if(ed_vkgrpnm.value == "")		//팀명 누락된 경우 저장 불가하도록 처리 2016.04.22 yar	(zwbt010-wgbn , zuserf-userteam 확인)
	{
		gfn_showAlert("CW10025", "사용자 팀명이 누락되어 수주생성이 불가능합니다.");
		fn_close();
	}
	
	//ed_netwr_dc.Value = "";
	
	//자회사 인경우  자회사 정보 입력가능토록 버튼 활성화(신규)
	//ufn_eljchk(ds_out_master.GetColumn(0, "KUNNR"));
	ufn_eljchk(ds_out_master.GetColumn(0, "KUNNR"), ds_out_master.GetColumn(0, "DC_RATE"));
	
	btn_discount.Text = '고객할인율 적용(' +   toNumber(ds_out_master.GetColumn(0, "DC_RATE")) * 100 + '%)';
}

/********************************************************************************
* 기      능   : grd_list_OnExpandUp의 자재검색팝업(2)에서 자재코드로 자재상세정보 검색 완료 시
********************************************************************************/
function ufn_setMatnr()
{
	if (ds_ma_list.rowcount > 0)
	{
	    ds_list.fireevent = false;		//데이터리스트의 이벤트를 disable한다.
	    
	    if (ds_ma_list.GetColumn(0,"LVORM") == 'X')
	    {
	   		gfn_showAlert("CW10025", "삭제 표기된 자재번호 입니다. 확인하십시요.");
	   		ds_ma_list.clearData();
			return;
     	}

     	nRow = ds_ma_cond.GetColumn(0,"NROW");
       	
		ufn_clearDsList(nRow);

		ds_list.SetColumn(nRow,"MATNR",ds_ma_list.GetColumn(0,"MATNR"));		//자재번호
		ds_list.SetColumn(nRow,"MAKTX",ds_ma_list.GetColumn(0,"MAKTX")); 		//자재내역
		ds_list.SetColumn(nRow,"JOBHOUR",ds_ma_list.GetColumn(0,"JOBHOUR"));	//작업시간
		ds_list.SetColumn(nRow,"MAN",ds_ma_list.GetColumn(0,"MAN"));			//투입인원
		ds_list.SetColumn(nRow,"MTART",ds_ma_list.GetColumn(0,"MTART")); 		//자재유형
		ds_list.SetColumn(nRow,"GEWEI",ds_ma_list.GetColumn(0,"GEWEI")); 		//기본단위
		ds_list.SetColumn(nRow,"MEINS",ds_ma_list.GetColumn(0,"MEINS")); 		//자재단위
		ds_list.SetColumn(nRow,"NETPR_ORG",ds_ma_list.GetColumn(0,"SAMT1")); 	//판매단가
		ds_list.SetColumn(nRow,"UCOSTA",ds_ma_list.GetColumn(0,"SAMT2")); 		//정품원가
		ds_list.SetColumn(nRow,"UCOSTR",ds_ma_list.GetColumn(0,"SAMT3")); 		//수리품원가
		ds_list.SetColumn(nRow,"UPR",ds_ma_list.GetColumn(0,"UPR")); 			//원가인상율
		ds_list.SetColumn(nRow,"RGBN",ds_ma_list.GetColumn(0,"RGBN")); 			//청구유형(1:보수/2:BOM)
		ds_list.SetColumn(nRow,"RGBNNM",ds_ma_list.GetColumn(0,"RGBNNM"));		//청구유형명
		ds_list.SetColumn(nRow,"BANNAB",ds_ma_list.GetColumn(0,"BANNAB")); 		//반납자재여부
		ds_list.SetColumn(nRow,"SPEC",ds_ma_list.GetColumn(0,"SPEC")); 			//제품SPEC
		ds_list.SetColumn(nRow,"MATNRNM",ds_ma_list.GetColumn(0,"MATNRNM")); 	//제품명
		ds_list.SetColumn(nRow,"WEBAZ",ds_ma_list.GetColumn(0,"WEBAZ")); 		//LEADTIME
		
		if(chk_fail.Value != "Y")
		{
			if(Length(ds_list.GetColumn(nRow, "REQKIND")) == 0)
			{
				ds_list.SetColumn(nRow,"REQKIND",ds_out_master.GetColumn(0,"REQKIND"));	//청구종류가 없을 경우 프로젝트의 청구종류를 따른다.
			}
		}
		else
		{
			ds_list.SetColumn(nRow,"REQKIND","G");								//청구종류:실패현장청구
		}

		if(ds_ma_list.GetColumn(0,"RGBN") == "2") 								//BOM자재이면 아래 값들을 기본값으로 넣어준다(Insert시 error방지)
		{
			ds_list.SetColumn(nRow, "BANNAB", "");								//반납자재여부(미반납)
			ds_list.SetColumn(nRow, "GEWEI", "");								//기본단위
			ds_list.SetColumn(nRow, "UCOSTR", "0");								//수리품원가
			ds_list.SetColumn(nRow,"UPR", "0"); 								//원가인상율
		}

		if ( parseInt(ds_list.GetColumn(nRow,"MENGE")) < 1)						//기초수량을 1로 세팅한다.
		{
			ds_list.SetColumn(nRow,"MENGE",1);
		}

		ds_list.SetColumn(nRow, "ZGUBN", "");									//직영재고 Index를 초기화한다.

		//xkwh:인건비 및 자재비 합계 계산을 위해 견적공수에 표준공수를 대입
		ds_list.SetColumn(nRow,"OFRHOUR",ds_ma_list.GetColumn(0,"JOBHOUR"));	//작업시간

		//xkwh:수량*단가=합계를 계산한다.
		ds_list.SetColumn(nRow, "NETWR", ds_list.GetColumn(nRow, "MENGE") * ds_list.GetColumn(nRow, "NETPR"));
		
		//xkwh:표준인건비, 계산인건비를 계산한다.
		var lcosts = toNumber(ds_list.GetColumn(nRow, "MENGE")) * toNumber(ds_list.GetColumn(nRow, "MAN")) * 
					toNumber(ds_list.GetColumn(nRow, "JOBHOUR")) * toNumber(ds_out_master.GetColumn(0, "RATE"));
		var lcostc = toNumber(ds_list.GetColumn(nRow, "MENGE")) * toNumber(ds_list.GetColumn(nRow, "MAN")) * 
					toNumber(ds_list.GetColumn(nRow, "OFRHOUR")) * toNumber(ds_out_master.GetColumn(0, "RATE"));

		//DEBUG("ufn_setMatnr", ds_list.savexml());
		//DEBUG("ufn_setMatnr", ds_out_master.savexml());

		ds_list.SetColumn(nRow, "LCOSTS", lcosts);
		ds_list.SetColumn(nRow, "LCOSTC", lcostc);

		//DEBUG("ufn_setMatnr", "ds_out_master.GetColumn(0, 'rate'):" + ds_out_master.GetColumn(0, "RATE"));

		// 최초 입력시 평가유형 초기값 입력
		if (length(ds_list.GetColumn(nRow,"BWTAR")) < 1) {
			if(ds_list.GetColumn(nRow, "MTART") == "PALB"){
				ds_list.SetColumn(nRow,"BWTAR","PA");
			} else if(ds_list.GetColumn(nRow, "MTART") == "HALB") {
				ds_list.SetColumn(nRow,"BWTAR","HA");
			} else {
				ds_list.SetColumn(nRow,"BWTAR","RA");
			}
		}

		// 평가유형별 판매가 변경
		if(SubStr(ds_list.GetColumn(nRow, "BWTAR"),1) == "B"){
			ds_list.SetColumn(nRow,"NETPR",ds_ma_list.GetColumn(0,"SAMT1")*0.4); 
		} else if (SubStr(ds_list.GetColumn(nRow, "BWTAR"),1) == "A") {
			ds_list.SetColumn(nRow,"NETPR", ds_ma_list.GetColumn(0,"SAMT1")); 
		} else {
			ds_list.SetColumn(nRow,"NETPR", "0"); 
		}
				
		ufn_calcListValues(nRow);												//xkwh:각종 계산식을 업데이트 한다.	
		ufn_calcCostValues("ufn_setMatnr");										//xkwh:청구구분에 따른 계산값을 다시 계산한다.			
		ds_list.fireevent = true;												//데이터리스트의 이벤트를 enable한다.
		
		//반제품 체크로직 추가 201703 YAR 
		if(cnt == 0 && ds_list.GetColumn(nRow, "MTART") == "HALB" && ds_list.GetColumn(nRow, "RGBN") == '1')
		{
			cnt = cnt + 1;
			gfn_showAlert("CW10025", "반제품은 BOM 청구 진행 하시길 바랍니다.");
			
			ds_list.fireevent = false;
			ufn_clearDsList(nRow);
			ufn_calcCostValues("ufn_setMatnr");
			ds_list.fireevent = true;
			return;
		}
						
		// 유상판매 금지 항목에 대한 Alert 처리 2020.07.28 이동진 요청. Han J.H
		var chkSalesProhibit = false;
		
		chkSalesProhibit = chkSalesProhibitMatnr(ds_list.GetColumn(nRow, "MATNR"));
		
		if(chkSalesProhibit == true) {
			gfn_showAlert("CW10025", "해당 부품은 유상판매 불가 품목 입니다. 불가피하게 판매시 사유에 대해 '현장문제점보고서' 담당 결재본 유첨 바랍니다.");
		}
	}
	else
	{
		ds_list.fireevent = false;	
		ds_list.SetColumn(ds_ma_cond.GetColumn(0,"NROW"), "MATNR", "");
		ds_list.fireevent = true;
	}
}

/********************************************************************************
* 기      능   : 유상판매금지 자재 여부 체크
********************************************************************************/
function chkSalesProhibitMatnr(matnr) {
	tit_clearActionInfo();																	
	tit_addSearchActionInfo("cs01:CS0101008B_S21");									
	ds_prohibit_cond.ClearData();
	ds_prohibit_cond.AddRow();
	
	ds_prohibit_cond.SetColumn(0, "MATNR", matnr);
	
	// MATNR 없을 시 비즈니스 로직 타지 않도록 예외처리
	if(length(ds_prohibit_cond.GetColumn(0, "MATNR")) < 1) {
		return;
	}
	
	tit_callService(		
			""
			, ""							
			, "ds_prohibit_cond=ds_prohibit_cond"							
			, "ds_prohibit_result=ds_prohibit_result"						
			, ""
			, ""							
			, true							
			, false							
			, true);
			
	if(ds_prohibit_result.GetRowCount() > 0 && ds_prohibit_result.GetColumn(0,"MATNR") > 0 ) {
		return true;
	} else {
		return false;
	}
	
}

/********************************************************************************
* 기      능   : 메인 리스트의 내용을 클리어
********************************************************************************/
function ufn_clearDsList(nRow)
{
	if (ds_list.rowcount > 0)
	{
		ds_list.SetColumn(nRow,"MATNR",""); 									//자재번호
		ds_list.SetColumn(nRow,"MAKTX",""); 									//자재번호
		ds_list.SetColumn(nRow,"MATNRNM","");									//자재명
		ds_list.SetColumn(nRow,"JOBHOUR",""); 									//표준공수
		ds_list.SetColumn(nRow,"MAN",""); 										//투입인원
		ds_list.SetColumn(nRow,"MTART",""); 									//자재유형
		ds_list.SetColumn(nRow,"GEWEI",""); 									//자재단위
		ds_list.SetColumn(nRow,"MEINS",""); 									//기본단위
		ds_list.SetColumn(nRow,"MENGE",""); 									//수량
		ds_list.SetColumn(nRow,"OFRHOUR",""); 									//견적공수
		ds_list.SetColumn(nRow,"NETWR",""); 									//판매금액
		ds_list.SetColumn(nRow,"LCOSTS",""); 									//표준인건비
		ds_list.SetColumn(nRow,"LCOSTC",""); 									//계산인건비
		ds_list.SetColumn(nRow,"BWTAR","");										//평가유형
		ds_list.SetColumn(nRow,"NETPR","");										//판매단가
		ds_list.SetColumn(nRow,"UCOSTA",""); 									//정품원가
		ds_list.SetColumn(nRow,"UCOSTR",""); 									//수리품원가
		ds_list.SetColumn(nRow,"UPR",""); 										//원가인상율
		ds_list.SetColumn(nRow,"WEBAZ","");										//LEADTIME
	}
}

/********************************************************************************
* 기      능   : 비용 및 원가 내역을 산정
********************************************************************************/
function ufn_calcCostValues(callerId)
{	
	//자재삭제 후 비용 및 원가내역 삭제 반영처리 안됨
	
	if(ds_list.count <= 0 && callerId <> "bt_removeMaterial_OnClick")			//데이터가 입력되어있지 않으면 계산하지 않는다.
	{
		return;
	}
	
	if(cb_reqkind.value = "")													//청구구분을 선택해야 판가할인액 적용이 가능
	{
		if(callerId.length > 0 && DEBUG_FLAG)
		{
			gfn_showAlert("CW10025", "청구구분을 선택해주세요." + "\n" + "Caller:" + callerId);
		}
		else
		{
			gfn_showAlert("CW10025", "청구구분을 선택해주세요.");
		}
		return;
	}
	
	ds_list.fireevent = false;
	
	//변수를 선언한다.	
	var netwr_std, netwr_ofr, netwr_dc;											//자재판매가(표준), 자재판매가(견적), 판매가할인액
	var netwr_pct;																//판매할인율
	var lcost_std, lcost_ofr;													//인건비=설치비(표준), 인건비=설치비(견적)
	var weekend_wgt, night_wgt;													//휴일(철야)가치중치, 야간가중
	var exp_std, exp_ofr, exp_pct;												//제경비(표준), 제경비(견적), 제경비(적용비율)
	var mng_std, mng_ofr, mng_pct;												//관리비(표준), 관리비(견적), 관리비(적용비율)
	var pro_std, pro_ofr, pro_pct;												//기업이윤(표준), 기업이윤(견적), 기업이윤(적용비율)
	var sum_std, sum_ofr;														//합계(표준), 합계(견적)
	var id_rate;																//증감율
	var bil_amt = 0;															//기성예상비용

	//==================할인율관련 추가==============
	if (callerId != "ed_netwr_dc_OnChanged")
	{
		dcfix = '';
	}
	//===============================================
	
	//기초 금액을 산출한다.
	for(iCnt=0;iCnt < ds_list.Count;iCnt++)										
	{
		netwr_std += ds_list.getColumn(iCnt, "NETWR");
		netwr_ofr += ds_list.getColumn(iCnt, "NETWR");
		lcost_std += ds_list.getColumn(iCnt, "LCOSTS");
		lcost_ofr += ds_list.getColumn(iCnt, "LCOSTC");	
	}
	
	//DEBUG("ufn_calcCostValues", "lcost_std:"+lcost_std+"/lcost_ofr:"+lcost_ofr+"/netwr_std:"+netwr_std+"/netwr_ofr:"+netwr_ofr);
	
	//인건비에 휴일 및 철야 가중치를 적용한다.
	if(cb_reqkind.value == "7" || cb_reqkind.value == 'S')				    	//수리공사, 시스템공사
	{	
		chk_wgt = 1;
		if(chk_night.value > 1) chk_wgt = 1.5;
		if(chk_weekend.value > 1) chk_wgt = 2;
		
		lcost_std *= chk_wgt;
		lcost_ofr *= chk_wgt;
	}
	else																		//부품판매
	{
		lcost_std = 0;
		lcost_ofr = 0;
	}
	
	netwr_dc = toNumber(ed_netwr_dc.Value);										//판매할인액

	//부품판매(1)의 경우 견적금액 자재판매가에 판가할인액을 적용한다 / 수리공사(7)는 미적용
	if(cb_reqkind.value == "1")
	{
		//==================할인율관련 추가==============
		if(callerId == "bt_removeMaterial_OnClick" )  
		{
			netwr_ofr = netwr_ofr + netwr_dc;
			ed_netwr_dc.Value = '';  // 0  
		}
		//===============================================
		netwr_ofr -= netwr_dc;	
	}
	
	/*
	//견적금액 자자판가에 판매할인액을 적용한다 수리공사도 적용(20150209 최인식GJ)
	netwr_dc = toNumber(ed_netwr_dc.Value);
	netwr_ofr -= netwr_dc;	
	*/

	//제경비를 산정한다.
	if(cb_reqkind.value == "7" || cb_reqkind.value == 'S')						//수리공사, 시스템공사
	{	
		exp_pct = toNumber(ed_exp_pct.Value);
		exp_std = (netwr_std + lcost_std) * (exp_pct / 100);
		exp_ofr = (netwr_ofr + lcost_ofr) * (exp_pct / 100);
	}
	else																		//부품판매
	{
		exp_std = 0;
		exp_ofr = 0;
	}
	
	//DEBUG("ufn_calcCostValue", snetwr_std + ":" + netwr_ofr + ":" + lcost_std + ":" + lcost_ofr + ":" + exp_std + ":" + exp_ofr);	
	
	//관리비를 산정한다.
	if(cb_reqkind.value == "7" || cb_reqkind.value == 'S')						//수리공사, 시스템공사
	{		
		mng_pct = toNumber(ed_mng_pct.Value);
		mng_std = round((netwr_std + lcost_std + exp_std) * (mng_pct / 100), 0);
		mng_ofr = round((netwr_ofr + lcost_ofr + exp_ofr) * (mng_pct / 100), 0);
	}	
	else																		//부품판매
	{	
		mng_std = 0;
		mng_ofr = 0;
	}
		
	//기업이윤을 산정한다.
	if(cb_reqkind.value == "7" || cb_reqkind.value == 'S')						//수리공사, 시스템공사
	{		
		pro_pct = toNumber(ed_pro_pct.Value);
		pro_std = round((lcost_std + exp_std + mng_std)  * (pro_pct / 100), 0);
		pro_ofr = round((lcost_ofr + exp_ofr + mng_ofr)  * (pro_pct / 100), 0);
	}
	else																		//부품판매
	{
		pro_std = 0;
		pro_ofr = 0;
	}
	
	//합계를 산정한다.
	sum_std = (netwr_std + lcost_std + exp_std + mng_std + pro_std);
	sum_ofr = (netwr_ofr + lcost_ofr + exp_ofr + mng_ofr + pro_ofr);

	//수리공사,시스템공사의 경우 견적금액에 판가할인액을 적용한다
	if(cb_reqkind.value == "7" || cb_reqkind.value == 'S')
	{
		//==================할인율관련 추가==============
		if(callerId == "bt_removeMaterial_OnClick" )  
		{	
			sum_ofr = sum_ofr + netwr_dc;
			ed_netwr_dc.Value = '';  // 0  
		}
		//===============================================
		sum_ofr -= netwr_dc;
	}
	
	//판매할인율을 계산한다.
	netwr_pct = round(((sum_ofr - sum_std) / sum_std) * 100, 1);	
	
	//DEBUG("ufn_calcCostValues", "sum_ofr is " + sum_ofr + ", netwr_dc is " + netwr_dc + ", reqkind is " + cb_reqkind.value);
	
	//천단위 절사 (천단위 절사 disable - 201502081948 최선경sa)
	//sum_std = toInteger(sum_std / 1000) * 1000;
	//sum_ofr = toInteger(sum_ofr / 1000) * 1000;	
	
	//증감율을 계산한다.
	id_rate = round(((sum_ofr - sum_std) / sum_std) * 100, 1);
	
	//값을 텍스트박스에 채워넣는다.
	ed_netwr_std.text = netwr_std;												//자재판매가(표준)
	ed_netwr_ofr.text = netwr_ofr;												//자재판매가(견적)
	ed_lcost_std.text = lcost_std; 												//인건비(표준)
	ed_lcost_ofr.text = lcost_ofr;  											//인건비(견적)
	ed_exp_std.text = exp_std;													//제경비(표준)
	ed_exp_ofr.text = exp_ofr;													//제경비(견적)
	ed_mng_std.text = mng_std;													//일반관리비(표준)
	ed_mng_ofr.text = mng_ofr;													//일반관리비(견적)
	ed_pro_std.text = pro_std;													//기업이윤(표준)
	ed_pro_ofr.text = pro_ofr;													//기업이윤(견적)
	ed_sum_std.text = sum_std;													//합계(표준)
	ed_sum_ofr.text = sum_ofr;													//합계(견적)
	ed_id_rate.text = id_rate;													//증감율
	ed_netwr_pct.text = netwr_pct;  											//판매할인율
	
	//==================전현정대리요청 추가20181012==================//	
	
	if ( ed_sum_std.Value > 0 ) {
//ALERT("ed_sum_ofr : " + ed_sum_std.Value );	
//ALERT("ed_sum_std : " + ed_sum_std.Value );	
//ALERT("계산값 : " + sum_ofr / sum_std );
//ALERT("계산값 : " + ed_sum_ofr.Value / ed_sum_std.Value * 100);
		MaskEdit0.Value = round(sum_ofr / sum_std * 100, 1);
//ALERT("MaskEdit0 : " + MaskEdit0.Value );		
	} else {
		MaskEdit0.Value = 0 ;
	}
	//===============================================================//
	
	
	
	//----------------------------------------------------------------------
	//재료비(자재원가합계)를 계산한다.
	var ucost_sum = 0;
	
	for(iCnt=0;iCnt < ds_list.Count;iCnt++)
	{
		ucost_sum += ds_list.getColumn(iCnt, "UCOST");
	}

	//----------------------------------------------------------------------
	//ds_pjt_det의 tgb(직영/협력사 구분)에 따라 
	//부품판매(1)/수리공사(7)별 기성예상비용을 계산한다.	

	if(ds_pjt_det.GetColumn(0, "TGB") == 1)										//직영일 경우
	{
		if(cb_reqkind.value == "1")												//부품판매일경우 -> 직영 부품판매 기성예상비용 = 0
		{
			bil_amt = 0;
		}
		else if(cb_reqkind.value == "7" || cb_reqkind.value == 'S')				//수리공사일 경우 -> 직영 수리공사 기성예상비용 = 수량*투입인원*표준공수*수리공사임율
		{
			for(iCnt=0;iCnt < ds_list.Count;iCnt++)
			{
				bil_amt += toNumber(ds_list.getColumn(iCnt, "MENGE"))
				                * toNumber(ds_list.getColumn(iCnt, "MAN"))
				                * toNumber(ds_list.getColumn(iCnt, "JOBHOUR"))
				                * toNumber(ds_pjt_det.getColumn(0, "RATE2"));	//기성예상비용 공사임율 적용
			}
		}	
		else
		{
			bil_amt = 0;
		}
	}
	else																		//협력사일 경우
	{	
		if(cb_reqkind.value == "1")												//부품판매일 경우 -> 협력사 부품판매 기성예상비용 = 자재판매가*10% + (수주금액(판매금액합계) - 일식외주(ZMMT011에 입력예정. 미정)*1.08) - 자재판매가 * 65%
		{
			bil_amt = ((sum_ofr * 0.8) / 1.3) - ucost_sum;						
			if(bil_amt <= 100000) bil_amt = 0; 									//10만원 미만일 경우 지급하지 않는다.
			if(bil_amt >= sum_ofr * 0.3) bil_amt = round(sum_ofr * 0.3, 0);		//수주금액의 30%가 초과될경우 수주금액의 30%로 제한한다.
		}	
		else if(cb_reqkind.value == "7")				//수리공사일 경우 -> 협력사 수리공사 기성예상비용 = (수주금액*80%)/1.3(일반관리비)) - 자재비(인상원가)
		{ 
			// 인상 판매가 > 견적금액 인 경우 		
			if(toNumber(ed_netwr_ofr.Value) > toNumber(ed_sum_ofr.Value)) {
				bil_amt = (netwr_ofr * 0.15) ;
			} else {

				bil_amt = (netwr_ofr * 0.15) + ((sum_ofr - netwr_ofr) * 0.75);
			}		
		}
		else
		{	// 시스템공사 외에 기성예상 비용 0
			bil_amt = 0;
		}
	}
	
	bil_amt = round(bil_amt, 0);
	ed_bil_amt.text = bil_amt;			//기성예상비용	
	
	//----------------------------------------------------------------------
	//원가내역을 계산한다.
	//	인건비	, 	일반노무비,	일식외주,  	운반비		직접비계		간접비		총원가			원가율
	var p_reqkind = cb_reqkind.Value ;
	var p_spart   = cb_spartnm.Value ;
	var ch_lcost, ch_labor  ,ch_log  ,ch_inspec  ,ch_etc ; // 추가 입력항목
	var his_lcost, 	his_labor, 	his_oem, 	his_log, 	his_dirsum, 	his_indsum, his_totcost, 	his_his_rate;	
	var his_inspec, his_etc;
	
	// 표준 원가산출 
	var std_cal_cost_add = gfn_calculate_cost( p_reqkind
	                                         , p_spart
	                                         , ucost_sum
	                                         , bil_amt
	                                         , sum_ofr
	                                         , netwr_ofr
	                                         , 0
											 , 0
											 , 0
											 , 0
											 , 0 
											 //==================전현정대리요청 추가20181012==================//
											 , 0
											 , 0
											 , 0
											 , 0 
											 //===============================================================//
											 , ds_ind ); 
	var his_list = split(std_cal_cost_add, "^", true);
	
	ed_his_ucost.text   = his_list[0];
	ed_his_lcost.text   = his_list[1];
	ed_his_oem.text     = his_list[2];
	ed_his_inspec.text  = his_list[3];
	ed_his_log.text     = his_list[4];
	ed_his_etc.text     = his_list[5];
	ed_his_labor.text   = his_list[6];
	ed_his_dirsum.text  = his_list[7];
	ed_his_indsum.text  = his_list[8];
	ed_his_totcost.text = his_list[9];
	ed_his_rate.text    = his_list[10];
	//==================전현정대리요청 추가20181012==================//
	ed_his_betc.text    = his_list[11];  //건축부대
	ed_his_lift.text    = his_list[12];  //양중비
	ed_his_mmod.text    = his_list[13];  //무상mod
	ed_his_safe.text    = his_list[14];  //안전관리비
	
	ed_his_dlab.text    = his_list[15];  //직접노무비
	ed_his_emacid.text  = his_list[16];  //고용산재
	
	ed_his_ucost_ss.text  = his_list[17];  //재료비계
	ed_his_lab_ss.text 	  = his_list[18];  //노무비계
	ed_his_etc_ss.text    = his_list[19];  //경비계
	ed_his_indsum_ss.text = his_list[20];  //간접비(기타)계
	ed_his_log_ss.text    = his_list[21];  //운반비계
	ed_his_ore_ss.text    = his_list[22];  //외주비계
	ed_his_inspec_ss.text = his_list[23];  //검사비계
	//===============================================================//	
	
	
	// 추가금액 셋팅
	var his_ucost_add  = ed_his_ucost_ch.Value;
	var his_lcost_add  = ed_his_lcost_ch.Value;
	var his_inspec_add = ed_his_inspec_ch.Value;
	var his_log_add    = ed_his_log_ch.Value;
	var his_etc_add    = ed_his_etc_ch.Value;
	//==================전현정대리요청 추가20181012==================//
	var his_betc_add    = ed_his_betc_ch.Value;  //건축부대
	var his_lift_add    = ed_his_lift_ch.Value;  //양중비
	var his_mmod_add    = ed_his_mmod_ch.Value;  //무상mod
	var his_safe_add    = ed_his_safe_ch.Value;  //안전관리비
	//===============================================================//
	// 추가금액 적용 원가산출 
	var add_cal_cost_add = gfn_calculate_cost( p_reqkind
	                                         , p_spart
	                                         , ucost_sum
	                                         , bil_amt
	                                         , sum_ofr
	                                         , netwr_ofr
	                                         , his_ucost_add
											 , his_lcost_add
											 , his_inspec_add
											 , his_log_add
											 , his_etc_add 
											 //==================전현정대리요청 추가20181012==================//
											 , his_betc_add
											 , his_lift_add
											 , his_mmod_add
											 , his_safe_add 
											 //===============================================================//
											 , ds_ind ); 
	var his_final_list = split(add_cal_cost_add, "^", true);
	
	ed_his_ucost_fn.text   = his_final_list[0];
	ed_his_lcost_fn.text   = his_final_list[1];
	//ed_his_oem_fn.text     = his_final_list[2];
	ed_his_inspec_fn.text  = his_final_list[3];
	ed_his_log_fn.text     = his_final_list[4];
	ed_his_etc_fn.text     = his_final_list[5];
	ed_his_labor_fn.text   = his_final_list[6];
	ed_his_dirsum_fn.text  = his_final_list[7];
	ed_his_indsum_fn.text  = his_final_list[8];
	ed_his_totcost_fn.text = his_final_list[9];
	ed_his_rate_fn.text    = his_final_list[10];
	//==================전현정대리요청 추가20181012==================//
	ed_his_betc_fn.text    = his_final_list[11];  //건축부대
	ed_his_lift_fn.text    = his_final_list[12];  //양중비
	ed_his_mmod_fn.text    = his_final_list[13];  //무상mod
	ed_his_safe_fn.text    = his_final_list[14];  //안전관리비
		
	ed_his_dlab_fn.text    = his_final_list[15];  //직접노무비
	ed_his_emacid_fn.text  = his_final_list[16];  //고용산재	
	
	ed_his_ucost_fn_ss.text  = his_final_list[17];  //재료비계
	ed_his_lab_fn_ss.text 	 = his_final_list[18];  //노무비계
	ed_his_etc_fn_ss.text    = his_final_list[19];  //경비계
	ed_his_indsum_fn_ss.text = his_final_list[20];  //간접비(기타)계
	ed_his_log_fn_ss.text    = his_final_list[21];  //운반비계
	ed_his_ore_fn_ss.text    = his_final_list[22];  //외주비계
	ed_his_inspec_fn_ss.text = his_final_list[23];  //검사비계		
	//===============================================================//
	
	
	//----------------------------------------------------------------------
	//계산서 발행금액을 설정한다.
	// me_bilamt1.value = sum_ofr;
	// chk_spbill.Value = 0;
	chk_spbill_OnClick();
	
	//----------------------------------------------------------------------
	//전결규정을 설정한다.
	ufn_setRegulation();
	
	//----------------------------------------------------------------------
	//견적가에 따른 견적서/부품요청서 출력 조건 설정(현재 700만원이하는 모두)
	ufn_setPrintOfr();
	
	//----------------------------------------------------------------------
	//자재별 최종견적가를 설정한다.
	ufn_setMatAmount();																
	
	ds_list.fireevent = true;
}

/********************************************************************************
* 기      능   : 견적서/부품요청서 출력 가능 조건 설정
********************************************************************************/
function ufn_setPrintOfr()
{
	if(ds_out_master.GetColumn(0, "ENDYN") == "Y")	//종료된 견적일 경우
	{
		return;
	}
	
	if(toNumber(ed_sum_ofr.value) <= 7000000)									//700만원 이하는 견적서/부품요청서 출력이 언제든 가능
	{
		ufn_setObjectVisibility("btn_print_ofr", true);							//견적서출력 enable
		ufn_setObjectVisibility("btn_print_req", true);							//부품요청서출력 enable
	}
	else if(toNumber(ed_sum_ofr.value) > 7000000 && toNumber(ed_sum_ofr.value) <= 10000000 && toNumber(ed_netwr_dc) <= 0)
	{
		ufn_setObjectVisibility("btn_print_ofr", true);							//견적서출력 enable
		ufn_setObjectVisibility("btn_print_req", true);							//부품요청서출력 enable
	}
	else            						//700만원 초과일경우 원래의 상태로 변경한다.
	{
		ufn_setObjectVisibility("btn_print_ofr", orgPrintFlag);					//견적서출력 enable
		ufn_setObjectVisibility("btn_print_req", orgPrintFlag);					//부품요청서출력 enable		
	}
}


/********************************************************************************
* 기      능   : 전결규정을 설정한다.
change log :  전결규정 변경 201610
********************************************************************************/
function ufn_setRegulation()
{
	var reqkind = cb_reqkind.Value ; // 청구구분
	var spart   = cb_spartnm.Value ; //  제품군

	his_rate = toNumber(ed_his_rate_fn2.Value);									//시행율 최종시행율로 변경
	sum_ofr = toNumber(ed_sum_ofr.Value);										//견적가
	sum_std = toNumber(ed_sum_std.Value);										//판매가

	var rto = round(((sum_ofr/sum_std) * 100)) ; // 수주율 ( 판매가 대비 견적가 )
//	DEBUG("ufn_setRegulation", "his_rate is " + his_rate + ", sum_ofr is " + sum_ofr + ", directFlag is " + directFlag);
	if(reqkind == "1") // 부품
	{
		/* 2020.08.03 변경전
		if(sum_ofr <= 50000000) // 5천만원 이하
		{
			if(rto < 90)        ed_reg.Text = "부문장 전결";
			else if(rto  <  95) ed_reg.Text = "담당 전결";
			else if(rto  < 100) ed_reg.Text = "팀장 전결";
			else if(rto >= 100) ed_reg.Text = "지사장 전결";
			else ed_reg.Text = "(전결규정)";	
			
		} else                 // 5천만원 초과
		{
			if(rto < 90)        ed_reg.Text = "부문장 전결";
			else if(rto  <  95) ed_reg.Text = "담당 전결";
			else if(rto  < 100) ed_reg.Text = "팀장 전결";
			else if(rto >= 100) ed_reg.Text = "지사장 전결";
			else ed_reg.Text = "(전결규정)";	
			
		}
		// CFO 확인 
		// 1억 초과 판매가 대비 90 %  
		if(sum_ofr > 100000000 && rto < 90) ed_reg_cfo.Text = "CFO 확인";
		*/
		//====================================변경 후 2020.08.03==================================================================
		//====================================최선경 팀원 요청으로 변경. 금액기준 없어짐==========================================
		if(rto < 90) {                    // 판매가 대비 90% 미만
			ed_reg.Text = "본부장 전결";
		} else if(rto < 95) {             // 판매가 대비 90%이상 ~ 95% 미만
			ed_reg.Text = "담당 전결";
		} else if(rto >= 95) {            // 판매가 대비 95% 이상
			ed_reg.Text = "지사장(팀장) 전결";
		} else {
			"(전결규정)";
		}
		// 재경본부장 확인 
		// 1억 초과 판매가 대비 90 % 미만시
		if(sum_ofr > 100000000 && rto < 90) ed_reg_cfo.Text = "재경본부장 확인";		
		//========================================================================================================================
		
	} else if (reqkind == "7")  // 수리
	{
		/* 2020.08.03 변경전
		if(sum_ofr <= 50000000) // 5천만원 이하
		{		
			if(spart == "10") // 승강기
			{
				if(his_rate > 85)       ed_reg.Text = "부문장 전결";
				else if(his_rate  > 80) ed_reg.Text = "담당 전결";
				else if(his_rate  > 75) ed_reg.Text = "팀장 전결";
				else if(his_rate <= 75) ed_reg.Text = "지사장 전결";
				else ed_reg.Text = "(전결규정)";	
				
			} else if(spart == "20") // 주차
			{				
				if(his_rate > 90)       ed_reg.Text = "부문장 전결";
				else if(his_rate  > 85) ed_reg.Text = "담당 전결";
				else if(his_rate  > 80) ed_reg.Text = "팀장 전결";
				else if(his_rate <= 80) ed_reg.Text = "지사장 전결";
				else ed_reg.Text = "(전결규정)";	
				
			} else {
				ed_reg.Text = "(전결규정)";
			}			
			
		} else                 // 5천만원 초과
		{
			if(spart == "10") // 승강기
			{
				if(his_rate > 80)       ed_reg.Text = "부문장 전결";
				else if(his_rate  > 75) ed_reg.Text = "담당 전결";
				else if(his_rate  > 80) ed_reg.Text = "팀장 전결";
				else if(his_rate <= 80) ed_reg.Text = "지사장 전결";
				else ed_reg.Text = "(전결규정)";
				
			} else if(spart == "20") // 주차
			{		
				if(his_rate > 90)       ed_reg.Text = "부문장 전결";
				else if(his_rate  > 85) ed_reg.Text = "담당 전결";
				else if(his_rate  > 80) ed_reg.Text = "팀장 전결";
				else if(his_rate <= 80) ed_reg.Text = "지사장 전결";
				else ed_reg.Text = "(전결규정)";	
				
			} else {
				ed_reg.Text = "(전결규정)";
			}					
		}
		// CFO 확인 
		if(spart == "10") // 승강기
		{
			// 1억 초과 시행율 85% 초과 
			if(sum_ofr > 100000000 && his_rate > 85) ed_reg_cfo.Text = "CFO 확인";
		} else if(spart == "20") // 주차
		{		
			// 2억 초과 시행율 98% 초과 
			if(sum_ofr > 200000000 && his_rate > 98) ed_reg_cfo.Text = "CFO 확인";
		}
		*/
		//====================================변경 후 2020.08.03==================================================================
		//====================================최선경 팀원 요청으로 변경. 금액기준 없어짐==========================================
		//====================================2020.08.19 일반 및 일식외주 구분값 추가. 주차의 경우 유지===========================
		if(ds_out_master.GetColumn(0,"ILSIC_YN") == "1") {
			// 수리공사 일식외주
			if(spart == "10") { // 승강기
				if(his_rate > 95)       ed_reg.Text = "본부장 전결";       // 시행율 95% 초과
				else if(his_rate  > 90) ed_reg.Text = "담당 전결";         // 시행율 90% 초과 ~ 95% 이하
				else if(his_rate <= 90) ed_reg.Text = "지사장(팀장) 전결"; // 시행율 90% 이하
				else ed_reg.Text = "(전결규정)";
			} else if(spart == "20") { // 주차
				if(his_rate > 90)       ed_reg.Text = "본부장 전결";
				else if(his_rate  > 85) ed_reg.Text = "담당 전결";
				else if(his_rate  > 80) ed_reg.Text = "팀장 전결";
				else if(his_rate <= 80) ed_reg.Text = "지사장 전결";
				else ed_reg.Text = "(전결규정)";		
			} else {
				ed_reg.Text = "(전결규정)";
			}
			// 재경본부장 확인
			if(spart == "10") // 승강기
			{
				// 2억 초과 시행율 95% 초과 (일식외주)
				if(sum_ofr > 200000000 && his_rate > 95) ed_reg_cfo.Text = "재경본부장 확인";
			} else if(spart == "20") // 주차
			{		
				// 2억 초과 시행율 98% 초과 
				if(sum_ofr > 200000000 && his_rate > 98) ed_reg_cfo.Text = "재경본부장 확인";
			}			
		} else if(ds_out_master.GetColumn(0,"ILSIC_YN") == "0") {
			// 수리공사 일반
			if(spart == "10") { // 승강기
				if(his_rate > 80)       ed_reg.Text = "본부장 전결";       // 시행율 80% 초과
				else if(his_rate  > 75) ed_reg.Text = "담당 전결";         // 시행율 75% 초과 ~ 80% 이하
				else if(his_rate <= 75) ed_reg.Text = "지사장(팀장) 전결"; // 시행율 75% 이하
				else ed_reg.Text = "(전결규정)";
			} else if(spart == "20") { // 주차
				if(his_rate > 90)       ed_reg.Text = "본부장 전결";
				else if(his_rate  > 85) ed_reg.Text = "담당 전결";
				else if(his_rate  > 80) ed_reg.Text = "팀장 전결";
				else if(his_rate <= 80) ed_reg.Text = "지사장 전결";
				else ed_reg.Text = "(전결규정)";		
			} else {
				ed_reg.Text = "(전결규정)";
			}
			// 재경본부장 확인
			if(spart == "10") // 승강기
			{
				// 1억 초과 시행율 85% 초과 (일반)
				if(sum_ofr > 100000000 && his_rate > 85) ed_reg_cfo.Text = "재경본부장 확인";
			} else if(spart == "20") // 주차
			{		
				// 2억 초과 시행율 98% 초과 
				if(sum_ofr > 200000000 && his_rate > 98) ed_reg_cfo.Text = "재경본부장 확인";
			}
		}
		//========================================================================================================================
	} else if (reqkind == "S") // 시스템 
	{
	
		if(spart == "10") // 승강기	
		{
			//if(cb_modgbn.Value == "M4"){ //  MOD Package 4 이상 
			if(cb_modgbn.Value >= "M4"){ //  MOD Package 4 이상 
			
				if(sum_ofr <= 300000000) // 3억원 이하
				{
					if(his_rate > 100)      ed_reg.Text = "본부장 전결";
					else if(his_rate  > 95) ed_reg.Text = "담당 전결";
					else if(his_rate  > 90) ed_reg.Text = "팀장 전결";
					else if(his_rate <= 90) ed_reg.Text = "지사장 전결";
					else ed_reg.Text = "(전결규정)";	
					
				} else                 // 3억원 초과
				{
					if(his_rate > 100)      ed_reg.Text = "본부장 전결";
					else if(his_rate  > 95) ed_reg.Text = "담당 전결";
					else if(his_rate <= 95) ed_reg.Text = "팀장 전결";
					else ed_reg.Text = "(전결규정)";	
				}
				// CFO 확인 
				// 3억 초과 시행율 100% 초과 
				if(sum_ofr > 300000000 && his_rate > 105) ed_reg_cfo.Text = "CFO 확인";
				
			} else { // MOD Package 4 이하
			
				//if(sum_ofr <= 300000000) // 2억원 이하
				if(sum_ofr <= 200000000) // 2억원 이하
				{
					if(his_rate > 95)       ed_reg.Text = "본부장 전결";
					else if(his_rate  > 90) ed_reg.Text = "담당 전결";
					else if(his_rate  > 85) ed_reg.Text = "팀장 전결";
					else if(his_rate <= 85) ed_reg.Text = "지사장 전결";
					else ed_reg.Text = "(전결규정)";	
					
				} else                 // 2억원 초과
				{
					if(his_rate > 90)       ed_reg.Text = "본부장 전결";
					else if(his_rate  > 85) ed_reg.Text = "담당 전결";
					else if(his_rate <= 85) ed_reg.Text = "팀장 전결";
					else ed_reg.Text = "(전결규정)";	
				}
				// CFO 확인 
				// 3억 초과 시행율 100% 초과 
				if(sum_ofr > 300000000 && his_rate > 100) ed_reg_cfo.Text = "CFO 확인";
				
			}
		
		
		} else if(spart == "20") // 주차
		{
			if(sum_ofr <= 100000000) // 1억원 이하
			{
				if(his_rate > 95)       ed_reg.Text = "본부장 전결";
				else if(his_rate  > 90) ed_reg.Text = "담당 전결";
				else if(his_rate  > 85) ed_reg.Text = "팀장 전결";
				else if(his_rate <= 85) ed_reg.Text = "지사장 전결";
				else ed_reg.Text = "(전결규정)";	
					
			} else                 // 1억원 초과
			{
				if(his_rate > 95)       ed_reg.Text = "본부장 전결";
				else if(his_rate  > 90) ed_reg.Text = "담당 전결";
				else if(his_rate <= 90) ed_reg.Text = "팀장 전결";
				else ed_reg.Text = "(전결규정)";
			}
			// CFO 확인 
			// 2억 초과 시행율 98% 초과 
			if(sum_ofr > 200000000 && his_rate > 98) ed_reg_cfo.Text = "CFO 확인";

		} else {
			ed_reg.Text = "(전결규정)";
		}

	}
	
	//전결규정
	ed_reg.enable = true;
	ed_reg.color = "gray";
	ed_reg.bkColor = "#E9E9E9";
	ed_reg.readOnly = true;
	ed_reg.ToolTipText = "1. [부품판매]1억원 초과&판매가 대비 90% 미만시, 재경본부장 확인\n" +
						 "   [수리공사-일반]1억원 초과&시행율 85% 초과시, 재경본부장 확인\n"  +
						 "   [수리공사-일식외주]2억원 초과&시행율 95% 초과시, 재경본부장 확인\n"  +
						 "   [MOD]2억원 초과&시행율 95% 초과시, 재경본부장 확인\n"  +
						 "2. 전결처리한 것은 월단위 집계하여 차상위자에게 보고"  ;
}

/********************************************************************************
* 기      능   : ds_list의 값들을 계산한다.
********************************************************************************/
function ufn_calcListValues(nRow)
{
	//ds_list.fireevent = false;

	//판매금액(수량*단가)을 계산한다.
	ds_list.SetColumn(nRow, "NETWR", ds_list.GetColumn(nRow, "MENGE") * ds_list.GetColumn(nRow, "NETPR"));
	
	//인건비를 계산한다.
	var lcosts = 0; 															//표준인건비
	var lcostc = 0;																//계산인건비
	//  RATE 견적 공사 입율
	lcosts = 	toNumber(ds_list.GetColumn(nRow, "MENGE")) * 
				toNumber(ds_list.GetColumn(nRow, "MAN")) * 
				toNumber(ds_list.GetColumn(nRow, "JOBHOUR")) * 
				toNumber(ds_out_master.GetColumn(0, "RATE"));
	lcostc =	toNumber(ds_list.GetColumn(nRow, "MENGE")) * 
				toNumber(ds_list.GetColumn(nRow, "MAN")) * 
				toNumber(ds_list.GetColumn(nRow, "OFRHOUR")) * 
				toNumber(ds_out_master.GetColumn(0, "RATE"));

	ds_list.SetColumn(nRow, "LCOSTS", lcosts);
	ds_list.SetColumn(nRow, "LCOSTC", lcostc);

	//자재원가를 계산한다.
	var ucost = 0;
	if(ds_list.GetColumn(nRow, "BWTAR") == "PA" || 								//정품일 경우 - 정품원가 + (정품원가 * (인상율 / 100))
				ds_list.GetColumn(nRow, "BWTAR") == "HA" || 
				ds_list.GetColumn(nRow, "BWTAR") == "RA")
	{
		ucost = ds_list.GetColumn(nRow, "UCOSTA") + 
				(ds_list.GetColumn(nRow, "UCOSTA") * 
				(ds_list.GetColumn(nRow, "UPR") / 100));
	}
	else if(ds_list.GetColumn(nRow, "BWTAR") == "PB" || 						//수리품일 경우 - 수리품원가 + (수리품원가 * (인상율 / 100))
				ds_list.GetColumn(nRow, "BWTAR") == "HB" || 
				ds_list.GetColumn(nRow, "BWTAR") == "RB")
	{
		ucost = ds_list.GetColumn(nRow, "UCOSTR") + 
				(ds_list.GetColumn(nRow, "UCOSTR") * 
				(ds_list.GetColumn(nRow, "UPR") / 100));
	}
	else																		//반납자재일 경우
	{
		ucost = 0;
	}
	
	ucost = ucost * ds_list.GetColumn(nRow, "MENGE");							//원가에 수량을 곱해준다(견적전체원가)
	ds_list.SetColumn(nRow, "UCOST", round(ucost, 0));							//데이터리스트의 원가 컬럼에 원가를 설정한다.

	//ds_list.fireevent = true;
}


/********************************************************************************
* 기      능   : 환경변수/전역변수 등을 출력한다.
********************************************************************************/
function SHOW_ENV()
{
	var strDate = GetDate();
	strDate = Mid(strDate,0,4) + "/" + Mid(strDate,4,2) + "/" + Mid(strDate,6,2) + " " + 
	          Mid(strDate,8,2) + ":" + Mid(strDate,10,2) + ":" + Mid(strDate,12,2);

	Trace("-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= Startup  Information =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-");
	Trace("Program ID : " + this.title);
	Trace("Start Date & Time : " + strDate);
	Trace("-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= Global Variables =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-");
	Trace("G_AREA_CODE:사무소 코드/지역 코드) is [" + G_AREA_CODE + "]");
	Trace("G_AREA_CODE_B:영업지사 코드/영업지역 코드) is [" + G_AREA_CODE_B + "]");
	Trace("G_AREA_CODE_E:설치사무소 코드/설치지역 코드) is [" + G_AREA_CODE_E + "]");
	Trace("G_AREA_CODE_R:보수사무소 코드/보수지역 코드) is [" + G_AREA_CODE_R + "]");
	Trace("G_AREA_NAME:지역명/업체지역명) is [" + G_AREA_NAME + "]");
	Trace("G_CURR_DATE:현재시간/현재일자) is [" + G_CURR_DATE + "]");
	Trace("G_DPT1:부서코드/부서코드) is [" + G_DPT1 + "]");
	Trace("G_EMAIL:전자우편 주소/EMAIL) is [" + G_EMAIL + "]");
	Trace("G_EXPR_DATE:비밀번호 만료 일자 /만료일자) is [" + G_EXPR_DATE + "]");
	Trace("G_LANG:사용 언어/사용자 LANG(ko-한국, zh-중국, en-영문) ) is [" + G_LANG + "]");
	Trace("G_LGORT:저장위치/업체-저장위치) is [" + G_LGORT + "]");
	Trace("G_LOGIN_TIME:로그인 시간/현재시간(?)) is [" + G_LOGIN_TIME + "]");
	Trace("G_LOGOUT:로그아웃 구분(1:정상, 0:오류)/) is [" + G_LOGOUT + "]");
	Trace("G_MANDT:Mandt 설정 /SAP CLIENT) is [" + G_MANDT + "]");
	Trace("G_ORG_USER_INFO:원 사용자 ID/사용자 변경시 원 정보 저장) is [" + G_ORG_USER_INFO + "]");
	Trace("G_ORG_VEND_CODE:사원 변경시 사용/업체코드2(현대 ELV) 사용자인 경우)) is [" + G_ORG_VEND_CODE + "]");
	Trace("G_ORG_VEND_CODE_B:사원 변경시 사용/업체코드2(현대 ELV) 사용자인 경우)) is [" + G_ORG_VEND_CODE_B + "]");
	Trace("G_ORG_VEND_CODE_E:사원 변경시 사용/업체코드2(현대 ELV) 사용자인 경우)) is [" + G_ORG_VEND_CODE_E + "]");
	Trace("G_ORG_VEND_CODE_M:사원 변경시 사용/업체코드2(현대 ELV) 사용자인 경우)) is [" + G_ORG_VEND_CODE_M + "]");
	Trace("G_ORG_VEND_CODE_R:사원 변경시 사용/업체코드2(현대 ELV) 사용자인 경우)) is [" + G_ORG_VEND_CODE_R + "]");
	Trace("G_SAP_USER_ID:/) is [" + G_SAP_USER_ID + "]");
	Trace("G_SAP_USER_NAME:/) is [" + G_SAP_USER_NAME + "]");
	Trace("G_SAP_USER_PM_B:PM(영업)/PM(영업)) is [" + G_SAP_USER_PM_B + "]");
	Trace("G_SAP_USER_PM_R:PM(보수)/) is [" + G_SAP_USER_PM_R + "]");
	Trace("G_SAP_USER_PMNM_B:PM명(영업)/PM명(영업)) is [" + G_SAP_USER_PMNM_B + "]");
	Trace("G_SAP_USER_PMNM_R:PM명(보수)/) is [" + G_SAP_USER_PMNM_R + "]");
	Trace("G_SAP_USER_VBCD:SAP 부서코드/SAP용 부서코드) is [" + G_SAP_USER_VBCD + "]");
	Trace("G_SAP_USER_VBNM:SAP 부서명/SAP용 부서명) is [" + G_SAP_USER_VBNM + "]");
	Trace("G_SAP_USER_VGCD:SAP 팀코드/SAP용 팀코드) is [" + G_SAP_USER_VGCD + "]");
	Trace("G_SAP_USER_VGNM:SAP 팀명  /SAP용 팀명) is [" + G_SAP_USER_VGNM + "]");
	Trace("G_SERVER_URL:서버경로/) is [" + G_SERVER_URL + "]");
	Trace("G_SESSION_ID:세션ID /세션ID) is [" + G_SESSION_ID + "]");
	Trace("G_SYSTEM:시스템 구분 /시스템 구분(D-개발, Q-품질, P-운영)) is [" + G_SYSTEM + "]");
	Trace("G_USERMBPN:H.P/) is [" + G_USERMBPN + "]");
	Trace("G_USERTELE:전화번호/) is [" + G_USERTELE + "]");
	Trace("G_USER_GROUP:권한/사용자 그룹) is [" + G_USER_GROUP + "]");
	Trace("G_USER_GROUP_B:영업권한 /사용자 그룹) is [" + G_USER_GROUP_B + "]");
	Trace("G_USER_GROUP_E:설치권한/사용자 그룹) is [" + G_USER_GROUP_E + "]");
	Trace("G_USER_GROUP_M:자재권한/사용자 그룹) is [" + G_USER_GROUP_M + "]");
	Trace("G_USER_GROUP_R:보수권한/사용자 그룹) is [" + G_USER_GROUP_R + "]");
	Trace("G_USER_ID:사용자 id/사용자 ID) is [" + G_USER_ID + "]");
	Trace("G_USER_NAME:사용자명/사용자 명) is [" + G_USER_NAME + "]");
	Trace("G_VEND_CODE:업체코드/업체코드) is [" + G_VEND_CODE + "]");
	Trace("G_VEND_CODE_B:업체코드(영업)/업체코드(영업)) is [" + G_VEND_CODE_B + "]");
	Trace("G_VEND_CODE_E:업체코드(설치)/업체코드(설치)) is [" + G_VEND_CODE_E + "]");
	Trace("G_VEND_CODE_M:업체코드(자재)/업체코드(자재)) is [" + G_VEND_CODE_M + "]");
	Trace("G_VEND_CODE_R:업체코드(보수)/업체코드(보수)) is [" + G_VEND_CODE_R + "]");
	Trace("G_VEND_NAME:업체명/업체명) is [" + G_VEND_NAME + "]");
	Trace("G_VEND_WGBN:업체구분/업체구분(A:설치협력사, B:보수협력사, C:국내대리점, D:자재협력사, E:해외대리점)) is [" + G_VEND_WGBN + "]");
	Trace("G_WEBGUI_URL:WEB-GUI URL 정보/WEB GUI 정보) is [" + G_WEBGUI_URL + "]");
	Trace("-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-");
}
/********************************************************************************
* 기      능   : 디버그 문자열을 trace로 출력한다.
********************************************************************************/
function DEBUG(srcFunc, outStr)
{
	var outputString = "";

    outputString = "DEBUG " + 
				  this.title + " " + 
				  substr(getDate(), 8, 2) + ":" + 
				  substr(getDate(), 10, 2) + ":" + 
				  substr(getDate(), 12, 2) + ">";
	
	if(DEBUG_FLAG)
	{
		if(outStr.length == 0)
		{	
			outputString += srcFunc;
		}
		else
		{
			outputString += srcFunc + "() - " + outStr;
		}
	
		trace(outputString);
	}
}

/********************************************************************************
* 기      능   : 원가관련 항목을 감춘다.
********************************************************************************/
function ufn_hideUnitCostComponents()
{
	var comps = Components;

//==================전현정대리요청 추가20181012==================//

	for(iCnt=0;iCnt < comps.count();iCnt++)
	{
		//DEBUG("ufn_hideUnitCostComponents", comps[iCnt].ID + ":" + indexOf(comps[iCnt].ID, "st_adm"));
		//==================전현정대리요청 추가20181012==================//
		/*
		if(indexOf(comps[iCnt].ID, "st_adm") >= 0 || 
				indexOf(comps[iCnt].ID, "ed_h") >= 0 || 
				indexOf(comps[iCnt].ID, "ed_tc") >= 0 ||
				indexOf(comps[iCnt].ID, "st_office") >= 0 )
		{
			comps[iCnt].visible = false;
		}
		*/
		
		if( indexOf(comps[iCnt].ID, "ed_h") >= 0 || indexOf(comps[iCnt].ID, "ed_tc") >= 0  ||
		    indexOf(comps[iCnt].ID, "st_adm") >= 0 || indexOf(comps[iCnt].ID, "st_new_office") >= 0 
		  )
		{
			comps[iCnt].visible = false;
		}
		
		//===============================================================//
	}
		

//===============================================================//
	

	//관리자 이외에는 원가 및 설정, 디버깅 관련 항목들을 볼 수 없도록 한다.
	for(var iCnt = 21; iCnt < grd_list.GetCellCount("BODY");iCnt++)
	{
		grd_list.SetCellProp("Head", iCnt, "Display", "null");						//20:자재원가
		grd_list.SetCellProp("Body", iCnt, "Display", "null");
		grd_list.ChangeColWidth("", iCnt, 0);
	}
}
/********************************************************************************
* 기      능   : 시행예산항목 공개 
********************************************************************************/
function ufn_showUnitCostComponents()
{
	var comps = Components;

	for(iCnt=0;iCnt < comps.count();iCnt++)
	{
		//==================전현정대리요청 추가20181012==================//
		/*
		if(indexOf(comps[iCnt].ID, "st_office") >= 0 || 
				indexOf(comps[iCnt].ID, "_ch") >= 0  ||
				comps[iCnt].ID ==  "ed_his_rate_fn2")
		{
			comps[iCnt].visible = true;
		}
		*/	
		if( indexOf(comps[iCnt].ID, "_ch") >= 0    || comps[iCnt].ID ==  "ed_his_rate_fn2"  || 
		    comps[iCnt].ID ==  "ed_his_ore_ss"     || comps[iCnt].ID ==  "ed_his_ore_fn_ss" || comps[iCnt].ID ==  "ed_his_totcost" || 
		    comps[iCnt].ID ==  "ed_his_totcost_fn" || comps[iCnt].ID ==  "ed_his_rate"      || comps[iCnt].ID ==  "ed_his_rate_fn" || 
		    comps[iCnt].ID ==  "ed_his_netwr"      || comps[iCnt].ID ==  "ed_his_netwr_fn"  ||
		    indexOf(comps[iCnt].ID, "st_new_office") >= 0 
		    )
		{
			comps[iCnt].visible = true;
		}		
		//===============================================================//

	}
}
/********************************************************************************
* 기      능   : enable 상태인 컴포넌트의 이름을 저장한다.
********************************************************************************/
function ufn_saveEnabledComponents()
{
	var comps = Components;														//form의 component collection 
	var compCnt = 0;															//갯수 카운트
	
	//컴포넌트 수 카운트
	for(iCnt=0;iCnt < comps.count();iCnt++)
	{
		if(comps[iCnt].GetType() == "MaskEdit" 
			|| comps[iCnt].GetType() == "Combo" 
			|| comps[iCnt].GetType() == "Checkbox"
			|| comps[iCnt].GetType() == "Edit" 
			|| comps[iCnt].GetType() == "Calendar" 
			|| comps[iCnt].GetType() == "TextArea"
			|| comps[iCnt].GetType() == "Radio")
		{
			if(comps[iCnt].Enable == true)
			{
				compCnt++;
			}
		}
	} 
	
	componentStore = Array(compCnt);
	
	compCnt = 0;
	
	//컴포넌트명 저장
	for(iCnt=0;iCnt < comps.count();iCnt++)
	{
		
		if(comps[iCnt].GetType() == "MaskEdit" 
				|| comps[iCnt].GetType() == "Combo" 
				|| comps[iCnt].GetType() == "Checkbox"
				|| comps[iCnt].GetType() == "Edit" 
				|| comps[iCnt].GetType() == "Calendar" 
				|| comps[iCnt].GetType() == "TextArea"
				|| comps[iCnt].GetType() == "Radio")
		{
			if(comps[iCnt].Enable == true)
			{
				//DEBUG("ufn_saveEnabledComponents", comps[iCnt].ID + ":" + comps[iCnt].GetType());
				componentStore[compCnt] = comps[iCnt].ID;
				compCnt++;
			}
		}
	} 
	return;
}

/********************************************************************************
* 기      능   : 초기에 Enable상태였던 컴포넌트들을 Restore한다.
********************************************************************************/
function ufn_restoreEnabledComponents()
{
	for(var iCnt = 0;iCnt < length(componentStore);iCnt++)						//컴포넌트 Enable상태 Restore	
	{
		object(componentStore[iCnt]).Enable = true;
	}
	
	grd_list.Editable = true;													//그리드 Editable 속성 Restore

	return;
}

/********************************************************************************
* 기      능   : 모든 입력 및 클릭이 가능한 컴포넌트를 Disable한다.
********************************************************************************/
function ufn_disableAllInput()
{
	ufn_enableGroup("MaskEdit", false);
	ufn_enableGroup("Combo", false);
	ufn_enableGroup("Checkbox", false);
	ufn_enableGroup("Edit", false);
	ufn_enableGroup("Calendar", false);
	ufn_enableGroup("TextArea", false);
	ufn_enableGroup("Radio", false);
	ufn_enableCommBtnGroup(false);
	ufn_setGroupVisiblity("Button", false);
	grd_list.Editable = false;	
}

/********************************************************************************
* 기      능   : 공통버튼을 모두 Enable/Disable한다.
********************************************************************************/
function ufn_enableCommBtnGroup(setFlag)
{
	comps = div_btn.Components["Button"];
	
	if(!IsValidObject(comps)) return;
	
	for(iCnt=0;iCnt < comps.count();iCnt++)
	{			
		comps[iCnt].Enable = setFlag;
	}
	return;
}

/********************************************************************************
* 기      능   : 공통버튼을 Enable/Disable 한다.
********************************************************************************/
function ufn_enableCommBtn(btnStr, setFlag)
{
	object("div_btn.btn_" + btnStr).Enable = setFlag;
	return;
}

/********************************************************************************
* 기      능   : 특정 컴포넌트 그룹을 Enable/Disable 한다.
********************************************************************************/
function ufn_enableGroup(componentGroup, setFlag)
{
	var comps;
	if(componentGroup == "")
	{
		comps = Components;
	}
	else
	{
		comps = Components[componentGroup];	
	}

	if(!IsValidObject(comps)) return;

	for(iCnt=0;iCnt < comps.count();iCnt++)
	{
		comps[iCnt].Enable = setFlag;
	} 
	
	return;
}

/********************************************************************************
* 기      능   : 특정 컴포넌트를 Enable/Disable 한다.
********************************************************************************/
function ufn_enableComponent(componentName, setFlag)
{
	if(IsValidObject(object(componentName)))
	{
		object(componentName).Enable = setFlag;	
	}
	else
	{	
		object("div_btn.btn_" + componentName).Enable = setFlag;
	}
	
	return;
}

/********************************************************************************
* 기      능   : 특정 컴포넌트 그룹을 show/hide 한다.
********************************************************************************/
function ufn_setGroupVisiblity(componentGroup, setFlag)
{
	var comps;
	if(componentGroup == "")
	{
		comps = Components;
	}
	else
	{
		comps = Components[componentGroup];	
	}

	if(!IsValidObject(comps)) return;

	for(iCnt=0;iCnt < comps.count();iCnt++)
	{
		comps[iCnt].Visible = setFlag;
	}

	return;
}


/********************************************************************************
* 기      능   : Object를 보이게 하거나 감춘다.
********************************************************************************/
function ufn_setObjectVisibility(btnStr, hideFlag)
{
	if(hideFlag == "hide" || hideFlag == false)
	{
		if(IsValidObject(object(btnStr)))
		{
			object(btnStr).visible = false;	
		}
		else
		{	
			object("div_btn.btn_" + btnStr).enable = false;
		}
	}
	else
	{
		if(IsValidObject(object(btnStr)))
		{
			object(btnStr).visible = true;	
		}
		else
		{	
			object("div_btn.btn_" + btnStr).enable = true;
		}
	}
}

/********************************************************************************
* 기      능   : 공통버튼을 보이게 하거나 감춘다.
********************************************************************************/
function ufn_setCommBtnVisibility(btnStr, hideFlag)
{
	if(hideFlag == "hide" || hideFlag == false)
	{
		object("div_btn.btn_" + btnStr).visible = false;
	}
	else
	{
		object("div_btn.btn_" + btnStr).visible = true;
	}
}

/********************************************************************************
* 기      능   : 이용권한을 설정한다.
********************************************************************************/
function ufn_setPermissions()
{
	var userGroup = gfn_getUserGroup();											//사용자 권한그룹
	var docNo1, docNo2, docNo3, docNo4, docNo5;									//전자결재 문서번호(견적(1), 수주(2), 재청구(3), 수주변경(4), 수주취소(5))	
	var docNo1Stat, docNo2Stat, docNo3Stat, docNo4Stat, docNo5Stat;				//전자결재 문서상태(견적(1), 수주(2), 재청구(3), 수주변경(4), 수주취소(5))	
	var qtUserID, logUserID;													//견적 사용자 ID, 로그인 사용자 ID;
	var recostFlag;																//재견적 플래그
	var workStage;																//견적 현재 결재 상태
	var currentUser, currentFlag, directFlag;									//현재 결재자, 사용자=차순위결재자일경우, 사용자 직영플래그 
	var draftUserID, draftFlag;													//기안자, 사용자=기안자플래그
	var oldQtFlag;																//시스템 업데이트 이전 견적인가?
	
	if(cb_seq.Value != ds_seq.max("CODE")) 										//최종차수가 아닌경우 단순 View만 가능하다. 
	{
		ufn_disableAllInput();													//모든 입력을 disable한다. 버튼은 감춘다. 
		ufn_enableCommBtn("close", true);										//닫기 enable		
		ufn_setObjectVisibility("btn_copy_ofr", true);							//견적복사 enable
		ufn_enableComponent("cb_seq", true);									//차수선택 enable
		return;
	}
	
	qtUserID = ds_out_master.GetColumn(0, "CRNAM");								//견적 작성 사용자
	logUserID = G_USER_ID;														//로그인 사용자
	selfFlag = false;
	if(logUserID == qtUserID) 													//본인여부
	{
		selfFlag = true;
	}
	
	oldQtFlag = false;
	if(length(ds_out_master.GetColumn(0, "QTNUM")) > 1 							//시스템 업데이트 이전 견적인지의 여부(견적번호만 존재하고 차수가 존재하지 않음)
					&& ds_out_master.GetColumn(0, "SEQ") == "")
	{
		oldQtFlag = true;
	}
	
	docNo1 = ds_out_master.GetColumn(0, "DOC1");								//견적결재문서번호
	docNo2 = ds_out_master.GetColumn(0, "DOC2");								//수주결재문서번호
	docNo3 = ds_out_master.GetColumn(0, "DOC3");								//재청구결재문서번호
	docNo4 = ds_out_master.GetColumn(0, "DOC4");								//수주변경결재문서번호
	docNo5 = ds_out_master.GetColumn(0, "DOC5");								//수주취소결재문서번호

	docNo1Stat = ds_out_master.GetColumn(0, "DOC1STAT");						//견적결재상태
	docNo2Stat = ds_out_master.GetColumn(0, "DOC2STAT");						//수주결재상태
	docNo3Stat = ds_out_master.GetColumn(0, "DOC3STAT");						//재청구결재상태
	docNo4Stat = ds_out_master.GetColumn(0, "DOC4STAT");						//수주변경결재상태
	docNo5Stat = ds_out_master.GetColumn(0, "DOC5STAT");						//수주취소결재상태

	workStage = ds_out_master.GetColumn(0, "CHGBN");							//견적 현재 결재 상태

	if(ds_out_master.GetColumn(0, "ENDYN") == "Y") { 							//종료된 견적일 경우
		workStage = "99";
	}

	if(docNo1Stat == "1")														//현재 견적 결재중일경우 
	{
		if(substr(ds_out_master.GetColumn(0, "DOC1DEC"), 0, 1) == "H")
			currentUser = substr(ds_out_master.GetColumn(0, "DOC1DEC"), 1);		//차순위(현재) 결재자를 설정한다. 맨 앞의 'H' 제거
		else
			currentUser = ds_out_master.GetColumn(0, "DOC1DEC");				
	}
	else if(docNo2Stat == "1"|| docNo2Stat == "4")													//현재 수주 결재중일경우 
	{
		if(substr(ds_out_master.GetColumn(0, "DOC2DEC"), 0, 1) == "H")
			currentUser = substr(ds_out_master.GetColumn(0, "DOC2DEC"), 1);		//차순위(현재) 결재자를 설정한다. 맨 앞의 'H' 제거
		else
			currentUser = ds_out_master.GetColumn(0, "DOC2DEC");
	}
	else
	{
		currentUser = "";
	}
	
	if(substr(ds_out_master.GetColumn(0, "DOC1DRA"), 0, 1) == "H")
		draftUserID = substr(ds_out_master.GetColumn(0, "DOC1DRA"), 1);			//기안자정보를 얻는다. 맨 앞의 'H' 제거
	else
		draftUserID = ds_out_master.GetColumn(0, "DOC1DRA");		
	
	draftFlag = false;
	if(logUserID == draftUserID)
	{
		draftFlag = true;
	}
	
	//DEBUG("ufn_setPermissions", "현재사용자:" + logUserID + "/견적사용자:" + qtUserID+"/차순위결재자:" + currentUser + "/기안자:" + draftUserID);

	currentFlag = false;
	if(logUserID == currentUser)												//로그인한 사용자가 차순위(현재)결재자인지 확인한다.
	{
		currentFlag = true;
	}
	
	recostFlag = false;															//재견적플래그를 Clear 한다.

	/*
	if(docNo1Stat == "2" || docNo2Stat == "2")									//견적승인반려(2) 또는 수주승인반려(2) 재견적 플래그 세팅. 두 결재는 기안부서전결이므로 수신부서반려(5)상태는 고려하지 않음
	{	
		recostFlag = true;
	}
	*/
	
	if(workStage == "")															//견적상태 재견적 플래그 세팅
	{
		if(docNo2Stat != "6" && (isDigit(docNo1Stat) || isDigit(docNo2Stat))) 
			recostFlag = true;													//재견적은 수주승인 상태가 되기 전이면 언제든 가능
	}
	else if(workStage == "0")													//청구상태 재견적 플레그 세팅
	{	
		if(docNo2Stat != "6" && (ds_out_master.GetColumn(0, "QSTAT") == "0" ||	//수주승인완료 상태가 아니고 해당 견적에 대한 청구의 상태가 청구취소(0), 접수취소(5), 승인취소(6)일 경우 재견적 가능
				ds_out_master.GetColumn(0, "QSTAT") == "5" ||				
				ds_out_master.GetColumn(0, "QSTAT") == "6"))
		{
			recostFlag = true;
		}
	}	
	else if(workStage == "1")													//수주변경
	{
		if(docNo4Stat == "2" || docNo4Stat == "5") recostFlag = true; 			//수주변경반려(2, 5)일 경우 가능. 수주변경완료(6)시는 재청구 가능
	}
	else if(workStage == "2")													//수주취소
	{
		if(docNo5Stat == "2" || docNo5Stat == "5") recostFlag = true;			//수주취소반려(2, 5)일 경우 가능.
	}
	else if(workStage == "3")													//재청구
	{
		if(docNo3Stat == "2") recostFlag = true;								//재청구반려(2)시 가능. 재청구는 기안부서 전결이므로 수신부서반려(5)는 무시
	}
	
	if(logUserID.length == 7)													//해당 인원의 직영/협력사 구분을 가져온다.
		ds_cond.SetColumn(0, "USERID", "H" + logUserID);						//7자리일경우 H를 붙인다
	else
		ds_cond.SetColumn(0, "USERID", logUserID);								//8자리일경우 pass
	
	tit_clearActionInfo();														
	tit_addSingleActionInfo("cs01:CS0101008B_S9");								//직영 구분을 가져온다
	tit_callService("", "", "ds_cond=ds_cond", "ds_jhgbn=ds_jhgbn", "", "", true, false,true);

	directFlag = false;
	if(ds_jhgbn.GetColumn(0, "JHGBN") == "1")									//직영구분
	{
		directFlag = true;
	}
	
	//DEBUG("ufn_setPermissions", "selfFlag:" + selfFlag + "/currentFlag:" + currentFlag + "/docNo4:" + docNo4 + "/workStage:" + workStage + "/directFlag:"+directFlag);
	
	ufn_restoreEnabledComponents();												//초기에 Enable 상태였던 모든 컴포넌트들을 Restore한다.
	
	ufn_enableCommBtnGroup(false);												//공통버튼을 모두 Disable 한다

	/*-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=- 견적 종료 -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=--=-=-=-=-*/
	if(workStage == "99")														// 종료된 견적일 경우
	{
		ufn_disableAllInput();													//모든 입력을 disable한다. 버튼은 감춘다.
		ufn_enableCommBtn("draft", false);										//기안 disable
		ufn_enableCommBtn("close", true);										//닫기 enable
		ufn_setObjectVisibility("btn_print_ofr", false);						//견적서출력 disable
		ufn_setObjectVisibility("btn_print_req", false);						//부품요청서출력 disable
		ufn_setObjectVisibility("btn_copy_ofr", true);							//견적복사 enable
		ufn_enableComponent("cb_seq", false);									//차수선택 disable
	}

	/*-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=- 수주변경, 수주취소 단계 -=-=-=-=-=-=-=-=-=-=-=-=-=-=--=-=-=-=-*/
	//청구등록완료, 재청구, 수주변경, 수주취소 상태 -> 전송완료. 견적수정불가
	//if(docNo3.length > 0 || docNo4.length > 0 || docNo5.length > 0)			//수정불가. 버튼 enable가능.
	else if(isDigit(workStage))													//작업상태가 숫자면(ZCST001의 CHGBN : 0:청구등록완료/1:수주변경/2:수주취소/3:재청구) 수정불가. 버튼 enable가능.
	{
		ufn_disableAllInput();													//모든 입력을 disable한다. 버튼은 감춘다. 
		ufn_enableCommBtn("close", true);										//닫기 enable		
		ufn_setObjectVisibility("btn_print_ofr", true);							//견적서출력 enable
		ufn_setObjectVisibility("btn_print_req", true);							//부품요청서출력 enable
		ufn_setObjectVisibility("btn_copy_ofr", true);							//견적복사 enable
		ufn_enableComponent("cb_seq", true);									//차수선택 enable
		//if((isDigit(workStage) == 0 || isDigit(workStage) == 1) && (G_USER_ID == "2019175" || G_USER_ID == "2018209" || G_USER_ID == "2020882" || G_USER_ID == "3011038" || G_USER_ID == "3002519" || G_USER_ID == "2018900" || G_USER_ID == "2029758"))
		if ((isDigit(workStage) == 0 || isDigit(workStage) == 1) && vBomCheck == true)
		{
			ufn_setObjectVisibility("btn_bom", true);
			cal_bomdat.Enable = true;
		}
	}

	/*-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=- 수주승인단계 -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-*/
	else if(docNo2.length > 0) 													//수주승인단계
	{
		ufn_disableAllInput();													//모든 입력을 disable한다. 버튼은 감춘다. 
		ufn_enableCommBtn("close", true);										//닫기 enable
	//		if(selfFlag) ufn_enableCommBtn("recost", true);						//자기자신이면 재견적 show (수주승인이 되지 않았으면 재견적 가능)
		ufn_enableComponent("cb_seq", true);									//차수선택 enable

		switch(docNo2Stat)
		{
			case "1":															//결재중(결재자가 자기자신일 경우에만 결재 버튼을 enable 시켜준다)
				switch(userGroup)
				{
					case "10":													//보수협력사	- 닫기, 견적복사
						if(currentFlag && directFlag) 
							ufn_enableCommBtn("decide", true);					//결재 enable
						if(currentFlag && directFlag) 
							ufn_enableCommBtn("senfdback", true);				//반송 enable					
						ufn_setObjectVisibility("btn_copy_ofr", true);			//견적복사 enable
						break;
					case "20":													//보수PM		- 결재, 반송, 닫기, 견적복사
					case "30":													//지방사무소	- 결재, 반송, 닫기, 견적복사
					case "40": 													//담당자		- 결재, 반송, 닫기, 견적복사
						if(currentFlag) ufn_enableCommBtn("decide", true);		//결재 enable
						if(currentFlag) ufn_enableCommBtn("sendback", true);	//반송 enable
						ufn_setObjectVisibility("btn_copy_ofr", true);			//견적복사 enable
						break;
					default:													//예외(?)
						break;
				}			
				break;
			case "2":															//기안결재반려
				if(substr(G_USER_ID,0,1) != "8" ) 
				{
					ufn_setObjectVisibility("btn_writeCost", true); 		// 기안결재반려 경우 추가예산 등록 버튼 활성화 
					ufn_setObjectVisibility("btn_saveCost", false);
				}
				if(selfFlag) {
					ufn_enableCommBtn("draft", true);						//반송 건 재기안가능토록 수정
				}
				switch(userGroup)
				{
					case "10":													//보수협력사	- 재견적, 견적복사
					case "20":													//보수PM		- 재견적, 견적복사	
					case "30":													//지방사무소	- 재견적, 견적복사
						ufn_enableCommBtn("draft", true);
					case "40": 													//담당자		- 재견적, 견적복사
						//ufn_enableCommBtn("recost", true);					//재견적 enable
						ufn_setObjectVisibility("btn_copy_ofr", true);			//견적복사 enable
						break;
					default:													//예외(?)
						break;
				}			
				break;				
			case "3":															//기안부서결재완료
				switch(userGroup)											    //    (존재하지 않음. 결재완료 시 바로 6으로 설정 변경 및 청구테이블에 데이터 전송)
				{
					case "10":													//보수협력사 	- 견적복사 
						break;
					case "20":													//보수PM 		- 견적복사
						break;
					case "30":													//지방사무소 	- 견적복사
						break;
					case "40": 													//담당자 		- 견적복사
							ufn_enableComponent("cb_cyn", true);	
							ufn_enableComponent("cb_ctp", true);	
							ufn_enableComponent("cb_cse", true);
							ufn_setObjectVisibility("btn_copy_ofr", true);		//견적복사 enable
							ufn_enableCommBtn("draft", true);					//기안 enable
						break;
					default:													//예외(?)
						break;
				}	
				break;
			case "4":															//수신부서결재중(결재자가 자기자신일 경우에만 결재 버튼을 enable 시켜준다)
				switch(userGroup)
				{
					case "10":													//보수협력사	- 닫기
						if(currentFlag && directFlag) 
							ufn_enableCommBtn("decide", true);					//권한10직영인원 결재 enable
						if(currentFlag && directFlag) 
							ufn_enableCommBtn("sendback", true);				//권한10직영인원 반송 enable
						break;
					case "20":													//보수PM		- 결재, 반송, 닫기
					case "30":													//지방사무소	- 결재, 반송, 닫기
					case "40": 													//담당자		- 결재, 반송, 닫기
						if(currentFlag){ 
							ufn_enableCommBtn("decide", true);		//결재 enable
							ufn_enableComponent("cb_cyn", true);	
							ufn_enableComponent("cb_ctp", true);	
							ufn_enableComponent("cb_cse", true);
							ufn_enableCommBtn("sendback", true);	//반송 enable
						}
						break;
					default:													//예외(?)
						break;
				}			
				break;
			case "5":															// 수신결재반려
				
				if(substr(G_USER_ID,0,1) != "8" ) 
				{
					ufn_setObjectVisibility("btn_writeCost", true); 		// 수신결재반려 경우 추가예산 등록 버튼 활성화 
					ufn_setObjectVisibility("btn_saveCost", false);
				}
				if(selfFlag) {
					ufn_enableCommBtn("draft", true);						//반송 건 재기안가능토록 수정
					
				}
				switch(userGroup)
				{
					case "10":													//보수협력사	- 재견적, 견적복사
					case "20":													//보수PM		- 재견적, 견적복사	
					case "30":													//지방사무소	- 재견적, 견적복사
						ufn_enableCommBtn("draft", true);
					case "40": 													//담당자		- 재견적, 견적복사
						//ufn_enableCommBtn("recost", true);					//재견적 enable
						ufn_setObjectVisibility("btn_copy_ofr", true);			//견적복사 enable
						break;
					default:													//예외(?)
						break;
				}			
				break;
			case "6":															//수신부서결재완료
				ufn_setObjectVisibility("btn_copy_ofr", true);					//견적복사 enable	
				ufn_enableCommBtn("recost", false);								//수주승인이 완료된 것이므로 재견적 disable
				//if(recostFlag) ufn_enableCommBtn("recost", true);				//재견적 가능 상태이면 재견적 enable	
				break;	
			default:															//4, 5는 존재하지 않음(기안부서전결처리)
				ufn_disableAllInput();											//모든 입력을 disable한다. 버튼은 감춘다. 
				ufn_enableCommBtn("close", true);								//닫기 enable			
				break;
		}
		ufn_setObjectVisibility("btn_print_ofr", true);							//견적서출력 enable
		ufn_setObjectVisibility("btn_print_req", true);							//부품요청서출력 enable	
			
	}

	/*-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=- 견적승인단계 -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-*/
	else if(docNo1.length > 0) 													//견적승인단계
	{
		ufn_disableAllInput();													//모든 입력을 disable한다. 버튼은 감춘다. 
		ufn_enableCommBtn("close", true);										//닫기 enable		
		ufn_enableComponent("cb_seq", true);									//차수선택 enable
		if(selfFlag) ufn_enableCommBtn("recost", true);					    	//자기자신이면 재견적 show (수주승인이 되지 않았으면 재견적 가능)
		switch(docNo1Stat)
		{
			case "1":															//결재중(결재자가 자기자신일 경우에만 결재 버튼을 enable 시켜준다)
				switch(userGroup)
				{
					case "10":													//보수협력사	- 닫기, 견적복사
						ufn_setObjectVisibility("btn_copy_ofr", true);			//견적복사 enable
						if(currentFlag && directFlag) 
							ufn_enableCommBtn("decide", true);					//결재 enable
						if(currentFlag && directFlag) 
							ufn_enableCommBtn("sendback", true);				//반송 enable						
						break;
					case "20":													//보수PM		- 결재, 반송, 닫기, 견적복사
					case "30":													//지방사무소	- 결재, 반송, 닫기, 견적복사
					case "40": 													//담당자		- 결재, 반송, 닫기, 견적복사
						if(currentFlag) ufn_enableCommBtn("decide", true);		//결재 enable
						if(currentFlag) ufn_enableCommBtn("sendback", true);	//반송 enable
						ufn_setObjectVisibility("btn_copy_ofr", true);			//견적복사 enable
						break;
					default:													//예외(?)
						break;
				}			
				break;
			case "2":															//결재반려
				switch(userGroup)	
				{
					case "10":													//보수협력사	- 재견적, 견적복사
					case "20":													//보수PM		- 재견적, 견적복사
					case "30":													//지방사무소	- 재견적, 견적복사
					case "40": 													//담당자		- 재견적, 견적복사
						//ufn_enableCommBtn("recost", true);						//재견적 enable
						ufn_setObjectVisibility("btn_copy_ofr", true);			//견적복사 enable
						break;
					default:													//예외(?)
						break;
				}			
				break;				
			case "3":															//기안부서결재완료				
				switch(userGroup)	
				{
					case "10":													//보수협력사 	- 수주등록, 견적복사 
					case "20":													//보수PM 		- 수주등록, 견적복사
					case "30":													//지방사무소 	- 수주등록, 견적복사
					case "40": 													//담당자 		- 수주등록, 견적복사
						ufn_setObjectVisibility("btn_print_ofr", true);			//견적서출력 enable
						ufn_setObjectVisibility("btn_print_req", true);			//부품요청서출력 enable
						ufn_setObjectVisibility("btn_copy_ofr", true);			//견적복사 enable
						
						if(selfFlag || draftFlag)								//자기자신 또는 기안자일 경우에만 계약서업로드, 수주등록이 가능하다.
						{
							ufn_setObjectVisibility("btn_upload_con", true);	//계약서 업로드 enable
							ufn_setObjectVisibility("btn_save_con", true);		//수주등록 enable
							ufn_enableComponent("cb_kvgr1", true);				//계산서구분
							ufn_enableComponent("cb_kvgr2", true);				//발송구분
							ufn_enableComponent("cb_taxk1", true);				//세금구분
							ufn_enableComponent("cb_zterm", true);				//수금조건
							ufn_enableComponent("cal_bildat1", true);			//계산서발행일1)
							ufn_enableComponent("chk_spbill", true);			//계산서분할발행
							ufn_enableComponent("cb_cyn", true);	
							ufn_enableComponent("cb_ctp", true);	
							ufn_enableComponent("cb_cse", true);
							
						}
						
						//if(draftFlag) ufn_setObjectVisibility("btn_save_con", true);		//기안자의 경우 수주등록 enable 
						
						break;
					default:													//예외(?)
						break;
				}
				break;
			case "6":															//수신부서결재완료 (수주등록시 6으로 설정)
				switch(userGroup)	
				{
					case "10":													//보수협력사 	- 견적복사 
						ufn_setObjectVisibility("btn_copy_ofr", true);			//견적복사 Show
						//if(directFlag) ufn_enableCommBtn("draft", true);		//직영일 경우 기안 Show (수주승인 결재선지정으로 연결)
						ufn_enableCommBtn("draft", true);						//기안버튼을 보여줌(10번은 기안저장만, 20번 이상은 실제 기안)
						break;
					case "20":													//보수PM 		- 기안, 견적복사
					case "30":													//지방사무소 	- 기안, 견적복사
					case "40": 													//담당자 		- 기안, 견적복사
						ufn_enableCommBtn("draft", true);						//기안 Show (수주승인 결재선지정으로 연결)
						ufn_setObjectVisibility("btn_copy_ofr", true);			//견적복사 Show
						break;
					default:													//예외(?)
						break;
				}
				
				ufn_setObjectVisibility("btn_print_ofr", true);					//견적서출력 enable
				ufn_setObjectVisibility("btn_print_req", true);					//부품요청서출력 enable
				
				if(substr(G_USER_ID,0,1) != "8" ) 
				{
					ufn_setObjectVisibility("btn_writeCost", true); // 견적 작성의 경우만 추가예산 등록 버튼 활성화 
					ufn_setObjectVisibility("btn_saveCost", false);
				}
				break;
			default:															//4, 5는 존재하지 않음(기안부서전결처리)
				ufn_disableAllInput();											//모든 입력을 disable한다. 버튼은 감춘다. 
				ufn_enableCommBtn("close", true);								//닫기 enable				
				break;
		}
	}

	/*-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=- 견적작성/저장단계 -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-*/
	//견적작성 단계(기안 상신 이전 단계)
	else if(docNo1.length <= 0)		
	{
		ufn_setGroupVisiblity("Button", false);									//버튼을 감춘다
		ufn_enableCommBtn("close", true);										//닫기 enable
		
		if(ds_out_master.GetColumn(0, "QTNUM").length > 0)						//저장된 견적이면
		{
			if(selfFlag)														//자신의 견적이면
			{
				if (!oldQtFlag) ufn_enableCommBtn("delete", true);				//삭제 enable (업데이트 이전 견적은 삭제불가)
				ufn_enableCommBtn("save", true);								//저장 enable
				ufn_enableCommBtn("reset", true);								//리셋 enable
				ufn_enableCommBtn("recost", true);								//재견적 enable
				ufn_setObjectVisibility("bt_addMaterial", true);				//자재추가 enable
				ufn_setObjectVisibility("bt_removeMaterial", true);				//자재삭제 enable
				ufn_setObjectVisibility("bt_hogiInput", true);					//호기별입력 enable
				ufn_setObjectVisibility("btn_pjt", true);						//프로젝트검색 enable
				chk_ilsic.Enable = true;                                        //수리공사 일식외주 활성화
				//if ( lejchk = 'Y' and ds_out_master.GetColumn(0, "REQKIND") = '1' )
				if ( dcchk = 'Y' and ds_out_master.GetColumn(0, "REQKIND") = '1' )
				{
					ufn_setObjectVisibility("btn_discount", true);
				}
				
			}
			else																//타인의 견적이면
			{
				ufn_disableAllInput();											//모든 입력을 disable한다. 버튼은 감춘다. 
			}	
			
			if( (toNumber(userGroup) >= 10 || directFlag) && 					//20이상 권한이거나 직영플래그가 true이면
					length(ds_out_master.GetColumn(0, "PS_PSPID")) <= 0 ) 		//시스템 리뉴얼 이전견적 view시 전송된 견적은 기안 버튼을 보여주지 않기 위해 남겨둠
							ufn_enableCommBtn("draft", true);					//보수PM이상의 권한이면 기안 버튼 enable
			ufn_enableComponent("cb_seq", true);								//차수선택 enable
			ufn_setObjectVisibility("btn_copy_ofr", true);						//견적복사 enable		
		}
		else																	//신규 견적이면(저장 이전) - 차수선택 하지 않음
		{
			ufn_enableCommBtn("save", true);									//저장 enable
			ufn_enableCommBtn("reset", true);									//리셋 enable
			ufn_setObjectVisibility("bt_addMaterial", true);					//자재추가 enable
			ufn_setObjectVisibility("bt_removeMaterial", true);					//자재삭제 enable
			ufn_setObjectVisibility("bt_hogiInput", true);						//호기별입력 enable	
			ufn_setObjectVisibility("btn_pjt", true);							//프로젝트검색 enable
			chk_ilsic.Enable = true;                                            //수리공사 일식외주 활성화
			//if ( lejchk = 'Y' and ds_out_master.GetColumn(0, "REQKIND") = '1' )
			if ( dcchk = 'Y' and ds_out_master.GetColumn(0, "REQKIND") = '1' )
			{
				ufn_setObjectVisibility("btn_discount", true);
			}
			
		}		
		ufn_enableCommBtn("close", true);										//닫기 enable
		
		if(substr(G_USER_ID,0,1) != "8" ) 
		{
			ufn_setObjectVisibility("btn_writeCost", true); // 견적 작성의 경우만 추가예산 등록 버튼 활성화 
			ufn_setObjectVisibility("btn_saveCost", false);
		}
	}
	/*-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=- 예외상황 발생시  -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-*/
	else
	{
		ufn_disableAllInput();													//모든 입력을 disable한다. 버튼은 감춘다. 
		ufn_enableCommBtn("close", true);										//닫기 enable		
	}	
	//if(recostFlag && selfFlag && length(docNo2Stat) = 0) ufn_enableCommBtn("recost", true);				//재견적 가능 상태이면 재견적 enable
	//else ufn_enableCommBtn("recost", false);
	
	orgPrintFlag = btn_print_ofr.Visible;										//7백만원이하 견적에 대해 견적서, 부품요청서를 visible상태로 만들어주기 위해 원래 플래그값을 저장(금액 변경으로 7백만원 이상으로 바뀌었을경우를 위해)
	
	if(DEBUG_FLAG) 																//디버깅중일 경우, SAP전송처리버튼을 Enable한다.
	{
		if((length(ds_out_master.GetColumn(0, "PS_PSPID")) <= 0) && 			
					(toNumber(docNo1Stat) == 6 && toNumber(docNo2Stat) == 6))
		{
			ufn_setObjectVisibility("debug_btn_xfer", true);
		}
	}
	/*  시행율 재계산 */
	//if(G_USER_ID == "2021200" || G_USER_ID == "2018900" || G_USER_ID == "2029758") {
	if (vWriteCost == true){
		ufn_setObjectVisibility("btn_writeCost", true); 
	}
	
	
	//===================자회서 컴포넌트 제어===========================
//alert("1");	
/*
	ufn_enableGroup_j("MaskEdit", 	true);
	ufn_enableGroup_j("Combo", 		true);
	ufn_enableGroup_j("Checkbox", 	true);
	ufn_enableGroup_j("Edit", 		true);
	ufn_enableGroup_j("Calendar", 	true);
	ufn_enableGroup_j("TextArea", 	true);
	ufn_enableGroup_j("Radio", 		true);
	ufn_enableGroup_j("Button", 	true);
*/	
	//==================================================================
	
}

//=========================================================================================
// [ PART 6 ]
// component Event 정의 : 각 Component 별 이벤트 
//=========================================================================================
/********************************************************************************
* 기      능   : 그리드 헤더 클릭시 정렬 처리 
********************************************************************************/
function grd_list_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
{
	if ( nCell == 0 ) {
		// 그리드 표시할 컬럼 선택 
		//gfn_selectGridCol(obj);
		ds_list.fireEvent = false;
		if(grd_list.Editable) gfn_selectAllGrid(obj,nCell,"CHK",true);
		ds_list.fireEvent = true;
	} else {
		// 그리드 정렬 처리 
		gfn_sortGrid(obj,nCell);
	}
}

/********************************************************************************
* 기      능   : 프로젝트 검색 버튼 클릭
********************************************************************************/
function btn_pjt_OnClick(obj)
{
	if(copyFlag == false && ds_list.rowcount > 0) { //copyFlag : 견적복사 여부 Flag
		gfn_showAlert("선택된 자재를 모두 삭제하신 후 변경 가능합니다.");
		return;
	}

	//var arg = "vkgrp=" + quote(G_SAP_USER_VGCD) + " cst=1";					//지사 사용자의 작업그룹별 필터링 조건, 거래선이 있는 것만 
	var arg = "vkgrp=" + quote(G_SAP_USER_VGCD) + " cst=1" + " lejchk='N'"  ;					//자회사 조회사 조건 추가
	
	
	//DEBUG("btn_pjt_OnClick", "arg is " + arg);

	var kunnr = gfn_openPopup("CS9601001A", true, arg);

	if (kunnr != null) {
		if (kunnr[0] == null || length(kunnr[0]) < 3) {
			return;
		}
	
		//DEBUG("btn_pjt_OnClick", ds_cond.SaveXml());
			
		if (kunnr[1] == null || length(kunnr[1]) < 3) {
			gfn_showAlert("CW00022","거래선");
			return;
		}
		
		ed_pjt.value = kunnr[0] + kunnr[1];
		ed_spt.value = kunnr[2];
		ds_cond.SetColumn(0, "UPN", kunnr[0]);
		ds_cond.SetColumn(0, "CST", kunnr[1]);		
	}
	else
	{
		return;
	}
	
    //견적 그리드를 클리어한다.
    //ds_list.clearData();
    
    //해당 프로젝트 번호로 나머지 정보를 가져온다.
    ufn_getProjectInfo();
}
/********************************************************************************
* 기      능   : 출고요청일 체크로직
********************************************************************************/
function Check_Rdate(obj)
{
	var tmp_webaz = 0;
	var max_webaz = 0;
	var cal_date_fr, cal_date_to;
		
	for(var iCnt=0;iCnt<ds_list.rowcount;iCnt++)
	{
		tmp_webaz = ds_list.GetColumn(iCnt, "WEBAZ");
	
		if(parseInt(tmp_webaz) > parseInt(max_webaz)) {
			max_webaz = tmp_webaz;
		}
		if(tmp_webaz == "") tmp_webaz = 0;	
	}
	//max_webaz = parseInt(max_webaz) + 1;
	//cal_date_to = gfn_getWorkingDate(max_webaz, '2000', gfn_getCurrDate());
	
	// 출고요청일 = 마스터소요일수 + 4일 + 청구종류별 승인소요일
	// 서비스자재 김태한 요청. 2021.06.18 J.H Han	
	max_webaz = parseInt(max_webaz) + 4; // 마스터소요일수 + 4일. 서비스자재 김태한 요청. 2021.06.18 J.H Han
	
	var approveDate = getReqkindDlyDate(); // 청구종류별 승인소요일
	
	max_webaz = max_webaz + approveDate; // 출고요청일	
	
	//cal_date_to = gfn_getAfterDate(gfn_getCurrDate(), parseInt(max_webaz));
	cal_date_to = gfn_getWorkingDate(max_webaz, '2000', gfn_getCurrDate()); // 2021.07.06 캘린더데이 => 워킹데이로 기준 변경. 서비스자재팀 김태한 요청. Han JH
	if(cal_shdat.Value < cal_date_to) {
		
		cal_shdat.Enable = true;
		gfn_showAlert("CW10025", "출고요청일은 자재의 LEADTIME을 계산하여 입력하시기 바랍니다. (" 
								+ cal_date_to + "이후)");
		return false;
	}
	return true;
}
/********************************************************************************
* 기      능   : 수주관련항목 체크로직
********************************************************************************/
function Check_Suju(obj)
{
	if(ufn_isNull(cb_taxk1, true, "세금구분", cb_taxk1)) return false;		//세금구분
	if(ufn_isNull(cb_zterm, true, "수금조건", cb_zterm)) return false;		//수금조건
	
	if(cb_kvgr1.Index < 0)													//계산서구분
	{	
		gfn_showAlert("CW00001", "계산서구분");
		cb_kvgr1.setFocus();
		return false;
	}
		
	if(cb_kvgr2.Index < 0)													//발송구분
	{	
		gfn_showAlert("CW00001", "발송구분");
		cb_kvgr2.setFocus();
		return false;
	}
	
	if (!gfn_checkDate(gfn_getCurrDate(),ds_out_master.GetColumn(0,"BILDAT"), true, cal_bildat1,"계산서발행일1")) return false;	//계산서발행일1
	//----------------------------------------------------------------------
	//세금계산서 발행일 분류에 따른 check logic
	
	if((parseFloat(me_bilamt1.value) + parseFloat(me_bilamt2.value) + parseFloat(me_bilamt3.value)) != ed_sum_ofr.value)
	{
		gfn_showAlert("CW00242");
		return false;
	}
	if((parseInt(cal_bildat1.value) > 0 && parseInt(me_bilamt1.value) <= 0) || (parseInt(cal_bildat1.value) <= 0 && parseInt(me_bilamt1.value) > 0))
	{
		gfn_showAlert("CW00022", cal_bildat1.value+"/"+me_bilamt1.text);
		return false;
	}
	if((parseInt(cal_bildat2.value) > 0 && parseInt(me_bilamt2.value) <= 0) || (parseInt(cal_bildat2.value) <= 0 && parseInt(me_bilamt2.value) > 0) )
	{
		gfn_showAlert("CW00022", cal_bildat2.value+"/"+me_bilamt2.text);
		return false;
	}
	if((parseInt(cal_bildat3.value) > 0 && parseInt(me_bilamt3.value) <= 0) || (parseInt(cal_bildat3.value) <= 0 && parseInt(me_bilamt3.value) > 0))
	{
		gfn_showAlert("CW00022", cal_bildat3.value+"/"+me_bilamt3.text);
		return false;
	}
	if ( parseInt(cal_bildat2.value) > 0 && !gfn_checkDate( gfn_getCurrDate(),ds_out_master.GetColumn(0,"BILDAT2") , true, cal_bildat2,"계산서발행일2)") ) {
		return false;
	}
	if ( parseInt(cal_bildat3.value) > 0 && !gfn_checkDate( gfn_getCurrDate(),ds_out_master.GetColumn(0,"BILDAT3") , true, cal_bildat3,"계산서발행일3)") ) {
		return false;
	}
	
	//----------------------------------------------------------------------
	//세금계산서 발행일 제한로직 (청구구분은 1 또는 7 또는 S)
	
	var limitDays = 0;
	var gubun = "NB";
	var bomFlag = false;
	var totalAmount = toNumber(ed_sum_ofr.value);
		
	//BOM자재가 포함되었는지 확인
	for(iCnt=0;iCnt < ds_list.count;iCnt++)
	{
		if(ds_list.GetColumn(iCnt, "RGBN") != "1")
		{
			bomFlag = true;
		}
	}
		
	if(cb_reqkind.value == 1) 													//부품판매 
	{
		if(bomFlag) 
		{
			limitDays = 70;
		}
		else 
		{
			limitDays = 40;
		}
	} 
	else if(cb_reqkind.value == 7 || cb_reqkind.value == 'S')				    //수리공사 , 시스템공사
	{ 
		if(length(cb_cyn.value) == 0) {
			var arr = [st_cyn.value];
			gfn_showAlert("CW00001", arr);
			return;
		}
		if(cb_cyn.value == "Y" && length(cb_ctp.value) == 0) {
			var arr = [st_ctp.value];
			gfn_showAlert("CW00001", arr);
			return;
		}
		if(length(cb_cse.value) == 0) {
			var arr = [st_cse.value];
			gfn_showAlert("CW00001", arr);
			return;
		}
	
		if(bomFlag) 
		{
			if(totalAmount	< 100000000) 										//1억미만
			{  
				limitDays = 70;
			} 
			else 																//1억 이상       
			{        						                           
				limitDays = 100;
			}
		} 
		else 
		{
			if(totalAmount <= 30000000) 										//3천이하
			{         
				limitDays = 50;
			} 
			else if(totalAmount < 100000000) 									//1억미만
			{  
				limitDays = 60;
			} 
			else 																//1억이상
			{                                                	
				limitDays = 100;
			}
		} 
	} 
	else 																		//의미없음(부품판매/수리공사만 존재하므로)
	{
		limitDays = 100;
	}
		
	if(gfn_getDayCnt(ds_days, gfn_getCurrDate(), cal_bildat1.value) > limitDays) 
	{  
		gfn_showAlert("CW10025", "계산서 발행예정일1이 기준일을 초과하였습니다. 현재+" + limitDays + "일 이내");
		return false;
	}
	return true;
			
}
/********************************************************************************
* 기      능   : 계산서 분할발행 체크박스 체크/언체크
********************************************************************************/
function chk_spbill_OnClick()
{
	if(chk_spbill.Value == "1")
	{
		cal_bildat2.enable = true;
		me_bilamt2.enable = true;
		cal_bildat3.enable = true;
		me_bilamt3.enable = true;
	} 
	else 
	{
		cal_bildat2.enable = false;
		me_bilamt2.enable = false;
		cal_bildat3.enable = false;
		me_bilamt3.enable = false;
		
		me_bilamt1.value = ed_sum_ofr.Value;
		cal_bildat2.value = "";
		me_bilamt2.value = 0;
		cal_bildat3.value = "";
		me_bilamt3.value = 0;
	}
}

/********************************************************************************
* 기      능   : 자재추가 버튼 클릭
********************************************************************************/
function bt_addMaterial_OnClick(obj)
{
	if(ed_pjt.value.length <= 0)
	{
		gfn_showAlert("CW10025", "프로젝트를 선택해주세요.");
		return;
	}

	if(length(cb_reqkind.value) == 0 || cb_reqkind.value == "")
	{
		gfn_showAlert("CW10025", "청구구분을 선택해주세요.");
		return;
	}
	 if(length(cb_reqkind.value) == 0 || cb_reqkind.value == "")
	 {
		 gfn_showAlert("CW10025", "제품군을 선택해주세요.");
		 return;
	 }

	/** 2015.02.26 LJH : Header의 청구구분 비활성화 **/
	cb_reqkind.Enable = false;
	chk_fail.Enable = false;
	chk_bom.Enable = false;
	/** 2015.02.26 LJH **/
	chk_ilsic.Enable = false;

	ds_list.addRow();
	ds_list.SetColumn(ds_list.count - 1, "FLAG", "I");

	if(chk_fail.Value == "Y") ufn_checkFailSite();								//실패현장청구여부 적용
}

/********************************************************************************
* 기      능   : 자재삭제 버튼 클릭
********************************************************************************/
function bt_removeMaterial_OnClick(obj)
{
	if(ds_list.count <= 0)
	{
		return;
	}

	if(ed_pjt.value.length <= 0)
	{
		gfn_showAlert("CW10025", "프로젝트를 선택해주세요.");
		return;
	}

	//DEBUG("bt_removeMaterial_OnClick", ds_list.savexml());
	//DEBUG("bt_removeMaterial_OnClick", ds_cond.SaveXmL());
	
	ds_cond_del.clearData();
	
	for(iCnt=ds_list.rowcount - 1;iCnt >= 0;iCnt--)
	{
		if(ds_list.getColumn(iCnt, "CHK") == 1)
		{
			//저장된 행일 경우 해당행을 삭제하기 위한 IN 조건을 구성한다.
			if(ds_list.GetColumn(iCnt, "FLAG") != "I" && length(ds_cond.GetColumn(0, "QTNUM")) > 0)
			{
				ds_cond_del.AddRow();
				ds_cond_del.SetColumn(ds_cond_del.rowcount - 1, "QTNUM", ds_cond.GetColumn(0, "QTNUM"));
				ds_cond_del.SetColumn(ds_cond_del.rowcount - 1, "SEQ", ds_cond.GetColumn(0, "SEQ"));
				ds_cond_del.SetColumn(ds_cond_del.rowcount - 1, "SEQNO", ds_list.GetColumn(iCnt, "SEQNO"));
			}
			
			ds_list.deleteRow(iCnt);
		}
	}

	if(ds_list.count == 0)
	{
		/** 2015.02.26 LJH : Header의 청구구분 활성화 **/
		cb_reqkind.Enable = true;
		chk_fail.Enable = true;
		chk_bom.Enable = true;
		/** 2015.02.26 LJH **/
		chk_ilsic.Enable = true;
	}

	//DEBUG("bt_removeMaterial_OnClick", ds_cond_del.savexml());
	//청구구분에 따른 계산값을 다시 계산한다.
	ufn_calcCostValues("bt_removeMaterial_OnClick");
	
	//DB에 저장된 행을 삭제한다.
	if(ds_cond_del.rowcount > 0)
	{
		tit_clearActionInfo();
		tit_addMultiActionInfo("cs01:CS0101008B_D2");
		tit_callService(
		"",
		"",
		"ds_cond=ds_cond_del",
		"",
		"",
		"fn_afterDeleteMaterial"
		);
	}		
}

/********************************************************************************
* 기      능   : 자재 삭제 콜백
********************************************************************************/
function fn_afterDeleteMaterial(errCode, errMsg) 
{
	if ( errCode!= 0 ) 
	{
		gfn_showMsg("CE00001");
	} 
	else 
	{
		ds_cond_del.clearData();
		gfn_showMsg("CI00003");
	}
}

/********************************************************************************
* 기      능   : 자재 리스트 Expand Up 시
********************************************************************************/
function grd_list_OnExpandUp(obj,nRow,nCell,strVal,nPivotIndex)
{	
	if(ed_pjt.value.length <= 0)
	{
		gfn_showAlert("CW10025", "프로젝트를 선택해주세요.");
		return;
	}

	switch(nCell)
	{
		case 1: 																//호기번호
			break;
		case 4:																	//자재검색팝업
			var matType = ds_list.GetColumn(nRow, "RGBN");
			var arg = "";
			var targetQuery = "";
			var mat;
			if(ds_list.GetColumn(nRow, "HNO").length == 0)
			{
				gfn_showAlert("CW10025", "호기(WBS) 또는 호기명을 선택해주세요.");
				return;
			}

			if(cb_spartnm.Value == "" || length(cb_spartnm.Value) == 0)
			{
				gfn_showAlert("CW10025", "제품군을 선택해주세요.");
				return;
			}
			// 20171110 제품군에 따라 호기 정보 체크 이하림 
			if( cb_spartnm.Value == "20" && substr(ds_list.GetColumn(nRow, "HNO"), 6, 1) <> "J" )
			{
				gfn_showAlert("CW10025", "제품군이 주차인 경우, J호기만 청구 가능합니다.");
				return;
			}			

			//DEBUG("grd_list_OnExpandUp", "Material Type(ds_list.RGBN) is " + matType);

			// ES, MW 팝업화면 변경 2016.10.21 YW 
			if(substr(ds_list.GetColumn(nRow, "HNO"),6,1) == "S" || substr(ds_list.GetColumn(nRow, "HNO"),6,1) == "W")
			{
				arg = "fa_hty=" + quote(ds_list.GetColumn(nRow, "HTY")) + " fa_hogin=" + quote(ds_list.GetColumn(nRow, "HNO"));
					//DEBUG("grd_list_OnExpandUp", "Argument of popup CS9614001C is " + arg);
					mat = gfn_openPopup("MM0103004A",true, arg); 
					targetQuery = "cs01:CS0101008B_S10";
					
			} else {
				if(matType.length == 0 || matType == "1")							//보수자재 "":기존방식, "1":신규방식
				{
					arg = "fa_hty=" + quote(ds_list.GetColumn(nRow, "HTY")) + " fa_hogin=" + quote(ds_list.GetColumn(nRow, "HNO"));
					//DEBUG("grd_list_OnExpandUp", "Argument of popup CS9614001A is " + arg);
					mat = gfn_openPopup("CS9614001A",true, arg); 				
					targetQuery = "cs01:CS0101008B_S2";
				}
				else if (matType == "2")											//내작(BOM) 자재
				{
					arg = "fa_hty=" + quote(ds_list.GetColumn(nRow, "HTY")) + " fa_hogin=" + quote(ds_list.GetColumn(nRow, "HNO"));
					//DEBUG("grd_list_OnExpandUp", "Argument of popup CS9614001C is " + arg);
					mat = gfn_openPopup("CS9614001C",true, arg); 
					targetQuery = "cs01:CS0101008B_S10";
				}			
			}
			//DEBUG("grd_list_OnExpandUp", "Material No is " + mat);

			if(mat == "NS-100" || mat == "ns-100")	 							//NS-100은 견적에는 추가불가하고 sap전송시에만 사용됨
			{
				gfn_showAlert("CW10025", "해당 자재는 직접 사용불가 자재입니다.");
				return;
			}

			if(cb_reqkind.Value <> "S" && (mat == "NC-100" || mat == "nc-100"))	//시스템공사는 NC-100만 사용
			{
				gfn_showAlert("CW10025", "NC-100은 시스템공사에만 입력가능합니다.");
				return;
			}

			if(cb_reqkind.Value == "S" && (mat == "NB-100" || mat == "nb-100"))	//시스템공사는 NC-100만 사용
			{
				gfn_showAlert("CW10025", "시스템공사는 NC-100만 입력가능합니다.");
				return;
			}

			if(mat.length <= 1)
			{
				return;
			}

			ds_list.SetColumn(nRow, "MATNR",mat);

			ds_ma_cond.SetColumn(0, "MATNR", mat);
			ds_ma_cond.SetColumn(0, "NROW", nRow);
			//ds_ma_cond.SetColumn(0, "SPART", ds_pjt_det.GetColumn(0, "SPART"));
			ds_ma_cond.SetColumn(0, "SPART", cb_spartnm.Value);

			if (ds_list.GetColumn(nRow,"MATNR") == "0")
			{
				ds_list.SetColumn(nRow,"MATNR","");
			}
			else
			{
				tit_clearActionInfo();
				tit_addSearchActionInfo(targetQuery);
				tit_callService(
					""
					,""
					, "ds_ma_cond=ds_ma_cond"
					, "ds_ma_list=ds_ma_list"
					, ""
					, "ufn_setMatnr"
					, false
					, true);
			}
			break;
		default:
			break;
	}
}

/********************************************************************************
* 기      능   : 자재리스트의 컬럼 값 변경 시
********************************************************************************/
function ds_list_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{
	cnt = 0 ;
	//DEBUG("ds_list_OnColumnChanged", "ColumnID is " + strColumnID);
	switch(strColumnID)
	{
		case "HNO":																//호기번호컬럼의 값이 변경되면, 호기명컬럼도 세팅해준다.
			ds_list.FireEvent = false;
			
			//---------------------------시스템공사일 경우 자재에 호기는 하나만 등록---------------------------
			/*
			if(nRow != 0 && ds_list.GetColumn(nRow - 1, "HNO") != varNewValue && cb_reqkind.Value == "S" ) {
				gfn_showAlert("CW10025", "시스템 공사는 하나의 호기만 등록 가능합니다.");				
				ds_list.SetColumn(nRow, "HNO", ''); 
				ds_list.SetColumn(nRow, "HNA", ''); 
				ds_list.FireEvent = true;
				return;
			}			
			*/
			/*
			if ( ds_list.FindRow("HNO", varNewValue) == -1 && ds_list.GetCount() > 1 && ds_list.FindRow("HNO", varNewValue) != nRow ) {
				gfn_showAlert("CW10025", "시스템 공사는 하나의 호기만 등록 가능합니다.");				
				ds_list.SetColumn(nRow, "HNO", ''); 
				ds_list.SetColumn(nRow, "HNA", ''); 
				ds_list.FireEvent = true;
				return;			
			}
			*/
			
			for(var iCnt=0;iCnt < ds_list.rowcount;iCnt++)
			{
				if ( iCnt != nRow &&  ds_list.GetColumn(iCnt, "HNO") != varNewValue && length(ds_list.GetColumn(iCnt, "HNO")) > 0 && cb_reqkind.Value == "S") {
					gfn_showAlert("CW10025", "시스템 공사는 하나의 호기만 등록 가능합니다.");				
					ds_list.SetColumn(nRow, "HNO", ''); 
					ds_list.SetColumn(nRow, "HNA", ''); 
					ds_list.FireEvent = true;
					return;						
				}
			}
			
			
			//-------------------------------------------------------------------------------------------------			
			
			nHRow = ds_hna.SearchRow("WBS=\"" +  ds_list.GetColumn(nRow, "HNO") + "\"");
			ds_list.SetColumn(nRow, "HNA", ds_hna.GetColumn(nHRow, "HNA")); 	//ufn_clearDsList(nRow)
			ds_list.SetColumn(nRow, "HTY", ds_hna.GetColumn(nHRow, "HTY"));		//호기특성
			
			ds_list.FireEvent = true;
			break;
		case "HNA":																//호기명컬럼의 값이 변경되면, 호기번호컬럼도 세팅해준다.
			ds_list.FireEvent = false;
			nHRow = ds_hna.SearchRow("HNA=\"" +  ds_list.GetColumn(nRow, "HNA") + "\"");
			ds_list.SetColumn(nRow, "HNO", ds_hna.GetColumn(nHRow, "WBS"));
			ds_list.SetColumn(nRow, "HTY", ds_hna.GetColumn(nHRow, "HTY"));		//나중에 변경 불가 하도록 FILTERING할 것
			ds_list.FireEvent = true;
			break;
		case "RGBN":															//보수/BOM구분
			if(toNumber(varOldValue) > 0)										//신규입력이 아닌 경우에만 Clear
			{
				ufn_clearDsList(nRow);
			}
			
			ds_list.fireevent = false;
			
			//BOM타입으로 변경되었을 경우에는 업체재고소진 직영재고구분에 체크가 불가하도록(요구사항 62번)
			grd_list.SetCellProp("BODY", 17, "edit", "expr:decode(RGBN,2,'none','checkbox')");
			grd_list.SetCellProp("BODY", 18, "edit", "expr:decode(RGBN,2,'none','checkbox')");
			grd_list.SetCellProp("BODY", 17, "bkcolor", "expr:decode(RGBN,2,'white','user27')");
			grd_list.SetCellProp("BODY", 18, "bkcolor", "expr:decode(RGBN,2,'white','user27')");
			
			if(toNumber(varNewValue) == 2)										//BOM으로 변경되었을 경우 REQKIND 및 ZGUBN을 클리어한다.
			{
				ds_list.SetColumn(nRow, "REQKIND_CHK", "0");
				ds_list.SetColumn(nRow, "ZGUBN_CHK", "");
			}
			ds_list.SetColumn(nRow, "REQKIND", ds_out_master.GetColumn(0, "REQKIND"));
			ds_list.SetColumn(nRow, "ZGUBN", "");
						
			ds_list.fireevent = true;

			break;
		case "MATNR":
			//DEBUG("ds_list_OnColumnChanged", "MATNR is " + ds_list.Getcolumn(nRow, "MATNR"));
			var matType = ds_list.GetColumn(nRow, "RGBN");
			ds_list.fireevent = false;
			
			if(matType == "2")													//BOM자재일경우에는 직접입력은 의미가 없음
			{
				ds_list.SetColumn(nRow, "MATNR", "");
				ds_list.fireevent = true;
				return;
			}

			if(cb_spartnm.Value == "" || length(cb_spartnm.Value) == 0)
			{
				gfn_showAlert("CW10025", "제품군을 선택해주세요.");
				ds_list.fireevent = true;
				return;
			}

			if(ds_list.GetColumn(nRow, "HNO").length == 0)
			{
				gfn_showAlert("CW10025", "호기(WBS) 또는 호기명을 선택해주세요.");
				ds_list.SetColumn(nRow, "MATNR", "");
				ds_list.fireevent = true;
				return;
			}
			// 20171110 제품군에 따라 호기 정보 체크 이하림 
			if( cb_spartnm.Value == "20" && substr(ds_list.GetColumn(nRow, "HNO"), 6, 1) <> "J" )
			{
				gfn_showAlert("CW10025", "제품군이 주차인 경우, J호기만 청구 가능합니다.");
				ds_list.SetColumn(nRow, "MATNR","");
				ds_list.fireevent = true;
				return;
			}
			
			if(ds_list.GetColumn(nRow,"MATNR") == "NS-100" || ds_list.GetColumn(nRow,"MATNR") == "ns-100") 	//NS-100은 견적에는 추가불가하고 sap전송시에만 사용됨
			{
				ds_list.SetColumn(nRow, "MATNR", "");
				gfn_showAlert("CW10025", "해당 자재는 직접 사용불가 자재입니다.");
				ds_list.fireevent = true;
				return;
			}

			if(cb_reqkind.Value <> "S" && (ds_list.GetColumn(nRow,"MATNR") == "NC-100" || ds_list.GetColumn(nRow,"MATNR") == "nc-100"))	//시스템공사는 NC-100만 사용
			{
				ds_list.SetColumn(nRow, "MATNR", "");
				gfn_showAlert("CW10025", "NC-100은 시스템공사에만 입력가능합니다.");
				ds_list.fireevent = true;
				return;
			}

			if(cb_reqkind.Value == "S" && (ds_list.GetColumn(nRow,"MATNR") == "NB-100" || ds_list.GetColumn(nRow,"MATNR") == "nb-100"))	//시스템공사는 NC-100만 사용
			{
				ds_list.SetColumn(nRow, "MATNR", "");
				gfn_showAlert("CW10025", "시스템공사는 NC-100만 입력가능합니다.");
				ds_list.fireevent = true;
				return;
			}
	
			if(length(ds_list.GetColumn(nRow, "MATNR")) > 0)					//입력된 자재번호로 Query
			{
				ds_ma_cond.SetColumn(0, "MATNR", ToUpper(ds_list.Getcolumn(nRow, "MATNR")));
				ds_ma_cond.SetColumn(0, "NROW", nRow);
				//ds_ma_cond.SetColumn(0, "SPART", ds_pjt_det.GetColumn(0, "SPART"));
				ds_ma_cond.SetColumn(0, "SPART", cb_spartnm.Value);
				tit_clearActionInfo();
				tit_addSearchActionInfo("cs01:CS0101008B_S2");
				tit_callService("","", "ds_ma_cond=ds_ma_cond", "ds_ma_list=ds_ma_list", "", "ufn_setMatnr", false, true);
			}
			ds_list.fireevent = true;
			break;
		case "BWTAR":															//자재유형
			//논리적 오류로 평가유형 선택 후 다른 ROW로 이동 시 해당 ROW의 평가유형이 바뀌는 문제를 해결하기 위해 for문 추가
			for(var iCnt=0;iCnt < ds_list.rowcount;iCnt++)
			{
				ds_list.SetColumn(iCnt, "BWTAR", substr(ds_list.GetColumn(iCnt, "MTART"), 0, 1) + substr(ds_list.GetColumn(iCnt, "BWTAR"), 1));
			}
			if(substr(ds_list.GetColumn(nRow, "BWTAR"), 1, 1) == "A")
			{
				ds_list.SetColumn(nRow, "NETPR", ds_list.GetColumn(nRow, "NETPR_ORG"));
			}
			else if(substr(ds_list.GetColumn(nRow, "BWTAR"), 1, 1) == "B")			
			{
				ds_list.SetColumn(nRow, "NETPR", round(toNumber(ds_list.GetColumn(nRow, "NETPR_ORG")) * 0.4, 0));
			}
			else
			{
				ds_list.SetColumn(nRow, "NETPR", "0");
			}
			
		case "NETPR":
		case "MENGE":															//수량
			if(substr(ds_list.GetColumn(nRow, "MENGE"), 0, 1) == "-")
			{
				gfn_showAlert("CW10025", "특수문자는 사용이 불가합니다.");
				ds_list.SetColumn(nRow, "MENGE", "0");
				return;
			}
			
		case "OFRHOUR":															//견적공수
			ds_list.FireEvent = false;
			ufn_calcListValues(nRow);											//각종 계산식을 업데이트 한다.
			ds_list.FireEvent = true;
			ufn_calcCostValues("ds_list_OnColumnChanged");
			break;
		case "ZGUBN_CHK": 														//직영구분체크
			if(ds_list.GetColumn(nRow, "ZGUBN_CHK") == "1")
			{
				ds_list.SetColumn(nRow, "ZGUBN", "Y");
			}
			else
			{
				ds_list.SetColumn(nRow, "ZGUBN", "");
			}
			//DEBUG("ds_list_OnColumnChanged", "ZGUBN_CHK:" + ds_list.GetColumn(nRow, "ZGUBN_CHK") + "/ZGUBN:" + ds_list.GetColumn(nRow, "ZGUBN"));
			break;
		case "REQKIND_CHK":														//청구구분체크
			if(ds_list.GetColumn(nRow, "REQKIND_CHK") == "1")
			{
				ds_list.SetColumn(nRow, "REQKIND", "6");
			}
			else
			{
				ds_list.SetColumn(nRow, "REQKIND", ds_out_master.GetColumn(0, "REQKIND"));
			}
			//DEBUG("ds_list_OnColumnChanged", "REQKIND_CHK:" + ds_list.GetColumn(nRow, "REQKIND_CHK") + "/REQKIND:" + ds_list.GetColumn(nRow, "REQKIND"));
			break;			
		default:
			break;
	}
}

/********************************************************************************
* 기      능   : 청구구분이 바뀔 경우
********************************************************************************/
function cb_reqkind_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	//인덱스가 같으므로 변화가 없음
	if(nOldIndex == nNewIndex)
	{
		return;
	}
	if(strCode =="")
	{
		gfn_showAlert("CW10025", "청구구분을 선택해주세요.");
		return;
	}
	cb_agent.Enable = true;
	if(nOldIndex != nNewIndex) 
	{
		ed_his_ucost_ch.Value = 0;
		ed_his_lcost_ch.Value = 0;
		ed_his_inspec_ch.Value = 0;
		ed_his_log_ch.Value = 0;
		ed_his_etc_ch.Value = 0;
		//==================전현정대리요청 추가20181012==================//
		ed_his_betc_ch.Value = 0;
		ed_his_lift_ch.Value = 0;
		ed_his_mmod_ch.Value = 0;
		ed_his_safe_ch.Value = 0;
		
		if(strCode == "1") //부품판매일때만 할인율 보여줌
		{
			MaskEdit0.Visible = true;
		}else
		{
			MaskEdit0.Visible = false;
		}
		//===============================================================//
		
		ufn_setWriteCost(false);
	} 

	// 시스템 공사의 경우 MOD Package 구분 입력
	if(strCode == "S" && cb_spartnm.Value == "10") {
		cb_modgbn.Enable = true;
		cb_modgbn.Value = "M1";
		ds_agent.UnFilter();
	} else {
		cb_modgbn.Enable = false;
		cb_modgbn.Value = "";
		ds_agent.Filter("CODE != 'C'");
	}
	if(nNewIndex != 3 && cb_agent.Value = "C"){
		cb_agent.Value = "";
	}
	
	//=================최선경사원요청 추가20200813===================//
	if(strCode == "7") // 수리공사일때만 일식외주여부 체크박스 보여줌
	{
		chk_ilsic.Visible = true;
		chk_ilsic.Enable = true;
	}else
	{
		chk_ilsic.Visible = false;
		chk_ilsic.Enable = false;
		chk_ilsic.Value = 0; // 최초 수리공사 일식외주로 선택하고 다른 청구구분 선택 시 DB에 해당값이 저장되지 않도록 체크박스 해제처리
	}		
	//===============================================================//	
	
	//청구구분에 따른 계산값을 다시 계산한다.
	ufn_calcCostValues("cb_reqkind_OnChanged");
	
	
	//if ( lejchk = 'Y' and ds_out_master.GetColumn(0, "REQKIND") = '1' ) {
	if ( ds_out_master.GetColumn(0, "REQKIND") = '1' and ds_out_master.GetColumn(0, "DC_RATE") > 0 ) {
	    dcchk = 'Y';
		ufn_setObjectVisibility("btn_discount", true);
	}
	else {
		dcchk = '';
		ufn_setObjectVisibility("btn_discount", false);
	}
	
}

/********************************************************************************
* 기      능   : 판가할인액이 변경될 경우
********************************************************************************/
function ed_netwr_dc_OnChanged(obj,strText)
{
	//청구구분에 따른 계산값을 다시 계산한다.
	ufn_calcCostValues("ed_netwr_dc_OnChanged");	
}

/********************************************************************************
* 기      능   : 제경비 적용율이 변경될 경우
********************************************************************************/
function ed_exp_pct_OnChanged(obj,strText)
{
	//청구구분에 따른 계산값을 다시 계산한다.
	ufn_calcCostValues("ed_exp_pct_OnChanged");
}

/********************************************************************************
* 기      능   : 일반관리비 적용율이 변경될 경우
********************************************************************************/
function ed_mng_pct_OnChanged(obj,strText)
{
	//청구구분에 따른 계산값을 다시 계산한다.
	ufn_calcCostValues("ed_mng_pct_OnChanged");
}

/********************************************************************************
* 기      능   : 기업이윤 적용율이 변경될 경우
********************************************************************************/
function ed_pro_pct_OnChanged(obj,strText)
{
	//청구구분에 따른 계산값을 다시 계산한다.
	ufn_calcCostValues("ed_pro_pct_OnChanged");
}

/********************************************************************************
* 기      능   : 특이사항-야간작업 체크박스가 클릭될 경우
********************************************************************************/
function chk_night_OnClick(obj,strValue)
{
	//청구구분에 따른 계산값을 다시 계산한다.
	ufn_calcCostValues("chk_night_OnClick");
	ds_out_master.SetColumn(0, "NIGHT_WGT", chk_night.value);
}

/********************************************************************************
* 기      능   : 특이사항-휴일/철야작업 체크박스가 클릭될 경우
********************************************************************************/
function chk_weekend_OnClick(obj,strValue)
{
	//청구구분에 따른 계산값을 다시 계산한다.
	ufn_calcCostValues("chk_weekend_OnClick");
	ds_out_master.SetColumn(0, "WEEKEND_WGT", chk_weekend.value);
}

/********************************************************************************
* 기      능   : 견적구분 체크박스의 값이 변경될 경우
********************************************************************************/
function cb_cs001gbn_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	if(strCode == "01")
	{
		chk_pgubn.value = 0;
	}
	else
	{
		chk_pgubn.value = 1;
	}	
}

/********************************************************************************
* 기      능   : 계산서발행금액 2가 변경될 경우
********************************************************************************/
function me_bilamt2_OnChanged(obj,strText)
{
/*		me_bilamt1.value = ed_sum_ofr.Value;
		cal_bildat2.value = "";
		me_bilamt2.value = 0;
		cal_bildat3.value = "";
		me_bilamt3.value = 0;
*/
	me_bilamt1.value = toNumber(ed_sum_ofr.Value) - (toNumber(me_bilamt2.value) + toNumber(me_bilamt3.value));
}

/********************************************************************************
* 기      능   : 계산서 발행금액 3이 변경될 경우
********************************************************************************/
function me_bilamt3_OnChanged(obj,strText)
{
	me_bilamt1.value = toNumber(ed_sum_ofr.Value) - (toNumber(me_bilamt2.value) + toNumber(me_bilamt3.value));	
}

/********************************************************************************
* 기      능   : 자재리스트 클릭 시 해당 행의 평가유형별 필터링 정보를 세팅한다.
********************************************************************************/
function grd_list_OnCellClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
	//DEBUG("grd_list_OnCellClick", "nRow is " + nRow + ", BWTAR is " + ds_list.GetColumn(nRow, "BWTAR") + ", MTART is " + ds_list.GetColumn(nRow, "MTART"));

	switch(nCell)
	{
		case 6:																	//평가유형
		
			//논리적 오류로 평가유형 선택 후 다른 ROW로 이동 시 해당 ROW의 평가유형이 바뀌는 문제를 해결하기 위해 for문 추가
			for(var iCnt=0;iCnt < ds_list.rowcount;iCnt++)					
			{
				ds_list.SetColumn(iCnt, "BWTAR", substr(ds_list.GetColumn(iCnt, "MTART"), 0, 1) + substr(ds_list.GetColumn(iCnt, "BWTAR"), 1));
			}
			
			//DEBUG("grd_list_OnCellClick", "ds_list_CanRowPosChange - OldRow:" + nRow + "/nRow:" + nRow + "/MTART:" + ds_list.GetColumn(nRow, "MTART"));
			//평가유형별 필터링정보를 설정한다.
			if(ds_list.GetColumn(nRow, "MTART") == "PALB")
			{
				if(ds_list.GetColumn(nRow, "BANNAB") == "0")					//반납대상자재가 아닐경우
				{
					ds_bwtar_cd.Filter(" CODE>=" +quote("PA") +"&&CODE<" +quote("PR") + "&&CODE!="+quote("PB"));  //반납품제외 16.08.01 이동진dl요청
				}
				else															//반납대상자재일경우
				{
					ds_bwtar_cd.Filter(" CODE>=" +quote("PA") + "&&CODE!="+quote("PR"));
				}
			} 
			else if(ds_list.GetColumn(nRow, "MTART") == "HALB") 
			{
			
				if(ds_list.GetColumn(nRow, "BANNAB") == "0")					//반납대상자재가 아닐경우
				{
					ds_bwtar_cd.Filter(" CODE>=" +quote("HA") +"&&CODE<" +quote("HR") + "&&CODE!="+quote("HB"));
				}
				else															//반납대상자재일경우
				{
					ds_bwtar_cd.Filter(" CODE>=" +quote("HA") + "&&CODE!="+quote("HR"));
				}			
			} 
			else 
			{
				if(ds_list.GetColumn(nRow, "BANNAB") == "0")					//반납대상자재가 아닐경우
				{
					ds_bwtar_cd.Filter(" CODE>=" +quote("RA") +"&&CODE<" +quote("RR") + "&&CODE!="+quote("RB"));
				}
				else															//반납대상자재일경우
				{
					ds_bwtar_cd.Filter(" CODE>=" +quote("RA") + "&&CODE!="+quote("RR"));
				}	
			}	
			break;
		default:
			break;
	}
}

/********************************************************************************
* 기      능   : 견적복사기능을 수행한다.
********************************************************************************/
function btn_copy_offer_OnClick(obj)
{
	if(ds_out_master.GetColumn(0, "FLAG") == "I")
	{
		gfn_showAlert("CW10025", "저장되지 않은 견적입니다."); 
		return;
	}
	
	if(!gfn_showConfirm("CI30001", "현재 견적을 복사하여 새로운 견적을 생성하시겠습니까?"))
	{
		return;
	}
	
	//이후 계산에 필요한 부분은 남겨둔다.
	var tmpReqkind = cb_reqkind.value;											//청구구분
	
	//chk_weekend.fireevent = false;
	//ds_out_master.fireevent = false;
	
	//계산에 필요한 부분을 초기화 한다(초기화 하지 않으면 이후 ufn_initParameters의 ufn_calcCostValues 호출 시 Warning 발생)
	
	ed_netwr_dc.value = "";														//판매할인액
	ed_exp_pct.value = 5;														//제경비
	ed_mng_pct.value = 10;														//일반관리비
	ed_pro_pct.value = 10;														//기업이윤
	
	//복사를 위해 ds_out_master의 값을 삭제한다.
	ds_out_master.SetColumn(0, "FLAG", "I");									//저장플래그 "I"
	ds_out_master.SetColumn(0, "KUNNR","");										//고객번호
	ds_out_master.SetColumn(0, "SPT","");										//현장명
	ds_out_master.SetColumn(0, "CST","");										//거래선
	ds_out_master.SetColumn(0, "CSTNM","");										//거래선명
	ds_out_master.SetColumn(0, "SPART","");										//제품군
	ds_out_master.SetColumn(0, "SPARTNM","");									//제품군명
	ds_out_master.SetColumn(0, "VKGRP","");										//팀
	ds_out_master.SetColumn(0, "VKGRPNM","");									//팀명
	ds_out_master.SetColumn(0, "VKBUR","");										//사업장
	ds_out_master.SetColumn(0, "VKBURNM","");									//사업장명
	ds_out_master.SetColumn(0, "BSU","");										//업체코드
	ds_out_master.SetColumn(0, "BSUNM","");										//업체명
	ds_out_master.SetColumn(0, "PNAME","");										//담당자명
	ds_out_master.SetColumn(0, "LIFNR","");										//수리업체???
	ds_out_master.SetColumn(0, "BUSSI","");										//사업부구분(1:승강기/2:주차)
	ds_out_master.SetColumn(0, "SH_ADDR","");									//납품처주소
	ds_out_master.SetColumn(0, "UPN","");										//통합프로젝트번호
	ds_out_master.SetColumn(0, "VKBUR","");										//사업장
	ds_out_master.SetColumn(0, "VKBURNM","");									//사업장명	
	ds_out_master.SetColumn(0, "LIFNR","");										//수리업체
	ds_out_master.SetColumn(0, "REQNO","");										//청구번호
	ds_out_master.SetColumn(0, "QSTAT","");										//결재상태
	
	ds_out_master.SetColumn(0, "CHDAT","");										//변경일자
	ds_out_master.SetColumn(0, "CHTIM","");										//변경시간
	ds_out_master.SetColumn(0, "CRDAT","");										//작성일자
	ds_out_master.SetColumn(0, "CRNAME","");									//작성자명
	ds_out_master.SetColumn(0, "CRTIM","");										//작성시간
	
	//새로운 레코드를 생성하는 것이므로, 결재 관련 사항을 리셋한다.
	ds_out_master.SetColumn(0, "DOC1", "");
	ds_out_master.SetColumn(0, "DOC2", "");
	ds_out_master.SetColumn(0, "DOC3", "");
	ds_out_master.SetColumn(0, "DOC4", "");
	ds_out_master.SetColumn(0, "DOC5", "");
	ds_out_master.SetColumn(0, "DOC1STAT", "");
	ds_out_master.SetColumn(0, "DOC2STAT", "");
	ds_out_master.SetColumn(0, "DOC3STAT", "");
	ds_out_master.SetColumn(0, "DOC4STAT", "");
	ds_out_master.SetColumn(0, "DOC5STAT", "");
	ds_out_master.SetColumn(0, "DOC1STATNM", "");
	ds_out_master.SetColumn(0, "DOC2STATNM", "");
	ds_out_master.SetColumn(0, "DOC3STATNM", "");
	ds_out_master.SetColumn(0, "DOC4STATNM", "");
	ds_out_master.SetColumn(0, "DOC5STATNM", "");
	ds_out_master.SetColumn(0, "DOC1DEC", "");
	ds_out_master.SetColumn(0, "DOC2DEC", "");
	ds_out_master.SetColumn(0, "DOC3DEC", "");
	ds_out_master.SetColumn(0, "DOC4DEC", "");
	ds_out_master.SetColumn(0, "DOC5DEC", "");
	
	//새로운 레코드를 생성하는 것이므로, 견적 관련 사항을 리셋한다.
	ds_out_master.SetColumn(0, "PS_PSPID", "");									//원WBS
	ds_out_master.SetColumn(0, "QSTAT", "");									//청구상태
	ds_out_master.SetColumn(0, "CHGBN", "");									//견적상태
	ds_out_master.SetColumn(0, "ENDYN", "");									//견적종료여부
	
	ds_out_master.SetColumn(0, "ILSIC_YN", "");									//수리공사-일식외주여부

	for(var iCnt=0;iCnt < ds_list.rowcount;iCnt++)								//ds_list값 중 HNA, HNO를 삭제하고 FLAG를 신규(I)로 설정한다.
	{
		ds_list.SetColumn(iCnt, "HNO", "");
		ds_list.SetColumn(iCnt, "HNA", "");
		ds_list.SetColumn(iCnt, "FLAG", "I");
	}
	
	ds_pjt_det.clearData();														//프로젝트 상세 정보를 클리어한다.
	ds_key.clearData();															//ds_key를 clear한다.
	ds_key.AddRow();															
	ds_cond.clearData();														//검색조건을 clear한다.
	ds_cond.addRow();
	ds_hna.clearData();															//자재 신청용 호기정보를 Clear한다.
	ds_seq.clearData();															//차수정보를 clear한다.
	ds_seq.addRow();															//차수정보를 신규와 동일하게 설정한다.
	ds_seq.SetColumn(0, "CODE", "0");
	ds_seq.SetColumn(0, "CODE_NAME", "원본");
	
	ds_out_elj.clearData();															//ds_key를 clear한다.
	ds_out_elj.AddRow();
	ds_out_elj.SetColumn(0, "FLAG", "I");				
	
	ufn_initParameters();														//값을 초기화 한다.
	
	cb_reqkind.value = tmpReqkind;												//청구구분값을 설정한다.(계산을 위해 필요함)
	//ed_netwr_dc.value = tmpNetwrDc;											//판매할인액을 설정한다.

	//chk_weekend.fireevent = true;
	//ds_out_master.fireevent = true;
	ufn_calcCostValues("btn_copy_offer_OnClick");								//값을 다시 계산한다.
	
	//DEBUG("btn_copy_offer_OnClick", "ds_out_master is " + ds_out_master.saveXml());
	
	ufn_setPermissions();
	
	copyFlag = true;
}

/********************************************************************************
* 기      능   : 변경된 차수를 반영한다.
********************************************************************************/
function cb_seq_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	if(nOldIndex == ds_seq.max("CODE") && selfFlag) 							//본인인 경우 최종차수에서만 confirm 출력. 나머지 경우는 confirm없음( 본인 이외 editing 불가)
	{
		if(!gfn_showConfirm("CW10025", "다른 차수를 검색하시겠습니까?\n저장되지 않은 모든 작업이 취소됩니다.")) return;
	}

	ds_cond.SetColumn(0, "SEQ", cb_seq.Value);									//검색조건을 설정한다.
	
	ufn_resetAll();																//모든 정보를 리셋한다.
	ufn_initParameters();														//Parameter를 초기화한다.
}

/********************************************************************************
* 기      능   : 수주등록
********************************************************************************/
function btn_save_con_OnClick(obj)
{
	var docNo1, docNo2;															//견적결재문서번호, 수주결재문서번호
	var docNo1Stat, docNo2Stat;													//결재상태1, 결재상태2
	shdatFlag = true;	
	docNo1 = ds_out_master.GetColumn(0, "DOC1");								//견적결재문서번호
	docNo2 = ds_out_master.GetColumn(0, "DOC2");								//수주결재문서번호
	docNo1Stat = ds_out_master.GetColumn(0, "DOC1STAT");						//견적결재상태
	docNo2Stat = ds_out_master.GetColumn(0, "DOC2STAT");						//수주결재상태
	
	if(!ufn_checkInputForSave())												//수주시 계산서 관련 항목 체크를 위해 입력항목을 재확인한다.
	{
		return;
	}
	if(!Check_Suju())	return false;
	if(docNo1.length <= 0)														//견적번호가 제대로 입력되지 않았으면..
	{
		gfn_showAlert("CW10025", "기안이 완료되지 않았습니다.");
		return;
	}

	if(toNumber(docNo1Stat) < 3)												//견적기안결재가 완료되지 않았으면..
	{
		gfn_showAlert("CW10025", "견적결재가 완료되지 않았습니다.");
		return;
	}

	if(docNo2Stat.length > 0 || docNo1Stat == "6")
	{
		gfn_showAlert("CW10025", "이미 수주등록이 완료되었습니다.");
		return;
	}

	if(!gfn_showConfirm("CI30001", "본 견적건에 대한 수주등록을 수행하시겠습니까?"))
	{
		return;
	}
	
	ds_dec.ClearData();
	ds_dec.AddRow();
	
	ds_dec.SetColumn(0, "DOCNO", docNo1);										//견적결재문서번호
	ds_dec.SetColumn(0, "APPGUBN", "S");										//결재구분은 기안부서결재
	ds_dec.SetColumn(0, "APSTAT", "6");											//견적결재상태를 6으로 변경 - 6으로는 수주등록시 변경
	ds_dec.SetColumn(0, "DOCKIND", "12");										//견적결재의 문서종류(12)
	ds_dec.SetColumn(0, "REIRUM", G_USER_NAME);									//처리자이름
	
	//DEBUG("btn_save_con_OnClick", ds_dec.SaveXml());	
	
	//결재마스터(zwbap01)를 업데이트 해준다.
	tit_clearActionInfo();
	tit_addSingleActionInfo("cs01:CS0101008B_U1");								//견적마스터 Update for 계산서 관련사항
	tit_addMultiActionInfo("cs04:CS0401001A_U1");								//결재마스터 Update
	//tit_addSingleActionInfo("cs01:CS0101008B_U6");								//최종견적여부(ZCST001-ASTAT)를 업데이트한다.
	tit_callService(
		"",
		"",
		"ds_head=ds_dec ds_list_0=ds_dec ds_out_master=ds_out_master",
		"",
		"",
		"", 
		true, 
		false,
		true);	
	
	gfn_showAlert("CI30001", "수주등록이 완료되었습니다.");
	
	ufn_resetAll();																//모든 정보를 리셋한다.
	ufn_initParameters();														//Parameter를 초기화한다.
	
	if(div_btn.btn_draft.Enable == true) 										//기안가능한 사용자이면 기안으로 바로 연결
	{
		fn_draft();																//수주등록 완료 후 바로 기안으로 연결
	}
}

/********************************************************************************
* 기      능   : <<DEBUG ONLY>> 수주를 전송완료 상태로 표시하기 위해 원WBS를 생성 Update한다. 
********************************************************************************/
function debug_btn_xfer_OnClick(obj)
{
	var strPSPID;
	
	strPSPID = ds_out_master.GetColumn(0, "UPN");

	if(ds_out_master.GetColumn(0, "REQKIND") == "1")
		strPSPID += "NB";
	else
		strPSPID += "NS";
		
	strPSPID += substr(ds_out_master.GetColumn(0, "QTNUM"), 7);
	
	//DEBUG("debug_btn_xfer_OnClick", "Temporary PS_PSPID is : " + strPSPID);
	
	ds_out_master.SetColumn(0, "PS_PSPID", strPSPID);
	
	tit_clearActionInfo();
	tit_addSingleActionInfo("cs01:CS0101008B_U4");								//견적마스터 Update (견적승인일 또는 수주승인일 업데이트가 필요할때)
	tit_callService("", "", "ds_out_master=ds_out_master", "", "", "",  true, false, true);	
	
	gfn_showAlert("CI30001", "** Local Test Only **" +
							 "\n\nSAP전송 설정 적용이 완료되었습니다. " + 
							 "\n\n본 기능은 테스트를 위해 SAP 전송 결과를 견적마스터에 임의로 적용합니다. " +
							 "\n현업 사용은 불가합니다.");
		
	return;
}

/********************************************************************************
* 기      능   : 호기별 청구를 위해 호기별 청구 화면을 Call한다.
********************************************************************************/
function bt_hogiInput_OnClick(obj)
{
	var inputArg;																//인수
	var retValue;																//리턴값
	var projectNo;																//통합프로젝트번호
	
	projectNo = ds_out_master.GetColumn(0, "UPN");
	if(projectNo.length <= 0)
	{
		gfn_showAlert("CW10025", "프로젝트를 선택하세요.");
		return;
	}
	
	if(toNumber(cb_reqkind.Value) <= 0)
	{
		gfn_showAlert("CW10025", "청구구분을 선택하세요.");
		cb_reqkind.SetFocus();
		return;
	}
	
	inputArg = " fa_pjt="+ quote(projectNo) + 
			   " fa_kind="+ quote(cb_reqkind.value) + 
			   " fa_cst=" + quote(ds_out_master.getColumn(0, "CST")) + 
			   " fa_origin='008B'";
			   
	//DEBUG("bt_hogiInput_OnClick", "inputArg is " + inputArg);
	
	var retValue = gfn_openPopup("CS0101008E",true, inputArg);
}

/********************************************************************************
* 기      능   : 실패현장청구 여부에 따라 업체재고소진 청구여부를 설정한다.
********************************************************************************/
function chk_fail_OnClick(obj,strValue)
{
	ufn_checkFailSite();
}

/********************************************************************************
* 기      능   : 실패현장청구 여부에 따라 업체재고소진 청구여부를 설정한다.
********************************************************************************/
function ufn_checkFailSite()
{
	//DEBUG("ufn_checkFailSite", "called");
	strValue = chk_fail.Value;

	ds_list.fireevent = false;

	if(strValue == "Y")															//실패현장청구 Check
	{
		for(var iCnt = 0; iCnt < ds_list.count; iCnt++)
		{
			ds_list.SetColumn(iCnt, "REQKIND_CHK", 0);							//업체재고소진청구 Clear
			ds_list.SetColumn(iCnt, "REQKIND", "G");							//청구종류 = 실패현장청구(G)
		}
		grd_list.SetCellProp("BODY", 18, "edit", "none");						//업체재고소진 청구가 불가능하게 한다.
		grd_list.SetCellProp("BODY", 18, "bkcolor", "white");
		grd_list.SetCellProp("BODY", 18, "bkImageID", "");
	}
	else																		//실패현장청구 Uncheck
	{
		for(var iCnt = 0;iCnt < ds_list.count; iCnt++)
		{
			ds_list.SetColumn(iCnt, "REQKIND", 
						ds_out_master.GetColumn(0, "REQKIND"));					//청구종류 = 마스터 청구종류
			ds_list.SetColumn(iCnt, "REQKIND_CHK", "0");						//업체재고소진 = 언클릭
		}	
		grd_list.SetCellProp("BODY", 18, "edit", "checkbox");
		grd_list.SetCellProp("BODY", 18, "bkcolor", "user27");
		grd_list.SetCellProp("BODY", 18, "bkImageID", "icon_grid_edit");
	}
	
	ds_list.fireevent = true;
}

/********************************************************************************
* 기      능   : 견적서를 출력한다.
********************************************************************************/
function btn_print_ofr_OnClick(obj)
{
	if(ds_list.Count <= 0)
	{
		gfn_showAlert("CW10025", "출력할 부품이 존재하지 않습니다.");
		return;
	}

	ds_cond.SetColumn(0, "LIFNR", ds_out_master.GetColumn(0, "LIFNR"));
	ds_cond.SetColumn(0, "QTNUM", ds_out_master.GetColumn(0, "QTNUM"));
	ds_cond.SetColumn(0, "SEQ", ds_out_master.GetColumn(0, "SEQ"));
	
	tit_clearActionInfo();					
	tit_addSearchActionInfo("cs01:CS0101008B_S11");					
	tit_addSearchActionInfo("cs01:CS0101008B_S13");						
	tit_addSearchActionInfo("cs01:CS0101008B_S17");			
	tit_callService("", "", "ds_cond=ds_cond", "ds_vkdet=ds_vkdet ds_list_sum=ds_list_sum ds_prtCustomer=ds_prtCustomer", "", "", true, false, true);	
	
	if(ds_vkdet.rowcount == 0)
	{
		ds_vkdet.AddRow();
	}
	
	if(gfn_showConfirm("CI30001", "부가세 포함으로 견적하시겠습니까?                   확인:부가세포함, 취소:부가세미포함"))
	{
		ds_vkdet.SetColumn(0, "VAT", "1");
	}
	else
	{
		ds_vkdet.SetColumn(0, "VAT", "");
	}
	
	//DEBUG("btn_print_ofr_OnClick", "ds_cond is " + ds_cond.Savexml());
	//DEBUG("btn_print_ofr_OnClick", "ds_vkdet is " + ds_vkdet.Savexml());
	//DEBUG("btn_print_ofr_OnClick", "ds_list_sum is " + ds_list_sum.Savexml());
	
	//Dialog("CS01::CS0101008F2.xml", ""); // 20160701 견적서 출력 양식 변경 ( 발주 승인 대체 )
	Dialog("CS01::CS0101008F.xml", ""); // 20160701 견적서 출력 양식 변경 ( 발주 승인 대체 )

}

/********************************************************************************
* 기      능   : 부품요청서를 출력한다.
********************************************************************************/
function btn_print_req_OnClick(obj)
{
	if(ds_list.Count <= 0)
	{
		gfn_showAlert("CW10025", "출력할 부품이 존재하지 않습니다.");
		return;
	}

	ufn_setMatAmount();																//자재별 최종견적가를 설정한다.

	//DEBUG("btn_print_req_OnClick", "ds_list_parts is " + ds_list_parts.SaveXml());

	ds_vkdet.clearData();
	ds_cond.SetColumn(0, "LIFNR", ds_out_master.GetColumn(0, "LIFNR"));

	tit_clearActionInfo();					
	tit_addSearchActionInfo("cs01:CS0101008B_S11");	
	tit_addSearchActionInfo("cs01:CS0101008B_S13");	
	tit_callService("", "", "ds_cond=ds_cond", "ds_vkdet=ds_vkdet ds_list_sum=ds_list_sum", "", "", true, false, true);	

	for(var outCnt=0;outCnt < ds_list_sum.rowcount;outCnt++)						//동일자재당 최종견적가를 계산한다.
	{
		ds_list_sum.SetColumn(outCnt, "AMOUNT", 0);
		
		for(var inCnt=0;inCnt < ds_list.rowcount;inCnt++)
		{
			/*  동일자재라도 단가가  상이하여 아래 로직으로 수정 (2020.03.23)
			if(ds_list_sum.GetColumn(outCnt, "MATNR") == ds_list.GetColumn(inCnt, "MATNR") &&
			   ds_list_sum.GetColumn(outCnt, "MAKTX") == ds_list.GetColumn(inCnt, "MAKTX"))
			*/
			if(ds_list_sum.GetColumn(outCnt, "MATNR") == ds_list.GetColumn(inCnt, "MATNR") &&
			   ds_list_sum.GetColumn(outCnt, "MAKTX") == ds_list.GetColumn(inCnt, "MAKTX") &&
			   ds_list_sum.GetColumn(outCnt, "NETPR") == ds_list.GetColumn(inCnt, "NETPR") 
			   ) 
			 
			 
			{
				if(toNumber(ds_list.GetColumn(inCnt, "AMOUNT")) == 0)				//신규시스템 이전에 작성된 업체재고소진(6), 실패현장청구(G)건은 AMOUNT가 0
				{
					ds_list_sum.SetColumn(outCnt, "AMOUNT", round(ds_list_sum.GetColumn(outCnt, "NETWR"), 0));	//0이면 해당 금액에 자재금액을 넣어줌
				}
				else
				{
					ds_list_sum.SetColumn(outCnt, "AMOUNT", toNumber(ds_list_sum.GetColumn(outCnt, "AMOUNT")) + round(ds_list.GetColumn(inCnt, "AMOUNT"), 0));
				}
			}
		}
	}

	//DEBUG("btn_print_ofr_OnClick", "ds_list_sum is " + ds_list_sum.Savexml());

	gfn_copyDs(ds_list_sum, ds_list_parts);											//부품요청서 데이터셋에 카피한다.
	if(ds_vkdet.rowcount == 0)
	{
		ds_vkdet.AddRow();
	}

	if(gfn_showConfirm("CI30001", "부가세 포함으로 견적하시겠습니까?                   확인:부가세포함, 취소:부가세미포함"))
	{
		ds_vkdet.SetColumn(0, "VAT", "1");
	}
	else
	{
		ds_vkdet.SetColumn(0, "VAT", "");
	}
	
	//DEBUG("btn_print_ofr_OnClick", "ds_vkdet is " + ds_vkdet.Savexml());
	Dialog("CS01::CS0101008G.xml", "");
}

function cb_spartnm_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	if(cb_spartnm.Value == "10") { //승강기
		ds_out_master.SetColumn(0, "SPART", "10");
		ds_out_master.SetColumn(0, "BUSSI", "1");
		
	
		//제품군이 주차인경우 업체의 조직정보가 아닌 특정 조직 지정으로 인하여 추가(2018.07.23)
		//=======================================시작=======================================
		ds_out_master.SetColumn(0, "VKGRP", ds_pjt_det.GetColumn(0, "VKGRP"));					//팀
		ds_out_master.SetColumn(0, "VKGRPNM", ds_pjt_det.GetColumn(0, "VKGRPNM"));				//팀명
		ds_out_master.SetColumn(0, "VKBUR", ds_pjt_det.GetColumn(0, "VKBUR"));					//사업장
		ds_out_master.SetColumn(0, "VKBURNM", ds_pjt_det.GetColumn(0, "VKBURNM"));				//사업장명
		//=======================================끝=========================================
//TRACE(ds_pjt_det.SaveXML()		);
//TRACE(ds_out_master.SaveXML()		);
//ALERT("승강기");			
		
	} else if(cb_spartnm.Value == "20") { //주차
		ds_out_master.SetColumn(0, "SPART", "20");
		ds_out_master.SetColumn(0, "BUSSI", "2");
		
	
		//제품군이 주차인경우 업체의 조직정보가 아닌 특정 조직 지정으로 인하여 추가(2018.07.23)
		//=======================================시작=======================================
		ds_out_master.SetColumn(0, "VKGRP", ds_j_depart.GetColumn(0, "J_VKGRP"));					//팀
		ds_out_master.SetColumn(0, "VKGRPNM", ds_j_depart.GetColumn(0, "J_VKGRPNM"));				//팀명
		ds_out_master.SetColumn(0, "VKBUR", ds_j_depart.GetColumn(0, "J_VKBUR"));					//사업장
		ds_out_master.SetColumn(0, "VKBURNM", ds_j_depart.GetColumn(0, "J_VKBURNM"));				//사업장명
		//=======================================끝=========================================		
//TRACE(ds_j_depart.SaveXML()		);		
//TRACE(ds_out_master.SaveXML()		);		
//ALERT("주차");			
		
	} else if(cb_spartnm.Value == "40") { //PSD
		ds_out_master.SetColumn(0, "SPART", "40");
		ds_out_master.SetColumn(0, "BUSSI", "4");
				
		//제품군이 주차인경우 업체의 조직정보가 아닌 특정 조직 지정으로 인하여 추가(2018.07.23)
		//=======================================시작=======================================
		ds_out_master.SetColumn(0, "VKGRP", ds_pjt_det.GetColumn(0, "VKGRP"));					//팀
		ds_out_master.SetColumn(0, "VKGRPNM", ds_pjt_det.GetColumn(0, "VKGRPNM"));				//팀명
		ds_out_master.SetColumn(0, "VKBUR", ds_pjt_det.GetColumn(0, "VKBUR"));					//사업장
		ds_out_master.SetColumn(0, "VKBURNM", ds_pjt_det.GetColumn(0, "VKBURNM"));				//사업장명
		//=======================================끝=========================================		
//ALERT("PSD");		
		
		
	}

		// 시스템 공사의 경우 MOD Package 구분 입력
	if(strCode != "20" && cb_reqkind.Value == "S") {
		cb_modgbn.Enable = true;
		cb_modgbn.Value = "M1";
		ds_agent.UnFilter();
	} else {
		cb_modgbn.Enable = false;
		cb_modgbn.Value = "";
		ds_agent.Filter("CODE != 'C'");
	}
	
}

/********************************************************************************
* 기      능   : bom 청구여부 체크 
********************************************************************************/
function chk_bom_OnClick(obj,strValue)
{
	if(strValue == 'Y')	{
		//cal_shdat.Value = gfn_getAfterDate(gfn_getCurrDate(),21);	
		
		// 2021.03.22 BOM 체크 시 납기일의 경우 캘린더데이 기준 +23일 세팅. 서비스자재 최병준 요청. Han JH
		cal_shdat.Value = gfn_getAfterDate(gfn_getCurrDate(),23);
	}
	  //cal_shdat.Value = gfn_getWorkingDate('21', '2000', gfn_getCurrDate()); 
	else{	
		cal_shdat.Value = gfn_getCurrDate();
		cal_bomdat.Value = '0000-00-00';
	}
}

/********************************************************************************
* 기      능   : bom 누락 건 등록 처리
********************************************************************************/
function btn_bom_OnClick(obj)
{
	ds_key.clearData();
	ds_key.AddRow();
	ds_key.SetColumn(0, "QTNUM", ds_out_master.GetColumn(0, "QTNUM"));
	ds_key.SetColumn(0, "SEQ", ds_out_master.GetColumn(0, "SEQ"));
	
	//ds_out_master.SetColumn(0, "BOMDATE", cal_bomdat.Value);
	
	// ******* BOM 사양 타입 구분 201610  ******  //
	// var tmp_wbs = ds_list.GetColumn(i, "HNO") ;
	// var tmp_typ = substr(tmp_wbs, 6 , 1) ;
	// var typ = "EL"; 
	
	// if(tmp_typ == "L") { typ = "EL"; } 
	// else if(tmp_typ == "S") { typ = "ES"; }
	// else if(tmp_typ == "W") { typ = "MW"; }
	// else if(tmp_typ == "J") { typ = "AP"; }
	
	// ds_key.SetColumn(0, "TYPE", typ );
	// ds_key.SetColumn(0, "BOMDATE", XXX );
	
	//=========기 청구된 내용인지 확인=================
	tit_clearActionInfo();
	tit_addSearchActionInfo("cs01:CS0101008B_S22");
	
	tit_callService(
        ""
        , ""
        , "ds_key=ds_key"
        , "ds_bom_ck=ds_bom_ck"
        , ""
        , ""
        , ""
        , ""
        , true);	
	
	if(ds_bom_ck.GetColumn(0,"BM_CNT") > 0)
	{
		gfn_showAlert("CW00137");
		return;
	}
	//==============================================
	
	
	//입력된 자재가 내작자재만 있는 경우를 체크
	var tmp_rgbn = "Y";
	
	for(var i=0; i<ds_list.rowcount; i++) {
		if(ds_list.GetColumn(i, "RGBN") == "1") { //보수자재
			tmp_rgbn = "N";
		}
	}
	if (!gfn_showConfirm("CI30001","BOM 등록 하시겠습니까?")) return;
	
	//BOM 등록 시 청구예정일자 체크 2016.11.15
	if(length(cal_bomdat.Value) == 0)
	{
		gfn_showAlert("CW10025", "BOM 청구예정일자를 입력해주세요.");
//		cal_bomdat.Enable = true;
//		return;
	}

	tit_clearActionInfo();
	if(tmp_rgbn == "N") {
			tit_addSingleActionInfo("cs01:CS0101008B_I6");
		} else {
			tit_addSingleActionInfo("cs01:CS0101008B_I7");
		}

	//tit_addSingleActionInfo("cs01:CS0101008B_I8");
	tit_callService(
        ""
        , ""
        , "ds_out_master=ds_out_master ds_key=ds_key"
        , "ds_key = ds_key"
        , ""
        , "fn_afterSave2");

}

/********************************************************************************
* 기      능   : bom 등록 Callback  
********************************************************************************/
function fn_afterSave2(errCode, errMsg) {
	if ( errCode!= 0 ) {
		gfn_showMsg("CE00001");
	} else {
		gfn_showMsg("CI00003");	
	}
}


/********************************************************************************
* 기      능   : 예산 추가 입력 란 
********************************************************************************/
function ed_his_ucost_ch_OnChanged(obj,strText)
{
	// 원가내역 재계산
	ufn_calcCostValues("ed_his_ucost_ch_OnChanged");
}

function ed_his_lcost_ch_OnChanged(obj,strText)
{
	// 원가내역 재계산
	ufn_calcCostValues("ed_his_lcost_ch_OnChanged");
}

function ed_his_inspec_ch_OnChanged(obj,strText)
{
	// 원가내역 재계산
	ufn_calcCostValues("ed_his_inspec_ch_OnChanged");
}

function ed_his_log_ch_OnChanged(obj,strText)
{
	// 원가내역 재계산
	ufn_calcCostValues("ed_his_log_ch_OnChanged");
}

function ed_his_etc_ch_OnChanged(obj,strText)
{
	// 원가내역 재계산
	ufn_calcCostValues("ed_his_etc_ch_OnChanged");
}

//==================전현정대리요청 추가20181012==================//
function ed_his_betc_ch_OnChanged(obj,strText)
{
	// 원가내역 재계산
	ufn_calcCostValues("ed_his_betc_ch_OnChanged");
}

function ed_his_lift_ch_OnChanged(obj,strText)
{
	// 원가내역 재계산
	ufn_calcCostValues("ed_his_lift_ch_OnChanged");	
}

function ed_his_mmod_ch_OnChanged(obj,strText)
{
	// 원가내역 재계산
	ufn_calcCostValues("ed_his_mmod_ch_OnChanged");		
}

function ed_his_safe_ch_OnChanged(obj,strText)
{
	// 원가내역 재계산
	ufn_calcCostValues("ed_his_safe_ch_OnChanged");		
}
//===============================================================//


function ufn_setWriteCost(arr){

	if(arr == false)
	{
		ufn_enableComponent("ed_his_ucost_ch", false);
		ufn_enableComponent("ed_his_lcost_ch", false);
		ufn_enableComponent("ed_his_inspec_ch", false);
		ufn_enableComponent("ed_his_log_ch", false);
		ufn_enableComponent("ed_his_etc_ch", false);
		//==================전현정대리요청 추가20181012==================//
		ufn_enableComponent("ed_his_betc_ch", false);
		ufn_enableComponent("ed_his_lift_ch", false);
		ufn_enableComponent("ed_his_mmod_ch", false);
		ufn_enableComponent("ed_his_safe_ch", false);
		//===============================================================//
		
	} 
}
/********************************************************************************
* 기      능   : 예산 추가등록 버튼
********************************************************************************/
function btn_writeCost_OnClick(obj)
{
	//if(G_USER_ID == "2021200" || G_USER_ID == "2018900" || G_USER_ID == "2029758") {
	if (vWriteCost == true){
		// 원가 재계산
		ufn_calcCostValues(); 
	}
	
	var t_reqkind = cb_reqkind.Value ;

	//----------------------------------------------------------------------
	//nb-100 ns-100 nc-100 여부 체크 
	var chk_matnr = "N";
	
	for(iCnt=0;iCnt < ds_list.Count;iCnt++)
	{
		if( ds_list.getColumn(iCnt, "MATNR") == "NB-100" || ds_list.getColumn(iCnt, "MATNR") == "NS-100" || ds_list.getColumn(iCnt, "MATNR") == "NC-100" )
		{
			chk_matnr = "Y"; 
		}
	}
	// 제품군 주차 외에는 부판 추가입력 불가능 처리 20170519 이하림 
	if(cb_spartnm.Value != "20") {		
		if(t_reqkind == "1") // 부품판매는 추가 입력 불가능 
		{
			ufn_setWriteCost(false);
		}
	}

	if(ds_list.rowcount == 0) 
	{
		ufn_setWriteCost(false);
		return;
	}

	if(chk_matnr = "Y" ) 
	{
		ufn_enableComponent("ed_his_ucost_ch", true);
		ufn_enableComponent("ed_his_lcost_ch", true);
		ufn_enableComponent("ed_his_etc_ch", true);
		
		//==================전현정대리요청 추가20181012==================//
		ufn_enableComponent("ed_his_betc_ch", true);  //건축부대
		ufn_enableComponent("ed_his_lift_ch", true);  //양중비
		ufn_enableComponent("ed_his_mmod_ch", true);  //무상MOD  
		ufn_enableComponent("ed_his_safe_ch", true);  //안전관리비		
	    //===============================================================//
	    
		ufn_setObjectVisibility("btn_saveCost", true);
	}
	
	// 직영 구분
	var t_tgb = ds_pjt_det.GetColumn(0, "TGB") ;
	// 직영 + 수리공사/시스템공사 인 경우 외주 인건비 추가 입력 가능 처리 20170926
	if(t_reqkind == "7" || t_reqkind == "S") 
	{
		if(t_tgb == "1") {
			ufn_enableComponent("ed_his_lcost_ch", true);
		}
	}
	
	if(cb_spartnm.Value != "20") {
		if(t_reqkind == "7")  // 1: 부품판매,  7: 수리공사,  S: 시스템공사
		{	
			ufn_enableComponent("ed_his_inspec_ch", false);
			ufn_enableComponent("ed_his_log_ch", true);
			ufn_enableComponent("ed_his_etc_ch", true);
			//==================전현정대리요청 추가20181012==================//
			ufn_enableComponent("ed_his_betc_ch", false);  //건축부대
			ufn_enableComponent("ed_his_lift_ch", false);  //양중비
			ufn_enableComponent("ed_his_mmod_ch", false);  //무상MOD  
			ufn_enableComponent("ed_his_safe_ch", false);  //안전관리비		
			//===============================================================//
			
			ufn_setObjectVisibility("btn_saveCost", true);
		}
		else if(t_reqkind == "S")
		{	
			ufn_enableComponent("ed_his_inspec_ch", true);
			ufn_enableComponent("ed_his_log_ch", true);
			ufn_enableComponent("ed_his_etc_ch", true);
			//==================전현정대리요청 추가20181012==================//
			ufn_enableComponent("ed_his_betc_ch", true);  //건축부대
			ufn_enableComponent("ed_his_lift_ch", true);  //양중비
			ufn_enableComponent("ed_his_mmod_ch", true);  //무상MOD  
			ufn_enableComponent("ed_his_safe_ch", true);  //안전관리비		
			//===============================================================//
			
			ufn_setObjectVisibility("btn_saveCost", true);
		}
		else 
		{
			ufn_setWriteCost(false);
		}	
	}
}

/********************************************************************************
* 기      능   : 예산 수정 
********************************************************************************/
function btn_saveCost_OnClick(obj)
{
	if(length(ed_his_rate_fn.value) == 0 ) {
		alert("추가 예산 입력이 안되어 있습니다.");
		return;
	}
	
	ds_key.clearData();
	ds_key.AddRow();
	ds_key.SetColumn(0, "QTNUM", ds_out_master.GetColumn(0, "QTNUM"));
	ds_key.SetColumn(0, "SEQ", ds_out_master.GetColumn(0, "SEQ"));

	tit_clearActionInfo();
	tit_addSingleActionInfo("cs01:CS0101008B_U9");
	tit_addSelectExActionInfo("cs01:CS0101008B_S19", "cs01:CS0101008B_I8", "cs01:CS0101008B_U8");
	tit_callService(
        ""
        , ""
        , "ds_out_master=ds_out_master ds_key=ds_key"
        , ""
        , ""
        , ""
        , true, false, true);


	ufn_setObjectVisibility("btn_saveCost", false);
	ufn_setWriteCost(false);
}

function cb_cyn_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	if(cb_cyn.Value == "N") {
		cb_ctp.Enable = false;
		cb_ctp.Index = -1;
	} else {
		cb_ctp.index = 0;
		cb_ctp.Enable = true;
		cb_ctp.SetFocus();
	}
}
function cb_modgbn_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	if(cb_modgbn.Value > "M4" && cb_modgbn.Value <> "M7") {
		gfn_showAlert("CW10025", "해당 건은 사전 합의에 따른 한국승강기사업본부 승인 시 수주 등록이 가능 합니다.");
	}
}

/********************************************************************************
* 기      능   : 견적가 변경 시 
********************************************************************************/
function ds_out_master_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{
	if(strColumnID = "SUM_OFR"){
		me_bilamt1.value = toNumber(ed_sum_ofr.Value) - (toNumber(me_bilamt2.value) + toNumber(me_bilamt3.value));
	}
	

	
}



//*******************************자회사 정보 입력*******************************
//==============================================================================
function chk_elj_OnClick(obj,strValue)
{
	if(chk_elj.Value == "1")
	{
		Div0.Visible = true;
	} 
	else 
	{
		Div0.Visible = false;

	}
}

function Div0_btn_pjt_2_OnClick(obj)
{

	//var arg2 = "vkgrp=" + quote(G_SAP_USER_VGCD) + " cst=1";					    //지사 사용자의 작업그룹별 필터링 조건, 거래선이 있는 것만 
	var arg2 = "vkgrp=" + quote(G_SAP_USER_VGCD) + " cst=1" + " lejchk=" + lejchk;					//자회사 조회사 조건 추가

	var kunnr2 = gfn_openPopup("CS9601001A", true, arg2);

	if (kunnr2 != null) {
		if (kunnr2[0] == null || length(kunnr2[0]) < 3) {
			return;
		}
	
		//DEBUG("btn_pjt_OnClick", ds_cond.SaveXml());
			
		if (kunnr2[1] == null || length(kunnr2[1]) < 3) {
			gfn_showAlert("CW00022","거래선");
			return;
		}
		
		
		//ds_out_elj.clearData();
		//ds_out_elj.AddRow();
		
		Div0.ed_pjt_2.value = kunnr2[0] + kunnr2[1];
		Div0.ed_spt_2.value = kunnr2[2];
		Div0.ed_cstnm_2.value = kunnr2[10];
		Div0.ed_cus_2.value   = kunnr2[4];
		
		Div0.ed_partamt.value = 0;
		Div0.ed_laboamt.value = 0;
		Div0.me_bilamt1_2.value = 0;
		Div0.me_bilamt2_2.value = 0;
	    Div0.me_bilamt3_2.value = 0;
	    
	    Div0.cb_taxk1_2.Index = 1;
	    Div0.cb_kvgr1_2.Index = 1;
	    Div0.cb_kvgr2_2.Index = 0;
	    
	}
	else
	{
		return;
	}
	
    //견적 그리드를 클리어한다.
    //ds_list.clearData();
    
    //해당 프로젝트 번호로 나머지 정보를 가져온다.
    //ufn_getProjectInfo();	
}

function Div0_chk_spbill_2_OnClick(obj,strValue)
{
	if(Div0.chk_spbill_2.Value == "1")
	{	
		Div0.me_bilamt1_2.enable  = true; 
		Div0.cal_bildat2_2.enable = true;
		Div0.me_bilamt2_2.enable = true;
		Div0.cal_bildat3_2.enable = true;
		Div0.me_bilamt3_2.enable = true;
	} 
	else 
	{
		Div0.me_bilamt1_2.enable  = false; 
		Div0.cal_bildat2_2.enable = false;
		Div0.me_bilamt2_2.enable = false;
		Div0.cal_bildat3_2.enable = false;
		Div0.me_bilamt3_2.enable = false;
		
		Div0.me_bilamt1_2.value = toInteger(Div0.ed_partamt.value) +  toInteger(Div0.ed_laboamt.value);
		Div0.cal_bildat2_2.value = "";
		Div0.me_bilamt2_2.value = 0;
		Div0.cal_bildat3_2.value = "";
		Div0.me_bilamt3_2.value = 0;
	}	
}

//ufn_eljchk(ds_out_master.GetColumn(0, "KUNNR"), ds_out_master.GetColumn(0, "DC_RATE"));
function ufn_eljchk(kunnr, dc_rate)
{   
	chk_elj.Value   = false;
	Div0.Visible = false;

	if(length(ds_out_elj.getColumn(0, "QTNUM")) >= 1) {
		Div0.bt_elj_save.Enable = true;
	} else {
		Div0.bt_elj_save.Enable = false;
	}
	
	
/*	
	if(kunnr == "0000258910") {
		lejchk = 'Y';
		chk_elj.Visible = true;
		
		if (ds_out_master.GetColumn(0, "REQKIND") = '1' ) {
			ufn_setObjectVisibility("btn_discount", true);
		}
		else {
			ufn_setObjectVisibility("btn_discount", false);
		}
		
	} else {	
		lejchk = '';		
		chk_elj.Visible = false;
		ds_out_elj.clearData();
		ds_out_elj.AddRow();
	}	
*/
	
	if(dc_rate > 0)
	{
		//dcchk = 'Y';
		
		if (ds_out_master.GetColumn(0, "REQKIND") = '1' ) {
			dcchk = 'Y';
			ufn_setObjectVisibility("btn_discount", true);
		}
		else {
			dcchk = '';
			ufn_setObjectVisibility("btn_discount", false);
		}
		
		
		
		if(kunnr == "0000258910") {			
			lejchk = 'Y';
			chk_elj.Visible = true;
	    } else {
			lejchk = '';		
			chk_elj.Visible = false;
			ds_out_elj.clearData();
			ds_out_elj.AddRow();
	    }
	
	} else {
		dcchk = '';
		lejchk = '';		
		chk_elj.Visible = false;
		ufn_setObjectVisibility("btn_discount", false);
		ds_out_elj.clearData();
		ds_out_elj.AddRow();
	}
	
}


function Div0_ed_partamt_OnChanged(obj,strText)
{
	Div0.me_bilamt1_2.Value = toInteger(obj.value) + toInteger(Div0.ed_laboamt.Value);
}

function Div0_ed_laboamt_OnChanged(obj,strText)
{
	Div0.me_bilamt1_2.Value = toInteger(obj.value) + toInteger(Div0.ed_partamt.Value);
}

/*
function ufn_enableGroup_j(componentGroup, setFlag)
{
	var comps;
	if(componentGroup == "")
	{
		comps = Div0.Components;
	}
	else
	{
		comps = Div0.Components[componentGroup];	
	}

	if(!IsValidObject(comps)) return;

	for(iCnt=0;iCnt < comps.count();iCnt++)
	{
		comps[iCnt].Enable = setFlag;
	} 
	
	return;
}
*/


function ufn_checkInputForSave_elj()
{
	if(ufn_isNull(Div0.ed_pjt_2,     	true, "Proj. No(자회사)", 		Div0.ed_pjt_2))      return false;		//프로젝트번호
	
	
	if(ufn_isNull(Div0.cb_reqkind_2, 	true, "청구종류(자회사)", 		Div0.cb_reqkind_2))  return false;		//청구종류
	//if(ufn_isNull(Div0.ed_pspid,     	true, "수주번호(자회사)", 		Div0.ed_pspid))      return false;		//수주번호	
	
	if(Div0.cb_reqkind_2.Value == "1" || Div0.cb_reqkind_2.Value == "7" ) { //유상청구, 수리공사 인경우만 
		//if(ufn_isNull(Div0.me_bilamt1_2, 	true, "부품or인건비(자회사)", 	Div0.me_bilamt1_2))  return false;	
		if(toNumber(Div0.me_bilamt1_2.Value) <= 0)
		{
			gfn_showAlert("CW10025", "부품or인건비(자회사) 값이 누락되었습니다.");
			return false;	
		}
		if(ufn_isNull(Div0.cal_bildat1_2,   true, "발행일(자회사)", 		Div0.cal_bildat1_2)) return false;	
		
		//===========모회사 매입금액 이하로 판매가 이루어지는 경우가 있어 조건 해지함 ===========
		/*
		if( toNumber(ed_netwr_ofr.Value) > toNumber(Div0.me_bilamt1_2.Value)  ) {
			gfn_showAlert("CW10025", "자회사 부품+인건비 금액이 모회사 금액 미만일수 없습니다.");
			return false;	
		}
		*/
		
	}
	
	return true;
	
}


function Div0_bt_elj_save_OnClick(obj)
{
	//ufn_checkInputForSave_elj();
	if(!ufn_checkInputForSave_elj())
	{
		return;
	}

	if(trim(Div0.ed_partamt.value) == null ) 
	{ 
	  Div0.ed_partamt.value = 0;
	}  
	
	if(trim(Div0.ed_laboamt.value) == null) Div0.ed_laboamt.value = 0;
	
	if(trim(Div0.me_bilamt1_2.value) == null ) Div0.me_bilamt1_2.value = 0;
	if(trim(Div0.me_bilamt2_2.value) == null ) Div0.me_bilamt2_2.value = 0;
	if(trim(Div0.me_bilamt3_2.value) == null ) Div0.me_bilamt3_2.value = 0;


	
	tit_clearActionInfo();
	tit_addSingleActionInfo("cs01:CS0101008B_U10");
	tit_callService(
        ""
        , ""
        , "ds_out_elj=ds_out_elj"
        , ""
        , ""
        , "fn_afterSave_elj"
        , false
        , false
        , true);
        
}

function fn_afterSave_elj(errCode, errMsg) {

	if ( errCode!= 0 ) {
		gfn_showMsg("CE00001");
	} else {
		gfn_showMsg("CI00003");
	}

} 

function Div0_cb_reqkind_2_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	if(strCode == "9" || strCode == "A") {
	
		Div0.ed_partamt.Value = 0;
		Div0.ed_laboamt.Value = 0;
	
		Div0.cb_taxk1_2.Value = "";   //세금구분
	
		Div0.cb_zterm_2.Value = "";  //수금조건
		Div0.cb_kvgr1_2.Value = "";  //계산서구분
		Div0.cb_kvgr2_2.Value = "";   //발송구분
		
		Div0.chk_spbill_2.Value = "";  //분할발행
		Div0.cal_bildat1_2.Value = "";  //발행일1
		Div0.cal_bildat2_2.Value = "";  //발행일2
		Div0.cal_bildat3_2.Value = "";  //발행일3
		
		Div0.me_bilamt1_2.Value = 0;    //발행금액1		
		Div0.me_bilamt2_2.Value = 0;  //발행금액2
		Div0.me_bilamt3_2.Value = 0;  //발행금액3
		
		Div0.ed_remark_2.Value = "";  //특기사항
			
	}
}


function Div0_me_bilamt2_2_OnChanged(obj,strText)
{
	Div0.me_bilamt1_2.value = (toNumber(Div0.ed_partamt.Value) + toNumber(Div0.ed_laboamt.Value) ) - (toNumber(Div0.me_bilamt2_2.value) + toNumber(Div0.me_bilamt3_2.value));
}

function Div0_me_bilamt3_2_OnChanged(obj,strText)
{
	Div0.me_bilamt1_2.value = (toNumber(Div0.ed_partamt.Value) + toNumber(Div0.ed_laboamt.Value) ) - (toNumber(Div0.me_bilamt2_2.value) + toNumber(Div0.me_bilamt3_2.value));	
}


//==============================================================================

/********************************************************************************
* 기      능   : 수리공사-일식외주 클릭 된 경우
********************************************************************************/
function chk_ilsic_OnClick(obj,strValue)
{
	ds_out_master.SetColumn(0,"ILSIC_YN",chk_ilsic.Value);
}


/********************************************************************************
* 기      능   : 자회사 인경우  할인금액 적용
********************************************************************************/
function btn_discount_OnClick(obj)
{
	var netwr_std;
	for(iCnt=0;iCnt < ds_list.Count;iCnt++)										
	{
		netwr_std += ds_list.getColumn(iCnt, "NETWR");
	}	
	
	ed_netwr_dc.Value = netwr_std * ds_out_master.GetColumn(0, "DC_RATE");
	netwr_dc = ed_netwr_dc.Value;
	dcfix = 'Y';
	
}

/********************************************************************************
* 기      능   : 청구종류별 승인소요일 구하기
********************************************************************************/
function getReqkindDlyDate() {
	var reqkind = cb_reqkind.Value;
	var approveDate = 0;
	
	if(reqkind == '1') { // 부품판매
		approveDate = 3;
	} else if(reqkind == '7') { // 수리공사
		approveDate = 3;
	} else if(reqkind == 'S') { // 시스템공사
		approveDate = 3;
	}
	
	return approveDate;
}]]></Script>
</Window>