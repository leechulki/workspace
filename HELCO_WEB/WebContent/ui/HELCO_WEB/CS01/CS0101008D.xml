<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="521" Id="form" Left="8" OnLoadCompleted="fn_OnLoadCompleted" OnUnloadCompleted="fn_OnUnloadCompleted" PidAttrib="7" Title="수주변경/취소" Top="8" Ver="1.0" Width="978" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_cond">
				<Contents>
					<colinfo id="CST" size="256" summ="default" type="STRING"/>
					<colinfo id="QTNUM" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQNO" size="256" summ="default" type="STRING"/>
					<colinfo id="SPART" size="256" summ="default" type="STRING"/>
					<colinfo id="UPN" size="256" summ="default" type="STRING"/>
					<colinfo id="USERID" size="256" summ="default" type="STRING"/>
					<record>
						<CST></CST>
						<QTNUM></QTNUM>
						<SEQ></SEQ>
						<SEQNO></SEQNO>
						<SPART></SPART>
						<UPN></UPN>
						<USERID></USERID>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_pjt_det">
				<Contents>
					<colinfo id="ADDR" size="256" summ="default" type="STRING"/>
					<colinfo id="ADDRBILL" size="256" summ="default" type="STRING"/>
					<colinfo id="BLD" size="256" summ="default" type="STRING"/>
					<colinfo id="BLDNM" size="256" summ="default" type="STRING"/>
					<colinfo id="BPM" size="256" summ="default" type="STRING"/>
					<colinfo id="BPMNM" size="256" summ="default" type="STRING"/>
					<colinfo id="BSU" size="256" summ="default" type="STRING"/>
					<colinfo id="BSUNM" size="256" summ="default" type="STRING"/>
					<colinfo id="CST" size="256" summ="default" type="STRING"/>
					<colinfo id="ENAME" size="256" summ="default" type="STRING"/>
					<colinfo id="GNO" size="256" summ="default" type="STRING"/>
					<colinfo id="HNA" size="256" summ="default" type="STRING"/>
					<colinfo id="HNO" size="256" summ="default" type="STRING"/>
					<colinfo id="KUNNR" size="256" summ="default" type="STRING"/>
					<colinfo id="KUNNRNM" size="256" summ="default" type="STRING"/>
					<colinfo id="MNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="PNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="RATE" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="SITENM" size="256" summ="default" type="STRING"/>
					<colinfo id="SPART" size="256" summ="default" type="STRING"/>
					<colinfo id="SPARTNM" size="256" summ="default" type="STRING"/>
					<colinfo id="TEL" size="256" summ="default" type="STRING"/>
					<colinfo id="TGB" size="256" summ="default" type="STRING"/>
					<colinfo id="UPN" size="256" summ="default" type="STRING"/>
					<colinfo id="VKBUR" size="256" summ="default" type="STRING"/>
					<colinfo id="VKBURNM" size="256" summ="default" type="STRING"/>
					<colinfo id="VKGRP" size="256" summ="default" type="STRING"/>
					<colinfo id="VKGRPNM" size="256" summ="default" type="STRING"/>
					<colinfo id="WAERS" size="256" summ="default" type="STRING"/>
					<colinfo id="WERKS" size="256" summ="default" type="STRING"/>
					<colinfo id="ZTERM" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_radio">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE>1</CODE>
						<CODE_NAME>수주금액변경</CODE_NAME>
					</record>
					<record>
						<CODE>2</CODE>
						<CODE_NAME>수주취소</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_out_master">
				<Contents>
					<colinfo id="ADJCOST" size="256" summ="default" type="STRING"/>
					<colinfo id="ADMCOST1" size="256" summ="default" type="STRING"/>
					<colinfo id="ADMCOST2" size="256" summ="default" type="STRING"/>
					<colinfo id="BGUBN" size="256" summ="default" type="STRING"/>
					<colinfo id="BIL_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="BILAMT1" size="256" summ="default" type="STRING"/>
					<colinfo id="BILAMT2" size="256" summ="default" type="STRING"/>
					<colinfo id="BILAMT3" size="256" summ="default" type="STRING"/>
					<colinfo id="BILDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="BILDAT2" size="256" summ="default" type="STRING"/>
					<colinfo id="BILDAT3" size="256" summ="default" type="STRING"/>
					<colinfo id="BSU" size="256" summ="default" type="STRING"/>
					<colinfo id="BSUNM" size="256" summ="default" type="STRING"/>
					<colinfo id="BUSSI" size="256" summ="default" type="STRING"/>
					<colinfo id="CHGBN" size="256" summ="default" type="STRING"/>
					<colinfo id="CPRD" size="256" summ="default" type="STRING"/>
					<colinfo id="CRNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="CRSN" size="256" summ="default" type="STRING"/>
					<colinfo id="CS001_GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="CS001_GBNNM" size="256" summ="default" type="STRING"/>
					<colinfo id="CST" size="256" summ="default" type="STRING"/>
					<colinfo id="CSTNM" size="256" summ="default" type="STRING"/>
					<colinfo id="EXP_PCT" size="256" summ="default" type="STRING"/>
					<colinfo id="EXPENSE1" size="256" summ="default" type="STRING"/>
					<colinfo id="EXPENSE2" size="256" summ="default" type="STRING"/>
					<colinfo id="FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="HIS_DIRSUM" size="256" summ="default" type="STRING"/>
					<colinfo id="HIS_INDSUM" size="256" summ="default" type="STRING"/>
					<colinfo id="HIS_LABOR" size="256" summ="default" type="STRING"/>
					<colinfo id="HIS_LCOST" size="256" summ="default" type="STRING"/>
					<colinfo id="HIS_LOG" size="256" summ="default" type="STRING"/>
					<colinfo id="HIS_OEM" size="256" summ="default" type="STRING"/>
					<colinfo id="HIS_RATE" size="256" summ="default" type="STRING"/>
					<colinfo id="HIS_TOTCOST" size="256" summ="default" type="STRING"/>
					<colinfo id="HIS_UCOST" size="256" summ="default" type="STRING"/>
					<colinfo id="ID_RATE" size="256" summ="default" type="STRING"/>
					<colinfo id="KUNNR" size="256" summ="default" type="STRING"/>
					<colinfo id="KVGR1" size="256" summ="default" type="STRING"/>
					<colinfo id="KVGR2" size="256" summ="default" type="STRING"/>
					<colinfo id="LCOST_OFR" size="256" summ="default" type="STRING"/>
					<colinfo id="LCOST_STD" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="MA_PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="MNG_PCT" size="256" summ="default" type="STRING"/>
					<colinfo id="NETWR_DC" size="256" summ="default" type="STRING"/>
					<colinfo id="NETWR_OFR" size="256" summ="default" type="STRING"/>
					<colinfo id="NETWR_STD" size="256" summ="default" type="STRING"/>
					<colinfo id="NIGHT_WGT" size="256" summ="default" type="STRING"/>
					<colinfo id="PGBN" size="256" summ="default" type="STRING"/>
					<colinfo id="PNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="PRO_PCT" size="256" summ="default" type="STRING"/>
					<colinfo id="QSTAT" size="256" summ="default" type="STRING"/>
					<colinfo id="QTNAM" size="256" summ="default" type="STRING"/>
					<colinfo id="QTNUM" size="256" summ="default" type="STRING"/>
					<colinfo id="RATE" size="256" summ="default" type="STRING"/>
					<colinfo id="REMARK" size="256" summ="default" type="STRING"/>
					<colinfo id="REQKIND" size="256" summ="default" type="STRING"/>
					<colinfo id="REQKINDNM" size="256" summ="default" type="STRING"/>
					<colinfo id="REVENUE1" size="256" summ="default" type="STRING"/>
					<colinfo id="REVENUE2" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQNM" size="256" summ="default" type="STRING"/>
					<colinfo id="SHDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="SODAT" size="256" summ="default" type="STRING"/>
					<colinfo id="SPART" size="256" summ="default" type="STRING"/>
					<colinfo id="SPARTNM" size="256" summ="default" type="STRING"/>
					<colinfo id="SPT" size="256" summ="default" type="STRING"/>
					<colinfo id="SUM_OFR" size="256" summ="default" type="STRING"/>
					<colinfo id="SUM_STD" size="256" summ="default" type="STRING"/>
					<colinfo id="TAXK1" size="256" summ="default" type="STRING"/>
					<colinfo id="UPN" size="256" summ="default" type="STRING"/>
					<colinfo id="VBELN" size="256" summ="default" type="STRING"/>
					<colinfo id="VKBUR" size="256" summ="default" type="STRING"/>
					<colinfo id="VKBURNM" size="256" summ="default" type="STRING"/>
					<colinfo id="VKGRP" size="256" summ="default" type="STRING"/>
					<colinfo id="VKGRPNM" size="256" summ="default" type="STRING"/>
					<colinfo id="WEEKEND_WGT" size="256" summ="default" type="STRING"/>
					<colinfo id="WERKS" size="256" summ="default" type="STRING"/>
					<colinfo id="ZTERM" size="256" summ="default" type="STRING"/>
					<colinfo id="PAYSTAT" size="256" summ="default" type="STRING"/>
					<colinfo id="HIS_INSPEC" size="256" summ="default" type="STRING"/>
					<colinfo id="HIS_ETC" size="256" summ="default" type="STRING"/>
					<colinfo id="HIS_DLAB" size="256" summ="default" type="STRING"/>
					<colinfo id="HIS_BETC" size="256" summ="default" type="STRING"/>
					<colinfo id="HIS_MMOD" size="256" summ="default" type="STRING"/>
					<colinfo id="HIS_SAFE" size="256" summ="default" type="STRING"/>
					<colinfo id="HIS_LIFT" size="256" summ="default" type="STRING"/>
					<colinfo id="HIS_EMACID" size="256" summ="default" type="STRING"/>
					<record>
						<ADJCOST></ADJCOST>
						<ADMCOST1></ADMCOST1>
						<ADMCOST2></ADMCOST2>
						<BGUBN></BGUBN>
						<BIL_AMT></BIL_AMT>
						<BILAMT1></BILAMT1>
						<BILAMT2></BILAMT2>
						<BILAMT3></BILAMT3>
						<BILDAT></BILDAT>
						<BILDAT2></BILDAT2>
						<BILDAT3></BILDAT3>
						<BSU></BSU>
						<BSUNM></BSUNM>
						<BUSSI></BUSSI>
						<CHGBN></CHGBN>
						<CPRD></CPRD>
						<CRNAME></CRNAME>
						<CRSN></CRSN>
						<CS001_GBN></CS001_GBN>
						<CS001_GBNNM></CS001_GBNNM>
						<CST></CST>
						<CSTNM></CSTNM>
						<EXP_PCT></EXP_PCT>
						<EXPENSE1></EXPENSE1>
						<EXPENSE2></EXPENSE2>
						<FLAG></FLAG>
						<HIS_BETC></HIS_BETC>
						<HIS_DIRSUM></HIS_DIRSUM>
						<HIS_DLAB></HIS_DLAB>
						<HIS_EMACID></HIS_EMACID>
						<HIS_ETC></HIS_ETC>
						<HIS_INDSUM></HIS_INDSUM>
						<HIS_INSPEC></HIS_INSPEC>
						<HIS_LABOR></HIS_LABOR>
						<HIS_LCOST></HIS_LCOST>
						<HIS_LIFT></HIS_LIFT>
						<HIS_LOG></HIS_LOG>
						<HIS_MMOD></HIS_MMOD>
						<HIS_OEM></HIS_OEM>
						<HIS_RATE></HIS_RATE>
						<HIS_SAFE></HIS_SAFE>
						<HIS_TOTCOST></HIS_TOTCOST>
						<HIS_UCOST></HIS_UCOST>
						<ID_RATE></ID_RATE>
						<KUNNR></KUNNR>
						<KVGR1></KVGR1>
						<KVGR2></KVGR2>
						<LCOST_OFR></LCOST_OFR>
						<LCOST_STD></LCOST_STD>
						<LIFNR></LIFNR>
						<MA_PSPID></MA_PSPID>
						<MNG_PCT></MNG_PCT>
						<NETWR_DC></NETWR_DC>
						<NETWR_OFR></NETWR_OFR>
						<NETWR_STD></NETWR_STD>
						<NIGHT_WGT></NIGHT_WGT>
						<PAYSTAT></PAYSTAT>
						<PGBN></PGBN>
						<PNAME></PNAME>
						<PRO_PCT></PRO_PCT>
						<QSTAT></QSTAT>
						<QTNAM></QTNAM>
						<QTNUM></QTNUM>
						<RATE></RATE>
						<REMARK></REMARK>
						<REQKIND></REQKIND>
						<REQKINDNM></REQKINDNM>
						<REVENUE1></REVENUE1>
						<REVENUE2></REVENUE2>
						<SEQ></SEQ>
						<SEQNM></SEQNM>
						<SHDAT></SHDAT>
						<SODAT></SODAT>
						<SPART></SPART>
						<SPARTNM></SPARTNM>
						<SPT></SPT>
						<SUM_OFR></SUM_OFR>
						<SUM_STD></SUM_STD>
						<TAXK1></TAXK1>
						<UPN></UPN>
						<VBELN></VBELN>
						<VKBUR></VKBUR>
						<VKBURNM></VKBURNM>
						<VKGRP></VKGRP>
						<VKGRPNM></VKGRPNM>
						<WEEKEND_WGT></WEEKEND_WGT>
						<WERKS></WERKS>
						<ZTERM></ZTERM>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_docno_gen">
				<Contents>
					<colinfo id="PFX" size="256" type="STRING"/>
					<colinfo id="DOCNO" size="256" type="STRING"/>
					<record>
						<PFX></PFX>
						<DOCNO></DOCNO>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_dec">
				<Contents>
					<colinfo id="APPGUBN" size="256" summ="default" type="STRING"/>
					<colinfo id="APSTAT" size="256" summ="default" type="STRING"/>
					<colinfo id="DOCKIND" size="256" summ="default" type="STRING"/>
					<colinfo id="DOCNO" size="256" summ="default" type="STRING"/>
					<colinfo id="REIRUM" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQNO" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQSTAT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_jhgbn">
				<Contents>
					<colinfo id="JHGBN" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_conf_cond">
				<Contents>
					<colinfo id="DOCNO" size="256" summ="default" type="STRING"/>
					<record>
						<DOCNO></DOCNO>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_conf_list">
				<Contents>
					<colinfo id="APDATE_R1" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE_R2" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE_R3" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE_R4" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE_R5" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE_S1" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE_S2" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE_S3" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE_S4" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE_S5" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM_R1" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM_R2" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM_R3" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM_R4" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM_R5" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM_S1" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM_S2" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM_S3" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM_S4" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM_S5" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK_R1" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK_R2" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK_R3" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK_R4" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK_R5" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK_S1" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK_S2" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK_S3" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK_S4" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK_S5" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_draftpers_list">
				<Contents>
					<colinfo id="D_DATE" size="256" summ="default" type="STRING"/>
					<colinfo id="D_NAME" size="256" summ="default" type="STRING"/>
					<colinfo id="D_RANK" size="256" summ="default" type="STRING"/>
					<colinfo id="D_TEM" size="256" summ="default" type="STRING"/>
					<colinfo id="D_TOTEM" size="256" summ="default" type="STRING"/>
					<colinfo id="DOCNO" size="256" summ="default" type="STRING"/>
					<record>
						<D_DATE></D_DATE>
						<D_NAME></D_NAME>
						<D_RANK></D_RANK>
						<D_TEM></D_TEM>
						<D_TOTEM></D_TOTEM>
						<DOCNO></DOCNO>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list" OnColumnChanged="ds_list_OnColumnChanged">
				<Contents>
					<colinfo id="AMOUNT" size="256" summ="default" type="STRING"/>
					<colinfo id="AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="BANNAB" size="256" summ="default" type="STRING"/>
					<colinfo id="BISMT" size="256" summ="default" type="STRING"/>
					<colinfo id="BLOCK_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="BRGEW" size="256" summ="default" type="STRING"/>
					<colinfo id="BWTAR" size="256" summ="default" type="STRING"/>
					<colinfo id="CGBN" size="256" summ="default" type="STRING"/>
					<colinfo id="CGBNNM" size="256" summ="default" type="STRING"/>
					<colinfo id="CGUBN" size="256" summ="default" type="STRING"/>
					<colinfo id="CHAR1" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="DZEINR" size="256" summ="default" type="STRING"/>
					<colinfo id="EXEDT" size="256" summ="default" type="STRING"/>
					<colinfo id="EXEID" size="256" summ="default" type="STRING"/>
					<colinfo id="EXTWG" size="256" summ="default" type="STRING"/>
					<colinfo id="EXXETM" size="256" summ="default" type="STRING"/>
					<colinfo id="FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="GEWEI" size="256" summ="default" type="STRING"/>
					<colinfo id="HNA" size="256" summ="default" type="STRING"/>
					<colinfo id="HNO" size="256" summ="default" type="STRING"/>
					<colinfo id="HTY" size="256" summ="default" type="STRING"/>
					<colinfo id="JOBHOUR" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="LCOSTC" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="LCOSTS" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="LGFSB" size="256" summ="default" type="STRING"/>
					<colinfo id="LVORM" size="256" summ="default" type="STRING"/>
					<colinfo id="MAKTX" size="256" summ="default" type="STRING"/>
					<colinfo id="MAN" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="MATKL" size="256" summ="default" type="STRING"/>
					<colinfo id="MATNR" size="256" summ="default" type="STRING"/>
					<colinfo id="MATNRNM" size="256" summ="default" type="STRING"/>
					<colinfo id="MATNRNM2" size="256" summ="default" type="STRING"/>
					<colinfo id="MEINS" size="256" summ="default" type="STRING"/>
					<colinfo id="MENGE" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="MTART" size="256" summ="default" type="STRING"/>
					<colinfo id="NETPR" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="NETWR" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="NTGEW" size="256" summ="default" type="STRING"/>
					<colinfo id="OFRHOUR" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="PARLAB" size="256" summ="default" type="STRING"/>
					<colinfo id="PARLAB1" size="256" summ="default" type="STRING"/>
					<colinfo id="REQKIND" size="256" summ="default" type="STRING"/>
					<colinfo id="REQKIND_CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="RGBN" size="256" summ="default" type="STRING"/>
					<colinfo id="RGBNNM" size="256" summ="default" type="STRING"/>
					<colinfo id="SAMT2" size="256" summ="default" type="STRING"/>
					<colinfo id="SPEC" size="256" summ="default" type="STRING"/>
					<colinfo id="UCOST" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="UCOSTA" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="UCOSTR" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="UPR" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="VOLEH" size="256" summ="default" type="STRING"/>
					<colinfo id="VOLUM" size="256" summ="default" type="STRING"/>
					<colinfo id="WAERS" size="256" summ="default" type="STRING"/>
					<colinfo id="WERKS" size="256" summ="default" type="STRING"/>
					<colinfo id="WRKST" size="256" summ="default" type="STRING"/>
					<colinfo id="ZGUBN" size="256" summ="default" type="STRING"/>
					<colinfo id="ZGUBN_CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSIZE" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_print">
				<Contents>
					<colinfo id="DT1" size="256" summ="default" type="STRING"/>
					<colinfo id="DT2" size="256" summ="default" type="STRING"/>
					<colinfo id="DT3" size="256" summ="default" type="STRING"/>
					<colinfo id="DT4" size="256" summ="default" type="STRING"/>
					<colinfo id="DT5" size="256" summ="default" type="STRING"/>
					<colinfo id="DT6" size="256" summ="default" type="STRING"/>
					<colinfo id="MN011" size="256" summ="default" type="STRING"/>
					<colinfo id="MN012" size="256" summ="default" type="STRING"/>
					<colinfo id="MN013" size="256" summ="default" type="STRING"/>
					<colinfo id="MN021" size="256" summ="default" type="STRING"/>
					<colinfo id="MN022" size="256" summ="default" type="STRING"/>
					<colinfo id="MN023" size="256" summ="default" type="STRING"/>
					<colinfo id="MN031" size="256" summ="default" type="STRING"/>
					<colinfo id="MN032" size="256" summ="default" type="STRING"/>
					<colinfo id="MN033" size="256" summ="default" type="STRING"/>
					<colinfo id="MN041" size="256" summ="default" type="STRING"/>
					<colinfo id="MN042" size="256" summ="default" type="STRING"/>
					<colinfo id="MN043" size="256" summ="default" type="STRING"/>
					<colinfo id="MN051" size="256" summ="default" type="STRING"/>
					<colinfo id="MN052" size="256" summ="default" type="STRING"/>
					<colinfo id="MN053" size="256" summ="default" type="STRING"/>
					<colinfo id="MN061" size="256" summ="default" type="STRING"/>
					<colinfo id="MN062" size="256" summ="default" type="STRING"/>
					<colinfo id="MN063" size="256" summ="default" type="STRING"/>
					<colinfo id="MN071" size="256" summ="default" type="STRING"/>
					<colinfo id="MN072" size="256" summ="default" type="STRING"/>
					<colinfo id="MN073" size="256" summ="default" type="STRING"/>
					<colinfo id="MN081" size="256" summ="default" type="STRING"/>
					<colinfo id="MN082" size="256" summ="default" type="STRING"/>
					<colinfo id="MN083" size="256" summ="default" type="STRING"/>
					<colinfo id="MN091" size="256" summ="default" type="STRING"/>
					<colinfo id="MN092" size="256" summ="default" type="STRING"/>
					<colinfo id="MN093" size="256" summ="default" type="STRING"/>
					<colinfo id="MN101" size="256" summ="default" type="STRING"/>
					<colinfo id="MN111" size="256" summ="default" type="STRING"/>
					<colinfo id="SG1" size="256" summ="default" type="STRING"/>
					<colinfo id="SG2" size="256" summ="default" type="STRING"/>
					<colinfo id="SG3" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_reject_cond">
				<Contents>
					<colinfo id="DOCNO" size="256" summ="default" type="STRING"/>
					<record>
						<DOCNO></DOCNO>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_reject_list">
				<Contents>
					<colinfo id="MESGSEND" size="256" summ="default" type="STRING"/>
					<colinfo id="MESGACCP" size="256" summ="default" type="STRING"/>
					<colinfo id="MESGTITL" size="256" summ="default" type="STRING"/>
					<colinfo id="MESGDESC" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_reject_wb">
				<Contents>
					<colinfo id="APNUM1" size="256" summ="default" type="STRING"/>
					<colinfo id="APNUM2" size="256" summ="default" type="STRING"/>
					<colinfo id="APDESC" size="256" summ="default" type="STRING"/>
					<record>
						<APDESC></APDESC>
						<APNUM1></APNUM1>
						<APNUM2></APNUM2>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_rcond">
				<Contents>
					<colinfo id="ZPROGRAM" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN" size="256" summ="default" type="STRING"/>
					<record>
						<GBN></GBN>
						<ZPROGRAM></ZPROGRAM>
					</record>
				</Contents>
			</Dataset>
		</Datasets>
		<Shape BKColor="user12" Bottom="85" Height="26" Id="Shape3" Left="7" LineColor="user13" Right="968" TabOrder="134" Top="59" Type="Rectangle" Width="961"></Shape>
		<Shape BKColor="user12" Bottom="282" Height="26" Id="Shape25" Left="295" LineColor="user13" Right="392" TabOrder="109" Top="256" Type="Rectangle" Width="97"></Shape>
		<Shape BKColor="user12" Bottom="282" Height="26" Id="Shape9" Left="8" LineColor="user13" Right="105" TabOrder="106" Top="256" Type="Rectangle" Width="97"></Shape>
		<Shape BKColor="user12" Bottom="246" Height="26" Id="Shape28" Left="487" LineColor="user13" Right="584" TabOrder="61" Top="220" Type="Rectangle" Width="97"></Shape>
		<Shape BKColor="user12" Bottom="246" Height="26" Id="Shape27" Left="391" LineColor="user13" Right="488" TabOrder="60" Top="220" Type="Rectangle" Width="97"></Shape>
		<Shape BKColor="user12" Bottom="246" Height="26" Id="Shape26" Left="295" LineColor="user13" Right="392" TabOrder="59" Top="220" Type="Rectangle" Width="97"></Shape>
		<Shape BKColor="user12" Bottom="135" Height="26" Id="Shape1" Left="7" LineColor="user13" Right="968" TabOrder="11" Top="109" Type="Rectangle" Width="961"></Shape>
		<Shape BKColor="user12" Bottom="457" Height="54" Id="Shape6" Left="8" LineColor="user13" Right="105" TabOrder="54" Top="403" Type="Rectangle" Width="97"></Shape>
		<Static Align="Center" Height="52" Id="Static53" Left="9" Style="sty_lb_form_basic" TabOrder="55" Text="변경(취소)&#10;사유" Top="404" VAlign="Middle" Width="94"></Static>
		<Shape BKColor="user27" Bottom="85" Height="26" Id="Shape4" Left="7" LineColor="user13" Right="332" TabOrder="56" Top="59" Type="Rectangle" Width="325"></Shape>
		<Div Height="36" Id="div_btn" TabOrder="1" Text="Div0" ToolTipFont="Default,0" Url="WB01::CommBtnForm.xml" Width="976">
			<Contents></Contents>
		</Div>
		<Static Align="Center" Height="24" Id="Static3" Left="296" Style="sty_lb_form_basic" TabOrder="3" Text="현장명" Top="85" VAlign="Middle" Width="80"></Static>
		<Shape BKColor="user12" Bottom="110" Height="26" Id="Shape0" Left="7" LineColor="user13" Right="968" TabOrder="2" Top="84" Type="Rectangle" Width="961"></Shape>
		<Static Align="Center" Height="24" Id="Static5" Left="8" Style="sty_lb_form_basic" TabOrder="4" Text="Proj.&#32;No" Top="85" VAlign="Middle" Width="80"></Static>
		<Edit Align="CENTER" BindDataset="ds_out_master" Border="Flat" Column="MA_PSPID" Enable="FALSE" Height="20" Id="ed_pjt" Left="89" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="5" Top="86" Width="94"></Edit>
		<Static Align="Center" Height="24" Id="Static1" Left="334" Style="sty_lb_form_basic" TabOrder="6" Text="견적번호" Top="85" VAlign="Middle" Width="70"></Static>
		<Edit Align="CENTER" BindDataset="ds_out_master" Border="Flat" Column="QTNUM" Enable="FALSE" Height="20" Id="ed_qtnum" Left="407" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="7" Top="87" Width="80"></Edit>
		<Static Align="Center" Height="24" Id="Static2" Left="490" Style="sty_lb_form_basic" TabOrder="8" Text="차수" Top="85" VAlign="Middle" Width="70"></Static>
		<Static Align="Center" Height="24" Id="Static4" Left="615" Style="sty_lb_form_basic" TabOrder="9" Text="결재상태" Top="85" VAlign="Middle" Width="70"></Static>
		<Edit Align="CENTER" Border="Flat" Enable="FALSE" Height="20" Id="ed_wf_stat" Left="688" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="10" Top="87" Width="104"></Edit>
		<Shape BKColor="user12" Bottom="160" Height="26" Id="Shape2" Left="7" LineColor="user13" Right="968" TabOrder="12" Top="134" Type="Rectangle" Width="961"></Shape>
		<Edit Align="CENTER" Border="Flat" Height="20" Id="ed_reg" Left="795" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="13" Text="(전결규정)" Top="87" Width="101"></Edit>
		<Edit BindDataset="ds_out_master" Border="Flat" Column="SPT" Enable="FALSE" Height="20" Id="ed_spt" Left="187" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="14" Top="87" Width="145"></Edit>
		<Static Align="Center" Height="24" Id="Static0" Left="8" Style="sty_lb_form_basic" TabOrder="15" Text="고객번호" Top="110" VAlign="Middle" Width="80"></Static>
		<Edit Align="CENTER" BindDataset="ds_out_master" Border="Flat" Column="KUNNR" Enable="FALSE" Height="20" Id="ed_cus" Left="90" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="16" Top="112" Width="94"></Edit>
		<Edit BindDataset="ds_out_master" Border="Flat" Column="CSTNM" Enable="FALSE" Height="20" Id="ed_cstnm" Left="187" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="17" Text="(지급인명)" Top="112" Width="145"></Edit>
		<Static Align="Center" Height="24" Id="Static6" Left="490" Style="sty_lb_form_basic" TabOrder="18" Text="사업구분" Top="110" VAlign="Middle" Width="70"></Static>
		<Static Align="Center" Height="24" Id="Static7" Left="187" Style="sty_lb_form_basic" TabOrder="19" Text="팀명" Top="135" VAlign="Middle" Width="74"></Static>
		<Edit Align="CENTER" BindDataset="ds_out_master" Border="Flat" Column="VKGRPNM" Enable="FALSE" Height="20" Id="ed_vkgrpnm" Left="264" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="20" Top="137" Width="140"></Edit>
		<Static Align="Center" Height="24" Id="Static8" Left="407" Style="sty_lb_form_basic" TabOrder="21" Text="업체명" Top="135" VAlign="Middle" Width="81"></Static>
		<Edit Align="CENTER" BindDataset="ds_out_master" Border="Flat" Column="BSUNM" Enable="FALSE" Height="20" Id="ed_bsunm" Left="491" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="22" Top="137" Width="121"></Edit>
		<Static Align="Center" Height="24" Id="Static9" Left="781" Style="sty_lb_form_basic" TabOrder="23" Text="작성자" Top="135" VAlign="Middle" Width="70"></Static>
		<Edit Align="CENTER" BindDataset="ds_out_master" Border="Flat" Column="CRNAME" Enable="FALSE" Height="20" Id="ed_pname" Left="854" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="24" Top="137" Width="110"></Edit>
		<Static Align="Center" Height="24" Id="Static10" Left="8" Style="sty_lb_form_basic" TabOrder="25" Text="청구구분" Top="135" VAlign="Middle" Width="80"></Static>
		<Static Align="Center" Height="24" Id="Static11" Left="781" Style="sty_lb_form_basic" TabOrder="26" Text="견적구분" Top="110" VAlign="Middle" Width="70"></Static>
		<Static Align="Center" Height="24" Id="Static12" Left="615" Style="sty_lb_form_basic" TabOrder="27" Text="수주예정일" Top="110" VAlign="Middle" Width="70"></Static>
		<Static Align="Center" Height="24" Id="Static13" Left="615" Style="sty_lb_form_basic" TabOrder="28" Text="납기일" Top="135" VAlign="Middle" Width="70"></Static>
		<Static Align="Center" Border="Flat" BorderColor="user13" Height="26" Id="Static14" Left="7" Style="sty_lb_form_basic" TabOrder="29" Text="구분" Top="170" VAlign="Middle" Width="97"></Static>
		<Static Align="Center" Border="Flat" BorderColor="user13" Height="26" Id="Static15" Left="103" Style="sty_lb_form_basic" TabOrder="30" Text="자재판매가" Top="170" VAlign="Middle" Width="97"></Static>
		<Static Align="Center" Border="Flat" BorderColor="user13" Height="26" Id="Static16" Left="199" Style="sty_lb_form_basic" TabOrder="31" Text="인건비" Top="170" VAlign="Middle" Width="97"></Static>
		<Static Align="Center" Border="Flat" BorderColor="user13" Height="26" Id="Static17" Left="295" Style="sty_lb_form_basic" TabOrder="32" Text="제경비" Top="170" VAlign="Middle" Width="97"></Static>
		<Static Align="Center" Border="Flat" BorderColor="user13" Height="26" Id="Static18" Left="391" Style="sty_lb_form_basic" TabOrder="33" Text="일반관리비" Top="170" VAlign="Middle" Width="97"></Static>
		<Static Align="Center" Border="Flat" BorderColor="user13" Height="26" Id="Static19" Left="487" Style="sty_lb_form_basic" TabOrder="34" Text="기업이윤" Top="170" VAlign="Middle" Width="97"></Static>
		<Static Align="Center" Border="Flat" BorderColor="user13" Height="26" Id="Static20" Left="583" Style="sty_lb_form_basic" TabOrder="35" Text="합계" Top="170" VAlign="Middle" Width="97"></Static>
		<Static Align="Center" Border="Flat" BorderColor="user13" Height="26" Id="st_bil_amt" Left="871" Style="sty_lb_form_basic" TabOrder="36" Text="기성예상비용" Top="170" VAlign="Middle" Width="97"></Static>
		<Shape BKColor="user12" Bottom="221" Height="26" Id="Shape5" Left="7" LineColor="user13" Right="104" TabOrder="37" Top="195" Type="Rectangle" Width="97"></Shape>
		<Static Align="Center" Height="24" Id="Static26" Left="8" Style="sty_lb_form_basic" TabOrder="38" Text="견적금액" Top="196" VAlign="Middle" Width="95"></Static>
		<Shape BKColor="user12" Bottom="196" Height="26" Id="Shape7" Left="679" LineColor="user13" Right="872" TabOrder="39" Top="170" Type="Rectangle" Width="193"></Shape>
		<Shape BKColor="user12" Bottom="221" Height="26" Id="Shape8" Left="679" LineColor="user13" Right="872" TabOrder="40" Top="195" Type="Rectangle" Width="193"></Shape>
		<Checkbox BindDataset="ds_out_master" Column="NIGHT_WGT" DisableBKColor="user5" DisableColor="user7" Enable="FALSE" FalseValue="1" Height="15" Id="chk_night" Left="687" OnClick="chk_night_OnClick" TabOrder="65" Text="야간작업" Top="176" TrueValue="1.5" Value="FALSE" Width="76"></Checkbox>
		<Checkbox BindDataset="ds_out_master" Column="WEEKEND_WGT" DisableBKColor="user5" DisableColor="user7" Enable="FALSE" FalseValue="1" Height="14" Id="chk_weekend" Left="687" OnClick="chk_weekend_OnClick" TabOrder="67" Text="휴일/철야작업" Top="201" TrueValue="2" Value="FALSE" Width="105"></Checkbox>
		<Static Height="17" Id="Static28" Left="304" TabOrder="41" Text="적용%" Top="226" Width="40"></Static>
		<Static Height="17" Id="Static29" Left="400" TabOrder="42" Text="적용%" Top="225" Width="40"></Static>
		<Static Height="17" Id="Static30" Left="496" TabOrder="43" Text="적용%" Top="225" Width="40"></Static>
		<Static Height="17" Id="Static31" Left="600" TabOrder="44" Text="(천단위&#32;절사)" Top="228" Width="80"></Static>
		<Static Align="Center" Border="Flat" BorderColor="user13" Height="26" Id="st_adm3" Left="189" Style="sty_lb_form_basic" TabOrder="45" Text="재료비" Top="292" VAlign="Middle" Width="86"></Static>
		<Static Align="Center" Border="Flat" BorderColor="user13" Height="26" Id="st_adm4" Left="274" Style="sty_lb_form_basic" TabOrder="46" Text="인건비" Top="292" VAlign="Middle" Width="87"></Static>
		<Static Align="Center" Border="Flat" BorderColor="user13" Height="26" Id="st_adm5" Left="360" Style="sty_lb_form_basic" TabOrder="47" Text="일반노무비" Top="292" VAlign="Middle" Width="87"></Static>
		<Static Align="Center" Border="Flat" BorderColor="user13" Height="26" Id="st_adm6" Left="446" Style="sty_lb_form_basic" TabOrder="48" Text="일식외주" Top="292" VAlign="Middle" Width="87"></Static>
		<Static Align="Center" Border="Flat" BorderColor="user13" Height="26" Id="st_adm7" Left="532" Style="sty_lb_form_basic" TabOrder="49" Text="운반비" Top="292" VAlign="Middle" Width="87"></Static>
		<Static Align="Center" Border="Flat" BorderColor="user13" Height="26" Id="st_adm8" Left="618" Style="sty_lb_form_basic" TabOrder="50" Text="직접비&#32;계" Top="292" VAlign="Middle" Width="87"></Static>
		<Static Align="Center" Border="Flat" BorderColor="user13" Height="26" Id="st_adm9" Left="704" Style="sty_lb_form_basic" TabOrder="51" Text="간접비" Top="292" VAlign="Middle" Width="87"></Static>
		<Static Align="Center" Border="Flat" BorderColor="user13" Height="26" Id="st_adm10" Left="789" Style="sty_lb_form_basic" TabOrder="52" Text="총원가" Top="292" VAlign="Middle" Width="92"></Static>
		<Static Align="Center" Border="Flat" BorderColor="user13" Height="26" Id="st_adm11" Left="880" Style="sty_lb_form_basic" TabOrder="53" Text="원가율" Top="292" VAlign="Middle" Width="88"></Static>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_upload_con" ImageID="btn_sub_07" Left="856" LeftMargin="12" OnClick="btn_upload_con_OnClick" Style="sty_btn" TabOrder="57" Text="계약서&#32;Up-Load" Top="62" Transparent="TRUE" Width="107"></Button>
		<Edit Align="CENTER" BindDataset="ds_out_master" Border="Flat" Column="SPARTNM" Enable="FALSE" Height="20" Id="ed_spart_nm" Left="562" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="58" Top="112" Width="50"></Edit>
		<MaskEdit BindDataset="ds_out_master" Border="Flat" Column="NETWR_OFR" DecimalLen="0" Enable="FALSE" Height="26" Id="ed_netwr_ofr" Left="103" Style="sty_ipt_form" TabOrder="66" TabStop="FALSE" Top="195" Width="97"></MaskEdit>
		<MaskEdit BindDataset="ds_out_master" Border="Flat" Column="LCOST_OFR" DecimalLen="0" Enable="FALSE" Height="26" Id="ed_lcost_ofr" Left="199" Style="sty_ipt_form" TabOrder="68" TabStop="FALSE" Top="195" Width="97"></MaskEdit>
		<MaskEdit BindDataset="ds_out_master" Border="Flat" Column="EXPENSE2" DecimalLen="0" Enable="FALSE" Height="26" Id="ed_exp_ofr" Left="295" Style="sty_ipt_form" TabOrder="69" TabStop="FALSE" Top="195" Width="97"></MaskEdit>
		<MaskEdit BindDataset="ds_out_master" BKColor="user40" Border="Flat" Column="EXP_PCT" Enable="FALSE" Height="20" Id="ed_exp_pct" Left="344" OnChanged="ed_exp_pct_OnChanged" Style="sty_ipt_form" TabOrder="62" Top="223" Width="45"></MaskEdit>
		<MaskEdit BindDataset="ds_out_master" Border="Flat" Column="ADMCOST2" DecimalLen="0" Enable="FALSE" Height="26" Id="ed_mng_ofr" Left="391" Style="sty_ipt_form" TabOrder="70" TabStop="FALSE" Top="195" Width="97"></MaskEdit>
		<MaskEdit BindDataset="ds_out_master" BKColor="user40" Border="Flat" Column="MNG_PCT" Enable="FALSE" Height="20" Id="ed_mng_pct" Left="440" OnChanged="ed_mng_pct_OnChanged" Style="sty_ipt_form" TabOrder="63" Top="223" Width="45"></MaskEdit>
		<MaskEdit BindDataset="ds_out_master" BKColor="user40" Border="Flat" Column="PRO_PCT" Enable="FALSE" Height="20" Id="ed_pro_pct" Left="536" OnChanged="ed_pro_pct_OnChanged" Style="sty_ipt_form" TabOrder="64" Top="223" Width="45"></MaskEdit>
		<MaskEdit BindDataset="ds_out_master" Border="Flat" Column="REVENUE2" DecimalLen="0" Enable="FALSE" Height="26" Id="ed_pro_ofr" Left="487" Style="sty_ipt_form" TabOrder="71" TabStop="FALSE" Top="195" Width="97"></MaskEdit>
		<MaskEdit BindDataset="ds_out_master" Border="Flat" Column="SUM_OFR" DecimalLen="0" Enable="FALSE" Height="26" Id="ed_sum_ofr" Left="583" Style="sty_ipt_form" TabOrder="72" TabStop="FALSE" Top="195" Width="97"></MaskEdit>
		<MaskEdit BindDataset="ds_out_master" Border="Flat" Column="BIL_AMT" Enable="FALSE" Height="26" Id="ed_bil_amt" Left="871" Style="sty_ipt_form" TabOrder="73" TabStop="FALSE" Top="195" Width="97"></MaskEdit>
		<MaskEdit BindDataset="ds_out_master" Border="Flat" Column="HIS_UCOST" DecimalLen="0" Enable="FALSE" Height="26" Id="ed_his_ucost" Left="189" Style="sty_ipt_form" TabOrder="74" TabStop="FALSE" Top="317" Width="86"></MaskEdit>
		<MaskEdit BindDataset="ds_out_master" Border="Flat" Column="HIS_LCOST" DecimalLen="0" Enable="FALSE" Height="26" Id="ed_his_lcost" Left="274" Style="sty_ipt_form" TabOrder="75" TabStop="FALSE" Top="317" Width="87"></MaskEdit>
		<MaskEdit BindDataset="ds_out_master" Border="Flat" Column="HIS_LABOR" DecimalLen="0" Enable="FALSE" Height="26" Id="ed_his_labor" Left="360" Style="sty_ipt_form" TabOrder="76" TabStop="FALSE" Top="317" Width="87"></MaskEdit>
		<MaskEdit BindDataset="ds_out_master" Border="Flat" Column="HIS_OEM" DecimalLen="0" Enable="FALSE" Height="26" Id="ed_his_oem" Left="446" Style="sty_ipt_form" TabOrder="77" TabStop="FALSE" Top="317" Width="87"></MaskEdit>
		<MaskEdit BindDataset="ds_out_master" Border="Flat" Column="HIS_LOG" DecimalLen="0" Enable="FALSE" Height="26" Id="ed_his_log" Left="532" Style="sty_ipt_form" TabOrder="78" TabStop="FALSE" Top="317" Width="87"></MaskEdit>
		<MaskEdit BindDataset="ds_out_master" Border="Flat" Column="HIS_DIRSUM" DecimalLen="0" Enable="FALSE" Height="26" Id="ed_his_dirsum" Left="618" Style="sty_ipt_form" TabOrder="79" TabStop="FALSE" Top="317" Width="87"></MaskEdit>
		<MaskEdit BindDataset="ds_out_master" Border="Flat" Column="HIS_INDSUM" DecimalLen="0" Enable="FALSE" Height="26" Id="ed_his_indsum" Left="704" Style="sty_ipt_form" TabOrder="80" TabStop="FALSE" Top="317" Width="87"></MaskEdit>
		<MaskEdit BindDataset="ds_out_master" Border="Flat" Column="HIS_TOTCOST" DecimalLen="0" Enable="FALSE" Height="26" Id="ed_his_totcost" Left="789" Style="sty_ipt_form" TabOrder="81" TabStop="FALSE" Top="317" Width="92"></MaskEdit>
		<MaskEdit BindDataset="ds_out_master" Border="Flat" Column="HIS_RATE" DecimalLen="1" DecimalMinLen="1" Enable="FALSE" Height="26" Id="ed_his_rate" Left="880" Mask="##.0%" Style="sty_ipt_form" TabOrder="82" TabStop="FALSE" Top="317" Width="88"></MaskEdit>
		<TextArea BindDataset="ds_out_master" Border="Flat" Column="CRSN" Height="54" Id="ed_crsn" Left="103" MaxLength="50" Style="sty_ipt_search_ind" TabOrder="131" Top="403" Width="865"></TextArea>
		<Static Align="Center" Border="Flat" BorderColor="user13" Height="26" Id="st_adm1" Left="8" Style="sty_lb_form_basic" TabOrder="83" Text="변&#32;&#32;&#32;&#32;동" Top="292" VAlign="Middle" Width="96"></Static>
		<Static Align="Center" Border="Flat" BorderColor="user13" Height="26" Id="st_adm12" Left="8" Style="sty_lb_form_basic" TabOrder="84" Text="변경&#32;전" Top="317" VAlign="Middle" Width="96"></Static>
		<Static Align="Center" Border="Flat" BorderColor="user13" Height="26" Id="st_adm13" Left="8" Style="sty_lb_form_basic" TabOrder="85" Text="변경&#32;후" Top="342" VAlign="Middle" Width="96"></Static>
		<MaskEdit Border="Flat" DecimalLen="0" Enable="FALSE" Height="26" Id="ed_hl2" Left="274" Style="sty_ipt_form" TabOrder="86" TabStop="FALSE" Top="342" Width="87"></MaskEdit>
		<MaskEdit Border="Flat" DecimalLen="0" Enable="FALSE" Height="26" Id="ed_hla2" Left="360" Style="sty_ipt_form" TabOrder="87" TabStop="FALSE" Top="342" Width="87"></MaskEdit>
		<MaskEdit Border="Flat" DecimalLen="0" Enable="FALSE" Height="26" Id="ed_ho2" Left="446" Style="sty_ipt_form" TabOrder="88" TabStop="FALSE" Top="342" Width="87"></MaskEdit>
		<MaskEdit Border="Flat" DecimalLen="0" Enable="FALSE" Height="26" Id="ed_hlo2" Left="532" Style="sty_ipt_form" TabOrder="89" TabStop="FALSE" Top="342" Width="87"></MaskEdit>
		<MaskEdit Border="Flat" DecimalLen="0" Enable="FALSE" Height="26" Id="ed_hd2" Left="618" Style="sty_ipt_form" TabOrder="90" TabStop="FALSE" Top="342" Width="87"></MaskEdit>
		<MaskEdit Border="Flat" DecimalLen="0" Enable="FALSE" Height="26" Id="ed_hi2" Left="704" Style="sty_ipt_form" TabOrder="91" TabStop="FALSE" Top="342" Width="87"></MaskEdit>
		<MaskEdit Border="Flat" DecimalLen="0" Enable="FALSE" Height="26" Id="ed_tc2" Left="789" Style="sty_ipt_form" TabOrder="92" TabStop="FALSE" Top="342" Width="92"></MaskEdit>
		<MaskEdit Border="Flat" DecimalLen="1" DecimalMinLen="1" Enable="FALSE" Height="26" Id="ed_hr2" Left="880" Mask="##.0%" Style="sty_ipt_form" TabOrder="93" TabStop="FALSE" Top="342" Width="88"></MaskEdit>
		<Static Align="Center" Border="Flat" BorderColor="user13" Height="26" Id="st_adm14" Left="8" Style="sty_lb_form_basic" TabOrder="94" Text="차&#32;&#32;&#32;&#32;이" Top="367" VAlign="Middle" Width="96"></Static>
		<MaskEdit Border="Flat" DecimalLen="0" Enable="FALSE" Height="26" Id="ed_hu_diff" Left="189" Style="sty_ipt_form" TabOrder="95" TabStop="FALSE" Top="366" Width="86"></MaskEdit>
		<MaskEdit Border="Flat" DecimalLen="0" Enable="FALSE" Height="26" Id="ed_hl_diff" Left="274" Style="sty_ipt_form" TabOrder="96" TabStop="FALSE" Top="367" Width="87"></MaskEdit>
		<MaskEdit Border="Flat" DecimalLen="0" Enable="FALSE" Height="26" Id="ed_hla_diff" Left="361" Style="sty_ipt_form" TabOrder="97" TabStop="FALSE" Top="367" Width="87"></MaskEdit>
		<MaskEdit Border="Flat" DecimalLen="0" Enable="FALSE" Height="26" Id="ed_ho_diff" Left="446" Style="sty_ipt_form" TabOrder="98" TabStop="FALSE" Top="367" Width="87"></MaskEdit>
		<MaskEdit Border="Flat" DecimalLen="0" Enable="FALSE" Height="26" Id="ed_hlo_diff" Left="532" Style="sty_ipt_form" TabOrder="99" TabStop="FALSE" Top="367" Width="87"></MaskEdit>
		<MaskEdit Border="Flat" DecimalLen="0" Enable="FALSE" Height="26" Id="ed_hd_diff" Left="618" Style="sty_ipt_form" TabOrder="100" TabStop="FALSE" Top="367" Width="87"></MaskEdit>
		<MaskEdit Border="Flat" DecimalLen="0" Enable="FALSE" Height="26" Id="ed_tc_diff" Left="789" Style="sty_ipt_form" TabOrder="102" TabStop="FALSE" Top="367" Width="92"></MaskEdit>
		<MaskEdit Border="Flat" DecimalLen="0" Enable="FALSE" Height="26" Id="ed_hi_diff" Left="704" Style="sty_ipt_form" TabOrder="101" TabStop="FALSE" Top="367" Width="86"></MaskEdit>
		<MaskEdit Border="Flat" DecimalLen="1" DecimalMinLen="1" Enable="FALSE" Height="26" Id="ed_hr_diff" Left="880" Style="sty_ipt_form" TabOrder="103" TabStop="FALSE" Top="367" Width="88"></MaskEdit>
		<Static Align="Center" Height="24" Id="Static21" Left="9" Style="sty_lb_form_basic" TabOrder="104" Text="원&#32;수주금액" Top="257" VAlign="Middle" Width="95"></Static>
		<MaskEdit BindDataset="ds_out_master" Border="Flat" Column="SUM_OFR" DecimalLen="0" Enable="FALSE" Height="26" Id="ed_sum_ofr_calc" Left="103" Style="sty_ipt_form" TabOrder="105" TabStop="FALSE" Top="256" Width="97"></MaskEdit>
		<Shape BKColor="user12" Bottom="282" Height="26" Id="Shape11" Left="199" LineColor="user13" Right="296" TabOrder="108" Top="256" Type="Rectangle" Width="97"></Shape>
		<Static Align="Center" Height="24" Id="Static22" Left="200" Style="sty_lb_form_basic" TabOrder="107" Text="변동&#32;금액" Top="257" VAlign="Middle" Width="95"></Static>
		<Shape BKColor="user12" Bottom="282" Height="26" Id="Shape29" Left="391" LineColor="user13" Right="488" TabOrder="112" Top="256" Type="Rectangle" Width="97"></Shape>
		<Static Align="Center" Height="24" Id="Static25" Left="392" Style="sty_lb_form_basic" TabOrder="110" Text="변경&#32;수주금액" Top="257" VAlign="Middle" Width="95"></Static>
		<MaskEdit Border="Flat" DecimalLen="0" Enable="FALSE" Height="26" Id="ed_sum_ofr_chg" Left="487" Style="sty_ipt_form" TabOrder="111" TabStop="FALSE" Top="256" Value="0" Width="97"></MaskEdit>
		<Shape BKColor="user12" Bottom="282" Height="26" Id="Shape30" Left="583" LineColor="user13" Right="680" TabOrder="115" Top="256" Type="Rectangle" Width="97"></Shape>
		<Static Align="Center" Height="24" Id="Static27" Left="584" Style="sty_lb_form_basic" TabOrder="113" Text="변동율" Top="257" VAlign="Middle" Width="95"></Static>
		<MaskEdit Border="Flat" DecimalLen="1" DecimalMinLen="1" Enable="FALSE" Height="26" Id="ed_sum_ofr_rate" Left="679" Mask="###.#%" Style="sty_ipt_form" TabOrder="114" TabStop="FALSE" Top="256" Value="0" Width="97"></MaskEdit>
		<Shape BKColor="user12" Bottom="510" Height="54" Id="Shape12" Left="8" LineColor="user13" Right="105" TabOrder="116" Top="456" Type="Rectangle" Width="97"></Shape>
		<Static Align="Center" Height="52" Id="Static32" Left="9" Style="sty_lb_form_basic" TabOrder="117" Text="조치사항" Top="457" VAlign="Middle" Width="94"></Static>
		<TextArea BindDataset="ds_out_master" Border="Flat" Column="CPRD" Height="54" Id="ed_cprd" Left="103" MaxLength="50" Style="sty_ipt_search_ind" TabOrder="132" Top="456" Width="865"></TextArea>
		<Radio BindDataset="ds_out_master" BKColor="user27" Border="None" CodeColumn="CODE" Column="CHGBN" ColumnCount="5" DataColumn="CODE_NAME" Height="20" Id="rd_dat" INDEX="0" InnerDataset="ds_radio" Left="71" OnChanged="rd_dat_OnChanged" TabOrder="118" Top="62" Width="248"></Radio>
		<Edit Align="CENTER" BindDataset="ds_out_master" Border="Flat" Column="REQKINDNM" Enable="FALSE" Height="20" Id="Edit1" Left="90" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="119" Text="(지급인명)" Top="137" Width="94"></Edit>
		<Edit Align="CENTER" BindDataset="ds_out_master" Border="Flat" Column="SODAT" Enable="FALSE" Height="20" Id="Edit2" Left="688" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="120" Text="(지급인명)" Top="111" Width="90"></Edit>
		<Edit Align="CENTER" BindDataset="ds_out_master" Border="Flat" Column="CS001_GBNNM" Enable="FALSE" Height="20" Id="Edit3" Left="854" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="121" Text="(지급인명)" Top="112" Width="110"></Edit>
		<Edit Align="CENTER" BindDataset="ds_out_master" Border="Flat" Column="SHDAT" Enable="FALSE" Height="20" Id="Edit4" Left="688" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="122" Text="(지급인명)" Top="137" Width="90"></Edit>
		<Static Align="Center" Height="24" Id="Static24" Left="334" Style="sty_lb_form_basic" TabOrder="123" Text="수주번호" Top="110" VAlign="Middle" Width="70"></Static>
		<Edit Align="CENTER" BindDataset="ds_out_master" Border="Flat" Column="VBELN" Enable="FALSE" Height="20" Id="Edit5" Left="407" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="124" Top="112" Width="80"></Edit>
		<Edit Align="CENTER" BindDataset="ds_out_master" Border="Flat" Column="SEQNM" Enable="FALSE" Height="20" Id="Edit8" Left="562" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="125" Top="87" Width="50"></Edit>
		<Static Align="Center" Border="Flat" BorderColor="user13" Height="26" Id="st_adm2" Left="103" Style="sty_lb_form_basic" TabOrder="126" Text="수주금액" Top="292" VAlign="Middle" Width="87"></Static>
		<MaskEdit BindDataset="ds_out_master" Border="Flat" Column="SUM_OFR" DecimalLen="0" Enable="FALSE" Height="26" Id="ed_so_org" Left="103" Style="sty_ipt_form" TabOrder="127" TabStop="FALSE" Top="317" Width="87"></MaskEdit>
		<MaskEdit Border="Flat" DecimalLen="0" Enable="FALSE" Height="26" Id="ed_so2" Left="103" Style="sty_ipt_form" TabOrder="128" TabStop="FALSE" Top="342" Width="87"></MaskEdit>
		<MaskEdit Border="Flat" DecimalLen="0" Enable="FALSE" Height="26" Id="ed_so_diff" Left="103" Style="sty_ipt_form" TabOrder="129" TabStop="FALSE" Top="367" Width="87"></MaskEdit>
		<MaskEdit BindDataset="ds_out_master" Border="Flat" Column="ADJCOST" DecimalLen="0" Height="20" Id="ed_adjcost" Left="298" OnChanged="ed_adjcost_OnChanged" Style="sty_ipt_search_ind" TabOrder="130" TabStop="FALSE" Top="259" Width="91"></MaskEdit>
		<MaskEdit BindDataset="ds_out_master" Border="Flat" DecimalLen="0" Enable="FALSE" Height="26" Id="ed_hu2" Left="189" Style="sty_ipt_form" TabOrder="133" TabStop="FALSE" Top="342" Width="86"></MaskEdit>
		<Static Align="Center" Height="24" Id="Static23" Left="334" Style="sty_lb_form_basic" TabOrder="135" Text="공사번호" Top="60" VAlign="Middle" Width="70"></Static>
		<Edit Align="CENTER" BindDataset="ds_out_master" Border="Flat" Column="PS_PSPID" Enable="FALSE" Height="20" Id="Edit0" Left="407" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="136" Top="62" Width="90"></Edit>
		<Static Align="Center" Height="24" Id="Static33" Left="500" Style="sty_lb_form_basic" TabOrder="137" Text="견적명" Top="60" VAlign="Middle" Width="70"></Static>
		<Edit Align="CENTER" BindDataset="ds_out_master" Border="Flat" Column="QTNAM" Enable="FALSE" Height="20" Id="Edit6" Left="572" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="138" Top="62" Width="280"></Edit>
		<Edit Align="CENTER" Border="Flat" Height="20" Id="ed_reg_cfo" Left="898" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="139" Top="87" Width="67"></Edit>
	</Form>
	<Script><![CDATA[﻿﻿﻿﻿﻿﻿﻿/*
 ******************************************************************************************
 * 기      능   : 보수자재 수주 변경 및 취소
 * 작  성  자   : 이종석
 * 작성  일자   : 2014.11 
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
#include "LIB::commons.js";	// 공통 스크립트 
#include "LIB::common_cs.js";	// 서비스 공통 스크립트
//=========================================================================================
// [ PART 1 ]
// Form에서 사용될 전역변수를 선언
// FORM에서 사용되는 전역변수는 대문자로 작성하며, F_XXX 의 형태를 갖도록 한다. 
//=========================================================================================

var DEBUG_FLAG 	= false;														//디버그 기능 사용을 위한 플래그를 설정한다.
var componentStore;																//enable 상태인 컴포넌트들의 ID를 저장한다. 
var selfFlag;																	//자기자신의 견적인지의 여부를 세팅한다. setPermissions()에서 세팅
var cost_auth = false;                                                          // 원가항목 VISIBLE 권한여부
//=========================================================================================
// [ PART 2 ]
// Form Loading / Unloading 시 작업 정의
//=========================================================================================
function fn_OnLoadCompleted(obj) {
//alert("시작1");					
	gfn_initForm();
//alert("시작2");						
	//if(DEBUG_FLAG) SHOW_ENV();
	
	//관리자 이외에는 원가항목을 감춘다. 
	//원가관련 항목은 DataSet이 채워지기 전에 처리해야 하므로, Form의 Loading이 완료된 직후 값이 Assign되기 전에 Hide한다.
	var userGroup = gfn_getUserGroup();												//사용자 권한그룹
	//if(userGroup != "40")															//그룹이 40인 경우를 제외하고는 해당 항목을 감춘다.
	/*if(G_USER_ID != "2023687" && G_USER_ID != "2021200" && G_USER_ID != "2017938" && G_USER_ID != "2018900" && G_USER_ID != "2029758" && G_USER_ID != "2999999")	//201502120840-원가관련항목은 아무도 볼 수 없도록
	{
		ufn_hideUnitCostComponents();
	}*/	
	
	// 2018.12.27 공통권한 함수로 변경. Han J.H
	gfn_initDs(ds_rcond, true);
	ds_rcond.SetColumn(0, "ZPROGRAM", "CS0101008D");
	ds_rcond.SetColumn(0, "GBN", "01");	
	cost_auth = gfn_getAuth(ds_rcond);
	ds_rcond.ClearData();
	
	if(!(cost_auth == true)) {
		ufn_hideUnitCostComponents();
	}	
		
	//기성 예상 비용은 30번 이상 권한만 열람이 가능하도록 한다.
	if(toNumber(userGroup) < 30)
	{
		ufn_setObjectVisibility("st_bil_amt", false);
		ufn_setObjectVisibility("ed_bil_amt", false);
	}					

	//컴포넌트 중 enable 상태인 컴포넌트들을 전역변수에 저장한다.
	ufn_saveEnabledComponents();

	//이전 화면에서 견적번호가 넘어온 경우인지 확인한다.
	if ( isExistVar("ar_qtnum", true) && isExistVar("ar_seq", true) ) 			//이전화면에서 견적번호/차수가 넘어옴
	{
		if(length(ar_qtnum) < 10 || length(ar_seq) < 1 || length(ar_upn) < 1 || length(ar_cst) < 1)
		{
			if(length(ar_seq) < 1)
			{
				gfn_showAlert("CW10025", "시스템 업데이트 이전에 생성된 견적데이터 입니다. 그룹웨어를 통해 주수변경/취소 결재를 진행해주시기 바랍니다.");
			}
			else
			{
				gfn_showAlert("CW10025", "잘못된 접근입니다.");
			}
			fn_close();		
		}
			
		ds_cond.SetColumn(0, "QTNUM", ar_qtnum);
		ds_cond.SetColumn(0, "SEQ", ar_seq);
		ds_cond.SetColumn(0, "UPN", ar_upn);
		ds_cond.SetColumn(0, "CST", ar_cst);
	}
	else if( isExistVar("ar_qtnum", true) || isExistVar("ar_seq", true))		//이전화면에서 견적번호 또는 차수만 넘어옴
	{
		gfn_showAlert("CW10025", "견적번호 또는 차수가 올바르지 않습니다.");
		fn_close();
	}
	else
	{
		gfn_showAlert("CW10025", "잘못된 접근입니다.");
		fn_close();
	}
	
	ufn_initParameters();
	
	ufn_getOfferInfo();	
}

/********************************************************************************
* 기      능   : form UnloadCompleted 
********************************************************************************/
function fn_OnUnloadCompleted(obj) {
	return gfn_isFormUnload(obj);
}
//=========================================================================================
// [ PART 3 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,form닫기)
//=========================================================================================

/********************************************************************************
* 기      능   : 수주 및 자재 전산변경 의뢰서 출력
********************************************************************************/

function fn_print() {
	var docNo4, docNo5;
	var docNo4Stat, docNo5Stat;
	
	docNo4 = ds_out_master.GetColumn(0, "DOC4");								//변경결재문서번호
	docNo5 = ds_out_master.GetColumn(0, "DOC5");								//취소결재문서번호
	docNo4Stat = ds_out_master.GetColumn(0, "DOC4STAT");						//변경결재상태
	docNo5Stat = ds_out_master.GetColumn(0, "DOC5STAT");						//취소결재상태

	ds_conf_cond.clearData();
	ds_conf_cond.AddRow();
	
	if(rd_dat.Value == "1")														//수주변경시
	{
		if(docNo4.length < 10)
		{
			gfn_showAlert("CW10025", "해당 구분의 결재정보가 존재하지 않습니다. \n변경/취소 구분을 확인해주세요.");
			rd_dat.SetFocus();
			return;
		}
		ds_conf_cond.SetColumn(0, "DOCNO", docNo4);
	}
	else if(rd_dat.Value == "2")												//수주취소시
	{
		if(docNo5.length < 10)
		{
			gfn_showAlert("CW10025", "해당 구분의 결재정보가 존재하지 않습니다. \n변경/취소 구분을 확인해주세요.");
			rd_dat.SetFocus();
			return;
		}	
		ds_conf_cond.SetColumn(0, "DOCNO", docNo5);
	}
	else
	{
		gfn_showAlert("CW10025", "변경/취소 구분을 선택해주세요.");
		rd_dat.SetFocus();
		return;
	}

	fn_createWait("",this);														//처리중 윈도우 create

	tit_clearActionInfo();
	tit_addSearchActionInfo("wb01:DOC_CONF_S1");
	tit_addSearchActionInfo("wb01:DOC_CONF_S2");
	tit_callService(
		""
		, ""
		, "ds_conf_cond=ds_conf_cond"
		, "ds_conf_list=ds_conf_list ds_draftpers_list=ds_draftpers_list"
		, ""
		, "fn_afterPrint"
		, true
		, true
		, true); 
}

function fn_afterPrint() 
{
	//ds_draftpers_list.SetColumn(0, "D_TOTEM", "서비스 관리부");
	
	DEBUG("fn_afterprint", ds_conf_list.SaveXml());
	DEBUG("fn_afterprint", ds_draftpers_list.SaveXml());
		
	//견적상세정보를 가져온다.
	tit_clearActionInfo();	
	tit_addSearchActionInfo("cs01:CS0101008B_S5");  							//견적 디테일 정보
	tit_callService("", "", "ds_cond=ds_cond", "ds_list=ds_list", "", "", true, true, true);
	
	ds_print.clearData();
	ds_print.addRow();
	
	DEBUG("fn_afterPrint", ds_list.saveXml());
	
	//보수자재, 내작자재 각각의 원가를 계산한다.
	var sumStd = 0, sumBOM = 0;													//보수자재 원가, BOM자재 원가
	for(var iCnt = 0;iCnt < ds_list.rowcount; iCnt++)
	{
		//DEBUG("fn_afterPrint", "Length of CGBN is " + ds_list.GetColumn(iCnt, "CGBN").length );
		if(ds_list.GetColumn(iCnt, "CGBN").length == 0)
		{
			//DEBUG("fn_afterPrint", "RGBN is " + ds_list.GetColumn(iCnt, "RGBN"));
			if(ds_list.GetColumn(iCnt, "RGBN") == "1")							//내작(BOM)자재
			{
				sumStd += toNumber(ds_list.GetColumn(iCnt, "UCOST"));
			}
			else
			{
				sumBOM += toNumber(ds_list.GetColumn(iCnt, "UCOST"));
			}
		}
	}
	
	//신청구분
	ds_print.SetColumn(0, "SG3", "");											//수주 No변경 (발생하지 않음)
	if(rd_dat.Value == "1")														
	{
		ds_print.SetColumn(0, "SG1", "");										//수주취소		
		ds_print.SetColumn(0, "SG2", "O");										//수주변경
	}
	else
	{
		ds_print.SetColumn(0, "SG1", "O");										//수주취소
		ds_print.SetColumn(0, "SG2", "");										//수주변경		
	}
	
	//프로젝트 DETAIL
	ds_print.SetColumn(0, "DT1", ds_out_master.GetColumn(0, "MA_PSPID"));		//Project NO
	ds_print.SetColumn(0, "DT2", ds_out_master.GetColumn(0, "SPT"));			//현장명
	ds_print.SetColumn(0, "DT3", ds_out_master.GetColumn(0, "APDAT"));			//수주일자
	ds_print.SetColumn(0, "DT4", ds_out_master.GetColumn(0, "VKGRPNM"));		//지사명
	ds_print.SetColumn(0, "DT5", ds_out_master.GetColumn(0, "CSTNM"));			//거래선명
	ds_print.SetColumn(0, "DT6", ed_so_org.Value);								//변경전 수주금액
	
	//수주금액
	ds_print.SetColumn(0, "MN011", ed_so_org.Value);							//변경전
	ds_print.SetColumn(0, "MN012", ed_so2.Value);								//변경후
	ds_print.SetColumn(0, "MN013", ed_so_diff.Value);							//차이

	//재료비(일반)
	ds_print.SetColumn(0, "MN021", sumStd);										//변경전
	ds_print.SetColumn(0, "MN022", sumStd);										//변경후
	ds_print.SetColumn(0, "MN023", "0");										//차이
	
	//재료비(BOM)
	ds_print.SetColumn(0, "MN031", sumBOM);										//변경전
	ds_print.SetColumn(0, "MN032", sumBOM);										//변경후
	ds_print.SetColumn(0, "MN033", "0");										//차이
	
	//외주비
	ds_print.SetColumn(0, "MN041", toNumber(ed_his_lcost.Value) + 				//변경전
								   toNumber(ed_his_labor.Value) + 
								   toNumber(ed_his_oem.Value));
	ds_print.SetColumn(0, "MN042", toNumber(ed_hl2.Value) + 					//변경후
								   toNumber(ed_hla2.Value) + 
								   toNumber(ed_ho2.Value));
	ds_print.SetColumn(0, "MN043", "0");										//차이
	
	//경비
	ds_print.SetColumn(0, "MN051", ed_his_log.Value);							//변경전
	ds_print.SetColumn(0, "MN052", ed_hlo2.Value);								//변경후
	ds_print.SetColumn(0, "MN053", "0");
	
	//직접비
	ds_print.SetColumn(0, "MN061", ed_his_dirsum.Value);						//변경전
	ds_print.SetColumn(0, "MN062", ed_hd2.Value);								//변경후
	ds_print.SetColumn(0, "MN063", "0");										//차이
	
	//간접비
	ds_print.SetColumn(0, "MN071", ed_his_indsum.Value);						//변경전
	ds_print.SetColumn(0, "MN072", ed_hi2.Value);								//변경후
	ds_print.SetColumn(0, "MN073", "0");										//차이
	
	//총원가
	ds_print.SetColumn(0, "MN081", ed_his_totcost.Value);						//변경전
	ds_print.SetColumn(0, "MN082", ed_tc2.Value);								//변경후
	ds_print.SetColumn(0, "MN083", "0");										//차이
	
	//시행율
	ds_print.SetColumn(0, "MN091", ed_his_rate.Value);							//변경전
	ds_print.SetColumn(0, "MN092", ed_hr2.Value);								//변경후
	ds_print.SetColumn(0, "MN093", ed_hr_diff.Value);							//차이
	
	//변경사유
	ds_print.SetColumn(0, "MN101", ed_crsn.Value);
	
	//조치사항
	ds_print.SetColumn(0, "MN111", ed_cprd.Value);
	
	DEBUG("fn_afterPrint", ds_print.SaveXml());
	
	fn_destroyWait();															//처리중 윈도우 Destruct
	
	Dialog("CS01::CS0101008H.xml", "");
}

/********************************************************************************
* 기      능   : 저장 
********************************************************************************/
function fn_save() {
	
	//입력사항에 문제가 있을 경우 return. 
	if(!ufn_checkInputForSave())
	{
		return;
	}
	
	if (!gfn_showConfirm("CI00010")) 
	{
		return;
	}
	
	DEBUG("fn_save", ds_out_master.SaveXml());
	
	//변경구분을 설정한다(1:수주변경/2:수주취소/3:재청구)
	//ds_out_master.SetColumn(0, "CHGBN", rd_dat.value);	이미 rd_dat_onChange Event Handler에서 처리 완료
	
	if(rd_dat.Value == "1")														//구분에 따라 문서번호를 clear한다.
	{
		ds_out_master.SetColumn(0, "DOC4", "");
		ds_out_master.SetColumn(0, "CHGBN", "1");							
	}
	else
	{
		ds_out_master.SetColumn(0, "DOC5", "");
		ds_out_master.SetColumn(0, "CHGBN", "2");
	}	
	
	//저장한다....
	ufn_saveData();
}

/********************************************************************************
* 기      능   : 누락 항목 Check
********************************************************************************/
function ufn_checkInputForSave()
{

	if(toNumber(rd_dat.Value) <= 0)												//수주취소/수주금액변경 여부 선택
	{
		gfn_showAlert("CW00001", "수주취소/수주금액변경 여부");
		rd_dat.setFocus();
		return false;
	}
	
	if(rd_dat.Value == "1" && toNumber(ed_adjcost.Value) == 0)					//수주금액변경 시 변동금액이 0인가
	{
		gfn_showAlert("CW00001", "수주금액변경시 변동금액");
		ed_adjcost.setFocus();
		return false;
	}
	
	if(ufn_isNull(ed_crsn, true, "변경(취소)사유", ed_crsn)) return false;		//견적명
	if(ufn_isNull(ed_cprd, true, "조치사항", ed_cprd)) return false;			//견적명
	
	return true;
}

/********************************************************************************
* 기      능   : DB 저장 루틴
********************************************************************************/
function ufn_saveData()
{
	tit_clearActionInfo();														// 저장 처리 

	tit_addMultiActionInfo("cs01:CS0101008D_U1");								//ZCST001에 마스터 데이터를 업데이트한다.

	tit_callService(															//ZMMT031에 저장할 정보는 없나?	
        ""
        , ""
        , "ds_out_master=ds_out_master ds_cond=ds_cond"
        , ""
        , ""
        , "fn_afterSave");	
}

/********************************************************************************
* 기      능   : 저장 Callback  
********************************************************************************/
function fn_afterSave(errCode, errMsg) {
	if ( errCode!= 0 ) {
		gfn_showMsg("CE00001");
	} else {
		gfn_showMsg("CI00003");
		gfn_showAlert("CI00003");
		
		ufn_resetAll();															//모든 정보를 리셋한다.
		ufn_getOfferInfo();														//견적정보를 가져온다.
		ufn_setPermissions();
	}
}

/********************************************************************************
* 기      능   : 닫기  
********************************************************************************/
function fn_close() {
	close();
}

/********************************************************************************
* 기      능   : 반송 65
********************************************************************************/
function fn_sendback() {
	var docNo4, docNo5;															//수주변경결재번호, 수주취소결재번호
	var docNo4Stat, docNo5Stat;													//수주변경결재상태, 수주취소결재상태
	
	var workStage;																//수주이후작업단계(0:청구전송완료/1:수주변경결재/2:수주취소결재/3:수주재청구결재)
		
	docNo4 = ds_out_master.GetColumn(0, "DOC4");								//변경결재문서번호
	docNo5 = ds_out_master.GetColumn(0, "DOC5");								//취소결재문서번호
	docNo4Stat = ds_out_master.GetColumn(0, "DOC4STAT");						//변경결재상태
	docNo5Stat = ds_out_master.GetColumn(0, "DOC5STAT");						//취소결재상태

	workStage = ds_out_master.GetColumn(0, "CHGBN");							//현재 결재 상태
	
	if((workStage=="1" && docNo4.length <= 0) || 								//문서번호가 제대로 입력되어있지 않을 경우
			(workStage=="2" && docNo5.length <= 0))
	{
		gfn_showAlert("CW10025", "수주변경/취소 기안이 완료되지 않았습니다.");
		return;
	}
	
	if(!gfn_showConfirm("CI30001", "본 건을 반송처리 하시겠습니까?"))			//반송처리하시겠습니까?
	{
		gfn_showAlert("CW10025", "반송처리가 취소되었습니다.");
		return;
	}	
	
	ds_dec.ClearData();
	ds_dec.AddRow();
	
	if((workStage == "1" && toNumber(docNo4Stat) > 3) ||						//수신부서 결재 상태이면
			(workStage == "2" && toNumber(docNo5Stat) > 3))
	{
		ds_dec.SetColumn(0, "APPGUBN", "R");									//수신부서결재플래그
		ds_dec.SetColumn(0, "APSTAT", "5");										//결재마스터 상태 - 반송(2)
	}
	else
	{
		ds_dec.SetColumn(0, "APPGUBN", "S");									//기안부서결재플래그
		ds_dec.SetColumn(0, "APSTAT", "2");										//결재마스터 상태 - 반송(2)
	}
	
	ds_dec.SetColumn(0, "REIRUM", G_USER_NAME);									//결재자 이름
	ds_dec.SetColumn(0, "SEQSTAT", "2");										//결재상세 상태 - 반송(2)
	
	if(workStage=="1")															//수주변경결재시
	{
		ds_dec.SetColumn(0, "DOCNO", docNo4);									
		ds_dec.SetColumn(0, "SEQNO", ds_out_master.GetColumn(0, "DOC4CURSEQ"));
		ds_dec.SetColumn(0, "DOCKIND", "15");									//문서종류(수리공사견적)
	}
	else																		//수주취소결재시
	{
		ds_dec.SetColumn(0, "DOCNO", docNo5);
		ds_dec.SetColumn(0, "SEQNO", ds_out_master.GetColumn(0, "DOC5CURSEQ"));
		ds_dec.SetColumn(0, "DOCKIND", "20");									//문서종류(수리공사계약(수주))
	}
	
	DEBUG("fn_sendback", ds_dec.SaveXml());	
	
	ds_reject_wb.clearData();													//반송의견을 반송쪽지로 전송하기 위해 데이터셋을 클리어하고, 행을 추가한다.
	ds_reject_wb.AddRow();	

	
	if(gfn_showConfirm("CI30001","반송 의견을 입력하시겠습니까?") )				//반송 의견 입력
	{
		var arg = "";
		arg = "fa_docno=" + quote(ds_dec.GetColumn(0,"DOCNO")) + 
		      " fa_dockind=" + quote(ds_dec.GetColumn(0,"DOCKIND"));
		var rtn_yn = gfn_openPopup2("CS0401001C", true , arg);
	}
	
	//반송메시지를 생성한다.
	ufn_sendSendbackMessage();
	
	//결재마스터(zwbap01)와 결재디테일(zwbap02)을 업데이트 해준다.
	
	tit_clearActionInfo();
	tit_addSearchActionInfo("cs01:CS0101008B_T3",true);							//쪽지전송테이블 Lock (중복번호 채번 방지)
	tit_addMultiActionInfo("cs01:CS0101008B_I5", "cs01:CS0101008B_S16", 1);		//쪽지전송		
	tit_addMultiActionInfo("cs04:CS0401001A_U1");								//결재마스터 Update
	tit_addMultiActionInfo("cs04:CS0401002A_U2");								//결재디테일 Update
	tit_callService(
		"",
		"",
		"ds_head=ds_dec ds_list_0=ds_dec ds_reject_list=ds_reject_list",
		"",
		"",
		"", 
		true, 
		false,
		true);	
	
	gfn_showAlert("CI30001", "반송처리가 완료되었습니다.");
	fn_close();	
}

/********************************************************************************
* 기      능   : 반송메시지 작성
********************************************************************************/
function ufn_sendSendbackMessage()
{
	var workStage = ds_out_master.GetColumn(0, "CHGBN");						//현재 결재 상태
	var msgDocNo = ds_dec.GetColumn(0,"DOCNO");
	var msgTitle = "견적번호 " + ds_out_master.GetColumn(0, "QTNUM") + "인 문서가 ";
	
	if(workStage == "1")														//수주변경결재
		msgTitle += "수주변경 결재중 반송되었습니다.";
	else
		msgTitle += "수주취소 결재중 반송되었습니다.";

	var msgBody = "견적명 : " + ds_out_master.GetColumn(0, "QTNAM") + "\n" +
				  "견적번호 : " + ds_out_master.GetColumn(0, "QTNUM") + "\n" +
				  "견적차수 : " + ds_out_master.GetColumn(0, "SEQ") + "\n" +
				  "프로젝트 : " + ds_out_master.GetColumn(0, "SPT") + "\n" +
				  "현장정보 : " + ds_out_master.GetColumn(0, "KUNNR") + "(" + ds_out_master.GetColumn(0, "CSTNM") + ")\n" +
				  "반송정보 : " + ds_reject_wb.GetColumn(0, "APDESC");				//반송메시지를 추가한다.
				  
	//반송쪽지 전송 검색조건 세팅(문서번호)
	ds_reject_cond.clearData();
	ds_reject_cond.AddRow();
	ds_reject_cond.SetColumn(0, "DOCNO", msgDocNo);								//문서번호 설정
	
	ds_reject_list.ClearData();													//전송대상 리스트를 클리어한다.

	tit_clearActionInfo();					
	tit_addSearchActionInfo("cs01:CS0101008B_S15");								//반송 기안자 
	tit_callService("", "", "ds_reject_cond=ds_reject_cond", "ds_reject_wb=ds_reject_wb", "", "", true, false, true);	
	
	ds_reject_list.AddRow();													//작성자
	ds_reject_list.SetColumn(0, "MESGSEND", G_USER_ID);							//반송자
	ds_reject_list.SetColumn(0, "MESGACCP", ds_out_master.GetColumn(0,"CRNAM"));//작성자
	ds_reject_list.SetColumn(0, "MESGTITL", msgTitle);							//제목
	ds_reject_list.SetColumn(0, "MESGDESC", msgBody);							//반송문구
	
	//기안부서 기안자가 존재하고, 작성자가 기안부서 기안자가 아닐 경우(이미 전송된 사용자에게 중복전송되지 않도록)
	if(length(ds_reject_wb.GetColumn(0, "APNUM1")) > 1 
		&&ds_out_master.GetColumn(0, "CRNAM") != ds_reject_wb.GetColumn(0, "APNUM1"))
	{
		ds_reject_list.AddRow();												//기안부서 기안자
		ds_reject_list.SetColumn(1, "MESGSEND", G_USER_ID);
		ds_reject_list.SetColumn(1, "MESGACCP", ds_reject_wb.GetColumn(0, "APNUM1"));
		ds_reject_list.SetColumn(1, "MESGTITL", msgTitle);
		ds_reject_list.SetColumn(1, "MESGDESC", msgBody);
	}
		
	//관리부서 기안자 존재하고 관리부서 기안자 작성자 또는 기안부서 기안자가 아닌 경우(이미 전송된 사용자에게 중복전송되지 않도록)
	if( length(ds_reject_wb.GetColumn(0, "APNUM2")) > 1 
		&& (ds_out_master.GetColumn(0, "CRNAM") != ds_reject_wb.GetColumn(0, "APNUM2"))
		&& (ds_reject_wb.GetColumn(0, "APNUM1") != ds_reject_wb.GetColumn(0, "APNUM2")) )
	{
		ds_reject_list.AddRow();												//관리부서 기안자
		ds_reject_list.SetColumn(2, "MESGSEND", G_USER_ID);
		ds_reject_list.SetColumn(2, "MESGACCP", ds_reject_wb.GetColumn(0, "APNUM2"));
		ds_reject_list.SetColumn(2, "MESGTITL", msgTitle);
		ds_reject_list.SetColumn(2, "MESGDESC", msgBody);
	}
		
	DEBUG("ufn_sendSendbackMessage", "ds_reject_list is " + ds_reject_list.SaveXml());
}

/********************************************************************************
* 기      능   : 결재 15
********************************************************************************/
function fn_decide() {
	var docNo4, docNo5;															//수주변경결재번호, 수주취소결재번호
	var docNo4Stat, docNo5Stat;													//수주변경결재상태, 수주취소결재상태
	
	var workStage;																//수주이후작업단계(0:청구전송완료/1:수주변경결재/2:수주취소결재/3:수주재청구결재)
		
	docNo4 = ds_out_master.GetColumn(0, "DOC4");								//변경결재문서번호
	docNo5 = ds_out_master.GetColumn(0, "DOC5");								//취소결재문서번호
	docNo4Stat = ds_out_master.GetColumn(0, "DOC4STAT");						//변경결재상태
	docNo5Stat = ds_out_master.GetColumn(0, "DOC5STAT");						//취소결재상태

	workStage = ds_out_master.GetColumn(0, "CHGBN");							//현재 결재 상태
	
	if((workStage=="1" && docNo4.length <= 0) || 								//문서번호가 제대로 입력되어있지 않을 경우
			(workStage=="2" && docNo5.length <= 0))
	{
		gfn_showAlert("CW10025", "수주변경/취소 기안이 완료되지 않았습니다.");
		return;
	}

	if(!gfn_showConfirm("CI30001", "본 건을 결재처리 하시겠습니까?"))			//결재처리하시겠습니까?
	{
		gfn_showAlert("CW10025", "결재처리가 취소되었습니다.");
		return;
	}
	
	ds_dec.ClearData();
	ds_dec.AddRow();
	
	if((workStage == "1" && toNumber(docNo4Stat) > 3) ||						//수신부서 결재 상태이면
			(workStage == "2" && toNumber(docNo5Stat) > 3))
	{
		ds_dec.SetColumn(0, "APPGUBN", "R");									//수신부서결재플래그
	}
	else
	{
		ds_dec.SetColumn(0, "APPGUBN", "S");									//기안부서결재플래그
	}
	
	ds_dec.SetColumn(0, "SEQSTAT", "3");										//결재자 정상결재 완료 플래그
	ds_dec.SetColumn(0, "REIRUM", G_USER_NAME);									//결재자 이름
	
	var updateQTFlag = false;													//일시 업데이트 플래그
		
	if(workStage == "1")														//수주변경결재시
	{
		ds_dec.SetColumn(0, "DOCNO", docNo4);									//결재문서번호								
		
		ds_dec.SetColumn(0, "SEQNO", ds_out_master.GetColumn(0, "DOC4CURSEQ"));	//결재자순번
		ds_dec.SetColumn(0, "DOCKIND", "15");									//문서종류(수주변경결재)
		
		if(ds_out_master.GetColumn(0, "DOC4CURSEQ") == 							//최종결재자이면
				ds_out_master.GetColumn(0, "DOC4MAXSEQ"))
		{
			if(toNumber(docNo4Stat) > 3) 										//수신부서결재면 전체결재완료(6)로, 
			{
				ds_dec.SetColumn(0, "APSTAT", "6");
				ds_out_master.SetColumn(0, "SOCHDAT", gfn_getCurrDate());		//견적마스터의 견적승인일에 오늘일자를 등록한다.
				updateQTFlag = true;											//견적마스터를 업데이트한다.
			}
			else 																//기안부서결재면 부서결재완료(3)로
			{
				ds_dec.SetColumn(0, "APSTAT", "3");
			}
		}
		else
		{
			if(toNumber(docNo4Stat) > 3) 										//수신부서결재면 전체결재완료(6)로, 
			{
				ds_dec.SetColumn(0, "APSTAT", "4");								//최종결재자가 아니면 ZWBAP01의 APSTAT는 1로 남겨둠
			}
			else
			{
				ds_dec.SetColumn(0, "APSTAT", "1");								//최종결재자가 아니면 ZWBAP01의 APSTAT는 1로 남겨둠
			}
		}
	}
	else																		//수주취소결재시
	{
		ds_dec.SetColumn(0, "DOCNO", docNo5);									//결재문서번호								
		
		ds_dec.SetColumn(0, "SEQNO", ds_out_master.GetColumn(0, "DOC5CURSEQ"));	//결재자순번
		ds_dec.SetColumn(0, "DOCKIND", "20");									//문서종류(수주변경결재)
		
		if(ds_out_master.GetColumn(0, "DOC5CURSEQ") == 							//최종결재자이면
				ds_out_master.GetColumn(0, "DOC5MAXSEQ"))
		{
			if(toNumber(docNo5Stat) > 3) 										//수신부서결재면 전체결재완료(6)로, 
			{
				ds_dec.SetColumn(0, "APSTAT", "6");
				ds_out_master.SetColumn(0, "SOCADAT", gfn_getCurrDate());		//견적마스터의 견적승인일에 오늘일자를 등록한다.
				updateQTFlag = true;											//견적마스터를 업데이트한다.
			}
			else 																//기안부서결재면 부서결재완료(3)로
			{
				ds_dec.SetColumn(0, "APSTAT", "3");
			}
		}
		else
		{
			if(toNumber(docNo5Stat) > 3) 										//수신부서결재면 전체결재완료(6)로, 
			{
				ds_dec.SetColumn(0, "APSTAT", "4");								//최종결재자가 아니면 ZWBAP01의 APSTAT는 1로 남겨둠
			}
			else
			{
				ds_dec.SetColumn(0, "APSTAT", "1");								//최종결재자가 아니면 ZWBAP01의 APSTAT는 1로 남겨둠
			}
		}
	}
	
	DEBUG("fn_decide", ds_dec.SaveXml());
	
	if(gfn_showConfirm("CI30001","결재 의견을 입력하시겠습니까?") )				//결재 의견 입력
	{
		var arg = "";
		arg = "fa_docno=" + quote(ds_dec.GetColumn(0,"DOCNO")) + 
		      " fa_dockind=" + quote(ds_dec.GetColumn(0,"DOCKIND"));
		var rtn_yn = gfn_openPopup2("CS0401001C", true , arg);
	}
	
	//----------------------------------------------------------------------
	// 팀장 의견입력 필수 체크 20170718
	if(! gfn_decideCommentCheck(quote(ds_dec.GetColumn(0,"DOCNO")) )) 
		return;   	
	//----------------------------------------------------------------------
	
	//결재마스터(zwbap01)와 결재디테일(zwbap02)을 업데이트 해준다.
	
	tit_clearActionInfo();
	tit_addMultiActionInfo("cs04:CS0401001A_U1");								//결재마스터 Update
	tit_addMultiActionInfo("cs04:CS0401002A_U2");								//결재디테일 Update
	if(updateQTFlag) tit_addMultiActionInfo("cs01:CS0101008B_U1");				//견적마스터 Update (견적승인일 또는 수주승인일 업데이트가 필요할때)
	tit_callService(
		"",
		"",
		"ds_head=ds_dec ds_list_0=ds_dec ds_out_master=ds_out_master",
		"",
		"",
		"", 
		true, 
		false,
		true);	
	
	gfn_showAlert("CI30001", "결재가 완료되었습니다.");
	fn_close();
}

/********************************************************************************
* 기      능   : 기안 16 - 견적 기안만 이루어짐. 수주 기안은 수주등록 버튼에서
********************************************************************************/
function fn_draft() {
	var docNo4, docNo5;															//수주변경결재번호, 수주취소결재번호
	var docNo4Stat, docNo5Stat;													//수주변경결재상태, 수주취소결재상태
	var workStage;																//수주이후작업단계(0:청구전송완료/1:수주변경결재/2:수주취소결재/3:수주재청구결재)
	var docNo, docKind;															//결재문서번호, 결재종류
	var appGubn = "";															//결재종류(S는 기안부서, R는 수신부서)
	var inputArg;																//결재선지정창에 넘길 arguments
	var newDocNo;																//신규 결재문서번호
	
	docNo4 = ds_out_master.GetColumn(0, "DOC4");								//변경결재문서번호
	docNo5 = ds_out_master.GetColumn(0, "DOC5");								//취소결재문서번호
	docNo4Stat = ds_out_master.GetColumn(0, "DOC4STAT");						//변경결재상태
	docNo5Stat = ds_out_master.GetColumn(0, "DOC5STAT");						//취소결재상태

	workStage = ds_out_master.GetColumn(0, "CHGBN");							//현재 결재 상태

	var docPrefix;
	if(workStage == "1")														//수리공사수주변경결재
	{
		docKind = "15";
		docPrefix = "R04";
		if(docNo4Stat == "3") appGubn = "R";									//기안부서결재종료시 수신부서결재시 결재구분 R
		else appGubn = "S";														//미종료시 기안부서결재 결재구분 S
	}
	else																		//수리공사수주취소결재
	{
		docKind = "20";
		docPrefix = "R09";
		if(docNo5Stat == "3") appGubn = "R";									//기안부서결재종료시 수신부서결재시 결재구분 R
		else appGubn = "S";														//미종료시 기안부서결재 결재구분 S
	}
	
	//10번 권한 사용자면 기안접수함에 데이터를 넣고 끝낸다.
	var user_grp = gfn_getUserGroup();
	if( user_grp == '10' && substr(G_USER_ID,0,1) == '8' ) 
	{
		var arg = "fa_docno=" + quote(ds_out_master.GetColumn(0, "QTNUM") + ds_out_master.GetColumn(0, "SEQ")) + " fa_dockind=" + quote(docKind);

		var returnArgs = gfn_openPopup2("CS0401001B", true, arg);

		if( returnArgs[0] == "S" ) 
		{
			gfn_showAlert("CI30001", "기안 접수가 완료되었습니다.");
		}
		else
		{
			gfn_showAlert("CW10025", "기안접수에 실패했습니다. 확인 후 다시 시도해주세요.");
		}
		ufn_resetAll();															//모든 정보를 리셋한다.
		ufn_getOfferInfo();														//견적정보를 가져온다.
		ufn_setPermissions();
		return;
	}
		
	DEBUG("fn_draft", "workStage:"+workStage+"/doc4stat:" + docNo4Stat + "/appGubn:"+appGubn+"/docKind:"+docKind);

	var newDocNo = "";
	
	if(appGubn == "S")															//기안부서결재시에만 문서번호 신규생성
	{
		ds_docno_gen.ClearData();												//결재번호생성 데이터셋을 클리어한다
		ds_docno_gen.AddRow();																
		ds_docno_gen.SetColumn(0,"PFX",docPrefix);								//Prefix는 R04또는 R09로 세팅
		tit_clearActionInfo();					
		tit_addSearchActionInfo("wb01:DOC_CODE_GEN_S1",true);					
		tit_addSearchActionInfo("wb01:DOC_CODE_GEN_U1");					
		tit_callService(														//동기화 방식으로 서비스를 콜한다.	
			, ""				
			, "ds_docno_gen_i=ds_docno_gen"				
			, "ds_docno_gen=ds_docno_gen_o"				
			, ""				
			, ""				
			, true
			, false
			, true);				
	
		newDocNo = ds_docno_gen.GetColumn(0, "DOCNO");
	}
	else																		//수신부서결재시에는 기존문서번호 이용
	{
		if(workStage == "1") newDocNo = docNo4;
		else newDocNo = docNo5;
	}
	
	if(length(newDocNo) <= 1)
	{
		gfn_showMsg("CW10025", "결재문서번호 생성에 실패했습니다. 잠시 후 다시 시도해주세요.");
		return;
	}
	
	inputArg = "fa_docno=" + quote(newDocNo) + 									//결재선생성창을 위한 Argument를 설정한다.
			   " fa_dockind=" + quote(docKind) + 
			   " fa_appgubn=" + quote(appGubn);
//ALERT("A");	
	var ret = gfn_openPopup("CS0401001A",true, inputArg);
//ALERT("B");	
	if(ret[0] == "S")															//상신 성공시 작업 - 수주변경/취소 결재번호(doc4, doc5) Update
	{
		if(appGubn == "S")														//기안부서 최초 상신일 경우에만 견적마스터에 결재번호, 변경구분 업데이트
		{
			if(docKind == "15")													//수주변경(15)
			{
				ds_out_master.SetColumn(0, "DOC4", newDocNo);					//수주변경 결재번호에 신규생성된 결재번호를 넣음
				ds_out_master.SetColumn(0, "CHGBN", "1");
			}
			else																//수주취소(20)
			{
				ds_out_master.SetColumn(0, "DOC5", newDocNo);					//수주취소 결재번호에 신규생성된 결재번호를 넣음
				ds_out_master.SetColumn(0, "CHGBN", "2");
			}
			tit_clearActionInfo();
			tit_addMultiActionInfo("cs01:CS0101008B_U1");						//결재번호를 ZCST001에 Update한다.
			tit_callService(
				"",
				"",
				"ds_out_master=ds_out_master",
				"",
				"",
				"", 
				true, 
				false,
				true);
		}
		gfn_showAlert("CI30001", "기안이 완료되었습니다.");
		
		ufn_resetAll();															//모든 정보를 리셋한다.
		ufn_getOfferInfo();														//견적정보를 가져온다.
		ufn_setPermissions();
	}
	else																		//상신 실패시 작업
	{
		gfn_showAlert("CW10025", "기안이 취소되었습니다.");
	}
}


/********************************************************************************
* 기      능   : 리셋 85
********************************************************************************/
function fn_reset() 
{
	if(gfn_showConfirm("CW10025", "입력을 취소하고 모든 정보를 초기화 하시겠습니까?"))
	{
		ufn_resetAll();															//모든 정보를 리셋한다.
		ufn_getOfferInfo();														//견적정보를 가져온다.
		ufn_setPermissions();
	}
}

/********************************************************************************
* 기      능   : 삭제 
********************************************************************************/
function fn_delete() 
{

	//해당 견적에 대한 수주변경/취소정보를 삭제(실제로는 Update)한다.
	//삭제 가능 조건 정의 필요

	if (!gfn_showConfirm("CI00015", "수주변경/취소정보")) 
	{
		return;
	}
	
	ds_out_master.SetColumn(0, "ADJCOST", "0");
	ds_out_master.SetColumn(0, "CRSN", "");
	ds_out_master.SetColumn(0, "CPRD", "");
	ds_out_master.SetColumn(0, "CHGBN", "0");									//청구전송상태로 되돌림
	
	DEBUG("fn_delete", ds_out_master.SaveXml());
	
	tit_clearActionInfo();	
	
	tit_addMultiActionInfo("cs01:CS0101008D_U1");								//ZCST001에 마스터 데이터를 업데이트한다.

	tit_callService(															//ZMMT031에 저장할 정보는 없나?	
        ""
        , ""
        , "ds_out_master=ds_out_master ds_cond=ds_cond"
        , ""
        , ""
        , "fn_afterDeleteAll");	
}

/********************************************************************************
* 기      능   : Delete Callback
********************************************************************************/
function fn_afterDeleteAll(errCode, errMsg)
{
	if ( errCode!= 0 ) 
	{
		gfn_showMsg("CE00001");
	} 
	else 
	{
		gfn_showAlert("CI00004");		
		fn_close();
	}
}


//=========================================================================================
// [ PART 4]
// Callback 함수 정의 : callback 함수명은 메인 함수의 fn_xxxx() 에서 xxxx 부분은 fn_afterXXXX()
// 형태가 되도록 작성 
//=========================================================================================




//=========================================================================================
// [ PART 5 ]
// Detail Process Event 정의 ( User Define function )
// 사용자 정의 함수는 ufn_xxxx() 형태로 작성 
//=========================================================================================

/********************************************************************************
* 기      능   : 화면상의 조건들을 초기화 한다
********************************************************************************/
function ufn_initParameters()
{

}

/********************************************************************************
* 기      능   : 모든 정보를 리셋(ds_cond는 초기화 및 재조회를 위해 남겨둠)
********************************************************************************/
function ufn_resetAll()
{
	ds_out_master.clearData();													//ds_out_master를 삭제한다. 
	ds_out_master.addRow();														//ds_out_master에 새 Row를 Insert한다.
	ds_pjt_det.clearData();														//프로젝트 상세정보를 삭제한다.
	
	//Mask Edit Box를 모두 Clear한다.
	var comps = Components["MaskEdit"];
	for(iCnt=0;iCnt < comps.count();iCnt++)
	{
		comps[iCnt].value = "";
	}	
}

/********************************************************************************
* 기      능   : Null여부 확인 gfn_isNull을 Status에서 Alert방식으로 바꿈(팝업이므로 메세지창이 없음)
********************************************************************************/
function ufn_isNull(chkObj, isShowMsg, lbTxt, focusObj) {
	if( length( chkObj.value) > 0 ) {
		return false;
	}

	if( isShowMsg ) {
		// 메시지 처리
		if( length( lbTxt) == 0 ) {
			// 필수 입력항목 입니다. 확인하여 주십시오.
			gfn_showAlert("CW00002");
		} else {
			// lbTxt + " 항목에 값이 누락되어 있습니다. 확인하여 주십시오."
			gfn_showAlert("CW00001", lbTxt);
		}
	}

	if( focusObj == null ) {
		focusObj = chkObj;
	}

	focusObj.setFocus();
	return true;
}

/********************************************************************************
* 기      능   : 선택된 견적 정보를 Retrieve (추가/수정/삭제 시)
********************************************************************************/
function ufn_getOfferInfo()
{
	ufn_resetAll();																//현재 견적사항을 리셋한다.
	
	fn_createWait("",this);														//처리중 윈도우 create
	
	tit_clearActionInfo();	
	
	tit_addSearchActionInfo("cs01:CS0101008B_S1", true);						//프로젝트 상세정보(호기명/호기id)
	tit_addSearchActionInfo("cs01:CS0101008B_S4", true);						//견적 마스터 정보
	//tit_addSearchActionInfo("cs01:CS0101008B_S6", true);  						//차수 정보

	tit_callService(	
        ""
        , ""
        , "ds_cond=ds_cond"
        , "ds_pjt_det=ds_pjt_det ds_out_master=ds_out_master"
        , ""
        , "fn_afterOfferInfoQuery"
        , true
        , true
        , true);  // 2018.07.18  sync로 변경
}

/********************************************************************************
* 기      능   : 선택된 견적정보 Retrieve Callback
********************************************************************************/
function fn_afterOfferInfoQuery()
{
	fn_destroyWait();															//처리중 윈도우 destroy
	
	var workStage;																//결재상태 
	var docNo3, docNo4, docNo5;													//재청구문서번호, 수주변경문서번호, 수주취소문서번호
	var docStat3, docStat4, docStat5;											//재청구상태, 수주변경상태, 수주취소상태
	
	workStage = ds_out_master.GetColumn(0, "CHGBN");							//결재상태를 가져온다.
	docNo3 = ds_out_master.GetColumn(0, "DOC3");
	docNo4 = ds_out_master.GetColumn(0, "DOC4");
	docNo5 = ds_out_master.GetColumn(0, "DOC5");
	docStat3 = ds_out_master.GetColumn(0, "DOC3STAT");
	docStat4 = ds_out_master.GetColumn(0, "DOC4STAT");
	docStat5 = ds_out_master.GetColumn(0, "DOC5STAT");
	
	//청구전송이 완료된 후의 견적만 수주변경/취소가 가능하다. 
	if(!isDigit(workStage))
	{
		gfn_showAlert("CW10025", "견적/수주승인이 완료되지 않아 수주변경/취소 불가합니다.");
		fn_close();
	}
	
	//자재승인완료 후 SAP전송이 완료되어야 수주변경/취소가 가능하다.
	if(ds_out_master.GetColumn(0,"PS_PSPID").length <= 0)
	{
		gfn_showAlert("CW10025", "청구승인 및 전송이 완료되지 않아 수주변경/취소 불가합니다.");
		fn_close();
	}	
	
	//현재 재청구가 진행중일 경우 수주변경/취소가 불가능하다. 반려시에는 재견적.
	// 현재 재청구가 진행중이거나 완료되지 않았을때는 수주변경/취소가 불가능하다. 2018.12.26 최선경 SW 요청. Han J.H
	//if(workStage == "3" && docStat3 != "6")
	if(workStage == "3") {
		if(!(docStat3 == "2" || docStat3 == "5" || docStat3 == "6")) {
			gfn_showAlert("CW10025", "재청구 결재가 진행중이거나 기안반송 및 수신반송, 수신결재 처리가 완료되지 않아 수주변경/취소 불가합니다.");
			fn_close();
		}
	}
	
	/*if(workStage == "3" && docStat3 == "5"
	{
		//gfn_showAlert("CW10025", "재청구 결재가 진행중이거나 청구반려 이력이 존재하여 수주변경/취소 불가합니다.");
		gfn_showAlert("CW10025", "재청구 결재가 진행중이거나 수신반송 및 수신결재 처리가 완료되지 않아 수주변경/취소 불가합니다.");
		fn_close();
	}*/	
	
	//수주취소가 완료된 경우 수주변경/취소가 불가능하다.
	if(workStage == "2" && docStat5 == "6")
	{
		gfn_showAlert("CW10025", "수주취소가 완료되어 수주변경/취소 불가합니다.");
		//fn_close();
	}
	
	//인건비 지급 완료여부를 확인한다(지급완료시 수주변경/취소불가)
	if(ds_out_master.GetColumn(0,"PAYSTAT") == "N") //인건비 지급여부 제외로직 적용 2016.03.30 YAR
	{
		if (ds_out_master.GetColumn(0,"LABSTAT") == "A" 
			|| ds_out_master.GetColumn(0,"LABSTAT") == "B" 
			|| ds_out_master.GetColumn(0,"LABSTAT") == "C")
		{
			gfn_showAlert("CW10025", ds_out_master.GetColumn(0,"PS_PSPID")+
						" 인건비 지급 완료되어 수주변경/취소 불가합니다.");
			//fn_close();
		}
	}
	//만약 시스템 신규 제작 이전(테스트데이터상 2014년 10월 말까지) 데이터이면, 비어있는 컬럼들을 채운다.
	if(ds_out_master.GetColumn(0, "UPN") == "")
	{
		//마스터 리스트의 값을 채운다.
		ds_out_master.SetColumn(0, "KUNNR",ds_pjt_det.GetColumn(0, "KUNNR"));					//고객번호
		ds_out_master.SetColumn(0, "SPT",ds_pjt_det.GetColumn(0, "SPT"));						//현장명
		ds_out_master.SetColumn(0, "CST",ds_pjt_det.GetColumn(0, "CST"));						//거래선
		ds_out_master.SetColumn(0, "CSTNM",ds_pjt_det.GetColumn(0, "CSTNM"));					//거래선명
		ds_out_master.SetColumn(0, "SPART", ds_pjt_det.GetColumn(0, "SPART"));					//제품군
		ds_out_master.SetColumn(0, "SPARTNM",ds_pjt_det.GetColumn(0, "SPARTNM"));				//제품군명
		ds_out_master.SetColumn(0, "VKGRP", ds_pjt_det.GetColumn(0, "VKGRP"));					//팀
		ds_out_master.SetColumn(0, "VKGRPNM", ds_pjt_det.GetColumn(0, "VKGRPNM"));				//팀명
		ds_out_master.SetColumn(0, "VKBUR", ds_pjt_det.GetColumn(0, "VKBUR"));					//사업장
		ds_out_master.SetColumn(0, "VKBURNM", ds_pjt_det.GetColumn(0, "VKBURNM"));				//사업장명
		ds_out_master.SetColumn(0, "BSU", ds_pjt_det.GetColumn(0, "BSU"));						//업체코드
		ds_out_master.SetColumn(0, "BSUNM", ds_pjt_det.GetColumn(0, "BSUNM"));					//업체명
		ds_out_master.SetColumn(0, "PNAME", ds_pjt_det.GetColumn(0, "PNAME"));					//담당자명
		ds_out_master.SetColumn(0, "LIFNR", ds_pjt_det.GetColumn(0, "LIFNR"));					//공급업체
		ds_out_master.SetColumn(0, "BUSSI",  substr(ds_pjt_det.GetColumn(0, "SPART"), 0, 1));	//사업부구분(1:승강기/2:주차)
		ds_out_master.SetColumn(0, "SH_ADDR", ds_pjt_det.GetColumn(0, "ADDR"));					//납품처주소
		ds_out_master.SetColumn(0, "UPN", ds_pjt_det.GetColumn(0, "UPN"));						//프로젝트번호
		ds_out_master.SetColumn(0, "VKBUR", ds_pjt_det.GetColumn(0, "VKBUR"));					//사업장
		ds_out_master.SetColumn(0, "VKBURNM", ds_pjt_det.GetColumn(0, "VKBURNM"));				//사업장명
		ds_out_master.SetColumn(0, "RATE", ds_pjt_det.GetColumn(0, "RATE"));					//임율	
	}
	
	//전자결재 상태를 Update한다.
	switch (workStage)
	{
		case "":																//저장, 견적승인, 수주승인 단계
			if(ds_out_master.GetColumn(0, "DOC2STATNM").length > 0)
			{
				ed_wf_stat.Text = ds_out_master.GetColumn(0, "DOC2STATNM");
			}
			else if(ds_out_master.GetColumn(0, "DOC1STATNM").length > 0)
			{
				ed_wf_stat.Text = ds_out_master.GetColumn(0, "DOC1STATNM");
			}
			else
			{
				ed_wf_stat.Text = "견적 저장 완료";
			}
			break;
		case "0": 																//청구등록 단계
			if(ds_out_master.GetColumn(0, "PS_PSPID").length > 0)				//SAP전송 후 원 WBS가 입력된 경우 전송완료로 표시
			{
				ed_wf_stat.Text = "청구 전송 완료";
			}
			else
			{
				ed_wf_stat.Text = "청구 등록 완료";
			}
			break;
		case "1":																//수주변경 단계
			ed_wf_stat.Text =  ds_out_master.GetColumn(0, "DOC4STATNM");
			break;
		case "2":																//수주취소 단계
			ed_wf_stat.Text =  ds_out_master.GetColumn(0, "DOC5STATNM");
			break;
		case "3":																//재청구 단계
			if(ds_out_master.GetColumn(0, "DOC3STATNM").length > 0)
			{
				ed_wf_stat.Text =  ds_out_master.GetColumn(0, "DOC3STATNM");
			}
			else
			{
				ed_wf_stat.Text = "재청구 저장완료";
			}			
			break;
	}
	
	ufn_setPermissions();														//권한을 설정한다.
	ufn_setRegulation();														//전결규정을 표시한다.

	if(toNumber(ds_out_master.GetColumn(0, "ADJCOST")) <> 0)						//변동금액이 0이 아니면, 이전에 변동이 있었던 것이므로, 해당 변동 사항을 반영한다.
	{
		ufn_calcCostValues();
	}
}

/********************************************************************************
* 기      능   : 비용 및 원가 내역을 산정
********************************************************************************/
function ufn_calcCostValues(callerId)
{ 
	var docNo4, docNo5, workStage;

	docNo4 = ds_out_master.GetColumn(0, "DOC4");								//수주변경결재문서번호
	docNo5 = ds_out_master.GetColumn(0, "DOC5");								//수주취소결재문서번호

	workStage = ds_out_master.GetColumn(0, "CHGBN");							//견적 현재 결재 상태
	
/*	if((docNo4.length > 0 && workStage == "1") || 
		(docNo5.length > 0 && workStage == "2"))								//저장된 데이터면
	{
		ed_adjcost.Enable = false;
	}
	else
	{
*/	
		if(toNumber(rd_dat.Value) == 2)
		{
			ed_adjcost.value = 0;
			ed_adjcost.Enable = false;	
		}
		else
		{
			ed_adJcost.Enable = true;
		}
//	}

	var sum_ofr = toNumber(ds_out_master.GetColumn(0, "SUM_OFR"));
	var adjCost = toNumber(ed_adjcost.Value);
	
	//변경 수주금액
	var sum_ofr_chg = sum_ofr + adjCost;
	ed_sum_ofr_chg.Value = sum_ofr_chg;

	//변동율
	ed_sum_ofr_rate.Value = round((sum_ofr_chg - sum_ofr) / sum_ofr * 100, 1);

	//수주금액
	ed_so2.Value = sum_ofr_chg;
	ed_so_diff.Value = sum_ofr_chg - sum_ofr;
	
	//재료비
	ed_hu2.Value = toNumber(ed_his_ucost.value);
	ed_hu_diff.value = 0;
	
	//인건비
	ed_hl2.Value = toNumber(ed_his_lcost.value);
	ed_hl_diff.value = toNumber(ed_hl2.Value) - toNumber(ed_his_lcost.value);
	
	//일반직노무비
	ed_hla2.value = round(toNumber(ed_hl2.Value) * 0.03, 0);
	ed_hla_diff.value = toNumber(ed_hla2.Value) - toNumber(ed_his_labor.value);
	
	//일식외주
	ed_ho2.Value = 0;
	ed_ho_diff.value = 0;
	
	//운반비
	ed_hlo2.value = ed_his_log.Value;
	ed_hlo_diff.value = 0;
	
	//직접비 계 
	ed_hd2.value = toNumber(ed_hu2.value) + toNumber(ed_hl2.Value) + toNumber(ed_hla2.value) + toNumber(ed_ho2.Value) + toNumber(ed_hlo2.Value);
	ed_hd_diff.Value = toNumber(ed_hd2.Value) - toNumber(ed_his_dirsum.value);
	
	//간접비
	ed_hi2.Value = round(toNumber(ed_hd2.Value) * 0.105, 0);
	ed_hi_diff.Value = toNumber(ed_hi2.Value) - toNumber(ed_his_indsum.value);
	
	//총원가
	ed_tc2.Value = toNumber(ed_hd2.Value) + toNumber(ed_hi2.Value);
	ed_tc_diff.Value = toNumber(ed_tc2.Value) - toNumber(ed_his_totcost.Value);
	
	//원가율
	ed_hr2.Value = round((toNumber(ed_tc2.Value) / sum_ofr_chg) * 100, 1);
	ed_hr_diff.Value = toNumber(ed_hr2.Value) - toNumber(ed_his_rate.Value);
	
	//----------------------------------------------------------------------
	//전결규정을 설정한다.
	ufn_setRegulation();
}


/********************************************************************************
* 기      능   : 전결규정을 설정한다.
change log :  수주변경 시 전결규정  >>>  변동 금액 기준 20160418 이하림 ( 최인식 과장 요청 )
change log :  전결규정 변경 201610
change log :  전결규정 변경 201703
********************************************************************************/
function ufn_setRegulation()
{
	var directFlag = false;														//직영협력사 구분
	
	sum_ofr = toNumber(ed_sum_ofr.Value);										//견적가
	adjCost = Abs(toNumber(ed_adjcost.Value));										//변동금액	

	//DEBUG("ufn_setRegulation", "sum_ofr is " + sum_ofr + ", directFlag is " + directFlag);

	if(rd_dat.Value == "1")														//수주변경시
	{
		/* 2020.08.03 변경전
		if(toNumber(adjCost) >= 50000000 )	//5천만원 이상
		{
			ed_reg.Text = "부문장 전결";
			ed_reg_cfo.Text = "CFO 확인";
		}
		else if(toNumber(adjCost) >= 10000000 && toNumber(adjCost) < 50000000)	//1천만원 이상 5천만원 미만 
		{
			ed_reg.Text = "담당 전결";
		}
		else if(toNumber(adjCost) >= 5000000 && toNumber(adjCost) < 10000000)	//500 만원 이상 1천만원 미만 
		{
			ed_reg.Text = "팀장 전결";
		}
		else																	//500원 미만
		{
			ed_reg.Text = "지사장 전결";
		}
		*/
		//====================================변경 후 2020.08.03==================================================================
		if(toNumber(adjCost) >= 50000000 )	                                    //5천만원 이상
		{
			ed_reg.Text = "본부장 전결";
			ed_reg_cfo.Text = "재경본부장 확인";
		}
		else if(toNumber(adjCost) >= 10000000 && toNumber(adjCost) < 50000000)	//1천만원 이상 5천만원 미만 
		{
			ed_reg.Text = "담당 전결";
		}
		else if(toNumber(adjCost) < 10000000)	                                //1천만원 미만 
		{
			ed_reg.Text = "지사장(팀장) 전결";
		}
		//========================================================================================================================
	}
	else if(rd_dat.Value == "2")												//수주취소시
	{
		/* 2020.08.03 변경전
		if(toNumber(sum_ofr) >= 30000000 )	//3천만원 이상  
		{
			ed_reg.Text = "부문장 전결";
			ed_reg_cfo.Text = "CFO 확인";
		}
		else if(toNumber(sum_ofr) >= 10000000 && toNumber(sum_ofr) < 30000000)	//1천만 이상 3천만 미만
		{
			ed_reg.Text = "담당 전결";
		}
		else if(toNumber(sum_ofr) >= 1000000 && toNumber(sum_ofr) < 10000000)	//1백만 이상 1천만 미만
		{
			ed_reg.Text = "팀장 전결";
		}
		else																	//1백만원 미만
		{
			ed_reg.Text = "지사장 전결";
		}
		*/
		//====================================변경 후 2020.08.03==================================================================
		if(toNumber(sum_ofr) >= 30000000 )	                                    //3천만원 이상  
		{
			ed_reg.Text = "본부장 전결";
			ed_reg_cfo.Text = "재경본부장 확인";
		}
		else if(toNumber(sum_ofr) >= 10000000 && toNumber(sum_ofr) < 30000000)	//1천만 이상 3천만 미만
		{
			ed_reg.Text = "담당 전결";
		}
		else if(toNumber(sum_ofr) < 10000000)	                                //1천만 미만
		{
			ed_reg.Text = "지사장(팀장) 전결";
		}		
		//========================================================================================================================
	}
	else
	{
		ed_reg.Text = "(전결규정)";
	}
	
	//전결규정
	ed_reg.Enable = true;
	ed_reg.color = "gray";
	ed_reg.bkColor = "#E9E9E9";
	ed_reg.readOnly = true;
	ed_reg.ToolTipText = "1. 계약 변경시 5천만원 이상일 경우, 재경본부장 확인\n" +
						 "2. 계약 취소시 3천만원 이상일 경우, 재경본부장 확인\n" +
						 "3. 계약 취소/해지(해제) 후 처리가 계약내용과 상이할 경우(위약금 미청구 등),\n" + 
						 "   계약금액과 상관없이 재경본부장 확인\n";
	
}

/********************************************************************************
* 기      능   : 환경변수/전역변수 등을 출력한다.
********************************************************************************/
function SHOW_ENV()
{
	var strDate = GetDate();
	strDate = Mid(strDate,0,4) + "/" + Mid(strDate,4,2) + "/" + Mid(strDate,6,2) + " " + 
	          Mid(strDate,8,2) + ":" + Mid(strDate,10,2) + ":" + Mid(strDate,12,2);

	Trace("-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= Startup  Information =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-");
	Trace("Program ID : " + this.title);
	Trace("Start Date & Time : " + strDate);
	Trace("-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= Global Variables =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-");
	Trace("G_AREA_CODE:사무소 코드/지역 코드) is [" + G_AREA_CODE + "]");
	Trace("G_AREA_CODE_B:영업지사 코드/영업지역 코드) is [" + G_AREA_CODE_B + "]");
	Trace("G_AREA_CODE_E:설치사무소 코드/설치지역 코드) is [" + G_AREA_CODE_E + "]");
	Trace("G_AREA_CODE_R:보수사무소 코드/보수지역 코드) is [" + G_AREA_CODE_R + "]");
	Trace("G_AREA_NAME:지역명/업체지역명) is [" + G_AREA_NAME + "]");
	Trace("G_CURR_DATE:현재시간/현재일자) is [" + G_CURR_DATE + "]");
	Trace("G_DPT1:부서코드/부서코드) is [" + G_DPT1 + "]");
	Trace("G_EMAIL:전자우편 주소/EMAIL) is [" + G_EMAIL + "]");
	Trace("G_EXPR_DATE:비밀번호 만료 일자 /만료일자) is [" + G_EXPR_DATE + "]");
	Trace("G_LANG:사용 언어/사용자 LANG(ko-한국, zh-중국, en-영문) ) is [" + G_LANG + "]");
	Trace("G_LGORT:저장위치/업체-저장위치) is [" + G_LGORT + "]");
	Trace("G_LOGIN_TIME:로그인 시간/현재시간(?)) is [" + G_LOGIN_TIME + "]");
	Trace("G_LOGOUT:로그아웃 구분(1:정상, 0:오류)/) is [" + G_LOGOUT + "]");
	Trace("G_MANDT:Mandt 설정 /SAP CLIENT) is [" + G_MANDT + "]");
	Trace("G_ORG_USER_INFO:원 사용자 ID/사용자 변경시 원 정보 저장) is [" + G_ORG_USER_INFO + "]");
	Trace("G_ORG_VEND_CODE:사원 변경시 사용/업체코드2(현대 ELV) 사용자인 경우)) is [" + G_ORG_VEND_CODE + "]");
	Trace("G_ORG_VEND_CODE_B:사원 변경시 사용/업체코드2(현대 ELV) 사용자인 경우)) is [" + G_ORG_VEND_CODE_B + "]");
	Trace("G_ORG_VEND_CODE_E:사원 변경시 사용/업체코드2(현대 ELV) 사용자인 경우)) is [" + G_ORG_VEND_CODE_E + "]");
	Trace("G_ORG_VEND_CODE_M:사원 변경시 사용/업체코드2(현대 ELV) 사용자인 경우)) is [" + G_ORG_VEND_CODE_M + "]");
	Trace("G_ORG_VEND_CODE_R:사원 변경시 사용/업체코드2(현대 ELV) 사용자인 경우)) is [" + G_ORG_VEND_CODE_R + "]");
	Trace("G_SAP_USER_ID:/) is [" + G_SAP_USER_ID + "]");
	Trace("G_SAP_USER_NAME:/) is [" + G_SAP_USER_NAME + "]");
	Trace("G_SAP_USER_PM_B:PM(영업)/PM(영업)) is [" + G_SAP_USER_PM_B + "]");
	Trace("G_SAP_USER_PM_R:PM(보수)/) is [" + G_SAP_USER_PM_R + "]");
	Trace("G_SAP_USER_PMNM_B:PM명(영업)/PM명(영업)) is [" + G_SAP_USER_PMNM_B + "]");
	Trace("G_SAP_USER_PMNM_R:PM명(보수)/) is [" + G_SAP_USER_PMNM_R + "]");
	Trace("G_SAP_USER_VBCD:SAP 부서코드/SAP용 부서코드) is [" + G_SAP_USER_VBCD + "]");
	Trace("G_SAP_USER_VBNM:SAP 부서명/SAP용 부서명) is [" + G_SAP_USER_VBNM + "]");
	Trace("G_SAP_USER_VGCD:SAP 팀코드/SAP용 팀코드) is [" + G_SAP_USER_VGCD + "]");
	Trace("G_SAP_USER_VGNM:SAP 팀명  /SAP용 팀명) is [" + G_SAP_USER_VGNM + "]");
	Trace("G_SERVER_URL:서버경로/) is [" + G_SERVER_URL + "]");
	Trace("G_SESSION_ID:세션ID /세션ID) is [" + G_SESSION_ID + "]");
	Trace("G_SYSTEM:시스템 구분 /시스템 구분(D-개발, Q-품질, P-운영)) is [" + G_SYSTEM + "]");
	Trace("G_USERMBPN:H.P/) is [" + G_USERMBPN + "]");
	Trace("G_USERTELE:전화번호/) is [" + G_USERTELE + "]");
	Trace("G_USER_GROUP:권한/사용자 그룹) is [" + G_USER_GROUP + "]");
	Trace("G_USER_GROUP_B:영업권한 /사용자 그룹) is [" + G_USER_GROUP_B + "]");
	Trace("G_USER_GROUP_E:설치권한/사용자 그룹) is [" + G_USER_GROUP_E + "]");
	Trace("G_USER_GROUP_M:자재권한/사용자 그룹) is [" + G_USER_GROUP_M + "]");
	Trace("G_USER_GROUP_R:보수권한/사용자 그룹) is [" + G_USER_GROUP_R + "]");
	Trace("G_USER_ID:사용자 id/사용자 ID) is [" + G_USER_ID + "]");
	Trace("G_USER_NAME:사용자명/사용자 명) is [" + G_USER_NAME + "]");
	Trace("G_VEND_CODE:업체코드/업체코드) is [" + G_VEND_CODE + "]");
	Trace("G_VEND_CODE_B:업체코드(영업)/업체코드(영업)) is [" + G_VEND_CODE_B + "]");
	Trace("G_VEND_CODE_E:업체코드(설치)/업체코드(설치)) is [" + G_VEND_CODE_E + "]");
	Trace("G_VEND_CODE_M:업체코드(자재)/업체코드(자재)) is [" + G_VEND_CODE_M + "]");
	Trace("G_VEND_CODE_R:업체코드(보수)/업체코드(보수)) is [" + G_VEND_CODE_R + "]");
	Trace("G_VEND_NAME:업체명/업체명) is [" + G_VEND_NAME + "]");
	Trace("G_VEND_WGBN:업체구분/업체구분(A:설치협력사, B:보수협력사, C:국내대리점, D:자재협력사, E:해외대리점)) is [" + G_VEND_WGBN + "]");
	Trace("G_WEBGUI_URL:WEB-GUI URL 정보/WEB GUI 정보) is [" + G_WEBGUI_URL + "]");
	Trace("-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-");
}

/********************************************************************************
* 기      능   : 디버그 문자열을 trace로 출력한다.
********************************************************************************/
function DEBUG(srcFunc, outStr)
{
	var outputString = "";

    outputString = "DEBUG " + 
				  this.title + " " + 
				  substr(getDate(), 8, 2) + ":" + 
				  substr(getDate(), 10, 2) + ":" + 
				  substr(getDate(), 12, 2) + ">";
	
	if(DEBUG_FLAG)
	{
		if(outStr.length == 0)
		{	
			outputString += srcFunc;
		}
		else
		{
			outputString += srcFunc + "() - " + outStr;
		}
	
		trace(outputString);
	}
}

/********************************************************************************
* 기      능   : 원가관련 항목을 감춘다.
********************************************************************************/
function ufn_hideUnitCostComponents()
{
	var comps = Components;

	for(iCnt=0;iCnt < comps.count();iCnt++)
	{
		if(indexOf(comps[iCnt].ID, "st_adm") >= 0 || 
				indexOf(comps[iCnt].ID, "ed_h") >= 0 || 
				indexOf(comps[iCnt].ID, "ed_so") >= 0 || 
				indexOf(comps[iCnt].ID, "ed_tc") >= 0)
		{
			comps[iCnt].visible = false;
		}
	} 	
}


/********************************************************************************
* 기      능   : enable 상태인 컴포넌트의 이름을 저장한다.
********************************************************************************/
function ufn_saveEnabledComponents()
{
	var comps = Components;														//form의 component collection 
	var compCnt = 0;															//갯수 카운트
	
	//컴포넌트 수 카운트
	for(iCnt=0;iCnt < comps.count();iCnt++)
	{
		if(comps[iCnt].GetType() == "MaskEdit" 
			|| comps[iCnt].GetType() == "Combo" 
			|| comps[iCnt].GetType() == "Checkbox"
			|| comps[iCnt].GetType() == "Edit" 
			|| comps[iCnt].GetType() == "Calendar" 
			|| comps[iCnt].GetType() == "TextArea"
			|| comps[iCnt].GetType() == "Radio")
		{
			if(comps[iCnt].Enable == true)
			{
				compCnt++;
			}
		}
	} 
	
	componentStore = Array(compCnt);
	
	compCnt = 0;
	
	//컴포넌트명 저장
	for(iCnt=0;iCnt < comps.count();iCnt++)
	{
		
		if(comps[iCnt].GetType() == "MaskEdit" 
				|| comps[iCnt].GetType() == "Combo" 
				|| comps[iCnt].GetType() == "Checkbox"
				|| comps[iCnt].GetType() == "Edit" 
				|| comps[iCnt].GetType() == "Calendar" 
				|| comps[iCnt].GetType() == "TextArea"
				|| comps[iCnt].GetType() == "Radio")
		{
			if(comps[iCnt].Enable == true)
			{
				//DEBUG("ufn_saveEnabledComponents", comps[iCnt].ID + ":" + comps[iCnt].GetType());
				componentStore[compCnt] = comps[iCnt].ID;
				compCnt++;
			}
		}
	} 
	return;
}

/********************************************************************************
* 기      능   : 초기에 Enable상태였던 컴포넌트들을 Restore한다.
********************************************************************************/
function ufn_restoreEnabledComponents()
{
	for(var iCnt = 0;iCnt < length(componentStore);iCnt++)						//컴포넌트 Enable상태 Restore	
	{
		object(componentStore[iCnt]).Enable = true;
	}

	return;
}

/********************************************************************************
* 기      능   : 모든 입력 및 클릭이 가능한 컴포넌트를 Disable한다.
********************************************************************************/
function ufn_disableAllInput()
{
	ufn_enableGroup("MaskEdit", false);
	ufn_enableGroup("Combo", false);
	ufn_enableGroup("Checkbox", false);
	ufn_enableGroup("Edit", false);
	ufn_enableGroup("Calendar", false);
	ufn_enableGroup("TextArea", false);
	ufn_enableGroup("Radio", false);
	ufn_enableCommBtnGroup(false);
	ufn_setGroupVisiblity("Button", false);
}

/********************************************************************************
* 기      능   : 공통버튼을 모두 Enable/Disable한다.
********************************************************************************/
function ufn_enableCommBtnGroup(setFlag)
{
	comps = div_btn.Components["Button"];
	
	if(!IsValidObject(comps)) return;
	
	for(iCnt=0;iCnt < comps.count();iCnt++)
	{			
		comps[iCnt].Enable = setFlag;
	}
	return;
}

/********************************************************************************
* 기      능   : 공통버튼을 Enable/Disable 한다.
********************************************************************************/
function ufn_enableCommBtn(btnStr, setFlag)
{
	object("div_btn.btn_" + btnStr).Enable = setFlag;
	return;
}

/********************************************************************************
* 기      능   : 특정 컴포넌트 그룹을 Enable/Disable 한다.
********************************************************************************/
function ufn_enableGroup(componentGroup, setFlag)
{
	var comps;
	if(componentGroup == "")
	{
		comps = Components;
	}
	else
	{
		comps = Components[componentGroup];	
	}
	
	if(!IsValidObject(comps)) return;

	for(iCnt=0;iCnt < comps.count();iCnt++)
	{
		comps[iCnt].Enable = setFlag;
	} 
	
	return;
}

/********************************************************************************
* 기      능   : 특정 컴포넌트를 Enable/Disable 한다.
********************************************************************************/
function ufn_enableComponent(componentName, setFlag)
{
	if(IsValidObject(object(componentName)))
	{
		object(componentName).Enable = setFlag;	
	}
	else
	{	
		object("div_btn.btn_" + componentName).Enable = setFlag;
	}
	
	return;
}

/********************************************************************************
* 기      능   : 특정 컴포넌트 그룹을 show/hide 한다.
********************************************************************************/
function ufn_setGroupVisiblity(componentGroup, setFlag)
{
	var comps;
	if(componentGroup == "")
	{
		comps = Components;
	}
	else
	{
		comps = Components[componentGroup];	
	}
	
	if(!IsValidObject(comps)) return;

	for(iCnt=0;iCnt < comps.count();iCnt++)
	{
		comps[iCnt].Visible = setFlag;
	}

	return;
}


/********************************************************************************
* 기      능   : Object를 보이게 하거나 감춘다.
********************************************************************************/
function ufn_setObjectVisibility(btnStr, hideFlag)
{
	if(hideFlag == "hide" || hideFlag == false)
	{
		if(IsValidObject(object(btnStr)))
		{
			object(btnStr).visible = false;	
		}
		else
		{	
			object("div_btn.btn_" + btnStr).enable = false;
		}
	}
	else
	{
		if(IsValidObject(object(btnStr)))
		{
			object(btnStr).visible = true;	
		}
		else
		{	
			object("div_btn.btn_" + btnStr).enable = true;
		}
	}
}


/********************************************************************************
* 기      능   : 공통버튼을 보이게 하거나 감춘다.
********************************************************************************/
function ufn_setCommBtnVisibility(btnStr, hideFlag)
{
	if(hideFlag == "hide" || hideFlag == false)
	{
		object("div_btn.btn_" + btnStr).visible = false;
	}
	else
	{
		object("div_btn.btn_" + btnStr).visible = true;
	}
}


/********************************************************************************
* 기      능   : 이용권한을 설정한다.
********************************************************************************/
function ufn_setPermissions()
{
//alert("xxxxxxxxx");
	var userGroup = gfn_getUserGroup();											//사용자 권한그룹
	var appStage = -1;															//전자결재 단계
	var docNo1, docNo2, docNo3, docNo4, docNo5;									//전자결재 문서번호(견적(1), 수주(2), 재청구(3), 수주변경(4), 수주취소(5))	
	var docNo1Stat, docNo2Stat, docNo3Stat, docNo4Stat, docNo5Stat;				//전자결재 문서상태(견적(1), 수주(2), 재청구(3), 수주변경(4), 수주취소(5))	
	var qtUserID, logUserID;													//견적 사용자 ID, 로그인 사용자 ID;
	var workStage;																//수주단계
	var currentUser, currentFlag, directFlag;									//현재 결재자, 사용자=차순위결재자일경우, 사용자 직영플래그
	
	qtUserID = ds_out_master.GetColumn(0, "CRNAM");								//견적 작성 사용자
	logUserID = G_USER_ID;														//로그인 사용자
	selfFlag = false;
	if(logUserID == qtUserID) 													//본인여부
	{
		selfFlag = true;
	}

	docNo1 = ds_out_master.GetColumn(0, "DOC1");								//견적결재문서번호
	docNo2 = ds_out_master.GetColumn(0, "DOC2");								//수주결재문서번호
	docNo3 = ds_out_master.GetColumn(0, "DOC3");								//재청구결재문서번호
	docNo4 = ds_out_master.GetColumn(0, "DOC4");								//수주변경결재문서번호
	docNo5 = ds_out_master.GetColumn(0, "DOC5");								//수주취소결재문서번호

	docNo1Stat = ds_out_master.GetColumn(0, "DOC1STAT");						//견적결재상태
	docNo2Stat = ds_out_master.GetColumn(0, "DOC2STAT");						//수주결재상태
	docNo3Stat = ds_out_master.GetColumn(0, "DOC3STAT");						//재청구결재상태
	docNo4Stat = ds_out_master.GetColumn(0, "DOC4STAT");						//수주변경결재상태
	docNo5Stat = ds_out_master.GetColumn(0, "DOC5STAT");						//수주취소결재상태

	workStage = ds_out_master.GetColumn(0, "CHGBN");							//견적 현재 결재 상태
	
	if(docNo4Stat == "1" || docNo4Stat == "4")									//수주변경 결재중이면(1:기안부서, 4:수신부서)
	{	
		if(substr(ds_out_master.GetColumn(0, "DOC4DEC"), 0, 1) == "H")
			currentUser = substr(ds_out_master.GetColumn(0, "DOC4DEC"), 1);		//차순위(현재) 결재자를 설정한다. 맨 앞의 'H' 제거
		else
			currentUser = ds_out_master.GetColumn(0, "DOC4DEC");
	}
	else if(docNo5Stat == "1" || docNo5Stat == "4")								//수주취소 결재중이면(1:기안부서, 4:수신부서)
	{	
		if(substr(ds_out_master.GetColumn(0, "DOC5DEC"), 0, 1) == "H")
			currentUser = substr(ds_out_master.GetColumn(0, "DOC5DEC"), 1);		//차순위(현재) 결재자를 설정한다. 맨 앞의 'H' 제거
		else
			currentUser = ds_out_master.GetColumn(0, "DOC5DEC");
	}
	else
	{
		currentUser = "";
	}
	
	DEBUG("ufn_setPermissions", "현재사용자:" + logUserID + "/견적사용자:" + qtUserID+"/차순위결재자:" + currentUser);

	currentFlag = false;
	if(logUserID == currentUser)												//로그인한 사용자가 차순위(현재)결재자인지 확인한다.
	{
		currentFlag = true;
	}
	
	if(logUserID.length == 7)													//해당 인원의 직영/협력사 구분을 가져온다.
		ds_cond.SetColumn(0, "USERID", "H" + logUserID);						//7자리일경우 H를 붙인다
	else
		ds_cond.SetColumn(0, "USERID", logUserID);								//8자리일경우 pass
	
	tit_clearActionInfo();														
	tit_addSingleActionInfo("cs01:CS0101008B_S9");								
	tit_callService("", "", "ds_cond=ds_cond", "ds_jhgbn=ds_jhgbn", "", "", true, false,true);

	directFlag = false;
	if(ds_jhgbn.GetColumn(0, "JHGBN") == "1")									//직영구분
	{
		directFlag = true;
	}
	
	DEBUG("ufn_setPermissions", "selfFlag:" + selfFlag + "/currentFlag:" + currentFlag + "/docNo4:" + docNo4 + "/workStage:" + workStage + "/directFlag:"+directFlag);
	
	ufn_restoreEnabledComponents();												//초기에 Enable 상태였던 모든 컴포넌트들을 Restore한다.
	
	ufn_enableCommBtnGroup(false);												//공통버튼을 모두 Disable 한다
	
	/*-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=- 수주변경 결재중 -=-=-=-=-=-=-=-=-=-=-=-=-=-=--=-=-=-=-*/	
	if(docNo4.length > 0 && workStage == "1")									//수주변경 결재가 시작된 건이면
	{		
		ufn_disableAllInput();													//모든 입력을 disable한다. 버튼은 감춘다. 
		ufn_enableCommBtn("close", true);										//닫기 enable
		switch(docNo4Stat)
		{
			case "1":															//기안부서결재중(결재자가 자기자신일 경우에만 결재 버튼을 enable 시켜준다)
			case "4":															//수신부서결재중(결재자가 자기자신일 경우에만 결재 버튼을 enable 시켜준다)
				switch(userGroup)
				{
					case "10":													//보수협력사	- 닫기
						if(currentFlag && directFlag) 
							ufn_enableCommBtn("decide", true);					//권한10직영인원 결재 enable
						if(currentFlag && directFlag) 
							ufn_enableCommBtn("sendback", true);				//권한10직영인원 반송 enable
						break;
					case "20":													//보수PM		- 결재, 반송, 닫기
					case "30":													//지방사무소	- 결재, 반송, 닫기
					case "40": 													//담당자		- 결재, 반송, 닫기
						if(currentFlag) ufn_enableCommBtn("decide", true);		//결재 enable
						if(currentFlag) ufn_enableCommBtn("sendback", true);	//반송 enable
						break;
					default:													//예외(?)
						break;
				}			
				break;
			case "3":															//기안부서결재완료				
				switch(userGroup)	
				{
					case "10":													//보수협력사 	
						//if(directFlag) ufn_enableCommBtn("draft", true);		//권한10직영인원 경우 기안가능
						break;
					case "20":													//보수PM 	
						break;	
					case "30":													//지방사무소 
						break;	
					case "40": 													//담당자 		
						ufn_enableCommBtn("draft", true);						//보수PM이상 기안가능
						break;
					default:													//예외(?)
						break;
				}
				break;
			case "2":															//결재반려(기안부서)
			case "5":															//결재반려(수신부서)
				if(selfFlag)													//자신의 건이면 재청구처리 가능토록 처리 2019.08.27 hjh
				{
					ufn_enableCommBtn("save", true);							//저장 enable
					break;
				}			
			case "6":															//결재완료 (기결재완료시 수주변경/취소 가능하도록 설정)
				if(selfFlag)													//자신의 건이면
				{
					ufn_restoreEnabledComponents();								//초기에 Enable 상태였던 모든 컴포넌트들을 Restore한다.
					ufn_enableCommBtnGroup(false);								//공통버튼을 모두 Disable 한다				
					ufn_enableCommBtn("save", true);							//저장 enable
					ufn_enableCommBtn("reset", true);							//리셋 enable
					ufn_enableCommBtn("close", true);							//닫기 enable
					//ufn_setObjectVisibility("rd_dat", true);					//수주변경/취소 선택 Radio enable
					//ufn_enableComponent("rd_dat", true);						//저장되지 않았으므로 수주변경/취소 선택 가능
				}
				ufn_enableCommBtn("print", true);
				break;	
			default:															//4, 5는 존재하지 않음(기안부서전결처리)
				break;
		}
	}
	/*-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=- 수주취소 결재중 -=-=-=-=-=-=-=-=-=-=-=-=-=-=--=-=-=-=-*/	
	else if(docNo5.length > 0 && workStage == "2")								//수주취소 결재가 시작된 건이면
	{		
		ufn_disableAllInput();													//모든 입력을 disable한다. 버튼은 감춘다. 
		ufn_enableCommBtn("close", true);										//닫기 enable
		switch(docNo5Stat)
		{
			case "1":															//기안부서결재중(결재자가 자기자신일 경우에만 결재 버튼을 enable 시켜준다)
			case "4":															//수신부서결재중(결재자가 자기자신일 경우에만 결재 버튼을 enable 시켜준다)
				switch(userGroup)
				{
					case "10":													//보수협력사	- 닫기, 견적복사
						if(currentFlag && directFlag) 
							ufn_enableCommBtn("decide", true);					//권한10직영인원 결재 enable
						if(currentFlag && directFlag) 
							ufn_enableCommBtn("sendback", true);				//권한10직영인원 반송 enable					
						break;
					case "20":													//보수PM		- 결재, 반송, 닫기
					case "30":													//지방사무소	- 결재, 반송, 닫기
					case "40": 													//담당자		- 결재, 반송, 닫기
						if(currentFlag) ufn_enableCommBtn("decide", true);		//결재 enable
						if(currentFlag) ufn_enableCommBtn("sendback", true);	//반송 enable
						break;
					default:													//예외(?)
						break;
				}			
				break;
			case "2":															//결재반려(기안부서)
			case "5":															//결재반려(수신부서)
				if(selfFlag)													//자신의 건이면
				{
					ufn_restoreEnabledComponents();								//초기에 Enable 상태였던 모든 컴포넌트들을 Restore한다.
					ufn_enableCommBtnGroup(false);								//공통버튼을 모두 Disable 한다				
					ufn_enableCommBtn("save", true);							//저장 enable
					ufn_enableCommBtn("reset", true);							//리셋 enable
					ufn_enableCommBtn("close", true);
					//ufn_setObjectVisibility("rd_dat", true);					//수주변경/취소 선택 Radio enable
					//ufn_enableComponent("rd_dat", true);						//저장되지 않았으므로 수주변경/취소 선택 가능
				}		
				break;				
			case "3":															//기안부서결재완료				
				switch(userGroup)	
				{
					case "10":													//보수협력사 
						//if(directFlag) ufn_enableCommBtn("draft", true);		//권한10직영인원 기안 버튼 enable(기안부서 기안)
						break;
					case "20":													//보수PM 		
						break;
					case "30":													//지방사무소 						
						break;
					case "40": 													//담당자 		
						ufn_enableCommBtn("draft", true);						//보수PM이상의 권한이면 기안 버튼 enable(기안부서 기안)
						break;
					default:													//예외(?)
						break;
				}
				break;
			case "6":															//수신부서결재완료(수주취소 완료. do nothing.)
				ufn_enableCommBtn("print", true);
				break;	
			default:															//4, 5는 존재하지 않음(기안부서전결처리)
				ufn_disableAllInput();											//모든 입력을 disable한다. 버튼은 감춘다. 
				ufn_enableCommBtn("close", true);								//닫기 enable			
				break;
		}
	}
	
	/*-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=- 수주변경/취소 작성/저장단계 -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-*/
	/*
	if(docNo4.length < 0 || (workStage != "1") || (workStage == "2" && (docNo5Stat == "2" || docNo5Stat == "5"))) ||
	   docNo5.length < 0 || (workStage != "2") || (workStage == "1" && (docNo4Stat == "2" || docNo4Stat == "5" || docNo4Stat == "6"))
	*/
	else
	{
		ufn_setGroupVisiblity("Button", false);									//버튼을 감춘다
		ufn_enableCommBtn("close", true);										//닫기 enable
		
		if((workStage == "1" || workStage == "2"))								//저장된 건이면
		{
			/* 201502121100 - 요구사항106 -> 수주변경/취소건 생성/저장은 본인뿐 아니라 조회 권한이 있는 모두가 가능하게해줄 것 
			if(selfFlag)														//자신의 저장건이면
			{
				ufn_enableCommBtn("delete", true);								//삭제 enable
				ufn_enableCommBtn("save", true);								//저장 enable
				ufn_enableCommBtn("reset", true);								//리셋 enable
				ufn_enableComponent("rd_dat", false);							//저장이 완료된 건에 대해 수주변경/취소를 바꿀 수 없다.

			}
			else																//타인의 견적이면
			{
				ufn_disableAllInput();											//모든 입력을 disable한다. 버튼은 감춘다. 
			}	
			*/
			
			ufn_enableCommBtn("delete", true);									//삭제 enable
			ufn_enableCommBtn("save", true);									//저장 enable
			ufn_enableCommBtn("reset", true);									//리셋 enable
			ufn_enableComponent("rd_dat", false);								//저장이 완료된 건에 대해 수주변경/취소를 바꿀 수 없다.
			
			if(toNumber(userGroup) >= 10 || directFlag)							//권한10직영인원, 보수PM이상의 권한이면 기안 버튼 enable (저장된 상태에서만 가능)
			{	
				ufn_enableCommBtn("draft", true);
			}
		}
		else																	//신규 건이면
		{
			/*
			if(selfFlag)														//자신의 건이면
			{
				ufn_enableCommBtn("save", true);								//저장 enable
				ufn_enableCommBtn("reset", true);								//리셋 enable
				//ufn_setObjectVisibility("rd_dat", true);						//수주변경/취소 선택 Radio enable
				ufn_enableComponent("rd_dat", true);							//저장되지 않았으므로 수주변경/취소 선택 가능
			}
			else																//타인의 견적이면
			{
				ufn_disableAllInput();											//모든 입력을 disable한다. 버튼은 감춘다. 
			}
			*/
			
			ufn_enableCommBtn("delete", true);									//삭제 enable
			ufn_enableCommBtn("save", true);									//저장 enable
			ufn_enableCommBtn("reset", true);									//리셋 enable
			ufn_enableComponent("rd_dat", true);								//저장이 완료된 건에 대해 수주변경/취소를 바꿀 수 없다.			
		}		
		ufn_enableCommBtn("close", true);										//닫기 enable
	}
	ufn_enableCommBtn("print", true);
}


//=========================================================================================
// [ PART 6 ]
// component Event 정의 : 각 Component 별 이벤트 
//=========================================================================================

/********************************************************************************
* 기      능   : 변동금액이 변경될 경우
********************************************************************************/
function ed_adjcost_OnChanged(obj,strText)
{
	/*

	if(toNumber(ed_adjcost.value) != 0)
	{
		rd_dat.Value = "1";
	}
	else
	{	
		rd_dat.Value = "2";
	}

	*/
	ufn_calcCostValues();
}

/********************************************************************************
* 기      능   : 수주변경/수주취소 선택이 변경될 경우
********************************************************************************/
function rd_dat_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	ds_out_master.SetColumn(0, "CHGBN", rd_dat.Value);

	ufn_calcCostValues();
}

]]></Script>
</Window>