<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="562" Id="CS0101008A" Left="8" OnLoadCompleted="fn_OnLoadCompleted" OnUnloadCompleted="fn_OnUnloadCompleted" PidAttrib="7" Title="견적작성&#32;및&#32;수주등록" Top="8" Ver="1.0" Width="978" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_gubun">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE>1</CODE>
						<CODE_NAME>견적</CODE_NAME>
					</record>
					<record>
						<CODE>2</CODE>
						<CODE_NAME>이동계획</CODE_NAME>
					</record>
					<record>
						<CODE>3</CODE>
						<CODE_NAME>수주</CODE_NAME>
					</record>
					<record>
						<CODE>4</CODE>
						<CODE_NAME>수주변경</CODE_NAME>
					</record>
					<record>
						<CODE>5</CODE>
						<CODE_NAME>수주취소</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond">
				<Contents>
					<colinfo id="AREA_CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="COMBO3" size="256" summ="default" type="STRING"/>
					<colinfo id="DOCNO" size="256" summ="default" type="STRING"/>
					<colinfo id="FROM_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="JPGBN" size="256" summ="default" type="STRING"/>
					<colinfo id="LABSTAT" size="256" summ="default" type="STRING"/>
					<colinfo id="PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="QTNO" size="256" summ="default" type="STRING"/>
					<colinfo id="QTNUM" size="256" summ="default" type="STRING"/>
					<colinfo id="REQKIND" size="256" summ="default" type="STRING"/>
					<colinfo id="REQNO" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="SONO" size="256" summ="default" type="STRING"/>
					<colinfo id="STATUS" size="256" summ="default" type="STRING"/>
					<colinfo id="TO_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="USER_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="ARA" size="256" summ="default" type="STRING"/>
					<colinfo id="BSU" size="256" summ="default" type="STRING"/>
					<colinfo id="BPM" size="256" summ="default" type="STRING"/>
					<colinfo id="TEM" size="256" summ="default" type="STRING"/>
					<colinfo id="DPT" size="256" summ="default" type="STRING"/>
					<colinfo id="PS_PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="ENDYN" size="256" summ="default" type="STRING"/>
					<colinfo id="CNM" size="256" summ="default" type="STRING"/>
					<colinfo id="JKUNNR" size="256" summ="default" type="STRING"/>
					<record>
						<ARA></ARA>
						<AREA_CODE></AREA_CODE>
						<BPM></BPM>
						<BSU></BSU>
						<CNM></CNM>
						<COMBO3></COMBO3>
						<DOCNO></DOCNO>
						<DPT></DPT>
						<ENDYN></ENDYN>
						<FROM_DT></FROM_DT>
						<GBN></GBN>
						<JKUNNR></JKUNNR>
						<JPGBN></JPGBN>
						<LABSTAT></LABSTAT>
						<PS_PSPID></PS_PSPID>
						<PSPID></PSPID>
						<QTNO></QTNO>
						<QTNUM></QTNUM>
						<REQKIND></REQKIND>
						<REQNO></REQNO>
						<SEQ></SEQ>
						<SONO></SONO>
						<STATUS></STATUS>
						<TEM></TEM>
						<TO_DT></TO_DT>
						<USER_ID></USER_ID>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_reqkind_cd">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME>ALL</CODE_NAME>
					</record>
					<record>
						<CODE>1</CODE>
						<CODE_NAME>부품판매</CODE_NAME>
					</record>
					<record>
						<CODE>6</CODE>
						<CODE_NAME>재고소진</CODE_NAME>
					</record>
					<record>
						<CODE>7</CODE>
						<CODE_NAME>수리공사</CODE_NAME>
					</record>
					<record>
						<CODE>G</CODE>
						<CODE_NAME>실패현장</CODE_NAME>
					</record>
					<record>
						<CODE>S</CODE>
						<CODE_NAME>시스템공사</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_jpgbn_cd">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME>ALL</CODE_NAME>
					</record>
					<record>
						<CODE>1</CODE>
						<CODE_NAME>승강기</CODE_NAME>
					</record>
					<record>
						<CODE>2</CODE>
						<CODE_NAME>주차</CODE_NAME>
					</record>
					<record>
						<CODE>4</CODE>
						<CODE_NAME>PSD</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list_master">
				<Contents>
					<colinfo id="ADJCOST" size="256" summ="default" type="STRING"/>
					<colinfo id="AMOUNT" size="256" summ="default" type="STRING"/>
					<colinfo id="APDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="BILAMT1" size="256" summ="default" type="STRING"/>
					<colinfo id="BSUNM" size="256" summ="default" type="STRING"/>
					<colinfo id="CRDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="CRNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="DOC1" size="256" summ="default" type="STRING"/>
					<colinfo id="DOC2" size="256" summ="default" type="STRING"/>
					<colinfo id="DOC3" size="256" summ="default" type="STRING"/>
					<colinfo id="DOC4" size="256" summ="default" type="STRING"/>
					<colinfo id="DOC5" size="256" summ="default" type="STRING"/>
					<colinfo id="DOC1STATNM" size="256" summ="default" type="STRING"/>
					<colinfo id="DOC2STATNM" size="256" summ="default" type="STRING"/>
					<colinfo id="DOC3STATNM" size="256" summ="default" type="STRING"/>
					<colinfo id="DOC4STATNM" size="256" summ="default" type="STRING"/>
					<colinfo id="DOC5STATNM" size="256" summ="default" type="STRING"/>
					<colinfo id="ED_LIFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="MA_PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="PS_PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="QSTAT" size="256" summ="default" type="STRING"/>
					<colinfo id="QSTATNM" size="256" summ="default" type="STRING"/>
					<colinfo id="QTAPDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="QTNUM" size="256" summ="default" type="STRING"/>
					<colinfo id="REQKIND" size="256" summ="default" type="STRING"/>
					<colinfo id="REQKINDNM" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="SOAPDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="SOCADAT" size="256" summ="default" type="STRING"/>
					<colinfo id="SOCHDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="SODAT" size="256" summ="default" type="STRING"/>
					<colinfo id="SORATE" size="256" summ="default" type="STRING"/>
					<colinfo id="SPT" size="256" summ="default" type="STRING"/>
					<colinfo id="VBELN" size="256" summ="default" type="STRING"/>
					<colinfo id="VKBUR" size="256" summ="default" type="STRING"/>
					<colinfo id="VKGRP" size="256" summ="default" type="STRING"/>
					<colinfo id="VKGRPNM" size="256" summ="default" type="STRING"/>
					<colinfo id="QTNAM" size="256" summ="default" type="STRING"/>
					<colinfo id="CS001_GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="ENDYN" size="256" summ="default" type="STRING"/>
					<colinfo id="ENDDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="ENDRSN" size="256" summ="default" type="STRING"/>
					<colinfo id="ENDCHK" size="256" summ="default" type="STRING"/>
					<colinfo id="JPGBN_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="CYN" size="256" summ="default" type="STRING"/>
					<colinfo id="CTP" size="256" summ="default" type="STRING"/>
					<colinfo id="PS_PSPID_J" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list_detail">
				<Contents>
					<colinfo id="BOGBN" size="256" summ="default" type="STRING"/>
					<colinfo id="CGUBNNM" size="256" summ="default" type="STRING"/>
					<colinfo id="CHAR1" size="256" summ="default" type="STRING"/>
					<colinfo id="CRT_DATE" size="256" summ="default" type="STRING"/>
					<colinfo id="HOGI_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="HOGI_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="MAKTX" size="256" summ="default" type="STRING"/>
					<colinfo id="MATNR" size="256" summ="default" type="STRING"/>
					<colinfo id="MBEW_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="MEINS" size="256" summ="default" type="STRING"/>
					<colinfo id="MENGE" size="256" summ="default" type="STRING"/>
					<colinfo id="PRLAB" size="256" summ="default" type="STRING"/>
					<colinfo id="PRLAB1" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQNO" size="256" summ="default" type="STRING"/>
					<colinfo id="ZGUBN" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_gubun_wbap">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME>ALL</CODE_NAME>
					</record>
					<record>
						<CODE>1</CODE>
						<CODE_NAME>견적저장완료</CODE_NAME>
					</record>
					<record>
						<CODE>2</CODE>
						<CODE_NAME>견적결재중</CODE_NAME>
					</record>
					<record>
						<CODE>3</CODE>
						<CODE_NAME>견적결재반려</CODE_NAME>
					</record>
					<record>
						<CODE>4</CODE>
						<CODE_NAME>견적결재완료</CODE_NAME>
					</record>
					<record>
						<CODE>5</CODE>
						<CODE_NAME>수주등록진행</CODE_NAME>
					</record>
					<record>
						<CODE>6</CODE>
						<CODE_NAME>수주결재중</CODE_NAME>
					</record>
					<record>
						<CODE>7</CODE>
						<CODE_NAME>수주결재반려</CODE_NAME>
					</record>
					<record>
						<CODE>8</CODE>
						<CODE_NAME>수주결재완료</CODE_NAME>
					</record>
					<record>
						<CODE>10</CODE>
						<CODE_NAME>청구전송완료</CODE_NAME>
					</record>
					<record>
						<CODE>11</CODE>
						<CODE_NAME>재청구결재중</CODE_NAME>
					</record>
					<record>
						<CODE>12</CODE>
						<CODE_NAME>재청구결재반려</CODE_NAME>
					</record>
					<record>
						<CODE>13</CODE>
						<CODE_NAME>재청구결재완료</CODE_NAME>
					</record>
					<record>
						<CODE>14</CODE>
						<CODE_NAME>수주변경결재중</CODE_NAME>
					</record>
					<record>
						<CODE>15</CODE>
						<CODE_NAME>수주변경결재반려</CODE_NAME>
					</record>
					<record>
						<CODE>16</CODE>
						<CODE_NAME>수주변경결재완료</CODE_NAME>
					</record>
					<record>
						<CODE>17</CODE>
						<CODE_NAME>수주취소결재중</CODE_NAME>
					</record>
					<record>
						<CODE>18</CODE>
						<CODE_NAME>수주취소결재반려</CODE_NAME>
					</record>
					<record>
						<CODE>19</CODE>
						<CODE_NAME>수주취소결재완료</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_wf_stat">
				<Contents>
					<colinfo id="DOCNO" size="256" summ="default" type="STRING"/>
					<colinfo id="DOCKIND" size="256" summ="default" type="STRING"/>
					<colinfo id="APPGUBN" size="256" summ="default" type="STRING"/>
					<colinfo id="APPGUBNNM" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQNO" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQNONM" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQSTAT" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQSTATNM" size="256" summ="default" type="STRING"/>
					<colinfo id="APDPT1" size="256" summ="default" type="STRING"/>
					<colinfo id="APDPT1_N" size="256" summ="default" type="STRING"/>
					<colinfo id="APNUM" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE" size="256" summ="default" type="STRING"/>
					<colinfo id="APTIM" size="256" summ="default" type="STRING"/>
					<colinfo id="APDESC" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cyn_cd">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME></CODE_NAME>
					</record>
					<record>
						<CODE>Y</CODE>
						<CODE_NAME>예</CODE_NAME>
					</record>
					<record>
						<CODE>N</CODE>
						<CODE_NAME>아니오</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ctp_cd">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_wbap02_list">
				<Contents>
					<colinfo id="DOCNO" size="256" summ="default" type="STRING"/>
					<colinfo id="DOCKIND" size="256" summ="default" type="STRING"/>
					<colinfo id="APPGUBN" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQNO" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQSTAT" size="256" summ="default" type="STRING"/>
					<colinfo id="MAX_SEQNO" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE" size="256" summ="default" type="STRING"/>
					<colinfo id="APSTAT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_wbap02">
				<Contents>
					<colinfo id="DOCNO" size="256" summ="default" type="STRING"/>
					<colinfo id="DOCKIND" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_days">
				<Contents>
					<colinfo id="DAYS" size="256" type="STRING"/>
					<record>
						<DAYS></DAYS>
					</record>
				</Contents>
			</Dataset>
		</Datasets>
		<Shape BKColor="user0" Bottom="98" Height="97" Id="Shape0" Left="0" LineColor="user1" Right="978" TabOrder="1" Top="1" Type="Rectangle" Width="978"></Shape>
		<Grid AutoFitEndLine="Hide" BindDataset="ds_list_master" BkColor2="default" BoldHead="true" Border="Flat" Bottom="342" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="216" Id="grd_list_master" InputPanel="FALSE" Left="8" LineColor="user20" LineType="ExHORZ" OnCellDBLClick="grd_list_master_OnCellDblClick" OnCellPosChanged="grd_list_master_OnCellPosChanged" OnHeadClick="grd_list_OnHeadClick" Right="969" RowHeight="20" Style="sty_grid" TabOrder="2" TabStop="true" Top="126" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="961">
			<contents>
				<format id="Default">
					<columns>
						<col fix="left" width="40"/>
						<col fix="left" width="80"/>
						<col fix="left" width="80"/>
						<col fix="left" width="90"/>
						<col width="140"/>
						<col width="140"/>
						<col width="90"/>
						<col width="140"/>
						<col width="60"/>
						<col width="140"/>
						<col width="85"/>
						<col width="85"/>
						<col width="50"/>
						<col width="85"/>
						<col width="52"/>
						<col width="60"/>
						<col width="80"/>
						<col width="80"/>
						<col width="100"/>
						<col width="80"/>
						<col width="90"/>
						<col width="90"/>
						<col width="90"/>
						<col width="90"/>
						<col width="90"/>
						<col width="90"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="60"/>
						<col width="80"/>
						<col width="60"/>
						<col width="60"/>
						<col width="100"/>
						<col width="74"/>
						<col width="137"/>
						<col width="84"/>
					</columns>
					<head>
						<cell col="0" display="text" font="굴림,9" text="No"/>
						<cell col="1" display="text" font="굴림,9" text="견적번호"/>
						<cell col="2" display="text" font="굴림,9" text="수주번호"/>
						<cell col="3" display="text" font="굴림,9" text="WBS(모*사)"/>
						<cell col="4" display="text" font="굴림,9" text="지사명"/>
						<cell col="5" display="text" font="굴림,9" text="업체명"/>
						<cell align="center" col="6" display="text" font="굴림,9" text="Proj.No"/>
						<cell col="7" display="text" font="굴림,9" text="현장명"/>
						<cell col="8" display="text" font="굴림,9" text="청구종류"/>
						<cell col="9" display="text" font="굴림,9" text="견적명"/>
						<cell col="10" display="text" font="굴림,9" text="판매가"/>
						<cell col="11" display="text" font="굴림,9" text="견적가"/>
						<cell col="12" display="text" font="굴림,9" text="수주율"/>
						<cell col="13" display="text" font="굴림,9" text="변경금액"/>
						<cell col="14" display="text" font="굴림,9" text="작성자"/>
						<cell col="15" display="text" font="굴림,9" text="작성자ID"/>
						<cell col="16" display="text" font="굴림,9" text="작성일자"/>
						<cell col="17" display="text" font="굴림,9" text="수주예정일"/>
						<cell col="18" display="text" font="굴림,9" text="견적구분"/>
						<cell col="19" display="text" font="굴림,9" text="수주일자"/>
						<cell col="20" display="text" font="굴림,9" text="청구진행상태"/>
						<cell col="21" display="text" font="굴림,9" text="견적상태"/>
						<cell col="22" display="text" font="굴림,9" text="수주상태"/>
						<cell col="23" display="text" font="굴림,9" text="재청구상태"/>
						<cell col="24" display="text" font="굴림,9" text="수주변경상태"/>
						<cell col="25" display="text" font="굴림,9" text="수주취소상태"/>
						<cell col="26" display="text" font="굴림,9" text="견적종료여부"/>
						<cell col="27" display="text" font="굴림,9" text="견적종료일자"/>
						<cell col="28" display="text" font="굴림,9" text="견적종료사유"/>
						<cell col="29" display="text" font="굴림,9" text="제품군"/>
						<cell col="30" display="text" font="굴림,9" text="작성일자"/>
						<cell col="31" display="text" font="굴림,9" text="주구분"/>
						<cell col="32" display="text" font="굴림,9" text="주차구분"/>
						<cell col="33" display="text" font="굴림,9" text="업체&#32;사업자번호"/>
						<cell col="34" display="text" font="굴림,9" text="계약서유/무"/>
						<cell col="35" display="text" font="굴림,9" text="계약서&#32;유형"/>
						<cell col="36" display="text" font="굴림,9" text="WBS(자*사)"/>
					</head>
					<body>
						<cell align="center" col="0" display="text" expr="currow+1"/>
						<cell align="center" col="1" colid="QTNUM" display="text"/>
						<cell align="center" col="2" colid="VBELN" display="text"/>
						<cell align="center" col="3" colid="PS_PSPID" display="text"/>
						<cell align="left" col="4" colid="VKGRPNM" display="text"/>
						<cell align="left" col="5" colid="BSUNM" display="text"/>
						<cell align="center" col="6" colid="MA_PSPID" display="text"/>
						<cell align="left" col="7" colid="SPT" display="text"/>
						<cell align="center" col="8" colid="REQKINDNM" display="text"/>
						<cell align="left" col="9" colid="QTNAM" display="text"/>
						<cell align="right" col="10" colid="BILAMT1" display="currency"/>
						<cell align="right" col="11" colid="AMOUNT" display="currency"/>
						<cell align="right" col="12" colid="SORATE" display="number" Mask="###.##%"/>
						<cell align="right" col="13" colid="ADJCOST" display="currency"/>
						<cell align="center" col="14" colid="CRNAME" display="text"/>
						<cell align="center" col="15" colid="CRNAME_ID" display="text"/>
						<cell align="center" col="16" colid="CRDAT" display="text" Mask="####.##.##"/>
						<cell align="center" col="17" colid="SODAT" display="text" Mask="####.##.##"/>
						<cell align="center" col="18" colid="CS001_GBN" display="text"/>
						<cell align="center" col="19" colid="APDAT" display="text" Mask="####.##.##"/>
						<cell align="center" col="20" colid="QSTATNM" display="text"/>
						<cell align="center" col="21" colid="DOC1STATNM" display="text"/>
						<cell align="center" col="22" colid="DOC2STATNM" display="text"/>
						<cell align="center" col="23" colid="DOC3STATNM" display="text"/>
						<cell align="center" col="24" colid="DOC4STATNM" display="text"/>
						<cell align="center" col="25" colid="DOC5STATNM" display="text"/>
						<cell align="center" col="26" colid="ENDYN" display="text"/>
						<cell align="center" col="27" colid="ENDDAT" display="text" Mask="####.##.##"/>
						<cell align="center" bkimagealign="stretch" bkimageid="btn_grid_01" col="28" cursor="hand" display="button" text="종료사유"/>
						<cell align="center" col="29" colid="JPGBN_NM" display="text"/>
						<cell align="center" col="30" colid="CRDAT" display="text" Mask="####.##.##"/>
						<cell align="center" col="31" colid="WEEK" display="text"/>
						<cell align="center" col="32" colid="WEEKGUBUN" display="text"/>
						<cell align="center" col="33" colid="LIFNR" display="text"/>
						<cell align="center" col="34" colid="CYN" combocol="CODE" combodataset="ds_cyn_cd" combotext="CODE_NAME" display="combo"/>
						<cell align="center" col="35" colid="CTP" combocol="CODE" combodataset="ds_ctp_cd" combotext="CODE_NAME" display="combo"/>
						<cell align="center" col="36" colid="PS_PSPID_J" display="text"/>
					</body>
					<summary>
						<cell align="right" bkcolor="user25" col="0" colspan="10" display="text" text="합&#32;계&#32;"/>
						<cell align="right" bkcolor="user25" col="10" display="currency" expr='sum(&quot;BILAMT1&quot;)'/>
						<cell align="right" bkcolor="user25" col="11" display="currency" expr='sum(&quot;AMOUNT&quot;)'/>
						<cell bkcolor="user25" col="12" display="text"/>
						<cell bkcolor="user25" col="13" display="text"/>
						<cell bkcolor="user25" col="14" display="text"/>
						<cell bkcolor="user25" col="15" display="text"/>
						<cell bkcolor="user25" col="16" display="text"/>
						<cell bkcolor="user25" col="17" display="text"/>
						<cell bkcolor="user25" col="18" display="text"/>
						<cell bkcolor="user25" col="19" display="text"/>
						<cell bkcolor="user25" col="20" display="text"/>
						<cell bkcolor="user25" col="21" display="text"/>
						<cell bkcolor="user25" col="22" display="text"/>
						<cell bkcolor="user25" col="23" display="text"/>
						<cell bkcolor="user25" col="24" display="text"/>
						<cell bkcolor="user25" col="25" display="text"/>
						<cell bkcolor="user25" col="26" display="text"/>
						<cell bkcolor="user25" col="27" display="text"/>
						<cell bkcolor="user25" col="28" display="text"/>
						<cell bkcolor="user25" col="29" display="text"/>
						<cell bkcolor="user25" col="30" display="text"/>
						<cell bkcolor="user25" col="31" display="text"/>
						<cell bkcolor="user25" col="32" display="text"/>
						<cell bkcolor="user25" col="33" display="text"/>
						<cell bkcolor="user25" col="34" display="text"/>
						<cell bkcolor="user25" col="35" display="text"/>
						<cell align="right" bkcolor="user25" col="36" display="text"/>
					</summary>
				</format>
			</contents>
		</Grid>
		<Static Align="Right" Height="20" Id="st_dat" Left="775" Style="sty_lb_search" TabOrder="3" Text="진행상태&#32;" Top="8" VAlign="Middle" Width="80"></Static>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="CODE" Column="STATUS" DataColumn="CODE_NAME" DisableBKColor="user5" Height="20" Id="cb_stat" InnerDataset="ds_gubun_wbap" Left="856" Style="sty_ipt_search_ind" TabOrder="4" Top="7" Width="115"></Combo>
		<Static Align="Right" Height="20" Id="st_pst" Left="7" Style="sty_lb_search" TabOrder="5" Text="구분&#32;" Top="8" VAlign="Middle" Width="80"></Static>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="CODE" Column="GBN" DataColumn="CODE_NAME" Editable="TRUE" Height="20" Id="cb_gubun" ImeMode="none" INDEX="0" InnerDataset="ds_gubun" Left="88" Style="sty_ipt_search_ind" TabOrder="6" Top="7" Width="112"></Combo>
		<Grid AutoFitEndLine="Hide" BindDataset="ds_list_detail" BkColor2="default" BoldHead="true" Border="Flat" Bottom="554" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="208" Id="grd_list_detail" InputPanel="FALSE" Left="8" LineColor="user20" LineType="ExHORZ" Right="969" RowHeight="20" Style="sty_grid" TabOrder="2" TabStop="true" Top="346" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="961">
			<contents>
				<format id="Default">
					<columns>
						<col width="50"/>
						<col width="80"/>
						<col width="300"/>
						<col width="193"/>
						<col width="40"/>
						<col width="40"/>
						<col width="150"/>
						<col width="75"/>
						<col width="75"/>
						<col width="120"/>
						<col width="75"/>
						<col width="80"/>
						<col width="100"/>
						<col width="100"/>
						<col width="54"/>
					</columns>
					<head>
						<cell col="0" display="text" font="굴림,9" text="순번"/>
						<cell col="1" display="text" font="굴림,9" text="자재코드"/>
						<cell col="2" display="text" font="굴림,9" text="자재내역"/>
						<cell col="3" display="text" font="굴림,9" text="자재특성치"/>
						<cell col="4" display="text" font="굴림,9" text="수량"/>
						<cell col="5" display="text" font="굴림,9" text="단위"/>
						<cell col="6" display="text" font="굴림,9" text="호기명"/>
						<cell col="7" display="text" font="굴림,9" text="호기(WBS)"/>
						<cell col="8" display="text" font="굴림,9" text="자재유형"/>
						<cell col="9" display="text" font="굴림,9" text="평가유형"/>
						<cell col="10" display="text" font="굴림,9" text="변동구분"/>
						<cell col="11" display="text" font="굴림,9" text="배송일자"/>
						<cell col="12" display="text" font="굴림,9" text="보수창고재고"/>
						<cell col="13" display="text" font="굴림,9" text="청구업체창고재고"/>
						<cell col="14" display="text" font="굴림,9" text="직영재고"/>
					</head>
					<body>
						<cell align="center" col="0" colid="SEQNO" display="text"/>
						<cell align="center" col="1" colid="MATNR" display="text"/>
						<cell align="left" col="2" colid="MAKTX" display="text"/>
						<cell align="left" col="3" colid="CHAR1" display="text"/>
						<cell align="right" col="4" colid="MENGE" display="number"/>
						<cell align="center" col="5" colid="MEINS" display="text"/>
						<cell align="left" col="6" colid="HOGI_NM" display="text"/>
						<cell align="center" col="7" colid="HOGI_ID" display="text"/>
						<cell align="center" col="8" colid="CGUBNNM" display="text"/>
						<cell align="center" col="9" colid="MBEW_NM" display="text"/>
						<cell align="center" col="10" colid="BOGBN" display="text"/>
						<cell align="center" col="11" colid="CRT_DATE" display="text" Mask="####.##.##"/>
						<cell align="right" col="12" colid="PRLAB" display="number"/>
						<cell align="right" col="13" colid="PRLAB1" display="number"/>
						<cell align="center" col="14" colid="ZGUBN" display="text"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Static Align="Right" Height="20" Id="st_pjt" Left="7" Style="sty_lb_search" TabOrder="10" Text="Proj&#32;No*" Top="52" VAlign="Middle" Width="80"></Static>
		<Edit BindDataset="ds_cond" Border="Flat" Column="PSPID" Height="20" Id="ed_pjt" Left="89" MaxLength="10" Style="sty_ipt_search_ind" TabOrder="11" Top="52" UpperOnly="TRUE" Width="92"></Edit>
		<Button Cursor="HAND" Height="18" Id="btn_pjt" ImageID="btn_icon_search" Left="183" OnClick="btn_pjt_OnClick" TabOrder="12" Text="Button0" Top="53" Width="18"></Button>
		<Static Align="Right" Height="20" Id="st_bsu" Left="7" Style="sty_lb_search" TabOrder="9" Text="협력사&#32;" Top="30" VAlign="Middle" Width="80"></Static>
		<Div BKColor="user0" Height="20" Id="div_code" Left="89" OnLoadCompleted="fn_OnLoadCompleted" OnTimer="WB0199010A_OnTimer" TabOrder="8" Text="Div0" Top="30" Url="WB01::WB0199010A.xml" Width="415">
			<Contents></Contents>
		</Div>
		<Static Align="Right" Height="20" Id="Static0" Left="234" Style="sty_lb_search" TabOrder="16" Text="기간&#32;" Top="8" VAlign="Middle" Width="80"></Static>
		<Calendar BindDataset="ds_cond" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="FROM_DT" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_from" Left="316" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" OnChanged="cal_from_OnChanged" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_search_ind" SundayTextColor="user35" TabOrder="13" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="8" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="80"></Calendar>
		<Static Align="Center" Border="None" Color="user7" Font="굴림,9" Height="20" Id="st_btw" Left="400" TabOrder="14" Text="~" Top="9" VAlign="Middle" Width="18"></Static>
		<Calendar BindDataset="ds_cond" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="TO_DT" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_to" Left="423" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" OnChanged="cal_to_OnChanged" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_search_ind" SundayTextColor="user35" TabOrder="15" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="8" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="80"></Calendar>
		<Static Align="Right" Height="20" Id="Static1" Left="544" Style="sty_lb_search" TabOrder="17" Text="청구구분&#32;" Top="8" VAlign="Middle" Width="80"></Static>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="CODE" Column="REQKIND" DataColumn="CODE_NAME" DisableBKColor="user5" Height="20" Id="cb_reqkind" INDEX="0" InnerDataset="ds_reqkind_cd" Left="625" Style="sty_ipt_search_ind" TabOrder="18" Top="7" Width="112"></Combo>
		<Static Align="Right" Height="20" Id="Static2" Left="544" Style="sty_lb_search" TabOrder="19" Text="제품군&#32;" Top="30" VAlign="Middle" Width="80"></Static>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="CODE" Column="JPGBN" DataColumn="CODE_NAME" DisableBKColor="user5" Height="20" Id="cb_jpgbn" InnerDataset="ds_jpgbn_cd" Left="625" Style="sty_ipt_search_ind" TabOrder="20" Top="29" Width="112"></Combo>
		<Static Align="Right" Height="20" Id="Static3" Left="234" Style="sty_lb_search" TabOrder="21" Text="견적번호*" Top="52" VAlign="Middle" Width="80"></Static>
		<Edit BindDataset="ds_cond" Border="Flat" Column="QTNO" Height="20" Id="ed_qtnum" Left="316" MaxLength="10" Style="sty_ipt_search_ind" TabOrder="22" Text="1000136" Top="52" UpperOnly="TRUE" Width="92"></Edit>
		<Static Align="Right" Height="20" Id="Static4" Left="544" Style="sty_lb_search" TabOrder="23" Text="수주번호*" Top="52" VAlign="Middle" Width="80"></Static>
		<Edit BindDataset="ds_cond" Border="Flat" Column="SONO" Height="20" Id="ed_sono" Left="626" MaxLength="10" Style="sty_ipt_search_ind" TabOrder="24" Top="52" UpperOnly="TRUE" Width="92"></Edit>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_mod" ImageID="btn_sub_04" Left="567" LeftMargin="12" OnClick="btn_openPopup1" Style="sty_btn" TabOrder="25" Text="견적작성" Top="102" Transparent="TRUE" Width="72"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="Button0" ImageID="btn_sub_07" Left="719" LeftMargin="12" OnClick="btn_openPopup2" Style="sty_btn" TabOrder="26" Text="수주&#32;변경/취소" Top="102" Transparent="TRUE" Width="112"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="Button1" ImageID="btn_sub_03" Left="831" LeftMargin="12" OnClick="btn_openPopup3" Style="sty_btn" TabOrder="27" Text="재청구" Top="102" Transparent="TRUE" Width="66"></Button>
		<Button Cursor="HAND" Height="18" Id="Button2" ImageID="btn_icon_search" Left="410" OnClick="bt_qtnum" TabOrder="28" Text="Button0" Top="53" Width="18"></Button>
		<Edit BindDataset="ds_cond" Border="Flat" Column="REQNO" Height="20" Id="ed_reqno" MaxLength="6" Style="sty_ipt_search_ind" TabOrder="29" Text="ED_REQNO" Top="568" UpperOnly="TRUE" Visible="FALSE" Width="92"></Edit>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_viewOffer" ImageID="btn_sub_04" Left="643" LeftMargin="12" OnClick="btn_viewOffer_OnClick" Style="sty_btn" TabOrder="30" Text="견적확인" Top="102" Transparent="TRUE" Width="72"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_wf_stat" ImageID="btn_sub_06" Left="467" LeftMargin="12" OnClick="btn_wf_stat_OnClick" Style="sty_btn" TabOrder="31" Text="결재상태확인" Top="102" Transparent="TRUE" Width="96"></Button>
		<Edit BindDataset="ds_cond" Border="Flat" Column="PS_PSPID" Height="20" Id="ed_wbs" Left="857" MaxLength="11" Style="sty_ipt_search_ind" TabOrder="33" Top="52" UpperOnly="TRUE" Width="92"></Edit>
		<Static Align="Right" Height="20" Id="st_wbs" Left="775" Style="sty_lb_search" TabOrder="32" Text="WBS*" Top="52" VAlign="Middle" Width="80"></Static>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_end" ImageID="btn_sub_04" Left="894" LeftMargin="12" OnClick="btn_end_OnClick" Style="sty_btn" TabOrder="34" Text="견적종료" Top="102" Transparent="TRUE" Width="72"></Button>
		<Checkbox BKColor="user0" Height="17" Id="chk_end" Left="777" TabOrder="35" Text="종료견적&#32;포함" Top="32" Value="FALSE" Width="168"></Checkbox>
		<Static Align="Right" Height="20" Id="st_cnm" Left="7" Style="sty_lb_search" TabOrder="36" Text="작성자*" Top="74" VAlign="Middle" Width="80"></Static>
		<Edit BindDataset="ds_cond" Border="Flat" Column="CNM" Height="20" Id="ed_cnm" Left="89" MaxLength="10" Style="sty_ipt_search_ind" TabOrder="37" Top="74" UpperOnly="TRUE" Width="92"></Edit>
		<Static Border="None" Color="user34" Height="16" Id="Static10" Left="10" TabOrder="38" Text="*&#32;필수값&#32;입력시&#32;기간제한없이&#32;조회가능합니다." Top="105" VAlign="Middle" Width="300"></Static>
		<Checkbox BKColor="user0" Height="17" Id="chk_sj" Left="234" TabOrder="39" Text="자회사판매" Top="77" Value="FALSE" Width="168"></Checkbox>
	</Form>
	<Script><![CDATA[﻿﻿﻿﻿﻿﻿﻿/*
 ******************************************************************************************
 * 기      능   : 보수자재 견적 메인 리스트
 * 작  성  자   : 이종석
 * 작성  일자   : 2014.10
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
#include "LIB::commons.js";	// 공통 스크립트 
//=========================================================================================
// [ PART 1 ]
// Form에서 사용될 전역변수를 선언
// FORM에서 사용되는 전역변수는 대문자로 작성하며, F_XXX 의 형태를 갖도록 한다. 
//=========================================================================================

var DEBUG_FLAG 	= true;														//디버그 기능 사용을 위한 플래그를 설정한다.

var pspid_yn = false; // Proj.no 입력여부
var qtno_yn = false; // 견적번호 입력여부
var sono_yn = false; // 수주번호 입력여부
var ps_pspid_yn = false; // WBS 입력여부
var cnm_yn = false; // 작성자 입력여부

//=========================================================================================
// [ PART 2 ]
// Form Loading / Unloading 시 작업 정의
//=========================================================================================
function fn_OnLoadCompleted(obj) {
	gfn_initForm(true);
	
	//if(DEBUG_FLAG) SHOW_ENV();

	ufn_initSearchParameters();
	
	//==================CRM 전환 관련 안내문구 추가 2021.05.13 HJH================================
	gfn_showAlert("CI30001", "5월 10일부터는 S-CRM으로 서비스 영업 계약을 진행요청 드리며," +
							 "\n\n개선 요청 및 문제점에 대하여서는 기존과 같이 BS포탈 우측 상단 메인 메뉴 " + 
							 "\n\n[문의/개선 요청 게시판]에 자유로운 피드백 작성 및 공지사항의 담당자 에게 발송 송부 바랍니다. " +
							 "\n5월 17일 부터는 SRM의 계약메뉴 사용은 각 지역 담당별로 순차적으로 확대하여 중단 진행 예정입니다."
							 
				  );	
	//============================================================================================			
}

/********************************************************************************
* 기      능   : 공통코드가 조회된 후의 Callback 함수 
********************************************************************************/
function fn_completeInit(sCode, sDsObj, sCodeType) {

}

/********************************************************************************
* 기      능   : form UnloadCompleted 
********************************************************************************/
function fn_OnUnloadCompleted(obj) {
	return gfn_isFormUnload(obj);
}

//=========================================================================================
// [ PART 3 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,form닫기)
//=========================================================================================
/********************************************************************************
* 기      능   : 조회 1
********************************************************************************/
function fn_query() {
	if(ufn_isNull(cal_from, true, "시작일", cal_from)) return false;			//최소입력조건:시작일
	if(ufn_isNull(cal_to, true, "종료일", cal_to)) return false;				//최소입력조건:종료일
	
	// 최대 12개월로 제한. 2019.04.08 Han J.H
	// 최대 6개월로 제한. 윤부장님 요청. 2019.04.18 Han J.H
	var diffDays = gfn_getDayCnt(ds_days, cal_from.value, cal_to.value);	
	
	// 2019.04.08 필수값 체크
	searchValueChk();
	
	// 필수조회 조건중 한가지 항목이라도 입력되었을 경우, 조회기간을 다음과 같이 강제로 세팅함.
	if(pspid_yn == true || qtno_yn == true || sono_yn == true || ps_pspid_yn == true) {
		//ds_cond.SetColumn(0,"FROM_DT", "20000101");
		//ds_cond.SetColumn(0,"TO_DT", gfn_getCurrDate());
	} else {
		// 필수조건이 입력되지 않았을 경우에는 조회기간을 1년으로 제한함.
		// 작성자로 검색시에는 기간제한을 두지 않음.
		if(diffDays > 180 && cnm_yn != true) {
			gfn_showAlert("CW00078","6");
			cal_from.SetFocus();
			return;
		}		
	}
	
	// 작성자의 경우 최소 2자리 이상으로 체크
	if(cnm_yn == true) {
		if(length(trim(ds_cond.GetColumn(0,"CNM"))) < 2) {
			gfn_showAlert("작성자의 경우 최소 2자리 이상으로 입력해주세요.");
			cnm_yn = false;
			ed_cnm.SetFocus();
			return;
		}	
	}	
	
	// 종료일자는 시작일자보다 이전일수 없음.
	if(cal_to.value < cal_from.value) {
		gfn_showAlert("종료일자의 경우 시작일자보다 이전 일 수 없습니다.");
		return;
	}

	var user_grp = gfn_getUserGroup();											//사용자 그룹을 가져온다
			
	// 40 권한의 경우 중간콤보 단위로 검색되지 않도록 제약
	if(user_grp == '40') {
		if(gfn_isNull(div_code.cb_big, true, st_bsu.value)) {
			var arr = [st_bsu.value];
			gfn_showMsg("CW00001", arr);
			return;
		}
	}		
	
	if(user_grp == "10") { // 보수협력사일 경우									//협력사 검색조건을 적용한다.
		ds_cond.SetColumn(0, "BSU", G_LGORT);
		ds_cond.SetColumn(0, "TEM", '');
		ds_cond.SetColumn(0, "BPM", '');
		ds_cond.SetColumn(0, "ARA", '');
	} else if(user_grp == "20") { // 보수PM일 경우
		ds_cond.SetColumn(0, "BSU", trim(div_code.cb_small.value));
		ds_cond.SetColumn(0, "TEM", '');
		ds_cond.SetColumn(0, "BPM", G_USER_ID);
		ds_cond.SetColumn(0, "ARA", '');
	} else if(user_grp == "30") { // 지방사무소일 경우
		ds_cond.SetColumn(0, "BSU", trim(div_code.cb_small.value));
		ds_cond.SetColumn(0, "TEM", G_SAP_USER_VGCD);
		ds_cond.SetColumn(0, "BPM", '');
		ds_cond.SetColumn(0, "ARA", '');
	} else if(user_grp == "40") { // 고객지원부일 경우
		ds_cond.SetColumn(0, "BSU", trim(div_code.cb_small.value));
		if(div_code.cb_big.value == '1') { // 협력사 콤보1이 지역일 경우
			ds_cond.SetColumn(0, "DPT", '');
			ds_cond.SetColumn(0, "TEM", '');
			ds_cond.SetColumn(0, "BPM", '');
			ds_cond.SetColumn(0, "ARA", trim(div_code.cb_mid.value));
		} else if(div_code.cb_big.value == '2') { // 협력사 콤보1이 PM일 경우
			ds_cond.SetColumn(0, "DPT", '');
			ds_cond.SetColumn(0, "TEM", '');
			ds_cond.SetColumn(0, "BPM", trim(div_code.cb_mid.value));
			ds_cond.SetColumn(0, "ARA", '');
		} else if(div_code.cb_big.value == '4') { // 협력사 콤보1이 부서일 경우
			ds_cond.SetColumn(0, "DPT", trim(div_code.cb_mid.value));
			ds_cond.SetColumn(0, "TEM", trim(div_code.cb_small.value));
			ds_cond.SetColumn(0, "BSU", '');
			ds_cond.SetColumn(0, "BPM", '');
			ds_cond.SetColumn(0, "ARA", '');
		} else { // 협력사 콤보1이 팀일 경우
			ds_cond.SetColumn(0, "DPT", '');
			ds_cond.SetColumn(0, "TEM", trim(div_code.cb_mid.value));
			ds_cond.SetColumn(0, "BPM", '');
			ds_cond.SetColumn(0, "ARA", '');
		}
	}		

	if(chk_end.Value == true) { // 종료견적 포함
		ds_cond.SetColumn(0, "ENDYN", "Y");
	} else {
		ds_cond.SetColumn(0, "ENDYN", "N");
	}

	if(chk_sj.Value == true) { // 자회사 판매분
		ds_cond.SetColumn(0, "JKUNNR", "0000258910");
	} else {
		ds_cond.SetColumn(0, "JKUNNR", "");
	}


//	DEBUG("fn_query", "ds_cond is " + ds_cond.SaveXml());

	ufn_clearGrid();
	gfn_clearMsgBar();

	tit_clearActionInfo();
	tit_addSearchActionInfo("cs01:CS0101008A_S1", true, true);					//Master List
	tit_addSearchActionInfo("cs01:CS0101008A_S2", false, true);					//Master List에 대한 Detail List

	fn_createWait("",this);														//"처리중입니다. 잠시 기다려주십시오." 윈도우 create

	grd_list_detail.visible = false;

	tit_callService(
        ""
        , ""
        , "ds_cond=ds_cond"
        , "ds_list_master=ds_list_master ds_list_detail=ds_list_detail"
        , ""
        , "fn_afterQueryMaster"
        , true
        , ""
        , true
        );
}

/********************************************************************************
* 기      능   : 닫기  
********************************************************************************/
function fn_close() {
	close();
}

/********************************************************************************
* 기      능   : 액셀  
********************************************************************************/
function fn_excel() {
	// Excel Export 
	gfn_saveToExcel(grd_list_master, true, "", "", false, true);
	
}

//=========================================================================================
// [ PART 4]
// Callback 함수 정의 : callback 함수명은 메인 함수의 fn_xxxx() 에서 xxxx 부분은 fn_afterXXXX()
// 형태가 되도록 작성 
//=========================================================================================
/********************************************************************************
* 기      능   : 조회 Callback  
********************************************************************************/
function fn_afterQueryMaster(errCode, errMsg) {
	fn_destroyWait();															//"처리중입니다. 잠시 기다려주십시오." 윈도우 destroy
	
	gfn_showSearchMsg(grd_list_master);											// 메시지 처리 

	if(ds_list_detail.rowcount > 0)
	{
		ds_list_detail.filter("QTNUM==" + quote(ds_list_master.GetColumn(0, "QTNUM")) + " && SEQ==" + quote(ds_list_master.GetColumn(0, "SEQ")));
	}
	
	grd_list_detail.visible = true;
	
	// 필수입력조건 체크내역 해제
	pspid_yn = false;
	qtno_yn = false;	
	sono_yn = false;	
	ps_pspid_yn = false;
	cnm_yn = false;

}

/********************************************************************************
* 기      능   : 저장 Callback  
********************************************************************************/
function fn_afterSave(errCode, errMsg) {
	if ( ds_error.rowcount() > 0 ) {
		gfn_showMsg("CE00001");
	} else {
		gfn_showMsg("CI00003");
	}
}

//=========================================================================================
// [ PART 5 ]
// Detail Process Event 정의 ( User Define function )
// 사용자 정의 함수는 ufn_xxxx() 형태로 작성 
//=========================================================================================

/********************************************************************************
* 기      능   : 환경변수/전역변수 등을 출력한다.
********************************************************************************/
function SHOW_ENV()
{
	var strDate = GetDate();
	strDate = Mid(strDate,0,4) + "/" + Mid(strDate,4,2) + "/" + Mid(strDate,6,2) + " " + 
	          Mid(strDate,8,2) + ":" + Mid(strDate,10,2) + ":" + Mid(strDate,12,2);

	Trace("-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= Startup  Information =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-");
	Trace("Program ID : " + this.title);
	Trace("Start Date & Time : " + strDate);
	Trace("-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= Global Variables =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-");
	Trace("G_AREA_CODE:사무소 코드/지역 코드) is [" + G_AREA_CODE + "]");
	Trace("G_AREA_CODE_B:영업지사 코드/영업지역 코드) is [" + G_AREA_CODE_B + "]");
	Trace("G_AREA_CODE_E:설치사무소 코드/설치지역 코드) is [" + G_AREA_CODE_E + "]");
	Trace("G_AREA_CODE_R:보수사무소 코드/보수지역 코드) is [" + G_AREA_CODE_R + "]");
	Trace("G_AREA_NAME:지역명/업체지역명) is [" + G_AREA_NAME + "]");
	Trace("G_CURR_DATE:현재시간/현재일자) is [" + G_CURR_DATE + "]");
	Trace("G_DPT1:부서코드/부서코드) is [" + G_DPT1 + "]");
	Trace("G_EMAIL:전자우편 주소/EMAIL) is [" + G_EMAIL + "]");
	Trace("G_EXPR_DATE:비밀번호 만료 일자 /만료일자) is [" + G_EXPR_DATE + "]");
	Trace("G_LANG:사용 언어/사용자 LANG(ko-한국, zh-중국, en-영문) ) is [" + G_LANG + "]");
	Trace("G_LGORT:저장위치/업체-저장위치) is [" + G_LGORT + "]");
	Trace("G_LOGIN_TIME:로그인 시간/현재시간(?)) is [" + G_LOGIN_TIME + "]");
	Trace("G_LOGOUT:로그아웃 구분(1:정상, 0:오류)/) is [" + G_LOGOUT + "]");
	Trace("G_MANDT:Mandt 설정 /SAP CLIENT) is [" + G_MANDT + "]");
	Trace("G_ORG_USER_INFO:원 사용자 ID/사용자 변경시 원 정보 저장) is [" + G_ORG_USER_INFO + "]");
	Trace("G_ORG_VEND_CODE:사원 변경시 사용/업체코드2(현대 ELV) 사용자인 경우)) is [" + G_ORG_VEND_CODE + "]");
	Trace("G_ORG_VEND_CODE_B:사원 변경시 사용/업체코드2(현대 ELV) 사용자인 경우)) is [" + G_ORG_VEND_CODE_B + "]");
	Trace("G_ORG_VEND_CODE_E:사원 변경시 사용/업체코드2(현대 ELV) 사용자인 경우)) is [" + G_ORG_VEND_CODE_E + "]");
	Trace("G_ORG_VEND_CODE_M:사원 변경시 사용/업체코드2(현대 ELV) 사용자인 경우)) is [" + G_ORG_VEND_CODE_M + "]");
	Trace("G_ORG_VEND_CODE_R:사원 변경시 사용/업체코드2(현대 ELV) 사용자인 경우)) is [" + G_ORG_VEND_CODE_R + "]");
	Trace("G_SAP_USER_ID:/) is [" + G_SAP_USER_ID + "]");
	Trace("G_SAP_USER_NAME:/) is [" + G_SAP_USER_NAME + "]");
	Trace("G_SAP_USER_PM_B:PM(영업)/PM(영업)) is [" + G_SAP_USER_PM_B + "]");
	Trace("G_SAP_USER_PM_R:PM(보수)/) is [" + G_SAP_USER_PM_R + "]");
	Trace("G_SAP_USER_PMNM_B:PM명(영업)/PM명(영업)) is [" + G_SAP_USER_PMNM_B + "]");
	Trace("G_SAP_USER_PMNM_R:PM명(보수)/) is [" + G_SAP_USER_PMNM_R + "]");
	Trace("G_SAP_USER_VBCD:SAP 부서코드/SAP용 부서코드) is [" + G_SAP_USER_VBCD + "]");
	Trace("G_SAP_USER_VBNM:SAP 부서명/SAP용 부서명) is [" + G_SAP_USER_VBNM + "]");
	Trace("G_SAP_USER_VGCD:SAP 팀코드/SAP용 팀코드) is [" + G_SAP_USER_VGCD + "]");
	Trace("G_SAP_USER_VGNM:SAP 팀명  /SAP용 팀명) is [" + G_SAP_USER_VGNM + "]");
	Trace("G_SERVER_URL:서버경로/) is [" + G_SERVER_URL + "]");
	Trace("G_SESSION_ID:세션ID /세션ID) is [" + G_SESSION_ID + "]");
	Trace("G_SYSTEM:시스템 구분 /시스템 구분(D-개발, Q-품질, P-운영)) is [" + G_SYSTEM + "]");
	Trace("G_USERMBPN:H.P/) is [" + G_USERMBPN + "]");
	Trace("G_USERTELE:전화번호/) is [" + G_USERTELE + "]");
	Trace("G_USER_GROUP:권한/사용자 그룹) is [" + G_USER_GROUP + "]");
	Trace("G_USER_GROUP_B:영업권한 /사용자 그룹) is [" + G_USER_GROUP_B + "]");
	Trace("G_USER_GROUP_E:설치권한/사용자 그룹) is [" + G_USER_GROUP_E + "]");
	Trace("G_USER_GROUP_M:자재권한/사용자 그룹) is [" + G_USER_GROUP_M + "]");
	Trace("G_USER_GROUP_R:보수권한/사용자 그룹) is [" + G_USER_GROUP_R + "]");
	Trace("G_USER_ID:사용자 id/사용자 ID) is [" + G_USER_ID + "]");
	Trace("G_USER_NAME:사용자명/사용자 명) is [" + G_USER_NAME + "]");
	Trace("G_VEND_CODE:업체코드/업체코드) is [" + G_VEND_CODE + "]");
	Trace("G_VEND_CODE_B:업체코드(영업)/업체코드(영업)) is [" + G_VEND_CODE_B + "]");
	Trace("G_VEND_CODE_E:업체코드(설치)/업체코드(설치)) is [" + G_VEND_CODE_E + "]");
	Trace("G_VEND_CODE_M:업체코드(자재)/업체코드(자재)) is [" + G_VEND_CODE_M + "]");
	Trace("G_VEND_CODE_R:업체코드(보수)/업체코드(보수)) is [" + G_VEND_CODE_R + "]");
	Trace("G_VEND_NAME:업체명/업체명) is [" + G_VEND_NAME + "]");
	Trace("G_VEND_WGBN:업체구분/업체구분(A:설치협력사, B:보수협력사, C:국내대리점, D:자재협력사, E:해외대리점)) is [" + G_VEND_WGBN + "]");
	Trace("G_WEBGUI_URL:WEB-GUI URL 정보/WEB GUI 정보) is [" + G_WEBGUI_URL + "]");
	Trace("-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-");
}

/********************************************************************************
* 기      능   : 디버그 문자열을 trace로 출력한다.
********************************************************************************/
function DEBUG(srcFunc, outStr)
{
	var outputString = "";

    outputString = "DEBUG " + 
				  this.title + " " + 
				  substr(getDate(), 8, 2) + ":" + 
				  substr(getDate(), 10, 2) + ":" + 
				  substr(getDate(), 12, 2) + ">";
	
	if(DEBUG_FLAG)
	{
		if(outStr.length == 0)
		{	
			outputString += srcFunc;
		}
		else
		{
			outputString += srcFunc + "() - " + outStr;
		}
	
		trace(outputString);
	}
}

/********************************************************************************
* 기      능   : Null여부 확인 gfn_isNull을 Status에서 Alert방식으로 바꿈(팝업이므로 메세지창이 없음)
********************************************************************************/
function ufn_isNull(chkObj, isShowMsg, lbTxt, focusObj) {
	if( length( chkObj.value) > 0 ) {
		return false;
	}

	if( isShowMsg ) {
		// 메시지 처리
		if( length( lbTxt) == 0 ) {
			// 필수 입력항목 입니다. 확인하여 주십시오.
			gfn_showAlert("CW00002");
		} else {
			// lbTxt + " 항목에 값이 누락되어 있습니다. 확인하여 주십시오."
			gfn_showAlert("CW00001", lbTxt);
		}
	}

	if( focusObj == null ) {
		focusObj = chkObj;
	}

	focusObj.setFocus();
	return true;
}

/********************************************************************************
* 기      능   : 그리드를 초기화한다.
********************************************************************************/
function ufn_clearGrid()
{
	gfn_clearGridSortMark(grd_list_master); 
	gfn_clearGridSortMark(grd_list_detail);
	ds_list_master.Clear();
	ds_list_detail.Clear();
}

/********************************************************************************
* 기      능   : 검색 조건들을 초기화 한다
********************************************************************************/
function ufn_initSearchParameters()
{
	//검색조건 Combo Initialize	
	var codeArr = ["CS182"];
    var dsObjArr = [ds_ctp_cd];
    var addTypeArr = [G_CODE_NONE];
    gfn_searchCommCode(codeArr, dsObjArr, addTypeArr,true);


	cb_stat.Index = 0;
	cb_gubun.Index = 0;
	
	var currYear = left(today(), 4);
	cal_to.Value = today();
	cal_from.Value = today();
	//cal_from.Value = gfn_getBeforeDate(cal_to.Value, 7);
}

//=========================================================================================
// [ PART 6 ]
// component Event 정의 : 각 Component 별 이벤트 
//=========================================================================================
/********************************************************************************
* 기      능   : 그리드 헤더 클릭시 정렬 처리 
********************************************************************************/
function grd_list_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
{
	if ( nCell == 0 ) {
		// 그리드 표시할 컬럼 선택 
		gfn_selectGridCol(obj);
	} else {
		// 그리드 정렬 처리 
		gfn_sortGrid(obj,nCell);
	}
}

/********************************************************************************
* 기      능   : 데이터셋 값 변경 시 - Flag 처리 
********************************************************************************/
function ds_list_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{
	gfn_changeFlag( obj, strColumnID, nRow, "FLAG" );
}

/********************************************************************************
* 기      능   : 프로젝트번호 검색
********************************************************************************/
function btn_pjt_OnClick(obj)
{
	var arg = "vkgrp=" + quote(G_SAP_USER_VGCD);

	var kunnr = gfn_openPopup("CS9601001A", true, arg);

	if (kunnr != null) {
		ed_pjt.value = kunnr[0];
	}
}

/********************************************************************************
* 기      능   : 견적번호 검색
********************************************************************************/
function bt_qtnum(obj)
{
	var qtnum = gfn_openPopup("CS0101008I", true);

	if (qtnum != null && length(qtnum) >0) {
		ed_qtnum.value = qtnum[0];
	}
}

/********************************************************************************
* 기      능   : 견적작성
********************************************************************************/
function btn_openPopup1(obj)
{
	var arg = "ar_new=true";
	var pop_obj = gfn_openPopup("CS0101008B", true, arg);
	
}

/********************************************************************************
* 기      능   : 수주변경/취소
********************************************************************************/
function btn_openPopup2(obj)
{
	if(ds_list_master.count <= 0 || ds_list_master.currow < 0)
	{
		gfn_showMsg("견적을 선택하신 후 다시 시도해주세요.");
		return;
	}
	
	//==============재청구 결재 진행중일경우 사용못함(2018.07.18)=========
	ds_wbap02.ClearData();
	ds_wbap02_list.ClearData();
	ds_wbap02.AddRow();
	ds_wbap02.SetColumn(0,"DOCNO", ds_list_master.GetColumn(ds_list_master.currow, "DOC3"));
    ds_wbap02.SetColumn(0,"DOCKIND", "14");   
    
	tit_clearActionInfo();
	tit_addSearchActionInfo("cs01:CS0101008A_S4");							
	tit_callService(
        ""
        , ""
        , "ds_wbap02=ds_wbap02"
        , "ds_wbap02_list=ds_wbap02_list"
        , ""
        , ""
        , ""
        , ""
        , true
        );
        
     var rowCount = "";     // 재청구 결재선 카운트
     var draftrjctYn = false;  // 기안 반송여부
     var receiverjctYn = false;  // 수신 반송여부
     
     rowCount = ds_wbap02_list.GetRowCount();
     
     // 재청구 결재정보가 존재하면
     if(rowCount > 0) {
		for(var i = 0; i < rowCount; i++) {
			// 재청구 기안결제 단계이고, 반송상태이면 true
			if(ds_wbap02_list.GetColumn(i, "APPGUBN") == 'S' && ds_wbap02_list.GetColumn(i, "SEQSTAT") == '2') {
				draftrjctYn = true;
			}
			
			// 재청구 수신결제 단계이고, 반송상태이면 true
			if(ds_wbap02_list.GetColumn(i, "APPGUBN") == 'R' && ds_wbap02_list.GetColumn(i, "SEQSTAT") == '2') {
				receiverjctYn = true;
			}
		}
     }
     /*====================아래 로직으로 수정==================================
     if( ds_wbap02_list.GetColumn(0, "APPGUBN") == 'R' && 
         ds_wbap02_list.GetColumn(0, "SEQNO") == ds_wbap02_list.GetColumn(0, "MAX_SEQNO") &&
         ds_wbap02_list.GetColumn(0, "APDATE") > "10000101")
     { 
     }
     ========================================================================*/
     if( ds_wbap02_list.GetColumn(0, "APSTAT") == '6' )
     { 
     }
     
     else
     {  if (ds_wbap02_list.count <= 0)
		{
		}
		else if(draftrjctYn == true || receiverjctYn == true) { // 기안결제 반송 이거나, 수신결재 반송 일때는 수주변경/취소 가능하도록 처리
		                                                        // 20181228 최선경 SW 요청. Han J.H
		} else {
			gfn_showAlert("CW10025", "재청구 기안/수신 결재가 진행중에 있습니다.");
			//gfn_showMsg("재청구 기안/수신 결재가 진행중에 있습니다.");
			return;
		}
     }            
	//====================================================================
	
	
	
    var arg = "ar_qtnum='" + ds_list_master.GetColumn(ds_list_master.currow, "QTNUM") 
			+ "' ar_seq='" + ds_list_master.GetColumn(ds_list_master.currow, "SEQ")
			+ "' ar_upn='" + substr(ds_list_master.GetColumn(ds_list_master.currow, "MA_PSPID"), 0, 6)
			+ "' ar_cst='" + substr(ds_list_master.GetColumn(ds_list_master.currow, "MA_PSPID"), 6) + "'";

	var pop_obj = gfn_openPopup("CS0101008D", true, arg);
}

/********************************************************************************
* 기      능   : 재청구
********************************************************************************/
function btn_openPopup3(obj)
{
	if(ds_list_master.count <= 0 || ds_list_master.currow < 0)
	{
		gfn_showMsg("견적을 선택하신 후 다시 시도해주세요.");
		return;
	}
	
	//재청구시  원청구의 S/O 생성 이후 가능하도록 수정
	if ( length(trim(ds_list_master.GetColumn(ds_list_master.currow, "VBELN"))) == 0 )
	{
		gfn_showAlert("CW10025", "원청구의 S/O 생성 이후에 재청구 가능합니다.");
		return;
	}
	
	
	//==============수주변경/취소 결재 진행중일경우 사용못함(2018.07.18)=========
	for (var i = 0; i < 2; i++)
	{
		ds_wbap02.ClearData();
		ds_wbap02_list.ClearData();
		ds_wbap02.AddRow();
		if ( i == 0 ) // 수주변경
		{
			ds_wbap02.SetColumn(0,"DOCNO", ds_list_master.GetColumn(ds_list_master.currow, "DOC4"));
			ds_wbap02.SetColumn(0,"DOCKIND", "15");   
		}
		else if( i == 1) // 수주취소
		{
			ds_wbap02.SetColumn(0,"DOCNO", ds_list_master.GetColumn(ds_list_master.currow, "DOC5"));
			ds_wbap02.SetColumn(0,"DOCKIND", "20");  		
		}
		
		tit_clearActionInfo();
		tit_addSearchActionInfo("cs01:CS0101008A_S4");							
		tit_callService(
			""
			, ""
			, "ds_wbap02=ds_wbap02"
			, "ds_wbap02_list=ds_wbap02_list"
			, ""
			, ""
			, ""
			, ""
			, true
			);
		
		var rowCount = "";     // 결재선 카운트
		var draftrjctYn = false;  // 기안 반송여부
		var receiverjctYn = false;  // 수신 반송여부
		
		rowCount = ds_wbap02_list.GetRowCount();
				
		// 수주변경/취소 결재정보가 존재하면
		if(rowCount > 0) {
			for(var i = 0; i < rowCount; i++) {
				// 기안결제 단계이고, 반송상태이면 true
				if(ds_wbap02_list.GetColumn(i, "APPGUBN") == 'S' && ds_wbap02_list.GetColumn(i, "SEQSTAT") == '2') {
					draftrjctYn = true;
				}
				
				// 수신결제 단계이고, 반송상태이면 true
				if(ds_wbap02_list.GetColumn(i, "APPGUBN") == 'R' && ds_wbap02_list.GetColumn(i, "SEQSTAT") == '2') {
					receiverjctYn = true;
				}
			}		
		}
		
		/*=============================아래 로직으로 수정================================================
		if( ds_wbap02_list.GetColumn(0, "APPGUBN") == 'R' && 
		    ds_wbap02_list.GetColumn(0, "SEQNO") == ds_wbap02_list.GetColumn(0, "MAX_SEQNO") &&
			//ds_wbap02_list.GetColumn(0, "APDATE") > "10000101"
			// 2018.11.28 수신결재 반송 시 결재차순이 맨 마지막이 아니라도 재청구 가능하도록 수정. J.H Han
			(ds_wbap02_list.GetColumn(0, "APPGUBN") == 'R' && ds_wbap02_list.GetColumn(0, "APDATE") > "10000101" || ds_wbap02_list.GetColumn(1, "APDATE") > "10000101")
		  )
		 { 
		 }
		==============================================================================================*/
		 if( ds_wbap02_list.GetColumn(0, "APSTAT") == '6' )
		 { 
		 }		  
		  
		 
		 else
		 {  if (ds_wbap02_list.count <= 0)
			{
			}
			else if(draftrjctYn == true || receiverjctYn == true) { // 기안결제 반송 이거나, 수신결재 반송 일때는 재청구 가능하도록 처리
		                                                            // 20200826 이상혁 SW 요청. Han J.H
			}
			else
			{
				if ( i == 0 ) gfn_showAlert("CW10025", "수주변경 기안/수신 결재가 진행중에 있습니다."); // 수주변경
				else if ( i == 1 ) gfn_showAlert("CW10025", "수주취소 기안/수신 결재가 진행중에 있습니다."); // 수주취소
				
				return;
			}
		 }        
     }
	//====================================================================	
	
	

	//20150209 리뉴얼 오픈 이전의 재청구 데이터는 자재청구작성 화면에서 재청구 할 수 있도록 유도
	if(ds_list_master.GetColumn(ds_list_master.currow, "CRDAT") <= "20150206")
	{
		//gfn_showAlert("CI30001", "2015년 2월 6일 이전 견적에 대한 재청구는 자재청구 작성 화면에서 수행하시기 바랍니다.");
		gfn_openWin("CS0101001A", "");
		return;
	}

    var arg = "ar_qtnum='" + ds_list_master.GetColumn(ds_list_master.currow, "QTNUM") 
			+ "' ar_seq='" + ds_list_master.GetColumn(ds_list_master.currow, "SEQ")
			+ "' ar_upn='" + substr(ds_list_master.GetColumn(ds_list_master.currow, "MA_PSPID"), 0, 6)
			+ "' ar_cst='" + substr(ds_list_master.GetColumn(ds_list_master.currow, "MA_PSPID"), 6) + "'";

	var pop_obj = gfn_openPopup("CS0101008C", true, arg);
}

/********************************************************************************
* 기      능   : 견적 Detail 정보 표시
********************************************************************************/
function grd_list_master_OnCellPosChanged(obj,nRow,nCell,nOldRow,nOldCell,nPivotIndex,nOldPivotIndex)
{
	ds_list_detail.filter("QTNUM==" + quote(ds_list_master.GetColumn(nRow, "QTNUM")) + " && SEQ==" + quote(ds_list_master.GetColumn(nRow, "SEQ")));
}

/*******************************************************************************
* 기      능   : 버튼 클릭 시 견적 상세 정보 Display
*******************************************************************************/
function btn_viewOffer_OnClick(obj)
{
	if(grd_list_master.CurrentCell == "28") {
		if(ds_list_master.GetColumn(ds_list_master.currow, "ENDYN") == "Y")
		{
			var arg = "";
			arg = "fa_qtnum=" + quote(ds_list_master.GetColumn(ds_list_master.currow, "QTNUM")) + 
				  " fa_seq=" + quote(ds_list_master.GetColumn(ds_list_master.currow, "SEQ")) +
				  " fa_gbn='S'";

			gfn_openPopup2("CS0101008J", true, arg);
		} 
		else
		{
			gfn_showMsg("종료된 견적이 아닙니다.");
			return;
		}
	} else {
		if(ds_list_master.count <= 0 || ds_list_master.currow < 0)
		{
			gfn_showMsg("견적을 선택하신 후 다시 시도해주세요.");
			return;
		}

		var arg = "ar_qtnum='" + ds_list_master.GetColumn(ds_list_master.currow, "QTNUM") 
				+ "' ar_seq='" + ds_list_master.GetColumn(ds_list_master.currow, "SEQ")
				+ "' ar_upn='" + substr(ds_list_master.GetColumn(ds_list_master.currow, "MA_PSPID"), 0, 6)
				+ "' ar_cst='" + substr(ds_list_master.GetColumn(ds_list_master.currow, "MA_PSPID"), 6) + "'";

		var pop_obj = gfn_openPopup("CS0101008B", true, arg);
		
	}
}

/*******************************************************************************
* 기      능   : 더블클릭 시 견적 상세 정보 Display
*******************************************************************************/
function grd_list_master_OnCellDblClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
	btn_viewOffer_OnClick();
}

/*******************************************************************************
* 기      능   : 결재상세정보를 보여준다.
*******************************************************************************/
function btn_wf_stat_OnClick(obj)
{
	var docNo;

	switch (grd_list_master.CurrentCell)
	{
		case 21:
			docNo = ds_list_master.GetColumn(grd_list_master.CurrentRow, "DOC1");
			break;
		case 22:
			docNo = ds_list_master.GetColumn(grd_list_master.CurrentRow, "DOC2");
			break;
		case 23:
			docNo = ds_list_master.GetColumn(grd_list_master.CurrentRow, "DOC3");
			break;
		case 24:
			docNo = ds_list_master.GetColumn(grd_list_master.CurrentRow, "DOC4");
			break;
		case 25:
			docNo = ds_list_master.GetColumn(grd_list_master.CurrentRow, "DOC5");
			break;
		default:
			break;
	}
	
	DEBUG("btn_wf_stat_OnClick", "currentRow is " + grd_list_master.CurrentRow + ", currentCell is " + grd_list_master.CurrentCell + ", docNo is " + docNo);
	
	if(substr(docNo, 0, 2) != "R0")
	{
		return;
	}

	ds_cond.SetColumn(0, "DOCNO", docNo);

	tit_clearActionInfo();														
	tit_addSingleActionInfo("cs01:CS0101008A_S3");								//결재상세정보를 가져온다.
	tit_callService("", "", "ds_cond=ds_cond", "ds_wf_stat=ds_wf_stat", "", "", true, false,true);

	if(ds_wf_stat.rowcount <= 0)
	{
		return;
	}
	
	var statStr = "";
	
	//statStr = "현재상태 : " + grd_list_master.GetCellValue(grd_list_master.CurrentRow, grd_list_master.CurrentCell) + "\n\n";
	         
	for(var iCnt = ds_wf_stat.rowcount - 1; iCnt >= 0; iCnt--)
	{
		statStr += ds_wf_stat.GetColumn(iCnt, "APPGUBNNM") + " / " + 
				   ds_wf_stat.GetColumn(iCnt, "SEQNONM")  + " / " + 
				   ds_wf_stat.GetColumn(iCnt, "SEQSTATNM")  + "\n    " + 
				   ds_wf_stat.GetColumn(iCnt, "APDPT1_N")  + " / " + 
				   ds_wf_stat.GetColumn(iCnt, "APRNK")  + " / " + 
				   ds_wf_stat.GetColumn(iCnt, "APIRUM")  + "\n";				   	
	}
		
	DEBUG("btn_wf_stat_OnClick", "ds_wf_stat is " + ds_wf_stat.SaveXml());
	
	//gfn_showAlert("결재상태", statStr);
	gfn_openMsgWin(statStr, "", "A", docNo + " 결재상태");
}

function btn_end_OnClick(obj)
{
	if(ds_list_master.GetColumn(ds_list_master.currow, "ENDCHK") == "N") {
		gfn_showAlert("종료가 불가능 합니다.\n견적상태를 확인하십시요.");
		return;
	}

	if(ds_list_master.GetColumn(ds_list_master.currow, "ENDYN") == "Y") {
		gfn_showAlert("이미 종료된 견적 입니다.");
		return;
	}

	if(gfn_showConfirm("CI30001", "해당 견적번호[" + ds_list_master.GetColumn(ds_list_master.currow, "QTNUM") + "]를 견적종료 처리 하시겠습니까?"))
	{
		var arg = "";
		arg = "fa_qtnum=" + quote(ds_list_master.GetColumn(ds_list_master.currow, "QTNUM")) + 
		      " fa_seq=" + quote(ds_list_master.GetColumn(ds_list_master.currow, "SEQ")) +
		      " fa_gbn='U'";

		gfn_openPopup2("CS0101008J", true, arg);
	}
}

// 필수조건 체크
function searchValueChk() {
	if(length(trim(ds_cond.GetColumn(0,"PSPID")))) { // Proj.no가 Null값이 아니면
		pspid_yn = true;
	}
	
	if(length(trim(ds_cond.GetColumn(0,"QTNO")))) { // 견적번호가 Null값이 아니면
		qtno_yn = true;
	}
		
	if(length(trim(ds_cond.GetColumn(0,"SONO")))) { // 수주번호가 Null값이 아니면
		sono_yn = true;
	}
			
	if(length(trim(ds_cond.GetColumn(0,"PS_PSPID")))) { // WBS가 Null값이 아니면
		ps_pspid_yn = true;
	}
				
	if(length(trim(ds_cond.GetColumn(0,"CNM")))) { // 작성자가 Null값이 아니면
		cnm_yn = true;
	}
}]]></Script>
</Window>