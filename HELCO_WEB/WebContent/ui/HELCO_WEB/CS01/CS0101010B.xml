<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="568" Id="CS0101010B" Left="8" OnKeyDown="gfn_EnterInForm" OnLoadCompleted="fn_OnLoadCompleted" PidAttrib="7" Title="무상청구결재선등록" Top="8" Ver="1.0" Width="752" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_bwtar">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond">
				<Contents>
					<colinfo id="PJT" size="255" summ="default" type="STRING"/>
					<colinfo id="CUDAT" size="255" summ="default" type="STRING"/>
					<colinfo id="REQNR" size="256" summ="default" type="STRING"/>
					<colinfo id="REQNO" size="256" summ="default" type="STRING"/>
					<colinfo id="KND" size="256" summ="default" type="STRING"/>
					<colinfo id="DNO" size="256" summ="default" type="STRING"/>
					<colinfo id="UPN" size="256" summ="default" type="STRING"/>
					<record>
						<CUDAT></CUDAT>
						<DNO></DNO>
						<KND></KND>
						<PJT></PJT>
						<REQNO></REQNO>
						<REQNR></REQNR>
						<UPN></UPN>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_knd">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE>01</CODE>
						<CODE_NAME>용역</CODE_NAME>
					</record>
					<record>
						<CODE>02</CODE>
						<CODE_NAME>유상공사</CODE_NAME>
					</record>
					<record>
						<CODE>03</CODE>
						<CODE_NAME>POG</CODE_NAME>
					</record>
					<record>
						<CODE>04</CODE>
						<CODE_NAME>PRTS</CODE_NAME>
					</record>
					<record>
						<CODE>05</CODE>
						<CODE_NAME>FM</CODE_NAME>
					</record>
					<record>
						<CODE>06</CODE>
						<CODE_NAME>FRTS</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_head">
				<Contents>
					<colinfo id="CST" size="9" summ="default" type="STRING"/>
					<colinfo id="KND" size="3" summ="default" type="STRING"/>
					<colinfo id="NAM" size="150" summ="default" type="STRING"/>
					<colinfo id="SPT" size="150" summ="default" type="STRING"/>
					<colinfo id="UHJ" size="24" summ="default" type="STRING"/>
					<colinfo id="UMR" size="24" summ="default" type="STRING"/>
					<colinfo id="UPN" size="18" summ="default" type="STRING"/>
					<colinfo id="USD" size="24" summ="default" type="STRING"/>
					<colinfo id="CUDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="YEAR" size="24" summ="default" type="STRING"/>
					<colinfo id="QTNUM" size="256" summ="default" type="STRING"/>
					<colinfo id="REQNR" size="256" summ="default" type="STRING"/>
					<colinfo id="GNO" size="256" summ="default" type="STRING"/>
					<colinfo id="REQNO" size="256" summ="default" type="STRING"/>
					<colinfo id="ADT" size="256" summ="default" type="STRING"/>
					<colinfo id="FMY" size="256" summ="default" type="STRING"/>
					<colinfo id="APSTAT" size="256" summ="default" type="STRING"/>
					<colinfo id="CRDPT1" size="256" summ="default" type="STRING"/>
					<colinfo id="REDPT1" size="256" summ="default" type="STRING"/>
					<colinfo id="LGORT1" size="256" summ="default" type="STRING"/>
					<colinfo id="VKGRP" size="256" summ="default" type="STRING"/>
					<colinfo id="F_CNT" size="8" summ="default" type="STRING"/>
					<colinfo id="REQKIND" size="256" summ="default" type="STRING"/>
					<colinfo id="ACPT_NUM" size="30" summ="default" type="STRING"/>
					<colinfo id="SUM_AMT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list">
				<Contents>
					<colinfo id="BWTAR" size="30" summ="default" type="STRING"/>
					<colinfo id="MAKTX" size="120" summ="default" type="STRING"/>
					<colinfo id="MATNR" size="54" summ="default" type="STRING"/>
					<colinfo id="MEINS" size="9" summ="default" type="STRING"/>
					<colinfo id="MENGE" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="POSID" size="72" summ="default" type="STRING"/>
					<colinfo id="SAMT1" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="SAMT2" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="NETPR" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="SENDAT" size="24" summ="default" type="STRING"/>
					<colinfo id="YEAR" size="24" summ="default" type="STRING"/>
					<colinfo id="TYP" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_glist">
				<Contents>
					<colinfo id="BAM" size="11" type="INT"/>
					<colinfo id="GYM" size="18" type="STRING"/>
					<colinfo id="IY1" size="11" type="INT"/>
					<colinfo id="IY2" size="11" type="INT"/>
					<colinfo id="IY3" size="11" type="INT"/>
					<colinfo id="IY4" size="11" type="INT"/>
					<colinfo id="JYM" size="18" type="STRING"/>
					<colinfo id="SUM" size="11" type="INT"/>
					<colinfo id="YEAR" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Editable="True" Id="ds_kisung">
				<Contents>
					<colinfo id="CHASU" size="24" type="STRING"/>
					<colinfo id="DATE" size="24" type="STRING"/>
					<colinfo id="S_SAMT2" size="22" type="DECIMAL"/>
					<colinfo id="S_NETPR" size="22" type="DECIMAL"/>
					<colinfo id="S_SUM" size="11" type="INT"/>
					<colinfo id="PERCENT" size="256" type="STRING"/>
					<colinfo id="AMT" size="256" type="STRING"/>
					<colinfo id="PSPID" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Editable="True" Id="ds_date">
				<Contents>
					<colinfo id="SDATE" size="256" type="STRING"/>
					<colinfo id="EDATE" size="256" type="STRING"/>
					<colinfo id="A_SDATE" size="256" type="STRING"/>
					<colinfo id="B_SDATE" size="256" type="STRING"/>
					<colinfo id="C_SDATE" size="256" type="STRING"/>
					<colinfo id="D_SDATE" size="256" type="STRING"/>
					<colinfo id="E_SDATE" size="256" type="STRING"/>
					<colinfo id="A_EDATE" size="256" type="STRING"/>
					<colinfo id="B_EDATE" size="256" type="STRING"/>
					<colinfo id="C_EDATE" size="256" type="STRING"/>
					<colinfo id="D_EDATE" size="256" type="STRING"/>
					<colinfo id="E_EDATE" size="256" type="STRING"/>
					<colinfo id="UPN" size="256" type="STRING"/>
					<colinfo id="CST" size="256" type="STRING"/>
					<colinfo id="CHASU" size="256" type="STRING"/>
					<colinfo id="DATE" size="256" type="STRING"/>
					<colinfo id="CHASU_1" size="256" type="STRING"/>
					<colinfo id="GNO" size="256" type="STRING"/>
					<colinfo id="AMT" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Editable="True" Id="ds_list_1">
				<Contents>
					<colinfo id="SAMT2" size="22" type="DECIMAL"/>
					<colinfo id="NETPR" size="22" type="DECIMAL"/>
					<colinfo id="YEAR" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Editable="True" Id="ds_list_a">
				<Contents>
					<colinfo id="BWTAR" size="30" summ="default" type="STRING"/>
					<colinfo id="MAKTX" size="120" summ="default" type="STRING"/>
					<colinfo id="MATNR" size="54" summ="default" type="STRING"/>
					<colinfo id="MEINS" size="9" summ="default" type="STRING"/>
					<colinfo id="MENGE" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="POSID" size="72" summ="default" type="STRING"/>
					<colinfo id="SAMT1" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="SAMT2" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="NETPR" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="SENDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="YEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="REQNR" size="256" summ="default" type="STRING"/>
					<colinfo id="ZCAUSETXT" size="256" summ="default" type="STRING"/>
					<colinfo id="ZCAUSETXT2" size="256" summ="default" type="STRING"/>
					<colinfo id="USERNAME" size="40" summ="default" type="STRING"/>
					<colinfo id="USERMBPN" size="36" summ="default" type="STRING"/>
					<colinfo id="REQKIND" size="3" summ="default" type="STRING"/>
					<colinfo id="TYP" size="256" summ="default" type="STRING"/>
					<colinfo id="AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="GAMT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Editable="True" Id="ds_list_b">
				<Contents>
					<colinfo id="BWTAR" size="30" summ="default" type="STRING"/>
					<colinfo id="MAKTX" size="120" summ="default" type="STRING"/>
					<colinfo id="MATNR" size="54" summ="default" type="STRING"/>
					<colinfo id="MEINS" size="9" summ="default" type="STRING"/>
					<colinfo id="MENGE" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="POSID" size="72" summ="default" type="STRING"/>
					<colinfo id="SAMT1" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="SAMT2" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="NETPR" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="SENDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="YEAR" size="256" summ="default" type="CHAR"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_glist_1">
				<Contents>
					<colinfo id="BAM" size="11" type="INT"/>
					<colinfo id="GYM" size="18" type="STRING"/>
					<colinfo id="IY1" size="11" type="INT"/>
					<colinfo id="IY2" size="11" type="INT"/>
					<colinfo id="IY3" size="11" type="INT"/>
					<colinfo id="IY4" size="11" type="INT"/>
					<colinfo id="JYM" size="18" type="STRING"/>
					<colinfo id="SUM" size="11" type="INT"/>
					<colinfo id="YEAR" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Editable="True" Id="ds_date_1">
				<Contents>
					<colinfo id="SDATE" size="256" type="STRING"/>
					<colinfo id="EDATE" size="256" type="STRING"/>
					<colinfo id="A_SDATE" size="256" type="STRING"/>
					<colinfo id="B_SDATE" size="256" type="STRING"/>
					<colinfo id="C_SDATE" size="256" type="STRING"/>
					<colinfo id="D_SDATE" size="256" type="STRING"/>
					<colinfo id="E_SDATE" size="256" type="STRING"/>
					<colinfo id="A_EDATE" size="256" type="STRING"/>
					<colinfo id="B_EDATE" size="256" type="STRING"/>
					<colinfo id="C_EDATE" size="256" type="STRING"/>
					<colinfo id="D_EDATE" size="256" type="STRING"/>
					<colinfo id="E_EDATE" size="256" type="STRING"/>
					<colinfo id="UPN" size="256" type="STRING"/>
					<colinfo id="CST" size="256" type="STRING"/>
					<colinfo id="CHASU" size="256" type="STRING"/>
					<colinfo id="DATE" size="256" type="STRING"/>
					<colinfo id="A_CHASU" size="256" type="STRING"/>
					<colinfo id="B_CHASU" size="256" type="STRING"/>
					<colinfo id="C_CHASU" size="256" type="STRING"/>
					<colinfo id="D_CHASU" size="256" type="STRING"/>
					<colinfo id="E_CHASU" size="256" type="STRING"/>
					<colinfo id="CHASU_1" size="256" type="STRING"/>
					<colinfo id="YEAR" size="256" type="STRING"/>
					<colinfo id="A_AMT" size="256" type="STRING"/>
					<colinfo id="B_AMT" size="256" type="STRING"/>
					<colinfo id="C_AMT" size="256" type="STRING"/>
					<colinfo id="D_AMT" size="256" type="STRING"/>
					<colinfo id="E_AMT" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_apcond">
				<Contents>
					<colinfo id="DOCKIND" size="3" summ="default" type="STRING"/>
					<colinfo id="DOCNO" size="30" summ="default" type="STRING"/>
					<record>
						<DOCKIND></DOCKIND>
						<DOCNO></DOCNO>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_aplist">
				<Contents>
					<colinfo id="DOCKIND" size="3" summ="default" type="STRING"/>
					<colinfo id="DOCNO" size="30" summ="default" type="STRING"/>
					<colinfo id="MANDT" size="9" summ="default" type="STRING"/>
					<colinfo id="R1DATE" size="24" summ="default" type="STRING"/>
					<colinfo id="R1IRUM" size="60" summ="default" type="STRING"/>
					<colinfo id="R1RNK" size="60" summ="default" type="STRING"/>
					<colinfo id="R2DATE" size="24" summ="default" type="STRING"/>
					<colinfo id="R2IRUM" size="60" summ="default" type="STRING"/>
					<colinfo id="R2RNK" size="60" summ="default" type="STRING"/>
					<colinfo id="R3DATE" size="24" summ="default" type="STRING"/>
					<colinfo id="R3IRUM" size="60" summ="default" type="STRING"/>
					<colinfo id="R3RNK" size="60" summ="default" type="STRING"/>
					<colinfo id="R4DATE" size="24" summ="default" type="STRING"/>
					<colinfo id="R4IRUM" size="60" summ="default" type="STRING"/>
					<colinfo id="R4RNK" size="60" summ="default" type="STRING"/>
					<colinfo id="R5DATE" size="24" summ="default" type="STRING"/>
					<colinfo id="R5IRUM" size="60" summ="default" type="STRING"/>
					<colinfo id="R5RNK" size="60" summ="default" type="STRING"/>
					<colinfo id="S1DATE" size="24" summ="default" type="STRING"/>
					<colinfo id="S1IRUM" size="60" summ="default" type="STRING"/>
					<colinfo id="S1RNK" size="60" summ="default" type="STRING"/>
					<colinfo id="S2DATE" size="24" summ="default" type="STRING"/>
					<colinfo id="S2IRUM" size="60" summ="default" type="STRING"/>
					<colinfo id="S2RNK" size="60" summ="default" type="STRING"/>
					<colinfo id="S3DATE" size="24" summ="default" type="STRING"/>
					<colinfo id="S3IRUM" size="60" summ="default" type="STRING"/>
					<colinfo id="S3RNK" size="60" summ="default" type="STRING"/>
					<colinfo id="S4DATE" size="24" summ="default" type="STRING"/>
					<colinfo id="S4IRUM" size="60" summ="default" type="STRING"/>
					<colinfo id="S4RNK" size="60" summ="default" type="STRING"/>
					<colinfo id="S5DATE" size="24" summ="default" type="STRING"/>
					<colinfo id="S5IRUM" size="60" summ="default" type="STRING"/>
					<colinfo id="S5RNK" size="60" summ="default" type="STRING"/>
					<colinfo id="APDESC" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_apstat">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<colinfo id="DTEXT1" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_decide">
				<Contents>
					<colinfo id="MANDT" size="256" summ="default" type="STRING"/>
					<colinfo id="DOCNO" size="256" summ="default" type="STRING"/>
					<colinfo id="DOCKIND" size="256" summ="default" type="STRING"/>
					<colinfo id="APPGUBN" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQNO" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQSTAT" size="256" summ="default" type="STRING"/>
					<colinfo id="APDPT1" size="256" summ="default" type="STRING"/>
					<colinfo id="APDPT1_N" size="256" summ="default" type="STRING"/>
					<colinfo id="APNUM" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE" size="256" summ="default" type="STRING"/>
					<colinfo id="APTIM" size="256" summ="default" type="STRING"/>
					<colinfo id="APDESC" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_key">
				<Contents>
					<colinfo id="HOGI" size="31" summ="default" type="STRING"/>
					<colinfo id="CHARACTERISTIC" size="256" summ="default" type="STRING"/>
					<colinfo id="VBELN" size="256" summ="default" type="STRING"/>
					<colinfo id="CUOBJ" size="256" summ="default" type="STRING"/>
					<colinfo id="VALUE" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_rcond">
				<Contents>
					<colinfo id="ZPROGRAM" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN" size="256" summ="default" type="STRING"/>
					<record>
						<GBN></GBN>
						<ZPROGRAM></ZPROGRAM>
					</record>
				</Contents>
			</Dataset>
		</Datasets>
		<Div Height="36" Id="div_btn" TabOrder="20" Text="Div0" Url="WB01::CommBtnForm.xml" Width="752">
			<Contents></Contents>
		</Div>
		<Image Height="36" Id="Image1" ImageID="form_bl_title_main" Left="8" TabOrder="1" Top="-1" Width="15"></Image>
		<Shape BKColor="user12" Bottom="72" Height="26" Id="Shape1" Left="8" LineColor="user13" Right="744" TabOrder="3" Top="46" Type="Rectangle" Width="736"></Shape>
		<Static Align="Right" Height="24" Id="Static5" Left="9" Style="sty_lb_form_basic" TabOrder="4" Text="통합프로젝트&#32;" Top="47" VAlign="Middle" Width="92"></Static>
		<Edit BindDataset="ds_head" Border="Flat" Column="UPN" Height="20" Id="ed_upn" Left="103" LeftMargin="4" Readonly="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="6" Top="49" Width="265"></Edit>
		<Static Align="Right" Height="24" Id="Static4" Left="549" Style="sty_lb_form_basic" TabOrder="7" Text="계약&#32;시작일&#32;" Top="47" VAlign="Middle" Width="88"></Static>
		<Calendar BindDataset="ds_head" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="USD" Dateformat="yyyy-MM-dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Enable="FALSE" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_workdt" Left="639" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="5" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="49" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="100"></Calendar>
		<Shape BKColor="user12" Bottom="97" Height="26" Id="Shape2" Left="8" LineColor="user13" Right="744" TabOrder="8" Top="71" Type="Rectangle" Width="736"></Shape>
		<Static Align="Right" Height="24" Id="Static16" Left="9" Style="sty_lb_form_basic" TabOrder="9" Text="현장명&#32;" Top="72" VAlign="Middle" Width="92"></Static>
		<Edit BindDataset="ds_head" Border="Flat" Column="SPT" Height="20" Id="ed_hogi" Left="103" LeftMargin="4" Readonly="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="11" Top="74" Width="265"></Edit>
		<Static Align="Right" Height="24" Id="Static17" Left="549" Style="sty_lb_form_basic" TabOrder="12" Text="계약&#32;만료일&#32;" Top="72" VAlign="Middle" Width="88"></Static>
		<Calendar BindDataset="ds_head" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="UMR" Dateformat="yyyy-MM-dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Enable="FALSE" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_zbosuin" Left="639" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="10" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="74" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="100"></Calendar>
		<Shape BKColor="user12" Bottom="122" Height="26" Id="Shape3" Left="8" LineColor="user13" Right="744" TabOrder="13" Top="96" Type="Rectangle" Width="736"></Shape>
		<Static Align="Right" Height="24" Id="Static19" Left="9" Style="sty_lb_form_basic" TabOrder="14" Text="고객명&#32;" Top="97" VAlign="Middle" Width="92"></Static>
		<Edit BindDataset="ds_head" Border="Flat" Column="NAM" Height="20" Id="ed_lifnr" Left="103" LeftMargin="4" Readonly="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="15" Top="99" Width="265"></Edit>
		<Static Align="Right" Height="24" Id="Static20" Left="549" Style="sty_lb_form_basic" TabOrder="16" Text="계약&#32;개월수&#32;" Top="97" VAlign="Middle" Width="88"></Static>
		<Shape BKColor="user12" Bottom="147" Height="26" Id="Shape4" Left="8" LineColor="user13" Right="744" TabOrder="17" Top="121" Type="Rectangle" Width="736"></Shape>
		<Static Align="Right" Height="24" Id="Static22" Left="9" Style="sty_lb_form_basic" TabOrder="18" Text="계약종류&#32;" Top="122" VAlign="Middle" Width="92"></Static>
		<Grid AreaSelect="TRUE" AutoFitEndLine="Hide" BindDataset="ds_list" BkColor2="default" BoldHead="true" Border="Flat" Bottom="535" CellMoving="TRUE" ColSelect="TRUE" ColSizing="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="371" Id="grd_list" InputPanel="FALSE" Left="8" LineColor="user20" LineType="ExHORZ" OnHeadClick="grd_list_OnHeadClick" Right="744" RowHeight="20" Style="sty_grid" TabOrder="19" TabStop="true" Top="164" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="736">
			<contents>
				<format id="Default">
					<columns>
						<col width="25"/>
						<col width="73"/>
						<col width="52"/>
						<col width="73"/>
						<col width="115"/>
						<col width="70"/>
						<col width="70"/>
						<col width="60"/>
						<col width="35"/>
						<col width="80"/>
						<col width="80"/>
					</columns>
					<head>
						<cell align="center" col="0" display="text" font="굴림,9" text="NO"/>
						<cell align="center" col="1" display="text" font="굴림,9" text="WBS"/>
						<cell col="2" display="text" font="굴림,9" text="기종"/>
						<cell align="center" col="3" display="text" font="굴림,9" text="자재번호"/>
						<cell align="center" col="4" display="text" font="굴림,9" text="자재내역"/>
						<cell align="center" col="5" display="text" font="굴림,9" text="평가유형"/>
						<cell align="center" col="6" display="text" font="굴림,9" text="전송일"/>
						<cell align="center" col="7" display="text" font="굴림,9" text="수량"/>
						<cell align="center" col="8" display="text" font="굴림,9" text="단위"/>
						<cell align="center" col="9" display="text" font="굴림,9" text="자재원가"/>
						<cell align="center" col="10" display="text" font="굴림,9" text="판매단가"/>
					</head>
					<body>
						<cell align="center" bkcolor2="user22" col="0" colid="REQKIND" combocol="CODE" combodataset="ds_reqkind_cd" combotext="CODE_NAME" display="text" expr="currow+1"/>
						<cell align="center" bkcolor2="user22" col="1" colid="POSID" display="text"/>
						<cell col="2" colid="TYP" display="text"/>
						<cell align="center" bkcolor2="user22" col="3" colid="MATNR" display="text"/>
						<cell bkcolor2="user22" col="4" colid="MAKTX" display="text"/>
						<cell align="center" bkcolor2="user22" col="5" colid="BWTAR" combocol="CODE" combodataset="ds_bwtar" combotext="CODE_NAME" display="combo"/>
						<cell align="center" bkcolor2="user22" col="6" colid="SENDAT" display="date"/>
						<cell align="right" bkcolor2="user22" col="7" colid="MENGE" display="text"/>
						<cell align="center" bkcolor2="user22" col="8" colid="MEINS" display="text"/>
						<cell align="right" bkcolor2="user22" col="9" colid="SAMT2" display="null" Mask="###,###"/>
						<cell align="right" bkcolor2="user22" col="10" colid="NETPR" display="number" Mask="###,###"/>
					</body>
					<summary>
						<cell align="center" bkcolor="user25" col="0" color="user26" colspan="9" display="text" text="합&#32;계"/>
						<cell align="right" col="9" display="number" expr='sum(&quot;SAMT2&quot;)'/>
						<cell align="right" col="10" display="number" expr='sum(&quot;NETPR&quot;)'/>
					</summary>
				</format>
			</contents>
		</Grid>
		<Static Color="user5" Font="굴림,10,Bold" Height="20" Id="Static0" Left="28" TabOrder="2" Text="MMPR&#32;조회" Top="8" VAlign="Middle" Width="192"></Static>
		<Static Align="Right" Height="24" Id="Static6" Left="370" Style="sty_lb_form_basic" TabOrder="21" Text="거래선&#32;" Top="47" VAlign="Middle" Width="84"></Static>
		<Edit Align="CENTER" BindDataset="ds_head" Border="Flat" Column="CST" Height="20" Id="ed_cst" Left="456" LeftMargin="4" Readonly="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="22" Top="48" Width="91"></Edit>
		<Combo BindDataset="ds_head" Border="Flat" CodeColumn="CODE" Column="KND" DataColumn="CODE_NAME" Enable="FALSE" Height="20" Id="cb_knd" InnerDataset="ds_knd" Left="102" Style="sty_ipt_form" TabOrder="23" Top="123" Width="100"></Combo>
		<Static Height="20" Id="st_jajae" Left="12" TabOrder="24" Text="※&#32;자재내역" Top="146" VAlign="Middle" Width="84"></Static>
		<Shape BKColor="user12" Bottom="564" Height="26" Id="sh_app" Left="9" LineColor="user13" Right="744" TabOrder="26" Top="538" Type="Rectangle" Visible="FALSE" Width="735"></Shape>
		<Static Align="Right" Height="24" Id="st_app" Left="10" Style="sty_lb_form_basic" TabOrder="27" Text="결재상태&#32;" Top="539" VAlign="Middle" Visible="FALSE" Width="92"></Static>
		<Combo BindDataset="ds_head" Border="Flat" CodeColumn="CODE" Column="APSTAT" DataColumn="DTEXT1" Enable="FALSE" Height="20" Id="cb_apstat" InnerDataset="ds_apstat" Left="103" Style="sty_ipt_search" TabOrder="27" Top="540" Visible="FALSE" Width="116"></Combo>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_app" ImageID="btn_sub_06" Left="648" LeftMargin="12" OnClick="btn_app_OnClick" Style="sty_btn" TabOrder="25" Text="결재선&#32;지정" Top="541" Transparent="TRUE" Visible="FALSE" Width="96"></Button>
		<Edit Align="CENTER" BindDataset="ds_head" Border="Flat" Column="F_CNT" Height="20" Id="ed_fcnt" Left="456" LeftMargin="4" Readonly="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="29" Top="74" Width="91"></Edit>
		<Static Align="Right" Height="24" Id="Static3" Left="370" Style="sty_lb_form_basic" TabOrder="30" Text="유지관리대수&#32;" Top="72" VAlign="Middle" Width="84"></Static>
		<Static Align="Right" Height="24" Id="Static7" Left="370" Style="sty_lb_form_basic" TabOrder="31" Text="유지관리금액&#32;" Top="97" VAlign="Middle" Width="84"></Static>
		<MaskEdit BindDataset="ds_head" Border="Flat" Column="SUM_AMT" Height="20" Id="me_amt" Left="456" Readonly="TRUE" Style="sty_ipt_form" TabOrder="32" Top="99" Width="67"></MaskEdit>
		<MaskEdit BindDataset="ds_head" Border="Flat" Column="YEAR" Height="20" Id="MaskEdit0" Left="640" Readonly="TRUE" Style="sty_ipt_form" TabOrder="33" Top="99" Width="100"></MaskEdit>
		<Static Height="13" Id="Static1" Left="528" TabOrder="34" Text="/대" Top="102" Width="16"></Static>
		<Edit Align="CENTER" Border="Flat" Height="20" Id="ed_reg" Left="416" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="35" Text="(전결규정)" Top="541" Width="229"></Edit>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_pdm" ImageID="btn_sub_04" Left="209" LeftMargin="12" OnClick="btn_pdm_OnClick" Style="sty_btn" TabOrder="36" Text="PDM전송" Top="124" Transparent="TRUE" Width="72"></Button>
	</Form>
	<Script><![CDATA[﻿﻿﻿﻿﻿﻿﻿﻿/*
 ******************************************************************************************
 * 기      능   : 
 * 작  성  자   : 
 * 작성  일자   : 
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
#include "LIB::commons.js";	// 공통 스크립트 
#include "LIB::common_cs.js";	// 서비스 공통 스크립트
//=========================================================================================
// [ PART 1 ]
// Form에서 사용될 전역변수를 선언
// FORM에서 사용되는 전역변수는 대문자로 작성하며, F_XXX 의 형태를 갖도록 한다. 
//=========================================================================================
var vDPT = "";
//=========================================================================================
// [ PART 2 ]
// Form Loading / Unloading 시 작업 정의
//=========================================================================================
function fn_OnLoadCompleted(obj) {
	// Form 로드 이벤트 맨 첫줄에 기술 
	gfn_initForm();

	// 자재번호 설정
	ds_cond.setColumn(0, "PJT",   fa_pjt);				// 통합프로젝트
	ds_cond.setColumn(0, "CUDAT", gfn_getCurrDate());	// 현재일자
    ds_cond.SetColumn(0, "REQNR", fa_reqnr);			// 청구번호
    ds_cond.SetColumn(0, "REQNO", fa_reqno);			// 보수자재관리 청구번호
    ds_cond.SetColumn(0, "KND",  'A');					// 청구종류
	//======동시에 거래선이 2개 인상인경우 정확한 거래선을 기준으로 조회하도록 추가
    if (length(fa_upn) == 9){
		ds_cond.SetColumn(0, "UPN",   fa_upn);					// 청구종류
    }
	//==============================================
    // 자재평가유형, 결재상태
    var codeArr    = ["2","WBAP_STAT"];
    var dsObjArr   = [ds_bwtar,ds_apstat];
    var addTypeArr = [G_CODE_NONE,G_CODE_NONE];
    gfn_searchCommCode(codeArr, dsObjArr, addTypeArr,true);
    
    // 버튼초기화
	div_btn.btn_decide.Enable 	= false;	// 결재버튼
	div_btn.btn_draft.Enable  	= false;	// 기안버튼
	div_btn.btn_sendback.Enable = false;  	// 반송버튼

	//============== 수신부서 결재그룹 체크 ===============================	
	gfn_initDs(ds_rcond, true);
	ds_rcond.SetColumn(0, "ZPROGRAM", "WBAP_DOCKIND");
	ds_rcond.SetColumn(0, "GBN", "01");	
	vDPT = gfn_getAuthDpt(ds_rcond);
	ds_rcond.ClearData();
    //=========================================================    

        
    fn_query();
}
/********************************************************************************
* 기      능   : 공통코드가 조회된 후의 Callback 함수 
********************************************************************************/
function fn_completeInit(sCode, sDsObj, sCodeType) {

}
/********************************************************************************
* 기      능   : form UnloadCompleted 
********************************************************************************/
function fn_OnUnloadCompleted(obj) {
	return gfn_isFormUnload(obj);
}
//=========================================================================================
// [ PART 3 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,form닫기)
//=========================================================================================
/********************************************************************************
* 기      능   : 조회 1
********************************************************************************/
function fn_query() {
	
	ds_head.row = -1;
	ds_head.ClearData();
	
	tit_clearActionInfo();
	tit_addSearchActionInfo("cs01:CS0101010B_S1");	// HEADER 조회
	tit_callService(
        ""
        , ""
        , "ds_cond=ds_cond"
        , "ds_head=ds_head"
        , ""
        , "fn_afterQuery"
        , true);
}


/********************************************************************************
* 기      능   : 닫기  
********************************************************************************/
function fn_close() {
	close();
}
/********************************************************************************
* 기      능   : 액셀  
********************************************************************************/
function fn_excel() {
	//Excel Export 
	gfn_saveToExcel(grd_list, true );
}


//=========================================================================================
// [ PART 4]
// Callback 함수 정의 : callback 함수명은 메인 함수의 fn_xxxx() 에서 xxxx 부분은 fn_afterXXXX()
// 형태가 되도록 작성 
//=========================================================================================
/********************************************************************************
* 기      능   : 조회 Callback  
********************************************************************************/
function fn_afterQuery(errCode, errMsg) {
	
	if(G_USER_ID != "2023687" && G_USER_ID != "2018209" && G_USER_ID != "2025418" && G_USER_ID != "2020882")
	{
		btn_pdm.Visible = false;
	}	
	if( ds_head.rowcount > 0 )
	{
		tit_clearActionInfo();
		tit_addSearchActionInfo("cs01:CS0101010B_S2");
		
		// 결재자조회
	    ds_cond.SetColumn( 0, "DNO", ds_head.GetColumn(0, "REQNO") );
		tit_addSearchActionInfo("cs11:CS1101001B_S9");
		
		tit_callService(
			  ""
			, ""
			, "ds_head=ds_head ds_cond=ds_cond"
			, "ds_list=ds_list ds_decide=ds_decide"
			, ""
			, "fn_afterQuery2"
			, true);

	}
	else
	{
		gfn_showAlert("CW00010");
		if (fa_apcall == null && fa_apcall != "Y")
		{
			close();
		} else {
			btn_app.Visible = true;
		}
	}
} 
/********************************************************************************
* 기      능   : 저장 Callback  
********************************************************************************/
function fn_afterQuery2(errCode, errMsg) {
	
	sh_app.Visible = true;
	cb_apstat.Visible = true;
	st_app.Visible = true;

    // 결재선 등록
    var user_grp = gfn_getUserGroup();
	if(user_grp > "10" || length(G_DPT1) > 0) // 내부직원 작성가능
	{
		sh_app.Visible = true;
		cb_apstat.Visible = true;
		st_app.Visible = true;
		
		// 기안자 접수자는 화면에서 결재선 지정
		//if (parseInt(ds_head.GetColumn(0,"APSTAT")) < 1 || (ds_head.GetColumn(0,"APSTAT") == "3" && ds_head.GetColumn(0,"REDPT1") == G_DPT1))
		if (parseInt(ds_head.GetColumn(0,"APSTAT")) < 1 || (ds_head.GetColumn(0,"APSTAT") == "3" && ds_head.GetColumn(0,"REDPT1") == vDPT))
		{
		    btn_app.Visible = true;
		} else {
			btn_app.Visible = false;
		}

		if(G_USER_ID == "3011038" || G_USER_ID == "2020882" || G_USER_ID == "2028182") { // 윤경환KJ, 이동진SW , 김태한SW 결재선 지정 활성화(내부조직변경)
		    btn_app.Visible = true;
		}

		// 기안진행(1), 수신진행(4) 일때 결재자일때 결재버튼 활성화.
		//alert( 'G_USER_ID:' + G_USER_ID );
		//alert( 'APNUM:' + substr(ds_decide.GetColumn(0, "APNUM"),1) );
		//alert( 'APSTAT:' + ds_head.GetColumn(0, "APSTAT") );
		if( (ds_head.GetColumn(0,"APSTAT") > '0' && ds_head.GetColumn(0,"APSTAT") != '3' && ds_head.GetColumn(0,"APSTAT") < '6') && G_USER_ID == substr(ds_decide.GetColumn(0, "APNUM"),1) ) {
			div_btn.btn_decide.Enable   = true;		// 결재버튼 
			div_btn.btn_sendback.Enable = true;		// 반송버튼
		} else {
			div_btn.btn_decide.Enable = false;		// 결재버튼
			div_btn.btn_sendback.Enable = false;	// 반송버튼
		}
		
		ufn_getApprovalData();
	} 
	else 
	{
		btn_app.Visible = false;
		//보수협력사로 로그인 했을 경우 기안 접수가 가능해야한다.
		if( user_grp == "10" && ds_head.GetColumn(0,"APSTAT") == '0' ) {
			btn_app.Visible 	= true;
			ufn_getApprovalData();
		}
	}
	ufn_setRegulation(ds_list.Sum("SAMT2"));	
}

/********************************************************************************
* 기      능   : 결재 데이터 조회
********************************************************************************/
function ufn_getApprovalData() {

    ds_apcond.SetColumn(0,"DOCNO",   ds_head.GetColumn(0,"REQNO"));
    ds_apcond.SetColumn(0,"DOCKIND", "16");
   
   	tit_clearActionInfo();
	tit_addSearchActionInfo("cs04:CS0401000A_S1");
	tit_callService(
		 ""
		, ""
		, "ds_apcond=ds_apcond"
		, "ds_aplist=ds_aplist"
		, ""
		, ""
        , "");	
}

/********************************************************************************
* 기      능   : 저장 Callback  
********************************************************************************/
function fn_afterQuery3(errCode, errMsg) {
}
/********************************************************************************
* 기      능   : 저장 Callback  
********************************************************************************/
function fn_afterQuery4(errCode, errMsg) {

	
	  
}
//=========================================================================================
// [ PART 5 ]
// Detail Process Event 정의 ( User Define function )
// 사용자 정의 함수는 ufn_xxxx() 형태로 작성 
//=========================================================================================
/********************************************************************************
* 기      능   : 사용자 정의 함수  
********************************************************************************/
function ufn_userfunction() {

}

//=========================================================================================
// [ PART 6 ]
// component Event 정의 : 각 Component 별 이벤트 
//=========================================================================================
/********************************************************************************
* 기      능   : 그리드 헤더 클릭시 정렬 처리 
********************************************************************************/
function grd_list_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
{
	if ( nCell == 0 ) {
		// 그리드 표시할 컬럼 선택 
		gfn_selectGridCol(obj);
	} else {
		// 그리드 정렬 처리 
		gfn_sortGrid(obj,nCell);
	}
}


// function btn_upn_OnClick(obj)
// {
	// var upn= null;
	// upn = gfn_openPopup("CS9601001A", true);

    // if (posid !=null ) {
		// ed_upn.value = upn[0];
		// ed_upn.value = upn[1];
		// fn_query();
    // }
// }

/********************************************************************************
* 기      능   : 액셀  
********************************************************************************/
function fn_excel() {
	// Excel Export 
	//gfn_saveToExcel(grd_list, true );
	gfn_saveToExcel(grd_sum, true );
}

/********************************************************************************
* 기      능   : 출력 1
********************************************************************************/
function fn_print() {
	
	// 자재목록
	ds_list_a.Copy(ds_list);
	
	// 결재정보
	ds_aplist_1.Copy(ds_aplist);
	
	// 계약종류
    var knd_txt = cb_knd.Text;
	
	var	arg  = " fa_knd=" + quote(knd_txt);
	    arg += " fa_upn=" + quote(ed_upn.value);
	    arg += " fa_cst=" + quote(ed_cst.value);
	    arg += " fa_spt=" + quote(ed_hogi.value);
	    arg += " fa_nam=" + quote(ed_lifnr.value);
	if( length(fa_qtnum) > 0 && fa_qtnum != null )
	{
		arg += " fa_qtnum="  + quote(fa_qtnum);
		arg += " fa_lgort1=" + quote(fa_lgort1);
		arg += " fa_vkgrp="  + quote(fa_vkgrp);
	} else
	{
		arg += " fa_qtnum="  + quote(ds_head.GetColumn(0, "QTNUM"));
		arg += " fa_lgort1=" + quote(ds_head.GetColumn(0, "LGORT1"));
		arg += " fa_vkgrp="  + quote(ds_head.GetColumn(0, "VKGRP"));
	}
	
	arg += " fa_usd=" + quote(ds_head.GetColumn(0, "USD"));
	arg += " fa_umr=" + quote(ds_head.GetColumn(0, "UMR"));
	arg += " fa_uhj=" + quote(ds_head.GetColumn(0, "UHJ"));
	arg += " fa_bosu=" + quote(ds_head.GetColumn(0, "ZBOSUIN"));	
	arg += " fa_year=" + quote(ds_head.GetColumn(0, "YEAR"));
	arg += " fa_acpt_num=" + quote(ds_head.GetColumn(0, "ACPT_NUM"));
	arg += " fa_txt="     + quote(ds_list_a.GetColumn(0, "ZCAUSETXT"));
	arg += " fa_txt2="    + quote(ds_list_a.GetColumn(0, "ZCAUSETXT2"));
	arg += " fa_reqkind=" + quote(ds_list_a.GetColumn(0, "REQKIND"));
	arg += " fa_f_cnt="   + quote(ed_fcnt.value);
	arg += " fa_amt="     + quote( gfn_formatComma(me_amt.value,-1) );
	
	//trace(ds_kisung.SaveXML());
	////UbiReport Call
	Dialog("CS01::CS0101020B.xml", arg);		

}

/********************************************************************************
* 기      능   : 그리드 헤더 클릭시 정렬 처리 
********************************************************************************/
function grd_list_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
{
	if ( nCell == 0 ) {
		// 그리드 표시할 컬럼 선택 
		gfn_selectGridCol(obj);
	} else {
		// 그리드 정렬 처리 
		gfn_sortGrid(obj,nCell);
	}
}

// 결재선 지정 POPUP
function btn_app_OnClick(obj)
{
	//btn_app.Enable = false;

	// 처리 데이터 확인
	if ( ds_list.rowCount() < 1 ) {
		// 정보 없음. 
		gfn_showAlert("CW00010");
		return;
	}
	
	// 보수협력사일 경우 기안접수테이블에 insert 한다.
	var user_grp = gfn_getUserGroup();
	if( user_grp == '10' ) {
		alert( '보수협력시일 경우 기안접수테이블에 insert 한다!' );
		return;
	}
	
	
    var appgubn = "S";
	
	if( ds_head.GetColumn(0,"APSTAT") == "3" ) appgubn = "R";
	
	    
    var arg = "fa_docno=" + quote(ds_head.GetColumn(0,"REQNO")) + " fa_dockind=16" + " fa_appgubn=" + quote(appgubn);
    
    if (length(fa_docno) > 0 && fa_apcall == "Y")
    {
		arg = "fa_docno=" + quote(fa_docno) + " fa_dockind=16" + " fa_appgubn=R";
    }

	var returnArgs = gfn_openPopup2("CS0401001A",true, arg);
	if( returnArgs[0] == 'S' ) {
		btn_app.Enable = false;
	}
}

/********************************************************************************
* 기      능   : 결재 15
********************************************************************************/
function fn_decide() {
	var decidertn;   // 결재 팝업 리턴코드
	
	gfn_clearMsgBar();
	
	if( ds_decide.rowCount() < 1 ) {
		return;
	}
	
	//if( !gfn_showConfirm("CI00014", "문서번호 : "+ quote(ds_decide.GetColumn(0,"DOCNO")) + "결재") ) return;
	decidertn = gfn_showConfirm_decide("CI00014", "문서번호 : "+ quote(ds_decide.GetColumn(0,"DOCNO")) + "결재") ;	
	if(decidertn == "C") return; //A : 승인, C : 취소 , W : 의견승인
	
	//----------------------------------------------------------------------
	// 의견 입력 팝업 추가 
	// f팝업 전달 변수 fa_docno : 문서번호 ,fa_dockind : 문서종류 
	// return 값 : rtn_yn (Y:의견입력됨 N:의견입력안됨)
	
	//if(gfn_showConfirm("CW10025","의견을 입력하시겠습니까?") )
	if( decidertn == "W" )    //의견입력 승인시
	{
		var arg = "";
		arg = " fa_docno=" + quote(ds_decide.GetColumn(0,"DOCNO")) +" fa_dockind=" + quote(ds_decide.GetColumn(0,"DOCKIND"));
		var rtn_yn = gfn_openPopup2("CS0401001C", true , arg);
	}
	//alert("rtn_yn:"+rtn_yn);
	// 의견입력 팝업 종료
	//----------------------------------------------------------------------

	// 결재상태변경
	ds_decide.SetColumn(0, "SEQSTAT", "3");
	tit_addMultiActionInfo("cs04:CS0401002A_U2");
 	tit_addMultiActionInfo("cs04:CS0401002A_U3");
	tit_callService(
		  ""
		, ""
		, "ds_list_0=ds_decide"
		, ""
		, ""
		, "fn_afterDecide"
		, true);
}
/********************************************************************************
* 기      능   : 결재 Callback  
********************************************************************************/
function fn_afterDecide(errCode, errMsg) {
	if ( ds_error.rowcount() > 0 ) {
		gfn_showAlert("CE00001");
	} else {
		gfn_showAlert("CI00003");
		div_btn.btn_decide.Enable 	= false;	// 결재버튼
		div_btn.btn_print.Enable  	= false;	// 출력버튼
		div_btn.btn_sendback.Enable = false;  	// 반송버튼
		//parent.fn_query();
		fn_close();
	}
}

/********************************************************************************
* 기      능   : 반송 65
********************************************************************************/
function fn_sendback() {
	var decidertn;   // 결재 팝업 리턴코드

	gfn_clearMsgBar();
	
	if( ds_decide.rowCount() < 1 ) {
		// 승인할 정보 없음. 
		return;
	}
	
	//if( !gfn_showConfirm("CI00014", "문서번호 : "+ quote(ds_decide.GetColumn(0,"DOCNO"))+ "반송") ) return;
	decidertn = gfn_showConfirm_decide("CI00014", "문서번호 : "+ quote(ds_decide.GetColumn(0,"DOCNO"))+ "반송") ;	
	if(decidertn == "C") return; //A : 승인, C : 취소 , W : 의견승인
	
	
	//-===============================해당문서는 의련 입력이 존재하지 않아 추가함========================================
	// 의견 입력 팝업 추가 
	// f팝업 전달 변수 fa_docno : 문서번호 ,fa_dockind : 문서종류 
	// return 값 : rtn_yn (Y:의견입력됨 N:의견입력안됨)
	if( decidertn == "W" )    //의견입력 승인시
	{
		var arg = "";
		arg = " fa_docno=" + quote(ds_decide.GetColumn(0,"DOCNO")) +" fa_dockind=" + quote(ds_decide.GetColumn(0,"DOCKIND"));
		var rtn_yn = gfn_openPopup2("CS0401001C", true , arg);
	}
	//==============================================================================================================
	
	
	tit_clearActionInfo();
	
	// 결재상태변경
	ds_decide.SetColumn(0, "SEQSTAT", "2");
	// 결재정보 관리 - 차순별 결재정보  update(zwbap02)
 	tit_addMultiActionInfo("cs04:CS0401002A_U2");
 	// 현장지원 결재 정보 관리 update(zwbap01)
 	tit_addMultiActionInfo("cs04:CS0401002A_U3");

	tit_callService(
		  ""
		, ""
		, "ds_list_0=ds_decide" 
		, ""
		, ""
		, "fn_afterSendback"
		, true);
}

/********************************************************************************
* 기      능   : 반송 Callback  
********************************************************************************/
function fn_afterSendback(errCode, errMsg) {
	if ( ds_error.rowcount() > 0 ) {
		gfn_showAlert("CE00001");
	} else {
		gfn_showAlert("CI00003");
		div_btn.btn_decide.Enable 	= false;	// 결재버튼
		div_btn.btn_draft.Enable  	= false;	// 기안버튼
		div_btn.btn_print.Enable  	= false;	// 출력버튼
		div_btn.btn_save.Enable   	= false;	// 저장버튼
		div_btn.btn_sendback.Enable = false;  	// 반송버튼
		//parent.fn_query();
		fn_close();
	}
}
/********************************************************************************
* 기      능   : 전결규정 설정	2015.04.21 YAR
********************************************************************************/
function ufn_setRegulation(samt2){
	//해당청구 건 자재원가합계 기준 
	//=====================================2019.03.05 전결규정 변경으로 인한 주석처리=============================================================
	/*if(toNumber(samt2) < 1000000)										//100만 미만
	{
		ed_reg.Text = "부서장 전결";
	}
	else if(toNumber(samt2) >= 1000000 && toNumber(samt2) < 5000000)	//100만 ~ 500만
	{
		ed_reg.Text = "담당 전결";
	}
	else																//500만 이상
	{
		ed_reg.Text = "본부장 전결";
	}*/
	//============================================================================================================================================
	
	//ed_reg.Text = "시행율 변동에 따른 본부장~부문장 전결"; // 2019.03.05 이동진 DL 요청
	ed_reg.Text = "시행율 변동에 따른 담당~본부장 전결"; 
	
	//전결규정
	ed_reg.enable = true;
	ed_reg.color = "gray";
	ed_reg.bkColor = "#E9E9E9";
	ed_reg.readOnly = true;
	ed_reg.ToolTipText = "원가기준 전결규정";
}

function btn_pdm_OnClick(obj)
{
	ds_key.clearData();
	ds_key.AddRow();
	ds_key.SetColumn(0, "HOGI", ds_head.GetColumn(0, "GNO"));
	ds_key.SetColumn(0, "CHARACTERISTIC", 'BSTKD');
	ds_key.SetColumn(0, "VBELN", ds_head.GetColumn(0, "UPN"));
	ds_key.SetColumn(0, "CUOBJ", ds_head.GetColumn(0, "GNO"));
	ds_key.SetColumn(0, "VALUE", ds_head.GetColumn(0, "SPT"));
	
	ds_key.AddRow();
	ds_key.SetColumn(1, "HOGI", ds_head.GetColumn(0, "GNO"));
	ds_key.SetColumn(1, "CHARACTERISTIC", 'MATNR');
	ds_key.SetColumn(1, "VBELN", ds_head.GetColumn(0, "UPN"));
	ds_key.SetColumn(1, "CUOBJ", ds_head.GetColumn(0, "GNO"));
	ds_key.SetColumn(1, "VALUE", 'ETC');

	if (!gfn_showConfirm("CI30001","PDM 전송하시겠습니까?")) return;
	
	tit_clearActionInfo();
	tit_addMultiActionInfo("cs01:CS0101010B_I1");
	tit_addMultiActionInfo("cs01:CS0101010B_I2"); // eai 추가 2019.08.08 j.h

	tit_callService(
        ""
        , ""
        , "ds_key=ds_key"
        , "ds_key=ds_key"
        , ""
        , "fn_afterSave2");

}
]]></Script>
</Window>