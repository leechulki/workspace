<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="516" Id="CS0108002D" Left="8" OnLoadCompleted="fn_OnLoadCompleted" OnUnloadCompleted="fn_OnUnloadCompleted" PidAttrib="7" Title="사양별&#32;템플릿&#32;특성값&#32;지정" Top="8" Ver="1.0" Width="976" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_ctype">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME>-전체-</CODE_NAME>
					</record>
					<record>
						<CODE>EL</CODE>
						<CODE_NAME>엘리베이터</CODE_NAME>
					</record>
					<record>
						<CODE>ES</CODE>
						<CODE_NAME>에스컬레이터</CODE_NAME>
					</record>
					<record>
						<CODE>MW</CODE>
						<CODE_NAME>무빙워크</CODE_NAME>
					</record>
					<record>
						<CODE>AP</CODE>
						<CODE_NAME>주차기</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_match_rslt">
				<Contents>
					<colinfo id="SEQN" size="256" summ="default" type="STRING"/>
					<colinfo id="SENDYSNO" size="256" summ="default" type="STRING"/>
					<colinfo id="ERR_MESSAGE" size="256" summ="default" type="STRING"/>
					<colinfo id="CNM" size="256" summ="default" type="STRING"/>
					<colinfo id="CALCULAT" size="256" summ="default" type="STRING"/>
					<colinfo id="BLOCKNO" size="256" summ="default" type="STRING"/>
					<colinfo id="BLOCKNOSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="TRANS" size="256" summ="default" type="STRING"/>
					<colinfo id="CALCOD" size="256" summ="default" type="STRING"/>
					<colinfo id="CALRESULT" size="256" summ="default" type="STRING"/>
					<colinfo id="COD" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_zcstplms">
				<Contents>
					<colinfo id="MANDT" size="256" summ="default" type="STRING"/>
					<colinfo id="NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="TYPE" size="256" summ="default" type="STRING"/>
					<colinfo id="NAM" size="256" summ="default" type="STRING"/>
					<colinfo id="RMK" size="256" summ="default" type="STRING"/>
					<colinfo id="CUSER" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQN" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list2">
				<Contents>
					<colinfo id="GRP" size="256" summ="default" type="STRING"/>
					<colinfo id="CNM" size="256" summ="default" type="STRING"/>
					<colinfo id="COD" size="256" summ="default" type="STRING"/>
					<colinfo id="KND" size="256" summ="default" type="STRING"/>
					<colinfo id="KNM" size="256" summ="default" type="STRING"/>
					<colinfo id="VBELN" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="NEC" size="256" summ="default" type="STRING"/>
					<colinfo id="CHECK" size="256" summ="default" type="STRING"/>
					<colinfo id="EXP" size="256" summ="default" type="STRING"/>
					<colinfo id="DEF_KND" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="TMPCOD" size="256" summ="default" type="STRING"/>
					<colinfo id="ORGKNM" size="256" summ="default" type="STRING"/>
					<colinfo id="STATUS" size="256" summ="default" type="STRING"/>
					<colinfo id="DUTYVALUE" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_zcstpldt_insert">
				<Contents>
					<colinfo id="MANDT" size="256" summ="default" type="STRING"/>
					<colinfo id="NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="GRP" size="256" summ="default" type="STRING"/>
					<colinfo id="COD" size="256" summ="default" type="STRING"/>
					<colinfo id="VALUE" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_zcstplms_insert">
				<Contents>
					<colinfo id="MANDT" size="256" summ="default" type="STRING"/>
					<colinfo id="NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="TYPE" size="256" summ="default" type="STRING"/>
					<colinfo id="NAM" size="256" summ="default" type="STRING"/>
					<colinfo id="RMK" size="256" summ="default" type="STRING"/>
					<colinfo id="CUSER" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_zcstpldt_update">
				<Contents>
					<colinfo id="MANDT" size="256" summ="default" type="STRING"/>
					<colinfo id="NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="GRP" size="256" summ="default" type="STRING"/>
					<colinfo id="COD" size="256" summ="default" type="STRING"/>
					<colinfo id="VALUE" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_zcstplms_update">
				<Contents>
					<colinfo id="MANDT" size="256" summ="default" type="STRING"/>
					<colinfo id="NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="TYPE" size="256" summ="default" type="STRING"/>
					<colinfo id="NAM" size="256" summ="default" type="STRING"/>
					<colinfo id="RMK" size="256" summ="default" type="STRING"/>
					<colinfo id="CUSER" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond">
				<Contents>
					<colinfo id="MANDT" size="256" summ="default" type="STRING"/>
					<colinfo id="GRP" size="256" summ="default" type="STRING"/>
					<colinfo id="REQNO" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
					<colinfo id="VBELN" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="PARAMTYPE" size="256" summ="default" type="STRING"/>
					<colinfo id="PARAMCTYPE" size="256" summ="default" type="STRING"/>
					<colinfo id="PARAMNCYS" size="256" summ="default" type="STRING"/>
					<colinfo id="MATCHFLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="TRNSYSNO" size="256" summ="default" type="STRING"/>
					<colinfo id="NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="TYPE" size="256" summ="default" type="STRING"/>
					<colinfo id="NAM" size="256" summ="default" type="STRING"/>
					<colinfo id="SRCNUM" size="256" summ="default" type="STRING"/>
					<colinfo id="SRCPOSID" size="256" summ="default" type="STRING"/>
					<colinfo id="PARAMELMM" size="256" summ="default" type="STRING"/>
					<record>
						<GRP></GRP>
						<MANDT></MANDT>
						<MATCHFLAG></MATCHFLAG>
						<NAM></NAM>
						<NUM></NUM>
						<PARAMCTYPE></PARAMCTYPE>
						<PARAMELMM></PARAMELMM>
						<PARAMNCYS></PARAMNCYS>
						<PARAMTYPE></PARAMTYPE>
						<POSID></POSID>
						<REQNO></REQNO>
						<SEQ></SEQ>
						<SRCNUM></SRCNUM>
						<SRCPOSID></SRCPOSID>
						<TRNSYSNO></TRNSYSNO>
						<TYPE></TYPE>
						<VBELN></VBELN>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_duty_rslt">
				<Contents>
					<colinfo id="COD" size="256" summ="default" type="STRING"/>
					<colinfo id="KNM" size="256" summ="default" type="STRING"/>
					<colinfo id="DUTYMSG" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
		</Datasets>
		<Static BKColor="user1" Height="23" Id="reqno1" Left="296" TabOrder="1" Top="576" Visible="FALSE" Width="0"></Static>
		<Static Height="23" Id="chk1" Left="8" TabOrder="2" Top="560" Width="56"></Static>
		<Static Align="Center" BKColor="user1" Height="23" Id="hogi1" Left="8" TabOrder="3" Top="584" Visible="FALSE" Width="0"></Static>
		<Static Align="Center" BKColor="user1" Height="23" Id="vbeln1" Left="528" TabOrder="4" Top="576" Visible="FALSE" Width="0"></Static>
		<Div Height="36" Id="div_btn" Left="-1" TabOrder="5" Text="Div0" Url="WB01::CommBtnForm.xml" Width="977">
			<Contents></Contents>
		</Div>
		<Shape BKColor="user0" Bottom="75" Height="35" Id="Shape1" Left="2" LineColor="user1" Right="968" TabOrder="6" Top="40" Type="Rectangle" Width="966"></Shape>
		<Static Align="Right" Height="20" Id="st_gubun" Left="10" Style="sty_lb_search" TabOrder="7" Text="서비스유형" Top="50" VAlign="Middle" Width="70"></Static>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="CODE" Column="TYPE" DataColumn="CODE_NAME" Height="20" Id="cb_type" INDEX="0" InnerDataset="ds_ctype" Left="80" Style="sty_ipt_form" TabOrder="8" Top="49" Width="120"></Combo>
		<Static Align="Right" Height="20" Id="Static0" Left="202" Style="sty_lb_search" TabOrder="9" Text="템플릿명&#32;" Top="50" VAlign="Middle" Width="70"></Static>
		<Edit BindDataset="ds_cond" Border="Flat" CheckLength="Byte" Column="NAM" Height="20" Id="ed_nam" Left="273" MaxLength="150" Style="sty_ipt_search" TabOrder="10" Top="50" Width="158"></Edit>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_match" ImageID="btn_sub_03" Left="906" LeftMargin="12" OnClick="btn_match_OnClick" Style="sty_btn" TabOrder="12" Text="정합성" Top="50" Transparent="TRUE" Width="60"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="Button0" ImageID="btn_sub_08" Left="643" LeftMargin="12" OnClick="btn_specLoad_OnClick" Style="sty_btn" TabOrder="13" Text="선택사양불러오기" Top="50" Transparent="TRUE" Width="124"></Button>
		<Grid AutoEnter="TRUE" AutoFitEndLine="Hide" BindDataset="ds_zcstplms" BkColor2="default" BoldHead="true" Border="Flat" Bottom="512" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="25" Height="376" Id="grd_zcstplms" InputPanel="FALSE" LineColor="user20" LineType="ExHORZ" OnCellClick="grd_zcstplms_OnCellClick" OnCellPosChanged="grd_zcstplms_OnCellPosChanged" OnHeadClick="grd_list_OnHeadClick" Right="262" RowHeight="20" Style="sty_grid" TabOrder="14" TabStop="true" Top="136" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="262">
			<contents>
				<format id="Default">
					<columns>
						<col width="0"/>
						<col width="27"/>
						<col width="64"/>
						<col width="217"/>
						<col width="289"/>
					</columns>
					<head>
						<cell col="0" display="text"/>
						<cell align="center" col="1" color="user21" display="text" font="굴림,9" text="순번" wordwrap="word"/>
						<cell align="center" col="2" color="user21" display="text" font="굴림,9" text="서비스유형" wordwrap="word"/>
						<cell align="center" col="3" color="user21" display="text" font="굴림,9" text="템플릿명" wordwrap="word"/>
						<cell align="center" col="4" color="user21" display="text" font="굴림,9" text="비고" wordwrap="word"/>
					</head>
					<body>
						<cell align="center" bkcolor2="user22" col="0" display="text" edit="normal"/>
						<cell align="center" bkcolor2="user22" col="1" colid="SEQN" display="text" expandsize="0"/>
						<cell align="left" bkcolor2="user22" col="2" colid="TYPE" combocol="CODE" combodataset="ds_ctype" combotext="CODE_NAME" display="combo" edit="combo"/>
						<cell align="left" bkcolor2="user22" checklength="Byte" col="3" colid="NAM" display="text" edit="normal" expandsize="30" limit="150" Valign="Center"/>
						<cell align="left" bkcolor2="user22" col="4" colid="RMK" display="text" edit="normal" expandsize="30" limit="765" Valign="Center"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Tab Border="Flat" FixedImage="FALSE" Font="굴림,9" Height="425" Id="tab" Left="272" MouseOverColor="user16" OnChanging="Tab_OnChanging" SelColor="user15" SelectFont="굴림,9" Style="sty_tab" TabOrder="11" Top="86" Width="696">
			<Contents>
				<TabPage BorderColor="black" Height="400" Id="EL_MM" ImageEdgeWidth="2" ImageID="tab_main" Left="2" TabOrder="19" Text="0.배차" Top="23" Width="692">
					<Grid AreaSelect="TRUE" AutoEnter="TRUE" AutoFitEndLine="Hide" BindDataset="ds_list2" BkColor2="default" BoldHead="true" Border="Flat" Bottom="401" ColSelect="TRUE" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="25" Height="402" Id="grd_list0" InputPanel="FALSE" Left="-1" LineColor="user20" LineType="ExHORZ" OnCellDBLClick="grd_list_OnCellDblClick" OnChar="grd_list_OnChar" OnHeadClick="grd_list_OnHeadClick" Right="694" RowHeight="20" Style="sty_grid" TabOrder="1" TabStop="true" Top="-1" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="695">
						<contents>
							<format id="Default">
								<columns>
									<col width="0"/>
									<col width="243"/>
									<col width="215"/>
									<col width="0"/>
									<col width="0"/>
									<col width="216"/>
								</columns>
								<head>
									<cell col="0" display="text"/>
									<cell align="center" col="1" color="user21" display="text" domainid="bs.charac" font="굴림,9" text="특성내역" wordwrap="word"/>
									<cell col="2" color="user21" display="text" font="굴림,9" text="특성값" wordwrap="word"/>
									<cell col="3" display="text" text="CNT"/>
									<cell col="4" display="text" domainid="bs.value1" font="굴림,9" text="특성값" wordwrap="word"/>
									<cell col="5" color="user21" display="text" font="굴림,9" text="특성값&#32;설명" wordwrap="word"/>
								</head>
								<body>
									<cell align="center" bkcolor2="user22" col="0" display="text" edit="normal"/>
									<cell bkcolor2="user22" col="1" colid="CNM" color="expr:iif(COD&#32;==&#32;&apos;EL_111&apos;,&#32;&apos;RED&apos;,&#32;&apos;null&apos;)" display="combo"/>
									<cell align="left" checklength="Byte" col="2" colid="KNM" display="text" edit="expr:iif(KND&#32;==&#32;&apos;KEYIN&apos;&#32;OR&#32;KND&#32;==&#32;&apos;KEY&#32;IN&apos;,&#32;&apos;NORMAL&apos;,&#32;&apos;null&apos;)" limit="30"/>
									<cell col="3" colid="CNT" display="text"/>
									<cell align="left" checklength="Byte" col="4" colid="KND" display="text" edit="expr:iif(CNM&#32;==&#32;&apos;KEYIN&apos;,&#32;&apos;normal&apos;,&#32;&apos;null&apos;)" limit="30"/>
									<cell align="left" checklength="Byte" col="5" colid="EXP" display="text" limit="30"/>
								</body>
							</format>
						</contents>
					</Grid>
				</TabPage>
				<TabPage BorderColor="black" Height="400" Id="EL_CHANGE" ImageEdgeWidth="2" ImageID="tab_main" Left="2" TabOrder="32" Text="교체항목LIST(F)" Top="23" Width="692">
					<Grid AreaSelect="TRUE" AutoEnter="TRUE" AutoFitEndLine="Hide" BindDataset="ds_list2" BkColor2="default" BoldHead="true" Border="Flat" Bottom="401" ColSelect="TRUE" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="25" Height="402" Id="grd_list7" InputPanel="FALSE" Left="-1" LineColor="user20" LineType="ExHORZ" OnCellDBLClick="grd_list_OnCellDblClick" OnChar="grd_list_OnChar" OnHeadClick="grd_list_OnHeadClick" Right="694" RowHeight="20" Style="sty_grid" TabOrder="1" TabStop="true" Top="-1" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="695">
						<contents>
							<format id="Default">
								<columns>
									<col width="0"/>
									<col width="243"/>
									<col width="215"/>
									<col width="0"/>
									<col width="0"/>
									<col width="216"/>
								</columns>
								<head>
									<cell col="0" display="text"/>
									<cell align="center" col="1" color="user21" display="text" domainid="bs.charac" font="굴림,9" text="특성내역" wordwrap="word"/>
									<cell col="2" color="user21" display="text" font="굴림,9" text="특성값" wordwrap="word"/>
									<cell col="3" display="text" text="CNT"/>
									<cell col="4" display="text" domainid="bs.value1" font="굴림,9" text="특성값" wordwrap="word"/>
									<cell col="5" color="user21" display="text" font="굴림,9" text="특성값&#32;설명" wordwrap="word"/>
								</head>
								<body>
									<cell align="center" bkcolor2="user22" col="0" display="text" edit="normal"/>
									<cell bkcolor2="user22" col="1" colid="CNM" color="expr:iif(COD&#32;==&#32;&apos;EL_111&apos;,&#32;&apos;RED&apos;,&#32;&apos;null&apos;)" display="combo"/>
									<cell align="left" checklength="Byte" col="2" colid="KNM" display="text" edit="expr:iif(KND&#32;==&#32;&apos;KEYIN&apos;&#32;OR&#32;KND&#32;==&#32;&apos;KEY&#32;IN&apos;,&#32;&apos;NORMAL&apos;,&#32;&apos;null&apos;)" limit="30"/>
									<cell col="3" colid="CNT" display="text"/>
									<cell align="left" checklength="Byte" col="4" colid="KND" display="text" edit="expr:iif(CNM&#32;==&#32;&apos;KEYIN&apos;,&#32;&apos;normal&apos;,&#32;&apos;null&apos;)" limit="30"/>
									<cell align="left" checklength="Byte" col="5" colid="EXP" display="text" limit="30"/>
								</body>
							</format>
						</contents>
					</Grid>
				</TabPage>
				<TabPage BorderColor="black" Height="400" Id="EL_BASIC" ImageEdgeWidth="2" ImageID="tab_main" Left="2" TabOrder="19" Text="A.기본" Top="23" Width="692">
					<Grid AreaSelect="TRUE" AutoEnter="TRUE" AutoFitEndLine="Hide" BindDataset="ds_list2" BkColor2="default" BoldHead="true" Border="Flat" Bottom="401" ColSelect="TRUE" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="25" Height="402" Id="grd_list1" InputPanel="FALSE" Left="-1" LineColor="user20" LineType="ExHORZ" OnCellDBLClick="grd_list_OnCellDblClick" OnChar="grd_list_OnChar" OnHeadClick="grd_list_OnHeadClick" Right="694" RowHeight="20" Style="sty_grid" TabOrder="1" TabStop="true" Top="-1" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="695">
						<contents>
							<format id="Default">
								<columns>
									<col width="0"/>
									<col width="243"/>
									<col width="215"/>
									<col width="0"/>
									<col width="0"/>
									<col width="216"/>
								</columns>
								<head>
									<cell col="0" display="text"/>
									<cell align="center" col="1" color="user21" display="text" domainid="bs.charac" font="굴림,9" text="특성내역" wordwrap="word"/>
									<cell col="2" color="user21" display="text" font="굴림,9" text="특성값" wordwrap="word"/>
									<cell col="3" display="text" text="CNT"/>
									<cell col="4" display="text" domainid="bs.value1" font="굴림,9" text="특성값" wordwrap="word"/>
									<cell col="5" color="user21" display="text" font="굴림,9" text="특성값&#32;설명" wordwrap="word"/>
								</head>
								<body>
									<cell align="center" bkcolor2="user22" col="0" display="text" edit="normal"/>
									<cell bkcolor2="user22" col="1" colid="CNM" color="expr:iif(COD&#32;==&#32;&apos;EL_111&apos;,&#32;&apos;RED&apos;,&#32;&apos;null&apos;)" display="combo"/>
									<cell align="left" checklength="Byte" col="2" colid="KNM" display="text" edit="expr:iif(KND&#32;==&#32;&apos;KEYIN&apos;&#32;OR&#32;KND&#32;==&#32;&apos;KEY&#32;IN&apos;,&#32;&apos;NORMAL&apos;,&#32;&apos;null&apos;)" limit="30"/>
									<cell col="3" colid="CNT" display="text"/>
									<cell align="left" checklength="Byte" col="4" colid="KND" display="text" edit="expr:iif(CNM&#32;==&#32;&apos;KEYIN&apos;,&#32;&apos;normal&apos;,&#32;&apos;null&apos;)" limit="30"/>
									<cell align="left" checklength="Byte" col="5" colid="EXP" display="text" limit="30"/>
								</body>
							</format>
						</contents>
					</Grid>
				</TabPage>
				<TabPage BorderColor="black" Height="400" Id="EL_INSIDE" ImageEdgeWidth="2" ImageID="tab_main" Left="2" TabOrder="26" Text="B.카내의장" Top="23" Width="692">
					<Grid AreaSelect="TRUE" AutoEnter="TRUE" AutoFitEndLine="Hide" BindDataset="ds_list2" BkColor2="default" BoldHead="true" Border="Flat" Bottom="401" ColSelect="TRUE" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="25" Height="402" Id="grd_list2" InputPanel="FALSE" Left="-1" LineColor="user20" LineType="ExHORZ" OnCellDBLClick="grd_list_OnCellDblClick" OnChar="grd_list_OnChar" OnHeadClick="grd_list_OnHeadClick" Right="694" RowHeight="20" Style="sty_grid" TabOrder="1" TabStop="true" Top="-1" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="695">
						<contents>
							<format id="Default">
								<columns>
									<col width="0"/>
									<col width="243"/>
									<col width="215"/>
									<col width="0"/>
									<col width="0"/>
									<col width="216"/>
								</columns>
								<head>
									<cell col="0" display="text"/>
									<cell align="center" col="1" color="user21" display="text" domainid="bs.charac" font="굴림,9" text="특성내역" wordwrap="word"/>
									<cell col="2" color="user21" display="text" font="굴림,9" text="특성값" wordwrap="word"/>
									<cell col="3" display="text" text="CNT"/>
									<cell col="4" display="text" domainid="bs.value1" font="굴림,9" text="특성값" wordwrap="word"/>
									<cell col="5" color="user21" display="text" font="굴림,9" text="특성값&#32;설명" wordwrap="word"/>
								</head>
								<body>
									<cell align="center" bkcolor2="user22" col="0" display="text" edit="normal"/>
									<cell bkcolor2="user22" col="1" colid="CNM" color="expr:iif(COD&#32;==&#32;&apos;EL_111&apos;,&#32;&apos;RED&apos;,&#32;&apos;null&apos;)" display="combo"/>
									<cell align="left" checklength="Byte" col="2" colid="KNM" display="text" edit="expr:iif(KND&#32;==&#32;&apos;KEYIN&apos;&#32;OR&#32;KND&#32;==&#32;&apos;KEY&#32;IN&apos;,&#32;&apos;NORMAL&apos;,&#32;&apos;null&apos;)" limit="30"/>
									<cell col="3" colid="CNT" display="text"/>
									<cell align="left" checklength="Byte" col="4" colid="KND" display="text" edit="expr:iif(CNM&#32;==&#32;&apos;KEYIN&apos;,&#32;&apos;normal&apos;,&#32;&apos;null&apos;)" limit="30"/>
									<cell align="left" checklength="Byte" col="5" colid="EXP" display="text" limit="30"/>
								</body>
							</format>
						</contents>
					</Grid>
				</TabPage>
				<TabPage BorderColor="black" Height="400" Id="EL_OUTSIDE" ImageEdgeWidth="2" ImageID="tab_main" Left="2" TabOrder="31" Text="C.카외의장" Top="23" Width="692">
					<Grid AreaSelect="TRUE" AutoEnter="TRUE" AutoFitEndLine="Hide" BindDataset="ds_list2" BkColor2="default" BoldHead="true" Border="Flat" Bottom="401" ColSelect="TRUE" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="25" Height="402" Id="grd_list3" InputPanel="FALSE" Left="-1" LineColor="user20" LineType="ExHORZ" OnCellDBLClick="grd_list_OnCellDblClick" OnChar="grd_list_OnChar" OnHeadClick="grd_list_OnHeadClick" Right="694" RowHeight="20" Style="sty_grid" TabOrder="1" TabStop="true" Top="-1" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="695">
						<contents>
							<format id="Default">
								<columns>
									<col width="0"/>
									<col width="243"/>
									<col width="215"/>
									<col width="0"/>
									<col width="0"/>
									<col width="216"/>
								</columns>
								<head>
									<cell col="0" display="text"/>
									<cell align="center" col="1" color="user21" display="text" domainid="bs.charac" font="굴림,9" text="특성내역" wordwrap="word"/>
									<cell col="2" color="user21" display="text" font="굴림,9" text="특성값" wordwrap="word"/>
									<cell col="3" display="text" text="CNT"/>
									<cell col="4" display="text" domainid="bs.value1" font="굴림,9" text="특성값" wordwrap="word"/>
									<cell col="5" color="user21" display="text" font="굴림,9" text="특성값&#32;설명" wordwrap="word"/>
								</head>
								<body>
									<cell align="center" bkcolor2="user22" col="0" display="text" edit="normal"/>
									<cell bkcolor2="user22" col="1" colid="CNM" color="expr:iif(COD&#32;==&#32;&apos;EL_111&apos;,&#32;&apos;RED&apos;,&#32;&apos;null&apos;)" display="combo"/>
									<cell align="left" checklength="Byte" col="2" colid="KNM" display="text" edit="expr:iif(KND&#32;==&#32;&apos;KEYIN&apos;&#32;OR&#32;KND&#32;==&#32;&apos;KEY&#32;IN&apos;,&#32;&apos;NORMAL&apos;,&#32;&apos;null&apos;)" limit="30"/>
									<cell col="3" colid="CNT" display="text"/>
									<cell align="left" checklength="Byte" col="4" colid="KND" display="text" edit="expr:iif(CNM&#32;==&#32;&apos;KEYIN&apos;,&#32;&apos;normal&apos;,&#32;&apos;null&apos;)" limit="30"/>
									<cell align="left" checklength="Byte" col="5" colid="EXP" display="text" limit="30"/>
								</body>
							</format>
						</contents>
					</Grid>
				</TabPage>
				<TabPage BorderColor="black" Height="400" Id="EL_OPTION" ImageEdgeWidth="2" ImageID="tab_main" Left="2" TabOrder="32" Text="D.OPTION" Top="23" Width="692">
					<Grid AreaSelect="TRUE" AutoEnter="TRUE" AutoFitEndLine="Hide" BindDataset="ds_list2" BkColor2="default" BoldHead="true" Border="Flat" Bottom="401" ColSelect="TRUE" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="25" Height="402" Id="grd_list4" InputPanel="FALSE" Left="-1" LineColor="user20" LineType="ExHORZ" OnCellDBLClick="grd_list_OnCellDblClick" OnChar="grd_list_OnChar" OnHeadClick="grd_list_OnHeadClick" Right="694" RowHeight="20" Style="sty_grid" TabOrder="1" TabStop="true" Top="-1" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="695">
						<contents>
							<format id="Default">
								<columns>
									<col width="0"/>
									<col width="243"/>
									<col width="215"/>
									<col width="0"/>
									<col width="0"/>
									<col width="216"/>
								</columns>
								<head>
									<cell col="0" display="text"/>
									<cell align="center" col="1" color="user21" display="text" domainid="bs.charac" font="굴림,9" text="특성내역" wordwrap="word"/>
									<cell col="2" color="user21" display="text" font="굴림,9" text="특성값" wordwrap="word"/>
									<cell col="3" display="text" text="CNT"/>
									<cell col="4" display="text" domainid="bs.value1" font="굴림,9" text="특성값" wordwrap="word"/>
									<cell col="5" color="user21" display="text" font="굴림,9" text="특성값&#32;설명" wordwrap="word"/>
								</head>
								<body>
									<cell align="center" bkcolor2="user22" col="0" display="text" edit="normal"/>
									<cell bkcolor2="user22" col="1" colid="CNM" color="expr:iif(COD&#32;==&#32;&apos;EL_111&apos;,&#32;&apos;RED&apos;,&#32;&apos;null&apos;)" display="combo"/>
									<cell align="left" checklength="Byte" col="2" colid="KNM" display="text" edit="expr:iif(KND&#32;==&#32;&apos;KEYIN&apos;&#32;OR&#32;KND&#32;==&#32;&apos;KEY&#32;IN&apos;,&#32;&apos;NORMAL&apos;,&#32;&apos;null&apos;)" limit="30"/>
									<cell col="3" colid="CNT" display="text"/>
									<cell align="left" checklength="Byte" col="4" colid="KND" display="text" edit="expr:iif(CNM&#32;==&#32;&apos;KEYIN&apos;,&#32;&apos;normal&apos;,&#32;&apos;null&apos;)" limit="30"/>
									<cell align="left" checklength="Byte" col="5" colid="EXP" display="text" limit="30"/>
								</body>
							</format>
						</contents>
					</Grid>
				</TabPage>
				<TabPage BorderColor="black" Height="400" Id="EL_LAYOUT" ImageEdgeWidth="2" ImageID="tab_main" Left="2" TabOrder="32" Text="E.LAYOUT" Top="23" Width="692">
					<Grid AreaSelect="TRUE" AutoEnter="TRUE" AutoFitEndLine="Hide" BindDataset="ds_list2" BkColor2="default" BoldHead="true" Border="Flat" Bottom="401" ColSelect="TRUE" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="25" Height="402" Id="grd_list5" InputPanel="FALSE" Left="-1" LineColor="user20" LineType="ExHORZ" OnCellDBLClick="grd_list_OnCellDblClick" OnChar="grd_list_OnChar" OnHeadClick="grd_list_OnHeadClick" Right="694" RowHeight="20" Style="sty_grid" TabOrder="1" TabStop="true" Top="-1" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="695">
						<contents>
							<format id="Default">
								<columns>
									<col width="0"/>
									<col width="243"/>
									<col width="215"/>
									<col width="0"/>
									<col width="0"/>
									<col width="216"/>
								</columns>
								<head>
									<cell col="0" display="text"/>
									<cell align="center" col="1" color="user21" display="text" domainid="bs.charac" font="굴림,9" text="특성내역" wordwrap="word"/>
									<cell col="2" color="user21" display="text" font="굴림,9" text="특성값" wordwrap="word"/>
									<cell col="3" display="text" text="CNT"/>
									<cell col="4" display="text" domainid="bs.value1" font="굴림,9" text="특성값" wordwrap="word"/>
									<cell col="5" color="user21" display="text" font="굴림,9" text="특성값&#32;설명" wordwrap="word"/>
								</head>
								<body>
									<cell align="center" bkcolor2="user22" col="0" display="text" edit="normal"/>
									<cell bkcolor2="user22" col="1" colid="CNM" color="expr:iif(COD&#32;==&#32;&apos;EL_111&apos;,&#32;&apos;RED&apos;,&#32;&apos;null&apos;)" display="combo"/>
									<cell align="left" checklength="Byte" col="2" colid="KNM" display="text" edit="expr:iif(KND&#32;==&#32;&apos;KEYIN&apos;&#32;OR&#32;KND&#32;==&#32;&apos;KEY&#32;IN&apos;,&#32;&apos;NORMAL&apos;,&#32;&apos;null&apos;)" limit="30"/>
									<cell col="3" colid="CNT" display="text"/>
									<cell align="left" checklength="Byte" col="4" colid="KND" display="text" edit="expr:iif(CNM&#32;==&#32;&apos;KEYIN&apos;,&#32;&apos;normal&apos;,&#32;&apos;null&apos;)" limit="30"/>
									<cell align="left" checklength="Byte" col="5" colid="EXP" display="text" limit="30"/>
								</body>
							</format>
						</contents>
					</Grid>
				</TabPage>
				<TabPage BorderColor="black" Height="400" Id="EL_EFH" ImageEdgeWidth="2" ImageID="tab_main" Left="2" TabOrder="32" Text="E.층고" Top="23" Width="692">
					<Grid AreaSelect="TRUE" AutoEnter="TRUE" AutoFitEndLine="Hide" BindDataset="ds_list2" BkColor2="default" BoldHead="true" Border="Flat" Bottom="401" ColSelect="TRUE" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="25" Height="402" Id="grd_list6" InputPanel="FALSE" Left="-1" LineColor="user20" LineType="ExHORZ" OnCellDBLClick="grd_list_OnCellDblClick" OnChar="grd_list_OnChar" OnHeadClick="grd_list_OnHeadClick" Right="694" RowHeight="20" Style="sty_grid" TabOrder="1" TabStop="true" Top="-1" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="695">
						<contents>
							<format id="Default">
								<columns>
									<col width="0"/>
									<col width="243"/>
									<col width="215"/>
									<col width="0"/>
									<col width="0"/>
									<col width="216"/>
								</columns>
								<head>
									<cell col="0" display="text"/>
									<cell align="center" col="1" color="user21" display="text" domainid="bs.charac" font="굴림,9" text="특성내역" wordwrap="word"/>
									<cell col="2" color="user21" display="text" font="굴림,9" text="특성값" wordwrap="word"/>
									<cell col="3" display="text" text="CNT"/>
									<cell col="4" display="text" domainid="bs.value1" font="굴림,9" text="특성값" wordwrap="word"/>
									<cell col="5" color="user21" display="text" font="굴림,9" text="특성값&#32;설명" wordwrap="word"/>
								</head>
								<body>
									<cell align="center" bkcolor2="user22" col="0" display="text" edit="normal"/>
									<cell bkcolor2="user22" col="1" colid="CNM" color="expr:iif(COD&#32;==&#32;&apos;EL_111&apos;,&#32;&apos;RED&apos;,&#32;&apos;null&apos;)" display="combo"/>
									<cell align="left" checklength="Byte" col="2" colid="KNM" display="text" edit="expr:iif(KND&#32;==&#32;&apos;KEYIN&apos;&#32;OR&#32;KND&#32;==&#32;&apos;KEY&#32;IN&apos;,&#32;&apos;NORMAL&apos;,&#32;&apos;null&apos;)" limit="30"/>
									<cell col="3" colid="CNT" display="text"/>
									<cell align="left" checklength="Byte" col="4" colid="KND" display="text" edit="expr:iif(CNM&#32;==&#32;&apos;KEYIN&apos;,&#32;&apos;normal&apos;,&#32;&apos;null&apos;)" limit="30"/>
									<cell align="left" checklength="Byte" col="5" colid="EXP" display="text" limit="30"/>
								</body>
							</format>
						</contents>
					</Grid>
				</TabPage>
				<TabPage BorderColor="black" Height="400" Id="EL_REUSE" ImageEdgeWidth="2" ImageID="tab_main" Left="2" TabOrder="13" Text="D.교체제외항목" Top="23" Width="692">
					<Grid AreaSelect="TRUE" AutoEnter="TRUE" AutoFitEndLine="Hide" BindDataset="ds_list2" BkColor2="default" BoldHead="true" Border="Flat" Bottom="401" ColSelect="TRUE" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="25" Height="402" Id="grd_list8" InputPanel="FALSE" Left="-1" LineColor="user20" LineType="ExHORZ" OnCellDBLClick="grd_list_OnCellDblClick" OnChar="grd_list_OnChar" OnHeadClick="grd_list_OnHeadClick" Right="694" RowHeight="20" Style="sty_grid" TabOrder="1" TabStop="true" Top="-1" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="695">
						<contents>
							<format id="Default">
								<columns>
									<col width="0"/>
									<col width="243"/>
									<col width="215"/>
									<col width="0"/>
									<col width="0"/>
									<col width="216"/>
								</columns>
								<head>
									<cell col="0" display="text"/>
									<cell align="center" col="1" color="user21" display="text" domainid="bs.charac" font="굴림,9" text="특성내역" wordwrap="word"/>
									<cell col="2" color="user21" display="text" font="굴림,9" text="특성값" wordwrap="word"/>
									<cell col="3" display="text" text="CNT"/>
									<cell col="4" display="text" domainid="bs.value1" font="굴림,9" text="특성값" wordwrap="word"/>
									<cell col="5" color="user21" display="text" font="굴림,9" text="특성값&#32;설명" wordwrap="word"/>
								</head>
								<body>
									<cell align="center" bkcolor2="user22" col="0" display="text" edit="normal"/>
									<cell bkcolor2="user22" col="1" colid="CNM" color="expr:iif(COD&#32;==&#32;&apos;EL_111&apos;,&#32;&apos;RED&apos;,&#32;&apos;null&apos;)" display="combo"/>
									<cell align="left" checklength="Byte" col="2" colid="KNM" display="text" edit="expr:iif(KND&#32;==&#32;&apos;KEYIN&apos;&#32;OR&#32;KND&#32;==&#32;&apos;KEY&#32;IN&apos;,&#32;&apos;NORMAL&apos;,&#32;&apos;null&apos;)" limit="30"/>
									<cell col="3" colid="CNT" display="text"/>
									<cell align="left" checklength="Byte" col="4" colid="KND" display="text" edit="expr:iif(CNM&#32;==&#32;&apos;KEYIN&apos;,&#32;&apos;normal&apos;,&#32;&apos;null&apos;)" limit="30"/>
									<cell align="left" checklength="Byte" col="5" colid="EXP" display="text" limit="30"/>
								</body>
							</format>
						</contents>
					</Grid>
				</TabPage>
				<TabPage BorderColor="black" Height="400" Id="MATCH_RSLT" ImageEdgeWidth="2" ImageID="tab_main" Left="2" TabOrder="13" Text="정합성" Top="23" Width="692">
					<Grid AreaSelect="TRUE" AutoEnter="TRUE" AutoFitEndLine="Hide" BindDataset="ds_match_rslt" BkColor2="default" BoldHead="true" Border="Flat" Bottom="401" ColSelect="TRUE" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="25" Height="402" Id="grd_list9" InputPanel="FALSE" Left="-2" LineColor="user20" LineType="ExHORZ" OnHeadClick="grd_list_OnHeadClick" OnMouseOver="tab_MATCH_RSLT_grd_list9_OnMouseOver" Right="693" RowHeight="20" Style="sty_grid" TabOrder="1" TabStop="true" Top="-1" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="695">
						<contents>
							<format id="Default">
								<columns>
									<col width="40"/>
									<col width="180"/>
									<col width="180"/>
									<col width="60"/>
									<col width="250"/>
								</columns>
								<head>
									<cell align="center" col="0" color="user21" display="text" font="굴림,9" text="순번" wordwrap="word"/>
									<cell align="center" col="1" color="user21" display="text" font="굴림,9" text="오류&#32;메세지" wordwrap="word"/>
									<cell align="center" col="2" color="user21" display="text" font="굴림,9" text="특성이름" wordwrap="word"/>
									<cell align="center" col="3" color="user21" display="text" font="굴림,9" text="전송구분" wordwrap="word"/>
									<cell align="center" col="4" color="user21" display="text" font="굴림,9" text="체크값" wordwrap="word"/>
								</head>
								<body>
									<cell align="center" bkcolor2="user22" col="0" colid="SEQN" display="text" suppress="1"/>
									<cell align="left" bkcolor2="user22" col="1" colid="ERR_MESSAGE" display="text" suppress="1"/>
									<cell align="center" bkcolor2="user22" bkimagealign="left" col="2" colid="CNM" display="text"/>
									<cell align="center" bkcolor2="user22" col="3" colid="SENDYSNO" display="text" suppress="1"/>
									<cell align="left" bkcolor2="user22" col="4" colid="CALCULAT" display="text"/>
								</body>
							</format>
						</contents>
					</Grid>
				</TabPage>
			</Contents>
		</Tab>
		<Radio Border="None" Height="16" Id="rd_car_copy" INDEX="0" Left="82" Style="sty_ipt_search_chk" TabOrder="15" Top="100" Width="120">
			<Contents>
				<Layout code="Y" default="true" height="20" left="10" text="예" top="0" width="30"/>
				<Layout code="N" height="20" left="60" text="아니오" top="0" width="60"/>
			</Contents>
		</Radio>
		<Shape BKColor="user0" Bottom="125" Height="35" Id="Shape0" Left="2" LineColor="user1" Right="264" TabOrder="16" Top="90" Type="Rectangle" Width="262"></Shape>
		<Static Align="Right" Height="20" Id="Static1" Left="7" Style="sty_lb_search" TabOrder="17" Text="배차복사&#32;" Top="98" VAlign="Middle" Width="72"></Static>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="Button1" ImageID="btn_sub_04" Left="835" LeftMargin="12" OnClick="btn_checkView_OnClick" Style="sty_btn" TabOrder="18" Text="특성표시" Top="50" Transparent="TRUE" Width="76"></Button>
		<AxMSIE Height="0" Id="AxMSIE0" TitleChange="AxMSIE0_TitleChange" Width="0"></AxMSIE>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_duty" ImageID="btn_sub_03" Left="776" LeftMargin="12" OnClick="btn_duty_OnClick" Style="sty_btn" TabOrder="20" Text="DUTY" Top="50" Transparent="TRUE" Width="60"></Button>
	</Form>
	<Script><![CDATA[/*
 ******************************************************************************************
 * 기      능   : 사양별 템플릿 특성값 지정
 * 작  성  자   : 박수근
 * 작성  일자   : 20116.11.01
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
#include "LIB::commons.js";            // 공통 스크립트
#include "LIB::FormResize_sd.js";    // 공통 스크립트

//=========================================================================================
// [ PART 1 ]
// Form에서 사용될 전역변수를 선언
// FORM에서 사용되는 전역변수는 대문자로 작성하며, F_XXX 의 형태를 갖도록 한다.
//=========================================================================================
var tabindex;
var gRowIndex=-1;
var gChangStat="N";

//=========================================================================================
// [ PART 2 ]
// Form Loading / Unloading 시 작업 정의
//=========================================================================================
function fn_OnLoadCompleted(obj) {
    gfn_initForm();             // Form 로드 이벤트 맨 첫줄에 기술
    fn_init_form();             // 폼 초기화
}

/********************************************************************************
* 기      능   : form UnloadCompleted
********************************************************************************/
function fn_OnUnloadCompleted(obj) {
    return gfn_isFormUnload(obj);
}

/********************************************************************************
* 기      능   : 폼 초기화
********************************************************************************/
function fn_init_form() {
    // 정합성 체크 로직에서 추가된 파라미터 추가 PARAMTYPE, PARAMCTYPE
    ds_cond.SetColumn(0, "MANDT", G_MANDT);
    ds_cond.SetColumn(0, "PARAMTYPE", "EL");
    ds_cond.SetColumn(0, "PARAMCTYPE", "M");

    // 초기값을 조회한다.
    fn_query();
}

/********************************************************************************
* 기      능   : 조회
********************************************************************************/
function fn_query() {
    // 템플릿 리스트 정보를 조회한다.
    ds_cond.SetColumn(0, "TYPE", cb_type.Value);
    ds_cond.SetColumn(0, "NAM", trim(ed_nam.Text));

    ds_zcstplms.ClearData();
    ds_list2.ClearData();

    tit_clearActionInfo();
    tit_addSingleActionInfo("cs01:CS0108002D_S1");
    tit_callService(
          ""
        , ""
        , "ds_cond=ds_cond"
        , "ds_zcstplms=ds_zcstplms"
        , ""
        , "fn_afterQuery"
        , true
        , true
        , false);
}

/********************************************************************************
* 기      능   : 템플릿 사양 조회
********************************************************************************/
function fn_queryDt() {
    // 템플릿 리스트 정보를 조회한다.
    ds_list2.ClearData();
    ds_match_rslt.ClearData();

    tit_clearActionInfo();
    tit_addSingleActionInfo("cs01:CS0108002D_S2");
    tit_callService(
          ""
        , ""
        , "ds_cond=ds_cond"
        , "ds_list2=ds_list2"
        , ""
        , "fn_afterQueryDt"
        , true
        , true
        , false);
}

/********************************************************************************
* 기      능   : 템플릿 사양 조회 Callback
********************************************************************************/
function fn_afterQueryDt(errCode, errMsg) {
    if ( errCode != 0 ) {
        // 에러 메세지를 출력한다.
        gfn_showMsg(errMsg);
    } else {
        tab.TabIndex = 0;
        ds_list2.Filter("GRP == " + quote("EL_MM"));
    }
}

/********************************************************************************
* 기      능   : 입력
********************************************************************************/
function fn_input() {
    var rowType = ds_zcstplms.GetRowType(gRowIndex);
    if( rowType == "insert" )  {
        gfn_openMsgWin("입력 중인 템플릿 사양 마스터 데이터를 저장하십시요", "", "A", "입력");
    } else {
        if( ds_list2.GetUpdate() ) {
            if (gfn_showConfirm("변경된 사양 특성 정보가 있습니다. 저장하시겠습니까?\n취소하시면 입력된 사양 특성 정보는 반영되지 않습니다.")) {
                // 변경된 사양특성 정보를 저장한다.
                fn_save("LIST");
            }
        }
        var rowIndex = ds_zcstplms.AddRow();
        gRowIndex = rowIndex;
        // 기본 사양 특성 내역을 조회한다.
        fn_querySpec();
    }
}

/********************************************************************************
* 기      능   : 삭제
********************************************************************************/
function fn_delete() {
    var rowIndex = ds_zcstplms.rowpos;
    if( rowIndex > -1 ) {
        var rowType = ds_zcstplms.GetRowType(rowIndex);
        if( rowType == "insert" )  {
            ds_zcstplms.DeleteRow(rowIndex);
            ds_list2.ClearData();
            gfn_openMsgWin("삭제 되었습니다.", "", "A", "삭제");
            if( ds_zcstplms.GetRowCount() > 0 ) {
                fn_query();
            }
        } else {
            if (gfn_showConfirm("선택하신 템플릿 사양을 DB에서 삭제하시겠습니까?")) {
                // 템플릿 사양 특성을 삭제한다.
                ds_cond.SetColumn(0, "NUM", ds_zcstplms.GetColumn(rowIndex, "NUM"));
                tit_clearActionInfo();
                tit_addSingleActionInfo("cs01:CS0108002D_D2");
                tit_addSingleActionInfo("cs01:CS0108002D_D1");
                tit_callService(
                      ""
                    , ""
                    , "ds_cond=ds_cond"
                    , "ds_error=ds_error"
                    , ""
                    , "fn_afterDelete"
                    , true
                    , true
                    , true);
            }
        }
    }
}

/********************************************************************************
* 기      능   : 저장
********************************************************************************/
function fn_save() {
    // 데이터 변경여부 체크
    dataChangeStat();

    // 저장에 필요한 데이터 셑을 생성한다.
    if( gChangStat = "Y" || ds_zcstplms.GetUpdate() ) {
        // 템플릿 사양 입력/수정 데이터 셑을 생성한다.
        fn_ZcstpldtSaveData();
        
        if( gfn_showConfirm("CI00008") ) {
            // 저장 로직 처리
            tit_clearActionInfo();
            // 서비스 체크 로직은 별도 Act를 호출하여 처리한다.
            tit_callService(
                  "CS0108002D_ACT"
                , "saveTemplet"
                , "ds_zcstplms_insert=ds_zcstplms_insert ds_zcstpldt_insert=ds_zcstpldt_insert ds_zcstplms_update=ds_zcstplms_update ds_zcstpldt_update=ds_zcstpldt_update"
                , "ds_error=ds_error"
                , ""
                , "fn_afterInsertSave"
                , true
                , true
                , false);
        }
    }
}

/********************************************************************************
* 기      능   : 저장 Callback
********************************************************************************/
function fn_afterInsertSave(errCode, errMsg) {
    if ( errCode != 0 ) {
        gfn_showAlert(errMsg);
    } else {
        gfn_openMsgWin("템플릿 사양이 저장 되었습니다.", "", "A", "저장");
        fn_query();
    }
}

/********************************************************************************
* 기      능   : 특성 저장 데이터 생성
********************************************************************************/
function fn_ZcstpldtSaveData() {
    ds_zcstplms_insert.ClearData();
    ds_zcstpldt_insert.ClearData();
    ds_zcstplms_update.ClearData();
    ds_zcstpldt_update.ClearData();

	var searchRow = ds_list2.SearchRowNF("COD='EL_FCLIST'");
	var EL_FCLIST = ds_list2.GetColumnNF(searchRow, "KNM");
    for(var i=0; i < ds_zcstplms.GetRowCount(); i++ )  {
        if( ds_zcstplms.GetRowType(i) == "insert" ) {
            if( ds_zcstplms.GetColumn(i, "TYPE") == "" ||  ds_zcstplms.GetColumn(i, "TYPE") == null ) {
                gfn_openMsgWin("서비스 유형을 입력하십시요", "", "A", "저장");
                return false;
            }
            if( ds_zcstplms.GetColumn(i, "NAM") == "" || ds_zcstplms.GetColumn(i, "NAM") == null ) {
                gfn_openMsgWin("템플릿명을 입력하십시요", "", "A", "저장");
                return false;
            }
            var rowIndex = ds_zcstplms_insert.AddRow();
            ds_zcstplms_insert.SetColumn(rowIndex, "MANDT", ds_zcstplms.GetColumn(i, "MANDT"));
            ds_zcstplms_insert.SetColumn(rowIndex, "NUM", ds_zcstplms.GetColumn(i, "NUM"));
            ds_zcstplms_insert.SetColumn(rowIndex, "TYPE", ds_zcstplms.GetColumn(i, "TYPE"));
            ds_zcstplms_insert.SetColumn(rowIndex, "NAM", ds_zcstplms.GetColumn(i, "NAM"));
            ds_zcstplms_insert.SetColumn(rowIndex, "RMK", ds_zcstplms.GetColumn(i, "RMK"));
        } else if( ds_zcstplms.GetRowType(i) == "update" ) {
            if( ds_zcstplms.GetColumn(i, "TYPE") == "" ||  ds_zcstplms.GetColumn(i, "TYPE") == null ) {
                gfn_openMsgWin("서비스 유형을 입력하십시요", "", "A", "저장");
                return false;
            }
            if( ds_zcstplms.GetColumn(i, "NAM") == "" || ds_zcstplms.GetColumn(i, "NAM") == null ) {
                gfn_openMsgWin("템플릿명을 입력하십시요", "", "A", "저장");
                return false;
            }
            var rowIndex = ds_zcstplms_update.AddRow();
            ds_zcstplms_update.SetColumn(rowIndex, "MANDT", ds_zcstplms.GetColumn(i, "MANDT"));
            ds_zcstplms_update.SetColumn(rowIndex, "NUM", ds_zcstplms.GetColumn(i, "NUM"));
            ds_zcstplms_update.SetColumn(rowIndex, "TYPE", ds_zcstplms.GetColumn(i, "TYPE"));
            ds_zcstplms_update.SetColumn(rowIndex, "NAM", ds_zcstplms.GetColumn(i, "NAM"));
            ds_zcstplms_update.SetColumn(rowIndex, "RMK", ds_zcstplms.GetColumn(i, "RMK"));
        }
    }

    for(var i=0; i < ds_list2.GetRowCountNF(); i++ )  {
        if( ds_list2.GetColumnNF(i, "SEQ") == "" ||  ds_list2.GetColumnNF(i, "SEQ") == null ) {
            if( EL_FCLIST == "AN" ) {
				var rowIndex = ds_zcstpldt_insert.AddRow();
				ds_zcstpldt_insert.SetColumn(rowIndex, "MANDT", ds_list2.GetColumnNF(i, "MANDT"));
				ds_zcstpldt_insert.SetColumn(rowIndex, "NUM", ds_list2.GetColumnNF(i, "SEQ"));
				ds_zcstpldt_insert.SetColumn(rowIndex, "GRP", ds_list2.GetColumnNF(i, "GRP"));
				ds_zcstpldt_insert.SetColumn(rowIndex, "COD", ds_list2.GetColumnNF(i, "COD"));
				ds_zcstpldt_insert.SetColumn(rowIndex, "VALUE", ds_list2.GetColumnNF(i, "KNM"));
            } else {
                if( ds_list2.GetColumnNF(i, "GRP") != "EL_REUSE" ) {
					var rowIndex = ds_zcstpldt_insert.AddRow();
					ds_zcstpldt_insert.SetColumn(rowIndex, "MANDT", ds_list2.GetColumnNF(i, "MANDT"));
					ds_zcstpldt_insert.SetColumn(rowIndex, "NUM", ds_list2.GetColumnNF(i, "SEQ"));
					ds_zcstpldt_insert.SetColumn(rowIndex, "GRP", ds_list2.GetColumnNF(i, "GRP"));
					ds_zcstpldt_insert.SetColumn(rowIndex, "COD", ds_list2.GetColumnNF(i, "COD"));
					ds_zcstpldt_insert.SetColumn(rowIndex, "VALUE", ds_list2.GetColumnNF(i, "KNM"));
                }
            }
        } else {
			if( EL_FCLIST == "AN" ) {
			    if( ds_list2.GetColumnNF(i, "STATUS") == "U" ) {
					var rowIndex = ds_zcstpldt_update.AddRow();
					ds_zcstpldt_update.SetColumn(rowIndex, "MANDT", ds_list2.GetColumnNF(i, "MANDT"));
					ds_zcstpldt_update.SetColumn(rowIndex, "NUM", ds_list2.GetColumnNF(i, "SEQ"));
					ds_zcstpldt_update.SetColumn(rowIndex, "GRP", ds_list2.GetColumnNF(i, "GRP"));
					ds_zcstpldt_update.SetColumn(rowIndex, "COD", ds_list2.GetColumnNF(i, "COD"));
					ds_zcstpldt_update.SetColumn(rowIndex, "VALUE", ds_list2.GetColumnNF(i, "KNM"));
				}
			} else {
			    if( ds_list2.GetColumnNF(i, "STATUS") == "U" ) {
					if( ds_list2.GetColumnNF(i, "GRP") != "EL_REUSE" ) {
						var rowIndex = ds_zcstpldt_update.AddRow();
						ds_zcstpldt_update.SetColumn(rowIndex, "MANDT", ds_list2.GetColumnNF(i, "MANDT"));
						ds_zcstpldt_update.SetColumn(rowIndex, "NUM", ds_list2.GetColumnNF(i, "SEQ"));
						ds_zcstpldt_update.SetColumn(rowIndex, "GRP", ds_list2.GetColumnNF(i, "GRP"));
						ds_zcstpldt_update.SetColumn(rowIndex, "COD", ds_list2.GetColumnNF(i, "COD"));
						ds_zcstpldt_update.SetColumn(rowIndex, "VALUE", ds_list2.GetColumnNF(i, "KNM"));
					}
			    }

				// AN이 아닌경우 EL_REUSE값은 초기화 하여 저장한다.
				if( ds_list2.GetColumnNF(i, "GRP") == "EL_REUSE" && length(ds_list2.GetColumnNF(i, "KNM")) > 0 ) {
					var rowIndex = ds_zcstpldt_update.AddRow();
					ds_zcstpldt_update.SetColumn(rowIndex, "MANDT", ds_list2.GetColumnNF(i, "MANDT"));
					ds_zcstpldt_update.SetColumn(rowIndex, "NUM", ds_list2.GetColumnNF(i, "SEQ"));
					ds_zcstpldt_update.SetColumn(rowIndex, "GRP", ds_list2.GetColumnNF(i, "GRP"));
					ds_zcstpldt_update.SetColumn(rowIndex, "COD", ds_list2.GetColumnNF(i, "COD"));
					if( ds_list2.GetColumnNF(i, "NUM") == 'Y') {
					    ds_zcstpldt_update.SetColumn(rowIndex, "VALUE", ds_list2.GetColumnNF(i, "0"));
					} else {
					    ds_zcstpldt_update.SetColumn(rowIndex, "VALUE", ds_list2.GetColumnNF(i, ""));
					}        
				}
			}
        }
    }
    
    return true;
}

/********************************************************************************
* 기      능   : 복사
********************************************************************************/
function fn_copy() {
    var rowIndex = ds_zcstplms.rowpos;
    if( rowIndex > -1 ) {
        var carCopyMsg = "";
        if( rd_car_copy.Value == "Y" ) {
            carCopyMsg = "(배차항목 복사 포함)";
        } else {
            carCopyMsg = "(배차항목 복사 제외)";
        }

        if (gfn_showConfirm("복사를 실행하면 작성중인 사양 특성값이 템플릿에 입력된 사양 특성값으로 변경됩니다. 실행하시겠습니까?"+carCopyMsg)) {
            fn_createWait("복사 처리 중 입니다.",this);
            var searchRow, baseCnt = 0, changCnt = 0, notCnt = 0;

            // 부모 사양 특성 그리드 값 로그 출력
            fn_createWait("",this);
            parent.ds_list2.fireevent = false;
            if( rd_car_copy.Value == "Y" ) {
                for(var i=0; i < ds_list2.GetRowCountNF(); i++ )  {
                    baseCnt = baseCnt + 1;
                    var cod = ds_list2.GetColumnNF(i, "COD");
                    var knm = ds_list2.GetColumnNF(i, "KNM");
                    searchRow = parent.ds_list2.SearchRowNF("COD=\""+cod+"\"");
                    if( searchRow > -1 ) {
                        parent.ds_list2.SetColumnNF(searchRow, "KNM", knm);
                        changCnt = changCnt + 1;
                    } else {
                        notCnt = notCnt + 1;
                    }
                }
            } else {
                for(var i=0; i < ds_list2.GetRowCountNF(); i++ )  {
                    baseCnt = baseCnt + 1;
                    if( ds_list2.GetColumnNF(i, "GRP") != "EL_MM" ) {
                        var cod = ds_list2.GetColumnNF(i, "COD");
                        var knm = ds_list2.GetColumnNF(i, "KNM");
                        searchRow = parent.ds_list2.SearchRowNF("COD=\""+cod+"\"");
                        if( searchRow > -1 ) {
                            parent.ds_list2.SetColumnNF(searchRow, "KNM", knm);
                            changCnt = changCnt + 1;
                        } else {
                            notCnt = notCnt + 1;
                        }
                    }
                }
            }
            parent.ds_list2.fireevent = true;
            fn_destroyWait();

            gfn_openMsgWin("사양 복사가 완료 되었습니다.", "", "A", "복사");
            this.close();
        }
    }
}

/********************************************************************************
* 기      능   : 닫기
********************************************************************************/
function fn_close() {
    // 데이터 셑 변경여부 체크
    dataChangeStat();
    if( gChangStat == "Y" || ds_zcstplms.GetUpdate() ) {
        if( gfn_showConfirm("저장처리 없이 종료하시겠습니까?") ) {
            this.close();
        }
    } else {
        this.close();
    }
}

/********************************************************************************
* 기      능   : 조회 Callback
********************************************************************************/
function fn_afterQuery(errCode, errMsg) {
    if ( errCode != 0 ) {
        // 에러 메세지를 출력한다.
        gfn_showAlert(errMsg);
    } else {
        gfn_clearGridSortMark(grd_zcstplms);
        gfn_clearGridSortMark(tab.EL_MM.grd_list0);
        gfn_clearGridSortMark(tab.EL_BASIC.grd_list1);
        gfn_clearGridSortMark(tab.EL_INSIDE.grd_list2);
        gfn_clearGridSortMark(tab.EL_OUTSIDE.grd_list3);
        gfn_clearGridSortMark(tab.EL_OPTION.grd_list4);
        gfn_clearGridSortMark(tab.EL_LAYOUT.grd_list5);
        gfn_clearGridSortMark(tab.EL_EFH.grd_list6);
        gfn_clearGridSortMark(tab.EL_CHANGE.grd_list7);
        gfn_clearGridSortMark(tab.EL_REUSE.grd_list8);
        gfn_clearGridSortMark(tab.MATCH_RSLT.grd_list9);

        if( ds_zcstplms.GetRowCount() > 0 ) {
            // 디테일 검색 조건을 입력한다.
            ds_cond.SetColumn(0, "NUM", ds_zcstplms.GetColumn(0, "NUM"));
            // 템플릿 사양 조회 쿼리를 수행한다.
            gRowIndex = 0;
            fn_queryDt();
        }
    }
}

/********************************************************************************
* 기      능   : 템플릿 사양 삭제 Callback
********************************************************************************/
function fn_afterDelete(errCode, errMsg) {
    if ( errCode != 0 ) {
        // 에러 메세지를 출력한다.
        gfn_showMsg(errMsg);
    } else {
        gfn_openMsgWin("템플릿 사양이 삭제 되었습니다.", "", "A", "삭제");
        fn_query();
    }
}

/********************************************************************************
* 기      능   : 템플릿 마스터 그리드 선택 시
********************************************************************************/
function grd_zcstplms_OnCellClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
    var rowType = ds_zcstplms.GetRowType(gRowIndex);
    if( rowType == "insert" && gRowIndex != nRow )  {
        gfn_openMsgWin("입력 중인 템플릿 사양 마스터 데이터를 저장하십시요", "", "A", "");
    } else {
        // 중복된 로우 요청에 대한 조건 처리
        if( gRowIndex != nRow ) {
            ds_cond.SetColumn(0, "NUM", ds_zcstplms.GetColumn(nRow, "NUM"));
            // 템플릿 사양 특성에 대한 변경된 값이 존재하는 경우 알림 메세지를 표현한다.
			// 변경된 내용을 처리한 후 디테일 사양 조회 쿼리를 수행한다.
			gRowIndex = nRow;
			fn_queryDt();
        }
    }
}

/********************************************************************************
* 기      능   : 템플릿 기본 사양조회
********************************************************************************/
function fn_querySpec() {
    // 템플릿 리스트 정보를 조회한다.
    ds_list2.ClearData();
    tit_clearActionInfo();
    tit_addSingleActionInfo("cs01:CS0108002D_S3");
    tit_callService(
          ""
        , ""
        , "ds_cond=ds_cond"
        , "ds_list2=ds_list2"
        , ""
        , "fn_afterQuerySpec"
        , true
        , true
        , false);
}

/********************************************************************************
* 기      능   : 템플릿 기본 사양 조회 Callback
********************************************************************************/
function fn_afterQuerySpec(errCode, errMsg) {
    if ( errCode != 0 ) {
        // 에러 메세지를 출력한다.
        gfn_showAlert(errMsg);
    } else {
        tab.TabIndex = 0;
    }
}

/********************************************************************************
* 기      능   : 정렬 처리
********************************************************************************/
function grd_list_OnHeadClick(obj,nCell,nX,nY,nPivotIndex) {
    if( nCell == 0 ) gfn_selectAllGrid(obj,nCell,nCell,true);
    else             gfn_sortGrid(obj, nCell);
}

function Tab_OnChanging(obj,nOldIndex,nNewIndex) {
    if(tab.TabIndex = 0)    ds_list2.Filter("GRP == " + quote("EL_MM"));
    if(tab.TabIndex = 1)    ds_list2.Filter("GRP == " + quote("EL_CHANGE"));
    if(tab.TabIndex = 2)    ds_list2.Filter("GRP == " + quote("EL_BASIC"));
    if(tab.TabIndex = 3)    ds_list2.Filter("GRP == " + quote("EL_INSIDE"));
    if(tab.TabIndex = 4)    ds_list2.Filter("GRP == " + quote("EL_OUTSIDE"));
    if(tab.TabIndex = 5)    ds_list2.Filter("GRP == " + quote("EL_OPTION"));
    if(tab.TabIndex = 6)    ds_list2.Filter("GRP == " + quote("EL_LAYOUT"));
    if(tab.TabIndex = 7)    ds_list2.Filter("GRP == " + quote("EL_EFH"));
    if(tab.TabIndex = 8)    ds_list2.Filter("GRP == " + quote("EL_REUSE"));
    if(tab.TabIndex = 9)    ds_list2.Filter("GRP == " + quote("MATCH_RSLT"));
}

/********************************************************************************
* 기      능   : onChar 키 입력 이벤트 시 숫자 입력 여부 체크
********************************************************************************/
function grd_list_OnChar(obj,strPreText,nChar,strPostText,nLLParam,nHLParam,nRow,nCell,nPivotIndex)
{
    // 소수점 . -> nChar 46
    if(ds_list2.GetColumn(nRow, "NUM") == 'Y')              // 숫자필드 예외처리
    {
        if( !isDigit(strPostText) ) {
               ds_list2.fireevent = false;
            ds_list2.SetColumn(nRow, "KNM", "0");
               ds_list2.fireevent = true;
            gfn_showAlert("숫자 타입만 입력 가능합니다.");
            var oldValue = ds_list2.GetOrgColumn(nRow, "KNM");
               ds_list2.fireevent = false;
            ds_list2.SetColumn(nRow, "KNM", oldValue);
               ds_list2.fireevent = true;
        }
    }
}

/********************************************************************************
* 기      능   : 사양특성값 등록 팝업 호출
********************************************************************************/
function grd_list_OnCellDblClick(obj,nRow,nCell,nX,nY,nPivotIndex) {
    //KEYIN 값인 경우 사양별특성값지정Detail 팝업창 비활성화
    if (obj.CurrentCell == '2'){       //'특성값' 필드
        if (ds_list2.getColumn(ds_list2.currow, "KND") == 'KEYIN' or ds_list2.getColumn(ds_list2.currow, "KND") =='KEY IN') return;

        //교체항목은 EL_FCLIST AN 값이 선택되어 있을때만 교체제외항목을 입력할 수 있다.
        var searchRow = ds_list2.SearchRowNF("COD='EL_FCLIST'");
        var EL_FCLIST = ds_list2.GetColumnNF(searchRow, "KNM");
        if( EL_FCLIST <> 'AN' && ds_list2.GetColumn(ds_list2.currow, "GRP") == "EL_REUSE")    
        {
            gfn_openMsgWin("F001 프로젝트 종류가 신규 또는 리모델링 공사인 경우에만 교체제외항목 특성을 등록합니다.", "", "A", "특성값입력");
            return;
        }

        if(ds_list2.getColumn(ds_list2.currow, "COD") == 'EL_ADD1') { // 우편번호 팝업 호출
            ufn_openZipcode();
        }
        else
        {
            var fa_cod = quote(ds_list2.GetColumn(ds_list2.row, "COD"));
            var args = "cod=" + fa_cod;
            gfn_openPopup("CS0108003B", true, args);
        }
    }
}

/********************************************************************************
* 기      능   : 우편번호 검색
********************************************************************************/
var strZipcodeObj;
function ufn_openZipcode(Obj) {
    var arg = "strObj="+quote(Obj.id);
    strZipcodeObj=Obj.id;
    AxMSIE0.Navigate2(G_SERVER_URL + "addressSearchLink.jsp");
}

var chk = 0;
function AxMSIE0_TitleChange(obj,Text) {
    chk++;
    if(Text != "address link") {
        if(chk == 2) {
            ufn_setAddr();
            chk = 1;
        }
    } else {
        chk = 1;
    }
}

function ufn_setAddr() {
    var objDocument = AxMSIE0.Document;

    var roadAddrPart1 = objDocument.getElementById('roadAddrPart1').value;
    var roadAddrPart2 = objDocument.getElementById('roadAddrPart2').value;

    var roadAddr = roadAddrPart1 + ' ' + roadAddrPart2;
    var jibunAddr = objDocument.getElementById('jibunAddr').value;

    var addrDetail = objDocument.getElementById('addrDetail').value;

    var zipNo = objDocument.getElementById('zipNo').value;

    var tmpAddr = roadAddr + ' ' + addrDetail;

    var tmpRow = ds_list2.currow;
    
    ds_list2.SetColumn(tmpRow, "KNM", roadAddr);
    ds_list2.SetColumn(tmpRow+1, "KNM", addrDetail);
}

/********************************************************************************
* 기      능   : 선택 사양 불러오기
********************************************************************************/
function btn_specLoad_OnClick(obj) {
    // 사용자가 등록한 화면상에 존재하는 특성 사양의 값을 템플릿 등록 화면에 불러온다.
    var rowIndex = ds_zcstplms.rowpos;
    if( rowIndex > -1 ) {
        var carCopyMsg = "";
        if( rd_car_copy.Value == "Y" ) {
            carCopyMsg = "(배차항목 복사 포함)";
        } else {
            carCopyMsg = "(배차항목 복사 제외)";
        }

        if (gfn_showConfirm("선택 사양불러오기를 실행하면 현재 입력된 작성된 템플릿 특성 사양 값이 변경됩니다. 실행하시겠습니까?"+carCopyMsg)) {
            fn_createWait("선택 사양불러오기 처리 중 입니다.",this);
            var searchRow, baseCnt = 0, changCnt = 0, notCnt = 0;

            // 부모 사양 특성 그리드 값 로그 출력
            ds_list2.fireevent = false;
            if( rd_car_copy.Value == "Y" ) {
                for(var i=0; i < parent.ds_list2.GetRowCountNF(); i++ )  {
                    baseCnt = baseCnt + 1;
                    var cod = parent.ds_list2.GetColumnNF(i, "COD");
                    var knm = parent.ds_list2.GetColumnNF(i, "KNM");
                    searchRow = ds_list2.SearchRowNF("COD=\""+cod+"\"");
                    if( searchRow > -1 ) {
                        ds_list2.SetColumnNF(searchRow, "KNM", knm);
                        changCnt = changCnt + 1;
                    } else {
                        notCnt = notCnt + 1;
                    }
                }
            } else {
                for(var i=0; i < parent.ds_list2.GetRowCountNF(); i++ )  {
                    baseCnt = baseCnt + 1;
                    if( parent.ds_list2.GetColumnNF(i, "GRP") != "EL_MM" ) {
                        var cod = parent.ds_list2.GetColumnNF(i, "COD");
                        var knm = parent.ds_list2.GetColumnNF(i, "KNM");
                        searchRow = ds_list2.SearchRowNF("COD=\""+cod+"\"");
                        if( searchRow > -1 ) {
                            ds_list2.SetColumnNF(searchRow, "KNM", knm);
                            changCnt = changCnt + 1;
                        } else {
                            notCnt = notCnt + 1;
                        }
                    }
                }
            }

            ds_list2.fireevent = true;
            ds_match_rslt.ClearData();
            tab.TabIndex = 0;
            
            fn_destroyWait();
            gfn_openMsgWin("선택 사양불러오기가 완료 되었습니다.", "", "A", "선택사양불러오기");
        }
    }
}

/********************************************************************************
* 기      능   : 서비스 사양 특성에 대한 정합성 체크 로직을 수행한다.
********************************************************************************/
function btn_match_OnClick(obj)
{
    var rowIndex = ds_zcstplms.rowpos;
    if( rowIndex > -1 ) {
        tit_clearActionInfo();
        ds_list_match.ClearData();
        ds_match_rslt.ClearData();
        ds_list_match.Copy(ds_list2);

        // 서비스 체크 로직은 별도 Act를 호출하여 처리한다.
        tit_callService(
              "CS0108002B_ACT"
            , "specBomMatchCheck"
            , "ds_cond=ds_cond ds_list_match=ds_list_match ds_match_rslt=ds_match_rslt ds_duty_rslt=ds_duty_rslt"
            , "ds_match_rslt=ds_match_rslt ds_duty_rslt=ds_duty_rslt ds_error=ds_error"
            , ""
            , "fn_afterMatch"
            , true
            , true
            , false);
    }
}

/********************************************************************************
* 기      능   : 서비스 사양 특성에 처리 결과
********************************************************************************/
function fn_afterMatch(obj)
{
    gfn_clearGridSortMark(tab.MATCH_RSLT.grd_list9);
    tab.TabIndex = 9;
    // 체크 색깔 원복
    restoreGridColor();
    if( ds_error.GetRowCount() > 0 ) {
        //gfn_showAlert(ds_error.GetColumn(0,"ERRCODE"), ds_error.GetColumn(0,"ERRMSG")+"\n관리자에 문의하십시요");
        gfn_openMsgWin("담당자에 문의하십시요\n"+ds_error.GetColumn(0,"ERRMSG"), "E", "A", ds_error.GetColumn(0,"ERRCODE") );
    } else {
        // grd_matchGrid 전송 불가 건에 대해서 폰트 색깔을 빨강으로 변경    
		tab.MATCH_RSLT.grd_list9.Redraw = false;
		tab.MATCH_RSLT.grd_list9.SetCellProp("body", 0, "color", "expr:iif(SENDYSNO == '전송불가', 'red', '')");
		tab.MATCH_RSLT.grd_list9.SetCellProp("body", 1, "color", "expr:iif(SENDYSNO == '전송불가', 'red', '')");
		tab.MATCH_RSLT.grd_list9.SetCellProp("body", 2, "color", "expr:iif(SENDYSNO == '전송불가', 'red', '')");
		tab.MATCH_RSLT.grd_list9.SetCellProp("body", 3, "color", "expr:iif(SENDYSNO == '전송불가', 'red', '')");
		tab.MATCH_RSLT.grd_list9.SetCellProp("body", 4, "color", "expr:iif(SENDYSNO == '전송불가', 'red', '')");
		tab.MATCH_RSLT.grd_list9.Redraw = true;

        if( ds_match_rslt.GetRowCount() > 0 ) {
            gfn_openMsgWin("정합성 체크 오류 메세지 확인 후 템플릿 입력 사양 특성값을 확인해 주십시요.", "", "A", "정합성");
        } else {
            gfn_openMsgWin("정합성 체크가 완료된 사양 특성값 입니다. 템플릿 사양을 저장하면 됩니다.", "", "A", "정합성");
        }
    }
}

/********************************************************************************
* 기      능   : 툴팁으로 오류 메세지 상세 정보를 표현한다.
********************************************************************************/
function grd_OnMouseOver(obj,nPosX,nPosY,nRow,nCell,nPivotIndex)
{
     var text;
     if(nCell == 0){
         text = ds_match_rslt.GetColumn(nRow, "ERR_MESSAGE");
     } else {
         text = '';
     }
     matchGrid.ToolTipText = text;
}

/********************************************************************************
* 기      능   : 관련 체크된 사양 특성에 대한 그리드 색깔을 변경한다.
********************************************************************************/
function btn_checkView_OnClick(obj)
{
    var seIndex = ds_match_rslt.RowPos;
    var checkSpec = "";

    if( seIndex > -1 )  {
        // 그리드 색깔을 원복 시킨다.
        restoreGridColor();

        // 오류 사양 특성 정보를 추출한다.
        var seqn = ds_match_rslt.GetColumn(seIndex, "SEQN");
        for(var i=0; i < ds_match_rslt.GetRowCount(); i++ )  {
            if( seqn == ds_match_rslt.GetColumn(i, "SEQN") ) {
                if( ds_match_rslt.GetColumn(i, "CALCOD") != null )  {
                    var specArray = Split(ds_match_rslt.GetColumn(i, "CALCOD"), ",");
                    ds_list2.fireevent = false;
                    for(var j=0; j < Length(specArray); j++) {
                        var searchRow = ds_list2.SearchRowNF("COD='"+specArray[j]+"'");
                        ds_list2.SetColumnNF(searchRow, "TMPCOD", specArray[j]);
                    }
                    ds_list2.fireevent = true;
                } else {
                    var checkSpec = ds_match_rslt.GetColumn(i, "COD");
					var searchRow = ds_list2.SearchRowNF("COD='"+checkSpec+"'");
                    ds_list2.fireevent = false;
					ds_list2.SetColumnNF(searchRow, "TMPCOD", checkSpec);
					ds_list2.fireevent = true;
                }
            }
        }
        changeGridColor();
        gfn_openMsgWin("정합성 체크 결과 그리드 순번("+ds_match_rslt.GetColumn(seIndex, "SEQN")+")에 관련된 사양 특성 그리드 색깔이 변경되었습니다.", "", "A", "정합성특성표시");
    } else {
        // 변경된 셀 그리드 색깔을 원래 색깔로 변경한다.
        restoreGridColor();
    }
}

/********************************************************************************
* 기      능   : 그리드 색깔변경
********************************************************************************/
function changeGridColor() {
    var grdArry = [
                  "tab.EL_MM.grd_list0", "tab.EL_BASIC.grd_list1", "tab.EL_INSIDE.grd_list2", "tab.EL_OUTSIDE.grd_list3",
                  "tab.EL_OPTION.grd_list4", "tab.EL_LAYOUT.grd_list5", "tab.EL_EFH.grd_list6", "tab.EL_CHANGE.grd_list7", "tab.EL_REUSE.grd_list8"
                  ];

    for(var i = 0; i < grdArry.length; i++) {
        eval(grdArry[i]).Redraw = false;
        eval(grdArry[i]).SetCellProp("body", 1, "bkColor", "expr:iif(TMPCOD == COD, 'skyblue', '')");
        eval(grdArry[i]).SetCellProp("body", 1, "bkColor2", "expr:iif(TMPCOD == COD, 'skyblue', 'User Color 22')");
        eval(grdArry[i]).SetCellProp("body", 2, "color", "expr:iif(TMPCOD == COD, 'red', '')");
        eval(grdArry[i]).Redraw = true;
    }
}

/********************************************************************************
* 기      능   : 그리드 색깔변경 원복
********************************************************************************/
function restoreGridColor() {
    ds_list2.fireevent = false;
    for(var i=0; i < ds_list2.GetRowCountNF(); i++) {
        ds_list2.SetColumnNF(i, "TMPCOD", "");
    }
    ds_list2.fireevent = true;

    var grdArry = [
                  "tab.EL_MM.grd_list0", "tab.EL_BASIC.grd_list1", "tab.EL_INSIDE.grd_list2", "tab.EL_OUTSIDE.grd_list3",
                  "tab.EL_OPTION.grd_list4", "tab.EL_LAYOUT.grd_list5", "tab.EL_EFH.grd_list6", "tab.EL_CHANGE.grd_list7"
                  ];
    for(var i = 0; i < grdArry.length; i++) {
        eval(grdArry[i]).Redraw = false;
        eval(grdArry[i]).SetCellProp("body", 1, "bkColor", "");
        eval(grdArry[i]).SetCellProp("body", 1, "bkColor2", "User Color 22");
        eval(grdArry[i]).SetCellProp("body", 2, "Color", "");
        eval(grdArry[i]).Redraw = true;
    }
}

/********************************************************************************
* 기      능   : 그리드 이동을 원복 시킨다.
********************************************************************************/
function grd_zcstplms_OnCellPosChanged(obj,nRow,nCell,nOldRow,nOldCell,nPivotIndex,nOldPivotIndex)
{
    var rowType = ds_zcstplms.GetRowType(gRowIndex);
    if( rowType == "insert" && gRowIndex != nRow )  {
        ds_zcstplms.row = gRowIndex;
    }
}

/********************************************************************************
* 기      능   : 데이터 변경상태 처리
********************************************************************************/
function dataChangeStat() {
    ds_list2.fireevent = false;
    gChangStat = "N";
    for(var i=0; i < ds_list2.GetRowCountNF(); i++) {
        if( ds_list2.GetColumnNF(i, "KNM") != ds_list2.GetColumnNF(i, "ORGKNM") ) {
            ds_list2.SetColumnNF(i, "STATUS", "U");
            gChangStat = "Y";
        } else {
            ds_list2.SetColumnNF(i, "STATUS", "R");
        }
    }
    ds_list2.fireevent = true;
}

/********************************************************************************
* 기      능   : 정합성 오류 메세지 툴팁
********************************************************************************/
function tab_MATCH_RSLT_grd_list9_OnMouseOver(obj,nPosX,nPosY,nRow,nCell,nPivotIndex)
{
     var text;
     text = ds_match_rslt.GetColumn(nRow, "ERR_MESSAGE");
     tab.MATCH_RSLT.grd_list9.ToolTipText = text;
}

/********************************************************************************
* 기      능   : 서비스 사양 특성에 대한 DUTY 체크 로직을 수행한다.
********************************************************************************/
function btn_duty_OnClick(obj)
{
    tit_clearActionInfo();
    ds_list_match.ClearData();
    ds_duty_rslt.ClearData();
    ds_list_match.Copy(ds_list2);

    // 특성값이 없는 경우 처리 
    var rowIndex = ds_zcstplms.rowpos;
    if( rowIndex > -1 ) {
		// 서비스 체크 로직은 별도 Act를 호출하여 처리한다.
		tit_callService(
			  "CS0108002B_ACT"
			, "specBomDutyCheck"
			, "ds_cond=ds_cond ds_list_match=ds_list_match ds_duty_rslt=ds_duty_rslt"
			, "ds_cond=ds_cond ds_duty_rslt=ds_duty_rslt ds_error=ds_error"
			, ""
			, "fn_afterDuty"
			, true
			, true
			, false);
    }
}

/********************************************************************************
* 기      능   : DUTY 체크 처리 결과
********************************************************************************/
function fn_afterDuty(obj)
{
    tab.TabIndex = 0;
    if( ds_error.GetRowCount() > 0 ) {
        gfn_openMsgWin("담당자에 문의하십시요\n"+ds_error.GetColumn(0,"ERRMSG"), "E", "A", ds_error.GetColumn(0,"ERRCODE") );
    } else {
        // ds_duty_rslt 값이 존재하는 경우 입력값에 반영 시켜준다.
        if( ds_duty_rslt.GetRowCount() > 0 ) {
        
			for(var i=0; i < ds_list2.GetRowCountNF(); i++) {
				ds_list2.SetColumnNF(i, "DUTYVALUE", "");
			}

			var grdArry = [
						  "tab.EL_MM.grd_list0", "tab.EL_BASIC.grd_list1", "tab.EL_INSIDE.grd_list2", "tab.EL_OUTSIDE.grd_list3",
						  "tab.EL_OPTION.grd_list4", "tab.EL_LAYOUT.grd_list5", "tab.EL_EFH.grd_list6", "tab.EL_CHANGE.grd_list7", "tab.EL_REUSE.grd_list8"
						  ];
		
			for(var i = 0; i < grdArry.length; i++) {
				eval(grdArry[i]).Redraw = false;
				eval(grdArry[i]).SetCellProp("body", 2, "color", "expr:iif(DUTYVALUE != '' && DUTYVALUE == KNM, 'red', '')");
				eval(grdArry[i]).Redraw = true;
			}

            // 정합성 DUTY 사양 특성값 팝업 호출
            var arg = "";
            gfn_openPopup("CS0108002F", true, arg);
        } else {
	        gfn_openMsgWin("입력된 사양특성값에 적용될 DUTY 사양특성값이 없습니다.", "", "A", "DUTY");
        }
    }
}]]></Script>
</Window>