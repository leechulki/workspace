<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="648" Id="D" Left="8" OnKeyDown="gfn_EnterInForm" OnLoadCompleted="fn_OnLoadCompleted" PidAttrib="7" Title="MMPR&#32;조회" Top="8" Ver="1.0" Width="606" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_cond">
				<Contents>
					<colinfo id="JQPRNUM" size="30" summ="default" type="STRING"/>
					<colinfo id="DNO" size="256" summ="default" type="STRING"/>
					<colinfo id="PJT" size="256" summ="default" type="STRING"/>
					<colinfo id="CUDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="REQNR" size="256" summ="default" type="STRING"/>
					<colinfo id="REQNO" size="256" summ="default" type="STRING"/>
					<colinfo id="UPN" size="256" summ="default" type="STRING"/>
					<colinfo id="CST" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
					<colinfo id="KOSTL" size="256" summ="default" type="STRING"/>
					<colinfo id="CURDATE" size="256" summ="default" type="STRING"/>
					<colinfo id="SETNAME" size="256" summ="default" type="STRING"/>
					<record>
						<CST></CST>
						<CUDAT></CUDAT>
						<CURDATE></CURDATE>
						<DNO></DNO>
						<JQPRNUM></JQPRNUM>
						<KOSTL></KOSTL>
						<PJT></PJT>
						<POSID></POSID>
						<REQNO></REQNO>
						<REQNR></REQNR>
						<SETNAME></SETNAME>
						<UPN></UPN>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_qm007">
				<Contents>
					<colinfo id="ATYPE" size="12" summ="default" type="STRING"/>
					<colinfo id="BELNR" size="30" summ="default" type="STRING"/>
					<colinfo id="BUDDT" size="24" summ="default" type="STRING"/>
					<colinfo id="BUKRS" size="12" summ="default" type="STRING"/>
					<colinfo id="CAUSECAT" size="3" summ="default" type="STRING"/>
					<colinfo id="CAUSECOD" size="12" summ="default" type="STRING"/>
					<colinfo id="CAUSEGRP" size="24" summ="default" type="STRING"/>
					<colinfo id="CAUSETXT" size="120" summ="default" type="STRING"/>
					<colinfo id="CELLP" size="48" summ="default" type="STRING"/>
					<colinfo id="CLODT" size="24" summ="default" type="STRING"/>
					<colinfo id="CLOID" size="30" summ="default" type="STRING"/>
					<colinfo id="CREDT" size="24" summ="default" type="STRING"/>
					<colinfo id="CREID" size="36" summ="default" type="STRING"/>
					<colinfo id="CREKTL" size="30" summ="default" type="STRING"/>
					<colinfo id="CRENM" size="60" summ="default" type="STRING"/>
					<colinfo id="FIXREQID" size="30" summ="default" type="STRING"/>
					<colinfo id="GJAHR" size="12" summ="default" type="STRING"/>
					<colinfo id="GUBUN" size="3" summ="default" type="STRING"/>
					<colinfo id="HOGI" size="72" summ="default" type="STRING"/>
					<colinfo id="IMPETC" size="72" summ="default" type="STRING"/>
					<colinfo id="IMPKTL" size="72" summ="default" type="STRING"/>
					<colinfo id="IMPLFN" size="30" summ="default" type="STRING"/>
					<colinfo id="IMPUCD" size="3" summ="default" type="STRING"/>
					<colinfo id="INSTIME" size="11" summ="default" type="INT"/>
					<colinfo id="IWBTR" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="JQPRNO" size="60" summ="default" type="STRING"/>
					<colinfo id="JQPRNUM" size="30" summ="default" type="STRING"/>
					<colinfo id="LIFNR" size="30" summ="default" type="STRING"/>
					<colinfo id="MANDT" size="9" summ="default" type="STRING"/>
					<colinfo id="MMPR_DEL" size="3" summ="default" type="STRING"/>
					<colinfo id="MWSKZ" size="6" summ="default" type="STRING"/>
					<colinfo id="NAMET" size="60" summ="default" type="STRING"/>
					<colinfo id="OCCDT" size="24" summ="default" type="STRING"/>
					<colinfo id="OWBTR" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="PHENOCAT" size="3" summ="default" type="STRING"/>
					<colinfo id="PHENOCOD" size="12" summ="default" type="STRING"/>
					<colinfo id="PHENOGRP" size="24" summ="default" type="STRING"/>
					<colinfo id="PHENOTXT" size="120" summ="default" type="STRING"/>
					<colinfo id="POST1" size="120" summ="default" type="STRING"/>
					<colinfo id="PRCTR" size="30" summ="default" type="STRING"/>
					<colinfo id="PRODID" size="30" summ="default" type="STRING"/>
					<colinfo id="PSPID" size="72" summ="default" type="STRING"/>
					<colinfo id="RECE_F" size="3" summ="default" type="STRING"/>
					<colinfo id="REGDT" size="24" summ="default" type="STRING"/>
					<colinfo id="REGID" size="30" summ="default" type="STRING"/>
					<colinfo id="REJTXT" size="120" summ="default" type="STRING"/>
					<colinfo id="REQNR" size="30" summ="default" type="STRING"/>
					<colinfo id="SPEC" size="90" summ="default" type="STRING"/>
					<colinfo id="STATUS" size="3" summ="default" type="STRING"/>
					<colinfo id="TEMNO" size="18" summ="default" type="STRING"/>
					<colinfo id="WAERS" size="15" summ="default" type="STRING"/>
					<colinfo id="WERKS" size="12" summ="default" type="STRING"/>
					<colinfo id="WORKDT" size="24" summ="default" type="STRING"/>
					<colinfo id="XMWST" size="3" summ="default" type="STRING"/>
					<colinfo id="ZBEPJEO" size="24" summ="default" type="STRING"/>
					<colinfo id="ZBOSUIN" size="24" summ="default" type="STRING"/>
					<colinfo id="ZOIPSU" size="24" summ="default" type="STRING"/>
					<colinfo id="REQKIND" size="60" summ="default" type="STRING"/>
					<colinfo id="REQNO" size="30" summ="default" type="STRING"/>
					<colinfo id="APSTAT" size="3" summ="default" type="STRING"/>
					<colinfo id="CRDPT1" size="18" summ="default" type="STRING"/>
					<colinfo id="REDPT1" size="18" summ="default" type="STRING"/>
					<colinfo id="MATCOST" size="15" summ="default" type="STRING"/>
					<colinfo id="WBRTR" size="15" summ="default" type="STRING"/>
					<colinfo id="NCOST" size="15" summ="default" type="STRING"/>
					<colinfo id="IMPKTL1" size="256" summ="default" type="STRING"/>
					<colinfo id="IMPKTL2" size="256" summ="default" type="STRING"/>
					<colinfo id="IMPKTL3" size="256" summ="default" type="STRING"/>
					<colinfo id="IMPKTL_P" size="256" summ="default" type="STRING"/>
					<colinfo id="IMPKTL2_P" size="256" summ="default" type="STRING"/>
					<colinfo id="IMPKTL3_P" size="256" summ="default" type="STRING"/>
					<colinfo id="IMPGUBN" size="256" summ="default" type="STRING"/>
					<colinfo id="JOBKIND" size="256" summ="default" type="STRING"/>
					<colinfo id="REQKIND_CD" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_qmtext">
				<Contents>
					<COLINFO ID="TDID" SIZE="4" TYPE="STRING"/>
					<COLINFO ID="TDNAME" SIZE="70" TYPE="STRING"/>
					<COLINFO ID="TDOBJECT" SIZE="10" TYPE="STRING"/>
					<colinfo id="O_TEXT" size="1000" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cause">
				<Contents>
					<colinfo id="CODE" size="12" type="STRING"/>
					<colinfo id="CODEGRUPPE" size="24" type="STRING"/>
					<colinfo id="KURZTEXT" size="120" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_pheno">
				<Contents>
					<colinfo id="CODE" size="12" type="STRING"/>
					<colinfo id="CODEGRUPPE" size="24" type="STRING"/>
					<colinfo id="KURZTEXT" size="120" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_reqkind_cd">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list">
				<Contents>
					<colinfo id="ASSNO" size="33" summ="default" type="STRING"/>
					<colinfo id="BWTAR" size="30" summ="default" type="STRING"/>
					<colinfo id="CAUSECAT" size="3" summ="default" type="STRING"/>
					<colinfo id="CAUSECOD" size="12" summ="default" type="STRING"/>
					<colinfo id="CAUSEGRP" size="24" summ="default" type="STRING"/>
					<colinfo id="CAUSETXT" size="120" summ="default" type="STRING"/>
					<colinfo id="CHAR1" size="300" summ="default" type="STRING"/>
					<colinfo id="INSMSNO" size="60" summ="default" type="STRING"/>
					<colinfo id="MBINSMSNO" size="60" summ="default" type="STRING"/>
					<colinfo id="JQPRNUM" size="30" summ="default" type="STRING"/>
					<colinfo id="MAKTX" size="120" summ="default" type="STRING"/>
					<colinfo id="MANDT" size="9" summ="default" type="STRING"/>
					<colinfo id="MATNR" size="54" summ="default" type="STRING"/>
					<colinfo id="MEINS" size="9" summ="default" type="STRING"/>
					<colinfo id="MENGE" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="MMPR_DEL" size="3" summ="default" type="STRING"/>
					<colinfo id="PHENOCAT" size="3" summ="default" type="STRING"/>
					<colinfo id="PHENOCOD" size="12" summ="default" type="STRING"/>
					<colinfo id="PHENOGRP" size="24" summ="default" type="STRING"/>
					<colinfo id="PHENOTXT" size="120" summ="default" type="STRING"/>
					<colinfo id="RECE_F" size="3" summ="default" type="STRING"/>
					<colinfo id="REQITEM" size="15" summ="default" type="STRING"/>
					<colinfo id="REQKIND" size="3" summ="default" type="STRING"/>
					<colinfo id="REQNR" size="30" summ="default" type="STRING"/>
					<colinfo id="RETMSNO" size="60" summ="default" type="STRING"/>
					<colinfo id="MBRETMSNO" size="60" summ="default" type="STRING"/>
					<colinfo id="RTNDT" size="24" summ="default" type="STRING"/>
					<colinfo id="RTYPE" size="3" summ="default" type="STRING"/>
					<colinfo id="SAMT1" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="SERNO" size="6" summ="default" type="STRING"/>
					<colinfo id="SHIPDT" size="24" summ="default" type="STRING"/>
					<colinfo id="ACPT_NUM" size="60" summ="default" type="STRING"/>
					<colinfo id="SAMT2" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_bwtar">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_apstat">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<colinfo id="DTEXT1" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_aplist">
				<Contents>
					<colinfo id="DOCKIND" size="3" summ="default" type="STRING"/>
					<colinfo id="DOCNO" size="30" summ="default" type="STRING"/>
					<colinfo id="MANDT" size="9" summ="default" type="STRING"/>
					<colinfo id="R1DATE" size="24" summ="default" type="STRING"/>
					<colinfo id="R1IRUM" size="60" summ="default" type="STRING"/>
					<colinfo id="R1RNK" size="60" summ="default" type="STRING"/>
					<colinfo id="R2DATE" size="24" summ="default" type="STRING"/>
					<colinfo id="R2IRUM" size="60" summ="default" type="STRING"/>
					<colinfo id="R2RNK" size="60" summ="default" type="STRING"/>
					<colinfo id="R3DATE" size="24" summ="default" type="STRING"/>
					<colinfo id="R3IRUM" size="60" summ="default" type="STRING"/>
					<colinfo id="R3RNK" size="60" summ="default" type="STRING"/>
					<colinfo id="R4DATE" size="24" summ="default" type="STRING"/>
					<colinfo id="R4IRUM" size="60" summ="default" type="STRING"/>
					<colinfo id="R4RNK" size="60" summ="default" type="STRING"/>
					<colinfo id="R5DATE" size="24" summ="default" type="STRING"/>
					<colinfo id="R5IRUM" size="60" summ="default" type="STRING"/>
					<colinfo id="R5RNK" size="60" summ="default" type="STRING"/>
					<colinfo id="S1DATE" size="24" summ="default" type="STRING"/>
					<colinfo id="S1IRUM" size="60" summ="default" type="STRING"/>
					<colinfo id="S1RNK" size="60" summ="default" type="STRING"/>
					<colinfo id="S2DATE" size="24" summ="default" type="STRING"/>
					<colinfo id="S2IRUM" size="60" summ="default" type="STRING"/>
					<colinfo id="S2RNK" size="60" summ="default" type="STRING"/>
					<colinfo id="S3DATE" size="24" summ="default" type="STRING"/>
					<colinfo id="S3IRUM" size="60" summ="default" type="STRING"/>
					<colinfo id="S3RNK" size="60" summ="default" type="STRING"/>
					<colinfo id="S4DATE" size="24" summ="default" type="STRING"/>
					<colinfo id="S4IRUM" size="60" summ="default" type="STRING"/>
					<colinfo id="S4RNK" size="60" summ="default" type="STRING"/>
					<colinfo id="S5DATE" size="24" summ="default" type="STRING"/>
					<colinfo id="S5IRUM" size="60" summ="default" type="STRING"/>
					<colinfo id="S5RNK" size="60" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_apcond">
				<Contents>
					<colinfo id="DOCKIND" size="3" summ="default" type="STRING"/>
					<colinfo id="DOCNO" size="30" summ="default" type="STRING"/>
					<record>
						<DOCKIND></DOCKIND>
						<DOCNO></DOCNO>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_decide">
				<Contents>
					<colinfo id="MANDT" size="256" summ="default" type="STRING"/>
					<colinfo id="DOCNO" size="256" summ="default" type="STRING"/>
					<colinfo id="DOCKIND" size="256" summ="default" type="STRING"/>
					<colinfo id="APPGUBN" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQNO" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQSTAT" size="256" summ="default" type="STRING"/>
					<colinfo id="APDPT1" size="256" summ="default" type="STRING"/>
					<colinfo id="APDPT1_N" size="256" summ="default" type="STRING"/>
					<colinfo id="APNUM" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE" size="256" summ="default" type="STRING"/>
					<colinfo id="APTIM" size="256" summ="default" type="STRING"/>
					<colinfo id="APDESC" size="256" summ="default" type="STRING"/>
					<colinfo id="APSTAT" size="256" summ="default" type="STRING"/>
					<colinfo id="MAX_SEQNO" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_head">
				<Contents>
					<colinfo id="CST" size="9" summ="default" type="STRING"/>
					<colinfo id="KND" size="3" summ="default" type="STRING"/>
					<colinfo id="NAM" size="150" summ="default" type="STRING"/>
					<colinfo id="SPT" size="150" summ="default" type="STRING"/>
					<colinfo id="UHJ" size="24" summ="default" type="STRING"/>
					<colinfo id="UMR" size="24" summ="default" type="STRING"/>
					<colinfo id="UPN" size="18" summ="default" type="STRING"/>
					<colinfo id="USD" size="24" summ="default" type="STRING"/>
					<colinfo id="CUDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="YEAR" size="24" summ="default" type="STRING"/>
					<colinfo id="QTNUM" size="256" summ="default" type="STRING"/>
					<colinfo id="REQNR" size="256" summ="default" type="STRING"/>
					<colinfo id="GNO" size="256" summ="default" type="STRING"/>
					<colinfo id="REQNO" size="256" summ="default" type="STRING"/>
					<colinfo id="ADT" size="256" summ="default" type="STRING"/>
					<colinfo id="FMY" size="256" summ="default" type="STRING"/>
					<colinfo id="APSTAT" size="256" summ="default" type="STRING"/>
					<colinfo id="CRDPT1" size="256" summ="default" type="STRING"/>
					<colinfo id="REDPT1" size="256" summ="default" type="STRING"/>
					<colinfo id="LGORT1" size="256" summ="default" type="STRING"/>
					<colinfo id="VKGRP" size="256" summ="default" type="STRING"/>
					<colinfo id="F_CNT" size="8" summ="default" type="STRING"/>
					<colinfo id="REQKIND" size="256" summ="default" type="STRING"/>
					<colinfo id="ACPT_NUM" size="30" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list2">
				<Contents>
					<colinfo id="BWTAR" size="30" summ="default" type="STRING"/>
					<colinfo id="MAKTX" size="120" summ="default" type="STRING"/>
					<colinfo id="MATNR" size="54" summ="default" type="STRING"/>
					<colinfo id="MEINS" size="9" summ="default" type="STRING"/>
					<colinfo id="MENGE" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="POSID" size="72" summ="default" type="STRING"/>
					<colinfo id="SAMT1" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="SAMT2" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="NETPR" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="SENDAT" size="24" summ="default" type="STRING"/>
					<colinfo id="YEAR" size="24" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_mmpr">
				<Contents>
					<colinfo id="MANDT" size="9" summ="default" type="STRING"/>
					<colinfo id="JQPRNUM" size="30" summ="default" type="STRING"/>
					<colinfo id="QTNUM" size="15" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="6" summ="default" type="STRING"/>
					<colinfo id="WRBTR" size="15" summ="default" type="STRING"/>
					<colinfo id="NCOST" size="15" summ="default" type="STRING"/>
					<colinfo id="IMPKTL" size="15" summ="default" type="STRING"/>
					<colinfo id="IMPKTL2" size="15" summ="default" type="STRING"/>
					<colinfo id="IMPKTL3" size="15" summ="default" type="STRING"/>
					<colinfo id="IMPKTL_P" size="5" summ="default" type="STRING"/>
					<colinfo id="IMPKTL2_P" size="5" summ="default" type="STRING"/>
					<colinfo id="IMPKTL3_P" size="5" summ="default" type="STRING"/>
					<colinfo id="IMPETC" size="15" summ="default" type="STRING"/>
					<colinfo id="CRDAT" size="24" summ="default" type="STRING"/>
					<colinfo id="CRTIM" size="24" summ="default" type="STRING"/>
					<colinfo id="CRNAM" size="15" summ="default" type="STRING"/>
					<colinfo id="UPT" size="5" summ="default" type="STRING"/>
					<colinfo id="BIGO" size="100" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_imp">
				<Contents>
					<colinfo id="code" size="10" summ="default" type="STRING"/>
					<colinfo id="value" size="10" summ="default" type="STRING"/>
					<record>
						<code>inner</code>
						<value>내부</value>
					</record>
					<record>
						<code>etc</code>
						<value>기타</value>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_mcost">
				<Contents>
					<colinfo id="WBRTR" size="15" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_department">
				<Contents>
					<colinfo id="KOSTL" size="256" summ="default" type="STRING"/>
					<colinfo id="KTEXT" size="256" summ="default" type="STRING"/>
					<colinfo id="SETNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="DESCRIPT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_decide_0">
				<Contents>
					<colinfo id="MANDT" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQNO" size="256" summ="default" type="STRING"/>
					<colinfo id="APNUM" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cst016_chk">
				<Contents>
					<colinfo id="REQNO" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
		</Datasets>
		<Shape BKColor="user12" Bottom="640" Height="154" Id="sh_app" Left="8" LineColor="user13" Right="598" TabOrder="43" Top="486" Type="Rectangle" Visible="FALSE" Width="590"></Shape>
		<Div Height="36" Id="div_btn" TabOrder="40" Text="Div0" Url="WB01::CommBtnForm.xml" Width="606">
			<Contents></Contents>
		</Div>
		<Image Height="36" Id="Image1" ImageID="form_bl_title_main" Left="8" TabOrder="1" Top="-1" Width="15"></Image>
		<Shape BKColor="user12" Bottom="70" Height="26" Id="Shape1" Left="8" LineColor="user13" Right="598" TabOrder="3" Top="44" Type="Rectangle" Width="590"></Shape>
		<Static Align="Right" Height="24" Id="Static5" Left="9" Style="sty_lb_form_basic" TabOrder="4" Text="PROJECT&#32;" Top="45" VAlign="Middle" Width="92"></Static>
		<Edit BindDataset="ds_qm007" Border="Flat" Column="PSPID" Enable="FALSE" Height="20" Id="ed_pspid" Left="103" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="6" Top="47" Width="102"></Edit>
		<Static Align="Right" Height="24" Id="Static4" Left="405" Style="sty_lb_form_basic" TabOrder="7" Text="하자보증만료일" Top="45" VAlign="Middle" Width="88"></Static>
		<Calendar BindDataset="ds_qm007" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="WORKDT" Dateformat="yyyy-MM-dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Enable="FALSE" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_workdt" Left="495" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="5" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="47" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="100"></Calendar>
		<Shape BKColor="user12" Bottom="95" Height="26" Id="Shape2" Left="8" LineColor="user13" Right="598" TabOrder="8" Top="69" Type="Rectangle" Width="590"></Shape>
		<Static Align="Right" Height="24" Id="Static16" Left="9" Style="sty_lb_form_basic" TabOrder="9" Text="호기&#32;" Top="70" VAlign="Middle" Width="92"></Static>
		<Edit BindDataset="ds_qm007" Border="Flat" Column="HOGI" Enable="FALSE" Height="20" Id="ed_hogi" Left="103" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="11" Top="72" Width="102"></Edit>
		<Static Align="Right" Height="24" Id="Static17" Left="405" Style="sty_lb_form_basic" TabOrder="12" Text="보수인수일&#32;" Top="70" VAlign="Middle" Width="88"></Static>
		<Calendar BindDataset="ds_qm007" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="ZBOSUIN" Dateformat="yyyy-MM-dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Enable="FALSE" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_zbosuin" Left="495" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="10" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="72" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="100"></Calendar>
		<Static Align="Right" Height="24" Id="Static18" Left="207" Style="sty_lb_form_basic" TabOrder="13" Text="기종&#32;" Top="70" VAlign="Middle" Width="92"></Static>
		<Edit BindDataset="ds_qm007" Border="Flat" Column="ATYPE" Enable="FALSE" Height="20" Id="ed_atype" Left="301" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="14" Top="72" Width="102"></Edit>
		<Shape BKColor="user12" Bottom="120" Height="26" Id="Shape3" Left="8" LineColor="user13" Right="598" TabOrder="15" Top="94" Type="Rectangle" Width="590"></Shape>
		<Static Align="Right" Height="24" Id="Static19" Left="9" Style="sty_lb_form_basic" TabOrder="16" Text="보수업체&#32;" Top="95" VAlign="Middle" Width="92"></Static>
		<Edit BindDataset="ds_qm007" Border="Flat" Column="LIFNR" Enable="FALSE" Height="20" Id="ed_lifnr" Left="103" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="18" Top="97" Width="102"></Edit>
		<Static Align="Right" Height="24" Id="Static20" Left="405" Style="sty_lb_form_basic" TabOrder="19" Text="입주일&#32;" Top="95" VAlign="Middle" Width="88"></Static>
		<Calendar BindDataset="ds_qm007" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="ZOIPSU" Dateformat="yyyy-MM-dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Enable="FALSE" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_zoipsu" Left="495" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="17" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="97" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="100"></Calendar>
		<Shape BKColor="user12" Bottom="145" Height="26" Id="Shape4" Left="8" LineColor="user13" Right="598" TabOrder="20" Top="119" Type="Rectangle" Width="590"></Shape>
		<Static Align="Right" Height="24" Id="Static22" Left="9" Style="sty_lb_form_basic" TabOrder="21" Text="작성자&#32;" Top="120" VAlign="Middle" Width="92"></Static>
		<Edit BindDataset="ds_qm007" Border="Flat" Column="CRENM" Enable="FALSE" Height="20" Id="ed_crenm" Left="103" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="23" Top="122" Width="102"></Edit>
		<Static Align="Right" Height="24" Id="Static23" Left="405" Style="sty_lb_form_basic" TabOrder="24" Text="완성검사일&#32;" Top="120" VAlign="Middle" Width="88"></Static>
		<Calendar BindDataset="ds_qm007" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="ZBEPJEO" Dateformat="yyyy-MM-dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Enable="FALSE" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_zbepjeo" Left="494" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="22" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="122" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="100"></Calendar>
		<Shape BKColor="user12" Bottom="170" Height="26" Id="Shape5" Left="8" LineColor="user13" Right="598" TabOrder="25" Top="144" Type="Rectangle" Width="590"></Shape>
		<Static Align="Right" Height="24" Id="Static25" Left="9" Style="sty_lb_form_basic" TabOrder="26" Text="작업자&#32;" Top="145" VAlign="Middle" Width="92"></Static>
		<Edit BindDataset="ds_qm007" Border="Flat" Column="NAMET" Enable="FALSE" Height="20" Id="ed_namet" Left="103" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="28" Top="147" Width="102"></Edit>
		<Static Align="Right" Height="24" Id="Static26" Left="405" Style="sty_lb_form_basic" TabOrder="29" Text="작성일&#32;" Top="145" VAlign="Middle" Width="88"></Static>
		<Calendar BindDataset="ds_qm007" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="CREDT" Dateformat="yyyy-MM-dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Enable="FALSE" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_credt" Left="495" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="27" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="147" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="100"></Calendar>
		<Static Align="Right" Height="24" Id="Static27" Left="207" Style="sty_lb_form_basic" TabOrder="30" Text="작업자연락처&#32;" Top="145" VAlign="Middle" Width="92"></Static>
		<Edit BindDataset="ds_qm007" Border="Flat" Column="CELLP" Enable="FALSE" Height="20" Id="ed_cellp" Left="301" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="31" Top="147" Width="102"></Edit>
		<Edit BindDataset="ds_qm007" Border="Flat" Column="POST1" Enable="FALSE" Height="20" Id="ed_post1" Left="207" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="32" Top="47" Width="196"></Edit>
		<Static Border="None" Color="user7" Font="굴림,9" Height="20" Id="Static1" Left="209" TabOrder="33" Text=":&#32;저장위치에&#32;따른&#32;업체코드" Top="97" VAlign="Middle" Width="190"></Static>
		<Shape BKColor="user12" Bottom="195" Height="26" Id="Shape0" Left="8" LineColor="user13" Right="598" TabOrder="34" Top="169" Type="Rectangle" Width="590"></Shape>
		<Shape BKColor="user12" Bottom="245" Height="51" Id="Shape6" Left="8" LineColor="user13" Right="598" TabOrder="35" Top="194" Type="Rectangle" Width="590"></Shape>
		<Static Align="Right" Height="24" Id="Static2" Left="9" Style="sty_lb_form_basic" TabOrder="36" Text="문제점요약(Q)&#32;" Top="170" VAlign="Middle" Width="92"></Static>
		<Edit BindDataset="ds_qm007" Border="Flat" Column="REJTXT" Enable="FALSE" Height="20" Id="ed_rejtxt" Left="103" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="37" Top="172" Width="492"></Edit>
		<TextArea Border="Flat" Enable="FALSE" Height="45" Id="tx_causetxt1" Left="11" Style="sty_ipt_form" TabOrder="38" Top="197" VScroll="TRUE" Width="584"></TextArea>
		<Grid AreaSelect="TRUE" AutoFitEndLine="Hide" BindDataset="ds_list" BkColor2="default" BoldHead="true" Border="Flat" Bottom="483" CellMoving="TRUE" ColSelect="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="227" Id="grd_list" InputPanel="FALSE" Left="8" LineColor="user20" LineType="ExHORZ" Right="598" RowHeight="20" Style="sty_grid" TabOrder="39" TabStop="true" Top="256" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="590">
			<contents>
				<format id="Default">
					<columns>
						<col width="100"/>
						<col width="77"/>
						<col width="100"/>
						<col width="150"/>
						<col width="94"/>
						<col width="70"/>
						<col width="70"/>
						<col width="100"/>
						<col width="110"/>
						<col width="110"/>
						<col width="110"/>
						<col width="110"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="110"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="110"/>
						<col width="120"/>
						<col width="111"/>
					</columns>
					<head>
						<cell align="center" col="0" display="text" font="굴림,9" text="청구종류"/>
						<cell align="center" col="1" display="text" font="굴림,9" text="청구&#32;item"/>
						<cell align="center" col="2" display="text" font="굴림,9" text="자재번호"/>
						<cell align="center" col="3" display="text" font="굴림,9" text="자재내역"/>
						<cell align="center" col="4" display="text" font="굴림,9" text="평가유형"/>
						<cell align="center" col="5" display="text" font="굴림,9" text="수량"/>
						<cell align="center" col="6" display="text" font="굴림,9" text="기본단위"/>
						<cell align="center" col="7" display="text" font="굴림,9" text="판매가"/>
						<cell align="center" col="8" display="text" font="굴림,9" text="반납자재&#32;Ser&#32;No"/>
						<cell align="center" col="9" display="text" font="굴림,9" text="반납보드&#32;Ser&#32;No"/>
						<cell align="center" col="10" display="text" font="굴림,9" text="설치자재&#32;Ser&#32;No"/>
						<cell align="center" col="11" display="text" font="굴림,9" text="설치보드&#32;Ser&#32;No"/>
						<cell align="center" col="12" display="text" font="굴림,9" text="유상번호"/>
						<cell align="center" col="13" display="text" font="굴림,9" text="고장현상"/>
						<cell align="center" col="14" display="text" font="굴림,9" text="고장현상&#32;CATA"/>
						<cell align="center" col="15" display="text" font="굴림,9" text="고장현상&#32;code"/>
						<cell align="center" col="16" display="text" font="굴림,9" text="고장현상&#32;code&#32;GR"/>
						<cell align="center" col="17" display="text" font="굴림,9" text="고장원인"/>
						<cell align="center" col="18" display="text" font="굴림,9" text="고장원인&#32;CATA"/>
						<cell align="center" col="19" display="text" font="굴림,9" text="고장원인&#32;code"/>
						<cell align="center" col="20" display="text" font="굴림,9" text="고장원인&#32;code&#32;GR"/>
						<cell align="center" col="21" display="text" font="굴림,9" text="고객센터&#32;접수번호"/>
						<cell align="center" col="22" display="text" font="굴림,9" text="원가"/>
					</head>
					<body>
						<cell align="center" bkcolor2="user22" col="0" colid="REQKIND" combocol="CODE" combodataset="ds_reqkind_cd" combotext="CODE_NAME" display="combo"/>
						<cell align="center" bkcolor2="user22" col="1" colid="SERNO" display="text"/>
						<cell align="center" bkcolor2="user22" col="2" colid="MATNR" display="text"/>
						<cell bkcolor2="user22" col="3" colid="MAKTX" display="text"/>
						<cell align="center" bkcolor2="user22" col="4" colid="BWTAR" combocol="CODE" combodataset="ds_bwtar" combotext="CODE_NAME" display="combo"/>
						<cell align="right" bkcolor2="user22" col="5" colid="MENGE" display="text"/>
						<cell align="center" bkcolor2="user22" col="6" colid="MEINS" display="text"/>
						<cell align="right" bkcolor2="user22" col="7" colid="SAMT1" display="number" Mask="###,###"/>
						<cell bkcolor2="user22" col="8" colid="RETMSNO" display="text"/>
						<cell bkcolor2="user22" col="9" colid="MBRETMSNO" display="text"/>
						<cell align="center" bkcolor2="user22" col="10" colid="INSMSNO" display="text"/>
						<cell align="center" bkcolor2="user22" col="11" colid="MBINSMSNO" display="text"/>
						<cell align="center" bkcolor2="user22" col="12" display="text"/>
						<cell align="center" bkcolor2="user22" col="13" colid="PHENOTXT" combocol="CODE" combodataset="ds_cause" combotext="KURZTEXT" display="text"/>
						<cell align="center" bkcolor2="user22" col="14" colid="PHENOCAT" display="text"/>
						<cell align="center" bkcolor2="user22" col="15" colid="PHENOCOD" display="combo"/>
						<cell align="center" bkcolor2="user22" col="16" colid="CAUSEGRP" display="text"/>
						<cell align="center" bkcolor2="user22" col="17" colid="CAUSECOD" combocol="CODE" combodataset="ds_cause" combotext="KURZTEXT" display="combo"/>
						<cell align="center" bkcolor2="user22" col="18" colid="CAUSECAT" display="text"/>
						<cell align="center" bkcolor2="user22" col="19" colid="CAUSECOD" combodataset="ds_cause" display="text"/>
						<cell align="center" bkcolor2="user22" col="20" colid="CAUSEGRP" display="text"/>
						<cell align="center" bkcolor2="user22" bkimagealign="right" col="21" colid="ACPT_NUM" display="text" expandimage="btn_icon_search" expandshow="true" expandsize="18"/>
						<cell align="center" bkcolor2="user22" bkimagealign="right" col="22" colid="SAMT2" display="currency" expandsize="18"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Static Color="user5" Font="굴림,10,Bold" Height="20" Id="Static0" Left="28" TabOrder="2" Text="MMPR&#32;조회" Top="8" VAlign="Middle" Width="192"></Static>
		<Static Align="Right" Height="24" Id="st_app" Left="9" Style="sty_lb_form_basic" TabOrder="44" Text="결재상태&#32;" Top="487" VAlign="Middle" Visible="FALSE" Width="63"></Static>
		<Combo BindDataset="ds_qm007" Border="Flat" CodeColumn="CODE" Column="APSTAT" DataColumn="DTEXT1" Enable="FALSE" Height="20" Id="cb_apstat" InnerDataset="ds_apstat" Left="75" Style="sty_ipt_search" TabOrder="45" Top="488" Visible="FALSE" Width="116"></Combo>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_app" ImageID="btn_sub_06" Left="512" LeftMargin="12" OnClick="btn_app_OnClick" Style="sty_btn" TabOrder="42" Text="결재선&#32;지정" Top="490" Transparent="TRUE" Visible="FALSE" Width="84"></Button>
		<Static Align="Right" Height="24" Id="st_matcost" Left="195" Style="sty_lb_form_basic" TabOrder="45" Text="재료비&#32;" Top="489" VAlign="Middle" Width="45"></Static>
		<MaskEdit BindDataset="ds_qm007" Border="Flat" Column="MATCOST" Height="20" Id="me_matcost" Left="241" Style="sty_ipt_form" TabOrder="46" Top="490" Width="102"></MaskEdit>
		<Edit Align="CENTER" Border="Flat" Height="20" Id="ed_reg" Left="392" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="47" Text="(전결규정)" Top="490" Width="119"></Edit>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="bt_sav_matcost" ImageID="btn_sub_02" Left="344" LeftMargin="12" OnClick="ufn_saveMatcost" Style="sty_btn" TabOrder="48" Text="저장" Top="490" Transparent="TRUE" Width="50"></Button>
		<Static Align="Center" Height="24" Id="st_impk" Left="118" Style="sty_lb_form_basic" TabOrder="49" Text="내부부서" Top="540" VAlign="Middle" Width="58"></Static>
		<Button Height="18" Id="btn_impk1" ImageID="btn_icon_search" Left="283" OnClick="btn_pjt_OnClick" TabOrder="50" Text="Button0" Top="543" Width="18"></Button>
		<Static Align="Center" Height="24" Id="Static6" Left="11" Style="sty_lb_form_basic" TabOrder="51" Text="귀책" Top="540" VAlign="Middle" Width="32"></Static>
		<MaskEdit Border="Flat" DecimalLen="1" DigitLen="3" Enable="FALSE" Height="20" Id="me_impktl_p" Left="303" Mask="###.#" Style="sty_ipt_form" TabOrder="52" Top="543" Width="40"></MaskEdit>
		<Button Height="18" Id="btn_impk2" ImageID="btn_icon_search" Left="283" OnClick="btn_pjt_OnClick" TabOrder="53" Text="Button0" Top="567" Width="18"></Button>
		<MaskEdit Border="Flat" DecimalLen="1" DigitLen="3" Enable="FALSE" Height="20" Id="me_impktl2_p" Left="303" Mask="###.#" Style="sty_ipt_form" TabOrder="54" Top="567" Width="40"></MaskEdit>
		<Button Height="18" Id="btn_impk3" ImageID="btn_icon_search" Left="283" OnClick="btn_pjt_OnClick" TabOrder="55" Text="Button0" Top="591" Width="18"></Button>
		<MaskEdit Border="Flat" DecimalLen="1" DigitLen="3" Enable="FALSE" Height="20" Id="me_impktl3_p" Left="303" Mask="###.#" Style="sty_ipt_form" TabOrder="56" Top="591" Width="40"></MaskEdit>
		<Static Align="Center" Height="24" Id="st_impe" Left="118" Style="sty_lb_form_basic" TabOrder="57" Text="기타부서" Top="616" VAlign="Middle" Width="58"></Static>
		<Button Height="18" Id="btn_impe" ImageID="btn_icon_search" Left="283" OnClick="btn_pjt2_OnClick" TabOrder="58" Text="Button0" Top="616" Width="18"></Button>
		<Static Align="Right" Height="24" Id="st_ncost" Left="10" Style="sty_lb_form_basic" TabOrder="59" Text="노무비&#32;" Top="513" VAlign="Middle" Width="45"></Static>
		<MaskEdit BindDataset="ds_qm007" Border="Flat" Column="NCOST" Height="20" Id="me_ncost" Left="56" Style="sty_ipt_form" TabOrder="60" Top="514" Width="102"></MaskEdit>
		<Combo Border="Flat" CodeColumn="code" DataColumn="value" DisplayRowCnt="5" Height="20" Id="cb_imp" INDEX="0" InnerDataset="ds_imp" Left="45" OnChanged="fn_combosel" Style="sty_ipt_search" TabOrder="61" Top="540" Width="67"></Combo>
		<Edit Border="Flat" Enable="FALSE" Height="20" Id="me_impktl" Left="184" Style="sty_ipt_search" TabOrder="62" Top="543" UpperOnly="TRUE" Width="94"></Edit>
		<Edit Border="Flat" Enable="FALSE" Height="20" Id="me_impktl2" Left="184" Style="sty_ipt_search" TabOrder="63" Top="567" UpperOnly="TRUE" Width="94"></Edit>
		<Edit Border="Flat" Enable="FALSE" Height="20" Id="me_impktl3" Left="184" Style="sty_ipt_search" TabOrder="64" Top="591" UpperOnly="TRUE" Width="94"></Edit>
		<Edit Border="Flat" Enable="FALSE" Height="20" Id="me_impetc" Left="184" Style="sty_ipt_search" TabOrder="65" Top="616" UpperOnly="TRUE" Width="94"></Edit>
	</Form>
	<Script><![CDATA[﻿﻿﻿﻿﻿﻿﻿﻿/*
 ******************************************************************************************
 * 기      능   : 
 * 작  성  자   : 
 * 작성  일자   : 
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
#include "LIB::commons.js";	// 공통 스크립트 
#include "LIB::common_cs.js";	// 서비스 공통 스크립트
//=========================================================================================
// [ PART 1 ]
// Form에서 사용될 전역변수를 선언
// FORM에서 사용되는 전역변수는 대문자로 작성하며, F_XXX 의 형태를 갖도록 한다. 
//=========================================================================================
var L_EMPLOYEE = false;
var totWbrtr = 0; // 2018.08.17 Han J.H 자재비 합계를 저장하는 변수
var depArr = []; // 2018.08.17 Han J.H 귀책부서를 저장하는 변수
var depChk = 0; // 2018.08.17 Han J.H 귀책부서를 세팅 시 참조하는 변수
var AP_EMPLOYEE = false; // 2018.08.17 Han J.H 로그인한 사용자가 결제라인에 포함되는지 체크하는 변수
var vDPT = "";	//수신결재부서
//=========================================================================================
// [ PART 2 ]
// Form Loading / Unloading 시 작업 정의
//=========================================================================================
function fn_OnLoadCompleted(obj) {
	// Form 로드 이벤트 맨 첫줄에 기술 
	gfn_initForm();

	// 자재번호 설정
	ds_cond.setColumn(0, "JQPRNUM", fa_jqprnum);
	ds_cond.SetColumn(0, "REQNO", fa_reqno);
	
	if(fa_bom == 'Y')	//BOM청구PGM에서 조회시 버튼 비활성화	2015.07.07 YAR
	{
		div_btn.btn_decide.Enable 	= false;	// 결재버튼
		div_btn.btn_draft.Enable  	= false;	// 기안버튼
		div_btn.btn_sendback.Enable = false;  	// 반송버튼
		div_btn.btn_print.Enable  	= false;	// 출력버튼
		btn_app.Enable = false;				// 결재선지정버튼
		bt_sav_matcost.Enable = false;			// matcost 저장버튼
	}
    // 청구종류코드, 자재평가유형코드 DataSet 가져오기
    var codeArr = ["3","2","WBAP_STAT"];
    var dsObjArr = [ds_reqkind_cd,ds_bwtar,ds_apstat];
    var addTypeArr = [G_CODE_NONE,G_CODE_NONE,G_CODE_NONE];
    gfn_searchCommCode(codeArr, dsObjArr, addTypeArr,true);
    
    // 내부직원 구분, 협력사인원의 경우 재료비 관련 정보 숨김처리 20180117 이하림
    var user_grp = gfn_getUserGroup();
   
    if(user_grp > "10"  || length(G_DPT1) > 0) {
		L_EMPLOYEE = true;
    }
    if(!L_EMPLOYEE) {
		fn_hideComponentsOfMatCost();
    }
	// 버튼초기화
	div_btn.btn_decide.Enable 	= false;	// 결재버튼
	div_btn.btn_draft.Enable  	= false;	// 기안버튼
	div_btn.btn_sendback.Enable = false;  	// 반송버튼	
	
	//============== 수신부서 결재그룹 체크 ===============================	
	gfn_initDs(ds_rcond, true);
	ds_rcond.SetColumn(0, "ZPROGRAM", "WBAP_DOCKIND");
	ds_rcond.SetColumn(0, "GBN", "01");	
	vDPT = gfn_getAuthDpt(ds_rcond);
	ds_rcond.ClearData();
    //=========================================================    

	// 고장코드 가져오기
	tit_clearActionInfo();
	tit_addSearchActionInfo("cs01:CS0101001A_S6");
	tit_addSearchActionInfo("cs01:CS0101001A_S7");
	
	tit_callService(
        ""
        , ""
        , ""
        , "ds_cause=ds_cause ds_pheno= ds_pheno"
        , ""
        , ""
        , true);
        
    fn_query();
    
}
/********************************************************************************
* 기      능   : 공통코드가 조회된 후의 Callback 함수 
********************************************************************************/
function fn_completeInit(sCode, sDsObj, sCodeType) {

}
/********************************************************************************
* 기      능   : form UnloadCompleted 
********************************************************************************/
function fn_OnUnloadCompleted(obj) {
	return gfn_isFormUnload(obj);
}
//=========================================================================================
// [ PART 3 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,form닫기)
//=========================================================================================
/********************************************************************************
* 기      능   : 조회 1
********************************************************************************/
function fn_query() {
	tit_clearActionInfo();
	tit_addSearchActionInfo("cs01:CS0101001B_S1", null, true);
	tit_addSearchActionInfo("cs01:CS0101001B_S2", null, true);

	// 결재자조회
	ds_cond.SetColumn( 0, "DNO", fa_jqprnum );
	tit_addSearchActionInfo("cs11:CS1101001B_S9");
	tit_addSearchActionInfo("cs11:CS1101001B_S14"); // 결제라인 조회
	
	tit_callService(
        ""
        , ""
        , "ds_cond=ds_cond"
        , "ds_qm007=ds_qm007 ds_list=ds_list ds_decide=ds_decide ds_decide_0=ds_decide_0"
        , ""
        , "fn_afterQuery"
        , ""
        , ""
        , true);
        
        
     
        
}
/********************************************************************************
* 기      능   : 삽입 20
********************************************************************************/
function fn_insert() {
	// 그리드에 row 추가 
	var newRow = gfn_addGridRow(grd_list, -1, "FLAG");
}
/********************************************************************************
* 기      능   : Delete 
********************************************************************************/
function fn_delete() {
	if ( ds_list.rowCount() < 1 ) {
		// 삭제할 정보 없음. 
		
		return;
	}
	
	// Grid 삭제 처리 
	gfn_deleteGridRow( grd_list, ds_list.row, "FLAG" );
}

/********************************************************************************
* 기      능   : 닫기  
********************************************************************************/
function fn_close() {
	close();
}
/********************************************************************************
* 기      능   : 액셀  
********************************************************************************/
// function fn_excel() {
	// Excel Export 
	// gfn_saveToExcel(grd_list, true );
// }


/********************************************************************************
* 기      능   : print 40
********************************************************************************/
function fn_print() {
	//UbiReport Call
	var arg = "fa_causetxt1="+quote(tx_causetxt1.value);
	//  협력사인원의 경우 재료비 숨김
	/*if(L_EMPLOYEE) {
		arg += " fa_matcost="+quote(ds_qm007.GetColumn(0,"MATCOST"));
    } else {
		arg += " fa_matcost=''";
    }*/
    
    for(var i=0; i<ds_decide_0.GetCount(); i++) {
		if(ds_decide_0.GetColumn(i, "APNUM") == "H"+G_USER_ID) {
			if(ds_qm007.GetColumn(0,"REQKIND_CD") == "3") {
				arg += " fa_matcost=''";
			} else {
				if(ds_qm007.GetColumn(0,"MATCOST") <= 0) {
					arg += " fa_matcost="+quote(totWbrtr);
				} else {
					arg += " fa_matcost="+quote(ds_qm007.GetColumn(0,"MATCOST"));
				}		
			}
			AP_EMPLOYEE = true;
		}
    }
    
    if(!AP_EMPLOYEE) {
		arg += " fa_matcost=''";
    }
    
    // 2018.08.17 Han J.H
    // 노무비를 arguments로 넘겨준다.
    arg += " fa_ncost="+quote(ds_qm007.GetColumn(0,"NCOST"));
    
//	var arg = "fa_causetxt1="+quote(tx_causetxt1.value) + " fa_matcost="+quote(ds_qm007.GetColumn(0,"MATCOST"));

	Dialog("CS01::CS0101001D.xml",arg, 1, 1, "Resize=true");
}
//=========================================================================================
// [ PART 4]
// Callback 함수 정의 : callback 함수명은 메인 함수의 fn_xxxx() 에서 xxxx 부분은 fn_afterXXXX()
// 형태가 되도록 작성 
//=========================================================================================
/********************************************************************************
* 기      능   : 조회 Callback  
********************************************************************************/
function fn_afterQuery(errCode, errMsg) {
	
	// 2019.07.17 MMPR 헤더 정보가 존재하지 않을시 팝업창 닫힘 처리. j.h
	if(ds_qm007.rowcount < 1) {
		gfn_showAlert("MMPR청구내역이 존재하지 않습니다. 팝업창을 종료합니다.");
		close();
	}

	sh_app.Visible 		= true;
	cb_apstat.Visible 	= true;
	st_app.Visible 		= true;
	//cb_imp.Visible      = true;
	
	if(G_USER_ID == "2023687" || G_USER_ID == "2018209" || G_USER_ID == "2018900"){}
	else{
		grd_list.SetColProp(22,"width",0);
	}
	
	// qtUserID = ds_qm007.GetColumn(0, "CREID");	    
    // logUserID = G_USER_ID;														//로그인 사용자
	// selfFlag = false;
	// if(logUserID == qtUserID) 													//본인여부
	// {
		// selfFlag = true;
	// }
	
	// 호기별이 아닌 전체 자재원가를 구하도록 변경. 2020.07.21 심다영 팀원 요청
	//ds_cond.SetColumn(0, "POSID", ds_qm007.GetColumn(0, "HOGI"));	//MMPR 자재원가 확인 2015.04.22 YAR
	ds_cond.SetColumn(0, "REQNO", ds_qm007.GetColumn(0, "REQNO"));
	tit_clearActionInfo();
	tit_addSearchActionInfo("cs01:CS0101001B_S3", null, true);
 
/*
	tit_callService(
		""
		, ""
		, "ds_cond=ds_cond"
		, "ds_list2=ds_list2"
		, ""
		, "fn_afterQuery2"
		, true);
*/
	tit_callService(
		""
		, ""
		, "ds_cond=ds_cond"
		, "ds_list2=ds_list2"
		, ""
		, "fn_afterQuery2"
		, ""
		, ""
		, true);   
   
 
   
   
	if (length(ds_qm007.GetColumn(0,"JQPRNUM")) > 0 )
	{
	   tx_causetxt1.value = gfn_getLongText(ds_qmtext,"ZQMT002",ds_qm007.GetColumn(0,"JQPRNUM"),"ZA01");
	}

    var user_grp = gfn_getUserGroup();

	if(L_EMPLOYEE) // 내부직원 작성가능
	{
		sh_app.Visible = true;
		cb_apstat.Visible = true;
		st_app.Visible = true;
		//cb_imp.Visible = true;
		
		// 2018.08.17 Han J.H 기안단계에서 노무비를 수정하지 못하도록 비활성화
		me_ncost.Enable = false;		
		
		var apstat = parseInt(ds_qm007.GetColumn(0, "APSTAT"));

		// 기안자 접수자는 화면에서 결재선 지정
		//if (apstat < 1 || apstat == "3" && ds_qm007.GetColumn(0,"REDPT1") == G_DPT1 || apstat == "2" || apstat == "5")		
		if (apstat < 1 || apstat == "3" && ds_qm007.GetColumn(0,"REDPT1") == vDPT || apstat == "2" || apstat == "5")		
		{
		  btn_app.Visible = true;
          
          // 수신부서에서 재료비 입력  // 기안 작성시 재료비 입력으로 수정 : 윤경환 기원 요청 - HSS 2013.09.10
          // if(fa_redpt1 == G_DPT1)
		  // {
		     // st_matcost.Visible = true;
	         // me_matcost.Visible = true;
		     // bt_sav_matcost.Visible = true;
		     // me_matcost.enable = true;
		     // bt_sav_matcost.enable = true;
		  // }

		} else {
			btn_app.Visible = false;
			
			// 2018.08.17 Han J.H
			// 1차 기안자의 경우 귀책부서를 저장하도록 버튼 활성화
			if(ds_decide.GetColumn(0, "SEQNO") == "1" && ds_decide.GetColumn(0, "SEQSTAT") == "1") {
				me_ncost.Enable = false;
				
				cb_imp.Enable = true;
				
				//me_impktl.Enable = true;
				btn_impk1.Enable = true;
				//me_impktl_p.Enable = true;
				
				//me_impktl2.Enable = true;
				btn_impk2.Enable = true;
				//me_impktl2_p.Enable = true;
				
				//me_impktl3.Enable = true;
				btn_impk3.Enable = true;
				//me_impktl3_p.Enable = true;
				
				//me_impetc.Enable = true;
				btn_impe = true;
								
			} else {
				me_ncost.Enable = false;
				
				cb_imp.Enable = false;
				
				me_impktl.Enable = false;
				btn_impk1.Enable = false;
				me_impktl_p.Enable = false;
				
				me_impktl2.Enable = false;
				btn_impk2.Enable = false;
				me_impktl2_p.Enable = false;
				
				me_impktl3.Enable = false;
				btn_impk3.Enable = false;
				me_impktl3_p.Enable = false;
				
				me_impetc.Enable = false;
				btn_impe.Enable = false;			
			}
			
			// 결재 완료후 재료비 수정 제한 - 2013.09.10 HSS
            if(ds_qm007.GetColumn(0,"APSTAT") == "6")
		    {
		       fn_hideComponentsOfMatCost();
		    }
		}

		if(G_USER_ID == "3011038" || G_USER_ID == "2020882" || G_USER_ID == "2018209" || G_USER_ID == "2025418" || G_USER_ID == "3002519"
		 || G_USER_ID == "3002519" || G_USER_ID == "3005160") { // 윤경환KJ, 이동진SW ,최선경SW ,이세호SW 결재선 지정 활성화(내부조직변경)
		    btn_app.Visible = true;
		}

		// 기안진행(1), 수신진행(4) 일때 결재자일때 결재버튼 활성화.
		if( (ds_qm007.GetColumn(0,"APSTAT") > '0' && ds_qm007.GetColumn(0,"APSTAT") != '3' && ds_qm007.GetColumn(0,"APSTAT") < '6') && G_USER_ID == substr(ds_decide.GetColumn(0, "APNUM"),1) ) {
			div_btn.btn_decide.Enable   = true;		// 결재버튼
			div_btn.btn_sendback.Enable = true;		// 반송버튼
		} else {
			div_btn.btn_decide.Enable = false;		// 결재버튼
			div_btn.btn_sendback.Enable = false;	// 반송버튼
		}

		ufn_getApprovalData();
		
	} else 
	{
		btn_app.Visible = false;
		//보수협력사로 로그인 했을 경우 기안 접수가 가능해야한다.
		if( user_grp == "10"){
			if(ds_qm007.GetColumn(0,"APSTAT") == "0" || ds_qm007.GetColumn(0,"APSTAT") == "2" || ds_qm007.GetColumn(0,"APSTAT") =="5")
			{
				btn_app.Visible 	= true;			
				ufn_getApprovalData();
			}
		}
		ufn_getApprovalData();
	}
	
}
/********************************************************************************
* 기      능   : 재료비 조회 및 수정기능 숨김처리 
1. 수신결재 완료된 경우
2. 협력사 직원의 경우 
********************************************************************************/
function fn_hideComponentsOfMatCost() {

   st_matcost.Visible = false;
   me_matcost.Visible = false;
   bt_sav_matcost.Visible = false;
   me_matcost.enable = false;
   bt_sav_matcost.enable = false;
   
   // 2018.08.17 Han J.H
   // 귀책부서 및 노무비를 수정하지 못하게 비활성화 처리
   //st_ncost.Enable = false;
   me_ncost.Enable = false;
   
   cb_imp.Enable = false;
   
   me_impktl.Enable = false;
   me_impktl2.Enable = false;
   me_impktl3.Enable = false;
   me_impktl_p.Enable = false;
   me_impktl2_p.Enable = false;
   me_impktl3_p.Enable = false;
   
   btn_impk1.Enable = false;
   btn_impk2.Enable = false;
   btn_impk3.Enable = false;
   
   me_impetc.Enable = false;
}
/********************************************************************************
* 기      능   : 조회 Callback  
********************************************************************************/
function fn_afterQuery2(errCode, errMsg) {
	// 2018.08.17 Han J.H 조회가 이루어지고 재료비 총계를 초기화 시킨다.
	totWbrtr = 0;

	// 2018.07.31 From SAP에서 재료비 가져오기
	var rowCount = ds_list.GetRowCount();
	
	// 자재번호 및 수량을 통해 각 자재의 자재비 총계를 구한다.
	if(rowCount > 0) {
			for(var i=0; i < rowCount; i++) {
				tit_clearActionInfo();
				tit_addSearchActionInfo("cs01:CS0101001B_S4");
				
				tit_callService(
					""
					, ""
					, "ds_list=ds_list"
					, "ds_mcost=ds_mcost"
					, ""
					, "fn_afterMMCalc"
					, true);				

			}
			
			// 귀책부서에서 내부부서가 존재하면 세팅
			if(length(ds_qm007.GetColumn(0,"IMPKTL1")) > 0) {
				fn_combosel(cb_imp, 'inner');
			} else if(length(ds_qm007.GetColumn(0,"IMPETC")) > 0) { // 귀책부서에서 기타부서가 존재하면 세팅
				fn_combosel(cb_imp, 'etc');
			} else {
				fn_combosel(cb_imp, 'inner');
			}
			
			// 귀책부서 정보를 depArr(Global Variable) 변수에 세팅한다.
			// 
			if(length(ds_qm007.GetColumn(0,"IMPKTL1")) > 0 || length(ds_qm007.GetColumn(0,"IMPETC")) > 0) {
			
				depArr[0] = ds_qm007.GetColumn(0,"IMPKTL1");
				depArr[1] = ds_qm007.GetColumn(0,"IMPKTL2");
				depArr[2] = ds_qm007.GetColumn(0,"IMPKTL3");
				depArr[3] = ds_qm007.GetColumn(0,"IMPETC");
				
				
				// SQL의 경우 두가지를 활용
				// 내부부서, 기타부서에 따라 분기처리
				var sql = "";
				for(var i=0; i < depArr.length; i++) {
					if(depArr[i] != null && depArr[i].length > 0) { // 부서코드값 존재시에만 해당 로직을 수행함
						if(i == 0 || i == 1 || i == 2) { // 내부부서 1,2,3
							ds_cond.SetColumn(0, "CURDATE", gfn_getCurrDate());
							ds_cond.SetColumn(0, "KOSTL", depArr[i]);
							sql = "cs01:CS0101001E_S1";
						}
						
						if(i == 3) { // 기타부서
							ds_cond.SetColumn(0, "SETNAME", depArr[i]);
							sql = "cs01:CS0101001F_S1";
						}
						
						tit_clearActionInfo();
						tit_addSearchActionInfo(sql);
						
						depChk = i;
						
						tit_callService(
							""
							, ""
							, "ds_cond=ds_cond"
							//, "ds_department=ds_list"
							, "ds_department=ds_list"
							, ""
							, "fn_afterDepartment"
							, true);					
						
						
					}
				}			
			}
	}
	
	
	//tit_clearActionInfo();
	//tit_addSearchActionInfo("cs01:CS0101009A_I1");

    //김영준시 요청으로 전결규정 금액으로 판가의 합+ 노무비로 변경
	//ufn_setRegulation(ds_list2.Sum("SAMT2"));	// 자재원가 합계
	//김영준시 요청으로 전결규정 금액으로 원가의 합+ 노무비로 변경
	//ufn_setRegulation(ds_list2.Sum("SAMT1"));	// 자재판가 합계 
	//ufn_setRegulation(ds_list2.Sum("SAMT2"));	// 자재원가 합계 
	ufn_setRegulation(ds_list2.Sum("SAMT1"));	// 자재판가 합계 
}

/********************************************************************************
* 기      능   : 귀책부서정보 세팅 
0 : 내부부서1
1 : 내부부서2
2 : 내부부서3
3 : 기타부서
********************************************************************************/
function fn_afterDepartment(errCode, errMsg) {
	// ds_apcond.SetColumn(0,"DOCNO", ds_qm007.GetColumn(0,"JQPRNUM"));
	//ds_department_0.SetColumn(depChk,"IMPKTL1", ds_qm007.GetColumn(0,"IMPKTL1"));
	if(depChk == '0') { // 내부부서 1
		if(length(ds_department.GetColumn(0, "KOSTL")) > 0) {
			me_impktl.Text = ds_department.GetColumn(0, "KTEXT");
			me_impktl.UserData = ds_department.GetColumn(0, "KOSTL");
			
			me_impktl_p.Text = ds_qm007.GetColumn(0, "IMPKTL_P");
			
			me_impktl.Enable = true;
			me_impktl_p.Enable = true;
		
		}
	} else if(depChk == '1') { // 내부부서 2
		if(length(ds_department.GetColumn(0, "KOSTL")) > 0) {
			me_impktl2.Text = ds_department.GetColumn(0, "KTEXT");
			me_impktl2.UserData = ds_department.GetColumn(0, "KOSTL");
			
			me_impktl2_p.Text = ds_qm007.GetColumn(0, "IMPKTL2_P");
			
			me_impktl2.Enable = true;
			me_impkt2_p.Enable = true;

		}	
	} else if(depChk == '2') { // 내부부서 3
		if(length(ds_department.GetColumn(0, "KOSTL")) > 0) {
			me_impktl3.Text = ds_department.GetColumn(0, "KTEXT");
			me_impktl3.UserData = ds_department.GetColumn(0, "KOSTL");
			
			me_impktl3_p.Text = ds_qm007.GetColumn(0, "IMPKTL3_P");
			
			me_impktl3.Enable = true;
			me_impkt3_p.Enable = true;			
		}	
	} else if(depChk == '3') { // 기타부서
		if(length(ds_department.GetColumn(0, "SETNAME")) > 0) {
			me_impetc.Text = ds_department.GetColumn(0, "DESCRIPT");
			me_impetc.UserData = ds_department.GetColumn(0, "SETNAME");
			
			me_impetc.Enable = true;
		}	
	}
}

/********************************************************************************
* 기      능   : 자재코드 및 수량을 활용하여 자재비 총계를 구함
********************************************************************************/
function fn_afterMMCalc(errCode, errMsg) {
	totWbrtr = totWbrtr + ds_mcost.GetColumn("0", "WBRTR");
}

/********************************************************************************
* 기      능   : 전결규정 설정	2015.04.20 YAR
********************************************************************************/
function ufn_setRegulation(samt1){

	samt1 = toNumber(samt1) + toNumber(me_ncost.value);

//alert(	toNumber(samt1) );
//if (toNumber(samt1) > 205000 )  alert("ok");

	/*
	//해당청구 건 자재원가합계 기준 
	if(toNumber(samt2) < 3000000)										//300만 미만
	{
		//ed_reg.Text = "팀장 전결";
		ed_reg.Text = "팀장 전결";  //gds_approve.GetColumn(0, "NAME") + " 전결";
	}
	else if(toNumber(samt2) >= 3000000 && toNumber(samt2) < 5000000)	//300만~500만
	{
		//ed_reg.Text = "담당 전결";
		ed_reg.Text = "본부장 전결";  //gds_approve.GetColumn(1, "NAME")+ " 전결";
	}
	else																//500만 이상
	{
		//ed_reg.Text = "부문장 전결";
		ed_reg.Text = "부문장 전결"; //gds_approve.GetColumn(2, "NAME")+ " 전결";
	}
	*/
	//====================================전결규정 변경======================================
	//해당청구 건 자재원가합계 기준 
	if(toNumber(samt1) < 1000000)										//10만 미만
	{		
		ed_reg.Text = "지사장(팀장) 전결";  
	}
	else if(toNumber(samt1) >= 1000000 && toNumber(samt1) < 3000000)	//10만~300만
	{		
		ed_reg.Text = "담당 전결";  
	}
	//else if(toNumber(samt1) >= 2000000 && toNumber(samt1) < 4000000)	//200만~400만
	//{		
	//	ed_reg.Text = "담당,본부장 전결";  
	//}	
	else																//300만 이상
	{		
		ed_reg.Text = "본부장 전결"; 
	}	 
	 
	 
	 
	 
	//기존소스 주석처리 : 강제로 값을 저장시 저장된값 읽어 오기
	//me_matcost.Value = ds_list.Sum("SAMT2");
	//if ( ds_qm007.GetColumn(0,"MATCOST") <= 0 )  me_matcost.Value = ds_list.Sum("SAMT2");
	
	// 2018.08.17 Han J.H 
	// MMPR 수리청구의 경우, 반납품으로 인해 재료비를 무조건 0으로 세팅함.
	// ZQMT007 테이블의 재료비가 존재하면 해당 값을 세팅함. 존재하지 않을시에는 SAP에서 구한 자재비 총계값을 세팅함.
    // SAP에서 구한 자재비 총계값을 세팅함.
    if(ds_qm007.GetColumn(0,"REQKIND_CD") == "3") {
		me_matcost.Value = 0;
    } else {
		if(ds_qm007.GetColumn(0,"MATCOST") <= 0) {
			me_matcost.Value = totWbrtr;
		} else {
			me_matcost.Value = ds_qm007.GetColumn(0,"MATCOST");
		}		
    }
    
	/*if(ds_qm007.GetColumn(0,"MATCOST") <= 0) {
		me_matcost.Value = totWbrtr;
	} else {
		me_matcost.Value = ds_qm007.GetColumn(0,"MATCOST");
	}*/
	
	//전결규정
	ed_reg.enable = true;
	ed_reg.color = "gray";
	ed_reg.bkColor = "#E9E9E9";
	ed_reg.readOnly = true;
	ed_reg.ToolTipText = "원가기준 전결규정";
}

/********************************************************************************
* 기      능   : 저장 Callback  
********************************************************************************/
function fn_afterSave(errCode, errMsg) {
	if ( ds_error.rowcount() > 0 ) {
		gfn_showMsg("CE00001");
	} else {
		gfn_showMsg("CI00003");
	}
}
//=========================================================================================
// [ PART 5 ]
// Detail Process Event 정의 ( User Define function )
// 사용자 정의 함수는 ufn_xxxx() 형태로 작성 
//=========================================================================================
/********************************************************************************
* 기      능   : 결재 데이터 조회
********************************************************************************/
function ufn_getApprovalData() {

    ds_apcond.SetColumn(0,"DOCNO", ds_qm007.GetColumn(0,"JQPRNUM"));
    ds_apcond.SetColumn(0,"DOCKIND", "1");
   
   	tit_clearActionInfo();
	tit_addSearchActionInfo("cs04:CS0401000A_S1");

	tit_callService(
		  ""
		, ""
		, "ds_apcond=ds_apcond"
		, "ds_aplist=ds_aplist"
		, ""
		, ""
        , "");	
}

//=========================================================================================
// [ PART 6 ]
// component Event 정의 : 각 Component 별 이벤트 
//=========================================================================================
/********************************************************************************
* 기      능   : 그리드 헤더 클릭시 정렬 처리 
********************************************************************************/
function grd_list_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
{
	if ( nCell == 0 ) {
		// 그리드 표시할 컬럼 선택 
		gfn_selectGridCol(obj);
	} else {
		// 그리드 정렬 처리 
		gfn_sortGrid(obj,nCell);
	}
}

// 결재선 지정 POPUP
function btn_app_OnClick(obj)
{
	// 보수협력사일 경우 기안접수테이블에 insert 한다.
	var user_grp = gfn_getUserGroup();
	//if( user_grp == '10' ) {
	//	alert( '보수협력시일 경우 기안접수테이블에 insert 한다!' );
	//	return;
	//}

	var appgubn = "S";
	var redraft = "N";
	if(ds_qm007.GetColumn(0,"APSTAT") == "3") appgubn = "R";
    if(ds_qm007.GetColumn(0, "APSTAT") == "2" || ds_qm007.GetColumn(0, "APSTAT") == "5")	redraft = "Y";
    
    var arg = "fa_docno=" + quote(ds_qm007.GetColumn(0,"JQPRNUM")) + " fa_dockind=" + quote("1") + " fa_appgubn=" + quote(appgubn)
    + " fa_redraft=" + quote(redraft);
    
    
	// 보수협력사일 경우 기안접수테이블에 insert 한다.
	if(user_grp == '10' && substr(G_USER_ID,0,1) == '8') {
		var rtnArgs = gfn_openPopup2("CS0401001B", true, arg);
		if( rtnArgs[0] == "S" ) {
			btn_app.Enable = false;
		}
	} else {
		var rtnArgs = gfn_openPopup2("CS0401001A", true, arg);
		if( rtnArgs[0] == "S" ) {
			btn_app.Enable = false;
		}
	}
}

function ufn_saveMatcost(obj)
{
	if(me_matcost.value <= 0)
	{
		return;
	}
    
    if(!gfn_showConfirm("CI00014", "재료비")) return;

	tit_clearActionInfo();
	tit_addMultiActionInfo("cs01:CS0101001B_U1");

	tit_callService(
		 ""
		, ""
		, "ds_qm007=ds_qm007:A"
		, ""
		, ""
		, "fn_afterSaveMatcost"
        , ""
        , ""
        , true);	
}

/********************************************************************************
* 기      능   :  의견저장 Callback  
********************************************************************************/
function fn_afterSaveMatcost(errCode, errMsg) {
	if ( errCode!= 0 ) {
		gfn_showMsg("CE00001"+errMsg);
	} else {
		gfn_showMsg("CI00003");
		fn_query();
	}
}

/********************************************************************************
* 기      능   : 결재 15
********************************************************************************/
function fn_decide() {
	var decidertn;   // 결재 팝업 리턴코드
	
	gfn_clearMsgBar();
	
	if( ds_decide.rowCount() < 1 ) {
		return;
	}
	
			
	//if( !gfn_showConfirm("CI00014", "문서번호 : "+ quote(ds_decide.GetColumn(0,"DOCNO"))+ "결재") ) return;
	decidertn = gfn_showConfirm_decide("CI00014", "문서번호 : "+ quote(ds_decide.GetColumn(0,"DOCNO"))+ "결재") ;	
	if(decidertn == "C") return; //A : 승인, C : 취소 , W : 의견승인
	
	// 2018.08.17 Han J.H
	// 귀책부서 유효성 체크
	// 귀책비율이 없거나 혹은 0 일시 결제되지 않도록 처리함.
	if(cb_imp.Value == 'inner') {
		if(!gfn_isNull(me_impktl, true) && gfn_isNull(me_impktl_p, true)) {
			gfn_showAlert("첫번째 내부부서의 귀책비율을 입력해주시기 바랍니다.");
			me_impktl_p.SetFocus();
			return;	
		}
		
		if(!gfn_isNull(me_impktl, true) && me_impktl_p.Value == 0) {
			gfn_showAlert("첫번째 내부부서의 귀책비율은 0이 될 수 없습니다. 다시 설정해 주십시오.");
			fn_decideReset('inner');
			return;
		}
		
		if(!gfn_isNull(me_impktl2, true) && gfn_isNull(me_impktl2_p, true)) {
			gfn_showAlert("두번째 내부부서의 귀책비율을 입력해주시기 바랍니다.");
			me_impktl2_p.SetFocus();
			return;	
		}
		
		if(!gfn_isNull(me_impktl2, true) && me_impktl2_p == 0) {
			gfn_showAlert("두번째 내부부서의 귀책비율은 0이 될 수 없습니다. 다시 설정해 주십시오.");
			fn_decideReset('inner');
			return;
		}		
		
		if(!gfn_isNull(me_impktl3, true) && gfn_isNull(me_impktl3_p, true)) {
			gfn_showAlert("세번째 내부부서의 귀책비율을 입력해주시기 바랍니다.");
			me_impktl3_p.SetFocus();
			return;	
		}	
		
		if(!gfn_isNull(me_impktl3, true) && me_impktl3_p == 0) {
			gfn_showAlert("세번째 내부부서의 귀책비율은 0이 될 수 없습니다. 다시 설정해 주십시오.");
			fn_decideReset('inner');
			return;
		}		
		
		// 귀책비율 총합계가 100% 이상이거나 미만인 경우 결제되지 않도록 유효성 체크
		var totImpktlPer = 0;
		if(!gfn_isNull(me_impktl, true)) {
			totImpktlPer += ToFloat(me_impktl_p.Text);
		}
			
		if(!gfn_isNull(me_impktl2, true)) {
			totImpktlPer += ToFloat(me_impktl2_p.Text);
		}
			
		if(!gfn_isNull(me_impktl3, true)) {
			totImpktlPer += ToFloat(me_impktl3_p.Text);
		}		
			
		if(totImpktlPer > 100.0 || totImpktlPer < 100.0) {
			gfn_showAlert("귀책비율의 합계는 100% 보다 작거나 클수 없습니다.");
			return;
		}	
	} else if(cb_imp.Value == 'etc') {
		if(gfn_isNull(me_impetc, true)) {
			gfn_showAlert("기타부서를 입력해주시기 바랍니다.");
			return;	
		}	
	}
	
	// 2018.09.19
	// MMPR 신규개발 반영전 자재청구 내용을 체크하는 로직
	chkBeforeDataFunc();
	
	//----------------------------------------------------------------------
	// 의견 입력 팝업 추가 
	// f팝업 전달 변수 fa_docno : 문서번호 ,fa_dockind : 문서종류 
	// return 값 : rtn_yn (Y:의견입력됨 N:의견입력안됨)
	
	//if(gfn_showConfirm("CW10025","의견을 입력하시겠습니까?") )
	if( decidertn == "W" )    //의견입력 승인시
	{
		var arg = "";
		arg = " fa_docno=" + quote(ds_decide.GetColumn(0,"DOCNO")) +" fa_dockind=" + quote(ds_decide.GetColumn(0,"DOCKIND"))
		  +" seqno=" + quote(ds_decide.GetColumn(0,"SEQNO"));
		var rtn_yn = gfn_openPopup2("CS0401001C", true , arg);
	}
	//alert("rtn_yn:"+rtn_yn);
	// 의견입력 팝업 종료
	//----------------------------------------------------------------------
		
	// 2018.08.17 Han J.H
	// 데이터셋에 귀책부서 값 세팅
	// 내부부서인 경우
	if(cb_imp.Value == 'inner') {
		ds_qm007.SetColumn(0, "IMPGUBN", "I"); // I : 내부부서
		
		// 귀책비율 세팅
		ds_qm007.SetColumn(0, "WAERS", "KRW");
		ds_qm007.SetColumn(0, "MATCOST", me_matcost.Value);
		//ds_qm007.SetColumn(0, "NCOST", me_ncost.Value);
		
		if(gfn_isNull(me_ncost, true)) {
			ds_qm007.SetColumn(0, "NCOST", "0");
		} else {
			ds_qm007.SetColumn(0, "NCOST", me_ncost.Value);
		}
		
		if(gfn_isNull(me_impktl, true)) {
			ds_qm007.SetColumn(0, "IMPKTL1", " ");
		} else {
			ds_qm007.SetColumn(0, "IMPKTL1", me_impktl.UserData);
		}
		
		if(gfn_isNull(me_impktl2, true)) {
			ds_qm007.SetColumn(0, "IMPKTL2", " ");
		} else {
			ds_qm007.SetColumn(0, "IMPKTL2", me_impktl2.UserData);
		}
		
		if(gfn_isNull(me_impktl3, true)) {
			ds_qm007.SetColumn(0, "IMPKTL3", " ");
		} else {
			ds_qm007.SetColumn(0, "IMPKTL3", me_impktl3.UserData);
		}
				
		if(gfn_isNull(me_impktl_p, true)) {
			ds_qm007.SetColumn(0, "IMPKTL_P", " ");
		} else {
			ds_qm007.SetColumn(0, "IMPKTL_P", me_impktl_p.Text);
		}
		
		if(gfn_isNull(me_impktl2_p, true)) {
			ds_qm007.SetColumn(0, "IMPKTL2_P", " ");
		} else {
			ds_qm007.SetColumn(0, "IMPKTL2_P", me_impktl2_p.Text);
		}
		
		if(gfn_isNull(me_impktl3_p, true)) {
			ds_qm007.SetColumn(0, "IMPKTL3_P", " ");
		} else {
			ds_qm007.SetColumn(0, "IMPKTL3_P", me_impktl3_p.Text);
		}
		
		// 2018.07
		if(gfn_isNull(me_impetc, true)) {
			ds_qm007.SetColumn(0, "IMPETC", " ");
		}
		
	} else if(cb_imp.Value == 'etc') {
		ds_qm007.SetColumn(0, "IMPGUBN", "E"); // E : 기타
		
		ds_qm007.SetColumn(0, "WAERS", "KRW");
		ds_qm007.SetColumn(0, "MATCOST", me_matcost.Value);
		//ds_qm007.SetColumn(0, "NCOST", me_ncost.Value);
		
		if(gfn_isNull(me_ncost, true)) {
			ds_qm007.SetColumn(0, "NCOST", "0");
		} else {
			ds_qm007.SetColumn(0, "NCOST", me_ncost.Value);
		}		
		
		if(gfn_isNull(me_impetc, true)) {
			ds_qm007.SetColumn(0, "IMPETC", " ");
		} else {
			ds_qm007.SetColumn(0, "IMPETC", me_impetc.UserData);
		}
		
		// 2018.07
		if(gfn_isNull(me_impktl, true)) {
			ds_qm007.SetColumn(0, "IMPKTL1", " ");
		}
				
		if(gfn_isNull(me_impktl2, true)) {
			ds_qm007.SetColumn(0, "IMPKTL2", " ");
		}
						
		if(gfn_isNull(me_impktl3, true)) {
			ds_qm007.SetColumn(0, "IMPKTL3", " ");
		}
								
		if(gfn_isNull(me_impktl_p, true)) {
			ds_qm007.SetColumn(0, "IMPKTL_P", "0.0");
		}
										
		if(gfn_isNull(me_impktl2_p, true)) {
			ds_qm007.SetColumn(0, "IMPKTL2_P", "0.0");
		}
												
		if(gfn_isNull(me_impktl3_p, true)) {
			ds_qm007.SetColumn(0, "IMPKTL3_P", "0.0");
		}												
		
	}
	
	tit_clearActionInfo();
	// 결재상태변경
	ds_decide.SetColumn(0, "SEQSTAT", "3");
	tit_addMultiActionInfo("cs04:CS0401002A_U2");
 	tit_addMultiActionInfo("cs04:CS0401002A_U3");
 	tit_addMultiActionInfo("cs01:CS0101001B_U2"); // MMPR 연동 테이블
 	
 	// 2018.08.17 Han J.H
	// 결제정보 세팅
	// MMPR 청구, MMPR 수리청구, MMPR 업체재고 소진인 경우에만
	if(ds_qm007.GetColumn(0,"REQKIND_CD") == '2' || ds_qm007.GetColumn(0,"REQKIND_CD") == '3' || ds_qm007.GetColumn(0,"REQKIND_CD") == '4') {
		// SE팀 최선경 사원 요청
		// 기안결제 완료 시 수신결제 처리되도록 강제 세팅
		if(ds_decide.GetColumn(0,"APPGUBN") == 'S' && ds_decide.GetColumn(0, "APNUM") == "H"+G_USER_ID && ds_decide.GetColumn(0, "SEQNO") == ds_decide.GetColumn(0, "MAX_SEQNO")) { // 차순별 결제정보에서 기안결제가 마지막 결제자
			ds_decide.SetColumn(0, "APSTAT", '6');
			tit_addMultiActionInfo("cs01:CS0101001B_U3"); // ZWBAP01
			tit_addMultiActionInfo("cs01:CS0101001B_U4"); // ZCST016
		} else if(ds_decide.GetColumn(0,"APPGUBN") == 'R' && ds_decide.GetColumn(0, "APNUM") == "H"+G_USER_ID && ds_decide.GetColumn(0, "SEQNO") == ds_decide.GetColumn(0, "MAX_SEQNO")) {
			tit_addMultiActionInfo("cs01:CS0101001B_U4"); // ZCST016		
		}
		
	}
 	
	tit_callService(
		  ""
		, ""
		, "ds_list_0=ds_decide ds_qm007=ds_qm007"
		, ""
		, ""
		, "fn_afterDecide"
		, true);
}
/********************************************************************************
* 기      능   : 결재 Callback  
********************************************************************************/
function fn_afterDecide(errCode, errMsg) {
	if ( ds_error.rowcount() > 0 ) {
		gfn_showAlert("CE00001");
	} else {
		gfn_showAlert("CI00003");
		div_btn.btn_decide.Enable 	= false;	// 결재버튼
		//div_btn.btn_print.Enable  	= false;	// 출력버튼
		div_btn.btn_sendback.Enable = false;  	// 반송버튼
		//parent.fn_query();
		//fn_close();
		fn_query();
	}
}

/********************************************************************************
* 기      능   : 반송 65
********************************************************************************/
function fn_sendback() {
	var decidertn;   // 결재 팝업 리턴코드

	gfn_clearMsgBar();
	
	if( ds_decide.rowCount() < 1 ) {
		// 승인할 정보 없음. 
		return;
	}
	
	//if( !gfn_showConfirm("CI00014", "문서번호 : "+ quote(ds_decide.GetColumn(0,"DOCNO"))+ "반송") ) return;
	decidertn = gfn_showConfirm_decide("CI00014", "문서번호 : "+ quote(ds_decide.GetColumn(0,"DOCNO"))+ "반송") ;	
	if(decidertn == "C") return; //A : 승인, C : 취소 , W : 의견승인

	//----------------------------------------------------------------------
	// 의견 입력 팝업 추가 
	// f팝업 전달 변수 fa_docno : 문서번호 ,fa_dockind : 문서종류 
	// return 값 : rtn_yn (Y:의견입력됨 N:의견입력안됨)
	
	//if(gfn_showConfirm("CW10025","의견을 입력하시겠습니까?") )
	if( decidertn == "W" )    //의견입력 승인시
	{
		var arg = "";
		arg = " fa_docno=" + quote(ds_decide.GetColumn(0,"DOCNO")) +" fa_dockind=" + quote(ds_decide.GetColumn(0,"DOCKIND"));
		var rtn_yn = gfn_openPopup2("CS0401001C", true , arg);
	}
	// 의견입력 팝업 종료
	//----------------------------------------------------------------------
	
	tit_clearActionInfo();
	// 결재상태변경
	ds_decide.SetColumn(0, "SEQSTAT", "2");
	// 결재정보 관리 - 차순별 결재정보  update(zwbap02)
 	tit_addMultiActionInfo("cs04:CS0401002A_U2");
 	// 현장지원 결재 정보 관리 update(zwbap01)
 	tit_addMultiActionInfo("cs04:CS0401002A_U3");

	tit_callService(
		  ""
		, ""
		, "ds_list_0=ds_decide" 
		, ""
		, ""
		, "fn_afterSendback"
		, true);
}

/********************************************************************************
* 기      능   : 반송 Callback  
********************************************************************************/
function fn_afterSendback(errCode, errMsg) {
	if ( ds_error.rowcount() > 0 ) {
		gfn_showAlert("CE00001");
	} else {
		gfn_showAlert("CI00003");
		div_btn.btn_decide.Enable 	= false;	// 결재버튼
		div_btn.btn_draft.Enable  	= false;	// 기안버튼
		div_btn.btn_sendback.Enable = false;  	// 반송버튼
		//parent.fn_query();
		//fn_close();
	}
}

/********************************************************************************
* 기      능   : 내부부서 검색팝업
********************************************************************************/
function btn_pjt_OnClick(obj)
{
	var arg = "comName=''";
	var rtn = gfn_openPopup("CS0101001E",true,arg);
	
	// 2018.08.17 Han J.H
	// 내부부서 검색팝업에서 리턴값 존재 시 해당 부서의 코드와 텍스트를 세팅함.
	if(rtn.length > 0) {
		if(obj.id == 'btn_impk1') { // 내부부서1
			
			ds_qm007.SetColumn(0, "IMPKTL1", rtn[0]);
			
			me_impktl.Enable = true;
			me_impktl_p.Enable = true;
			
			me_impktl.UserData = rtn[0];
			me_impktl.text = rtn[1];
					
		} else if(obj.id == 'btn_impk2') { // 내부부서2
			
			ds_qm007.SetColumn(0, "IMPKTL2", rtn[0]);
			
			me_impktl2.Enable = true;
			me_impktl2_p.Enable = true;
			
			me_impktl2.UserData = rtn[0];
			me_impktl2.text = rtn[1];		
			
		} else if(obj.id == 'btn_impk3') { // 내부부서3
			
			ds_qm007.SetColumn(0, "IMPKTL3", rtn[0]);
			
			me_impktl3.Enable = true;
			me_impktl3_p.Enable = true;
			
			me_impktl3.UserData = rtn[0];
			me_impktl3.text = rtn[1];
			
		}
	}
}

/********************************************************************************
* 기      능   : 기타부서 검색팝업
********************************************************************************/
function btn_pjt2_OnClick(obj)
{
	var arg = "comName=''";
	var rtn = gfn_openPopup("CS0101001F",true,arg);
	
	// 2018.08.17 Han J.H
	// 기타부서 검색팝업에서 리턴값 존재 시 해당 부서의 코드와 텍스트를 세팅함.	
	if(rtn.length > 0) {
		ds_qm007.SetColumn(0, "IMPETC", rtn[0]);
			
		me_impetc.Enable = true;
			
		me_impetc.UserData = rtn[0];
		me_impetc.text = rtn[1];	
	}
			
	//}	
}

/********************************************************************************
* 기      능   : 귀책구분에 따른 콤보박스 다이내믹 처리
********************************************************************************/
function fn_combosel(obj,strCode,strText,nOldIndex,nNewIndex)
{
	// 내부부서 선택시 기타부서 항목을 비활성화 처리
	if(strCode == 'inner') {
		cb_imp.Index = 0;
	
		st_impe.Visible = false;
		me_impetc.Visible = false;
		btn_impe.Visible = false;
		
		st_impk.Visible = true;
		me_impktl.Visible = true;
		btn_impk1.Visible = true;
		me_impktl_p.Visible = true;
		
		me_impktl2.Visible = true;
		btn_impk2.Visible = true;
		me_impktl2_p.Visible = true;
		
		me_impktl3.Visible = true;
		btn_impk3.Visible = true;
		me_impktl3_p.Visible = true;
		
		st_impe.Top = '614';
		me_impetc.Top = '614';
		btn_impe.Top = '614';		
				
	} else if(strCode == 'etc') {
	// 기타부서 선택시 내부부서 항목을 비활성화 처리
		cb_imp.Index = 1;
	
		st_impk.Visible = false;
		me_impktl.Visible = false;
		btn_impk1.Visible = false;
		me_impktl_p.Visible = false;
		
		me_impktl2.Visible = false;
		btn_impk2.Visible = false;
		me_impktl2_p.Visible = false;
		
		me_impktl3.Visible = false;
		btn_impk3.Visible = false;
		me_impktl3_p.Visible = false;
			
		st_impe.Visible = true;
		me_impetc.Visible = true;
		btn_impe.Visible = true;
					
		st_impe.Top = '540';
		me_impetc.Top = '540';
		btn_impe.Top = '540';
	}
}

/********************************************************************************
* 기      능   : 유효성 체크에 의해 귀책부서 항목을 강제 리셋하도록 처리함
********************************************************************************/
function fn_decideReset(arg) {
	if(arg == 'inner') {
		me_impktl.Text = '';
		me_impktl_p.Value = '';
		me_impktl.Enable = false;
		me_impktl_p.Enable = false;
		
		me_impktl2.Text = '';
		me_impktl2_p.Value = '';
		me_impktl2.Enable = false;
		me_impktl2_p.Enable = false;
		
		me_impktl3.Text = '';
		me_impktl3_p.Value = '';
		me_impktl3.Enable = false;
		me_impktl3_p.Enable = false;		
		
	} else if(arg == 'etc') {
		me_impetc.Text = '';
		me_impetc.Enable = false;
	}
}

/********************************************************************************
* 기      능   : 2018.09.17 이전 청구내역을 체크한다.
********************************************************************************/
function chkBeforeDataFunc() {
	tit_clearActionInfo();
	
	tit_addSearchActionInfo("cs01:CS0101001B_S5",true);
	
	tit_callService(
		  ""
		, ""
		, "ds_qm007=ds_qm007"
		, "ds_cst016_chk=ds_cst016_chk"
		, ""
		, "fn_afterChkBeforeData"
		, true
		, null
		, true);
}

/********************************************************************************
* 기      능   : 2018.09.17 이전 청구내역이 없다면 ZCST016 테이블에 해당내용을 Insert 시킴
********************************************************************************/
function fn_afterChkBeforeData(errCode, errMsg) {
	if ( ds_error.rowcount() > 0 ) {
		gfn_showAlert("CE00001");
	} else {
		if(ds_cst016_chk.GetRowCount() < 1) {
			var jobKind = "0";
			// MMPR 수리청구의 경우 업무구분을 이천으로 세팅
			if (ds_qm007.GetColumn(0,"REQKIND_CD") == "3") {
				jobKind = "2"; // 이천
			}
			
			// 노무비, 업무구분 저장
			ds_qm007.SetColumn(0,"NCOST","0");
			ds_qm007.SetColumn(0,"CRNAM",G_USER_ID);
			ds_qm007.SetColumn(0,"JOBKIND",jobKind);				
			
			tit_clearActionInfo();
			tit_addSearchActionInfo("cs01:CS0101009A_I1",true);
			
			tit_callService(
				""
				, ""
				, "ds_list=ds_qm007"
				, ""
				, ""
				, ""
				, true
				, null
				, true);			
		}
	}
}
]]></Script>
</Window>