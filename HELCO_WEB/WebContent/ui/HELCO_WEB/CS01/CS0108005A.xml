<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="562" Id="CS0108005A" Left="8" OnLoadCompleted="fn_OnLoadCompleted" OnUnloadCompleted="fn_OnUnloadCompleted" PidAttrib="7" Title="소모재/개인공구&#32;관리" Top="8" Ver="1.0" Width="978" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_cond">
				<Contents>
					<colinfo id="GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="TEM" size="256" summ="default" type="STRING"/>
					<colinfo id="DPT" size="256" summ="default" type="STRING"/>
					<colinfo id="ARA" size="256" summ="default" type="STRING"/>
					<colinfo id="BSU" size="256" summ="default" type="STRING"/>
					<colinfo id="BPM" size="256" summ="default" type="STRING"/>
					<colinfo id="PJT" size="256" summ="default" type="STRING"/>
					<colinfo id="DOC" size="256" summ="default" type="STRING"/>
					<colinfo id="RNO" size="256" summ="default" type="STRING"/>
					<colinfo id="RDF" size="256" summ="default" type="STRING"/>
					<colinfo id="RDT" size="256" summ="default" type="STRING"/>
					<colinfo id="MTY" size="256" summ="default" type="STRING"/>
					<colinfo id="PST" size="256" summ="default" type="STRING"/>
					<colinfo id="UNM" size="256" summ="default" type="STRING"/>
					<colinfo id="BNM" size="256" summ="default" type="STRING"/>
					<colinfo id="MATNR" size="256" summ="default" type="STRING"/>
					<colinfo id="MATNR_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="BAP" size="256" summ="default" type="STRING"/>
					<colinfo id="SPT" size="256" summ="default" type="STRING"/>
					<colinfo id="VEND_CD" size="256" summ="default" type="STRING"/>
					<record>
						<ARA></ARA>
						<BAP></BAP>
						<BNM></BNM>
						<BPM></BPM>
						<BSU></BSU>
						<DOC></DOC>
						<DPT></DPT>
						<GBN></GBN>
						<MATNR></MATNR>
						<MATNR_NM></MATNR_NM>
						<MTY></MTY>
						<PJT></PJT>
						<PST></PST>
						<RDF></RDF>
						<RDT></RDT>
						<RNO></RNO>
						<SPT></SPT>
						<TEM></TEM>
						<UNM></UNM>
						<VEND_CD></VEND_CD>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list">
				<Contents>
					<colinfo id="FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="DNO" size="256" summ="default" type="STRING"/>
					<colinfo id="SIR" size="256" summ="default" type="STRING"/>
					<colinfo id="REQNO" size="256" summ="default" type="STRING"/>
					<colinfo id="DOC" size="256" summ="default" type="STRING"/>
					<colinfo id="PST" size="256" summ="default" type="STRING"/>
					<colinfo id="PST_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="BSU" size="256" summ="default" type="STRING"/>
					<colinfo id="BSU_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="MDT" size="256" summ="default" type="STRING"/>
					<colinfo id="MID" size="256" summ="default" type="STRING"/>
					<colinfo id="IDA" size="256" summ="default" type="STRING"/>
					<colinfo id="SDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="RDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="DEL" size="256" summ="default" type="STRING"/>
					<colinfo id="CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="SAMT" size="256" summ="default" type="STRING"/>
					<colinfo id="APSTAT" size="256" summ="default" type="STRING"/>
					<colinfo id="APSTAT_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="VKGRP" size="256" summ="default" type="STRING"/>
					<colinfo id="VKGRP_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="CTEXT2" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_detail" OnColumnChanged="ds_detail_OnColumnChanged">
				<Contents>
					<colinfo id="FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="DOC" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="SIR" size="256" summ="default" type="STRING"/>
					<colinfo id="MATNR" size="256" summ="default" type="STRING"/>
					<colinfo id="MAKTX" size="256" summ="default" type="STRING"/>
					<colinfo id="MEINS" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="SAMT1" size="256" summ="default" type="STRING"/>
					<colinfo id="MENGE" size="256" summ="default" type="STRING"/>
					<colinfo id="SAMT2" size="256" summ="default" type="STRING"/>
					<colinfo id="CHAR1" size="256" summ="default" type="STRING"/>
					<colinfo id="UNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="KNTTP" size="256" summ="default" type="STRING"/>
					<colinfo id="KOSTL" size="256" summ="default" type="STRING"/>
					<colinfo id="AUFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="WERKS" size="256" summ="default" type="STRING"/>
					<colinfo id="LGORT" size="256" summ="default" type="STRING"/>
					<colinfo id="SE_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="BBSU" size="256" summ="default" type="STRING"/>
					<colinfo id="BDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="CDAT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ma_cond">
				<Contents>
					<colinfo id="MATNR" size="255" summ="default" type="STRING"/>
					<colinfo id="INPUTROW" size="256" summ="default" type="STRING"/>
					<record>
						<INPUTROW></INPUTROW>
						<MATNR></MATNR>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ma_list">
				<Contents>
					<colinfo id="MATNR" size="54" summ="default" type="STRING"/>
					<colinfo id="MATNR_NM" size="120" summ="default" type="STRING"/>
					<colinfo id="MAKTX" size="256" summ="default" type="STRING"/>
					<colinfo id="MEINS" size="9" summ="default" type="STRING"/>
					<colinfo id="SAMT1" size="11" summ="default" type="DECIMAL"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_gbn1">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="VALUE" size="256" summ="default" type="STRING"/>
					<record>
						<CODE></CODE>
						<VALUE>-&#32;전체&#32;-</VALUE>
					</record>
					<record>
						<CODE>1</CODE>
						<VALUE>소모재</VALUE>
					</record>
					<record>
						<CODE>2</CODE>
						<VALUE>개인공구</VALUE>
					</record>
					<record>
						<CODE>3</CODE>
						<VALUE>공동공구</VALUE>
					</record>
					<record>
						<CODE>4</CODE>
						<VALUE>계측기</VALUE>
					</record>
					<record>
						<CODE>5</CODE>
						<VALUE>일반자재</VALUE>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_gbn2">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="VALUE" size="256" summ="default" type="STRING"/>
					<record>
						<CODE>1</CODE>
						<VALUE>소모재</VALUE>
					</record>
					<record>
						<CODE>2</CODE>
						<VALUE>개인공구</VALUE>
					</record>
					<record>
						<CODE>3</CODE>
						<VALUE>공동공구</VALUE>
					</record>
					<record>
						<CODE>4</CODE>
						<VALUE>계측기</VALUE>
					</record>
					<record>
						<CODE>5</CODE>
						<VALUE>일반자재</VALUE>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_bap">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME>-&#32;전체&#32;-</CODE_NAME>
					</record>
					<record>
						<CODE>1</CODE>
						<CODE_NAME>기안&#32;진행</CODE_NAME>
					</record>
					<record>
						<CODE>2</CODE>
						<CODE_NAME>기안&#32;반송</CODE_NAME>
					</record>
					<record>
						<CODE>3</CODE>
						<CODE_NAME>기안&#32;결재완료</CODE_NAME>
					</record>
					<record>
						<CODE>4</CODE>
						<CODE_NAME>수신&#32;진행</CODE_NAME>
					</record>
					<record>
						<CODE>5</CODE>
						<CODE_NAME>수신&#32;반송</CODE_NAME>
					</record>
					<record>
						<CODE>6</CODE>
						<CODE_NAME>수신&#32;결재완료</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_detail_1" OnColumnChanged="ds_detail_OnColumnChanged">
				<Contents>
					<colinfo id="FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="DOC" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="SIR" size="256" summ="default" type="STRING"/>
					<colinfo id="MATNR" size="256" summ="default" type="STRING"/>
					<colinfo id="MAKTX" size="256" summ="default" type="STRING"/>
					<colinfo id="MEINS" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="SAMT1" size="256" summ="default" type="STRING"/>
					<colinfo id="MENGE" size="256" summ="default" type="STRING"/>
					<colinfo id="SAMT2" size="256" summ="default" type="STRING"/>
					<colinfo id="CHAR1" size="256" summ="default" type="STRING"/>
					<colinfo id="UNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="KNTTP" size="256" summ="default" type="STRING"/>
					<colinfo id="KOSTL" size="256" summ="default" type="STRING"/>
					<colinfo id="AUFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="WERKS" size="256" summ="default" type="STRING"/>
					<colinfo id="LGORT" size="256" summ="default" type="STRING"/>
					<colinfo id="SE_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="BBSU" size="256" summ="default" type="STRING"/>
					<colinfo id="BDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="CDAT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_detail_0" OnColumnChanged="ds_detail_OnColumnChanged">
				<Contents>
					<colinfo id="FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="DOC" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="SIR" size="256" summ="default" type="STRING"/>
					<colinfo id="MATNR" size="256" summ="default" type="STRING"/>
					<colinfo id="MAKTX" size="256" summ="default" type="STRING"/>
					<colinfo id="MEINS" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="SAMT1" size="256" summ="default" type="STRING"/>
					<colinfo id="MENGE" size="256" summ="default" type="STRING"/>
					<colinfo id="SAMT2" size="256" summ="default" type="STRING"/>
					<colinfo id="CHAR1" size="256" summ="default" type="STRING"/>
					<colinfo id="UNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="KNTTP" size="256" summ="default" type="STRING"/>
					<colinfo id="KOSTL" size="256" summ="default" type="STRING"/>
					<colinfo id="AUFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="WERKS" size="256" summ="default" type="STRING"/>
					<colinfo id="LGORT" size="256" summ="default" type="STRING"/>
					<colinfo id="SE_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="BBSU" size="256" summ="default" type="STRING"/>
					<colinfo id="BDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="CDAT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_docno_gen">
				<Contents>
					<colinfo id="PFX" size="256" type="STRING"/>
					<colinfo id="DOCNO" size="256" type="STRING"/>
					<record>
						<PFX></PFX>
						<DOCNO></DOCNO>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_decide">
				<Contents>
					<colinfo id="MANDT" size="256" summ="default" type="STRING"/>
					<colinfo id="DOCNO" size="256" summ="default" type="STRING"/>
					<colinfo id="DOCKIND" size="256" summ="default" type="STRING"/>
					<colinfo id="APPGUBN" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQNO" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQSTAT" size="256" summ="default" type="STRING"/>
					<colinfo id="APDPT1" size="256" summ="default" type="STRING"/>
					<colinfo id="APDPT1_N" size="256" summ="default" type="STRING"/>
					<colinfo id="APNUM" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE" size="256" summ="default" type="STRING"/>
					<colinfo id="APTIM" size="256" summ="default" type="STRING"/>
					<colinfo id="APDESC" size="256" summ="default" type="STRING"/>
					<colinfo id="CNT" size="256" summ="default" type="STRING"/>
					<record>
						<APDATE></APDATE>
						<APDESC></APDESC>
						<APDPT1></APDPT1>
						<APDPT1_N></APDPT1_N>
						<APNUM></APNUM>
						<APPGUBN></APPGUBN>
						<APRNK></APRNK>
						<APTIM></APTIM>
						<CNT></CNT>
						<DOCKIND></DOCKIND>
						<DOCNO></DOCNO>
						<MANDT></MANDT>
						<SEQNO></SEQNO>
						<SEQSTAT></SEQSTAT>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_conf_list">
				<Contents>
					<colinfo id="APRNK_S1" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM_S1" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE_S1" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK_S2" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM_S2" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE_S2" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK_S3" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM_S3" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE_S3" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK_S4" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM_S4" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE_S4" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK_S5" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM_S5" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE_S5" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK_R1" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM_R1" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE_R1" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK_R2" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM_R2" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE_R2" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK_R3" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM_R3" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE_R3" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK_R4" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM_R4" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE_R4" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK_R5" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM_R5" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE_R5" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_draftpers_list">
				<Contents>
					<colinfo id="D_TEM" size="256" summ="default" type="STRING"/>
					<colinfo id="D_RANK" size="256" summ="default" type="STRING"/>
					<colinfo id="D_NAME" size="256" summ="default" type="STRING"/>
					<colinfo id="D_DATE" size="256" summ="default" type="STRING"/>
					<colinfo id="DOCNO" size="256" summ="default" type="STRING"/>
					<colinfo id="D_TOTEM" size="256" summ="default" type="STRING"/>
					<record>
						<D_DATE></D_DATE>
						<D_NAME></D_NAME>
						<D_RANK></D_RANK>
						<D_TEM></D_TEM>
						<D_TOTEM></D_TOTEM>
						<DOCNO></DOCNO>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_count">
				<Contents>
					<colinfo id="CNT" size="256" summ="default" type="STRING"/>
					<record>
						<CNT></CNT>
					</record>
				</Contents>
			</Dataset>
			<Dataset CanColumnChange="ds_input_CanColumnChange" DataSetType="Dataset" Id="ds_list_0">
				<Contents>
					<colinfo id="FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="DNO" size="256" summ="default" type="STRING"/>
					<colinfo id="SIR" size="256" summ="default" type="STRING"/>
					<colinfo id="REQNO" size="256" summ="default" type="STRING"/>
					<colinfo id="DOC" size="256" summ="default" type="STRING"/>
					<colinfo id="PST" size="256" summ="default" type="STRING"/>
					<colinfo id="PST_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="BSU" size="256" summ="default" type="STRING"/>
					<colinfo id="BSU_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="MDT" size="256" summ="default" type="STRING"/>
					<colinfo id="MID" size="256" summ="default" type="STRING"/>
					<colinfo id="IDA" size="256" summ="default" type="STRING"/>
					<colinfo id="SDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="RDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="DEL" size="256" summ="default" type="STRING"/>
					<colinfo id="CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="SAMT" size="256" summ="default" type="STRING"/>
					<colinfo id="APSTAT" size="256" summ="default" type="STRING"/>
					<colinfo id="APSTAT_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="VKGRP" size="256" summ="default" type="STRING"/>
					<colinfo id="VKGRP_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="CTEXT2" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_pst">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME>-&#32;전체&#32;-</CODE_NAME>
					</record>
					<record>
						<CODE>A1</CODE>
						<CODE_NAME>작성</CODE_NAME>
					</record>
					<record>
						<CODE>A3</CODE>
						<CODE_NAME>기안</CODE_NAME>
					</record>
					<record>
						<CODE>A2</CODE>
						<CODE_NAME>반송</CODE_NAME>
					</record>
					<record>
						<CODE>A6</CODE>
						<CODE_NAME>승인</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_excel" OnColumnChanged="ds_detail_OnColumnChanged">
				<Contents>
					<colinfo id="DOC" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="SIR" size="256" summ="default" type="STRING"/>
					<colinfo id="REQNO" size="256" summ="default" type="STRING"/>
					<colinfo id="PST" size="256" summ="default" type="STRING"/>
					<colinfo id="PST_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="BSU" size="256" summ="default" type="STRING"/>
					<colinfo id="BSU_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="MDT" size="256" summ="default" type="STRING"/>
					<colinfo id="MID" size="256" summ="default" type="STRING"/>
					<colinfo id="MID_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="IDA" size="256" summ="default" type="STRING"/>
					<colinfo id="SDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="APSTAT_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="APSTAT" size="256" summ="default" type="STRING"/>
					<colinfo id="RDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="MATNR" size="256" summ="default" type="STRING"/>
					<colinfo id="MAKTX" size="256" summ="default" type="STRING"/>
					<colinfo id="MEINS" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="SAMT1" size="256" summ="default" type="INT"/>
					<colinfo id="MENGE" size="256" summ="default" type="STRING"/>
					<colinfo id="SAMT2" size="256" summ="default" type="INT"/>
					<colinfo id="CHAR1" size="256" summ="default" type="STRING"/>
					<colinfo id="UNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="KNTTP" size="256" summ="default" type="STRING"/>
					<colinfo id="KOSTL" size="256" summ="default" type="STRING"/>
					<colinfo id="AUFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="WERKS" size="256" summ="default" type="STRING"/>
					<colinfo id="LGORT" size="256" summ="default" type="STRING"/>
					<colinfo id="SE_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="BBSU" size="256" summ="default" type="STRING"/>
					<colinfo id="BDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="CDAT" size="256" summ="default" type="STRING"/>
					<record>
						<APSTAT></APSTAT>
						<APSTAT_NM></APSTAT_NM>
						<AUFNR></AUFNR>
						<BBSU></BBSU>
						<BDAT></BDAT>
						<BSU></BSU>
						<BSU_NM></BSU_NM>
						<CDAT></CDAT>
						<CHAR1></CHAR1>
						<DOC></DOC>
						<GBN></GBN>
						<IDA></IDA>
						<KNTTP></KNTTP>
						<KOSTL></KOSTL>
						<LGORT></LGORT>
						<MAKTX></MAKTX>
						<MATNR></MATNR>
						<MDT></MDT>
						<MEINS></MEINS>
						<MENGE></MENGE>
						<MID></MID>
						<MID_NM></MID_NM>
						<PST></PST>
						<PST_NM></PST_NM>
						<RDAT></RDAT>
						<REQNO></REQNO>
						<SAMT1/>
						<SAMT2/>
						<SDAT></SDAT>
						<SE_NO></SE_NO>
						<SEQ></SEQ>
						<SIR></SIR>
						<UNAME></UNAME>
						<WERKS></WERKS>
					</record>
					<record>
						<APSTAT></APSTAT>
						<APSTAT_NM></APSTAT_NM>
						<AUFNR></AUFNR>
						<BBSU></BBSU>
						<BDAT></BDAT>
						<BSU></BSU>
						<BSU_NM></BSU_NM>
						<CDAT></CDAT>
						<CHAR1></CHAR1>
						<DOC></DOC>
						<GBN></GBN>
						<IDA></IDA>
						<KNTTP></KNTTP>
						<KOSTL></KOSTL>
						<LGORT></LGORT>
						<MAKTX></MAKTX>
						<MATNR></MATNR>
						<MDT></MDT>
						<MEINS></MEINS>
						<MENGE></MENGE>
						<MID></MID>
						<MID_NM></MID_NM>
						<PST></PST>
						<PST_NM></PST_NM>
						<RDAT></RDAT>
						<REQNO></REQNO>
						<SAMT1/>
						<SAMT2/>
						<SDAT></SDAT>
						<SE_NO></SE_NO>
						<SEQ></SEQ>
						<SIR></SIR>
						<UNAME></UNAME>
						<WERKS></WERKS>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_packing_dtl" OnColumnChanged="ds_detail_OnColumnChanged">
				<Contents>
					<colinfo id="FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="DOC" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="SIR" size="256" summ="default" type="STRING"/>
					<colinfo id="MATNR" size="256" summ="default" type="STRING"/>
					<colinfo id="MAKTX" size="256" summ="default" type="STRING"/>
					<colinfo id="MEINS" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="SAMT1" size="256" summ="default" type="STRING"/>
					<colinfo id="MENGE" size="256" summ="default" type="STRING"/>
					<colinfo id="SAMT2" size="256" summ="default" type="STRING"/>
					<colinfo id="CHAR1" size="256" summ="default" type="STRING"/>
					<colinfo id="UNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="KNTTP" size="256" summ="default" type="STRING"/>
					<colinfo id="KOSTL" size="256" summ="default" type="STRING"/>
					<colinfo id="AUFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="WERKS" size="256" summ="default" type="STRING"/>
					<colinfo id="LGORT" size="256" summ="default" type="STRING"/>
					<colinfo id="SE_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="BBSU" size="256" summ="default" type="STRING"/>
					<colinfo id="BDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="CDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN_NM" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_packing_dtl_0" OnColumnChanged="ds_detail_OnColumnChanged">
				<Contents>
					<colinfo id="FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="DOC" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="SIR" size="256" summ="default" type="STRING"/>
					<colinfo id="MATNR" size="256" summ="default" type="STRING"/>
					<colinfo id="MAKTX" size="256" summ="default" type="STRING"/>
					<colinfo id="MEINS" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="SAMT1" size="256" summ="default" type="STRING"/>
					<colinfo id="MENGE" size="256" summ="default" type="STRING"/>
					<colinfo id="SAMT2" size="256" summ="default" type="STRING"/>
					<colinfo id="CHAR1" size="256" summ="default" type="STRING"/>
					<colinfo id="UNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="KNTTP" size="256" summ="default" type="STRING"/>
					<colinfo id="KOSTL" size="256" summ="default" type="STRING"/>
					<colinfo id="AUFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="WERKS" size="256" summ="default" type="STRING"/>
					<colinfo id="LGORT" size="256" summ="default" type="STRING"/>
					<colinfo id="SE_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="BBSU" size="256" summ="default" type="STRING"/>
					<colinfo id="BDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="CDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN_NM" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_packing">
				<Contents>
					<colinfo id="VKGRP" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_wf_cond">
				<Contents>
					<colinfo id="DOCNO" size="256" summ="default" type="STRING"/>
					<record>
						<DOCNO></DOCNO>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_wf_stat">
				<Contents>
					<colinfo id="DOCNO" size="256" summ="default" type="STRING"/>
					<colinfo id="DOCKIND" size="256" summ="default" type="STRING"/>
					<colinfo id="APPGUBN" size="256" summ="default" type="STRING"/>
					<colinfo id="APPGUBNNM" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQNO" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQNONM" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQSTAT" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQSTATNM" size="256" summ="default" type="STRING"/>
					<colinfo id="APDPT1" size="256" summ="default" type="STRING"/>
					<colinfo id="APDPT1_N" size="256" summ="default" type="STRING"/>
					<colinfo id="APNUM" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE" size="256" summ="default" type="STRING"/>
					<colinfo id="APTIM" size="256" summ="default" type="STRING"/>
					<colinfo id="APDESC" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
		</Datasets>
		<Div Height="243" Id="div_bottom" TabOrder="22" Text="Div0" Top="317" Width="976">
			<Contents>
				<Grid AutoEnter="TRUE" AutoFitEndLine="Hide" BindDataset="ds_detail" BkColor2="default" BoldHead="true" Border="Flat" Bottom="238" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="215" Id="grd_detail" InputPanel="FALSE" Left="8" LineColor="user20" LineType="ExHORZ" OnExpandEdit="grd_list_OnExpandEdit" OnExpandUp="grd_dtl_btn_matnr_OnClick" OnHeadClick="grd_detail_OnHeadClick" Right="968" RowHeight="20" Style="sty_grid" TabOrder="1" TabStop="true" Top="23" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="960">
					<contents>
						<format id="Default">
							<columns>
								<col width="30"/>
								<col width="80"/>
								<col width="180"/>
								<col width="58"/>
								<col width="80"/>
								<col width="70"/>
								<col width="60"/>
								<col width="80"/>
								<col width="70"/>
								<col width="120"/>
								<col width="80"/>
								<col width="80"/>
								<col width="80"/>
								<col width="60"/>
								<col width="60"/>
								<col width="85"/>
								<col width="80"/>
								<col width="120"/>
							</columns>
							<head>
								<cell col="0" display="checkbox" edit="checkbox" font="굴림,9" text="변경"/>
								<cell col="1" display="text" font="굴림,9" text="자재코드"/>
								<cell col="2" display="text" font="굴림,9" text="자재내역"/>
								<cell col="3" display="text" font="굴림,9" text="단위"/>
								<cell col="4" display="text" font="굴림,9" text="구분"/>
								<cell col="5" display="text" font="굴림,9" text="단가"/>
								<cell align="center" col="6" display="text" font="굴림,9" text="수량"/>
								<cell col="7" display="text" font="굴림,9" text="총금액"/>
								<cell col="8" display="text" font="굴림,9" text="특성치"/>
								<cell col="9" display="text" font="굴림,9" text="사용자"/>
								<cell col="10" display="text" font="굴림,9" text="계정지수범주"/>
								<cell col="11" display="text" font="굴림,9" text="Cost&#32;Center"/>
								<cell col="12" display="text" font="굴림,9" text="Order&#32;No."/>
								<cell col="13" display="text" font="굴림,9" text="플랜트"/>
								<cell col="14" display="text" font="굴림,9" text="저장위치"/>
								<cell col="15" display="text" font="굴림,9" text="출하일"/>
								<cell col="16" display="text" font="굴림,9" text="발주일"/>
								<cell col="17" display="text" font="굴림,9" text="발주업체"/>
							</head>
							<body>
								<cell bkcolor2="user22" col="0" colid="CHK" display="checkbox" edit="checkbox"/>
								<cell align="center" bkcolor2="user22" bkimagealign="right" col="1" colid="MATNR" cursor="ibeam" display="text" edit="regexprupper" expandimage="btn_icon_search" expandshow="true" expandsize="18" RegExprFilter="A-Z0-9"/>
								<cell bkcolor2="user22" col="2" colid="MAKTX" display="text"/>
								<cell align="center" bkcolor2="user22" col="3" colid="MEINS" display="text"/>
								<cell align="left" bkimagealign="right" bkimageid="icon_grid_edit" col="4" colid="GBN" combocol="CODE" combodataset="ds_gbn2" combotext="VALUE" display="combo" edit="combo"/>
								<cell align="right" bkcolor2="user22" col="5" colid="SAMT1" display="number" Mask="#,###,##0"/>
								<cell align="center" bkimagealign="right" bkimageid="icon_grid_edit" col="6" colid="MENGE" display="number" edit="integer"/>
								<cell align="right" bkcolor2="user22" col="7" colid="SAMT2" display="number" Mask="#,###,##0"/>
								<cell align="center" bkimagealign="right" bkimageid="icon_grid_edit" col="8" colid="CHAR1" display="text" edit="normal"/>
								<cell align="left" bkimagealign="right" bkimageid="icon_grid_edit" col="9" colid="UNAME" display="text" edit="normal"/>
								<cell align="center" bkcolor2="user22" bkimagealign="right" col="10" colid="KNTTP" display="text" imemode="english" limit="1" Mask="Z"/>
								<cell align="center" bkcolor2="user22" bkimagealign="right" col="11" colid="KOSTL" display="text"/>
								<cell align="center" bkcolor2="user22" bkimagealign="right" col="12" colid="AUFNR" display="text"/>
								<cell align="center" bkcolor2="user22" bkimagealign="right" col="13" colid="WERKS" display="text"/>
								<cell align="center" bkcolor2="user22" bkimagealign="right" col="14" colid="LGORT" display="text" limit="4" Mask="ZZZZ"/>
								<cell col="15" colid="CDAT" display="text" expandimage="btn_grid_icon_pen" expandsize="18" Mask="####-##-##"/>
								<cell align="center" col="16" colid="BDAT" display="date"/>
								<cell col="17" colid="BBSU" display="text"/>
							</body>
						</format>
					</contents>
				</Grid>
				<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_addrow" ImageID="btn_sub_04" Left="771" LeftMargin="12" OnClick="btn_addrow_OnClick" Style="sty_btn" TabOrder="4" Text="자재추가" Transparent="TRUE" Width="72"></Button>
				<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_delrow" ImageID="btn_sub_04" Left="847" LeftMargin="12" OnClick="btn_delrow_OnClick" Style="sty_btn" TabOrder="3" Text="자재삭제" Transparent="TRUE" Width="72"></Button>
				<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_save" ImageID="btn_sub_02" Left="922" LeftMargin="12" OnClick="fn_save" Style="sty_btn" TabOrder="2" Text="저장" Transparent="TRUE" Width="47"></Button>
			</Contents>
		</Div>
		<PopupDiv Border="Flat" Height="146" Id="PopupDiv0" Left="990" TabOrder="5" TabStop="FALSE" Top="160" Width="154">
			<Contents>
				<Calendar Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="146" Id="cal_temp" MonthOnly="TRUE" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" OnDayClick="PopupDiv0_cal_temp_OnDayClick" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="1" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="-2" Value="20130101" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="152"></Calendar>
			</Contents>
		</PopupDiv>
		<Shape BKColor="user0" Bottom="72" Height="72" Id="Shape0" Left="0" LineColor="user1" Right="978" TabOrder="1" Top="0" Type="Rectangle" Width="978"></Shape>
		<Static Align="Right" Height="20" Id="st_bsu" Left="7" Style="sty_lb_search" TabOrder="3" Text="협력사&#32;" Top="49" VAlign="Middle" Width="70"></Static>
		<Div BKColor="user0" Height="20" Id="div_code" Left="80" OnLoadCompleted="fn_OnLoadCompleted" OnTimer="WB0199010A_OnTimer" TabOrder="2" Text="Div0" Top="49" Url="WB01::WB0199010A.xml" Width="415">
			<Contents></Contents>
		</Div>
		<Calendar BindDataset="ds_cond" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="RDF" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_fdt" Left="784" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_search" SundayTextColor="user35" TabOrder="4" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="4" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="86"></Calendar>
		<Static Align="Center" Border="None" Color="user7" Font="굴림,9" Height="20" Id="st_btw" Left="867" TabOrder="6" Text="~" Top="4" VAlign="Middle" Width="18"></Static>
		<Calendar BindDataset="ds_cond" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="RDT" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_tdt" Left="880" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_search" SundayTextColor="user35" TabOrder="7" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="4" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="88"></Calendar>
		<Static Align="Right" Height="20" Id="st_etn" Left="7" Style="sty_lb_search" TabOrder="8" Text="문서번호&#32;" Top="5" VAlign="Middle" Width="70"></Static>
		<MaskEdit BindDataset="ds_cond" Border="Flat" BorderColor="ACTIVEBORDER" Column="DOC" Font="돋움,9" Height="20" Id="ed_doc" Left="80" LeftMargin="3" Mask="ZZZZZZZZZ" Style="sty_ipt_form_read" TabOrder="9" TabStop="FALSE" Top="5" Type="STRING" Width="97"></MaskEdit>
		<Static Align="Right" Height="20" Id="st_pst" Left="231" Style="sty_lb_search" TabOrder="10" Text="진행상태&#32;" Top="27" VAlign="Middle" Width="70"></Static>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="CODE" Column="PST" DataColumn="CODE_NAME" Height="20" Id="cb_pst" InnerDataset="ds_pst" Left="303" Style="sty_ipt_search" TabOrder="11" Top="26" Width="100"></Combo>
		<Static Align="Right" Height="20" Id="Static0" Left="711" Style="sty_lb_search" TabOrder="12" Text="청구기간&#32;" Top="4" VAlign="Middle" Width="70"></Static>
		<Static Align="Right" Height="20" Id="Static1" Left="7" Style="sty_lb_search" TabOrder="13" Text="구분&#32;" Top="27" VAlign="Middle" Width="70"></Static>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="CODE" Column="MTY" DataColumn="VALUE" Height="20" Id="cb_mty" InnerDataset="ds_gbn1" Left="79" Style="sty_ipt_search" TabOrder="14" Top="26" Width="100"></Combo>
		<Static Align="Right" Height="20" Id="Static2" Left="231" Style="sty_lb_search" TabOrder="15" Text="청구번호&#32;" Top="5" VAlign="Middle" Width="70"></Static>
		<MaskEdit BindDataset="ds_cond" Border="Flat" BorderColor="ACTIVEBORDER" Column="RNO" Font="돋움,9" Height="20" Id="ed_rnr" Left="304" LeftMargin="3" Mask="ZZZZZZZZZZ" Style="sty_ipt_form_read" TabOrder="16" TabStop="FALSE" Top="5" Type="STRING" Width="97"></MaskEdit>
		<Static Align="Right" Height="20" Id="Static3" Left="448" Style="sty_lb_search" TabOrder="17" Text="사용자&#32;" Top="5" VAlign="Middle" Width="70"></Static>
		<Static Align="Right" Height="20" Id="Static4" Left="711" Style="sty_lb_search" TabOrder="18" Text="발주업체명&#32;" Top="49" VAlign="Middle" Width="70"></Static>
		<Static Align="Right" Height="20" Id="Static5" Left="711" Style="sty_lb_search" TabOrder="19" Text="자재번호&#32;" Top="27" VAlign="Middle" Width="70"></Static>
		<Edit BindDataset="ds_cond" Border="Flat" BorderColor="ACTIVEBORDER" Column="MATNR" Font="돋움,9" Height="20" Id="ed_matnr" ImeMode="none" Left="784" LeftMargin="3" Style="sty_ipt_form_read" TabOrder="20" TabStop="FALSE" Top="27" Width="67"></Edit>
		<Button Cursor="HAND" Height="18" Id="btn_matnr" ImageID="btn_icon_search" Left="855" OnClick="btn_matnr_OnClick" TabOrder="21" TabStop="FALSE" Text="Button0" Top="28" Transparent="TRUE" Width="18"></Button>
		<Edit BindDataset="ds_cond" Border="Flat" BorderColor="ACTIVEBORDER" Column="BNM" Font="돋움,9" Height="20" Id="ed_bnm" ImeMode="none" Left="784" LeftMargin="3" Style="sty_ipt_form_read" TabOrder="23" TabStop="FALSE" Top="49" Width="183"></Edit>
		<Edit BindDataset="ds_cond" Border="Flat" BorderColor="ACTIVEBORDER" Column="UNM" Font="돋움,9" Height="20" Id="en_unm" ImeMode="none" Left="521" LeftMargin="3" Style="sty_ipt_form_read" TabOrder="24" TabStop="FALSE" Top="5" Width="97"></Edit>
		<Static Align="Right" Height="20" Id="st_bap" Left="448" Style="sty_lb_search" TabOrder="25" Text="결재상태&#32;" Top="27" VAlign="Middle" Width="70"></Static>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="CODE" Column="BAP" DataColumn="CODE_NAME" Height="20" Id="cb_bap" InnerDataset="ds_bap" Left="520" Style="sty_ipt_search" TabOrder="26" Top="26" Width="100"></Combo>
		<Grid AutoEnter="TRUE" AutoFitEndLine="Hide" BindDataset="ds_excel" BkColor2="default" BoldHead="true" Border="Flat" Bottom="712" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="120" Id="grd_excel" InputPanel="FALSE" Left="32" LineColor="user20" LineType="ExHORZ" OnExpandEdit="grd_list_OnExpandEdit" OnExpandUp="grd_dtl_btn_matnr_OnClick" OnHeadClick="grd_detail_OnHeadClick" Right="920" RowHeight="20" Style="sty_grid" TabOrder="27" TabStop="true" Top="592" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="FALSE" VLineColor="default" WheelScrollRow="1" Width="888">
			<contents>
				<format id="Default">
					<columns>
						<col width="80"/>
						<col width="40"/>
						<col width="80"/>
						<col width="120"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="180"/>
						<col width="58"/>
						<col width="80"/>
						<col width="70"/>
						<col width="60"/>
						<col width="80"/>
						<col width="70"/>
						<col width="120"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="60"/>
						<col width="60"/>
						<col width="85"/>
						<col width="80"/>
						<col width="120"/>
					</columns>
					<head>
						<cell col="0" display="text" font="굴림,9" text="문서번호"/>
						<cell col="1" display="text" font="굴림,9" text="차수"/>
						<cell col="2" display="text" font="굴림,9" text="청구번호"/>
						<cell col="3" display="text" font="굴림,9" text="지사"/>
						<cell col="4" display="text" font="굴림,9" text="진행상태"/>
						<cell col="5" display="text" font="굴림,9" text="작성자"/>
						<cell col="6" display="text" font="굴림,9" text="작성일"/>
						<cell col="7" display="text" font="굴림,9" text="접수일"/>
						<cell col="8" display="text" font="굴림,9" text="승인일"/>
						<cell col="9" display="text" font="굴림,9" text="반송일"/>
						<cell col="10" display="text" font="굴림,9" text="결재상태"/>
						<cell col="11" display="text" font="굴림,9" text="자재코드"/>
						<cell col="12" display="text" font="굴림,9" text="자재내역"/>
						<cell col="13" display="text" font="굴림,9" text="단위"/>
						<cell col="14" display="text" font="굴림,9" text="구분"/>
						<cell col="15" display="text" font="굴림,9" text="단가"/>
						<cell align="center" col="16" display="text" font="굴림,9" text="수량"/>
						<cell col="17" display="text" font="굴림,9" text="총금액"/>
						<cell col="18" display="text" font="굴림,9" text="특성치"/>
						<cell col="19" display="text" font="굴림,9" text="사용자"/>
						<cell col="20" display="text" font="굴림,9" text="계정지수범주"/>
						<cell col="21" display="text" font="굴림,9" text="Cost&#32;Center"/>
						<cell col="22" display="text" font="굴림,9" text="Order&#32;No."/>
						<cell col="23" display="text" font="굴림,9" text="플랜트"/>
						<cell col="24" display="text" font="굴림,9" text="저장위치"/>
						<cell col="25" display="text" font="굴림,9" text="출하일"/>
						<cell col="26" display="text" font="굴림,9" text="발주일"/>
						<cell col="27" display="text" font="굴림,9" text="발주업체"/>
					</head>
					<body>
						<cell col="0" colid="DOC" display="text" suppress="1"/>
						<cell col="1" colid="SIR" display="text" suppress="2"/>
						<cell col="2" colid="REQNO" display="text" suppress="3"/>
						<cell col="3" colid="BSU_NM" display="text" suppress="4"/>
						<cell col="4" colid="PST_NM" display="text" suppress="5"/>
						<cell col="5" colid="MID" display="text" suppress="6"/>
						<cell col="6" colid="MDT" display="text" Mask="####-##-##" suppress="7"/>
						<cell col="7" colid="IDA" display="text" Mask="####-##-##" suppress="8"/>
						<cell col="8" colid="SDAT" display="text" Mask="####-##-##" suppress="9"/>
						<cell col="9" colid="RDAT" display="text" Mask="####-##-##" suppress="10"/>
						<cell col="10" colid="APSTAT_NM" display="text" suppress="11"/>
						<cell align="center" bkcolor2="user22" bkimagealign="right" col="11" colid="MATNR" cursor="ibeam" display="text" edit="normal" expandsize="18"/>
						<cell bkcolor2="user22" col="12" colid="MAKTX" display="text"/>
						<cell align="center" bkcolor2="user22" col="13" colid="MEINS" display="text"/>
						<cell align="left" bkimagealign="right" bkimageid="icon_grid_edit" col="14" colid="GBN" combocol="CODE" combodataset="ds_gbn2" combotext="VALUE" display="combo" edit="combo"/>
						<cell align="right" bkcolor2="user22" col="15" colid="SAMT1" display="number" Mask="#,###,##0"/>
						<cell align="center" bkimagealign="right" bkimageid="icon_grid_edit" col="16" colid="MENGE" display="number" edit="integer"/>
						<cell align="right" bkcolor2="user22" col="17" colid="SAMT2" display="number" Mask="#,###,##0"/>
						<cell align="center" bkimagealign="right" bkimageid="icon_grid_edit" col="18" colid="CHAR1" display="text" edit="normal"/>
						<cell align="left" bkimagealign="right" bkimageid="icon_grid_edit" col="19" colid="UNAME" display="text" edit="normal"/>
						<cell align="center" bkcolor2="user22" bkimagealign="right" col="20" colid="KNTTP" display="text" imemode="english" limit="1" Mask="Z"/>
						<cell align="center" bkcolor2="user22" bkimagealign="right" col="21" colid="KOSTL" display="text"/>
						<cell align="center" bkcolor2="user22" bkimagealign="right" col="22" colid="AUFNR" display="text"/>
						<cell align="center" bkcolor2="user22" bkimagealign="right" col="23" colid="WERKS" display="text"/>
						<cell align="center" bkcolor2="user22" bkimagealign="right" col="24" colid="LGORT" display="text" limit="4" Mask="ZZZZ"/>
						<cell col="25" colid="CDAT" display="text" expandimage="btn_grid_icon_pen" expandsize="18" Mask="####-##-##"/>
						<cell align="center" col="26" colid="BDAT" display="date"/>
						<cell col="27" colid="BBSU" display="text"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Div Height="245" Id="div_top" TabOrder="28" Text="Div0" Top="72" Width="976">
			<Contents>
				<Grid AutoEnter="TRUE" AutoFitEndLine="Hide" BindDataset="ds_list" BkColor2="default" BoldHead="true" Border="Flat" Bottom="240" CellMoving="TRUE" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="216" Id="grd_list" InputPanel="FALSE" Left="8" LineColor="user20" LineType="ExHORZ" OnCellDBLClick="div_top_grd_list_OnCellDblClick" OnCellPosChanged="grd_list_OnCellPosChanged" OnHeadClick="grd_list_OnHeadClick" Right="969" RowHeight="20" Style="sty_grid" TabOrder="1" TabStop="true" Top="24" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="961">
					<contents>
						<format id="Default">
							<columns>
								<col width="27"/>
								<col width="90"/>
								<col width="40"/>
								<col width="90"/>
								<col width="220"/>
								<col width="40"/>
								<col width="100"/>
								<col width="90"/>
								<col width="80"/>
								<col width="80"/>
								<col width="80"/>
								<col width="80"/>
								<col width="80"/>
							</columns>
							<head>
								<cell col="0" display="text" font="굴림,9" text="선택"/>
								<cell col="1" display="text" font="굴림,9" text="문서번호"/>
								<cell col="2" display="text" font="Default,9" text="차수"/>
								<cell col="3" display="text" font="굴림,9" text="청구번호"/>
								<cell col="4" display="text" font="굴림,9" text="지사"/>
								<cell col="5" display="text" font="굴림,9" text="건수"/>
								<cell col="6" display="text" font="굴림,9" text="총금액"/>
								<cell col="7" display="text" font="굴림,9" text="진행상태"/>
								<cell col="8" display="text" font="굴림,9" text="작성일"/>
								<cell col="9" display="text" font="굴림,9" text="접수일"/>
								<cell col="10" display="text" font="굴림,9" text="승인일"/>
								<cell col="11" display="text" font="굴림,9" text="반송일"/>
								<cell col="12" display="text" font="굴림,9" text="결재상태"/>
							</head>
							<body>
								<cell col="0" colid="CHK" display="checkbox" edit="checkbox"/>
								<cell align="center" col="1" colid="DOC" display="text"/>
								<cell align="center" col="2" colid="SIR" display="text"/>
								<cell align="center" col="3" colid="REQNO" display="text"/>
								<cell align="left" col="4" colid="BSU_NM" display="text"/>
								<cell align="center" col="5" colid="CNT" display="number" Mask="##,###,##0"/>
								<cell align="right" col="6" colid="SAMT" display="number" Mask="##,###,##0"/>
								<cell align="center" col="7" colid="PST_NM" display="text"/>
								<cell align="center" col="8" colid="MDT" display="text" Mask="ZZZZ-ZZ-ZZ"/>
								<cell align="center" col="9" colid="IDA" display="text" Mask="ZZZZ-ZZ-ZZ"/>
								<cell align="center" col="10" colid="SDAT" display="text" Mask="ZZZZ-ZZ-ZZ"/>
								<cell align="center" col="11" colid="RDAT" display="text" Mask="ZZZZ-ZZ-ZZ"/>
								<cell align="center" col="12" colid="APSTAT_NM" display="text"/>
							</body>
						</format>
					</contents>
				</Grid>
				<Button ButtonStyle="TRUE" Cursor="HAND" Enable="FALSE" Height="20" Id="btn_summary" ImageID="btn_sub_02" Left="823" LeftMargin="12" OnClick="btn_summary_OnClick" Style="sty_btn" TabOrder="2" Text="집계" Top="2" Transparent="TRUE" Width="49"></Button>
				<Button ButtonStyle="TRUE" Cursor="HAND" Enable="FALSE" Height="20" Id="btn_packing" ImageID="btn_sub_06" Left="872" LeftMargin="12" OnClick="btn_openPopup1" Style="sty_btn" TabOrder="3" Text="Packing&#32;List" Top="2" Transparent="TRUE" Width="99"></Button>
				<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_wf_stat" ImageID="btn_sub_06" Left="726" LeftMargin="12" OnClick="btn_wf_stat_OnClick" Style="sty_btn" TabOrder="4" Text="결재상태확인" Top="2" Transparent="TRUE" Width="96"></Button>
			</Contents>
		</Div>
	</Form>
	<Script><![CDATA[﻿﻿﻿﻿﻿﻿﻿/*
 ******************************************************************************************
 * 기      능   : 
 * 작  성  자   : 
 * 작성  일자   : 
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
#include "LIB::commons.js";	// 공통 스크립트 
//=========================================================================================
// [ PART 1 ]
// Form에서 사용될 전역변수를 선언
// FORM에서 사용되는 전역변수는 대문자로 작성하며, F_XXX 의 형태를 갖도록 한다. 
//=========================================================================================
var pstFlag = "";
var vendCode = G_VEND_CODE_R;
var editFlag=false;
var user_grp;
var listRow = 0;
//=========================================================================================
// [ PART 2 ]
// Form Loading / Unloading 시 작업 정의
//=========================================================================================
function fn_OnLoadCompleted(obj) {
	gfn_initForm(true);
	
	cal_tdt.Value = gfn_getCurrDate();
	cal_fdt.Value = gfn_getBeforeDate(cal_tdt.value, 7);
	
    //btn_serno_into.Enable = true;
    //btn_serno_del.Enable = true;
    
    user_grp = gfn_getUserGroup();

	if(user_grp == "40"){	
		//btn_request.Enable = false;
		div_top.btn_summary.Enable = true;
		div_top.btn_packing.Enable = true;
		
	} else {
		ds_cond.SetColumn(0,"VEND_CD",G_VEND_CODE_R);
	}
	
	div_bottom.btn_addrow.Enable = false;
	div_bottom.btn_delrow.Enable = false;
	div_bottom.btn_save.Enable = false;
}
/********************************************************************************
* 기      능   : 공통코드가 조회된 후의 Callback 함수 
********************************************************************************/
function fn_completeInit(sCode, sDsObj, sCodeType) {

}
/********************************************************************************
* 기      능   : form UnloadCompleted 
********************************************************************************/
function fn_OnUnloadCompleted(obj) {
	return gfn_isFormUnload(obj);
}
//=========================================================================================
// [ PART 3 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,form닫기)
//=========================================================================================
/********************************************************************************
* 기      능   : 조회 1
********************************************************************************/
function fn_query() {
	var user_grp = gfn_getUserGroup();

	if(user_grp == '40') {
		if(gfn_isNull(div_code.cb_big, true, st_bsu.value))
			return;
	}

	if(user_grp == "10") { // 보수협력사일 경우
		ds_cond.SetColumn(0, "BSU", G_LGORT);
		ds_cond.SetColumn(0, "TEM", '');
		ds_cond.SetColumn(0, "BPM", '');
		ds_cond.SetColumn(0, "ARA", '');
	} else if(user_grp == "20") { // 보수PM일 경우
		ds_cond.SetColumn(0, "BSU", trim(div_code.cb_small.value));
		ds_cond.SetColumn(0, "TEM", '');
		ds_cond.SetColumn(0, "BPM", G_USER_ID);
		ds_cond.SetColumn(0, "ARA", '');
	} else if(user_grp == "30") { // 지방사무소일 경우
		ds_cond.SetColumn(0, "BSU", trim(div_code.cb_small.value));
		ds_cond.SetColumn(0, "TEM", G_SAP_USER_VGCD);
		ds_cond.SetColumn(0, "BPM", '');
		ds_cond.SetColumn(0, "ARA", '');
	} else if(user_grp == "40") { // 고객지원부일 경우
		ds_cond.SetColumn(0, "BSU", trim(div_code.cb_small.value));
		if(div_code.cb_big.value == '1') { // 협력사 콤보1이 지역일 경우
			ds_cond.SetColumn(0, "DPT", '');
			ds_cond.SetColumn(0, "TEM", '');
			ds_cond.SetColumn(0, "BPM", '');
			ds_cond.SetColumn(0, "ARA", trim(div_code.cb_mid.value));
		} else if(div_code.cb_big.value == '2') { // 협력사 콤보1이 PM일 경우
			ds_cond.SetColumn(0, "DPT", '');
			ds_cond.SetColumn(0, "TEM", '');
			ds_cond.SetColumn(0, "BPM", trim(div_code.cb_mid.value));
			ds_cond.SetColumn(0, "ARA", '');
		} else if(div_code.cb_big.value == '4') { // 협력사 콤보1이 부서일 경우
			ds_cond.SetColumn(0, "DPT", trim(div_code.cb_mid.value));
			ds_cond.SetColumn(0, "TEM", trim(div_code.cb_small.value));
			ds_cond.SetColumn(0, "BSU", '');
			ds_cond.SetColumn(0, "BPM", '');
			ds_cond.SetColumn(0, "ARA", '');		
		} else { // 협력사 콤보1이 팀일 경우
			ds_cond.SetColumn(0, "DPT", '');
			ds_cond.SetColumn(0, "TEM", trim(div_code.cb_mid.value));
			ds_cond.SetColumn(0, "BPM", '');
			ds_cond.SetColumn(0, "ARA", '');
		}
	}
	
	ds_list.DeleteAll();
	ds_detail.DeleteAll();
	ds_detail_1.DeleteAll();
	pstFlag='';

	tit_clearActionInfo();
	tit_addSearchActionInfo("cs01:CS0108005A_S1");
	tit_addSearchActionInfo("cs01:CS0108005A_S2");
	tit_callService(
        ""
        , ""
        , "ds_cond=ds_cond"
        , "ds_list=ds_list ds_detail_1=ds_detail"
        , ""
        , "fn_afterQuery"
        , true);
}
/********************************************************************************
* 기      능   : 삽입 20
********************************************************************************/
function fn_input() {
//	var pop_obj = gfn_openPopup("CS0104004B", true);
}

function fn_insert() {
	// 그리드에 row 추가 
//	var newRow = gfn_addGridRow(grd_list, -1, "FLAG");
}
/********************************************************************************
* 기      능   : Delete 
********************************************************************************/
function fn_delete() {
	

	var chkCnt = 0;
	for(i=0;i<ds_list.RowCount();i++) 
	{
		if(ds_list.getColumn(i,"CHK") == '1') 
		{
			chkCnt++;
			//자신의 부서것만 가능.. 
			if(editFlag==false) {
				gfn_showAlert("CW10025", eval(i+1) + "번째 행은 다른 지사에서 작성한 소모재 신청이여서 삭제가 불가능 합니다. ");
				return false;
			}
			
			if(ds_list.GetColumn(i, "PST")!='A1')
			{
				//기안/승인 상태시 삭제 금지
				gfn_showAlert("CW10025", eval(i+1) + "번째 행은 기안/승인/반송상태 이므로 삭제하실수 없습니다.");
				return false;
			}
		}		
	}
	if(chkCnt == 0) {
		gfn_showAlert("CW00013");
		return false;
	}
	else if(chkCnt > 1) {
		gfn_showAlert("CW00116","삭제할 항목을 한건만 ");
		return false;
	}
	
	if(!gfn_showConfirm("CI00015","소모품 신청") )
	{
		return false;
	}
	
	//반송된건일 경우 메시지 출력후 삭제?
	
	//체크박스에 체크 되어 있고
	gfn_copyDs(ds_list, ds_list_0, "CHK=1");
	
	tit_clearActionInfo();
	tit_addSingleActionInfo("cs01:CS0108005A_U2");
	
	tit_callService(
		""
		, ""
		, "ds_list=ds_list_0"
		, ""
		, ""
		, "fn_afterDelete"
		, true
		, false
		, true);
	
}
/********************************************************************************
* 기      능   : 저장 
********************************************************************************/
function fn_save() {

	var chkCnt = 0;
	var matnrChk = 0;
	for(i=0;i<ds_detail.RowCount();i++) 
	{
		if(ds_detail.getColumn(i,"CHK") == '1') 
		{
			chkCnt++;
			if(length(trim(ds_detail.GetColumn(i,"MAKTX")))=0) //자재내역이 빈공백일 경우
			{
				matnrChk=i;
			}
		
			//계정지정범위가 빈공백이면 안됨
			if(length(trim(ds_detail.getColumn(i,"KNTTP")))=0) {
				gfn_showAlert("CW00001", eval(i+1) + "번째에 계정지수범주 ");
				return false;
			}
			//계정지정범위가 K인 경우 코스트센터값 필수
			if(ToUpper(ds_detail.getColumn(i,"KNTTP"))=="K") {
				if(length(trim(ds_detail.getColumn(i,"KOSTL")))=0) {
					gfn_showAlert("CW10025", eval(i+1) + "번째에 계정지수범주 항목값이 'K'가 입력될 경우 코스트센터 항목은 필수입력입니다.\n확인하여 주십시오.");
					return false;
				}
			}
			//계정지정범위가 f인 경우 오더번호 필수
			if(ToUpper(ds_detail.getColumn(i,"KNTTP"))=="F") {
				if(length(trim(ds_detail.getColumn(i,"AUFNR")))=0) {
					gfn_showAlert("CW10025", eval(i+1) + "번째에 계정지수범주 항목값이 'F'가 입력될 경우 오더번호 항목은 필수입력입니다.\n확인하여 주십시오.");
					return false;
				}
			}
		
		}
				
	}
	if(chkCnt == 0) {
		gfn_showAlert("CW00013");
		return false;
	}
	if(matnrChk > 0) {
		gfn_showAlert("CW10025","체크된 항목중 자재코드가 없는Row가 있습니다. ");
		return false;
	}

	if(!gfn_showConfirm("CI00014","선택한 "+chkCnt+"건의 소모재만 저장됩니다. 소모재\n") )
	{
		return false;
	}
	
	//체크박스에 체크 되어 있고
	gfn_copyDs(ds_detail, ds_detail_0, "CHK=1 && MATNR!=''");
	
	if(pstFlag=="") //신규신청
	{	
		ds_docno_gen.ClearData();													//결재번호생성 데이터셋을 클리어한다
		ds_docno_gen.AddRow();																
		ds_docno_gen.SetColumn(0,"PFX","R10");										//Prefix
		
		tit_clearActionInfo();					
		tit_addSearchActionInfo("wb01:DOC_CODE_GEN_S1",true);					
		tit_addSearchActionInfo("wb01:DOC_CODE_GEN_U1");					
		tit_callService(															//동기화 방식으로 서비스를 콜한다.	
			, ""				
			, "ds_docno_gen_i=ds_docno_gen"				
			, "ds_docno_gen=ds_docno_gen_o"				
			, ""				
			, ""				
			, true
			, false
			, true);				
		
		tit_clearActionInfo();
		tit_addSingleActionInfo("cs01:CS0108005A_I1");
		tit_addMultiActionInfo ("cs01:CS0108005A_I2");
	}
	else if(pstFlag=="A1") //수정일 경우
	{
		for(i=0;i<ds_detail.RowCount();i++) 
		{
			//신규 추가가 있을 경우 DOC/SIR 값 넣기
			ds_detail_0.SetColumn(i,"DOC",ds_list.GetColumn(ds_list.currow,"DOC"));
			ds_detail_0.SetColumn(i,"SIR",ds_list.GetColumn(ds_list.currow,"SIR"));
		}

		tit_clearActionInfo();
		tit_addSingleActionInfo("cs01:CS0108005A_U1");
		tit_addSingleActionInfo("cs01:CS0108005A_D1");
		tit_addMultiActionInfo ("cs01:CS0108005A_I3");
	}
	else if(pstFlag=='A6')	//승인 완료후 출하일 입력
	{
		tit_clearActionInfo();
		tit_addMultiActionInfo ("cs01:CS0108005A_U4");
	}

	tit_callService(
		""
		, ""
		, "ds_docno_gen=ds_docno_gen ds_detail=ds_detail_0"
		, ""
		, ""
		, "fn_afterSave"
		, true);

}
/********************************************************************************
* 기      능   : 닫기  
********************************************************************************/
function fn_close() {
	close();
}
/********************************************************************************
* 기      능   : 액셀  
********************************************************************************/
function fn_excel() {
	
	ds_excel.DeleteAll();

	tit_clearActionInfo();
	tit_addSearchActionInfo("cs01:CS0108005A_S4");
	tit_callService(
        ""
        , ""
        , "ds_cond=ds_cond"
        , "ds_excel=ds_excel"
        , ""
        , ""
        , true
		, false
		, true);
	
	gfn_saveToExcel(grd_excel, true, , , , true);
}
/********************************************************************************
* 기      능   : 접수 5
********************************************************************************/
function fn_receipt() {
	alert('접수');
}
/********************************************************************************
* 기      능   : 승인 10
********************************************************************************/
function fn_approval() {
	alert('승인');
}
/********************************************************************************
* 기      능   : 결재 15
********************************************************************************/
function fn_decide() {
	alert('결재');
}
/********************************************************************************
* 기      능   : 취소 35
********************************************************************************/
function fn_cancel() {

}
/********************************************************************************
* 기      능   : print 40
********************************************************************************/
function fn_print() {

}
/********************************************************************************
* 기      능   : 발행 50
********************************************************************************/
function fn_out() {

}
/********************************************************************************
* 기      능   : 신청 55
********************************************************************************/
function fn_request() {
	//ds_detail에서 수정중인 항목이 있는지 체크
	var chk = 0;
	for(i=0; i < ds_detail.GetRowCount(); i++) 
	{
		if(ds_detail.GetRowType(i) <> 'normal') {
			chk++;
		}
	}
	
	if(chk > 0) 
	{
		if(!gfn_showConfirm("CW10025","수정중인 내용이 사라집니다. 신규자재신청 작업을 진행하시겠습니까?") )
		{
			return false;
		}
	}
	
	ds_detail.DeleteAll();
	pstFlag = "";
	editFlag=true;
	
	ufn_gridDetail_edit();
	
	for(z=0;z<5;z++) {	//기본 5개 Row 생성
		gfn_addGridRow(div_bottom.grd_detail, -1, "FLAG");
	}

}
/********************************************************************************
* 기      능   : 전송 60
********************************************************************************/
function fn_trans() {
	alert('전송');
}
/********************************************************************************
* 기      능   : 반송 65
********************************************************************************/
function fn_sendback() {

}
/********************************************************************************
* 기      능   : 계산 70
********************************************************************************/
function fn_cal() {

}
/********************************************************************************
* 기      능   : 복사 75
********************************************************************************/
function fn_copy() {

}
/********************************************************************************
* 기      능   : 확인 80
********************************************************************************/
function fn_confirm() {

}
/********************************************************************************
* 기      능   : 기안 
********************************************************************************/
function fn_draft() {
	var chkCnt = 0;
	for(i=0;i<ds_list.RowCount();i++) 
	{
		if(ds_list.getColumn(i,"CHK") == '1') 
		{
			chkCnt++;
			//자신의 부서것만 가능.. 
			if(editFlag==false) {
				gfn_showAlert("CW10025", eval(i+1) + "번째 행은 다른 지사에서 작성한 소모재 신청이여서 기안이 불가능 합니다. ");
				return false;
			}
			
			if(ds_list.GetColumn(i, "PST")!='A1')
			{
				//기안/승인 상태시 삭제 금지
				gfn_showAlert("CW10025", eval(i+1) + "번째 행은 기안/승인상태 이므로 기안 하실수 없습니다.");
				return false;
			}
		}		
	}
	if(chkCnt == 0) {
		gfn_showAlert("CW00013");
		return false;
	}
	else if(chkCnt > 1) {
		gfn_showAlert("CW00116","기안할 항목을 한건만 ");
		return false;
	}

	gfn_clearMsgBar();
	gfn_copyDs(ds_list, ds_list_0, "CHK=1");
	
	var appgubn = "S";
	if(ds_list_0.GetColumn(0, "APSTAT") == "3") appgubn = "R";
	
	var arg = "fa_docno=" + quote(ds_list_0.GetColumn(0, "DNO"))
			+ " fa_dockind=22" 
			+ " fa_appgubn=" + quote(appgubn);
			
	var rtn = gfn_openPopup2("CS0401001A", true, arg);

	if( rtn[0] == "S" ) {
		tit_clearActionInfo();
		tit_addSingleActionInfo("cs01:CS0108005A_U3");
		
		tit_callService(
			""
			, ""
			, "ds_list=ds_list_0"
			, ""
			, ""
			, "fn_afterSave"
			, true
			, false
			, true);	
			
	} else {
		gfn_showMsg("CE00001");
	}	
}
//=========================================================================================
// [ PART 4]
// Callback 함수 정의 : callback 함수명은 메인 함수의 fn_xxxx() 에서 xxxx 부분은 fn_afterXXXX()
// 형태가 되도록 작성 
//=========================================================================================
/********************************************************************************
* 기      능   : 조회 Callback  
********************************************************************************/
function fn_afterQuery(errCode, errMsg) {
	// 메시지 처리 
	gfn_showSearchMsg(div_top.grd_list);
}
/********************************************************************************
* 기      능   : 저장 Callback  
********************************************************************************/
function fn_afterSave(errCode, errMsg) {
	if ( ds_error.rowcount() > 0 ) {
		gfn_showMsg("CE00001");
	} else {
		gfn_showMsg("CI00003");
		fn_query();
	}
}
/********************************************************************************
* 기      능   : 삭제 Callback  
********************************************************************************/
function fn_afterDelete(errCode, errMsg) {
	if(errCode != 0) {
		gfn_showMsg("CE00001");
	} else {
		gfn_showMsg("CI00005");
		fn_query();
	}
}
//=========================================================================================
// [ PART 5 ]
// Detail Process Event 정의 ( User Define function )
// 사용자 정의 함수는 ufn_xxxx() 형태로 작성 
//=========================================================================================
/********************************************************************************
* 기      능   : 사용자 정의 함수  
********************************************************************************/
function ufn_userfunction() {

}

/********************************************************************************
* 기      능   : Detail Grid수정 가능/불가능 설정
********************************************************************************/
function ufn_gridDetail_edit() {

	if((pstFlag=='' || pstFlag=='A1') && editFlag==true) 
	{
		div_bottom.grd_detail.SetCellProp("BODY",  1, "edit", "normal");
		div_bottom.grd_detail.SetCellProp("BODY",  4, "edit", "combo");
		div_bottom.grd_detail.SetCellProp("BODY",  6, "edit", "normal");
		div_bottom.grd_detail.SetCellProp("BODY",  8, "edit", "normal");
		div_bottom.grd_detail.SetCellProp("BODY",  9, "edit", "normal");
		div_bottom.grd_detail.SetCellProp("BODY", 10, "edit", "expr:decode(GBN,1,'none','normal')");
		div_bottom.grd_detail.SetCellProp("BODY", 11, "edit", "expr:decode(GBN,1,'none','normal')");
		div_bottom.grd_detail.SetCellProp("BODY", 12, "edit", "expr:decode(GBN,1,'none','normal')");
		div_bottom.grd_detail.SetCellProp("BODY", 13, "edit", "expr:decode(GBN,1,'none','normal')");
		div_bottom.grd_detail.SetCellProp("BODY", 14, "edit", "expr:decode(GBN,1,'none','normal')");
		div_bottom.grd_detail.SetCellProp("BODY", 15, "edit", "none");
		
		div_bottom.grd_detail.SetCellProp("BODY",  4, "BkImageID", "icon_grid_edit");
		div_bottom.grd_detail.SetCellProp("BODY",  6, "BkImageID", "icon_grid_edit");
		div_bottom.grd_detail.SetCellProp("BODY",  8, "BkImageID", "icon_grid_edit");
		div_bottom.grd_detail.SetCellProp("BODY",  9, "BkImageID", "icon_grid_edit");
		div_bottom.grd_detail.SetCellProp("BODY", 10, "BkImageID", "expr:decode(GBN,1,'','icon_grid_edit')");
		div_bottom.grd_detail.SetCellProp("BODY", 11, "BkImageID", "expr:decode(GBN,1,'','icon_grid_edit')");
		div_bottom.grd_detail.SetCellProp("BODY", 12, "BkImageID", "expr:decode(GBN,1,'','icon_grid_edit')");
		div_bottom.grd_detail.SetCellProp("BODY", 13, "BkImageID", "expr:decode(GBN,1,'','icon_grid_edit')");
		div_bottom.grd_detail.SetCellProp("BODY", 14, "BkImageID", "expr:decode(GBN,1,'','icon_grid_edit')");
		
		div_bottom.grd_detail.SetCellProp("BODY",  1, "expandshow", "true");
		div_bottom.grd_detail.SetCellProp("BODY", 15, "expandshow", "false");
		
		div_bottom.btn_addrow.Enable = true;
		div_bottom.btn_delrow.Enable = true;
		div_bottom.btn_save.Enable = true;
	}
	else if(pstFlag=='A6')
	{
		div_bottom.grd_detail.SetCellProp("BODY",  1, "edit", "none");
		div_bottom.grd_detail.SetCellProp("BODY",  4, "edit", "none");
		div_bottom.grd_detail.SetCellProp("BODY",  6, "edit", "none");
		div_bottom.grd_detail.SetCellProp("BODY",  8, "edit", "none");
		div_bottom.grd_detail.SetCellProp("BODY",  9, "edit", "none");
		div_bottom.grd_detail.SetCellProp("BODY", 10, "edit", "none");
		div_bottom.grd_detail.SetCellProp("BODY", 11, "edit", "none");
		div_bottom.grd_detail.SetCellProp("BODY", 12, "edit", "none");
		div_bottom.grd_detail.SetCellProp("BODY", 13, "edit", "none");
		div_bottom.grd_detail.SetCellProp("BODY", 14, "edit", "none");
		div_bottom.grd_detail.SetCellProp("BODY", 15, "edit", "none");
		
		div_bottom.grd_detail.SetCellProp("BODY",  4, "BkImageID", "");
		div_bottom.grd_detail.SetCellProp("BODY",  6, "BkImageID", "");
		div_bottom.grd_detail.SetCellProp("BODY",  8, "BkImageID", "");
		div_bottom.grd_detail.SetCellProp("BODY",  9, "BkImageID", "");
		div_bottom.grd_detail.SetCellProp("BODY", 10, "BkImageID", "");
		div_bottom.grd_detail.SetCellProp("BODY", 11, "BkImageID", "");
		div_bottom.grd_detail.SetCellProp("BODY", 12, "BkImageID", "");
		div_bottom.grd_detail.SetCellProp("BODY", 13, "BkImageID", "");
		div_bottom.grd_detail.SetCellProp("BODY", 14, "BkImageID", "");
		
		div_bottom.grd_detail.SetCellProp("BODY",  1, "expandshow", "false");
		div_bottom.grd_detail.SetCellProp("BODY", 15, "expandshow", "true");
		
		div_bottom.btn_addrow.Enable = false;
		div_bottom.btn_delrow.Enable = false;
		div_bottom.btn_save.Enable = true;
	}
	else 
	{
		div_bottom.grd_detail.SetCellProp("BODY",  1, "edit", "none");
		div_bottom.grd_detail.SetCellProp("BODY",  4, "edit", "none");
		div_bottom.grd_detail.SetCellProp("BODY",  6, "edit", "none");
		div_bottom.grd_detail.SetCellProp("BODY",  8, "edit", "none");
		div_bottom.grd_detail.SetCellProp("BODY",  9, "edit", "none");
		div_bottom.grd_detail.SetCellProp("BODY", 10, "edit", "none");
		div_bottom.grd_detail.SetCellProp("BODY", 11, "edit", "none");
		div_bottom.grd_detail.SetCellProp("BODY", 12, "edit", "none");
		div_bottom.grd_detail.SetCellProp("BODY", 13, "edit", "none");
		div_bottom.grd_detail.SetCellProp("BODY", 14, "edit", "none");
		div_bottom.grd_detail.SetCellProp("BODY", 15, "edit", "none");
		
		div_bottom.grd_detail.SetCellProp("BODY",  4, "BkImageID", "");
		div_bottom.grd_detail.SetCellProp("BODY",  6, "BkImageID", "");
		div_bottom.grd_detail.SetCellProp("BODY",  8, "BkImageID", "");
		div_bottom.grd_detail.SetCellProp("BODY",  9, "BkImageID", "");
		div_bottom.grd_detail.SetCellProp("BODY", 10, "BkImageID", "");
		div_bottom.grd_detail.SetCellProp("BODY", 11, "BkImageID", "");
		div_bottom.grd_detail.SetCellProp("BODY", 12, "BkImageID", "");
		div_bottom.grd_detail.SetCellProp("BODY", 13, "BkImageID", "");
		div_bottom.grd_detail.SetCellProp("BODY", 14, "BkImageID", "");
		
		div_bottom.grd_detail.SetCellProp("BODY",  1, "expandshow", "false");
		div_bottom.grd_detail.SetCellProp("BODY", 15, "expandshow", "false");
		
		div_bottom.btn_addrow.Enable = false;
		div_bottom.btn_delrow.Enable = false;
		div_bottom.btn_save.Enable = false;
	}
}

//=========================================================================================
// [ PART 6 ]
// component Event 정의 : 각 Component 별 이벤트 
//=========================================================================================
/********************************************************************************
* 기      능   : 그리드 헤더 클릭시 정렬 처리 
********************************************************************************/
function grd_list_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
{
	if ( nCell == 0 ) {
		// 그리드 표시할 컬럼 선택 
		gfn_selectGridCol(obj);
	} else {
		// 그리드 정렬 처리 
		gfn_sortGrid(obj,nCell);
	}
}
/********************************************************************************
* 기      능   : 데이터셋 값 변경 시 - Flag 처리 
********************************************************************************/
function ds_list_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{
	gfn_changeFlag( obj, strColumnID, nRow, "FLAG" );
}


//-------------- TOP 검색조건 ----------------------------------------------------
/********************************************************************************
* 기      능   : 자재번호 찾기 클릭
********************************************************************************/
function btn_matnr_OnClick(obj)
{
			
	var mat = gfn_openPopup("MM0901002A",true); 
	
	ds_cond.SetColumn(0,"MATNR",mat);

	tit_clearActionInfo();
	
	tit_addSearchActionInfo("cs01:CS0108005A_S3");

	tit_callService(
		""
		,""
		, "ds_ma_cond=ds_cond"
		, "ds_ma_list=ds_ma_list"
		, ""
		, "fn_findMatnr"
		, false
		, true);
}

function fn_findMatnr() 
{
	ds_cond.SetColumn(0,"MATNR_NM",ds_ma_list.GetColumn(0,"MATNR_NM")); 
}
//-------------- MAIN GRD_MAIN관련 ----------------------------------------------------
/********************************************************************************
* 기      능   : Main_grid에서 Row선택시 Detail_grid에 표시
********************************************************************************/
function grd_list_OnCellPosChanged(obj,nRow,nCell,nOldRow,nOldCell,nPivotIndex,nOldPivotIndex)
{
	//선택한 정보를 가지고 새로운 DS에 복사해서 사용
	gfn_copyDs(ds_detail_1, ds_detail, "DOC==" + quote( ds_list.GetColumn(nRow,"DOC")) + "&&SIR==" + quote( ds_list.GetColumn(nRow,"SIR")));
	
	pstFlag = ds_list.GetColumn(nRow,"PST");
	//alert(vendCode + "/" + ds_list.GetColumn(nRow,"BSU") + "/" + G_ORG_VEND_CODE_R);
	if(vendCode==ds_list.GetColumn(nRow,"BSU")) 
	{	
		editFlag=true;
	} else {
		editFlag=false;
	}
	
	ufn_gridDetail_edit();
}


/********************************************************************************
* 기      능   : 집계
********************************************************************************/
function btn_summary_OnClick(obj)
{
	var pop_obj = gfn_openPopup("CS0108005D", true);
}

/********************************************************************************
* 기      능   : Packing List 
********************************************************************************/
function btn_openPopup1(obj)
{
	var vkgrp,bf_vkgrp;
	var x=0;

	ds_packing_dtl.Clear();
	ds_packing.ClearData();

	if(ds_list.getColumn(ds_list.currow,"PST") != 'A6') 
	{
		gfn_showAlert("CW10025", "진행상태가 '승인'인 항목만 Packing List출력이 가능합니다. \n" + eval(ds_list.currow+1) + "번째 행의 진행상태를 확인하세요");
		return false;
	}
	
	var z=0;
	for(j=0;j<ds_detail.RowCount();j++) 
	{
		if(ds_detail.getColumn(j,"CHK") == '1') {
			z++;
			
			//저장여부
			if(ds_detail.getColumn(j,"FLAG")=="CDAT") 
			{
				gfn_showAlert("CW10025", eval(j+1) + "번째 행의 자재(" + ds_detail.GetColumn(j,"MATNR") + ") 출하일이 저장되지 않았습니다. 저장을 먼저하시기 바랍니다. ");
				return false;
			}
			//출하일 존재여부
			if(length(trim(ds_detail.getColumn(j,"CDAT")))=0) 
			{
				gfn_showAlert("CW10025", "출하일이 저장된 항목만 Packing List출력이 가능합니다. \n" + eval(j+1) + "번째 행의 자재(" + ds_detail.GetColumn(j,"MATNR") + ")를 확인하세요");
				return false;
			}
			
			gfn_copyDs(ds_detail_1, ds_packing_dtl_0, 
				"DOC==" + quote( ds_detail.GetColumn(j,"DOC")) + 
				"&&SIR==" + quote( ds_detail.GetColumn(j,"SIR")) + 
				"&&MATNR==" + quote( ds_detail.GetColumn(j,"MATNR"))
			);
			//	주의) AppendDataset은 컬럼이 없을경우 Append될 DS의 컬럼이 들어가지만 
			//	컬럼이 존재하면 Append할 DS의 컬럼순서와 Appned DS의 컬럼명으로 매칭이 되는것이 아니라 무조건 순서대로 데이터가 들어감.
			ds_packing_dtl.AppendDataset(ds_packing_dtl_0);
		}
	}
	
	if(ds_packing_dtl.RowCount()==0) {
		gfn_showAlert("CW10025", "출력할 자재를 선택하세요.");
		return false;
	}
	
	if(ds_packing.RowCount()==0) {
		ds_packing.AddRow();
	}
	ds_packing.SetColumn(0,"VKGRP", ds_list.getColumn(i,"CTEXT2"));

	
	for(j=0;j<ds_packing_dtl.RowCount();j++) 
	{
		var gbnNm = ''; 
		if(ds_packing_dtl.GetColumn(j,"GBN") == '1') gbnNm = '소모재';
		else if(ds_packing_dtl.GetColumn(j,"GBN") == '2') gbnNm = '개인공구';
		else if(ds_packing_dtl.GetColumn(j,"GBN") == '3') gbnNm = '공동공구';
		else if(ds_packing_dtl.GetColumn(j,"GBN") == '4') gbnNm = '계측기';
		else if(ds_packing_dtl.GetColumn(j,"GBN") == '5') gbnNm = '일반자재';

		if(ds_packing_dtl.GetColIndex("GBN_NM") < 0) {
			ds_packing_dtl.AddColumn("GBN_NM");
		}
		
		ds_packing_dtl.SetColumn(j,"GBN_NM",gbnNm);
	}
	
	//var pop_obj = gfn_openPopup("CS0108005C", true);
	Dialog("CS01::CS0108005E.xml", "");
}
//-------------- DETAIL GRD_DETAIL관련 ----------------------------------------------------
/********************************************************************************
* 기      능   : 자재 추가 클릭
********************************************************************************/
function btn_addrow_OnClick(obj)
{
	if(pstFlag=='A3') 
	{
		//CW00073=수정이 불가한 데이터입니다.
		gfn_showAlert("CW00073");
		return false;
	}
	else if(pstFlag=='A6') 
	{
		gfn_showAlert("CW00073");
		return false;
	}
	gfn_addGridRow(div_bottom.grd_detail, -1, "FLAG");
}

/********************************************************************************
* 기      능   : 자재 삭제 클릭
********************************************************************************/
function btn_delrow_OnClick(obj)
{
	if(pstFlag=='A3') 
	{	
		//CW00072=삭제가 불가한 데이터입니다.
		gfn_showAlert("CW00072");
		return false;
	}
	else if(pstFlag=='A6') 
	{
		gfn_showAlert("CW00072");
		return false;
	}
	
	for(i=0;i<ds_detail.RowCount();i++) {
		if(ds_detail.getColumn(i,"CHK") == '1') 
		{
			ds_detail.DeleteRow(i);
			i--;
		}
	}
	
}

/********************************************************************************
* 기      능   : Grid_Detail에서 자재코드 버튼 클릭시(자재조회 화면)
********************************************************************************/
function grd_dtl_btn_matnr_OnClick(obj,nRow,nCell,strVal,nPivotIndex)
{
	if (nCell == 1)   // 자재 조회
	{
		fn_clearMatnr(nRow);
		
		var mat = gfn_openPopup("MM0901002A",true); 
		
		ds_detail.SetColumn(nRow,"MATNR",mat);

		if (ds_detail.GetColumn(nRow,"MATNR") == "0")
		{
			ds_detail.SetColumn(nRow,"MATNR","");
		}
		else
		{
			/*
			tit_clearActionInfo();
			
			tit_addSearchActionInfo("cs01:CS0108005A_S3");
		
			tit_callService(
				""
				,""
				, "ds_ma_cond=ds_ma_cond"
				, "ds_ma_list=ds_ma_list"
				, ""
				, "fn_setMatnr"
				, false
				, true);
				*/
		}
	}

}

function fn_clearMatnr(nRow)
{
	if (ds_ma_list.rowcount > 0)
	{
		ds_detail.SetColumn(nRow,"MATNR",""); 
		ds_detail.SetColumn(nRow,"MAKTX","");
		ds_detail.SetColumn(nRow,"MATNR_NM",""); 
		ds_detail.SetColumn(nRow,"MEINS",""); 
		ds_detail.SetColumn(nRow,"MENGE",""); 
		ds_detail.SetColumn(nRow,"SAMT1",""); 
		ds_detail.SetColumn(nRow,"SAMT2",""); 
		ds_detail.SetColumn(nRow,"GBN",""); 
		ds_detail.SetColumn(nRow,"KNTTP",""); 
		ds_detail.SetColumn(nRow,"KOSTL",""); 
		ds_detail.SetColumn(nRow,"WERKS",""); 
		ds_detail.SetColumn(nRow,"LGORT",""); 
	}
}

/********************************************************************************
* 기      능   : 자재조회 화면 더블클릭시 Grid_Detail에 값 넣기
********************************************************************************/
function fn_setMatnr()
{
	if (ds_ma_list.rowcount > 0)
	{
		var matnr = ds_ma_list.GetColumn(0,"MATNR");
		for(i=0;i<ds_detail.RowCount();i++) 
		{
			if(ds_detail.getColumn(i,"MATNR") == matnr && ds_ma_cond.GetColumn(0,"INPUTROW") <> i) 
			{
				gfn_showAlert("CW00040","자재코드("+matnr+")");
				fn_clearMatnr(ds_ma_cond.GetColumn(0,"INPUTROW"));
				return false;
			}
		}
		
		ds_detail.SetColumn(ds_ma_cond.GetColumn(0,"INPUTROW"),"FLAG",ds_ma_list.GetColumn(0,"FLAG")); 
		//ds_detail.SetColumn(ds_ma_cond.GetColumn(0,"INPUTROW"),"MATNR",ds_ma_list.GetColumn(0,"MATNR")); 
		ds_detail.SetColumn(ds_ma_cond.GetColumn(0,"INPUTROW"),"MAKTX",ds_ma_list.GetColumn(0,"MAKTX")); 
		ds_detail.SetColumn(ds_ma_cond.GetColumn(0,"INPUTROW"),"MATNR_NM",ds_ma_list.GetColumn(0,"MATNR_NM")); 
		ds_detail.SetColumn(ds_ma_cond.GetColumn(0,"INPUTROW"),"MEINS",ds_ma_list.GetColumn(0,"MEINS")); 
		ds_detail.SetColumn(ds_ma_cond.GetColumn(0,"INPUTROW"),"MENGE",'1'); 
		ds_detail.SetColumn(ds_ma_cond.GetColumn(0,"INPUTROW"),"SAMT1",ds_ma_list.GetColumn(0,"SAMT1")); 
		ds_detail.SetColumn(ds_ma_cond.GetColumn(0,"INPUTROW"),"SAMT2",ds_ma_list.GetColumn(0,"SAMT1")); 
		
		ds_detail.SetColumn(ds_ma_cond.GetColumn(0,"INPUTROW"),"GBN",'1'); 
		ds_detail.SetColumn(ds_ma_cond.GetColumn(0,"INPUTROW"),"KNTTP",'K'); 		//계정지정범주
		ds_detail.SetColumn(ds_ma_cond.GetColumn(0,"INPUTROW"),"KOSTL",'42601'); 	//Cost Center
		ds_detail.SetColumn(ds_ma_cond.GetColumn(0,"INPUTROW"),"AUFNR",''); 		//Order
		ds_detail.SetColumn(ds_ma_cond.GetColumn(0,"INPUTROW"),"WERKS",'2000'); 	//플랜트
		ds_detail.SetColumn(ds_ma_cond.GetColumn(0,"INPUTROW"),"LGORT",'9000'); 	//저장위치
	}
}

/********************************************************************************
* 기      능   : ds_detail의 내용이 변경시 액션
********************************************************************************/
function ds_detail_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{
	if (strColumnID=='MATNR') {
		ds_detail.SetColumn(nRow, "MATNR", toUpper(ds_detail.GetColumn(nRow, "MATNR")));
		if (length(obj.GetColumn(nRow, "MATNR")) > 0 && length(obj.GetColumn(nRow,"MAKTX")) == 0) 
		{
			ds_ma_cond.setColumn(0, "MATNR", toUpper(obj.GetColumn(nRow, "MATNR")));
			
			ds_ma_cond.SetColumn(0,"INPUTROW", nRow);
			//it_showDs(ds_ma_cond);
									
			listRow = nRow;
			
			tit_clearActionInfo();
			// 저장 처리 
			tit_addSearchActionInfo("cs01:CS0108005A_S3");
			
			tit_callService(
				 ""
				,""
				, "ds_ma_cond=ds_ma_cond"
				, "ds_ma_list=ds_ma_list"
				, ""
				, "fn_setMatnr"
				, false
				, true);					 
		}

	} else if (strColumnID=='MENGE') {
		var icost = parseInt(ds_detail.GetColumn(nRow,"SAMT1")) * parseInt(varNewValue);
		ds_detail.SetColumn(nRow,"SAMT2", icost);
	} else if (strColumnID=='CDAT') {
		ds_detail.SetColumn(nRow,"FLAG", "CDAT");
	}
}

/********************************************************************************
* 기      능   : 출하일 달력
********************************************************************************/
function grd_list_OnExpandEdit(obj,nRow,nCell,strVal,nPivotIndex) {
	if(nCell==15) 
	{
		var rect = obj.GetCellRect(nRow, ncell);
	
		var nX = ClientToScreenX(obj,rect[0]);
		var nY = ClientToScreenY(obj,rect[1] + 20);
	
		PopupDiv0.cal_temp.value = gfn_getCurrDate();
		
		PopupDiv0.TrackPopup(nX,nY);
		
		PopupDiv0.cal_temp.SetFocus();
	}
}

/********************************************************************************
* 기      능   : 달력에서 포커스 잃었을 경우
********************************************************************************/
function PopupDiv0_cal_temp_OnKillFocus(obj) {
	PopupDiv0.ClosePopup();
}

function PopupDiv0_cal_temp_OnDayClick(obj,strText) {
	gfn_clearMsgBar();
	if(div_bottom.grd_detail.GetClickedCell() == 15) {	//계약예정일
		ds_detail.SetColumn(ds_detail.row, "CDAT", strText);
	} 
	PopupDiv0.ClosePopup();
}


/********************************************************************************
* 기      능   : 저장버튼 클릭
********************************************************************************/
function div_bottom_btn_save_OnClick(obj)
{
	
}

/********************************************************************************
* 기      능   : 그리드 헤더 클릭시 정렬 처리 
********************************************************************************/
function grd_detail_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
{
	if(nCell == 0) {
		// 전체 선택
		gfn_selectAllGrid2(obj,0,0,true);
	} else {
		// 그리드 정렬 처리
		gfn_sortGrid(obj,nCell);
	}
}


function btn_wf_stat_OnClick(obj)
{
	var docNo;

	switch (div_top.grd_list.CurrentCell)
	{
		case 12:
			docNo = ds_list.GetColumn(div_top.grd_list.CurrentRow, "DNO");
			break;
		default:
			break;
	}

//	DEBUG("btn_wf_stat_OnClick", "currentRow is " + div_top.grd_list.CurrentRow + ", currentCell is " + div_top.grd_list.CurrentCell + ", docNo is " + docNo);

	if(substr(docNo, 0, 2) != "R1")
	{
		return;
	}

	ds_wf_cond.SetColumn(0, "DOCNO", docNo);

	tit_clearActionInfo();														
	tit_addSingleActionInfo("cs01:CS0101008A_S3");								//결재상세정보를 가져온다.
	tit_callService("", "", "ds_cond=ds_wf_cond", "ds_wf_stat=ds_wf_stat", "", "", true, false,true);

	if(ds_wf_stat.rowcount <= 0)
	{
		return;
	}

	var statStr = "";

	for(var iCnt = ds_wf_stat.rowcount - 1; iCnt >= 0; iCnt--)
	{
		statStr += ds_wf_stat.GetColumn(iCnt, "APPGUBNNM") + " / " + 
				   ds_wf_stat.GetColumn(iCnt, "SEQNONM")  + " / " + 
				   ds_wf_stat.GetColumn(iCnt, "SEQSTATNM")  + "\n    " + 
				   ds_wf_stat.GetColumn(iCnt, "APDPT1_N")  + " / " + 
				   ds_wf_stat.GetColumn(iCnt, "APRNK")  + " / " + 
				   ds_wf_stat.GetColumn(iCnt, "APIRUM")  + "\n";				   	
	}

//	DEBUG("btn_wf_stat_OnClick", "ds_wf_stat is " + ds_wf_stat.SaveXml());

	gfn_openMsgWin(statStr, "", "A", docNo + " 결재상태");
}

function div_top_grd_list_OnCellDblClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
	if(nCell == 0) {
		return;
	}

	var t_dno = ds_list.GetColumn(div_top.grd_list.CurrentRow, "DNO");

	if(length(trim(t_dno)) == 0) {
		return;
	}

	var arg = "";
	arg += " fa_docno=" + t_dno + " fa_popgbn=A";

	gfn_openPopup("CS0108005B", true, arg);
}
]]></Script>
</Window>