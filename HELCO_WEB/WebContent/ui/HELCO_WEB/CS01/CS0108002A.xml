<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="562" Id="CS0108002A" Left="8" OnLoadCompleted="fn_OnLoadCompleted" OnUnloadCompleted="fn_OnUnloadCompleted" PidAttrib="7" Title="BOM청구" Top="8" Ver="1.0" Width="978" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="_ds_big_cd">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
					<record>
						<CODE>0</CODE>
						<CODE_NAME>비대상</CODE_NAME>
					</record>
					<record>
						<CODE>1</CODE>
						<CODE_NAME>대상</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="_ds_mid_cd">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="_ds_small_cd">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond">
				<Contents>
					<colinfo id="POSID" size="255" summ="default" type="STRING"/>
					<colinfo id="RECE_F" size="255" summ="default" type="STRING"/>
					<colinfo id="REQDATE_FM" size="255" summ="default" type="STRING"/>
					<colinfo id="REQDATE_TO" size="255" summ="default" type="STRING"/>
					<colinfo id="REQKIND" size="256" summ="default" type="STRING"/>
					<colinfo id="PS_PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="MATNR" size="256" summ="default" type="STRING"/>
					<colinfo id="QTNUM" size="256" summ="default" type="STRING"/>
					<colinfo id="REQNO" size="256" summ="default" type="STRING"/>
					<colinfo id="BUSSI" size="256" summ="default" type="STRING"/>
					<colinfo id="REQNR" size="256" summ="default" type="STRING"/>
					<colinfo id="WBAP_PST" size="256" summ="default" type="STRING"/>
					<colinfo id="TRANDATE_FM" size="256" summ="default" type="STRING"/>
					<colinfo id="TRANDATE_TO" size="256" summ="default" type="STRING"/>
					<colinfo id="BSU" size="256" summ="default" type="STRING"/>
					<colinfo id="DPT" size="256" summ="default" type="STRING"/>
					<colinfo id="TEM" size="256" summ="default" type="STRING"/>
					<colinfo id="ARA" size="256" summ="default" type="STRING"/>
					<colinfo id="BPM" size="256" summ="default" type="STRING"/>
					<record>
						<ARA></ARA>
						<BPM></BPM>
						<BSU></BSU>
						<BUSSI></BUSSI>
						<DPT></DPT>
						<MATNR></MATNR>
						<POSID></POSID>
						<PS_PSPID></PS_PSPID>
						<QTNUM></QTNUM>
						<RECE_F></RECE_F>
						<REQDATE_FM></REQDATE_FM>
						<REQDATE_TO></REQDATE_TO>
						<REQKIND></REQKIND>
						<REQNO></REQNO>
						<REQNR></REQNR>
						<TEM></TEM>
						<TRANDATE_FM></TRANDATE_FM>
						<TRANDATE_TO></TRANDATE_TO>
						<WBAP_PST></WBAP_PST>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_bussi">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_reqkind">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_rece_f">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list" OnColumnChanged="ds_list_OnColumnChanged">
				<Contents>
					<colinfo id="ACDAT" size="24" summ="default" type="STRING"/>
					<colinfo id="ACNAM" size="36" summ="default" type="STRING"/>
					<colinfo id="ACTIM" size="18" summ="default" type="STRING"/>
					<colinfo id="APDAT" size="24" summ="default" type="STRING"/>
					<colinfo id="APNAM" size="36" summ="default" type="STRING"/>
					<colinfo id="APTIM" size="18" summ="default" type="STRING"/>
					<colinfo id="ASSNO" size="33" summ="default" type="STRING"/>
					<colinfo id="BANNAB" size="1" summ="default" type="STRING"/>
					<colinfo id="BUSSI" size="3" summ="default" type="STRING"/>
					<colinfo id="BWTAR" size="30" summ="default" type="STRING"/>
					<colinfo id="CAUSECAT" size="3" summ="default" type="STRING"/>
					<colinfo id="CAUSECOD" size="12" summ="default" type="STRING"/>
					<colinfo id="CAUSEGRP" size="24" summ="default" type="STRING"/>
					<colinfo id="CAUSETXT" size="120" summ="default" type="STRING"/>
					<colinfo id="CHAR1" size="300" summ="default" type="STRING"/>
					<colinfo id="CROPE" size="3" summ="default" type="STRING"/>
					<colinfo id="DMBTR" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="GBN" size="0" summ="default" type="STRING"/>
					<colinfo id="INSMSNO" size="60" summ="default" type="STRING"/>
					<colinfo id="MBINSMSNO" size="60" summ="default" type="STRING"/>
					<colinfo id="MBRETMSNO" size="60" summ="default" type="STRING"/>
					<colinfo id="JQPRNUM" size="30" summ="default" type="STRING"/>
					<colinfo id="LGORT" size="12" summ="default" type="STRING"/>
					<colinfo id="MAKTX" size="120" summ="default" type="STRING"/>
					<colinfo id="MANDT" size="9" summ="default" type="STRING"/>
					<colinfo id="MATNR" size="54" summ="default" type="STRING"/>
					<colinfo id="MEINS" size="9" summ="default" type="STRING"/>
					<colinfo id="MENGE" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="MMPR_DEL" size="3" summ="default" type="STRING"/>
					<colinfo id="MTART" size="12" summ="default" type="STRING"/>
					<colinfo id="NETPR" size="13" summ="default" type="DECIMAL"/>
					<colinfo id="PARLAB" size="33" summ="default" type="DECIMAL"/>
					<colinfo id="PARLAB1" size="33" summ="default" type="DECIMAL"/>
					<colinfo id="PHENOCAT" size="12" summ="default" type="STRING"/>
					<colinfo id="PHENOCOD" size="12" summ="default" type="STRING"/>
					<colinfo id="PHENOGRP" size="24" summ="default" type="STRING"/>
					<colinfo id="PHENOTXT" size="120" summ="default" type="STRING"/>
					<colinfo id="POSID" size="72" summ="default" type="STRING"/>
					<colinfo id="POSID2" size="72" summ="default" type="STRING"/>
					<colinfo id="QTNUM" size="45" summ="default" type="STRING"/>
					<colinfo id="RDATE" size="24" summ="default" type="STRING"/>
					<colinfo id="RECE_F" size="3" summ="default" type="STRING"/>
					<colinfo id="REQDATE" size="24" summ="default" type="STRING"/>
					<colinfo id="REQITEM" size="15" summ="default" type="STRING"/>
					<colinfo id="REQKIND" size="3" summ="default" type="STRING"/>
					<colinfo id="REQKINDNM" size="256" summ="default" type="STRING"/>
					<colinfo id="REQKIND2" size="3" summ="default" type="STRING"/>
					<colinfo id="REQKINDNM2" size="256" summ="default" type="STRING"/>
					<colinfo id="REQNO" size="30" summ="default" type="STRING"/>
					<colinfo id="REQNR" size="30" summ="default" type="STRING"/>
					<colinfo id="REQSN" size="15" summ="default" type="STRING"/>
					<colinfo id="RETMSNO" size="60" summ="default" type="STRING"/>
					<colinfo id="SEQNO" size="18" summ="default" type="STRING"/>
					<colinfo id="SERNO" size="6" summ="default" type="STRING"/>
					<colinfo id="STATE" size="3" summ="default" type="STRING"/>
					<colinfo id="WAERS" size="15" summ="default" type="STRING"/>
					<colinfo id="HNA" size="90" summ="default" type="STRING"/>
					<colinfo id="CHECK" size="3" summ="default" type="STRING"/>
					<colinfo id="LGORT1" size="256" summ="default" type="STRING"/>
					<colinfo id="SPT" size="256" summ="default" type="STRING"/>
					<colinfo id="ZBEPJEO" size="24" summ="default" type="STRING"/>
					<colinfo id="ZBOSUIN" size="24" summ="default" type="STRING"/>
					<colinfo id="ZGUBN" size="10" summ="default" type="STRING"/>
					<colinfo id="ZTEXT" size="256" summ="default" type="STRING"/>
					<colinfo id="ACPT_NUM" size="60" summ="default" type="STRING"/>
					<colinfo id="QR_DATE" size="24" summ="default" type="STRING"/>
					<colinfo id="SENDAT" size="24" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_mm031">
				<Contents>
					<colinfo id="ACDAT" size="8" summ="default" type="STRING"/>
					<colinfo id="ACNAM" size="36" summ="default" type="STRING"/>
					<colinfo id="AMOUNT" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="BILDAT2" size="24" summ="default" type="STRING"/>
					<colinfo id="BUSSI" size="3" summ="default" type="STRING"/>
					<colinfo id="CHECK" size="0" summ="default" type="STRING"/>
					<colinfo id="CREID" size="36" summ="default" type="STRING"/>
					<colinfo id="CREID_N" size="90" summ="default" type="STRING"/>
					<colinfo id="ERDAT" size="8" summ="default" type="STRING"/>
					<colinfo id="FLAG" size="0" summ="default" type="STRING"/>
					<colinfo id="GBN" size="0" summ="default" type="STRING"/>
					<colinfo id="JQPRNO" size="60" summ="default" type="STRING"/>
					<colinfo id="JQPRNUM" size="30" summ="default" type="STRING"/>
					<colinfo id="LGORT" size="12" summ="default" type="STRING"/>
					<colinfo id="LGORT1" size="100" summ="default" type="STRING"/>
					<colinfo id="MESGDESC" size="0" summ="default" type="STRING"/>
					<colinfo id="MMPR_DEL" size="3" summ="default" type="STRING"/>
					<colinfo id="NETWR" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="POSID" size="72" summ="default" type="STRING"/>
					<colinfo id="PRINT" size="1" summ="default" type="STRING"/>
					<colinfo id="PS_PSPID" size="54" summ="default" type="STRING"/>
					<colinfo id="QTNUM" size="45" summ="default" type="STRING"/>
					<colinfo id="RECE_F" size="3" summ="default" type="STRING"/>
					<colinfo id="REQDATE" size="24" summ="default" type="STRING"/>
					<colinfo id="REQKIND" size="3" summ="default" type="STRING"/>
					<colinfo id="REQNO" size="30" summ="default" type="STRING"/>
					<colinfo id="REQNR" size="30" summ="default" type="STRING"/>
					<colinfo id="SENDAT" size="8" summ="default" type="STRING"/>
					<colinfo id="SENID" size="36" summ="default" type="STRING"/>
					<colinfo id="SPT" size="150" summ="default" type="STRING"/>
					<colinfo id="VKGRP" size="256" summ="default" type="STRING"/>
					<colinfo id="DOCNO" size="30" summ="default" type="STRING"/>
					<colinfo id="APNAM" size="30" summ="default" type="STRING"/>
					<colinfo id="ACNAM_N" size="30" summ="default" type="STRING"/>
					<colinfo id="APNAM_N" size="30" summ="default" type="STRING"/>
					<colinfo id="APDAT" size="18" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="UPN" size="256" summ="default" type="STRING"/>
					<colinfo id="WBAP_PST" size="256" summ="default" type="STRING"/>
					<colinfo id="M_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="GNO" size="256" summ="default" type="STRING"/>
					<colinfo id="VBELN" size="256" summ="default" type="STRING"/>
					<colinfo id="CONTR_DA" size="256" summ="default" type="STRING"/>
					<colinfo id="BSTDK" size="256" summ="default" type="STRING"/>
					<colinfo id="BSTKD" size="256" summ="default" type="STRING"/>
					<colinfo id="KUNNR" size="256" summ="default" type="STRING"/>
					<colinfo id="VDATU" size="256" summ="default" type="STRING"/>
					<colinfo id="VKBUR" size="256" summ="default" type="STRING"/>
					<colinfo id="MATNR" size="256" summ="default" type="STRING"/>
					<colinfo id="PDM_CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="ERNAM" size="256" summ="default" type="STRING"/>
					<colinfo id="ERDAT2" size="256" summ="default" type="STRING"/>
					<colinfo id="CST" size="256" summ="default" type="STRING"/>
					<colinfo id="PDM803" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQ803" size="256" summ="default" type="STRING"/>
					<colinfo id="ERPHONE" size="256" summ="default" type="STRING"/>
					<colinfo id="ILDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="DOC5" size="256" summ="default" type="STRING"/>
					<colinfo id="APSTAT5" size="256" summ="default" type="STRING"/>
					<colinfo id="PROC" size="256" summ="default" type="STRING"/>
					<colinfo id="ZMAN_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="ZMAN_NM2" size="256" summ="default" type="STRING"/>
					<colinfo id="BOM_FRST_CHRG" size="256" summ="default" type="STRING"/>
					<colinfo id="BOM_LST_CHRG" size="256" summ="default" type="STRING"/>
					<colinfo id="MATRMK" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_mm031_0">
				<Contents>
					<colinfo id="ACDAT" size="8" summ="default" type="STRING"/>
					<colinfo id="ACNAM" size="36" summ="default" type="STRING"/>
					<colinfo id="AMOUNT" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="BILDAT2" size="24" summ="default" type="STRING"/>
					<colinfo id="BUSSI" size="3" summ="default" type="STRING"/>
					<colinfo id="CHECK" size="0" summ="default" type="STRING"/>
					<colinfo id="CREID" size="36" summ="default" type="STRING"/>
					<colinfo id="CREID_N" size="90" summ="default" type="STRING"/>
					<colinfo id="ERDAT" size="8" summ="default" type="STRING"/>
					<colinfo id="FLAG" size="0" summ="default" type="STRING"/>
					<colinfo id="GBN" size="0" summ="default" type="STRING"/>
					<colinfo id="JQPRNO" size="60" summ="default" type="STRING"/>
					<colinfo id="JQPRNUM" size="30" summ="default" type="STRING"/>
					<colinfo id="LGORT" size="12" summ="default" type="STRING"/>
					<colinfo id="LGORT1" size="100" summ="default" type="STRING"/>
					<colinfo id="MESGDESC" size="0" summ="default" type="STRING"/>
					<colinfo id="MMPR_DEL" size="3" summ="default" type="STRING"/>
					<colinfo id="NETWR" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="POSID" size="72" summ="default" type="STRING"/>
					<colinfo id="PRINT" size="1" summ="default" type="STRING"/>
					<colinfo id="PS_PSPID" size="54" summ="default" type="STRING"/>
					<colinfo id="QTNUM" size="45" summ="default" type="STRING"/>
					<colinfo id="RECE_F" size="3" summ="default" type="STRING"/>
					<colinfo id="REQDATE" size="24" summ="default" type="STRING"/>
					<colinfo id="REQKIND" size="3" summ="default" type="STRING"/>
					<colinfo id="REQNO" size="30" summ="default" type="STRING"/>
					<colinfo id="REQNR" size="30" summ="default" type="STRING"/>
					<colinfo id="SENDAT" size="8" summ="default" type="STRING"/>
					<colinfo id="SENID" size="36" summ="default" type="STRING"/>
					<colinfo id="SPT" size="150" summ="default" type="STRING"/>
					<colinfo id="DOCNO" size="30" summ="default" type="STRING"/>
					<colinfo id="APNAM" size="30" summ="default" type="STRING"/>
					<colinfo id="ACNAM_N" size="30" summ="default" type="STRING"/>
					<colinfo id="APNAM_N" size="30" summ="default" type="STRING"/>
					<colinfo id="APDAT" size="18" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="BOM_FRST_CHRG" size="256" summ="default" type="STRING"/>
					<colinfo id="BOM_LST_CHRG" size="256" summ="default" type="STRING"/>
					<colinfo id="MATRMK" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list_3" OnColumnChanged="ds_list_OnColumnChanged">
				<Contents>
					<colinfo id="ACDAT" size="24" summ="default" type="STRING"/>
					<colinfo id="ACNAM" size="36" summ="default" type="STRING"/>
					<colinfo id="ACTIM" size="18" summ="default" type="STRING"/>
					<colinfo id="APDAT" size="24" summ="default" type="STRING"/>
					<colinfo id="APNAM" size="36" summ="default" type="STRING"/>
					<colinfo id="APTIM" size="18" summ="default" type="STRING"/>
					<colinfo id="ASSNO" size="33" summ="default" type="STRING"/>
					<colinfo id="BANNAB" size="1" summ="default" type="STRING"/>
					<colinfo id="BUSSI" size="3" summ="default" type="STRING"/>
					<colinfo id="BWTAR" size="30" summ="default" type="STRING"/>
					<colinfo id="CAUSECAT" size="3" summ="default" type="STRING"/>
					<colinfo id="CAUSECOD" size="12" summ="default" type="STRING"/>
					<colinfo id="CAUSEGRP" size="24" summ="default" type="STRING"/>
					<colinfo id="CAUSETXT" size="120" summ="default" type="STRING"/>
					<colinfo id="CHAR1" size="300" summ="default" type="STRING"/>
					<colinfo id="CROPE" size="3" summ="default" type="STRING"/>
					<colinfo id="DMBTR" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="GBN" size="0" summ="default" type="STRING"/>
					<colinfo id="INSMSNO" size="60" summ="default" type="STRING"/>
					<colinfo id="MBINSMSNO" size="60" summ="default" type="STRING"/>
					<colinfo id="MBRETMSNO" size="60" summ="default" type="STRING"/>
					<colinfo id="JQPRNUM" size="30" summ="default" type="STRING"/>
					<colinfo id="LGORT" size="12" summ="default" type="STRING"/>
					<colinfo id="MAKTX" size="120" summ="default" type="STRING"/>
					<colinfo id="MANDT" size="9" summ="default" type="STRING"/>
					<colinfo id="MATNR" size="54" summ="default" type="STRING"/>
					<colinfo id="MEINS" size="9" summ="default" type="STRING"/>
					<colinfo id="MENGE" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="MMPR_DEL" size="3" summ="default" type="STRING"/>
					<colinfo id="MTART" size="12" summ="default" type="STRING"/>
					<colinfo id="NETPR" size="13" summ="default" type="DECIMAL"/>
					<colinfo id="PARLAB" size="33" summ="default" type="DECIMAL"/>
					<colinfo id="PARLAB1" size="33" summ="default" type="DECIMAL"/>
					<colinfo id="PHENOCAT" size="12" summ="default" type="STRING"/>
					<colinfo id="PHENOCOD" size="12" summ="default" type="STRING"/>
					<colinfo id="PHENOGRP" size="24" summ="default" type="STRING"/>
					<colinfo id="PHENOTXT" size="120" summ="default" type="STRING"/>
					<colinfo id="POSID" size="72" summ="default" type="STRING"/>
					<colinfo id="POSID2" size="72" summ="default" type="STRING"/>
					<colinfo id="QTNUM" size="45" summ="default" type="STRING"/>
					<colinfo id="RDATE" size="24" summ="default" type="STRING"/>
					<colinfo id="RECE_F" size="3" summ="default" type="STRING"/>
					<colinfo id="REQDATE" size="24" summ="default" type="STRING"/>
					<colinfo id="REQITEM" size="15" summ="default" type="STRING"/>
					<colinfo id="REQKIND" size="3" summ="default" type="STRING"/>
					<colinfo id="REQKIND2" size="3" summ="default" type="STRING"/>
					<colinfo id="REQNO" size="30" summ="default" type="STRING"/>
					<colinfo id="REQNR" size="30" summ="default" type="STRING"/>
					<colinfo id="REQSN" size="15" summ="default" type="STRING"/>
					<colinfo id="RETMSNO" size="60" summ="default" type="STRING"/>
					<colinfo id="SEQNO" size="18" summ="default" type="STRING"/>
					<colinfo id="SERNO" size="6" summ="default" type="STRING"/>
					<colinfo id="STATE" size="3" summ="default" type="STRING"/>
					<colinfo id="WAERS" size="15" summ="default" type="STRING"/>
					<colinfo id="HNA" size="90" summ="default" type="STRING"/>
					<colinfo id="CHECK" size="3" summ="default" type="STRING"/>
					<colinfo id="LGORT1" size="256" summ="default" type="STRING"/>
					<colinfo id="SPT" size="256" summ="default" type="STRING"/>
					<colinfo id="ZBEPJEO" size="24" summ="default" type="STRING"/>
					<colinfo id="ZBOSUIN" size="24" summ="default" type="STRING"/>
					<colinfo id="ZGUBN" size="10" summ="default" type="STRING"/>
					<colinfo id="ZTEXT" size="256" summ="default" type="STRING"/>
					<colinfo id="ACPT_NUM" size="60" summ="default" type="STRING"/>
					<colinfo id="SENDAT" size="24" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_status">
				<Contents>
					<colinfo id="CNT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_mm031_2">
				<Contents>
					<colinfo id="ACDAT" size="8" summ="default" type="STRING"/>
					<colinfo id="ACNAM" size="36" summ="default" type="STRING"/>
					<colinfo id="AMOUNT" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="BILDAT2" size="24" summ="default" type="STRING"/>
					<colinfo id="BUSSI" size="3" summ="default" type="STRING"/>
					<colinfo id="CHECK" size="0" summ="default" type="STRING"/>
					<colinfo id="CREID" size="36" summ="default" type="STRING"/>
					<colinfo id="CREID_N" size="90" summ="default" type="STRING"/>
					<colinfo id="ERDAT" size="8" summ="default" type="STRING"/>
					<colinfo id="FLAG" size="0" summ="default" type="STRING"/>
					<colinfo id="GBN" size="0" summ="default" type="STRING"/>
					<colinfo id="JQPRNO" size="60" summ="default" type="STRING"/>
					<colinfo id="JQPRNUM" size="30" summ="default" type="STRING"/>
					<colinfo id="LGORT" size="12" summ="default" type="STRING"/>
					<colinfo id="LGORT1" size="100" summ="default" type="STRING"/>
					<colinfo id="MESGDESC" size="0" summ="default" type="STRING"/>
					<colinfo id="MMPR_DEL" size="3" summ="default" type="STRING"/>
					<colinfo id="NETWR" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="POSID" size="72" summ="default" type="STRING"/>
					<colinfo id="PRINT" size="1" summ="default" type="STRING"/>
					<colinfo id="PS_PSPID" size="54" summ="default" type="STRING"/>
					<colinfo id="QTNUM" size="45" summ="default" type="STRING"/>
					<colinfo id="RECE_F" size="3" summ="default" type="STRING"/>
					<colinfo id="REQDATE" size="24" summ="default" type="STRING"/>
					<colinfo id="REQKIND" size="3" summ="default" type="STRING"/>
					<colinfo id="REQNO" size="30" summ="default" type="STRING"/>
					<colinfo id="REQNR" size="30" summ="default" type="STRING"/>
					<colinfo id="SENDAT" size="8" summ="default" type="STRING"/>
					<colinfo id="SENID" size="36" summ="default" type="STRING"/>
					<colinfo id="SPT" size="150" summ="default" type="STRING"/>
					<colinfo id="VKGRP" size="256" summ="default" type="STRING"/>
					<colinfo id="DOCNO" size="30" summ="default" type="STRING"/>
					<colinfo id="APNAM" size="30" summ="default" type="STRING"/>
					<colinfo id="ACNAM_N" size="30" summ="default" type="STRING"/>
					<colinfo id="APNAM_N" size="30" summ="default" type="STRING"/>
					<colinfo id="APDAT" size="18" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="UPN" size="256" summ="default" type="STRING"/>
					<colinfo id="WBAP_PST" size="256" summ="default" type="STRING"/>
					<colinfo id="M_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="GNO" size="256" summ="default" type="STRING"/>
					<colinfo id="VBELN" size="256" summ="default" type="STRING"/>
					<colinfo id="CONTR_DA" size="256" summ="default" type="STRING"/>
					<colinfo id="BSTDK" size="256" summ="default" type="STRING"/>
					<colinfo id="BSTKD" size="256" summ="default" type="STRING"/>
					<colinfo id="KUNNR" size="256" summ="default" type="STRING"/>
					<colinfo id="VDATU" size="256" summ="default" type="STRING"/>
					<colinfo id="VKBUR" size="256" summ="default" type="STRING"/>
					<colinfo id="MATNR" size="256" summ="default" type="STRING"/>
					<colinfo id="PDM_CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="ERNAM" size="256" summ="default" type="STRING"/>
					<colinfo id="ERDAT2" size="256" summ="default" type="STRING"/>
					<colinfo id="ZMAN_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="ZMAN_NM2" size="256" summ="default" type="STRING"/>
					<colinfo id="CST" size="256" summ="default" type="STRING"/>
					<colinfo id="PDM803" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQ803" size="256" summ="default" type="STRING"/>
					<colinfo id="ERPHONE" size="256" summ="default" type="STRING"/>
					<colinfo id="ILDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="DOC5" size="256" summ="default" type="STRING"/>
					<colinfo id="APSTAT5" size="256" summ="default" type="STRING"/>
					<colinfo id="PROC" size="256" summ="default" type="STRING"/>
					<colinfo id="BOM_FRST_CHRG" size="256" summ="default" type="STRING"/>
					<colinfo id="BOM_LST_CHRG" size="256" summ="default" type="STRING"/>
					<colinfo id="MATRMK" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_retrans">
				<Contents>
					<colinfo id="PS_PSPID" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_rcond">
				<Contents>
					<colinfo id="ZPROGRAM" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN" size="256" summ="default" type="STRING"/>
					<record>
						<GBN></GBN>
						<ZPROGRAM></ZPROGRAM>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_days">
				<Contents>
					<colinfo id="DAYS" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_mm031_bigo">
				<Contents>
					<colinfo id="ACDAT" size="8" summ="default" type="STRING"/>
					<colinfo id="ACNAM" size="36" summ="default" type="STRING"/>
					<colinfo id="AMOUNT" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="BILDAT2" size="24" summ="default" type="STRING"/>
					<colinfo id="BUSSI" size="3" summ="default" type="STRING"/>
					<colinfo id="CHECK" size="0" summ="default" type="STRING"/>
					<colinfo id="CREID" size="36" summ="default" type="STRING"/>
					<colinfo id="CREID_N" size="90" summ="default" type="STRING"/>
					<colinfo id="ERDAT" size="8" summ="default" type="STRING"/>
					<colinfo id="FLAG" size="0" summ="default" type="STRING"/>
					<colinfo id="GBN" size="0" summ="default" type="STRING"/>
					<colinfo id="JQPRNO" size="60" summ="default" type="STRING"/>
					<colinfo id="JQPRNUM" size="30" summ="default" type="STRING"/>
					<colinfo id="LGORT" size="12" summ="default" type="STRING"/>
					<colinfo id="LGORT1" size="100" summ="default" type="STRING"/>
					<colinfo id="MESGDESC" size="0" summ="default" type="STRING"/>
					<colinfo id="MMPR_DEL" size="3" summ="default" type="STRING"/>
					<colinfo id="NETWR" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="POSID" size="72" summ="default" type="STRING"/>
					<colinfo id="PRINT" size="1" summ="default" type="STRING"/>
					<colinfo id="PS_PSPID" size="54" summ="default" type="STRING"/>
					<colinfo id="QTNUM" size="45" summ="default" type="STRING"/>
					<colinfo id="RECE_F" size="3" summ="default" type="STRING"/>
					<colinfo id="REQDATE" size="24" summ="default" type="STRING"/>
					<colinfo id="REQKIND" size="3" summ="default" type="STRING"/>
					<colinfo id="REQNO" size="30" summ="default" type="STRING"/>
					<colinfo id="REQNR" size="30" summ="default" type="STRING"/>
					<colinfo id="SENDAT" size="8" summ="default" type="STRING"/>
					<colinfo id="SENID" size="36" summ="default" type="STRING"/>
					<colinfo id="SPT" size="150" summ="default" type="STRING"/>
					<colinfo id="VKGRP" size="256" summ="default" type="STRING"/>
					<colinfo id="DOCNO" size="30" summ="default" type="STRING"/>
					<colinfo id="APNAM" size="30" summ="default" type="STRING"/>
					<colinfo id="ACNAM_N" size="30" summ="default" type="STRING"/>
					<colinfo id="APNAM_N" size="30" summ="default" type="STRING"/>
					<colinfo id="APDAT" size="18" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="UPN" size="256" summ="default" type="STRING"/>
					<colinfo id="WBAP_PST" size="256" summ="default" type="STRING"/>
					<colinfo id="M_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="GNO" size="256" summ="default" type="STRING"/>
					<colinfo id="VBELN" size="256" summ="default" type="STRING"/>
					<colinfo id="CONTR_DA" size="256" summ="default" type="STRING"/>
					<colinfo id="BSTDK" size="256" summ="default" type="STRING"/>
					<colinfo id="BSTKD" size="256" summ="default" type="STRING"/>
					<colinfo id="KUNNR" size="256" summ="default" type="STRING"/>
					<colinfo id="VDATU" size="256" summ="default" type="STRING"/>
					<colinfo id="VKBUR" size="256" summ="default" type="STRING"/>
					<colinfo id="MATNR" size="256" summ="default" type="STRING"/>
					<colinfo id="PDM_CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="ERNAM" size="256" summ="default" type="STRING"/>
					<colinfo id="ERDAT2" size="256" summ="default" type="STRING"/>
					<colinfo id="CST" size="256" summ="default" type="STRING"/>
					<colinfo id="PDM803" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQ803" size="256" summ="default" type="STRING"/>
					<colinfo id="ERPHONE" size="256" summ="default" type="STRING"/>
					<colinfo id="ILDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="DOC5" size="256" summ="default" type="STRING"/>
					<colinfo id="APSTAT5" size="256" summ="default" type="STRING"/>
					<colinfo id="PROC" size="256" summ="default" type="STRING"/>
					<colinfo id="ZMAN_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="ZMAN_NM2" size="256" summ="default" type="STRING"/>
					<colinfo id="BOM_FRST_CHRG" size="256" summ="default" type="STRING"/>
					<colinfo id="BOM_LST_CHRG" size="256" summ="default" type="STRING"/>
					<colinfo id="MATRMK" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
		</Datasets>
		<Shape BKColor="user0" Bottom="72" Height="72" Id="Shape0" Left="-1" LineColor="user1" Right="976" TabOrder="7" Top="0" Type="Rectangle" Width="977"></Shape>
		<Static Align="Right" Height="20" Id="st_reqkind" Left="534" Style="sty_lb_search" TabOrder="8" Text="청구종류&#32;" Top="27" VAlign="Middle" Width="80"></Static>
		<Static Align="Right" Height="20" Id="st_reqdate" Left="226" Style="sty_lb_search" TabOrder="9" Text="청구생성기간&#32;" Top="6" VAlign="Middle" Width="80"></Static>
		<Calendar BindDataset="ds_cond" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="REQDATE_FM" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_reqdate_fm" Left="308" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_search" SundayTextColor="user35" TabOrder="2" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="6" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="97"></Calendar>
		<Static Align="Center" Border="None" Color="user7" Font="굴림,9" Height="21" Id="Static13" Left="408" TabOrder="11" Text="~" Top="6" VAlign="Middle" Width="18"></Static>
		<Calendar BindDataset="ds_cond" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="REQDATE_TO" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_reqdate_to" Left="428" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_search" SundayTextColor="user35" TabOrder="3" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="6" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="97"></Calendar>
		<Static Align="Right" Height="20" Id="Static7" Left="4" Style="sty_lb_search" TabOrder="10" Text="업체명&#32;" Top="27" VAlign="Middle" Width="97"></Static>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="CODE" Column="REQKIND" DataColumn="CODE_NAME" Height="20" Id="cb_reqkind" InnerDataset="ds_reqkind" Left="614" Style="sty_ipt_search" TabOrder="4" Top="27" Width="140"></Combo>
		<Grid AreaSelect="TRUE" AutoEnter="TRUE" AutoFitEndLine="Hide" BindDataset="ds_mm031" BkColor2="default" BoldHead="true" Border="Flat" Bottom="552" CellMoving="TRUE" ColSelect="TRUE" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="30" Height="448" Id="grd_sum" InputPanel="FALSE" Left="8" LineColor="user20" LineType="ExHORZ" OnCellDBLClick="grd_sum_onCellDBLClick" OnCellPosChanged="grd_sum_OnCellPosChanged" OnExpandEdit="grd_list_OnHeadClick" OnHeadClick="grd_list_OnHeadClick" Right="968" RowHeight="20" Style="sty_grid" TabOrder="12" TabStop="true" Top="104" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="960">
			<contents>
				<format id="Default">
					<columns>
						<col fix="left" width="30"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="92"/>
						<col width="189"/>
						<col width="80"/>
						<col width="0"/>
						<col width="109"/>
						<col width="199"/>
						<col width="70"/>
						<col width="60"/>
						<col width="100"/>
						<col width="0"/>
						<col width="0"/>
						<col width="0"/>
						<col width="0"/>
						<col width="0"/>
						<col width="0"/>
						<col width="0"/>
						<col width="0"/>
						<col width="75"/>
						<col width="0"/>
						<col width="0"/>
						<col width="0"/>
						<col width="0"/>
						<col width="0"/>
						<col width="0"/>
						<col width="0"/>
						<col width="0"/>
						<col width="59"/>
						<col width="70"/>
						<col width="70"/>
						<col width="70"/>
						<col width="89"/>
						<col width="69"/>
						<col width="70"/>
						<col width="70"/>
						<col width="70"/>
						<col width="70"/>
						<col width="0"/>
						<col width="70"/>
						<col width="70"/>
						<col width="70"/>
						<col width="70"/>
						<col width="70"/>
					</columns>
					<head>
						<cell align="center" col="0" color="user21" display="text" font="굴림,9" text="선택"/>
						<cell align="center" col="1" color="user21" display="text" font="굴림,9" text="문서번호"/>
						<cell align="center" col="2" color="user21" display="text" font="굴림,9" text="청구번호"/>
						<cell align="center" col="3" color="user21" display="text" font="굴림,9" text="견적번호"/>
						<cell align="center" col="4" color="user21" display="text" font="굴림,9" text="부서"/>
						<cell align="center" col="5" color="user21" display="text" font="굴림,9" text="보수협력사"/>
						<cell col="6" color="user21" display="text" font="굴림,9" text="통합Proj"/>
						<cell col="7" color="user21" display="text" font="굴림,9" text="Proj.번호"/>
						<cell col="8" color="user21" display="text" font="굴림,9" text="공사번호"/>
						<cell col="9" color="user21" display="text" font="굴림,9" text="현장명"/>
						<cell align="center" col="10" color="user21" display="text" font="굴림,9" text="작성일자"/>
						<cell align="center" col="11" color="user21" display="text" font="굴림,9" text="사업부"/>
						<cell align="center" col="12" color="user21" display="text" font="굴림,9" text="청구종류"/>
						<cell align="center" col="13" color="user21" display="text" font="굴림,9" text="MMPR관리번호"/>
						<cell align="center" col="14" color="user21" display="text" font="굴림,9" text="MMPR&#32;NO"/>
						<cell align="center" col="15" color="user21" display="text" font="굴림,9" text="진행상태"/>
						<cell align="center" col="16" color="user21" display="text" font="굴림,9" text="결재진행상태"/>
						<cell align="center" col="17" color="user21" display="text" font="굴림,9" text="판매가"/>
						<cell align="center" col="18" color="user21" display="text" font="굴림,9" text="견적가"/>
						<cell align="center" col="19" color="user21" display="text" font="굴림,9" text="수주율"/>
						<cell align="center" col="20" color="user21" display="text" font="굴림,9" text="계산서요청일"/>
						<cell col="21" color="user21" display="text" font="굴림,9" text="작성자"/>
						<cell align="center" col="22" color="user21" display="text" font="굴림,9" text="전송일"/>
						<cell col="23" color="user21" display="text" font="굴림,9" text="접수자"/>
						<cell align="center" col="24" color="user21" display="text" font="굴림,9" text="접수일"/>
						<cell col="25" color="user21" display="text" font="굴림,9" text="승인자"/>
						<cell align="center" col="26" color="user21" display="text" font="굴림,9" text="승인일"/>
						<cell align="center" col="27" color="user21" display="text" font="굴림,9" text="PM&#32;승인일"/>
						<cell align="center" col="28" color="user21" display="text" font="굴림,9" text="발행여부"/>
						<cell align="center" col="29" color="user21" display="text" font="굴림,9" text="BOM청구"/>
						<cell col="30" color="user21" display="text" font="굴림,9" text="사양전송"/>
						<cell col="31" color="user21" display="text" font="굴림,9" text="전송일"/>
						<cell col="32" color="user21" display="text" font="굴림,9" text="최종전송일"/>
						<cell col="33" color="user21" display="text" font="굴림,9" text="전송자"/>
						<cell col="34" color="user21" display="text" font="굴림,9" text="사양재전송여부"/>
						<cell col="35" color="user21" display="text" font="굴림,9" text="재전송차수"/>
						<cell col="36" color="user21" display="text" font="굴림,9" text="최초설계일"/>
						<cell col="37" color="user21" display="text" font="굴림,9" text="최종설계일"/>
						<cell col="38" color="user21" display="text" font="굴림,9" text="출하예정일"/>
						<cell col="39" color="user21" display="text" font="굴림,9" text="승인일자"/>
						<cell col="40" color="user21" display="text" font="굴림,9" text="수주취소여부"/>
						<cell col="41" color="user21" display="text" font="굴림,9" text="실측일자"/>
						<cell col="42" color="user21" display="text" font="굴림,9" text="LAYOUT&#32;요청일자" wordwrap="word"/>
						<cell col="43" color="user21" display="text" font="굴림,9" text="LAYOUT&#32;완료일자" wordwrap="word"/>
						<cell col="44" color="user21" display="text" font="굴림,9" text="공정여부" wordwrap="word"/>
						<cell col="45" color="user21" display="text" font="굴림,9" text="비고" wordwrap="word"/>
					</head>
					<body>
						<cell align="center" bkcolor2="user22" col="0" colid="CHECK" display="checkbox" edit="checkbox"/>
						<cell align="center" bkcolor2="user22" col="1" colid="REQNO" color='expr:iif(length(ds_mm031.getColumn(row,&quot;DOC5&quot;))&#32;&gt;&#32;0&#32;&amp;&amp;&#32;ds_mm031.getColumn(row,&quot;APSTAT5&quot;)&#32;&lt;&gt;&#32;&apos;5&apos;&#32;&amp;&amp;&#32;ds_mm031.getColumn(row,&quot;APSTAT5&quot;)&#32;&lt;&gt;&#32;&apos;2&apos;,&#32;&apos;red&apos;,&apos;&apos;)' display="text"/>
						<cell align="center" bkcolor2="user22" col="2" colid="REQNR" color='expr:iif(length(ds_mm031.getColumn(row,&quot;DOC5&quot;))&#32;&gt;&#32;0&#32;&amp;&amp;&#32;ds_mm031.getColumn(row,&quot;APSTAT5&quot;)&#32;&lt;&gt;&#32;&apos;5&apos;&#32;&amp;&amp;&#32;ds_mm031.getColumn(row,&quot;APSTAT5&quot;)&#32;&lt;&gt;&#32;&apos;2&apos;,&#32;&apos;red&apos;,&apos;&apos;)' display="text"/>
						<cell align="center" bkcolor2="user22" col="3" colid="QTNUM" color='expr:iif(length(ds_mm031.getColumn(row,&quot;DOC5&quot;))&#32;&gt;&#32;0&#32;&amp;&amp;&#32;ds_mm031.getColumn(row,&quot;APSTAT5&quot;)&#32;&lt;&gt;&#32;&apos;5&apos;&#32;&amp;&amp;&#32;ds_mm031.getColumn(row,&quot;APSTAT5&quot;)&#32;&lt;&gt;&#32;&apos;2&apos;,&#32;&apos;red&apos;,&apos;&apos;)' display="text"/>
						<cell bkcolor2="user22" col="4" colid="VKGRP" color='expr:iif(length(ds_mm031.getColumn(row,&quot;DOC5&quot;))&#32;&gt;&#32;0&#32;&amp;&amp;&#32;ds_mm031.getColumn(row,&quot;APSTAT5&quot;)&#32;&lt;&gt;&#32;&apos;5&apos;&#32;&amp;&amp;&#32;ds_mm031.getColumn(row,&quot;APSTAT5&quot;)&#32;&lt;&gt;&#32;&apos;2&apos;,&#32;&apos;red&apos;,&apos;&apos;)' display="text"/>
						<cell bkcolor2="user22" col="5" colid="LGORT1" color='expr:iif(length(ds_mm031.getColumn(row,&quot;DOC5&quot;))&#32;&gt;&#32;0&#32;&amp;&amp;&#32;ds_mm031.getColumn(row,&quot;APSTAT5&quot;)&#32;&lt;&gt;&#32;&apos;5&apos;&#32;&amp;&amp;&#32;ds_mm031.getColumn(row,&quot;APSTAT5&quot;)&#32;&lt;&gt;&#32;&apos;2&apos;,&#32;&apos;red&apos;,&apos;&apos;)' display="text"/>
						<cell align="center" bkcolor2="user22" col="6" colid="UPN" color='expr:iif(length(ds_mm031.getColumn(row,&quot;DOC5&quot;))&#32;&gt;&#32;0&#32;&amp;&amp;&#32;ds_mm031.getColumn(row,&quot;APSTAT5&quot;)&#32;&lt;&gt;&#32;&apos;5&apos;&#32;&amp;&amp;&#32;ds_mm031.getColumn(row,&quot;APSTAT5&quot;)&#32;&lt;&gt;&#32;&apos;2&apos;,&#32;&apos;red&apos;,&apos;&apos;)' display="text"/>
						<cell align="center" bkcolor2="user22" col="7" colid="PS_PSPID" color='expr:iif(length(ds_mm031.getColumn(row,&quot;DOC5&quot;))&#32;&gt;&#32;0&#32;&amp;&amp;&#32;ds_mm031.getColumn(row,&quot;APSTAT5&quot;)&#32;&lt;&gt;&#32;&apos;5&apos;&#32;&amp;&amp;&#32;ds_mm031.getColumn(row,&quot;APSTAT5&quot;)&#32;&lt;&gt;&#32;&apos;2&apos;,&#32;&apos;red&apos;,&apos;&apos;)' display="text"/>
						<cell align="center" col="8" colid="POSID2" color='expr:iif(length(ds_mm031.getColumn(row,&quot;DOC5&quot;))&#32;&gt;&#32;0&#32;&amp;&amp;&#32;ds_mm031.getColumn(row,&quot;APSTAT5&quot;)&#32;&lt;&gt;&#32;&apos;5&apos;&#32;&amp;&amp;&#32;ds_mm031.getColumn(row,&quot;APSTAT5&quot;)&#32;&lt;&gt;&#32;&apos;2&apos;,&#32;&apos;red&apos;,&apos;&apos;)' display="text"/>
						<cell align="left" bkcolor2="user22" col="9" colid="SPT" color='expr:iif(length(ds_mm031.getColumn(row,&quot;DOC5&quot;))&#32;&gt;&#32;0&#32;&amp;&amp;&#32;ds_mm031.getColumn(row,&quot;APSTAT5&quot;)&#32;&lt;&gt;&#32;&apos;5&apos;&#32;&amp;&amp;&#32;ds_mm031.getColumn(row,&quot;APSTAT5&quot;)&#32;&lt;&gt;&#32;&apos;2&apos;,&#32;&apos;red&apos;,&apos;&apos;)' display="text"/>
						<cell align="center" bkcolor2="user22" col="10" colid="REQDATE" color='expr:iif(length(ds_mm031.getColumn(row,&quot;DOC5&quot;))&#32;&gt;&#32;0&#32;&amp;&amp;&#32;ds_mm031.getColumn(row,&quot;APSTAT5&quot;)&#32;&lt;&gt;&#32;&apos;5&apos;&#32;&amp;&amp;&#32;ds_mm031.getColumn(row,&quot;APSTAT5&quot;)&#32;&lt;&gt;&#32;&apos;2&apos;,&#32;&apos;red&apos;,&apos;&apos;)' display="date" Mask="yyyy.MM.dd"/>
						<cell align="center" bkcolor2="user22" col="11" colid="BUSSI" color='expr:iif(length(ds_mm031.getColumn(row,&quot;DOC5&quot;))&#32;&gt;&#32;0&#32;&amp;&amp;&#32;ds_mm031.getColumn(row,&quot;APSTAT5&quot;)&#32;&lt;&gt;&#32;&apos;5&apos;&#32;&amp;&amp;&#32;ds_mm031.getColumn(row,&quot;APSTAT5&quot;)&#32;&lt;&gt;&#32;&apos;2&apos;,&#32;&apos;red&apos;,&apos;&apos;)' combocol="CODE" combodataset="ds_bussi" combotext="CODE_NAME" display="combo"/>
						<cell align="center" bkcolor2="user22" col="12" colid="REQKIND" color='expr:iif(length(ds_mm031.getColumn(row,&quot;DOC5&quot;))&#32;&gt;&#32;0&#32;&amp;&amp;&#32;ds_mm031.getColumn(row,&quot;APSTAT5&quot;)&#32;&lt;&gt;&#32;&apos;5&apos;&#32;&amp;&amp;&#32;ds_mm031.getColumn(row,&quot;APSTAT5&quot;)&#32;&lt;&gt;&#32;&apos;2&apos;,&#32;&apos;red&apos;,&apos;&apos;)' combocol="CODE" combodataset="ds_reqkind" combotext="CODE_NAME" display="combo"/>
						<cell align="center" bkcolor2="user22" col="13" colid="JQPRNO" display="text"/>
						<cell align="center" bkcolor2="user22" col="14" colid="JQPRNUM" display="text"/>
						<cell align="center" bkcolor2="user22" col="15" colid="RECE_F" combocol="CODE" combodataset="ds_rece_f" combotext="CODE_NAME" display="combo"/>
						<cell align="center" bkcolor2="user22" col="16" colid="WBAP_PST" combocol="CODE" combodataset="ds_wbap_pst" combotext="CODE_NAME" display="combo"/>
						<cell align="right" bkcolor2="user22" col="17" colid="NETWR" display="number"/>
						<cell align="right" bkcolor2="user22" col="18" colid="AMOUNT" display="number"/>
						<cell align="right" bkcolor2="user22" col="19" display="number" expr="iif(Round((AMOUNT/NETWR)&#32;*&#32;100,1)&#32;&gt;&#32;0&#32;,Round((AMOUNT/NETWR)&#32;*&#32;100,1),&apos;&apos;)"/>
						<cell align="center" bkcolor2="user22" col="20" colid="BILDAT2" display='expr:iif(length(ds_mm031.getColumn(row,&quot;BILDAT2&quot;))&#32;&lt;&#32;1,&#32;&apos;text&apos;,&apos;date&apos;)' edit='expr:iif(length(ds_mm031.getColumn(row,&quot;QTNUM&quot;))&#32;&gt;&#32;0&#32;&amp;&amp;&#32;ds_mm031.getColumn(row,&quot;PRINT&quot;)&#32;!=&#32;&apos;Y&apos;,&quot;date&quot;,&quot;none&quot;)' expandimage="btn_grid_icon_pen" expandshow='expr:iif(length(ds_mm031.getColumn(row,&quot;QTNUM&quot;))&#32;&gt;&#32;0&#32;&amp;&amp;&#32;ds_mm031.getColumn(row,&quot;PRINT&quot;)&#32;!=&#32;&apos;Y&apos;,true,false)' expandsize="18" Mask="yyyy.MM.dd"/>
						<cell align="center" bkcolor2="user22" col="21" colid="CREID_N" color='expr:iif(length(ds_mm031.getColumn(row,&quot;DOC5&quot;))&#32;&gt;&#32;0&#32;&amp;&amp;&#32;ds_mm031.getColumn(row,&quot;APSTAT5&quot;)&#32;&lt;&gt;&#32;&apos;5&apos;&#32;&amp;&amp;&#32;ds_mm031.getColumn(row,&quot;APSTAT5&quot;)&#32;&lt;&gt;&#32;&apos;2&apos;,&#32;&apos;red&apos;,&apos;&apos;)' display="text"/>
						<cell align="center" bkcolor2="user22" col="22" colid="SENDAT" display="text" Mask="####.##.##"/>
						<cell align="center" bkcolor2="user22" col="23" colid="ACNAM_N" display="text"/>
						<cell align="center" bkcolor2="user22" col="24" colid="ACDAT" display="text" Mask="####.##.##"/>
						<cell align="center" bkcolor2="user22" col="25" colid="APNAM_N" display="text"/>
						<cell align="center" bkcolor2="user22" col="26" colid="APDAT" display="text" Mask="####.##.##"/>
						<cell align="center" bkcolor2="user22" col="27" colid="ERDAT" display="text" Mask="####.##.##"/>
						<cell align="center" bkcolor2="user22" col="28" colid="PRINT" display="text"/>
						<cell align="center" bkcolor2="user22" col="29" colid="CHK" display="text"/>
						<cell align="center" col="30" colid="PDM_CHK" color='expr:iif(length(ds_mm031.getColumn(row,&quot;DOC5&quot;))&#32;&gt;&#32;0&#32;&amp;&amp;&#32;ds_mm031.getColumn(row,&quot;APSTAT5&quot;)&#32;&lt;&gt;&#32;&apos;5&apos;&#32;&amp;&amp;&#32;ds_mm031.getColumn(row,&quot;APSTAT5&quot;)&#32;&lt;&gt;&#32;&apos;2&apos;,&#32;&apos;red&apos;,&apos;&apos;)' display="text"/>
						<cell align="center" col="31" colid="ERDAT2" color='expr:iif(length(ds_mm031.getColumn(row,&quot;DOC5&quot;))&#32;&gt;&#32;0&#32;&amp;&amp;&#32;ds_mm031.getColumn(row,&quot;APSTAT5&quot;)&#32;&lt;&gt;&#32;&apos;5&apos;&#32;&amp;&amp;&#32;ds_mm031.getColumn(row,&quot;APSTAT5&quot;)&#32;&lt;&gt;&#32;&apos;2&apos;,&#32;&apos;red&apos;,&apos;&apos;)' display="date" Mask="yyyy.MM.dd"/>
						<cell align="center" col="32" colid="ERDAT4" color='expr:iif(length(ds_mm031.getColumn(row,&quot;DOC5&quot;))&#32;&gt;&#32;0&#32;&amp;&amp;&#32;ds_mm031.getColumn(row,&quot;APSTAT5&quot;)&#32;&lt;&gt;&#32;&apos;5&apos;&#32;&amp;&amp;&#32;ds_mm031.getColumn(row,&quot;APSTAT5&quot;)&#32;&lt;&gt;&#32;&apos;2&apos;,&#32;&apos;red&apos;,&apos;&apos;)' display="date" Mask="yyyy.MM.dd"/>
						<cell align="center" col="33" colid="ERNAM" color='expr:iif(length(ds_mm031.getColumn(row,&quot;DOC5&quot;))&#32;&gt;&#32;0&#32;&amp;&amp;&#32;ds_mm031.getColumn(row,&quot;APSTAT5&quot;)&#32;&lt;&gt;&#32;&apos;5&apos;&#32;&amp;&amp;&#32;ds_mm031.getColumn(row,&quot;APSTAT5&quot;)&#32;&lt;&gt;&#32;&apos;2&apos;,&#32;&apos;red&apos;,&apos;&apos;)' display="text"/>
						<cell align="center" col="34" colid="PDM803" color='expr:iif(length(ds_mm031.getColumn(row,&quot;DOC5&quot;))&#32;&gt;&#32;0&#32;&amp;&amp;&#32;ds_mm031.getColumn(row,&quot;APSTAT5&quot;)&#32;&lt;&gt;&#32;&apos;5&apos;&#32;&amp;&amp;&#32;ds_mm031.getColumn(row,&quot;APSTAT5&quot;)&#32;&lt;&gt;&#32;&apos;2&apos;,&#32;&apos;red&apos;,&apos;&apos;)' display="text"/>
						<cell align="center" col="35" colid="SEQ803" color='expr:iif(length(ds_mm031.getColumn(row,&quot;DOC5&quot;))&#32;&gt;&#32;0&#32;&amp;&amp;&#32;ds_mm031.getColumn(row,&quot;APSTAT5&quot;)&#32;&lt;&gt;&#32;&apos;5&apos;&#32;&amp;&amp;&#32;ds_mm031.getColumn(row,&quot;APSTAT5&quot;)&#32;&lt;&gt;&#32;&apos;2&apos;,&#32;&apos;red&apos;,&apos;&apos;)' display="text"/>
						<cell align="center" col="36" colid="BOM_FRST_CHRG" color='expr:iif(length(ds_mm031.getColumn(row,&quot;DOC5&quot;))&#32;&gt;&#32;0&#32;&amp;&amp;&#32;ds_mm031.getColumn(row,&quot;APSTAT5&quot;)&#32;&lt;&gt;&#32;&apos;5&apos;&#32;&amp;&amp;&#32;ds_mm031.getColumn(row,&quot;APSTAT5&quot;)&#32;&lt;&gt;&#32;&apos;2&apos;,&#32;&apos;red&apos;,&apos;&apos;)' display="date" Mask="yyyy.MM.dd"/>
						<cell align="center" col="37" colid="BOM_LST_CHRG" color='expr:iif(length(ds_mm031.getColumn(row,&quot;DOC5&quot;))&#32;&gt;&#32;0&#32;&amp;&amp;&#32;ds_mm031.getColumn(row,&quot;APSTAT5&quot;)&#32;&lt;&gt;&#32;&apos;5&apos;&#32;&amp;&amp;&#32;ds_mm031.getColumn(row,&quot;APSTAT5&quot;)&#32;&lt;&gt;&#32;&apos;2&apos;,&#32;&apos;red&apos;,&apos;&apos;)' display="date" Mask="yyyy.MM.dd"/>
						<cell align="center" col="38" colid="ILDAT" color='expr:iif(length(ds_mm031.getColumn(row,&quot;DOC5&quot;))&#32;&gt;&#32;0&#32;&amp;&amp;&#32;ds_mm031.getColumn(row,&quot;APSTAT5&quot;)&#32;&lt;&gt;&#32;&apos;5&apos;&#32;&amp;&amp;&#32;ds_mm031.getColumn(row,&quot;APSTAT5&quot;)&#32;&lt;&gt;&#32;&apos;2&apos;,&#32;&apos;red&apos;,&apos;&apos;)' display="date" Mask="yyyy.MM.dd"/>
						<cell align="center" col="39" colid="APDAT" color='expr:iif(length(ds_mm031.getColumn(row,&quot;DOC5&quot;))&#32;&gt;&#32;0&#32;&amp;&amp;&#32;ds_mm031.getColumn(row,&quot;APSTAT5&quot;)&#32;&lt;&gt;&#32;&apos;5&apos;&#32;&amp;&amp;&#32;ds_mm031.getColumn(row,&quot;APSTAT5&quot;)&#32;&lt;&gt;&#32;&apos;2&apos;,&#32;&apos;red&apos;,&apos;&apos;)' display="date" Mask="yyyy.MM.dd"/>
						<cell align="center" col="40" colid="DOC5" color='expr:iif(length(ds_mm031.getColumn(row,&quot;DOC5&quot;))&#32;&gt;&#32;0,&#32;&apos;red&apos;,&apos;&apos;)' display="date"/>
						<cell align="center" col="41" colid="ACTUALM" color='expr:iif(length(ds_mm031.getColumn(row,&quot;DOC5&quot;))&#32;&gt;&#32;0&#32;&amp;&amp;&#32;ds_mm031.getColumn(row,&quot;APSTAT5&quot;)&#32;&lt;&gt;&#32;&apos;5&apos;&#32;&amp;&amp;&#32;ds_mm031.getColumn(row,&quot;APSTAT5&quot;)&#32;&lt;&gt;&#32;&apos;2&apos;,&#32;&apos;red&apos;,&apos;&apos;)' display="date" Mask="yyyy.MM.dd"/>
						<cell align="center" col="42" colid="LAYOUTR" color='expr:iif(length(ds_mm031.getColumn(row,&quot;DOC5&quot;))&#32;&gt;&#32;0&#32;&amp;&amp;&#32;ds_mm031.getColumn(row,&quot;APSTAT5&quot;)&#32;&lt;&gt;&#32;&apos;5&apos;&#32;&amp;&amp;&#32;ds_mm031.getColumn(row,&quot;APSTAT5&quot;)&#32;&lt;&gt;&#32;&apos;2&apos;,&#32;&apos;red&apos;,&apos;&apos;)' display="date" Mask="yyyy.MM.dd"/>
						<cell align="center" col="43" colid="LAYOUTC" color='expr:iif(length(ds_mm031.getColumn(row,&quot;DOC5&quot;))&#32;&gt;&#32;0&#32;&amp;&amp;&#32;ds_mm031.getColumn(row,&quot;APSTAT5&quot;)&#32;&lt;&gt;&#32;&apos;5&apos;&#32;&amp;&amp;&#32;ds_mm031.getColumn(row,&quot;APSTAT5&quot;)&#32;&lt;&gt;&#32;&apos;2&apos;,&#32;&apos;red&apos;,&apos;&apos;)' display="date" Mask="yyyy.MM.dd"/>
						<cell align="center" col="44" colid="PROC" display="normal"/>
						<cell align="center" col="45" colid="MATRMK" display="normal"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Div BKColor="user0" Height="20" Id="div_code" Left="103" OnLoadCompleted="fn_OnLoadCompleted" OnTimer="WB0199010A_OnTimer" TabOrder="13" Text="Div0" Top="27" Url="WB01::WB0199010A.xml" Width="415">
			<Contents></Contents>
		</Div>
		<Static Align="Right" Height="20" Id="Static1" Left="226" Style="sty_lb_search" TabOrder="14" Text="Proj번호" Top="48" VAlign="Middle" Width="80"></Static>
		<Edit BindDataset="ds_cond" Border="Flat" Column="PS_PSPID" Height="20" Id="ed_pspid" Left="308" MaxLength="6" Style="sty_ipt_search" TabOrder="5" Top="48" UpperOnly="TRUE" Width="94"></Edit>
		<Button Height="18" Id="btn_pspid" ImageID="btn_icon_search" Left="402" OnClick="btn_pjt_OnClick" TabOrder="15" Text="Button0" Top="48" Width="18"></Button>
		<Static Align="Right" Height="20" Id="Static3" Left="4" Style="sty_lb_search" TabOrder="16" Text="견적번호&#32;" Top="48" VAlign="Middle" Width="97"></Static>
		<Edit BindDataset="ds_cond" Border="Flat" Column="QTNUM" Height="20" Id="ed_qtnum" Left="102" Style="sty_ipt_search" TabOrder="6" Top="49" UpperOnly="TRUE" Width="94"></Edit>
		<Static Align="Right" Height="20" Id="st_reqno" Left="4" Style="sty_lb_search" TabOrder="17" Text="문서번호&#32;" Top="6" VAlign="Middle" Width="97"></Static>
		<Edit BindDataset="ds_cond" Border="Flat" Column="REQNO" Height="20" Id="ed_reqno" Left="103" Style="sty_ipt_search" TabOrder="1" Top="6" UpperOnly="TRUE" Width="95"></Edit>
		<Button Height="18" Id="Button2" ImageID="btn_icon_search" Left="199" OnClick="ufn_getReqNo" TabOrder="18" Text="Button0" Top="7" Width="18"></Button>
		<Static Align="Right" Height="20" Id="Static4" Left="783" Style="sty_lb_search" TabOrder="19" Text="사업부&#32;" Top="27" VAlign="Middle" Width="80"></Static>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="CODE" Column="BUSSI" DataColumn="CODE_NAME" Height="20" Id="cb_bussi" InnerDataset="ds_bussi" Left="864" Style="sty_ipt_search" TabOrder="20" Top="27" Width="100"></Combo>
		<Static Align="Right" Height="20" Id="Static5" Left="534" Style="sty_lb_search" TabOrder="22" Text="청구번호&#32;" Top="48" VAlign="Middle" Width="80"></Static>
		<Edit BindDataset="ds_cond" Border="Flat" Column="REQNR" Height="20" Id="ed_reqnr" Left="616" Style="sty_ipt_search" TabOrder="21" Top="48" UpperOnly="TRUE" Width="95"></Edit>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_bom" ImageID="btn_sub_03" Left="8" LeftMargin="12" OnClick="btn_bom_OnClick" Style="sty_btn" TabOrder="23" Text="BOM" Top="77" Transparent="TRUE" Width="60"></Button>
		<Static Align="Right" Height="20" Id="st_tran" Left="534" Style="sty_lb_search" TabOrder="26" Text="사양전송기간&#32;" Top="6" VAlign="Middle" Width="80"></Static>
		<Calendar BindDataset="ds_cond" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="TRANDATE_FM" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_trandate_fm" Left="615" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_search" SundayTextColor="user35" TabOrder="24" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="6" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="97"></Calendar>
		<Static Align="Center" Border="None" Color="user7" Font="굴림,9" Height="20" Id="Static8" Left="717" TabOrder="27" Text="~" Top="6" VAlign="Middle" Width="18"></Static>
		<Calendar BindDataset="ds_cond" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="TRANDATE_TO" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_trandate_to" Left="737" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_search" SundayTextColor="user35" TabOrder="25" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="6" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="97"></Calendar>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_speccopy" ImageID="btn_sub_04" Left="68" LeftMargin="12" OnClick="btn_speccopy_OnClick" Style="sty_btn" TabOrder="30" Text="사양복사" Top="77" Transparent="TRUE" Width="76"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_retrans" ImageID="btn_sub_05" Left="144" LeftMargin="12" OnClick="btn_retrans_OnClick" Style="sty_btn" TabOrder="29" Text="사양재전송" Top="77" Transparent="TRUE" Visible="FALSE" Width="85"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="Button4" ImageID="btn_sub_04" Left="232" LeftMargin="12" OnClick="ufn_excelList" Style="sty_btn" TabOrder="28" Text="엑셀출력2" Top="77" Transparent="TRUE" Visible="FALSE" Width="76"></Button>
		<Button BindDataset="ds_list" ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_processDate" ImageID="btn_sub_06" Left="310" LeftMargin="12" OnClick="btn_processDate_OnClick" Style="sty_btn" TabOrder="31" Text="실측&#32;및&#32;layout" Top="77" Transparent="TRUE" Width="98"></Button>
		<Button BindDataset="ds_list" ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_process" ImageID="btn_sub_06" Left="408" LeftMargin="12" OnClick="btn_process_OnClick" Style="sty_btn" TabOrder="32" Text="공정관리(NC)" Top="77" Transparent="TRUE" Width="97"></Button>
		<Button BindDataset="ds_list" ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_save_bigo" ImageID="btn_sub_04" Left="896" LeftMargin="12" OnClick="btn_savebigo_OnClick" Style="sty_btn" TabOrder="33" Text="비고-저장" Top="77" Transparent="TRUE" Visible="FALSE" Width="70"></Button>
	</Form>
	<Script><![CDATA[/*
 ******************************************************************************************
 * 기      능   : BOM 청구
 * 작  성  자   : Yong Ah Reum
 * 작성  일자   : 2015.05.28
 * ----------------------------------------------------------------------------------------
 * HISTORY    : 수주취소건 조회가능하지만 실제 저장처리 불가토록 처리 2016.04.29
 *            : 시스템공사 bom 팝업 기능 호출 및 사양복사 기능 추가 2016.11.15
 *            : 시스템공사 bom 실측 및 LAYOUT 관련 정보입력 기능 추가 2017.03.23
 ******************************************************************************************
 */
#include "LIB::commons.js";    // 공통 스크립트
#include "LIB::utility.js";    // 다중 선택
#include "LIB::common_cs.js";	// 서비스 공통 스크립트
//=========================================================================================
// [ PART 1 ]
// Form에서 사용될 전역변수를 선언
// FORM에서 사용되는 전역변수는 대문자로 작성하며, F_XXX 의 형태를 갖도록 한다.
//=========================================================================================


var retrans_visible = false;
var bgsave_visible = false;

//=========================================================================================
// [ PART 2 ]
// Form Loading / Unloading 시 작업 정의
//=========================================================================================
function fn_OnLoadCompleted(obj) {
    // Form 로드 이벤트 맨 첫줄에 기술
    gfn_initForm(true);

    // 청구종류코드,청구진행,사업장,자재평가유형코드  DataSet 가져오기
    var codeArr = ["3","CS151"];
    var dsObjArr = [ds_reqkind,ds_bussi];
    var addTypeArr = [G_CODE_ALL,G_CODE_ALL];
    gfn_searchCommCode(codeArr, dsObjArr, addTypeArr,true);

    cal_reqdate_to.value = gfn_getCurrDate();
    cal_reqdate_fm.value = gfn_getBeforeDate(cal_reqdate_to.value, 7);

    //btn_serno_into.Enable = true;
    //btn_serno_del.Enable = true;

    var user_grp = gfn_getUserGroup();

    if(user_grp <> "40"){
        btn_serno_del.Enable = false;
        return;
    }
}
/********************************************************************************
* 기      능   : 공통코드가 조회된 후의 Callback 함수
********************************************************************************/
function fn_completeInit(sCode, sDsObj, sCodeType) {
    cb_reqkind.index = 0;
    cb_bussi.index = 0;
    ds_reqkind.filter("CODE = ''OR CODE = '7' OR CODE = '1' OR CODE = 'S'");
    gfn_showMsg("CI00007");

    // 2015.09.14 BOM 재전송 기능 추가(윤경환KJ, 최선경SW, 이동진SW, 이세호SW만 가능) 송현섭BJ추가(최선경SW 요청)
    /*
    if(G_USER_ID == "3011038" || G_USER_ID == "2018209" || G_USER_ID == "2020882" || G_USER_ID == "2025418" || G_USER_ID == "2003937"
    || G_USER_ID == "2021056" || G_USER_ID == "2017288" || G_USER_ID == "3002519" 
    || G_USER_ID == "2021200" || G_USER_ID == "2023687" || G_USER_ID == "2024039" || G_USER_ID == "2025396" || G_USER_ID == "2025604"
    || G_USER_ID == "2018900" || G_USER_ID == "2029758" || G_USER_ID == "2999999") {
        btn_retrans.Visible = true;
    }
    */
    
    //====== 위의 권한 로직 권한테이블 형식으로 변경 ======
	gfn_initDs(ds_rcond, true);
	ds_rcond.SetColumn(0, "ZPROGRAM", "CS0108002A");
	ds_rcond.SetColumn(0, "GBN", "01");	
	retrans_visible = gfn_getAuth(ds_rcond);
	ds_rcond.ClearData();
	
	if ( retrans_visible == true) {	
		btn_retrans.Visible = true;
	}
	
	// 서비스자재팀 자재출하이력 관리를 위한 비고 저장 버튼 활성화 처리. 2021.04.02 Han JH
	gfn_initDs(ds_rcond, true);
	ds_rcond.SetColumn(0, "ZPROGRAM", "CS0108002A");
	ds_rcond.SetColumn(0, "GBN", "02");	
	bgsave_visible = gfn_getAuth(ds_rcond);
	ds_rcond.ClearData();
	
	if ( bgsave_visible == true) {	
		btn_save_bigo.Visible = true;
		//grd_sum.SetColProp(45, "edit", "normal");
		grd_sum.SetCellProp("body",45,"Edit","normal");
	}
	//=====================================================
	
}
/********************************************************************************
* 기      능   : form UnloadCompleted
********************************************************************************/
function fn_OnUnloadCompleted(obj) {
    return gfn_isFormUnload(obj);
}
//=========================================================================================
// [ PART 3 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,form닫기)
//=========================================================================================
/********************************************************************************
* 기      능   : 조회
********************************************************************************/
function fn_query() {
    // Message 영역 초기화
    global.FRM_BOTTOM.img_msgType.imageId = "";
    global.FRM_BOTTOM.st_msg.value = "";
    ds_cond.SetColumn(0, "REQNO", ed_reqno.value);
    ds_cond.SetColumn(0, "REQNR", ed_reqnr.value);

	if ( !gfn_checkFromToObj(cal_reqdate_fm, cal_reqdate_to, true, st_reqdate.value, 0, true) ) {
		return;
	}

	if ( !gfn_checkFromToObj(cal_trandate_fm, cal_trandate_to, true, st_tran.value) ) {
		return;
	}
    
    // ======================제약조건 추가  2020.12.28 ===============================
    var diffDays = gfn_getDayCnt(ds_days, cal_reqdate_fm.value, cal_reqdate_to.value);	//청구생성기간
    var qnum_len =  length(trim(ds_cond.GetColumn(0,"QTNUM")));  //견적번호 길이
    
    if( qnum_len < 6 && diffDays > 365 )
    {
		var arr = [st_reqdate.Value, "366일"];
		//gfn_showAlert("CW00133","견적번호 6자리 이상 미입력시는", "청구생성기간을 366일");
		gfn_showAlert("CW00133", arr); // 2020.01.07 문구 제대로 표출안되어 Array로 수정. Han J.H
		ed_qtnum.SetFocus();
		return;
    }    
    //================================================================================
    
    ufn_getGbn();
//    ds_cond.SetColumn(0, "GBN", ufn_getGbn()); //조회조건 구분값 가져오기
//    ds_cond.SetColumn(0, "POSID", ed_pjt.value);
/***********
    ds_cond.SetColumn(0, "CB1", div_code.cb_big.value);
    ds_cond.SetColumn(0, "CB2", div_code.cb_mid.value);
    ds_cond.SetColumn(0, "CB3", div_code.cb_small.value);
*******************/
    // sort mark 삭제
    gfn_clearGridSortMark(grd_sum);
    ds_list.row = -1;
    ds_list.ClearData();

    tit_clearActionInfo();
    tit_addSearchActionInfo("cs01:CS0108002A_S1");
    tit_callService(
          ""
        , ""
        , "ds_cond=ds_cond"
        , "ds_mm031=ds_mm031"
        , ""
        , "fn_afterQuery"
        , true);
}

/********************************************************************************
* 기      능   : 저장
********************************************************************************/
function fn_save() {

    ds_list_3.ClearData();
    ds_mm031_0.ClearData();

    // 저장할 데이터셋을 복사
    gfn_copyDs(ds_mm031, ds_mm031_0, "CHECK=1");
    gfn_copyDs(ds_list, ds_list_3, "CHECK=1");

    // 처리 데이터 확인
    if (ds_mm031_0.rowcount < 1) {
        gfn_showAlert("CW00013");
        return;
    }

    // 청구전송 대상 자료 check
    if (!gfn_showConfirm("CI00008")) {
        return;
    }

    for (var i = 0; i < ds_mm031_0.rowcount ; i++)
    {
        ds_mm031_0.SetColumn(i,"GBN","A");
    }
    tit_clearActionInfo();
    tit_addMultiActionInfo("cs01:CS0102001A_U10");
    tit_addMultiActionInfo("cs01:CS0102001A_U12");
    tit_addMultiActionInfo("cs01:CS0102001A_U13");

    tit_callService(
         ""
        , ""
        , "ds_mm031_0=ds_mm031_0:A ds_list_3=ds_list_3 ds_list_3=ds_list_3"
        , ""
        , ""
        , "fn_afterSave"
        , "");
}
/********************************************************************************
* 기      능   : 닫기
********************************************************************************/
function fn_close() {
    close();
}
/********************************************************************************
* 기      능   : 액셀
********************************************************************************/
function fn_excel() {
    gfn_saveToExcel(grd_sum, true, "", "", false, true);
}
/********************************************************************************
* 기      능   : print 40
********************************************************************************/
function fn_print() {

}
/********************************************************************************
* 기      능   : 반송 65
********************************************************************************/
function fn_sendback() {

}
//=========================================================================================
// [ PART 4]
// Callback 함수 정의 : callback 함수명은 메인 함수의 fn_xxxx() 에서 xxxx 부분은 fn_afterXXXX()
// 형태가 되도록 작성
//=========================================================================================
/********************************************************************************
* 기      능   : 조회 Callback
********************************************************************************/
function fn_afterQuery(errCode, errMsg) {
	trace(ds_mm031.SaveXML());
    // 디테일 정보 필터링
    if (ds_mm031.rowcount > 0)
    {
        gfn_copyDs(ds_mm031, ds_mm031_2,);
        ds_list.filter("REQNO == " + quote( ds_mm031.GetColumn(0,"REQNO")));
    }

    if (ds_list.rowcount > 0)
    {
        gfn_copyDs(ds_list, ds_list_4);
    }

// 메시지 처리
//    gfn_showSearchMsg(grd_list);
    gfn_showMsg("CI00002",ds_mm031.RowCount()+"");
}
/********************************************************************************
* 기      능   : 승인 Callback
********************************************************************************/
function fn_afterSave(errCode, errMsg){
    if ( errCode != 0 ) {
        gfn_showMsg("CE00001");
    } else {
        gfn_showMsg("CI00003");
        fn_query();
    }
}

/********************************************************************************
* 기      능   : 사양재전송 Callback
********************************************************************************/
function fn_afterReTrans(errCode, errMsg) {
    if(errCode != 0) {
        gfn_showMsg("CE00001");
    } else {
        gfn_showMsg("CI00003");
        fn_query();
    }
}
//=========================================================================================
// [ PART 5 ]
// Detail Process Event 정의 ( User Define function )
// 사용자 정의 함수는 ufn_xxxx() 형태로 작성
//=========================================================================================
/********************************************************************************
* 기      능   : BOM 클릭 시
********************************************************************************/
function btn_bom_OnClick(obj)
{
    if(ds_mm031.FindRow("CHECK", 1) == -1) {
        gfn_showAlert("처리할 자료를 먼저 선택해 주십시오.");
        return;
    }
    var cCount = ds_mm031.CaseCount("CHECK ='1'");
    if(cCount > 1 ){
        gfn_showAlert("처리할 자료를 한 건만 선택해 주십시오.");
        return;
    }
    var arg = "pGubun = 'U'";
    var rowIndex = 0;
    for(var i=0; i<ds_mm031.RowCount(); i++) {
        if(ds_mm031.GetColumn(i, "CHECK") == true) { //체크박스가 true 일 경우
            rowIndex = i;
            arg = arg + " reqno = "       + quote(ds_mm031.GetColumn(i, "REQNO"));
            arg = arg + " chk  = "        + quote(ds_mm031.GetColumn(i, "CHK"));
            arg = arg + " posid = "       + quote(ds_mm031.GetColumn(i, "POSID"));
            arg = arg + " reqkind = "     + quote(ds_mm031.GetColumn(i, "REQKIND"));
            arg = arg + " ps_pspid = "    + quote(ds_mm031.GetColumn(i, "PS_PSPID"));
            arg = arg + " jqprnum = "     + quote(ds_mm031.GetColumn(i, "JQPRNUM"));
            arg = arg + " posid2 = "      + quote(ds_mm031.GetColumn(i, "POSID2"));
            arg = arg + " bstdk = "       + quote(ds_mm031.GetColumn(i, "BSTDK"));
            arg = arg + " vdatu = "       + quote(ds_mm031.GetColumn(i, "VDATU"));
            arg = arg + " vkbur = "       + quote(ds_mm031.GetColumn(i, "VKBUR"));
            arg = arg + " vkgrp = "       + quote(ds_mm031.GetColumn(i, "VKGRP"));
            arg = arg + " vbeln = "       + quote(ds_mm031.GetColumn(i, "VBELN"));
            arg = arg + " bstkd = "       + quote(ds_mm031.GetColumn(i, "BSTKD"));
            arg = arg + " kunnr = "       + quote(ds_mm031.GetColumn(i, "KUNNR"));
            arg = arg + " contr_da = "    + quote(ds_mm031.GetColumn(i, "CONTR_DA"));
            arg = arg + " matnr = "       + quote(ds_mm031.GetColumn(i, "MATNR"));
            arg = arg + " zman_nm = "     + quote(ds_mm031.GetColumn(i, "ZMAN_NM"));
            arg = arg + " zman_nm2 = "    + quote(ds_mm031.GetColumn(i, "ZMAN_NM2"));
            arg = arg + " pdm803 = "      + quote(ds_mm031.GetColumn(i, "PDM803"));
            arg = arg + " doc5 = "        + quote(ds_mm031.GetColumn(i, "DOC5"));
            arg = arg + " apstat5 = "     + quote(ds_mm031.GetColumn(i, "APSTAT5"));
            arg = arg + " qtnum = "       + quote(ds_mm031.GetColumn(i, "QTNUM"));
        }
    }

    var posid2 = ds_mm031.GetColumn(rowIndex, "POSID2");
    // 프로젝트번호에 NC(시스템공사) 인 경우 사양등록 팝업
    if( length(posid2) == 0 ) {
        gfn_openMsgWin("해당 프로젝트는 BOM 등록이 불가합니다.", "", "A", "BOM");
        return;
    }

    // 프로젝트번호에 NC(시스템공사) 인 경우 사양등록 팝업
    if( IndexOf(ds_mm031.GetColumn(ds_mm031.row, "POSID2"), "NC") > -1 && ds_mm031.GetColumn(ds_mm031.row, "MATNR") != 'S-1000' 
	&& ds_mm031.GetColumn(ds_mm031.row, "MATNR") != 'W-1000') {
        gfn_openPopup("CS0108002C", true, arg);
    } else {
        // 시스템 공사가 아닌 경우 사양등록
        gfn_openPopup("CS0108002B", true, arg);
    }
}

/********************************************************************************
* 기      능   : 사양재전송
********************************************************************************/
function btn_retrans_OnClick(obj) {

    if(ds_mm031.FindRow("CHECK", 1) == -1) {
        gfn_showAlert("처리할 자료를 먼저 선택해 주십시오.");
        return;
     } 
   
    ds_retrans2.ClearData();
    for(var i=0; i<ds_mm031.RowCount(); i++) {                            //PDM 전송된 내역 있을 경우만 재전송 가능
        if(ds_mm031.GetColumn(i, "CHECK") == true) {
			var rowIndex = ds_retrans.AddRow();
            if(ds_mm031.GetColumn(i, "STATUS") <> 'X'){                    //PDM에서 데이터 읽어간 경우
                gfn_showAlert("PDM 미전송 데이터입니다.");
                return;
            }
            ds_retrans.SetColumn(rowIndex, "PS_PSPID", ds_mm031.GetColumn(i, "PS_PSPID"));
        }
    }
    //저장할 데이터셋을 복사
   // gfn_copyDs(ds_mm031, ds_retrans, "CHECK=1");

    tit_clearActionInfo();
    tit_addMultiActionInfo("cs01:CS0108002A_I1");
    tit_callService(
        ""
        , ""
        , "ds_retrans=ds_retrans"
        , ""
        , ""
        , "fn_afterReTrans"
        , true);
}
/********************************************************************************
* 기      능   : 문서번호 조회
********************************************************************************/
function ufn_getReqNo(obj)
{
    var reqcond = null;
    reqcond = gfn_openPopup("MM0901003A", true);

    if (reqcond !=null) {
        ed_reqno.value = reqcond[0];
//        fn_query();
    }
}
/********************************************************************************
* 기      능   : 보수 콤보 설정
********************************************************************************/
function ufn_getGbn() {
    var user_grp = gfn_getUserGroup();

    if(user_grp == "10") { // 보수협력사일 경우
        ds_cond.SetColumn(0, "BSU", G_LGORT);
        ds_cond.SetColumn(0, "TEM", '');
        ds_cond.SetColumn(0, "BPM", '');
        ds_cond.SetColumn(0, "ARA", '');
    } else if(user_grp == "20") { // 보수PM일 경우
        ds_cond.SetColumn(0, "BSU", trim(div_code.cb_small.value));
        ds_cond.SetColumn(0, "TEM", '');
        ds_cond.SetColumn(0, "BPM", G_USER_ID);
        ds_cond.SetColumn(0, "ARA", '');
    } else if(user_grp == "30") { // 지방사무소일 경우
        ds_cond.SetColumn(0, "BSU", trim(div_code.cb_small.value));
        ds_cond.SetColumn(0, "TEM", G_SAP_USER_VGCD);
        ds_cond.SetColumn(0, "BPM", '');
        ds_cond.SetColumn(0, "ARA", '');
    } else if(user_grp == "40") { // 고객지원부일 경우
        ds_cond.SetColumn(0, "BSU", trim(div_code.cb_small.value));
        if(div_code.cb_big.value == '1') { // 협력사 콤보1이 지역일 경우
            ds_cond.SetColumn(0, "DPT", '');
            ds_cond.SetColumn(0, "TEM", '');
            ds_cond.SetColumn(0, "BPM", '');
            ds_cond.SetColumn(0, "ARA", trim(div_code.cb_mid.value));
        } else if(div_code.cb_big.value == '2') { // 협력사 콤보1이 PM일 경우
            ds_cond.SetColumn(0, "DPT", '');
            ds_cond.SetColumn(0, "TEM", '');
            ds_cond.SetColumn(0, "BPM", trim(div_code.cb_mid.value));
            ds_cond.SetColumn(0, "ARA", '');
        } else if(div_code.cb_big.value == '4') { // 협력사 콤보1이 부서일 경우
            ds_cond.SetColumn(0, "DPT", trim(div_code.cb_mid.value));
            ds_cond.SetColumn(0, "TEM", trim(div_code.cb_small.value));
            ds_cond.SetColumn(0, "BSU", '');
            ds_cond.SetColumn(0, "BPM", '');
            ds_cond.SetColumn(0, "ARA", '');
        } else { // 협력사 콤보1이 팀일 경우
            ds_cond.SetColumn(0, "DPT", '');
            ds_cond.SetColumn(0, "TEM", trim(div_code.cb_mid.value));
            ds_cond.SetColumn(0, "BPM", '');
            ds_cond.SetColumn(0, "ARA", '');
        }
    }
}

//=========================================================================================
// [ PART 6 ]
// component Event 정의 : 각 Component 별 이벤트
//=========================================================================================
/********************************************************************************
* 기      능   : 그리드 헤더 클릭시 정렬 처리
********************************************************************************/
function grd_list_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
{
    if ( nCell == 0 ) {
        // 그리드 표시할 컬럼 선택
        gfn_selectGridCol(obj);
    } else {
        // 그리드 정렬 처리
        gfn_sortGrid(obj,nCell);
    }
}

function grd_sum_OnCellPosChanged(obj,nRow,nCell,nOldRow,nOldCell,nPivotIndex,nOldPivotIndex)
{
    ds_list.filter("REQNO == " + quote( ds_mm031.GetColumn(nRow,"REQNO")));
}

function ufn_callKyunJeok(obj)
{
    // Message 영역 초기화
    global.FRM_BOTTOM.img_msgType.imageId = "";
    global.FRM_BOTTOM.st_msg.value = "";

    var chksize = 0;
    var isMMPR = false;
    var nRow = 0;
    for (var i = 0; i < ds_mm031.rowcount ; i++){
        if (ds_mm031.GetColumn(i,"CHECK") == "1"){
            nRow = i;
            chksize++;
        }
    }
    if (chksize != 1){
        gfn_showAlert("CW00054");
        return;
    }
    var arg = "fa_reqno=" + quote(ds_mm031.GetColumn(nRow,"REQNO")) + " fa_qtnum =" + quote(ds_mm031.GetColumn(nRow,"QTNUM"));
}

/********************************************************************************
* 기      능   : 원프로젝트 팝업
********************************************************************************/
function btn_pjt_OnClick(obj)
{
    var arg = "pjt="+quote(ed_pspid.value);
    var pjt= null;
    pjt = gfn_openPopup("CS9601002A",true,arg);

    if (pjt != null && obj == btn_pspid) {
        ed_pspid.value = pjt[0];
    }
}

/********************************************************************************
* 기      능   : 그리드에서 날짜 입력시
********************************************************************************/
function grd_list_OnExpandEdit(obj,nRow,nCell,strVal,nPivotIndex)
{
    var rect = obj.GetCellRect(nRow, ncell);
    cal_temp.top = rect[1] +60 ;
    cal_temp.Left = rect[0] + 100;
    cal_temp.Visible = true;

    cal_temp.value = ds_mm031.getColumn(nRow, "BILDAT2");
    cal_temp.SetFocus();
}

/********************************************************************************
* 기      능   : 달력에서 일자 선택했을 경우
********************************************************************************/
function cal_temp_OnDayClick(obj,strText)
{
    gfn_clearMsgBar();

    ds_mm031.setColumn(ds_mm031.row, "BILDAT2", strText);

    obj.Visible = false;
}

/********************************************************************************
* 기      능   : 달력에서 포커스 잃었을 경우
********************************************************************************/
function cal_temp_OnKillFocus(obj)
{
    obj.Visible = false;
}

/********************************************************************************
* 기      능   : CELL DBCLICK
********************************************************************************/
function grd_sum_OnCellDBLClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
    var dsObj = object(obj.BindDataset);
    var user_grp = gfn_getUserGroup();

    var arg = " fa_pjt=" + quote(dsObj.GetColumn(nRow,"PS_PSPID"));
    arg += " fa_qtnum=" + quote(dsObj.GetColumn(nRow,"QTNUM"));
    arg += " fa_lgort1=" + quote(dsObj.GetColumn(nRow,"LGORT1"));
    arg += " fa_reqnr=" + quote(dsObj.GetColumn(nRow,"REQNR"));
    arg += " fa_reqno=" + quote(dsObj.GetColumn(nRow,"REQNO"));
    arg += " fa_vkgrp=" + quote(dsObj.GetColumn(nRow,"VKGRP"));
    arg += " fa_upn=" + quote(ds_mm031.GetColumn(nRow,"UPN"));
    arg += " fa_jqprnum=" + quote(ds_mm031.GetColumn(nRow,"JQPRNUM"));
    arg += " fa_amt="    + quote(ds_mm031.GetColumn(nRow,"M_AMT"));
    arg += " ar_qtnum=" + quote(dsObj.GetColumn(nRow,"QTNUM"));
    arg += " ar_seq="    + quote(ds_mm031.GetColumn(nRow,"SEQ"));
    arg += " ar_upn=" + quote(substr(ds_mm031.GetColumn(nRow,"UPN"),0,6));
    arg += " ar_cst="    + quote(ds_mm031.GetColumn(nRow,"CST"));
    arg += " fa_bom="    + 'Y';

    if(nCell == 33)        //PDM 사양전송자 HP
    {
        alert("HP : " + quote(ds_mm031.GetColumn(nRow,"ERPHONE")));
        return;
    }
    // 견적작성 조회 및 출력
    if( user_grp >= '10' && ( dsObj.GetColumn(nRow,"REQKIND") == "1" || dsObj.GetColumn(nRow,"REQKIND") == "7" || dsObj.GetColumn(nRow,"REQKIND") == "S" )     )
    {
        ufn_ViewKyunOpen(arg);
    }
}

/********************************************************************************
* 기      능   : 부품판매/수리공사/시스템공사 더블클릭시 견적상세화면
********************************************************************************/
function ufn_ViewKyunOpen(arg)
{
    // Message 영역 초기화
    global.FRM_BOTTOM.img_msgType.imageId = "";
    global.FRM_BOTTOM.st_msg.value = "";
    gfn_openPopup("CS0101008B", true, arg);

}

/********************************************************************************
* 기      능   : 서비스 BOM 사양복사
*                선택된 프로젝트 번호별 사용복사 팝업을 호출한다. - 박수근
********************************************************************************/
function btn_speccopy_OnClick(obj)
{
    // 사양복사를 위해 선택한 프로젝트에 대한 사양전송, 사양재전송여부에 대해 체크하여 사용자에게 알림 메세지를 보여준다.
    var message = "";
    var arg = "";
    
    if(ds_mm031.FindRow("CHECK", 1) == -1) {
        gfn_openMsgWin("복사할 Proj.번호를 선택해 주십시요", "", "A", "사양복사");
        return;
    }
    
    for(var i=0; i < ds_mm031.GetRowCount(); i++) {
        if( ds_mm031.GetColumn(i, "CHECK") == 1 ) {
            if( ds_mm031.GetColumn(i, "PDM_CHK") == "Y" && ds_mm031.GetColumn(i, "PDM803") == "N" ) {
                message = message + "\nProj.번호("+ds_mm031.GetColumn(i, "POSID2")+")";
            }
        }
    }

    if( message != "" ) {
        gfn_openMsgWin("사양 전송된 Proj.번호는 사양을 복사 할 수 없습니다."+message, "", "A", "사양복사");
    } else {
        gfn_openPopup("CS0108002E", true, arg);
    }
}
/********************************************************************************
* 기      능   : 실측 및 LAYOUT
********************************************************************************/
function btn_processDate_OnClick(obj)
{
    if(ds_mm031.FindRow("CHECK", 1) == -1) {
        gfn_showAlert("처리할 자료를 먼저 선택해 주십시오.");
        return;
    }
    var cCount = ds_mm031.CaseCount("CHECK ='1'");

    if(cCount > 1 ){
        gfn_showAlert("처리할 자료를 한 건만 선택해 주십시오.");
        return;
    }
    var rowid = ds_mm031.FindRow("CHECK", 1) ;
    var arg = "fa_qtnum="  + quote(ds_mm031.GetColumn(rowid,"QTNUM"))
            + " fa_posid=" + quote(ds_mm031.GetColumn(rowid,"POSID2"))
            + " fa_bstnk=" + quote(ds_mm031.GetColumn(rowid,"SPT"));
	gfn_openPopup("CS0108002G", true, arg);
}
/********************************************************************************
* 기      능   : MOD 공정관리
********************************************************************************/
function btn_process_OnClick(obj)
{
	 
	if(ds_mm031.FindRow("CHECK", 1) == -1) {
        gfn_showAlert("처리할 자료를 먼저 선택해 주십시오.");
        return;
    }
    var cCount = ds_mm031.CaseCount("CHECK ='1'");

    if(cCount > 1 ){
        gfn_showAlert("처리할 자료를 한 건만 선택해 주십시오.");
        return;
    }
    for(var i=0; i<ds_mm031.RowCount(); i++) {          
		if(ds_mm031.GetColumn(i, "CHECK") == true) {
			if(ds_mm031.GetColumn(i, "STATUS") <> 'X'){         //ZSDT0005
				gfn_showAlert("PDM 전송 후 진행 해주십시오.");
				return;
			}
		}
	}
	var rowid = ds_mm031.FindRow("CHECK", 1) ;
	var arg = "fa_wbs="  + quote(ds_mm031.GetColumn(rowid,"POSID2"))
            + " fa_erdat2=" + quote(ds_mm031.GetColumn(rowid,"ERDAT2"))   	//최초
            + " fa_erdat4=" + quote(ds_mm031.GetColumn(rowid,"ERDAT4"));  	//최종
	gfn_openPopup("CS0108002H", true, arg);
}
/********************************************************************************
* 기      능   : 서비스자재팀 출하이력 관리를 위한 이력 저장을 위한 저장기능 개발. 2021.04.02 Han JH
********************************************************************************/
function btn_savebigo_OnClick(obj)
{
	ds_mm031_bigo.ClearData();
	
    // 저장할 데이터셋을 복사
	gfn_copyDs(ds_mm031, ds_mm031_bigo, "CHECK=1");
    	
	// 처리 데이터 확인
	if (ds_mm031_bigo.rowcount < 1) {
		gfn_showAlert("CW00013");
		return;
	}
	
	// Confirm
	if (!gfn_showConfirm("CI00008")) {
		return;
	}
	
	for (var i = 0; i < ds_mm031_bigo.rowcount ; i++)
	{
		if(Length(Trim(ds_mm031_bigo.GetColumn(i,"MATRMK"))) == 0) {
			gfn_showAlert("CW00001","비고");
			return false;
		}	
	
		// 유효성 체크. 2020.04.06 Han JH
		if(Lengthb(Trim(ds_mm031_bigo.GetColumn(i,"MATRMK"))) > 150) {
			gfn_showAlert("비고의 입력내용이 너무 깁니다.\n한글기준 50글자 이하로 입력하십시요.");
			return false;
		}
		
		// QTNUM, SEQ 없을 시 비즈니스 로직 타지 않도록 예외처리
		if(length(ds_mm031_bigo.GetColumn(i, "QTNUM")) < 1 || length(ds_mm031_bigo.GetColumn(0, "SEQ")) < 1) {
			return;
		}		
		
		// 개행문자 제거
		replace(replace(replace(ds_mm031_bigo.GetColumn(i,"MATRMK"),chr(13)+chr(10),''),chr(13),''),chr(10),'');
	}
		
	tit_clearActionInfo();
	tit_addMultiActionInfo("cs01:CS0108002A_U1");
	
	trace(ds_mm031_bigo.SaveXML());
	
	//return;
    
	tit_callService(
		 ""
		, ""
		, "ds_mm031_bigo=ds_mm031_bigo"
		, ""
		, ""
		, "fn_afterBigoSave"
        , true
        , false
        , true);
}

/********************************************************************************
* 기      능   : 저장 Callback
********************************************************************************/
function fn_afterBigoSave(errCode, errMsg){
	if ( errCode != 0 ) {
		gfn_showMsg("CE00001");
	} else {
		gfn_showMsg("CI00003");
		fn_query();
	}
}
]]></Script>
</Window>