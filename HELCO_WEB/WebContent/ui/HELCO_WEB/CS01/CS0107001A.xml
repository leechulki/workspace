<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="562" Id="CS0107001A" Left="8" OnLoadCompleted="fn_OnLoadCompleted" OnUnloadCompleted="fn_OnUnloadCompleted" PidAttrib="7" scroll="false" Title="소모자재청구작업" Top="8" Ver="1.0" Width="978" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_bussi_cd">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_reqkind_cd">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond">
				<Contents>
					<colinfo id="BUSSI" size="3" type="STRING"/>
					<colinfo id="REQDATE" size="24" type="STRING"/>
					<colinfo id="REQKIND" size="3" type="STRING"/>
					<colinfo id="REQNO" size="30" type="STRING"/>
					<colinfo id="LIFNR" size="256" type="STRING"/>
					<record>
						<BUSSI></BUSSI>
						<LIFNR></LIFNR>
						<REQDATE></REQDATE>
						<REQKIND></REQKIND>
						<REQNO></REQNO>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_bwtar_cd">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ma_cond">
				<Contents>
					<colinfo id="BUSSI" size="255" summ="default" type="STRING"/>
					<colinfo id="LGORT" size="255" summ="default" type="STRING"/>
					<colinfo id="MATNR" size="255" summ="default" type="STRING"/>
					<colinfo id="MTART" size="255" summ="default" type="STRING"/>
					<colinfo id="INPUTROW" size="5" summ="default" type="INT"/>
					<colinfo id="BWTAR" size="4" summ="default" type="STRING"/>
					<record>
						<BUSSI></BUSSI>
						<BWTAR></BWTAR>
						<INPUTROW/>
						<LGORT></LGORT>
						<MATNR></MATNR>
						<MTART></MTART>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ma_list">
				<Contents>
					<colinfo id="BANNAB" size="1" summ="default" type="STRING"/>
					<colinfo id="BISMT" size="54" summ="default" type="STRING"/>
					<colinfo id="BLOCK_NO" size="60" summ="default" type="STRING"/>
					<colinfo id="BRGEW" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="DZEINR" size="120" summ="default" type="STRING"/>
					<colinfo id="EXEDT" size="24" summ="default" type="STRING"/>
					<colinfo id="EXEID" size="36" summ="default" type="STRING"/>
					<colinfo id="EXETM" size="18" summ="default" type="STRING"/>
					<colinfo id="EXTWG" size="54" summ="default" type="STRING"/>
					<colinfo id="GEWEI" size="9" summ="default" type="STRING"/>
					<colinfo id="MAKTX" size="120" summ="default" type="STRING"/>
					<colinfo id="MANDT" size="9" summ="default" type="STRING"/>
					<colinfo id="MATKL" size="27" summ="default" type="STRING"/>
					<colinfo id="MATNR" size="54" summ="default" type="STRING"/>
					<colinfo id="MATNR_NM" size="120" summ="default" type="STRING"/>
					<colinfo id="MEINS" size="9" summ="default" type="STRING"/>
					<colinfo id="MTART" size="12" summ="default" type="STRING"/>
					<colinfo id="NTGEW" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="PARLAB1" size="33" summ="default" type="DECIMAL"/>
					<colinfo id="SAMT1" size="11" summ="default" type="DECIMAL"/>
					<colinfo id="SAMT2" size="11" summ="default" type="DECIMAL"/>
					<colinfo id="SPEC" size="180" summ="default" type="STRING"/>
					<colinfo id="VOLEH" size="9" summ="default" type="STRING"/>
					<colinfo id="VOLUM" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="WRKST" size="144" summ="default" type="STRING"/>
					<colinfo id="ZSIZE" size="180" summ="default" type="STRING"/>
					<colinfo id="LVORM" size="1" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_qmtext">
				<Contents>
					<COLINFO ID="TDID" SIZE="4" TYPE="STRING"/>
					<COLINFO ID="TDNAME" SIZE="70" TYPE="STRING"/>
					<COLINFO ID="TDOBJECT" SIZE="10" TYPE="STRING"/>
					<colinfo id="O_TEXT" size="1000" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_error">
				<Contents>
					<colinfo id="IDX" size="256" type="STRING"/>
					<colinfo id="ERRMSG" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_creEmpl">
				<Contents>
					<colinfo id="CCSB1EMP" size="21" type="STRING"/>
					<colinfo id="CCSB1EPN" size="30" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_qmtext1">
				<Contents>
					<colinfo id="TEXT" size="1000" type="STRING"/>
					<colinfo id="FLAG" size="1" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_mkey">
				<Contents>
					<colinfo id="JQPRNUM" size="31" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_bannab">
				<Contents>
					<colinfo id="CODE" size="1" type="STRING"/>
					<colinfo id="CODE_NAME" size="1" type="STRING"/>
					<record>
						<CODE>0</CODE>
						<CODE_NAME>비대상</CODE_NAME>
					</record>
					<record>
						<CODE>1</CODE>
						<CODE_NAME>대상</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cause">
				<Contents>
					<colinfo id="CODE" size="12" type="STRING"/>
					<colinfo id="CODEGRUPPE" size="24" type="STRING"/>
					<colinfo id="KURZTEXT" size="120" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_pheno">
				<Contents>
					<colinfo id="CODE" size="12" type="STRING"/>
					<colinfo id="CODEGRUPPE" size="24" type="STRING"/>
					<colinfo id="KURZTEXT" size="120" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_key">
				<Contents>
					<colinfo id="REQNO" size="31" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_pscond">
				<Contents>
					<colinfo id="POSID" size="72" type="STRING"/>
					<record>
						<POSID></POSID>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_pspid_cd">
				<Contents>
					<colinfo id="POSID" size="72" type="STRING"/>
					<colinfo id="POSID_1" size="72" type="STRING"/>
					<colinfo id="ZBOSUIN" size="24" type="STRING"/>
					<colinfo id="ZOIPSU" size="24" type="STRING"/>
					<colinfo id="ZQEGEMSA" size="24" type="STRING"/>
					<colinfo id="ZSITE_NM" size="105" type="STRING"/>
					<colinfo id="ZSPEC1" size="15" type="STRING"/>
					<colinfo id="ZSPEC2" size="75" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list" OnColumnChanged="ds_list_OnColumnChanged" OnRowPosChanged="ds_list_OnRowPosChanged">
				<Contents>
					<colinfo id="ASSNO" size="33" summ="default" type="STRING"/>
					<colinfo id="ATYPE" size="12" summ="default" type="STRING"/>
					<colinfo id="BANNAB" size="1" summ="default" type="STRING"/>
					<colinfo id="BUSSI" size="3" summ="default" type="STRING"/>
					<colinfo id="BWTAR" size="30" summ="default" type="STRING"/>
					<colinfo id="CAUSECAT" size="3" summ="default" type="STRING"/>
					<colinfo id="CAUSECOD" size="12" summ="default" type="STRING"/>
					<colinfo id="CAUSEGRP" size="24" summ="default" type="STRING"/>
					<colinfo id="CAUSETXT" size="120" summ="default" type="STRING"/>
					<colinfo id="CELLP" size="48" summ="default" type="STRING"/>
					<colinfo id="CHAR1" size="300" summ="default" type="STRING"/>
					<colinfo id="CREDT" size="24" summ="default" type="STRING"/>
					<colinfo id="CREID" size="36" summ="default" type="STRING"/>
					<colinfo id="CRENM" size="60" summ="default" type="STRING"/>
					<colinfo id="CROPE" size="3" summ="default" type="STRING"/>
					<colinfo id="DMBTR" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="FLAG" size="0" summ="default" type="STRING"/>
					<colinfo id="HOGI" size="72" summ="default" type="STRING"/>
					<colinfo id="INSMSNO" size="60" summ="default" type="STRING"/>
					<colinfo id="MBINSMSNO" size="60" summ="default" type="STRING"/>
					<colinfo id="JQPRNUM" size="30" summ="default" type="STRING"/>
					<colinfo id="LGORT" size="12" summ="default" type="STRING"/>
					<colinfo id="MAKTX" size="120" summ="default" type="STRING"/>
					<colinfo id="MANDT" size="9" summ="default" type="STRING"/>
					<colinfo id="MATNR" size="54" summ="default" type="STRING"/>
					<colinfo id="MEINS" size="9" summ="default" type="STRING"/>
					<colinfo id="MENGE" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="MTART" size="12" summ="default" type="STRING"/>
					<colinfo id="NAMET" size="60" summ="default" type="STRING"/>
					<colinfo id="NETPR" size="13" summ="default" type="DECIMAL"/>
					<colinfo id="PARLAB" size="33" summ="default" type="DECIMAL"/>
					<colinfo id="PARLAB1" size="33" summ="default" type="DECIMAL"/>
					<colinfo id="PHENOCAT" size="12" summ="default" type="STRING"/>
					<colinfo id="PHENOCOD" size="12" summ="default" type="STRING"/>
					<colinfo id="PHENOGRP" size="24" summ="default" type="STRING"/>
					<colinfo id="PHENOTXT" size="120" summ="default" type="STRING"/>
					<colinfo id="POSID" size="72" summ="default" type="STRING"/>
					<colinfo id="POSID2" size="72" summ="default" type="STRING"/>
					<colinfo id="POST1" size="120" summ="default" type="STRING"/>
					<colinfo id="PSPID" size="72" summ="default" type="STRING"/>
					<colinfo id="QTNUM" size="45" summ="default" type="STRING"/>
					<colinfo id="RDATE" size="24" summ="default" type="STRING"/>
					<colinfo id="RECE_F" size="3" summ="default" type="STRING"/>
					<colinfo id="REJTXT" size="120" summ="default" type="STRING"/>
					<colinfo id="REQDATE" size="24" summ="default" type="STRING"/>
					<colinfo id="REQITEM" size="15" summ="default" type="STRING"/>
					<colinfo id="REQKIND" size="3" summ="default" type="STRING"/>
					<colinfo id="REQKIND2" size="3" summ="default" type="STRING"/>
					<colinfo id="REQNO" size="30" summ="default" type="STRING"/>
					<colinfo id="REQNR" size="30" summ="default" type="STRING"/>
					<colinfo id="REQSN" size="15" summ="default" type="STRING"/>
					<colinfo id="RETMSNO" size="60" summ="default" type="STRING"/>
					<colinfo id="MBRETMSNO" size="60" summ="default" type="STRING"/>
					<colinfo id="SEQNO" size="18" summ="default" type="STRING"/>
					<colinfo id="SERNO" size="6" summ="default" type="STRING"/>
					<colinfo id="SPEC" size="90" summ="default" type="STRING"/>
					<colinfo id="TEMNO" size="18" summ="default" type="STRING"/>
					<colinfo id="WAERS" size="15" summ="default" type="STRING"/>
					<colinfo id="WORKDT" size="24" summ="default" type="STRING"/>
					<colinfo id="ZBEPJEO" size="24" summ="default" type="STRING"/>
					<colinfo id="ZBOSUIN" size="24" summ="default" type="STRING"/>
					<colinfo id="ZOIPSU" size="24" summ="default" type="STRING"/>
					<colinfo id="SAMT1" size="13" summ="default" type="DECIMAL"/>
					<colinfo id="CHECK" size="2" summ="default" type="STRING"/>
					<colinfo id="STATUS" size="2" summ="default" type="STRING"/>
					<colinfo id="ZCAUSETXT" size="256" summ="default" type="STRING"/>
					<colinfo id="ZCAUSETXT2" size="256" summ="default" type="STRING"/>
					<colinfo id="ACPT_NUM" size="60" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list_0" OnColumnChanged="ds_list_OnColumnChanged" OnRowPosChanged="ds_list_OnRowPosChanged">
				<Contents>
					<colinfo id="ASSNO" size="33" summ="default" type="STRING"/>
					<colinfo id="ATYPE" size="12" summ="default" type="STRING"/>
					<colinfo id="BANNAB" size="1" summ="default" type="STRING"/>
					<colinfo id="BUSSI" size="3" summ="default" type="STRING"/>
					<colinfo id="BWTAR" size="30" summ="default" type="STRING"/>
					<colinfo id="CAUSECAT" size="3" summ="default" type="STRING"/>
					<colinfo id="CAUSECOD" size="12" summ="default" type="STRING"/>
					<colinfo id="CAUSEGRP" size="24" summ="default" type="STRING"/>
					<colinfo id="CAUSETXT" size="120" summ="default" type="STRING"/>
					<colinfo id="CELLP" size="48" summ="default" type="STRING"/>
					<colinfo id="CHAR1" size="300" summ="default" type="STRING"/>
					<colinfo id="CREDT" size="24" summ="default" type="STRING"/>
					<colinfo id="CREID" size="36" summ="default" type="STRING"/>
					<colinfo id="CRENM" size="60" summ="default" type="STRING"/>
					<colinfo id="CROPE" size="3" summ="default" type="STRING"/>
					<colinfo id="DMBTR" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="FLAG" size="0" summ="default" type="STRING"/>
					<colinfo id="HOGI" size="72" summ="default" type="STRING"/>
					<colinfo id="INSMSNO" size="60" summ="default" type="STRING"/>
					<colinfo id="MBINSMSNO" size="60" summ="default" type="STRING"/>
					<colinfo id="JQPRNUM" size="30" summ="default" type="STRING"/>
					<colinfo id="LGORT" size="12" summ="default" type="STRING"/>
					<colinfo id="MAKTX" size="120" summ="default" type="STRING"/>
					<colinfo id="MANDT" size="9" summ="default" type="STRING"/>
					<colinfo id="MATNR" size="54" summ="default" type="STRING"/>
					<colinfo id="MEINS" size="9" summ="default" type="STRING"/>
					<colinfo id="MENGE" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="MTART" size="12" summ="default" type="STRING"/>
					<colinfo id="NAMET" size="60" summ="default" type="STRING"/>
					<colinfo id="NETPR" size="13" summ="default" type="DECIMAL"/>
					<colinfo id="PARLAB" size="33" summ="default" type="DECIMAL"/>
					<colinfo id="PARLAB1" size="33" summ="default" type="DECIMAL"/>
					<colinfo id="PHENOCAT" size="12" summ="default" type="STRING"/>
					<colinfo id="PHENOCOD" size="12" summ="default" type="STRING"/>
					<colinfo id="PHENOGRP" size="24" summ="default" type="STRING"/>
					<colinfo id="PHENOTXT" size="120" summ="default" type="STRING"/>
					<colinfo id="POSID" size="72" summ="default" type="STRING"/>
					<colinfo id="POSID2" size="72" summ="default" type="STRING"/>
					<colinfo id="POST1" size="120" summ="default" type="STRING"/>
					<colinfo id="PSPID" size="72" summ="default" type="STRING"/>
					<colinfo id="QTNUM" size="45" summ="default" type="STRING"/>
					<colinfo id="RDATE" size="24" summ="default" type="STRING"/>
					<colinfo id="RECE_F" size="3" summ="default" type="STRING"/>
					<colinfo id="REJTXT" size="120" summ="default" type="STRING"/>
					<colinfo id="REQDATE" size="24" summ="default" type="STRING"/>
					<colinfo id="REQITEM" size="15" summ="default" type="STRING"/>
					<colinfo id="REQKIND" size="3" summ="default" type="STRING"/>
					<colinfo id="REQKIND2" size="3" summ="default" type="STRING"/>
					<colinfo id="REQNO" size="30" summ="default" type="STRING"/>
					<colinfo id="REQNR" size="30" summ="default" type="STRING"/>
					<colinfo id="REQSN" size="15" summ="default" type="STRING"/>
					<colinfo id="RETMSNO" size="60" summ="default" type="STRING"/>
					<colinfo id="MBRETMSNO" size="60" summ="default" type="STRING"/>
					<colinfo id="SEQNO" size="18" summ="default" type="STRING"/>
					<colinfo id="SERNO" size="6" summ="default" type="STRING"/>
					<colinfo id="SPEC" size="90" summ="default" type="STRING"/>
					<colinfo id="TEMNO" size="18" summ="default" type="STRING"/>
					<colinfo id="WAERS" size="15" summ="default" type="STRING"/>
					<colinfo id="WORKDT" size="24" summ="default" type="STRING"/>
					<colinfo id="ZBEPJEO" size="24" summ="default" type="STRING"/>
					<colinfo id="ZBOSUIN" size="24" summ="default" type="STRING"/>
					<colinfo id="ZOIPSU" size="24" summ="default" type="STRING"/>
					<colinfo id="SAMT1" size="13" summ="default" type="DECIMAL"/>
					<colinfo id="CHECK" size="2" summ="default" type="STRING"/>
					<colinfo id="STATUS" size="2" summ="default" type="STRING"/>
					<colinfo id="ZCAUSETXT" size="256" summ="default" type="STRING"/>
					<colinfo id="ZCAUSETXT2" size="256" summ="default" type="STRING"/>
					<colinfo id="ACPT_NUM" size="60" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_mtart_cd">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_fm_cond">
				<Contents>
					<colinfo id="POSID" size="255" type="STRING"/>
					<colinfo id="CUDAT" size="255" type="STRING"/>
					<record>
						<CUDAT></CUDAT>
						<POSID></POSID>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_fm_list">
				<Contents>
					<colinfo id="KND" size="180" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_reqkind_grd_cd">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
		</Datasets>
		<Shape BKColor="user12" Bottom="88" Height="26" Id="Shape4" Left="10" LineColor="user13" Right="968" TabOrder="35" Top="62" Type="Rectangle" Width="958"></Shape>
		<Shape BKColor="user0" Bottom="30" Height="30" Id="Shape0" Left="0" LineColor="user1" Right="978" TabOrder="1" Top="0" Type="Rectangle" Width="978"></Shape>
		<Static Align="Right" Height="20" Id="st_lifnrName" Left="5" Style="sty_lb_search" TabOrder="2" Text="업체명&#32;" Top="5" VAlign="Middle" Width="80"></Static>
		<Static Align="Right" Height="20" Id="st_bussi" Left="199" Style="sty_lb_search" TabOrder="4" Text="사업부&#32;" Top="5" VAlign="Middle" Width="80"></Static>
		<Edit BindDataset="ds_cond" Border="Flat" Enable="FALSE" Height="20" Id="ed_lifnrName" Left="87" Style="sty_ipt_search_ind_chk" TabOrder="3" Top="5" Width="110"></Edit>
		<Static Align="Right" Height="20" Id="st_reqkind" Left="393" Style="sty_lb_search" TabOrder="5" Text="청구종류&#32;" Top="5" VAlign="Middle" Width="80"></Static>
		<Static Align="Right" Height="20" Id="st_reqdate" Left="587" Style="sty_lb_search" TabOrder="6" Text="청구생성일" Top="5" VAlign="Middle" Width="80"></Static>
		<Static Align="Right" Height="20" Id="st_reqno" Left="781" Style="sty_lb_search" TabOrder="7" Text="청구번호&#32;" Top="5" VAlign="Middle" Width="80"></Static>
		<Edit BindDataset="ds_cond" Border="Flat" Column="REQNO" Height="20" Id="ed_reqno" Left="863" MaxLength="10" Number="TRUE" Style="sty_ipt_search_ind" TabOrder="8" Top="5" Width="90"></Edit>
		<Button Height="18" Id="Button0" ImageID="btn_icon_search" Left="955" OnClick="ufn_getReqNo" TabOrder="9" Text="Button0" Top="6" Width="18"></Button>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="CODE" Column="BUSSI" DataColumn="CODE_NAME" Height="20" Id="cb_bussi" InnerDataset="ds_bussi_cd" Left="280" Style="sty_ipt_search_ind" TabOrder="10" Top="4" Width="112"></Combo>
		<Calendar BindDataset="ds_cond" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="REQDATE" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_reqdate" Left="669" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_search_ind" SundayTextColor="user35" TabOrder="11" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="5" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="111"></Calendar>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="CODE" Column="REQKIND" DataColumn="CODE_NAME" Height="20" Id="cb_reqkind" InnerDataset="ds_reqkind_cd" Left="474" OnChanged="cb_reqkindChanged" Style="sty_ipt_search_ind" TabOrder="12" Top="4" Width="112"></Combo>
		<Shape BKColor="user12" Bottom="113" Height="26" Id="Shape9" Left="10" LineColor="user13" Right="968" TabOrder="13" Top="87" Type="Rectangle" Width="958"></Shape>
		<Static Align="Right" Height="24" Id="st_zbosuin" Left="584" Style="sty_lb_form_basic" TabOrder="17" Text="보수인수일&#32;" Top="88" VAlign="Middle" Width="78"></Static>
		<Static Align="Right" Height="24" Id="st_zbepjeo" Left="393" Style="sty_lb_form_basic" TabOrder="16" Text="완성검사일&#32;" Top="88" VAlign="Middle" Width="78"></Static>
		<Static Align="Right" Height="24" Id="st_atype" Left="202" Style="sty_lb_form_basic" TabOrder="15" Text="기종&#32;" Top="88" VAlign="Middle" Width="78"></Static>
		<Static Align="Right" Height="24" Id="st_posid" Left="11" Style="sty_lb_form_basic" TabOrder="14" Text="호기(WBS)&#32;" Top="88" VAlign="Middle" Width="78"></Static>
		<Shape BKColor="user12" Bottom="163" Height="51" Id="Shape3" Left="10" LineColor="user13" Right="968" TabOrder="18" Top="112" Type="Rectangle" Width="958"></Shape>
		<Static Align="Right" Height="49" Id="st_causetxt1" Left="11" Style="sty_lb_form_basic" TabOrder="19" Text="문제점내용&#32;" Top="113" VAlign="Middle" Width="78"></Static>
		<Static Align="Right" Height="24" Id="st_zoipsu" Left="775" Style="sty_lb_form_basic" TabOrder="20" Text="입주일&#32;" Top="88" VAlign="Middle" Width="83"></Static>
		<Edit Border="Flat" Enable="FALSE" Height="20" Id="ed_atype" ImeMode="english" Left="282" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="21" Top="90" UpperOnly="TRUE" Width="109"></Edit>
		<TextArea Border="Flat" Enable="FALSE" Height="45" Id="tx_causetxt1" Left="91" Style="sty_ipt_form" TabOrder="22" Top="115" VScroll="TRUE" Width="874"></TextArea>
		<Calendar Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Enable="FALSE" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_zbepjeo" Left="473" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="23" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="90" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="109"></Calendar>
		<Calendar Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Enable="FALSE" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_zbosuin" Left="664" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="24" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="90" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="109"></Calendar>
		<Calendar Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Enable="FALSE" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_zoipsu" Left="860" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="25" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="90" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="105"></Calendar>
		<Grid AreaSelect="TRUE" AutoEnter="TRUE" AutoFitEndLine="Hide" BindDataset="ds_list" BkColor2="default" BoldHead="true" Border="Flat" Bottom="552" CellMoving="TRUE" ColSelect="TRUE" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="334" Id="grd_list" InputPanel="FALSE" Left="10" LineColor="user20" LineType="ExHORZ" OnCellDBLClick="ufn_SearchMMPR" OnExpandUp="btn_matnr_OnClick" Right="968" RowHeight="20" Style="sty_grid" TabOrder="26" TabStop="true" Top="218" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="958">
			<contents>
				<format id="Default">
					<columns>
						<col fix="left" width="20"/>
						<col fix="left" width="40"/>
						<col fix="left" width="80"/>
						<col width="150"/>
						<col width="120"/>
						<col width="70"/>
						<col width="80"/>
						<col width="80"/>
						<col width="70"/>
						<col width="70"/>
						<col width="100"/>
						<col width="90"/>
						<col width="70"/>
						<col width="120"/>
						<col width="90"/>
						<col width="90"/>
						<col width="90"/>
						<col width="100"/>
						<col width="90"/>
						<col width="100"/>
						<col width="90"/>
						<col width="89"/>
						<col width="94"/>
						<col width="80"/>
						<col width="90"/>
						<col width="90"/>
						<col width="90"/>
						<col width="120"/>
					</columns>
					<head>
						<cell bkimageid="icon_grid_sel" col="0" display="text" rowspan="2"/>
						<cell align="center" col="1" display="text" font="굴림,9" rowspan="2" text="순번"/>
						<cell align="center" col="2" display="text" font="굴림,9" rowspan="2" text="자재코드"/>
						<cell align="center" col="3" display="text" font="굴림,9" rowspan="2" text="자재내역"/>
						<cell align="center" col="4" display="text" font="굴림,9" rowspan="2" text="평가유형"/>
						<cell align="center" col="5" display="text" font="굴림,9" rowspan="2" text="자재유형"/>
						<cell align="center" col="6" display="text" font="굴림,9" rowspan="2" text="공사번호"/>
						<cell align="center" col="7" display="text" font="굴림,9" rowspan="2" text="원WBS"/>
						<cell align="center" col="8" display="text" font="굴림,9" rowspan="2" text="요청수량"/>
						<cell align="center" col="9" display="text" font="굴림,9" rowspan="2" text="수량단위"/>
						<cell col="10" display="text" font="굴림,9" rowspan="2" text="판매금액"/>
						<cell align="center" col="11" display="text" font="굴림,9" rowspan="2" text="고객센터&#10;접수번호"/>
						<cell align="center" col="12" display="text" font="굴림,9" rowspan="2" text="반납대상"/>
						<cell align="center" col="13" display="text" font="굴림,9" rowspan="2" text="자재&#10;특성치"/>
						<cell align="center" col="14" display="text" font="굴림,9" rowspan="2" text="보수창고&#10;재고"/>
						<cell align="center" col="15" display="text" font="굴림,9" rowspan="2" text="청구업체&#10;창고재고"/>
						<cell align="center" col="16" display="text" font="굴림,9" rowspan="2" text="반납자재&#10;SER"/>
						<cell align="center" col="17" display="text" font="굴림,9" rowspan="2" text="반납인버터&#10;내부보드SER.NO"/>
						<cell align="center" col="18" display="text" font="굴림,9" rowspan="2" text="설치자재&#10;SER.NO"/>
						<cell align="center" col="19" display="text" font="굴림,9" rowspan="2" text="설치인버터&#10;내부보드SER.NO"/>
						<cell align="center" col="20" display="text" font="굴림,9" rowspan="2" text="유상&#10;계약번호"/>
						<cell align="center" col="21" display="text" font="굴림,9" rowspan="2" text="고장원인&#10;Code"/>
						<cell align="center" col="22" display="text" font="굴림,9" rowspan="2" text="고장원인&#10;Code&#32;GR"/>
						<cell align="center" col="23" display="text" font="굴림,9" rowspan="2" text="고장원인"/>
						<cell align="center" col="24" display="text" font="굴림,9" rowspan="2" text="고장현상&#10;Code"/>
						<cell align="center" col="25" display="text" font="굴림,9" rowspan="2" text="고장현상&#10;Code&#32;GR"/>
						<cell align="center" col="26" display="text" font="굴림,9" rowspan="2" text="고장현상"/>
						<cell align="center" col="27" display="text" font="굴림,9" rowspan="2" text="청구종류"/>
					</head>
					<body>
						<cell bkimageid='expr:gfn_getFlagBkImageID(getColumn(currow,&#32;&quot;FLAG&quot;))' col="0" display="text"/>
						<cell align="center" bkcolor2="user22" col="1" colid="REQSN" display="text"/>
						<cell align="center" bkcolor2="user22" bkimagealign="right" col="2" colid="MATNR" cursor="ibeam" display="text" edit="normal" expandimage="btn_icon_search" expandshow="true" expandsize="18"/>
						<cell align="left" bkcolor2="user22" col="3" colid="MAKTX" display="text"/>
						<cell align="center" bkcolor2="user22" bkimagealign="right" bkimageid="icon_grid_edit" col="4" colid="BWTAR" combocol="CODE" combodataset="ds_bwtar_cd" combotext="CODE_NAME" display="combo" edit="combo"/>
						<cell align="center" bkcolor2="user22" col="5" colid="MTART" combocol="CODE" combodataset="ds_mtart_cd" combotext="CODE_NAME" display="combo"/>
						<cell align="center" bkcolor2="user22" col="6" colid="POSID" display="text"/>
						<cell align="center" bkcolor2="user22" col="7" colid="POSID2" display="text"/>
						<cell align="right" bkcolor2="user22" bkimagealign="left" bkimageid="icon_grid_edit" col="8" colid="MENGE" display="number" edit="normal" LimitDec="2"/>
						<cell align="center" bkcolor2="user22" col="9" colid="MEINS" display="text"/>
						<cell align="right" bkcolor2="user22" col="10" colid="SAMT1" display="number" expr="SAMT1*MENGE" Mask="###,###"/>
						<cell align="center" bkcolor2="user22" bkimagealign="right" col="11" colid="ACPT_NUM" display="text" expandimage="btn_icon_search" expandshow="true" expandsize="18"/>
						<cell align="center" bkcolor2="user22" col="12" colid="BANNAB" combocol="CODE" combodataset="ds_bannab" combotext="CODE_NAME" display="combo"/>
						<cell align="left" bkcolor2="user22" bkimagealign="right" bkimageid="icon_grid_edit" col="13" colid="CHAR1" display="text" edit="normal" limit="50"/>
						<cell align="right" bkcolor2="user22" col="14" colid="PARLAB" display="text"/>
						<cell align="right" bkcolor2="user22" col="15" colid="PARLAB1" display="text"/>
						<cell align="center" bkcolor2="user22" bkimagealign="right" bkimageid='expr:iif(getColumn(currow,&quot;BANNAB&quot;)==&quot;1&quot;,&apos;icon_grid_edit&apos;,&apos;none&apos;)' col="16" colid="RETMSNO" display="text" edit='expr:iif(getColumn(currow,&quot;BANNAB&quot;)==&quot;0&quot;,&apos;none&apos;,&apos;uppernumchar&apos;)'/>
						<cell align="center" bkcolor2="user22" bkimagealign="right" bkimageid='expr:iif(getColumn(currow,&quot;BANNAB&quot;)==&quot;1&quot;&#32;&amp;&amp;&#32;substr(getColumn(currow,&quot;BWTAR&quot;),0,1)==&quot;P&quot;,&apos;icon_grid_edit&apos;,&apos;none&apos;)' col="17" colid="MBRETMSNO" display="text" edit='expr:iif(getColumn(currow,&quot;BANNAB&quot;)==&quot;1&quot;&#32;&amp;&amp;&#32;substr(getColumn(currow,&quot;BWTAR&quot;),0,1)==&quot;P&quot;,&apos;uppernumchar&apos;,&apos;none&apos;)'/>
						<cell align="center" bkcolor2="user22" bkimagealign="right" bkimageid='expr:iif(getColumn(currow,&quot;BANNAB&quot;)==&quot;1&quot;,&apos;icon_grid_edit&apos;,&apos;none&apos;)' col="18" colid="INSMSNO" display="text"/>
						<cell align="center" bkcolor2="user22" bkimagealign="right" bkimageid='expr:iif(getColumn(currow,&quot;BANNAB&quot;)==&quot;1&quot;&#32;&#32;&amp;&amp;&#32;substr(getColumn(currow,&quot;BWTAR&quot;),0,1)==&quot;P&quot;,&apos;icon_grid_edit&apos;,&apos;none&apos;)' col="19" colid="MBINSMSNO" display="text"/>
						<cell align="center" bkcolor2="user22" bkimagealign="right" bkimageid="expr:iif(ufn_isMMPR(),&apos;icon_grid_edit&apos;,&apos;&apos;)" col="20" colid="ASSNO" display="text" edit="normal"/>
						<cell align="center" bkcolor2="user22" bkimagealign="right" bkimageid="expr:iif(ufn_isMMPR(),&apos;icon_grid_edit&apos;,&apos;&apos;)" col="21" colid="CAUSECOD" combocol="CODE" combodataset="ds_cause" combodisplayrowcnt="10" combotext="KURZTEXT" display="text" edit="expr:ufn_rowIsMMPR(&apos;combo&apos;)"/>
						<cell align="center" bkcolor2="user22" col="22" colid="CAUSEGRP" display="text"/>
						<cell align="left" bkcolor2="user22" col="23" colid="CAUSETXT" display="text"/>
						<cell align="center" bkcolor2="user22" bkimagealign="right" bkimageid="expr:iif(ufn_isMMPR(),&apos;icon_grid_edit&apos;,&apos;&apos;)" col="24" colid="PHENOCOD" combocol="CODE" combodataset="ds_pheno" combodisplayrowcnt="10" combotext="KURZTEXT" display="text" edit="expr:ufn_rowIsMMPR(&apos;combo&apos;)"/>
						<cell align="center" bkcolor2="user22" col="25" colid="PHENOGRP" display="text"/>
						<cell align="center" bkcolor2="user22" col="26" colid="PHENOTXT" display="text"/>
						<cell align="center" bkcolor2="user22" bkimagealign="right" col="27" colid="REQKIND" combocol="CODE" combodataset="ds_reqkind_grd_cd" combofilter='expr:&quot;(CODE&#32;==&#32;&apos;&quot;&#32;+&#32;ds_list.getcolumn(ds_list.row,&quot;REQKIND&quot;)&#32;+&#32;&quot;&apos;)&#32;||&#32;(CODE&#32;==&#32;6)&quot;' combotext="CODE_NAME" display="combo"/>
					</body>
					<summary>
						<cell col="0" colspan="3" display="text"/>
						<cell align="center" col="3" colspan="7" display="text" text="합계"/>
						<cell align="right" bkcolor="user25" col="10" display="number" expr='sum(&quot;SAMT1*MENGE&quot;)' Mask="###,###"/>
						<cell col="11" display="text"/>
						<cell col="12" colspan="16" display="text"/>
					</summary>
				</format>
			</contents>
		</Grid>
		<Button Enable="FALSE" Height="18" Id="bt_posid" ImageID="btn_icon_search" Left="182" OnClick="btn_Hogi_OnClick" TabOrder="27" Text="Button0" Top="91" Width="18"></Button>
		<MaskEdit BindDataset="ds_list" Border="Flat" Column="POSID" Enable="FALSE" Height="20" Id="ed_posid" Left="91" LeftMargin="4" Mask="ZZZZZZZZZZZZ" MaxLength="9" RightMargin="4" Style="sty_ipt_form" TabOrder="28" Top="90" Type="STRING" Width="90"></MaskEdit>
		<MaskEdit BindDataset="ds_list" Border="Flat" Column="POSID2" Enable="FALSE" Height="20" Id="ed_posid2" Left="91" LeftMargin="4" Mask="ZZZZZZZZZZZZZZZZ" MaxLength="11" Readonly="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="29" Top="65" Type="STRING" Width="90"></MaskEdit>
		<Button ButtonStyle="TRUE" Cursor="HAND" Enable="FALSE" Height="20" Id="btn_KyenJeok" ImageID="btn_sub_05" Left="562" LeftMargin="12" OnClick="ufn_callKyunJeok" Style="sty_btn" TabOrder="30" Text="견적서작성" Top="38" Transparent="TRUE" Visible="FALSE" Width="83"></Button>
		<Button Enable="FALSE" Height="18" Id="btn_posid2" ImageID="btn_icon_search" Left="182" OnClick="btn_Posid2_OnClick" TabOrder="31" Text="Button0" Top="66" Width="18"></Button>
		<Button Enable="FALSE" Height="18" Id="btn_pjt" ImageID="btn_icon_search" Left="359" OnClick="btn_pjt_OnClick" TabOrder="32" Text="Button0" Top="66" Width="18"></Button>
		<Combo Border="Flat" Column="HOGI" DataColumn="POSID_1" Enable="FALSE" Height="20" Id="cb_pspid" InnerDataset="ds_pspid_cd" Left="377" OnChanged="ufn_setData" Style="sty_ipt_form" TabOrder="33" Top="64" Width="123"></Combo>
		<Edit Border="Flat" Enable="FALSE" Height="20" Id="ed_pjt" Left="282" Style="sty_ipt_form_ind" TabOrder="34" Top="65" Width="76"></Edit>
		<Static Align="Right" Height="24" Id="st_posid2" Left="11" Style="sty_lb_form_basic" TabOrder="36" Text="원WBS&#32;" Top="63" VAlign="Middle" Width="78"></Static>
		<Static Align="Right" Height="24" Id="st_pspid" Left="202" Style="sty_lb_form_basic" TabOrder="37" Text="프로젝트&#32;" Top="63" VAlign="Middle" Width="78"></Static>
		<Static Align="Right" Height="24" Id="st_rdate" Left="584" Style="sty_lb_form_basic" TabOrder="38" Text="납기일&#32;" Top="63" VAlign="Middle" Width="78"></Static>
		<Calendar BindDataset="ds_list" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="RDATE" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_rdate" Left="664" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="39" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="65" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="109"></Calendar>
		<Button ButtonStyle="TRUE" Cursor="HAND" Enable="FALSE" Height="20" Id="btn_ChengGu" ImageID="btn_sub_05" Left="648" LeftMargin="12" OnClick="ufn_callCheongGu" Style="sty_btn" TabOrder="40" Text="호기별청구" Top="38" Transparent="TRUE" Width="83"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Enable="FALSE" Height="20" Id="btn_serno_into" ImageID="btn_sub_08" Left="734" LeftMargin="12" OnClick="ufn_serno_in" Style="sty_btn" TabOrder="41" Text="조치SER.NO입력" Top="38" Transparent="TRUE" Width="112"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Enable="FALSE" Height="20" Id="btn_serno_del" ImageID="btn_sub_08" Left="849" LeftMargin="12" OnClick="ufn_serno_del" Style="sty_btn" TabOrder="42" Text="조치SER.NO삭제" Top="38" Transparent="TRUE" Width="128"></Button>
	</Form>
	<Script><![CDATA[﻿﻿﻿﻿﻿﻿/*
 ******************************************************************************************
 * 기      능   : 
 * 작  성  자   : 
 * 작성  일자   : 
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
#include "LIB::commons.js";	// 공통 스크립트 
//=========================================================================================
// [ PART 1 ]
// Form에서 사용될 전역변수를 선언
// FORM에서 사용되는 전역변수는 대문자로 작성하며, F_XXX 의 형태를 갖도록 한다. 
//=========================================================================================
var listRow = 0;
var reqkind2 = "";
var update = false;
//=========================================================================================
// [ PART 2 ]
// Form Loading / Unloading 시 작업 정의
//=========================================================================================
function fn_OnLoadCompleted(obj) {
   
	// Form 로드 이벤트 맨 첫줄에 기술 
	gfn_initForm(true);

	// 공급 업체명 설정 
	ed_lifnrName.value = G_VEND_NAME;
	ds_cond.setColumn(0, "LIFNR", G_VEND_CODE_R);

    // 엑셀 버튼 비활성화
    ufn_enableBtn("excel", false);

    // 청구종류코드,사업장코드,자재평가유형코드,자재유형코드 DataSet 가져오기
    var codeArr = ["3","CS151","2","1"];
    var dsObjArr = [ds_reqkind_cd,ds_bussi_cd,ds_bwtar_cd,ds_mtart_cd];
    var addTypeArr = [G_CODE_ALL,G_CODE_ALL,G_CODE_NONE,G_CODE_NONE];
    gfn_searchCommCode(codeArr, dsObjArr, addTypeArr,true);


	tit_clearActionInfo();
	tit_addSearchActionInfo("cs01:CS0101001A_S6");
	tit_addSearchActionInfo("cs01:CS0101001A_S7");
	
	tit_callService(
        ""
        , ""
        , ""
        , "ds_cause=ds_cause ds_pheno= ds_pheno"
        , ""
        , ""
        , true);
        
	//   청구생성일 설정 
//	cal_reqdate.value = gfn_getCurrDate();

   // 완료메세지
   gfn_showMsg("CI00007");
}
/********************************************************************************
* 기      능   : 공통코드가 조회된 후의 Callback 함수 
********************************************************************************/
function fn_completeInit(sCode, sDsObj, sCodeType) {
	// 청구종류 초기화
	cb_reqkind.Index = 0;
	//  사업부 설정 
	cb_bussi.Index = 0;
	gfn_copyDs(ds_reqkind_cd,ds_reqkind_grd_cd);
}
/********************************************************************************
* 기      능   : form UnloadCompleted 
********************************************************************************/
function fn_OnUnloadCompleted(obj) {
	return gfn_isFormUnload(obj);
}
//=========================================================================================
// [ PART 3 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,form닫기)
//=========================================================================================
/********************************************************************************
* 기      능   : 조회 
********************************************************************************/
function fn_query() {
  
    // Message 영역 초기화
	global.FRM_BOTTOM.img_msgType.imageId = "";
	global.FRM_BOTTOM.st_msg.value = "";

	// 필수 입력 항목 체크 
/*	if ( gfn_isNull(cal_reqdate, true) ) {
		gfn_showMsg("CW00001","청구생성일");
		return;
	}
*/
	// 필수 입력 항목 체크 - 청구번호
	if ( gfn_isNull(ed_reqno, true) ) {
		gfn_showMsg("CW00001","청구번호");
		return;
	}
	
	ufn_clearInput();
	tit_clearActionInfo();
	tit_addSearchActionInfo("cs01:CS0101001A_S1");

	tit_callService(
        ""
        , ""
        , "ds_cond=ds_cond"
        , "ds_list=ds_list"
        , ""
        , "fn_afterQuery"
        , true);
        
      	
}
/********************************************************************************
* 기      능   : 삽입 
********************************************************************************/
function fn_input() 
{
    // 권한 설정
	var gbn, cb1_val, cb2_val, cb3_val;
	var user_grp = gfn_getUserGroup();

	if(user_grp == "10") { // 보수협력사 권한
		gbn = 'A';
	}
	if(user_grp == "20") { // 보수PM 권한
		gbn = 'B';
	}
	if(user_grp == "30") { // 지방 사무소 권한
		gbn = 'C';
	}
	if(user_grp == "40") { // 보수 자재 권한
		gbn = 'D';
	}
    
	var ser = "10";
	var cnt = ds_list.GetRowCount();
	var rekind = "179";

	if ( ds_cond.GetColumn(0,"REQKIND") <> "5")
	{
		btn_serno_into.Enable = true;
	    if (gbn = 'D')
	    {
	    btn_serno_del.Enable  = true;
	    }
	    else 
	    {
	    btn_serno_del.Enable  = false;
    	}
	}
	else
	{
	btn_serno_into.Enable = false;
	btn_serno_del.Enable  = false;
	}	
	
	if (length(cb_reqkind.value) < 1)
	{
		gfn_showAlert("CW00044");
		return;
	}

	if (cnt > 0) 
	{
	    if ( length(ds_list.GetColumn(ds_list.row,"MAKTX")) < 1 || (ds_list.GetColumn(ds_list.row,"RECE_F") != "0" && ds_list.GetColumn(ds_list.row,"RECE_F") != "5") || length(ds_list.GetColumn(ds_list.row,"QTNUM")) > 0 )
	    {
			gfn_showMsg("CW00017");
			return;
	    }
		ser = parseInt(ds_list.GetColumn(ds_list.GetRowCount()-1,"REQSN")) + 10;
	}
	ds_list.AddRow();
	ds_list.setColumn(ds_list.row, "FLAG", "I");
	ds_list.SetColumn(ds_list.row,"REQSN",ser);
	
	//ds_list.setColumn(ds_list.row, "CHECK", "");
	
	if (ufn_isMMPR()) {
		ds_list.SetColumn(ds_list.row,"SERNO",ser);
	} else {
		ds_list.SetColumn(ds_list.row,"SERNO","");
	}
	
	ds_list.SetColumn(ds_list.row,"RECE_F", "0");
	ds_list.SetColumn(ds_list.row,"REQKIND", cb_reqkind.value);
	cal_credt.value = gfn_getCurrDate();

	if (ds_list.GetOrgBuffColumn(ds_list.row,"MANDT") == G_MANDT)
	{
		ds_list.AddRow();
	}
	else
	{
		for( var i = 0; i < 10 ; i++)
		{
			ds_list.AddRow();
			
			ser = parseInt(ser) + 10;
			ds_list.setColumn(ds_list.row, "FLAG", "I");
			ds_list.SetColumn(ds_list.row,"REQSN",ser);
			if (ufn_isMMPR()) {
				ds_list.SetColumn(ds_list.row,"SERNO",ser);
			} else {
				ds_list.SetColumn(ds_list.row,"SERNO","");
			}
			ds_list.SetColumn(ds_list.row,"SERNO",ser);
			ds_list.SetColumn(ds_list.row,"RECE_F", "0");
			ds_list.SetColumn(ds_list.row,"REQKIND", cb_reqkind.value);
			if (IndexOf(rekind, cb_reqkind.value) > -1)
			{
				grd_list.SetCellProp("body",27,"edit","combo");
			} else {
				grd_list.SetCellProp("body",27,"edit","none");
			}
			
		}
	}
	if (ufn_isMMPR())
	{
		ufn_setEnable();
	}
	else
	{
		ufn_setDisable();
	}

    // FM 재고소진 청구 추가 13.08.13 HSS
    if(cb_reqkind.value == '9' || cb_reqkind.value == 'H')
    {
		ed_rejtxt.Enable = true;
		tx_causetxt1.Enable = true;    
    }
    
	ds_list.RowPos = cnt;

}
/********************************************************************************
* 기      능   : Delete 
********************************************************************************/
function fn_delete() {
	if ( ds_list.rowCount() == 0 ) {
		// 삭제할 자료 선택 
		// CW00013=처리할 자료를 먼저 선택해 주십시오.
		gfn_showMsg("CW00013");
		return;
	}
	
	if (ds_list.GetOrgColumn(ds_list.rowpos,"MANDT") == G_MANDT && ds_list.GetColumn(ds_list.rowpos, "REQNO") != "")
	{
		if (ds_list.GetColumn(ds_list.rowpos,"RECE_F") != "0" && ds_list.GetColumn(ds_list.rowpos,"RECE_F") != "5"){
			gfn_showAlert("CW00072");
			return;
		}
		if (length(ds_list.GetColumn(ds_list.rowpos,"QTNUM")) > 0){
			gfn_showAlert("CW00110",ds_list.GetColumn(ds_list.rowpos,"QTNUM"));
			return;
		}
		ds_list.setColumn(ds_list.rowpos, "FLAG", "D");
	}
	else
	{
		var serial = ds_list.GetColumn(ds_list.rowpos-1, "REQSN");
		var row = ds_list.rowpos;
		ds_list.DeleteRow(ds_list.rowpos);

		for (var i = ds_list.currow; i < ds_list.rowcount; i++){
			if (row < ds_list.rowcount && i != 0)
			{
				serial = parseInt(serial) + 10;
				ds_list.SetColumn(i, "REQSN", serial);
			}
		}
	}
	
//	gfn_sortGrid(ds_list,"REQSN");
}
/********************************************************************************
* 기      능   : 청구 전송
********************************************************************************/
function fn_save() {
    // Message 영역 초기화
	global.FRM_BOTTOM.img_msgType.imageId = "";
	global.FRM_BOTTOM.st_msg.value = "";
	
	ed_reqno.SetFocus();
	
    //변경값 확인
	if ( !gfn_isChangeDs(ds_list, true) ) {
		return;
	}

	// 사업부 체크
	if ( gfn_isNull(cb_bussi, true) ) {
		gfn_showMsg("CW00001","사업부");
		return;
	}
	// 청구일자 체크
	if ( gfn_isNull(cb_reqkind, true) ) {
		gfn_showMsg("CW00001","청구종류");
		return;
	}
	
	// 청구일자 체크
	if ( gfn_isNull(cal_reqdate, true) ) {
		gfn_showMsg("CW00001","청구생성일");
		return;
	}
	// 납기일 체크
	if ( gfn_isNull(cal_rdate, true) ) {
		gfn_showMsg("CW00001","납기일");
		return;
	}
//	if ( !gfn_checkDate( gfn_getCurrDate(),cal_reqdate.value , true, cal_reqdate.value,"청구생성일") ) {
//		return;
//	} 임시로 막음


//  비어있는 행 삭제
	ds_list.fireevent = false;
	for (var i =0; i < ds_list.rowcount; i++)
	{
		for(var j=0; j <ds_list.rowcount; j++)
		{
			if ( i != j && ds_list.GetColumn(i,"MATNR") = ds_list.GetColumn(j,"MATNR")
			            && ds_list.GetColumn(i,"BWTAR") != ds_list.GetColumn(j,"BWTAR")) {
			   gfn_showAlert("CW00231", j);
			   grd_list.SetFocus();
	           ds_list.row = j;
			   ds_list.fireevent = true;
			   return;
			}
		}

		if(length(ds_list.GetColumn(i,"MATNR")) < 1)
		{
			ds_list.DeleteRow(i); 
			i--;
		}
	}

	//  MMPR이 아닌경우 검사
	for (var i =0; i < ds_list.rowcount; i++)
	{
		if(length(ds_list.GetColumn(i,"BWTAR")) < 1)
		{
			gfn_showAlert("CW00001","평가유형");
			return;
		}
		if(!ufn_isMMPR() && length(ds_list.GetColumn(i,"POSID")) < 1)
		{
			gfn_showAlert("CW00001","공사번호");
			return;
		}
		if(parseInt(ds_list.GetColumn(i,"MENGE")) < 1)
		{
			gfn_showAlert("CW00001","요청수량");
			return;
		} 


        // 재청구일 경우 원 WBS번호 반드시 입력
  		if (cb_reqkind.value == "8")
		{
			if (length(ed_posid2.value) < 1)
			{
				gfn_showAlert("CW00001","원 WBS");
				ed_posid2.setFocus();
				return;
			}
			ds_list.SetColumn(i,"POSID2", ed_posid2.value);

            //재청구일 경우 인건비 존재여부 파악 후 재청구 불가 로직추가 2012.06.19 이호영
            if (ds_list.GetColumn(i,"STATUS") == "A" || ds_list.GetColumn(i,"STATUS") == "B" ||
                ds_list.GetColumn(i,"STATUS") == "C")
            {
             gfn_showAlert(ds_list.GetColumn(i,"POSID2")+" 인건비 지급 완료되어 재청구 불가합니다.");
             return;
            }
		}
		
		ds_list.fireevent = false;

		ds_list.SetColumn(i,"REQKIND2",reqkind2);
		ds_list.SetColumn(i,"LGORT",G_VEND_CODE_R);
		ds_list.SetColumn(i,"BUSSI",cb_bussi.value);
		ds_list.SetColumn(i,"REQDATE", cal_reqdate.value);
		ds_list.SetColumn(i,"RDATE", cal_rdate.value);
		ds_list.SetColumn(i,"ZCAUSETXT", ed_rejtxt.value);
		ds_list.SetColumn(i,"ZCAUSETXT2", tx_causetxt1.value);
    
		if (update){
			ds_list.SetColumn(i, "REQNO", ds_list.GetColumn(0,"REQNO"));
			ds_list.SetColumn(i, "QTNUM", ds_list.GetColumn(0,"QTNUM"));
		}

		ds_list.fireevent = true;
	}		

    // MMPR의 경우 검사
	if (ufn_isMMPR())
	{
		if( gfn_isNull(cb_pspid,true,"청구공사번호",cb_pspid))
		{
			return;
		}
		if( gfn_isNull(ed_atype,true,"기종",ed_atype))
		{
			return;
		}

		if( gfn_isNull(cal_credt,true,"작성일",cal_credt))
		{
			return;
		}
		if( gfn_isNull(ed_temno,true,"작업자",ed_temno))
		{
			return;
		}
		if( gfn_isNull(cal_workdt,true,"작업일",cal_workdt))
		{
			return;
		}
//  	미래일 입력가능.
//		if ( !gfn_checkDate( cal_workdt.value,gfn_getCurrDate(), true, cal_workdt.value,"작업일") ) {
//			return;
//		}		
		if( gfn_isNull(ed_cellp,true,"작업자연락처",ed_cellp))
		{
			return;
		}
		if( gfn_isNull(ed_rejtxt,true,"문제점 요약",ed_rejtxt))
		{
			return;
		}
		if( gfn_isNull(tx_causetxt1,true,"문제점 내용",tx_causetxt1))
		{
			return;
		}
		
		//FM청구일 경우에도 문제점요약 내용 필요 조요환GJ요청 2013.01.18 이호영  , FM 재고소진 추가 13.08.13 HSS
		if(cb_reqkind.Value == '9' || cb_reqkind.Value == 'H') 
		{
			if( gfn_isNull(ed_rejtxt,true,"문제점 요약",ed_rejtxt))
			{
				return;
			}

			if( gfn_isNull(tx_causetxt1,true,"문제점 요약",tx_causetxt1))
			{
				return;
			}			
		}

		
		for (var i =0; i < ds_list.rowcount; i++)
		{
			// if(length(ds_list.GetColumn(i,"RETMSNO")) < 1)
			// {
				// gfn_showAlert("CW00001","반납자재 SER");
				// return;
			// }
			if(length(ds_list.GetColumn(i,"CAUSECOD")) < 1)
			{
				gfn_showAlert("CW00001","고장원인 CODE");
				return;
			}
			if(length(ds_list.GetColumn(i,"PHENOCOD")) < 1)
			{
				gfn_showAlert("CW00001","고장현상 CODE");
				return;
			}
			if(ds_list.GetColumn(i,"BANNAB") == "1" && length(ds_list.GetColumn(i,"RETMSNO")) < 1)
			{
				gfn_showMsg("CW00001","반납자재 SER.NO");
				return;
			}
			if(ds_list.GetColumn(i,"BANNAB") == "1" && substr(ds_list.GetColumn(i,"BWTAR"),0,1) == "P" && length(ds_list.GetColumn(i,"MBRETMSNO")) < 1)
			{
				gfn_showAlert("CW00001","반납인버터 내부 보드 SER.NO");
				return;
			}
			if(ds_list.GetColumn(i,"BANNAB") == "1" && length(ds_list.GetColumn(i,"INSMSNO")) < 1)
			{
				gfn_showMsg("CW00001","설치자재 SER.NO");
			}
			
			ds_list.fireevent = false;
			if (ds_list.GetColumn(0,"FLAG") == "I")	{
				//ds_list.SetColumn(i,"POSID",Substr(cb_pspid.value,0,6)); 08.07.12 수정
				//ds_list.SetColumn(i,"PSPID",Substr(cb_pspid.value,0,6));
				ds_list.SetColumn(i,"POSID",cb_pspid.value);
				ds_list.SetColumn(i,"PSPID",ed_pjt.value);
				ds_list.SetColumn(i,"POSID2",ed_pjt.value);
				ds_list.SetColumn(i,"POST1",ds_pspid_cd.GetColumn(ds_pspid_cd.row,"ZSITE_NM"));
				ds_list.SetColumn(i,"HOGI",cb_pspid.value);
				ds_list.SetColumn(i,"SPEC",ed_spec.Text);
				ds_list.SetColumn(i,"LIFNR",G_VEND_CODE_R);
				ds_list.SetColumn(i,"ATYPE",ed_atype.value);
				ds_list.SetColumn(i,"ZBEPJEO",cal_zbepjeo.value);
				ds_list.SetColumn(i,"ZBOSUIN",cal_zbosuin.value);
				ds_list.SetColumn(i,"ZOIPSU",cal_zoipsu.value);
				ds_list.SetColumn(i,"CREID",G_USER_ID);
				ds_list.SetColumn(i,"CRENM",G_USER_NAME);
				ds_list.SetColumn(i,"CREDT",cal_credt.value);
				ds_list.SetColumn(i,"NAMET",ed_temno.value);
				ds_list.SetColumn(i,"WORKDT",cal_workdt.value);
				ds_list.SetColumn(i,"CELLP",ed_cellp.value);
				ds_list.SetColumn(i,"REJTXT",ed_rejtxt.value);
				ds_list.SetColumn(i,"SPEC",ed_spec.value);
				ds_list.SetColumn(i,"LGORT",G_VEND_CODE_R);
				ds_list.SetColumn(i,"BUSSI",cb_bussi.value);
				ds_list.SetColumn(i,"REQDATE", cal_reqdate.value);
				ds_list.SetColumn(i,"RDATE", cal_rdate.value);
			}
			ds_list.fireevent = true;

		}
	}

    // 자료가 없으면 리턴
	if (ds_list.rowcount < 1){
		gfn_showAlert("CW00010");
		return;
	}

	
	if (!gfn_showConfirm("CI00010")) {
		return;
	}

	// MMPR의 경우
	if (ufn_isMMPR())//  && cb_reqkind.value != "3") // MMPR 수리 청구의 경우 QM데이터를 넣지 않는다.
	{
		if (!update)
		{
			tit_clearActionInfo();
			// 트랜젝션 시작 - ZQMT007막음
			tit_addSearchActionInfo("cs01:CS0101001A_T2",true);

			//  MMPR번호 생성
			tit_addSearchActionInfo("cs01:CS0101001A_S5",true);
	
			tit_callService(
				""
				, ""
				, ""
				, "ds_mkey=ds_mkey"
				, ""
				, ""
				, true
				, null
				, true);
		
		} else {
			ds_mkey.AddRow();
			ds_mkey.SetColumn(0,"JQPRNUM", ds_list.GetColumn(0,"JQPRNUM"));
		}
		
		// MMPR 번호가 없을 경우 리턴
		if(length(ds_mkey.GetColumn(0,"JQPRNUM")) < 1) {
			alert("CE00001");
			return;
		}

		// 문제점내용 72Bytes 씩 끊어서 데이터셋에 담기
		if (!gfn_saveLongText(ds_qmtext1, tx_causetxt1.value
			, "ZA01",ds_mkey.GetColumn(0,"JQPRNUM"),"ZQMT002")) {
			gfn_showAlert("CE00001");
			return;
		}

		ds_list.fireevent = false;
		for (var i =0; i < ds_list.rowcount; i++)
		{
			ds_list.SetColumn(i,"JQPRNUM",ds_mkey.GetColumn(0,"JQPRNUM"));
		}
		ds_list.fireevent = true;
		
		ds_list_0.AddRow();
		ds_list_0.CopyRow(0,"ds_list",0);
		
		if (update)
		{
			ds_list_0.SetColumn(0,"FLAG", "U");
		} else {
			ds_list_0.SetColumn(0,"FLAG", "I");
		}
	
	}
	
	if (update)
	{
		ds_key.ClearData();
		ds_key.AddRow();
		ds_key.SetColumn(0,"REQNO", ds_list.GetColumn(0, "REQNO"));
	}

	tit_clearActionInfo();
	// 청구번호 생성

	if (!update)
	{
		// 트랜젝션 시작 - ZMMT031 막음
		tit_addSearchActionInfo("cs01:CS0101001A_T1",true);

		tit_addSearchActionInfo("cs01:CS0101001A_S2",true);
		// MMPR의 경우
		if (ufn_isMMPR()) // MMPR 수리 청구의 경우 QM데이터를 넣지 않는다.
		{
			// 저장 처리 
			tit_addSaveActionInfo(
			"cs01:CS0101001A_I2"
			, "cs01:CS0101001A_U2"
			, ""
			, "FLAG"
			, ""
			, -1
			, "");
			
			tit_addSaveActionInfo(
			"cs01:CS0101001A_I3"
			, "cs01:CS0101001A_U3"
			, "cs01:CS0101001A_D2"
			, "FLAG"
			, ""
			, -1
			, "");
		 }
		 
		tit_addSaveActionInfo(
			"cs01:CS0101001A_I1"
			, "cs01:CS0101001A_U1"
			, ""
			, "FLAG"
			,""
			, 0
			, "");
	} else {

		// MMPR의 경우
		if (ufn_isMMPR()) // MMPR 수리 청구의 경우 QM데이터를 넣지 않는다.
		{
			// 저장 처리 
			tit_addSaveActionInfo(
			"cs01:CS0101001A_I2"
			, "cs01:CS0101001A_U2"
			, ""
			, "FLAG"
			, ""
			, -1
			, "");
			
			tit_addSaveActionInfo(
			"cs01:CS0101001A_I3"
			, "cs01:CS0101001A_U3"
			, "cs01:CS0101001A_D2"
			, "FLAG"
			, ""
			, -1
			, "");
		 }
		tit_addSaveActionInfo(
			"cs01:CS0101001A_I4"
			, "cs01:CS0101001A_U1"
			, "cs01:CS0101001A_D1"
			, "FLAG"
			,""
			, 0
			, "");
	}

//	tit_showDs(ds_list);
	// 저장 처리 

	tit_addSaveActionInfo(
		  ""
		, "cs01:CS0101001A_U4"
		, ""
		, "FLAG"
		,""
		, 0
		, "");
			
	tit_callService(
		""
		, ""
		, "ds_cond=ds_cond ds_key=ds_key ds_list=ds_list:A ds_list_0=ds_list_0:A"
		, "ds_key=ds_key"
		, ""
		, "fn_afterSave");
}

/********************************************************************************
* 기      능   : 거래명세서 전송취소 
********************************************************************************/
function fn_cancel() {
	ds_list.Reset();
}

/********************************************************************************
* 기      능   : 닫기  
********************************************************************************/
function fn_close() {
	close();
}

/********************************************************************************
* 기      능   : 액셀  
********************************************************************************/
function fn_excel() {
}

/********************************************************************************
* 기      능   : 복원 
********************************************************************************/
// function fn_reset() {
	// if (!gfn_showConfirm("CI00010")) {
		// return;
	// }	
	// ds_list.ClearData();
	// ds_cond.ClearData();
	// ds_cond.AddRow();
	// fn_OnLoadCompleted();
// }
//=========================================================================================
// [ PART 4]
// Callback 함수 정의 : callback 함수명은 메인 함수의 fn_xxxx() 에서 xxxx 부분은 fn_afterXXXX()
// 형태가 되도록 작성 
//=========================================================================================

/********************************************************************************
* 기      능   : 조회 Callback  
********************************************************************************/
function fn_afterQuery(errCode, errMsg) {

    // 권한 설정
	var gbn, cb1_val, cb2_val, cb3_val;
	var user_grp = gfn_getUserGroup();

	if(user_grp == "10") { // 보수협력사 권한
		gbn = 'A';
	}
	if(user_grp == "20") { // 보수PM 권한
		gbn = 'B';
	}
	if(user_grp == "30") { // 지방 사무소 권한
		gbn = 'C';
	}
	if(user_grp == "40") { // 보수 자재 권한
		gbn = 'D';
	}
	
    // 조회 결과가 있으면 엑셀 버튼 활성화
	if ( ds_list.rowCount() > 0 ) {
		update = true;
		ufn_enableBtn("excel", true);
		reqkind2 = ds_list.GetColumn(0,"REQKIND");
		cal_reqdate = ds_list.GetColumn(0,"REQDATE");
		cal_rdate = ds_list.GetColumn(0,"RDATE");
		cb_bussi = ds_list.GetColumn(0,"BUSSI");
		cb_reqkind = ds_list.GetColumn(0,"REQKIND");
		cb_reqno = ds_list.GetColumn(0,"REQNO");
		//trace(ds_cond.SaveXML());
		//alert(ds_cond.GetColumn(0,"REQKIND"));

		if ( ds_cond.GetColumn(0,"REQKIND") <> "5")
		{
		    btn_serno_into.Enable = true;
			if (gbn = 'D')
			{
			btn_serno_del.Enable  = true;
			}
			else 
			{
			btn_serno_del.Enable  = false;
			}
		}
		else
		{
		btn_serno_into.Enable = false;
		btn_serno_del.Enable  = false;
		}		

		
		if(ufn_isMMPR())
		{
			ed_pjt.value = SubStr(ds_list.GetColumn(0,"PSPID"),0,6);
			ufn_getProject(ed_pjt,SubStr(ds_list.GetColumn(0,"PSPID"),0,6));
			cb_pspid.value = ds_list.GetColumn(0,"PSPID");
			ed_atype.value = ds_list.GetColumn(0,"ATYPE");
			cal_zbepjeo.value = ds_list.GetColumn(0,"ZBEPJEO");
			cal_zbosuin.value = ds_list.GetColumn(0,"ZBOSUIN");
			cal_zoipsu.value = ds_list.GetColumn(0,"ZOIPSU");
			//cal_crenm.value = ds_list.GetColumn(0,"CRENM");
			cal_credt.value = ds_list.GetColumn(0,"CREDT");
			ed_temno.value = ds_list.GetColumn(0,"NAMET");
			cal_workdt.value = ds_list.GetColumn(0,"WORKDT");
			ed_cellp.value = ds_list.GetColumn(0,"CELLP");
			ed_rejtxt.value = ds_list.GetColumn(0,"REJTXT");
			cb_pspid.value = ds_list.GetColumn(0,"HOGI");
		   if ( length(ds_list.getColumn(0,"JQPRNUM")) > 0 )
		   {
			   tx_causetxt1.value = gfn_getLongText(ds_qmtext,"ZQMT002",ds_list.GetColumn(0,"JQPRNUM"),"ZA01");
		   }

			gfn_showMsg("CI00002", ds_list.rowCount() + "");

			ed_posid.Enable = false;
			bt_posid.Enable = false;
		}
		else {
			// 버튼
			btn_ChengGu.Enable = true;
			btn_KyenJeok.Enable = true;
			
			ed_rejtxt.value = ds_list.GetColumn(0,"ZCAUSETXT");
			tx_causetxt1.value = ds_list.GetColumn(0,"ZCAUSETXT2");
			
		}
	} else {
		ufn_enableBtn("excel", false);
		gfn_showMsg("CW00010");
	}
	
	//인건비 STATUS확인 표기 이호영
	//gfn_showalert(ds_list.GetColumn(0,"STATUS"));
}

/********************************************************************************
* 기      능   : 저장 Callback  
********************************************************************************/
function fn_afterSave(errCode, errMsg) {
	if ( errCode!= 0 ) {
		gfn_showMsg("CE00001");
	} else {
		gfn_showMsg("CI00003");
		ed_reqno.value = ds_key.GetColumn(0,"REQNO");
		fn_query();
	}
}

//=========================================================================================
// [ PART 5 ]
// Detail Process Event 정의 ( User Define function )
// 사용자 정의 함수는 ufn_xxxx() 형태로 작성 
//=========================================================================================
/********************************************************************************
* 기      능   : 사용자 정의 함수  
********************************************************************************/
function ufn_userfunction() {

}

//=========================================================================================
// [ PART 6 ]
// component Event 정의 : 각 Component 별 이벤트 
//=========================================================================================

/********************************************************************************
* 기      능   : 그리드 헤더 클릭시 정렬 처리 
********************************************************************************/
function grd_list_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
{
	if ( nCell == 0 ) {
		// 그리드 표시할 컬럼 선택 
		gfn_selectGridCol(obj);
	} else {
		// 그리드 정렬 처리 
		gfn_sortGrid(obj,nCell);
	}
}

/********************************************************************************
* 기      능   : 거래명세서 번호 더블클릭시 거래명세서 상세 화면조회
********************************************************************************/
function grd_list_OnCellDBClik(obj,nRow,nCell){
}


/********************************************************************************
* 기      능   : 데이터셋 값 변경 시 - 자재 상세 조회입력,Flag 처리 
********************************************************************************/
function ds_list_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{ 
    // Message 영역 초기화
	global.FRM_BOTTOM.img_msgType.imageId = "";
	global.FRM_BOTTOM.st_msg.value = "";
	switch( strColumnID )
	{
		case "FLAG"  :
		              break;
		case "BWTAR" :
		case "MATNR" :

					 if(cb_reqkind.value != "7" && SubStr(cb_reqkind.value,1,2) == "NR")
					 {
						gfn_showMsg("CW00041");
						return;
					 }
                     // 자재 내역을 비교하는 부부은 추후 검토 요지 있음.
					 if (length(obj.GetColumn(nRow, "MATNR")) > 0 && (length(obj.GetColumn(nRow,"MAKTX")) == 0 || strColumnID == "BWTAR" )) 
					 {
				    	ds_ma_cond.setColumn(0, "LGORT", G_VEND_CODE_R);
						ds_ma_cond.setColumn(0, "MATNR", toUpper(obj.GetColumn(nRow, "MATNR")));
						ds_ma_cond.SetColumn(0, "BUSSI", cb_bussi.value);
						
						if (length(ds_list.GetColumn(nRow,"BWTAR")) < 2 ) 
						{
						   //var str = "'RA','PA','HA'";
						   //ds_ma_cond.SetColumn(0, "BWTAR", str);
						   ds_ma_cond.SetColumn(0, "BWTAR", "RA','PA','HA");
						   //gfn_showAlert(ds_ma_cond.getColumn(0, "BWTAR")+"조건값1");
						}
						else
						{
                           ds_ma_cond.SetColumn(0, "BWTAR", ds_list.GetColumn(nRow,"BWTAR"));						
						}
										
						// 자재 내역 오류가 생성 되므로 주석 처리 2010.07.12
						// if (length(obj.GetColumn(nRow, "MTART")) > 0)
						// {
							// ds_ma_cond.setColumn(0, "MTART", toUpper(obj.GetColumn(nRow, "MTART")));
						// }

						ds_ma_cond.SetColumn(0,"INPUTROW", nRow);
						//it_showDs(ds_ma_cond);
												
						listRow = nRow;
			
						tit_clearActionInfo();
						// 저장 처리 
						tit_addSearchActionInfo("cs01:CS0101001A_S3");

						tit_callService(
							""
							,""
							, "ds_ma_cond=ds_ma_cond"
							, "ds_ma_list=ds_ma_list"
							, ""
							, "fn_setMatnr"
							, false
							, true);					 
					} 
					else// if (length(obj.GetColumn(nRow, "MATNR")) == 0)
					{
						fn_clearMatnr(nRow);
					}
					if (length(obj.GetOrgBuffColumn(nRow,"REQNO")) > 0)
					{
						obj.SetColumn(nRow, "FLAG", "U");
					}
					 break;
		case "REQSN" :
					if (obj.GetOrgBuffColumn(nRow,"REQSN") == varNewValue)
					{
						obj.SetColumn(nRow, "FLAG", "I");
					}
					break;
		case "CAUSECOD" :
						var r = ds_cause.FindRow("CODE",varNewValue);
						ds_list.SetColumn(nRow, "CAUSEGRP", ds_cause.GetColumn(r,"CODEGRUPPE"));
						ds_list.SetColumn(nRow, "CAUSETXT", ds_cause.GetColumn(r,"KURZTEXT"));
						if (length(obj.GetColumn(nRow, "REQNO")) > 0)
						{
							obj.SetColumn(nRow, "FLAG", "U");
						}
					break;
		case "PHENOCOD" :
						var r = ds_pheno.FindRow("CODE",varNewValue);
						obj.SetColumn(nRow, "PHENOGRP", ds_pheno.GetColumn(r,"CODEGRUPPE"));
						obj.SetColumn(nRow, "PHENOTXT", ds_pheno.GetColumn(r,"KURZTEXT"));
						if (length(obj.GetColumn(nRow, "REQNO")) > 0)
						{
							obj.SetColumn(nRow, "FLAG", "U");
						}
					break;
		case "POSID" :
						if ((cb_reqkind.value == "9" || cb_reqkind.value == "H") && length(ed_reqno.value) == 0 && length(obj.GetColumn(nRow, "POSID")) == 9)
						{
							ds_fm_cond.SetColumn(0,"POSID",obj.GetColumn(nRow, "POSID"));
							ds_fm_cond.SetColumn(0,"CUDAT",gfn_getCurrDate());
							tit_clearActionInfo();
							// 저장 처리 
							tit_addSearchActionInfo("cs01:CS0101001A_S9");
	
							tit_callService(
								""
								,""
								, "ds_fm_cond=ds_fm_cond"
								, "ds_fm_list=ds_fm_list"
								, ""
								, "fn_isFMafter"
								, false
								, true);	
						}
					break;
		case "REQKIND" :
						if (nRow == 0 && cb_reqkind.value != varNewValue)
						{
							gfn_showAlert("CW00114","첫행 변경은 ");
							ds_list.SetColumn(nRow,"REQKIND", cb_reqkind.value);
							return;	
						}
					break;
		default : 
					if (length(obj.GetColumn(nRow, "REQNO")) > 0)
					{
						obj.SetColumn(nRow, "FLAG", "U");
					}
				 break;
	}
	
}


function fn_setMatnr()
{
	if (ds_ma_list.rowcount > 0)
	{
	    
	    if (ds_ma_list.GetColumn(0,"LVORM") == 'X')
	    {
	   		gfn_showAlert("삭제 표기된 자재번호 입니다. 확인하십시요.");
			return;
     	}
	
		ds_list.fireevent = false;
		ds_list.SetColumn(ds_ma_cond.GetColumn(0,"INPUTROW"),"MATNR",ds_ma_list.GetColumn(0,"MATNR")); 
		ds_list.SetColumn(ds_ma_cond.GetColumn(0,"INPUTROW"),"MAKTX",ds_ma_list.GetColumn(0,"MAKTX")); 
		ds_list.SetColumn(ds_ma_cond.GetColumn(0,"INPUTROW"),"MTART",ds_ma_list.GetColumn(0,"MTART")); 
		ds_list.SetColumn(ds_ma_cond.GetColumn(0,"INPUTROW"),"MEINS",ds_ma_list.GetColumn(0,"MEINS")); 
		ds_list.SetColumn(ds_ma_cond.GetColumn(0,"INPUTROW"),"BANNAB",ds_ma_list.GetColumn(0,"BANNAB")); 
		ds_list.SetColumn(ds_ma_cond.GetColumn(0,"INPUTROW"),"PARLAB",ds_ma_list.GetColumn(0,"PARLAB")); 
		ds_list.SetColumn(ds_ma_cond.GetColumn(0,"INPUTROW"),"PARLAB1",ds_ma_list.GetColumn(0,"PARLAB1")); 
		ds_list.SetColumn(ds_ma_cond.GetColumn(0,"INPUTROW"),"POST1",ds_ma_list.GetColumn(0,"ZSITE_NM"));
		if ( parseInt(ds_list.GetColumn(ds_ma_cond.GetColumn(0,"INPUTROW"),"MENGE")) < 1)
		{
//			ds_list.SetColumn(ds_ma_cond.GetColumn(0,"INPUTROW"),"BWTAR","RA");
			ds_list.SetColumn(ds_ma_cond.GetColumn(0,"INPUTROW"),"MENGE",1);
		}

		 if (cb_reqkind.value == "3")
		 {
			// 평가 유형별 필터링
			if(ds_list.GetColumn(ds_ma_cond.GetColumn(0,"INPUTROW"), "MTART") == "PALB"){
				ds_bwtar_cd.Filter(" CODE=" +quote("PR"));
			} else if(ds_list.GetColumn(ds_ma_cond.GetColumn(0,"INPUTROW"), "MTART") == "HALB") {
				ds_bwtar_cd.Filter(" CODE=" +quote("HR"));
			} else {
				ds_bwtar_cd.Filter(" CODE=" +quote("RR"));
			} else {
				ds_bwtar_cd.FilterExpr = "";
			}
			// 반남품 설정
			ds_list.SetColumn(ds_ma_cond.GetColumn(0,"INPUTROW"),"BWTAR",ds_bwtar_cd.GetColumn(0,"CODE"));
		 } 
		 else 
		 {
			// 평가 유형별 필터링
			if(ds_list.GetColumn(ds_ma_cond.GetColumn(0,"INPUTROW"), "MTART") == "PALB"){
				ds_bwtar_cd.Filter(" CODE>=" +quote("PA") +"&&CODE<=" +quote("PR"));
			} else if(ds_list.GetColumn(ds_ma_cond.GetColumn(0,"INPUTROW"), "MTART") == "HALB") {
				ds_bwtar_cd.Filter(" CODE>=" +quote("HA") +"&&CODE<=" +quote("HR"));
			} else {
				ds_bwtar_cd.Filter(" CODE>=" +quote("RA") +"&&CODE<=" +quote("RR"));
			}
			//gfn_showAlert(ds_list.GetColumn(0,"BWTAR")+"1");
			// 최초 입력시 평가유형 초기값 입력
			if (length(ds_list.GetColumn(ds_ma_cond.GetColumn(0,"INPUTROW"),"BWTAR")) < 1) {
				if(ds_list.GetColumn(ds_ma_cond.GetColumn(0,"INPUTROW"), "MTART") == "PALB"){
					ds_list.SetColumn(ds_ma_cond.GetColumn(0,"INPUTROW"),"BWTAR","PA");
				} else if(ds_list.GetColumn(ds_ma_cond.GetColumn(0,"INPUTROW"), "MTART") == "HALB") {
					ds_list.SetColumn(ds_ma_cond.GetColumn(0,"INPUTROW"),"BWTAR","HA");
				} else {
					ds_list.SetColumn(ds_ma_cond.GetColumn(0,"INPUTROW"),"BWTAR","RA");
				}
				//gfn_showAlert(ds_list.GetColumn(0,"BWTAR")+"2");
					
			}
		}

        //gfn_showAlert(SubStr(ds_list.GetColumn(ds_ma_cond.GetColumn(0,"INPUTROW"), "BWTAR"),1)+"3");
		// 평가유형별 판매가 변경
		if(SubStr(ds_list.GetColumn(ds_ma_cond.GetColumn(0,"INPUTROW"), "BWTAR"),1) == "B"){
			ds_list.SetColumn(ds_ma_cond.GetColumn(0,"INPUTROW"),"SAMT1",ds_ma_list.GetColumn(0,"SAMT1")*0.4); 
		} else if (SubStr(ds_list.GetColumn(ds_ma_cond.GetColumn(0,"INPUTROW"), "BWTAR"),1) == "A") {
			ds_list.SetColumn(ds_ma_cond.GetColumn(0,"INPUTROW"),"SAMT1", ds_ma_list.GetColumn(0,"SAMT1")); 
		} else {
			ds_list.SetColumn(ds_ma_cond.GetColumn(0,"INPUTROW"),"SAMT1", ""); 
		}
		
		ds_list.fireevent = true;
		
	}
}


function fn_clearMatnr(nRow)
{
	if (ds_ma_list.rowcount > 0)
	{
		ds_list.SetColumn(nRow,"MATNR",""); 
		ds_list.SetColumn(nRow,"BWTAR","");
		ds_list.SetColumn(nRow,"MENGE",""); 
		ds_list.SetColumn(nRow,"MAKTX",""); 
		ds_list.SetColumn(nRow,"MTART",""); 
		ds_list.SetColumn(nRow,"MEINS",""); 
		ds_list.SetColumn(nRow,"BANNAB",""); 
		ds_list.SetColumn(nRow,"PARLAB",""); 
		ds_list.SetColumn(nRow,"PARLAB1",""); 
		ds_list.SetColumn(nRow,"POST1",""); 
		ds_list.SetColumn(nRow,"SAMT1",""); 
	}
}
/********************************************************************************
* 기      능   : 원프로젝트 팝업
********************************************************************************/
function btn_pjt_OnClick(obj)
{
	var arg = "pjt="+quote(ed_pjt.value);
	arg += " gbn=C";
	var pjt= null;
	pjt = gfn_openPopup("CS9601002A",true,arg);
	
	if (pjt != null && obj == btn_pjt) {
		ed_spt.value = "";
		ed_pjt.value = pjt[0];
		ed_spt.value = pjt[1];
		ed_nam.value = pjt[2];
		ufn_getProject('',pjt[0]);
    }
}

function cb_reqkindChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
    // Message 영역 초기화
	global.FRM_BOTTOM.img_msgType.imageId = "";
	global.FRM_BOTTOM.st_msg.value = "";

	if (ds_list.rowcount > 0)
	{
		for (var i = 0; i < ds_list.rowcount; i++)
		{
			if (ds_list.rowcount > 0 && ds_list.GetColumn(i,"REQKIND") != strCode)
			{
				obj.value = ds_list.GetColumn(0,"REQKIND");
				gfn_showMsg("CW00044");
				return;
			} 

		}
	}


	switch (strCode )
	{
		case '2' : 
		case '3' :
		case '4' : 
					ed_posid.Enable = false;
					bt_posid.Enable = false;
					
					cb_pspid.Enable = true;
                    btn_pjt.Enable = true;
//					ed_atype.Enable = true;
//					cal_zbepjeo.Enable = true;
//					cal_zbosuin.Enable = true;
//					cal_zoipsu.Enable = true;
//					ed_crenm.Enable = true;
					cal_credt.Enable = true;
					ed_temno.Enable = true;
					cal_workdt.Enable = true;
					ed_cellp.Enable = true;
					ed_rejtxt.Enable = true;
					tx_causetxt1.Enable = true;
					ed_crenm.value = G_USER_NAME;
					
					cal_credt.value = gfn_getCurrDate();
					
					// 협력사 인원정보
					ufn_getCreEmpl();
					
					// 버튼
					btn_ChengGu.Enable = false;
					btn_KyenJeok.Enable = false;
					
					break;
		case '8' :
					ed_posid2.Enable = true;
					btn_posid2.Enable = true;
					ed_posid.Enable = true;
					bt_posid.Enable = true;

					cb_pspid.Enable = false;
                    btn_pjt.Enable = false;
					ed_atype.Enable = false;
					cal_zbepjeo.Enable = false;
					cal_zbosuin.Enable = false;
					cal_zoipsu.Enable = false;
//					ed_crenm.Enable = false;
					cal_credt.Enable = false;
					ed_temno.Enable = false;
					cal_workdt.Enable = false;
					ed_cellp.Enable = false;
					ed_rejtxt.Enable = false;
					tx_causetxt1.Enable = false;
					ed_crenm.value = "";
					ed_pjt.text = "";

					// 버튼
					btn_ChengGu.Enable = true;
					btn_KyenJeok.Enable = true;

					break;
		// FM 재고 소진 청구 추가 13.08.13
		case '9' :
		case 'H' :
					ed_posid2.Enable = false;
					btn_posid2.Enable = false;

					ed_posid.Enable = true;
					bt_posid.Enable = true;
					cb_pspid.Enable = false;
                    btn_pjt.Enable = false;
					ed_atype.Enable = false;
					cal_zbepjeo.Enable = false;
					cal_zbosuin.Enable = false;
					cal_zoipsu.Enable = false;
//					ed_crenm.Enable = false;
					cal_credt.Enable = false;
					ed_temno.Enable = false;
					cal_workdt.Enable = false;
					ed_cellp.Enable = false;
					ed_rejtxt.Enable = true;
					tx_causetxt1.Enable = true;
					ed_crenm.value = "";
					ed_pjt.text = "";

					// 버튼
					btn_ChengGu.Enable = true;
					btn_KyenJeok.Enable = true;

		           break;

		default :  
					ed_posid2.Enable = false;
					btn_posid2.Enable = false;

					ed_posid.Enable = true;
					bt_posid.Enable = true;
					cb_pspid.Enable = false;
                    btn_pjt.Enable = false;
					ed_atype.Enable = false;
					cal_zbepjeo.Enable = false;
					cal_zbosuin.Enable = false;
					cal_zoipsu.Enable = false;
//					ed_crenm.Enable = false;
					cal_credt.Enable = false;
					ed_temno.Enable = false;
					cal_workdt.Enable = false;
					ed_cellp.Enable = false;
					ed_rejtxt.Enable = false;
					tx_causetxt1.Enable = false;
					ed_crenm.value = "";
					ed_pjt.text = "";

					// 버튼
					btn_ChengGu.Enable = true;
					btn_KyenJeok.Enable = true;
					
		           break;
	}
}

// 자재조회 화면 
function btn_matnr_OnClick(obj,nRow,nCell,strVal,nPivotIndex)
{
	if (nCell == 2)   // 자재 조회
	{
		fn_clearMatnr(nRow);
		
		var mat = gfn_openPopup("MM0901002A",true); 
		
		ds_list.SetColumn(nRow,"MATNR",mat);
		
		if (ds_list.GetColumn(nRow,"MATNR") == "0")
		{
			ds_list.SetColumn(nRow,"MATNR","");
		}
		else
		{
			tit_clearActionInfo();
			// 저장 처리 
			
			tit_addSearchActionInfo("cs01:CS0101001A_S3");
		
			tit_callService(
				""
				,""
				, "ds_ma_cond=ds_ma_cond"
				, "ds_ma_list=ds_ma_list"
				, ""
				, "fn_setMatnr"
				, false
				, true);
		}
	} 
	else if (nCell == 11) // 고객센터 접수 번호 조회
	{
		var hdcs = gfn_openPopup("CS9601008A",true);
				
		if (hdcs != null ) {
			ds_list.SetColumn(nRow,"ACPT_NUM",hdcs[0]);
		}
	}
}


/********************************************************************************
* 기      능   : Enable 처리
********************************************************************************/

function ufn_setEnable()
{
    ed_posid.Enable = false;
	bt_posid.Enable = false;
	cb_pspid.Enable = true;
	btn_pjt.Enable = true;
//	ed_atype.Enable = true;
//	cal_zbepjeo.Enable = true;
//	cal_zbosuin.Enable = true;
//	cal_zoipsu.Enable = true;
//	ed_crenm.Enable = true;
	cal_credt.Enable = true;
	ed_temno.Enable = true;
	cal_workdt.Enable = true;
	ed_cellp.Enable = true;
	ed_rejtxt.Enable = true;
	tx_causetxt1.Enable = true;
	ed_crenm.value = G_USER_NAME;

		// 버튼
	btn_ChengGu.Enable = false;
	btn_KyenJeok.Enable = false;
}

/********************************************************************************
* 기      능   : Disable 처리
********************************************************************************/

function ufn_setDisable()
{
    ed_posid.Enable = true;
	bt_posid.Enable = true;
	cb_pspid.Enable = false;
	btn_pjt.Enable = false;
	ed_atype.Enable = false;
	cal_zbepjeo.Enable = false;
	cal_zbosuin.Enable = false;
	cal_zoipsu.Enable = false;
//	ed_crenm.Enable = false;
	cal_credt.Enable = false;
	ed_temno.Enable = false;
	cal_workdt.Enable = false;
	ed_cellp.Enable = false;
	ed_rejtxt.Enable = false;
	tx_causetxt1.Enable = false;
	ed_crenm.value = "";
	
	// 버튼
	btn_ChengGu.Enable = true;
	btn_KyenJeok.Enable = true;
}


/********************************************************************************
* 기      능   : MMPR의 경우 문제점 내용 RFC호출
********************************************************************************/

function ds_list_OnRowPosChanged(obj,nOldRow,nRow)
{
	 switch (cb_reqkind.value )
	 {
		 case '3' : 
					if(ds_list.GetColumn(nRow, "MTART") == "PALB"){
						ds_bwtar_cd.Filter(" CODE=" +quote("PR"));
					} else if(ds_list.GetColumn(nRow, "MTART") == "HALB") {
						ds_bwtar_cd.Filter(" CODE=" +quote("HR"));
					} else if(ds_list.GetColumn(nRow, "MTART") == "ROH"){
						ds_bwtar_cd.Filter(" CODE=" +quote("RR"));
					} else {
						ds_bwtar_cd.FilterExpr = "";
					}
		          break;
		 default: 
					if(ds_list.GetColumn(nRow, "MTART") == "PALB"){
						ds_bwtar_cd.Filter(" CODE>=" +quote("PA") +"&&CODE<=" +quote("PR"));
					} else if(ds_list.GetColumn(nRow, "MTART") == "HALB") {
						ds_bwtar_cd.Filter(" CODE>=" +quote("HA") +"&&CODE<=" +quote("HR"));
					} else if(ds_list.GetColumn(nRow, "MTART") == "ROH"){
						ds_bwtar_cd.Filter(" CODE>=" +quote("RA") +"&&CODE<=" +quote("RR"));
					} else {
						ds_bwtar_cd.FilterExpr = "";
					}
				  break;
	 }

}

function ufn_isMMPR()
{
	if (cb_reqkind.Value != "2" && cb_reqkind.Value != "3" && cb_reqkind.Value != "4")
	{
		return false;
	}
	return true;
}

function ufn_rowIsMMPR(strEdit)
{
	if (cb_reqkind.Value != "2" && cb_reqkind.Value != "3" && cb_reqkind.Value != "4")
	{
		return 'none';
	}
	return strEdit;
}

function ufn_getCreEmpl()
{
	var nRow = ds_creEmpl.searchRow("CCSB1EPN == " + quote(G_USER_ID));
	
	if ( nRow >= 0 ) {
		ed_crenm.value = ds_creEmpl.getColumn(nRow, "CCSB1EPN");
		gfn_insertEmptyRow( ds_creEmpl, G_CODE_ALL);
		return;
	}

	tit_clearActionInfo();
	tit_addSearchActionInfo("cs01:CS0101001A_S4");
	
	tit_callService(
		""
		, ""
		, ""
		, "ds_creEmpl=ds_creEmpl"
		, ""
		, ""
		, true);				
	
	var nRow = ds_creEmpl.searchRow("CCSB1EPN == " + quote(G_USER_ID));

	if ( nRow >= 0 ) {
		ed_crenm.value = ds_creEmpl.getColumn(nRow, "CCSB1EPN");
		gfn_insertEmptyRow( ds_creEmpl, G_CODE_ALL);
	}
}


function ufn_clearInput()
{
    ed_posid.value = "";
	bt_posid.value = "";
	ed_pjt.text = "";
	cb_pspid.value = "";
	ed_atype.value = "";
	cal_zbepjeo.value = "";
	cal_zbosuin.value = "";
	cal_zoipsu.value = "";
	ed_crenm.value = "";
	cal_credt.value = "";
	ed_temno.value = "";
	cal_workdt.value = "";
	ed_cellp.value = "";
	ed_rejtxt.value = "";
	tx_causetxt1.value = "";
	ed_crenm.value = "";
	ed_acpt_num.value = "";
}



function ufn_callKyunJeok(obj)
{
	if (!gfn_isNull(ed_reqno,true, "청구번호",ed_reqno))
	{
		if (ds_list.rowcount < 1)
		{
			gfn_showAlert("CW00054");
			return;
		}
		if (ds_list.GetColumn(0,"REQKIND") == '8' || 
		   (ds_list.GetColumn(0,"RECE_F") == '6' && (ds_list.GetColumn(0,"REQKIND") != '2' || ds_list.GetColumn(0,"REQKIND") != '4')))
		{
			gfn_showMsg("CW00053","견적");
//			return;
		}
		var arg = "fa_reqno=" + quote(ed_reqno.Value) + " fa_qtnum =" + quote(ds_list.GetColumn(0,"QTNUM"));
		
		//2015.01.09 이종석 기타자재청구에서는 유상(1), 수리공사(7), 재청구(8)는 수행할 수 없도록 함
		//gfn_openWin("CS3101001A", arg);	
	}
	else
	{
		return;
	}
}

function ufn_SearchMMPR(obj,nRow,nCell,nX,nY,nPivotIndex)
{
	if(length(ds_list.GetColumn(nRow,"JQPRNUM")) > 0)
	{
		gfn_openPopup("CS0101001B", true, "fa_jqprnum=" + quote(ds_list.GetColumn(nRow,"JQPRNUM")), 610, 523);
	}
}

function ufn_getProject(obj,strText)
{
	if (length(strText) > 0)
	{
		ds_pscond.SetColumn(0,"POSID", strText);
		
		tit_clearActionInfo();
		tit_addSearchActionInfo("cs01:CS0101001A_S8");
		
		tit_callService(
			""
			, ""
			, "ds_pscond=ds_pscond"
			, "ds_pspid_cd=ds_pspid_cd"
			, ""
			, "fn_afterProject"
			, true);		
	}
}

function fn_afterProject()
{
	if ( ds_list.rowCount() > 0 ) {
		cb_pspid.value = ds_list.GetColumn(0,"HOGI");
	}
	else
	{
		cb_pspid.Index = 0;
		ufn_setData("","","","","0");
	}
}


function ufn_setData(obj,strCode,strText,nOldIndex,nNewIndex)
{
	ed_atype.Text = ds_pspid_cd.GetColumn(nNewIndex,"ZSPEC1");
	cal_zbepjeo.Value = ds_pspid_cd.GetColumn(nNewIndex,"ZQEGEMSA");
	cal_zoipsu.Value = ds_pspid_cd.GetColumn(nNewIndex,"ZOIPSU");
	cal_zbosuin.Value = ds_pspid_cd.GetColumn(nNewIndex,"ZBOSUIN");
	if (length(cal_zoipsu.Value) ==0 && length(cal_zbosuin.Value) > 0)
	{
		cal_zoipsu.Value = cal_zbosuin.Value;
	}
	ed_spec.Text = ds_pspid_cd.GetColumn(nNewIndex,"ZSPEC2");
}

function ufn_OnCharChanged(obj,strPreText,strPostText)
{
	if (length(strPostText) > 0)
	{
		ds_pscond.SetColumn(0,"POSID", strPostText);
		
		ufn_clearInput();
		tit_clearActionInfo();
		tit_addSearchActionInfo("cs01:CS0101001A_S8");
		
		tit_callService(
			""
			, ""
			, "ds_pscond=ds_pscond"
			, "ds_pspid_cd=ds_pspid_cd"
			, ""
			, "fn_afterProject"
			, true);		
	}	
}

// 청구번호 검색
function ufn_getReqNo(obj)
{
	var reqcond = null;
	reqcond = gfn_openPopup("MM0901003A", true);
	
    if (reqcond !=null) {
		ed_reqno.value = reqcond[0];
		cal_reqdate.Value = reqcond[1];
		cb_reqkind.Value = reqcond[2];
		cb_bussi.Value = reqcond[3];
		fn_query();
    }
}


function btn_Hogi_OnClick(obj)
{
	var posid= null;
	posid = gfn_openPopup("CS9601005A", true);

    if (posid !=null && obj == btn_posid2) {
		ed_posid2.value = posid[0];
    }
    else if (posid != null){
		ed_posid.value = posid[0];
    }
    
   	//인건비 STATUS확인 표기 이호영
	//gfn_showalert(ds_list.GetColumn(0,"STATUS"));    
}


function btn_Posid2_OnClick(obj)
{
	var posid= null;
	posid = gfn_openPopup("CS9601006A", true);

    if (posid !=null && obj == btn_posid2) {
		ed_posid2.value = posid[0];
    }
    else if (posid != null){
		ed_posid.value = posid[0];
    }
    
   	//인건비 STATUS확인 표기 이호영
   	//gfn_showalert("팝업값"+posid[1]);
   	ds_list.setColumn(ds_list.row, "STATUS", posid[1]);
   	//gfn_showalert(ds_list.GetColumn(ds_list.row,"STATUS"));
    //gfn_showalert(ds_list.row);
    //gfn_showalert(ds_list.GetColumn(0,"STATUS"));
    //trace(ds_list.SaveXML());
}
function ufn_callCheongGu(obj)
{
	if (ds_list.rowcount > 0 && ( (ds_list.GetColumn(ds_list.row,"RECE_F") != "0" && ds_list.GetColumn(ds_list.row,"RECE_F") != "5") || length(ds_list.GetColumn(ds_list.row,"QTNUM")) > 0 ))
	{
		gfn_showMsg("CW00017");
		return;
	}

	var arg = "";
	if (cb_reqkind.value = "8") {
		arg = "fa_pjt ="+ quote(SubStr(ed_posid2.value,0,6));
	} else if (cb_reqkind.Value == "2" || cb_reqkind.Value == "3" || cb_reqkind.Value == "4") {
		arg = "fa_pjt ="+ quote(SubStr(ed_pjt.value,0,6));
	} else {
		arg = "fa_pjt ="+ quote(SubStr(ed_posid.value,0,6));
	}
	arg += " fa_kind ="+ quote(cb_reqkind.value);
		
	gfn_openPopup("CS0101001C", true, arg);
}


function fn_isFMafter()
{
	if (ds_fm_list.rowcount == 0)
	{
		ds_list.fireevent = false;
		gfn_showAlert("CW00206");
		ed_posid.value = "";
		ds_list.fireevent = true;
	}
}




function ed_reqno_OnChanged(obj,strText)
{
	
}

function ufn_serno_in(obj)
{

	var serno = null;
//	serno = gfn_openPopup("MM0901005A", true);
	var arg = "nRow=" + quote(ds_list.currow);

    if (ds_list.GetColumn(ds_list.currow,"BANNAB") == 1)
    {
		if (length(ds_list.GetColumn(ds_list.currow,"INSMSNO")) > 0 &&
		    length(ds_list.GetColumn(ds_list.currow,"MBINSMSNO")) > 0)
		{
			alert("조치 SER.NO가 이미 입력되어 있습니다.");
		}
		else
		{
			gfn_openPopup("MM0901005A", true, arg);		
		}
		
		// if (length(ds_list.GetColumn(ds_list.currow,"INSMSNO")) == 0)
		// {
			// gfn_openPopup("MM0901005A", true, arg);
		// }
		// else
		// {
			// alert("조치 SER.NO가 이미 입력되어 있습니다.");
		// }

	}
    else
    {
        alert("반납 대상만 SER.NO입력 가능합니다.");
    }
    
	//alert(length(ds_list.GetColumn(ds_list.currow,"INSMSNO")));

/*	
    if (serno !=null)
     {
		//ed_reqno.value = serno[0];
		//cal_reqdate.Value = serno[1];

        ds_list.SetColumn(nRow,"INSMSNO",serno[0]);
        ds_list.SetColumn(nRow,"MBINSMSNO",serno[1]);
     }
*/
}

function ufn_serno_del(obj)
{
	var arg = "nRow=" + quote(ds_list.currow);
	ds_list.SetColumn(ds_list.currow, "INSMSNO", "");
	ds_list.SetColumn(ds_list.currow, "MBINSMSNO", "");
}
]]></Script>
</Window>