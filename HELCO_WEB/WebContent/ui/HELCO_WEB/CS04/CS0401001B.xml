<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="216" Id="CS0401001B" Left="8" OnKeyDown="gfn_EnterInForm" OnLoadCompleted="fn_OnLoadCompleted" PidAttrib="7" Title="보수협력사&#32;기안&#32;접수" Top="8" Ver="1.0" Width="408" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_cond">
				<Contents>
					<colinfo id="DOCNO" size="30" summ="default" type="STRING"/>
					<colinfo id="DOCKIND" size="3" summ="default" type="STRING"/>
					<colinfo id="APPGUBN" size="3" summ="default" type="STRING"/>
					<record>
						<APPGUBN></APPGUBN>
						<DOCKIND></DOCKIND>
						<DOCNO></DOCNO>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_dockind">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<colinfo id="DTEXT1" size="256" summ="default" type="STRING"/>
					<colinfo id="DTEXT2" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_head">
				<Contents>
					<colinfo id="MANDT" size="256" summ="default" type="STRING"/>
					<colinfo id="CS649_DKN" size="256" summ="default" type="STRING"/>
					<colinfo id="CS649_DOC" size="256" summ="default" type="STRING"/>
					<colinfo id="CS649_STA" size="256" summ="default" type="STRING"/>
					<colinfo id="CS649_NAM" size="256" summ="default" type="STRING"/>
					<colinfo id="CS649_BNU" size="256" summ="default" type="STRING"/>
					<colinfo id="CS649_LIF" size="256" summ="default" type="STRING"/>
					<colinfo id="CS649_DAT" size="256" summ="default" type="STRING"/>
					<colinfo id="CS649_TIM" size="256" summ="default" type="STRING"/>
					<colinfo id="CS649_TXT" size="256" summ="default" type="STRING"/>
					<colinfo id="CS649_FNA" size="256" summ="default" type="STRING"/>
					<colinfo id="CS649_FSZ" size="256" summ="default" type="STRING"/>
					<colinfo id="FNAM" size="256" summ="default" type="STRING"/>
					<colinfo id="FSIZE" size="256" summ="default" type="STRING"/>
					<colinfo id="FILE_PATH" size="256" summ="default" type="STRING"/>
					<colinfo id="FILE_STATE" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list">
				<Contents>
					<colinfo id="APDATE" size="24" summ="default" type="STRING"/>
					<colinfo id="APDESC" size="0" summ="default" type="STRING"/>
					<colinfo id="APDPT1" size="24" summ="default" type="STRING"/>
					<colinfo id="APDPT1_N" size="60" summ="default" type="STRING"/>
					<colinfo id="APIRUM" size="60" summ="default" type="STRING"/>
					<colinfo id="APNUM" size="24" summ="default" type="STRING"/>
					<colinfo id="APPGUBN" size="6" summ="default" type="STRING"/>
					<colinfo id="APRNK" size="60" summ="default" type="STRING"/>
					<colinfo id="APTIM" size="18" summ="default" type="STRING"/>
					<colinfo id="DOCKIND" size="3" summ="default" type="STRING"/>
					<colinfo id="DOCNO" size="30" summ="default" type="STRING"/>
					<colinfo id="DOCSEQ" size="6" summ="default" type="STRING"/>
					<colinfo id="SEQNO" size="6" summ="default" type="STRING"/>
					<colinfo id="SEQSTAT" size="3" summ="default" type="STRING"/>
					<colinfo id="TELH" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_seqstat">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_draft">
				<Contents>
					<colinfo id="DEPT_N" size="60" summ="default" type="STRING"/>
					<colinfo id="DPT1" size="6" summ="default" type="STRING"/>
					<colinfo id="DPT1_N" size="60" summ="default" type="STRING"/>
					<colinfo id="IRUM" size="36" summ="default" type="STRING"/>
					<colinfo id="PSNO" size="30" summ="default" type="STRING"/>
					<colinfo id="RANK" size="6" summ="default" type="STRING"/>
					<colinfo id="RANK_N" size="36" summ="default" type="STRING"/>
					<colinfo id="TELH" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_stat">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list_0">
				<Contents>
					<colinfo id="APDATE" size="24" summ="default" type="STRING"/>
					<colinfo id="APDESC" size="0" summ="default" type="STRING"/>
					<colinfo id="APDPT1" size="24" summ="default" type="STRING"/>
					<colinfo id="APDPT1_N" size="60" summ="default" type="STRING"/>
					<colinfo id="APIRUM" size="60" summ="default" type="STRING"/>
					<colinfo id="APNUM" size="24" summ="default" type="STRING"/>
					<colinfo id="APPGUBN" size="6" summ="default" type="STRING"/>
					<colinfo id="APRNK" size="60" summ="default" type="STRING"/>
					<colinfo id="APTIM" size="18" summ="default" type="STRING"/>
					<colinfo id="DOCKIND" size="3" summ="default" type="STRING"/>
					<colinfo id="DOCNO" size="30" summ="default" type="STRING"/>
					<colinfo id="DOCSEQ" size="6" summ="default" type="STRING"/>
					<colinfo id="SEQNO" size="6" summ="default" type="STRING"/>
					<colinfo id="SEQSTAT" size="3" summ="default" type="STRING"/>
					<colinfo id="TELH" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_mms">
				<Contents>
					<colinfo id="TRAN_PHONE" size="256" type="STRING"/>
					<colinfo id="TRAN_CALLBACK" size="256" type="STRING"/>
					<colinfo id="TRAN_MSG" size="256" type="STRING"/>
					<colinfo id="TRAN_ETC1" size="256" type="STRING"/>
					<colinfo id="TRAN_ETC2" size="256" type="STRING"/>
					<colinfo id="TRAN_ID" size="256" type="STRING"/>
					<colinfo id="GBN" size="3" type="STRING"/>
					<colinfo id="SUBJECT" size="256" type="STRING"/>
				</Contents>
			</Dataset>
		</Datasets>
		<Shape BKColor="user12" Bottom="74" Height="26" Id="Shape1" Left="9" LineColor="user13" Right="400" TabOrder="9" Top="48" Type="Rectangle" Width="391"></Shape>
		<Div Height="36" Id="div_btn" TabOrder="3" Text="Div0" Url="WB01::CommBtnForm.xml" Width="408">
			<Contents></Contents>
		</Div>
		<Image Height="36" Id="Image1" ImageID="form_bl_title_main" Left="8" TabOrder="1" Top="-1" Width="15"></Image>
		<Static Color="user5" Font="굴림,10,Bold" Height="20" Id="Static0" Left="28" TabOrder="2" Text="MMPR&#32;조회" Top="8" VAlign="Middle" Width="192"></Static>
		<Static Border="None" Color="user7" Font="굴림,9" Height="20" Id="st_desc" Left="9" TabOrder="4" Text="※&#32;의견" Top="80" VAlign="Middle" Width="56"></Static>
		<TextArea Border="Flat" Column="APDESC" Height="56" Id="tx_apdesc" Left="8" MaxLength="100" Style="sty_ipt_form" TabOrder="5" Top="96" VScroll="TRUE" Width="392"></TextArea>
		<Static Align="Right" Height="24" Id="Static16" Left="10" Style="sty_lb_form_basic" TabOrder="6" Text="문서번호&#32;" Top="49" VAlign="Middle" Width="70"></Static>
		<Edit Border="Flat" Column="DOCNO" Enable="FALSE" Height="20" Id="ed_docno" Left="85" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="7" Top="51" Width="120"></Edit>
		<Static Align="Right" Height="24" Id="Static18" Left="211" Style="sty_lb_form_basic" TabOrder="8" Text="문서구분&#32;" Top="49" VAlign="Middle" Width="70"></Static>
		<Combo Border="Flat" CodeColumn="CODE" Column="DOCKIND" DataColumn="CODE_NAME" Enable="FALSE" Height="20" Id="cb_dockind" InnerDataset="ds_dockind" Left="284" Style="sty_ipt_search" TabOrder="10" Top="50" Width="116"></Combo>
		<Static Border="None" Color="user7" Font="굴림,9" Height="20" Id="Static2" Left="8" TabOrder="11" Text="※&#32;첨부&#32;(최대&#32;3Mb)" Top="163" VAlign="Middle" Width="120"></Static>
		<Edit Border="Flat" Height="20" Id="ed_fileName" Left="8" LeftMargin="4" Readonly="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="12" Top="184" Width="328"></Edit>
		<Button Height="18" Id="btn_openFile" ImageID="btn_icon_polder" Left="341" OnClick="btn_openFile_OnClick" TabOrder="13" Text="Button0" Top="186" Width="18"></Button>
		<Button Height="18" Id="btn_deleteFile" ImageID="btn_icon_trash" Left="361" OnClick="btn_deleteFile_OnClick" TabOrder="14" Text="Button0" Top="186" Width="18"></Button>
		<File Bottom="280" Height="24" Id="f_tmp" Left="327" Right="351" TabOrder="25" Top="256" Width="24"></File>
		<FileDialog Bottom="280" Height="24" Id="fileDialog" Left="304" Right="328" TabOrder="26" Top="256" Width="24"></FileDialog>
		<Button Enable="FALSE" Height="18" Id="btn_saveFile" ImageID="btn_icon_save" Left="381" OnClick="btn_saveFile_OnClick" TabOrder="16" Text="Button0" Top="186" Width="18"></Button>
		<CyHttpFile Height="24" Id="httpFile" Left="352" Top="256" Width="24"></CyHttpFile>
		<FileDialog Bottom="280" FilePath="c:\" Height="24" Id="saveDialog" Left="280" Right="304" TabOrder="15" Top="256" Type="Save" Width="24"></FileDialog>
	</Form>
	<Script><![CDATA[﻿﻿﻿﻿﻿﻿﻿﻿/*
 ******************************************************************************************
 * 기      능   : 
 * 작  성  자   : 
 * 작성  일자   : 
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
#include "LIB::commons.js";	// 공통 스크립트 
//=========================================================================================
// [ PART 1 ]
// Form에서 사용될 전역변수를 선언
// FORM에서 사용되는 전역변수는 대문자로 작성하며, F_XXX 의 형태를 갖도록 한다. 
//=========================================================================================
var F_SIZE = 1024 * 1024 * 3;	// 최대3mb
var file = "";
var fileSize = "";
var completeFlag = false;		//20141203이종석:결재상신 완료 플래그 세팅
var sendbackFlag = false;		// 20141211 MG.J:결재반송 결과 플래그
var sendbackClick = "N";		// 20141211 MG.J:반송버튼클릭여부
var completeArr   = "";			// 2014.12.18 MG.J:결재처리결과 리턴값.
//=========================================================================================
// [ PART 2 ]
// Form Loading / Unloading 시 작업 정의
//=========================================================================================
function fn_OnLoadCompleted(obj) {
	// Form 로드 이벤트 맨 첫줄에 기술 
	gfn_initForm();

    // 구분 코드값 가져오기
    var codeArr = ["WBAP_DOCKIND","WBAP_STAT","WBAP_SEQSTAT"];
    var dsObjArr = [ds_dockind,ds_stat,ds_seqstat];
    var addTypeArr = [G_CODE_NONE,G_CODE_NONE,G_CODE_NONE];
    
    arr = ["",""];
    completeArr = ["",""];
    gfn_searchCommCode(codeArr, dsObjArr, addTypeArr,true);
    
    // 문서번호
    // 문서 구분 설정
    
    if(fa_docno != null && fa_dockind != null)
    {
		//alert(fa_docno+"---"+fa_dockind);
		ds_cond.SetColumn(0,"DOCNO", fa_docno);
		ds_cond.SetColumn(0,"DOCKIND", fa_dockind);  
		  
		ed_docno.value = fa_docno;
		cb_dockind.value = fa_dockind;
    } else {
        gfn_showAlert("CW00153");
		return;
    }
    tit_clearActionInfo();
	tit_addSearchActionInfo("cs04:CS0401001B_S1");
	
	tit_callService(
         ""
         , ""
         , "ds_cond=ds_cond"
         , "ds_head=ds_head"
         , ""
         , "fn_afterQuery"
         , true);

}
/********************************************************************************
* 기      능   : 공통코드가 조회된 후의 Callback 함수 
********************************************************************************/
function fn_completeInit(sCode, sDsObj, sCodeType) {
}
/********************************************************************************
* 기      능   : form UnloadCompleted 
********************************************************************************/
function fn_OnUnloadCompleted(obj) {
	return gfn_isFormUnload(obj);
}
//=========================================================================================
// [ PART 3 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,form닫기)
//=========================================================================================
/********************************************************************************
* 기      능   : 조회 1
********************************************************************************/
function fn_query() {
	 tit_clearActionInfo();
	 tit_addSearchActionInfo("cs04:CS0401001B_S3", null, true);
	
	 tit_callService(
         ""
         , ""
         , "ds_cond=ds_cond"
         , "ds_head=ds_head"
         , ""
         , "fn_afterQuery"
         , true);
}
/********************************************************************************
* 기      능   : 삽입 20
********************************************************************************/
function fn_insert() {
	// 그리드에 row 추가 
	//var newRow = gfn_addGridRow(grd_list, -1, "FLAG");
}
/********************************************************************************
* 기      능   : Delete 
********************************************************************************/
function fn_delete() {

}

/********************************************************************************
* 기      능   : 닫기  
********************************************************************************/
function fn_close() {
	//상신완료 플래그를 확인하여 상신이 완료된 상태이면 "S", 상신 없이 저장이면 ""를 리턴.
	var complete = "";
	if(completeFlag) {
		complete = "S";
	} else {
		complete = "";
	}
	
	//반송완료 플래그를 확인하여 반송이 완료된 상태이면 "S", 반송 없이 저장이면 ""를 리턴.
	var sendback = "";
	if(sendbackFlag) { 
		sendback = "S";
	} else {
		sendback = "";
	}
	
	var completeArr = [complete, sendback];
	close(completeArr);
}
/********************************************************************************
* 기      능   : 액셀  
********************************************************************************/
// function fn_excel() {
	// Excel Export 
	// gfn_saveToExcel(grd_list, true );
// }

/********************************************************************************
* 기      능   : 저장 
********************************************************************************/
function fn_save() {

	if(length(fa_posid) > 0 ) {
		ds_head.SetColumn(0,"POSID"    ,fa_posid); // 프로젝트 	
	}

	ds_head.SetColumn(0,"CS649_TXT",tx_apdesc.value); //기안내용
	
	if (!gfn_isChangeDs(ds_head, false)) {
		// CW00005=변경된 정보가 없습니다.
		gfn_showAlert('CW00005');
		return;
	}
	
	//(수리부품견적)수주금액 1천만원 초과 건 계약서첨부 필수	2016.06 yar
	//수리공사,시스템공사 수주문서 계약서첨부 필수 				2016.11 yar

	if((fa_reqkind == 7 || fa_reqkind == "S") && length(fa_fna) == 0 && length( ed_fileName.value ) == 0 && fa_doc == "R02" )
	{
		gfn_showAlert("CW10025", "계약서를 첨부해주시길 바랍니다.<br>(수리공사,시스템공사 계약서 첨부 필수)");
		return;
	}
	if( fa_workstage == "3" && length( ed_fileName.value) == 0 )
	{
		gfn_showAlert("CW10025", "계약서를 첨부해주시길 바랍니다.<br>(재청구 시 계약서 첨부 필수)");
		return;
	}
/*	
	// 무상발주 승인 건에 대해 첨부 파일 확인 
	if( fa_dockind == "9" && length( ed_fileName.value) == 0 )
	{
		gfn_showAlert("CW10025", "무상확인서를 첨부해주시길 바랍니다.");
		return;
	}
*/	
	if(ds_head.GetRowType(0)=="update"){
		if(length( ed_fileName.value ) > 0 && length(ds_head.getColumn(0, "FILE_STATE"))>0 ) {
			// 첨부 파일 처리 
			var arr = tit_fileWrite(httpFile, "AP", ds_head.getColumn(0, "FILE_PATH"), ds_head.getColumn(0, "CS649_FNA"), "", "", "" );  
			// 처리 결과 확인하기 
			if( arr[0] == "S" ) {
				// 성공 
				ds_head.setColumn(0, "CS649_FNA", arr[2]);	// 파일 명 
				ds_head.setColumn(0, "CS649_FSZ", fileSize);
			} else {
				gfn_showAlert( arr[1] );
				return;
			}
		} 

		tit_clearActionInfo();
		
		//저장 처리 
		tit_addMultiActionInfo("cs04:CS0401001B_U1");
				
		tit_callService(
			""
			, ""
			, "ds_head=ds_head:A"
			, ""
			, ""
			, "fn_afterSave"
			, true
			, true
			, true);

		
	} else {
		ds_head.SetColumn(0,"MANDT",G_MANDT);  //클라이언트
		ds_head.SetColumn(0,"CS649_DKN",cb_dockind.value);  //문서종류
		ds_head.SetColumn(0,"CS649_DOC",ed_docno.value); //문서번호
		ds_head.SetColumn(0,"CS649_STA","I"); //상태
		ds_head.SetColumn(0,"CS649_NAM",G_VEND_NAME); //공급업체 또는 채권자의 계정 번호
		ds_head.SetColumn(0,"CS649_BNU",G_USER_ID); //사원번호
		ds_head.SetColumn(0,"CS649_LIF",G_USER_NAME); //이름 
		//ds_head.SetColumn(0,"CS649_TXT",tx_apdesc.value); //기안내용

		//alert(ds_head.getColumn(0, "FILE_PATH"));
		if(length( ed_fileName.value ) > 0) {
			// 첨부 파일 처리 
			var arr = tit_fileWrite(httpFile, "AP", ds_head.getColumn(0, "FILE_PATH"), ds_head.getColumn(0, "CS649_FNA"), "", "", "" );  
			// 처리 결과 확인하기 
			if( arr[0] == "S" ) {
				// 성공 
				ds_head.setColumn(0, "CS649_FNA", arr[2]);	// 파일 명 
				ds_head.setColumn(0, "CS649_FSZ", fileSize);
			} else {
				gfn_showAlert( arr[1] );
				return;
			}
		} 
		else {
			ds_head.setColumn(0, "CS649_FNA", "");
			ds_head.setColumn(0, "CS649_FSZ", 0);
		}
	
		tit_clearActionInfo();
		
		//저장 처리 
		tit_addMultiActionInfo("cs04:CS0401001B_I1");
				
		tit_callService(
			""
			, ""
			, "ds_head=ds_head:A"
			, ""
			, ""
			, "fn_afterSave"
			, true
			, true
			, true);
		}
	}
}

//=========================================================================================
// [ PART 4]
// Callback 함수 정의 : callback 함수명은 메인 함수의 fn_xxxx() 에서 xxxx 부분은 fn_afterXXXX()
// 형태가 되도록 작성 
//=========================================================================================
/********************************************************************************
* 기      능   : 조회 Callback  
********************************************************************************/
function fn_afterQuery(errCode, errMsg) {
	if(ds_head.rowcount > 0)
	{
		tx_apdesc.value= ds_head.getColumn(0, "CS649_TXT");
		ed_fileName.value = ds_head.getColumn(0, "CS649_FNA");
		
		disableFile();
		
	} 
	else
	{
		ds_head.ClearData();
		ds_head.AddRow();
		
		ds_head.SetColumn(0,"CS649_DKN",cb_dockind.value);  //문서종류
		ds_head.SetColumn(0,"CS649_DOC",ed_docno.value); //문서번호
	}
	
}

/********************************************************************************
* 기      능   : 저장 Callback  
********************************************************************************/
function fn_afterSave(errCode, errMsg) {
	if ( errCode!= 0 ) {
		
	} else {
		completeFlag = true;
		
		fn_close();
	}

}
//=========================================================================================
// [ PART 5 ]
// Detail Process Event 정의 ( User Define function )
// 사용자 정의 함수는 ufn_xxxx() 형태로 작성 
//=========================================================================================
/********************************************************************************
* 기      능   : 사용자 정의 함수  
********************************************************************************/
function ufn_userfunction() {

}

//=========================================================================================
// [ PART 6 ]
// component Event 정의 : 각 Component 별 이벤트 
//=========================================================================================
/********************************************************************************
* 기      능   : 그리드 헤더 클릭시 정렬 처리 
********************************************************************************/
function grd_list_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
{

}

function btn_openFile_OnClick(obj)
{
	fileDialog.open();
	
	if ( length(fileDialog.FilePath) == 0 
		|| length( fileDialog.FileName ) == 0 ) {
		return;
	}

	fileSize = f_tmp.GetLength(fileDialog.FilePath + "\\" + fileDialog.FileName );
	if ( fileSize <= 0 ) {
		gfn_showAlert("CW00048");
		return;
	}
	
	if ( fileSize > toNumber(F_SIZE)) {
		gfn_showAlert("CW00047", "3 Mbytes" );	
		return;
	}
	
	ds_head.setColumn(0, "CS649_FNA", fileDialog.FileName);
	ds_head.setColumn(0, "CS649_FSZ", fileSize);
	ds_head.setColumn(0, "FILE_PATH", fileDialog.FilePath);
	ds_head.setColumn(0, "FILE_STATE", "I");

	
	//alert(fileDialog.FileName);
	ed_fileName.value = fileDialog.FilePath + "\\" + fileDialog.FileName;

}


/********************************************************************************
* 기      능   : 첨부파일 삭제 
********************************************************************************/
function btn_deleteFile_OnClick(obj)
{
	ed_fileName.value = "";
	ed_fileName.Enable = true;
	btn_openFile.Enable = true;
	btn_deleteFile.Enable = true;
	btn_saveFile.Enable = false;

	ds_head.setColumn(0, "CS649_FNA", "");
	ds_head.setColumn(0, "CS649_FSZ", 0);
	ds_head.setColumn(0, "FILE_PATH", "");
}


/********************************************************************************
* 기      능   : 첨부파일 저장  
********************************************************************************/
function btn_saveFile_OnClick(obj)
{
	saveDialog.FileName = ed_fileName.value;
    saveDialog.open();
    if ( length(saveDialog.FilePath) == 0 ) {
        return;
    }

	var arr = tit_fileRead(httpFile, "AP"
        , ds_head.getColumn(0, "CS649_FNA")
        , saveDialog.FilePath, saveDialog.FileName);
        
    //alert(arr[0]);
    if ( arr[0] == 'E' ) {
        gfn_alert("Download failed : \n" + arr[1] );
    }
}

function enableFile()
{
	ed_fileName.Enable = true;
	btn_openFile.Enable = true;
	btn_deleteFile.Enable = true;
	btn_saveFile.Enable = false;
}

function disableFile()
{
	//alert("------");
	ed_fileName.Enable = false;
	btn_openFile.Enable = false;
	btn_deleteFile.Enable = true;
		
	// 파일 정보 보여주기 
	if ( length( ds_head.getColumn(0, "CS649_FNA") ) > 0 ) {
		ed_fileName.value = tit_getLocalFileName(ds_head.getColumn(0, "CS649_FNA")) ;
		btn_saveFile.enable = true;
	}
}
function CS0401001B_OnUnloadCompleted(obj)
{
	// 2014.12.18 MG.J: 화면을 닫기버튼이외로 닫았을 경우(단, 시스템 강제종료제외)
	// 결재처리결과를 리턴받기위해서 처리.
	fn_close();
}
]]></Script>
</Window>