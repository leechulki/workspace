<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="562" Id="BS0201001A" Left="8" OnLoadCompleted="fn_OnLoadCompleted" OnUnloadCompleted="fn_OnUnloadCompleted" PidAttrib="7" Title="견적의뢰&#32;정보&#32;입력" Top="8" Ver="1.0" Width="978" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_cond">
				<Contents>
					<colinfo id="KUNNR" size="30" summ="default" type="STRING"/>
					<colinfo id="INELN" size="255" summ="default" type="STRING"/>
					<colinfo id="INSEQ" size="256" summ="default" type="STRING"/>
					<record>
						<INELN></INELN>
						<INSEQ></INSEQ>
						<KUNNR></KUNNR>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list">
				<Contents>
					<colinfo id="FLAG" size="3" summ="default" type="STRING"/>
					<colinfo id="AEDAT" size="24" summ="default" type="STRING"/>
					<colinfo id="AENAM" size="36" summ="default" type="STRING"/>
					<colinfo id="AEZZT" size="18" summ="default" type="STRING"/>
					<colinfo id="CHDAT" size="24" summ="default" type="STRING"/>
					<colinfo id="CHECK" size="1" summ="default" type="STRING"/>
					<colinfo id="ERDAT" size="24" summ="default" type="STRING"/>
					<colinfo id="ERNAM" size="36" summ="default" type="STRING"/>
					<colinfo id="ERZZT" size="18" summ="default" type="STRING"/>
					<colinfo id="GBN" size="0" summ="default" type="STRING"/>
					<colinfo id="IMEMP" size="60" summ="default" type="STRING"/>
					<colinfo id="INCO1" size="9" summ="default" type="STRING"/>
					<colinfo id="INELN" size="33" summ="default" type="STRING"/>
					<colinfo id="INLAND" size="9" summ="default" type="STRING"/>
					<colinfo id="INPORT" size="60" summ="default" type="STRING"/>
					<colinfo id="INSEQ" size="9" summ="default" type="STRING"/>
					<colinfo id="KUNNR" size="30" summ="default" type="STRING"/>
					<colinfo id="KUNNR_NM" size="60" summ="default" type="STRING"/>
					<colinfo id="KUNNT" size="105" summ="default" type="STRING"/>
					<colinfo id="KWMENG" size="17" summ="default" type="DECIMAL"/>
					<colinfo id="LAND1" size="9" summ="default" type="STRING"/>
					<colinfo id="MANDT" size="9" summ="default" type="STRING"/>
					<colinfo id="NETWR" size="17" summ="default" type="DECIMAL"/>
					<colinfo id="POST1" size="105" summ="default" type="STRING"/>
					<colinfo id="REDAT" size="24" summ="default" type="STRING"/>
					<colinfo id="SOPOS" size="3" summ="default" type="STRING"/>
					<colinfo id="SOYM" size="18" summ="default" type="STRING"/>
					<colinfo id="VRKME" size="9" summ="default" type="STRING"/>
					<colinfo id="WAERK" size="15" summ="default" type="STRING"/>
					<colinfo id="ZDESC" size="765" summ="default" type="STRING"/>
					<colinfo id="ZPSTAT" size="6" summ="default" type="STRING"/>
					<colinfo id="ZTERM" size="12" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_detail">
				<Contents>
					<colinfo id="FLAG" size="3" summ="default" type="STRING"/>
					<colinfo id="AEDAT" size="24" summ="default" type="STRING"/>
					<colinfo id="AENAM" size="36" summ="default" type="STRING"/>
					<colinfo id="AEZZT" size="18" summ="default" type="STRING"/>
					<colinfo id="ARKTX" size="120" summ="default" type="STRING"/>
					<colinfo id="DEDAT" size="24" summ="default" type="STRING"/>
					<colinfo id="ERDAT" size="24" summ="default" type="STRING"/>
					<colinfo id="ERNAM" size="36" summ="default" type="STRING"/>
					<colinfo id="ERZZT" size="18" summ="default" type="STRING"/>
					<colinfo id="INELN" size="33" summ="default" type="STRING"/>
					<colinfo id="INSEQ" size="9" summ="default" type="STRING"/>
					<colinfo id="KUNNR" size="30" summ="default" type="STRING"/>
					<colinfo id="KWMENG" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="MANDT" size="9" summ="default" type="STRING"/>
					<colinfo id="NETPR" size="11" summ="default" type="DECIMAL"/>
					<colinfo id="NETWR" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="POSNR" size="18" summ="default" type="STRING"/>
					<colinfo id="SPDAT" size="24" summ="default" type="STRING"/>
					<colinfo id="SRDAT" size="24" summ="default" type="STRING"/>
					<colinfo id="VRKME" size="9" summ="default" type="STRING"/>
					<colinfo id="WAERK" size="15" summ="default" type="STRING"/>
					<colinfo id="ZDESC1" size="765" summ="default" type="STRING"/>
					<colinfo id="ZDESC2" size="765" summ="default" type="STRING"/>
					<colinfo id="ZDESC3" size="765" summ="default" type="STRING"/>
					<colinfo id="ZEMPL" size="30" summ="default" type="STRING"/>
					<colinfo id="ZMAKE" size="3" summ="default" type="STRING"/>
					<colinfo id="ZTYPE" size="3" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ineln">
				<Contents>
					<colinfo id="INELN" size="33" summ="default" type="STRING"/>
					<colinfo id="INSEQ" size="9" summ="default" type="STRING"/>
					<colinfo id="KUNNR" size="30" summ="default" type="STRING"/>
					<colinfo id="POSNR" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_incond">
				<Contents>
					<colinfo id="KUNNR" size="30" summ="default" type="STRING"/>
					<colinfo id="INELN" size="255" summ="default" type="STRING"/>
					<colinfo id="INSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="POSNR" size="256" summ="default" type="STRING"/>
					<record>
						<INELN></INELN>
						<INSEQ></INSEQ>
						<KUNNR></KUNNR>
						<POSNR></POSNR>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_inlist">
				<Contents>
					<colinfo id="INELN" size="33" summ="default" type="STRING"/>
					<colinfo id="INSEQ" size="9" summ="default" type="STRING"/>
					<colinfo id="KUNNR" size="30" summ="default" type="STRING"/>
					<colinfo id="POSNR" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
		</Datasets>
		<Shape BKColor="user12" Bottom="30" Height="26" Id="Shape1" Left="8" LineColor="user13" Right="966" TabOrder="3" Top="4" Type="Rectangle" Width="958"></Shape>
		<Grid AreaSelect="TRUE" AutoFitEndLine="Hide" BindDataset="ds_list" BkColor2="default" BoldHead="true" Border="Flat" Bottom="281" ColSelect="TRUE" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="25" Height="246" Id="grd_list" InputPanel="FALSE" Left="8" LineColor="user20" LineType="ExHORZ" OnHeadClick="grd_list_OnHeadClick" Right="966" RowHeight="20" Style="sty_grid" TabOrder="1" TabStop="true" Top="35" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="958">
			<contents>
				<format id="Default">
					<columns>
						<col fix="left" width="40"/>
						<col width="98"/>
						<col width="98"/>
						<col width="63"/>
						<col width="155"/>
						<col width="133"/>
						<col width="56"/>
						<col width="103"/>
						<col width="92"/>
						<col width="91"/>
						<col width="98"/>
						<col width="78"/>
						<col width="78"/>
						<col width="102"/>
						<col width="57"/>
						<col width="104"/>
						<col width="134"/>
					</columns>
					<head>
						<cell align="center" col="0" color="user21" display="normal" font="굴림,9" text="NO" Valign="Center" wordwrap="word"/>
						<cell align="center" col="1" color="user21" display="text" domainid="bs.kunnr" font="굴림,9" text="대리점&#32;코드" wordwrap="word"/>
						<cell align="center" col="2" color="user21" display="text" domainid="bs.ineln" font="굴림,9" text="견적의뢰번호" wordwrap="word"/>
						<cell align="center" col="3" color="user21" display="text" domainid="bs.inseq" font="굴림,9" text="회차" wordwrap="word"/>
						<cell col="4" color="user21" display="text" domainid="bs.post1" font="굴림,9" text="현장명" wordwrap="word"/>
						<cell col="5" color="user21" display="text" domainid="bs.kunnt" font="굴림,9" text="고객명" wordwrap="word"/>
						<cell align="center" col="6" color="user21" display="text" domainid="bs.land1" font="굴림,9" text="국가코드" wordwrap="word"/>
						<cell align="center" col="7" color="user21" display="text" domainid="bs.soym" font="굴림,9" text="예상수주월" wordwrap="word"/>
						<cell align="center" col="8" color="user21" display="text" domainid="bs.sopos" font="굴림,9" text="수주가능성" wordwrap="word"/>
						<cell align="center" col="9" color="user21" display="text" domainid="bs.zterm" font="굴림,9" text="지급조건" wordwrap="word"/>
						<cell align="center" col="10" color="user21" display="text" domainid="bs.inco1" font="굴림,9" text="인도조건" wordwrap="word"/>
						<cell align="center" col="11" color="user21" display="text" domainid="bs.kwmeng" font="굴림,9" text="대수" wordwrap="word"/>
						<cell align="center" col="12" color="user21" display="text" domainid="bs.vrkme" font="굴림,9" text="단위" wordwrap="word"/>
						<cell align="center" col="13" color="user21" display="text" domainid="bs.netwr" font="굴림,9" text="금액" wordwrap="word"/>
						<cell align="center" col="14" color="user21" display="text" domainid="bs.waerk" font="굴림,9" text="통화" wordwrap="word"/>
						<cell align="center" col="15" color="user21" display="text" domainid="bs.inland" font="굴림,9" text="인도국가" wordwrap="word"/>
						<cell align="center" col="16" color="user21" display="text" domainid="bs.inport" font="굴림,9" text="인도항구" wordwrap="word"/>
					</head>
					<body>
						<cell align="center" bkcolor2="user22" col="0" display="normal" expr="currow+1"/>
						<cell align="center" bkcolor2="user22" col="1" colid="KUNNR" display="text" edit="normal"/>
						<cell align="center" bkcolor2="user22" col="2" colid="INELN" display="text" edit="normal"/>
						<cell align="center" bkcolor2="user22" col="3" colid="INSEQ" display="text" edit="normal"/>
						<cell align="left" bkcolor2="user22" col="4" colid="POST1" display="text" edit="normal"/>
						<cell align="left" bkcolor2="user22" col="5" colid="KUNNT" display="text" edit="normal"/>
						<cell align="center" bkcolor2="user22" col="6" colid="LAND1" display="normal" edit="normal"/>
						<cell align="center" bkcolor2="user22" col="7" colid="SOYM" display="date" edit="date" Mask="yyyy.MM.dd"/>
						<cell align="center" bkcolor2="user22" col="8" colid="SOPOS" display="text" edit="normal"/>
						<cell align="center" bkcolor2="user22" col="9" colid="ZTERM" display="text" edit="normal"/>
						<cell align="center" bkcolor2="user22" col="10" colid="INCO1" display="text" edit="normal"/>
						<cell align="right" bkcolor2="user22" col="11" colid="KWMENG" display="number" edit="normal"/>
						<cell align="right" bkcolor2="user22" col="12" colid="VRKME" display="number" edit="normal"/>
						<cell align="right" bkcolor2="user22" col="13" colid="NETWR" display="number" edit="normal"/>
						<cell align="center" bkcolor2="user22" col="14" colid="WAERK" display="text" edit="normal"/>
						<cell align="center" bkcolor2="user22" col="15" colid="INLAND" display="text" edit="normal"/>
						<cell align="left" bkcolor2="user22" col="16" colid="INPORT" display="normal" edit="normal"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Grid AreaSelect="TRUE" AutoFitEndLine="Hide" BindDataset="ds_detail" BkColor2="default" BoldHead="true" Border="Flat" Bottom="555" ColSelect="TRUE" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="25" Height="267" Id="grd_detail" InputPanel="FALSE" Left="8" LineColor="user20" LineType="ExHORZ" OnHeadClick="grd_detail_OnHeadClick" Right="966" RowHeight="20" Style="sty_grid" TabOrder="2" TabStop="true" Top="288" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="958">
			<contents>
				<format id="Default">
					<columns>
						<col width="40"/>
						<col width="80"/>
						<col width="90"/>
						<col width="70"/>
						<col width="50"/>
						<col width="80"/>
						<col width="80"/>
						<col width="60"/>
						<col width="68"/>
						<col width="80"/>
						<col width="100"/>
						<col width="50"/>
						<col width="80"/>
						<col width="150"/>
					</columns>
					<head>
						<cell align="center" col="0" color="user21" display="normal" font="굴림,9" text="NO" Valign="Center" wordwrap="word"/>
						<cell align="center" col="1" color="user21" display="text" domainid="bs.kunnr" font="굴림,9" text="대리점&#32;코드" wordwrap="word"/>
						<cell align="center" col="2" color="user21" display="text" domainid="bs.ineln" font="굴림,9" text="견적의뢰번호" wordwrap="word"/>
						<cell align="center" col="3" color="user21" display="text" domainid="bs.inseq" font="굴림,9" text="회차" wordwrap="word"/>
						<cell align="center" col="4" color="user21" display="text" domainid="bs.posnr" font="굴림,9" text="품목번호" wordwrap="word"/>
						<cell align="center" col="5" color="user21" display="text" domainid="bs.zmake" font="굴림,9" text="생산지" wordwrap="word"/>
						<cell align="center" col="6" color="user21" display="text" domainid="bs.ztype" font="굴림,9" text="기종" wordwrap="word"/>
						<cell align="center" col="7" color="user21" display="text" domainid="bs.kwmeng" font="굴림,9" text="대수" wordwrap="word"/>
						<cell align="center" col="8" color="user21" display="text" domainid="bs.vrkme" font="굴림,9" text="단위" wordwrap="word"/>
						<cell align="center" col="9" color="user21" display="text" domainid="bs.netpr" font="굴림,9" text="단가" wordwrap="word"/>
						<cell align="center" col="10" color="user21" display="text" domainid="bs.netwr" font="굴림,9" text="금액" wordwrap="word"/>
						<cell align="center" col="11" color="user21" display="text" domainid="bs.waerk" font="굴림,9" text="통화" wordwrap="word"/>
						<cell align="center" col="12" color="user21" display="text" domainid="bs.dedat" font="굴림,9" text="예상선적일" wordwrap="word"/>
						<cell align="center" col="13" color="user21" display="text" domainid="bs.arktx" font="굴림,9" text="영업사양" wordwrap="word"/>
					</head>
					<body>
						<cell align="center" bkcolor2="user22" col="0" display="normal" expr="currow+1"/>
						<cell align="center" bkcolor2="user22" col="1" colid="KUNNR" display="text" edit="normal"/>
						<cell align="center" bkcolor2="user22" col="2" colid="INELN" display="text" edit="normal"/>
						<cell align="center" bkcolor2="user22" col="3" colid="INSEQ" display="text" edit="normal"/>
						<cell align="center" bkcolor2="user22" col="4" colid="POSNR" display="text" edit="normal"/>
						<cell align="center" bkcolor2="user22" col="5" colid="ZMAKE" combodisplayrowcnt="6" display="text" edit="normal"/>
						<cell align="center" bkcolor2="user22" col="6" colid="ZTYPE" display="text" edit="normal"/>
						<cell align="right" bkcolor2="user22" col="7" colid="KWMENG" display="number" edit="normal"/>
						<cell align="center" bkcolor2="user22" col="8" colid="VRKME" display="normal" edit="normal"/>
						<cell align="center" bkcolor2="user22" col="9" colid="NETPR" display="number" edit="normal"/>
						<cell align="right" bkcolor2="user22" col="10" colid="NETWR" display="number" edit="normal"/>
						<cell align="center" bkcolor2="user22" col="11" colid="WAERK" display="normal" edit="normal"/>
						<cell align="center" bkcolor2="user22" col="12" colid="DEDAT" display="date" edit="date" Mask="yyyy.MM.dd"/>
						<cell align="center" bkcolor2="user22" col="13" colid="ARKTX" display="text" edit="normal"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Static Align="Right" Height="24" Id="st_kunnr" Left="9" Style="sty_lb_form_basic" TabOrder="4" Text="대리점&#32;코드&#32;" Top="5" VAlign="Middle" Width="96" WordWrap="TRUE"></Static>
		<Static Align="Right" DomainID="bs.inelq" Height="24" Id="st_inelq" Left="242" Style="sty_lb_form_basic" TabOrder="5" Text="견적의뢰번호&#32;" Top="5" VAlign="Middle" Width="94" WordWrap="TRUE"></Static>
		<Edit BindDataset="ds_cond" Border="Flat" Column="INELN" Height="20" Id="ed_ineln" Left="339" LeftMargin="4" RightMargin="4" Style="sty_ipt_form_ind" TabOrder="6" Top="7" Width="112"></Edit>
		<Edit BindDataset="ds_cond" Border="Flat" Column="INSEQ" Height="20" Id="ed_inseq" Left="452" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="7" Top="7" Width="48"></Edit>
		<Edit BindDataset="ds_cond" Border="Flat" Column="KUNNR" Height="20" Id="ed_kunnr" Left="108" LeftMargin="4" RightMargin="4" Style="sty_ipt_form_ind" TabOrder="8" Top="7" Width="128"></Edit>
	</Form>
	<Script><![CDATA[﻿﻿﻿﻿﻿﻿﻿﻿/*
 ******************************************************************************************
 * 기      능   : 
 * 작  성  자   : 
 * 작성  일자   : 
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
#include "LIB::commons.js";	// 공통 스크립트 
//=========================================================================================
// [ PART 1 ]
// Form에서 사용될 전역변수를 선언
// FORM에서 사용되는 전역변수는 대문자로 작성하며, F_XXX 의 형태를 갖도록 한다. 
//=========================================================================================
var gbn = false;
//=========================================================================================
// [ PART 2 ]
// Form Loading / Unloading 시 작업 정의
//=========================================================================================
function fn_OnLoadCompleted(obj) {
	
	global.language = G_LANG;
	// Form 로드 이벤트 맨 첫줄에 기술 
	gfn_initForm(true);

	//코드콤보 설정 : 지급조건,인도조건,진행상태
	// var codeArr = ["ZTERM1","INCO1","ZPSTAT","SOPOS","ZMAKE","ZTYPE","VRKME","LAND1"];
	// var dsObjArr = [ds_zterm,ds_inco1,ds_zpstat,ds_sopos,ds_zmake,ds_ztype,ds_vrkme,ds_inland];
	// var addTypeArr = [G_CODE_NONE,G_CODE_NONE,G_CODE_NONE,G_CODE_NONE,G_CODE_NONE,G_CODE_NONE,G_CODE_NONE,G_CODE_NONE];
	// gfn_searchCommCode(codeArr, dsObjArr, addTypeArr);

	gfn_showMsg("CI00007");
}

/********************************************************************************
* 기      능   : 공통코드가 조회된 후의 Callback 함수 
********************************************************************************/
function fn_completeInit(sCode, sDsObj, sCodeType) {
	
}
/********************************************************************************
* 기      능   : form UnloadCompleted 
********************************************************************************/
function fn_OnUnloadCompleted(obj) {
	return gfn_isFormUnload(obj);
}
//=========================================================================================
// [ PART 3 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,form닫기)
//=========================================================================================
/********************************************************************************
* 기      능   : 조회 1
********************************************************************************/
function fn_query() {

    // Message 영역 초기화
	global.FRM_BOTTOM.img_msgType.imageId = "";
	global.FRM_BOTTOM.st_msg.value = "";

	// 대리점 코드 필수 입력
	if ( gfn_isNull(ed_kunnr, true) || length(ed_kunnr.value) < 10) {
		gfn_showMsg("CW00001",st_kunnr.text);
		return;
	}

		// 견적의뢰번호 필수 검사
	if (length(Trim(ed_ineln.Text)) < 6) 
	{
		var arr = ["견적의뢰 번호","6"];
		gfn_showMsg("CW00174", arr);
		ed_ineln.SetFocus();
		return;
	}
	// sort mark 삭제 
	gfn_clearGridSortMark(grd_list);
	
	ds_list.fireevent = false;
	ds_list.row = -1;
	ds_list.ClearData();
	ds_detail.ClearData();
	ds_list.fireevent = true;
	
	tit_clearActionInfo();
	tit_addSearchActionInfo("bs02:BS0201007A_S1");
	tit_addSearchActionInfo("bs02:BS0201007A_S2");

	tit_callService(
        ""
        , ""
        , "ds_cond=ds_cond"
        , "ds_list=ds_list ds_detail=ds_detail"
        , ""
        , "fn_afterQuery"
        , true);
}

/********************************************************************************
* 기      능   : 삽입 
********************************************************************************/
function fn_input() 
{
	ds_list.fireevent = false;
	ds_detail.fireevent = false;

	var cnt = ds_list.GetRowCount();
	var cnt1 = ds_detail.GetRowCount();
	if (ds_list.rowpos == 0)
	{
		cnt = 0;
		cnt1 = 0;
	}

	for( var i = 0; i < 20 ; i++)
	{
		ds_list.AddRow();
		ds_list.SetColumn(ds_list.rowpos,"FLAG","I");
		ds_detail.AddRow();
		ds_detail.SetColumn(ds_detail.rowpos,"FLAG","I");
	}
	ds_list.RowPos = cnt;
	ds_detail.RowPos = cnt1;
	
	ds_list.fireevent = true;
	ds_detail.fireevent = true;

}


/********************************************************************************
* 기      능   : 저장
********************************************************************************/
function fn_save() {
    // Message 영역 초기화
	global.FRM_BOTTOM.img_msgType.imageId = "";
	global.FRM_BOTTOM.st_msg.value = "";

    // 자료가 없으면 리턴
	if (ds_list.rowcount < 1){
		gfn_showAlert("CW00010");
		return;
	}
    //변경값 확인
	if ( !gfn_isChangeDs(ds_list, true)) {
		return;
	}
	
	
	// 빈행 삭제
	for (var i =0; i < ds_list.rowcount; i++)
	{
		if((length(ds_list.GetColumn(i,"KUNNR")) < 1 
		  && length(ds_list.GetColumn(i,"INELN")) < 1
		  && length(ds_list.GetColumn(i,"INSEQ")) < 1)) {
			ds_list.DeleteRow(i); 
			i--;
		}
	}

	for (var i =0; i < ds_detail.rowcount; i++)
	{
		if((length(ds_detail.GetColumn(i,"KUNNR")) < 1 && length(ds_detail.GetColumn(i,"INELN")) < 1
		  && length(ds_detail.GetColumn(i,"INSEQ")) < 1 && length(ds_detail.GetColumn(i,"POSNR")) < 1))
		{
			ds_detail.DeleteRow(i); 
			i--;
		}
	}
	
	ds_list.fireevent = false;
	ds_detail.fireevent = false;

	for (var i = 0; i < ds_list.RowCount(); i++) {
		for (var j = 0; j < ds_list.RowCount(); j++){
		
			if ( i != j && ds_list.GetColumn(i,"KUNNR") = ds_list.GetColumn(j,"KUNNR")
			            && ds_list.GetColumn(i,"INELN") = ds_list.GetColumn(j,"INELN")
			            && ds_list.GetColumn(i,"INSEQ") = ds_list.GetColumn(j,"INSEQ")) {
			   gfn_showAlert("CW00018","대리점명, 의뢰번호, 회차");
			   grd_list.SetFocus();
	           ds_list.row = j;
			   ds_list.fireevent = true;
			   ds_detail.fireevent =true;
			   return;
			}
		}
		
		// 서버 중복 확인
		if(ufn_getIneln(ds_list.GetColumn(i,"KUNNR"), ds_list.GetColumn(i,"INELN")
		   , ds_list.GetColumn(i,"INSEQ"))) {
			   gfn_showAlert("CW00018","대리점명, 의뢰번호, 회차 (서버데이터)");
			   grd_list.SetFocus();
	           ds_list.row = j;
			   ds_list.fireevent = true;
			   ds_detail.fireevent =true;
			   return;   
		}

		if ( length(ds_list.GetColumn(i,"KUNNR")) < 1 ||  length(ds_list.GetColumn(i,"INELN")) < 1 || 
			 length(ds_list.GetColumn(i,"INSEQ")) < 1) {
		   gfn_showAlert("CW00208","대리점명, 의뢰번호, 회차");
		   grd_list.SetFocus();
		   ds_list.row = j;
		   ds_list.fireevent = true;
		   ds_detail.fireevent =true;
		   return;
		}
	}
	
	for (var i = 0; i < ds_detail.RowCount(); i++) {
		for (var j = 0; j < ds_detail.RowCount(); j++){
		
			if ( i != j && ds_detail.GetColumn(i,"KUNNR") = ds_detail.GetColumn(j,"KUNNR")
			            && ds_detail.GetColumn(i,"INELN") = ds_detail.GetColumn(j,"INELN")
			            && ds_detail.GetColumn(i,"INSEQ") = ds_detail.GetColumn(j,"INSEQ")
			            && ds_detail.GetColumn(i,"POSNR") = ds_detail.GetColumn(j,"POSNR")) {
			   gfn_showAlert("CW00018","대리점명, 의뢰번호, 회차,품목");
			   grd_detail.SetFocus();
	           ds_detail.row = j;
			   ds_list.fireevent = true;
			   ds_detail.fireevent =true;
			   return;
			}
		}
		// 서버 중복 확인
		if(ufn_getIneln(ds_detail.GetColumn(i,"KUNNR"), ds_detail.GetColumn(i,"INELN")
		   , ds_detail.GetColumn(i,"INSEQ"), ds_detail.GetColumn(i,"POSNR"))) {
			   gfn_showAlert("CW00018","대리점명, 의뢰번호, 회차,품목 (서버데이터)");
			   grd_detail.SetFocus();
	           ds_detail.row = i;
			   ds_list.fireevent = true;
			   ds_detail.fireevent =true;
			   return;		   
		}
		if ( length(ds_detail.GetColumn(i,"KUNNR")) < 1 ||  length(ds_detail.GetColumn(i,"INELN")) < 1 || 
			 length(ds_detail.GetColumn(i,"INSEQ")) < 1  ||  length(ds_detail.GetColumn(i,"POSNR")) < 1) {
		   gfn_showAlert("CW00208","대리점명, 의뢰번호, 회차,품목");
		   grd_detail.SetFocus();
		   ds_list.row = j;
		   ds_list.fireevent = true;
		   ds_detail.fireevent =true;
		   return;
		}
	}

	
	ds_list.fireevent = true;
	ds_detail.fireevent = true;

	
	for (var i =0; i < ds_list.rowcount; i++)
	{
		if(ds_list.GetColumn(i,"FLAG") != "I") {
			ds_list.DeleteRow(i); 
			i--;
		}
	}

	for (var i =0; i < ds_detail.rowcount; i++)
	{
		if(ds_detail.GetColumn(i,"FLAG") != "I")
		{
			ds_detail.DeleteRow(i); 
			i--;
		}
	}

	if (!gfn_showConfirm("CI00010")) {
		return;
	}

	tit_clearActionInfo();
	tit_addMultiActionInfo("bs02:BS0201007A_I1");
	tit_addMultiActionInfo("bs02:BS0201007A_I2");

	tit_callService(
		""
		, ""
		, "ds_list=ds_list:I ds_detail=ds_detail:I"
		, ""
		, ""
		, "fn_afterSave");
}

/********************************************************************************
* 기      능   : 닫기  
********************************************************************************/
function fn_close() {
	close();
}


/********************************************************************************
* 기      능   : Delete 25
********************************************************************************/
function fn_delete() {

	// 처리 데이터 확인
	if (ds_list.rowcount < 1) {
		gfn_showAlert("CW00013");
		return;
	} else {
		ds_list.fireevent = false;
		for(var j=0; j < ds_detail.RowCount(); j++){
			if(Trim(ds_list.GetColumn(ds_list.rowpos,"KUNNR")) == Trim(ds_detail.GetColumn(j,"KUNNR")) 
			   && Trim(ds_list.GetColumn(ds_list.rowpos,"INELN")) == Trim(ds_detail.GetColumn(j,"INELN"))
			   && Trim(ds_list.GetColumn(ds_list.rowpos,"INSEQ")) == Trim(ds_detail.GetColumn(j,"INSEQ"))){
			   ds_detail.deleteRow(j);
			   j--;
			}
		}

		ds_list.DeleteRow(ds_list.rowpos);
		ds_list.fireevent = true;
	}	
}

/********************************************************************************
* 기      능   : 취소
********************************************************************************/

function fn_cancel() {
	ds_list.reset();
	ds_detail.reset();
}


//=========================================================================================
// [ PART 6 ]
// component Event 정의 : 각 Component 별 이벤트 
//=========================================================================================


/********************************************************************************
* 기      능   : 조회 Callback  
********************************************************************************/
function fn_afterQuery(errCode, errMsg) {
	// 메세지 처리
	if (ds_list.rowcount > 0)
	{
		gfn_showMsg("CI00002",ds_list.RowCount()+"");
	}
}
/********************************************************************************
* 기      능   : 저장 Callback  
********************************************************************************/
function fn_afterSave(errCode, errMsg) {
	if ( errCode != 0 ) {
		gfn_showMsg("CE00001");
	} else {
		ds_list.ClearData();
		ds_detail.ClearData();
		gfn_showAlert("CI00003");
	}
}


/********************************************************************************
* 기      능   : 그리드 헤더 클릭시 정렬 처리 
********************************************************************************/
function grd_list_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
{
	if ( nCell == 0 ) {
		// 그리드 표시할 컬럼 선택 
		gfn_selectAllGrid(obj);
	} else {
		// 그리드 정렬 처리 
		gfn_sortGrid(obj,nCell);
	}
}

/*************************************************
* 견적의뢰 클릭시 상세 조회
**************************************************/
function ds_list_OnCellPosChanged(obj,nOldRow,nRow)
{
	// detail 조회
	// ds_list_0.Filter("KUNNR == " + quote(ds_list.GetColumn(nRow,"KUNNR")) 
	                     // +" && INELN =="+quote(ds_list.GetColumn(nRow,"INELN"))
	                     // +" && INSEQ =="+quote(ds_list.GetColumn(nRow,"INSEQ")));	
}



function grd_detail_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
{
	if ( nCell == 0 ) {
		// 그리드 표시할 컬럼 선택 
		gfn_selectAllGrid(obj);
	} else {
		// 그리드 정렬 처리 
		gfn_sortGrid(obj,nCell);
	}
}


function ufn_getIneln(kunnr,ineln,inseq,posnr) {
	
	var nRow;
	if (posnr != null) {
		nRow= ds_ineln.searchRow("KUNNR== " + quote(kunnr) 
			+ " && INELN==" + quote( ineln )
			+ " && INSEQ == " + quote( inseq )
			+ " && POSNR == " + quote( posnr ) );
	}else {
		nRow= ds_ineln.searchRow("KUNNR== " + quote(kunnr) 
			+ " && INELN==" + quote( ineln )
			+ " && INSEQ == " + quote( inseq ));
	}
	
	
	if ( nRow >= 0 ) {
		return true;
	}
	
	ds_incond.SetColumn(0,"KUNNR", kunnr);
	ds_incond.SetColumn(0,"INELN", ineln);
	ds_incond.SetColumn(0,"INSEQ", inseq);
	ds_incond.SetColumn(0,"POSNR", posnr);
	
	tit_clearActionInfo();
	tit_addSearchActionInfo("bs02:BS0201007A_S3");

	tit_callService(
        ""
        , ""
        , "ds_incond=ds_incond"
        , "ds_inlist=ds_inlist"
        , ""
        , "fn_afterInQuery"
        , true,false,true);
        
     return gbn;
}

function fn_afterInQuery(rrCode, errMsg)
{
	// 메세지 처리
	if (ds_inlist.rowcount > 0)
	{
		ds_ineln.AppendDataset(ds_inlist);
		gbn =  true;
	} else {
		gbn = false;
	}
}]]></Script>
</Window>