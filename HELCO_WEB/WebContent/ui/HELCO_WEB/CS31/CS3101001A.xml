<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form BKColor="user5" Height="576" Id="CS3101001A" Left="8" OnLoadCompleted="fn_OnLoadCompleted" OnUnloadCompleted="fn_OnUnloadCompleted" PidAttrib="7" Style="sty_ipt_form" Title="자재견적&#32;작업" Top="8" Ver="1.0" Width="978" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_vkbur">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<colinfo id="DTEXT2" size="90" type="STRING"/>
					<colinfo id="DTEXT3" size="120" type="STRING"/>
					<colinfo id="DTEXT4" size="9" type="STRING"/>
					<colinfo id="CODE2" size="2" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_vkgrp">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
					<colinfo id="DTEXT2" size="90" type="STRING"/>
					<colinfo id="DTEXT3" size="120" type="STRING"/>
					<colinfo id="DTEXT4" size="9" type="STRING"/>
					<colinfo id="CODE2" size="2" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_shtyp">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_taxk1">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_zterm">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_kvgr1">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_kvgr2">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond">
				<Contents>
					<colinfo id="REQNO" size="30" type="STRING"/>
					<colinfo id="QTNUM" size="45" type="STRING"/>
					<colinfo id="GBN" size="2" type="STRING"/>
					<colinfo id="ZYEAR" size="8" type="STRING"/>
					<record>
						<GBN></GBN>
						<QTNUM></QTNUM>
						<REQNO></REQNO>
						<ZYEAR></ZYEAR>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_bwtar">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cu_cond">
				<Contents>
					<colinfo id="KUNNR" size="255" type="STRING"/>
					<record>
						<KUNNR></KUNNR>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cu_list">
				<Contents>
					<colinfo id="NAME1" size="105" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_qstat">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_bussi">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_pe_list">
				<Contents>
					<colinfo id="PERNR" size="30" summ="default" type="STRING"/>
					<colinfo id="ED_PERNR" size="20" summ="default" type="STRING"/>
					<colinfo id="VKGRP" size="30" summ="default" type="STRING"/>
					<colinfo id="VKBUR" size="30" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_reqkind">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_key">
				<Contents>
					<colinfo id="QTNUM" size="31" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list" OnColumnChanged="ds_list_OnColumnChanged">
				<Contents>
					<colinfo id="AMOUNT" size="17" type="DECIMAL"/>
					<colinfo id="BUSSI" size="3" type="STRING"/>
					<colinfo id="BWTAR" size="30" type="STRING"/>
					<colinfo id="CHECK" size="1" type="STRING"/>
					<colinfo id="FLAG" size="1" type="STRING"/>
					<colinfo id="HOGI_ID" size="72" type="STRING"/>
					<colinfo id="MAKTX" size="120" type="STRING"/>
					<colinfo id="MAT_DESC" size="60" type="STRING"/>
					<colinfo id="MATNR" size="54" type="STRING"/>
					<colinfo id="MEINS" size="9" type="STRING"/>
					<colinfo id="MENGE" size="33" type="DECIMAL"/>
					<colinfo id="MTART" size="12" type="STRING"/>
					<colinfo id="NETPR" size="22" type="DECIMAL"/>
					<colinfo id="NETWR" size="17" type="DECIMAL"/>
					<colinfo id="QTNUM" size="45" type="STRING"/>
					<colinfo id="RDATE" size="8" type="STRING"/>
					<colinfo id="RECE_F" size="3" type="STRING"/>
					<colinfo id="REQKIND" size="3" type="STRING"/>
					<colinfo id="REQKIND2" size="3" type="STRING"/>
					<colinfo id="REQNR" size="30" type="STRING"/>
					<colinfo id="SAMT1" size="11" type="INT"/>
					<colinfo id="SEQNO" size="18" type="STRING"/>
					<colinfo id="ED_LIFNR" size="100" type="STRING"/>
					<colinfo id="HNA" size="90" type="STRING"/>
					<colinfo id="MAN" size="256" type="STRING"/>
					<colinfo id="JOBHOUR" size="6" type="DECIMAL"/>
					<colinfo id="AMT" size="22" type="DECIMAL"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list_0">
				<Contents>
					<colinfo id="AMOUNT" size="17" type="DECIMAL"/>
					<colinfo id="BUSSI" size="3" type="STRING"/>
					<colinfo id="BWTAR" size="30" type="STRING"/>
					<colinfo id="CHECK" size="1" type="STRING"/>
					<colinfo id="FLAG" size="1" type="STRING"/>
					<colinfo id="HOGI_ID" size="72" type="STRING"/>
					<colinfo id="MAKTX" size="120" type="STRING"/>
					<colinfo id="MAT_DESC" size="60" type="STRING"/>
					<colinfo id="MATNR" size="54" type="STRING"/>
					<colinfo id="MEINS" size="9" type="STRING"/>
					<colinfo id="MENGE" size="33" type="DECIMAL"/>
					<colinfo id="MTART" size="12" type="STRING"/>
					<colinfo id="NETPR" size="22" type="DECIMAL"/>
					<colinfo id="NETWR" size="17" type="DECIMAL"/>
					<colinfo id="QTNUM" size="45" type="STRING"/>
					<colinfo id="RDATE" size="8" type="STRING"/>
					<colinfo id="RECE_F" size="3" type="STRING"/>
					<colinfo id="REQKIND" size="3" type="STRING"/>
					<colinfo id="REQKIND2" size="3" type="STRING"/>
					<colinfo id="REQNR" size="30" type="STRING"/>
					<colinfo id="SAMT1" size="11" type="INT"/>
					<colinfo id="SEQNO" size="18" type="STRING"/>
					<colinfo id="ED_LIFNR" size="100" type="STRING"/>
					<colinfo id="HNA" size="90" type="STRING"/>
					<colinfo id="MAN" size="256" type="STRING"/>
					<colinfo id="AMT" size="22" type="DECIMAL"/>
					<colinfo id="JOBHOUR" size="6" type="DECIMAL"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_gyeonjeok">
				<Contents>
					<colinfo id="CTEXT2" size="60" type="STRING"/>
					<colinfo id="DTEXT1" size="60" type="STRING"/>
					<colinfo id="DTEXT2" size="120" type="STRING"/>
					<colinfo id="DTEXT3" size="60" type="STRING"/>
					<colinfo id="DTEXT4" size="60" type="STRING"/>
					<colinfo id="DTEXT5" size="60" type="STRING"/>
					<colinfo id="J_1KFREPRE" size="30" type="STRING"/>
					<colinfo id="LIFNR" size="30" type="STRING"/>
					<colinfo id="MANDT" size="9" type="STRING"/>
					<colinfo id="MCOD3" size="75" type="STRING"/>
					<colinfo id="NAME1" size="105" type="STRING"/>
					<colinfo id="PSTLZ" size="30" type="STRING"/>
					<colinfo id="STRAS" size="90" type="STRING"/>
					<colinfo id="TELF1" size="48" type="STRING"/>
					<colinfo id="TELFX" size="93" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_pe_cond">
				<Contents>
					<colinfo id="LIFNR" size="14" type="STRING"/>
					<record>
						<LIFNR></LIFNR>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_detail">
				<Contents>
					<colinfo id="HNA" size="90" type="STRING"/>
					<colinfo id="MAKTX" size="120" type="STRING"/>
					<colinfo id="MEINS" size="9" type="STRING"/>
					<colinfo id="MENGE" size="15" type="DECIMAL"/>
					<colinfo id="NETPR" size="13" type="DECIMAL"/>
					<colinfo id="NETWR" size="26" type="DECIMAL"/>
					<colinfo id="REQKIND" size="3" type="STRING"/>
					<colinfo id="QTNUM" size="10" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list_1">
				<Contents>
					<colinfo id="AMOUNT" size="17" type="DECIMAL"/>
					<colinfo id="BUSSI" size="3" type="STRING"/>
					<colinfo id="BWTAR" size="30" type="STRING"/>
					<colinfo id="CHECK" size="1" type="STRING"/>
					<colinfo id="FLAG" size="1" type="STRING"/>
					<colinfo id="HOGI_ID" size="72" type="STRING"/>
					<colinfo id="MAKTX" size="120" type="STRING"/>
					<colinfo id="MAT_DESC" size="60" type="STRING"/>
					<colinfo id="MATNR" size="54" type="STRING"/>
					<colinfo id="MEINS" size="9" type="STRING"/>
					<colinfo id="MENGE" size="33" type="DECIMAL"/>
					<colinfo id="MTART" size="12" type="STRING"/>
					<colinfo id="NETPR" size="22" type="DECIMAL"/>
					<colinfo id="NETWR" size="17" type="DECIMAL"/>
					<colinfo id="QTNUM" size="45" type="STRING"/>
					<colinfo id="RDATE" size="8" type="STRING"/>
					<colinfo id="RECE_F" size="3" type="STRING"/>
					<colinfo id="REQKIND" size="3" type="STRING"/>
					<colinfo id="REQKIND2" size="3" type="STRING"/>
					<colinfo id="REQNR" size="30" type="STRING"/>
					<colinfo id="SAMT1" size="11" type="INT"/>
					<colinfo id="SEQNO" size="18" type="STRING"/>
					<colinfo id="ED_LIFNR" size="100" type="STRING"/>
					<colinfo id="HNA" size="90" type="STRING"/>
					<colinfo id="MAN" size="256" type="STRING"/>
					<colinfo id="AMT" size="22" type="DECIMAL"/>
					<colinfo id="JOBHOUR" size="6" type="DECIMAL"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_area">
				<Contents>
					<colinfo id="DTEXT2" size="90" type="STRING"/>
					<colinfo id="DTEXT3" size="120" type="STRING"/>
					<colinfo id="DTEXT4" size="9" type="STRING"/>
					<colinfo id="CODE2" size="2" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cs001" OnColumnChanged="ds_cs001_OnColumnChanged">
				<Contents>
					<colinfo id="ADMCOST1" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="ADMCOST2" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="AMOUNT" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="APDAT" size="24" summ="default" type="STRING"/>
					<colinfo id="BILDAT" size="24" summ="default" type="STRING"/>
					<colinfo id="BILDAT2" size="24" summ="default" type="STRING"/>
					<colinfo id="BILDAT3" size="24" summ="default" type="STRING"/>
					<colinfo id="BILAMT1" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="BILAMT2" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="BILAMT3" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="BUSSI" size="3" summ="default" type="STRING"/>
					<colinfo id="CHDAT" size="24" summ="default" type="STRING"/>
					<colinfo id="CHTIM" size="18" summ="default" type="STRING"/>
					<colinfo id="CRDAT" size="24" summ="default" type="STRING"/>
					<colinfo id="CRTIM" size="18" summ="default" type="STRING"/>
					<colinfo id="DTEXT2" size="250" summ="default" type="STRING"/>
					<colinfo id="DTEXT3" size="250" summ="default" type="STRING"/>
					<colinfo id="DTEXT4" size="250" summ="default" type="STRING"/>
					<colinfo id="ED_LIFNR" size="100" summ="default" type="STRING"/>
					<colinfo id="ERNAM" size="36" summ="default" type="STRING"/>
					<colinfo id="EXPENSE1" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="EXPENSE2" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="FLAG" size="0" summ="default" type="STRING"/>
					<colinfo id="KUNNR" size="30" summ="default" type="STRING"/>
					<colinfo id="KVGR1" size="9" summ="default" type="STRING"/>
					<colinfo id="KVGR2" size="9" summ="default" type="STRING"/>
					<colinfo id="LIFNR" size="100" summ="default" type="STRING"/>
					<colinfo id="MA_PSPID" size="45" summ="default" type="STRING"/>
					<colinfo id="MANDT" size="9" summ="default" type="STRING"/>
					<colinfo id="NAME1" size="105" summ="default" type="STRING"/>
					<colinfo id="NETWR" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="PERNR" size="30" summ="default" type="STRING"/>
					<colinfo id="PRDAT" size="24" summ="default" type="STRING"/>
					<colinfo id="PRTIM" size="18" summ="default" type="STRING"/>
					<colinfo id="PS_PSPID" size="54" summ="default" type="STRING"/>
					<colinfo id="QSTAT" size="3" summ="default" type="STRING"/>
					<colinfo id="QTDAT" size="24" summ="default" type="STRING"/>
					<colinfo id="QTNUM" size="45" summ="default" type="STRING"/>
					<colinfo id="REMARK" size="90" summ="default" type="STRING"/>
					<colinfo id="REQKIND" size="3" summ="default" type="STRING"/>
					<colinfo id="REQNO" size="30" summ="default" type="STRING"/>
					<colinfo id="REVENUE1" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="REVENUE2" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="RSTAT" size="3" summ="default" type="STRING"/>
					<colinfo id="RTEXT" size="180" summ="default" type="STRING"/>
					<colinfo id="SH_ADDR" size="180" summ="default" type="STRING"/>
					<colinfo id="SH_TYP" size="6" summ="default" type="STRING"/>
					<colinfo id="SHDAT" size="24" summ="default" type="STRING"/>
					<colinfo id="SPT" size="150" summ="default" type="STRING"/>
					<colinfo id="SUR_RATE" size="6" summ="default" type="DECIMAL"/>
					<colinfo id="SURCHARGE" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="TAXK1" size="3" summ="default" type="STRING"/>
					<colinfo id="VBELN" size="30" summ="default" type="STRING"/>
					<colinfo id="VBTYP" size="6" summ="default" type="STRING"/>
					<colinfo id="VKBUR" size="12" summ="default" type="STRING"/>
					<colinfo id="VKGRP" size="9" summ="default" type="STRING"/>
					<colinfo id="WAERS" size="15" summ="default" type="STRING"/>
					<colinfo id="WERKS" size="12" summ="default" type="STRING"/>
					<colinfo id="ZTERM" size="12" summ="default" type="STRING"/>
					<colinfo id="CODE2" size="2" summ="default" type="STRING"/>
					<colinfo id="SUM_AMT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_mbussi">
				<Contents>
					<colinfo id="BUSSI" size="31" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_days">
				<Contents>
					<colinfo id="DAYS" size="256" type="STRING"/>
					<record>
						<DAYS></DAYS>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_close_list">
				<Contents>
					<colinfo id="KND" size="180" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_close_cond">
				<Contents>
					<colinfo id="KUNNR" size="30" summ="default" type="STRING"/>
					<record>
						<KUNNR></KUNNR>
					</record>
				</Contents>
			</Dataset>
		</Datasets>
		<Shape BKColor="user12" Bottom="562" Height="26" Id="Shape5" Left="8" LineColor="user13" Right="966" TabOrder="49" Top="536" Type="Rectangle" Width="958"></Shape>
		<Shape BKColor="user12" Bottom="34" Height="26" Id="Shape1" Left="10" LineColor="user13" Right="968" TabOrder="24" Top="8" Type="Rectangle" Width="958"></Shape>
		<Static Align="Right" Height="24" Id="Static15" Left="656" Style="sty_lb_form_basic" TabOrder="28" Text="제경비&#32;" Top="9" VAlign="Middle" Width="86"></Static>
		<Static Align="Right" Height="24" Id="Static14" Left="441" Style="sty_lb_form_basic" TabOrder="27" Text="견적상태&#32;" Top="9" VAlign="Middle" Width="86"></Static>
		<Static Align="Right" Height="24" Id="Static11" Left="226" Style="sty_lb_form_basic" TabOrder="26" Text="견적번호&#32;" Top="9" VAlign="Middle" Width="86"></Static>
		<Static Align="Right" Height="24" Id="Static4" Left="11" Style="sty_lb_form_basic" TabOrder="25" Text="청구번호&#32;" Top="9" VAlign="Middle" Width="86"></Static>
		<MaskEdit BindDataset="ds_cs001" Border="Flat" Column="EXPENSE1" Enable="FALSE" Height="20" Id="me_expense1" Left="744" Readonly="TRUE" Style="sty_ipt_form" TabOrder="16" Top="11" Width="110"></MaskEdit>
		<MaskEdit BindDataset="ds_cs001" Border="Flat" Column="EXPENSE2" Enable="FALSE" Height="20" Id="me_expense2" Left="856" Readonly="TRUE" Style="sty_ipt_form" TabOrder="29" Top="11" Width="109"></MaskEdit>
		<Edit BindDataset="ds_cs001" Border="Flat" Column="REQNO" Height="20" Id="ed_reqno" Left="99" LeftMargin="4" MaxLength="10" RightMargin="4" Style="sty_ipt_form_ind" TabOrder="0" Top="11" Width="107"></Edit>
		<Edit BindDataset="ds_cs001" Border="Flat" Column="QTNUM" Enable="FALSE" Height="20" Id="ed_qtnum" Left="314" LeftMargin="4" MaxLength="10" RightMargin="4" Style="sty_ipt_form_ind" TabOrder="5" Top="11" Width="107"></Edit>
		<Edit Border="Flat" BorderColor="user13" Enable="FALSE" Height="20" Id="ed_qstat" InputPanel="FALSE" Left="529" LeftMargin="4" Readonly="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="15" Top="11" Width="125"></Edit>
		<Shape BKColor="user12" Bottom="59" Height="26" Id="Shape0" Left="10" LineColor="user13" Right="968" TabOrder="30" Top="33" Type="Rectangle" Width="958"></Shape>
		<Static Align="Right" Height="24" Id="Static0" Left="656" Style="sty_lb_form_basic" TabOrder="32" Text="일반관리비&#32;" Top="34" VAlign="Middle" Width="86"></Static>
		<Static Align="Right" Height="24" Id="Static3" Left="11" Style="sty_lb_form_basic" TabOrder="31" Text="고객&#32;" Top="34" VAlign="Middle" Width="86"></Static>
		<MaskEdit BindDataset="ds_cs001" Border="Flat" Column="ADMCOST1" Enable="FALSE" Height="20" Id="me_admcost1" Left="744" Mask="###,###" Readonly="TRUE" Style="sty_ipt_form" TabOrder="33" Top="36" Width="110"></MaskEdit>
		<MaskEdit BindDataset="ds_cs001" Border="Flat" Column="ADMCOST2" Enable="FALSE" Height="20" Id="me_admcost2" Left="856" Readonly="TRUE" Style="sty_ipt_form" TabOrder="34" Top="36" Width="109"></MaskEdit>
		<Edit BindDataset="ds_cs001" Border="Flat" Column="MA_PSPID" Enable="FALSE" Height="20" Id="ed_ma_pspid" Left="99" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="18" Top="36" Width="107"></Edit>
		<Edit BindDataset="ds_cs001" Border="Flat" Column="NAME1" DisableBKColor="user0" Enable="FALSE" Height="20" Id="ed_name1" Left="226" LeftMargin="4" Readonly="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="35" Top="36" Width="213"></Edit>
		<Shape BKColor="user12" Bottom="84" Height="26" Id="Shape2" Left="10" LineColor="user13" Right="968" TabOrder="36" Top="58" Type="Rectangle" Width="958"></Shape>
		<Static Align="Right" Height="24" Id="Static5" Left="656" Style="sty_lb_form_basic" TabOrder="39" Text="기업이윤&#32;" Top="59" VAlign="Middle" Width="86"></Static>
		<Static Align="Right" Height="24" Id="Static7" Left="226" Style="sty_lb_form_basic" TabOrder="38" Text="영업그룹&#32;" Top="59" VAlign="Middle" Width="86"></Static>
		<Static Align="Right" Height="24" Id="Static8" Left="11" Style="sty_lb_form_basic" TabOrder="37" Text="사업장&#32;" Top="59" VAlign="Middle" Width="86"></Static>
		<MaskEdit BindDataset="ds_cs001" Border="Flat" Column="REVENUE1" Enable="FALSE" Height="20" Id="me_revenue1" Left="744" Readonly="TRUE" Style="sty_ipt_form" TabOrder="40" Top="61" Width="110"></MaskEdit>
		<MaskEdit BindDataset="ds_cs001" Border="Flat" Column="REVENUE2" Enable="FALSE" Height="20" Id="me_revenue2" Left="856" Style="sty_ipt_form" TabOrder="41" Top="61" Width="109"></MaskEdit>
		<Shape BKColor="user12" Bottom="109" Height="26" Id="Shape3" Left="10" LineColor="user13" Right="968" TabOrder="42" Top="83" Type="Rectangle" Width="958"></Shape>
		<Static Align="Right" Height="24" Id="Static10" Left="441" Style="sty_lb_form_basic" TabOrder="45" Text="사업부구분&#32;" Top="84" VAlign="Middle" Width="86"></Static>
		<Static Align="Right" Height="24" Id="Static12" Left="226" Style="sty_lb_form_basic" TabOrder="44" Text="담당자&#32;" Top="84" VAlign="Middle" Width="86"></Static>
		<Static Align="Right" Height="24" Id="Static13" Left="11" Style="sty_lb_form_basic" TabOrder="43" Text="협력사&#32;" Top="84" VAlign="Middle" Width="86"></Static>
		<Edit BindDataset="ds_cs001" Border="Flat" Column="ED_LIFNR" Enable="FALSE" Height="20" Id="ed_lifnr" Left="99" LeftMargin="4" Readonly="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="19" Top="86" Width="125"></Edit>
		<Edit BindDataset="ds_cs001" Border="Flat" Enable="FALSE" Height="20" Id="ed_pernr" Left="314" LeftMargin="4" Readonly="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="23" TabStop="FALSE" Top="86" Width="125"></Edit>
		<Shape BKColor="user12" Bottom="134" Height="26" Id="Shape4" Left="10" LineColor="user13" Right="968" TabOrder="46" Top="108" Type="Rectangle" Width="958"></Shape>
		<Static Align="Right" Height="24" Id="Static18" Left="226" Style="sty_lb_form_basic" TabOrder="48" Text="납기일&#32;" Top="109" VAlign="Middle" Width="86"></Static>
		<Static Align="Right" Height="24" Id="Static19" Left="11" Style="sty_lb_form_basic" TabOrder="47" Text="청구구분&#32;" Top="109" VAlign="Middle" Width="86"></Static>
		<Edit Border="Flat" Enable="FALSE" Height="20" Id="ed_reqkind" Left="99" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="20" Top="111" Width="125"></Edit>
		<Combo BindDataset="ds_cs001" Border="Flat" CodeColumn="CODE" Column="VKGRP" DataColumn="CODE_NAME" Enable="FALSE" Height="20" Id="cb_vkgrp" InnerDataset="ds_vkgrp" Left="313" OnChanged="vkgrp_OnChanged" Style="sty_ipt_form" TabOrder="2" Top="60" Width="127"></Combo>
		<Calendar BindDataset="ds_cs001" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="SHDAT" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_shdat" Left="314" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" OnChanged="nb_OnChanged" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="4" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="111" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="125"></Calendar>
		<Combo BindDataset="ds_cs001" Border="Flat" CodeColumn="CODE" Column="VKBUR" DataColumn="CODE_NAME" Enable="FALSE" Height="20" Id="cb_vkbur" InnerDataset="ds_vkbur" Left="98" OnChanged="vkbur_onChanged" Style="sty_ipt_form" TabOrder="1" Top="60" Width="127"></Combo>
		<Grid AreaSelect="TRUE" AutoEnter="TRUE" AutoFit="TRUE" AutoFitEndLine="Hide" BindDataset="ds_list" BkColor2="default" BoldHead="true" Border="Flat" Bottom="384" CellMoving="TRUE" ColSelect="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="248" Id="grd_list" InputPanel="FALSE" Left="8" LineColor="user20" LineType="ExHORZ" MinWidth="100" Right="966" RowHeight="20" Style="sty_grid" TabOrder="22" TabStop="true" Top="136" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="958">
			<contents>
				<format id="Default">
					<columns>
						<col width="20"/>
						<col width="80"/>
						<col width="230"/>
						<col width="60"/>
						<col width="50"/>
						<col width="80"/>
						<col width="100"/>
						<col width="70"/>
						<col width="100"/>
						<col width="70"/>
						<col width="70"/>
						<col width="70"/>
						<col width="130"/>
					</columns>
					<head>
						<cell col="0" display="text"/>
						<cell align="center" col="1" color="user21" display="text" font="굴림,9" text="자재"/>
						<cell align="center" col="2" color="user21" display="text" font="굴림,9" text="자재Text"/>
						<cell align="center" col="3" color="user21" display="text" font="굴림,9" text="수량"/>
						<cell align="center" col="4" color="user21" display="text" font="굴림,9" text="단위"/>
						<cell align="center" col="5" color="user21" display="text" font="굴림,9" text="판매단가"/>
						<cell align="center" col="6" color="user21" display="text" font="굴림,9" text="금액"/>
						<cell align="center" col="7" color="user21" display="text" font="굴림,9" text="평가유형"/>
						<cell align="center" col="8" color="user21" display="text" font="굴림,9" text="호기"/>
						<cell align="center" col="9" color="user21" display="text" font="굴림,9" text="투입인원"/>
						<cell align="center" col="10" color="user21" display="text" font="굴림,9" text="표준공수"/>
						<cell align="center" col="11" color="user21" display="text" font="굴림,9" text="임율"/>
						<cell align="center" col="12" color="user21" display="text" font="굴림,9" text="비고"/>
					</head>
					<body>
						<cell bkimageid='expr:gfn_getFlagBkImageID(getColumn(currow,&#32;&quot;FLAG&quot;))' col="0" colid="FLAG" display="text"/>
						<cell align="center" bkcolor2="user22" col="1" colid="MATNR" display="text"/>
						<cell align="left" bkcolor2="user22" bkimagealign="right" bkimageid="icon_grid_edit" col="2" colid="MAKTX" display="text" edit="normal"/>
						<cell align="right" bkcolor2="user22" col="3" colid="MENGE" display="text"/>
						<cell align="center" bkcolor2="user22" col="4" colid="MEINS" display="text"/>
						<cell align="right" bkcolor2="user22" bkimagealign="left" bkimageid="icon_grid_edit" col="5" colid="NETPR" display="number" edit="number" Mask="###,###"/>
						<cell align="right" bkcolor2="user22" col="6" colid="NETWR" display="number" expr="MENGE*NETPR" Mask="###,###"/>
						<cell align="center" bkcolor2="user22" col="7" colid="BWTAR" combocol="CODE" combodataset="ds_bwtar" combotext="CODE_NAME" display="combo"/>
						<cell align="center" bkcolor2="user22" col="8" colid="HNA" display="text"/>
						<cell align="right" bkcolor2="user22" bkimagealign="left" col="9" colid="MAN" display="number"/>
						<cell align="right" bkcolor2="user22" bkimagealign="left" col="10" colid="JOBHOUR" display="number"/>
						<cell align="right" bkcolor2="user22" bkimagealign="left" col="11" colid="AMT" display="number" Mask="###,###"/>
						<cell align="left" bkcolor2="user22" bkimagealign="right" bkimageid="icon_grid_edit" col="12" colid="MAT_DESC" display="text" edit="normal"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Static Align="Right" Height="24" Id="Static1" Left="9" Style="sty_lb_form_basic" TabOrder="50" Text="특기사항&#32;" Top="537" VAlign="Middle" Width="106"></Static>
		<Shape BKColor="user12" Bottom="462" Height="26" Id="Shape6" Left="8" LineColor="user13" Right="966" TabOrder="51" Top="436" Type="Rectangle" Width="958"></Shape>
		<Static Align="Right" Height="24" Id="Static16" Left="9" Style="sty_lb_form_basic" TabOrder="52" Text="계산서구분&#32;" Top="437" VAlign="Middle" Width="106"></Static>
		<Static Align="Right" Height="24" Id="Static17" Left="241" Style="sty_lb_form_basic" TabOrder="53" Text="발송구분&#32;" Top="437" VAlign="Middle" Width="117"></Static>
		<Shape BKColor="user12" Bottom="487" Height="26" Id="Shape7" Left="8" LineColor="user13" Right="966" TabOrder="54" Top="461" Type="Rectangle" Width="958"></Shape>
		<Static Align="Right" Height="24" Id="st_bildat" Left="9" Style="sty_lb_form_basic" TabOrder="55" Text="계산서발행일&#32;1)&#32;" Top="462" VAlign="Middle" Width="106"></Static>
		<Static Align="Right" Height="24" Id="Static23" Left="472" Style="sty_lb_form_basic" TabOrder="56" Text="세금구분&#32;" Top="437" VAlign="Middle" Width="90"></Static>
		<Static Align="Right" Height="24" Id="Static24" Left="691" Style="sty_lb_form_basic" TabOrder="57" Text="수금조건&#32;" Top="437" VAlign="Middle" Width="81"></Static>
		<Shape BKColor="user12" Bottom="437" Height="26" Id="Shape8" Left="8" LineColor="user13" Right="966" TabOrder="58" Top="411" Type="Rectangle" Width="958"></Shape>
		<Static Align="Right" Height="24" Id="Static26" Left="9" Style="sty_lb_form_basic" TabOrder="59" Text="출하구분&#32;" Top="412" VAlign="Middle" Width="106"></Static>
		<Static Align="Right" Height="24" Id="Static27" Left="241" Style="sty_lb_form_basic" TabOrder="60" Text="출하주소&#32;" Top="412" VAlign="Middle" Width="118"></Static>
		<Shape BKColor="user12" Bottom="412" Height="26" Id="Shape9" Left="8" LineColor="user13" Right="966" TabOrder="61" Top="386" Type="Rectangle" Width="958"></Shape>
		<Static Align="Right" Height="24" Id="Static30" Left="9" Style="sty_lb_form_basic" TabOrder="62" Text="판가합계&#32;" Top="387" VAlign="Middle" Width="106"></Static>
		<Static Align="Right" Height="24" Id="Static31" Left="241" Style="sty_lb_form_basic" TabOrder="63" Text="할인액&#32;" Top="387" VAlign="Middle" Width="118"></Static>
		<Static Align="Right" Height="24" Id="Static32" Left="473" Style="sty_lb_form_basic" TabOrder="64" Text="할인율&#32;" Top="387" VAlign="Middle" Width="90"></Static>
		<Static Align="Right" Height="24" Id="st_amount" Left="689" Style="sty_lb_form_basic" TabOrder="65" Text="제안금액&#32;" Top="387" VAlign="Middle" Width="82"></Static>
		<Edit BindDataset="ds_cs001" Border="Flat" Column="SH_ADDR" Height="20" Id="ed_addr" Left="380" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="8" Top="414" Width="580"></Edit>
		<Edit BindDataset="ds_cs001" Border="Flat" Column="REMARK" Height="20" Id="ed_remark" Left="117" LeftMargin="4" MaxLength="30" RightMargin="4" Style="sty_ipt_form" TabOrder="14" Top="539" Width="838"></Edit>
		<Combo BindDataset="ds_cs001" Border="Flat" CodeColumn="CODE" Column="SH_TYP" DataColumn="CODE_NAME" Height="20" Id="cb_shtyp" InnerDataset="ds_shtyp" Left="116" Style="sty_ipt_form" TabOrder="7" Top="413" Width="124"></Combo>
		<Combo BindDataset="ds_cs001" Border="Flat" CodeColumn="CODE" Column="TAXK1" DataColumn="CODE_NAME" Height="20" Id="cb_taxk1" InnerDataset="ds_taxk1" Left="563" Style="sty_ipt_form" TabOrder="10" Top="438" Width="127"></Combo>
		<Combo BindDataset="ds_cs001" Border="Flat" CodeColumn="CODE" Column="ZTERM" DataColumn="CODE_NAME" Height="20" Id="cb_zterm" InnerDataset="ds_zterm" Left="773" Style="sty_ipt_form_ind" TabOrder="11" Top="438" Width="136"></Combo>
		<Combo BindDataset="ds_cs001" Border="Flat" CodeColumn="CODE" Column="KVGR2" DataColumn="CODE_NAME" Height="20" Id="cb_kvgr2" InnerDataset="ds_kvgr2" Left="359" Style="sty_ipt_form" TabOrder="13" Top="438" Width="112"></Combo>
		<Combo BindDataset="ds_cs001" Border="Flat" CodeColumn="CODE" Column="KVGR1" DataColumn="CODE_NAME" Height="20" Id="cb_kvgr1" InnerDataset="ds_kvgr1" Left="116" Style="sty_ipt_form" TabOrder="12" Top="438" Width="124"></Combo>
		<Calendar BindDataset="ds_cs001" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="BILDAT" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_bildat" Left="117" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="9" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="464" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="122"></Calendar>
		<MaskEdit BindDataset="ds_cs001" Border="Flat" Column="NETWR" Enable="FALSE" Height="20" Id="me_netwr" Left="117" Readonly="TRUE" Style="sty_ipt_form" TabOrder="66" Top="389" Width="121"></MaskEdit>
		<MaskEdit BindDataset="ds_cs001" Border="Flat" Column="SURCHARGE" Height="20" Id="me_surcharge" Left="361" Style="sty_ipt_form" TabOrder="6" Top="389" Width="110"></MaskEdit>
		<MaskEdit BindDataset="ds_cs001" Border="Flat" Column="SUR_RATE" DecimalLen="1" Enable="FALSE" Height="20" Id="me_sur_rate" Left="565" Mask="###.#" Readonly="TRUE" Style="sty_ipt_form" TabOrder="67" Top="389" Width="122"></MaskEdit>
		<MaskEdit BindDataset="ds_cs001" Border="Flat" Column="AMOUNT" Enable="FALSE" Height="20" Id="me_amount" Left="773" Style="sty_ipt_form" TabOrder="68" Top="389" Width="186"></MaskEdit>
		<Button Height="18" Id="bt_reqnr" ImageID="btn_icon_search" Left="207" OnClick="ufn_getReqNo" TabOrder="69" Text="Button0" Top="12" Width="18"></Button>
		<Button Height="18" Id="bt_qtnum" ImageID="btn_icon_search" Left="422" OnClick="btn_getQtnum" TabOrder="70" Text="Button0" Top="12" Width="18"></Button>
		<Button Height="18" Id="bt_prj" ImageID="btn_icon_search" Left="207" OnClick="btn_pjt_OnClick" TabOrder="71" Text="Button0" Top="37" Width="18"></Button>
		<Button Height="18" Id="bt_addr" ImageID="btn_icon_search" Left="361" OnClick="btn_addr_OnClick" TabOrder="21" Text="Button0" Top="415" Width="18"></Button>
		<Combo BindDataset="ds_cs001" Border="Flat" CodeColumn="CODE" Column="BUSSI" DataColumn="CODE_NAME" Height="20" Id="cb_bussi" InnerDataset="ds_bussi" Left="528" Style="sty_ipt_form" TabOrder="3" Top="85" Width="127"></Combo>
		<Edit BindDataset="ds_cs001" Border="Flat" Column="KUNNR" DisableBKColor="user0" Enable="FALSE" Height="20" Id="ed_kunnr" Left="280" LeftMargin="4" Readonly="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="72" Top="584" Visible="FALSE" Width="56"></Edit>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="bt_print" ImageID="btn_sub_07" Left="855" LeftMargin="12" OnClick="report_OnClick" Style="sty_btn" TabOrder="73" Text="부품요청서출력" Top="111" Transparent="TRUE" Width="108"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_kgs" ImageID="btn_sub_05" Left="770" LeftMargin="12" OnClick="gyeonJeok_OnClick" Style="sty_btn" TabOrder="74" Text="견적서출력" Top="111" Transparent="TRUE" Width="84"></Button>
		<Checkbox Height="21" Id="ch_vat" Left="673" TabOrder="75" Text="부가세&#32;포함" Top="112" Width="97"></Checkbox>
		<MaskEdit BindDataset="ds_cs001" Border="Flat" Column="SUM_AMT" Enable="FALSE" Height="20" Id="ed_sum_amt" Left="744" Readonly="TRUE" Style="sty_ipt_form" TabOrder="76" Top="86" Width="110"></MaskEdit>
		<Static Align="Right" Height="24" Id="Static2" Left="656" Style="sty_lb_form_basic" TabOrder="77" Text="임율&#32;합계&#32;" Top="85" VAlign="Middle" Width="86"></Static>
		<Static Align="Right" Height="24" Id="st_bilamt1" Left="241" Style="sty_lb_form_basic" TabOrder="79" Text="계산서&#32;발행금액&#32;1)" Top="462" VAlign="Middle" Width="117"></Static>
		<MaskEdit BindDataset="ds_cs001" Border="Flat" Column="BILAMT1" Height="20" Id="me_bilamt1" Left="360" Style="sty_ipt_form" TabOrder="78" Top="464" Width="110"></MaskEdit>
		<Shape BKColor="user12" Bottom="512" Height="26" Id="Shape10" Left="8" LineColor="user13" Right="966" TabOrder="80" Top="486" Type="Rectangle" Width="958"></Shape>
		<Static Align="Right" Height="24" Id="st_bildat2" Left="9" Style="sty_lb_form_basic" TabOrder="82" Text="계산서발행일&#32;2)&#32;" Top="487" VAlign="Middle" Width="106"></Static>
		<Calendar BindDataset="ds_cs001" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="BILDAT2" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Enable="FALSE" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_bildat2" Left="117" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="81" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="489" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="121"></Calendar>
		<Static Align="Right" Height="24" Id="st_bilamt2" Left="241" Style="sty_lb_form_basic" TabOrder="84" Text="계산서&#32;발행금액&#32;2)" Top="487" VAlign="Middle" Width="117"></Static>
		<MaskEdit BindDataset="ds_cs001" Border="Flat" Column="BILAMT2" Enable="FALSE" Height="20" Id="me_bilamt2" Left="360" Style="sty_ipt_form" TabOrder="83" Top="489" Width="110"></MaskEdit>
		<Shape BKColor="user12" Bottom="537" Height="26" Id="Shape11" Left="8" LineColor="user13" Right="966" TabOrder="85" Top="511" Type="Rectangle" Width="958"></Shape>
		<Static Align="Right" Height="24" Id="st_bildat3" Left="8" Style="sty_lb_form_basic" TabOrder="87" Text="계산서발행일&#32;3)&#32;" Top="512" VAlign="Middle" Width="106"></Static>
		<Calendar BindDataset="ds_cs001" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="BILDAT3" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Enable="FALSE" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_bildat3" Left="117" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="86" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="514" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="121"></Calendar>
		<Static Align="Right" Height="24" Id="st_bilamt3" Left="241" Style="sty_lb_form_basic" TabOrder="89" Text="계산서&#32;발행금액&#32;3)" Top="512" VAlign="Middle" Width="117"></Static>
		<MaskEdit BindDataset="ds_cs001" Border="Flat" Column="BILAMT3" Enable="FALSE" Height="20" Id="me_bilamt3" Left="360" Style="sty_ipt_form" TabOrder="88" Top="514" Width="110"></MaskEdit>
		<Checkbox Height="21" Id="cb_spbill" Left="475" OnClick="cb_spbill_OnClick" TabOrder="90" Text="계산서&#32;분할&#32;발행" Top="464" Width="120"></Checkbox>
		<Checkbox Height="21" Id="cb_bom" Left="605" OnClick="cb_spbill_OnClick" TabOrder="91" Text="BOM&#32;자재&#32;포함" Top="464" Value="FALSE" Width="120"></Checkbox>
	</Form>
	<Script><![CDATA[﻿﻿﻿﻿﻿﻿﻿﻿/*
 ******************************************************************************************
 * 기      능   : 
 * 작  성  자   : 
 * 작성  일자   : 
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
#include "LIB::commons.js";	// 공통 스크립트 
//=========================================================================================
// [ PART 1 ]
// Form에서 사용될 전역변수를 선언
// FORM에서 사용되는 전역변수는 대문자로 작성하며, F_XXX 의 형태를 갖도록 한다. 
//=========================================================================================
var cs001stat = "";
//=========================================================================================
// [ PART 2 ]
// Form Loading / Unloading 시 작업 정의
//=========================================================================================
function fn_OnLoadCompleted(obj) {
	gfn_initForm();
	

   // 사업장코드 DataSet 가져오기
    var codeArr = ["VKBUR","VKGRP","SHTYP","TAXK1","ZTERM","KVGR1","KVGR2","2","7","CS151","3"];
    var dsObjArr = [ds_vkbur,ds_vkgrp,ds_shtyp,ds_taxk1,ds_zterm,ds_kvgr1,ds_kvgr2,ds_bwtar,ds_qstat,ds_bussi,ds_reqkind];
    var addTypeArr = [G_CODE_ALL,G_CODE_ALL,G_CODE_NONE,G_CODE_NONE,G_CODE_NONE,G_CODE_NONE,G_CODE_NONE,G_CODE_NONE,G_CODE_NONE,G_CODE_NONE,G_CODE_NONE];
    gfn_searchCommCode(codeArr, dsObjArr, addTypeArr,true);
    ds_vkbur.SetColumn(0,"CODE_NAME","");

   	//   청구생성일 설정 
	 cal_shdat.value = gfn_getAfterDate(gfn_getCurrDate(), 10);
	// cal_bildat.value = gfn_getAfterDate(gfn_getCurrDate(), 20);  // 초기 loading시 공란 : 정병기 요청 - 20130628 hss
	
	// 담당자 조회전 저장 방지 2014.04.01 hss
    btn_save.enable = false;
    
    // 청구서 입력에서 호출된 경우 조건값 입력
	if ( isExistVar("fa_reqno", true) ) {
	   ed_reqno.value = fa_reqno;
	   ed_qtnum.value = fa_qtnum;
       fn_query();
	} else {     
	   gfn_showMsg("CI00007");
	}    
}
/********************************************************************************
* 기      능   : 공통코드가 조회된 후의 Callback 함수 
********************************************************************************/
function fn_completeInit(sCode, sDsObj, sCodeType) {
	cb_vkbur.Index = 0;
	cb_vkgrp.Index = 0;
	cb_shtyp.Index = 0;
	cb_taxk1.Index = 1;
	//cb_zterm.Index = 2;
	cb_kvgr1.Index = 1;
	cb_kvgr2.Index = 1;
	cb_bussi.Index = 0;
//	ds_zterm.Filter("CODE <= '0110')"); 
}
/********************************************************************************
* 기      능   : form UnloadCompleted 
********************************************************************************/
function fn_OnUnloadCompleted(obj) {
	return gfn_isFormUnload(obj);
}
//=========================================================================================
// [ PART 3 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,form닫기)
//=========================================================================================
/********************************************************************************
* 기      능   : 조회 1
********************************************************************************/
function fn_query() {
    // Message 영역 초기화
	global.FRM_BOTTOM.img_msgType.imageId = "";
	global.FRM_BOTTOM.st_msg.value = "";

	var user_grp = gfn_getUserGroup();
	ds_cond.SetColumn(0,"GBN", user_grp);
	
	if (gfn_isNull(ed_reqno,true,"청구번호", ed_reqno))
	{
		return;
	}

	ds_cond.SetColumn(0,"REQNO", ed_reqno.value);
	ds_cond.SetColumn(0,"QTNUM", ed_qtnum.value);
	
	//인건비 산출을 위해 현재 년도 추가 2012.08.10 이호영
	ds_cond.SetColumn(0,"ZYEAR", substr(gfn_getCurrDate(),0,4));
	//gfn_showAlert(ds_cond.GetColumn(0,"ZYEAR") );
	
	if (!isExistVar("fa_reqno", true) && gfn_isNull(ed_qtnum,true,"견적번호", ed_qtnum))
	{
		return;
	}

	tit_clearActionInfo();

	tit_addSearchActionInfo("cs31:CS3101001A_S2",true);

	// if (ed_qtnum.value != "")
	// {
		// tit_addSearchActionInfo("cs31:CS3101001A_S4",true);
	// }
	// else
	// {
    //  MMT031과 CST002를 한번에 읽어서 수정한다.200810.20
	tit_addSearchActionInfo("cs31:CS3101001A_S1",true);
	// }
	
	tit_callService(
        ""
        , ""
        , "ds_cond=ds_cond"
        , "ds_list=ds_list ds_cs001=ds_cs001"
        , ""
        , "fn_afterQuery"
        , true);
}
/********************************************************************************
* 기      능   : 삽입 20
********************************************************************************/
function fn_insert() {
}

/********************************************************************************
* 기      능   : 저장 
********************************************************************************/
function fn_save() {
    // Message 영역 초기화
	global.FRM_BOTTOM.img_msgType.imageId = "";
	global.FRM_BOTTOM.st_msg.value = "";
	
	if (ds_list.rowcount < 1)
	{
		return;
	}
	//유상청구, 수리공사의 경우만 세금계산서 발행일 check- 정병기 요청 20130719  hss(재고소진, 실패현장청구 추가-정병기)
	var tax = false;
	if(ds_cs001.GetColumn(0,"REQKIND") == "1" || ds_cs001.GetColumn(0,"REQKIND") == "7"
	   || ds_cs001.GetColumn(0,"REQKIND") == "6" || ds_cs001.GetColumn(0,"REQKIND") == "G")
	{
		tax = true;
	}

	if(ds_cs001.GetColumn(0,"QSTAT") != "0")
	{
		gfn_showAlert("CW00053","저장");
		return;
	}
    //변경값 확인
	if ( !gfn_isChangeDs(ds_list, false) && !gfn_isChangeDs(ds_cs001, false)) {
		// CW00005=변경된 정보가 없습니다.
		gfn_showAlert("CW00005");
		return;
	}
	
	if (gfn_isNull(ed_reqno,true,"청구번호", ed_reqno))
	{
		return;
	}

	// 사업장체크
	if ( gfn_isNull(cb_vkbur, true,"사업장", cb_vkbur) ) {
		return;
	}

	// 영업그룹체크
	if ( gfn_isNull(cb_vkgrp, true,"영업그룹", cb_vkgrp) ) {
		return;
	}

	// 공사번호체크
	if ( gfn_isNull(ed_ma_pspid, true,"고객", ed_ma_pspid) ) {
		return;
	}
	// 고객 체크
	if ( gfn_isNull(ed_kunnr, true,"고객번호", ed_kunnr) ) {
		return;
	}

	// 납기일 체크
	if ( gfn_isNull(cal_shdat, true,"납기일",cal_shdat) ) {
		return;
	}
	// 계산서 발행일 체크
	if (tax && gfn_isNull(cal_bildat, true,"계산서 발행일1)",cal_bildat) ) {
		return;
	}

	// 출하주소 체크
	if ( gfn_isNull(ed_addr, true,"출하주소", ed_addr) ) 
	{
		return;
	}

	// 사업장체크
	if ( gfn_isNull(cb_bussi, true,"사업부구분", cb_bussi) ) {
		return;
	}

	// 사업장체크
	if ( gfn_isNull(ed_pernr, true,"담당자", ed_pernr) ) {
		return;
	}
	
	// 수금조건
	if ( gfn_isNull(cb_zterm, true,"수금조건", cb_zterm) ) {
		return;
	}
		
	// 제안금액 체크
	if ( ds_cs001.GetColumn(0,"AMOUNT") < 1)  
	{
		gfn_showAlert("CW00001","제안금액");
		return;
	}

	if ( !gfn_checkDate( gfn_getCurrDate(),ds_cs001.GetColumn(0,"SHDAT") , true, cal_shdat,"납기일")) {
		return;
	}

	if (tax && !gfn_checkDate( gfn_getCurrDate(),ds_cs001.GetColumn(0,"BILDAT") , true, cal_bildat,"계산서발행일1)") ) {
		return;
	}
	
	for (var i = 0; i < ds_list.rowcount; i++)
	{
		if (length(ds_list.GetColumn(i,"MAKTX")) < 1)
		{
			gfn_showAlert("CW00001","자재Text");
			return;
		}
		
	}


		
    if (tax)
    {


		/*************************************************** 
		* 세금 계산서 발행일 분류에 따른 CHECK LOGIC 시작 *   // 20130625 정병기 요청  hss
		***************************************************/
		if((parseFloat(me_bilamt1.value) + parseFloat(me_bilamt2.value) + parseFloat(me_bilamt3.value)) != me_amount.value)
		{
			gfn_showAlert("CW00242");
			return;
		}
		if((parseInt(cal_bildat.value) > 0 && parseInt(me_bilamt1.value) <= 0) || (parseInt(cal_bildat.value) <= 0 && parseInt(me_bilamt1.value) > 0))
		{
			gfn_showAlert("CW00022", st_bildat.text+"/"+st_bilamt1.text);
			return;
		}
		if((parseInt(cal_bildat2.value) > 0 && parseInt(me_bilamt2.value) <= 0) || (parseInt(cal_bildat2.value) <= 0 && parseInt(me_bilamt2.value) > 0) )
		{
			gfn_showAlert("CW00022", st_bildat2.text+"/"+st_bilamt2.text);
			return;
		}
		if((parseInt(cal_bildat3.value) > 0 && parseInt(me_bilamt3.value) <= 0) || (parseInt(cal_bildat3.value) <= 0 && parseInt(me_bilamt3.value) > 0))
		{
			gfn_showAlert("CW00022", st_bildat3.text+"/"+st_bilamt3.text);
			return;
		}

		if ( parseInt(cal_bildat2.value) > 0 && !gfn_checkDate( gfn_getCurrDate(),ds_cs001.GetColumn(0,"BILDAT2") , true, cal_bildat2,"계산서발행일2)") ) {
			return;
		}
		if ( parseInt(cal_bildat3.value) > 0 && !gfn_checkDate( gfn_getCurrDate(),ds_cs001.GetColumn(0,"BILDAT3") , true, cal_bildat3,"계산서발행일3)") ) {
			return;
		}
		
		/*************************************************** 
		* 세금 계산서 발행일 제한 로직 추가 *   // 20130830 정병기
		***************************************************/		
		var days = 0;
		var gubun = "NB";
        
        //업체재고소진, 실패현장청구에 대해 수리공사, 부품판매 판단	
        if(ds_cs001.GetColumn(0,"REQKIND") == "6" || ds_cs001.GetColumn(0,"REQKIND") == "G") {
			for (var i = 0; i < ds_list.rowcount; i++) {    
				if (ds_list.GetColumn(i,"MATNR") = "NS-100") {
					gubun = "NS";    //자재 NS-100 포함시 수리공사
				}
			}
		}
			
		if(ds_cs001.GetColumn(0,"REQKIND") == "1") {             //부품판매 
			if(cb_bom.Value == "1") {
				days = 70;
			} else {
				days = 40;
			}
		} else if(ds_cs001.GetColumn(0,"REQKIND") == "7") {      //수리공사
			if(cb_bom.Value == "1") {
				if(ds_cs001.GetColumn(0,"AMOUNT") < 100000000) {  //1억미만
					days = 70;
				} else {                                          //1억 이상
					days = 100;
				}
			} else {
				if(ds_cs001.GetColumn(0,"AMOUNT") <= 30000000) {         //3천이하
					days = 50;
				} else if(ds_cs001.GetColumn(0,"AMOUNT") < 100000000) {  //1억미만
					days = 60;
				} else {                                                //1억이상
				    days = 100;
				}
			} 
		} else {
			if(gubun == "NB") {
				if(cb_bom.Value == "1") {
					days = 70;
				} else {
					days = 40;
				}
			} else {
				if(cb_bom.Value == "1") {
					if(ds_cs001.GetColumn(0,"AMOUNT") < 100000000) {  //1억미만
						days = 70;
					} else {                                          //1억 이상
						days = 100;
					}
				} else {
					if(ds_cs001.GetColumn(0,"AMOUNT") <= 30000000) {         //3천이하
						days = 50;
					} else if(ds_cs001.GetColumn(0,"AMOUNT") < 100000000) {  //1억미만
						days = 60;
					} else {                                                //1억이상
						days = 100;
					}
				}
			}
		}
			
		if(gfn_getDayCnt(ds_days, gfn_getCurrDate(), cal_bildat.value) > days) {  
			gfn_showAlert("계산서 발행예정일1이 기준일을 초과하였습니다. 현재+" + days + "일 이내");
			return;
		}	
	}
	
	/*************************************************** 
	* 세금 계산서 발행일 분류에 따른 CHECK LOGIC 종료 *
	***************************************************/
	
    // 저장확인
	if (!gfn_showConfirm("CI00010")) {
		return;
	}
	
	if (ds_list.GetColumn(0, "RECE_F") == "6"){
	 
	    if (ds_list.GetColumn(0, "REQKIND") == "2") {
			ds_cs001.SetColumn(0, "REQKIND", "1");
	    } else if (ds_list.GetColumn(0, "REQKIND") == "4"){
			ds_cs001.SetColumn(0, "REQKIND", "6");
		}
	}
    
    
    // AMOUNT 재계산
	ufn_setCalculate();
	ufn_SetDsListTail();
	
	// 저장 처리 
	tit_clearActionInfo();

	if (ds_cond.GetColumn(0,"QTNUM") == "")
	{	
		tit_addSearchActionInfo("cs31:CS3101001A_T1",true);
		tit_addSearchActionInfo("cs31:CS3101001A_S3",true);
	} else {
		ds_key.AddRow();
		ds_key.SetColumn(0,"QTNUM", ds_cs001.GetColumn(0,"QTNUM"));
		for (var i = 0; i < ds_list.rowcount; i++) {
			if (ds_list.GetColumn(i, "FLAG") == "") {
				ds_list.SetColumn(i, "FLAG", "U");
			}
			if (ds_list.GetColumn(i, "QTNUM") == "") {
				ds_list.SetColumn(i, "QTNUM", ds_cs001.GetColumn(0,"QTNUM"));
			} 
		}
	}
	
	// CS001
	tit_addSaveActionInfo(
        "cs31:CS3101001A_I1"
        ,"cs31:CS3101001A_U2"
        , ""
        , "FLAG"
        , ""
        , 0
        , "");
    
    //CS002
	tit_addSaveActionInfo(
        "cs31:CS3101001A_I2"
        , "cs31:CS3101001A_U3"
        , ""
        , "FLAG"
        ,""
        , 0
        , "");

	// MMT031
	tit_addSaveActionInfo(
		"cs31:CS3101001A_U1"
		, ""
		, ""
		, "FLAG"
		,""
		, 0
		, "");

	//  MMT011
//	tit_addMultiActionInfo("cs31:CS3101001A_U4");
        
	tit_callService(
        ""
        , ""
        , "ds_cs001=ds_cs001 ds_list=ds_list:A ds_cond=ds_cond ds_key=ds_key"
        , "ds_key = ds_key"
        , ""
        , "fn_afterSave");
}
/********************************************************************************
* 기      능   : 닫기  
********************************************************************************/
function fn_close() {
	close();
}
/********************************************************************************
* 기      능   : 액셀  
********************************************************************************/
function fn_excel() {
	// Excel Export 
	gfn_saveToExcel(grd_list, true );
}

/********************************************************************************
* 기      능   : 취소 35
********************************************************************************/
function fn_delete() {

	if (ds_cs001.rowcount > 0)
	{
		if(ds_cs001.GetColumn(0,"QSTAT") != "0" && ds_cs001.GetColumn(0,"QSTAT") != "5")
		{
			gfn_showAlert("CW00053","삭제");
			return;
		}
		// 저장확인
		if (!gfn_showConfirm("CI00010")) {
			return;
		}
		
		ed_qtnum.value = "";
		tit_clearActionInfo();

		 // MMT031
		tit_addMultiActionInfo("cs31:CS3101001A_U5");

		//  CST001
		tit_addMultiActionInfo("cs31:CS3101001A_D1");
			
		//  CST002
		tit_addMultiActionInfo("cs31:CS3101001A_D2");

		tit_callService(
			""
			, ""
			, "ds_cs001=ds_cs001:A ds_list=ds_list:A"
			, ""
			, ""
			, "fn_afterDelete");
	}
	else
	{
		gfn_showMsg("CW00054");
		return;
	}
}



function fn_afterDelete(errCode, errMsg){
	if ( errCode!= 0 ) {
		gfn_showMsg("CE00001");
	} else {
		gfn_showMsg("CI00003");
		fn_query();
	}
}

/********************************************************************************
* 기      능   : print 40
********************************************************************************/
function fn_print() {

	if (ds_list.rowcount < 1)
	{
		gfn_showAlert("CW00013");
		return;
	}

	// UbiReport Call
	report_OnClick("");
}
/********************************************************************************
* 기      능   : 발행 50
********************************************************************************/
function fn_out() {

}
/********************************************************************************
* 기      능   : 신청 55
********************************************************************************/
function fn_request() {

}
/********************************************************************************
* 기      능   : 전송 60
********************************************************************************/
function fn_trans() {

}
/********************************************************************************
* 기      능   : 반송 65
********************************************************************************/
function fn_sendback() {

}
/********************************************************************************
* 기      능   : 계산 70
********************************************************************************/
function fn_cal() {

}
/********************************************************************************
* 기      능   : 복사 75
********************************************************************************/
function fn_copy() {

}
/********************************************************************************
* 기      능   : 확인 80
********************************************************************************/
function fn_confirm() {

}
//=========================================================================================
// [ PART 4]
// Callback 함수 정의 : callback 함수명은 메인 함수의 fn_xxxx() 에서 xxxx 부분은 fn_afterXXXX()
// 형태가 되도록 작성 
//=========================================================================================
/********************************************************************************
* 기      능   : 조회 Callback  
********************************************************************************/
function fn_afterQuery(errCode, errMsg) {
	// 메시지 처리 
	gfn_showSearchMsg(grd_list);

// 견적번호 있을 때 임율 표기 2012.08.21 이호영
	var sum_amt = 0;
	sum_amt = ds_list.Sum("AMT");
	ds_cs001.SetColumn(0,"SUM_AMT", sum_amt);
	// var sum_amt = 0;
	// sum_amt = ds_list.Sum("AMT");
    ////ed_sum_amt.Value = 	sum_amt;
    ////gfn_showalert(ed_sum_amt+"2");	
    // gfn_showalert(sum_amt);	
	// ds_cs001.SetColumn(0,"SUM_AMT", sum_amt);
	// gfn_showalert(ds_cs001.GetColumn(0,"SUM_AMT"));	

	if (length(ds_cs001.GetColumn(0,"QTNUM")) < 1)
	{

		ds_cs001.AddRow();
        
        //임율 계산 추가 2012.08.21 이호영 
		// 견적번호 없을 때에만 임율 표기 2012.08.21 이호영
		// var sum_amt = 0;
		// sum_amt = ds_list.Sum("AMT");
		// ds_cs001.SetColumn(0,"SUM_AMT", sum_amt);

		ed_lifnr.value = G_VEND_NAME;
		ds_cs001.SetColumn(0,"LIFNR", G_VEND_CODE_R);
		ds_cs001.SetColumn(0,"REQNO", ds_cond.GetColumn(0,"REQNO"));
		ds_cs001.SetColumn(0,"QTNUM", ds_cond.GetColumn(0,"QTNUM"));
		ds_cs001.SetColumn(0,"SURCHARGE", 0);

		//trace(ds_list.SaveXML());
		
		cb_vkbur.Index = 0;
		cb_vkgrp.Index = 0;
		cb_shtyp.Index = 0;
		cb_taxk1.Index = 1;
		cb_zterm.Index = 2;
		cb_kvgr1.Index = 1;
		cb_kvgr2.Index = 1;
	
		//cb_bussi.Index = 0;
		// 견적상태
		ed_qstat.value = ds_qstat.GetColumn(0,"CODE_NAME");
		ds_cs001.SetColumn(0,"QSTAT", "0");
		// 청구구분
		ds_cs001.SetColumn(0,"REQKIND", ds_list.GetColumn(0,"REQKIND")); 
		// 청구구분 표시 
		var nRow = ds_reqkind.searchRow("CODE== " + quote(ds_cs001.GetColumn(0,"REQKIND")));
		ed_reqkind.value = ds_reqkind.GetColumn(nRow,"CODE_NAME"); 

		//   청구생성일 설정 
		//cal_bildat.value = gfn_getCurrDate(); // 초기 loading시 공란 : 정병기 요청 - 20130628 hss

		cal_shdat.value = gfn_getCurrDate();
		
		ds_cs001.SetColumn(0, "FLAG", "I");
		
		ds_mbussi.ClearData();
		
		tit_clearActionInfo();
	
		tit_addSearchActionInfo("cs31:CS3101001A_S10",true);
		
		tit_callService(
			""
			, ""
			, "ds_cond=ds_cond"
			, "ds_mbussi=ds_mbussi"
			, ""
			, "fn_afterBussiQuery"
			, true);		
	}
	else
	{
		// 견적상태
		var nRow = ds_qstat.searchRow("CODE== " + quote(ds_cs001.GetColumn(0,"QSTAT")));
		ed_qstat.value = ds_qstat.GetColumn(nRow,"CODE_NAME");

		// 청구구분
		var nRow = ds_reqkind.searchRow("CODE== " + quote(ds_cs001.GetColumn(0,"REQKIND")));
		ed_reqkind.value = ds_reqkind.GetColumn(nRow,"CODE_NAME");
		ds_cs001.SetColumn(0, "FLAG", "U");

		if (gfn_getUserGroup() != "10" && gfn_getUserGroup() != "40"){
			btn_save.Enable = false;
		}		
	}
	
	// 담당자 조회처리 
	ds_pe_cond.SetColumn(0,"LIFNR", ds_cs001.GetColumn(0,"LIFNR"));
	tit_clearActionInfo();
	tit_addSearchActionInfo("cs31:CS3101001A_S6");
	tit_addSearchActionInfo("cs31:CS3101001A_S9");

	if (length(ds_cs001.GetColumn(0,"QTNUM")) > 0)
	{
		if (substr(ds_cs001.GetColumn(0,"REQNR", 0),0,1) == "3")
		{
			ds_cond.setColumn(0,"GBN", "Y");
		}
		else
		{
			ds_cond.setColumn(0,"GBN", "N");
		}
		ds_cond.SetColumn(0,"REQNO", ds_cs001.GetColumn(0,"REQNR", 0));
		ds_cond.SetColumn(0,"QTNUM", ds_cs001.GetColumn(0,"QTNUM", 0));
		
		tit_addSearchActionInfo("cs31:CS3101001A_S8");

		tit_callService(
			""
			,""
			, "ds_pe_cond=ds_pe_cond ds_cond=ds_cond"
			, "ds_pe_list=ds_pe_list ds_detail=ds_detail ds_area=ds_area"
			, ""
			, "ufn_setCName1"
			, false
			, true);
	}
	else
	{
	tit_callService(
		""
		,""
		, "ds_pe_cond=ds_pe_cond"
		, "ds_pe_list=ds_pe_list ds_area=ds_area"
		, ""
		, "ufn_setCName1"
		, false
		, true);
	}
    
    // 접수, 승인이후에도 출력이 가능하게 2008.09.12
	if (ds_cs001.GetColumn(0,"QTNUM") != "" && 
	         ds_cs001.GetColumn(0,"QSTAT") != "0" && ds_cs001.GetColumn(0,"QSTAT") != "5")
	{
		ufn_enableBtn("delete", false);
		ufn_enableBtn("save", false);
		grd_list.Editable = false;
		bt_prj.enable = false;
		cb_vkbur.enable = false;
		cb_vkgrp.enable = false;
		cb_bussi.enable = false;
		cal_shdat.enable = false;
		me_surcharge.enable = false;
		cb_shtyp.enable = false;
		bt_addr.enable = false;
		ed_addr.enable = false;
		cal_bildat.enable = false;
		cb_taxk1.enable = false;
		cb_zterm.enable = false;
		cb_kvgr1.enable = false;
		cb_kvgr2.enable = false;
		ed_remark.enable = false;
	}

	/******************************************************* 
	* 세금 계산서  분할 발행여부 확인후 관련 필드 enable *     //- 20130625 hss
	*******************************************************/
	
	if (parseInt(ds_cs001.GetColumn(0,"BILDAT2")) > 0)
	{
		cb_spbill.Value = "1";
	}
	else {
		cb_spbill.Value = "0";
	}
	cb_spbill_OnClick();
	
//trace(ds_list.SaveXML());

}


/********************************************************************************
* 기      능   : 사업부 입력
********************************************************************************/

function fn_afterBussiQuery(errCode, errMsg) {
	if (ds_mbussi.RowCount() > 0)
	{
		ds_cs001.SetColumn(0,"BUSSI",ds_mbussi.GetColumn(0,"BUSSI"));
	}
}

/********************************************************************************
* 기      능   : 담당자 Callback 설정
********************************************************************************/

function ufn_setCName1()
{
	var bis = ds_cs001.GetColumn(0,"BUSSI");

	if ( ds_pe_list.rowcount > 0)
	{
		ds_cs001.SetColumn(0,"PERNR",ds_pe_list.GetColumn(0,"PERNR"));
		ed_pernr.value = ds_pe_list.GetColumn(0,"ED_PERNR");
		
		if (length(ds_cs001.GetColumn(0,"VKBUR")) < 1 && length(ds_pe_list.GetColumn(0,"VKBUR"))> 0)
		{
			switch (bis)
			{
				case "1": //ds_cs001.SetColumn(0,"VKBUR", "E5" +"00");  // wbt010 VKBUR 	 
				         ds_cs001.SetColumn(0,"VKBUR", ds_pe_list.GetColumn(0,"VKBUR"));
						 break;
				case "2": ds_cs001.SetColumn(0,"VKBUR", "C7" +"00");
						 break;
				case "3": ds_cs001.SetColumn(0,"VKBUR", "C6" +"00");
						 break;
				case "4": ds_cs001.SetColumn(0,"VKBUR", "C8" +"00");
						 break;
				default : ds_cs001.SetColumn(0,"VKBUR", ds_pe_list.GetColumn(0,"VKBUR"));
				         break;
			}			
		}
		if (length(ds_cs001.GetColumn(0,"VKGRP")) < 1 && length(ds_pe_list.GetColumn(0,"VKGRP"))> 0)
		{			
			switch (bis)
			{
				case "1": ds_cs001.SetColumn(0,"VKGRP", ds_pe_list.GetColumn(0,"VKGRP"));; 
						 break;
				case "2":
				         if(subStr(ds_pe_list.GetColumn(0,"VKGRP"),2) < "A")
				         {
							ds_cs001.SetColumn(0,"VKGRP", "C76");
				         } else{
							ds_cs001.SetColumn(0,"VKGRP", "C7" + subStr(ds_pe_list.GetColumn(0,"VKGRP"),2));
				         }
				         
						 break;
				case "3": ds_cs001.SetColumn(0,"VKGRP", "C61");
						 break;
				case "4": ds_cs001.SetColumn(0,"VKGRP", "C86");
						 break;
				default : ds_cs001.SetColumn(0,"VKGRP",ds_pe_list.GetColumn(0,"VKGRP"));
				         break;
			}			
		}
		else
		{
			vkbur_onChanged();
		}
	}
	if ( ds_area.rowcount > 0)
	{
		ds_cs001.SetColumn(0,"DTEXT2",ds_area.GetColumn(0,"DTEXT2"));
		ds_cs001.SetColumn(0,"DTEXT3",ds_area.GetColumn(0,"DTEXT3"));
		ds_cs001.SetColumn(0,"DTEXT4",ds_area.GetColumn(0,"DTEXT4"));
		ds_cs001.SetColumn(0,"CODE2",ds_area.GetColumn(0,"CODE2"));
	}
	
	// 담당자 조회전 저장 방지 2014.04.01 hss
	btn_save.enable = true;
}

/********************************************************************************
* 기      능   : 저장 Callback  
********************************************************************************/
function fn_afterSave(errCode, errMsg) {
	if ( errCode!= 0 ) {
		gfn_showMsg("CE00001");
	} else {
		gfn_showMsg("CI00003");

		if(length(ds_cond.GetColumn(0,"QTNUM")) > 0)
		{
			ed_qtnum.value = ds_cond.GetColumn(0,"QTNUM");
		}
		else
		{
			ed_qtnum.value = ds_key.GetColumn(0,"QTNUM");
		}
		
		fn_query();
	}
}

//=========================================================================================
// [ PART 5 ]
// Detail Process Event 정의 ( User Define function )
// 사용자 정의 함수는 ufn_xxxx() 형태로 작성 
//=========================================================================================
/********************************************************************************
* 기      능   : 사용자 정의 함수  
********************************************************************************/
function ufn_setCalculate()
{
	var nwr = 0;
	var iwr = 0;

	ds_list.fireevent = false;
	for (var i = 0; i < ds_list.RowCount(); i++)
	{
        ds_list.SetColumn(i, "NETWR", ds_list.GetColumn(i,"MENGE") * ds_list.GetColumn(i,"NETPR"));
		//ds_list.SetColumn(i, "NETWR", (ds_list.GetColumn(i,"MENGE") * ds_list.GetColumn(i,"NETPR")) + ds_list.GetColumn(i,"AMT"));
	}
	
	ds_list.fireevent = true;
	nwr = ds_list.Sum("NETWR");
	ds_cs001.SetColumn(0,"NETWR", nwr);
	
	ds_list.fireevent = false;
	ds_list.Filter("substr(MATNR,0,2) == 'NS'");
	iwr = ds_list.Sum("NETWR");
	ds_list.UnFilter();
	ds_list.fireevent = true;
	
	var sur = 0;
	var sur1 = 1;
	
	if (me_surcharge.value != 0)
	{
		sur = Round((ds_cs001.GetColumn(0,"SURCHARGE") / nwr), 3);
		sur1 = 1-sur;
	}

	ds_cs001.SetColumn(0,"SUR_RATE", Round(sur*100 , 1));
	ds_cs001.SetColumn(0,"EXPENSE1", Round(nwr * 0.05 , 0));
	ds_cs001.SetColumn(0,"ADMCOST1", Round((nwr+ds_cs001.GetColumn(0,"EXPENSE1")) * 0.1 , 0));
	ds_cs001.SetColumn(0,"REVENUE1", Round((iwr+ds_cs001.GetColumn(0,"EXPENSE1")+ds_cs001.GetColumn(0,"ADMCOST1")) * 0.1 , 0));
	if (sur > 0) {
		ds_cs001.SetColumn(0,"EXPENSE2", Round(ds_cs001.GetColumn(0,"EXPENSE1") * sur1 , 0));
		ds_cs001.SetColumn(0,"ADMCOST2", Round(ds_cs001.GetColumn(0,"ADMCOST1") * sur1 , 0));
		ds_cs001.SetColumn(0,"REVENUE2", Round(ds_cs001.GetColumn(0,"REVENUE1") * sur1 , 0));
	} else {
		ds_cs001.SetColumn(0,"EXPENSE2", 0);
		ds_cs001.SetColumn(0,"ADMCOST2", 0);
		ds_cs001.SetColumn(0,"REVENUE2", 0);
	}
    
    //임율 계산 추가 parseInt 부분 추가 2012.08.21 이호영
	//ds_cs001.SetColumn(0,"AMOUNT", (nwr - ds_cs001.GetColumn(0,"SURCHARGE") + parseInt(ds_cs001.GetColumn(0,"SUM_AMT"))));
	ds_cs001.SetColumn(0,"AMOUNT", (nwr - ds_cs001.GetColumn(0,"SURCHARGE")));
	
	for (var i = 0; i < ds_list.RowCount(); i++)
	{
		if (ds_cs001.GetColumn(0,"SUR_RATE") != 0)
		{
			ds_list.SetColumn(i, "AMOUNT", (ds_list.GetColumn(i,"NETWR") * (1-sur)));
		} else if (ds_cs001.GetColumn(0,"SUR_RATE") == 0) {
			ds_list.SetColumn(i, "AMOUNT", ds_list.GetColumn(i,"NETWR"));
		}
	}
	//gfn_showalert(ds_list.GetColumn(0, "NETWR"));
}
//=========================================================================================
// [ PART 6 ]
// component Event 정의 : 각 Component 별 이벤트 
//=========================================================================================
/********************************************************************************
* 기      능   : 그리드 헤더 클릭시 정렬 처리 
********************************************************************************/
function grd_list_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
{
	if ( nCell == 0 ) {
		// 그리드 표시할 컬럼 선택 
		gfn_selectGridCol(obj);
	} else {
		// 그리드 정렬 처리 
		gfn_sortGrid(obj,nCell);
	}
}



/********************************************************************************
* 기      능   : 고객명 조회
********************************************************************************/

function ufn_getName1(obj,strText)
{
    // Message 영역 초기화
	global.FRM_BOTTOM.img_msgType.imageId = "";
	global.FRM_BOTTOM.st_msg.value = "";

	ds_cu_cond.SetColumn(0,"KUNNR", ds_cs001.GetColumn(0,"KUNNR"));
	
	tit_clearActionInfo();
	// 저장 처리 
	tit_addSearchActionInfo("cs31:CS3101001A_S5");

	tit_callService(
		""
		,""
		, "ds_cu_cond=ds_cu_cond"
		, "ds_cu_list=ds_cu_list"
		, ""
		, "ufn_setName1"
		, false
		, true);
}



/********************************************************************************
* 기      능   : 고객명 Callback 설정
********************************************************************************/

function ufn_setName1()
{
	if ( ds_cu_list.rowcount > 0)
	{
		ds_cs001.SetColumn(0,"NAME1",ds_cu_list.GetColumn(0,"NAME1"));
	}
	else
	{
		gfn_showAlert("CW00052");
		ed_kunnr.SetFocus();
	}
}


/********************************************************************************
* 기      능   : 납기일 변경시
********************************************************************************/

function nb_OnChanged(obj,strOldText,strNewText)
{
	if (strNewText == "")
	{
		return;
	}
	// cal_bildat.text = strNewText;   // 초기 loading시 공란 : 정병기 요청 - 20130628 hss
}

function ds_cs001_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{
	switch(strColumnID)
	{
		case "SURCHARGE" : 
					ufn_setCalculate();
					break;
		case "AMOUNT" :
					ufn_SetDsListTail();
					break;

	}
	if (cs001stat == "1")
	{
		obj.SetColumn(nRow, "FLAG", "U");
	}
}

//임율 계산 추가 ds_list.Sum("AMT")부분 추가 2012.08.21 이호영
function ufn_SetDsListTail()
{
	var amount = parseInt(ds_list.GetColumn(ds_list.lastrow, "AMOUNT"));
	var cha =  parseInt(ds_cs001.GetColumn(0, "AMOUNT")) - parseInt(ds_list.Sum("AMOUNT")); 
	if (cha != 0)
	{
		ds_list.SetColumn(ds_list.lastrow, "AMOUNT", amount + cha);
	}
}



function btn_getQtnum(obj)
{
	var qtnum = gfn_openPopup("CS9601004A", true);

	if (qtnum != null && length(qtnum) >0) {
		ed_qtnum.value = qtnum[0];
		ed_reqno.value = qtnum[1];
		fn_query();
	}
}

function btn_addr_OnClick(obj)
{
	var addr = gfn_openPopup("CS9601003A", true);
	ed_addr.value = addr;
}

function ufn_getReqNo(obj)
{
	var reqcond = null;
	reqcond = gfn_openPopup("MM0901003A", true);
	
    if (reqcond !=null && length(reqcond) > 0) {
		ed_reqno.value = reqcond[0];
	}
}

function btn_pjt_OnClick(obj)
{
	var kunnr = gfn_openPopup("CS9601001A", true);

	if (kunnr != null) {
		if (kunnr[1] == null || length(kunnr[1]) < 3) {
			gfn_showAlert("CW00022","거래선");
			return;
		}
		if (kunnr[4] == null || length(kunnr[4]) == 0){
			gfn_showAlert("CW00080");
			return;
		}
		ed_ma_pspid.value = kunnr[0]+kunnr[1];
		ed_name1.value = kunnr[3];
		ed_kunnr.value = kunnr[4];
		ed_addr.value = kunnr[5]+" "+kunnr[6];
		
		
		ds_close_cond.SetColumn(0,"KUNNR",kunnr[4]);
		
		tit_clearActionInfo();
		// 저장 처리 
		tit_addSearchActionInfo("cs31:CS3101001A_S11");

		tit_callService(
			""
			,""
			, "ds_close_cond=ds_close_cond"
			, "ds_close_list=ds_close_list"
			, ""
			, "fn_isClose_kunnrafter()"
			, false
			, true);	
	}
}



//  견적서 출력
function gyeonJeok_OnClick()
{
	if (ds_cs001.GetColumn(0,"QSTAT") == "0" || ds_cs001.GetColumn(0,"QSTAT") == "1" 
	    || ds_cs001.GetColumn(0,"QSTAT") == "2" || ds_cs001.GetColumn(0,"QSTAT") == "3")
	{
		gfn_copyDs(ds_list, ds_list_0, "SubStr(MATNR,0,2) != " + "'NS'");
		gfn_copyDs(ds_list, ds_list_1, "SubStr(MATNR,0,2) = " + "'NS'");

        var	arg = " fa_cnt=" + quote(ds_list_0.GetRowCount());
        arg += " fa_sum_amount="+ quote(ds_list_0.Sum("AMOUNT"));
        arg += " fa_cnt1=" + quote(ds_list_1.GetRowCount());
        arg += " fa_sum_amount1="+ quote(ds_list_1.Sum("AMOUNT"));
		arg += " fa_vat=" + quote(ch_vat.value);

        //  금액 한글 표현
        var total = Truncate((ds_cs001.GetColumn(0,"AMOUNT") +ds_cs001.GetColumn(0,"EXPENSE1")+ds_cs001.GetColumn(0,"ADMCOST1")
                   +ds_cs001.GetColumn(0,"REVENUE1"))/1000)*1000;
        //임율 총합계 계산에서 제외 2012.10.08 이호영 
        //var total = Truncate((ds_cs001.GetColumn(0,"AMOUNT") +ds_cs001.GetColumn(0,"EXPENSE1")+ds_cs001.GetColumn(0,"ADMCOST1")
        //           +ds_cs001.GetColumn(0,"REVENUE1")+parseInt(ds_cs001.GetColumn(0,"SUM_AMT")))/1000)*1000;

        
        // var total = Truncate((ds_cs001.GetColumn(0,"AMOUNT") +ds_cs001.GetColumn(0,"EXPENSE1")+ds_cs001.GetColumn(0,"ADMCOST1")
                   // +ds_cs001.GetColumn(0,"REVENUE1")+ds_cs001.GetColumn(0,"SUM_AMT"))/1000)*1000;
        if (ch_vat.value == "1"){
			total = total * 1.1;
        }                   
        //+parseInt(ds_cs001.GetColumn(0,"SUM_AMT"))           
        arg += " fa_kum="+ quote(total);
        arg += " fa_total="+ gfn_changeStringNum(total,0);

		//arg += " fa_sum_amt="+ quote(ds_list_0.Sum("AMT"));
		arg += " fa_sum_amt="+ quote(ds_cs001.GetColumn(0,"SUM_AMT"));
		
		//trace(ds_list_1.SaveXML());
		
		//UbiReport Call
		 Dialog("CS31::CS3101001B.xml", arg);	
	}
}

//  부품교체 요청서 출력
function report_OnClick()
{
	var amount = Truncate(ds_cs001.GetColumn(0,"AMOUNT"));
	
	if (ch_vat.value == "1"){
		amount = Truncate(amount * 1.1);
	}
	var arg = " fa_amount=" + quote(amount);
	arg += " fa_vat=" + quote(ch_vat.value);

    if (ds_cs001.GetColumn(0,"REQKIND") == '9' || ds_cs001.GetColumn(0,"REQKIND") == 'H')
    {
		Dialog("CS31::CS3101001D.xml", arg);
    }
    else
    {
		Dialog("CS31::CS3101001C.xml", arg);	
    }

}

function vkbur_onChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	if (length(cb_vkbur.value) > 0)
	{
		ds_vkgrp.Filter("SubStr(CODE,0,2) ==" + quote(substr(cb_vkbur.value,0,2)));
		//cb_vkgrp.Index = 0;
	}
	else
	{
		ds_vkgrp.Filter("1=1");
		//cb_vkgrp.Index = 0;
	}
}

function vkgrp_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	if (length(cb_vkbur.value) < 1)
	{
		gfn_showAlert("CW00022","사업장");
		//cb_vkgrp.Index = 0;
		return;
	}
}

/********************************************************************************
* 기      능   : 데이터셋 값 변경 시 - Flag 처리 
********************************************************************************/
function ds_list_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{
	switch(strColumnID)
	{
		case "MAKTX" :
					if (length(ds_list.GetColumn(nrow, "QTNUM")) == 0)
					{
						obj.SetColumn(nRow, "FLAG", "I");
					}
					else
					{
						obj.SetColumn(nRow, "FLAG", "U");
					}
					
					break;
		case "NETPR" : 
					ufn_setCalculate();
					if (length(ds_list.GetColumn(nrow, "QTNUM")) == 0)
					{
						obj.SetColumn(nRow, "FLAG", "I");
					}
					else
					{
						obj.SetColumn(nRow, "FLAG", "U");
					}
					break;
	}
}


	/***************************************************** 
	 * 세금 계산서 분할 발챙 선택 체크시 기타 필드 처리  *  // - 20130625 hss
	 *****************************************************/ 
	
function cb_spbill_OnClick()
{
	if(cb_spbill.Value == "1")
	{
		cal_bildat2.enable = true;
		me_bilamt2.enable = true;
		cal_bildat3.enable = true;
		me_bilamt3.enable = true;
	} else {
		cal_bildat2.enable = false;
		me_bilamt2.enable = false;
		cal_bildat3.enable = false;
		me_bilamt3.enable = false;
		
		me_bilamt1.value = parseFloat(me_bilamt1.value) + parseFloat(me_bilamt2.value) + parseFloat(me_bilamt3.value);
		cal_bildat2.value = "";
		me_bilamt2.value = 0;
		cal_bildat3.value = "";
		me_bilamt3.value = 0;
	}
}




function fn_isClose_kunnrAfter()
{
	if (ds_close_list.rowcount > 0)
	{
		ds_cs001.fireevent = false;
		var arr = [ed_posid.value, "폐업 거래선"];
	    
		gfn_showAlert("CW00193",arr);
		ed_ma_pspid.value = "";
		ed_name1.value = "";
		ds_cs001.fireevent = true;
	}
}
]]></Script>
</Window>