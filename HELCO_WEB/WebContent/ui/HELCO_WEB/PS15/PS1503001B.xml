<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="640" Id="PS1503001B" Left="8" OnLoadCompleted="fn_OnLoadCompleted" OnUnloadCompleted="fn_OnUnloadCompleted" PidAttrib="7" Title="건축협조사항&#32;수정" Top="8" Ver="1.0" Width="984" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_sigi">
				<Contents>
					<colinfo id="CODE" size="255" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE>1</CODE>
						<CODE_NAME>착공전</CODE_NAME>
					</record>
					<record>
						<CODE>2</CODE>
						<CODE_NAME>완성검사전</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dS_bunlyu">
				<Contents>
					<colinfo id="CODE" size="255" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE>1</CODE>
						<CODE_NAME>MR</CODE_NAME>
					</record>
					<record>
						<CODE>2</CODE>
						<CODE_NAME>MRL</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_sms">
				<Contents>
					<colinfo id="TRAN_ID" size="256" type="STRING"/>
					<colinfo id="TRAN_PHONE" size="256" type="STRING"/>
					<colinfo id="TRAN_CALLBACK" size="256" type="STRING"/>
					<colinfo id="TRAN_STATUS" size="256" type="STRING"/>
					<colinfo id="TRAN_MSG" size="256" type="STRING"/>
					<colinfo id="TRAN_ETC1" size="256" type="STRING"/>
					<colinfo id="TRAN_TYPE" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_struc">
				<Contents>
					<colinfo id="CODE" size="255" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE>A</CODE>
						<CODE_NAME>콘크리트</CODE_NAME>
					</record>
					<record>
						<CODE>B</CODE>
						<CODE_NAME>철골</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_pm07">
				<Contents>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSITE_TEL" size="256" summ="default" type="STRING"/>
					<colinfo id="SOPTP_REVERSE" size="256" summ="default" type="STRING"/>
					<colinfo id="GUIDE_YN" size="256" summ="default" type="STRING"/>
					<colinfo id="GUIDE_DT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
		</Datasets>
		<Div Height="550" Id="div_imageList3" Left="8" OnLoadCompleted="fn_OnLoadCompleted" OnUnloadCompleted="fn_OnUnloadCompleted" scroll="true" TabOrder="11" Text="Div0" Top="72" Url="PS15::PS1503001F.xml" Visible="FALSE" Width="940">
			<Contents></Contents>
		</Div>
		<Div Height="550" Id="div_imageList2" Left="8" OnLoadCompleted="fn_OnLoadCompleted" OnUnloadCompleted="fn_OnUnloadCompleted" scroll="true" TabOrder="15" Text="Div0" Top="72" Url="PS15::PS1503001E.xml" Visible="FALSE" Width="940">
			<Contents></Contents>
		</Div>
		<Div Height="550" Id="div_imageList0" Left="8" OnLoadCompleted="fn_OnLoadCompleted" OnUnloadCompleted="fn_OnUnloadCompleted" scroll="true" TabOrder="11" Text="Div0" Top="72" Url="PS15::PS1503001C.xml" Width="940">
			<Contents></Contents>
		</Div>
		<Div Height="550" Id="div_imageList1" Left="8" OnLoadCompleted="fn_OnLoadCompleted" OnUnloadCompleted="fn_OnUnloadCompleted" scroll="true" TabOrder="11" Text="Div0" Top="72" Url="PS15::PS1503001D.xml" Visible="FALSE" Width="940">
			<Contents></Contents>
		</Div>
		<Div Height="550" Id="div_imageList4" Left="8" OnLoadCompleted="fn_OnLoadCompleted" OnUnloadCompleted="fn_OnUnloadCompleted" scroll="true" TabOrder="11" Text="Div0" Top="72" Url="PS15::PS1503001G.xml" Visible="FALSE" Width="940">
			<Contents></Contents>
		</Div>
		<Div Height="550" Id="div_imageList5" Left="8" OnLoadCompleted="fn_OnLoadCompleted" OnUnloadCompleted="fn_OnUnloadCompleted" scroll="true" TabOrder="11" Text="Div0" Top="72" Url="PS15::PS1503001H.xml" Visible="FALSE" Width="940">
			<Contents></Contents>
		</Div>
		<Div Height="550" Id="div_imageList6" Left="8" OnLoadCompleted="fn_OnLoadCompleted" OnUnloadCompleted="fn_OnUnloadCompleted" scroll="true" TabOrder="11" Text="Div0" Top="72" Url="PS15::PS1503001I.xml" Visible="FALSE" Width="940">
			<Contents></Contents>
		</Div>
		<Div Height="550" Id="div_imageList7" Left="8" OnLoadCompleted="fn_OnLoadCompleted" OnUnloadCompleted="fn_OnUnloadCompleted" scroll="true" TabOrder="11" Text="Div0" Top="72" Url="PS15::PS1503001J.xml" Visible="FALSE" Width="940">
			<Contents></Contents>
		</Div>
		<Static Color="user5" Font="굴림,10,Bold" Height="20" Id="Static0" Left="28" TabOrder="0" Text="search&#32;user" Top="8" VAlign="Middle" Width="176"></Static>
		<Div Height="36" Id="div_btn" TabOrder="0" Text="Div0" Url="WB01::CommBtnForm.xml" Width="984">
			<Contents></Contents>
		</Div>
		<Static Height="24" Id="st_title" Left="912" TabOrder="3" Text="건축협조사항&#32;수정" Top="696" Visible="FALSE" Width="96"></Static>
		<Shape BKColor="user0" Bottom="64" Height="25" Id="Shape0" Left="-1" LineColor="user1" Right="984" TabOrder="4" Top="39" Type="Rectangle" Width="985"></Shape>
		<Static Align="Right" Height="20" Id="Static1" Left="200" Style="sty_lb_search" TabOrder="5" Text="시기&#32;" Top="41" VAlign="Middle" Width="80"></Static>
		<Combo Border="Flat" CodeColumn="CODE" Column="ZZPMNUM" DataColumn="CODE_NAME" Height="20" Id="cb_sigi" InnerDataset="ds_sigi" Left="285" OnChanged="cb_sigi_OnChanged" Style="sty_ipt_search" TabOrder="6" Top="41" Width="97"></Combo>
		<Static Align="Right" Height="20" Id="Static2" Left="400" Style="sty_lb_search" TabOrder="7" Text="분류&#32;" Top="41" VAlign="Middle" Width="80"></Static>
		<Combo Border="Flat" CodeColumn="CODE" Column="ZZPMNUM" DataColumn="CODE_NAME" Height="20" Id="cb_bunlyn" InnerDataset="dS_bunlyu" Left="485" OnChanged="cb_sigi_OnChanged" Style="sty_ipt_search" TabOrder="8" Top="41" Width="97"></Combo>
		<Static Align="Right" Height="20" Id="st_userMbpn" Left="592" Style="sty_lb_search" TabOrder="9" Text="전화번호&#32;" Top="41" VAlign="Middle" Width="80"></Static>
		<Edit Height="20" Id="ed_phone" Left="681" OnKillFocus="ed_phone_OnKillFocus" TabOrder="10" Top="41" Width="205"></Edit>
		<Button ButtonStyle="TRUE" Cursor="HAND" DomainID="com.confirm" Height="20" Id="btn_send" ImageID="btn_user_04" Left="890" OnClick="btn_load_OnClick" Style="sty_btn" TabOrder="11" Text="발송" Top="41" Transparent="TRUE" Width="63"></Button>
		<Static Align="Right" Height="20" Id="Static3" Left="3" Style="sty_lb_search" TabOrder="16" Text="구조&#32;" Top="41" VAlign="Middle" Width="80"></Static>
		<Combo Border="Flat" CodeColumn="CODE" Column="ZZPMNUM" DataColumn="CODE_NAME" Height="20" Id="cb_struc" InnerDataset="ds_struc" Left="88" OnChanged="cb_sigi_OnChanged" Style="sty_ipt_search" TabOrder="17" Top="41" Width="97"></Combo>
	</Form>
	<Script><![CDATA[/*
 ******************************************************************************************
 * 기      능   : 주소록 관리 
 * 작  성  자   : 
 * 작성  일자   : 
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
#include "LIB::commons.js";	// 공통 스크립트 
#include "LIB::utility.js";
//=========================================================================================
// [ PART 1 ]
// Form에서 사용될 전역변수를 선언
// FORM에서 사용되는 전역변수는 대문자로 작성하며, F_XXX 의 형태를 갖도록 한다. 
//========================================================================================
var _val = "";
var _url = "";
var FV_SEND = false;
//=========================================================================================
// [ PART 2 ]
// Form Loading / Unloading 시 작업 정의
//=========================================================================================
function fn_OnLoadCompleted(obj) {
	// Form 로드 이벤트 맨 첫줄에 기술 
	gfn_initFormNotAuth("PS1503001B", st_title.value, "1");
	
	if(URL == 'PS0201001G')
	{
		ed_phone.Text = TEL;
	}
	
	//fn_test();
	fn_viewImge(GUBUN);
}
/********************************************************************************
* 기      능   : 공통코드가 조회된 후의 Callback 함수 
********************************************************************************/
function fn_completeInit(sCode, sDsObj, sCodeType) {

}

function fn_test()
{
	//trace("GF_FILE_SERVER_URL= " + GF_FILE_SERVER_URL);
	//trace("G_SERVER_URL= " + G_SERVER_URL);
}
/********************************************************************************
* 기      능   : form UnloadCompleted 
********************************************************************************/
function fn_OnUnloadCompleted(obj) {
	return true;
}
//=========================================================================================
// [ PART 3 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,form닫기)
//=========================================================================================
/********************************************************************************
* 기      능   : 이미지 화면 뷰
********************************************************************************/
function fn_viewImge(val) {

	if (val == "C")
	{
		div_imageList0.Visible = true;
		div_imageList1.Visible = false;
		div_imageList2.Visible = false;
		div_imageList3.Visible = false;
		div_imageList4.Visible = false;
		div_imageList5.Visible = false;
		div_imageList6.Visible = false;
		div_imageList7.Visible = false;
		cb_struc.Index = 0;
		cb_sigi.Index = 0;
		cb_bunlyn.Index = 0;
		_url = G_SERVER_URL + "supp/inst1.html";
	}
	
	if (val == "D")
	{
		div_imageList0.Visible = false;
		div_imageList1.Visible = true;
		div_imageList2.Visible = false;
		div_imageList3.Visible = false;
		div_imageList4.Visible = false;
		div_imageList5.Visible = false;
		div_imageList6.Visible = false;
		div_imageList7.Visible = false;
		cb_struc.Index = 0;
		cb_sigi.Index = 0;
		cb_bunlyn.Index = 1;
		_url = G_SERVER_URL + "supp/inst2.html";
	}
	
	if (val == "E")
	{
		div_imageList0.Visible = false;
		div_imageList1.Visible = false;
		div_imageList2.Visible = true;
		div_imageList3.Visible = false;
		div_imageList4.Visible = false;
		div_imageList5.Visible = false;
		div_imageList6.Visible = false;
		div_imageList7.Visible = false;
		cb_struc.Index = 0;
		cb_sigi.Index = 1;
		cb_bunlyn.Index = 0;
		_url = G_SERVER_URL + "supp/inst3.html";
	}
	
	if (val == "F")
	{
		div_imageList0.Visible = false;
		div_imageList1.Visible = false;
		div_imageList2.Visible = false;
		div_imageList3.Visible = true;
		div_imageList4.Visible = false;
		div_imageList5.Visible = false;
		div_imageList6.Visible = false;
		div_imageList7.Visible = false;
		cb_struc.Index = 0;
		cb_sigi.Index = 1;
		cb_bunlyn.Index = 1;
		_url = G_SERVER_URL + "supp/inst4.html";
	}
	
	if (val == "G")
	{
		div_imageList0.Visible = false;
		div_imageList1.Visible = false;
		div_imageList2.Visible = false;
		div_imageList3.Visible = false;
		div_imageList4.Visible = true;
		div_imageList5.Visible = false;
		div_imageList6.Visible = false;
		div_imageList7.Visible = false;
		cb_struc.Index = 1;
		cb_sigi.Index = 0;
		cb_bunlyn.Index = 0;
		_url = G_SERVER_URL + "supp/inst5.html";
	}
	
	if (val == "H")
	{
		div_imageList0.Visible = false;
		div_imageList1.Visible = false;
		div_imageList2.Visible = false;
		div_imageList3.Visible = false;
		div_imageList4.Visible = false;
		div_imageList5.Visible = true;
		div_imageList6.Visible = false;
		div_imageList7.Visible = false;
		cb_struc.Index = 1;
		cb_sigi.Index = 0;
		cb_bunlyn.Index = 1;
		_url = G_SERVER_URL + "supp/inst6.html";
	}
	
	if (val == "I")
	{
		div_imageList0.Visible = false;
		div_imageList1.Visible = false;
		div_imageList2.Visible = false;
		div_imageList3.Visible = false;
		div_imageList4.Visible = false;
		div_imageList5.Visible = false;
		div_imageList6.Visible = true;
		div_imageList7.Visible = false;
		cb_struc.Index = 1;
		cb_sigi.Index = 1;
		cb_bunlyn.Index = 0;
		_url = G_SERVER_URL + "supp/inst7.html";
	}
	
	if (val == "J")
	{
		div_imageList0.Visible = false;
		div_imageList1.Visible = false;
		div_imageList2.Visible = false;
		div_imageList3.Visible = false;
		div_imageList4.Visible = false;
		div_imageList5.Visible = false;
		div_imageList6.Visible = false;
		div_imageList7.Visible = true;
		cb_struc.Index = 1;
		cb_sigi.Index = 1;
		cb_bunlyn.Index = 1;
		_url = G_SERVER_URL + "supp/inst8.html";
	}
	
}
/********************************************************************************
* 기      능   : cb_sigi_OnChanged, cb_bunlyn_Onchanged
********************************************************************************/
function cb_sigi_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	if(cb_struc.Value == 'A' && cb_sigi.value == 1 && cb_bunlyn.value == 1)
	{
		 _val = "C";
		 _url = G_SERVER_URL + "supp/inst1.html";
	}
	
	if(cb_struc.Value == 'A' && cb_sigi.value == 1 && cb_bunlyn.value == 2)
	{
		 _val = "D";
		 _url = G_SERVER_URL + "supp/inst2.html";
	}
	
	if(cb_struc.Value == 'A' && cb_sigi.value == 2 && cb_bunlyn.value == 1)
	{
		 _val = "E";
		 _url = G_SERVER_URL + "supp/inst3.html";
	}
	
	if(cb_struc.Value == 'A' && cb_sigi.value == 2 && cb_bunlyn.value == 2)
	{
		 _val = "F";
		 _url = G_SERVER_URL + "supp/inst4.html";
	}
	
	
	if(cb_struc.Value == 'B' && cb_sigi.value == 1 && cb_bunlyn.value == 1)
	{
		 _val = "G";
		 _url = G_SERVER_URL + "supp/inst5.html";
	}
	
	if(cb_struc.Value == 'B' && cb_sigi.value == 1 && cb_bunlyn.value == 2)
	{
		 _val = "H";
		 _url = G_SERVER_URL + "supp/inst6.html";
	}
	
	if(cb_struc.Value == 'B' && cb_sigi.value == 2 && cb_bunlyn.value == 1)
	{
		 _val = "I";
		 _url = G_SERVER_URL + "supp/inst7.html";
	}
	
	if(cb_struc.Value == 'B' && cb_sigi.value == 2 && cb_bunlyn.value == 2)
	{
		 _val = "J";
		 _url = G_SERVER_URL + "supp/inst8.html";
	}
}

/********************************************************************************
* 기      능   : 조회
********************************************************************************/
function fn_query()
{
	fn_viewImge(_val );
}

/********************************************************************************
* 기      능   : 닫기  
********************************************************************************/
function fn_close() {
	
	if(FV_SEND == true)
	{
		var arr = [  ds_pm07.GetColumn(0, "GUIDE_YN")
				   , ds_pm07.GetColumn(0, "GUIDE_DT")	           
				   ];
		Trace(arr);
		close(arr);
	}
	
	
	close(null);
}

/********************************************************************************
* 기      능   : 문자발송
********************************************************************************/
function btn_load_OnClick(obj)
{
	fn_sms();
}

function fn_sms()
{
	if(gfn_isNull(ed_phone, true, Static3.value)) return;
	
	if(Length(cb_struc.Value) == 0 || Length(cb_sigi.value) == 0 || Length(cb_bunlyn.value) == 0)
	{
		gfn_openMsgWin("구조/시기/분류를 선택해 주세요.");
		return;
	}
	
	var lv_msg = "";
	//문자 내용 수정 - 2019.03.15 강민석K
	//lv_msg  = "현대엘리베이터 입니다." ;
	//lv_msg += "아래 링크는 "+  cb_sigi.text  +" 건축사항입니다.";
	//lv_msg += "승상기설치의 원활한 진행을 위해서 건축부문의 협력이 필수적 입니다. 협조감사합니다.\n";
	//lv_msg += _url ;
	lv_msg  = "현대엘리베이터 " + G_USER_NAME + " PM 입니다.\n";
	lv_msg += "아래 링크는 "+  cb_sigi.text  +" 건축사항입니다.\n";
	lv_msg += "승상기설치의 원활한 진행을 위해서 건축부문의 협력이 필수적 입니다.\n협조감사합니다.\n";
	lv_msg += _url ;
	
	//trace(lv_msg);
	
	gfn_initDs(ds_sms, true);
	
	ds_sms.ClearData();
	ds_sms.AddRow();
	ds_sms.SetColumn(0,"TRAN_ETC1", "PS1503001B");
	ds_sms.SetColumn(0,"TRAN_TYPE", "0");
	ds_sms.SetColumn(0,"TRAN_STATUS", "0");
	ds_sms.SetColumn(0,"TRAN_CALLBACK", "1577-0603");
	ds_sms.SetColumn(0,"TRAN_MSG", lv_msg);
    ds_sms.SetColumn(0,"TRAN_PHONE", ed_phone.value);
    
    

	tit_clearActionInfo();
	tit_addMultiActionInfo("ps07:PS0704001A_I2");
	tit_callService(
		"PDA_ACT"
		, ""
		, "ds_sms=ds_sms"
		, ""
		, ""
		, "" //""
		, ""
		, ""
		, true);
	
	// 현장관리(답사) 이력관리에서 넘어온 경우, 건촉협조사항 안내로 저장 되도록 세팅.
	if(URL == 'PS0201001G')
	{
		ds_pm07.ClearData();
		var nAddRow = ds_pm07.AddRow();
		ds_pm07.SetColumn(nAddRow, "POSID", POSID);
		ds_pm07.SetColumn(nAddRow, "ZSITE_TEL", TEL);
		ds_pm07.SetColumn(nAddRow, "SOPTP_REVERSE", SOPTP_REVERSE);
		ds_pm07.SetColumn(nAddRow, "GUIDE_YN", "Y");
		ds_pm07.SetColumn(nAddRow, "GUIDE_DT", gfn_getCurrDate());
		
		//# 현장 전화번호 저장
		tit_clearActionInfo();		
		tit_addSelectExActionInfo("ps02:PS0201001F_S5", "ps02:PS0201001F_I3", "ps02:PS0201001F_U4");	// ZPSTPM07 INSERT OR UPDATE.
		tit_callService(
			""
			, ""
			, "ds_head=ds_pm07"
			, ""
			, ""
			, ""
			, ""
			, ""
			, true  // ""
			
			);
		FV_SEND = true;	
	}
	
	gfn_openMsgWin("발송 되었습니다.");
			
}

function ed_phone_OnKillFocus(obj)
{
	if ( obj.value == "" ) {
		return;
	}
	
	obj.value = gfn_formatHpNo( obj.value, obj);
	if ( length( obj.value ) == 0 ) {
		gfn_showMsg("CW00038", st_userMbpn.value);
		obj.setFocus();
	}
}
]]></Script>
</Window>