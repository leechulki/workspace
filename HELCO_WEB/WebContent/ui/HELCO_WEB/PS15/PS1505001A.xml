<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form BorderColor="user24" Height="562" Id="PS1505001A" Left="8" OnLoadCompleted="fn_OnLoadCompleted" OnTimer="PS1505001A_OnTimer" OnUnloadCompleted="fn_OnUnloadCompleted" PidAttrib="7" Title="기타외주&#32;작업지시서(관리자)" Top="8" Ver="1.0" Width="978" WorkArea="true">
		<Datasets>
			<Dataset CanColumnChange="ds_cond_CanColumnChange" DataSetType="Dataset" Id="ds_cond">
				<Contents>
					<colinfo id="LIFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="SUP_DTF" size="256" summ="default" type="STRING"/>
					<colinfo id="SUP_DTT" size="256" summ="default" type="STRING"/>
					<colinfo id="PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZACTSS" size="256" summ="default" type="STRING"/>
					<colinfo id="USER_CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="USER_GRUP" size="256" summ="default" type="STRING"/>
					<colinfo id="PERIOD" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZPMNUM" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZLIFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="I_RA" size="256" summ="default" type="STRING"/>
					<colinfo id="CONFIRM_GUBUN" size="256" summ="default" type="STRING"/>
					<colinfo id="CHARGE" size="256" summ="default" type="STRING"/>
					<colinfo id="WORK_GUBUN" size="256" summ="default" type="STRING"/>
					<colinfo id="PROCESS" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
					<colinfo id="MEMO_SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="SVC_YN" size="256" summ="default" type="STRING"/>
					<colinfo id="APP_STATE" size="256" summ="default" type="STRING"/>
					<colinfo id="H_WORK_GUBUN" size="256" summ="default" type="STRING"/>
					<colinfo id="RD_CHK" size="256" summ="default" type="STRING"/>
					<record>
						<APP_STATE></APP_STATE>
						<CHARGE></CHARGE>
						<CONFIRM_GUBUN></CONFIRM_GUBUN>
						<H_WORK_GUBUN></H_WORK_GUBUN>
						<I_RA></I_RA>
						<LIFNR></LIFNR>
						<MEMO_SEQ></MEMO_SEQ>
						<PERIOD></PERIOD>
						<POSID></POSID>
						<PROCESS></PROCESS>
						<PSPID></PSPID>
						<RD_CHK></RD_CHK>
						<SUP_DTF></SUP_DTF>
						<SUP_DTT></SUP_DTT>
						<SVC_YN></SVC_YN>
						<USER_CODE></USER_CODE>
						<USER_GRUP></USER_GRUP>
						<WORK_GUBUN></WORK_GUBUN>
						<ZZACTSS></ZZACTSS>
						<ZZLIFNR></ZZLIFNR>
						<ZZPMNUM></ZZPMNUM>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_period">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE>A</CODE>
						<CODE_NAME>착공예정일</CODE_NAME>
					</record>
					<record>
						<CODE>B</CODE>
						<CODE_NAME>작업요청일</CODE_NAME>
					</record>
					<record>
						<CODE>C</CODE>
						<CODE_NAME>투입일정일</CODE_NAME>
					</record>
					<record>
						<CODE>D</CODE>
						<CODE_NAME>작업시작일</CODE_NAME>
					</record>
					<record>
						<CODE>E</CODE>
						<CODE_NAME>작업완료일</CODE_NAME>
					</record>
					<record>
						<CODE>F</CODE>
						<CODE_NAME>비용청구일</CODE_NAME>
					</record>
					<record>
						<CODE>G</CODE>
						<CODE_NAME>비용처리일</CODE_NAME>
					</record>
					<record>
						<CODE>H</CODE>
						<CODE_NAME>준공예정일</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_lifnr_cd">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
					<colinfo id="SORTL" size="256" type="STRING"/>
					<colinfo id="LOEVM" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_zzactss">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list" OnColumnChanged="ds_list_OnColumnChanged">
				<Contents>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZACTSS" size="256" summ="default" type="STRING"/>
					<colinfo id="PM_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="PM_NAME" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSITE_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSITE_NM_SMS" size="256" summ="default" type="STRING"/>
					<colinfo id="SALES_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="DONG" size="256" summ="default" type="STRING"/>
					<colinfo id="PRO_R" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNR_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="NAMET" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZCHAKD" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZCOMP2" size="256" summ="default" type="STRING"/>
					<colinfo id="JOB_CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="JOB_NAME" size="256" summ="default" type="STRING"/>
					<colinfo id="START_DAY" size="256" summ="default" type="STRING"/>
					<colinfo id="END_DAY" size="256" summ="default" type="STRING"/>
					<colinfo id="CONFIRM_GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNR_OUT" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNR_OUT_NAME" size="256" summ="default" type="STRING"/>
					<colinfo id="J_1KFREPRE" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNR_OUT_TEL" size="256" summ="default" type="STRING"/>
					<colinfo id="OUT_TEAM_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="REQ_DATE" size="256" summ="default" type="STRING"/>
					<colinfo id="REQ_TIME" size="256" summ="default" type="STRING"/>
					<colinfo id="REQ_NAME" size="256" summ="default" type="STRING"/>
					<colinfo id="REQ_REG_TIME" size="256" summ="default" type="STRING"/>
					<colinfo id="EXP_NAME" size="256" summ="default" type="STRING"/>
					<colinfo id="EXP_DATE" size="256" summ="default" type="STRING"/>
					<colinfo id="EXP_TIME" size="256" summ="default" type="STRING"/>
					<colinfo id="EXP_HP" size="256" summ="default" type="STRING"/>
					<colinfo id="START_DATE" size="256" summ="default" type="STRING"/>
					<colinfo id="START_TIME" size="256" summ="default" type="STRING"/>
					<colinfo id="PLAN_DATE" size="256" summ="default" type="STRING"/>
					<colinfo id="PLAN_TIME" size="256" summ="default" type="STRING"/>
					<colinfo id="WORKER_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="WORKER_HP" size="256" summ="default" type="STRING"/>
					<colinfo id="WORKER_ID2" size="256" summ="default" type="STRING"/>
					<colinfo id="WORKER_HP2" size="256" summ="default" type="STRING"/>
					<colinfo id="COM_DATE" size="256" summ="default" type="STRING"/>
					<colinfo id="COM_TIME" size="256" summ="default" type="STRING"/>
					<colinfo id="CHARGE_DATE" size="256" summ="default" type="STRING"/>
					<colinfo id="CHECK_CHARGE" size="256" summ="default" type="STRING"/>
					<colinfo id="STATE" size="256" summ="default" type="STRING"/>
					<colinfo id="STATE_CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="REQ_BC_PM_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="REQ_BN_MG_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="REQ_BN_TM_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="APPR_DAT" size="256" summ="default" type="STRING"/>
					<colinfo id="APPR_FINA_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="CHARGE_DAT" size="256" summ="default" type="STRING"/>
					<colinfo id="MEMO_CRNAM" size="256" summ="default" type="STRING"/>
					<colinfo id="MEMO_BELONG" size="256" summ="default" type="STRING"/>
					<colinfo id="MEMO_ALM_INDC" size="256" summ="default" type="STRING"/>
					<colinfo id="MEMO_SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="CONTENTS" size="256" summ="default" type="STRING"/>
					<colinfo id="CONTENTS_ORIG" size="256" summ="default" type="STRING"/>
					<colinfo id="RTN_CRNAM" size="256" summ="default" type="STRING"/>
					<colinfo id="RTN_BELONG" size="256" summ="default" type="STRING"/>
					<colinfo id="RTN_CONTENTS" size="256" summ="default" type="STRING"/>
					<colinfo id="RTN_CONTENTS_ORIG" size="256" summ="default" type="STRING"/>
					<colinfo id="PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="NAMET_HP" size="256" summ="default" type="STRING"/>
					<colinfo id="NAMET_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="PM_HP" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="PROC_VER" size="256" summ="default" type="STRING"/>
					<colinfo id="CHASU" size="256" summ="default" type="STRING"/>
					<colinfo id="CONTRCT" size="256" summ="default" type="STRING"/>
					<colinfo id="PRE_CNFM_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="PRE_CNFM_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="SERVICE_HP" size="256" summ="default" type="STRING"/>
					<colinfo id="DIPBXNUMB" size="256" summ="default" type="STRING"/>
					<colinfo id="PIC_UPLOAD_YN" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_zzpmnum_cd">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_confirm_gubun">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE>0</CODE>
						<CODE_NAME>-&#32;전체&#32;-</CODE_NAME>
					</record>
					<record>
						<CODE>1</CODE>
						<CODE_NAME>취소</CODE_NAME>
					</record>
					<record>
						<CODE>2</CODE>
						<CODE_NAME>변경</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_zzlifnr_cd">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZACTSS" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="JOB_CODE" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_charge">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME>-&#32;전체&#32;-</CODE_NAME>
					</record>
					<record>
						<CODE>D</CODE>
						<CODE_NAME>업체요청</CODE_NAME>
					</record>
					<record>
						<CODE>E</CODE>
						<CODE_NAME>지사결재(PM)</CODE_NAME>
					</record>
					<record>
						<CODE>F</CODE>
						<CODE_NAME>지사결재(지사장)</CODE_NAME>
					</record>
					<record>
						<CODE>G</CODE>
						<CODE_NAME>지사결재(팀장)</CODE_NAME>
					</record>
					<record>
						<CODE>K</CODE>
						<CODE_NAME>QC결재(팀장)</CODE_NAME>
					</record>
					<record>
						<CODE>C</CODE>
						<CODE_NAME>전표처리</CODE_NAME>
					</record>
					<record>
						<CODE>H</CODE>
						<CODE_NAME>회계부승인</CODE_NAME>
					</record>
					<record>
						<CODE>I</CODE>
						<CODE_NAME>비용지급</CODE_NAME>
					</record>
					<record>
						<CODE>Z</CODE>
						<CODE_NAME>반려</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_workgubun">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="SORT" size="256" summ="default" type="STRING"/>
					<colinfo id="LRGE_CODE" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_process">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_auth">
				<Contents>
					<colinfo id="AUTH" size="256" summ="default" type="STRING"/>
					<colinfo id="AUTH_NAME" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_appr">
				<Contents>
					<colinfo id="PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="CHASU" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="STATE" size="256" summ="default" type="STRING"/>
					<colinfo id="REQ_LIF_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="REQ_BN_TM" size="256" summ="default" type="STRING"/>
					<colinfo id="APPR_MAN" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list_tmp" OnColumnChanged="ds_list_OnColumnChanged">
				<Contents>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZACTSS" size="256" summ="default" type="STRING"/>
					<colinfo id="PM_NAME" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSITE_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="DONG" size="256" summ="default" type="STRING"/>
					<colinfo id="PRO_R" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNR_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="NAMET" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZCHAKD" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZCOMP2" size="256" summ="default" type="STRING"/>
					<colinfo id="JOB_CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="JOB_NAME" size="256" summ="default" type="STRING"/>
					<colinfo id="START_DAY" size="256" summ="default" type="STRING"/>
					<colinfo id="END_DAY" size="256" summ="default" type="STRING"/>
					<colinfo id="CONFIRM_GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNR_OUT" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNR_OUT_NAME" size="256" summ="default" type="STRING"/>
					<colinfo id="J_1KFREPRE" size="256" summ="default" type="STRING"/>
					<colinfo id="REQ_DATE" size="256" summ="default" type="STRING"/>
					<colinfo id="REQ_TIME" size="256" summ="default" type="STRING"/>
					<colinfo id="REQ_NAME" size="256" summ="default" type="STRING"/>
					<colinfo id="REQ_REG_TIME" size="256" summ="default" type="STRING"/>
					<colinfo id="EXP_NAME" size="256" summ="default" type="STRING"/>
					<colinfo id="EXP_DATE" size="256" summ="default" type="STRING"/>
					<colinfo id="EXP_TIME" size="256" summ="default" type="STRING"/>
					<colinfo id="EXP_HP" size="256" summ="default" type="STRING"/>
					<colinfo id="START_DATE" size="256" summ="default" type="STRING"/>
					<colinfo id="START_TIME" size="256" summ="default" type="STRING"/>
					<colinfo id="PLAN_DATE" size="256" summ="default" type="STRING"/>
					<colinfo id="PLAN_TIME" size="256" summ="default" type="STRING"/>
					<colinfo id="WORKER_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="WORKER_HP" size="256" summ="default" type="STRING"/>
					<colinfo id="WORKER_ID2" size="256" summ="default" type="STRING"/>
					<colinfo id="WORKER_HP2" size="256" summ="default" type="STRING"/>
					<colinfo id="COM_DATE" size="256" summ="default" type="STRING"/>
					<colinfo id="COM_TIME" size="256" summ="default" type="STRING"/>
					<colinfo id="CHARGE_DATE" size="256" summ="default" type="STRING"/>
					<colinfo id="CHECK_CHARGE" size="256" summ="default" type="STRING"/>
					<colinfo id="STATE" size="256" summ="default" type="STRING"/>
					<colinfo id="STATE_CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="APPR_DAT" size="256" summ="default" type="STRING"/>
					<colinfo id="MEMO_CRNAM" size="256" summ="default" type="STRING"/>
					<colinfo id="MEMO_BELONG" size="256" summ="default" type="STRING"/>
					<colinfo id="MEMO_ALM_INDC" size="256" summ="default" type="STRING"/>
					<colinfo id="MEMO_SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="CONTENTS" size="256" summ="default" type="STRING"/>
					<colinfo id="PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="NAMET_HP" size="256" summ="default" type="STRING"/>
					<colinfo id="PM_HP" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="PROC_VER" size="256" summ="default" type="STRING"/>
					<colinfo id="CHASU" size="256" summ="default" type="STRING"/>
					<colinfo id="PRE_CNFM_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="PRE_CNFM_NM" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_temno">
				<Contents>
					<colinfo id="TEMNO" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond_p">
				<Contents>
					<colinfo id="GUBUN" size="256" summ="default" type="STRING"/>
					<colinfo id="GUBUN2" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN" size="256" summ="default" type="STRING"/>
					<record>
						<GBN/>
						<GUBUN></GUBUN>
						<GUBUN2></GUBUN2>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list_p" OnColumnChanged="ds_list_OnColumnChanged">
				<Contents>
					<colinfo id="ROWNUM" size="256" summ="default" type="STRING"/>
					<colinfo id="PSPID" size="17" summ="default" type="STRING"/>
					<colinfo id="POSID" size="105" summ="default" type="STRING"/>
					<colinfo id="ZSITE_NM" size="17" summ="default" type="STRING"/>
					<colinfo id="ZSPEC1" size="6" summ="default" type="STRING"/>
					<colinfo id="ZSPEC2" size="6" summ="default" type="STRING"/>
					<colinfo id="WRKLFN" size="256" summ="default" type="STRING"/>
					<colinfo id="WRKLFN_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="ADDR" size="256" summ="default" type="STRING"/>
					<colinfo id="REP" size="256" summ="default" type="STRING"/>
					<colinfo id="PM" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZACTSS" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="TITLE" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_appr2">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME>-&#32;전체&#32;-</CODE_NAME>
					</record>
					<record>
						<CODE>A</CODE>
						<CODE_NAME>1차대기(PM결재)</CODE_NAME>
					</record>
					<record>
						<CODE>B</CODE>
						<CODE_NAME>2차대기(지사장결재)</CODE_NAME>
					</record>
					<record>
						<CODE>C</CODE>
						<CODE_NAME>3차대기(팀장결재)</CODE_NAME>
					</record>
					<record>
						<CODE>D</CODE>
						<CODE_NAME>4차대기(QC팀장결재)</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_gyul">
				<Contents>
					<colinfo id="SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="CNFM_ID" size="255" summ="default" type="STRING"/>
					<colinfo id="CNFM_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="RANK" size="256" summ="default" type="STRING"/>
					<colinfo id="DPTNM" size="256" summ="default" type="STRING"/>
					<colinfo id="PERNO" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="SIGN_YN" size="256" summ="default" type="STRING"/>
					<colinfo id="GUBUN" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_head">
				<Contents>
					<colinfo id="DOCU_NO" size="255" summ="default" type="STRING"/>
					<colinfo id="APP_STATE" size="256" summ="default" type="STRING"/>
					<colinfo id="APP_REQ_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="APP_REQ_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="APP_CNFM_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="APP_CNFM_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="APP_CNFM_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="REJT_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="REJT_MEMO" size="256" summ="default" type="STRING"/>
					<colinfo id="PRE_DOCU_NO" size="256" summ="default" type="STRING"/>
					<record>
						<APP_CNFM_DT></APP_CNFM_DT>
						<APP_CNFM_ID></APP_CNFM_ID>
						<APP_CNFM_NM></APP_CNFM_NM>
						<APP_REQ_ID></APP_REQ_ID>
						<APP_REQ_NM></APP_REQ_NM>
						<APP_STATE></APP_STATE>
						<DOCU_NO></DOCU_NO>
						<PRE_DOCU_NO></PRE_DOCU_NO>
						<REJT_DT></REJT_DT>
						<REJT_MEMO></REJT_MEMO>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_detail">
				<Contents>
					<colinfo id="DOCU_NO" size="255" summ="default" type="STRING"/>
					<colinfo id="APP_STATE" size="256" summ="default" type="STRING"/>
					<colinfo id="APP_CNFM_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="APP_CNFM_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="APP_CNFM_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="REJT_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="REJT_MEMO" size="256" summ="default" type="STRING"/>
					<colinfo id="APP_MEMO" size="256" summ="default" type="STRING"/>
					<record>
						<APP_CNFM_DT></APP_CNFM_DT>
						<APP_CNFM_ID></APP_CNFM_ID>
						<APP_CNFM_NM></APP_CNFM_NM>
						<APP_MEMO></APP_MEMO>
						<APP_STATE></APP_STATE>
						<DOCU_NO></DOCU_NO>
						<REJT_DT></REJT_DT>
						<REJT_MEMO></REJT_MEMO>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_tmp">
				<Contents>
					<colinfo id="DOCU_NO" size="255" summ="default" type="STRING"/>
					<colinfo id="APP_CNFM_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN" size="256" summ="default" type="STRING"/>
					<record>
						<APP_CNFM_ID></APP_CNFM_ID>
						<DOCU_NO></DOCU_NO>
						<GBN></GBN>
						<POSID></POSID>
						<PSPID></PSPID>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond2">
				<Contents>
					<colinfo id="DOCU_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="NEXT_STATE" size="256" summ="default" type="STRING"/>
					<colinfo id="REJT_MEMO" size="256" summ="default" type="STRING"/>
					<colinfo id="APP_MEMO" size="256" summ="default" type="STRING"/>
					<colinfo id="CURR_STATE" size="256" summ="default" type="STRING"/>
					<colinfo id="REJT_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="STATE" size="256" summ="default" type="STRING"/>
					<colinfo id="PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="REQ_BN_MG" size="256" summ="default" type="STRING"/>
					<colinfo id="REQ_BN_MG_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="REQ_BN_TM" size="256" summ="default" type="STRING"/>
					<colinfo id="REQ_BN_TM_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="REJT_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="REJT_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="APP_CNFM_ID2" size="256" summ="default" type="STRING"/>
					<colinfo id="APP_CNFM_NM2" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSITE_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="JOB_NAME" size="256" summ="default" type="STRING"/>
					<colinfo id="DPTNM3" size="256" summ="default" type="STRING"/>
					<colinfo id="REQ_BN_QC" size="256" summ="default" type="STRING"/>
					<colinfo id="REQ_BN_QC_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="APP_CNFM_ID3" size="256" summ="default" type="STRING"/>
					<colinfo id="APP_CNFM_NM3" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond3">
				<Contents>
					<colinfo id="DOCU_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="NEXT_STATE" size="256" summ="default" type="STRING"/>
					<colinfo id="REJT_MEMO" size="256" summ="default" type="STRING"/>
					<colinfo id="APP_MEMO" size="256" summ="default" type="STRING"/>
					<colinfo id="CURR_STATE" size="256" summ="default" type="STRING"/>
					<colinfo id="REJT_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="STATE" size="256" summ="default" type="STRING"/>
					<colinfo id="PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="REQ_BN_MG" size="256" summ="default" type="STRING"/>
					<colinfo id="REQ_BN_MG_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="REQ_BN_TM" size="256" summ="default" type="STRING"/>
					<colinfo id="REQ_BN_TM_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="REJT_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="REJT_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="APP_CNFM_ID2" size="256" summ="default" type="STRING"/>
					<colinfo id="APP_CNFM_NM2" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSITE_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="JOB_NAME" size="256" summ="default" type="STRING"/>
					<colinfo id="DPTNM3" size="256" summ="default" type="STRING"/>
					<colinfo id="REQ_BN_QC" size="256" summ="default" type="STRING"/>
					<colinfo id="REQ_BN_QC_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="APP_CNFM_ID3" size="256" summ="default" type="STRING"/>
					<colinfo id="APP_CNFM_NM3" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_saveGyul">
				<Contents>
					<colinfo id="CNFM_ID1" size="255" summ="default" type="STRING"/>
					<colinfo id="CNFM_ID2" size="256" summ="default" type="STRING"/>
					<colinfo id="CNFM_ID3" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_days">
				<Contents>
					<colinfo id="DAYS" size="256" type="STRING"/>
					<record>
						<DAYS></DAYS>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_clsf">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME></CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_condLifnr">
				<Contents>
					<colinfo id="GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="LRGE_CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="JOB_CODE" size="256" summ="default" type="STRING"/>
					<record>
						<GBN></GBN>
						<JOB_CODE></JOB_CODE>
						<LRGE_CODE></LRGE_CODE>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond4">
				<Contents>
					<colinfo id="DOCU_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="NEXT_STATE" size="256" summ="default" type="STRING"/>
					<colinfo id="REJT_MEMO" size="256" summ="default" type="STRING"/>
					<colinfo id="APP_MEMO" size="256" summ="default" type="STRING"/>
					<colinfo id="CURR_STATE" size="256" summ="default" type="STRING"/>
					<colinfo id="REJT_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="STATE" size="256" summ="default" type="STRING"/>
					<colinfo id="PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="REQ_BN_MG" size="256" summ="default" type="STRING"/>
					<colinfo id="REQ_BN_MG_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="REQ_BN_TM" size="256" summ="default" type="STRING"/>
					<colinfo id="REQ_BN_TM_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="REJT_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="REJT_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="APP_CNFM_ID2" size="256" summ="default" type="STRING"/>
					<colinfo id="APP_CNFM_NM2" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSITE_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="JOB_NAME" size="256" summ="default" type="STRING"/>
					<colinfo id="DPTNM3" size="256" summ="default" type="STRING"/>
					<colinfo id="REQ_BN_QC" size="256" summ="default" type="STRING"/>
					<colinfo id="REQ_BN_QC_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="APP_CNFM_ID3" size="256" summ="default" type="STRING"/>
					<colinfo id="APP_CNFM_NM3" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_mail" UseClientLayout="1">
				<Contents>
					<colinfo id="SEND_USER" size="256" summ="default" type="STRING"/>
					<colinfo id="SEND_USER_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="RECV_USER" size="256" summ="default" type="STRING"/>
					<colinfo id="RECV_USER_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="CC_USER" size="256" summ="default" type="STRING"/>
					<colinfo id="CC_USER_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="BCC_USER" size="256" summ="default" type="STRING"/>
					<colinfo id="BCC_USER_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="MESGTITL" size="256" summ="default" type="STRING"/>
					<colinfo id="MESGBODY" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_init">
				<Contents>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZACTSS" size="256" summ="default" type="STRING"/>
					<colinfo id="PM_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="PM_NAME" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSITE_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSITE_NM_SMS" size="256" summ="default" type="STRING"/>
					<colinfo id="SALES_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="DONG" size="256" summ="default" type="STRING"/>
					<colinfo id="PRO_R" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNR_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="NAMET" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZCHAKD" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZCOMP2" size="256" summ="default" type="STRING"/>
					<colinfo id="JOB_CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="JOB_NAME" size="256" summ="default" type="STRING"/>
					<colinfo id="START_DAY" size="256" summ="default" type="STRING"/>
					<colinfo id="END_DAY" size="256" summ="default" type="STRING"/>
					<colinfo id="CONFIRM_GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNR_OUT" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNR_OUT_NAME" size="256" summ="default" type="STRING"/>
					<colinfo id="J_1KFREPRE" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNR_OUT_TEL" size="256" summ="default" type="STRING"/>
					<colinfo id="OUT_TEAM_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="REQ_DATE" size="256" summ="default" type="STRING"/>
					<colinfo id="REQ_TIME" size="256" summ="default" type="STRING"/>
					<colinfo id="REQ_NAME" size="256" summ="default" type="STRING"/>
					<colinfo id="REQ_REG_TIME" size="256" summ="default" type="STRING"/>
					<colinfo id="EXP_NAME" size="256" summ="default" type="STRING"/>
					<colinfo id="EXP_DATE" size="256" summ="default" type="STRING"/>
					<colinfo id="EXP_TIME" size="256" summ="default" type="STRING"/>
					<colinfo id="EXP_HP" size="256" summ="default" type="STRING"/>
					<colinfo id="START_DATE" size="256" summ="default" type="STRING"/>
					<colinfo id="START_TIME" size="256" summ="default" type="STRING"/>
					<colinfo id="PLAN_DATE" size="256" summ="default" type="STRING"/>
					<colinfo id="PLAN_TIME" size="256" summ="default" type="STRING"/>
					<colinfo id="WORKER_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="WORKER_HP" size="256" summ="default" type="STRING"/>
					<colinfo id="WORKER_ID2" size="256" summ="default" type="STRING"/>
					<colinfo id="WORKER_HP2" size="256" summ="default" type="STRING"/>
					<colinfo id="COM_DATE" size="256" summ="default" type="STRING"/>
					<colinfo id="COM_TIME" size="256" summ="default" type="STRING"/>
					<colinfo id="CHARGE_DATE" size="256" summ="default" type="STRING"/>
					<colinfo id="CHECK_CHARGE" size="256" summ="default" type="STRING"/>
					<colinfo id="STATE" size="256" summ="default" type="STRING"/>
					<colinfo id="STATE_CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="REQ_BC_PM_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="REQ_BN_MG_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="REQ_BN_TM_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="APPR_DAT" size="256" summ="default" type="STRING"/>
					<colinfo id="APPR_FINA_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="CHARGE_DAT" size="256" summ="default" type="STRING"/>
					<colinfo id="MEMO_CRNAM" size="256" summ="default" type="STRING"/>
					<colinfo id="MEMO_BELONG" size="256" summ="default" type="STRING"/>
					<colinfo id="MEMO_ALM_INDC" size="256" summ="default" type="STRING"/>
					<colinfo id="MEMO_SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="CONTENTS" size="256" summ="default" type="STRING"/>
					<colinfo id="CONTENTS_ORIG" size="256" summ="default" type="STRING"/>
					<colinfo id="RTN_CRNAM" size="256" summ="default" type="STRING"/>
					<colinfo id="RTN_BELONG" size="256" summ="default" type="STRING"/>
					<colinfo id="RTN_CONTENTS" size="256" summ="default" type="STRING"/>
					<colinfo id="RTN_CONTENTS_ORIG" size="256" summ="default" type="STRING"/>
					<colinfo id="PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="NAMET_HP" size="256" summ="default" type="STRING"/>
					<colinfo id="NAMET_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="PM_HP" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="PROC_VER" size="256" summ="default" type="STRING"/>
					<colinfo id="CHASU" size="256" summ="default" type="STRING"/>
					<colinfo id="CONTRCT" size="256" summ="default" type="STRING"/>
					<colinfo id="PRE_CNFM_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="PRE_CNFM_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="SERVICE_HP" size="256" summ="default" type="STRING"/>
					<colinfo id="DIPBXNUMB" size="256" summ="default" type="STRING"/>
					<colinfo id="PIC_UPLOAD_YN" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond_i">
				<Contents>
					<colinfo id="PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="JOB_CODE" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_initFile">
				<Contents>
					<colinfo id="PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="JOB_CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="FNAME_APP" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
		</Datasets>
		<Shape BKColor="user0" Bottom="144" Height="144" Id="Shape0" Left="0" LineColor="user1" Right="978" TabOrder="1" Top="0" Type="Rectangle" Width="978"></Shape>
		<Static Align="Right" Border="Flat" Height="22" Id="Static9" Left="554" Style="sty_ipt_search" TabOrder="25" Top="29" VAlign="Middle" Width="156"></Static>
		<Static Align="Right" Height="20" Id="st_pspid" Left="30" Style="sty_lb_search" TabOrder="4" Text="Proj&#32;No&#32;" Top="54" VAlign="Middle" Width="88"></Static>
		<Edit BindDataset="ds_cond" Border="Flat" CheckLength="Byte" Column="PSPID" Height="20" Id="ed_pjt" ImeMode="english" Left="120" MaxLength="6" Style="sty_ipt_search" TabOrder="22" Top="55" UpperOnly="TRUE" Width="158"></Edit>
		<Static Align="Right" Height="20" Id="st_pm" Left="299" Style="sty_lb_search" TabOrder="9" Text="설치PM&#32;" Top="30" VAlign="Middle" Width="80"></Static>
		<Static Align="Right" Height="20" Id="st_zzactss" Left="299" Style="sty_lb_search" TabOrder="2" Text="사무소&#32;" Top="6" VAlign="Middle" Width="80"></Static>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="CODE" Column="ZZACTSS" DataColumn="CODE_NAME" Height="20" Id="cb_zzactss" InnerDataset="ds_zzactss" Left="379" OnChanged="cb_zzactss_OnChanged" Style="sty_ipt_search" TabOrder="3" Top="5" Width="90"></Combo>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="CODE" Column="ZZPMNUM" DataColumn="CODE_NAME" Height="20" Id="cb_zzpmnum" InnerDataset="ds_zzpmnum_cd" Left="379" Style="sty_ipt_search" TabOrder="10" Top="29" Width="90"></Combo>
		<Static Align="Right" Height="20" Id="st_zzpmnum" Left="470" Style="sty_lb_search" TabOrder="5" Text="설치협력사&#32;" Top="6" VAlign="Middle" Width="80"></Static>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="CODE" Column="LIFNR" DataColumn="CODE_NAME" Height="20" Id="cb_lifnr" InnerDataset="ds_lifnr_cd" Left="550" Style="sty_ipt_search" TabOrder="6" Top="5" Width="160"></Combo>
		<Static Align="Right" Height="20" Id="st_zzlifnr" Left="916" Style="sty_lb_search" TabOrder="7" Text="외주작업구분&#32;" Top="6" VAlign="Middle" Width="80"></Static>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="CODE" Column="WORK_GUBUN" DataColumn="CODE_NAME" DisplayRowCnt="24" Height="20" Id="cb_workgubun" InnerDataset="ds_workgubun" Left="996" OnChanged="cb_workgubun_OnChanged" Style="sty_ipt_search" TabOrder="8" Top="5" Width="122"></Combo>
		<Static Align="Right" Height="20" Id="Static5" Left="712" Style="sty_lb_search" TabOrder="11" Text="외주업체&#32;" Top="30" VAlign="Middle" Width="80"></Static>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="CODE" Column="ZZLIFNR" DataColumn="CODE_NAME" Height="20" Id="cb_zzlifnr" InnerDataset="ds_zzlifnr_cd" Left="792" Style="sty_ipt_search" TabOrder="12" Top="29" Width="122"></Combo>
		<Static Align="Center" BKColor="yellow" Border="Flat" Color="black" Height="20" Id="Static0" Left="30" Style="sty_lb_search" TabOrder="15" Text="진행상태" Top="85" VAlign="Middle" Width="80"></Static>
		<Static Align="Center" BKColor="orange" Border="Flat" Color="black" Height="16" Id="Static3" Left="30" Style="sty_lb_search" TabOrder="16" Top="116" VAlign="Middle" Width="43"></Static>
		<Static Color="user7" Font="굴림,9" Height="16" Id="Static4" Left="78" TabOrder="17" Text="오렌지색&#32;필드는&#32;셀을&#32;더블클릭하면&#32;팝업&#32;창이&#32;뜹니다." Top="116" VAlign="Middle" Width="300"></Static>
		<Static Color="user7" Font="굴림,9" Height="16" Id="Static10" Left="118" TabOrder="14" Text="※" Top="89" VAlign="Middle" Width="16"></Static>
		<Static Align="Right" Height="22" Id="st_date" Left="30" Style="sty_lb_search" TabOrder="18" Text="청구월&#32;" Top="6" VAlign="Middle" Width="88"></Static>
		<Calendar BindDataset="ds_cond" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="SUP_DTF" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_f_from" Left="120" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_search" SundayTextColor="user35" TabOrder="19" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="7" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="83"></Calendar>
		<Static Align="Center" Border="None" Color="user7" Font="굴림,9" Height="20" Id="Static2" Left="204" TabOrder="21" Text="~" Top="7" VAlign="Middle" Width="10"></Static>
		<Calendar BindDataset="ds_cond" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="SUP_DTT" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_f_to" Left="214" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_search" SundayTextColor="user35" TabOrder="20" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="7" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="83"></Calendar>
		<Static Align="Right" Height="20" Id="Static6" Left="470" Style="sty_lb_search" TabOrder="24" Text="설치/구매&#32;" Top="30" VAlign="Middle" Width="80"></Static>
		<Radio BindDataset="ds_cond" Border="None" Column="I_RA" Height="16" Id="rd_ra" INDEX="0" Left="557" OnChanged="rd_ra_OnChanged" Style="sty_ipt_search_chk" TabOrder="13" Top="31" Width="150">
			<Contents>
				<Layout code="A" default="true" height="20" left="0" text="설치&#32;외주" top="0" width="80"/>
				<Layout code="B" height="20" left="80" text="구매&#32;외주" top="0" width="170"/>
			</Contents>
		</Radio>
		<Static Align="Right" Height="20" Id="Static7" Left="1120" Style="sty_lb_search" TabOrder="26" Text="진행상태&#32;" Top="6" VAlign="Middle" Width="80"></Static>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="CODE" Column="PROCESS" DataColumn="CODE_NAME" Height="20" Id="cb_process" InnerDataset="ds_process" Left="1200" Style="sty_ipt_search" TabOrder="27" Top="5" Width="130"></Combo>
		<Static Align="Right" Height="20" Id="Static11" Left="916" Style="sty_lb_search" TabOrder="28" Text="결재상태&#32;" Top="30" VAlign="Middle" Width="80"></Static>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="CODE" Column="CHARGE" DataColumn="code_name" Height="20" Id="cb_state" InnerDataset="ds_charge" Left="996" Style="sty_ipt_search" TabOrder="29" Top="29" Width="130"></Combo>
		<Static Color="user7" Font="굴림,9" Height="16" Id="Static13" Left="195" TabOrder="30" Text="1번:&#32;업체지정" Top="89" VAlign="Middle" Width="80"></Static>
		<Static Color="user8" Font="굴림,9,Bold" Height="16" Id="Static14" Left="134" TabOrder="31" Text="설치&#32;외주" Top="89" VAlign="Middle" Width="56"></Static>
		<Static Color="user7" Font="굴림,9" Height="16" Id="Static15" Left="268" TabOrder="32" Text="&#32;→&#32;2번:&#32;작업요청&#32;→&#32;3번:&#32;투입일정&#32;→&#32;4번:&#32;작업시작&#32;→&#32;5번:&#32;작업완료&#32;→&#32;6번:&#32;비용처리" Top="89" VAlign="Middle" Width="544"></Static>
		<Grid AreaSelect="TRUE" AutoFitEndLine="Hide" BindDataset="ds_list" BkColor2="default" BoldHead="true" Border="Flat" Bottom="555" ColSelect="TRUE" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="398" Id="grd_list" InputPanel="FALSE" Left="4" LineColor="user20" LineType="ExHORZ" OnCellDBLClick="grd_list_OnCellDblClick" OnHeadClick="grd_list_OnHeadClick" Right="972" RowHeight="20" Style="sty_grid" TabOrder="33" TabStop="true" Top="157" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="968">
			<contents>
				<format id="Default">
					<columns>
						<col fix="left" width="29"/>
						<col fix="left" width="37"/>
						<col fix="left" width="50"/>
						<col fix="left" width="54"/>
						<col fix="left" width="69"/>
						<col fix="left" width="184"/>
						<col fix="left" width="50"/>
						<col width="48"/>
						<col width="125"/>
						<col width="48"/>
						<col width="73"/>
						<col width="73"/>
						<col width="101"/>
						<col width="73"/>
						<col width="73"/>
						<col width="37"/>
						<col width="110"/>
						<col width="73"/>
						<col width="73"/>
						<col width="73"/>
						<col width="73"/>
						<col width="73"/>
						<col width="37"/>
						<col width="110"/>
						<col width="73"/>
						<col width="401"/>
						<col width="56"/>
					</columns>
					<head>
						<cell bkimageid="icon_grid_sel" col="0" display="text"/>
						<cell align="center" col="1" color="user21" display="checkbox" edit="checkbox" font="굴림,9" text="출력"/>
						<cell align="center" col="2" color="user21" display="text" font="굴림,9" text="사무소"/>
						<cell align="center" col="3" color="user21" display="text" font="굴림,9" text="PM"/>
						<cell align="center" bkcolor="orange" col="4" color="user21" display="text" font="굴림,9" text="호기"/>
						<cell align="center" col="5" color="user21" display="text" font="굴림,9" text="프로젝트명"/>
						<cell align="center" col="6" color="user21" display="text" font="굴림,9" text="동"/>
						<cell align="center" col="7" color="user21" display="text" font="굴림,9" text="공정율"/>
						<cell align="center" bkcolor="orange" col="8" color="user21" display="text" font="굴림,9" text="설치협력사"/>
						<cell align="center" col="9" color="user21" display="text" font="굴림,9" text="팀장"/>
						<cell align="center" col="10" color="user21" display="text" font="굴림,9" text="착공예정일"/>
						<cell align="center" col="11" color="user21" display="text" font="굴림,9" text="준공예정일"/>
						<cell align="center" col="12" color="user21" display="text" font="굴림,9" text="외주작업구분"/>
						<cell align="center" col="13" color="user21" display="text" font="굴림,9" text="작업개시일"/>
						<cell align="center" col="14" color="user21" display="text" font="굴림,9" text="작업종료일"/>
						<cell align="center" col="15" color="user21" display="text" font="굴림,9" text="구분"/>
						<cell align="center" col="16" color="user21" display="text" font="굴림,9" text="1.외주업체"/>
						<cell align="center" bkcolor="orange" col="17" color="user21" display="text" font="굴림,9" text="2.작업요청"/>
						<cell align="center" bkcolor="orange" col="18" color="user21" display="text" font="굴림,9" text="3.투입일정"/>
						<cell align="center" bkcolor="orange" col="19" color="user21" display="text" font="굴림,9" text="4.작업시작"/>
						<cell align="center" bkcolor="orange" col="20" color="user21" display="text" font="굴림,9" text="5.작업완료"/>
						<cell align="center" col="21" color="user21" display="text" font="굴림,9" text="비용청구"/>
						<cell align="center" col="22" color="user21" display="checkbox" edit="checkbox" font="굴림,9"/>
						<cell align="center" bkcolor="orange" col="23" color="user21" display="text" font="굴림,9" text="결재상태"/>
						<cell align="center" bkcolor="orange" col="24" color="user21" display="text" font="굴림,9" text="6.비용처리"/>
						<cell align="left" bkcolor="orange" col="25" color="user21" display="text" font="굴림,9" text="메모"/>
						<cell bkcolor="orange" col="26" color="user21" display="text" font="굴림,9" text="사진"/>
					</head>
					<body>
						<cell align="center" bkcolor2="user22" col="0" display="text" expr="currow+1"/>
						<cell col="1" colid="CHK" display="expr:iif(CONTRCT&#32;==&#32;&apos;91&apos;,&#32;&apos;default&apos;,&#32;&apos;checkbox&apos;)" edit="expr:iif(CONTRCT&#32;==&#32;&apos;91&apos;,&#32;&apos;default&apos;,&#32;&apos;checkbox&apos;)"/>
						<cell align="center" bkcolor2="user22" col="2" colid="ZZACTSS" display="text" suppress="1"/>
						<cell align="center" bkcolor2="user22" col="3" colid="PM_NAME" display="text" suppress="2"/>
						<cell align="center" bkcolor2="user22" col="4" colid="POSID" display="text" suppress="3"/>
						<cell bkcolor2="user22" col="5" colid="ZSITE_NM" display="text" suppress="4"/>
						<cell bkcolor2="user22" col="6" colid="DONG" display="text" suppress="5"/>
						<cell align="right" bkcolor2="user22" col="7" colid="PRO_R" display="text" suppress="6"/>
						<cell bkcolor2="user22" col="8" colid="LIFNR_NM" display="text" suppress="7"/>
						<cell align="center" bkcolor2="user22" col="9" colid="NAMET" display="text" suppress="8"/>
						<cell align="center" bkcolor2="user22" col="10" colid="ZZCHAKD" display="text" Mask="####.##.##" suppress="9"/>
						<cell align="center" bkcolor2="user22" col="11" colid="ZZCOMP2" display="text" Mask="####.##.##" suppress="10"/>
						<cell bkcolor2="user22" col="12" colid="JOB_NAME" display="text"/>
						<cell align="center" bkcolor2="user22" col="13" colid="START_DAY" display="text" Mask="####.##.##"/>
						<cell align="center" bkcolor2="user22" col="14" colid="END_DAY" display="text" Mask="####.##.##"/>
						<cell align="center" bkcolor2="user22" col="15" colid="CONFIRM_GBN" color="expr:iif(CONTRCT&#32;==&#32;&apos;91&apos;,&#32;&apos;red&apos;,&#32;&apos;default&apos;)" display="text"/>
						<cell bkcolor2="user22" col="16" colid="LIFNR_OUT_NAME" display="text"/>
						<cell align="center" bkcolor2="user22" col="17" colid="REQ_DATE" display="text" Mask="####.##.##"/>
						<cell align="center" bkcolor2="user22" col="18" colid="EXP_DATE" display="text" Mask="####.##.##"/>
						<cell align="center" bkcolor2="user22" col="19" colid="START_DATE" display="text" Mask="####.##.##"/>
						<cell align="center" bkcolor="expr:iif(COM_DATE&#32;!=&#32;null&#32;&amp;&amp;&#32;COM_DATE&#32;!=&#32;&apos;&apos;,&#32;&apos;lightgreen&apos;,&#32;&apos;yellow&apos;)" col="20" colid="COM_DATE" display="text" Mask="####.##.##"/>
						<cell align="center" bkcolor2="user22" col="21" colid="CHARGE_DATE" display="text" Mask="####.##.##"/>
						<cell col="22" colid="CHECK_CHARGE" display="expr:iif(STATE_CODE==&apos;D&apos;&#32;||&#32;STATE_CODE&#32;==&apos;E&apos;&#32;||&#32;STATE_CODE==&apos;F&apos;&#32;||&#32;STATE_CODE==&apos;K&apos;&#32;,&apos;checkbox&apos;,&apos;none&apos;)" edit="expr:iif(STATE_CODE&#32;==&apos;D&apos;&#32;||&#32;STATE_CODE&#32;==&apos;E&apos;&#32;||&#32;STATE_CODE&#32;==&apos;F&apos;||STATE_CODE==&apos;K&apos;,&apos;checkbox&apos;,&apos;none&apos;)"/>
						<cell align="center" bkcolor="expr:decode(STATE_CODE,&#32;&apos;D&apos;,&#32;&apos;powderblue&apos;,&#32;&apos;E&apos;,&#32;&apos;lightskyblue&apos;,&#32;&apos;F&apos;,&#32;&apos;lightskyblue&apos;,&apos;K&apos;,&apos;pink&apos;,&apos;G&apos;,&#32;&apos;lightskyblue&apos;,&#32;&apos;C&apos;,&#32;&apos;deepskyblue&apos;,&#32;&apos;H&apos;,&#32;&apos;cornflower&apos;,&#32;&apos;I&apos;,&#32;&apos;royalblue&apos;,&#32;&apos;Z&apos;,&#32;&apos;red&apos;,&#32;&apos;none&apos;)" bkcolor2="expr:decode(STATE_CODE,&#32;&apos;D&apos;,&#32;&apos;powderblue&apos;,&#32;&apos;E&apos;,&#32;&apos;lightskyblue&apos;,&#32;&apos;F&apos;,&#32;&apos;lightskyblue&apos;,&apos;K&apos;,&apos;pink&apos;,&apos;G&apos;,&#32;&apos;lightskyblue&apos;,&#32;&apos;C&apos;,&#32;&apos;deepskyblue&apos;,&#32;&apos;H&apos;,&#32;&apos;cornflower&apos;,&#32;&apos;I&apos;,&#32;&apos;royalblue&apos;,&#32;&apos;Z&apos;,&#32;&apos;red&apos;,&#32;&apos;User&#32;Color&#32;22&apos;)" col="23" colid="STATE" display="text"/>
						<cell align="center" bkcolor2="user22" col="24" colid="CHARGE_DAT" display="text" Mask="####.##.##"/>
						<cell bkcolor2="user22" col="25" colid="CONTENTS" display="text"/>
						<cell align="center" col="26" display="text" text="보기"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Button Height="18" Id="btn_popProj" ImageID="btn_icon_search" Left="279" OnClick="btn_popProj_OnClick" TabOrder="34" Text="Button0" Top="57" Transparent="TRUE" Width="18"></Button>
		<Combo BindDataset="ds_cond" BKColor="user0" Border="Flat" CodeColumn="cODE" Column="PERIOD" DataColumn="CODE_NAME" DkshadowColor="user26" Height="17" Id="cb_period" InnerDataset="ds_period" Left="30" Style="sty_ipt_search" TabOrder="23" Top="7" Width="87"></Combo>
		<Static Align="Right" Height="20" Id="Static1" Left="1331" Style="sty_lb_search" TabOrder="35" Text="결재대기&#32;" Top="6" VAlign="Middle" Width="80"></Static>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="CODE" Column="APP_STATE" DataColumn="code_name" Height="20" Id="cb_appState" InnerDataset="ds_appr2" Left="1412" Style="sty_ipt_search" TabOrder="36" Top="5" Width="109"></Combo>
		<Static Align="Right" Height="20" Id="Static8" Left="1523" Style="sty_lb_search" TabOrder="37" Text="구분&#32;" Top="6" VAlign="Middle" Width="80"></Static>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="CODE" Column="CONFIRM_GUBUN" DataColumn="CODE_NAME" Height="20" Id="cb_confirm_gubun" ImeMode="none" InnerDataset="ds_confirm_gubun" Left="1604" Style="sty_ipt_search" TabOrder="38" Top="5" Width="90"></Combo>
		<Static Align="Right" Height="20" Id="Static12" Left="1699" Style="sty_lb_search" TabOrder="39" Text="비용청구&#32;" Top="6" VAlign="Middle" Visible="FALSE" Width="80"></Static>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="CODE" Column="CHARGE" DataColumn="CODE_NAME" Height="20" Id="cb_charge" InnerDataset="ds_charge" Left="1780" Style="sty_ipt_search" TabOrder="40" Top="5" Visible="FALSE" Width="90"></Combo>
		<Static BKColor="mistyrose" Border="Flat" Color="black" Font="Default,9" Height="20" Id="Static16" Left="1165" Style="sty_lb_search" TabOrder="41" Text="&#32;결재라인" Top="39" VAlign="Middle" Width="56"></Static>
		<Static BKColor="user0" Border="None" Color="black" Height="20" Id="Static17" Left="1227" Style="sty_lb_search" TabOrder="42" Text="&#32;1차&#32;:" Top="39" VAlign="Middle" Width="32"></Static>
		<Static BKColor="user0" Border="None" Color="black" Height="20" Id="Static18" Left="1227" Style="sty_lb_search" TabOrder="43" Text="&#32;2차&#32;:" Top="60" VAlign="Middle" Width="32"></Static>
		<Static BKColor="user0" Border="None" Color="black" Height="20" Id="Static19" Left="1227" Style="sty_lb_search" TabOrder="44" Text="&#32;3차&#32;:" Top="81" VAlign="Middle" Width="32"></Static>
		<Static BKColor="user0" Border="None" Color="black" Height="20" Id="stc_1cha" Left="1261" Style="sty_lb_search" TabOrder="45" Top="39" VAlign="Middle" Width="63"></Static>
		<Static BKColor="user0" Border="None" Color="black" Height="20" Id="stc_2cha" Left="1261" Style="sty_lb_search" TabOrder="46" Top="60" VAlign="Middle" Width="63"></Static>
		<Static BKColor="user0" Border="None" Color="black" Height="20" Id="stc_3cha" Left="1261" Style="sty_lb_search" TabOrder="47" Top="81" VAlign="Middle" Width="63"></Static>
		<Button ButtonStyle="TRUE" Cursor="HAND" DragImageID="tab_form_05" Font="굴림,9" Height="20" Id="btn_lineChg" ImageID="btn_user_06" Left="1134" OnClick="btn_lineChg_OnClick" Style="sty_btn" TabOrder="48" Text="결재라인&#32;변경" Top="64" Width="88"></Button>
		<Static Align="Right" Height="20" Id="Static20" Left="712" Style="sty_lb_search" TabOrder="49" Text="대분류&#32;" Top="6" VAlign="Middle" Width="80"></Static>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="CODE" Column="H_WORK_GUBUN" DataColumn="CODE_NAME" Height="20" Id="cb_clsf" InnerDataset="ds_clsf" Left="792" OnChanged="cb_clsf_OnChanged" Style="sty_ipt_search" TabOrder="50" Top="5" Width="122"></Combo>
		<Radio BindDataset="ds_cond" BKColor="user0" Border="None" Column="RD_CHK" DisableBKColor="user5" Height="42" Id="rd_chk" INDEX="-1" Left="8" Style="sty_ipt_form_radio" TabOrder="52" Top="8" Width="15">
			<Contents>
				<Layout code="A" height="20" left="0" top="0" width="20"/>
				<Layout code="B" height="65" left="0" top="0" width="20"/>
			</Contents>
		</Radio>
		<Static Align="Center" Height="20" Id="Static21" Left="30" Style="sty_lb_search" TabOrder="51" Text="진행현장만&#32;보기" Top="30" VAlign="Middle" Width="106"></Static>
	</Form>
	<Script><![CDATA[/*
 ******************************************************************************************
 * 기      능   : 기타외주 작업지시서(관리자용)
 * 작  성  자   : 강민석K
 * 작성  일자   : 2019.07.08
 * ----------------------------------------------------------------------------------------
 * HISTORY    : 사용자 - 관리자(설치, 구매, 서비스, 안전) / 지사(설치PM, 지사장, 팀장)
 ******************************************************************************************
 */
#include "LIB::commons.js";	// 공통 스크립트
//=========================================================================================
// [ PART 1 ]
// Form에서 사용될 전역변수를 선언
// FORM에서 사용되는 전역변수는 대문자로 작성하며, F_XXX 의 형태를 갖도록 한다.
//=========================================================================================
var userGroup = "";
var userAuth = "";//사용자 권한 - 안전, 서비스 구분을 위한 변수 추가 - 2019.07.26 강민석K
//------------------------------------------------------------------------------------------------------
//조회 시 구분콤보의 인덱스 변수 추가 - 2019.07.30 강민석K
//승인, 출력 버튼 클릭 시 ds_list를 unfilter하는데 조회 시점의 구분콤보와 다르게 바꾸고 unfilter하면
//조회 시 filter 건 내용이 풀리는 문제 때문에 unfilter 후 조회 시점의 구분콤보 index로 다시 필터를 건다.
//------------------------------------------------------------------------------------------------------
//계약 테이블이 ZPSTW1404 에서 ZPSTW1401로 변경되어 필터처리 삭제 - 2019.07.31 강민석K
//var F_QUERY_GUBN_INDEX = -1;
//팝업화면이 닫히면 최신 메모를 표시하기 위해 그리드를 재조회하는데 최근에 클릭한 셀로 다시 스크롤 해주기 위한 변수 추가 - 2019.07.31 강민석K
var F_CURRENT_CLICKED_ROW_INDEX = -1;
var F_CURRENT_CLICKED_COL_INDEX = -1;
var F_AUTO_QUERY = false;//조회 버튼 클릭 시 false, 로직 상 재조회 시 true
var _NewDocuNo = "";
var G_TIMER ="";
var G_SELECT = false;
//=========================================================================================
// [ PART 2 ]
// Form Loading / Unloading 시 작업 정의
//=========================================================================================
function fn_OnLoadCompleted(obj) {
	//Form 로드 이벤트 맨 첫줄에 기술
	gfn_initForm(true);
	
	userGroup = gfn_getUserGroup();
	
	ed_pjt.SetFocus();
	
	//사용자가 관리팀 권한이 아닌 경우 '구분' 컬럼 숨김
	//if(userGroup != '40'){
	//	grd_list.SetColProp(15, "Width", 0);
	//}
	//계약 테이블이 ZPSTW1404 에서 ZPSTW1401로 변경되어 '구분' 컬럼은 모두 숨김 처리 - 2019.07.31 강민석K
	grd_list.SetColProp(15, "Width", 0);
	//계약 테이블이 ZPSTW1404 에서 ZPSTW1401로 변경되어 구분 콤보박스 숨김 처리 - 2019.07.31 강민석K
	Static8.Visible = false;
	cb_confirm_gubun.Visible = false;
	
	//사무소 콤보 조회
	var codeArr = ["PS003"];
    var dsObjArr = [ds_zzactss];
    var addTypeArr = [G_CODE_ALL];
    gfn_searchCommCode(codeArr, dsObjArr, addTypeArr);
    
	//나머지 콤보 조회
	ds_cond.SetColumn(0, "PROCESS", "1");
	rd_chk.Value = "A";
	
    tit_clearActionInfo();
	tit_addSearchActionInfo("ps02:PS0201001A_S35");	//설치협력사 콤보 조회
	tit_addSearchActionInfo("ps15:PS1505001A_S1");	//외주작업구분 콤보 조회
	tit_addSearchActionInfo("ps15:PS1505001A_S2");	//진행상태 콤보 조회
	tit_addSearchActionInfo("ps15:PS1505001A_S3");	//외주업체 콤보 조회
	tit_addSearchActionInfo("ps15:PS1505001A_S6");	//사용자 권한 조회
	tit_addSearchActionInfo("ps15:PS1505001A_S15");	// 사용자 결재 즐겨찾기 가져오기
	tit_addSearchActionInfo("ps15:PS1505001A_S9");	//외주작업구분 대분류 조회

	
	tit_callService(
		  ""
		, ""
		, "ds_cond=ds_cond"
		, "ds_lifnr_cd=ds_zzlifnr_cd ds_workgubun=ds_work ds_process=ds_process ds_zzlifnr_cd=ds_zzlifnr ds_auth=ds_auth ds_saveGyul=ds_gyul ds_clsf=ds_clsf"
		, ""
		, "fn_afterLifnr"
		, true
		, true);
}
/********************************************************************************
* 기      능   : fn_OnLoadCompleted Callback
********************************************************************************/
function fn_afterLifnr(errCode, errMsg) {
	//결재자 즐겨찾기 세팅
	//Trace(ds_saveGyul.saveXML());
	if(ds_saveGyul.GetRowCount() > 0)
	{
		stc_1cha.Text = ds_saveGyul.GetColumn(0, "GNM1");
		stc_2cha.Text = ds_saveGyul.GetColumn(0, "GNM2");
		stc_3cha.Text = ds_saveGyul.GetColumn(0, "GNM3");
	}
	else
	{
		stc_1Cha.Text = "미지정";
		stc_2Cha.Text = "미지정";
		stc_3Cha.Text = "미지정";
	}
	
	
	//설치협력사 콤보
	gfn_insertEmptyRow(ds_lifnr_cd, G_CODE_ALL);
	cb_lifnr.Index = 0;
	
	//외주작업구분 콤보
	gfn_insertEmptyRow(ds_clsf, G_CODE_ALL);
	cb_clsf.Index = 0;
	
	//외주작업구분 콤보
	gfn_insertEmptyRow(ds_workgubun, G_CODE_ALL);
	cb_workgubun.Index = 0;
	
	ds_workgubun.UnFilter();
	ds_workgubun.Filter("GBN == " + quote(rd_ra.Value) + " || CODE == ''");//'-전체-' 항목도 표시하기 위해 CODE == '' 사용
	
	//진행상태 콤보
	gfn_insertEmptyRow(ds_process, G_CODE_ALL);
	cb_process.Index = 0;
	
	//외주업체 콤보
	gfn_insertEmptyRow(ds_zzlifnr_cd, G_CODE_ALL);
	cb_zzlifnr.Index = 0;
	
	//---------------------------------------------------------------------------------
	//외주작업구분 콤보 선택 시 해당 외주작업을 담당하는 외주업체만 필터되도록 하기위해
	//쿼리(PS1505001A_S3)에서 ZPST0417 join이 추가되어 중복데이터가 발생하게됨.
	//중복데이터 제거를 위해 필터 컬럼을 추가하여 사용 - 2019.10.10 강민석K
	// - ds_zzlifnr_cd.Filter 관련 부분은 모두 수정
	ds_zzlifnr_cd.AddColumn("OVERLAP_FLAG", "STRING", 1);
	ds_zzlifnr_cd.SetColumn(0, "OVERLAP_FLAG", 1);
	
	var OUT_LIFNR_CD = "";
	var GBN = "";
	for(var i = 1; i < ds_zzlifnr_cd.rowcount; i++){//'-전체-' 항목 때문에 인덱스는 1부터 시작
		if(OUT_LIFNR_CD != ds_zzlifnr_cd.GetColumn(i, "CODE") || (OUT_LIFNR_CD == ds_zzlifnr_cd.GetColumn(i, "CODE") && GBN != ds_zzlifnr_cd.GetColumn(i, "GBN"))){
			ds_zzlifnr_cd.SetColumn(i, "OVERLAP_FLAG", 1);
			OUT_LIFNR_CD = ds_zzlifnr_cd.GetColumn(i, "CODE");
			GBN          = ds_zzlifnr_cd.GetColumn(i, "GBN");
		}else{
			//코드가 이전 row와 같은 업체는 중복으로 판단
			ds_zzlifnr_cd.SetColumn(i, "OVERLAP_FLAG", 0);
		}
	}
	//---------------------------------------------------------------------------------
	
	ds_zzlifnr_cd.UnFilter();
	//외주작업구분 콤보 선택 시 해당 외주작업을 담당하는 외주업체만 필터되도록 수정 - 2019.10.10 강민석K
	//ds_zzlifnr_cd.Filter("GBN == " + quote(rd_ra.Value) + " || CODE == ''");//'-전체-' 항목도 표시하기 위해 CODE == '' 사용
	ds_zzlifnr_cd.Filter("OVERLAP_FLAG == 1 && (GBN == " + quote(rd_ra.Value) + " || CODE == '')");//중복제거를 위해 필터 조건 수정 - 2019.10.10 강민석K
	
	//서비스확인 플래그(SVC_YN)는 default로 N을 세팅한다. 서비스면 Y로 바꾸는 처리는 아래 for문에서 한다.
	ds_cond.SetColumn(0, "SVC_YN", "N");
	
    //서비스(ZPS12), 안전(ZPS36) 팀은 조회만 가능 - 2019.07.26 강민석K
    var userAuthTemp = "";
    for(var i = 0; i < ds_auth.rowcount; i++){
		userAuthTemp = ds_auth.GetColumn(i, "AUTH");
		
		//영업팀(ZPS08)도 조회만 가능하도록 추가 - 2019.09.27 강민석K
		//if(userAuth == "ZPS12" || userAuth == "ZPS36"){
		if(userAuthTemp == "ZPS12" || userAuthTemp == "ZPS36" || userAuthTemp == "ZPS08"){
			userAuth = userAuthTemp;
			
			//결재승인/반려 불가 처리
			btn_approval.Enable = false;
			btn_reject.Enable = false;
			
			//서비스팀인 경우 서비스확인이 필요한 항목만 조회할 수 있다
			if(userAuth == "ZPS12"){
				ds_cond.SetColumn(0, "SVC_YN", "Y");
			}
		}
    }
    
    if(G_USER_ID == '3013545')	//QC팀장(양종규) 예외 처리 2020.09.28 홍세희 팀원 요청 QC 이강욱 팀장님으로 변경. 2021-03-29 김상훈 기원님으로 변경 요청 - 맹준호GJ
    {
		btn_approval.Enable = true;
		btn_reject.Enable = true;
    }
}
/********************************************************************************
* 기      능   : 공통코드가 조회된 후의 Callback 함수
********************************************************************************/
function fn_completeInit(sCode, sDsObj, sCodeType) {
	//조회일자 세팅
    cal_f_from.Value = gfn_getAfterDate(gfn_getCurrDate(), -30);
    cal_f_to.Value	 = gfn_getAfterDate(gfn_getCurrDate(), 60);

	//콤보 index 세팅
	cb_period.Index = 0;		//조회기간 종류
	cb_zzactss.Index = 0;		//사무소 콤보
	cb_confirm_gubun.Index = 0;	//구분(계약상태 구분 - 취소 : 계약된 후 포기된 건, 변경 : 포기된 후 재계약된 건)
	cb_charge.Index = 0;		//비용청구
	
	rd_ra.Index = 0;			//설치외주/구매외주 라디오버튼 세팅

	//지사권한인 경우 사무소 콤보 고정, 비활성화
	if(userGroup == "30"){
		cb_zzactss.Index = ds_zzactss.FindRow("CODE", G_AREA_CODE_E);
		cb_zzactss.Enable = false;
		cb_zzactss_OnChanged(G_AREA_CODE_E, G_AREA_CODE_E, cb_zzactss.GetSelText(), -1, cb_zzactss.Index);
	}
}
/********************************************************************************
* 기      능   : form UnloadCompleted
********************************************************************************/
function fn_OnUnloadCompleted(obj) {
	return gfn_isFormUnload(obj);
}
//=========================================================================================
// [ PART 3 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,form닫기)
//=========================================================================================
/********************************************************************************
* 기      능   : 조회 1
********************************************************************************/
function fn_query() {
	if(G_SELECT == true)
	{
		gfn_openMsgWin("조회 중입니다. 잠시만 기다려주세요..\n(팝업이 반복되는 경우, 프로그램을 종료 후\n다시 실행해주세요.");
		return;
	}

	
	//계약 테이블이 ZPSTW1404 에서 ZPSTW1401로 변경되어 필터처리 삭제 - 2019.07.31 강민석K
	//F_QUERY_GUBN_INDEX = cb_confirm_gubun.Index;
	
	//조회기간 체크
	if(!gfn_checkFromToObj(cal_f_from, cal_f_to, true, cb_period.Text)) {
		return;
	}
	
	var diffDays = gfn_getDayCnt(ds_days, cal_f_from.value, cal_f_to.value);
	
	//필수 조회조건 체크
	if(rd_ra.Value == "A"){
		//설치외주인 경우 기존 체크로직
		/*
		if(gfn_isNull(ed_pjt, false) && (gfn_isNull(cb_zzpmnum, false) || gfn_isNull(cb_zzactss, false)))
		{
			
			//[프로젝트 또는 사무소, 설치PM]중 하나이상 필수선택입니다. 확인바랍니다.
			gfn_showMsg("CW00207", "프로젝트 또는 사무소, 설치PM");
			return;
		}*/

		// 프로젝트 또는 사무소 3개월 필수
		if(gfn_isNull(ed_pjt, false) && (gfn_isNull(cb_zzactss, false) || diffDays > 365))
		{
		
			//[프로젝트 또는 사무소, 설치PM]중 하나이상 필수선택입니다. 확인바랍니다.
			gfn_showMsg("CW00207", "프로젝트 또는 사무소만 선택 시, 조회일자 1년이내");
			return;
		}
	}else{
		//구매외주는 프로젝트 번호가 없으면 조회 속도가 너무 느려 프로젝트 번호를 필수 조회조건으로 처리
		/*
		if(gfn_isNull(ed_pjt, false) || length(ed_pjt.Text) != 6){
			//gfn_showMsg("프로젝트 번호는 필수입력입니다. 프로젝트 번호 6자리를 확인바랍니다.");
			//return;
		}
		*/
		
		// 프로젝트 또는 사무소 3개월 필수
		if(gfn_isNull(ed_pjt, false)  && diffDays > 365)
		{
			gfn_openMsgWin("조회일자를 1년 이내로 선택해 주십시오.");
			return;
		}
	}
	
	ds_list.ClearData();
	
	//비용결재 관련 테이블이 설치외주와 구매외주가 달라 쿼리를 분리한다. - 2019.07.11 강민석K
	var callTargetInfo = "";
	if(rd_ra.Value == "A"){
		callTargetInfo = "ps15:PS1505001A_S4";//설치외주
	}else{
		callTargetInfo = "ps15:PS1505001A_S5";//구매외주
	}
	
	//fn_createWait("",this);
	G_SELECT = true;
	
	tit_clearActionInfo();
	tit_addSearchActionInfo(callTargetInfo);
	tit_addSearchActionInfo("ps15:PS1505001A_S15");	// 사용자 결재 즐겨찾기 가져오기
	tit_callService(
          ""
        , ""
        , "ds_cond=ds_cond"
        , "ds_list=ds_list ds_saveGyul=ds_gyul"
        , ""
        , "fn_afterQuery"
        , true);
}
/********************************************************************************
* 기      능   : 닫기
********************************************************************************/
function fn_close() {
	close();
}
/********************************************************************************
* 기      능   : 엑셀
********************************************************************************/
function fn_excel() {
	// Excel Export
	gfn_saveToExcel(grd_list, true);
}
/********************************************************************************
* 기      능   : 승인 10
********************************************************************************/
function fn_approval() {

	//결재 대기 상태는 필수로 선택해야함.
	if(cb_appState.Value == "")
	{
		gfn_openMsgWin("결재대기 상태를 선택해 주세요.(전체 제외)");
		return;
	}
	
	var nChkCnt = ds_list.CaseCount("CHECK_CHARGE=='1'");
	if(nChkCnt == 0)
	{
		gfn_openMsgWin("결재할 작업이 선택되지 않았습니다.\n결재하실 작업을 선택해주세요.");
		return;
	}
	
	// ## 결재할 작업이 하나라도 있는 경우 ##
	
	// 1. 결재대기가 1차(PM) 결재라인 생성까지 해야하는 경우 (**신규와 반려 구분해야 함)
	// ZPSTEA01M INSERT - 반려일 경우 이전 DOCU_NO 까지 저장
	// ZPSTEA01D INSERT
	// ZPSTW1401 UPDATE
	if(cb_appState.Value == 'A')
	{
		ufn_apprReq_First();	// 1차결재 로직
	}
	// 2. 2차(지사장), 3차(팀장) 결재만 하면 되는 경우
	// ZPSTEA01M UPDATE
	// ZPSTEA01D UPDATE
	// ZPSTW1401 UPDATE
	else if(cb_appState.Value == 'B' || cb_appState.Value == 'C' || cb_appState.Value == 'D')
	{
		ufn_apprReq_Etc();	// 2차, 3차 결재 로직
	}
	
	

	/*
	ds_list.Filter("CHECK_CHARGE == '1'");
	ds_list_tmp.CopyF(ds_list);
	ds_list.UnFilter();
	ufn_cbConfirmGubunFilter();
	
	if(ds_list_tmp.rowcount == 0){
		//선택여부 체크
		gfn_openMsgWin("결재승인 할 호기의 결재 컬럼을 체크하세요.", "E", "", "");
		return;
	}else if(ds_list_tmp.rowcount > 1){
		//멀티선택여부 체크
		gfn_openMsgWin("결재승인은 1건씩 처리 할 수 있습니다.", "E", "", "");
		return;
	}
	
	//비용청구 여부 체크
	var stateCode = ds_list_tmp.GetColumn(0, "STATE_CODE");
	if(length(trim(stateCode)) == 0){
		gfn_openMsgWin("비용청구 되지 않은 건은 결재승인 할 수 없습니다.", "E", "", "");
		return;
	}
	*/
	//------------------------------------------------------------------------------------------------
	//권한 별 처리
	//ZPSTW1404용
	/*
	if(userGroup == "30" && stateCode != "A"){//지사권한인 경우
		gfn_openMsgWin("결재승인 할 수 없는 항목입니다.\n지사권한은 업체요청 상태인 건만 승인 할 수 있습니다.", "E", "", "");
		return;
	}
	
	var tobe_state = "D";
	
	if(userGroup == "40"){//관리팀 권한인 경우
		if(stateCode != "D"){
			gfn_openMsgWin("결재승인 할 수 없는 항목입니다.\n관리팀권한은 지사결재 상태인 건만 승인 할 수 있습니다.", "E", "", "");
			return;
		}
		
		tobe_state = "E";
	}
	*/
	
	//ZPSTW1401에서는 STATE 코드값이 달라져서 수정. 2019.07.31 강민석K
	/*
	if((userGroup == "30" || userGroup == "40") && stateCode != "D"){//지사권한인 경우
		gfn_openMsgWin("결재승인 할 수 없는 항목입니다.\n지사권한은 업체요청 상태인 건만 승인 할 수 있습니다.", "E", "", "");
		return;
	}
	*/
	var tobe_state = "G";
	
	if(userGroup == "40"){//관리팀 권한인 경우
		//관리팀 승인은 전표처리 로직이 필요하여 SAP에서 처리하기로 함. 2019.08.01 강민석K (정태성K 확인사항)
		//gfn_openMsgWin("관리팀 승인은 SAP 기능을 사용하세요.", "E", "", "");
		//return;
		/*
		if(stateCode != "G"){
			gfn_openMsgWin("결재승인 할 수 없는 항목입니다.\n관리팀권한은 지사결재 상태인 건만 승인 할 수 있습니다.", "E", "", "");
			return;
		}
		
		tobe_state = "C";
		*/
	}
	//------------------------------------------------------------------------------------------------
	
	/*
	var chargeDate = ds_list_tmp.GetColumn(0, "CHARGE_DATE");
	var msg = "작업명 : " + ds_list_tmp.GetColumn(0, "JOB_NAME")
	        + "\n호기 : " + ds_list_tmp.GetColumn(0, "POSID")
	        + "\n비용청구일 : " + substr(chargeDate, 0, 4) + "-" + substr(chargeDate, 4, 2) + "-" + substr(chargeDate, 6, 2)
	        + "\n승인 하시겠습니까?";
	
	//승인 여부 확인
	if(!gfn_openMsgWin(msg, "I", "C", "")){
		return;
	}
	
	ds_appr.DeleteAll();
	ds_appr.AddRow();
	
	ds_appr.SetColumn(0, "PSPID", ds_list_tmp.GetColumn(0, "PSPID"));
	ds_appr.SetColumn(0, "POSID", ds_list_tmp.GetColumn(0, "POSID"));
	ds_appr.SetColumn(0, "GBN", ds_list_tmp.GetColumn(0, "JOB_CODE"));//작업코드
	ds_appr.SetColumn(0, "CHASU", ds_list_tmp.GetColumn(0, "CHASU"));//계약차수
	ds_appr.SetColumn(0, "LIFNR", ds_list_tmp.GetColumn(0, "LIFNR_OUT"));//외주작업업체 코드
	ds_appr.SetColumn(0, "STATE", tobe_state);//저장할 결재상태
	
	tit_clearActionInfo();
	tit_addMultiActionInfo("ps15:PS1505001A_U1");
	tit_callService(
		  ""
		, ""        
		, "ds_appr=ds_appr"
		, ""
		, ""
		, "fn_query"
		, ""
		, ""
		, true
	);
	*/
	
	
	
}
/********************************************************************************
* 기      능   : 반려 32
********************************************************************************/
function fn_reject() {
	//결재 대기 상태는 필수로 선택해야함.
	if(cb_appState.Value == "")
	{
		gfn_openMsgWin("결재대기 상태를 선택해 주세요.(전체 제외)");
		return;
	}
	
	var nChkCnt = ds_list.CaseCount("CHECK_CHARGE=='1'");
	if(nChkCnt == 0)
	{
		gfn_openMsgWin("반려할 작업이 선택되지 않았습니다.\n반려하실 작업을 선택해주세요.");
		return;
	}
	
	nChkCnt = ds_list.CaseCount("CHECK_CHARGE=='1' && STATE_CODE!='D' && STATE_CODE!='E' && STATE_CODE!='F' && STATE_CODE!='K'");
	if(nChkCnt > 0)
	{
		gfn_openMsgWin("반려할 수 없는 작업이 존재합니다.");
		return;
	}
	
	var rjtType = "";
	// ## 결재할 작업이 하나라도 있는 경우 ##
	
	// 1. 결재대기가 1차(PM) 결재라인 생성까지 해야하는 경우 (**신규와 반려 구분해야 함)
	// ZPSTEA01M INSERT - 반려일 경우 이전 DOCU_NO 까지 저장
	// ZPSTEA01D INSERT
	// ZPSTW1401 UPDATE
	if(cb_appState.Value == 'A')	// PM결재에서 반려
	{
		rjtType = 'TYPE1';	// 1차결재 로직
	}
	// 2. 2차(지사장), 3차(팀장) 반려
	// ZPSTEA01M UPDATE
	// ZPSTEA01D UPDATE
	// ZPSTW1401 UPDATE
	else if(cb_appState.Value == 'B' || cb_appState.Value == 'C' || cb_appState.Value == 'D')
	{
		rjtType = 'TYPE2';	// 2차, 3차 결재 로직
	}
	
	ds_list.Filter("CHECK_CHARGE == '1'");
	ds_list_tmp.CopyF(ds_list);
	ds_list.UnFilter();
	/*
	ds_list.Filter("CHECK_CHARGE == '1'");
	ds_list_tmp.CopyF(ds_list);
	ds_list.UnFilter();
	ufn_cbConfirmGubunFilter();
	
	if(ds_list_tmp.rowcount == 0){
		//선택여부 체크
		gfn_openMsgWin("결재반려 할 호기의 결재 컬럼을 체크하세요.", "E", "", "");
		return;
	}else if(ds_list_tmp.rowcount > 1){
		//멀티선택여부 체크
		gfn_openMsgWin("결재반려는 1건씩 처리 할 수 있습니다.", "E", "", "");
		return;
	}
	
	//비용청구 여부 체크
	var stateCode = ds_list_tmp.GetColumn(0, "STATE_CODE");
	if(length(trim(stateCode)) == 0){
		gfn_openMsgWin("비용청구 되지 않은 건은 결재반려 할 수 없습니다.", "E", "", "");
		return;
	}
	*/
	//------------------------------------------------------------------------------------------------
	//권한 별 처리
	//ZPSTW1404용
	/*
	if(userGroup == "30" && stateCode != "A"){//지사권한인 경우 업체요청 상태인 건만 승인 할 수 있다
		gfn_openMsgWin("결재반려 할 수 없는 항목입니다.\n지사권한은 업체요청 상태인 건만 반려 할 수 있습니다.", "E", "", "");
		return;
	}
	
	if(userGroup == "40"){//관리팀인 경우
		if(stateCode != "D"){//관리팀은 지사결재(팀장) 상태인 건만 승인 할 수 있다
			gfn_openMsgWin("결재반려 할 수 없는 항목입니다.\n관리팀권한은 지사결재 상태인 건만 반려 할 수 있습니다.", "E", "", "");
			return;
		}
	}
	*/
	/*
	//ZPSTW1401에서는 STATE 코드값이 달라져서 수정. 2019.07.31 강민석K
	if((userGroup == "30" || userGroup == "40") && stateCode != "D"){//지사권한인 경우
		gfn_openMsgWin("결재반려 할 수 없는 항목입니다.\n지사권한은 업체요청 상태인 건만 반려 할 수 있습니다.", "E", "", "");
		return;
	}*/
	
	if(userGroup == "40"){//관리팀 권한인 경우
		//관리팀 승인은 전표처리 로직이 필요하여 SAP에서 처리하기로 함. 2019.08.01 강민석K (정태성K 확인사항)
		//gfn_openMsgWin("관리팀 반려는 SAP 기능을 사용하세요.", "E", "", "");
		//return;
		/*
		if(stateCode != "G"){
			gfn_openMsgWin("결재반려 할 수 없는 항목입니다.\n관리팀권한은 지사결재 상태인 건만 반려 할 수 있습니다.", "E", "", "");
			return;
		}
		*/
	}
	//------------------------------------------------------------------------------------------------
	
	//반려사유 입력 팝업 표시
	var arg  = " G_MENU=" + quote("A");// 관리자화면
	    arg += " RJT_TYPE=" + quote(rjtType);	// 반려타입 TYPE1 : PM반려, TYPE2 : 지사장,팀장 반려
	    
	gfn_openPopup("PS1505001L", true, arg);
}
/********************************************************************************
* 기      능   : 출력 40
********************************************************************************/
function fn_print() {
	//선택여부 체크
	if(ds_list.FindRow("CHK", 1) == -1){
		gfn_showMsg('CW00046');
		return;
	}
	
	ds_list_tmp.ClearData();
	ds_list.Filter("CHK == '1'");
	ds_list_tmp.copyF(ds_list);
	ds_list.unFilter();
	
	//trace("ds_list_tmp : " + ds_list_tmp.SaveXML());
	
	//작업완료가 되지 않은 항목이 있는지 체크
	ds_list_tmp.Filter("COM_DATE == '' || COM_DATE == null");
	var inCompleteCnt = ds_list_tmp.rowcount;
	ds_list_tmp.UnFilter();
	
	if(inCompleteCnt > 0){
		gfn_showMsg("작업완료가 되지 않은 항목은 완료확인서를 출력 할 수 없습니다.");
		return;
	}
	
	//외주작업 종류가 섞여 있는지 체크
	var bDiffrent = false;
	var curGbn = ds_list_tmp.GetColumn(0, "JOB_CODE");
	for(var j = 1; j < ds_list_tmp.rowcount; j++){
		if(ds_list_tmp.GetColumn(j, "JOB_CODE") != curGbn){
			bDiffrent = true;
			break;
		}
	}
	
	if(bDiffrent == true){
		gfn_showMsg("1종류의 외주작업만 출력 할 수 있습니다.");
		return;
	}
	
	var argPspid = "";		//프로젝트번호 모음
	var argPosid = "";		//호기번호 모음
	var paramPspid = "";	//프로젝트번호 IN절
	var paramPosid = "";	//호기번호 IN절
	var pspid = "";
	
	ds_list_tmp.Sort("PSPID,POSID",True);
	
	for(var i = 0; i < ds_list_tmp.rowcount; i++)
	{
		if(pspid != ds_list_tmp.GetColumn(i, "PSPID")){
			argPspid += "'" + ds_list_tmp.GetColumn(i, "PSPID") + "'" + ",";
		}
		
		pspid = ds_list_tmp.GetColumn(i, "PSPID");
		
		argPosid += "'" + ds_list_tmp.GetColumn(i, "POSID") + "'" + ",";
	}
	
	if(substr(argPspid, length(argPspid) - 1) == ","){
		argPspid = substr(argPspid, 0, length(argPspid) - 1);
	}
	paramPspid = " AND A.PSPID IN (" + argPspid + ")";
	
	if(substr(argPosid, length(argPosid) - 1) == ","){
		argPosid = substr(argPosid, 0, length(argPosid) - 1);
	}
	paramPosid = " AND A.POSID IN (" + argPosid + ")";
	
	ds_cond_p.ClearData();
	ds_cond_p.AddRow();
	ds_cond_p.SetColumn(0,"GUBUN1", paramPspid);//프로젝트번호 IN 조건
	ds_cond_p.SetColumn(0,"GUBUN2", paramPosid);//호기번호 IN 조건
	ds_cond_p.SetColumn(0,"GBN", ds_list_tmp.GetColumn(0, "JOB_CODE"));//작업종류
	
	tit_clearActionInfo();
	tit_addSearchActionInfo("ps15:PS1505001A_S8");
	tit_callService(
          ""
        , ""
        , "ds_cond_p=ds_cond_p"
        , "ds_list_p=ds_list_p"
        , ""
        , ""
        , ""
		, ""
        , true);
	
	Dialog("PS15::PS1505001P.xml", "");
}
//=========================================================================================
// [ PART 4]
// Callback 함수 정의 : callback 함수명은 메인 함수의 fn_xxxx() 에서 xxxx 부분은 fn_afterXXXX()
// 형태가 되도록 작성
//=========================================================================================
/********************************************************************************
* 기      능   : 조회 Callback
********************************************************************************/
function fn_afterQuery(errCode, errMsg) {
	// 결재라인 세팅
	if(ds_saveGyul.GetRowCount() > 0)
	{
		stc_1cha.Text = ds_saveGyul.GetColumn(0, "GNM1");
		stc_2cha.Text = ds_saveGyul.GetColumn(0, "GNM2");
		stc_3cha.Text = ds_saveGyul.GetColumn(0, "GNM3");
	}
	else
	{
		stc_1Cha.Text = "미지정";
		stc_2Cha.Text = "미지정";
		stc_3Cha.Text = "미지정";
	}
	
	//구매는 계약상태를 관리하지 않는다 - 2019.07.30 강민석K (구매팀 왕재영S 확인사항)
	if(rd_ra.Value == "A"){
		ufn_cbConfirmGubunFilter();
	}
	
	//trace("F_CURRENT_CLICKED_ROW_INDEX : " + F_CURRENT_CLICKED_ROW_INDEX);
	//trace("ds_list.rowcount : " + ds_list.rowcount);
	
	//최근 위치로 그리드 스크롤
	if(F_AUTO_QUERY == true){
		F_AUTO_QUERY = false;
		
		if(F_CURRENT_CLICKED_ROW_INDEX <= ds_list.rowcount){
			//오히려 헷갈릴 것 같아 일단 주석처리 함 - 2019.08.01 강민석K
			//grd_list.VScrollPos = F_CURRENT_CLICKED_ROW_INDEX;
			//grd_list.HScrollPos = F_CURRENT_CLICKED_COL_INDEX;
		}else{
			//변수 초기화
			F_CURRENT_CLICKED_ROW_INDEX = -1;
			F_CURRENT_CLICKED_COL_INDEX = -1;
		}
	}
	
	G_SELECT = false;
	// 메시지 처리
	gfn_showSearchMsg(grd_list);
}
/********************************************************************************
* 기      능   : 저장 Callback
********************************************************************************/
function fn_afterSave(errCode, errMsg) {
	if(errCode != 0){
		gfn_showMsg("CE00001");
	}else{
		gfn_showMsg("CI00003");
	}
}
//=========================================================================================
// [ PART 5 ]
// Detail Process Event 정의 ( User Define function )
// 사용자 정의 함수는 ufn_xxxx() 형태로 작성
//=========================================================================================
/********************************************************************************
* 기      능   : 계약상태 구분 콤보에 따른 필터 처리
********************************************************************************/
function ufn_cbConfirmGubunFilter() {
	//계약상태 구분을 제외한 조건으로 전체 조회된 데이터를 필터하여 정상/취소/변경을 표시한다. - 2019.07.29 강민석K
	//계약 테이블이 ZPSTW1404 에서 ZPSTW1401로 변경되어 필터처리 삭제 - 2019.07.31 강민석K
	/*
	if(F_QUERY_GUBN_INDEX == 0){
		//전체
		ds_list.UnFilter();
	}else if(F_QUERY_GUBN_INDEX == 1){
		//취소
		ds_list.Filter("CONTRCT == '91'");
	}else if(F_QUERY_GUBN_INDEX == 2){
		//변경
		ds_list.Filter("CONTRCT == '80' && CHASU != '001'");
	}
	*/
}
//=========================================================================================
// [ PART 6 ]
// component Event 정의 : 각 Component 별 이벤트
//=========================================================================================
/********************************************************************************
* 기      능   : 그리드 헤더 클릭시 정렬 처리
********************************************************************************/
function grd_list_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
{
	if(nCell == 0){
		// 그리드 표시할 컬럼 선택
		gfn_selectGridCol(obj);
	}else if(nCell == 1){
		// 전체 체크/해제
		gfn_selectAllGrid(obj,nCell,nCell,true);
	}else if(nCell == 22){
		// 전체 체크/해제
		obj.ReDraw = false;
		
		var strChk = decode(obj.getCellProp("head", nCell, "Text"), "1", "0", "1");
		// Head 체크
		obj.SetCellProp("head", nCell, "Text", strChk);
		
		// Data 체크
		for(var i=0;i<ds_list.rowcount;i++)
		{
			var sState = ds_list.getColumn(i, "STATE_CODE");
			
			if(sState == 'D' || sState == 'E' || sState == 'F')
			{
				ds_list.SetColumn(i, "CHECK_CHARGE", strChk);
			
			}
		}
		
		obj.ReDraw = true;
	}else{
		// 그리드 정렬 처리
		gfn_sortGrid(obj,nCell);
	}
}
/********************************************************************************
* 기      능   : 데이터셋 값 변경 시 - Flag 처리
********************************************************************************/
function ds_list_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{
	gfn_changeFlag( obj, strColumnID, nRow, "FLAG" );
}
/********************************************************************************
* 기      능   : 사무소 변경 시 -> 설치협력사 콤보 필터, 설치PM 콤보 조회
********************************************************************************/
function cb_zzactss_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	//설치협력사 콤보 필터
	if(userGroup == "40" || userGroup == "30")
	{
		ds_cond.SetColumn(0, "LIFNR", '');
		ds_cond.SetColumn(0, "ZZLIFNR", '');
	}
	
	//사무소 콤보 선택이 '전체'인 경우
    if(ds_cond.GetColumn(0, "ZZACTSS") == '')
    {
		ds_lifnr_cd.UnFilter();//모든 설치협력사가 표시되도록 필터 제거
		//외주업체와 사무소는 관계가 없다고 하여 주석처리 - 2019.10.10 강민석K
		//ds_zzlifnr_cd.UnFilter();//모든 외주업체가 표시되도록 필터 제거
		
		cb_lifnr.Index = 0;
    }
    else
    {
		var arr = ds_cond.GetColumn(0, "ZZACTSS");//선택된 사무소코드
		
		//선택된 사무소코드로 설치협력사, 외주업체 콤보 필터
		ds_lifnr_cd.Filter("ZZACTSS == " + quote(arr) + " || CODE == ''");//'-전체-' 항목도 표시하기 위해 CODE == '' 사용
		//외주업체와 사무소는 관계가 없다고 하여 주석처리 - 2019.10.10 강민석K
		//ds_zzlifnr_cd.Filter("ZZACTSS == " + quote(arr) + " || CODE == ''");//'-전체-' 항목도 표시하기 위해 CODE == '' 사용
    }
    
    //설치PM 콤보 조회
	ds_cond.SetColumn(0, "ZZACTSS", strCode);
	cb_zzpmnum.value = "";
	
	var recvDataSet = "ds_zzpmnum_cd=ds_zzpmnum_cd";//수신받을 데이터셋
	
	tit_clearActionInfo();
	tit_addSearchActionInfo("ps02:PS0201001A_S42");
	
	//설치PM의 TEMNO(팀장코드?) 조회 - 설치PM으로 로그인한 경우 설치PM 콤보 자동 선택 처리 추가 - 2019.07.29 강민석K (고범석K 요구사항)
	if(userGroup == "30"){
		ds_temno.ClearData();
		tit_addSearchActionInfo("ps15:PS1505001A_S7");
		recvDataSet += " ds_temno=ds_temno";
	}
	
	tit_callService(
		  ""
		, ""
		, "ds_cond=ds_cond"
		, recvDataSet
		, ""
		, "fn_afterZzactssChange"
		, true
		, true);
}
/********************************************************************************
* 기      능   : 설치PM 콤보 조회 Callback
********************************************************************************/
function fn_afterZzactssChange(errCode, errMsg) {
	gfn_insertEmptyRow(ds_zzpmnum_cd, G_CODE_ALL);
	
	//설치PM의 TEMNO(팀장코드?) 조회 - 설치PM으로 로그인한 경우 설치PM 콤보 자동 선택 처리 추가 - 2019.07.29 강민석K (고범석K 요구사항)
	if(ds_temno.rowcount == 1 && ds_zzpmnum_cd.FindRow("CODE", ds_temno.GetColumn(0, "TEMNO")) > 0){
		cb_zzpmnum.Value = ds_temno.GetColumn(0, "TEMNO");
	}else{
		cb_zzpmnum.Value = "";
	}
}
/********************************************************************************
* 기      능   : 외주작업구분 변경 시 -> 외주업체 콤보 필터 기능 추가 - 2019.10.10 강민석K
********************************************************************************/
function cb_workgubun_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	ds_zzlifnr_cd.UnFilter();
	
	if(rd_ra.Value == 'A')	// 설치
	{
		ds_condLifnr.ClearData();
		ds_condLifnr.AddRow();
		ds_condLifnr.SetColumn(0, "GBN", 'A');
		ds_condLifnr.SetColumn(0, "JOB_CODE", strCode);
	}
	else	// 구매
	{
		//Trace(ds_zzlifnr_cd.saveXML());
		ds_condLifnr.ClearData();
		ds_condLifnr.AddRow();
		ds_condLifnr.SetColumn(0, "GBN", 'B');

	}
	
	//업체 재조회
		tit_clearActionInfo();
		tit_addSearchActionInfo("ps15:PS1505001A_S31");
		tit_callService(
			  ""
			, ""
			, "ds_cond=ds_condLifnr"
			, "ds_zzlifnr_cd=ds_zzlifnr"
			, ""
			, ""
			, ""
			, ""
			, true);
		
	gfn_insertEmptyRow(ds_zzlifnr_cd, G_CODE_ALL);
	cb_zzlifnr.Index = 0;
}
/********************************************************************************
* 기      능   : 프로젝트 번호 검색 버튼 클릭
********************************************************************************/
function btn_popProj_OnClick(obj)
{
	var arg = "pjt=" + quote(ed_pjt.Text);
	gfn_openPopup("CS9601002A", true, arg);
}
/********************************************************************************
* 기      능   : 설치외주/구매외주 라디오버튼 선택
********************************************************************************/
function rd_ra_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	//외주작업구분 콤보 필터
	ds_workgubun.UnFilter();
	ds_workgubun.Filter("GBN == " + quote(strCode) + " || CODE == ''");//'-전체-' 항목도 표시하기 위해 CODE == '' 사용
	cb_workgubun.Index = 0;
	
	//외주업체 콤보 필터
	ds_zzlifnr_cd.UnFilter();
	//외주작업구분 콤보 선택 시 해당 외주작업을 담당하는 외주업체만 필터되도록 수정 - 2019.10.10 강민석K
	//ds_zzlifnr_cd.Filter("GBN == " + quote(strCode) + " || CODE == ''");//'-전체-' 항목도 표시하기 위해 CODE == '' 사용
	//ds_zzlifnr_cd.Filter("OVERLAP_FLAG == 1 && (GBN == " + quote(strCode) + " || CODE == '')");//중복제거를 위해 필터 조건 수정 - 2019.10.10 강민석K
	
	ds_clsf.UnFilter();
	
	if(strCode == 'A')
	{
		ds_clsf.Filter("1=1");
	}
	else
	{
		ds_clsf.Filter("CODE == ''");
	}
	
	cb_clsf.Index = 0;
	
	ds_condLifnr.ClearData();
	ds_condLifnr.AddRow();
	ds_condLifnr.SetColumn(0, "GBN", rd_ra.Value);
	
	//업체 재조회
	tit_clearActionInfo();
	tit_addSearchActionInfo("ps15:PS1505001A_S31");
	tit_callService(
		  ""
		, ""
		, "ds_cond=ds_condLifnr"
		, "ds_zzlifnr_cd=ds_zzlifnr"
		, ""
		, ""
		, ""
		, ""
		, true);
		
	
	gfn_insertEmptyRow(ds_zzlifnr_cd, G_CODE_ALL);
	
	cb_zzlifnr.Index = 0;
	
	//권한에 따라 화면 표시 수정
	if(strCode == 'A'){//설치외주인 경우
		
		//서비스팀(ZPS12), 안전팀(ZPS36)은 결재승인/반려를 할 수 없다
		//영업팀(ZPS08)도 결재승인/반려를 할 수 없도록 수정 - 2019.09.27 강민석K
		//if(userAuth != "ZPS12" && userAuth != "ZPS36"){
		if(userAuth != "ZPS12" && userAuth != "ZPS36" && userAuth != "ZPS08"){
			//승인, 반려 버튼 활성화
			btn_approval.Enable = true;
			btn_reject.Enable = true;
		}
		
		btn_print.Enable = true;
		
		ds_cond.SetColumn(0, "PROCESS", "1");
		Static13.Text = "1번: 업체지정";
		Static15.Text = " → 2번: 작업요청 → 3번: 일정확인 → 4번: 작업시작 → 5번: 작업완료 → 6번: 비용처리";
		
		//검색기간 종류 콤보
		ds_period.UnFilter();
		
		Static11.Visible = true;//결재상태 콤보
		cb_state.Visible = true;
		Static1.Visible = true;//결재대기 콤보 숨김처리 추가 - 2019.09.17 강민석K
		cb_appState.Visible = true;
		
		//계약 테이블이 ZPSTW1404 에서 ZPSTW1401로 변경되어 구분 콤보박스 숨김 처리 - 2019.07.31 강민석K
		//Static8.Visible = true;//구분 콤보
		//cb_confirm_gubun.Visible = true;
		
		//그리드에서 비용관련 컬럼 표시
		grd_list.SetColProp(21, "Width", 73);
		grd_list.SetColProp(22, "Width", 37);
		grd_list.SetColProp(23, "Width", 110);//지사결재 3단계 분리로 컬럼폭 수정(80->110) - 2019.09.17 강민석K
		grd_list.SetColProp(24, "Width", 73);
		
	}else{//구매외주인 경우
		//승인, 반려 버튼 비활성화
		btn_approval.Enable = false;
		btn_reject.Enable = false;
		btn_print.Enable = false;//출력기능을 사용하려면 구매용 완료확인서 조회 쿼리가 필요함.
		
		ds_cond.SetColumn(0, "PROCESS", "3");
		Static13.Text = "1번: 작업인지";
		Static15.Text = " → 2번: 작업요청 → 3번: 일정확인 → 4번: 작업시작 → 5번: 작업완료";
		
		//검색기간 종류 콤보 - 비용관련 기간 종류 제거
		ds_period.Filter("CODE != 'F' && CODE != 'G'");
		
		Static11.Visible = false;//결재상태 콤보
		cb_state.Visible = false;
		Static8.Visible = false;//구분 콤보
		cb_confirm_gubun.Visible = false;
		Static1.Visible = false;//결재대기 콤보 숨김처리 추가 - 2019.09.17 강민석K
		cb_appState.Visible = false;
		
		//그리드에서 비용관련 컬럼 숨김
		grd_list.SetColProp(21, "Width", 0);
		grd_list.SetColProp(22, "Width", 0);
		grd_list.SetColProp(23, "Width", 0);
		grd_list.SetColProp(24, "Width", 0);
	}
	
	Static14.Text = strText;
	
	tit_clearActionInfo();
	tit_addSearchActionInfo("ps15:PS1505001A_S2");//진행상태 콤보 조회
	tit_callService(
		  ""
		, ""
		, "ds_cond=ds_cond"
		, "ds_process=ds_process"
		, ""
		, "fn_afterRadioChange"
		, true
		, true);
}
/********************************************************************************
* 기      능   : 설치외주/구매외주 라디오버튼 선택 Callback
********************************************************************************/
function fn_afterRadioChange(errCode, errMsg) {
	gfn_insertEmptyRow(ds_process, G_CODE_ALL);
	cb_process.Index = 0;
	
	ds_list.ClearData();
	//fn_query();//재조회는 요청이 있을 경우 주석 해제
}
/********************************************************************************
* 기      능   : 그리드 셀 더블클릭 시 진행상태 팝업화면 표시
********************************************************************************/
function grd_list_OnCellDblClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
	F_CURRENT_CLICKED_ROW_INDEX = nRow;
	F_CURRENT_CLICKED_COL_INDEX = nCell;
	
	//취소된 건은 팝업 화면 표시를 전부 막는다. - 2019.07.29 강민석K
	//계약 테이블이 ZPSTW1404 에서 ZPSTW1401로 변경되어 계약취소된 건에 대한 체크로직 삭제 - 2019.07.31 강민석K
	/*
	if(nCell == 17 || nCell == 18 || nCell == 19 || nCell == 20 || nCell == 23 || nCell == 24 || nCell == 25 || nCell == 26){
		if(ds_list.GetColumn(nRow, "CONTRCT") == "91"){
			gfn_openMsgWin("계약이 취소된 호기입니다.", "W", "", "");
			return;
		}
	}
	*/
	
	grd_list.Format = "Mbefore";//기존 팝업화면(호기정보, 설치협력사)에서 grd_list의 Format에 따라 동작하기 때문에 추가
	
	if(nCell == 4){//호기
		gfn_openPopup("PS0204008B", true);
		
	}else if(nCell == 8){//설치협력사
		gfn_openPopup("PS0204008L", true);
		
	}else if(nCell == 17){//작업요청
		gfn_openPopup("PS1505001B", true);
		
	}else if(nCell == 18){//일정확정
		//구매외주는 작업요청일이 입력되지 않은 상태에서 작업예정일을 입력할 수 없다. - 2019.07.18 강민석K
		var reqDate = ds_list.GetColumn(nRow, "REQ_DATE");
		
		if(rd_ra.Value == "B" && (reqDate == null || reqDate == "")){
			gfn_openMsgWin("구매외주 작업은 작업요청일을 먼저 입력해야 합니다.", "E", "", "");
			return;
		}
		
		gfn_openPopup("PS1505001F", true);
		
	}else if(nCell == 19){//작업시작
		var expDate = ds_list.GetColumn(nRow, "EXP_DATE");
		
		if(expDate == null || expDate == ""){
			gfn_openMsgWin("작업예정일을 먼저 입력하세요.", "E", "", "");
			return;
		}
		
		gfn_openPopup("PS1505001G", true);
		
	}else if(nCell == 20){//작업완료
		var startDate = ds_list.GetColumn(nRow, "START_DATE");
		
		if(startDate == null || startDate == ""){
			gfn_openMsgWin("작업시작일을 먼저 입력하세요.", "E", "", "");
			return;
		}
		
		gfn_openPopup("PS1505001I", true);
	
	}else if(nCell == 23){//결재상태
		/*
		var state_code = ds_list.GetColumn(nRow, "STATE_CODE");
		if(state_code == "Z"){
			var arg  = "CRNAM=" + quote(ds_list.GetColumn(nRow, "RTN_CRNAM"));//입력자명
				arg += " BELONG=" + quote(ds_list.GetColumn(nRow, "RTN_BELONG"));//소속
				arg += " CONTENTS=" + quote(ds_list.GetColumn(nRow, "RTN_CONTENTS_ORIG"));//반려사유
			gfn_openPopup("PS1505001L", true, arg);
		}
		*/
		var sDocuNo    = ds_list.GetColumn(nRow, "DOCU_NO");
		var sStateCode = ds_list.GetColumn(nRow, "STATE_CODE");
		var sPspid     = ds_list.GetColumn(nRow, "PSPID");
		var sPosid     = ds_list.GetColumn(nRow, "POSID");
		var sGbn       = ds_list.GetColumn(nRow, "JOB_CODE");
		var sJobName   = ds_list.GetColumn(nRow, "JOB_NAME");
		var sZsiteNm   = ds_list.GetColumn(nRow, "ZSITE_NM");
		var sCurrApp   = ds_list.GetColumn(nRow, "CURR_APP_STATE");
		var sLifnrOut  = ds_list.GetColumn(nRow, "LIFNR_OUT");
		
	
		var arg = "F_DOCU_NO="+quote(sDocuNo);
		    arg+= " GBN_CODE='A'";
		    arg+= " G_PSPID="+quote(sPspid);
		    arg+= " G_POSID="+quote(sPosid);
		    arg+= " G_GBN="+quote(sGbn);
		    arg+= " G_JOB_NAME="+quote(sJobName);
			arg+= " G_ZSITE_NM="+quote(sZsiteNm);
			arg+= " G_CURR_APP_STATE="+quote(sCurrApp);
			arg+= " G_LIFNR_OUT="+quote(sLifnrOut);
			
		// ## 업체신청 상태이거나 반려 상태일 경우에는 신청화면
		if(sStateCode == '')
		{
			gfn_OpenMsgWin("결재상태가 [업체신청]이후인 경우에\n조회가능합니다.");
		}
		else if(sStateCode == 'D')	//업체신청일 경우 - 신청화면
		{
			var rtn = gfn_openPopup("PS9603001A", true, arg);
			
			//if(rtn <> '')	// 기안시 
			//{
			//	ds_list.SetColumn(ds_list.currow, 'STATE_CODE', 'E');
			//	ds_list.SetColumn(ds_list.currow, 'STATE', '지사결재(PM)');
			//	ds_list.SetColumn(ds_list.currow, 'DOCU_NO', rtn);
			//}
			
		}
		else if(sStateCode == 'Z' && sCurrApp == null)	// 반려 - 반려화면
		{
			var arg  = "CRNAM=" + quote(ds_list.GetColumn(nRow, "RTN_CRNAM"));//입력자명
				arg += " BELONG=" + quote(ds_list.GetColumn(nRow, "RTN_BELONG"));//소속
				arg += " CONTENTS=" + quote(ds_list.GetColumn(nRow, "RTN_CONTENTS_ORIG"));//반려사유
				arg += " G_MENU=" + quote("B");
			gfn_openPopup("PS1505001L", true, arg);
		}
		// ## 그 외의 상태일 경우에는 결재 화면
		else	 
		{
			var rtn = gfn_openPopup("PS9603002A", true, arg);
			
			//Trace("rtn = " +rtn);
			/*
			if(rtn == 'A2')
			{
				ds_list.SetColumn(ds_list.currow, 'STATE_CODE', 'F');
				ds_list.SetColumn(ds_list.currow, 'STATE', '지사결재(지사장)');
			}
			else if(rtn == 'A3')
			{
				ds_list.SetColumn(ds_list.currow, 'STATE_CODE', 'K');
				ds_list.SetColumn(ds_list.currow, 'STATE', '지사결재(팀장)');
			}
			else if(rtn == 'END')
			{
				ds_list.SetColumn(ds_list.currow, 'STATE_CODE', 'G');
				ds_list.SetColumn(ds_list.currow, 'STATE', '지사결재(팀장)');
			}
			*/
		}

	
	}else if(nCell == 24){//비용처리
		gfn_openPopup("PS1505001J", true);
		
	}else if(nCell == 25){//메모
		var contents = ds_list.GetColumn(nRow, "CONTENTS_ORIG");
		
		if(length(trim(contents)) > 0){
			var arg  = "CRNAM=" + quote(ds_list.GetColumn(nRow, "MEMO_CRNAM"));//입력자명
				arg += " BELONG=" + quote(ds_list.GetColumn(nRow, "MEMO_BELONG"));//소속
				arg += " CONTENTS=" + quote(contents);//내용
				arg += " ALM_INDC=" + quote(ds_list.GetColumn(nRow, "MEMO_ALM_INDC"));//알림대상
				arg += " PSPID=" + quote(ds_list.getColumn(0, "PSPID"));//프로젝트 번호
				arg += " POSID=" + quote(ds_list.getColumn(0, "POSID"));//호기 번호
				arg += " LIFNR=" + quote(ds_list.GetColumn(0, "LIFNR_OUT"));//업체코드
				arg += " SEQ=" + quote(ds_list.GetColumn(nRow, "SEQ"));//SEQ
			gfn_openPopup("PS1505001C", true, arg);
		}
	}else if(nCell == 26){//사진 미리보기
		gfn_openPopup("PS1505001K", true);
	}
}

/********************************************************************************
* 기      능   : 결재
********************************************************************************/
function fn_decide() {
	
	
	
}

/********************************************************************************
* 기      능   : 1차 결재 - 결재선 즐겨찾기 조회
********************************************************************************/
function ufn_apprReq_First()
{
	// 1차 결재시, 즐겨찾기에 저장된 결재선 라인 Select (결재선은 무조건 1줄만 추가가능하도록 수정 2019-08-30 고범석GJN 요청)
	tit_clearActionInfo();	
	tit_addSearchActionInfo("ps15:PS1505001A_S15");
	tit_callService(
        ""
        , ""
        , "ds_cond=ds_cond"
        , "ds_gyul=ds_gyul"
        , ""
        , "ufn_afterSelLine"
        , true);

}

/********************************************************************************
* 기      능   : 1차 결재 처리
********************************************************************************/
function ufn_afterSelLine(errCode, errMsg)
{
	if(ds_gyul.GetRowCount() == 0)
	{
		var nRow = ds_list.SearchRow("CHECK_CHARGE == '1'");
		
		if(nRow >= 0)
		{
			var sDocuNo    = ds_list.GetColumn(nRow, "DOCU_NO");
			var sStateCode = ds_list.GetColumn(nRow, "STATE_CODE");
			var sPspid     = ds_list.GetColumn(nRow, "PSPID");
			var sPosid     = ds_list.GetColumn(nRow, "POSID");
			var sGbn       = ds_list.GetColumn(nRow, "JOB_CODE");
			var sJobName   = ds_list.GetColumn(nRow, "JOB_NAME");
			var sZsiteNm   = ds_list.GetColumn(nRow, "ZSITE_NM");
			var sCurrApp   = ds_list.GetColumn(nRow, "CURR_APP_STATE");
			var sLifnrOut  = ds_list.GetColumn(nRow, "LIFNR_OUT");
			
		
			var arg = "F_DOCU_NO="+quote(sDocuNo);
				arg+= " GBN_CODE='A'";
				arg+= " G_PSPID="+quote(sPspid);
				arg+= " G_POSID="+quote(sPosid);
				arg+= " G_GBN="+quote(sGbn);
				arg+= " G_JOB_NAME="+quote(sJobName);
				arg+= " G_ZSITE_NM="+quote(sZsiteNm);
				arg+= " G_CURR_APP_STATE="+quote(sCurrApp);
				arg+= " G_LIFNR_OUT="+quote(sLifnrOut);
			
			gfn_openMsgWin("'결재라인'을 등록하여야\n일괄 승인 버튼을 사용할 수 있습니다.");
			gfn_openPopup("PS9603001A", true, arg);
			
				
			return;
		}
		
		
	}
	
	//담당 PM이 본인과 다른 경우 경고
	if(G_USER_ID != ds_gyul.GetColumn(0, "GID1"))
	{
		if(!gfn_openMsgWin("현재 로그인한 사용자가\n지정한 담당 PM과 다릅니다.\n그래도 진행하시겠습니까?\n[결재선은 가장 최근 즐겨찾기로 생성]", "W", "C", "")) return;
	}
	else
	{
		if(!gfn_openMsgWin("1차 결재를 진행 하시겠습니까?\n[결재선은 가장 최근 즐겨찾기로 생성]", "I", "C", "")) return;
	}

	
	var sNewDocuNo = "";
	var nAddRow = 0;
	var _headRow = 0;
	var _detailRow = 0;
	var sRtn  = "";
	var newDate = "";
	var dateTime = "";
	
	ds_head.clearData();
	ds_detail.clearData();
	ds_tmp.ClearData();
	
	for(var i=0;i<ds_list.GetRowCount();i++)
	{
		if(ds_list.GetColumn(i, "CHECK_CHARGE") == '1')
		{
			//SetTimer(1,1000*(i+1));
			newDate = lf_getTimeM(getDate()); // 20080125 140000	
			dateTime = lf_getDateTime(newDate,1000*(1+i)); // 60*5 는 5분 추가

			sNewDocuNo = 'A'+dateTime;
			_NewDocuNo = sNewDocuNo;

			
			
			
			
			nAddRow = ds_head.addRow();
			_headRow = nAddRow;
			// ZPSTEA01M (MASTER)
			ds_head.SetColumn(nAddRow, "DOCU_NO"		, sNewDocuNo);
			ds_head.SetColumn(nAddRow, "APP_STATE"		, "Z0"); 
			ds_head.SetColumn(nAddRow, "APP_REQ_ID"		, ds_gyul.GetColumn(0, "GID1"));
			ds_head.SetColumn(nAddRow, "APP_REQ_NM"		, ds_gyul.GetColumn(0, "GNM1"));
			ds_head.SetColumn(nAddRow, "APP_CNFM_ID"		, "");
			ds_head.SetColumn(nAddRow, "APP_CNFM_NM"		, "");
			ds_head.SetColumn(nAddRow, "APP_CNFM_DT"		, "");
			ds_head.SetColumn(nAddRow, "REJT_DT"			, "");
			ds_head.SetColumn(nAddRow, "REJT_MEMO"		, "");
			ds_head.SetColumn(nAddRow, "PRE_DOCU_NO"		, ds_list.GetColumn(i,"DOCU_NO"));
			
			
			// ZPSTEA01D (DETAIL)
			nAddRow = ds_detail.addRow();
			_detailRow = nAddRow;
			ds_detail.SetColumn(nAddRow, "DOCU_NO"		, sNewDocuNo);
			ds_detail.SetColumn(nAddRow, "APP_STATE"	, "A0");
			ds_detail.SetColumn(nAddRow, "APP_CNFM_ID"	, ds_gyul.GetColumn(0, "GID1"));
			ds_detail.SetColumn(nAddRow, "APP_CNFM_NM"	, ds_gyul.GetColumn(0, "GNM1"));
			ds_detail.SetColumn(nAddRow, "APP_CNFM_DT"	, "");
			ds_detail.SetColumn(nAddRow, "REJT_DT"		, ""); 
			ds_detail.SetColumn(nAddRow, "REJT_MEMO"	, "");
			ds_detail.SetColumn(nAddRow, "APP_MEMO"		, "");
			
			nAddRow = ds_detail.addRow();
			ds_detail.SetColumn(nAddRow, "DOCU_NO"		, sNewDocuNo);
			ds_detail.SetColumn(nAddRow, "APP_STATE"	, "A1");
			ds_detail.SetColumn(nAddRow, "APP_CNFM_ID"	, ds_gyul.GetColumn(0, "GID2"));
			ds_detail.SetColumn(nAddRow, "APP_CNFM_NM"	, ds_gyul.GetColumn(0, "GNM2"));
			ds_detail.SetColumn(nAddRow, "APP_CNFM_DT"	, "");
			ds_detail.SetColumn(nAddRow, "REJT_DT"		, ""); 
			ds_detail.SetColumn(nAddRow, "REJT_MEMO"	, "");
			ds_detail.SetColumn(nAddRow, "APP_MEMO"		, "");
			
			nAddRow = ds_detail.addRow();
			ds_detail.SetColumn(nAddRow, "DOCU_NO"		, sNewDocuNo);
			ds_detail.SetColumn(nAddRow, "APP_STATE"	, "A2");
			ds_detail.SetColumn(nAddRow, "APP_CNFM_ID"	, ds_gyul.GetColumn(0, "GID3"));
			ds_detail.SetColumn(nAddRow, "APP_CNFM_NM"	, ds_gyul.GetColumn(0, "GNM3"));
			ds_detail.SetColumn(nAddRow, "APP_CNFM_DT"	, "");
			ds_detail.SetColumn(nAddRow, "REJT_DT"		, ""); 
			ds_detail.SetColumn(nAddRow, "REJT_MEMO"	, "");
			ds_detail.SetColumn(nAddRow, "APP_MEMO"		, "");
			
			// ES-CRT 감시반의 경우, 4차 결재자(QC팀장) 추가 
			if(ds_list.GetColumn(i, "JOB_CODE") == 'X')
			{
				nAddRow = ds_detail.addRow();
				ds_detail.SetColumn(nAddRow, "DOCU_NO"		, sNewDocuNo);
				ds_detail.SetColumn(nAddRow, "APP_STATE"	, "A3");
				ds_detail.SetColumn(nAddRow, "APP_CNFM_ID"	, "3013545");
				ds_detail.SetColumn(nAddRow, "APP_CNFM_NM"	, "김상훈");
				ds_detail.SetColumn(nAddRow, "APP_CNFM_DT"	, "");
				ds_detail.SetColumn(nAddRow, "REJT_DT"		, ""); 
				ds_detail.SetColumn(nAddRow, "REJT_MEMO"	, "");
				ds_detail.SetColumn(nAddRow, "APP_MEMO"		, "");
			}
		
			// PM 자동결재 처리
			ds_head.SetColumn(_headRow, "APP_STATE"	, "A0"); 
			ds_head.SetColumn(_headRow, "APP_CNFM_ID"	, ds_gyul.GetColumn(0, "GID1"));
			ds_head.SetColumn(_headRow, "APP_CNFM_NM"	, ds_gyul.GetColumn(0, "GNM1"));
			ds_head.SetColumn(_headRow, "APP_CNFM_DT"	, gfn_getCurrDate());
		
			ds_detail.SetColumn(_detailRow, "APP_CNFM_ID", ds_gyul.GetColumn(0, "GID1"));
			ds_detail.SetColumn(_detailRow, "APP_CNFM_NM", ds_gyul.GetColumn(0, "GNM1"));
			ds_detail.SetColumn(_detailRow, "APP_CNFM_DT", gfn_getCurrDate());
		
			// ZPSTW1401 UPDATE를 위한 처리
			nAddRow = ds_tmp.AddRow();
			ds_tmp.SetColumn(nAddRow, "PSPID", ds_list.GetColumn(i, "PSPID"));
			ds_tmp.SetColumn(nAddRow, "POSID", ds_list.GetColumn(i, "POSID"));
			ds_tmp.SetColumn(nAddRow, "GBN", ds_list.GetColumn(i, "JOB_CODE"));
			ds_tmp.SetColumn(nAddRow, "APP_CNFM_ID", ds_gyul.GetColumn(0, "GID1"));
			ds_tmp.SetColumn(nAddRow, "DOCU_NO", sNewDocuNo);

			
		}
		
	}
	
	
	//Trace(ds_head.saveXML());
	//Trace(ds_detail.saveXML());
	//Trace(ds_tmp.saveXML());
	//return;
	tit_clearActionInfo();
	tit_addMultiActionInfo("ps96:PS9603001A_I1");
	tit_addMultiActionInfo("ps96:PS9603001A_I2");
	tit_addMultiActionInfo("ps96:PS9603001A_U1");
	tit_callService(
			""
			, ""
			, "ds_head=ds_head ds_detail=ds_detail ds_tmp=ds_tmp"
			, ""
			, ""
			, "fn_afterSaveAppr1"
			, ""
			, ""
			, true);	
}

/********************************************************************************
* 기      능   : 결재1 Callback  
********************************************************************************/
function fn_afterSaveAppr1(errCode, errMsg) {
	if ( errCode != 0 ) {
		gfn_showMsg("CE00001");
	} else {
		//gfn_showAlert("CI00003");
		
		gfn_openMsgWin("결재되었습니다.");
		
		//Trace("여기1");
		fn_afterSaveAppr1_1();	// 2차 결재자 메일 발송
	}
}

/********************************************************************************
* 기      능   : 신청 후 2차 결재자에게 메일 발송
********************************************************************************/
function fn_afterSaveAppr1_1()
{
	//보내는 사람(1차)과 받는 사람(2차)을 Detail정보에서 둘다 가지고 있음.
	var send_user = "helco" + ds_gyul.GetColumn(0, "GID1") + "@hdel.co.kr";//보내는사람
	var rece_user = "helco" + ds_gyul.GetColumn(0, "GID2") + "@hdel.co.kr"; //받는사람
	var send_user_nm = ds_gyul.GetColumn(0, "GNM1"); //발신자 이름
	var rece_user_nm = ds_gyul.GetColumn(0, "GNM2"); //수신자 이름
		
	var mesgtitl  = ""; //제목
	var mesgbody  = ""; //내용
	
	var pop_meg = "";
	
	//Trace("여기2");
	//http.TimeOut = 900;
	//Trace(ds_list.saveXML());
	for(var i=0; i<ds_list.GetRowCount();i++)
	{
		if(ds_list.GetColumn(i, "CHECK_CHARGE") == '1')
		{
			mesgtitl += '기타외주작업 결재요청 (' + ds_list.GetColumn(i, "POSID") +' - ' + substr(ds_list.GetColumn(i, "ZSITE_NM"),0,7) + ")";
	
			mesgbody = ds_gyul.GetColumn(0, "DPTNM1") + ' ' + send_user_nm +' 님이 SRM을 통해 발송한 메일입니다. ' + '\n\n'; 
			
			mesgbody =  mesgbody +'프로젝트번호: ' + ds_list.GetColumn(i, "POSID") + '\n';
			mesgbody = mesgbody + '프로젝트명: ' + ds_list.GetColumn(i, "ZSITE_NM") + '\n\n';
			
			mesgbody = mesgbody + '외주작업구분: '  + ds_list.GetColumn(i, "JOB_NAME") + '를(을) 결재 바랍니다.\n';
			mesgbody = mesgbody + '(결재 화면: SRM-발주기성-기타외주작업 작업지시서(관리자) 결재화면)\n\n';
			mesgbody = mesgbody + '감사합니다.\n';
			//------------------------------------------------------------------------------
			var cc_user = "";
			var cc_user_nm = "";
			
			//send_user = "helco2029847@hdel.co.kr";
			//send_user_nm = "송광용";
			
			//rece_user = "helco2029847@hdel.co.kr";
			//rece_user_nm = "송광용";
			
			//Trace(send_user);
			//Trace(rece_user);
			//Trace(send_user_nm);
			//Trace(rece_user_nm);
			//Trace(mesgtitl);
			//Trace(mesgbody);
		
		
			if(rece_user != "")
			{
		
				tit_callService(
					"COMM_ACT"
					, "sendmailNew"
					, ""
					, ""
					," SEND_USER=" + quote( send_user )
						+ " RECV_USER=" + quote( rece_user )
						+ " CC_USER=" + quote(cc_user)
						+ " SEND_USER_NM=" + quote( send_user_nm )
						+ " RECV_USER_NM=" + quote( rece_user_nm )
						+ " CC_USER_NM=" + quote(cc_user_nm)
						+ " MESGTITL="  + quote( mesgtitl )
						+ " MESGBODY="  + quote( mesgbody )
					, ""
					, false
					, true);
		
				/*tit_callService(
					"COMM_ACT"
					, "sendmail"
					, ""
					, ""
					," SEND_USER=" + quote( send_user )
						+ " RECE_USER=" + quote( rece_user )
						+ " MESGTITL="  + quote( mesgtitl )
						+ " MESGBODY="  + quote( mesgbody )
					, ""
					, false
					, true);*/
			 
				pop_meg = '메일이 발송 되었습니다.';	
			}
		}
	}
	
	fn_query();
	
}



/********************************************************************************
* 기      능   : 2차,3차 결재
********************************************************************************/
function ufn_apprReq_Etc()
{
	if(!gfn_openMsgWin("결재 하시겠습니까?", "I", "C", "")) return;
	
	ds_cond2.ClearData();
	var sNextState = "";
	var sCurrState = "";
	var nAddRow = 0;
	
	
	if(cb_appState.Value == 'B')	// 2차결재 진행
	{
		sNextState = 'A1';
	}
	else if(cb_appState.Value == 'C')	// 3차결재 진행
	{
		sNextState = 'A2';
	}
	else if(cb_appState.Value == 'D')	// 4차결재 진행
	{
		sNextState = 'A3';
	}
	
	for(var i=0;i<ds_list.GetRowCount();i++)
	{
		if(ds_list.GetColumn(i, "CHECK_CHARGE") == '1')
		{
			nAddRow = ds_cond2.AddRow();
			ds_cond2.SetColumn(nAddRow, "DOCU_NO", ds_list.GetColumn(i, "DOCU_NO"));	//문서번호
			ds_cond2.SetColumn(nAddRow, "PSPID", ds_list.GetColumn(i, "PSPID"));	//프로젝트번호
			ds_cond2.SetColumn(nAddRow, "POSID", ds_list.GetColumn(i, "POSID"));	//호기번호
			ds_cond2.SetColumn(nAddRow, "GBN", ds_list.GetColumn(i, "JOB_CODE"));		//작업구분
			ds_cond2.SetColumn(nAddRow, "ZSITE_NM", ds_list.GetColumn(i, "ZSITE_NM"));		//호기명
			ds_cond2.SetColumn(nAddRow, "JOB_NAME", ds_list.GetColumn(i, "JOB_NAME"));		//작업구분 명
			ds_cond2.SetColumn(nAddRow, "DPTNM3", ds_list.GetColumn(i, "DPTNM3"));		// 3차결재자 부서
			
			if(sNextState == 'A1')	// 다음 : 2차결재
			{
				sCurrState = 'A0';	
				ds_cond2.SetColumn(nAddRow, "REQ_BN_MG", G_USER_ID);		// 지사장 승인자
				ds_cond2.SetColumn(nAddRow, "REQ_BN_MG_DT", gfn_getCurrDate());			// 지사장 승인일
				ds_cond2.SetColumn(nAddRow, "REQ_BN_TM", '');		// 팀장 승인자
				ds_cond2.SetColumn(nAddRow, "REQ_BN_TM_DT", '');	// 팀장 승인일
				ds_cond2.SetColumn(nAddRow, "REQ_BN_QC", '');		// QC팀장 승인자
				ds_cond2.SetColumn(nAddRow, "REQ_BN_QC_DT", '');	// QC팀장 승인일
				
				ds_cond2.SetColumn(nAddRow, "STATE", "F");	// ZPSTW1401 상태값
			}
			else if(sNextState == 'A2')	
			{
				sCurrState = 'A1';	// 다음 : 3차결재
				ds_cond2.SetColumn(nAddRow, "REQ_BN_MG", '');		// 지사장 승인자
				ds_cond2.SetColumn(nAddRow, "REQ_BN_MG_DT", '');			// 지사장 승인일
				ds_cond2.SetColumn(nAddRow, "REQ_BN_TM", G_USER_ID);		// 팀장 승인자
				ds_cond2.SetColumn(nAddRow, "REQ_BN_TM_DT", gfn_getCurrDate());	// 팀장 승인일
				ds_cond2.SetColumn(nAddRow, "REQ_BN_QC", '');		// QC팀장 승인자
				ds_cond2.SetColumn(nAddRow, "REQ_BN_QC_DT", '');	// QC팀장 승인일
				
				if(ds_list.GetColumn(i, "JOB_CODE") == 'X') // ES-CRT일 경우
				{
					ds_cond2.SetColumn(nAddRow, "STATE", "K");	// ZPSTW1401 상태값
				}
				else
				{
					ds_cond2.SetColumn(nAddRow, "STATE", "G");	// ZPSTW1401 상태값
				}
				
			}
			else if(sNextState == 'A3')	
			{
				sCurrState = 'A2';	// 다음 : 3차결재
				ds_cond2.SetColumn(nAddRow, "REQ_BN_MG", '');		// 지사장 승인자
				ds_cond2.SetColumn(nAddRow, "REQ_BN_MG_DT", '');			// 지사장 승인일
				ds_cond2.SetColumn(nAddRow, "REQ_BN_TM", '');		// 팀장 승인자
				ds_cond2.SetColumn(nAddRow, "REQ_BN_TM_DT", '');	// 팀장 승인일
				ds_cond2.SetColumn(nAddRow, "REQ_BN_QC", G_USER_ID);		// 팀장 승인자
				ds_cond2.SetColumn(nAddRow, "REQ_BN_QC_DT", gfn_getCurrDate());	// 팀장 승인일
				
				
				ds_cond2.SetColumn(nAddRow, "STATE", "G");	// ZPSTW1401 상태값
			}
		
			ds_cond2.SetColumn(nAddRow, "NEXT_STATE", sNextState);			//다음결재상태
			ds_cond2.SetColumn(nAddRow, "CURR_STATE", sCurrState);			//현재결재상태
			ds_cond2.SetColumn(nAddRow, "REJT_DT", '');			//반려일자
			ds_cond2.SetColumn(nAddRow, "REJT_MEMO", '');			//반려메일
			ds_cond2.SetColumn(nAddRow, "APP_CNFM_ID2", ds_list.GetColumn(i, "APP_CNFM_ID2"));
			ds_cond2.SetColumn(nAddRow, "APP_CNFM_NM2", ds_list.GetColumn(i, "APP_CNFM_NM2"));
			
			ds_cond2.SetColumn(nAddRow, "APP_CNFM_ID3", ds_list.GetColumn(i, "APP_CNFM_ID3"));
			ds_cond2.SetColumn(nAddRow, "APP_CNFM_NM3", ds_list.GetColumn(i, "APP_CNFM_NM3"));
		}
		
	}
	
	//Trace(ds_cond2.saveXML());
	//return;
	
	tit_clearActionInfo();
	tit_addMultiActionInfo("ps96:PS9603002A_U1");	// ZPSTEA01M UPDATE
	tit_addMultiActionInfo("ps96:PS9603002A_U2");	// ZPSTEA01D UPDATE
		
		
	if(sCurrState == 'A0')
	{
		tit_addMultiActionInfo("ps96:PS9603002A_U3");	// ZPSTW1401 UPDATE - 2차결재
	}
	else if(sCurrState == 'A1')
	{
		tit_addMultiActionInfo("ps96:PS9603002A_U8");	// ZPSTW1401 UPDATE - 3차결재
	}
	else // A2의 경우
	{
		tit_addMultiActionInfo("ps96:PS9603002A_U9");	// ZPSTW1401 UPDATE - 3차결재
	}
	
	tit_callService(
				""
				, ""
				, "ds_cond2=ds_cond2"
				, ""
				, ""
				, "fn_afterSaveAppr2_1"
				, ""
				, ""
				, true);
	
}

/********************************************************************************
* 기      능   : 결재1 Callback  
********************************************************************************/
function fn_afterSaveAppr2_1(errCode, errMsg) {
	if ( errCode != 0 ) {
		gfn_showMsg("CE00001");
	} else {
		//gfn_showAlert("CI00003");
		
		gfn_openMsgWin("결재되었습니다.");
		
		fn_afterSaveAppr2_2();	// 2차 결재자 메일 발송
	}
}

/********************************************************************************
* 기      능   : 신청 후 3차 결재자에게 메일 발송
********************************************************************************/
function fn_afterSaveAppr2_2()
{
	ds_cond3.ClearData();
	ds_cond2.Filter("NEXT_STATE=='A1'");
	ds_cond3.CopyF(ds_cond2);
	ds_cond2.UnFilter();
	
	ds_cond4.ClearData();
	ds_cond2.Filter("NEXT_STATE=='A2' OR (NEXT_STATE=='A3' AND GBN == 'X')");
	ds_cond4.CopyF(ds_cond2);
	ds_cond2.UnFilter();
	
	//Trace(ds_cond4.saveXML());
	//보내는 사람(1차)과 받는 사람(2차)을 Detail정보에서 둘다 가지고 있음.
	var send_user = "";
	var rece_user = "";
	var send_user_nm ="";
	var rece_user_nm = "";

	var mesgtitl  = ""; //제목
	var mesgbody  = ""; //내용
	
	var pop_meg = "";
	
	//http.TimeOut = 900;
	
	for(var i=0; i<ds_cond3.GetRowCount();i++)
	{
		send_user = "helco" + G_USER_ID + "@hdel.co.kr";//보내는사람
		rece_user = "helco" + ds_cond3.GetColumn(0, "APP_CNFM_ID2") + "@hdel.co.kr"; //받는사람
		send_user_nm = G_USER_NAME; //발신자 이름
		rece_user_nm = ds_cond3.GetColumn(0, "APP_CNFM_NM2"); //수신자 이름

		mesgtitl += '기타외주작업 결재요청 (' + ds_cond3.GetColumn(i, "POSID") +' - ' + substr(ds_cond3.GetColumn(i, "ZSITE_NM"),0,7) + ")";

		mesgbody = ds_cond3.GetColumn(0, "DPTNM3") + ' ' + send_user_nm +' 님이 SRM을 통해 발송한 메일입니다. ' + '\n\n'; 
		
		mesgbody =  mesgbody +'프로젝트번호: ' + ds_cond3.GetColumn(i, "POSID") + '\n';
		mesgbody = mesgbody + '프로젝트명: ' + ds_cond3.GetColumn(i, "ZSITE_NM") + '\n\n';
		
		mesgbody = mesgbody + '외주작업구분: '  + ds_cond3.GetColumn(i, "JOB_NAME") + '를(을) 결재 바랍니다.\n';
		mesgbody = mesgbody + '(결재 화면: SRM-발주기성-기타외주작업 작업지시서(관리자) 결재화면)\n\n';
		mesgbody = mesgbody + '감사합니다.\n';
		//------------------------------------------------------------------------------
		var cc_user = "";
		var cc_user_nm = "";
		
		//send_user = "helco2029847@hdel.co.kr";
		//send_user_nm = "송광용";
		
		//rece_user = "helco2029847@hdel.co.kr";
		//rece_user_nm = "송광용";
		
		//Trace(send_user);
		//Trace(rece_user);
		//Trace(send_user_nm);
		//Trace(rece_user_nm);
		//Trace(mesgtitl);
		//Trace(mesgbody);
		
	
		if(rece_user != "")
		{
	
			tit_callService(
				"COMM_ACT"
				, "sendmailNew"
				, ""
				, ""
				," SEND_USER=" + quote( send_user )
					+ " RECV_USER=" + quote( rece_user )
					+ " CC_USER=" + quote(cc_user)
					+ " SEND_USER_NM=" + quote( send_user_nm )
					+ " RECV_USER_NM=" + quote( rece_user_nm )
					+ " CC_USER_NM=" + quote(cc_user_nm)
					+ " MESGTITL="  + quote( mesgtitl )
					+ " MESGBODY="  + quote( mesgbody )
				, ""
				, false
				, true);
	
			/*tit_callService(
				"COMM_ACT"
				, "sendmail"
				, ""
				, ""
				," SEND_USER=" + quote( send_user )
					+ " RECE_USER=" + quote( rece_user )
					+ " MESGTITL="  + quote( mesgtitl )
					+ " MESGBODY="  + quote( mesgbody )
				, ""
				, false
				, true);*/
		 
			//pop_meg = '메일이 발송 되었습니다.';	
		}
	}
	
	for(var i=0; i<ds_cond4.GetRowCount();i++)
	{
		send_user = "helco" + G_USER_ID + "@hdel.co.kr";//보내는사람
		rece_user = "helco" + ds_cond4.GetColumn(0, "APP_CNFM_ID3") + "@hdel.co.kr"; //받는사람
		send_user_nm = G_USER_NAME; //발신자 이름
		rece_user_nm = ds_cond4.GetColumn(0, "APP_CNFM_NM3"); //수신자 이름
	
		Trace(rece_user);
		Trace(rece_user_nm);
		mesgtitl += '기타외주작업 결재요청 (' + ds_cond4.GetColumn(i, "POSID") +' - ' + substr(ds_cond4.GetColumn(i, "ZSITE_NM"),0,7) + ")";

		mesgbody = ds_cond4.GetColumn(0, "DPTNM3") + ' ' + send_user_nm +' 님이 SRM을 통해 발송한 메일입니다. ' + '\n\n'; 
		
		mesgbody =  mesgbody +'프로젝트번호: ' + ds_cond4.GetColumn(i, "POSID") + '\n';
		mesgbody = mesgbody + '프로젝트명: ' + ds_cond4.GetColumn(i, "ZSITE_NM") + '\n\n';
		
		mesgbody = mesgbody + '외주작업구분: '  + ds_cond4.GetColumn(i, "JOB_NAME") + '를(을) 결재 바랍니다.\n';
		mesgbody = mesgbody + '(결재 화면: SRM-발주기성-기타외주작업 작업지시서(관리자) 결재화면)\n\n';
		mesgbody = mesgbody + '감사합니다.\n';
		//------------------------------------------------------------------------------
		var cc_user = "";
		var cc_user_nm = "";
		
		//send_user = "helco2029847@hdel.co.kr";
		//send_user_nm = "송광용";
		
		//rece_user = "helco2029847@hdel.co.kr";
		//rece_user_nm = "송광용";
		
		//Trace(send_user);
		//Trace(rece_user);
		//Trace(send_user_nm);
		//Trace(rece_user_nm);
		//Trace(mesgtitl);
		//Trace(mesgbody);
		
	
		if(rece_user != "")
		{
	
			tit_callService(
				"COMM_ACT"
				, "sendmailNew"
				, ""
				, ""
				," SEND_USER=" + quote( send_user )
					+ " RECV_USER=" + quote( rece_user )
					+ " CC_USER=" + quote(cc_user)
					+ " SEND_USER_NM=" + quote( send_user_nm )
					+ " RECV_USER_NM=" + quote( rece_user_nm )
					+ " CC_USER_NM=" + quote(cc_user_nm)
					+ " MESGTITL="  + quote( mesgtitl )
					+ " MESGBODY="  + quote( mesgbody )
				, ""
				, false
				, true);
	
			/*tit_callService(
				"COMM_ACT"
				, "sendmail"
				, ""
				, ""
				," SEND_USER=" + quote( send_user )
					+ " RECE_USER=" + quote( rece_user )
					+ " MESGTITL="  + quote( mesgtitl )
					+ " MESGBODY="  + quote( mesgbody )
				, ""
				, false
				, true);*/
		 
				
		}
	}
	
	pop_meg = '메일이 발송 되었습니다.';
	
	fn_query();
}

/********************************************************************************
* 기      능   : 현재 시분초
********************************************************************************/
function lf_getTimeM(dt)
{
	var yy = parseInt(mid(dt,0,4));
	var mm = parseInt(mid(dt,4,2));
	var dd = parseInt(mid(dt,6,2));
	var hh = parseInt(mid(dt,8,2))-1;
	var mi = parseInt(mid(dt,10,2));
	var ss = parseInt(mid(dt,12,2));
	
	return (Tonumber(datetime(yy,mm,dd,hh,mi,ss)) - tonumber(datetime(1970,01,01,00,00,00))) * 24 * 3600 * 1000;
}

/********************************************************************************
* 기      능   : 현재 시간 + ival만큼의 초 세팅
********************************************************************************/
function lf_getDateTime(tval,ival)
{
	 var time_stamp = tval + ival;
	 time_stamp += toNumber(60*60*1000); // GMT기준으로 9시간 빠름
	 
	 time_stamp = truncate(time_stamp/1000,0);  //
	 var s_day = time_stamp/(3600*24);
	 var cur_time = time_stamp%(3600*24);
	 
	 var dayVal = adddate("19700101",s_day);
	 
	 var tot_min = cur_time/60;
	 var s_sec = cur_time%60;
	 
	 var s_min = tot_min/60;
	 var c_min = tot_min%60;
	 
	 return dayVal + lpad(Truncate(s_min,0),0,2) + lpad(c_min,0,2) + lpad(s_sec,0,2); 
}

/********************************************************************************
* 기      능   : 결재라인 변경 팝업 호출
********************************************************************************/
function btn_lineChg_OnClick(obj)
{
	var arg  = "F_LINE_CHANGE='Y'"; //결재라인 변경

	gfn_openPopup("PS9603001A", true, arg);
	
	tit_clearActionInfo();
	tit_addSearchActionInfo("ps15:PS1505001A_S15");	// 사용자 결재 즐겨찾기 가져오기
	
	tit_callService(
		  ""
		, ""
		, "ds_cond=ds_cond"
		, "ds_saveGyul=ds_gyul"
		, ""
		, "fn_afterLineChange"
		, true
		, true);
	
}

function fn_afterLineChange(errCode, errMsg) {
	//결재자 즐겨찾기 세팅
	//Trace(ds_saveGyul.saveXML());
	if(ds_saveGyul.GetRowCount() > 0)
	{
		stc_1cha.Text = ds_saveGyul.GetColumn(0, "GNM1");
		stc_2cha.Text = ds_saveGyul.GetColumn(0, "GNM2");
		stc_3cha.Text = ds_saveGyul.GetColumn(0, "GNM3");
	}
	else
	{
		stc_1Cha.Text = "미지정";
		stc_2Cha.Text = "미지정";
		stc_3Cha.Text = "미지정";
	}
}

function ds_cond_CanColumnChange(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{
	/*
	if(strColumnID == "SUP_DTF" || strColumnID == "SUP_DTT")
	{
		if(varNewValue < '20191007' && rd_ra.Value == 'A')
		{
			gfn_openMsgWin("2019.10.07일 이전일자로는\n조회하실 수 없습니다.");
			return false;
		}
	}*/

}

function cb_clsf_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	if(rd_ra.Value == 'A')	// 설치
	{
		ds_workgubun.UnFilter();
	
		if(strCode != ""){
			ds_workgubun.Filter("LRGE_CODE == '"+strCode+"' || CODE == ''");
			cb_workgubun.Index = 0;
		}
		else
		{
			cb_workgubun.Index = 0;
		}
		
		ds_condLifnr.ClearData();
		ds_condLifnr.AddRow();
		ds_condLifnr.SetColumn(0, "GBN", 'A');
		ds_condLifnr.SetColumn(0, "LRGE_CODE", strCode);
		
		
		//업체 재조회
		tit_clearActionInfo();
		tit_addSearchActionInfo("ps15:PS1505001A_S31");
		tit_callService(
			  ""
			, ""
			, "ds_cond=ds_condLifnr"
			, "ds_zzlifnr_cd=ds_zzlifnr"
			, ""
			, ""
			, ""
			, ""
			, true);
			
		/*
		//업체 Filter
		ds_zzlifnr_cd.UnFilter();
		if(strCode != ""){
			ds_zzlifnr_cd.Filter("(OVERLAP_FLAG == 1 && LRGE_CODE == " + quote(strCode) + " && GBN == " + quote(rd_ra.Value) + ") || CODE == ''");
		}else{
			ds_zzlifnr_cd.Filter("OVERLAP_FLAG == 1 && (GBN == " + quote(rd_ra.Value) + " || CODE == '')");
		}
		*/
		
		gfn_insertEmptyRow(ds_zzlifnr_cd, G_CODE_ALL);
		cb_zzlifnr.Index = 0;
		
		//Trace(ds_zzlifnr_cd.saveXML());
	}
	else	// 구매
	{
		//ds_zzlifnr_cd.Filter("OVERLAP_FLAG == 1 && (GBN == " + quote(rd_ra.Value) + " || CODE == '')");
	}
	
	
}

/********************************************************************************
* 기      능   : 선택된 리스트 초기화 처리 (작업요청 부터 다시 시작)
********************************************************************************/
function fn_reset()
{
	
	//선택된 row 없으면 처리 불가.
	if(ds_list.FindRow("CHK", 1)==-1){
		gfn_showMsg('CW00046');
		return;
	}

	var nDisRow = ds_list.SearchRow("CHK == '1' && STATE_CODE == 'C'");
	if(nDisRow >= 0)
	{
		gfn_openMsgWin("최종 승인된 작업은 초기화 할 수 없습니다.");
		return;
	}

	
	if(!confirm("선택된 호기 작업들을 모두 리셋 하시겠습니까?\n(작업요청부터 다시 진행해야합니다.)")){		//리셋 하시겟습니까?
	   return false;
	}
	
	ds_init.ClearData();
	ds_list.Filter("CHK=='1'");
	ds_init.CopyF(ds_list);
	ds_list.UnFilter();
	
	// ZPST0413 Delete
	// ZPSTW1401 Update
	// ZPST0413F Delete
	tit_clearActionInfo();
	
	tit_addMultiActionInfo("ps15:PS1505001A_D2");	// ZPST0413
	tit_addMultiActionInfo("ps15:PS1505001A_U2");	// ZPSTW1401
	tit_addMultiActionInfo("ps15:PS1505001A_U3");	// ZPST0413F
	tit_addMultiActionInfo("ps15:PS1505001A_U4");	// ZPST0414
	tit_callService(
			""
			, ""
			, "ds_init=ds_init"
			, ""
			, ""
			, "fn_afterDelInit2"
			, ""
			, ""
			, true);

	
}


function fn_afterDelInit2()
{
	fn_query();
	gfn_openMsgWin("초기화가 완료되었습니다.");
}]]></Script>
</Window>