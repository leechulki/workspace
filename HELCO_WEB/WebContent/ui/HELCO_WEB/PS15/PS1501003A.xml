<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="792" Id="PS1501003A" Left="8" OnLoadCompleted="fn_OnLoadCompleted" OnUnloadCompleted="fn_OnUnloadCompleted" PidAttrib="7" Title="현장&#32;소모품&#32;결재" Top="8" Ver="1.0" Width="616" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_cond">
				<Contents>
					<colinfo id="ORDERNO" size="256" summ="default" type="STRING"/>
					<colinfo id="USER_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
					<colinfo id="FIRSTROW" size="256" summ="default" type="STRING"/>
					<record>
						<FIRSTROW></FIRSTROW>
						<ORDERNO></ORDERNO>
						<POSID></POSID>
						<USER_ID></USER_ID>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_head">
				<Contents>
					<colinfo id="LIFNR" size="255" type="STRING"/>
					<colinfo id="NAME1" size="256" type="STRING"/>
					<colinfo id="NAMEC" size="256" type="STRING"/>
					<colinfo id="CNT" size="256" type="STRING"/>
					<colinfo id="DIRECT" size="256" type="STRING"/>
					<colinfo id="INDIRECT" size="256" type="STRING"/>
					<colinfo id="TELNO_O" size="256" type="STRING"/>
					<colinfo id="FAX_O" size="256" type="STRING"/>
					<colinfo id="ADDR" size="256" type="STRING"/>
					<record>
						<ADDR></ADDR>
						<CNT></CNT>
						<DIRECT></DIRECT>
						<FAX_O></FAX_O>
						<INDIRECT></INDIRECT>
						<LIFNR></LIFNR>
						<NAME1></NAME1>
						<NAMEC></NAMEC>
						<TELNO_O></TELNO_O>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_paymentLine">
				<Contents>
					<colinfo id="PAYMENTLINE" size="256" summ="default" type="STRING"/>
					<colinfo id="AREA_N" size="256" summ="default" type="STRING"/>
					<colinfo id="RANK" size="256" summ="default" type="STRING"/>
					<colinfo id="GNM" size="256" summ="default" type="STRING"/>
					<colinfo id="STATEYN" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNR_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="DPTNM" size="256" summ="default" type="STRING"/>
					<colinfo id="MEMO" size="256" summ="default" type="STRING"/>
					<colinfo id="GID" size="256" summ="default" type="STRING"/>
					<colinfo id="GI" size="256" summ="default" type="STRING"/>
					<colinfo id="DEFAULT_STATEYN" size="256" summ="default" type="STRING"/>
					<colinfo id="STATE" size="256" summ="default" type="STRING"/>
					<colinfo id="PAYGUBUN" size="256" summ="default" type="STRING"/>
					<colinfo id="USERMBPN" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="PERNO" size="256" summ="default" type="STRING"/>
					<colinfo id="COMP_YN" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_apply">
				<Contents>
					<colinfo id="GID" size="0" summ="default" type="STRING"/>
					<colinfo id="GNM" size="0" summ="default" type="STRING"/>
					<colinfo id="RANK" size="0" summ="default" type="STRING"/>
					<colinfo id="DPTNM" size="0" summ="default" type="STRING"/>
					<colinfo id="USERMBPN" size="256" summ="default" type="STRING"/>
					<colinfo id="AREA_N" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="PERNO" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_apply2">
				<Contents>
					<colinfo id="GID" size="0" summ="default" type="STRING"/>
					<colinfo id="GNM" size="0" summ="default" type="STRING"/>
					<colinfo id="RANK" size="0" summ="default" type="STRING"/>
					<colinfo id="DPTNM" size="0" summ="default" type="STRING"/>
					<colinfo id="USERMBPN" size="256" summ="default" type="STRING"/>
					<colinfo id="AREA_N" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="PERNO" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_prj">
				<Contents>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
					<colinfo id="ZMAN_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="ZQNTY" size="256" summ="default" type="STRING"/>
					<colinfo id="VALUE" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSITE_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="ADDR" size="256" summ="default" type="STRING"/>
					<colinfo id="TEMNO" size="256" summ="default" type="STRING"/>
					<colinfo id="NAMET" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_purchase" OnColumnChanged="ds_purchase_OnColumnChanged">
				<Contents>
					<colinfo id="NAME" size="256" summ="default" type="STRING"/>
					<colinfo id="USERTELE" size="256" summ="default" type="STRING"/>
					<colinfo id="USERMAIL" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="SUPRTCD" size="256" summ="default" type="STRING"/>
					<colinfo id="USERNUMB" size="256" summ="default" type="STRING"/>
					<colinfo id="EMPNOUSERNUMB" size="256" summ="default" type="STRING"/>
					<colinfo id="RANK" size="256" summ="default" type="STRING"/>
					<colinfo id="GNM" size="256" summ="default" type="STRING"/>
					<colinfo id="DPTNM" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<record>
						<CHK></CHK>
						<DPTNM></DPTNM>
						<EMPNOUSERNUMB></EMPNOUSERNUMB>
						<GNM></GNM>
						<LIFNR></LIFNR>
						<NAME></NAME>
						<RANK></RANK>
						<SUPRTCD></SUPRTCD>
						<USERMAIL></USERMAIL>
						<USERNUMB></USERNUMB>
						<USERTELE></USERTELE>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_subject" OnColumnChanged="ds_subject_OnColumnChanged">
				<Contents>
					<colinfo id="SJTCDGB" size="256" summ="default" type="STRING"/>
					<colinfo id="SUBJECTCDT" size="256" summ="default" type="STRING"/>
					<colinfo id="SPEC" size="256" summ="default" type="STRING"/>
					<colinfo id="NOTI" size="256" summ="default" type="STRING"/>
					<colinfo id="SUPRTCD" size="256" summ="default" type="STRING"/>
					<colinfo id="QTY" size="256" summ="default" type="STRING"/>
					<colinfo id="SUBJECTCD" size="256" summ="default" type="STRING"/>
					<colinfo id="ORDERNO" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_insertCond">
				<Contents>
					<colinfo id="PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="TITLE" size="256" summ="default" type="STRING"/>
					<colinfo id="RELIFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="EMPNO" size="256" summ="default" type="STRING"/>
					<colinfo id="SUPRTCD" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNREMPNO" size="256" summ="default" type="STRING"/>
					<colinfo id="STATE" size="256" summ="default" type="STRING"/>
					<colinfo id="APPDATE1" size="256" summ="default" type="STRING"/>
					<colinfo id="PCPNUM1" size="256" summ="default" type="STRING"/>
					<colinfo id="MEMO1" size="256" summ="default" type="STRING"/>
					<colinfo id="APPDATE2" size="256" summ="default" type="STRING"/>
					<colinfo id="PCPNUM2" size="256" summ="default" type="STRING"/>
					<colinfo id="MEMO2" size="256" summ="default" type="STRING"/>
					<colinfo id="APPDATE3" size="256" summ="default" type="STRING"/>
					<colinfo id="PCPNUM3" size="256" summ="default" type="STRING"/>
					<colinfo id="MEMO3" size="256" summ="default" type="STRING"/>
					<colinfo id="SENDDATE" size="256" summ="default" type="STRING"/>
					<colinfo id="SENDER" size="256" summ="default" type="STRING"/>
					<colinfo id="MEMO4" size="256" summ="default" type="STRING"/>
					<colinfo id="RECDATE" size="256" summ="default" type="STRING"/>
					<colinfo id="RECID" size="256" summ="default" type="STRING"/>
					<colinfo id="RECPART" size="256" summ="default" type="STRING"/>
					<colinfo id="RECRANK" size="256" summ="default" type="STRING"/>
					<colinfo id="RECNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="RECTEL" size="256" summ="default" type="STRING"/>
					<colinfo id="IMPDATE" size="256" summ="default" type="STRING"/>
					<colinfo id="CRDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="CRTIM" size="256" summ="default" type="STRING"/>
					<colinfo id="CRNAM" size="256" summ="default" type="STRING"/>
					<colinfo id="CHDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="CHTIM" size="256" summ="default" type="STRING"/>
					<colinfo id="CHNAM" size="256" summ="default" type="STRING"/>
					<colinfo id="ADDR" size="256" summ="default" type="STRING"/>
					<colinfo id="ORDERNO" size="256" summ="default" type="STRING"/>
					<record>
						<ADDR></ADDR>
						<APPDATE1></APPDATE1>
						<APPDATE2></APPDATE2>
						<APPDATE3></APPDATE3>
						<CHDAT></CHDAT>
						<CHNAM></CHNAM>
						<CHTIM></CHTIM>
						<CRDAT></CRDAT>
						<CRNAM></CRNAM>
						<CRTIM></CRTIM>
						<EMPNO></EMPNO>
						<IMPDATE></IMPDATE>
						<LIFNR></LIFNR>
						<LIFNREMPNO></LIFNREMPNO>
						<MEMO1></MEMO1>
						<MEMO2></MEMO2>
						<MEMO3></MEMO3>
						<MEMO4></MEMO4>
						<ORDERNO></ORDERNO>
						<PCPNUM1></PCPNUM1>
						<PCPNUM2></PCPNUM2>
						<PCPNUM3></PCPNUM3>
						<PSPID></PSPID>
						<RECDATE></RECDATE>
						<RECID></RECID>
						<RECNAME></RECNAME>
						<RECPART></RECPART>
						<RECRANK></RECRANK>
						<RECTEL></RECTEL>
						<RELIFNR></RELIFNR>
						<SENDDATE></SENDDATE>
						<SENDER></SENDER>
						<STATE></STATE>
						<SUPRTCD></SUPRTCD>
						<TITLE></TITLE>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_stateCombo">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODENAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE>N</CODE>
						<CODENAME>미선택</CODENAME>
					</record>
					<record>
						<CODE>Y</CODE>
						<CODENAME>승인</CODENAME>
					</record>
					<record>
						<CODE>C</CODE>
						<CODENAME>반려</CODENAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list">
				<Contents>
					<colinfo id="MANDT" size="256" summ="default" type="STRING"/>
					<colinfo id="ORDERNO" size="256" summ="default" type="STRING"/>
					<colinfo id="CAREYM" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSITE_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="TITLE" size="256" summ="default" type="STRING"/>
					<colinfo id="EMPNO" size="256" summ="default" type="STRING"/>
					<colinfo id="EMPNM" size="256" summ="default" type="STRING"/>
					<colinfo id="SUPRTCD" size="256" summ="default" type="STRING"/>
					<colinfo id="SUPRTCDT" size="256" summ="default" type="STRING"/>
					<colinfo id="FIRST_SUBJECTCDT" size="256" summ="default" type="STRING"/>
					<colinfo id="ENTER" size="256" summ="default" type="STRING"/>
					<colinfo id="CNT" size="256" summ="default" type="INT"/>
					<colinfo id="LIFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNR_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNREMPNO" size="256" summ="default" type="STRING"/>
					<colinfo id="STATE" size="256" summ="default" type="STRING"/>
					<colinfo id="APPDATE1" size="256" summ="default" type="STRING"/>
					<colinfo id="PCPNUM1" size="256" summ="default" type="STRING"/>
					<colinfo id="MEMO1" size="256" summ="default" type="STRING"/>
					<colinfo id="APPDATE2" size="256" summ="default" type="STRING"/>
					<colinfo id="PCPNUM2" size="256" summ="default" type="STRING"/>
					<colinfo id="MEMO2" size="256" summ="default" type="STRING"/>
					<colinfo id="APPDATE3" size="256" summ="default" type="STRING"/>
					<colinfo id="PCPNUM3" size="256" summ="default" type="STRING"/>
					<colinfo id="MEMO3" size="256" summ="default" type="STRING"/>
					<colinfo id="SENDDATE" size="256" summ="default" type="STRING"/>
					<colinfo id="RECDATE" size="256" summ="default" type="STRING"/>
					<colinfo id="RECID" size="256" summ="default" type="STRING"/>
					<colinfo id="CRDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="CRTIM" size="256" summ="default" type="STRING"/>
					<colinfo id="CRNAM" size="256" summ="default" type="STRING"/>
					<colinfo id="CHDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="CHTIM" size="256" summ="default" type="STRING"/>
					<colinfo id="CHNAM" size="256" summ="default" type="STRING"/>
					<colinfo id="MEMO" size="256" summ="default" type="STRING"/>
					<colinfo id="PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="SUBJECTCDT_ITEMS" size="256" summ="default" type="STRING"/>
					<colinfo id="PCPNM1" size="256" summ="default" type="STRING"/>
					<colinfo id="PCPNM2" size="256" summ="default" type="STRING"/>
					<colinfo id="PCPNM3" size="256" summ="default" type="STRING"/>
					<colinfo id="RECNM" size="256" summ="default" type="STRING"/>
					<colinfo id="RECADDR" size="256" summ="default" type="STRING"/>
					<colinfo id="IMPDATE" size="256" summ="default" type="STRING"/>
					<record>
						<APPDATE1></APPDATE1>
						<APPDATE2></APPDATE2>
						<APPDATE3></APPDATE3>
						<CAREYM></CAREYM>
						<CHDAT></CHDAT>
						<CHNAM></CHNAM>
						<CHTIM></CHTIM>
						<CNT/>
						<CRDAT></CRDAT>
						<CRNAM></CRNAM>
						<CRTIM></CRTIM>
						<EMPNM></EMPNM>
						<EMPNO></EMPNO>
						<ENTER></ENTER>
						<FIRST_SUBJECTCDT></FIRST_SUBJECTCDT>
						<IMPDATE></IMPDATE>
						<LIFNR></LIFNR>
						<LIFNR_NM></LIFNR_NM>
						<LIFNREMPNO></LIFNREMPNO>
						<MANDT></MANDT>
						<MEMO></MEMO>
						<MEMO1></MEMO1>
						<MEMO2></MEMO2>
						<MEMO3></MEMO3>
						<ORDERNO></ORDERNO>
						<PCPNM1></PCPNM1>
						<PCPNM2></PCPNM2>
						<PCPNM3></PCPNM3>
						<PCPNUM1></PCPNUM1>
						<PCPNUM2></PCPNUM2>
						<PCPNUM3></PCPNUM3>
						<PSPID></PSPID>
						<RECADDR></RECADDR>
						<RECDATE></RECDATE>
						<RECID></RECID>
						<RECNM></RECNM>
						<SENDDATE></SENDDATE>
						<STATE></STATE>
						<SUBJECTCDT_ITEMS></SUBJECTCDT_ITEMS>
						<SUPRTCD></SUPRTCD>
						<SUPRTCDT></SUPRTCDT>
						<TITLE></TITLE>
						<ZSITE_NM></ZSITE_NM>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_supported">
				<Contents>
					<colinfo id="SUPRTCD" size="256" summ="default" type="STRING"/>
					<colinfo id="SUPRTCDT" size="256" summ="default" type="STRING"/>
					<colinfo id="NOTICE" size="256" summ="default" type="STRING"/>
					<record>
						<NOTICE></NOTICE>
						<SUPRTCD></SUPRTCD>
						<SUPRTCDT></SUPRTCDT>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_gubun">
				<Contents>
					<colinfo id="CODE" size="255" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE>01</CODE>
						<CODE_NAME>표준</CODE_NAME>
					</record>
					<record>
						<CODE>02</CODE>
						<CODE_NAME>직접입력</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond2">
				<Contents>
					<colinfo id="STATE" size="256" summ="default" type="STRING"/>
					<colinfo id="MEMO1" size="256" summ="default" type="STRING"/>
					<colinfo id="MEMO2" size="256" summ="default" type="STRING"/>
					<colinfo id="MEMO3" size="256" summ="default" type="STRING"/>
					<colinfo id="APPDATE1" size="256" summ="default" type="STRING"/>
					<colinfo id="APPDATE2" size="256" summ="default" type="STRING"/>
					<colinfo id="APPDATE3" size="256" summ="default" type="STRING"/>
					<colinfo id="PCPNUM3" size="256" summ="default" type="STRING"/>
					<colinfo id="ORDERNO" size="256" summ="default" type="STRING"/>
					<colinfo id="STATE1" size="256" summ="default" type="STRING"/>
					<colinfo id="STATE2" size="256" summ="default" type="STRING"/>
					<colinfo id="STATE3" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list2">
				<Contents>
					<colinfo id="MANDT" size="256" summ="default" type="STRING"/>
					<colinfo id="ORDERNO" size="256" summ="default" type="STRING"/>
					<colinfo id="CAREYM" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSITE_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="TITLE" size="256" summ="default" type="STRING"/>
					<colinfo id="EMPNO" size="256" summ="default" type="STRING"/>
					<colinfo id="EMPNM" size="256" summ="default" type="STRING"/>
					<colinfo id="SUPRTCD" size="256" summ="default" type="STRING"/>
					<colinfo id="SUPRTCDT" size="256" summ="default" type="STRING"/>
					<colinfo id="FIRST_SUBJECTCDT" size="256" summ="default" type="STRING"/>
					<colinfo id="ENTER" size="256" summ="default" type="STRING"/>
					<colinfo id="CNT" size="256" summ="default" type="INT"/>
					<colinfo id="LIFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNR_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNREMPNO" size="256" summ="default" type="STRING"/>
					<colinfo id="STATE" size="256" summ="default" type="STRING"/>
					<colinfo id="APPDATE1" size="256" summ="default" type="STRING"/>
					<colinfo id="PCPNUM1" size="256" summ="default" type="STRING"/>
					<colinfo id="MEMO1" size="256" summ="default" type="STRING"/>
					<colinfo id="APPDATE2" size="256" summ="default" type="STRING"/>
					<colinfo id="PCPNUM2" size="256" summ="default" type="STRING"/>
					<colinfo id="MEMO2" size="256" summ="default" type="STRING"/>
					<colinfo id="APPDATE3" size="256" summ="default" type="STRING"/>
					<colinfo id="PCPNUM3" size="256" summ="default" type="STRING"/>
					<colinfo id="MEMO3" size="256" summ="default" type="STRING"/>
					<colinfo id="SENDDATE" size="256" summ="default" type="STRING"/>
					<colinfo id="RECDATE" size="256" summ="default" type="STRING"/>
					<colinfo id="RECID" size="256" summ="default" type="STRING"/>
					<colinfo id="CRDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="CRTIM" size="256" summ="default" type="STRING"/>
					<colinfo id="CRNAM" size="256" summ="default" type="STRING"/>
					<colinfo id="CHDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="CHTIM" size="256" summ="default" type="STRING"/>
					<colinfo id="CHNAM" size="256" summ="default" type="STRING"/>
					<colinfo id="MEMO" size="256" summ="default" type="STRING"/>
					<colinfo id="PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="SUBJECTCDT_ITEMS" size="256" summ="default" type="STRING"/>
					<colinfo id="PCPNM1" size="256" summ="default" type="STRING"/>
					<colinfo id="PCPNM2" size="256" summ="default" type="STRING"/>
					<colinfo id="PCPNM3" size="256" summ="default" type="STRING"/>
					<colinfo id="RECNM" size="256" summ="default" type="STRING"/>
					<colinfo id="RECPART" size="256" summ="default" type="STRING"/>
					<colinfo id="RECRANK" size="256" summ="default" type="STRING"/>
					<colinfo id="RECNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="RECTEL" size="256" summ="default" type="STRING"/>
					<colinfo id="NOTICE" size="256" summ="default" type="STRING"/>
					<colinfo id="IMPDATE" size="256" summ="default" type="STRING"/>
					<colinfo id="RECADDR" size="256" summ="default" type="STRING"/>
					<colinfo id="EMP_AREA_N" size="256" summ="default" type="STRING"/>
					<colinfo id="PCPNUM1_MAIL" size="256" summ="default" type="STRING"/>
					<colinfo id="PCPNUM2_MAIL" size="256" summ="default" type="STRING"/>
					<colinfo id="PCPNUM3_MAIL" size="256" summ="default" type="STRING"/>
					<colinfo id="EMP_MAIL" size="256" summ="default" type="STRING"/>
					<colinfo id="PCPNUM1_AREA_N" size="256" summ="default" type="STRING"/>
					<colinfo id="PCPNUM2_AREA_N" size="256" summ="default" type="STRING"/>
					<colinfo id="PCPNUM3_AREA_N" size="256" summ="default" type="STRING"/>
					<colinfo id="PCPNUM1_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="PCPNUM2_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="PCPNUM3_NM" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond3">
				<Contents>
					<colinfo id="SUPRTCD" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNR" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
		</Datasets>
		<Shape BKColor="user12" Bottom="562" Height="26" Id="Shape16" Left="8" LineColor="user13" Right="608" TabOrder="33" Top="536" Type="Rectangle" Width="600"></Shape>
		<Div Height="35" Id="div_btn" Left="-1" TabOrder="2" Text="Div0" Url="WB01::CommBtnForm.xml" Width="609">
			<Contents></Contents>
		</Div>
		<Image Height="19" Id="Image0" ImageID="form_bl_title_sub" Left="14" TabOrder="3" Top="243" Width="11"></Image>
		<Grid AreaSelect="TRUE" AutoFit="TRUE" AutoFitEndLine="Hide" BindDataset="ds_apply" BkColor2="default" BoldHead="true" Border="Flat" Bottom="304" ColSelect="TRUE" ColSizing="TRUE" Editable="TRUE" Enable="FALSE" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="41" Id="grd_applyList" InputPanel="FALSE" Left="8" LineColor="user20" LineType="ExHORZ" MinWidth="100" Right="288" RowHeight="20" Style="sty_grid" TabOrder="-1" TabStop="true" Top="263" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="280">
			<contents>
				<format id="Default">
					<columns>
						<col width="50"/>
						<col width="50"/>
						<col width="65"/>
						<col width="111"/>
					</columns>
					<head>
						<cell align="center" col="0" color="user21" display="text" font="굴림,9" text="지사"/>
						<cell align="center" col="1" color="user21" display="text" font="굴림,9" text="직위"/>
						<cell align="center" col="2" color="user21" display="text" font="굴림,9" text="이름"/>
						<cell align="center" col="3" color="user21" display="text" font="굴림,9" text="연락처"/>
					</head>
					<body>
						<cell align="center" bkcolor2="user22" col="0" colid="AREA_N" display="text"/>
						<cell bkcolor2="user22" col="1" colid="RANK" display="normal"/>
						<cell align="center" bkcolor2="user22" col="2" colid="GNM" display="text"/>
						<cell align="center" bkcolor2="user22" col="3" colid="USERMBPN" display="text"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Shape BKColor="user12" Bottom="216" Height="26" Id="Shape9" Left="9" LineColor="user13" Right="608" TabOrder="4" Top="190" Type="Rectangle" Width="599"></Shape>
		<Static Height="24" Id="Static1" Left="8" Style="sty_lb_form_basic" TabOrder="5" Text="&#32;&#32;*&#32;지원요청&#32;대상&#32;" Top="190" VAlign="Middle" Width="124"></Static>
		<Static Height="20" Id="Static12" Left="11" Style="sty_ipt_form_read" TabOrder="6" Text="(*&#32;모두&#32;필수입력입니다.)" Top="172" Width="278"></Static>
		<Shape BKColor="user12" Bottom="241" Height="26" Id="Shape12" Left="11" LineColor="user13" Right="608" TabOrder="8" Top="215" Type="Rectangle" Width="597"></Shape>
		<Static Height="24" Id="st_birth" Left="8" Style="sty_lb_form_basic" TabOrder="7" Text="&#32;&#32;*&#32;신청일&#32;" Top="216" VAlign="Middle" Width="124"></Static>
		<Calendar BindDataset="ds_list" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="CRDAT" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Enable="FALSE" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="23" Id="cal_apply" Left="138" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="9" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="217" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="100"></Calendar>
		<Static Color="user6" Font="굴림,9,Bold" Height="20" Id="Static2" Left="320" TabOrder="10" Text="&#32;수령자&#32;정보" Top="244" VAlign="Middle" Width="149"></Static>
		<Grid AreaSelect="TRUE" AutoFit="TRUE" AutoFitEndLine="Hide" BindDataset="ds_apply2" BkColor2="default" BoldHead="true" Border="Flat" Bottom="304" ColSelect="TRUE" ColSizing="TRUE" Editable="TRUE" Enable="FALSE" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="40" Id="grd_receiptList" InputPanel="FALSE" Left="312" LineColor="user20" LineType="ExHORZ" MinWidth="100" OnCellDBLClick="grd_list_OnCellDblClick" OnHeadClick="grd_list_OnHeadClick" Right="606" RowHeight="20" Style="sty_grid" TabOrder="11" TabStop="true" Top="264" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="294">
			<contents>
				<format id="Default">
					<columns>
						<col width="50"/>
						<col width="50"/>
						<col width="65"/>
						<col width="111"/>
					</columns>
					<head>
						<cell align="center" col="0" color="user21" display="text" font="굴림,9" text="지사"/>
						<cell align="center" col="1" color="user21" display="text" font="굴림,9" text="직위"/>
						<cell align="center" col="2" color="user21" display="text" font="굴림,9" text="이름"/>
						<cell align="center" col="3" color="user21" display="text" font="굴림,9" text="연락처"/>
					</head>
					<body>
						<cell align="center" bkcolor2="user22" col="0" colid="AREA_N" display="text"/>
						<cell bkcolor2="user22" col="1" colid="RANK" display="normal"/>
						<cell align="center" bkcolor2="user22" col="2" colid="GNM" display="text"/>
						<cell align="center" bkcolor2="user22" col="3" colid="USERMBPN" display="text"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Static Color="user6" Font="굴림,9,Bold" Height="20" Id="Static19" Left="27" TabOrder="12" Text="&#32;신청자&#32;정보" Top="244" VAlign="Middle" Width="149"></Static>
		<Image Height="19" Id="Image2" ImageID="form_bl_title_sub" Left="312" TabOrder="13" Top="242" Width="11"></Image>
		<Static Color="user6" Font="굴림,9,Bold" Height="20" Id="Static3" Left="27" TabOrder="15" Text="&#32;*&#32;프로젝트&#32;정보" Top="326" VAlign="Middle" Width="149"></Static>
		<Image Height="19" Id="Image3" ImageID="form_bl_title_sub" Left="14" TabOrder="14" Top="325" Width="11"></Image>
		<Grid AreaSelect="TRUE" AutoFit="TRUE" AutoFitEndLine="Hide" BindDataset="ds_prj" BkColor2="default" BoldHead="true" Border="Flat" Bottom="390" ColSelect="TRUE" ColSizing="TRUE" Editable="TRUE" Enable="FALSE" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="42" Id="grd_prj" InputPanel="FALSE" Left="8" LineColor="user20" LineType="ExHORZ" MinWidth="100" OnCellDBLClick="grd_list_OnCellDblClick" OnHeadClick="grd_list_OnHeadClick" Right="288" RowHeight="20" Style="sty_grid" TabOrder="16" TabStop="true" Top="348" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="280">
			<contents>
				<format id="Default">
					<columns>
						<col width="60"/>
						<col width="60"/>
						<col width="45"/>
						<col width="45"/>
					</columns>
					<head>
						<cell align="center" col="0" color="user21" display="text" font="굴림,9" text="프로젝트"/>
						<cell align="center" col="1" color="user21" display="text" font="굴림,9" text="담당PM"/>
						<cell align="center" col="2" color="user21" display="text" font="굴림,9" text="총대수"/>
						<cell align="center" col="3" color="user21" display="text" font="굴림,9" text="총층수"/>
					</head>
					<body>
						<cell align="center" bkcolor2="user22" col="0" colid="POSID" display="text"/>
						<cell bkcolor2="user22" col="1" colid="NAMET" display="normal"/>
						<cell align="right" bkcolor2="user22" col="2" colid="ZQNTY" display="number"/>
						<cell align="right" bkcolor2="user22" col="3" colid="VALUE" display="number"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Shape BKColor="user12" Bottom="415" Height="26" Id="Shape13" Left="8" LineColor="user13" Right="288" TabOrder="18" Top="389" Type="Rectangle" Width="280"></Shape>
		<Edit BindDataset="ds_prj" Border="Flat" Column="ZSITE_NM" Enable="FALSE" Height="20" Id="ed_zsiteNm" ImeMode="native" Left="72" LeftMargin="4" MaxLength="20" RightMargin="4" Style="sty_ipt_form" TabOrder="19" Top="392" Width="213"></Edit>
		<Static Align="Center" Height="24" Id="Static5" Left="9" Style="sty_lb_form_basic" TabOrder="17" Text="현장명" Top="390" VAlign="Middle" Width="59"></Static>
		<Shape BKColor="user12" Bottom="440" Height="26" Id="Shape15" Left="8" LineColor="user13" Right="288" TabOrder="21" Top="414" Type="Rectangle" Width="280"></Shape>
		<Edit BindDataset="ds_prj" Border="Flat" Column="ADDR" Enable="FALSE" Height="20" Id="ed_addr" ImeMode="native" Left="72" LeftMargin="4" MaxLength="20" OnChanged="Tab00_tab1_ed_namee_OnChanged" RightMargin="4" Style="sty_ipt_form" TabOrder="22" Top="417" Width="213"></Edit>
		<Static Align="Center" Height="24" Id="Static6" Left="9" Style="sty_lb_form_basic" TabOrder="20" Text="설치지역" Top="415" VAlign="Middle" Width="59"></Static>
		<Static Color="user6" Font="굴림,9,Bold" Height="20" Id="Static7" Left="320" TabOrder="24" Text="&#32;공지사항" Top="326" VAlign="Middle" Width="149"></Static>
		<Image Height="19" Id="Image4" ImageID="form_bl_title_sub" Left="312" TabOrder="23" Top="324" Width="11"></Image>
		<Button Enable="FALSE" Height="18" Id="btn_prj" ImageID="btn_icon_search" Left="133" OnClick="btn_prj_OnClick" TabOrder="25" Text="Button0" Top="328" Width="18"></Button>
		<TextArea BindDataset="ds_supported" Column="NOTICE" DisableBKColor="user5" Enable="FALSE" Height="112" Id="ta_notice" ImeMode="none" Left="310" TabOrder="26" Top="348" VScroll="TRUE" Width="274"></TextArea>
		<Static Color="user6" Font="굴림,9,Bold" Height="20" Id="Static9" Left="32" TabOrder="28" Text="&#32;*&#32;구매처&#32;정보" Top="451" VAlign="Middle" Width="149"></Static>
		<Image Height="19" Id="Image5" ImageID="form_bl_title_sub" Left="14" TabOrder="27" Top="450" Width="11"></Image>
		<Button Enable="FALSE" Height="18" Id="btn_purchase" ImageID="btn_icon_search" Left="126" OnClick="btn_purchase_OnClick" TabOrder="29" Text="Button0" Top="454" Width="18"></Button>
		<Grid AreaSelect="TRUE" AutoFit="TRUE" AutoFitEndLine="Hide" BindDataset="ds_purchase" BkColor2="default" BoldHead="true" Border="Flat" Bottom="518" ColSelect="TRUE" ColSizing="TRUE" Editable="TRUE" Enable="FALSE" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="41" Id="grd_purchase" InputPanel="FALSE" Left="8" LineColor="user20" LineType="ExHORZ" MinWidth="100" Right="608" RowHeight="20" Style="sty_grid" TabOrder="30" TabStop="true" Top="477" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="600">
			<contents>
				<format id="Default">
					<columns>
						<col width="62"/>
						<col width="68"/>
						<col width="106"/>
					</columns>
					<head>
						<cell align="center" col="0" color="user21" display="text" font="굴림,9" text="구매처명"/>
						<cell align="center" col="1" color="user21" display="text" font="굴림,9" text="전화번호"/>
						<cell align="center" col="2" color="user21" display="text" font="굴림,9" text="이메일"/>
					</head>
					<body>
						<cell align="left" bkcolor2="user22" col="0" colid="NAME" display="text"/>
						<cell bkcolor2="user22" col="1" colid="USERTELE" display="normal"/>
						<cell bkcolor2="user22" col="2" colid="USERMAIL" display="text"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Static Height="24" Id="cal_imd" Left="9" Style="sty_lb_form_basic" TabOrder="31" Text="&#32;&#32;*&#32;반입요청일" Top="537" VAlign="Middle" Width="124"></Static>
		<Calendar BindDataset="ds_list" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="IMPDATE" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Enable="FALSE" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_importRequestDate" Left="136" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="32" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="536" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="100"></Calendar>
		<Shape BKColor="user12" Bottom="585" Height="26" Id="Shape6" Left="8" LineColor="user13" Right="608" TabOrder="35" Top="559" Type="Rectangle" Width="600"></Shape>
		<Static Height="24" Id="Static18" Left="9" Style="sty_lb_form_basic" TabOrder="34" Text="&#32;&#32;*&#32;신청목적" Top="560" VAlign="Middle" Width="124"></Static>
		<Edit BindDataset="ds_list" Border="Flat" Column="TITLE" Enable="FALSE" Height="22" Id="ed_title" ImeMode="none" Left="136" Style="sty_ipt_search" TabOrder="36" Top="561" Width="472"></Edit>
		<Shape BKColor="user12" Bottom="610" Height="26" Id="Shape8" Left="8" LineColor="user13" Right="608" TabOrder="38" Top="584" Type="Rectangle" Width="600"></Shape>
		<Static Height="24" Id="Static13" Left="9" Style="sty_lb_form_basic" TabOrder="37" Text="&#32;&#32;*&#32;수령주소" Top="585" VAlign="Middle" Width="124"></Static>
		<Edit BindDataset="ds_list" Border="Flat" Column="RECADDR" Enable="FALSE" Height="22" Id="ed_receiptAddr" ImeMode="none" Left="136" Style="sty_ipt_search" TabOrder="39" Top="586" Width="472"></Edit>
		<Static Color="user6" Font="굴림,9,Bold" Height="20" Id="Static15" Left="27" TabOrder="41" Text="&#32;*&#32;폼목" Top="623" VAlign="Middle" Width="149"></Static>
		<Image Height="19" Id="Image6" ImageID="form_bl_title_sub" Left="14" TabOrder="40" Top="622" Width="11"></Image>
		<Button Cursor="HAND" Enable="FALSE" Height="20" Id="btn_add" ImageID="btn_icon_plus" Left="72" LeftMargin="12" OnClick="btn_add_OnClick" Style="sty_btn" TabOrder="43" Top="623" Transparent="TRUE" Width="22"></Button>
		<Button Cursor="HAND" Enable="FALSE" Height="20" Id="btn_del" ImageID="btn_icon_minus" Left="104" LeftMargin="12" OnClick="btn_del_OnClick" Style="sty_btn" TabOrder="42" Top="623" Transparent="TRUE" Width="22"></Button>
		<Combo BindDataset="ds_list" Border="Flat" CodeColumn="SUPRTCD" Column="SUPRTCD" DataColumn="SUPRTCDT" Enable="FALSE" Height="20" Id="cb_supported" InnerDataset="ds_supported" Left="138" OnChanged="cb_supported_OnChanged" Style="sty_ipt_search" TabOrder="44" Top="192" Width="100"></Combo>
		<Button ButtonStyle="TRUE" Cursor="HAND" Enable="FALSE" Height="18" Id="btn_receipt" ImageID="btn_icon_user" Left="396" OnClick="btn_receipt_OnClick" Style="sty_btn" TabOrder="45" Top="244" Transparent="TRUE" Width="18"></Button>
		<Grid AutoEnter="TRUE" AutoFit="TRUE" AutoFitEndLine="Hide" AutoScrollBar="AlwaysVert" BindDataset="ds_subject" BkColor2="default" BoldHead="true" Border="Flat" Bottom="784" ColSelect="TRUE" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="136" HScrollCell="TRUE" Id="grd_subject" InputPanel="FALSE" Left="8" LineColor="user20" LineType="ExHORZ" MinWidth="100" Right="608" RowHeight="20" ScrollCell="true" Style="sty_grid" TabOrder="46" TabStop="true" Top="648" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="600">
			<contents>
				<format id="Default">
					<columns>
						<col width="40"/>
						<col width="70"/>
						<col width="70"/>
						<col width="140"/>
						<col width="50"/>
						<col width="194"/>
					</columns>
					<head>
						<cell align="center" col="0" color="user21" display="text" font="굴림,9" text="NO"/>
						<cell col="1" color="user21" display="text" font="굴림,9" text="구분"/>
						<cell col="2" color="user21" display="text" edit="normal" font="굴림,9" text="품목"/>
						<cell col="3" color="user21" display="text" font="굴림,9" text="규격"/>
						<cell align="center" col="4" color="user21" display="text" edit="normal" font="굴림,9" text="수량"/>
						<cell col="5" color="user21" display="text" edit="normal" font="굴림,9" text="비고"/>
					</head>
					<body>
						<cell align="center" bkcolor2="user22" col="0" display="text" expr="currow+1"/>
						<cell align="center" bkcolor2="user22" col="1" colid="SJTCDGB" combocol="CODE" combodataset="ds_gubun" combotext="CODE_NAME" display="combo"/>
						<cell align="center" bkcolor2="user22" col="2" colid="SUBJECTCDT" display="normal"/>
						<cell align="left" bkcolor2="user22" col="3" colid="SPEC" display="normal"/>
						<cell align="right" bkcolor2="user22" col="4" colid="QTY" display="number"/>
						<cell align="left" bkcolor2="user22" col="5" colid="NOTI" display="text"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Grid AreaSelect="TRUE" AutoEnter="TRUE" AutoFit="TRUE" AutoFitEndLine="Hide" BindDataset="ds_paymentLine" BkColor2="default" BoldHead="true" Border="Flat" Bottom="168" ColSelect="TRUE" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="120" Id="grd_paymentLine" InputPanel="FALSE" Left="8" LineColor="user20" LineType="ExHORZ" MinWidth="100" OnHeadClick="grd_list_OnHeadClick" Right="607" RowHeight="20" Style="sty_grid" TabOrder="47" TabStop="true" Top="48" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="599">
			<contents>
				<format id="Default">
					<columns>
						<col width="60"/>
						<col width="49"/>
						<col width="58"/>
						<col width="41"/>
						<col width="55"/>
						<col width="94"/>
						<col width="238"/>
					</columns>
					<head>
						<cell align="center" col="0" color="user21" display="text" font="굴림,9" text="결재선"/>
						<cell align="center" col="1" color="user21" display="text" font="굴림,9" text="지사"/>
						<cell align="center" col="2" color="user21" display="text" font="굴림,9" text="직위"/>
						<cell align="center" col="3" color="user21" display="text" font="굴림,9" text="이름"/>
						<cell align="center" col="4" color="user21" display="text" font="굴림,9" text="상태"/>
						<cell align="center" col="5" color="user21" display="text" font="굴림,9" text="구매처명"/>
						<cell align="center" col="6" color="user21" display="text" font="굴림,9" text="의견"/>
					</head>
					<body>
						<cell align="center" bkcolor2="user22" col="0" colid="PAYMENTLINE" display="text"/>
						<cell bkcolor2="user22" col="1" colid="AREA_N" display="normal"/>
						<cell align="center" bkcolor2="user22" col="2" colid="RANK" display="text"/>
						<cell bkcolor2="user22" col="3" colid="GNM" display="text"/>
						<cell align="center" bkcolor2="user22" col="4" colid="STATEYN" combocol="CODE" combodataset="ds_stateCombo" combotext="CODENAME" display="combo" edit="expr:iif(COMP_YN&#32;==&#32;&apos;Y&apos;,&#32;&apos;combo&apos;,&apos;none&apos;)"/>
						<cell bkcolor2="user22" col="5" colid="LIFNR_NM" display="combo"/>
						<cell bkcolor2="user22" col="6" colid="MEMO" display="text" edit="expr:iif(COMP_YN&#32;==&#32;&apos;Y&apos;,&#32;&apos;normal&apos;,&#32;&apos;none&apos;)"/>
					</body>
				</format>
			</contents>
		</Grid>
	</Form>
	<Script><![CDATA[﻿﻿﻿﻿﻿﻿/*
 ******************************************************************************************
 * 기      능   : 
 * 작  성  자   : 
 * 작성  일자   : 
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
#include "LIB::commons.js";	// 공통 스크립트 
//=========================================================================================
// [ PART 1 ]
// Form에서 사용될 전역변수를 선언
// FORM에서 사용되는 전역변수는 대문자로 작성하며, F_XXX 의 형태를 갖도록 한다. 
//=========================================================================================
var _SUPRTCD = "";
var _state = "";
var enter = "";
var stats = "";
var name1 = "";
var namee = "";
var retif = "";
var lifnr_c = "";
var perno_c = "";
var jumin = "";
var lifnr = "";
var perno = "";
var perkey = "";
var pspid  = "";
var birth  = "";
var F_SIZE = 1024 * 4096;
//=========================================================================================
// [ PART 2 ]
// Form Loading / Unloading 시 작업 정의
//=========================================================================================
function fn_OnLoadCompleted(obj) {
	// Form 로드 이벤트 맨 첫줄에 기술 
	gfn_initForm();
	ds_cond.SetColumn(0,"ORDERNO", ORDERNO);
	cal_apply.value = CRDAT;
	cal_importRequestDate.value = IMPDATE;
	ed_title.value = TITLE;
	ed_receiptAddr.value = RECADDR;
	
	var i = ds_apply2.AddRow();
	ds_apply2.SetColumn(i, "AREA_N", RECPART);
	ds_apply2.SetColumn(i, "RANK", RECRANK);
	ds_apply2.SetColumn(i, "GNM", RECNAME);
	ds_apply2.SetColumn(i, "USERMBPN", RECTEL);
	
    ufn_initSupportCombo();
	ufn_getPaymentLineInfo(); 	
	ufn_initApplyInfo();
	ufn_getProjectInfo();
	ufn_getPurchaseInfo();
	ufn_getSubjectInfo();
	
	if (STATE == "C1")
	{
		div_btn.btn_save.Enable = false;
		grd_paymentLine.Enable = false;
	}
	
	
}

/********************************************************************************
* 기      능   : 구매처 정보 검색하여 변경
********************************************************************************/
function btn_purchase_OnClick(obj)
{	
	var arg  = "SUPRTCD=" + quote(SUPRTCD);
	    arg += " GUBUN="  + quote("C");
	var arr  = gfn_openPopupUrl("PS15::PS1501001H.xml", true, arg);
}

/********************************************************************************
* 기      능   : 품목 정보 입력
********************************************************************************/
function ufn_getSubjectInfo()
{
	ds_cond.SetColumn(0,"ORDERNO", ORDERNO);
	tit_clearActionInfo();
	tit_addSearchActionInfo("ps15:PS1501003A_S2");
	tit_callService(
        ""
        , ""
        , "ds_cond=ds_cond"
        , "ds_subject=ds_subject"
        , ""
        , ""
        , 
        , true);
}


/********************************************************************************
* 기      능   : 구매처 정보 입력
********************************************************************************/
function ufn_getPurchaseInfo()
{
	
	ds_cond3.AddRow();
	ds_cond3.SetColumn(0,"LIFNR",LIFNR);
	tit_clearActionInfo();
	tit_addSearchActionInfo("ps15:PS1501002B_S4");
	tit_callService(
        ""
        , ""
        , "ds_cond3=ds_cond3"
        , "ds_purchase=ds_purchase"
        , ""
        , ""
        , 
        , true);
}
/********************************************************************************
* 기      능   : 프로젝트 정보 가져오기
********************************************************************************/
function ufn_getProjectInfo() {	
	 
	ds_cond.SetColumn(0,"FIRSTROW","Y");
	ds_cond.SetColumn(0,"POSID",PSPID);
	
	tit_clearActionInfo();
    tit_addSearchActionInfo("ps15:PS1501002B_S5");

	tit_callService(
        ""
        , ""
        , "ds_cond=ds_cond"
        , "ds_prj=ds_list"
        , ""
        , ""
        , true);
}
/********************************************************************************
* 기      능   : 결재선 정보 가져오기
********************************************************************************/
function ufn_getPaymentLineInfo() 
{
	tit_clearActionInfo();	
	tit_addSearchActionInfo("ps15:PS1501003A_S1");
	tit_callService(
        ""
        , ""
        , "ds_cond=ds_cond"
		, "ds_paymentLine=ds_paymentLine"
        , ""
        , "ufn_afterPaymentLineInfo"
        , true);
}

/********************************************************************************
* 기      능   : 설치일때 결재자 권한 세팅
********************************************************************************/
function ufn_afterPaymentLineInfo(){
	//trace("gfn_getUserGroup()= " +gfn_getUserGroup()); //40이면 설치??
	if(gfn_getUserGroup() == 40){//
		//trace(100);
		ds_paymentLine.SetColumn(2,"GI", G_USER_ID);
		ds_paymentLine.SetColumn(2,"GID", G_USER_ID);
		btn_purchase.Enable = true;
		
	}
	//trace("ufn_afterPaymentLineInfo");
}
/********************************************************************************
* 기      능   : 신청자 정보 Grid Automapping
********************************************************************************/
function ufn_initApplyInfo() 
{
	ds_cond.SetColumn(0,"USER_ID",EMPNO);
	tit_clearActionInfo();	
	tit_addSearchActionInfo("ps15:PS1501002B_S2");
	tit_callService(
        ""
        , ""
        , "ds_cond=ds_cond"
        , "ds_apply=ds_apply"
        , ""
        , ""
        , true);
}

/********************************************************************************
* 기      능   : 지원대상 콤보박스용 조회(ZPST0401)
********************************************************************************/
function ufn_initSupportCombo() 
{
	tit_clearActionInfo();	
	tit_addSearchActionInfo("ps15:PS1501001A_S2");
	tit_callService(
        ""
        , ""
        , ""
        , "ds_supported=ds_supported"
        , ""
        , "ufn_afterInitCombo"
        , true);
}

function ufn_afterInitCombo(errCode, errMsg) {
	cb_supported.value = SUPRTCD;
	ta_notice.Text = NOTICE;
}
/********************************************************************************
* 기      능   : 공통코드가 조회된 후의 Callback 함수 
********************************************************************************/
function fn_completeInit(sCode, sDsObj, sCodeType) {
//ALERT("2");
	//fn_query2();
}
/********************************************************************************
* 기      능   : 프로젝트정보 검색 
********************************************************************************/
function btn_prj_OnClick(obj)
{
    ds_prj.ClearData();
    var arg = "";
	var arr = gfn_openPopupUrl("PS15::PS1501001E.xml", true, arg);
}
/********************************************************************************
* 기      능   : 조회 Callback  
********************************************************************************/
function fn_afterQuery(errCode, errMsg) {
	gfn_showMsg("CI00002",ds_swn.RowCount()+"");
}

/********************************************************************************
* 기      능   : 저장
********************************************************************************/
function fn_save() {

	var updateFlag = true;
	
	if(!gfn_isChangeDs(ds_paymentLine, false))
	{
	    gfn_showAlert("CW00005"); // CW00005=변경된 정보가 없습니다.
		return;
	}
	
	if (!gfn_showConfirm("CI00008")) {	// 저장하시겠습니까?
		return;
	}
	
	
	if(ds_paymentLine.GetColumn(1, "STATEYN") == 'Y')
	{
		if( ds_paymentLine.GetColumn(0, "STATEYN") == 'N')
		{
			gfn_showAlert("1차결재 상태가 승인되지 않았습니다.");
			return;
		}
	
	}
	
	if(ds_paymentLine.GetColumn(2, "STATEYN") == 'Y')
	{
		if( ds_paymentLine.GetColumn(0, "STATEYN") == 'N')
		{
			gfn_showAlert("1차결재 상태가 승인되지 않았습니다.");
			return;
		}
		
		if( ds_paymentLine.GetColumn(1, "STATEYN") == 'N')
		{
			gfn_showAlert("2차결재 상태가 승인되지 않았습니다.");
			return;
		}
	
	}
	
	ds_cond2.AddRow();
	
	for(var i=0; i < ds_paymentLine.rowcount; i++)
	{
		if(ds_paymentLine.GetColumn(i, "COMP_YN") == 'Y')
		{
			if(ds_paymentLine.GetColumn(i, "PAYGUBUN") == "1")
			{
				if(ds_paymentLine.GetColumn(i, "STATEYN") == 'Y' && ds_paymentLine.GetColumn(i, "STATE") == 'A0') 
				{
					_state = "A1"; //1차결재;
					ds_cond2.SetColumn(0, "STATE", _state); 
					ds_cond2.SetColumn(0, "STATE1", _state);
					ds_cond2.SetColumn(0, "APPDATE1", gfn_getCurrDate());
				}
				
				if(ds_paymentLine.GetColumn(i, "STATEYN") == 'C') 
				{
					_state = "C1"; //반려
					ds_cond2.SetColumn(0, "STATE", _state); 
					ds_cond2.SetColumn(0, "STATE1", _state);
					ds_cond2.SetColumn(0, "APPDATE1", gfn_getCurrDate());
				}
				ds_cond2.SetColumn(0,"MEMO1", ds_paymentLine.GetColumn(i, "MEMO"));
				
				
			}
			
			if(ds_paymentLine.GetColumn(i, "PAYGUBUN") == "2")
			{
				if(ds_paymentLine.GetColumn(i, "STATEYN") == 'Y' && ds_paymentLine.GetColumn(i, "STATE") == 'A1') 
				{
					_state = "A2"; //2차결재
					ds_cond2.SetColumn(0, "STATE", _state); 
					ds_cond2.SetColumn(0, "STATE2", _state);
					ds_cond2.SetColumn(0, "APPDATE2", gfn_getCurrDate());
				}
				
				if(ds_paymentLine.GetColumn(i, "STATEYN") == 'C')
				{
					_state = "C1"; //반려
					ds_cond2.SetColumn(0, "STATE", _state); 
					ds_cond2.SetColumn(0, "STATE2", _state);
					ds_cond2.SetColumn(0, "APPDATE2", gfn_getCurrDate());
				}
				ds_cond2.SetColumn(0,"MEMO2", ds_paymentLine.GetColumn(i, "MEMO"));
				
				
			}
			
			if(ds_paymentLine.GetColumn(i, "PAYGUBUN") == "3")
			{
				if(ds_paymentLine.GetColumn(i, "STATEYN") == 'Y' && (ds_paymentLine.GetColumn(i, "STATE") == 'A1' || ds_paymentLine.GetColumn(i, "STATE") == 'A2')) 
				{
					_state = "A3"; //3차결재
					ds_cond2.SetColumn(0, "STATE", _state); 
					ds_cond2.SetColumn(0, "STATE3", _state);
					ds_cond2.SetColumn(0, "APPDATE3", gfn_getCurrDate());
					ds_cond2.SetColumn(0, "PCPNUM3", G_USER_ID);
				}
				
				if(ds_paymentLine.GetColumn(i, "STATEYN") == 'C')
				{
					_state = "C1"; //반려
					ds_cond2.SetColumn(0, "STATE", _state); 
					ds_cond2.SetColumn(0, "STATE3", _state);
					ds_cond2.SetColumn(0, "APPDATE3", gfn_getCurrDate());
				}
				ds_cond2.SetColumn(0, "MEMO3", ds_paymentLine.GetColumn(i, "MEMO"));
				
			}
		}
	}

	ds_cond2.SetColumn(0, "ORDERNO", ORDERNO);
	
	tit_clearActionInfo();
	
	tit_addSingleActionInfo("ps15:PS1501003C_U1");
	tit_callService(
        ""
        , ""
        , "ds_cond2=ds_cond2:A"
        , ""
        , ""
        , "fn_afterSave");

}
/********************************************************************************
* 기      능   : 저장 Callback  
********************************************************************************/
function fn_afterSave(errCode, errMsg) {
	if ( errCode != 0 ) {
		gfn_showAlert("CE00001");
		
	} else {
	
		gfn_showAlert("CI00003");
		// 1차, 2차, 검토 결제시 메일 발송 
		if(_state == "A1" || _state == "A2" || _state == "A3"){   
			fn_sendMail();
			//trace("메일 발송 완료");
		}else{
			fn_close();
			//trace("메일 미발송");
		}
	}
}
/********************************************************************************
* 기      능   : 메일발송저장
********************************************************************************/
function fn_sendMail()
{
	ds_cond.ClearData();
	ds_cond.AddRow();
	ds_cond.SetColumn(0, "ORDERNO",  ORDERNO);
	tit_clearActionInfo();
	tit_addSearchActionInfo("ps15:PS1501001A_S1");
	tit_callService(
        ""
        , ""
        , "ds_cond=ds_cond"
        , "ds_list2=ds_list"
        , ""
        , "fn_afterSendMail"
        , true);
}
/********************************************************************************
* 기      능   : 메일발송
********************************************************************************/

function fn_afterSendMail()
{
	var send_user = "";
	var rece_user = "";
	
	if(_state == "A1"){										// 1차 결제 메일
		send_user = ds_list2.GetColumn(0, "PCPNUM1_MAIL"); 	//보내는사람
		rece_user = ds_list2.GetColumn(0, "PCPNUM2_MAIL"); 	//받는사람
	}else if(_state == "A2"){								// 2차 결재 메일
		send_user = ds_list2.GetColumn(0, "PCPNUM2_MAIL"); 	//보내는사람
		rece_user = ds_list2.GetColumn(0, "PCPNUM3_MAIL"); 	//받는사람
	}else if(_state == "A3"){								// 검토 결재 메일
		send_user = ds_list2.GetColumn(0, "PCPNUM3_MAIL"); 	//보내는사람
		rece_user = ds_list2.GetColumn(0, "EMP_MAIL"); 		//받는사람
	}
	
	var mesgtitl  = ""; //제목
	var mesgbody  = ""; //내용
	
	var pop_meg = "";
	
	mesgtitl = mesgtitl +'현장소모품 (' + ds_list2.GetColumn(0, "SUPRTCDT")  + ') 결재요청 (' + ds_list2.GetColumn(0, "PSPID") + ' - ' + substr(ds_list2.GetColumn(0, "ZSITE_NM"),0,7) + ")";
	
	if(_state == "A1"){
		mesgbody = ds_list2.GetColumn(0, "PCPNUM1_AREA_N") + ' ' + ds_list2.GetColumn(0, "PCPNUM1_NM") +' 님이 SRM을 통해 발송한 메일입니다.' + '\n\n'; 
	}else if(_state == "A2"){
		mesgbody = ds_list2.GetColumn(0, "PCPNUM2_AREA_N") + ' ' + ds_list2.GetColumn(0, "PCPNUM2_NM") +' 님이 SRM을 통해 발송한 메일입니다.' + '\n\n'; 
	}
	
    mesgbody = mesgbody + '프로젝트번호: ' + ds_list2.GetColumn(0, "PSPID") + '\n';
    mesgbody = mesgbody + '프로젝트명: ' + ds_list2.GetColumn(0, "ZSITE_NM") + '\n\n';
    
    if(_state == "A3"){   // 검토 결제시 메일 문구 변경
		mesgbody = mesgbody + '본 현장 ' + ds_list2.GetColumn(0, "SUPRTCDT")  + ' 결재 완료.\n';
    }else{
		mesgbody = mesgbody + '본 현장 ' + ds_list2.GetColumn(0, "SUPRTCDT")  + '를 신청하오니 결재 바랍니다.\n';
		mesgbody = mesgbody + '(결재 화면: SRM-현장관리-현장소모품 결재화면)\n\n';
    }
    
    mesgbody = mesgbody + '감사합니다.\n';
    
    //trace("send_user = " + send_user);
    //trace("rece_user = " + rece_user);
    //trace("mesgtitl = " + mesgtitl);
    //trace("mesgbody = " + mesgbody);
    
    if(rece_user != "")
    {
		//메일발송 함수 변경(sendmail -> sendmailNew) - 2019.03.31 강민석K
		/*
		tit_callService(
			"COMM_ACT"
			, "sendmail"
			, ""
			, ""
			," SEND_USER=" + quote( send_user )
				+ " RECE_USER=" + quote( rece_user )
				+ " MESGTITL="  + quote( mesgtitl )
				+ " MESGBODY="  + quote( mesgbody )
			, ""  //"fn_afterQuery"
			, false
			, true);
		*/
		
		var send_user_nm = "";
		var recv_user_nm = "";
		
		if(_state == "A1"){
			send_user_nm = ds_paymentLine.GetColumn(0, "GNM");//발신자 이름
			recv_user_nm = ds_paymentLine.GetColumn(1, "GNM");//수신자 이름
		}else if(_state == "A2"){
			send_user_nm = ds_paymentLine.GetColumn(1, "GNM");//발신자 이름
			recv_user_nm = ds_paymentLine.GetColumn(2, "GNM");//수신자 이름
		}else if(_state == "A3"){
			send_user_nm = ds_paymentLine.GetColumn(2, "GNM");//발신자 이름
			recv_user_nm = ds_list2.GetColumn(0, "EMPNM");//수신자 이름
		}
		
		//trace("send_user_nm = " + send_user_nm);
		//trace("rece_user_nm = " + recv_user_nm);

		tit_callService(
			"COMM_ACT"
			, "sendmailNew"
			, ""
			, ""
			," SEND_USER=" + quote( send_user )
				+ " RECV_USER=" + quote( rece_user )
				+ " SEND_USER_NM=" + quote( send_user_nm )
				+ " RECV_USER_NM=" + quote( recv_user_nm )
				+ " MESGTITL="  + quote( mesgtitl )
				+ " MESGBODY="  + quote( mesgbody )
			, ""
			, false
			, true);
     
			pop_meg = '메일이 발송 되었습니다.';	
    }
    	
	//gfn_showInform("CW10025", pop_meg);	
	fn_close();

}
/********************************************************************************
* 기      능   : form UnloadCompleted 
********************************************************************************/
function fn_OnUnloadCompleted(obj) {
	return gfn_isFormUnload(obj);
}
/********************************************************************************
* 기      능   : 닫기  
********************************************************************************/
function fn_close() {
	parent.fn_Query();
	close();
	
}

]]></Script>
</Window>