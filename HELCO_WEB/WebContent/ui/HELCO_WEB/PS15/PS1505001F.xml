<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="624" Id="PS1505001F" Left="8" OnLoadCompleted="fn_OnLoadCompleted" PidAttrib="7" Title="투입일정" Top="8" Ver="1.0" Width="590" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_pdf">
				<Contents>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
					<colinfo id="BIGO" size="256" summ="default" type="STRING"/>
					<colinfo id="UDATE" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond1">
				<Contents>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID_1" size="256" summ="default" type="STRING"/>
					<colinfo id="JOB_CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_notice">
				<Contents>
					<colinfo id="CONTENTS" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_memo_del">
				<Contents>
					<colinfo id="PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQNO_LIST" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_save">
				<Contents>
					<colinfo id="PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
					<colinfo id="JOB_CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="EXP_DATE" size="256" summ="default" type="STRING"/>
					<colinfo id="EXP_TIME" size="256" summ="default" type="STRING"/>
					<colinfo id="WORKER" size="256" summ="default" type="STRING"/>
					<colinfo id="WORKER_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="WORKER_HP" size="256" summ="default" type="STRING"/>
					<colinfo id="PROC_VER" size="256" summ="default" type="STRING"/>
					<colinfo id="REQ_DATE" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_worker"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_auth">
				<Contents>
					<colinfo id="AUTH" size="256" summ="default" type="STRING"/>
					<colinfo id="AUTH_NAME" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_memo">
				<Contents>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="CRNAM" size="256" summ="default" type="STRING"/>
					<colinfo id="CRID" size="256" summ="default" type="STRING"/>
					<colinfo id="BELONG" size="256" summ="default" type="STRING"/>
					<colinfo id="JOB_NAME" size="256" summ="default" type="STRING"/>
					<colinfo id="CONTENTS" size="256" summ="default" type="STRING"/>
					<colinfo id="CONTENTS_ORIG" size="256" summ="default" type="STRING"/>
					<colinfo id="CRDATE_TIME" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="ALM_INDC" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_time">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_minute">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_combo">
				<Contents>
					<colinfo id="ST_TIME" size="256" summ="default" type="STRING"/>
					<colinfo id="ST_MINUTE" size="256" summ="default" type="STRING"/>
					<colinfo id="PL_TIME" size="256" summ="default" type="STRING"/>
					<colinfo id="PL_MINUTE" size="256" summ="default" type="STRING"/>
					<record>
						<PL_MINUTE></PL_MINUTE>
						<PL_TIME></PL_TIME>
						<ST_MINUTE></ST_MINUTE>
						<ST_TIME></ST_TIME>
					</record>
				</Contents>
			</Dataset>
		</Datasets>
		<Shape BKColor="user12" Bottom="347" Height="26" Id="Shape10" Left="295" LineColor="user13" Right="501" TabOrder="46" Top="321" Type="Rectangle" Width="206"></Shape>
		<Div Height="36" Id="div_btn" TabOrder="1" TabStop="FALSE" Text="Div0" Url="WB01::CommBtnForm.xml" Width="590">
			<Contents></Contents>
		</Div>
		<Button ButtonStyle="TRUE" Cursor="HAND" DragImageID="tab_form_05" Font="굴림,9" Height="20" Id="btn_sibang" ImageID="btn_user_06" Left="6" OnClick="btn_sibang_OnClick" Style="sty_btn" TabOrder="2" Text="영업사양&#32;조회" Top="45" Width="87"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" DragImageID="tab_form_05" Font="굴림,9" Height="20" Id="btn_plan" ImageID="btn_user_02" Left="97" OnClick="btn_plan_OnClick" Style="sty_btn" TabOrder="3" Text="도면" Top="45" Width="40"></Button>
		<Static Align="Right" Font="굴림,9" Height="16" Id="st_manager" Left="466" TabOrder="4" Text="담당자&#32;:&#32;업체담당자" Top="47" Width="115"></Static>
		<Static Align="Center" Font="굴림,12" Height="24" Id="Static1" Left="150" TabOrder="5" Text="현장과&#32;협의된&#32;작업예정일을&#32;입력하세요" Top="72" Width="296"></Static>
		<Static Font="굴림,9" Height="16" Id="st_process1" Left="14" TabOrder="6" Text="1번:&#32;업체지정&#32;→&#32;2번:&#32;작업요청&#32;→" Top="104" Width="199"></Static>
		<Static Color="darkorange" Font="굴림,9,Bold" Height="16" Id="st_process2" Left="206" TabOrder="7" Text="3번:&#32;투입일정" Top="104" Width="95"></Static>
		<Static Font="굴림,9" Height="16" Id="st_process3" Left="286" TabOrder="8" Text="&#32;→&#32;4번:&#32;작업시작&#32;→&#32;5번:&#32;작업완료&#32;→&#32;6번:&#32;비용처리" Top="104" Width="288"></Static>
		<Shape BKColor="user12" Bottom="227" Height="26" Id="Shape0" Left="85" LineColor="user13" Right="291" TabOrder="10" Top="201" Type="Rectangle" Width="206"></Shape>
		<Static Align="Center" BKColor="user1" Height="24" Id="Static6" Left="86" Style="sty_lb_form_basic" TabOrder="9" Text="설치업체" Top="202" VAlign="Middle" Width="71"></Static>
		<Edit BindDataset="ds_list" Border="Flat" Column="LIFNR_NM" Enable="FALSE" Height="20" Id="ed_lifnr_nm" ImeMode="native" Left="160" LeftMargin="4" MaxLength="20" Readonly="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="11" Top="204" Width="128"></Edit>
		<Shape BKColor="user12" Bottom="227" Height="26" Id="Shape1" Left="295" LineColor="user13" Right="501" TabOrder="13" Top="201" Type="Rectangle" Width="206"></Shape>
		<Static Align="Center" BKColor="user1" Height="24" Id="Static7" Left="296" Style="sty_lb_form_basic" TabOrder="12" Text="작업명" Top="202" VAlign="Middle" Width="71"></Static>
		<Edit BindDataset="ds_list" Border="Flat" Column="JOB_NAME" Enable="FALSE" Height="20" Id="ed_jobname" ImeMode="native" Left="370" LeftMargin="4" MaxLength="20" Readonly="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="14" Top="204" Width="128"></Edit>
		<Shape BKColor="user12" Bottom="257" Height="26" Id="Shape2" Left="85" LineColor="user13" Right="291" TabOrder="16" Top="231" Type="Rectangle" Width="206"></Shape>
		<Static Align="Center" BKColor="user1" Height="24" Id="Static8" Left="86" Style="sty_lb_form_basic" TabOrder="15" Text="작업팀장" Top="232" VAlign="Middle" Width="71"></Static>
		<Edit BindDataset="ds_list" Border="Flat" Column="NAMET" Enable="FALSE" Height="20" Id="ed_namet" ImeMode="native" Left="160" LeftMargin="4" MaxLength="20" Readonly="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="17" Top="234" Width="128"></Edit>
		<Shape BKColor="user12" Bottom="257" Height="26" Id="Shape3" Left="295" LineColor="user13" Right="501" TabOrder="19" Top="231" Type="Rectangle" Width="206"></Shape>
		<Static Align="Center" BKColor="user1" Height="24" Id="Static9" Left="296" Style="sty_lb_form_basic" TabOrder="18" Text="작업업체명" Top="232" VAlign="Middle" Width="71"></Static>
		<Edit BindDataset="ds_list" Border="Flat" Column="LIFNR_OUT_NAME" Enable="FALSE" Height="20" Id="ed_lifnr_out_name" ImeMode="native" Left="370" LeftMargin="4" MaxLength="20" Readonly="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="20" Top="234" Width="128"></Edit>
		<Shape BKColor="user12" Bottom="287" Height="26" Id="Shape4" Left="85" LineColor="user13" Right="291" TabOrder="22" Top="261" Type="Rectangle" Width="206"></Shape>
		<Static Align="Center" BKColor="user1" Height="24" Id="Static10" Left="86" Style="sty_lb_form_basic" TabOrder="21" Text="휴대폰" Top="262" VAlign="Middle" Width="71"></Static>
		<Edit BindDataset="ds_list" Border="Flat" Column="NAMET_HP" Enable="FALSE" Height="20" Id="ed_team_hp" ImeMode="native" Left="160" LeftMargin="4" MaxLength="20" Readonly="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="23" Top="264" Width="128"></Edit>
		<Shape BKColor="user12" Bottom="317" Height="26" Id="Shape6" Left="85" LineColor="user13" Right="291" TabOrder="25" Top="291" Type="Rectangle" Width="206"></Shape>
		<Static Align="Center" BKColor="user1" Height="24" Id="Static12" Left="86" Style="sty_lb_form_basic" TabOrder="24" Text="설치PM" Top="292" VAlign="Middle" Width="71"></Static>
		<Edit BindDataset="ds_list" Border="Flat" Column="PM_NAME" Enable="FALSE" Height="20" Id="ed_pm_name" ImeMode="native" Left="160" LeftMargin="4" MaxLength="20" Readonly="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="26" Top="294" Width="128"></Edit>
		<Shape BKColor="user12" Bottom="317" Height="26" Id="Shape7" Left="295" LineColor="user13" Right="501" TabOrder="28" Top="291" Type="Rectangle" Width="206"></Shape>
		<Static Align="Center" BKColor="user1" Height="24" Id="Static13" Left="296" Style="sty_lb_form_basic" TabOrder="27" Text="작업요청자" Top="292" VAlign="Middle" Width="71"></Static>
		<Edit BindDataset="ds_list" Border="Flat" Column="REQ_NAME" Enable="FALSE" Height="20" Id="ed_requester" ImeMode="native" Left="370" LeftMargin="4" MaxLength="20" Readonly="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="29" Top="294" Width="128"></Edit>
		<Shape BKColor="user12" Bottom="347" Height="26" Id="Shape8" Left="85" LineColor="user13" Right="291" TabOrder="31" Top="321" Type="Rectangle" Width="206"></Shape>
		<Static Align="Center" BKColor="user1" Height="24" Id="Static14" Left="86" Style="sty_lb_form_basic" TabOrder="30" Text="휴대폰" Top="322" VAlign="Middle" Width="71"></Static>
		<Edit BindDataset="ds_list" Border="Flat" Column="PM_HP" Enable="FALSE" Height="20" Id="ed_pm_hp" ImeMode="native" Left="160" LeftMargin="4" MaxLength="20" Readonly="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="32" Top="324" Width="128"></Edit>
		<Shape BKColor="user12" Bottom="377" Height="26" Id="Shape9" Left="295" LineColor="user13" Right="501" TabOrder="34" Top="351" Type="Rectangle" Width="206"></Shape>
		<Static Align="Center" BKColor="user1" Height="24" Id="Static15" Left="296" Style="sty_lb_form_basic" TabOrder="33" Text="작업요청일" Top="352" VAlign="Middle" Width="71"></Static>
		<Shape BKColor="user12" Bottom="195" Height="26" Id="Shape5" Left="84" LineColor="user13" Right="501" TabOrder="36" Top="169" Type="Rectangle" Width="417"></Shape>
		<Static Align="Center" BKColor="yellow" Height="24" Id="Static11" Left="85" Style="sty_lb_form_basic" TabOrder="35" Text="호기" Top="170" VAlign="Middle" Width="71"></Static>
		<Edit Border="Flat" Enable="FALSE" Height="20" Id="ed_posids" ImeMode="native" Left="225" LeftMargin="4" MaxLength="20" Readonly="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="37" Top="172" Width="273"></Edit>
		<Button ButtonStyle="TRUE" Cursor="HAND" DragImageID="tab_form_05" Font="굴림,9" Height="20" Id="btn_select" ImageID="btn_user_04" Left="160" OnClick="btn_select_OnClick" Style="sty_btn" TabOrder="38" Text="선택하기" Top="172" Width="65"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" DragImageID="tab_form_05" Font="굴림,9" Height="20" Id="btn_add" ImageID="btn_user_04" Left="477" OnClick="btn_add_OnClick" Style="sty_btn" TabOrder="39" Text="메모추가" Top="455" Width="65"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" DragImageID="tab_form_05" Font="굴림,9" Height="20" Id="btn_delete" ImageID="btn_user_02" Left="544" OnClick="btn_delete_OnClick" Style="sty_btn" TabOrder="40" Text="삭제" Top="455" Width="40"></Button>
		<Static Align="Center" BindDataset="ds_list" Column="POSID" Height="24" Id="st_posid" Left="85" Style="sty_lb_form_basic" TabOrder="41" Text="162800L05" Top="140" VAlign="Middle" Width="75"></Static>
		<Static Align="Center" BindDataset="ds_list" Column="DONG" Height="24" Id="st_dong" Left="164" Style="sty_lb_form_basic" TabOrder="42" Text="1401동" Top="140" VAlign="Middle" Width="45"></Static>
		<Static Height="24" Id="st_site_nm" Left="212" Style="sty_lb_form_basic" TabOrder="43" Text="&#32;남양주&#32;녹촌&#32;라온&#32;프리이빗&#32;4-1BL" Top="140" VAlign="Middle" Width="287"></Static>
		<Static Align="Center" BKColor="user1" Height="24" Id="Static2" Left="296" Style="sty_lb_form_basic" TabOrder="45" Text="작업요청자" Top="322" VAlign="Middle" Width="71"></Static>
		<Edit Border="Flat" Enable="FALSE" Height="20" Id="ed_req_reg_time" ImeMode="native" Left="370" LeftMargin="4" MaxLength="20" Readonly="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="47" Top="324" Width="128"></Edit>
		<Static Align="Center" BKColor="user1" Height="24" Id="Static16" Left="296" Style="sty_lb_form_basic" TabOrder="48" Text="요청등록시간" Top="322" VAlign="Middle" Width="71"></Static>
		<Shape BKColor="user12" Bottom="440" Height="26" Id="Shape11" Left="85" LineColor="user13" Right="501" TabOrder="50" Top="414" Type="Rectangle" Width="416"></Shape>
		<Static Align="Center" BKColor="yellow" Height="24" Id="Static17" Left="86" Style="sty_lb_form_basic" TabOrder="49" Text="작업예정일시" Top="415" VAlign="Middle" Width="71"></Static>
		<Calendar BindDataset="ds_list" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_exp_date" Left="160" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" OnChanged="cal_exp_date_OnChanged" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="51" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="417" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="128"></Calendar>
		<Shape BKColor="user12" Bottom="406" Height="26" Id="Shape12" Left="85" LineColor="user13" Right="291" TabOrder="53" Top="380" Type="Rectangle" Width="206"></Shape>
		<Static Align="Center" BKColor="yellow" Height="24" Id="Static18" Left="86" Style="sty_lb_form_basic" TabOrder="52" Text="작업자" Top="381" VAlign="Middle" Width="71"></Static>
		<Shape BKColor="user12" Bottom="407" Height="26" Id="Shape13" Left="295" LineColor="user13" Right="501" TabOrder="55" Top="381" Type="Rectangle" Width="206"></Shape>
		<Static Align="Center" BKColor="yellow" Height="24" Id="Static19" Left="296" Style="sty_lb_form_basic" TabOrder="54" Text="휴대폰" Top="382" VAlign="Middle" Width="71"></Static>
		<Combo CodeColumn="CODE" DataColumn="CODE_NAME" Height="20" Id="cb_worker" InnerDataset="ds_worker" Left="160" OnChanged="cb_worker_OnChanged" TabOrder="56" Top="383" Width="128"></Combo>
		<Edit Border="Flat" Height="20" Id="ed_worker_hp" ImeMode="native" Left="370" LeftMargin="4" MaxLength="20" RightMargin="4" Style="sty_ipt_form" TabOrder="57" Top="384" Width="128"></Edit>
		<Static Align="Center" Color="red" Font="Tahoma,16,Bold" Height="15" Id="Static0" Left="151" TabOrder="44" Text="＊" Top="402" Width="15"></Static>
		<Grid AutoEnter="TRUE" AutoFitEndLine="Hide" BindDataset="ds_memo" BkColor2="default" BoldHead="true" Border="Flat" Bottom="578" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="99" Id="grd_memo" InputPanel="FALSE" Left="6" LineColor="user20" LineType="ExHORZ" OnCellDBLClick="grd_memo_OnCellDblClick" Right="584" RowHeight="20" Style="sty_grid" TabOrder="58" TabStop="true" Top="479" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="578">
			<contents>
				<format id="Default">
					<columns>
						<col width="24"/>
						<col width="65"/>
						<col width="46"/>
						<col width="70"/>
						<col width="230"/>
						<col width="123"/>
					</columns>
					<head>
						<cell col="0" color="user21" display="text" font="굴림,9"/>
						<cell col="1" color="user21" display="text" font="굴림,9" text="입력자"/>
						<cell col="2" color="user21" display="text" font="굴림,9" text="소속"/>
						<cell col="3" color="user21" display="text" font="굴림,9" text="작업구분"/>
						<cell col="4" color="user21" display="text" font="굴림,9" text="메모"/>
						<cell col="5" color="user21" display="text" font="굴림,9" text="입력일시"/>
					</head>
					<body>
						<cell align="center" col="0" colid="CHK" display="checkbox" edit="checkbox"/>
						<cell align="center" col="1" colid="CRNAM" display="text"/>
						<cell align="center" col="2" colid="BELONG" display="text"/>
						<cell align="center" col="3" colid="JOB_NAME" display="text"/>
						<cell col="4" colid="CONTENTS" display="text"/>
						<cell align="center" col="5" colid="CRDATE_TIME" display="text" Mask="####.##.##&#32;##:##:##"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Combo BindDataset="ds_combo" CodeColumn="CODE" Column="ST_TIME" DataColumn="CODE_NAME" Height="20" Id="cb_time" InnerDataset="ds_time" Left="297" TabOrder="59" Top="417" Width="59"></Combo>
		<Static Align="Center" BKColor="white" Height="15" Id="Static3" Left="354" Style="sty_lb_form_basic" TabOrder="60" Text="시" Top="420" VAlign="Middle" Width="15"></Static>
		<Combo BindDataset="ds_combo" CodeColumn="CODE" Column="ST_MINUTE" DataColumn="CODE_NAME" Height="20" Id="cb_minute" InnerDataset="ds_minute" Left="373" TabOrder="62" Top="417" Width="59"></Combo>
		<Static Align="Center" BKColor="white" Height="15" Id="Static20" Left="431" Style="sty_lb_form_basic" TabOrder="61" Text="분" Top="420" VAlign="Middle" Width="15"></Static>
		<Edit BindDataset="ds_list" Border="Flat" Enable="FALSE" Height="20" Id="cal_req_date" ImeMode="native" Left="370" LeftMargin="4" MaxLength="20" Readonly="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="63" Top="354" Width="128"></Edit>
		<Shape BKColor="user12" Bottom="287" Height="26" Id="Shape14" Left="295" LineColor="user13" Right="501" TabOrder="65" Top="261" Type="Rectangle" Width="206"></Shape>
		<Static Align="Center" BKColor="user1" Height="24" Id="Static4" Left="296" Style="sty_lb_form_basic" TabOrder="64" Text="업체연락처" Top="262" VAlign="Middle" Width="71"></Static>
		<Edit BindDataset="ds_list" Border="Flat" Column="LIFNR_OUT_TEL" Enable="FALSE" Height="20" Id="Edit0" ImeMode="native" Left="370" LeftMargin="4" MaxLength="20" Readonly="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="66" Top="264" Width="128"></Edit>
		<TextArea Enable="FALSE" Height="38" Id="ta_notice" Left="6" Readonly="TRUE" TabOrder="67" Text="※공지사항&#32;:&#32;공지사항은&#32;디비에&#32;맵핑된&#32;정보를&#32;불러와서&#32;표기한다" Top="582" Width="578"></TextArea>
	</Form>
	<Script><![CDATA[﻿﻿﻿﻿﻿﻿﻿﻿/*
 ******************************************************************************************
 * 기      능   : 일정확정 팝업
 * 작  성  자   : 강민석K
 * 작성  일자   : 2019.07.18
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
#include "LIB::commons.js";	// 공통 스크립트 
//=========================================================================================
// [ PART 1 ]
// Form에서 사용될 전역변수를 선언
// FORM에서 사용되는 전역변수는 대문자로 작성하며, F_XXX 의 형태를 갖도록 한다. 
//=========================================================================================
var userGroup = "";
var userAuth = "";//사용자 권한 - 안전, 서비스 구분을 위한 변수 추가 - 2019.07.26 강민석K
var F_EXP_DATE_EVENT_ENABLE = true;//저장된 일자가 오늘 이전 일자인 경우 cal_exp_date_OnChanged가 실행되지 않도록 변수 추가 - 2019.07.18 강민석K
var F_MODIFY_MODE = false;//이미 저장된 상태의 자료인지 여부(true : 수정저장 모드, false : 신규저장 모드)
var F_SAVE_INDC = false;
//=========================================================================================
// [ PART 2 ]
// Form Loading / Unloading 시 작업 정의
//=========================================================================================
function fn_OnLoadCompleted(obj) {
	//Form 로드 이벤트 맨 첫줄에 기술 
	gfn_initForm();
	
	ufn_initTimeCombo();
	
	userGroup = gfn_getUserGroup();
		
	//업체담당자(팀장)
	st_manager.Text = "담당자 : " + ds_list.GetColumn(ds_list.row, "J_1KFREPRE");
	
	//프로세스 안내문구 표시 : 구매외주인 경우 1번 프로세스를 '작업인지'로 표시
	if(ds_cond.GetColumn(0, "I_RA") == 'B'){
		st_process1.Text = "1번: 작업인지 → 2번: 작업요청 →";
		
		//구매외주는 비용처리가 프로세스가 없어져 화면 표시 수정 - 2019.08.01 강민석K
		st_process3.Text = " → 4번: 작업시작 → 5번: 작업완료";
		st_process1.Left = 62;
		st_process2.Left = 254;
		st_process3.Left = 334;
		
		//구매외주는 시방조회 기능 필요없음. - 2019.08.12 강민석K (2019.08.05 김정민C 확인)
		btn_sibang.Visible = false;
		btn_plan.Left = 6;
	}
	
	//초기 선택 호기
	ed_posids.Text = substr(ds_list.GetColumn(ds_list.row, "POSID"), 6, 9);
	
	//요청등록시간
	var reqRegTime = ds_list.GetColumn(ds_list.row, "REQ_REG_TIME");
	if(reqRegTime != null && reqRegTime != ""){
		ed_req_reg_time.Text = substr(reqRegTime, 0, 4) + "." + substr(reqRegTime, 4, 2)  + "." + substr(reqRegTime, 6, 2)
					   + " " + substr(reqRegTime, 8, 2) + ":" + substr(reqRegTime, 10, 2) + ":" + substr(reqRegTime, 12, 2);
	}
	
	
	//작업요청일
	var reqDate = ds_list.GetColumn(ds_list.row, "REQ_DATE");
	var reqTime = ds_list.GetColumn(ds_list.row, "REQ_TIME");
	cal_req_date.Text = substr(reqDate, 0, 4) + "." + substr(reqDate, 4, 2)  + "." + substr(reqDate, 6, 2)
					  + " " + substr(reqTime, 0, 2) + ":" + substr(reqTime, 2, 2);
	
	//작업예정일이 이미 저장된 경우 저장된 작업예정일 표시
	var expDate = ds_list.GetColumn(ds_list.row, "EXP_DATE");
	var expTime = ds_list.GetColumn(ds_list.row, "EXP_TIME");
	if(expDate != null && expDate != ""){
		F_MODIFY_MODE = true;
		F_EXP_DATE_EVENT_ENABLE = false;
		cal_exp_date.Value = expDate;
		// 시, 분 추가
		//trace("expTime : "+ expTime);
        
        cb_time.Value = substr(expTime, 0, 2);
		cb_minute.Value = substr(expTime, 2, 1) + "0";
	} else {
		cal_exp_date.Value = gfn_getCurrDate();
	}
	
	
	//작업시작이 된 경우 수정 불가
	var startDate = ds_list.GetColumn(ds_list.row, "START_DATE");
	
	//Trace(startDate);
	
	if(startDate != null && startDate != ""){
		btn_select.Enable = false;//호기선택버튼
		cb_worker.Enable = false;//작업자콤보
		ed_worker_hp.Enable = false;//휴대폰
		cal_exp_date.Enable = false;//작업예정일
		cb_time.Enable = false;
		cb_minute.Enable = false;
		div_btn.btn_save.Enable = false;//저장버튼
		
		F_EXP_DATE_EVENT_ENABLE = false;
		
		if(expDate == null || expDate == ""){
			cal_exp_date.Value = "";
		}
	}
	
	//저장 시 필요한 고정정보 세팅
	ds_save.DeleteAll();
	ds_save.AddRow();
		
	ds_save.SetColumn(0, "PSPID", ds_list.GetColumn(ds_list.row, "PSPID"));			//프로젝트번호
	ds_save.SetColumn(0, "POSID", ds_list.GetColumn(ds_list.row, "POSID"));			//호기번호
	ds_save.SetColumn(0, "JOB_CODE", ds_list.GetColumn(ds_list.row, "JOB_CODE"));	//외주작업코드
	ds_save.SetColumn(0, "LIFNR", ds_list.GetColumn(ds_list.row, "LIFNR_OUT"));		//외주업체코드
	ds_save.SetColumn(0, "GBN", ds_list.GetColumn(ds_list.row, "GBN"));				//설치/구매 구분(A:설치, B:구매)
	ds_save.SetColumn(0, "PROC_VER", ds_list.GetColumn(ds_list.row, "PROC_VER"));	//프로세스 버전
	
	fn_query();
}
/********************************************************************************
* 기      능   : 공통코드가 조회된 후의 Callback 함수 
********************************************************************************/
function fn_completeInit(sCode, sDsObj, sCodeType) {

}
/********************************************************************************
* 기      능   : form UnloadCompleted 
********************************************************************************/
function fn_OnUnloadCompleted(obj) {
	return gfn_isFormUnload(obj);
}
//=========================================================================================
// [ PART 3 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,form닫기)
//=========================================================================================
/********************************************************************************
* 기      능   : 조회
********************************************************************************/
function fn_query() {
	ds_cond1.DeleteAll();
	ds_cond1.AddRow();
	
	ds_cond1.SetColumn(0, "POSID", ds_list.GetColumn(ds_list.row, "PSPID"));
	ds_cond1.SetColumn(0, "POSID_1", ds_list.GetColumn(ds_list.row, "POSID"));
	ds_cond1.SetColumn(0, "JOB_CODE", ds_list.GetColumn(ds_list.row, "JOB_CODE"));
	ds_cond1.SetColumn(0, "LIFNR", ds_list.GetColumn(ds_list.row, "LIFNR_OUT"));
    //설치외주인 경우 메모관리 화면에서 설치, 업체는 디폴트로 체크하도록 하기 위해 설치/구매 구분값 추가 - 2019.09.19 강민석K (정태성K 요구사항)
    ds_cond1.SetColumn(0, "GBN", ds_list.GetColumn(ds_list.row, "GBN"));
	
	var rcvDataSet = "ds_pdf=ds_list10 ds_notice=ds_list ds_memo=ds_memo";
	
	tit_clearActionInfo();
	tit_addSearchActionInfo("ps01:PS0101001A_S8");//도면정보 조회
	tit_addSearchActionInfo("ps15:PS1505001P_S1");//공지사항 조회
	tit_addSearchActionInfo("ps15:PS1505001P_S2");//메모 조회
	tit_addSearchActionInfo("ps15:PS1505001P_S7");//작업자 콤보 조회
	tit_addSearchActionInfo("ps15:PS1505001A_S6");//사용자 권한 조회
	tit_callService(
          ""
        , ""
        , "ds_cond=ds_cond1"
        , "ds_pdf=ds_list10 ds_notice=ds_list ds_memo=ds_memo ds_worker=ds_worker ds_auth=ds_auth"
        , ""
        , "fn_afterQuery"
        , true);
}
/********************************************************************************
* 기      능   : 저장 
********************************************************************************/
function fn_save() {
	//작업자 선택 여부 체크
	if(cb_worker.Index == 0){
		gfn_openMsgWin("작업자가 선택되지 않았습니다.", "E", "", "");
		cb_worker.SetFocus();
		return;
	}
	
	//작업예정일 선택 여부 체크
	var expDate = cal_exp_date.Value;
	if(expDate == ""){
		gfn_openMsgWin("작업예정일이 선택되지 않았습니다.", "E", "", "");
		cal_exp_date.SetFocus();
		return;
	}
	
	//작업예정일 체크
	if(expDate < gfn_getCurrDate()){
		gfn_openMsgWin("금일보다 이전 일자로 저장할 수 없습니다.", "E", "", "");
		cal_exp_date.SetFocus();
		return;
	}
	
	var msg = "작업명 : " + ed_jobname.Text
	        + "\n호기 : " + ed_posids.Text
	        + "\n작업예정일시 : " + substr(expDate, 0, 4) + "-" + substr(expDate, 4, 2) + "-" + substr(expDate, 6, 2) +" "+ cb_time.Value + ":" + cb_minute.Value
	        + "\n저장하시겠습니까?";
	
	if(!gfn_openMsgWin(msg, "I", "C", "")){
		return;
	}
	
	for(var i = 0; i < ds_save.rowcount; i++){
		ds_save.SetColumn(i, "WORKER", cb_worker.Text);//작업자
		ds_save.SetColumn(i, "WORKER_ID", cb_worker.Value);//작업자 ID
		ds_save.SetColumn(i, "WORKER_HP", ed_worker_hp.Text);//휴대폰
		ds_save.SetColumn(i, "EXP_DATE", cal_exp_date.Value);//작업예정일
		ds_save.SetColumn(i, "EXP_TIME", cb_time.Value + cb_minute.Value + "00");//작업예정시간
	}
	
	//trace("시간 : "+ cb_time.Value + cb_minute.Value + "00");

	tit_clearActionInfo();
	tit_addMultiActionInfo("ps15:PS1505001P_I3");
	tit_callService(
		  ""
		, ""
		, "ds_save=ds_save"
		, ""
		, ""
		, "fn_afterSave"
		, ""
		, ""
		, true);
}
/********************************************************************************
* 기      능   : 닫기  
********************************************************************************/
function fn_close() {

	//parent.F_AUTO_QUERY = true;
	//parent.fn_query();
	
	close();
}
//=========================================================================================
// [ PART 4]
// Callback 함수 정의 : callback 함수명은 메인 함수의 fn_xxxx() 에서 xxxx 부분은 fn_afterXXXX()
// 형태가 되도록 작성 
//=========================================================================================
/********************************************************************************
* 기      능   : 조회 Callback  
********************************************************************************/
function fn_afterQuery(errCode, errMsg) {
	st_site_nm.Text = " " + ds_list.GetColumn(ds_list.row, "ZSITE_NM");//Static 컨트롤에 왼쪽여백이 없어서 프로젝트명을 DataSet을 바인딩하지 않고 직접 표시함. - 2019.07.18 강민석K
	
	//작업자 콤보에 '-선택-' 추가
	gfn_insertEmptyRow(ds_worker, G_CODE_SELECT);
	
	//작업자 콤보를 로그인ID로 세팅 - 없으면 index 0
	if(cb_worker.Index == -1){
		var nIndex = -1;
		if(F_MODIFY_MODE == true){
			//수정모드인 경우 - 기존에 저장된 정보로 세팅
			nIndex = ds_worker.FindRow("CODE", ds_list.GetColumn(ds_list.row, "EXP_ID"));
			if(nIndex == -1){
				cb_worker.Index = 0;
			}else{
				if(cb_worker.Enable == true){
					//수정가능 상태(작업시작이 되지 않은 상태)
					cb_worker.Index = nIndex;
				}else{
					//수정불가능 상태(작업시작이 된 상태)의 수정모드이면
					//안전교육 이수여부, 퇴사여부와 관계없이 무조건 저장된 이름으로 표시한다. - 2019.07.24 강민석K (송광용D 협의사항)
					//ex) 몇년 전에 완료된 작업을 조회했을 경우
					ds_worker.InsertRow(0);
					ds_worker.SetColumn(0, "CODE", ds_list.GetColumn(ds_list.row, "EXP_ID"));
					ds_worker.SetColumn(0, "CODE_NAME", ds_list.GetColumn(ds_list.row, "EXP_NAME"));
					
					cb_worker.Index = 0;
				}
			}
			
			ed_worker_hp.Text = ds_list.GetColumn(ds_list.row, "EXP_HP");
			
		}else{
			//신규모드인 경우 - 작업자 콤보를 로그인ID로 세팅 - 없으면 index 0
			nIndex = ds_worker.FindRow("CODE", G_USER_ID);
			if(nIndex == -1){
				cb_worker.Index = 0;
			}else{
				cb_worker.Index = nIndex;
				ed_worker_hp.Text = ds_worker.GetColumn(nIndex, "USERMBPN");
			}
		}
	}
	
	ta_notice.Text = "※공지사항 : " + ds_notice.GetColumn(0, "CONTENTS");
	
	//서비스(ZPS12), 안전(ZPS36) 팀은 조회만 가능
	var bOut_Lifnr = false;//외주업체 여부 추가 - 설치협력사면서 외주업체인 경우가 있어서 변수 추가 - 2019.09.27 강민석K
    for(var i = 0; i < ds_auth.rowcount; i++){
		userAuth = ds_auth.GetColumn(i, "AUTH");
		
		//설치협력사(ZPS05), 영업(ZPS08) 팀도 조회만 가능하도록 추가 - 2019.09.27 강민석K
		//if(userAuth == "ZPS12" || userAuth == "ZPS36"){
		if(userAuth == "ZPS12" || userAuth == "ZPS36" || userAuth == "ZPS05" || userAuth == "ZPS08"){
			div_btn.btn_save.Enable = false;//저장버튼
			btn_select.Enable = false;//호기선택버튼
			cb_worker.Enable = false;//작업자
			ed_worker_hp.Enable = false;//휴대폰
			cal_exp_date.Enable = false;//작업예정일
			cb_time.Enable = false;
			cb_minute.Enable = false;
		}
		
		if(userAuth == "ZPS13"){
			bOut_Lifnr = true;
		}
    }
    
   
    //설치협력사면서 외주업체인 경우가 있어서 추가 - 2019.09.27 강민석K
	if(bOut_Lifnr == true){
		var startDate = ds_list.GetColumn(ds_list.row, "START_DATE");
		
		if(startDate == null || startDate == ""){
			div_btn.btn_save.Enable = true;//저장버튼
			btn_select.Enable = true;//호기선택버튼
			cb_worker.Enable = true;//작업자
			ed_worker_hp.Enable = true;//휴대폰
			cal_exp_date.Enable = true;//작업예정일
			cb_time.Enable = true;
			cb_minute.Enable = true;
		}
	}
}
/********************************************************************************
* 기      능   : 저장 Callback  
********************************************************************************/
function fn_afterSave(errCode, errMsg) {
	if(errCode != 0){
		gfn_showMsg("CE00001");
	}else{
		gfn_showMsg("CI00003");
		
		parent.F_AUTO_QUERY = true;
		parent.fn_query();
		close();
	}
}
//=========================================================================================
// [ PART 5 ]
// Detail Process Event 정의 ( User Define function )
// 사용자 정의 함수는 ufn_xxxx() 형태로 작성 
//=========================================================================================
/********************************************************************************
* 기      능   : 사용자 정의 함수  
********************************************************************************/
function ufn_userfunction() {

}

/********************************************************************************
* 기      능   : 시간, 분 콤보 초기화 및 세팅
********************************************************************************/
function ufn_initTimeCombo() {
	//작업예정일시 - 시간 콤보 초기화
	ds_time.DeleteAll();
	for(var i = 0; i < 24; i++){
		ds_time.AddRow();
		
		if(i < 10){
			ds_time.SetColumn(i, "CODE", "0" + ToString(i));
			ds_time.SetColumn(i, "CODE_NAME", "0" + ToString(i));
		}else{
			ds_time.SetColumn(i, "CODE", ToString(i));
			ds_time.SetColumn(i, "CODE_NAME", ToString(i));
		}
	}
	
	//작업종료 - 분 콤보 초기화
	ds_minute.DeleteAll();
	for(var i = 0; i < 6; i++){
		ds_minute.AddRow();
		
		if(i == 0){
			ds_minute.SetColumn(i, "CODE", "00");
			ds_minute.SetColumn(i, "CODE_NAME", "00");
		}else{
			ds_minute.SetColumn(i, "CODE", ToString(i) + "0");
			ds_minute.SetColumn(i, "CODE_NAME", ToString(i) + "0");
		}
	}
	
	//현재 시, 분으로 콤보 세팅
	var curDateTime = GetDate();
	cb_time.Value = substr(curDateTime, 8, 2);
	
	//분 콤보는 디폴트로 00으로 세팅 - 2019.09.19 강민석K (고범석K 요구사항)
	//cb_minute.Value = substr(curDateTime, 10, 1) + "0";
	cb_minute.Value = "00";
}

//=========================================================================================
// [ PART 6 ]
// component Event 정의 : 각 Component 별 이벤트 
//=========================================================================================
/********************************************************************************
* 기      능   : 그리드 헤더 클릭시 정렬 처리 
********************************************************************************/
function grd_list_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
{
	if ( nCell == 0 ) {
		// 그리드 표시할 컬럼 선택 
		gfn_selectGridCol(obj);
	} else {
		// 그리드 정렬 처리 
		gfn_sortGrid(obj,nCell);
	}
}
/********************************************************************************
* 기      능   : 데이터셋 값 변경 시 - Flag 처리 
********************************************************************************/
function ds_list_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{
	gfn_changeFlag( obj, strColumnID, nRow, "FLAG" );
}
/********************************************************************************
* 기      능   : 시방조회 버튼 클릭 시 - 시방조회 화면 팝업
********************************************************************************/
function btn_sibang_OnClick(obj)
{
	var arg  = "PSPID=" + quote(ds_list.GetColumn(ds_list.row, "PSPID"));//프로젝트번호
		arg += " POSID=" + quote(st_posid.Text);//호기번호
		arg += " SITE_NM=" + quote(st_site_nm.Text);//프로젝트명
		arg += " JOB_CODE=" + quote(ds_list.GetColumn(ds_list.row, "JOB_CODE"));//외주작업코드
	gfn_openPopup("PS1505001E", true, arg);
}
/********************************************************************************
* 기      능   : 도면 버튼 클릭 시 - 도면 화면 팝업
********************************************************************************/
function btn_plan_OnClick(obj)
{
	if(length(ds_pdf.getColumn(0, "UDATE")) > 0){
		fn_createWait("", this);
		//==========================================================================================================
		var FileName = ds_pdf.getColumn(0, "POSID") + '.pdf';
		//var FileName = '173395.pdf';//테스트용
		var FilePath = "c:\\Temp";
		var FileExec = "c:\\Temp\\" + FileName;
        
        //trace("FileName : [" + FileName + "]");
        //trace("FilePath : [" + FilePath + "]");
        //trace("FileExec : [" + FileExec + "]");
        
		var rMsg = tit_fileRead(
			  httpFile
			, "PDM"		// 저장 디렉토리
			, FileName	// 서버에서 전송받을 이름
			, FilePath	// 로컬 경로
			, FileName	// 로컬 파일명
		);
		fn_destroyWait();
		
		if(rMsg[0] == "E"){
			if(length(trim(rMsg[1])) > 0){
				gfn_showAlert("CW10025", rMsg[1]);
			}else{
				gfn_showAlert("CW10025", "파일 다운로드에 실패하였습니다.");
			}
		}else{
			ExecShell(FileExec);
		}
		//==========================================================================================================
	}else{
		gfn_alert("해당 프로젝트는 PDF 도면이 없습니다.\n\n(PDM에서 조회하시기 바랍니다)");
    }
}
/********************************************************************************
* 기      능   : 선택하기 버튼 클릭 시 - 호기선택 화면 팝업
********************************************************************************/
function btn_select_OnClick(obj)
{
	var arg  = "POSID=" + quote(ed_posids.Text);
	    arg += " MAIN=" + quote(ds_list.GetColumn(ds_list.row, "POSID"));
	gfn_openPopup("PS1505001D", true, arg);
}
/********************************************************************************
* 기      능   : 선택하기 Callback - 호기선택 화면에서 선택한 호기 전달받기
********************************************************************************/
function fn_afterSelect(obj){
	ds_save.DeleteAll();
	
	var arrObj = split(obj, ",");
	var display = "";//화면에 표시할 호기 값
	
	for(var i = 0; i < length(arrObj); i++){
		ds_save.AddRow();
		
		var posid = trim(arrObj[i]);			//호기번호(9자리 - 123456L01)
		var pspid = substr(posid, 0, 6);		//프로젝트번호(6자리 - 123456)
		var posid_short = substr(posid, 6, 3);	//호기번호(3자리 - L01)
		
		ds_save.SetColumn(i, "PSPID", pspid);
		ds_save.SetColumn(i, "POSID", posid);
		ds_save.SetColumn(i, "JOB_CODE", ds_list.GetColumn(ds_list.row, "JOB_CODE"));	//외주작업코드
		ds_save.SetColumn(i, "LIFNR", ds_list.GetColumn(ds_list.row, "LIFNR_OUT"));		//외주업체코드
		ds_save.SetColumn(i, "GBN", ds_list.GetColumn(ds_list.row, "GBN"));				//설치/구매 구분(A:설치, B:구매)
		ds_save.SetColumn(i, "PROC_VER", ds_list.GetColumn(ds_list.row, "PROC_VER"));	//프로세스 버전
		
		display += posid_short + ", ";
	}
	
	display = substr(display, 0, length(display) - 2);
	ed_posids.Text = display;
}
/********************************************************************************
* 기      능   : 메모추가 버튼 클릭 시 - 메모관리 화면 팝업
********************************************************************************/
function btn_add_OnClick(obj)
{
	var arg  = "CRNAM=" + quote("");//입력자
		//알림 대상자 추가 - 2019.09.18 강민석K
		arg += " PM_ID=" + quote(ds_list.GetColumn(ds_list.row, "PM_ID"));//설치PM
		arg += " SERVICE_HP=" + quote(ds_list.GetColumn(ds_list.row, "SERVICE_HP"));//서비스담당자 - MMS에 푸시를 보낼 수 없어 서비스담당자는 문자로 발송하기로 함. 2019.09.19 강민석K(PM리뷰 회의 결정)
		arg += " SALES_ID=" + quote(ds_list.GetColumn(ds_list.row, "SALES_ID"));//영업담당자
		arg += " OUT_TEAM_ID=" + quote(ds_list.GetColumn(ds_list.row, "OUT_TEAM_ID"));//외주업체 팀장
		arg += " WORKER_ID=" + quote(ds_list.GetColumn(ds_list.row, "WORKER_ID"));//작업자1
		arg += " WORKER_ID2=" + quote(ds_list.GetColumn(ds_list.row, "WORKER_ID2"));//작업자2
	gfn_openPopup("PS1505001C", true, arg);
}
/********************************************************************************
* 기      능   : 삭제 버튼 클릭 시 - 선택한 메모 삭제
********************************************************************************/
function btn_delete_OnClick(obj)
{
	//항목 선택 여부 체크
	if(ds_memo.FindRow("CHK", "1") == -1){
		gfn_showMsg("CW00046");
		return;
	}
	
	//메모 삭제는 1건씩만 가능
	ds_memo.Filter("CHK == '1'");
	var nChkCnt = ds_memo.rowcount;
	ds_memo.UnFilter();
	
	if(nChkCnt > 1){
		gfn_openMsgWin("메모 삭제는 1건씩만 가능합니다.", "I", "", "");
		return;
	}
	
	//입력자와 로그인 사용자가 같은지 체크
	if(userGroup != "40"){//단, 관리팀 권한인 경우 삭제 가능 - 고범석K 요청사항
		for(var i = 0; i < ds_memo.rowcount; i++){
			if(ds_memo.GetColumn(i, "CHK") == "1" && ds_memo.GetColumn(i, "CRID") != G_USER_ID){
				gfn_openMsgWin("메모 삭제는 등록자만 가능합니다.", "I", "", "");
				return;
			}
		}
	}
	
	//삭제 여부 확인
	if(!gfn_openMsgWin("선택한 메모를 삭제 하시겠습니까?", "I", "C", "")){
		return;
	}
	
	ds_memo_del.ClearData();
	ds_memo_del.AddRow();
	
	// SEQ_LIST 만들기(메모 다중 선택 삭제) - 단건 삭제로 바꿨지만 실제 삭제 로직은 다중으로 남겨둔다
	var sSeqList = "";
	for(var j = 0; j < ds_memo.rowcount; j++){
		if(ds_memo.GetColumn(j, "CHK") == "1"){
			ds_memo_del.SetColumn(0, "PSPID", ds_list.GetColumn(ds_list.row, "PSPID"));
			ds_memo_del.SetColumn(0, "POSID", ds_list.GetColumn(ds_list.row, "POSID"));
			ds_memo_del.SetColumn(0, "LIFNR", ds_list.GetColumn(ds_list.row, "LIFNR_OUT"));
			
			sSeqList += "'" + ds_memo.GetColumn(j, "SEQ") + "',";
			//trace("memo SEQ : " + ds_memo.GetColumn(j, "SEQ"));
		}
	}
	sSeqList = "(" + substr(sSeqList, 0, length(sSeqList) - 1) + ")";
	
	qry= " AND SEQ IN " + sSeqList;
	args = " SQRY=" + quote(qry);
	
	tit_clearActionInfo();
	tit_addSearchActionInfo("ps15:PS1505001P_U1");//메모 삭제
	tit_callService(
		  ""
		, ""
	    , "ds_memo_del=ds_memo_del"
	    , ""
	    , args
	    , ""
	    , ""
	    , ""
	    , true);
	
	fn_query();
}
/********************************************************************************
* 기      능   : 그리드 더블클릭 시 - 선택한 메모 상세 표시
********************************************************************************/
function grd_memo_OnCellDblClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
	if(nCell != 0){
		var arg  = "CRNAM=" + quote(ds_memo.GetColumn(nRow, "CRNAM"));//입력자
		    arg += " BELONG=" + quote(ds_memo.GetColumn(nRow, "BELONG"));//소속
		    arg += " CONTENTS=" + quote(ds_memo.GetColumn(nRow, "CONTENTS_ORIG"));//내용
			arg += " ALM_INDC=" + quote(ds_memo.GetColumn(nRow, "ALM_INDC"));//알림대상
		    //arg += " CRID=" + quote(ds_memo.GetColumn(nRow, "CRID"));//입력자ID
		    arg += " PSPID=" + quote(ds_cond1.getColumn(0, "POSID"));//프로젝트 번호
            arg += " POSID=" + quote(ds_cond1.getColumn(0, "POSID_1"));//호기 번호
            arg += " LIFNR=" + quote(ds_memo.GetColumn(0, "MEMO_LIFNR"));//업체코드
            arg += " SEQ=" + quote(ds_memo.GetColumn(nRow, "SEQ"));//SEQ
		gfn_openPopup("PS1505001C", true, arg);
	}
}
/********************************************************************************
* 기      능   : 작업예정일 변경 시 - 과거 일자 선택 불가
********************************************************************************/
function cal_exp_date_OnChanged(obj,strOldText,strNewText)
{
	if(F_EXP_DATE_EVENT_ENABLE == true){
		if(strNewText < gfn_getCurrDate()){
			gfn_openMsgWin("금일보다 이전 일자로 선택할 수 없습니다.", "E", "", "");
			cal_exp_date.Value = gfn_getCurrDate();
			cal_exp_date.SetFocus();
		}
	}else{
		F_EXP_DATE_EVENT_ENABLE = true;
	}
}
/********************************************************************************
* 기      능   : 작업자 변경 시 - 작업자의 휴대폰 번호 표시
********************************************************************************/
function cb_worker_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	ed_worker_hp.Text = ds_worker.GetColumn(nNewIndex, "USERMBPN");
}]]></Script>
</Window>