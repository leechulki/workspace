<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="562" Id="PS1505002A" Left="8" OnLoadCompleted="fn_OnLoadCompleted" OnUnloadCompleted="fn_OnUnloadCompleted" PidAttrib="7" Title="기타외주&#32;작업지시서(업체용)" Top="8" Ver="1.0" Width="978" WorkArea="true">
		<Datasets>
			<Dataset CanColumnChange="ds_cond_CanColumnChange" DataSetType="Dataset" Id="ds_cond">
				<Contents>
					<colinfo id="LIFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="SUP_DTF" size="256" summ="default" type="STRING"/>
					<colinfo id="SUP_DTT" size="256" summ="default" type="STRING"/>
					<colinfo id="PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZACTSS" size="256" summ="default" type="STRING"/>
					<colinfo id="USER_CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="USER_GRUP" size="256" summ="default" type="STRING"/>
					<colinfo id="PERIOD" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZPMNUM" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZLIFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="I_RA" size="256" summ="default" type="STRING"/>
					<colinfo id="CONFIRM_GUBUN" size="256" summ="default" type="STRING"/>
					<colinfo id="CHARGE" size="256" summ="default" type="STRING"/>
					<colinfo id="WORK_GUBUN" size="256" summ="default" type="STRING"/>
					<colinfo id="PROCESS" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
					<colinfo id="MEMO_SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="SVC_YN" size="256" summ="default" type="STRING"/>
					<colinfo id="RD_CHK" size="256" summ="default" type="STRING"/>
					<record>
						<CHARGE></CHARGE>
						<CONFIRM_GUBUN></CONFIRM_GUBUN>
						<I_RA></I_RA>
						<LIFNR></LIFNR>
						<MEMO_SEQ></MEMO_SEQ>
						<PERIOD></PERIOD>
						<POSID></POSID>
						<PROCESS></PROCESS>
						<PSPID></PSPID>
						<RD_CHK></RD_CHK>
						<SUP_DTF></SUP_DTF>
						<SUP_DTT></SUP_DTT>
						<SVC_YN></SVC_YN>
						<USER_CODE></USER_CODE>
						<USER_GRUP></USER_GRUP>
						<WORK_GUBUN></WORK_GUBUN>
						<ZZACTSS></ZZACTSS>
						<ZZLIFNR></ZZLIFNR>
						<ZZPMNUM></ZZPMNUM>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_period">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE>A</CODE>
						<CODE_NAME>착공예정일</CODE_NAME>
					</record>
					<record>
						<CODE>B</CODE>
						<CODE_NAME>작업요청일</CODE_NAME>
					</record>
					<record>
						<CODE>C</CODE>
						<CODE_NAME>투입일정일</CODE_NAME>
					</record>
					<record>
						<CODE>D</CODE>
						<CODE_NAME>작업시작일</CODE_NAME>
					</record>
					<record>
						<CODE>E</CODE>
						<CODE_NAME>작업완료일</CODE_NAME>
					</record>
					<record>
						<CODE>F</CODE>
						<CODE_NAME>비용청구일</CODE_NAME>
					</record>
					<record>
						<CODE>G</CODE>
						<CODE_NAME>비용처리일</CODE_NAME>
					</record>
					<record>
						<CODE>H</CODE>
						<CODE_NAME>준공예정일</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_lifnr_cd">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
					<colinfo id="SORTL" size="256" type="STRING"/>
					<colinfo id="LOEVM" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_zzactss">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list" OnColumnChanged="ds_list_OnColumnChanged">
				<Contents>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZACTSS" size="256" summ="default" type="STRING"/>
					<colinfo id="PM_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="PM_NAME" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSITE_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSITE_NM_SMS" size="256" summ="default" type="STRING"/>
					<colinfo id="SALES_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="DONG" size="256" summ="default" type="STRING"/>
					<colinfo id="PRO_R" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNR_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="NAMET" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZCHAKD" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZCOMP2" size="256" summ="default" type="STRING"/>
					<colinfo id="JOB_CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="JOB_NAME" size="256" summ="default" type="STRING"/>
					<colinfo id="START_DAY" size="256" summ="default" type="STRING"/>
					<colinfo id="END_DAY" size="256" summ="default" type="STRING"/>
					<colinfo id="CONFIRM_GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNR_OUT" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNR_OUT_NAME" size="256" summ="default" type="STRING"/>
					<colinfo id="J_1KFREPRE" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNR_OUT_TEL" size="256" summ="default" type="STRING"/>
					<colinfo id="OUT_TEAM_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="REQ_DATE" size="256" summ="default" type="STRING"/>
					<colinfo id="REQ_TIME" size="256" summ="default" type="STRING"/>
					<colinfo id="REQ_NAME" size="256" summ="default" type="STRING"/>
					<colinfo id="REQ_REG_TIME" size="256" summ="default" type="STRING"/>
					<colinfo id="EXP_NAME" size="256" summ="default" type="STRING"/>
					<colinfo id="EXP_DATE" size="256" summ="default" type="STRING"/>
					<colinfo id="EXP_TIME" size="256" summ="default" type="STRING"/>
					<colinfo id="EXP_HP" size="256" summ="default" type="STRING"/>
					<colinfo id="START_DATE" size="256" summ="default" type="STRING"/>
					<colinfo id="START_TIME" size="256" summ="default" type="STRING"/>
					<colinfo id="PLAN_DATE" size="256" summ="default" type="STRING"/>
					<colinfo id="PLAN_TIME" size="256" summ="default" type="STRING"/>
					<colinfo id="WORKER_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="WORKER_HP" size="256" summ="default" type="STRING"/>
					<colinfo id="WORKER_ID2" size="256" summ="default" type="STRING"/>
					<colinfo id="WORKER_HP2" size="256" summ="default" type="STRING"/>
					<colinfo id="COM_DATE" size="256" summ="default" type="STRING"/>
					<colinfo id="COM_TIME" size="256" summ="default" type="STRING"/>
					<colinfo id="CHARGE_DATE" size="256" summ="default" type="STRING"/>
					<colinfo id="CHECK_CHARGE" size="256" summ="default" type="STRING"/>
					<colinfo id="STATE" size="256" summ="default" type="STRING"/>
					<colinfo id="STATE_CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="REQ_BC_PM_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="REQ_BN_MG_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="REQ_BN_TM_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="APPR_DAT" size="256" summ="default" type="STRING"/>
					<colinfo id="APPR_FINA_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="CHARGE_DAT" size="256" summ="default" type="STRING"/>
					<colinfo id="MEMO_CRNAM" size="256" summ="default" type="STRING"/>
					<colinfo id="MEMO_BELONG" size="256" summ="default" type="STRING"/>
					<colinfo id="MEMO_ALM_INDC" size="256" summ="default" type="STRING"/>
					<colinfo id="CONTENTS" size="256" summ="default" type="STRING"/>
					<colinfo id="CONTENTS_ORIG" size="256" summ="default" type="STRING"/>
					<colinfo id="RTN_CRNAM" size="256" summ="default" type="STRING"/>
					<colinfo id="RTN_BELONG" size="256" summ="default" type="STRING"/>
					<colinfo id="RTN_CONTENTS" size="256" summ="default" type="STRING"/>
					<colinfo id="RTN_CONTENTS_ORIG" size="256" summ="default" type="STRING"/>
					<colinfo id="PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="NAMET_HP" size="256" summ="default" type="STRING"/>
					<colinfo id="NAMET_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="PM_HP" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="PROC_VER" size="256" summ="default" type="STRING"/>
					<colinfo id="CHASU" size="256" summ="default" type="STRING"/>
					<colinfo id="CONTRCT" size="256" summ="default" type="STRING"/>
					<colinfo id="SERVICE_HP" size="256" summ="default" type="STRING"/>
					<colinfo id="DIPBXNUMB" size="256" summ="default" type="STRING"/>
					<colinfo id="PIC_UPLOAD_YN" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_zzpmnum_cd">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_confirm_gubun">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE>0</CODE>
						<CODE_NAME>-&#32;전체&#32;-</CODE_NAME>
					</record>
					<record>
						<CODE>1</CODE>
						<CODE_NAME>취소</CODE_NAME>
					</record>
					<record>
						<CODE>2</CODE>
						<CODE_NAME>변경</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_zzlifnr_cd">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZACTSS" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_workgubun">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="SORT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_process">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_pic_cmmt">
				<Contents>
					<colinfo id="COMMNT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond_check">
				<Contents>
					<colinfo id="LIFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
					<colinfo id="JOB_CODE" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond_p">
				<Contents>
					<colinfo id="GUBUN" size="256" summ="default" type="STRING"/>
					<colinfo id="GUBUN2" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN" size="256" summ="default" type="STRING"/>
					<record>
						<GBN/>
						<GUBUN></GUBUN>
						<GUBUN2></GUBUN2>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list_p" OnColumnChanged="ds_list_OnColumnChanged">
				<Contents>
					<colinfo id="ROWNUM" size="256" summ="default" type="STRING"/>
					<colinfo id="PSPID" size="17" summ="default" type="STRING"/>
					<colinfo id="POSID" size="105" summ="default" type="STRING"/>
					<colinfo id="ZSITE_NM" size="17" summ="default" type="STRING"/>
					<colinfo id="ZSPEC1" size="6" summ="default" type="STRING"/>
					<colinfo id="ZSPEC2" size="6" summ="default" type="STRING"/>
					<colinfo id="WRKLFN" size="256" summ="default" type="STRING"/>
					<colinfo id="WRKLFN_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="ADDR" size="256" summ="default" type="STRING"/>
					<colinfo id="REP" size="256" summ="default" type="STRING"/>
					<colinfo id="PM" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZACTSS" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="TITLE" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list_tmp" OnColumnChanged="ds_list_OnColumnChanged">
				<Contents>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZACTSS" size="256" summ="default" type="STRING"/>
					<colinfo id="PM_NAME" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSITE_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="DONG" size="256" summ="default" type="STRING"/>
					<colinfo id="PRO_R" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNR_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="NAMET" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZCHAKD" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZCOMP2" size="256" summ="default" type="STRING"/>
					<colinfo id="JOB_CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="JOB_NAME" size="256" summ="default" type="STRING"/>
					<colinfo id="START_DAY" size="256" summ="default" type="STRING"/>
					<colinfo id="END_DAY" size="256" summ="default" type="STRING"/>
					<colinfo id="CONFIRM_GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNR_OUT" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNR_OUT_NAME" size="256" summ="default" type="STRING"/>
					<colinfo id="J_1KFREPRE" size="256" summ="default" type="STRING"/>
					<colinfo id="REQ_DATE" size="256" summ="default" type="STRING"/>
					<colinfo id="REQ_TIME" size="256" summ="default" type="STRING"/>
					<colinfo id="REQ_NAME" size="256" summ="default" type="STRING"/>
					<colinfo id="REQ_REG_TIME" size="256" summ="default" type="STRING"/>
					<colinfo id="EXP_NAME" size="256" summ="default" type="STRING"/>
					<colinfo id="EXP_DATE" size="256" summ="default" type="STRING"/>
					<colinfo id="EXP_TIME" size="256" summ="default" type="STRING"/>
					<colinfo id="EXP_HP" size="256" summ="default" type="STRING"/>
					<colinfo id="START_DATE" size="256" summ="default" type="STRING"/>
					<colinfo id="START_TIME" size="256" summ="default" type="STRING"/>
					<colinfo id="PLAN_DATE" size="256" summ="default" type="STRING"/>
					<colinfo id="PLAN_TIME" size="256" summ="default" type="STRING"/>
					<colinfo id="WORKER_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="WORKER_HP" size="256" summ="default" type="STRING"/>
					<colinfo id="WORKER_ID2" size="256" summ="default" type="STRING"/>
					<colinfo id="WORKER_HP2" size="256" summ="default" type="STRING"/>
					<colinfo id="COM_DATE" size="256" summ="default" type="STRING"/>
					<colinfo id="COM_TIME" size="256" summ="default" type="STRING"/>
					<colinfo id="CHARGE_DATE" size="256" summ="default" type="STRING"/>
					<colinfo id="CHECK_CHARGE" size="256" summ="default" type="STRING"/>
					<colinfo id="STATE" size="256" summ="default" type="STRING"/>
					<colinfo id="STATE_CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="APPR_DAT" size="256" summ="default" type="STRING"/>
					<colinfo id="MEMO_CRNAM" size="256" summ="default" type="STRING"/>
					<colinfo id="MEMO_BELONG" size="256" summ="default" type="STRING"/>
					<colinfo id="MEMO_ALM_INDC" size="256" summ="default" type="STRING"/>
					<colinfo id="CONTENTS" size="256" summ="default" type="STRING"/>
					<colinfo id="PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="NAMET_HP" size="256" summ="default" type="STRING"/>
					<colinfo id="PM_HP" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="PROC_VER" size="256" summ="default" type="STRING"/>
					<colinfo id="CHASU" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_charge">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME>-&#32;전체&#32;-</CODE_NAME>
					</record>
					<record>
						<CODE>D</CODE>
						<CODE_NAME>업체요청</CODE_NAME>
					</record>
					<record>
						<CODE>E</CODE>
						<CODE_NAME>지사결재(PM)</CODE_NAME>
					</record>
					<record>
						<CODE>F</CODE>
						<CODE_NAME>지사결재(지사장)</CODE_NAME>
					</record>
					<record>
						<CODE>G</CODE>
						<CODE_NAME>지사결재(팀장)</CODE_NAME>
					</record>
					<record>
						<CODE>C</CODE>
						<CODE_NAME>전표처리</CODE_NAME>
					</record>
					<record>
						<CODE>H</CODE>
						<CODE_NAME>회계부승인</CODE_NAME>
					</record>
					<record>
						<CODE>I</CODE>
						<CODE_NAME>비용지급</CODE_NAME>
					</record>
					<record>
						<CODE>Z</CODE>
						<CODE_NAME>반려</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_auth">
				<Contents>
					<colinfo id="AUTH" size="256" summ="default" type="STRING"/>
					<colinfo id="AUTH_NAME" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_temno">
				<Contents>
					<colinfo id="TEMNO" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_days">
				<Contents>
					<colinfo id="DAYS" size="256" type="STRING"/>
					<record>
						<DAYS></DAYS>
					</record>
				</Contents>
			</Dataset>
		</Datasets>
		<Shape BKColor="user0" Bottom="144" Height="144" Id="Shape0" Left="0" LineColor="user1" Right="978" TabOrder="1" Top="0" Type="Rectangle" Width="978"></Shape>
		<Static Align="Right" Border="Flat" Height="22" Id="Static9" Left="551" Style="sty_ipt_search" TabOrder="25" Top="29" VAlign="Middle" Width="158"></Static>
		<Static Align="Right" Height="20" Id="st_pspid" Left="6" Style="sty_lb_search" TabOrder="4" Text="Proj&#32;No&#32;" Top="53" VAlign="Middle" Width="88"></Static>
		<Edit BindDataset="ds_cond" Border="Flat" CheckLength="Byte" Column="PSPID" Height="20" Id="ed_pjt" ImeMode="english" Left="96" MaxLength="6" Style="sty_ipt_search" TabOrder="22" Top="54" UpperOnly="TRUE" Width="158"></Edit>
		<Static Align="Right" Height="20" Id="st_pm" Left="299" Style="sty_lb_search" TabOrder="9" Text="설치PM&#32;" Top="30" VAlign="Middle" Width="80"></Static>
		<Static Align="Right" Height="20" Id="st_zzactss" Left="299" Style="sty_lb_search" TabOrder="2" Text="사무소&#32;" Top="6" VAlign="Middle" Width="80"></Static>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="CODE" Column="ZZACTSS" DataColumn="CODE_NAME" Height="20" Id="cb_zzactss" InnerDataset="ds_zzactss" Left="379" OnChanged="cb_zzactss_OnChanged" Style="sty_ipt_search" TabOrder="3" Top="5" Width="90"></Combo>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="CODE" Column="ZZPMNUM" DataColumn="CODE_NAME" Height="20" Id="cb_zzpmnum" InnerDataset="ds_zzpmnum_cd" Left="379" Style="sty_ipt_search" TabOrder="10" Top="29" Width="90"></Combo>
		<Static Align="Right" Height="20" Id="st_zzpmnum" Left="470" Style="sty_lb_search" TabOrder="5" Text="설치협력사&#32;" Top="6" VAlign="Middle" Width="80"></Static>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="CODE" Column="LIFNR" DataColumn="CODE_NAME" Height="20" Id="cb_lifnr" InnerDataset="ds_lifnr_cd" Left="550" Style="sty_ipt_search" TabOrder="6" Top="5" Width="160"></Combo>
		<Static Align="Right" Height="20" Id="st_zzlifnr" Left="712" Style="sty_lb_search" TabOrder="7" Text="외주작업구분&#32;" Top="6" VAlign="Middle" Width="80"></Static>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="CODE" Column="WORK_GUBUN" DataColumn="CODE_NAME" DisplayRowCnt="24" Height="20" Id="cb_workgubun" InnerDataset="ds_workgubun" Left="792" OnChanged="cb_workgubun_OnChanged" Style="sty_ipt_search" TabOrder="8" Top="5" Width="122"></Combo>
		<Static Align="Right" Height="20" Id="Static5" Left="712" Style="sty_lb_search" TabOrder="11" Text="외주업체&#32;" Top="30" VAlign="Middle" Width="80"></Static>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="CODE" Column="ZZLIFNR" DataColumn="CODE_NAME" Height="20" Id="cb_zzlifnr" InnerDataset="ds_zzlifnr_cd" Left="792" Style="sty_ipt_search" TabOrder="12" Top="29" Width="122"></Combo>
		<Static Align="Center" BKColor="yellow" Border="Flat" Color="black" Height="20" Id="Static0" Left="6" Style="sty_lb_search" TabOrder="15" Text="진행상태" Top="81" VAlign="Middle" Width="80"></Static>
		<Static Align="Center" BKColor="orange" Border="Flat" Color="black" Height="16" Id="Static3" Left="6" Style="sty_lb_search" TabOrder="16" Top="112" VAlign="Middle" Width="43"></Static>
		<Static Color="user7" Font="굴림,9" Height="16" Id="Static4" Left="54" TabOrder="17" Text="오렌지색&#32;필드는&#32;셀을&#32;더블클릭하면&#32;팝업&#32;창이&#32;뜹니다." Top="112" VAlign="Middle" Width="300"></Static>
		<Static Color="user7" Font="굴림,9" Height="16" Id="Static10" Left="94" TabOrder="14" Text="※" Top="85" VAlign="Middle" Width="16"></Static>
		<Static Align="Right" Height="22" Id="st_date" Left="30" Style="sty_lb_search" TabOrder="18" Text="청구월&#32;" Top="6" VAlign="Middle" Width="88"></Static>
		<Calendar BindDataset="ds_cond" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="SUP_DTF" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_f_from" Left="120" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_search" SundayTextColor="user35" TabOrder="19" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="7" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="83"></Calendar>
		<Static Align="Center" Border="None" Color="user7" Font="굴림,9" Height="20" Id="Static2" Left="204" TabOrder="21" Text="~" Top="7" VAlign="Middle" Width="10"></Static>
		<Calendar BindDataset="ds_cond" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="SUP_DTT" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_f_to" Left="214" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_search" SundayTextColor="user35" TabOrder="20" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="7" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="83"></Calendar>
		<Static Align="Right" Height="20" Id="Static6" Left="470" Style="sty_lb_search" TabOrder="24" Text="설치/구매&#32;" Top="30" VAlign="Middle" Width="80"></Static>
		<Radio BindDataset="ds_cond" Border="None" Column="I_RA" Height="16" Id="rd_ra" INDEX="0" Left="555" OnChanged="rd_ra_OnChanged" Style="sty_ipt_search_chk" TabOrder="13" Top="32" Width="150">
			<Contents>
				<Layout code="A" default="true" height="20" left="0" text="설치&#32;외주" top="0" width="80"/>
				<Layout code="B" height="20" left="80" text="구매&#32;외주" top="0" width="170"/>
			</Contents>
		</Radio>
		<Static Align="Right" Height="20" Id="Static7" Left="916" Style="sty_lb_search" TabOrder="26" Text="진행상태&#32;" Top="6" VAlign="Middle" Width="80"></Static>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="CODE" Column="PROCESS" DataColumn="CODE_NAME" Height="20" Id="cb_process" InnerDataset="ds_process" Left="997" Style="sty_ipt_search" TabOrder="27" Top="5" Width="90"></Combo>
		<Static Align="Right" Height="20" Id="Static11" Left="916" Style="sty_lb_search" TabOrder="28" Text="결재상태&#32;" Top="30" VAlign="Middle" Width="80"></Static>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="CODE" Column="CHARGE" DataColumn="code_name" Height="20" Id="cb_state" InnerDataset="ds_charge" Left="997" Style="sty_ipt_search" TabOrder="29" Top="29" Width="90"></Combo>
		<Static Align="Right" Height="20" Id="Static12" Left="1089" Style="sty_lb_search" TabOrder="30" Text="비용청구&#32;" Top="30" VAlign="Middle" Visible="FALSE" Width="80"></Static>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="CODE" Column="CHARGE" DataColumn="CODE_NAME" Height="20" Id="cb_charge" InnerDataset="ds_charge" Left="1170" Style="sty_ipt_search" TabOrder="31" Top="29" Visible="FALSE" Width="90"></Combo>
		<Static Color="user7" Font="굴림,9" Height="16" Id="Static13" Left="171" TabOrder="32" Text="1번:&#32;업체지정" Top="85" VAlign="Middle" Width="80"></Static>
		<Static Color="user8" Font="굴림,9,Bold" Height="16" Id="Static14" Left="110" TabOrder="33" Text="설치&#32;외주" Top="85" VAlign="Middle" Width="56"></Static>
		<Static Color="user7" Font="굴림,9" Height="16" Id="Static15" Left="244" TabOrder="34" Text="&#32;→&#32;2번:&#32;작업요청&#32;→&#32;3번:&#32;투입일정&#32;→&#32;4번:&#32;작업시작&#32;→&#32;5번:&#32;작업완료&#32;→&#32;6번:&#32;비용처리" Top="85" VAlign="Middle" Width="544"></Static>
		<Grid AreaSelect="TRUE" AutoFitEndLine="Hide" BindDataset="ds_list" BkColor2="default" BoldHead="true" Border="Flat" Bottom="553" ColSelect="TRUE" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="393" Id="grd_list" InputPanel="FALSE" Left="8" LineColor="user20" LineType="ExHORZ" OnCellDBLClick="grd_list_OnCellDblClick" OnHeadClick="grd_list_OnHeadClick" Right="976" RowHeight="20" Style="sty_grid" TabOrder="35" TabStop="true" Top="160" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="968">
			<contents>
				<format id="Default">
					<columns>
						<col fix="left" width="29"/>
						<col fix="left" width="37"/>
						<col fix="left" width="50"/>
						<col fix="left" width="54"/>
						<col fix="left" width="69"/>
						<col fix="left" width="184"/>
						<col fix="left" width="50"/>
						<col width="48"/>
						<col width="125"/>
						<col width="48"/>
						<col width="73"/>
						<col width="73"/>
						<col width="101"/>
						<col width="73"/>
						<col width="73"/>
						<col width="37"/>
						<col width="110"/>
						<col width="73"/>
						<col width="73"/>
						<col width="73"/>
						<col width="73"/>
						<col width="73"/>
						<col width="110"/>
						<col width="73"/>
						<col width="401"/>
						<col width="56"/>
					</columns>
					<head>
						<cell bkimageid="icon_grid_sel" col="0" display="text"/>
						<cell align="center" col="1" color="user21" display="checkbox" edit="checkbox" font="굴림,9" text="출력"/>
						<cell align="center" col="2" color="user21" display="text" font="굴림,9" text="사무소"/>
						<cell align="center" col="3" color="user21" display="text" font="굴림,9" text="PM"/>
						<cell align="center" bkcolor="orange" col="4" color="user21" display="text" font="굴림,9" text="호기"/>
						<cell align="center" col="5" color="user21" display="text" font="굴림,9" text="프로젝트명"/>
						<cell align="center" col="6" color="user21" display="text" font="굴림,9" text="동"/>
						<cell align="center" col="7" color="user21" display="text" font="굴림,9" text="공정율"/>
						<cell align="center" bkcolor="orange" col="8" color="user21" display="text" font="굴림,9" text="설치협력사"/>
						<cell align="center" col="9" color="user21" display="text" font="굴림,9" text="팀장"/>
						<cell align="center" col="10" color="user21" display="text" font="굴림,9" text="착공예정일"/>
						<cell align="center" col="11" color="user21" display="text" font="굴림,9" text="준공예정일"/>
						<cell align="center" col="12" color="user21" display="text" font="굴림,9" text="외주작업구분"/>
						<cell align="center" col="13" color="user21" display="text" font="굴림,9" text="작업개시일"/>
						<cell align="center" col="14" color="user21" display="text" font="굴림,9" text="작업종료일"/>
						<cell align="center" col="15" color="user21" display="text" font="굴림,9" text="구분"/>
						<cell align="center" col="16" color="user21" display="text" font="굴림,9" text="1.외주업체"/>
						<cell align="center" bkcolor="orange" col="17" color="user21" display="text" font="굴림,9" text="2.작업요청"/>
						<cell align="center" bkcolor="orange" col="18" color="user21" display="text" font="굴림,9" text="3.투입일정"/>
						<cell align="center" bkcolor="orange" col="19" color="user21" display="text" font="굴림,9" text="4.작업시작"/>
						<cell align="center" bkcolor="orange" col="20" color="user21" display="text" font="굴림,9" text="5.작업완료"/>
						<cell align="center" col="21" color="user21" display="text" font="굴림,9" text="비용청구"/>
						<cell align="center" col="22" color="user21" display="text" font="굴림,9" text="결재상태"/>
						<cell align="center" bkcolor="orange" col="23" color="user21" display="text" font="굴림,9" text="6.비용처리"/>
						<cell align="left" bkcolor="orange" col="24" color="user21" display="text" font="굴림,9" text="메모"/>
						<cell bkcolor="orange" col="25" color="user21" display="text" font="굴림,9" text="사진"/>
					</head>
					<body>
						<cell align="center" bkcolor2="user22" col="0" display="text" expr="currow+1"/>
						<cell col="1" colid="CHK" display="expr:iif(CONTRCT&#32;==&#32;&apos;91&apos;,&#32;&apos;default&apos;,&#32;&apos;checkbox&apos;)" edit="expr:iif(CONTRCT&#32;==&#32;&apos;91&apos;,&#32;&apos;default&apos;,&#32;&apos;checkbox&apos;)"/>
						<cell align="center" bkcolor2="user22" col="2" colid="ZZACTSS" display="text" suppress="1"/>
						<cell align="center" bkcolor2="user22" col="3" colid="PM_NAME" display="text" suppress="2"/>
						<cell align="center" bkcolor2="user22" col="4" colid="POSID" display="text" suppress="3"/>
						<cell bkcolor2="user22" col="5" colid="ZSITE_NM" display="text" suppress="4"/>
						<cell bkcolor2="user22" col="6" colid="DONG" display="text" suppress="5"/>
						<cell align="right" bkcolor2="user22" col="7" colid="PRO_R" display="text" suppress="6"/>
						<cell bkcolor2="user22" col="8" colid="LIFNR_NM" display="text" suppress="7"/>
						<cell align="center" bkcolor2="user22" col="9" colid="NAMET" display="text" suppress="8"/>
						<cell align="center" bkcolor2="user22" col="10" colid="ZZCHAKD" display="text" Mask="####.##.##" suppress="9"/>
						<cell align="center" bkcolor2="user22" col="11" colid="ZZCOMP2" display="text" Mask="####.##.##" suppress="10"/>
						<cell bkcolor2="user22" col="12" colid="JOB_NAME" display="text"/>
						<cell align="center" bkcolor2="user22" col="13" colid="START_DAY" display="text" Mask="####.##.##"/>
						<cell align="center" bkcolor2="user22" col="14" colid="END_DAY" display="text" Mask="####.##.##"/>
						<cell align="center" bkcolor2="user22" col="15" colid="CONFIRM_GBN" color="expr:iif(CONTRCT&#32;==&#32;&apos;91&apos;,&#32;&apos;red&apos;,&#32;&apos;default&apos;)" display="text"/>
						<cell bkcolor2="user22" col="16" colid="LIFNR_OUT_NAME" display="text"/>
						<cell align="center" bkcolor2="user22" col="17" colid="REQ_DATE" display="text" Mask="####.##.##"/>
						<cell align="center" bkcolor2="user22" col="18" colid="EXP_DATE" display="text" Mask="####.##.##"/>
						<cell align="center" bkcolor2="user22" col="19" colid="START_DATE" display="text" Mask="####.##.##"/>
						<cell align="center" bkcolor="expr:iif(COM_DATE&#32;!=&#32;null&#32;&amp;&amp;&#32;COM_DATE&#32;!=&#32;&apos;&apos;,&#32;&apos;lightgreen&apos;,&#32;&apos;yellow&apos;)" col="20" colid="COM_DATE" display="text" Mask="####.##.##"/>
						<cell align="center" bkcolor2="user22" col="21" colid="CHARGE_DATE" display="text" Mask="####.##.##"/>
						<cell align="center" bkcolor="expr:decode(STATE_CODE,&#32;&apos;D&apos;,&#32;&apos;powderblue&apos;,&#32;&apos;E&apos;,&#32;&apos;lightskyblue&apos;,&#32;&apos;F&apos;,&#32;&apos;lightskyblue&apos;,&apos;K&apos;,&apos;pink&apos;,&#32;&apos;G&apos;,&#32;&apos;lightskyblue&apos;,&#32;&apos;C&apos;,&#32;&apos;deepskyblue&apos;,&#32;&apos;H&apos;,&#32;&apos;cornflower&apos;,&#32;&apos;I&apos;,&#32;&apos;royalblue&apos;,&#32;&apos;Z&apos;,&#32;&apos;red&apos;,&#32;&apos;none&apos;)" bkcolor2="expr:decode(STATE_CODE,&#32;&apos;D&apos;,&#32;&apos;powderblue&apos;,&#32;&apos;E&apos;,&#32;&apos;lightskyblue&apos;,&#32;&apos;F&apos;,&#32;&apos;lightskyblue&apos;,&apos;K&apos;,&apos;pink&apos;,&apos;G&apos;,&#32;&apos;lightskyblue&apos;,&#32;&apos;C&apos;,&#32;&apos;deepskyblue&apos;,&#32;&apos;H&apos;,&#32;&apos;cornflower&apos;,&#32;&apos;I&apos;,&#32;&apos;royalblue&apos;,&#32;&apos;Z&apos;,&#32;&apos;red&apos;,&#32;&apos;User&#32;Color&#32;22&apos;)" col="22" colid="STATE" display="text"/>
						<cell align="center" bkcolor2="user22" col="23" colid="CHARGE_DAT" display="text" Mask="####.##.##"/>
						<cell bkcolor2="user22" col="24" colid="CONTENTS" display="text"/>
						<cell align="center" col="25" display="text" text="보기"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Button Height="18" Id="btn_popProj" ImageID="btn_icon_search" Left="255" OnClick="btn_popProj_OnClick" TabOrder="36" Text="Button0" Top="56" Transparent="TRUE" Width="18"></Button>
		<Combo BindDataset="ds_cond" BKColor="user0" Border="Flat" CodeColumn="cODE" Column="PERIOD" DataColumn="CODE_NAME" DkshadowColor="user26" Height="17" Id="cb_period" InnerDataset="ds_period" Left="30" Style="sty_ipt_search" TabOrder="23" Top="7" Width="87"></Combo>
		<Radio BindDataset="ds_cond" BKColor="user0" Border="None" Column="RD_CHK" DisableBKColor="user5" Height="42" Id="rd_chk" INDEX="-1" Left="8" Style="sty_ipt_form_radio" TabOrder="38" Top="8" Width="15">
			<Contents>
				<Layout code="A" height="20" left="0" top="0" width="20"/>
				<Layout code="B" height="65" left="0" top="0" width="20"/>
			</Contents>
		</Radio>
		<Static Align="Center" Height="20" Id="Static21" Left="30" Style="sty_lb_search" TabOrder="37" Text="진행현장만&#32;보기" Top="30" VAlign="Middle" Width="106"></Static>
	</Form>
	<Script><![CDATA[/*
 ******************************************************************************************
 * 기      능   : 기타외주 작업지시서(업체용)
 * 작  성  자   : start
 * 작성  일자   : 2019.07.24
 * ----------------------------------------------------------------------------------------
 * HISTORY    : 관리자용을 기준(2019.08.02)으로 이미 개발된 업체용 기능 반영 - 강민석K : 2019.08.02
 ******************************************************************************************
 */
#include "LIB::commons.js";	// 공통 스크립트
//=========================================================================================
// [ PART 1 ]
// Form에서 사용될 전역변수를 선언
// FORM에서 사용되는 전역변수는 대문자로 작성하며, F_XXX 의 형태를 갖도록 한다.
//=========================================================================================
var userGroup = "";
var userAuth = "";//사용자 권한 - 설치협력사를 위한 변수 추가 - 2019.09.27 강민석K
//------------------------------------------------------------------------------------------------------
//조회 시 구분콤보의 인덱스 변수 추가 - 2019.07.30 강민석K
//승인, 출력 버튼 클릭 시 ds_list를 unfilter하는데 조회 시점의 구분콤보와 다르게 바꾸고 unfilter하면
//조회 시 filter 건 내용이 풀리는 문제 때문에 unfilter 후 조회 시점의 구분콤보 index로 다시 필터를 건다.
//------------------------------------------------------------------------------------------------------
//계약 테이블이 ZPSTW1404 에서 ZPSTW1401로 변경되어 필터처리 삭제 - 2019.07.31 강민석K
//var F_QUERY_GUBN_INDEX = -1;
//팝업화면이 닫히면 최신 메모를 표시하기 위해 그리드를 재조회하는데 최근에 클릭한 셀로 다시 스크롤 해주기 위한 변수 추가 - 2019.07.31 강민석K
var F_CURRENT_CLICKED_ROW_INDEX = -1;
var F_CURRENT_CLICKED_COL_INDEX = -1;
var F_AUTO_QUERY = false;//조회 버튼 클릭 시 false, 로직 상 재조회 시 true
var fv_zps05 = false; // 설치업체
var fv_mmAuth = false;
var G_SELECT = false;
//=========================================================================================
// [ PART 2 ]
// Form Loading / Unloading 시 작업 정의
//=========================================================================================
function fn_OnLoadCompleted(obj) {
	//Form 로드 이벤트 맨 첫줄에 기술
	gfn_initForm(true);
	
	userGroup = gfn_getUserGroup();
	
	ed_pjt.SetFocus();
	
	//사용자가 관리팀 권한이 아닌 경우 '구분' 컬럼 숨김
	//if(userGroup != '40'){
	//	grd_list.SetColProp(15, "Width", 0);
	//}
	//계약 테이블이 ZPSTW1404 에서 ZPSTW1401로 변경되어 '구분' 컬럼은 모두 숨김 처리 - 2019.07.31 강민석K
	grd_list.SetColProp(15, "Width", 0);
	
	//사무소 콤보 조회
	var codeArr = ["PS003"];
    var dsObjArr = [ds_zzactss];
    var addTypeArr = [G_CODE_ALL];
    gfn_searchCommCode(codeArr, dsObjArr, addTypeArr);
    
	//나머지 콤보 조회
	ds_cond.SetColumn(0, "PROCESS", "1");
	rd_chk.Value = "A";
	
    tit_clearActionInfo();
	tit_addSearchActionInfo("ps02:PS0201001A_S35");	//설치협력사 콤보 조회
	tit_addSearchActionInfo("ps15:PS1505001A_S1");	//외주작업구분 콤보 조회
	tit_addSearchActionInfo("ps15:PS1505001A_S2");	//진행상태 콤보 조회
	tit_addSearchActionInfo("ps15:PS1505001A_S3");	//외주업체 콤보 조회
	tit_addSearchActionInfo("ps15:PS1505001A_S6");	//사용자 권한 조회
	tit_callService(
		  ""
		, ""
		, "ds_cond=ds_cond"
		, "ds_lifnr_cd=ds_zzlifnr_cd ds_workgubun=ds_work ds_process=ds_process ds_zzlifnr_cd=ds_zzlifnr ds_auth=ds_auth"
		, ""
		, "fn_afterLifnr"
		, true
		, true);
}
/********************************************************************************
* 기      능   : fn_OnLoadCompleted Callback
********************************************************************************/
function fn_afterLifnr(errCode, errMsg) {
	//설치협력사 콤보
	gfn_insertEmptyRow(ds_lifnr_cd, G_CODE_ALL);
	cb_lifnr.Index = 0;
	
	//외주작업구분 콤보
	gfn_insertEmptyRow(ds_workgubun, G_CODE_ALL);
	cb_workgubun.Index = 0;
	
	ds_workgubun.UnFilter();
	ds_workgubun.Filter("GBN == " + quote(rd_ra.Value) + " || CODE == ''");//'-전체-' 항목도 표시하기 위해 CODE == '' 사용
	
	//진행상태 콤보
	gfn_insertEmptyRow(ds_process, G_CODE_ALL);
	cb_process.Index = 0;
	
	//외주업체 콤보
	gfn_insertEmptyRow(ds_zzlifnr_cd, G_CODE_ALL);
	cb_zzlifnr.Index = 0;
	
	//---------------------------------------------------------------------------------
	//외주작업구분 콤보 선택 시 해당 외주작업을 담당하는 외주업체만 필터되도록 하기위해
	//쿼리(PS1505001A_S3)에서 ZPST0417 join이 추가되어 중복데이터가 발생하게됨.
	//중복데이터 제거를 위해 필터 컬럼을 추가하여 사용 - 2019.10.10 강민석K
	// - ds_zzlifnr_cd.Filter 관련 부분은 모두 수정
	ds_zzlifnr_cd.AddColumn("OVERLAP_FLAG", "STRING", 1);
	ds_zzlifnr_cd.SetColumn(0, "OVERLAP_FLAG", 1);
	
	var OUT_LIFNR_CD = "";
	var GBN = "";
	
	for(var i = 1; i < ds_zzlifnr_cd.rowcount; i++){//'-전체-' 항목 때문에 인덱스는 1부터 시작
		if(OUT_LIFNR_CD != ds_zzlifnr_cd.GetColumn(i, "CODE") || (OUT_LIFNR_CD == ds_zzlifnr_cd.GetColumn(i, "CODE") && GBN != ds_zzlifnr_cd.GetColumn(i, "GBN"))){
			ds_zzlifnr_cd.SetColumn(i, "OVERLAP_FLAG", 1);
			OUT_LIFNR_CD = ds_zzlifnr_cd.GetColumn(i, "CODE");
			GBN = ds_zzlifnr_cd.GetColumn(i, "GBN");
		}else{
			//코드가 이전 row와 같은 업체는 중복으로 판단
			ds_zzlifnr_cd.SetColumn(i, "OVERLAP_FLAG", 0);
		}
	}
	//---------------------------------------------------------------------------------
	
	ds_zzlifnr_cd.UnFilter();
	//외주작업구분 콤보 선택 시 해당 외주작업을 담당하는 외주업체만 필터되도록 수정 - 2019.10.10 강민석K
	//ds_zzlifnr_cd.Filter("GBN == " + quote(rd_ra.Value) + " || CODE == ''");//'-전체-' 항목도 표시하기 위해 CODE == '' 사용
	ds_zzlifnr_cd.Filter("OVERLAP_FLAG == 1 && (GBN == " + quote(rd_ra.Value) + " || CODE == '')");//중복제거를 위해 필터 조건 수정 - 2019.10.10 강민석K
	//Trace(ds_zzlifnr_cd.saveXML());
	// 업체 로그인 시
	if(userGroup == '10' || userGroup == '20'){
		//-----------------------------------------------------------------------------------------------------
		//외주업체 로그인 시 사무소, 설치PM 콤보 표시하지 않음 - 2019.08.29 강민석K (송광용D, 고범석K 확인사항)
		// 설치협력사 ds를 저장한 후 사무소 콤보 값 세팅
		//cb_zzactss.Index = ds_zzactss.FindRow("CODE", G_AREA_CODE);
		//cb_zzactss_OnChanged(G_AREA_CODE, G_AREA_CODE, cb_zzactss.GetSelText(),-1,cb_zzactss.Index);
		//cb_zzactss.Enable = false;
		
		cb_zzactss.Index = 0;
		//cb_zzactss_OnChanged(G_AREA_CODE, G_AREA_CODE, cb_zzactss.GetSelText(),-1,cb_zzactss.Index);
		
		//사무소, 설치PM 콤보 숨김
		//사무소, 설치PM 콤보를 표시하도록 수정(단, 자동세팅은 하지 않음) - 2019.10.11 강민석K
		//st_zzactss.Visible = false;
		//cb_zzactss.Visible = false;
		//st_pm.Visible = false;
		//cb_zzpmnum.Visible = false;
		
		//사무소, 설치PM 콤보의 우측 컨트롤들의 위치이동
		//st_zzpmnum.Left -= 171;
		//cb_lifnr.Left -= 171;
		//st_zzlifnr.Left -= 171;
		//cb_workgubun.Left -= 171;
		//Static7.Left -= 171;
		//cb_process.Left -= 171;
		//Static6.Left -= 171;
		//rd_ra.Left -= 171;
		//Static9.Left -= 171;
		//Static5.Left -= 171;
		//cb_zzlifnr.Left -= 171;
		//Static11.Left -= 171;
		//cb_state.Left -= 171;
		//-----------------------------------------------------------------------------------------------------
		
		zzlifnr_setting();
	}
	
	//사용자 권한 - 설치협력사는 조회만 가능하도록 추가 - 2019.09.27 강민석K
	var bOut_Lifnr = false;//외주업체 여부 추가 - 설치협력사면서 외주업체인 경우가 있어서 변수 추가 - 2019.09.27 강민석K
	var sMM_Lifnr = false; // 구매외주 구분 추가 - 설치면서 구매인 외주업체
	var sPs_Lifnr = false; // 구매외주 구분 추가 - 설치면서 구매인 외주업체
	
	//Trace(ds_auth.saveXML());
    for(var i = 0; i < ds_auth.rowcount; i++){
		userAuth = ds_auth.GetColumn(i, "AUTH");
		
		if(userAuth == "ZPS05"){//설치협력사 권한
			//설치협력사는 청구를 할 수 없다
			btn_charge.Enable = false;
			fv_zps05 = true;
			sPs_Lifnr = true;
		}
    	
		if(userAuth == "ZPS13"){
			bOut_Lifnr = true;
		}
		
		if(userAuth == "ZMSRM13") // 설치외주인 경우
		{
			sPs_Lifnr = true;
		}
		
		if(userAuth == "ZMSRM07")	// 구매협력사인 경우
		{
			sMM_Lifnr = true;
		}
    		
    }

    //설치협력사면서 외주업체인 경우가 있어서 추가 - 2019.09.27 강민석K
	if(bOut_Lifnr == true){
		btn_charge.Enable = true;
	}
	
	//Trace(sMM_Lifnr);
	//Trace(sPs_Lifnr);
	
	//설치외주업체이면서 구매협력사 인 경우 - 추가 2019-12-12 송광용DR
	if(sPs_Lifnr == true && sMM_Lifnr == true)
	{
		rd_ra.Enable = true;
	}
	
	if(fv_zps05 == true)
	{
		//trace(ds_zzlifnr_cd.saveXML());
		//외주업체 콤보 필터
		ds_zzlifnr_cd.UnFilter();
		ds_zzlifnr_cd.Filter("OVERLAP_FLAG == 1 && (GBN == " + quote(rd_ra.Value) + " && CODE == '"+ G_VEND_CODE +"') || CODE == ''");//중복제거를 위해 필터 조건 수정 - 2019.10.10 강민석K
		var nCsCnt = ds_zzlifnr_cd.CaseCount("OVERLAP_FLAG == 1 && (GBN == " + quote(rd_ra.Value) + " && CODE == '"+ G_VEND_CODE +"') || CODE == ''");
		if(nCsCnt == 2)
		{
			cb_zzlifnr.Index = 1;
		}
		else
		{
			cb_zzlifnr.Index = 0;
		}
		
		cb_zzlifnr.Enable = true;
	}

	if(G_USER_ID == '7000059')
	{
		ds_zzlifnr_cd.UnFilter();
		rd_ra.Value = 'B';
	}
}
/********************************************************************************
* 기      능   : 공통코드가 조회된 후의 Callback 함수
********************************************************************************/
function fn_completeInit(sCode, sDsObj, sCodeType) {
	//조회일자 세팅
    //조회일자 세팅 변경 : 한달전 ~ 2달후 => 금일 ~ 1달후 - 2019.10.11 강민석K
    //cal_f_from.Value = gfn_getAfterDate(gfn_getCurrDate(), -30);
    //cal_f_to.Value	 = gfn_getAfterDate(gfn_getCurrDate(), 60);
    cal_f_from.Value = gfn_getAfterDate(gfn_getCurrDate(),-30);
    cal_f_to.Value	 = gfn_getAfterDate(gfn_getCurrDate(), 60);

	//콤보 index 세팅
	cb_period.Index = 0;		//조회기간 종류
	cb_zzactss.Index = 0;		//사무소 콤보
	cb_charge.Index = 0;		//비용청구
	
	rd_ra.Index = 0;			//설치외주/구매외주 라디오버튼 세팅
	
	if(userGroup == "10")
	{
		rd_ra.Enable = false;
	}
	//지사권한인 경우 사무소 콤보 고정, 비활성화
	if(userGroup == "30"){
		cb_zzactss.Index = ds_zzactss.FindRow("CODE", G_AREA_CODE_E);
		cb_zzactss.Enable = false;
		cb_zzactss_OnChanged(G_AREA_CODE_E, G_AREA_CODE_E, cb_zzactss.GetSelText(), -1, cb_zzactss.Index);
	}
}
/********************************************************************************
* 기      능   : form UnloadCompleted
********************************************************************************/
function fn_OnUnloadCompleted(obj) {
	return gfn_isFormUnload(obj);
}
//=========================================================================================
// [ PART 3 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,form닫기)
//=========================================================================================
/********************************************************************************
* 기      능   : 조회 1
********************************************************************************/
function fn_query() {
	//계약 테이블이 ZPSTW1404 에서 ZPSTW1401로 변경되어 필터처리 삭제 - 2019.07.31 강민석K
	//F_QUERY_GUBN_INDEX = cb_confirm_gubun.Index;
	if(G_SELECT == true)
	{
		gfn_openMsgWin("조회 중입니다. 잠시만 기다려주세요..\n(팝업이 반복되는 경우, 프로그램을 종료 후\n다시 실행해주세요.");
		return;
	}
	
	//조회기간 체크
	if(!gfn_checkFromToObj(cal_f_from, cal_f_to, true, cb_period.Text)) {
		return;
	}
	
	//-----------------------------------------------------------------------------------------------------
	//프로젝트 번호를 입력하지 않아도 일자 조건으로 조회되도록 변경되어 기간 제한 추가 - 2019.10.11 강민석K
	var diffDays = gfn_getDayCnt(ds_days, cal_f_from.value, cal_f_to.value);
	if((gfn_isNull(ed_pjt, false) || length(ed_pjt.Text) != 6) && diffDays > 365){
		gfn_openMsgWin("[" + cb_period.Text + "]을 1년 이내로 선택해 주십시오");
		cal_f_from.SetFocus();
		return;
	}
	//-----------------------------------------------------------------------------------------------------
	
	//필수 조회조건 체크
	if(rd_ra.Value == "A"){
		//설치외주인 경우 기존 체크로직
		if(gfn_isNull(ed_pjt, false) && (gfn_isNull(cb_zzpmnum, false) || gfn_isNull(cb_actss, false)))
		{
			//프로젝트 번호를 입력하지 않아도 일자 조건으로 조회되도록 변경되어 주석 처리 - 2019.10.11 강민석K
			//[프로젝트 또는 사무소, 설치PM]중 하나이상 필수선택입니다. 확인바랍니다.
			//gfn_showMsg("CW00207", "프로젝트 또는 사무소, 설치PM");
			//return;
		}
	}else{
		//구매외주는 프로젝트 번호가 없으면 조회 속도가 너무 느려 프로젝트 번호를 필수 조회조건으로 처리
		/*if(gfn_isNull(ed_pjt, false) || length(ed_pjt.Text) != 6){
			gfn_showMsg("프로젝트 번호는 필수입력입니다. 프로젝트 번호 6자리를 확인바랍니다.");
			return;
		}*/
	}
	
	//비용결재 관련 테이블이 설치외주와 구매외주가 달라 쿼리를 분리한다. - 2019.07.11 강민석K
	var callTargetInfo = "";
	if(rd_ra.Value == "A"){
		callTargetInfo = "ps15:PS1505001A_S4";//설치외주
	}else{
		callTargetInfo = "ps15:PS1505001A_S5";//구매외주
	}
	
	G_SELECT = true;
	
	tit_clearActionInfo();
	tit_addSearchActionInfo(callTargetInfo);
	tit_callService(
          ""
        , ""
        , "ds_cond=ds_cond"
        , "ds_list=ds_list"
        , ""
        , "fn_afterQuery"
        , true);
}

/********************************************************************************
* 기      능   : 청구 33
********************************************************************************/
function fn_charge() {
	var nChk = 0;
	var nIdx = -1;
	for(var i = 0; i < ds_list.rowcount; i++) {
	//trace("청구 : "+ i +" : "+ ds_list.GetColumn(i,"CHK"));
		if( ds_list.GetColumn(i,"CHK") == "1" ) {
			nChk++;
			nIdx = i;
		}
	}
	//trace("체크 카운트 : "+ nChk);
	
	//선택여부 체크
	if(nIdx == -1){
		gfn_openMsgWin("비용청구 할 항목을 선택하세요.", "E", "", "");
		return;
	}
	
	if( nChk > 1 ) {
		gfn_openMsgWin("비용청구는 단건만 처리할 수 있습니다.", "E", "", "");
		return;
	} 
	
	//이미 비용청구된 자료인지 체크
	if(ds_list.GetColumn(nIdx, "CHARGE_DATE") != ""){
		gfn_openMsgWin("이미 비용청구가 완료된 항목입니다.", "E", "", "");
		return;
	}
	
	// 작업완료 체크
	var comDate = ds_list.GetColumn(nIdx,"COM_DATE");
	
	//if( ds_list.GetColumn(nIdx,"COM_DATE") == "" ) {
	if( comDate == null || comDate == "" ) {
		gfn_openMsgWin("비용청구는 작업완료가 된 항목만 청구 할 수 있습니다.", "E", "", "");
		return;
	}
	
	//작업완료일과 현재일(비용청구일) 비교
	//현재 개발된 상태는 작업완료일이 작업시작일 이후이면 모두 입력 가능함
	//저장된 작업완료일이 내일인 경우, 비용청구일은 오늘이 될 것이라 문제가 예상됨
	if(ds_list.GetColumn(nIdx, "COM_DATE") > today()){
		gfn_openMsgWin("입력된 작업완료일이 오늘보다 이후입니다.\n작업완료일을 수정 후 다시 시도하시기 바랍니다.", "E", "", "");
		return;
	}
	
	// 사진설명 체크
	ds_cond_check.DeleteAll();
	ds_cond_check.AddRow();
	ds_cond_check.SetColumn(0, "LIFNR", ds_list.GetColumn(nIdx,"LIFNR_OUT"));
	ds_cond_check.SetColumn(0, "PSPID", ds_list.GetColumn(nIdx,"PSPID"));
	ds_cond_check.SetColumn(0, "POSID", ds_list.GetColumn(nIdx,"POSID"));
	ds_cond_check.SetColumn(0, "JOB_CODE", ds_list.GetColumn(nIdx,"JOB_CODE"));
	
	tit_clearActionInfo();
	tit_addSearchActionInfo("ps15:PS1505002A_S1");	
	tit_callService(
          ""
        , ""
        , "ds_cond_check=ds_cond_check"
        , "ds_pic_cmmt=ds_pic_cmmt"
        , ""
        , "fn_afterPicCmmt"
        , true);
}
/********************************************************************************
* 기      능   : 포기 34
********************************************************************************/
function fn_giveup() {
	gfn_openMsgWin("포기 기능 개발 필요.", "W", "", "");
}
/********************************************************************************
* 기      능   : 출력 40
********************************************************************************/
function fn_print() {
	//선택여부 체크
	if(ds_list.FindRow("CHK", 1) == -1){
		gfn_showMsg('CW00046');
		return;
	}
	
	ds_list_tmp.ClearData();
	ds_list.Filter("CHK == '1'");
	ds_list_tmp.copyF(ds_list);
	ds_list.unFilter();
	
	//trace("ds_list_tmp : " + ds_list_tmp.SaveXML());
	
	//작업완료가 되지 않은 항목이 있는지 체크
	ds_list_tmp.Filter("COM_DATE == '' || COM_DATE == null");
	var inCompleteCnt = ds_list_tmp.rowcount;
	ds_list_tmp.UnFilter();
	
	if(inCompleteCnt > 0){
		gfn_showMsg("작업완료가 되지 않은 항목은 완료확인서를 출력 할 수 없습니다.");
		return;
	}
	
	//외주작업 종류가 섞여 있는지 체크
	var bDiffrent = false;
	var curGbn = ds_list_tmp.GetColumn(0, "JOB_CODE");
	for(var j = 1; j < ds_list_tmp.rowcount; j++){
		if(ds_list_tmp.GetColumn(j, "JOB_CODE") != curGbn){
			bDiffrent = true;
			break;
		}
	}
	
	if(bDiffrent == true){
		gfn_showMsg("1종류의 외주작업만 출력 할 수 있습니다.");
		return;
	}
	
	var argPspid = "";		//프로젝트번호 모음
	var argPosid = "";		//호기번호 모음
	var paramPspid = "";	//프로젝트번호 IN절
	var paramPosid = "";	//호기번호 IN절
	var pspid = "";
	
	ds_list_tmp.Sort("PSPID,POSID",True);
	
	for(var i = 0; i < ds_list_tmp.rowcount; i++)
	{
		if(pspid != ds_list_tmp.GetColumn(i, "PSPID")){
			argPspid += "'" + ds_list_tmp.GetColumn(i, "PSPID") + "'" + ",";
		}
		
		pspid = ds_list_tmp.GetColumn(i, "PSPID");
		
		argPosid += "'" + ds_list_tmp.GetColumn(i, "POSID") + "'" + ",";
	}
	
	if(substr(argPspid, length(argPspid) - 1) == ","){
		argPspid = substr(argPspid, 0, length(argPspid) - 1);
	}
	paramPspid = " AND A.PSPID IN (" + argPspid + ")";
	
	if(substr(argPosid, length(argPosid) - 1) == ","){
		argPosid = substr(argPosid, 0, length(argPosid) - 1);
	}
	paramPosid = " AND A.POSID IN (" + argPosid + ")";
	
	ds_cond_p.ClearData();
	ds_cond_p.AddRow();
	ds_cond_p.SetColumn(0,"GUBUN1", paramPspid);//프로젝트번호 IN 조건
	ds_cond_p.SetColumn(0,"GUBUN2", paramPosid);//호기번호 IN 조건
	ds_cond_p.SetColumn(0,"GBN", ds_list_tmp.GetColumn(0, "JOB_CODE"));//작업종류
	
	tit_clearActionInfo();
	tit_addSearchActionInfo("ps15:PS1505001A_S8");
	tit_callService(
          ""
        , ""
        , "ds_cond_p=ds_cond_p"
        , "ds_list_p=ds_list_p"
        , ""
        , ""
        , ""
		, ""
        , true);
	
	Dialog("PS15::PS1505001P.xml", "");
}
/********************************************************************************
* 기      능   : 엑셀 45
********************************************************************************/
function fn_excel() {
	// Excel Export
	gfn_saveToExcel(grd_list, true);
}
/********************************************************************************
* 기      능   : 닫기 900
********************************************************************************/
function fn_close() {
	close();
}
//=========================================================================================
// [ PART 4]
// Callback 함수 정의 : callback 함수명은 메인 함수의 fn_xxxx() 에서 xxxx 부분은 fn_afterXXXX()
// 형태가 되도록 작성
//=========================================================================================
/********************************************************************************
* 기      능   : 조회 Callback
********************************************************************************/
function fn_afterQuery(errCode, errMsg) {
	//최근 위치로 그리드 스크롤
	if(F_AUTO_QUERY == true){
		F_AUTO_QUERY = false;
		
		if(F_CURRENT_CLICKED_ROW_INDEX <= ds_list.rowcount){
			//오히려 헷갈릴 것 같아 일단 주석처리 함 - 2019.08.01 강민석K
			//grd_list.VScrollPos = F_CURRENT_CLICKED_ROW_INDEX;
			//grd_list.HScrollPos = F_CURRENT_CLICKED_COL_INDEX;
		}else{
			//변수 초기화
			F_CURRENT_CLICKED_ROW_INDEX = -1;
			F_CURRENT_CLICKED_COL_INDEX = -1;
		}
	}
	//trace("ds_list : " + ds_list.SaveXML());
	
	G_SELECT = false;
	// 메시지 처리
	gfn_showSearchMsg(grd_list);
}
/********************************************************************************
* 기      능   : 저장 Callback
********************************************************************************/
function fn_afterSave(errCode, errMsg) {
	if(errCode != 0){
		gfn_showMsg("CE00001");
	}else{
		gfn_showMsg("CI00003");
		fn_query();
	}
}
//=========================================================================================
// [ PART 5 ]
// Detail Process Event 정의 ( User Define function )
// 사용자 정의 함수는 ufn_xxxx() 형태로 작성
//=========================================================================================
/********************************************************************************
* 기      능   : 사용자 정의 함수
********************************************************************************/
function ufn_userfunction() {

}
/********************************************************************************
* 기      능   : 업체로그인 시 외주업체 코드를 해당 업체로 고정
********************************************************************************/
function zzlifnr_setting() {
	// 설치/구매 라디오 버튼 세팅
	var nOldIndex;
	nOldIndex = rd_ra.Index;	// 기존 라디오 값 저장
	
	ds_zzlifnr_cd.UnFilter();
	rd_ra.Value = ds_zzlifnr_cd.GetColumn(ds_zzlifnr_cd.FindRow("CODE", G_VEND_CODE), "GBN");
	
	Trace(G_VEND_CODE);
	//Trace(ds_zzlifnr_cd.saveXML());
	//Trace(rd_ra.Value);
	if(nOldIndex != rd_ra.Index) {	// 값이 변경되었을 때만 호출
		rd_ra_OnChanged(rd_ra.Value, rd_ra.Value, rd_ra.Text, nOldIndex, rd_ra.Index);
	}
	
	
	//외주업체 콤보 필터
	ds_zzlifnr_cd.UnFilter();
	ds_zzlifnr_cd.Filter("OVERLAP_FLAG == 1 && (GBN == " + quote(strCode) + " || CODE == '')");//중복제거를 위해 필터 조건 수정 - 2019.10.10 강민석K
	cb_zzlifnr.Index = 0;

	
	
	//외주업체 콤보 필터
	//trace("G_VEND_CODE : " + G_VEND_CODE);
	//trace("외주업체 콤보 필터 idx : "+ ds_zzlifnr_cd.FindRow("CODE", G_VEND_CODE));
	cb_zzlifnr.Index = ds_zzlifnr_cd.FindRow("CODE", G_VEND_CODE);
	cb_zzlifnr.Enable = false;
	
	//rd_ra.enable = false;
	
	//trace("CHK : "+ ds_list.GetColumn(i,"CHK"));
}
/********************************************************************************
* 기      능   : 체크 항목의 사진 설명 알아오기
********************************************************************************/
function fn_afterPicCmmt(errCode, errMsg) {
	var idx = 0;
	idx = ds_pic_cmmt.FindRow("COMMNT", "");
	//trace("idx : "+ ds_pic_cmmt.saveXml());

	/*	이현용 K 요청으로 비용 청구시 사진 설명 체크 해제
	if(idx != -1) {
		gfn_openMsgWin("사진보기에서 사진에 대한 설명을\n빠짐없이 입력해 주세요.", "E", "", "");
		return;
	}
	*/
	
	// 저장 쪽
	//trace('Query : '+ ds_cond_check.GetColumn(0,"PSPID") 
	//		   +', '+ ds_cond_check.GetColumn(0,"POSID") 
	//		   +', '+ ds_cond_check.GetColumn(0,"JOB_CODE")  
	//		   +', '+ ds_cond_check.GetColumn(0,"LIFNR") 
	//);
	
	tit_clearActionInfo();
	tit_addSearchActionInfo("ps15:PS1505002A_U1");
	tit_callService(
          ""
        , ""
        , "ds_cond_check=ds_cond_check"
        , ""
        , ""
        , "fn_afterSave"
        , true);
}
//=========================================================================================
// [ PART 6 ]
// component Event 정의 : 각 Component 별 이벤트
//=========================================================================================
/********************************************************************************
* 기      능   : 그리드 헤더 클릭시 정렬 처리
********************************************************************************/
function grd_list_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
{
	if(nCell == 0){
		// 그리드 표시할 컬럼 선택
		gfn_selectGridCol(obj);
	}else if(nCell == 1){
		// 전체 체크/해제
		gfn_selectAllGrid(obj,nCell,nCell,true);
	}else{
		// 그리드 정렬 처리
		gfn_sortGrid(obj,nCell);
	}
}
/********************************************************************************
* 기      능   : 데이터셋 값 변경 시 - Flag 처리
********************************************************************************/
function ds_list_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{
	gfn_changeFlag( obj, strColumnID, nRow, "FLAG" );
}
/********************************************************************************
* 기      능   : 사무소 변경 시 -> 설치협력사 콤보 필터, 설치PM 콤보 조회
********************************************************************************/
function cb_zzactss_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{	
	//설치협력사 콤보 필터
	if(userGroup == "40" || userGroup == "30")
	{
		ds_cond.SetColumn(0, "LIFNR", '');
		ds_cond.SetColumn(0, "ZZLIFNR", '');
	}
	
	//사무소 콤보 선택이 '전체'인 경우
    if(ds_cond.GetColumn(0, "ZZACTSS") == '')
    {
		ds_lifnr_cd.UnFilter();//모든 설치협력사가 표시되도록 필터 제거
		//외주업체와 사무소는 관계가 없다고 하여 주석처리 - 2019.10.10 강민석K
		//ds_zzlifnr_cd.UnFilter();//모든 외주업체가 표시되도록 필터 제거
		
		cb_lifnr.Index = 0;
    }
    else
    {
		var arr = ds_cond.GetColumn(0, "ZZACTSS");//선택된 사무소코드
		
		//선택된 사무소코드로 설치협력사, 외주업체 콤보 필터
		ds_lifnr_cd.Filter("ZZACTSS == " + quote(arr) + " || CODE == ''");//'-전체-' 항목도 표시하기 위해 CODE == '' 사용
		//외주업체와 사무소는 관계가 없다고 하여 주석처리 - 2019.10.10 강민석K
		//ds_zzlifnr_cd.Filter("ZZACTSS == " + quote(arr) + " || CODE == ''");//'-전체-' 항목도 표시하기 위해 CODE == '' 사용
		
		if(userGroup == "10") {
			// 사무소 콤보 값 세팅
			cb_lifnr.Index = 0;
		//	cb_lifnr.Index = ds_lifnr_cd.FindRow("CODE", G_VEND_CODE);
		//	cb_lifnr.Enable = false;
		}
    }
    
    //설치PM 콤보 조회
	ds_cond.SetColumn(0, "ZZACTSS", strCode);
	cb_zzpmnum.value = "";
	
	var recvDataSet = "ds_zzpmnum_cd=ds_zzpmnum_cd";//수신받을 데이터셋

	tit_clearActionInfo();
	tit_addSearchActionInfo("ps02:PS0201001A_S42");
	
	//설치PM의 TEMNO(팀장코드?) 조회 - 설치PM으로 로그인한 경우 설치PM 콤보 자동 선택 처리 추가 - 2019.07.29 강민석K (고범석K 요구사항)
	if(userGroup == "30"){
		ds_temno.ClearData();
		tit_addSearchActionInfo("ps15:PS1505001A_S7");
		recvDataSet += " ds_temno=ds_temno";
	}
	
	tit_callService(
		  ""
		, ""
		, "ds_cond=ds_cond"
		, recvDataSet
		, ""
		, "fn_afterZzactssChange"
		, true,true);
}
/********************************************************************************
* 기      능   : 설치PM 콤보 조회 Callback
********************************************************************************/
function fn_afterZzactssChange(errCode, errMsg) {
	gfn_insertEmptyRow(ds_zzpmnum_cd, G_CODE_ALL);
	
	//설치PM의 TEMNO(팀장코드?) 조회 - 설치PM으로 로그인한 경우 설치PM 콤보 자동 선택 처리 추가 - 2019.07.29 강민석K (고범석K 요구사항)
	if(ds_temno.rowcount == 1 && ds_zzpmnum_cd.FindRow("CODE", ds_temno.GetColumn(0, "TEMNO")) > 0){
		cb_zzpmnum.Value = ds_temno.GetColumn(0, "TEMNO");
	}else{
		cb_zzpmnum.Value = "";
	}
}

/********************************************************************************
* 기      능   : 프로젝트 번호 검색 버튼 클릭
********************************************************************************/
function btn_popProj_OnClick(obj)
{
	var arg = "pjt=" + quote(ed_pjt.Text);
	gfn_openPopup("CS9601002A", true, arg);
}
/********************************************************************************
* 기      능   : 설치외주/구매외주 라디오버튼 선택
********************************************************************************/
function rd_ra_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	//외주작업구분 콤보 필터
	ds_workgubun.UnFilter();
	ds_workgubun.Filter("GBN == " + quote(strCode) + " || CODE == ''");//'-전체-' 항목도 표시하기 위해 CODE == '' 사용
	cb_workgubun.Index = 0;
	
	//외주업체 콤보 필터
	ds_zzlifnr_cd.UnFilter();
	//외주작업구분 콤보 선택 시 해당 외주작업을 담당하는 외주업체만 필터되도록 수정 - 2019.10.10 강민석K
	//ds_zzlifnr_cd.Filter("GBN == " + quote(strCode) + " || CODE == ''");//'-전체-' 항목도 표시하기 위해 CODE == '' 사용
	
	if(userGroup == '30' || userGroup == '40')
	{
		ds_zzlifnr_cd.Filter("OVERLAP_FLAG == 1 && (GBN == " + quote(strCode) + " || CODE == '')");//중복제거를 위해 필터 조건 수정 - 2019.10.10 강민석K
	}
	else	// 업체일 경우
	{
		ds_zzlifnr_cd.Filter("OVERLAP_FLAG == 1 && ((GBN == " + quote(strCode) + "&& CODE == '"+G_VEND_CODE+"') || CODE == '')");//중복제거를 위해 필터 조건 수정 - 2019.10.10 강민석K
	}
	
	
	if(ds_zzlifnr_cd.FindRow("CODE", G_VEND_CODE) >= 0)
	{
		cb_zzlifnr.Index = ds_zzlifnr_cd.FindRow("CODE", G_VEND_CODE);
	}
	else
	{
		cb_zzlifnr.Index = 0;
	}
	
	
	//권한에 따라 화면 표시 수정
	if(strCode == 'A'){//설치외주인 경우
		btn_print.Enable = true;
		
		ds_cond.SetColumn(0, "PROCESS", "1");
		Static13.Text = "1번: 업체지정";
		Static15.Text = " → 2번: 작업요청 → 3번: 일정확인 → 4번: 작업시작 → 5번: 작업완료 → 6번: 비용처리";
		
		//검색기간 종류 콤보
		ds_period.UnFilter();
		
		Static11.Visible = true;//결재상태 콤보
		cb_state.Visible = true;
		
		//그리드에서 비용관련 컬럼 표시
		grd_list.SetColProp(21, "Width", 73);
		grd_list.SetColProp(22, "Width", 110);//지사결재 3단계 분리로 컬럼폭 수정(80->110) - 2019.09.17 강민석K
		grd_list.SetColProp(23, "Width", 73);
		
	}else{//구매외주인 경우
		btn_print.Enable = false;
		
		ds_cond.SetColumn(0, "PROCESS", "3");
		Static13.Text = "1번: 작업인지";
		Static15.Text = " → 2번: 작업요청 → 3번: 일정확인 → 4번: 작업시작 → 5번: 작업완료";
		
		//검색기간 종류 콤보 - 비용관련 기간 종류 제거
		ds_period.Filter("CODE != 'F' && CODE != 'G'");
		
		Static11.Visible = false;//결재상태 콤보
		cb_state.Visible = false;
		
		//그리드에서 비용관련 컬럼 숨김
		grd_list.SetColProp(21, "Width", 0);
		grd_list.SetColProp(22, "Width", 0);
		grd_list.SetColProp(23, "Width", 0);
	}
	
	Static14.Text = strText;
	
	tit_clearActionInfo();
	tit_addSearchActionInfo("ps15:PS1505001A_S2");//진행상태 콤보 조회
	tit_callService(
		  ""
		, ""
		, "ds_cond=ds_cond"
		, "ds_process=ds_process"
		, ""
		, "fn_afterRadioChange"
		, true
		, true);
}
/********************************************************************************
* 기      능   : 설치외주/구매외주 라디오버튼 선택 Callback
********************************************************************************/
function fn_afterRadioChange(errCode, errMsg) {
	gfn_insertEmptyRow(ds_process, G_CODE_ALL);
	cb_process.Index = 0;
	
	ds_list.ClearData();
	//fn_query();//재조회는 요청이 있을 경우 주석 해제
}
/********************************************************************************
* 기      능   : 그리드 셀 더블클릭 시 진행상태 팝업화면 표시
********************************************************************************/
function grd_list_OnCellDblClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
	F_CURRENT_CLICKED_ROW_INDEX = nRow;
	F_CURRENT_CLICKED_COL_INDEX = nCell;
	
	grd_list.Format = "Mbefore";//기존 팝업화면(호기정보, 설치협력사)에서 grd_list의 Format에 따라 동작하기 때문에 추가
	
	if(nCell == 4){//호기
		gfn_openPopup("PS0204008B", true);
		
	}else if(nCell == 8){//설치협력사
		gfn_openPopup("PS0204008L", true);
		
	}else if(nCell == 17){//작업요청
		gfn_openPopup("PS1505001B", true);
		
	}else if(nCell == 18){//투입일정
		//구매외주는 작업요청일이 입력되지 않은 상태에서 작업예정일을 입력할 수 없다. - 2019.07.18 강민석K
		var reqDate = ds_list.GetColumn(nRow, "REQ_DATE");
		
		if(rd_ra.Value == "B" && (reqDate == null || reqDate == "")){
			gfn_openMsgWin("구매외주 작업은 작업요청일을 먼저 입력해야 합니다.", "E", "", "");
			return;
		}
		
		gfn_openPopup("PS1505001F", true);
		
	}else if(nCell == 19){//작업시작
		var expDate = ds_list.GetColumn(nRow, "EXP_DATE");
		
		if(expDate == null || expDate == ""){
			gfn_openMsgWin("작업예정일을 먼저 입력하세요.", "E", "", "");
			return;
		}
		
		gfn_openPopup("PS1505001G", true);
		
	}else if(nCell == 20){//작업완료
		var startDate = ds_list.GetColumn(nRow, "START_DATE");
		
		if(startDate == null || startDate == ""){
			gfn_openMsgWin("작업시작일을 먼저 입력하세요.", "E", "", "");
			return;
		}
		
		gfn_openPopup("PS1505001I", true);
	
	}else if(nCell == 22){//결재상태
		var state_code = ds_list.GetColumn(nRow, "STATE_CODE");
		if(state_code == "Z"){
			var arg  = "CRNAM=" + quote(ds_list.GetColumn(nRow, "RTN_CRNAM"));//입력자명
				arg += " BELONG=" + quote(ds_list.GetColumn(nRow, "RTN_BELONG"));//소속
				arg += " CONTENTS=" + quote(ds_list.GetColumn(nRow, "RTN_CONTENTS_ORIG"));//반려사유
				arg += " G_MENU=" + quote("B");
			gfn_openPopup("PS1505001L", true, arg);
		}
	
	}else if(nCell == 23){//비용처리
		gfn_openPopup("PS1505001J", true);
		
	}else if(nCell == 24){//메모
		var contents = ds_list.GetColumn(nRow, "CONTENTS_ORIG");
		
		if(length(trim(contents)) > 0){
			var arg  = "CRNAM=" + quote(ds_list.GetColumn(nRow, "MEMO_CRNAM"));//입력자명
				arg += " BELONG=" + quote(ds_list.GetColumn(nRow, "MEMO_BELONG"));//소속
				arg += " CONTENTS=" + quote(contents);//내용
				arg += " ALM_INDC=" + quote(ds_list.GetColumn(nRow, "MEMO_ALM_INDC"));//알림대상
				arg += " PSPID=" + quote(ds_list.getColumn(0, "PSPID"));//프로젝트 번호
				arg += " POSID=" + quote(ds_list.getColumn(0, "POSID"));//호기 번호
				arg += " LIFNR=" + quote(ds_list.GetColumn(0, "LIFNR_OUT"));//업체코드
				arg += " SEQ=" + quote(ds_list.GetColumn(nRow, "SEQ"));//SEQ
			gfn_openPopup("PS1505001C", true, arg);
		}
	}else if(nCell == 25){//사진 미리보기
		gfn_openPopup("PS1505001K", true);
	}
}

/********************************************************************************
* 기      능   : 외주작업구분 변경 시 -> 외주업체 콤보 필터 기능 추가 - 2019.10.10 강민석K
********************************************************************************/
function cb_workgubun_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	if(rd_ra.Value == 'A')
	{
		if(userGroup != '10' && userGroup != '20')
		{
			ds_zzlifnr_cd.UnFilter();
			
			if(strCode != ""){
				ds_zzlifnr_cd.Filter("(JOB_CODE == " + quote(strCode) + " && GBN == " + quote(rd_ra.Value) + ") || CODE == ''");
			}else{
				ds_zzlifnr_cd.Filter("OVERLAP_FLAG == 1 && (GBN == " + quote(rd_ra.Value) + " || CODE == '')");
			}
			
			cb_zzlifnr.Index = 0;
		}
	}
	
	
	//Trace(ds_zzlifnr_cd.saveXML());
	
	
}

function ds_cond_CanColumnChange(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{
	if(strColumnID == "SUP_DTF" || strColumnID == "SUP_DTT")
	{
		if(varNewValue < '20191007' && rd_ra.Value == 'A')
		{
			gfn_openMsgWin("2019.10.07일 이전일자로는\n조회하실 수 없습니다.");
			return false;
		}
	}
}
]]></Script>
</Window>