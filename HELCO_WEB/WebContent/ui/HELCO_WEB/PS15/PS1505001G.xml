<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="856" Id="PS1505001G" Left="8" OnLoadCompleted="fn_OnLoadCompleted" PidAttrib="7" Title="작업시작" Top="8" Ver="1.0" Width="590" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_pdf">
				<Contents>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
					<colinfo id="BIGO" size="256" summ="default" type="STRING"/>
					<colinfo id="UDATE" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond1">
				<Contents>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID_1" size="256" summ="default" type="STRING"/>
					<colinfo id="JOB_CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="P_CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_memo">
				<Contents>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="CRNAM" size="256" summ="default" type="STRING"/>
					<colinfo id="CRID" size="256" summ="default" type="STRING"/>
					<colinfo id="BELONG" size="256" summ="default" type="STRING"/>
					<colinfo id="JOB_NAME" size="256" summ="default" type="STRING"/>
					<colinfo id="CONTENTS" size="256" summ="default" type="STRING"/>
					<colinfo id="CONTENTS_ORIG" size="256" summ="default" type="STRING"/>
					<colinfo id="CRDATE_TIME" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="ALM_INDC" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_notice">
				<Contents>
					<colinfo id="CONTENTS" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_memo_del">
				<Contents>
					<colinfo id="PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQNO_LIST" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_save">
				<Contents>
					<colinfo id="PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
					<colinfo id="JOB_CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="START_DATE" size="256" summ="default" type="STRING"/>
					<colinfo id="START_TIME" size="256" summ="default" type="STRING"/>
					<colinfo id="PLAN_DATE" size="256" summ="default" type="STRING"/>
					<colinfo id="PLAN_TIME" size="256" summ="default" type="STRING"/>
					<colinfo id="WORKER_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="WORKER_HP" size="256" summ="default" type="STRING"/>
					<colinfo id="PROC_VER" size="256" summ="default" type="STRING"/>
					<colinfo id="WORKER_ID2" size="256" summ="default" type="STRING"/>
					<colinfo id="WORKER_HP2" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_worker"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_file_list">
				<Contents>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="FNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="FPATH" size="256" summ="default" type="STRING"/>
					<colinfo id="COMMNT" size="256" summ="default" type="STRING"/>
					<colinfo id="META_CRDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="FNAME_APP" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_st_time">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_st_minute">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_combo">
				<Contents>
					<colinfo id="ST_TIME" size="256" summ="default" type="STRING"/>
					<colinfo id="ST_MINUTE" size="256" summ="default" type="STRING"/>
					<colinfo id="PL_TIME" size="256" summ="default" type="STRING"/>
					<colinfo id="PL_MINUTE" size="256" summ="default" type="STRING"/>
					<record>
						<PL_MINUTE></PL_MINUTE>
						<PL_TIME></PL_TIME>
						<ST_MINUTE></ST_MINUTE>
						<ST_TIME></ST_TIME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_pl_time">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_pl_minute">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_file_del">
				<Contents>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="FNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="FPATH" size="256" summ="default" type="STRING"/>
					<colinfo id="COMMNT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_sms">
				<Contents>
					<colinfo id="TRAN_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="TRAN_PHONE" size="256" summ="default" type="STRING"/>
					<colinfo id="TRAN_CALLBACK" size="256" summ="default" type="STRING"/>
					<colinfo id="TRAN_STATUS" size="256" summ="default" type="STRING"/>
					<colinfo id="TRAN_MSG" size="256" summ="default" type="STRING"/>
					<colinfo id="TRAN_ETC1" size="256" summ="default" type="STRING"/>
					<colinfo id="TRAN_TYPE" size="256" summ="default" type="STRING"/>
					<colinfo id="TRAN_PHONE2" size="256" summ="default" type="STRING"/>
					<colinfo id="TRAN_TIME" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_auth">
				<Contents>
					<colinfo id="AUTH" size="256" summ="default" type="STRING"/>
					<colinfo id="AUTH_NAME" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_worker2"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_msgsend">
				<Contents>
					<colinfo id="MESGSEND" size="255" type="STRING"/>
					<colinfo id="MESGACCP" size="256" type="STRING"/>
					<colinfo id="MESGTITL" size="256" type="STRING"/>
					<colinfo id="MESGDESC" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_check_sms_send"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_datetime">
				<Contents>
					<colinfo id="DATETIME" size="255" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
		</Datasets>
		<Shape BKColor="user12" Bottom="355" Height="26" Id="Shape10" Left="295" LineColor="user13" Right="501" TabOrder="42" Top="329" Type="Rectangle" Width="206"></Shape>
		<Div Height="36" Id="div_btn" TabOrder="1" TabStop="FALSE" Text="Div0" Url="WB01::CommBtnForm.xml" Width="590">
			<Contents></Contents>
		</Div>
		<Button ButtonStyle="TRUE" Cursor="HAND" DragImageID="tab_form_05" Font="굴림,9" Height="20" Id="btn_sibang" ImageID="btn_user_06" Left="6" OnClick="btn_sibang_OnClick" Style="sty_btn" TabOrder="2" Text="영업사양&#32;조회" Top="45" Width="87"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" DragImageID="tab_form_05" Font="굴림,9" Height="20" Id="btn_plan" ImageID="btn_user_02" Left="97" OnClick="btn_plan_OnClick" Style="sty_btn" TabOrder="3" Text="도면" Top="45" Width="40"></Button>
		<Static Align="Right" Font="굴림,9" Height="16" Id="st_manager" Left="466" TabOrder="4" Text="담당자&#32;:&#32;업체담당자" Top="47" Width="115"></Static>
		<Static Align="Center" Font="굴림,12" Height="24" Id="Static1" Left="142" TabOrder="5" Text="현장에&#32;들어가기&#32;전&#32;작업시작을&#32;입력하세요" Top="72" Width="314"></Static>
		<Static Font="굴림,9" Height="16" Id="st_process1" Left="14" TabOrder="6" Text="1번:&#32;업체지정&#32;→&#32;2번:&#32;작업요청&#32;→&#32;3번:&#32;투입일정&#32;→" Top="136" Width="280"></Static>
		<Static Color="darkorange" Font="굴림,9,Bold" Height="16" Id="st_process2" Left="299" TabOrder="7" Text="4번:&#32;작업시작" Top="136" Width="98"></Static>
		<Static Font="굴림,9" Height="16" Id="st_process3" Left="381" TabOrder="8" Text="&#32;→&#32;5번:&#32;작업완료&#32;→&#32;6번:&#32;비용처리" Top="136" Width="190"></Static>
		<Shape BKColor="user12" Bottom="227" Height="26" Id="Shape0" Left="85" LineColor="user13" Right="291" TabOrder="10" Top="201" Type="Rectangle" Width="206"></Shape>
		<Static Align="Center" BKColor="user1" Height="24" Id="Static6" Left="86" Style="sty_lb_form_basic" TabOrder="9" Text="설치업체" Top="202" VAlign="Middle" Width="71"></Static>
		<Edit BindDataset="ds_list" Border="Flat" Column="LIFNR_NM" Enable="FALSE" Height="20" Id="ed_lifnr_nm" ImeMode="native" Left="160" LeftMargin="4" MaxLength="20" Readonly="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="11" Top="204" Width="128"></Edit>
		<Shape BKColor="user12" Bottom="227" Height="26" Id="Shape1" Left="295" LineColor="user13" Right="501" TabOrder="13" Top="201" Type="Rectangle" Width="206"></Shape>
		<Static Align="Center" BKColor="user1" Height="24" Id="Static7" Left="296" Style="sty_lb_form_basic" TabOrder="12" Text="작업명" Top="202" VAlign="Middle" Width="71"></Static>
		<Edit BindDataset="ds_list" Border="Flat" Column="JOB_NAME" Enable="FALSE" Height="20" Id="ed_jobname" ImeMode="native" Left="370" LeftMargin="4" MaxLength="20" Readonly="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="14" Top="204" Width="128"></Edit>
		<Shape BKColor="user12" Bottom="259" Height="26" Id="Shape2" Left="85" LineColor="user13" Right="291" TabOrder="16" Top="233" Type="Rectangle" Width="206"></Shape>
		<Static Align="Center" BKColor="user1" Height="24" Id="Static8" Left="86" Style="sty_lb_form_basic" TabOrder="15" Text="작업팀장" Top="234" VAlign="Middle" Width="71"></Static>
		<Edit BindDataset="ds_list" Border="Flat" Column="NAMET" Enable="FALSE" Height="20" Id="ed_namet" ImeMode="native" Left="160" LeftMargin="4" MaxLength="20" Readonly="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="17" Top="236" Width="128"></Edit>
		<Shape BKColor="user12" Bottom="259" Height="26" Id="Shape3" Left="295" LineColor="user13" Right="501" TabOrder="19" Top="233" Type="Rectangle" Width="206"></Shape>
		<Static Align="Center" BKColor="user1" Height="24" Id="Static9" Left="296" Style="sty_lb_form_basic" TabOrder="18" Text="작업업체명" Top="234" VAlign="Middle" Width="71"></Static>
		<Edit BindDataset="ds_list" Border="Flat" Column="LIFNR_OUT_NAME" Enable="FALSE" Height="20" Id="ed_lifnr_out_name" ImeMode="native" Left="370" LeftMargin="4" MaxLength="20" Readonly="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="20" Top="236" Width="128"></Edit>
		<Shape BKColor="user12" Bottom="291" Height="26" Id="Shape4" Left="85" LineColor="user13" Right="291" TabOrder="22" Top="265" Type="Rectangle" Width="206"></Shape>
		<Static Align="Center" BKColor="user1" Height="24" Id="Static10" Left="86" Style="sty_lb_form_basic" TabOrder="21" Text="휴대폰" Top="266" VAlign="Middle" Width="71"></Static>
		<Edit BindDataset="ds_list" Border="Flat" Column="NAMET_HP" Enable="FALSE" Height="20" Id="ed_team_hp" ImeMode="native" Left="160" LeftMargin="4" MaxLength="20" Readonly="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="23" Top="268" Width="128"></Edit>
		<Shape BKColor="user12" Bottom="323" Height="26" Id="Shape6" Left="85" LineColor="user13" Right="291" TabOrder="25" Top="297" Type="Rectangle" Width="206"></Shape>
		<Static Align="Center" BKColor="user1" Height="24" Id="Static12" Left="86" Style="sty_lb_form_basic" TabOrder="24" Text="설치PM" Top="298" VAlign="Middle" Width="71"></Static>
		<Edit BindDataset="ds_list" Border="Flat" Column="PM_NAME" Enable="FALSE" Height="20" Id="ed_pm_name" ImeMode="native" Left="160" LeftMargin="4" MaxLength="20" Readonly="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="26" Top="300" Width="128"></Edit>
		<Shape BKColor="user12" Bottom="323" Height="26" Id="Shape7" Left="295" LineColor="user13" Right="501" TabOrder="28" Top="297" Type="Rectangle" Width="206"></Shape>
		<Static Align="Center" BKColor="user1" Height="24" Id="Static13" Left="296" Style="sty_lb_form_basic" TabOrder="27" Text="작업요청자" Top="298" VAlign="Middle" Width="71"></Static>
		<Edit BindDataset="ds_list" Border="Flat" Column="REQ_NAME" Enable="FALSE" Height="20" Id="ed_requester" ImeMode="native" Left="370" LeftMargin="4" MaxLength="20" Readonly="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="29" Top="300" Width="128"></Edit>
		<Shape BKColor="user12" Bottom="355" Height="26" Id="Shape8" Left="85" LineColor="user13" Right="291" TabOrder="31" Top="329" Type="Rectangle" Width="206"></Shape>
		<Static Align="Center" BKColor="user1" Height="24" Id="Static14" Left="86" Style="sty_lb_form_basic" TabOrder="30" Text="휴대폰" Top="330" VAlign="Middle" Width="71"></Static>
		<Edit BindDataset="ds_list" Border="Flat" Column="PM_HP" Enable="FALSE" Height="20" Id="ed_pm_hp" ImeMode="native" Left="160" LeftMargin="4" MaxLength="20" Readonly="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="32" Top="332" Width="128"></Edit>
		<Shape BKColor="user12" Bottom="387" Height="26" Id="Shape9" Left="85" LineColor="user13" Right="291" TabOrder="34" Top="361" Type="Rectangle" Width="206"></Shape>
		<Static Align="Center" BKColor="user1" Height="24" Id="Static15" Left="86" Style="sty_lb_form_basic" TabOrder="33" Text="작업요청일" Top="362" VAlign="Middle" Width="71"></Static>
		<Button ButtonStyle="TRUE" Cursor="HAND" DragImageID="tab_form_05" Font="굴림,9" Height="20" Id="btn_add" ImageID="btn_user_04" Left="477" OnClick="btn_add_OnClick" Style="sty_btn" TabOrder="35" Text="메모추가" Top="681" Width="65"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" DragImageID="tab_form_05" Font="굴림,9" Height="20" Id="btn_delete" ImageID="btn_user_02" Left="544" OnClick="btn_delete_OnClick" Style="sty_btn" TabOrder="36" Text="삭제" Top="681" Width="40"></Button>
		<Grid AutoEnter="TRUE" AutoFitEndLine="Hide" BindDataset="ds_memo" BkColor2="default" BoldHead="true" Border="Flat" Bottom="806" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="99" Id="grd_memo" InputPanel="FALSE" Left="6" LineColor="user20" LineType="ExHORZ" OnCellDBLClick="grd_memo_OnCellDblClick" Right="584" RowHeight="20" Style="sty_grid" TabOrder="37" TabStop="true" Top="707" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="578">
			<contents>
				<format id="Default">
					<columns>
						<col width="24"/>
						<col width="65"/>
						<col width="46"/>
						<col width="70"/>
						<col width="230"/>
						<col width="123"/>
					</columns>
					<head>
						<cell col="0" color="user21" display="text" font="굴림,9"/>
						<cell col="1" color="user21" display="text" font="굴림,9" text="입력자"/>
						<cell col="2" color="user21" display="text" font="굴림,9" text="소속"/>
						<cell col="3" color="user21" display="text" font="굴림,9" text="작업구분"/>
						<cell col="4" color="user21" display="text" font="굴림,9" text="메모"/>
						<cell col="5" color="user21" display="text" font="굴림,9" text="입력일시"/>
					</head>
					<body>
						<cell align="center" col="0" colid="CHK" display="checkbox" edit="checkbox"/>
						<cell align="center" col="1" colid="CRNAM" display="text"/>
						<cell align="center" col="2" colid="BELONG" display="text"/>
						<cell align="center" col="3" colid="JOB_NAME" display="text"/>
						<cell col="4" colid="CONTENTS" display="text"/>
						<cell align="center" col="5" colid="CRDATE_TIME" display="text" Mask="####.##.##&#32;##:##:##"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Static Align="Center" BindDataset="ds_list" Column="POSID" Height="24" Id="st_posid" Left="85" Style="sty_lb_form_basic" TabOrder="38" Text="162800L05" Top="172" VAlign="Middle" Width="75"></Static>
		<Static Align="Center" BindDataset="ds_list" Column="DONG" Height="24" Id="st_dong" Left="164" Style="sty_lb_form_basic" TabOrder="39" Text="1401동" Top="172" VAlign="Middle" Width="45"></Static>
		<Static Height="24" Id="st_site_nm" Left="212" Style="sty_lb_form_basic" TabOrder="40" Text="&#32;남양주&#32;녹촌&#32;라온&#32;프리이빗&#32;4-1BL" Top="172" VAlign="Middle" Width="287"></Static>
		<Static Align="Center" BKColor="user1" Height="24" Id="Static2" Left="296" Style="sty_lb_form_basic" TabOrder="41" Text="작업요청자" Top="330" VAlign="Middle" Width="71"></Static>
		<Edit Border="Flat" Enable="FALSE" Height="20" Id="ed_req_reg_time" ImeMode="native" Left="370" LeftMargin="4" MaxLength="20" Readonly="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="43" Top="332" Width="128"></Edit>
		<Static Align="Center" BKColor="user1" Height="24" Id="Static16" Left="296" Style="sty_lb_form_basic" TabOrder="44" Text="요청등록시간" Top="330" VAlign="Middle" Width="71"></Static>
		<Shape BKColor="user12" Bottom="493" Height="26" Id="Shape11" Left="134" LineColor="user13" Right="452" TabOrder="46" Top="467" Type="Rectangle" Width="318"></Shape>
		<Static Align="Center" BKColor="yellow" Height="24" Id="Static17" Left="135" Style="sty_lb_form_basic" TabOrder="45" Text="작업시작일시" Top="468" VAlign="Middle" Width="74"></Static>
		<Calendar BindDataset="ds_list" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_start_date" Left="212" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" OnChanged="cal_start_date_OnChanged" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="47" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="470" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="87"></Calendar>
		<Shape BKColor="user12" Bottom="387" Height="26" Id="Shape12" Left="295" LineColor="user13" Right="501" TabOrder="49" Top="361" Type="Rectangle" Width="206"></Shape>
		<Static Align="Center" BKColor="user1" Height="24" Id="Static18" Left="296" Style="sty_lb_form_basic" TabOrder="48" Text="작업예정일" Top="362" VAlign="Middle" Width="71"></Static>
		<Shape BKColor="user12" Bottom="429" Height="26" Id="Shape13" Left="134" LineColor="user13" Right="452" TabOrder="51" Top="403" Type="Rectangle" Width="318"></Shape>
		<Static Align="Center" BKColor="yellow" Height="24" Id="Static19" Left="135" Style="sty_lb_form_basic" TabOrder="50" Text="작업자" Top="404" VAlign="Middle" Width="74"></Static>
		<Combo CodeColumn="CODE" DataColumn="CODE_NAME" Height="20" Id="cb_worker" InnerDataset="ds_worker" Left="212" OnChanged="cb_worker_OnChanged" TabOrder="52" Text="이순신" Top="406" Width="125"></Combo>
		<Edit Border="Flat" Height="20" Id="ed_worker_hp" ImeMode="native" Left="338" LeftMargin="4" MaxLength="20" RightMargin="4" Style="sty_ipt_form" TabOrder="53" Top="406" Width="111"></Edit>
		<Static Align="Center" Font="굴림,11" Height="23" Id="Static5" Left="54" TabOrder="54" Text="작업시작을&#32;입력하면&#32;설치PM,&#32;설치업체팀장에게&#32;알림으로&#32;공지합니다" Top="97" Width="474"></Static>
		<Combo BindDataset="ds_combo" CodeColumn="CODE" Column="ST_TIME" DataColumn="CODE_NAME" Height="20" Id="cb_start_time" InnerDataset="ds_st_time" Left="300" TabOrder="55" Top="470" Width="59"></Combo>
		<Static Align="Center" BKColor="white" Height="15" Id="Static11" Left="357" Style="sty_lb_form_basic" TabOrder="56" Text="시" Top="473" VAlign="Middle" Width="15"></Static>
		<Static Align="Center" BKColor="white" Height="15" Id="Static20" Left="434" Style="sty_lb_form_basic" TabOrder="57" Text="분" Top="473" VAlign="Middle" Width="15"></Static>
		<Combo BindDataset="ds_combo" CodeColumn="CODE" Column="ST_MINUTE" DataColumn="CODE_NAME" Height="20" Id="cb_start_minute" InnerDataset="ds_st_minute" Left="376" TabOrder="58" Top="470" Width="59"></Combo>
		<Shape BKColor="user12" Bottom="525" Height="26" Id="Shape5" Left="134" LineColor="user13" Right="452" TabOrder="61" Top="499" Type="Rectangle" Width="318"></Shape>
		<Static Align="Center" BKColor="yellow" Height="24" Id="Static21" Left="135" Style="sty_lb_form_basic" TabOrder="60" Text="예상완료일시" Top="500" VAlign="Middle" Width="74"></Static>
		<Calendar BindDataset="ds_list" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_plan_date" Left="212" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" OnChanged="cal_plan_date_OnChanged" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="62" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="502" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="87"></Calendar>
		<Static Align="Center" Color="red" Font="Tahoma,16,Bold" Height="15" Id="Static22" Left="203" TabOrder="59" Text="＊" Top="487" Width="15"></Static>
		<Combo BindDataset="ds_combo" CodeColumn="CODE" Column="PL_TIME" DataColumn="CODE_NAME" Height="20" Id="cb_plan_time" InnerDataset="ds_pl_time" Left="300" TabOrder="63" Top="502" Width="59"></Combo>
		<Static Align="Center" BKColor="white" Height="15" Id="Static23" Left="357" Style="sty_lb_form_basic" TabOrder="64" Text="시" Top="505" VAlign="Middle" Width="15"></Static>
		<Static Align="Center" BKColor="white" Height="15" Id="Static24" Left="434" Style="sty_lb_form_basic" TabOrder="65" Text="분" Top="505" VAlign="Middle" Width="15"></Static>
		<Combo BindDataset="ds_combo" CodeColumn="CODE" Column="PL_MINUTE" DataColumn="CODE_NAME" Height="20" Id="cb_plan_minute" InnerDataset="ds_pl_minute" Left="376" TabOrder="66" Top="502" Width="59"></Combo>
		<Static Align="Center" Color="red" Font="Tahoma,16,Bold" Height="15" Id="Static25" Left="201" TabOrder="67" Text="＊" Top="393" Width="15"></Static>
		<Static Align="Center" Font="굴림,10" Height="23" Id="Static26" Left="16" TabOrder="68" Text="작업&#32;시작&#32;전&#32;현장&#32;상황&#32;사진을&#32;등록하세요" Top="544" Width="560"></Static>
		<Button ButtonStyle="TRUE" Cursor="HAND" DragImageID="tab_form_05" Font="굴림,9" Height="22" Id="btn_download" ImageID="btn_sub_06" Left="90" OnClick="btn_download_OnClick" Style="sty_btn" TabOrder="69" Text="&#32;&#32;파일&#32;다운로드" Top="569" Width="97"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" DragImageID="tab_form_05" Font="굴림,9" Height="22" Id="btn_upload" ImageID="btn_sub_04" Left="344" OnClick="btn_upload_OnClick" Style="sty_btn" TabOrder="70" Text="&#32;&#32;파일추가" Top="569" Width="73"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" DragImageID="tab_form_05" Font="굴림,9" Height="22" Id="btn_del_file" ImageID="btn_sub_04" Left="417" OnClick="btn_del_file_OnClick" Style="sty_btn" TabOrder="71" Text="&#32;&#32;파일삭제" Top="569" Width="73"></Button>
		<Grid AutoEnter="TRUE" AutoFitEndLine="Hide" BindDataset="ds_file_list" BkColor2="default" BoldHead="true" Border="Flat" Bottom="674" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="81" Id="grd_file" InputPanel="FALSE" Left="90" LineColor="user20" LineType="ExHORZ" OnCellDBLClick="grd_file_OnCellDblClick" Right="488" RowHeight="20" Style="sty_grid" TabOrder="72" TabStop="true" Top="593" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="398">
			<contents>
				<format id="Default">
					<columns>
						<col width="24"/>
						<col width="155"/>
						<col width="217"/>
					</columns>
					<head>
						<cell col="0" color="user21" display="text" font="굴림,9"/>
						<cell col="1" color="user21" display="text" font="굴림,9" text="첨부파일&#32;리스트"/>
						<cell col="2" color="user21" display="text" font="굴림,9" text="설명"/>
					</head>
					<body>
						<cell align="center" col="0" colid="CHK" display="checkbox" edit="checkbox"/>
						<cell align="left" col="1" colid="FNAME" display="text"/>
						<cell align="left" col="2" colid="COMMNT" display="text"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Edit Border="Flat" Enable="FALSE" Height="20" Id="ed_req_date" ImeMode="native" Left="160" LeftMargin="4" MaxLength="20" Readonly="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="73" Top="364" Width="128"></Edit>
		<Edit Border="Flat" Enable="FALSE" Height="20" Id="ed_exp_date" ImeMode="native" Left="370" LeftMargin="4" MaxLength="20" Readonly="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="73" Top="364" Width="128"></Edit>
		<FileDialog Bottom="24" Filter="All(*.*)|*.*|jpg&#32;File(*.jpg)|*.jpg|jpeg&#32;File(*.jpeg)|*.jpeg|bmp&#32;File(*.bmp)|*.jpeg|gif&#32;File(*.gif)|*.gif|png&#32;File(*.png)|*.png|pdf&#32;File(*.pdf)|*.pdf|" Height="24" Id="saveDialog" Left="648" Right="672" TabOrder="76" Type="Save" Width="24"></FileDialog>
		<CyHttpFile Height="24" Id="httpFile" Left="648" Top="32" Width="24"></CyHttpFile>
		<File Bottom="56" Height="24" Id="f_tmp" Left="616" Right="640" TabOrder="76" Top="32" Width="24"></File>
		<FileDialog Bottom="24" Filter="All(*.*)|*.*|jpg&#32;File(*.jpg)|*.jpg|jpeg&#32;File(*.jpeg)|*.jpeg|bmp&#32;File(*.bmp)|*.jpeg|gif&#32;File(*.gif)|*.gif|png&#32;File(*.png)|*.png|pdf&#32;File(*.pdf)|*.pdf|" Height="24" Id="fileDialog" Left="616" MultiSelect="TRUE" Right="640" TabOrder="76" Width="24"></FileDialog>
		<Shape BKColor="user12" Bottom="461" Height="26" Id="Shape14" Left="134" LineColor="user13" Right="452" TabOrder="77" Top="435" Type="Rectangle" Width="318"></Shape>
		<Static Align="Center" BKColor="yellow" Height="24" Id="Static3" Left="135" Style="sty_lb_form_basic" TabOrder="76" Text="작업자2" Top="436" VAlign="Middle" Width="74"></Static>
		<Combo CodeColumn="CODE" DataColumn="CODE_NAME" Height="20" Id="cb_worker2" InnerDataset="ds_worker2" Left="212" OnChanged="cb_worker_OnChanged2" TabOrder="78" Text="이순신" Top="438" Width="125"></Combo>
		<Edit Border="Flat" Height="20" Id="ed_worker_hp2" ImeMode="native" Left="338" LeftMargin="4" MaxLength="20" RightMargin="4" Style="sty_ipt_form" TabOrder="79" Top="438" Width="111"></Edit>
		<Static Align="Center" Color="red" Font="Tahoma,16,Bold" Height="15" Id="Static4" Left="203" TabOrder="75" Text="＊" Top="455" Width="15"></Static>
		<Shape BKColor="user12" Bottom="291" Height="26" Id="Shape15" Left="295" LineColor="user13" Right="501" TabOrder="81" Top="265" Type="Rectangle" Width="206"></Shape>
		<Static Align="Center" BKColor="user1" Height="24" Id="Static0" Left="296" Style="sty_lb_form_basic" TabOrder="80" Text="업체연락처" Top="266" VAlign="Middle" Width="71"></Static>
		<Edit BindDataset="ds_list" Border="Flat" Column="LIFNR_OUT_TEL" Enable="FALSE" Height="20" Id="Edit0" ImeMode="native" Left="370" LeftMargin="4" MaxLength="20" Readonly="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="82" Top="268" Width="128"></Edit>
		<TextArea Enable="FALSE" Height="38" Id="ta_notice" Left="6" Readonly="TRUE" TabOrder="83" Text="※공지사항&#32;:&#32;공지사항은&#32;디비에&#32;맵핑된&#32;정보를&#32;불러와서&#32;표기한다" Top="811" Width="578"></TextArea>
	</Form>
	<Script><![CDATA[/*
 ******************************************************************************************
 * 기      능   : 작업시작 팝업
 * 작  성  자   : 강민석K
 * 작성  일자   : 2019.07.19
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
//#include "LIB::tit_comm_0001.js";
#include "LIB::commons.js";	// 공통 스크립트 
//=========================================================================================
// [ PART 1 ]
// Form에서 사용될 전역변수를 선언
// FORM에서 사용되는 전역변수는 대문자로 작성하며, F_XXX 의 형태를 갖도록 한다. 
//=========================================================================================
var userGroup = "";
var userAuth = "";//사용자 권한 - 안전, 서비스 구분을 위한 변수 추가 - 2019.07.26 강민석K
var F_START_DATE_EVENT_ENABLE = true;//저장된 일자가 오늘 이전 일자인 경우 cal_start_date_OnChanged가 실행되지 않도록 변수 추가 - 2019.07.19 강민석K
var F_MODIFY_MODE = false;//이미 저장된 상태의 자료인지 여부(true : 수정저장 모드, false : 신규저장 모드)
var F_SIZE = 1024 * 10096;	// 4096K
var F_PIC_UPLOAD_YN = "Y";//사진업로드 필수여부 관련 추가 - 2019.10.02 강민석K
var F_SAVE_INDC = false;
//=========================================================================================
// [ PART 2 ]
// Form Loading / Unloading 시 작업 정의
//=========================================================================================
function fn_OnLoadCompleted(obj) {
	//Form 로드 이벤트 맨 첫줄에 기술 
	gfn_initForm();
	
	userGroup = gfn_getUserGroup();
	
	ufn_initTimeCombo();
	
	//사진업로드 필수여부 관련 추가 - 2019.10.02 강민석K
	F_PIC_UPLOAD_YN = ds_list.GetColumn(ds_list.row, "PIC_UPLOAD_YN");
	
	//업체담당자(팀장)
	st_manager.Text = "담당자 : " + ds_list.GetColumn(ds_list.row, "J_1KFREPRE");
	
	//프로세스 안내문구 표시 : 구매외주인 경우 1번 프로세스를 '작업인지'로 표시
	if(ds_cond.GetColumn(0, "I_RA") == 'B'){
		st_process1.Text = "1번: 작업인지 → 2번: 작업요청 → 3번: 투입일정 →";
		
		//구매외주는 비용처리가 프로세스가 없어져 화면 표시 수정 - 2019.08.01 강민석K
		st_process3.Text = " → 5번: 작업완료";
		st_process1.Left = 64;
		st_process2.Left = 349;
		st_process3.Left = 431;
		
		//구매외주는 시방조회 기능 필요없음. - 2019.08.12 강민석K (2019.08.05 김정민C 확인)
		btn_sibang.Visible = false;
		btn_plan.Left = 6;
	}
	
	//요청등록시간
	var reqRegTime = ds_list.GetColumn(ds_list.row, "REQ_REG_TIME");
	if(reqRegTime != null && reqRegTime != ""){
		ed_req_reg_time.Text = substr(reqRegTime, 0, 4) + "." + substr(reqRegTime, 4, 2)  + "." + substr(reqRegTime, 6, 2)
					   + " " + substr(reqRegTime, 8, 2) + ":" + substr(reqRegTime, 10, 2) + ":" + substr(reqRegTime, 12, 2);
	}
	
	//작업요청일
	var reqDate = ds_list.GetColumn(ds_list.row, "REQ_DATE");
	var reqTime = ds_list.GetColumn(ds_list.row, "REQ_TIME");
	if(reqDate != ""){
		ed_req_date.Text = substr(reqDate, 0, 4) + "-" + substr(reqDate, 4, 2) + "-" + substr(reqDate, 6, 2)
						 + " " + substr(reqTime, 0, 2) + ":" + substr(reqTime, 2, 2);
	}
	
	//작업예정일
	var expDate = ds_list.GetColumn(ds_list.row, "EXP_DATE");
	var expTime = ds_list.GetColumn(ds_list.row, "EXP_TIME");
	ed_exp_date.Text = substr(expDate, 0, 4) + "-" + substr(expDate, 4, 2) + "-" + substr(expDate, 6, 2)
				     + " " + substr(expTime, 0, 2) + ":" + substr(expTime, 2, 2);
	
	//작업시작일과 예상완료일
	var startDate = ds_list.GetColumn(ds_list.row, "START_DATE");
	if(startDate != null && startDate != ""){
		//이미 저장된 경우 저장된 일시 표시
		F_START_DATE_EVENT_ENABLE = false;
		
		cal_start_date.Value = startDate;//작업시작일
		cb_start_time.Value = substr(ds_list.GetColumn(ds_list.row, "START_TIME"), 0, 2);
		cb_start_minute.Value = substr(ds_list.GetColumn(ds_list.row, "START_TIME"), 2, 2);
		
		cal_plan_date.Value = ds_list.GetColumn(ds_list.row, "PLAN_DATE");//예상완료일
		cb_plan_time.Value = substr(ds_list.GetColumn(ds_list.row, "PLAN_TIME"), 0, 2);
		cb_plan_minute.Value = substr(ds_list.GetColumn(ds_list.row, "PLAN_TIME"), 2, 2);
		
		F_MODIFY_MODE = true;
	}else{
		//신규인 경우 현재일시 표시
		cal_start_date.Value = gfn_getCurrDate();//작업시작일
		cal_plan_date.Value = gfn_getCurrDate();//예상완료일
		
		F_MODIFY_MODE = false;
	}
	
	//작업완료가 된 경우 수정 불가
	var comDate = ds_list.GetColumn(ds_list.row, "COM_DATE");
	if(comDate != null && comDate != ""){
		cb_worker.Enable = false;//작업자콤보
		ed_worker_hp.Enable = false;//휴대폰
		cb_worker2.Enable = false;//작업자콤보2
		ed_worker_hp2.Enable = false;//휴대폰2
		
		//작업시작
		cal_start_date.Enable = false;//일자
		cb_start_time.Enable = false;//시간
		cb_start_minute.Enable = false;//분
		
		//예상완료
		cal_plan_date.Enable = false;//일자
		cb_plan_time.Enable = false;//시간
		cb_plan_minute.Enable = false;//분
		
		div_btn.btn_save.Enable = false;//저장버튼
		
		F_START_DATE_EVENT_ENABLE = false;
		
		if(startDate == null || startDate == ""){
			cal_start_date.Value = "";
		}
	}
	
	//결재가 진행중인 상태(미청구 또는 반려 상태가 아닌 경우)면 사진 추가/삭제 불가
	var state_code = ds_list.GetColumn(ds_list.row, "STATE_CODE");

	if(state_code != "" && state_code != "Z" && state_code != "A"){
		btn_upload.Enable = false;//파일추가버튼
		btn_del_file.Enable = false;//파일삭제버튼
	}
	
	// 비상콜결선, UTP변환기, 인터폰(디지털통화장치), CCTV내부배선의 경우는 TEXT 변경
	if(ds_list.getColumn(ds_list.row, "JOB_CODE") == 'V')	// 비상콜결선
	{
		Static26.Text = "비상콜 결선은 수시검사시 확인사항이므로 사진 생략후 진행바랍니다.";
	}
	else if(ds_list.getColumn(ds_list.row, "JOB_CODE") == 'W')	// UTP변환기
	{
		Static26.Text = "UTP변환기는 5번 작업완료 사진만 등록하시기 바랍니다.";
	}
	else if(ds_list.getColumn(ds_list.row, "JOB_CODE") == 'C')	// 인터폰
	{
		Static26.Text = "인터폰은 5번 작업완료 사진만 등록하시기 바랍니다.";
	}
	else if(ds_list.getColumn(ds_list.row, "JOB_CODE") == 'D')	// CCTV내부배선
	{
		Static26.Text = "CCTV내부배선은 5번 작업완료 사진만 등록하시기 바랍니다.";
	}
	else
	{
		// 나머지 작업은 그대로 둠.
	}
	
	//저장 시 필요한 고정정보 세팅
	ds_save.DeleteAll();
	ds_save.AddRow();
		
	ds_save.SetColumn(0, "PSPID", ds_list.GetColumn(ds_list.row, "PSPID"));			//프로젝트번호
	ds_save.SetColumn(0, "POSID", ds_list.GetColumn(ds_list.row, "POSID"));			//호기번호
	ds_save.SetColumn(0, "JOB_CODE", ds_list.GetColumn(ds_list.row, "JOB_CODE"));	//외주작업코드
	ds_save.SetColumn(0, "LIFNR", ds_list.GetColumn(ds_list.row, "LIFNR_OUT"));		//외주업체코드
	ds_save.SetColumn(0, "GBN", ds_list.GetColumn(ds_list.row, "GBN"));				//설치/구매 구분(A:설치, B:구매)
	ds_save.SetColumn(0, "PROC_VER", ds_list.GetColumn(ds_list.row, "PROC_VER"));	//프로세스 버전
	
	fn_query();
}
/********************************************************************************
* 기      능   : 공통코드가 조회된 후의 Callback 함수 
********************************************************************************/
function fn_completeInit(sCode, sDsObj, sCodeType) {

}
/********************************************************************************
* 기      능   : form UnloadCompleted 
********************************************************************************/
function fn_OnUnloadCompleted(obj) {
	return gfn_isFormUnload(obj);
}
//=========================================================================================
// [ PART 3 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,form닫기)
//=========================================================================================
/********************************************************************************
* 기      능   : 조회
********************************************************************************/
function fn_query() {
	ds_cond1.DeleteAll();
	ds_cond1.AddRow();
	
	ds_cond1.SetColumn(0, "POSID", ds_list.GetColumn(ds_list.row, "PSPID"));
	ds_cond1.SetColumn(0, "POSID_1", ds_list.GetColumn(ds_list.row, "POSID"));
	ds_cond1.SetColumn(0, "JOB_CODE", ds_list.GetColumn(ds_list.row, "JOB_CODE"));
	ds_cond1.SetColumn(0, "LIFNR", ds_list.GetColumn(ds_list.row, "LIFNR_OUT"));
	ds_cond1.SetColumn(0, "P_CODE", "4");
    //설치외주인 경우 메모관리 화면에서 설치, 업체는 디폴트로 체크하도록 하기 위해 설치/구매 구분값 추가 - 2019.09.19 강민석K (정태성K 요구사항)
    ds_cond1.SetColumn(0, "GBN", ds_list.GetColumn(ds_list.row, "GBN"));
	
	tit_clearActionInfo();
	tit_addSearchActionInfo("ps01:PS0101001A_S8");//도면정보 조회
	tit_addSearchActionInfo("ps15:PS1505001P_S1");//공지사항 조회
	tit_addSearchActionInfo("ps15:PS1505001P_S2");//메모 조회
	tit_addSearchActionInfo("ps15:PS1505001P_S5");//파일목록 조회
	tit_addSearchActionInfo("ps15:PS1505001P_S7");//작업자 콤보 조회
	tit_addSearchActionInfo("ps15:PS1505001A_S6");//사용자 권한 조회
	
	tit_callService(
          ""
        , ""
        , "ds_cond=ds_cond1"
        , "ds_pdf=ds_list10 ds_notice=ds_list ds_memo=ds_memo ds_file_list=ds_file_list ds_worker=ds_worker ds_auth=ds_auth"
        , ""
        , "fn_afterQuery"
        , true);
}
/********************************************************************************
* 기      능   : 저장 
********************************************************************************/
function fn_save() {
	//작업자 선택 여부 체크
	if(cb_worker.Index == 0){
		gfn_openMsgWin("작업자가 선택되지 않았습니다.", "E", "", "");
		cb_worker.SetFocus();
		return;
	}
	
	//작업시작일 체크 - 현장상황 상 실제 작업시작일에 입력을 못 할 수도 있으므로 날짜제한은 두지 않는다.
	var startDate = cal_start_date.Value;
	/*
	if(startDate < gfn_getCurrDate()){
		gfn_openMsgWin("금일보다 이전 일자로 저장할 수 없습니다.", "E", "", "");
		cal_start_date.SetFocus();
		return;
	}
	*/
	var planDate = cal_plan_date.Value;
	
	//작업시작일시 & 예상완료일시 체크 - 예상완료일시는 작업시작일시보다 이전 일 수 없다.
	var startDateTime = startDate + cb_start_time.Value + cb_start_minute.Value;
	var planDateTime = planDate + cb_plan_time.Value + cb_plan_minute.Value;
	
	if(toNumber(planDateTime) <= toNumber(startDateTime)){
		gfn_openMsgWin("예상완료 일시를 작업시작 일시 보다 이후로 입력하세요.", "E", "", "");
		cal_plan_date.SetFocus();
		return;
	}
		
	//사진 업로드 여부 체크
	//사진업로드 필수여부 관련 추가 - 2019.10.02 강민석K
	//if(ds_file_list.rowcount == 0){
	if(F_PIC_UPLOAD_YN == "Y" && ds_file_list.rowcount == 0){
		gfn_openMsgWin("작업시작 전 현장 상황 사진을 등록하세요.", "E", "", "");
		return;
	}
	
	var msg = "호기 : " + substr(st_posid.Text, 6, 3) + " / 작업명 : " + ed_jobname.Text
	        + "\n작업시작일시 : " + substr(startDate, 0, 4) + "-" + substr(startDate, 4, 2) + "-" + substr(startDate, 6, 2)
	        + " " + cb_start_time.Value + ":" + cb_start_minute.Value
	        + "\n예상완료일시 : " + substr(planDate, 0, 4) + "-" + substr(planDate, 4, 2) + "-" + substr(planDate, 6, 2)
	        + " " + cb_plan_time.Value + ":" + cb_plan_minute.Value
	        + "\n저장하시겠습니까?";
	
	if(!gfn_openMsgWin(msg, "I", "C", "")){
		return;
	}
	
	ds_save.SetColumn(0, "START_DATE", cal_start_date.Value);//작업시작일
	ds_save.SetColumn(0, "START_TIME", cb_start_time.Value + cb_start_minute.Value + "00");//작업시작시간
	ds_save.SetColumn(0, "PLAN_DATE", cal_plan_date.Value);//예상완료일
	ds_save.SetColumn(0, "PLAN_TIME", cb_plan_time.Value + cb_plan_minute.Value + "00");//예상완료시간
	ds_save.SetColumn(0, "WORKER_ID", cb_worker.Value);//작업자
	ds_save.SetColumn(0, "WORKER_HP", ed_worker_hp.Text);//휴대폰
	ds_save.SetColumn(0, "WORKER_ID2", cb_worker2.Value);//작업자2
	ds_save.SetColumn(0, "WORKER_HP2", ed_worker_hp2.Text);//휴대폰2
	
	tit_clearActionInfo();
	tit_addMultiActionInfo("ps15:PS1505001P_I5");
	tit_callService(
		  ""
		, ""
		, "ds_save=ds_save"
		, ""
		, ""
		, "fn_afterSave"
		, ""
		, ""
		, true);	
}
/********************************************************************************
* 기      능   : 닫기  
********************************************************************************/
function fn_close() {
	//parent.F_AUTO_QUERY = true;
	//parent.fn_query();
	close();
}
//=========================================================================================
// [ PART 4]
// Callback 함수 정의 : callback 함수명은 메인 함수의 fn_xxxx() 에서 xxxx 부분은 fn_afterXXXX()
// 형태가 되도록 작성 
//=========================================================================================
/********************************************************************************
* 기      능   : 조회 Callback  
********************************************************************************/
function fn_afterQuery(errCode, errMsg) {
	st_site_nm.Text = " " + ds_list.GetColumn(0, "ZSITE_NM");//Static 컨트롤에 왼쪽여백이 없어서 프로젝트명을 DataSet을 바인딩하지 않고 직접 표시함. - 2019.07.18 강민석K
	
	//작업자 콤보에 '-선택-' 추가
	gfn_insertEmptyRow(ds_worker, G_CODE_SELECT);
	
	ds_worker2.Copy(ds_worker);
	
	//작업자 콤보를 로그인ID로 세팅 - 없으면 index 0
	if(cb_worker.Index == -1){
		var nIndex = -1;
		var nIndex2 = -1;
		if(F_MODIFY_MODE == true){
			//수정모드인 경우 - 기존에 저장된 정보로 세팅
			nIndex = ds_worker.FindRow("CODE", ds_list.GetColumn(ds_list.row, "WORKER_ID"));
			if(nIndex == -1){
				cb_worker.Index = 0;
			}else{
				if(cb_worker.Enable == true){
					//수정가능 상태(작업시작이 되지 않은 상태)
					cb_worker.Index = nIndex;
					ds_worker2.Filter("CODE !="+ ds_list.GetColumn(ds_list.row, "WORKER_ID"));
				}else{
					//수정불가능 상태(작업완료가 된 상태)의 수정모드이면
					//안전교육 이수여부, 퇴사여부와 관계없이 무조건 저장된 이름으로 표시한다. - 2019.07.24 강민석K (송광용D 협의사항)
					//ex) 몇년 전에 완료된 작업을 조회했을 경우
					ds_worker.InsertRow(0);
					ds_worker.SetColumn(0, "CODE", ds_list.GetColumn(ds_list.row, "WORKER_ID"));
					ds_worker.SetColumn(0, "CODE_NAME", ds_list.GetColumn(ds_list.row, "WORKER_NAME"));
					cb_worker.Index = 0;
				}
			}
			ed_worker_hp.Text = ds_list.GetColumn(ds_list.row, "WORKER_HP");
			
			nIndex2 = ds_worker2.FindRow("CODE", ds_list.GetColumn(ds_list.row, "WORKER_ID2"));
			if(nIndex2 == -1){
				cb_worker2.Index = 0;
			}else{
				if(cb_worker2.Enable == true){
					//수정가능 상태(작업시작이 되지 않은 상태)
					cb_worker2.Index = nIndex2;
				}else{
					//수정불가능 상태(작업완료가 된 상태)의 수정모드이면
					//안전교육 이수여부, 퇴사여부와 관계없이 무조건 저장된 이름으로 표시한다. - 2019.07.24 강민석K (송광용D 협의사항)
					//ex) 몇년 전에 완료된 작업을 조회했을 경우
					ds_worker2.InsertRow(0);
					ds_worker2.SetColumn(0, "CODE", ds_list.GetColumn(ds_list.row, "WORKER_ID"));
					ds_worker2.SetColumn(0, "CODE_NAME", ds_list.GetColumn(ds_list.row, "WORKER_NAME"));
					
					cb_worker2.Index = 0;
				}
			}
			ed_worker_hp2.Text = ds_list.GetColumn(ds_list.row, "WORKER_HP2");
			
		}else{
			//신규모드인 경우 - 작업자 콤보를 로그인ID로 세팅 - 없으면 index 0
			nIndex = ds_worker.FindRow("CODE", G_USER_ID);
			if(nIndex == -1){
				cb_worker.Index = 0;
			}else{
				cb_worker.Index = nIndex;
				ed_worker_hp.Text = ds_worker.GetColumn(nIndex, "USERMBPN");
			}
			cb_worker2.Index = 0;	//작업자 2는 무조건 -선택-으로 세팅
			ed_worker_hp2.Text = "";
		}
	}
	
	ta_notice.Text = "※공지사항 : " + ds_notice.GetColumn(0, "CONTENTS");
	
	//서비스(ZPS12), 안전(ZPS36) 팀은 조회만 가능
	var bOut_Lifnr = false;//외주업체 여부 추가 - 설치협력사면서 외주업체인 경우가 있어서 변수 추가 - 2019.09.27 강민석K
    for(var i = 0; i < ds_auth.rowcount; i++){
		userAuth = ds_auth.GetColumn(i, "AUTH");
		
		//설치협력사(ZPS05), 영업(ZPS08) 팀도 조회만 가능하도록 추가 - 2019.09.27 강민석K
		//if(userAuth == "ZPS12" || userAuth == "ZPS36"){
		if(userAuth == "ZPS12" || userAuth == "ZPS36" || userAuth == "ZPS05" || userAuth == "ZPS08"){
			div_btn.btn_save.Enable = false;//저장버튼
			cb_worker.Enable = false;//작업자
			ed_worker_hp.Enable = false;//휴대폰
			cb_worker2.Enable = false;//작업자2
			ed_worker_hp2.Enable = false;//휴대폰2
			cal_start_date.Enable = false;//작업시작 일
			cb_start_time.Enable = false;//작업시작 시간
			cb_start_minute.Enable = false;//작업시작 분
			cal_plan_date.Enable = false;//예상완료 일
			cb_plan_time.Enable = false;//예상완료 시간
			cb_plan_minute.Enable = false;//예상완료 분
			btn_upload.Enable = false;//파일추가버튼
			btn_del_file.Enable = false;//파일삭제버튼
		}
		
		if(userAuth == "ZPS13"){
			bOut_Lifnr = true;
		}
    }
    
    //설치협력사면서 외주업체인 경우가 있어서 추가 - 2019.09.27 강민석K
	var comDate = ds_list.GetColumn(ds_list.row, "COM_DATE");
    if(bOut_Lifnr == true){
		if(comDate == null || comDate == ""){
			div_btn.btn_save.Enable = true;//저장버튼
			cb_worker.Enable = true;//작업자
			ed_worker_hp.Enable = true;//휴대폰
			cb_worker2.Enable = true;//작업자2
			ed_worker_hp2.Enable = true;//휴대폰2
			cal_start_date.Enable = true;//작업시작 일
			cb_start_time.Enable = true;//작업시작 시간
			cb_start_minute.Enable = true;//작업시작 분
			cal_plan_date.Enable = true;//예상완료 일
			cb_plan_time.Enable = true;//예상완료 시간
			cb_plan_minute.Enable = true;//예상완료 분

		}
		//결재가 진행중인 상태(미청구 또는 반려 상태가 아닌 경우)면 사진 추가/삭제 불가
		var state_code = ds_list.GetColumn(ds_list.row, "STATE_CODE");
		
		//결재상태가 A(신청)인 경우도 버튼 활성화하도록 수정 - 2019.10.10 강민석K (송광용D 요청사항)
		//if(state_code != "" && state_code != "Z"){
		if(state_code != "" && state_code != "A" && state_code != "Z"){
			btn_upload.Enable = false;//파일추가버튼
			btn_del_file.Enable = false;//파일삭제버튼
		}else{
			btn_upload.Enable = true;//파일추가버튼
			btn_del_file.Enable = true;//파일삭제버튼
		}
    }
}
/********************************************************************************
* 기      능   : 저장 Callback  
********************************************************************************/
function fn_afterSave(errCode, errMsg) {
	if(errCode != 0){
		gfn_showMsg("CE00001");
	}else{
		tit_clearActionInfo();
		tit_addSearchActionInfo("ps15:PS1505001P_S13");//문자발송 스킵 가능여부 조회
		tit_callService(
			  ""
			, ""
			, "ds_save=ds_save"
			, "ds_check_sms_send=ds_check_sms_send"
			, ""
			, "fn_afterCheckAlreadySendSms"
			, true);
	}
}
//=========================================================================================
// [ PART 5 ]
// Detail Process Event 정의 ( User Define function )
// 사용자 정의 함수는 ufn_xxxx() 형태로 작성 
//=========================================================================================
/********************************************************************************
* 기      능   : 시간, 분 콤보 초기화 및 세팅
********************************************************************************/
function ufn_initTimeCombo() {
	//작업시작 - 시간 콤보 초기화
	ds_st_time.DeleteAll();
	for(var i = 0; i < 24; i++){
		ds_st_time.AddRow();
		
		if(i < 10){
			ds_st_time.SetColumn(i, "CODE", "0" + ToString(i));
			ds_st_time.SetColumn(i, "CODE_NAME", "0" + ToString(i));
		}else{
			ds_st_time.SetColumn(i, "CODE", ToString(i));
			ds_st_time.SetColumn(i, "CODE_NAME", ToString(i));
		}
	}
	
	//작업시작 - 분 콤보 초기화
	ds_st_minute.DeleteAll();
	for(var i = 0; i < 6; i++){
		ds_st_minute.AddRow();
		
		if(i == 0){
			ds_st_minute.SetColumn(i, "CODE", "00");
			ds_st_minute.SetColumn(i, "CODE_NAME", "00");
		}else{
			ds_st_minute.SetColumn(i, "CODE", ToString(i) + "0");
			ds_st_minute.SetColumn(i, "CODE_NAME", ToString(i) + "0");
		}
	}
	
	//예상완료 - 시간 콤보 초기화
	ds_pl_time.DeleteAll();
	for(var i = 0; i < 24; i++){
		ds_pl_time.AddRow();
		
		if(i < 10){
			ds_pl_time.SetColumn(i, "CODE", "0" + ToString(i));
			ds_pl_time.SetColumn(i, "CODE_NAME", "0" + ToString(i));
		}else{
			ds_pl_time.SetColumn(i, "CODE", ToString(i));
			ds_pl_time.SetColumn(i, "CODE_NAME", ToString(i));
		}
	}
	
	//예상완료 - 분 콤보 초기화
	ds_pl_minute.DeleteAll();
	for(var i = 0; i < 6; i++){
		ds_pl_minute.AddRow();
		
		if(i == 0){
			ds_pl_minute.SetColumn(i, "CODE", "00");
			ds_pl_minute.SetColumn(i, "CODE_NAME", "00");
		}else{
			ds_pl_minute.SetColumn(i, "CODE", ToString(i) + "0");
			ds_pl_minute.SetColumn(i, "CODE_NAME", ToString(i) + "0");
		}
	}
	
	//현재 시, 분으로 콤보 세팅
	var curDateTime = GetDate();
	cb_start_time.Value = substr(curDateTime, 8, 2);
	//분 콤보는 디폴트로 00으로 세팅 - 2019.09.19 강민석K (고범석K 요구사항)
	//cb_start_minute.Value = substr(curDateTime, 10, 1) + "0";
	cb_start_minute.Value = "00";
	
	cb_plan_time.Value = substr(curDateTime, 8, 2);
	//분 콤보는 디폴트로 00으로 세팅 - 2019.09.19 강민석K (고범석K 요구사항)
	//cb_plan_minute.Value = substr(curDateTime, 10, 1) + "0";
	cb_plan_minute.Value = "00";
}
/********************************************************************************
* 기      능   : 프로젝트, 외주작업구분, 외주업체코드, 작업시작일자가 모두 같고 호기가 다른 경우 문자를 보내지 않기 위해 추가. 2019.09.19 강민석K
********************************************************************************/
function fn_afterCheckAlreadySendSms(errCode, errMsg) {
	//trace("fn_afterCheckAlreadySendSms errCode : " + errCode);
	
	//문자 내용 준비
	var startDate = cal_start_date.Value;
	var msg = "";
	msg += ed_lifnr_out_name.Text + "(" + ed_jobname.Text + ") " + cb_worker.Text;
	if(ed_worker_hp2.Text != ""){
		msg += ", " + cb_worker2.Text;
	}
	msg += "이(가) ";
	
	//요구사항에는 없지만 날짜도 필요할 것 같아서 추가 - 2019.08.02 강민석K
	msg += substr(startDate, 0, 4) + "년 " + substr(startDate, 4, 2) + "월 " + substr(startDate, 6, 2) + "일 " + cb_start_time.Value + "시 " + cb_start_minute.Value + "분에 ";
	msg += ds_list.GetColumn(ds_list.row, "ZSITE_NM_SMS") + " ";//프로젝트명은 12자로 한정
	
	//동 정보가 없으면 미표시
	if(st_dong.Text != ""){
		msg += st_dong.Text + " ";
	}
	msg += st_posid.Text + "에서 작업을 시작합니다.\n안전사고가 발생하지 않도록 주의 바랍니다.";
	
	if(errCode != 0){
		gfn_showMsg("CE00001");
		
		//문자발송 스킵 가능여부 조회가 실패해도 안전사고 예방을 위해 문자는 보낸다. - 2019.09.19 강민석K
		ufn_sendSms(msg);
	}else{
		gfn_showMsg("CI00003");
		
		//trace("ds_check_sms_send CNT : " + ds_check_sms_send.GetColumn(0, "CNT"));
		if(ds_check_sms_send.GetColumn(0, "CNT") == "0"){
			ufn_sendSms(msg);
		}
	}
	
	ufn_sendNote(msg);
	
	parent.F_AUTO_QUERY = true;
	parent.fn_query();
	close();
}
/********************************************************************************
* 기      능   : 문자발송 기능을 함수로 분리 - 2019.09.19 강민석K
********************************************************************************/
function ufn_sendSms(msg){
	//문자발송 - 참조 : PS0490001A (기기인증)
	gfn_initDs(ds_sms, true);
	ds_sms.SetColumn(0,"TRAN_ETC1", "SRM");
	ds_sms.SetColumn(0,"TRAN_TYPE", "0");
	ds_sms.SetColumn(0,"TRAN_STATUS", "0");
	ds_sms.SetColumn(0,"TRAN_MSG", msg);
	
	tit_clearActionInfo();
	tit_addSearchActionInfo("ps15:PS1505001G_S1");// 문자발송 일시 SELECT
	tit_callService(
          ""
        , ""
        , "ds_cond=ds_cond"
        , "ds_datetime=ds_datetime"
        , ""
        , ""
        , ""
        , ""
        , true);
    
    ds_sms.SetColumn(0, "TRAN_TIME", ds_datetime.GetColumn(0, "DATETIME"));
        
	if(ed_team_hp.Text != ""){
		ds_sms.SetColumn(0,"TRAN_PHONE", ed_team_hp.Text);//받는사람 번호 - 작업팀장
		ds_sms.SetColumn(0,"TRAN_PHONE", '01071601959');
		tit_clearActionInfo();
		tit_addMultiActionInfo("ps15:PS1505001G_I1");
		tit_callService(
			  "PDA_ACT"
			, ""
			, "ds_sms=ds_sms"
			, ""
			, ""
			, ""
			, ""
			, ""
			, true);
	}
	
	if(ed_pm_hp.Text != ""){
		ds_sms.SetColumn(0,"TRAN_PHONE", ed_pm_hp.Text);//받는사람 번호 - 설치PM
		ds_sms.SetColumn(0,"TRAN_PHONE", '01071601959');
		tit_clearActionInfo();
		tit_addMultiActionInfo("ps15:PS1505001G_I1");
		tit_callService(
			  "PDA_ACT"
			, ""
			, "ds_sms=ds_sms"
			, ""
			, ""
			, ""
			, ""
			, ""
			, true);
	}
}
/********************************************************************************
* 기      능   : 쪽지발송 기능을 함수로 분리 - 2019.09.19 강민석K (장성원PM 요구사항)
********************************************************************************/
function ufn_sendNote(msg){
	gfn_initDs(ds_msgsend, true);
	ds_msgsend.SetColumn(0, "MESGSEND", G_USER_ID);//발신자
	ds_msgsend.SetColumn(0, "MESGTITL", "외주작업 시작");//제목
	ds_msgsend.SetColumn(0, "MESGDESC", msg);//내용
	
	//작업팀장
	var namet_id = ds_list.GetColumn(ds_list.row, "NAMET_ID");
	if(namet_id != null && namet_id != ""){
		ds_msgsend.SetColumn(0, "MESGACCP", namet_id);//수신자
		
		tit_clearActionInfo();
		tit_addSingleActionInfo("ps13:PS1301007B_I2");
		tit_callService(
			  ""
			, ""
			, "ds_msgsend=ds_msgsend"
			, ""
			, ""
			, "");
	}
	
	//설치PM
	var pm_id = ds_list.GetColumn(ds_list.row, "PM_ID");
	if(pm_id != null && pm_id != ""){
		ds_msgsend.SetColumn(0, "MESGACCP", pm_id);//수신자
		
		tit_clearActionInfo();
		tit_addSingleActionInfo("ps13:PS1301007B_I2");
		tit_callService(
			  ""
			, ""
			, "ds_msgsend=ds_msgsend"
			, ""
			, ""
			, "");
	}
}
//=========================================================================================
// [ PART 6 ]
// component Event 정의 : 각 Component 별 이벤트 
//=========================================================================================
/********************************************************************************
* 기      능   : 그리드 헤더 클릭시 정렬 처리 
********************************************************************************/
function grd_list_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
{
	if ( nCell == 0 ) {
		// 그리드 표시할 컬럼 선택 
		gfn_selectGridCol(obj);
	} else {
		// 그리드 정렬 처리 
		gfn_sortGrid(obj,nCell);
	}
}
/********************************************************************************
* 기      능   : 데이터셋 값 변경 시 - Flag 처리 
********************************************************************************/
function ds_list_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{
	gfn_changeFlag( obj, strColumnID, nRow, "FLAG" );
}
/********************************************************************************
* 기      능   : 시방조회 버튼 클릭 시 - 시방조회 화면 팝업
********************************************************************************/
function btn_sibang_OnClick(obj)
{
	var arg  = "PSPID=" + quote(ds_list.GetColumn(ds_list.row, "PSPID"));//프로젝트번호
		arg += " POSID=" + quote(st_posid.Text);//호기번호
		arg += " SITE_NM=" + quote(st_site_nm.Text);//프로젝트명
		arg += " JOB_CODE=" + quote(ds_list.GetColumn(ds_list.row, "JOB_CODE"));//외주작업코드
	gfn_openPopup("PS1505001E", true, arg);
}
/********************************************************************************
* 기      능   : 도면 버튼 클릭 시 - 도면 화면 팝업
********************************************************************************/
function btn_plan_OnClick(obj)
{
	if(length(ds_pdf.getColumn(0, "UDATE")) > 0){
		fn_createWait("", this);
		//==========================================================================================================
		var FileName = ds_pdf.getColumn(0, "POSID") + '.pdf';
		//var FileName = '173395.pdf';//테스트용
		var FilePath = "c:\\Temp";
		var FileExec = "c:\\Temp\\" + FileName;
        
        //trace("FileName : [" + FileName + "]");
        //trace("FilePath : [" + FilePath + "]");
        //trace("FileExec : [" + FileExec + "]");
        
		var rMsg = tit_fileRead(
			  httpFile
			, "PDM"		// 저장 디렉토리
			, FileName	// 서버에서 전송받을 이름
			, FilePath	// 로컬 경로
			, FileName	// 로컬 파일명
		);
		fn_destroyWait();
		
		if(rMsg[0] == "E"){
			if(length(trim(rMsg[1])) > 0){
				gfn_showAlert("CW10025", rMsg[1]);
			}else{
				gfn_showAlert("CW10025", "파일 다운로드에 실패하였습니다.");
			}
		}else{
			ExecShell(FileExec);
		}
		//==========================================================================================================
	}else{
		gfn_alert("해당 프로젝트는 PDF 도면이 없습니다.\n\n(PDM에서 조회하시기 바랍니다)");
    }
}
/********************************************************************************
* 기      능   : 메모추가 버튼 클릭 시 - 메모관리 화면 팝업
********************************************************************************/
function btn_add_OnClick(obj)
{
	var arg  = "CRNAM=" + quote("");//입력자
		//알림 대상자 추가 - 2019.09.18 강민석K
		arg += " PM_ID=" + quote(ds_list.GetColumn(ds_list.row, "PM_ID"));//설치PM
		arg += " SERVICE_HP=" + quote(ds_list.GetColumn(ds_list.row, "SERVICE_HP"));//서비스담당자 - MMS에 푸시를 보낼 수 없어 서비스담당자는 문자로 발송하기로 함. 2019.09.19 강민석K(PM리뷰 회의 결정)
		arg += " SALES_ID=" + quote(ds_list.GetColumn(ds_list.row, "SALES_ID"));//영업담당자
		arg += " OUT_TEAM_ID=" + quote(ds_list.GetColumn(ds_list.row, "OUT_TEAM_ID"));//외주업체 팀장
		arg += " WORKER_ID=" + quote(ds_list.GetColumn(ds_list.row, "WORKER_ID"));//작업자1
		arg += " WORKER_ID2=" + quote(ds_list.GetColumn(ds_list.row, "WORKER_ID2"));//작업자2
	gfn_openPopup("PS1505001C", true, arg);
}
/********************************************************************************
* 기      능   : 삭제 버튼 클릭 시 - 선택한 메모 삭제
********************************************************************************/
function btn_delete_OnClick(obj)
{
	//항목 선택 여부 체크
	if(ds_memo.FindRow("CHK", "1") == -1){
		gfn_showMsg("CW00046");
		return;
	}
	
	//메모 삭제는 1건씩만 가능
	ds_memo.Filter("CHK == '1'");
	var nChkCnt = ds_memo.rowcount;
	ds_memo.UnFilter();
	
	if(nChkCnt > 1){
		gfn_openMsgWin("메모 삭제는 1건씩만 가능합니다.", "I", "", "");
		return;
	}
	
	//입력자와 로그인 사용자가 같은지 체크
	if(userGroup != "40"){//단, 관리팀 권한인 경우 삭제 가능 - 고범석K 요청사항
		for(var i = 0; i < ds_memo.rowcount; i++){
			if(ds_memo.GetColumn(i, "CHK") == "1" && ds_memo.GetColumn(i, "CRID") != G_USER_ID){
				gfn_openMsgWin("메모 삭제는 등록자만 가능합니다.", "I", "", "");
				return;
			}
		}
	}
	
	//삭제 여부 확인
	if(!gfn_openMsgWin("선택한 메모를 삭제 하시겠습니까?", "I", "C", "")){
		return;
	}
	
	ds_memo_del.ClearData();
	ds_memo_del.AddRow();
	
	// SEQ_LIST 만들기(메모 다중 선택 삭제) - 단건 삭제로 바꿨지만 실제 삭제 로직은 다중으로 남겨둔다
	var sSeqList = "";
	for(var j = 0; j < ds_memo.rowcount; j++){
		if(ds_memo.GetColumn(j, "CHK") == "1"){
			ds_memo_del.SetColumn(0, "PSPID", ds_list.GetColumn(ds_list.row, "PSPID"));
			ds_memo_del.SetColumn(0, "POSID", ds_list.GetColumn(ds_list.row, "POSID"));
			ds_memo_del.SetColumn(0, "LIFNR", ds_list.GetColumn(ds_list.row, "LIFNR_OUT"));
			
			sSeqList += "'" + ds_memo.GetColumn(j, "SEQ") + "',";
			//trace("memo SEQ : " + ds_memo.GetColumn(j, "SEQ"));
		}
	}
	sSeqList = "(" + substr(sSeqList, 0, length(sSeqList) - 1) + ")";
	
	qry= " AND SEQ IN " + sSeqList;
	args = " SQRY=" + quote(qry);
	
	tit_clearActionInfo();
	tit_addSearchActionInfo("ps15:PS1505001P_U1");//메모 삭제
	tit_callService(
		  ""
		, ""
	    , "ds_memo_del=ds_memo_del"
	    , ""
	    , args
	    , ""
	    , ""
	    , ""
	    , true);
	
	fn_query();
}
/********************************************************************************
* 기      능   : 메모 그리드 더블클릭 시 - 선택한 메모 상세 표시
********************************************************************************/
function grd_memo_OnCellDblClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
	if(nCell != 0){
		var arg  = "CRNAM=" + quote(ds_memo.GetColumn(nRow, "CRNAM"));//입력자
		    arg += " BELONG=" + quote(ds_memo.GetColumn(nRow, "BELONG"));//소속
		    arg += " CONTENTS=" + quote(ds_memo.GetColumn(nRow, "CONTENTS_ORIG"));//내용
			arg += " ALM_INDC=" + quote(ds_memo.GetColumn(nRow, "ALM_INDC"));//알림대상
		    //arg += " CRID=" + quote(ds_memo.GetColumn(nRow, "CRID"));//입력자ID
		    arg += " PSPID=" + quote(ds_cond1.getColumn(0, "POSID"));//프로젝트 번호
            arg += " POSID=" + quote(ds_cond1.getColumn(0, "POSID_1"));//호기 번호
            arg += " LIFNR=" + quote(ds_memo.GetColumn(0, "MEMO_LIFNR"));//업체코드
            arg += " SEQ=" + quote(ds_memo.GetColumn(nRow, "SEQ"));//SEQ
		gfn_openPopup("PS1505001C", true, arg);
	}
}
/********************************************************************************
* 기      능   : 작업시작일 변경 시 - 
********************************************************************************/
function cal_start_date_OnChanged(obj,strOldText,strNewText)
{
	//우선 입력 가능 일자에 제한을 두지 않는다. - 2019.07.23 강민석K
	return;
	if(F_START_DATE_EVENT_ENABLE == true){
		if(strNewText < gfn_getCurrDate()){
			gfn_openMsgWin("금일보다 이전 일자로 선택할 수 없습니다.", "E", "", "");
			cal_exp_date.Value = gfn_getCurrDate();
			cal_exp_date.SetFocus();
		}
	}else{
		F_START_DATE_EVENT_ENABLE = true;
	}
}
/********************************************************************************
* 기      능   : 예상완료일 변경 시 - 
********************************************************************************/
function cal_plan_date_OnChanged(obj,strOldText,strNewText)
{
	
}
/********************************************************************************
* 기      능   : 파일 다운로드 클릭 시 - 선택한 파일 다운로드
********************************************************************************/
function btn_download_OnClick(obj)
{
	if(ds_file_list.rowcount == 0) return;
	
	var nRow = ds_file_list.rowposition;
	
	var svrFileName = ds_file_list.GetColumn(nRow, "FNAME_APP");
	var orgFileName = ds_file_list.GetColumn(nRow, "FNAME");
	var ext         = gfn_getFileExt(ds_file_list.GetColumn(nRow, "FNAME"));

	saveDialog.FileName = orgFileName;
	saveDialog.Filter = "All(*.*)|*.*";
	saveDialog.FilterIndex = "";
    var sRtn = saveDialog.open();
	
	if(sRtn != "1") return;
	
	var idx = indexOf(saveDialog.FileName, ".");
	var fdFileName = saveDialog.FileName;
    var fileName =  decode(idx, -1, fdFileName, substr(fdFileName, 0, indexOf(fdFileName, ".")));
    var localFileName = fileName + "." + ext;

	var rMsg = tit_fileRead(
					httpFile
				  , "PS"				// 서버 저장 디렉토리
				  , svrFileName			// 서버에서 전송받을 이름
				  , saveDialog.FilePath	// 로컬 경로
				  , localFileName		// 로컬 파일명
				);
	
	if(rMsg[0] == "E"){
		if(length(trim(rMsg[1])) > 0){
			gfn_showAlert("CW10025", rMsg[1]);
		}else{
			gfn_showAlert("CW10025", "파일 다운로드에 실패하였습니다.");
		}
	}else{
		gfn_showAlert("CW10025", "파일을 다운로드 하였습니다.");
	}
}
/********************************************************************************
* 기      능   : 파일추가 클릭 시 - 파일선택창 표시
********************************************************************************/
function btn_upload_OnClick(obj)
{
	var fileName = "";
	
	if(ds_file_list.rowcount >= 3)
	{
		gfn_openMsgWin("추가할 수 있는 파일 개수를 초과했습니다.\n(최대 3개 저장가능)", "", "A");
		return;
	}
	
	gfn_openPopup("PS1505001H", true);
}
/********************************************************************************
* 기      능   : 파일 삭제 후 Callback
********************************************************************************/
function fn_afterFileAddDel()
{
	ds_cond1.DeleteAll();
	ds_cond1.AddRow();
	
	ds_cond1.SetColumn(0, "POSID", ds_list.GetColumn(ds_list.row, "PSPID"));
	ds_cond1.SetColumn(0, "POSID_1", ds_list.GetColumn(ds_list.row, "POSID"));
	ds_cond1.SetColumn(0, "JOB_CODE", ds_list.GetColumn(ds_list.row, "JOB_CODE"));
	ds_cond1.SetColumn(0, "LIFNR", ds_list.GetColumn(ds_list.row, "LIFNR_OUT"));
	ds_cond1.SetColumn(0, "P_CODE", "4");
	
	tit_clearActionInfo();
	tit_addSearchActionInfo("ps15:PS1505001P_S5");//파일목록 조회
	tit_callService(
          ""
        , ""
        , "ds_cond=ds_cond1"
        , "ds_file_list=ds_file_list"
        , ""
        , ""
        , true);
}
/********************************************************************************
* 기      능   : 파일삭제 클릭 시 - 선택한 파일 삭제
********************************************************************************/
function btn_del_file_OnClick(obj)
{
	if(ds_file_list.rowcount == 0){
		gfn_showMsg("삭제할 사진이 없습니다.");
		return;
	}
	
	ds_file_list.Filter("CHK == '1'");
	var nChkCnt = ds_file_list.rowcount;
	//trace("nChkCnt : " + nChkCnt);
	ds_file_list.UnFilter();
	
	if(nChkCnt == 0){
		gfn_showMsg("삭제할 사진을 선택하세요.");
		return;
	}else{
		if(F_MODIFY_MODE == true){//수정모드일 경우
			if(nChkCnt > 1){
				//다중 삭제 제한 추가 - 수정모드 일 때는 전체 삭제되면 안되기 때문에 로직 추가 - 2019.07.24 강민석K
				gfn_showMsg("사진 삭제는 1건씩만 가능합니다.");
				return;
			}
			
			ds_file_list.UnFilter();//ds_file_list의 전체 rowcount를 얻기 위해 UnFilter (예비용)
			
			//사진업로드 필수여부 관련 추가 - 2019.10.02 강민석K
			//if(ds_file_list.rowcount == 1){
			if(F_PIC_UPLOAD_YN == "Y" && ds_file_list.rowcount == 1){
				gfn_openMsgWin("작업시작 정보가 저장된 호기는 사진이 1개 이상 등록되어 있어야 합니다.", "W", "", "");
				return;
			}
		}
	}
	
	//삭제 여부 확인
	if(!gfn_openMsgWin("선택한 파일을 삭제 하시겠습니까?", "I", "C", "")){
		return;
	}
	
	for(var i = 0; i < ds_file_list.rowcount; i++)
	{
		var sFileName = ds_file_list.GetColumn(i, "FNAME");
		var sChk      = ds_file_list.GetColumn(i, "CHK");
		
		if(length(sFileName) != 0 && sChk == "1")
		{
			var arr = tit_fileDelete("PS", ds_file_list.GetColumn(i, "FNAME_APP"), false);
		}
	}
	
	// 체크된 파일만 삭제처리
	ds_file_list.Filter("CHK == '1'");
	ds_file_del.copyF(ds_file_list);
	ds_file_list.unFilter();
	
	// 파일 삭제 저장
	tit_clearActionInfo();	
	tit_addMultiActionInfo("ps15:PS1505001P_U2");
	tit_callService(
		  ""
		, ""        
		, "ds_file=ds_file_del"
		, ""
		, ""
		, "fn_afterFileAddDel"
		, ""
		, ""
		,true
	);
}
/********************************************************************************
* 기      능   : 첨부파일 그리드 더블클릭 시 - 파일 다운로드
********************************************************************************/
function grd_file_OnCellDblClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
	if(nCell != 0){
		if(length(ds_file_list.GetColumn(nRow, "FNAME")) > 0){
			// 첨부 파일 처리 
			fn_createWait("", this);
			
			var FilePath = "c:\\Temp";
			var FileExec = "c:\\Temp\\" + ds_file_list.GetColumn(nRow, "FNAME");
			
			saveDialog.FileName = ds_file_list.GetColumn(nRow, "FNAME");
			
			var rMsg = tit_fileRead(httpFile
				, "PS"										// 저장 디렉토리
				, ds_file_list.GetColumn(nRow, "FNAME_APP")	// 서버에서 전송받을 이름
				, FilePath									// 로컬 경로
				, ds_file_list.GetColumn(nRow, "FNAME")		// 로컬 파일명
			);
			
			fn_destroyWait();
			
			if(rMsg[0] == "E"){
				if(length(trim(rMsg[1])) > 0){
					gfn_showAlert("CW10025", rMsg[1]);
				}else{
					gfn_showAlert("CW10025", "파일 다운로드에 실패하였습니다.");
				}
			}else{
				ExecShell(FileExec);
			}
		}
	}
}
/********************************************************************************
* 기      능   : 작업자 변경 시 - 작업자의 휴대폰 번호 표시
********************************************************************************/
function cb_worker_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	ed_worker_hp.Text = ds_worker.GetColumn(nNewIndex, "USERMBPN");
	
	var idx2 = cb_worker2.Index;
	var sel_code1 = ds_worker.GetColumn(nNewIndex, "CODE");
	var sel_code2 = ds_worker2.GetColumn(idx2, "CODE");
	
//	trace("ds_worker : "+ sel_code1 +", "+ cb_worker2.Index);
//	trace("ds_worker2: "+ sel_code2);
	
	if(idx2 != 0 && sel_code1 == sel_code2) {
		cb_worker2.Index = 0;
		ed_worker_hp2.Text = "";
	}
	ds_worker2.Filter("CODE !="+ sel_code1);
}

function cb_worker_OnChanged2(obj,strCode,strText,nOldIndex,nNewIndex)
{
	ed_worker_hp2.Text = ds_worker2.GetColumn(nNewIndex, "USERMBPN");
	
}]]></Script>
</Window>