<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="562" Id="PS1505003A" Left="8" OnLoadCompleted="fn_OnLoadCompleted" OnUnloadCompleted="fn_OnUnloadCompleted" PidAttrib="7" Title="외주공사&#32;알림관리" Top="8" Ver="1.0" Width="978" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_list" OnColumnChanged="ds_list_OnColumnChanged">
				<Contents>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="GUBUN" size="256" summ="default" type="STRING"/>
					<colinfo id="JOB_NAME" size="256" summ="default" type="STRING"/>
					<colinfo id="JOB_CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="READ_DATE" size="256" summ="default" type="STRING"/>
					<colinfo id="PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSITE_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="M_TYPE" size="256" summ="default" type="STRING"/>
					<colinfo id="CONTENTS" size="256" summ="default" type="STRING"/>
					<colinfo id="CONTENTS_ORIG" size="256" summ="default" type="STRING"/>
					<colinfo id="ALM_INDC" size="256" summ="default" type="STRING"/>
					<colinfo id="CRDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="CRTIM" size="256" summ="default" type="STRING"/>
					<colinfo id="CRNAM" size="256" summ="default" type="STRING"/>
					<colinfo id="BELONG" size="256" summ="default" type="STRING"/>
					<colinfo id="USERNAME" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_zzpmnum_cd">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_zzlifnr_cd">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZACTSS" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_workgubun">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_gbn">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE>A</CODE>
						<CODE_NAME>설치외주</CODE_NAME>
					</record>
					<record>
						<CODE>B</CODE>
						<CODE_NAME>구매외주</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_memo">
				<Contents>
					<colinfo id="SUP_DTF" size="256" summ="default" type="STRING"/>
					<colinfo id="SUP_DTT" size="256" summ="default" type="STRING"/>
					<colinfo id="CRNAM" size="256" summ="default" type="STRING"/>
					<colinfo id="PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="JOB_CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="M_TYPE" size="256" summ="default" type="STRING"/>
					<colinfo id="BELONG" size="256" summ="default" type="STRING"/>
					<colinfo id="GUBUN" size="256" summ="default" type="STRING"/>
					<colinfo id="READ_YN" size="256" summ="default" type="STRING"/>
					<record>
						<BELONG></BELONG>
						<CRNAM></CRNAM>
						<GUBUN></GUBUN>
						<JOB_CODE></JOB_CODE>
						<LIFNR></LIFNR>
						<M_TYPE></M_TYPE>
						<POSID></POSID>
						<PSPID></PSPID>
						<READ_YN></READ_YN>
						<SUP_DTF></SUP_DTF>
						<SUP_DTT></SUP_DTT>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_belong">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE>설치</CODE>
						<CODE_NAME>설치</CODE_NAME>
					</record>
					<record>
						<CODE>업체</CODE>
						<CODE_NAME>업체</CODE_NAME>
					</record>
					<record>
						<CODE>서비스</CODE>
						<CODE_NAME>서비스</CODE_NAME>
					</record>
					<record>
						<CODE>영업</CODE>
						<CODE_NAME>영업</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond">
				<Contents>
					<colinfo id="LIFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="SUP_DTF" size="256" summ="default" type="STRING"/>
					<colinfo id="SUP_DTT" size="256" summ="default" type="STRING"/>
					<colinfo id="PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZACTSS" size="256" summ="default" type="STRING"/>
					<colinfo id="USER_CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="USER_GRUP" size="256" summ="default" type="STRING"/>
					<colinfo id="PERIOD" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZPMNUM" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZLIFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="I_RA" size="256" summ="default" type="STRING"/>
					<colinfo id="CONFIRM_GUBUN" size="256" summ="default" type="STRING"/>
					<colinfo id="CHARGE" size="256" summ="default" type="STRING"/>
					<colinfo id="WORK_GUBUN" size="256" summ="default" type="STRING"/>
					<colinfo id="PROCESS" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
					<colinfo id="MEMO_SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="SVC_YN" size="256" summ="default" type="STRING"/>
					<record>
						<CHARGE></CHARGE>
						<CONFIRM_GUBUN></CONFIRM_GUBUN>
						<I_RA></I_RA>
						<LIFNR></LIFNR>
						<MEMO_SEQ></MEMO_SEQ>
						<PERIOD></PERIOD>
						<POSID></POSID>
						<PROCESS></PROCESS>
						<PSPID></PSPID>
						<SUP_DTF></SUP_DTF>
						<SUP_DTT></SUP_DTT>
						<SVC_YN></SVC_YN>
						<USER_CODE></USER_CODE>
						<USER_GRUP></USER_GRUP>
						<WORK_GUBUN></WORK_GUBUN>
						<ZZACTSS></ZZACTSS>
						<ZZLIFNR></ZZLIFNR>
						<ZZPMNUM></ZZPMNUM>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond_check">
				<Contents></Contents>
			</Dataset>
		</Datasets>
		<Shape BKColor="user0" Bottom="80" Height="112" Id="Shape0" Left="0" LineColor="user1" Right="978" TabOrder="1" Top="-32" Type="Rectangle" Width="978"></Shape>
		<Static Align="Right" Border="Flat" Height="22" Id="Static9" Left="612" Style="sty_ipt_search" TabOrder="16" Top="30" VAlign="Middle" Width="190"></Static>
		<Static Align="Right" Height="20" Id="st_pspid" Left="6" Style="sty_lb_search" TabOrder="2" Text="Proj&#32;No&#32;" Top="29" VAlign="Middle" Width="88"></Static>
		<Edit BindDataset="ds_memo" Border="Flat" CheckLength="Byte" Column="PSPID" Height="20" Id="ed_pjt" ImeMode="english" Left="96" MaxLength="6" OnChanged="ed_pjt_OnChanged" Style="sty_ipt_search" TabOrder="13" Top="29" UpperOnly="TRUE" Width="158"></Edit>
		<Static Align="Right" Height="20" Id="st_pm" Left="440" Style="sty_lb_search" TabOrder="6" Text="외주작업구분&#32;" Top="30" VAlign="Middle" Width="80"></Static>
		<Combo BindDataset="ds_memo" Border="Flat" CodeColumn="CODE" Column="JOB_CODE" DataColumn="CODE_NAME" Height="20" Id="cb_workgubun" InnerDataset="ds_workgubun" Left="520" Style="sty_ipt_search" TabOrder="7" Top="29" Width="90"></Combo>
		<Static Align="Right" Height="20" Id="st_zzpmnum" Left="440" Style="sty_lb_search" TabOrder="3" Text="소속&#32;" Top="6" VAlign="Middle" Width="80"></Static>
		<Combo BindDataset="ds_memo" Border="Flat" CodeColumn="CODE" Column="BELONG" DataColumn="CODE_NAME" Height="20" Id="cb_belong" ImeMode="none" InnerDataset="ds_belong" Left="520" Style="sty_ipt_search" TabOrder="4" Top="5" Width="90"></Combo>
		<Static Align="Right" Height="20" Id="st_zzlifnr" Left="277" Style="sty_lb_search" TabOrder="5" Text="이름&#32;" Top="6" VAlign="Middle" Width="80"></Static>
		<Static Align="Center" BKColor="orange" Border="Flat" Color="black" Height="16" Id="Static3" Left="6" Style="sty_lb_search" TabOrder="9" Top="55" VAlign="Middle" Width="43"></Static>
		<Static Color="user7" Font="굴림,9" Height="16" Id="Static4" Left="54" TabOrder="10" Text="오렌지색&#32;필드는&#32;셀을&#32;더블클릭하면&#32;팝업&#32;창이&#32;뜹니다." Top="56" VAlign="Middle" Width="300"></Static>
		<Static Align="Right" Height="22" Id="st_date" Left="6" Style="sty_lb_search" TabOrder="11" Text="작성일&#32;" Top="5" VAlign="Middle" Width="88"></Static>
		<Calendar BindDataset="ds_memo" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="SUP_DTF" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_f_from" Left="96" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_search" SundayTextColor="user35" TabOrder="12" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="6" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="83"></Calendar>
		<Static Align="Center" Border="None" Color="user7" Font="굴림,9" Height="20" Id="Static2" Left="180" TabOrder="15" Text="~" Top="6" VAlign="Middle" Width="10"></Static>
		<Calendar BindDataset="ds_memo" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="SUP_DTT" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_f_to" Left="190" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_search" SundayTextColor="user35" TabOrder="14" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="6" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="83"></Calendar>
		<Radio BindDataset="ds_memo" Border="None" Column="READ_YN" Height="16" Id="rd_read" INDEX="0" Left="618" OnChanged="rd_read_OnChanged" Style="sty_ipt_search_chk" TabOrder="8" Top="32" Width="180">
			<Contents>
				<Layout code="1" default="true" height="20" left="0" text="전체보기" top="0" width="65"/>
				<Layout code="0" height="20" left="70" text="읽지않음만&#32;보기" top="0" width="110"/>
			</Contents>
		</Radio>
		<Grid AreaSelect="TRUE" AutoEnter="TRUE" AutoFitEndLine="Hide" AutoSelect="TRUE" BindDataset="ds_list" BkColor2="default" BoldHead="true" Border="Flat" Bottom="557" ColSelect="TRUE" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="472" Id="grd_list" InputPanel="FALSE" Left="4" LineColor="user20" LineType="ExHORZ" OnCellDBLClick="grd_list_OnCellDblClick" OnHeadClick="grd_list_OnHeadClick" Right="972" RowHeight="20" Style="sty_grid" TabOrder="17" TabStop="true" Top="85" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="968">
			<contents>
				<format id="Default">
					<columns>
						<col fix="left" width="30"/>
						<col fix="left" width="40"/>
						<col fix="left" width="100"/>
						<col fix="left" width="55"/>
						<col fix="left" width="71"/>
						<col fix="left" width="72"/>
						<col width="160"/>
						<col width="428"/>
						<col width="72"/>
						<col width="72"/>
					</columns>
					<head>
						<cell col="0" display="checkbox" edit="checkbox"/>
						<cell align="center" col="1" color="user21" display="text" font="굴림,9" text="구분"/>
						<cell align="center" col="2" color="user21" display="text" font="굴림,9" text="작업구분"/>
						<cell align="center" col="3" color="user21" display="text" font="굴림,9" text="소속"/>
						<cell align="center" col="4" color="user21" display="text" font="굴림,9" text="이름"/>
						<cell align="center" col="5" color="user21" display="text" font="굴림,9" text="호기번호"/>
						<cell align="center" col="6" color="user21" display="text" font="굴림,9" text="프로젝트명"/>
						<cell align="center" bkcolor="orange" col="7" color="user21" display="text" font="굴림,9" text="내용"/>
						<cell align="center" col="8" color="user21" display="text" font="굴림,9" text="작성일"/>
						<cell align="center" col="9" color="user21" display="text" font="굴림,9" text="읽은&#32;일자"/>
					</head>
					<body>
						<cell col="0" colid="CHK" display="checkbox" edit="checkbox"/>
						<cell align="center" col="1" colid="GUBUN" display="text"/>
						<cell col="2" colid="JOB_NAME" display="text"/>
						<cell align="center" col="3" colid="BELONG" display="text"/>
						<cell align="center" col="4" colid="USERNAME" display="text"/>
						<cell col="5" colid="POSID" display="text"/>
						<cell col="6" colid="ZSITE_NM" display="text"/>
						<cell col="7" colid="CONTENTS" display="text"/>
						<cell align="center" col="8" colid="CRDAT" display="text" Mask="####.##.##"/>
						<cell align="center" col="9" colid="READ_DATE" display="text" Mask="####.##.##"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Button Height="18" Id="btn_popProj" ImageID="btn_icon_search" Left="255" OnClick="btn_popProj_OnClick" TabOrder="18" Text="Button0" Top="30" Transparent="TRUE" Width="18"></Button>
		<Edit BindDataset="ds_memo" Border="Flat" CheckLength="Byte" Column="CRNAM" Height="20" Id="ed_crnam" ImeMode="english" Left="358" Style="sty_ipt_search" TabOrder="19" Top="6" UpperOnly="TRUE" Width="79"></Edit>
		<Static Align="Right" Height="20" Id="Static0" Left="277" Style="sty_lb_search" TabOrder="20" Text="호기&#32;" Top="30" VAlign="Middle" Width="80"></Static>
		<Edit BindDataset="ds_memo" Border="Flat" CheckLength="Byte" Column="POSID" Height="20" Id="ed_posid" ImeMode="english" Left="358" Style="sty_ipt_search" TabOrder="21" Top="30" UpperOnly="TRUE" Width="79"></Edit>
		<Static Align="Right" Height="20" Id="Static1" Left="613" Style="sty_lb_search" TabOrder="22" Text="구분&#32;" Top="6" VAlign="Middle" Width="80"></Static>
		<Combo BindDataset="ds_memo" Border="Flat" CodeColumn="CODE" Column="GUBUN" DataColumn="CODE_NAME" Height="20" Id="cb_gubun" ImeMode="none" InnerDataset="ds_gbn" Left="693" OnChanged="cb_gubun_OnChanged" Style="sty_ipt_search" TabOrder="23" Top="5" Width="110"></Combo>
	</Form>
	<Script><![CDATA[/*
 ******************************************************************************************
 * 기      능   : 기타외주 작업지시서(업체용)
 * 작  성  자   : start
 * 작성  일자   : 2019.07.24
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
#include "LIB::commons.js";	// 공통 스크립트
//=========================================================================================
// [ PART 1 ]
// Form에서 사용될 전역변수를 선언
// FORM에서 사용되는 전역변수는 대문자로 작성하며, F_XXX 의 형태를 갖도록 한다.
//=========================================================================================
var userGroup = "";
//=========================================================================================
// [ PART 2 ]
// Form Loading / Unloading 시 작업 정의
//=========================================================================================
function fn_OnLoadCompleted(obj) {
	//Form 로드 이벤트 맨 첫줄에 기술
	gfn_initForm(true);
	
	userGroup = gfn_getUserGroup();
	
	ed_pjt.SetFocus();
	
	// 업체 로그인 시
	if(userGroup != '40' && userGroup != '30' ){
		grd_list.SetColProp(1, "Width", 0);
	}
	
	//조회일자 세팅
    cal_f_from.Value = gfn_getAfterDate(gfn_getCurrDate(), -30);
    cal_f_to.Value	 = gfn_getAfterDate(gfn_getCurrDate(), 60);
    
	//외주작업구분 콤보 조회
    tit_clearActionInfo();
	tit_addSearchActionInfo("ps15:PS1505001A_S1");//외주작업구분 콤보 조회
	tit_addSearchActionInfo("ps15:PS1505001A_S3");//외주업체 콤보 조회 - 설치/구매 구분 콤보 세팅을 위해 추가 - 2019.09.20 강민석K
	tit_callService(
		  ""
		, ""
		, "ds_cond=ds_cond"
		, "ds_workgubun=ds_work ds_zzlifnr_cd=ds_zzlifnr"
		, ""
		, "fn_afterLifnr"
		, true,true);
}
/********************************************************************************
* 기      능   : fn_OnLoadCompleted Callback
********************************************************************************/
function fn_afterLifnr(errCode, errMsg) {
	// 소속 콤보 세팅
	gfn_insertEmptyRow(ds_belong, G_CODE_ALL);
	cb_belong.index = 0;
	
	// 구분 콤보 세팅
	gfn_insertEmptyRow(ds_gbn, G_CODE_ALL);
	
	// 업체 로그인 시
	if(userGroup != '40' && userGroup != '30' ) {
		//G_VEND_WGBN로는 설치/구매 구분 콤보 세팅이 안되어 수정 - 2019.09.20 강민석K
		//외주업체가 다른 업체의 메모도 볼 수 있도록 주석처리 - 2019.09.20 강민석K
		/*
		//cb_gubun.value = G_VEND_WGBN;
		cb_gubun.Value = ds_zzlifnr_cd.GetColumn(ds_zzlifnr_cd.FindRow("CODE", G_VEND_CODE), "GBN");
		cb_gubun_OnChanged(cb_gubun.value, cb_gubun.value, cb_gubun.Text, 0, cb_gubun.Index);
		cb_gubun.enable = false;
		*/
	} else {
		cb_gubun.Index = 0;
	}

	rd_read.Index = 0;			//읽지않음만 보기/전체보기 라디오버튼 세팅
	ds_list.UnFilter();
	if( rd_read.Index == 0 ) {
		ds_list.Filter("READ_DATE == null");
	}
	
	//외주작업구분 콤보
	gfn_insertEmptyRow(ds_workgubun, G_CODE_ALL);
	cb_workgubun.Index = 0;
	
	fn_query();
}

/********************************************************************************
* 기      능   : form UnloadCompleted
********************************************************************************/
function fn_OnUnloadCompleted(obj) {
	return gfn_isFormUnload(obj);
}
//=========================================================================================
// [ PART 3 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,form닫기)
//=========================================================================================
/********************************************************************************
* 기      능   : 조회 1
********************************************************************************/
function fn_query() {
	//조회기간 체크
	if(!gfn_checkFromToObj(cal_f_from, cal_f_to, true, "작성일")) {
		return;
	}
	
	tit_clearActionInfo();
	tit_addSearchActionInfo("ps15:PS1505003A_S1");
	tit_callService(
          ""
        , ""
        , "ds_memo=ds_memo"
        , "ds_list=ds_list"
        , ""
        , "fn_afterQuery"
        , true);

}
/********************************************************************************
* 기      능   : 닫기
********************************************************************************/
function fn_close() {
	close();
}
/********************************************************************************
* 기      능   : 엑셀
********************************************************************************/
function fn_excel() {
	// Excel Export
	gfn_saveToExcel(grd_list, true);
}
/********************************************************************************
* 기      능   : 읽음처리 120
********************************************************************************/
function fn_read() {
	var nChk = 0;
	var nIdx = -1;
	
	for(var i = 0; i < ds_list.rowcount; i++) {
	//	trace("청구 : "+ i +" : "+ ds_list.GetColumn(i,"CHK"));
		if( ds_list.GetColumn(i,"CHK") == "1" && ds_list.GetColumn(i, "READ_DATE") == null) {
			nChk++;
			nIdx = i;
		}
	}
//	trace ("ds_list : "+ ds_list.saveXML());
	//trace("체크 카운트 : "+ nChk +"AA"+ ds_list.GetColumn(ds_list.FindRow("CHK", '1'), "READ_DATE") +"AA");
	
	//선택여부 체크
	if(nIdx == -1){
		gfn_openMsgWin("읽음 처리를 할 항목을 선택하세요.", "E", "", "");
		return;
	}
	
	//이미 읽음처리된 자료인지 체크 - MERGE INTO로 변경되므로 제거 해도 됨
/*	if(nChk == 1 && ds_list.GetColumn(ds_list.FindRow("CHK", '1'), "READ_DATE") != null){
		gfn_openMsgWin("이미 읽음처리가 완료된 항목입니다.", "E", "", "");
			return;
	}
*/
	// 필터 적용 (체크되고, 읽음처리가 안된것)
	ds_list.Filter("CHK == '1' && READ_DATE == null");
	
	// 체크 리스트 
	ds_cond_check.CopyF(ds_list);
	ds_list.UnFilter();
	
	//trace ("ds_cond_check : "+ ds_cond_check.saveXML());

	tit_clearActionInfo();
	tit_addSearchActionInfo("ps15:PS1505003A_I1");	
	tit_callService(
          ""
        , ""
        , "ds_cond_check=ds_cond_check"
        , ""
        , ""
        , "fn_afterSave"
        , true);
}
/********************************************************************************
* 기      능   : 출력 40
********************************************************************************/
function fn_print() {
}

//=========================================================================================
// [ PART 4]
// Callback 함수 정의 : callback 함수명은 메인 함수의 fn_xxxx() 에서 xxxx 부분은 fn_afterXXXX()
// 형태가 되도록 작성
//=========================================================================================
/********************************************************************************
* 기      능   : 조회 Callback
********************************************************************************/
function fn_afterQuery(errCode, errMsg) {

	//Trace(ds_list.SaveXML());
	// 메시지 처리
	gfn_showSearchMsg(grd_list);
}
/********************************************************************************
* 기      능   : 저장 Callback
********************************************************************************/
function fn_afterSave(errCode, errMsg) {
	if(errCode != 0){
		gfn_showMsg("CE00001");
	}else{
		gfn_showMsg("CI00003");
		fn_query();
	}
}
//=========================================================================================
// [ PART 5 ]
// Detail Process Event 정의 ( User Define function )
// 사용자 정의 함수는 ufn_xxxx() 형태로 작성
//=========================================================================================
/********************************************************************************
* 기      능   : 사용자 정의 함수
********************************************************************************/
function ufn_userfunction() {

}
//=========================================================================================
// [ PART 6 ]
// component Event 정의 : 각 Component 별 이벤트
//=========================================================================================
/********************************************************************************
* 기      능   : 그리드 헤더 클릭시 정렬 처리
********************************************************************************/
function grd_list_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
{
	//trace("nCell : "+ nCell);
	if ( nCell == 0 ) {
		// 체크박스 전체 선택
		gfn_selectAllGrid(obj,nCell,nCell,true);
	} else {
		// 그리드 정렬 처리
		gfn_sortGrid(obj,nCell);
	}
}
/********************************************************************************
* 기      능   : 데이터셋 값 변경 시 - Flag 처리
********************************************************************************/
function ds_list_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{
	gfn_changeFlag( obj, strColumnID, nRow, "FLAG" );
}
/********************************************************************************
* 기      능   : 구분 변경 시 -> 외주작업구분 콤보 변경
********************************************************************************/
function cb_gubun_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	// 외주작업 콤보 필터
	if(userGroup == "40" || userGroup == "30")
	{
		//관리자인 경우
		ds_memo.SetColumn(0, "JOB_CODE", '');
	}else{
		//외주업체인 경우
		//ds_memo.SetColumn(0, "LIFNR", G_VEND_CODE);//외주업체가 다른 업체의 메모도 볼 수 있도록 주석처리 - 2019.09.20 강민석K
	}
	
	//외주작업구분 콤보 필터
	ds_workgubun.UnFilter();
	if(strCode != "") {
		ds_workgubun.Filter("GBN == " + quote(strCode) + " || GBN == null");//'-전체-' 항목도 표시하기 위해 GBN == null 사용
	}
	cb_workgubun.Index = 0;
}
/********************************************************************************
* 기      능   : 설치PM 콤보 조회 Callback
********************************************************************************/
function fn_afterZzactssChange(errCode, errMsg) {
	gfn_insertEmptyRow(ds_zzpmnum_cd, G_CODE_ALL);
	cb_zzpmnum.value = "";
}
/********************************************************************************
* 기      능   : 프로젝트 번호 검색 버튼 클릭
********************************************************************************/
function btn_popProj_OnClick(obj)
{
	var arg = "pjt=" + quote(ed_pjt.Text);
	gfn_openPopup("CS9601002A", true, arg);
}
/********************************************************************************
* 기      능   : 읽지않음만 보기 / 전체보기  라디오버튼 선택
********************************************************************************/
function rd_read_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	//trace("radio : "+ obj +","+ strCode +","+ strText +","+ nOldIndex +","+ nNewIndex);
	
	ds_list.UnFilter();
	if( strCode == "0" ) {
		ds_list.Filter("READ_DATE == null");
		//trace("filter : ");
	}
}

/********************************************************************************
* 기      능   : 그리드 셀 더블클릭 시 진행상태 팝업화면 표시
********************************************************************************/
function grd_list_OnCellDblClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
	if(nCell == 7){//메모
		//var contents = ds_list.GetColumn(nRow, "CONTENTS");
		var contents = ds_list.GetColumn(nRow, "CONTENTS_ORIG");
		
		//trace("memo DBlClick : "+ ds_list.getColumn(nRow, "PSPID") +", "+ ds_list.getColumn(nRow, "POSID") +", "+ ds_list.getColumn(nRow, "LIFNR") +", "+ ds_list.getColumn(nRow, "SEQ") );
		
		if(length(trim(contents)) > 0){
			var arg  = "CRNAM=" + quote(ds_list.GetColumn(nRow, "USERNAME"));//입력자명
				arg += " BELONG=" + quote(ds_list.GetColumn(nRow, "BELONG"));//소속
				arg += " CONTENTS=" + quote(contents);//내용
				arg += " ALM_INDC=" + quote(ds_list.GetColumn(nRow, "ALM_INDC"));//알림대상
				arg += " PSPID=" + quote(ds_list.getColumn(nRow, "PSPID"));//프로젝트 번호
				arg += " POSID=" + quote(ds_list.getColumn(nRow, "POSID"));//호기 번호
				arg += " LIFNR=" + quote(ds_list.GetColumn(nRow, "LIFNR"));//업체코드
				arg += " SEQ=" + quote(ds_list.GetColumn(nRow, "SEQ"));//SEQ
				
				
			gfn_openPopup("PS1505001C", true, arg);
		}
	}
}]]></Script>
</Window>