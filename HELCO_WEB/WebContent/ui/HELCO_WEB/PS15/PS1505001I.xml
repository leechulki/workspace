<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="768" Id="PS1505001I" Left="8" OnLoadCompleted="fn_OnLoadCompleted" PidAttrib="7" Title="작업완료" Top="8" Ver="1.0" Width="590" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_pdf">
				<Contents>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
					<colinfo id="BIGO" size="256" summ="default" type="STRING"/>
					<colinfo id="UDATE" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond1">
				<Contents>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID_1" size="256" summ="default" type="STRING"/>
					<colinfo id="JOB_CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="P_CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_memo">
				<Contents>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="CRNAM" size="256" summ="default" type="STRING"/>
					<colinfo id="CRID" size="256" summ="default" type="STRING"/>
					<colinfo id="BELONG" size="256" summ="default" type="STRING"/>
					<colinfo id="JOB_NAME" size="256" summ="default" type="STRING"/>
					<colinfo id="CONTENTS" size="256" summ="default" type="STRING"/>
					<colinfo id="CONTENTS_ORIG" size="256" summ="default" type="STRING"/>
					<colinfo id="CRDATE_TIME" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="ALM_INDC" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_notice">
				<Contents>
					<colinfo id="CONTENTS" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_memo_del">
				<Contents>
					<colinfo id="PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQNO_LIST" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_save">
				<Contents>
					<colinfo id="PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
					<colinfo id="JOB_CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="COM_DATE" size="256" summ="default" type="STRING"/>
					<colinfo id="COM_TIME" size="256" summ="default" type="STRING"/>
					<colinfo id="PROC_VER" size="256" summ="default" type="STRING"/>
					<colinfo id="DIPBXNUMB" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_file_list">
				<Contents>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="FNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="FPATH" size="256" summ="default" type="STRING"/>
					<colinfo id="COMMNT" size="256" summ="default" type="STRING"/>
					<colinfo id="META_CRDAT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_com_time">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_com_minute">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_combo">
				<Contents>
					<colinfo id="ST_TIME" size="256" summ="default" type="STRING"/>
					<colinfo id="ST_MINUTE" size="256" summ="default" type="STRING"/>
					<colinfo id="PL_TIME" size="256" summ="default" type="STRING"/>
					<colinfo id="PL_MINUTE" size="256" summ="default" type="STRING"/>
					<record>
						<PL_MINUTE></PL_MINUTE>
						<PL_TIME></PL_TIME>
						<ST_MINUTE></ST_MINUTE>
						<ST_TIME></ST_TIME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_file_del">
				<Contents>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="FNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="FPATH" size="256" summ="default" type="STRING"/>
					<colinfo id="COMMNT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_auth">
				<Contents>
					<colinfo id="AUTH" size="256" summ="default" type="STRING"/>
					<colinfo id="AUTH_NAME" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_msgsend">
				<Contents>
					<colinfo id="MESGSEND" size="255" type="STRING"/>
					<colinfo id="MESGACCP" size="256" type="STRING"/>
					<colinfo id="MESGTITL" size="256" type="STRING"/>
					<colinfo id="MESGDESC" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_check_sms_send"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_push_seq">
				<Contents>
					<colinfo id="SEQ" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_push">
				<Contents>
					<colinfo id="PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="MEMO_SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="TITLE" size="256" summ="default" type="STRING"/>
					<colinfo id="CONTENTS" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_head">
				<Contents>
					<colinfo id="MATNR_COM" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
		</Datasets>
		<Shape BKColor="user12" Bottom="331" Height="26" Id="Shape10" Left="295" LineColor="user13" Right="501" TabOrder="41" Top="305" Type="Rectangle" Width="206"></Shape>
		<Div Height="36" Id="div_btn" TabOrder="1" TabStop="FALSE" Text="Div0" Url="WB01::CommBtnForm.xml" Width="590">
			<Contents></Contents>
		</Div>
		<Button ButtonStyle="TRUE" Cursor="HAND" DragImageID="tab_form_05" Font="굴림,9" Height="20" Id="btn_sibang" ImageID="btn_user_06" Left="6" OnClick="btn_sibang_OnClick" Style="sty_btn" TabOrder="2" Text="영업사양&#32;조회" Top="45" Width="87"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" DragImageID="tab_form_05" Font="굴림,9" Height="20" Id="btn_plan" ImageID="btn_user_02" Left="97" OnClick="btn_plan_OnClick" Style="sty_btn" TabOrder="3" Text="도면" Top="45" Width="40"></Button>
		<Static Align="Right" Font="굴림,9" Height="16" Id="st_manager" Left="466" TabOrder="4" Text="담당자&#32;:&#32;업체담당자" Top="47" Width="115"></Static>
		<Static Align="Center" Font="굴림,12" Height="24" Id="Static1" Left="142" TabOrder="5" Text="작업완료&#32;후&#32;완료&#32;사진을&#32;등록하세요" Top="72" Width="314"></Static>
		<Static Font="굴림,9" Height="16" Id="st_process1" Left="14" TabOrder="6" Text="1번:&#32;업체지정&#32;→&#32;2번:&#32;작업요청&#32;→&#32;3번:&#32;투입일정&#32;→&#32;4번:&#32;작업시작&#32;→" Top="120" Width="376"></Static>
		<Static Color="darkorange" Font="굴림,9,Bold" Height="16" Id="st_process2" Left="391" TabOrder="7" Text="5번:&#32;작업완료" Top="120" Width="98"></Static>
		<Shape BKColor="user12" Bottom="203" Height="26" Id="Shape0" Left="85" LineColor="user13" Right="291" TabOrder="9" Top="177" Type="Rectangle" Width="206"></Shape>
		<Static Align="Center" BKColor="user1" Height="24" Id="Static6" Left="86" Style="sty_lb_form_basic" TabOrder="8" Text="설치업체" Top="178" VAlign="Middle" Width="71"></Static>
		<Edit BindDataset="ds_list" Border="Flat" Column="LIFNR_NM" Enable="FALSE" Height="20" Id="ed_lifnr_nm" ImeMode="native" Left="160" LeftMargin="4" MaxLength="20" Readonly="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="10" Top="180" Width="128"></Edit>
		<Shape BKColor="user12" Bottom="203" Height="26" Id="Shape1" Left="295" LineColor="user13" Right="501" TabOrder="12" Top="177" Type="Rectangle" Width="206"></Shape>
		<Static Align="Center" BKColor="user1" Height="24" Id="Static7" Left="296" Style="sty_lb_form_basic" TabOrder="11" Text="작업명" Top="178" VAlign="Middle" Width="71"></Static>
		<Edit BindDataset="ds_list" Border="Flat" Column="JOB_NAME" Enable="FALSE" Height="20" Id="ed_jobname" ImeMode="native" Left="370" LeftMargin="4" MaxLength="20" Readonly="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="13" Top="180" Width="128"></Edit>
		<Shape BKColor="user12" Bottom="235" Height="26" Id="Shape2" Left="85" LineColor="user13" Right="291" TabOrder="15" Top="209" Type="Rectangle" Width="206"></Shape>
		<Static Align="Center" BKColor="user1" Height="24" Id="Static8" Left="86" Style="sty_lb_form_basic" TabOrder="14" Text="작업팀장" Top="210" VAlign="Middle" Width="71"></Static>
		<Edit BindDataset="ds_list" Border="Flat" Column="NAMET" Enable="FALSE" Height="20" Id="ed_namet" ImeMode="native" Left="160" LeftMargin="4" MaxLength="20" Readonly="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="16" Top="212" Width="128"></Edit>
		<Shape BKColor="user12" Bottom="235" Height="26" Id="Shape3" Left="295" LineColor="user13" Right="501" TabOrder="18" Top="209" Type="Rectangle" Width="206"></Shape>
		<Static Align="Center" BKColor="user1" Height="24" Id="Static9" Left="296" Style="sty_lb_form_basic" TabOrder="17" Text="작업업체명" Top="210" VAlign="Middle" Width="71"></Static>
		<Edit BindDataset="ds_list" Border="Flat" Column="LIFNR_OUT_NAME" Enable="FALSE" Height="20" Id="ed_lifnr_out_name" ImeMode="native" Left="370" LeftMargin="4" MaxLength="20" Readonly="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="19" Top="212" Width="128"></Edit>
		<Shape BKColor="user12" Bottom="267" Height="26" Id="Shape4" Left="85" LineColor="user13" Right="291" TabOrder="21" Top="241" Type="Rectangle" Width="206"></Shape>
		<Static Align="Center" BKColor="user1" Height="24" Id="Static10" Left="86" Style="sty_lb_form_basic" TabOrder="20" Text="휴대폰" Top="242" VAlign="Middle" Width="71"></Static>
		<Edit BindDataset="ds_list" Border="Flat" Column="NAMET_HP" Enable="FALSE" Height="20" Id="ed_team_hp" ImeMode="native" Left="160" LeftMargin="4" MaxLength="20" Readonly="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="22" Top="244" Width="128"></Edit>
		<Shape BKColor="user12" Bottom="299" Height="26" Id="Shape6" Left="85" LineColor="user13" Right="291" TabOrder="24" Top="273" Type="Rectangle" Width="206"></Shape>
		<Static Align="Center" BKColor="user1" Height="24" Id="Static12" Left="86" Style="sty_lb_form_basic" TabOrder="23" Text="설치PM" Top="274" VAlign="Middle" Width="71"></Static>
		<Edit BindDataset="ds_list" Border="Flat" Column="PM_NAME" Enable="FALSE" Height="20" Id="ed_pm_name" ImeMode="native" Left="160" LeftMargin="4" MaxLength="20" Readonly="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="25" Top="276" Width="128"></Edit>
		<Shape BKColor="user12" Bottom="299" Height="26" Id="Shape7" Left="295" LineColor="user13" Right="501" TabOrder="27" Top="273" Type="Rectangle" Width="206"></Shape>
		<Static Align="Center" BKColor="user1" Height="24" Id="Static13" Left="296" Style="sty_lb_form_basic" TabOrder="26" Text="작업요청자" Top="274" VAlign="Middle" Width="71"></Static>
		<Edit BindDataset="ds_list" Border="Flat" Column="REQ_NAME" Enable="FALSE" Height="20" Id="ed_requester" ImeMode="native" Left="370" LeftMargin="4" MaxLength="20" Readonly="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="28" Top="276" Width="128"></Edit>
		<Shape BKColor="user12" Bottom="331" Height="26" Id="Shape8" Left="85" LineColor="user13" Right="291" TabOrder="30" Top="305" Type="Rectangle" Width="206"></Shape>
		<Static Align="Center" BKColor="user1" Height="24" Id="Static14" Left="86" Style="sty_lb_form_basic" TabOrder="29" Text="휴대폰" Top="306" VAlign="Middle" Width="71"></Static>
		<Edit BindDataset="ds_list" Border="Flat" Column="PM_HP" Enable="FALSE" Height="20" Id="ed_pm_hp" ImeMode="native" Left="160" LeftMargin="4" MaxLength="20" Readonly="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="31" Top="308" Width="128"></Edit>
		<Shape BKColor="user12" Bottom="363" Height="26" Id="Shape9" Left="85" LineColor="user13" Right="291" TabOrder="33" Top="337" Type="Rectangle" Width="206"></Shape>
		<Static Align="Center" BKColor="user1" Height="24" Id="Static15" Left="86" Style="sty_lb_form_basic" TabOrder="32" Text="작업요청일" Top="338" VAlign="Middle" Width="71"></Static>
		<Button ButtonStyle="TRUE" Cursor="HAND" DragImageID="tab_form_05" Font="굴림,9" Height="20" Id="btn_add" ImageID="btn_user_04" Left="477" OnClick="btn_add_OnClick" Style="sty_btn" TabOrder="34" Text="메모추가" Top="585" Width="65"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" DragImageID="tab_form_05" Font="굴림,9" Height="20" Id="btn_delete" ImageID="btn_user_02" Left="544" OnClick="btn_delete_OnClick" Style="sty_btn" TabOrder="35" Text="삭제" Top="585" Width="40"></Button>
		<Grid AutoEnter="TRUE" AutoFitEndLine="Hide" BindDataset="ds_memo" BkColor2="default" BoldHead="true" Border="Flat" Bottom="710" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="99" Id="grd_memo" InputPanel="FALSE" Left="6" LineColor="user20" LineType="ExHORZ" OnCellDBLClick="grd_memo_OnCellDblClick" Right="584" RowHeight="20" Style="sty_grid" TabOrder="36" TabStop="true" Top="611" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="578">
			<contents>
				<format id="Default">
					<columns>
						<col width="24"/>
						<col width="65"/>
						<col width="46"/>
						<col width="70"/>
						<col width="230"/>
						<col width="123"/>
					</columns>
					<head>
						<cell col="0" color="user21" display="text" font="굴림,9"/>
						<cell col="1" color="user21" display="text" font="굴림,9" text="입력자"/>
						<cell col="2" color="user21" display="text" font="굴림,9" text="소속"/>
						<cell col="3" color="user21" display="text" font="굴림,9" text="작업구분"/>
						<cell col="4" color="user21" display="text" font="굴림,9" text="메모"/>
						<cell col="5" color="user21" display="text" font="굴림,9" text="입력일시"/>
					</head>
					<body>
						<cell align="center" col="0" colid="CHK" display="checkbox" edit="checkbox"/>
						<cell align="center" col="1" colid="CRNAM" display="text"/>
						<cell align="center" col="2" colid="BELONG" display="text"/>
						<cell align="center" col="3" colid="JOB_NAME" display="text"/>
						<cell col="4" colid="CONTENTS" display="text"/>
						<cell align="center" col="5" colid="CRDATE_TIME" display="text" Mask="####.##.##&#32;##:##:##"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Static Align="Center" BindDataset="ds_list" Column="POSID" Height="24" Id="st_posid" Left="85" Style="sty_lb_form_basic" TabOrder="37" Text="162800L05" Top="148" VAlign="Middle" Width="75"></Static>
		<Static Align="Center" BindDataset="ds_list" Column="DONG" Height="24" Id="st_dong" Left="164" Style="sty_lb_form_basic" TabOrder="38" Text="1401동" Top="148" VAlign="Middle" Width="45"></Static>
		<Static Height="24" Id="st_site_nm" Left="212" Style="sty_lb_form_basic" TabOrder="39" Text="&#32;남양주&#32;녹촌&#32;라온&#32;프리이빗&#32;4-1BL" Top="148" VAlign="Middle" Width="287"></Static>
		<Static Align="Center" BKColor="user1" Height="24" Id="Static2" Left="296" Style="sty_lb_form_basic" TabOrder="40" Text="작업요청자" Top="306" VAlign="Middle" Width="71"></Static>
		<Edit Border="Flat" Enable="FALSE" Height="20" Id="ed_req_reg_time" ImeMode="native" Left="370" LeftMargin="4" MaxLength="20" Readonly="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="42" Top="308" Width="128"></Edit>
		<Static Align="Center" BKColor="user1" Height="24" Id="Static16" Left="296" Style="sty_lb_form_basic" TabOrder="43" Text="요청등록시간" Top="306" VAlign="Middle" Width="71"></Static>
		<Shape BKColor="user12" Bottom="363" Height="26" Id="Shape12" Left="295" LineColor="user13" Right="501" TabOrder="47" Top="337" Type="Rectangle" Width="206"></Shape>
		<Static Align="Center" BKColor="user1" Height="24" Id="Static18" Left="296" Style="sty_lb_form_basic" TabOrder="46" Text="작업시작" Top="338" VAlign="Middle" Width="71"></Static>
		<Shape BKColor="user12" Bottom="405" Height="26" Id="Shape13" Left="134" LineColor="user13" Right="452" TabOrder="48" Top="379" Type="Rectangle" Width="318"></Shape>
		<Static Align="Center" Font="굴림,11" Height="23" Id="Static5" Left="54" TabOrder="49" Text="작업완료&#32;사진이&#32;없으면&#32;비용&#32;지급이&#32;지체될&#32;수&#32;있습니다" Top="97" Width="474"></Static>
		<Static Align="Center" Font="굴림,10" Height="17" Id="Static26" Left="8" TabOrder="55" Text="작업완료&#32;사진을&#32;등록하세요" Top="450" Width="576"></Static>
		<Button ButtonStyle="TRUE" Cursor="HAND" DragImageID="tab_form_05" Font="굴림,9" Height="22" Id="btn_download" ImageID="btn_sub_06" Left="90" OnClick="btn_download_OnClick" Style="sty_btn" TabOrder="56" Text="&#32;&#32;파일&#32;다운로드" Top="473" Width="97"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" DragImageID="tab_form_05" Font="굴림,9" Height="22" Id="btn_upload" ImageID="btn_sub_04" Left="344" OnClick="btn_upload_OnClick" Style="sty_btn" TabOrder="57" Text="&#32;&#32;파일추가" Top="472" Width="73"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" DragImageID="tab_form_05" Font="굴림,9" Height="22" Id="btn_del_file" ImageID="btn_sub_04" Left="417" OnClick="btn_del_file_OnClick" Style="sty_btn" TabOrder="58" Text="&#32;&#32;파일삭제" Top="473" Width="73"></Button>
		<Grid AutoEnter="TRUE" AutoFitEndLine="Hide" BindDataset="ds_file_list" BkColor2="default" BoldHead="true" Border="Flat" Bottom="578" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="81" Id="grd_file" InputPanel="FALSE" Left="90" LineColor="user20" LineType="ExHORZ" OnCellDBLClick="grd_file_OnCellDblClick" Right="488" RowHeight="20" Style="sty_grid" TabOrder="59" TabStop="true" Top="497" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="398">
			<contents>
				<format id="Default">
					<columns>
						<col width="24"/>
						<col width="155"/>
						<col width="217"/>
					</columns>
					<head>
						<cell col="0" color="user21" display="text" font="굴림,9"/>
						<cell col="1" color="user21" display="text" font="굴림,9" text="첨부파일&#32;리스트"/>
						<cell col="2" color="user21" display="text" font="굴림,9" text="설명"/>
					</head>
					<body>
						<cell align="center" col="0" colid="CHK" display="checkbox" edit="checkbox"/>
						<cell align="left" col="1" colid="FNAME" display="text"/>
						<cell align="left" col="2" colid="COMMNT" display="text"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Edit Border="Flat" Enable="FALSE" Height="20" Id="ed_req_date" ImeMode="native" Left="160" LeftMargin="4" MaxLength="20" Readonly="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="60" Top="340" Width="128"></Edit>
		<Edit Border="Flat" Enable="FALSE" Height="20" Id="ed_start_date" ImeMode="native" Left="370" LeftMargin="4" MaxLength="20" Readonly="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="60" Top="340" Width="128"></Edit>
		<FileDialog Bottom="24" Filter="All(*.*)|*.*|jpg&#32;File(*.jpg)|*.jpg|jpeg&#32;File(*.jpeg)|*.jpeg|bmp&#32;File(*.bmp)|*.jpeg|gif&#32;File(*.gif)|*.gif|png&#32;File(*.png)|*.png|pdf&#32;File(*.pdf)|*.pdf|" Height="24" Id="saveDialog" Left="648" Right="672" TabOrder="76" Type="Save" Width="24"></FileDialog>
		<CyHttpFile Height="24" Id="httpFile" Left="648" Top="32" Width="24"></CyHttpFile>
		<File Bottom="56" Height="24" Id="f_tmp" Left="616" Right="640" TabOrder="76" Top="32" Width="24"></File>
		<FileDialog Bottom="24" Filter="All(*.*)|*.*|jpg&#32;File(*.jpg)|*.jpg|jpeg&#32;File(*.jpeg)|*.jpeg|bmp&#32;File(*.bmp)|*.jpeg|gif&#32;File(*.gif)|*.gif|png&#32;File(*.png)|*.png|pdf&#32;File(*.pdf)|*.pdf|" Height="24" Id="fileDialog" Left="616" MultiSelect="TRUE" Right="640" TabOrder="76" Width="24"></FileDialog>
		<Static Align="Center" BKColor="yellow" Height="24" Id="Static17" Left="135" Style="sty_lb_form_basic" TabOrder="44" Text="작업종료일시" Top="380" VAlign="Middle" Width="74"></Static>
		<Calendar BindDataset="ds_list" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_com_date" Left="212" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" OnChanged="cal_com_date_OnChanged" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="45" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="382" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="87"></Calendar>
		<Combo BindDataset="ds_combo" CodeColumn="CODE" Column="ST_TIME" DataColumn="CODE_NAME" Height="20" Id="cb_com_time" InnerDataset="ds_com_time" Left="300" TabOrder="50" Top="382" Width="59"></Combo>
		<Static Align="Center" BKColor="white" Height="15" Id="Static11" Left="357" Style="sty_lb_form_basic" TabOrder="51" Text="시" Top="385" VAlign="Middle" Width="15"></Static>
		<Combo BindDataset="ds_combo" CodeColumn="CODE" Column="ST_MINUTE" DataColumn="CODE_NAME" Height="20" Id="cb_com_minute" InnerDataset="ds_com_minute" Left="376" TabOrder="53" Top="382" Width="59"></Combo>
		<Static Align="Center" BKColor="white" Height="15" Id="Static20" Left="434" Style="sty_lb_form_basic" TabOrder="52" Text="분" Top="385" VAlign="Middle" Width="15"></Static>
		<Static Font="굴림,9" Height="16" Id="st_process3" Left="477" TabOrder="62" Text="→&#32;6번:&#32;비용처리" Top="120" Width="94"></Static>
		<Shape BKColor="user12" Bottom="267" Height="26" Id="Shape5" Left="295" LineColor="user13" Right="501" TabOrder="64" Top="241" Type="Rectangle" Width="206"></Shape>
		<Static Align="Center" BKColor="user1" Height="24" Id="Static0" Left="296" Style="sty_lb_form_basic" TabOrder="63" Text="업체연락처" Top="242" VAlign="Middle" Width="71"></Static>
		<Edit BindDataset="ds_list" Border="Flat" Column="LIFNR_OUT_TEL" Enable="FALSE" Height="20" Id="Edit0" ImeMode="native" Left="370" LeftMargin="4" MaxLength="20" Readonly="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="65" Top="244" Width="128"></Edit>
		<TextArea Enable="FALSE" Height="38" Id="ta_notice" Left="6" Readonly="TRUE" TabOrder="66" Text="※공지사항&#32;:&#32;공지사항은&#32;디비에&#32;맵핑된&#32;정보를&#32;불러와서&#32;표기한다" Top="716" Width="578"></TextArea>
		<AxMSIE Bottom="18" Height="18" Id="AxMSIE_push" Left="680" Right="704" TitleChange="AxMSIE_push_TitleChange" Width="24"></AxMSIE>
		<Shape BKColor="user12" Bottom="435" Height="26" Id="Shape11" Left="134" LineColor="user13" Right="452" TabOrder="69" Top="409" Type="Rectangle" Width="318"></Shape>
		<Static Align="Center" BKColor="yellow" Height="24" Id="Static3" Left="135" Style="sty_lb_form_basic" TabOrder="68" Text="비상통화장치&#32;시리얼넘버" Top="410" VAlign="Middle" Width="153"></Static>
		<Static Align="Center" Color="red" Font="Tahoma,16,Bold" Height="15" Id="Static4" Left="270" TabOrder="70" Text="＊" Top="403" Width="15"></Static>
		<Edit Height="20" Id="ed_call_serial_no" Left="291" TabOrder="71" Top="412" Width="158"></Edit>
		<Static Align="Center" Color="red" Font="Tahoma,16,Bold" Height="15" Id="Static25" Left="197" TabOrder="54" Text="＊" Top="372" Width="15"></Static>
	</Form>
	<Script><![CDATA[/*
 ******************************************************************************************
 * 기      능   : 작업완료 팝업
 * 작  성  자   : 강민석K
 * 작성  일자   : 2019.07.24
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
#include "LIB::commons.js";	// 공통 스크립트 
//=========================================================================================
// [ PART 1 ]
// Form에서 사용될 전역변수를 선언
// FORM에서 사용되는 전역변수는 대문자로 작성하며, F_XXX 의 형태를 갖도록 한다. 
//=========================================================================================
var userGroup = "";
var userAuth = "";//사용자 권한 - 안전, 서비스 구분을 위한 변수 추가 - 2019.07.26 강민석K
var F_START_DATE_EVENT_ENABLE = true;//저장된 일자가 오늘 이전 일자인 경우 cal_start_date_OnChanged가 실행되지 않도록 변수 추가 - 2019.07.19 강민석K
var F_MODIFY_MODE = false;//이미 저장된 상태의 자료인지 여부(true : 수정저장 모드, false : 신규저장 모드)
var F_SIZE = 1024 * 10096;	// 4096K
var F_MSG = "";
var F_PIC_UPLOAD_YN = "Y";//사진업로드 필수여부 관련 추가 - 2019.10.02 강민석K
var F_SAVE_INDC = false;
//=========================================================================================
// [ PART 2 ]
// Form Loading / Unloading 시 작업 정의
//=========================================================================================
function fn_OnLoadCompleted(obj) {
	//Form 로드 이벤트 맨 첫줄에 기술 
	gfn_initForm();
	
	userGroup = gfn_getUserGroup();
	
	ufn_initTimeCombo();
	
	//사진업로드 필수여부 관련 추가 - 2019.10.02 강민석K
	F_PIC_UPLOAD_YN = ds_list.GetColumn(ds_list.row, "PIC_UPLOAD_YN");
	
	//업체담당자(팀장)
	st_manager.Text = "담당자 : " + ds_list.GetColumn(ds_list.row, "J_1KFREPRE");
	
	//프로세스 안내문구 표시 : 구매외주인 경우 1번 프로세스를 '작업인지'로 표시
	if(ds_cond.GetColumn(0, "I_RA") == 'B'){
		st_process1.Text = "1번: 작업인지 → 2번: 작업요청 → 3번: 투입일정 → 4번: 작업시작 →";
		
		//구매외주는 비용처리가 프로세스가 없어져 화면 표시 수정 - 2019.08.01 강민석K
		st_process1.Left = 64;
		st_process2.Left = 441;
		st_process3.Visible = false;
		
		//구매외주는 시방조회 기능 필요없음. - 2019.08.12 강민석K (2019.08.05 김정민C 확인)
		btn_sibang.Visible = false;
		btn_plan.Left = 6;
	}
	
	//비상통화장치 시리얼넘버 관련 추가 - 2019.10.01 강민석K (이현용K 요구사항)
	if(ds_list.GetColumn(ds_list.row, "GBN") == "A" && ds_list.GetColumn(ds_list.row, "JOB_CODE") == "C"){
		ed_call_serial_no.Text = ds_list.GetColumn(ds_list.row, "DIPBXNUMB");
	}else{
		//설치 중 외주작업이 인터폰이 아니거나 구매인 경우 비상통화장치 시리얼넘버 관련 항목을 숨김 - 2019.10.02 강민석K
		Shape11.Visible = false;
		Static3.Visible = false;
		Static4.Visible = false;
		ed_call_serial_no.Visible = false;
	}
	
	//요청등록시간
	var reqRegTime = ds_list.GetColumn(ds_list.row, "REQ_REG_TIME");
	if(reqRegTime != null && reqRegTime != ""){
		ed_req_reg_time.Text = substr(reqRegTime, 0, 4) + "." + substr(reqRegTime, 4, 2)  + "." + substr(reqRegTime, 6, 2)
					   + " " + substr(reqRegTime, 8, 2) + ":" + substr(reqRegTime, 10, 2) + ":" + substr(reqRegTime, 12, 2);
	}
	
	//작업요청일
	var reqDate = ds_list.GetColumn(ds_list.row, "REQ_DATE");
	if(reqDate != ""){
		ed_req_date.Text = substr(reqDate, 0, 4) + "-" + substr(reqDate, 4, 2) + "-" + substr(reqDate, 6, 2);
	}
	
	//작업시작일
	var startDate = ds_list.GetColumn(ds_list.row, "START_DATE");
	ed_start_date.Text = substr(startDate, 0, 4) + "-" + substr(startDate, 4, 2) + "-" + substr(startDate, 6, 2);
	
	//작업종료일
	var comDate = ds_list.GetColumn(ds_list.row, "COM_DATE");
	if(comDate != null && comDate != ""){
		//이미 저장된 경우 저장된 일시 표시
		F_START_DATE_EVENT_ENABLE = false;
		
		cal_com_date.Value = comDate;//작업종료일
		cb_com_time.Value = substr(ds_list.GetColumn(ds_list.row, "COM_TIME"), 0, 2);
		cb_com_minute.Value = substr(ds_list.GetColumn(ds_list.row, "COM_TIME"), 2, 2);
		
		F_MODIFY_MODE = true;
	}else{
		//신규인 경우 현재일시 표시
		cal_com_date.Value = gfn_getCurrDate();//작업종료일
		
		F_MODIFY_MODE = false;
	}
	
	//비용청구가 된 경우 수정 불가
	var chargeDate = ds_list.GetColumn(ds_list.row, "CHARGE_DATE");
	if(chargeDate != null && chargeDate != "" && chargeDate != "00000000"){
		//작업종료
		cal_com_date.Enable = false;//일자
		cb_com_time.Enable = false;//시간
		cb_com_minute.Enable = false;//분
		
		div_btn.btn_save.Enable = false;//저장버튼
		
		F_START_DATE_EVENT_ENABLE = false;
		
		if(comDate == null || comDate == ""){
			cal_com_date.Value = "";
		}
	}
	
	//결재가 진행중인 상태(미청구 또는 반려 상태가 아닌 경우)면 사진 추가/삭제 불가
	var state_code = ds_list.GetColumn(ds_list.row, "STATE_CODE");
	if(state_code != "" && state_code != "Z"){
		btn_upload.Enable = false;//파일추가버튼
		btn_del_file.Enable = false;//파일삭제버튼
	}
	
	// 비상콜결선, UTP변환기, 인터폰(디지털통화장치), CCTV내부배선의 경우는 TEXT 변경
	if(ds_list.getColumn(ds_list.row, "JOB_CODE") == 'V')	// 비상콜결선
	{
		Static26.Text = "비상콜 결선은 수시검사시 확인사항이므로 사진 생략후 진행바랍니다.";
	}
	else if(ds_list.getColumn(ds_list.row, "JOB_CODE") == 'W')	// UTP변환기
	{
		Static26.Text = "UTP변환기는 5번 작업완료 사진만 등록하시기 바랍니다.";
	}
	else if(ds_list.getColumn(ds_list.row, "JOB_CODE") == 'C')	// 인터폰
	{
		Static26.Text = "인터폰은 5번 작업완료 사진만 등록하시기 바랍니다.";
	}
	else if(ds_list.getColumn(ds_list.row, "JOB_CODE") == 'D')	// CCTV내부배선
	{
		Static26.Text = "CCTV내부배선은 5번 작업완료 사진만 등록하시기 바랍니다.";
	}
	else
	{
		// 나머지 작업은 그대로 둠.
	}
	
	//저장 시 필요한 고정정보 세팅
	ds_save.DeleteAll();
	ds_save.AddRow();
	
	ds_save.SetColumn(0, "PSPID", ds_list.GetColumn(ds_list.row, "PSPID"));			//프로젝트번호
	ds_save.SetColumn(0, "POSID", ds_list.GetColumn(ds_list.row, "POSID"));			//호기번호
	ds_save.SetColumn(0, "JOB_CODE", ds_list.GetColumn(ds_list.row, "JOB_CODE"));	//외주작업코드
	ds_save.SetColumn(0, "LIFNR", ds_list.GetColumn(ds_list.row, "LIFNR_OUT"));		//외주업체코드
	ds_save.SetColumn(0, "GBN", ds_list.GetColumn(ds_list.row, "GBN"));				//설치/구매 구분(A:설치, B:구매)
	ds_save.SetColumn(0, "PROC_VER", ds_list.GetColumn(ds_list.row, "PROC_VER"));	//프로세스 버전
	
	fn_query();
}
/********************************************************************************
* 기      능   : 공통코드가 조회된 후의 Callback 함수 
********************************************************************************/
function fn_completeInit(sCode, sDsObj, sCodeType) {

}
/********************************************************************************
* 기      능   : form UnloadCompleted 
********************************************************************************/
function fn_OnUnloadCompleted(obj) {
	return gfn_isFormUnload(obj);
}
//=========================================================================================
// [ PART 3 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,form닫기)
//=========================================================================================
/********************************************************************************
* 기      능   : 조회
********************************************************************************/
function fn_query() {
	ds_cond1.DeleteAll();
	ds_cond1.AddRow();
	
	ds_cond1.SetColumn(0, "POSID", ds_list.GetColumn(ds_list.row, "PSPID"));
	ds_cond1.SetColumn(0, "POSID_1", ds_list.GetColumn(ds_list.row, "POSID"));
	ds_cond1.SetColumn(0, "JOB_CODE", ds_list.GetColumn(ds_list.row, "JOB_CODE"));
	ds_cond1.SetColumn(0, "LIFNR", ds_list.GetColumn(ds_list.row, "LIFNR_OUT"));
	ds_cond1.SetColumn(0, "P_CODE", "5");
    //설치외주인 경우 메모관리 화면에서 설치, 업체는 디폴트로 체크하도록 하기 위해 설치/구매 구분값 추가 - 2019.09.19 강민석K (정태성K 요구사항)
    ds_cond1.SetColumn(0, "GBN", ds_list.GetColumn(ds_list.row, "GBN"));
	
	tit_clearActionInfo();
	tit_addSearchActionInfo("ps01:PS0101001A_S8");//도면정보 조회
	tit_addSearchActionInfo("ps15:PS1505001P_S1");//공지사항 조회
	tit_addSearchActionInfo("ps15:PS1505001P_S2");//메모 조회
	tit_addSearchActionInfo("ps15:PS1505001P_S5");//파일목록 조회
	tit_addSearchActionInfo("ps15:PS1505001A_S6");//사용자 권한 조회
	tit_addSearchActionInfo("ps15:PS1505001I_S1");//ZPSTW1401 - MATNR_COM
	tit_callService(
          ""
        , ""
        , "ds_cond=ds_cond1"
        , "ds_pdf=ds_list10 ds_notice=ds_list ds_memo=ds_memo ds_file_list=ds_file_list ds_auth=ds_auth ds_head=ds_head"
        , ""
        , "fn_afterQuery"
        , true);
}
/********************************************************************************
* 기      능   : 저장 
********************************************************************************/
function fn_save() {
	//작업종료일 체크 - 작업시작일보다 이전일 수 없다
	var startDateTime = ds_list.GetColumn(ds_list.row, "START_DATE") + ds_list.GetColumn(ds_list.row, "START_TIME");
	var comDateTime = cal_com_date.Value + cb_com_time.Value + cb_com_minute.Value + "00";
	
	if(toNumber(comDateTime) <= toNumber(startDateTime)){
		gfn_openMsgWin("작업종료일시를 작업시작일시 보다 이후 일시로 입력하세요.", "E", "", "");
		cal_com_date.SetFocus();
		return;
	}
	
	//저장할 외주작업이 인터폰인 경우 비상통화장치 시리얼넘버 입력 체크 - 필수저장 항목 추가 2019.10.01 강민석K (이현용K 요구사항)
	var gbn = ds_list.GetColumn(ds_list.row, "GBN");
	var job_code = ds_list.GetColumn(ds_list.row, "JOB_CODE");
	if(gbn == "A" && job_code == "C" && length(ed_call_serial_no.Text) < 9){
		gfn_openMsgWin("비상통화장치 시리얼넘버를 입력하세요.", "E", "", "");
		ed_call_serial_no.SetFocus();
		return;
	}
	
	//사진 업로드 여부 체크
	//사진업로드 필수여부 관련 추가 - 2019.10.02 강민석K
	//if(ds_file_list.rowcount == 0){
	if(F_PIC_UPLOAD_YN == "Y" && ds_file_list.rowcount == 0){
		gfn_openMsgWin("작업완료 사진을 등록하세요.", "E", "", "");
		return;
	}
	
	var msg = "작업명 : " + ed_jobname.Text
	        + "\n호기 : " + substr(st_posid.Text, 6, 3)
	        + "\n작업종료일 : " + substr(comDateTime, 0, 4) + "-" + substr(comDateTime, 4, 2) + "-" + substr(comDateTime, 6, 2)
	        + "\n저장하시겠습니까?";
	
	if(!gfn_openMsgWin(msg, "I", "C", "")){
		return;
	}
	
	ds_save.SetColumn(0, "COM_DATE", cal_com_date.Value);//작업종료일
	ds_save.SetColumn(0, "COM_TIME", cb_com_time.Value + cb_com_minute.Value + "00");//작업종료시간
	
	tit_clearActionInfo();
	tit_addMultiActionInfo("ps15:PS1505001P_I6");
	
	//비상통화장치 시리얼넘버 저장 추가 - 2019.10.01 강민석K (이현용K 요구사항)
	if(gbn == "A" && job_code == "C"){
		ds_save.SetColumn(0, "DIPBXNUMB", ed_call_serial_no.Text);
		tit_addMultiActionInfo("ps15:PS1505001P_U4");
	}else{
		ds_save.SetColumn(0, "DIPBXNUMB", "");
	}
	
	tit_callService(
		  ""
		, ""
		, "ds_save=ds_save"
		, ""
		, ""
		, "fn_afterSave"
		, ""
		, ""
		, true);
}
/********************************************************************************
* 기      능   : 닫기  
********************************************************************************/
function fn_close() {
	//parent.F_AUTO_QUERY = true;
	//parent.fn_query();
	close();
}
//=========================================================================================
// [ PART 4]
// Callback 함수 정의 : callback 함수명은 메인 함수의 fn_xxxx() 에서 xxxx 부분은 fn_afterXXXX()
// 형태가 되도록 작성 
//=========================================================================================
/********************************************************************************
* 기      능   : 조회 Callback  
********************************************************************************/
function fn_afterQuery(errCode, errMsg) {
	st_site_nm.Text = " " + ds_list.GetColumn(0, "ZSITE_NM");//Static 컨트롤에 왼쪽여백이 없어서 프로젝트명을 DataSet을 바인딩하지 않고 직접 표시함. - 2019.07.18 강민석K
	ta_notice.Text = "※공지사항 : " + ds_notice.GetColumn(0, "CONTENTS");
	
	//서비스(ZPS12), 안전(ZPS36) 팀은 조회만 가능
	var bOut_Lifnr = false;//외주업체 여부 추가 - 설치협력사면서 외주업체인 경우가 있어서 변수 추가 - 2019.09.27 강민석K
    for(var i = 0; i < ds_auth.rowcount; i++){
		userAuth = ds_auth.GetColumn(i, "AUTH");
		
		//설치협력사(ZPS05), 영업(ZPS08) 팀도 조회만 가능하도록 추가 - 2019.09.27 강민석K
		//if(userAuth == "ZPS12" || userAuth == "ZPS36"){
		if(userAuth == "ZPS12" || userAuth == "ZPS36" || userAuth == "ZPS05" || userAuth == "ZPS08"){
			div_btn.btn_save.Enable = false;//저장버튼
			cal_com_date.Enable = false;//작업종료 일
			cb_com_time.Enable = false;//작업종료 시간
			cb_com_minute.Enable = false;//작업종료 분
			btn_upload.Enable = false;//파일추가버튼
			btn_del_file.Enable = false;//파일삭제버튼
		}
		
		if(userAuth == "ZPS13"){
			bOut_Lifnr = true;
		}
    }
    
    //설치협력사면서 외주업체인 경우가 있어서 추가 - 2019.09.27 강민석K
	var chargeDate = ds_list.GetColumn(ds_list.row, "CHARGE_DATE");
	if(bOut_Lifnr == true){
		if(chargeDate == null || chargeDate == ""){
			div_btn.btn_save.Enable = true;//저장버튼
			cal_com_date.Enable = true;//작업종료 일
			cb_com_time.Enable = true;//작업종료 시간
			cb_com_minute.Enable = true;//작업종료 분
			btn_upload.Enable = true;//파일추가버튼
			btn_del_file.Enable = true;//파일삭제버튼
			
			//결재가 진행중인 상태(미청구 또는 반려 상태가 아닌 경우)면 사진 추가/삭제 불가
			var state_code = ds_list.GetColumn(ds_list.row, "STATE_CODE");
			
			//결재상태가 A(신청)인 경우도 버튼 활성화하도록 수정 - 2019.10.10 강민석K (송광용D 요청사항)
			//if(state_code != "" && state_code != "Z"){
			if(state_code != "" && state_code != "A" && state_code != "Z"){
				btn_upload.Enable = false;//파일추가버튼
				btn_del_file.Enable = false;//파일삭제버튼
			}else{
				btn_upload.Enable = true;//파일추가버튼
				btn_del_file.Enable = true;//파일삭제버튼
			}
		}
	}
}
/********************************************************************************
* 기      능   : 저장 Callback  
********************************************************************************/
function fn_afterSave(errCode, errMsg) {
	if(errCode != 0){
		gfn_showMsg("CE00001");
	}else{
		//trace("ds_save PSPID : " + ds_save.GetColumn(0, "PSPID"));
		//trace("ds_save JOB_CODE : " + ds_save.GetColumn(0, "JOB_CODE"));
		//trace("ds_save LIFNR : " + ds_save.GetColumn(0, "LIFNR"));
		
		tit_clearActionInfo();
		tit_addSearchActionInfo("ps15:PS1505001P_S13");//문자발송 스킵 가능여부 조회
		tit_callService(
			  ""
			, ""
			, "ds_save=ds_save"
			, "ds_check_sms_send=ds_check_sms_send"
			, ""
			, "fn_afterCheckAlreadySendSms"
			, true);
	}
}
/********************************************************************************
* 기      능   : 푸시저장 Callback - 저장된 푸시seq 조회
********************************************************************************/
function fn_afterPushSave(errCode, errMsg) {
	if(errCode != 0){
		gfn_showMsg("CE00001");
	}else{
		//푸시 발송 시 사용할 푸시SEQ 조회
		tit_clearActionInfo();
		tit_addSearchActionInfo("ps15:PS1505001P_S15");
		tit_callService(
			  ""
			, ""
			, "ds_push=ds_push"
			, "ds_push_seq=ds_push_seq"
			, ""
			, "fn_afterGetPushSeq"
			, true);
	}
}
/********************************************************************************
* 기      능   : 푸시seq 조회 Callback - 조회된 푸시seq로 푸시발송 요청
********************************************************************************/
function fn_afterGetPushSeq(errCode, errMsg) {
	if(errCode != 0){
		gfn_showMsg("CE00001");
	}else{
		var seq = ds_push_seq.GetColumn(0, "SEQ");
		
		if(seq != "-1"){
			trace("푸시 발송 파라미터 - G_MANDT : " + G_MANDT);
			trace("푸시 발송 파라미터 - G_USER_ID : " + G_USER_ID);
			trace("푸시 발송 파라미터 - PSPID : " + ds_push.GetColumn(0, "PSPID"));
			trace("푸시 발송 파라미터 - POSID : " + ds_push.GetColumn(0, "POSID"));
			trace("푸시 발송 파라미터 - LIFNR : " + ds_push.GetColumn(0, "LIFNR"));
			trace("푸시 발송 파라미터 - PUSH_SEQ : " + ds_push_seq.GetColumn(0, "SEQ"));
			
			var recvUser = "'" + ds_list.GetColumn(ds_list.row, "PM_ID") + "'";//푸시 수신자 - 설치PM만
			recvUser = "'TEST03'";//##임시 - push토큰이 등록된 사용자가 없어서 테스트용으로 하드코딩 한다. - 강민석K
			//trace("푸시 발송 파라미터 - recvUser : " + recvUser);
			//trace("jsp 호출");
			//--------------------------------------------------------------------------------------------
			var SEQ = ds_push_seq.GetColumn(0, "SEQ");
			var url = G_SERVER_URL + "CallMsrmPush.jsp";
			var postData = TextToBin("USER_ID=" + G_USER_ID + "&SAP_ID=" + G_MANDT + "&SEQ=" + SEQ + "&RECV=" + recvUser);
			var headers = "Content-Type: application/x-www-form-urlencoded";
			AxMSIE_push.Navigate2(url, "", "", postData, headers);
			//--------------------------------------------------------------------------------------------
		}
	}
}
/********************************************************************************
* 기      능   : push 인터페이스 호출 Callback
********************************************************************************/
function AxMSIE_push_TitleChange(obj,Text)
{
	//CallMsrmPush.jsp에서 msrm의 인터페이스를 호출하고 나면 해당 url로 Text가 바뀐다
	if(Text != "before"){
		ufn_sendNote();
		
		parent.F_AUTO_QUERY = true;
		parent.fn_query();
		close();
	}
}
//=========================================================================================
// [ PART 5 ]
// Detail Process Event 정의 ( User Define function )
// 사용자 정의 함수는 ufn_xxxx() 형태로 작성 
//=========================================================================================
/********************************************************************************
* 기      능   : 시간, 분 콤보 초기화 및 세팅
********************************************************************************/
function ufn_initTimeCombo() {
	//작업종료 - 시간 콤보 초기화
	ds_com_time.DeleteAll();
	for(var i = 0; i < 24; i++){
		ds_com_time.AddRow();
		
		if(i < 10){
			ds_com_time.SetColumn(i, "CODE", "0" + ToString(i));
			ds_com_time.SetColumn(i, "CODE_NAME", "0" + ToString(i));
		}else{
			ds_com_time.SetColumn(i, "CODE", ToString(i));
			ds_com_time.SetColumn(i, "CODE_NAME", ToString(i));
		}
	}
	
	//작업종료 - 분 콤보 초기화
	ds_com_minute.DeleteAll();
	for(var i = 0; i < 6; i++){
		ds_com_minute.AddRow();
		
		if(i == 0){
			ds_com_minute.SetColumn(i, "CODE", "00");
			ds_com_minute.SetColumn(i, "CODE_NAME", "00");
		}else{
			ds_com_minute.SetColumn(i, "CODE", ToString(i) + "0");
			ds_com_minute.SetColumn(i, "CODE_NAME", ToString(i) + "0");
		}
	}
	
	//현재 시, 분으로 콤보 세팅
	var curDateTime = GetDate();
	cb_com_time.Value = substr(curDateTime, 8, 2);
	
	//분 콤보는 디폴트로 00으로 세팅 - 2019.09.19 강민석K (고범석K 요구사항)
	//cb_com_minute.Value = substr(curDateTime, 10, 1) + "0";
	cb_com_minute.Value = "00";
}
/********************************************************************************
* 기      능   : 프로젝트, 외주작업구분, 외주업체코드, 작업시작일자가 모두 같고 호기가 다른 경우 Push를 보내지 않기 위해 추가. 2019.09.19 강민석K
********************************************************************************/
function fn_afterCheckAlreadySendSms(errCode, errMsg) {
	//Push 내용 준비
	var comDate = cal_com_date.Value;
	F_MSG = "";
	F_MSG += ed_lifnr_out_name.Text + "(" + ed_jobname.Text + ") " + ds_list.GetColumn(ds_list.row, "WORKER_NAME");
	
	var worker2 = ds_list.GetColumn(ds_list.row, "WORKER_NAME2");
	if(worker2 != null && worker2 != ""){
		F_MSG += ", " + worker2;
	}
	F_MSG += "이(가) ";
	
	//요구사항에는 없지만 날짜도 필요할 것 같아서 추가 - 2019.08.02 강민석K
	F_MSG += substr(comDate, 0, 4) + "년 " + substr(comDate, 4, 2) + "월 " + substr(comDate, 6, 2) + "일 " + cb_com_time.Value + "시 " + cb_com_minute.Value + "분에 ";
	F_MSG += ds_list.GetColumn(ds_list.row, "ZSITE_NM_SMS") + " ";//프로젝트명은 12자로 한정
	
	//동 정보가 없으면 미표시
	if(st_dong.Text != ""){
		F_MSG += st_dong.Text + " ";
	}
	F_MSG += st_posid.Text + "의 작업을 완료했습니다.";
	
	if(errCode != 0){
		gfn_showMsg("CE00001");
		
		//Push 발송 스킵 가능여부 조회가 실패해도 안전사고 예방을 위해 Push는 보낸다. - 2019.09.19 강민석K
		ufn_sendPush();
	}else{
		gfn_showMsg("CI00003");
		
		//trace("ds_check_sms_send CNT : " + ds_check_sms_send.GetColumn(0, "CNT"));
		if(ds_check_sms_send.GetColumn(0, "CNT") == "0"){
			ufn_sendPush();
		}
	}
	
	//Push 발송 스킵 가능여부의 조회가 성공하고, 스킵 가능할 경우에는 여기서 쪽지발송 후 화면을 닫고,
	//조회가 실패하거나 스킵 불가인 경우에는 push를 발송한 다음 쪽지발송 후 화면을 닫는다. - 2019.09.24 강민석K
	if(errCode == 0 && ds_check_sms_send.GetColumn(0, "CNT") != "0"){
		ufn_sendNote();
		
		parent.F_AUTO_QUERY = true;
		parent.fn_query();
		close();
	}
}
/********************************************************************************
* 기      능   : Push 발송 기능을 함수로 분리 - 2019.09.19 강민석K
********************************************************************************/
function ufn_sendPush(){
	ds_push.DeleteAll();
	ds_push.AddRow();
	ds_push.SetColumn(0, "PSPID", ds_save.GetColumn(0, "PSPID"));
	ds_push.SetColumn(0, "POSID", ds_save.GetColumn(0, "POSID"));
	ds_push.SetColumn(0, "LIFNR", ds_save.GetColumn(0, "LIFNR"));
	ds_push.SetColumn(0, "MEMO_SEQ", "0");
	ds_push.SetColumn(0, "TITLE", "[작업완료 알림]");
	ds_push.SetColumn(0, "CONTENTS", F_MSG);
	
	tit_clearActionInfo();
	tit_addSingleActionInfo("ps15:PS1505001P_I7");
	tit_callService(
		  ""
		, ""
		, "ds_push=ds_push:A"
		, ""
		, "" 
		, "fn_afterPushSave"
		, true);
}
/********************************************************************************
* 기      능   : 쪽지발송 기능을 함수로 분리 - 2019.09.19 강민석K (장성원PM 요구사항)
********************************************************************************/
function ufn_sendNote(){
	//설치PM - 작업완료 쪽지는 PM에게만 보낸다. (장성원PM 요구사항)
	var pm_id = ds_list.GetColumn(ds_list.row, "PM_ID");
	
	gfn_initDs(ds_msgsend, true);
	ds_msgsend.SetColumn(0, "MESGSEND", G_USER_ID);//발신자
	ds_msgsend.SetColumn(0, "MESGACCP", pm_id);//수신자
	ds_msgsend.SetColumn(0, "MESGTITL", "외주작업 완료");//제목
	ds_msgsend.SetColumn(0, "MESGDESC", F_MSG);//내용
	
	if(pm_id != null && pm_id != ""){
		tit_clearActionInfo();
		tit_addSingleActionInfo("ps13:PS1301007B_I2");
		tit_callService(
			  ""
			, ""
			, "ds_msgsend=ds_msgsend"
			, ""
			, ""
			, "");
	}
}
//=========================================================================================
// [ PART 6 ]
// component Event 정의 : 각 Component 별 이벤트 
//=========================================================================================
/********************************************************************************
* 기      능   : 그리드 헤더 클릭시 정렬 처리 
********************************************************************************/
function grd_list_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
{
	if ( nCell == 0 ) {
		// 그리드 표시할 컬럼 선택 
		gfn_selectGridCol(obj);
	} else {
		// 그리드 정렬 처리 
		gfn_sortGrid(obj,nCell);
	}
}
/********************************************************************************
* 기      능   : 데이터셋 값 변경 시 - Flag 처리 
********************************************************************************/
function ds_list_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{
	gfn_changeFlag( obj, strColumnID, nRow, "FLAG" );
}
/********************************************************************************
* 기      능   : 시방조회 버튼 클릭 시 - 시방조회 화면 팝업
********************************************************************************/
function btn_sibang_OnClick(obj)
{
	var arg  = "PSPID=" + quote(ds_list.GetColumn(ds_list.row, "PSPID"));//프로젝트번호
		arg += " POSID=" + quote(st_posid.Text);//호기번호
		arg += " SITE_NM=" + quote(st_site_nm.Text);//프로젝트명
		arg += " JOB_CODE=" + quote(ds_list.GetColumn(ds_list.row, "JOB_CODE"));//외주작업코드
	gfn_openPopup("PS1505001E", true, arg);
}
/********************************************************************************
* 기      능   : 도면 버튼 클릭 시 - 도면 화면 팝업
********************************************************************************/
function btn_plan_OnClick(obj)
{
	if(length(ds_pdf.getColumn(0, "UDATE")) > 0){
		fn_createWait("", this);
		//==========================================================================================================
		var FileName = ds_pdf.getColumn(0, "POSID") + '.pdf';
		//var FileName = '173395.pdf';//테스트용
		var FilePath = "c:\\Temp";
		var FileExec = "c:\\Temp\\" + FileName;
        
        //trace("FileName : [" + FileName + "]");
        //trace("FilePath : [" + FilePath + "]");
        //trace("FileExec : [" + FileExec + "]");
        
		var rMsg = tit_fileRead(
			  httpFile
			, "PDM"		// 저장 디렉토리
			, FileName	// 서버에서 전송받을 이름
			, FilePath	// 로컬 경로
			, FileName	// 로컬 파일명
		);
		fn_destroyWait();
		
		if(rMsg[0] == "E"){
			if(length(trim(rMsg[1])) > 0){
				gfn_showAlert("CW10025", rMsg[1]);
			}else{
				gfn_showAlert("CW10025", "파일 다운로드에 실패하였습니다.");
			}
		}else{
			ExecShell(FileExec);
		}
		//==========================================================================================================
	}else{
		gfn_alert("해당 프로젝트는 PDF 도면이 없습니다.\n\n(PDM에서 조회하시기 바랍니다)");
    }
}
/********************************************************************************
* 기      능   : 메모추가 버튼 클릭 시 - 메모관리 화면 팝업
********************************************************************************/
function btn_add_OnClick(obj)
{
	var arg  = "CRNAM=" + quote("");//입력자
		//알림 대상자 추가 - 2019.09.18 강민석K
		arg += " PM_ID=" + quote(ds_list.GetColumn(ds_list.row, "PM_ID"));//설치PM
		arg += " SERVICE_HP=" + quote(ds_list.GetColumn(ds_list.row, "SERVICE_HP"));//서비스담당자 - MMS에 푸시를 보낼 수 없어 서비스담당자는 문자로 발송하기로 함. 2019.09.19 강민석K(PM리뷰 회의 결정)
		arg += " SALES_ID=" + quote(ds_list.GetColumn(ds_list.row, "SALES_ID"));//영업담당자
		arg += " OUT_TEAM_ID=" + quote(ds_list.GetColumn(ds_list.row, "OUT_TEAM_ID"));//외주업체 팀장
		arg += " WORKER_ID=" + quote(ds_list.GetColumn(ds_list.row, "WORKER_ID"));//작업자1
		arg += " WORKER_ID2=" + quote(ds_list.GetColumn(ds_list.row, "WORKER_ID2"));//작업자2
	gfn_openPopup("PS1505001C", true, arg);
}
/********************************************************************************
* 기      능   : 삭제 버튼 클릭 시 - 선택한 메모 삭제
********************************************************************************/
function btn_delete_OnClick(obj)
{
	//항목 선택 여부 체크
	if(ds_memo.FindRow("CHK", "1") == -1){
		gfn_showMsg("CW00046");
		return;
	}
	
	//메모 삭제는 1건씩만 가능
	ds_memo.Filter("CHK == '1'");
	var nChkCnt = ds_memo.rowcount;
	ds_memo.UnFilter();
	
	if(nChkCnt > 1){
		gfn_openMsgWin("메모 삭제는 1건씩만 가능합니다.", "I", "", "");
		return;
	}
	
	//입력자와 로그인 사용자가 같은지 체크
	if(userGroup != "40"){//단, 관리팀 권한인 경우 삭제 가능 - 고범석K 요청사항
		for(var i = 0; i < ds_memo.rowcount; i++){
			if(ds_memo.GetColumn(i, "CHK") == "1" && ds_memo.GetColumn(i, "CRID") != G_USER_ID){
				gfn_openMsgWin("메모 삭제는 등록자만 가능합니다.", "I", "", "");
				return;
			}
		}
	}
	
	//삭제 여부 확인
	if(!gfn_openMsgWin("선택한 메모를 삭제 하시겠습니까?", "I", "C", "")){
		return;
	}
	
	ds_memo_del.ClearData();
	ds_memo_del.AddRow();
	
	// SEQ_LIST 만들기(메모 다중 선택 삭제) - 단건 삭제로 바꿨지만 실제 삭제 로직은 다중으로 남겨둔다
	var sSeqList = "";
	for(var j = 0; j < ds_memo.rowcount; j++){
		if(ds_memo.GetColumn(j, "CHK") == "1"){
			ds_memo_del.SetColumn(0, "PSPID", ds_list.GetColumn(ds_list.row, "PSPID"));
			ds_memo_del.SetColumn(0, "POSID", ds_list.GetColumn(ds_list.row, "POSID"));
			ds_memo_del.SetColumn(0, "LIFNR", ds_list.GetColumn(ds_list.row, "LIFNR_OUT"));
			
			sSeqList += "'" + ds_memo.GetColumn(j, "SEQ") + "',";
			//trace("memo SEQ : " + ds_memo.GetColumn(j, "SEQ"));
		}
	}
	sSeqList = "(" + substr(sSeqList, 0, length(sSeqList) - 1) + ")";
	
	qry= " AND SEQ IN " + sSeqList;
	args = " SQRY=" + quote(qry);
	
	tit_clearActionInfo();
	tit_addSearchActionInfo("ps15:PS1505001P_U1");//메모 삭제
	tit_callService(
		  ""
		, ""
	    , "ds_memo_del=ds_memo_del"
	    , ""
	    , args
	    , ""
	    , ""
	    , ""
	    , true);
	
	fn_query();
}
/********************************************************************************
* 기      능   : 메모 그리드 더블클릭 시 - 선택한 메모 상세 표시
********************************************************************************/
function grd_memo_OnCellDblClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
	if(nCell != 0){
		var arg  = "CRNAM=" + quote(ds_memo.GetColumn(nRow, "CRNAM"));//입력자
		    arg += " BELONG=" + quote(ds_memo.GetColumn(nRow, "BELONG"));//소속
		    arg += " CONTENTS=" + quote(ds_memo.GetColumn(nRow, "CONTENTS_ORIG"));//내용
			arg += " ALM_INDC=" + quote(ds_memo.GetColumn(nRow, "ALM_INDC"));//알림대상
		    //arg += " CRID=" + quote(ds_memo.GetColumn(nRow, "CRID"));//입력자ID
		    arg += " PSPID=" + quote(ds_cond1.getColumn(0, "POSID"));//프로젝트 번호
            arg += " POSID=" + quote(ds_cond1.getColumn(0, "POSID_1"));//호기 번호
            arg += " LIFNR=" + quote(ds_memo.GetColumn(0, "MEMO_LIFNR"));//업체코드
            arg += " SEQ=" + quote(ds_memo.GetColumn(nRow, "SEQ"));//SEQ
		gfn_openPopup("PS1505001C", true, arg);
	}
}
/********************************************************************************
* 기      능   : 작업종료일 변경 시 - 
********************************************************************************/
function cal_com_date_OnChanged(obj,strOldText,strNewText)
{
	//우선 입력 가능 일자에 제한을 두지 않는다. - 2019.07.23 강민석K
	return;
	if(F_START_DATE_EVENT_ENABLE == true){
		if(strNewText < gfn_getCurrDate()){
			gfn_openMsgWin("금일보다 이전 일자로 선택할 수 없습니다.", "E", "", "");
			cal_com_date.Value = gfn_getCurrDate();
			cal_com_date.SetFocus();
		}
	}else{
		F_START_DATE_EVENT_ENABLE = true;
	}
}
/********************************************************************************
* 기      능   : 파일 다운로드 클릭 시 - 선택한 파일 다운로드
********************************************************************************/
function btn_download_OnClick(obj)
{
	if(ds_file_list.rowcount == 0) return;
	
	var nRow = ds_file_list.rowposition;
	
	var svrFileName = ds_file_list.GetColumn(nRow, "FNAME_APP");
	var orgFileName = ds_file_list.GetColumn(nRow, "FNAME");
	var ext         = gfn_getFileExt(ds_file_list.GetColumn(nRow, "FNAME"));

	saveDialog.FileName = orgFileName;
	saveDialog.Filter = "All(*.*)|*.*";
	saveDialog.FilterIndex = "";
    var sRtn = saveDialog.open();
	
	if(sRtn != "1") return;
	
	var idx = indexOf(saveDialog.FileName, ".");
	var fdFileName = saveDialog.FileName;
    var fileName =  decode(idx, -1, fdFileName, substr(fdFileName, 0, indexOf(fdFileName, ".")));
    var localFileName = fileName + "." + ext;

	var rMsg = tit_fileRead(
					httpFile
				  , "PS"				// 서버 저장 디렉토리
				  , svrFileName			// 서버에서 전송받을 이름
				  , saveDialog.FilePath	// 로컬 경로
				  , localFileName		// 로컬 파일명
				);
	
	if(rMsg[0] == "E"){
		if(length(trim(rMsg[1])) > 0){
			gfn_showAlert("CW10025", rMsg[1]);
		}else{
			gfn_showAlert("CW10025", "파일 다운로드에 실패하였습니다.");
		}
	}else{
		gfn_showAlert("CW10025", "파일을 다운로드 하였습니다.");
	}
}
/********************************************************************************
* 기      능   : 파일추가 클릭 시 - 파일선택창 표시
********************************************************************************/
function btn_upload_OnClick(obj)
{
	var fileName = "";
	
	if(ds_file_list.rowcount >= 3)
	{
		gfn_openMsgWin("추가할 수 있는 파일 개수를 초과했습니다.\n(최대 3개 저장가능)", "", "A");
		return;
	}
	
	gfn_openPopup("PS1505001H", true);
}
/********************************************************************************
* 기      능   : 파일 삭제 후 Callback
********************************************************************************/
function fn_afterFileAddDel()
{
	ds_cond1.DeleteAll();
	ds_cond1.AddRow();
	
	ds_cond1.SetColumn(0, "POSID", ds_list.GetColumn(ds_list.row, "PSPID"));
	ds_cond1.SetColumn(0, "POSID_1", ds_list.GetColumn(ds_list.row, "POSID"));
	ds_cond1.SetColumn(0, "JOB_CODE", ds_list.GetColumn(ds_list.row, "JOB_CODE"));
	ds_cond1.SetColumn(0, "LIFNR", ds_list.GetColumn(ds_list.row, "LIFNR_OUT"));
	ds_cond1.SetColumn(0, "P_CODE", "5");
	
	tit_clearActionInfo();
	tit_addSearchActionInfo("ps15:PS1505001P_S5");//파일목록 조회
	tit_callService(
          ""
        , ""
        , "ds_cond=ds_cond1"
        , "ds_file_list=ds_file_list"
        , ""
        , ""
        , true);
}
/********************************************************************************
* 기      능   : 파일삭제 클릭 시 - 선택한 파일 삭제
********************************************************************************/
function btn_del_file_OnClick(obj)
{
	if(ds_file_list.rowcount == 0){
		gfn_showMsg("삭제할 사진이 없습니다.");
		return;
	}
	
	ds_file_list.Filter("CHK == '1'");
	var nChkCnt = ds_file_list.rowcount;
	//trace("nChkCnt : " + nChkCnt);
	ds_file_list.UnFilter();
	
	if(nChkCnt == 0){
		gfn_showMsg("삭제할 사진을 선택하세요.");
		return;
	}else{
		if(F_MODIFY_MODE == true){//수정모드일 경우
			if(nChkCnt > 1){
				//다중 삭제 제한 추가 - 수정모드 일 때는 전체 삭제되면 안되기 때문에 로직 추가 - 2019.07.24 강민석K
				gfn_showMsg("사진 삭제는 1건씩만 가능합니다.");
				return;
			}
			
			ds_file_list.UnFilter();//ds_file_list의 전체 rowcount를 얻기 위해 UnFilter (예비용)
			
			//사진업로드 필수여부 관련 추가 - 2019.10.02 강민석K
			//if(ds_file_list.rowcount == 1){
			if(F_PIC_UPLOAD_YN == "Y" && ds_file_list.rowcount == 1){
				gfn_openMsgWin("작업종료 정보가 저장된 호기는 사진이 1개 이상 등록되어 있어야 합니다.", "W", "", "");
				return;
			}
		}
	}
	
	//삭제 여부 확인
	if(!gfn_openMsgWin("선택한 파일을 삭제 하시겠습니까?", "I", "C", "")){
		return;
	}
	
	for(var i = 0; i < ds_file_list.rowcount; i++)
	{
		var sFileName = ds_file_list.GetColumn(i, "FNAME");
		var sChk      = ds_file_list.GetColumn(i, "CHK");
		
		if(length(sFileName) != 0 && sChk == "1")
		{
			var arr = tit_fileDelete("PS", ds_file_list.GetColumn(i, "FNAME_APP"), false);
		}
	}
	
	// 체크된 파일만 삭제처리
	ds_file_list.Filter("CHK == '1'");
	ds_file_del.copyF(ds_file_list);
	ds_file_list.unFilter();
	
	//trace("ds_file_del : " + ds_file_del.SaveXML());
	
	// 파일 삭제 저장
	tit_clearActionInfo();	
	tit_addMultiActionInfo("ps15:PS1505001P_U2");
	tit_callService(
		  ""
		, ""        
		, "ds_file=ds_file_del"
		, ""
		, ""
		, "fn_afterFileAddDel"
		, ""
		, ""
		, true
	);
}
/********************************************************************************
* 기      능   : 첨부파일 그리드 더블클릭 시 - 파일 다운로드
********************************************************************************/
function grd_file_OnCellDblClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
	if(nCell != 0){
		if(length(ds_file_list.getColumn(nRow, "FNAME")) > 0){
			// 첨부 파일 처리 
			fn_createWait("", this);
			
			var FilePath = "c:\\Temp";
			var FileExec = "c:\\Temp\\" + ds_file_list.getColumn(nRow, "FNAME");
			
			saveDialog.FileName = ds_file_list.getColumn(nRow, "FNAME");
			
			var rMsg = tit_fileRead(httpFile
									, "PS"										// 저장 디렉토리
									, ds_file_list.getColumn(nRow, "FNAME_APP")	// 서버에서 전송받을 이름
									, FilePath									// 로컬 경로
									, ds_file_list.getColumn(nRow, "FNAME")		// 로컬 파일명
						);
			
			fn_destroyWait();
			
			if(rMsg[0] == "E"){
				if(length(trim(rMsg[1])) > 0){
					gfn_showAlert("CW10025", rMsg[1]);
				}else{
					gfn_showAlert("CW10025", "파일 다운로드에 실패하였습니다.");
				}
			}else{
				ExecShell(FileExec);
			}
		}
	}
}

/********************************************************************************
* 기      능   : 자재수령완료 버튼 클릭 시
********************************************************************************/
/*
function btn_matnrCom_OnClick(obj)
{
	// ZPSTW1401 - MATNR_COM = 'X' Update
	tit_clearActionInfo();
	tit_addMultiActionInfo("ps15:PS1505001I_U1");	// ZPSTW1401

	tit_callService(
			""
			, ""
			, "ds_cond=ds_cond1"
			, ""
			, ""
			, "fn_afterMatnrCom"
			, ""
			, ""
			, true);
}

function fn_afterMatnrCom(errCode, errMsg)
{
	if(errCode != 0){
		gfn_showMsg("CE00001");
	}else{
		gfn_openMsgWin("자재수령완료 처리되었습니다.");
		fn_query();
	}
	
}
*/]]></Script>
</Window>