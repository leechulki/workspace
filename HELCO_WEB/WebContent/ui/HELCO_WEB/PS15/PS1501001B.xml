<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="792" Id="PS1501001B" Left="8" OnLoadCompleted="fn_OnLoadCompleted" OnUnloadCompleted="fn_OnUnloadCompleted" PidAttrib="7" Title="현장&#32;소모품&#32;결재&#32;신청" Top="8" Ver="1.0" Width="616" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_cond">
				<Contents>
					<colinfo id="LIFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="PERNO" size="256" summ="default" type="STRING"/>
					<colinfo id="GNM" size="256" summ="default" type="STRING"/>
					<colinfo id="DPTNM" size="256" summ="default" type="STRING"/>
					<colinfo id="JUMIN" size="256" summ="default" type="STRING"/>
					<colinfo id="PERKEY" size="256" summ="default" type="STRING"/>
					<colinfo id="SUPRTCD" size="256" summ="default" type="STRING"/>
					<colinfo id="SUBJECTCD" size="256" summ="default" type="STRING"/>
					<colinfo id="USERNUMB" size="256" summ="default" type="STRING"/>
					<colinfo id="ORDERNO" size="256" summ="default" type="STRING"/>
					<record>
						<DPTNM></DPTNM>
						<GNM></GNM>
						<JUMIN></JUMIN>
						<LIFNR></LIFNR>
						<ORDERNO></ORDERNO>
						<PERKEY></PERKEY>
						<PERNO></PERNO>
						<SUBJECTCD></SUBJECTCD>
						<SUPRTCD></SUPRTCD>
						<USERNUMB></USERNUMB>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_head">
				<Contents>
					<colinfo id="LIFNR" size="255" type="STRING"/>
					<colinfo id="NAME1" size="256" type="STRING"/>
					<colinfo id="NAMEC" size="256" type="STRING"/>
					<colinfo id="CNT" size="256" type="STRING"/>
					<colinfo id="DIRECT" size="256" type="STRING"/>
					<colinfo id="INDIRECT" size="256" type="STRING"/>
					<colinfo id="TELNO_O" size="256" type="STRING"/>
					<colinfo id="FAX_O" size="256" type="STRING"/>
					<colinfo id="ADDR" size="256" type="STRING"/>
					<record>
						<ADDR></ADDR>
						<CNT></CNT>
						<DIRECT></DIRECT>
						<FAX_O></FAX_O>
						<INDIRECT></INDIRECT>
						<LIFNR></LIFNR>
						<NAME1></NAME1>
						<NAMEC></NAMEC>
						<TELNO_O></TELNO_O>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_upgbn">
				<Contents>
					<colinfo id="CODE" size="255" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_zzactss">
				<Contents>
					<colinfo id="CODE" size="255" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_swn">
				<Contents>
					<colinfo id="GID" size="255" type="STRING"/>
					<colinfo id="GNM" size="256" type="STRING"/>
					<colinfo id="RANK" size="256" type="STRING"/>
					<colinfo id="DPTNM" size="256" type="STRING"/>
					<colinfo id="PERNO" size="256" type="STRING"/>
					<colinfo id="LIFNR" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_gyul">
				<Contents>
					<colinfo id="GID" size="255" summ="default" type="STRING"/>
					<colinfo id="GNM" size="256" summ="default" type="STRING"/>
					<colinfo id="RANK" size="256" summ="default" type="STRING"/>
					<colinfo id="DPTNM" size="256" summ="default" type="STRING"/>
					<colinfo id="PERNO" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="SIGN_YN" size="256" summ="default" type="STRING"/>
					<colinfo id="GUBUN" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_supported">
				<Contents>
					<colinfo id="SUPRTCD" size="256" summ="default" type="STRING"/>
					<colinfo id="SUPRTCDT" size="256" summ="default" type="STRING"/>
					<colinfo id="NOTICE" size="256" summ="default" type="STRING"/>
					<record>
						<NOTICE></NOTICE>
						<SUPRTCD></SUPRTCD>
						<SUPRTCDT></SUPRTCDT>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_apply1">
				<Contents>
					<colinfo id="GID" size="0" summ="default" type="STRING"/>
					<colinfo id="GNM" size="0" summ="default" type="STRING"/>
					<colinfo id="RANK" size="0" summ="default" type="STRING"/>
					<colinfo id="DPTNM" size="0" summ="default" type="STRING"/>
					<colinfo id="USERMBPN" size="256" summ="default" type="STRING"/>
					<colinfo id="AREA_N" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="PERNO" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_apply2">
				<Contents>
					<colinfo id="GID" size="0" summ="default" type="STRING"/>
					<colinfo id="GNM" size="0" summ="default" type="STRING"/>
					<colinfo id="RANK" size="0" summ="default" type="STRING"/>
					<colinfo id="DPTNM" size="0" summ="default" type="STRING"/>
					<colinfo id="USERMBPN" size="256" summ="default" type="STRING"/>
					<colinfo id="AREA_N" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="PERNO" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_poi">
				<Contents>
					<colinfo id="PNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="MANDT" size="256" summ="default" type="STRING"/>
					<colinfo id="SUPRTCD" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="TEL" size="256" summ="default" type="STRING"/>
					<colinfo id="USERNUMB" size="256" summ="default" type="STRING"/>
					<colinfo id="CRDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="CNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="EMAIL" size="256" summ="default" type="STRING"/>
					<record>
						<CNAME></CNAME>
						<CRDAT></CRDAT>
						<EMAIL></EMAIL>
						<LIFNR></LIFNR>
						<MANDT></MANDT>
						<PNAME></PNAME>
						<SUPRTCD></SUPRTCD>
						<TEL></TEL>
						<USERNUMB></USERNUMB>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_prj">
				<Contents>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
					<colinfo id="ZMAN_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="ZQNTY" size="256" summ="default" type="STRING"/>
					<colinfo id="VALUE" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSITE_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="ADDR" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_insertCond">
				<Contents>
					<colinfo id="PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="TITLE" size="256" summ="default" type="STRING"/>
					<colinfo id="RELIFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="EMPNO" size="256" summ="default" type="STRING"/>
					<colinfo id="SUPRTCD" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNREMPNO" size="256" summ="default" type="STRING"/>
					<colinfo id="STATE" size="256" summ="default" type="STRING"/>
					<colinfo id="APPDATE1" size="256" summ="default" type="STRING"/>
					<colinfo id="PCPNUM1" size="256" summ="default" type="STRING"/>
					<colinfo id="MEMO1" size="256" summ="default" type="STRING"/>
					<colinfo id="APPDATE2" size="256" summ="default" type="STRING"/>
					<colinfo id="PCPNUM2" size="256" summ="default" type="STRING"/>
					<colinfo id="MEMO2" size="256" summ="default" type="STRING"/>
					<colinfo id="APPDATE3" size="256" summ="default" type="STRING"/>
					<colinfo id="PCPNUM3" size="256" summ="default" type="STRING"/>
					<colinfo id="MEMO3" size="256" summ="default" type="STRING"/>
					<colinfo id="SENDDATE" size="256" summ="default" type="STRING"/>
					<colinfo id="SENDER" size="256" summ="default" type="STRING"/>
					<colinfo id="MEMO4" size="256" summ="default" type="STRING"/>
					<colinfo id="RECDATE" size="256" summ="default" type="STRING"/>
					<colinfo id="RECID" size="256" summ="default" type="STRING"/>
					<colinfo id="RECPART" size="256" summ="default" type="STRING"/>
					<colinfo id="RECRANK" size="256" summ="default" type="STRING"/>
					<colinfo id="RECNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="RECTEL" size="256" summ="default" type="STRING"/>
					<colinfo id="IMPDATE" size="256" summ="default" type="STRING"/>
					<colinfo id="CRDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="CRTIM" size="256" summ="default" type="STRING"/>
					<colinfo id="CRNAM" size="256" summ="default" type="STRING"/>
					<colinfo id="CHDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="CHTIM" size="256" summ="default" type="STRING"/>
					<colinfo id="CHNAM" size="256" summ="default" type="STRING"/>
					<colinfo id="RECADDR" size="256" summ="default" type="STRING"/>
					<colinfo id="ORDERNO" size="256" summ="default" type="STRING"/>
					<record>
						<APPDATE1></APPDATE1>
						<APPDATE2></APPDATE2>
						<APPDATE3></APPDATE3>
						<CHDAT></CHDAT>
						<CHNAM></CHNAM>
						<CHTIM></CHTIM>
						<CRDAT></CRDAT>
						<CRNAM></CRNAM>
						<CRTIM></CRTIM>
						<EMPNO></EMPNO>
						<IMPDATE></IMPDATE>
						<LIFNR></LIFNR>
						<LIFNREMPNO></LIFNREMPNO>
						<MEMO1></MEMO1>
						<MEMO2></MEMO2>
						<MEMO3></MEMO3>
						<MEMO4></MEMO4>
						<ORDERNO></ORDERNO>
						<PCPNUM1></PCPNUM1>
						<PCPNUM2></PCPNUM2>
						<PCPNUM3></PCPNUM3>
						<PSPID></PSPID>
						<RECADDR></RECADDR>
						<RECDATE></RECDATE>
						<RECID></RECID>
						<RECNAME></RECNAME>
						<RECPART></RECPART>
						<RECRANK></RECRANK>
						<RECTEL></RECTEL>
						<RELIFNR></RELIFNR>
						<SENDDATE></SENDDATE>
						<SENDER></SENDER>
						<STATE></STATE>
						<SUPRTCD></SUPRTCD>
						<TITLE></TITLE>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_gubun">
				<Contents>
					<colinfo id="CODE" size="255" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE>01</CODE>
						<CODE_NAME>표준</CODE_NAME>
					</record>
					<record>
						<CODE>02</CODE>
						<CODE_NAME>직접입력</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_subject" OnColumnChanged="ds_subject_OnColumnChanged">
				<Contents>
					<colinfo id="SJTCDGB" size="256" summ="default" type="STRING"/>
					<colinfo id="SUBJECTCDT" size="256" summ="default" type="STRING"/>
					<colinfo id="SPEC" size="256" summ="default" type="STRING"/>
					<colinfo id="NOTI" size="256" summ="default" type="STRING"/>
					<colinfo id="SUPRTCD" size="256" summ="default" type="STRING"/>
					<colinfo id="QTY" size="256" summ="default" type="STRING"/>
					<colinfo id="SUBJECTCD" size="256" summ="default" type="STRING"/>
					<colinfo id="ORDERNO" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ret">
				<Contents>
					<colinfo id="CHASU" size="0" type="STRING"/>
					<colinfo id="NAME1" size="0" type="STRING"/>
					<colinfo id="RETID" size="0" type="STRING"/>
					<colinfo id="RETIT" size="0" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_m_subject">
				<Contents>
					<colinfo id="SJTCDGB" size="256" summ="default" type="STRING"/>
					<colinfo id="SUBJECTCD" size="256" summ="default" type="STRING"/>
					<colinfo id="SPEC" size="256" summ="default" type="STRING"/>
					<colinfo id="NOTI" size="256" summ="default" type="STRING"/>
					<colinfo id="SUBJECTCDT" size="256" summ="default" type="STRING"/>
					<colinfo id="SUPRTCD" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_apply">
				<Contents>
					<colinfo id="GID" size="0" summ="default" type="STRING"/>
					<colinfo id="GNM" size="0" summ="default" type="STRING"/>
					<colinfo id="RANK" size="0" summ="default" type="STRING"/>
					<colinfo id="DPTNM" size="0" summ="default" type="STRING"/>
					<colinfo id="USERMBPN" size="256" summ="default" type="STRING"/>
					<colinfo id="AREA_N" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="PERNO" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_sub_subject">
				<Contents>
					<colinfo id="SJTCDGB" size="256" summ="default" type="STRING"/>
					<colinfo id="SUBJECTCD" size="256" summ="default" type="STRING"/>
					<colinfo id="SPEC" size="256" summ="default" type="STRING"/>
					<colinfo id="NOTI" size="256" summ="default" type="STRING"/>
					<colinfo id="SUBJECTCDT" size="256" summ="default" type="STRING"/>
					<colinfo id="SUPRTCD" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond2">
				<Contents>
					<colinfo id="LIFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="PERNO" size="256" summ="default" type="STRING"/>
					<colinfo id="GNM" size="256" summ="default" type="STRING"/>
					<colinfo id="DPTNM" size="256" summ="default" type="STRING"/>
					<colinfo id="JUMIN" size="256" summ="default" type="STRING"/>
					<colinfo id="PERKEY" size="256" summ="default" type="STRING"/>
					<colinfo id="SUPRTCD" size="256" summ="default" type="STRING"/>
					<colinfo id="SUBJECTCD" size="256" summ="default" type="STRING"/>
					<record>
						<DPTNM></DPTNM>
						<GNM></GNM>
						<JUMIN></JUMIN>
						<LIFNR></LIFNR>
						<PERKEY></PERKEY>
						<PERNO></PERNO>
						<SUBJECTCD></SUBJECTCD>
						<SUPRTCD></SUPRTCD>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_purchase">
				<Contents>
					<colinfo id="NAME" size="256" summ="default" type="STRING"/>
					<colinfo id="USERTELE" size="256" summ="default" type="STRING"/>
					<colinfo id="USERMAIL" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="SUPRTCD" size="256" summ="default" type="STRING"/>
					<colinfo id="USERNUMB" size="256" summ="default" type="STRING"/>
					<colinfo id="EMPNOUSERNUMB" size="256" summ="default" type="STRING"/>
					<colinfo id="RANK" size="256" summ="default" type="STRING"/>
					<colinfo id="GNM" size="256" summ="default" type="STRING"/>
					<colinfo id="DPTNM" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<record>
						<CHK></CHK>
						<DPTNM></DPTNM>
						<EMPNOUSERNUMB></EMPNOUSERNUMB>
						<GNM></GNM>
						<LIFNR></LIFNR>
						<NAME></NAME>
						<RANK></RANK>
						<SUPRTCD></SUPRTCD>
						<USERMAIL></USERMAIL>
						<USERNUMB></USERNUMB>
						<USERTELE></USERTELE>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_seqno">
				<Contents>
					<colinfo id="ORDERNO" size="256" summ="default" type="STRING"/>
					<record>
						<ORDERNO></ORDERNO>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list">
				<Contents>
					<colinfo id="MANDT" size="256" summ="default" type="STRING"/>
					<colinfo id="ORDERNO" size="256" summ="default" type="STRING"/>
					<colinfo id="CAREYM" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSITE_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="TITLE" size="256" summ="default" type="STRING"/>
					<colinfo id="EMPNO" size="256" summ="default" type="STRING"/>
					<colinfo id="EMPNM" size="256" summ="default" type="STRING"/>
					<colinfo id="SUPRTCD" size="256" summ="default" type="STRING"/>
					<colinfo id="SUPRTCDT" size="256" summ="default" type="STRING"/>
					<colinfo id="FIRST_SUBJECTCDT" size="256" summ="default" type="STRING"/>
					<colinfo id="ENTER" size="256" summ="default" type="STRING"/>
					<colinfo id="CNT" size="256" summ="default" type="INT"/>
					<colinfo id="LIFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNR_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNREMPNO" size="256" summ="default" type="STRING"/>
					<colinfo id="STATE" size="256" summ="default" type="STRING"/>
					<colinfo id="APPDATE1" size="256" summ="default" type="STRING"/>
					<colinfo id="PCPNUM1" size="256" summ="default" type="STRING"/>
					<colinfo id="MEMO1" size="256" summ="default" type="STRING"/>
					<colinfo id="APPDATE2" size="256" summ="default" type="STRING"/>
					<colinfo id="PCPNUM2" size="256" summ="default" type="STRING"/>
					<colinfo id="MEMO2" size="256" summ="default" type="STRING"/>
					<colinfo id="APPDATE3" size="256" summ="default" type="STRING"/>
					<colinfo id="PCPNUM3" size="256" summ="default" type="STRING"/>
					<colinfo id="MEMO3" size="256" summ="default" type="STRING"/>
					<colinfo id="SENDDATE" size="256" summ="default" type="STRING"/>
					<colinfo id="RECDATE" size="256" summ="default" type="STRING"/>
					<colinfo id="RECID" size="256" summ="default" type="STRING"/>
					<colinfo id="CRDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="CRTIM" size="256" summ="default" type="STRING"/>
					<colinfo id="CRNAM" size="256" summ="default" type="STRING"/>
					<colinfo id="CHDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="CHTIM" size="256" summ="default" type="STRING"/>
					<colinfo id="CHNAM" size="256" summ="default" type="STRING"/>
					<colinfo id="MEMO" size="256" summ="default" type="STRING"/>
					<colinfo id="PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="SUBJECTCDT_ITEMS" size="256" summ="default" type="STRING"/>
					<colinfo id="PCPNM1" size="256" summ="default" type="STRING"/>
					<colinfo id="PCPNM2" size="256" summ="default" type="STRING"/>
					<colinfo id="PCPNM3" size="256" summ="default" type="STRING"/>
					<colinfo id="RECNM" size="256" summ="default" type="STRING"/>
					<colinfo id="RECPART" size="256" summ="default" type="STRING"/>
					<colinfo id="RECRANK" size="256" summ="default" type="STRING"/>
					<colinfo id="RECNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="RECTEL" size="256" summ="default" type="STRING"/>
					<colinfo id="NOTICE" size="256" summ="default" type="STRING"/>
					<colinfo id="IMPDATE" size="256" summ="default" type="STRING"/>
					<colinfo id="RECADDR" size="256" summ="default" type="STRING"/>
					<colinfo id="EMP_AREA_N" size="256" summ="default" type="STRING"/>
					<colinfo id="PCPNUM1_MAIL" size="256" summ="default" type="STRING"/>
					<colinfo id="PCPNUM2_MAIL" size="256" summ="default" type="STRING"/>
					<colinfo id="PCPNUM3_MAIL" size="256" summ="default" type="STRING"/>
					<colinfo id="EMP_MAIL" size="256" summ="default" type="STRING"/>
					<colinfo id="PCPNUM1_AREA_N" size="256" summ="default" type="STRING"/>
					<colinfo id="PCPNUM2_AREA_N" size="256" summ="default" type="STRING"/>
					<colinfo id="PCPNUM3_AREA_N" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_gyul2">
				<Contents>
					<colinfo id="GID" size="255" summ="default" type="STRING"/>
					<colinfo id="GNM" size="256" summ="default" type="STRING"/>
					<colinfo id="RANK" size="256" summ="default" type="STRING"/>
					<colinfo id="DPTNM" size="256" summ="default" type="STRING"/>
					<colinfo id="PERNO" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="SIGN_YN" size="256" summ="default" type="STRING"/>
					<colinfo id="GUBUN" size="256" summ="default" type="STRING"/>
					<colinfo id="PCPNUM1" size="256" summ="default" type="STRING"/>
					<colinfo id="PCPNUM2" size="256" summ="default" type="STRING"/>
					<colinfo id="PCPNUM3" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ms_subject">
				<Contents>
					<colinfo id="SJTCDGB" size="256" summ="default" type="STRING"/>
					<colinfo id="SUBJECTCD" size="256" summ="default" type="STRING"/>
					<colinfo id="SPEC" size="256" summ="default" type="STRING"/>
					<colinfo id="NOTI" size="256" summ="default" type="STRING"/>
					<colinfo id="SUBJECTCDT" size="256" summ="default" type="STRING"/>
					<colinfo id="SUPRTCD" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_temp">
				<Contents>
					<colinfo id="SJTCDGB" size="256" summ="default" type="STRING"/>
					<colinfo id="SUBJECTCD" size="256" summ="default" type="STRING"/>
					<colinfo id="SPEC" size="256" summ="default" type="STRING"/>
					<colinfo id="NOTI" size="256" summ="default" type="STRING"/>
					<colinfo id="SUBJECTCDT" size="256" summ="default" type="STRING"/>
					<colinfo id="SUPRTCD" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond3">
				<Contents>
					<colinfo id="SUPRTCD" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNR" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ms_tmp">
				<Contents>
					<colinfo id="SJTCDGB" size="256" summ="default" type="STRING"/>
					<colinfo id="SUBJECTCD" size="256" summ="default" type="STRING"/>
					<colinfo id="SPEC" size="256" summ="default" type="STRING"/>
					<colinfo id="NOTI" size="256" summ="default" type="STRING"/>
					<colinfo id="SUBJECTCDT" size="256" summ="default" type="STRING"/>
					<colinfo id="SUPRTCD" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_purchase_tmp">
				<Contents>
					<colinfo id="NAME" size="256" summ="default" type="STRING"/>
					<colinfo id="USERTELE" size="256" summ="default" type="STRING"/>
					<colinfo id="USERMAIL" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="SUPRTCD" size="256" summ="default" type="STRING"/>
					<colinfo id="USERNUMB" size="256" summ="default" type="STRING"/>
					<colinfo id="EMPNOUSERNUMB" size="256" summ="default" type="STRING"/>
					<colinfo id="RANK" size="256" summ="default" type="STRING"/>
					<colinfo id="GNM" size="256" summ="default" type="STRING"/>
					<colinfo id="DPTNM" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<record>
						<CHK></CHK>
						<DPTNM></DPTNM>
						<EMPNOUSERNUMB></EMPNOUSERNUMB>
						<GNM></GNM>
						<LIFNR></LIFNR>
						<NAME></NAME>
						<RANK></RANK>
						<SUPRTCD></SUPRTCD>
						<USERMAIL></USERMAIL>
						<USERNUMB></USERNUMB>
						<USERTELE></USERTELE>
					</record>
				</Contents>
			</Dataset>
		</Datasets>
		<Shape BKColor="user12" Bottom="562" Height="26" Id="Shape16" Left="8" LineColor="user13" Right="608" TabOrder="44" Top="536" Type="Rectangle" Width="600"></Shape>
		<Div Height="35" Id="div_btn" Left="-1" TabOrder="2" Text="Div0" Url="WB01::CommBtnForm.xml" Width="609">
			<Contents></Contents>
		</Div>
		<Image Height="19" Id="Image0" ImageID="form_bl_title_sub" Left="14" TabOrder="0" Top="243" Width="11"></Image>
		<Shape BKColor="user12" Bottom="172" Height="132" Id="Shape20" Left="10" LineColor="user13" Right="160" TabOrder="0" Top="40" Type="Rectangle" Width="150"></Shape>
		<Grid AutoEnter="TRUE" AutoFit="TRUE" AutoFitEndLine="Hide" BindDataset="ds_gyul" BkColor2="default" BoldHead="true" Border="Flat" Bottom="172" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" FixedColSizing="TRUE" HeadBorder="Flat" HeadHeight="20" Height="108" Id="grd_gyul" InputPanel="FALSE" Left="160" LineColor="user20" LineType="ExHORZ" MinWidth="100" Right="608" RowHeight="20" Style="sty_grid" TabOrder="0" TabStop="true" Top="64" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="448">
			<contents>
				<format id="Default">
					<columns>
						<col width="40"/>
						<col width="80"/>
						<col width="80"/>
						<col width="244"/>
						<col width="0"/>
					</columns>
					<head>
						<cell align="center" col="0" display="text" font="Default,9" text="차수" TrimType="Both"/>
						<cell align="center" col="1" display="text" font="Default,9" text="직위" TrimType="Both"/>
						<cell align="center" col="2" display="text" font="Default,9" text="이름" TrimType="Both"/>
						<cell align="center" col="3" display="text" font="Default,9" text="팀" TrimType="Both"/>
						<cell align="center" col="4" display="text" font="Default,9" text="결재" TrimType="Both"/>
					</head>
					<body>
						<cell align="center" bkcolor2="user22" col="0" colid="GID" display="normal" expr="iif(CURROW+1==3,&apos;검토&apos;,CURROW+1)"/>
						<cell align="left" bkcolor2="user22" col="1" colid="RANK" display="text"/>
						<cell align="left" bkcolor2="user22" col="2" colid="GNM" display="text"/>
						<cell align="left" bkcolor2="user22" col="3" colid="DPTNM" display="text"/>
						<cell align="center" bkcolor2="user22" col="4" colid="SIGN_YN" display="text"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Button Font="굴림,9" Height="20" Id="btn_up" Left="120" OnClick="btn_up_OnClick" TabOrder="5" Text="▲" Top="95" Width="18"></Button>
		<Button Font="굴림,9" Height="20" Id="btn_down" Left="120" OnClick="btn_down_OnClick" TabOrder="5" Text="▼" Top="115" Width="18"></Button>
		<Button Font="굴림,9" Height="20" Id="btn_left" Left="120" OnClick="btn_left_OnClick" TabOrder="5" Text="◀" Top="143" Width="18"></Button>
		<Grid AreaSelect="TRUE" AutoFit="TRUE" AutoFitEndLine="Hide" BindDataset="ds_apply" BkColor2="default" BoldHead="true" Border="Flat" Bottom="304" ColSelect="TRUE" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="41" Id="grd_applyList" InputPanel="FALSE" Left="8" LineColor="user20" LineType="ExHORZ" MinWidth="100" Right="288" RowHeight="20" Style="sty_grid" TabOrder="4" TabStop="true" Top="263" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="280">
			<contents>
				<format id="Default">
					<columns>
						<col width="30"/>
						<col width="60"/>
						<col width="73"/>
						<col width="111"/>
					</columns>
					<head>
						<cell align="center" col="0" color="user21" display="text" font="굴림,9" text="지사"/>
						<cell align="center" col="1" color="user21" display="text" font="굴림,9" text="직위"/>
						<cell align="center" col="2" color="user21" display="text" font="굴림,9" text="이름"/>
						<cell align="center" col="3" color="user21" display="text" font="굴림,9" text="연락처"/>
					</head>
					<body>
						<cell align="center" bkcolor2="user22" col="0" colid="AREA_N" display="text"/>
						<cell bkcolor2="user22" col="1" colid="RANK" display="normal"/>
						<cell align="center" bkcolor2="user22" col="2" colid="GNM" display="text"/>
						<cell align="center" bkcolor2="user22" col="3" colid="USERMBPN" display="text"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="18" Id="btn_addr" ImageID="btn_icon_user" Left="121" OnClick="btn_addr_OnClick" Style="sty_btn" TabOrder="6" Top="63" Transparent="TRUE" Width="18"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="21" Id="Button0" ImageID="btn_comm_save_u" Left="18" OnClick="btn_favoritesAdd" Style="sty_btn" TabOrder="7" Top="75" Transparent="TRUE" Width="23"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="21" Id="Button1" ImageID="btn_comm_query_u" Left="17" OnClick="Button1_OnClick" Style="sty_btn" TabOrder="8" Top="135" Transparent="TRUE" Width="23"></Button>
		<Static Height="13" Id="Static0" Left="17" TabOrder="9" Text="즐겨찾기추가" Top="57" Width="75"></Static>
		<Static Height="13" Id="Static8" Left="16" TabOrder="9" Text="즐겨찾기관리" Top="118" Width="75"></Static>
		<Shape BKColor="user12" Bottom="216" Height="26" Id="Shape9" Left="9" LineColor="user13" Right="608" TabOrder="14" Top="190" Type="Rectangle" Width="599"></Shape>
		<Static Height="24" Id="Static1" Left="8" Style="sty_lb_form_basic" TabOrder="15" Text="&#32;&#32;*&#32;현장&#32;소모품&#32;대상&#32;" Top="190" VAlign="Middle" Width="124"></Static>
		<Static Height="20" Id="Static12" Left="11" Style="sty_ipt_form_read" TabOrder="16" Text="(*&#32;모두&#32;필수입력입니다.)" Top="174" Width="278"></Static>
		<Shape BKColor="user12" Bottom="241" Height="26" Id="Shape12" Left="11" LineColor="user13" Right="608" TabOrder="18" Top="215" Type="Rectangle" Width="597"></Shape>
		<Static Height="24" Id="st_birth" Left="8" Style="sty_lb_form_basic" TabOrder="17" Text="&#32;&#32;*&#32;신청일&#32;" Top="216" VAlign="Middle" Width="124"></Static>
		<Calendar BindDataset="ds_cond" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="JUMIN" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Enable="FALSE" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_apply" Left="136" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="19" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="218" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="100"></Calendar>
		<Static Color="user6" Font="굴림,9,Bold" Height="20" Id="Static2" Left="320" TabOrder="20" Text="&#32;수령자&#32;정보" Top="244" VAlign="Middle" Width="149"></Static>
		<Grid AreaSelect="TRUE" AutoFit="TRUE" AutoFitEndLine="Hide" BindDataset="ds_apply2" BkColor2="default" BoldHead="true" Border="Flat" Bottom="304" ColSelect="TRUE" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="40" Id="grd_receiptList" InputPanel="FALSE" Left="312" LineColor="user20" LineType="ExHORZ" MinWidth="100" OnCellDBLClick="grd_list_OnCellDblClick" OnHeadClick="grd_list_OnHeadClick" Right="607" RowHeight="20" Style="sty_grid" TabOrder="21" TabStop="true" Top="264" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="295">
			<contents>
				<format id="Default">
					<columns>
						<col width="30"/>
						<col width="60"/>
						<col width="91"/>
						<col width="92"/>
					</columns>
					<head>
						<cell align="center" col="0" color="user21" display="text" font="굴림,9" text="지사"/>
						<cell align="center" col="1" color="user21" display="text" font="굴림,9" text="직위"/>
						<cell align="center" col="2" color="user21" display="text" font="굴림,9" text="이름"/>
						<cell align="center" col="3" color="user21" display="text" font="굴림,9" text="연락처"/>
					</head>
					<body>
						<cell align="center" bkcolor2="user22" col="0" colid="AREA_N" display="text"/>
						<cell bkcolor2="user22" col="1" colid="RANK" display="normal"/>
						<cell align="center" bkcolor2="user22" col="2" colid="GNM" display="text"/>
						<cell align="center" bkcolor2="user22" col="3" colid="USERMBPN" display="text"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Checkbox BKColor="user12" FalseValue="0" Height="16" Id="chk_receipt" Left="418" OnClick="chk_receipt_OnClick" Style="sty_ipt_search_chk" TabOrder="22" TabStop="FALSE" Top="245" TrueValue="1" Value="FALSE" Width="15"></Checkbox>
		<Static Color="user6" Font="굴림,9,Bold" Height="20" Id="Static19" Left="27" TabOrder="23" Text="&#32;신청자&#32;정보" Top="244" VAlign="Middle" Width="149"></Static>
		<Image Height="19" Id="Image2" ImageID="form_bl_title_sub" Left="312" TabOrder="24" Top="242" Width="11"></Image>
		<Static Color="user6" Font="굴림,9,Bold" Height="20" Id="Static3" Left="27" TabOrder="26" Text="&#32;*&#32;프로젝트&#32;정보" Top="326" VAlign="Middle" Width="149"></Static>
		<Image Height="19" Id="Image3" ImageID="form_bl_title_sub" Left="14" TabOrder="25" Top="325" Width="11"></Image>
		<Grid AreaSelect="TRUE" AutoFit="TRUE" AutoFitEndLine="Hide" BindDataset="ds_prj" BkColor2="default" BoldHead="true" Border="Flat" Bottom="390" ColSelect="TRUE" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="42" Id="grd_prj" InputPanel="FALSE" Left="8" LineColor="user20" LineType="ExHORZ" MinWidth="100" OnCellDBLClick="grd_list_OnCellDblClick" OnHeadClick="grd_list_OnHeadClick" Right="288" RowHeight="20" Style="sty_grid" TabOrder="27" TabStop="true" Top="348" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="280">
			<contents>
				<format id="Default">
					<columns>
						<col width="60"/>
						<col width="60"/>
						<col width="45"/>
						<col width="45"/>
					</columns>
					<head>
						<cell align="center" col="0" color="user21" display="text" font="굴림,9" text="프로젝트"/>
						<cell align="center" col="1" color="user21" display="text" font="굴림,9" text="담당PM"/>
						<cell align="center" col="2" color="user21" display="text" font="굴림,9" text="총대수"/>
						<cell align="center" col="3" color="user21" display="text" font="굴림,9" text="총층수"/>
					</head>
					<body>
						<cell align="center" bkcolor2="user22" col="0" colid="POSID" display="text"/>
						<cell bkcolor2="user22" col="1" colid="ZMAN_NM" display="normal"/>
						<cell align="right" bkcolor2="user22" col="2" colid="ZQNTY" display="number"/>
						<cell align="right" bkcolor2="user22" col="3" colid="VALUE" display="number"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Shape BKColor="user12" Bottom="415" Height="26" Id="Shape13" Left="8" LineColor="user13" Right="288" TabOrder="29" Top="389" Type="Rectangle" Width="280"></Shape>
		<Edit BindDataset="ds_prj" Border="Flat" Column="ZSITE_NM" Enable="FALSE" Height="20" Id="ed_zsiteNm" ImeMode="native" Left="72" LeftMargin="4" MaxLength="20" RightMargin="4" Style="sty_ipt_form" TabOrder="30" Top="392" Width="213"></Edit>
		<Static Align="Center" Height="24" Id="Static5" Left="9" Style="sty_lb_form_basic" TabOrder="28" Text="현장명" Top="390" VAlign="Middle" Width="59"></Static>
		<Shape BKColor="user12" Bottom="440" Height="26" Id="Shape15" Left="8" LineColor="user13" Right="288" TabOrder="32" Top="414" Type="Rectangle" Width="280"></Shape>
		<Edit BindDataset="ds_prj" Border="Flat" Column="ADDR" Enable="FALSE" Height="20" Id="ed_addr" ImeMode="native" Left="72" LeftMargin="4" MaxLength="20" RightMargin="4" Style="sty_ipt_form" TabOrder="33" Top="417" Width="213"></Edit>
		<Static Align="Center" Height="24" Id="Static6" Left="9" Style="sty_lb_form_basic" TabOrder="31" Text="설치지역" Top="415" VAlign="Middle" Width="59"></Static>
		<Static Color="user6" Font="굴림,9,Bold" Height="20" Id="Static7" Left="320" TabOrder="35" Text="&#32;공지사항" Top="326" VAlign="Middle" Width="149"></Static>
		<Image Height="19" Id="Image4" ImageID="form_bl_title_sub" Left="312" TabOrder="34" Top="324" Width="11"></Image>
		<Button Height="18" Id="btn_prj" ImageID="btn_icon_search" Left="128" OnClick="btn_prj_OnClick" TabOrder="36" Text="Button0" Top="328" Width="18"></Button>
		<TextArea DisableBKColor="user5" Enable="FALSE" Height="112" Id="ta_notice" ImeMode="none" Left="320" TabOrder="37" Top="352" VScroll="TRUE" Width="274"></TextArea>
		<Static Color="user6" Font="굴림,9,Bold" Height="20" Id="Static9" Left="32" TabOrder="39" Text="&#32;*&#32;구매처&#32;정보" Top="451" VAlign="Middle" Width="149"></Static>
		<Image Height="19" Id="Image5" ImageID="form_bl_title_sub" Left="14" TabOrder="38" Top="450" Width="11"></Image>
		<Button Height="18" Id="btn_purchase" ImageID="btn_icon_search" Left="126" OnClick="btn_purchase_OnClick" TabOrder="40" Text="Button0" Top="454" Width="18"></Button>
		<Grid AreaSelect="TRUE" AutoFit="TRUE" AutoFitEndLine="Hide" BindDataset="ds_purchase" BkColor2="default" BoldHead="true" Border="Flat" Bottom="518" ColSelect="TRUE" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="41" Id="grd_purchase" InputPanel="FALSE" Left="8" LineColor="user20" LineType="ExHORZ" MinWidth="100" Right="608" RowHeight="20" Style="sty_grid" TabOrder="41" TabStop="true" Top="477" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="600">
			<contents>
				<format id="Default">
					<columns>
						<col width="62"/>
						<col width="68"/>
						<col width="106"/>
					</columns>
					<head>
						<cell align="center" col="0" color="user21" display="text" font="굴림,9" text="구매처명"/>
						<cell align="center" col="1" color="user21" display="text" font="굴림,9" text="전화번호"/>
						<cell align="center" col="2" color="user21" display="text" font="굴림,9" text="이메일"/>
					</head>
					<body>
						<cell align="center" bkcolor2="user22" col="0" colid="NAME" display="text"/>
						<cell bkcolor2="user22" col="1" colid="USERTELE" display="normal"/>
						<cell bkcolor2="user22" col="2" colid="USERMAIL" display="text"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Static Height="24" Id="cal_imd" Left="9" Style="sty_lb_form_basic" TabOrder="42" Text="&#32;&#32;*&#32;반입요청일" Top="537" VAlign="Middle" Width="124"></Static>
		<Calendar BindDataset="ds_insertCond" Border="Flat" CanChange="cal_importRequestDate_CanChange" ClickedBkColor="user32" ClickedTextColor="user33" Column="IMPDATE" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_importRequestDate" Left="136" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" OnDayClick="cal_importRequestDate_OnDayClick" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="43" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="536" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="100"></Calendar>
		<Shape BKColor="user12" Bottom="585" Height="26" Id="Shape6" Left="8" LineColor="user13" Right="608" TabOrder="46" Top="559" Type="Rectangle" Width="600"></Shape>
		<Static Height="24" Id="Static18" Left="9" Style="sty_lb_form_basic" TabOrder="45" Text="&#32;&#32;*&#32;신청목적" Top="560" VAlign="Middle" Width="124"></Static>
		<Edit BindDataset="ds_insertCond" Border="Flat" Column="TITLE" Height="22" Id="ed_title" ImeMode="none" Left="136" Style="sty_ipt_search" TabOrder="47" Top="561" Width="472"></Edit>
		<Shape BKColor="user12" Bottom="610" Height="26" Id="Shape8" Left="8" LineColor="user13" Right="608" TabOrder="49" Top="584" Type="Rectangle" Width="600"></Shape>
		<Static Height="24" Id="Static13" Left="9" Style="sty_lb_form_basic" TabOrder="48" Text="&#32;&#32;*&#32;수령주소" Top="585" VAlign="Middle" Width="124"></Static>
		<Edit BindDataset="ds_insertCond" Border="Flat" Column="RECADDR" Height="22" Id="ed_receiptAddr" ImeMode="none" Left="136" Style="sty_ipt_search" TabOrder="50" Top="586" Width="472"></Edit>
		<Static Color="user6" Font="굴림,9,Bold" Height="20" Id="Static15" Left="27" TabOrder="52" Text="&#32;*&#32;폼목" Top="623" VAlign="Middle" Width="149"></Static>
		<Image Height="19" Id="Image6" ImageID="form_bl_title_sub" Left="14" TabOrder="51" Top="622" Width="11"></Image>
		<Button Cursor="HAND" Height="20" Id="btn_add" ImageID="btn_icon_plus" Left="72" LeftMargin="12" OnClick="btn_add_OnClick" Style="sty_btn" TabOrder="54" Top="623" Transparent="TRUE" Width="22"></Button>
		<Button Cursor="HAND" Height="20" Id="btn_del" ImageID="btn_icon_minus" Left="104" LeftMargin="12" OnClick="btn_del_OnClick" Style="sty_btn" TabOrder="53" Top="623" Transparent="TRUE" Width="22"></Button>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="SUPRTCD" Column="GNM" DataColumn="SUPRTCDT" Height="20" Id="cb_supported" InnerDataset="ds_supported" Left="136" OnChanged="cb_supported_OnChanged" Style="sty_ipt_search" TabOrder="55" Top="192" Width="100"></Combo>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="18" Id="btn_receipt" ImageID="btn_icon_user" Left="396" OnClick="btn_receipt_OnClick" Style="sty_btn" TabOrder="56" Top="244" Transparent="TRUE" Width="18"></Button>
		<Static Height="20" Id="Static4" Left="432" Style="sty_ipt_form_read" TabOrder="57" Text="신청자&#32;정보와&#32;동일" Top="246" Width="162"></Static>
		<Grid AreaSelect="TRUE" AutoEnter="TRUE" AutoFit="TRUE" AutoFitEndLine="Hide" AutoSelect="TRUE" BindDataset="ds_subject" BkColor2="default" BoldHead="true" Border="Flat" Bottom="784" ColSelect="TRUE" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="136" Id="grd_subject" InputPanel="FALSE" Left="8" LineColor="user20" LineType="ExHORZ" MinWidth="100" Right="608" RowHeight="20" Style="sty_grid" TabOrder="58" TabStop="true" Top="648" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="600">
			<contents>
				<format id="Default">
					<columns>
						<col width="40"/>
						<col width="70"/>
						<col width="70"/>
						<col width="140"/>
						<col width="50"/>
						<col width="194"/>
					</columns>
					<head>
						<cell align="center" col="0" color="user21" display="text" font="굴림,9" text="NO"/>
						<cell col="1" color="user21" display="text" font="굴림,9" text="구분"/>
						<cell col="2" color="user21" display="text" edit="normal" font="굴림,9" text="품목"/>
						<cell col="3" color="user21" display="text" font="굴림,9" text="규격"/>
						<cell align="center" col="4" color="user21" display="text" edit="normal" font="굴림,9" text="수량"/>
						<cell col="5" color="user21" display="text" edit="normal" font="굴림,9" text="비고"/>
					</head>
					<body>
						<cell align="center" bkcolor2="user22" col="0" display="text" expr="currow+1"/>
						<cell align="center" bkcolor2="user22" col="1" colid="SJTCDGB" combocol="CODE" combodataset="ds_gubun" combotext="CODE_NAME" display="combo" edit="combo"/>
						<cell align="center" bkcolor2="user22" col="2" colid="SUBJECTCD" combocol="SUBJECTCD" combodataset="ds_m_subject" combotext="SUBJECTCDT" display="expr:iif(SJTCDGB&#32;==&#32;&apos;01&apos;,&apos;combo&apos;,&#32;&apos;normal&apos;)" edit="expr:iif(SJTCDGB&#32;==&#32;&apos;01&apos;,&apos;combo&apos;,&#32;&apos;normal&apos;)"/>
						<cell align="left" bkcolor2="user22" col="3" colid="SPEC" combocol="SPEC" combodataset="ds_ms_subject" combofilter='expr:&quot;SUBJECTCD&#32;==&#32;&apos;&quot;+&#32;ds_subject.GetColumn(currow,&#32;&quot;SUBJECTCD&quot;)&#32;+&#32;&quot;&apos;&#32;&amp;&amp;&#32;SUPRTCD&#32;==&#32;_SUPRTCD&quot;' combotext="SPEC" display="expr:iif(SJTCDGB&#32;==&#32;&apos;01&apos;,&apos;combo&apos;,&#32;&apos;normal&apos;)" edit="expr:iif(SJTCDGB&#32;==&#32;&apos;01&apos;&#32;&#32;,&apos;combo&apos;,&#32;&apos;normal&apos;)"/>
						<cell align="center" bkcolor2="user22" col="4" colid="QTY" display="text" edit="normal"/>
						<cell align="left" bkcolor2="user22" col="5" colid="NOTI" display="text" edit="normal"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Static Height="24" Id="Static10" Left="169" TabOrder="59" Text="결재순서:1차(지사장)→2차(팀장)→검토(설치관리팀|자동지정됨)" Top="44" Width="364"></Static>
	</Form>
	<Script><![CDATA[/*
 ******************************************************************************************
 * 기      능   : 
 * 작  성  자   : 
 * 작성  일자   : 
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
#include "LIB::commons.js";	// 공통 스크립트 
//=========================================================================================
// [ PART 1 ]
// Form에서 사용될 전역변수를 선언
// FORM에서 사용되는 전역변수는 대문자로 작성하며, F_XXX 의 형태를 갖도록 한다. 
//=========================================================================================
var _SUPRTCD = "";
var _orderNo = "";
var enter = "";
var stats = "";
var name1 = "";
var namee = "";
var retif = "";
var lifnr_c = "";
var perno_c = "";
var jumin = "";
var lifnr = "";
var perno = "";
var perkey = "";
var pspid  = "";
var birth  = "";
var F_SIZE = 1024 * 4096;
//=========================================================================================
// [ PART 2 ]
// Form Loading / Unloading 시 작업 정의
//=========================================================================================
function fn_OnLoadCompleted(obj) {
	// Form 로드 이벤트 맨 첫줄에 기술 
	
	
	//trace("G_USER_ID= " + G_USER_ID);
	//trace("VEND_CODE= " + G_VEND_CODE);
	
	
	gfn_initForm();

	
	lifnr_c = lifnr;
	perno_c = perno;	

	cal_apply.value = gfn_getCurrDate();
	
	ds_cond.SetColumn(0,"PERKEY",perkey);
	ds_cond.SetColumn(0,"LIFNR",lifnr);
	ds_cond.SetColumn(0,"PERNO",perno);

	//코드콤보 설정 : 사업구분,업종구분
	var codeArr = ["PS003","PS005","PS006"];
	var dsObjArr = [ds_zzactss,ds_sagbn,ds_upgbn];
	var addTypeArr = [G_CODE_NONE,G_CODE_NONE,G_CODE_NONE,G_CODE_NONE,G_CODE_NONE,G_CODE_NONE];
	gfn_searchCommCode(codeArr, dsObjArr, addTypeArr);
	ufn_initSupportCombo();
	ufn_initApplyInfo();
}
/********************************************************************************
* 기      능   : 공통코드가 조회된 후의 Callback 함수 
********************************************************************************/
function fn_completeInit(sCode, sDsObj, sCodeType) {
//ALERT("2");
	//fn_query2();
}
/********************************************************************************
* 기      능   : 지원대상 콤보박스용 조회(ZPST0401)
********************************************************************************/
function ufn_initSupportCombo() 
{
	tit_clearActionInfo();	
	tit_addSearchActionInfo("ps15:PS1501001A_S2");
	tit_callService(
        ""
        , ""
        , ""
        , "ds_supported=ds_supported"
        , ""
        , "ufn_afterInitCombo"
        , true);
}

function ufn_afterInitCombo(errCode, errMsg) {
	ds_supported.insertRow(0);
	ds_supported.setColumn(0, "SUPRTCDT", "- 선택 -");
	cb_supported.value = "";
	cb_supported.Index = 0;
}

/********************************************************************************
* 기      능   : 현장 소모품 대상 변경시 공지사항 변경
********************************************************************************/
function cb_supported_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
    //현장 소모품대상에 따른 공지사항 입력
	ta_notice.text = ds_supported.getColumn(nNewIndex, "NOTICE"); 
	
	//공급업체코드
	_SUPRTCD = strCode;
	
	
	//현장 소모품대상에 따른 구매처가 정보 입력 
	ds_purchase.ClearData();
	ds_cond3.AddRow();
	ds_cond3.SetColumn(0,"SUPRTCD",strCode);
	tit_clearActionInfo();
	tit_addSearchActionInfo("ps15:PS1501002B_S4");
	tit_callService(
        ""
        , ""
        , "ds_cond3=ds_cond3"
        , "ds_purchase=ds_purchase"
        , ""
        , "ufn_afterSelectPurchaseOfficeInfo" 
        , false
        , true);
	
    //현장 소모품대상에 따른 폼목 마스터 정보
    ds_subject.ClearData();
    
    ds_cond2.setColumn(0, "SUPRTCD", strCode);
    tit_clearActionInfo();
	tit_addSearchActionInfo("ps15:PS1501002B_S6");
	tit_callService(
        ""
		,""
		, ""
		, "ds_m_subject=ds_m_subject"
		, "SUPRTCD="+ strCode
		, "ufn_afterSelectSubjectInfo"
		, true);
		
	//현장 소모품대상에 따른 스펙 마스터 정보
	tit_clearActionInfo();
	tit_addSearchActionInfo("ps15:PS1501002B_S9");
	tit_callService(
		""
		,""
		, ""
		, "ds_ms_subject=ds_ms_subject"
		, ""
		, ""
		, true);	
	
}

/********************************************************************************
* 기      능   : 구매처 정보 가져왔을때 1건이면 최종승인자 자동입력력
********************************************************************************/
function ufn_afterSelectPurchaseOfficeInfo()
{
	//현장 소모품대상 변경 시 3차결재자와 구매처 세팅 기능 수정 - 2019.03.10 강민석K
	/*
	if(ds_purchase.GetRowCount() == 1)
	{ 
    	//구매처정보에 따른 최종승인자 입력
    	ufn_inputFinalapproval();
    	
	}else{
	
	  ds_purchase.ClearData();
	  if( ds_gyul.findRow("GUBUN", "3") == -1 )
	  {
		
	  }else{
		trace("else");
		ds_gyul.SetColumn(ds_gyul.findRow("GUBUN", "3"),"RANK",ds_purchase.GetColumn(0, ""));
		ds_gyul.SetColumn(ds_gyul.findRow("GUBUN", "3"),"GNM",ds_purchase.GetColumn(0, ""));
		ds_gyul.SetColumn(ds_gyul.findRow("GUBUN", "3"),"DPTNM",ds_purchase.GetColumn(0, ""));
		ds_gyul.SetColumn(ds_gyul.findRow("GUBUN", "3"),"GID",ds_purchase.GetColumn(0, ""));
	  }
	}
	*/
	//구매처 정보 자동세팅
	ds_purchase_tmp.Copy(ds_purchase);
	fn_setPurchaseAuto();
	
	if(ds_purchase.GetRowCount() >= 1)
	{ 
    	//구매처정보에 따른 최종승인자 입력
    	ufn_inputFinalapproval(ds_purchase.GetRowCount());
	}else{
		if( ds_gyul.findRow("GUBUN", "3") != -1 ){
			var index = ds_gyul.findRow("GUBUN", "3");
			ds_gyul.DeleteRow(index);
		}
		gfn_openMsgWin(cb_supported.Text + "는\n검토자가 등록되어 있지 않습니다.\n설치관리팀에 문의하세요.", "W", "", "");
	}
}
/********************************************************************************
* 기      능   : 구매처 정보 정보 변경시 최종승인자 자동입
********************************************************************************/
function ds_purchase_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{
	ufn_afterSelectPurchaseOfficeInfo();
}

/********************************************************************************
* 기      능   : 구매처정보변경에 따른 최종승인자 입력
********************************************************************************/
//구매처 선택 화면에서 호출하는 경우와 본화면에서 호출하는 경우 ds_purchase clear 조건을 처리하기 위해 parameter 추가 - 2019.03.10 강민석K
//function ufn_inputFinalapproval()
function ufn_inputFinalapproval(rowCount)
{
	var i = "";
    	
	if( ds_gyul.findRow("GUBUN", "3") == -1 ) 
	{
		i = ds_gyul.AddRow();
	}else{
		i = ds_gyul.findRow("GUBUN", "3");
	}
	
	ds_gyul.SetColumn(i,"GID",ds_purchase.GetColumn(0, "EMPNOUSERNUMB"));	
	ds_gyul.SetColumn(i,"RANK",ds_purchase.GetColumn(0, "RANK"));
	ds_gyul.SetColumn(i,"GNM",ds_purchase.GetColumn(0, "GNM"));
	ds_gyul.SetColumn(i,"DPTNM",ds_purchase.GetColumn(0, "DPTNM"));
	ds_gyul.SetColumn(i,"GUBUN","3"); //최종승인자
	
	//ufn_afterSelectPurchaseOfficeInfo에서 현 위치로 이동 - 2019.03.10 강민석K
	//사유 : 현장 소모품대상에 맵핑된 데이터가 2건 이상이더라도 3차결재자는 동일한 사람이고, 구매처는 다를 수 있음.
	if(rowCount > 1){
		ds_purchase.ClearData();
	}
}

function ufn_afterSelectSubjectInfo()
{
	//::TODO 지원대상에 따른 품목에 한건일때
	if(ds_m_subject.count == 1)
	{
	  //trace("ds_m_subject.count = 1 ");
	}
}


/********************************************************************************
* 기      능   : 신청자 정보 Grid Automapping
********************************************************************************/
function ufn_initApplyInfo() 
{
	tit_clearActionInfo();	
	tit_addSearchActionInfo("ps15:PS1501002B_S2");
	tit_callService(
        ""
        , ""
        , ""
        , "ds_apply=ds_apply"
        , ""
        , ""
        , true);
}
/********************************************************************************
* 기      능   : 수령자 정보 체크박스
********************************************************************************/
function chk_receipt_OnClick(obj,strValue)
{
	if(chk_receipt == '0') {
	  ds_apply2.ClearData();
	}else{
	  gfn_copyDs(ds_apply,ds_apply2); 
	  
	  //trace(ds_apply.GetRowCount());
	  //trace(ds_apply2.GetRowCount());
	}
	
}
/********************************************************************************
* 기      능   : 즐겨찾기 결재자관리 
********************************************************************************/
function btn_addr_OnClick(obj)
{
	//ds_gyul.ClearData();
	var arg = "lifnr_c=" + quote( lifnr_c);
	arg+= " perno_c=" + quote( perno_c);
	
	var arr = gfn_openPopupUrl("PS15::PS1501001F.xml", true, arg);
	
}
/********************************************************************************
* 기      능   : 수령자에서 사용자 검색 
********************************************************************************/
function btn_receipt_OnClick(obj)
{
    ds_apply2.ClearData();
    chk_receipt = '0';
	var arg = "lifnr_c=" + quote( lifnr_c);
	arg+= " perno_c=" + quote( perno_c);
	
	var arr = gfn_openPopupUrl("PS15::PS1501001D.xml", true, arg);
}

/********************************************************************************
* 기      능   : 프로젝트정보 검색 
********************************************************************************/
function btn_prj_OnClick(obj)
{
    var arg = "";
	var arr = gfn_openPopupUrl("PS15::PS1501001E.xml", true, arg);
	//구매처 정보 자동세팅
	fn_setPurchaseAuto();

}

/********************************************************************************
* 기      능   : 구매처 정보 자동 세팅 (프로젝트 번호가 있고, 안전차폐판일 경우)
********************************************************************************/
function fn_setPurchaseAuto()
{
	// 안전차폐판 : S00004이고, 프로젝트 번호가 
	// 1. 홀수 : 상하실업
	// 2. 짝수 : 이진상사
	var sProj = Substr(ds_prj.GetColumn(0, "POSID"),5,1);
	var nRow = 0;
	var nRemain = toNumber(sProj) % 2;
	
	// 안전차폐판
	if(cb_supported.Value == 'S00004' && Length(sProj) > 0)
	{
		
		
		if(nRemain == 0)	// 프로젝트 번호 : 짝수 - 이진상사
		{
			nRow = ds_purchase_tmp.SearchRow("LIFNR == '1191381097'");
			if(nRow >= 0)
			{
				ds_purchase.ClearData();
				ds_purchase.addRow();
				ds_purchase.CopyRow(0, ds_purchase_tmp, nRow);
			}
		}
		else	// 프로젝트 번호 : 홀수 - 상하실업
		{
			nRow = ds_purchase_tmp.SearchRow("LIFNR == '1171172642'");
			if(nRow >= 0)
			{
				ds_purchase.ClearData();
				ds_purchase.addRow();
				ds_purchase.CopyRow(0, ds_purchase_tmp, nRow);
			}
		}
	}
}
/********************************************************************************
* 기      능   : 구매처 정보 검색 
********************************************************************************/
function btn_purchase_OnClick(obj)
{	
	if ( gfn_isNull(cb_supported, true) ) 
	{
		gfn_showAlert("CW00116", "현장 소모품 대상을 먼저");
		return;
	}
	
	// if (ds_purchase.GetRowCount() == 1) 
	// {
		// gfn_showAlert("구매처 정보가 1건입니다.");
		// return;
	// }
	
	ds_purchase.ClearData();
	
	var arg = "SUPRTCD=" + quote( _SUPRTCD);
	    arg += " GUBUN="  + quote("");
	var arr = gfn_openPopupUrl("PS15::PS1501001H.xml", true, arg);
}
/********************************************************************************
* 기      능   : 품목 그리드 추가 삭제
********************************************************************************/
function btn_add_OnClick(obj)
{
	ds_m_subject.UnFilter();
	
	

	if ( gfn_isNull(cb_supported, true) ) 
	{
		gfn_showAlert("CW00116", "현장 소모품 대상을 먼저");
		return;
	}
	
	var i = ds_subject.AddRow();
	ds_subject.SetColumn(i, "SJTCDGB", "01");
}

function btn_del_OnClick(obj)
{
	ds_subject.deleteRow(ds_subject.row);
}

/********************************************************************************
* 기      능   : 품목 그리드 변경 시
********************************************************************************/
var _ds_subjectRow = null;

function ds_subject_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{
	if(strColumnID == "SJTCDGB") //구분이 클릭되었을때 
	{
		if(ds_subject.GetColumn(nRow, "SJTCDGB") == '02') //직접입력으로 변경되었을때 row 초기화
		{
			ds_subject.SetColumn(nRow, "SUBJECTCD", "");
			ds_subject.SetColumn(nRow, "SUBJECTCDT", "");
			ds_subject.SetColumn(nRow, "SPEC", "");
			ds_subject.SetColumn(nRow, "QTY", "");
			ds_subject.SetColumn(nRow, "NOTI", "");
		}
	}
	
	//폼목
	if(strColumnID == "SUBJECTCD")
	{
		ds_subject.SetColumn(nRow, "SPEC", "");
		ds_subject.SetColumn(nRow, "QTY", "");
		
		//선택한 품목의 규격이 1개인 경우 규격이 자동으로 선택되도록 수정 - 2019.03.28 송광용D
		ds_ms_tmp.Copy(ds_ms_subject);
		ds_ms_tmp.Filter("SUBJECTCD == '"+ ds_subject.GetColumn(nRow, "SUBJECTCD") + "' && SUPRTCD == '"+_SUPRTCD+"'");
		if(ds_ms_tmp.GetRowCount() == 1)
		{
			ds_subject.SetColumn(nRow, "SPEC", ds_ms_tmp.GetColumn(0, "SPEC"));
		}
		
	}
	
	if(strColumnID == "SPEC") // 규격이 클릭 되었을때 
	{
		
		if(ds_subject.GetColumn(nRow, "SJTCDGB") == '01')
		{
			if(ds_subject.GetColumn(nRow, "SUBJECTCD") != null && ds_subject.GetColumn(nRow, "SPEC") != null) //스펙이 정해졌을
			{
				ds_subject.SetColumn(nRow, "NOTI", ds_ms_subject.GetColumn(0, "NOTI"));
				//trace("NOti==" + ds_ms_subject.GetColumn(0, "NOTI"));
			}
		}
	}

}


function ufn_afterSelectSpec()
{
	if(ds_subject.GetColumn(_ds_subjectRow, "SPEC") != null)
	{
		ds_sub_subject.Filter("SPEC == " + quote(ds_subject.GetColumn(_ds_subjectRow, "SPEC")));
		ds_subject.SetColumn(_ds_subjectRow, "NOTI", ds_sub_subject.GetColumn(0 , "NOTI"));
	}	
}
/********************************************************************************
* 기      능   : 조회(결재자)
********************************************************************************/
function fn_query() {
	ds_cond.SetColumn(0,"GNM",ed_gnm.Text);
	ds_cond.SetColumn(0,"DPTNM",ed_dptnm.Text);

	tit_clearActionInfo();
	tit_addSearchActionInfo("ps13:PS1301007B_S1");
	tit_callService(
        ""
        , ""
        , "ds_cond=ds_cond"
        , "ds_swn=ds_list"
        , ""
        , "fn_afterQuery"
        , true);
}

/********************************************************************************
* 기      능   : 조회 Callback  
********************************************************************************/
function fn_afterQuery(errCode, errMsg) {
	gfn_showMsg("CI00002",ds_swn.RowCount()+"");
}

/********************************************************************************
* 기      능   : 저장
********************************************************************************/

function fn_save() {
	// 1. ZPSTW0411 발주번 키값 생상
	
	tit_clearActionInfo();
	tit_addSearchActionInfo("ps15:PS1501002B_S7");
	tit_callService(
        ""
        , ""
        , ""
        , "ds_seqno=ds_seqno"
        , ""
        , "ufn_afterCreateOrderNo"
        , true);
}

function ufn_afterCreateOrderNo()
{
	
	////1.결재자 지정 확인
	if (ds_gyul.rowcount() != 3)
	{
		//알림메시지 수정(김민규S 요구사항) - 2019.03.10 강민석K
		//gfn_showAlert("결재자 3명을 선택하십시오. 최종결재자는 구매처 정보 입력시 입력됩니다.");
		//gfn_showAlert("결재자 2명을 선택하십시오.\n최종결재자는 현장 소모품대상 선택 시 자동으로 입력됩니다.");
		//gfn_openMsgWin("결재자 2명을 선택하십시오.\n최종결재자는 현장 소모품 대상 선택 시 자동으로 입력됩니다.", "W", "", "");
		gfn_openMsgWin("결재자(지사장, 팀장)를 선택하십시오.\n최종결재자는 현장 소모품 대상 선택 시 입력됩니다.", "W", "", "");
		return false;
	}
	////2.수령자 정보 확인
	if (ds_apply2.rowcount() != 1)
	{
		//알림메시지 수정 - 2019.03.20 강민석K
		//gfn_showAlert("CW00116", "수령자 정보를 먼저");
		gfn_openMsgWin("수령자 정보를 먼저 선택하십시오.", "I", "", "");
		return false;
	}
	
	////3.프로젝트 정보 확인
	if (ds_prj.rowcount() != 1)
	{
		//알림메시지 수정 - 2019.03.20 강민석K
		//gfn_showAlert("CW00116", "프로젝트 정보를 먼저");
		gfn_openMsgWin("프로젝트 정보를 먼저 선택하십시오.", "I", "", "");
		return false;
	}
	////4.구매자 정보 확인
	if (ds_purchase.rowcount() != 1)
	{
		//알림메시지 수정 - 2019.03.10 강민석K
		//gfn_showAlert("CW00116", "구매자 정보를 먼저");
		//알림메시지 수정 - 2019.03.20 강민석K
		//gfn_showAlert("CW00116", "구매처 정보를 먼저");
		gfn_openMsgWin("구매처 정보를 먼저 선택하십시오.", "I", "", "");
		return false;
	}
	
	////5.반입요청일 확인
	if (cal_importRequestDate.Value < gfn_getCurrDate() )
	{
		gfn_showAlert("CW00007","반입요청일","현재일자");
		return false;
	}
	
	////6.신청목적 확인
	if ( gfn_isNull(ed_title, true) ) 
	{
		//알림메시지 수정 - 2019.03.20 강민석K
		//gfn_showAlert("CW00116", "신청목적");
		gfn_openMsgWin("신청목적을 먼저 선택하십시오.", "I", "", "");
		return false;
	}
	
	////6.수령주소 확인
	if ( gfn_isNull(ed_receiptAddr, true) ) 
	{
		//알림메시지 수정 - 2019.03.20 강민석K
		//gfn_showAlert("CW00116", "수령주소");
		gfn_openMsgWin("수령주소를 먼저 선택하십시오.", "I", "", "");
		return false;
	}
	
	//7. 품목입력
	if( ds_subject.rowcount == 0 )
	{
		//알림메시지 수정 - 2019.03.10 강민석K
		//gfn_showAlert("1건 이상 품목을 입력하셔야 합니다.");
		gfn_openMsgWin("1건 이상 품목을 입력하셔야 합니다.", "W", "", "");
		return false;
	}
	
	
	////9.수량을 입력하였는지
	for(var i=0; i < ds_subject.rowcount; i++)
	{
		if(ds_subject.GetColumn(i, "SUBJECTCD") == null || length(ds_subject.GetColumn(i ,"SUBJECTCD")) == 0)
		{
			gfn_openMsgWin("품목 항목 중 입력하지 않는 품목이 있습니다. 확인바랍니다.", "W", "", "");
			return false;
		}
		
		//품목구분이 직접입력인 경우 규격을 입력하지 않아도 되도록 수정 - 2019.03.25 강민석K (고범석K 요구사항)
		//if( ds_subject.GetColumn(i, "SJTCDGB") == "01" && (ds_subject.GetColumn(i, "SPEC") == null || length(ds_subject.GetColumn(i ,"SPEC")) == 0) )
		if( ds_subject.GetColumn(i, "SJTCDGB") == "01" && (ds_subject.GetColumn(i, "SPEC") == null || length(ds_subject.GetColumn(i ,"SPEC")) == 0) )
		{
			//알림창 내용도 수정 - 2019.03.25 강민석K
			//gfn_openMsgWin("품목 항목 중 입력하지 않는 규격이 있습니다. 확인바랍니다.", "W", "", "");
			gfn_openMsgWin("품목구분이 표준인 항목 중 입력하지 않는 규격이 있습니다. 확인바랍니다.", "W", "", "");
			return false;
		}
		 
		if(ds_subject.GetColumn(i, "QTY") == null || length(ds_subject.GetColumn(i ,"QTY")) == 0 )
		{
			gfn_openMsgWin("품목 항목 중 입력하지 않는 수량이 있습니다. 확인바랍니다.", "W", "", "");
			return false;
		}
	}
	
	//인설트 ZPSTW0411(지원신청), ZPSTW0412(구매품목)
	_orderNo = ds_seqno.GetColumn(0,"ORDERNO");
	//trace(_orderNo);
	
	ds_insertCond.SetColumn(0, "ORDERNO"	, _orderNo);
	ds_insertCond.SetColumn(0, "PSPID"		, ds_prj.GetColumn(0,"POSID"));
	//수령주소 등록해야됨. ed_receiptAddr.Value
	
	ds_insertCond.SetColumn(0, "RELIFNR"	, G_VEND_CODE_R);
	ds_insertCond.SetColumn(0, "EMPNO"		, G_USER_ID);
	ds_insertCond.SetColumn(0, "SUPRTCD"	, cb_supported.Value);
	ds_insertCond.SetColumn(0, "LIFNR"		, ds_purchase.GetColumn(0,"LIFNR"));
	ds_insertCond.SetColumn(0, "LIFNREMPNO"	, ds_purchase.GetColumn(0,"USERNUMB"));
	ds_insertCond.SetColumn(0, "STATE"		, "A0"); //신청
	ds_insertCond.SetColumn(0, "PCPNUM1"	, ds_gyul.GetColumn(0,"GID"));
	ds_insertCond.SetColumn(0, "PCPNUM2"	, ds_gyul.GetColumn(1,"GID"));
	ds_insertCond.SetColumn(0, "PCPNUM3"	, ds_gyul.GetColumn(2,"GID"));	
	ds_insertCond.SetColumn(0, "RECPART"	, ds_apply2.GetColumn(0,"AREA_N"));
	ds_insertCond.SetColumn(0, "RECRANK"	, ds_apply2.GetColumn(0,"RANK"));
	ds_insertCond.SetColumn(0, "RECNAME"	, ds_apply2.GetColumn(0,"GNM"));
	ds_insertCond.SetColumn(0, "RECTEL"		, ds_apply2.GetColumn(0,"USERMBPN"));
	ds_insertCond.SetColumn(0, "IMPDATE"	, cal_importRequestDate.Value);
	
	//Trace(ds_purchase.saveXML());
	//Trace(ds_insertCond.GetColumn(0, "LIFNR"));
	//return;
	//trace("conut==" + ds_subject.rowcount());

	for(var i=0; i < ds_subject.rowcount; i++)
	{
		ds_subject.SetColumn(i,"ORDERNO",_orderNo);
	}	

	//trace("신청할 현장소모품 대상 : " + cb_supported.Text);
	//확인창 메시지 내용 수정 - 2019.03.30 강민석K
	//if(!gfn_showConfirm( "CI00014", "현장 소모품 신청" )) return;
	if(!gfn_showConfirm( "CI00014", cb_supported.Text + " 신청" )) return;
	
	tit_clearActionInfo();
	tit_addMultiActionInfo("ps15:PS1501002C_I1");
	tit_addMultiActionInfo("ps15:PS1501002C_I2");
	tit_callService(
			""
			, ""
			, "ds_insertCond=ds_insertCond ds_subject=ds_subject"
			, ""
			, ""
			, "fn_afterSave"
			, ""
			, ""
			, true);

}
/********************************************************************************
* 기      능   : 저장 Callback  
********************************************************************************/
function fn_afterSave(errCode, errMsg) {
	if ( errCode != 0 ) {
		gfn_showMsg("CE00001");
	} else {
		gfn_showAlert("CI00003");
		// 신청 후 메일 발송 
		fn_afterSave2();
	}
}
/********************************************************************************
* 기      능   : 신청 후 1차 결재자에게 메일 발송
********************************************************************************/
function fn_afterSave2()
{
	ds_cond.ClearData();
	ds_cond.AddRow();
	ds_cond.SetColumn(0, "ORDERNO",  _orderNo);
	tit_clearActionInfo();
	tit_addSearchActionInfo("ps15:PS1501001A_S1");
	tit_callService(
        ""
        , ""
        , "ds_cond=ds_cond"
        , "ds_list=ds_list"
        , ""
        , "fn_afterSave3"
        , true);
}

/********************************************************************************
* 기      능   : 메일 발송
********************************************************************************/
function fn_afterSave3()
{
	//------------------------------------------------------------------------------
	//메일발송 데이터를 ds_list 에서 ds_insertCond, ds_prj, ds_subject 로 수정 - 2019.03.30 강민석K
	//ds_list는 부모화면의 리스트 데이터였음.
	/*
	var send_user = ds_list.GetColumn(0, "EMP_MAIL"); //보내는사람
	var rece_user = ds_list.GetColumn(0, "PCPNUM1_MAIL"); //받는사람
	var mesgtitl  = ""; //제목
	var mesgbody  = ""; //내용
	
	var pop_meg = "";
	
	mesgtitl += '현장 소모품 (' + ds_list.GetColumn(0, "SUPRTCDT")  + ') 결재요청 (' + ds_list.GetColumn(0, "PSPID") +' - ' + substr(ds_list.GetColumn(0, "ZSITE_NM"),0,7) + ")";
	
	mesgbody = ds_list.GetColumn(0, "EMP_AREA_N") + ' ' + ds_list.GetColumn(0, "EMPNM") +' 님이 SRM을 통해 발송한 메일입니다. ' + '\n\n'; 
	
    mesgbody =  mesgbody +'프로젝트번호: ' + ds_list.GetColumn(0, "PSPID") + '\n';
    mesgbody = mesgbody + '프로젝트명: ' + ds_list.GetColumn(0, "ZSITE_NM") + '\n\n';
    
    mesgbody = mesgbody + '본 현장'  + ds_list.GetColumn(0, "SUPRTCDT")  + '를 신청하오니 결재 바랍니다.\n';
    mesgbody = mesgbody + '(결재 화면: SRM-현장관리-현장소모품 결재화면)\n\n';
    mesgbody = mesgbody + '감사합니다.\n';
    */
    //trace("EMP_MAIL :: "+ds_list.GetColumn(0, "EMP_MAIL")+" PCPNUM1_MAIL :: "+ds_list.GetColumn(0, "PCPNUM1_MAIL"));
    
	//var send_user = "helco" + ds_insertCond.GetColumn(0, "EMPNO") + "@hdel.co.kr";//보내는사람
	//var rece_user = "helco" + ds_insertCond.GetColumn(0, "PCPNUM1") + "@hdel.co.kr"; //받는사람
	
	var send_user = ds_list.GetColumn(0, "EMP_MAIL");		//보내는사람
	var rece_user = ds_list.GetColumn(0, "PCPNUM1_MAIL"); 	//받는사람
	var mesgtitl  = ""; //제목
	var mesgbody  = ""; //내용
	
	var pop_meg = "";
	
	var suprtcd_index = ds_supported.FindRow("SUPRTCD", ds_insertCond.GetColumn(0, "SUPRTCD"));
	//trace("품목코드 : " + ds_insertCond.GetColumn(0, "SUPRTCD"));
	//trace("품목index : " + suprtcd_index);
	//trace("품목명 : " + ds_supported.GetColumn(suprtcd_index, "SUPRTCDT"));
	
	mesgtitl += '현장소모품 (' + ds_supported.GetColumn(suprtcd_index, "SUPRTCDT")  + ') 결재요청 (' + ds_prj.GetColumn(0, "POSID") +' - ' + substr(ds_prj.GetColumn(0, "ZSITE_NM"),0,7) + ")";
	
	mesgbody = ds_apply.GetColumn(0, "DPTNM") + ' ' + ds_apply.GetColumn(0, "GNM") +' 님이 SRM을 통해 발송한 메일입니다. ' + '\n\n'; 
	
    mesgbody = mesgbody +'프로젝트번호: ' + ds_prj.GetColumn(0, "POSID") + '\n';
    mesgbody = mesgbody + '프로젝트명: ' + ds_prj.GetColumn(0, "ZSITE_NM") + '\n\n';
    
    mesgbody = mesgbody + '본 현장 '  + ds_supported.GetColumn(suprtcd_index, "SUPRTCDT")  + '를 신청하오니 결재 바랍니다.\n';
    mesgbody = mesgbody + '(결재 화면: SRM-현장관리-현장소모품 결재화면)\n\n';
    mesgbody = mesgbody + '감사합니다.\n';
    //------------------------------------------------------------------------------
    
    //trace("send_user = " + send_user);
    //trace("rece_user = " + rece_user);
    //trace("mesgtitl = " + mesgtitl);
    //trace("mesgbody = " + mesgbody);
    
    if(rece_user != "")
    {
		//메일발송 함수 변경(sendmail -> sendmailNew) - 2019.03.31 강민석K
		/*
		tit_callService(
			"COMM_ACT"
			, "sendmail"
			, ""
			, ""
			," SEND_USER=" + quote( send_user )
				+ " RECE_USER=" + quote( rece_user )
				+ " MESGTITL="  + quote( mesgtitl )
				+ " MESGBODY="  + quote( mesgbody )
			, ""  //"fn_afterQuery"
			, false
			, true);
		*/
		
		var send_user_nm = ds_apply.GetColumn(0, "GNM");//발신자 이름
		var recv_user_nm = ds_gyul.GetColumn(0, "GNM");//수신자 이름
		
		//trace("send_user_nm :: "+send_user_nm);
		//trace("recv_user_nm :: "+recv_user_nm);
	
		tit_callService(
			"COMM_ACT"
			, "sendmailNew"
			, ""
			, ""
			," SEND_USER=" + quote( send_user )
				+ " RECV_USER=" + quote( rece_user )
				+ " SEND_USER_NM=" + quote( send_user_nm )
				+ " RECV_USER_NM=" + quote( recv_user_nm )
				+ " MESGTITL="  + quote( mesgtitl )
				+ " MESGBODY="  + quote( mesgbody )
			, ""
			, false
			, true);
     
		pop_meg = '메일이 발송 되었습니다.';	
    }
    	
	//gfn_showInform("CW10025", pop_meg);	
	fn_close();
}


/********************************************************************************
* 기      능   : form UnloadCompleted 
********************************************************************************/
function fn_OnUnloadCompleted(obj) {
	return gfn_isFormUnload(obj);
}
//=========================================================================================
// [ PART 3 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,form닫기)
//=========================================================================================

/********************************************************************************
* 기      능   : 닫기  
********************************************************************************/
function fn_close() {
	parent.fn_Query();
	close();
}

/********************************************************************************
* 기      능   : 첨부가능 파일 확장자 정의
********************************************************************************/
function ufn_isImage(fileNm) {
	var s = toUpperCase(right( fileNm, 4));
	if ( s == ".JPG" || s == ".GIF" || s == ".BMP") {
		return true;
	} else if ( toUpperCase(right( fileNm, 5)) == ".JPEG") {
		return true;
	}
	
	return false;
}
/********************************************************************************
* 기      능   : 결재자 삭제
********************************************************************************/
function btn_left_OnClick(obj)
{
	//trace("rowcount" + ds_gyul.rowcount());
	
	
	if(ds_gyul.GetColumn(ds_gyul.row, "GUBUN") == "3")
	{
		gfn_showAlert("최종승인자는 구매처정보에서 따라서 변경이 가능합니다.");
		return;
	}
	
	ds_gyul.DeleteRow(ds_gyul.row);
}
/********************************************************************************
* 기      능   : 엔터키 - 조회
********************************************************************************/
function ed_gnm_OnKeyDown(obj,nChar,bShift,bCtrl, bAlt,LLParam,HLParam)
{
	if(nChar == '13') fn_query();
}
/********************************************************************************
* 기      능   : 결재자순서 위로이동
********************************************************************************/
function btn_up_OnClick(obj)
{
	if(ds_gyul.row == 2){
		var arr = ["컴토자","순서를"];
		gfn_showAlert("CW10083", arr);
		return;
	}
	var prow = ds_gyul.GetPrevRow();
	ds_gyul.MoveRow(ds_gyul.row,prow);
	ds_gyul.row = prow;
}
/********************************************************************************
* 기      능   : 결재자순서 아래로이동
********************************************************************************/
function btn_down_OnClick(obj)
{
	if(ds_gyul.row == 1){
		var arr = ["2차결재자","순서를 최종결재자로"];
		gfn_showAlert("CW10083", arr);
		return;
	}
	if(ds_gyul.row == 2){
		var arr = ["컴토자","순서를"];
		gfn_showAlert("CW10083", arr);
		return;
	}
	var prow = ds_gyul.GetNextRow();
	ds_gyul.MoveRow(ds_gyul.row,prow);
	ds_gyul.row = prow;
}
/********************************************************************************
* 기      능   : 방향키 클릭시 
********************************************************************************/
function PS1301007B_OnKeyDown(obj,objSenderObj,nChar,bShift,bControl,bAlt,nLLParam,nHLParam)
{
	ufn_3rowReturn();
	if(stats == 'C') return;
	
	if(nChar == '37') btn_left_OnClick();
	if(nChar == '38') btn_up_OnClick();
	if(nChar == '39') btn_right_OnClick();
	if(nChar == '40') btn_down_OnClick();
}
/********************************************************************************
* 기      능   : 사용자 아이디 설정
********************************************************************************/
function ufn_setUserId(arr){
	var str = ed_recvName.value;
	var tmp = null;
	if( arr != null ) {
		for( var i = 0; i < arr.length; i++ ) {
			tmp = arr[i];
			if( indexOf(str, tmp[0] ) != -1 ) {
				continue;
			}
			if( length(str) > 0 ) {
				str += ";";
			}
			str += tmp[0];

			if(SubStr(G_USER_ID,0,5) == "ADMIN" && indexOf(tmp[0], "Z") == 0)  // 그룹별 쪽지 보내기 추가  2009.07.16
			{
				ufn_SetGroupUser(tmp[0]);
			}
		}
		ed_recvName.value = str;
	}
}
function combobox_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	switch(obj) {
	case cb_rsn1:
		cb_rsn2.Value = '';
		cb_rsn3.Value = '';
		ds_rsn2.Filter("DTEXT1="+quote(ds_rsn1.GetColumn(nNewIndex,"GROUP_CODE")));
		ds_rsn2.Filter("DTEXT2="+quote(ds_rsn1.GetColumn(nNewIndex,"CODE")));
		ds_rsn3.Filter("DTEXT1="+quote(ds_rsn1.GetColumn(nNewIndex,"GROUP_CODE")));
		ds_rsn3.Filter("DTEXT2="+quote(ds_rsn1.GetColumn(nNewIndex,"CODE")));
		break;

	default:
		break;
	}
}

/********************************************************************************
* 기      능   : 결재가 즐겨찾기 등록
********************************************************************************/
function btn_favoritesAdd(obj)
{
	
	if(!gfn_isChangeDs(ds_gyul, false))
	{
	    // CW00005=변경된 정보가 없습니다.
		gfn_showAlert("CW00005"); 
		return;
	}
	
	gfn_initDs(ds_gyul2, true);
	for(var i=0; i<ds_gyul.RowCount(); i++)
	{
		if( i == 0 )
		{
			ds_gyul2.setColumn(0, "PCPNUM1", ds_gyul.getcolumn(i,"GID") );
		}
		else if( i == 1)
		{
			ds_gyul2.setColumn(0, "PCPNUM2", ds_gyul.getcolumn(i,"GID") );
		}
		else if(i == 2)
		{
			ds_gyul2.setColumn(0, "PCPNUM3", ds_gyul.getcolumn(i,"GID") );
		}
	}
	

	
	tit_clearActionInfo();
	tit_addMultiActionInfo("ps15:PS1501002B_I1");
	tit_callService(
		""
		, ""
		, "ds_gyul2=ds_gyul2"
		, ""
		, ""
		, "ufn_favoritesAdd"
		, ""
		, ""
		, true);		
	
}


function ufn_favoritesAdd(errCode, errMsg) 
{
	if ( errCode != 0 ) 
	{
		gfn_showAlert("CE00001");
	} 
	else 
	{
		gfn_showAlert("CI00003");
	}
}	


/********************************************************************************
* 기      능   : 즐겨찾기 검색 
********************************************************************************/
function Button1_OnClick(obj)
{

	var arg = "lifnr_c=" + quote( lifnr_c);
	arg+= " perno_c=" + quote( perno_c);
	
	var arr = gfn_openPopupUrl("PS15::PS1501001C.xml", true, arg);
	//ufn_setUserId(arr);	
}

/********************************************************************************
* 기      능   : 달력제어
********************************************************************************/

function cal_importRequestDate_OnDayClick(obj,strText)
{
	gfn_clearMsgBar();
	if(strText < gfn_getCurrDate())
	{
		return;
	}
}

function cal_importRequestDate_CanChange(obj,strOldText,strText)
{
	if(strText != '00000000' && strText < gfn_getCurrDate())
	{
		 return false;
	}
}
]]></Script>
</Window>