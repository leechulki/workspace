<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="632" Id="CS4203001A" Left="8" OnLoadCompleted="fn_OnLoadCompleted" OnUnloadCompleted="fn_OnUnloadCompleted" PidAttrib="7" Title="장기미수공문&#32;전자우편&#32;접수" Top="8" Ver="1.0" Width="520" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_cond2">
				<Contents>
					<colinfo id="UPN" size="256" summ="default" type="STRING"/>
					<colinfo id="VKGRP" size="256" summ="default" type="STRING"/>
					<colinfo id="KUNNR" size="256" summ="default" type="STRING"/>
					<colinfo id="PS_PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="STR" size="256" summ="default" type="STRING"/>
					<colinfo id="DNO" size="256" summ="default" type="STRING"/>
					<colinfo id="PNO" size="256" summ="default" type="STRING"/>
					<colinfo id="DNO_01" size="256" summ="default" type="STRING"/>
					<colinfo id="DNO_02" size="256" summ="default" type="STRING"/>
					<colinfo id="DNO_03" size="256" summ="default" type="STRING"/>
					<record>
						<DNO></DNO>
						<DNO_01></DNO_01>
						<DNO_02></DNO_02>
						<DNO_03></DNO_03>
						<KUNNR></KUNNR>
						<PNO></PNO>
						<PS_PSPID></PS_PSPID>
						<SEQ></SEQ>
						<STR></STR>
						<UPN></UPN>
						<VKGRP></VKGRP>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list2">
				<Contents>
					<colinfo id="KUNNR_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="TITLE" size="256" summ="default" type="STRING"/>
					<colinfo id="ADDR" size="256" summ="default" type="STRING"/>
					<colinfo id="MI_SU_F" size="256" summ="default" type="STRING"/>
					<colinfo id="BANKVN" size="256" summ="default" type="STRING"/>
					<colinfo id="ADDR2" size="256" summ="default" type="STRING"/>
					<colinfo id="TEL" size="256" summ="default" type="STRING"/>
					<colinfo id="FAX" size="256" summ="default" type="STRING"/>
					<colinfo id="SGUSR" size="256" summ="default" type="STRING"/>
					<colinfo id="TITLE2" size="256" summ="default" type="STRING"/>
					<colinfo id="ARA_TEXT" size="256" summ="default" type="STRING"/>
					<colinfo id="EPNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="DUEDATE" size="256" summ="default" type="STRING"/>
					<colinfo id="KUNNR" size="256" summ="default" type="STRING"/>
					<colinfo id="UPN" size="256" summ="default" type="STRING"/>
					<colinfo id="DNO_01" size="256" summ="default" type="STRING"/>
					<colinfo id="DNO_02" size="256" summ="default" type="STRING"/>
					<colinfo id="DNO_03" size="256" summ="default" type="STRING"/>
					<colinfo id="DUEDATE_01" size="256" summ="default" type="STRING"/>
					<colinfo id="DUEDATE_02" size="256" summ="default" type="STRING"/>
					<colinfo id="DUEDATE_03" size="256" summ="default" type="STRING"/>
					<colinfo id="DUSCONTINUE" size="256" summ="default" type="STRING"/>
					<colinfo id="PRTNO" size="256" summ="default" type="STRING"/>
					<colinfo id="S004" size="256" summ="default" type="STRING"/>
					<colinfo id="RECEV_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="CON_KEY" size="256" summ="default" type="STRING"/>
					<record>
						<ADDR></ADDR>
						<ADDR2></ADDR2>
						<ARA_TEXT></ARA_TEXT>
						<BANKVN></BANKVN>
						<CON_KEY></CON_KEY>
						<DNO_01></DNO_01>
						<DNO_02></DNO_02>
						<DNO_03></DNO_03>
						<DUEDATE></DUEDATE>
						<DUEDATE_01></DUEDATE_01>
						<DUEDATE_02></DUEDATE_02>
						<DUEDATE_03></DUEDATE_03>
						<DUSCONTINUE></DUSCONTINUE>
						<EPNAME></EPNAME>
						<FAX></FAX>
						<KUNNR></KUNNR>
						<KUNNR_NM></KUNNR_NM>
						<MI_SU_F></MI_SU_F>
						<PRTNO></PRTNO>
						<RECEV_NM></RECEV_NM>
						<S004></S004>
						<SGUSR></SGUSR>
						<TEL></TEL>
						<TITLE></TITLE>
						<TITLE2></TITLE2>
						<UPN></UPN>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list3">
				<Contents>
					<colinfo id="KUNNR" size="256" summ="default" type="STRING"/>
					<colinfo id="TITLE" size="256" summ="default" type="STRING"/>
					<colinfo id="ADDR" size="256" summ="default" type="STRING"/>
					<colinfo id="DUEDATE" size="256" summ="default" type="STRING"/>
					<colinfo id="MI_SU_F" size="256" summ="default" type="STRING"/>
					<colinfo id="BANKVN" size="256" summ="default" type="STRING"/>
					<colinfo id="ADDR2" size="256" summ="default" type="STRING"/>
					<colinfo id="TEL" size="256" summ="default" type="STRING"/>
					<colinfo id="FAX" size="256" summ="default" type="STRING"/>
					<colinfo id="SGUSR" size="256" summ="default" type="STRING"/>
					<colinfo id="TITLE2" size="256" summ="default" type="STRING"/>
					<colinfo id="ARA_TEXT" size="256" summ="default" type="STRING"/>
					<colinfo id="EPNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="DNO" size="256" summ="default" type="STRING"/>
					<colinfo id="DNO_01" size="256" summ="default" type="STRING"/>
					<colinfo id="DNO_02" size="256" summ="default" type="STRING"/>
					<colinfo id="DNO_03" size="256" summ="default" type="STRING"/>
					<colinfo id="DUEDATE_01" size="256" summ="default" type="STRING"/>
					<colinfo id="DUEDATE_02" size="256" summ="default" type="STRING"/>
					<colinfo id="DUEDATE_03" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="DISCONTINUE" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQ1" size="256" summ="default" type="STRING"/>
					<colinfo id="FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="ZIP2" size="256" summ="default" type="STRING"/>
					<colinfo id="DEPT_NO" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_save">
				<Contents>
					<colinfo id="KUNNR" size="256" summ="default" type="STRING"/>
					<colinfo id="KUNNR_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="TITLE" size="256" summ="default" type="STRING"/>
					<colinfo id="ADDR" size="256" summ="default" type="STRING"/>
					<colinfo id="MI_SU_F" size="256" summ="default" type="STRING"/>
					<colinfo id="BANKVN" size="256" summ="default" type="STRING"/>
					<colinfo id="ADDR2" size="256" summ="default" type="STRING"/>
					<colinfo id="TEL" size="256" summ="default" type="STRING"/>
					<colinfo id="FAX" size="256" summ="default" type="STRING"/>
					<colinfo id="SGUSR" size="256" summ="default" type="STRING"/>
					<colinfo id="TITLE2" size="256" summ="default" type="STRING"/>
					<colinfo id="ARA_TEXT" size="256" summ="default" type="STRING"/>
					<colinfo id="EPNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="DUEDATE" size="256" summ="default" type="STRING"/>
					<colinfo id="FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="GNO" size="256" summ="default" type="STRING"/>
					<colinfo id="VKGRP" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="DNO" size="256" summ="default" type="STRING"/>
					<colinfo id="UPN" size="256" summ="default" type="STRING"/>
					<colinfo id="AUART" size="256" summ="default" type="STRING"/>
					<colinfo id="LGORT" size="256" summ="default" type="STRING"/>
					<colinfo id="ZIP" size="256" summ="default" type="STRING"/>
					<colinfo id="P1B" size="256" summ="default" type="STRING"/>
					<colinfo id="P2B" size="256" summ="default" type="STRING"/>
					<colinfo id="DNO_1" size="256" summ="default" type="STRING"/>
					<colinfo id="DNO_2" size="256" summ="default" type="STRING"/>
					<colinfo id="DDT_1" size="256" summ="default" type="STRING"/>
					<colinfo id="DDT_2" size="256" summ="default" type="STRING"/>
					<colinfo id="DCT" size="256" summ="default" type="STRING"/>
					<colinfo id="SEAL" size="256" summ="default" type="STRING"/>
					<colinfo id="S004" size="256" summ="default" type="STRING"/>
					<colinfo id="RECEV_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="NZIB" size="256" summ="default" type="STRING"/>
					<colinfo id="SPT" size="256" summ="default" type="STRING"/>
					<colinfo id="DP1B" size="256" summ="default" type="STRING"/>
					<colinfo id="DP2B" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_save2">
				<Contents>
					<colinfo id="FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="GNO_A" size="256" summ="default" type="STRING"/>
					<colinfo id="GNO" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="DNO" size="256" summ="default" type="STRING"/>
					<colinfo id="PNO" size="256" summ="default" type="STRING"/>
					<colinfo id="UPN" size="256" summ="default" type="STRING"/>
					<colinfo id="KUNNR" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_dno">
				<Contents>
					<colinfo id="DNO" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_bank">
				<Contents>
					<colinfo id="KUNNR" size="256" summ="default" type="STRING"/>
					<colinfo id="TITLE" size="256" summ="default" type="STRING"/>
					<colinfo id="ADDR" size="256" summ="default" type="STRING"/>
					<colinfo id="DUEDATE" size="256" summ="default" type="STRING"/>
					<colinfo id="MI_SU_F" size="256" summ="default" type="STRING"/>
					<colinfo id="BANKVN" size="256" summ="default" type="STRING"/>
					<colinfo id="ADDR2" size="256" summ="default" type="STRING"/>
					<colinfo id="TEL" size="256" summ="default" type="STRING"/>
					<colinfo id="FAX" size="256" summ="default" type="STRING"/>
					<colinfo id="SGUSR" size="256" summ="default" type="STRING"/>
					<colinfo id="TITLE2" size="256" summ="default" type="STRING"/>
					<colinfo id="ARA_TEXT" size="256" summ="default" type="STRING"/>
					<colinfo id="EPNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="DNO" size="256" summ="default" type="STRING"/>
					<colinfo id="DNO_01" size="256" summ="default" type="STRING"/>
					<colinfo id="DNO_02" size="256" summ="default" type="STRING"/>
					<colinfo id="DNO_03" size="256" summ="default" type="STRING"/>
					<colinfo id="DUEDATE_01" size="256" summ="default" type="STRING"/>
					<colinfo id="DUEDATE_02" size="256" summ="default" type="STRING"/>
					<colinfo id="DUEDATE_03" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="DISCONTINUE" size="256" summ="default" type="STRING"/>
					<colinfo id="GNO" size="256" summ="default" type="STRING"/>
					<colinfo id="AUART" size="256" summ="default" type="STRING"/>
					<colinfo id="ZIP2" size="256" summ="default" type="STRING"/>
					<colinfo id="DEPT_NO" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_dnoChk">
				<Contents>
					<colinfo id="DNO_01" size="256" summ="default" type="STRING"/>
					<colinfo id="DNO_02" size="256" summ="default" type="STRING"/>
					<colinfo id="DNO_03" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_data">
				<Contents>
					<colinfo id="UPN" size="256" summ="default" type="STRING"/>
					<colinfo id="CST" size="256" summ="default" type="STRING"/>
					<colinfo id="GNO" size="256" summ="default" type="STRING"/>
					<colinfo id="TGNO" size="256" summ="default" type="STRING"/>
					<colinfo id="GNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="ADDR" size="256" summ="default" type="STRING"/>
					<colinfo id="PSTLZ" size="256" summ="default" type="STRING"/>
					<colinfo id="ABG" size="256" summ="default" type="STRING"/>
					<colinfo id="ZIB" size="256" summ="default" type="STRING"/>
					<colinfo id="P1B" size="256" summ="default" type="STRING"/>
					<colinfo id="P2B" size="256" summ="default" type="STRING"/>
					<colinfo id="GSH" size="256" summ="default" type="STRING"/>
					<colinfo id="CDP" size="256" summ="default" type="STRING"/>
					<colinfo id="TEA" size="256" summ="default" type="STRING"/>
					<colinfo id="GYA" size="256" summ="default" type="STRING"/>
					<colinfo id="SJU" size="256" summ="default" type="STRING"/>
					<colinfo id="STR" size="256" summ="default" type="STRING"/>
					<colinfo id="BGB" size="256" summ="default" type="STRING"/>
					<colinfo id="BHB" size="256" summ="default" type="STRING"/>
					<colinfo id="RIV" size="256" summ="default" type="STRING"/>
					<colinfo id="RDT" size="256" summ="default" type="STRING"/>
					<colinfo id="JZR" size="256" summ="default" type="STRING"/>
					<colinfo id="SZR" size="256" summ="default" type="STRING"/>
					<colinfo id="CHR" size="256" summ="default" type="STRING"/>
					<colinfo id="RES" size="256" summ="default" type="STRING"/>
					<colinfo id="TEB" size="256" summ="default" type="STRING"/>
					<colinfo id="GYB" size="256" summ="default" type="STRING"/>
					<colinfo id="ZIC" size="256" summ="default" type="STRING"/>
					<colinfo id="P1C" size="256" summ="default" type="STRING"/>
					<colinfo id="P2C" size="256" summ="default" type="STRING"/>
					<colinfo id="TEC" size="256" summ="default" type="STRING"/>
					<colinfo id="GYC" size="256" summ="default" type="STRING"/>
					<colinfo id="RNM" size="256" summ="default" type="STRING"/>
					<colinfo id="RN2" size="256" summ="default" type="STRING"/>
					<colinfo id="TED" size="256" summ="default" type="STRING"/>
					<colinfo id="GYD" size="256" summ="default" type="STRING"/>
					<colinfo id="ZID" size="256" summ="default" type="STRING"/>
					<colinfo id="P1D" size="256" summ="default" type="STRING"/>
					<colinfo id="P2D" size="256" summ="default" type="STRING"/>
					<colinfo id="JSH" size="256" summ="default" type="STRING"/>
					<colinfo id="JUC" size="256" summ="default" type="STRING"/>
					<colinfo id="NAM" size="256" summ="default" type="STRING"/>
					<colinfo id="SPT" size="256" summ="default" type="STRING"/>
					<colinfo id="NEWCST" size="256" summ="default" type="STRING"/>
					<colinfo id="JUCTEXT" size="256" summ="default" type="STRING"/>
					<colinfo id="CSB" size="256" summ="default" type="STRING"/>
					<colinfo id="GSHCDP" size="256" summ="default" type="STRING"/>
					<colinfo id="CSBORIGIN" size="256" summ="default" type="STRING"/>
					<colinfo id="PNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="EM1" size="256" summ="default" type="STRING"/>
					<colinfo id="EM2" size="256" summ="default" type="STRING"/>
					<colinfo id="CH2" size="256" summ="default" type="STRING"/>
					<colinfo id="TE2" size="256" summ="default" type="STRING"/>
					<colinfo id="GY2" size="256" summ="default" type="STRING"/>
					<colinfo id="ZIE" size="256" summ="default" type="STRING"/>
					<colinfo id="P1E" size="256" summ="default" type="STRING"/>
					<colinfo id="P2E" size="256" summ="default" type="STRING"/>
					<colinfo id="EGNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="EPNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="SLA" size="256" summ="default" type="STRING"/>
					<colinfo id="BANKA" size="256" summ="default" type="STRING"/>
					<colinfo id="BANKB" size="256" summ="default" type="STRING"/>
					<colinfo id="TMK" size="256" summ="default" type="STRING"/>
					<colinfo id="RSN" size="256" summ="default" type="STRING"/>
					<colinfo id="KUNNR" size="256" summ="default" type="STRING"/>
					<colinfo id="JNO" size="256" summ="default" type="STRING"/>
					<colinfo id="CAR" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK_SMS" size="256" summ="default" type="STRING"/>
					<colinfo id="CH3" size="256" summ="default" type="STRING"/>
					<colinfo id="EM3" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK_SM3" size="256" summ="default" type="STRING"/>
					<colinfo id="TE3" size="256" summ="default" type="STRING"/>
					<colinfo id="GY3" size="256" summ="default" type="STRING"/>
					<colinfo id="TE4" size="256" summ="default" type="STRING"/>
					<colinfo id="TE5" size="256" summ="default" type="STRING"/>
					<colinfo id="ZTERM" size="256" summ="default" type="STRING"/>
					<colinfo id="DZIB" size="256" summ="default" type="STRING"/>
					<colinfo id="DP1B" size="256" summ="default" type="STRING"/>
					<colinfo id="DP2B" size="256" summ="default" type="STRING"/>
					<colinfo id="DZIE" size="256" summ="default" type="STRING"/>
					<colinfo id="DP1E" size="256" summ="default" type="STRING"/>
					<colinfo id="DP2E" size="256" summ="default" type="STRING"/>
					<colinfo id="RECEV_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="NZIB" size="256" summ="default" type="STRING"/>
					<record>
						<ABG></ABG>
						<ADDR></ADDR>
						<BANKA></BANKA>
						<BANKB></BANKB>
						<BGB></BGB>
						<BHB></BHB>
						<CAR></CAR>
						<CDP></CDP>
						<CH2></CH2>
						<CH3></CH3>
						<CHK_SM3></CHK_SM3>
						<CHK_SMS></CHK_SMS>
						<CHR></CHR>
						<CSB></CSB>
						<CSBORIGIN></CSBORIGIN>
						<CST></CST>
						<DP1B></DP1B>
						<DP1E></DP1E>
						<DP2B></DP2B>
						<DP2E></DP2E>
						<DZIB></DZIB>
						<DZIE></DZIE>
						<EGNAME></EGNAME>
						<EM1></EM1>
						<EM2></EM2>
						<EM3></EM3>
						<EPNAME></EPNAME>
						<GBN></GBN>
						<GNAME></GNAME>
						<GNO></GNO>
						<GSH></GSH>
						<GSHCDP></GSHCDP>
						<GY2></GY2>
						<GY3></GY3>
						<GYA></GYA>
						<GYB></GYB>
						<GYC></GYC>
						<GYD></GYD>
						<JNO></JNO>
						<JSH></JSH>
						<JUC></JUC>
						<JUCTEXT></JUCTEXT>
						<JZR></JZR>
						<KUNNR></KUNNR>
						<NAM></NAM>
						<NEWCST></NEWCST>
						<NZIB></NZIB>
						<P1B></P1B>
						<P1C></P1C>
						<P1D></P1D>
						<P1E></P1E>
						<P2B></P2B>
						<P2C></P2C>
						<P2D></P2D>
						<P2E></P2E>
						<PNAME></PNAME>
						<PSTLZ></PSTLZ>
						<RDT></RDT>
						<RECEV_NM></RECEV_NM>
						<RES></RES>
						<RIV></RIV>
						<RN2></RN2>
						<RNM></RNM>
						<RSN></RSN>
						<SJU></SJU>
						<SLA></SLA>
						<SPT></SPT>
						<STR></STR>
						<SZR></SZR>
						<TE2></TE2>
						<TE3></TE3>
						<TE4></TE4>
						<TE5></TE5>
						<TEA></TEA>
						<TEB></TEB>
						<TEC></TEC>
						<TED></TED>
						<TGNO></TGNO>
						<TMK></TMK>
						<UPN></UPN>
						<ZIB></ZIB>
						<ZIC></ZIC>
						<ZID></ZID>
						<ZIE></ZIE>
						<ZTERM></ZTERM>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_conkey">
				<Contents>
					<colinfo id="ACON" size="256" summ="default" type="STRING"/>
					<colinfo id="SEAL" size="256" summ="default" type="STRING"/>
					<colinfo id="S004" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_s004">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME></CODE_NAME>
					</record>
				</Contents>
			</Dataset>
		</Datasets>
		<Shape BKColor="user12" Bottom="602" Height="26" Id="Shape19" Left="7" LineColor="user13" Right="509" TabOrder="64" Top="576" Type="Rectangle" Width="502"></Shape>
		<Shape BKColor="user12" Bottom="626" Height="26" Id="Shape17" Left="7" LineColor="user13" Right="509" TabOrder="60" Top="600" Type="Rectangle" Width="502"></Shape>
		<Shape BKColor="user12" Bottom="513" Height="66" Id="Shape15" Left="7" LineColor="user13" Right="509" TabOrder="53" Top="447" Type="Rectangle" Width="502"></Shape>
		<Shape BKColor="user12" Bottom="386" Height="26" Id="Shape13" Left="7" LineColor="user13" Right="509" TabOrder="43" Top="360" Type="Rectangle" Width="502"></Shape>
		<Shape BKColor="user12" Bottom="362" Height="26" Id="Shape12" Left="7" LineColor="user13" Right="509" TabOrder="40" Top="336" Type="Rectangle" Width="502"></Shape>
		<Shape BKColor="user12" Bottom="338" Height="26" Id="Shape11" Left="7" LineColor="user13" Right="509" TabOrder="37" Top="312" Type="Rectangle" Width="502"></Shape>
		<Shape BKColor="user12" Bottom="314" Height="26" Id="Shape10" Left="7" LineColor="user13" Right="509" TabOrder="34" Top="288" Type="Rectangle" Width="502"></Shape>
		<Shape BKColor="user12" Bottom="290" Height="26" Id="Shape8" Left="7" LineColor="user13" Right="509" TabOrder="30" Top="264" Type="Rectangle" Width="502"></Shape>
		<Shape BKColor="user12" Bottom="418" Height="26" Id="Shape9" Left="7" LineColor="user13" Right="509" TabOrder="33" Top="392" Type="Rectangle" Width="502"></Shape>
		<Shape BKColor="user12" Bottom="114" Height="26" Id="Shape1" Left="7" LineColor="user13" Right="509" TabOrder="2" Top="88" Type="Rectangle" Width="502"></Shape>
		<Shape BKColor="user12" Bottom="211" Height="26" Id="Shape2" Left="7" LineColor="user13" Right="509" TabOrder="3" Top="185" Type="Rectangle" Width="502"></Shape>
		<Shape BKColor="user12" Bottom="236" Height="26" Id="Shape0" Left="7" LineColor="user13" Right="509" TabOrder="7" Top="210" Type="Rectangle" Width="502"></Shape>
		<Div Height="32" Id="div_btn" TabOrder="1" Text="Div0" ToolTipFont="Default,0" Url="WB01::CommBtnForm.xml" Width="520">
			<Contents></Contents>
		</Div>
		<Static Align="Right" Height="24" Id="st_kunner_nm" Left="8" Style="sty_lb_form_basic" TabOrder="4" Text="고객명&#32;" Top="89" VAlign="Middle" Width="95"></Static>
		<Static Align="Right" Height="24" Id="st_gbn" Left="8" Style="sty_lb_form_basic" TabOrder="5" Text="미납내역&#32;" Top="186" VAlign="Middle" Width="95"></Static>
		<Static Align="Right" Height="24" Id="st_misu_f" Left="8" Style="sty_lb_form_basic" TabOrder="6" Text="총미납금액&#32;" Top="211" VAlign="Middle" Width="95"></Static>
		<Shape BKColor="user12" Bottom="162" Height="26" Id="Shape6" Left="7" LineColor="user13" Right="509" TabOrder="8" Top="136" Type="Rectangle" Width="502"></Shape>
		<Shape BKColor="user12" Bottom="187" Height="26" Id="Shape7" Left="7" LineColor="user13" Right="509" TabOrder="9" Top="161" Type="Rectangle" Width="502"></Shape>
		<Static Align="Right" Height="24" Id="st_addr" Left="8" Style="sty_lb_form_basic" TabOrder="10" Text="주&#32;&#32;소&#32;" Top="162" VAlign="Middle" Width="95"></Static>
		<Static Align="Right" Height="24" Id="st_title" Left="8" Style="sty_lb_form_basic" TabOrder="11" Text="제&#32;&#32;목&#32;" Top="137" VAlign="Middle" Width="95"></Static>
		<Edit BindDataset="ds_list2" Border="Flat" Column="TITLE" Height="20" Id="ed_title" Left="105" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="12" Top="139" Width="400"></Edit>
		<Edit BindDataset="ds_list2" Border="Flat" Column="ADDR" Height="20" Id="ed_addr" Left="105" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="13" Top="164" Width="400"></Edit>
		<Edit BindDataset="ds_list2" Border="Flat" Column="TITLE2" Height="20" Id="ed_gbn" Left="105" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="14" Top="189" Width="400"></Edit>
		<Edit BindDataset="ds_list2" Border="Flat" BorderColor="user13" Column="KUNNR_NM" DisableBKColor="user0" Height="20" Id="ed_kunnr_nm" Left="105" Style="sty_ipt_form" TabOrder="15" Top="91" Width="400"></Edit>
		<MaskEdit Align="Right" BindDataset="ds_list2" Border="Flat" Column="MI_SU_F" Height="20" Id="med_misu_f" Left="105" Style="sty_ipt_form" TabOrder="16" Top="213" Width="120"></MaskEdit>
		<Static Height="16" Id="Static15" Left="228" TabOrder="17" Text="원" Top="217" Width="30"></Static>
		<Shape BKColor="user12" Bottom="138" Height="26" Id="Shape3" Left="7" LineColor="user13" Right="509" TabOrder="18" Top="112" Type="Rectangle" Width="502"></Shape>
		<Static Align="Right" Height="24" Id="st_epname" Left="8" Style="sty_lb_form_basic" TabOrder="19" Text="대표자명&#32;" Top="113" VAlign="Middle" Width="95"></Static>
		<Edit BindDataset="ds_list2" Border="Flat" BorderColor="user13" Column="EPNAME" DisableBKColor="user0" Height="20" Id="ed_epname" Left="105" Style="sty_ipt_form" TabOrder="20" Top="115" Width="400"></Edit>
		<Shape BKColor="user12" Bottom="260" Height="26" Id="Shape4" Left="7" LineColor="user13" Right="509" TabOrder="22" Top="234" Type="Rectangle" Width="502"></Shape>
		<Calendar BindDataset="ds_list2" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="DUEDATE" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DisableBKColor="user5" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_duedate" Left="105" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="23" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="237" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="100"></Calendar>
		<Shape BKColor="user12" Bottom="90" Height="26" Id="Shape5" Left="7" LineColor="user13" Right="509" TabOrder="24" Top="64" Type="Rectangle" Width="502"></Shape>
		<Static Align="Right" Height="24" Id="st_etn" Left="8" Style="sty_lb_form_basic" TabOrder="25" Text="공문번호&#32;" Top="65" VAlign="Middle" Width="95"></Static>
		<Edit Border="Flat" Column="DNO" Enable="FALSE" Height="20" Id="ed_dno" Left="105" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="26" Top="67" Width="150"></Edit>
		<Static Align="Right" Height="24" Id="st_sir" Left="259" Style="sty_lb_form_basic" TabOrder="27" Text="공문차수&#32;" Top="65" VAlign="Middle" Width="95"></Static>
		<Edit Border="Flat" Enable="FALSE" Height="20" Id="ed_seq" ImeMode="none" Left="356" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="28" Top="67" Width="150"></Edit>
		<Static Align="Right" Height="24" Id="Static0" Left="8" Style="sty_lb_form_basic" TabOrder="29" Text="가상계좌&#32;" Top="393" VAlign="Middle" Width="95"></Static>
		<Edit BindDataset="ds_bank" Border="Flat" BorderColor="user13" Column="ARA_TEXT" DisableBKColor="user0" Enable="FALSE" Height="20" Id="Edit0" Left="105" Style="sty_ipt_form" TabOrder="31" Top="267" Width="400"></Edit>
		<Edit BindDataset="ds_bank" Border="Flat" BorderColor="user13" Column="ADDR2" DisableBKColor="user0" Enable="FALSE" Height="20" Id="Edit2" Left="105" Style="sty_ipt_form" TabOrder="35" Top="291" Width="400"></Edit>
		<Static Align="Right" Height="24" Id="Static4" Left="8" Style="sty_lb_form_basic" TabOrder="36" Text="지사&#32;주소&#32;" Top="289" VAlign="Middle" Width="95"></Static>
		<Edit BindDataset="ds_bank" Border="Flat" BorderColor="user13" Column="FAX" DisableBKColor="user0" Enable="FALSE" Height="20" Id="Edit3" Left="105" Style="sty_ipt_form" TabOrder="38" Top="315" Width="400"></Edit>
		<Static Align="Right" Height="24" Id="Static6" Left="8" Style="sty_lb_form_basic" TabOrder="39" Text="지사&#32;FAX&#32;" Top="313" VAlign="Middle" Width="95"></Static>
		<Edit BindDataset="ds_list2" Border="Flat" BorderColor="user13" Column="TEL" DisableBKColor="user0" Height="20" Id="ed_tel" Left="105" Style="sty_ipt_form" TabOrder="41" Top="339" Width="400"></Edit>
		<Static Align="Right" Height="24" Id="Static8" Left="8" Style="sty_lb_form_basic" TabOrder="42" Text="전화번호&#32;" Top="337" VAlign="Middle" Width="95"></Static>
		<Edit BindDataset="ds_list2" Border="Flat" BorderColor="user13" Column="SGUSR" DisableBKColor="user0" Height="20" Id="ed_sgusr" Left="105" Style="sty_ipt_form" TabOrder="44" Top="363" Width="400"></Edit>
		<Static Align="Right" Height="24" Id="Static10" Left="8" Style="sty_lb_form_basic" TabOrder="45" Text="담당자&#32;" Top="361" VAlign="Middle" Width="95"></Static>
		<Static Align="Right" Height="24" Id="Static2" Left="8" Style="sty_lb_form_basic" TabOrder="32" Text="지사&#32;" Top="265" VAlign="Middle" Width="95"></Static>
		<AxMSIE Bottom="80" Height="56" Id="AxMSIE0" Left="592" Right="664" TitleChange="AxMSIE0_TitleChange" Top="24" Width="72"></AxMSIE>
		<Static Align="Right" Height="24" Id="st_duedate" Left="8" Style="sty_lb_form_basic" TabOrder="21" Text="납부기한&#32;" Top="235" VAlign="Middle" Width="95"></Static>
		<Edit Align="CENTER" Border="Flat" BorderColor="user13" DisableBKColor="user0" Enable="FALSE" Height="20" Id="Edit4" Left="232" Style="sty_ipt_form" TabOrder="47" Text="(농협)" Top="395" Width="119"></Edit>
		<MaskEdit Align="Center" BindDataset="ds_bank" Border="Flat" Column="BANKVN" Enable="FALSE" Height="20" Id="med_bankvn" Left="104" Mask="####-####-####-##" Style="sty_ipt_form" TabOrder="48" Top="395" Type="STRING" Width="120"></MaskEdit>
		<Edit BindDataset="ds_list2" Border="Flat" BorderColor="user13" Column="DNO_01" DisableBKColor="user0" Enable="FALSE" Height="20" Id="Edit1" Left="600" Style="sty_ipt_form" TabOrder="49" Top="440" Width="88"></Edit>
		<Edit BindDataset="ds_list2" Border="Flat" BorderColor="user13" Column="DUEDATE_01" DisableBKColor="user0" Enable="FALSE" Height="20" Id="Edit5" Left="600" Style="sty_ipt_form" TabOrder="50" Top="472" Width="88"></Edit>
		<Shape BKColor="user12" Bottom="446" Height="26" Id="Shape14" Left="7" LineColor="user13" Right="509" TabOrder="51" Top="420" Type="Rectangle" Width="502"></Shape>
		<Edit Border="None" Height="20" Id="ed_info" Left="16" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="52" Text="#&#32;전자우편&#32;서비스&#32;필수&#32;항목" Top="424" Width="168"></Edit>
		<Static Align="Right" Height="67" Id="Static12" Left="89" Style="sty_lb_form_basic" TabOrder="54" Text="(&#32;지번&#32;)&#32;" Top="448" VAlign="Middle" Width="68"></Static>
		<Edit BindDataset="ds_data" Border="Flat" Column="P2B" Height="20" Id="ed_addrDetail0" Left="159" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="58" Top="491" Width="345"></Edit>
		<Edit BindDataset="ds_data" Border="Flat" Column="P1B" Height="20" Id="ed_addr0" Left="159" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="57" Top="470" Width="345"></Edit>
		<MaskEdit BindDataset="ds_data" Border="Flat" Column="ZIB" DisplayComma="FALSE" Height="20" Id="med_zipcode0" Left="159" LeftMargin="10" Mask="###-###" MaxLength="7" Style="sty_ipt_form" TabOrder="56" Top="449" Type="STRING" Width="70"></MaskEdit>
		<Static Align="Right" Height="24" Id="Static14" Left="8" Style="sty_lb_form_basic" TabOrder="59" Text="&#32;발송&#32;구분&#32;" Top="601" VAlign="Middle" Width="80"></Static>
		<Combo BindDataset="ds_list2" Border="Flat" CodeColumn="CODE" Column="S004" DataColumn="CODE_NAME" Editable="TRUE" Height="22" Id="cb_seal" InnerDataset="ds_s004" Left="89" Style="sty_ipt_form" TabOrder="61" Top="601" Width="144"></Combo>
		<Edit Border="None" Height="20" Id="Edit6" Left="8" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="63" Text="#&#32;공문&#32;필수&#32;항목" Top="41" Width="168"></Edit>
		<Shape BKColor="user12" Bottom="66" Height="26" Id="Shape18" Left="7" LineColor="user13" Right="509" TabOrder="62" Top="40" Type="Rectangle" Width="502"></Shape>
		<Static Align="Right" Height="24" Id="Static1" Left="8" Style="sty_lb_form_basic" TabOrder="66" Text="수신인&#32;명&#32;" Top="577" VAlign="Middle" Width="80"></Static>
		<Edit BindDataset="ds_list2" Border="Flat" BorderColor="user13" Column="RECEV_NM" DisableBKColor="user0" Height="20" Id="ed_recev_nm" Left="90" Style="sty_ipt_form" TabOrder="65" Top="579" Width="400"></Edit>
		<Shape BKColor="user12" Bottom="578" Height="66" Id="Shape16" Left="7" LineColor="user13" Right="509" TabOrder="67" Top="512" Type="Rectangle" Width="502"></Shape>
		<Static Align="Right" Height="63" Id="Static13" Left="89" Style="sty_lb_form_basic" TabOrder="72" Text="(도로명)&#32;" Top="514" VAlign="Middle" Width="68"></Static>
		<Button Cursor="HAND" Height="18" Id="btn_zipcode0_road" ImageID="btn_icon_search" Left="233" OnClick="ufn_openZipcode" TabOrder="68" Text="Button0" Top="515" Transparent="TRUE" Width="18"></Button>
		<Edit BindDataset="ds_data" Border="Flat" Column="DP1B" Height="20" Id="ed_addr0_road" Left="159" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="69" Top="535" Width="345"></Edit>
		<Edit BindDataset="ds_data" Border="Flat" Column="DP2B" Height="20" Id="ed_addrDetail0_road" Left="159" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="70" Top="556" Width="345"></Edit>
		<Edit BindDataset="ds_data" Border="Flat" Column="NZIB" Height="20" Id="ed_nzib" Left="160" LeftMargin="4" MaxLength="5" Number="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="71" Top="514" Width="70"></Edit>
		<Static Align="Center" Height="129" Id="Static11" Left="8" Style="sty_lb_form_basic" TabOrder="55" Text="수신처주소" Top="448" VAlign="Middle" Width="80"></Static>
	</Form>
	<Script><![CDATA[﻿﻿﻿﻿﻿﻿﻿﻿/*
 ******************************************************************************************
 * 기      능   : 미수채권 공문 작성  CS3403001B
 * 작  성  자   : 이하림
 * 작성  일자   : 
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
#include "LIB::commons.js";	// 공통 스크립트 
#include "LIB::utility.js";	// 다중 선택 
//=========================================================================================
// [ PART 1 ]
// Form에서 사용될 전역변수를 선언
// FORM에서 사용되는 전역변수는 대문자로 작성하며, F_XXX 의 형태를 갖도록 한다. 
//=========================================================================================
var upn = ""; 	//통합프로젝트
var ps_pspid = "";  //wbs
var vkgrp = ""; 	//팀코드
var lgort = ""; 	//업체코드
var kunnr = ""; 	//고객번호
var kunnr_nm = "";  //고객명
var amount = 0; 	//미수금액
var seq = ""; 		//공문 순번
var sgusr = "";
var auart = ""; 	//제품구분
var gno = ""; 		// 403에 저장되는 대표 프로젝트
var dno = ""; 		// 미수공문 발송현황 구분값 ( CS3406001A ) 
var bstnk = ""; //  현장명
//=========================================================================================
// [ PART 2 ]
// Form Loading / Unloading 시 작업 정의
//=========================================================================================
function fn_OnLoadCompleted(obj) {

	gfn_initForm();	
	
	var codeArr = ["CSS004"];	
	var dsObjArr = [ds_s004];
	var addTypeArr = [G_CODE_SELECT];
	gfn_searchCommCode(codeArr, dsObjArr, addTypeArr);
	
	fn_setCond2(); // ds_cond2 세팅
}

/********************************************************************************
* 기      능   : 공통코드가 조회된 후의 Callback 함수 
********************************************************************************/
function fn_completeInit(sCode, sDsObj, sCodeType) {
	// 일반 : 등기 : 내용증명 만 사용
	ds_s004.Filter("CODE = '' OR CODE = '000' OR CODE = '001' OR CODE = '005' )");
	cb_seal.Index = 0;
}

/********************************************************************************
* 기      능   : form UnloadCompleted 
********************************************************************************/
function fn_OnUnloadCompleted(obj) {
	return gfn_isFormUnload(obj);
}

//=========================================================================================
// [ PART 3 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,form닫기)
//=========================================================================================
/********************************************************************************
* 기      능   : ds_cond2 세팅
********************************************************************************/
function fn_setCond2() {

	ds_cond2.SetColumn(0, "UPN",      upn);
	ds_cond2.SetColumn(0, "VKGRP",    vkgrp);
	ds_cond2.SetColumn(0, "KUNNR",    kunnr);
	ds_cond2.SetColumn(0, "PS_PSPID", ps_pspid);
	ds_cond2.SetColumn(0, "SEQ",      seq);
	ds_cond2.SetColumn(0, "DNO",      dno);
	ds_cond2.SetColumn(0, "DNO_01",      dno_01);
	ds_cond2.SetColumn(0, "DNO_02",      dno_02);
	ds_cond2.SetColumn(0, "DNO_03",      dno_03);

	if(dno > "") { 
		fn_query3();// 미수공문 발송현황 ( CS3406001A ) 에서 조회시
	} else {
		fn_query();
	}	
}
//=========================================================================================
// [ PART 3 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,form닫기)
//=========================================================================================
/********************************************************************************
* 기      능   : 조회 
********************************************************************************/
function fn_query() {
	// 공문을 작성할 청구번호들의 공문 작성 이력 조회
	tit_clearActionInfo();
	tit_addSearchActionInfo("cs34:CS3403001B_S2"); // 청구번호 비교
	tit_callService(
		""
		, ""
		, "ds_cond=ds_cond2"
		, "ds_dnoChk=ds_dnoChk"
		, ""
		, "fn_query2"
		, true
		, true);

}
		
function fn_query2() {

	tit_clearActionInfo();
	
	if( seq == "01" ) {
	
		if(length(ds_dnoChk.GetColumn(0, "DNO_01")) == 0 
		  && length(ds_dnoChk.GetColumn(0, "DNO_02")) == 0 
		  && length(ds_dnoChk.GetColumn(0, "DNO_03")) == 0 ) { 
		} else {
			alert(seq + "차 공문을 작성할 수 없습니다.");
			close();
		}
	}
	if( seq == "02" ) {
	
		if(length(ds_dnoChk.GetColumn(0, "DNO_01")) != 0 
		  && length(ds_dnoChk.GetColumn(0, "DNO_02")) == 0 
		  && length(ds_dnoChk.GetColumn(0, "DNO_03")) == 0 ) { 
		} else {
			alert(seq + "차 공문을 작성할 수 없습니다.");
			close();
		}
	}
	if( seq == "03" ) {
	
		if(length(ds_dnoChk.GetColumn(0, "DNO_01")) != 0 
		  && length(ds_dnoChk.GetColumn(0, "DNO_02")) != 0 
		  && length(ds_dnoChk.GetColumn(0, "DNO_03")) == 0 ) { 
		} else {
			alert(seq + "차 공문을 작성할 수 없습니다.");
			close();
		}
	}
	// 공문 작성에 필요한 계좌 정보 및 고객정보 조회
	tit_addSearchActionInfo("cs34:CS3403001B_S7");  // 2차수 이상 공문 작성 시 전차수 내용 갖고 오기
	tit_addSearchActionInfo("cs34:CS3403001B_S1"); // 계좌정보 조회
	tit_addSearchActionInfo("cs42:CS4203001A_S1"); // 우편전송을 위한 정보 get

	tit_callService(
		""
		, ""
		, "ds_cond=ds_cond2"
		, "ds_list2=ds_list2 ds_bank=ds_bank ds_data=ds_data"
		, ""
		, "fn_afterQuery"
		, true
		, true);	

}
	
function fn_query3() {
	// 미수공문 발송현황에서 조회 
	tit_clearActionInfo();
	tit_addSearchActionInfo("cs34:CS3403001B_S6");  // 공문내용 조회 
	tit_addSearchActionInfo("cs34:CS3403001B_S4"); // 계좌정보 조회
	tit_addSearchActionInfo("cs42:CS4203001A_S2"); // 우편전송을 위한 정보 get

	tit_callService(
		""
		, ""
		, "ds_cond=ds_cond2"
		, "ds_list2=ds_list2 ds_bank=ds_bank ds_data=ds_data"
		, ""
		, "fn_afterQuery"
		, true
		, true);	

}
/********************************************************************************
* 기      능   : 조회 Callback  
********************************************************************************/
function fn_afterQuery(errCode, errMsg) {

	// 사용자 변경 시 원사용자의 이름을 공문에 출력한다.
	var arr = split(G_ORG_USER_INFO, "^", true);
	if (arr[1] == null) {
		sgusr = G_USER_NAME;
	} else {
		sgusr = arr[1];
	}

	ed_seq.Text = seq; 
	ed_dno.Text = ds_list2.GetColumn(0, "DNO");  //  공문번호

	auart = ds_bank.GetColumn(0, "AUART");
	gno = ds_bank.GetColumn(0, "GNO");

	div_btn.btn_print.Enable = true;
	div_btn.btn_save.Enable = false;	

	// 공문 초기 작성 시 parent 정보 받아오기
	if( length(ed_dno.Text) == 0 ) { // 신규 작성
		
		ed_kunnr_nm.Text = ds_bank.GetColumn(0, "KUNNR_NM") ;
		med_misu_f.Text  = amount ;
		ed_title.Text    = "승강기 " + ds_bank.GetColumn(0, "TITLE2") + " 납부 독촉의 건" ;
		ed_addr.Text     = ds_bank.GetColumn(0, "ADDR") ;
		ed_gbn.Text      = ds_bank.GetColumn(0, "TITLE2") ;
		cal_duedate.Text = ds_bank.GetColumn(0, "DUEDATE") ;
		ed_epname.Text   = ds_bank.GetColumn(0, "EPNAME") ;
		
		ed_tel.Text     = G_USERTELE  ;
		ed_sgusr.Text   = sgusr ;

		div_btn.btn_print.Enable = false; // 출력 버튼	
		div_btn.btn_save.Enable = true;	  // 저장 버튼	
				
	} else { 
		// 높은 차수 생성 시 전 차수 수정 불가
		if(seq == "01" && ( length(ds_list2.GetColumn(0,"DNO_02")) <> 0
					   || length(ds_list2.GetColumn(0,"DNO_03")) <> 0 ) ) {
			div_btn.btn_save.Enable = false;	
		} else if(seq == "02" && length(ds_list2.GetColumn(0,"DNO_03")) <> 0 ) {
			div_btn.btn_save.Enable = false;		
		} else {
			div_btn.btn_save.Enable = true;	
		} 

	}

	if(length(ds_list2.GetColumn(0, "CON_KEY")) > 0){
		div_btn.btn_save.Enable = false ;
	}
}

/********************************************************************************
* 기      능   : 저장
********************************************************************************/
function fn_save() {
	// 필수 항목 체크	
	if(fn_checkCondition() == false) {	
			return false;
	}
	// 저장 DATASET 설정
	fn_setDsSave();
	
	if(ds_save.rowCount() < 1) {
		// 저장할 정보 없음.
		gfn_showMsg("CW00010");
		return;
	}	
	// 공문 초기 작성 여부에 따른 분기
	if( length(ed_dno.Text) == 0 ) {
	
		fn_saveInsert1(); // 공문 신규 생성
	
	} else {
	
		fn_saveUpdate(); // 기작성 공문 내용 수정
	
	}	

}
/********************************************************************************
* 기      능   : 공문 저장 ZCST403 
********************************************************************************/
function fn_saveInsert1() {

	tit_clearActionInfo();

	tit_addSaveActionInfo(
		""
		, "cs34:CS3403001B_I1"
		, ""
		, "FLAG");

	tit_callService(
        ""
        , ""
        , "ds_save=ds_save"
        , ""
        , ""
        , "fn_saveInsert2");
        
}
/********************************************************************************
* 기      능   : 청구번호 저장 ZCST405
********************************************************************************/
function fn_saveInsert2() {

	gfn_clearMsgBar();
	
	ds_save2.ClearData();

	for(var i=0; i<parent.ds_list_cp.RowCount(); i++) {

		var rows = ds_save2.AddRow();
		
		ds_save2.SetColumn(rows, "FLAG", "U");
		ds_save2.SetColumn(rows, "GNO_A",    gno); //대표 WBS
		ds_save2.SetColumn(rows, "GNO", 	 parent.ds_list_cp.GetColumn(i, "PSPID"));
		ds_save2.SetColumn(rows, "SEQ", 	 seq);
		ds_save2.SetColumn(rows, "PNO", 	 parent.ds_list_cp.GetColumn(i, "BELNR"));
		ds_save2.SetColumn(rows, "UPN",      upn);
		ds_save2.SetColumn(rows, "KUNNR",    kunnr); 
	}

	tit_clearActionInfo();

	tit_addSaveActionInfo(
        ""
        , "cs34:CS3403001B_I2"
        , ""
        , "FLAG");
	
	tit_addSearchActionInfo("cs34:CS3403001B_S3"); // 생성된 공문번호 조회
	
	tit_callService(
        ""
        , ""
        , "ds_save2=ds_save2"
        , "ds_dno=ds_dno"
        , ""
        , "fn_afterSave");
        
}
/********************************************************************************
* 기      능   : Update (수정)
********************************************************************************/
function fn_saveUpdate() {
	trace(ds_data.SaveXML());
	trace(ds_save.SaveXML());
	tit_clearActionInfo();

	tit_addSaveActionInfo(
		""
		, "cs34:CS3403001B_U1"
		, ""
		, "FLAG");

	tit_callService(
        ""
        , ""
        , "ds_save=ds_save"
        , ""
        , ""
        , "fn_afterSaveUpdate");
        
}
/********************************************************************************
* 기      능   : 저장 Callback  
********************************************************************************/
function fn_afterSave(errCode, errMsg) {
	
	if(errCode != 0) {
		gfn_showMsg("CE00001");
	} else {
		gfn_showMsg("CI00003");
		gfn_showAlert("CI00003"); // 저장을 완료했습니다.
		ed_dno.Text = ds_dno.GetColumn(0, "DNO");  // 생성된 공문번호
		div_btn.btn_save.Enable = false;	
	}
	
}
/********************************************************************************
* 기      능   : 저장 Callback  
********************************************************************************/
function fn_afterSaveUpdate(errCode, errMsg) {
	
	if(errCode != 0) {
		gfn_showMsg("CE00001");
	} else {
		gfn_showMsg("CI00003");
	}
	
}

/********************************************************************************
* 기      능   : 삭제
********************************************************************************/
function fn_delete() {	

}

/********************************************************************************
* 기      능   : 닫기  
********************************************************************************/
function fn_close() {

	close();
	
}

/********************************************************************************
* 기      능   : 출력
********************************************************************************/
function fn_print() {

	if(length(trim(ed_kunnr_nm.Text)) == 0){	
		gfn_showAlert(st_kunner_nm.Text + " 항목의 값이 누락되었습니다.");
		return false;
	}
	if(length(trim(ed_title.Text)) == 0){	
		gfn_showAlert(st_title.Text + " 항목의 값이 누락되었습니다.");
		return false;
	}
	if(length(trim(ed_addr.Text)) == 0){	
		gfn_showAlert(st_addr.Text + " 항목의 값이 누락되었습니다.");
		return false;
	}
	if(length(trim(ed_gbn.Text)) == 0){	
		gfn_showAlert(st_gbn.Text + " 항목의 값이 누락되었습니다.");
		return false;
	}
	if(length(trim(med_misu_f.Text)) == 0){	
		gfn_showAlert(st_misu_f.Text + " 항목의 값이 누락되었습니다.");
		return false;
	}
	if(length(trim(ed_epname.Text)) == 0){	
		gfn_showAlert(st_epname.Text + " 항목의 값이 누락되었습니다.");
		return false;
	}
	if(length(trim(cal_duedate.Text)) == 0){	
		gfn_showAlert(st_duedate.Text + " 항목의 값이 누락되었습니다.");
		return false;
	}
	
	ds_list3.ClearData();
	ds_list3.Reset();
	
	ds_list3.AddRow();
	ds_list3.SetColumn(0, "KUNNR",    ed_kunnr_nm.Text); 
	ds_list3.SetColumn(0, "TITLE",    ed_title.Text);
	ds_list3.SetColumn(0, "ADDR",     ed_addr.Text);
	ds_list3.SetColumn(0, "MI_SU_F",  med_misu_f.Text);
	
	ds_list3.SetColumn(0, "BANKVN",   ds_bank.GetColumn(0, "BANKVN"));
	ds_list3.SetColumn(0, "ADDR2",    ds_bank.GetColumn(0, "ADDR2"));
	ds_list3.SetColumn(0, "TEL",      G_USERTELE );
	ds_list3.SetColumn(0, "FAX",      ds_bank.GetColumn(0, "FAX"));
	ds_list3.SetColumn(0, "SGUSR",    sgusr );
	ds_list3.SetColumn(0, "TITLE2",   ds_list2.GetColumn(0, "TITLE2"));
	ds_list3.SetColumn(0, "ARA_TEXT", ds_bank.GetColumn(0, "ARA_TEXT"));
	ds_list3.SetColumn(0, "ZIP2", ds_bank.GetColumn(0, "ZIP2"));
	ds_list3.SetColumn(0, "DEPT_NO", ds_bank.GetColumn(0, "DEPT_NO"));
	
	ds_list3.SetColumn(0, "DUEDATE",  Replace(cal_duedate.Text, ".", ""));
	ds_list3.SetColumn(0, "DUEDATE_01",  ds_list2.GetColumn(0, "DUEDATE_01"));
	ds_list3.SetColumn(0, "DUEDATE_01",  substr(ds_list3.GetColumn(0, "DUEDATE_01"),0,4)+"년 "
	                                    +substr(ds_list3.GetColumn(0, "DUEDATE_01"),4,2)+"월 "
	                                    +substr(ds_list3.GetColumn(0, "DUEDATE_01"),6,2)+"일");
	
	ds_list3.SetColumn(0, "DUEDATE_02",  ds_list2.GetColumn(0, "DUEDATE_02"));
	ds_list3.SetColumn(0, "DUEDATE_02",  substr(ds_list3.GetColumn(0, "DUEDATE_02"),0,4)+"년 "
	                                    +substr(ds_list3.GetColumn(0, "DUEDATE_02"),4,2)+"월 "
	                                    +substr(ds_list3.GetColumn(0, "DUEDATE_02"),6,2)+"일");
	
	
	ds_list3.SetColumn(0, "EPNAME",   ed_epname.Text);
	
	ds_list3.SetColumn(0, "DNO",      ed_dno.Text);
	ds_list3.SetColumn(0, "DNO_01",   ds_list2.GetColumn(0, "DNO_01"));
	ds_list3.SetColumn(0, "DNO_02",   ds_list2.GetColumn(0, "DNO_02"));
	ds_list3.SetColumn(0, "DNO_03",   ds_list2.GetColumn(0, "DNO_03"));
	
	ds_list3.SetColumn(0, "SEQ",      Replace(ed_seq.Text, "0", ""));
	
	ds_list3.SetColumn(0, "DISCONTINUE",    ds_list2.GetColumn(0, "DISCONTINUE")); // 3차 보수중지일

	ds_list3.SetColumn(0, "FLAG", "U"); 
	ds_list3.SetColumn(0, "SEQ1",     ed_seq.Text);	

	// 출력여부 업데이트	
	tit_clearActionInfo();
	tit_addSaveActionInfo(
		""
		, "cs34:CS3403001B_U2"
		, ""
		, "FLAG");
	tit_callService(
		""
		, ""
		, "ds_list3=ds_list3"
		, ""
		, ""
		, "fn_printPopup"
		, true);
	
}
/********************************************************************************
* 기      능   : 출력 팝업
********************************************************************************/
function fn_printPopup() {
	//UbiReport Call 
	
	if(ds_list3.GetColumn(0, "SEQ") == "1") {
		Dialog("CS34::CS3403001C.xml", "");
	
	} else if(ds_list3.GetColumn(0, "SEQ") == "2"){
		Dialog("CS34::CS3403002C.xml", "");
		
	} else if(ds_list3.GetColumn(0, "SEQ") == "3"){
		Dialog("CS34::CS3403003C.xml", "");
	}
}

/********************************************************************************
* 기      능   : 장기미수 공문 수신처 주소 
********************************************************************************/
var strZipcodeObj;
var chk=0;
function ufn_openZipcode(obj)
{
	var arg = "strObj="+quote(Obj.id);
	strZipcodeObj=Obj.id;
	AxMSIE0.Navigate2(G_SERVER_URL + "addressSearchLink.jsp");
	//gfn_openPopup("CS9601003A",true,arg);	
}

function AxMSIE0_TitleChange(obj,Text)
{
	chk++;
	trace("chk="+chk);
	trace("Text="+Text);
	if(Text!="address link"){
		if(chk==2){	
					trace("xxxx");

			ufn_setAddr();
			chk=1;
			
		}
	}else{
		chk=1;
	}
}
function ufn_setAddr() {

	var objDocument = AxMSIE0.Document;
	
	var roadAddrPart1 = objDocument.getElementById('roadAddrPart1').value;
	var roadAddrPart2 = objDocument.getElementById('roadAddrPart2').value;
	
	var roadAddr = roadAddrPart1 + ' ' + roadAddrPart2;	
	var jibunAddr = objDocument.getElementById('jibunAddr').value;
	
	var addrDetail = objDocument.getElementById('addrDetail').value;

	var zipNo = objDocument.getElementById('zipNo').value;

	if(strZipcodeObj=="btn_zipcode0" || strZipcodeObj=="btn_zipcode0_road"){
		if(IsValid(Object("med_zipcode0"))!=false){		
			ed_nzib.value = zipNo;					
		}	
		if(IsValid(Object("ed_addr0"))!=false){			
			ed_addr0.value = jibunAddr;	
		}
		if(IsValid(Object("ed_addrDetail0"))!=false){			
			ed_addrDetail0.value = addrDetail;	
		}
				
		//도로명주소
		if(IsValid(Object("med_zipcode0_road"))!=false){	
			ed_nzib.value = zipNo;						
		}	
		if(IsValid(Object("ed_addr0_road"))!=false){			
			ed_addr0_road.value = roadAddr;	
		}									
		if(IsValid(Object("ed_addrDetail0_road"))!=false){			
			ed_addrDetail0_road.value = addrDetail;	
		}
	}

}
/********************************************************************************
* 기      능   : 전자우편 서비스 신청 시 필수값 체크
********************************************************************************/
function fn_checkCondition(){

	if(Length(Trim(ds_list2.GetColumn(0,"KUNNR_NM"))) == 0) {
		gfn_showAlert("CW00001","고객명");
		return false;
	}	

	if(Length(Trim(ds_list2.GetColumn(0,"EPNAME"))) == 0) {
		gfn_showAlert("CW00001","대표자명");
		return false;
	}	

	if(Length(Trim(ds_list2.GetColumn(0,"TITLE"))) == 0) {
		gfn_showAlert("CW00001","제목");
		return false;
	}	

	if(Length(Trim(ds_list2.GetColumn(0,"ADDR"))) == 0) {
		gfn_showAlert("CW00001","주소");
		return false;
	}	

	if(Length(Trim(ds_list2.GetColumn(0,"TITLE2"))) == 0) {
		gfn_showAlert("CW00001","미납내역");
		return false;
	}	

	if(Length(Trim(ds_list2.GetColumn(0,"MI_SU_F"))) == 0) {
		gfn_showAlert("CW00001","총미납금액");
		return false;
	}	

	if(Length(Trim(ds_list2.GetColumn(0,"DUEDATE"))) == 0) {
		gfn_showAlert("CW00001","납부기한");
		return false;
	}	
	
	if(Length(Trim(ds_data.GetColumn(0,"NZIB"))) == 0) {
		gfn_showAlert("CW00001","수신처 우편번호");
		return false;
	}	
		
	if(Length(Trim(ds_data.GetColumn(0,"DP1B"))) == 0) {
		gfn_showAlert("CW00001","도로명 수신처 주소");
		return false;
	}	
	if(Length(Trim(ds_bank.GetColumn(0,"BANKVN"))) == 0) {
		gfn_showAlert("CW00001","가상계좌");
		return false;
	}	
	if(Length(Trim(ed_tel.Text)) == 0) {
		gfn_showAlert("CW00001","담당자전화번호");
		return false;
	}	
	if(Length(Trim(ed_sgusr.Text)) == 0) {
		gfn_showAlert("CW00001","담당자명");
		return false;
	}	
	if(Length(Trim(cb_seal.value)) == 0) {
		gfn_showAlert("CW00001","발송구분");
		return false;
	}
	if(Length(Trim(ed_recev_nm.Text)) == 0) {
		gfn_showAlert("CW00001","수신인 명");
		return false;
	}	
}

function fn_setDsSave(){

	ds_save.ClearData();
	ds_save.AddRow();
	ds_save.SetColumn(0, "FLAG", "U");
	ds_save.SetColumn(0, "UPN",      upn);
	ds_save.SetColumn(0, "KUNNR",    kunnr); 
	ds_save.SetColumn(0, "KUNNR_NM", ed_kunnr_nm.Text); 
	ds_save.SetColumn(0, "TITLE",    ed_title.Text);
	ds_save.SetColumn(0, "ADDR",     ed_addr.Text);
	ds_save.SetColumn(0, "MI_SU_F",  Replace(med_misu_f.Text, ",", ""));
	ds_save.SetColumn(0, "TITLE2",   ed_gbn.Text);
	ds_save.SetColumn(0, "DUEDATE",  cal_duedate.Text);
	ds_save.SetColumn(0, "EPNAME",   ed_epname.Text);
	ds_save.SetColumn(0, "GNO",      gno);
	ds_save.SetColumn(0, "VKGRP",    vkgrp);
	ds_save.SetColumn(0, "SEQ",      seq);
	ds_save.SetColumn(0, "DNO",      ed_dno.Text);
	ds_save.SetColumn(0, "AUART",    auart);
	ds_save.SetColumn(0, "LGORT",    lgort);
	
	ds_save.SetColumn(0, "BANKVN",  ds_bank.GetColumn(0, "BANKVN") );
	ds_save.SetColumn(0, "ZIP",     med_zipcode0.Text  );
//	ds_save.SetColumn(0, "P1B",     ed_addr0.Text  );
//	ds_save.SetColumn(0, "P2B",     ed_addrDetail0.Text  );
	ds_save.SetColumn(0, "DP1B",     ed_addr0_road.Text  );
	ds_save.SetColumn(0, "DP2B",     ed_addrDetail0_road.Text  );
	ds_save.SetColumn(0, "DNO_1",   ds_list2.GetColumn(0, "DNO_01") );
	ds_save.SetColumn(0, "DNO_2",   ds_list2.GetColumn(0, "DNO_02") );
	ds_save.SetColumn(0, "DDT_1",   ds_list2.GetColumn(0, "DUEDATE_01") );
	ds_save.SetColumn(0, "DDT_2",   ds_list2.GetColumn(0, "DUEDATE_02") );
	ds_save.SetColumn(0, "DCT",     ds_list2.GetColumn(0, "DISCONTINUE")  );
	ds_save.SetColumn(0, "TEL",     ed_tel.Text  );
	ds_save.SetColumn(0, "SGUSR",   ed_sgusr.Text   );
	ds_save.SetColumn(0, "RECEV_NM",     ed_recev_nm.Text  );
	ds_save.SetColumn(0, "NZIB",    ed_nzib.Text  );
	ds_save.SetColumn(0, "SPT",     bstnk );
	
	if(seq == "01") {
		ds_save.SetColumn(0, "SEAL", "C");	
	} else if(seq == "02") {
		ds_save.SetColumn(0, "SEAL", "D");	
	} else if(seq == "03") {
		ds_save.SetColumn(0, "SEAL", "E");	
		// 중지일자 
		ds_save.SetColumn(0, "DCT", gfn_getAfterDate(Replace(cal_duedate.Text, ".", ""), 1) );
	} 
	ds_save.SetColumn(0, "S004", cb_seal.value);	
		
}]]></Script>
</Window>