<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="562" Id="CS4201001A" Left="8" OnLoadCompleted="fn_OnLoadCompleted" OnUnloadCompleted="fn_OnUnloadCompleted" PidAttrib="7" Title="전자우편&#32;발송&#32;관리" Top="8" Ver="1.0" Width="978" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_cond">
				<Contents>
					<colinfo id="PJT" size="256" summ="default" type="STRING"/>
					<colinfo id="VKGRP" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="DAT1" size="256" summ="default" type="STRING"/>
					<colinfo id="DAT2" size="256" summ="default" type="STRING"/>
					<colinfo id="TRANS" size="256" summ="default" type="STRING"/>
					<colinfo id="SEAL" size="256" summ="default" type="STRING"/>
					<colinfo id="RETURN" size="256" summ="default" type="STRING"/>
					<colinfo id="LOG" size="256" summ="default" type="STRING"/>
					<record>
						<DAT1></DAT1>
						<DAT2></DAT2>
						<GBN></GBN>
						<LOG></LOG>
						<PJT></PJT>
						<RETURN></RETURN>
						<SEAL></SEAL>
						<TRANS></TRANS>
						<VKGRP></VKGRP>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list">
				<Contents>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="CON_KEY" size="256" summ="default" type="STRING"/>
					<colinfo id="USR" size="256" summ="default" type="STRING"/>
					<colinfo id="PJT" size="256" summ="default" type="STRING"/>
					<colinfo id="BMT" size="256" summ="default" type="STRING"/>
					<colinfo id="TEM" size="256" summ="default" type="STRING"/>
					<colinfo id="YDT" size="256" summ="default" type="STRING"/>
					<colinfo id="MDT" size="256" summ="default" type="STRING"/>
					<colinfo id="TXT" size="256" summ="default" type="STRING"/>
					<colinfo id="S046" size="256" summ="default" type="STRING"/>
					<colinfo id="S047" size="256" summ="default" type="STRING"/>
					<colinfo id="S048" size="256" summ="default" type="STRING"/>
					<colinfo id="S049" size="256" summ="default" type="STRING"/>
					<colinfo id="S050" size="256" summ="default" type="STRING"/>
					<colinfo id="S051" size="256" summ="default" type="STRING"/>
					<colinfo id="S052" size="256" summ="default" type="STRING"/>
					<colinfo id="S053" size="256" summ="default" type="STRING"/>
					<colinfo id="S054" size="256" summ="default" type="STRING"/>
					<colinfo id="S055" size="256" summ="default" type="STRING"/>
					<colinfo id="S056" size="256" summ="default" type="STRING"/>
					<colinfo id="S057" size="256" summ="default" type="STRING"/>
					<colinfo id="S058" size="256" summ="default" type="STRING"/>
					<colinfo id="S059" size="256" summ="default" type="STRING"/>
					<colinfo id="S060" size="256" summ="default" type="STRING"/>
					<colinfo id="S061" size="256" summ="default" type="STRING"/>
					<colinfo id="S062" size="256" summ="default" type="STRING"/>
					<colinfo id="S063" size="256" summ="default" type="STRING"/>
					<colinfo id="S064" size="256" summ="default" type="STRING"/>
					<colinfo id="S065" size="256" summ="default" type="STRING"/>
					<colinfo id="S066" size="256" summ="default" type="STRING"/>
					<colinfo id="S067" size="256" summ="default" type="STRING"/>
					<colinfo id="S068" size="256" summ="default" type="STRING"/>
					<colinfo id="S069" size="256" summ="default" type="STRING"/>
					<colinfo id="S070" size="256" summ="default" type="STRING"/>
					<colinfo id="S077" size="256" summ="default" type="STRING"/>
					<colinfo id="DELIVRSLTCD" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_gbn_cd">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME>&#32;-&#32;&#32;전체&#32;&#32;-</CODE_NAME>
					</record>
					<record>
						<CODE>A</CODE>
						<CODE_NAME>장기미수</CODE_NAME>
					</record>
					<record>
						<CODE>B</CODE>
						<CODE_NAME>전환안내</CODE_NAME>
					</record>
					<record>
						<CODE>C</CODE>
						<CODE_NAME>지로/CMS</CODE_NAME>
					</record>
					<record>
						<CODE>D</CODE>
						<CODE_NAME>FM&#32;요청서</CODE_NAME>
					</record>
					<record>
						<CODE>F</CODE>
						<CODE_NAME>대금납부&#32;요청서</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_vkgrp_cd">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_trans">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE>A</CODE>
						<CODE_NAME>미전송</CODE_NAME>
					</record>
					<record>
						<CODE>Y</CODE>
						<CODE_NAME>전송</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_seal_cd">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME>&#32;-&#32;&#32;전체&#32;&#32;-</CODE_NAME>
					</record>
					<record>
						<CODE>000</CODE>
						<CODE_NAME>일반</CODE_NAME>
					</record>
					<record>
						<CODE>001</CODE>
						<CODE_NAME>등기</CODE_NAME>
					</record>
					<record>
						<CODE>005</CODE>
						<CODE_NAME>내용증명</CODE_NAME>
					</record>
					<record>
						<CODE>101</CODE>
						<CODE_NAME>준등기</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list1">
				<Contents>
					<colinfo id="CON_KEY" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="S029" size="256" summ="default" type="STRING"/>
					<colinfo id="S030" size="256" summ="default" type="STRING"/>
					<colinfo id="S031" size="256" summ="default" type="STRING"/>
					<colinfo id="S007" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_dlist">
				<Contents>
					<colinfo id="CON_KEY" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list0">
				<Contents>
					<colinfo id="S004" size="256" summ="default" type="STRING"/>
					<colinfo id="CNT_A" size="256" summ="default" type="STRING"/>
					<colinfo id="CNT_B" size="256" summ="default" type="STRING"/>
					<colinfo id="CNT_C" size="256" summ="default" type="STRING"/>
					<colinfo id="CNT_F" size="256" summ="default" type="STRING"/>
					<colinfo id="CNT_H" size="256" summ="default" type="STRING"/>
					<colinfo id="S004_nm" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_log">
				<Contents></Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_bansong">
				<Contents>
					<colinfo id="CON_KEY" size="256" summ="default" type="STRING"/>
					<colinfo id="VKGRP" size="256" summ="default" type="STRING"/>
					<colinfo id="S020" size="256" summ="default" type="STRING"/>
					<colinfo id="S028" size="256" summ="default" type="STRING"/>
					<colinfo id="S077" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_rcond">
				<Contents>
					<colinfo id="ZPROGRAM" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN" size="256" summ="default" type="STRING"/>
					<record>
						<GBN></GBN>
						<ZPROGRAM></ZPROGRAM>
					</record>
				</Contents>
			</Dataset>
		</Datasets>
		<Shape BKColor="user0" Bottom="72" Height="72" Id="Shape0" Left="0" LineColor="user1" Right="976" TabOrder="1" Top="0" Type="Rectangle" Width="976"></Shape>
		<SplitJoint Height="8" Id="SplitJoint0" Left="225" Top="310" Width="8"></SplitJoint>
		<Static Align="Right" Height="20" Id="st_pjt" Left="542" Style="sty_lb_search" TabOrder="3" Text="Proj&#32;No&#32;" Top="8" VAlign="Middle" Width="80"></Static>
		<Edit BindDataset="ds_cond" Border="Flat" Column="PJT" Height="20" Id="ed_pjt" Left="624" MaxLength="6" Style="sty_ipt_search" TabOrder="4" Top="8" UpperOnly="TRUE" Width="82"></Edit>
		<Button Cursor="HAND" Height="18" Id="btn_pjt" ImageID="btn_icon_search" Left="708" OnClick="btn_pjt_OnClick" TabOrder="5" Text="Button0" Top="7" Width="18"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Enable="FALSE" Height="20" Id="btn_create_txt" ImageID="btn_sub_04" Left="880" LeftMargin="12" OnClick="btn_create_txt_OnClick" Style="sty_btn" TabOrder="6" Text="통합전송" Top="24" Width="72"></Button>
		<Static Align="Right" Height="20" Id="st_gbn" Left="326" Style="sty_lb_search" TabOrder="8" Text="구분&#32;" Top="8" VAlign="Middle" Width="80"></Static>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="CODE" Column="GBN" DataColumn="CODE_NAME" Height="20" Id="cb_gbn" INDEX="0" InnerDataset="ds_gbn_cd" Left="408" Style="sty_ipt_search" TabOrder="7" Top="7" Width="120"></Combo>
		<Static Align="Right" Height="20" Id="st_vkgrp" Left="8" Style="sty_lb_search" TabOrder="9" Text="팀&#32;" Top="8" VAlign="Middle" Width="80"></Static>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="CODE" Column="VKGRP" DataColumn="CODE_NAME" Enable="FALSE" Height="20" Id="cb_vkgrp" InnerDataset="ds_vkgrp_cd" Left="89" Style="sty_ipt_search" TabOrder="10" Top="7" Width="102"></Combo>
		<Static Align="Right" Height="20" Id="st_dat" Left="8" Style="sty_lb_search" TabOrder="12" Text="전송일자&#32;" Top="35" VAlign="Middle" Width="80"></Static>
		<Calendar BindDataset="ds_cond" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="DAT1" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_dat1" Left="90" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_search" SundayTextColor="user35" TabOrder="11" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="35" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="100"></Calendar>
		<Static Align="Center" Border="None" Color="user7" Font="굴림,9" Height="20" Id="Static13" Left="193" TabOrder="13" Text="~" Top="37" VAlign="Middle" Width="18"></Static>
		<Calendar BindDataset="ds_cond" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="DAT2" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_dat2" Left="212" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_search" SundayTextColor="user35" TabOrder="14" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="35" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="100"></Calendar>
		<Static Align="Right" Height="20" Id="st_trans" Left="326" Style="sty_lb_search" TabOrder="16" Text="전송여부&#32;" Top="35" VAlign="Middle" Width="80"></Static>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="CODE" Column="TRANS" DataColumn="CODE_NAME" Height="20" Id="cb_trans" INDEX="0" InnerDataset="ds_trans" Left="408" OnChanged="cb_trans_OnChanged" Style="sty_ipt_search" TabOrder="15" Top="34" Width="120"></Combo>
		<Static Align="Right" Height="20" Id="st_seal" Left="542" Style="sty_lb_search" TabOrder="18" Text="취급구분&#32;" Top="35" VAlign="Middle" Width="80"></Static>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="CODE" Column="SEAL" DataColumn="CODE_NAME" Height="20" Id="cb_seal" INDEX="0" InnerDataset="ds_seal_cd" Left="624" Style="sty_ipt_search" TabOrder="17" Top="34" Width="120"></Combo>
		<Grid AutoFitEndLine="Hide" BindDataset="ds_list1" BkColor2="default" BoldHead="true" Border="Flat" Bottom="544" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="336" Id="grd_list1" InputPanel="FALSE" Left="8" LineColor="user20" LineType="ExHORZ" OnCellDBLClick="grd_list1_OnCellDblClick" OnHeadClick="grd_list2_OnHeadClick" Right="968" RowHeight="20" Style="sty_grid" TabOrder="21" TabStop="true" Top="208" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="960">
			<contents>
				<format id="Default">
					<columns>
						<col fix="left" width="25"/>
						<col fix="left" width="40"/>
						<col fix="left" width="60"/>
						<col fix="left" width="80"/>
						<col fix="left" width="70"/>
						<col fix="left" width="70"/>
						<col fix="left" width="60"/>
						<col fix="left" width="100"/>
						<col fix="left" width="100"/>
						<col fix="left" width="120"/>
						<col fix="left" width="100"/>
						<col width="60"/>
						<col width="80"/>
						<col width="80"/>
						<col width="200"/>
						<col width="55"/>
						<col width="300"/>
						<col width="70"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="70"/>
						<col width="70"/>
						<col width="70"/>
						<col width="70"/>
						<col width="70"/>
						<col width="70"/>
						<col width="200"/>
					</columns>
					<head>
						<cell col="0" display="checkbox" edit="checkbox" font="굴림,9"/>
						<cell align="center" col="1" color="user21" display="text" font="굴림,9" text="No"/>
						<cell align="center" col="2" color="user21" display="text" font="굴림,9"/>
						<cell align="center" col="3" color="user21" display="text" font="굴림,9" text="구분"/>
						<cell align="center" col="4" color="user21" display="text" font="굴림,9" text="작성일자"/>
						<cell align="center" col="5" color="user21" display="text" font="굴림,9" text="작성시간"/>
						<cell align="center" col="6" color="user21" display="text" font="굴림,9" text="작성자"/>
						<cell align="center" col="7" color="user21" display="text" font="굴림,9" text="팀"/>
						<cell align="center" col="8" color="user21" display="text" font="굴림,9" text="협력업체"/>
						<cell align="center" col="9" color="user21" display="text" font="굴림,9" text="PJT"/>
						<cell align="center" col="10" color="user21" display="text" font="굴림,9" text="현장명"/>
						<cell align="center" col="11" color="user21" display="text" font="굴림,9" text="취급구분"/>
						<cell align="center" col="12" color="user21" display="text" font="굴림,9" text="등기번호"/>
						<cell align="center" col="13" color="user21" display="text" font="굴림,9" text="고객코드"/>
						<cell align="center" col="14" color="user21" display="text" font="굴림,9" text="수취인명"/>
						<cell align="center" col="15" color="user21" display="text" font="굴림,9" text="우편번호"/>
						<cell align="center" col="16" color="user21" display="text" font="굴림,9" text="주소"/>
						<cell align="center" col="17" color="user21" display="text" font="굴림,9" text="전송일자"/>
						<cell align="center" col="18" color="user21" display="text" font="굴림,9" text="전송시간"/>
						<cell align="center" col="19" color="user21" display="text" font="굴림,9" text="전송작업자"/>
						<cell align="center" col="20" color="user21" display="text" font="굴림,9" text="제작결과"/>
						<cell align="center" col="21" color="user21" display="text" font="굴림,9" text="제작일자"/>
						<cell align="center" bkcolor="user1" col="22" color="user21" display="text" font="굴림,9" text="배달결과"/>
						<cell align="center" bkcolor="user1" col="23" color="user21" display="text" font="굴림,9" text="배달일자"/>
						<cell align="center" bkcolor="user13" col="24" color="user21" display="text" font="굴림,9" text="반송처리일"/>
						<cell align="center" bkcolor="user13" col="25" color="user21" display="text" font="굴림,9" text="반송사유"/>
						<cell align="center" bkcolor="user13" col="26" color="user21" display="text" font="굴림,9" text="처리결과"/>
						<cell align="center" col="27" color="user21" display="text" font="굴림,9" text="CON_KEY"/>
					</head>
					<body>
						<cell align="center" bkcolor2="user22" col="0" colid="CHK" display='expr:iif(TRANS&#32;==&#32;&apos;&apos;&#32;||&#32;(BANSONG&#32;==&#32;&apos;X&apos;&amp;&amp;G_USER_ID==&quot;2021200&quot;),&#32;&apos;checkbox&apos;,&#32;&apos;none&apos;)' edit='expr:iif(TRANS&#32;==&#32;&apos;&apos;&#32;||&#32;(BANSONG&#32;==&#32;&apos;X&apos;&amp;&amp;G_USER_ID==&quot;2021200&quot;),&#32;&apos;checkbox&apos;,&#32;&apos;none&apos;)'/>
						<cell align="center" bkcolor2="user22" col="1" display="text" expr="currow+1"/>
						<cell align="center" bkcolor2="user22" bkimageid="btn_grid_01" col="2" display="text" text="미리보기"/>
						<cell align="center" bkcolor2="user22" col="3" colid="S007_NM" display="text"/>
						<cell align="center" bkcolor2="user22" col="4" colid="MDT" display="text" Mask="####.##.##"/>
						<cell align="center" bkcolor2="user22" col="5" colid="MTM" display="text" Mask="##:##:##"/>
						<cell align="center" bkcolor2="user22" col="6" colid="MID_NM" display="text"/>
						<cell align="center" bkcolor2="user22" col="7" colid="VKGRP_NM" display="text"/>
						<cell align="center" bkcolor2="user22" col="8" colid="LNAME" display="text"/>
						<cell align="center" bkcolor2="user22" col="9" colid="S077" display="text"/>
						<cell align="left" bkcolor2="user22" col="10" colid="BSTNK" display="text"/>
						<cell align="center" bkcolor2="user22" col="11" colid="S004_NM" display="text"/>
						<cell align="center" bkcolor="user1" col="12" colid="S033" display="text"/>
						<cell align="center" bkcolor2="user22" col="13" colid="KUNNR" display="text"/>
						<cell align="left" bkcolor2="user22" col="14" colid="S029" display="text"/>
						<cell align="center" bkcolor2="user22" col="15" colid="S030" display="text"/>
						<cell align="left" bkcolor2="user22" col="16" colid="S031" display="text"/>
						<cell align="center" bkcolor2="user22" col="17" colid="TDT" display="text" Mask="####.##.##"/>
						<cell align="center" bkcolor2="user22" col="18" colid="TTM" display="text" Mask="##:##:##"/>
						<cell align="center" bkcolor2="user22" col="19" colid="TID_NM" display="text"/>
						<cell align="center" bkcolor2="user22" col="20" colid="DATA_CD_NM" display="text"/>
						<cell align="center" bkcolor2="user22" col="21" colid="DATA_CDATE" display="text" Mask="####.##.##"/>
						<cell align="center" bkcolor2="user22" col="22" colid="DELIVRSLTCD" display="text"/>
						<cell align="center" bkcolor2="user22" col="23" colid="DELIVYMD" display="text" Mask="####.##.##"/>
						<cell align="center" bkcolor2="user22" col="24" colid="CDATE" display="text" Mask="####.##.##"/>
						<cell align="center" bkcolor2="user22" col="25" colid="RETURNCD_NM" display="text"/>
						<cell align="center" bkcolor2="user22" col="26" colid="RTEXT" display="text"/>
						<cell align="left" bkcolor2="user22" col="27" colid="S020" display="text"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_upload" ImageID="btn_user_06" Left="760" OnClick="btn_upload_OnClick" Style="sty_btn" TabOrder="19" Text="반송정보" Top="24" Transparent="TRUE" Visible="FALSE" Width="89"></Button>
		<Checkbox BindDataset="ds_cond" BKColor="user0" Column="RETURN" Height="22" Id="chk_return" Left="760" TabOrder="20" Text="반송&#32;조회" Value="FALSE" Width="88"></Checkbox>
		<Static Align="Center" Border="Flat" BorderColor="user13" Height="20" Id="Static14" Left="7" Style="sty_lb_form_basic" TabOrder="23" Text="우편발송건수" Top="75" VAlign="Middle" Width="97"></Static>
		<MaskEdit Border="Flat" DecimalLen="0" Enable="FALSE" Height="20" Id="med_000_a" Left="103" Style="sty_ipt_form" TabOrder="22" TabStop="FALSE" Top="94" Width="97"></MaskEdit>
		<Static Align="Center" Border="Flat" BorderColor="user13" Height="20" Id="st_a" Left="103" Style="sty_lb_form_basic" TabOrder="24" Text="지로" Top="75" VAlign="Middle" Width="97"></Static>
		<Static Align="Center" Border="Flat" BorderColor="user13" Height="20" Id="st_b" Left="199" Style="sty_lb_form_basic" TabOrder="25" Text="CMS" Top="75" VAlign="Middle" Width="97"></Static>
		<Static Align="Center" Border="Flat" BorderColor="user13" Height="20" Id="st_c" Left="295" Style="sty_lb_form_basic" TabOrder="26" Text="장기미수" Top="75" VAlign="Middle" Width="97"></Static>
		<Static Align="Center" Border="Flat" BorderColor="user13" Height="20" Id="st_f" Left="391" Style="sty_lb_form_basic" TabOrder="27" Text="전환안내" Top="75" VAlign="Middle" Width="97"></Static>
		<Static Align="Center" BKColor="user1" Border="Flat" BorderColor="user13" Height="20" Id="Static3" Left="583" Style="sty_lb_form_basic" TabOrder="28" Text="계" Top="75" VAlign="Middle" Width="97"></Static>
		<Static Align="Center" Border="Flat" BorderColor="user13" Height="20" Id="st_000" Left="7" Style="sty_lb_form_basic" TabOrder="29" Text="일반" Top="94" VAlign="Middle" Width="97"></Static>
		<Static Align="Center" Border="Flat" BorderColor="user13" Height="20" Id="st_001" Left="7" Style="sty_lb_form_basic" TabOrder="30" Text="등기" Top="113" VAlign="Middle" Width="97"></Static>
		<Static Align="Center" Border="Flat" BorderColor="user13" Height="20" Id="st_005" Left="7" Style="sty_lb_form_basic" TabOrder="31" Text="내용증명" Top="132" VAlign="Middle" Width="97"></Static>
		<Static Align="Center" BKColor="user1" Border="Flat" BorderColor="user13" Height="20" Id="Static7" Left="7" Style="sty_lb_form_basic" TabOrder="32" Text="계" Top="170" VAlign="Middle" Width="97"></Static>
		<MaskEdit Border="Flat" DecimalLen="0" Enable="FALSE" Height="20" Id="med_000_b" Left="199" Style="sty_ipt_form" TabOrder="33" TabStop="FALSE" Top="94" Width="97"></MaskEdit>
		<MaskEdit Border="Flat" DecimalLen="0" Enable="FALSE" Height="20" Id="med_000_c" Left="295" Style="sty_ipt_form" TabOrder="34" TabStop="FALSE" Top="94" Width="97"></MaskEdit>
		<MaskEdit Border="Flat" DecimalLen="0" Enable="FALSE" Height="20" Id="med_000_f" Left="391" Style="sty_ipt_form" TabOrder="35" TabStop="FALSE" Top="94" Width="97"></MaskEdit>
		<MaskEdit Border="Flat" DecimalLen="0" Enable="FALSE" Height="20" Id="med_000_s" Left="583" Style="sty_ipt_form" TabOrder="36" TabStop="FALSE" Top="94" Width="97"></MaskEdit>
		<MaskEdit Border="Flat" DecimalLen="0" Enable="FALSE" Height="20" Id="med_001_a" Left="103" Style="sty_ipt_form" TabOrder="37" TabStop="FALSE" Top="113" Width="97"></MaskEdit>
		<MaskEdit Border="Flat" DecimalLen="0" Enable="FALSE" Height="20" Id="med_001_b" Left="199" Style="sty_ipt_form" TabOrder="38" TabStop="FALSE" Top="113" Width="97"></MaskEdit>
		<MaskEdit Border="Flat" DecimalLen="0" Enable="FALSE" Height="20" Id="med_001_c" Left="295" Style="sty_ipt_form" TabOrder="39" TabStop="FALSE" Top="113" Width="97"></MaskEdit>
		<MaskEdit Border="Flat" DecimalLen="0" Enable="FALSE" Height="20" Id="med_001_s" Left="583" Style="sty_ipt_form" TabOrder="41" TabStop="FALSE" Top="113" Width="97"></MaskEdit>
		<MaskEdit Border="Flat" DecimalLen="0" Enable="FALSE" Height="20" Id="med_001_f" Left="391" Style="sty_ipt_form" TabOrder="40" TabStop="FALSE" Top="113" Width="97"></MaskEdit>
		<MaskEdit Border="Flat" DecimalLen="0" Enable="FALSE" Height="20" Id="med_005_a" Left="103" Style="sty_ipt_form" TabOrder="42" TabStop="FALSE" Top="132" Width="97"></MaskEdit>
		<MaskEdit Border="Flat" DecimalLen="0" Enable="FALSE" Height="20" Id="med_005_b" Left="199" Style="sty_ipt_form" TabOrder="43" TabStop="FALSE" Top="132" Width="97"></MaskEdit>
		<MaskEdit Border="Flat" DecimalLen="0" Enable="FALSE" Height="20" Id="med_005_c" Left="295" Style="sty_ipt_form" TabOrder="44" TabStop="FALSE" Top="132" Width="97"></MaskEdit>
		<MaskEdit Border="Flat" DecimalLen="0" Enable="FALSE" Height="20" Id="med_005_s" Left="583" Style="sty_ipt_form" TabOrder="46" TabStop="FALSE" Top="132" Width="97"></MaskEdit>
		<MaskEdit Border="Flat" DecimalLen="0" Enable="FALSE" Height="20" Id="med_005_f" Left="391" Style="sty_ipt_form" TabOrder="45" TabStop="FALSE" Top="132" Width="97"></MaskEdit>
		<MaskEdit BKColor="user1" Border="Flat" DecimalLen="0" Enable="FALSE" Height="20" Id="med_a_s" Left="103" Style="sty_ipt_form" TabOrder="47" TabStop="FALSE" Top="170" Width="97"></MaskEdit>
		<MaskEdit Border="Flat" DecimalLen="0" Enable="FALSE" Height="20" Id="med_b_s" Left="199" Style="sty_ipt_form" TabOrder="48" TabStop="FALSE" Top="170" Width="97"></MaskEdit>
		<MaskEdit Border="Flat" DecimalLen="0" Enable="FALSE" Height="20" Id="med_c_s" Left="295" Style="sty_ipt_form" TabOrder="49" TabStop="FALSE" Top="170" Width="97"></MaskEdit>
		<MaskEdit Border="Flat" DecimalLen="0" Enable="FALSE" Height="20" Id="med_ss" Left="583" Style="sty_ipt_form" TabOrder="51" TabStop="FALSE" Top="170" Width="97"></MaskEdit>
		<MaskEdit Border="Flat" DecimalLen="0" Enable="FALSE" Height="20" Id="med_f_s" Left="391" Style="sty_ipt_form" TabOrder="50" TabStop="FALSE" Top="170" Width="97"></MaskEdit>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_updateVkgrp" ImageID="btn_sub_04" Left="880" LeftMargin="12" OnClick="btn_updateVkgrp_OnClick" Style="sty_btn" TabOrder="52" Text="팀변경" Visible="FALSE" Width="72"></Button>
		<Checkbox BKColor="user0" Height="16" Id="cb_fail" Left="760" OnClick="cb_fail_OnClick" TabOrder="53" Text="제작미완료" Top="48" Value="FALSE" Width="88"></Checkbox>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_url" ImageID="btn_sub_04" Left="848" LeftMargin="12" OnClick="btn_url_OnClick" Style="sty_btn" TabOrder="54" Text="수신여부" Top="80" Transparent="TRUE" Width="72"></Button>
		<Edit Align="RIGHT" Border="Flat" Height="20" Id="ed_rowcnt" Left="848" MaxLength="6" Number="TRUE" Style="sty_ipt_search" TabOrder="55" Top="144" UpperOnly="TRUE" Visible="FALSE" Width="40"></Edit>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_rowcnt" ImageID="btn_sub_04" Left="896" LeftMargin="12" OnClick="btn_rowcnt_OnClick" Style="sty_btn" TabOrder="56" Text="체크선택" Top="144" Visible="FALSE" Width="71"></Button>
		<Static Align="Center" Border="Flat" BorderColor="user13" Height="20" Id="st_101" Left="7" Style="sty_lb_form_basic" TabOrder="57" Text="준등기" Top="151" VAlign="Middle" Width="97"></Static>
		<MaskEdit Border="Flat" DecimalLen="0" Enable="FALSE" Height="20" Id="med_101_a" Left="103" Style="sty_ipt_form" TabOrder="58" TabStop="FALSE" Top="151" Width="97"></MaskEdit>
		<MaskEdit Border="Flat" DecimalLen="0" Enable="FALSE" Height="20" Id="med_101_b" Left="199" Style="sty_ipt_form" TabOrder="59" TabStop="FALSE" Top="151" Width="97"></MaskEdit>
		<MaskEdit Border="Flat" DecimalLen="0" Enable="FALSE" Height="20" Id="med_101_c" Left="295" Style="sty_ipt_form" TabOrder="60" TabStop="FALSE" Top="151" Width="97"></MaskEdit>
		<MaskEdit Border="Flat" DecimalLen="0" Enable="FALSE" Height="20" Id="med_101_f" Left="391" Style="sty_ipt_form" TabOrder="61" TabStop="FALSE" Top="151" Width="97"></MaskEdit>
		<MaskEdit Border="Flat" DecimalLen="0" Enable="FALSE" Height="20" Id="med_101_s" Left="583" Style="sty_ipt_form" TabOrder="62" TabStop="FALSE" Top="151" Width="97"></MaskEdit>
		<Static Align="Center" Border="Flat" BorderColor="user13" Height="20" Id="st_h" Left="487" Style="sty_lb_form_basic" TabOrder="63" Text="대금납부요청" Top="75" VAlign="Middle" Width="97"></Static>
		<MaskEdit Border="Flat" DecimalLen="0" Enable="FALSE" Height="20" Id="med_000_h" Left="487" Style="sty_ipt_form" TabOrder="64" TabStop="FALSE" Top="94" Width="97"></MaskEdit>
		<MaskEdit Border="Flat" DecimalLen="0" Enable="FALSE" Height="20" Id="med_001_h" Left="487" Style="sty_ipt_form" TabOrder="65" TabStop="FALSE" Top="113" Width="97"></MaskEdit>
		<MaskEdit Border="Flat" DecimalLen="0" Enable="FALSE" Height="20" Id="med_101_h" Left="487" Style="sty_ipt_form" TabOrder="68" TabStop="FALSE" Top="151" Width="97"></MaskEdit>
		<MaskEdit Border="Flat" DecimalLen="0" Enable="FALSE" Height="20" Id="med_005_h" Left="487" Style="sty_ipt_form" TabOrder="66" TabStop="FALSE" Top="132" Width="97"></MaskEdit>
		<MaskEdit Border="Flat" DecimalLen="0" Enable="FALSE" Height="20" Id="med_h_s" Left="487" Style="sty_ipt_form" TabOrder="67" TabStop="FALSE" Top="170" Width="97"></MaskEdit>
	</Form>
	<Script><![CDATA[﻿﻿﻿﻿﻿﻿﻿﻿/*
 ******************************************************************************************
 * 기      능   : 발송관리
 * 작  성  자   : 이하림
 * 작성  일자   : 20150512
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
#include "LIB::commons.js";	// 공통 스크립트 
#include "LIB::common_cs.js";	// 서비스 공통 스크립트
//=========================================================================================
// [ PART 1 ]
// Form에서 사용될 전역변수를 선언
// FORM에서 사용되는 전역변수는 대문자로 작성하며, F_XXX 의 형태를 갖도록 한다. 
//=========================================================================================
var flag_chk = false;
var vBtn_auth = false;
var vFlag_chk = false;
//=========================================================================================
// [ PART 2 ]
// Form Loading / Unloading 시 작업 정의
//=========================================================================================
function fn_OnLoadCompleted(obj) {
	gfn_initForm(true);	
	
	cal_dat1.Value = substr(gfn_getCurrDate(),0,6) + "01";
	cal_dat2.Value = gfn_getLeapLastDay(gfn_getCurrDate()); // 당월 마지막 일자 가져오기
	cb_fail.Enable = false;

	//===================팀변경, 체크선택 버튼 권한 설정
	//G_USER_ID in ("2021200","2018900","2029758","2999999")
	gfn_initDs(ds_rcond, true);
	ds_rcond.SetColumn(0, "ZPROGRAM", "CS4201001A");
	ds_rcond.SetColumn(0, "GBN", "01");	
	vBtn_auth = gfn_getAuth(ds_rcond);
	ds_rcond.ClearData();
	//================통합전송버튼 활성화 조건 권한 설정
	//G_USER_ID in ("2019523","2021200","2023687","2016869","2018900","2029758","2999999")
	gfn_initDs(ds_rcond, true);
	ds_rcond.SetColumn(0, "ZPROGRAM", "CS4201001A");
	ds_rcond.SetColumn(0, "GBN", "02");	
	vFlag_chk = gfn_getAuth(ds_rcond);
	ds_rcond.ClearData();
	//==================================================
	//지사 콤보 리스트 가져오기
	var codeArr = ["VKGRP"];
    var dsObjArr = [ds_vkgrp_cd];
    var addTypeArr = [G_CODE_ALL];
    gfn_searchCommCode(codeArr, dsObjArr, addTypeArr);

}

/********************************************************************************
* 기      능   : 공통코드가 조회된 후의 Callback 함수 
********************************************************************************/
function fn_completeInit(sCode, sDsObj, sCodeType) 
{
	// 서비스 본부 팀코드 가져오기
	//ds_vkgrp_cd.Filter("(CODE ='') OR (CODE >= 'E97' AND CODE <= 'EFP')");
	// Major, Metro 조회되도록 처리. 2020.02.14 Han J.H
	ds_vkgrp_cd.Filter("(CODE ='') OR (left(CODE,1) == 'E') AND (CODE != 'EH1') AND (CODE != 'EJ1')");
	cb_vkgrp.Index = ds_vkgrp_cd.FindRow("CODE", G_SAP_USER_VGCD);
	cb_trans.index = 0;
//	btn_query.enable = false; // 조회 비활성화
	var user_grp = gfn_getUserGroup();
	// 전체 조회 가능 
	if(user_grp == "40"){
		// Major, Metro 조회되도록 처리. 2020.02.14 Han J.H
		//ds_vkgrp_cd.Filter("(CODE ='') OR (CODE >= 'E97' AND CODE <= 'EFP')");
		cb_vkgrp.Index = 0;
		cb_vkgrp.Enable = true;
		btn_upload.Visible = true;
//		btn_query.enable = true; // 조회 비활성화
	}

	//if(G_USER_ID == "2021200" or G_USER_ID == "2018900" or G_USER_ID == "2029758" or G_USER_ID == "2999999") {
	if (vBtn_auth == true)
	{
		btn_updateVkgrp.Visible = true;
		ed_rowcnt.Visible = true;
		btn_rowcnt.Visible = true;
	}
}
/********************************************************************************
* 기      능   : form UnloadCompleted 
********************************************************************************/
function fn_OnUnloadCompleted(obj) {
	return gfn_isFormUnload(obj);
}
//=========================================================================================
// [ PART 3 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,form닫기)
//=========================================================================================
/********************************************************************************
* 기      능   : 조회 1
********************************************************************************/
function fn_query() {

	ds_list.ClearData();
	ds_list1.ClearData();
	ds_log.ClearData();

	//progressbar
	
	var sql_list1 = "";
	if(cb_trans.Value == "A") {
		// 전자우편 지로 생성 작업 체크	
		fn_checkLog();
		if(ds_log.RowCount() >= 1) {	
			gfn_openPopup("CS4201001G",true);
			return false;	
		}
		// 수신 주소 개행문자 제거 하기
		fn_modAdress();

		tit_clearActionInfo();		
		sql_list1 = "cs42:CS4201001A_S1"; //display
	// 미전송 , 팀코드 필수 , 구분 전체 , 취급구분 전체 일때만 전송 버튼 활성화
	// con_key  및 수취인 순번 생성 시 필요 요소 
		if(cb_trans.Value == "A"   and cb_seal.Value == "" ) {
			flag_chk = true;
		} else {
			flag_chk = false;
			// 윤아로 이하림 용아름 신은정
			//if(G_USER_ID == "2019523" or G_USER_ID == "2021200" or G_USER_ID == "2023687" or 
			//   G_USER_ID == "2016869" or G_USER_ID == "2018900" or G_USER_ID == "2029758" or G_USER_ID == "2999999"){ 
			if (vFlag_chk == true)
			{
				flag_chk = true;
			}
		}
	} else {
		flag_chk = false;
		tit_clearActionInfo();	
		sql_list1 = "cs42:CS4201001A_S2"; // 전송 data
	}
	// 반송 데이타 조회 추가 201606
	if(chk_return.Value == true) {
		sql_list1 = "cs42:CS4201001A_S5";
	}
	
	tit_addSearchActionInfo(sql_list1);
	tit_addSearchActionInfo("cs42:CS4201001A_S3"); //display
	fn_createWait("", this);	
	tit_callService(
		""
		, ""
		, "ds_cond=ds_cond"
		, "ds_list=ds_list ds_list1=ds_list1 ds_list0=ds_list0"
		, ""
		, "fn_afterQuery");
}
/********************************************************************************
* 기      능   : 수신처 주소 개행문자 제거 하기
********************************************************************************/
function fn_modAdress() {

	tit_clearActionInfo();
	tit_addSearchActionInfo("cs42:CS4201001A_U4"); 
	tit_addSearchActionInfo("cs42:CS4201001A_U5"); 
	tit_callService("", "", "ds_cond=ds_cond", "", "", "", true, false,true);

}
/********************************************************************************
* 기      능   : 작업 로그 체크 zcst704
********************************************************************************/
function fn_checkLog() {

	ds_cond.SetColumn(0, "LOG", "A");
	
	tit_clearActionInfo();																	
	tit_addSearchActionInfo("cs42:CS4201001A_S4");									
	tit_callService(		
			""
			, ""							
			, "ds_cond=ds_cond"							
			, "ds_log=ds_log"							
			, ""							
			, ""							
			, true							
			, false							
			, true); 
}
/********************************************************************************
* 기      능   : 닫기  
********************************************************************************/
function fn_close() {
	close();
}

//=========================================================================================
// [ PART 4]
// Callback 함수 정의 : callback 함수명은 메인 함수의 fn_xxxx() 에서 xxxx 부분은 fn_afterXXXX()
// 형태가 되도록 작성 
//=========================================================================================
/********************************************************************************
* 기      능   : 조회 Callback  
********************************************************************************/
function fn_afterQuery(errCode, errMsg) {
	gfn_showMsg("CI00002",ds_list1.RowCount()+"");
	fn_destroyWait();
	if(ds_list1.RowCount() != 0 and flag_chk == true ){
		flag_chk = true;
		btn_create_txt.Enable = true;
	} else {
		btn_create_txt.Enable = false;
	}
	
	// 요약표 셋팅
	fn_setSummary();
}
function fn_setSummary() {

	med_000_a.Value = ds_list0.GetColumn(0,"CNT_A");
	med_000_b.Value = ds_list0.GetColumn(0,"CNT_B");
	med_000_c.Value = ds_list0.GetColumn(0,"CNT_C");
	med_000_f.Value = ds_list0.GetColumn(0,"CNT_F");
	med_000_s.Value = ds_list0.GetColumn(0,"CNT_S");
	med_000_h.Value = ds_list0.GetColumn(0,"CNT_H");
	
	med_001_a.Value = ds_list0.GetColumn(1,"CNT_A");
	med_001_b.Value = ds_list0.GetColumn(1,"CNT_B");
	med_001_c.Value = ds_list0.GetColumn(1,"CNT_C");
	med_001_f.Value = ds_list0.GetColumn(1,"CNT_F");
	med_001_s.Value = ds_list0.GetColumn(1,"CNT_S");
	med_001_h.Value = ds_list0.GetColumn(1,"CNT_H");
	
	med_005_a.Value = ds_list0.GetColumn(2,"CNT_A");
	med_005_b.Value = ds_list0.GetColumn(2,"CNT_B");
	med_005_c.Value = ds_list0.GetColumn(2,"CNT_C");
	med_005_f.Value = ds_list0.GetColumn(2,"CNT_F");
	med_005_s.Value = ds_list0.GetColumn(2,"CNT_S");
	med_005_h.Value = ds_list0.GetColumn(2,"CNT_H");
	
	med_101_a.Value = ds_list0.GetColumn(3,"CNT_A");
	med_101_b.Value = ds_list0.GetColumn(3,"CNT_B");
	med_101_c.Value = ds_list0.GetColumn(3,"CNT_C");
	med_101_f.Value = ds_list0.GetColumn(3,"CNT_F");
	med_101_s.Value = ds_list0.GetColumn(3,"CNT_S");
	med_101_h.Value = ds_list0.GetColumn(3,"CNT_H");

	med_a_s.Value = parseInt(med_000_a.Value) + parseInt(med_001_a.Value) + parseInt(med_005_a.Value) + parseInt(med_101_a.Value);
	med_b_s.Value = parseInt(med_000_b.Value) + parseInt(med_001_b.Value) + parseInt(med_005_b.Value) + parseInt(med_101_b.Value);
	med_c_s.Value = parseInt(med_000_c.Value) + parseInt(med_001_c.Value) + parseInt(med_005_c.Value) + parseInt(med_101_c.Value);
	med_f_s.Value = parseInt(med_000_f.Value) + parseInt(med_001_f.Value) + parseInt(med_005_f.Value) + parseInt(med_101_f.Value);
	med_h_s.Value = parseInt(med_000_h.Value) + parseInt(med_001_h.Value) + parseInt(med_005_h.Value) + parseInt(med_101_h.Value);
	med_ss.Value  = parseInt(med_000_s.Value) + parseInt(med_001_s.Value) + parseInt(med_005_s.Value) + parseInt(med_101_s.Value);

}
//=========================================================================================
// [ PART 5 ]
// Detail Process Event 정의 ( User Define function )
// 사용자 정의 함수는 ufn_xxxx() 형태로 작성 
//=========================================================================================
/********************************************************************************
* 기      능   : 사용자 정의 함수  
********************************************************************************/
function grd_list_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
{
	gfn_sortGrid(obj,nCell);
}

/********************************************************************************
* 기      능   : 엑셀
********************************************************************************/
function fn_excel() {
	gfn_saveToExcel(grd_list1, true, , , , true); /*HEADER 포함하여 출력*/
}


function btn_pjt_OnClick(obj)
{
	var arg = "pjt="+quote(ed_pjt.Text);
	gfn_openPopup("CS9601002A",true,arg);
}


/********************************************************************************
* 기      능   : 통합 전송
********************************************************************************/
function btn_create_txt_OnClick(obj)
{
	// if(G_USER_ID != "2021200") {
	
	// alert("프로그램 보완작업으로 인해 금일 오후 6시 이후부터 사용가능합니다. 문의 정보기술부 이하림");
	// return false;
	
	// }

	if(ds_list1.RowCount() == 0) {
		gfn_showAlert("전송할 데이타가 없습니다.");
		return;
	}
	
	for(var i=0; i<ds_list1.RowCount(); i++) {
		ds_list1.SetColumn(i, "CHK",  true); 
	}
	
	
	for(var i=0; i<ds_list1.RowCount(); i++) {
		if(ds_list1.GetColumn(i, "CHK") == true) {
			
			// if(substr(ds_list1.GetColumn(i, "S007"),2,1) != "A" and substr(ds_list1.GetColumn(i, "S007"),2,1) != "B" ){
				// gfn_showAlert(" 공문 발송이 불가능합니다. 서비스 관리부에 문의 바랍니다.");
				// return false;
			// }
			// if(G_USER_ID != "2021200") {
				// if(ds_list1.GetColumn(i, "S004") == "101"  ){
					// gfn_showAlert(" 준등기 서비스 오픈 전 입니다.");
					// return false;
				// }	
			// }
		
			/*  수취인 오류 시 포스토피아 출력 불가  */	
			if(length(trim(ds_list1.GetColumn(i, "S029"))) == 0 ){
				gfn_showAlert(i + 1 + " 번째 행의 수취인명 정보가 누락되었습니다.");
				return false;	
			}
			// 수취인명 확인 2 
			var chk_s029 = ds_list1.GetColumn(i, "S029") ;
			chk_s029 = replace(chk_s029, ".","");
			chk_s029 = replace(chk_s029, "-","");
			
			if(length(trim(chk_s029)) == 0 ){
				gfn_showAlert(i + 1  + " 번째 행의 수취인 우편번호 정보가 누락되었습니다.");
				return false;	
			}
			/*  주소 오류 시 포스토피아 출력 불가  */
			/*  .. 혹은 공란인 경우 발송 불가 처리 */
			
			if(length(trim(ds_list1.GetColumn(i, "S031"))) == 0 ){
				gfn_showAlert(i + 1  + " 번째 행의 수취인 주소 정보가 누락되었습니다.");
				return false;	
			}
			// 주소 확인 2 
			var address = ds_list1.GetColumn(i, "S031");
			address = replace(address,".","");
			address = replace(address,"-","");
			
			if(length(trim(address)) == 0 ){
				gfn_showAlert(i + 1  + " 번째 행의 수취인 주소 정보가 누락되었습니다.");
				return false;	
			}
			/*  주소 오류 시 포스토피아 출력 불가  */
			
			
			if(trim(ds_list1.GetColumn(i, "S030")) == "000000" ){
				gfn_showAlert(i + 1  + " 번째 행의 수취인 우편번호 정보가 누락되었습니다.");
				return false;	
			}
			if(parseInt(ds_list1.GetColumn(i, "S030")) == 0 ){
				gfn_showAlert(i + 1  + " 번째 행의 수취인 우편번호 정보가 누락되었습니다.");
				return false;	
			}
			var post_chk = ds_list1.GetColumn(i,"S030");
			post_chk = replace(post_chk , " ", "");
			post_chk = replace(post_chk , "_", "");
			post_chk = replace(post_chk , "-", "");
			post_chk = replace(post_chk , "00000", "");
			if(length(post_chk) < 5) {
				gfn_showAlert(i + 1  + " 번째 행의 수취인 우편번호 정보를 확인하십시오.");	
				return false;	
			}
			
			// 전자우편 필수 항목 체크
			// 현장명이 없는 경우임
			// 수주문서의 현장명과 통합거래선의 현장명을 확인해야함
			// 해당 내역을 삭제하고 재작성해야 함.
			if(length(trim(ds_list1.GetColumn(i, "BSTNK"))) == 0 ){
				gfn_showAlert( ds_list1.GetColumn(i, "S077")+" 지로/CMS 정보가 없습니다." + "\n" + "\n" 
				            + "(미리보기 확인)"
				            + "삭제 후 다시 작업하세요.");
				return false;	
			}
			
		}
	}

	if(!gfn_showConfirm("통합발송 처리를 하시겠습니까? ")) return;
	//통합발송 버튼 비활성화 
	btn_create_txt.Enable = false ;
	//progressbar
	fn_createWait("", this);	
	
	tit_callService(
        "CS4201001A_ACT"
        , "create"
        , "ds_list=ds_list1"
        , ""
        , ""
        , "fn_afterSave");	
}
function fn_afterSave(errCode, errMsg) {
	if(errCode != 0) {
		gfn_showMsg("CE00001");
	} else {
		gfn_showMsg("CI00003");
		gfn_showAlert("전송이 완료되었습니다.");
		fn_destroyWait();
		fn_query();
	}
}


function grd_list1_OnCellDblClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{ 
	var vColId = grd_list1.GetCellProp("BODY",nCell, "COLID");
	var arg    = "";
	if(nCell == 1 or nCell == 2) {
		var arg = "con_key="+quote(ds_list1.GetColumn(nRow, "CON_KEY"));
		if(substr(ds_list1.GetColumn(nRow,"S007"),2,1) == "A") {
			gfn_openPopup("CS4201002A",true,arg);	
		} else if(substr(ds_list1.GetColumn(nRow,"S007"),2,1) == "B") {
			gfn_openPopup("CS4201003A", true, arg);
		} else if(substr(ds_list1.GetColumn(nRow,"S007"),2,1) == "C") {
			if(ds_list1.GetColumn(nRow,"MDT") < "20160301") {
				gfn_openPopup("CS4201004A", true, arg);
			} else {
				gfn_openPopup("CS4201004B", true, arg);
			}
		} else if(substr(ds_list1.GetColumn(nRow,"S007"),2,1) == "D") {
			if(ds_list1.GetColumn(nRow,"MDT") < "20160301") {
				gfn_openPopup("CS4201005A", true, arg);
			} else {
				gfn_openPopup("CS4201005B", true, arg);
			}
		} else if(substr(ds_list1.GetColumn(nRow,"S007"),2,1) == "E") {
			if(ds_list1.GetColumn(nRow,"MDT") < "20160301") {
				gfn_openPopup("CS4201006A", true, arg);
			} else {
				gfn_openPopup("CS4201006B", true, arg);
			}
		} else if(substr(ds_list1.GetColumn(nRow,"S007"),2,1) == "F") {
			if(ds_list1.GetColumn(nRow,"MDT") < "20160301") {
				gfn_openPopup("CS4201007A", true, arg);
			} else {
				gfn_openPopup("CS4201007B", true, arg);
			}
		} else if(substr(ds_list1.GetColumn(nRow,"S007"),2,1) == "G") {
			gfn_openPopup("CS4201008A", true, arg);
		} else if(substr(ds_list1.GetColumn(nRow,"S007"),2,1) == "H") {
			gfn_openPopup("CS4201009A", true, arg);
		} 
	}
	//등기번호 더블클릭 시 등기배달결과
	//if(nCell = 12 && ds_list1.GetColumn(nRow, "S033") != "NULL") {
	if (vColId == "S033" && ds_list1.GetColumn(nRow, "S033") != "NULL") {
		arg = "con_key="+quote(ds_list1.GetColumn(nRow, "CON_KEY"))
		    + " s033="  +quote(ds_list1.GetColumn(nRow, "S033"));
		gfn_openPopup("CS4201001B", true, arg);
	}
	//처리결과 더블클릭 시 반송처리결과 저장 팝업
	//if(nCell = 26 && length(ds_list1.GetColumn(nRow, "RETURNCD_NM")) != 0) {
	if (vColId == "RTEXT" && length(ds_list1.GetColumn(nRow, "RETURNCD_NM")) != 0) {
		arg = "s020="  +quote(ds_list1.GetColumn(nRow, "S020"))
		    + " s028=" +quote(ds_list1.GetColumn(nRow, "S028"))
		    + " s077=" +quote(ds_list1.GetColumn(nRow, "S077"))
		    + " bstnk="+quote(ds_list1.GetColumn(nRow, "BSTNK"));
		gfn_openPopup("CS4201001E", true, arg);
	}
	//협력업체 데이타 없는 경우 전산 관리자용
	//if(nCell == 8 && (G_USER_ID == "2021200" || G_USER_ID == "2018900" || G_USER_ID == "2029758" || G_USER_ID == "2999999")){
	if (vColId == "S077" && vBtn_auth == true) {
		arg = "s020="	  +quote(ds_list1.GetColumn(nRow, "S020"))
		    + " s028="    +quote(ds_list1.GetColumn(nRow, "S028"))
		    + " s077="    +quote(ds_list1.GetColumn(nRow, "S077"))
		    + " vkgrp="   +quote(ds_list1.GetColumn(nRow, "VKGRP"))
		    + " con_key=" +quote(ds_list1.GetColumn(nRow, "CON_KEY"));
		gfn_openPopup("CS4201001H", true, arg);
	} 
}

/********************************************************************************
* 기      능   : 삭제
********************************************************************************/
function fn_delete() {

	if(ds_list1.FindRow("CHK", 1) == -1) {
		gfn_showAlert("CW00013");		//처리할 자료를 먼저 선택해 주십시오.
		return;
	}
	
	if(!gfn_showConfirm("삭제 처리 하시겠습니까?")) return;

	ds_dlist.ClearData();
	var j = 0;
	for(var i=0; i<ds_list1.RowCount(); i++) {
		if(ds_list1.GetColumn(i, "CHK") == true) {
			ds_dlist.AddRow();
			ds_dlist.SetColumn(j,"CON_KEY", ds_list1.GetColumn(i,"CON_KEY"));
			j++;
		}	
	}
	
	trace(ds_dlist.SaveXML());

	//progressbar
	fn_createWait("", this);
	
	tit_clearActionInfo();
	tit_addMultiActionInfo("cs42:CS4201001A_U1");	// ZCST701-DEL = 'Y'
	tit_addMultiActionInfo("cs42:CS4201001A_U3");   //	ZFIT1004 PRTNO - 1
	tit_addMultiActionInfo("cs42:CS4201001A_D1");	//  ZFIT1078 DELETE
	tit_callService(
		""
		, ""
		, "ds_dlist=ds_dlist"
		, ""
		, ""
		, "fn_afterDelete"
		, true
		, ""
		, true
	);
}
function fn_afterDelete(errCode, errMsg) {

	if(errCode != 0) {
		gfn_showAlert("CE00001");
	} else {
		gfn_showAlert("삭제되었습니다.");
		fn_query();
	}
}
function grd_list2_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
{
	if(nCell == 0 and flag_chk == true) {
		gfn_selectAllGrid(obj,nCell,nCell,true);
	} else {
		gfn_sortGrid(obj,nCell);
	}
}

function btn_upload_OnClick(obj)
{
	gfn_openPopup("CS4201001C",true);
}


function cb_fail_OnClick(obj,strValue)
{
	if (cb_fail.Value = 1) {
		
		ds_list1.Filter("DATA_CD !='20'");
	} else {
		ds_list1.UnFilter();
	}
}

function cb_trans_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	if(cb_trans.Value == "A") {
		cb_fail.Enable = false ;
	} else {
		cb_fail.Enable = true ;
	}
}

function btn_url_OnClick(obj)
{
	gfn_openPopup("CS4201001F",true);
}

function btn_updateVkgrp_OnClick(obj)
{
	//협력업체 데이타 없는 경우 전산 관리자용
	//if(G_USER_ID == "2021200" or G_USER_ID == "2018900" or G_USER_ID == "2029758" or G_USER_ID == "2999999"){
	if (vBtn_auth == true)
	{
		ds_bansong.ClearData();
		var j = 0;
		for(var i=0; i<ds_list1.RowCount(); i++) {
			if(ds_list1.GetColumn(i, "CHK") == true) {
				ds_bansong.AddRow();
				ds_bansong.SetColumn(j, "S020"   ,ds_list1.GetColumn(i, "S020"   ));
				ds_bansong.SetColumn(j, "S028"   ,ds_list1.GetColumn(i, "S028"   ));
				ds_bansong.SetColumn(j, "S077"   ,ds_list1.GetColumn(i, "S077"   ));
				ds_bansong.SetColumn(j, "VKGRP"  ,ds_list1.GetColumn(i, "VKGRP"  ));
				ds_bansong.SetColumn(j, "CON_KEY",ds_list1.GetColumn(i, "CON_KEY"));
				j++;
			}	
		}
		var arg = "pgmID="+quote("P");
		gfn_openPopup("CS4201001H", true, arg);
	} 
}


function btn_rowcnt_OnClick(obj)
{
	var rowi = parseInt(ed_rowcnt.Text);
	
	for(var i=0; i < rowi; i++) {
		ds_list1.SetColumn(i, "CHK",  true); 
	}
}
]]></Script>
</Window>