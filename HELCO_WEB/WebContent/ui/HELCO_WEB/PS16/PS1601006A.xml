<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="562" Id="PS1601002A" Left="8" OnLoadCompleted="fn_OnLoadCompleted" OnUnloadCompleted="fn_OnUnloadCompleted" PidAttrib="7" Title="안전점검" Top="8" Ver="1.0" Width="978" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_cond">
				<Contents>
					<colinfo id="YEARF" size="256" summ="default" type="STRING"/>
					<colinfo id="MONTHF" size="256" summ="default" type="STRING"/>
					<colinfo id="YEART" size="256" summ="default" type="STRING"/>
					<colinfo id="MONTHT" size="256" summ="default" type="STRING"/>
					<colinfo id="YYYYMMF" size="256" summ="default" type="STRING"/>
					<colinfo id="YYYYMMT" size="256" summ="default" type="STRING"/>
					<colinfo id="DIFFMON" size="256" summ="default" type="STRING"/>
					<colinfo id="TEMNO" size="256" summ="default" type="STRING"/>
					<colinfo id="ZTEMNO" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZACTSS" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK_GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK_GBN2" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK_GBN3" size="256" summ="default" type="STRING"/>
					<colinfo id="USERGROUP" size="256" summ="default" type="STRING"/>
					<colinfo id="USERCODE" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZLIFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="NAMET2" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="ATYPE" size="256" summ="default" type="STRING"/>
					<colinfo id="SPEC" size="256" summ="default" type="STRING"/>
					<colinfo id="VAR1" size="50" summ="default" type="STRING"/>
					<record>
						<ATYPE></ATYPE>
						<CHK_GBN></CHK_GBN>
						<CHK_GBN2></CHK_GBN2>
						<CHK_GBN3></CHK_GBN3>
						<DIFFMON></DIFFMON>
						<GBN></GBN>
						<MONTHF></MONTHF>
						<MONTHT></MONTHT>
						<NAMET2></NAMET2>
						<SPEC></SPEC>
						<TEMNO></TEMNO>
						<USERCODE></USERCODE>
						<USERGROUP></USERGROUP>
						<VAR1></VAR1>
						<YEARF></YEARF>
						<YEART></YEART>
						<YYYYMMF></YYYYMMF>
						<YYYYMMT></YYYYMMT>
						<ZTEMNO></ZTEMNO>
						<ZZACTSS></ZZACTSS>
						<ZZLIFNR></ZZLIFNR>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_monthf_cd">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
					<record>
						<CODE>01</CODE>
						<CODE_NAME>1월</CODE_NAME>
					</record>
					<record>
						<CODE>02</CODE>
						<CODE_NAME>2월</CODE_NAME>
					</record>
					<record>
						<CODE>03</CODE>
						<CODE_NAME>3월</CODE_NAME>
					</record>
					<record>
						<CODE>04</CODE>
						<CODE_NAME>4월</CODE_NAME>
					</record>
					<record>
						<CODE>05</CODE>
						<CODE_NAME>5월</CODE_NAME>
					</record>
					<record>
						<CODE>06</CODE>
						<CODE_NAME>6월</CODE_NAME>
					</record>
					<record>
						<CODE>07</CODE>
						<CODE_NAME>7월</CODE_NAME>
					</record>
					<record>
						<CODE>08</CODE>
						<CODE_NAME>8월</CODE_NAME>
					</record>
					<record>
						<CODE>09</CODE>
						<CODE_NAME>9월</CODE_NAME>
					</record>
					<record>
						<CODE>10</CODE>
						<CODE_NAME>10월</CODE_NAME>
					</record>
					<record>
						<CODE>11</CODE>
						<CODE_NAME>11월</CODE_NAME>
					</record>
					<record>
						<CODE>12</CODE>
						<CODE_NAME>12월</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_montht_cd">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
					<record>
						<CODE>01</CODE>
						<CODE_NAME>1월</CODE_NAME>
					</record>
					<record>
						<CODE>02</CODE>
						<CODE_NAME>2월</CODE_NAME>
					</record>
					<record>
						<CODE>03</CODE>
						<CODE_NAME>3월</CODE_NAME>
					</record>
					<record>
						<CODE>04</CODE>
						<CODE_NAME>4월</CODE_NAME>
					</record>
					<record>
						<CODE>05</CODE>
						<CODE_NAME>5월</CODE_NAME>
					</record>
					<record>
						<CODE>06</CODE>
						<CODE_NAME>6월</CODE_NAME>
					</record>
					<record>
						<CODE>07</CODE>
						<CODE_NAME>7월</CODE_NAME>
					</record>
					<record>
						<CODE>08</CODE>
						<CODE_NAME>8월</CODE_NAME>
					</record>
					<record>
						<CODE>09</CODE>
						<CODE_NAME>9월</CODE_NAME>
					</record>
					<record>
						<CODE>10</CODE>
						<CODE_NAME>10월</CODE_NAME>
					</record>
					<record>
						<CODE>11</CODE>
						<CODE_NAME>11월</CODE_NAME>
					</record>
					<record>
						<CODE>12</CODE>
						<CODE_NAME>12월</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_yearf_cd">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_yeart_cd">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list">
				<Contents>
					<colinfo id="PAPRYYYYMM" size="10" summ="default" type="STRING"/>
					<colinfo id="CHKDAT" size="255" summ="default" type="STRING"/>
					<colinfo id="ZZGUBUN" size="256" summ="default" type="STRING"/>
					<colinfo id="TEMNM" size="20" summ="default" type="STRING"/>
					<colinfo id="ZZACTSS" size="50" summ="default" type="STRING"/>
					<colinfo id="LIFNR" size="10" summ="default" type="STRING"/>
					<colinfo id="LIFNRNM" size="35" summ="default" type="STRING"/>
					<colinfo id="NAMET2" size="256" summ="default" type="STRING"/>
					<colinfo id="HOGI" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSITE_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="WK_DESC" size="256" summ="default" type="STRING"/>
					<colinfo id="CH_PER" size="256" summ="default" type="STRING"/>
					<colinfo id="CH_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="EVAL_IMNO" size="256" summ="default" type="STRING"/>
					<colinfo id="EVAL_GRADE" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_zzactss">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<colinfo id="DTEXT3" size="256" summ="default" type="STRING"/>
					<colinfo id="DTEXT4" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_clssfyGrd">
				<Contents>
					<colinfo id="CODE" size="255" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="255" summ="default" type="STRING"/>
					<record>
						<CODE>A</CODE>
						<CODE_NAME>설치</CODE_NAME>
					</record>
					<record>
						<CODE>B</CODE>
						<CODE_NAME>구매</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_zzlifnr">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
					<colinfo id="ZZACTSS" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_temno_cd">
				<Contents>
					<colinfo id="TEMNO" size="256" type="STRING"/>
					<colinfo id="NAMET" size="256" type="STRING"/>
					<record>
						<NAMET></NAMET>
						<TEMNO></TEMNO>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_team">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
					<colinfo id="ZZLIFNR" size="256" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME></CODE_NAME>
						<ZZLIFNR></ZZLIFNR>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ztemno_cd">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list1">
				<Contents>
					<colinfo id="PAPRYYYYMM" size="10" summ="default" type="STRING"/>
					<colinfo id="TEMNM" size="255" summ="default" type="STRING"/>
					<colinfo id="ZZACTSS" size="255" summ="default" type="STRING"/>
					<colinfo id="LIFNR" size="255" summ="default" type="STRING"/>
					<colinfo id="LIFNRNM" size="256" summ="default" type="STRING"/>
					<colinfo id="NAMET2" size="256" summ="default" type="STRING"/>
					<colinfo id="HOGI" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSITE_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="ATYPE" size="256" summ="default" type="STRING"/>
					<colinfo id="SPEC" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="IMPTCNT" size="256" summ="default" type="STRING"/>
					<colinfo id="POINT" size="256" summ="default" type="STRING"/>
					<colinfo id="POINTAVG" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="TOT" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="EVAL_GRADE" size="256" summ="default" type="INT"/>
					<colinfo id="RANKING" size="256" summ="default" type="INT"/>
					<colinfo id="POINTAVG2" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="POINTAVG_SUM" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="TOT_SUM" size="256" summ="default" type="DECIMAL"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cnt" UseClientLayout="1">
				<Contents>
					<colinfo id="CNT" size="256" summ="default" type="INT"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cnt2" UseClientLayout="1">
				<Contents>
					<colinfo id="CNT" size="256" summ="default" type="INT"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_spec1">
				<Contents>
					<colinfo id="CODE_NM" size="256" summ="default" type="STRING"/>
					<record>
						<CODE_NM>-&#32;전체&#32;-</CODE_NM>
					</record>
					<record>
						<CODE_NM>STVF</CODE_NM>
					</record>
					<record>
						<CODE_NM>LXVF</CODE_NM>
					</record>
					<record>
						<CODE_NM>SSVF</CODE_NM>
					</record>
					<record>
						<CODE_NM>HYD</CODE_NM>
					</record>
					<record>
						<CODE_NM>T&amp;S</CODE_NM>
					</record>
					<record>
						<CODE_NM>STSH1</CODE_NM>
					</record>
					<record>
						<CODE_NM>STSH5</CODE_NM>
					</record>
					<record>
						<CODE_NM>FI4GL</CODE_NM>
					</record>
					<record>
						<CODE_NM>SUVF</CODE_NM>
					</record>
					<record>
						<CODE_NM>HSVF</CODE_NM>
					</record>
					<record>
						<CODE_NM>WBT</CODE_NM>
					</record>
					<record>
						<CODE_NM>WBTL</CODE_NM>
					</record>
					<record>
						<CODE_NM>WBB</CODE_NM>
					</record>
					<record>
						<CODE_NM>MLBT</CODE_NM>
					</record>
					<record>
						<CODE_NM>MLBB</CODE_NM>
					</record>
					<record>
						<CODE_NM>HABT</CODE_NM>
					</record>
					<record>
						<CODE_NM>HABTL</CODE_NM>
					</record>
					<record>
						<CODE_NM>HABB</CODE_NM>
					</record>
					<record>
						<CODE_NM>MBTL</CODE_NM>
					</record>
					<record>
						<CODE_NM>MBB</CODE_NM>
					</record>
					<record>
						<CODE_NM>MBT</CODE_NM>
					</record>
					<record>
						<CODE_NM>WBTS</CODE_NM>
					</record>
					<record>
						<CODE_NM>WBTSK</CODE_NM>
					</record>
					<record>
						<CODE_NM>HDBT</CODE_NM>
					</record>
					<record>
						<CODE_NM>HDBB</CODE_NM>
					</record>
					<record>
						<CODE_NM>HDBTL</CODE_NM>
					</record>
					<record>
						<CODE_NM>NWBT</CODE_NM>
					</record>
					<record>
						<CODE_NM>NWBB</CODE_NM>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_spec">
				<Contents>
					<colinfo id="CODE_NM" size="256" summ="default" type="STRING"/>
					<record>
						<CODE_NM>-&#32;전체&#32;-</CODE_NM>
					</record>
					<record>
						<CODE_NM>45</CODE_NM>
					</record>
					<record>
						<CODE_NM>60</CODE_NM>
					</record>
					<record>
						<CODE_NM>90</CODE_NM>
					</record>
					<record>
						<CODE_NM>105</CODE_NM>
					</record>
					<record>
						<CODE_NM>120</CODE_NM>
					</record>
					<record>
						<CODE_NM>150</CODE_NM>
					</record>
					<record>
						<CODE_NM>180</CODE_NM>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_zzactss_0">
				<Contents>
					<colinfo id="DTEXT3" size="256" summ="default" type="STRING"/>
					<colinfo id="DTEXT4" size="256" summ="default" type="STRING"/>
					<record>
						<DTEXT3></DTEXT3>
						<DTEXT4>-&#32;전체&#32;-</DTEXT4>
					</record>
					<record>
						<DTEXT3>1</DTEXT3>
						<DTEXT4>설치1팀</DTEXT4>
					</record>
					<record>
						<DTEXT3>2</DTEXT3>
						<DTEXT4>설치2팀</DTEXT4>
					</record>
					<record>
						<DTEXT3>3</DTEXT3>
						<DTEXT4>설치3팀</DTEXT4>
					</record>
					<record>
						<DTEXT3>4</DTEXT3>
						<DTEXT4>설치4팀</DTEXT4>
					</record>
					<record>
						<DTEXT3>5</DTEXT3>
						<DTEXT4>MP설치팀</DTEXT4>
					</record>
					<record>
						<DTEXT3>6</DTEXT3>
						<DTEXT4>리모델링팀</DTEXT4>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list2">
				<Contents>
					<colinfo id="PAPRYYYY" size="256" summ="default" type="STRING"/>
					<colinfo id="PAPRMM" size="256" summ="default" type="STRING"/>
					<colinfo id="PAPRYYYYMM" size="256" summ="default" type="STRING"/>
					<colinfo id="PAPRDT" size="255" summ="default" type="STRING"/>
					<colinfo id="TEMNM" size="255" summ="default" type="STRING"/>
					<colinfo id="ZZACTSS" size="255" summ="default" type="STRING"/>
					<colinfo id="LIFNR" size="255" summ="default" type="STRING"/>
					<colinfo id="LIFNRNM" size="256" summ="default" type="STRING"/>
					<colinfo id="NAMET2" size="256" summ="default" type="STRING"/>
					<colinfo id="HOGI" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSITE_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="ATYPE" size="256" summ="default" type="STRING"/>
					<colinfo id="SPEC" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="IMPTCNT" size="256" summ="default" type="STRING"/>
					<colinfo id="POINT" size="256" summ="default" type="STRING"/>
					<colinfo id="POINTAVG" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="TOT" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="EVAL_GRADE" size="256" summ="default" type="INT"/>
					<colinfo id="RANKING" size="256" summ="default" type="INT"/>
					<colinfo id="POINTAVG2" size="256" summ="default" type="DECIMAL"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_var">
				<Contents>
					<colinfo id="VAR1" size="50" summ="default" type="STRING"/>
					<colinfo id="VAR2" size="50" summ="default" type="STRING"/>
					<colinfo id="VAR3" size="50" summ="default" type="STRING"/>
					<colinfo id="VAR4" size="50" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_invar">
				<Contents>
					<colinfo id="SCR_ID" size="7" summ="default" type="STRING"/>
					<colinfo id="SCR_GUBUN" size="1" summ="default" type="STRING"/>
					<colinfo id="GUBUN1" size="1" summ="default" type="STRING"/>
					<colinfo id="ORD" size="3" summ="default" type="STRING"/>
					<record>
						<GUBUN1>1</GUBUN1>
						<ORD>1</ORD>
						<SCR_GUBUN>3</SCR_GUBUN>
						<SCR_ID>1601006</SCR_ID>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataObject="ds_list2" DataSetType="Pivot" GroupKey="LIFNRNM:TEMNM:ZZACTSS:TEMNO:NAMET2" Id="dsPivot2" PivotKey="papryyyymm" UseClientLayout="1"></Dataset>
			<Dataset DataObject="ds_list1" DataSetType="Pivot" GroupKey="TEMNM:ZZACTSS:LIFNRNM" Id="dsPivot1" PivotKey="PAPRYYYYMM" UseClientLayout="1"></Dataset>
		</Datasets>
		<Div Height="760" Id="div0" Left="8" TabOrder="1" Text="Div0" Top="56" Width="960">
			<Contents>
				<Grid AreaSelect="true" AutoFitEndLine="Hide" BindDataset="ds_list" BkColor2="default" BoldHead="true" Border="Flat" Bottom="752" CellMoving="TRUE" ColSizing="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="750" Id="grd_list" InputPanel="FALSE" Left="4" LineColor="user20" LineType="ExHORZ" OnCellClick="div0_grd_list_OnCellClick" OnHeadClick="grd_list_OnHeadClick" Right="960" RowHeight="20" Style="sty_grid" TabOrder="1" TabStop="true" Top="2" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="956">
					<contents>
						<format id="Default">
							<columns>
								<col width="30"/>
								<col width="80"/>
								<col width="60"/>
								<col width="63"/>
								<col width="140"/>
								<col width="56"/>
								<col width="90"/>
								<col width="250"/>
								<col width="400"/>
								<col width="80"/>
								<col width="40"/>
								<col width="80"/>
								<col width="70"/>
							</columns>
							<head>
								<cell bkimageid="icon_grid_sel" col="0" display="text" font="굴림,9" TrimType="Left"/>
								<cell col="1" display="text" text="발생일자"/>
								<cell col="2" display="text" text="팀명"/>
								<cell col="3" display="text" text="지사"/>
								<cell col="4" display="text" font="굴림,9" text="업체명" TrimType="Left"/>
								<cell col="5" display="text" font="굴림,9" text="설치팀장"/>
								<cell col="6" display="text" text="호기"/>
								<cell col="7" display="text" text="현장명"/>
								<cell col="8" display="text" text="작업&#32;내용"/>
								<cell col="9" display="text" text="점검자"/>
								<cell col="10" display="text" text="인원"/>
								<cell col="11" display="text" text="중대재해위반"/>
								<cell col="12" display="text" text="점수"/>
							</head>
							<body>
								<cell align="center" bkcolor2="user22" col="0" display="text" expr="currow+1"/>
								<cell align="left" col="1" colid="CHKDAT" display="text" Mask="####-##-##"/>
								<cell align="center" col="2" colid="TEMNM" display="text"/>
								<cell align="center" col="3" colid="ZZACTSS" display="text"/>
								<cell align="left" bkcolor2="user22" col="4" colid="LIFNRNM" display="text"/>
								<cell align="center" bkcolor2="user22" col="5" colid="NAMET2" display="text"/>
								<cell align="center" col="6" colid="HOGI" display="text"/>
								<cell col="7" colid="ZSITE_NM" display="text"/>
								<cell col="8" colid="WK_DESC" display="text"/>
								<cell col="9" colid="CH_PER" display="text"/>
								<cell align="right" col="10" colid="CH_NO" display="text"/>
								<cell align="center" col="11" colid="EVAL_IMNO" display="text"/>
								<cell align="right" col="12" colid="EVAL_GRADE" display="text"/>
							</body>
							<summary>
								<cell col="0" colspan="8" display="text">
									<cell col="0" display="text"/>
									<cell col="1" display="text"/>
									<cell col="2" display="text"/>
									<cell col="3" display="text"/>
									<cell col="4" display="text" text="합&#32;계"/>
									<cell col="5" display="text"/>
									<cell col="6" display="text"/>
									<cell col="7" display="text"/>
									<cell col="8" display="text"/>
									<cell col="9" display="text"/>
									<cell col="10" display="text"/>
								</cell>
								<cell align="center" col="8" display="text"/>
								<cell col="9" display="text"/>
								<cell col="10" display="text"/>
								<cell col="11" display="text" expr="sum(&apos;EVAL_IMNO&apos;)"/>
								<cell col="12" display="text"/>
							</summary>
						</format>
					</contents>
				</Grid>
			</Contents>
		</Div>
		<Shape BKColor="user0" Bottom="55" Height="55" Id="Shape1" Left="0" LineColor="user1" Right="978" TabOrder="2" Top="0" Type="Rectangle" Width="978"></Shape>
		<Radio Border="None" Height="20" Id="rd_gbn2" INDEX="0" Left="822" Style="sty_ipt_form_radio" TabOrder="12" Top="5" Width="152">
			<Contents>
				<Layout code="10" height="15" left="10" text="E/L" top="5" width="50"/>
				<Layout code="11" height="15" left="60" text="E/S" top="5" width="50"/>
				<Layout code="20" height="15" left="110" text="주차" top="5" width="50"/>
			</Contents>
		</Radio>
		<Static Align="Right" Height="20" Id="st_gubun" Left="734" Style="sty_lb_search" TabOrder="9" Text="구분&#32;" Top="6" VAlign="Middle" Width="80"></Static>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="CODE" Column="ZZACTSS" DataColumn="CODE_NAME" Height="20" Id="cb_zzactss" InnerDataset="ds_zzactss" Left="623" OnChanged="cb_zzactss_OnChanged" Style="sty_ipt_search" TabOrder="6" Top="5" Width="97"></Combo>
		<Radio Border="None" Height="20" Id="rd_gbn" INDEX="0" Left="623" OnChanged="rd_gbn_OnChanged" Style="sty_ipt_form_radio" TabOrder="13" Top="28" Width="190">
			<Contents>
				<Layout code="1" height="15" left="10" text="총괄표" top="5" width="65"/>
				<Layout code="2" height="15" left="80" text="안전점검" top="5" width="100"/>
			</Contents>
		</Radio>
		<Static Align="Right" Height="20" Id="Static1" Left="535" Style="sty_lb_search" TabOrder="18" Text="평가구분" Top="30" VAlign="Middle" Width="80"></Static>
		<Static Align="Right" Height="20" Id="st_zzactss" Left="535" Style="sty_lb_search" TabOrder="5" Text="사무소&#32;" Top="6" VAlign="Middle" Width="80"></Static>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="DTEXT3" Column="TEMNO" DataColumn="DTEXT4" Height="20" Id="cb_temno" INDEX="0" InnerDataset="ds_zzactss_0" Left="423" OnChanged="cb_temno_OnChanged" Style="sty_ipt_search" TabOrder="11" Top="5" Width="103"></Combo>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="CODE" Column="ZTEMNO" DataColumn="CODE_NAME" Height="20" Id="cb_ztemno" INDEX="1" InnerDataset="ds_ztemno_cd" Left="423" Style="sty_ipt_search" TabOrder="19" Top="28" Width="103"></Combo>
		<Static Align="Right" Height="20" Id="Static2" Left="337" Style="sty_lb_search" TabOrder="20" Text="설치팀장" Top="30" VAlign="Middle" Width="80"></Static>
		<Static Align="Right" Height="20" Id="Static0" Left="337" Style="sty_lb_search" TabOrder="10" Text="설치팀&#32;" Top="6" VAlign="Middle" Width="80"></Static>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="CODE" Column="MONTHT" DataColumn="CODE_NAME" Height="20" Id="cb_montht" InnerDataset="ds_montht_cd" Left="282" Style="sty_ipt_search" TabOrder="8" Top="5" Width="50"></Combo>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="CODE" Column="YEART" DataColumn="CODE_NAME" Height="20" Id="cb_yeart" InnerDataset="ds_yeart_cd" Left="219" Style="sty_ipt_search" TabOrder="4" Top="5" Width="60"></Combo>
		<Static Align="Center" Border="None" Color="user7" Font="굴림,9" Height="14" Id="Static13" Left="201" TabOrder="16" Text="~" Top="11" VAlign="Middle" Width="18"></Static>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="CODE" Column="MONTHF" DataColumn="CODE_NAME" Height="20" Id="cb_monthf" InnerDataset="ds_monthf_cd" Left="154" Style="sty_ipt_search" TabOrder="7" Top="5" Width="50"></Combo>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="CODE" Column="YEARF" DataColumn="CODE_NAME" Height="20" Id="cb_yearf" InnerDataset="ds_yearf_cd" Left="92" Style="sty_ipt_search" TabOrder="3" Top="5" Width="60"></Combo>
		<Static Align="Right" Height="20" Id="st_yymm" Left="8" Style="sty_lb_search" TabOrder="14" Text="평가기간&#32;" Top="6" VAlign="Middle" Width="80"></Static>
		<Static Align="Right" Height="20" Id="st_lifnr" Left="8" Style="sty_lb_search" TabOrder="15" Text="설치협력사&#32;" Top="30" VAlign="Middle" Width="80"></Static>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="CODE" Column="ZZLIFNR" DataColumn="CODE_NAME" Height="20" Id="cb_lifnr" INDEX="1" InnerDataset="ds_zzlifnr" Left="92" OnChanged="cb_lifnr_OnChanged" Style="sty_ipt_search" TabOrder="17" Top="28" Width="130"></Combo>
		<Div Height="750" Id="div1" TabOrder="21" Text="Div0" Top="56" Width="970">
			<Contents>
				<Static Color="user6" Font="굴림,9" Height="13" Id="Static8" Left="8" TabOrder="1" Text="※설치협력사" Top="8" VAlign="Middle" Width="102"></Static>
				<Static Color="user6" Font="굴림,9" Height="13" Id="Static7" TabOrder="2" Text="※설치팀장" Top="388" VAlign="Middle" Width="94"></Static>
				<Static Color="user6" Font="굴림,9" Height="13" Id="Static0" Left="928" TabOrder="3" Text="명" Top="389" VAlign="Middle" Width="30"></Static>
				<Static Color="user6" Font="굴림,9" Height="13" Id="Static1" Left="784" TabOrder="4" Text="※설치팀장수" Top="388" VAlign="Middle" Width="86"></Static>
				<Static Color="user6" Font="굴림,9" Height="13" Id="Static2" Left="764" TabOrder="5" Text="※설치협력사수" Top="8" VAlign="Middle" Width="86"></Static>
				<Static Color="user6" Font="굴림,9" Height="13" Id="Static3" Left="940" TabOrder="6" Text="개사" Top="8" VAlign="Middle" Width="30"></Static>
				<Grid AutoEnter="TRUE" BindDataset="dsPivot1" BkColor2="default" BoldHead="FALSE" Border="Flat" Bottom="372" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="21" Height="340" Id="grd_list1" InputPanel="FALSE" LineColor="user13" LineType="ExVERT" OnHeadClick="div1_grd_list1_OnHeadClick" Right="950" RowHeight="21" Style="sty_grid" TabOrder="7" TabStop="true" Top="32" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="950">
					<contents>
						<format id="Default">
							<columns>
								<col fix="left" width="31"/>
								<col fix="left" width="60"/>
								<col fix="left" width="50"/>
								<col fix="left" width="100"/>
								<col fix="left" width="53"/>
								<col width="63"/>
								<col width="70"/>
								<col width="49"/>
								<col width="60"/>
								<col fix="right" width="50"/>
								<col fix="right" width="65"/>
								<col fix="right" width="50"/>
								<col fix="right" width="50"/>
								<col fix="right" width="50"/>
							</columns>
							<head>
								<cell col="0" display="text" rowspan="2" text="No"/>
								<cell col="1" display="text" rowspan="2" text="설치팀"/>
								<cell col="2" display="text" rowspan="2" text="지사"/>
								<cell col="3" display="text" rowspan="2" text="업체명"/>
								<cell col="4" color="user21" display="text" limit="-1" rowspan="2" text="팀장"/>
								<cell align="center" col="5" color="user21" colspan="4" display="text" expr='substr(PAPRYYYYMM,0,4)+&quot;년&#32;&quot;+substr(PAPRYYYYMM,4,&#32;2)+&quot;월&quot;' font="굴림,9,Bold" limit="-1"/>
								<cell col="9" colspan="4" display="text" text="집계"/>
								<cell col="9" display="text" row="1" text="점검건수"/>
								<cell col="10" display="text" row="1" text="중대재해위반"/>
								<cell col="11" display="text" row="1" text="평균점수"/>
								<cell col="12" display="text" row="1" text="환산점수"/>
								<cell col="13" display="text" rowspan="2" text="순위"/>
								<cell col="5" color="user21" display="text" limit="-1" row="1" text="점검건수"/>
								<cell col="6" color="user21" display="text" expr='&quot;중대재해위반&quot;' limit="-1" row="1" text="중대재해위반"/>
								<cell col="7" display="text" row="1" text="평균점수"/>
								<cell col="8" display="text" row="1" text="환산점수"/>
							</head>
							<body>
								<cell col="0" display="text" expr="CURROW+1"/>
								<cell col="1" colid="TEMNM" display="text"/>
								<cell col="2" colid="ZZACTSS" display="text"/>
								<cell col="3" colid="LIFNRNM" display="text"/>
								<cell align="center" col="4" display="text" limit="-1" text="전체"/>
								<cell align="right" col="5" colid="CNT" display="text" limit="-1"/>
								<cell align="right" col="6" colid="IMPTCNT" display="text" limit="-1"/>
								<cell align="right" col="7" colid="POINTAVG" display="text"/>
								<cell align="right" col="8" colid="TOT" display="text"/>
								<cell align="right" col="9" display="number" expr='PivotSum(&quot;CNT&quot;&#32;,&#32;currow)' Mask="#,##0"/>
								<cell align="right" col="10" display="number" expr='PivotSum(&quot;IMPTCNT&quot;&#32;,&#32;currow)' Mask="#,##0"/>
								<cell align="right" col="11" display="number" expr="POINTAVG_SUM/PivotCount(&apos;LIFNRNM&apos;,currow)" Mask="#,##0.0"/>
								<cell align="right" celltype="summary" col="12" colid="POINTAVG2" display="number" expr="TOT_SUM/PivotCount(&apos;LIFNRNM&apos;,currow)" Mask="#,##0.0"/>
								<cell align="right" col="13" colid="RANKING" display="number" expr="RANKING/PivotCount(&apos;LIFNRNM&apos;,currow)" Mask="#,##0"/>
							</body>
						</format>
					</contents>
				</Grid>
				<Static Color="user6" Font="굴림,9" Height="13" Id="stc_sum1" Left="885" TabOrder="8" Text="00" Top="8" VAlign="Middle" Width="30"></Static>
				<Static Color="user6" Font="굴림,9" Height="13" Id="stc_sum2" Left="888" TabOrder="9" Text="00" Top="388" VAlign="Middle" Width="30"></Static>
				<Grid AutoEnter="TRUE" BindDataset="dsPivot2" BkColor2="default" BoldHead="FALSE" Border="Flat" Bottom="756" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="21" Height="340" Id="grd_list2" InputPanel="FALSE" LineColor="user13" LineType="ExVERT" OnHeadClick="div1_grd_list1_OnHeadClick" Right="950" RowHeight="21" Style="sty_grid" TabOrder="10" TabStop="true" Top="416" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="950">
					<contents>
						<format id="Default">
							<columns>
								<col fix="left" width="31"/>
								<col fix="left" width="60"/>
								<col fix="left" width="50"/>
								<col fix="left" width="100"/>
								<col fix="left" width="53"/>
								<col width="63"/>
								<col width="70"/>
								<col width="49"/>
								<col width="60"/>
								<col fix="right" width="50"/>
								<col fix="right" width="65"/>
								<col fix="right" width="50"/>
								<col fix="right" width="50"/>
								<col fix="right" width="50"/>
							</columns>
							<head>
								<cell col="0" display="text" rowspan="2" text="No"/>
								<cell col="1" display="text" rowspan="2" text="설치팀"/>
								<cell col="2" display="text" rowspan="2" text="지사"/>
								<cell col="3" display="text" rowspan="2" text="업체명"/>
								<cell col="4" color="user21" display="text" limit="-1" rowspan="2" text="팀장"/>
								<cell align="center" col="5" color="user21" colspan="4" display="text" expr='substr(PAPRYYYYMM,0,4)+&quot;년&#32;&quot;+substr(PAPRYYYYMM,4,&#32;2)+&quot;월&quot;' font="굴림,9,Bold" limit="-1"/>
								<cell col="9" colspan="4" display="text" text="집계"/>
								<cell col="9" display="text" row="1" text="점검건수"/>
								<cell col="10" display="text" row="1" text="중대재해위반"/>
								<cell col="11" display="text" row="1" text="평균점수"/>
								<cell col="12" display="text" row="1" text="환산점수"/>
								<cell col="13" display="text" rowspan="2" text="순위"/>
								<cell col="5" color="user21" display="text" limit="-1" row="1" text="점검건수"/>
								<cell col="6" color="user21" display="text" expr='&quot;중대재해위반&quot;' limit="-1" row="1" text="중대재해위반"/>
								<cell col="7" display="text" row="1" text="평균점수"/>
								<cell col="8" display="text" row="1" text="환산점수"/>
							</head>
							<body>
								<cell col="0" display="text" expr="CURROW+1"/>
								<cell col="1" colid="TEMNM" display="text"/>
								<cell col="2" colid="ZZACTSS" display="text"/>
								<cell col="3" colid="LIFNRNM" display="text"/>
								<cell align="center" col="4" colid="NAMET2" display="text" limit="-1" text="전체"/>
								<cell align="right" col="5" colid="CNT" display="text" limit="-1"/>
								<cell align="right" col="6" colid="IMPTCNT" display="text" limit="-1"/>
								<cell align="right" col="7" colid="POINTAVG" display="text"/>
								<cell align="right" col="8" colid="TOT" display="text"/>
								<cell align="right" col="9" display="number" expr='PivotSum(&quot;CNT&quot;&#32;,&#32;currow)' Mask="#,##0"/>
								<cell align="right" col="10" display="number" expr='PivotSum(&quot;IMPTCNT&quot;&#32;,&#32;currow)' Mask="#,##0"/>
								<cell align="right" col="11" display="number" expr="POINTAVG_SUM/PivotCount(&apos;NAMET2&apos;,currow)" Mask="#,##0.0"/>
								<cell align="right" celltype="summary" col="12" colid="TOT_SUM" display="number" expr="TOT_SUM/PivotCount(&apos;NAMET2&apos;,currow)" Mask="#,##0.0"/>
								<cell align="right" col="13" colid="RANKING" display="number" expr='PivotSum(&quot;RANKING&quot;&#32;,&#32;currow)/dsPivot2.PivotCount(&apos;NAMET2&apos;,currow)' Mask="#,##0"/>
							</body>
						</format>
					</contents>
				</Grid>
			</Contents>
		</Div>
	</Form>
	<Script><![CDATA[﻿﻿﻿﻿﻿﻿/*
 ******************************************************************************************
 * 기      능   :  협력업체 평가 (안전점검) 조회
 * 작  성  자   : swnam
 * 작성  일자   : 20191201
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
#include "LIB::commons.js";	// 공통 스크립트 
//=========================================================================================
// [ PART 1 ]
// Form에서 사용될 전역변수를 선언
// FORM에서 사용되는 전역변수는 대문자로 작성하며, F_XXX 의 형태를 갖도록 한다. 
//=========================================================================================
var userGroup = "";
//=========================================================================================
// [ PART 2 ]
// Form Loading / Unloading 시 작업 정의
//=========================================================================================
function fn_OnLoadCompleted(obj) {
	// Form 로드 이벤트 맨 첫줄에 기술 
	gfn_initForm(true);
	userGroup = gfn_getUserGroup();
	rd_gbn.Index = 0;
	rd_gbn2.Index = 0;
	cb_zzactss.Index = 0;
	div0.Visible = false;
	div1.Visible = true;
	div0.top=Shape1.Bottom+1;
	div0.left=Shape1.left+1;
    div1.top=Shape1.Bottom+1;
	div1.left=Shape1.left+1;
    var curYear = substr(gfn_getCurrDate(),0,4);
	fn_makeYear(curYear,-5,10);
	cb_monthf.index = parseInt(substr(gfn_getCurrDate(),4,2))-1;
	cb_montht.index = parseInt(substr(gfn_getCurrDate(),4,2))-1;
    
    ds_cond.SetColumn(0,"USERGROUP",userGroup);

    //코드콤보 설정 : 지역, 구분2
	var codeArr = ["PS003"];
    var dsObjArr = [ds_zzactss];
    var addTypeArr = [G_CODE_ALL];
    gfn_searchCommCode(codeArr, dsObjArr, addTypeArr);

	tit_clearActionInfo();
	tit_addSearchActionInfo("wb01:SEOLCHI_VEND_S2");	

	tit_callService(
		""
		, ""
		, "ds_cond=ds_cond"
		, "ds_zzlifnr=ds_lifnr_cd"  
		, ""
		, "fn_afterQueryC"
		, ""
		, ""
		, true);

	fn_initQuery();
}
/********************************************************************************
* 기      능   : 사무소 별 협력업체 필터 
********************************************************************************/
function fn_initQuery() {

	tit_clearActionInfo();
	tit_addSearchActionInfo("qm05:QM0501001A_S1");
	tit_addSearchActionInfo("ps02:PS0203001A_S1");
	tit_callService(
        ""
        , ""
        , "ds_cond=ds_cond"
        , "ds_team=ds_team ds_zzlifnr=ds_zzlifnr"
        , ""
        , "fn_afterInitQuery"
        , true);
        
    tit_clearActionInfo();
    tit_addSearchActionInfo("ps16:PS1601011A_S7");
    tit_callService(
        ""
        , ""
        , "ds_invar=ds_invar"
        , "ds_var=ds_var"
        , ""
        , "fn_afterSearchVar"
        , true);
}


/********************************************************************************
* 기      능   : 사무소 별 협력업체 필터 
********************************************************************************/
function fn_afterInitQuery(){

	if(userGroup == '10')
	{
		ds_zzlifnr.Filter("CODE=="+quote(G_VEND_CODE_E));
		cb_lifnr.Index = 0;
		cb_lifnr.Enable = false;
		
		ds_team.Filter("ZZLIFNR=="+quote(G_VEND_CODE_E)+" || CODE==''");
		cb_ztemno.Index = 0;
		cb_ztemno.Enable = true;
	}
	else if(userGroup == '30')
	{
		gfn_insertEmptyRow( ds_zzlifnr, G_CODE_ALL );
		ds_zzlifnr.Filter("ZZACTSS=="+quote(G_AREA_CODE_E)+" || CODE==''");
		cb_lifnr.Index = 0;
		cb_lifnr.Enable = true;
	}
	else
	{
		gfn_insertEmptyRow( ds_zzlifnr, G_CODE_ALL );
		cb_lifnr.Index = 0;
		cb_lifnr.Enable = true;
	}
	gfn_insertEmptyRow( ds_team, G_CODE_ALL );
	cb_ztemno.Index = 0;
}
/********************************************************************************
* 기      능   : 수식변수 조건 셋팅
********************************************************************************/
function fn_afterSearchVar(){
	ds_cond.SetColumn(0,"VAR1", toString(ds_var.GetColumn(0,"VAR1"))); //limit
}
/********************************************************************************
* 기      능   : 지급예정년 계산(현재년도,당해년도에서 뺄 년수, 당해년도에서 더할 년수
********************************************************************************/
function fn_makeYear(curYear,sNum,eNum)
{
	var rowCnt = eNum-sNum;
	var row = 0;

	for(var i=rowCnt; i>-1; i--)
	{
		ds_yearf_cd.AddRow();
		ds_yearf_cd.SetColumn(row,"CODE",parseInt(curYear)+i+parseInt(sNum));
		ds_yearf_cd.SetColumn(row,"CODE_NAME",(parseInt(curYear)+i+parseInt(sNum))+"년");
		ds_yeart_cd.AddRow();
		ds_yeart_cd.SetColumn(row,"CODE",parseInt(curYear)+i+parseInt(sNum));
		ds_yeart_cd.SetColumn(row,"CODE_NAME",(parseInt(curYear)+i+parseInt(sNum))+"년");
		row++;
	}
	cb_yearf.index = eNum;
	cb_yeart.index = eNum;
}

/********************************************************************************
* 기      능   : 조회 (header 조회)
********************************************************************************/
function fn_query() {
	if(gfn_isNull(cb_yearf, true, st_yymm.value)) return;
	if(gfn_isNull(cb_monthf, true, st_yymm.value)) return;
	if(gfn_isNull(cb_yeart, true, st_yymm.value)) return;
	if(gfn_isNull(cb_montht, true, st_yymm.value)) return;
	if(parseInt(ds_cond.GetColumn(0,"YEARF")+ds_cond.GetColumn(0,"MONTHF")) > 
	   parseInt(ds_cond.GetColumn(0,"YEART")+ds_cond.GetColumn(0,"MONTHT")))
	{
		gfn_showMsg("CW00009");
		cb_yeart.SetFocus();
		return;
	}   
     
	//설치협력사필드 필수체크(설치협력사 로그인시)
	if( userGroup == '10' && gfn_isNull(cb_lifnr, true, st_lifnr.value)) return;

	var fYear  = parseInt(ds_cond.GetColumn(0,"YEARF"));
	var tYear  = parseInt(ds_cond.GetColumn(0,"YEART"));
	var fMonth = parseInt(ds_cond.GetColumn(0,"MONTHF"));
	var tMonth = parseInt(ds_cond.GetColumn(0,"MONTHT"));
	ds_cond.SetColumn(0,"YYYYMMF",ds_cond.GetColumn(0,"YEARF")+ds_cond.GetColumn(0,"MONTHF"));
	ds_cond.SetColumn(0,"YYYYMMT",ds_cond.GetColumn(0,"YEART")+ds_cond.GetColumn(0,"MONTHT"));
	if(rd_gbn2.Index == 0) {
	    ds_cond.SetColumn(0,"CHK_GBN","10");
	    ds_cond.SetColumn(0,"CHK_GBN3","A");
	} else 	if(rd_gbn2.Index == 1) {
	    ds_cond.SetColumn(0,"CHK_GBN","11");
	    ds_cond.SetColumn(0,"CHK_GBN3","A");
	} else 	if(rd_gbn2.Index == 2) {
	    ds_cond.SetColumn(0,"CHK_GBN","20");
	    ds_cond.SetColumn(0,"CHK_GBN3","C");
	}
    ds_cond.SetColumn(0,"VAR1", ds_var.GetColumn(0,"VAR1"));
	if(rd_gbn.index == 1) {
	    tit_clearActionInfo();
		tit_addSearchActionInfo("ps16:PS1601006A_S1");  //==> CsvSaerch로 변경	
			
		tit_callService(
			""
			, ""
			, "ds_cond=ds_cond"
			, "ds_list=ds_list"
			, ""
			, "fn_afterQuery"
			, ""
			, ""
			, true);
     
     } else if(rd_gbn.index == 0){

     
    	tit_clearActionInfo();
		tit_addSearchActionInfo("ps16:PS1601006A_S2");  //==> CsvSaerch로 변경
		tit_callService(
			""
			, ""
			, "ds_cond=ds_cond"
			, "ds_list1=ds_list1"
			, ""
			, "fn_afterQuery"
			, ""
			, ""
			, true);

		tit_clearActionInfo();
		tit_addSearchActionInfo("ps16:PS1601006A_S3");  //==> CsvSaerch로 변경	
		tit_callService(
			""
			, ""
			, "ds_cond=ds_cond"
			, "ds_list2=ds_list2"
			, ""
			, "fn_afterQuery"
			, ""
			, ""
			, true);
     }
}
/********************************************************************************
* 기      능   : 조회 Callback  
********************************************************************************/
function fn_afterQuery(errCode, errMsg)  {
     if(rd_gbn.index == 0){
        div1.stc_sum1 = dsPivot1.rowcount;
        div1.stc_sum2 = dsPivot2.rowcount;
     }
}


/********************************************************************************
* 기      능   :  협력사 조회 Callback  
********************************************************************************/
function fn_afterQueryC(errCode, errMsg) {

	if ( userGroup == "10" )
	{
	    ds_zzlifnr.Filter("CODE=="+quote(G_VEND_CODE_E));
		cb_lifnr.Index = 0;
		cb_lifnr.Enable = false;
	}
	else if ( userGroup == "30" || userGroup == "40")
	{
		gfn_insertEmptyRow( ds_zzlifnr, G_CODE_ALL );
		cb_lifnr.value = "";
	}

}
/********************************************************************************
* 기      능   : 공통코드가 조회된 후의 Callback 함수 
********************************************************************************/
function fn_completeInit(sCode, sDsObj, sCodeType) {
	if(userGroup == "40")
	{
		cb_zzactss.Index = 0;
		cb_zzactss.Enable = true;
	}
	else if(userGroup == "30")
	{
		ds_zzactss.Filter("CODE="+quote(G_AREA_CODE_E));
		cb_zzactss.Index = 0;
		cb_zzactss.Enable = false;
	}
	else if(userGroup == "10")
	{
		cb_zzactss.Index = 0;
		cb_zzactss.Enable = false;
	}
}
/********************************************************************************
* 기      능   : form UnloadCompleted 
********************************************************************************/
function fn_OnUnloadCompleted(obj) {
	return gfn_isFormUnload(obj);
}
//=========================================================================================
// [ PART 3 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,form닫기)
//=========================================================================================

/********************************************************************************
* 기      능   : 닫기  
********************************************************************************/
function fn_close() {
	close();
}
/********************************************************************************
* 기      능   : 그리드 헤더 클릭시 정렬 처리 
********************************************************************************/
function grd_list_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
{
	if ( nCell == 0 ) {
		// 현재 처리할 format 기억
		gfn_selectGridCol("grd_list");
	} else {
		gfn_sortGrid(obj,nCell);
	}
}
/********************************************************************************
* 기      능   : 액셀  
********************************************************************************/
function fn_excel() 
{
 	if(rd_gbn.index == 1) {
		// Excel Export 
		if( ds_list.rowcount > 0 )
		{
		    gfn_exportExcel(div0.grd_list, "안전점검_평가관리_안전점검현황리스트");
			break;
		}
	} else if(rd_gbn.index == 0) {
	
	    // Excel Export 
		if( dsPivot1.rowcount > 0 )
		{		
            gfn_exportExcel(div1.grd_list1,"안전점검_평가관리_설치협력사별");
   		    gfn_exportExcel(div1.grd_list2,"안전점검_평가관리_설치협력사팀장별");
			break;
		}
	}
}



/********************************************************************************
* 기      능   : 사무소 별 협력업체 필터 
********************************************************************************/
function cb_zzactss_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
    if(strCode == '') ds_zzlifnr.Filter("1==1");
	else ds_zzlifnr.Filter("ZZACTSS=="+quote(strCode)+" || CODE==''");
	cb_lifnr.Index = 0;
}
/********************************************************************************
* 기      능   : 사무소 별 협력업체 필터 
********************************************************************************/
function rd_gbn_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	if(rd_gbn.Index == 1) {
	    div0.Visible = true;
	    div1.Visible = false;
	} else if(rd_gbn.Index == 0) {
	    div1.Visible = true;
	    div0.Visible = false;
	    div1.top=div0.top;
	    div1.left=div0.left;
	}
}

/********************************************************************************
* 기      능   : 사무소 별 협력업체 필터 
********************************************************************************/
function cb_lifnr_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	ds_cond.SetColumn(0,"ZZLIFNR",strCode);
	cb_ztemno.value = "";
    var nHRow = ds_zzactss.SearchRow("CODE=\"" +  ds_zzlifnr.GetColumn(nNewIndex, "ZZACTSS") + "\""); 
    ds_cond.SetColumn(0,"ZZACTSS",ds_zzactss.GetColumn(nHRow, "CODE"));
	tit_clearActionInfo();			
	tit_addSearchActionInfo("qm05:QM0503001A_S1");
	tit_callService(
		""
		, ""
		, "ds_cond=ds_cond"
		, "ds_ztemno_cd=ds_ztemno_cd"  
		, ""
		, "fn_afterZtemnoChange"  
		, ""
		, ""
		, true);
}
/********************************************************************************
* 기      능   : 조회 Callback  - 사무소 변경시
********************************************************************************/
function fn_afterZtemnoChange(errCode, errMsg) {
	cb_ztemno.Index = 0;
	gfn_insertEmptyRow( ds_ztemno_cd, G_CODE_ALL );
	cb_ztemno.value = "";
}
/********************************************************************************
* 기      능   : 사무소 별 협력업체 필터 
********************************************************************************/
function div1_grd_list1_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
{
	if ( nCell == 0 ) {
		// 현재 처리할 format 기억
		gfn_selectGridCol("grd_list1");
	} else {
		//gfn_sortGrid(obj,nCell);

	}
}
/********************************************************************************
* 기      능   : 사무소 별 협력업체 필터 
********************************************************************************/
function cb_temno_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	if(cb_temno.Text == '- 전체 -')
    {
       ds_zzactss.UnFilter();
       ds_zzlifnr.UnFilter();
       ds_ztemno_cd.UnFilter();
       cb_zzactss.Index = 0;
       cb_lifnr.Index = 0;
       cb_ztemno.Index = 0;
    }
    else
    {
      var arr = ds_cond.GetColumn(0,"DTEXT4");
	   ds_zzactss.Filter("LENGTH(CODE) == 0 || DTEXT3 == "+quote(strCode));
	   cb_zzactss.Index = 0;
       cb_lifnr.Index = 0;
       cb_ztemno.Index = 0;
    }
}
/********************************************************************************
* 기      능   : 사무소 별 협력업체 필터 
********************************************************************************/
function div0_grd_list_OnCellClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
    if( nCell==10 ) 
	{          
		var posid = ds_list.GetColumn(nRow, "HOGI");
		var chkdat = ds_list.GetColumn(nRow, "CHKDAT");
        var zzgubun = ds_list.GetColumn(nRow, "ZZGUBUN");

		var arg = "POSID="+quote(posid);
	        arg += " CHKDAT="+quote(chkdat);
	        arg += " ZZGUBUN="+quote(zzgubun);
	   gfn_openPopup("PS1601006P",true,arg);

	}	
}
/********************************************************************************
* 기      능   : 환산점수 총합계값 구하기
********************************************************************************/
function fn_test6(currow)
{	
	var pivotColCount = this.dsPivot1.PivotIndexCount;

	var nIscoreCount = 0;
	for(var i=0; i < pivotColCount; i++)
	{
		//alert(this.dsPivot1.GetColumn(currow,"TOT",i));
		if(this.dsPivot1.GetColumn(currow,"TOT",i) == 0 )
		{
			nIscoreCount += 0;
		} 
		else if(this.dsPivot1.GetColumn(currow,"TOT",i) == null)
		{
			nIscoreCount += 0;
		} 
		else if(this.dsPivot1.GetColumn(currow,"TOT",i) == "")
		{
			nIscoreCount += 0;
		} 
		else{
			nIscoreCount += ToNumber(this.dsPivot1.GetColumn(currow,"TOT",i));
			
		}
			
	}

	return nIscoreCount;
}
/********************************************************************************
* 기      능   : 환산점수 총합계값 구하기
********************************************************************************/
function fn_test62(currow)
{	
	//pivotindex를 던지니 개별 계산함 pivotcount로 전체 구해서 전체중에 백분율 구해야함.
	var pivotColCount = this.dsPivot2.PivotIndexCount;
	
	var nIscoreCount = 0;
	for(var i=0; i < pivotColCount; i++)
	{
		if(this.dsPivot2.GetColumn(currow,"TOT",i) == 0 )
		{
			nIscoreCount += 0;
		} 
		else if(this.dsPivot2.GetColumn(currow,"TOT",i) == null)
		{
			nIscoreCount += 0;
		} 
		else if(this.dsPivot2.GetColumn(currow,"TOT",i) == "")
		{
			nIscoreCount += 0;
		} 
		else{
			nIscoreCount += ToNumber(this.dsPivot2.GetColumn(currow,"TOT",i));	
		}
	
			
	}
	
	return nIscoreCount;
}
/********************************************************************************
* 기      능   : 환산점수 총합계값 구하기
********************************************************************************/
function fn_sort(currow)
{	
	var pivotColCount = this.dsPivot1.PivotIndexCount;
/*
	var nIscoreCount = 0;
	for(var i=0; i < pivotColCount; i++)
	{
		//alert(this.dsPivot1.GetColumn(currow,"TOT",i));
		if(this.dsPivot1.GetColumn(currow,"POINTAVG2",i) == 0 )
		{
			nIscoreCount += 0;
		} 
		else if(this.dsPivot1.GetColumn(currow,"POINTAVG2",i) == null)
		{
			nIscoreCount += 0;
		} 
		else if(this.dsPivot1.GetColumn(currow,"POINTAVG2",i) == "")
		{
			nIscoreCount += 0;
		} 
		else{
			nIscoreCount += ToNumber(this.dsPivot1.GetColumn(currow,"POINTAVG2",i));
			
		}
			
	}
	*/
    this.dsPivot1.Sort("POINTAVG2");
	return nIscoreCount;
}


]]></Script>
</Window>