<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="562" Id="PS1601002A" Left="8" OnLoadCompleted="fn_OnLoadCompleted" OnUnloadCompleted="fn_OnUnloadCompleted" PidAttrib="7" Title="설치실적" Top="8" Ver="1.0" Width="978" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_cond">
				<Contents>
					<colinfo id="YEARF" size="256" summ="default" type="STRING"/>
					<colinfo id="MONTHF" size="256" summ="default" type="STRING"/>
					<colinfo id="YEART" size="256" summ="default" type="STRING"/>
					<colinfo id="MONTHT" size="256" summ="default" type="STRING"/>
					<colinfo id="YYYYMMF" size="256" summ="default" type="STRING"/>
					<colinfo id="YYYYMMT" size="256" summ="default" type="STRING"/>
					<colinfo id="DIFFMON" size="256" summ="default" type="STRING"/>
					<colinfo id="TEMNO" size="256" summ="default" type="STRING"/>
					<colinfo id="ZTEMNO" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZACTSS" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK_GBN" size="2" summ="default" type="STRING"/>
					<colinfo id="CHK_GBN2" size="2" summ="default" type="STRING"/>
					<colinfo id="USERGROUP" size="256" summ="default" type="STRING"/>
					<colinfo id="USERCODE" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZLIFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="NAMET2" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="ATYPE" size="256" summ="default" type="STRING"/>
					<colinfo id="SPEC" size="256" summ="default" type="INT"/>
					<colinfo id="SPEC2" size="256" summ="default" type="INT"/>
					<colinfo id="YYYYMMDD0" size="8" summ="default" type="STRING"/>
					<colinfo id="YYYYMMDD1" size="8" summ="default" type="STRING"/>
					<colinfo id="YYYYMMDD2" size="8" summ="default" type="STRING"/>
					<colinfo id="YYYYMMDD3" size="8" summ="default" type="STRING"/>
					<colinfo id="YYYYMMDD4" size="8" summ="default" type="STRING"/>
					<colinfo id="YYYYMMDD5" size="8" summ="default" type="STRING"/>
					<colinfo id="YYYYMMDD6" size="8" summ="default" type="STRING"/>
					<colinfo id="YYYYMMDD7" size="8" summ="default" type="STRING"/>
					<colinfo id="YYYYMMDD8" size="8" summ="default" type="STRING"/>
					<colinfo id="YYYYMMDD9" size="8" summ="default" type="STRING"/>
					<colinfo id="YYYYMMDD10" size="8" summ="default" type="STRING"/>
					<colinfo id="YYYYMMDD11" size="8" summ="default" type="STRING"/>
					<colinfo id="DIFF_MON" size="2" summ="default" type="STRING"/>
					<colinfo id="VAR1" size="256" summ="default" type="STRING"/>
					<record>
						<ATYPE></ATYPE>
						<CHK_GBN></CHK_GBN>
						<CHK_GBN2></CHK_GBN2>
						<DIFF_MON></DIFF_MON>
						<DIFFMON></DIFFMON>
						<GBN></GBN>
						<MONTHF></MONTHF>
						<MONTHT></MONTHT>
						<NAMET2></NAMET2>
						<SPEC/>
						<SPEC2/>
						<TEMNO></TEMNO>
						<USERCODE></USERCODE>
						<USERGROUP></USERGROUP>
						<VAR1></VAR1>
						<YEARF></YEARF>
						<YEART></YEART>
						<YYYYMMDD0></YYYYMMDD0>
						<YYYYMMDD1></YYYYMMDD1>
						<YYYYMMDD10></YYYYMMDD10>
						<YYYYMMDD11></YYYYMMDD11>
						<YYYYMMDD2></YYYYMMDD2>
						<YYYYMMDD3></YYYYMMDD3>
						<YYYYMMDD4></YYYYMMDD4>
						<YYYYMMDD5></YYYYMMDD5>
						<YYYYMMDD6></YYYYMMDD6>
						<YYYYMMDD7></YYYYMMDD7>
						<YYYYMMDD8></YYYYMMDD8>
						<YYYYMMDD9></YYYYMMDD9>
						<YYYYMMF></YYYYMMF>
						<YYYYMMT></YYYYMMT>
						<ZTEMNO></ZTEMNO>
						<ZZACTSS></ZZACTSS>
						<ZZLIFNR></ZZLIFNR>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_monthf_cd">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
					<record>
						<CODE>01</CODE>
						<CODE_NAME>1월</CODE_NAME>
					</record>
					<record>
						<CODE>02</CODE>
						<CODE_NAME>2월</CODE_NAME>
					</record>
					<record>
						<CODE>03</CODE>
						<CODE_NAME>3월</CODE_NAME>
					</record>
					<record>
						<CODE>04</CODE>
						<CODE_NAME>4월</CODE_NAME>
					</record>
					<record>
						<CODE>05</CODE>
						<CODE_NAME>5월</CODE_NAME>
					</record>
					<record>
						<CODE>06</CODE>
						<CODE_NAME>6월</CODE_NAME>
					</record>
					<record>
						<CODE>07</CODE>
						<CODE_NAME>7월</CODE_NAME>
					</record>
					<record>
						<CODE>08</CODE>
						<CODE_NAME>8월</CODE_NAME>
					</record>
					<record>
						<CODE>09</CODE>
						<CODE_NAME>9월</CODE_NAME>
					</record>
					<record>
						<CODE>10</CODE>
						<CODE_NAME>10월</CODE_NAME>
					</record>
					<record>
						<CODE>11</CODE>
						<CODE_NAME>11월</CODE_NAME>
					</record>
					<record>
						<CODE>12</CODE>
						<CODE_NAME>12월</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_montht_cd">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
					<record>
						<CODE>01</CODE>
						<CODE_NAME>1월</CODE_NAME>
					</record>
					<record>
						<CODE>02</CODE>
						<CODE_NAME>2월</CODE_NAME>
					</record>
					<record>
						<CODE>03</CODE>
						<CODE_NAME>3월</CODE_NAME>
					</record>
					<record>
						<CODE>04</CODE>
						<CODE_NAME>4월</CODE_NAME>
					</record>
					<record>
						<CODE>05</CODE>
						<CODE_NAME>5월</CODE_NAME>
					</record>
					<record>
						<CODE>06</CODE>
						<CODE_NAME>6월</CODE_NAME>
					</record>
					<record>
						<CODE>07</CODE>
						<CODE_NAME>7월</CODE_NAME>
					</record>
					<record>
						<CODE>08</CODE>
						<CODE_NAME>8월</CODE_NAME>
					</record>
					<record>
						<CODE>09</CODE>
						<CODE_NAME>9월</CODE_NAME>
					</record>
					<record>
						<CODE>10</CODE>
						<CODE_NAME>10월</CODE_NAME>
					</record>
					<record>
						<CODE>11</CODE>
						<CODE_NAME>11월</CODE_NAME>
					</record>
					<record>
						<CODE>12</CODE>
						<CODE_NAME>12월</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_yearf_cd">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_yeart_cd">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list">
				<Contents>
					<colinfo id="TAXDATE" size="10" summ="default" type="STRING"/>
					<colinfo id="TEMNM" size="20" summ="default" type="STRING"/>
					<colinfo id="ZZACTSS" size="50" summ="default" type="STRING"/>
					<colinfo id="LIFNR" size="10" summ="default" type="STRING"/>
					<colinfo id="LIFNRNM" size="35" summ="default" type="STRING"/>
					<colinfo id="NAMET2" size="20" summ="default" type="STRING"/>
					<colinfo id="HOGI" size="24" summ="default" type="STRING"/>
					<colinfo id="ZSITE_NM" size="35" summ="default" type="STRING"/>
					<colinfo id="ATYPE" size="5" summ="default" type="STRING"/>
					<colinfo id="SPEC" size="30" summ="default" type="STRING"/>
					<colinfo id="PRO_R" size="50" summ="default" type="DECIMAL"/>
					<colinfo id="LABMH" size="50" summ="default" type="DECIMAL"/>
					<colinfo id="TOT_MH" size="50" summ="default" type="DECIMAL"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_zzactss">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<colinfo id="DTEXT3" size="256" summ="default" type="STRING"/>
					<colinfo id="DTEXT4" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_zzlifnr">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
					<colinfo id="ZZACTSS" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_temno_cd">
				<Contents>
					<colinfo id="TEMNO" size="256" type="STRING"/>
					<colinfo id="NAMET" size="256" type="STRING"/>
					<record>
						<NAMET></NAMET>
						<TEMNO></TEMNO>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_team">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
					<colinfo id="ZZLIFNR" size="256" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME></CODE_NAME>
						<ZZLIFNR></ZZLIFNR>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ztemno_cd">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list1">
				<Contents>
					<colinfo id="PAPRYYYYMM" size="10" summ="default" type="STRING"/>
					<colinfo id="TEMNM" size="20" summ="default" type="STRING"/>
					<colinfo id="ZZACTSS" size="50" summ="default" type="STRING"/>
					<colinfo id="LIFNR" size="10" summ="default" type="STRING"/>
					<colinfo id="LIFNRNM" size="35" summ="default" type="STRING"/>
					<colinfo id="TOT_MH" size="50" summ="default" type="STRING"/>
					<colinfo id="CNT2" size="50" summ="default" type="STRING"/>
					<colinfo id="PER_TOT_MH" size="50" summ="default" type="STRING"/>
					<colinfo id="CNT1" size="50" summ="default" type="STRING"/>
					<colinfo id="POINT" size="50" summ="default" type="STRING"/>
					<colinfo id="PER_TOT_MH_SUM" size="50" summ="default" type="STRING"/>
					<colinfo id="CNT1_SUM" size="50" summ="default" type="STRING"/>
					<colinfo id="POINT_SUM" size="50" summ="default" type="STRING"/>
					<colinfo id="RANKING" size="50" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_zzactss_0">
				<Contents>
					<colinfo id="DTEXT3" size="256" summ="default" type="STRING"/>
					<colinfo id="DTEXT4" size="256" summ="default" type="STRING"/>
					<record>
						<DTEXT3></DTEXT3>
						<DTEXT4>-&#32;전체&#32;-</DTEXT4>
					</record>
					<record>
						<DTEXT3>1</DTEXT3>
						<DTEXT4>설치1팀</DTEXT4>
					</record>
					<record>
						<DTEXT3>2</DTEXT3>
						<DTEXT4>설치2팀</DTEXT4>
					</record>
					<record>
						<DTEXT3>3</DTEXT3>
						<DTEXT4>설치3팀</DTEXT4>
					</record>
					<record>
						<DTEXT3>4</DTEXT3>
						<DTEXT4>설치4팀</DTEXT4>
					</record>
					<record>
						<DTEXT3>5</DTEXT3>
						<DTEXT4>MP설치팀</DTEXT4>
					</record>
					<record>
						<DTEXT3>6</DTEXT3>
						<DTEXT4>리모델링팀</DTEXT4>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_spec1">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NM" size="256" summ="default" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NM>-&#32;전체&#32;-</CODE_NM>
					</record>
					<record>
						<CODE>HSVF</CODE>
						<CODE_NM>HSVF</CODE_NM>
					</record>
					<record>
						<CODE>LXVF</CODE>
						<CODE_NM>LXVF</CODE_NM>
					</record>
					<record>
						<CODE>SSVF</CODE>
						<CODE_NM>SSVF</CODE_NM>
					</record>
					<record>
						<CODE>STVF</CODE>
						<CODE_NM>STVF</CODE_NM>
					</record>
					<record>
						<CODE>WBSS</CODE>
						<CODE_NM>WBSS</CODE_NM>
					</record>
					<record>
						<CODE>SUVF</CODE>
						<CODE_NM>SUVF</CODE_NM>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list2">
				<Contents>
					<colinfo id="PAPRYYYYMM" size="10" summ="default" type="STRING"/>
					<colinfo id="TEMNM" size="20" summ="default" type="STRING"/>
					<colinfo id="ZZACTSS" size="50" summ="default" type="STRING"/>
					<colinfo id="LIFNR" size="10" summ="default" type="STRING"/>
					<colinfo id="LIFNRNM" size="35" summ="default" type="STRING"/>
					<colinfo id="TEMNO" size="6" summ="default" type="STRING"/>
					<colinfo id="NAMET2" size="20" summ="default" type="STRING"/>
					<colinfo id="TOT_MH" size="50" summ="default" type="STRING"/>
					<colinfo id="CNT2" size="50" summ="default" type="STRING"/>
					<colinfo id="PER_TOT_MH" size="50" summ="default" type="STRING"/>
					<colinfo id="CNT1" size="50" summ="default" type="STRING"/>
					<colinfo id="POINT" size="50" summ="default" type="STRING"/>
					<colinfo id="PER_TOT_MH_SUM" size="50" summ="default" type="STRING"/>
					<colinfo id="CNT1_SUM" size="50" summ="default" type="STRING"/>
					<colinfo id="POINT_SUM" size="50" summ="default" type="STRING"/>
					<colinfo id="RANKING" size="50" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_spec_0">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NM" size="256" summ="default" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NM>-&#32;전체&#32;-</CODE_NM>
					</record>
					<record>
						<CODE>45</CODE>
						<CODE_NM>45</CODE_NM>
					</record>
					<record>
						<CODE>60</CODE>
						<CODE_NM>60</CODE_NM>
					</record>
					<record>
						<CODE>90</CODE>
						<CODE_NM>90</CODE_NM>
					</record>
					<record>
						<CODE>105</CODE>
						<CODE_NM>105</CODE_NM>
					</record>
					<record>
						<CODE>120</CODE>
						<CODE_NM>120</CODE_NM>
					</record>
					<record>
						<CODE>150</CODE>
						<CODE_NM>150</CODE_NM>
					</record>
					<record>
						<CODE>180</CODE>
						<CODE_NM>180</CODE_NM>
					</record>
					<record>
						<CODE>210</CODE>
						<CODE_NM>210</CODE_NM>
					</record>
					<record>
						<CODE>240</CODE>
						<CODE_NM>240</CODE_NM>
					</record>
					<record>
						<CODE>300</CODE>
						<CODE_NM>300이상</CODE_NM>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_spec">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NM" size="256" summ="default" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NM>-&#32;전체&#32;-</CODE_NM>
					</record>
					<record>
						<CODE>45</CODE>
						<CODE_NM>45</CODE_NM>
					</record>
					<record>
						<CODE>60</CODE>
						<CODE_NM>60</CODE_NM>
					</record>
					<record>
						<CODE>90</CODE>
						<CODE_NM>90</CODE_NM>
					</record>
					<record>
						<CODE>105</CODE>
						<CODE_NM>105</CODE_NM>
					</record>
					<record>
						<CODE>120</CODE>
						<CODE_NM>120</CODE_NM>
					</record>
					<record>
						<CODE>150</CODE>
						<CODE_NM>150</CODE_NM>
					</record>
					<record>
						<CODE>180</CODE>
						<CODE_NM>180</CODE_NM>
					</record>
					<record>
						<CODE>210</CODE>
						<CODE_NM>210</CODE_NM>
					</record>
					<record>
						<CODE>240</CODE>
						<CODE_NM>240</CODE_NM>
					</record>
					<record>
						<CODE>300</CODE>
						<CODE_NM>300이상</CODE_NM>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_months" UseClientLayout="1">
				<Contents>
					<colinfo id="DIFFMONTHS" size="10" summ="default" type="STRING"/>
					<colinfo id="RN" size="10" summ="default" type="INT"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_var">
				<Contents>
					<colinfo id="VAR1" size="256" summ="default" type="STRING"/>
					<colinfo id="VAR2" size="256" summ="default" type="STRING"/>
					<colinfo id="VAR3" size="256" summ="default" type="STRING"/>
					<colinfo id="VAR4" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_invar">
				<Contents>
					<colinfo id="SCR_ID" size="7" summ="default" type="STRING"/>
					<colinfo id="SCR_GUBUN" size="1" summ="default" type="STRING"/>
					<colinfo id="GUBUN1" size="1" summ="default" type="STRING"/>
					<colinfo id="ORD" size="3" summ="default" type="STRING"/>
					<record>
						<GUBUN1>1</GUBUN1>
						<ORD>1</ORD>
						<SCR_GUBUN>3</SCR_GUBUN>
						<SCR_ID>1601005</SCR_ID>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataObject="ds_list1" DataSetType="Pivot" GroupKey="TEMNM:ZZACTSS:LIFNR:LIFNRNM" Id="dsPivot1" PivotKey="PAPRYYYYMM" UseClientLayout="1"></Dataset>
			<Dataset DataObject="ds_list2" DataSetType="Pivot" GroupKey="LIFNRNM:TEMNM:ZZACTSS:TEMNO:NAMET2" Id="dsPivot2" PivotKey="PAPRYYYYMM" UseClientLayout="1"></Dataset>
		</Datasets>
		<Div Height="750" Id="div0" Left="8" TabOrder="1" Text="Div0" Top="56" Width="968">
			<Contents>
				<Grid AreaSelect="true" AutoFitEndLine="Hide" BindDataset="ds_list" BkColor2="default" BoldHead="true" Border="Flat" Bottom="750" CellMoving="TRUE" ColSizing="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="750" Id="grd_list" InputPanel="FALSE" LineColor="user20" LineType="ExHORZ" OnCellDBLClick="grd_list_OnCellDblClick" OnExpandEdit="div0_grd_list_OnExpandEdit" OnHeadClick="grd_list_OnHeadClick" Right="952" RowHeight="20" Style="sty_grid" TabOrder="1" TabStop="true" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="952">
					<contents>
						<format id="Default">
							<columns>
								<col width="30"/>
								<col width="80"/>
								<col width="60"/>
								<col width="63"/>
								<col width="140"/>
								<col width="56"/>
								<col width="90"/>
								<col width="200"/>
								<col width="150"/>
								<col width="130"/>
								<col width="150"/>
								<col width="150"/>
								<col width="150"/>
							</columns>
							<head>
								<cell bkimageid="icon_grid_sel" col="0" display="text" font="굴림,9" TrimType="Left"/>
								<cell col="1" display="text" font="굴림,9" text="일자"/>
								<cell col="2" display="text" font="굴림,9" text="설치팀명"/>
								<cell col="3" display="text" font="굴림,9" text="지사"/>
								<cell col="4" display="text" font="굴림,9" text="업체명" TrimType="Left"/>
								<cell col="5" display="text" font="굴림,9" text="팀장"/>
								<cell col="6" display="text" font="굴림,9" text="호기"/>
								<cell col="7" display="text" font="굴림,9" text="현장명"/>
								<cell col="8" display="text" font="굴림,9" text="기종"/>
								<cell col="9" display="text" font="굴림,9" text="사양"/>
								<cell col="10" display="text" font="굴림,9" text="실적대수"/>
								<cell col="11" display="text" font="굴림,9" text="발주MH"/>
								<cell col="12" display="text" font="굴림,9" text="실적MH"/>
							</head>
							<body>
								<cell align="center" bkcolor2="user22" col="0" display="text" expr="currow+1"/>
								<cell align="left" col="1" colid="TAXDATE" display="text" Mask="####-##-##"/>
								<cell align="left" col="2" colid="TEMNM" display="text"/>
								<cell align="center" col="3" colid="ZZACTSS" display="text"/>
								<cell align="left" bkcolor2="user22" col="4" colid="LIFNRNM" display="text"/>
								<cell align="left" bkcolor2="user22" col="5" colid="NAMET2" display="text"/>
								<cell align="left" col="6" colid="HOGI" display="text"/>
								<cell align="left" bkcolor2="user22" col="7" colid="ZSITE_NM" display="text"/>
								<cell align="left" bkcolor2="user22" col="8" colid="ATYPE" display="text"/>
								<cell align="left" bkcolor2="user22" col="9" colid="SPEC" display="text"/>
								<cell align="right" col="10" colid="PRO_R" display="number"/>
								<cell align="right" col="11" colid="LABMH" display="number"/>
								<cell align="right" col="12" colid="TOT_MH" display="number" expandsize="19"/>
							</body>
							<summary>
								<cell col="0" display="text"/>
								<cell col="1" display="text"/>
								<cell col="2" display="text"/>
								<cell col="3" display="text"/>
								<cell col="4" display="text"/>
								<cell col="5" display="text"/>
								<cell col="6" display="text"/>
								<cell col="7" display="text" text="합&#32;계"/>
								<cell col="8" display="text"/>
								<cell col="9" display="text"/>
								<cell align="right" col="10" display="text" expr="sum(&apos;PRO_R&apos;)"/>
								<cell align="right" col="11" display="text" expr="sum(&apos;LABMH&apos;)"/>
								<cell align="right" col="12" display="text" expr="sum(&apos;TOT_MH&apos;)"/>
							</summary>
						</format>
					</contents>
				</Grid>
			</Contents>
		</Div>
		<Shape BKColor="user0" Bottom="55" Height="55" Id="Shape1" Left="8" LineColor="user1" Right="970" TabOrder="2" Top="0" Type="Rectangle" Width="962"></Shape>
		<Static Align="Right" Height="20" Id="st_lifnr" Left="13" Style="sty_lb_search" TabOrder="4" Text="설치협력사&#32;" Top="32" VAlign="Middle" Width="80"></Static>
		<Static Align="Right" Height="20" Id="st_yymm" Left="13" Style="sty_lb_search" TabOrder="3" Text="평가기간&#32;" Top="6" VAlign="Middle" Width="80"></Static>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="CODE" Column="ZZLIFNR" DataColumn="CODE_NAME" Height="20" Id="cb_lifnr" INDEX="1" InnerDataset="ds_zzlifnr" Left="98" OnChanged="cb_lifnr_OnChanged" Style="sty_ipt_search" TabOrder="8" Top="30" Width="130"></Combo>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="CODE" Column="YEARF" DataColumn="CODE_NAME" Height="20" Id="cb_yearf" InnerDataset="ds_yearf_cd" Left="98" Style="sty_ipt_search" TabOrder="5" Top="5" Width="60"></Combo>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="CODE" Column="MONTHF" DataColumn="CODE_NAME" Height="20" Id="cb_monthf" InnerDataset="ds_monthf_cd" Left="160" Style="sty_ipt_search" TabOrder="11" Top="5" Width="50"></Combo>
		<Static Align="Center" Border="None" Color="user7" Font="굴림,9" Height="14" Id="Static13" Left="207" TabOrder="7" Text="~" Top="11" VAlign="Middle" Width="18"></Static>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="CODE" Column="YEART" DataColumn="CODE_NAME" Height="20" Id="cb_yeart" InnerDataset="ds_yeart_cd" Left="225" Style="sty_ipt_search" TabOrder="6" Top="5" Width="60"></Combo>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="CODE" Column="MONTHT" DataColumn="CODE_NAME" Height="20" Id="cb_montht" InnerDataset="ds_montht_cd" Left="288" Style="sty_ipt_search" TabOrder="12" Top="5" Width="50"></Combo>
		<Static Align="Right" Height="20" Id="Static0" Left="351" Style="sty_lb_search" TabOrder="16" Text="설치팀&#32;" Top="6" VAlign="Middle" Width="80"></Static>
		<Static Align="Right" Height="20" Id="Static2" Left="351" Style="sty_lb_search" TabOrder="18" Text="설치팀장" Top="32" VAlign="Middle" Width="80"></Static>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="CODE" Column="ZTEMNO" DataColumn="CODE_NAME" Height="20" Id="cb_ztemno" INDEX="1" InnerDataset="ds_ztemno_cd" Left="437" Style="sty_ipt_search" TabOrder="19" Top="30" Width="103"></Combo>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="DTEXT3" Column="TEMNO" DataColumn="DTEXT4" Height="20" Id="cb_temno" INDEX="0" InnerDataset="ds_zzactss_0" Left="437" OnChanged="cb_temno_OnChanged" Style="sty_ipt_search" TabOrder="17" Top="5" Width="103"></Combo>
		<Static Align="Right" Height="20" Id="st_zzactss" Left="546" Style="sty_lb_search" TabOrder="9" Text="사무소&#32;" Top="6" VAlign="Middle" Width="80"></Static>
		<Static Align="Right" Height="20" Id="Static1" Left="546" Style="sty_lb_search" TabOrder="15" Text="평가구분" Top="32" VAlign="Middle" Width="80"></Static>
		<Radio Border="None" Height="20" Id="rd_gbn" INDEX="0" Left="632" OnChanged="rd_gbn_OnChanged" Style="sty_ipt_form_radio" TabOrder="14" Top="32" Width="182">
			<Contents>
				<Layout code="1" height="15" left="10" text="총괄표" top="5" width="65"/>
				<Layout code="2" height="15" left="80" text="실적현황" top="5" width="85"/>
			</Contents>
		</Radio>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="CODE" Column="ZZACTSS" DataColumn="CODE_NAME" Height="20" Id="cb_zzactss" InnerDataset="ds_zzactss" Left="631" OnChanged="cb_zzactss_OnChanged" Style="sty_ipt_search" TabOrder="10" Top="5" Width="97"></Combo>
		<Static Align="Right" Height="20" Id="st_gubun" Left="749" Style="sty_lb_search" TabOrder="13" Text="구분&#32;" Top="6" VAlign="Middle" Width="80"></Static>
		<Radio Border="None" Height="20" Id="rd_gbn2" INDEX="0" Left="837" Style="sty_ipt_form_radio" TabOrder="20" Top="5" Width="152">
			<Contents>
				<Layout code="10" height="15" left="10" text="E/L" top="5" width="50"/>
				<Layout code="11" height="15" left="60" text="E/S" top="5" width="50"/>
				<Layout code="20" height="15" left="110" text="주차" top="5" width="50"/>
			</Contents>
		</Radio>
		<Static Align="Right" Height="20" Id="Static5" Left="999" Style="sty_lb_search" TabOrder="21" Text="기종" Top="6" VAlign="Middle" Width="80"></Static>
		<Static Align="Right" Height="20" Id="Static6" Left="999" Style="sty_lb_search" TabOrder="23" Text="속도" Top="32" VAlign="Middle" Width="80"></Static>
		<Combo Border="Flat" CodeColumn="CODE" DataColumn="CODE_NM" Height="20" Id="Combo2" INDEX="0" InnerDataset="ds_spec" Left="1085" Style="sty_ipt_search" TabOrder="24" Top="32" Width="103"></Combo>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="CODE" Column="ATYPE" DataColumn="CODE_NM" Height="20" Id="Combo1" INDEX="0" InnerDataset="ds_spec1" Left="1085" Style="sty_ipt_search" TabOrder="22" Top="6" Width="103"></Combo>
		<Static Height="19" Id="Static7" Left="1194" TabOrder="26" Text="~" Top="31" Width="17"></Static>
		<Combo Border="Flat" CodeColumn="CODE" DataColumn="CODE_NM" Height="20" Id="Combo0" INDEX="0" InnerDataset="ds_spec_0" Left="1208" Style="sty_ipt_search" TabOrder="25" Top="32" Width="103"></Combo>
		<Div Height="750" Id="div1" Left="8" TabOrder="27" Text="Div0" Top="56" Width="968">
			<Contents>
				<Static Color="user6" Font="굴림,9" Height="13" Id="Static8" Left="8" TabOrder="1" Text="※설치협력사" Top="8" VAlign="Middle" Width="102"></Static>
				<Static Color="user6" Font="굴림,9" Height="13" Id="Static7" TabOrder="2" Text="※설치팀장" Top="381" VAlign="Middle" Width="94"></Static>
				<Static Color="user6" Font="굴림,9" Height="13" Id="Static0" Left="928" TabOrder="3" Text="명" Top="382" VAlign="Middle" Width="30"></Static>
				<Static Color="user6" Font="굴림,9" Height="13" Id="Static1" Left="784" TabOrder="4" Text="※설치팀장수" Top="381" VAlign="Middle" Width="86"></Static>
				<Static Color="user6" Font="굴림,9" Height="13" Id="Static2" Left="764" TabOrder="5" Text="※설치협력사수" Top="8" VAlign="Middle" Width="86"></Static>
				<Static Color="user6" Font="굴림,9" Height="13" Id="Static3" Left="940" TabOrder="6" Text="개사" Top="8" VAlign="Middle" Width="30"></Static>
				<Grid AutoEnter="TRUE" BindDataset="dsPivot1" BkColor2="default" BoldHead="FALSE" Border="Flat" Bottom="366" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="30" Height="334" Id="grd_list1" InputPanel="FALSE" LineColor="user13" LineType="ExVERT" OnHeadClick="div1_grd_list1_OnHeadClick" Right="950" RowHeight="21" Style="sty_grid" TabOrder="7" TabStop="true" Top="32" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="950">
					<contents>
						<format id="Default">
							<columns>
								<col fix="left" width="31"/>
								<col fix="left" width="60"/>
								<col fix="left" width="50"/>
								<col fix="left" width="100"/>
								<col fix="left" width="53"/>
								<col width="80"/>
								<col width="50"/>
								<col width="60"/>
								<col width="50"/>
								<col width="50"/>
								<col fix="right" width="80"/>
								<col fix="right" width="50"/>
								<col fix="right" width="50"/>
								<col fix="right" width="52"/>
								<col fix="right" width="50"/>
								<col fix="right" width="50"/>
							</columns>
							<head>
								<cell col="0" display="text" rowspan="2" text="No"/>
								<cell col="1" display="text" rowspan="2" text="설치팀"/>
								<cell col="2" display="text" rowspan="2" text="지사"/>
								<cell col="3" display="text" rowspan="2" text="업체명"/>
								<cell col="4" color="user21" display="text" limit="-1" rowspan="2" text="팀장"/>
								<cell align="center" col="5" color="user21" colspan="5" display="text" expr='substr(PAPRYYYYMM,0,4)+&quot;년&#32;&quot;+substr(PAPRYYYYMM,4,&#32;2)+&quot;월&quot;' font="굴림,9,Bold" limit="-1"/>
								<cell col="10" colspan="5" display="text" text="집계"/>
								<cell col="10" display="text" expr='&quot;실적MH&quot;+&quot;\n&quot;&#32;+&quot;누계&quot;' row="1"/>
								<cell col="11" display="text" expr='&quot;보유인원&quot;+&quot;\n&quot;&#32;+&quot;누계&quot;' row="1" text="보유인원"/>
								<cell col="12" display="text" expr='&quot;인당실적&quot;+&quot;\n&quot;&#32;+&quot;MH&quot;' row="1" text="인당대수"/>
								<cell col="14" display="text" row="1" text="평균환산"/>
								<cell col="15" display="text" rowspan="2" text="순위"/>
								<cell col="5" color="user21" display="text" limit="-1" row="1" text="실적MH"/>
								<cell col="6" color="user21" display="text" limit="-1" row="1" text="보유인원"/>
								<cell col="7" display="text" expr='&quot;인당실적&quot;+&quot;\n&quot;&#32;+&quot;MH&quot;' row="1"/>
								<cell col="8" display="text" expr='&quot;인당기성&quot;+&quot;\n&quot;+&quot;설치대수&quot;' row="1"/>
								<cell col="9" display="text" row="1" text="환산점수"/>
								<cell col="13" display="text" expr='&quot;인당기성&quot;+&quot;\n&quot;+&quot;설치대수&quot;' row="1"/>
							</head>
							<body>
								<cell col="0" display="text" expr="CURROW+1"/>
								<cell col="1" colid="TEMNM" display="text"/>
								<cell col="2" colid="ZZACTSS" display="text"/>
								<cell col="3" colid="LIFNRNM" display="text"/>
								<cell align="center" col="4" display="text" limit="-1" text="전체"/>
								<cell align="right" col="5" colid="TOT_MH" display="number" limit="-1" Mask="#,##0.0"/>
								<cell align="right" col="6" colid="CNT2" display="number" limit="-1" Mask="#,##0.00"/>
								<cell align="right" col="7" colid="PER_TOT_MH" display="number" Mask="#,##0.00"/>
								<cell col="8" colid="CNT1" display="number" Mask="#,##0.00"/>
								<cell align="right" col="9" colid="POINT" display="number" Mask="#,##0.0"/>
								<cell align="right" col="10" display="number" expr='PivotSum(&quot;TOT_MH&quot;&#32;,&#32;currow)' Mask="#,##0.00"/>
								<cell align="right" col="11" display="number" expr='PivotSum(&quot;CNT2&quot;&#32;,&#32;currow)' Mask="#,##0.0"/>
								<cell align="right" col="12" display="number" expr="PER_TOT_MH_SUM/dsPivot1.PivotCount(&apos;LIFNR&apos;,currow)" Mask="#,##0.00"/>
								<cell align="right" col="13" display="number" expr="CNT1_SUM/dsPivot1.PivotCount(&apos;LIFNR&apos;,currow)" Mask="#,##0.00"/>
								<cell align="right" col="14" display="number" expr="POINT_SUM/dsPivot1.PivotCount(&apos;LIFNR&apos;,currow)" limit="-1" Mask="#,##0.00"/>
								<cell align="right" col="15" colid="RANKING" display="number" expr="RANKING/PivotCount(&apos;LIFNR&apos;,currow)" Mask="#,##0"/>
							</body>
						</format>
					</contents>
				</Grid>
				<Static Color="user6" Font="굴림,9" Height="13" Id="stc_sum1" Left="885" TabOrder="8" Text="00" Top="8" VAlign="Middle" Width="30"></Static>
				<Static Color="user6" Font="굴림,9" Height="13" Id="stc_sum2" Left="889" TabOrder="9" Text="00" Top="382" VAlign="Middle" Width="30"></Static>
				<Grid AutoEnter="TRUE" BindDataset="dsPivot2" BkColor2="default" BoldHead="FALSE" Border="Flat" Bottom="734" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="30" Height="334" Id="grd_list2" InputPanel="FALSE" LineColor="user13" LineType="ExVERT" OnHeadClick="div1_grd_list1_OnHeadClick" Right="950" RowHeight="21" Style="sty_grid" TabOrder="10" TabStop="true" Top="400" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="950">
					<contents>
						<format id="Default">
							<columns>
								<col fix="left" width="31"/>
								<col fix="left" width="60"/>
								<col fix="left" width="50"/>
								<col fix="left" width="100"/>
								<col fix="left" width="53"/>
								<col width="80"/>
								<col width="50"/>
								<col width="60"/>
								<col width="50"/>
								<col width="50"/>
								<col fix="right" width="80"/>
								<col fix="right" width="50"/>
								<col fix="right" width="50"/>
								<col fix="right" width="52"/>
								<col fix="right" width="50"/>
								<col fix="right" width="50"/>
							</columns>
							<head>
								<cell col="0" display="text" rowspan="2" text="No"/>
								<cell col="1" display="text" rowspan="2" text="설치팀"/>
								<cell col="2" display="text" rowspan="2" text="지사"/>
								<cell col="3" display="text" rowspan="2" text="업체명"/>
								<cell col="4" color="user21" display="text" limit="-1" rowspan="2" text="팀장"/>
								<cell align="center" col="5" color="user21" colspan="5" display="text" expr='substr(PAPRYYYYMM,0,4)+&quot;년&#32;&quot;+substr(PAPRYYYYMM,4,&#32;2)+&quot;월&quot;' font="굴림,9,Bold" limit="-1"/>
								<cell col="10" colspan="5" display="text" text="집계"/>
								<cell col="10" display="text" expr='&quot;실적MH&quot;+&quot;\n&quot;&#32;+&quot;누계&quot;' row="1"/>
								<cell col="11" display="text" expr='&quot;보유인원&quot;+&quot;\n&quot;&#32;+&quot;누계&quot;' row="1"/>
								<cell col="12" display="text" expr='&quot;인당실적&quot;+&quot;\n&quot;&#32;+&quot;MH&quot;' row="1" text="인당대수"/>
								<cell col="14" display="text" row="1" text="평균환산"/>
								<cell col="15" display="text" rowspan="2" text="순위"/>
								<cell col="5" color="user21" display="text" limit="-1" row="1" text="실적MH"/>
								<cell col="6" color="user21" display="text" limit="-1" row="1" text="보유인원"/>
								<cell col="7" display="text" expr='&quot;인당실적&quot;+&quot;\n&quot;&#32;+&quot;MH&quot;' row="1"/>
								<cell col="8" display="text" expr='&quot;인당기성&quot;+&quot;\n&quot;+&quot;설치대수&quot;' row="1"/>
								<cell col="9" display="text" row="1" text="환산점수"/>
								<cell col="13" display="text" expr='&quot;인당기성&quot;+&quot;\n&quot;+&quot;설치대수&quot;' row="1"/>
							</head>
							<body>
								<cell col="0" display="text" expr="CURROW+1"/>
								<cell col="1" colid="TEMNM" display="text"/>
								<cell col="2" colid="ZZACTSS" display="text"/>
								<cell col="3" colid="LIFNRNM" display="text"/>
								<cell align="center" col="4" colid="NAMET2" display="text" limit="-1" text="전체"/>
								<cell align="right" col="5" colid="TOT_MH" display="number" limit="-1" Mask="#,##0.0"/>
								<cell align="right" col="6" colid="CNT2" display="number" limit="-1" Mask="#,##0.00"/>
								<cell align="right" col="7" colid="PER_TOT_MH" display="number" Mask="#,##0.00"/>
								<cell col="8" colid="CNT1" display="number" Mask="#,##0.00"/>
								<cell align="right" col="9" colid="POINT" display="number" Mask="#,##0.0"/>
								<cell align="right" col="10" display="number" expr='PivotSum(&quot;TOT_MH&quot;&#32;,&#32;currow)' Mask="#,##0.00"/>
								<cell align="right" col="11" display="number" expr='PivotSum(&quot;CNT2&quot;&#32;,&#32;currow)' Mask="#,##0.0"/>
								<cell align="right" col="12" display="number" expr="PER_TOT_MH_SUM/dsPivot2.PivotCount(&apos;TEMNO&apos;,currow)" Mask="#,##0.00"/>
								<cell align="right" col="13" display="number" expr="CNT1_SUM/dsPivot2.PivotCount(&apos;TEMNO&apos;,currow)" Mask="#,##0.00"/>
								<cell align="right" col="14" display="number" expr="POINT_SUM/dsPivot2.PivotCount(&apos;TEMNO&apos;,currow)" limit="-1" Mask="#,##0.00"/>
								<cell align="right" col="15" colid="RANKING" display="number" expr="RANKING/dsPivot2.PivotCount(&apos;TEMNO&apos;,currow)" Mask="#,##0"/>
							</body>
						</format>
					</contents>
				</Grid>
			</Contents>
		</Div>
	</Form>
	<Script><![CDATA[﻿﻿﻿﻿﻿﻿/*
 ******************************************************************************************
 * 기      능   :  협력업체 평가 (설치실적) 조회
 * 작  성  자   : swnam
 * 작성  일자   : 20191201
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
#include "LIB::commons.js"; // 공통 스크립트 
//=========================================================================================
// [ PART 1 ]
// Form에서 사용될 전역변수를 선언
// FORM에서 사용되는 전역변수는 대문자로 작성하며, F_XXX 의 형태를 갖도록 한다. 
//=========================================================================================
var userGroup = "";
//=========================================================================================
// [ PART 2 ]
// Form Loading / Unloading 시 작업 정의
//=========================================================================================
function fn_OnLoadCompleted(obj) {
    // Form 로드 이벤트 맨 첫줄에 기술 
    gfn_initForm(true);

    userGroup = gfn_getUserGroup();
    rd_gbn.Index = 0;
    rd_gbn2.Index = 0;
    cb_zzactss.Index = 0;
    Combo0.Index = 0;
    Combo2.Index = 0;
    Combo1.Index = 0;
    div0.Visible = false;
    div1.Visible = true;
    div0.top=Shape1.Bottom+1;
    div0.left=Shape1.left+1;
    div1.top=Shape1.Bottom+1;
    div1.left=Shape1.left+1;
    var curYear = substr(gfn_getCurrDate(),0,4);
    fn_makeYear(curYear,-5,10);
    cb_monthf.index = parseInt(substr(gfn_getCurrDate(),4,2))-1;
    cb_montht.index = parseInt(substr(gfn_getCurrDate(),4,2))-1;
    
    ds_cond.SetColumn(0,"USERGROUP",userGroup);

    //코드콤보 설정 : 지역, 구분2
    var codeArr = ["PS003"];
    var dsObjArr = [ds_zzactss];
    var addTypeArr = [G_CODE_ALL];
    gfn_searchCommCode(codeArr, dsObjArr, addTypeArr);

    tit_clearActionInfo();
    tit_addSearchActionInfo("wb01:SEOLCHI_VEND_S2");    

    tit_callService(
        ""
        , ""
        , "ds_cond=ds_cond"
        , "ds_zzlifnr=ds_lifnr_cd"  
        , ""
        , "fn_afterQueryC"
        , ""
        , ""
        , true);

    fn_initQuery(); 
}

function fn_initQuery() {

    tit_clearActionInfo();
    tit_addSearchActionInfo("qm05:QM0501001A_S1");
    tit_addSearchActionInfo("ps02:PS0203001A_S1");
    tit_callService(
        ""
        , ""
        , "ds_cond=ds_cond"
        , "ds_team=ds_team ds_zzlifnr=ds_zzlifnr"
        , ""
        , "fn_afterInitQuery"
        , true);
        
     tit_clearActionInfo();
    tit_addSearchActionInfo("ps16:PS1601011A_S7");
    tit_callService(
        ""
        , ""
        , "ds_invar=ds_invar"
        , "ds_var=ds_var"
        , ""
        , "fn_afterSearchVar"
        , true);
     
}

function fn_afterInitQuery(){

    if(userGroup == '10')
    {
        ds_zzlifnr.Filter("CODE=="+quote(G_VEND_CODE_E));
        cb_lifnr.Index = 0;
        cb_lifnr.Enable = false;
        
        ds_team.Filter("ZZLIFNR=="+quote(G_VEND_CODE_E)+" || CODE==''");
        cb_ztemno.Index = 0;
        cb_ztemno.Enable = true;
    }
    else if(userGroup == '30')
    {
        gfn_insertEmptyRow( ds_zzlifnr, G_CODE_ALL );
        ds_zzlifnr.Filter("ZZACTSS=="+quote(G_AREA_CODE_E)+" || CODE==''");
        cb_lifnr.Index = 0;
        cb_lifnr.Enable = true;
    }
    else
    {
        gfn_insertEmptyRow( ds_zzlifnr, G_CODE_ALL );
        cb_lifnr.Index = 0;
        cb_lifnr.Enable = true;
    }
    gfn_insertEmptyRow( ds_team, G_CODE_ALL );
    cb_ztemno.Index = 0;
}
/********************************************************************************
* 기      능   : 수식변수 조건 셋팅
********************************************************************************/
function fn_afterSearchVar(){
	ds_cond.SetColumn(0,"VAR1", toString(ds_var.GetColumn(0,"VAR1"))); //작업시간 
}
/********************************************************************************
* 기      능   : 지급예정년 계산(현재년도,당해년도에서 뺄 년수, 당해년도에서 더할 년수
********************************************************************************/
function fn_makeYear(curYear,sNum,eNum)
{
    var rowCnt = eNum-sNum;
    var row = 0;

    for(var i=rowCnt; i>-1; i--)
    {
        ds_yearf_cd.AddRow();
        ds_yearf_cd.SetColumn(row,"CODE",parseInt(curYear)+i+parseInt(sNum));
        ds_yearf_cd.SetColumn(row,"CODE_NAME",(parseInt(curYear)+i+parseInt(sNum))+"년");
        ds_yeart_cd.AddRow();
        ds_yeart_cd.SetColumn(row,"CODE",parseInt(curYear)+i+parseInt(sNum));
        ds_yeart_cd.SetColumn(row,"CODE_NAME",(parseInt(curYear)+i+parseInt(sNum))+"년");
        row++;
    }
    cb_yearf.index = eNum;
    cb_yeart.index = eNum;
}

/********************************************************************************
* 기      능   : 조회 (header 조회)
********************************************************************************/
function fn_query() {
    if(gfn_isNull(cb_yearf, true, st_yymm.value)) return;
    if(gfn_isNull(cb_monthf, true, st_yymm.value)) return;
    if(gfn_isNull(cb_yeart, true, st_yymm.value)) return;
    if(gfn_isNull(cb_montht, true, st_yymm.value)) return;
    if(parseInt(ds_cond.GetColumn(0,"YEARF")+ds_cond.GetColumn(0,"MONTHF")) > 
       parseInt(ds_cond.GetColumn(0,"YEART")+ds_cond.GetColumn(0,"MONTHT")))
    {
        gfn_showMsg("CW00009");
        cb_yeart.SetFocus();
        return;
    }   
     
    //설치협력사필드 필수체크(설치협력사 로그인시)
    if( userGroup == '10' && gfn_isNull(cb_lifnr, true, st_lifnr.value)) return;

    var fYear  = parseInt(ds_cond.GetColumn(0,"YEARF"));
    var tYear  = parseInt(ds_cond.GetColumn(0,"YEART"));
    var fMonth = parseInt(ds_cond.GetColumn(0,"MONTHF"));
    var tMonth = parseInt(ds_cond.GetColumn(0,"MONTHT"));
    ds_cond.SetColumn(0,"YYYYMMF",ds_cond.GetColumn(0,"YEARF")+ds_cond.GetColumn(0,"MONTHF"));
    ds_cond.SetColumn(0,"YYYYMMT",ds_cond.GetColumn(0,"YEART")+ds_cond.GetColumn(0,"MONTHT"));
    if(rd_gbn2.Index == 0) {
	    ds_cond.SetColumn(0,"CHK_GBN","10");
		ds_cond.SetColumn(0,"CHK_GBN2","01");
	} else 	if(rd_gbn2.Index == 1) {
		ds_cond.SetColumn(0,"CHK_GBN","11");
		ds_cond.SetColumn(0,"CHK_GBN2","02");
	} else 	if(rd_gbn2.Index == 2) {
		ds_cond.SetColumn(0,"CHK_GBN","20");
		ds_cond.SetColumn(0,"CHK_GBN2","04");
	}
    ds_cond.SetColumn(0,"SPEC", Combo2.Value);
    ds_cond.SetColumn(0,"SPEC2", Combo0.Value);
    var spec  = parseInt(ds_cond.GetColumn(0,"SPEC"));
    var spec2  = parseInt(ds_cond.GetColumn(0,"SPEC2"));
    
    if (spec > spec2) { 
        Combo2.SetFocus();
        return; 
    }
    ds_cond.SetColumn(0,"VAR1", ds_var.GetColumn(0,"VAR1"));
    if(rd_gbn.index == 1) {
        tit_clearActionInfo();
        tit_addSearchActionInfo("ps16:PS1601005A_S1");  //==> CsvSaerch로 변경 
            
        tit_callService(
            ""
            , ""
            , "ds_cond=ds_cond"
            , "ds_list=ds_list"
            , ""
            , "fn_afterQuery"
            , ""
            , ""
            , true);
     } else if(rd_gbn.index == 0){
        tit_clearActionInfo();      
        tit_addSearchActionInfo("ps16:PS1601009A_S7");  //==> CsvSaerch로 변경 
        tit_callService(
            ""
            , ""
            , "ds_cond=ds_cond"
            , "ds_months=ds_months"
            , ""
            , "fn_afterQuery2"
            , ""
            , ""
            , true);
            
        
     }
}
/********************************************************************************
* 기      능   : 조회 Callback  
********************************************************************************/
function fn_afterQuery(errCode, errMsg)  {
   gfn_showMsg("CI00002",ds_list.RowCount()+"");
   if(rd_gbn.index == 0){
     div1.stc_sum1 = dsPivot1.rowcount;
     div1.stc_sum2 = dsPivot2.rowcount;
   }
}
/********************************************************************************
* 기      능   : 조회 Callback  
********************************************************************************/
function fn_afterQuery2(errCode, errMsg)  {

     if(ds_months.count-1 > 12) {
    	gfn_showAlert("CW00078","12");
		return;
    }
    ds_cond.SetColumn(0, "YYYYMMDD0", "");
    ds_cond.SetColumn(0, "YYYYMMDD1", "");
    ds_cond.SetColumn(0, "YYYYMMDD2", "");
    ds_cond.SetColumn(0, "YYYYMMDD3", "");
    ds_cond.SetColumn(0, "YYYYMMDD4", "");
    ds_cond.SetColumn(0, "YYYYMMDD5", "");
    ds_cond.SetColumn(0, "YYYYMMDD6", "");
    ds_cond.SetColumn(0, "YYYYMMDD7", "");
    ds_cond.SetColumn(0, "YYYYMMDD8", "");
    ds_cond.SetColumn(0, "YYYYMMDD9", "");
    ds_cond.SetColumn(0, "YYYYMMDD10", "");
    ds_cond.SetColumn(0, "YYYYMMDD11", "");
    ds_cond.SetColumn(0, "DIFF_MON", "");
    for(var i=0; i < ds_months.count; i++)
	{
	   if ( substr(ds_months.GetColumn(i,"DIFFMONTHS"),0,6) == ds_cond.GetColumn(0,"YYYYMMT")) {
	        ds_cond.SetColumn(0, "DIFF_MON", i+1);
	   }
	   if ( substr(ds_months.GetColumn(i,"DIFFMONTHS"),0,6) > ds_cond.GetColumn(0,"YYYYMMT")) {
	        break;
	   }
	   if(i == 0) {
	       var yymm0 = substr(ds_months.GetColumn(0,"DIFFMONTHS"), 0,6);
	       var days0 = yymm0 + gfn_getLastDayByStr(yymm0);
	       ds_cond.SetColumn(0, "YYYYMMDD0", days0);
	   }
	   else if(i == 1) {
	       var yymm1 = substr(ds_months.GetColumn(1,"DIFFMONTHS"), 0,6);
	       var days1 = yymm1 + gfn_getLastDayByStr(yymm1);
	       ds_cond.SetColumn(0, "YYYYMMDD1", days1);
	   }
	   else if(i == 2) {
	       var yymm2 = substr(ds_months.GetColumn(2,"DIFFMONTHS"), 0,6);
	       var days2 = yymm2 + gfn_getLastDayByStr(yymm2);
	       ds_cond.SetColumn(0, "YYYYMMDD2", days2);
	   }
	   else if(i == 3) {
	       var yymm3 = substr(ds_months.GetColumn(3,"DIFFMONTHS"), 0,6);
	       var days3 = yymm3 + gfn_getLastDayByStr(yymm3);
	       ds_cond.SetColumn(0, "YYYYMMDD3", days3);
	   }
	   else if(i == 4) {
	       var yymm4 = substr(ds_months.GetColumn(4,"DIFFMONTHS"), 0,6);
	       var days4 = yymm4 + gfn_getLastDayByStr(yymm4);
	       ds_cond.SetColumn(0, "YYYYMMDD4", days4);
	   }
	   else if(i == 5) {
	       var yymm5 = substr(ds_months.GetColumn(5,"DIFFMONTHS"), 0,6);
	       var days5 = yymm5 + gfn_getLastDayByStr(yymm5);
	       ds_cond.SetColumn(0, "YYYYMMDD5", days5);
	   }
	   else if(i == 6) {
	       var yymm6 = substr(ds_months.GetColumn(6,"DIFFMONTHS"), 0,6);
	       var days6 = yymm6 + gfn_getLastDayByStr(yymm6);
	       ds_cond.SetColumn(0, "YYYYMMDD6", days6);
	   }
	   else if(i == 7) {
	       var yymm7 = substr(ds_months.GetColumn(7,"DIFFMONTHS"), 0,6);
	       var days7 = yymm7 + gfn_getLastDayByStr(yymm7);
	       ds_cond.SetColumn(0, "YYYYMMDD7",days7);
	   }
	   else if(i == 8) {
	       var yymm8 = substr(ds_months.GetColumn(8,"DIFFMONTHS"), 0,6);
	       var days8 = yymm8 + gfn_getLastDayByStr(yymm8);
	       ds_cond.SetColumn(0, "YYYYMMDD8",days8);
	   }
	   else if(i == 9) {
	       var yymm9 = substr(ds_months.GetColumn(9,"DIFFMONTHS"), 0,6);
	       var days9 = yymm9 + gfn_getLastDayByStr(yymm9);
	       ds_cond.SetColumn(0, "YYYYMMDD9",days9);
       }
	   else if(i == 10) {
	       var yymm10 = substr(ds_months.GetColumn(10,"DIFFMONTHS"), 0,6);
	       var days10 = yymm10 + gfn_getLastDayByStr(yymm10);
	       ds_cond.SetColumn(0, "YYYYMMDD10",days10);
	   }
	   else if(i == 11) {
	       var yymm11 = substr(ds_months.GetColumn(11,"DIFFMONTHS"), 0,6);
	       var days11 = yymm11 + gfn_getLastDayByStr(yymm11);
	       ds_cond.SetColumn(0, "YYYYMMDD11",days11);
	   }
	}

    tit_clearActionInfo();
        tit_addSearchActionInfo("ps16:PS1601005A_S2");  //==> CsvSaerch로 변경
        tit_callService(
            ""
            , ""
            , "ds_cond=ds_cond"
            , "ds_list1=ds_list1"
            , ""
            , "fn_afterQuery"
            , ""
            , ""
            , true);

        tit_clearActionInfo();
        tit_addSearchActionInfo("ps16:PS1601005A_S3");  //==> CsvSaerch로 변경 
        tit_callService(
            ""
            , ""
            , "ds_cond=ds_cond"
            , "ds_list2=ds_list2"
            , ""
            , "fn_afterQuery"
            , ""
            , ""
            , true);
         
}
/********************************************************************************
* 기      능   :  협력사 조회 Callback  
********************************************************************************/
function fn_afterQueryC(errCode, errMsg) {

    if ( userGroup == "10" )
    {
        ds_zzlifnr.Filter("CODE=="+quote(G_VEND_CODE_E));
        cb_lifnr.Index = 0;
        cb_lifnr.Enable = false;
    }
    else if ( userGroup == "30" || userGroup == "40")
    {
        gfn_insertEmptyRow( ds_zzlifnr, G_CODE_ALL );
        cb_lifnr.value = "";
    }
    
}
/********************************************************************************
* 기      능   : 공통코드가 조회된 후의 Callback 함수 
********************************************************************************/
function fn_completeInit(sCode, sDsObj, sCodeType) {
    if(userGroup == "40")
    {
        cb_zzactss.Index = 0;
        cb_zzactss.Enable = true;
    }
    else if(userGroup == "30")
    {
        ds_zzactss.Filter("CODE="+quote(G_AREA_CODE_E));
        cb_zzactss.Index = 0;
        cb_zzactss.Enable = false;
    }
    else if(userGroup == "10")
    {
        cb_zzactss.Index = 0;
        cb_zzactss.Enable = false;
    }
}
/********************************************************************************
* 기      능   : form UnloadCompleted 
********************************************************************************/
function fn_OnUnloadCompleted(obj) {
    return gfn_isFormUnload(obj);
}
//=========================================================================================
// [ PART 3 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,form닫기)
//=========================================================================================

/********************************************************************************
* 기      능   : 닫기  
********************************************************************************/
function fn_close() {
    close();
}
/********************************************************************************
* 기      능   : 그리드 헤더 클릭시 정렬 처리 
********************************************************************************/
function grd_list_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
{
    if ( nCell == 0 ) {
        // 현재 처리할 format 기억
        gfn_selectGridCol("grd_list");
    } else {
        gfn_sortGrid(obj,nCell);
    }
}
/********************************************************************************
* 기      능   : 액셀  
********************************************************************************/
function fn_excel() 
{   
    if(rd_gbn.index == 1) {
        // Excel Export 
        if( ds_list.rowcount > 0 )
        {
            gfn_exportExcel(div0.grd_list, "설치실적_평가관리_설치실적현황리스트");
            break;
        }
    } else if(rd_gbn.index == 0) {
    
        // Excel Export 
        if( dsPivot1.rowcount > 0 )
        {       
            gfn_exportExcel(div1.grd_list1,"설치실적_평가관리_설치협력사별");
            gfn_exportExcel(div1.grd_list2,"설치실적_평가관리_설치협력사팀장별");
            break;
        }
    }
}

/********************************************************************************
* 기      능   : 사무소 별 협력업체 필터 
********************************************************************************/
function cb_zzactss_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
    if(strCode == '') ds_zzlifnr.Filter("1==1");
    else ds_zzlifnr.Filter("ZZACTSS=="+quote(strCode)+" || CODE==''");
    cb_lifnr.Index = 0;
}

function rd_gbn_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
    if(rd_gbn.Index == 1) {
        div0.Visible = true;
        div1.Visible = false;
    } else if(rd_gbn.Index == 0) {
        div1.Visible = true;
        div0.Visible = false;
        div1.top=div0.top;
        div1.left=div0.left;
    }
}



function cb_lifnr_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
    ds_cond.SetColumn(0,"ZZLIFNR",strCode);
    cb_ztemno.value = "";
    var nHRow = ds_zzactss.SearchRow("CODE=\"" +  ds_zzlifnr.GetColumn(nNewIndex, "ZZACTSS") + "\""); 
    ds_cond.SetColumn(0,"ZZACTSS",ds_zzactss.GetColumn(nHRow, "CODE"));
    tit_clearActionInfo();          
    tit_addSearchActionInfo("qm05:QM0503001A_S1");
    tit_callService(
        ""
        , ""
        , "ds_cond=ds_cond"
        , "ds_ztemno_cd=ds_ztemno_cd"  
        , ""
        , "fn_afterZtemnoChange"  
        , ""
        , ""
        , true);
}
/********************************************************************************
* 기      능   : 조회 Callback  - 사무소 변경시
********************************************************************************/
function fn_afterZtemnoChange(errCode, errMsg) {
    cb_ztemno.Index = 0;
    gfn_insertEmptyRow( ds_ztemno_cd, G_CODE_ALL );
    cb_ztemno.value = "";
}



function div1_grd_list1_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
{
    if ( nCell == 0 ) {
        // 현재 처리할 format 기억
        gfn_selectGridCol("grd_list1");
    } else {
        //gfn_sortGrid(obj,nCell);

    }
}

function cb_temno_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
    if(cb_temno.Text == '- 전체 -')
    {
       ds_zzactss.UnFilter();
       ds_zzlifnr.UnFilter();
       ds_ztemno_cd.UnFilter();
       cb_zzactss.Index = 0;
       cb_lifnr.Index = 0;
       cb_ztemno.Index = 0;
    }
    else
    {
      var arr = ds_cond.GetColumn(0,"DTEXT4");
       ds_zzactss.Filter("LENGTH(CODE) == 0 || DTEXT3 == "+quote(strCode));
       cb_zzactss.Index = 0;
       cb_lifnr.Index = 0;
       cb_ztemno.Index = 0;
    }
}


]]></Script>
</Window>