<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="562" Id="CS0101008A" Left="8" OnLoadCompleted="fn_OnLoadCompleted" OnUnloadCompleted="fn_OnUnloadCompleted" PidAttrib="7" Title="안전교육&#32;실시현황&#32;관리" Top="8" Ver="1.0" Width="978" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_cond">
				<Contents>
					<colinfo id="EDUDAT_FM" size="256" summ="default" type="STRING"/>
					<colinfo id="EDUDAT_TO" size="256" summ="default" type="STRING"/>
					<colinfo id="EDUGBN" size="256" summ="default" type="STRING"/>
					<colinfo id="BUMUN" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="NAME1" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
					<colinfo id="DEPT_GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="EDUNAM" size="256" summ="default" type="STRING"/>
					<record>
						<BUMUN></BUMUN>
						<DEPT_GBN></DEPT_GBN>
						<EDUDAT_FM></EDUDAT_FM>
						<EDUDAT_TO></EDUDAT_TO>
						<EDUGBN></EDUGBN>
						<EDUNAM></EDUNAM>
						<LIFNR></LIFNR>
						<NAME1></NAME1>
						<POSID></POSID>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list" OnColumnChanged="ds_list_OnColumnChanged">
				<Contents>
					<colinfo id="EDUDAT" size="255" summ="default" type="STRING"/>
					<colinfo id="EDUGBN" size="255" summ="default" type="STRING"/>
					<colinfo id="BUMUN" size="255" summ="default" type="STRING"/>
					<colinfo id="LIFNR" size="255" summ="default" type="STRING"/>
					<colinfo id="LIFNR2" size="255" summ="default" type="STRING"/>
					<colinfo id="EDUNAM" size="255" summ="default" type="STRING"/>
					<colinfo id="RANK" size="255" summ="default" type="STRING"/>
					<colinfo id="NAME1" size="255" summ="default" type="STRING"/>
					<colinfo id="BIRTH" size="255" summ="default" type="STRING"/>
					<colinfo id="TELH" size="255" summ="default" type="STRING"/>
					<colinfo id="CHECK" size="3" summ="default" type="STRING"/>
					<colinfo id="BIGO" size="255" summ="default" type="STRING"/>
					<colinfo id="POSID" size="255" summ="default" type="STRING"/>
					<colinfo id="IMAGE" size="256" summ="default" type="STRING"/>
					<colinfo id="EDUTIM_FM" size="256" summ="default" type="STRING"/>
					<colinfo id="EDUTIM_TO" size="256" summ="default" type="STRING"/>
					<colinfo id="EDUTHR" size="256" summ="default" type="STRING"/>
					<colinfo id="POST1" size="256" summ="default" type="STRING"/>
					<colinfo id="EDUNO" size="256" summ="default" type="STRING"/>
					<colinfo id="SPT" size="256" summ="default" type="STRING"/>
					<colinfo id="ACTSS_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="LEV" size="256" summ="default" type="STRING"/>
					<colinfo id="SCORE" size="256" summ="default" type="STRING"/>
					<colinfo id="PASS_INDC" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_kind">
				<Contents>
					<colinfo id="CODE" size="255" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="255" summ="default" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME>-&#32;전&#32;체&#32;-</CODE_NAME>
					</record>
					<record>
						<CODE>1</CODE>
						<CODE_NAME>신규자&#32;교육</CODE_NAME>
					</record>
					<record>
						<CODE>2</CODE>
						<CODE_NAME>수시&#32;교육</CODE_NAME>
					</record>
					<record>
						<CODE>3</CODE>
						<CODE_NAME>정기&#32;교육</CODE_NAME>
					</record>
					<record>
						<CODE>4</CODE>
						<CODE_NAME>특별&#32;교육</CODE_NAME>
					</record>
					<record>
						<CODE>5</CODE>
						<CODE_NAME>기타</CODE_NAME>
					</record>
					<record>
						<CODE>6</CODE>
						<CODE_NAME>리모델링&#32;기술교육</CODE_NAME>
					</record>
					<record>
						<CODE>7</CODE>
						<CODE_NAME>리모델링&#32;특성교육</CODE_NAME>
					</record>
					<record>
						<CODE>8</CODE>
						<CODE_NAME>신규자&#32;기술교육</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_bumun">
				<Contents>
					<colinfo id="CODE" size="255" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="255" summ="default" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME>-&#32;전&#32;체&#32;-</CODE_NAME>
					</record>
					<record>
						<CODE>승강기</CODE>
						<CODE_NAME>승강기</CODE_NAME>
					</record>
					<record>
						<CODE>S/S</CODE>
						<CODE_NAME>S/S</CODE_NAME>
					</record>
					<record>
						<CODE>서비스</CODE>
						<CODE_NAME>서비스</CODE_NAME>
					</record>
					<record>
						<CODE>주차</CODE>
						<CODE_NAME>주차</CODE_NAME>
					</record>
					<record>
						<CODE>구매</CODE>
						<CODE_NAME>구매</CODE_NAME>
					</record>
					<record>
						<CODE>기타</CODE>
						<CODE_NAME>기타</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_zzlifnr">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_edu">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_excel"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list2">
				<Contents>
					<colinfo id="EDUDAT" size="255" summ="default" type="STRING"/>
					<colinfo id="EDUGBN" size="255" summ="default" type="STRING"/>
					<colinfo id="BUMUN" size="255" summ="default" type="STRING"/>
					<colinfo id="LIFNR" size="255" summ="default" type="STRING"/>
					<colinfo id="LIFNR2" size="255" summ="default" type="STRING"/>
					<colinfo id="EDUNAM" size="255" summ="default" type="STRING"/>
					<colinfo id="RANK" size="255" summ="default" type="STRING"/>
					<colinfo id="NAME1" size="255" summ="default" type="STRING"/>
					<colinfo id="BIRTH" size="255" summ="default" type="STRING"/>
					<colinfo id="TELH" size="255" summ="default" type="STRING"/>
					<colinfo id="CHECK" size="3" summ="default" type="STRING"/>
					<colinfo id="BIGO" size="255" summ="default" type="STRING"/>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
					<colinfo id="IMAGE" size="256" summ="default" type="STRING"/>
					<colinfo id="EDUTIM_FM" size="256" summ="default" type="STRING"/>
					<colinfo id="EDUTIM_TO" size="256" summ="default" type="STRING"/>
					<colinfo id="EDUTHR" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNR3" size="256" summ="default" type="STRING"/>
					<colinfo id="NAME2" size="256" summ="default" type="STRING"/>
					<colinfo id="IMAGE2" size="256" summ="default" type="STRING"/>
					<colinfo id="POST1" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_temp">
				<Contents>
					<colinfo id="EDUDAT" size="255" summ="default" type="STRING"/>
					<colinfo id="EDUGBN" size="255" summ="default" type="STRING"/>
					<colinfo id="BUMUN" size="255" summ="default" type="STRING"/>
					<colinfo id="LIFNR" size="255" summ="default" type="STRING"/>
					<colinfo id="LIFNR2" size="256" summ="default" type="STRING"/>
					<colinfo id="EDUTIM_FM" size="255" summ="default" type="STRING"/>
					<colinfo id="EDUTIM_TO" size="256" summ="default" type="STRING"/>
					<colinfo id="EDUNAM" size="255" summ="default" type="STRING"/>
					<colinfo id="RANK" size="255" summ="default" type="STRING"/>
					<colinfo id="NAME1" size="255" summ="default" type="STRING"/>
					<colinfo id="BIRTH" size="255" summ="default" type="STRING"/>
					<colinfo id="TELH" size="255" summ="default" type="STRING"/>
					<colinfo id="BIGO" size="255" summ="default" type="STRING"/>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
					<colinfo id="LEV" size="256" summ="default" type="STRING"/>
					<colinfo id="SCORE" size="256" summ="default" type="STRING"/>
					<colinfo id="PASS_INDC" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_rank">
				<Contents>
					<colinfo id="CODE" size="255" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="255" summ="default" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME></CODE_NAME>
					</record>
					<record>
						<CODE>대표</CODE>
						<CODE_NAME>대표</CODE_NAME>
					</record>
					<record>
						<CODE>소장</CODE>
						<CODE_NAME>소장</CODE_NAME>
					</record>
					<record>
						<CODE>직원</CODE>
						<CODE_NAME>직원</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list3">
				<Contents>
					<colinfo id="EDUDAT" size="255" summ="default" type="STRING"/>
					<colinfo id="EDUGBN" size="255" summ="default" type="STRING"/>
					<colinfo id="BUMUN" size="255" summ="default" type="STRING"/>
					<colinfo id="LIFNR" size="255" summ="default" type="STRING"/>
					<colinfo id="LIFNR2" size="255" summ="default" type="STRING"/>
					<colinfo id="EDUNAM" size="255" summ="default" type="STRING"/>
					<colinfo id="RANK" size="255" summ="default" type="STRING"/>
					<colinfo id="NAME1" size="255" summ="default" type="STRING"/>
					<colinfo id="BIRTH" size="255" summ="default" type="STRING"/>
					<colinfo id="TELH" size="255" summ="default" type="STRING"/>
					<colinfo id="CHECK" size="3" summ="default" type="STRING"/>
					<colinfo id="BIGO" size="255" summ="default" type="STRING"/>
					<colinfo id="POSID" size="255" summ="default" type="STRING"/>
					<colinfo id="IMAGE" size="256" summ="default" type="STRING"/>
					<colinfo id="EDUTIM_FM" size="256" summ="default" type="STRING"/>
					<colinfo id="EDUTIM_TO" size="256" summ="default" type="STRING"/>
					<colinfo id="EDUTHR" size="256" summ="default" type="STRING"/>
					<colinfo id="POST1" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list4">
				<Contents>
					<colinfo id="EDUDAT" size="255" summ="default" type="STRING"/>
					<colinfo id="EDUGBN" size="255" summ="default" type="STRING"/>
					<colinfo id="BUMUN" size="255" summ="default" type="STRING"/>
					<colinfo id="LIFNR" size="255" summ="default" type="STRING"/>
					<colinfo id="LIFNR2" size="255" summ="default" type="STRING"/>
					<colinfo id="EDUNAM" size="255" summ="default" type="STRING"/>
					<colinfo id="RANK" size="255" summ="default" type="STRING"/>
					<colinfo id="NAME1" size="255" summ="default" type="STRING"/>
					<colinfo id="BIRTH" size="255" summ="default" type="STRING"/>
					<colinfo id="TELH" size="255" summ="default" type="STRING"/>
					<colinfo id="CHECK" size="3" summ="default" type="STRING"/>
					<colinfo id="BIGO" size="255" summ="default" type="STRING"/>
					<colinfo id="POSID" size="255" summ="default" type="STRING"/>
					<colinfo id="IMAGE" size="256" summ="default" type="STRING"/>
					<colinfo id="EDUTIM_FM" size="256" summ="default" type="STRING"/>
					<colinfo id="EDUTIM_TO" size="256" summ="default" type="STRING"/>
					<colinfo id="EDUTHR" size="256" summ="default" type="STRING"/>
					<colinfo id="POST1" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_listD" OnColumnChanged="ds_list_OnColumnChanged">
				<Contents>
					<colinfo id="FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="EDUNO" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_auth">
				<Contents>
					<colinfo id="LEVEL" size="256" summ="default" type="STRING"/>
					<colinfo id="BUMO" size="256" summ="default" type="STRING"/>
					<colinfo id="PSNO" size="256" summ="default" type="STRING"/>
					<colinfo id="DEPT1_N" size="256" summ="default" type="STRING"/>
					<colinfo id="DEPT_N" size="256" summ="default" type="STRING"/>
					<record>
						<BUMO></BUMO>
						<DEPT1_N></DEPT1_N>
						<DEPT_N></DEPT_N>
						<LEVEL></LEVEL>
						<PSNO></PSNO>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_lev">
				<Contents>
					<colinfo id="CODE" size="255" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="255" summ="default" type="STRING"/>
					<record>
						<CODE>OJ</CODE>
						<CODE_NAME>OJT</CODE_NAME>
					</record>
					<record>
						<CODE>L1</CODE>
						<CODE_NAME>Level&#32;1</CODE_NAME>
					</record>
					<record>
						<CODE>L2</CODE>
						<CODE_NAME>Level&#32;2</CODE_NAME>
					</record>
					<record>
						<CODE>L3</CODE>
						<CODE_NAME>Level&#32;3</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_pass">
				<Contents>
					<colinfo id="CODE" size="255" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="255" summ="default" type="STRING"/>
					<record>
						<CODE>P</CODE>
						<CODE_NAME>Pass</CODE_NAME>
					</record>
					<record>
						<CODE>F</CODE>
						<CODE_NAME>Fail</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
		</Datasets>
		<Shape BKColor="user0" Bottom="60" Height="31" Id="Shape1" Left="-1" LineColor="user1" Right="977" TabOrder="17" Top="29" Type="Rectangle" Width="978"></Shape>
		<Shape BKColor="user0" Bottom="30" Height="31" Id="Shape0" Left="-1" LineColor="user1" Right="977" TabOrder="2" Top="-1" Type="Rectangle" Width="978"></Shape>
		<Grid AutoFitEndLine="Hide" BindDataset="ds_list" BkColor2="default" BoldHead="true" Border="Flat" Bottom="552" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="463" Id="grd_list" InputPanel="FALSE" Left="8" LineColor="user20" LineType="ExHORZ" OnCellDBLClick="grd_list_OnCellDblClick" OnHeadClick="grd_list_OnHeadClick" Right="969" RowHeight="20" Style="sty_grid" TabOrder="2" TabStop="true" Top="89" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="961">
			<contents>
				<format id="Default">
					<columns>
						<col width="40"/>
						<col width="25"/>
						<col width="80"/>
						<col width="80"/>
						<col width="70"/>
						<col width="80"/>
						<col width="200"/>
						<col width="150"/>
						<col width="60"/>
						<col width="70"/>
						<col width="80"/>
						<col width="100"/>
						<col width="80"/>
						<col width="90"/>
						<col width="90"/>
						<col width="80"/>
						<col width="120"/>
						<col width="79"/>
						<col width="69"/>
						<col width="87"/>
					</columns>
					<head>
						<cell align="center" col="0" display="checkbox"/>
						<cell align="center" col="1" display="text" font="굴림,9" text="No"/>
						<cell align="center" col="2" display="text" font="굴림,9" text="교육일"/>
						<cell align="center" col="3" display="text" font="굴림,9" text="교육구분"/>
						<cell align="center" col="4" display="text" font="굴림,9" text="사업부문"/>
						<cell align="center" col="5" display="text" font="굴림,9" text="호기(WBS)"/>
						<cell align="center" col="6" display="text" font="굴림,9" text="현장명"/>
						<cell align="center" col="7" display="text" font="굴림,9" text="업체명"/>
						<cell align="center" col="8" display="text" font="굴림,9" text="직급"/>
						<cell align="center" col="9" display="text" font="굴림,9" text="성명"/>
						<cell align="center" col="10" display="text" font="굴림,9" text="생년월일"/>
						<cell align="center" col="11" display="text" font="굴림,9" text="연락처"/>
						<cell align="center" col="12" display="text" font="굴림,9" text="사무소(업체)"/>
						<cell align="center" col="13" display="text" font="굴림,9" text="교육시작시간"/>
						<cell align="center" col="14" display="text" font="굴림,9" text="교육종료시간"/>
						<cell align="center" col="15" display="text" font="굴림,9" text="교육실시자"/>
						<cell align="center" col="16" display="text" font="굴림,9" text="기타"/>
						<cell align="center" col="17" display="text" font="굴림,9" text="Level"/>
						<cell align="center" col="18" display="text" font="굴림,9" text="점수"/>
						<cell align="center" col="19" display="text" font="굴림,9" text="Pass/Fail"/>
						<cell align="center" col="20" display="text" font="굴림,9" text="기타"/>
						<cell align="center" col="20" display="text" font="굴림,9" text="기타"/>
						<cell align="center" col="20" display="text" font="굴림,9" text="기타"/>
						<cell align="center" col="20" display="text" font="굴림,9" text="기타"/>
						<cell align="center" col="20" display="text" font="굴림,9" text="기타"/>
						<cell align="center" col="20" display="text" font="굴림,9" text="기타"/>
						<cell align="center" col="20" display="text" font="굴림,9" text="기타"/>
						<cell align="center" col="20" display="text" font="굴림,9" text="기타"/>
					</head>
					<body>
						<cell bkcolor2="user22" col="0" colid="CHECK" display="checkbox" edit="checkbox"/>
						<cell align="center" col="1" display="text" expr="currow&#32;+&#32;1"/>
						<cell align="center" bkcolor2="user22" col="2" colid="EDUDAT" display="text" Mask="####.##.##"/>
						<cell align="center" bkcolor2="user22" col="3" colid="EDUGBN" combocol="CODE" combodataset="ds_kind" combodisplaynltext="true" combotext="CODE_NAME" display="combo"/>
						<cell align="center" bkcolor2="user22" col="4" colid="BUMUN" display="text"/>
						<cell align="center" bkcolor2="user22" col="5" colid="POSID" display="text"/>
						<cell align="left" bkcolor2="user22" col="6" colid="SPT" display="normal"/>
						<cell align="left" bkcolor2="user22" col="7" colid="LIFNR2" display="normal"/>
						<cell align="center" bkcolor2="user22" col="8" colid="RANK" display="text"/>
						<cell align="center" bkcolor2="user22" col="9" colid="NAME1" display="text"/>
						<cell align="center" bkcolor2="user22" col="10" colid="BIRTH" display="text" Mask="####.##.##"/>
						<cell align="center" bkcolor2="user22" col="11" colid="TELH" display="text" Mask="expr:decode(length(TELH),9,&apos;##-###-####&apos;,10,&apos;##-####-####&apos;,11,&apos;###-####-####&apos;,&apos;###-###-####&apos;)"/>
						<cell align="center" bkcolor2="user22" col="12" colid="ACTSS_NM" display="text"/>
						<cell align="center" bkcolor2="user22" col="13" colid="EDUTIM_FM" display="text" Mask="##:##"/>
						<cell align="center" bkcolor2="user22" col="14" colid="EDUTIM_TO" display="text" Mask="##:##"/>
						<cell align="center" bkcolor2="user22" col="15" colid="EDUNAM" display="text"/>
						<cell align="center" bkcolor2="user22" col="16" colid="BIGO" display="text"/>
						<cell align="center" bkcolor2="user22" col="17" colid="LEV" combocol="CODE" combodataset="ds_lev" combotext="CODE_NAME" display="text"/>
						<cell align="center" bkcolor2="user22" col="18" colid="SCORE" display="text"/>
						<cell align="center" bkcolor2="user22" col="19" colid="PASS_INDC" combocol="CODE" combodataset="ds_pass" combotext="CODE_NAME" display="text"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Static Align="Right" Height="20" Id="st_gubn" Left="7" Style="sty_lb_search" TabOrder="4" Text="교육기간&#32;" Top="5" VAlign="Middle" Width="80"></Static>
		<Calendar BindDataset="ds_cond" BKColor="user22" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="EDUDAT_FM" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_date_fm" Left="89" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_search_ind" SundayTextColor="user35" TabOrder="5" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="5" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="86"></Calendar>
		<Calendar BindDataset="ds_cond" BKColor="user22" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="EDUDAT_TO" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_date_to" Left="181" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_search_ind" SundayTextColor="user35" TabOrder="6" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="5" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="86"></Calendar>
		<Static Align="Right" Height="20" Id="Static0" Left="275" Style="sty_lb_search" TabOrder="7" Text="교육구분&#32;" Top="5" VAlign="Middle" Width="80"></Static>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="CODE" Column="EDUGBN" Cursor="NO" DataColumn="CODE_NAME" Height="20" Id="cb_kind" InnerDataset="ds_kind" Left="357" Style="sty_ipt_form" TabOrder="8" Top="4" Width="106"></Combo>
		<Static Align="Right" Height="20" Id="Static5" Left="467" Style="sty_lb_search" TabOrder="9" Text="사업부문&#32;" Top="5" VAlign="Middle" Width="80"></Static>
		<Edit BindDataset="ds_cond" Border="Flat" CheckLength="Byte" Column="NAME1" Height="20" Id="ed_name" ImeMode="english" Left="888" MaxLength="12" Style="sty_ipt_search" TabOrder="10" Top="5" UpperOnly="TRUE" Width="90"></Edit>
		<Static Align="Right" Height="20" Id="Static7" Left="809" Style="sty_lb_search" TabOrder="11" Text="성&#32;명&#32;" Top="5" VAlign="Middle" Width="80"></Static>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="CODE" Column="BUMUN" Cursor="NO" DataColumn="CODE_NAME" Height="20" Id="cb_bumun" InnerDataset="ds_bumun" Left="548" Style="sty_ipt_form" TabOrder="12" Top="4" Width="86"></Combo>
		<Static Align="Right" Height="20" Id="Static1" Left="638" Style="sty_lb_search" TabOrder="13" Text="협력업체명&#32;" Top="5" VAlign="Middle" Width="80"></Static>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="CODE" Column="LIFNR" DataColumn="CODE_NAME" Height="20" Id="cb_zzlifnr" InnerDataset="ds_zzlifnr" Left="719" Style="sty_ipt_search" TabOrder="14" Top="4" Width="86"></Combo>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_save" ImageID="btn_sub_03" Left="884" LeftMargin="12" OnClick="btn_save_OnClick" Style="sty_btn" TabOrder="15" Text="저장" Top="65" Transparent="TRUE" Width="60"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_upload" ImageID="btn_sub_05" Left="792" LeftMargin="12" OnClick="btn_upload_OnClick" Style="sty_btn" TabOrder="16" Text="엑셀&#32;업로드" Top="64" Transparent="TRUE" Width="85"></Button>
		<Static Align="Right" Height="20" Id="Static2" Left="7" Style="sty_lb_search" TabOrder="19" Text="WBS&#32;" Top="34" VAlign="Middle" Width="80"></Static>
		<Edit BindDataset="ds_cond" Border="Flat" CheckLength="Byte" Column="POSID" Height="20" Id="ed_posid" ImeMode="english" Left="89" MaxLength="12" Style="sty_ipt_search" TabOrder="18" Top="34" UpperOnly="TRUE" Width="86"></Edit>
		<Button Height="18" Id="btn_hogi" ImageID="btn_icon_search" Left="176" OnClick="btn_hogi_OnClick" TabOrder="20" Text="Button0" Top="35" Transparent="TRUE" Width="18"></Button>
		<Grid AutoFitEndLine="Hide" BindDataset="ds_temp" BkColor2="default" BoldHead="true" Border="Flat" Bottom="375" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="199" Id="grd_list2" InputPanel="FALSE" Left="1008" LineColor="user20" LineType="ExHORZ" Right="1289" RowHeight="20" Style="sty_grid" TabOrder="0" TabStop="true" Top="176" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="FALSE" VLineColor="default" WheelScrollRow="1" Width="281">
			<contents>
				<format id="Default">
					<columns>
						<col width="134"/>
						<col width="306"/>
						<col width="155"/>
						<col width="112"/>
						<col width="129"/>
						<col width="90"/>
						<col width="127"/>
						<col width="127"/>
						<col width="90"/>
						<col width="90"/>
						<col width="90"/>
						<col width="199"/>
						<col width="120"/>
						<col width="200"/>
						<col width="343"/>
						<col width="82"/>
						<col width="191"/>
					</columns>
					<head>
						<cell align="center" col="0" display="text" font="굴림,9" text="교육일(숫자만입력&#32;ex.20160101)"/>
						<cell align="center" col="1" display="text" font="굴림,9" text="교육구분(1:신규자&#32;교육,2:수시&#32;교육,3:정기&#32;교육,4:특별교육,5:기타,6:리모델링&#32;기술교육,7:리모델링&#32;특성교육,8:신규자&#32;기술교육)"/>
						<cell align="center" col="2" display="text" font="굴림,9" text="사업부문(승강기,S/S,서비스,주차,구매,기타)"/>
						<cell align="center" col="3" display="text" font="굴림,9" text="호기(WBS)"/>
						<cell align="center" col="4" display="text" font="굴림,9" text="업체(업체코드로&#32;입력)"/>
						<cell align="center" col="5" display="text" font="굴림,9" text="신규업체"/>
						<cell align="center" col="6" display="text" font="굴림,9" text="교육시작시간(ex.1300)"/>
						<cell align="center" col="7" display="text" font="굴림,9" text="교육종료시간(ex.1300)"/>
						<cell align="center" col="8" display="text" font="굴림,9" text="교육실시자"/>
						<cell align="center" col="9" display="text" font="굴림,9" text="직급"/>
						<cell align="center" col="10" display="text" font="굴림,9" text="성명"/>
						<cell align="center" col="11" display="text" font="굴림,9" text="생년월일(숫자만입력&#32;ex.20160101)"/>
						<cell align="center" col="12" display="text" font="굴림,9" text="연락처"/>
						<cell align="center" col="13" display="text" font="굴림,9" text="기타"/>
						<cell align="center" col="14" display="text" font="굴림,9" text="Level(ex.&#32;OJ&#32;:&#32;OJT,&#32;L1&#32;:&#32;Level&#32;1,&#32;L2&#32;:&#32;Level2,&#32;L3&#32;:&#32;Level3)"/>
						<cell align="center" col="15" display="text" font="굴림,9" text="점수(0~100)"/>
						<cell align="center" col="16" display="text" font="굴림,9" text="Pass/Fail(ex.&#32;P&#32;:&#32;Pass,&#32;F&#32;:&#32;Fail)"/>
					</head>
					<body>
						<cell align="center" bkcolor2="user22" col="0" colid="EDUDAT" display="text" Mask="####.##.##"/>
						<cell align="center" bkcolor2="user22" col="1" colid="EDUGBN" combodisplaynltext="true" display="normal"/>
						<cell align="center" bkcolor2="user22" col="2" colid="BUMUN" display="text"/>
						<cell align="center" bkcolor2="user22" col="3" colid="POSID" display="text"/>
						<cell align="center" bkcolor2="user22" col="4" colid="LIFNR" display="text"/>
						<cell align="center" bkcolor2="user22" col="5" colid="LIFNR2" display="text"/>
						<cell align="center" bkcolor2="user22" col="6" colid="EDUTIM_FM" display="text"/>
						<cell align="center" bkcolor2="user22" col="7" colid="EDUTIM_TO" display="text"/>
						<cell align="center" bkcolor2="user22" col="8" colid="EDUNAM" display="text"/>
						<cell align="center" bkcolor2="user22" col="9" colid="RANK" display="text"/>
						<cell align="center" bkcolor2="user22" col="10" colid="NAME1" display="text" Mask="####.##.##"/>
						<cell align="center" bkcolor2="user22" col="11" colid="BIRTH" display="text" Mask="expr:decode(length(TELH),9,&apos;##-###-####&apos;,10,&apos;##-####-####&apos;,11,&apos;###-####-####&apos;,&apos;###-###-####&apos;)"/>
						<cell align="center" bkcolor2="user22" col="12" colid="TELH" display="text"/>
						<cell align="center" bkcolor2="user22" col="13" colid="BIGO" display="text"/>
						<cell align="center" bkcolor2="user22" col="14" colid="LEV" display="text"/>
						<cell align="center" bkcolor2="user22" col="15" colid="SCORE" display="text"/>
						<cell align="center" bkcolor2="user22" col="16" colid="PASS_INDC" display="text"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_template" ImageID="btn_sub_06" Left="688" LeftMargin="12" OnClick="btn_template_OnClick" Style="sty_btn" TabOrder="21" Text="엑셀&#32;양식다운" Top="65" Transparent="TRUE" Width="99"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_search" ImageID="btn_sub_06" Left="584" LeftMargin="12" OnClick="btn_search_OnClick" Style="sty_btn" TabOrder="22" Text="업체코드&#32;조회" Top="65" Transparent="TRUE" Width="101"></Button>
		<Static Align="Right" Height="20" Id="Static3" Left="203" Style="sty_lb_search" TabOrder="23" Text="교육실시자&#32;" Top="35" VAlign="Middle" Width="80"></Static>
		<Edit BindDataset="ds_cond" Border="Flat" CheckLength="Byte" Column="EDUNAM" Height="20" Id="ed_edunam" ImeMode="native" Left="286" MaxLength="8" Style="sty_ipt_search" TabOrder="24" Top="35" UpperOnly="TRUE" Width="90"></Edit>
	</Form>
	<Script><![CDATA[﻿﻿﻿﻿﻿﻿﻿/*
 ******************************************************************************************
 * 기      능   : 안전교육 실시현황 관리
 * 작  성  자   : 조영욱
 * 작성  일자   : 2016.02
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
#include "LIB::commons.js";	// 공통 스크립트 
//=========================================================================================
// [ PART 1 ]
// Form에서 사용될 전역변수를 선언
// FORM에서 사용되는 전역변수는 대문자로 작성하며, F_XXX 의 형태를 갖도록 한다. 
//=========================================================================================
var userGroup = "";
//=========================================================================================
// [ PART 2 ]
// Form Loading / Unloading 시 작업 정의
//=========================================================================================
function fn_OnLoadCompleted(obj) {
	gfn_initForm(true);
	
	// 현재 조회 일자 설정 
	cal_date_fm.value = gfn_getCurrDate();
	cal_date_to.value = gfn_getAfterDate(cal_date_fm.value, 15);
	
	// 코드 DataSet 가져오기
    var codeArr = ["EDU"];
    var dsObjArr = [ds_edu];
    var addTypeArr = [G_CODE_ALL];
    gfn_searchCommCode(codeArr, dsObjArr, addTypeArr,true);
	
	userGroup = gfn_getUserGroup();
	
	ds_cond.SetColumn(0,"USER_GRUP",userGroup);
	
	tit_clearActionInfo();
	tit_addSearchActionInfo("wb01:SEOLCHI_VEND_S2");
	tit_addSearchActionInfo("wb05:WB0506001A_S4");	// 설치본부 권한 확인.
	//tit_addSearchActionInfo("ps02:PS0205001A_S8");      //공정 코드

	tit_callService(
		""
		, ""
		, "ds_cond=ds_cond"
		, "ds_zzlifnr=ds_lifnr_cd ds_auth=ds_auth"  // ds_pronr=ds_pronr"
		, ""
		, "fn_afterQueryC"
		, ""
		, ""
		, true);
	
}

/********************************************************************************
* 기      능   : 공통코드가 조회된 후의 Callback 함수 
********************************************************************************/
function fn_completeInit(sCode, sDsObj, sCodeType) {
	// Button Controll
	if(G_USER_ID == "2011662" || G_USER_ID == "2025558" || G_USER_ID == "2023709" || G_USER_ID == "2017750" || G_USER_ID == "2029464" || G_USER_ID == "2021242" || G_USER_ID == "2029987" || G_USER_ID == "2029847") {
		ufn_enableBtn("delete", true);
	} else {
		ufn_enableBtn("delete", false);
	}
}

/********************************************************************************
* 기      능   : form UnloadCompleted 
********************************************************************************/
function fn_OnUnloadCompleted(obj) {
	return gfn_isFormUnload(obj);
}

//=========================================================================================
// [ PART 3 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,form닫기)
//=========================================================================================
/********************************************************************************
* 기      능   : 조회 1
********************************************************************************/
function fn_query() {
// Message 영역 초기화
	global.FRM_BOTTOM.img_msgType.imageId = "";
	global.FRM_BOTTOM.st_msg.value = "";
	
	// 필수 입력 항목 체크 
	if ( gfn_isNull(cal_date_fm, true) ) {
		gfn_showMsg("CW00001","교육일");
		return;
	}
	if ( gfn_isNull(cal_date_to, true) ) {
		gfn_showMsg("CW00001","교육일");
		return;
	}

	
	if ( !gfn_checkDate( cal_date_fm.value, cal_date_to.value, true, cal_date_to) ) {
		return;
	}
	
	// 설치본부일 경우, 별도 구분.
	if(ds_auth.GetRowCount() > 0)
	{
		ds_cond.SetColumn(0, "DEPT_GBN", "A");
	}
	else
	{
		ds_cond.SetColumn(0, "DEPT_GBN", "B");
	}
	
	tit_clearActionInfo();
	tit_addSearchActionInfo("wb05:WB0506001A_S1");
	
	tit_callService(
        ""
        , ""
        , "ds_cond=ds_cond"
        , "ds_list=ds_list"
        , ""
        , "fn_afterQuery"
        , true);        
}

/********************************************************************************
* 기      능   : 닫기  
********************************************************************************/
function fn_close() {
	close();
}

/********************************************************************************
* 기      능   : 액셀  
********************************************************************************/
function fn_excel() {

	gfn_exportExcel(grd_list,G_USER_ID);
}

/********************************************************************************
* 기      능   : 입력 
********************************************************************************/
function fn_input() {

	var pop_obj = gfn_openPopup("WB0506001B", true,);
	
	fn_query();
}

/********************************************************************************
* 기      능   : 출력
********************************************************************************/
function fn_print() {
	
	ds_list2.ClearData();	
		
	var count = 0;
	
	for(var i=0; i<ds_list.rowcount(); i++) {
		
		if(ds_list.GetColumn(i,"CHECK") == "1")
		{
		    count++;
		}		
	}
	
	if(count > 1)
	{
		var nRow = ds_list.currow;		
		
		for(var i=0; i<ds_list.rowcount(); i++) {
			if(ds_list.GetColumn(i,"CHECK") = 1) {
				ds_list.SetColumn(i,"CHECK",0);
			}
		}			
		gfn_showAlert("CW00114","여러행 출력은");
		return;		
	}
					
	else if(count = 0)
	{
		gfn_showAlert("CW00001", "체크");
		return;
	}
	
	else if(count = 1)
	{						
		if(ds_list3.GetColumn(0,"EDUGBN") = "1" || ds_list3.GetColumn(0,"EDUGBN") = "2" || 
		   ds_list3.GetColumn(0,"EDUGBN") = "4" )
		{
			if(ds_list4.GetRowCount() > 1)
			{
				for(var i = 0; 2*i < ds_list4.GetRowCount(); i++)
				{
				  
				  ds_list2.AddRow();
				  ds_list2.SetColumn(i,"EDUDAT",ds_list4.GetColumn(2 * i,"EDUDAT"));
				  ds_list2.SetColumn(i,"EDUGBN",ds_list4.GetColumn(2*i,"EDUGBN"));
				  ds_list2.SetColumn(i,"BUMUN",ds_list4.GetColumn(2*i,"BUMUN"));
				  ds_list2.SetColumn(i,"LIFNR",ds_list4.GetColumn(2*i,"LIFNR"));
				  ds_list2.SetColumn(i,"LIFNR2",ds_list4.GetColumn(2*i,"LIFNR2"));
				  ds_list2.SetColumn(i,"EDUNAM",ds_list4.GetColumn(2*i,"EDUNAM"));
				  ds_list2.SetColumn(i,"RANK",ds_list4.GetColumn(2*i,"RANK"));
				  ds_list2.SetColumn(i,"NAME1",ds_list4.GetColumn(2*i,"NAME1"));
				  ds_list2.SetColumn(i,"BIRTH",ds_list4.GetColumn(2*i,"BIRTH"));
				  ds_list2.SetColumn(i,"TELH",ds_list4.GetColumn(2*i,"TELH"));
				  ds_list2.SetColumn(i,"CHECK",ds_list4.GetColumn(2*i,"CHECK"));
				  ds_list2.SetColumn(i,"BIGO",ds_list4.GetColumn(2*i,"BIGO"));
				  ds_list2.SetColumn(i,"POSID",ds_list4.GetColumn(2*i,"POSID"));
				  ds_list2.SetColumn(i,"IMAGE",ds_list4.GetColumn(2*i,"IMAGE"));
				  ds_list2.SetColumn(i,"EDUTIM_FM",ds_list4.GetColumn(2*i,"EDUTIM_FM"));
				  ds_list2.SetColumn(i,"EDUTIM_TO",ds_list4.GetColumn(2*i,"EDUTIM_TO"));
				  ds_list2.SetColumn(i,"EDUTHR",ds_list4.GetColumn(2*i,"EDUTHR"));
				  ds_list2.SetColumn(i,"POST1",ds_list4.GetColumn(2*i,"POST1"));
				}
				
				for(var j = 0; 2*j+1 < ds_list4.GetRowCount(); j++)
				{
				  ds_list2.SetColumn(j,"LIFNR3",ds_list4.GetColumn(2*j+1,"LIFNR2"));
				  ds_list2.SetColumn(j,"NAME2",ds_list4.GetColumn(2*j+1,"NAME1"));
				  ds_list2.SetColumn(j,"IMAGE2",ds_list4.GetColumn(2*j+1,"IMAGE"));
				}
			
			} else if (ds_list4.GetRowCount() = 1) {
				
				ds_list2.AddRow();
				ds_list2.SetColumn(0,"EDUDAT",ds_list4.GetColumn(0,"EDUDAT"));
				ds_list2.SetColumn(0,"EDUGBN",ds_list4.GetColumn(0,"EDUGBN"));
				ds_list2.SetColumn(0,"BUMUN",ds_list4.GetColumn(0,"BUMUN"));
				ds_list2.SetColumn(0,"LIFNR",ds_list4.GetColumn(0,"LIFNR"));
				ds_list2.SetColumn(0,"LIFNR2",ds_list4.GetColumn(0,"LIFNR2"));
				ds_list2.SetColumn(0,"EDUNAM",ds_list4.GetColumn(0,"EDUNAM"));
				ds_list2.SetColumn(0,"RANK",ds_list4.GetColumn(0,"RANK"));
				ds_list2.SetColumn(0,"NAME1",ds_list4.GetColumn(0,"NAME1"));
				ds_list2.SetColumn(0,"BIRTH",ds_list4.GetColumn(0,"BIRTH"));
				ds_list2.SetColumn(0,"TELH",ds_list4.GetColumn(0,"TELH"));
				ds_list2.SetColumn(0,"CHECK",ds_list4.GetColumn(0,"CHECK"));
				ds_list2.SetColumn(0,"BIGO",ds_list4.GetColumn(0,"BIGO"));
				ds_list2.SetColumn(0,"POSID",ds_list4.GetColumn(0,"POSID"));
				ds_list2.SetColumn(0,"IMAGE",ds_list4.GetColumn(0,"IMAGE"));
				ds_list2.SetColumn(0,"EDUTIM_FM",ds_list4.GetColumn(0,"EDUTIM_FM"));
				ds_list2.SetColumn(0,"EDUTIM_TO",ds_list4.GetColumn(0,"EDUTIM_TO"));
				ds_list2.SetColumn(0,"EDUTHR",ds_list4.GetColumn(0,"EDUTHR"));
				ds_list2.SetColumn(0,"POST1",ds_list4.GetColumn(0,"POST1"));
			}
			
			Dialog("WB05::WB0506001C.xml","", -1, -1, "Resize=true");
		} else {
			gfn_showAlert("CW00116","신규자 교육이나 수시교육, 특별교육만");
			return;
		}
	}
}

//=========================================================================================
// [ PART 4]
// Callback 함수 정의 : callback 함수명은 메인 함수의 fn_xxxx() 에서 xxxx 부분은 fn_afterXXXX()
// 형태가 되도록 작성 
//=========================================================================================
/********************************************************************************
* 기      능   : 조회 Callback  
********************************************************************************/
function fn_afterQuery(errCode, errMsg) {

   	if ( ds_list.rowCount() > 0 ) {
		gfn_showMsg("CI00002", ds_list.rowCount() + "");
		
	} else {
		gfn_showMsg("CW00010");
	}

}

/********************************************************************************
* 기      능   : 저장 Callback  
********************************************************************************/
function fn_afterSave(errCode, errMsg) {
	if ( ds_error.rowcount() > 0 ) {
		gfn_showMsg("CE00001");
	} else {
		gfn_showMsg("CI00003");
	}
	
	fn_query();
}

//=========================================================================================
// [ PART 5 ]
// Detail Process Event 정의 ( User Define function )
// 사용자 정의 함수는 ufn_xxxx() 형태로 작성 
//=========================================================================================
/********************************************************************************
* 기      능   : 그리드 헤더 클릭시 정렬 처리 
********************************************************************************/


//=========================================================================================
// [ PART 6 ]
// component Event 정의 : 각 Component 별 이벤트 
//=========================================================================================
/********************************************************************************
* 기      능   : 그리드 헤더 클릭시 정렬 처리 
********************************************************************************/
function grd_list_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
{
	gfn_selectAllGrid(obj);
}


/********************************************************************************
* 기      능   : 
********************************************************************************/
function btn_openPopup1(obj)
{

}
function fn_afterQueryC()
{
	cb_zzlifnr.Index = 0;
	
	ds_zzlifnr.filter("LOEVM!='X'" );		
	gfn_insertEmptyRow( ds_zzlifnr, G_CODE_ALL );
	cb_zzlifnr.value = "";
	
	// 설치본부 권한일 경우.
	if(ds_auth.GetRowCount() > 0)
	{
		ds_kind.Filter("CODE == '' || CODE == '6' || CODE == '7' || CODE == '8'");
		ufn_enableBtn("delete", true);
		btn_print.Visible = false;
	}
	else
	{
		ds_kind.Filter("CODE == '' || CODE == '1' || CODE == '2' || CODE == '3' || CODE == '4' || CODE == '5'");
	}
}



/********************************************************************************
* 기      능   : 
********************************************************************************/
function btn_save_OnClick(obj)
{
	 //자료가 없으면 리턴
	if (ds_list.rowcount < 1) {
		gfn_showAlert("CW00010");
		return;
	}
	
	ds_list.fireevent = false;
	
	gfn_copyDs(ds_list, ds_list2, "CHECK=1");
	
	if (ds_list2.rowcount < 1) {
		gfn_showAlert("CW00180","체크표시");
		ds_list.fireevent = true;
		return;
	}
	
	var cnt = ds_list2.GetRowCount();
	
	if( cnt > 0 )
	{
		for( var i = 0; i < ds_list2.GetRowCount(); i++ ){
			
			if ( ds_list2.GetColumn(i,"LIFNR") == "" &&
			     ds_list2.GetColumn(i,"LIFNR2") == "") 
			{
				gfn_showAlert("CW00001","업체명");
				ds_list.fireevent = true;
				return;
			}
			if ( ds_list2.GetColumn(i,"RANK") == "" )
			{
				gfn_showAlert("CW00001","직급");
				ds_list.fireevent = true;
				return;
			}
			if ( ds_list2.GetColumn(i,"NAME") == "" )
			{
				gfn_showAlert("CW00001","이름");
				ds_list.fireevent = true;
				return;
			}
			if ( ds_list2.GetColumn(i,"TELH") == "" )
			{
				gfn_showAlert("CW00001","연락처");
				ds_list.fireevent = true;
				return;
			}
			if ( ds_list2.GetColumn(i,"BIRTH") == "" )
			{
				gfn_showAlert("CW00001","생년월일");
				ds_list.fireevent = true;
				return;
			}
			if ( length(ds_list2.GetColumn(i,"BIRTH")) != 8)
			{
				gfn_showAlert("CW00011","8");
				ds_list.fireevent = true;
				return;
			}
			if ( length(ds_list2.GetColumn(i,"EDUDAT")) != 8)
			{
				gfn_showAlert("CW00011","8");
				ds_list.fireevent = true;
				return;
			}
			if ( ds_list2.GetColumn(i,"EDUDAT_FM") == "" )
			{
				gfn_showAlert("CW00001","교육시작시간");
				ds_list.fireevent = true;
				return;
			}if ( ds_list2.GetColumn(i,"EDUDAT_TO") == "" )
			{
				gfn_showAlert("CW00001","교육종료시간");
				ds_list.fireevent = true;
				return;
			}
			if ( length(ds_list2.GetColumn(i,"EDUTIM_FM")) <> 4 ||
			     length(ds_list2.GetColumn(i,"EDUTIM_TO")) <> 4 )
			{
				gfn_showAlert("CW00011","4");
				ds_list.fireevent = true;
				return;
			}
			if(ds_list2.GetColumn(i,"EDUTIM_FM") > ds_list2.GetColumn(i,"EDUTIM_TO"))
			{
				gfn_showAlert("CW00114","교육종료시간이 시작시간 보다 큰 건");
				ds_list.fireevent = true;
				return;
			}
			if(ds_list2.GetColumn(i,"EDUGBN") == "1" || ds_list2.GetColumn(i,"EDUGBN") == "2")
			{
				gfn_showAlert("CW00022", "신규자교육과 수시교육은 모바일에서만 입력가능합니다. 교육구분란" );
				ds_list.fireevent = true;
				return;
			}
		}
	}
	
	 ds_list.fireevent = true;
	
	tit_clearActionInfo();
	tit_addSelectExActionInfo(
		"wb05:WB0506001A_S2"
	   ,"wb05:WB0506001A_I1"
	   ,"wb05:WB0506001A_U1");
	
	//저장 처리 
	tit_callService(
		""
		, ""
		, "ds_list2=ds_list2:A"
		, ""
		, ""
		, "fn_afterSave");	
}
/********************************************************************************
* 기      능   : 
********************************************************************************/
function btn_upload_OnClick(obj)
{
	grd_list.Format = "Upload";
	
	Create("FileDialog", "_fileDialog_", "");
	var dialogObj = object("_fileDialog_");
	
	dialogObj.Type = "Open";
	dialogObj.FileName = "";
	dialogObj.Filter = "Microsoft Excel File(*.xls)|*.xls|Microsoft Excel File(*.xlsx)|*.xlsx|";
	dialogObj.open();
	
	if (length(dialogObj.FileName) == 0) {
		Destroy( "_fileDialog_" );
		return;
	}
	
	var sFileName = dialogObj.FilePath + "\\" + dialogObj.FileName;

	ext_ExcelImportByIndex(sFileName,null,"ds_excel",0,1);
	
	grd_list.BindDataset = "";

	ufn_ExcelToList();

	grd_list.BindDataset = "ds_list";
	
	Destroy( "_fileDialog_" );  // 불러오기후 dialog 제거	
}

function grd_list_OnCellDblClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
	var arg = "fa_edudat=" + quote(ds_list.GetColumn(nRow,"EDUDAT")) + " fa_edugbn=" + quote(ds_list.GetColumn(nRow,"EDUGBN")) 
	         +" fa_bumun=" +quote(ds_list.GetColumn(nRow,"BUMUN")) + " fa_edunam=" +quote(ds_list.GetColumn(nRow,"EDUNAM"))
	         +" fa_eduno=" +quote(ds_list.GetColumn(nRow,"EDUNO")) + " fa_posid=" +quote(ds_list.GetColumn(nRow,"POSID"))
	         +" fa_edutim_fm=" +quote(ds_list.GetColumn(nRow,"EDUTIM_FM")) + " fa_edutim_to=" +quote(ds_list.GetColumn(nRow,"EDUTIM_TO"));
	
	        
	 gfn_openPopup("WB0506001B", true, arg, 420, 529);       
	
}

function ufn_ExcelToList()
{
	ds_list.ClearData();

	grd_list.SetCellProp("head", 0, "Text", "1");
	
	for(i=1; i < ds_excel.rowcount ; i++) {
		ds_list.AddRow();
		
		ds_list.SetColumn(i-1,"CHECK","1");
		
		if( length(ds_excel.GetColumn(i,0)) != 8 ) 
		{
			gfn_showAlert("CW00008", "교육일");
			ds_list.ClearData();
			return;
		} else {
			ds_list.SetColumn(i-1,"EDUDAT", ds_excel.GetColumn(i,0));	
		}
		
		if(ds_excel.GetColumn(i,1) != "1" && ds_excel.GetColumn(i,1) != "2" &&
		   ds_excel.GetColumn(i,1) != "3" && ds_excel.GetColumn(i,1) != "4" &&
		   ds_excel.GetColumn(i,1) != "5" && ds_excel.GetColumn(i,1) != "6" && ds_excel.GetColumn(i,1) != "7" && ds_excel.GetColumn(i,1) != "8")
		{     
			gfn_showAlert("CW00022", "교육구분");
		    ds_list.ClearData();
		    return;
		} else {
			ds_list.SetColumn(i-1,"EDUGBN", ds_excel.GetColumn(i,1));	
		}
		
		if(ds_excel.GetColumn(i,2) != "승강기" && ds_excel.GetColumn(i,2) != "S/S" &&
		   ds_excel.GetColumn(i,2) != "서비스" && ds_excel.GetColumn(i,2) != "주차" && ds_excel.GetColumn(i,2) != "기타")
		{
			gfn_showAlert("CW00022", "사업부문");
			ds_list.ClearData();
			return;
		} else {
			ds_list.SetColumn(i-1,"BUMUN", ds_excel.GetColumn(i,2));			
	    }
	    
	    ds_list.SetColumn(i-1,"POSID",ds_excel.GetColumn(i,3));

		if(length(ds_excel.GetColumn(i,4)) > 1 && length(ds_excel.GetColumn(i,5)) < 1)
		{
			var cnt2 = ds_zzlifnr.searchRow("CODE== " + quote(ds_excel.GetColumn(i,4)));
			ds_list.SetColumn(i-1,"LIFNR2",ds_zzlifnr.GetColumn(cnt2,"CODE_NAME"));
			ds_list.SetColumn(i-1,"LIFNR",ds_excel.GetColumn(i,4));
		} else if(length(ds_excel.GetColumn(i,4)) < 1 && length(ds_excel.GetColumn(i,5)) > 1 )
		{
			ds_list.SetColumn(i-1,"LIFNR2",ds_excel.GetColumn(i,5));
			ds_list.SetColumn(i-1,"LIFNR","");
		} else if (length(ds_excel.GetColumn(i,4)) > 1 && length(ds_excel.GetColumn(i,5)) > 1 )
		{
			gfn_showAlert("CW00018","신규업체와 기존업체는");
			ds_list.ClearData();
			return;
		}
		
		ds_list.SetColumn(i-1,"EDUTIM_FM", ds_excel.GetColumn(i,6));
		ds_list.SetColumn(i-1,"EDUTIM_TO", ds_excel.GetColumn(i,7));
		ds_list.SetColumn(i-1,"EDUNAM", ds_excel.GetColumn(i,8));
		ds_list.SetColumn(i-1,"RANK", ds_excel.GetColumn(i,9));
		ds_list.SetColumn(i-1,"NAME1", ds_excel.GetColumn(i,10));
		ds_list.SetColumn(i-1,"BIRTH", ds_excel.GetColumn(i,11));
		ds_list.SetColumn(i-1,"TELH", ds_excel.GetColumn(i,12));
		ds_list.SetColumn(i-1,"BIGO", ds_excel.GetColumn(i,13));
		
		// 14: Level, 15:점수, 16:Pass/Fail
		if(ds_excel.GetColumn(i,14) != "OJ" && ds_excel.GetColumn(i,14) != "L1" &&
		   ds_excel.GetColumn(i,14) != "L2" && ds_excel.GetColumn(i,14) != "L3")
		{
			gfn_showAlert("CW00022", "Level");
			ds_list.ClearData();
			return;
		} else {
			ds_list.SetColumn(i-1,"LEV", ds_excel.GetColumn(i,14));			
	    }
	    
	    if(Length(ds_excel.GetColumn(i,15)) > 3 || ufn_IsNumberByDecimal(ds_excel.GetColumn(i,15)) == false)
		{
			gfn_showAlert("CW00022", "점수");
			ds_list.ClearData();
			return;
		} else {
			ds_list.SetColumn(i-1,"SCORE", ds_excel.GetColumn(i,15));			
	    }
	    
	    if(ds_excel.GetColumn(i,16) != "P" && ds_excel.GetColumn(i,16) != "F")
		{
			gfn_showAlert("CW00022", "Pass/Fail(P,F)");
			ds_list.ClearData();
			return;
		} else {
			ds_list.SetColumn(i-1,"PASS_INDC", ds_excel.GetColumn(i,16));			
	    }
	    
	    
	}
	
	//Trace(ds_list.saveXML());
}
// 숫자만으로 이루어진 내용인지 확인.
function ufn_IsNumberByDecimal(sNumber) { 
 var i; 
 var end = length(sNumber); 
 for(i=0; i	if(asc(CharAt(sNumber, i)) == 46) { 
	if(i == 0 || i == end-1) { 
		return false; 
	} 
	}else if(asc(CharAt(sNumber, i)) < 48 || asc(CharAt(sNumber, i)) > 57) { 
	return false; 
 } 
} 

function ds_list_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{	
	// if ( strColumnID <> "CHECK"){
		
		// ds_list.fireevent = false;
		// var colid = strColumnID;
		
		// if ( Trim(obj.GetColumn(nRow,colid)) != Trim(ds_list2.GetColumn(nRow,colid)))
		// {
			// obj.SetColumn(nRow,"CHECK","1");
		// } else {
			// obj.SetColumn(nRow,"CHECK","0");
		// }
	
	// ds_list.fireevent = true;
		
	// }
	
	if( strColumnID = "CHECK" && varNewValue = "1")
	{		
		ds_list.fireevent = false;
		gfn_copyDs(ds_list, ds_list3, "CHECK=1");
						
		ds_list.fireevent = true;
		tit_clearActionInfo();
		tit_addSearchActionInfo("wb05:WB0506001A_S3");
	
		tit_callService(
        ""
        , ""
        , "ds_list3=ds_list3"
        , "ds_list4=ds_list4"
        , ""
        , "ufn_afterDetail"
        , true);    
	}	
    ds_list.rowposition = nRow; //체크한 row로 포커스 이동
}

function btn_hogi_OnClick(obj)
{
	var hogin = gfn_openPopup("MM0901004A", true);
	
	if (hogin != null && obj == btn_hogi)
	{
		ed_posid.value = hogin[4];
	}
	
}
function btn_template_OnClick(obj)
{
	gfn_exportExcel(grd_list2,G_USER_ID);
}

function ufn_afterDetail()
{
    var path; 
	
	for(var i = 0; i<ds_list4.GetRowCount(); i++)
	{
		if( length(ds_list4.GetColumn(i,"IMAGE")) > 1 ) 
		{
			path = '';
			path = tit_getServerDir("QM/ED",ds_list4.GetColumn(i,"IMAGE"));
			
			ds_list4.SetColumn(i,"IMAGE", path);
		}
	}
}

/********************************************************************************
* 기      능   : Delete 
********************************************************************************/
function fn_delete() {
	gfn_clearMsgBar();

	if(ds_list.FindRow("CHECK", 1) == -1) {
		gfn_showMsg("CW00013");
		return;
	}

	ds_listD.ClearData();

	var j = 0;

	for(var i=0; i<=ds_list.RowCount(); i++) {
		if(ds_list.GetColumn(i, "CHECK") == true) { //체크박스가 true 일 경우
			ds_listD.AddRow();
			ds_listD.SetColumn(j, "FLAG", "D");
			ds_listD.SetColumn(j, "EDUNO", ds_list.GetColumn(i, "EDUNO"));

			j++;
		}
	}

	tit_clearActionInfo();
	tit_addSaveActionInfo(
        ""
        , ""
        , "wb05:WB0506001A_D1"
        , "FLAG");
	tit_callService(
        ""
        , ""
        , "ds_listD=ds_listD:A"
        , ""
        , ""
        , "fn_afterDelete");
}

/********************************************************************************
* 기      능   : 삭제 Callback  
********************************************************************************/
function fn_afterDelete(errCode, errMsg) {
	if(ds_error.rowcount() > 0) {
		gfn_showMsg("CE00001");
	} else {
		gfn_showMsg("CI00003");
	}

	fn_query();
}

function btn_search_OnClick(obj)
{
	gfn_openPopup("WB0506001D", true,);
}]]></Script>
</Window>