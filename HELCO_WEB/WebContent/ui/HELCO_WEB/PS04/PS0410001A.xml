<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="562" Id="PS0402001A" Left="8" OnLoadCompleted="fn_OnLoadCompleted" OnUnloadCompleted="fn_OnUnloadCompleted" PidAttrib="7" Title="기타외주&#32;작업요청서(협력업체)" Top="8" Ver="1.0" Width="978" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_cond">
				<Contents>
					<colinfo id="PSPID" size="256" type="STRING"/>
					<colinfo id="GUBUN" size="3" type="STRING"/>
					<colinfo id="HKONT" size="30" type="STRING"/>
					<colinfo id="KOSTL" size="30" type="STRING"/>
					<colinfo id="SEQNO" size="256" type="STRING"/>
					<colinfo id="W_GBN" size="3" type="STRING"/>
					<colinfo id="W_POSID" size="256" type="STRING"/>
					<record>
						<GUBUN></GUBUN>
						<HKONT></HKONT>
						<KOSTL></KOSTL>
						<PSPID></PSPID>
						<SEQNO></SEQNO>
						<W_GBN></W_GBN>
						<W_POSID></W_POSID>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list">
				<Contents>
					<colinfo id="PSPID" size="72" type="STRING"/>
					<colinfo id="GUBUN" size="3" type="STRING"/>
					<colinfo id="HKONT" size="30" type="STRING"/>
					<colinfo id="SEQNO" size="9" type="STRING"/>
					<colinfo id="ITEMNO" size="6" type="STRING"/>
					<colinfo id="ITEMTX" size="150" type="STRING"/>
					<colinfo id="UNIT" size="30" type="STRING"/>
					<colinfo id="CAPA" size="60" type="STRING"/>
					<colinfo id="QUAN" size="0" type="INT"/>
					<colinfo id="WRBTR" size="15" type="DECIMAL"/>
					<colinfo id="WAERS" size="15" type="STRING"/>
					<colinfo id="BGOTX" size="150" type="STRING"/>
					<colinfo id="POSID" size="72" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_hkont">
				<Contents>
					<colinfo id="HKONT" size="256" type="STRING"/>
					<colinfo id="TEXT" size="256" type="STRING"/>
					<record>
						<HKONT>0053011040</HKONT>
						<TEXT>지급임차료-장비</TEXT>
					</record>
					<record>
						<HKONT>0053025040</HKONT>
						<TEXT>지급수수료-용역</TEXT>
					</record>
					<record>
						<HKONT>0053031020</HKONT>
						<TEXT>운반보관비-양중비&#32;</TEXT>
					</record>
					<record>
						<HKONT>0053031030</HKONT>
						<TEXT>운반보관비-TRUSS양중비&#32;</TEXT>
					</record>
					<record>
						<HKONT>0053033010</HKONT>
						<TEXT>보수용역비</TEXT>
					</record>
					<record>
						<HKONT>0053037010</HKONT>
						<TEXT>설치외주비-일반</TEXT>
					</record>
					<record>
						<HKONT>0053037020</HKONT>
						<TEXT>설치외주비-배관배선비</TEXT>
					</record>
					<record>
						<HKONT>0053037030</HKONT>
						<TEXT>설치외주비-철거비</TEXT>
					</record>
					<record>
						<HKONT>0053037040</HKONT>
						<TEXT>설치외주비-건축부대공사비</TEXT>
					</record>
					<record>
						<HKONT>0053037050</HKONT>
						<TEXT>설치외주비-교체공사비</TEXT>
					</record>
					<record>
						<HKONT>0053040010</HKONT>
						<TEXT>현장관리비</TEXT>
					</record>
					<record>
						<HKONT>0053041040</HKONT>
						<TEXT>소모품비-현장소모품</TEXT>
					</record>
					<record>
						<HKONT>0053041900</HKONT>
						<TEXT>소모품비-기타</TEXT>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_longTexts1">
				<Contents>
					<colinfo id="TDOBJ" size="256" type="STRING"/>
					<colinfo id="TDNAME" size="256" type="STRING"/>
					<colinfo id="TDID" size="256" type="STRING"/>
					<colinfo id="TEXT" size="256" type="STRING"/>
					<colinfo id="FLAG" size="1" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_master">
				<Contents>
					<colinfo id="POST1" size="120" type="STRING"/>
					<colinfo id="LIF_NAME" size="256" type="STRING"/>
					<colinfo id="SITEADR" size="256" type="STRING"/>
					<colinfo id="SITETEL" size="256" type="STRING"/>
					<colinfo id="WRKNM" size="120" type="STRING"/>
					<colinfo id="MANNM" size="20" type="STRING"/>
					<colinfo id="MANTEL" size="39" type="STRING"/>
					<colinfo id="PM" size="30" type="STRING"/>
					<colinfo id="REQNM" size="30" type="STRING"/>
					<colinfo id="REQDAT" size="24" type="STRING"/>
					<colinfo id="WRITDAT" size="24" type="STRING"/>
					<colinfo id="LIFTEL" size="39" type="STRING"/>
					<colinfo id="LIFFAX" size="39" type="STRING"/>
					<colinfo id="TEMNM" size="30" type="STRING"/>
					<colinfo id="TEMTEL" size="39" type="STRING"/>
					<colinfo id="LIFGBN" size="3" type="STRING"/>
					<colinfo id="KUNNR" size="105" type="STRING"/>
					<colinfo id="BUSIMAN" size="30" type="STRING"/>
					<colinfo id="W_GBN" size="256" type="STRING"/>
					<colinfo id="PSPID" size="256" type="STRING"/>
					<colinfo id="GUBUN" size="256" type="STRING"/>
					<colinfo id="HKONT" size="256" type="STRING"/>
					<colinfo id="SEQNO" size="256" type="STRING"/>
					<colinfo id="KOSTL" size="256" type="STRING"/>
					<colinfo id="W_POSID" size="256" type="STRING"/>
					<colinfo id="STATE" size="256" type="STRING"/>
					<record>
						<BUSIMAN></BUSIMAN>
						<GUBUN></GUBUN>
						<HKONT></HKONT>
						<KOSTL></KOSTL>
						<KUNNR></KUNNR>
						<LIF_NAME></LIF_NAME>
						<LIFFAX></LIFFAX>
						<LIFGBN></LIFGBN>
						<LIFTEL></LIFTEL>
						<MANNM></MANNM>
						<MANTEL></MANTEL>
						<PM></PM>
						<POST1></POST1>
						<PSPID></PSPID>
						<REQDAT></REQDAT>
						<REQNM></REQNM>
						<SEQNO></SEQNO>
						<SITEADR></SITEADR>
						<SITETEL></SITETEL>
						<STATE></STATE>
						<TEMNM></TEMNM>
						<TEMTEL></TEMTEL>
						<W_GBN></W_GBN>
						<W_POSID></W_POSID>
						<WRITDAT></WRITDAT>
						<WRKNM></WRKNM>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_master2">
				<Contents></Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_longTexts2">
				<Contents>
					<colinfo id="TDOBJ" size="256" type="STRING"/>
					<colinfo id="TDNAME" size="256" type="STRING"/>
					<colinfo id="TDID" size="256" type="STRING"/>
					<colinfo id="TEXT" size="256" type="STRING"/>
					<colinfo id="FLAG" size="1" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_kostl">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond2">
				<Contents>
					<colinfo id="SEQNO" size="256" type="STRING"/>
					<colinfo id="GUBUN" size="256" type="STRING"/>
				</Contents>
			</Dataset>
		</Datasets>
		<Shape BKColor="user0" Bottom="560" Height="73" Id="Shape5" Left="0" LineColor="user1" Right="972" TabOrder="61" Top="487" Type="Rectangle" Width="972"></Shape>
		<Shape BKColor="user0" Bottom="487" Height="167" Id="Shape4" Left="0" LineColor="user1" Right="972" TabOrder="56" Top="320" Type="Rectangle" Width="972"></Shape>
		<Shape BKColor="user0" Bottom="288" Height="80" Id="Shape2" Left="0" LineColor="user1" Right="972" TabOrder="47" Top="208" Type="Rectangle" Width="972"></Shape>
		<Shape BKColor="user0" Bottom="208" Height="128" Id="Shape1" Left="0" LineColor="user1" Right="972" TabOrder="14" Top="80" Type="Rectangle" Width="972"></Shape>
		<Shape BKColor="user0" Bottom="80" Height="40" Id="Shape0" Left="0" LineColor="user1" Right="972" TabOrder="2" Top="40" Type="Rectangle" Width="972"></Shape>
		<Static Align="Right" Height="22" Id="Static1" Left="12" Style="sty_lb_search" TabOrder="1" Text="프로젝트&#32;" Top="47" VAlign="Middle" Width="61"></Static>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="HKONT" Column="HKONT" DataColumn="TEXT" Editable="TRUE" Height="24" Id="cb_hkont" ImeMode="none" InnerDataset="ds_hkont" Left="513" Search="NOTFILTERED" Style="sty_ipt_search" TabOrder="6" Top="45" Width="127"></Combo>
		<Static Align="Right" Height="23" Id="st_lifnr" Left="446" Style="sty_lb_search" TabOrder="5" Text="계정과목" Top="46" VAlign="Middle" Width="64"></Static>
		<Button Height="22" Id="btn_pjt" ImageID="btn_icon_search" Left="142" OnClick="btn_pjt_OnClick" TabOrder="8" Text="Button0" Top="47" Width="18"></Button>
		<Edit BindDataset="ds_cond" Border="Flat" Column="PSPID" Height="22" Id="ed_pjt" Left="74" Style="sty_ipt_search" TabOrder="7" Top="47" Width="65"></Edit>
		<Static Align="Right" Height="23" Id="st_zzactss" Left="656" Style="sty_lb_search" TabOrder="9" Text="사무소&#32;" Top="46" VAlign="Middle" Visible="FALSE" Width="50"></Static>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="CODE" Column="KOSTL" DataColumn="CODE_NAME" Height="24" Id="cb_kostl" InnerDataset="ds_kostl" Left="709" Style="sty_ipt_search" TabOrder="10" Top="45" Visible="FALSE" Width="97"></Combo>
		<Static Align="Right" Height="20" Id="Static5" Left="9" Style="sty_lb_form_basic" TabOrder="11" Text="기준호기" Top="88" VAlign="Middle" Width="77"></Static>
		<Edit BindDataset="ds_cond" Border="Flat" Column="W_POSID" Height="20" Id="ed_posid" Left="88" OnKeyDown="ed_posid_OnKeyDown" Style="sty_ipt_search" TabOrder="12" Top="88" UpperOnly="TRUE" Width="91"></Edit>
		<Static Align="Right" Border="Flat" Height="21" Id="Static6" Left="815" Style="sty_ipt_search" TabOrder="3" Top="47" VAlign="Middle" Width="122"></Static>
		<Static Align="Right" Height="23" Id="Static0" Left="173" Style="sty_lb_search" TabOrder="15" Text="현장명" Top="46" VAlign="Middle" Width="55"></Static>
		<Static Align="Right" Height="20" Id="Static2" Left="9" Style="sty_lb_form_basic" TabOrder="16" Text="설치업체" Top="112" VAlign="Middle" Width="77"></Static>
		<Static Align="Right" Height="20" Id="Static3" Left="8" Style="sty_lb_form_basic" TabOrder="17" Text="현장주소" Top="136" VAlign="Middle" Width="77"></Static>
		<Static Align="Right" Height="20" Id="Static4" Left="9" Style="sty_lb_form_basic" TabOrder="18" Text="작업명" Top="160" VAlign="Middle" Width="77"></Static>
		<Edit BindDataset="ds_master" BKColor="user0" Border="Flat" Column="POST1" Height="22" Id="ed_nam" Left="232" Readonly="TRUE" Style="sty_ipt_search" TabOrder="19" Top="47" Width="206"></Edit>
		<Edit BindDataset="ds_master" BKColor="user0" Border="Flat" Column="LIF_NAME" Height="20" Id="ed_lifnrnm" Left="88" Readonly="TRUE" Style="sty_ipt_search" TabOrder="20" Top="113" Width="194"></Edit>
		<Edit BindDataset="ds_master" BKColor="user0" Border="Flat" Column="SITEADR" Height="20" Id="ed_siteadd" Left="88" Readonly="TRUE" Style="sty_ipt_search" TabOrder="21" Top="137" Width="194"></Edit>
		<Static Align="Right" Height="20" Id="Static7" Left="288" Style="sty_lb_form_basic" TabOrder="22" Text="현장전화" Top="136" VAlign="Middle" Width="58"></Static>
		<Edit BindDataset="ds_master" Border="Flat" Column="WRKNM" Height="20" Id="ed_wrktx" Left="88" Style="sty_ipt_search" TabOrder="23" Top="160" Width="368"></Edit>
		<Static Align="Right" Height="20" Id="Static8" Left="9" Style="sty_lb_form_basic" TabOrder="24" Text="현장연락자" Top="184" VAlign="Middle" Width="77"></Static>
		<Edit BindDataset="ds_master" Border="Flat" Column="MANNM" Height="20" Id="ed_siteman" Left="88" Style="sty_ipt_search" TabOrder="25" Top="184" Width="91"></Edit>
		<Static Align="Right" Height="20" Id="Static9" Left="193" Style="sty_lb_form_basic" TabOrder="26" Text="TEL)현장연락자" Top="184" VAlign="Middle" Width="103"></Static>
		<Edit BindDataset="ds_master" Border="Flat" Column="MANTEL" Height="20" Id="ed_sitemantel" Left="303" Style="sty_ipt_search" TabOrder="27" Top="184" Width="91"></Edit>
		<Edit BindDataset="ds_master" BKColor="user0" Border="Flat" Column="SITETEL" Height="20" Id="ed_sitetel" Left="349" Readonly="TRUE" Style="sty_ipt_search" TabOrder="28" Top="137" Width="106"></Edit>
		<Static Align="Right" Height="20" Id="Static10" Left="288" Style="sty_lb_form_basic" TabOrder="29" Text="담당PM" Top="88" VAlign="Middle" Width="58"></Static>
		<Static Align="Right" Height="20" Id="Static11" Left="288" Style="sty_lb_form_basic" TabOrder="30" Text="요청자" Top="112" VAlign="Middle" Width="58"></Static>
		<Edit BindDataset="ds_master" BKColor="user0" Border="Flat" Column="REQNM" Height="20" Id="ed_reqman" Left="349" Readonly="TRUE" Style="sty_ipt_search" TabOrder="31" Top="113" Width="106"></Edit>
		<Edit BindDataset="ds_master" BKColor="user0" Border="Flat" Column="PM" Height="20" Id="ed_pm" Left="349" Readonly="TRUE" Style="sty_ipt_search" TabOrder="32" Top="89" Width="106"></Edit>
		<Static Align="Right" Height="20" Id="Static12" Left="481" Style="sty_lb_form_basic" TabOrder="33" Text="현장요구일" Top="88" VAlign="Middle" Width="77"></Static>
		<Static Align="Right" Height="20" Id="Static13" Left="481" Style="sty_lb_form_basic" TabOrder="34" Text="TEL)설치업체" Top="112" VAlign="Middle" Width="77"></Static>
		<Static Align="Right" Height="20" Id="Static14" Left="481" Style="sty_lb_form_basic" TabOrder="35" Text="호기팀장" Top="136" VAlign="Middle" Width="77"></Static>
		<Static Align="Right" Height="20" Id="Static15" Left="481" Style="sty_lb_form_basic" TabOrder="36" Text="작업업체" Top="160" VAlign="Middle" Width="77"></Static>
		<Radio BindDataset="ds_master" BKColor="user0" Border="None" Column="LIFGBN" Font="굴림,9" Height="24" Id="rd_chk2" INDEX="0" Left="565" Style="sty_ipt_form_radio" TabOrder="37" Top="160" Value="1" Width="216">
			<Contents>
				<Layout code="1" height="20" left="10" text="설치협력업체" top="0" width="110"/>
				<Layout code="2" height="20" left="120" text="외주협력업체" top="0" width="110"/>
			</Contents>
		</Radio>
		<Edit BindDataset="ds_master" BKColor="user0" Border="Flat" Column="TEMNM" Height="20" Id="ed_TEM" Left="561" Readonly="TRUE" Style="sty_ipt_search" TabOrder="38" Top="137" Width="99"></Edit>
		<Edit BindDataset="ds_master" BKColor="user0" Border="Flat" Column="LIFTEL" Height="20" Id="ed_intel" Left="561" Readonly="TRUE" Style="sty_ipt_search" TabOrder="39" Top="113" Width="99"></Edit>
		<Static Align="Right" Height="20" Id="Static16" Left="673" Style="sty_lb_form_basic" TabOrder="40" Text="FAX)설치업체" Top="112" VAlign="Middle" Width="77"></Static>
		<Static Align="Right" Height="20" Id="Static17" Left="673" Style="sty_lb_form_basic" TabOrder="41" Text="TEL)팀장" Top="136" VAlign="Middle" Width="77"></Static>
		<Static Align="Right" Height="20" Id="Static18" Left="673" Style="sty_lb_form_basic" TabOrder="42" Text="작성일" Top="88" VAlign="Middle" Width="77"></Static>
		<Edit BindDataset="ds_master" BKColor="user0" Border="Flat" Column="LIFFAX" Height="20" Id="ed_infax" Left="753" Readonly="TRUE" Style="sty_ipt_search" TabOrder="44" Top="113" Width="99"></Edit>
		<Edit BindDataset="ds_master" BKColor="user0" Border="Flat" Column="TEMTEL" Height="20" Id="ed_temtel" Left="753" Readonly="TRUE" Style="sty_ipt_search" TabOrder="43" Top="137" Width="99"></Edit>
		<Calendar BindDataset="ds_master" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="REQDAT" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_reqdat" Left="561" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_search" SundayTextColor="user35" TabOrder="45" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="87" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="99"></Calendar>
		<Calendar BindDataset="ds_master" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="WRITDAT" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_writdat" Left="753" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_search" SundayTextColor="user35" TabOrder="46" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="87" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="99"></Calendar>
		<Static Align="Right" Height="32" Id="Static19" Left="9" Style="sty_lb_form_basic" TabOrder="48" Text="발생내역/" Top="214" VAlign="Middle" Width="77"></Static>
		<TextArea BindDataset="ds_longTexts1" Column="TEXT" Height="73" Id="ta_text1" ImeMode="native" Left="88" MaxLength="200" TabOrder="49" Top="210" VScroll="TRUE" Width="878"></TextArea>
		<Static Align="Right" Height="37" Id="Static20" Left="9" Style="sty_lb_form_basic" TabOrder="50" Text="경위(구체적)" Top="246" VAlign="Middle" Width="77"></Static>
		<Shape BKColor="user0" Bottom="319" Height="31" Id="Shape3" Left="0" LineColor="user1" Right="972" TabOrder="51" Top="288" Type="Rectangle" Width="972"></Shape>
		<Static Align="Right" Height="20" Id="Static21" Left="9" Style="sty_lb_form_basic" TabOrder="52" Text="수주처" Top="293" VAlign="Middle" Width="77"></Static>
		<Static Align="Right" Height="17" Id="Static22" Left="481" Style="sty_lb_form_basic" TabOrder="53" Text="영업담당" Top="296" VAlign="Middle" Width="77"></Static>
		<Edit BindDataset="ds_master" Border="Flat" Column="KUNNR" Enable="FALSE" Height="21" Id="ed_kunnr" Left="90" Style="sty_ipt_search" TabOrder="54" Top="292" Width="326"></Edit>
		<Edit BindDataset="ds_master" Border="Flat" Column="BUSIMAN" Enable="FALSE" Height="20" Id="ed_businm" Left="561" Style="sty_ipt_search" TabOrder="55" Top="294" Width="99"></Edit>
		<Grid AreaSelect="true" AutoEnter="TRUE" AutoFitEndLine="Hide" BindDataset="ds_list" BkColor2="default" BoldHead="true" Border="Flat" Bottom="484" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="164" Id="grd_list" InputPanel="FALSE" Left="89" LineColor="user20" LineType="ExHORZ" OnHeadClick="grd_list_OnHeadClick" Right="969" RowHeight="20" Style="sty_grid" TabOrder="4" TabStop="true" Top="320" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="880">
			<contents>
				<format id="Default">
					<columns>
						<col width="161"/>
						<col width="73"/>
						<col width="54"/>
						<col width="55"/>
						<col width="60"/>
						<col width="467"/>
					</columns>
					<head>
						<cell col="0" color="user21" display="text" font="굴림,9" text="항목"/>
						<cell col="1" color="user21" display="text" font="굴림,9" text="WBS호기"/>
						<cell col="2" color="user21" display="text" font="굴림,9" text="단위"/>
						<cell col="3" color="user21" display="text" font="굴림,9" text="규격"/>
						<cell col="4" color="user21" display="text" font="굴림,9" text="수량"/>
						<cell col="5" color="user21" display="text" font="굴림,9" text="세부작업내용"/>
					</head>
					<body>
						<cell align="center" bkcolor2="user22" col="0" colid="ITEMTX" display="text" edit="normal"/>
						<cell align="center" bkcolor2="user22" col="1" colid="POSID" display="text" edit="normal"/>
						<cell align="right" bkcolor2="user22" col="2" colid="UNIT" display="text" edit="normal"/>
						<cell align="right" bkcolor2="user22" col="3" colid="CAPA" display="text" edit="normal"/>
						<cell align="right" bkcolor2="user22" col="4" colid="QUAN" display="number" edit="integer"/>
						<cell align="center" bkcolor2="user22" col="5" colid="BGOTX" display="text" edit="normal"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Static Align="Right" Height="50" Id="Static23" Left="9" Style="sty_lb_form_basic" TabOrder="57" Text="작" Top="321" VAlign="Middle" Width="77"></Static>
		<Static Align="Right" Height="42" Id="Static24" Left="9" Style="sty_lb_form_basic" TabOrder="58" Text="업" Top="366" VAlign="Middle" Width="77"></Static>
		<Static Align="Right" Height="34" Id="Static25" Left="9" Style="sty_lb_form_basic" TabOrder="59" Text="내" Top="406" VAlign="Middle" Width="77"></Static>
		<Static Align="Right" Height="42" Id="Static26" Left="9" Style="sty_lb_form_basic" TabOrder="60" Text="역" Top="439" VAlign="Middle" Width="77"></Static>
		<Static Align="Right" Height="22" Id="Static28" Left="9" Style="sty_lb_form_basic" TabOrder="62" Text="특이사항" Top="491" VAlign="Middle" Width="77"></Static>
		<Static Align="Right" Height="21" Id="Static29" Left="8" Style="sty_lb_form_basic" TabOrder="63" Text="및" Top="513" VAlign="Middle" Width="77"></Static>
		<Static Align="Right" Height="21" Id="Static30" Left="8" Style="sty_lb_form_basic" TabOrder="64" Text="요청사항" Top="534" VAlign="Middle" Width="77"></Static>
		<TextArea BindDataset="ds_longTexts2" Column="TEXT" Height="66" Id="ta_text2" ImeMode="none" Left="88" MaxLength="200" TabOrder="65" Top="488" VScroll="TRUE" Width="881"></TextArea>
		<Radio BindDataset="ds_master" BKColor="user0" Border="None" Column="W_GBN" Font="굴림,9" Height="21" Id="rd_chk1" INDEX="0" Left="816" Style="sty_ipt_form_radio" TabOrder="13" Top="48" Value="1" Width="120">
			<Contents>
				<Layout code="1" height="20" left="10" text="일반" top="0" width="45"/>
				<Layout code="2" height="20" left="70" text="긴급" top="0" width="45"/>
			</Contents>
		</Radio>
		<Button Cursor="HAND" Height="20" Id="btn_add" ImageID="btn_icon_plus" Left="914" LeftMargin="12" OnClick="btn_add_OnClick" Style="sty_btn" TabOrder="67" Top="297" Transparent="TRUE" Width="22"></Button>
		<Button Cursor="HAND" Height="20" Id="btn_del" ImageID="btn_icon_minus" Left="937" LeftMargin="12" OnClick="btn_del_OnClick" Style="sty_btn" TabOrder="66" Top="297" Transparent="TRUE" Width="22"></Button>
		<Div Height="36" Id="div_btn" Left="-1" TabOrder="68" Text="Div0" Url="WB01::CommBtnForm.xml" Width="972">
			<Contents></Contents>
		</Div>
	</Form>
	<Script><![CDATA[﻿﻿﻿﻿﻿﻿/*
 ******************************************************************************************
 * 기      능   : 
 * 작  성  자   : 
 * 작성  일자   : 
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
#include "LIB::commons.js";	// 공통 스크립트 
//=========================================================================================
// [ PART 1 ]
// Form에서 사용될 전역변수를 선언
// FORM에서 사용되는 전역변수는 대문자로 작성하며, F_XXX 의 형태를 갖도록 한다. 
//=========================================================================================
var userGroup = "";
var str = "";
var tdname = "";
var change;
var w_inst;
//=========================================================================================
// [ PART 2 ]
// Form Loading / Unloading 시 작업 정의
//=========================================================================================
function fn_OnLoadCompleted(obj) {

	//alert("fn_OnLoadCompleted");

	// Form 로드 이벤트 맨 첫줄에 기술 
	gfn_initForm(true);	
	gfn_initDs(ds_master, true);	
	gfn_initDs(ds_cond, true);	
		
	rd_chk1.Value = 1;
	rd_chk2.Value = 1;
	

	//기준일: 현재월의 첫날짜, 현재날짜	
	//cal_reqdat.Value = gfn_getCurrDate();
	//cal_writdat.Value = gfn_getCurrDate();
		
	var pspid   = p_pspid;
	var gubun   = p_gubun;  
	var hkont   = p_hkont;  
	var seqno   = p_seqno;  
	var w_posid = p_w_posid;
	change  = p_change;
	w_inst  = p_w_inst;
                              
		
	tdname = pspid+gubun+hkont+seqno;
	//tdname = '019821'+'1'+'0053031020'+'002';

	ds_cond.SetColumn(0,"PSPID",pspid);
	
	/*
	ds_cond.SetColumn(0,"GUBUN","1");
	if(change == "A')
	{
		ds_cond.SetColumn(0,"GUBUN",gubun);
	}
	*/
	
	ds_cond.SetColumn(0,"HKONT",hkont);
	//ds_cond.SetColumn(0,"GUBUN",gubun);	
	ds_cond.SetColumn(0,"GUBUN","1");	
	ds_cond.SetColumn(0,"SEQNO",seqno);	
	ds_cond.SetColumn(0,"W_POSID",w_posid);	
		
	tit_clearActionInfo();
	tit_addSearchActionInfo("ps04:PS0410001A_C1");         
	tit_callService(
		""
		, ""
		, "ds_cond=ds_cond"
		, "ds_kostl=ds_kostl"
		, ""
		, ""  //"fn_afterQueryC"
		, ""
		, ""
		, true);

	if(change == "A")
	{
		fn_query();
	}
	else if(change == "B")
	{   
		gfn_initDs(ds_longTexts2, true);	
		gfn_initDs(ds_longTexts1, true);	
	}


	//cb_yearf.SetFocus();
}
    
    
/********************************************************************************
* 기      능   : 프로젝트 조회 팝업
********************************************************************************/    
function btn_popProj_OnClick(obj)
{

	//alert("btn_popProj_OnClick");
	//alert("1");
	var arg = "pjt="+quote(ed_pjt.Text);
	gfn_openPopup("CS9601002A", true, arg);
	
	/*
	tit_clearActionInfo();
	tit_addSearchActionInfo("ps04:PS0410001A_S1");         
	tit_callService(
		""
		, ""
		, "ds_cond=ds_cond"
		, "ds_master=ds_master"
		, ""
		, "fn_query"
		, true);
    
	*/
	 fn_posid();
    
}    
    
    
/********************************************************************************
* 기      능   :  프로젝트 팝업으로 호기 선택시 후속작업
********************************************************************************/    
function fn_posid()
{
	tit_clearActionInfo();
	tit_addSearchActionInfo("ps04:PS0410001A_S1");         
	tit_callService(
		""
		, ""
		, "ds_cond=ds_cond"
		, "ds_master=ds_master"
		, ""
		, ""  //"fn_query"
		, ""
		, ""
		, true);
		
}    
    
    

/********************************************************************************
* 기      능   : 세금계산년 계산(현재년도,당해년도에서 뺄 년수, 당해년도에서 더할 년수
********************************************************************************/
function fn_makeYear(curYear,sNum,eNum)      
{
    /*
	var rowCnt = eNum-sNum;
	var row = 0;

	for(var i=rowCnt; i>-1; i--)
	{
		ds_yearf_cd.AddRow();
		ds_yearf_cd.SetColumn(row,"CODE",parseInt(curYear)+i+parseInt(sNum));
		ds_yearf_cd.SetColumn(row,"CODE_NAME",(parseInt(curYear)+i+parseInt(sNum))+"년");
		ds_yeart_cd.AddRow();
		ds_yeart_cd.SetColumn(row,"CODE",parseInt(curYear)+i+parseInt(sNum));
		ds_yeart_cd.SetColumn(row,"CODE_NAME",(parseInt(curYear)+i+parseInt(sNum))+"년");
		row++;
	}
	cb_yearf.index = eNum;
	cb_yeart.index = eNum;
	*/
}
/********************************************************************************
* 기      능   : 조회 
********************************************************************************/
function fn_query() {
	//alert(ds_cond.SaveXML());	
	//alert(ds_cond.SaveXML());
	
	tit_clearActionInfo();
	tit_addSearchActionInfo("ps04:PS0410001A_S1");         
	tit_callService(
		""
		, ""
		, "ds_cond=ds_cond"
		, "ds_master=ds_master"
		, ""
		, "fn_afterQuery"
		, ""
		, ""
		, true);
 
	
	   
	//alert(ds_cond.SaveXML());

	gfn_initDs(ds_longTexts2, true);	
	gfn_initDs(ds_longTexts1, true);	
	
	var str = ufn_getLongText(ds_longTexts1,"ZPST001",tdname,"Z004");	//발생내역/경위(구체적)
	var str = ufn_getLongText(ds_longTexts2,"ZPST001",tdname,"Z001");	//특이사항 및 요청사항
	
	
	
	//  입력/변경 구분에 따라서 활성/비활성 
	if(change == "A")
    {   //alert("1");
		ed_pjt.Enable = false;
		cb_hkont.Enable = false;
		btn_pjt.Enable = false;
    }
    else if(change == "B")
    {	//alert("2");
		ed_pjt.Enable = true;
		cb_hkont.Enable = true;
		btn_pjt.Enable = true;
    }	
	
	
	// 신청분/승인분 에 따라서 활성/비활성 
	if(w_inst <> 'X')  //승인분
	{	//alert("3");
		ed_pjt.Enable = false;			btn_pjt.Enable = false;
		cb_hkont.Enable = false;		cb_kostl.Enable = false;
		rd_chk1.Enable = false;			ed_posid.Enable = false;
		cal_reqdat.Enable = false;		cal_writdat.Enable = false;
		ed_wrktx.Enable = false;		ed_siteman.Enable = false;
		ed_sitemantel.Enable = false;	rd_chk2.Enable = false;
		ta_text1.Enable = false;		grd_list.Enable = false;
		ta_text2.Enable = false;		btn_add.Enable = false;
		btn_del.Enable = false;
		
		div_btn.btn_save.Enable = false;		
		div_btn.btn_delete.enable = false;		
		div_btn.btn_reset.enable = false;
	}
	else
	{
		
		
		if(change == "A")
		{	//alert("4");
			ed_pjt.Enable = false;			btn_pjt.Enable = false;
			cb_hkont.Enable = false;			
		}
		else if(change == "B")
		{	//alert("5");
			ed_pjt.Enable = true;			btn_pjt.Enable = true;
			cb_hkont.Enable = true;	
		}
		
		
		
		if (length(tdname) > 0)
		{
		
			div_btn.btn_reset.enable = false;
		}
		else
		{
			div_btn.btn_reset.enable = true;
		}
		
		
		cb_kostl.Enable = true;
		rd_chk1.Enable = true;			ed_posid.Enable = true;
		cal_reqdat.Enable = true;		cal_writdat.Enable = true;
		ed_wrktx.Enable = true;			ed_siteman.Enable = true;
		ed_sitemantel.Enable = true;	rd_chk2.Enable = true;
		ta_text1.Enable = true;			grd_list.Enable = true;
		ta_text2.Enable = true;			btn_add.Enable = true;
		btn_del.Enable = true;
		
		div_btn.btn_save.Enable = true;		
		div_btn.btn_delete.enable = true;		
		
	}

	//alert("7");
	div_btn.btn_query.enable = false;

}
 

/********************************************************************************
* 기      능   : (+)버튼 클릭시
********************************************************************************/
function btn_add_OnClick(obj)
{
	ds_list.fireevent = false;
	ds_list.AddRow();			
	//ds_list.SetColumn(ds_head.currow,"FLAG","I");
	
	
	ds_list.SetColumn(ds_list.currow,"PSPID",ds_cond.GetColumn(0,"PSPID"));
	ds_list.SetColumn(ds_list.currow,"GUBUN", "1");
	ds_list.SetColumn(ds_list.currow,"HKONT",cb_hkont.value);
	//ds_list.SetColumn(ds_list.currow,"PSPID",cb_hkont.value);
	
	ds_list.SetColumn(ds_list.currow,"ITEMTX","");
	ds_list.SetColumn(ds_list.currow,"POSID","");
	ds_list.SetColumn(ds_list.currow,"UNIT","");
	ds_list.SetColumn(ds_list.currow,"CAPA","");
	ds_list.SetColumn(ds_list.currow,"QUAN",0);
	
	ds_list.SetColumn(ds_list.currow,"WRBTR",0);
	
	ds_list.SetColumn(ds_list.currow,"BGOTX","0");	
	ds_list.fireevent = true;
}


/********************************************************************************
* 기      능   : (-)버튼 클릭시
********************************************************************************/
function btn_del_OnClick(obj)
{
	ds_list.DeleteRow(ds_list.row);
}


/********************************************************************************
* 기      능   : 조회 Callback  
********************************************************************************/
function fn_afterQuery(errCode, errMsg) {
	//gfn_showMsg("CI00002",ds_list.RowCount()+"");
		 
	//alert(ds_cond.SaveXML());	 
	//alert("fn_afterQuery-1");	 
	//alert(ds_cond.SaveXML());	 
		 
	tit_clearActionInfo();
	tit_addSearchActionInfo("ps04:PS0410001A_S2");         
	tit_callService(
		""
		, ""
		, "ds_cond=ds_cond"
		, "ds_list=ds_list"
		, ""
		, ""  //"fn_afterQuery"
		, ""
		, ""
		, true);	 
		 
	//alert(ds_cond.SaveXML());	 
	//alert("fn_afterQuery-2");	 
	//alert(ds_cond.SaveXML());
	
    //alert(ds_cond.SaveXML());
    
	//if( ed_pjt.Text == "" )
	if(ed_nam.text == "")
	{	
		//alert("fn_afterQuery-3");	
		gfn_initDs(ds_master, true);	
		
		rd_chk1.Value = 1;
		rd_chk2.Value = 1;

			
	}		 
		 
		 
	//alert("fn_afterQuery-4");	
}




/********************************************************************************
* 기      능   : 공통코드가 조회된 후의 Callback 함수 
********************************************************************************/
function fn_completeInit(sCode, sDsObj, sCodeType) {
	if(userGroup == "40")
	{
		cb_zzactss.Index = 0;
		cb_zzactss.Enable = true;
	}
	else if(userGroup == "30")
	{
		ds_zzactss.Filter("CODE="+quote(G_AREA_CODE_E));
		cb_zzactss.Index = 0;
		cb_zzactss.Enable = false;
	}
	else if(userGroup == "10")
	{
		cb_zzactss.Index = 0;
		cb_zzactss.Enable = false;
	}
}


/********************************************************************************
* 기      능   : form UnloadCompleted 
********************************************************************************/
function fn_OnUnloadCompleted(obj) {
	return gfn_isFormUnload(obj);
}
//=========================================================================================
// [ PART 3 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,form닫기)
//=========================================================================================

/********************************************************************************
* 기      능   : 닫기  
********************************************************************************/
function fn_close() {
	close();
}
/********************************************************************************
* 기      능   : 그리드 헤더 클릭시 정렬 처리 
********************************************************************************/
function grd_list_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
{	
	if ( nCell == 0 ) {
		// 현재 처리할 format 기억
		gfn_selectGridCol("grd_list");
	} else {
		gfn_sortGrid(obj,nCell);
	}
}
/********************************************************************************
* 기      능   : 액셀  
********************************************************************************/
function fn_excel() {
	//gfn_saveToExcel(grd_list, true );
}

/********************************************************************************
* 기      능   : 원프로젝트 팝업
********************************************************************************/
function btn_pjt_OnClick(obj)
{
	//alert("btn_pjt_OnClick");	 
	
	var arg = "pjt="+quote(ed_pjt.Text);
	gfn_openPopup("CS9601002A",true,arg);
}

/********************************************************************************
* 기      능   : print 40
********************************************************************************/
function fn_print() 
{
	//gfn_openPopup("PS0402001C",true);
}
/********************************************************************************
* 기      능   : print 40
********************************************************************************/
function fn_print1() 
{
	/*
	ds_cond_p.ClearData();
	ds_cond_p.AddRow();
	ds_cond_p.SetColumn(0,"PSPID",ds_list.GetColumn(ds_list.row,"PSPID"));
	ds_cond_p.SetColumn(0,"GUBUN",ds_list.GetColumn(ds_list.row,"GUBUN"));
	ds_cond_p.SetColumn(0,"HKONT",ds_list.GetColumn(ds_list.row,"HKONT"));
	ds_cond_p.SetColumn(0,"SEQNO",ds_list.GetColumn(ds_list.row,"SEQNO"));
	
	//특기사항불러오기  
	var tdname = ds_list.GetColumn(ds_list.row,"PSPID")+ds_list.GetColumn(ds_list.row,"GUBUN")+ds_list.GetColumn(ds_list.row,"HKONT")+ds_list.GetColumn(ds_list.row,"SEQNO");
	//str = gfn_getLongText(ds_longTexts,"ZPST001",tdname,"Z001");

	tit_clearActionInfo();
	tit_addSearchActionInfo("ps04:PS0402001A_S2");
	tit_callService(
        ""
        , ""
        , "ds_cond=ds_cond_p"
        , "ds_master=ds_master"
        , ""
        , "fn_afterQuery2"
        , true);
    */
}

/********************************************************************************
* 기      능   : print 40
********************************************************************************/
function fn_print2() 
{   /*
	ds_cond_p.ClearData();
	ds_cond_p.AddRow();
	ds_cond_p.SetColumn(0,"PSPID",ds_list.GetColumn(ds_list.row,"PSPID"));
	ds_cond_p.SetColumn(0,"GUBUN",ds_list.GetColumn(ds_list.row,"GUBUN"));
	ds_cond_p.SetColumn(0,"HKONT",ds_list.GetColumn(ds_list.row,"HKONT"));
	ds_cond_p.SetColumn(0,"SEQNO",ds_list.GetColumn(ds_list.row,"SEQNO"));

	tit_clearActionInfo();
	tit_addSearchActionInfo("ps04:PS0402001A_S3");
	tit_callService(
        ""
        , ""
        , "ds_cond=ds_cond_p"
        , "ds_master2=ds_master"
        , ""
        , "fn_afterQuery3"
        , true);
    */
}



/********************************************************************************
* 기      능   : 프로젝트에서 엔터키 처리 
********************************************************************************/
function ed_posid_OnKeyDown(obj,nChar,bShift,bCtrl, bAlt,LLParam,HLParam)
{
	
	//alert("ed_posid_OnKeyDown");
	ds_cond.SetColumn(0,"W_POSID",ed_posid.Text);	
	if(nChar == 13)
	{
		fn_query();
	}
	
}


/********************************************************************************
* 기      능   : 저장
********************************************************************************/
function fn_save() 
{
	if(gfn_isNull(ed_pjt, true, ed_pjt.Value)) return false; // 프로젝트
	if(gfn_isNull(cb_hkont, true, cb_hkont.Value)) return false; // 계정
	//if(gfn_isNull(rd_chk1, true, rd_chk1.Value)) return false; // 일반, 긴급
	if(gfn_isNull(ed_posid, true, ed_posid.Value)) return false; // 기준호기
	
	if(gfn_isNull(cal_reqdat, true, cal_reqdat.Value)) return false; // 현장요구일
	if(gfn_isNull(cal_writdat, true, cal_writdat.Value)) return false; // 작성일
	if(gfn_isNull(ed_wrktx, true, ed_wrktx.Value)) return false; // 작업명
	//if(gfn_isNull(rd_chk2, true, rd_chk2.Value)) return false; // 작업업체 구분
	if(gfn_isNull(ed_siteman, true, ed_siteman.Value)) return false; // 현장연락자
	if(gfn_isNull(ed_sitemantel, true, ed_sitemantel.Value)) return false; // 현장연락자 전화
	
	
	/* 신규 입력시 */
	
	

	if (length(tdname) < 1)
	{   	
		//gfn_initDs(ds_cond2, true);		
		
		tit_clearActionInfo();
		tit_addSearchActionInfo("ps04:PS0410001B_S2");      		
		tit_callService(
			""
			, ""
			, "ds_cond=ds_cond"
			, "ds_cond2=ds_cond2"
			, ""
			, ""  //"fn_save_afterQuery1"
			, ""
            , ""
			, true
			);
			

	
		ds_cond.SetColumn(0,"GUBUN",ds_cond2.GetColumn(0,"GUBUN"));	
		ds_cond.SetColumn(0,"SEQNO",gfn_fillZero(ds_cond2.GetColumn(0,"SEQNO"),2));
		    
		tdname = ds_cond.GetColumn(0,"PSPID") + "1" + ds_cond.GetColumn(0,"HKONT") + ds_cond.GetColumn(0,"SEQNO"));
		
	}
	
	
	
	/* 롱텍스트 저장*/
	//alert(ta_text1.value);
	var str = ufn_saveLongText(ds_longTexts1, ta_text1.value, "Z004",tdname, "ZPST001");	//발생내역/경위(구체적)	
	var str = ufn_saveLongText(ds_longTexts2, ta_text2.value, "Z001",tdname, "ZPST001");	//특이사항 및 요청사항
	
	
	ds_longTexts1.Reset();	
	var str = ufn_getLongText(ds_longTexts1,"ZPST001",tdname,"Z004");	//발생내역/경위(구체적)
	ds_longTexts2.Reset();
	var str = ufn_getLongText(ds_longTexts2,"ZPST001",tdname,"Z001");	//특이사항 및 요청사항	
	 
	 
	/* ZPST0117 저장 */
	ds_master.SetColumn(0,"PSPID",ds_cond.GetColumn(0,"PSPID"));
	ds_master.SetColumn(0,"GUBUN",ds_cond.GetColumn(0,"GUBUN"));/
	ds_master.SetColumn(0,"HKONT",ds_cond.GetColumn(0,"HKONT"));
	ds_master.SetColumn(0,"SEQNO",ds_cond.GetColumn(0,"SEQNO"));
	ds_master.SetColumn(0,"KOSTL",ds_cond.GetColumn(0,"KOSTL"));
	ds_master.SetColumn(0,"W_POSID",ds_cond.GetColumn(0,"W_POSID"));
	
	
	tit_clearActionInfo();
	tit_addSelectExActionInfo("ps04:PS0410001B_S1", "ps04:PS0410001B_I1", "ps04:PS0410001B_U1");
 
	tit_callService(
		""
		, ""
		, "ds_master=ds_master"
		, ""
		, ""
		, "fn_afterSave"
		, ""
		, ""
		, true  // ""
		
		);
	
	
	
	/* ZPST0117L 저장 */
	var j = ds_list.GetRowCount();
	var tmp;
	
	for(var i=0; i<j; i++) 
	{
		   
	    ds_list.SetColumn(i, "SEQNO", gfn_fillZero(ds_cond.GetColumn(0,"SEQNO"),2) );	    
	    ds_list.SetColumn(i, "ITEMNO", gfn_fillZero(i+1,1));
	}
	

		
	tit_clearActionInfo();	
	tit_addSingleActionInfo("ps04:PS0410001B_D1");
	tit_addMultiActionInfo("ps04:PS0410001B_I2");
	tit_callService(
        ""
        , ""        
        , "ds_list=ds_list"
        , ""
        , ""
        , "fn_afterSave"
		, ""
		, ""
        ,true  // ""
        );	
	

	
	
}



/********************************************************************************
* 기      능   : 저장 Callback  
********************************************************************************/
function fn_afterSave(errCode, errMsg) {
	if ( errCode != 0 ) {
		gfn_showMsg("CE00001");
	} else {
		gfn_showMsg("CI00003");		
		//fn_query();
	}
}



/********************************************************************************
* 기      능   : 삭제
********************************************************************************/
function fn_delete() 
{

	if (!gfn_showConfirm("CI00015","요청서")) 
	{
		return;
	}	


	tit_clearActionInfo();	
	tit_addSingleActionInfo("ps04:PS0410001B_D2");
	tit_addSingleActionInfo("ps04:PS0410001B_D3");	
	tit_callService(
        ""
        , ""        
        , "ds_cond=ds_cond"
        , ""
        , ""
        , "fn_afterSave"
		, ""
		, ""
        ,true  // ""
        );	
        
     parent.fn_query();    
     fn_close();
     
	//fn_reset("D");
        
}


/********************************************************************************
* 기      능   : 출력
********************************************************************************/
function fn_print() 
{

}


/********************************************************************************
* 기      능   : 출력
********************************************************************************/
function fn_reset(CHK) 
{


	if (!gfn_showConfirm("CI00013","작업")) 
	{
		return;
	}	

	    
    gfn_initDs(ds_cond, true);	
	gfn_initDs(ds_master, true);	
	gfn_initDs(ds_cond2, true);
	gfn_initDs(ds_list, true);
	gfn_initDs(ds_longTexts1, true);
	gfn_initDs(ds_longTexts2, true);
			
	ds_master.SetColumn(0, "W_GBN", "1");
	ds_master.SetColumn(0, "LIFGBN", "1");
	
	
	/*
	ds_cond.Reset();
	ds_cond2.Reset();
	ds_master.Reset();
	ds_list.Reset();
	ds_longTexts1.Reset();
	ds_longTexts2.Reset();
	*/
	
	
}


/********************************************************************************
* 기      능   : 롱텍스트 저장
********************************************************************************/
function ufn_saveLongText(dsObj, txtDesc, tabId, tabColName, tabObj) {
	var len = 0;
	var str = array();
		
		
	//str = gfn_substrToArray(txtDesc, 72);
	str = ufn_substrToArray(txtDesc, 72);
	//str = ufn_substrToArray(txtDesc, 10);
	
	//alert(str[1]);
	
	len = length(str);	

//alert(str);	
//alert(len);

 
	dsObj.clearData();
	for(var i=0; i<len; i++) 
	{
	    
//alert(i);
//alert(str[i]);
		dsObj.addRow();
		dsObj.SetColumn(i, "TEXT", str[i]);		
		dsObj.SetColumn(i, "FLAG", "I");
		
	}
		
//alert( str[0]) ;	
/*
alert("[rowCount]=="+dsObj.Rowcount());
for (var i=0; i<dsObj.RowCount();i++)
{
	alert( "[dsObj.getColumn]=="+dsObj.getColumn(i, "TEXT") ) ;
}
*/

	
	var result = false;
	tit_callService(
        "COMM_ACT"
        , "saveLongText"
        , "ds_list="+ quote(dsObj.id)
        , ""
        , "TDID=" + quote(tabId) + " TDNAME=" 
				+ quote(tabColName) +" TDOBJECT=" + quote(tabObj)
		, ""
        , true
        , true
        , true);
    if (_ETEXT == "")
    {
		result = true;
    }
    
	return result;
}


/******************************************************
* 주어진 글자를 len 만큼 잘라서 배열로 return
* @param  str  주어진 글자
* @param  len  자리수
******************************************************/
function ufn_substrToArray(str, len) {
	var rtn = array();
	var temp = "";
	var tCnt = 0;
	var cnt = 0;
		
	
	//===============================================================
	//===============================================================
	var tmp_str;	
	
	var lt_cnt = 0;
	var lt_cnt2 = 0;
	var chk = "";
		
	str = replace(str,chr(13)+chr(10),"|");	

	for( var i = 0; i < length(str); i++ ) 
	{   	
		chk = "";
		if ( charAt( str, i) == "|" ) 
		{
			lt_cnt = 0;
			lt_cnt2++;
			chk = "X";
			tmp_str = "";			
		}
		else
		{
			if ( lengthb(charAt( str, i)) == 2 )
			{
				lt_cnt = lt_cnt + 2;
				tmp_str = charAt( str, i);
			}
			else
			{
				lt_cnt = lt_cnt + 1;
				tmp_str = charAt( str, i);
			}
		}
				
		temp += tmp_str;	
				
		if ( lt_cnt == len )
		{
			temp += "";	
			lt_cnt = 0;
			lt_cnt2++;
			chk = "X";
		}
			
		if ( chk == "X" )
		{			
			if ( length( temp ) > 0 ) 
			{
				rtn[lt_cnt2 - 1] = temp;			
				temp = "";
			}
			else
			{
				lt_cnt2 = lt_cnt2 - 1;					
			}			
		}
		else if ( length(str) == i + 1 )
		{
			rtn[lt_cnt2] = temp;
			temp = "";
		}
	}
	return rtn;
	
	//===============================================================
	//===============================================================

/*
	//str = replace(str,chr(13)+chr(10),"");	
	
	for( var i = 0; i < length( tmp_srt); i++ ) {
		
					
		// 한글이면 더하면 크다 .
		if ( lengthb(charAt( tmp_srt, i)) == 2 && (tCnt+2) > len ) {
			rtn[cnt++] = temp;		
			temp = charAt( tmp_srt, i);

			tCnt = 2;
			continue;
		} else if ( tCnt == len ) {
			rtn[cnt++] = temp;		
			temp = charAt( tmp_srt, i);	  
			
			tCnt = lengthb(charAt( tmp_srt, i));
			
			continue;
		}
		
		
		temp += charAt( tmp_srt, i);
		tCnt += lengthb(charAt( tmp_srt, i));	
	
			
				
	}
	
	if ( length( temp ) > 0 ) {
		rtn[cnt++] = temp;

	}
		
	return rtn;
*/	
	
	
}







/********************************************************************************
* 기      능   : 롱텍스트 읽기
********************************************************************************/

function ufn_getLongText(dsObj, tabObj, tabColName, tabId) {
	
	if ( length( tabObj) == 0 || length( tabColName) == 0 || length( tabId) == 0) {
		return "";
	}
	
	// 저장후 조회시 새로 보여야 함
	// var nRow = dsObj.searchRow("TDOBJ== " + quote(tabObj) 
		// + " && TDNAME ==" + quote( tabColName )
		// + " && TDID == " + quote( tabId ) );
	
	// if ( nRow >= 0 ) {
		// return dsObj.getColumn(nRow, "O_TEXT");
	// }
	
	tit_callService(
        "COMM_ACT"
        , "getLongText2"
        , ""
        , ""
        , "TDID=" + quote(tabId) + " TDNAME=" 
				+ quote(tabColName) +" TDOBJECT=" + quote(tabObj)
        , ""
        , false
        , true
        , true);
    
    nRow = dsObj.addRow();    
    dsObj.setColumn(nRow, "TDOBJECT", tabObj);
    dsObj.setColumn(nRow, "TDNAME", tabColName);
    dsObj.setColumn(nRow, "TDID", tabId);
    
    //alert(_LONGTEXT);
    //ufn_replaceSpecialChar(_LONGTEXT);  //문자 변환
    
    dsObj.setColumn(nRow, "TEXT", _LONGTEXT);
    
	return _LONGTEXT;
}



/********************************************************************************
* 기      능   : 문자변환
********************************************************************************/
/*
function ufn_replaceSpecialChar(inStr) {
	var str = "<br>";
	var rStr = inStr;
	for( var i = 0; i < length( str); i++ ) {
		rStr = replace(rStr, str[i], "\n");
	}

	return rStr;
}
*/


]]></Script>
</Window>