<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="592" Id="Sbi0090" Left="8" OnLoadCompleted="fn_OnLoadCompleted" OnSize="Sbi0090_OnSize" OnTimer="form_OnTimer" OnUnloadCompleted="fn_OnUnloadCompleted" PidAttrib="7" Title="브랜드&#32;등록" Top="8" Ver="1.0" Width="1888" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_combo">
				<Contents>
					<colinfo id="code" size="256" type="STRING"/>
					<colinfo id="name" size="256" type="STRING"/>
					<colinfo id="st" size="1" type="STRING"/>
					<record>
						<code>NOBRND</code>
						<name>NOBRND</name>
						<st></st>
					</record>
					<record>
						<code>GSP_MR</code>
						<name>GSP_MR</name>
						<st></st>
					</record>
					<record>
						<code>LUXEN_2</code>
						<name>LUXEN_2</name>
						<st></st>
					</record>
					<record>
						<code>IXEL</code>
						<name>IXEL</name>
						<st></st>
					</record>
					<record>
						<code>HEEL</code>
						<name>THEEL</name>
						<st></st>
					</record>
					<record>
						<code>LUXEN_1</code>
						<name>LUXEN_1</name>
						<st></st>
					</record>
					<record>
						<code>GSP_MRL</code>
						<name>GSP_MRL</name>
						<st></st>
					</record>
					<record>
						<code>NEO_MRL</code>
						<name>NEO_MRL</name>
						<st></st>
					</record>
					<record>
						<code>NEWYZER</code>
						<name>NEWYZER</name>
						<st></st>
					</record>
					<record>
						<code>SPACESAVER</code>
						<name>SPACESAVER</name>
						<st></st>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond">
				<Contents>
					<colinfo id="ATKLA" size="256" summ="default" type="STRING"/>
					<colinfo id="BRNDCD" size="256" summ="default" type="STRING"/>
					<colinfo id="BRNDSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="PRH" size="256" summ="default" type="STRING"/>
					<colinfo id="ZPRDGBN" size="256" summ="default" type="STRING"/>
					<colinfo id="MDATATYPE" size="256" summ="default" type="STRING"/>
					<colinfo id="DIPSDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="PRHNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="DDATATYPE" size="256" summ="default" type="STRING"/>
					<record>
						<ATKLA></ATKLA>
						<BRNDCD></BRNDCD>
						<BRNDSEQ></BRNDSEQ>
						<DDATATYPE></DDATATYPE>
						<DIPSDAT></DIPSDAT>
						<MDATATYPE></MDATATYPE>
						<PRH></PRH>
						<PRHNAME></PRHNAME>
						<ZPRDGBN></ZPRDGBN>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_zsdt1141">
				<Contents>
					<colinfo id="MANDT" size="256" summ="default" type="STRING"/>
					<colinfo id="BRNDSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="ZPRDGBN" size="256" summ="default" type="STRING"/>
					<colinfo id="BRNDCD" size="256" summ="default" type="STRING"/>
					<colinfo id="PRH" size="256" summ="default" type="STRING"/>
					<colinfo id="DISPTP" size="256" summ="default" type="STRING"/>
					<colinfo id="MODITP" size="256" summ="default" type="STRING"/>
					<colinfo id="EGISSND" size="256" summ="default" type="STRING"/>
					<colinfo id="DIPSDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="AENAM" size="256" summ="default" type="STRING"/>
					<colinfo id="AEDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="FLAG" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_error">
				<Contents>
					<colinfo id="IDX" size="256" type="STRING"/>
					<colinfo id="ERRMSG" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_zsdt1142">
				<Contents>
					<colinfo id="MANDT" size="256" summ="default" type="STRING"/>
					<colinfo id="BRNDSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="ZPRDGBN" size="256" summ="default" type="STRING"/>
					<colinfo id="BRNDCD" size="256" summ="default" type="STRING"/>
					<colinfo id="BRNDCDNM" size="256" summ="default" type="STRING"/>
					<colinfo id="PRH" size="256" summ="default" type="STRING"/>
					<colinfo id="PRD" size="256" summ="default" type="STRING"/>
					<colinfo id="DISPTP" size="256" summ="default" type="STRING"/>
					<colinfo id="DIPSDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="AEDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="AENAM" size="256" summ="default" type="STRING"/>
					<colinfo id="FLAG" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_sanyangPrh">
				<Contents>
					<colinfo id="MANDT" size="256" summ="default" type="STRING"/>
					<colinfo id="ZPRDGBN" size="256" summ="default" type="STRING"/>
					<colinfo id="BRNDCD" size="256" summ="default" type="STRING"/>
					<colinfo id="ATKLA" size="256" summ="default" type="STRING"/>
					<colinfo id="PRH" size="256" summ="default" type="STRING"/>
					<colinfo id="PRHNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="GRPDESC" size="256" summ="default" type="STRING"/>
					<colinfo id="DATATYPE" size="256" summ="default" type="STRING"/>
					<colinfo id="FLAG" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_abrand">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<colinfo id="CHECK" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_zprdgnb">
				<Contents>
					<colinfo id="CODE" size="1" type="STRING"/>
					<colinfo id="CODE_NAME" size="1" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_sndsys">
				<Contents>
					<colinfo id="CODE" size="1" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="1" summ="default" type="STRING"/>
					<record>
						<CODE>PDM</CODE>
						<CODE_NAME>PDM</CODE_NAME>
					</record>
					<record>
						<CODE>PLM</CODE>
						<CODE_NAME>PLM</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_dataType">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME>-&#32;선택&#32;-</CODE_NAME>
					</record>
					<record>
						<CODE>Y</CODE>
						<CODE_NAME>적용</CODE_NAME>
					</record>
					<record>
						<CODE>N</CODE>
						<CODE_NAME>미적용</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_zprdgbn_group">
				<Contents>
					<colinfo id="ZPRDGBN" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE>NA</CODE>
						<CODE_NAME>-&#32;선택&#32;-</CODE_NAME>
						<ZPRDGBN></ZPRDGBN>
					</record>
					<record>
						<CODE>AP_BASIC</CODE>
						<CODE_NAME>BASIC</CODE_NAME>
						<ZPRDGBN>AP_01</ZPRDGBN>
					</record>
					<record>
						<CODE></CODE>
						<CODE_NAME>COMMON</CODE_NAME>
						<ZPRDGBN>DW_01</ZPRDGBN>
					</record>
					<record>
						<CODE></CODE>
						<CODE_NAME>COMMON</CODE_NAME>
						<ZPRDGBN>ELV_01</ZPRDGBN>
					</record>
					<record>
						<CODE>EL_BASIC</CODE>
						<CODE_NAME>BASIC</CODE_NAME>
						<ZPRDGBN>ELV_01</ZPRDGBN>
					</record>
					<record>
						<CODE>EL_INSIDE</CODE>
						<CODE_NAME>INSIDE</CODE_NAME>
						<ZPRDGBN>ELV_01</ZPRDGBN>
					</record>
					<record>
						<CODE>EL_LAYOUT</CODE>
						<CODE_NAME>LAYOUT</CODE_NAME>
						<ZPRDGBN>ELV_01</ZPRDGBN>
					</record>
					<record>
						<CODE>EL_OPTION</CODE>
						<CODE_NAME>OPTION</CODE_NAME>
						<ZPRDGBN>ELV_01</ZPRDGBN>
					</record>
					<record>
						<CODE>EL_OTHERS</CODE>
						<CODE_NAME>OTHERS</CODE_NAME>
						<ZPRDGBN>ELV_01</ZPRDGBN>
					</record>
					<record>
						<CODE>EL_OUTSIDE</CODE>
						<CODE_NAME>OUTSIDE</CODE_NAME>
						<ZPRDGBN>ELV_01</ZPRDGBN>
					</record>
					<record>
						<CODE>EL_BASIC</CODE>
						<CODE_NAME>BASIC</CODE_NAME>
						<ZPRDGBN>ELV_02</ZPRDGBN>
					</record>
					<record>
						<CODE>EL_INSIDE</CODE>
						<CODE_NAME>INSIDE</CODE_NAME>
						<ZPRDGBN>ELV_02</ZPRDGBN>
					</record>
					<record>
						<CODE>EL_LAYOUT</CODE>
						<CODE_NAME>LAYOUT</CODE_NAME>
						<ZPRDGBN>ELV_02</ZPRDGBN>
					</record>
					<record>
						<CODE>EL_OPTION</CODE>
						<CODE_NAME>OPTION</CODE_NAME>
						<ZPRDGBN>ELV_02</ZPRDGBN>
					</record>
					<record>
						<CODE>EL_OTHERS</CODE>
						<CODE_NAME>OTHERS</CODE_NAME>
						<ZPRDGBN>ELV_02</ZPRDGBN>
					</record>
					<record>
						<CODE>EL_OUTSIDE</CODE>
						<CODE_NAME>OUTSIDE</CODE_NAME>
						<ZPRDGBN>ELV_02</ZPRDGBN>
					</record>
					<record>
						<CODE></CODE>
						<CODE_NAME>COMMON</CODE_NAME>
						<ZPRDGBN>ESC_01</ZPRDGBN>
					</record>
					<record>
						<CODE>ES_BASIC</CODE>
						<CODE_NAME>BASIC</CODE_NAME>
						<ZPRDGBN>ESC_01</ZPRDGBN>
					</record>
					<record>
						<CODE>ES_EXTER</CODE>
						<CODE_NAME>EXTER</CODE_NAME>
						<ZPRDGBN>ESC_01</ZPRDGBN>
					</record>
					<record>
						<CODE>ES_OPTION</CODE>
						<CODE_NAME>OPTION</CODE_NAME>
						<ZPRDGBN>ESC_01</ZPRDGBN>
					</record>
					<record>
						<CODE>ES_SAFETY</CODE>
						<CODE_NAME>SAFETY</CODE_NAME>
						<ZPRDGBN>ESC_01</ZPRDGBN>
					</record>
					<record>
						<CODE></CODE>
						<CODE_NAME>COMMON</CODE_NAME>
						<ZPRDGBN>MW_01</ZPRDGBN>
					</record>
					<record>
						<CODE>MW_BASIC</CODE>
						<CODE_NAME>BASIC</CODE_NAME>
						<ZPRDGBN>MW_01</ZPRDGBN>
					</record>
					<record>
						<CODE>MW_EXTER</CODE>
						<CODE_NAME>EXTER</CODE_NAME>
						<ZPRDGBN>MW_01</ZPRDGBN>
					</record>
					<record>
						<CODE>MW_OPTION</CODE>
						<CODE_NAME>OPTION</CODE_NAME>
						<ZPRDGBN>MW_01</ZPRDGBN>
					</record>
					<record>
						<CODE>MW_SAFETY</CODE>
						<CODE_NAME>SAFETY</CODE_NAME>
						<ZPRDGBN>MW_01</ZPRDGBN>
					</record>
					<record>
						<CODE>PSD_BASIC</CODE>
						<CODE_NAME>BASIC</CODE_NAME>
						<ZPRDGBN>PSD_01</ZPRDGBN>
					</record>
					<record>
						<CODE>PSD_ELEC</CODE>
						<CODE_NAME>ELEC</CODE_NAME>
						<ZPRDGBN>PSD_01</ZPRDGBN>
					</record>
					<record>
						<CODE>PSD_SASH</CODE>
						<CODE_NAME>SASH</CODE_NAME>
						<ZPRDGBN>PSD_01</ZPRDGBN>
					</record>
					<record>
						<CODE>PSD_STEEL</CODE>
						<CODE_NAME>STEEL</CODE_NAME>
						<ZPRDGBN>PSD_01</ZPRDGBN>
					</record>
					<record>
						<CODE>EL_BASIC</CODE>
						<CODE_NAME>BASIC</CODE_NAME>
						<ZPRDGBN>SHN_01</ZPRDGBN>
					</record>
					<record>
						<CODE>EL_INSIDE</CODE>
						<CODE_NAME>INSIDE</CODE_NAME>
						<ZPRDGBN>SHN_01</ZPRDGBN>
					</record>
					<record>
						<CODE>EL_LAYOUT</CODE>
						<CODE_NAME>LAYOUT</CODE_NAME>
						<ZPRDGBN>SHN_01</ZPRDGBN>
					</record>
					<record>
						<CODE>EL_OPTION</CODE>
						<CODE_NAME>OPTION</CODE_NAME>
						<ZPRDGBN>SHN_01</ZPRDGBN>
					</record>
					<record>
						<CODE>EL_OUTSIDE</CODE>
						<CODE_NAME>OUTSIDE</CODE_NAME>
						<ZPRDGBN>SHN_01</ZPRDGBN>
					</record>
					<record>
						<CODE>ES_BASIC</CODE>
						<CODE_NAME>BASIC</CODE_NAME>
						<ZPRDGBN>SHN_02</ZPRDGBN>
					</record>
					<record>
						<CODE>ES_OPTION</CODE>
						<CODE_NAME>OPTION</CODE_NAME>
						<ZPRDGBN>SHN_02</ZPRDGBN>
					</record>
					<record>
						<CODE></CODE>
						<CODE_NAME>COMMON</CODE_NAME>
						<ZPRDGBN>SP_01</ZPRDGBN>
					</record>
					<record>
						<CODE></CODE>
						<CODE_NAME>COMMON</CODE_NAME>
						<ZPRDGBN>SV_01</ZPRDGBN>
					</record>
					<record>
						<CODE></CODE>
						<CODE_NAME>COMMON</CODE_NAME>
						<ZPRDGBN>WL_01</ZPRDGBN>
					</record>
				</Contents>
			</Dataset>
			<Dataset CanColumnChange="ds_sanyangPrd_CanColumnChange" DataSetType="Dataset" Id="ds_sanyangPrd" OnColumnChanged="ds_sanyangPrd_OnColumnChanged">
				<Contents>
					<colinfo id="MANDT" size="256" summ="default" type="STRING"/>
					<colinfo id="BRNDSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="ZPRDGBN" size="256" summ="default" type="STRING"/>
					<colinfo id="BRNDCD" size="256" summ="default" type="STRING"/>
					<colinfo id="PRH" size="256" summ="default" type="STRING"/>
					<colinfo id="MFLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="MSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="MDATATYPE" size="256" summ="default" type="STRING"/>
					<colinfo id="MDISPTP" size="256" summ="default" type="STRING"/>
					<colinfo id="MMODITP" size="256" summ="default" type="STRING"/>
					<colinfo id="MEGISSND" size="256" summ="default" type="STRING"/>
					<colinfo id="MDIPSDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="PRD" size="256" summ="default" type="STRING"/>
					<colinfo id="DFLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="DDATATYPE" size="256" summ="default" type="STRING"/>
					<colinfo id="DDISPTP" size="256" summ="default" type="STRING"/>
					<colinfo id="DDIPSDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="DSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="DCNT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_excel_sanyangPrd">
				<Contents>
					<colinfo id="MANDT" size="256" summ="default" type="STRING"/>
					<colinfo id="BRNDSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="ZPRDGBN" size="256" summ="default" type="STRING"/>
					<colinfo id="BRNDCD" size="256" summ="default" type="STRING"/>
					<colinfo id="PRH" size="256" summ="default" type="STRING"/>
					<colinfo id="MFLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="MSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="MDATATYPE" size="256" summ="default" type="STRING"/>
					<colinfo id="MDISPTP" size="256" summ="default" type="STRING"/>
					<colinfo id="MMODITP" size="256" summ="default" type="STRING"/>
					<colinfo id="MEGISSND" size="256" summ="default" type="STRING"/>
					<colinfo id="MDIPSDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="PRD" size="256" summ="default" type="STRING"/>
					<colinfo id="DFLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="DDATATYPE" size="256" summ="default" type="STRING"/>
					<colinfo id="DDISPTP" size="256" summ="default" type="STRING"/>
					<colinfo id="DDIPSDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="DSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="DCNT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
		</Datasets>
		<Grid AreaSelect="true" AutoEnter="TRUE" AutoFitEndLine="Hide" BindDataset="ds_excel_sanyangPrd" BkColor2="default" BoldHead="true" Border="Flat" Bottom="696" ColSizing="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="25" Height="96" Id="grd_excel_sanyangPrd" InputPanel="FALSE" Left="72" LineColor="user20" LineType="ExHORZ" Right="1144" RowHeight="20" Style="sty_grid" TabOrder="21" TabStop="true" Top="600" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="FALSE" VLineColor="default" WheelScrollRow="1" Width="1072">
			<contents>
				<format id="Default">
					<columns>
						<col width="62"/>
						<col width="80"/>
						<col width="32"/>
						<col width="42"/>
						<col width="99"/>
						<col width="75"/>
						<col width="96"/>
						<col width="88"/>
						<col width="79"/>
						<col width="40"/>
						<col width="51"/>
						<col width="126"/>
						<col width="83"/>
						<col width="90"/>
					</columns>
					<head>
						<cell align="center" col="0" display="text" rowspan="2" Valign="Center" wordwrap="word">
							<cell col="0" color="user21" display="text" font="굴림,9" text="브랜드" wordwrap="word"/>
							<cell col="0" color="user21" display="text" font="굴림,9" row="1" text="차수" wordwrap="word"/>
						</cell>
						<cell align="center" col="1" display="text" rowspan="2" Valign="Center" wordwrap="word">
							<cell col="0" color="user21" display="text" font="굴림,9" text="브랜드" wordwrap="word"/>
							<cell col="0" display="text" row="1"/>
						</cell>
						<cell col="2" colspan="7" display="text">
							<cell col="0" display="text"/>
							<cell align="center" col="7" color="user21" display="text" font="굴림,9" wordwrap="word"/>
							<cell align="center" col="6" color="user21" display="text" font="굴림,9" wordwrap="word"/>
							<cell align="center" col="5" color="user21" display="text" font="굴림,9" wordwrap="word"/>
							<cell align="center" col="4" color="user21" display="text" font="굴림,9" text="특성" wordwrap="word"/>
							<cell align="center" col="3" color="user21" display="text" font="굴림,9" wordwrap="word"/>
							<cell align="center" col="2" color="user21" display="text" font="굴림,9" wordwrap="word"/>
							<cell align="center" col="1" color="user21" display="text" font="굴림,9" wordwrap="word"/>
						</cell>
						<cell col="9" colspan="5" display="text">
							<cell col="0" display="text"/>
							<cell col="1" display="text"/>
							<cell col="2" display="text"/>
							<cell align="center" col="3" color="user21" display="text" font="굴림,9" text="특성값" wordwrap="word"/>
							<cell col="4" display="text"/>
						</cell>
						<cell col="2" color="user21" display="text" font="굴림,9" row="1" text="No"/>
						<cell col="3" color="user21" display="text" font="굴림,9" row="1" text="변경"/>
						<cell col="4" color="user21" display="text" font="굴림,9" row="1" text="특성"/>
						<cell col="5" color="user21" display="text" font="굴림,9" row="1" text="출력여부"/>
						<cell col="6" color="user21" display="text" font="굴림,9" row="1" text="수정여부"/>
						<cell col="7" color="user21" display="text" font="굴림,9" row="1" text="EGIS전송"/>
						<cell col="8" color="user21" display="text" font="굴림,9" row="1" text="폐기일"/>
						<cell col="9" color="user21" display="text" font="굴림,9" row="1" text="No"/>
						<cell col="10" color="user21" display="text" font="굴림,9" row="1" text="변경"/>
						<cell col="11" color="user21" display="text" font="굴림,9" row="1" text="특성값"/>
						<cell col="12" color="user21" display="text" font="굴림,9" row="1" text="출력여부"/>
						<cell col="13" color="user21" display="text" font="굴림,9" row="1" text="폐기일"/>
					</head>
					<body>
						<cell align="center" col="0" colid="BRNDSEQ" display="text" suppress="1"/>
						<cell align="center" col="1" colid="BRNDCD" display="text" suppress="1"/>
						<cell align="center" col="2" colid="MSEQ" display="text" suppress="1"/>
						<cell align="center" col="3" colid="MFLAG" display="text" edit="normal" suppress="1"/>
						<cell align="left" col="4" colid="PRH" display="text"/>
						<cell align="center" col="5" colid="MDISPTP" display="text"/>
						<cell align="center" col="6" colid="MMODITP" display="text"/>
						<cell align="center" col="7" colid="MEGISSND" display="text"/>
						<cell align="center" col="8" colid="MDIPSDAT" display="text" edit="normal" Mask="@@@@-@@-@@"/>
						<cell align="center" col="9" colid="DSEQ" display="text"/>
						<cell align="center" col="10" colid="DFLAG" display="text" edit="normal"/>
						<cell align="left" col="11" colid="PRD" display="text"/>
						<cell align="center" col="12" colid="DDISPTP" display="text"/>
						<cell align="center" col="13" colid="DDIPSDAT" display="text" edit="normal" Mask="@@@@-@@-@@"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Grid AreaSelect="true" AutoEnter="TRUE" AutoFitEndLine="Hide" BindDataset="ds_sanyangPrd" BkColor2="default" BoldHead="true" Border="Flat" Bottom="580" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="25" Height="516" Id="grd_sanyangPrd" InputPanel="FALSE" Left="912" LineColor="user20" LineType="ExHORZ" Right="1876" RowHeight="20" Style="sty_grid" TabOrder="12" TabStop="true" Top="64" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="964">
			<contents>
				<format id="Default">
					<columns>
						<col width="38"/>
						<col width="80"/>
						<col width="32"/>
						<col width="42"/>
						<col width="99"/>
						<col width="59"/>
						<col width="67"/>
						<col width="77"/>
						<col width="79"/>
						<col width="40"/>
						<col width="51"/>
						<col width="126"/>
						<col width="65"/>
						<col width="90"/>
					</columns>
					<head>
						<cell align="center" col="0" display="text" rowspan="2" Valign="Center">
							<cell col="0" color="user21" display="text" font="굴림,9" text="브랜드" wordwrap="word"/>
							<cell col="0" color="user21" display="text" font="굴림,9" row="1" text="차수" wordwrap="word"/>
						</cell>
						<cell align="center" col="1" display="text" rowspan="2" Valign="Center">
							<cell col="0" color="user21" display="text" font="굴림,9" text="브랜드" wordwrap="word"/>
							<cell col="0" display="text" row="1"/>
						</cell>
						<cell col="2" colspan="7" display="text">
							<cell col="0" display="text"/>
							<cell align="center" col="7" color="user21" display="text" font="굴림,9" wordwrap="word"/>
							<cell align="center" col="6" color="user21" display="text" font="굴림,9" wordwrap="word"/>
							<cell align="center" col="5" color="user21" display="text" font="굴림,9" wordwrap="word"/>
							<cell align="center" col="4" color="user21" display="text" font="굴림,9" text="특성" wordwrap="word"/>
							<cell align="center" col="3" color="user21" display="text" font="굴림,9" wordwrap="word"/>
							<cell align="center" col="2" color="user21" display="text" font="굴림,9" wordwrap="word"/>
							<cell align="center" col="1" color="user21" display="text" font="굴림,9" wordwrap="word"/>
						</cell>
						<cell col="9" colspan="5" display="text">
							<cell col="0" display="text"/>
							<cell col="1" display="text"/>
							<cell col="2" display="text"/>
							<cell align="center" col="3" color="user21" display="text" font="굴림,9" text="특성값" wordwrap="word"/>
							<cell col="4" display="text"/>
						</cell>
						<cell col="2" color="user21" display="text" font="굴림,9" row="1" text="No"/>
						<cell col="3" color="user21" display="text" font="굴림,9" row="1" text="변경"/>
						<cell col="4" color="user21" display="text" font="굴림,9" row="1" text="특성"/>
						<cell col="5" color="user21" display="text" font="굴림,9" row="1" text="출력여부"/>
						<cell col="6" color="user21" display="text" font="굴림,9" row="1" text="수정여부"/>
						<cell col="7" color="user21" display="text" font="굴림,9" row="1" text="EGIS전송"/>
						<cell col="8" color="user21" display="text" font="굴림,9" row="1" text="폐기일"/>
						<cell col="9" color="user21" display="text" font="굴림,9" row="1" text="No"/>
						<cell col="10" color="user21" display="text" font="굴림,9" row="1" text="변경"/>
						<cell col="11" color="user21" display="text" font="굴림,9" row="1" text="특성값"/>
						<cell col="12" color="user21" display="text" font="굴림,9" row="1" text="출력여부"/>
						<cell col="13" color="user21" display="text" font="굴림,9" row="1" text="폐기일"/>
					</head>
					<body>
						<cell align="center" col="0" colid="BRNDSEQ" display="text" suppress="1"/>
						<cell align="center" col="1" colid="BRNDCD" display="text" suppress="1"/>
						<cell align="center" col="2" colid="MSEQ" display="text" suppress="1"/>
						<cell align="center" bkimageid='expr:gfn_getFlagBkImageID(getColumn(currow,&#32;&quot;MFLAG&quot;))' col="3" display="text" suppress="1"/>
						<cell align="left" col="4" colid="PRH" display="text" suppress="1"/>
						<cell align="center" col="5" colid="MDISPTP" display="checkbox" edit="checkbox"/>
						<cell align="center" col="6" colid="MMODITP" display="checkbox" edit="checkbox"/>
						<cell align="center" col="7" colid="MEGISSND" display="checkbox" edit="checkbox"/>
						<cell align="center" col="8" colid="MDIPSDAT" display="text" edit="normal" Mask="@@@@-@@-@@"/>
						<cell align="center" col="9" colid="DSEQ" display="text"/>
						<cell align="center" bkimageid='expr:gfn_getFlagBkImageID(getColumn(currow,&#32;&quot;DFLAG&quot;))' col="10" display="text"/>
						<cell align="left" col="11" colid="PRD" display="text"/>
						<cell align="center" col="12" colid="DDISPTP" display="checkbox" edit="checkbox"/>
						<cell align="center" col="13" colid="DDIPSDAT" display="text" edit="normal" Mask="@@@@-@@-@@"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Shape BKColor="user0" Bottom="55" Height="52" Id="Shape1" Left="4" LineColor="user1" Right="1880" TabOrder="1" Top="3" Type="Rectangle" Width="1876"></Shape>
		<Static Align="Right" Height="24" Id="Static0" Left="6" Style="sty_lb_search" TabOrder="3" Text="브랜드차수&#32;" Top="4" VAlign="Middle" Width="62"></Static>
		<Edit Align="CENTER" BindDataset="ds_cond" Column="BRNDSEQ" Enable="FALSE" Height="23" Id="ed_brndseq" Left="72" MaxLength="10" Number="TRUE" Style="sty_btn" TabOrder="2" Text="000" Top="5" UpperOnly="TRUE" Width="32"></Edit>
		<Static Align="Right" Height="24" Id="Static1" Left="140" Style="sty_lb_search" TabOrder="4" Text="제품구분&#32;" Top="4" VAlign="Middle" Width="62"></Static>
		<Combo BindDataset="ds_cond" Border="Flat" BorderColor="user13" CodeColumn="CODE" Column="ZPRDGBN" DataColumn="CODE_NAME" Height="20" Id="cb_zprdgbn" InnerDataset="ds_zprdgnb" Left="206" OnChanged="cb_zprdgbn_OnChanged" Style="sty_ipt_search" TabOrder="5" Top="5" Width="120"></Combo>
		<Static Align="Right" Height="24" Id="Static2" Left="330" Style="sty_lb_search" TabOrder="6" Text="브랜드&#32;" Top="2" VAlign="Middle" Width="62"></Static>
		<Button Cursor="HAND" Height="18" Id="btn_brndcd" ImageID="btn_icon_search" Left="946" OnClick="fn_com042PupUp" TabOrder="7" Top="6" Transparent="TRUE" Width="18"></Button>
		<Button Cursor="HAND" Height="18" Id="btn_brndseq" ImageID="btn_icon_search" Left="106" OnClick="fn_com041PupUp" TabOrder="8" Top="8" Transparent="TRUE" Width="18"></Button>
		<Grid AutoEnter="TRUE" AutoFitEndLine="Hide" BindDataset="ds_sanyangPrh" BkColor2="default" BoldHead="true" Border="Flat" Bottom="580" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="516" Id="grd_sanyangPrh" InputPanel="FALSE" Left="6" LineColor="user20" LineType="ExHORZ" OnCellClick="grd_sanyangPrh_OnCellClick" OnExpandEdit="grd_sanyangPrh_OnExpandEdit" Right="910" RowHeight="20" Style="sty_grid" TabOrder="9" TabStop="true" Top="64" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="904">
			<contents>
				<format id="Default">
					<columns>
						<col width="30"/>
						<col width="352"/>
						<col width="80"/>
						<col width="93"/>
						<col width="234"/>
						<col width="96"/>
					</columns>
					<head>
						<cell col="0" display="text" rowspan="2">
							<cell align="center" col="0" color="user21" display="text" font="굴림,9" rowspan="2" text="No"/>
						</cell>
						<cell col="1" display="text" rowspan="2">
							<cell align="center" col="0" color="user21" display="text" font="굴림,9" rowspan="2" text="브랜드"/>
						</cell>
						<cell col="2" display="text" rowspan="2">
							<cell align="center" col="0" color="user21" display="text" font="굴림,9" rowspan="2" text="그룹코드"/>
						</cell>
						<cell col="3" display="text" rowspan="2">
							<cell align="center" col="0" color="user21" display="text" font="굴림,9" rowspan="2" text="특성"/>
						</cell>
						<cell col="4" display="text" rowspan="2">
							<cell align="center" col="0" color="user21" display="text" font="굴림,9" rowspan="2" text="특성한글명"/>
						</cell>
						<cell col="5" display="text" rowspan="2">
							<cell align="center" col="0" color="user21" display="text" font="굴림,9" rowspan="2" text="표출그룹명"/>
						</cell>
					</head>
					<body>
						<cell align="center" bkcolor2="user22" col="0" display="text" expr="currow+1"/>
						<cell align="left" col="1" colid="BRNDCD" display="text"/>
						<cell align="center" bkcolor2="user22" col="2" colid="ATKLA" display="text"/>
						<cell align="left" bkcolor2="user22" col="3" colid="PRH" display="text"/>
						<cell align="left" bkcolor2="user22" col="4" colid="PRHNAME" combocol="CODE" combodataset="ds_qtgbn" combotext="CODE_NAME" display="text"/>
						<cell align="left" col="5" colid="GRPDESC" display="text" expandshow="true"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_excel_upload" ImageID="btn_sub_06" Left="838" LeftMargin="12" OnClick="fn_com044PupUp" Style="sty_btn" TabOrder="10" Text="일괄&#32;등록" Top="32" Transparent="TRUE" Width="72"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_excel_download" ImageID="btn_sub_06" Left="757" LeftMargin="12" OnClick="fn_excel" Style="sty_btn" TabOrder="11" Text="양식다운로드" Top="32" Transparent="TRUE" Width="79"></Button>
		<Edit Border="Flat" BorderColor="user13" Height="20" Id="ed_brndcd" Left="397" Readonly="TRUE" Style="text_black" TabOrder="13" Top="5" Width="526"></Edit>
		<Button ButtonStyle="TRUE" Height="20" Id="Button0" Left="924" OnClick="fn_brndCdCombo" Style="text_black" TabOrder="14" Top="5" Width="20"></Button>
		<Static Align="Right" Height="24" Id="Static6" Left="375" Style="sty_lb_search" TabOrder="16" Text="특성한글명&#32;" Top="28" VAlign="Middle" Width="62"></Static>
		<Edit Border="Flat" CheckLength="Byte" Height="20" Id="ed_prhname" ImeMode="native" Left="440" LeftMargin="4" MaxLength="10" RightMargin="4" Style="sty_ipt_form" TabOrder="15" Top="31" Width="120"></Edit>
		<Static Align="Right" Height="24" Id="Static5" Left="4" Style="sty_lb_search" TabOrder="20" Text="특성&#32;자료구분" Top="60" VAlign="Middle" Width="0"></Static>
		<Static Align="Right" Height="24" Id="Static3" Left="6" Style="sty_lb_search" TabOrder="17" Text="그룹&#32;" Top="29" VAlign="Middle" Width="62"></Static>
		<Combo Border="Flat" BorderColor="user13" CodeColumn="CODE" DataColumn="CODE_NAME" Height="20" Id="cb_atkla" INDEX="0" InnerDataset="ds_zprdgbn_group" Left="71" Style="sty_ipt_search" TabOrder="19" Top="31" Width="109"></Combo>
		<Static Align="Right" Height="24" Id="Static4" Left="182" Style="sty_lb_search" TabOrder="18" Text="특성&#32;" Top="29" VAlign="Middle" Width="62"></Static>
		<Edit Border="Flat" CheckLength="Byte" Height="20" Id="ed_prh" ImeMode="native" Left="245" LeftMargin="4" MaxLength="10" RightMargin="4" Style="sty_ipt_form" TabOrder="22" Top="32" Width="120"></Edit>
		<Static Align="Right" Height="24" Id="Static7" Left="570" Style="sty_lb_search" TabOrder="24" Text="특성&#32;자료구분&#32;" Top="28" VAlign="Middle" Width="80"></Static>
		<Combo Border="Flat" BorderColor="user13" CodeColumn="CODE" DataColumn="CODE_NAME" Height="20" Id="cb_dataType" INDEX="0" InnerDataset="ds_dataType" Left="652" OnChanged="cb_dataType_OnChanged" Style="sty_ipt_search" TabOrder="23" Top="30" Width="73"></Combo>
		<Static Align="Right" Height="24" Id="Static9" Left="917" Style="sty_lb_search" TabOrder="25" Text="특성값&#32;" Top="29" VAlign="Middle" Width="80"></Static>
		<Edit Border="Flat" CheckLength="Byte" Height="20" Id="ed_prd" ImeMode="native" Left="999" LeftMargin="4" MaxLength="10" RightMargin="4" Style="sty_ipt_form" TabOrder="29" Top="31" Width="132"></Edit>
		<Static Align="Right" Height="24" Id="Static10" Left="1138" Style="sty_lb_search" TabOrder="27" Text="특성값&#32;폐기일&#32;" Top="28" VAlign="Middle" Width="80"></Static>
		<Calendar Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cd_ddipsdat" Left="1222" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="26" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="30" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="108"></Calendar>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_itemFind" ImageID="btn_sub_06" Left="1338" LeftMargin="12" OnClick="btn_itemFind_OnClick" Style="sty_btn" TabOrder="28" Text="찾기" Top="30" Transparent="TRUE" Width="44"></Button>
		<File Bottom="632" Height="24" Id="File0" Left="40" Right="64" TabOrder="29" Top="608" Width="24"></File>
		<FileDialog Bottom="632" FilePath="c:\" Filter="Excel&#32;통합문서&#32;(*.xlsx)|*.xlsx|Excel&#32;97-2003&#32;통합문서&#32;(*.xls)|*.xls|" Height="24" Id="fileDialog" Left="8" Right="32" TabOrder="30" Top="608" Type="Save" Width="24"></FileDialog>
	</Form>
	<Script><![CDATA[/*
 ******************************************************************************************
 * 기      능   : 브랜드 영업특성 등록
 * 작  성  자   : 박수근
 * 작성  일자   : 2020-09-07
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
#include "LIB::commons.js";
#include "LIB::nsfRequest.js";
#include "LIB::common_hdel.js";

//=========================================================================================
// [ PART 1 ]
// Form에서 사용될 전역변수를 선언
// FORM에서 사용되는 전역변수는 대문자로 작성하며, F_XXX 의 형태를 갖도록 한다. 
//=========================================================================================
var F_TITLE = "브랜드 영업특성 등록";
var F_BRNDSEQ = "000";
var F_BRNDCD  = "";
var F_GRPPRH = "";
var F_CURROW = -1;
var _F_FILE_DIR = "";	// 로컬에서 현재 선택한 파일 디렉토리 
var _F_FILE_NAME = "";	// 로컬에서 현재 선택한 파일  명 

//=========================================================================================
// [ PART 2 ]
// Form Loading / Unloading 시 작업 정의
//=========================================================================================
function fn_OnLoadCompleted(obj) {
    //gfn_initForm(false);
	fn_init_form();
	
    // 그리드 사이즈 조정
	fn_Sbi0090Resize();
}

/********************************************************************************
* 기      능   : form UnloadCompleted 
********************************************************************************/
function fn_OnUnloadCompleted(obj) {
	return gfn_isFormUnload(obj);
}

/********************************************************************************
* 기      능   : 폼 초기화
********************************************************************************/
function fn_init_form() {
    fn_initQuery();

    // 맥스브랜드 차수 설정
    ed_brndseq.Text = F_BRNDSEQ;

    // 제품구분에 전체 항목 추가 ds_zprdgnb
	ds_zprdgnb.InsertRow(0);
	ds_zprdgnb.SetColumn(0, "CODE", "");
	ds_zprdgnb.SetColumn(0, "CODE_NAME", "- 선택 -");
	cb_zprdgbn.Index = 0;

	// 제품제어 콤보 제어
	fn_CbZprdgbnCtl(ed_brndseq.Text);
	
    // 출력여부 5 MDISPTP
    // 수정여부 6 MMODITP
    // EGIS전송 7 MEGISSND
    // 폐기일 8 MDIPSDAT
    // DDISPTP 12 출력여부
    // DDIPSDAT 13 폐기일
	// 그리드 속성
	grd_sanyangPrd.SetCellProp("body", 5, "edit", "expr:iif(Length(MDISPTP)>0, 'checkbox', 'none')");
	grd_sanyangPrd.SetCellProp("body", 6, "edit", "expr:iif(Length(MMODITP)>0, 'checkbox', 'none')");
	grd_sanyangPrd.SetCellProp("body", 7, "edit", "expr:iif(Length(MEGISSND)>0, 'checkbox', 'none')");
	grd_sanyangPrd.SetCellProp("body", 8, "edit", "expr:iif(Length(MEGISSND)>0, 'normal', 'none')");
	grd_sanyangPrd.SetCellProp("body", 12, "edit", "expr:iif(Length(DDISPTP)>0, 'checkbox', 'none')");
	grd_sanyangPrd.SetCellProp("body", 13, "edit", "expr:iif(Length(PRD)>0, 'normal', 'none')");

	grd_sanyangPrd.SetCellProp("body", 5, "display", "expr:iif(Length(MDISPTP)>0, 'checkbox', 'none')");
	grd_sanyangPrd.SetCellProp("body", 6, "display", "expr:iif(Length(MMODITP)>0, 'checkbox', 'none')");
	grd_sanyangPrd.SetCellProp("body", 7, "display", "expr:iif(Length(MEGISSND)>0, 'checkbox', 'none')");
	grd_sanyangPrd.SetCellProp("body", 8, "display", "expr:iif(Length(MEGISSND)>0, 'normal', 'none')");
	grd_sanyangPrd.SetCellProp("body", 12, "display", "expr:iif(Length(DDISPTP)>0, 'checkbox', 'none')");
	grd_sanyangPrd.SetCellProp("body", 13, "display", "expr:iif(Length(PRD)>0, 'normal', 'none')");

}

/********************************************************************************
* 기      능   : 폼초기화 공통 정보 조회
********************************************************************************/
function fn_initQuery() {
    var svcId     = "fn_initQuery";
    var svcUrl    = "sbi0090c/initSbi0090";
    var inDsList  = "ds_abrand=ds_abrand ds_zprdgnb=ds_zprdgnb";
    var outDsList = "F_BRNDSEQ=F_BRNDSEQ ds_abrand=ds_abrand ds_zprdgnb=ds_zprdgnb ds_error=ds_error";
    var inParam   = "BRNDSEQ="+quote(ed_brndseq.Text);
    var callBackFunc = "fn_afterQuery";

    ds_error.ClearData();
    fn_createWait("",this);

    // 화면 초기 공통 정보는 http 동기화 호출
    http.sync = true;
	nsfRequest(svcId, svcUrl, inDsList, outDsList, inParam, callBackFunc);
	http.sync = false;
}

/********************************************************************************
* 기      능   : 브랜드차수별 브랜드 리스트 조회
********************************************************************************/
function fn_brndcdQuery() {
    var svcId     = "findAbrnd";
    var svcUrl    = "sbi0090c/findAbrnd";
    var inDsList  = "ds_abrand=ds_abrand";
    var outDsList = "ds_abrand=ds_abrand ds_error=ds_error";
    var inParam   = "BRNDSEQ="+quote(ed_brndseq.Text);
    var callBackFunc = "fn_afterQuery";

    ds_error.ClearData();
    fn_createWait("",this);

    // 화면 초기 공통 정보는 http 동기화 호출
    http.sync = true;
	nsfRequest(svcId, svcUrl, inDsList, outDsList, inParam, callBackFunc);
	http.sync = false;
}

/********************************************************************************
* 기      능   : 조회
********************************************************************************/
function fn_query() {
    var svcId  = "query";
    var svcUrl    = "sbi0090c/findZsdt1141List";
    var inParam   = "";
    var inDsList  = "ds_sanyangPrh=ds_sanyangPrh ds_cond=ds_cond";
    var outDsList = "ds_sanyangPrh=ds_sanyangPrh ds_error=ds_error";
    var callBackFunc = "fn_afterQuery";
    
    // 검색 입력값 체크
    if(Length(ed_brndseq.Text) == 0) {
        gfn_openMsgWin("브랜드차수를 입력하십시요", "", "A", "조회");
        return;
    }

    if(Length(cb_zprdgbn.Value) == 0) {
        gfn_openMsgWin("제품구분을 선택하십시요", "", "A", "조회");
        return;
    }

    if(Length(ed_brndcd.Text) == 0) {
        gfn_openMsgWin("브랜드를 선택하십시요", "", "A", "조회");
        return;
    }
    
    // 브랜드 코드 입력
    ds_cond.SetColumn(0, "BRNDCD", F_BRNDCD);
    ds_cond.SetColumn(0, "PRH", ed_prh.Text);
    ds_cond.SetColumn(0, "ATKLA", cb_atkla.Value);
    ds_cond.SetColumn(0, "PRHNAME", ed_prhname.Text);
    
    fn_createWait("",this);
    ds_sanyangPrh.ClearData();
    ds_error.ClearData();
    F_CURROW = -1;
    
	nsfRequest(svcId, svcUrl, inDsList, outDsList, inParam, callBackFunc);
}

/********************************************************************************
* 기      능   : 조회
********************************************************************************/
function fn_sayangQuery(selRow) {
    var svcId  = "sayangQuery";
    var svcUrl    = "sbi0090c/findZsdt1142List";
    var inDsList  = "ds_cond=ds_cond ds_sanyangPrd=ds_sanyangPrd";
    var outDsList = "ds_sanyangPrd=ds_sanyangPrd ds_error=ds_error";
    var inParam   = "";
    var callBackFunc = "fn_afterQuery";

    // 브랜드 코드 입력
    var brndcd = ds_sanyangPrh.GetColumn(selRow, "BRNDCD");
    var prh    = ds_sanyangPrh.GetColumn(selRow, "PRH");
    ds_cond.SetColumn(0, "BRNDCD", F_BRNDCD);
    ds_cond.SetColumn(0, "PRH", prh);
    if(F_CURROW == selRow) {
        return;
    }
    fn_createWait("",this);
    ds_sanyangPrd.ClearData();
    ds_error.ClearData();
    
	nsfRequest(svcId, svcUrl, inDsList, outDsList, inParam, callBackFunc);
}

/********************************************************************************
* 기      능   : 액셀  
********************************************************************************/
function fn_excel() {
    // 검색 입력값 체크
    if(Length(ed_brndseq.Text) == 0) {
        gfn_openMsgWin("브랜드차수를 입력하십시요", "", "A", "조회");
        return;
    }

    if(Length(cb_zprdgbn.Value) == 0) {
        gfn_openMsgWin("제품구분을 선택하십시요", "", "A", "조회");
        return;
    }

    if(Length(ed_brndcd.Text) == 0) {
        gfn_openMsgWin("브랜드를 선택하십시요", "", "A", "조회");
        return;
    }

    ds_cond.SetColumn(0, "BRNDCD", F_BRNDCD);
    ds_cond.SetColumn(0, "ATKLA", cb_atkla.Value);
    ds_cond.SetColumn(0, "PRH", ed_prh.Text);
    ds_cond.SetColumn(0, "PRHNAME", ed_prhname.Text);

    fn_createWait("",this);
    // 검색조건에 해당하는 데이터 조회 후 엑셀파일 생성처리를 수행한다.
    var svcId  = "excelSayangQuery";
    var svcUrl    = "sbi0090c/excelZsdt1142List";
    var inDsList  = "ds_cond=ds_cond ds_excel_sanyangPrd=ds_excel_sanyangPrd";
    var outDsList = "ds_excel_sanyangPrd=ds_excel_sanyangPrd ds_error=ds_error";
    var inParam   = "";
    var callBackFunc = "fn_afterQuery";

    ds_excel_sanyangPrd.ClearData();
    ds_error.ClearData();
	nsfRequest(svcId, svcUrl, inDsList, outDsList, inParam, callBackFunc);
}

/********************************************************************************
* 기      능   : 확인  
********************************************************************************/
function fn_confirm() {
    fn_createWait("",this);
}

/********************************************************************************
* 기      능   : 닫기  
********************************************************************************/
function fn_close() {
	this.close();
}

/********************************************************************************
* 기      능   : 저장
********************************************************************************/
function fn_save() {
	if (gfn_showConfirm("브랜드 특성/특성값을 저장하시겠습니까?") == false) {
	    return;
    }
    
    // 저장할 데이터를 생성한다.
	var mandt;
	var brndseq;
	var zprdgbn;
	var brndcd;
	var prh;
	var mflag;
	var mdisptp;
	var mmoditp;
	var megissnd;
	var mdipsdat;
	var prd;
	var dflag;
	var ddisptp;
	var ddipsdat;
	var mRow = -1;
	var dRow = -1;
	ds_zsdt1141.ClearData();
	ds_zsdt1142.ClearData();
    for(var i=0; i < ds_sanyangPrd.GetRowCount(); i++) {
		mandt    = ds_sanyangPrd.GetColumn(i, "MANDT");
		brndseq  = ds_sanyangPrd.GetColumn(i, "BRNDSEQ");
		zprdgbn  = ds_sanyangPrd.GetColumn(i, "ZPRDGBN");
		brndcd   = ds_sanyangPrd.GetColumn(i, "BRNDCD");
		prh      = ds_sanyangPrd.GetColumn(i, "PRH");
		mflag    = ds_sanyangPrd.GetColumn(i, "MFLAG");
		mdisptp  = ds_sanyangPrd.GetColumn(i, "MDISPTP");
		mmoditp  = ds_sanyangPrd.GetColumn(i, "MMODITP");
		megissnd = ds_sanyangPrd.GetColumn(i, "MEGISSND");
		mdipsdat = ds_sanyangPrd.GetColumn(i, "MDIPSDAT");
		prd      = ds_sanyangPrd.GetColumn(i, "PRD");
		dflag    = ds_sanyangPrd.GetColumn(i, "DFLAG");
		ddisptp  = ds_sanyangPrd.GetColumn(i, "DDISPTP");
		ddipsdat = ds_sanyangPrd.GetColumn(i, "DDIPSDAT");
		if(Length(prh) > 0 && (mflag == "I" || mflag == "U" || mflag == "D")) {
		    mRow  = ds_zsdt1141.AppendRow();
		    ds_zsdt1141.SetColumn(mRow, "FLAG", mflag);
			ds_zsdt1141.SetColumn(mRow, "MANDT"   , mandt);
			ds_zsdt1141.SetColumn(mRow, "BRNDSEQ" , brndseq);
			ds_zsdt1141.SetColumn(mRow, "ZPRDGBN" , zprdgbn);
			ds_zsdt1141.SetColumn(mRow, "BRNDCD"  , brndcd);
			ds_zsdt1141.SetColumn(mRow, "PRH"     , prh);
			if(mdisptp == '1') {
			    mdisptp = 'X';
			} else {
			    mdisptp = '';
			}
			ds_zsdt1141.SetColumn(mRow, "DISPTP"  , mdisptp);
			if(mmoditp == '1') {
			    mmoditp = 'X';
			} else {
			    mmoditp = '';
			}
			ds_zsdt1141.SetColumn(mRow, "MODITP"  , mmoditp);
			if(megissnd == '1') {
			    megissnd = 'X';
			} else {
			    megissnd = '';
			}
			ds_zsdt1141.SetColumn(mRow, "EGISSND" , megissnd);
			ds_zsdt1141.SetColumn(mRow, "DIPSDAT" , mdipsdat);
		}
		
		if(Length(prd) > 0 && (dflag == "I" || dflag == "U" || dflag == "D")) {
		    dRow = ds_zsdt1142.AppendRow();
		    ds_zsdt1142.SetColumn(dRow, "FLAG", dflag);
			ds_zsdt1142.SetColumn(dRow, "MANDT"   , mandt);
			ds_zsdt1142.SetColumn(dRow, "BRNDSEQ" , brndseq);
			ds_zsdt1142.SetColumn(dRow, "ZPRDGBN" , zprdgbn);
			ds_zsdt1142.SetColumn(dRow, "BRNDCD"  , brndcd);
			ds_zsdt1142.SetColumn(dRow, "PRH"     , prh);
			ds_zsdt1142.SetColumn(dRow, "PRD"     , prd);
			if(ddisptp == '1') {
			    ddisptp = 'X';
			} else {
			    ddisptp = '';
			}
			ds_zsdt1142.SetColumn(dRow, "DISPTP"  , ddisptp);
			ds_zsdt1142.SetColumn(dRow, "DIPSDAT" , ddipsdat);
		}
    }

    if(fn_save_validate()) {
		var svcId = "saveSayang";
		var svcUrl = "sbi0090c/saveSayang";
		var inDsList = "ds_zsdt1141=ds_zsdt1141 ds_zsdt1142=ds_zsdt1142";
		var outDsList = "ds_error=ds_error";
		var inParam  = "";
		var callBackFunc = "fn_afterSave";
		fn_createWait("",this);
		nsfRequest(svcId, svcUrl, inDsList, outDsList, inParam, callBackFunc);
    }
}

/********************************************************************************
* 기      능   : 저장 입력값 체크
********************************************************************************/
function fn_save_validate() {
    var isValidate = true;
    
    if (!ds_zsdt1141.GetUpdate() && !ds_zsdt1142.GetUpdate()) {
        gfn_openMsgWin("저장할 내역이 없습니다", "", "A", "저장");
		return false;
	}

    // 입력값 체크 메시지
    for(var i=0; i < ds_sanyangPrd.GetRowCount(); i++) {
        var mdipsdat = ds_sanyangPrd.GetColumn(i, "MDIPSDAT");
        var ddipsdat = ds_sanyangPrd.GetColumn(i, "DDIPSDAT");
		if(Length(mdipsdat) > 0) {
            if(GetDay(mdipsdat) < 0) {
                gfn_openMsgWin("입력된 특성 폐기일자를 확인하십시요", "", "A", "저장");
				ds_sanyangPrd.row = i;
				grd_sanyangPrd.SetCellPos(8);
				grd_sanyangPrd.ShowEditor(true);
				isValidate = false;
				break;
            }
		}

		if(Length(ddipsdat) > 0) {
            if(GetDay(ddipsdat) < 0) {
                gfn_openMsgWin("입력된 특성값 폐기일자를 확인하십시요", "", "A", "저장");
				ds_sanyangPrd.row = i;
				grd_sanyangPrd.SetCellPos(8);
				grd_sanyangPrd.ShowEditor(true);
				isValidate = false;
				break;
            }
		}
    }

    return isValidate;
}

//=========================================================================================
// [ PART 4]
// Callback 함수 정의 : callback 함수명은 메인 함수의 fn_xxxx() 에서 xxxx 부분은 fn_afterXXXX()
// 형태가 되도록 작성 
//=========================================================================================
/********************************************************************************
* 기      능   : fn_init_form Callback  
********************************************************************************/
function fn_afterInitForm(svcId, errCode, errMsg) {
    fn_destroyWait();
	if(ds_error.rowcount > 0)	{
        gfn_openMsgWin(ds_error.GetColumn(0,"ERRMSG"), "", "E", "저장");
		return;
	} 
}

/********************************************************************************
* 기      능   : 조회 Callback  
********************************************************************************/
function fn_afterQuery(svcId, errCode, errMsg) {
    fn_destroyWait();
	if(ds_error.rowcount > 0)	{
		gfn_showAlert(ds_error.GetColumn(0,"ERRMSG"));
		return;
	} else {
	    if(svcId == "query") {
	        // 필터조건 적용
	        fn_sanyangPrhFilter(cb_dataType.Value);
	        
			// 필터 적용 후 쿼리 수행
			fn_sayangQuery(ds_sanyangPrh.currow);
	    } else if(svcId == "sayangQuery") {
	        // 영업특성값 필터 입력값 초기화
	        F_CURROW = ds_sanyangPrh.currow;
	        fn_prdInputFilterInit();
	    } else if(svcId == 'excelSayangQuery') {
			// grd_excel_sanyangPrd
			//grd_excel_sanyangPrd.Redraw = true;

	        // 엑셀다운로드 데이터 조회 완료 후 처리
	        // 엑셀 다운로드 전 필터조건 적용
			var filString = "";
	        var filCond = "";
	        
			if(cb_dataType.Value != "") {
			    filString = "MDATATYPE=='"+cb_dataType.Value+"'";
			    filCond = " AND ";
			}
			ds_excel_sanyangPrd.Filter(filString);

			if (ds_excel_sanyangPrd.RowCount() > 0) {
				fn_excel_fileOpen();
			}
	    }
	}
}

/********************************************************************************
* 기      능   : 파일 폴더 팝업 호출
********************************************************************************/
function fn_excel_fileOpen()
{ 
    
	fileDialog.open();
	if ( length(fileDialog.FilePath) == 0 
		|| length( fileDialog.FileName ) == 0 ) {
		return;
	}

	_F_FILE_DIR =  fileDialog.FilePath;
	_F_FILE_NAME = fileDialog.FileName;
	grd_excel_sanyangPrd.SaveExcel(_F_FILE_DIR + "\\" + _F_FILE_NAME+".xls","sheet1","A1",false,true,false);
    alert("엑셀파일이 생성 되었습니다.");

//    fn_createWait("엑셀 파일 생성 중입니다.",this);
	//저장된 엑셀파일 재저장 로직호출
	//var intervalTime = 20000;
/*	
	var intervalTime = 1500;
	var degr = ds_excel_sanyangPrd.GetRowCount()/5000;
	intervalTime = intervalTime * degr;
	setTimer(888, intervalTime);
*/	
}

/********************************************************************************
* 기      능   : 엑셀파일 생성 처리
********************************************************************************/
function form_OnTimer(obj,nEventID)
{
	killTimer(888);
	//임시파일을 엑셀저장형식으로 재저장함.
	var rtn = ext_ExcelSaveAsEx(_F_FILE_DIR + "\\" + _F_FILE_NAME+".xls", _F_FILE_DIR + "\\" + _F_FILE_NAME+".xlsx", "2007", false);
	if(!rtn) {
		//임시파일 삭제
		File0.Delete(_F_FILE_DIR + "\\" + _F_FILE_NAME+".xls");
	    alert("엑셀파일이 정상적으로 생성 되었습니다.");
	}

    fn_destroyWait();
}

/********************************************************************************
* 기      능   : 저장 Callback  
********************************************************************************/
function fn_afterSave(svcId, errCode, errMsg) {
    fn_destroyWait();
	if(ds_error.rowcount > 0)	{
		gfn_showAlert(ds_error.GetColumn(0,"ERRMSG"));
		return;
	} else {
        gfn_openMsgWin("브랜드 영업특성/특성값이 저장되었습니다.", "", "A", "저장");
        // grd_sanyangPrh BRNDCD 값을 변경한다.
        var prh;
        var mflag;
        var mbrndcd;
        var mdisptp;
        var brndcds = "";
        for(var i=0; i < ds_sanyangPrd.GetRowCount(); i++) {
            prh     = ds_sanyangPrd.GetColumn(i, "PRH");
            mflag   = ds_sanyangPrd.GetColumn(i, "MFLAG");
            mbrndcd = ds_sanyangPrd.GetColumn(i, "BRNDCD");
            mdisptp  = ds_sanyangPrd.GetColumn(i, "MDISPTP");
       	    if(Length(prh) > 0 && mflag != "D" && Length(mdisptp) > 0) {
       	        brndcds = brndcds +", "+mbrndcd;
       	    }
        }
        brndcds = Substr(brndcds, 2);
        ds_sanyangPrh.SetColumn(ds_sanyangPrh.currow, "BRNDCD", brndcds);
        
        F_CURROW = -1;
        fn_sayangQuery(ds_sanyangPrh.currow);
	}
}

//=========================================================================================
// [ PART 5]
// 화면 UI 함수
//=========================================================================================
/********************************************************************************
* 기      능   : 자료구분 콤보 변경 이벤트
********************************************************************************/
function cb_dataType_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex) {
    fn_sanyangPrhFilter();
    
    if(ds_sanyangPrh.GetRowCount() > 0) {
        fn_sayangQuery(ds_sanyangPrh.currow);
    } else {
        ds_sanyangPrd.ClearData();
    }
}

/********************************************************************************
* 기      능   : 자료구분 필터저굥
* 설명: 검색조건별 특성 데이터 조회 후 자료구분 필터 적용
********************************************************************************/
function fn_sanyangPrhFilter() {
    var dataType = cb_dataType.Value;
    var filString;
    if(dataType == "") {
        filString = "DATATYPE=='Y' OR DATATYPE=='N'";
    } else {
        filString = "DATATYPE=="+quote(dataType);
    }
    ds_sanyangPrh.Filter(filString);
}

/********************************************************************************
* 기      능   : 제품구분 콤보 설정 제어
* 설명: 제품구분 콤보 설정 cb_zprdgbn "000" 인 경우에만 활성화 그렇지 않으면 ELV_01
********************************************************************************/
function fn_CbZprdgbnCtl(brndSeq) {
    var strFil;
    var findRow = 0;
    if(brndSeq == "000") {
        // 제품 콤보 활성화
        cb_zprdgbn.Enable= true;
        cb_zprdgbn.Index =0;

        // 000 차는 무조건 NOBRND
        // 멀티 브랜드 선택 활성화
        ed_brndcd.Enable = true;
        ed_brndcd.Text = "NOBRND";
        F_BRNDCD = "NOBRND";
        
        // 제품별 그룹 선택 필터링
        strFil = "ZPRDGBN==''||ZPRDGBN=="+quote(cb_zprdgbn.Value);
        ds_zprdgbn_group.Filter(strFil);
        
        Button0.Enable = false;
        
        
    } else {
        // 제품 콤보 비활성화
        // 제품구분은 기본 선택값 ELV_01
        cb_zprdgbn.Enable= false;
        findRow = ds_zprdgnb.FindRow("CODE", "ELV_01");
        cb_zprdgbn.Index = findRow;
 
        // 멀티 브랜드 선택 활성화
        ed_brndcd.Enable = true;

        // 제품별 그룹 선택 필터링
        strFil = "ZPRDGBN==''||ZPRDGBN=="+quote("ELV_01");
        ds_zprdgbn_group.Filter(strFil);
        
        ed_brndcd.Text = "";
        F_BRNDCD = "";

        Button0.Enable = true;
    }
}

/********************************************************************************
* 기      능   : 제품구분 변경 처리
* 제품구분 변경에 따른 ds_zprdgbn_group 필터 제어
********************************************************************************/
function cb_zprdgbn_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
    var strFil;
	strFil = "ZPRDGBN==''||ZPRDGBN=="+quote(cb_zprdgbn.Value);
	ds_zprdgbn_group.Filter(strFil);
}

/********************************************************************************
* 기      능   : 정렬 처리 
********************************************************************************/
function grd_header_OnHeadClick(obj,nCell,nX,nY,nPivotIndex) {
	if( nCell == 0 ) gfn_selectAllGrid(obj,nCell,nCell,true);
	else {
		gfn_sortGrid(obj, nCell);
	}
}

/********************************************************************************
* 기      능   : 브랜드차수 등록 팝업 호출
********************************************************************************/
function fn_com041PupUp(obj)
{
    var arg  = "";
	var brndArr;
	arg = "F_BRNDSEQ="+quote(ed_brndseq.Text);
	brndArr = gfn_openPopUpUrlHdel("SBI::Sbi0091.xml", true, arg);
	if(Length(brndArr) > 0) {
	    if(ed_brndseq.Text != brndArr) {
		    ed_brndseq.Text = brndArr;

			// 제품제어콤보 실행
			fn_CbZprdgbnCtl(ed_brndseq.Text);
			
			// 입력값 초기화
			cb_atkla.Index = 0;
			ed_prh.Text = "";
			ed_prhname.Text = "";
			
			// 필터값 초기화
			cb_dataType.Index = 0;
			
			// 디테일 필터값 초기화
		    fn_prdInputFilterInit();
		    
		    // 데이터 셑도 초기화한다.
		    ds_sanyangPrh.ClearData();
		    ds_sanyangPrd.ClearData();
		    
		    // 브랜드 코드 도 다시 조회한다.
		    fn_brndcdQuery();
	    }
	}
}

/********************************************************************************
* 기      능   : 브랜드 적용일자 등록 팝업
********************************************************************************/
function fn_com042PupUp(obj)
{
    var arg  = "";
	var brndArr;
	arg = "F_BRNDSEQ="+quote(ed_brndseq.Text);
	brndArr = gfn_openPopUpUrlHdel("SBI::Sbi0092.xml", true, arg);
}

/********************************************************************************
* 기      능   : 브랜드 소그룹 팝업
********************************************************************************/
function fn_com043PupUp()
{
    var arg  = "";
    var prh  = ds_sanyangPrh.GetColumn(ds_sanyangPrh.currow, "PRH");
    var grpdesc = ds_sanyangPrh.GetColumn(ds_sanyangPrh.currow, "GRPDESC");
    var prhname = ds_sanyangPrh.GetColumn(ds_sanyangPrh.currow, "PRHNAME");
	arg = "F_GRPPRH="+quote(prh)+" F_GRPDESC="+quote(grpdesc)+" F_PRHNAME="+quote(prhname);
	var brndArr = gfn_openPopUpUrlHdel("SBI::Sbi0093.xml", true, arg);
	if(Length(brndArr) > 0) {
	    if(brndArr == "#DELETE#") {
	        ds_sanyangPrh.SetColumn(ds_sanyangPrh.currow, "GRPDESC", "");
	    } else {
	        ds_sanyangPrh.SetColumn(ds_sanyangPrh.currow, "GRPDESC", brndArr);
	    }
	}
}

/********************************************************************************
* 기      능   : 브랜드 엑셀 업로드
********************************************************************************/
function fn_com044PupUp(obj)
{
    var arg  = "";
	arg = "F_BRNDSEQ="+quote(ed_brndseq.Text)+" F_ZPRDGBN="+quote(cb_zprdgbn.Value);
	var brndArr = gfn_openPopUpUrlHdel("SBI::Sbi0094.xml", true, arg);
}

/********************************************************************************
* 기      능   : 브랜드-기종 매핑 등록
********************************************************************************/
function fn_com045PupUp(obj)
{
    var arg  = "";
	var brndArr = gfn_openPopUpUrlHdel("SBI::Sbi0095.xml", true, arg);
}

/********************************************************************************
* 기      능   : 브랜드 특성코드 온클릭 이벤트 처리
********************************************************************************/
function grd_sanyangPrh_OnCellClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
	switch(nCell) {
	    default  :
	        // 특성값을 조회한다.
	        // 만약에 ds_sanyangPrd 변경데이터가 존재하는 경우 알림 메시지 출력
            if (!ds_sanyangPrd.GetUpdate()) {
                fn_sayangQuery(nRow);
	        } else {
				if (gfn_showConfirm("CW10025", "저장하지 않은 DATA는 손실됩니다. 변경된 데이터를 저장하시겠습니까?") == true) {
					fn_save();	    
				} else {
                    fn_sayangQuery(nRow);
				}
	        }
	        break;
	}
}

/********************************************************************************
* 기      능   : 브랜드 표출그룹명 클릭 처리
********************************************************************************/
function grd_sanyangPrh_OnExpandEdit(obj,nRow,nCell,strVal,nPivotIndex)
{
    if(nCell == 5) {
        // 소그룹 타이틀 팝업 호출
        fn_com043PupUp();
    }
}

/********************************************************************************
* 기      능   : 브랜드 선택콤보 생성
********************************************************************************/
function fn_brndCdCombo(obj)
{
	var ArrCode;
	var str_rtn = ngmf_SetPopupDivMultiCombo(ed_brndcd, ds_abrand, "CHECK", "CODE", "CODE_NAME", "CODE", ArrCode);
	ArrCode = str_rtn;		// Return 값 다시 Code 변수에 넘김
    // 코드값을 값고 있다.
	F_BRNDCD = ArrCode;
}

//-------------------------------------------------------------------------------------------------//
var ngmv_openChkCob = false;										// Create Object Check 용
var ngmv_objMultiCob;														// Multi Select Return Object
var ngmv_objMCobDS;															// Multi Select DataSet
var ngmv_Cobcheck, ngmv_CobCode, ngmv_CobText;			// DataSet Column(Display)

var ngmv_returnVal = "";
var ngmv_CheckFlag = "";

///////////////////////////////////////////////////////////////////////////////

/*===============================================================
= 기능 : Combo MultiSelect (공통)
= 인수 : obj				Rerurn Value 적용 Component ID
				 objDs			Multi Combo BindDataset
				 colchk 		PopupDiv Grid Check Column
				 colid			PopupDiv Grid Code Column
				 colnm			PopupDiv Grid Text Column
				 cdFlag			Check Flag
				 cdArg			Selected Code Value
				 fixCol			Fix Code Value
= 예제 : ngmf_SetPopupDivMultiCombo(objEdit, objDs, colchk, colid, colnm, cdFlag, cdArg, fixCol)
===============================================================*/
function ngmf_SetPopupDivMultiCombo(objEdit, objDs, colchk, colid, colnm, cdFlag, cdArg, fixCol){	
	ngmv_objMultiCob = objEdit;
	ngmv_objMCobDS = objDs;
	ngmv_Cobcheck = colchk;
	ngmv_CobCode = colid;
	ngmv_CobText = colnm;
	ngmv_CheckFlag = cdFlag;
	
	var div_w = objEdit.Width;
	var div_y = ClientToScreenY(objEdit, 0);
	var div_x = ClientToScreenX(objEdit, 0);
	
	var objDsCnt = ngmv_objMCobDs.RowCount();
	var objHeight = 186;
	var calHeight = 186;
	var calDiff =0;
	
	if (objDsCnt < 1) {
		calHeight = objHeight - 92;
	} else if (objDsCnt < 5) {
		calHeight = objHeight - ((5-objDsCnt) * 18);
	}
	
	cal_Diff = objHeight - calHeight;
	
	if (ngmv_openChkCob == false){
		Create("PopupDiv","PopDiv_MultiCombo",'width="100" height="' + calHeight + '" border="flat" borderColor="#C0D4E6" OnCloseUp="ngmf_PopDivCobCloseUp"');
		ngmv_openChkCob = true;
	}
	
	var chk_bln = false;
	for(i=0; i<ngmv_objMCobDS.ColCount(); i++){
		if (ngmv_objMCobDS.GetColID(i) == "checked_flag"){
			chk_bln = true;
			break;
		}
	}
	
	if (! chk_bln) {
		ngmv_objMCobDS.AddColumn("checked_flag");
	} else {
		for (i=0; i<ngmv_objMCobDS.RowCount(); i++){
			ngmv_objMCobDS.SetColumn(i,"checked_flag","");
		}
	}
	
	var str_arg;
	if (ToUpperCase(cdFlag) == "CODE" || ToUpperCase(cdFlag) == "FIX") str_arg = cdArg;
	else str_arg = ngmv_objMultiCob.Value;	
	
	ngmf_SetSelCobData(str_arg, fixCol);
	PopDiv_MultiCombo.Contents = ngmf_SetPopDivCob(div_w, cal_Diff);
	PopDiv_MultiCombo.TrackPopup(div_x, div_y, objEdit.Width,objEdit.Height);
	
	return ngmv_returnVal;
}

/*===============================================================
= 기능 : Combo Selected Column 체크 (공통)
= 인수 : argGet			Seleted Column Check
				 objDs			Fix Column
= 예제 : ngmf_SetSelCobData(argGet, fArg)
===============================================================*/
function ngmf_SetSelCobData(argGet, fArg){
	var arr_get = split(argGet,",");
	var arr_get1 = split(fArg,",");
	
	for (i=0; i<ngmv_objMCobDS.RowCount(); i++){
		ngmv_objMCobDS.SetColumn(i,ngmv_Cobcheck,"0");
	}
	
	if (length(arr_get) > 0 || length(arr_get1) > 0){
		for (i=0; i<length(arr_get); i++){
			for (j=0; j<ngmv_objMCobDS.RowCount(); j++){
				if (arr_get[i] == ngmv_objMCobDS.GetColumn(j, ngmv_CobCode)){
					ngmv_objMCobDS.SetColumn(j,ngmv_Cobcheck,"1");
					//if (toUpper(ngmv_CheckFlag) == "FIX") ngmv_objMCobDS.SetColumn(j,"checked_flag","C");
				}
				if (arr_get1[i] == ngmv_objMCobDS.GetColumn(j, ngmv_CobCode)){
					ngmv_objMCobDS.SetColumn(j,"checked_flag","C");
				}
			}
		}
	}
}

/*===============================================================
= 기능 : Multi Combo Drawing (공통)
= 인수 : div_width			Return Value Component의 Width
= 예제 : ngmf_SetPopDivCob(div_width)
===============================================================*/
function ngmf_SetPopDivCob(div_width, Diff_H){
	var str_temp;
	
	var grd_H = 182;									// Grid Height;
	var div_T = 184;									// Div(선택적용,선택해제) Top
	var Real_H = grd_H - Diff_H;		// Display Data의 RowCount에 따른 Grid Height 계산
	var Real_T = div_T - Diff_H;		// Display Data의 RowCount에 따른 Div Top 계산

	PopDiv_MultiCombo.Width = toNumber(div_width-2);
	PopDiv_MultiCombo.Height = Real_H + 26;  // // Real_H : Grid Height ::: 24 : Button 영역(여백포함) Height
	
	var btn_left = (toNumber(div_width-2)/2) - 68;
	
	var str_bk = 'expr:iif(checked_flag=="C","#f5f5f5","white")';
	var str_ed = 'expr:iif(checked_flag=="C","none","checkbox")';
	
	str_temp += '<Contents>';
	str_temp += '	<Grid AutoFit="TRUE" BindDataset="' + ngmv_objMCobDS.id + '" BkSelColor="#0a246a" BoldHead="true" Border="halfflat" Bottom="93" ColSelect="false" Editable="TRUE" Enable="true" EndLineColor="#919cb1" Height="' + Real_H + '" Id="grd_multi" InputPanel="FALSE" Left="2" MinWidth="100" Selcolor="white" TabOrder="1" TabStop="true" Top="1" UseSelColor="true" Visible="true" Width="' + toNumber(div_width-8) +'">';
	str_temp += '		<contents>';
	str_temp += '			<columns>';
	str_temp += '				<col fix="true" width="20"/>';
	str_temp += '				<col width="158"/>';
	str_temp += '			</columns>';
	str_temp += '			<body>';
	str_temp += '				<cell align="center" bkcolor=' + str_bk + ' col="0" colid="' + ngmv_Cobcheck + '" display="checkbox" edit=' + str_ed + '/>';
	str_temp += '				<cell col="1" bkcolor=' + str_bk + ' colid="' + ngmv_CobText + '" display="text"/>';
	str_temp += '			</body>';
	str_temp += '		</contents>';
	str_temp += '	</Grid>';
	str_temp += ' <Div Height="20" Id="Div_cob" Left="' + btn_left + '" Top="' + Real_T + '" Width="135">';
	str_temp += '   <contents>';
	str_temp += '		<button BKColor="#5379a0" ButtonStyle="TRUE" Color="white" Height="20" Id="btn_sel" ImageID="" Left="0" OnClick="ngmf_CobSelected" Style="btnStyle" TabOrder="2" Text="선택적용" Top="0" TopMargin="1" Width="64"></button>';
	str_temp += '		<button BKColor="#5379a0" ButtonStyle="TRUE" Color="white" Height="20" Id="btn_esc" ImageID="" Left="71" OnClick="ngmf_CobEscapeSel" Style="btnStyle" TabOrder="3" Text="선택해제" Top="0" TopMargin="1" Width="64"></button>';
	str_temp += '   </contents>';
	str_temp += ' </Div>';
	str_temp += '</Contents>';
	
	//alert(str_temp);
	return str_temp;
}

/*===============================================================
= 기능 : Multi Combo Close (공통)
===============================================================*/
function ngmf_CobSelected(){	
	ngmf_PopDivCobCloseUp();	
	PopDiv_MultiCombo.ClosePopup();
}

/*===============================================================
= 기능 : Multi Combo 선택 해제 (공통)
===============================================================*/
function ngmf_CobEscapeSel(){
	for (i=0; i<ngmv_objMCobDS.RowCount(); i++){
		if (ngmv_objMCobDS.GetColumn(i,"checked_flag") != "C")  ngmv_objMCobDS.SetColumn(i,ngmv_Cobcheck,"0");
	}
}

/*===============================================================
= 기능 : Multi Combo Close (공통)
===============================================================*/
function ngmf_PopDivCobCloseUp() {
	var str_cd = "";
	var str_txt = "";
		
	for (i=0; i<ngmv_objMCobDS.RowCount(); i++){
		if (ngmv_objMCobDS.getcolumn(i, ngmv_Cobcheck) == 1){
			str_cd += ngmv_objMCobDS.getcolumn(i,ngmv_CobCode) + ",";
			str_txt += ngmv_objMCobDS.getcolumn(i,ngmv_CobText) + ",";
		}
	}	
	
	if (toUpper(ngmv_CheckFlag) == "CODE" || toUpper(ngmv_CheckFlag) == "FIX") {
		ngmv_objMultiCob.value = left(str_txt,length(str_txt)-1);
		ngmv_returnVal = iif(length(str_cd) > 0, left(str_cd,length(str_cd)-1), "");	
	} else {
		ngmv_objMultiCob.value = left(str_cd,length(str_cd)-1);
	}
}

/*===============================================================
= 기능 : 사양특성 데이터 변경 시 처리 오동작 이벤트 방지
===============================================================*/
function ds_sanyangPrd_CanColumnChange(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{
	if(strColumnID == "MSEQ") {
	    return false;
	}
}

/*===============================================================
= 기능 : 사양특성 데이터 변경 시 처리
===============================================================*/
function ds_sanyangPrd_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{
	var MFLAG = ds_sanyangPrd.GetColumn(nRow, "MFLAG");
	var DFLAG = ds_sanyangPrd.GetColumn(nRow, "DFLAG");
	var isMUpdate = false;
	var isDUpdate = false;
	ds_sanyangPrd.OnColumnChanged = "";
    switch(strColumnID) {
	    case "MDISPTP":
	    case "MMODITP":
	    case "MEGISSND":
	    case "MDIPSDAT":
	        if(ds_sanyangPrd.GetColumn(nRow, "MDISPTP") != ds_sanyangPrd.GetOrgColumn(nRow, "MDISPTP"))
	            isMUpdate = true;
	        if(ds_sanyangPrd.GetColumn(nRow, "MMODITP") != ds_sanyangPrd.GetOrgColumn(nRow, "MMODITP"))
	            isMUpdate = true;
	        if(ds_sanyangPrd.GetColumn(nRow, "MEGISSND") != ds_sanyangPrd.GetOrgColumn(nRow, "MEGISSND"))
	            isMUpdate = true;
	        if(ds_sanyangPrd.GetColumn(nRow, "MDIPSDAT") != ds_sanyangPrd.GetOrgColumn(nRow, "MDIPSDAT"))
	            isMUpdate = true;

			if(isMUpdate) {
				if(MFLAG == "A") {
					ds_sanyangPrd.SetColumn(nRow, "MFLAG", "I");
				} else {
					if(ds_sanyangPrd.GetColumn(nRow, "MDISPTP") == '0' &&
					   ds_sanyangPrd.GetColumn(nRow, "MMODITP") == '0' &&
					   ds_sanyangPrd.GetColumn(nRow, "MEGISSND") == '0' &&
					   ds_sanyangPrd.GetColumn(nRow, "MDIPSDAT") == '') {
					   ds_sanyangPrd.SetColumn(nRow, "MFLAG", "D");
					   // 삭제 처리되어 하위 영업특성값도 무조건 상태값을 삭제 처리한다.
					   var brndcd = ds_sanyangPrd.GetColumn(nRow, "BRNDCD");
					   var prh    = ds_sanyangPrd.GetColumn(nRow, "PRH");
					   var flag;
					   for(var i=0; i < ds_sanyangPrd.GetRowCount(); i++) {
						   if(brndcd == ds_sanyangPrd.GetColumn(i, "BRNDCD") && prh == ds_sanyangPrd.GetColumn(i, "PRH")) {
							   flag = ds_sanyangPrd.GetColumn(i, "DFLAG");
							   if(flag == "I" || flag == "A") {
								   ds_sanyangPrd.SetColumn(i, "DDISPTP", ds_sanyangPrd.GetOrgColumn(i, "DDISPTP"));
								   ds_sanyangPrd.SetColumn(i, "DDIPSDAT", ds_sanyangPrd.GetOrgColumn(i, "DDIPSDAT"));
								   ds_sanyangPrd.SetColumn(i, "DFLAG", "A");
							   } else {
								   ds_sanyangPrd.SetColumn(i, "DDISPTP", "0");
								   ds_sanyangPrd.SetColumn(i, "DDIPSDAT", "");
								   ds_sanyangPrd.SetColumn(i, "DFLAG", "D");
							   }
						   }
					   }
					} else {
						if(MFLAG == "D") {
						   var brndcd = ds_sanyangPrd.GetColumn(nRow, "BRNDCD");
						   var prh    = ds_sanyangPrd.GetColumn(nRow, "PRH");
						   var flag;
						   for(var i=0; i < ds_sanyangPrd.GetRowCount(); i++) {
							   if(brndcd == ds_sanyangPrd.GetColumn(i, "BRNDCD") && prh == ds_sanyangPrd.GetColumn(i, "PRH")) {
								   flag = ds_sanyangPrd.GetColumn(i, "DFLAG");
								   if(flag != "A") {
									   ds_sanyangPrd.SetColumn(i, "DDISPTP", ds_sanyangPrd.GetOrgColumn(i, "DDISPTP"));
									   ds_sanyangPrd.SetColumn(i, "DDIPSDAT", ds_sanyangPrd.GetOrgColumn(i, "DDIPSDAT"));
									   ds_sanyangPrd.SetColumn(i, "DFLAG", "");
								   }
							   }
						   }
						} else if(MFLAG == "I") {
						} else {
						    ds_sanyangPrd.SetColumn(nRow, "MFLAG", "U");
						}
					}
				}
			} else {
				if(MFLAG == "I") {
					ds_sanyangPrd.SetColumn(nRow, "MFLAG", "A");
				} else {
					ds_sanyangPrd.SetColumn(nRow, "MFLAG", "");
				}
			}
	        break;
	    case "DDISPTP":
	    case "DDIPSDAT":
	        if(ds_sanyangPrd.GetColumn(nRow, "DDISPTP") != ds_sanyangPrd.GetOrgColumn(nRow, "DDISPTP"))
	            isDUpdate = true;
	        if(ds_sanyangPrd.GetColumn(nRow, "DDIPSDAT") != ds_sanyangPrd.GetOrgColumn(nRow, "DDIPSDAT"))
	            isDUpdate = true;

			if(isDUpdate) {
				if(DFLAG == "A") {
					ds_sanyangPrd.SetColumn(nRow, "DFLAG", "I");
				} else {
					if(ds_sanyangPrd.GetColumn(nRow, "DDISPTP") == '0' &&
					   ds_sanyangPrd.GetColumn(nRow, "DDIPSDAT") == '') {
					    if(DFLAG == "I") {
						    ds_sanyangPrd.SetColumn(nRow, "DFLAG", "A");
					    } else {
						    ds_sanyangPrd.SetColumn(nRow, "DFLAG", "D");
					    }
					} else {
					    if(DFLAG != "I") {
						    ds_sanyangPrd.SetColumn(nRow, "DFLAG", "U");
						}
					}
				}
			} else {
				if(DFLAG == "I") {
					ds_sanyangPrd.SetColumn(nRow, "DFLAG", "A");
				} else {
					ds_sanyangPrd.SetColumn(nRow, "DFLAG", "");
				}
			}
	        break;
	    default  :
	        break;
	}
	ds_sanyangPrd.OnColumnChanged = "ds_sanyangPrd_OnColumnChanged";
}

/********************************************************************************
* 기      능   : 영업특성값 필터 입력값 초기화 처리
* 설명: 특성값 조회 후 필터 입력값 초기화
********************************************************************************/
function fn_prdInputFilterInit() {
    //cb_d_dataType.Index = 0;
    ed_prd.Text = "";
    cd_ddipsdat.Value = "";
    fn_sanyangPrdFilter();
}

/********************************************************************************
* 기      능   :  영업특성값 자료구분 변경 이벤트
********************************************************************************/
function cb_d_dataType_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	fn_sanyangPrdFilter();
}

/********************************************************************************
* 기      능   : 영업특성값 필터 적용
* 설명: 영업특성값 필터를 적용한다.
********************************************************************************/
function btn_itemFind_OnClick(obj)
{
	fn_sanyangPrdFilter();
}

/********************************************************************************
* 기      능   :  영업특성값 필터
********************************************************************************/
function fn_sanyangPrdFilter() {
	//var dataType = cb_d_dataType.Value;
	var prd = ed_prd.Text;
	var dipsdat = cd_ddipsdat.Value;
	var filString = "";
	var filCond = "";
 
    /*
    if(dataType != "") {
        filString = "DSEQ == '1'  OR DDATATYPE=='"+dataType+"'";
        filCond = " AND ";
    }
    */

    if(prd != "") {
        filString = filString + filCond + "IndexOf(PRD, '"+prd+"') > -1 ";
        filCond = " AND ";
    } else {
        filCond = "";
    }

    if(dipsdat != "") {
        filString = filString + filCond + "DDIPSDAT <= '"+dipsdat+"'";
    }

    ds_sanyangPrd.Filter(filString);
}

/********************************************************************************
* 기      능   :  폼레이아웃 조정
********************************************************************************/
function fn_Sbi0090Resize() {
	// grd_sanyangPrd 사이즈 조정
	//if(window.height > 970) {
	// 978 with 이상인 경우 처리
    // 좌측 고정
    var gridHeight = window.height - 150;
    grd_sanyangPrh.Height = gridHeight;
    grd_sanyangPrd.Height = gridHeight;
}

/********************************************************************************
* 기      능   :  사이즈 변경 시 폼레이아웃 조정
********************************************************************************/
function Sbi0090_OnSize(obj,nCx,nCy,nState)
{
	fn_Sbi0090Resize();
}
]]></Script>
</Window>