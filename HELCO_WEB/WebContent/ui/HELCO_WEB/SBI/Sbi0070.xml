<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="562" Id="Ses0410" Left="8" OnLoadCompleted="fn_OnLoadCompleted" OnUnloadCompleted="fn_OnUnloadCompleted" PidAttrib="7" Title="대리점&#32;딜러&#32;입사일" Top="8" Ver="1.0" Width="978" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_error">
				<Contents>
					<colinfo id="IDX" size="256" type="STRING"/>
					<colinfo id="ERRMSG" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list">
				<Contents>
					<colinfo id="LIFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="NAME1" size="256" summ="default" type="STRING"/>
					<colinfo id="DEALER" size="256" summ="default" type="STRING"/>
					<colinfo id="DEALERNM" size="256" summ="default" type="STRING"/>
					<colinfo id="DEALERMAIL" size="256" summ="default" type="STRING"/>
					<colinfo id="MANAGER1" size="256" summ="default" type="STRING"/>
					<colinfo id="MANAGERNM1" size="256" summ="default" type="STRING"/>
					<colinfo id="MANAGERTELE1" size="256" summ="default" type="STRING"/>
					<colinfo id="MANAGER2" size="256" summ="default" type="STRING"/>
					<colinfo id="MANAGERNM2" size="256" summ="default" type="STRING"/>
					<colinfo id="MANAGERTELE2" size="256" summ="default" type="STRING"/>
					<colinfo id="MANAGER3" size="256" summ="default" type="STRING"/>
					<colinfo id="MANAGERNM3" size="256" summ="default" type="STRING"/>
					<colinfo id="MANAGERTELE3" size="256" summ="default" type="STRING"/>
					<colinfo id="ETC" size="256" summ="default" type="STRING"/>
					<colinfo id="changed" size="256" summ="default" type="STRING"/>
					<colinfo id="MANDT" size="256" summ="default" type="STRING"/>
					<colinfo id="SDFIELD" size="256" summ="default" type="STRING"/>
					<colinfo id="MANAGER" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond">
				<Contents>
					<colinfo id="MANDT" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="MANAGER" size="256" summ="default" type="STRING"/>
					<colinfo id="NAME1" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_save" OnColumnChanged="ds_list_OnColumnChanged">
				<Contents>
					<colinfo id="MANDT" size="256" summ="default" type="STRING"/>
					<colinfo id="DEALER" size="256" summ="default" type="STRING"/>
					<colinfo id="SDFIELD" size="256" summ="default" type="STRING"/>
					<colinfo id="MANAGER" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list_sman">
				<Contents>
					<colinfo id="SMAN_CD" size="256" type="STRING"/>
					<colinfo id="SMAN_NM" size="256" type="STRING"/>
					<colinfo id="SMAN_INFO" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond_sman">
				<Contents>
					<colinfo id="SMAN_CD" size="10" type="STRING"/>
					<colinfo id="SMAN_NM" size="105" type="STRING"/>
					<colinfo id="SMAN_FILTER" size="256" type="STRING"/>
					<record>
						<SMAN_CD></SMAN_CD>
						<SMAN_FILTER></SMAN_FILTER>
						<SMAN_NM></SMAN_NM>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_error_sman">
				<Contents>
					<colinfo id="IDX" size="256" type="STRING"/>
					<colinfo id="ERRMSG" size="256" type="STRING"/>
				</Contents>
			</Dataset>
		</Datasets>
		<Shape BKColor="user0" Bottom="27" Height="26" Id="Shape1" Left="8" LineColor="user1" Right="970" TabOrder="1" Top="1" Type="Rectangle" Width="962"></Shape>
		<Grid AutoEnter="TRUE" AutoFitEndLine="Hide" BindDataset="ds_list" BkColor2="default" BoldHead="true" Border="Flat" Bottom="558" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="529" Id="grd_list" InputPanel="FALSE" Left="8" LineColor="user20" LineType="ExHORZ" OnCellPosChanged="grd_list_OnCellPosChanged" OnExpandEdit="grd_list_OnExpandEdit" OnHeadClick="grd_List_OnHeadClick" OnKeyDown="grd_list_OnKeyDown" Right="970" RowHeight="20" Style="sty_grid" TabOrder="2" TabStop="true" Top="29" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="962">
			<contents>
				<format id="Default">
					<columns>
						<col fix="left" width="31"/>
						<col fix="left" width="31"/>
						<col fix="left" width="90"/>
						<col fix="left" width="130"/>
						<col width="77"/>
						<col width="65"/>
						<col width="150"/>
						<col width="80"/>
						<col width="80"/>
						<col width="100"/>
						<col width="80"/>
						<col width="80"/>
						<col width="100"/>
						<col width="80"/>
						<col width="80"/>
						<col width="100"/>
						<col width="120"/>
					</columns>
					<head>
						<cell align="center" col="0" color="user21" display="text" editfont="굴림,9" rowspan="3" text="변경"/>
						<cell align="center" col="1" color="user21" display="text" editfont="굴림,9" rowspan="3" text="No"/>
						<cell align="center" col="2" color="user21" display="text" editfont="굴림,9" rowspan="3" text="사업자번호"/>
						<cell align="center" col="3" color="user21" display="text" editfont="굴림,9" rowspan="3" text="대리점명"/>
						<cell align="center" col="4" color="user21" display="text" editfont="굴림,9" rowspan="3" text="사번"/>
						<cell align="center" col="5" color="user21" display="text" editfont="굴림,9" rowspan="3" text="딜러명"/>
						<cell align="center" col="6" color="user21" display="text" editfont="굴림,9" rowspan="3" text="E-MAIL"/>
						<cell col="7" color="user21" colspan="9" display="text" editfont="굴림,9" text="대리점&#32;관리"/>
						<cell col="7" color="user21" colspan="3" display="text" editfont="굴림,9" row="1" text="NI"/>
						<cell col="10" color="user21" colspan="3" display="text" editfont="굴림,9" row="1" text="리모델링"/>
						<cell col="13" color="user21" colspan="3" display="text" editfont="굴림,9" row="1" text="주차영업팀"/>
						<cell align="center" col="7" color="user21" display="text" editfont="굴림,9" row="2" text="사번"/>
						<cell align="center" col="8" color="user21" display="text" editfont="굴림,9" row="2" text="성명"/>
						<cell align="center" col="9" color="user21" display="text" editfont="굴림,9" row="2" text="전화번호"/>
						<cell align="center" col="10" color="user21" display="text" editfont="굴림,9" row="2" text="사번"/>
						<cell align="center" col="11" color="user21" display="text" editfont="굴림,9" row="2" text="성명"/>
						<cell align="center" col="12" color="user21" display="text" editfont="굴림,9" row="2" text="전화번호"/>
						<cell align="center" col="13" color="user21" display="text" editfont="굴림,9" row="2" text="사번"/>
						<cell align="center" col="14" color="user21" display="text" editfont="굴림,9" row="2" text="성명"/>
						<cell align="center" col="15" color="user21" display="text" editfont="굴림,9" row="2" text="전화번호"/>
						<cell align="center" col="16" color="user21" display="text" editfont="굴림,9" rowspan="3" text="비고"/>
					</head>
					<body>
						<cell align="center" bkcolor2="user22" bkimageid='expr:gfn_getFlagBkImageID(getColumn(currow,&#32;&quot;changed&quot;))' col="0" colid="changed" display="image" expr="currow+1"/>
						<cell align="center" bkcolor2="user22" col="1" display="text" expr="currow+1"/>
						<cell align="center" bkcolor2="user22" col="2" colid="LIFNR" combodisplayrowcnt="0" display="text"/>
						<cell align="left" bkcolor2="user22" col="3" colid="NAME1" combodisplayrowcnt="0" display="text" useime="false"/>
						<cell align="center" bkcolor2="user22" col="4" colid="DEALER" combodisplayrowcnt="0" display="normal" useime="false"/>
						<cell align="center" bkcolor2="user22" col="5" colid="DEALERNM" combodisplayrowcnt="0" display="normal"/>
						<cell align="left" bkcolor2="user22" col="6" colid="DEALERMAIL" combodisplayrowcnt="0" display="normal"/>
						<cell align="center" bkcolor2="user22" col="7" colid="MANAGER1" combodisplayrowcnt="0" display="normal" edit="normal"/>
						<cell align="center" bkcolor2="user22" col="8" colid="MANAGERNM1" combodisplayrowcnt="0" display="normal" edit="normal" expandshow="true"/>
						<cell align="left" bkcolor2="user22" col="9" colid="MANAGERTELE1" combodisplayrowcnt="0" display="normal"/>
						<cell align="center" bkcolor2="user22" col="10" colid="MANAGER2" combodisplayrowcnt="0" display="normal" edit="normal"/>
						<cell align="center" bkcolor2="user22" col="11" colid="MANAGERNM2" combodisplayrowcnt="0" display="normal" edit="normal" expandshow="true"/>
						<cell align="left" bkcolor2="user22" col="12" colid="MANAGERTELE2" combodisplayrowcnt="0" display="normal"/>
						<cell align="center" bkcolor2="user22" col="13" colid="MANAGER3" combodisplayrowcnt="0" display="normal" edit="normal"/>
						<cell align="center" bkcolor2="user22" col="14" colid="MANAGERNM3" combodisplayrowcnt="0" display="normal" edit="normal" expandshow="true"/>
						<cell align="left" bkcolor2="user22" col="15" colid="MANAGERTELE3" combodisplayrowcnt="0" display="normal"/>
						<cell align="center" bkcolor2="user22" col="16" colid="ETC" display="normal"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Static Align="Right" Height="24" Id="st_sman" Left="570" Style="sty_lb_search" TabOrder="3" Text="관리담당자&#32;" Top="2" VAlign="Middle" Width="85"></Static>
		<Edit Border="Flat" Height="20" Id="ed_sman_cd" Left="657" LeftMargin="4" OnChanged="ed_sman_cd_OnChanged" OnCharChanged="ed_sman_cd_OnCharChanged" OnFocus="fn_OnFocus" OnKillFocus="fn_OnKillFocus" RightMargin="4" Style="sty_ipt_form" TabOrder="4" Top="4" UpperOnly="TRUE" Width="80"></Edit>
		<Button Height="18" Id="btn_popSman" ImageID="btn_icon_search" Left="738" OnClick="fn_OnClick_popup" TabOrder="5" Text="Button0" Top="5" Transparent="TRUE" Width="18"></Button>
		<Edit Border="Flat" CheckLength="Byte" Enable="FALSE" Height="20" Id="ed_sman_nm" ImeMode="none" Left="757" LeftMargin="4" MaxLength="105" RightMargin="4" Style="sty_ipt_search" TabOrder="6" Top="4" Width="83"></Edit>
		<Static Align="Right" Height="24" Id="Static0" Left="8" Style="sty_lb_search" TabOrder="7" Text="사업자번호" Top="2" VAlign="Middle" Width="93"></Static>
		<Edit Border="Flat" Height="20" Id="ed_lifnr_cd" Left="105" LeftMargin="4" MaxLength="30" OnChar="ed_lifnr_OnChar" RightMargin="4" Style="sty_ipt_form" TabOrder="8" Top="4" UseIME="FALSE" Width="112"></Edit>
		<Static Align="Right" Height="24" Id="Static1" Left="285" Style="sty_lb_search" TabOrder="9" Text="대리점명" Top="2" VAlign="Middle" Width="93"></Static>
		<Edit Border="Flat" Height="20" Id="ed_lifnr_nm" Left="382" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="10" Top="4" UpperOnly="TRUE" Width="120"></Edit>
	</Form>
	<Script><![CDATA[/*
 ******************************************************************************************
 * 기      능   : 
 * 작  성  자   : 
 * 작성  일자   : 
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
#include "LIB::commons.js";	// 공통 스크립트 
#include "LIB::nsfRequest.js";	// 공통 스크립트 
#include "LIB::common_hdel.js";	// 공통 스크립트  /* GNY 추가 */
#include "LIB::common_sd.js";
//=========================================================================================
// [ PART 1 ]
// Form에서 사용될 전역변수를 선언
// FORM에서 사용되는 전역변수는 대문자로 작성하며, F_XXX 의 형태를 갖도록 한다. 
//=========================================================================================
var F_FRM_ID;
//=========================================================================================
// [ PART 2 ]
// Form Loading / Unloading 시 작업 정의
//=========================================================================================
function fn_OnLoadCompleted(obj) {
	// Form 로드 이벤트 맨 첫줄에 기술 
	gfn_initForm(true);

	fn_init_form(); 	// 폼 초기화
}

/********************************************************************************
* 기      능   : form UnloadCompleted 
********************************************************************************/
function fn_OnUnloadCompleted(obj) {
	return gfn_isFormUnload(obj);
}

/********************************************************************************
* 기      능   : 폼 초기화
********************************************************************************/
function fn_init_form() {

}

//=========================================================================================
// [ PART 3 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,form닫기)
//=========================================================================================
/********************************************************************************
* 기      능   : 조회 1
********************************************************************************/
var fn_query_chk = false; //중복조회 방지용 flag

function fn_query() {

	 //사업자번호체크 jss
	if(gfn_isSpecialStr(ed_lifnr_cd.Text)) {
		gfn_showAlert("CW00022", "사업자번호");
		ed_lifnr_cd.SetFocus();
		return;
	}
	ed_lifnr_cd.Text = replace(ed_lifnr_cd.Text, " ", "");


	if(!fn_query_chk) {
		fn_query_chk = true;
	} else {
		gfn_showAlert("CW10025", "조회중입니다..");
		return;
	}

	// 메시지바 클리어
	gfn_clearMsgBar(); 

	ds_error.ClearData();
	

	ds_cond.AddRow();
	ds_cond.SetColumn(0, 'MANDT', G_MANDT);	//클라이언트 번호 
	ds_cond.SetColumn(0, 'LIFNR', ed_lifnr_cd.Text);	//사업자번호(대리점)
	ds_cond.SetColumn(0, 'NAME1', ed_lifnr_nm.Text);	//사업자번호(대리점)
	ds_cond.SetColumn(0, 'MANAGER', ed_sman_cd.Text);	//관리자 사번

	ds_list.DeleteAll();
	
	fn_createWait("",this);     // 처리중입니다. 메시지 처리
	nsfRequest('query'
			   ,'sbi0070/find'
			   ,'ds_cond=ds_cond ds_list=ds_list'
			   ,'ds_list=ds_list ds_error=ds_error'
			   ,''
			   ,'fn_afterQuery'
			  );
}

function fn_afterQuery(svcId, errCode, errMsg) {

	fn_query_chk = false; //중복조회 방지용 flag
	fn_destroyWait();

	if(ds_error.rowcount() > 0) 	{
		gfn_showAlert("CE00001");
		return;
	}
	gfn_showMsg("CI00002", ds_list.RowCount() + "");
}

function fn_save() {

	ds_error.Clear();	
	if(ds_list.GetUpdate() == false) {
		 gfn_showAlert( "CW00005" );
		 return false;
    } 

	ds_list.Filter('changed=='+quote('U'));
	destroy('lds_list');
	create('dataset','lds_list');
	object('lds_list').copyF(ds_list);
	ds_list.UnFilter();
	nsfRequest('save'
			   ,'sbi0070/save'
			   ,'ds_list=lds_list ds_save=ds_save'
			   ,'ds_error=ds_error'
			   ,''
			   ,'fn_afterSave'
			  );

}

function fn_afterSave() {
	fn_query();
}

function fn_close() {
	close();
}

function fn_excel() {
	gfn_exportExcel(grd_list, "대리점 관리 담당자 현황");
}

/********************************************************************************
* 기      능   : 공통코드가 조회된 후의 Callback 함수 
********************************************************************************/
function fn_completeInit(sCode, sDsObj, sCodeType) {
	return;
}

//=========================================================================================
//[ PART 6 ]
//component Event 정의 : 각 Component 별 이벤트 
=========================================================================================
/********************************************************************************
* 기      능   : 그리드 헤더 클릭시 정렬 처리 
********************************************************************************/
function grd_list_OnHeadClick(obj,nCell,nX,nY,nPivotIndex) {
	if ( nCell == 0) {
		return;
	}
	// 그리드 정렬 처리 
	gfn_sortGrid(obj,nCell);
}

function grd_list_OnExpandEdit(obj,nRow,nCell,strVal,nPivotIndex)
{

// this.Alert(nCell+"::"+obj+"::"+strVal+"::"+nPivotIndex);
	// gfn_getColIdx -> 인덱스 구하는 함수
	if (nCell == gfn_getColIdx(grd_list, "MANAGERNM1")) // NI 관리자명
	{
		// 고객코드
		var arg = "fa_sman_cd= " 	+ quote(toUpper(ds_list.GetColumn(nRow, "MANAGER1"))) // 담당자코드
			+ " fa_sman_nm = " + quote(ds_list.GetColumn(nRow, "MANAGERNM1")); // 담당자명 
			 	
		var arr = gfn_openPopUpUrlHdel("Com::Com0030.xml", true, arg);	
		
		// 결과리턴
		if ( length( arr ) != 0 ) 
		{
			
			if (toUpper(substr(arr[0],0,1)) != "H"){
				this.Alert("NI 관리담당자를 입력하세요!");
				return;
			}	
//			if(ds_list.GetOrgColumn(nRow,"MANAGER1") != arr[0]) {
				ds_list.SetColumn( nRow, 'changed',	"U"); 	// 트랜잭션 상태
				ds_list.SetColumn( nRow, 'MANAGER1',	arr[0]); 	// 관라지 id
				ds_list.SetColumn( nRow, 'MANAGERNM1',	arr[1]); 	// NI관라지명 
				ds_list.SetColumn( nRow, 'MANAGERTELE1',arr[2]);	// 전화번호 
//			}
		}
	}	
	// gfn_getColIdx -> 인덱스 구하는 함수
	if (nCell == gfn_getColIdx(grd_list, "MANAGERNM2")) // NI 관리자명
	{
		// 고객코드
		var arg = "fa_sman_cd= " 	+ quote(toUpper(ds_list.GetColumn(nRow, "MANAGER2"))) // 담당자코드
			+ " fa_sman_nm = " + quote(ds_list.GetColumn(nRow, "MANAGERNM2")); // 담당자명 
			 	
		var arr = gfn_openPopUpUrlHdel("Com::Com0030.xml", true, arg);	
		
//		this.alert(arr[0] +"::"+arr[1]+"::"+arr[2]);
		// 결과리턴
		if ( length( arr ) != 0 ) 
		{
			if (toUpper(substr(arr[0],0,1)) != "H"){
				this.Alert("리모델링 관리담당자를 입력하세요!");
				return;
			}	
//			if(ds_list.GetOrgColumn(nRow,"MANAGER2") != arr[0]) {
				ds_list.SetColumn( nRow, 'changed',	"U"); 	// 트랜잭션 상태
				ds_list.SetColumn( nRow, 'MANAGER2',	arr[0]); 	// 관라지 id
				ds_list.SetColumn( nRow, 'MANAGERNM2',	arr[1]); 	// NI관라지명 
				ds_list.SetColumn( nRow, 'MANAGERTELE2',arr[2]);	// 전화번호 
//			}	
		}
	}	
	// gfn_getColIdx -> 인덱스 구하는 함수
	if (nCell == gfn_getColIdx(grd_list, "MANAGERNM3")) // NI 관리자명
	{
		// 고객코드
		var arg = "fa_sman_cd= " 	+ quote(toUpper(ds_list.GetColumn(nRow, "MANAGER3"))) // 담당자코드
			+ " fa_sman_nm = " + quote(ds_list.GetColumn(nRow, "MANAGERNM3")); // 담당자명 
			 	
		var arr = gfn_openPopUpUrlHdel("Com::Com0030.xml", true, arg);	
		
//		this.alert(arr[0] +"::"+arr[1]+"::"+arr[2]);
		// 결과리턴
		if ( length( arr ) != 0 ) 
		{
			if (toUpper(substr(arr[0],0,1)) != "H"){
				this.Alert("주차 관리담당자를 입력하세요!");
				return;
			}	
//			if(ds_list.GetOrgColumn(nRow,"MANAGER3") != arr[0]) {
				ds_list.SetColumn( nRow, 'changed',	"U"); 	// 트랜잭션 상태
				ds_list.SetColumn( nRow, 'MANAGER3',	arr[0]); 	// 관라지 id
				ds_list.SetColumn( nRow, 'MANAGERNM3',	arr[1]); 	// NI관라지명 
				ds_list.SetColumn( nRow, 'MANAGERTELE3',arr[2]);	// 전화번호 
//			}	
		}
	}
}

function grd_list_OnKeyDown(obj,nChar,bShift,bCtrl,bAlt,nLLParam,nHLParam)
{
	if (nChar == 13) {
	
		var nCol = obj.GetCellPos();
		var nRow =  ds_list.row;
	
		if(nCol == 7 || nCol == 8) {
			// 고객코드
			var fa_sman_cd= toUpper(ds_list.GetColumn(nRow, "MANAGER1")); // 담당자코드
			var	fa_sman_nm = ds_list.GetColumn(nRow, "MANAGERNM1"); // 담당자명

			ds_cond_sman.ClearData();
			ds_cond_sman.AddRow();
			ds_cond_sman.SetColumn(ds_cond_sman.row, "SMAN_CD", trim(fa_sman_cd));
			ds_cond_sman.SetColumn(ds_cond_sman.row, "SMAN_NM", trim(fa_sman_nm));			
			//	ds_cond_sman.SetColumn(ds_cond_sman.row, "SMAN_FILTER", F_SMAN_FILTER);

			// 자동 조회		
			if (length(fa_sman_cd) > 0){
				if (toUpper(substr(fa_sman_cd,0,1)) == "H") {
					fn_sman_query1(); // 임시주석처리				
				} else {
					this.Alert("NI 관리담당자를 입력하세요!");
					return;
				}
			}else if (length(fa_sman_nm) > 0){
				fn_sman_query1(); // 임시주석처리				
			}
		}
				 	
		if(nCol == 10 || nCol == 11) {
			var fa_sman_cd= toUpper(ds_list.GetColumn(nRow, "MANAGER2")); // 담당자코드
			var	fa_sman_nm = ds_list.GetColumn(nRow, "MANAGERNM2"); // 담당자명

			ds_cond_sman.ClearData();
			ds_cond_sman.AddRow();
			ds_cond_sman.SetColumn(ds_cond_sman.row, "SMAN_CD", trim(fa_sman_cd));
			ds_cond_sman.SetColumn(ds_cond_sman.row, "SMAN_NM", trim(fa_sman_nm));			
			//	ds_cond_sman.SetColumn(ds_cond_sman.row, "SMAN_FILTER", F_SMAN_FILTER);
					
			// 자동 조회		
			if (length(fa_sman_cd) > 0){
				if (toUpper(substr(fa_sman_cd,0,1)) == "H") {
					fn_sman_query2(); // 임시주석처리				
				} else {
					this.Alert("NI 관리담당자를 입력하세요!");
					return;
				}
			}else if (length(fa_sman_nm) > 0){
				fn_sman_query2(); // 임시주석처리				
			}
		} 	
		
		if(nCol == 13 || nCol == 14) {
			var fa_sman_cd= toUpper(ds_list.GetColumn(nRow, "MANAGER3")); // 담당자코드
			var	fa_sman_nm = ds_list.GetColumn(nRow, "MANAGERNM3"); // 담당자명

			ds_cond_sman.ClearData();
			ds_cond_sman.AddRow();
			ds_cond_sman.SetColumn(ds_cond_sman.row, "SMAN_CD", trim(fa_sman_cd));
			ds_cond_sman.SetColumn(ds_cond_sman.row, "SMAN_NM", trim(fa_sman_nm));			
			//	ds_cond_sman.SetColumn(ds_cond_sman.row, "SMAN_FILTER", F_SMAN_FILTER);
					
			// 자동 조회		
			if (length(fa_sman_cd) > 0){
				if (toUpper(substr(fa_sman_cd,0,1)) == "H") {
					fn_sman_query3(); // 임시주석처리				
				} else {
					this.Alert("NI 관리담당자를 입력하세요!");
					return;
				}
			}else if (length(fa_sman_nm) > 0){
				fn_sman_query3(); // 임시주석처리				
			}
		} 	
	} else {
		ds_cond_sman.SetColumn(ds_cond_sman.row, "SMAN_CD", "");
		ds_cond_sman.SetColumn(ds_cond_sman.row, "SMAN_NM", "");			
	}
}

/********************************************************************************
* 기      능   : 조회 (header 조회)
********************************************************************************/
function fn_sman_query1() { 
	
	ds_list_sman.ClearData();  	// 그리드 데이타 초기화	 
	// 서비스호출
	nsfRequest("query"									// srvId
				, "com0030/find"						// url
				, "ds_cond_sman=ds_cond_sman ds_list_sman=ds_list_sman"		// inDsList
				, "ds_list_sman=ds_list_sman ds_error_sman=ds_error_sman"	// outDsList
				, ""									// strParam
				, "fn_sMan_afterQuery1"						// CallBackFunc
				);
 
}

/********************************************************************************
* 기      능   : 조회 (header 조회)
********************************************************************************/
function fn_sman_query2() { 
	
	ds_list_sman.ClearData();  	// 그리드 데이타 초기화	 
	// 서비스호출
	nsfRequest("query"									// srvId
				, "com0030/find"						// url
				, "ds_cond_sman=ds_cond_sman ds_list_sman=ds_list_sman"		// inDsList
				, "ds_list_sman=ds_list_sman ds_error_sman=ds_error_sman"	// outDsList
				, ""									// strParam
				, "fn_sMan_afterQuery2"						// CallBackFunc
				);
 
}

/********************************************************************************
* 기      능   : 조회 (header 조회)
********************************************************************************/
function fn_sman_query3() { 
	
	ds_list_sman.ClearData();  	// 그리드 데이타 초기화	 
	// 서비스호출
	nsfRequest("query"									// srvId
				, "com0030/find"						// url
				, "ds_cond_sman=ds_cond_sman ds_list_sman=ds_list_sman"		// inDsList
				, "ds_list_sman=ds_list_sman ds_error_sman=ds_error_sman"	// outDsList
				, ""									// strParam
				, "fn_sMan_afterQuery3"						// CallBackFunc
				);
 
}
/********************************************************************************
* 기      능   : 조회 Callback  
********************************************************************************/
function fn_sMan_afterQuery1(errCode, errMsg) { 
	
	// 호출결과처리
	if(ds_error_sman.rowcount() > 0) {  
		trace("fn_Query FAILED!!! "
		       + "[idx : " 			+ ds_error_sman.GetColumn(0,"IDX") + "] "
		       + "[error message : "+ ds_error_sman.GetColumn(0,"ERRMSG") + "]"
		       );
		gfn_showMsg("CE00001");
		// error 정보 표시 
		gfn_openWSErrorWin(grd_list, ds_list_sman_m, ds_error_sman, "FLAG");
	} else {	
		// 조회된 자료가 있을 경우 1행에 포커스 위치시킨다.
		if (ds_list_sman.RowCount() == 1) {
			// 결과리턴
			if(ds_list.GetOrgColumn(ds_list.row,"MANAGER1") != ds_list_sman.GetColumn(0,"SMAN_CD")) {
				ds_list.SetColumn( ds_list.row, 'changed',	"U"); 	// 트랜잭션 상태
				ds_list.SetColumn( ds_list.row, 'MANAGER1',		ds_list_sman.GetColumn(0,"SMAN_CD")); 	// 관라지 id
				ds_list.SetColumn( ds_list.row, 'MANAGERNM1',	ds_list_sman.GetColumn(0,"SMAN_NM")); 	// NI관라지명 
				ds_list.SetColumn( ds_list.row, 'MANAGERTELE1',	ds_list_sman.GetColumn(0,"SMAN_INFO"));	// 전화번호 
			}

			grd_list.SetFocus();
			trace("fn_Query SUCCESS!!! [건수 : " + ds_list_sman.RowCount() + "]");
		}	
		if (ds_list_sman.RowCount() > 1) {
			grd_list_OnExpandEdit(ds_list,ds_list.row,8,ds_list_sman.GetColumn(0,"SMAN_NM"),-1);

		} else {
			trace("fn_Query SUCCESS!!! 건수없음");
			gfn_showMsg("CI00002", ds_list_sman.RowCount() + "");
		}
	}	
}
/********************************************************************************
* 기      능   : 조회 Callback  
********************************************************************************/
function fn_sMan_afterQuery2(errCode, errMsg) { 
	
	// 호출결과처리
	if(ds_error_sman.rowcount() > 0) {  
		trace("fn_Query FAILED!!! "
		       + "[idx : " 			+ ds_error_sman.GetColumn(0,"IDX") + "] "
		       + "[error message : "+ ds_error_sman.GetColumn(0,"ERRMSG") + "]"
		       );
		gfn_showMsg("CE00001");
		// error 정보 표시 
		gfn_openWSErrorWin(grd_list, ds_list_sman_m, ds_error_sman, "FLAG");
	} else {	
		// 조회된 자료가 있을 경우 1행에 포커스 위치시킨다.
		if (ds_list_sman.RowCount() == 1) {
			// 결과리턴
			if(ds_list.GetOrgColumn(ds_list.row,"MANAGER2") != ds_list_sman.GetColumn(0,"SMAN_CD")) {
				ds_list.SetColumn( ds_list.row, 'changed',	"U"); 	// 트랜잭션 상태
				ds_list.SetColumn( ds_list.row, 'MANAGER2',		ds_list_sman.GetColumn(0,"SMAN_CD")); 	// 관라지 id
				ds_list.SetColumn( ds_list.row, 'MANAGERNM2',	ds_list_sman.GetColumn(0,"SMAN_NM")); 	// NI관라지명 
				ds_list.SetColumn( ds_list.row, 'MANAGERTELE2',	ds_list_sman.GetColumn(0,"SMAN_INFO"));	// 전화번호 
			}

			grd_list.SetFocus();
			trace("fn_Query SUCCESS!!! [건수 : " + ds_list_sman.RowCount() + "]");
		}	
		if (ds_list_sman.RowCount() > 1) {
			grd_list_OnExpandEdit(ds_list,ds_list.row,8,ds_list_sman.GetColumn(0,"SMAN_NM"),-1);

		} else {
			trace("fn_Query SUCCESS!!! 건수없음");
			gfn_showMsg("CI00002", ds_list_sman.RowCount() + "");
		}
	}	
}
/********************************************************************************
* 기      능   : 조회 Callback  
********************************************************************************/
function fn_sMan_afterQuery3(errCode, errMsg) { 
	
	// 호출결과처리
	if(ds_error_sman.rowcount() > 0) {  
		trace("fn_Query FAILED!!! "
		       + "[idx : " 			+ ds_error_sman.GetColumn(0,"IDX") + "] "
		       + "[error message : "+ ds_error_sman.GetColumn(0,"ERRMSG") + "]"
		       );
		gfn_showMsg("CE00001");
		// error 정보 표시 
//		gfn_openWSErrorWin(grd_list, ds_list_sman_m, ds_error_sman, "FLAG");
	} else {	
		// 조회된 자료가 있을 경우 1행에 포커스 위치시킨다.
		if (ds_list_sman.RowCount() == 1) {
			// 결과리턴
			if(ds_list.GetOrgColumn(ds_list.row,"MANAGER3") != ds_list_sman.GetColumn(0,"SMAN_CD")) {
				ds_list.SetColumn( ds_list.row, 'changed',	"U"); 	// 트랜잭션 상태
				ds_list.SetColumn( ds_list.row, 'MANAGER3',		ds_list_sman.GetColumn(0,"SMAN_CD")); 	// 관라지 id
				ds_list.SetColumn( ds_list.row, 'MANAGERNM3',	ds_list_sman.GetColumn(0,"SMAN_NM")); 	// NI관라지명 
				ds_list.SetColumn( ds_list.row, 'MANAGERTELE3',	ds_list_sman.GetColumn(0,"SMAN_INFO"));	// 전화번호 
			}

			grd_list.SetFocus();
			trace("fn_Query SUCCESS!!! [건수 : " + ds_list_sman.RowCount() + "]");
		}	
		if (ds_list_sman.RowCount() > 1) {
			grd_list_OnExpandEdit(ds_list,ds_list.row,8,ds_list_sman.GetColumn(0,"SMAN_NM"),-1);

		} else {
			trace("fn_Query SUCCESS!!! 건수없음");
			gfn_showMsg("CI00002", ds_list_sman.RowCount() + "");
		}
	}	
}

function fn_OnClick_popup(obj)
{
	var arg = "fa_sman_cd= " 	+ quote(ed_sman_cd.text) // 담당자코드
			 + " fa_sman_nm = " + quote(ed_sman_nm.text); // 담당자명 
			 	
	var arr = gfn_openPopUpUrlHdel("Com::Com0030.xml", true, arg);	
	
	//trace("arr : " + arr);
	
	if (arr != null && arr != 0) {
		ed_sman_cd.text = arr[0];	// 리턴된 담당자코드로 검색조건 SET
		ed_sman_nm.text = arr[1];	// 리턴된 담당자명으로 검색조건 SET
		ed_sman_nm.SetFocus();
	} 
}
function ed_sman_cd_OnChanged(obj,strText)
{
	// 입력된 조건이 없으면
	if (length(trim(ed_sman_cd.text)) == 0 && length(trim(ed_sman_nm.text)) == 0) {
		//fn_OnClick_popup(btn_popSman);  // 팝업화면 호출
	} else {
		fn_query_sman();  				// 담당자조회 서비스 호출
	}	
}

function ed_sman_cd_OnCharChanged(obj,strPreText,strPostText)
{
	if (strPreText != strPostText)
		ed_sman_nm.Text = "";	
}

/********************************************************************************
* 기      능   :  담당자 조회   
********************************************************************************/
function fn_query_sman() { 

	gfn_clearMsgBar();   
	
//	trace(ds_cond_sman.SaveXML()); 	
	
	// 출력데이타셋 초기화
	ds_list_sman.ClearData();
	ds_cond_sman.ClearData();
	ds_cond_sman.AddRow();
	ds_cond_sman.SetColumn(ds_cond_sman.row, "SMAN_CD", trim(ed_sman_cd.text));
	ds_cond_sman.SetColumn(ds_cond_sman.row, "SMAN_NM", trim(ed_sman_nm.text));

	// 서비스호출
	nsfRequest("query"									// srvId
				, "com0030/find"						// url
				, "ds_cond_sman=ds_cond_sman ds_list_sman=ds_list_sman"		// inDsList
				, "ds_list_sman=ds_list_sman ds_error_sman=ds_error_sman"	// outDsList
				, ""									// strParam
				, "fn_afterQuery_sman");				// CallBackFunc
}


/********************************************************************************
* 기      능   :  담당자 조회 Callback  
********************************************************************************/ 
function fn_afterQuery_sman(errCode, errMsg) {
		//alert(" .... first search : "+ds_list_sman.SaveXML());
	if(ds_error_sman.rowcount() > 0) { 	// 호출결과처리
		//trace("fn_Query FAILED!!! "
		//       + "[idx : " 			+ ds_error.GetColumn(0,"IDX") + "] "
		//       + "[error message : "+ ds_error.GetColumn(0,"ERRMSG") + "]"
		//       );		       
	} else {
		//alert(" .... first search : "+ds_list_sman.SaveXML());
		if (ds_list_sman.RowCount() = 1) { // 한 건 조회된 경우
			// 조회해 온 값으로 담당자 검색정보 SET
			ed_sman_cd.Text = ds_list_sman.GetColumn(ds_list_sman.row, "SMAN_CD");
			ed_sman_nm.Text = ds_list_sman.GetColumn(ds_list_sman.row, "SMAN_NM");
		} 
		else if (ds_list_sman.RowCount() > 1) { // 다 건 조회된 경우	
			fn_OnClick_popup(btn_popSman); // 담당자조회 팝업화면  호출
		}
	}
}

var L_OLD_ROW = 0;
function grd_list_OnCellPosChanged(obj,nRow,nCell,nOldRow,nOldCell,nPivotIndex,nOldPivotIndex)
{
	if(nRow == nOldRow) {
		if(nCell == 7 || nCell == 8) {
			var fa_sman_cd= toUpper(ds_list.GetColumn(nRow, "MANAGER1")); // 담당자코드
			var fa_sman_nm = ds_list.GetColumn(nRow, "MANAGERNM1"); // 담당자명
			
			// 입력된 조건이 없으면
			if (length(trim(fa_sman_cd)) == 0 && length(trim(fa_sman_nm)) == 0) {
				//fn_OnClick_popup(btn_popSman);  // 팝업화면 호출
			} else {
				ds_cond_sman.ClearData();
				ds_cond_sman.AddRow();
				ds_cond_sman.SetColumn(ds_cond_sman.row, "SMAN_CD", trim(fa_sman_cd));
				ds_cond_sman.SetColumn(ds_cond_sman.row, "SMAN_NM", trim(fa_sman_nm));			
				if (length(fa_sman_cd) > 0){
					if (toUpper(substr(fa_sman_cd,0,1)) == "H") {
						L_OLD_ROW = nRow;
						fn_sman_query11(); // 임시주석처리				
					} else {
						this.Alert("NI 관리담당자를 입력하세요!");
						return;
					}
				}else if (length(fa_sman_nm) > 0){
						L_OLD_ROW = nRow;
					   fn_sman_query11(); // 임시주석처리				
				}
			}
		}
		if(nCell == 10 || nCell == 11) {
			var fa_sman_cd= toUpper(ds_list.GetColumn(nRow, "MANAGER2")); // 담당자코드
			var fa_sman_nm = ds_list.GetColumn(nRow, "MANAGERNM2"); // 담당자명
			
			// 입력된 조건이 없으면
			if (length(trim(fa_sman_cd)) == 0 && length(trim(fa_sman_nm)) == 0) {
				//fn_OnClick_popup(btn_popSman);  // 팝업화면 호출
			} else {
				ds_cond_sman.ClearData();
				ds_cond_sman.AddRow();
				ds_cond_sman.SetColumn(ds_cond_sman.row, "SMAN_CD", trim(fa_sman_cd));
				ds_cond_sman.SetColumn(ds_cond_sman.row, "SMAN_NM", trim(fa_sman_nm));			
				if (length(fa_sman_cd) > 0){
					if (toUpper(substr(fa_sman_cd,0,1)) == "H") {
						L_OLD_ROW = nRow;
						fn_sman_query22(); // 임시주석처리				
					} else {
						this.Alert("NI 관리담당자를 입력하세요!");
						return;
					}
				}else if (length(fa_sman_nm) > 0){
						L_OLD_ROW = nRow;
					   fn_sman_query22(); // 임시주석처리				
				}
			}
		}
		if(nCell == 13 || nCell == 14) {
			var fa_sman_cd= toUpper(ds_list.GetColumn(nRow, "MANAGER3")); // 담당자코드
			var fa_sman_nm = ds_list.GetColumn(nRow, "MANAGERNM3"); // 담당자명
			
			// 입력된 조건이 없으면
			if (length(trim(fa_sman_cd)) == 0 && length(trim(fa_sman_nm)) == 0) {
				//fn_OnClick_popup(btn_popSman);  // 팝업화면 호출
			} else {
				ds_cond_sman.ClearData();
				ds_cond_sman.AddRow();
				ds_cond_sman.SetColumn(ds_cond_sman.row, "SMAN_CD", trim(fa_sman_cd));
				ds_cond_sman.SetColumn(ds_cond_sman.row, "SMAN_NM", trim(fa_sman_nm));			
				if (length(fa_sman_cd) > 0){
					if (toUpper(substr(fa_sman_cd,0,1)) == "H") {
						L_OLD_ROW = nRow;
						fn_sman_query33(); // 임시주석처리				
					} else {
						this.Alert("NI 관리담당자를 입력하세요!");
						return;
					}
				}else if (length(fa_sman_nm) > 0){
						L_OLD_ROW = nRow;
					   fn_sman_query33(); // 임시주석처리				
				}
			}
		}
	} else {
		if(nOldCell == 7 || nOldCell == 8) {
			var fa_sman_cd= toUpper(ds_list.GetColumn(nOldRow, "MANAGER1")); // 담당자코드
			var	fa_sman_nm = ds_list.GetColumn(nOldRow, "MANAGERNM1"); // 담당자명
			
			// 입력된 조건이 없으면
			if (length(trim(fa_sman_cd)) == 0 && length(trim(fa_sman_nm)) == 0) {
				//fn_OnClick_popup(btn_popSman);  // 팝업화면 호출
			} else {
				ds_cond_sman.ClearData();
				ds_cond_sman.AddRow();
				ds_cond_sman.SetColumn(ds_cond_sman.row, "SMAN_CD", trim(fa_sman_cd));
				ds_cond_sman.SetColumn(ds_cond_sman.row, "SMAN_NM", trim(fa_sman_nm));			
				if (length(fa_sman_cd) > 0){
					if (toUpper(substr(fa_sman_cd,0,1)) == "H") {
						L_OLD_ROW = nOldRow;
						fn_sman_query11(); // 임시주석처리				
					} else {
						this.Alert("NI 관리담당자를 입력하세요!");
						return;
					}
				}else if (length(fa_sman_nm) > 0){
						L_OLD_ROW = nOldRow;
					   fn_sman_query11(); // 임시주석처리				
				}
			}
		}
		if(nOldCell == 10 || nOldCell == 11) {
			var fa_sman_cd= toUpper(ds_list.GetColumn(nOldRow, "MANAGER2")); // 담당자코드
			var	fa_sman_nm = ds_list.GetColumn(nOldRow, "MANAGERNM2"); // 담당자명
			
			// 입력된 조건이 없으면
			if (length(trim(fa_sman_cd)) == 0 && length(trim(fa_sman_nm)) == 0) {
				//fn_OnClick_popup(btn_popSman);  // 팝업화면 호출
			} else {
				ds_cond_sman.ClearData();
				ds_cond_sman.AddRow();
				ds_cond_sman.SetColumn(ds_cond_sman.row, "SMAN_CD", trim(fa_sman_cd));
				ds_cond_sman.SetColumn(ds_cond_sman.row, "SMAN_NM", trim(fa_sman_nm));			
				if (length(fa_sman_cd) > 0){
					if (toUpper(substr(fa_sman_cd,0,1)) == "H") {
						L_OLD_ROW = nOldRow;
						fn_sman_query22(); // 임시주석처리				
					} else {
						this.Alert("NI 관리담당자를 입력하세요!");
						return;
					}
				}else if (length(fa_sman_nm) > 0){
						L_OLD_ROW = nOldRow;
					   fn_sman_query22(); // 임시주석처리				
				}
			}
		}
		if(nOldCell == 13 || nOldCell == 14) {
			var fa_sman_cd= toUpper(ds_list.GetColumn(nOldRow, "MANAGER3")); // 담당자코드
			var	fa_sman_nm = ds_list.GetColumn(nOldRow, "MANAGERNM3"); // 담당자명
			
			// 입력된 조건이 없으면
			if (length(trim(fa_sman_cd)) == 0 && length(trim(fa_sman_nm)) == 0) {
				//fn_OnClick_popup(btn_popSman);  // 팝업화면 호출
			} else {
				ds_cond_sman.ClearData();
				ds_cond_sman.AddRow();
				ds_cond_sman.SetColumn(ds_cond_sman.row, "SMAN_CD", trim(fa_sman_cd));
				ds_cond_sman.SetColumn(ds_cond_sman.row, "SMAN_NM", trim(fa_sman_nm));			
				if (length(fa_sman_cd) > 0){
					if (toUpper(substr(fa_sman_cd,0,1)) == "H") {
						L_OLD_ROW = nOldRow;
						fn_sman_query33(); // 임시주석처리				
					} else {
						this.Alert("NI 관리담당자를 입력하세요!");
						return;
					}
				}else if (length(fa_sman_nm) > 0){
						L_OLD_ROW = nOldRow;
					   fn_sman_query33(); // 임시주석처리				
				}
			}
		}
	}
}

function fn_sman_query11() { 
	
	ds_list_sman.ClearData();  	// 그리드 데이타 초기화	 
	// 서비스호출
	nsfRequest("query"									// srvId
				, "com0030/find"						// url
				, "ds_cond_sman=ds_cond_sman ds_list_sman=ds_list_sman"		// inDsList
				, "ds_list_sman=ds_list_sman ds_error_sman=ds_error_sman"	// outDsList
				, ""									// strParam
				, "fn_sMan_afterQuery11"						// CallBackFunc
				);
}

function fn_sMan_afterQuery11(errCode, errMsg) { 
	
	// 호출결과처리
	if(ds_error_sman.rowcount() > 0) {  
		trace("fn_Query FAILED!!! "
		       + "[idx : " 			+ ds_error_sman.GetColumn(0,"IDX") + "] "
		       + "[error message : "+ ds_error_sman.GetColumn(0,"ERRMSG") + "]"
		       );
		gfn_showMsg("CE00001");
		// error 정보 표시 
		gfn_openWSErrorWin(grd_list, ds_list_sman_m, ds_error_sman, "FLAG");
	} else {	
		// 조회된 자료가 있을 경우 1행에 포커스 위치시킨다.
		if (ds_list_sman.RowCount() == 1) {
			// 결과리턴
			if(ds_list.GetOrgColumn(L_OLD_ROW,"MANAGER1") != ds_list_sman.GetColumn(0,"SMAN_CD")) {
				ds_list.SetColumn( L_OLD_ROW, 'changed',	"U"); 	// 트랜잭션 상태
				ds_list.SetColumn( L_OLD_ROW, 'MANAGER1',		ds_list_sman.GetColumn(0,"SMAN_CD")); 	// 관라지 id
				ds_list.SetColumn( L_OLD_ROW, 'MANAGERNM1',	ds_list_sman.GetColumn(0,"SMAN_NM")); 	// NI관라지명 
				ds_list.SetColumn( L_OLD_ROW, 'MANAGERTELE1',	ds_list_sman.GetColumn(0,"SMAN_INFO"));	// 전화번호 
			}

			grd_list.SetFocus();
			trace("fn_Query SUCCESS!!! [건수 : " + ds_list_sman.RowCount() + "]");
		}	
		if (ds_list_sman.RowCount() > 1) {
			grd_list_OnExpandEdit(ds_list,L_OLD_ROW,8,ds_list_sman.GetColumn(0,"SMAN_NM"),-1);

		} else {
			trace("fn_Query SUCCESS!!! 건수없음");
			gfn_showMsg("CI00002", ds_list_sman.RowCount() + "");
		}
	}
}
function fn_sman_query22() { 
	
	ds_list_sman.ClearData();  	// 그리드 데이타 초기화	 
	// 서비스호출
	nsfRequest("query"									// srvId
				, "com0030/find"						// url
				, "ds_cond_sman=ds_cond_sman ds_list_sman=ds_list_sman"		// inDsList
				, "ds_list_sman=ds_list_sman ds_error_sman=ds_error_sman"	// outDsList
				, ""									// strParam
				, "fn_sMan_afterQuery22"						// CallBackFunc
				);
}

function fn_sMan_afterQuery22(errCode, errMsg) { 
	
	// 호출결과처리
	if(ds_error_sman.rowcount() > 0) {  
		trace("fn_Query FAILED!!! "
		       + "[idx : " 			+ ds_error_sman.GetColumn(0,"IDX") + "] "
		       + "[error message : "+ ds_error_sman.GetColumn(0,"ERRMSG") + "]"
		       );
		gfn_showMsg("CE00001");
		// error 정보 표시 
		gfn_openWSErrorWin(grd_list, ds_list_sman_m, ds_error_sman, "FLAG");
	} else {	
		// 조회된 자료가 있을 경우 1행에 포커스 위치시킨다.
		if (ds_list_sman.RowCount() == 1) {
			// 결과리턴
			if(ds_list.GetOrgColumn(L_OLD_ROW,"MANAGER2") != ds_list_sman.GetColumn(0,"SMAN_CD")) {
				ds_list.SetColumn( L_OLD_ROW, 'changed',	"U"); 	// 트랜잭션 상태
				ds_list.SetColumn( L_OLD_ROW, 'MANAGER2',		ds_list_sman.GetColumn(0,"SMAN_CD")); 	// 관라지 id
				ds_list.SetColumn( L_OLD_ROW, 'MANAGERNM2',	ds_list_sman.GetColumn(0,"SMAN_NM")); 	// NI관라지명 
				ds_list.SetColumn( L_OLD_ROW, 'MANAGERTELE2',	ds_list_sman.GetColumn(0,"SMAN_INFO"));	// 전화번호 
			}

			grd_list.SetFocus();
			trace("fn_Query SUCCESS!!! [건수 : " + ds_list_sman.RowCount() + "]");
		}	
		if (ds_list_sman.RowCount() > 1) {
			grd_list_OnExpandEdit(ds_list,L_OLD_ROW,11,ds_list_sman.GetColumn(0,"SMAN_NM"),-1);

		} else {
			trace("fn_Query SUCCESS!!! 건수없음");
			gfn_showMsg("CI00002", ds_list_sman.RowCount() + "");
		}
	}
}
function fn_sman_query33() { 
	
	ds_list_sman.ClearData();  	// 그리드 데이타 초기화	 
	// 서비스호출
	nsfRequest("query"									// srvId
				, "com0030/find"						// url
				, "ds_cond_sman=ds_cond_sman ds_list_sman=ds_list_sman"		// inDsList
				, "ds_list_sman=ds_list_sman ds_error_sman=ds_error_sman"	// outDsList
				, ""									// strParam
				, "fn_sMan_afterQuery33"						// CallBackFunc
				);
}

function fn_sMan_afterQuery33(errCode, errMsg) { 
	
	// 호출결과처리
	if(ds_error_sman.rowcount() > 0) {  
		trace("fn_Query FAILED!!! "
		       + "[idx : " 			+ ds_error_sman.GetColumn(0,"IDX") + "] "
		       + "[error message : "+ ds_error_sman.GetColumn(0,"ERRMSG") + "]"
		       );
		gfn_showMsg("CE00001");
		// error 정보 표시 
		gfn_openWSErrorWin(grd_list, ds_list_sman_m, ds_error_sman, "FLAG");
	} else {	
		// 조회된 자료가 있을 경우 1행에 포커스 위치시킨다.
		if (ds_list_sman.RowCount() == 1) {
			// 결과리턴
			if(ds_list.GetOrgColumn(L_OLD_ROW,"MANAGER3") != ds_list_sman.GetColumn(0,"SMAN_CD")) {
				ds_list.SetColumn( L_OLD_ROW, 'changed',	"U"); 	// 트랜잭션 상태
				ds_list.SetColumn( L_OLD_ROW, 'MANAGER3',		ds_list_sman.GetColumn(0,"SMAN_CD")); 	// 관라지 id
				ds_list.SetColumn( L_OLD_ROW, 'MANAGERNM3',	ds_list_sman.GetColumn(0,"SMAN_NM")); 	// NI관라지명 
				ds_list.SetColumn( L_OLD_ROW, 'MANAGERTELE3',	ds_list_sman.GetColumn(0,"SMAN_INFO"));	// 전화번호 
			}

			grd_list.SetFocus();
			trace("fn_Query SUCCESS!!! [건수 : " + ds_list_sman.RowCount() + "]");
		}	
		if (ds_list_sman.RowCount() > 1) {
			grd_list_OnExpandEdit(ds_list,L_OLD_ROW,14,ds_list_sman.GetColumn(0,"SMAN_NM"),-1);

		} else {
			trace("fn_Query SUCCESS!!! 건수없음");
			gfn_showMsg("CI00002", ds_list_sman.RowCount() + "");
		}
	}
}
/*
function grd_list_OnChar(obj,strPreText,nChar,strPostText,nLLParam,nHLParam,nRow,nCell,nPivotIndex)
{
		if(nRow == L_OLD_ROW) {
			if(nCell == 7 || nCell == 8) {
				if (strPreText != strPostText) {
					ds_list.SetColumn( nRow, 'changed',	"U"); 	// 트랜잭션 상태
					ds_list.SetColumn( nRow, 'MANAGERNM1',	""); 	// NI관라지명 
					ds_list.SetColumn( nRow, 'MANAGERTELE1',"");	// 전화번호 
				}
			}
		}
}
*/


//사업자번호체크 이벤트 jss
function ed_lifnr_OnChar(obj,strPreText,nChar,strPostText,LLParam,HLParam)
{	
	//trace("nChar===>"+ nChar); 
	// 8 백스페이스키 46 딜리트키는 예외처리 
    if ((nChar==8) || (nChar==46)) return true; 
	// 0 ~ 9 (48 ~ 57) a ~ z (97~122) A ~ Z (65~90) 
	if (!(((nChar>= 48) && (nChar <= 57)) || ((nChar>= 65) && (nChar <= 90)) || ((nChar>= 97) && (nChar <= 122)))) { 
	  return false; 
	} 
	
}]]></Script>
</Window>