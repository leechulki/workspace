<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="584" Id="Sbi0100" Left="8" OnLoadCompleted="fn_OnLoadCompleted" OnTimer="form_OnTimer" OnUnloadCompleted="fn_OnUnloadCompleted" PidAttrib="7" Title="브랜드&#32;등록" Top="8" Ver="1.0" Width="976" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_combo">
				<Contents>
					<colinfo id="code" size="256" type="STRING"/>
					<colinfo id="name" size="256" type="STRING"/>
					<colinfo id="st" size="1" type="STRING"/>
					<record>
						<code>NOBRND</code>
						<name>NOBRND</name>
						<st></st>
					</record>
					<record>
						<code>GSP_MR</code>
						<name>GSP_MR</name>
						<st></st>
					</record>
					<record>
						<code>LUXEN_2</code>
						<name>LUXEN_2</name>
						<st></st>
					</record>
					<record>
						<code>IXEL</code>
						<name>IXEL</name>
						<st></st>
					</record>
					<record>
						<code>HEEL</code>
						<name>THEEL</name>
						<st></st>
					</record>
					<record>
						<code>LUXEN_1</code>
						<name>LUXEN_1</name>
						<st></st>
					</record>
					<record>
						<code>GSP_MRL</code>
						<name>GSP_MRL</name>
						<st></st>
					</record>
					<record>
						<code>NEO_MRL</code>
						<name>NEO_MRL</name>
						<st></st>
					</record>
					<record>
						<code>NEWYZER</code>
						<name>NEWYZER</name>
						<st></st>
					</record>
					<record>
						<code>SPACESAVER</code>
						<name>SPACESAVER</name>
						<st></st>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond">
				<Contents>
					<colinfo id="ATKLA" size="256" summ="default" type="STRING"/>
					<colinfo id="BRNDCD" size="256" summ="default" type="STRING"/>
					<colinfo id="BRNDSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="PRH" size="256" summ="default" type="STRING"/>
					<colinfo id="ZPRDGBN" size="256" summ="default" type="STRING"/>
					<colinfo id="MDATATYPE" size="256" summ="default" type="STRING"/>
					<colinfo id="DIPSDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="PRHNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="DDATATYPE" size="256" summ="default" type="STRING"/>
					<record>
						<ATKLA></ATKLA>
						<BRNDCD></BRNDCD>
						<BRNDSEQ></BRNDSEQ>
						<DDATATYPE></DDATATYPE>
						<DIPSDAT></DIPSDAT>
						<MDATATYPE></MDATATYPE>
						<PRH></PRH>
						<PRHNAME></PRHNAME>
						<ZPRDGBN></ZPRDGBN>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_error">
				<Contents>
					<colinfo id="IDX" size="256" type="STRING"/>
					<colinfo id="ERRMSG" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_abrand">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<colinfo id="CHECK" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_zprdgnb">
				<Contents>
					<colinfo id="CODE" size="1" type="STRING"/>
					<colinfo id="CODE_NAME" size="1" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_sndsys">
				<Contents>
					<colinfo id="CODE" size="1" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="1" summ="default" type="STRING"/>
					<record>
						<CODE>PDM</CODE>
						<CODE_NAME>PDM</CODE_NAME>
					</record>
					<record>
						<CODE>PLM</CODE>
						<CODE_NAME>PLM</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_dataType">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME>-&#32;선택&#32;-</CODE_NAME>
					</record>
					<record>
						<CODE>Y</CODE>
						<CODE_NAME>적용</CODE_NAME>
					</record>
					<record>
						<CODE>N</CODE>
						<CODE_NAME>미적용</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_zprdgbn_group">
				<Contents>
					<colinfo id="ZPRDGBN" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE>NA</CODE>
						<CODE_NAME>-&#32;선택&#32;-</CODE_NAME>
						<ZPRDGBN></ZPRDGBN>
					</record>
					<record>
						<CODE>AP_BASIC</CODE>
						<CODE_NAME>BASIC</CODE_NAME>
						<ZPRDGBN>AP_01</ZPRDGBN>
					</record>
					<record>
						<CODE></CODE>
						<CODE_NAME>COMMON</CODE_NAME>
						<ZPRDGBN>DW_01</ZPRDGBN>
					</record>
					<record>
						<CODE></CODE>
						<CODE_NAME>COMMON</CODE_NAME>
						<ZPRDGBN>ELV_01</ZPRDGBN>
					</record>
					<record>
						<CODE>EL_BASIC</CODE>
						<CODE_NAME>BASIC</CODE_NAME>
						<ZPRDGBN>ELV_01</ZPRDGBN>
					</record>
					<record>
						<CODE>EL_INSIDE</CODE>
						<CODE_NAME>INSIDE</CODE_NAME>
						<ZPRDGBN>ELV_01</ZPRDGBN>
					</record>
					<record>
						<CODE>EL_LAYOUT</CODE>
						<CODE_NAME>LAYOUT</CODE_NAME>
						<ZPRDGBN>ELV_01</ZPRDGBN>
					</record>
					<record>
						<CODE>EL_OPTION</CODE>
						<CODE_NAME>OPTION</CODE_NAME>
						<ZPRDGBN>ELV_01</ZPRDGBN>
					</record>
					<record>
						<CODE>EL_OTHERS</CODE>
						<CODE_NAME>OTHERS</CODE_NAME>
						<ZPRDGBN>ELV_01</ZPRDGBN>
					</record>
					<record>
						<CODE>EL_OUTSIDE</CODE>
						<CODE_NAME>OUTSIDE</CODE_NAME>
						<ZPRDGBN>ELV_01</ZPRDGBN>
					</record>
					<record>
						<CODE>EL_BASIC</CODE>
						<CODE_NAME>BASIC</CODE_NAME>
						<ZPRDGBN>ELV_02</ZPRDGBN>
					</record>
					<record>
						<CODE>EL_INSIDE</CODE>
						<CODE_NAME>INSIDE</CODE_NAME>
						<ZPRDGBN>ELV_02</ZPRDGBN>
					</record>
					<record>
						<CODE>EL_LAYOUT</CODE>
						<CODE_NAME>LAYOUT</CODE_NAME>
						<ZPRDGBN>ELV_02</ZPRDGBN>
					</record>
					<record>
						<CODE>EL_OPTION</CODE>
						<CODE_NAME>OPTION</CODE_NAME>
						<ZPRDGBN>ELV_02</ZPRDGBN>
					</record>
					<record>
						<CODE>EL_OTHERS</CODE>
						<CODE_NAME>OTHERS</CODE_NAME>
						<ZPRDGBN>ELV_02</ZPRDGBN>
					</record>
					<record>
						<CODE>EL_OUTSIDE</CODE>
						<CODE_NAME>OUTSIDE</CODE_NAME>
						<ZPRDGBN>ELV_02</ZPRDGBN>
					</record>
					<record>
						<CODE></CODE>
						<CODE_NAME>COMMON</CODE_NAME>
						<ZPRDGBN>ESC_01</ZPRDGBN>
					</record>
					<record>
						<CODE>ES_BASIC</CODE>
						<CODE_NAME>BASIC</CODE_NAME>
						<ZPRDGBN>ESC_01</ZPRDGBN>
					</record>
					<record>
						<CODE>ES_EXTER</CODE>
						<CODE_NAME>EXTER</CODE_NAME>
						<ZPRDGBN>ESC_01</ZPRDGBN>
					</record>
					<record>
						<CODE>ES_OPTION</CODE>
						<CODE_NAME>OPTION</CODE_NAME>
						<ZPRDGBN>ESC_01</ZPRDGBN>
					</record>
					<record>
						<CODE>ES_SAFETY</CODE>
						<CODE_NAME>SAFETY</CODE_NAME>
						<ZPRDGBN>ESC_01</ZPRDGBN>
					</record>
					<record>
						<CODE></CODE>
						<CODE_NAME>COMMON</CODE_NAME>
						<ZPRDGBN>MW_01</ZPRDGBN>
					</record>
					<record>
						<CODE>MW_BASIC</CODE>
						<CODE_NAME>BASIC</CODE_NAME>
						<ZPRDGBN>MW_01</ZPRDGBN>
					</record>
					<record>
						<CODE>MW_EXTER</CODE>
						<CODE_NAME>EXTER</CODE_NAME>
						<ZPRDGBN>MW_01</ZPRDGBN>
					</record>
					<record>
						<CODE>MW_OPTION</CODE>
						<CODE_NAME>OPTION</CODE_NAME>
						<ZPRDGBN>MW_01</ZPRDGBN>
					</record>
					<record>
						<CODE>MW_SAFETY</CODE>
						<CODE_NAME>SAFETY</CODE_NAME>
						<ZPRDGBN>MW_01</ZPRDGBN>
					</record>
					<record>
						<CODE>PSD_BASIC</CODE>
						<CODE_NAME>BASIC</CODE_NAME>
						<ZPRDGBN>PSD_01</ZPRDGBN>
					</record>
					<record>
						<CODE>PSD_ELEC</CODE>
						<CODE_NAME>ELEC</CODE_NAME>
						<ZPRDGBN>PSD_01</ZPRDGBN>
					</record>
					<record>
						<CODE>PSD_SASH</CODE>
						<CODE_NAME>SASH</CODE_NAME>
						<ZPRDGBN>PSD_01</ZPRDGBN>
					</record>
					<record>
						<CODE>PSD_STEEL</CODE>
						<CODE_NAME>STEEL</CODE_NAME>
						<ZPRDGBN>PSD_01</ZPRDGBN>
					</record>
					<record>
						<CODE>EL_BASIC</CODE>
						<CODE_NAME>BASIC</CODE_NAME>
						<ZPRDGBN>SHN_01</ZPRDGBN>
					</record>
					<record>
						<CODE>EL_INSIDE</CODE>
						<CODE_NAME>INSIDE</CODE_NAME>
						<ZPRDGBN>SHN_01</ZPRDGBN>
					</record>
					<record>
						<CODE>EL_LAYOUT</CODE>
						<CODE_NAME>LAYOUT</CODE_NAME>
						<ZPRDGBN>SHN_01</ZPRDGBN>
					</record>
					<record>
						<CODE>EL_OPTION</CODE>
						<CODE_NAME>OPTION</CODE_NAME>
						<ZPRDGBN>SHN_01</ZPRDGBN>
					</record>
					<record>
						<CODE>EL_OUTSIDE</CODE>
						<CODE_NAME>OUTSIDE</CODE_NAME>
						<ZPRDGBN>SHN_01</ZPRDGBN>
					</record>
					<record>
						<CODE>ES_BASIC</CODE>
						<CODE_NAME>BASIC</CODE_NAME>
						<ZPRDGBN>SHN_02</ZPRDGBN>
					</record>
					<record>
						<CODE>ES_OPTION</CODE>
						<CODE_NAME>OPTION</CODE_NAME>
						<ZPRDGBN>SHN_02</ZPRDGBN>
					</record>
					<record>
						<CODE></CODE>
						<CODE_NAME>COMMON</CODE_NAME>
						<ZPRDGBN>SP_01</ZPRDGBN>
					</record>
					<record>
						<CODE></CODE>
						<CODE_NAME>COMMON</CODE_NAME>
						<ZPRDGBN>SV_01</ZPRDGBN>
					</record>
					<record>
						<CODE></CODE>
						<CODE_NAME>COMMON</CODE_NAME>
						<ZPRDGBN>WL_01</ZPRDGBN>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_sanyang">
				<Contents>
					<colinfo id="MANDT" size="256" summ="default" type="STRING"/>
					<colinfo id="BRNDSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="ZPRDGBN" size="256" summ="default" type="STRING"/>
					<colinfo id="BRNDCD" size="256" summ="default" type="STRING"/>
					<colinfo id="PRH" size="256" summ="default" type="STRING"/>
					<colinfo id="MFLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="MSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="MDATATYPE" size="256" summ="default" type="STRING"/>
					<colinfo id="MDISPTP" size="256" summ="default" type="STRING"/>
					<colinfo id="MMODITP" size="256" summ="default" type="STRING"/>
					<colinfo id="MEGISSND" size="256" summ="default" type="STRING"/>
					<colinfo id="MDIPSDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="PRD" size="256" summ="default" type="STRING"/>
					<colinfo id="DFLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="DDATATYPE" size="256" summ="default" type="STRING"/>
					<colinfo id="DDISPTP" size="256" summ="default" type="STRING"/>
					<colinfo id="DDIPSDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="DSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="DCNT" size="256" summ="default" type="STRING"/>
					<colinfo id="PRHNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="PRDNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="ATKLA" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
		</Datasets>
		<Shape BKColor="user0" Bottom="55" Height="52" Id="Shape1" Left="1" LineColor="user1" Right="969" TabOrder="1" Top="3" Type="Rectangle" Width="968"></Shape>
		<Static Align="Right" Height="24" Id="Static0" Left="3" Style="sty_lb_search" TabOrder="3" Text="브랜드차수&#32;" Top="4" VAlign="Middle" Width="62"></Static>
		<Edit Align="CENTER" BindDataset="ds_cond" Column="BRNDSEQ" Enable="FALSE" Height="23" Id="ed_brndseq" Left="69" MaxLength="10" Number="TRUE" Style="sty_btn" TabOrder="2" Text="000" Top="5" UpperOnly="TRUE" Width="32"></Edit>
		<Static Align="Right" Height="24" Id="Static1" Left="137" Style="sty_lb_search" TabOrder="4" Text="제품구분&#32;" Top="4" VAlign="Middle" Width="62"></Static>
		<Combo BindDataset="ds_cond" Border="Flat" BorderColor="user13" CodeColumn="CODE" Column="ZPRDGBN" DataColumn="CODE_NAME" Height="20" Id="cb_zprdgbn" InnerDataset="ds_zprdgnb" Left="204" OnChanged="cb_zprdgbn_OnChanged" Style="sty_ipt_search" TabOrder="5" Top="4" Width="120"></Combo>
		<Static Align="Right" Height="24" Id="Static2" Left="327" Style="sty_lb_search" TabOrder="6" Text="브랜드&#32;" Top="2" VAlign="Middle" Width="62"></Static>
		<Button Cursor="HAND" Height="18" Id="btn_brndseq" ImageID="btn_icon_search" Left="103" OnClick="fn_com041PupUp" TabOrder="7" Top="8" Transparent="TRUE" Width="18"></Button>
		<Edit Border="Flat" BorderColor="user13" Height="20" Id="ed_brndcd" Left="394" Readonly="TRUE" Style="text_black" TabOrder="8" Top="5" Width="526"></Edit>
		<Button ButtonStyle="TRUE" Height="20" Id="Button0" Left="921" OnClick="fn_brndCdCombo" Style="text_black" TabOrder="9" Top="5" Width="20"></Button>
		<Static Align="Right" Height="24" Id="Static6" Left="383" Style="sty_lb_search" TabOrder="11" Text="특성한글명&#32;" Top="28" VAlign="Middle" Width="62"></Static>
		<Edit Border="Flat" CheckLength="Byte" Height="20" Id="ed_prhname" ImeMode="native" Left="448" LeftMargin="4" MaxLength="10" RightMargin="4" Style="sty_ipt_form" TabOrder="10" Top="31" Width="120"></Edit>
		<Static Align="Right" Height="24" Id="Static3" Left="3" Style="sty_lb_search" TabOrder="12" Text="그룹&#32;" Top="29" VAlign="Middle" Width="62"></Static>
		<Combo Border="Flat" BorderColor="user13" CodeColumn="CODE" DataColumn="CODE_NAME" Height="20" Id="cb_atkla" INDEX="0" InnerDataset="ds_zprdgbn_group" Left="68" Style="sty_ipt_search" TabOrder="14" Top="31" Width="109"></Combo>
		<Static Align="Right" Height="24" Id="Static4" Left="190" Style="sty_lb_search" TabOrder="13" Text="특성&#32;" Top="29" VAlign="Middle" Width="62"></Static>
		<Edit Border="Flat" CheckLength="Byte" Height="20" Id="ed_prh" ImeMode="native" Left="256" LeftMargin="4" MaxLength="10" RightMargin="4" Style="sty_ipt_form" TabOrder="15" Top="31" Width="120"></Edit>
		<Grid AreaSelect="true" AutoEnter="TRUE" AutoFitEndLine="Hide" BindDataset="ds_sanyang" BkColor2="default" BoldHead="true" Border="Flat" Bottom="560" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="25" Height="500" Id="grd_sanyang" InputPanel="FALSE" Left="8" LineColor="user20" LineType="ExHORZ" Right="968" RowHeight="20" Style="sty_grid" TabOrder="16" TabStop="true" Top="60" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="960">
			<contents>
				<format id="Default">
					<columns>
						<col width="38"/>
						<col width="80"/>
						<col width="79"/>
						<col width="32"/>
						<col width="61"/>
						<col width="243"/>
						<col width="120"/>
						<col width="59"/>
						<col width="67"/>
						<col width="77"/>
						<col width="79"/>
						<col width="40"/>
						<col width="57"/>
						<col width="267"/>
						<col width="167"/>
						<col width="65"/>
						<col width="90"/>
					</columns>
					<head>
						<cell align="center" col="0" display="text" rowspan="2" Valign="Center">
							<cell col="0" color="user21" display="text" font="굴림,9" text="브랜드" wordwrap="word"/>
							<cell col="0" color="user21" display="text" font="굴림,9" row="1" text="차수" wordwrap="word"/>
						</cell>
						<cell align="center" col="1" display="text" rowspan="2" Valign="Center">
							<cell col="0" color="user21" display="text" font="굴림,9" text="브랜드" wordwrap="word"/>
							<cell col="0" display="text" row="1"/>
						</cell>
						<cell col="2" display="text" rowspan="2">
							<cell col="0" color="user21" display="text" font="굴림,9" text="그룹" wordwrap="word"/>
							<cell col="0" display="text" row="1"/>
						</cell>
						<cell col="3" colspan="8" display="text">
							<cell col="0" display="text"/>
							<cell align="center" col="7" color="user21" display="text" font="굴림,9" wordwrap="word"/>
							<cell align="center" col="6" color="user21" display="text" font="굴림,9" wordwrap="word"/>
							<cell align="center" col="5" color="user21" display="text" font="굴림,9" wordwrap="word"/>
							<cell align="center" col="4" color="user21" display="text" font="굴림,9" text="특성" wordwrap="word"/>
							<cell align="center" col="3" color="user21" display="text" font="굴림,9" wordwrap="word"/>
							<cell align="center" col="2" color="user21" display="text" font="굴림,9" wordwrap="word"/>
							<cell align="center" col="1" color="user21" display="text" font="굴림,9" wordwrap="word"/>
						</cell>
						<cell col="11" colspan="6" display="text">
							<cell col="0" display="text"/>
							<cell col="1" display="text"/>
							<cell align="center" col="2" color="user21" display="text" font="굴림,9" text="특성값" wordwrap="word"/>
							<cell col="3" display="text"/>
							<cell col="4" display="text"/>
							<cell col="5" display="text"/>
						</cell>
						<cell col="3" color="user21" display="text" font="굴림,9" row="1" text="No"/>
						<cell col="4" color="user21" display="text" font="굴림,9" row="1" text="자료구분"/>
						<cell col="5" color="user21" display="text" font="굴림,9" row="1" text="특성&#32;한글명"/>
						<cell col="6" color="user21" display="text" font="굴림,9" row="1" text="특성"/>
						<cell col="7" color="user21" display="text" font="굴림,9" row="1" text="출력여부"/>
						<cell col="8" color="user21" display="text" font="굴림,9" row="1" text="수정여부"/>
						<cell col="9" color="user21" display="text" font="굴림,9" row="1" text="EGIS전송"/>
						<cell col="10" color="user21" display="text" font="굴림,9" row="1" text="폐기일"/>
						<cell col="11" color="user21" display="text" font="굴림,9" row="1" text="No"/>
						<cell col="12" color="user21" display="text" font="굴림,9" row="1" text="자료구분"/>
						<cell col="13" color="user21" display="text" font="굴림,9" row="1" text="특성값&#32;한글명"/>
						<cell col="14" color="user21" display="text" font="굴림,9" row="1" text="특성값"/>
						<cell col="15" color="user21" display="text" font="굴림,9" row="1" text="출력여부"/>
						<cell col="16" color="user21" display="text" font="굴림,9" row="1" text="폐기일"/>
					</head>
					<body>
						<cell align="center" col="0" colid="BRNDSEQ" display="text" suppress="1"/>
						<cell align="center" col="1" colid="BRNDCD" display="text" suppress="1"/>
						<cell align="center" col="2" colid="ATKLA" display="text" suppress="1"/>
						<cell align="center" col="3" colid="MSEQ" display="text" suppress="1"/>
						<cell align="center" col="4" colid="MDATATYPE" display="text" suppress="1"/>
						<cell align="left" col="5" colid="PRHNAME" display="text" suppress="1"/>
						<cell align="left" col="6" colid="PRH" display="text" suppress="1"/>
						<cell align="center" col="7" colid="MDISPTP" display="text"/>
						<cell align="center" col="8" colid="MMODITP" display="text"/>
						<cell align="center" col="9" colid="MEGISSND" display="text"/>
						<cell align="center" col="10" colid="MDIPSDAT" display="text" Mask="@@@@-@@-@@"/>
						<cell align="center" col="11" colid="DSEQ" display="text"/>
						<cell align="center" col="12" colid="DDATATYPE" display="text"/>
						<cell align="left" col="13" colid="PRDNAME" display="text"/>
						<cell align="left" col="14" colid="PRD" display="text"/>
						<cell align="center" col="15" colid="DDISPTP" display="text"/>
						<cell align="center" col="16" colid="DDIPSDAT" display="text" Mask="@@@@-@@-@@"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Static Align="Right" Height="24" Id="Static7" Left="573" Style="sty_lb_search" TabOrder="18" Text="특성&#32;자료구분&#32;" Top="27" VAlign="Middle" Width="80"></Static>
		<Combo Border="Flat" BorderColor="user13" CodeColumn="CODE" DataColumn="CODE_NAME" Height="20" Id="cb_dataType" INDEX="0" InnerDataset="ds_dataType" Left="655" OnChanged="cb_dataType_OnChanged" Style="sty_ipt_search" TabOrder="17" Top="29" Width="73"></Combo>
		<File Bottom="25" Height="24" Id="File0" Left="986" Right="1010" TabOrder="18" Top="1" Width="24"></File>
		<FileDialog Bottom="25" FilePath="c:\" Filter="Excel&#32;통합문서&#32;(*.xlsx)|*.xlsx|Excel&#32;97-2003&#32;통합문서&#32;(*.xls)|*.xls|" Height="24" Id="fileDialog" Left="1013" Right="1037" TabOrder="19" Top="1" Type="Save" Width="24"></FileDialog>
	</Form>
	<Script><![CDATA[/*
 ******************************************************************************************
 * 기      능   : 브랜드 영업특성 조회
 * 작  성  자   : 박수근
 * 작성  일자   : 2020-09-07
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
#include "LIB::commons.js";
#include "LIB::nsfRequest.js";
#include "LIB::common_hdel.js";

//=========================================================================================
// [ PART 1 ]
// Form에서 사용될 전역변수를 선언
// FORM에서 사용되는 전역변수는 대문자로 작성하며, F_XXX 의 형태를 갖도록 한다. 
//=========================================================================================
var F_BRNDSEQ = "000";
var F_BRNDCD  = "";

//=========================================================================================
// [ PART 2 ]
// Form Loading / Unloading 시 작업 정의
//=========================================================================================
function fn_OnLoadCompleted(obj) {
    gfn_initForm(true);
	fn_init_form();
}

/********************************************************************************
* 기      능   : form UnloadCompleted 
********************************************************************************/
function fn_OnUnloadCompleted(obj) {
	return gfn_isFormUnload(obj);
}

/********************************************************************************
* 기      능   : 폼 초기화
********************************************************************************/
function fn_init_form() {
    fn_initQuery();

    // 맥스브랜드 차수 설정
    ed_brndseq.Text = F_BRNDSEQ;

    // 제품구분에 전체 항목 추가 ds_zprdgnb
	ds_zprdgnb.InsertRow(0);
	ds_zprdgnb.SetColumn(0, "CODE", "");
	ds_zprdgnb.SetColumn(0, "CODE_NAME", "- 선택 -");
	cb_zprdgbn.Index = 0;

	// 제품제어 콤보 제어
	fn_CbZprdgbnCtl(ed_brndseq.Text);

}

/********************************************************************************
* 기      능   : 폼초기화 공통 정보 조회 initComs040 initSbi0100
********************************************************************************/
function fn_initQuery() {
    var svcId     = "fn_initQuery";
    var svcUrl    = "sbi0100c/initSbi0100";
    var inDsList  = "ds_abrand=ds_abrand ds_zprdgnb=ds_zprdgnb";
    var outDsList = "F_BRNDSEQ=F_BRNDSEQ ds_abrand=ds_abrand ds_zprdgnb=ds_zprdgnb ds_error=ds_error";
    var inParam   = "BRNDSEQ="+quote(ed_brndseq.Text);
    var callBackFunc = "fn_afterQuery";

    ds_error.ClearData();
    fn_createWait("",this);

    // 화면 초기 공통 정보는 http 동기화 호출
    http.sync = true;
	nsfRequest(svcId, svcUrl, inDsList, outDsList, inParam, callBackFunc);
	http.sync = false;
}

/********************************************************************************
* 기      능   : 브랜드차수별 브랜드 리스트 조회
********************************************************************************/
function fn_brndcdQuery() {
    var svcId     = "findAbrnd";
    var svcUrl    = "sbi0090c/findAbrnd";
    var inDsList  = "ds_abrand=ds_abrand";
    var outDsList = "ds_abrand=ds_abrand ds_error=ds_error";
    var inParam   = "BRNDSEQ="+quote(ed_brndseq.Text);
    var callBackFunc = "fn_afterQuery";

    ds_error.ClearData();
    fn_createWait("",this);

    // 화면 초기 공통 정보는 http 동기화 호출
    http.sync = true;
	nsfRequest(svcId, svcUrl, inDsList, outDsList, inParam, callBackFunc);
	http.sync = false;
}

/********************************************************************************
* 기      능   : 조회
********************************************************************************/
function fn_query() {
    // 검색 입력값 체크
    if(Length(ed_brndseq.Text) == 0) {
        gfn_openMsgWin("브랜드차수를 입력하십시요", "", "A", "조회");
        return;
    }

    if(Length(cb_zprdgbn.Value) == 0) {
        gfn_openMsgWin("제품구분을 선택하십시요", "", "A", "조회");
        return;
    }

    if(Length(ed_brndcd.Text) == 0) {
        gfn_openMsgWin("브랜드를 선택하십시요", "", "A", "조회");
        return;
    }
    
    // 브랜드 코드 입력
    ds_cond.SetColumn(0, "BRNDCD", F_BRNDCD);
    ds_cond.SetColumn(0, "PRH", ed_prh.Text);
    ds_cond.SetColumn(0, "ATKLA", cb_atkla.Value);
    ds_cond.SetColumn(0, "PRHNAME", ed_prhname.Text);

    var svcId  = "query";
    var svcUrl    = "sbi0100c/findSayangList";
    var inDsList  = "ds_cond=ds_cond ds_sanyang=ds_sanyang";
    var outDsList = "ds_sanyang=ds_sanyang ds_error=ds_error";
    var inParam   = "";
    var callBackFunc = "fn_afterQuery";
    fn_createWait("",this);
    ds_sanyang.ClearData();
    ds_error.ClearData();
	nsfRequest(svcId, svcUrl, inDsList, outDsList, inParam, callBackFunc);
}

/********************************************************************************
* 기      능   : 액셀  
********************************************************************************/
function fn_excel() {
    //gfn_exportExcel(grd_sanyang, "브랜드 영업사양");
    fn_excel_fileOpen();
}

/********************************************************************************
* 기      능   : 파일 폴더 팝업 호출
********************************************************************************/
function fn_excel_fileOpen()
{ 
    
	fileDialog.open();
	if ( length(fileDialog.FilePath) == 0 
		|| length( fileDialog.FileName ) == 0 ) {
		return;
	}

	_F_FILE_DIR =  fileDialog.FilePath;
	_F_FILE_NAME = fileDialog.FileName;
	grd_sanyang.SaveExcel(_F_FILE_DIR + "\\" + _F_FILE_NAME+".xls","sheet1","A1",false,true,false);
    alert("엑셀파일이 정상적으로 생성 되었습니다.");
    //fn_createWait("엑셀 파일 생성 중입니다.",this);

	//저장된 엑셀파일 재저장 로직호출
/*	
	var intervalTime = 300;
	var degr = ds_excel_sanyangPrd.GetRowCount()/5000;
	intervalTime = intervalTime * degr;
	setTimer(888, intervalTime);
*/	
}

/********************************************************************************
* 기      능   : 엑셀파일 생성 처리
********************************************************************************/
function form_OnTimer(obj,nEventID)
{
	killTimer(888);
	//임시파일을 엑셀저장형식으로 재저장함.
	var rtn = ext_ExcelSaveAsEx(_F_FILE_DIR + "\\" + _F_FILE_NAME+".xls", _F_FILE_DIR + "\\" + _F_FILE_NAME+".xlsx", "2007", false);
	if(!rtn) {
		//임시파일 삭제
		File0.Delete(_F_FILE_DIR + "\\" + _F_FILE_NAME+".xls");
	    alert("엑셀파일이 생성 되었습니다.");
	}

    fn_destroyWait();
}

/********************************************************************************
* 기      능   : 닫기  
********************************************************************************/
function fn_close() {
	this.close();
}

//=========================================================================================
// [ PART 4]
// Callback 함수 정의 : callback 함수명은 메인 함수의 fn_xxxx() 에서 xxxx 부분은 fn_afterXXXX()
// 형태가 되도록 작성 
//=========================================================================================
/********************************************************************************
* 기      능   : fn_init_form Callback  
********************************************************************************/
function fn_afterInitForm(svcId, errCode, errMsg) {
    fn_destroyWait();
	if(ds_error.rowcount > 0)	{
        gfn_openMsgWin(ds_error.GetColumn(0,"ERRMSG"), "", "E", "저장");
		return;
	} 
}

/********************************************************************************
* 기      능   : 조회 Callback  
********************************************************************************/
function fn_afterQuery(svcId, errCode, errMsg) {
    fn_destroyWait();
	if(ds_error.rowcount > 0)	{
		gfn_showAlert(ds_error.GetColumn(0,"ERRMSG"));
		return;
	} else {
        fn_sanyangFilter();
	}
}

//=========================================================================================
// [ PART 5]
// 화면 UI 함수
//=========================================================================================
/********************************************************************************
* 기      능   : 자료구분 콤보 변경 이벤트
********************************************************************************/
function cb_dataType_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex) {
    fn_sanyangFilter();
}

/********************************************************************************
* 기      능   : 자료구분 필터저굥
* 설명: 검색조건별 특성 데이터 조회 후 자료구분 필터 적용
********************************************************************************/
function fn_sanyangFilter() {
    var dataType = cb_dataType.Value;
    var filString= "";
    if(dataType != "") {
        if(dataType == "Y") {
            filString = "MDATATYPE=="+quote("적용");
        } else if(dataType == "N") {
            filString = "MDATATYPE=="+quote("미적용");
        }
        ds_sanyang.Filter(filString);
    } else {
        ds_sanyang.UnFilter();
    }
}

/********************************************************************************
* 기      능   : 제품구분 콤보 설정 제어
* 설명: 제품구분 콤보 설정 cb_zprdgbn "000" 인 경우에만 활성화 그렇지 않으면 ELV_01
********************************************************************************/
function fn_CbZprdgbnCtl(brndSeq) {
    var strFil;
    var findRow = 0;
    if(brndSeq == "000") {
        // 제품 콤보 활성화
        cb_zprdgbn.Enable= true;
        cb_zprdgbn.Index =0;

        // 000 차는 무조건 NOBRND
        // 멀티 브랜드 선택 활성화
        ed_brndcd.Enable = true;
        ed_brndcd.Text = "NOBRND";
        F_BRNDCD = "NOBRND";
        
        // 제품별 그룹 선택 필터링
        strFil = "ZPRDGBN==''||ZPRDGBN=="+quote(cb_zprdgbn.Value);
        ds_zprdgbn_group.Filter(strFil);
        
        Button0.Enable = false;
    } else {
        // 제품 콤보 비활성화
        // 제품구분은 기본 선택값 ELV_01
        cb_zprdgbn.Enable= false;
        findRow = ds_zprdgnb.FindRow("CODE", "ELV_01");
        cb_zprdgbn.Index = findRow;
 
        // 멀티 브랜드 선택 활성화
        ed_brndcd.Enable = true;

        // 제품별 그룹 선택 필터링
        strFil = "ZPRDGBN==''||ZPRDGBN=="+quote("ELV_01");
        ds_zprdgbn_group.Filter(strFil);
        
        ed_brndcd.Text = "";
        F_BRNDCD = "";

        Button0.Enable = true;
    }
}

/********************************************************************************
* 기      능   : 제품구분 변경 처리
* 제품구분 변경에 따른 ds_zprdgbn_group 필터 제어
********************************************************************************/
function cb_zprdgbn_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
    var strFil;
	strFil = "ZPRDGBN==''||ZPRDGBN=="+quote(cb_zprdgbn.Value);
	ds_zprdgbn_group.Filter(strFil);
}

/********************************************************************************
* 기      능   : 정렬 처리 
********************************************************************************/
function grd_header_OnHeadClick(obj,nCell,nX,nY,nPivotIndex) {
	if( nCell == 0 ) gfn_selectAllGrid(obj,nCell,nCell,true);
	else {
		gfn_sortGrid(obj, nCell);
	}
}

/********************************************************************************
* 기      능   : 브랜드차수 등록 팝업 호출
********************************************************************************/
function fn_com041PupUp(obj)
{
    var arg  = "";
	var brndArr;
	arg = "F_BRNDSEQ="+quote(ed_brndseq.Text);
	brndArr = gfn_openPopUpUrlHdel("SBI::Sbi0091.xml", true, arg);
	if(Length(brndArr) > 0) {
	    if(ed_brndseq.Text != brndArr) {
		    ed_brndseq.Text = brndArr;

			// 제품제어콤보 실행
			fn_CbZprdgbnCtl(ed_brndseq.Text);
			
			// 입력값 초기화
			cb_atkla.Index = 0;
			ed_prh.Text = "";
			ed_prhname.Text = "";
			
			// 필터값 초기화
			cb_dataType.Index = 0;
			
		    // 브랜드 코드 도 다시 조회한다.
		    fn_brndcdQuery();
	    }
	}
}

/********************************************************************************
* 기      능   : 브랜드 적용일자 등록 팝업
********************************************************************************/
function fn_com042PupUp(obj)
{
    var arg  = "";
	var brndArr;
	arg = "F_BRNDSEQ="+quote(ed_brndseq.Text);
	brndArr = gfn_openPopUpUrlHdel("SBI::Sbi0092.xml", true, arg);
}

/********************************************************************************
* 기      능   : 브랜드 선택콤보 생성
********************************************************************************/
function fn_brndCdCombo(obj)
{
	var ArrCode;
	var str_rtn = ngmf_SetPopupDivMultiCombo(ed_brndcd, ds_abrand, "CHECK", "CODE", "CODE_NAME", "CODE", ArrCode);
	ArrCode = str_rtn;		// Return 값 다시 Code 변수에 넘김
    // 코드값을 값고 있다.
	F_BRNDCD = ArrCode;
}

//-------------------------------------------------------------------------------------------------//
var ngmv_openChkCob = false;										// Create Object Check 용
var ngmv_objMultiCob;														// Multi Select Return Object
var ngmv_objMCobDS;															// Multi Select DataSet
var ngmv_Cobcheck, ngmv_CobCode, ngmv_CobText;			// DataSet Column(Display)

var ngmv_returnVal = "";
var ngmv_CheckFlag = "";

///////////////////////////////////////////////////////////////////////////////

/*===============================================================
= 기능 : Combo MultiSelect (공통)
= 인수 : obj				Rerurn Value 적용 Component ID
				 objDs			Multi Combo BindDataset
				 colchk 		PopupDiv Grid Check Column
				 colid			PopupDiv Grid Code Column
				 colnm			PopupDiv Grid Text Column
				 cdFlag			Check Flag
				 cdArg			Selected Code Value
				 fixCol			Fix Code Value
= 예제 : ngmf_SetPopupDivMultiCombo(objEdit, objDs, colchk, colid, colnm, cdFlag, cdArg, fixCol)
===============================================================*/
function ngmf_SetPopupDivMultiCombo(objEdit, objDs, colchk, colid, colnm, cdFlag, cdArg, fixCol){	
	ngmv_objMultiCob = objEdit;
	ngmv_objMCobDS = objDs;
	ngmv_Cobcheck = colchk;
	ngmv_CobCode = colid;
	ngmv_CobText = colnm;
	ngmv_CheckFlag = cdFlag;
	
	var div_w = objEdit.Width;
	var div_y = ClientToScreenY(objEdit, 0);
	var div_x = ClientToScreenX(objEdit, 0);
	
	var objDsCnt = ngmv_objMCobDs.RowCount();
	var objHeight = 186;
	var calHeight = 186;
	var calDiff =0;
	
	if (objDsCnt < 1) {
		calHeight = objHeight - 92;
	} else if (objDsCnt < 5) {
		calHeight = objHeight - ((5-objDsCnt) * 18);
	}
	
	cal_Diff = objHeight - calHeight;
	
	if (ngmv_openChkCob == false){
		Create("PopupDiv","PopDiv_MultiCombo",'width="100" height="' + calHeight + '" border="flat" borderColor="#C0D4E6" OnCloseUp="ngmf_PopDivCobCloseUp"');
		ngmv_openChkCob = true;
	}
	
	var chk_bln = false;
	for(i=0; i<ngmv_objMCobDS.ColCount(); i++){
		if (ngmv_objMCobDS.GetColID(i) == "checked_flag"){
			chk_bln = true;
			break;
		}
	}
	
	if (! chk_bln) {
		ngmv_objMCobDS.AddColumn("checked_flag");
	} else {
		for (i=0; i<ngmv_objMCobDS.RowCount(); i++){
			ngmv_objMCobDS.SetColumn(i,"checked_flag","");
		}
	}
	
	var str_arg;
	if (ToUpperCase(cdFlag) == "CODE" || ToUpperCase(cdFlag) == "FIX") str_arg = cdArg;
	else str_arg = ngmv_objMultiCob.Value;	
	
	ngmf_SetSelCobData(str_arg, fixCol);
	PopDiv_MultiCombo.Contents = ngmf_SetPopDivCob(div_w, cal_Diff);
	PopDiv_MultiCombo.TrackPopup(div_x, div_y, objEdit.Width,objEdit.Height);
	
	return ngmv_returnVal;
}

/*===============================================================
= 기능 : Combo Selected Column 체크 (공통)
= 인수 : argGet			Seleted Column Check
				 objDs			Fix Column
= 예제 : ngmf_SetSelCobData(argGet, fArg)
===============================================================*/
function ngmf_SetSelCobData(argGet, fArg){
	var arr_get = split(argGet,",");
	var arr_get1 = split(fArg,",");
	
	for (i=0; i<ngmv_objMCobDS.RowCount(); i++){
		ngmv_objMCobDS.SetColumn(i,ngmv_Cobcheck,"0");
	}
	
	if (length(arr_get) > 0 || length(arr_get1) > 0){
		for (i=0; i<length(arr_get); i++){
			for (j=0; j<ngmv_objMCobDS.RowCount(); j++){
				if (arr_get[i] == ngmv_objMCobDS.GetColumn(j, ngmv_CobCode)){
					ngmv_objMCobDS.SetColumn(j,ngmv_Cobcheck,"1");
					//if (toUpper(ngmv_CheckFlag) == "FIX") ngmv_objMCobDS.SetColumn(j,"checked_flag","C");
				}
				if (arr_get1[i] == ngmv_objMCobDS.GetColumn(j, ngmv_CobCode)){
					ngmv_objMCobDS.SetColumn(j,"checked_flag","C");
				}
			}
		}
	}
}

/*===============================================================
= 기능 : Multi Combo Drawing (공통)
= 인수 : div_width			Return Value Component의 Width
= 예제 : ngmf_SetPopDivCob(div_width)
===============================================================*/
function ngmf_SetPopDivCob(div_width, Diff_H){
	var str_temp;
	
	var grd_H = 182;									// Grid Height;
	var div_T = 184;									// Div(선택적용,선택해제) Top
	var Real_H = grd_H - Diff_H;		// Display Data의 RowCount에 따른 Grid Height 계산
	var Real_T = div_T - Diff_H;		// Display Data의 RowCount에 따른 Div Top 계산

	PopDiv_MultiCombo.Width = toNumber(div_width-2);
	PopDiv_MultiCombo.Height = Real_H + 26;  // // Real_H : Grid Height ::: 24 : Button 영역(여백포함) Height
	
	var btn_left = (toNumber(div_width-2)/2) - 68;
	
	var str_bk = 'expr:iif(checked_flag=="C","#f5f5f5","white")';
	var str_ed = 'expr:iif(checked_flag=="C","none","checkbox")';
	
	str_temp += '<Contents>';
	str_temp += '	<Grid AutoFit="TRUE" BindDataset="' + ngmv_objMCobDS.id + '" BkSelColor="#0a246a" BoldHead="true" Border="halfflat" Bottom="93" ColSelect="false" Editable="TRUE" Enable="true" EndLineColor="#919cb1" Height="' + Real_H + '" Id="grd_multi" InputPanel="FALSE" Left="2" MinWidth="100" Selcolor="white" TabOrder="1" TabStop="true" Top="1" UseSelColor="true" Visible="true" Width="' + toNumber(div_width-8) +'">';
	str_temp += '		<contents>';
	str_temp += '			<columns>';
	str_temp += '				<col fix="true" width="20"/>';
	str_temp += '				<col width="158"/>';
	str_temp += '			</columns>';
	str_temp += '			<body>';
	str_temp += '				<cell align="center" bkcolor=' + str_bk + ' col="0" colid="' + ngmv_Cobcheck + '" display="checkbox" edit=' + str_ed + '/>';
	str_temp += '				<cell col="1" bkcolor=' + str_bk + ' colid="' + ngmv_CobText + '" display="text"/>';
	str_temp += '			</body>';
	str_temp += '		</contents>';
	str_temp += '	</Grid>';
	str_temp += ' <Div Height="20" Id="Div_cob" Left="' + btn_left + '" Top="' + Real_T + '" Width="135">';
	str_temp += '   <contents>';
	str_temp += '		<button BKColor="#5379a0" ButtonStyle="TRUE" Color="white" Height="20" Id="btn_sel" ImageID="" Left="0" OnClick="ngmf_CobSelected" Style="btnStyle" TabOrder="2" Text="선택적용" Top="0" TopMargin="1" Width="64"></button>';
	str_temp += '		<button BKColor="#5379a0" ButtonStyle="TRUE" Color="white" Height="20" Id="btn_esc" ImageID="" Left="71" OnClick="ngmf_CobEscapeSel" Style="btnStyle" TabOrder="3" Text="선택해제" Top="0" TopMargin="1" Width="64"></button>';
	str_temp += '   </contents>';
	str_temp += ' </Div>';
	str_temp += '</Contents>';
	
	//alert(str_temp);
	return str_temp;
}

/*===============================================================
= 기능 : Multi Combo Close (공통)
===============================================================*/
function ngmf_CobSelected(){	
	ngmf_PopDivCobCloseUp();	
	PopDiv_MultiCombo.ClosePopup();
}

/*===============================================================
= 기능 : Multi Combo 선택 해제 (공통)
===============================================================*/
function ngmf_CobEscapeSel(){
	for (i=0; i<ngmv_objMCobDS.RowCount(); i++){
		if (ngmv_objMCobDS.GetColumn(i,"checked_flag") != "C")  ngmv_objMCobDS.SetColumn(i,ngmv_Cobcheck,"0");
	}
}

/*===============================================================
= 기능 : Multi Combo Close (공통)
===============================================================*/
function ngmf_PopDivCobCloseUp() {
	var str_cd = "";
	var str_txt = "";
		
	for (i=0; i<ngmv_objMCobDS.RowCount(); i++){
		if (ngmv_objMCobDS.getcolumn(i, ngmv_Cobcheck) == 1){
			str_cd += ngmv_objMCobDS.getcolumn(i,ngmv_CobCode) + ",";
			str_txt += ngmv_objMCobDS.getcolumn(i,ngmv_CobText) + ",";
		}
	}	
	
	if (toUpper(ngmv_CheckFlag) == "CODE" || toUpper(ngmv_CheckFlag) == "FIX") {
		ngmv_objMultiCob.value = left(str_txt,length(str_txt)-1);
		ngmv_returnVal = iif(length(str_cd) > 0, left(str_cd,length(str_cd)-1), "");	
	} else {
		ngmv_objMultiCob.value = left(str_cd,length(str_cd)-1);
	}
}
]]></Script>
</Window>