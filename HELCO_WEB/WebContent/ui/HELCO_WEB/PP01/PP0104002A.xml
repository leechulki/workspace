<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="562" Id="PP0104002A" Left="8" OnLoadCompleted="fn_OnLoadCompleted" OnUnloadCompleted="fn_OnUnloadCompleted" PidAttrib="7" Title="작업계획&#32;등록" Top="8" Ver="1.0" Width="978" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_cond">
				<Contents>
					<colinfo id="WKDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="WKBCD" size="256" summ="default" type="STRING"/>
					<colinfo id="WKDATS" size="256" summ="default" type="STRING"/>
					<colinfo id="WKDATE" size="256" summ="default" type="STRING"/>
					<colinfo id="WKMCD" size="256" summ="default" type="STRING"/>
					<colinfo id="WORKCNT" size="256" summ="default" type="STRING"/>
					<record>
						<WKBCD></WKBCD>
						<WKDAT></WKDAT>
						<WKDATE></WKDATE>
						<WKDATS></WKDATS>
						<WKMCD></WKMCD>
						<WORKCNT></WORKCNT>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_wkkcd_cd">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_wkbcd_cd">
				<Contents>
					<colinfo id="CODE" size="6" summ="default" type="STRING"/>
					<colinfo id="CODE2" size="30" summ="default" type="STRING"/>
					<colinfo id="CODE3" size="60" summ="default" type="STRING"/>
					<colinfo id="CODE4" size="60" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="60" summ="default" type="STRING"/>
					<colinfo id="CODE5" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE6" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_wktyp_cd">
				<Contents>
					<colinfo id="CODE" size="3" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="60" summ="default" type="STRING"/>
					<colinfo id="MEINS" size="9" summ="default" type="STRING"/>
					<colinfo id="TIMEE" size="12" summ="default" type="STRING"/>
					<colinfo id="TIMES" size="12" summ="default" type="STRING"/>
					<colinfo id="WKTIM" size="13" summ="default" type="DECIMAL"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_arbpl_cd">
				<Contents>
					<colinfo id="CODE" size="24" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="120" summ="default" type="STRING"/>
					<colinfo id="VERWE" size="12" summ="default" type="STRING"/>
					<colinfo id="WERKS" size="12" summ="default" type="STRING"/>
					<colinfo id="KTEXT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_block_cd">
				<Contents>
					<colinfo id="CODE" size="27" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="90" summ="default" type="STRING"/>
					<colinfo id="ITEM_NAM" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_zppdwkncd_cd">
				<Contents>
					<colinfo id="GUBUN1" size="256" summ="default" type="STRING"/>
					<colinfo id="GUBUN2" size="256" summ="default" type="STRING"/>
					<colinfo id="GUBUN1_TEXT" size="256" summ="default" type="STRING"/>
					<colinfo id="GUBUN2_TEXT" size="256" summ="default" type="STRING"/>
					<colinfo id="GUBUN1_NAM" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_etcwkncd_cd">
				<Contents>
					<colinfo id="GUBUN2" size="256" summ="default" type="STRING"/>
					<colinfo id="GUBUN1_NAM" size="256" summ="default" type="STRING"/>
					<record>
						<GUBUN1_NAM></GUBUN1_NAM>
						<GUBUN2>0</GUBUN2>
					</record>
					<record>
						<GUBUN1_NAM>근무중&#32;행사</GUBUN1_NAM>
						<GUBUN2>1</GUBUN2>
					</record>
					<record>
						<GUBUN1_NAM>근무중&#32;노조</GUBUN1_NAM>
						<GUBUN2>2</GUBUN2>
					</record>
					<record>
						<GUBUN1_NAM>근무중&#32;교육</GUBUN1_NAM>
						<GUBUN2>3</GUBUN2>
					</record>
					<record>
						<GUBUN1_NAM>기타</GUBUN1_NAM>
						<GUBUN2>4</GUBUN2>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list" OnColumnChanged="ds_list_OnColumnChanged" OnRowPosChanged="ds_list_OnRowPosChanged">
				<Contents>
					<colinfo id="ARBPL" size="24" summ="default" type="STRING"/>
					<colinfo id="CAPCD" size="30" summ="default" type="STRING"/>
					<colinfo id="CAPNM" size="105" summ="default" type="STRING"/>
					<colinfo id="CR_ID" size="30" summ="default" type="STRING"/>
					<colinfo id="CRDAT" size="24" summ="default" type="STRING"/>
					<colinfo id="CRTIM" size="18" summ="default" type="STRING"/>
					<colinfo id="FLAG" size="9" summ="default" type="STRING"/>
					<colinfo id="TIMEE" size="12" summ="default" type="STRING"/>
					<colinfo id="TIMES" size="12" summ="default" type="STRING"/>
					<colinfo id="WKBCD" size="6" summ="default" type="STRING"/>
					<colinfo id="WKDAT" size="24" summ="default" type="STRING"/>
					<colinfo id="WKKCD" size="3" summ="default" type="STRING"/>
					<colinfo id="WKMCD" size="30" summ="default" type="STRING"/>
					<colinfo id="WKMNM" size="105" summ="default" type="STRING"/>
					<colinfo id="WKTYP" size="3" summ="default" type="STRING"/>
					<colinfo id="TSUM" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="COCHK" size="3" summ="default" type="STRING"/>
					<colinfo id="ARBPLNM" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list_a" OnColumnChanged="ds_list_w_OnColumnchanged">
				<Contents>
					<colinfo id="FLAG" size="9" type="STRING"/>
					<colinfo id="WKWEK" size="1" type="STRING"/>
					<colinfo id="WKDAT" size="8" type="STRING"/>
					<colinfo id="ARBPL" size="24" type="STRING"/>
					<colinfo id="WKKCD" size="6" type="STRING"/>
					<colinfo id="WKTYP" size="6" type="STRING"/>
					<colinfo id="WKNCD" size="6" type="STRING"/>
					<colinfo id="NWKHR" size="7" type="DECIMAL"/>
					<colinfo id="WKNCONT" size="300" type="STRING"/>
					<colinfo id="WKDAT" size="8" type="STRING"/>
					<colinfo id="DISABLED" size="1" type="STRING"/>
					<colinfo id="WKBCD" size="6" type="STRING"/>
					<colinfo id="WKMCD" size="30" type="STRING"/>
					<colinfo id="WKDATIN" size="8" type="STRING"/>
					<colinfo id="WKDATS" size="8" type="STRING"/>
					<colinfo id="WKDATE" size="8" type="STRING"/>
					<colinfo id="WKMNM" size="105" type="STRING"/>
					<colinfo id="WKWEK" size="1" type="STRING"/>
					<colinfo id="CAPCD" size="30" type="STRING"/>
					<colinfo id="CAPNM" size="105" type="STRING"/>
					<colinfo id="WKDAY" size="24" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_wkmcd_cd">
				<Contents>
					<colinfo id="CODE" size="30" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="160" summ="default" type="STRING"/>
					<colinfo id="ROLNM" size="60" summ="default" type="STRING"/>
					<colinfo id="WKMNM" size="60" summ="default" type="STRING"/>
					<colinfo id="WKBCD" size="256" summ="default" type="STRING"/>
					<colinfo id="WKBNM" size="256" summ="default" type="STRING"/>
					<colinfo id="ARBPL" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_maxdat">
				<Contents>
					<colinfo id="MAXDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="WKBCD" size="256" summ="default" type="STRING"/>
					<colinfo id="WKDAT" size="256" summ="default" type="STRING"/>
					<record>
						<MAXDAT></MAXDAT>
						<WKBCD></WKBCD>
						<WKDAT></WKDAT>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_zrmon">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list_a_copy" OnColumnChanged="ds_list_w_OnColumnchanged">
				<Contents>
					<colinfo id="FLAG" size="9" summ="default" type="STRING"/>
					<colinfo id="WKWEK" size="1" summ="default" type="STRING"/>
					<colinfo id="WKDAT" size="8" summ="default" type="STRING"/>
					<colinfo id="ARBPL" size="24" summ="default" type="STRING"/>
					<colinfo id="WKKCD" size="6" summ="default" type="STRING"/>
					<colinfo id="WKTYP" size="6" summ="default" type="STRING"/>
					<colinfo id="WKNCD" size="6" summ="default" type="STRING"/>
					<colinfo id="NWKHR" size="7" summ="default" type="DECIMAL"/>
					<colinfo id="WKNCONT" size="300" summ="default" type="STRING"/>
					<colinfo id="DISABLED" size="1" summ="default" type="STRING"/>
					<colinfo id="WKBCD" size="6" summ="default" type="STRING"/>
					<colinfo id="WKMCD" size="30" summ="default" type="STRING"/>
					<colinfo id="WKDATIN" size="8" summ="default" type="STRING"/>
					<colinfo id="WKDATS" size="8" summ="default" type="STRING"/>
					<colinfo id="WKDATE" size="8" summ="default" type="STRING"/>
					<colinfo id="WKMNM" size="105" summ="default" type="STRING"/>
					<colinfo id="CAPCD" size="30" summ="default" type="STRING"/>
					<colinfo id="CAPNM" size="105" summ="default" type="STRING"/>
					<colinfo id="WKDAY" size="24" summ="default" type="STRING"/>
					<record>
						<ARBPL></ARBPL>
						<CAPCD></CAPCD>
						<CAPNM></CAPNM>
						<DISABLED></DISABLED>
						<FLAG></FLAG>
						<NWKHR/>
						<WKBCD></WKBCD>
						<WKDAT></WKDAT>
						<WKDATE></WKDATE>
						<WKDATIN></WKDATIN>
						<WKDATS></WKDATS>
						<WKDAY>월</WKDAY>
						<WKKCD></WKKCD>
						<WKMCD></WKMCD>
						<WKMNM></WKMNM>
						<WKNCD></WKNCD>
						<WKNCONT></WKNCONT>
						<WKTYP></WKTYP>
						<WKWEK></WKWEK>
					</record>
					<record>
						<ARBPL></ARBPL>
						<CAPCD></CAPCD>
						<CAPNM></CAPNM>
						<DISABLED></DISABLED>
						<FLAG></FLAG>
						<NWKHR/>
						<WKBCD></WKBCD>
						<WKDAT></WKDAT>
						<WKDATE></WKDATE>
						<WKDATIN></WKDATIN>
						<WKDATS></WKDATS>
						<WKDAY>화</WKDAY>
						<WKKCD></WKKCD>
						<WKMCD></WKMCD>
						<WKMNM></WKMNM>
						<WKNCD></WKNCD>
						<WKNCONT></WKNCONT>
						<WKTYP></WKTYP>
						<WKWEK></WKWEK>
					</record>
					<record>
						<ARBPL></ARBPL>
						<CAPCD></CAPCD>
						<CAPNM></CAPNM>
						<DISABLED></DISABLED>
						<FLAG></FLAG>
						<NWKHR/>
						<WKBCD></WKBCD>
						<WKDAT></WKDAT>
						<WKDATE></WKDATE>
						<WKDATIN></WKDATIN>
						<WKDATS></WKDATS>
						<WKDAY>수</WKDAY>
						<WKKCD></WKKCD>
						<WKMCD></WKMCD>
						<WKMNM></WKMNM>
						<WKNCD></WKNCD>
						<WKNCONT></WKNCONT>
						<WKTYP></WKTYP>
						<WKWEK></WKWEK>
					</record>
					<record>
						<ARBPL></ARBPL>
						<CAPCD></CAPCD>
						<CAPNM></CAPNM>
						<DISABLED></DISABLED>
						<FLAG></FLAG>
						<NWKHR/>
						<WKBCD></WKBCD>
						<WKDAT></WKDAT>
						<WKDATE></WKDATE>
						<WKDATIN></WKDATIN>
						<WKDATS></WKDATS>
						<WKDAY>목</WKDAY>
						<WKKCD></WKKCD>
						<WKMCD></WKMCD>
						<WKMNM></WKMNM>
						<WKNCD></WKNCD>
						<WKNCONT></WKNCONT>
						<WKTYP></WKTYP>
						<WKWEK></WKWEK>
					</record>
					<record>
						<ARBPL></ARBPL>
						<CAPCD></CAPCD>
						<CAPNM></CAPNM>
						<DISABLED></DISABLED>
						<FLAG></FLAG>
						<NWKHR/>
						<WKBCD></WKBCD>
						<WKDAT></WKDAT>
						<WKDATE></WKDATE>
						<WKDATIN></WKDATIN>
						<WKDATS></WKDATS>
						<WKDAY>금</WKDAY>
						<WKKCD></WKKCD>
						<WKMCD></WKMCD>
						<WKMNM></WKMNM>
						<WKNCD></WKNCD>
						<WKNCONT></WKNCONT>
						<WKTYP></WKTYP>
						<WKWEK></WKWEK>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_report">
				<Contents>
					<colinfo id="GUBUN" size="24" summ="default" type="STRING"/>
					<colinfo id="JAKUP1" size="24" summ="default" type="STRING"/>
					<colinfo id="JAKUP2" size="24" summ="default" type="STRING"/>
					<colinfo id="JAKUP3" size="24" summ="default" type="STRING"/>
					<colinfo id="JAKUP4" size="24" summ="default" type="STRING"/>
					<colinfo id="JAKUP5" size="24" summ="default" type="STRING"/>
					<colinfo id="JAKUP6" size="24" summ="default" type="STRING"/>
					<colinfo id="JAKUP7" size="24" summ="default" type="STRING"/>
					<colinfo id="JAKUP8" size="24" summ="default" type="STRING"/>
					<colinfo id="JAKUP9" size="24" summ="default" type="STRING"/>
					<colinfo id="JAKUP10" size="24" summ="default" type="STRING"/>
					<colinfo id="JAKUP11" size="24" summ="default" type="STRING"/>
					<colinfo id="JAKUP12" size="24" summ="default" type="STRING"/>
					<colinfo id="JAKUP13" size="24" summ="default" type="STRING"/>
					<record>
						<GUBUN>실작업</GUBUN>
						<JAKUP1></JAKUP1>
						<JAKUP10></JAKUP10>
						<JAKUP11></JAKUP11>
						<JAKUP12></JAKUP12>
						<JAKUP13></JAKUP13>
						<JAKUP2></JAKUP2>
						<JAKUP3></JAKUP3>
						<JAKUP4></JAKUP4>
						<JAKUP5></JAKUP5>
						<JAKUP6></JAKUP6>
						<JAKUP7></JAKUP7>
						<JAKUP8></JAKUP8>
						<JAKUP9></JAKUP9>
					</record>
					<record>
						<GUBUN>총인원</GUBUN>
						<JAKUP1></JAKUP1>
						<JAKUP10></JAKUP10>
						<JAKUP11></JAKUP11>
						<JAKUP12></JAKUP12>
						<JAKUP13></JAKUP13>
						<JAKUP2></JAKUP2>
						<JAKUP3></JAKUP3>
						<JAKUP4></JAKUP4>
						<JAKUP5></JAKUP5>
						<JAKUP6></JAKUP6>
						<JAKUP7></JAKUP7>
						<JAKUP8></JAKUP8>
						<JAKUP9></JAKUP9>
					</record>
					<record>
						<GUBUN>직접인원</GUBUN>
						<JAKUP1></JAKUP1>
						<JAKUP10></JAKUP10>
						<JAKUP11></JAKUP11>
						<JAKUP12></JAKUP12>
						<JAKUP13></JAKUP13>
						<JAKUP2></JAKUP2>
						<JAKUP3></JAKUP3>
						<JAKUP4></JAKUP4>
						<JAKUP5></JAKUP5>
						<JAKUP6></JAKUP6>
						<JAKUP7></JAKUP7>
						<JAKUP8></JAKUP8>
						<JAKUP9></JAKUP9>
					</record>
					<record>
						<GUBUN>지원인원</GUBUN>
						<JAKUP1></JAKUP1>
						<JAKUP10></JAKUP10>
						<JAKUP11></JAKUP11>
						<JAKUP12></JAKUP12>
						<JAKUP13></JAKUP13>
						<JAKUP2></JAKUP2>
						<JAKUP3></JAKUP3>
						<JAKUP4></JAKUP4>
						<JAKUP5></JAKUP5>
						<JAKUP6></JAKUP6>
						<JAKUP7></JAKUP7>
						<JAKUP8></JAKUP8>
						<JAKUP9></JAKUP9>
					</record>
					<record>
						<GUBUN>재적공수</GUBUN>
						<JAKUP1></JAKUP1>
						<JAKUP10></JAKUP10>
						<JAKUP11></JAKUP11>
						<JAKUP12></JAKUP12>
						<JAKUP13></JAKUP13>
						<JAKUP2></JAKUP2>
						<JAKUP3></JAKUP3>
						<JAKUP4></JAKUP4>
						<JAKUP5></JAKUP5>
						<JAKUP6></JAKUP6>
						<JAKUP7></JAKUP7>
						<JAKUP8></JAKUP8>
						<JAKUP9></JAKUP9>
					</record>
					<record>
						<GUBUN>휴업공수</GUBUN>
						<JAKUP1></JAKUP1>
						<JAKUP10></JAKUP10>
						<JAKUP11></JAKUP11>
						<JAKUP12></JAKUP12>
						<JAKUP13></JAKUP13>
						<JAKUP2></JAKUP2>
						<JAKUP3></JAKUP3>
						<JAKUP4></JAKUP4>
						<JAKUP5></JAKUP5>
						<JAKUP6></JAKUP6>
						<JAKUP7></JAKUP7>
						<JAKUP8></JAKUP8>
						<JAKUP9></JAKUP9>
					</record>
					<record>
						<GUBUN>휴업Loss율</GUBUN>
						<JAKUP1></JAKUP1>
						<JAKUP10></JAKUP10>
						<JAKUP11></JAKUP11>
						<JAKUP12></JAKUP12>
						<JAKUP13></JAKUP13>
						<JAKUP2></JAKUP2>
						<JAKUP3></JAKUP3>
						<JAKUP4></JAKUP4>
						<JAKUP5></JAKUP5>
						<JAKUP6></JAKUP6>
						<JAKUP7></JAKUP7>
						<JAKUP8></JAKUP8>
						<JAKUP9></JAKUP9>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_report_a">
				<Contents>
					<colinfo id="CODE" size="24" summ="default" type="STRING"/>
					<colinfo id="NAME" size="24" summ="default" type="STRING"/>
					<colinfo id="SILJAKUP" size="24" summ="default" type="STRING"/>
					<colinfo id="CHONGINWON" size="24" summ="default" type="STRING"/>
					<colinfo id="JIWONINWON" size="24" summ="default" type="STRING"/>
					<colinfo id="JIKJUBINWON" size="24" summ="default" type="STRING"/>
					<colinfo id="TOTINWON" size="24" summ="default" type="STRING"/>
					<colinfo id="JAEJUCKGONGSU" size="24" summ="default" type="STRING"/>
					<colinfo id="HUUPGONGSU" size="24" summ="default" type="STRING"/>
					<colinfo id="HUUPLOSS" size="24" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_title">
				<Contents>
					<colinfo id="title" size="256" summ="default" type="STRING"/>
					<colinfo id="planweek" size="256" summ="default" type="STRING"/>
					<colinfo id="work" size="256" summ="default" type="STRING"/>
					<colinfo id="mh" size="256" summ="default" type="STRING"/>
					<record>
						<title>생산1,2팀&#32;작업반&#32;별&#32;보유공수</title>
						<planweek></planweek>
						<workingday></workingday>
						<planweek>(단위:MH)</planweek>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_workChk" OnColumnChanged="ds_list_w_OnColumnchanged">
				<Contents>
					<colinfo id="WKDAT" size="8" summ="default" type="STRING"/>
					<record>
						<WKDAT></WKDAT>
					</record>
					<record>
						<WKDAT></WKDAT>
					</record>
					<record>
						<WKDAT></WKDAT>
					</record>
					<record>
						<WKDAT></WKDAT>
					</record>
					<record>
						<WKDAT></WKDAT>
					</record>
				</Contents>
			</Dataset>
		</Datasets>
		<Shape BKColor="user0" Bottom="30" Height="30" Id="Shape0" Left="0" LineColor="user1" Right="978" TabOrder="1" Top="0" Type="Rectangle" Width="978"></Shape>
		<Static Align="Right" Height="28" Id="st_date" Left="1" Style="sty_lb_search" TabOrder="2" Text="입력&#32;기한&#32;" Top="1" VAlign="Middle" Width="96"></Static>
		<Grid AutoFitEndLine="Hide" BindDataset="ds_list" BkColor2="default" BoldHead="true" Border="Flat" Bottom="552" ColSizing="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="468" Id="grd_list" InputPanel="FALSE" Left="11" LineColor="user20" LineType="ExHORZ" OnCellClick="grd_list_OnCellClick" OnCellPosChanged="grd_list_OnCellPosChanged" OnHeadClick="grd_list_OnHeadClick" Right="316" RowHeight="20" ScrollCell="true" Style="sty_grid" TabOrder="3" TabStop="true" Top="84" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="305">
			<contents>
				<format id="Default">
					<columns>
						<col width="25"/>
						<col width="102"/>
						<col width="75"/>
						<col width="83"/>
					</columns>
					<head>
						<cell bkimageid="icon_grid_sel" col="0" color="user21" display="text" font="굴림,9"/>
						<cell col="1" color="user21" display="text" font="굴림,9" text="작업반"/>
						<cell col="2" color="user21" display="text" font="굴림,9" text="사번"/>
						<cell col="3" color="user21" display="text" font="굴림,9" text="성명"/>
					</head>
					<body>
						<cell align="center" bkcolor2="user22" bkimageid='expr:gfn_getFlagBkImageID(getColumn(currow,&#32;&quot;FLAG&quot;))' col="0" display="text"/>
						<cell align="left" bkcolor2="user22" col="1" colid="WKBCD" combocol="CODE" combodataset="ds_wkbcd_cd" combotext="CODE_NAME" display="combo" suppress="1"/>
						<cell align="center" bkcolor2="user22" col="2" colid="WKMCD" display="text"/>
						<cell bkcolor2="user22" col="3" colid="WKMNM" display="text"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Grid BindDataset="ds_title" BkColor2="default" BoldHead="true" Bottom="816" Enable="true" EndLineColor="default" Height="64" Id="grd_title" InputPanel="FALSE" Left="16" LineColor="default" Right="1240" TabOrder="5" TabStop="true" Top="752" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="FALSE" VLineColor="default" WheelScrollRow="1" Width="1224">
			<contents>
				<format id="Default">
					<columns>
						<col width="90"/>
						<col width="90"/>
						<col width="90"/>
						<col width="90"/>
						<col width="90"/>
						<col width="90"/>
						<col width="90"/>
						<col width="90"/>
						<col width="90"/>
						<col width="90"/>
						<col width="90"/>
						<col width="90"/>
						<col width="90"/>
						<col width="90"/>
					</columns>
					<body>
						<cell align="center" bkcolor="white" col="0" colid="title" colspan="14" display="text" font="굴림,18,Bold"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Grid BindDataset="ds_title" BkColor2="default" BoldHead="true" Bottom="816" Enable="true" EndLineColor="default" Height="64" Id="grd_title2" InputPanel="FALSE" Left="16" LineColor="default" Right="1240" TabOrder="5" TabStop="true" Top="752" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="FALSE" VLineColor="default" WheelScrollRow="1" Width="1224">
			<contents>
				<format id="Default">
					<columns>
						<col width="90"/>
						<col width="90"/>
						<col width="90"/>
						<col width="90"/>
						<col width="90"/>
						<col width="90"/>
						<col width="90"/>
						<col width="90"/>
						<col width="90"/>
						<col width="90"/>
						<col width="90"/>
						<col width="90"/>
						<col width="90"/>
						<col width="90"/>
					</columns>
					<body>
						<cell align="left" bkcolor="white" col="0" colid="planweek" colspan="7" display="text" font="굴림,10,Bold"/>
						<cell align="left" bkcolor="white" col="7" colid="work" colspan="5" display="text" font="굴림,10"/>
						<cell align="right" bkcolor="white" col="12" colid="mh" colspan="2" display="text" font="굴림,10,Bold"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Static Align="Right" Height="28" Id="st_wkbcd" Left="576" Style="sty_lb_search" TabOrder="4" Text="작업반&#32;" Top="1" VAlign="Middle" Width="96"></Static>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="CODE" Column="WKBCD" DataColumn="CODE5" Height="20" Id="cb_wkbcd" InnerDataset="ds_wkbcd_cd" Left="674" OnCharChanged="cb_wkbcd_OnChanged" Style="sty_ipt_search_ind" TabOrder="5" Top="4" Width="191"></Combo>
		<Static Height="24" Id="st_man" Left="11" Style="sty_lb_form_group" TabOrder="6" Text="&#32;작업자&#32;" Top="60" VAlign="Middle" Width="305"></Static>
		<Shape BKColor="user12" Bottom="264" Height="176" Id="Shape7" Left="320" LineColor="user13" Right="963" TabOrder="6" Top="88" Type="Rectangle" Width="643"></Shape>
		<Static Height="24" Id="st_wk" Left="320" Style="sty_lb_form_group" TabOrder="8" Text="&#32;작업계획" Top="60" VAlign="Middle" Width="643"></Static>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_delWk" ImageID="btn_sub_05" Left="98" LeftMargin="12" OnClick="btn_delWk_OnClick" Style="sty_btn" TabOrder="9" TabStop="FALSE" Text="작업자&#32;삭제" Top="35" Transparent="TRUE" Visible="FALSE" Width="86"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_addWk" ImageID="btn_sub_05" Left="11" LeftMargin="12" OnClick="btn_addWk_OnClick" Style="sty_btn" TabOrder="10" TabStop="FALSE" Text="작업자&#32;생성" Top="35" Transparent="TRUE" Visible="FALSE" Width="85"></Button>
		<MaskEdit Align="Center" BKColor="user0" Border="Flat" Column="WKDAT" Height="20" Id="md_wkdat" InputPanel="FALSE" Left="104" Mask="####.##.##" OnChanged="md_wkdat_OnChanged" Readonly="TRUE" Style="sty_ipt_form" TabOrder="11" Top="5" Type="STRING" Value="MaskEdit0" Width="92"></MaskEdit>
		<Static Align="Right" Height="28" Id="Static0" Left="233" Style="sty_lb_search" TabOrder="12" Text="계획&#32;주간&#32;" Top="1" VAlign="Middle" Width="96"></Static>
		<Calendar BindDataset="ds_cond" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="pl_sdat" Left="332" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" OnChanged="cal_wkdat_OnChanged" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_search_ind" SundayTextColor="user35" TabOrder="13" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="4" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="97"></Calendar>
		<Static Align="Center" Border="None" Color="user7" Font="굴림,9" Height="20" Id="Static13" Left="432" TabOrder="14" Text="~" Top="5" VAlign="Middle" Width="18"></Static>
		<Grid AutoEnter="TRUE" AutoFitEndLine="Hide" BindDataset="ds_list_a" BkColor2="default" BoldHead="true" Border="Flat" Bottom="264" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="168" Id="grd_list_a" InputPanel="FALSE" Left="320" LineColor="user20" LineType="ExHORZ" OnCellClick="grd_list_a_OnCellClick" OnExpandEdit="grd_list_a_OnExpandEdit" Right="963" RowHeight="25" ScrollCell="true" Style="sty_grid" TabOrder="15" TabStop="true" Top="96" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="643">
			<contents>
				<format id="Default">
					<columns>
						<col width="25"/>
						<col width="35"/>
						<col width="145"/>
						<col width="55"/>
						<col width="95"/>
						<col width="83"/>
						<col width="40"/>
						<col width="160"/>
					</columns>
					<head>
						<cell col="0" display="text" rowspan="2">
							<cell bkimageid="icon_grid_sel" col="0" color="user21" display="text" font="굴림,9" rowspan="2"/>
						</cell>
						<cell col="1" display="text" rowspan="2">
							<cell col="0" color="user21" display="text" font="굴림,9" rowspan="2" text="요일"/>
						</cell>
						<cell col="2" display="text" rowspan="2">
							<cell col="0" color="user21" display="text" font="굴림,9" rowspan="2" text="작업장"/>
						</cell>
						<cell col="3" display="text" rowspan="2">
							<cell col="0" color="user21" display="text" font="굴림,9" rowspan="2" text="근태코드"/>
						</cell>
						<cell col="4" display="text" rowspan="2">
							<cell col="0" color="user21" display="text" font="굴림,9" rowspan="2" text="작업시간"/>
						</cell>
						<cell col="5" colspan="2" display="text">
							<cell col="0" color="user21" colspan="2" display="text" font="굴림,9" text="기타활동"/>
						</cell>
						<cell col="7" display="text" rowspan="2">
							<cell col="0" color="user21" display="text" font="굴림,9" rowspan="2" text="비고"/>
						</cell>
						<cell col="5" color="user21" display="text" font="굴림,9" row="1" text="선택"/>
						<cell col="6" color="user21" display="text" font="굴림,9" row="1" text="입력"/>
					</head>
					<body>
						<cell align="center" bkcolor='expr:iif(ds_list_a.getColumn(row,&quot;DISABLED&quot;)&#32;==&#32;&quot;1&quot;,&quot;user23&quot;,&quot;user22&quot;)' bkimageid='expr:gfn_getFlagBkImageID(getColumn(currow,&#32;&quot;FLAG&quot;))' col="0" display="text"/>
						<cell align="center" bkcolor='expr:iif(ds_list_a.getColumn(row,&quot;DISABLED&quot;)&#32;==&#32;&quot;1&quot;,&quot;user23&quot;,&quot;user22&quot;)' col="1" colid="WKDAY" display="text" font="굴림,9,Bold"/>
						<cell align="left" bkcolor='expr:iif(ds_list_a.getColumn(row,&quot;DISABLED&quot;)&#32;==&#32;&quot;1&quot;,&quot;user23&quot;,&quot;user22&quot;)' col="2" colid="ARBPL" combocol="CODE" combodataset="ds_arbpl_cd" combodisplayrowcnt="20" combotext="CODE_NAME" display='expr:iif&#32;((&#32;ds_list_a.getColumn(row,&quot;DISABLED&quot;)&#32;==&#32;&quot;0&quot;&#32;),&#32;&quot;combo&quot;,&#32;iif((&#32;ds_list_a.getColumn(row,&quot;DISABLED&quot;)&#32;==&#32;&quot;1&quot;),&quot;none&quot;,&quot;combo&quot;))' edit='expr:iif&#32;((&#32;ds_list_a.getColumn(row,&quot;DISABLED&quot;)&#32;==&#32;&quot;0&quot;&#32;),&#32;&quot;combo&quot;,&#32;iif((&#32;ds_list_a.getColumn(row,&quot;DISABLED&quot;)&#32;==&#32;&quot;1&quot;),&quot;none&quot;,&quot;combo&quot;))' expandimage="btn_icon_post" expandshow="true" expandsize="18"/>
						<cell align="left" bkcolor='expr:iif(ds_list_a.getColumn(row,&quot;DISABLED&quot;)&#32;==&#32;&quot;1&quot;,&quot;user23&quot;,&quot;user22&quot;)' col="3" colid="WKKCD" combocol="CODE" combodataset="ds_wkkcd_cd" combodisplayrowcnt="20" combotext="CODE_NAME" display="combo" edit='expr:iif&#32;((&#32;ds_list_a.getColumn(row,&quot;DISABLED&quot;)&#32;==&#32;&quot;0&quot;&#32;),&#32;&quot;combo&quot;,&#32;iif((&#32;ds_list_a.getColumn(row,&quot;DISABLED&quot;)&#32;==&#32;&quot;1&quot;),&quot;none&quot;,&quot;combo&quot;))' expandimage="btn_icon_post" expandshow="true" expandsize="18"/>
						<cell align="left" bkcolor='expr:iif(ds_list_a.getColumn(row,&quot;DISABLED&quot;)&#32;==&#32;&quot;1&quot;,&quot;user23&quot;,&quot;user22&quot;)' col="4" colid="WKTYP" combocol="CODE" combodataset="ds_wktyp_cd" combodisplayrowcnt="20" combotext="CODE_NAME" display="combo" edit='expr:iif&#32;((&#32;ds_list_a.getColumn(row,&quot;DISABLED&quot;)&#32;==&#32;&quot;0&quot;&#32;),&#32;&quot;combo&quot;,&#32;iif((&#32;ds_list_a.getColumn(row,&quot;DISABLED&quot;)&#32;==&#32;&quot;1&quot;),&quot;none&quot;,&quot;combo&quot;))' expandimage="btn_icon_post" expandshow="true" expandsize="18"/>
						<cell align="left" bkcolor='expr:iif(ds_list_a.getColumn(row,&quot;DISABLED&quot;)&#32;==&#32;&quot;1&quot;,&quot;user23&quot;,&quot;user22&quot;)' col="5" colid="WKNCD" combocol="GUBUN2" combodataset="ds_etcwkncd_cd" combodisplayrowcnt="20" combotext="GUBUN1_NAM" display="combo" edit='expr:iif&#32;((&#32;ds_list_a.getColumn(row,&quot;DISABLED&quot;)&#32;==&#32;&quot;0&quot;&#32;),&#32;&quot;combo&quot;,&#32;iif((&#32;ds_list_a.getColumn(row,&quot;DISABLED&quot;)&#32;==&#32;&quot;1&quot;),&quot;none&quot;,&quot;combo&quot;))' expandimage="btn_icon_post" expandshow="true" expandsize="18"/>
						<cell align="right" bkcolor='expr:iif(ds_list_a.getColumn(row,&quot;DISABLED&quot;)&#32;==&#32;&quot;1&quot;,&quot;user23&quot;,&quot;user22&quot;)' col="6" colid="NWKHR" display="text" edit='expr:iif&#32;((&#32;ds_list_a.getColumn(row,&quot;DISABLED&quot;)&#32;==&#32;&quot;0&quot;&#32;),&#32;&quot;number&quot;,&#32;iif((&#32;ds_list_a.getColumn(row,&quot;DISABLED&quot;)&#32;==&#32;&quot;1&quot;),&quot;none&quot;,&quot;none&quot;))'/>
						<cell align="left" bkcolor='expr:iif(ds_list_a.getColumn(row,&quot;DISABLED&quot;)&#32;==&#32;&quot;1&quot;,&quot;user23&quot;,&quot;user22&quot;)' col="7" colid="WKNCONT" display="text" edit='expr:iif&#32;((&#32;ds_list_a.getColumn(row,&quot;DISABLED&quot;)&#32;==&#32;&quot;0&quot;&#32;),&#32;&quot;normal&quot;,&#32;iif((&#32;ds_list_a.getColumn(row,&quot;DISABLED&quot;)&#32;==&#32;&quot;1&quot;),&quot;none&quot;,&quot;none&quot;))'/>
					</body>
				</format>
			</contents>
		</Grid>
		<Calendar BindDataset="ds_cond" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="pl_edat" Left="448" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" OnChanged="cal_wkdat_OnChanged" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_search_ind" SundayTextColor="user35" TabOrder="16" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="4" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="97"></Calendar>
		<Shape BKColor="user12" Bottom="552" Height="272" Id="Shape1" Left="320" LineColor="user13" Right="963" TabOrder="17" Top="280" Type="Rectangle" Width="643"></Shape>
		<Static BKColor="lightyellow" Font="굴림,9" Height="102" Id="st_info" Left="323" Style="sty_lb_form_group" TabOrder="18" Text="&#10;①&#32;기타&#32;항목은&#32;근무&#32;중&#32;발생&#32;예상되는&#32;비작업에&#32;대한&#32;사항이며,&#32;(정기&#32;휴식,&#32;조회는&#32;제외)&#10;&#32;&#32;&#32;&#32;선택항목에&#32;없는&#32;사항은&#32;기타&#32;선택&#32;후&#32;자유롭게&#32;기재&#32;가능&#10;&#10;②&#32;방법&#32;:&#32;항목선택&#32;-&gt;&#32;예상&#32;시간&#32;직접&#32;기입&#32;-&gt;&#32;기타&#32;선택&#32;시&#32;비고란에&#32;주요&#32;사항&#32;입력&#10;&#10;&#32;&#32;&#32;&#32;e.g.)&#32;8&#32;정상근무B&#32;(8H,&#32;8:30~17:30)&#32;&#32;&#32;/&#32;&#32;&#32;9&#32;정상근무C&#32;(4H,&#32;8:30~12:30)&#32;&#32;&#32;/&#32;&#32;&#32;2&#32;철야&#32;(10H,&#32;21:00~08:00)" Top="282" Width="637"></Static>
		<Edit BindDataset="ds_list" BKColor="user0" Border="Flat" Height="20" Id="ed_arbplcd" ImeMode="english" Left="448" LeftMargin="4" MaxLength="100" Readonly="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="19" TabStop="FALSE" Top="62" Visible="FALSE" Width="45"></Edit>
		<Edit BindDataset="ds_list" BKColor="user0" Border="Flat" Height="20" Id="ed_arbplnm" ImeMode="english" Left="504" LeftMargin="4" MaxLength="100" Readonly="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="20" TabStop="FALSE" Top="62" Visible="FALSE" Width="37"></Edit>
		<Static Align="Right" Height="24" Id="Static2" Left="696" Style="sty_lb_form_basic" TabOrder="21" Top="60" VAlign="Middle" Width="267"></Static>
		<Static Align="Right" Height="24" Id="st_wkjang" Left="696" Style="sty_lb_form_basic" TabOrder="24" Text="사번&#32;&#32;" Top="60" VAlign="Middle" Width="33"></Static>
		<Edit BindDataset="ds_list" BKColor="user0" Border="Flat" Height="20" Id="ed_wkmcd" ImeMode="english" Left="731" LeftMargin="4" MaxLength="100" Readonly="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="22" TabStop="FALSE" Top="62" Width="94"></Edit>
		<Static Align="Right" Height="24" Id="Static1" Left="827" Style="sty_lb_form_basic" TabOrder="25" Text="성명&#32;&#32;" Top="60" VAlign="Middle" Width="33"></Static>
		<Edit BindDataset="ds_list" BKColor="user0" Border="Flat" Height="20" Id="ed_wkmnm" ImeMode="english" Left="861" LeftMargin="4" MaxLength="100" Readonly="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="23" TabStop="FALSE" Top="62" Width="94"></Edit>
		<Grid AutoEnter="TRUE" AutoFitEndLine="Hide" BindDataset="ds_report" BkColor2="default" BoldHead="true" Border="Flat" Bottom="744" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="168" Id="grd_report" InputPanel="FALSE" Left="16" LineColor="user20" LineType="ExHORZ" OnCellClick="grd_list_a_OnCellClick" OnExpandEdit="grd_list_a_OnExpandEdit" Right="1240" RowHeight="25" ScrollCell="true" Style="sty_grid" TabOrder="15" TabStop="true" Top="576" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="FALSE" VLineColor="default" WheelScrollRow="1" Width="1224">
			<contents>
				<format id="Default">
					<columns>
						<col width="90"/>
						<col width="90"/>
						<col width="90"/>
						<col width="90"/>
						<col width="90"/>
						<col width="90"/>
						<col width="90"/>
						<col width="90"/>
						<col width="90"/>
						<col width="90"/>
						<col width="90"/>
						<col width="90"/>
						<col width="90"/>
						<col width="90"/>
					</columns>
					<head>
						<cell align="center" col="0" color="user21" display="text" font="굴림,9" rowspan="3" text="구분"/>
						<cell align="center" col="1" color="user21" colspan="6" display="text" font="굴림,9" rowspan="1" text="생산1팀"/>
						<cell align="center" col="7" color="user21" colspan="6" display="text" font="굴림,9" rowspan="1" text="생산2팀"/>
						<cell align="center" col="13" color="user21" display="text" font="굴림,9" rowspan="3" text="합계"/>
						<cell col="1" color="user21" display="text" font="굴림,9" row="1" rowspan="2" text="판금가공"/>
						<cell col="2" color="user21" display="text" font="굴림,9" row="1" rowspan="2" text="도어오퍼"/>
						<cell col="3" color="user21" display="text" font="굴림,9" row="1" rowspan="2" text="특수의장"/>
						<cell col="4" color="user21" colspan="3" display="text" font="굴림,9" row="1" text="판금조립"/>
						<cell col="7" color="user21" display="text" font="굴림,9" row="1" rowspan="2" text="기계가공"/>
						<cell col="8" color="user21" display="text" font="굴림,9" row="1" rowspan="2" text="TM조립1"/>
						<cell col="9" color="user21" display="text" font="굴림,9" row="1" rowspan="2" text="TM조립2"/>
						<cell col="10" color="user21" display="text" font="굴림,9" row="1" rowspan="2" text="TM조립3"/>
						<cell col="11" color="user21" display="text" font="굴림,9" row="1" rowspan="2" text="CP"/>
						<cell col="12" color="user21" display="text" font="굴림,9" row="1" rowspan="2" text="INVERTER"/>
						<cell col="4" color="user21" display="text" font="굴림,9" row="2" text="PE"/>
						<cell col="5" color="user21" display="text" font="굴림,9" row="2" text="CE"/>
						<cell col="6" color="user21" display="text" font="굴림,9" row="2" text="장비"/>
					</head>
					<body>
						<cell align="center" bkcolor2="user22" col="0" colid="GUBUN" display="text"/>
						<cell align="right" bkcolor2="user22" col="1" colid="JAKUP1" display="text"/>
						<cell align="right" bkcolor2="user22" col="2" colid="JAKUP2" display="text"/>
						<cell align="right" bkcolor2="user22" col="3" colid="JAKUP3" display="text"/>
						<cell align="right" bkcolor2="user22" col="4" colid="JAKUP4" display="text"/>
						<cell align="right" bkcolor2="user22" col="5" colid="JAKUP5" display="text"/>
						<cell align="right" bkcolor2="user22" col="6" colid="JAKUP6" display="text"/>
						<cell align="right" bkcolor2="user22" col="7" colid="JAKUP7" display="text"/>
						<cell align="right" bkcolor2="user22" col="8" colid="JAKUP8" display="text"/>
						<cell align="right" bkcolor2="user22" col="9" colid="JAKUP9" display="text"/>
						<cell align="right" bkcolor2="user22" col="10" colid="JAKUP10" display="text"/>
						<cell align="right" bkcolor2="user22" col="11" colid="JAKUP11" display="text"/>
						<cell align="right" bkcolor2="user22" col="12" colid="JAKUP12" display="text"/>
						<cell align="right" bkcolor2="user22" col="13" colid="JAKUP13" display="text"/>
					</body>
				</format>
			</contents>
		</Grid>
		<FileDialog Bottom="34" Height="24" Id="FileDialog0" Left="293" Right="317" TabOrder="2" Top="10" Width="24"></FileDialog>
	</Form>
	<Script><![CDATA[﻿﻿﻿﻿﻿﻿/*
 ******************************************************************************************
 * 기      능   : 생산 작업반 반장이 작업계획을 등록
 * 작  성  자   : 
 * 작성  일자   : 2020.07
 * ----------------------------------------------------------------------------------------
 * HISTORY    :

 ******************************************************************************************
 */
#include "LIB::commons.js";	// 공통 스크립트 
#include "LIB::common_cs.js";	// 서비스 스크립트
#include "LIB::grid_script.js";	// 서비스 스크립트
//=========================================================================================
// [ PART 1 ]
// Form에서 사용될 전역변수를 선언
// FORM에서 사용되는 전역변수는 대문자로 작성하며, F_XXX 의 형태를 갖도록 한다. 
//=========================================================================================

//=========================================================================================
// [ PART 2 ]
// Form Loading / Unloading 시 작업 정의
//=========================================================================================
function fn_OnLoadCompleted(obj) {
	// Form 로드 이벤트 맨 첫줄에 기술 
	gfn_initForm();
	// 현재 조회 일자 설정 
	//cal_wkdat.value = gfn_getCurrDate();

	var nDay = GetDay(gfn_getCurrDate());
	
	var plusDay;
	if(nDay == 0)
		plusDay = 5;
	else if(nDay == 1)
		plusDay = 4;
	else if(nDay == 2)	
		plusDay = 3;
	else if(nDay == 3)
		plusDay = 2;
	else if(nDay == 4)	
		plusDay = 1;
	else if(nDay == 5)
		plusDay = 0;
	else if(nDay == 6)	
		plusDay = -1;		
	md_wkdat.Value = gfn_getAfterDate(gfn_getCurrDate(), plusDay); // 입력기한 설정  

	pl_sdat.Value = gfn_getAfterDate(md_wkdat.Value, 10);
	pl_edat.Value = gfn_getAfterDate(md_wkdat.Value, 14);

		
	if(g_user_id == "2001969" || g_user_id == "2001918" || g_user_id == "2003465"|| g_user_id == "2031205"|| g_user_id == "2020254"|| g_user_id == "2013400" || g_user_id == "2011255"|| g_user_id == "HF300A06"|| g_user_id == "2017652" || g_user_id == "2031400")
	{
		ufn_enableBtn("excel", true);
	} 
	else 
	{
		ufn_enableBtn("excel", false);
	}
	
	
	

	tit_clearActionInfo();

	tit_addSearchActionInfo("pp01:PP0104002A_S1");	// 작업반 조회	 ds_wkbcd_cd
	tit_addSearchActionInfo("pp01:PP0104002A_S2");	// 작업시간 유형 조회 ds_wktyp_cd
	tit_addSearchActionInfo("pp01:PP0104001A_S3");	// 근태입력 작업장 조회 ds_arbpl_cd
	tit_addSearchActionInfo("pp01:PP0104001A_S4");	// 작업일보 등록 bock조회 ds_block_cd
	tit_addSearchActionInfo("pp01:PP0104002A_S5");	// 작업일보 비작업 코드조회 ds_zppdwkncd_cd
	tit_addSearchActionInfo("pp01:PP0104001A_S11");	// 작업일보 등록 근태코드조회 ds_wkkcd_cd

	tit_callService(
        ""
        , ""
        , ""
        , "ds_wkkcd_cd=ds_wkkcd_cd ds_wkbcd_cd=ds_wkbcd_cd ds_wktyp_cd=ds_wktyp_cd ds_arbpl_cd=ds_arbpl_cd ds_block_cd=ds_block_cd ds_zppdwkncd_cd=ds_zppdwkncd_cd"
        , ""
        , "fn_afterCombo"
        , true
        , true);
	
	gfn_showMsg("CI00007");
}

function fn_afterCombo()
{
	//  작업반 설정 
	cb_wkbcd.Index = 0;//ds_wkbcd_cd.RowCount;	

	//  작업반장 설정 
	//cb_wkmcd.Index = ds_wkbcd_cd.RowCount;	

	ds_wktyp_cd.insertRow(0);
	ds_wktyp_cd.setColumn(0, "CODE", "");
	ds_wktyp_cd.setColumn(0, "CODE_NAME", "");
	ds_wktyp_cd.setColumn(0, "MEINS", "");
	ds_wktyp_cd.setColumn(0, "TIMEE", "");
	ds_wktyp_cd.setColumn(0, "TIMES", "");
	ds_wktyp_cd.setColumn(0, "WKTIM", 0);
	
	//st_info.Text = "";
	
	ds_wkkcd_cd.insertRow(0);
	ds_wkkcd_cd.setColumn(0, "CODE", "");
	ds_wkkcd_cd.setColumn(0, "CODE_NAME", "");
	
	

}
/********************************************************************************
* 기      능   : 공통코드가 조회된 후의 Callback 함수 
********************************************************************************/
function fn_completeInit(sCode, sDsObj, sCodeType) {
}
/********************************************************************************
* 기      능   : form UnloadCompleted 
********************************************************************************/
function fn_OnUnloadCompleted(obj) {
	return gfn_isFormUnload(obj);
}
//=========================================================================================
// [ PART 3 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,form닫기)
//=========================================================================================

/********************************************************************************
* 기      능   : 조회
********************************************************************************/
function fn_query() {
	// 필수 입력사항 및 일자 체크 
	if ( gfn_isNull(pl_sdat, true) ) {
		gfn_showMsg("CW00001","계획주간 시작일자");
		return;
	}
	if ( gfn_isNull(pl_edat, true) ) {
		gfn_showMsg("CW00001","계획주간 종료일자");
		return;
	}
	
	
	if(GetDay(pl_sdat.Value) != 1){
		gfn_showInform("CW10025", "계획주간 시작일자를 월요일로 선택하세요.");		
		return;
	}
	
	if( pl_sdat.Value == "20201130" and pl_edat.Value == "20201130" );
	else if( gfn_getAfterDate(pl_sdat.Value, 4) != pl_edat.Value )
	{
		gfn_showInform("CW10025", "계획주간은 일주일 단위로 월요일부터 금요일까지 입니다.");		
		return;
	}
	
	
	if ( !gfn_checkDate( pl_sdat.value, pl_edat.value, true, pl_edat) ) {
		return;
	}
	
	
	if ( gfn_isNull(cb_wkbcd, true) ) {
		gfn_showMsg("CW00001","작업반");
		return;
	}	
	
	
	ed_arbplcd.Text = '';
	ed_arbplnm.Text = '';
	ed_wkmcd.Text = '';
	ed_wkmnm.Text = '';
	
	ds_list.ClearData();
	//ds_list_a.ClearData();
	
	
	// sort mark 삭제 
	gfn_clearGridSortMark(grd_list);
	

	tit_clearActionInfo();

	tit_addSearchActionInfo("pp01:PP0104002A_S6");	
	//tit_addSearchActionInfo("pp01:PP0104001A_S7");	
	//tit_addSearchActionInfo("pp01:PP0104001A_S8");	
	//tit_addSearchActionInfo("pp01:PP0104001A_S9");	
	//tit_addSearchActionInfo("pp01:PP0104001A_S12");	
	tit_addSearchActionInfo("pp01:PP0104002A_S9");	
	
	ds_cond.SetColumn(0, "WKMCD", HWKMCD);
	ds_cond.SetColumn(0, "WKDATS", pl_sdat.Value);
	ds_cond.SetColumn(0, "WKDATE", pl_edat.Value);
	ds_cond.SetColumn(0, "WORKCNT", getWorkingDayCount());
	
	
	//trace(ds_cond.savexml());
	tit_callService(
		""
		, ""
		, "ds_cond=ds_cond"
		//, "ds_list=ds_list ds_list_a=ds_list_a ds_list_b=ds_list_b ds_wkmcd_cd=ds_wkmcd_cd ds_zrmon=ds_zrmon"
		, "ds_list=ds_list ds_report_a=ds_report_a"
		, ""
		, "fn_afterQuery"
		, true);

}

/********************************************************************************
* 기      능   : 작업일보 등록
********************************************************************************/
function fn_save() {
    // Message 영역 초기화
	global.FRM_BOTTOM.img_msgType.imageId = "";
	global.FRM_BOTTOM.st_msg.value = "";
	
	/*
	//월 마감시 비활성화 
	if ( ds_zrmon.GetColumn(0,"CODE") == "X"  ) {
		gfn_showAlert("CW10025", "당월 마감으로 저장 불가");
		return;
	}
	*/
	
	
    //변경값 확인
	if ( !gfn_isChangeDs(ds_list_a, false) ) {
		gfn_showAlert("CW00005");
		return;
	}
    	
    	// 필수 입력사항 및 일자 체크 
	if ( gfn_isNull(pl_sdat, true) ) {
		gfn_showMsg("CW00001","계획주간 시작일자");
		return;
	}
	if ( gfn_isNull(pl_edat, true) ) {
		gfn_showMsg("CW00001","계획주간 종료일자");
		return;
	}
	
	
	if(GetDay(pl_sdat.Value) != 1){
		gfn_showInform("CW10025", "계획주간 시작일자를 월요일로 선택하세요.");		
		return;
	}
	
	if (pl_sdat.Value == "20201130" and pl_edat.Value == "20201130");
	else if( gfn_getAfterDate(pl_sdat.Value, 4) != pl_edat.Value)
	{
		gfn_showInform("CW10025", "계획주간은 일주일 단위로 월요일부터 금요일까지 입니다.");		
		return;
	}
	
	
	if ( !gfn_checkDate( pl_sdat.value, pl_edat.value, true, pl_edat) ) {
		return;
	}	
	
	//  데이터 check
	for (var i =0; i < ds_list_a.rowcount; i++)
	{
	    
			//trace(ds_list.GetColumn(i, "WKMNM"));
			//trace(length(ds_list.GetColumn(i,"FLAG")));
			//trace(parseFloat(ds_list.GetColumn(i, "TSUM")));
			//trace(parseFloat(ds_wktyp_cd.GetColumn(ds_wktyp_cd.FindRow("CODE",ds_list.GetColumn(i, "WKTYP")),"WKTIM")));
			/*
			// 승인 이후는 수정 금지 2012.10.22 hss
			if (length(ds_list.GetColumn(i,"FLAG")) > 0 && ds_list.GetColumn(i,"COCHK") == "X")
			{
				gfn_showAlert("CW00240", "[ "+ds_list.GetColumn(i,"WKMNM") + " ]");
				ds_list.rowpos = i;
				return;
			}
			*/
							
				if(length(trim(ed_wkmcd.text)) == "0")
				//if(length(ds_list.GetColumn(i,"WKMCD")) < 1 || length(ds_list.GetColumn(i,"WKMNM")) < 1)
				{
					gfn_showAlert("CW00001","작업자");
					ds_list.rowpos = i;
					return;
				}
				if(length(ds_list_a.GetColumn(i,"ARBPL")) < 1)
				{
					gfn_showAlert("CW00001","작업장");
					ds_list.rowpos = i;
					return;
				}
				
	
				
				if(length(ds_list_a.GetColumn(i,"WKKCD")) < 1 && length(ds_list_a.GetColumn(i,"WKTYP")) < 1)
				{
					gfn_showAlert("CW00001","작업시간 유형");
					ds_list.rowpos = i;
					return;
				} 				
	
				 //근태코드 입력 시 작업시간 입력되면 경고 20.04.23				 
				if(length(ds_list_a.GetColumn(i,"WKKCD")) > 0 && length(ds_list_a.GetColumn(i,"WKTYP")) > 0)
				{
					gfn_showAlert("CW10025", "근태코드 입력시 작업시간 입력 불가");
					ds_list.rowpos = i;
					return;
				}				
			
		
			//var lv_wkdate = gfn_getWorkingDate_pp(0,"1000",ds_list_a.GetColumn(0,"WKDAT"));
			
			
			//trace("!!"+lv_wkdate);
			//trace(ds_list.savexml());
			//trace("!"+gfn_getWorkingDate(0,"1000",ds_list.GetColumn(0,"WKDAT")));
			
			 
			// if ( ds_list.GetColumn(0,"WKDAT") != lv_wkdate ) { //작업일이 워킹데이가 아니면 
				// gfn_showAlert("CW10025", "주말에 주중 작업시간유형 2, 7, 8, 9, C, D, E 입력 불가");
				// return;
			// }
	
		
	}	
	/*
	var wkbcd_check = "08|10";
	for (var i =0; i < ds_list_a.rowcount; i++)
	{
		if (ds_list_a.GetColumn(i,"FLAG") != "D")
		{
			if(length(ds_list_a.GetColumn(i,"BLOCK_NO")) < 1)
			{
				gfn_showAlert("CW00001","BLOCK_NO");
				ds_list.rowpos = ds_list.FindRow("WKMCD",ds_list_a.GetColumn(i,"WKMCD"));
				return;
			}
			if(length(ds_list_a.GetColumn(i,"ARBPL")) < 1)
			{
				gfn_showAlert("CW00001","작업장");
				ds_list.rowpos = ds_list.FindRow("WKMCD",ds_list_a.GetColumn(i,"WKMCD"));
				return;
			}
			
			//  특정 작업반의 경우 wbs 필수 입력  2012.10.22 hss
			if(IndexOf(wkbcd_check,ds_list_a.GetColumn(i,"WKBCD")) > 0 && length(ds_list_a.GetColumn(i,"POSID")) < 1)
			{
				gfn_showAlert("CW00241","[ "+ds_list.GetColumn(ds_list.FindRow("WKMCD",ds_list_a.GetColumn(i,"WKMCD")),"WKMNM") + " ]");
				ds_list.rowpos = ds_list.FindRow("WKMCD",ds_list_a.GetColumn(i,"WKMCD"));
				return;
			}
		}
	}	
	*/

	
	
	
	for (var i =0; i < ds_list_a.rowcount; i++)
	{	
		if( length(trim(ds_list_a.GetColumn(i,"NWKHR")))  == 0)
		{
			ds_list_a.SetColumn(i,"NWKHR",0);
		}			
		
		// 작업장 설정
		if( ds_list_a.getcolumn(i, "DISABLED") == "0")
		{
			ds_list_a.SetColumn(i, "ARBPL", ds_list_a.GetColumn(i,"ARBPL"));	
		}
		else
		{
			ds_list_a.SetColumn(i, "ARBPL", ed_arbplcd.Text);	
		}		
		
	}
	
    

	
	if (!gfn_showConfirm("CI10003")) {
		return;
	}


	
		
    //trace(ds_list_a.SaveXML());



	// 저장 처리 
	tit_clearActionInfo();
	tit_addSelectExActionInfo(
	    "pp01:PP0104002A_S8"
	   ,"pp01:PP0104002A_I1"
	   ,"pp01:PP0104002A_U1");

	//  call 서비스에서 commit실행하여 commit 필요없음.

	tit_callService(
        ""
        , ""
        , "ds_list_a=ds_list_a"
        , ""
        , ""
        , "fn_afterSave");




/*

	tit_clearActionInfo();

	// 저장 처리 
	tit_addSaveActionInfo(
	"pp01:PP0104002A_U1"
	, "pp01:PP0104002A_U1"
	, "pp01:PP0104002A_D1"
	, "FLAG"
	, ""
	, -1
	, "");
	




//	tit_showDs(ds_list);
	// 저장 처리 
    //trace(ds_list.savexml());
    //trace(ds_list_a.savexml());
    //trace(ds_list_b.savexml());
	tit_callService(
		""
		, ""
		, "ds_list_a=ds_list_a:A"
		, ""
		, ""
		, "fn_afterSave");
*/		
}




function fn_save2() {


	if( replace(pl_edat.Value, '.', '') < replace(md_wkdat.Text, '.', ''))		
	{
		return;
	}
    // Message 영역 초기화
	global.FRM_BOTTOM.img_msgType.imageId = "";
	global.FRM_BOTTOM.st_msg.value = "";
	
	/*
	//월 마감시 비활성화 
	if ( ds_zrmon.GetColumn(0,"CODE") == "X"  ) {
		gfn_showAlert("CW10025", "당월 마감으로 저장 불가");
		return;
	}
	*/
    //변경값 확인
	if ( !gfn_isChangeDs(ds_list_a, false) ) {
		//gfn_showAlert("CW00005");
		return;
	}
    	
    	// 필수 입력사항 및 일자 체크 
	if ( gfn_isNull(pl_sdat, true) ) {
		//gfn_showMsg("CW00001","계획주간 시작일자");
		return;
	}
	if ( gfn_isNull(pl_edat, true) ) {
		//gfn_showMsg("CW00001","계획주간 종료일자");
		return;
	}
	
	
	if(GetDay(pl_sdat.Value) != 1){
		//gfn_showInform("CW10025", "계획주간 시작일자를 월요일로 선택하세요.");		
		return;
	}
	
	if( pl_sdat.Value == "20201130" and pl_edat.Value == "20201130" )
	else if( gfn_getAfterDate(pl_sdat.Value, 4) != pl_edat.Value )
	{
		//gfn_showInform("CW10025", "계획주간은 일주일 단위로 월요일부터 일요일까지 입니다.");		
		return;
	}
	
	
	if ( !gfn_checkDate( pl_sdat.value, pl_edat.value, true, pl_edat) ) {
		return;
	}	
	
	//  데이터 check
	for (var i =0; i < ds_list_a.rowcount; i++)
	{
	    
			//trace(ds_list.GetColumn(i, "WKMNM"));
			//trace(length(ds_list.GetColumn(i,"FLAG")));
			//trace(parseFloat(ds_list.GetColumn(i, "TSUM")));
			//trace(parseFloat(ds_wktyp_cd.GetColumn(ds_wktyp_cd.FindRow("CODE",ds_list.GetColumn(i, "WKTYP")),"WKTIM")));
			/*
			// 승인 이후는 수정 금지 2012.10.22 hss
			if (length(ds_list.GetColumn(i,"FLAG")) > 0 && ds_list.GetColumn(i,"COCHK") == "X")
			{
				gfn_showAlert("CW00240", "[ "+ds_list.GetColumn(i,"WKMNM") + " ]");
				ds_list.rowpos = i;
				return;
			}
			*/
							
				if(length(trim(ed_wkmcd.text)) == "0")
				//if(length(ds_list.GetColumn(i,"WKMCD")) < 1 || length(ds_list.GetColumn(i,"WKMNM")) < 1)
				{
					//gfn_showAlert("CW00001","작업자");
					//ds_list.rowpos = i;
					return;
				}
				if(length(ds_list_a.GetColumn(i,"ARBPL")) < 1)
				{
					//gfn_showAlert("CW00001","작업장");
					//ds_list.rowpos = i;
					return;
				}
				
	
				
				if(length(ds_list_a.GetColumn(i,"WKKCD")) < 1 && length(ds_list_a.GetColumn(i,"WKTYP")) < 1)
				{
					//gfn_showAlert("CW00001","작업시간 유형");
					//ds_list.rowpos = i;
					return;
				} 				
	
				 //근태코드 입력 시 작업시간 입력되면 경고 20.04.23				 
				if(length(ds_list_a.GetColumn(i,"WKKCD")) > 0 && length(ds_list_a.GetColumn(i,"WKTYP")) > 0)
				{
					//gfn_showAlert("CW10025", "근태코드 입력시 작업시간 입력 불가");
					//ds_list.rowpos = i;
					return;
				}				
			
		
			//var lv_wkdate = gfn_getWorkingDate_pp(0,"1000",ds_list_a.GetColumn(0,"WKDAT"));
			
			
			//trace("!!"+lv_wkdate);
			//trace(ds_list.savexml());
			//trace("!"+gfn_getWorkingDate(0,"1000",ds_list.GetColumn(0,"WKDAT")));
			
			 
			// if ( ds_list.GetColumn(0,"WKDAT") != lv_wkdate ) { //작업일이 워킹데이가 아니면 
				// gfn_showAlert("CW10025", "주말에 주중 작업시간유형 2, 7, 8, 9, C, D, E 입력 불가");
				// return;
			// }
	
		
	}	
	/*
	var wkbcd_check = "08|10";
	for (var i =0; i < ds_list_a.rowcount; i++)
	{
		if (ds_list_a.GetColumn(i,"FLAG") != "D")
		{
			if(length(ds_list_a.GetColumn(i,"BLOCK_NO")) < 1)
			{
				gfn_showAlert("CW00001","BLOCK_NO");
				ds_list.rowpos = ds_list.FindRow("WKMCD",ds_list_a.GetColumn(i,"WKMCD"));
				return;
			}
			if(length(ds_list_a.GetColumn(i,"ARBPL")) < 1)
			{
				gfn_showAlert("CW00001","작업장");
				ds_list.rowpos = ds_list.FindRow("WKMCD",ds_list_a.GetColumn(i,"WKMCD"));
				return;
			}
			
			//  특정 작업반의 경우 wbs 필수 입력  2012.10.22 hss
			if(IndexOf(wkbcd_check,ds_list_a.GetColumn(i,"WKBCD")) > 0 && length(ds_list_a.GetColumn(i,"POSID")) < 1)
			{
				gfn_showAlert("CW00241","[ "+ds_list.GetColumn(ds_list.FindRow("WKMCD",ds_list_a.GetColumn(i,"WKMCD")),"WKMNM") + " ]");
				ds_list.rowpos = ds_list.FindRow("WKMCD",ds_list_a.GetColumn(i,"WKMCD"));
				return;
			}
		}
	}	
	*/

	
	
	
	for (var i =0; i < ds_list_a.rowcount; i++)
	{	
		if( length(trim(ds_list_a.GetColumn(i,"NWKHR")))  == 0)
		{
			ds_list_a.SetColumn(i,"NWKHR",0);
		}	
		
		// 작업장 설정
		if( ds_list_a.getcolumn(i, "DISABLED") == "0")
		{
			ds_list_a.SetColumn(i, "ARBPL", ds_list_a.GetColumn(i,"ARBPL"));	
		}
		else
		{
			ds_list_a.SetColumn(i, "ARBPL", ed_arbplcd.Text);	
		}		
		
	}
	
    

	/*
	if (!gfn_showConfirm("CI10003")) {
		return;
	}
	*/

	
		
    //trace(ds_list_a.SaveXML());



	// 저장 처리 
	tit_clearActionInfo();
	tit_addSelectExActionInfo(
	    "pp01:PP0104002A_S8"
	   ,"pp01:PP0104002A_I1"
	   ,"pp01:PP0104002A_U1");

	//  call 서비스에서 commit실행하여 commit 필요없음.

	tit_callService(
        ""
        , ""
        , "ds_list_a=ds_list_a"
        , ""
        , ""
        , "");




/*

	tit_clearActionInfo();

	// 저장 처리 
	tit_addSaveActionInfo(
	"pp01:PP0104002A_U1"
	, "pp01:PP0104002A_U1"
	, "pp01:PP0104002A_D1"
	, "FLAG"
	, ""
	, -1
	, "");
	




//	tit_showDs(ds_list);
	// 저장 처리 
    //trace(ds_list.savexml());
    //trace(ds_list_a.savexml());
    //trace(ds_list_b.savexml());
	tit_callService(
		""
		, ""
		, "ds_list_a=ds_list_a:A"
		, ""
		, ""
		, "fn_afterSave");
*/		
}


/********************************************************************************
* 기      능   : 취소  
********************************************************************************/
function fn_cancel() {
	ds_list.reset();
	ds_list_a.reset();

}



/********************************************************************************
* 기      능   : 닫기  
********************************************************************************/
function fn_close() {
	close();
}
/********************************************************************************
* 기      능   : 액셀  
********************************************************************************/

//=========================================================================================
// [ PART 4]
// Callback 함수 정의 : callback 함수명은 메인 함수의 fn_xxxx() 에서 xxxx 부분은 fn_afterXXXX()
// 형태가 되도록 작성 
//=========================================================================================
/********************************************************************************
* 기      능   : 조회 Callback  
********************************************************************************/
function fn_afterQuery(errCode, errMsg) {
	// 메시지 처리 
	gfn_showSearchMsg(grd_list, errCode, errMsg);
    ds_list_a.ClearData();
    
    
    if( replace(pl_edat.Value, '.', '') < replace(md_wkdat.Text, '.', ''))		
	{
		if(g_user_id == "2001969" || g_user_id == "2001918" || g_user_id == "2003465" || g_user_id == "2031205" || g_user_id == "2020254"|| g_user_id == "2013400")
		{
			ufn_enableBtn("save", true);
		}
		else
		{
			ufn_enableBtn("save", false);
		}
	} 
	else 
	{
		ufn_enableBtn("save", true);
	}
	

    /*
	if (errCode == 0 && ds_list.RowCount() > 0)
	{
		btn_addWk.Enable = true;
		btn_delWk.Enable = true;
				
		ds_list.row = 0;
		ds_list_a.Filter("WKMCD == "+quote(ds_list.GetColumn(0,"WKMCD")));
		ds_list_b.Filter("WKMCD == "+quote(ds_list.GetColumn(0,"WKMCD")));
				
		set_Tsum();
		
		ds_wkmcd_cd.AddRow();
	}	
	//trace(ds_list.savexml());
		//  데이터 check
	for (var i =0; i < ds_list.rowcount; i++)
	{
	    if (ds_list.GetColumn(i,"FLAG") != "D")
		{	    
		    //trace(parseFloat(ds_list.GetColumn(i, "TSUM")));
			//trace(parseFloat(ds_wktyp_cd.GetColumn(ds_wktyp_cd.FindRow("CODE",ds_list.GetColumn(i, "WKTYP")),"WKTIM")));
			
			//작업시간 <>  실작업 + 비작업 경고 20.04.23						
			if(parseFloat(ds_list.GetColumn(i, "TSUM")) <> parseFloat(ds_wktyp_cd.GetColumn(ds_wktyp_cd.FindRow("CODE",ds_list.GetColumn(i, "WKTYP")),"WKTIM")))
			{
			    //trace(parseFloat(ds_list.GetColumn(i, "TSUM")));
			    //trace(parseFloat(ds_wktyp_cd.GetColumn(ds_wktyp_cd.FindRow("CODE",ds_list.GetColumn(i, "WKTYP")),"WKTIM")));
			    gfn_showAlert("CW10025", ds_list.GetColumn(i, "WKMNM") + " / 작업 입력시간과  M/H 전체 합계 불일치 합니다.");
				ds_list.rowpos = i;
				return;
			}
			//작업시간 정상근무 
			if( ds_list.GetColumn(i,"WKTYP") = "8" ) 
			{
				for (var j =0; j < ds_list_a.rowcount; j++)				
				{			
				    //블럭 입력 누락시 경고 20.04.24
					if( length(ds_list_a.GetColumn(j,"block_no")) < 1)  
					{
						gfn_showAlert("CW10025", ds_list.GetColumn(i, "WKMNM") + " /BLOCK NO나 BLOCK 명이 누락되었습니다.");
						ds_list.rowpos = i;
						return;
					}
				}
			}
		}
	}
	
	if (ds_list.RowCount() == 0)
	{
	    //btn_addWk.Enable = false;
		//btn_delWk.Enable = false;
		
		tit_clearActionInfo();
	
		tit_addSearchActionInfo("pp01:PP0104001A_S10");	
		
		tit_callService(
			""
			, ""
			, "ds_cond=ds_cond"
			, "ds_maxdat=ds_maxdat"
			, ""
			, "fn_afterMaxQuery"
			, true);		
	}
	
	//trace(ds_zrmon.savexml());
	//월 마감시 비활성화 
	if ( ds_zrmon.GetColumn(0,"CODE") == "X"  ) {
		btn_addWk.Enable = false;
		btn_delWk.Enable = false;
	}
	*/
	

	ds_title.SetColumn(0,"title", "생산1,2팀 작업반 별 보유공수");					
	ds_title.SetColumn(0,"planweek", "※계획 주간 : "+gfn_formatDate(pl_sdat.Value,".")+"~"+gfn_formatDate(pl_edat.Value,"."));
	ds_title.SetColumn(0,"work", "<근무일수 : "+getWorkingDayCount()+"일>");
	ds_title.SetColumn(0,"mh", "(단위:MH)");
	
	
	if ( ds_report_a.rowCount() != 0 ) 	{		
						
			var totSILJAKUP, totTOTINWON, totJIKJUBINWON, totJIWONINWON, totJAEJUCKGONGSU, totHUUPGONGSU, totHUUPLOSS;			
			for ( var j = 0; j< ds_report_a.rowCount(); j++)	{
					
				ds_report.setColumn(0,"JAKUP"+(parseInt(j)+1), ds_report_a.GetColumn(j, "SILJAKUP"));
				ds_report.setColumn(1,"JAKUP"+(parseInt(j)+1), ds_report_a.GetColumn(j, "TOTINWON"));
				ds_report.setColumn(2,"JAKUP"+(parseInt(j)+1), ds_report_a.GetColumn(j, "JIKJUBINWON"));			
				ds_report.setColumn(3,"JAKUP"+(parseInt(j)+1), ds_report_a.GetColumn(j, "JIWONINWON"));				
				ds_report.setColumn(4,"JAKUP"+(parseInt(j)+1), ds_report_a.GetColumn(j, "JAEJUCKGONGSU"));
				ds_report.setColumn(5,"JAKUP"+(parseInt(j)+1), ds_report_a.GetColumn(j, "HUUPGONGSU"));
				ds_report.setColumn(6,"JAKUP"+(parseInt(j)+1), ds_report_a.GetColumn(j, "HUUPLOSS"));
				
				totSILJAKUP += ParseFloat(ds_report_a.GetColumn(j, "SILJAKUP"));
				totTOTINWON += ParseFloat(ds_report_a.GetColumn(j, "TOTINWON"));
				totJIKJUBINWON += ParseFloat(ds_report_a.GetColumn(j, "JIKJUBINWON"));
				totJIWONINWON += ParseFloat(ds_report_a.GetColumn(j, "JIWONINWON"));
				totJAEJUCKGONGSU += ParseFloat(ds_report_a.GetColumn(j, "JAEJUCKGONGSU"));
				totHUUPGONGSU += ParseFloat(ds_report_a.GetColumn(j, "HUUPGONGSU"));
			}
			
			ds_report.setColumn(0,"JAKUP13", totSILJAKUP);
			ds_report.setColumn(1,"JAKUP13", totTOTINWON);
			ds_report.setColumn(2,"JAKUP13", totJIKJUBINWON);			
			ds_report.setColumn(3,"JAKUP13", totJIWONINWON);				
			ds_report.setColumn(4,"JAKUP13", totJAEJUCKGONGSU);
			ds_report.setColumn(5,"JAKUP13", totHUUPGONGSU);
			ds_report.setColumn(6,"JAKUP13", ROUND((ParseFloat(totHUUPGONGSU)/ParseFloat(totJAEJUCKGONGSU))*100, 2) );
			
	}
	else{
			ds_report.ClearData();
	}

		
}

// 최근 저장 일자 조회 후 복사 처리
function fn_afterMaxQuery(errCode, errMsg) {
	if (errCode == 0 && ds_maxdat.RowCount() > 0)
	{	    
		var arr = "fa_wkdat=" + quote(gfn_formatDate(ds_maxdat.GetColumn(0,"WKDAT"))) +" fa_maxdat=" + quote(ds_maxdat.GetColumn(0,"MAXDAT"));

		if (length(ds_maxdat.GetColumn(0,"MAXDAT")) > 0 && gfn_openPopup("PP0104001B",true, arr) == "Y")
		{ 
			// 이전 데이터 복사 처리
			tit_clearActionInfo();
			
			tit_addMultiActionInfo("pp01:PP0104001A_I4");
			tit_addMultiActionInfo("pp01:PP0104001A_I5");
			tit_addMultiActionInfo("pp01:PP0104001A_I6");
			tit_callService(
			 ""
			, ""
			, "ds_maxdat=ds_maxdat:A"
			, ""
			, ""
			, "fn_afterCopy"
			, "");
			
		}		
	}
	
}


// 복사후 조회
function fn_afterCopy(errCode, errMsg) {
	if (errCode == 0)
	{   
	    fn_query();
	}	
}



/********************************************************************************
* 기      능   : 저장 Callback  
********************************************************************************/
function fn_afterSave(errCode, errMsg) {
	if ( errCode!= 0 ) {
		gfn_showMsg("CE00001");
	} else {
		gfn_showMsg("CI00003");
		//fn_query();
		
		fn_workPlan(ed_wkmcd.Text);
		for (var i =0; i < ds_list_a.rowcount; i++)
		{	
			if( trim(ds_list_a.GetColumn(i,"NWKHR")) == "0")
			{
				ds_list_a.SetColumn(i,"NWKHR",'');
			}			
		}
		
		
	}
}

//=========================================================================================
// [ PART 5 ]
// Detail Process Event 정의 ( User Define function )
// 사용자 정의 함수는 ufn_xxxx() 형태로 작성 
//=========================================================================================

//=========================================================================================
// [ PART 6 ]
// component Event 정의 : 각 Component 별 이벤트 
//=========================================================================================

/********************************************************************************
* 기      능   : 그리드 헤더 클릭시 정렬 처리 
********************************************************************************/
function grd_list_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
{
	if ( nCell == 0 ) 
	{
		gfn_selectGridCol(obj);
	} 
	else if ( nCell > 1 ) 
	{
		gfn_sortGrid(obj, nCell);
	}
}


//작업자 추가
function btn_addWk_OnClick(obj)
{
    //trace("!!"+cb_wkbcd.Value);
    //trace(ds_wkbcd_cd.FindRow("CODE",cb_wkbcd.value));
    //trace(ds_wkbcd_cd.savexml());
    //ds_wkbcd_cd.FindRow("CODE",cb_wkbcd.value);
    /*
	ds_list.fireevent = false;
	ds_list.AddRow();
	ds_list.SetColumn(ds_list.rowpos,"FLAG","I");
	ds_list.SetColumn(ds_list.rowpos,"WKDAT",ds_cond.GetColumn(0,"WKDAT")); //ds_list.GetColumn(ds_cond.pos-1,"WKDAT")); 2020.04.27
	ds_list.SetColumn(ds_list.rowpos,"WKBCD",ds_wkbcd_cd.GetColumn(ds_wkbcd_cd.FindRow("CODE",cb_wkbcd.value),"CODE"));  //ds_list.GetColumn(ds_list.rowpos-1,"WKBCD"));
	ds_list.SetColumn(ds_list.rowpos,"CAPCD",ds_wkbcd_cd.GetColumn(ds_wkbcd_cd.FindRow("CODE",cb_wkbcd.value),"CODE_NAME"));
	ds_list.SetColumn(ds_list.rowpos,"CAPNM",ds_wkbcd_cd.GetColumn(ds_wkbcd_cd.FindRow("CODE",cb_wkbcd.value),"CODE3"));
	cb_wkmcd.Enable = true;
	ds_list.fireevent = true;
		
	grd_list_OnCellPosChanged(obj,ds_list.rowpos);
	*/
}


// 작업자 삭제
function btn_delWk_OnClick(obj)
{
	ds_list.fireevent = false;
	if (ds_list.GetColumn(ds_list.rowpos,"FLAG") == "I")
	{
		ds_list.DeleteRow(ds_list.rowpos);
		ds_list.fireevent = true;
	} else {
		ds_list.SetColumn(ds_list.rowpos,"FLAG","D");
		// 실작업 삭제
		for (var i =0; i < ds_list_a.rowcount; i++)
		{
			if (ds_list_a.GetColumn(i,"WKMCD") == ds_list.GetColumn(ds_list.rowpos,"WKMCD"))
			{
				ds_list_a.SetColumn(i,"FLAG", "D");
			}
		}
        //비작업 삭제
		for (var i =0; i < ds_list_b.rowcount; i++)
		{
			if (ds_list_b.GetColumn(i,"WKMCD") == ds_list.GetColumn(ds_list.rowpos,"WKMCD"))
			{
				ds_list_b.SetColumn(i,"FLAG", "D");
			}
		}
		ds_list.fireevent = true;
	}
	ds_list.fireevent = true;
}



// 작업자 선택시 내용 변경
function grd_list_OnCellPosChanged(obj,nRow,nCell,nOldRow,nOldCell,nPivotIndex,nOldPivotIndex)
{
	//ds_list_a.Filter("WKMCD == "+quote(ds_list.GetColumn(nRow,"WKMCD")) +" && FLAG != 'D' ");
	//ds_list_b.Filter("WKMCD == "+quote(ds_list.GetColumn(nRow,"WKMCD")) +" && FLAG != 'D' ");
	//set_Tsum();
}


// 실작업 내용 입력
function bt_add_grd1_OnClick(obj)
{
	ds_list_a.fireevent = false;
	
	ds_list_a.AddRow();
	

	if (length(ds_list.GetColumn(ds_list.rowpos,"WKMCD")) < 8 || length(cb_wkbcd1.Value) < 1)
	{
		var arr = ["실작업","작업자(작업장)"];
		gfn_showAlert("CW00004", arr);
		ds_list_a.DeleteRow(ds_list_a.rowpos);
		ds_list_a.fireevent = true;
		return;
	}

	if (length(ds_list.GetColumn(ds_list.rowpos,"WKTYP")) < 1 )
	{
		var arr = ["실작업","작업시간 유형"];
		gfn_showAlert("CW00004", arr);
		ds_list_a.DeleteRow(ds_list_a.rowpos);
		cb_wktyp.SetFocus();
		ds_list_a.fireevent = true;
		return;
	}
	
	if (ds_list_a.rowcount > 1 && length(ds_list_a.GetColumn(ds_list_a.rowpos-1,"BLOCK_NO")) < 1)
	{
		gfn_showAlert("CW00208","BLOCK_NO");    // block_no 필수 입력
		ds_list_a.DeleteRow(ds_list_a.rowpos);
		ds_list_a.fireevent = true;
		return;
	}
	ds_list_a.SetColumn(ds_list_a.rowpos,"FLAG","I");
	ds_list_a.SetColumn(ds_list_a.rowpos,"WKDAT", ds_list.GetColumn(ds_list.rowpos,"WKDAT"));
	ds_list_a.SetColumn(ds_list_a.rowpos,"WKBCD", ds_list.GetColumn(ds_list.rowpos,"WKBCD"));
	ds_list_a.SetColumn(ds_list_a.rowpos,"WKMCD", ""); //작업자 추가해야됨!!!!
	ds_list_a.SetColumn(ds_list_a.rowpos,"ARBPL", cb_wkbcd1.Value);
	ds_list_a.SetColumn(ds_list_a.rowpos,"WKHR",0);
	ds_list_a.fireevent = true;
	set_Tsum();
	if (ds_list.GetColumn(ds_list.rowpos,"FLAG") != "I") {
		ds_list.SetColumn(ds_list.rowpos,"FLAG", "U");
	}
	//ds_list.SetColumn(ds_list.FindRow("WKMCD",obj.GetColumn(nRow,"WKMCD")),"FLAG", "U");
}

//실작업 내용 삭제
function bt_del_grd1_OnClick(obj)
{
	ds_list_a.fireevent = false;
	if (ds_list_a.GetColumn(ds_list_a.rowpos,"FLAG") == "I")
	{
		ds_list_a.DeleteRow(ds_list_a.rowpos);
		ds_list_a.fireevent = true;
	} else {
		ds_list_a.SetColumn(ds_list_a.rowpos,"FLAG","D");
		ds_list_a.fireevent = true;
	}
	ds_list_a.fireevent = true;
	set_Tsum();
	if (ds_list.GetColumn(ds_list.rowpos,"FLAG") != "I") {
	ds_list.SetColumn(ds_list.rowpos,"FLAG", "U");
	}
}


//비작업 내용 입력 
function bt_add_grd2_OnClick(obj)
{
	ds_list_b.fireevent = false;
	
	
	if (ds_list_b.rowcount > 1){
	ds_list_b.AddRow();
	if (length(ds_list.GetColumn(ds_list.rowpos,"WKMCD")) < 8 || length(cb_wkbcd1.Value) < 1)
	{
		var arr = ["비작업","작업자(작업장)"];
		gfn_showAlert("CW00004", arr);
		ds_list_b.DeleteRow(ds_list_b.rowpos);
		ds_list_b.fireevent = true;
		return;
	}

	if (length(ds_list.GetColumn(ds_list.rowpos,"WKTYP")) < 1 )
	{
		var arr = ["비작업","작업시간 유형"];
		gfn_showAlert("CW00004", arr);
		ds_list_b.DeleteRow(ds_list_b.rowpos);
		cb_wktyp.SetFocus();
		ds_list_b.fireevent = true;
		return;
	}
	
	if (ds_list_b.rowcount > 1 && length(ds_list_b.GetColumn(ds_list_b.rowpos-1,"WKNCD")) < 1)
	{
		gfn_showAlert("CW00208","비작업 코드");    // 비작업 코드 필수 입력
		ds_list_b.DeleteRow(ds_list_b.rowpos);
		ds_list_b.fireevent = true;
		return;
	}
	ds_list_b.SetColumn(ds_list_b.rowpos,"FLAG","I");
	ds_list_b.SetColumn(ds_list_b.rowpos,"WKDAT", ds_list.GetColumn(ds_list.rowpos,"WKDAT"));
	ds_list_b.SetColumn(ds_list_b.rowpos,"WKBCD", ds_list.GetColumn(ds_list.rowpos,"WKBCD"));
	ds_list_b.SetColumn(ds_list_b.rowpos,"WKMCD", ""); // 작업자 추가해야됨 !!!!!
	
	} else { //비작업 row가 없을때만 기본셋팅 20.04.27
		ds_list_b.AddRow();
		ds_list_b.SetColumn(ds_list_b.rowpos,"FLAG","I");
		ds_list_b.SetColumn(ds_list_b.rowpos,"WKDAT", ds_list.GetColumn(ds_list.rowpos,"WKDAT"));
		ds_list_b.SetColumn(ds_list_b.rowpos,"WKBCD", ds_list.GetColumn(ds_list.rowpos,"WKBCD"));
		ds_list_b.SetColumn(ds_list_b.rowpos,"WKMCD", ""); // 작업자 추가해야됨 !!!!!
		ds_list_b.SetColumn(ds_list_b.rowpos,"WKNCD", "B06");
		ds_list_b.SetColumn(ds_list_b.rowpos,"WKNCD_DTL", "B0601");
		ds_list_b.SetColumn(ds_list_b.rowpos,"NWKHR", "0.2");
		ds_list_b.SetColumn(ds_list_b.rowpos,"ARBPL", ds_list.GetColumn(ds_list.rowpos,"ARBPL"));
		
		set_Tsum();
		
		ds_list_b.AddRow();
		ds_list_b.SetColumn(ds_list_b.rowpos,"FLAG","I");
		ds_list_b.SetColumn(ds_list_b.rowpos,"WKDAT", ds_list.GetColumn(ds_list.rowpos,"WKDAT"));
		ds_list_b.SetColumn(ds_list_b.rowpos,"WKBCD", ds_list.GetColumn(ds_list.rowpos,"WKBCD"));
		ds_list_b.SetColumn(ds_list_b.rowpos,"WKMCD", ""); // 작업자 추가해야됨
		ds_list_b.SetColumn(ds_list_b.rowpos,"WKNCD", "B13");
		ds_list_b.SetColumn(ds_list_b.rowpos,"WKNCD_DTL", "B1301");
		ds_list_b.SetColumn(ds_list_b.rowpos,"NWKHR", "0.3");
		ds_list_b.SetColumn(ds_list_b.rowpos,"ARBPL", ds_list.GetColumn(ds_list.rowpos,"ARBPL"));
		
		set_Tsum();
		
		
	}
	
	ds_list_b.fireevent = true;
	set_Tsum();
	if (ds_list.GetColumn(ds_list.rowpos,"FLAG") != "I") {
	ds_list.SetColumn(ds_list.rowpos,"FLAG", "U");
	}
	
}


// 비작업 내용 삭제
function bt_del_grd2_OnClick(obj)
{
	ds_list_b.fireevent = false;
	if (ds_list_b.GetColumn(ds_list_b.rowpos,"FLAG") == "I")
	{
		ds_list_b.DeleteRow(ds_list_b.rowpos);
		ds_list_b.fireevent = true;
	} else {
		ds_list_b.SetColumn(ds_list_b.rowpos,"FLAG","D");
		ds_list_b.fireevent = true;
	}
	ds_list_b.fireevent = true;
	set_Tsum();
	if (ds_list.GetColumn(ds_list.rowpos,"FLAG") != "I") {
	ds_list.SetColumn(ds_list.rowpos,"FLAG", "U");	
	}
}

// 작업자 변경
function cb_wkmcd_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{	
	/*
    ds_list.fireevent = false;
	var wkdata = ds_wkmcd_cd.GetColumn(nNewIndex,"CODE");
	
	for (var i = 0; i < ds_list.RowCount(); i++)
	{
		if(ds_list.GetColumn(i, "FLAG") != "I" && ds_list.GetColumn(i, "WKMCD") == wkdata)
		{
			gfn_showAlert("CW00018", "작업자는");
			cb_wkmcd.Value = "";
			ds_list.fireevent = true;
			return;
		}
	}

	ds_list.SetColumn(ds_list.rowpos,"WKMNM", ds_wkmcd_cd.GetColumn(nNewIndex,"WKMNM"));
	ds_list.SetColumn(ds_list.rowpos,"ARBPL", ds_wkmcd_cd.GetColumn(nNewIndex,"ARBPL"));  //20.04.27 작업자 선택시 작업장 셋팅 
	ds_list.fireevent = true;
	*/
}

// 신규 작업자의 경우만 작업자 변경이 가능
function ds_list_OnRowPosChanged(obj,nOldRow,nRow)
{
	/*
	if (ds_list.GetColumn(nRow,"FLAG") == "I")
	{
		cb_wkmcd.Enable = true;
	} else {
		cb_wkmcd.Enable = false;
	}
	set_Tsum();
	*/
}

//  입력이나 삭제가 아닌경우 flag를 u로 변경
function ds_list_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{
	ds_list.fireevent = false;
	if (ds_list.GetColumn(nRow,"FLAG") != "I" && ds_list.GetColumn(nRow,"FLAG") != "D"){
		ds_list.SetColumn(nRow,"FLAG", "U");
		ds_list.fireevent = true;
	}
	ds_list.fireevent = true;
}

function ds_list_w_OnColumnchanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{
	/*
	obj.fireevent = false;
	
	var wktim = 0.0;
    var iSRow;

    obj.setColumn(nRow,strColumnID,toUpper(varNewValue));

	if (strColumnID == "WKNCD")
	{
		var isDat = ds_zppdwkncd_cd.FindRow("CODE",toUpper(varNewValue),0,ds_zppdwkncd_cd.rowcount);
		
		if(isDat == -1){
			gfn_showMsg("CW00071","비작업 코드");
			ds_list_b.setColumn(nRow,"WKNCD","");
			obj.fireevent = true;
			return;	
		}

		for(var i = 0; i < ds_list_b.rowcount; i++)
		{
			var iSRow = ds_list_b.FindRow("WKNCD",ds_list_b.GetColumn(i,"WKNCD"),0,i);
			if(iSRow == -1) {
				obj.fireevent = true;
				continue;
			} else {	
				gfn_showAlert("CW00018","비작업 코드는");
				ds_list_b.setColumn(nRow,"WKNCD","");
				obj.fireevent = true;
				return;
			}
		}
	}
	if (strColumnID == "BLOCK_NO")
	{
		var isDat = ds_block_cd.FindRow("CODE",toUpper(varNewValue),0,ds_block_cd.rowcount);

		if(isDat == -1){
			gfn_showMsg("CW00071","BLOCK_NO");
			ds_list_a.setColumn(nRow,"BLOCK_NO","");
			obj.fireevent = true;
			return;	
		}
		
		for(var i = 0; i < ds_list_a.rowcount; i++)
		{
			var iSRow = ds_list_a.FindRow("BLOCK_NO",ds_list_a.GetColumn(i,"BLOCK_NO"),0,i);

			if(iSRow == -1){
				obj.fireevent = true;
				continue;
			} else {	
				gfn_showAlert("CW00018","BLOCK_NO 는");
				ds_list_a.setColumn(nRow,"BLOCK_NO","");
				obj.fireevent = true;
				return;
			}
		}
	}
	if (strColumnID == "ARBPL")
	{
		var isDat = ds_arbpl_cd.FindRow("CODE",toUpper(varNewValue),0,ds_arbpl_cd.rowcount);

		if(isDat == -1){
			gfn_showMsg("CW00071","규격");
			ds_list_a.setColumn(nRow,"ARBPL",cb_wkbcd1.Value);
			obj.fireevent = true;
			return;	
		}

		// for(var i = 0; i < ds_list_a.rowcount; i++)
		// {
			// var iSRow = ds_list_a.FindRow("ARBPL",ds_list_a.GetColumn(i,"ARBPL"),0,i);

			// if(iSRow == -1){	
				// continue;
			// } else {	
				// gfn_showAlert("CW00018","규격은");
				// ds_list_a.setColumn(nRow,"ARBPL","");
				// return;
			// }
		// }
	}
	// if (strColumnID == "WKHR" || strColumnID == "NWKHR")
	// {
		// for (var i = 0; i < ds_list_a.rowcount(); i++)
		// {
			// if (ds_list_a.GetColumn(i,"FLAG") != "D")
			// {
				// wktim += parseFloat(ds_list_a.GetColumn(i,"WKHR"));
			// }
		// }
		// for (var i = 0; i < ds_list_b.RowCount(); i++)
		// {
			// if (ds_list_b.GetColumn(i,"FLAG") != "D")
			// {
				// wktim += parseFloat(ds_list_b.GetColumn(i,"NWKHR"));
			// }
		// }

		// if (wktim > parseFloat(cb_wktim.text))
		// {
			// var arr = ["M/H의 합", "작업시간"];
			// gfn_showAlert("CW00190", arr);
			//obj.deleteRow(obj.rowpos);
			//obj.fireevent = true;
			// return;
		// }
		// ds_list.fireevent = false;
		// ds_list.SetColumn(ds_list.rowpos,"TSUM", ToString(wktim));
		// ds_list.fireevent = true;
	// }
    
    if (strColumnID == "WKNCD_DTL") //비작업 부 변경 시 비작업 주 변경  20190227
	{
	
		var isDat = ds_zppdwkncd_cd.FindRow("GUBUN2",toUpper(varNewValue),0,ds_zppdwkncd_cd.rowcount);  //비작업 부 선택 ROW
	    //trace("!!"+isDat);
		ds_list_b.setColumn(nRow,"WKNCD",ds_zppdwkncd_cd.GetColumn(isDat,"GUBUN1")); //비작업코드(주)
		//trace(ds_zppdwkncd_cd.GetColumn(isDat,"GUBUN1"));
				
	}
	
	if (obj.GetColumn(nRow,"FLAG") != "I" && obj.GetColumn(nRow,"FLAG") != "D"){
		
		obj.SetColumn(nRow,"FLAG", "U");
		//20.05.06
		ds_list.SetColumn(ds_list.FindRow("WKMCD",obj.GetColumn(nRow,"WKMCD")),"FLAG", "U");
		//trace(ds_list.savexml());
		
		obj.fireevent = true;
	}
	obj.fireevent = true;
	*/
}


function grd_OnCellClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
	if (obj.GetCellProp("body",nCell,"edit") == "combo")
	{
		obj.SetCellProp("body",nCell,"edit","normal");
	}
}

function grd_list_OnExpandEdit(obj,nRow,nCell,strVal,nPivotIndex)
{

	if (nCell != 6)
	{
		obj.SetCellProp("body",nCell,"edit","combo");
	}

}

function fn_ChangeIcon(fdt)
{
//	if(length(fdt) == 0 || user_grp == '20' || user_grp == '30') {
//	if(length(fdt) == 0 || user_grp == '20') {
	if(length(fdt) == 0 ) {
		return "btn_icon_post";
	} else {
		return "btn_icon_post";
	}	
}

function set_Tsum()
{
	var wktim = 0.0;
	
	if ( ds_list_a.rowcount() > 0 ) {
	for (var i = 0; i < ds_list_a.rowcount(); i++)
	{
		if (ds_list_a.GetColumn(i,"FLAG") != "D")
		{		    
			wktim += parseFloat(ds_list_a.GetColumn(i,"WKHR"));
			//trace("aaa"+ds_list.rowpos);
			//trace(wktim);
		}
	}
	}
	if ( ds_list_b.rowcount() > 0 ) {
	for (var i = 0; i < ds_list_b.RowCount(); i++)
	{
		if (ds_list_b.GetColumn(i,"FLAG") != "D")
		{
			wktim += parseFloat(ds_list_b.GetColumn(i,"NWKHR"));
			//trace("bbb"+ds_list.rowpos);
			//trace(wktim);
		}
	}
	}

	ds_list.fireevent = false;
	ds_list.SetColumn(ds_list.rowpos,"TSUM", wktim);

	ds_list.fireevent = true;
}
function cb_wkkcd_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	if(cb_wkkcd.Value != "")
	{
		cb_wktyp.Index = 0;
		
		ds_list_a.fireevent = false;
		ds_list_b.fireevent = false;
		
		for (var i = ds_list_a.RowCount()-1; i >= 0 ; i--)
		{
			ds_list_a.SetColumn(i,"FLAG","D");
		}
		for (var i = ds_list_b.RowCount()-1; i >= 0 ; i--)
		{
			ds_list_b.SetColumn(i,"FLAG","D");
		}

		ds_list_a.fireevent = true;
		ds_list_b.fireevent = true;

		ds_list_a.Filter("WKMCD == "+quote(ds_list.GetColumn(ds_list.currow,"WKMCD")) +" && FLAG != 'D' ");
	    ds_list_b.Filter("WKMCD == "+quote(ds_list.GetColumn(ds_list.currow,"WKMCD")) +" && FLAG != 'D' ");
		set_Tsum();
		
		ds_list.SetColumn(ds_list.currow,"TIMES","");  //clear 20190228
		ds_list.SetColumn(ds_list.currow,"TIMEE","");  //clear 20190228 		
	}
}

function cb_wktyp_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	if (cb_wkkcd.Value != "" && cb_wkkcd.Value != "Z")
	{
	    ds_list.SetColumn(ds_list.currow,"WKKCD","");  //작업시간 입력시 근태코드 초기화 20.04.27
	    //gfn_showAlert("CW00230",st_gutae.value);
		//return;
	}
}


// WBS 검색 추가 2012.10.22 hss
function grd_wbs_OnExpandUp(obj,nRow,nCell,strVal,nPivotIndex)
{
		
	
}

function grd_list_OnExpandEdit2(obj,nRow,nCell,strVal,nPivotIndex)
{
	
}

var _WORKING_DATE = "";
function gfn_getWorkingDate_pp(nDayCnt, sWerks, sFromDate) {
	if ( length( sFromDate ) == 0 ) {
		sFromDate = gfn_getCurrDate();
	}
	
	if ( length( sWerks) == 0 ) {
		return "";
	}
	
	sFromDate = replace(sFromDate, ".", "");
	
	var nRow = gds_workingday.searchRow("DAYS== " + quote(nDayCnt) 
		+ " && FROM_DATE==" + quote( sFromDate )
		+ " && WERKS == " + quote( sWerks ) );
	
	if ( nRow >= 0 ) {
		return gds_workingday.getColumn(nRow, "WORKING_DATE");
	}
	
	tit_callService(
        "COMM_ACT"
        , "getWorkingDay"
        , ""
        , ""
        , "DATE_FROM=" + quote(sFromDate) + " DAYS=" 
				+ quote(nDayCnt) +" WERKS=" + quote(sWerks)
        , ""
        , false
        , true
        , true);
    
    nRow = gds_workingday.addRow();    
    gds_workingday.setColumn(nRow, "DAYS", nDayCnt);
    gds_workingday.setColumn(nRow, "FROM_DATE", sFromDate);
    gds_workingday.setColumn(nRow, "WERKS", sWerks);
    gds_workingday.setColumn(nRow, "WORKING_DATE", replace(_WORKING_DATE, "-", ""));
    
	return replace(_WORKING_DATE, "-", "");
}



function cal_wkdat_OnChanged(obj,strOldText,strNewText)
{
	
}

function grd_list_OnCellClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
	//alert(quote(ds_list.GetColumn(nRow,"WKMCD")));
	if(ed_wkmcd.Text != "")
	{	
		fn_save2();		
	}	
	ed_wkmcd.Text = ds_list.GetColumn(nRow,"WKMCD");
	ed_wkmnm.Text = ds_list.GetColumn(nRow,"WKMNM");
	ed_arbplcd.Text = ds_list.GetColumn(nRow,"ARBPL");
	ed_arbplnm.Text = ds_list.GetColumn(nRow,"ARBPLNM");
	
	
	
	
	fn_workPlan(ds_list.GetColumn(nRow,"WKMCD"));
}
function grd_list_a_OnExpandEdit(obj,nRow,nCell,strVal,nPivotIndex)
{
	//obj.SetCellProp("body",nCell,"edit","combo");
}

function grd_list_a_OnCellClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
	// if (obj.GetCellProp("body",nCell,"edit") == "combo")
	// {
		// obj.SetCellProp("body",nCell,"edit","normal");
	// }
	
	
	
}


function fn_workPlan(HWKMCD)
{
	tit_clearActionInfo();
	
	tit_addSearchActionInfo("pp01:PP0104002A_S7");	
	
	ds_cond.SetColumn(0,"WKMCD", HWKMCD);
	ds_cond.SetColumn(0,"WKDATS", pl_sdat.Value);
	ds_cond.SetColumn(0,"WKDATE", pl_edat.Value);
	//trace(ds_cond.savexml());
	tit_callService(
		""
		, ""
		, "ds_cond=ds_cond"
		, "ds_list_a=ds_list_a"
		, ""
		, "fn_afterWorkPlan"
		, true);
		
}

function fn_afterWorkPlan()
{	
	if(ds_list_a.rowcount == 0)
	{
	
		ds_list_a_copy.SetColumn("0", "WKDAT", pl_sdat.Value);
		ds_list_a_copy.SetColumn("1", "WKDAT", gfn_getAfterDate(pl_sdat.Value, 1));
		ds_list_a_copy.SetColumn("2", "WKDAT", gfn_getAfterDate(pl_sdat.Value, 2));
		ds_list_a_copy.SetColumn("3", "WKDAT", gfn_getAfterDate(pl_sdat.Value, 3));
		ds_list_a_copy.SetColumn("4", "WKDAT", gfn_getAfterDate(pl_sdat.Value, 4));
		
		for(var i = 0; i < 5; i++)
		{		
			ds_list_a_copy.SetColumn(i, "ARBPL", ed_arbplcd.Text);
			ds_list_a_copy.SetColumn(i, "WKWEK", i);
			ds_list_a_copy.SetColumn(i, "WKBCD",ds_wkbcd_cd.GetColumn(ds_wkbcd_cd.FindRow("CODE",cb_wkbcd.value),"CODE"));
			ds_list_a_copy.SetColumn(i, "WKMCD", ed_wkmcd.Text);
			ds_list_a_copy.SetColumn(i, "WKMNM", ed_wkmnm.Text); 
			ds_list_a_copy.SetColumn(i, "WKDATIN", replace(md_wkdat.Text, ".",""));
			ds_list_a_copy.SetColumn(i, "WKDATS", pl_sdat.Value);
			ds_list_a_copy.SetColumn(i, "WKDATE", pl_edat.Value);
			ds_list_a_copy.SetColumn(i, "CAPCD",ds_wkbcd_cd.GetColumn(ds_wkbcd_cd.FindRow("CODE",cb_wkbcd.value),"CODE2"));
			ds_list_a_copy.SetColumn(i, "CAPNM",ds_wkbcd_cd.GetColumn(ds_wkbcd_cd.FindRow("CODE",cb_wkbcd.value),"CODE3"));
		}
						
		
		
			
		for(var i = 0; i < ds_list_a_copy.rowcount; i++)
		{		//alert(ds_list_a_copy.GetColumn(i,"WKDAT"));
				//alert(gfn_getWorkingDate_pp(0,"1000",ds_list_a_copy.GetColumn(i,"WKDAT")));
			if(ds_list_a_copy.GetColumn(i,"WKDAT") == gfn_getWorkingDate_pp(0,"1000",ds_list_a_copy.GetColumn(i,"WKDAT")))
			{
				ds_list_a_copy.SetColumn(i, "DISABLED", "0");
				ds_list_a_copy.SetColumn(i, "WKKCD", "");	
			}
			else
			{
				ds_list_a_copy.SetColumn(i, "DISABLED", "1");	// 휴일설정
				ds_list_a_copy.SetColumn(i, "WKKCD", "Z");	// 유휴설정
				ds_list_a_copy.SetColumn(i, "ARBPL", ed_arbplnm.Text);	// 작업장 설정 
				//ds_list_a_copy.SetColumn(i, "ARBPL", ed_arbplcd.Text);	// 작업장 설정 
			}
			
		}
		//trace(ds_list_a_copy.SaveXML());
		ds_list_a.Copy("ds_list_a_copy");	


	}
	else
	{
		for(var i = 0; i < ds_list_a.rowcount; i++)
		{	
			if(ds_list_a.GetColumn(i,"WKDAT") == gfn_getWorkingDate_pp(0,"1000",ds_list_a.GetColumn(i,"WKDAT")))
			{
				ds_list_a.SetColumn(i, "DISABLED", "0");				
			}
			else
			{
				ds_list_a.SetColumn(i, "DISABLED", "1");	// 휴일설정
				ds_list_a.SetColumn(i, "ARBPL", ed_arbplnm.Text);	// 작업장 설정 				
			}
			
		}
	}
	//trace(ds_list_a.SaveXML());

}

function fn_chg(nRow)
{
	if(ds_list_a.getColumn(nRow,'NWKHR') == '0')
		ds_list_a.setColumn(nRow,'NWKHR','');	
		
}


function grd_list_a_OnExpandUp(obj,nRow,nCell,strVal,nPivotIndex)
{
	
}

function grd_list_a_OnKillFocus(obj)
{
	
}

function grd_list_a_OnLButtonUp(obj,nPosX,nPosY,nRow,nCell,nPivotIndex)
{
	
}


function fn_excel() 
{
	fn_ExportObject();
}



function fn_ExportObject()
{
	var ExpObj;
	var sXML;
	
	FileDialog0.Type = "SAVE";
    FileDialog0.FileName = "Work_"+Getdate();
    FileDialog0.Filter = "Microsoft Excel File(*.xls)|*.xls|";

    if (!FileDialog0.open()){
      return;
    }

    var strFileName = FileDialog0.FilePath + "\\" + FileDialog0.FileName;


		
	ExpObj = CreateExportObject();	// ExportObject를 생성합니다.
	ExpObj.ExportType       = "Excel";	// 현재 Excel만 가능합니다.
	ExpObj.ExportFileName   = strFileName;
	//ExpObj.ExportFileName   = "D:\\test222.xls";	// File명 지정 - 파일이 저장 되는 경로입니다.
	
	ExpObj.ActiveSheetName  = "sheet1";	// Active Sheet지정
	ExpObj.MakeEmptyFileWhenNotExist = true;		// File이 없으면 새로 생성
	
	
	ExpObj.AddExportGrid("sheet1!A1", grd_title, true, false );	
	ExpObj.AddExportGrid("sheet1!A3", grd_title2, true, false );
	ExpObj.AddExportGrid("sheet1!A4", grd_report, true, false );
	
	 ExpObj.Export(true, false);	// Excel이 Export되지 않고 save를 하기위해선 Export의 2번째 파라미터에 false를 설정 // 첫번째 파라메터는 progress유무, 두번째 excel 저장유무
	 ExpObj.Save();  // Excel을 저장
	 ExpObj.CloseWorkbook(); 
	
	 ExpObj.Close();	// Excel을 내부적으로 Close
	 ExpObj = null;	
}





function getWorkingDayCount()
{
	var cntDay = 0;	
	ds_workChk.SetColumn("0", "WKDAT", pl_sdat.Value);
	ds_workChk.SetColumn("1", "WKDAT", gfn_getAfterDate(pl_sdat.Value, 1));
	ds_workChk.SetColumn("2", "WKDAT", gfn_getAfterDate(pl_sdat.Value, 2));
	ds_workChk.SetColumn("3", "WKDAT", gfn_getAfterDate(pl_sdat.Value, 3));
	ds_workChk.SetColumn("4", "WKDAT", gfn_getAfterDate(pl_sdat.Value, 4));		
			
	for(var i = 0; i < 5; i++)
	{		
		if(ds_workChk.GetColumn(i,"WKDAT") == gfn_getWorkingDate_pp(0,"1000",ds_workChk.GetColumn(i,"WKDAT")))
		{
			cntDay++;	
		}
	}	

	return cntDay;
}
]]></Script>
</Window>