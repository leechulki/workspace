<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="624" Id="CS4108001B" Left="8" OnLoadCompleted="fn_OnLoadCompleted" OnUnloadCompleted="fn_OnUnloadCompleted" PidAttrib="7" Title="인건비&#32;지급&#32;신청" Top="8" Ver="1.0" Width="800" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_cond">
				<Contents>
					<colinfo id="PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="VBELN" size="256" summ="default" type="STRING"/>
					<record>
						<PSPID></PSPID>
						<VBELN></VBELN>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_error">
				<Contents>
					<colinfo id="IDX" size="256" type="STRING"/>
					<colinfo id="ERRMSG" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list">
				<Contents>
					<colinfo id="MATNR" size="256" summ="default" type="STRING"/>
					<colinfo id="MAKTX" size="256" summ="default" type="STRING"/>
					<colinfo id="MBLNR" size="256" summ="default" type="STRING"/>
					<colinfo id="REQDATE" size="256" summ="default" type="STRING"/>
					<colinfo id="MENGE" size="256" summ="default" type="STRING"/>
					<colinfo id="MEINS" size="256" summ="default" type="STRING"/>
					<colinfo id="MAN" size="256" summ="default" type="STRING"/>
					<colinfo id="JOBHOUR" size="256" summ="default" type="STRING"/>
					<colinfo id="WON" size="256" summ="default" type="STRING"/>
					<colinfo id="MAT_AMT0" size="256" summ="default" type="STRING"/>
					<colinfo id="MAT_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="MAN_AMT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list2">
				<Contents>
					<colinfo id="PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="SUJU" size="256" summ="default" type="STRING"/>
					<colinfo id="TMAN_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="TWON_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="SRATE" size="256" summ="default" type="STRING"/>
					<colinfo id="STATUS" size="256" summ="default" type="STRING"/>
					<colinfo id="TMAN_AMT2" size="256" summ="default" type="STRING"/>
					<colinfo id="NIGHT" size="256" summ="default" type="STRING"/>
					<colinfo id="MAT_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="MAN_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="MANAGE_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="PROFIT" size="256" summ="default" type="STRING"/>
					<colinfo id="IMAN_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="DIR_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="INDIR_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="ILSIC_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="INCENT" size="256" summ="default" type="STRING"/>
					<colinfo id="comp01" size="256" summ="default" type="STRING"/>
					<colinfo id="comp02" size="256" summ="default" type="STRING"/>
					<colinfo id="comp03" size="256" summ="default" type="STRING"/>
					<colinfo id="comp04" size="256" summ="default" type="STRING"/>
					<colinfo id="comp05" size="256" summ="default" type="STRING"/>
					<colinfo id="KYUNG_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="TRAN_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="TEST_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="ETC" size="256" summ="default" type="STRING"/>
					<colinfo id="SMAT_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="NOINS" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list3" OnColumnChanged="ds_list3_OnColumnChanged">
				<Contents>
					<colinfo id="PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="HKONT" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQNO" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQNO_T" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQNO_N" size="256" summ="default" type="STRING"/>
					<colinfo id="BLDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="KOSTL" size="256" summ="default" type="STRING"/>
					<colinfo id="FGBN" size="256" summ="default" type="STRING"/>
					<colinfo id="KUNNR" size="256" summ="default" type="STRING"/>
					<colinfo id="INSDT" size="256" summ="default" type="STRING"/>
					<colinfo id="CNFDT" size="256" summ="default" type="STRING"/>
					<colinfo id="INSLFN" size="256" summ="default" type="STRING"/>
					<colinfo id="INAME1" size="256" summ="default" type="STRING"/>
					<colinfo id="INSTEL" size="256" summ="default" type="STRING"/>
					<colinfo id="INSPNO" size="256" summ="default" type="STRING"/>
					<colinfo id="TEMNO" size="256" summ="default" type="STRING"/>
					<colinfo id="CELLP" size="256" summ="default" type="STRING"/>
					<colinfo id="ECONT" size="256" summ="default" type="STRING"/>
					<colinfo id="WRKLFN" size="256" summ="default" type="STRING"/>
					<colinfo id="WRKTEL" size="256" summ="default" type="STRING"/>
					<colinfo id="WSTCD2" size="256" summ="default" type="STRING"/>
					<colinfo id="TWBTR" size="256" summ="default" type="STRING"/>
					<colinfo id="WAERS" size="256" summ="default" type="STRING"/>
					<colinfo id="MWSKZ" size="256" summ="default" type="STRING"/>
					<colinfo id="FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="BELNR" size="256" summ="default" type="STRING"/>
					<colinfo id="ATEXT" size="256" summ="default" type="STRING"/>
					<colinfo id="PJT" size="256" summ="default" type="STRING"/>
					<colinfo id="HNO" size="256" summ="default" type="STRING"/>
					<colinfo id="YYMM" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_save5">
				<Contents>
					<colinfo id="PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="SUJU" size="256" summ="default" type="STRING"/>
					<colinfo id="MAT_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="MAN_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="MANAGE_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="PROFIT" size="256" summ="default" type="STRING"/>
					<colinfo id="TMAN_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="DIR_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="INDIR_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="TWON_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="SRATE" size="256" summ="default" type="STRING"/>
					<colinfo id="NIGHT" size="256" summ="default" type="STRING"/>
					<colinfo id="ILSIC_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="IMAN_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="SMAT_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="KYUNG_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="TRAN_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="TEST_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="ETC" size="256" summ="default" type="STRING"/>
					<colinfo id="STD_MAT_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="STD_MAN_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="STD_MANAGE_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="STD_PROFIT" size="256" summ="default" type="STRING"/>
					<colinfo id="STD_TMAN_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="STD_DIR_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="STD_INDIR_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="STD_TWON_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="STD_SRATE" size="256" summ="default" type="STRING"/>
					<colinfo id="STD_ILSIC_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="STD_IMAN_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="STD_SMAT_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="STD_KYUNG_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="STD_TRAN_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="STD_TEST_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="STD_ETC" size="256" summ="default" type="STRING"/>
					<colinfo id="NOINS" size="256" summ="default" type="STRING"/>
					<colinfo id="INCENT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_fgbn">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE>F</CODE>
						<CODE_NAME>F</CODE_NAME>
					</record>
					<record>
						<CODE>I</CODE>
						<CODE_NAME>I</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_save6">
				<Contents>
					<colinfo id="PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="HKONT" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQNO" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQNO_T" size="256" summ="default" type="STRING"/>
					<colinfo id="BLDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="KOSTL" size="256" summ="default" type="STRING"/>
					<colinfo id="FGBN" size="256" summ="default" type="STRING"/>
					<colinfo id="KUNNR" size="256" summ="default" type="STRING"/>
					<colinfo id="INSDT" size="256" summ="default" type="STRING"/>
					<colinfo id="CNFDT" size="256" summ="default" type="STRING"/>
					<colinfo id="INSLFN" size="256" summ="default" type="STRING"/>
					<colinfo id="INAME1" size="256" summ="default" type="STRING"/>
					<colinfo id="INSTEL" size="256" summ="default" type="STRING"/>
					<colinfo id="INSPNO" size="256" summ="default" type="STRING"/>
					<colinfo id="TEMNO" size="256" summ="default" type="STRING"/>
					<colinfo id="CELLP" size="256" summ="default" type="STRING"/>
					<colinfo id="ECONT" size="256" summ="default" type="STRING"/>
					<colinfo id="WRKLFN" size="256" summ="default" type="STRING"/>
					<colinfo id="WRKTEL" size="256" summ="default" type="STRING"/>
					<colinfo id="WSTCD2" size="256" summ="default" type="STRING"/>
					<colinfo id="TWBTR" size="256" summ="default" type="STRING"/>
					<colinfo id="WAERS" size="256" summ="default" type="STRING"/>
					<colinfo id="MWSKZ" size="256" summ="default" type="STRING"/>
					<colinfo id="FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="BELNR" size="256" summ="default" type="STRING"/>
					<colinfo id="ATEXT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_seqno">
				<Contents>
					<colinfo id="SEQNO" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_end">
				<Contents>
					<colinfo id="YYYYMM" size="256" summ="default" type="STRING"/>
					<colinfo id="ENDFLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="ENDDATE" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list4" OnColumnChanged="ds_list3_OnColumnChanged">
				<Contents>
					<colinfo id="PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="TWBTR" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list5" OnColumnChanged="ds_list3_OnColumnChanged">
				<Contents>
					<colinfo id="PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="CNT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ind">
				<Contents></Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_rcond">
				<Contents>
					<colinfo id="ZPROGRAM" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN" size="256" summ="default" type="STRING"/>
					<record>
						<GBN></GBN>
						<ZPROGRAM></ZPROGRAM>
					</record>
				</Contents>
			</Dataset>
		</Datasets>
		<Shape BKColor="user12" Bottom="92" Height="26" Id="Shape1" Left="7" LineColor="user13" Right="792" TabOrder="8" Top="66" Type="Rectangle" Width="785"></Shape>
		<Div Height="36" Id="div_btn" TabOrder="1" Text="Div0" ToolTipFont="Default,0" Url="WB01::CommBtnForm.xml" Width="800">
			<Contents></Contents>
		</Div>
		<Static Align="Center" Height="24" Id="Static3" Left="296" Style="sty_lb_form_basic" TabOrder="3" Text="현장명" Top="42" VAlign="Middle" Width="80"></Static>
		<Shape BKColor="user12" Bottom="67" Height="26" Id="Shape0" Left="7" LineColor="user13" Right="792" TabOrder="2" Top="41" Type="Rectangle" Width="785"></Shape>
		<Static Align="Center" Height="24" Id="Static5" Left="8" Style="sty_lb_form_basic" TabOrder="4" Text="Proj.&#32;No" Top="42" VAlign="Middle" Width="80"></Static>
		<Edit Align="CENTER" Border="Flat" Enable="FALSE" Height="20" Id="ed_pspid" Left="90" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="5" Top="44" Width="94"></Edit>
		<Static Align="Center" Height="24" Id="Static4" Left="364" Style="sty_lb_form_basic" TabOrder="6" Text="결재상태" Top="67" VAlign="Middle" Width="66"></Static>
		<Edit Align="CENTER" Border="Flat" Enable="FALSE" Height="20" Id="ed_wf_stat" Left="432" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="7" Top="69" Width="100"></Edit>
		<Edit Align="CENTER" Border="Flat" Height="20" Id="ed_reg" Left="537" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="9" Text="(전결규정)" Top="69" Width="121"></Edit>
		<Edit Border="Flat" Enable="FALSE" Height="20" Id="ed_spt" Left="90" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="10" Top="69" Width="262"></Edit>
		<Static Align="Center" Height="24" Id="Static0" Left="8" Style="sty_lb_form_basic" TabOrder="11" Text="현장명" Top="67" VAlign="Middle" Width="80"></Static>
		<Static Align="Center" Height="24" Id="Static7" Left="364" Style="sty_lb_form_basic" TabOrder="12" Text="진행상태" Top="42" VAlign="Middle" Width="66"></Static>
		<Shape BKColor="user12" Bottom="150" Height="26" Id="Shape5" Left="207" LineColor="user13" Right="304" TabOrder="13" Top="124" Type="Rectangle" Width="97"></Shape>
		<Static Align="Center" Height="24" Id="Static25" Left="208" Style="sty_lb_form_basic" TabOrder="14" Text="표준" Top="125" VAlign="Middle" Width="95"></Static>
		<Shape BKColor="user12" Bottom="175" Height="26" Id="Shape25" Left="207" LineColor="user13" Right="304" TabOrder="15" Top="149" Type="Rectangle" Width="97"></Shape>
		<Static Align="Center" Height="24" Id="Static26" Left="208" Style="sty_lb_form_basic" TabOrder="16" Text="견적" Top="150" VAlign="Middle" Width="95"></Static>
		<Shape BKColor="user12" Bottom="231" Height="26" Id="Shape7" Left="695" LineColor="user13" Right="792" TabOrder="17" Top="205" Type="Rectangle" Width="97"></Shape>
		<Checkbox BindDataset="ds_list2" Column="NIGHT" Enable="FALSE" Height="15" Id="chk_night" Left="704" OnClick="chk_night_OnClick" TabOrder="19" Text="야간작업" Top="210" Width="76"></Checkbox>
		<Grid AutoEnter="TRUE" AutoFitEndLine="Hide" BindDataset="ds_list" BkColor2="default" BoldHead="true" Border="Flat" Bottom="405" CellMoving="TRUE" ColSelect="TRUE" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="165" Id="grd_list" InputPanel="FALSE" Left="8" LineColor="user20" LineType="ExHORZ" Right="792" RowHeight="20" Style="sty_grid" TabOrder="18" TabStop="true" Top="240" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="784">
			<contents>
				<format id="Default">
					<columns>
						<col width="36"/>
						<col width="90"/>
						<col width="300"/>
						<col width="40"/>
						<col width="35"/>
						<col width="60"/>
						<col width="60"/>
						<col width="0"/>
						<col width="80"/>
						<col width="0"/>
						<col width="80"/>
					</columns>
					<head>
						<cell col="0" display="normal" edit="normal" font="굴림,9" text="No"/>
						<cell col="1" display="text" font="굴림,9" text="자재번호"/>
						<cell col="2" display="text" font="굴림,9" text="자재내역"/>
						<cell col="3" display="text" font="굴림,9" text="수량"/>
						<cell col="4" display="text" font="굴림,9" text="단위"/>
						<cell col="5" display="text" font="굴림,9" text="투입인원"/>
						<cell col="6" display="text" font="굴림,9" text="표준공수"/>
						<cell bkcolor="khaki" col="7" display="text" font="굴림,9" text="자재비"/>
						<cell bkcolor="khaki" col="8" display="text" font="굴림,9" text="판매비"/>
						<cell col="9" display="text" font="굴림,9" text="직영재고"/>
						<cell bkcolor="khaki" col="10" display="text" font="굴림,9" text="용역비"/>
					</head>
					<body>
						<cell align="center" col="0" colid="CHK" display="normal" expr="currow+1"/>
						<cell align="center" bkcolor="user27" col="1" colid="MATNR" display="text" expandsize="18"/>
						<cell bkcolor="user27" bkimagealign="right" col="2" colid="MAKTX" display="text" limit="120"/>
						<cell align="right" bkcolor="user27" bkimagealign="left" col="3" colid="MENGE" display="number" LimitDec="3"/>
						<cell align="center" col="4" colid="MEINS" display="text"/>
						<cell align="right" col="5" colid="MAN" display="text"/>
						<cell align="right" col="6" colid="JOBHOUR" display="text"/>
						<cell bkcolor="user0" col="7" colid="WON" display="currency"/>
						<cell bkcolor="user0" col="8" colid="MAT_AMT" display="currency"/>
						<cell align="center" bkcolor="user27" bkimagealign="right" bkimageid="icon_grid_edit" col="9" colid="ZGUBN_CHK" display="checkbox" text="Y"/>
						<cell bkcolor="user0" col="10" colid="MAN_AMT" display="currency"/>
					</body>
					<summary>
						<cell col="0" display="text"/>
						<cell col="1" display="text"/>
						<cell col="2" display="text"/>
						<cell col="3" display="text"/>
						<cell col="4" display="text"/>
						<cell align="right" bkcolor="user25" col="5" display="number" expr='sum(&quot;MAN&quot;)'/>
						<cell align="right" bkcolor="user25" col="6" display="number" expr='sum(&quot;JOBHOUR&quot;)'/>
						<cell align="right" bkcolor="user25" col="7" display="currency" expr='sum(&quot;WON&quot;)'/>
						<cell align="right" bkcolor="user25" col="8" display="currency" expr='sum(&quot;MAT_AMT&quot;)'/>
						<cell col="9" display="text"/>
						<cell align="right" bkcolor="user25" col="10" display="currency" expr='sum(&quot;MAN_AMT&quot;)'/>
					</summary>
				</format>
			</contents>
		</Grid>
		<MaskEdit Border="Flat" DecimalLen="0" Enable="FALSE" Height="26" Id="med_suju" Left="104" Style="sty_ipt_form" TabOrder="20" TabStop="FALSE" Top="99" Width="97"></MaskEdit>
		<MaskEdit Border="Flat" DecimalLen="0" Enable="FALSE" Height="26" Id="med_mechul" Left="104" Style="sty_ipt_form" TabOrder="21" TabStop="FALSE" Top="124" Width="97"></MaskEdit>
		<MaskEdit Border="Flat" DecimalLen="0" Enable="FALSE" Height="26" Id="med_mat_amt" Left="104" Style="sty_ipt_form" TabOrder="22" TabStop="FALSE" Top="149" Width="97"></MaskEdit>
		<MaskEdit Border="Flat" DecimalLen="0" Enable="FALSE" Height="26" Id="med_tman_t" Left="304" Style="sty_ipt_form" TabOrder="24" TabStop="FALSE" Top="128" Width="97"></MaskEdit>
		<MaskEdit BindDataset="ds_list2" Border="Flat" Column="TMAN_AMT" DecimalLen="0" Enable="FALSE" Height="26" Id="med_tman_e" Left="303" Style="sty_ipt_form" TabOrder="23" TabStop="FALSE" Top="149" Width="97"></MaskEdit>
		<MaskEdit Border="Flat" DecimalLen="0" Enable="FALSE" Height="26" Id="med_twon_t" Left="399" Style="sty_ipt_form" TabOrder="26" TabStop="FALSE" Top="124" Width="97"></MaskEdit>
		<MaskEdit BindDataset="ds_list2" Border="Flat" Column="TWON_AMT" DecimalLen="0" Enable="FALSE" Height="26" Id="med_twon_e" Left="399" Style="sty_ipt_form" TabOrder="25" TabStop="FALSE" Top="149" Width="97"></MaskEdit>
		<MaskEdit Border="Flat" DecimalLen="0" Enable="FALSE" Height="26" Id="med_srate_t" Left="495" Mask="##0.0" OnChanged="med_srate_t_OnChanged" Style="sty_ipt_form" TabOrder="28" TabStop="FALSE" Top="124" Width="97"></MaskEdit>
		<MaskEdit BindDataset="ds_list2" Border="Flat" Column="SRATE" DecimalLen="0" Enable="FALSE" Height="26" Id="med_srate_e" Left="495" Mask="##0.0" Style="sty_ipt_form" TabOrder="27" TabStop="FALSE" Top="149" Width="97"></MaskEdit>
		<Static Align="Center" Border="Flat" BorderColor="user13" Height="26" Id="Static14" Left="207" Style="sty_lb_form_basic" TabOrder="29" Text="구분" Top="99" VAlign="Middle" Width="97"></Static>
		<Static Align="Center" Border="Flat" BorderColor="user13" Height="26" Id="Static15" Left="8" Style="sty_lb_form_basic" TabOrder="30" Text="수주금액" Top="99" VAlign="Middle" Width="97"></Static>
		<Static Align="Center" Border="Flat" BorderColor="user13" Height="26" Id="Static16" Left="8" Style="sty_lb_form_basic" TabOrder="31" Text="매출(청구)금액" Top="124" VAlign="Middle" Width="97"></Static>
		<Static Align="Center" Border="Flat" BorderColor="user13" Height="26" Id="Static17" Left="8" Style="sty_lb_form_basic" TabOrder="32" Text="자재판매가" Top="149" VAlign="Middle" Width="97"></Static>
		<Static Align="Center" Border="Flat" BorderColor="user13" Height="26" Id="Static18" Left="303" Style="sty_lb_form_basic" TabOrder="33" Text="인건비" Top="99" VAlign="Middle" Width="97"></Static>
		<Static Align="Center" Border="Flat" BorderColor="user13" Height="26" Id="Static19" Left="399" Style="sty_lb_form_basic" TabOrder="34" Text="총원가" Top="99" VAlign="Middle" Width="97"></Static>
		<Static Align="Center" Border="Flat" BorderColor="user13" Height="26" Id="Static20" Left="495" Style="sty_lb_form_basic" TabOrder="35" Text="시행율" Top="99" VAlign="Middle" Width="97"></Static>
		<Static Align="Center" Border="Flat" BorderColor="user13" Height="26" Id="Static22" Left="695" Style="sty_lb_form_basic" TabOrder="36" Text="특이사항" Top="180" VAlign="Middle" Width="97"></Static>
		<MaskEdit BindDataset="ds_list2" Border="Flat" Column="ILSIC_AMT" DecimalLen="0" DragMode="TRUE" Enable="FALSE" Height="26" Id="med_ilsic" Left="599" OnClick="med_ilsic_OnClick" Style="sty_ipt_form" TabOrder="37" TabStop="FALSE" Top="205" Width="97"></MaskEdit>
		<Static Align="Center" Border="Flat" BorderColor="user13" Height="26" Id="Static1" Left="599" Style="sty_lb_form_basic" TabOrder="38" Text="일식외주" Top="180" VAlign="Middle" Width="97"></Static>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_saveZcst005" ImageID="btn_user_05" Left="704" OnClick="btn_saveZcst005_OnClick" Style="sty_btn" TabOrder="39" Text="인건비&#32;확정" Top="128" Transparent="TRUE" Width="81"></Button>
		<MaskEdit Border="Flat" DecimalLen="0" Enable="FALSE" Height="26" Id="med_man_amt" Left="880" Style="sty_ipt_form" TabOrder="40" TabStop="FALSE" Top="216" Width="97"></MaskEdit>
		<MaskEdit Border="Flat" DecimalLen="0" Enable="FALSE" Height="26" Id="med_won" Left="904" Style="sty_ipt_form" TabOrder="41" TabStop="FALSE" Top="104" Width="97"></MaskEdit>
		<Static Align="Center" Border="Flat" BorderColor="user13" Height="26" Id="st_tman_amt" Left="8" Style="sty_lb_form_basic" TabOrder="43" Text="총지급금액" Top="444" VAlign="Middle" Width="70"></Static>
		<MaskEdit Border="Flat" DecimalLen="0" Enable="FALSE" Height="26" Id="med_tman_amt" Left="80" Style="sty_ipt_form" TabOrder="42" TabStop="FALSE" Top="440" Width="65"></MaskEdit>
		<Edit Align="CENTER" Border="Flat" Enable="FALSE" Height="20" Id="ed_status" Left="432" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="44" Top="44" Width="100"></Edit>
		<Grid AutoEnter="TRUE" AutoFitEndLine="Hide" BindDataset="ds_list3" BkColor2="default" BoldHead="true" Border="Flat" Bottom="592" CellMoving="TRUE" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="144" Id="grd_list2" InputPanel="FALSE" Left="152" LineColor="user20" LineType="ExHORZ" OnCellClick="grd_list2_OnCellClick" OnExpandEdit="grd_list2_OnExpandEdit" Right="792" RowHeight="20" Style="sty_grid" TabOrder="45" TabStop="true" Top="448" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="640">
			<contents>
				<format id="Default">
					<columns>
						<col width="30"/>
						<col width="0"/>
						<col width="80"/>
						<col width="120"/>
						<col width="80"/>
						<col width="85"/>
						<col width="55"/>
						<col width="182"/>
					</columns>
					<head>
						<cell align="center" col="0" color="user21" display="text" font="굴림,9" text="No"/>
						<cell align="center" col="1" color="user21" display="text" font="굴림,9" text="지급순번"/>
						<cell align="center" col="2" color="user21" display="text" font="굴림,9" text="업체계정"/>
						<cell align="center" col="3" color="user21" display="text" font="굴림,9" text="업체명"/>
						<cell align="center" col="4" color="user21" display="text" font="굴림,9" text="전기일"/>
						<cell align="center" col="5" color="user21" display="text" font="굴림,9" text="지급금액"/>
						<cell align="center" col="6" color="user21" display="text" font="굴림,9" text="완료여부"/>
						<cell align="center" col="7" color="user21" display="text" font="굴림,9" text="추가&#32;입력란"/>
					</head>
					<body>
						<cell align="center" bkcolor2="user22" col="0" display="text" expr="currow+1"/>
						<cell align="center" bkcolor2="user22" col="1" colid="SEQNO_T" combodisplayrowcnt="6" display="text"/>
						<cell align="center" bkcolor2="user22" col="2" colid="WRKLFN" combodisplayrowcnt="6" display="text"/>
						<cell align="center" bkcolor2="user22" col="3" colid="INAME1" display="text"/>
						<cell align="center" bkcolor2="user22" col="4" colid="BLDAT" display="text" expandimage="btn_grid_icon_pen" expandshow="true" Mask="####.##.##"/>
						<cell align="right" bkcolor2="user22" col="5" colid="TWBTR" display="number" edit="expr:iif(FLAG&#32;==&#32;&apos;X&apos;,&#32;&apos;none&apos;,&#32;&apos;number&apos;)"/>
						<cell align="center" bkcolor2="user22" col="6" colid="FGBN" combocol="CODE" combodataset="ds_fgbn" combotext="CODE_NAME" display="combo" edit="expr:iif(FLAG&#32;==&#32;&apos;X&apos;,&#32;&apos;none&apos;,&#32;&apos;combo&apos;)"/>
						<cell align="left" bkcolor2="user22" col="7" colid="ATEXT" combodisplayrowcnt="6" display="text" edit="expr:iif(FLAG&#32;==&#32;&apos;X&apos;,&#32;&apos;normal&apos;,&#32;&apos;noner&apos;)"/>
					</body>
					<summary>
						<cell bkcolor="user25" col="0" colspan="5" display="text">
							<cell align="center" col="0" color="user26" colspan="4" display="text" font="굴림,9" text="합&#32;계"/>
							<cell align="center" col="4" color="user26" display="text"/>
						</cell>
						<cell align="right" bkcolor="user25" col="5" color="user26" display="number" expr='sum(&quot;TWBTR&quot;)'/>
						<cell align="center" bkcolor="user25" col="6" color="user26" display="text"/>
						<cell bkcolor="user25" col="7" display="text">
							<cell align="center" col="0" color="user26" colspan="4" display="text" font="굴림,9"/>
							<cell align="center" col="4" color="user26" display="text"/>
						</cell>
					</summary>
				</format>
			</contents>
		</Grid>
		<Edit Align="CENTER" Border="Flat" Height="20" Id="man_amt_txt" Left="880" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="46" Text="총용역비" Top="192" Width="97"></Edit>
		<Static Align="Center" Border="Flat" BorderColor="user13" Height="26" Id="st_giji_amt" Left="8" Style="sty_lb_form_basic" TabOrder="50" Text="기지급금액" Top="476" VAlign="Middle" Width="70"></Static>
		<MaskEdit Border="Flat" DecimalLen="0" Enable="FALSE" Height="26" Id="med_giji_amt" Left="80" Style="sty_ipt_form" TabOrder="49" TabStop="FALSE" Top="476" Width="65"></MaskEdit>
		<MaskEdit Border="Flat" DecimalLen="0" Enable="FALSE" Height="26" Id="med_miji_amt" Left="80" Style="sty_ipt_form" TabOrder="51" TabStop="FALSE" Top="508" Width="65"></MaskEdit>
		<Static Align="Center" Border="Flat" BorderColor="user13" Height="26" Id="st_miji_amt" Left="8" Style="sty_lb_form_basic" TabOrder="52" Text="미지급금액" Top="508" VAlign="Middle" Width="70"></Static>
		<PopupDiv Border="Flat" Height="146" Id="PopupDiv0" Left="878" TabOrder="53" TabStop="FALSE" Top="264" Width="154">
			<Contents>
				<Calendar Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="146" Id="cal_temp" MonthOnly="TRUE" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" OnDayClick="PopupDiv0_cal_temp_OnDayClick" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="1" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="-2" Value="TODAY()" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="152"></Calendar>
			</Contents>
		</PopupDiv>
		<Edit Align="CENTER" Border="Flat" Enable="FALSE" Height="20" Id="ed_status2" Left="536" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="54" Top="44" Width="100"></Edit>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_init" ImageID="btn_user_05" Left="704" OnClick="btn_init_OnClick" Style="sty_btn" TabOrder="55" Text="확정&#32;취소" Top="152" Transparent="TRUE" Width="81"></Button>
		<Edit Border="None" Height="20" Id="Edit1" Left="8" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="56" Text="#&#32;인건비&#32;지급&#32;요청&#32;상세" Top="416" Width="168"></Edit>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_save6" ImageID="btn_user_05" Left="552" OnClick="btn_save6_OnClick" Style="sty_btn" TabOrder="57" Text="지급요청" Top="416" Transparent="TRUE" Width="81"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_del" ImageID="btn_user_05" Left="640" OnClick="btn_del_OnClick" Style="sty_btn" TabOrder="58" Text="요청삭제" Top="416" Transparent="TRUE" Width="81"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_plus" ImageID="btn_icon_plus" Left="736" LeftMargin="12" OnClick="btn_plus_OnClick" Style="sty_btn" TabOrder="47" Top="416" Transparent="TRUE" Width="22"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_minus" ImageID="btn_icon_minus" Left="762" LeftMargin="12" OnClick="btn_minus_OnClick" Style="sty_btn" TabOrder="48" Top="417" Transparent="TRUE" Width="22"></Button>
		<Static Align="Center" Border="Flat" BorderColor="user13" Height="26" Id="Static2" Left="303" Style="sty_lb_form_basic" TabOrder="60" Text="운반비" Top="180" VAlign="Middle" Width="97"></Static>
		<MaskEdit BindDataset="ds_list2" Border="Flat" Column="TRAN_AMT" DecimalLen="0" DragMode="TRUE" Enable="FALSE" Height="26" Id="med_tran" Left="303" OnClick="med_ilsic_OnClick" Style="sty_ipt_form" TabOrder="59" TabStop="FALSE" Top="205" Width="97"></MaskEdit>
		<Static Align="Center" Border="Flat" BorderColor="user13" Height="26" Id="Static6" Left="399" Style="sty_lb_form_basic" TabOrder="62" Text="검사비" Top="180" VAlign="Middle" Width="97"></Static>
		<MaskEdit BindDataset="ds_list2" Border="Flat" Column="TEST_AMT" DecimalLen="0" DragMode="TRUE" Enable="FALSE" Height="26" Id="med_test" Left="399" OnClick="med_ilsic_OnClick" Style="sty_ipt_form" TabOrder="61" TabStop="FALSE" Top="205" Width="97"></MaskEdit>
		<Static Align="Center" Border="Flat" BorderColor="user13" Height="26" Id="Static8" Left="495" Style="sty_lb_form_basic" TabOrder="64" Text="기타" Top="180" VAlign="Middle" Width="97"></Static>
		<MaskEdit BindDataset="ds_list2" Border="Flat" Column="ETC" DecimalLen="0" DragMode="TRUE" Enable="FALSE" Height="26" Id="med_etc" Left="495" OnClick="med_ilsic_OnClick" Style="sty_ipt_form" TabOrder="63" TabStop="FALSE" Top="205" Width="97"></MaskEdit>
		<Static Align="Center" Border="Flat" BorderColor="user13" Height="26" Id="Static9" Left="207" Style="sty_lb_form_basic" TabOrder="65" Text="구분" Top="180" VAlign="Middle" Width="97"></Static>
		<Static Align="Center" Border="Flat" BorderColor="user13" Height="26" Id="Static10" Left="207" Style="sty_lb_form_basic" TabOrder="66" Text="경비" Top="205" VAlign="Middle" Width="97"></Static>
		<MaskEdit BindDataset="ds_list2" Border="Flat" Column="SMAT_AMT" DecimalLen="0" Enable="FALSE" Height="26" Id="med_chk" Left="600" Mask="##0.0" Style="sty_ipt_form" TabOrder="67" TabStop="FALSE" Top="104" Visible="FALSE" Width="97"></MaskEdit>
		<Checkbox BindDataset="ds_list2" Column="NOINS" Enable="FALSE" Height="15" Id="chk_noIns" Left="600" OnClick="chk_noIns_OnClick" TabOrder="68" Text="noIns" Top="160" Value="FALSE" Width="76"></Checkbox>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_save_atext" ImageID="btn_user_06" Left="456" OnClick="btn_save_atext_OnClick" Style="sty_btn" TabOrder="69" Text="추가&#32;입력&#32;수정" Top="416" Transparent="TRUE" Width="88"></Button>
		<Static Align="Center" Color="user6" Font="Default,9,Bold" Height="32" Id="st_msg1" Left="272" TabOrder="70" Text="st_msg1" Top="408" VAlign="Middle" Width="184"></Static>
		<Static Align="Center" Border="Flat" BorderColor="user13" Height="26" Id="Static11" Left="808" Style="sty_lb_form_basic" TabOrder="71" Text="자재원가" Top="104" VAlign="Middle" Width="97"></Static>
		<Static Font="Default,9,Bold" Height="18" Id="Static12" Left="10" TabOrder="72" Text="※&#32;계산서&#32;발행(빌링)&#32;후&#32;인건비&#32;지급이&#32;가능하오니&#32;발행&#32;진행&#32;후&#32;요청&#32;필요" Top="599" Width="453"></Static>
	</Form>
	<Script><![CDATA[/*
 ******************************************************************************************
 * 기      능   : 수리공사 불출 자재 내역 조회 및 인건비 지급 신청
 * 작  성  자   : 201504
 * 작성  일자   : 201504
 * ----------------------------------------------------------------------------------------
 * HISTORY    : 일반직 노무비 율  3 >>> 4 % 조정 20160426
 * HISTORY    : 일반직 노무비 율 (제조간접비)   0.004 %  조정 20170629
 * HISTORY    : 간접비 마스터 정보 활용, 17년도 이후부터 적용      20180123
 ******************************************************************************************
*/
#include "LIB::commons.js";	// 공통 스크립트
 #include "LIB::common_cs.js";	// 서비스 공통 스크립트
//=========================================================================================
// [ PART 1 ]
// Form에서 사용될 전역변수를 선언
// FORM에서 사용되는 전역변수는 대문자로 작성하며, F_XXX 의 형태를 갖도록 한다.
//=========================================================================================
var wbs = "";    // WBS
var vbeln = "";  // S/0
var spt = "";	 // 현장명
var suju = "";	 // 수주금액
var mechul = ""; // 매출금액
var tmpFlag = false;
var IndirectRate   = 0 ; //간접비(zcst604)
var IndirectRate_P = 0 ; //제조간접비(zcst604)

var ilsic_input_auth = false; // 일식외주 입력권한
var night_work_auth = false; // 야간작업 입력권한
var confirmCancle_visible_auth = false; // 확정취소 버튼 권한
var confirm_cancle_auth = false; // 확정취소 권한
var plus_auth = false;
//=========================================================================================
// [ PART 2 ]
// Form Loading / Unloading 시 작업 정의
//=========================================================================================
function fn_OnLoadCompleted(obj) {
	gfn_initForm();
//	Gfn_ResizeInit(1024,768);
	ed_pspid   = wbs ;
	ed_spt     = spt ;
	med_suju   = suju ;
	med_mechul = mechul ;
	gv_gbu     = bsu_gb ;
//	gv_gbu     = "3" ;

	// 문구 설정
	st_msg1.Text = " ※ 추가 입력란 ※ "  + "\n"
	             + "    지급요청 완료 후 사용" ;

	gfn_initDs(ds_rcond, true);
	ds_rcond.SetColumn(0, "ZPROGRAM", "CS4108001B");
	ds_rcond.SetColumn(0, "GBN", "01");
	ilsic_input_auth = gfn_getAuth(ds_rcond);
	ds_rcond.ClearData();

	gfn_initDs(ds_rcond, true);
	ds_rcond.SetColumn(0, "ZPROGRAM", "CS4108001B");
	ds_rcond.SetColumn(0, "GBN", "02");
	night_work_auth = gfn_getAuth(ds_rcond);
	ds_rcond.ClearData();

	gfn_initDs(ds_rcond, true);
	ds_rcond.SetColumn(0, "ZPROGRAM", "CS4108001B");
	ds_rcond.SetColumn(0, "GBN", "03");
	confirmCancle_visible_auth = gfn_getAuth(ds_rcond);
	ds_rcond.ClearData();

	gfn_initDs(ds_rcond, true);
	ds_rcond.SetColumn(0, "ZPROGRAM", "CS4108001B");
	ds_rcond.SetColumn(0, "GBN", "04");
	confirm_cancle_auth = gfn_getAuth(ds_rcond);
	ds_rcond.ClearData();

	gfn_initDs(ds_rcond, true);
	ds_rcond.SetColumn(0, "ZPROGRAM", "CS4108001B");
	ds_rcond.SetColumn(0, "GBN", "05");
	plus_auth = gfn_getAuth(ds_rcond);
	ds_rcond.ClearData();




	if(G_USER_ID == "2021200" || G_USER_ID == "2018900" || G_USER_ID == "2029758" || G_USER_ID == "2999999") {
		med_chk.Visible = true;
	}

	// if(substr(bstdk,0,4) == "2017") {

		// alert("2017년 수주현장에 대해서는 1월 20일 이후 작업요청 (지급율 변경 적용예정)");
		// tmpFlag = true;
	// }

	ds_cond.SetColumn(0, "PSPID", wbs);
	ds_cond.SetColumn(0, "VBELN", vbeln);

	//간접비 마스터 정보 가져오기 및 설정
	fn_getIndirectRate();
	fn_setIndirectRate();
	// 자재 청구 내역 조회 RFC
	fn_query();

}
/********************************************************************************
* 기      능   : 수주일자 기준 간접비 정보 가져오기 ZCST604
********************************************************************************/
function fn_getIndirectRate() {
	ds_ind.ClearData();
	tit_clearActionInfo();
	tit_addSearchActionInfo("wb01:GET_INDIRECT_RATE");
	tit_callService(
			""
			, ""
			, ""
			, "ds_ind=ds_ind"
			, "GDATE="+quote(bstdk)
			, ""
			, true
			, false
			, true);

}
function fn_setIndirectRate() {
	//trace(ds_ind.SaveXML());
	if(spart == "20") { // 주차
		IndirectRate = ds_ind.GetColumn(0, "CS604_PK");
	} else {
		if(substr(wbs,6,2) == "NS") {
			IndirectRate   = toNumber(ds_ind.GetColumn(0, "CS604_NS")) ;
			IndirectRate_P = toNumber(ds_ind.GetColumn(0, "CS604_NS_P")) ;
		} else {
			IndirectRate   = toNumber(ds_ind.GetColumn(0, "CS604_NC")) ;
			IndirectRate_P = toNumber(ds_ind.GetColumn(0, "CS604_NC_P")) ;
		}
	}
	IndirectRate   = IndirectRate/100;
	IndirectRate_P = IndirectRate_P/100;
/*
	trace("간접비"+IndirectRate);
	trace("제조간접비"+IndirectRate_P);
*/
}
/********************************************************************************
* 기      능   : 공통코드가 조회된 후의 Callback 함수
********************************************************************************/
function fn_completeInit(sCode, sDsObj, sCodeType) {
	gfn_showMsg("CI00007");
}

/********************************************************************************
* 기      능   : form UnloadCompleted
********************************************************************************/
function fn_OnUnloadCompleted(obj) {
	return gfn_isFormUnload(obj);
}

//=========================================================================================
// [ PART 3 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,form닫기)
//=========================================================================================
/********************************************************************************
* 기      능   : 조회 1 - 자재 청구 내역 조회
********************************************************************************/
function fn_query() {

	gfn_clearMsgBar();
	// sort mark 삭제
	gfn_clearGridSortMark(grd_list);
	ds_list.row = -1;
	ds_list.ClearData();
	tit_callService(
        "CS4108001B_ACT"
        , "query"
        , "ds_cond=ds_cond"
        , "ds_list=ds_list ds_error=ds_error"
        , ""
        , "fn_afterQuery");
}

/********************************************************************************
* 기      능   : 닫기
********************************************************************************/
function fn_close() {
	close();
}

/********************************************************************************
* 기      능   : 액셀
********************************************************************************/
function fn_excel() {
	// Excel Export
	gfn_saveToExcel(grd_list, true);
}

//=========================================================================================
// [ PART 4]
// Callback 함수 정의 : callback 함수명은 메인 함수의 fn_xxxx() 에서 xxxx 부분은 fn_afterXXXX()
// 형태가 되도록 작성
//=========================================================================================
/********************************************************************************
* 기      능   : 조회 Callback
********************************************************************************/
function fn_afterQuery(errCode, errMsg) {
	if(ds_error.rowcount() > 0) {
		gfn_showMsg("CE00001");
		// error 정보 표시
		gfn_openWSErrorWin(grd_list, ds_list, ds_error, "FLAG");
		btn_saveZcst005.Enable = false;
		btn_init.Enable = false;
		btn_save6.Enable = false;
		btn_del.Enable = false;
		btn_plus.Enable = false;
		btn_minus.Enable = false;
	} else {

		med_mat_amt.value = ds_list.Sum("MAT_AMT"); //총 자재판매가
		med_man_amt.value = ds_list.Sum("MAN_AMT"); //총 용역비
		med_won.value     = ds_list.Sum("WON");     //총 자재원가
		//저장내역 조회 zcst005 조회
		fn_query2();
	}
}
/********************************************************************************
* 기      능   : 저장내역 조회 zcst005 조회
********************************************************************************/
function fn_query2() {

	tit_clearActionInfo();
	tit_addSearchActionInfo("cs41:CS4108001B_S1");  // ZCST005 조회
	tit_addSearchActionInfo("cs41:CS4108001B_S2");  // ZCST006 조회
	tit_addSearchActionInfo("cs41:CS4108001B_S5");  // ZCST411 입력여부 확인필요 YAR

	tit_callService(
        ""
        , ""
        , "ds_cond=ds_cond"
        , "ds_list2=ds_list2 ds_list3=ds_list3 ds_list4=ds_list4"
        , ""
        , "fn_afterQuery2"
        , true);
}
/********************************************************************************
* 기      능   : 조회 Callback
********************************************************************************/
var status  = "";  // zcst005 상태값
var mat_won = 0 ;  // 자재원가
var mat_amt = 0 ;  // 자재판매가
function fn_afterQuery2(errCode, errMsg) {
	if(errCode != 0) {
		gfn_showMsg("CE00001");
		return false;

		btn_saveZcst005.Enable = false;
		btn_init.Enable = false;
		btn_save6.Enable = false;
		btn_del.Enable = false;
		btn_plus.Enable = false;
		btn_minus.Enable = false;
	}

	status = ds_list2.GetColumn(0,"STATUS");
	// 아래의 경우만 인건비 수정이 가능함
	// A - 저장 , 작업지시 전
	// Z - 취소 , 삭제 경우
	// ""  - 저장 전
	// F  수리부품 매출잔고 현황에서 작성된 내용 CS3407003A

	//모뎀교체해지 등록했으며 인건비미확정(초기)인 경우
	//if(status == "A" && ds_list4.GetColumn(0, "CNT") > 0 && ds_list5.GetColumn(0, "CNT") >0)

	if(ds_list4.GetColumn(0, "CNT") > 0){ // 모뎀교체해지 등록을 했다면
		if(length(status) == 0){ // 인건비 등록전 이면
			med_ilsic.Value = ds_list4.GetColumn(0, "TWBTR");
			ilsic_amt = parseInt(med_ilsic.Value);
			tran_amt  = parseInt(med_tran.Value);
			test_amt  = parseInt(med_test.Value);
			etc   = parseInt(med_etc.Value);
		}
		if(status == "A"){
			ds_list3.ClearData();
			tit_clearActionInfo();
			tit_addSearchActionInfo("cs41:CS4108001B_S4"); // ZCST006 조회
			tit_callService(
			""
			, ""
			, "ds_cond=ds_cond"
			, "ds_list3=ds_list3"
			, ""
			, "fn_afterQuery3"
			, true);
       }
      }

	if(status == "F" ) {
		gfn_showAlert("인건비 확정 취소 후 최종인건비 입력 바랍니다.");
	}
	if(status == "Z"  or length(status) == 0 ) {

		med_ilsic.Enable = false;       // 일식외주 입력

		//if(G_USER_ID == "2021056" || G_USER_ID == "2023687") {
		if(ilsic_input_auth == true) {
			med_ilsic.Enable = true;       // 일식외주 입력
		}

		med_tran.Enable  = true;       // 경비1 - 운반비
		med_test.Enable  = true;       // 경비2 - 검사비
		med_etc.Enable   = true;       // 경비3 - 기타
		btn_saveZcst005.Enable = true; // 인건비 확정 버튼
		btn_init.Enable = true;        // 확정 취소 버튼
		btn_save6.Enable = false;      // 지급요청 버튼
		btn_del.Enable = false;        // 요청삭제 버튼
		// 직영의 경우만 야간작업 체크 가능
		if(gv_gbu == "1") {
			chk_night.Enable = true;
			//if(G_USER_ID == "2021056" || G_USER_ID == "2021200" || G_USER_ID == "2023687" || G_USER_ID == "2018900" || G_USER_ID == "2029758" || G_USER_ID == "2999999") {
			if(night_work_auth == true) {
				chk_noIns.Enable = true;
			}
		}
	} else{
		med_ilsic.Enable = false;
		med_tran.Enable  = false;       // 경비1 - 운반비
		med_test.Enable  = false;       // 경비2 - 검사비
		med_etc.Enable   = false;       // 경비3 - 기타
		chk_night.Enable = false;
		btn_saveZcst005.Enable = false;
		btn_save6.Enable = true;
		btn_del.Enable = true;

		if(status == "A") {
			btn_init.Enable = true;
		} else {
			btn_init.Enable = false;
			//if(G_USER_ID == "2021056"  || G_USER_ID == "2021200" || G_USER_ID == "2023687" || G_USER_ID == "2018900" || G_USER_ID == "2029758" || G_USER_ID == "2999999") {
			if(confirmCancle_visible_auth == true) {
				btn_init.Enable = true;
			}
		}
	}

	mat_won = parseInt(med_won.value);     // 자재원가
	mat_amt = parseInt(med_mat_amt.value); // 자재판매가
	suju    = parseInt(suju);              // 수주금액
	// 표준금액 계산을 위한 초기화
	ilsic_amt = 0;
	tran_amt = 0;
	test_amt = 0;
	etc = 0;

	// 표준 금액 계산 , 최초 데이타 기준 원가 계산
	fn_calcCost();
	// 인센티브 계산
	fn_calcIncentive();

	fn_displayCost();
	// 표준 원가 고정
	fn_firstCost();
	// 지급신청 마감 일자 체크
	fn_chkEnd();

	if(tmpFlag == true) {
		// 임시 처리
		fn_enable();
	}

}

var gv_gbu   = "";  // 직영구분
var tman_amt = 0; 	// 총용역비
var man_amt  = 0; 	// 노무비
var mat_amt  = 0; 	// 자재비
var manage_amt = 0; // 일반관리비
var profit = 0; 	// 이윤
var ilsic_amt = 0;  // 일식외주
var incent = 0; 	// 인센티브
var suju   = 0;
var iman_amt = 0; 	// 일반직 노무비
var dir_amt  = 0; 	// 직접비
var indir_amt = 0; 	// 간접비
var twon_amt  = 0; 	// 총원가
var srate = 0;      // 시행율
var kyung_amt = 0;  // 경비
var night = false;  // 야간작업
var tran_amt  = 0;	// 운반비
var test_amt  = 0;	// 검사비
var etc   = 0;	// 기타


/********************************************************************************
* 기      능   : 최초 원가 계산
********************************************************************************/
function fn_calcCost() {
	// 최초원가계산 OR 인건비 재계산 시 인센티브 초기화
	incent = 0 ;
	kyung_amt = tran_amt + test_amt + etc ;

	// 협력사
	if(gv_gbu == "3") {
		// 자재비(판매비)가 없는 경우
		if(mat_amt == 0) {
			tman_amt = ilsic_amt;
			incent = 0 ;
		} else {

			if(substr(bstdk,0,4) >= "2017") {
				tman_amt = ilsic_amt + (mat_amt * 0.15)
						   + ( (suju - mat_amt) * 0.75 )
						   + incent ;
			} else {
				tman_amt = ilsic_amt + (mat_amt * 0.1)
						   + ( (suju - (ilsic_amt * 1.08) - mat_amt) * 0.65 )
						   + incent ;
			}
		}
	//직영
	} else {

		if(night == true) {
			man_amt = parseInt(med_man_amt.value) * 1.5 ; // 용역비 + 야간용역비
		} else {
			man_amt = parseInt(med_man_amt.value) ;       // 용역비
		}

		manage_amt = round(man_amt * 0.05) ; 			   // 일반관리비
		profit = round((man_amt + manage_amt) * 0.05) ; // 이윤
		tman_amt = round(ilsic_amt) + round(man_amt) + round(manage_amt) + round(profit)
		           + round(incent) ;

	}
	// 17 년 이후 부터 간접비 마스터 정보 참조
	if(substr(bstdk,0,4) >= "2017") {
		dir_amt = round(mat_won) + round(kyung_amt) + round(tman_amt) ; // 직접비
		indir_amt = round(dir_amt * IndirectRate) ;                     // 간접비
		iman_amt  = round(dir_amt * IndirectRate_P) ;                   // 일반직노무비 (제조간접비율 적용)
		twon_amt = round(dir_amt) + round(indir_amt)  + round(iman_amt);// 원가
	} else {
		iman_amt  = round(tman_amt * 0.04) ; // 일반직노무비
		dir_amt = round(mat_won) + round(kyung_amt) + round(tman_amt) + round(iman_amt) ; // 직접비
		indir_amt = round(dir_amt * 0.11) ;                          // 간접비
		if(ed_pspid.Text == "M01601NS207") {
			twon_amt = 9035117 ;
		} else {

			twon_amt = round(dir_amt) + round(indir_amt) ;                       // 원가
		}

	}

	srate =  round(( twon_amt / suju ) * 100 ,1) ;                       // 시행율

	//인건비 지급 천단위 절삭
	tman_amt = round(tman_amt / 1000) ;
	tman_amt = tman_amt * 1000 ;

/*
	trace("최초 원가 suju= " + suju);
	trace("최초 원가 mat_amt= " + mat_amt);
	trace("최초 원가 man_amt= " + man_amt);
	trace("최초 원가 manage_amt= " + manage_amt);
	trace("최초 원가 profit= " + profit);
	trace("최초 원가 tman_amt= " + tman_amt);
	trace("최초 원가 dir_amt= " + dir_amt);
	trace("최초 원가 indir_amt= " + indir_amt);
	trace("최초 원가 twon_amt= " + twon_amt);
	trace("최초 원가 srate= " + srate);
	trace("최초 원가 night= " + night);
	trace("최초 원가 ilsic_amt= " + ilsic_amt);
	trace("최초 원가 iman_amt= " + iman_amt);
	trace("최초 원가 incent= " + incent);
	trace("최초 원가 tran_amt= " + tran_amt);
	trace("최초 원가 test_amt= " + test_amt);
	trace("최초 원가 etc= " + etc);
*/
}
function fn_afterQuery3() {

	var a = 0;
	for(var i =0; i< ds_list3.rowcount; i++){
		a += ds_list3.GetColumn(i, "TWBTR");
	}

	med_ilsic.Value = a;
	ilsic_amt = parseInt(med_ilsic.Value);
	tran_amt  = parseInt(med_tran.Value);
	test_amt  = parseInt(med_test.Value);
	etc   = parseInt(med_etc.Value);
	// 원가계산
	fn_calcCost();
	// 인센티브 계산
	fn_calcIncentive();

	fn_displayCost();


}
/********************************************************************************
* 기      능   : 인센티브 계산
********************************************************************************/
function fn_calcIncentive() {

	if(noIns == false) {
		if(mat_amt <> 0) {
			// 직영 시행율 70 이상인 경우 조정
			if(gv_gbu == "1") {
				if(srate <= 70) {
					incent = 0 ;
				} else {
					//trace("직영, 최종");
					twon_amt  = round(twon_amt + ((70 - srate) / 100 * suju )) ;

					if(substr(bstdk,0,4) >= "2017") {
						dir_amt   = round(twon_amt / ( 1 + IndirectRate + IndirectRate_P)) ;
						iman_amt  = round(dir_amt * IndirectRate_P) ;
						indir_amt = round(twon_amt) - round(dir_amt) - round(iman_amt) ;
						tman_amt  = round(dir_amt) - round(mat_won) - round(kyung_amt) ;

					} else {

						dir_amt   = round(twon_amt / ( 1 + 0.107 )) ;
						indir_amt = round(twon_amt) - round(dir_amt) ;
						tman_amt  = round(dir_amt) - round(mat_won) - round(kyung_amt) ;
						iman_amt  = round(tman_amt * 0.004) ;
						tman_amt  = round(tman_amt) - round(iman_amt) ;
					}
					incent    = round(tman_amt) - round(ilsic_amt) - round(man_amt) - round(manage_amt) - round(profit) ;
					srate     = round((twon_amt / suju * 100),1) ;
				}
			// 협력사 시행율 72미만인 경우
			} else {
				if(srate >= 72) {
					incent = 0 ;
				} else {
				}
			}
		}
	}
}
/********************************************************************************
* 기      능   : 원가 항목 및 상태값 셋팅
********************************************************************************/
function fn_displayCost() {

	//인건비 지급 천단위 절삭
	tman_amt = round(tman_amt / 1000) ;
	tman_amt = tman_amt * 1000 ;
	if(ed_pspid.Text == "M01601NS207") {
		tman_amt = 0 ;
	}

/*
	trace("최종 suju= " + suju);
	trace("최종 mat_amt= " + mat_amt);
	trace("최종 man_amt= " + man_amt);
	trace("최종 manage_amt= " + manage_amt);
	trace("최종 profit= " + profit);
	trace("최종 tman_amt= " + tman_amt);
	trace("최종 dir_amt= " + dir_amt);
	trace("최종 indir_amt= " + indir_amt);
	trace("최종 twon_amt= " + twon_amt);
	trace("최종 srate= " + srate);
	trace("최종 night= " + night);
	trace("최종 ilsic_amt= " + ilsic_amt);
	trace("최종 iman_amt= " + iman_amt);
	trace("최종 incent= " + incent);
	trace("최종 tran_amt= " + tran_amt);
	trace("최종 test_amt= " + test_amt);
	trace("최종 etc= " + etc);
*/
	// 견적 금액  저장내역 없을 시 표준금액으로 셋팅
	if( length(status) == 0 or status == "Z"  ) {
		med_tman_e  = tman_amt ; // 인건비
		med_twon_e  = twon_amt ; // 총원가
		med_srate_e = srate ;    //시행율
	}
	med_tman_amt.value = med_tman_e.value; // 총지급액
	med_giji_amt.value = ds_list3.Sum("TWBTR"); // 기지급액
	med_miji_amt.value = parseInt(med_tman_amt.value) - parseInt(med_giji_amt.value); // 미지급액

    giji_amt = parseInt(med_giji_amt.value) ;
	miji_amt = parseInt(med_miji_amt.value) ;

	if( length(status) == 0 or status == "Z"  ) {
		ed_status.value  = "인건비 미확정";
		ed_status2.value = "지급 불가능";
	} else {
		ed_status.value  = "인건비 확정";
		ed_status2.value = "지급 가능";
		if(miji_amt == 0) {
			ed_status2.value = "지급 완료";
		}
	}
}

var std_tman_amt = 0; 	// 총용역비
var std_man_amt  = 0; 	// 노무비
var std_mat_amt  = 0; 	// 자재비
var std_manage_amt = 0; // 일반관리비
var std_profit = 0; 	// 이윤
var std_ilsic_amt = 0;  // 일식외주
var std_incent = 0; 	// 인센티브
var std_suju   = 0;
var std_iman_amt = 0; 	// 일반직 노무비
var std_dir_amt  = 0; 	// 직접비
var std_indir_amt = 0; 	// 간접비
var std_twon_amt  = 0; 	// 총원가
var std_srate = 0;      // 시행율
var std_kyung_amt = 0;  // 경비
var std_tran_amt  = 0;	// 운반비
var std_test_amt  = 0;	// 검사비
var std_etc   = 0;	// 기타
/********************************************************************************
* 기      능   : 표준 원가 항목 고정
********************************************************************************/
function fn_firstCost() {
	// 표준 금액 (실시간 데이타)
	med_tman_t.Value  = tman_amt ; // 인건비
	med_twon_t.Value  = twon_amt ; // 총원가
	med_srate_t.Value = srate ;    //시행율

	std_tman_amt   = tman_amt  ;
	std_man_amt    = man_amt   ;
	std_mat_amt    = mat_amt   ;
	std_manage_amt = manage_amt;
	std_profit     = profit    ;
	std_ilsic_amt  = ilsic_amt ;
	std_incent     = incent    ;
	std_iman_amt   = iman_amt  ;
	std_dir_amt    = dir_amt   ;
	std_indir_amt  = indir_amt ;
	std_twon_amt   = twon_amt  ;
	std_srate      = srate     ;
	std_kyung_amt  = kyung_amt ;
	std_tran_amt   = tran_amt  ;
	std_test_amt   = test_amt  ;
	std_etc        = etc       ;


}
/********************************************************************************
* 기      능   : 조회 Callback
********************************************************************************/
function fn_afterSave(errCode, errMsg) {
	if(errCode > 0) {
		gfn_showMsg("실패");
	} else {
		gfn_showMsg("저장성공");
		chk_noIns.Value = false;
		noIns = false;
		fn_query();
	}
}

/********************************************************************************
* 기      능   : 저장 Callback
********************************************************************************/
function fn_afterSave1(errCode, errMsg) {
	if(errCode != 0) {
		gfn_showMsg("CE00001");
	} else {
		gfn_showMsg("CI00005");
		fn_query();
	}
}

//=========================================================================================
// [ PART 6 ]
// component Event 정의 : 각 Component 별 이벤트
//=========================================================================================
/********************************************************************************
* 기      능   : 그리드 헤더 클릭시 정렬 처리
********************************************************************************/
function grd_list_OnHeadClick(obj,nCell,nX,nY,nPivotIndex) {
	if(nCell == 0) {
		// 전체 선택
		gfn_selectAllGrid(obj,0,0,true);

	} else {
		// 그리드 정렬 처리
		gfn_sortGrid(obj,nCell);
	}
}

/********************************************************************************
* 기      능   : 일식외주 금액 수정 시
********************************************************************************/
function med_ilsic_OnClick(obj,objDragObj,nX,nY)
//function med_ilsic_OnDrag(obj,nX,nY,varKeyState)
{
//	trace("경비 및 일식외주 수정");
	ilsic_amt = parseInt(med_ilsic.Value);
	tran_amt  = parseInt(med_tran.Value);
	test_amt  = parseInt(med_test.Value);
	etc   = parseInt(med_etc.Value);
	// 원가계산
	fn_calcCost();
	// 인센티브 계산
	fn_calcIncentive();

	fn_displayCost();
}
/********************************************************************************
* 기      능   : 직영 야간작업 체크 시
********************************************************************************/
function chk_night_OnClick(obj,strValue){
	if(chk_night.value == true) {
//		trace("야간작업");
		night = true;
		// 원가계산
		fn_calcCost();
		// 인센티브 계산
		fn_calcIncentive();

		fn_displayCost();
	} else {
		night = false;
		fn_query();
	}
}
/********************************************************************************
* 기      능   : 인건비 확정 버튼
********************************************************************************/
function btn_saveZcst005_OnClick(obj)
{
	fn_setDs(); // ds_save5 에 견적 원가 항목 셋팅

	if( length(status) == 0 or status == "Z"  ) {
		if(!gfn_showConfirm("인건비 확정을 하시겠습니까?")) return;
	 //저장 zcst005
	tit_clearActionInfo();
 	tit_addMultiActionInfo("cs41:CS4108001B_I1");
	tit_callService(
        ""
        , ""
        , "ds_save5=ds_save5"
        , ""
        , ""
        , "fn_afterSave"
        , true);

	} else {
		gfn_showAlert("인건비 수정이 불가 합니다.");
		return;
	}
}

/********************************************************************************
* 기      능   : 견적 원가 항목 셋팅
********************************************************************************/
function fn_setDs() {

	ds_save5.ClearData();
	ds_save5.AddRow() ;
	ds_save5.SetColumn(0, "PSPID" , wbs);
	ds_save5.SetColumn(0, "SUJU" , suju/100);
	ds_save5.SetColumn(0, "SMAT_AMT" , mat_amt/100); // 자재판매가
	ds_save5.SetColumn(0, "MAT_AMT" , mat_won/100); // 자재원가
	ds_save5.SetColumn(0, "MAN_AMT" , man_amt/100);
	ds_save5.SetColumn(0, "MANAGE_AMT" , manage_amt/100);
	ds_save5.SetColumn(0, "PROFIT" , profit/100);
	ds_save5.SetColumn(0, "TMAN_AMT" , tman_amt/100);
	ds_save5.SetColumn(0, "DIR_AMT" , dir_amt/100);
	ds_save5.SetColumn(0, "INDIR_AMT" , indir_amt/100);
	ds_save5.SetColumn(0, "TWON_AMT" , twon_amt/100);
	ds_save5.SetColumn(0, "SRATE" , srate);
	ds_save5.SetColumn(0, "NIGHT" , night);
	ds_save5.SetColumn(0, "ILSIC_AMT" , ilsic_amt/100);
	ds_save5.SetColumn(0, "IMAN_AMT" , iman_amt/100);
	ds_save5.SetColumn(0, "KYUNG_AMT" , kyung_amt/100);
	ds_save5.SetColumn(0, "TRAN_AMT" , tran_amt/100);
	ds_save5.SetColumn(0, "TEST_AMT" , test_amt/100);
	ds_save5.SetColumn(0, "ETC" , etc/100);
	ds_save5.SetColumn(0, "INCENT" , incent/100);
	// 표준 항목 저장

	ds_save5.SetColumn(0, "STD_SMAT_AMT" , std_mat_amt/100); // 자재판매가
	ds_save5.SetColumn(0, "STD_MAT_AMT" , mat_won/100); // 자재원가
	ds_save5.SetColumn(0, "STD_MAN_AMT" , std_man_amt/100);
	ds_save5.SetColumn(0, "STD_MANAGE_AMT" , std_manage_amt/100);
	ds_save5.SetColumn(0, "STD_PROFIT" , std_profit/100);
	ds_save5.SetColumn(0, "STD_TMAN_AMT" , std_tman_amt/100);
	ds_save5.SetColumn(0, "STD_DIR_AMT" , std_dir_amt/100);
	ds_save5.SetColumn(0, "STD_INDIR_AMT" , std_indir_amt/100);
	ds_save5.SetColumn(0, "STD_TWON_AMT" , std_twon_amt/100);
	ds_save5.SetColumn(0, "STD_SRATE" , std_srate);
	ds_save5.SetColumn(0, "STD_ILSIC_AMT" , std_ilsic_amt/100);
	ds_save5.SetColumn(0, "STD_IMAN_AMT" , std_iman_amt/100);
	ds_save5.SetColumn(0, "STD_KYUNG_AMT" , std_kyung_amt/100);
	ds_save5.SetColumn(0, "STD_TRAN_AMT" , std_tran_amt/100);
	ds_save5.SetColumn(0, "STD_TEST_AMT" , std_test_amt/100);
	ds_save5.SetColumn(0, "STD_ETC" , std_etc/100);
	ds_save5.SetColumn(0, "NOINS" , noIns);
}

/********************************************************************************
* 기      능   : 지급요청 row 생성
********************************************************************************/
var giji_amt = 0 ; // 기지급액
var miji_amt = 0 ; // 미지급액
function btn_plus_OnClick(obj)
{
	// if( ds_list3.RowCount() == 10 ){
		// gfn_showAlert("최대 10건의 지급요청이 가능합니다.");
		// return;
	// }

	if( status == "F"  ) {
		gfn_showAlert("인건비 확정 취소 후 최종인건비 입력 바랍니다.");
		return;
	}

	if( length(status) == 0 or status == "Z"  ) {
		gfn_showAlert("인건비 확정 작업 이후 가능합니다.");
		return;
	}
	
	//(2020.03.17) 김종욱씨 요청으로 NS의 경우 빌링금액이 > 0 일때만 가능토록 수정(특정 권한자는 제외)
	if (plus_auth != true  &&  parseInt(med_mechul.Value) <= 0 && substr(ed_pspid.Text, 6, 2) == "NS")
	{
		//gfn_showAlert("계산서발행(빌링)이 되어야 인건비 지급이 가능합니다(서비스경영관리팀 문의).");
		gfn_showAlert("매출(청구)금액: " + parseInt(med_mechul.Value) + " / " + " 계산서발행(빌링)이 되어야 인건비 지급이 가능합니다.(서비스경영관리팀 문의)");
		return;
	}
	
	
	if(miji_amt == 0) {
		("지급이 완료되었습니다.");
		return;
	} else {

		ds_list3.AddRow();
		ds_list3.SetColumn(ds_list3.currow,"PSPID", wbs);
		ds_list3.SetColumn(ds_list3.currow,"FLAG" , "I");
		ds_list3.SetColumn(ds_list3.currow,"SEQNO_T" , "지급업체 "+ (ds_list3.currow+1));
		ds_list3.SetColumn(ds_list3.currow,"TWBTR" , 0);
	}
}

/********************************************************************************
* 기      능   : 지급요청 row 삭제
********************************************************************************/
function btn_minus_OnClick(obj)
{
	if( length(status) == 0 or status == "Z"  ) {
		gfn_showAlert("인건비 확정 작업 이후 가능합니다.");
		return;
	}
	// 기지급 여부 FLAG == "X" 인 경우 삭제 할 수 없다.
	if(ds_list3.GetColumn(ds_list3.currow,"FLAG") == "X") {
		gfn_showAlert("삭제 할수 없습니다.");
		return;
	} else {
		// 마지막 index 삭제
		ds_list3.DeleteRow(ds_list3.lastrow);
	}
}

/********************************************************************************
* 기      능   : 전기일 입력 관련
********************************************************************************/
function grd_list2_OnExpandEdit(obj,nRow,nCell,strVal,nPivotIndex) {
	var rect = obj.GetCellRect(nRow, ncell);

	var nX = ClientToScreenX(obj,rect[0]);
	var nY = ClientToScreenY(obj,rect[1] + 20);

	PopupDiv0.TrackPopup(nX,nY);
	PopupDiv0.cal_temp.SetFocus();
}

function PopupDiv0_cal_temp_OnDayClick(obj,strText) {
	gfn_clearMsgBar();

	if(grd_list2.GetClickedCell() == 4 and (ds_list3.GetColumn(ds_list3.row,"FLAG") == "I")) {
		strText = gfn_getLeapLastDay(strText);
		ds_list3.SetColumn(ds_list3.row, "BLDAT", strText);
	}

	PopupDiv0.ClosePopup();
}


/********************************************************************************
* 기      능   : 업체 조회
********************************************************************************/
function grd_list2_OnCellClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
	if((nCell == 2 or nCell == 3) and (ds_list3.GetColumn(ds_list3.row,"FLAG") == "I")) {
		var arg = "comName="+quote(ds_list3.GetColumn(nRow, "INAME1"));
		var rtn = gfn_openPopup("WB0101001C", true, arg);

		if(rtn != null) {
			ds_list3.SetColumn(nRow, "WRKLFN", rtn[0]);
			ds_list3.SetColumn(nRow, "INAME1", rtn[1]);
		}
	}
}

/********************************************************************************
* 기      능   : 확정 취소 zcst005 삭제
********************************************************************************/
function btn_init_OnClick(obj)
{
	// 진행상태가 A 인경우만 삭제가 가능
	if( length(status) == 0 ) {
		gfn_showAlert("취소 대상이 없습니다.");
		return;
	}
	// 지급내역이 존재하여 삭제가 불가능하지만, 관리자는 삭제 가능
	if( ds_list3.RowCount() > 0 ) {

		//if(G_USER_ID == "2021200" OR G_USER_ID == "2021056" OR G_USER_ID == "2023687" or G_USER_ID == "2018900" or G_USER_ID == "2029758" or G_USER_ID == "2999999") {
		if(confirm_cancle_auth == true) {
			if(!gfn_showConfirm("지급내역 존재.  관리자에 한해 삭제 가능")) return;
		} else {
			gfn_showAlert("지급내역이 존재하여 삭제가 불가능합니다");
			return;
		}
	}

	fn_setDs();

	if(!gfn_showConfirm("인건비 확정을 취소 하시겠습니까?")) return;

	tit_clearActionInfo();
	tit_addMultiActionInfo("cs41:CS4108001B_D1");  //입력
	tit_callService(
		""
		, ""
		, "ds_save5=ds_save5"
		, ""
		, ""
		, "fn_afterSave"
		, true);
}

/********************************************************************************
* 기      능   : 지급 요청 zcst006 저장
********************************************************************************/
function btn_save6_OnClick(obj)
{
	if( ds_list3.RowCount() == 0 ) {
		gfn_showAlert("요청 대상이 없습니다.");
		return;
	}

	var twbtr_sum = parseInt(ds_list3.Sum("TWBTR")) ;
	var tman_sum  = parseInt(med_tman_amt.value) ;   // 총 지급금액
	if(twbtr_sum > tman_sum) {
		gfn_showAlert("지급액이 초과하였습니다.");
		return;
	}

	if(!gfn_showConfirm("지급 요청을 하시겠습니까?")) return;

	ds_save6.ClearData();
	var j = 0;
	var twbtr = 0 ;
	trace(ds_list4.GetColumn(0, "CNT"));

	for(var i=0; i<ds_list3.rowCount(); i++) {
		if(ds_list4.GetColumn(0, "CNT") > 0 && ds_list3.GetColumn(i, "FGBN") <> "F"){
			ds_list3.SetColumn(i, "FLAG" , "I");
			ds_list3.SetColumn(i, "FGBN" , "F");
		}
		if(ds_list3.GetColumn(i,"FLAG") == "I") {
			if(length(ds_list3.getColumn(i, "WRKLFN")) == 0) {
				gfn_showAlert("CW00001", "업체정보");
				return;
			}
			if(length(ds_list3.getColumn(i, "INAME1")) == 0) {
				gfn_showAlert("CW00001", "업체정보");
				return;
			}
			if(length(ds_list3.getColumn(i, "BLDAT")) == 0) {
				gfn_showAlert("CW00001","전기일");
				return;
			}
			if(ds_list3.getColumn(i, "TWBTR") == 0) {
				gfn_showAlert("CW00001", "지급금액");
				return;
			}
			if(length(ds_list3.getColumn(i, "FGBN")) == 0) {
				gfn_showAlert("CW00001", "완료여부");
				return;
			}

			ds_save6.AddRow();
			ds_save6.SetColumn(j, "PSPID", wbs);
			ds_save6.SetColumn(j, "BLDAT", ds_list3.GetColumn(i,"BLDAT"));
			ds_save6.SetColumn(j, "WRKLFN", ds_list3.GetColumn(i,"WRKLFN"));
			ds_save6.SetColumn(j, "INAME1", ds_list3.GetColumn(i,"INAME1"));
			twbtr = parseInt(ds_list3.GetColumn(i,"TWBTR"))/100 ;
			ds_save6.SetColumn(j, "TWBTR", twbtr);
			ds_save6.SetColumn(j, "FGBN", ds_list3.GetColumn(i,"FGBN"));
			var seq_t = substr(ds_list3.GetColumn(i,"SEQNO_T"),5,1) ;
			ds_save6.SetColumn(j, "SEQNO_T", seq_t);

			j++;
		}
	}

	if(ds_save6.RowCount() != 0){

		tit_clearActionInfo();

		// ZCST006 저장
		//if( gfn_getCurrDate() >= '20200111' || ds_save6.GetColumn(1,"BLDAT") >= '20200101'  )
		//{
		//	tit_addMultiActionInfo("cs41:CS4108001B_I4");  //입력
		//}
		//else
		//{
			tit_addMultiActionInfo("cs41:CS4108001B_I2");  //입력
		//}


		// ZCST005 상태값 변경 A >> B
		tit_addMultiActionInfo("cs41:CS4108001B_U1");  //입력
		tit_callService(
			""
			, ""
			, "ds_save6=ds_save6"
			, ""
			, ""
			, "fn_afterSave"
			, true);
	} else {
		gfn_showAlert("요청 대상이 없습니다.");
		return;
	}

}

/********************************************************************************
* 기      능   : 지급 요청 zcst006 삭제
********************************************************************************/
function btn_del_OnClick(obj)
{
	if( ds_list3.RowCount() == 0 ) {
		gfn_showAlert("삭제 대상이 없습니다.");
		return;
	}
	if(ds_list3.GetColumn(ds_list3.currow,"FLAG") == "X" and length(ds_list3.GetColumn(ds_list3.currow,"BELNR")) == 0) {

		ds_save6.ClearData();
		ds_save6.AddRow();
		ds_save6.SetColumn(0, "PSPID", wbs);
		ds_save6.SetColumn(0, "SEQNO", ds_list3.GetColumn(ds_list3.currow,"SEQNO"));
		tit_clearActionInfo();
		tit_addMultiActionInfo("cs41:CS4108001B_D2");  //ZCST006 삭제
		tit_addMultiActionInfo("cs41:CS4108001B_U2");  //ZCST005 변경
		tit_callService(
			""
			, ""
			, "ds_save6=ds_save6"
			, ""
			, ""
			, "fn_afterSave"
			, true);


	} else {
		gfn_showAlert("삭제 대상이 아닙니다.");
		return;
	}
}


/********************************************************************************
* 기      능   : 직영수주의 경우 시행율 재계산 제외
********************************************************************************/
var noIns = false;
function chk_noIns_OnClick(obj,strValue)
{
	if(chk_noIns.value == true) {
		trace("직영 no 인센티브");
		noIns = true;
	} else {
		noIns = false;
		fn_query();
	}

}
/********************************************************************************
* 기      능   : 지급요청 마감일자 체크
********************************************************************************/
function fn_chkEnd() {

	ds_end.ClearData();

	tit_clearActionInfo();
	tit_addSearchActionInfo("cs41:CS4108001A_S4");
	tit_callService(
			""
			, ""
			, ""
			, "ds_end=ds_end"
			, ""
			, ""
			, true
			, false
			, true);

	var yyyymm  = ds_end.GetColumn(0, "YYYYMM");
	var endflag = ds_end.GetColumn(0, "ENDFLAG");
	var enddate = ds_end.GetColumn(0, "ENDDATE");
	// 해제 체크 시 마감일자 인 경우 입력 불가
	if (endflag == 1 and enddate = gfn_getCurrDate()) {

		btn_save6.Enable = false;
		btn_del.Enable = false;
		btn_plus.Enable = false;
		btn_minus.Enable = false;
		gfn_showAlert("전기월 "+ yyyymm + " 지급 요청 접수 마감입니다.");

	}
}
function btn_save_atext_OnClick(obj)
{
// zcst006t  추가 text 입력
	ds_save6.ClearData();
	var j = 0;
	for(var i=0; i<ds_list3.rowCount(); i++) {

		var  atext_new = ds_list3.GetColumn(i,"ATEXT") ;
		var  atext_org = ds_list3.GetOrgColumn(i,"ATEXT") ;

		if(atext_new != atext_org) {
			ds_save6.AddRow();
			ds_save6.SetColumn(j, "PSPID", wbs);
			ds_save6.SetColumn(j, "SEQNO", ds_list3.GetColumn(i,"SEQNO"));
			ds_save6.SetColumn(j, "WRKLFN", ds_list3.GetColumn(i,"WRKLFN"));
			ds_save6.SetColumn(j, "ATEXT", ds_list3.GetColumn(i,"ATEXT"));
			j++;
		}
	}

	if(ds_save6.RowCount() == 0) return;

	tit_clearActionInfo();
 	tit_addMultiActionInfo("cs41:CS4108001B_I3");
	tit_callService(
        ""
        , ""
        , "ds_save6=ds_save6"
        , ""
        , ""
        , "fn_afterSave"
        , true);
}
function fn_enable() {
	btn_saveZcst005.Enable = false;
	btn_plus.Enable = false;
	btn_save6.Enable = false;
	btn_init.Enable = false;

	//if(G_USER_ID == "2021056" || G_USER_ID == "2021200" || G_USER_ID == "2023687" || G_USER_ID == "2018900" || G_USER_ID == "2029758" || G_USER_ID == "2999999") {
	if(confirmCancle_visible_auth == true) {
		btn_init.Enable = true;
	}
	btn_minus.Enable = false;
	btn_save_atext.Enable = false;
}
function ds_list3_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{
	var yyyymm  = ds_end.GetColumn(0, "YYYYMM");

	if(strColumnID =="BLDAT") {
		if(varNewValue <> "") {
			if(substr(varNewValue,0,6) < yyyymm) {
				alert("전기일이 마감되었습니다.");
				ds_list3.SetColumn(nRow,"BLDAT","");
			}
		}
	}
}
]]></Script>
</Window>