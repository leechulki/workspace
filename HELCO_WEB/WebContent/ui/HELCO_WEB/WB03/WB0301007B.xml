<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="516" Id="WB0301001B" Left="8" OnKeyDown="gfn_EnterInForm" OnLoadCompleted="fn_OnLoadCompleted" PidAttrib="7" Title="사원검색" ToolTipFont="Default,0" Top="8" Ver="1.0" Width="656" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_list">
				<Contents>
					<colinfo id="SW_IDX" size="256" summ="default" type="STRING"/>
					<colinfo id="SW_GUBUN" size="256" summ="default" type="STRING"/>
					<colinfo id="SW_TITLE" size="256" summ="default" type="STRING"/>
					<colinfo id="SW_LIC" size="256" summ="default" type="STRING"/>
					<colinfo id="SW_LIC_TERM" size="256" summ="default" type="STRING"/>
					<colinfo id="SW_CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="SW_MAIN_DPT" size="256" summ="default" type="STRING"/>
					<colinfo id="SW_CUS_DPT" size="256" summ="default" type="STRING"/>
					<colinfo id="SW_LIC_DATE" size="256" summ="default" type="STRING"/>
					<colinfo id="SW_LIC_KEY" size="256" summ="default" type="STRING"/>
					<colinfo id="REMARK" size="1000" summ="default" type="STRING"/>
					<colinfo id="SW_MONEY" size="256" summ="default" type="DECIMAL"/>
					<record>
						<REMARK></REMARK>
						<SW_CNT></SW_CNT>
						<SW_CUS_DPT></SW_CUS_DPT>
						<SW_GUBUN></SW_GUBUN>
						<SW_IDX></SW_IDX>
						<SW_LIC></SW_LIC>
						<SW_LIC_DATE></SW_LIC_DATE>
						<SW_LIC_KEY></SW_LIC_KEY>
						<SW_LIC_TERM></SW_LIC_TERM>
						<SW_MAIN_DPT></SW_MAIN_DPT>
						<SW_MONEY/>
						<SW_TITLE></SW_TITLE>
					</record>
				</Contents>
			</Dataset>
		</Datasets>
		<Shape BKColor="user12" Bottom="513" Height="230" Id="Shape8" Left="0" LineColor="user13" Right="656" TabOrder="27" Top="283" Type="Rectangle" Width="656"></Shape>
		<Shape BKColor="user12" Bottom="291" Height="26" Id="Shape10" Left="0" LineColor="user13" Right="656" TabOrder="31" Top="265" Type="Rectangle" Width="656"></Shape>
		<Shape BKColor="user12" Bottom="266" Height="26" Id="Shape7" Left="0" LineColor="user13" Right="656" TabOrder="26" Top="240" Type="Rectangle" Width="656"></Shape>
		<Div Height="36" Id="div_btn" TabOrder="9" Url="WB01::CommBtnForm.xml" Width="656">
			<Contents></Contents>
		</Div>
		<Shape BKColor="user12" Bottom="66" Height="26" Id="Shape9" Left="0" LineColor="user13" Right="656" TabOrder="11" Top="40" Type="Rectangle" Width="656"></Shape>
		<Static Align="Right" Height="24" Id="Static7" Left="1" Style="sty_lb_form_basic" TabOrder="10" Text="소프트웨어&#32;분류&#32;" Top="41" VAlign="Middle" Width="111"></Static>
		<Shape BKColor="user12" Bottom="91" Height="26" Id="Shape0" Left="0" LineColor="user13" Right="656" TabOrder="13" Top="65" Type="Rectangle" Width="656"></Shape>
		<Shape BKColor="user12" Bottom="116" Height="26" Id="Shape1" Left="0" LineColor="user13" Right="656" TabOrder="14" Top="90" Type="Rectangle" Width="656"></Shape>
		<Shape BKColor="user12" Bottom="141" Height="26" Id="Shape2" Left="0" LineColor="user13" Right="656" TabOrder="15" Top="115" Type="Rectangle" Width="656"></Shape>
		<Shape BKColor="user12" Bottom="166" Height="26" Id="Shape3" Left="0" LineColor="user13" Right="656" TabOrder="16" Top="140" Type="Rectangle" Width="656"></Shape>
		<Shape BKColor="user12" Bottom="191" Height="26" Id="Shape4" Left="0" LineColor="user13" Right="656" TabOrder="17" Top="165" Type="Rectangle" Width="656"></Shape>
		<Shape BKColor="user12" Bottom="216" Height="26" Id="Shape5" Left="0" LineColor="user13" Right="656" TabOrder="18" Top="190" Type="Rectangle" Width="656"></Shape>
		<Shape BKColor="user12" Bottom="241" Height="26" Id="Shape6" Left="0" LineColor="user13" Right="656" TabOrder="19" Top="215" Type="Rectangle" Width="656"></Shape>
		<Static Align="Right" Height="24" Id="Static0" Left="1" Style="sty_lb_form_basic" TabOrder="12" Text="소프트웨어&#32;명&#32;" Top="66" VAlign="Middle" Width="111"></Static>
		<Static Align="Right" Height="24" Id="Static1" Left="1" Style="sty_lb_form_basic" TabOrder="20" Text="계&#32;약&#32;명&#32;" Top="91" VAlign="Middle" Width="111"></Static>
		<Static Align="Right" Height="24" Id="Static2" Left="1" Style="sty_lb_form_basic" TabOrder="21" Text="계약기간&#32;" Top="116" VAlign="Middle" Width="111"></Static>
		<Static Align="Right" Height="24" Id="Static3" Left="1" Style="sty_lb_form_basic" TabOrder="22" Text="수&#32;량&#32;" Top="141" VAlign="Middle" Width="111"></Static>
		<Static Align="Right" Height="24" Id="Static4" Left="1" Style="sty_lb_form_basic" TabOrder="23" Text="주사용부서&#32;" Top="191" VAlign="Middle" Width="111"></Static>
		<Static Align="Right" Height="24" Id="Static5" Left="1" Style="sty_lb_form_basic" TabOrder="24" Text="구매부서&#32;" Top="216" VAlign="Middle" Width="111"></Static>
		<Static Align="Right" Height="24" Id="Static6" Left="1" Style="sty_lb_form_basic" TabOrder="25" Text="구입년월&#32;" Top="241" VAlign="Middle" Width="111"></Static>
		<Static Align="Right" Height="24" Id="Static8" Left="1" Style="sty_lb_form_basic" TabOrder="28" Text="라이선스&#32;키&#32;" Top="266" VAlign="Middle" Width="111"></Static>
		<Static Align="Right" Height="221" Id="Static9" Left="1" Style="sty_lb_form_basic" TabOrder="29" Text="비&#32;고&#32;" Top="291" VAlign="Middle" Width="111"></Static>
		<Edit BindDataset="ds_list" Border="Flat" Column="SW_CUS_DPT" Height="20" Id="ed_sw_cus_dpt" Left="116" LeftMargin="2" RightMargin="2" Style="sty_ipt_form" TabOrder="6" Top="218" Width="532"></Edit>
		<Edit BindDataset="ds_list" Border="Flat" Column="SW_MAIN_DPT" Height="20" Id="ed_sw_main_dpt" Left="116" LeftMargin="2" RightMargin="2" Style="sty_ipt_form" TabOrder="5" Top="193" Width="532"></Edit>
		<Edit BindDataset="ds_list" Border="Flat" Column="SW_LIC_TERM" Height="20" Id="ed_sw_lic_term" Left="116" LeftMargin="2" RightMargin="2" Style="sty_ipt_form" TabOrder="4" Top="118" Width="532"></Edit>
		<Edit BindDataset="ds_list" Border="Flat" Column="SW_LIC" Height="20" Id="ed_sw_lic" Left="116" LeftMargin="2" RightMargin="2" Style="sty_ipt_form" TabOrder="3" Top="93" Width="532"></Edit>
		<Edit BindDataset="ds_list" Border="Flat" Column="SW_TITLE" Height="20" Id="ed_sw_title" Left="116" LeftMargin="2" RightMargin="2" Style="sty_ipt_form" TabOrder="2" Top="68" Width="532"></Edit>
		<Edit BindDataset="ds_list" Border="Flat" Column="SW_GUBUN" Height="20" Id="ed_sw_gubun" Left="116" LeftMargin="2" RightMargin="2" Style="sty_ipt_form" TabOrder="1" Top="43" Width="532"></Edit>
		<Edit BindDataset="ds_list" Border="Flat" Column="SW_LIC_KEY" Height="20" Id="ed_sw_lic_key" Left="116" LeftMargin="2" RightMargin="2" Style="sty_ipt_form" TabOrder="7" Top="268" Width="532"></Edit>
		<TextArea BindDataset="ds_list" Border="Flat" BorderColor="user13" Column="REMARK" Height="211" Id="txt_remark" Left="116" TabOrder="8" Top="294" VScroll="TRUE" Width="532"></TextArea>
		<Static Align="Right" Height="24" Id="Static10" Left="1" Style="sty_lb_form_basic" TabOrder="30" Text="구입비&#32;" Top="166" VAlign="Middle" Width="111"></Static>
		<Calendar BindDataset="ds_list" Border="Flat" BorderColor="user13" ClickedBkColor="user32" ClickedTextColor="user33" Column="SW_LIC_DATE" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_sw_lic_date" Left="116" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_search" SundayTextColor="user35" TabOrder="32" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="243" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="99"></Calendar>
		<MaskEdit BindDataset="ds_list" Border="Flat" Column="SW_MONEY" DisableBKColor="user5" Face3dColor="user13" Height="20" Id="me_sw_money" Left="116" Style="sty_ipt_form" TabOrder="33" Top="168" Width="139"></MaskEdit>
		<MaskEdit BindDataset="ds_list" Border="Flat" Column="SW_CNT" DisableBKColor="user5" Face3dColor="user13" Height="20" Id="me_sw_cnt" Left="116" Style="sty_ipt_form" TabOrder="34" Top="143" Width="139"></MaskEdit>
	</Form>
	<Script><![CDATA[﻿﻿﻿﻿﻿﻿﻿﻿/*
 ******************************************************************************************
 * 기      능   : 
 * 작  성  자   : 
 * 작성  일자   : 
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
#include "LIB::commons.js";	// 공통 스크립트 
//=========================================================================================
// [ PART 1 ]
// Form에서 사용될 전역변수를 선언
// FORM에서 사용되는 전역변수는 대문자로 작성하며, F_XXX 의 형태를 갖도록 한다. 
//=========================================================================================
var strId ="";
//=========================================================================================
// [ PART 2 ]
// Form Loading / Unloading 시 작업 정의
//=========================================================================================
function fn_OnLoadCompleted(obj) {
	gfn_initForm();

	// 신규인지 수정인지 구분
	if(gubun == 'U'){
		ed_sw_gubun.Text = sw_gubun;
		ed_sw_title.Text = sw_title;
		ed_sw_lic.Text = sw_lic;
		ed_sw_lic_term.Text = sw_lic_term;
		me_sw_cnt.Text = sw_cnt;
		me_sw_money.Text = sw_money;
		ed_sw_main_dpt.Text = sw_main_dpt;
		ed_sw_cus_dpt.Text = sw_cus_dpt;
		cal_sw_lic_date.value = sw_lic_date;
		ed_sw_lic_key.Text = sw_lic_key;
		txt_remark.Text = remark;		
	}
}
/********************************************************************************
* 기      능   : form UnloadCompleted 
********************************************************************************/
function fn_OnUnloadCompleted(obj) {
	return gfn_isFormUnload(obj);
}

function fn_query() {	
	
	gfn_clearGridSortMark(grd_list);
	
	tit_clearActionInfo();
	tit_addSearchActionInfo("wb03:WB0301006C_S1");

	tit_callService(
        ""
        , ""
        , "ds_cond=ds_cond"
        , "ds_list=ds_list"
        , ""
        , "fn_afterQuery"
        , true);
        
}

/********************************************************************************
* 기      능   : 닫기  
********************************************************************************/
function fn_close() {
	close(null);
}
/********************************************************************************
* 기      능   : 액셀  
********************************************************************************/
function fn_excel() {
	// Excel Export 
	gfn_saveToExcel(grd_list, true );	
}
//=========================================================================================
// [ PART 4]
// Callback 함수 정의 : callback 함수명은 메인 함수의 fn_xxxx() 에서 xxxx 부분은 fn_afterXXXX()
// 형태가 되도록 작성 
//=========================================================================================
/********************************************************************************
* 기      능   : 조회 Callback  
********************************************************************************/
function fn_afterQuery(errCode, errMsg) {
	// 메시지 처리 
	gfn_showSearchMsg(grd_list);
}


function fn_save() {

	if (!gfn_showConfirm("CI00010")) {
		return;
	}

	tit_clearActionInfo();
	if(gubun == 'I'){
		tit_addSingleActionInfo("wb03:WB0301007B_I1");
	} else if (gubun == 'U'){
		ds_list.SetColumn(0, "SW_IDX", sw_idx);
		tit_addSingleActionInfo("wb03:WB0301007B_U1");
	}
			
	tit_callService(
		""
		, ""
		, "ds_list=ds_list"
		, ""
		, ""
		, "fn_afterSave"
		, true);
}

function fn_afterSave(){
	parent.fn_query();
	parent.fn_reload_detail(ed_sw_gubun.Text);
	close();
}]]></Script>
</Window>