<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="592" Id="CS1304001B" Left="8" OnLoadCompleted="fn_OnLoadCompleted" OnUnloadCompleted="fn_OnUnloadCompleted" PidAttrib="7" Title="실패보고상세" Top="8" Ver="1.0" Width="898" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_sel">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_fail">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond">
				<Contents>
					<colinfo id="SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="PJT" size="256" summ="default" type="STRING"/>
					<colinfo id="UPN" size="256" summ="default" type="STRING"/>
					<colinfo id="CST" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="ARA" size="256" summ="default" type="STRING"/>
					<colinfo id="BSU" size="256" summ="default" type="STRING"/>
					<colinfo id="BPM" size="256" summ="default" type="STRING"/>
					<colinfo id="DOCNO" size="256" summ="default" type="STRING"/>
					<colinfo id="VKGRP" size="256" summ="default" type="STRING"/>
					<colinfo id="SPART" size="256" summ="default" type="STRING"/>
					<record>
						<ARA></ARA>
						<BPM></BPM>
						<BSU></BSU>
						<CST></CST>
						<DOCNO></DOCNO>
						<GBN></GBN>
						<PJT></PJT>
						<SEQ></SEQ>
						<SPART></SPART>
						<UPN></UPN>
						<VKGRP></VKGRP>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_conCnt">
				<Contents>
					<colinfo id="CNT" size="256" type="INT"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_fsdCnt">
				<Contents>
					<colinfo id="CNT" size="256" type="INT"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list2">
				<Contents>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="PJT" size="256" summ="default" type="STRING"/>
					<colinfo id="HNO" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="PST" size="256" summ="default" type="STRING"/>
					<colinfo id="PST_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="HNO_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSPEC2" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSPEC1" size="256" summ="default" type="STRING"/>
					<colinfo id="GND" size="256" summ="default" type="STRING"/>
					<colinfo id="GND_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="NAM_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="SPT_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="USD" size="256" summ="default" type="STRING"/>
					<colinfo id="UMR" size="256" summ="default" type="STRING"/>
					<colinfo id="TOT" size="256" summ="default" type="STRING"/>
					<colinfo id="SEL" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="JHD" size="256" summ="default" type="STRING"/>
					<colinfo id="FSA" size="256" summ="default" type="STRING"/>
					<colinfo id="REQ" size="256" summ="default" type="STRING"/>
					<colinfo id="RLT" size="256" summ="default" type="STRING"/>
					<colinfo id="RMK" size="256" summ="default" type="STRING"/>
					<colinfo id="CS145_ARA" size="256" summ="default" type="STRING"/>
					<colinfo id="SCP" size="256" summ="default" type="STRING"/>
					<colinfo id="SCD" size="256" summ="default" type="STRING"/>
					<colinfo id="YMD" size="256" summ="default" type="STRING"/>
					<colinfo id="YM2" size="256" summ="default" type="STRING"/>
					<colinfo id="UNT" size="256" summ="default" type="STRING"/>
					<colinfo id="AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="NEW" size="256" summ="default" type="STRING"/>
					<colinfo id="UPN" size="256" summ="default" type="STRING"/>
					<colinfo id="CST" size="256" summ="default" type="STRING"/>
					<colinfo id="GNO" size="256" summ="default" type="STRING"/>
					<colinfo id="ARA" size="256" summ="default" type="STRING"/>
					<colinfo id="BSU" size="256" summ="default" type="STRING"/>
					<colinfo id="BPM" size="256" summ="default" type="STRING"/>
					<colinfo id="HST" size="256" summ="default" type="STRING"/>
					<colinfo id="FBD" size="256" summ="default" type="STRING"/>
					<colinfo id="FBJ" size="256" summ="default" type="STRING"/>
					<colinfo id="FJD" size="256" summ="default" type="STRING"/>
					<colinfo id="FJJ" size="256" summ="default" type="STRING"/>
					<colinfo id="FSD" size="256" summ="default" type="STRING"/>
					<colinfo id="FSJ" size="256" summ="default" type="STRING"/>
					<colinfo id="HMK" size="256" summ="default" type="STRING"/>
					<colinfo id="UPD" size="256" summ="default" type="STRING"/>
					<colinfo id="GPT" size="256" summ="default" type="STRING"/>
					<colinfo id="HJT" size="256" summ="default" type="STRING"/>
					<colinfo id="TSA" size="256" summ="default" type="STRING"/>
					<colinfo id="HDD" size="256" summ="default" type="STRING"/>
					<colinfo id="HNT" size="256" summ="default" type="STRING"/>
					<colinfo id="HMT" size="256" summ="default" type="STRING"/>
					<colinfo id="HPT_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="DOCNO" size="256" summ="default" type="STRING"/>
					<colinfo id="FLG" size="256" summ="default" type="STRING"/>
					<colinfo id="IFS" size="256" summ="default" type="STRING"/>
					<colinfo id="IFSV" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_hstCnt">
				<Contents>
					<colinfo id="CNT" size="256" type="INT"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list4">
				<Contents>
					<colinfo id="JHD" size="24" summ="default" type="STRING"/>
					<colinfo id="MNY" size="11" summ="default" type="INT"/>
					<colinfo id="FSA" size="256" summ="default" type="STRING"/>
					<colinfo id="REQ" size="150" summ="default" type="STRING"/>
					<colinfo id="RLT" size="150" summ="default" type="STRING"/>
					<colinfo id="RMK" size="150" summ="default" type="STRING"/>
					<colinfo id="SCP" size="150" summ="default" type="STRING"/>
					<colinfo id="UNT" size="11" summ="default" type="INT"/>
					<colinfo id="UPN" size="18" summ="default" type="STRING"/>
					<colinfo id="YMD" size="24" summ="default" type="STRING"/>
					<colinfo id="AMT" size="11" summ="default" type="INT"/>
					<colinfo id="BSU_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="ARA_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="SPT" size="256" summ="default" type="STRING"/>
					<colinfo id="CNT" size="11" summ="default" type="INT"/>
					<colinfo id="CDATE" size="256" summ="default" type="STRING"/>
					<colinfo id="EPN" size="256" summ="default" type="STRING"/>
					<colinfo id="NAM" size="256" summ="default" type="STRING"/>
					<colinfo id="MAMT" size="11" summ="default" type="INT"/>
					<colinfo id="ZSPEC1" size="256" summ="default" type="STRING"/>
					<colinfo id="HMK" size="256" summ="default" type="STRING"/>
					<colinfo id="SEL" size="256" summ="default" type="STRING"/>
					<colinfo id="FAIL" size="256" summ="default" type="STRING"/>
					<colinfo id="ISD" size="256" summ="default" type="STRING"/>
					<colinfo id="HJT" size="256" summ="default" type="STRING"/>
					<colinfo id="HPT_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="HDD" size="256" summ="default" type="STRING"/>
					<colinfo id="HNT" size="256" summ="default" type="STRING"/>
					<colinfo id="HMT" size="256" summ="default" type="STRING"/>
					<colinfo id="UMR" size="256" summ="default" type="STRING"/>
					<colinfo id="CNT_H" size="256" summ="default" type="STRING"/>
					<colinfo id="GGB" size="256" summ="default" type="STRING"/>
					<colinfo id="TEM_NM1" size="256" summ="default" type="STRING"/>
					<colinfo id="TEM_NM2" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ara_cd">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_scd_cd">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<colinfo id="CS145_ARA" size="256" summ="default" type="STRING"/>
					<colinfo id="CS145_GSO" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list5">
				<Contents>
					<colinfo id="CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="YDT" size="256" summ="default" type="STRING"/>
					<colinfo id="YMT" size="256" summ="default" type="STRING"/>
					<colinfo id="HJT" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="TSA" size="256" summ="default" type="STRING"/>
					<colinfo id="HPT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond_2">
				<Contents>
					<colinfo id="PJT" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="256" summ="default" type="STRING"/>
					<record>
						<PJT></PJT>
						<SEQ></SEQ>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond_req">
				<Contents>
					<colinfo id="DOCNO" size="256" summ="default" type="STRING"/>
					<record>
						<DOCNO></DOCNO>
					</record>
				</Contents>
			</Dataset>
			<Dataset CanColumnChange="ds_list_CanColumnChange" DataSetType="Dataset" Id="ds_list">
				<Contents>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="PJT" size="256" summ="default" type="STRING"/>
					<colinfo id="HNO" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="PST" size="256" summ="default" type="STRING"/>
					<colinfo id="PST_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="HNO_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSPEC2" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSPEC1" size="256" summ="default" type="STRING"/>
					<colinfo id="GND" size="256" summ="default" type="STRING"/>
					<colinfo id="GND_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="NAM_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="SPT_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="USD" size="256" summ="default" type="STRING"/>
					<colinfo id="UMR" size="256" summ="default" type="STRING"/>
					<colinfo id="TOT" size="256" summ="default" type="STRING"/>
					<colinfo id="SEL" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="JHD" size="256" summ="default" type="STRING"/>
					<colinfo id="FSA" size="256" summ="default" type="STRING"/>
					<colinfo id="REQ" size="256" summ="default" type="STRING"/>
					<colinfo id="RLT" size="256" summ="default" type="STRING"/>
					<colinfo id="RMK" size="256" summ="default" type="STRING"/>
					<colinfo id="CS145_ARA" size="256" summ="default" type="STRING"/>
					<colinfo id="SCP" size="256" summ="default" type="STRING"/>
					<colinfo id="SCD" size="256" summ="default" type="STRING"/>
					<colinfo id="YMD" size="256" summ="default" type="STRING"/>
					<colinfo id="YM2" size="256" summ="default" type="STRING"/>
					<colinfo id="UNT" size="256" summ="default" type="STRING"/>
					<colinfo id="AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="NEW" size="256" summ="default" type="STRING"/>
					<colinfo id="UPN" size="256" summ="default" type="STRING"/>
					<colinfo id="CST" size="256" summ="default" type="STRING"/>
					<colinfo id="GNO" size="256" summ="default" type="STRING"/>
					<colinfo id="ARA" size="256" summ="default" type="STRING"/>
					<colinfo id="BSU" size="256" summ="default" type="STRING"/>
					<colinfo id="BPM" size="256" summ="default" type="STRING"/>
					<colinfo id="HST" size="256" summ="default" type="STRING"/>
					<colinfo id="FBD" size="256" summ="default" type="STRING"/>
					<colinfo id="FBJ" size="256" summ="default" type="STRING"/>
					<colinfo id="FJD" size="256" summ="default" type="STRING"/>
					<colinfo id="FJJ" size="256" summ="default" type="STRING"/>
					<colinfo id="FSD" size="256" summ="default" type="STRING"/>
					<colinfo id="FSJ" size="256" summ="default" type="STRING"/>
					<colinfo id="BSU_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="ARA_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="EPN" size="256" summ="default" type="STRING"/>
					<colinfo id="CDATE" size="256" summ="default" type="STRING"/>
					<colinfo id="NAM" size="256" summ="default" type="STRING"/>
					<colinfo id="HMK" size="256" summ="default" type="STRING"/>
					<colinfo id="HJT" size="256" summ="default" type="STRING"/>
					<colinfo id="TSA" size="256" summ="default" type="STRING"/>
					<colinfo id="HDD" size="256" summ="default" type="STRING"/>
					<colinfo id="HNT" size="256" summ="default" type="STRING"/>
					<colinfo id="HMT" size="256" summ="default" type="STRING"/>
					<colinfo id="HPT_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="KND_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="HYN" size="256" summ="default" type="STRING"/>
					<colinfo id="DYN" size="256" summ="default" type="STRING"/>
					<colinfo id="CNT_H" size="256" summ="default" type="STRING"/>
					<colinfo id="GGB" size="256" summ="default" type="STRING"/>
					<colinfo id="TEM_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="TEM" size="256" summ="default" type="STRING"/>
					<colinfo id="G_LGORT" size="256" summ="default" type="STRING"/>
					<colinfo id="APSTAT" size="256" summ="default" type="STRING"/>
					<colinfo id="REDPT1" size="256" summ="default" type="STRING"/>
					<colinfo id="DOCNO" size="256" summ="default" type="STRING"/>
					<colinfo id="FLG" size="256" summ="default" type="STRING"/>
					<colinfo id="IFS" size="256" summ="default" type="STRING"/>
					<colinfo id="IFSV" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list_chk">
				<Contents>
					<colinfo id="DOCNO" size="256" summ="default" type="STRING"/>
					<colinfo id="APPGUBN" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQNO" size="256" summ="default" type="STRING"/>
					<colinfo id="CHKSEQ" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond_chk">
				<Contents>
					<colinfo id="SEQ" size="256" summ="default" type="STRING"/>
					<record>
						<SEQ></SEQ>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_docno_gen">
				<Contents>
					<colinfo id="PFX" size="256" summ="default" type="STRING"/>
					<colinfo id="DOCNO" size="256" summ="default" type="STRING"/>
					<record>
						<DOCNO></DOCNO>
						<PFX></PFX>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_decide">
				<Contents>
					<colinfo id="MANDT" size="256" summ="default" type="STRING"/>
					<colinfo id="DOCNO" size="256" summ="default" type="STRING"/>
					<colinfo id="DOCKIND" size="256" summ="default" type="STRING"/>
					<colinfo id="APPGUBN" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQNO" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQSTAT" size="256" summ="default" type="STRING"/>
					<colinfo id="APDPT1" size="256" summ="default" type="STRING"/>
					<colinfo id="APDPT1_N" size="256" summ="default" type="STRING"/>
					<colinfo id="APNUM" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE" size="256" summ="default" type="STRING"/>
					<colinfo id="APTIM" size="256" summ="default" type="STRING"/>
					<colinfo id="APDESC" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_apstat">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_output"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_status">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_doc_status">
				<Contents>
					<colinfo id="APSTAT" size="256" summ="default" type="STRING"/>
					<record>
						<CNT></CNT>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_conf_list">
				<Contents>
					<colinfo id="APRNK_S1" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM_S1" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE_S1" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK_S2" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM_S2" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE_S2" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK_S3" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM_S3" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE_S3" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK_S4" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM_S4" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE_S4" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK_S5" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM_S5" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE_S5" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK_R1" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM_R1" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE_R1" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK_R2" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM_R2" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE_R2" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK_R3" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM_R3" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE_R3" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK_R4" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM_R4" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE_R4" size="256" summ="default" type="STRING"/>
					<colinfo id="APRNK_R5" size="256" summ="default" type="STRING"/>
					<colinfo id="APIRUM_R5" size="256" summ="default" type="STRING"/>
					<colinfo id="APDATE_R5" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_draftpers_list">
				<Contents>
					<colinfo id="D_TEM" size="256" summ="default" type="STRING"/>
					<colinfo id="D_RANK" size="256" summ="default" type="STRING"/>
					<colinfo id="D_NAME" size="256" summ="default" type="STRING"/>
					<colinfo id="D_DATE" size="256" summ="default" type="STRING"/>
					<colinfo id="DOCNO" size="256" summ="default" type="STRING"/>
					<colinfo id="D_TOTEM" size="256" summ="default" type="STRING"/>
					<record>
						<D_DATE></D_DATE>
						<D_NAME></D_NAME>
						<D_RANK></D_RANK>
						<D_TEM></D_TEM>
						<D_TOTEM></D_TOTEM>
						<DOCNO></DOCNO>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_rcond">
				<Contents>
					<colinfo id="ZPROGRAM" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN" size="256" summ="default" type="STRING"/>
					<record>
						<GBN></GBN>
						<ZPROGRAM></ZPROGRAM>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_flg">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME>-&#32;선택&#32;-</CODE_NAME>
					</record>
					<record>
						<CODE>A</CODE>
						<CODE_NAME>공동수급업체</CODE_NAME>
					</record>
					<record>
						<CODE>B</CODE>
						<CODE_NAME>타사</CODE_NAME>
					</record>
					<record>
						<CODE>C</CODE>
						<CODE_NAME>기타</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_wbap01">
				<Contents>
					<colinfo id="APSTAT" size="3" summ="default" type="STRING"/>
					<colinfo id="CRDATE" size="24" summ="default" type="STRING"/>
					<colinfo id="CRDPT1" size="24" summ="default" type="STRING"/>
					<colinfo id="CRDPT1_N" size="60" summ="default" type="STRING"/>
					<colinfo id="CRIRUM" size="60" summ="default" type="STRING"/>
					<colinfo id="CRTIM" size="18" summ="default" type="STRING"/>
					<colinfo id="DOCKIND" size="3" summ="default" type="STRING"/>
					<colinfo id="DOCNO" size="30" summ="default" type="STRING"/>
					<colinfo id="DOCSEQ" size="6" summ="default" type="STRING"/>
					<colinfo id="REDATE" size="24" summ="default" type="STRING"/>
					<colinfo id="REDPT1" size="24" summ="default" type="STRING"/>
					<colinfo id="REDPT1_N" size="60" summ="default" type="STRING"/>
					<colinfo id="REIRUM" size="60" summ="default" type="STRING"/>
					<colinfo id="RETIM" size="18" summ="default" type="STRING"/>
					<colinfo id="FNAM" size="256" summ="default" type="STRING"/>
					<colinfo id="FSIZE" size="256" summ="default" type="STRING"/>
					<colinfo id="FILE_PATH" size="256" summ="default" type="STRING"/>
					<colinfo id="TELH" size="30" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_wbap02">
				<Contents>
					<colinfo id="APDATE" size="24" summ="default" type="STRING"/>
					<colinfo id="APDESC" size="0" summ="default" type="STRING"/>
					<colinfo id="APDPT1" size="24" summ="default" type="STRING"/>
					<colinfo id="APDPT1_N" size="60" summ="default" type="STRING"/>
					<colinfo id="APIRUM" size="60" summ="default" type="STRING"/>
					<colinfo id="APNUM" size="24" summ="default" type="STRING"/>
					<colinfo id="APPGUBN" size="6" summ="default" type="STRING"/>
					<colinfo id="APRNK" size="60" summ="default" type="STRING"/>
					<colinfo id="APTIM" size="18" summ="default" type="STRING"/>
					<colinfo id="DOCKIND" size="3" summ="default" type="STRING"/>
					<colinfo id="DOCNO" size="30" summ="default" type="STRING"/>
					<colinfo id="DOCSEQ" size="6" summ="default" type="STRING"/>
					<colinfo id="SEQNO" size="6" summ="default" type="STRING"/>
					<colinfo id="SEQSTAT" size="3" summ="default" type="STRING"/>
					<colinfo id="TELH" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ifs_cd">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
		</Datasets>
		<Shape BKColor="user12" Bottom="298" Height="26" Id="Shape9" Left="8" LineColor="user13" Right="890" TabOrder="76" Top="272" Type="Rectangle" Width="882"></Shape>
		<Shape BKColor="user12" Bottom="447" Height="26" Id="Shape6" Left="8" LineColor="user13" Right="890" TabOrder="59" Top="421" Type="Rectangle" Width="882"></Shape>
		<Shape BKColor="user12" Bottom="422" Height="51" Id="Shape4" Left="8" LineColor="user13" Right="890" TabOrder="47" Top="371" Type="Rectangle" Width="882"></Shape>
		<Shape BKColor="user12" Bottom="537" Height="26" Id="Shape2" Left="8" LineColor="user13" Right="890" TabOrder="44" Top="511" Type="Rectangle" Width="882"></Shape>
		<Shape BKColor="user12" Bottom="372" Height="51" Id="Shape5" Left="8" LineColor="user13" Right="890" TabOrder="42" Top="321" Type="Rectangle" Width="882"></Shape>
		<Shape BKColor="user0" Bottom="88" Height="52" Id="Shape0" Left="0" LineColor="user1" Right="898" TabOrder="34" Top="36" Type="Rectangle" Width="898"></Shape>
		<Edit BindDataset="ds_list" Border="Flat" Column="SPT_NM" DisableBKColor="user5" Enable="FALSE" Height="20" Id="ed_spt" Left="552" Style="sty_ipt_search" TabOrder="3" Top="41" Width="193"></Edit>
		<Static Align="Right" Height="20" Id="st_spt" Left="469" Style="sty_lb_search" TabOrder="37" Text="현장명&#32;" Top="41" VAlign="Middle" Width="80"></Static>
		<Edit BindDataset="ds_list" Border="Flat" Column="NAM_NM" DisableBKColor="user5" Enable="FALSE" Height="20" Id="ed_nam" Left="274" Style="sty_ipt_search" TabOrder="2" Top="41" Width="193"></Edit>
		<Static Align="Right" Height="20" Id="st_nam" Left="192" Style="sty_lb_search" TabOrder="36" Text="고객명&#32;" Top="41" VAlign="Middle" Width="80"></Static>
		<Edit Border="Flat" Column="SEQ" DisableBKColor="user5" Enable="FALSE" Height="20" Id="ed_seq" Left="90" MaxLength="6" Style="sty_ipt_search" TabOrder="1" Top="41" UpperOnly="TRUE" Width="100"></Edit>
		<Static Align="Right" Height="20" Id="st_seq" Left="8" Style="sty_lb_search" TabOrder="35" Text="관리번호&#32;" Top="41" VAlign="Middle" Width="80"></Static>
		<Grid AutoFitEndLine="Hide" BindDataset="ds_list" BkColor2="default" BoldHead="true" Border="Flat" Bottom="264" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="168" Id="grd_list" InputPanel="FALSE" Left="8" LineColor="user20" LineType="ExHORZ" OnCellClick="grd_list_OnCellClick" OnHeadClick="grd_list_OnHeadClick" Right="891" RowHeight="20" Style="sty_grid" TabOrder="8" TabStop="true" Top="96" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="883">
			<contents>
				<format id="Default">
					<columns>
						<col width="21"/>
						<col width="35"/>
						<col width="42"/>
						<col width="60"/>
						<col width="50"/>
						<col width="100"/>
						<col width="100"/>
						<col width="110"/>
						<col width="70"/>
						<col width="80"/>
						<col width="75"/>
						<col width="75"/>
						<col width="75"/>
						<col width="60"/>
						<col width="50"/>
						<col width="50"/>
					</columns>
					<head>
						<cell align="center" col="0" color="user21" display="checkbox" edit="checkbox" font="굴림,9"/>
						<cell align="center" col="1" color="user21" display="text" font="굴림,9" text="No"/>
						<cell align="center" col="2" color="user21" display="text" font="굴림,9" text="상태"/>
						<cell align="center" col="3" color="user21" display="text" font="굴림,9" text="Proj&#32;No"/>
						<cell align="center" col="4" color="user21" display="text" font="굴림,9" text="호기"/>
						<cell align="center" col="5" color="user21" display="text" font="굴림,9" text="호기명"/>
						<cell align="center" col="6" color="user21" display="text" font="굴림,9" text="DIPBX&#32;번호"/>
						<cell align="center" col="7" color="user21" display="text" font="굴림,9" text="사양"/>
						<cell align="center" col="8" color="user21" display="text" font="굴림,9" text="기종"/>
						<cell align="center" col="9" color="user21" display="text" font="굴림,9" text="구분"/>
						<cell align="center" col="10" color="user21" display="text" font="굴림,9" text="개시일"/>
						<cell align="center" col="11" color="user21" display="text" font="굴림,9" text="만료일"/>
						<cell align="center" col="12" color="user21" display="text" font="굴림,9" text="월정보수료"/>
						<cell align="center" col="13" color="user21" display="text" font="굴림,9" text="FM상품"/>
						<cell align="center" col="14" color="user21" display="text" font="굴림,9" text="HRTS"/>
						<cell align="center" col="15" color="user21" display="text" font="굴림,9" text="DI-PBX"/>
					</head>
					<body>
						<cell bkcolor2="user22" col="0" colid="CHK" display="checkbox" edit="checkbox"/>
						<cell align="center" bkcolor2="user22" col="1" colid="CHK" display="text" expr="currow&#32;+&#32;1"/>
						<cell align="center" bkcolor2="user22" col="2" colid="PST_NM" display="text"/>
						<cell align="center" bkcolor2="user22" col="3" colid="PJT" display="text"/>
						<cell align="center" bkcolor2="user22" col="4" colid="HNO" display="text"/>
						<cell bkcolor2="user22" col="5" colid="HNO_NM" display="text"/>
						<cell align="center" bkcolor2="user22" col="6" colid="DIPBXNUMB" display="text"/>
						<cell bkcolor2="user22" col="7" colid="ZSPEC2" display="text"/>
						<cell align="center" bkcolor2="user22" col="8" colid="ZSPEC1" display="text"/>
						<cell align="center" bkcolor2="user22" col="9" colid="GND_NM" display="text"/>
						<cell align="center" bkcolor2="user22" col="10" colid="USD" display="text" Mask="####.##.##"/>
						<cell align="center" bkcolor2="user22" col="11" colid="UMR" display="text" Mask="####.##.##"/>
						<cell align="right" bkcolor2="user22" col="12" colid="TOT" display="number"/>
						<cell align="center" bkcolor2="user22" col="13" colid="KND_NM" display="text"/>
						<cell align="center" bkcolor2="user22" col="14" colid="HYN" display="text"/>
						<cell align="center" bkcolor2="user22" col="15" colid="DYN" display="text"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Shape BKColor="user12" Bottom="322" Height="26" Id="Shape1" Left="8" LineColor="user13" Right="890" TabOrder="38" Top="296" Type="Rectangle" Width="882"></Shape>
		<Static Align="Right" Height="24" Id="st_gbn" Left="49" Style="sty_lb_form_basic" TabOrder="39" Text="구분/사유&#32;" Top="297" VAlign="Middle" Width="78"></Static>
		<Static Align="Right" Height="24" Id="st_jhd" Left="468" Style="sty_lb_form_basic" TabOrder="41" Text="실패작성일자&#32;" Top="297" VAlign="Middle" Width="80"></Static>
		<Static Align="Right" Height="49" Id="st_fsa" Left="49" Style="sty_lb_form_basic" TabOrder="40" Text="당사요구안&#10;&#32;(255자)&#32;" Top="322" VAlign="Middle" Width="78"></Static>
		<TextArea BindDataset="ds_list" Border="Flat" Column="FSA" Height="45" Id="txt_fsa" ImeMode="native" Left="129" MaxLength="255" Style="sty_ipt_form" TabOrder="15" Top="324" VScroll="TRUE" Width="336"></TextArea>
		<Combo BindDataset="ds_list" Border="Flat" CodeColumn="CODE" Column="SEL" DataColumn="CODE_NAME" Enable="FALSE" Height="20" Id="cb_sel" InnerDataset="ds_sel" Left="128" OnChanged="cb_sel_OnChanged" Style="sty_ipt_form" TabOrder="12" Top="298" Width="100"></Combo>
		<Static Align="Right" Height="49" Id="st_rlt" Left="468" Style="sty_lb_form_basic" TabOrder="43" Text="협의결과&#32;&#10;&#32;(255자)&#32;" Top="322" VAlign="Middle" Width="80"></Static>
		<TextArea BindDataset="ds_list" Border="Flat" Column="RLT" Height="45" Id="txt_rlt" ImeMode="native" Left="550" MaxLength="255" Style="sty_ipt_form" TabOrder="16" Top="324" VScroll="TRUE" Width="336"></TextArea>
		<Shape BKColor="user12" Bottom="584" Height="48" Id="Shape3" Left="8" LineColor="user13" Right="890" TabOrder="45" Top="536" Type="Rectangle" Width="882"></Shape>
		<Static Align="Right" Height="49" Id="st_req" Left="49" Style="sty_lb_form_basic" TabOrder="46" Text="고객요구안&#32;&#10;&#32;(255자)" Top="372" VAlign="Middle" Width="78"></Static>
		<TextArea BindDataset="ds_list" Border="Flat" Column="REQ" Height="45" Id="txt_req" ImeMode="native" Left="129" MaxLength="255" Style="sty_ipt_form" TabOrder="17" Top="374" VScroll="TRUE" Width="336"></TextArea>
		<Static Align="Right" Height="49" Id="st_rmk" Left="468" Style="sty_lb_form_basic" TabOrder="48" Text="특기사항&#32;&#10;&#32;(255자)&#32;" Top="372" VAlign="Middle" Width="80"></Static>
		<TextArea BindDataset="ds_list" Border="Flat" Column="RMK" Height="45" Id="txt_rmk" ImeMode="native" Left="550" MaxLength="255" Style="sty_ipt_form" TabOrder="18" Top="374" VScroll="TRUE" Width="336"></TextArea>
		<Static Align="Center" BKColor="powderblue" Height="72" Id="Static7" Left="7" Style="sty_lb_form_group" TabOrder="49" Text="타사&#10;보수&#10;현황" Top="512" VAlign="Middle" Width="42"></Static>
		<Static Align="Right" Height="24" Id="st_scp" Left="49" Style="sty_lb_form_basic" TabOrder="50" Text="군소업체&#32;" Top="512" VAlign="Middle" Width="78"></Static>
		<Static Align="Right" Height="24" Id="st_unt" Left="49" Style="sty_lb_form_basic" TabOrder="51" Text="계약단가&#32;" Top="537" VAlign="Middle" Width="78"></Static>
		<Static Align="Right" Height="24" Id="st_ymd" Left="468" Style="sty_lb_form_basic" TabOrder="52" Text="타사계약기간&#32;" Top="512" VAlign="Middle" Width="80"></Static>
		<Calendar BindDataset="ds_list" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="JHD" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Enable="FALSE" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_jhd" Left="550" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="14" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="299" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="121"></Calendar>
		<Calendar BindDataset="ds_list" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="YMD" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_ymd" Left="550" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="30" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="514" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="121"></Calendar>
		<Div Height="36" Id="div_btn" TabOrder="53" Text="Div0" ToolTipFont="Default,0" Url="WB01::CommBtnForm.xml" Width="898">
			<Contents></Contents>
		</Div>
		<MaskEdit BindDataset="ds_list" Border="Flat" Column="UNT" Height="20" Id="med_unt" Left="129" Style="sty_ipt_form" TabOrder="32" Top="539" Width="148"></MaskEdit>
		<Static Align="Right" Height="24" Id="st_amt" Left="468" Style="sty_lb_form_basic" TabOrder="54" Text="월정보수료&#32;" Top="537" VAlign="Middle" Width="80"></Static>
		<MaskEdit BindDataset="ds_list" Border="Flat" Column="AMT" Height="20" Id="med_amt" Left="550" Style="sty_ipt_form" TabOrder="33" Top="539" Width="148"></MaskEdit>
		<Static Height="12" Id="Static15" Left="708" TabOrder="55" Text="(VAT&#32;별도)" Top="544" Width="70"></Static>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_fail_print" ImageID="btn_sub_07" Left="783" LeftMargin="12" OnClick="btn_fail_print_OnClick" Style="sty_btn" TabOrder="56" Text="해약보고서출력" Top="41" Transparent="TRUE" Width="107"></Button>
		<Combo BindDataset="ds_list" Border="Flat" CodeColumn="CODE" Column="GBN" DataColumn="CODE_NAME" Height="20" Id="cb_fail" InnerDataset="ds_fail" Left="228" OnChanged="cb_fail_OnChanged" Style="sty_ipt_form" TabOrder="13" Top="298" Width="238"></Combo>
		<Calendar BindDataset="ds_list" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="YM2" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_ym2" Left="694" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="31" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="514" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="121"></Calendar>
		<Static Align="Center" Border="None" Color="user7" Font="굴림,9" Height="20" Id="Static13" Left="674" TabOrder="57" Text="~" Top="514" VAlign="Middle" Width="18"></Static>
		<Combo BindDataset="ds_list" Border="Flat" CodeColumn="CODE" Column="CS145_ARA" DataColumn="CODE_NAME" Height="20" Id="cb_ara" InnerDataset="ds_ara_cd" Left="205" OnChanged="cb_ara_OnChanged" Style="sty_ipt_form" TabOrder="27" Top="513" Width="60"></Combo>
		<Combo BindDataset="ds_list" Border="Flat" CodeColumn="CODE" Column="SCD" DataColumn="CODE_NAME" Height="20" Id="cb_scd" InnerDataset="ds_scd_cd" Left="266" Style="sty_ipt_form" TabOrder="28" Top="513" Width="136"></Combo>
		<Static Align="Center" BKColor="powderblue" Border="None" Height="24" Id="Static0" Left="7" Style="sty_lb_form_group" TabOrder="58" Text="구분" Top="297" VAlign="Middle" Width="42"></Static>
		<Shape BKColor="user12" Bottom="471" Height="26" Id="Shape7" Left="8" LineColor="user13" Right="890" TabOrder="60" Top="445" Type="Rectangle" Width="882"></Shape>
		<MaskEdit BindDataset="ds_list" Border="Flat" Column="HNT" Height="20" Id="med_hnt" Left="550" MaxLength="4" Style="sty_ipt_form" TabOrder="23" Top="448" Width="104"></MaskEdit>
		<MaskEdit BindDataset="ds_list" Border="Flat" Column="HMT" Height="20" Id="med_hmt" Left="736" Style="sty_ipt_form" TabOrder="24" Top="448" Width="150"></MaskEdit>
		<Edit BindDataset="ds_list" Border="Flat" BorderColor="user13" Column="HPT_NM" DisableBKColor="user0" Height="20" Id="ed_hpt_nm" Left="550" Style="sty_ipt_form" TabOrder="21" Top="424" Width="336"></Edit>
		<Edit BindDataset="ds_list" Border="Flat" BorderColor="user13" Column="HJT" DisableBKColor="user0" Height="20" Id="ed_hjt" Left="211" Style="sty_ipt_form" TabOrder="19" Top="424" Width="112"></Edit>
		<Calendar BindDataset="ds_list" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="HDD" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_hdd" Left="211" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="22" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="448" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="121"></Calendar>
		<Shape BKColor="user12" Bottom="512" Height="43" Id="Shape8" Left="8" LineColor="user13" Right="890" TabOrder="61" Top="469" Type="Rectangle" Width="882"></Shape>
		<TextArea BindDataset="ds_list" Border="Flat" Column="HMK" Height="37" Id="txt_hmk" ImeMode="native" Left="211" MaxLength="255" Style="sty_ipt_form" TabOrder="25" Top="472" VScroll="TRUE" Width="675"></TextArea>
		<Static Align="Right" Height="89" Id="Static16" Left="49" Style="sty_lb_form_basic" TabOrder="62" Text="만회방안&#32;" Top="422" VAlign="Middle" Width="78"></Static>
		<Static Align="Center" BKColor="powderblue" Height="189" Id="Static8" Left="7" Style="sty_lb_form_group" TabOrder="63" Text="사유" Top="322" VAlign="Middle" Width="42"></Static>
		<Static Align="Right" Height="23" Id="st_hmt" Left="656" Style="sty_lb_form_basic" TabOrder="64" Text="금액&#32;" Top="446" VAlign="Middle" Width="80"></Static>
		<Static Align="Right" Height="23" Id="st_hnt" Left="468" Style="sty_lb_form_basic" TabOrder="65" Text="대수&#32;" Top="446" VAlign="Middle" Width="80"></Static>
		<Static Align="Right" Height="23" Id="st_hpt_nm" Left="468" Style="sty_lb_form_basic" TabOrder="66" Text="현장명&#32;" Top="422" VAlign="Middle" Width="80"></Static>
		<Static Align="Right" Height="23" Id="st_hjt" Left="129" Style="sty_lb_form_basic" TabOrder="67" Text="공사번호&#32;" Top="422" VAlign="Middle" Width="80"></Static>
		<Static Align="Right" Height="23" Id="st_hdd" Left="129" Style="sty_lb_form_basic" TabOrder="68" Text="회수&#32;예정일&#32;" Top="446" VAlign="Middle" Width="80"></Static>
		<Static Align="Right" Height="41" Id="st_hmk" Left="129" Style="sty_lb_form_basic" TabOrder="69" Text="비고&#32;&#10;&#32;(255자)" Top="470" VAlign="Middle" Width="80"></Static>
		<Static Align="Right" Height="23" Id="st_tsa" Left="360" Style="sty_lb_form_basic" TabOrder="70" Text="타사여부&#32;" Top="422" VAlign="Middle" Width="80"></Static>
		<Checkbox BindDataset="ds_list" Column="TSA" Height="20" Id="chk_tsa" Left="448" OnClick="chk_tsa_OnClick" Style="sty_ipt_search_ind_chk" TabOrder="20" Top="424" Value="FALSE" Width="15"></Checkbox>
		<Button Cursor="HAND" Height="22" Id="btn_pjt" ImageID="btn_icon_search" Left="328" OnClick="btn_pjt_OnClick" TabOrder="71" Text="Button0" Top="424" Transparent="TRUE" Width="18"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="22" Id="btn_hpi" ImageID="btn_sub_06" Left="360" OnClick="btn_hpi_OnClick" TabOrder="72" Text="회수계획입력" Top="448" Transparent="TRUE" Width="100"></Button>
		<Edit Align="CENTER" Border="Flat" Enable="FALSE" Height="20" Id="ed_docno" Left="130" MaxLength="6" Style="sty_ipt_search" TabOrder="9" Top="274" UpperOnly="TRUE" Width="118"></Edit>
		<Static Align="Center" Height="24" Id="Static1" Left="48" Style="sty_lb_form_basic" TabOrder="73" Text="결재번호" Top="272" VAlign="Middle" Width="80"></Static>
		<Static Align="Center" Height="24" Id="Static2" Left="258" Style="sty_lb_form_basic" TabOrder="74" Text="결재상태" Top="272" VAlign="Middle" Width="80"></Static>
		<Static Align="Center" BKColor="powderblue" Border="None" Height="24" Id="Static3" Left="7" Style="sty_lb_form_group" TabOrder="75" Top="272" VAlign="Middle" Width="42"></Static>
		<Combo Border="Flat" CodeColumn="CODE" DataColumn="DTEXT1" Enable="FALSE" Height="20" Id="cb_apstat" InnerDataset="ds_apstat" Left="339" Style="sty_ipt_search" TabOrder="10" Top="274" Width="127"></Combo>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="cODE" DataColumn="CODE_NAME" Enable="FALSE" Height="20" Id="cb_status" InnerDataset="ds_status" Left="549" Style="sty_ipt_search" TabOrder="11" Top="274" Width="123"></Combo>
		<Static Align="Center" Height="24" Id="Static4" Left="468" Style="sty_lb_form_basic" TabOrder="77" Text="진행상태" Top="272" VAlign="Middle" Width="80"></Static>
		<Button Cursor="HAND" Height="22" Id="btn_scd" ImageID="btn_icon_search" Left="403" OnClick="btn_scd_OnClick" TabOrder="78" Text="Button0" Top="515" Transparent="TRUE" Width="18"></Button>
		<Static Align="Right" Height="20" Id="st_vkgrp" Left="8" Style="sty_lb_search" TabOrder="79" Text="지사명&#32;" Top="64" VAlign="Middle" Width="80"></Static>
		<Edit BindDataset="ds_list" Border="Flat" Column="TEM_NM" DisableBKColor="user5" Enable="FALSE" Height="20" Id="ed_vkgrp" Left="90" MaxLength="6" Style="sty_ipt_search" TabOrder="4" Top="64" UpperOnly="TRUE" Width="100"></Edit>
		<Static Align="Right" Height="20" Id="st_bsu" Left="192" Style="sty_lb_search" TabOrder="80" Text="보수업체명&#32;" Top="64" VAlign="Middle" Width="80"></Static>
		<Edit BindDataset="ds_list" Border="Flat" Column="BSU_NM" DisableBKColor="user5" Enable="FALSE" Height="20" Id="ed_bsu" Left="274" Style="sty_ipt_search" TabOrder="5" Top="64" Width="193"></Edit>
		<Static Align="Right" Height="20" Id="st_cnt" Left="469" Style="sty_lb_search" TabOrder="81" Text="대수&#32;" Top="64" VAlign="Middle" Width="80"></Static>
		<Edit Border="Flat" DisableBKColor="user5" Enable="FALSE" Height="20" Id="ed_cnt" Left="552" Style="sty_ipt_search" TabOrder="6" Top="64" Width="104"></Edit>
		<Static Align="Right" Height="20" Id="st_gnd" Left="662" Style="sty_lb_search" TabOrder="82" Text="계약유형&#32;" Top="64" VAlign="Middle" Width="80"></Static>
		<Edit BindDataset="ds_list" Border="Flat" Column="GND_NM" DisableBKColor="user5" Enable="FALSE" Height="20" Id="ed_gnd" Left="744" Style="sty_ipt_search" TabOrder="7" Top="64" Width="104"></Edit>
		<Checkbox BKColor="user5" Height="20" Id="chk_ex" Left="424" OnClick="chk_ex_OnClick" Style="sty_ipt_search_ind_chk" TabOrder="29" Text="기타" Top="512" Value="FALSE" Width="43"></Checkbox>
		<Button ButtonStyle="TRUE" Cursor="HAND" Enable="FALSE" Height="20" Id="btn_admin" ImageID="btn_sub_02" Left="850" LeftMargin="12" OnClick="btn_admin_OnClick" Style="sty_btn" TabOrder="83" Text="승인" Top="64" Transparent="TRUE" Visible="FALSE" Width="42"></Button>
		<Combo BindDataset="ds_list" Border="Flat" CodeColumn="CODE" Column="FLG" DataColumn="CODE_NAME" Height="20" Id="cb_flg" InnerDataset="ds_flg" Left="128" OnChanged="cb_flg_OnChanged" Style="sty_ipt_form" TabOrder="26" Top="512" Width="76"></Combo>
		<Static Align="Right" Height="24" Id="st_ifs" Left="49" Style="sty_lb_form_basic" TabOrder="84" Text="정보출처&#32;" Top="561" VAlign="Middle" Visible="FALSE" Width="78"></Static>
		<Combo BindDataset="ds_list" Border="Flat" CodeColumn="CODE" Column="IFS" DataColumn="CODE_NAME" Height="20" Id="cb_ifs" InnerDataset="ds_ifs_cd" Left="129" OnChanged="cb_ifs_OnChanged" Style="sty_ipt_form" TabOrder="85" Top="561" Visible="FALSE" Width="255"></Combo>
		<Edit BindDataset="ds_list" Border="Flat" BorderColor="user13" Column="IFSV" DisableBKColor="user0" Height="20" Id="ed_ifsv" Left="384" Style="sty_ipt_form" TabOrder="86" Top="562" Visible="FALSE" Width="400"></Edit>
	</Form>
	<Script><![CDATA[/*
 ******************************************************************************************
 * 기      능   : 
 * 작  성  자   : 
 * 작성  일자   : 
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
#include "LIB::commons.js";	// 공통 스크립트
#include "LIB::common_cs.js";	// 서비스 공통 스크립트
#include "LIB::utility.js";	// 다중 선택 
//=========================================================================================
// [ PART 1 ]
// Form에서 사용될 전역변수를 선언
// FORM에서 사용되는 전역변수는 대문자로 작성하며, F_XXX 의 형태를 갖도록 한다. 
//=========================================================================================
var seq = "";
var nam = "";
var spt = "";
var pjt = "";
var isd = "";
var upn = "";
var cst = "";
var gbn = "";
var frm = "";
var jpgbn = "";
var query_chk = "N";
var req = "";
var fa_docno;

var btn_admin_auth = false; // 승인버튼 권한 플래그
var vDPT = "";
//=========================================================================================
// [ PART 2 ]
// Form Loading / Unloading 시 작업 정의
//=========================================================================================
function fn_OnLoadCompleted(obj) {
	gfn_initForm();
	
	// 공통코드 조회
	var codeArr = ["CS115","CS156","CS157","WBAP_STAT","CS117","IFS_CD"];
    var dsObjArr = [ds_ara_cd,ds_sel,ds_fail,ds_apstat,ds_status,ds_ifs_cd];
    var addTypeArr = [G_CODE_SELECT,G_CODE_SELECT,G_CODE_SELECT,G_CODE_NONE,G_CODE_NONE,G_CODE_SELECT];
    gfn_searchCommCode(codeArr, dsObjArr, addTypeArr, true); //동기처리
    
	gfn_initDs(ds_rcond, true);
	ds_rcond.SetColumn(0, "ZPROGRAM", "CS1304001B");
	ds_rcond.SetColumn(0, "GBN", "01");	
	btn_admin_auth = gfn_getAuth(ds_rcond);
	ds_rcond.ClearData();
	
	if(btn_admin_auth == true) {
		btn_admin.Visible = true;
		btn_admin.Enable = true;
	}
	//============== 수신부서 결재그룹 체크 ===============================	
	gfn_initDs(ds_rcond, true);
	ds_rcond.SetColumn(0, "ZPROGRAM", "WBAP_DOCKIND");
	ds_rcond.SetColumn(0, "GBN", "01");	
	vDPT = gfn_getAuthDpt(ds_rcond);
	ds_rcond.ClearData();
    //=========================================================    

	fn_query();
}

/********************************************************************************
* 기      능   : 공통코드가 조회된 후의 Callback 함수 
********************************************************************************/
function fn_completeInit(sCode, sDsObj, sCodeType) {
	ed_seq.Text = seq;
	ed_nam.Text = nam;
	ed_spt.Text = spt;
//	ed_vkgrp.Text = vkgrp;
//	ed_bsu.Text   = bsu;

	
	//b_fail.Enable = false;
	// 사용버튼 사용 비활성화 설정
	div_btn.btn_decide.enable = false;
	div_btn.btn_draft.enable = false;
	div_btn.btn_delete.enable = false;
	div_btn.btn_save.enable = false;
	
	tit_clearActionInfo();
	tit_addSearchActionInfo("cs13:CS1304001B_S10");
	tit_callService(
        ""
        , ""
        , ""
        , "ds_scd_cd=ds_list"
        , ""
        , "fn_afterCodeSearch"
        , true
        , false
        , true);

}

function fn_afterCodeSearch(errCode, errMsg) {
	ds_scd_cd.insertRow(0);
	ds_scd_cd.setColumn(0, "CODE", "0000");
	ds_scd_cd.setColumn(0, "CODE_NAME", "- 기타 -");
	ds_scd_cd.setColumn(0, "CS145_ARA", "XX");
	ds_scd_cd.setColumn(0, "CS145_GSO", "");

	if(length(trim(ed_seq.value)) == 0) {
		ds_scd_cd.Filter("CS145_ARA = 'XX'");
		cb_scd.Index = 0;
		//cb_scd.Enable = false;
	}
}

function ufn_btn() {	
	var uGroup = gfn_getUserGroup();

/* 권한 임시 삭제 2015.01
	// 실패보고 접수 화면에서 오픈 && 해당 권한에 따른 버튼 활성
	if(uGroup == '10') {
		div_btn.btn_save.enable = true;	    	// 저장
		div_btn.btn_draft.enable = false;		// 기안 2014.12.17 접수에서 기안으로 변경
		div_btn.btn_approval.enable = false;	// 승인
		div_btn.btn_decide.enable = false;		// 결재 2014.12.17 결재 생성
		div_btn.btn_trans.enable = true;		// 전송
		div_btn.btn_sendback.enable = false;	// 반송
		div_btn.btn_delete.enable = true;		// 삭제
	} else if(uGroup == '20') {
		div_btn.btn_save.enable = true;			// 저장
		div_btn.btn_draft.enable = true;		// 접수
		div_btn.btn_approval.enable = false;	// 승인
		div_btn.btn_decide.enable = false;		// 결재
		div_btn.btn_trans.enable = false;		// 전송
		div_btn.btn_sendback.enable = true;		// 반송
		div_btn.btn_delete.enable = false;		// 삭제	
	} else if(uGroup == '30') {
		div_btn.btn_save.enable = true;			// 저장
		div_btn.btn_draft.enable = false;		// 접수
		div_btn.btn_approval.enable = false;	// 승인
		div_btn.btn_decide.enable = false;		// 결재
		div_btn.btn_trans.enable = true;		// 전송
		div_btn.btn_sendback.enable = false;	// 반송
		div_btn.btn_delete.enable = true;		// 삭제	
	} else if(uGroup == '40') {
		div_btn.btn_save.enable = false;		// 저장
		div_btn.btn_draft.enable = false;		// 접수
		div_btn.btn_approval.enable = true;		// 승인
		div_btn.btn_decide.enable = false;		// 결재
		div_btn.btn_trans.enable = false;		// 전송
		div_btn.btn_sendback.enable = true;		// 반송
		div_btn.btn_delete.enable = true;		// 삭제	
	}
*/

//	if(G_VEND_CODE == '0000009935' && uGroup == '40' && G_USER_ID == '3016544') { //주차사업부 : 이재성(주차PM역할)
	if(G_VEND_CODE == '0000009935' && uGroup == '40' && G_USER_ID == '3017079') { //주차사업부 : 강명수직장(주차PM역할)
		div_btn.btn_save.enable = false;		// 저장
		div_btn.btn_draft.enable = true;		// 접수
		div_btn.btn_approval.enable = false;	// 승인
		div_btn.btn_decide.enable = false;		// 결재
		div_btn.btn_trans.enable = false;		// 전송
		div_btn.btn_sendback.enable = true;		// 반송
		div_btn.btn_delete.enable = false;		// 삭제	
	}
	if(G_USER_ID == '2017938') { //최인식 대리
		div_btn.btn_save.enable = true;			// 저장
		div_btn.btn_draft.enable = false;		// 접수
		div_btn.btn_approval.enable = true;		// 승인
		div_btn.btn_decide.enable = true;		// 결재
		div_btn.btn_trans.enable = false;		// 전송
		div_btn.btn_sendback.enable = true;		// 반송
		div_btn.btn_delete.enable = true;		// 삭제	
	}
	if(G_USER_ID == '3018679') { //주차 이선재 SW
		div_btn.btn_save.enable = true;			// 저장
		div_btn.btn_draft.enable = true;		// 접수
		div_btn.btn_approval.enable = true;		// 승인
		div_btn.btn_decide.enable = true;		// 결재
		div_btn.btn_trans.enable = true;		// 전송
		div_btn.btn_sendback.enable = true;		// 반송
		div_btn.btn_delete.enable = true;		// 삭제	
	}
	/*
	div_btn.btn_save.enable = true;			// 저장
	div_btn.btn_draft.enable = false;		// 접수
	div_btn.btn_approval.enable = true;		// 승인
	div_btn.btn_decide.enable = true;		// 결재
	div_btn.btn_trans.enable = false;		// 전송
	div_btn.btn_sendback.enable = true;		// 반송
	div_btn.btn_delete.enable = true;		// 삭제		
	*/

}

/********************************************************************************
* 기      능   : form UnloadCompleted 
********************************************************************************/
function fn_OnUnloadCompleted(obj) {
	return gfn_isFormUnload(obj);
}

//=========================================================================================
// [ PART 3 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,form닫기)
//=========================================================================================
/********************************************************************************
* 기      능   : 조회 1
********************************************************************************/
function fn_query() {
	//trace("## fn_query()");
	//trace("##seq="+seq+", pjt="+pjt+", upn="+upn+", cst="+cst+", gbn="+gbn);
	var user_grp = gfn_getUserGroup();

	ds_cond.Reset();

	if(user_grp == "10") { // 보수협력사일 경우
		ds_cond.SetColumn(0, "BSU", G_LGORT);
		ds_cond.SetColumn(0, "BPM", '');
		ds_cond.SetColumn(0, "ARA", '');
	} else if(user_grp == "20") { // 보수PM일 경우
		ds_cond.SetColumn(0, "BSU", trim(div_code.cb_small.value));
		ds_cond.SetColumn(0, "BPM", G_USER_ID);
		ds_cond.SetColumn(0, "ARA", '');
	} else if(user_grp == "30") { // 지방사무소일 경우
		ds_cond.SetColumn(0, "BSU", trim(div_code.cb_small.value));
		ds_cond.SetColumn(0, "BPM", '');
		ds_cond.SetColumn(0, "ARA", '');
	} else if(user_grp == "40") { // 고객지원부일 경우
		ds_cond.SetColumn(0, "BSU", trim(div_code.cb_small.value));
		if(div_code.cb_big.value == '1') { // 협력사 콤보1이 지역일 경우
			ds_cond.SetColumn(0, "BPM", '');
			ds_cond.SetColumn(0, "ARA", trim(div_code.cb_mid.value));
		} else if(div_code.cb_big.value == '2') { // 협력사 콤보1이 PM일 경우
			ds_cond.SetColumn(0, "BPM", trim(div_code.cb_mid.value));
			ds_cond.SetColumn(0, "ARA", '');
		}
	}
	
	ds_cond.SetColumn(0, "SEQ", seq);
	ds_cond.SetColumn(0, "PJT", pjt);
	ds_cond.SetColumn(0, "UPN", upn);
	ds_cond.SetColumn(0, "CST", cst);
	ds_cond.SetColumn(0, "GBN", gbn);
	ds_cond.SetColumn(0, "SPART", jpgbn);

    if(length(fa_docno) > 0) {
		req = "D" ;			//결재함을 통해진입한경우
		ds_cond.setColumn(0, "DOCNO", fa_docno);
		ed_docno.Text = fa_docno;
    } 
    
	ds_list.ClearData();

	tit_clearActionInfo();

	// 띄우는 화면에 따라 조회쿼리가 다름
	if(frm == "A" && query_chk == "N") {
		tit_addSearchActionInfo("cs13:CS1304001B_S1"); // 최초 작성 시
	} else if (req == "D") {
		tit_addSearchActionInfo("cs13:CS1304001B_S14");		//결재번호로 실패보고상세조회
	} else {
		tit_addSearchActionInfo("cs13:CS1304001B_S2");
	}
	
	tit_callService(
        ""
        , ""
        , "ds_cond=ds_cond"
        , "ds_list=ds_list"
        , ""
        , "fn_afterQuery"
        , true);       

}

/********************************************************************************
* 기      능   : 삽입 20
********************************************************************************/
function fn_input() {		

}

/********************************************************************************
* 기      능   : Delete 
********************************************************************************/
function fn_delete() {
	gfn_clearMsgBar();

	if(ds_list.rowCount() < 1) {
		// 삭제할 정보 없음. 
		return;
	}

	if(!gfn_isChangeDs(ds_list, true)) {
		return;
	}

	if(ds_list.FindRow("CHK", 1) == -1) {
		gfn_showMsg('CW00046');
		return;
	}

	for(var i=0; i<ds_list.GetRowCount(); i++) {
		if(ds_list.GetColumn(i, "CHK") == 1) {
			// 작성, 반송 데이터만 삭제 가능
			if(ds_list.GetColumn(i, "PST") == "A1" || ds_list.GetColumn(i,"PST") == "A2") {

			} else {
				gfn_showMsg('CW00053','삭제');
				return;
			}			
		}
	}

	// 삭제 처리 
	tit_callService(
        "CS1304001B_ACT"
        , "delete"
        , "ds_list=ds_list"
        , ""
        , ""
        , "fn_afterDelete");
}

/********************************************************************************
* 기      능   : 저장 
********************************************************************************/
function fn_save(t_pst) {

	if(cb_apstat.Value == ""){
		t_pst = "A1";
	} 
	
	/* PST 진행상태 - A1 작성 A2 반송 A3 발송 A5 접수 A6 완료*/		
	//trace("fn_save("+t_pst+")");
	//trace("#seq="+seq+", pjt="+pjt+", upn="+upn+", cst="+cst+", gbn="+gbn);
	var uGroup = gfn_getUserGroup();

	gfn_clearMsgBar();
	ds_list2.Reset();
	ds_list2.ClearData();

	if(ds_list.rowCount() < 1) {
		// 삭제할 정보 없음. 
		return;
	}

	if(!gfn_isChangeDs(ds_list, true)) {
		return;
	}

	if(ds_list.FindRow("CHK", 1) == -1) {
		gfn_showMsg('CW00046');
		return;
	}

	if(gfn_isNull(cb_sel, true)) {
		var arr = [st_gbn.value];
		gfn_showMsg("CW00001", arr);
		return;
	}

//	if(cb_sel.Value == "1") {
		if(gfn_isNull(cb_fail, true)) {
			var arr = [st_gbn.value];
			gfn_showMsg("CW00001", arr);
			return;
		}
//	}
	// 주차 입력시 필수 체크 제외 20140322
	if(substr(ds_list.GetColumn(0, "HNO"),0,1) <> "J") {
	
		if(gfn_isNull(cb_scd, true)) {
			var arr = [st_scp.value];
			gfn_showMsg("CW00001", arr);
			return;
		}
	}

	if(gfn_isNull(cal_jhd, true)) {
		var arr = [st_jhd.value];
		gfn_showMsg("CW00001", arr);
		return;
	}

	if(gfn_isNull(cb_flg, true)) {														//추가(2020.02.17)--군소업체 필수입력 선택
		var arr = [st_scp.value];
		gfn_showMsg("CW00001", arr);
		return;
	}

	if(t_pst <> "A2" && t_pst <> "A6"  ) { //반송 및 승인시 체크로직 제외 20120529 LJH
		//실패 사유에 따른 만회방안 필수항목값 설정_20120517
		//계약 전환의 경우 필수값 해제__20120910 LHR
		if(cb_fail.value != "M01" && cb_fail.value != "M07" && cb_fail.value != "M10" && cb_fail.value != "M11"
		&& cb_fail.value != "U08" && cb_fail.value != "U09" && cb_fail.value != "U11" && cb_fail.value != "U12"
		&& cb_fail.value != "U13" && cb_fail.value != "U14" && cb_fail.value != "U15" && cb_fail.value != "U10") {

			if(chk_tsa.value == '0') {
				if(gfn_isNull(ed_hjt, true)) {	
					gfn_showMsg("CW00001", "만회방안의 " +st_hjt.value);
					return;
				}
			} else { 
				if(gfn_isNull(ed_hpt_nm, true)) { 
					gfn_showMsg("CW00001", "만회방안의 "+st_hpt_nm.value); 
					return;
				}
			}	

			if(gfn_isNull(cal_hdd, true)) {	
				gfn_showMsg("CW00001", "만회방안의 " +st_hdd.value); 
				return;
			}

			if(gfn_isNull(med_hnt, true)) {	
				gfn_showMsg("CW00001", "만회방안의 " +st_hnt.value); 
				return;
			}

			if(gfn_isNull(med_hmt, true)) {	
				gfn_showMsg("CW00001", "만회방안의 " +st_hmt.value); 
				return;
			}
		}
		// 20150430 이하림 해당 사유 삭제 예정 , 입력 방지
		// 전환실패 - 미분양/계약지연   
		// 갱신실패 - 계약지연
		if(cb_fail.value == "M01" or cb_fail.value == "M10" or cb_fail.value == "U14" ) {		
			gfn_showAlert("'미분양' 및 '계약지연'은  실패사유로 등록할 수 없습니다."); 
			return;
		}
	}

	var t_date = gfn_getCurrDate();

	if(length(t_pst) == 0) {
		t_pst = "A1";
		if(cal_jhd.Value > t_date) {
			gfn_showAlert("미래일자로 실패일을 입력할수 없습니다.");
			return false;
		}
	}
	
	// 2021.01.25 타사-정보출처 체크로직 시작. 결재문서번호가 없는 경우에는 체크. Han JH
	if(length(trim(ed_docno.Text)) == 0) {
		if(cb_flg.Value == 'B') { // 군소업체가 타사인 경우에는
			if(cb_ifs.Value == '') { // 정보출처의 코드값이 Null이면
				gfn_showAlert("CW00001","정보출처 구분");
				cb_ifs.SetFocus();
				return false;
			}
			
			if(cb_ifs.Value == 'C') { // 정보출처의 코드값이 기타(C) 이면
				if(length(trim(ed_ifsv.Text)) == 0) { // 정보출처 텍스트 Null 예외처리
					gfn_showAlert("CW00001","정보출처 내용");
					ed_ifsv.SetFocus();
					return false;				
				}
				
				if(Lengthb(Trim(ed_ifsv.Text)) > 60) { // 정보출처 텍스트 한글 기준 30글자 이상 입력되지 않도록 예외처리
					var arr = [st_ifs.Value, "30글자"];
					gfn_showAlert("CW00133", arr);
					ed_ifsv.SetFocus();
					return false;				
				}
			} else { // 정보출처의 코드값이 기타(C)가 아닌 경우에는
				if(Lengthb(Trim(ed_ifsv.Text)) > 0) { // 정보출처의 코드값에 해당하는 텍스트가 있으면 해당 값을 Null 치환
					ed_ifsv.Text = '';
				}				
			}
		} else { // 군소업체가 타사가 아닌 경우에는
			if(length(trim(cb_ifs.Value)) > 0) { // 정보출처의 코드값이 있으면 해당 값을 Null 치환
				cb_ifs.Value = '';
			}
			
			if(Lengthb(Trim(ed_ifsv.Text)) > 0) { // 정보출처의 코드값에 해당하는 텍스트가 있으면 해당 값을 Null 치환
				ed_ifsv.Text = '';
			}
		}
	}
	
	for(var i=0; i<ds_list.GetRowCount(); i++) {
		if(ds_list.getColumn(i, "CHK") == 1) {

			addRow = ds_list2.AddRow();

			ds_list2.SetColumn(addRow, "PJT", ds_list.GetColumn(i, "PJT"));
			ds_list2.SetColumn(addRow, "HNO", ds_list.GetColumn(i, "HNO"));
			ds_list2.SetColumn(addRow, "SEQ", ds_list.GetColumn(i, "SEQ"));
			ds_list2.SetColumn(addRow, "GND", ds_list.GetColumn(i, "GND"));
			ds_list2.SetColumn(addRow, "UPN", ds_list.GetColumn(i, "UPN"));
			ds_list2.SetColumn(addRow, "CST", ds_list.GetColumn(i, "CST"));
			ds_list2.SetColumn(addRow, "GNO", ds_list.GetColumn(i, "GNO"));
			ds_list2.SetColumn(addRow, "ARA", ds_list.GetColumn(i, "ARA"));
			ds_list2.SetColumn(addRow, "BSU", ds_list.GetColumn(i, "BSU"));
			ds_list2.SetColumn(addRow, "BPM", ds_list.GetColumn(i, "BPM"));
			ds_list2.SetColumn(addRow, "HST", ds_list.GetColumn(i, "HST"));
			ds_list2.SetColumn(addRow, "PST", t_pst);
			ds_list2.SetColumn(addRow, "GBN", cb_fail.Value);
			ds_list2.SetColumn(addRow, "SEL", cb_sel.Value);
			ds_list2.SetColumn(addRow, "JHD", cal_jhd.Value);
			ds_list2.SetColumn(addRow, "FSA", txt_fsa.Value);
			ds_list2.SetColumn(addRow, "REQ", txt_req.Value);
			ds_list2.SetColumn(addRow, "RLT", txt_rlt.Value);
			ds_list2.SetColumn(addRow, "RMK", txt_rmk.Value);
			
			// 컬럼 추가
			ds_list2.SetColumn(addRow, "HMK", txt_hmk.Value);
			ds_list2.SetColumn(addRow, "HJT", ed_hjt.Value);
			ds_list2.SetColumn(addRow, "TSA", chk_tsa.Value);
			ds_list2.SetColumn(addRow, "HPT_NM", ed_hpt_nm.Value);
			ds_list2.SetColumn(addRow, "HDD", cal_hdd.Value);
			ds_list2.SetColumn(addRow, "HNT", med_hnt.Value);
			ds_list2.SetColumn(addRow, "HMT", med_hmt.Value);
				
			
			ds_list2.SetColumn(addRow, "FLG", cb_flg.Value);													// 추가(2020.02.17)
			ds_list2.SetColumn(addRow, "CS145_ARA", cb_ara.Value);
			ds_list2.SetColumn(addRow, "SCP", cb_scd.Text);
			ds_list2.SetColumn(addRow, "SCD", cb_scd.Value);
			ds_list2.SetColumn(addRow, "YMD", cal_ymd.Value);
			ds_list2.SetColumn(addRow, "YM2", cal_ym2.Value);
			ds_list2.SetColumn(addRow, "UNT", med_unt.Value);
			ds_list2.SetColumn(addRow, "AMT", med_amt.Value);
			ds_list2.SetColumn(addRow, "NEW", "");
			
			ds_list2.SetColumn(addRow, "IFS", cb_ifs.Value);													// 추가(2021.01.22)
			ds_list2.SetColumn(addRow, "IFSV", ed_ifsv.Text);													// 추가(2021.01.22)
			
			if(t_pst == "A3") {	//발송
				ds_list2.SetColumn(addRow, "FBD", gfn_getCurrDate());
				ds_list2.SetColumn(addRow, "FBJ", G_USER_ID);
				ds_list2.SetColumn(addRow, "FJD", "");
				ds_list2.SetColumn(addRow, "FJJ", "");
				ds_list2.SetColumn(addRow, "FSD", "");
				ds_list2.SetColumn(addRow, "FSJ", "");
				ds_list2.SetColumn(addRow, "DOCNO", ed_docno.Text);
			} else  if(t_pst == "A5") {	//접수
				ds_list2.SetColumn(addRow, "FBD","");
				ds_list2.SetColumn(addRow, "FBJ", "");
				ds_list2.SetColumn(addRow, "FJD", gfn_getCurrDate());
				ds_list2.SetColumn(addRow, "FJJ", G_USER_ID);
				ds_list2.SetColumn(addRow, "FSD", "");
				ds_list2.SetColumn(addRow, "FSJ", "");				
				ds_list2.SetColumn(addRow, "DOCNO", ed_docno.Text);
			} else if(t_pst == "A6") {	//완료
				ds_list2.SetColumn(addRow, "FBD", "");
				ds_list2.SetColumn(addRow, "FBJ", "");
				ds_list2.SetColumn(addRow, "FJD", "");
				ds_list2.SetColumn(addRow, "FJJ", "");
				ds_list2.SetColumn(addRow, "FSD", gfn_getCurrDate());
				ds_list2.SetColumn(addRow, "FSJ", G_USER_ID);
				ds_list2.SetColumn(addRow, "DOCNO", ed_docno.Text);
			} else {	//A1 작성, A2 반송 
				ds_list2.SetColumn(addRow, "FBD", "");
				ds_list2.SetColumn(addRow, "FBJ", "");
				ds_list2.SetColumn(addRow, "FJD", "");
				ds_list2.SetColumn(addRow, "FJJ", "");
				ds_list2.SetColumn(addRow, "FSD", "");
				ds_list2.SetColumn(addRow, "FSJ", "");
				if( ds_list.GetColumn(0,'APSTAT') = '2' or ds_list.GetColumn(0,'APSTAT') = '5'  ){
					ds_list2.SetColumn(addRow, "DOCNO", ''); //반송시 결재번호를 삭제 해줘야함
				} else {
					ds_list2.SetColumn(addRow, "DOCNO", ed_docno.Text);
				}
			}

			if (t_pst == "A1" && ds_list.GetColumn(i, "PST") == "A5" && 
			   (uGroup == "20" || G_USER_ID == '2017938'|| G_USER_ID == '2021200' || G_USER_ID == "2018900" || G_USER_ID == "2029758" || G_USER_ID == "2999999")) { //PM 전송상태에서 수정 가능
			} else if(t_pst == "A1" && ds_list.GetColumn(i, "PST") > "A2") { /// 최초 입력, 작성, 반송 상태 저장 가능
				gfn_showMsg('CW00053','저장');
				return;
			} else if(t_pst == "A5" && (ds_list.GetColumn(i, "PST") <> "A1" && ds_list.GetColumn(i, "PST") <> "A3")) { //  저장 발송 데이터만 기안 가능
				gfn_showMsg('CW00053','기안');
				return;
			} else if(t_pst == "A2" && ds_list.GetColumn(i, "PST") <> "A5" && ds_list.GetColumn(i, "PST") <> "A2") { // 접수 데이터만 반송 가능
				gfn_showMsg('CW00053','반송');
				return;
			} else if(t_pst == "A6" && ds_list.GetColumn(i, "PST") <> "A5") { // 접수 데이터만 승인 가능
				gfn_showMsg('CW00053','승인');
				return;
			}

			if(t_pst == "A1" && ds_list.GetColumn(i, "PST") == "A1") { //작성 상태에서 데이터 수정가능
				ds_list2.SetColumn(addRow, "UPD", "X");
				ds_list2.SetColumn(addRow, "GPT", "A");
			} else if(t_pst == "A1" && ds_list.GetColumn(i, "PST") == "A2") { //반송 상태에서 데이터 수정가능
				ds_list2.SetColumn(addRow, "UPD", "X");
				ds_list2.SetColumn(addRow, "GPT", "A");
			} else if(t_pst == "A1" && ds_list.GetColumn(i, "PST") == "A5" && (uGroup == "20" || G_USER_ID == '2017938') ) { //접수상태에서 데이터 수정가능(보수PM ,최인식)
				ds_list2.SetColumn(addRow, "UPD", "X");
				ds_list2.SetColumn(addRow, "GPT", "B"); //처리후 PST가 A1으로 변경되지 않도록 처리.
			} else {
				ds_list2.SetColumn(addRow, "UPD", "");
				ds_list2.SetColumn(addRow, "GPT", "B");
			}
		}
	}
	
	// 저장 처리 
	tit_callService(
        "CS1304001B_ACT"
        , "save"
        , "ds_list=ds_list2"
        , "ds_output=ds_output"
        , ""
        , "fn_afterSave");
}

function fn_chkHst() {
	ds_cond.Reset();

	ds_cond.SetColumn(0, "UPN", upn);
	ds_cond.SetColumn(0, "CST", cst);
	ds_cond.SetColumn(0, "PJT", pjt);

	tit_clearActionInfo();

	if(gbn == "A" || gbn == "B") { //미입주, 무상
		tit_addSearchActionInfo("cs13:CS1304001B_S8");
	} else { //유상
		tit_addSearchActionInfo("cs13:CS1304001B_S7");
	}

	tit_callService(
        ""
        , ""
        , "ds_cond=ds_cond"
        , "ds_hstCnt=ds_hstCnt"
        , ""
        , "fn_afterchkHst"
        , true);
}

/********************************************************************************
* 기      능   : 전송 60
********************************************************************************/
function fn_trans() {
//  기안으로 변경하여 전송 없앰
//	fn_save("A3");
}

/********************************************************************************
* 기      능   : 닫기  
********************************************************************************/
function fn_close() {
	//parent.fn_query();
	close();
}

/********************************************************************************
* 기      능   : 액셀  
********************************************************************************/
function fn_excel() {
	// Excel Export 
	gfn_saveToExcel(grd_list, true);
}

/********************************************************************************
* 기      능   : 접수 5
********************************************************************************/
function fn_receipt() {
	//접수에서 기안으로 변경 fn_save("A5"); 2014.12.18
}


/********************************************************************************
* 기      능   : 승인 10
********************************************************************************/
function fn_approval() {
	fn_save("A6");
}

/********************************************************************************
* 기      능   : 결재 15
********************************************************************************/
function fn_decide() {
	var decidertn;   // 결재 팝업 리턴코드
	
	gfn_clearMsgBar();
	
	if( ds_decide.rowCount() < 1 ) {
		// 승인할 정보 없음. 
		return;
	}
	
	for(var i=0; i<ds_list.RowCount(); i++) {
		ds_list.SetColumn(i, "CHK",  true); 
	}
	
	if(ds_list.FindRow("CHK", 1) == -1) {
		gfn_showMsg('CW00046');
		return;
	}	
	
	//altert(ds_decide.SaveXML());
	
	//if( !gfn_showConfirm("CI00014", "문서번호 : "+ quote(ed_docno.Text)+ "결재") ) return;
	decidertn = gfn_showConfirm_decide("CI00014", "문서번호 : "+ quote(ed_docno.Text)+ "결재") ;	
	if(decidertn == "C") return; //A : 승인, C : 취소 , W : 의견승인
	
	//----------------------------------------------------------------------
	// 의견 입력 팝업 추가 
	// f팝업 전달 변수 fa_docno : 문서번호 ,fa_dockind : 문서종류 
	// return 값 : rtn_yn (Y:의견입력됨 N:의견입력안됨)
	
	//if(gfn_showConfirm("CW10025","의견을 입력하시겠습니까?") )
	if( decidertn == "W" )    //의견입력 승인시
	{
		var arg = "";
		arg = " fa_docno=" + quote(ds_decide.GetColumn(0,"DOCNO")) +" fa_dockind=" + quote(ds_decide.GetColumn(0,"DOCKIND"));
		var rtn_yn = gfn_openPopup2("CS0401001C", true , arg);
	}
	//alert("rtn_yn:"+rtn_yn);
	// 의견입력 팝업 종료
	//----------------------------------------------------------------------
	
	// 결재상태변경
	ds_decide.SetColumn(0, "SEQSTAT", "3");
	
	//결재자 저장
	tit_clearActionInfo();
 	tit_addMultiActionInfo("cs04:CS0401002A_U2");
 	tit_addMultiActionInfo("cs04:CS0401002A_U3");
	tit_addSearchActionInfo("wb01:DOC_STATUS");//결재처리후 결재진행상태 확인 
	tit_callService(
		""
		, ""
		, "ds_list_0=ds_decide ds_cond=ds_decide"
		, "ds_doc_status=ds_doc_status"
		, ""
		, "fn_afterDecide"
		, true);
}
/********************************************************************************
* 기      능   : 결재 Callback
********************************************************************************/
function fn_afterDecide(errCode, errMsg) {
	if ( errCode!= 0 ) {
		gfn_showMsg("CE00001");
	} else {
		gfn_showMsg("CI00003");
		div_btn.btn_decide.Enable = false;		// 결재버튼
		div_btn.btn_draft.Enable  = false;		// 기안버튼
	//	div_btn.btn_print.Enable  = false;		// 출력버튼
		div_btn.btn_sendback.Enable = false; 	// 반송버튼
		
		if (ds_doc_status.GetColumn(0, "APSTAT")=="6") { //수신결재완료 상태이면
			gfn_clearMsgBar();
			//alert("승인처리-fn_save('A6')");
			fn_save("A6"); 
		} else {
			fn_query();
		}
	}
}

/********************************************************************************
* 기      능   : 기안 16
********************************************************************************/
function fn_draft() {
	gfn_clearMsgBar();
	
	//trace(ds_list.getcolumn(0, "APSTAT"));
	
	for(var i=0; i<ds_list.RowCount(); i++) {
		ds_list.SetColumn(i, "CHK",  true); 
	}

	if(ds_list.FindRow("CHK", 1) == -1) {
		gfn_showMsg('CW00046');
		return;
	}


	//협력사가 기안요청 할 때 키 생성 후, 기안 접수함에서 기안시 신규 키를 생성하지않고 해당 키를 계속 사용하도록
	//	: A1(저장) -> 기안(문서키생성) -> A3(발송으로 변경) -> 기안접수함에서 기안(문서키 재사용) -> A5(접수) 
	//협력사가 아닌 경우 기안요청 절차를 생략하고 바로 기안함
	//	: A1 -> 기안(문서키생성) -> A5(접수)
	//기안 전이고 저장상태일떄만 키를 생성. 
	if (parseInt(ds_list.getcolumn(0, "APSTAT")) < 1 && ds_list.GetColumn(0, "PST")=='A1' ) {
		fn_docgen();
		ed_docno.Text = ds_docno_gen.GetColumn(0, "DOCNO");
	} 
	
	if (length(ed_docno.Text) < 1) {
		alert("결재번호가 생성되지 않았습니다.");
		return false;
	}		
	
	var user_grp = gfn_getUserGroup();
	
	var appgubn = "S";
		
	if(ds_list.GetColumn(0, "APSTAT") == "3") {
		appgubn = "R";
	}
	
	var arg, rtn;
		
	var vVkbur = gfn_getBsu(ds_list.GetColumn(0, "BSU"), "VKBUR"); 
	if (vVkbur == "H100"){													// 자회사 실패처리(졀재를 타지 않는다.)
		ds_wbap01.ClearData();
		ds_wbap02.ClearData();
		ds_wbap01.AddRow();
		ds_wbap01.SetColumn(0, "DOCNO"   , ed_docno.Text);
		ds_wbap01.SetColumn(0, "DOCKIND" , "7");
		
		ds_wbap02.AddRow();
		ds_wbap02.SetColumn(0, "DOCNO"   , ed_docno.Text);
		ds_wbap02.SetColumn(0, "DOCKIND" , "7");

		// 결재정보 공통함수
		gfn_setZwbap(ds_wbap01, ds_wbap02, true);
		// 결재처리(결재일자, 결재자)
		for (i = 0; i < ds_list.GetRowCount(); i++)
			ds_list.SetColumn(i, "PST", "A5");
		
		fn_save("A6");
		
	} else {																// 모회사 실패처리		
		if( user_grp == '10' && substr(G_USER_ID,0,1) == '8' ) {
			arg = "fa_docno=" + quote(ed_docno.Text) + " fa_dockind=7";
			rtn = gfn_openPopup2("CS0401001B", true, arg);
	
			if( rtn[0] == "S" ) {
			//	gfn_showAlert("CI00003");
				gfn_showMsg("CI00003", '전자결재문서번호:' + ed_docno.Text);
				div_btn.btn_draft.Enable = false;
				
				if (parseInt(ds_list.GetColumn(0, "APSTAT")) < 1) {	//기안처리시
					fn_save("A3");	//발송으로 처리
					//trace("fn_save(A3)");
				} else {
					fn_query();
				}
			} else {
				if (parseInt(ds_list.getcolumn(0, "APSTAT")) < 1) {
					ed_docno.Text = "";
				}
			//	gfn_showAlert("CE00001"); 
				gfn_showMsg("CE00001");
			}
	
		} else {
			arg = "fa_docno=" + quote(ed_docno.Text)
				+ " fa_dockind=7" 
				+ " fa_appgubn=" + quote(appgubn);
			rtn = gfn_openPopup2("CS0401001A", true, arg);
	
			if( rtn[0] == "S" ) {
			//	gfn_showAlert("CI00003");
				gfn_showMsg("CI00003", '전자결재문서번호:' + ed_docno.Text);
				div_btn.btn_draft.Enable = false;
				
				if (parseInt(ds_list.GetColumn(0, "APSTAT")) < 1) {	//기안처리시
					fn_save("A5");	//접수로 처리
					//trace("fn_save(A5)");
				} else {
					fn_query();
				}
			} else {
				if (parseInt(ds_list.getcolumn(0, "APSTAT")) < 1) {
					ed_docno.Text = "";
				}
			//	gfn_showAlert("CE00001"); 
				gfn_showMsg("CE00001");
			}
		
		}
	}
}

function fn_docgen() {	
	ds_docno_gen.ClearData();
	ds_docno_gen.AddRow();
	ds_docno_gen.SetColumn(0,"PFX","H05");
	
	tit_clearActionInfo();
	tit_addSearchActionInfo("wb01:DOC_CODE_GEN_S1",true);
	tit_addSearchActionInfo("wb01:DOC_CODE_GEN_U1");
	tit_callService(
		, ""
		, "ds_docno_gen_i=ds_docno_gen"
		, "ds_docno_gen=ds_docno_gen_o"
		, ""							
		, ""							
		, true							
		, false							
		, true); //동기화 방식으로 서비스를 콜한다.
}	

/********************************************************************************
* 기      능   : 취소 35
********************************************************************************/
function fn_cancel() {

}

/********************************************************************************
* 기      능   : print 40
********************************************************************************/
function fn_print() {

}

/********************************************************************************
* 기      능   : 발행 50
********************************************************************************/
function fn_out() {

}

/********************************************************************************
* 기      능   : 신청 55
********************************************************************************/
function fn_request() {

}

/********************************************************************************
* 기      능   : 반송 65
********************************************************************************/
function fn_sendback() {
	var decidertn;   // 결재 팝업 리턴코드
	
	gfn_clearMsgBar();
	
	if( ds_decide.rowCount() < 1 ) {
		// 반송할 정보 없음. 
		return;
	}
	
	for(var i=0; i<ds_list.RowCount(); i++) {
		ds_list.SetColumn(i, "CHK",  true); 
	}
	
	if(ds_list.FindRow("CHK", 1) == -1) {
		gfn_showMsg('CW00046');
		return;
	}
		
	//if(!gfn_showConfirm("CI00014", "문서번호 : "+ quote(ed_docno.Text) + "반송")) return;
	decidertn = gfn_showConfirm_decide("CI00014", "문서번호 : "+ quote(ed_docno.Text) + "반송") ;	
	if(decidertn == "C") return; //A : 승인, C : 취소 , W : 의견승인
	
	//----------------------------------------------------------------------
	// 의견 입력 팝업 추가 
	// f팝업 전달 변수 fa_docno : 문서번호 ,fa_dockind : 문서종류 
	// return 값 : rtn_yn (Y:의견입력됨 N:의견입력안됨)
	
	//if(gfn_showConfirm("CW10025","의견을 입력하시겠습니까?"))
	if( decidertn == "W" )    //의견입력 승인시
	{
		var arg = "";
		arg = " fa_docno=" + quote(ds_decide.GetColumn(0,"DOCNO")) +" fa_dockind=" + quote(ds_decide.GetColumn(0,"DOCKIND"));
		var rtn_yn = gfn_openPopup2("CS0401001C", true , arg);
	}
	//alert("rtn_yn:"+rtn_yn);
	// 의견입력 팝업 종료
	//----------------------------------------------------------------------	
	
	// 결재상태변경
	ds_decide.SetColumn(0, "SEQSTAT", "2");
	
	tit_clearActionInfo();
	//결재자 저장
 	tit_addMultiActionInfo("cs04:CS0401002A_U2");
 	tit_addMultiActionInfo("cs04:CS0401002A_U3");
 	//결재처리후 결재진행상태 확인 
 	tit_addSearchActionInfo("wb01:DOC_STATUS");
	
	tit_callService(
		""
		, ""
		, "ds_list_0=ds_decide ds_cond=ds_decide"
		, "ds_doc_status=ds_doc_status"
		, ""
		, "fn_afterSendback"
		, true);
}

function fn_afterSendback(errCode, errMsg) {
	if ( errCode!= 0 ) {
		gfn_showMsg("CE00001");
	} else {
		gfn_showMsg("CI00003");
		div_btn.btn_decide.Enable = false;		// 결재버튼
		div_btn.btn_draft.Enable  = false;		// 기안버튼
	//	div_btn.btn_print.Enable  = false;		// 출력버튼
		div_btn.btn_sendback.Enable = false; 	// 반송버튼
		
		if (ds_doc_status.GetColumn(0,"APSTAT") == "2" || ds_doc_status.GetColumn(0,"APSTAT") == "5") {
			gfn_clearMsgBar();
			//trace("반송처리-fn_save('A2');");
			ed_docno.Text=""; //반송시 결재번호를 삭제하여 연결을 끊어 준다.
			fn_save("A2");
		}  else {
			return;
		}
	}
}

/********************************************************************************
* 기      능   : 계산 70
********************************************************************************/
function fn_cal() {

}

/********************************************************************************
* 기      능   : 복사 75
********************************************************************************/
function fn_copy() {

}

/********************************************************************************
* 기      능   : 확인 80
********************************************************************************/
function fn_confirm() {

}

//=========================================================================================
// [ PART 4]
// Callback 함수 정의 : callback 함수명은 메인 함수의 fn_xxxx() 에서 xxxx 부분은 fn_afterXXXX()
// 형태가 되도록 작성 
//=========================================================================================
/********************************************************************************
* 기      능   : 조회 Callback  
********************************************************************************/
function fn_afterQuery(errCode, errMsg) {

	//trace("#fn_afterQuery()");
	//trace("ds_list.GetColumn(0,'DOCNO')="+ds_list.GetColumn(0,"DOCNO"));
	//trace("ds_list.GetColumn(0,'APSTAT')="+ds_list.GetColumn(0,"APSTAT"));
	//trace("ds_list.GetColumn(0,'PST')="+ds_list.GetColumn(0,"PST"));
	
	var user_grp = gfn_getUserGroup();
	t_pst = "";
	
	cb_status.Value = ds_list.GetColumn(0, "PST");
	cb_apstat.Value = ds_list.GetColumn(0, "APSTAT");
	ed_docno.Text = ds_list.GetColumn(0, "DOCNO");
	ed_seq.Text = ds_list.GetColumn(0,"SEQ");
	ed_cnt.Text = ds_list.RowCount();

	fn_get_app_status();
   
	if (req = "D") {
		ufn_btn();	
		grd_list.Editable = false;
	}

	// 버튼
	// if (parseInt(ds_list.GetColumn(0,"APSTAT")) < 1 || 
				// (ds_list.GetColumn(0,"APSTAT") == "3" && ds_list.GetColumn(0,"REDPT1") == G_DPT1)) 
	if (parseInt(ds_list.GetColumn(0,"APSTAT")) < 1 || 
				(ds_list.GetColumn(0,"APSTAT") == "3" && ds_list.GetColumn(0,"REDPT1") == vDPT)) 
	{
		div_btn.btn_draft.Enable = true; 
		div_btn.btn_sendback.Enable = false;
		div_btn.btn_decide.Enable = false;
		div_btn.btn_approval.enable = false;
	} else if((ds_list.GetColumn(0,"APSTAT") > '0' && ds_list.GetColumn(0,"APSTAT") != '3' && ds_list.GetColumn(0,"APSTAT") < '6') 
			   && G_USER_ID == substr(ds_decide.GetColumn(0, "APNUM"),1) ) {
		div_btn.btn_draft.Enable   = false;	
		div_btn.btn_sendback.Enable = true;	
		div_btn.btn_decide.Enable = true;
		div_btn.btn_approval.enable = false;
	} else {
		div_btn.btn_draft.Enable = false;
		div_btn.btn_decide.Enable = false;
		div_btn.btn_sendback.Enable = false;
		div_btn.btn_approval.enable = false;
	}	
	
	//trace("ds_list.GetColumn(0,'APSTAT')="+ds_list.GetColumn(0,"APSTAT"));
	//trace("G_USER_ID="+G_USER_ID+"\n ds_decide.GetColumn(0, 'APNUM'),1)=" + substr(ds_decide.GetColumn(0, "APNUM"),1));
			
	if (ds_list.GetColumn(0,"PST") == "") {
		div_btn.btn_save.Enable = true;		
		div_btn.btn_draft.Enable = false;
		div_btn.btn_delete.Enable = true;		// 삭제
		div_btn.btn_trans.Enable = false;		// 전송
	} else if (ds_list.GetColumn(0,"PST") == "A1" and length(ds_list.GetColumn(0,"APSTAT")) == 0) { //저장상태이면
		div_btn.btn_save.Enable = true;		
		div_btn.btn_draft.Enable = true;
		div_btn.btn_delete.Enable = true;		// 삭제
		div_btn.btn_trans.Enable = true;		// 전송	
	} else if (ds_list.GetColumn(0,"PST") == "A3") { //발송		
		div_btn.btn_delete.Enable = false;		// 삭제
	} else if (ds_list.GetColumn(0,"PST") == "A3" && user_grp=="10") { //발송
		div_btn.btn_save.Enable = false;		
		div_btn.btn_draft.Enable = false;		
		div_btn.btn_delete.Enable = false;		// 삭제
		div_btn.btn_trans.Enable = false;		// 전송	
	} else if (ds_list.GetColumn(0,"PST") == "A5") { //접수
		div_btn.btn_save.Enable = false;	
		//div_btn.btn_draft.Enable = false;		
		div_btn.btn_delete.Enable = false;		// 삭제
		div_btn.btn_trans.Enable = false;		// 전송	
	} else if (ds_list.GetColumn(0,"PST") == "A2") { //반송
		div_btn.btn_save.Enable = true;		
		div_btn.btn_draft.Enable = false;		
		div_btn.btn_delete.Enable = true;		// 삭제
		div_btn.btn_trans.Enable = true;		// 전송	
		div_btn.btn_decide.Enable = false;    	// 반송의 경우 더이상 결재 진행 불가토록
		div_btn.btn_sendback.Enable = false;
	} else if (ds_list.GetColumn(0,"PST") == "A6") { //완료 후에는 모든 작업 불가 처리 20150402 이하림
		div_btn.btn_save.Enable = false;		
		div_btn.btn_draft.Enable = false;		
		div_btn.btn_delete.Enable = false;		// 삭제
		div_btn.btn_trans.Enable = false;		// 전송	
	}
	
	if (ds_list.rowcount==0) {
		div_btn.btn_save.Enable = false;		
		div_btn.btn_draft.Enable = false;		
		div_btn.btn_delete.Enable = false;		// 삭제
		div_btn.btn_trans.Enable = false;		// 전송		
	}
	
	if(G_USER_ID == "2017938"){
		div_btn.btn_save.Enable = true;	
	}
	
	if((upn > "" || pjt > "") && ds_list.GetRowCount() == 0) {
		fn_chkHst();
	}
	
	// if(cb_sel.Value == "A") {
		// ds_fail.Filter("CODE <= 'M99' && CODE <> 'M06' && CODE <> 'M08' && CODE <> 'M12' && CODE <> 'M99' && CODE <> 'M14'");
	// } else if(cb_sel.Value == "B") {
		// ds_fail.Filter("(CODE = '' || (CODE > 'M99' && CODE < 'U99')) && CODE <> 'U05' && CODE <> 'U15' && CODE <> 'U17'");
	// } else {
////		cb_fail.Index = 0;
	// }

	if(ds_list.GetColumn(0, "PST") == "" || ds_list.GetColumn(0, "PST") == "A1") {	// 미작성, 작성 상태
		//수정가능
	} else if(ds_list.GetColumn(0, "PST") == "A2" && (user_grp == "10" || user_grp == "30") ) {	//반송 상태
		//수정가능
	} else if(ds_list.GetColumn(0, "PST") == "A5" && (user_grp == "20" || G_USER_ID == '2017938') ) {
		fn_content_edit_control();	//미발주/무상/유상 구분값 사용자 변경 제한
	} else if(ds_list.GetColumn(0, "PST") == "A3" && length(ds_list.GetColumn(0,"APSTAT")) == 0) { 
		fn_content_edit_control();	//발송+ 기안 미작성, 협력사 작성 문서 수정가능 이하림 - 20150526 전현정 요청
	} else {
		//수정불가처리
		cb_sel.Enable = false;
		cb_fail.Enable = false;
		txt_fsa.Enable = false;
		txt_rlt.Enable = false;
		txt_req.Enable = false;
		txt_rmk.Enable = false;
		cb_flg.Enable = false;																// 추가(2020.02.17)
		cb_ara.Enable = false;
		cb_scd.Enable = false;
		cal_ymd.Enable = false;
		cal_ym2.Enable = false;
		med_unt.Enable = false;
		med_amt.Enable = false;
		chk_tsa.Enable = false;
		ed_hpt_nm.Enable = false;
		cal_hdd.Enable = false;
		med_hnt.Enable = false;
		med_hmt.Enable = false;
		txt_hmk.Enable = false;        
		btn_pjt.Enable = false;       
		btn_scd.Enable = false;
		chk_ex.Enable = false;
		ed_hjt.Enable = false;
		btn_hpi.Enable = false;
		
		cb_ifs.Enable = false;																// 추가(2021.01.25)
		ed_ifsv.Enable = false;																// 추가(2021.01.25)
	}
	if (cb_fail.Enable){
		if(cb_sel.Value == "A") {
			ds_fail.Filter("CODE <= 'M99' && CODE <> 'M06' && CODE <> 'M08' && CODE <> 'M12' && CODE <> 'M99' && CODE <> 'M14'");
		} else if(cb_sel.Value == "B") {
			ds_fail.Filter("(CODE = '' || (CODE > 'M99' && CODE < 'U99')) && CODE <> 'U05' && CODE <> 'U15' && CODE <> 'U17'");
		} else {
		}
	}
/*
	if (req = "D") {
		cb_sel.Enable = false; 
		cb_fail.Enable = false;
		txt_fsa.Enable = false;
		txt_rlt.Enable = false;
		txt_req.Enable = false;
		txt_rmk.Enable = false;
		cb_ara.Enable = false;
		cb_scd.Enable = false;
		cal_ymd.Enable = false;
		cal_ym2.Enable = false;
		med_unt.Enable = false;
		med_amt.Enable = false;
		chk_tsa.Enable = false;
		ed_hpt_nm.Enable = false;
		cal_hdd.Enable = false;
		med_hnt.Enable = false;
		med_hmt.Enable = false;
		txt_hmk.Enable = false;        
		btn_pjt.Enable = false;
		ed_hjt.Enable = false;
		btn_hpi.Enable = false;
	}
	*/
	
	var strColID = grd_list.GetCellProp("head", 0, "Text");
	
	if ( length( strColID ) == 1 ) {
		grd_list.SetCellProp("head", 0, "Text", "0");
	}
	
	// 메시지 처리
	gfn_showSearchMsg(grd_list);
	
	fn_popMsg(); // 위약금 관련 메시지
	
	// 최초 입력시에만 
	// 승강기만 
	if(frm == "A" && query_chk == "N" && jpgbn = "1") {

		var chkHno = "N" ;
		var chkDipbxnumb = "Y" ;
		var posid = "";
		for(var i=0; i<ds_list.RowCount(); i++) {
			if(substr(ds_list.GetColumn(i,"HNO"),0,1) == "L") {
				chkHno = "Y" ;	
				
				if(length(ds_list.GetColumn(i,"DIPBXNUMB")) == 0) {
					chkDipbxnumb = "N" ;
					posid = ds_list.GetColumn(i,"PJT") + ds_list.GetColumn(i,"HNO");
				}
			}
		}
		if(chkHno == "Y") {
			fn_popMsg2(); // 비통 통신비 중단 메시지 	
		}
		
		if(chkDipbxnumb == "N") {
			fn_popMsg3(posid); // 비통 번호 입력 경고 메시지
			close();
		}
	}
	
	if(cb_flg.Value == 'B') { // 최초 로딩 시 군소업체의 값이 타사이면 정보출처 항목 보이기. 2021.01.22 추가
		st_ifs.Visible = true;
		cb_ifs.Visible = true;
		if(cb_ifs.Value != 'C') {
			ed_ifsv.Visible = false;	
		} else {
			ed_ifsv.Visible = true;	
		}
	}
}

function fn_content_edit_control() {
	//alert("fn_content_edit_control()");
	cb_sel.Enable = false; // 미발주/무상/유상 구분값 사용자 변경 제한 201307
	cb_fail.Enable = true;
	txt_fsa.Enable = true;
	txt_rlt.Enable = true;
	txt_req.Enable = true;
	txt_rmk.Enable = true;
	cb_flg.Enable = true;																				// 추가(2020.02.17)
	cb_ara.Enable = false; //군소업체 검색 팝업으로 입력하기 20150326 이하림
	cb_scd.Enable = true;
	cal_ymd.Enable = true;
	cal_ym2.Enable = true;
	med_unt.Enable = true;
	med_amt.Enable = true;
	chk_tsa.Enable = true;
	ed_hjt.Enable = false;
	txt_hmk.Enable = true;

	if (chk_tsa.value == "0") {
		 btn_pjt.Enable = true;
		 btn_scd.Enable = true;
		 ed_hpt_nm.Enable = false;
		 cal_hdd.Enable = false;
		 med_hnt.Enable = false;
		 med_hmt.Enable = false;
		 btn_hpi.Enable = true;
	} else { 
		 btn_pjt.Enable = false;
		 btn_scd.Enable = false;
		 ed_hpt_nm.Enable = true;
		 cal_hdd.Enable = true;
		 med_hnt.Enable = true;
		 med_hmt.Enable = true;
		 btn_hpi.Enable = false;
	}
}

/********************************************************************************
* 기      능   : 결재자정보가져오기
********************************************************************************/
function fn_get_app_status() {
	//trace("###fn_get_app_status#");
	
	ds_cond.setColumn(0, "DOCNO", ed_docno.Text);
	
	tit_clearActionInfo();
	tit_addSearchActionInfo("wb01:APP_STATUS");		//결재자조회
	tit_callService(
		""
		, ""
		, "ds_cond=ds_cond"
		, "ds_decide=ds_decide"
		, ""
		, ""
		, true
		, false
		, true);	
}

/********************************************************************************
* 기      능   : 저장 Callback  
********************************************************************************/
function fn_afterSave(errCode, errMsg) {
	//trace("###seq="+seq+", pjt="+pjt+", upn="+upn+", cst="+cst+", gbn="+gbn);
	
	if(errCode != 0) {
		gfn_showMsg("CE00001");
	} else {
		
		if (seq='') {seq = ds_output.getColumn(0, "SEQ");} // 최초저장후 seq 가져오기 : 저장후 새로 고침시 정상적으로 데이터를 볼수 있도록 하기위해
		
		gfn_showMsg("CI00003");
		query_chk = "Y";
		t_pst = "";
		fn_Recov(); //중지현장 복구
	}
}

function fn_Recov() {
	//trace("#fn_Recov()");
	tit_clearActionInfo();
	tit_addMultiActionInfo("cs13:CS1304001B_U5");
	tit_addMultiActionInfo("cs13:CS1304001B_U4");
	tit_callService(
		""
		, ""
		, "ds_list=ds_list"
		, ""
		, ""
		, "fn_afterRecov"
		, true);
}

/********************************************************************************
* 기      능   : 복구 Callback  
********************************************************************************/
function fn_afterRecov(errCode, errMsg) {
	if(errCode != 0) {
		gfn_showMsg("CE00001");
	} else {
		gfn_showMsg("CI00003");
		query_chk = "Y";
		t_pst = "";
		fn_query();
	}
}

/********************************************************************************
* 기      능   : 삭제 Callback  
********************************************************************************/
function fn_afterDelete(errCode, errMsg) {
	if(errCode != 0) {
		gfn_showMsg("CE00001");
	} else {
		gfn_showMsg("CI00003");
		t_pst = "";
		fn_query();
	}
}

function fn_afterchkHst(errCode, errMsg) {
	if(ds_hstCnt.GetColumn(0, "CNT") > 0) {
		//gfn_showAlert("보류/중지 현장입니다. 등록하실수 없습니다.");
	}
}

//=========================================================================================
// [ PART 6 ]
// component Event 정의 : 각 Component 별 이벤트 
//=========================================================================================
/********************************************************************************
* 기      능   : 그리드 헤더 클릭시 정렬 처리 
********************************************************************************/
function grd_list_OnHeadClick(obj,nCell,nX,nY,nPivotIndex) {
	if(nCell == 0) {
		// 그리드 표시할 컬럼 선택 
		//gfn_selectGridCol(obj);
		gfn_selectAllGrid(obj,nCell,nCell,true);
	} else {
		// 그리드 정렬 처리 
		gfn_sortGrid(obj,nCell);
	}
}

/********************************************************************************
* 기      능   : 데이터셋 값 변경 시 - Flag 처리 
********************************************************************************/
function ds_list_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex) {
	gfn_changeFlag(obj, strColumnID, nRow, "FLAG");
}

/********************************************************************************
* 기      능   : 그리드 셀 클릭 시 이벤트
********************************************************************************/
function grd_list_OnCellClick(obj,nRow,nCell,nX,nY,nPivotIndex){

}


/********************************************************************************
* 기      능   : 그리드 셀 더블 클릭 시 이벤트
********************************************************************************/
function grd_list_OnCellDblClick(obj,nRow,nCell,nX,nY,nPivotIndex) {

}

function btn_fail_print_OnClick(obj) {
	var insRow;
	var t_amt = 0;

	ds_list4.ClearData();
	ds_list4.Reset();

	for(var i=0; i<ds_list.RowCount(); i++) {
		if(i == 0) {
			insRow = ds_list4.AddRow();			
			ds_list4.SetColumn(insRow, "JHD", ds_list.GetColumn(0, "JHD"));
			ds_list4.SetColumn(insRow, "MNY", ds_list.GetColumn(0, "TOT"));
			ds_list4.SetColumn(insRow, "FSA", ds_list.GetColumn(0, "FSA"));
			ds_list4.SetColumn(insRow, "REQ", ds_list.GetColumn(0, "REQ"));
			ds_list4.SetColumn(insRow, "RLT", ds_list.GetColumn(0, "RLT"));
			ds_list4.SetColumn(insRow, "RMK", ds_list.GetColumn(0, "RMK"));
			ds_list4.SetColumn(insRow, "HMK", ds_list.GetColumn(0, "HMK"));
			
			ds_list4.SetColumn(insRow, "HJT", ds_list.GetColumn(0, "HJT"));			
			ds_list4.SetColumn(insRow, "HPT_NM", ds_list.GetColumn(0, "HPT_NM"));			
			ds_list4.SetColumn(insRow, "HDD", ds_list.GetColumn(0, "HDD"));			
			ds_list4.SetColumn(insRow, "HNT", ds_list.GetColumn(0, "HNT"));			
			ds_list4.SetColumn(insRow, "HMT", ds_list.GetColumn(0, "HMT"));
														
			
			ds_list4.SetColumn(insRow, "SCP", ds_list.GetColumn(0, "SCP"));
			ds_list4.SetColumn(insRow, "UNT", ds_list.GetColumn(0, "UNT"));
			ds_list4.SetColumn(insRow, "UPN", ds_list.GetColumn(0, "UPN"));
			ds_list4.SetColumn(insRow, "YMD", ds_list.GetColumn(0, "YMD"));
			ds_list4.SetColumn(insRow, "AMT", ds_list.GetColumn(0, "AMT"));
			ds_list4.SetColumn(insRow, "BSU_NM", ds_list.GetColumn(0, "BSU_NM"));
			ds_list4.SetColumn(insRow, "ARA_NM", ds_list.GetColumn(0, "ARA_NM"));
			ds_list4.SetColumn(insRow, "TEM_NM1", substr(ds_list.GetColumn(0, "TEM_NM"),0,6)); 
			ds_list4.SetColumn(insRow, "TEM_NM2", substr(ds_list.GetColumn(0, "TEM_NM"),6,20)); 
			
			ds_list4.SetColumn(insRow, "SPT", ds_list.GetColumn(0, "SPT_NM"));
			ds_list4.SetColumn(insRow, "CNT", ds_list.GetRowCount());
			ds_list4.SetColumn(insRow, "CDATE", ds_list.GetColumn(0, "CDATE"));
			ds_list4.SetColumn(insRow, "EPN", ds_list.GetColumn(0, "EPN"));
			ds_list4.SetColumn(insRow, "NAM", ds_list.GetColumn(0, "NAM"));
			ds_list4.SetColumn(insRow, "ZSPEC1", ds_list.GetColumn(0, "ZSPEC1"));
			ds_list4.SetColumn(insRow, "MAMT", 0);
			ds_list4.SetColumn(insRow, "SEL", cb_sel.Text);
			ds_list4.SetColumn(insRow, "FAIL", cb_fail.Text);
			ds_list4.SetColumn(insRow, "ISD", isd);
			ds_list4.SetColumn(insRow, "UMR", ds_list.GetColumn(0, "UMR"));
			ds_list4.SetColumn(insRow, "CNT_H", ds_list.GetColumn(0, "CNT_H"));
			ds_list4.SetColumn(insRow, "GGB", ds_list.GetColumn(0, "GGB"));
		}

		t_amt = t_amt + ds_list.GetColumn(i, "TOT");

		if(i == (ds_list.RowCount() - 1)) {
			ds_list4.SetColumn(0, "MAMT", t_amt);
		}
	}

	ds_conf_list.AddRow();
	ds_draftpers_list.AddRow();
	//해약보고서 출력 2015.02.24YAR
	tit_clearActionInfo();
	
	tit_addSearchActionInfo("wb01:DOC_CONF_S1");
	tit_addSearchActionInfo("wb01:DOC_CONF_S2");
	
	tit_callService(
        "" 
        , ""
        , "ds_conf_cond=ds_list"
        , "ds_list4=ds_list4 ds_conf_list=ds_conf_list ds_draftpers_list=ds_draftpers_list"
        , ""
        , "fn_afterPrint"
        , true
        , true);
        
}
function fn_afterPrint() {
    //UbiReport Call
	Dialog("CS13::CS1301001C.xml", "");
}

function cb_sel_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex) {
	if(cb_sel.Value == "A") {
		cb_fail.Index = 0;
		cb_fail.Enable = true;
		ds_fail.Filter("CODE <= 'M99' && CODE <> 'M06' && CODE <> 'M08' && CODE <> 'M12' && CODE <> 'M99' && CODE <> 'M14'");	
		cb_flg.Enable = false;
	} else if(cb_sel.Value == "B") {
		ds_fail.Filter("(CODE = '' || (CODE > 'M99' && CODE < 'U99')) && CODE <> 'U05' && CODE <> 'U15' && CODE <> 'U17'");
		cb_fail.Index = 0;
		cb_fail.Enable = true;
		cb_flg.Enable = false;
	} else {
		cb_fail.Index = 0;
		ds_fail.Enable = false;
		cb_flg.Enable = false;
	}
}

function cb_flg_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	cb_ara.Index = 0;
	fn_filter();
	cb_scd.Index = 0;
}

function cb_ara_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex) {
	fn_filter();
	cb_scd.Index = 0;
}
function fn_filter(){										// 추가(2020.02.21)
	btn_scd.Enable = true;
	if (cb_flg.value == ""){
		if(cb_ara.Value == "") {
			ds_scd_cd.Filter("CS145_ARA == 'XX'");
		} else {
			ds_scd_cd.Filter("CS145_ARA == " + quote(cb_ara.Value));
			chk_ex.Value = "";
		}
	} else if (cb_flg.Value == "C"){
		ds_scd_cd.Filter("CODE == '0000'");
		btn_scd.Enable = false;
	} else {
		if(cb_ara.Value == "") {
			ds_scd_cd.Filter("CS145_ARA == 'XX'");
		} else {
			ds_scd_cd.Filter("CS145_GSO == " + quote(cb_flg.value) + " && CS145_ARA == " + quote(cb_ara.Value));
			chk_ex.Value = "";
		}
	}
	
	if(cb_flg.Value == "B") { // 2021.01.22 타사인 경우에는 정보출처 항목을 보여줌. 준법 이든솔 요청
		st_ifs.Visible = true;
		cb_ifs.Visible = true;
		ed_ifsv.Visible = true;	
	}
}

function chk_tsa_OnClick(obj,strValue)
{
	if(chk_tsa.Value == "1"){
	  	     ed_hpt_nm.Enable = true;
		     btn_pjt.Enable = false;
		     btn_scd.Enable = false;
	 	     btn_hpi.Enable = false;
	 	     cal_hdd.Enable = true;
             med_hnt.Enable = true;
             med_hmt.Enable = true;
 	         ed_hjt.Text = "";
    	     ed_hpt_nm.Text = "";
    	     cal_hdd.Text = "";
             med_hnt.Text = "";
             med_hmt.Text = "";
             txt_hmk.Text = "";
	} else {
             ed_hpt_nm.Text= "";
             cal_hdd.Text = "";
             med_hnt.Text = "";
             med_hmt.Text = "";
             txt_hmk.Text = "";
             btn_pjt.Enable = true;
             btn_scd.Enable = true;
             ed_hpt_nm.Enable = false;
             cal_hdd.Enable = false;
             med_hnt.Enable = false;
             med_hmt.Enable = false;
             btn_hpi.Enable = true;

	}
}


function btn_pjt_OnClick(obj)
{
	var arg = "pjt="+quote(ed_hjt.Text)+" gbn=C";
	gfn_openPopup("CS9601002A",true,arg);
	
	chk_tsa.value = "0";
	
}

function btn_hpi_OnClick(obj)
{
	var arg = "pjt="+quote(ed_hjt.value);

    if(gfn_isNull(ed_hjt, true)) {	
		  gfn_showMsg("CW00001", "만회방안의 " +st_hjt.value);
		  return;
	}
		
	gfn_openPopup("CS1304001C", true, arg);		
}

function fn_GetData() {
    
    ds_cond_2.SetColumn(0, "PJT", ed_hjt.value);

	tit_clearActionInfo();
	tit_addSearchActionInfo("cs13:CS1304001C_S2");
	tit_callService(
        ""
        , ""
        , "ds_cond_2=ds_cond_2"
        , "ds_list5=ds_list5"
        , ""
        , "fn_afterGetData"
        , true);
  
}
function fn_afterGetData() {
    
    ds_list5.SetColumn(0, "SEQ", ed_seq.value); 
	ds_list5.SetColumn(0, "HJT", ed_hjt.value);
	ds_list5.SetColumn(0, "TSA", chk_tsa.value);
	ds_list5.SetColumn(0, "HPT", ed_hpt_nm.value);

// 'A' : 최초입력 'B' : 수정(보수 PM)   
    if(frm == 'A') {
          cal_hdd.Text = ds_list5.GetColumn(0, "YDT"); 
          med_hnt.Text = ds_list5.GetColumn(0, "CNT"); 
          med_hmt.Text = ds_list5.GetColumn(0, "YMT");                     
    }
    else {    
		  tit_clearActionInfo();
	      tit_addSingleActionInfo("cs13:CS1304001C_U1");

	      tit_callService(
		      ""
		      , ""
		      , "ds_list5=ds_list5:A"
		      , ""
		      , ""
		      , "fn_setGrid"
		      , true); 
	}
}

function fn_setGrid() {
	for(var i=0; i<ds_list.GetRowCount(); i++) {
		ds_list.SetColumn(i, "HDD", cal_hdd.Value);
		ds_list.SetColumn(i, "HNT", med_hnt.Value);
		ds_list.SetColumn(i, "HMT", med_hmt.Value);
	}
}

/********************************************************************************
* 기      능   : 기안된 문서 확인 상세
********************************************************************************/		
function fn_reqDoc() {
	
	//trace("# fn_reqDoc()");
	//trace("# ds_cond_req");
	//trace(ds_cond_req.SaveXML());
	
	ds_list.ClearData();
	
	tit_clearActionInfo();
	tit_addSearchActionInfo("wb01:APP_STATUS");		//결재자조회
	tit_addSearchActionInfo("cs13:CS1304001B_S14");		//결재번호로 실패보고상세조회
	tit_callService(
	""
	, ""
	, "ds_cond=ds_cond_req ds_cond=ds_cond_req"
	, "ds_decide=ds_decide ds_list=ds_list2"
	, ""
	, "fn_afterQuery"
    , true);	
}
/********************************************************************************
* 기      능   : 군소업체 검색
********************************************************************************/	
function btn_scd_OnClick(obj)
{	
	var arg = "pGso=" + quote(cb_flg.Value);
	gfn_openPopup("CS1304001D", true,arg);		
}

/********************************************************************************
* 기      능   : 군소업체 기타 체크 박스 선택 시 기타로 셋팅
********************************************************************************/	
function chk_ex_OnClick(obj,strValue)
{
	if(chk_ex.Value == true) {
			cb_ara.Index = 0;
			fn_filter();
			cb_scd.Index = 0;
		//cb_scd.Enable = false;
	} else {
		if (cb_flg.value == "" || cb_flg.value == "C"){
			cb_ara.Index = 0;
			fn_filter();
			cb_scd.Value = "";
		} else {
			cb_ara.Index = 0;
			fn_filter();
			cb_scd.Value = "";
		}
		//cb_scd.Enable = true;
	}	
}

function fn_popMsg() {
	/*
	HRTS 또는 비상통화 장치 임대계약 포함 현장 
    해약 보고 시 위약금에 대한 안내 POP-UP
	*/
	
	var t_seq = length(ed_seq.Text); // 최초 작성 여부 체크
	var t_docno = length(ed_docno.Text); // 기안 전 상태 체크
	var apstat = ds_list.GetColumn(0,'APSTAT'); // 기안 전 상태 체크
	
	if(t_seq == 0 or t_docno == 0 or apstat == 1){
		 // 최초 작성 시 
		 // 기안 진행 중
	} else {
		return;
	}
	
	var f_fm = "";
	var f_dy = "";
	var f_hy = "";
	for(var i=0; i<ds_list.GetRowCount(); i++) {
		if(length(ds_list.GetColumn(i,"KND_NM")) > 0) { 
			f_fm = "Y";
		}
		if(length(ds_list.GetColumn(i,"DYN")) > 0) { 
			f_dy = "Y";
		}
		if(length(ds_list.GetColumn(i,"HYN")) > 0) { 
			f_hy = "Y";
		}
	}

	if( f_dy == "Y" or f_hy == "Y" ) {
		var arr = " f_fm=" + quote(f_fm)
		        + " gbn=CS1304001B";
		gfn_openPopup("CS1305001A", true, arr);	
	}
	
}

function fn_popMsg2() {

	var Msg2 = "저장된 DIPBX 번호의 통신비 지원이 중단될 \n"
	         +"예정입니다. 고객통보 및 번호 재확인 바랍니다.";
	
	gfn_openMsgWin( Msg2 ,"W");
}
function fn_popMsg3(str1) {

	var Msg3 = str1 + " 호기의 DIPBX 번호 입력 후 실패 보고 작성 바랍니다. \n";
	
	gfn_openMsgWin( Msg3 ,"W");
}
function btn_admin_OnClick(obj)
{
	// 수신결재 완료 되었으나 승인처리 되지 않은 경우
	// 진행상태가 작성이면 아래의 주석을 풀고 접수상태로 변경 후 최종적으로  완료(A6)으로 처리함
	//fn_save("A5");
	fn_save("A6");
}

function ds_list_CanColumnChange(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)	// 추가(2020.02.17)
{
	if (strColumnID == "FLG"){																// 군소업체 선택시 실패사유에 따라 선택하는 업체가 다르다
		if(varNewValue != 'B') {                                                            // 군소업체가 타사가 아닌 경우에는 정보출처 항목 숨김처리.
			st_ifs.Visible = false;
			cb_ifs.Visible = false;
			ed_ifsv.Visible = false;	
		}
		switch( ds_list.GetColumn(nRow, "GBN") ) 
		{
			case "M14":
			case "U17":
					alert("실패사유가 '" + cb_fail.Text + "' 인경우는 군소업체를 선택 수 없습니다.");
					return false;
					break;
			case "M02":																		// 저단가(전환실패)
			case "M03":																		// 서비스불만(전환실패)
			case "M04":																		// 인맥(전환실패)
			case "M05":																		// 입찰제한(전환실패)
			case "M09":																		// 통합계약(전환실패)
			case "M13":																		// 리베이트(전환실패)
			case "M15":																		// 분담이행계약 거부-저단가(전환실패)
			case "M16":																		// 분담이행계약 거부-인맥(전환실패)
			case "M17":																		// 분담이행계약 거부-기타(전환실패)
			case "U01":																		// 저단가(갱신실패)
			case "U02":																		// 고장(갱신실패)
			case "U03":																		// 인맥(갱신실패)
			case "U04":																		// 입찰제한(갱신실패)
			case "U06":																		// 리베이트(갱신실패)
			case "U07":																		// 통합계약(갱신실패)
			case "U10":																		// 기술용역계약해지(갱신실패)
			case "U18":																		// 분담이행계약 거부-저단가(전환실패)
			case "U19":																		// 분담이행계약 거부-인맥(전환실패)
			case "U20":																		// 분담이행계약 거부-기타(전환실패)
				if (varNewValue == 'C'){
					if(varOldValue == 'B') {                                                // 이전 값이 군소업체 일떄에는 정보출처 항목 보이기
						st_ifs.Visible = true;
						cb_ifs.Visible = true;
						ed_ifsv.Visible = true;
					}				
					alert("실패사유가 '" + cb_fail.Text + "' 인경우 군소업체를 '기타'로 선택할 수 없습니다.");
					return false;
				}
				break;
			case "M01":																		// 미분양(전환실패)
			case "M07":																		// 휴지(전환실패)
			case "M11":																		// 철거(전환실패)
			case "U09":																		// 휴지(갱신실패)
			case "U11":																		// 타사교체(갱신실패)
			case "U12":																		// 자사교체(갱신실패)
			case "U13":																		// 철거(갱신실패)
			case "U16":																		// 폐업(부도)(갱신실패)
				if (varNewValue == 'A' || varNewValue == 'B' )	{
					alert("실패사유가 '" + cb_fail.Text + "' 인경우 군소업체는 '기타'만 선택할 수 있습니다.");
					return false;
				}
				break;
			case "":																		// 선택
			case default :
				return true;
				break;
		}		
	}
	
}

function cb_fail_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	var vSel = cb_sel.Value;
	if (vSel == "A"){
		if (strCode == "M14"){
			alert("실패사유 '" + strText + "'는 사용할 수 없습니다.");
			ds_list.FireEvent = false;
			cb_fail.Value = "";
			ds_list.FireEvent = true;
		} else if (strCode == "M01" || strCode == "M07" || strCode == "M11" ){								// 미분양,휴지,철거
			cb_flg.Value = "C";
			fn_filter();
			cb_ara.Index = 0;
			cb_scd.Index = 0;
			cb_flg.Enable = false;
		} else {
			cb_flg.Index = 0;
			cb_flg.Enable = true;
		}
	} else if (vSel == "B"){
		if (strCode == "U17"){
			alert("실패사유 '" + strText + "'는 사용할 수 없습니다.");
			ds_list.FireEvent = false;
			cb_fail.Value = "";
			ds_list.FireEvent = true;
		} else if (strCode == "U09" || strCode == "U11" || strCode == "U12" || strCode == "U13" || strCode == "U16" ){	// 휴지,타사교체,자사교체,철거,폐업
			cb_flg.Value = "C";
			fn_filter();
			cb_ara.Index = 0;
			cb_scd.Index = 0;
			cb_flg.Enable = false;
		} else {
			cb_flg.Index = 0;
			cb_flg.Enable = true;
		}
	} else {
		cb_flg.Index = 0;
		cb_ara.Index = 0;
		cb_scd.Index = 0;
		cb_flg.Enable = false;
	}

}

// 2021.01.25 Han J.H
function cb_ifs_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	if(strCode != 'C') {
		ed_ifsv.Visible = false;
	} else if(strCode == 'C') {
		ed_ifsv.Visible = true;
	}
}
]]></Script>
</Window>