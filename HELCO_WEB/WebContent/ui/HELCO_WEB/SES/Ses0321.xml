<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="384" Id="Ses0321" Left="8" OnLoadCompleted="fn_OnLoadCompleted" OnUnloadCompleted="fn_OnUnloadCompleted" PidAttrib="7" Title="수주템플릿" Top="8" Ver="1.0" Width="384" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_cond">
				<Contents>
					<colinfo id="MANDT" size="256" summ="default" type="STRING"/>
					<colinfo id="ZTPLGBN" size="256" summ="default" type="STRING"/>
					<colinfo id="ZTPLNO" size="256" summ="default" type="STRING"/>
					<colinfo id="ZRMK" size="256" summ="default" type="STRING"/>
					<colinfo id="ZPRDGBN" size="256" summ="default" type="STRING"/>
					<colinfo id="HOGI" size="256" summ="default" type="STRING"/>
					<colinfo id="QTNUM" size="256" summ="default" type="STRING"/>
					<colinfo id="QTSER" size="256" summ="default" type="STRING"/>
					<colinfo id="QTSEQ" size="256" summ="default" type="STRING"/>
					<record>
						<HOGI></HOGI>
						<MANDT></MANDT>
						<QTNUM></QTNUM>
						<QTSEQ></QTSEQ>
						<QTSER></QTSER>
						<ZPRDGBN></ZPRDGBN>
						<ZRMK></ZRMK>
						<ZTPLGBN></ZTPLGBN>
						<ZTPLNO></ZTPLNO>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list">
				<Contents>
					<colinfo id="FLAG" size="256" type="STRING"/>
					<colinfo id="MCLASS" size="256" type="STRING"/>
					<colinfo id="ATKLA" size="256" type="STRING"/>
					<colinfo id="PRH" size="256" type="STRING"/>
					<colinfo id="PRHNAME" size="256" type="STRING"/>
					<colinfo id="PRD" size="256" type="STRING"/>
					<colinfo id="ZTPLGBN" size="256" type="STRING"/>
					<colinfo id="ZTPLNM" size="256" type="STRING"/>
					<colinfo id="ZPRDGBN" size="256" type="STRING"/>
					<colinfo id="ZTPLSEQ" size="256" type="STRING"/>
					<colinfo id="ZTPLNO" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_error">
				<Contents>
					<colinfo id="IDX" size="256" type="STRING"/>
					<colinfo id="ERRMSG" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ztplgbn">
				<Contents>
					<colinfo id="CODE" size="1" type="STRING"/>
					<colinfo id="CODE_NAME" size="1" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_temp">
				<Contents>
					<colinfo id="MCLASS" size="256" type="STRING"/>
					<colinfo id="ATKLA" size="256" type="STRING"/>
					<colinfo id="PRH" size="256" type="STRING"/>
					<colinfo id="PRHNAME" size="256" type="STRING"/>
					<colinfo id="PRD" size="256" type="STRING"/>
					<colinfo id="FLAG" size="256" type="STRING"/>
					<colinfo id="ZTPLGBN" size="256" type="STRING"/>
					<colinfo id="ZTPLNM" size="256" type="STRING"/>
					<colinfo id="ZPRDGBN" size="256" type="STRING"/>
					<colinfo id="ZTPLSEQ" size="256" type="STRING"/>
					<colinfo id="ZTPLNO" size="256" type="STRING"/>
					<colinfo id="PRH0" size="256" type="STRING"/>
					<colinfo id="CNT" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_save">
				<Contents>
					<colinfo id="FLAG" size="256" type="STRING"/>
					<colinfo id="MCLASS" size="256" type="STRING"/>
					<colinfo id="ATKLA" size="256" type="STRING"/>
					<colinfo id="PRH" size="256" type="STRING"/>
					<colinfo id="PRD" size="256" type="STRING"/>
					<colinfo id="ZTPLGBN" size="256" type="STRING"/>
					<colinfo id="ZTPLNM" size="256" type="STRING"/>
					<colinfo id="ZPRDGBN" size="256" type="STRING"/>
					<colinfo id="ZTPLSEQ" size="256" type="STRING"/>
					<colinfo id="ZTPLNO" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_prhcd">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_head">
				<Contents>
					<colinfo id="FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="ZTPLNO" size="256" summ="default" type="STRING"/>
					<colinfo id="ZTPLGBN" size="256" summ="default" type="STRING"/>
					<colinfo id="ZTPLNM" size="256" summ="default" type="STRING"/>
					<colinfo id="ZPRDGBN" size="256" summ="default" type="STRING"/>
					<colinfo id="ZWRITER" size="256" summ="default" type="STRING"/>
					<colinfo id="ZRMK" size="256" summ="default" type="STRING"/>
					<colinfo id="BRNDCD" size="256" summ="default" type="STRING"/>
					<record>
						<BRNDCD></BRNDCD>
						<FLAG></FLAG>
						<ZPRDGBN></ZPRDGBN>
						<ZRMK></ZRMK>
						<ZTPLGBN></ZTPLGBN>
						<ZTPLNM></ZTPLNM>
						<ZTPLNO></ZTPLNO>
						<ZWRITER></ZWRITER>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_zprdgbn">
				<Contents>
					<colinfo id="CODE" size="1" type="STRING"/>
					<colinfo id="CODE_NAME" size="1" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list_atnam_copy">
				<Contents>
					<colinfo id="CLASS1" size="256" type="STRING"/>
					<colinfo id="ATKLA" size="256" type="STRING"/>
					<colinfo id="ATNAM" size="256" type="STRING"/>
					<colinfo id="ATBEZ" size="256" type="STRING"/>
					<colinfo id="ATINN" size="256" type="STRING"/>
					<colinfo id="ATZHL" size="256" type="STRING"/>
					<colinfo id="ATWRT" size="256" type="STRING"/>
					<colinfo id="CHECKBOX" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_sap">
				<Contents>
					<colinfo id="NAM_CHAR" size="256" type="STRING"/>
					<colinfo id="ATBEZ" size="256" type="STRING"/>
					<colinfo id="VALUE1" size="256" type="STRING"/>
					<colinfo id="ATWTB1" size="256" type="STRING"/>
					<colinfo id="VALUE2" size="256" type="STRING"/>
					<colinfo id="ATWTB2" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_sap2">
				<Contents>
					<colinfo id="HOGI" size="256" type="STRING"/>
					<colinfo id="ARKTX" size="256" type="STRING"/>
					<colinfo id="NAME1" size="256" type="STRING"/>
					<colinfo id="BSTNK" size="256" type="STRING"/>
					<colinfo id="VDATU" size="256" type="STRING"/>
					<colinfo id="SAL_MAN" size="256" type="STRING"/>
					<colinfo id="TEC_MAN" size="256" type="STRING"/>
					<colinfo id="TELNO" size="256" type="STRING"/>
				</Contents>
			</Dataset>
		</Datasets>
		<Div Height="36" Id="div_btn" TabOrder="3" Text="Div0" Url="WB01::CommBtnForm.xml" Width="384">
			<Contents></Contents>
		</Div>
		<Shape BKColor="user0" Bottom="296" Height="256" Id="Shape1" Left="0" LineColor="user1" Right="384" TabOrder="3" Top="40" Type="Rectangle" Width="384"></Shape>
		<Button Appearance="FLAT" ButtonStyle="TRUE" Color="user5" Cursor="HAND" DomainID="btn.save" Height="22" Id="btn_save" ImageID="btn_comm_save_k" Left="120" LeftMargin="20" OnClick="fn_OnClick_btn" TabOrder="1" Text="저장" Top="312" Width="52"></Button>
		<Button Appearance="FLAT" ButtonStyle="TRUE" Color="user5" Cursor="HAND" DomainID="btn.close" Height="22" Id="btn_close" ImageID="btn_comm_close_k" Left="176" LeftMargin="20" OnClick="fn_close" TabOrder="2" Text="취소" Top="312" Width="52"></Button>
		<Static Align="Right" Height="20" Id="Static0" Left="13" Style="sty_lb_search" TabOrder="6" Text="제품구분&#32;" Top="53" VAlign="Middle" Width="90"></Static>
		<Combo Border="Flat" CodeColumn="CODE" DataColumn="CODE_NAME" Editable="TRUE" Enable="FALSE" Height="20" Id="cb_zprdgbn" InnerDataset="ds_zprdgbn" Left="106" Style="sty_ipt_form" TabOrder="7" Top="53" Width="198"></Combo>
		<Static Align="Right" Height="20" Id="Static1" Left="13" Style="sty_lb_search" TabOrder="10" Text="템플릿구분&#32;" Top="80" VAlign="Middle" Width="90"></Static>
		<Combo Border="Flat" CodeColumn="CODE" DataColumn="CODE_NAME" Editable="TRUE" Enable="FALSE" Height="20" Id="cb_ztplgbn" InnerDataset="ds_ztplgbn" Left="106" Style="sty_ipt_form" TabOrder="9" Top="80" Width="198"></Combo>
		<Static Align="Right" Height="20" Id="st_TempName" Left="13" Style="sty_lb_search" TabOrder="8" Text="템플릿명&#32;" Top="109" VAlign="Middle" Width="90"></Static>
		<Edit BindDataset="ds_head" Border="Flat" Column="ZTPLNM" Height="20" Id="ed_TempName" ImeMode="english" Left="106" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="5" Top="109" UpperOnly="TRUE" Width="198"></Edit>
		<Static Align="Right" Height="20" Id="Static2" Left="13" Style="sty_lb_search" TabOrder="12" Text="비고&#32;" Top="136" VAlign="Middle" Width="90"></Static>
		<Edit BindDataset="ds_head" Border="Flat" Column="ZRMK" Height="20" Id="ed_Zrmk" ImeMode="english" Left="106" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="11" Top="136" UpperOnly="TRUE" Width="198"></Edit>
		<Edit Border="Flat" Height="20" Id="ed_hogi" ImeMode="english" Left="106" LeftMargin="4" OnChanged="ed_Hogi_OnChanged" RightMargin="4" Style="sty_ipt_form" TabOrder="13" Top="194" UpperOnly="TRUE" Width="198"></Edit>
		<Static Align="Right" Height="20" Id="Static3" Left="13" Style="sty_lb_search" TabOrder="14" Text="호기번호&#32;" Top="194" VAlign="Middle" Width="90"></Static>
		<Static Align="Right" Height="20" Id="Static4" Left="13" Style="sty_lb_search" TabOrder="15" Text="작성자&#32;" Top="165" VAlign="Middle" Width="90"></Static>
		<Edit BindDataset="ds_head" Border="Flat" Column="ZWRITER" Enable="FALSE" Height="20" Id="ed_zwriter" ImeMode="keep,native" Left="106" LeftMargin="4" MaxLength="10" RightMargin="4" Style="sty_ipt_form" TabOrder="16" Top="165" Width="198"></Edit>
		<Static Align="Right" Height="20" Id="Static5" Left="13" Style="sty_lb_search" TabOrder="18" Text="견적번호" Top="224" VAlign="Middle" Width="90"></Static>
		<Edit Border="Flat" Height="20" Id="ed_Qtnum" ImeMode="english" Left="106" LeftMargin="4" OnChanged="ed_Qtnum_OnChanged" RightMargin="4" Style="sty_ipt_form" TabOrder="17" Top="224" UpperOnly="TRUE" Width="198"></Edit>
		<Static Align="Right" Height="20" Id="Static6" Left="13" Style="sty_lb_search" TabOrder="19" Text="견적차수" Top="251" VAlign="Middle" Width="91"></Static>
		<Edit Border="Flat" Height="20" Id="ed_Qtser" ImeMode="english" Left="107" LeftMargin="4" OnChanged="ed_Qtser_OnChanged" RightMargin="4" Style="sty_ipt_form" TabOrder="20" Top="251" UpperOnly="TRUE" Width="45"></Edit>
		<Edit Border="Flat" Height="20" Id="ed_Qtseq" ImeMode="english" Left="256" LeftMargin="4" OnChanged="ed_Qtseq_OnChanged" RightMargin="4" Style="sty_ipt_form" TabOrder="22" Top="251" UpperOnly="TRUE" Width="47"></Edit>
		<Static Align="Right" Height="20" Id="Static7" Left="160" Style="sty_lb_search" TabOrder="21" Text="견적일련번호" Top="251" VAlign="Middle" Width="91"></Static>
	</Form>
	<Script><![CDATA[/*
 ******************************************************************************************
 * 기      능   : 
 * 작  성  자   : 
 * 작성  일자   : 
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */   
#include "LIB::commons.js";	// 공통 스크립트 
#include "LIB::nsfRequest.js";	// 공통 스크립트 
#include "LIB::common_hdel.js";	// 공통 스크립트  /* GNY 추가 */

//#include "LIB::common_coms.js";	// 파일업/다운로드 */
//=========================================================================================
// [ PART 1 ]
// Form에서 사용될 전역변수를 선언
// FORM에서 사용되는 전역변수는 대문자로 작성하며, F_XXX 의 형태를 갖도록 한다. 
//=========================================================================================

var F_pGubun;
var gZrqflg;
var gMsg;
var F_TITLE = "수주템플릿 가져오기";
//=========================================================================================
// [ PART 2 ]
// Form Loading / Unloading 시 작업 정의
//=========================================================================================
function fn_OnLoadCompleted(obj) {
	gfn_initForm(false); 	// Form 로드 이벤트 맨 첫줄에 기술 

	if (G_LANG != "ko")
	{
		F_TITLE = "Import Template";
		Static0.Value = "Prod. Type";
		Static1.Value = "Template Class";
		st_TempName.Value = "Template Name";
		Static2.Value = "Remarks";
		Static4.Value = "Draft";
		Static3.Value = "Model No.";
		Static5.Value = "Quote No.";
		Static6.Value = "Quote No.";
		Static7.Value = "Quote Serial No.";
				
		gfn_translation(obj, G_LANG);	//언어
	}
	
	fn_init_form(); 	// 폼 초기화

	div_btn.fn_loadUseBtn("", F_TITLE , "", "");   	// 화면제목 설정 및 버튼 활성화
}

/********************************************************************************
* 기      능   : form UnloadCompleted 
********************************************************************************/
function fn_OnUnloadCompleted(obj) {
	return gfn_isFormUnload(obj);
}

//=========================================================================================
// [ PART 3 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,form닫기)
//=========================================================================================
/********************************************************************************
* 기      능   : 조회 1
********************************************************************************/
function fn_query() {
	//trace("pGubun " +  pGubun);
	
	ds_temp.ClearData();		 
	ds_list.ClearData();	
    
	if (F_pGubun == "U") {	//
		
/*		
		fn_createWait("",this);     // 처리중입니다. 메시지 처리
		ds_cond.setColumn(0, "MANDT"  , G_MANDT         );    
		ds_cond.setColumn(0, "ZPRDGBN", pZprdgbn);
		
		//trace("cb_zprdgbn.Value : " + cb_zprdgbn.Value);
		nsfRequest("query", "ses0020/findTemp", "ds_cond=ds_cond ds_temp=ds_temp", "ds_temp=ds_temp ds_error=ds_error", "", "fn_afterQueryTemp");
*/
	} else if(F_pGubun == "S") {
		
/*
		fn_createWait("",this);     // 처리중입니다. 메시지 처리
		ds_cond.setColumn(0, "MANDT" , G_MANDT);
        ds_cond.setColumn(0, "ZTPLNO", pZtplno);
        ds_cond.setColumn(0, "ZTPLGBN", cb_ztplgbn.Value);
        ds_cond.setColumn(0, "ZPRDGBN", pZprdgbn);
        ds_cond.setColumn(0, "ZRMK", ed_Zrmk.Text);
*/
		//nsfRequest("query", "ses0020/find", "ds_cond=ds_cond ds_temp=ds_temp", "ds_temp=ds_temp ds_error=ds_error", "", "fn_afterQuery");
	}	
}

/********************************************************************************
* 기      능   : 폼 초기화
********************************************************************************/
function fn_init_form() {

	if ( isExistVar("pGubun", true) ) {
		F_pGubun = pGubun;
	}else	{
		F_pGubun = "";
	}

	//pGubun = pGubun;

	// 최종 변경된 셀정보 초기화
	F_CHG_COLNUM = "";	             // 변경된 컬럼번호
	F_CHG_ROWNUM = "";	             // 변경된 행번호
	F_MAX_SERNO  = 0;	             // 최종순번

	//코드콤보 설정 
	var codeArr     = ["SD100"];
	var dsObjArr    = [ds_ztplgbn];
	var addTypeArr  = [G_CODE_ALL,G_CODE_ALL,G_CODE_ALL];
	var oderTypeArr = ["DTEXT1"];

	gfn_searchCommCode2(codeArr, dsObjArr, addTypeArr, oderTypeArr);

	//combo값 가져오기 query
	nsfRequest("query"									// srvId
				, "combo/comboClass"					// url
				, "ds_zprdgbn=ds_zprdgbn"				// inDsList
				, "ds_zprdgbn=ds_zprdgbn"				// outDsList
				, "fn_query_class"						// CallBackFunc
				);
} 

/********************************************************************************
* 기      능   : 공통코드가 조회된 후의 Callback 함수 
********************************************************************************/
function fn_completeInit(sCode, sDsObj, sCodeType) {
	
	cb_zprdgbn.Value = pZprdgbn;
	cb_ztplgbn.Value = pZtplgbn;	
	ed_zwriter.value = pZwriter;	
}
/********************************************************************************
* 기      능   : 닫기  
********************************************************************************/
function fn_close() {
	close();
}


//=========================================================================================
// [ PART 4]
// Callback 함수 정의 : callback 함수명은 메인 함수의 fn_xxxx() 에서 xxxx 부분은 fn_afterXXXX()
// 형태가 되도록 작성 
//=========================================================================================
/********************************************************************************
* 기      능   : 조회 Callback  
********************************************************************************/
function fn_afterQuery(errCode, errMsg) {
	fn_destroyWait();
} 

//=========================================================================================
// [ PART 6 ]
// component Event 정의 : 각 Component 별 이벤트 
//=========================================================================================
/********************************************************************************
* 기      능   : 정렬 처리 
********************************************************************************/
function grd_list_OnHeadClick(obj,nCell,nX,nY,nPivotIndex) {

	if( nCell == 0 ) gfn_selectAllGrid(obj,nCell,nCell,true);
	else             gfn_sortGrid(obj, nCell);
}

/********************************************************************************
* 기      능   : 조회
********************************************************************************/
function fn_OnClick_btn(obj) {
	var fncName = "fn_" + substr(obj.id, 4); 
	eval( fncName + "()");
}

//=========================================================================================
// [ PART 3 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,form닫기)
//=========================================================================================
/********************************************************************************
* 기      능   : 저장 1
********************************************************************************/
function fn_save() {

	gfn_clearGridSortMark(grd_list);
	
	if(ed_TempName.Text =="" || ed_TempName.Text = null){
		//alert("템플릿명을 입력해주십시오");
		gfn_showAlert("CW10203");		//템플릿명을 입력해주십시오
		ed_TempName.SetFocus();
	   return;
	}	

	if((ed_hogi.Text =="" || ed_hogi.Text = null) && (ed_Qtnum.Text == "" || ed_Qtnum.Text = null)){
		//alert("호기번호를 입력해주십시오");
		gfn_showAlert("CW10214");		//호기번호를 입력해주십시오
		ed_hogi.SetFocus();
	   return;
	}	

	if (F_pGubun == null || F_pGubun == "") {
		//alert("저장할 자료가 없습니다.");
		gfn_showAlert("CW10204");		//템플릿명을 입력해주십시오
	} else {

		//if(!Confirm("저장하시겠습니까?")){
		if(!gfn_showConfirm("CI00008")){		//저장 하시겠습니까?
			return;
		}	

		//var zprdgbn = "";
		var zprdgbn = cb_zprdgbn.Value;
		var ztplgbn = cb_ztplgbn.Value;
			
		ds_head.setColumn(0, "ZPRDGBN", zprdgbn);
		ds_head.setColumn(0, "ZTPLGBN", ztplgbn);
		ds_head.setColumn(0, "ZTPLNM",  ed_TempName.Text);
		
		//RPC 수주데이터 가져오기
		var cd_hogi  = ed_hogi.Text;								// 호기번호
		var cd_qtnum = ed_qtnum.Text;								// 견적번호
		var cd_qtser = ed_qtser.Text;								// 견적차수
		var cd_qtseq = ed_qtseq.Text;								// 견적일련번호

		fn_createWait("",this);     // 처리중입니다. 메시지 처리

		ds_cond.ClearData();
		ds_cond.AddRow();
	
		ds_cond.SetColumn(0, "MANDT", G_MANDT);
		ds_cond.SetColumn(0, "HOGI", cd_hogi);
		ds_cond.SetColumn(0, "ZPRDGBN", ZPRDGBN);
		ds_cond.SetColumn(0, "QTNUM", cd_qtnum);
		ds_cond.SetColumn(0, "QTSER", cd_qtser);
		ds_cond.SetColumn(0, "QTSEQ", cd_qtseq);		
		
		if (cd_hogi != '') {
/*		
			nsfRequest(  "query"
					, "ses0320/receive"
					, "ds_cond=ds_cond"
					, "ds_sap=ds_list ds_sap2=ds_list2 ds_error=ds_error"
					, ""
					, "fn_aftersap"
					);
*/
			nsfRequest(  "query"
					, "ses0320/findPt"
					, "ds_cond=ds_cond ds_sap = ds_sap"
					, "ds_sap=ds_sap ds_error=ds_error"
					, ""
					, "fn_aftersap"
					);
					
		} else {
			nsfRequest(  "query"
					, "ses0320/findQt"
					, "ds_cond=ds_cond ds_sap = ds_sap"
					, "ds_sap=ds_sap ds_error=ds_error"
					, ""
					, "fn_aftersap"
					);
		}
	}
}

function fn_aftersap(svcId, errCode, errMsg){
	fn_destroyWait();

	if (ds_error.GetRowCount() >0)
	{
		// 처리에 실패했습니다.
		gfn_showMsg("CE00001");
		return;
	}

	if(ds_sap.GetRowCount() < 1)
	{
		//alert("해당 호기번호의 수주데이터가 없습니다.");
		gfn_showAlert("CW10213");		//해당 호기번호의 수주데이터가 없습니다.
		return;
	}
	//alert(ds_sap.rowcount);
	//alert("ds_sap.rowcount : " + ds_sap.rowcount);


	// 2020 브랜드
	var brndcd = "";
	// 조회된 영업사양 특성에 EL_ABRAND 값이 존재하면 brnd에 입력한다.
	var findRow = ds_sap.FindRow("NAM_CHAR", "EL_ABRAND");
	if(findRow > -1) {
	    if(ds_sap.GetColumn(findRow, "VALUE1") != null && ds_sap.GetColumn(findRow, "VALUE1") != '') {
	        brndcd = ds_sap.GetColumn(findRow, "VALUE1");
	    }
	}
    ds_head.SetColumn(0, "BRNDCD", brndcd);

	for( var i=0; i < ds_sap.GetRowCount(); i++) {
		var nRow = ds_save.addRow();
		//ds_save.copyRow(nRow, ds_sap, i);
		ds_save.setColumn(nRow, "MCLASS",  G_MANDT);
		ds_save.setColumn(nRow, "ZTPLNM",  ed_TempName.Text);
		ds_save.setColumn(nRow, "PRH",     ds_sap.getColumn(i, "NAM_CHAR"));
		ds_save.setColumn(nRow, "PRD" ,    ds_sap.getColumn(i, "VALUE1"));
		ds_save.setColumn(nRow, "FLAG",    "U");
	}

	//alert(ds_save.SaveXML()) + "::::" ds_save.rowcount;
	fn_createWait("",this);     // 처리중입니다. 메시지 처리

	var arg = "pGubun = " + quote(F_pGubun);
	nsfRequest(   "save"
				, "ses0320/save"
				, "ds_save=ds_save ds_head=ds_head", "ds_save=ds_save ds_error=ds_error"
				, arg
				, "fn_afterSave"
			  );

		//if (pGubun == "U") fn_close();// 신규 저장	
}

/********************************************************************************
* 기      능   : 저장 Callback
********************************************************************************/
function fn_afterSave(errCode, errMsg) {

	fn_destroyWait();

	if (ds_error.GetRowCount() > 0)	{
		gfn_showAlert("CE00001");
	}else	{
		gfn_showAlert("CI00003");

		ds_temp.ClearData();		 
		ds_sap.ClearData();	
	
		switch (F_pGubun) {
			case "S" : 
				fn_query();
				break;
			case "U" : 
				parent.fn_query();
				fn_close();
				break;
		}
	}
}
function ed_hogi_OnChanged(obj,strText)
{
    if (ed_hogi != ""){
		ed_Qtnum.Enable = false;
		ed_Qtser.Enable = false;
		ed_Qtseq.Enable = false;
	}else {
		ed_Qtnum.Enable = true;
		ed_Qtser.Enable = true;
		ed_Qtseq.Enable = true;
	    }
	 
	  
}

function ed_Qtnum_OnChanged(obj,strText)
{
    if (ed_Qtnum != "") {   
		ed_hogi.Enable = false;
	}else if (ed_Qtnum == "" && ed_Qtser == "" && ed_Qtseq == "")	{
		ed_hogi.Enable = true;
		}
}

function ed_Qtser_OnChanged(obj,strText)
{
    if (ed_Qtser != "") {   
		ed_hogi.Enable = false;
	}else if (ed_Qtnum == "" && ed_Qtser == "" && ed_Qtseq == "")	{
		ed_hogi.Enable = true;
		}	
}

function ed_Qtseq_OnChanged(obj,strText)
{	
    if (ed_Qtseq != "") {   
		ed_hogi.Enable = false;
	}else if (ed_Qtnum == "" && ed_Qtser == "" && ed_Qtseq == "")	{
		ed_hogi.Enable = true;
		}	
}
]]></Script>
</Window>