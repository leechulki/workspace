<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="560" Id="Ses0540" Left="8" OnLoadCompleted="fn_OnLoadCompleted" OnUnloadCompleted="fn_OnUnloadCompleted" PidAttrib="7" Title="&#32;시방서&#32;검토&#32;요청&#32;등록" Top="8" Ver="1.0" Width="978" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_cond">
				<Contents>
					<colinfo id="mandt" size="256" summ="default" type="STRING"/>
					<colinfo id="zrqno" size="256" summ="default" type="STRING"/>
					<colinfo id="kunnr" size="256" summ="default" type="STRING"/>
					<colinfo id="kunnr_nm" size="256" summ="default" type="STRING"/>
					<colinfo id="kunz2" size="256" summ="default" type="STRING"/>
					<colinfo id="kunz2_nm" size="256" summ="default" type="STRING"/>
					<colinfo id="zrqvym" size="256" summ="default" type="STRING"/>
					<colinfo id="zrqdat" size="256" summ="default" type="STRING"/>
					<colinfo id="part_cd" size="256" summ="default" type="STRING"/>
					<colinfo id="detail_cd" size="256" summ="default" type="STRING"/>
					<colinfo id="check_id" size="256" summ="default" type="STRING"/>
					<colinfo id="item_cd" size="256" summ="default" type="STRING"/>
					<colinfo id="searchkey" size="256" summ="default" type="STRING"/>
					<colinfo id="spec_text" size="256" summ="default" type="STRING"/>
					<colinfo id="sman" size="256" summ="default" type="STRING"/>
					<colinfo id="hdel_text" size="256" summ="default" type="STRING"/>
					<colinfo id="append_text" size="256" summ="default" type="STRING"/>
					<record>
						<append_text></append_text>
						<check_id></check_id>
						<detail_cd></detail_cd>
						<hdel_text></hdel_text>
						<item_cd></item_cd>
						<kunnr></kunnr>
						<kunnr_nm></kunnr_nm>
						<kunz2></kunz2>
						<kunz2_nm></kunz2_nm>
						<mandt></mandt>
						<part_cd></part_cd>
						<searchkey></searchkey>
						<sman></sman>
						<spec_text></spec_text>
						<zrqdat></zrqdat>
						<zrqno></zrqno>
						<zrqvym></zrqvym>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_error">
				<Contents>
					<colinfo id="IDX" size="256" type="STRING"/>
					<colinfo id="ERRMSG" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_zrqstat_cd">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list">
				<Contents>
					<colinfo id="mandt" size="256" summ="default" type="STRING"/>
					<colinfo id="flag" size="256" summ="default" type="STRING"/>
					<colinfo id="zrqno" size="256" summ="default" type="STRING"/>
					<colinfo id="zseq" size="256" summ="default" type="STRING"/>
					<colinfo id="destat" size="256" summ="default" type="STRING"/>
					<colinfo id="kunnr" size="256" summ="default" type="STRING"/>
					<colinfo id="kunnr_nm" size="256" summ="default" type="STRING"/>
					<colinfo id="name1" size="256" summ="default" type="STRING"/>
					<colinfo id="zrevym" size="256" summ="default" type="STRING"/>
					<colinfo id="kunz2" size="256" summ="default" type="STRING"/>
					<colinfo id="kunz2_nm" size="256" summ="default" type="STRING"/>
					<colinfo id="zrqdat" size="256" summ="default" type="STRING"/>
					<colinfo id="kunz3" size="256" summ="default" type="STRING"/>
					<colinfo id="kunz3_nm" size="256" summ="default" type="STRING"/>
					<colinfo id="zrecdt" size="256" summ="default" type="STRING"/>
					<colinfo id="zrefdt" size="256" summ="default" type="STRING"/>
					<colinfo id="vkbur" size="256" summ="default" type="STRING"/>
					<colinfo id="vkgrpVKGRP" size="256" summ="default" type="STRING"/>
					<colinfo id="part_cd" size="256" summ="default" type="STRING"/>
					<colinfo id="part_nm" size="256" summ="default" type="STRING"/>
					<colinfo id="detail_cd" size="256" summ="default" type="STRING"/>
					<colinfo id="detail_nm" size="256" summ="default" type="STRING"/>
					<colinfo id="check_id" size="256" summ="default" type="STRING"/>
					<colinfo id="check_nm" size="256" summ="default" type="STRING"/>
					<colinfo id="item_cd" size="256" summ="default" type="STRING"/>
					<colinfo id="searchkey" size="256" summ="default" type="STRING"/>
					<colinfo id="spec_text" size="256" summ="default" type="STRING"/>
					<colinfo id="hdel_text" size="256" summ="default" type="STRING"/>
					<colinfo id="append_text" size="256" summ="default" type="STRING"/>
					<colinfo id="sman" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_destat_cd">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_part_cd">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_detail_cd">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_header">
				<Contents>
					<colinfo id="mandt" size="256" summ="default" type="STRING"/>
					<colinfo id="zrqno" size="256" summ="default" type="STRING"/>
					<colinfo id="kunnr" size="256" summ="default" type="STRING"/>
					<colinfo id="kunnr_nm" size="256" summ="default" type="STRING"/>
					<colinfo id="kunz2" size="256" summ="default" type="STRING"/>
					<colinfo id="kunz2_nm" size="256" summ="default" type="STRING"/>
					<colinfo id="zrevym" size="256" summ="default" type="STRING"/>
					<colinfo id="zrqdat" size="256" summ="default" type="STRING"/>
					<colinfo id="part_cd" size="256" summ="default" type="STRING"/>
					<colinfo id="detail_cd" size="256" summ="default" type="STRING"/>
					<colinfo id="check_id" size="256" summ="default" type="STRING"/>
					<colinfo id="item_cd" size="256" summ="default" type="STRING"/>
					<colinfo id="searchkey" size="256" summ="default" type="STRING"/>
					<colinfo id="spec_text" size="256" summ="default" type="STRING"/>
					<colinfo id="sman" size="256" summ="default" type="STRING"/>
					<colinfo id="hdel_text" size="256" summ="default" type="STRING"/>
					<colinfo id="append_text" size="256" summ="default" type="STRING"/>
					<record>
						<append_text></append_text>
						<check_id></check_id>
						<detail_cd></detail_cd>
						<hdel_text></hdel_text>
						<item_cd></item_cd>
						<kunnr></kunnr>
						<kunnr_nm></kunnr_nm>
						<kunz2></kunz2>
						<kunz2_nm></kunz2_nm>
						<mandt></mandt>
						<part_cd></part_cd>
						<searchkey></searchkey>
						<sman></sman>
						<spec_text></spec_text>
						<zrevym></zrevym>
						<zrqdat></zrqdat>
						<zrqno></zrqno>
					</record>
				</Contents>
			</Dataset>
		</Datasets>
		<Shape BKColor="user0" Bottom="66" Height="26" Id="Shape1" Left="8" LineColor="user1" Right="970" TabOrder="1" Top="40" Type="Rectangle" Width="962"></Shape>
		<Shape BKColor="user0" Bottom="91" Height="26" Id="Shape2" Left="8" LineColor="user1" Right="970" TabOrder="2" Top="65" Type="Rectangle" Width="962"></Shape>
		<Static Align="Right" Height="24" Id="st_qtdat_fm" Left="9" Style="sty_lb_search" TabOrder="3" Text="요청번호&#32;" Top="41" VAlign="Middle" Width="119"></Static>
		<Grid AutoEnter="TRUE" AutoFitEndLine="Hide" BindDataset="ds_list" BkColor2="default" BoldHead="true" Border="Flat" Bottom="554" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="25" Height="208" HScrollCell="TRUE" Id="grd_list" InputPanel="FALSE" Left="8" LineColor="user20" LineType="ExHORZ" OnCellClick="grd_list_OnCellClick" OnExpandEdit="grd_list_OnExpandEdit" OnHeadClick="grd_List_OnHeadClick" Right="973" RowHeight="50" ScrollCell="true" Style="sty_grid" TabOrder="4" TabStop="true" Top="346" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="965">
			<contents>
				<format id="Default">
					<columns>
						<col width="31"/>
						<col width="34"/>
						<col width="55"/>
						<col width="88"/>
						<col width="160"/>
						<col width="197"/>
						<col width="80"/>
						<col width="181"/>
						<col width="400"/>
						<col width="304"/>
						<col width="514"/>
					</columns>
					<head>
						<cell align="center" col="0" color="user21" display="text" font="굴림,9" text="No"/>
						<cell col="1" color="user21" display="text" font="굴림,9" text="구분"/>
						<cell align="center" col="2" color="user21" display="text" font="굴림,9" text="항목품번"/>
						<cell align="center" col="3" color="user21" display="text" font="굴림,9" text="파트"/>
						<cell align="center" col="4" color="user21" display="text" font="굴림,9" text="세부파트"/>
						<cell align="center" col="5" color="user21" display="text" font="굴림,9" text="검토항목"/>
						<cell align="center" col="6" color="user21" display="text" font="굴림,9" text="항목번호"/>
						<cell align="center" col="7" color="user21" display="text" font="굴림,9" text="검색어"/>
						<cell align="center" col="8" color="user21" display="text" font="굴림,9" text="시방서내용"/>
						<cell col="9" color="user21" display="text" font="굴림,9" text="현대안/이유/의견"/>
						<cell col="10" color="user21" display="text" font="굴림,9" text="WEB항목/추가금액(원)"/>
					</head>
					<body>
						<cell align="center" bkcolor2="user22" col="0" display="text" expr="currow+1"/>
						<cell bkimageid='expr:gfn_getFlagBkImageID(getColumn(currow,&#32;&quot;FLAG&quot;))' col="1" colid="flag" display="text"/>
						<cell align="center" bkcolor2="user22" col="2" colid="ZSEQ" display="combo"/>
						<cell align="left" bkcolor2="user22" col="3" colid="PART_NM" display="combo"/>
						<cell align="left" bkcolor2="user22" col="4" colid="DETAIL_NM" display="text"/>
						<cell align="left" bkcolor2="user22" col="5" colid="CHECK_NM" display="text"/>
						<cell align="center" bkcolor2="user22" col="6" colid="ITEM_CD" display="text"/>
						<cell align="center" bkcolor2="user22" col="7" colid="SEARCHKEY" display="text"/>
						<cell align="left" bkcolor2="user22" col="8" colid="SPEC_TEXT" display="text" multiline="true" wordwrap="word"/>
						<cell col="9" colid="hdel_text" display="text"/>
						<cell col="10" colid="append_text" display="text"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Static Align="Right" Height="24" Id="Static3" Left="9" Style="sty_lb_search" TabOrder="5" Text="영업담당자&#32;" Top="66" VAlign="Middle" Width="119"></Static>
		<Shape BKColor="user0" Bottom="116" Height="26" Id="Shape0" Left="8" LineColor="user1" Right="970" TabOrder="6" Top="90" Type="Rectangle" Width="962"></Shape>
		<Static Align="Right" Height="24" Id="Static0" Left="372" Style="sty_lb_search" TabOrder="7" Text="시방서개정년월&#32;" Top="66" VAlign="Middle" Width="120"></Static>
		<Edit BindDataset="ds_header" Border="Flat" Column="sman" Enable="FALSE" Height="20" Id="ed_sman_cd" Left="131" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="8" Top="68" UpperOnly="TRUE" Width="80"></Edit>
		<Button Enable="FALSE" Height="18" Id="btn_popSman" ImageID="btn_icon_search" Left="212" OnClick="fn_OnClick_popup" TabOrder="9" Text="Button0" Top="69" Transparent="TRUE" Width="18"></Button>
		<Edit BindDataset="ds_header" Border="Flat" CheckLength="Byte" Column="kunz2_nm" Enable="FALSE" Height="20" Id="ed_sman_nm" ImeMode="none" Left="231" LeftMargin="4" MaxLength="105" RightMargin="4" Style="sty_ipt_search" TabOrder="10" Top="68" Width="83"></Edit>
		<Static Align="Right" Height="24" Id="Static7" Left="682" Style="sty_lb_search" TabOrder="11" Text="영업요청일자&#32;" Top="66" VAlign="Middle" Width="85"></Static>
		<Div Height="35" Id="div_btn" TabOrder="12" Text="Div0" Url="WB01::CommBtnForm.xml" Width="976">
			<Contents></Contents>
		</Div>
		<Static Align="Right" Height="24" Id="Static1" Left="372" Style="sty_lb_search" TabOrder="13" Text="건설사&#32;" Top="41" VAlign="Middle" Width="120"></Static>
		<Edit BindDataset="ds_header" Border="Flat" CheckLength="Byte" Column="kunnr_nm" Enable="FALSE" Height="20" Id="Edit0" ImeMode="none" Left="594" LeftMargin="4" MaxLength="105" RightMargin="4" Style="sty_ipt_search" TabOrder="16" Top="43" Width="83"></Edit>
		<Button Enable="FALSE" Height="18" Id="Button0" ImageID="btn_icon_search" Left="575" OnClick="fn_OnClick_popup" TabOrder="15" Text="Button0" Top="44" Transparent="TRUE" Width="18"></Button>
		<Edit BindDataset="ds_header" Border="Flat" Column="kunnr" Enable="FALSE" Height="20" Id="ed_kunnr" Left="494" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="14" Top="43" UpperOnly="TRUE" Width="80"></Edit>
		<Edit BindDataset="ds_header" Border="Flat" Column="zrqno" Enable="FALSE" Height="19" Id="ed_zrqno" ImeMode="english" Left="131" LeftMargin="4" MaxLength="10" RightMargin="4" Style="sty_ipt_form" TabOrder="17" Top="44" UpperOnly="TRUE" Width="100"></Edit>
		<Calendar BindDataset="ds_header" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="zrqdat" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Enable="FALSE" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_zrqdat" Left="770" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="18" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="68" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="88"></Calendar>
		<Shape BKColor="user0" Bottom="141" Height="26" Id="Shape3" Left="8" LineColor="user1" Right="970" TabOrder="19" Top="115" Type="Rectangle" Width="962"></Shape>
		<Shape BKColor="user0" Bottom="208" Height="68" Id="Shape4" Left="8" LineColor="user1" Right="970" TabOrder="20" Top="140" Type="Rectangle" Width="962"></Shape>
		<Static Align="Right" Height="24" Id="Static5" Left="9" Style="sty_lb_search" TabOrder="21" Text="파&#32;트&#32;" Top="91" VAlign="Middle" Width="119"></Static>
		<Combo BindDataset="ds_list" Border="Flat" CodeColumn="CODE" Column="PART_CD" DataColumn="CODE_NAME" Enable="FALSE" Height="20" Id="cb_part" InnerDataset="ds_part_cd" Left="130" OnChanged="cb_part_OnChanged" Style="sty_ipt_form" TabOrder="24" Top="92" Width="120"></Combo>
		<Static Align="Right" Height="24" Id="Static2" Left="288" Style="sty_lb_search" TabOrder="22" Text="세부파트&#32;" Top="91" VAlign="Middle" Width="85"></Static>
		<Combo BindDataset="ds_list" Border="Flat" CodeColumn="CODE" Column="DETAIL_CD" DataColumn="CODE_NAME" Enable="FALSE" Height="20" Id="cb_detail" InnerDataset="ds_detail_cd" Left="376" OnChanged="cb_detail_OnChanged" Style="sty_ipt_form" TabOrder="25" Top="92" Width="184"></Combo>
		<Static Align="Right" Height="24" Id="Static4" Left="682" Style="sty_lb_search" TabOrder="23" Text="검토항목&#32;" Top="91" VAlign="Middle" Width="85"></Static>
		<Combo BindDataset="ds_list" Border="Flat" CodeColumn="CODE" Column="CHECK_ID" DataColumn="CODE_NAME" Enable="FALSE" Height="20" Id="cb_check" InnerDataset="ds_check_id" Left="769" Style="sty_ipt_form" TabOrder="26" Top="92" Width="184"></Combo>
		<Static Align="Right" Height="24" Id="Static6" Left="9" Style="sty_lb_search" TabOrder="27" Text="항목번호&#32;" Top="116" VAlign="Middle" Width="119"></Static>
		<Edit BindDataset="ds_list" Border="Flat" Column="item_cd" Enable="FALSE" Height="17" Id="ed_item_no" ImeMode="english" Left="131" LeftMargin="4" MaxLength="10" RightMargin="4" Style="sty_ipt_form" TabOrder="28" Top="119" UpperOnly="TRUE" Width="152"></Edit>
		<Static Align="Right" Height="24" Id="Static8" Left="288" Style="sty_lb_search" TabOrder="29" Text="검색어&#32;" Top="116" VAlign="Middle" Width="85"></Static>
		<Edit BindDataset="ds_list" Border="Flat" Column="searchkey" Enable="FALSE" Height="19" Id="ed_searchkey" ImeMode="english" Left="376" LeftMargin="4" MaxLength="10" RightMargin="4" Style="sty_ipt_form" TabOrder="30" Top="119" UpperOnly="TRUE" Width="256"></Edit>
		<Static Align="Right" Height="67" Id="Static9" Left="9" Style="sty_lb_search" TabOrder="31" Text="시방서&#32;내용&#32;" Top="141" VAlign="Middle" Width="119"></Static>
		<TextArea BindDataset="ds_list" Border="Flat" Column="spec_text" Enable="FALSE" Height="64" Id="txt_spec_text" Left="131" Style="sty_ipt_form" TabOrder="32" Top="142" VScroll="TRUE" Width="829"></TextArea>
		<Shape BKColor="user0" Bottom="275" Height="68" Id="Shape5" Left="8" LineColor="user1" Right="970" TabOrder="33" Top="207" Type="Rectangle" Width="962"></Shape>
		<Shape BKColor="user0" Bottom="342" Height="68" Id="Shape6" Left="8" LineColor="user1" Right="970" TabOrder="34" Top="274" Type="Rectangle" Width="962"></Shape>
		<TextArea BindDataset="ds_list" Border="Flat" Column="hdel_text" Enable="FALSE" Height="64" Id="txt_hdel_text" Left="131" OnChanged="txt_hdel_text_OnChanged" Style="sty_ipt_form" TabOrder="36" Top="208" VScroll="TRUE" Width="829"></TextArea>
		<Static Align="Right" Height="67" Id="Static10" Left="9" Style="sty_lb_search" TabOrder="35" Text="현대안/이유/의견&#32;" Top="208" VAlign="Middle" Width="119"></Static>
		<TextArea BindDataset="ds_list" Border="Flat" Column="append_text" Enable="FALSE" Height="64" Id="txt_append_text" Left="131" Style="sty_ipt_form" TabOrder="38" Top="276" VScroll="TRUE" Width="829"></TextArea>
		<Static Align="Right" Height="66" Id="Static11" Left="9" Style="sty_lb_search" TabOrder="37" Text="시방서&#32;내용&#32;" Top="276" VAlign="Middle" Width="119"></Static>
		<Div BKColor="user0" Enable="FALSE" Height="22" Id="div_zrevym" Left="492" OnLoadCompleted="fn_OnLoadCompleted" TabOrder="39" Text="Div0" Top="67" Url="COM::Coms012.xml" Width="181">
			<Contents></Contents>
		</Div>
	</Form>
	<Script><![CDATA[/*
 ******************************************************************************************
 * 기      능   : 
 * 작  성  자   : 
 * 작성  일자   : 
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
#include "LIB::commons.js";	// 공통 스크립트 
#include "LIB::nsfRequest.js";	// 공통 스크립트 
#include "LIB::common_hdel.js";	// 공통 스크립트  /* GNY 추가 */
#include "LIB::common_sd.js";
//========================================================================================= 
// [ PART 1 ]
// Form에서 사용될 전역변수를 선언
// FORM에서 사용되는 전역변수는 대문자로 작성하며, F_XXX 의 형태를 갖도록 한다. 
//=========================================================================================
var F_FRM_TITLE;// = "견적상세(국내본팀)";	// 공통코드 화면명
var PARENT_SELECTED_BTN_ID ="";
var LIST_NOW_ROW = 0;
//=========================================================================================
// [ PART 2 ]
// Form Loading / Unloading 시 작업 정의
//=========================================================================================
function fn_OnLoadCompleted(obj) {
	// Form 로드 이벤트 맨 첫줄에 기술 
	gfn_initForm(true);	
	
	//팝업창 상단 타이블 및 버튼
	//21:재작성, 30:저장, 5:접수, 65:반송
	F_FRM_TITLE = "시방서 검토 요청 등록 ";
	div_btn.fn_loadUseBtn("62, 21,30,5,65", F_FRM_TITLE, "", ""); 
	
	var parentBtn = parent.F_NOW_LISTROW;
	PARENT_SELECTED_BTN_ID = parent.SELECTED_BTN_ID;
	var parentDestat = parent.ds_list.getColumn(parent.F_NOW_LISTROW, "destat");
	
	trace("parentBtn : " + parentBtn);
	trace("parentDestat : " + parentDestat);
	
	if(PARENT_SELECTED_BTN_ID == "btn_accept"){
		trace("부모창에서 '접수/반려'를 클릭하여 창이 열리는 경우");
		div_btn.btn_finish.enable = false;
		div_btn.btn_rewrite.enable = false;	//재작성
		div_btn.btn_save.enable = false;	//저장
	}else if(PARENT_SELECTED_BTN_ID == "btn_finish"){
		trace("부모창에서 '완료' 버튼을 클릭하여 열리는 경우");
		//완료일 경우 창을 열어야 하나??
		div_btn.btn_save.enable = false;	//접수
		div_btn.btn_receipt.enable = false;	//접수
		div_btn.btn_sendback.enable = false;	//반려
	}else if(PARENT_SELECTED_BTN_ID == "btn_reviewMake"){
		trace("부모창에서 '검토내용작성' 버튼을 클릭하여 열리는 경우");
		if(parentDestat != "TF"){
			txt_append_text.Enable = true;
			txt_hdel_text.Enable = true;
		}
		div_btn.btn_finish.enable = false;
		div_btn.btn_receipt.enable = false;		//접수
		div_btn.btn_sendback.enable = false;	//반려
	}else{
		trace("부모창에서 리스트를 더블 클릭하여 열리는 경우");
		div_btn.btn_save.enable = false;
		div_btn.btn_finish.enable = false;
		div_btn.btn_receipt.enable = false;		//접수
		div_btn.btn_sendback.enable = false;	//반려
	}
	
	//부보 창에서 클릭한 행 정보
	var parentRow = parent.F_NOW_LISTROW;
	
	//파트코드 불러오기
	fn_query_partcd();
	
	fn_query();
	
	fn_init_form(); 	// 폼 초기화
}

/********************************************************************************
* 기      능   : form UnloadCompleted 
********************************************************************************/
function fn_OnUnloadCompleted(obj) { 
	return gfn_isFormUnload(obj);
}

/********************************************************************************
* 기      능   : 폼 초기화
********************************************************************************/
function fn_init_form() {
	//시방서 개정일자 콤보 만들기
	var curYear = substr(gfn_getCurrDate(),0,4);		//현재 년도를 구한다.
	var curMonth = substr(gfn_getCurrDate(),4,2);		//현재 월을 구한다.
	div_zrevym.fn_makeYear(curYear,-7,0,0);				//시작년, 마지막년, 선택년 - 현재 년을 기준으로 한다.
	div_zrevym.cb_monthf.index = parseInt(curMonth)-1;

}

// 진행상태 코드 조회
function fn_query_DD07T(pDomainId, pDs)
{  
	// 데이타셋 초기화
	ds_cond_dd07t.ClearData();	
	pDs.ClearData();
	
	// 데이타셋 설정
	ds_cond_dd07t.AddRow();
	ds_cond_dd07t.SetColumn(ds_cond_dd07t.row, "DOMNAME"	, pDomainId);  
	ds_cond_dd07t.SetColumn(ds_cond_dd07t.row, "CONCAT_YN"	, "N");  
	
	// 서비스 호출
	nsfRequest(  ""
			   , "combo/comboDD07T"
			   , "ds_cond_dd07t=ds_cond_dd07t " + pDs.ID+"="+pDs.ID
			   , pDs.ID+"="+pDs.ID +" ds_error=ds_error"
			   , ""
			   , "fn_afterQuery_DD07T_"+pDomainId); 
}

// 진행산태 코드 조회 CALL BACK
function fn_afterQuery_DD07T_ZSDDDESTAT(errCode, errMsg) 
{  
	gfn_InsertRowCombo(ds_destat_cd, 0, "Y", "Y"); // 선택 행 추가
	cb_destat.index = 0;
}

// 파트 코드 조회
function fn_query_partcd(){
	nsfRequest(  ""
			   , "ses0510/queryPartCd"
			   , "ds_part_cd=ds_part_cd"
			   , "ds_part_cd=ds_part_cd ds_error=ds_error"
			   , ""
			   , "fn_afterQuery_partCd");
}

// 파트 조회 CALL BACK
function fn_afterQuery_partCd(errCode, errMsg) 
{  
	gfn_InsertRowCombo(ds_part_cd, 0, "Y", "Y"); // 선택 행 추가
	cb_part.index = 0;
}

// 세부파트 코드 조회
function cb_part_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	ds_detail_cd.DeleteAll();
	nsfRequest(  ""
			   , "ses0510/queryDetailCd"
			   , "ds_detail_cd=ds_detail_cd"
			   , "ds_detail_cd=ds_detail_cd ds_error=ds_error"
			   , "part_cd="+cb_part.Value
			   , "");
}

// 세부파트 코드 조회 CALL BACK
function fn_afterQuery_detailCd(errCode, errMsg) 
{  
	gfn_InsertRowCombo(ds_detail_cd, 0, "Y", "Y"); // 선택 행 추가
	cb_detail.index = 0;
}

// 세부파트 선택 시 검토항목 코드 조회
function cb_detail_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	ds_check_id.DeleteAll();
	nsfRequest(  ""
			   , "ses0510/queryCheckCd"
			   , "ds_check_id=ds_check_id"
			   , "ds_check_id=ds_check_id ds_error=ds_error"
			   , "detail_cd="+cb_detail.Value
			   , "");
}

// 세부파트 선택 시 검토항목 코드 조회 CALL BACK
function fn_afterQuery_checkCd(errCode, errMsg)
{  
	gfn_InsertRowCombo(ds_check_id, 0, "Y", "Y"); // 선택 행 추가
	cb_check.index = 0;
}

/********************************************************************************
* 기      능   : 조회 
********************************************************************************/
function fn_query() {
	//fn_createWait("",this);     // 처리중입니다. 메시지 처리
	
	ds_header.DeleteAll();	// 데이터셋 초기화
	ds_list.DeleteAll();	// 데이터셋 초기화
	
	var param = "zrqno="+parent.ds_list.GetColumn(F_NOW_LISTROW,"zrqno");
	
	nsfRequest("fn_query", 
				"ses0540/selectDeviationListDetail", 
				"ds_header=ds_header ds_list=ds_list", 
				"ds_header=ds_header ds_list=ds_list ds_error=ds_error", 
				param, 
				"fn_afterQuery");
}


/********************************************************************************
* 기      능   : 닫기  
********************************************************************************/
function fn_close() {
	close();
}

function fn_afterQuery(svcId, errCode, errMsg){
	if (svcId == "fn_query") {
		trace("코드 읽어오기");
		// 상단 건설사, 시방서개정년월, 영업담당자 셋팅하기
		trace("부모창 더블 클릭");
		div_zrevym.cb_yearf.Value =  substr(ds_header.GetColumn(0,"zrevym"),0,4);
		div_zrevym.cb_monthf.Value = substr(ds_header.GetColumn(0,"zrevym"),4,2);
				
		//list에 맞는 세부코드를 읽어온다.
		cb_part_OnChanged();
		
		//list에 맞는 검토 항목을 읽어온다.
		cb_detail_OnChanged();
	} else if(svcId == "DeviationReceipt" || svcId == "DeviationSendback" || svcId == "DeviationFinish"){
		if ( ds_error.GetRowCount() > 0 ) {
			gfn_showAlert("CE00001");
			return;
		}else if(svcId == "DeviationReceipt"){
			alert("접수가 완료 되었습니다.");
		}else if(svcId == "DeviationSendback"){
			alert("반송 처리 되었습니다.");
		}else if(svcId == "DeviationFinish"){
			alert("완료 처리 되었습니다.");
		}
		
		parent.fn_query();
		fn_close();
	} 
	
}

// 그리드 클릭시 해당 내용을 상단에 보여주기
function grd_list_OnCellClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
	LIST_NOW_ROW = nRow;
	//파트 세부파트에 대한 코드를 셋팅한다.
	cb_part.Value = ds_list.GetColumn(nRow,"part_cd");
	cb_part_OnChanged();
	cb_detail.Value = ds_list.GetColumn(nRow,"detail_cd");
	cb_detail_OnChanged();
}

function fn_OnClick_popup(obj)
{
	var arg = "fa_sman_cd= " 	+ quote(ed_sman_cd.text) // 담당자코드
			 + " fa_sman_nm = " + quote(ed_sman_nm.text); // 담당자명 
			 	
	var arr = gfn_openPopUpUrlHdel("Com::Com0030.xml", true, arg);	
	
	//trace("arr : " + arr);
	
	if (arr != null && arr != 0) {
		ed_sman_cd.text = arr[0];	// 리턴된 담당자코드로 검색조건 SET
		ed_sman_nm.text = arr[1];	// 리턴된 담당자명으로 검색조건 SET
		ed_sman_nm.SetFocus();
	} 
}

// 접수 버튼 클릭시
function fn_receipt(){
	// 접수하기 : 상태값 변경(TA), 접수 마스터에 등록(ZSDT0176)
	trace("접수 하기");
	
	var param = "zrqno=" + ds_header.GetColumn(0, "zrqno");
	
	nsfRequest("DeviationReceipt", 
				"ses0540/saveDeviationDetailListReceipt", 
				"ds_header=ds_header", 
				"ds_header=ds_header ds_error=ds_error", 
				param, 
				"fn_afterQuery");
}


//반송 버튼 클릭시
function fn_sendback(){
	// 반송하기 : 상태값 변경(TB), 접수 마스터에 등록(ZSDT0176)
	trace("반송 하기");
	
	var param = "zrqno=" + ds_header.GetColumn(0, "zrqno");
	
	nsfRequest("DeviationSendback", 
				"ses0540/saveDeviationDetailListSendback", 
				"ds_header=ds_header", 
				"ds_header=ds_header ds_error=ds_error", 
				param, 
				"fn_afterQuery");
}

function txt_hdel_text_OnChanged(obj,strText)
{
	ds_list.SetColumn(LIST_NOW_ROW,"flag","U");
}


//저장
function fn_save(){
	trace("저장");
	
	var param = "zrqno=" + ds_header.GetColumn(0, "zrqno");
	
	nsfRequest("saveDeviationReview", 
				"ses0540/saveDeviationDetailListReview", 
				"ds_header=ds_header ds_list=ds_list", 
				"ds_header=ds_header ds_list=ds_list ds_error=ds_error", 
				param, 
				"fn_afterQuery");
}

//완료
function fn_finish(){
	var param = "zrqno=" + ds_header.GetColumn(0, "zrqno");
	
	nsfRequest("DeviationFinish", 
				"ses0540/saveDeviationDetailListFinish", 
				"ds_header=ds_header", 
				"ds_header=ds_header ds_error=ds_error", 
				param, 
				"fn_afterQuery");
}
]]></Script>
</Window>