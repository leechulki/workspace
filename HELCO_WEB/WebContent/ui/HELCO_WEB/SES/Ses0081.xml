<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="560" Id="Ses0081" Left="8" OnLoadCompleted="fn_OnLoadCompleted" OnUnloadCompleted="fn_OnUnloadCompleted" PidAttrib="7" Title="견적승인판정" Top="8" Ver="1.0" Width="978" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_pst">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ara">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ncd">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond">
				<Contents>
					<colinfo id="FCDT" size="256" summ="default" type="STRING"/>
					<colinfo id="TCDT" size="256" summ="default" type="STRING"/>
					<colinfo id="ARA" size="256" summ="default" type="STRING"/>
					<colinfo id="PST" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="ORD1" size="256" summ="default" type="STRING"/>
					<colinfo id="ORD2" size="256" summ="default" type="STRING"/>
					<colinfo id="JRT" size="256" summ="default" type="STRING"/>
					<colinfo id="ZAGNT" size="256" summ="default" type="STRING"/>
					<colinfo id="VKGRP" size="256" summ="default" type="STRING"/>
					<colinfo id="USER" size="256" summ="default" type="STRING"/>
					<colinfo id="GNO" size="256" summ="default" type="STRING"/>
					<colinfo id="QTGBN" size="256" summ="default" type="STRING"/>
					<colinfo id="QTNUM" size="256" summ="default" type="STRING"/>
					<record>
						<ARA></ARA>
						<FCDT></FCDT>
						<GBN></GBN>
						<GNO></GNO>
						<JRT></JRT>
						<ORD1></ORD1>
						<ORD2></ORD2>
						<PST></PST>
						<QTGBN></QTGBN>
						<QTNUM></QTNUM>
						<TCDT></TCDT>
						<USER></USER>
						<VKGRP></VKGRP>
						<ZAGNT></ZAGNT>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list">
				<Contents>
					<colinfo id="MANDT" size="256" summ="default" type="STRING"/>
					<colinfo id="QTNUM" size="601" summ="default" type="STRING"/>
					<colinfo id="QTSER" size="24" summ="default" type="STRING"/>
					<colinfo id="SPART" size="22" summ="default" type="STRING"/>
					<colinfo id="ZDEV" size="256" summ="default" type="STRING"/>
					<colinfo id="ZGNM" size="22" summ="default" type="STRING"/>
					<colinfo id="GSNAM" size="256" summ="default" type="STRING"/>
					<colinfo id="ZNUMBER" size="300" summ="default" type="STRING"/>
					<colinfo id="ZRQDAT" size="42" summ="default" type="STRING"/>
					<colinfo id="DELDAT" size="105" summ="default" type="STRING"/>
					<colinfo id="ZADDR_ADR1" size="6" summ="default" type="STRING"/>
					<colinfo id="ZPID" size="24" summ="default" type="STRING"/>
					<colinfo id="ZICIF_PPCT" size="22" summ="default" type="STRING"/>
					<colinfo id="ZICIF_PPRT" size="6" summ="default" type="STRING"/>
					<colinfo id="ZICIF_1STCT" size="6" summ="default" type="STRING"/>
					<colinfo id="ZICIF_1STRT" size="22" summ="default" type="STRING"/>
					<colinfo id="ZICIF_2STCT" size="22" summ="default" type="STRING"/>
					<colinfo id="ZICIF_2STRT" size="60" summ="default" type="STRING"/>
					<colinfo id="ZICIF_RMCT" size="22" summ="default" type="STRING"/>
					<colinfo id="ZICIF_RMRT" size="22" summ="default" type="STRING"/>
					<colinfo id="ZTEL" size="256" summ="default" type="STRING"/>
					<colinfo id="ZPRGFLG" size="256" summ="default" type="STRING"/>
					<colinfo id="ZAPFLG" size="256" summ="default" type="STRING"/>
					<colinfo id="ZRTRSN" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="UUSER" size="18" summ="default" type="STRING"/>
					<colinfo id="ZAPDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="ZRQCN" size="256" summ="default" type="STRING"/>
					<colinfo id="KUNNR" size="256" summ="default" type="STRING"/>
					<colinfo id="KUNNR_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="ZAGNT" size="256" summ="default" type="STRING"/>
					<colinfo id="ZAGNT_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="ZKUNNR_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="QTGBN" size="256" summ="default" type="STRING"/>
					<colinfo id="PRD" size="256" summ="default" type="STRING"/>
					<colinfo id="FILECNT" size="256" summ="default" type="STRING"/>
					<colinfo id="VKBUR" size="256" summ="default" type="STRING"/>
					<colinfo id="MAXQTSER_ZPRGFLG" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_sukum">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_jrt">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ord1">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
					<record>
						<CODE>1</CODE>
						<CODE_NAME>요청일자</CODE_NAME>
					</record>
					<record>
						<CODE>2</CODE>
						<CODE_NAME>발주처</CODE_NAME>
					</record>
					<record>
						<CODE>3</CODE>
						<CODE_NAME>공사명</CODE_NAME>
					</record>
					<record>
						<CODE>4</CODE>
						<CODE_NAME>담당자</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ord2">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
					<record>
						<CODE>1</CODE>
						<CODE_NAME>오름차순</CODE_NAME>
					</record>
					<record>
						<CODE>2</CODE>
						<CODE_NAME>내림차순</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_jrt2">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_gbn">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_del">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME>-&#32;전체&#32;-</CODE_NAME>
					</record>
					<record>
						<CODE>N</CODE>
						<CODE_NAME>정상</CODE_NAME>
					</record>
					<record>
						<CODE>Y</CODE>
						<CODE_NAME>삭제</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_del2">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE>N</CODE>
						<CODE_NAME>정상</CODE_NAME>
					</record>
					<record>
						<CODE>Y</CODE>
						<CODE_NAME>삭제</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_error">
				<Contents>
					<colinfo id="IDX" size="256" type="STRING"/>
					<colinfo id="ERRMSG" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_vkgrp">
				<Contents>
					<colinfo id="CODE" size="9" type="STRING"/>
					<colinfo id="CODE_NAME" size="60" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_qtgbn">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME>-&#32;전체&#32;-</CODE_NAME>
					</record>
					<record>
						<CODE>A</CODE>
						<CODE_NAME>실행가</CODE_NAME>
					</record>
					<record>
						<CODE>B</CODE>
						<CODE_NAME>예산가</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_gno">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
					<colinfo id="ARA" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_user">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
					<colinfo id="LIFNR" size="256" type="STRING"/>
					<colinfo id="ARA" size="256" type="STRING"/>
				</Contents>
			</Dataset>
		</Datasets>
		<Shape BKColor="user0" Bottom="80" Height="79" Id="Shape0" Left="0" LineColor="user1" Right="978" TabOrder="8" Top="1" Type="Rectangle" Width="978"></Shape>
		<Static Align="Right" Height="20" Id="st_date" Left="8" Style="sty_lb_search" TabOrder="9" Text="요청기간&#32;" Top="6" VAlign="Middle" Width="56"></Static>
		<Static Align="Right" Height="20" Id="st_pst" Left="504" Style="sty_lb_search" TabOrder="10" Text="진행상태&#32;" Top="30" VAlign="Middle" Width="60"></Static>
		<Grid AutoEnter="TRUE" AutoFitEndLine="Hide" BindDataset="ds_list" BkColor2="default" BoldHead="true" Border="Flat" Bottom="551" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="463" Id="grd_list" InputPanel="FALSE" Left="8" LineColor="user20" LineType="ExHORZ" OnCellClick="grd_list_OnCellClick" OnCellDBLClick="grd_list_OnCellDblClick" Right="966" RowHeight="20" Style="sty_grid" TabOrder="11" TabStop="true" Top="88" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="958">
			<contents>
				<format id="Default">
					<columns>
						<col fix="left" width="30"/>
						<col fix="left" width="79"/>
						<col fix="left" width="40"/>
						<col fix="left" width="55"/>
						<col fix="left" width="55"/>
						<col fix="left" width="167"/>
						<col fix="left" width="131"/>
						<col fix="left" width="110"/>
						<col width="110"/>
						<col width="90"/>
						<col width="40"/>
						<col width="73"/>
						<col width="70"/>
						<col width="250"/>
						<col width="45"/>
						<col width="55"/>
						<col width="60"/>
						<col width="60"/>
						<col width="60"/>
						<col width="60"/>
						<col width="40"/>
						<col width="70"/>
						<col width="95"/>
						<col width="95"/>
						<col width="58"/>
						<col width="108"/>
						<col width="75"/>
						<col width="55"/>
					</columns>
					<head>
						<cell bkcolor="user23" col="0" colspan="20" display="text">
							<cell align="center" col="0" color="user21" colspan="20" display="text" font="굴림,9" text="견적승인의뢰&#32;정보"/>
						</cell>
						<cell bkcolor="user23" col="20" display="text">
							<cell align="center" col="0" color="user21" colspan="20" display="text" font="굴림,9" text="견적승인의뢰&#32;정보"/>
						</cell>
						<cell bkcolor="user23" col="4" color="user21" display="text" row="1" rowspan="2">
							<cell align="center" col="0" color="user21" display="text" font="굴림,9" rowspan="2" text="견적구분"/>
						</cell>
						<cell bkcolor="user23" col="20" colspan="8" display="text">
							<cell align="center" col="0" color="user21" colspan="8" display="text" font="굴림,9" text="견적승인&#32;판정정보"/>
						</cell>
						<cell bkcolor="user23" col="0" color="user21" display="text" row="1" rowspan="2">
							<cell align="center" col="0" color="user21" display="text" font="굴림,9" rowspan="2" text="NO"/>
						</cell>
						<cell bkcolor="user23" col="1" color="user21" display="text" row="1" rowspan="2">
							<cell align="center" col="0" color="user21" display="text" font="굴림,9" rowspan="2" text="견적번호"/>
						</cell>
						<cell bkcolor="user23" col="2" color="user21" display="text" row="1" rowspan="2">
							<cell align="center" col="0" color="user21" display="text" font="굴림,9" rowspan="2" text="차수"/>
						</cell>
						<cell bkcolor="user23" col="3" color="user21" display="text" row="1" rowspan="2">
							<cell align="center" col="0" color="user21" display="text" font="굴림,9" rowspan="2" text="제품구분"/>
						</cell>
						<cell bkcolor="user23" col="5" color="user21" display="text" row="1" rowspan="2">
							<cell align="center" col="0" color="user21" display="text" font="굴림,9" rowspan="2" text="고객명"/>
						</cell>
						<cell bkcolor="user23" col="6" color="user21" display="text" row="1" rowspan="2">
							<cell align="center" col="0" color="user21" display="text" font="굴림,9" rowspan="2" text="대리점명"/>
						</cell>
						<cell bkcolor="user23" col="7" color="user21" display="text" row="1" rowspan="2">
							<cell align="center" col="0" color="user21" display="text" font="굴림,9" rowspan="2" text="시행사"/>
						</cell>
						<cell bkcolor="user23" col="8" color="user21" display="text" row="1" rowspan="2">
							<cell align="center" col="0" color="user21" display="text" font="굴림,9" rowspan="2" text="발주처"/>
						</cell>
						<cell bkcolor="user23" col="9" color="user21" display="text" row="1" rowspan="2">
							<cell align="center" col="0" color="user21" display="text" font="굴림,9" rowspan="2" text="공사명"/>
						</cell>
						<cell bkcolor="user23" col="10" color="user21" display="text" row="1" rowspan="2">
							<cell align="center" col="0" color="user21" display="text" font="굴림,9" rowspan="2" text="대수"/>
						</cell>
						<cell align="center" bkcolor="user23" col="11" color="user21" display="text" font="굴림,9" row="1" rowspan="2" text="의뢰일"/>
						<cell align="center" bkcolor="user23" col="12" color="user21" display="text" font="굴림,9" row="1" rowspan="2" text="납기일"/>
						<cell bkcolor="user23" col="13" color="user21" display="text" row="1" rowspan="2">
							<cell align="center" col="0" color="user21" display="text" font="굴림,9" rowspan="2" text="주소"/>
						</cell>
						<cell bkcolor="user23" col="14" color="user21" display="text" row="1" rowspan="2">
							<cell align="center" col="0" color="user21" display="text" font="굴림,9" rowspan="2" text="담당자"/>
						</cell>
						<cell bkcolor="user23" col="15" color="user21" display="text" row="1" rowspan="2">
							<cell align="center" col="0" color="user21" display="text" font="굴림,9" rowspan="2" text="첨부파일"/>
						</cell>
						<cell bkcolor="user23" col="16" colspan="4" display="text" row="1">
							<cell align="center" col="0" color="user21" colspan="4" display="text" font="굴림,9" text="수금조건"/>
						</cell>
						<cell bkcolor="user23" col="20" display="text" row="1" rowspan="2">
							<cell align="center" col="0" color="user21" display="text" font="굴림,9" rowspan="2" text="검증&#10;지원"/>
						</cell>
						<cell bkcolor="user23" col="21" display="text" row="1" rowspan="2">
							<cell align="center" col="0" color="user21" display="text" font="굴림,9" rowspan="2" text="요청일자"/>
						</cell>
						<cell bkcolor="user23" col="22" display="text" row="1" rowspan="2">
							<cell align="center" col="0" color="user21" display="text" font="굴림,9" rowspan="2" text="해당차수&#10;진행상태"/>
						</cell>
						<cell bkcolor="user23" col="23" display="text" row="1" rowspan="2">
							<cell align="center" col="0" color="user21" display="text" font="굴림,9" rowspan="2" text="최종차수&#10;진행상태"/>
						</cell>
						<cell bkcolor="user23" col="24" display="text" row="1" rowspan="2">
							<cell align="center" col="0" color="user21" display="text" font="굴림,9" rowspan="2" text="판정결과"/>
						</cell>
						<cell bkcolor="user23" col="25" display="text" row="1" rowspan="2">
							<cell align="center" col="0" color="user21" display="text" font="굴림,9" rowspan="2" text="불가사유"/>
						</cell>
						<cell bkcolor="user23" col="26" display="text" row="1" rowspan="2">
							<cell align="center" col="0" color="user21" display="text" font="굴림,9" rowspan="2" text="판정일자"/>
						</cell>
						<cell bkcolor="user23" col="27" display="text" row="1" rowspan="2">
							<cell align="center" col="0" color="user21" display="text" font="굴림,9" rowspan="2" text="판정자"/>
						</cell>
						<cell align="center" bkcolor="user23" col="16" color="user21" display="text" font="굴림,9" row="2" text="선수금"/>
						<cell align="center" bkcolor="user23" col="17" color="user21" display="text" font="굴림,9" row="2" text="1차중도금"/>
						<cell align="center" bkcolor="user23" col="18" color="user21" display="text" font="굴림,9" row="2" text="2차중도금"/>
						<cell align="center" bkcolor="user23" col="19" color="user21" display="text" font="굴림,9" row="2" text="잔금"/>
					</head>
					<body>
						<cell align="center" col="0" colid="CHK" display="text" expr="currow+1" rowspan="2"/>
						<cell col="1" colid="QTNUM" display="text" rowspan="2"/>
						<cell align="center" col="2" colid="QTSER" display="text" multiline="true" rowspan="2"/>
						<cell align="center" col="3" colid="SPART" combocol="CODE" combodataset="ds_gbn" combotext="CODE_NAME" display="combo" multiline="true" rowspan="2"/>
						<cell align="center" col="4" colid="QTGBN" display="text" rowspan="2"/>
						<cell col="5" colid="KUNNR_NM" display="text" multiline="true" rowspan="2"/>
						<cell col="6" colid="ZAGNT_NM" display="text" multiline="true" rowspan="2"/>
						<cell col="7" colid="ZDEV" display="text" multiline="true" rowspan="2"/>
						<cell col="8" colid="ZGNM" display="text" multiline="true" rowspan="2"/>
						<cell col="9" colid="GSNAM" display="text" multiline="true" rowspan="2"/>
						<cell align="right" col="10" colid="ZNUMBER" display="number" rowspan="2"/>
						<cell align="center" bkcolor2="user22" col="11" colid="ZRQDAT" display="text" Mask="####.##.##" rowspan="2"/>
						<cell align="center" bkcolor2="user22" col="12" colid="DELDAT" display="text" Mask="####.##.##" rowspan="2"/>
						<cell col="13" colid="ZADDR_ADR1" display="text" multiline="true" rowspan="2"/>
						<cell align="left" col="14" colid="ZKUNNR_NM" display="text" rowspan="2"/>
						<cell align="left" bkcolor2="user22" col="15" display="text" expandshow="expr:decode(FILECNT,&apos;0&apos;,&apos;False&apos;,&apos;True&apos;)" expandsize="30" rowspan="2"/>
						<cell align="center" bkcolor2="user22" col="16" colid="ZICIF_PPCT" display="text"/>
						<cell align="center" col="26" colid="ZAPDAT" display="text" Mask="####.##.##" rowspan="2"/>
						<cell align="center" col="27" colid="UUSER" display="text" rowspan="2"/>
						<cell align="right" col="16" colid="ZICIF_PPRT" display="text" row="1"/>
						<cell align="center" bkcolor2="user22" col="17" colid="ZICIF_1STCT" display="text"/>
						<cell align="center" bkcolor2="user22" col="18" colid="ZICIF_2STCT" display="text"/>
						<cell align="right" col="17" colid="ZICIF_1STRT" display="text" row="1"/>
						<cell align="center" bkcolor2="user22" col="19" colid="ZICIF_RMCT" display="text"/>
						<cell align="center" bkcolor2="user22" bkimagealign="stretch" bkimageid="btn_grid_01" col="20" cursor="hand" display="button" rowspan="2" text="검&#32;증"/>
						<cell col="21" colid="ZRQDAT" display="text" Mask="####.##.##" rowspan="2"/>
						<cell align="center" col="22" colid="ZPRGFLG" combocol="CODE" combodataset="ds_pst" combotext="CODE_NAME" display="combo" rowspan="2"/>
						<cell align="center" col="23" colid="MAXQTSER_ZPRGFLG" combocol="CODE" combodataset="ds_pst" combotext="CODE_NAME" display="combo" rowspan="2"/>
						<cell align="right" col="19" colid="ZICIF_RMRT" display="text" row="1"/>
						<cell align="center" col="24" colid="ZAPFLG" combocol="CODE" combodataset="ds_jrt" combotext="CODE_NAME" display="combo" rowspan="2"/>
						<cell align="center" col="25" colid="ZRTRSN" display="text" rowspan="2"/>
						<cell align="right" col="18" colid="ZICIF_2STRT" display="text" row="1"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Calendar Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="FCDT" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_fcdt" Left="67" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_search" SundayTextColor="user35" TabOrder="0" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="6" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="101"></Calendar>
		<Static Align="Center" Border="None" Color="user7" Font="굴림,9" Height="20" Id="Static13" Left="168" TabOrder="12" Text="~" Top="6" VAlign="Middle" Width="18"></Static>
		<Calendar Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="TCDT" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_tcdt" Left="186" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_search" SundayTextColor="user35" TabOrder="1" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="6" TopMargin="1" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="101"></Calendar>
		<Combo Border="Flat" CodeColumn="CODE" Column="PST" DataColumn="CODE_NAME" Height="20" Id="cb_pst" InnerDataset="ds_pst" Left="570" Style="sty_ipt_search" TabOrder="2" Top="29" Width="101"></Combo>
		<Static Height="18" Id="st_cond" Left="88" TabOrder="13" Text="조회조건을&#32;하나이상" Top="617" Visible="FALSE" Width="120"></Static>
		<Static Height="16" Id="st_panguyl" Left="208" TabOrder="14" Text="판정결과" Top="617" Visible="FALSE" Width="56"></Static>
		<Static Height="13" Id="st_bulga" Left="264" TabOrder="15" Text="불가" Top="617" Visible="FALSE" Width="40"></Static>
		<Static Height="16" Id="st_ncd" Left="296" TabOrder="16" Text="불가사유" Top="617" Visible="FALSE" Width="50"></Static>
		<Static Align="Right" Height="20" Id="Static0" Left="8" Style="sty_lb_search" TabOrder="17" Text="정렬&#32;" Top="30" VAlign="Middle" Width="56"></Static>
		<Combo Border="Flat" CodeColumn="CODE" Column="ORD1" DataColumn="CODE_NAME" Height="20" Id="cb_ord1" InnerDataset="ds_ord1" Left="66" Style="sty_ipt_search" TabOrder="4" Top="29" Width="101"></Combo>
		<Combo Border="Flat" CodeColumn="CODE" Column="ORD2" DataColumn="CODE_NAME" Height="20" Id="cb_ord2" InnerDataset="ds_ord2" Left="185" Style="sty_ipt_search" TabOrder="5" Top="29" Width="101"></Combo>
		<Static Align="Right" Height="20" Id="Static1" Left="300" Style="sty_lb_search" TabOrder="18" Text="판정결과&#32;" Top="30" VAlign="Middle" Width="56"></Static>
		<Combo Border="Flat" CodeColumn="CODE" Column="JRT" DataColumn="CODE_NAME" Height="20" Id="cb_jrt" ImeMode="none" InnerDataset="ds_jrt2" Left="360" Style="sty_ipt_search" TabOrder="6" Top="29" Width="102"></Combo>
		<Static Align="Right" Height="20" Id="Static2" Left="699" Style="sty_lb_search" TabOrder="19" Text="제품구분&#32;" Top="30" VAlign="Middle" Width="64"></Static>
		<Combo Border="Flat" CodeColumn="CODE" Column="GBN" DataColumn="CODE_NAME" Height="20" Id="cb_gbn" InnerDataset="ds_gbn" Left="769" Style="sty_ipt_search" TabOrder="3" Top="29" Width="102"></Combo>
		<Static Height="13" Id="st_param" Left="352" TabOrder="20" Text="저장할" Top="617" Visible="FALSE" Width="40"></Static>
		<Div BKColor="user0" Height="20" Id="div_lifnr" Left="571" OnLoadCompleted="fn_OnLoadCompleted" OnTimer="WB0199010A_OnTimer" Style="sty_ipt_form" TabOrder="21" Text="Div0" Top="7" Url="COM::Coms004.xml" Width="289">
			<Contents></Contents>
		</Div>
		<Static Align="Right" Height="20" Id="Static3" Left="503" Style="sty_lb_search" TabOrder="22" Text="대리점" Top="6" VAlign="Middle" Width="61"></Static>
		<Static Align="Right" Height="20" Id="st_vkgrp" Left="300" Style="sty_lb_search" TabOrder="23" Text="팀&#32;" Top="6" VAlign="Middle" Width="56"></Static>
		<Div BKColor="user0" Height="20" Id="div_vbvg" Left="361" OnLoadCompleted="fn_OnLoadCompleted" OnTimer="WB0199010A_OnTimer" TabOrder="24" Text="Div0" Top="6" Url="COM::Coms011.xml" Width="135">
			<Contents></Contents>
		</Div>
		<Static Align="Right" Height="20" Id="Static4" Left="8" Style="sty_lb_search" TabOrder="25" Text="지역" Top="54" VAlign="Middle" Width="56"></Static>
		<Combo Border="Flat" CodeColumn="CODE" Column="ARA" DataColumn="CODE_NAME" Height="20" Id="cb_ara" InnerDataset="ds_ara" Left="66" OnChanged="cb_ara_OnChanged" Style="sty_ipt_search" TabOrder="26" Top="53" Width="101"></Combo>
		<Combo Border="Flat" CodeColumn="CODE" Column="GNO" DataColumn="CODE_NAME" Height="20" Id="cb_gno" InnerDataset="ds_gno" Left="185" OnChanged="cb_gno_OnChanged" Style="sty_ipt_search" TabOrder="27" Top="53" Width="101"></Combo>
		<Combo Border="Flat" CodeColumn="CODE" Column="USER" DataColumn="CODE_NAME" Height="20" Id="cb_user" InnerDataset="ds_user" Left="299" Style="sty_ipt_search" TabOrder="28" Top="53" Width="101"></Combo>
		<Static Align="Right" Height="20" Id="Static5" Left="504" Style="sty_lb_search" TabOrder="29" Text="견적구분&#32;" Top="54" VAlign="Middle" Width="60"></Static>
		<Combo Border="Flat" CodeColumn="CODE" Column="QTGBN" DataColumn="CODE_NAME" Height="20" Id="cb_qtgbn" InnerDataset="ds_qtgbn" Left="570" Style="sty_ipt_search" TabOrder="30" Top="53" Width="101"></Combo>
		<Static Align="Right" Height="20" Id="Static6" Left="699" Style="sty_lb_search" TabOrder="31" Text="견적번호&#32;" Top="54" VAlign="Middle" Width="64"></Static>
		<Edit Border="Flat" Height="21" Id="ed_qtnum" Left="770" Style="sty_ipt_search" TabOrder="32" Top="54" UpperOnly="TRUE" Width="102"></Edit>
	</Form>
	<Script><![CDATA[﻿﻿﻿﻿﻿﻿﻿﻿/*
 ******************************************************************************************
 * 기      능   : 
 * 작  성  자   : 
 * 작성  일자   : 
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
#include "LIB::commons.js";	// 공통 스크립트 
#include "LIB::utility.js";	// 다중 선택 
#include "LIB::nsfRequest.js";	// 공통 스크립트 
#include "LIB::common_hdel.js";	// 공통 스크립트  /* GNY 추가 */
//=========================================================================================
// [ PART 1 ]
// Form에서 사용될 전역변수를 선언
// FORM에서 사용되는 전역변수는 대문자로 작성하며, F_XXX 의 형태를 갖도록 한다. 

//진행상태 = 23	: 담당승인
//진행상태 = 24	: 담당반려
//진행상태 = 25	: 팀장승인
//진행상태 = 26 : 팀장반려

//=========================================================================================
var userGroup;
var FROW = 0;
var F_FRM_TITLE = "견적승인판정";	// 공통코드 화면명
//=========================================================================================
// [ PART 2 ]
// Form Loading / Unloading 시 작업 정의
//=========================================================================================
function fn_OnLoadCompleted(obj) 
{
	gfn_initForm(true);
	//div_btn.fn_loadUseBtn("1", F_FRM_TITLE, "", "");

	userGroup = right(G_USER_GROUP_B, 2 );

	var codeArr  = ["SD107", "BS112", "BS102",  "SD102", "SD102", "SPART"];
	var dsObjArr = [ds_pst,  ds_ncd,  ds_sukum, ds_jrt,  ds_jrt2, ds_gbn];
	var addTypeArr = [G_CODE_ALL,G_CODE_NONE,G_CODE_NONE,G_CODE_NONE,G_CODE_ALL,G_CODE_ALL,G_CODE_ALL];
	gfn_searchCommCode(codeArr, dsObjArr, addTypeArr);

	cal_fcdt.Value = left(gfn_getCurrDate(),6)+"01";
	cal_tcdt.Value = gfn_getCurrDate();

	cb_ord1.index = 0;
	cb_ord2.Index = 0;

    //지역 대리점 담당자 콤보 리스트 		
	tit_clearActionInfo();
	tit_addSearchActionInfo("bs01:BS0102007A_S1");
	tit_addSearchActionInfo("bs01:BS0102007A_S3");
	tit_addSearchActionInfo("bs01:BS0102007A_S4");

	tit_callService(
        ""
        , ""
        , "ds_cond=ds_cond"
        , "ds_gno=ds_gno ds_user=ds_user ds_ara=ds_ara"
        , ""
        , "fn_afterGno"
        , true
        , true);
	
	div_lifnr.ed_name1.Visible = true;	// 협력업체명 보이도록 수정

	// 팀 콤보 설정
	div_vbvg.cb_frvg.left = -1;
	/*ds_vkgrp.ClearData();
	ds_vkgrp.AddRow();
	ds_vkgrp.SetColumn(0, "CODE"     , "B400");
	ds_vkgrp.SetColumn(0, "CODE_NAME", "영업3부");
	
	nsfRequest("queryArea"
				, "combo/comboFrVg"
				, "ds_frvg_cd=ds_vkgrp"
				, "ds_vkgrp=ds_frvg_cd ds_error=ds_error"
				, ""
				, "fn_afterQuery"
	);
	*/
}
/********************************************************************************
* 기      능   : 조회 Callback  
********************************************************************************/
function fn_afterGno(errCode, errMsg) 
{
	gfn_insertEmptyRow( ds_ara, G_CODE_ALL );
	cb_ara.value = "";
	gfn_insertEmptyRow( ds_gno, G_CODE_ALL );
	cb_gno.value = "";
	gfn_insertEmptyRow( ds_user, G_CODE_ALL );
	cb_user.value = ""; 

	if(userGroup == "20") {
		ds_ara.Filter("CODE=="+quote(G_DPT1));
		cb_ara.Index = 0;
		cb_ara.Enable = false;

		cb_ara_OnChanged(ds_ara,cb_ara.Value,"","","");
	}

}
/********************************************************************************
* 기      능   : 공통코드가 조회된 후의 Callback 함수 
********************************************************************************/
function fn_completeInit(sCode, sDsObj, sCodeType) 
{
	cb_pst.value = "";
	cb_jrt.value = "";
	cb_qtgbn.value = ""; //견적상태

	if     (G_DPT1 == 'B2')	cb_gbn.Index = 1;
	else if(G_DPT1 == 'B9')	cb_gbn.Index = 2;
	else if(G_DPT1 == 'B8')	cb_gbn.Index = 3;
	else if(G_DPT1 == 'C6')	cb_gbn.Index = 4;
	else					cb_gbn.Index = 0;

	cb_gbn.Index  = 0;

	ds_pst.Filter("CODE =="+quote("")+" || CODE =="+quote("21")+" || CODE =="+quote("23"));
}
/********************************************************************************
* 기      능   : form UnloadCompleted 
********************************************************************************/
function fn_OnUnloadCompleted(obj) 
{
	return gfn_isFormUnload(obj);
}

//=========================================================================================
// [ PART 3 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,form닫기)
//=========================================================================================
/********************************************************************************
* 기      능   : 조회 
********************************************************************************/
var fn_query_chk = false; //중복조회 방지용 flag

function fn_query() 
{
	// 필수 조건 지정 (요청기간)
	if (length(trim(cal_fcdt.Value)) == 0)
	{
		gfn_showAlert("CW00208","요청기간");
		gfn_SetFocus(cal_fcdt, "");
		return false;
	}

	if (length(trim(cal_tcdt.Value)) == 0)
	{
		gfn_showAlert("CW00208","요청기간");
		gfn_SetFocus(cal_tcdt, "");
		return false;
	}
    
    if ( SUBSTR(G_SAP_USER_ID,0,1) = "A" ) {
	   gfn_showAlert("CW10025", "권한이 없습니다");
	   return;
	}
	
	var arr = ['요청기간', '12'];
	if(gfn_getDayCnt(ds_days, cal_fcdt.Value, cal_tcdt.Value) > 365) {
		gfn_showAlert("CW10087", arr); //요청기간은 12개월 내에서 조회할 수 있습니다. \n확인하시기 바랍니다.
		cal_fcdt.SetFocus();
		return false;
	}
	
	if(!fn_query_chk) {
		fn_query_chk = true;
	} else {
		gfn_showAlert("CW10025", "조회중입니다..");
		return;
	}
	
	fn_createWait("",this);     // 처리중입니다. 메시지 처리

	ds_error.ClearData();

    ds_cond.DeleteAll();	
	ds_cond.AddRow();
		
	ds_cond.SetColumn(0, "FCDT" , cal_fcdt.Value);
	ds_cond.SetColumn(0, "TCDT" , cal_tcdt.Value);
	ds_cond.SetColumn(0, "VKGRP", div_vbvg.cb_frvg.Value);
	ds_cond.setColumn(0, "PST"  , cb_pst.Value  );
	ds_cond.SetColumn(0, "GBN"  , cb_gbn.Value  );
	ds_cond.SetColumn(0, "ORD1" , cb_ord1.Value );
	ds_cond.SetColumn(0, "ORD2" , cb_ord2.Value );
	ds_cond.SetColumn(0, "JRT"  , cb_jrt.Value  );
	ds_cond.SetColumn(0, "ZAGNT", div_lifnr.ed_lifnr.Text);
	ds_cond.SetColumn(0, "ARA"  , cb_ara.Value  );
	ds_cond.SetColumn(0, "GNO"  , cb_gno.Value  );
	ds_cond.SetColumn(0, "USER"  , cb_user.Value  );
	ds_cond.SetColumn(0, "QTGBN" , cb_qtgbn.Value  );	
	ds_cond.SetColumn(0, "QTNUM" , ed_qtnum.Value  );	
	
	nsfRequest("query"
			 , "ses0081/query"
			 , "ds_cond=ds_cond ds_list=ds_list"
			 , "ds_list=ds_list ds_error=ds_error"
			 , ""
			 , "fn_afterQuery");
}
/********************************************************************************
* 기      능   : 조회 Callback  
********************************************************************************/
function fn_afterQuery(svcId, errCode, errMsg) {

	//trace(ds_list.savexml());
	
	fn_query_chk = false; //중복조회 방지용 flag
	fn_destroyWait();

	if (ds_error.rowcount() > 0) {
		gfn_showMsg("CE00001");
		//gfn_openWSErrorWin(grd_list, ds_list, ds_error, "FLAG");	// error 정보 표시 
	}else	{
	    for(var i = 0; i < ds_list.RowCount(); i++) 
	    {   
	      if ( ds_list.GetColumn(i, "ZRTRSN") == "10" ) {
			ds_list.SetColumn(i, "ZRTRSN", "기 거래선");
	      } else if ( ds_list.GetColumn(i, "ZRTRSN") == "20" ) {
			ds_list.SetColumn(i, "ZRTRSN", "기 견적승인");
	      } else if ( ds_list.GetColumn(i, "ZRTRSN") == "22" ) {
			ds_list.SetColumn(i, "ZRTRSN", "주소불명확");
	      } else if ( ds_list.GetColumn(i, "ZRTRSN") == "24" ) {
			ds_list.SetColumn(i, "ZRTRSN", "발주처불명확");
	      } else if ( ds_list.GetColumn(i, "ZRTRSN") == "26" ) {
			ds_list.SetColumn(i, "ZRTRSN", "시행사불명확");
	      } else if ( ds_list.GetColumn(i, "ZRTRSN") == "30" ) {
			ds_list.SetColumn(i, "ZRTRSN", "수금조건");
	      } else if ( ds_list.GetColumn(i, "ZRTRSN") == "40" ) {
			ds_list.SetColumn(i, "ZRTRSN", "납기문제");
	      } else if ( ds_list.GetColumn(i, "ZRTRSN") == "90" ) {
			ds_list.SetColumn(i, "ZRTRSN", "기타");
	      } 
	    }
		gfn_showMsg("CI00002", ds_list.RowCount() + "");
		ds_list.row = FROW;		
	}
	
	if ( svcId == "queryArea" ) {
		gfn_insertEmptyRow(ds_vkgrp, G_CODE_ALL);
		cb_vkgrp.Index = 0;
	}
}

function fn_afterDel(errCode, errMsg) {
	if(errCode != 0) {
		gfn_showMsg("CE00001");
	} else {
		gfn_showMsg("CI00003");
		fn_query();
	}
}

/********************************************************************************
* 기      능   : 닫기  
********************************************************************************/
function fn_close() {
	close();
}

//=========================================================================================
// [ PART 4]
// Callback 함수 정의 : callback 함수명은 메인 함수의 fn_xxxx() 에서 xxxx 부분은 fn_afterXXXX()
// 형태가 되도록 작성 
//=========================================================================================

/********************************************************************************
* 기      능   : 액셀  
********************************************************************************/
function fn_excel() {

	if ( ds_list.RowCount() > 0 ){
		gfn_exportExcel(grd_list, "견적승인판정");
		//gfn_saveToExcel(grd_list, true );
	}else{
		gfn_showAlert("CW00010");
		return false;
	}			
}

/********************************************************************************
* 기      능   : 검증버튼 클릭시 팝업연동
********************************************************************************/
function grd_list_OnCellClick(obj,nRow,nCell,nX,nY,nPivotIndex) { 
    trace(nCell);
	//if(nCell == 23)	{
	if(nCell == 24)	{
		ds_list.row = nRow;
		var arg = "qtnum="   + quote(ds_list.GetColumn(nRow,"QTNUM")) +
			  " qtser="      + quote(ds_list.GetColumn(nRow,"QTSER")) +
			  " zaddr_adr1=" + quote(ds_list.GetColumn(nRow,"ZADDR_ADR1")) +
			  " zdev=" + quote(ds_list.GetColumn(nRow,"ZDEV")) + 
			  " zgnm=" + quote(ds_list.GetColumn(nRow,"ZGNM")) + 
			  " gsnam=" + quote(ds_list.GetColumn(nRow,"GSNAM")) + 
			  " ztel=" + quote(ds_list.GetColumn(nRow,"ZTEL"));
		var arr = gfn_openPopupUrl("SES::Ses0082.xml", true, arg);
		FROW = ds_list.row;
	}
	
	//2021.03 jss : 첨부파일
	if(nCell == 15 && ds_list.GetColumn(nRow,"FILECNT") > 0)	{
		var url = "Ses::Ses0088.xml";
		var arg =  " fa_qtnum = " + quote(ds_list.GetColumn(nRow,"QTNUM"));
			arg += " fa_qtser = " + quote(ds_list.GetColumn(nRow,"QTSER"));
		gfn_openPopUpUrlHdel(url, true, arg);	
	}
	
}

function fn_enableYn() {

	if(userGroup == "40") return "checkbox";
	else 				  return "none";
}

// 견적상세 호출되도록 (견적번호 더블 클릭 시 : 대리점용 견적상세 호출)
// 2013.01.07
function grd_list_OnCellDblClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
	if (ds_list.GetRowCount() > 0)	{
		if(nCell == 1)	{	// 견적번호 클릭 시
			var arg  = "fa_qtnum="  + quote(ds_list.GetColumn(ds_list.currow, "QTNUM"));
				arg += " fa_qtser=" + quote(ds_list.GetColumn(ds_list.currow, "QTSER"));
				arg += " fa_view="  + quote("view");

			//gfn_openPopUpUrlHdel("Ses::Ses0051.xml", true, arg);
			//gfn_openPopUpUrlHdel("Ses::Ses0031.xml", true, arg);  //31 화면으로 수정 20160418 대리점팀
			
			var vkbur = ds_list.GetColumn(ds_list.currow, "VKBUR");
			//2021.04 jss
			if (vkbur=="C600" || vkbur=="C700" || vkbur=="C800" || vkbur=="C900" ) gfn_openPopUpUrlHdel("Ses::Ses0031S.xml", true, arg);
			else gfn_openPopUpUrlHdel("Ses::Ses0031.xml", true, arg);
			
		}
	}
}

/********************************************************************************
* 기      능   : 지역콤보 변경시
********************************************************************************/
function cb_ara_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	if(length(trim(strCode)) == 0) 
	{
		ds_gno.Filter("LENGTH(ARA) == 0 || 1==1");
		ds_user.Filter("LENGTH(LIFNR) == 0 || 1==1");
		cb_gno.Index = 0;
		cb_user.Index = 0;
	}	
	else 
	{
		ds_gno.Filter("LENGTH(ARA) == 0 || ARA == "+quote(strCode));
		ds_user.Filter("LENGTH(LIFNR) == 0 || ARA == "+quote(strCode));
		cb_gno.Index = 0;
		cb_user.Index = 0;
	}	
}

function cb_gno_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	if(length(trim(strCode)) == 0) 
	{
		if(length(trim(cb_ara.Value)) > 0)
			ds_user.Filter("LENGTH(LIFNR) == 0 || ARA == "+quote(cb_ara.Value));
		else
			ds_user.Filter("LENGTH(LIFNR) == 0 || 1==1");
		
		cb_user.Index = 0;
	}	
	else 
	{
		ds_user.Filter("LENGTH(LIFNR) == 0 || LIFNR == "+quote(strCode));
		cb_user.Index = 0;
	}
}
]]></Script>
</Window>