<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="562" Id="Ses0180" Left="8" OnLoadCompleted="fn_OnLoadCompleted" OnUnloadCompleted="Ses0180_OnUnloadCompleted" PidAttrib="7" Title="입찰결과등록" Top="8" Ver="1.0" Width="978" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_frvb_cd">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_frvg_cd">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_tovb_cd">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_tovg_cd">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_zprgflg">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_spart_cd">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_zfrsn">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_bdcm">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
					<colinfo id="FILTER1" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond">
				<Contents>
					<colinfo id="QTDAT_FR" size="256" summ="default" type="STRING"/>
					<colinfo id="QTDAT_TO" size="256" summ="default" type="STRING"/>
					<colinfo id="ZESTDAT_FR" size="256" summ="default" type="STRING"/>
					<colinfo id="ZESTDAT_TO" size="256" summ="default" type="STRING"/>
					<colinfo id="VKBUR" size="256" summ="default" type="STRING"/>
					<colinfo id="VKGRP" size="256" summ="default" type="STRING"/>
					<colinfo id="ZPRGFLG" size="256" summ="default" type="STRING"/>
					<colinfo id="ZKUNNR" size="256" summ="default" type="STRING"/>
					<colinfo id="ZPSTAT" size="256" summ="default" type="STRING"/>
					<colinfo id="BDDAT_FR" size="256" summ="default" type="STRING"/>
					<colinfo id="BDDAT_TO" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list" OnColumnChanged="ds_list_OnColumnChanged">
				<Contents>
					<colinfo id="MANDT" size="256" summ="default" type="STRING"/>
					<colinfo id="QTNUM" size="256" summ="default" type="STRING"/>
					<colinfo id="QTSER" size="256" summ="default" type="INT"/>
					<colinfo id="VKBUR" size="256" summ="default" type="STRING"/>
					<colinfo id="VKGRP" size="256" summ="default" type="STRING"/>
					<colinfo id="ZKUNNR" size="256" summ="default" type="STRING"/>
					<colinfo id="GSNAM" size="256" summ="default" type="STRING"/>
					<colinfo id="KUNNR" size="256" summ="default" type="STRING"/>
					<colinfo id="QTDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="ZESTDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="BDDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="CTDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="SBDCM" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="SBDAM" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="ZCOST" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="PBDAM" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="SHANG" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="ZSEC" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSECAM" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="ZFOREC" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="ZPRGFLG" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSFLG" size="256" summ="default" type="STRING"/>
					<colinfo id="ZFRSN" size="256" summ="default" type="STRING"/>
					<colinfo id="ZRMK" size="256" summ="default" type="STRING"/>
					<colinfo id="CDATE" size="256" summ="default" type="STRING"/>
					<colinfo id="CTIME" size="256" summ="default" type="STRING"/>
					<colinfo id="CUSER" size="256" summ="default" type="STRING"/>
					<colinfo id="UDATE" size="256" summ="default" type="STRING"/>
					<colinfo id="UTIME" size="256" summ="default" type="STRING"/>
					<colinfo id="UUSER" size="256" summ="default" type="STRING"/>
					<colinfo id="BDSEQ" size="256" summ="default" type="INT"/>
					<colinfo id="SONNR" size="256" summ="default" type="STRING"/>
					<colinfo id="ZKUNNR_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="KUNNR_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSOFLG" size="256" summ="default" type="STRING"/>
					<colinfo id="VBELN" size="256" summ="default" type="STRING"/>
					<colinfo id="SORLT" size="256" summ="default" type="STRING"/>
					<colinfo id="ZPRGFLG_1046" size="256" summ="default" type="STRING"/>
					<colinfo id="SPART" size="256" summ="default" type="STRING"/>
					<colinfo id="ZGNM" size="256" summ="default" type="STRING"/>
					<colinfo id="ZDEV" size="256" summ="default" type="STRING"/>
					<colinfo id="QTGBN" size="256" summ="default" type="STRING"/>
					<colinfo id="AUART" size="256" summ="default" type="STRING"/>
					<colinfo id="SBDERATE" size="256" summ="default" type="STRING"/>
					<colinfo id="BDRSLTDT" size="256" summ="default" type="STRING"/>
					<colinfo id="BDCM2" size="256" summ="default" type="STRING"/>
					<colinfo id="BDCM2_T" size="256" summ="default" type="STRING"/>
					<colinfo id="BDAMT2" size="256" summ="default" type="STRING"/>
					<colinfo id="BDERATE2" size="256" summ="default" type="STRING"/>
					<colinfo id="BDCM3" size="256" summ="default" type="STRING"/>
					<colinfo id="BDCM3_T" size="256" summ="default" type="STRING"/>
					<colinfo id="BDAMT3" size="256" summ="default" type="STRING"/>
					<colinfo id="BDERATE3" size="256" summ="default" type="STRING"/>
					<colinfo id="ZFRSN_T" size="256" summ="default" type="STRING"/>
					<colinfo id="ZRMKLIST" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSUM_ZNUMBER" size="256" summ="default" type="STRING"/>
					<colinfo id="ZADDR_ADR1" size="256" summ="default" type="STRING"/>
					<colinfo id="ZAPDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="ZFRSN_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="ZDELI" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_detail">
				<Contents>
					<colinfo id="MANDT" size="256" summ="default" type="STRING"/>
					<colinfo id="QTNUM" size="256" summ="default" type="STRING"/>
					<colinfo id="QTSER" size="256" summ="default" type="INT"/>
					<colinfo id="BDSEQ" size="256" summ="default" type="INT"/>
					<colinfo id="BDDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="CTDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="SBDCM" size="256" summ="default" type="STRING"/>
					<colinfo id="SBDAM" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="ZCOST" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="PBDAM" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="ZFRSN" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSEC" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSECAM" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="ZFOREC" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="ZPRGFLG" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSFLG" size="256" summ="default" type="STRING"/>
					<colinfo id="ZRMK" size="256" summ="default" type="STRING"/>
					<colinfo id="SONNR" size="256" summ="default" type="STRING"/>
					<colinfo id="SHANG" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="CDATE" size="256" summ="default" type="STRING"/>
					<colinfo id="CTIME" size="256" summ="default" type="STRING"/>
					<colinfo id="CUSER" size="256" summ="default" type="STRING"/>
					<colinfo id="UDATE" size="256" summ="default" type="STRING"/>
					<colinfo id="UTIME" size="256" summ="default" type="STRING"/>
					<colinfo id="UUSER" size="256" summ="default" type="STRING"/>
					<colinfo id="ZKUNNR" size="256" summ="default" type="STRING"/>
					<colinfo id="SBDERATE" size="256" summ="default" type="STRING"/>
					<colinfo id="BDRSLTDT" size="256" summ="default" type="STRING"/>
					<colinfo id="BDCM2" size="256" summ="default" type="STRING"/>
					<colinfo id="BDCM2_T" size="256" summ="default" type="STRING"/>
					<colinfo id="BDAMT2" size="256" summ="default" type="STRING"/>
					<colinfo id="BDERATE2" size="256" summ="default" type="STRING"/>
					<colinfo id="BDCM3" size="256" summ="default" type="STRING"/>
					<colinfo id="BDCM3_T" size="256" summ="default" type="STRING"/>
					<colinfo id="BDAMT3" size="256" summ="default" type="STRING"/>
					<colinfo id="BDERATE3" size="256" summ="default" type="STRING"/>
					<colinfo id="ZFRSN_T" size="256" summ="default" type="STRING"/>
					<colinfo id="ZRMKLIST" size="256" summ="default" type="STRING"/>
					<colinfo id="AUART" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_error">
				<Contents>
					<colinfo id="IDX" size="256" type="STRING"/>
					<colinfo id="ERRMSG" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_days">
				<Contents>
					<colinfo id="DAYS" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_zrmklist">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_sbdcm">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
					<colinfo id="FILTER1" size="256" type="STRING"/>
				</Contents>
			</Dataset>
		</Datasets>
		<Div BKColor="user0" Height="53" Id="div_sestop" OnLoadCompleted="fn_OnLoadCompleted" OnTimer="WB0199010A_OnTimer" TabOrder="1" Text="Div0" Url="COM::Coms010.xml" Width="978">
			<Contents></Contents>
		</Div>
		<Grid AutoEnter="TRUE" AutoFitEndLine="Hide" BindDataset="ds_list" BkColor2="default" BoldHead="true" Border="Flat" Bottom="408" ColSizing="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="328" Id="grd_list" InputPanel="FALSE" Left="8" LineColor="user20" LineType="ExHORZ" OnCellClick="grd_list_OnCellClick" OnHeadClick="grd_list_OnHeadClick" Right="968" RowHeight="20" Style="sty_grid" TabOrder="20" TabStop="true" Top="80" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="960">
			<contents>
				<format id="Default">
					<columns>
						<col fix="left" width="60"/>
						<col fix="left" width="0"/>
						<col fix="left" width="0"/>
						<col fix="left" width="80"/>
						<col fix="left" width="80"/>
						<col width="90"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="90"/>
						<col width="80"/>
						<col width="70"/>
						<col width="200"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="0"/>
						<col width="90"/>
						<col width="90"/>
						<col width="80"/>
						<col width="0"/>
						<col width="0"/>
						<col width="0"/>
						<col width="0"/>
						<col width="0"/>
						<col width="0"/>
						<col width="0"/>
						<col width="0"/>
						<col width="0"/>
						<col width="0"/>
						<col width="80"/>
					</columns>
					<head>
						<cell bkimageid="icon_window_03" col="0" display="text"/>
						<cell align="center" col="1" color="user21" display="text" font="굴림,9" text="변경"/>
						<cell align="center" col="2" display="text" font="굴림,9" text="클라이언트"/>
						<cell align="center" col="3" display="text" font="굴림,9" text="견적번호"/>
						<cell align="center" col="4" display="text" font="굴림,9" text="견적차수"/>
						<cell align="center" col="5" display="text" font="굴림,9" text="프로젝트번호"/>
						<cell align="center" col="6" display="text" font="굴림,9" text="부서"/>
						<cell align="center" col="7" display="text" font="굴림,9" text="팀"/>
						<cell align="center" col="8" display="text" font="굴림,9" text="담당자명"/>
						<cell align="center" col="9" display="text" font="굴림,9" text="시행사"/>
						<cell align="center" col="10" display="text" font="굴림,9" text="발주처"/>
						<cell align="center" col="11" display="text" font="굴림,9" text="현장명"/>
						<cell align="center" col="12" display="text" font="굴림,9" text="고객명"/>
						<cell align="center" col="13" display="text" font="굴림,9" text="대수"/>
						<cell align="center" col="14" display="text" font="굴림,9" text="주소"/>
						<cell align="center" col="15" display="text" font="굴림,9" text="견적일"/>
						<cell align="center" col="16" display="text" font="굴림,9" text="견적승인일"/>
						<cell align="center" col="17" display="text" font="굴림,9" text="입찰예정일"/>
						<cell align="center" col="18" display="text" font="굴림,9" text="입찰일"/>
						<cell align="center" col="19" display="text" font="굴림,9" text="계약일"/>
						<cell align="center" col="20" display="text" font="굴림,9" text="낙찰사"/>
						<cell align="center" col="21" display="text" font="굴림,9" text="낙찰가"/>
						<cell align="center" col="22" display="text" font="굴림,9" text="낙찰시행율"/>
						<cell align="center" col="23" display="text" font="굴림,9" text="원가"/>
						<cell align="center" col="24" display="text" font="굴림,9" text="당사&#32;투찰가"/>
						<cell align="center" col="25" display="text" font="굴림,9" text="당사&#32;시행율"/>
						<cell align="center" col="26" display="text" font="굴림,9" text="타사"/>
						<cell align="center" col="27" display="text" font="굴림,9" text="타사&#32;투찰가"/>
						<cell align="center" col="28" display="text" font="굴림,9" text="타사시행율"/>
						<cell align="center" col="29" display="text" font="굴림,9" text="2위"/>
						<cell align="center" col="30" display="text" font="굴림,9" text="2위(기타)"/>
						<cell align="center" col="31" display="text" font="굴림,9" text="2위&#32;금액"/>
						<cell align="center" col="32" display="text" font="굴림,9" text="2위&#32;시행율"/>
						<cell align="center" col="33" display="text" font="굴림,9" text="3위"/>
						<cell align="center" col="34" display="text" font="굴림,9" text="3위(기타)"/>
						<cell align="center" col="35" display="text" font="굴림,9" text="3위&#32;금액"/>
						<cell align="center" col="36" display="text" font="굴림,9" text="3위&#32;시행율"/>
						<cell align="center" col="37" display="text" font="굴림,9" text="입찰결과"/>
						<cell align="center" col="38" display="text" font="굴림,9" text="성공여부"/>
						<cell align="center" col="39" display="text" font="굴림,9" text="성공실패사유(구)"/>
						<cell align="center" col="40" display="text" font="굴림,9" text="성공실패사유"/>
						<cell align="center" col="41" display="text" font="굴림,9" text="기타사양내용"/>
						<cell align="center" col="42" display="text" font="굴림,9" text="비고"/>
						<cell align="center" col="43" display="text" font="굴림,9" text="입력일"/>
						<cell align="center" col="44" display="text" font="굴림,9" text="입력시간"/>
						<cell align="center" col="45" display="text" font="굴림,9" text="입력자"/>
						<cell align="center" col="46" display="text" font="굴림,9" text="변경일"/>
						<cell align="center" col="47" display="text" font="굴림,9" text="변경시간"/>
						<cell align="center" col="48" display="text" font="굴림,9" text="변경자"/>
						<cell align="center" col="49" display="text" font="굴림,9" text="담당자코드"/>
						<cell align="center" col="50" display="text" font="굴림,9" text="고객코드"/>
						<cell align="center" col="51" display="text" font="굴림,9" text="입찰일련번호"/>
						<cell align="center" col="52" display="text" font="굴림,9" text="수주계획번호"/>
						<cell align="center" col="53" display="text" font="굴림,9" text="단납기구분"/>
					</head>
					<body>
						<cell align="center" bkcolor2="user22" col="0" display="text" expr="currow+1"/>
						<cell align="center" bkcolor2="user22" bkimageid='expr:gfn_getFlagBkImageID(getColumn(currow,&#32;&quot;FLAG&quot;))' col="1" colid="FLAG" display="image"/>
						<cell align="center" bkcolor2="user22" col="2" colid="MANDT" display="text"/>
						<cell align="center" bkcolor2="user22" col="3" colid="QTNUM" display="text"/>
						<cell align="center" bkcolor2="user22" col="4" colid="QTSER" display="text"/>
						<cell align="center" bkcolor2="user22" col="5" colid="VBELN" display="text"/>
						<cell align="center" bkcolor2="user22" col="6" colid="VKBUR" combocol="CODE" combodataset="ds_frvb_cd" combotext="CODE_NAME" display="combo"/>
						<cell align="center" bkcolor2="user22" col="7" colid="VKGRP" combocol="CODE" combodataset="ds_frvg_cd" combotext="CODE_NAME" display="combo"/>
						<cell align="center" bkcolor2="user22" col="8" colid="ZKUNNR_NM" display="text"/>
						<cell align="center" bkcolor2="user22" col="9" colid="ZGNM" display="text"/>
						<cell align="center" bkcolor2="user22" col="10" colid="ZDEV" display="text"/>
						<cell align="left" bkcolor2="user22" col="11" colid="GSNAM" display="text"/>
						<cell align="center" bkcolor2="user22" col="12" colid="KUNNR_NM" display="text"/>
						<cell align="center" bkcolor2="user22" col="13" colid="ZSUM_ZNUMBER" display="text"/>
						<cell align="left" bkcolor2="user22" col="14" colid="ZADDR_ADR1" display="text"/>
						<cell align="center" bkcolor2="user22" col="15" colid="QTDAT" display="date"/>
						<cell align="center" bkcolor2="user22" col="16" colid="ZAPDAT" display="date"/>
						<cell align="center" bkcolor2="user22" col="17" colid="ZESTDAT" display="date"/>
						<cell align="center" bkcolor2="user22" col="18" colid="BDDAT" display="date"/>
						<cell align="center" bkcolor2="user22" col="19" colid="CTDAT" display="date"/>
						<cell align="center" bkcolor2="user22" col="20" colid="SBDCM" combocol="CODE" combodataset="ds_sbdcm" combotext="CODE_NAME" display="combo"/>
						<cell align="right" bkcolor2="user22" col="21" colid="SBDAM" display="number"/>
						<cell align="right" bkcolor2="user22" col="22" colid="SBDERATE" display="number"/>
						<cell align="right" bkcolor2="user22" col="23" colid="ZCOST" display="number"/>
						<cell align="right" bkcolor2="user22" col="24" colid="PBDAM" display="number"/>
						<cell align="right" bkcolor2="user22" col="25" colid="SHANG" display="number"/>
						<cell align="center" bkcolor2="user22" col="26" colid="ZSEC" combocol="CODE" combodataset="ds_sbdcm" combotext="CODE_NAME" display="combo"/>
						<cell align="right" bkcolor2="user22" col="27" colid="ZSECAM" display="number"/>
						<cell align="right" bkcolor2="user22" col="28" colid="ZFOREC" display="number"/>
						<cell align="center" bkcolor2="user22" col="29" colid="BDCM2" combocol="CODE" combodataset="ds_bdcm" combotext="CODE_NAME" display="combo"/>
						<cell align="center" bkcolor2="user22" col="30" colid="BDCM2_T" combodisplayrowcnt="0" display="combo"/>
						<cell align="right" bkcolor2="user22" col="31" colid="BDAMT2" display="number"/>
						<cell align="right" bkcolor2="user22" col="32" colid="BDERATE2" display="number"/>
						<cell align="center" bkcolor2="user22" col="33" colid="BDCM3" combocol="CODE" combodataset="ds_bdcm" combotext="CODE_NAME" display="combo"/>
						<cell align="center" bkcolor2="user22" col="34" colid="BDCM3_T" combodisplayrowcnt="0" display="combo"/>
						<cell align="right" bkcolor2="user22" col="35" colid="BDAMT3" display="number"/>
						<cell align="right" bkcolor2="user22" col="36" colid="BDERATE3" display="number"/>
						<cell align="center" bkcolor2="user22" col="37" colid="ZPRGFLG" combocol="CODE" combodataset="ds_zprgflg" combotext="CODE_NAME" display="combo"/>
						<cell align="center" bkcolor2="user22" col="38" colid="ZSFLG" display="checkbox" expr="decode(ZSFLG,&apos;X&apos;,1,&apos;1&apos;,1,ZSFLG)"/>
						<cell align="center" bkcolor2="user22" col="39" colid="ZFRSN" combocol="CODE" combodataset="ds_zfrsn" combotext="CODE_NAME" display="combo"/>
						<cell align="center" bkcolor2="user22" col="40" colid="ZFRSN_NM" display="text"/>
						<cell align="center" bkcolor2="user22" col="41" colid="ZFRSN_T" display="text"/>
						<cell align="center" bkcolor2="user22" col="42" colid="ZRMK" display="text"/>
						<cell align="center" bkcolor2="user22" col="43" colid="CDATE" display="text"/>
						<cell align="center" bkcolor2="user22" col="44" colid="CTIME" display="text"/>
						<cell align="center" bkcolor2="user22" col="45" colid="CUSER" display="text"/>
						<cell align="center" bkcolor2="user22" col="46" colid="UDATE" display="text"/>
						<cell align="center" bkcolor2="user22" col="47" colid="UTIME" display="text"/>
						<cell align="center" bkcolor2="user22" col="48" colid="UUSER" display="text"/>
						<cell align="center" bkcolor2="user22" col="49" colid="ZKUNNR" display="text"/>
						<cell align="center" bkcolor2="user22" col="50" colid="KUNNR" display="text"/>
						<cell align="center" bkcolor2="user22" col="51" colid="BDSEQ" display="text"/>
						<cell align="center" bkcolor2="user22" col="52" colid="SONNR" display="text"/>
						<cell align="center" bkcolor2="user22" col="53" colid="ZDELI" display="text"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Checkbox Height="20" Id="chk_enter" Left="985" TabOrder="11" Visible="FALSE" Width="20"></Checkbox>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_sso0060" ImageID="btn_sub_06" Left="870" LeftMargin="12" OnClick="fn_OnClick_btn" Style="sty_btn" TabOrder="13" Text="수주생성" Top="56" Transparent="TRUE" Visible="FALSE" Width="96"></Button>
		<Div Border="Flat" BorderColor="user13" Height="128" Id="div_ses0180" Left="8" TabOrder="35" Text="Div0" Top="424" Width="960">
			<Contents>
				<Shape BKColor="user12" Bottom="128" Height="128" Id="Shape0" Left="0" LineColor="user13" Right="960" TabOrder="35" Top="0" Type="Rectangle" Width="960"></Shape>
				<Edit BindDataset="ds_list" Border="Flat" Height="20" Id="ed_bdseq" Left="88" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="8" Top="1" UpperOnly="TRUE" Visible="FALSE" Width="104"></Edit>
				<Combo Border="Flat" CodeColumn="CODE" DataColumn="CODE_NAME" Enable="FALSE" Height="20" Id="cb_sbdcm" InnerDataset="ds_sbdcm" Left="88" Style="sty_ipt_form_ind" TabOrder="30" Top="1" Width="104"></Combo>
				<Static Align="Right" Height="24" Id="Static0" Style="sty_lb_form_basic" TabOrder="20" Text="낙찰사&#32;" VAlign="Middle" Width="86"></Static>
				<Static Align="Right" Height="24" Id="Static1" Left="384" Style="sty_lb_form_basic" TabOrder="21" Text="입찰일&#32;" VAlign="Middle" Width="86"></Static>
				<Static Align="Right" Height="24" Id="Static2" Left="640" Style="sty_lb_form_basic" TabOrder="22" Text="계약일&#32;" VAlign="Middle" Width="86"></Static>
				<Static Align="Right" Height="24" Id="Static3" Style="sty_lb_form_basic" TabOrder="33" Text="입찰결과&#32;" Top="26" VAlign="Middle" Width="86"></Static>
				<Static Align="Right" Height="24" Id="Static4" Left="384" Style="sty_lb_form_basic" TabOrder="23" Text="낙찰가&#32;" Top="26" VAlign="Middle" Width="86"></Static>
				<Static Align="Right" Height="24" Id="Static5" Left="640" Style="sty_lb_form_basic" TabOrder="26" Text="타사&#32;" Top="26" VAlign="Middle" Width="86"></Static>
				<Static Align="Right" Height="24" Id="Static6" Style="sty_lb_form_basic" TabOrder="25" Text="당사&#32;투찰가&#32;" Top="52" VAlign="Middle" Width="86"></Static>
				<Static Align="Right" Height="24" Id="Static7" Left="384" Style="sty_lb_form_basic" TabOrder="27" Text="당사&#32;시행율&#32;" Top="52" VAlign="Middle" Width="86"></Static>
				<Static Align="Right" Height="24" Id="Static8" Left="640" Style="sty_lb_form_basic" TabOrder="28" Text="성공여부&#32;" Top="52" VAlign="Middle" Width="86"></Static>
				<Static Align="Right" Height="24" Id="Static9" Style="sty_lb_form_basic" TabOrder="27" Text="타사&#32;투찰가&#32;" Top="78" VAlign="Middle" Width="86"></Static>
				<Static Align="Right" Height="24" Id="Static10" Left="384" Style="sty_lb_form_basic" TabOrder="27" Text="타사&#32;시행율&#32;" Top="78" VAlign="Middle" Width="86"></Static>
				<Static Align="Right" Height="24" Id="Static11" Left="640" Style="sty_lb_form_basic" TabOrder="28" Text="실패사유&#32;" Top="78" VAlign="Middle" Width="86"></Static>
				<Static Align="Right" Height="24" Id="Static12" Style="sty_lb_form_basic" TabOrder="32" Text="비고&#32;" Top="104" VAlign="Middle" Width="86"></Static>
				<Calendar BindDataset="ds_list" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Enable="FALSE" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_bddat" Left="472" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form_ind" SundayTextColor="user35" TabOrder="1" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="1" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="104"></Calendar>
				<Calendar BindDataset="ds_list" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Enable="FALSE" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_ctdat" Left="728" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="2" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="1" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="104"></Calendar>
				<Combo Border="Flat" CodeColumn="CODE" DataColumn="CODE_NAME" Enable="FALSE" Height="20" Id="cb_zprgflg" InnerDataset="ds_zprgflg" Left="88" OnChanged="cb_zprgflg_OnChanged" Style="sty_ipt_form_ind" TabOrder="3" Top="27" Width="104"></Combo>
				<MaskEdit BindDataset="ds_list" Border="Flat" Enable="FALSE" Height="20" Id="ed_sbdam" Left="472" LeftMargin="4" Mask="#,###" RightMargin="4" Style="sty_ipt_form" TabOrder="10" TabStop="FALSE" Top="27" Width="104"></MaskEdit>
				<Edit BindDataset="ds_list" Border="Flat" Enable="FALSE" Height="20" Id="ed_zsec" Left="728" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="4" Top="27" UpperOnly="TRUE" Width="104"></Edit>
				<Button Appearance="FLAT" Cursor="HAND" Enable="FALSE" Height="18" Id="btn_zsec" ImageID="btn_icon_search" Left="835" OnClick="fn_OnClick_btn" TabOrder="12" TabStop="FALSE" Text="Button0" Top="28" Transparent="TRUE" Width="18"></Button>
				<MaskEdit BindDataset="ds_list" Border="Flat" Enable="FALSE" Height="20" Id="ed_pbdam" Left="88" LeftMargin="4" Mask="#,###" RightMargin="4" Style="sty_ipt_form" TabOrder="9" TabStop="FALSE" Top="53" Width="104"></MaskEdit>
				<MaskEdit BindDataset="ds_list" Border="Flat" Enable="FALSE" Height="20" Id="ed_shang" Left="472" LeftMargin="4" Mask="#,###.0" RightMargin="4" Style="sty_ipt_form" TabOrder="13" TabStop="FALSE" Top="53" Width="104"></MaskEdit>
				<Checkbox Column="ZSFLG" Enable="FALSE" FalseValue="&#32;" Height="20" Id="chk_zsflg" Left="726" TabOrder="14" TabStop="FALSE" Top="54" TrueValue="X" Value="FALSE" Width="16"></Checkbox>
				<MaskEdit BindDataset="ds_list" Border="Flat" Enable="FALSE" Height="20" Id="ed_zsecam" Left="88" LeftMargin="4" OnChar="div_ses0180_ed_zsecam_OnChar" RightMargin="4" Style="sty_ipt_form" TabOrder="5" Top="78" Width="104"></MaskEdit>
				<MaskEdit BindDataset="ds_list" Border="Flat" Enable="FALSE" Height="20" Id="ed_zforec" Left="472" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="13" TabStop="FALSE" Top="78" Width="104"></MaskEdit>
				<Combo Border="Flat" CodeColumn="CODE" DataColumn="CODE_NAME" Enable="FALSE" Height="20" Id="cb_zfrsn" InnerDataset="ds_zfrsn" Left="728" Style="sty_ipt_form_ind" TabOrder="6" Top="78" Width="104"></Combo>
				<Edit BindDataset="ds_list" Border="Flat" Enable="FALSE" Height="20" Id="ed_zrmk" Left="86" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="7" Top="102" UpperOnly="TRUE" Width="744"></Edit>
				<Div BKColor="user0" Height="22" Id="div_sman" Left="196" TabOrder="29" Text="Div0" Top="27" Url="COM::Coms002.xml" Visible="FALSE" Width="184">
					<Contents></Contents>
				</Div>
			</Contents>
		</Div>
		<Div Border="Flat" BorderColor="user13" Height="128" Id="div_ses0180_ni" Left="8" TabOrder="6" Text="Div0" Top="424" Width="960">
			<Contents>
				<Edit BindDataset="ds_list" Border="Flat" Height="20" Id="ed_bdseq" Left="80" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="4" Top="1" UpperOnly="TRUE" Visible="FALSE" Width="104"></Edit>
				<Combo Border="Flat" CodeColumn="CODE" DataColumn="CODE_NAME" Enable="FALSE" Height="20" Id="cb_sbdcm" InnerDataset="ds_sbdcm" Left="80" OnChanged="div_ses0180_ni_cb_sbdcm_OnChanged" Style="sty_ipt_form_ind" TabOrder="41" Top="1" Width="104"></Combo>
				<Shape BKColor="user12" Bottom="-8" Height="128" Id="Shape0" Left="0" LineColor="user13" Right="960" TabOrder="25" Top="-136" Type="Rectangle" Width="960"></Shape>
				<Div BKColor="user0" Height="22" Id="div_sman" Left="753" TabOrder="19" Text="Div0" Top="77" Url="COM::Coms002.xml" Visible="FALSE" Width="184">
					<Contents></Contents>
				</Div>
				<Static Align="Right" Height="24" Id="Static0" Style="sty_lb_form_basic" TabOrder="13" Text="낙찰사&#32;" VAlign="Middle" Width="78"></Static>
				<Static Align="Right" Height="24" Id="Static1" Left="232" Style="sty_lb_form_basic" TabOrder="14" Text="입찰일&#32;" VAlign="Middle" Width="78"></Static>
				<Static Align="Right" Height="24" Id="Static2" Left="752" Style="sty_lb_form_basic" TabOrder="15" Text="계약일&#32;" VAlign="Middle" Width="78"></Static>
				<Static Align="Right" Height="24" Id="Static3" Style="sty_lb_form_basic" TabOrder="22" Text="입찰결과&#32;" Top="26" VAlign="Middle" Width="78"></Static>
				<Static Align="Right" Height="24" Id="Static6" Style="sty_lb_form_basic" TabOrder="18" Text="당사&#32;투찰가&#32;" Top="52" VAlign="Middle" Width="78"></Static>
				<Static Align="Right" Height="24" Id="Static7" Left="232" Style="sty_lb_form_basic" TabOrder="18" Text="2위&#32;투찰가&#32;" Top="52" VAlign="Middle" Width="78"></Static>
				<Static Align="Right" Height="24" Id="Static9" Left="-2" Style="sty_lb_form_basic" TabOrder="18" Text="낙찰가&#32;" Top="78" VAlign="Middle" Width="78"></Static>
				<Static Align="Right" Height="24" Id="Static10" Left="232" Style="sty_lb_form_basic" TabOrder="18" Text="2위&#32;시행율&#32;" Top="78" VAlign="Middle" Width="78"></Static>
				<Static Align="Right" Height="24" Id="Static12" Left="568" Style="sty_lb_form_basic" TabOrder="22" Text="비고&#32;" Top="104" VAlign="Middle" Width="78"></Static>
				<Calendar BindDataset="ds_list" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Enable="FALSE" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_bddat" Left="312" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form_ind" SundayTextColor="user35" TabOrder="1" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="1" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="104"></Calendar>
				<Calendar BindDataset="ds_list" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Enable="FALSE" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_ctdat" Left="832" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="2" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="1" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="104"></Calendar>
				<Combo Border="Flat" CodeColumn="CODE" DataColumn="CODE_NAME" Enable="FALSE" Height="20" Id="cb_zprgflg" InnerDataset="ds_zprgflg" Left="80" OnChanged="cb_zprgflg_OnChanged" Style="sty_ipt_form_ind" TabOrder="3" Top="27" Width="104"></Combo>
				<MaskEdit BindDataset="ds_list" Border="Flat" Enable="FALSE" Height="20" Id="ed_sbdam" Left="80" LeftMargin="4" Mask="#,###" OnChanged="div_ses0180_ni_ed_sbdam_OnChanged" OnChar="div_ses0180_ni_bdamt_OnChar" RightMargin="4" Style="sty_ipt_form" TabOrder="6" TabStop="FALSE" Top="78" Width="104"></MaskEdit>
				<MaskEdit BindDataset="ds_list" Border="Flat" Enable="FALSE" Height="20" Id="ed_pbdam" Left="80" LeftMargin="4" Mask="#,###" RightMargin="4" Style="sty_ipt_form" TabOrder="5" TabStop="FALSE" Top="53" Width="104"></MaskEdit>
				<MaskEdit BindDataset="ds_list" Border="Flat" Enable="FALSE" Height="20" Id="ed_bderate2" Left="312" LeftMargin="4" Mask="#,###.0" RightMargin="4" Style="sty_ipt_form" TabOrder="7" TabStop="FALSE" Top="78" Width="104"></MaskEdit>
				<Static Align="Right" Height="24" Id="Static13" Left="-2" Style="sty_lb_form_basic" TabOrder="20" Text="낙찰&#32;시행율&#32;" Top="104" VAlign="Middle" Width="78"></Static>
				<MaskEdit BindDataset="ds_list" Border="Flat" Enable="FALSE" Height="20" Id="ed_sbderate" Left="80" LeftMargin="4" Mask="#,###.0" RightMargin="4" Style="sty_ipt_form" TabOrder="21" TabStop="FALSE" Top="102" Width="104"></MaskEdit>
				<Combo Border="Flat" CodeColumn="CODE" DataColumn="CODE_NAME" Enable="FALSE" Height="20" Id="cb_bdcm2" InnerDataset="ds_bdcm" Left="312" OnChanged="div_ses0180_ni_cb_bdcm_OnChanged" Style="sty_ipt_form_ind" TabOrder="22" Top="27" Width="104"></Combo>
				<Edit BindDataset="ds_list" Border="Flat" Enable="FALSE" Height="20" Id="ed_bdcm2_t" Left="416" LeftMargin="4" MaxLength="30" RightMargin="4" Style="sty_ipt_form" TabOrder="23" Top="27" UpperOnly="TRUE" Width="130"></Edit>
				<Static Align="Right" Height="24" Id="Static14" Left="232" Style="sty_lb_form_basic" TabOrder="24" Text="실패사유&#32;" Top="104" VAlign="Middle" Width="78"></Static>
				<Combo Border="Flat" CodeColumn="CODE" DataColumn="CODE_NAME" Enable="FALSE" Height="20" Id="cb_zfrsn" InnerDataset="ds_zfrsn" Left="310" OnChanged="div_ses0180_ni_cb_zfrsn_OnChanged" Style="sty_ipt_form_ind" TabOrder="25" Top="102" Width="104"></Combo>
				<Edit BindDataset="ds_list" Border="Flat" Enable="FALSE" Height="20" Id="ed_zfrsn_t" Left="416" LeftMargin="4" MaxLength="30" RightMargin="4" Style="sty_ipt_form" TabOrder="26" Top="102" UpperOnly="TRUE" Width="130"></Edit>
				<Static Align="Right" Height="24" Id="Static5" Left="568" Style="sty_lb_form_basic" TabOrder="29" Text="입찰결과일&#32;" VAlign="Middle" Width="78"></Static>
				<Calendar BindDataset="ds_list" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Enable="FALSE" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_bdrsltdt" Left="648" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form_ind" SundayTextColor="user35" TabOrder="27" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="1" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="104"></Calendar>
				<Static Align="Right" Height="24" Id="Static15" Left="568" Style="sty_lb_form_basic" TabOrder="30" Text="3위&#32;회사&#32;" Top="26" VAlign="Middle" Width="78"></Static>
				<Combo Border="Flat" CodeColumn="CODE" DataColumn="CODE_NAME" Enable="FALSE" Height="20" Id="cb_bdcm3" InnerDataset="ds_bdcm" Left="648" OnChanged="div_ses0180_ni_cb_bdcm_OnChanged" Style="sty_ipt_form_ind" TabOrder="32" Top="27" Width="104"></Combo>
				<Edit BindDataset="ds_list" Border="Flat" Enable="FALSE" Height="20" Id="ed_bdcm3_t" Left="752" LeftMargin="4" MaxLength="30" RightMargin="4" Style="sty_ipt_form" TabOrder="32" Top="27" UpperOnly="TRUE" Width="130"></Edit>
				<Static Align="Right" Height="24" Id="Static16" Left="568" Style="sty_lb_form_basic" TabOrder="32" Text="3위&#32;투찰가&#32;" Top="52" VAlign="Middle" Width="78"></Static>
				<Static Align="Right" Height="24" Id="Static17" Left="568" Style="sty_lb_form_basic" TabOrder="31" Text="3위&#32;시행율&#32;" Top="78" VAlign="Middle" Width="78"></Static>
				<MaskEdit BindDataset="ds_list" Border="Flat" Enable="FALSE" Height="20" Id="ed_bderate3" Left="648" LeftMargin="4" Mask="#,###.0" RightMargin="4" Style="sty_ipt_form" TabOrder="28" TabStop="FALSE" Top="78" Width="104"></MaskEdit>
				<Combo Border="Flat" CodeColumn="CODE" DataColumn="CODE_NAME" Enable="FALSE" Height="20" Id="cb_zrmklist" InnerDataset="ds_zrmklist" Left="646" OnChanged="div_ses0180_ni_cb_zrmklist_OnChanged" Style="sty_ipt_form_ind" TabOrder="35" Top="102" Width="104"></Combo>
				<Edit BindDataset="ds_list" Border="Flat" Enable="FALSE" Height="20" Id="ed_zrmk" Left="751" LeftMargin="4" MaxLength="50" RightMargin="4" Style="sty_ipt_form" TabOrder="36" Top="102" UpperOnly="TRUE" Width="186"></Edit>
				<Static Align="Right" Height="24" Id="Static8" Left="752" Style="sty_lb_form_basic" TabOrder="38" Text="성공여부&#32;" Top="52" VAlign="Middle" Width="78"></Static>
				<Checkbox Column="ZSFLG" Enable="FALSE" FalseValue="&#32;" Height="20" Id="chk_zsflg" Left="832" TabOrder="37" TabStop="FALSE" Top="54" TrueValue="X" Value="FALSE" Width="16"></Checkbox>
				<MaskEdit BindDataset="ds_list" Border="Flat" Enable="FALSE" Height="20" Id="ed_bdamt2" Left="312" LeftMargin="4" Mask="#,###" OnChar="div_ses0180_ni_bdamt_OnChar" RightMargin="4" Style="sty_ipt_form" TabOrder="39" TabStop="FALSE" Top="54" Width="104"></MaskEdit>
				<MaskEdit BindDataset="ds_list" Border="Flat" Enable="FALSE" Height="20" Id="ed_bdamt3" Left="648" LeftMargin="4" Mask="#,###" OnChar="div_ses0180_ni_bdamt_OnChar" RightMargin="4" Style="sty_ipt_form" TabOrder="40" TabStop="FALSE" Top="53" Width="104"></MaskEdit>
				<Static Align="Right" Height="24" Id="Static4" Left="232" Style="sty_lb_form_basic" TabOrder="16" Text="2위&#32;회사&#32;" Top="26" VAlign="Middle" Width="78"></Static>
			</Contents>
		</Div>
		<Static Align="Right" Height="24" Id="Static3" Left="1" Style="sty_lb_search" TabOrder="10" Text="입찰일" Top="54" VAlign="Middle" Width="80"></Static>
		<Calendar Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_bddat_fm" Left="83" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="7" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="56" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="80"></Calendar>
		<Static Align="Center" Border="None" Color="user7" Font="굴림,9" Height="20" Id="st_gubun1" Left="163" TabOrder="8" Text="~" Top="56" VAlign="Middle" Width="18"></Static>
		<Calendar Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_bddat_to" Left="181" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="9" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="56" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="80"></Calendar>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_ses0181" ImageID="btn_sub_10" Left="300" LeftMargin="12" OnClick="fn_OnClick_btn" Style="sty_btn" TabOrder="11" Text="입찰결과&#32;미등록현장&#32;조회" Top="56" Transparent="TRUE" Width="150"></Button>
	</Form>
	<Script><![CDATA[/*
 ******************************************************************************************
 * 기      능   : 
 * 작  성  자   : 
 * 작성  일자   : 
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
#include "LIB::commons.js";	// 공통 스크립트 
#include "LIB::nsfRequest.js";	// 공통 스크립트 
#include "LIB::common_hdel.js";	// 공통 스크립트  /* GNY 추가 */
#include "LIB::common_sd.js";

//=========================================================================================
// [ PART 1 ]
// Form에서 사용될 전역변수를 선언
// FORM에서 사용되는 전역변수는 대문자로 작성하며, F_XXX 의 형태를 갖도록 한다. 
//=========================================================================================
var F_QTNUM = '';
var F_QTSER = '';
//var F_SONNR = '';
var F_ZCOST = '';
var F_SBDCM = '';
var F_SBDCM_CD = '10'; // 2012.10.10  수의계약, 낙찰의 경우에만 처리
var F_ZSEC = '';
var F_NROW = 0;
var F_ENABLE = false;

var F_SELECT_ROW = 0;
var F_AUART="";

//=========================================================================================
// [ PART 2 ]
// Form Loading / Unloading 시 작업 정의
//=========================================================================================
function fn_OnLoadCompleted(obj) {
	// Form 로드 이벤트 맨 첫줄에 기술 
	//gfn_initForm(true);
	
	fn_init();

	//gfn_translation(obj, G_LANG);
	
	//다국어 변환 DIV관련 인식 안되는 control
	// div_ses0180.Static0.Text= gfn_rename(div_ses0180.Static0.Text, G_LANG);
	// div_ses0180.Static1.Text= gfn_rename(div_ses0180.Static1.Text, G_LANG);
	// div_ses0180.Static2.Text= gfn_rename(div_ses0180.Static2.Text, G_LANG);
	// div_ses0180.Static3.Text= gfn_rename(div_ses0180.Static3.Text, G_LANG);
	// div_ses0180.Static4.Text= gfn_rename(div_ses0180.Static4.Text, G_LANG);
	// div_ses0180.Static5.Text= gfn_rename(div_ses0180.Static5.Text, G_LANG);
	// div_ses0180.Static6.Text= gfn_rename(div_ses0180.Static6.Text, G_LANG);
	// div_ses0180.Static7.Text= gfn_rename(div_ses0180.Static7.Text, G_LANG);
	// div_ses0180.Static8.Text= gfn_rename(div_ses0180.Static8.Text, G_LANG);
	// div_ses0180.Static9.Text= gfn_rename(div_ses0180.Static9.Text, G_LANG);
	// div_ses0180.Static10.Text= gfn_rename(div_ses0180.Static10.Text, G_LANG);
	// div_ses0180.Static11.Text= gfn_rename(div_ses0180.Static11.Text, G_LANG);
	// div_ses0180.Static12.Text= gfn_rename(div_ses0180.Static12.Text, G_LANG);
}

/********************************************************************************
* 기      능   : 폼 초기화
********************************************************************************/
function fn_init()
{
	gfn_initForm(true);
	fn_enable();
	
	ds_detail.DeleteAll();
	ds_detail.AddRow();

	// 타사 조회
	ds_sbdcm.DeleteAll();
	ds_sbdcm.AddRow();
	ds_sbdcm.SetColumn(0,"CODE","BS106");
	ds_sbdcm.SetColumn(0,"CODE_NAME","BS106");
	ds_sbdcm.SetColumn(0, "FILTER1","");
	// 서비스 호출
	nsfRequest("query"					// srvId
				, "combo/comboXml"		// url
				, "ds_sbdcm=ds_sbdcm"	// inDsList
				, "ds_sbdcm=ds_sbdcm"	// outDsList
				, ""					// strParam
				, "fn_afterQuery_sbdcm"	// CallBackFunc
				);
	
	// 입찰결과 조회
	ds_zprgflg.DeleteAll();
	ds_zprgflg.AddRow();
	ds_zprgflg.SetColumn(0,"CODE","SD108");
	ds_zprgflg.SetColumn(0,"CODE_NAME","SD108");
	// 서비스 호출
	nsfRequest("query"						// srvId
				, "combo/comboXml"			// url
				, "ds_zprgflg=ds_zprgflg"	// inDsList
				, "ds_zprgflg=ds_zprgflg"	// outDsList
				, ""						// strParam
				, "fn_afterQuery_zprgflg"	// CallBackFunc
				);

	// 실패사유 조회
	gfn_queryDD07T('ZSDDZFRSN', ds_zfrsn, 'N');
			
	// 비고
	gfn_queryDD07T('ZSDDZRMKLIST', ds_zrmklist, 'N');	
	
	if ( G_USER_GROUP_B == "B10"  || G_USER_GROUP_B == "B20" ) 
	{
		/** 2021.05 jss 주석처리 - STO관리팀 김필정 요청
		var rtn = gfn_openPopUpUrlHdel("Ses::Ses0181.xml", true, "");
		if ( rtn != null && rtn != 0 ) {
			this.Close();
		}
		*/
	}
					
}

//=========================================================================================
// [ PART 3 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,form닫기)
//=========================================================================================
/********************************************************************************
* 기      능   : 버튼 이벤트
********************************************************************************/
function fn_OnClick_btn(obj)
{ 
	var fncName = "fn_" + substr(obj.id, 4); 
	eval( fncName + "()");
}

function fn_zsec() {
	var arg  = "fa_name="  + quote('타사');
	    arg += " fa_filter1 =" + quote(ds_list.GetColumn(ds_list.currow, "SPART"));

	var arr = gfn_openPopUpUrlHdel("Ses::Ses0182.xml", true, arg );

	if (arr != null && arr != 0)
	{
		F_ZSEC = arr[0];
		div_ses0180.ed_zsec.text = arr[1];	// 리턴된 수주협력업체로 검색조건 SET
		div_ses0180.ed_zsec.SetFocus();
		if (div_ses0180.cb_zprgflg.Value == '31') {	
			div_ses0180.cb_sbdcm = F_ZSEC;
		}		
	}
}

function fn_sso0060() {
	var arg = "fa_qtnum="+quote(F_QTNUM);

	if (G_MANDT == "910")	// 개발의 경우
	{
		var arr = gfn_openWin('SDSO000060', arg);
	}
	else					// 운영의 경우
	{	  
		if ( substr(F_QTNUM,1) == "F" || substr(F_QTNUM,1) == "G" || substr(F_QTNUM,1) == "J" ) 
		{
			var arr = gfn_openWin('SD05020010', arg);
		}
		 else 
		{
			var arr = gfn_openWin('SD01030010', arg);
		}
	}
}

//입찰결과 미등록현장 조회
function fn_ses0181() {
	if(!fn_query_chk) {
		fn_query_chk = true;
	} else {
		gfn_showAlert("CW10025", "조회중입니다..");
		return;
	}	
		
	// 조회조건 Parameter Setting
	ds_list.DeleteAll();
	ds_cond.DeleteAll();
	ds_cond.AddRow();
	ds_cond.SetColumn(0,'ZKUNNR',div_sestop.div_sman.ed_sman_cd.Text);
	// 서비스 호출
	nsfRequest("query"									// srvId
				, "ses0180/find0181"					// url
				, "ds_cond=ds_cond ds_list=ds_list"		// inDsList
				, "ds_list=ds_list ds_error=ds_error"	// outDsList
				, ""									// strParam
				, "fn_afterQuery"						// CallBackFunc
				);

    fn_createWait("",this);     // 처리중입니다. 메시지 처리

}


/********************************************************************************
* 기      능   : 조회
********************************************************************************/
var fn_query_chk = false; //중복 조회방지용 flag

function fn_query() {

	var arr = ['견적일', '12'];
	if(gfn_getDayCnt(ds_days, div_sestop.cal_qtdat_fm.Value, div_sestop.cal_qtdat_to.Value) > 365) {
		gfn_showAlert("CW10087", arr);
		div_sestop.cal_qtdat_fm.SetFocus();
		return false;
	}
	
	if (div_sestop.cal_qtdat_fm.Value > div_sestop.cal_qtdat_to.Value) {
		gfn_showAlert("CW10025", "견적일자 기간을 확인하세요.");
		div_sestop.cal_qtdat_fm.SetFocus();
		return false;
	}
	
	if(!fn_query_chk) {
		fn_query_chk = true;
	} else {
		gfn_showAlert("CW10025", "조회중입니다..");
		return;
	}	
		
	// 조회조건 Parameter Setting

	ds_list.DeleteAll();
	ds_cond.DeleteAll();
	ds_cond.AddRow();
	ds_cond.SetColumn(0,'QTDAT_FR',div_sestop.cal_qtdat_fm.Value);
	ds_cond.SetColumn(0,'QTDAT_TO',div_sestop.cal_qtdat_to.Value);
	ds_cond.SetColumn(0,'ZESTDAT_FR',div_sestop.cal_zestdat_fm.Value);
	ds_cond.SetColumn(0,'ZESTDAT_TO',div_sestop.cal_zestdat_to.Value);
	ds_cond.SetColumn(0,'VKBUR',div_sestop.div_vbvg.cb_frvb.Value);
	ds_cond.SetColumn(0,'VKGRP',div_sestop.div_vbvg.cb_frvg.Value);
	ds_cond.SetColumn(0,'ZPRGFLG',div_sestop.cb_zprgflg.Value);
	ds_cond.SetColumn(0,'ZPSTAT',div_sestop.cb_zpstat.Value);
	ds_cond.SetColumn(0,'ZKUNNR',div_sestop.div_sman.ed_sman_cd.Text);
	ds_cond.SetColumn(0,'BDDAT_FR',cal_bddat_fm.Value);
	ds_cond.SetColumn(0,'BDDAT_TO',cal_bddat_to.Value);
	// 서비스 호출
	nsfRequest("query"									// srvId
				, "ses0180/find"						// url
				, "ds_cond=ds_cond ds_list=ds_list"		// inDsList
				, "ds_list=ds_list ds_error=ds_error"	// outDsList
				, ""									// strParam
				, "fn_afterQuery"						// CallBackFunc
				);

    fn_createWait("",this);     // 처리중입니다. 메시지 처리
    

}

/********************************************************************************
* 기      능   : 저장  
********************************************************************************/
function fn_save() {
	if (ds_list.row < 0)
	{
		gfn_showAlert("CW00013");
		return false;
	}

	// 2012.10.10 수주생성건은 결과정보 수정 불가 반영
	// 2012.10.19 
	var varVBELN = Trim( grd_list.GetCellValue(grd_list.CurrentRow, gfn_getColIdx(grd_list,"VBELN")) );
	if ( varVBELN != null && varVBELN != '')	{
		gfn_showAlert( "CW00114", "수주생성건은 저장이");
		return false;
	}

	// 대리점의 경우와 본팀의 경우가 입찰 저장
	// 프로세스가 상이함 2012.11.27
	// 입찰 결과
	//if ( ds_list.GetColumn(ds_list.row, "ZPRGFLG_1046") != "50" )
	if ( ds_list.GetColumn(ds_list.row, "ZPRGFLG_1046") > "50" ) //2021.05 jss
	{
		//gfn_showAlert("CW10025", "진행상태가 입찰의 경우에만 처리 가능합니다.");
		gfn_showAlert("CW10025", "진행상태가 입찰 이전의 경우에만 처리 가능합니다.");
		return false;
	}

	var obj = fn_get_div_obj(grd_list.CurrentRow);
		
	// 예산가일 경우 수의계약 불가
	if (obj.cb_zprgflg.Value ==  10 && ds_list.GetColumn(ds_list.row, "QTGBN") == 'B')
	{
		gfn_showAlert("CW10025", "예산가 견적은 수주 생성이 불가능합니다. \n 견적등록에서 견적구분을 실행가로 변경 후 진행하시기 바랍니다.");
		return false;
	}
	
	// 필수입력 체크  - W10027=${}을/를 입력한 후 저장해 주세요.
	//if (obj.cal_bddat.Value == '') {	gfn_showAlert('CW10027','입찰일');		obj.cal_bddat.SetFocus();	return;		} //2021.05 jss 주석처리
	if (obj.cb_zprgflg.Index == 0) {	gfn_showAlert('CW10077','입찰결과');	obj.cb_zprgflg.SetFocus();	return; 	}

	//Object별 필수입력 체크(국내승강기사업부/이외)
	if ( obj.id == "div_ses0180_ni" ) {

		/**
		if (length(trim(obj.ed_sbdam.Value)) == 0 || ToNumber(obj.ed_sbdam.Value) <= 0)	{	
			gfn_showAlert("CW00022", "낙찰가");		obj.ed_sbdam.SetFocus();		return; 	}
			
		if (length(trim(obj.ed_sbderate.Value)) == 0 || ToNumber(obj.ed_sbderate.Value) <= 0) {
			gfn_showAlert("CW00022", "낙찰시행율");	obj.ed_sbderate.SetFocus();		return; 	}

		if (obj.cal_bdrsltdt.Value == '') {	
			gfn_showAlert('CW10027','입찰결과일');	obj.cal_bdrsltdt.SetFocus();	return;	 	}

		if (obj.cal_ctdat.Value == '' && obj.cb_sbdcm.Value = "10" ) {
			gfn_showAlert('CW10027','계약일');		obj.cal_ctdat.SetFocus();		return;	 	}
			
		if ( obj.cb_zprgflg.Value == '10' ) 	{		
		
			if (length(trim(obj.cb_bdcm2.Value)) == 0 ) {	
				gfn_showAlert('CW10077',"2위 투찰사");	obj.cb_bdcm2.SetFocus();	return; 	}
			if (length(trim(obj.ed_bdamt2.Value)) == 0 || ToNumber(obj.ed_bdamt2.Value) <= 0)	{
				gfn_showAlert("CW00022", "2위 투찰가");	obj.ed_bdamt2.SetFocus();	return; 	}			
			if (length(trim(obj.ed_bderate2.Value)) == 0 || ToNumber(obj.ed_bderate2.Value) <= 0) {
				gfn_showAlert("CW00022", "2위 투찰시행율");	obj.ed_bderate2.SetFocus();	return;   }			
		}
		*/
		

		//2021.05 jss 필수입력조정
		if(obj.cb_zprgflg.Value == '30' || obj.cb_zprgflg.Value == '31' || obj.cb_zprgflg.Value == '40' ){//낙찰, 낙찰실패, 수주실패
		
			if (length(trim(obj.cb_sbdcm.Value)) == 0 ) {	
				gfn_showAlert('CW10077',"낙찰사");	obj.cb_sbdcm.SetFocus();	return; 	}
				
			if (length(trim(obj.cb_bdcm2.Value)) == 0 ) {	
				gfn_showAlert('CW10077',"2위 투찰사");	obj.cb_bdcm2.SetFocus();	return; 	}
			if (length(trim(obj.ed_bdamt2.Value)) == 0 || ToNumber(obj.ed_bdamt2.Value) <= 0)	{
				gfn_showAlert("CW00022", "2위 투찰가");	obj.ed_bdamt2.SetFocus();	return; 	}			
			if (length(trim(obj.ed_bderate2.Value)) == 0 || ToNumber(obj.ed_bderate2.Value) <= 0) {
				gfn_showAlert("CW00022", "2위 투찰시행율");	obj.ed_bderate2.SetFocus();	return;   }

			if (length(trim(obj.cb_bdcm3.Value)) == 0 ) {	
				gfn_showAlert('CW10077',"3위 투찰사");	obj.cb_bdcm3.SetFocus();	return; 	}
			if (length(trim(obj.ed_bdamt3.Value)) == 0 || ToNumber(obj.ed_bdamt3.Value) <= 0)	{
				gfn_showAlert("CW00022", "3위 투찰가");	obj.ed_bdamt3.SetFocus();	return; 	}			
			if (length(trim(obj.ed_bderate3.Value)) == 0 || ToNumber(obj.ed_bderate3.Value) <= 0) {
				gfn_showAlert("CW00022", "3위 투찰시행율");	obj.ed_bderate3.SetFocus();	return;   }	
		
		}else{
			if(obj.Enable) {
				if(obj.cb_zrmklist.Index < 0){
					gfn_showAlert('CW10027','비고'); 
					obj.cb_zrmklist.SetFocus();		
					return;	
				}	
			}
		}
		
		
	} else {
		// 2012.10.10 수의계약, 낙찰의 경우에만 현대를 10 코드로 변경 처리
		if ( obj.cb_zprgflg.Value == '10' || obj.cb_zprgflg.Value == '30' ) 	{
			ds_detail.SetColumn(0,'SBDCM',F_SBDCM_CD);
			// 2013.03.19 낙찰가 입력여부 체크
			/** 2021.05 jss 주석처리
			if (length(trim(obj.ed_sbdam.Value)) == 0 || ToNumber(obj.ed_sbdam.Value) <= 0)	{
				gfn_showAlert("CW00022", "낙찰가");	obj.ed_sbdam.SetFocus();		return; 	}
			*/	
		}	
		
		 //2021.05 jss : 비고필수입력
		if(obj.Enable) {
			if(obj.ed_zrmk.Text == ""){
				gfn_showAlert('CW10027','비고'); 
				obj.ed_zrmk.SetFocus();		
				return;	
			}
		}
	}
	
	if ((obj.cb_zprgflg.Value == '60' || obj.cb_zprgflg.Value == '60') 
		&& (obj.div_sman.ed_sman_cd.Text == '' || obj.div_sman.ed_sman_cd.Text == null)) {
		gfn_showAlert("CW10025", "견적 이관 시에는 이관 담당자명을 지정해야 합니다.");
		return;
	}
	
	if(F_AUART != "ZS"){
		if (obj.cb_zprgflg.Value == '31' && obj.cb_zfrsn.Index == 0) {
			// CW10077=${}을/를 선택한 후 저장해 주세요.
			gfn_showAlert('CW10077','실패사유');
			return;
		}
	}else{
		if (obj.cb_zprgflg.Value == '10' || obj.cb_zprgflg.Value == '30' || obj.cb_zprgflg.Value == '31' || obj.cb_zprgflg.Value == '40') { //수의계약, 낙찰, 낙찰실패, 수주실패
			if(obj.cb_zfrsn.Index == 0){
				gfn_showAlert('CW10077','성공/실패사유');
				return;
			}
		}
		
		if(obj.cb_zfrsn.Value == "50" &&  length(trim(obj.ed_zfrsn_t.Value)) == 0){
			gfn_showAlert("CW10025", "사양내용을 입력하세요.");
			obj.ed_zfrsn_t.SetFocus();
			return;
		}
	}

	// 성공여부 Value 변수에 저장
	var zsflg = obj.chk_zsflg.Value;

	// 저장 Parameter Setting
	ds_detail.DeleteAll();
	ds_detail.AddRow();
	if (obj.ed_bdseq.Text == '자동입력') {
		ds_detail.SetColumn(0,'BDSEQ',1);
	} else {
		ds_detail.SetColumn(0,'BDSEQ',parseInt(obj.ed_bdseq.Text));
	}
	ds_detail.SetColumn(0,'QTNUM',F_QTNUM);
	ds_detail.SetColumn(0,'QTSER',F_QTSER);
	//ds_detail.SetColumn(0,'SONNR',F_SONNR);
	ds_detail.SetColumn(0,'ZCOST',F_ZCOST);

	ds_detail.SetColumn(0,'SBDCM',obj.cb_sbdcm.Value);

	ds_detail.SetColumn(0,'BDDAT',obj.cal_bddat.Value);
	ds_detail.SetColumn(0,'CTDAT',obj.cal_ctdat.Value);

	ds_detail.SetColumn(0,'ZPRGFLG', obj.cb_zprgflg.Value);
	ds_detail.SetColumn(0,'SBDAM',   obj.ed_sbdam.Value);

	ds_detail.SetColumn(0,'PBDAM', obj.ed_pbdam.Value);
	ds_detail.SetColumn(0,'ZSFLG', zsflg);
		
	if (obj.cb_zfrsn.Index == 0) {
		ds_detail.SetColumn(0,'ZFRSN',' ');
	} else {
		ds_detail.SetColumn(0,'ZFRSN',obj.cb_zfrsn.Value);
	}

	ds_detail.SetColumn(0,'ZRMK',obj.ed_zrmk.Text);
	
	if (obj.cb_zprgflg.Value == '60') {
		ds_detail.SetColumn(0,'ZKUNNR', obj.div_sman.ed_sman_cd.Text);
		ds_detail.SetColumn(0, 'SBDCM', "");
	}
	
	if ( obj.id == "div_ses0180_ni" ) {
		ds_detail.SetColumn(0,'SBDERATE', obj.ed_sbderate.Value);
		ds_detail.SetColumn(0,'BDRSLTDT', obj.cal_bdrsltdt.Value);
		ds_detail.SetColumn(0,'BDCM2'	, obj.cb_bdcm2.Value);
		ds_detail.SetColumn(0,'BDCM2_T'	, obj.ed_bdcm2_t.Value);
		ds_detail.SetColumn(0,'BDAMT2'	, obj.ed_bdamt2.Value);
		ds_detail.SetColumn(0,'BDERATE2', obj.ed_bderate2.Value);	
		ds_detail.SetColumn(0,'BDCM3'	, obj.cb_bdcm3.Value);
		ds_detail.SetColumn(0,'BDCM3_T'	, obj.ed_bdcm3_t.Value);
		ds_detail.SetColumn(0,'BDAMT3'	, obj.ed_bdamt3.Value);
		ds_detail.SetColumn(0,'BDERATE3', obj.ed_bderate3.Value);		
		ds_detail.SetColumn(0,'ZFRSN_T' , obj.ed_zfrsn_t.Value);		
		ds_detail.SetColumn(0,'ZRMKLIST', obj.cb_zrmklist.Value);			
	} else {
		ds_detail.SetColumn(0,'ZSECAM', obj.ed_zsecam.Value);
		ds_detail.SetColumn(0,'ZFOREC', obj.ed_zforec.Value);
		ds_detail.SetColumn(0,'SHANG' , obj.ed_shang.Value);	

		// 타사가 없는 경우의 처리
		if (length(trim(obj.ed_zsec.Text)) == 0) 	{
			ds_detail.SetColumn(0,'ZSEC', ' ');
		}else	{
			ds_detail.SetColumn(0,'ZSEC', F_ZSEC);
		}
	}
	
	ds_detail.SetColumn(0,'AUART', ds_list.GetColumn(ds_list.row, "AUART"));
	
	F_SELECT_ROW = ds_list.row;
	
	if (!gfn_showConfirm("CI00014", "입찰등록결과")) {	// 저장하시겠습니까?
		return;
	}
		
	// 서비스 호출
	nsfRequest("query"									// srvId
				, "ses0180/save"						// url
				, "ds_cond=ds_cond ds_detail=ds_detail ds_list=ds_list"		// inDsList
				, "ds_list=ds_list ds_error=ds_error"	// outDsList
				, ""									// strParam
				, "fn_afterSave"						// CallBackFunc
				);
	
	fn_createWait("",this);     // 처리중입니다. 메시지 처리
	
}

/********************************************************************************
* 기      능   : 삭제  
********************************************************************************/
function fn_delete() {

	var obj = fn_get_div_obj(grd_list.CurrentRow);
	
	if (!gfn_showConfirm("CI00015", "입찰등록결과")) {	// 삭제하시겠습니까?
		return;
	}

	// 삭제 Parameter Setting
	ds_detail.DeleteAll();
	ds_detail.AddRow();
	ds_detail.SetColumn(0,'QTNUM',F_QTNUM);
	ds_detail.SetColumn(0,'BDSEQ',parseInt(obj.ed_bdseq.Text));

	// 2012.10.19 견적차수 및 수주계획번호
	ds_detail.SetColumn(0,'QTSER',F_QTSER);
		
	// 서비스 호출
	nsfRequest("query"									// srvId
				, "ses0180/delete"						// url
				, "ds_cond=ds_cond ds_detail=ds_detail ds_list=ds_list"		// inDsList
				, "ds_list=ds_list ds_error=ds_error"	// outDsList
				, ""									// strParam
				, "fn_afterSave"						// CallBackFunc
				);

	fn_createWait("",this);     // 처리중입니다. 메시지 처리
}

/********************************************************************************
* 기      능   : 액셀  
********************************************************************************/
function fn_excel() {
	if ( ds_list.RowCount() > 0 )
		gfn_exportExcel(grd_list, "입찰결과리스트");
	else
		gfn_showAlert("CW00010");
}

/********************************************************************************
* 기      능   : 닫기  
********************************************************************************/
function fn_close() {
	close();
}

/********************************************************************************
* 기      능   : 입력폼 활성/비활성  
********************************************************************************/
function fn_enable() {
	
	var lv_nrow = 0;
	if (F_NROW <> 0) {
		lv_nrow = F_NROW;
	} else {
		lv_nrow = ds_list.currow;
	}
	
	var obj = fn_get_div_obj(lv_nrow);	
	
	obj.Enable = F_ENABLE;
	obj.cal_bddat.Enable = F_ENABLE;
	obj.cal_ctdat.Enable = F_ENABLE;

	obj.cb_zprgflg.Enable = F_ENABLE;

	obj.ed_bdseq.Enable = F_ENABLE;
	
	if (F_ENABLE == true) {
		obj.cal_bddat.Value = gfn_getCurrDate();
		obj.cal_ctdat.Value = gfn_getCurrDate();
		
		obj.cb_zprgflg.index = 0;
		obj.cb_zfrsn.index = 0;
	} else {
		obj.cal_bddat.Value = '';
		obj.cal_ctdat.Value = '';
	}	
	
	if(obj.id == "div_ses0180_ni") {	
		obj.ed_sbderate.Enable 	= F_ENABLE;
		obj.cal_bdrsltdt.Enable = F_ENABLE;
		obj.cb_bdcm2.Enable 	= F_ENABLE;
		obj.ed_bdamt2.Enable 	= F_ENABLE;
		obj.ed_bderate2.Enable 	= F_ENABLE;
		obj.cb_bdcm3.Enable	 	= F_ENABLE;
		obj.ed_bdamt3.Enable 	= F_ENABLE;
		obj.ed_bderate3.Enable 	= F_ENABLE;
		obj.cb_zrmklist.Enable 	= F_ENABLE;
	} else {
		obj.ed_zrmk.Enable 		= F_ENABLE;
		obj.btn_zsec.Enable 	= F_ENABLE;
		obj.ed_zsecam.Enable 	= F_ENABLE;	
	}
}

/********************************************************************************
* 기      능   : 입력폼 활성/비활성  
********************************************************************************/
function fn_default() {

	var obj = fn_get_div_obj(grd_list.CurrentRow);
		
	obj.cb_sbdcm.Text = '';
	obj.cal_bddat.Value = '';
	obj.cal_ctdat.Value = '';
	obj.cb_zprgflg.Index = 0;
	obj.ed_sbdam.Text = '';
	obj.ed_pbdam.Text = '';
	obj.chk_zsflg.Value = 0;
	obj.cb_zfrsn.Index = 0;
	obj.ed_zrmk.Text = '';
	
	if(obj.id == "div_ses0180_ni") {	
		obj.ed_sbderate.Text 	= 0;
		obj.cal_bdrsltdt.Value 	= '';
		obj.cb_bdcm2.Index  	= 0;
		obj.ed_bdamt2.Text 	  	= 0;
		obj.ed_bderate2.Text 	= 0;
		obj.cb_bdcm3.Index  	= 0;
		obj.ed_bdamt3.Text 	  	= 0;
		obj.ed_bderate3.Text 	= 0;
		obj.cb_zrmklist.Index  	= 0;
	} else {
		obj.ed_zsecam.Text 		= '';
		obj.ed_zsec.Text = '';
		obj.ed_shang.Text = '';
		obj.ed_zforec.Text = '';
	}
		
}

/********************************************************************************
* 기      능   : 그리드 셀 클릭
********************************************************************************/
function grd_list_OnCellClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
	//2021.08 jss
	F_AUART = left(ds_list.GetColumn(nRow, "AUART"),2);
	
	if(F_AUART == "ZS"){
		ds_zfrsn.ClearData();
		ds_zfrsn.AddRow(); 
		ds_zfrsn.SetColumn(ds_zfrsn.currow,'CODE', ""); 
		ds_zfrsn.SetColumn(ds_zfrsn.currow,'CODE_NAME', "- 선택 -"); 
		ds_zfrsn.AddRow(); 
		ds_zfrsn.SetColumn(ds_zfrsn.currow,'CODE', "10"); 
		ds_zfrsn.SetColumn(ds_zfrsn.currow,'CODE_NAME', "가격우위"); 
		ds_zfrsn.AddRow(); 
		ds_zfrsn.SetColumn(ds_zfrsn.currow,'CODE', "20"); 
		ds_zfrsn.SetColumn(ds_zfrsn.currow,'CODE_NAME', "경쟁사 배제"); 
		ds_zfrsn.AddRow(); 
		ds_zfrsn.SetColumn(ds_zfrsn.currow,'CODE', "30"); 
		ds_zfrsn.SetColumn(ds_zfrsn.currow,'CODE_NAME', "수의계약"); 
		ds_zfrsn.AddRow(); 
		ds_zfrsn.SetColumn(ds_zfrsn.currow,'CODE', "40"); 
		ds_zfrsn.SetColumn(ds_zfrsn.currow,'CODE_NAME', "업체지정"); 
		ds_zfrsn.AddRow(); 
		ds_zfrsn.SetColumn(ds_zfrsn.currow,'CODE', "50"); 
		ds_zfrsn.SetColumn(ds_zfrsn.currow,'CODE_NAME', "사양"); 
		ds_zfrsn.AddRow(); 
		ds_zfrsn.SetColumn(ds_zfrsn.currow,'CODE', "60"); 
		ds_zfrsn.SetColumn(ds_zfrsn.currow,'CODE_NAME', "2nd chance"); 
		ds_zfrsn.AddRow(); 
		ds_zfrsn.SetColumn(ds_zfrsn.currow,'CODE', "90"); 
		ds_zfrsn.SetColumn(ds_zfrsn.currow,'CODE_NAME', "기타"); 
		div_ses0180_ni.Static14.Text = "성공/실패사유";
	}else{
		ds_zfrsn.ClearData();
		ds_zfrsn.AddRow(); 
		ds_zfrsn.SetColumn(ds_zfrsn.currow,'CODE', ""); 
		ds_zfrsn.SetColumn(ds_zfrsn.currow,'CODE_NAME', "- 선택 -"); 
		ds_zfrsn.AddRow(); 
		ds_zfrsn.SetColumn(ds_zfrsn.currow,'CODE', "10"); 
		ds_zfrsn.SetColumn(ds_zfrsn.currow,'CODE_NAME', "저가입찰"); 
		ds_zfrsn.AddRow(); 
		ds_zfrsn.SetColumn(ds_zfrsn.currow,'CODE', "20"); 
		ds_zfrsn.SetColumn(ds_zfrsn.currow,'CODE_NAME', "대기업입찰제한"); 
		ds_zfrsn.AddRow(); 
		ds_zfrsn.SetColumn(ds_zfrsn.currow,'CODE', "30"); 
		ds_zfrsn.SetColumn(ds_zfrsn.currow,'CODE_NAME', "타사수의계약"); 
		ds_zfrsn.AddRow(); 
		ds_zfrsn.SetColumn(ds_zfrsn.currow,'CODE', "40"); 
		ds_zfrsn.SetColumn(ds_zfrsn.currow,'CODE_NAME', "업체지정"); 
		ds_zfrsn.AddRow(); 
		ds_zfrsn.SetColumn(ds_zfrsn.currow,'CODE', "50"); 
		ds_zfrsn.SetColumn(ds_zfrsn.currow,'CODE_NAME', "사양"); 
		ds_zfrsn.AddRow(); 
		ds_zfrsn.SetColumn(ds_zfrsn.currow,'CODE', "90"); 
		ds_zfrsn.SetColumn(ds_zfrsn.currow,'CODE_NAME', "기타"); 
		div_ses0180_ni.Static14.Text = "성공/실패사유";
		div_ses0180_ni.Static14.Text = "실패사유";
	}

	var obj = fn_get_div_obj(nRow);
	
	F_ENABLE = true;
	F_NROW = nRow;
	
	fn_enable();
	
	F_QTNUM = grd_list.GetCellValue(nRow,gfn_getColIdx(grd_list,"QTNUM"));
	F_QTSER = grd_list.GetCellValue(nRow,gfn_getColIdx(grd_list,"QTSER"));			  
	F_VBELN = Trim( grd_list.GetCellValue(nRow, gfn_getColIdx(grd_list,"VBELN")) );
	//F_SONNR = grd_list.GetCellValue(nRow,gfn_getColIdx(grd_list,"SONNR"));
	F_ZCOST = grd_list.GetCellValue(nRow,gfn_getColIdx(grd_list,"ZCOST"));
	F_SBDCM = grd_list.GetCellValue(nRow,gfn_getColIdx(grd_list,"SBDCM"));
	F_ZSEC = ds_bdcm.GetColumn(
			ds_bdcm.SearchRow('CODE=='+grd_list.GetCellValue(nRow,gfn_getColIdx(grd_list,"ZSEC")))
			,'CODE_NAME'
			);
	
	obj.cb_sbdcm.Text = ds_bdcm.GetColumn(
							ds_bdcm.SearchRow('CODE=='+F_SBDCM)+''
							,'CODE_NAME'
							);

	obj.cal_bddat.Value = grd_list.GetCellValue(nRow,gfn_getColIdx(grd_list,"BDDAT"));
	obj.cal_ctdat.Value = grd_list.GetCellValue(nRow,gfn_getColIdx(grd_list,"CTDAT"));
		
	//2012.12.12 update
	obj.chk_zsflg.Value = grd_list.GetCellValue(nRow,gfn_getColIdx(grd_list,"ZSFLG"));

	if (grd_list.GetCellValue(nRow,gfn_getColIdx(grd_list,"ZPRGFLG")) == null) {
		obj.cb_zprgflg.Index = 0;
	} else {
		obj.cb_zprgflg.Value = grd_list.GetCellValue(nRow,gfn_getColIdx(grd_list,"ZPRGFLG"));
	}
	obj.ed_sbdam.Value = grd_list.GetCellValue(nRow,gfn_getColIdx(grd_list,"SBDAM"));
	obj.ed_pbdam.Value = grd_list.GetCellValue(nRow,gfn_getColIdx(grd_list,"PBDAM"));

	if (grd_list.GetCellValue(nRow,gfn_getColIdx(grd_list,"ZFRSN")) == null || grd_list.GetCellValue(nRow,gfn_getColIdx(grd_list,"ZFRSN")) == ' ') {
		obj.cb_zfrsn.Index = 0;
	} else {
		obj.cb_zfrsn.Value = grd_list.GetCellValue(nRow,gfn_getColIdx(grd_list,"ZFRSN"));
	}

	obj.ed_zrmk.Text = grd_list.GetCellValue(nRow,gfn_getColIdx(grd_list,"ZRMK"));
		
	if (grd_list.GetCellValue(nRow,gfn_getColIdx(grd_list,"BDSEQ")) == 0) {
		obj.ed_bdseq.Text = '자동입력';
	} else {
		obj.ed_bdseq.Text = grd_list.GetCellValue(nRow,gfn_getColIdx(grd_list,"BDSEQ"));
	}
	if (obj.cb_zprgflg.Value == '10' or obj.cb_zprgflg.Value == '30') {
		btn_sso0060.Visible = true;
		if ( F_VBELN != null && F_VBELN != '') {
			btn_sso0060.Text = "수주조회";
		} else {
			btn_sso0060.Text = "수주생성";
		}		
	} else {
		btn_sso0060.Visible = false;
	}
	
	// 2012.10.10 수주생성건은 결과정보 수정 불가 반영
	if ( F_VBELN != null && F_VBELN != '')	{
		obj.Enable = false;
	}else	{
		obj.Enable = true;
	}			
	
	obj.Visible = true;
	if(obj.id == "div_ses0180_ni") {
	
		div_ses0180.Visible = false;	
		obj.ed_sbderate.Value 	= ds_list.GetColumn(nRow, "SBDERATE");
		obj.cal_bdrsltdt.Value 	= ds_list.GetColumn(nRow, "BDRSLTDT");
		obj.cb_bdcm2.Value 		= ds_list.GetColumn(nRow, "BDCM2");
		obj.ed_bdcm2_t.Value 	= ds_list.GetColumn(nRow, "BDCM2_T");
		obj.ed_bdamt2.Value 	= ds_list.GetColumn(nRow, "BDAMT2");
		obj.ed_bderate2.Value 	= ds_list.GetColumn(nRow, "BDERATE2");
		obj.cb_bdcm3.Value	 	= ds_list.GetColumn(nRow, "BDCM3");
		obj.ed_bdcm3_t.Value 	= ds_list.GetColumn(nRow, "BDCM3_T");
		obj.ed_bdamt3.Value 	= ds_list.GetColumn(nRow, "BDAMT3");
		obj.ed_bderate3.Value 	= ds_list.GetColumn(nRow, "BDERATE3");
		obj.ed_zfrsn_t.Value 	= ds_list.GetColumn(nRow, "ZFRSN_T");
		obj.cb_zrmklist.Value 	= ds_list.GetColumn(nRow, "ZRMKLIST");	
		if (obj.id == "div_ses0180_ni" && obj.cb_sbdcm.Text == "H" ) {
			ds_bdcm.Filter("FILTER1 == "+ quote(ds_list.GetColumn(ds_list.currow, "SPART")) + " && CODE != '10'" );
		} else {
			ds_bdcm.Filter("FILTER1 == "+ quote(ds_list.GetColumn(ds_list.currow, "SPART")));
		}
				
	} else {
	
		div_ses0180_ni.Visible = false;		
		F_ZSEC = grd_list.GetCellValue(nRow,gfn_getColIdx(grd_list,"ZSEC"));
		obj.ed_zsec.Text   = grd_list.GetCellText("Body", nRow, gfn_getColIdx(grd_list,"ZSEC") );
		obj.ed_shang.Value = grd_list.GetCellValue(nRow,gfn_getColIdx(grd_list,"SHANG"));
		obj.ed_zsecam.Value = grd_list.GetCellValue(nRow,gfn_getColIdx(grd_list,"ZSECAM"));
		var orgZSECAM = grd_list.GetCellValue(nRow,gfn_getColIdx(grd_list,"ZSECAM"));
		if ( orgZSECAM != null && orgZSECAM != "")
		{
			if (orgZSECAM == 0)
			{
				obj.ed_zforec.Value = 0;
			}
			else
			{
				obj.ed_zforec.Value = toNumber(F_ZCOST)
											/ toNumber(orgZSECAM)
											* 100;
	
				obj.ed_zforec.Value = round(obj.ed_zforec.Value, 1);
	
				// 2012.10.19 타사시행율 999 이상의 경우에는 999로 처리
				if ( ToNumber(obj.ed_zforec.Value) > 999)
				{
					obj.ed_zforec.Value = 999;
				}
			}
		}else
		{
			obj.ed_zforec.Value = "";
		}		
	}	
}


/********************************************************************************
* 기      능   : 그리드 헤더 클릭시 정렬 처리 
********************************************************************************/
function grd_list_OnHeadClick(obj,nCell,nX,nY,nPivotIndex) {
	if(nCell == 0) {
		gfn_selectGridCol(obj);
	} else {
		// 그리드 정렬 처리 
		gfn_sortGrid(obj, nCell);
	}
}

function cb_zprgflg_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	
	var obj = fn_get_div_obj(ds_list.currow);	
	
	// 수의계약 또는 낙찰(30)
	if (obj.cb_zprgflg.Value == '10' or obj.cb_zprgflg.Value == '30') {
		ds_sbdcm.UnFilter();
		obj.div_sman.Visible = false;
		obj.chk_zsflg.Value = 'X';
		//2012.12.12
		ds_list.SetColumn(ds_list.currow, "ZSFLG", 'X');
		
		obj.ed_sbdam.Value = obj.ed_pbdam.Value;
		F_SBDCM    = '10';
		obj.cb_sbdcm.Value = "10";
		
		obj.cb_zfrsn.Index = 0;		// 2012.10.10 (10.09 협의 내용 반영)
		obj.cb_zfrsn.Enable = false;
		
		lv_objNm = "div_ses0180_ni.ed_sbdam";
		div_ses0180_ni_bdamt_OnChar(object(lv_objNm),"","",obj.ed_sbdam.Value,"","");
					
	} else if (obj.cb_zprgflg.Value == '31') {
		obj.div_sman.Visible = false;
		obj.chk_zsflg.Value = ' ';
		//2012.12.12
		ds_list.SetColumn(ds_list.currow, "ZSFLG", ' ');
        if (obj.ed_zsecam.Value == null || obj.ed_zsecam.Value == "") {
		  obj.ed_sbdam.Value  = '0';
        } else {
		  obj.ed_sbdam.Value  = obj.ed_zsecam.Value;
		}
		if (F_ZSEC == null || F_ZSEC == ""){
			F_SBDCM = "";
		} else {
			F_SBDCM = F_ZSEC;
		}
		
		if(obj.ed_zsec.Text == null || obj.ed_zsec.Text ==""){
			obj.cb_sbdcm.Value  = "";
		} else {
			obj.cb_sbdcm.Value   = F_SBDCM;
		}		
		obj.cb_zfrsn.Enable = true;
	} else if (obj.cb_zprgflg.Value == '60' || obj.cb_zprgflg.Value == '70') {
		obj.cb_sbdcm.Value   = " ";
		obj.ed_sbdam.Value  = '0';
		obj.div_sman.ed_sman_cd.TEXT = "";
		obj.div_sman.ed_sman_nm.TEXT = "";
		obj.div_sman.Visible = true;
	} else {
		obj.div_sman.Visible = false;
		obj.chk_zsflg.Value = ' ';
		//2012.12.12
		ds_list.SetColumn(ds_list.currow, "ZSFLG", ' ');

		obj.ed_sbdam.Value  = '0';
		F_SBDCM = '';
		obj.cb_sbdcm.value  = ' ';
		obj.cb_zfrsn.Index  = 0;			// 2012.10.10 (10.09 협의 내용 반영)
		obj.cb_zfrsn.Enable = false;
	}

	if (obj.id == "div_ses0180_ni" && obj.cb_sbdcm.value == "10" ) {
		ds_bdcm.Filter("FILTER1 == "+ quote(ds_list.GetColumn(ds_list.currow, "SPART")) + " && CODE != '10'" );
	} else {
		ds_bdcm.Filter("FILTER1 == "+ quote(ds_list.GetColumn(ds_list.currow, "SPART")));
	}
	
	if (obj.cb_sbdcm.value == "10") {
		ds_sbdcm.Filter("FILTER1 == "+ quote(ds_list.GetColumn(ds_list.currow, "SPART")));	
	} else {
		ds_sbdcm.Filter("FILTER1 == "+ quote(ds_list.GetColumn(ds_list.currow, "SPART")) + " && CODE != '10'" );	
	}
	
	//if (obj.id == "div_ses0180_ni" && obj.cb_zprgflg.Value != '10' && obj.cb_zprgflg.Value != '30') {
	if (obj.id == "div_ses0180_ni" && obj.cb_zprgflg.Value != '10' ) {
		obj.ed_sbdam.Enable = true;
		obj.ed_sbdam.Value  = '0';
		obj.cb_sbdcm.Enable = true;
	}
	
	//2021.08 jss
	if(F_AUART == "ZS"){
		if (obj.cb_zprgflg.Value == '10' || obj.cb_zprgflg.Value == '30' || obj.cb_zprgflg.Value == '31' || obj.cb_zprgflg.Value == '40') { //수의계약, 낙찰, 낙찰실패, 수주실패
			obj.cb_zfrsn.Enable = true;
		}else{
			obj.cb_zfrsn.Index  = 0;	
			obj.cb_zfrsn.Enable = false;
		}
		obj.ed_zfrsn_t.Value = "";
	}
}

function div_ses0180_ed_zsecam_OnChar(obj,strPreText,nChar,strPostText,nLLParam,nHLParam)
{
	if (strPostText != null && strPostText != "")
	{
		if (strPostText == 0)
		{
			div_ses0180.ed_zforec.Value = 0;
		}
		else
		{
		
			div_ses0180.ed_zforec.Value = toNumber(F_ZCOST)
										/ toNumber(strPostText)
										* 100;
			
			div_ses0180.ed_zforec.Value = round(div_ses0180.ed_zforec.Value, 1);

			if (ToNumber(div_ses0180.ed_zforec.Value) > 999)
				div_ses0180.ed_zforec.Value = 999;
		}
	}else
	{
		div_ses0180.ed_zforec.Value = "";
	}

	if (div_ses0180.cb_zprgflg.Value == '31') {
		div_ses0180.ed_sbdam.Value = strPostText;
	}
}

//=========================================================================================
// [ PART 4]
// Callback 함수 정의 : callback 함수명은 메인 함수의 fn_xxxx() 에서 xxxx 부분은 fn_afterXXXX()
// 형태가 되도록 작성 
//=========================================================================================
/********************************************************************************
* 기      능   : 조회 Callback  
********************************************************************************/
function fn_afterQuery(svcId, errCode, errMsg) {

	fn_query_chk = false; //중복조회 방지용 Flag
	F_ENABLE = false;
	fn_enable();
	fn_default();

	fn_destroyWait();
	
	div_ses0180.div_sman.Visible = false;
	
	if(ds_error.rowcount() > 0) {   
	
		gfn_showMsgBar(ds_error.GetColumn(0,"ERRMSG"));   
		
	} else {
	 
		// 조회된 자료가 있을 경우 
		if (ds_list.RowCount() > 0) 
		{ 
			gfn_showMsg("CI00002", ds_list.RowCount()+"");  // CI00002 : "조회를 완료했습니다.조회건수 [${}건]"
			// 그리드 셀렉트 정보 하단에 표시되도록 조치
			grd_list_OnCellClick(this, F_SELECT_ROW);
		} 
		else 
		{	 
			gfn_showMsg("CW00010"); 					// CW00010 : "데이터가 없습니다."
		}
		
		if(F_SELECT_ROW != "") {
			ds_list.row =  F_SELECT_ROW;
		}
		F_SELECT_ROW = ""; 
	}
}

/********************************************************************************
* 기      능   : 저장 Callback  
********************************************************************************/
function fn_afterSave(svcId, errCode, errMsg) {
	fn_destroyWait();

	if(ds_error.rowcount() > 0) {
		gfn_showAlert(ds_error.GetColumn(0,"ERRMSG"), ds_error.GetColumn(0,"ERRCODE"));	
		return;
	}

	// 처리를 완료했습니다.
	gfn_showAlert("CI00005");

	F_ENABLE = false;
	fn_enable();
	fn_default();
	
	fn_query();
}

/********************************************************************************
* 기      능   : 낙찰사 조회 Callback  
********************************************************************************/
function fn_afterQuery_sbdcm(errCode, errMsg) 
{
	ds_bdcm.DeleteAll();
	ds_bdcm.Copy(ds_sbdcm);
}

/********************************************************************************
* 기      능   : 실패사유 조회 Callback
********************************************************************************/
function fn_afterQuery_zfrsn(errCode, errMsg) 
{  
	gfn_InsertRowCombo(ds_zfrsn, 0, "N", "Y");
	div_ses0180.cb_zfrsn.index = 0;
	div_ses0180_ni.cb_zfrsn.index = 0;
}

/********************************************************************************
* 기      능   : 입찰상태 조회 Callback  
********************************************************************************/
function fn_afterQuery_zprgflg(errCode, errMsg) 
{  
	gfn_InsertRowCombo(ds_zprgflg, 0, "N", "Y");
	div_ses0180.cb_zprgflg.index = 0;
	div_ses0180_ni.cb_zprgflg.index = 0;
}

function Ses0180_OnUnloadCompleted(obj)
{
	//Tabl에서 해당 화면 삭제
	return gfn_isFormUnload(obj);
}

/********************************************************************************
* 기      능   : 데이터셋 값 변경 시 - Flag 처리 
********************************************************************************/
function ds_list_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{
	gfn_changeFlag( obj, strColumnID, nRow, "FLAG" );
}

/********************************************************************************
* 기      능   : 입찰결과 상세 Div return
********************************************************************************/
function fn_get_div_obj(nRow) {

	var vAuart = ds_list.GetColumn(nRow,"AUART");
	var obj;
	
	//if(left(vAuart, 2) == "ZS") {
	if(left(vAuart, 2) == "ZS" || left(vAuart, 2) == "ZN"){
		return div_ses0180_ni;
	} else {
		return div_ses0180;
	}
}

function div_ses0180_ni_cb_bdcm_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{		
	if( obj.Value == "70" ) {
		if ( obj.id == "cb_bdcm2" ) {
			div_ses0180_ni.ed_bdcm2_t.Enable = true;
		} else if (obj.id == "cb_bdcm3" ) {
			div_ses0180_ni.ed_bdcm3_t.Enable = true;
		}
	} else {
		if ( obj.id == "cb_bdcm2" ) {
			div_ses0180_ni.ed_bdcm2_t.Value = "";
			div_ses0180_ni.ed_bdcm2_t.Enable = false;
		} else if (obj.id == "cb_bdcm3" ) {
			div_ses0180_ni.ed_bdcm3_t.Value = "";
			div_ses0180_ni.ed_bdcm3_t.Enable = false;
		}	
	}
	
}

function div_ses0180_ni_cb_zfrsn_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	if( obj.Value == "90" ) {
		div_ses0180_ni.ed_zfrsn_t.Value = "";
		div_ses0180_ni.ed_zfrsn_t.Enable = true;
	} else {
		div_ses0180_ni.ed_zfrsn_t.Value = "";
		div_ses0180_ni.ed_zfrsn_t.Enable = false;
		
		if(F_AUART == "ZS" && obj.Value == "50"){
			div_ses0180_ni.ed_zfrsn_t.Enable = true;
		}
	}	
}

function div_ses0180_ni_cb_zrmklist_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	if( obj.Value == "70" ) {
		div_ses0180_ni.ed_zrmk.Enable = true;
	} else {
		div_ses0180_ni.ed_zrmk.Enable = false;
	}		
}

function fn_afterQueryDD07T_ZSDDZFRSN(errCode, errMsg) {
	gfn_InsertRowCombo(ds_zfrsn, 0, "N", "Y");
	div_ses0180.cb_zfrsn.index = 0;
	div_ses0180_ni.cb_zfrsn.index = 0;
}

function div_ses0180_ni_bdamt_OnChar(obj,strPreText,nChar,strPostText,nLLParam,nHLParam)
{
	var lv_objNm = "";
	
	switch (obj.ID) {
	case "ed_sbdam" : 
		lv_objNm = "div_ses0180_ni.ed_sbderate";	break;
	case "ed_bdamt2" : 
		lv_objNm = "div_ses0180_ni.ed_bderate2";	break;
	case "ed_bdamt3" : 
		lv_objNm = "div_ses0180_ni.ed_bderate3";	break;
	default  : break;
	}
	
	if (strPostText != null && strPostText != "")
	{
		if (strPostText == 0)
		{
			object(lv_objNm).Value = 0;
		}
		else
		{
		
			object(lv_objNm).Value = toNumber(F_ZCOST)
									/ toNumber(strPostText)
									* 100;
			
			object(lv_objNm).Value = round(object(lv_objNm).Value, 1);

			if (ToNumber(object(lv_objNm).Value) > 999)
				object(lv_objNm).Value = 999;
		}
	}else
	{
		object(lv_objNm).Value = "";
	}
}

function div_ses0180_ni_ed_sbdam_OnChanged(obj,strText)
{
	Trace("div_ses0180_ni_ed_sbdam_OnChanged : " + strText );
}
]]></Script>
</Window>