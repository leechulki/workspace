<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="562" Id="Sbi0094" Left="8" OnLoadCompleted="fn_OnLoadCompleted" OnUnloadCompleted="fn_OnUnloadCompleted" PidAttrib="7" Title="사양별&#32;특성값&#32;지정" Top="8" Ver="1.0" Width="978" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_error">
				<Contents>
					<colinfo id="IDX" size="256" type="STRING"/>
					<colinfo id="ERRMSG" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond">
				<Contents>
					<colinfo id="MANDT" size="256" summ="default" type="STRING"/>
					<colinfo id="QTNUM" size="256" summ="default" type="STRING"/>
					<colinfo id="QTSER" size="256" summ="default" type="STRING"/>
					<colinfo id="QTSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="SUVSN" size="256" summ="default" type="STRING"/>
					<record>
						<MANDT></MANDT>
						<QTNUM></QTNUM>
						<QTSEQ></QTSEQ>
						<QTSER></QTSER>
						<SUVSN></SUVSN>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_suv_prh" OnColumnChanged="ds_suv_prh_OnColumnChanged">
				<Contents>
					<colinfo id="FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="MANDT" size="256" summ="default" type="STRING"/>
					<colinfo id="SUVSN" size="256" summ="default" type="STRING"/>
					<colinfo id="SUVPRH" size="256" summ="default" type="STRING"/>
					<colinfo id="PRH" size="256" summ="default" type="STRING"/>
					<colinfo id="CHGPRD" size="256" summ="default" type="STRING"/>
					<colinfo id="ATKLA" size="256" summ="default" type="STRING"/>
					<colinfo id="ITEMDIVNM" size="256" summ="default" type="STRING"/>
					<colinfo id="SUVPRHNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="SUVPRD" size="256" summ="default" type="STRING"/>
					<colinfo id="PRD" size="256" summ="default" type="STRING"/>
					<colinfo id="CALPRD" size="256" summ="default" type="STRING"/>
					<colinfo id="MODYPRD" size="256" summ="default" type="STRING"/>
					<colinfo id="MODYYSNO" size="256" summ="default" type="STRING"/>
					<colinfo id="INTYPE" size="256" summ="default" type="STRING"/>
					<colinfo id="PRHNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="OBJID" size="256" summ="default" type="STRING"/>
					<colinfo id="OBJINDEX" size="256" summ="default" type="STRING"/>
					<colinfo id="PRHYSNO" size="256" summ="default" type="STRING"/>
					<colinfo id="VIEWPRD" size="256" summ="default" type="STRING"/>
					<colinfo id="VIEWYSNO" size="256" summ="default" type="STRING"/>
					<colinfo id="SUVTYPE" size="256" summ="default" type="STRING"/>
					<colinfo id="ITEMDIV" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_template_prh">
				<Contents>
					<colinfo id="MANDT" size="256" summ="default" type="STRING"/>
					<colinfo id="PRH" size="256" summ="default" type="STRING"/>
					<colinfo id="PRHNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="PRD" size="256" summ="default" type="STRING"/>
					<colinfo id="ATKLA" size="256" summ="default" type="STRING"/>
					<colinfo id="OBJID" size="256" summ="default" type="STRING"/>
					<colinfo id="OBJINDEX" size="256" summ="default" type="STRING"/>
					<colinfo id="FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="VIEWPRD" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_template_rad">
				<Contents>
					<colinfo id="PRD" size="256" summ="default" type="STRING"/>
					<colinfo id="PRH" size="256" summ="default" type="STRING"/>
					<colinfo id="DIV" size="256" summ="default" type="STRING"/>
					<colinfo id="OBJID" size="256" summ="default" type="STRING"/>
					<colinfo id="OBJINDEX" size="256" summ="default" type="STRING"/>
					<colinfo id="ROWINDEX" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_floor">
				<Contents>
					<colinfo id="SUVPRH" size="256" summ="default" type="STRING"/>
					<colinfo id="CALPRD" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataObject="ds_suv_prh" DataSetType="Filter" FilterExpr="Length(PRH)&gt;0" Id="ds_prh"></Dataset>
		</Datasets>
		<Div Height="43" Id="div_btn" Left="3" TabOrder="1" Text="Div0" Url="WB01::CommBtnForm.xml" Width="973">
			<Contents></Contents>
		</Div>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_rap_cal" ImageID="btn_sub_09" Left="856" LeftMargin="12" OnClick="btn_rap_cal_OnClick" Style="sty_btn" TabOrder="2" Text="실측&#32;견적사양&#32;적용" Top="52" Transparent="TRUE" Width="112"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_rad_layout" ImageID="btn_sub_04" Left="785" LeftMargin="12" OnClick="btn_rad_layout_OnClick" Style="sty_btn" TabOrder="3" Text="연산수행" Top="52" Transparent="TRUE" Width="68"></Button>
		<Static Color="user8" Font="굴림,9" Height="13" Id="Static0" Left="8" TabOrder="4" Text="※&#32;리모델링LAYOUT&#32;클릭&#32;시&#32;영업사양값과&#32;실측값으로&#32;연산처리하여&#32;연산값&#32;생성,&#32;보정값(등록자에&#32;의해&#32;조정된값)&#32;" Top="56" Width="624"></Static>
		<Static Color="user8" Font="굴림,9" Height="13" Id="Static1" Left="8" TabOrder="5" Text="※&#32;영업사양값과&#32;보정값이&#32;다른&#32;사양에&#32;대해서&#32;영업사양값을&#32;보정값으로&#32;변경처리" Top="71" Width="624"></Static>
		<Static Color="user6" Font="굴림,9,Bold" Height="20" Id="Static19" Left="645" TabOrder="6" Text="견적사양" Top="91" VAlign="Middle" Width="254"></Static>
		<Image Height="19" Id="Image0" ImageID="form_bl_title_sub" Left="6" TabOrder="7" Top="88" Width="11"></Image>
		<Static Color="user6" Font="굴림,9,Bold" Height="20" Id="Static2" Left="16" TabOrder="8" Text="실측사양" Top="90" VAlign="Middle" Width="254"></Static>
		<Grid AutoFitEndLine="Hide" BindDataset="ds_prh" BkColor2="default" BoldHead="true" Border="Flat" Bottom="540" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="428" Id="Grid0" InputPanel="FALSE" Left="640" LineColor="user20" LineType="ExHORZ" OnMouseOver="Grid0_OnMouseOver" Right="972" RowHeight="20" Style="sty_grid" TabOrder="9" TabStop="true" Top="112" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="332">
			<contents>
				<format id="Default">
					<columns>
						<col width="30"/>
						<col width="73"/>
						<col width="135"/>
						<col width="73"/>
					</columns>
					<head>
						<cell align="center" col="0" color="user21" display="text" font="굴림,9" text="상태"/>
						<cell col="1" color="user21" display="text" font="굴림,9" text="그룹"/>
						<cell align="center" col="2" color="user21" display="text" font="굴림,9" text="사양명"/>
						<cell align="center" col="3" color="user21" display="text" font="굴림,9" text="영업사양값"/>
					</head>
					<body>
						<cell bkimageid='expr:fn_getFlagBkImageID(getColumn(currow,&#32;&quot;VIEWPRD&quot;),&#32;getColumn(currow,&#32;&quot;CHGPRD&quot;))' col="0" display="text"/>
						<cell align="center" bkcolor2="user22" col="1" colid="ATKLA" display="text"/>
						<cell align="left" bkcolor2="user22" col="2" colid="PRHNAME" display="text"/>
						<cell align="center" bkcolor2="user22" col="3" colid="CHGPRD" display="text"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Grid AutoFitEndLine="Hide" BindDataset="ds_suv_prh" BkColor2="default" BoldHead="true" Border="Flat" Bottom="540" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="428" Id="grd_rad_prh" InputPanel="FALSE" Left="8" LineColor="user20" LineType="ExHORZ" OnMouseOver="grd_rad_prh_OnMouseOver" Right="632" RowHeight="20" Style="sty_grid" TabOrder="10" TabStop="true" Top="112" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="624">
			<contents>
				<format id="Default">
					<columns>
						<col width="28"/>
						<col width="91"/>
						<col width="220"/>
						<col width="64"/>
						<col width="70"/>
						<col width="62"/>
						<col width="61"/>
					</columns>
					<head>
						<cell align="center" col="0" color="user21" display="text" font="굴림,9" text="상태"/>
						<cell col="1" color="user21" display="text" font="굴림,9" text="실측보고서"/>
						<cell align="center" col="2" color="user21" display="text" font="굴림,9" text="사양명"/>
						<cell align="center" col="3" color="user21" display="text" font="굴림,9" text="실측값"/>
						<cell align="center" col="4" color="user21" display="text" font="굴림,9" text="영업사양값"/>
						<cell align="center" col="5" color="user21" display="text" font="굴림,9" text="연산값"/>
						<cell align="center" col="6" color="user21" display="text" font="굴림,9" text="보정값"/>
					</head>
					<body>
						<cell bkimageid='expr:gfn_getFlagBkImageID(getColumn(currow,&#32;&quot;FLAG&quot;))' col="0" display="text"/>
						<cell align="center" bkcolor2="user22" col="1" colid="ITEMDIVNM" display="text"/>
						<cell align="left" bkcolor2="user22" col="2" colid="PRHNAME" display="text"/>
						<cell align="center" bkcolor2="user22" col="3" colid="SUVPRD" display="text"/>
						<cell align="center" bkcolor2="user22" col="4" colid="VIEWPRD" display="text"/>
						<cell align="center" bkcolor2="user22" col="5" colid="CALPRD" display="text"/>
						<cell align="center" bkcolor2="user22" col="6" colid="MODYPRD" display="text" wordwrap="allchar"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_rad_h" ImageID="btn_sub_07" Left="677" LeftMargin="12" OnClick="btn_rad_h_OnClick" Style="sty_btn" TabOrder="11" Text="리모델링층별사양" Top="52" Transparent="TRUE" Width="112"></Button>
		<Image Height="19" Id="Image1" ImageID="form_bl_title_sub" Left="633" TabOrder="12" Top="88" Width="11"></Image>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_tdwg" ImageID="btn_sub_04" Left="906" LeftMargin="12" OnClick="btn_tdwg_OnClick" Style="sty_btn" TabOrder="13" Text="도면생성" Top="76" Transparent="TRUE" Visible="FALSE" Width="61"></Button>
	</Form>
	<Script><![CDATA[/*
 ******************************************************************************************
 * 기      능   : 리모델링 실측값 적용
 * 작  성  자   : 홍길동
 * 작성  일자   : 
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */   
#include "LIB::commons.js";    // 공통 스크립트 
#include "LIB::nsfRequest.js";    // 공통 스크립트 
#include "LIB::common_hdel.js";    // 공통 스크립트  /* GNY 추가 */
//=========================================================================================
// [ PART 1 ]
// Form에서 사용될 전역변수를 선언
// FORM에서 사용되는 전역변수는 대문자로 작성하며, F_XXX 의 형태를 갖도록 한다. 
//=========================================================================================
var F_TITLE = "리모델링 실측 견적사양 적용";
var SUVSN       = "";
var SUVYSNO     = "N";

// 견적/수주 실측적용상태
var FLOORYSNO  = "N";  // 리모델링층별사양 실행여부 
var LAYOUTYSNO = "N";  // 리모델링LAYOUT 실행여부
var APPLYYSNO  = "N";  // 실측값 견적사양 적용여부

//=========================================================================================
// [ PART 2 ]
// Form Loading / Unloading 시 작업 정의
//=========================================================================================
function fn_OnLoadCompleted(obj) {
    // 팝업 버튼 적용
    div_btn.fn_loadUseBtn("900", F_TITLE, "", "");
    gfn_initForm();
    fn_init_form() ;
}

/********************************************************************************
* 기      능   : form UnloadCompleted 
********************************************************************************/
function fn_OnUnloadCompleted(obj) {
    return gfn_isFormUnload(obj);
}

/********************************************************************************
* 기      능   : 폼 초기화
********************************************************************************/
function fn_init_form() {
    // 보정값 그리드 수정가능 컬럼 정의
    grd_rad_prh.SetCellProp("body", 6, "bkColor", "expr:iif(MODYYSNO == 'Y' && Length(SUVSN)>0, '#E4EDF4', 'default')");
    grd_rad_prh.SetCellProp("body", 6, "bkColor2", "expr:iif(MODYYSNO == 'Y' && Length(SUVSN)>0, '#E4EDF4', 'default')");
    // 보정값 수정 여부 정의
    grd_rad_prh.SetCellProp("body", 6, "edit", "expr:iif(MODYYSNO == 'Y' && Length(SUVSN)>0, 'normal', 'none')");

    // 실측값 등록여부를 판단한다.
    var currRow = parent.ds_detail.currow;
    var qtseq = parent.ds_detail.GetColumn(currRow, "QTSEQ");
    ds_cond.SetColumn(0, "QTNUM", parent.ds_detail.GetColumn(currRow, "QTNUM"));
    ds_cond.SetColumn(0, "QTSER", parent.ds_detail.GetColumn(currRow, "QTSER"));
    ds_cond.SetColumn(0, "QTSEQ", parent.ds_detail.GetColumn(currRow, "QTSEQ"));

    // 쿼리 날리기 전에 화면 호기별 원본데이터를 가지고 있자.
    var nRow = -1;
    var obj_template;
    ds_template_prh.ClearData();
    for (var a=0; a<=6; a++) {
        switch (a) {
            case 0    : obj_template = object(parent.ds_template0.ID); break;
            case 1    : obj_template = object(parent.ds_template1.ID); break;
            case 2    : obj_template = object(parent.ds_template2.ID); break;
            case 3    : obj_template = object(parent.ds_template3.ID); break;
            case 4    : obj_template = object(parent.ds_template4.ID); break;
            case 5    : obj_template = object(parent.ds_template5.ID); break;
            case 6    : obj_template = object(parent.ds_template6.ID); break;
            default : break;
        }

        for (var i=0; i< obj_template.GetRowCountNF(); i++) {
            if(qtseq == obj_template.GetColumnNF(i, "QTSEQ")) {
				nRow = ds_template_prh.AddRow();
				ds_template_prh.SetColumn(nRow, "MANDT"  , Trim(obj_template.GetColumnNF(i, "MANDT"  )));
				ds_template_prh.SetColumn(nRow, "ATKLA"  , Trim(obj_template.GetColumnNF(i, "ATKLA"  )));
				ds_template_prh.SetColumn(nRow, "PRH"    , Trim(obj_template.GetColumnNF(i, "PRH"    )));
				ds_template_prh.SetColumn(nRow, "PRHNAME", Trim(obj_template.GetColumnNF(i, "PRHNAME")));
				ds_template_prh.SetColumn(nRow, "PRD"    , Trim(obj_template.GetColumnNF(i, "PRD"    )));
				ds_template_prh.SetColumn(nRow, "VIEWPRD", Trim(obj_template.GetColumnNF(i, "PRD"    )));
	
				// 추가
				ds_template_prh.SetColumn(nRow, "OBJID",    obj_template.ID);
				ds_template_prh.SetColumn(nRow, "OBJINDEX", i);
            }
        }
    }
    
    // 실측사양을 조회한다.
    fn_query();
    
    // 도면생성 버튼은 TEST12 계정만 화면에 표시되로록 처리한다.
    if(G_USER_ID == 'TEST12') {
        btn_tdwg.Visible = true;
    }
}

//=========================================================================================
// [ PART 3 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,form닫기)
//=========================================================================================
function fn_OnClick_btn(obj)
{
    var fncName = "fn_" + substr(obj.id, 4); 
    eval( fncName + "()");
}

/********************************************************************************
* 기      능   : 견적서 리모델링 실측사양 조회
********************************************************************************/
function fn_query() {
    var svcId     = "findEstSuvList";
    var svcUrl    = "radSurveyC/findEstSuvList";
    var inDsList  = "ds_cond=ds_cond ds_suv_prh=ds_suv_prh";
    var outDsList = "ds_error=ds_error SUVYSNO=SUVYSNO ds_suv_prh=ds_suv_prh";
    var inParam   = "";
    var callBackFunc = "fn_afterQuery";

    ds_error.ClearData();
    fn_createWait("",this);
    ds_suv_prh.ClearData();
    nsfRequest(svcId, svcUrl, inDsList, outDsList, inParam, callBackFunc);
}

/********************************************************************************
* 기      능   : 액셀  
********************************************************************************/
function fn_excel() {
    fn_createWait("",this);
}

/********************************************************************************
* 기      능   : 확인  
********************************************************************************/
function fn_confirm() {
    fn_createWait("",this);
}

/********************************************************************************
* 기      능   : 닫기  
********************************************************************************/
function fn_close() {
    // 변경상태가 있는지 체크
    var isChg = false;
    for(var i=0; i < ds_prh.GetRowCount(); i++) {
        if(ds_prh.GetColumn(i, "FLAG") == "U") {
            isChg = true;
            break;
        }
    }
    
    if(isChg) {
        if(gfn_showConfirm("실측값 견적사양 적용건이 존재합니다. 팝업화면을 닫으시겠습니까?") == false) {
            return;
        }
    }
    
    var varArray = Array(3);
    varArray[0] = FLOORYSNO;
    varArray[1] = LAYOUTYSNO;
    varArray[2] = APPLYYSNO;
    this.close(varArray);
}

/********************************************************************************
* 기      능   : 리모델링 실측 연산값을 저장한다.
********************************************************************************/
function fn_save() {
    var svcId     = "radCalApply";
    var svcUrl    = "radSurveyC/radCalApply";
    var inDsList  = "ds_suv_prh=ds_suv_prh";
    var outDsList = "ds_error=ds_error";
    var inParam   = " SUVSN='"+SUVSN+"'";
    var callBackFunc = "fn_afterSave";
    var findRow = -1;
    fn_createWait("",this);
    ds_error.ClearData();
    nsfRequest(svcId, svcUrl, inDsList, outDsList, inParam, callBackFunc);
} 

/********************************************************************************
* 기      능   : 저장 입력값 체크
********************************************************************************/
function fn_save_validate() {
    var isValidate = true;
    return isValidate;
}

//=========================================================================================
// [ PART 4]
// Callback 함수 정의 : callback 함수명은 메인 함수의 fn_xxxx() 에서 xxxx 부분은 fn_afterXXXX()
// 형태가 되도록 작성 
//=========================================================================================
/********************************************************************************
* 기      능   : 조회 Callback  
********************************************************************************/
function fn_afterQuery(svcId, errCode, errMsg) {
    if(ds_error.rowcount > 0)    {
        fn_destroyWait();
        gfn_showAlert(ds_error.GetColumn(0,"ERRMSG"));
        return;
    } else  {
		if(SUVYSNO == "N") {
			gfn_openMsgWin("등록된 실측값이 없습니다.", "", "A", "알림");
	        fn_destroyWait();
			fn_close();
		} else {
			//trace("ds_suv_prh:"+ds_suv_prh.SaveXML());
			// 조회된 영업사양값을 화면에서 변경된 값으로 변경한다.
			var findRow = -1;
			var prh;
			var prd;
			for(var i=0; i < ds_suv_prh.GetRowCount(); i++) {
			    prh = ds_suv_prh.GetColumn(i, "PRH");
			    if(Length(prh) > 0) {
			        findRow = ds_template_prh.FindRow("PRH", prh);
			        if(findRow > -1) {
			            prd = ds_template_prh.GetColumn(findRow, "PRD");
			            ds_suv_prh.SetColumn(i, "VIEWPRD", prd);
			        }
			    }
			    setCalModyChgPrh(i);
				ds_suv_prh.SetColumn(i, "OBJID", ds_template_prh.GetColumn(findRow, "OBJID"));
				ds_suv_prh.SetColumn(i, "OBJINDEX", ds_template_prh.GetColumn(findRow, "OBJINDEX"));
			}
		}
        fn_destroyWait();
    }
}

/********************************************************************************
* 기      능   : 변경상태 처리
********************************************************************************/
function setCalModyChgPrh(row) {
    var suvprh  = ds_suv_prh.GetColumn(row, "SUVPRH");
    var suvPrd  = ds_suv_prh.GetColumn(row, "SUVPRD");
    var calPrd  = ds_suv_prh.GetColumn(row, "CALPRD");
    var modyPrd = ds_suv_prh.GetColumn(row, "MODYPRD");
    var prd     = ds_suv_prh.GetColumn(row, "PRD");
    var chgPrd  = ds_suv_prh.GetColumn(row, "CHGPRD");
    var prhYsno = ds_suv_prh.GetColumn(row, "PRHYSNO");
    
    // 데이터 변경 발생 시 처리
    if(Length(suvPrd) == 0) { suvPrd = ""; }
    if(Length(calPrd) == 0) { calPrd = ""; }
    if(Length(modyPrd) == 0) { modyPrd = ""; }
    if(Length(prd) == 0) { prd = ""; }
    if(Length(chgPrd) == 0) { chgPrd = ""; }
    
    if(prhYsno == "Y") {
		if(IndexOf(suvprh, "ELR_C_EF") > -1) {
		    ds_suv_prh.SetColumn(row, "CHGPRD", calPrd);
		} else {
			// 영업사양값이 변경되어야 하는 경우
			// chgprd 변경값 처리
			if(modyPrd != "") {
				if(chgPrd != modyPrd) {
					ds_suv_prh.SetColumn(row, "CHGPRD", modyPrd);
				}
			} else {
				if(calPrd != "") {
					if(chgPrd != calPrd) {
						ds_suv_prh.SetColumn(row, "CHGPRD", calPrd);
					}
				} else {
					if(chgPrd != suvPrd) {
						ds_suv_prh.SetColumn(row, "CHGPRD", suvPrd);
					}
				}
			}
		}
    }
}

/********************************************************************************
* 기      능   : 저장 Callback  
********************************************************************************/
function fn_afterSave(svcId, errCode, errMsg) {
    if(ds_error.rowcount > 0)    {
        gfn_showAlert(ds_error.GetColumn(0,"ERRMSG"));
        APPLYYSNO  = "N";
        fn_destroyWait();
        return;
    } else {
        // 실측값 견적사양 적용 후 처리
		var objId;
		var objIndex;
		var chgPrd;
		var chgCnt = 0;
		var prhysno;
		var prd;
		var obj_template;
		for(var i=0; i < ds_prh.GetRowCount(); i++) {
			prhysno  = ds_prh.GetColumn(i, "PRHYSNO");
			if(prhysno == "Y") {
				objId    = ds_prh.GetColumn(i, "OBJID");
				objIndex = ds_prh.GetColumn(i, "OBJINDEX");
				chgPrd   = ds_prh.GetColumn(i, "CHGPRD");
                switch (objId) {
                    case "ds_template0" : obj_template = parent.ds_template0; break;
                    case "ds_template1" : obj_template = parent.ds_template1; break;
                    case "ds_template2" : obj_template = parent.ds_template2; break;
                    case "ds_template3" : obj_template = parent.ds_template3; break;
                    case "ds_template4" : obj_template = parent.ds_template4; break;
                    case "ds_template5" : obj_template = parent.ds_template5; break;
                    case "ds_template6" : obj_template = parent.ds_template6; break;
                    default : break;
                }				
				prd = obj_template.GetColumnNF(objIndex, "PRD");
				if(prd != chgPrd) {
                    if(Length(prd) == 0 && Length(chgPrd) == 0) {
                    } else {
						//trace("PRHNAME:"+ds_prh.GetColumn(i, "PRHNAME")+", prd:"+prd+", chgPrd:"+chgPrd);
						// 필터적용하지 않은 index로 적용한다.
						obj_template.SetColumnNF(objIndex, "PRD", chgPrd);
						chgCnt = chgCnt + 1;
                    }
				}
			}
		}
		APPLYYSNO = "Y";
		// 메시지 처리
        gfn_openMsgWin("실측 견적사양이 적용 되었습니다.", "", "A", "알림");
        fn_destroyWait();
        
        var varArray;
        if(chgCnt > 0) {
			varArray = Array(3);
			varArray[0] = FLOORYSNO;
			varArray[1] = LAYOUTYSNO;
			varArray[2] = APPLYYSNO;
        } else {
			varArray = Array(3);
			varArray[0] = FLOORYSNO;
			varArray[1] = LAYOUTYSNO;
			varArray[2] = APPLYYSNO;
			// 실측값 적용 후 저장여부 체크
			varArray[3] = "Y";
        }
		this.close(varArray);
    }
}

//=========================================================================================
// [ PART 5]
// 화면 UI 함수
//=========================================================================================
/********************************************************************************
* 기      능   : 리모델링층별사양 팝업 호출
********************************************************************************/
function btn_rad_h_OnClick(obj)
{
    var arg  = "SUVSN="+quote(SUVSN);
    var arr  = gfn_openPopUpUrlHdel("SES::Ses0031H.xml", true, arg);
    if(Length(arr) > 0) {
        FLOORYSNO = arr;
        if(FLOORYSNO == "Y") {
            // 실측사양 재조회 처리
            //fn_query();
            // 그리드를 다시 그린다.
            Grid0.Redraw = true;
        }
    }
}

/********************************************************************************
* 기      능   : 리모델링LAYOUT을 실행한다.
********************************************************************************/
function btn_rad_layout_OnClick(obj)
{
    // 호기별 영업사양 + 호기별 실측사양 입력값을 생성한다.
    // ds_template: 호기별영업사양, ds_suv_prh: 호기별실측사양
    // ZEL2: AUTOLAYOUT PRH ds_template_rad
    fn_createWait("",this);
    var cond = "strGtype=" + quote("ZEL6") + " strZflg='Q'";

    // 입력데이터 생성
    fn_makeRadInput();
    //trace("ds_template_rad input:"+ds_template_rad.SaveXML());

    ds_error.ClearData();
    nsfRequest(   "radLayoutDuty"
                , "dutyN/dependDutySingleMo"
                , "ds_template1=ds_template_rad"
                , "ds_template_rad=ds_template1 ds_error=ds_error"
                , cond
                , "btn_rad_layout_callback"
               );
}

/********************************************************************************
* 기      능   : 리모델링LAYOUT을 입력 데이터를 생성한다.
********************************************************************************/
function fn_makeRadInput() {
    ds_template_rad.ClearData();
    var nRow = -1;
    var findRow = -1;
    // 영업사양 데이터 생성
    for(var i=0; i < ds_template_prh.GetRowCount(); i++) {
        nRow = ds_template_rad.AddRow();
        ds_template_rad.SetColumn(nRow, "PRH", ds_template_prh.GetColumn(i, "PRH"));
        ds_template_rad.SetColumn(nRow, "PRD", ds_template_prh.GetColumn(i, "VIEWPRD"));
        // 화면에서 이미 변경된 영업사양값 적용
        ds_template_rad.SetColumn(nRow, "DIV", "1");
        ds_template_rad.SetColumn(nRow, "OBJID", ds_template_prh.GetColumn(i, "OBJID"));
        ds_template_rad.SetColumn(nRow, "OBJINDEX", ds_template_prh.GetColumn(i, "OBJINDEX"));
        ds_template_rad.SetColumn(nRow, "ROWINDEX", i);
    }

    // 값을 보정해주자
    // EL_ECWBG, 
    findRow = ds_template_rad.FindRow("PRH", "EL_ECWBG");
    if(findRow>-1) {
        if(Length(ds_template_prh.GetColumn(findRow, "VIEWPRD")) == 0) {
		    ds_template_rad.SetColumn(findRow, "PRD", "N");
        }
    }

    // EL_DCRG
    findRow = ds_template_rad.FindRow("PRH", "EL_DCRG");
    if(findRow>-1) {
        if(Length(ds_template_prh.GetColumn(findRow, "VIEWPRD")) == 0) {
		    ds_template_rad.SetColumn(findRow, "PRD", "N");
        }
    }

    // EL_DCWFRM -> 값이 없으면 N
    findRow = ds_template_rad.FindRow("PRH", "EL_DCWFRM");
    if(findRow>-1) {
        if(Length(ds_template_prh.GetColumn(findRow, "VIEWPRD")) == 0) {
		    ds_template_rad.SetColumn(findRow, "PRD", "N");
        }
    }

    // EL_DCWRIL -> 값이 없으면 N
    findRow = ds_template_rad.FindRow("PRH", "EL_DCWRIL");
    if(findRow>-1) {
        if(Length(ds_template_prh.GetColumn(findRow, "VIEWPRD")) == 0) {
		    ds_template_rad.SetColumn(findRow, "PRD", "N");
        }
    }
    
    // EL_DAUSE -> 값이 없으면 N
    findRow = ds_template_rad.FindRow("PRH", "EL_DAUSE");
    if(findRow>-1) {
        if(Length(ds_template_prh.GetColumn(findRow, "VIEWPRD")) == 0) {
		    ds_template_rad.SetColumn(findRow, "PRD", "N");
        }
    }
    
    // EL_DAMAN -> 값이 없으면 N
    findRow = ds_template_rad.FindRow("PRH", "EL_DAMAN");
    if(findRow>-1) {
        if(Length(ds_template_prh.GetColumn(findRow, "VIEWPRD")) == 0) {
		    ds_template_rad.SetColumn(findRow, "PRD", "N");
        }
    }

    // EL_DACAPA -> 값이 없으면 N
    findRow = ds_template_rad.FindRow("PRH", "EL_DACAPA");
    if(findRow>-1) {
        if(Length(ds_template_prh.GetColumn(findRow, "VIEWPRD")) == 0) {
		    ds_template_rad.SetColumn(findRow, "PRD", "N");
        }
    }

    // EL_DAOPEN -> 값이 없으면 N
    findRow = ds_template_rad.FindRow("PRH", "EL_DAOPEN");
    if(findRow>-1) {
        if(Length(ds_template_prh.GetColumn(findRow, "VIEWPRD")) == 0) {
		    ds_template_rad.SetColumn(findRow, "PRD", "N");
        }
    }

    // EL_DASPD -> 값이 없으면 N
    findRow = ds_template_rad.FindRow("PRH", "EL_DASPD");
    if(findRow>-1) {
        if(Length(ds_template_prh.GetColumn(findRow, "VIEWPRD")) == 0) {
		    ds_template_rad.SetColumn(findRow, "PRD", "N");
        }
    }

    // EL_DAFQ -> 값이 없으면 N
    findRow = ds_template_rad.FindRow("PRH", "EL_DAFQ");
    if(findRow>-1) {
        if(Length(ds_template_prh.GetColumn(findRow, "VIEWPRD")) == 0) {
		    ds_template_rad.SetColumn(findRow, "PRD", "N");
        }
    }
    
    // EL_DJM
    findRow = ds_template_rad.FindRow("PRH", "EL_DJM");
    if(findRow>-1) {
        if(Length(ds_template_prh.GetColumn(findRow, "VIEWPRD")) == 0) {
		    ds_template_rad.SetColumn(findRow, "PRD", "N");
        }
    }

    // EL_DCARIL
    findRow = ds_template_rad.FindRow("PRH", "EL_DCARIL");
    if(findRow>-1) {
        if(Length(ds_template_prh.GetColumn(findRow, "VIEWPRD")) == 0) {
		    ds_template_rad.SetColumn(findRow, "PRD", "N");
        }
    }

    // EL_DMCB
    findRow = ds_template_rad.FindRow("PRH", "EL_DMCB");
    if(findRow>-1) {
        if(Length(ds_template_prh.GetColumn(findRow, "VIEWPRD")) == 0) {
		    ds_template_rad.SetColumn(findRow, "PRD", "N");
        }
    }

    // 실측사양 데이터 생성
    var suvprd;
    var calprd;
    var modyprd;
    for(var i=0; i < ds_suv_prh.GetRowCountNF(); i++) {
        nRow = ds_template_rad.AddRow();
        suvprd = ds_suv_prh.GetColumnNF(i, "SUVPRD");
        calprd = ds_suv_prh.GetColumnNF(i, "CALPRD");
        modyprd = ds_suv_prh.GetColumnNF(i, "MODYPRD");
        ds_template_rad.SetColumn(nRow, "PRH", ds_suv_prh.GetColumnNF(i, "SUVPRH"));
        // 실측보정사양값 입력
        // 화면에서는 보정사양값이 있으면 보정사양값 다음은 연산식 다음은 실측값을 적용한다.
        // 만약 보정값이 존재하면 실측치 대신 보정갑을 입력값으로 사용한다.
        if(Length(modyprd) > 0) {
            ds_template_rad.SetColumn(nRow, "PRD", modyprd);
        } else {
            ds_template_rad.SetColumn(nRow, "PRD", suvprd);
        }
        ds_template_rad.SetColumn(nRow, "DIV", "2");
        ds_template_rad.SetColumn(nRow, "OBJID", ds_suv_prh.ID);
        ds_template_rad.SetColumn(nRow, "OBJINDEX", i);
        // 실측사양 데이터 인덱스 생성
        ds_template_rad.SetColumn(nRow, "ROWINDEX", i);
    }
    
    //trace("ds_template_rad:"+ds_template_rad.SaveXML());
    
}

/********************************************************************************
* 기      능   : 리모델링LAYOUT을 CallBack 함수
********************************************************************************/
function btn_rad_layout_callback()
{
    // 단일 체크 메시지 출력
    fn_destroyWait();
    var prd;
    if(ds_error.rowcount > 0)    {
        gfn_showAlert(ds_error.GetColumn(0,"ERRMSG"));
        LAYOUTYSNO = "N";
        return;
    } else {
        // 만약 에러가 발생하지 않으면 변경된 데이터를 반영한다.
        //trace("ds_template_rad result:"+ds_template_rad.SaveXML());
        // 리모델링LAYOUT에 의해서 생성된 연산값이 존재하면 연산값과 보정값을 변경해 준다.
        // 임의로 값을 변경함
        var div;
        var prd;
        var index;
        var suvprd;
        var calprd;
        var suvtype;
        var itemdiv; // ITEMDIV CS:층고, EE:승장, ED:승장도어
        var prh;
        for(var i=0; i < ds_template_rad.GetRowCount(); i++) {
            div = ds_template_rad.GetColumn(i, "DIV");
            prd = ds_template_rad.GetColumn(i, "PRD");
            prh = ds_template_rad.GetColumn(i, "PRH");
            index = ds_template_rad.GetColumn(i, "ROWINDEX");
            if(div == "2") {
                suvprd = ds_suv_prh.GetColumnNF(index, "SUVPRD");
                calprd = ds_suv_prh.GetColumnNF(index, "CALPRD");
                suvtype = ds_suv_prh.GetColumnNF(index, "CALPRD");
                itemdiv = ds_suv_prh.GetColumnNF(index, "ITEMDIV");
				if(itemdiv != "CS" && itemdiv != "EE" && itemdiv != "ED") {
					//trace("prh:"+ds_template_rad.GetColumn(i, "PRH")+", suvprh:"+ds_suv_prh.GetColumnNF(index, "SUVPRH")+", prd:"+prd+", calprd:"+calprd+", suvprd:"+suvprd);
					if(Length(suvprd) == 0) { suvprd = ""; }
					if(Length(prd) == 0) { prd = ""; }
					
					//if(Length(calprd) > 0 && suvprd != "" && IndexOf(prh, "ELR_C_EF") < 0 && prh != "ELR_C_EHP") {
					if(Length(calprd) > 0) {
						// 연산식 초기화
						ds_suv_prh.SetColumnNF(index, "CALPRD", "");
					}
					// 정상적인 처리가 되었으면 연산값을 입력한다.
					// 연산식값은 실측치와 연산값이 다른경우에 값을 입력처리한다.
					if(suvprd != prd) {
						ds_suv_prh.SetColumnNF(index, "CALPRD", prd);
					}
				}
            }
        }
        LAYOUTYSNO = "Y";

        // 별도 체크 조건 추가
        // 실측치에 조명전원이 선택 안되었을 경우. 견적 or 수주 화면에서 에러만 생성하여 경고만 하고 후속 진행 가능 토록 수정 바랍니다.
        var msg = "";
        var ELR_M_LIV;
        var EL_ECWTP;
        var ELR_H_H;
        var ELR_H_J;
        var EL_EOPBP;
        findRow = ds_template_rad.FindRow("PRH", "ELR_M_LIV");
        if(findRow > -1)  {
            ELR_M_LIV = ds_template_rad.GetColumn(findRow, "PRD");
            if(ELR_M_LIV == "N") {
                msg = msg + "리모델링 실측결과 기계실에 조명전원이 없습니다.";
            }
        }

        // 후락인 경우 승강로 실측치 H, J 가 일치 하지 않을 경우. 견적 or 수주에서 [ H,J 값이 일치 하지 않습니다. ] 의 경고 문구만 생성하여 표시 후 후속 진행 가능 토록 수정 바랍니다.
        findRow = ds_template_rad.FindRow("PRH", "EL_ECWTP");
        if(findRow > -1)  {
            EL_ECWTP = ds_template_rad.GetColumn(findRow, "PRD");
        }

        if(EL_ECWTP == "R") {
			findRow = ds_template_rad.FindRow("PRH", "ELR_H_H");
			if(findRow > -1)  {
				ELR_H_H = ds_template_rad.GetColumn(findRow, "PRD");
			}
			findRow = ds_template_rad.FindRow("PRH", "ELR_H_J");
			if(findRow > -1)  {
				ELR_H_J = ds_template_rad.GetColumn(findRow, "PRD");
			}
			
			//  연산식 10mm 이상인 경우 메시지 출력
			if((toNumber(ELR_H_H) - toNumber(ELR_H_J)) > 10 || (toNumber(ELR_H_H) - toNumber(ELR_H_J)) < -10) {
				msg = msg + "\nH,J 값이 일치 하지 않습니다.";
			}
        }

	    // 영업사양 OPB위치 확인요망 -> EL_EOPBP 
        findRow = ds_template_rad.FindRow("PRH", "EL_EOPBP");
        if(findRow > -1)  {
            EL_EOPBP = ds_template_rad.GetColumn(findRow, "PRD");
            if(EL_EOPBP != "R") {
                msg = msg + "\n영업사양 E064 \OPB 위치값을 확인해 주세요";
            }
        }
	    
        // ELC_E_PNLH
        findRow = ds_suv_prh.FindRow("SUVPRH", "ELC_E_PNLHDEGR");
        if(findRow > -1)  {
            if(ds_suv_prh.GetColumn(findRow, "CALPRD") != "0") {
                msg = msg + "\n실측값으로 1개 이상의 승장도어판넬높이값이 존재합니다.";
            }
        }

	    //(실측치CA-실측치JJ) / 2 와 일치 여부 검토 ( 오차 10mm )
		var H_CA; 
		var H_W1;
		var H_JJ;
		findRow = ds_suv_prh.FindRow("SUVPRH", "ELR_H_CA");
        if(findRow > -1)  {
            H_CA = parseInt(ds_suv_prh.GetColumn(findRow, "SUVPRD"));
        }
		findRow = ds_suv_prh.FindRow("SUVPRH", "ELR_H_W1");
        if(findRow > -1)  {
            H_W1 = parseInt(ds_suv_prh.GetColumn(findRow, "SUVPRD"));
        }
		findRow = ds_suv_prh.FindRow("SUVPRH", "ELR_H_JJ");
        if(findRow > -1)  {
            H_JJ = parseInt(ds_suv_prh.GetColumn(findRow, "SUVPRD"));
        }

        if(abs(H_W1- ((H_CA - H_JJ)/2)) > 10) {
            msg = msg + "\nW1값이 (CA - JJ) / 2 결과 와 10mm 이상 차이["+abs(H_W1- ((H_CA - H_JJ)/2))+"]가 납니다.";
		}
	    
        if(Length(msg)>0) {
            gfn_openMsgWin(msg, "", "A", "오류경고");
        }        
    }
}

/********************************************************************************
* 기      능   : 실측값 견적사양 적용
********************************************************************************/
function btn_rap_cal_OnClick(obj)
{
    // 실측값 견적사양 적용을 위해서는 반드시
    // 리모델링층별사양 확인하고 리모델링LAYOUT 실행이 사전에 처리 되어야 한다.
    if(FLOORYSNO == "N") {
        gfn_openMsgWin("리모델링 층별사양 전개결과를 확인해 주십시요", "", "A", "알림");
        return;
    }

    if(LAYOUTYSNO == "N") {
        gfn_openMsgWin("연산수행 기능을 수행해 주십시요", "", "A", "알림");
        return;
    }

    if(gfn_showConfirm("실측값 견적사양을 적용하시겠습니까?") == true) {
        // 실측 테이블에 해당 데이터를 적용시킨다.
        fn_save();
    }
}

/********************************************************************************
* 기      능   : 실측사양 TOOL팁 정의
********************************************************************************/
function grd_rad_prh_OnMouseOver(obj,nPosX,nPosY,nRow,nCell,nPivotIndex)
{
    if(nCell == 2) {
        obj.ToolTipText = obj.GetCellText('Body', nRow, nCell);
    } else {
        obj.ToolTipText = "";
    }
}

/********************************************************************************
* 기      능   : 견적사양 TOOL팁 정의
********************************************************************************/
function Grid0_OnMouseOver(obj,nPosX,nPosY,nRow,nCell,nPivotIndex)
{
    if(nCell == 2) {
        obj.ToolTipText = obj.GetCellText('Body', nRow, nCell);
    } else {
        obj.ToolTipText = "";
    }
}

/********************************************************************************
* 기      능   : 실측사양 데이터 변경 시 상태 플래그 변경
********************************************************************************/
function ds_suv_prh_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{
    if (varNewValue != varOldValue) {
        if(strColumnID == "CALPRD" || strColumnID == "MODYPRD") {
            //trace("strColumnID:"+strColumnID+", varNewValue:"+varNewValue);
            gfn_changeFlag( obj, strColumnID, nRow, "FLAG");
            setCalModyChgPrh(nRow);
        }
    }
}

/********************************************************************************
* 기      능   : 견적사양 변경 이미지 처리
********************************************************************************/
function fn_getFlagBkImageID(prd, chgPrd) {
    var bkImg = "";
    if(Length(prd) == 0) prd = "";
    if(Length(chgPrd) == 0) chgPrd = "";
    
	if(prd != chgPrd) {
		bkImg = "icon_grid_modify";
	}
    return bkImg;
}

/********************************************************************************
* 기      능   : 도면일괄생성 처리
********************************************************************************/
function btn_tdwg_OnClick(obj)
{
    var svcId     = "radFloorCalApply";
    var svcUrl    = "radSurveyC/radFloorCalApply";
    var inDsList  = "ds_template_floor=ds_template_prh ds_suv_prh=ds_suv_prh ds_floor=ds_floor ds_template1=ds_template_rad";
    var outDsList = "FLOORYSNO=FLOORYSNO LAYOUTYSNO=LAYOUTYSNO ds_error=ds_error ds_floor=ds_floor ds_template_rad=ds_template1";
    var inParam   = " SUVSN='"+SUVSN+"' "+"strGtype=" + quote("ZEL6") + " strZflg='Q'";
    var callBackFunc = "fn_afterRadFloorCalApply";

    ds_error.ClearData();
    ds_floor.ClearData();

    // 연산로직 처리를 위한 입력데이터를 생성한다.
    fn_makeRadInput();

    // 전체일괄처리를 수행한다.
    nsfRequest(svcId, svcUrl, inDsList, outDsList, inParam, callBackFunc);
}


/********************************************************************************
* 기      능   : 도면일괄생성 처리 Callback  
********************************************************************************/
function fn_afterRadFloorCalApply(svcId, errCode, errMsg) {
	if(ds_error.rowcount > 0)	{
		gfn_showAlert(ds_error.GetColumn(0,"ERRMSG"));
        fn_destroyWait();
		return;
	} else {
	    // 층별 연산 데이터 처리
        var suvprh;
        for(var i=0; i < ds_suv_prh.GetRowCountNF(); i++) {
            suvprh = ds_suv_prh.GetColumnNF(i, "SUVPRH");
            if(IndexOf(suvprh, "ELR_C_EF") > -1) {
                ds_suv_prh.SetColumnNF(i, "CALPRD", "");
            }
        }
	
        var findRow = -1;
        var calprd;
        for(var i=0; i < ds_floor.GetRowCount(); i++) {
            suvprh = ds_floor.GetColumn(i, "SUVPRH");
            calprd = ds_floor.GetColumn(i, "CALPRD");
			findRow = ds_suv_prh.FindRowNF("SUVPRH", suvprh);
			if(findRow > -1) {
				ds_suv_prh.SetColumnNF(findRow, "CALPRD", calprd);
			}
        }
        
	    // 연산 데이터 처리
	    btn_rad_layout_callback();
        
        // 변경데이터가 존재하면 변경데이터 저장 후 도면생성 처리를 수행하게 한다.
        // 실측값 견적사양 적용 후 처리
		var objId;
		var objIndex;
		var chgPrd;
		var chgCnt = 0;
		var prhysno;
		var prd;
		var obj_template;
		for(var i=0; i < ds_prh.GetRowCount(); i++) {
			prhysno  = ds_prh.GetColumn(i, "PRHYSNO");
			if(prhysno == "Y") {
				objId    = ds_prh.GetColumn(i, "OBJID");
				objIndex = ds_prh.GetColumn(i, "OBJINDEX");
				chgPrd   = ds_prh.GetColumn(i, "CHGPRD");
                switch (objId) {
                    case "ds_template0" : obj_template = parent.ds_template0; break;
                    case "ds_template1" : obj_template = parent.ds_template1; break;
                    case "ds_template2" : obj_template = parent.ds_template2; break;
                    case "ds_template3" : obj_template = parent.ds_template3; break;
                    case "ds_template4" : obj_template = parent.ds_template4; break;
                    case "ds_template5" : obj_template = parent.ds_template5; break;
                    case "ds_template6" : obj_template = parent.ds_template6; break;
                    default : break;
                }				
				prd = obj_template.GetColumnNF(objIndex, "PRD");
				if(prd != chgPrd) {
                    if(Length(prd) == 0 && Length(chgPrd) == 0) {
                    } else {
						//trace("PRHNAME:"+ds_prh.GetColumn(i, "PRHNAME")+", prd:"+prd+", chgPrd:"+chgPrd);
						// 필터적용하지 않은 index로 적용한다.
						obj_template.SetColumnNF(objIndex, "PRD", chgPrd);
						chgCnt = chgCnt + 1;
                    }
				}
			}
		}
		APPLYYSNO = "Y";

        var varArray;
        if(chgCnt > 0) {
			// 저장 처리 후 도면생성 호출을 한다.
			parent.FLOORYSNO = FLOORYSNO;
			parent.LAYOUTYSNO = LAYOUTYSNO;
			parent.APPLYYSNO = APPLYYSNO;

			gfn_openMsgWin("실측 견적사양 적용까지 처리되었습니다. 변경된 견적사양 저장 후 자동도면을 생성하십시요.", "", "A", "알림");
		    this.close();
        } else {
			parent.FLOORYSNO = FLOORYSNO;
			parent.LAYOUTYSNO = LAYOUTYSNO;
			parent.APPLYYSNO = APPLYYSNO;
			parent.SAVEYSNO  = "Y";
			gfn_openMsgWin("실측 견적사양 적용이 완료되어 자동도면을 생성합니다.", "", "A", "알림");

			// 도면생성 호출을 한다.
			parent.btn_dwg_OnClick();
		    this.close();
        }
	}
}

/********************************************************************************
* 기      능   : 도면일괄생성 처리 Callback  
********************************************************************************/
function fn_afterRadSave(svcId, errCode, errMsg) {
	parent.FLOORYSNO = FLOORYSNO;
	parent.LAYOUTYSNO = LAYOUTYSNO;
	parent.APPLYYSNO = APPLYYSNO;
	parent.SAVEYSNO  = "Y";

	// 도면생성 호출을 한다.
	parent.btn_dwg_OnClick();
	this.close();        
}
]]></Script>
</Window>