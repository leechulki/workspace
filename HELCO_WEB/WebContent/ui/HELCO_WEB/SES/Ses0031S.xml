<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="562" Id="Ses0031" Left="8" OnLoadCompleted="fn_OnLoadCompleted" OnUnloadCompleted="fn_OnUnloadCompleted" PidAttrib="7" Title="견적상세(S/S)" Top="8" Ver="1.0" Width="1008" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_header" OnColumnChanged="ds_header_OnColumnChanged" OnRowPosChanged="ds_header_OnRowPosChanged">
				<Contents>
					<colinfo id="FLAG" size="1" summ="default" type="STRING"/>
					<colinfo id="MANDT" size="256" summ="default" type="STRING"/>
					<colinfo id="QTNUM" size="256" summ="default" type="STRING"/>
					<colinfo id="QTSER" size="256" summ="default" type="STRING"/>
					<colinfo id="QTDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="SPART" size="256" summ="default" type="STRING"/>
					<colinfo id="QTGBN" size="256" summ="default" type="STRING"/>
					<colinfo id="ZBDTYP" size="256" summ="default" type="STRING"/>
					<colinfo id="ZPRGFLG" size="256" summ="default" type="STRING"/>
					<colinfo id="VKBUR" size="256" summ="default" type="STRING"/>
					<colinfo id="VKGRP" size="256" summ="default" type="STRING"/>
					<colinfo id="ZKUNNR" size="256" summ="default" type="STRING"/>
					<colinfo id="ZAGNT" size="256" summ="default" type="STRING"/>
					<colinfo id="KUNNR" size="256" summ="default" type="STRING"/>
					<colinfo id="ZCST" size="256" summ="default" type="STRING"/>
					<colinfo id="ZGNM" size="256" summ="default" type="STRING"/>
					<colinfo id="ZDEV" size="256" summ="default" type="STRING"/>
					<colinfo id="GSNAM" size="256" summ="default" type="STRING"/>
					<colinfo id="ZREGN" size="256" summ="default" type="STRING"/>
					<colinfo id="ZPID" size="256" summ="default" type="STRING"/>
					<colinfo id="ZTEL" size="256" summ="default" type="STRING"/>
					<colinfo id="ZADDR_ZPOST" size="256" summ="default" type="STRING"/>
					<colinfo id="ZADDR_ADR1" size="256" summ="default" type="STRING"/>
					<colinfo id="ZADDR_ADR2" size="256" summ="default" type="STRING"/>
					<colinfo id="SOABLE" size="256" summ="default" type="STRING"/>
					<colinfo id="ZESTDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="DELDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="ZDVMTS" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSUM_ZNUMBER" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSUM_ZCOST" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSUM_ZEAM" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSUM_SHANG" size="256" summ="default" type="STRING"/>
					<colinfo id="ZICIF_PPRT" size="256" summ="default" type="STRING"/>
					<colinfo id="ZICIF_PPCT" size="256" summ="default" type="STRING"/>
					<colinfo id="ZICIF_PPCD" size="256" summ="default" type="STRING"/>
					<colinfo id="ZICIF_1STRT" size="256" summ="default" type="STRING"/>
					<colinfo id="ZICIF_1STCT" size="256" summ="default" type="STRING"/>
					<colinfo id="ZICIF_1STCD" size="256" summ="default" type="STRING"/>
					<colinfo id="ZICIF_2STRT" size="256" summ="default" type="STRING"/>
					<colinfo id="ZICIF_2STCT" size="256" summ="default" type="STRING"/>
					<colinfo id="ZICIF_2STCD" size="256" summ="default" type="STRING"/>
					<colinfo id="ZICIF_RMRT" size="256" summ="default" type="STRING"/>
					<colinfo id="ZICIF_RMCT" size="256" summ="default" type="STRING"/>
					<colinfo id="ZICIF_RMCD" size="256" summ="default" type="STRING"/>
					<colinfo id="SPRMK1" size="256" summ="default" type="STRING"/>
					<colinfo id="SPRMK2" size="256" summ="default" type="STRING"/>
					<colinfo id="SPRMK3" size="256" summ="default" type="STRING"/>
					<colinfo id="SPRMK4" size="256" summ="default" type="STRING"/>
					<colinfo id="SPRMK5" size="256" summ="default" type="STRING"/>
					<colinfo id="SPRMK6" size="256" summ="default" type="STRING"/>
					<colinfo id="SPRMK7" size="256" summ="default" type="STRING"/>
					<colinfo id="SPRMK8" size="256" summ="default" type="STRING"/>
					<colinfo id="SPRMK9" size="256" summ="default" type="STRING"/>
					<colinfo id="SPRMK10" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSOFLG" size="256" summ="default" type="STRING"/>
					<colinfo id="SONNR" size="256" summ="default" type="STRING"/>
					<colinfo id="VBELN" size="256" summ="default" type="STRING"/>
					<colinfo id="AUART" size="256" summ="default" type="STRING"/>
					<colinfo id="WAERK" size="256" summ="default" type="STRING"/>
					<colinfo id="CO_DDVRTQ" size="256" summ="default" type="STRING"/>
					<colinfo id="CO_DEPHTQ" size="256" summ="default" type="STRING"/>
					<colinfo id="CO_DSSQ" size="256" summ="default" type="STRING"/>
					<colinfo id="CO_BCLCDTQ" size="256" summ="default" type="STRING"/>
					<colinfo id="CO_CHPITQ" size="256" summ="default" type="STRING"/>
					<colinfo id="CO_ASPC" size="256" summ="default" type="STRING"/>
					<colinfo id="CO_DSV1" size="256" summ="default" type="STRING"/>
					<colinfo id="CO_DSV1TQ" size="256" summ="default" type="STRING"/>
					<colinfo id="CO_DSV2" size="256" summ="default" type="STRING"/>
					<colinfo id="CO_DSV2TQ" size="256" summ="default" type="STRING"/>
					<colinfo id="INCO" size="256" summ="default" type="STRING"/>
					<colinfo id="ZLZONE" size="256" summ="default" type="STRING"/>
					<colinfo id="REGION" size="256" summ="default" type="STRING"/>
					<colinfo id="BUYR_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="ZEAM" size="256" summ="default" type="STRING"/>
					<colinfo id="ZKUNNR_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="KUNNR_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="ZAGNT_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="ZAGNTFLG" size="1" summ="default" type="STRING"/>
					<colinfo id="INCO2" size="84" summ="default" type="STRING"/>
					<colinfo id="MATNR" size="256" summ="default" type="STRING"/>
					<colinfo id="GTYPE" size="256" summ="default" type="STRING"/>
					<colinfo id="RTYPE" size="256" summ="default" type="STRING"/>
					<colinfo id="TYPE1" size="256" summ="default" type="STRING"/>
					<colinfo id="TYPE2" size="256" summ="default" type="STRING"/>
					<colinfo id="TYPE3" size="256" summ="default" type="STRING"/>
					<colinfo id="ZNUMBER" size="256" summ="default" type="STRING"/>
					<colinfo id="PART_CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="SHANGH" size="256" summ="default" type="STRING"/>
					<colinfo id="FA_BYRGBN" size="256" summ="default" type="STRING"/>
					<colinfo id="ZDELI" size="1" summ="default" type="STRING"/>
					<colinfo id="TEL" size="20" summ="default" type="STRING"/>
					<colinfo id="FAX" size="20" summ="default" type="STRING"/>
					<colinfo id="CEL" size="20" summ="default" type="STRING"/>
					<colinfo id="MAIL" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSUM_GSHANG" size="256" summ="default" type="STRING"/>
					<colinfo id="JGBN" size="256" summ="default" type="STRING"/>
					<colinfo id="AQTNUM" size="256" summ="default" type="STRING"/>
					<colinfo id="OPPID" size="256" summ="default" type="STRING"/>
					<colinfo id="UCH_DUTY" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_header_all">
				<Contents>
					<colinfo id="QTNUM" size="256" type="STRING"/>
					<colinfo id="QTSER" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset CanRowPosChange="ds_detail_CanRowPosChange" DataSetType="Dataset" Id="ds_detail" OnColumnChanged="ds_detail_OnColumnChanged" OnRowPosChanged="ds_detail_OnRowPosChanged">
				<Contents>
					<colinfo id="CHK" size="1" summ="default" type="STRING"/>
					<colinfo id="FLAG" size="1" summ="default" type="STRING"/>
					<colinfo id="NEW_YN" size="1" summ="default" type="STRING"/>
					<colinfo id="MANDT" size="256" summ="default" type="STRING"/>
					<colinfo id="QTNUM" size="256" summ="default" type="STRING"/>
					<colinfo id="QTSER" size="256" summ="default" type="STRING"/>
					<colinfo id="QTSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="SHANGH" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSAREA" size="256" summ="default" type="STRING"/>
					<colinfo id="MATNR" size="256" summ="default" type="STRING"/>
					<colinfo id="ZPRDGBN" size="256" summ="default" type="STRING"/>
					<colinfo id="SPEC" size="256" summ="default" type="STRING"/>
					<colinfo id="GTYPE" size="256" summ="default" type="STRING"/>
					<colinfo id="TYPE1" size="256" summ="default" type="STRING"/>
					<colinfo id="TYPE2" size="256" summ="default" type="STRING"/>
					<colinfo id="TYPE3" size="256" summ="default" type="STRING"/>
					<colinfo id="ZNUMBER" size="256" summ="default" type="STRING"/>
					<colinfo id="ZACAPA" size="256" summ="default" type="STRING"/>
					<colinfo id="ZUSE" size="256" summ="default" type="STRING"/>
					<colinfo id="ZUSE_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="ZOPN" size="256" summ="default" type="STRING"/>
					<colinfo id="ZLEN" size="256" summ="default" type="STRING"/>
					<colinfo id="ZOUTC" size="256" summ="default" type="STRING"/>
					<colinfo id="ZUAM" size="256" summ="default" type="STRING"/>
					<colinfo id="ZCOST" size="256" summ="default" type="STRING"/>
					<colinfo id="ZCOSTM" size="256" summ="default" type="STRING"/>
					<colinfo id="ZEAM" size="256" summ="default" type="STRING"/>
					<colinfo id="SHANG" size="256" summ="default" type="STRING"/>
					<colinfo id="ZRMK" size="256" summ="default" type="STRING"/>
					<colinfo id="MCLASS" size="256" summ="default" type="STRING"/>
					<colinfo id="SONNR" size="256" summ="default" type="STRING"/>
					<colinfo id="ZEAM_ORG" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_error">
				<Contents>
					<colinfo id="IDX" size="256" type="STRING"/>
					<colinfo id="ERRMSG" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_waerk">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_merge">
				<Contents>
					<colinfo id="MANDT" size="256" type="STRING"/>
					<colinfo id="QTNUM" size="256" type="STRING"/>
					<colinfo id="QTSER" size="256" type="STRING"/>
					<colinfo id="QTSEQ" size="256" type="STRING"/>
					<colinfo id="SHANGH" size="256" type="STRING"/>
					<colinfo id="MATNR" size="256" type="STRING"/>
					<colinfo id="SPEC" size="256" type="STRING"/>
					<colinfo id="GTYPE" size="256" type="STRING"/>
					<colinfo id="TYPE1" size="256" type="STRING"/>
					<colinfo id="TYPE2" size="256" type="STRING"/>
					<colinfo id="TYPE3" size="256" type="STRING"/>
					<colinfo id="ZNUMBER" size="256" type="STRING"/>
					<colinfo id="ZUSE" size="256" type="STRING"/>
					<colinfo id="ZOPN" size="256" type="STRING"/>
					<colinfo id="ZLEN" size="256" type="STRING"/>
					<colinfo id="ZUAM" size="256" type="STRING"/>
					<colinfo id="ZCOST" size="256" type="STRING"/>
					<colinfo id="ZEAM" size="256" type="STRING"/>
					<colinfo id="SHANG" size="256" type="STRING"/>
					<colinfo id="ZRMK" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_spart_cd">
				<Contents>
					<colinfo id="CODE" size="1" type="STRING"/>
					<colinfo id="CODE_NAME" size="1" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_zprgflg">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_vkbur">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<colinfo id="DTEXT2" size="90" type="STRING"/>
					<colinfo id="DTEXT3" size="120" type="STRING"/>
					<colinfo id="DTEXT4" size="9" type="STRING"/>
					<colinfo id="CODE2" size="2" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_head">
				<Contents>
					<colinfo id="BS101_AD1" size="300" type="STRING"/>
					<colinfo id="BS101_AD2" size="300" type="STRING"/>
					<colinfo id="BS101_CDT" size="24" type="STRING"/>
					<colinfo id="BS101_CID" size="30" type="STRING"/>
					<colinfo id="BS101_EAM" size="22" type="DECIMAL"/>
					<colinfo id="BS101_FCD" size="6" type="STRING"/>
					<colinfo id="BS101_FRT" size="22" type="DECIMAL"/>
					<colinfo id="BS101_GNM" size="300" type="STRING"/>
					<colinfo id="BS101_LCD" size="6" type="STRING"/>
					<colinfo id="BS101_LDT" size="24" type="STRING"/>
					<colinfo id="BS101_LRT" size="22" type="DECIMAL"/>
					<colinfo id="BS101_MCD" size="6" type="STRING"/>
					<colinfo id="BS101_MRT" size="22" type="DECIMAL"/>
					<colinfo id="BS101_PST" size="6" type="STRING"/>
					<colinfo id="BS101_RDT" size="18" type="STRING"/>
					<colinfo id="BS101_RMK" size="600" type="STRING"/>
					<colinfo id="BS101_SEQ" size="15" type="STRING"/>
					<colinfo id="BS101_SPT" size="300" type="STRING"/>
					<colinfo id="BS101_TEL" size="90" type="STRING"/>
					<colinfo id="BS101_ZIP" size="18" type="STRING"/>
					<colinfo id="NAME1" size="105" type="STRING"/>
					<colinfo id="BS101_QTY" size="256" type="STRING"/>
					<colinfo id="BS101_OAM" size="256" type="STRING"/>
					<colinfo id="BS101_RAT" size="256" type="STRING"/>
					<colinfo id="BS101_PID" size="256" type="STRING"/>
					<colinfo id="BS101_GBN" size="256" type="STRING"/>
					<record>
						<BS101_AD1></BS101_AD1>
						<BS101_AD2></BS101_AD2>
						<BS101_CDT></BS101_CDT>
						<BS101_CID></BS101_CID>
						<BS101_EAM/>
						<BS101_FCD></BS101_FCD>
						<BS101_FRT/>
						<BS101_GBN></BS101_GBN>
						<BS101_GNM></BS101_GNM>
						<BS101_LCD></BS101_LCD>
						<BS101_LDT></BS101_LDT>
						<BS101_LRT/>
						<BS101_MCD></BS101_MCD>
						<BS101_MRT/>
						<BS101_OAM></BS101_OAM>
						<BS101_PID></BS101_PID>
						<BS101_PST></BS101_PST>
						<BS101_QTY></BS101_QTY>
						<BS101_RAT></BS101_RAT>
						<BS101_RDT></BS101_RDT>
						<BS101_RMK></BS101_RMK>
						<BS101_SEQ></BS101_SEQ>
						<BS101_SPT></BS101_SPT>
						<BS101_TEL></BS101_TEL>
						<BS101_ZIP></BS101_ZIP>
						<NAME1></NAME1>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_sukum">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_template">
				<Contents>
					<colinfo id="FLAG" size="1" summ="default" type="STRING"/>
					<colinfo id="CHK" size="1" summ="default" type="STRING"/>
					<colinfo id="MANDT" size="256" summ="default" type="STRING"/>
					<colinfo id="ZTPLNO" size="256" summ="default" type="STRING"/>
					<colinfo id="ZTPLSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="PRH" size="256" summ="default" type="STRING"/>
					<colinfo id="PRHNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="PRD" size="256" summ="default" type="STRING"/>
					<colinfo id="ZRMK" size="256" summ="default" type="STRING"/>
					<colinfo id="MCLASS" size="256" summ="default" type="STRING"/>
					<colinfo id="ZTPLNM" size="256" summ="default" type="STRING"/>
					<colinfo id="ATKLA" size="256" summ="default" type="STRING"/>
					<colinfo id="QTNUM" size="256" summ="default" type="STRING"/>
					<colinfo id="QTSER" size="256" summ="default" type="STRING"/>
					<colinfo id="QTSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="PRSEQ" size="256" summ="default" type="INT"/>
					<colinfo id="CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="ATFOR" size="256" summ="default" type="STRING"/>
					<colinfo id="ATWTB" size="256" summ="default" type="STRING"/>
					<colinfo id="PCNCD" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond">
				<Contents>
					<colinfo id="MANDT" size="256" type="STRING"/>
					<colinfo id="MCLASS" size="256" type="STRING"/>
					<colinfo id="ATKLA" size="256" type="STRING"/>
					<colinfo id="ATNAM" size="256" type="STRING"/>
					<colinfo id="FR_QTDAT" size="256" type="STRING"/>
					<colinfo id="TO_QTDAT" size="256" type="STRING"/>
					<colinfo id="FR_ZESTDAT" size="256" type="STRING"/>
					<colinfo id="TO_ZESTDAT" size="256" type="STRING"/>
					<colinfo id="VKBUR" size="256" type="STRING"/>
					<colinfo id="VKGRP" size="256" type="STRING"/>
					<colinfo id="ZPRGFLG" size="256" type="STRING"/>
					<colinfo id="SMAN" size="256" type="STRING"/>
					<colinfo id="QTNUM" size="256" type="STRING"/>
					<colinfo id="QTSER" size="256" type="STRING"/>
					<colinfo id="QTSEQ" size="256" type="STRING"/>
					<colinfo id="BLOCKGBN" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_zregn1">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_vkgrp">
				<Contents>
					<colinfo id="CODE" size="9" type="STRING"/>
					<colinfo id="CODE_NAME" size="60" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_shangh">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE>국내</CODE>
						<CODE_NAME>국내</CODE_NAME>
					</record>
					<record>
						<CODE>해외</CODE>
						<CODE_NAME>해외</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_template0" OnRowPosChanged="ds_detail_OnRowPosChanged">
				<Contents>
					<colinfo id="FLAG" size="1" summ="default" type="STRING"/>
					<colinfo id="CHK" size="1" summ="default" type="STRING"/>
					<colinfo id="MANDT" size="256" summ="default" type="STRING"/>
					<colinfo id="ZTPLNO" size="256" summ="default" type="STRING"/>
					<colinfo id="ZTPLSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="PRH" size="256" summ="default" type="STRING"/>
					<colinfo id="PRHNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="PRD" size="256" summ="default" type="STRING"/>
					<colinfo id="ZRMK" size="256" summ="default" type="STRING"/>
					<colinfo id="MCLASS" size="256" summ="default" type="STRING"/>
					<colinfo id="ZTPLNM" size="256" summ="default" type="STRING"/>
					<colinfo id="ATKLA" size="256" summ="default" type="STRING"/>
					<colinfo id="QTNUM" size="256" summ="default" type="STRING"/>
					<colinfo id="QTSER" size="256" summ="default" type="STRING"/>
					<colinfo id="QTSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="PRSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="ATFOR" size="256" summ="default" type="STRING"/>
					<colinfo id="PCNCD" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_template1" OnColumnChanged="ds_template_OnColumnChanged" OnRowPosChanged="ds_detail_OnRowPosChanged">
				<Contents>
					<colinfo id="FLAG" size="1" summ="default" type="STRING"/>
					<colinfo id="CHK" size="1" summ="default" type="STRING"/>
					<colinfo id="MANDT" size="256" summ="default" type="STRING"/>
					<colinfo id="ZTPLNO" size="256" summ="default" type="STRING"/>
					<colinfo id="ZTPLSEQ" size="256" summ="default" type="INT"/>
					<colinfo id="PRH" size="256" summ="default" type="STRING"/>
					<colinfo id="PRHNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="PRD" size="256" summ="default" type="STRING"/>
					<colinfo id="ZRMK" size="256" summ="default" type="STRING"/>
					<colinfo id="MCLASS" size="256" summ="default" type="STRING"/>
					<colinfo id="ZTPLNM" size="256" summ="default" type="STRING"/>
					<colinfo id="ATKLA" size="256" summ="default" type="STRING"/>
					<colinfo id="QTNUM" size="256" summ="default" type="STRING"/>
					<colinfo id="QTSER" size="256" summ="default" type="STRING"/>
					<colinfo id="QTSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="PRSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="ATFOR" size="256" summ="default" type="STRING"/>
					<colinfo id="ATWTB" size="256" summ="default" type="STRING"/>
					<colinfo id="PCNCD" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_template2" OnColumnChanged="ds_template_OnColumnChanged" OnRowPosChanged="ds_detail_OnRowPosChanged">
				<Contents>
					<colinfo id="FLAG" size="1" summ="default" type="STRING"/>
					<colinfo id="CHK" size="1" summ="default" type="STRING"/>
					<colinfo id="MANDT" size="256" summ="default" type="STRING"/>
					<colinfo id="ZTPLNO" size="256" summ="default" type="STRING"/>
					<colinfo id="ZTPLSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="PRH" size="256" summ="default" type="STRING"/>
					<colinfo id="PRHNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="PRD" size="256" summ="default" type="STRING"/>
					<colinfo id="ZRMK" size="256" summ="default" type="STRING"/>
					<colinfo id="MCLASS" size="256" summ="default" type="STRING"/>
					<colinfo id="ZTPLNM" size="256" summ="default" type="STRING"/>
					<colinfo id="ATKLA" size="256" summ="default" type="STRING"/>
					<colinfo id="QTNUM" size="256" summ="default" type="STRING"/>
					<colinfo id="QTSER" size="256" summ="default" type="STRING"/>
					<colinfo id="QTSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="PRSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="ATFOR" size="256" summ="default" type="STRING"/>
					<colinfo id="PCNCD" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_template3" OnColumnChanged="ds_template_OnColumnChanged" OnRowPosChanged="ds_detail_OnRowPosChanged">
				<Contents>
					<colinfo id="FLAG" size="1" summ="default" type="STRING"/>
					<colinfo id="CHK" size="1" summ="default" type="STRING"/>
					<colinfo id="MANDT" size="256" summ="default" type="STRING"/>
					<colinfo id="ZTPLNO" size="256" summ="default" type="STRING"/>
					<colinfo id="ZTPLSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="PRH" size="256" summ="default" type="STRING"/>
					<colinfo id="PRHNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="PRD" size="256" summ="default" type="STRING"/>
					<colinfo id="ZRMK" size="256" summ="default" type="STRING"/>
					<colinfo id="MCLASS" size="256" summ="default" type="STRING"/>
					<colinfo id="ZTPLNM" size="256" summ="default" type="STRING"/>
					<colinfo id="ATKLA" size="256" summ="default" type="STRING"/>
					<colinfo id="QTNUM" size="256" summ="default" type="STRING"/>
					<colinfo id="QTSER" size="256" summ="default" type="STRING"/>
					<colinfo id="QTSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="PRSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="ATFOR" size="256" summ="default" type="STRING"/>
					<colinfo id="PCNCD" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_template4" OnColumnChanged="ds_template_OnColumnChanged" OnRowPosChanged="ds_detail_OnRowPosChanged">
				<Contents>
					<colinfo id="FLAG" size="1" summ="default" type="STRING"/>
					<colinfo id="CHK" size="1" summ="default" type="STRING"/>
					<colinfo id="MANDT" size="256" summ="default" type="STRING"/>
					<colinfo id="ZTPLNO" size="256" summ="default" type="STRING"/>
					<colinfo id="ZTPLSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="PRH" size="256" summ="default" type="STRING"/>
					<colinfo id="PRHNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="PRD" size="256" summ="default" type="STRING"/>
					<colinfo id="ZRMK" size="256" summ="default" type="STRING"/>
					<colinfo id="MCLASS" size="256" summ="default" type="STRING"/>
					<colinfo id="ZTPLNM" size="256" summ="default" type="STRING"/>
					<colinfo id="ATKLA" size="256" summ="default" type="STRING"/>
					<colinfo id="QTNUM" size="256" summ="default" type="STRING"/>
					<colinfo id="QTSER" size="256" summ="default" type="STRING"/>
					<colinfo id="QTSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="PRSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="ATFOR" size="256" summ="default" type="STRING"/>
					<colinfo id="PCNCD" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_template5" OnColumnChanged="ds_template_OnColumnChanged" OnRowPosChanged="ds_detail_OnRowPosChanged">
				<Contents>
					<colinfo id="FLAG" size="1" summ="default" type="STRING"/>
					<colinfo id="CHK" size="1" summ="default" type="STRING"/>
					<colinfo id="MANDT" size="256" summ="default" type="STRING"/>
					<colinfo id="ZTPLNO" size="256" summ="default" type="STRING"/>
					<colinfo id="ZTPLSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="PRH" size="256" summ="default" type="STRING"/>
					<colinfo id="PRHNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="PRD" size="256" summ="default" type="STRING"/>
					<colinfo id="ZRMK" size="256" summ="default" type="STRING"/>
					<colinfo id="MCLASS" size="256" summ="default" type="STRING"/>
					<colinfo id="ZTPLNM" size="256" summ="default" type="STRING"/>
					<colinfo id="ATKLA" size="256" summ="default" type="STRING"/>
					<colinfo id="QTNUM" size="256" summ="default" type="STRING"/>
					<colinfo id="QTSER" size="256" summ="default" type="STRING"/>
					<colinfo id="QTSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="PRSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="ATFOR" size="256" summ="default" type="STRING"/>
					<colinfo id="PCNCD" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_char">
				<Contents>
					<colinfo id="QTNUM" size="10" type="STRING"/>
					<colinfo id="QTSER" size="3" type="STRING"/>
					<colinfo id="QTSEQ" size="3" type="STRING"/>
					<colinfo id="PSPID" size="24" type="STRING"/>
					<colinfo id="POSID" size="24" type="STRING"/>
					<colinfo id="GJAHR" size="4" type="STRING"/>
					<colinfo id="POPER" size="3" type="STRING"/>
					<colinfo id="MATNR" size="18" type="STRING"/>
					<colinfo id="VKBUR" size="4" type="STRING"/>
					<colinfo id="VKGRP" size="3" type="STRING"/>
					<colinfo id="AUART" size="4" type="STRING"/>
					<colinfo id="KTGRM" size="2" type="STRING"/>
					<colinfo id="NETWR" size="15" type="STRING"/>
					<colinfo id="REGIO" size="3" type="STRING"/>
					<colinfo id="LZONE" size="10" type="STRING"/>
					<colinfo id="ATKLA" size="10" type="STRING"/>
					<colinfo id="ATNAM" size="30" type="STRING"/>
					<colinfo id="ATBEZ" size="30" type="STRING"/>
					<colinfo id="VALUE" size="30" type="STRING"/>
					<colinfo id="ATWTB" size="30" type="STRING"/>
					<colinfo id="MESSG" size="20" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_t202">
				<Contents>
					<colinfo id="MANDT" size="3" type="STRING"/>
					<colinfo id="QTNUM" size="10" type="STRING"/>
					<colinfo id="QTSER" size="3" type="STRING"/>
					<colinfo id="QTSEQ" size="3" type="STRING"/>
					<colinfo id="BLGRP" size="10" type="STRING"/>
					<colinfo id="BLSEQ" size="6" type="STRING"/>
					<colinfo id="BLNUM" size="10" type="STRING"/>
					<colinfo id="GRMAT" size="18" type="STRING"/>
					<colinfo id="RQMAT" size="18" type="STRING"/>
					<colinfo id="TWAER" size="5" type="STRING"/>
					<colinfo id="MEINH_RQ" size="3" type="STRING"/>
					<colinfo id="MEINH_MH" size="3" type="STRING"/>
					<colinfo id="ADJ" size="1" type="STRING"/>
					<colinfo id="BDMNG" size="13" type="STRING"/>
					<colinfo id="ZCPMRAW" size="15" type="STRING"/>
					<colinfo id="ZCPMRAW_A" size="13" type="STRING"/>
					<colinfo id="ZCPMRAW_T" size="15" type="STRING"/>
					<colinfo id="ZCPMCOM" size="15" type="STRING"/>
					<colinfo id="ZCPDLAB" size="15" type="STRING"/>
					<colinfo id="ZCPDEXP" size="15" type="STRING"/>
					<colinfo id="ZCPDSCT" size="15" type="STRING"/>
					<colinfo id="ZCPILAB" size="15" type="STRING"/>
					<colinfo id="ZCPIMEN" size="15" type="STRING"/>
					<colinfo id="ZCBIMEN" size="15" type="STRING"/>
					<colinfo id="ZCPRICE" size="15" type="STRING"/>
					<colinfo id="ZCTOTAL" size="15" type="STRING"/>
					<colinfo id="ZACTLAB1" size="13" type="STRING"/>
					<colinfo id="ZACTMAC1" size="13" type="STRING"/>
					<colinfo id="SALES" size="1" type="STRING"/>
					<colinfo id="MESSG" size="100" type="STRING"/>
					<colinfo id="MODEL" size="6" type="STRING"/>
					<colinfo id="CRDAT" size="8" type="STRING"/>
					<colinfo id="CRNAM" size="12" type="STRING"/>
					<colinfo id="EDITER" size="12" type="STRING"/>
					<colinfo id="FLAG" size="1" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_t302">
				<Contents>
					<colinfo id="MANDT" size="3" summ="default" type="STRING"/>
					<colinfo id="QTNUM" size="10" summ="default" type="STRING"/>
					<colinfo id="QTSER" size="3" summ="default" type="STRING"/>
					<colinfo id="QTSEQ" size="3" summ="default" type="STRING"/>
					<colinfo id="TWAER" size="5" summ="default" type="STRING"/>
					<colinfo id="MEINH_MH" size="3" summ="default" type="STRING"/>
					<colinfo id="PRDM01" size="15" summ="default" type="STRING"/>
					<colinfo id="PRDM02" size="15" summ="default" type="STRING"/>
					<colinfo id="PRDM03" size="15" summ="default" type="STRING"/>
					<colinfo id="PRDM04" size="15" summ="default" type="STRING"/>
					<colinfo id="PRDM05" size="15" summ="default" type="STRING"/>
					<colinfo id="PRDA01" size="13" summ="default" type="STRING"/>
					<colinfo id="PRDL01" size="15" summ="default" type="STRING"/>
					<colinfo id="PRDL02" size="15" summ="default" type="STRING"/>
					<colinfo id="PRDL03" size="15" summ="default" type="STRING"/>
					<colinfo id="PRDL04" size="15" summ="default" type="STRING"/>
					<colinfo id="PRDL05" size="15" summ="default" type="STRING"/>
					<colinfo id="PRDE01" size="15" summ="default" type="STRING"/>
					<colinfo id="PRDE02" size="15" summ="default" type="STRING"/>
					<colinfo id="PRDE03" size="15" summ="default" type="STRING"/>
					<colinfo id="PRDE04" size="15" summ="default" type="STRING"/>
					<colinfo id="PRDE05" size="15" summ="default" type="STRING"/>
					<colinfo id="PRDE06" size="15" summ="default" type="STRING"/>
					<colinfo id="PRDE07" size="15" summ="default" type="STRING"/>
					<colinfo id="PRDE08" size="15" summ="default" type="STRING"/>
					<colinfo id="PRDE09" size="15" summ="default" type="STRING"/>
					<colinfo id="PRDE10" size="15" summ="default" type="STRING"/>
					<colinfo id="PRDE11" size="15" summ="default" type="STRING"/>
					<colinfo id="PRDE12" size="15" summ="default" type="STRING"/>
					<colinfo id="PRDE13" size="15" summ="default" type="STRING"/>
					<colinfo id="PRDE14" size="15" summ="default" type="STRING"/>
					<colinfo id="PRDE15" size="15" summ="default" type="STRING"/>
					<colinfo id="PRDI01" size="15" summ="default" type="STRING"/>
					<colinfo id="PRDI02" size="15" summ="default" type="STRING"/>
					<colinfo id="PRDI03" size="15" summ="default" type="STRING"/>
					<colinfo id="PRDI04" size="15" summ="default" type="STRING"/>
					<colinfo id="EQMM01" size="15" summ="default" type="STRING"/>
					<colinfo id="EQMM02" size="15" summ="default" type="STRING"/>
					<colinfo id="EQMM03" size="15" summ="default" type="STRING"/>
					<colinfo id="EQMM04" size="15" summ="default" type="STRING"/>
					<colinfo id="EQMM05" size="15" summ="default" type="STRING"/>
					<colinfo id="EQMA01" size="13" summ="default" type="STRING"/>
					<colinfo id="EQMA02" size="13" summ="default" type="STRING"/>
					<colinfo id="EQML01" size="15" summ="default" type="STRING"/>
					<colinfo id="EQML02" size="15" summ="default" type="STRING"/>
					<colinfo id="EQML03" size="15" summ="default" type="STRING"/>
					<colinfo id="EQML04" size="15" summ="default" type="STRING"/>
					<colinfo id="EQML05" size="15" summ="default" type="STRING"/>
					<colinfo id="EQME01" size="15" summ="default" type="STRING"/>
					<colinfo id="EQME02" size="15" summ="default" type="STRING"/>
					<colinfo id="EQME03" size="15" summ="default" type="STRING"/>
					<colinfo id="EQME04" size="15" summ="default" type="STRING"/>
					<colinfo id="EQME05" size="15" summ="default" type="STRING"/>
					<colinfo id="EQME06" size="15" summ="default" type="STRING"/>
					<colinfo id="EQME07" size="15" summ="default" type="STRING"/>
					<colinfo id="EQME08" size="15" summ="default" type="STRING"/>
					<colinfo id="EQME09" size="15" summ="default" type="STRING"/>
					<colinfo id="EQME10" size="15" summ="default" type="STRING"/>
					<colinfo id="EQME11" size="15" summ="default" type="STRING"/>
					<colinfo id="EQME12" size="15" summ="default" type="STRING"/>
					<colinfo id="EQME13" size="15" summ="default" type="STRING"/>
					<colinfo id="EQME14" size="15" summ="default" type="STRING"/>
					<colinfo id="EQME15" size="15" summ="default" type="STRING"/>
					<colinfo id="EQME51" size="15" summ="default" type="STRING"/>
					<colinfo id="EQME52" size="15" summ="default" type="STRING"/>
					<colinfo id="EQME53" size="15" summ="default" type="STRING"/>
					<colinfo id="EQME54" size="15" summ="default" type="STRING"/>
					<colinfo id="EQME55" size="15" summ="default" type="STRING"/>
					<colinfo id="EQME56" size="15" summ="default" type="STRING"/>
					<colinfo id="EQME57" size="15" summ="default" type="STRING"/>
					<colinfo id="EQME58" size="15" summ="default" type="STRING"/>
					<colinfo id="EQME59" size="15" summ="default" type="STRING"/>
					<colinfo id="EQME60" size="15" summ="default" type="STRING"/>
					<colinfo id="EQME61" size="15" summ="default" type="STRING"/>
					<colinfo id="EQME62" size="15" summ="default" type="STRING"/>
					<colinfo id="EQME63" size="15" summ="default" type="STRING"/>
					<colinfo id="EQME64" size="15" summ="default" type="STRING"/>
					<colinfo id="EQME65" size="15" summ="default" type="STRING"/>
					<colinfo id="EQME66" size="15" summ="default" type="STRING"/>
					<colinfo id="EQME67" size="15" summ="default" type="STRING"/>
					<colinfo id="EQME68" size="15" summ="default" type="STRING"/>
					<colinfo id="EQME69" size="15" summ="default" type="STRING"/>
					<colinfo id="EQME70" size="15" summ="default" type="STRING"/>
					<colinfo id="EQME71" size="15" summ="default" type="STRING"/>
					<colinfo id="EQME72" size="15" summ="default" type="STRING"/>
					<colinfo id="EQME73" size="15" summ="default" type="STRING"/>
					<colinfo id="EQME74" size="15" summ="default" type="STRING"/>
					<colinfo id="EQME75" size="15" summ="default" type="STRING"/>
					<colinfo id="EQME76" size="15" summ="default" type="STRING"/>
					<colinfo id="EQME77" size="15" summ="default" type="STRING"/>
					<colinfo id="EQME78" size="15" summ="default" type="STRING"/>
					<colinfo id="EQME79" size="15" summ="default" type="STRING"/>
					<colinfo id="EQME80" size="15" summ="default" type="STRING"/>
					<colinfo id="EQME81" size="15" summ="default" type="STRING"/>
					<colinfo id="EQME82" size="15" summ="default" type="STRING"/>
					<colinfo id="EQME83" size="15" summ="default" type="STRING"/>
					<colinfo id="EQME84" size="15" summ="default" type="STRING"/>
					<colinfo id="EQME85" size="15" summ="default" type="STRING"/>
					<colinfo id="EQME86" size="15" summ="default" type="STRING"/>
					<colinfo id="EQME87" size="15" summ="default" type="STRING"/>
					<colinfo id="EQME88" size="15" summ="default" type="STRING"/>
					<colinfo id="EQME89" size="15" summ="default" type="STRING"/>
					<colinfo id="EQMI01" size="15" summ="default" type="STRING"/>
					<colinfo id="EQMI02" size="15" summ="default" type="STRING"/>
					<colinfo id="EQMI03" size="15" summ="default" type="STRING"/>
					<colinfo id="EQMO01" size="15" summ="default" type="STRING"/>
					<colinfo id="EQMO02" size="15" summ="default" type="STRING"/>
					<colinfo id="EQMO03" size="15" summ="default" type="STRING"/>
					<colinfo id="EQMO04" size="15" summ="default" type="STRING"/>
					<colinfo id="EQMO05" size="15" summ="default" type="STRING"/>
					<colinfo id="EQMO06" size="15" summ="default" type="STRING"/>
					<colinfo id="EQMO07" size="15" summ="default" type="STRING"/>
					<colinfo id="EQMO08" size="15" summ="default" type="STRING"/>
					<colinfo id="EQMO09" size="15" summ="default" type="STRING"/>
					<colinfo id="EQMO10" size="15" summ="default" type="STRING"/>
					<colinfo id="EQMO11" size="15" summ="default" type="STRING"/>
					<colinfo id="EQMO12" size="15" summ="default" type="STRING"/>
					<colinfo id="EQMO13" size="15" summ="default" type="STRING"/>
					<colinfo id="EQMO14" size="15" summ="default" type="STRING"/>
					<colinfo id="EQMO15" size="15" summ="default" type="STRING"/>
					<colinfo id="EQMO16" size="15" summ="default" type="STRING"/>
					<colinfo id="EQMO17" size="15" summ="default" type="STRING"/>
					<colinfo id="EQMO18" size="15" summ="default" type="STRING"/>
					<colinfo id="EQMO19" size="15" summ="default" type="STRING"/>
					<colinfo id="EQMO20" size="15" summ="default" type="STRING"/>
					<colinfo id="EQMO21" size="15" summ="default" type="STRING"/>
					<colinfo id="EQMO22" size="15" summ="default" type="STRING"/>
					<colinfo id="EQMO23" size="15" summ="default" type="STRING"/>
					<colinfo id="EQMO24" size="15" summ="default" type="STRING"/>
					<colinfo id="EQMO25" size="15" summ="default" type="STRING"/>
					<colinfo id="EQMO26" size="15" summ="default" type="STRING"/>
					<colinfo id="EQMO27" size="15" summ="default" type="STRING"/>
					<colinfo id="EQMO28" size="15" summ="default" type="STRING"/>
					<colinfo id="EQMO29" size="15" summ="default" type="STRING"/>
					<colinfo id="EQMO30" size="15" summ="default" type="STRING"/>
					<colinfo id="EQMO31" size="15" summ="default" type="STRING"/>
					<colinfo id="EQMO32" size="15" summ="default" type="STRING"/>
					<colinfo id="EQMO33" size="15" summ="default" type="STRING"/>
					<colinfo id="EQMO34" size="15" summ="default" type="STRING"/>
					<colinfo id="EQMO35" size="15" summ="default" type="STRING"/>
					<colinfo id="EQMO36" size="15" summ="default" type="STRING"/>
					<colinfo id="EQMO37" size="15" summ="default" type="STRING"/>
					<colinfo id="EQMO38" size="15" summ="default" type="STRING"/>
					<colinfo id="EQMO39" size="15" summ="default" type="STRING"/>
					<colinfo id="EQMO40" size="15" summ="default" type="STRING"/>
					<colinfo id="CTSM01" size="15" summ="default" type="STRING"/>
					<colinfo id="CTSM02" size="15" summ="default" type="STRING"/>
					<colinfo id="CTSM03" size="15" summ="default" type="STRING"/>
					<colinfo id="CTSM04" size="15" summ="default" type="STRING"/>
					<colinfo id="CTSM05" size="15" summ="default" type="STRING"/>
					<colinfo id="CTSM06" size="15" summ="default" type="STRING"/>
					<colinfo id="CTSM07" size="15" summ="default" type="STRING"/>
					<colinfo id="CTSM08" size="15" summ="default" type="STRING"/>
					<colinfo id="CTSM09" size="15" summ="default" type="STRING"/>
					<colinfo id="CTSM10" size="15" summ="default" type="STRING"/>
					<colinfo id="CTSM11" size="15" summ="default" type="STRING"/>
					<colinfo id="CTSM12" size="15" summ="default" type="STRING"/>
					<colinfo id="CTSM13" size="15" summ="default" type="STRING"/>
					<colinfo id="CTSM14" size="15" summ="default" type="STRING"/>
					<colinfo id="CTSM15" size="256" summ="default" type="STRING"/>
					<colinfo id="CTSA01" size="13" summ="default" type="STRING"/>
					<colinfo id="CTSL01" size="15" summ="default" type="STRING"/>
					<colinfo id="CTSL02" size="15" summ="default" type="STRING"/>
					<colinfo id="CTSL03" size="15" summ="default" type="STRING"/>
					<colinfo id="CTSL04" size="15" summ="default" type="STRING"/>
					<colinfo id="CTSL05" size="15" summ="default" type="STRING"/>
					<colinfo id="CTSE01" size="15" summ="default" type="STRING"/>
					<colinfo id="CTSE02" size="15" summ="default" type="STRING"/>
					<colinfo id="CTSE03" size="15" summ="default" type="STRING"/>
					<colinfo id="CTSE04" size="15" summ="default" type="STRING"/>
					<colinfo id="CTSE05" size="15" summ="default" type="STRING"/>
					<colinfo id="CTSI01" size="15" summ="default" type="STRING"/>
					<colinfo id="CTSI02" size="15" summ="default" type="STRING"/>
					<colinfo id="CTSI03" size="15" summ="default" type="STRING"/>
					<colinfo id="ADDT01" size="15" summ="default" type="STRING"/>
					<colinfo id="FDSP01" size="15" summ="default" type="STRING"/>
					<colinfo id="FDSP02" size="15" summ="default" type="STRING"/>
					<colinfo id="FDSP03" size="15" summ="default" type="STRING"/>
					<colinfo id="FDSP04" size="15" summ="default" type="STRING"/>
					<colinfo id="FDSP05" size="15" summ="default" type="STRING"/>
					<colinfo id="FDSP06" size="15" summ="default" type="STRING"/>
					<colinfo id="FDSP07" size="15" summ="default" type="STRING"/>
					<colinfo id="FDSP08" size="15" summ="default" type="STRING"/>
					<colinfo id="FDSP09" size="15" summ="default" type="STRING"/>
					<colinfo id="FDSP10" size="15" summ="default" type="STRING"/>
					<colinfo id="FDSP11" size="15" summ="default" type="STRING"/>
					<colinfo id="FDS01" size="30" summ="default" type="STRING"/>
					<colinfo id="FDS02" size="30" summ="default" type="STRING"/>
					<colinfo id="FDS03" size="30" summ="default" type="STRING"/>
					<colinfo id="FDS04" size="30" summ="default" type="STRING"/>
					<colinfo id="FDS05" size="30" summ="default" type="STRING"/>
					<colinfo id="FDS06" size="30" summ="default" type="STRING"/>
					<colinfo id="FDS07" size="30" summ="default" type="STRING"/>
					<colinfo id="FDS08" size="30" summ="default" type="STRING"/>
					<colinfo id="FDS09" size="30" summ="default" type="STRING"/>
					<colinfo id="FDS10" size="30" summ="default" type="STRING"/>
					<colinfo id="MODEL" size="6" summ="default" type="STRING"/>
					<colinfo id="CRDAT" size="8" summ="default" type="STRING"/>
					<colinfo id="CRNAM" size="12" summ="default" type="STRING"/>
					<colinfo id="TRDAT" size="8" summ="default" type="STRING"/>
					<colinfo id="TRNAM" size="12" summ="default" type="STRING"/>
					<colinfo id="EDITER" size="12" summ="default" type="STRING"/>
					<colinfo id="FLAG" size="1" summ="default" type="STRING"/>
					<colinfo id="EQME90" size="256" summ="default" type="STRING"/>
					<colinfo id="EQME91" size="256" summ="default" type="STRING"/>
					<colinfo id="EQME92" size="256" summ="default" type="STRING"/>
					<colinfo id="EQME93" size="256" summ="default" type="STRING"/>
					<colinfo id="EQME94" size="256" summ="default" type="STRING"/>
					<colinfo id="EQME95" size="256" summ="default" type="STRING"/>
					<colinfo id="EQME96" size="256" summ="default" type="STRING"/>
					<colinfo id="EQME97" size="256" summ="default" type="STRING"/>
					<colinfo id="EQME98" size="256" summ="default" type="STRING"/>
					<colinfo id="EQME99" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cost">
				<Contents>
					<colinfo id="DIV" size="1" type="STRING"/>
					<colinfo id="GBN" size="1" type="STRING"/>
					<colinfo id="GJAHR" size="4" type="STRING"/>
					<colinfo id="POPER" size="3" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_template_save">
				<Contents>
					<colinfo id="FLAG" size="1" type="STRING"/>
					<colinfo id="MANDT" size="256" type="STRING"/>
					<colinfo id="ZTPLNO" size="256" type="STRING"/>
					<colinfo id="ZTPLSEQ" size="256" type="STRING"/>
					<colinfo id="PRH" size="256" type="STRING"/>
					<colinfo id="PRHNAME" size="256" type="STRING"/>
					<colinfo id="PRD" size="256" type="STRING"/>
					<colinfo id="ZRMK" size="256" type="STRING"/>
					<colinfo id="MCLASS" size="256" type="STRING"/>
					<colinfo id="ZTPLNM" size="256" type="STRING"/>
					<colinfo id="ATKLA" size="256" type="STRING"/>
					<colinfo id="QTNUM" size="256" type="STRING"/>
					<colinfo id="QTSER" size="256" type="STRING"/>
					<colinfo id="QTSEQ" size="256" type="STRING"/>
					<colinfo id="PRSEQ" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list1">
				<Contents>
					<colinfo id="GNM" size="256" summ="default" type="STRING"/>
					<colinfo id="SPT" size="256" summ="default" type="STRING"/>
					<colinfo id="QTY" size="256" summ="default" type="STRING"/>
					<colinfo id="EAM" size="256" summ="default" type="STRING"/>
					<colinfo id="OAM" size="256" summ="default" type="STRING"/>
					<colinfo id="RAT" size="256" summ="default" type="STRING"/>
					<colinfo id="GAM" size="256" summ="default" type="STRING"/>
					<colinfo id="CDT" size="256" summ="default" type="STRING"/>
					<colinfo id="COM" size="256" summ="default" type="STRING"/>
					<colinfo id="RDT" size="256" summ="default" type="STRING"/>
					<colinfo id="MON" size="256" summ="default" type="STRING"/>
					<colinfo id="AD1" size="256" summ="default" type="STRING"/>
					<colinfo id="AD2" size="256" summ="default" type="STRING"/>
					<colinfo id="TEL" size="256" summ="default" type="STRING"/>
					<colinfo id="FAX" size="256" summ="default" type="STRING"/>
					<colinfo id="CEL" size="256" summ="default" type="STRING"/>
					<colinfo id="NAM" size="256" summ="default" type="STRING"/>
					<colinfo id="T01" size="256" summ="default" type="STRING"/>
					<colinfo id="T02" size="256" summ="default" type="STRING"/>
					<colinfo id="T03" size="256" summ="default" type="STRING"/>
					<colinfo id="T04" size="256" summ="default" type="STRING"/>
					<colinfo id="T05" size="256" summ="default" type="STRING"/>
					<colinfo id="T06" size="256" summ="default" type="STRING"/>
					<colinfo id="T07" size="256" summ="default" type="STRING"/>
					<colinfo id="T08" size="256" summ="default" type="STRING"/>
					<colinfo id="T09" size="256" summ="default" type="STRING"/>
					<colinfo id="T10" size="256" summ="default" type="STRING"/>
					<colinfo id="PID" size="256" summ="default" type="STRING"/>
					<colinfo id="P01" size="256" summ="default" type="STRING"/>
					<colinfo id="P02" size="256" summ="default" type="STRING"/>
					<colinfo id="P03" size="256" summ="default" type="STRING"/>
					<colinfo id="P04" size="256" summ="default" type="STRING"/>
					<colinfo id="C01" size="256" summ="default" type="STRING"/>
					<colinfo id="C02" size="256" summ="default" type="STRING"/>
					<colinfo id="C03" size="256" summ="default" type="STRING"/>
					<colinfo id="C04" size="256" summ="default" type="STRING"/>
					<colinfo id="PST" size="256" summ="default" type="STRING"/>
					<colinfo id="PST_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="MNO" size="256" summ="default" type="STRING"/>
					<colinfo id="SPART" size="256" summ="default" type="STRING"/>
					<colinfo id="WAERK" size="256" summ="default" type="STRING"/>
					<colinfo id="AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="MAIL" size="256" summ="default" type="STRING"/>
					<colinfo id="D01" size="256" summ="default" type="STRING"/>
					<colinfo id="D02" size="256" summ="default" type="STRING"/>
					<colinfo id="D03" size="256" summ="default" type="STRING"/>
					<colinfo id="D04" size="256" summ="default" type="STRING"/>
					<colinfo id="AGNTP" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list2">
				<Contents>
					<colinfo id="RNO_01" size="256" summ="default" type="STRING"/>
					<colinfo id="USE_01" size="256" summ="default" type="STRING"/>
					<colinfo id="SPC_01" size="256" summ="default" type="STRING"/>
					<colinfo id="QTY_01" size="256" summ="default" type="STRING"/>
					<colinfo id="AMT_01" size="256" summ="default" type="STRING"/>
					<colinfo id="GAM_01" size="256" summ="default" type="STRING"/>
					<colinfo id="UNM_01" size="256" summ="default" type="STRING"/>
					<colinfo id="RNO_02" size="256" summ="default" type="STRING"/>
					<colinfo id="USE_02" size="256" summ="default" type="STRING"/>
					<colinfo id="SPC_02" size="256" summ="default" type="STRING"/>
					<colinfo id="QTY_02" size="256" summ="default" type="STRING"/>
					<colinfo id="AMT_02" size="256" summ="default" type="STRING"/>
					<colinfo id="GAM_02" size="256" summ="default" type="STRING"/>
					<colinfo id="UNM_02" size="256" summ="default" type="STRING"/>
					<colinfo id="RNO_03" size="256" summ="default" type="STRING"/>
					<colinfo id="USE_03" size="256" summ="default" type="STRING"/>
					<colinfo id="SPC_03" size="256" summ="default" type="STRING"/>
					<colinfo id="QTY_03" size="256" summ="default" type="STRING"/>
					<colinfo id="AMT_03" size="256" summ="default" type="STRING"/>
					<colinfo id="GAM_03" size="256" summ="default" type="STRING"/>
					<colinfo id="UNM_03" size="256" summ="default" type="STRING"/>
					<colinfo id="RNO_04" size="256" summ="default" type="STRING"/>
					<colinfo id="USE_04" size="256" summ="default" type="STRING"/>
					<colinfo id="SPC_04" size="256" summ="default" type="STRING"/>
					<colinfo id="QTY_04" size="256" summ="default" type="STRING"/>
					<colinfo id="AMT_04" size="256" summ="default" type="STRING"/>
					<colinfo id="GAM_04" size="256" summ="default" type="STRING"/>
					<colinfo id="UNM_04" size="256" summ="default" type="STRING"/>
					<colinfo id="RNO_05" size="256" summ="default" type="STRING"/>
					<colinfo id="USE_05" size="256" summ="default" type="STRING"/>
					<colinfo id="SPC_05" size="256" summ="default" type="STRING"/>
					<colinfo id="QTY_05" size="256" summ="default" type="STRING"/>
					<colinfo id="AMT_05" size="256" summ="default" type="STRING"/>
					<colinfo id="GAM_05" size="256" summ="default" type="STRING"/>
					<colinfo id="UNM_05" size="256" summ="default" type="STRING"/>
					<colinfo id="RNO_06" size="256" summ="default" type="STRING"/>
					<colinfo id="USE_06" size="256" summ="default" type="STRING"/>
					<colinfo id="SPC_06" size="256" summ="default" type="STRING"/>
					<colinfo id="QTY_06" size="256" summ="default" type="STRING"/>
					<colinfo id="AMT_06" size="256" summ="default" type="STRING"/>
					<colinfo id="GAM_06" size="256" summ="default" type="STRING"/>
					<colinfo id="UNM_06" size="256" summ="default" type="STRING"/>
					<colinfo id="RNO_07" size="256" summ="default" type="STRING"/>
					<colinfo id="USE_07" size="256" summ="default" type="STRING"/>
					<colinfo id="SPC_07" size="256" summ="default" type="STRING"/>
					<colinfo id="QTY_07" size="256" summ="default" type="STRING"/>
					<colinfo id="AMT_07" size="256" summ="default" type="STRING"/>
					<colinfo id="GAM_07" size="256" summ="default" type="STRING"/>
					<colinfo id="UNM_07" size="256" summ="default" type="STRING"/>
					<colinfo id="RNO_08" size="256" summ="default" type="STRING"/>
					<colinfo id="USE_08" size="256" summ="default" type="STRING"/>
					<colinfo id="SPC_08" size="256" summ="default" type="STRING"/>
					<colinfo id="QTY_08" size="256" summ="default" type="STRING"/>
					<colinfo id="AMT_08" size="256" summ="default" type="STRING"/>
					<colinfo id="GAM_08" size="256" summ="default" type="STRING"/>
					<colinfo id="UNM_08" size="256" summ="default" type="STRING"/>
					<colinfo id="RNO_09" size="256" summ="default" type="STRING"/>
					<colinfo id="USE_09" size="256" summ="default" type="STRING"/>
					<colinfo id="SPC_09" size="256" summ="default" type="STRING"/>
					<colinfo id="QTY_09" size="256" summ="default" type="STRING"/>
					<colinfo id="AMT_09" size="256" summ="default" type="STRING"/>
					<colinfo id="GAM_09" size="256" summ="default" type="STRING"/>
					<colinfo id="UNM_09" size="256" summ="default" type="STRING"/>
					<colinfo id="RNO_10" size="256" summ="default" type="STRING"/>
					<colinfo id="USE_10" size="256" summ="default" type="STRING"/>
					<colinfo id="SPC_10" size="256" summ="default" type="STRING"/>
					<colinfo id="QTY_10" size="256" summ="default" type="STRING"/>
					<colinfo id="AMT_10" size="256" summ="default" type="STRING"/>
					<colinfo id="GAM_10" size="256" summ="default" type="STRING"/>
					<colinfo id="UNM_10" size="256" summ="default" type="STRING"/>
					<colinfo id="QTY" size="256" summ="default" type="STRING"/>
					<colinfo id="AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="WAERK" size="256" summ="default" type="STRING"/>
					<colinfo id="TYPE1_01" size="256" summ="default" type="STRING"/>
					<colinfo id="TYPE2_01" size="256" summ="default" type="STRING"/>
					<colinfo id="TYPE3_01" size="256" summ="default" type="STRING"/>
					<colinfo id="ZOPN_01" size="256" summ="default" type="STRING"/>
					<colinfo id="ZLEN_01" size="256" summ="default" type="STRING"/>
					<colinfo id="EA_01" size="256" summ="default" type="STRING"/>
					<colinfo id="TYPE1_02" size="256" summ="default" type="STRING"/>
					<colinfo id="TYPE2_02" size="256" summ="default" type="STRING"/>
					<colinfo id="TYPE3_02" size="256" summ="default" type="STRING"/>
					<colinfo id="ZOPN_02" size="256" summ="default" type="STRING"/>
					<colinfo id="ZLEN_02" size="256" summ="default" type="STRING"/>
					<colinfo id="EA_02" size="256" summ="default" type="STRING"/>
					<colinfo id="TYPE1_03" size="256" summ="default" type="STRING"/>
					<colinfo id="TYPE2_03" size="256" summ="default" type="STRING"/>
					<colinfo id="TYPE3_03" size="256" summ="default" type="STRING"/>
					<colinfo id="ZOPN_03" size="256" summ="default" type="STRING"/>
					<colinfo id="ZLEN_03" size="256" summ="default" type="STRING"/>
					<colinfo id="EA_03" size="256" summ="default" type="STRING"/>
					<colinfo id="TYPE1_04" size="256" summ="default" type="STRING"/>
					<colinfo id="TYPE2_04" size="256" summ="default" type="STRING"/>
					<colinfo id="TYPE3_04" size="256" summ="default" type="STRING"/>
					<colinfo id="ZOPN_04" size="256" summ="default" type="STRING"/>
					<colinfo id="ZLEN_04" size="256" summ="default" type="STRING"/>
					<colinfo id="EA_04" size="256" summ="default" type="STRING"/>
					<colinfo id="TYPE1_05" size="256" summ="default" type="STRING"/>
					<colinfo id="TYPE2_05" size="256" summ="default" type="STRING"/>
					<colinfo id="TYPE3_05" size="256" summ="default" type="STRING"/>
					<colinfo id="ZOPN_05" size="256" summ="default" type="STRING"/>
					<colinfo id="ZLEN_05" size="256" summ="default" type="STRING"/>
					<colinfo id="EA_05" size="256" summ="default" type="STRING"/>
					<colinfo id="TYPE1_06" size="256" summ="default" type="STRING"/>
					<colinfo id="TYPE2_06" size="256" summ="default" type="STRING"/>
					<colinfo id="TYPE3_06" size="256" summ="default" type="STRING"/>
					<colinfo id="ZOPN_06" size="256" summ="default" type="STRING"/>
					<colinfo id="ZLEN_06" size="256" summ="default" type="STRING"/>
					<colinfo id="EA_06" size="256" summ="default" type="STRING"/>
					<colinfo id="TYPE1_07" size="256" summ="default" type="STRING"/>
					<colinfo id="TYPE2_07" size="256" summ="default" type="STRING"/>
					<colinfo id="TYPE3_07" size="256" summ="default" type="STRING"/>
					<colinfo id="ZOPN_07" size="256" summ="default" type="STRING"/>
					<colinfo id="ZLEN_07" size="256" summ="default" type="STRING"/>
					<colinfo id="EA_07" size="256" summ="default" type="STRING"/>
					<colinfo id="TYPE1_08" size="256" summ="default" type="STRING"/>
					<colinfo id="TYPE2_08" size="256" summ="default" type="STRING"/>
					<colinfo id="TYPE3_08" size="256" summ="default" type="STRING"/>
					<colinfo id="ZOPN_08" size="256" summ="default" type="STRING"/>
					<colinfo id="ZLEN_08" size="256" summ="default" type="STRING"/>
					<colinfo id="EA_08" size="256" summ="default" type="STRING"/>
					<colinfo id="TYPE1_09" size="256" summ="default" type="STRING"/>
					<colinfo id="TYPE2_09" size="256" summ="default" type="STRING"/>
					<colinfo id="TYPE3_09" size="256" summ="default" type="STRING"/>
					<colinfo id="ZOPN_09" size="256" summ="default" type="STRING"/>
					<colinfo id="ZLEN_09" size="256" summ="default" type="STRING"/>
					<colinfo id="EA_09" size="256" summ="default" type="STRING"/>
					<colinfo id="TYPE1_10" size="256" summ="default" type="STRING"/>
					<colinfo id="TYPE2_10" size="256" summ="default" type="STRING"/>
					<colinfo id="TYPE3_10" size="256" summ="default" type="STRING"/>
					<colinfo id="ZOPN_10" size="256" summ="default" type="STRING"/>
					<colinfo id="ZLEN_10" size="256" summ="default" type="STRING"/>
					<colinfo id="EA_10" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_user0">
				<Contents>
					<colinfo id="FLAG" size="1" type="STRING"/>
					<colinfo id="CHK" size="1" type="STRING"/>
					<colinfo id="MANDT" size="256" type="STRING"/>
					<colinfo id="ZTPLNO" size="256" type="STRING"/>
					<colinfo id="ZTPLSEQ" size="256" type="STRING"/>
					<colinfo id="PRH" size="256" type="STRING"/>
					<colinfo id="PRHNAME" size="256" type="STRING"/>
					<colinfo id="PRD" size="256" type="STRING"/>
					<colinfo id="ZRMK" size="256" type="STRING"/>
					<colinfo id="MCLASS" size="256" type="STRING"/>
					<colinfo id="ZTPLNM" size="256" type="STRING"/>
					<colinfo id="ATKLA" size="256" type="STRING"/>
					<colinfo id="QTNUM" size="256" type="STRING"/>
					<colinfo id="QTSER" size="256" type="STRING"/>
					<colinfo id="QTSEQ" size="256" type="STRING"/>
					<colinfo id="PRSEQ" size="256" type="STRING"/>
					<colinfo id="CNT" size="256" type="STRING"/>
					<colinfo id="ATFOR" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_user1">
				<Contents>
					<colinfo id="FLAG" size="1" type="STRING"/>
					<colinfo id="CHK" size="1" type="STRING"/>
					<colinfo id="MANDT" size="256" type="STRING"/>
					<colinfo id="ZTPLNO" size="256" type="STRING"/>
					<colinfo id="ZTPLSEQ" size="256" type="STRING"/>
					<colinfo id="PRH" size="256" type="STRING"/>
					<colinfo id="PRHNAME" size="256" type="STRING"/>
					<colinfo id="PRD" size="256" type="STRING"/>
					<colinfo id="ZRMK" size="256" type="STRING"/>
					<colinfo id="MCLASS" size="256" type="STRING"/>
					<colinfo id="ZTPLNM" size="256" type="STRING"/>
					<colinfo id="ATKLA" size="256" type="STRING"/>
					<colinfo id="QTNUM" size="256" type="STRING"/>
					<colinfo id="QTSER" size="256" type="STRING"/>
					<colinfo id="QTSEQ" size="256" type="STRING"/>
					<colinfo id="PRSEQ" size="256" type="STRING"/>
					<colinfo id="CNT" size="256" type="STRING"/>
					<colinfo id="ATFOR" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_user2">
				<Contents>
					<colinfo id="FLAG" size="1" type="STRING"/>
					<colinfo id="CHK" size="1" type="STRING"/>
					<colinfo id="MANDT" size="256" type="STRING"/>
					<colinfo id="ZTPLNO" size="256" type="STRING"/>
					<colinfo id="ZTPLSEQ" size="256" type="STRING"/>
					<colinfo id="PRH" size="256" type="STRING"/>
					<colinfo id="PRHNAME" size="256" type="STRING"/>
					<colinfo id="PRD" size="256" type="STRING"/>
					<colinfo id="ZRMK" size="256" type="STRING"/>
					<colinfo id="MCLASS" size="256" type="STRING"/>
					<colinfo id="ZTPLNM" size="256" type="STRING"/>
					<colinfo id="ATKLA" size="256" type="STRING"/>
					<colinfo id="QTNUM" size="256" type="STRING"/>
					<colinfo id="QTSER" size="256" type="STRING"/>
					<colinfo id="QTSEQ" size="256" type="STRING"/>
					<colinfo id="PRSEQ" size="256" type="STRING"/>
					<colinfo id="CNT" size="256" type="STRING"/>
					<colinfo id="ATFOR" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_user3">
				<Contents>
					<colinfo id="FLAG" size="1" type="STRING"/>
					<colinfo id="CHK" size="1" type="STRING"/>
					<colinfo id="MANDT" size="256" type="STRING"/>
					<colinfo id="ZTPLNO" size="256" type="STRING"/>
					<colinfo id="ZTPLSEQ" size="256" type="STRING"/>
					<colinfo id="PRH" size="256" type="STRING"/>
					<colinfo id="PRHNAME" size="256" type="STRING"/>
					<colinfo id="PRD" size="256" type="STRING"/>
					<colinfo id="ZRMK" size="256" type="STRING"/>
					<colinfo id="MCLASS" size="256" type="STRING"/>
					<colinfo id="ZTPLNM" size="256" type="STRING"/>
					<colinfo id="ATKLA" size="256" type="STRING"/>
					<colinfo id="QTNUM" size="256" type="STRING"/>
					<colinfo id="QTSER" size="256" type="STRING"/>
					<colinfo id="QTSEQ" size="256" type="STRING"/>
					<colinfo id="PRSEQ" size="256" type="STRING"/>
					<colinfo id="CNT" size="256" type="STRING"/>
					<colinfo id="ATFOR" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_user4">
				<Contents>
					<colinfo id="FLAG" size="1" type="STRING"/>
					<colinfo id="CHK" size="1" type="STRING"/>
					<colinfo id="MANDT" size="256" type="STRING"/>
					<colinfo id="ZTPLNO" size="256" type="STRING"/>
					<colinfo id="ZTPLSEQ" size="256" type="STRING"/>
					<colinfo id="PRH" size="256" type="STRING"/>
					<colinfo id="PRHNAME" size="256" type="STRING"/>
					<colinfo id="PRD" size="256" type="STRING"/>
					<colinfo id="ZRMK" size="256" type="STRING"/>
					<colinfo id="MCLASS" size="256" type="STRING"/>
					<colinfo id="ZTPLNM" size="256" type="STRING"/>
					<colinfo id="ATKLA" size="256" type="STRING"/>
					<colinfo id="QTNUM" size="256" type="STRING"/>
					<colinfo id="QTSER" size="256" type="STRING"/>
					<colinfo id="QTSEQ" size="256" type="STRING"/>
					<colinfo id="PRSEQ" size="256" type="STRING"/>
					<colinfo id="CNT" size="256" type="STRING"/>
					<colinfo id="ATFOR" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_user5">
				<Contents>
					<colinfo id="FLAG" size="1" type="STRING"/>
					<colinfo id="CHK" size="1" type="STRING"/>
					<colinfo id="MANDT" size="256" type="STRING"/>
					<colinfo id="ZTPLNO" size="256" type="STRING"/>
					<colinfo id="ZTPLSEQ" size="256" type="STRING"/>
					<colinfo id="PRH" size="256" type="STRING"/>
					<colinfo id="PRHNAME" size="256" type="STRING"/>
					<colinfo id="PRD" size="256" type="STRING"/>
					<colinfo id="ZRMK" size="256" type="STRING"/>
					<colinfo id="MCLASS" size="256" type="STRING"/>
					<colinfo id="ZTPLNM" size="256" type="STRING"/>
					<colinfo id="ATKLA" size="256" type="STRING"/>
					<colinfo id="QTNUM" size="256" type="STRING"/>
					<colinfo id="QTSER" size="256" type="STRING"/>
					<colinfo id="QTSEQ" size="256" type="STRING"/>
					<colinfo id="PRSEQ" size="256" type="STRING"/>
					<colinfo id="CNT" size="256" type="STRING"/>
					<colinfo id="ATFOR" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_template_add">
				<Contents>
					<colinfo id="FLAG" size="1" summ="default" type="STRING"/>
					<colinfo id="CHK" size="1" summ="default" type="STRING"/>
					<colinfo id="MANDT" size="256" summ="default" type="STRING"/>
					<colinfo id="ZTPLNO" size="256" summ="default" type="STRING"/>
					<colinfo id="ZTPLSEQ" size="256" summ="default" type="INT"/>
					<colinfo id="PRH" size="256" summ="default" type="STRING"/>
					<colinfo id="PRHNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="PRD" size="256" summ="default" type="STRING"/>
					<colinfo id="ZRMK" size="256" summ="default" type="STRING"/>
					<colinfo id="MCLASS" size="256" summ="default" type="STRING"/>
					<colinfo id="ZTPLNM" size="256" summ="default" type="STRING"/>
					<colinfo id="ATKLA" size="256" summ="default" type="STRING"/>
					<colinfo id="QTNUM" size="256" summ="default" type="STRING"/>
					<colinfo id="QTSER" size="256" summ="default" type="STRING"/>
					<colinfo id="QTSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="PRSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="ATFOR" size="256" summ="default" type="STRING"/>
					<colinfo id="PCNCD" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_inco1">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_report">
				<Contents>
					<colinfo id="ZKUNNR" size="256" summ="default" type="STRING"/>
					<colinfo id="VKGRT" size="256" summ="default" type="STRING"/>
					<colinfo id="QTNUM" size="256" summ="default" type="STRING"/>
					<colinfo id="QTSER" size="256" summ="default" type="STRING"/>
					<colinfo id="QTSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="GSNAM" size="256" summ="default" type="STRING"/>
					<colinfo id="KUNNR" size="256" summ="default" type="STRING"/>
					<colinfo id="SPART" size="256" summ="default" type="STRING"/>
					<colinfo id="MODEL" size="256" summ="default" type="STRING"/>
					<colinfo id="DELDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="PR" size="256" summ="default" type="STRING"/>
					<colinfo id="EQ" size="256" summ="default" type="STRING"/>
					<colinfo id="CT" size="256" summ="default" type="STRING"/>
					<colinfo id="FDSP" size="256" summ="default" type="STRING"/>
					<colinfo id="ZUAM" size="256" summ="default" type="STRING"/>
					<colinfo id="ADDT" size="256" summ="default" type="STRING"/>
					<colinfo id="EL_ATYP" size="256" summ="default" type="STRING"/>
					<colinfo id="EL_AUSE" size="256" summ="default" type="STRING"/>
					<colinfo id="EL_AOPEN" size="256" summ="default" type="STRING"/>
					<colinfo id="EL_ASPD" size="256" summ="default" type="STRING"/>
					<colinfo id="EL_AFQ" size="256" summ="default" type="STRING"/>
					<colinfo id="EL_ASTQ" size="256" summ="default" type="STRING"/>
					<colinfo id="EL_ACD2" size="256" summ="default" type="STRING"/>
					<colinfo id="EL_ATT" size="256" summ="default" type="STRING"/>
					<colinfo id="EL_ADTA" size="256" summ="default" type="STRING"/>
					<colinfo id="EL_FDNCMQ" size="256" summ="default" type="STRING"/>
					<colinfo id="EL_FDWUQ" size="256" summ="default" type="STRING"/>
					<colinfo id="EL_FDSMDQ" size="256" summ="default" type="STRING"/>
					<colinfo id="EL_FDSMSQ" size="256" summ="default" type="STRING"/>
					<colinfo id="EL_ADRV" size="256" summ="default" type="STRING"/>
					<colinfo id="EL_BMDL" size="256" summ="default" type="STRING"/>
					<colinfo id="EL_BCL" size="256" summ="default" type="STRING"/>
					<colinfo id="EL_BFR" size="256" summ="default" type="STRING"/>
					<colinfo id="EL_BFS" size="256" summ="default" type="STRING"/>
					<colinfo id="EL_BWM" size="256" summ="default" type="STRING"/>
					<colinfo id="EL_BWHG" size="256" summ="default" type="STRING"/>
					<colinfo id="EL_BMOPB" size="256" summ="default" type="STRING"/>
					<colinfo id="EL_BSOPB" size="256" summ="default" type="STRING"/>
					<colinfo id="EL_BHOPB" size="256" summ="default" type="STRING"/>
					<colinfo id="EL_BCDM" size="256" summ="default" type="STRING"/>
					<colinfo id="EL_BCDHG" size="256" summ="default" type="STRING"/>
					<colinfo id="EL_BCPI" size="256" summ="default" type="STRING"/>
					<colinfo id="EL_CJM1" size="256" summ="default" type="STRING"/>
					<colinfo id="EL_CJM1Q" size="256" summ="default" type="STRING"/>
					<colinfo id="EL_CJM1M" size="256" summ="default" type="STRING"/>
					<colinfo id="EL_CJM1HG" size="256" summ="default" type="STRING"/>
					<colinfo id="EL_CHPI1" size="256" summ="default" type="STRING"/>
					<colinfo id="EL_CJM2" size="256" summ="default" type="STRING"/>
					<colinfo id="EL_CJM2Q" size="256" summ="default" type="STRING"/>
					<colinfo id="EL_CJM2M" size="256" summ="default" type="STRING"/>
					<colinfo id="EL_CJM2HG" size="256" summ="default" type="STRING"/>
					<colinfo id="EL_CHPI2" size="256" summ="default" type="STRING"/>
					<colinfo id="EL_CJM3" size="256" summ="default" type="STRING"/>
					<colinfo id="EL_CJM3Q" size="256" summ="default" type="STRING"/>
					<colinfo id="EL_CJM3M" size="256" summ="default" type="STRING"/>
					<colinfo id="EL_CJM3HG" size="256" summ="default" type="STRING"/>
					<colinfo id="EL_CHPI3" size="256" summ="default" type="STRING"/>
					<colinfo id="EL_CJM4" size="256" summ="default" type="STRING"/>
					<colinfo id="EL_CJM4Q" size="256" summ="default" type="STRING"/>
					<colinfo id="EL_CJM4M" size="256" summ="default" type="STRING"/>
					<colinfo id="EL_CJM4HG" size="256" summ="default" type="STRING"/>
					<colinfo id="EL_CHPI4" size="256" summ="default" type="STRING"/>
					<colinfo id="EL_CHD1" size="256" summ="default" type="STRING"/>
					<colinfo id="EL_CHD1HG" size="256" summ="default" type="STRING"/>
					<colinfo id="EL_CHD1Q" size="256" summ="default" type="STRING"/>
					<colinfo id="EL_CHD2" size="256" summ="default" type="STRING"/>
					<colinfo id="EL_CHD2HG" size="256" summ="default" type="STRING"/>
					<colinfo id="EL_CHD2Q" size="256" summ="default" type="STRING"/>
					<colinfo id="EL_CHD3" size="256" summ="default" type="STRING"/>
					<colinfo id="EL_CHD3HG" size="256" summ="default" type="STRING"/>
					<colinfo id="EL_CHD3Q" size="256" summ="default" type="STRING"/>
					<colinfo id="EL_CHPBM1" size="256" summ="default" type="STRING"/>
					<colinfo id="EL_CHPBM1Q" size="256" summ="default" type="STRING"/>
					<colinfo id="EL_CHPBM2" size="256" summ="default" type="STRING"/>
					<colinfo id="EL_CHPBM2Q" size="256" summ="default" type="STRING"/>
					<colinfo id="EL_CHPBT" size="256" summ="default" type="STRING"/>
					<colinfo id="EL_CHPBTQ" size="256" summ="default" type="STRING"/>
					<colinfo id="EL_CHPBB" size="256" summ="default" type="STRING"/>
					<colinfo id="EL_CHPBBQ" size="256" summ="default" type="STRING"/>
					<colinfo id="EL_CHIPM1" size="256" summ="default" type="STRING"/>
					<colinfo id="EL_CHIPM1Q" size="256" summ="default" type="STRING"/>
					<colinfo id="EL_CHIPM2" size="256" summ="default" type="STRING"/>
					<colinfo id="EL_CHIPM2Q" size="256" summ="default" type="STRING"/>
					<colinfo id="EL_CHIPT" size="256" summ="default" type="STRING"/>
					<colinfo id="EL_CHIPTQ" size="256" summ="default" type="STRING"/>
					<colinfo id="EL_CHIPB" size="256" summ="default" type="STRING"/>
					<colinfo id="EL_CHIPBQ" size="256" summ="default" type="STRING"/>
					<colinfo id="EL_COB" size="256" summ="default" type="STRING"/>
					<colinfo id="EL_ECCH" size="256" summ="default" type="STRING"/>
					<colinfo id="EL_ECJJ" size="256" summ="default" type="STRING"/>
					<colinfo id="EL_ECHH" size="256" summ="default" type="STRING"/>
					<colinfo id="EL_EHO" size="256" summ="default" type="STRING"/>
					<colinfo id="EL_EHTRH" size="256" summ="default" type="STRING"/>
					<colinfo id="EL_EHP" size="256" summ="default" type="STRING"/>
					<colinfo id="EL_EHTH" size="256" summ="default" type="STRING"/>
					<colinfo id="EL_ETM" size="256" summ="default" type="STRING"/>
					<colinfo id="EL_ETMM" size="256" summ="default" type="STRING"/>
					<colinfo id="EL_ECSF" size="256" summ="default" type="STRING"/>
					<colinfo id="EL_ECRL" size="256" summ="default" type="STRING"/>
					<colinfo id="EL_ECWRL" size="256" summ="default" type="STRING"/>
					<colinfo id="FDS01" size="256" summ="default" type="STRING"/>
					<colinfo id="FDSP01" size="256" summ="default" type="STRING"/>
					<colinfo id="FDS02" size="256" summ="default" type="STRING"/>
					<colinfo id="FDSP02" size="256" summ="default" type="STRING"/>
					<colinfo id="FDS03" size="256" summ="default" type="STRING"/>
					<colinfo id="FDSP03" size="256" summ="default" type="STRING"/>
					<colinfo id="FDS04" size="256" summ="default" type="STRING"/>
					<colinfo id="FDSP04" size="256" summ="default" type="STRING"/>
					<colinfo id="FDS05" size="256" summ="default" type="STRING"/>
					<colinfo id="FDSP05" size="256" summ="default" type="STRING"/>
					<colinfo id="FDS06" size="256" summ="default" type="STRING"/>
					<colinfo id="FDSP06" size="256" summ="default" type="STRING"/>
					<colinfo id="FDS07" size="256" summ="default" type="STRING"/>
					<colinfo id="FDSP07" size="256" summ="default" type="STRING"/>
					<colinfo id="FDS08" size="256" summ="default" type="STRING"/>
					<colinfo id="FDSP08" size="256" summ="default" type="STRING"/>
					<colinfo id="FDS09" size="256" summ="default" type="STRING"/>
					<colinfo id="FDSP09" size="256" summ="default" type="STRING"/>
					<colinfo id="FDS10" size="256" summ="default" type="STRING"/>
					<colinfo id="FDSP10" size="256" summ="default" type="STRING"/>
					<colinfo id="FDSP11" size="256" summ="default" type="STRING"/>
					<colinfo id="EQML03" size="256" summ="default" type="STRING"/>
					<colinfo id="EQME01" size="256" summ="default" type="STRING"/>
					<colinfo id="EQME88" size="256" summ="default" type="STRING"/>
					<colinfo id="EQME04" size="256" summ="default" type="STRING"/>
					<colinfo id="EQME06" size="256" summ="default" type="STRING"/>
					<colinfo id="EQME86" size="256" summ="default" type="STRING"/>
					<colinfo id="EQME83" size="256" summ="default" type="STRING"/>
					<colinfo id="EQME84" size="256" summ="default" type="STRING"/>
					<colinfo id="EQME85" size="256" summ="default" type="STRING"/>
					<colinfo id="EQMO07" size="256" summ="default" type="STRING"/>
					<colinfo id="EQME55" size="256" summ="default" type="STRING"/>
					<colinfo id="EQME56" size="256" summ="default" type="STRING"/>
					<colinfo id="EQME59" size="256" summ="default" type="STRING"/>
					<colinfo id="EQME60" size="256" summ="default" type="STRING"/>
					<colinfo id="EQME61" size="256" summ="default" type="STRING"/>
					<colinfo id="EQME62" size="256" summ="default" type="STRING"/>
					<colinfo id="EQME63" size="256" summ="default" type="STRING"/>
					<colinfo id="EQME65" size="256" summ="default" type="STRING"/>
					<colinfo id="EQME66" size="256" summ="default" type="STRING"/>
					<colinfo id="EQME67" size="256" summ="default" type="STRING"/>
					<colinfo id="EQME73" size="256" summ="default" type="STRING"/>
					<colinfo id="EQME75" size="256" summ="default" type="STRING"/>
					<colinfo id="EQME76" size="256" summ="default" type="STRING"/>
					<colinfo id="EQME77" size="256" summ="default" type="STRING"/>
					<colinfo id="EQME78" size="256" summ="default" type="STRING"/>
					<colinfo id="EQME79" size="256" summ="default" type="STRING"/>
					<colinfo id="EQME80" size="256" summ="default" type="STRING"/>
					<colinfo id="EQME81" size="256" summ="default" type="STRING"/>
					<colinfo id="EQME82" size="256" summ="default" type="STRING"/>
					<colinfo id="EQME87" size="256" summ="default" type="STRING"/>
					<colinfo id="EL_AWID" size="256" summ="default" type="STRING"/>
					<colinfo id="EL_ADEG" size="256" summ="default" type="STRING"/>
					<colinfo id="EL_ARISE" size="256" summ="default" type="STRING"/>
					<colinfo id="EL_AFLAT" size="256" summ="default" type="STRING"/>
					<colinfo id="EL_ASPE" size="256" summ="default" type="STRING"/>
					<colinfo id="EL_AMOT" size="256" summ="default" type="STRING"/>
					<colinfo id="EL_ASTC" size="256" summ="default" type="STRING"/>
					<colinfo id="EL_AGCOL" size="256" summ="default" type="STRING"/>
					<colinfo id="EL_AHCOL" size="256" summ="default" type="STRING"/>
					<colinfo id="EL_AIODK" size="256" summ="default" type="STRING"/>
					<colinfo id="EL_ASKTPN" size="256" summ="default" type="STRING"/>
					<colinfo id="EL_ASUBW" size="256" summ="default" type="STRING"/>
					<colinfo id="EL_BBRU" size="256" summ="default" type="STRING"/>
					<colinfo id="EL_BMP" size="256" summ="default" type="STRING"/>
					<colinfo id="EL_CUSL" size="256" summ="default" type="STRING"/>
					<colinfo id="EL_DSOF" size="256" summ="default" type="STRING"/>
					<colinfo id="EL_DGR" size="256" summ="default" type="STRING"/>
					<colinfo id="EL_DBARR" size="256" summ="default" type="STRING"/>
					<colinfo id="EL_ALOCA" size="256" summ="default" type="STRING"/>
					<colinfo id="WAERK" size="256" summ="default" type="STRING"/>
					<colinfo id="EL_AMAN" size="256" summ="default" type="STRING"/>
					<colinfo id="EL_ECW" size="256" summ="default" type="STRING"/>
					<colinfo id="EL_ECWAD" size="256" summ="default" type="STRING"/>
					<colinfo id="EQME89" size="256" summ="default" type="STRING"/>
					<colinfo id="EQME51" size="256" summ="default" type="STRING"/>
					<colinfo id="EQMO01" size="256" summ="default" type="STRING"/>
					<colinfo id="EQMO02" size="256" summ="default" type="STRING"/>
					<colinfo id="EQMO03" size="256" summ="default" type="STRING"/>
					<colinfo id="EQMO15" size="256" summ="default" type="STRING"/>
					<colinfo id="EQMO04" size="256" summ="default" type="STRING"/>
					<colinfo id="EQMO05" size="256" summ="default" type="STRING"/>
					<colinfo id="EQMO06" size="256" summ="default" type="STRING"/>
					<colinfo id="EQMO08" size="256" summ="default" type="STRING"/>
					<colinfo id="EQMO09" size="256" summ="default" type="STRING"/>
					<colinfo id="EQMO10" size="256" summ="default" type="STRING"/>
					<colinfo id="EQMO11" size="256" summ="default" type="STRING"/>
					<colinfo id="EQMO12" size="256" summ="default" type="STRING"/>
					<colinfo id="EQMO13" size="256" summ="default" type="STRING"/>
					<colinfo id="EQMO14" size="256" summ="default" type="STRING"/>
					<colinfo id="EQMO16" size="256" summ="default" type="STRING"/>
					<colinfo id="EQMO17" size="256" summ="default" type="STRING"/>
					<colinfo id="EQMO18" size="256" summ="default" type="STRING"/>
					<colinfo id="EQMO19" size="256" summ="default" type="STRING"/>
					<colinfo id="EQMO20" size="256" summ="default" type="STRING"/>
					<colinfo id="EQME11" size="256" summ="default" type="STRING"/>
					<colinfo id="EQME12" size="256" summ="default" type="STRING"/>
					<colinfo id="EQME57" size="256" summ="default" type="STRING"/>
					<colinfo id="EQME58" size="256" summ="default" type="STRING"/>
					<colinfo id="EQME64" size="256" summ="default" type="STRING"/>
					<colinfo id="EQME69" size="256" summ="default" type="STRING"/>
					<colinfo id="EQME70" size="256" summ="default" type="STRING"/>
					<colinfo id="EQME71" size="256" summ="default" type="STRING"/>
					<colinfo id="EQME72" size="256" summ="default" type="STRING"/>
					<colinfo id="EQME74" size="256" summ="default" type="STRING"/>
					<colinfo id="EQME52" size="256" summ="default" type="STRING"/>
					<colinfo id="EQME10" size="256" summ="default" type="STRING"/>
					<colinfo id="EL_ALENG" size="256" summ="default" type="STRING"/>
					<colinfo id="EL_ARIS" size="256" summ="default" type="STRING"/>
					<colinfo id="REGION" size="256" summ="default" type="STRING"/>
					<colinfo id="EQMO21" size="256" summ="default" type="STRING"/>
					<colinfo id="EQMO22" size="256" summ="default" type="STRING"/>
					<colinfo id="EQMO23" size="256" summ="default" type="STRING"/>
					<colinfo id="EQMO30" size="15" summ="default" type="STRING"/>
					<colinfo id="EQMO31" size="15" summ="default" type="STRING"/>
					<colinfo id="EQMO32" size="15" summ="default" type="STRING"/>
					<colinfo id="EQMO33" size="15" summ="default" type="STRING"/>
					<colinfo id="EQMO34" size="15" summ="default" type="STRING"/>
					<colinfo id="EQMO35" size="15" summ="default" type="STRING"/>
					<colinfo id="EQMO36" size="15" summ="default" type="STRING"/>
					<colinfo id="EQMO37" size="15" summ="default" type="STRING"/>
					<colinfo id="EQMO38" size="15" summ="default" type="STRING"/>
					<colinfo id="EQMO39" size="15" summ="default" type="STRING"/>
					<colinfo id="EQMO40" size="15" summ="default" type="STRING"/>
					<colinfo id="QTDAT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_block">
				<Contents>
					<colinfo id="NO" size="256" type="STRING"/>
					<colinfo id="MANDT" size="256" type="STRING"/>
					<colinfo id="QTNUM" size="256" type="STRING"/>
					<colinfo id="QTSER" size="3" type="STRING"/>
					<colinfo id="QTSEQ" size="3" type="STRING"/>
					<colinfo id="BLSEQ" size="256" type="STRING"/>
					<colinfo id="BDMNG" size="256" type="STRING"/>
					<colinfo id="SALES" size="256" type="STRING"/>
					<colinfo id="MESSG" size="100" type="STRING"/>
					<colinfo id="ZCTOTAL" size="256" type="STRING"/>
					<colinfo id="BLOCKNAME" size="256" type="STRING"/>
					<colinfo id="MAKTX" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_check">
				<Contents>
					<colinfo id="FLAG" size="1" type="STRING"/>
					<colinfo id="MANDT" size="3" type="STRING"/>
					<colinfo id="QTNUM" size="256" type="STRING"/>
					<colinfo id="QTSER" size="256" type="STRING"/>
					<colinfo id="QTSEQ" size="256" type="STRING"/>
					<colinfo id="PSPID" size="24" type="STRING"/>
					<colinfo id="POSID" size="24" type="STRING"/>
					<colinfo id="ATYPE" size="30" type="STRING"/>
					<colinfo id="GUBUN" size="1" type="STRING"/>
					<colinfo id="BLSEQ" size="6" type="STRING"/>
					<colinfo id="BLNUM" size="10" type="STRING"/>
					<colinfo id="BLNAM" size="50" type="STRING"/>
					<colinfo id="MESSG" size="50" type="STRING"/>
					<colinfo id="STATE" size="1" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_zgtype">
				<Contents>
					<colinfo id="MANDT" size="256" type="STRING"/>
					<colinfo id="GTYPE" size="256" type="STRING"/>
					<colinfo id="GTYPEO" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_class">
				<Contents>
					<colinfo id="MANDT" size="256" type="STRING"/>
					<colinfo id="MATNR" size="256" type="STRING"/>
					<colinfo id="CLASS_CD" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_temp" OnRowPosChanged="ds_detail_OnRowPosChanged">
				<Contents>
					<colinfo id="FLAG" size="1" type="STRING"/>
					<colinfo id="CHK" size="1" type="STRING"/>
					<colinfo id="MANDT" size="256" type="STRING"/>
					<colinfo id="ZTPLNO" size="256" type="STRING"/>
					<colinfo id="ZTPLSEQ" size="256" type="STRING"/>
					<colinfo id="PRH" size="256" type="STRING"/>
					<colinfo id="PRHNAME" size="256" type="STRING"/>
					<colinfo id="PRD" size="256" type="STRING"/>
					<colinfo id="ZRMK" size="256" type="STRING"/>
					<colinfo id="MCLASS" size="256" type="STRING"/>
					<colinfo id="ZTPLNM" size="256" type="STRING"/>
					<colinfo id="ATKLA" size="256" type="STRING"/>
					<colinfo id="QTNUM" size="256" type="STRING"/>
					<colinfo id="QTSER" size="256" type="STRING"/>
					<colinfo id="QTSEQ" size="256" type="STRING"/>
					<colinfo id="PRSEQ" size="256" type="STRING"/>
					<colinfo id="CNT" size="256" type="STRING"/>
					<colinfo id="ATFOR" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond_atnam">
				<Contents>
					<colinfo id="MANDT" size="256" type="STRING"/>
					<colinfo id="KLART" size="256" type="STRING"/>
					<colinfo id="CLASS1" size="256" type="STRING"/>
					<colinfo id="ATKLA" size="256" type="STRING"/>
					<colinfo id="ATNAM" size="256" type="STRING"/>
					<colinfo id="WHERE" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_zregn2">
				<Contents>
					<colinfo id="CLASS1" size="256" type="STRING"/>
					<colinfo id="ATKLA" size="256" type="STRING"/>
					<colinfo id="ATNAM" size="256" type="STRING"/>
					<colinfo id="ATBEZ" size="256" type="STRING"/>
					<colinfo id="ATINN" size="256" type="STRING"/>
					<colinfo id="ATZHL" size="256" type="STRING"/>
					<colinfo id="ATWRT" size="256" type="STRING"/>
					<colinfo id="ATWTB" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_zregn3">
				<Contents>
					<colinfo id="CLASS1" size="256" type="STRING"/>
					<colinfo id="ATKLA" size="256" type="STRING"/>
					<colinfo id="ATNAM" size="256" type="STRING"/>
					<colinfo id="ATBEZ" size="256" type="STRING"/>
					<colinfo id="ATINN" size="256" type="STRING"/>
					<colinfo id="ATZHL" size="256" type="STRING"/>
					<colinfo id="ATWRT" size="256" type="STRING"/>
					<colinfo id="ATWTB" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_duty_block">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME>ALL</CODE_NAME>
					</record>
					<record>
						<CODE>00</CODE>
						<CODE_NAME>0)&#32;기본&#32;LAYOUT</CODE_NAME>
					</record>
					<record>
						<CODE>01</CODE>
						<CODE_NAME>1)&#32;카&#32;자중</CODE_NAME>
					</record>
					<record>
						<CODE>02</CODE>
						<CODE_NAME>2)&#32;TM&#32;&amp;&#32;3)&#32;로핑</CODE_NAME>
					</record>
					<record>
						<CODE>04</CODE>
						<CODE_NAME>4)&#32;TM&#32;모터&#32;&amp;&#32;5)&#32;TM&#32;인버터</CODE_NAME>
					</record>
					<record>
						<CODE>06</CODE>
						<CODE_NAME>6)&#32;TM&#32;MAIN&#32;SHEAVE&#32;직경</CODE_NAME>
					</record>
					<record>
						<CODE>08</CODE>
						<CODE_NAME>8)&#32;TM&#32;RPM</CODE_NAME>
					</record>
					<record>
						<CODE>09</CODE>
						<CODE_NAME>9)&#32;DEF&#32;SHEAVE&#32;직경</CODE_NAME>
					</record>
					<record>
						<CODE>10</CODE>
						<CODE_NAME>10)&#32;TM&#32;WRAP</CODE_NAME>
					</record>
					<record>
						<CODE>11</CODE>
						<CODE_NAME>11)&#32;ROPE&#32;직경</CODE_NAME>
					</record>
					<record>
						<CODE>12</CODE>
						<CODE_NAME>12)&#32;ROPE&#32;본수</CODE_NAME>
					</record>
					<record>
						<CODE>13</CODE>
						<CODE_NAME>13)&#32;COMPEN&#32;CHAIN&#32;수량</CODE_NAME>
					</record>
					<record>
						<CODE>14</CODE>
						<CODE_NAME>14)&#32;COMPEN&#32;CHAIN&#32;직경</CODE_NAME>
					</record>
					<record>
						<CODE>15</CODE>
						<CODE_NAME>15)&#32;SAFETY</CODE_NAME>
					</record>
					<record>
						<CODE>16</CODE>
						<CODE_NAME>16)&#32;CAR&#32;RAIL</CODE_NAME>
					</record>
					<record>
						<CODE>17</CODE>
						<CODE_NAME>17)&#32;CWT&#32;RAIL</CODE_NAME>
					</record>
					<record>
						<CODE>18</CODE>
						<CODE_NAME>18)&#32;GOVERNOR</CODE_NAME>
					</record>
					<record>
						<CODE>19</CODE>
						<CODE_NAME>19)&#32;CAR&#32;GUIDE&#32;SHOE</CODE_NAME>
					</record>
					<record>
						<CODE>20</CODE>
						<CODE_NAME>20)&#32;CWT&#32;GUIDE&#32;SHOE</CODE_NAME>
					</record>
					<record>
						<CODE>21</CODE>
						<CODE_NAME>21)&#32;CAR&#32;BUFFER</CODE_NAME>
					</record>
					<record>
						<CODE>22</CODE>
						<CODE_NAME>22)&#32;CWT.&#32;BUFFER</CODE_NAME>
					</record>
					<record>
						<CODE>23</CODE>
						<CODE_NAME>23)&#32;SUSPEN&#32;SHEAVE&#32;DIA</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_acapa">
				<Contents>
					<colinfo id="MANDT" size="256" type="STRING"/>
					<colinfo id="ATINN" size="256" type="STRING"/>
					<colinfo id="ATZHL" size="256" type="STRING"/>
					<colinfo id="ATWRT" size="256" type="STRING"/>
					<colinfo id="ZACAPA" size="256" type="STRING"/>
					<colinfo id="SPRAS" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_exchange">
				<Contents>
					<colinfo id="MANDT" size="256" type="STRING"/>
					<colinfo id="ZYEAR" size="256" type="STRING"/>
					<colinfo id="ZMONTH" size="256" type="STRING"/>
					<colinfo id="KRWUSD" size="256" type="STRING"/>
					<colinfo id="KRWJPY" size="256" type="STRING"/>
					<colinfo id="KRWEUR" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_fa_byrgbn">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_qtgbn">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE>A</CODE>
						<CODE_NAME>실행가</CODE_NAME>
					</record>
					<record>
						<CODE>B</CODE>
						<CODE_NAME>예산가</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_print_header">
				<Contents>
					<colinfo id="FLAG" size="1" type="STRING"/>
					<colinfo id="MANDT" size="256" type="STRING"/>
					<colinfo id="QTNUM" size="256" type="STRING"/>
					<colinfo id="QTSER" size="256" type="STRING"/>
					<colinfo id="QTDAT" size="256" type="STRING"/>
					<colinfo id="SPART" size="256" type="STRING"/>
					<colinfo id="QTGBN" size="256" type="STRING"/>
					<colinfo id="ZBDTYP" size="256" type="STRING"/>
					<colinfo id="ZPRGFLG" size="256" type="STRING"/>
					<colinfo id="VKBUR" size="256" type="STRING"/>
					<colinfo id="VKGRP" size="256" type="STRING"/>
					<colinfo id="ZKUNNR" size="256" type="STRING"/>
					<colinfo id="ZAGNT" size="256" type="STRING"/>
					<colinfo id="KUNNR" size="256" type="STRING"/>
					<colinfo id="ZCST" size="256" type="STRING"/>
					<colinfo id="ZGNM" size="256" type="STRING"/>
					<colinfo id="ZDEV" size="256" type="STRING"/>
					<colinfo id="GSNAM" size="256" type="STRING"/>
					<colinfo id="ZREGN" size="256" type="STRING"/>
					<colinfo id="ZPID" size="256" type="STRING"/>
					<colinfo id="ZTEL" size="256" type="STRING"/>
					<colinfo id="ZADDR_ZPOST" size="256" type="STRING"/>
					<colinfo id="ZADDR_ADR1" size="256" type="STRING"/>
					<colinfo id="ZADDR_ADR2" size="256" type="STRING"/>
					<colinfo id="SOABLE" size="256" type="STRING"/>
					<colinfo id="ZESTDAT" size="256" type="STRING"/>
					<colinfo id="DELDAT" size="256" type="STRING"/>
					<colinfo id="ZDVMTS" size="256" type="STRING"/>
					<colinfo id="ZSUM_ZNUMBER" size="256" type="STRING"/>
					<colinfo id="ZSUM_ZCOST" size="256" type="STRING"/>
					<colinfo id="ZSUM_ZEAM" size="256" type="STRING"/>
					<colinfo id="ZSUM_SHANG" size="256" type="STRING"/>
					<colinfo id="ZICIF_PPRT" size="256" type="STRING"/>
					<colinfo id="ZICIF_PPCT" size="256" type="STRING"/>
					<colinfo id="ZICIF_PPCD" size="256" type="STRING"/>
					<colinfo id="ZICIF_1STRT" size="256" type="STRING"/>
					<colinfo id="ZICIF_1STCT" size="256" type="STRING"/>
					<colinfo id="ZICIF_1STCD" size="256" type="STRING"/>
					<colinfo id="ZICIF_2STRT" size="256" type="STRING"/>
					<colinfo id="ZICIF_2STCT" size="256" type="STRING"/>
					<colinfo id="ZICIF_2STCD" size="256" type="STRING"/>
					<colinfo id="ZICIF_RMRT" size="256" type="STRING"/>
					<colinfo id="ZICIF_RMCT" size="256" type="STRING"/>
					<colinfo id="ZICIF_RMCD" size="256" type="STRING"/>
					<colinfo id="SPRMK1" size="256" type="STRING"/>
					<colinfo id="SPRMK2" size="256" type="STRING"/>
					<colinfo id="SPRMK3" size="256" type="STRING"/>
					<colinfo id="SPRMK4" size="256" type="STRING"/>
					<colinfo id="SPRMK5" size="256" type="STRING"/>
					<colinfo id="SPRMK6" size="256" type="STRING"/>
					<colinfo id="SPRMK7" size="256" type="STRING"/>
					<colinfo id="SPRMK8" size="256" type="STRING"/>
					<colinfo id="SPRMK9" size="256" type="STRING"/>
					<colinfo id="SPRMK10" size="256" type="STRING"/>
					<colinfo id="ZSOFLG" size="256" type="STRING"/>
					<colinfo id="SONNR" size="256" type="STRING"/>
					<colinfo id="VBELN" size="256" type="STRING"/>
					<colinfo id="AUART" size="256" type="STRING"/>
					<colinfo id="WAERK" size="256" type="STRING"/>
					<colinfo id="CO_DDVRTQ" size="256" type="STRING"/>
					<colinfo id="CO_DEPHTQ" size="256" type="STRING"/>
					<colinfo id="CO_DSSQ" size="256" type="STRING"/>
					<colinfo id="CO_BCLCDTQ" size="256" type="STRING"/>
					<colinfo id="CO_CHPITQ" size="256" type="STRING"/>
					<colinfo id="CO_ASPC" size="256" type="STRING"/>
					<colinfo id="CO_DSV1" size="256" type="STRING"/>
					<colinfo id="CO_DSV1TQ" size="256" type="STRING"/>
					<colinfo id="CO_DSV2" size="256" type="STRING"/>
					<colinfo id="CO_DSV2TQ" size="256" type="STRING"/>
					<colinfo id="INCO" size="256" type="STRING"/>
					<colinfo id="ZLZONE" size="256" type="STRING"/>
					<colinfo id="REGION" size="256" type="STRING"/>
					<colinfo id="BUYR_NM" size="256" type="STRING"/>
					<colinfo id="ZEAM" size="256" type="STRING"/>
					<colinfo id="ZKUNNR_NM" size="256" type="STRING"/>
					<colinfo id="KUNNR_NM" size="256" type="STRING"/>
					<colinfo id="ZAGNT_NM" size="256" type="STRING"/>
					<colinfo id="ZAGNTFLG" size="1" type="STRING"/>
					<colinfo id="INCO2" size="84" type="STRING"/>
					<colinfo id="MATNR" size="256" type="STRING"/>
					<colinfo id="GTYPE" size="256" type="STRING"/>
					<colinfo id="RTYPE" size="256" type="STRING"/>
					<colinfo id="TYPE1" size="256" type="STRING"/>
					<colinfo id="TYPE2" size="256" type="STRING"/>
					<colinfo id="TYPE3" size="256" type="STRING"/>
					<colinfo id="ZNUMBER" size="256" type="STRING"/>
					<colinfo id="PART_CNT" size="256" type="STRING"/>
					<colinfo id="SHANGH" size="256" type="STRING"/>
					<colinfo id="FA_BYRGBN" size="256" type="STRING"/>
					<colinfo id="ZDELI" size="1" type="STRING"/>
					<colinfo id="TEL" size="20" type="STRING"/>
					<colinfo id="FAX" size="20" type="STRING"/>
					<colinfo id="CEL" size="20" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_print_detail">
				<Contents>
					<colinfo id="CHK" size="1" type="STRING"/>
					<colinfo id="FLAG" size="1" type="STRING"/>
					<colinfo id="NEW_YN" size="1" type="STRING"/>
					<colinfo id="MANDT" size="256" type="STRING"/>
					<colinfo id="QTNUM" size="256" type="STRING"/>
					<colinfo id="QTSER" size="256" type="STRING"/>
					<colinfo id="QTSEQ" size="256" type="STRING"/>
					<colinfo id="SHANGH" size="256" type="STRING"/>
					<colinfo id="ZSAREA" size="256" type="STRING"/>
					<colinfo id="MATNR" size="256" type="STRING"/>
					<colinfo id="ZPRDGBN" size="256" type="STRING"/>
					<colinfo id="SPEC" size="256" type="STRING"/>
					<colinfo id="GTYPE" size="256" type="STRING"/>
					<colinfo id="TYPE1" size="256" type="STRING"/>
					<colinfo id="TYPE2" size="256" type="STRING"/>
					<colinfo id="TYPE3" size="256" type="STRING"/>
					<colinfo id="ZNUMBER" size="256" type="STRING"/>
					<colinfo id="ZACAPA" size="256" type="STRING"/>
					<colinfo id="ZUSE" size="256" type="STRING"/>
					<colinfo id="ZUSE_NM" size="256" type="STRING"/>
					<colinfo id="ZOPN" size="256" type="STRING"/>
					<colinfo id="ZLEN" size="256" type="STRING"/>
					<colinfo id="ZOUTC" size="256" type="STRING"/>
					<colinfo id="ZUAM" size="256" type="STRING"/>
					<colinfo id="ZCOST" size="256" type="STRING"/>
					<colinfo id="ZCOSTM" size="256" type="STRING"/>
					<colinfo id="ZEAM" size="256" type="STRING"/>
					<colinfo id="SHANG" size="256" type="STRING"/>
					<colinfo id="ZRMK" size="256" type="STRING"/>
					<colinfo id="MCLASS" size="256" type="STRING"/>
					<colinfo id="SONNR" size="256" type="STRING"/>
					<colinfo id="ZEAM_ORG" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_jtype">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE>2PZ</CODE>
						<CODE_NAME>2단식</CODE_NAME>
					</record>
					<record>
						<CODE>MPZ</CODE>
						<CODE_NAME>다단식</CODE_NAME>
					</record>
					<record>
						<CODE>MFC</CODE>
						<CODE_NAME>다층순환식</CODE_NAME>
					</record>
					<record>
						<CODE>VRC</CODE>
						<CODE_NAME>수직순환식</CODE_NAME>
					</record>
					<record>
						<CODE>HRC</CODE>
						<CODE_NAME>수평순환식</CODE_NAME>
					</record>
					<record>
						<CODE>ELV</CODE>
						<CODE_NAME>승강기식</CODE_NAME>
					</record>
					<record>
						<CODE>STC</CODE>
						<CODE_NAME>승강슬라이드식</CODE_NAME>
					</record>
					<record>
						<CODE>CRT</CODE>
						<CODE_NAME>평면왕복식</CODE_NAME>
					</record>
					<record>
						<CODE>BPS</CODE>
						<CODE_NAME>자전거&#32;주차장</CODE_NAME>
					</record>
					<record>
						<CODE>LFC</CODE>
						<CODE_NAME>수직반송기</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_A" OnColumnChanged="ds_template_OnColumnChanged" OnRowPosChanged="ds_detail_OnRowPosChanged">
				<Contents>
					<colinfo id="FLAG" size="1" summ="default" type="STRING"/>
					<colinfo id="CHK" size="1" summ="default" type="STRING"/>
					<colinfo id="MANDT" size="256" summ="default" type="STRING"/>
					<colinfo id="ZTPLNO" size="256" summ="default" type="STRING"/>
					<colinfo id="ZTPLSEQ" size="256" summ="default" type="INT"/>
					<colinfo id="PRH" size="256" summ="default" type="STRING"/>
					<colinfo id="PRHNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="PRD" size="256" summ="default" type="STRING"/>
					<colinfo id="ZRMK" size="256" summ="default" type="STRING"/>
					<colinfo id="MCLASS" size="256" summ="default" type="STRING"/>
					<colinfo id="ZTPLNM" size="256" summ="default" type="STRING"/>
					<colinfo id="ATKLA" size="256" summ="default" type="STRING"/>
					<colinfo id="QTNUM" size="256" summ="default" type="STRING"/>
					<colinfo id="QTSER" size="256" summ="default" type="STRING"/>
					<colinfo id="QTSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="PRSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="ATFOR" size="256" summ="default" type="STRING"/>
					<colinfo id="ATWTB" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_B" OnColumnChanged="ds_template_OnColumnChanged" OnRowPosChanged="ds_detail_OnRowPosChanged">
				<Contents>
					<colinfo id="FLAG" size="1" summ="default" type="STRING"/>
					<colinfo id="CHK" size="1" summ="default" type="STRING"/>
					<colinfo id="MANDT" size="256" summ="default" type="STRING"/>
					<colinfo id="ZTPLNO" size="256" summ="default" type="STRING"/>
					<colinfo id="ZTPLSEQ" size="256" summ="default" type="INT"/>
					<colinfo id="PRH" size="256" summ="default" type="STRING"/>
					<colinfo id="PRHNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="PRD" size="256" summ="default" type="STRING"/>
					<colinfo id="ZRMK" size="256" summ="default" type="STRING"/>
					<colinfo id="MCLASS" size="256" summ="default" type="STRING"/>
					<colinfo id="ZTPLNM" size="256" summ="default" type="STRING"/>
					<colinfo id="ATKLA" size="256" summ="default" type="STRING"/>
					<colinfo id="QTNUM" size="256" summ="default" type="STRING"/>
					<colinfo id="QTSER" size="256" summ="default" type="STRING"/>
					<colinfo id="QTSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="PRSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="ATFOR" size="256" summ="default" type="STRING"/>
					<colinfo id="ATWTB" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_C" OnColumnChanged="ds_template_OnColumnChanged" OnRowPosChanged="ds_detail_OnRowPosChanged">
				<Contents>
					<colinfo id="FLAG" size="1" summ="default" type="STRING"/>
					<colinfo id="CHK" size="1" summ="default" type="STRING"/>
					<colinfo id="MANDT" size="256" summ="default" type="STRING"/>
					<colinfo id="ZTPLNO" size="256" summ="default" type="STRING"/>
					<colinfo id="ZTPLSEQ" size="256" summ="default" type="INT"/>
					<colinfo id="PRH" size="256" summ="default" type="STRING"/>
					<colinfo id="PRHNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="PRD" size="256" summ="default" type="STRING"/>
					<colinfo id="ZRMK" size="256" summ="default" type="STRING"/>
					<colinfo id="MCLASS" size="256" summ="default" type="STRING"/>
					<colinfo id="ZTPLNM" size="256" summ="default" type="STRING"/>
					<colinfo id="ATKLA" size="256" summ="default" type="STRING"/>
					<colinfo id="QTNUM" size="256" summ="default" type="STRING"/>
					<colinfo id="QTSER" size="256" summ="default" type="STRING"/>
					<colinfo id="QTSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="PRSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="ATFOR" size="256" summ="default" type="STRING"/>
					<colinfo id="ATWTB" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_D" OnColumnChanged="ds_template_OnColumnChanged" OnRowPosChanged="ds_detail_OnRowPosChanged">
				<Contents>
					<colinfo id="FLAG" size="1" summ="default" type="STRING"/>
					<colinfo id="CHK" size="1" summ="default" type="STRING"/>
					<colinfo id="MANDT" size="256" summ="default" type="STRING"/>
					<colinfo id="ZTPLNO" size="256" summ="default" type="STRING"/>
					<colinfo id="ZTPLSEQ" size="256" summ="default" type="INT"/>
					<colinfo id="PRH" size="256" summ="default" type="STRING"/>
					<colinfo id="PRHNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="PRD" size="256" summ="default" type="STRING"/>
					<colinfo id="ZRMK" size="256" summ="default" type="STRING"/>
					<colinfo id="MCLASS" size="256" summ="default" type="STRING"/>
					<colinfo id="ZTPLNM" size="256" summ="default" type="STRING"/>
					<colinfo id="ATKLA" size="256" summ="default" type="STRING"/>
					<colinfo id="QTNUM" size="256" summ="default" type="STRING"/>
					<colinfo id="QTSER" size="256" summ="default" type="STRING"/>
					<colinfo id="QTSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="PRSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="ATFOR" size="256" summ="default" type="STRING"/>
					<colinfo id="ATWTB" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_E" OnColumnChanged="ds_template_OnColumnChanged" OnRowPosChanged="ds_detail_OnRowPosChanged">
				<Contents>
					<colinfo id="FLAG" size="1" summ="default" type="STRING"/>
					<colinfo id="CHK" size="1" summ="default" type="STRING"/>
					<colinfo id="MANDT" size="256" summ="default" type="STRING"/>
					<colinfo id="ZTPLNO" size="256" summ="default" type="STRING"/>
					<colinfo id="ZTPLSEQ" size="256" summ="default" type="INT"/>
					<colinfo id="PRH" size="256" summ="default" type="STRING"/>
					<colinfo id="PRHNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="PRD" size="256" summ="default" type="STRING"/>
					<colinfo id="ZRMK" size="256" summ="default" type="STRING"/>
					<colinfo id="MCLASS" size="256" summ="default" type="STRING"/>
					<colinfo id="ZTPLNM" size="256" summ="default" type="STRING"/>
					<colinfo id="ATKLA" size="256" summ="default" type="STRING"/>
					<colinfo id="QTNUM" size="256" summ="default" type="STRING"/>
					<colinfo id="QTSER" size="256" summ="default" type="STRING"/>
					<colinfo id="QTSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="PRSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="ATFOR" size="256" summ="default" type="STRING"/>
					<colinfo id="ATWTB" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset CanRowPosChange="ds_detail_CanRowPosChange" DataSetType="Dataset" Id="ds_F" OnColumnChanged="ds_detail_OnColumnChanged" OnRowPosChanged="ds_detail_OnRowPosChanged">
				<Contents>
					<colinfo id="CHK" size="1" type="STRING"/>
					<colinfo id="FLAG" size="1" type="STRING"/>
					<colinfo id="NEW_YN" size="1" type="STRING"/>
					<colinfo id="MANDT" size="256" type="STRING"/>
					<colinfo id="QTNUM" size="256" type="STRING"/>
					<colinfo id="QTSER" size="256" type="STRING"/>
					<colinfo id="QTSEQ" size="256" type="STRING"/>
					<colinfo id="SHANGH" size="256" type="STRING"/>
					<colinfo id="ZSAREA" size="256" type="STRING"/>
					<colinfo id="MATNR" size="256" type="STRING"/>
					<colinfo id="ZPRDGBN" size="256" type="STRING"/>
					<colinfo id="SPEC" size="256" type="STRING"/>
					<colinfo id="GTYPE" size="256" type="STRING"/>
					<colinfo id="TYPE1" size="256" type="STRING"/>
					<colinfo id="TYPE2" size="256" type="STRING"/>
					<colinfo id="TYPE3" size="256" type="STRING"/>
					<colinfo id="ZNUMBER" size="256" type="STRING"/>
					<colinfo id="ZACAPA" size="256" type="STRING"/>
					<colinfo id="ZUSE" size="256" type="STRING"/>
					<colinfo id="ZUSE_NM" size="256" type="STRING"/>
					<colinfo id="ZOPN" size="256" type="STRING"/>
					<colinfo id="ZLEN" size="256" type="STRING"/>
					<colinfo id="ZOUTC" size="256" type="STRING"/>
					<colinfo id="ZUAM" size="256" type="STRING"/>
					<colinfo id="ZCOST" size="256" type="STRING"/>
					<colinfo id="ZCOSTM" size="256" type="STRING"/>
					<colinfo id="ZEAM" size="256" type="STRING"/>
					<colinfo id="SHANG" size="256" type="STRING"/>
					<colinfo id="ZRMK" size="256" type="STRING"/>
					<colinfo id="MCLASS" size="256" type="STRING"/>
					<colinfo id="SONNR" size="256" type="STRING"/>
					<colinfo id="ZEAM_ORG" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_headerJ">
				<Contents>
					<colinfo id="MANDT" size="256" summ="default" type="STRING"/>
					<colinfo id="QTNUM" size="256" summ="default" type="STRING"/>
					<colinfo id="QTSER" size="256" summ="default" type="STRING"/>
					<colinfo id="JTYPE1" size="256" summ="default" type="STRING"/>
					<colinfo id="JTYPE2" size="256" summ="default" type="STRING"/>
					<colinfo id="JTYPE3" size="256" summ="default" type="STRING"/>
					<colinfo id="JTYPE4" size="256" summ="default" type="STRING"/>
					<colinfo id="TEXT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cmcode">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE>Y</CODE>
						<CODE_NAME>Y</CODE_NAME>
					</record>
					<record>
						<CODE>N</CODE>
						<CODE_NAME>N</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond_build">
				<Contents>
					<colinfo id="BUILDUSE" size="6" type="STRING"/>
					<colinfo id="STEXT" size="120" type="STRING"/>
					<colinfo id="WHERE" size="256" type="STRING"/>
					<record>
						<BUILDUSE></BUILDUSE>
						<STEXT></STEXT>
						<WHERE></WHERE>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list_build">
				<Contents>
					<colinfo id="BUILDUSE" size="256" type="STRING"/>
					<colinfo id="STEXT" size="256" type="STRING"/>
					<colinfo id="BUILDUSE_L" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list_build_l">
				<Contents>
					<colinfo id="BUILDUSE_L" size="256" type="STRING"/>
					<colinfo id="STEXT" size="256" type="STRING"/>
				</Contents>
			</Dataset>
		</Datasets>
		<Tab Border="Flat" FixedImage="FALSE" Font="굴림,9" Height="495" Id="tab" MouseOverColor="user16" OnChanged="tab_OnChanged" SelColor="user15" SelectFont="굴림,9" Style="sty_tab" TabIndex="1" TabOrder="19" Top="64" Width="992">
			<Contents>
				<TabPage BorderColor="black" Height="470" Id="main" ImageEdgeWidth="2" ImageID="tab_main" Left="2" TabOrder="19" Text="견적내용" Top="23" Width="988">
					<Div Height="468" Id="div_header" Left="2" TabOrder="1" Text="Div0" Width="964">
						<Contents>
							<Shape BKColor="user0" Bottom="156" Height="26" Id="Shape4" Left="1" LineColor="user1" Right="963" TabOrder="71" Top="130" Type="Rectangle" Width="962"></Shape>
							<Shape BKColor="user0" Bottom="104" Height="26" Id="Shape0" Left="1" LineColor="user1" Right="963" TabOrder="67" Top="78" Type="Rectangle" Width="962"></Shape>
							<Shape BKColor="user0" Bottom="26" Height="26" Id="Shape1" Left="1" LineColor="user1" Right="963" TabOrder="33" Top="0" Type="Rectangle" Width="962"></Shape>
							<Shape BKColor="user0" Bottom="130" Height="26" Id="Shape5" Left="1" LineColor="user1" Right="963" TabOrder="32" Top="104" Type="Rectangle" Width="962"></Shape>
							<Shape BKColor="user0" Bottom="77" Height="26" Id="Shape3" Left="4" LineColor="user1" Right="963" TabOrder="31" Top="51" Type="Rectangle" Width="959"></Shape>
							<Shape BKColor="user0" Bottom="52" Height="26" Id="Shape2" Left="1" LineColor="user1" Right="963" TabOrder="30" Top="26" Type="Rectangle" Width="962"></Shape>
							<Calendar BindDataset="ds_header" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="ZESTDAT" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_zestdat" Left="78" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="5" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="54" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="105"></Calendar>
							<Static Align="Right" Height="24" Id="st_zestdat" Left="2" Style="sty_lb_search" TabOrder="3" Text="입찰예정일&#32;" Top="53" VAlign="Middle" Width="72"></Static>
							<Static Align="Right" Height="24" Id="st_vkgrp" Left="371" Style="sty_lb_search" TabOrder="4" Text="팀&#32;" Top="1" VAlign="Middle" Width="72"></Static>
							<Combo BindDataset="ds_header" Border="Flat" CodeColumn="CODE" Column="VKGRP" DataColumn="CODE_NAME" Enable="FALSE" Height="20" Id="cb_vkgrp" InnerDataset="ds_vkgrp" Left="446" Style="sty_ipt_form" TabOrder="2" Top="2" Width="304"></Combo>
							<Combo BindDataset="ds_header" Border="Flat" CodeColumn="CODE" Column="VKBUR" DataColumn="CODE_NAME" Enable="FALSE" Height="20" Id="cb_vkbur" InnerDataset="ds_vkbur" Left="261" OnChanged="cb_vkbur_OnChanged" Style="sty_ipt_form" TabOrder="1" Top="2" Width="107"></Combo>
							<Edit BindDataset="ds_header" Border="Flat" CheckLength="Byte" Column="ZADDR_ADR2" Height="20" Id="ed_addr2" Left="436" MaxLength="100" Style="sty_ipt_form" TabOrder="13" Top="107" Width="99"></Edit>
							<Edit BindDataset="ds_header" Border="Flat" CheckLength="Byte" Column="ZADDR_ADR1" Height="20" Id="ed_addr1" Left="159" MaxLength="100" Style="sty_ipt_form" TabOrder="12" Top="107" Width="275"></Edit>
							<Button Height="18" Id="btn_zipcode" ImageID="btn_icon_search" Left="140" OnClick="ufn_openZipcode1" TabOrder="12" Text="Button0" Top="108" Transparent="TRUE" Width="18"></Button>
							<MaskEdit BindDataset="ds_header" Border="Flat" Column="ZADDR_ZPOST" Height="20" Id="med_zipcode" Left="78" LeftMargin="10" Mask="######" MaxLength="7" Style="sty_ipt_form" TabOrder="11" Top="107" Type="STRING" Width="60"></MaskEdit>
							<Static Align="Right" Height="24" Id="st_addr" Left="2" Style="sty_lb_search" TabOrder="7" Text="현장주소&#32;" Top="105" VAlign="Middle" Width="72"></Static>
							<Static Align="Right" Border="None" Height="24" Id="st_dev" Left="370" Style="sty_lb_search" TabOrder="13" Text="시행사&#32;" Top="53" VAlign="Middle" Width="72"></Static>
							<Checkbox BindDataset="ds_header" Column="ZCST" Height="18" Id="chk_cst" Left="858" Style="sty_ipt_form_ind" TabOrder="15" Text="기거래선" Top="81" Value="FALSE" Width="70"></Checkbox>
							<Static Align="Right" Height="24" Id="st_kunnr" Left="186" Style="sty_lb_search" TabOrder="15" Text="고객번호&#32;" Top="28" VAlign="Middle" Width="72"></Static>
							<Edit BindDataset="ds_header" Border="Flat" Column="ZAGNT_NM" Enable="FALSE" Height="20" Id="ed_zagnt" ImeMode="native" Left="855" Style="sty_ipt_search" TabOrder="16" Top="29" Width="105"></Edit>
							<Static Align="Right" Height="24" Id="st_zagnt" Left="779" Style="sty_lb_search" TabOrder="17" Text="대리점명&#32;" Top="27" VAlign="Middle" Width="72"></Static>
							<Static Align="Right" Height="24" Id="st_sman" Left="474" Style="sty_lb_search" TabOrder="18" Text="담당자&#32;" Top="27" VAlign="Middle" Width="72"></Static>
							<Div BKColor="user0" Height="22" Id="div_sman" Left="550" OnLoadCompleted="fn_OnLoadCompleted" TabOrder="4" Text="Div0" Top="29" Url="COM::Coms002.xml" Width="182">
								<Contents></Contents>
							</Div>
							<Static Align="Right" Height="24" Id="st_vkbur" Left="186" Style="sty_lb_search" TabOrder="20" Text="부서&#32;" Top="2" VAlign="Middle" Width="72"></Static>
							<Combo BindDataset="ds_header" Border="Flat" CodeColumn="CODE" Column="ZPRGFLG" DataColumn="CODE_NAME" Enable="FALSE" Height="20" Id="cb_zprgflg" InnerDataset="ds_zprgflg" Left="854" Style="sty_ipt_search" TabOrder="17" Top="2" Width="107"></Combo>
							<Static Align="Right" Height="24" Id="st_zprgflg" Left="779" Style="sty_lb_search" TabOrder="22" Text="진행상태&#32;" Top="1" VAlign="Middle" Width="72"></Static>
							<Combo BindDataset="ds_header" Border="Flat" CodeColumn="CODE" Column="SPART" DataColumn="CODE_NAME" Enable="FALSE" Height="20" Id="cb_spart" InnerDataset="ds_spart_cd" Left="77" Style="sty_ipt_form" TabOrder="1" Top="2" Width="107"></Combo>
							<Static Align="Right" Height="24" Id="st_spart" Left="2" Style="sty_lb_search" TabOrder="25" Text="제품군&#32;" Top="1" VAlign="Middle" Width="72"></Static>
							<Calendar BindDataset="ds_header" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="DELDAT" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_deldat" Left="262" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="6" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="55" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="105"></Calendar>
							<Static Align="Right" Height="24" Id="st_deldat" Left="186" Style="sty_lb_search" TabOrder="27" Text="납기예정일&#32;" Top="53" VAlign="Middle" Width="72"></Static>
							<Edit BindDataset="ds_header" Border="Flat" Column="GSNAM" Height="20" Id="ed_gsnam" ImeMode="english" Left="78" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="3" Top="29" UpperOnly="TRUE" Width="105"></Edit>
							<Static Align="Right" Height="24" Id="st_gsnam" Left="2" Style="sty_lb_search" TabOrder="29" Text="공사명&#32;" Top="27" VAlign="Middle" Width="72"></Static>
							<Grid AutoEnter="TRUE" AutoFit="TRUE" AutoFitEndLine="Hide" BindDataset="ds_header" BkColor2="default" BoldHead="true" Border="Flat" Bottom="326" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="61" Id="grd_zicif" InputPanel="FALSE" Left="1" LineColor="user20" LineType="ExHORZ" MinWidth="100" OnExpandEdit="grd_head_OnExpandEdit" Right="963" RowHeight="20" Style="sty_grid" TabOrder="25" TabStop="true" Top="265" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="962">
								<contents>
									<format id="Default">
										<columns>
											<col width="40"/>
											<col width="50"/>
											<col width="125"/>
											<col width="40"/>
											<col width="50"/>
											<col width="125"/>
											<col width="40"/>
											<col width="50"/>
											<col width="125"/>
											<col width="40"/>
											<col width="50"/>
											<col width="125"/>
											<col width="70"/>
										</columns>
										<head>
											<cell align="center" col="0" color="user21" colspan="3" display="text" font="굴림,9" text="선&#32;수&#32;금"/>
											<cell align="center" col="3" color="user21" colspan="3" display="text" font="굴림,9" text="1&#32;차&#32;중&#32;도&#32;금"/>
											<cell align="center" col="6" color="user21" colspan="3" display="text" font="굴림,9" text="2&#32;차&#32;중&#32;도&#32;금"/>
											<cell align="center" col="9" color="user21" colspan="3" display="text" font="굴림,9" text="잔&#32;금"/>
											<cell align="center" col="12" color="user21" display="text" font="굴림,9" text="기&#32;타"/>
											<cell align="center" col="0" color="user21" display="text" font="굴림,9" row="1" text="율(%)"/>
											<cell align="center" col="1" color="user21" display="text" font="굴림,9" row="1" text="조&#32;건"/>
											<cell align="center" col="2" color="user21" display="text" font="굴림,9" row="1" text="내&#32;용"/>
											<cell align="center" col="3" color="user21" display="text" font="굴림,9" row="1" text="율(%)"/>
											<cell align="center" col="4" color="user21" display="text" font="굴림,9" row="1" text="조&#32;건"/>
											<cell align="center" col="5" color="user21" display="text" font="굴림,9" row="1" text="내&#32;용"/>
											<cell align="center" col="6" color="user21" display="text" font="굴림,9" row="1" text="율(%)"/>
											<cell align="center" col="7" color="user21" display="text" font="굴림,9" row="1" text="조&#32;건"/>
											<cell align="center" col="8" color="user21" display="text" font="굴림,9" row="1" text="내&#32;용"/>
											<cell align="center" col="9" color="user21" display="text" font="굴림,9" row="1" text="율(%)"/>
											<cell align="center" col="10" color="user21" display="text" font="굴림,9" row="1" text="조&#32;건"/>
											<cell align="center" col="11" color="user21" display="text" font="굴림,9" row="1" text="내&#32;용"/>
											<cell align="center" col="12" color="user21" display="text" font="굴림,9" row="1" text="납기개월수"/>
										</head>
										<body>
											<cell align="right" bkcolor2="user22" col="0" colid="ZICIF_PPRT" display="number" edit="number"/>
											<cell align="right" bkcolor2="user22" col="1" colid="ZICIF_PPCD" combocol="CODE" combodataset="ds_sukum" combotext="CODE_NAME" display="combo" edit="combo"/>
											<cell align="left" bkcolor2="user22" col="2" colid="ZICIF_PPCT" edit="normal"/>
											<cell align="right" bkcolor2="user22" col="3" colid="ZICIF_1STRT" display="number" edit="number"/>
											<cell align="right" bkcolor2="user22" col="4" colid="ZICIF_1STCD" combocol="CODE" combodataset="ds_sukum" combotext="CODE_NAME" display="combo" edit="combo"/>
											<cell align="left" bkcolor2="user22" col="5" colid="ZICIF_1STCT" edit="normal"/>
											<cell align="right" bkcolor2="user22" col="6" colid="ZICIF_2STRT" display="number" edit="number"/>
											<cell align="right" bkcolor2="user22" col="7" colid="ZICIF_2STCD" combocol="CODE" combodataset="ds_sukum" combotext="CODE_NAME" display="combo" edit="combo"/>
											<cell align="left" bkcolor2="user22" col="8" colid="ZICIF_2STCT" edit="normal"/>
											<cell align="right" bkcolor2="user22" col="9" colid="ZICIF_RMRT" display="number" edit="number"/>
											<cell align="right" bkcolor2="user22" col="10" colid="ZICIF_RMCD" combocol="CODE" combodataset="ds_sukum" combotext="CODE_NAME" display="combo" edit="combo"/>
											<cell align="left" bkcolor2="user22" col="11" colid="ZICIF_RMCT" edit="normal"/>
											<cell align="center" bkcolor2="user22" col="12" colid="ZDVMTS" edit="normal"/>
										</body>
									</format>
								</contents>
							</Grid>
							<Grid AutoEnter="TRUE" AutoFitEndLine="Hide" BindDataset="ds_detail" BkColor2="default" BoldHead="true" Border="Flat" Bottom="476" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="35" Height="120" Id="grd_detail" InputPanel="FALSE" Left="3" LineColor="user20" LineType="ExHORZ" OnCellClick="grd_detail_OnCellClick" OnCellPosChanged="tab_main_div_header_grd_detail_OnCellPosChanged" OnEnterEdit="tab_main_div_header_grd_detail_OnEnterEdit" OnExpandEdit="grd_detail_OnExpandEdit" OnKeyDown="grd_detail_OnKeyDown" Right="966" RowHeight="20" Style="sty_grid" TabOrder="18" TabStop="true" Top="356" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="963">
								<contents>
									<format id="Default">
										<columns>
											<col width="30"/>
											<col width="30"/>
											<col width="40"/>
											<col width="32"/>
											<col width="55"/>
											<col width="67"/>
											<col width="67"/>
											<col width="67"/>
											<col width="67"/>
											<col width="67"/>
											<col width="67"/>
											<col width="67"/>
											<col width="30"/>
											<col width="70"/>
											<col width="70"/>
											<col width="70"/>
											<col width="40"/>
											<col width="80"/>
											<col width="35"/>
											<col width="30"/>
											<col width="45"/>
										</columns>
										<head>
											<cell align="center" col="0" color="user21" display="text" font="굴림,9" text="No"/>
											<cell align="center" col="1" color="user21" display="text" font="굴림,9" text="변경"/>
											<cell align="center" col="2" color="user21" display="text" font="굴림,9" text="국내&#10;해외"/>
											<cell align="center" col="3" color="user21" display="text" font="굴림,9" text="판매&#10;지역"/>
											<cell align="center" col="4" color="user21" display="text" font="굴림,9" text="기종"/>
											<cell align="center" col="5" color="user21" display="text" font="굴림,9" text="용도"/>
											<cell align="center" col="6" color="user21" display="text" font="굴림,9" text="인승&#10;(폭)"/>
											<cell align="center" col="7" color="user21" display="text" font="굴림,9" text="용량"/>
											<cell align="center" col="8" color="user21" display="text" font="굴림,9" text="속도&#10;(각도)"/>
											<cell align="center" col="9" color="user21" display="text" font="굴림,9" text="층수&#10;(높이)"/>
											<cell align="center" col="10" color="user21" display="text" font="굴림,9" text="정지층수&#10;(속도)"/>
											<cell align="center" col="11" color="user21" display="text" font="굴림,9" text="DOOR개폐&#10;(길이)"/>
											<cell align="center" col="12" color="user21" display="text" font="굴림,9" text="대수"/>
											<cell align="center" col="13" color="user21" display="text" font="굴림,9" text="단가"/>
											<cell align="center" col="14" color="user21" display="text" font="굴림,9" text="원가"/>
											<cell align="center" col="15" color="user21" display="text" font="굴림,9" text="견적가"/>
											<cell align="center" col="16" color="user21" display="text" font="굴림,9" text="시행율"/>
											<cell align="center" col="17" color="user21" display="text" font="굴림,9" text="수주계획번호"/>
											<cell align="center" col="18" color="user21" display="text" font="굴림,9" text="원가&#10;내역"/>
											<cell align="center" col="19" color="user21" display="text" font="굴림,9" text="사양"/>
											<cell align="center" col="20" color="user21" display="text" font="굴림,9" text="비표준"/>
										</head>
										<body>
											<cell align="center" bkcolor2="user22" col="0" display="text" expr="currow+1"/>
											<cell align="center" bkcolor2="user22" bkimageid='expr:gfn_getFlagBkImageID(getColumn(currow,&#32;&quot;FLAG&quot;))' col="1" colid="FLAG" display="image"/>
											<cell align="center" bkcolor2="user22" col="2" colid="SHANGH" combocol="CODE" combodataset="ds_shangh" combotext="CODE_NAME" display="text"/>
											<cell align="center" bkcolor2="user22" col="3" colid="ZSAREA" display="text"/>
											<cell align="center" bkcolor2="user22" col="4" colid="GTYPE" display="text" expandchar="..." expandshow='expr:iif(MATNR==&quot;T-1000&quot;&#32;||&#32;MATNR==&quot;Y-1000&quot;,false,true)'/>
											<cell align="center" bkcolor2="user22" col="5" colid="ZUSE" display="text"/>
											<cell align="center" bkcolor2="user22" col="6" colid="TYPE1" display="text"/>
											<cell align="center" bkcolor2="user22" col="7" colid="ZACAPA" display="text"/>
											<cell align="center" bkcolor2="user22" col="8" colid="TYPE2" display="text"/>
											<cell align="center" bkcolor2="user22" col="9" colid="TYPE3" display="text" edit="integer"/>
											<cell align="right" bkcolor2="user22" col="10" colid="ZLEN" display="text" edit="integer"/>
											<cell align="right" bkcolor2="user22" col="11" colid="ZOPN" display="normal"/>
											<cell align="right" bkcolor2="user22" col="12" colid="ZNUMBER" display="text" edit="integer"/>
											<cell align="right" bkcolor2="user22" col="13" colid="ZUAM" display="number" Mask="###,###,###,##0"/>
											<cell align="right" bkcolor2="user22" col="14" colid="ZCOST" display="number" Mask="###,###,###,##0"/>
											<cell align="right" bkcolor2="user22" col="15" colid="ZEAM" display="number" edit="masknumber" Mask="###,###,###,##0"/>
											<cell align="right" bkcolor2="user22" col="16" colid="SHANG" display="number" Mask="##0.0"/>
											<cell align="center" bkcolor2="user22" col="17" colid="SONNR" display="text"/>
											<cell align="center" bkcolor2="user22" col="18" display="text" expandchar="출력" expandshow='expr:iif(MATNR==&quot;T-1000&quot;&#32;||&#32;MATNR==&quot;Y-1000&quot;,false,true)' expandsize="40"/>
											<cell align="center" bkcolor2="user22" col="19" display="text" expandchar="출력" expandshow='expr:iif(MATNR==&quot;T-1000&quot;&#32;||&#32;MATNR==&quot;Y-1000&quot;,false,true)' expandsize="40"/>
											<cell align="center" bkcolor2="user22" col="20" colid="ZOUTC" display="text" edit="combo"/>
										</body>
									</format>
								</contents>
							</Grid>
							<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_plus" ImageID="btn_icon_plus" Left="918" LeftMargin="12" OnClick="btn_plus_OnClick" Style="sty_btn" TabOrder="19" Top="330" Transparent="TRUE" Width="22"></Button>
							<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_minus" ImageID="btn_icon_minus" Left="941" LeftMargin="12" OnClick="btn_minus_OnClick" Style="sty_btn" TabOrder="20" Top="330" Transparent="TRUE" Width="22"></Button>
							<Static Align="Right" Height="24" Id="st_cst" Left="779" Style="sty_lb_search" TabOrder="37" Text="기거래선&#32;" Top="77" VAlign="Middle" Width="72"></Static>
							<Div BKColor="user0" Height="22" Id="div_kunnr" Left="263" OnLoadCompleted="fn_OnLoadCompleted" TabOrder="21" Text="Div0" Top="30" Url="COM::Coms003.xml" Width="169">
								<Contents></Contents>
							</Div>
							<Edit BindDataset="ds_header" Border="Flat" Column="ZDEV" Height="20" Id="ed_dev" Left="445" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="7" Top="55" Width="105"></Edit>
							<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_popup" ImageID="btn_sub_06" Left="822" LeftMargin="12" OnClick="btn_popup_OnClick" Style="sty_btn" TabOrder="22" Text="수주계획&#32;추가" Top="330" Transparent="TRUE" Width="95"></Button>
							<Div Height="106" Id="div_sprmk" scroll="true" TabOrder="14" Text="Div0" Top="155" Width="963">
								<Contents>
									<Shape BKColor="user0" Bottom="27" Height="26" Id="Shape7" Left="1" LineColor="user1" Right="946" TabOrder="1" Top="1" Type="Rectangle" Width="945"></Shape>
									<Shape BKColor="user0" Bottom="53" Height="26" Id="Shape8" Left="1" LineColor="user1" Right="946" TabOrder="2" Top="27" Type="Rectangle" Width="945"></Shape>
									<Static Align="Right" Height="24" Id="st_sprmk1" Left="2" Style="sty_lb_search" TabOrder="3" Text="특기사항&#32;&#32;1&#32;" Top="3" VAlign="Middle" Width="72"></Static>
									<Static Align="Right" Height="24" Id="st_sprmk2" Left="474" Style="sty_lb_search" TabOrder="4" Text="특기사항&#32;&#32;2&#32;" Top="3" VAlign="Middle" Width="72"></Static>
									<Static Align="Right" Height="24" Id="st_sprmk3" Left="2" Style="sty_lb_search" TabOrder="5" Text="특기사항&#32;&#32;3&#32;" Top="29" VAlign="Middle" Width="72"></Static>
									<Static Align="Right" Height="24" Id="st_sprmk4" Left="474" Style="sty_lb_search" TabOrder="6" Text="특기사항&#32;&#32;4&#32;" Top="29" VAlign="Middle" Width="72"></Static>
									<Shape BKColor="user0" Bottom="79" Height="26" Id="Shape9" Left="1" LineColor="user1" Right="946" TabOrder="7" Top="53" Type="Rectangle" Width="945"></Shape>
									<Shape BKColor="user0" Bottom="105" Height="26" Id="Shape10" Left="1" LineColor="user1" Right="946" TabOrder="8" Top="79" Type="Rectangle" Width="945"></Shape>
									<Static Align="Right" Height="24" Id="st_sprmk5" Left="2" Style="sty_lb_search" TabOrder="9" Text="특기사항&#32;&#32;5&#32;" Top="55" VAlign="Middle" Width="72"></Static>
									<Static Align="Right" Height="24" Id="st_sprmk6" Left="474" Style="sty_lb_search" TabOrder="10" Text="특기사항&#32;&#32;6&#32;" Top="55" VAlign="Middle" Width="72"></Static>
									<Static Align="Right" Height="24" Id="st_sprmk7" Left="2" Style="sty_lb_search" TabOrder="11" Text="특기사항&#32;&#32;7&#32;" Top="81" VAlign="Middle" Width="72"></Static>
									<Static Align="Right" Height="24" Id="st_sprmk8" Left="474" Style="sty_lb_search" TabOrder="12" Text="특기사항&#32;&#32;8&#32;" Top="81" VAlign="Middle" Width="72"></Static>
									<Edit BindDataset="ds_header" Border="Flat" CheckLength="Byte" Column="SPRMK1" Height="20" Id="ed_sprmk1" ImeMode="native" Left="76" LeftMargin="4" MaxLength="100" RightMargin="4" Style="sty_ipt_form" TabOrder="13" Top="3" Width="392"></Edit>
									<Edit BindDataset="ds_header" Border="Flat" CheckLength="Byte" Column="SPRMK2" Height="20" Id="ed_sprmk2" ImeMode="native" Left="550" LeftMargin="4" MaxLength="100" OnChanged="tab_main_div_header_div_sprmk_ed_sprmk2_OnChanged" RightMargin="4" Style="sty_ipt_form" TabOrder="14" Top="4" Width="392"></Edit>
									<Edit BindDataset="ds_header" Border="Flat" CheckLength="Byte" Column="SPRMK3" Height="20" Id="ed_sprmk3" ImeMode="native" Left="78" LeftMargin="4" MaxLength="100" RightMargin="4" Style="sty_ipt_form" TabOrder="15" Top="30" Width="392"></Edit>
									<Edit BindDataset="ds_header" Border="Flat" CheckLength="Byte" Column="SPRMK4" Height="20" Id="ed_sprmk4" ImeMode="native" Left="550" LeftMargin="4" MaxLength="100" RightMargin="4" Style="sty_ipt_form" TabOrder="16" Top="30" Width="392"></Edit>
									<Edit BindDataset="ds_header" Border="Flat" CheckLength="Byte" Column="SPRMK5" Height="20" Id="ed_sprmk5" ImeMode="native" Left="78" LeftMargin="4" MaxLength="100" RightMargin="4" Style="sty_ipt_form" TabOrder="17" Top="56" Width="392"></Edit>
									<Edit BindDataset="ds_header" Border="Flat" CheckLength="Byte" Column="SPRMK6" Height="20" Id="ed_sprmk6" ImeMode="native" Left="550" LeftMargin="4" MaxLength="100" RightMargin="4" Style="sty_ipt_form" TabOrder="18" Top="56" Width="392"></Edit>
									<Edit BindDataset="ds_header" Border="Flat" CheckLength="Byte" Column="SPRMK7" Height="20" Id="ed_sprmk7" ImeMode="native" Left="78" LeftMargin="4" MaxLength="100" RightMargin="4" Style="sty_ipt_form" TabOrder="19" Top="82" Width="392"></Edit>
									<Edit BindDataset="ds_header" Border="Flat" CheckLength="Byte" Column="SPRMK8" Height="20" Id="ed_sprmk8" ImeMode="native" Left="550" LeftMargin="4" MaxLength="100" RightMargin="4" Style="sty_ipt_form" TabOrder="20" Top="82" Width="392"></Edit>
									<Shape BKColor="user0" Bottom="131" Height="26" Id="Shape0" Left="1" LineColor="user1" Right="946" TabOrder="25" Top="105" Type="Rectangle" Width="945"></Shape>
									<Edit BindDataset="ds_header" Border="Flat" CheckLength="Byte" Column="SPRMK10" Height="20" Id="ed_sprmk10" ImeMode="native" Left="550" LeftMargin="4" MaxLength="100" RightMargin="4" Style="sty_ipt_form" TabOrder="24" Top="108" Width="392"></Edit>
									<Static Align="Right" Height="24" Id="st_sprmk10" Left="474" Style="sty_lb_search" TabOrder="22" Text="특기사항&#32;10&#32;" Top="107" VAlign="Middle" Width="72"></Static>
									<Edit BindDataset="ds_header" Border="Flat" CheckLength="Byte" Column="SPRMK9" Height="20" Id="ed_sprmk9" ImeMode="native" Left="78" LeftMargin="4" MaxLength="100" RightMargin="4" Style="sty_ipt_form" TabOrder="23" Top="108" Width="392"></Edit>
									<Static Align="Right" Height="24" Id="st_sprmk9" Left="2" Style="sty_lb_search" TabOrder="21" Text="특기사항&#32;&#32;9&#32;" Top="107" VAlign="Middle" Width="72"></Static>
								</Contents>
							</Div>
							<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_common" ImageID="btn_sub_04" Left="748" LeftMargin="12" OnClick="btn_common_OnClick" Style="sty_btn" TabOrder="23" Text="공통&#32;추가" Top="330" Transparent="TRUE" Width="71"></Button>
							<Static Align="Right" Height="24" Id="st_waerk" Left="779" Style="sty_lb_search" TabOrder="47" Text="통화&#32;" Top="103" VAlign="Middle" Width="72"></Static>
							<Combo BindDataset="ds_header" Border="Flat" CodeColumn="CODE" Column="WAERK" DataColumn="CODE_NAME" Enable="FALSE" Height="20" Id="cb_waerk" InnerDataset="ds_waerk" Left="853" Style="sty_ipt_form" TabOrder="24" Top="104" Width="111"></Combo>
							<Static Align="Right" Height="24" Id="st_fa_byrgbn" Left="779" Style="sty_lb_search" TabOrder="50" Text="도급구분" Top="129" VAlign="Middle" Width="72"></Static>
							<Combo BindDataset="ds_header" Border="Flat" CodeColumn="CODE" Column="FA_BYRGBN" DataColumn="CODE_NAME" Height="20" Id="cb_fa_byrgbn" InnerDataset="ds_fa_byrgbn" Left="853" Style="sty_ipt_form" TabOrder="50" Top="130" Width="107"></Combo>
							<Static Align="Right" Height="24" Id="st_sum_zcost" Left="117" Style="sty_lb_search" TabOrder="53" Text="원가합계&#32;" Top="328" VAlign="Middle" Width="72"></Static>
							<Static Align="Right" Height="24" Id="st_sum_zeam" Left="277" Style="sty_lb_search" TabOrder="54" Text="견적가합계&#32;" Top="328" VAlign="Middle" Width="72"></Static>
							<Static Align="Right" Height="24" Id="st_sum_shang" Left="436" Style="sty_lb_search" TabOrder="55" Text="시행율&#32;" Top="329" VAlign="Middle" Width="72"></Static>
							<MaskEdit BindDataset="ds_header" BKColor="user5" Border="Flat" BorderColor="user13" Column="ZSUM_ZCOST" Enable="FALSE" Height="20" Id="ed_sum_zcost" Left="192" TabOrder="56" Top="330" Value="MaskEdit0" Width="78"></MaskEdit>
							<MaskEdit BindDataset="ds_header" BKColor="user5" Border="Flat" BorderColor="user13" Column="ZSUM_ZEAM" Enable="FALSE" Height="20" Id="ed_sum_zeam" Left="352" TabOrder="57" Top="330" Value="MaskEdit0" Width="78"></MaskEdit>
							<MaskEdit BindDataset="ds_header" BKColor="user5" Border="Flat" BorderColor="user13" Column="ZSUM_SHANG" Enable="FALSE" Height="20" Id="ed_sum_shang" Left="512" Mask="##0.#" TabOrder="58" Top="330" Width="38"></MaskEdit>
							<Static Align="Right" Height="24" Id="st_sum_znumber" Left="5" Style="sty_lb_search" TabOrder="59" Text="대수합계&#32;" Top="328" VAlign="Middle" Width="72"></Static>
							<MaskEdit BindDataset="ds_header" BKColor="user5" Border="Flat" BorderColor="user13" Column="ZSUM_ZNUMBER" Enable="FALSE" Height="20" Id="ed_sum_znumber" Left="80" TabOrder="60" Top="330" Value="MaskEdit0" Width="30"></MaskEdit>
							<Static Align="Right" Height="24" Id="st_qtgbn" Left="569" Style="sty_lb_search" TabOrder="61" Text="견적구분&#32;" Top="106" VAlign="Middle" Width="72"></Static>
							<Combo BindDataset="ds_header" Border="Flat" CodeColumn="CODE" Column="QTGBN" DataColumn="CODE_NAME" Height="20" Id="cb_qtgbn" ImeMode="none" InnerDataset="ds_qtgbn" Left="643" Style="sty_ipt_search" TabOrder="62" Top="106" Width="107"></Combo>
							<Static Align="Right" Height="24" Id="Static1" Left="556" Style="sty_lb_search" TabOrder="65" Text="목표&#32;시행율&#32;" Top="328" VAlign="Middle" Width="72"></Static>
							<MaskEdit BKColor="user5" Border="Flat" BorderColor="user13" Height="20" Id="ed_gsum" Left="631" Mask="##0.#" OnKeyDown="tab_main_div_header_ed_gsum_OnKeyDown" TabOrder="66" Top="330" Width="38"></MaskEdit>
							<Combo BindDataset="ds_header" Border="Flat" CodeColumn="CODE" Column="INCO" DataColumn="CODE_NAME" Height="20" Id="cb_inco1" InnerDataset="ds_inco1" Left="734" Style="sty_ipt_form" TabOrder="10" Top="131" Visible="FALSE" Width="21"></Combo>
							<Static Align="Right" Height="24" Id="st_pid" Left="2" Style="sty_lb_search" TabOrder="11" Text="현장담당자&#32;" Top="80" VAlign="Middle" Width="72"></Static>
							<Edit BindDataset="ds_header" Border="Flat" CheckLength="Byte" Column="ZPID" Height="20" Id="ed_pid" ImeMode="native" Left="77" LeftMargin="4" MaxLength="10" RightMargin="4" Style="sty_ipt_form" TabOrder="8" Top="81" Width="105"></Edit>
							<Static Align="Right" Height="24" Id="st_tel" Left="186" Style="sty_lb_search" TabOrder="9" Text="현장연락처&#32;" Top="80" VAlign="Middle" Width="72"></Static>
							<Edit BindDataset="ds_header" Border="Flat" Column="ZTEL" Height="20" Id="ed_tel" ImeMode="none" Left="262" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="9" Top="82" Width="105"></Edit>
							<Edit Border="Flat" Enable="FALSE" Height="20" Id="ed_zdeli" ImeMode="native" Left="445" Style="sty_ipt_search" TabOrder="51" Top="82" Width="73"></Edit>
							<Static Align="Right" Height="24" Id="Static0" Left="569" Style="sty_lb_search" TabOrder="63" Text="발주처" Top="80" VAlign="Middle" Width="72"></Static>
							<Edit BindDataset="ds_header" Border="Flat" Column="ZGNM" Height="20" Id="Edit0" ImeMode="native" Left="643" Style="sty_ipt_search" TabOrder="64" Top="82" Width="107"></Edit>
							<Static Align="Right" Height="24" Id="st_zdeli" Left="370" Style="sty_lb_search" TabOrder="52" Text="단납기구분&#32;" Top="80" VAlign="Middle" Width="72"></Static>
							<Grid AutoEnter="TRUE" AutoFitEndLine="Hide" BindDataset="ds_header" BkColor2="default" BoldHead="true" Border="Flat" Bottom="465" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="64" Id="grd_header" InputPanel="FALSE" Left="4" LineColor="user20" LineType="ExHORZ" Right="967" RowHeight="20" Style="sty_grid" TabOrder="23" TabStop="true" Top="401" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="963">
								<contents>
									<format id="Default">
										<columns>
											<col width="30"/>
											<col width="30"/>
											<col width="40"/>
											<col width="0"/>
											<col width="50"/>
											<col width="80"/>
											<col width="40"/>
											<col width="40"/>
											<col width="60"/>
											<col width="40"/>
											<col width="40"/>
											<col width="40"/>
											<col width="40"/>
											<col width="50"/>
										</columns>
										<head>
											<cell align="center" col="0" color="user21" display="text" font="굴림,9" rowspan="2" text="No"/>
											<cell align="center" col="1" color="user21" display="text" font="굴림,9" rowspan="2" text="변경"/>
											<cell align="center" col="2" color="user21" display="text" font="굴림,9" rowspan="2" text="DVR&#10;수량"/>
											<cell align="center" col="3" color="user21" display="text" font="굴림,9" text="자재번호"/>
											<cell align="center" col="4" color="user21" display="text" font="굴림,9" rowspan="2" text="DI_PBX&#10;수량"/>
											<cell align="center" col="5" color="user21" display="text" font="굴림,9" rowspan="2" text="행선층예약&#10;시스템&#32;수량"/>
											<cell align="center" col="6" color="user21" display="text" font="굴림,9" rowspan="2" text="LCD&#10;수량"/>
											<cell align="center" col="7" color="user21" display="text" font="굴림,9" rowspan="2" text="LED&#10;수량"/>
											<cell align="center" col="8" color="user21" display="text" font="굴림,9" rowspan="2" text="시방서"/>
											<cell align="center" col="9" color="user21" colspan="2" display="text" font="굴림,9" text="감시반1"/>
											<cell align="center" col="11" color="user21" colspan="2" display="text" font="굴림,9" text="감시반2"/>
											<cell align="center" col="13" color="user21" display="text" font="굴림,9" rowspan="2" text="비고"/>
											<cell col="3" row="1"/>
											<cell align="center" col="9" color="user21" display="text" font="굴림,9" row="1" text="특성"/>
											<cell align="center" col="10" color="user21" display="text" font="굴림,9" row="1" text="수량"/>
											<cell align="center" col="11" color="user21" display="text" font="굴림,9" row="1" text="특성"/>
											<cell align="center" col="12" color="user21" display="text" font="굴림,9" row="1" text="수량"/>
										</head>
										<body>
											<cell align="center" bkcolor2="user22" col="0" display="text" expr="currow+1"/>
											<cell align="center" bkcolor2="user22" bkimageid='expr:gfn_getFlagBkImageID(getColumn(currow,&#32;&quot;FLAG&quot;))' col="1" colid="FLAG" display="image"/>
											<cell align="right" bkcolor2="user22" col="2" colid="CO_DDVRTQ" display="number"/>
											<cell align="center" bkcolor2="user22" col="3" colid="MATNR" display="text" edit="normal"/>
											<cell align="right" bkcolor2="user22" col="4" colid="CO_DEPHTQ" display="number"/>
											<cell align="right" bkcolor2="user22" col="5" colid="CO_DSSQ" display="number"/>
											<cell align="right" bkcolor2="user22" col="6" colid="CO_BCLCDTQ" display="number"/>
											<cell align="right" bkcolor2="user22" col="7" colid="CO_CHPITQ" display="number"/>
											<cell align="right" bkcolor2="user22" col="8" colid="CO_ASPC" display="text"/>
											<cell align="center" bkcolor2="user22" col="9" colid="CO_DSV1" display="text"/>
											<cell align="right" bkcolor2="user22" col="10" colid="CO_DSV1TQ" display="number"/>
											<cell align="center" bkcolor2="user22" col="11" colid="CO_DSV2" display="text"/>
											<cell align="right" bkcolor2="user22" col="12" colid="CO_DSV2TQ" display="number"/>
											<cell align="center" bkcolor2="user22" col="13" display="text"/>
										</body>
									</format>
								</contents>
							</Grid>
							<Static Align="Center" Height="24" Id="Static2" Left="228" Style="sty_lb_search" TabOrder="68" Text="승강기&#32;견적번호(주차)" Top="131" VAlign="Middle" Width="128"></Static>
							<Edit BindDataset="ds_header" Border="Flat" CheckLength="Byte" Column="AQTNUM" Height="22" Id="ed_aqtnum" ImeMode="none" Left="362" MaxLength="100" Style="sty_ipt_form" TabOrder="69" Top="132" UpperOnly="TRUE" Width="89"></Edit>
							<Button Cursor="HAND" Height="18" Id="btn_pjt" ImageID="btn_icon_search" Left="456" OnClick="ufn_openPjt" TabOrder="70" Top="134" Transparent="TRUE" Width="18"></Button>
							<Static Align="Center" Height="24" Id="Static3" Left="2" Style="sty_lb_search" TabOrder="72" Text="CRM_영업기회ID(S/S)" Top="131" VAlign="Middle" Width="130"></Static>
							<Edit BindDataset="ds_header" Border="Flat" CheckLength="Byte" Column="OPPID" Height="22" Id="ed_oppid" ImeMode="none" Left="136" MaxLength="11" Style="sty_ipt_form" TabOrder="73" Top="132" UpperOnly="TRUE" Width="89"></Edit>
							<Static Align="Right" Height="24" Id="st_zbdtyp" Left="569" Style="sty_lb_search" TabOrder="74" Text="건물용도&#32;" Top="52" VAlign="Middle" Width="72"></Static>
							<Combo Border="Flat" CodeColumn="BUILDUSE_L" DataColumn="STEXT" Height="20" Id="cb_zbdtyp_l" InnerDataset="ds_list_build_l" Left="643" OnChanged="cb_zbdtyp_l_OnChanged" Style="sty_ipt_form" TabOrder="76" Top="55" Width="137"></Combo>
							<Combo BindDataset="ds_header" Border="Flat" CodeColumn="BUILDUSE" Column="ZBDTYP" DataColumn="STEXT" Height="20" Id="cb_zbdtyp" InnerDataset="ds_list_build" Left="780" Style="sty_ipt_form" TabOrder="75" Top="55" Width="176"></Combo>
						</Contents>
					</Div>
				</TabPage>
				<TabPage BorderColor="black" Height="470" Id="template" ImageEdgeWidth="2" ImageID="tab_main" Left="2" TabOrder="26" Text="사양내용" Top="23" Width="988">
					<Div Border="SunkenEdge" Height="467" Id="div_template" scroll="true" TabOrder="1" Text="Div0" Top="1" Width="974">
						<Contents>
							<Grid AreaSelect="TRUE" AutoEnter="TRUE" AutoFit="TRUE" AutoFitEndLine="Hide" BindDataset="ds_template5" BkColor2="default" BoldHead="true" Border="Flat" Bottom="463" ColSelect="TRUE" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="25" Height="409" Id="grd_template5" InputPanel="FALSE" Left="1808" LineColor="user20" LineType="ExHORZ" MinWidth="100" OnCellDBLClick="grd_template_OnCellDblClick" OnCellPosChanged="grd_template_OnCellPosChanged" OnKeyDown="grd_detail_OnKeyDown" OnMouseOver="tab_template_div_template_grd_template_OnMouseOver" Right="2258" RowHeight="20" Style="sty_grid" TabOrder="1" TabStop="true" Top="54" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="450">
								<contents>
									<format id="Default">
										<columns>
											<col width="0"/>
											<col width="30"/>
											<col width="170"/>
											<col width="60"/>
										</columns>
										<head>
											<cell align="center" col="0" color="user21" display="text" font="굴림,9" text="No"/>
											<cell align="center" col="1" color="user21" display="text" font="굴림,9" text="변경"/>
											<cell align="center" col="2" color="user21" display="text" font="굴림,9" text="LAYOUT" wordwrap="word"/>
											<cell col="3" color="user21" display="text" font="굴림,9" text="값" wordwrap="word"/>
										</head>
										<body>
											<cell align="center" bkcolor2="user22" col="0" display="text" expr="currow+1"/>
											<cell align="center" bkcolor2="user22" bkimageid='expr:gfn_getFlagBkImageID(getColumn(currow,&#32;&quot;FLAG&quot;))' col="1" colid="FLAG" display="image"/>
											<cell align="left" bkcolor="expr:iif(trim(PCNCD)=&apos;C&apos;,&apos;peachpuff&apos;,iif(trim(PCNCD)&#32;=&#32;&apos;P&apos;,&#32;&apos;lightpink&apos;,&#32;&apos;default&apos;))" bkcolor2="expr:iif(trim(PCNCD)=&apos;C&apos;,&apos;peachpuff&apos;,iif(trim(PCNCD)&#32;=&#32;&apos;P&apos;,&#32;&apos;lightpink&apos;,&#32;&apos;User&#32;Color22&apos;))" col="2" colid="PRHNAME" display="text" suppress="1"/>
											<cell align="center" bkcolor="expr:iif(trim(PCNCD)=&apos;C&apos;,&apos;peachpuff&apos;,iif(trim(PCNCD)&#32;=&#32;&apos;P&apos;,&#32;&apos;lightpink&apos;,&#32;&apos;default&apos;))" bkcolor2="expr:iif(trim(PCNCD)=&apos;C&apos;,&apos;peachpuff&apos;,iif(trim(PCNCD)&#32;=&#32;&apos;P&apos;,&#32;&apos;lightpink&apos;,&#32;&apos;User&#32;Color22&apos;))" checklength="Byte" col="3" colid="PRD" display="expr:decode(ATFOR,&apos;NUM&apos;,&apos;number&apos;,&apos;text&apos;)" edit="expr:decode(ATFOR,&apos;NUM&apos;,&apos;number&apos;,&apos;normal&apos;)" limit="30"/>
										</body>
									</format>
								</contents>
							</Grid>
							<Grid AreaSelect="TRUE" AutoEnter="TRUE" AutoFit="TRUE" AutoFitEndLine="Hide" BindDataset="ds_template4" BkColor2="default" BoldHead="true" Border="Flat" Bottom="463" ColSelect="TRUE" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="25" Height="409" Id="grd_template4" InputPanel="FALSE" Left="1357" LineColor="user20" LineType="ExHORZ" MinWidth="100" OnCellDBLClick="grd_template_OnCellDblClick" OnCellPosChanged="grd_template_OnCellPosChanged" OnKeyDown="grd_detail_OnKeyDown" OnMouseOver="tab_template_div_template_grd_template_OnMouseOver" Right="1807" RowHeight="20" Style="sty_grid" TabOrder="2" TabStop="true" Top="54" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="450">
								<contents>
									<format id="Default">
										<columns>
											<col width="0"/>
											<col width="30"/>
											<col width="170"/>
											<col width="60"/>
										</columns>
										<head>
											<cell align="center" col="0" color="user21" display="text" font="굴림,9" text="No"/>
											<cell align="center" col="1" color="user21" display="text" font="굴림,9" text="변경"/>
											<cell align="center" col="2" color="user21" display="text" font="굴림,9" text="OPTION" wordwrap="word"/>
											<cell col="3" color="user21" display="text" font="굴림,9" text="값" wordwrap="word"/>
										</head>
										<body>
											<cell align="center" bkcolor2="user22" col="0" display="text" expr="currow+1"/>
											<cell align="center" bkcolor2="user22" bkimageid='expr:gfn_getFlagBkImageID(getColumn(currow,&#32;&quot;FLAG&quot;))' col="1" colid="FLAG" display="image"/>
											<cell align="left" bkcolor="expr:iif(trim(PCNCD)=&apos;C&apos;,&apos;peachpuff&apos;,iif(trim(PCNCD)&#32;=&#32;&apos;P&apos;,&#32;&apos;lightpink&apos;,&#32;&apos;default&apos;))" bkcolor2="expr:iif(trim(PCNCD)=&apos;C&apos;,&apos;peachpuff&apos;,iif(trim(PCNCD)&#32;=&#32;&apos;P&apos;,&#32;&apos;lightpink&apos;,&#32;&apos;User&#32;Color22&apos;))" col="2" colid="PRHNAME" display="text" suppress="1"/>
											<cell align="center" bkcolor="expr:iif(trim(PCNCD)=&apos;C&apos;,&apos;peachpuff&apos;,iif(trim(PCNCD)&#32;=&#32;&apos;P&apos;,&#32;&apos;lightpink&apos;,&#32;&apos;default&apos;))" bkcolor2="expr:iif(trim(PCNCD)=&apos;C&apos;,&apos;peachpuff&apos;,iif(trim(PCNCD)&#32;=&#32;&apos;P&apos;,&#32;&apos;lightpink&apos;,&#32;&apos;User&#32;Color22&apos;))" checklength="Byte" col="3" colid="PRD" display="expr:decode(ATFOR,&apos;NUM&apos;,&apos;number&apos;,&apos;text&apos;)" edit="expr:decode(ATFOR,&apos;NUM&apos;,&apos;number&apos;,&apos;normal&apos;)" limit="30"/>
										</body>
									</format>
								</contents>
							</Grid>
							<Grid AreaSelect="TRUE" AutoEnter="TRUE" AutoFit="TRUE" AutoFitEndLine="Hide" BindDataset="ds_template3" BkColor2="default" BoldHead="true" Border="Flat" Bottom="439" ColSelect="TRUE" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="25" Height="385" Id="grd_template3" InputPanel="FALSE" Left="906" LineColor="user20" LineType="ExHORZ" MinWidth="100" OnCellDBLClick="grd_template_OnCellDblClick" OnCellPosChanged="grd_template_OnCellPosChanged" OnKeyDown="grd_detail_OnKeyDown" OnMouseOver="tab_template_div_template_grd_template_OnMouseOver" Right="1356" RowHeight="20" Style="sty_grid" TabOrder="3" TabStop="true" Top="54" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="450">
								<contents>
									<format id="Default">
										<columns>
											<col width="0"/>
											<col width="30"/>
											<col width="170"/>
											<col width="70"/>
										</columns>
										<head>
											<cell align="center" col="0" color="user21" display="text" font="굴림,9" text="No"/>
											<cell align="center" col="1" color="user21" display="text" font="굴림,9" text="변경"/>
											<cell align="center" col="2" color="user21" display="text" font="굴림,9" text="OUTSIDE" wordwrap="word"/>
											<cell col="3" color="user21" display="text" font="굴림,9" text="값" wordwrap="word"/>
										</head>
										<body>
											<cell align="center" bkcolor2="user22" col="0" display="text" expr="currow+1"/>
											<cell align="center" bkcolor2="user22" bkimageid='expr:gfn_getFlagBkImageID(getColumn(currow,&#32;&quot;FLAG&quot;))' col="1" colid="FLAG" display="image"/>
											<cell align="left" bkcolor="expr:iif(trim(PCNCD)=&apos;C&apos;,&apos;peachpuff&apos;,iif(trim(PCNCD)&#32;=&#32;&apos;P&apos;,&#32;&apos;lightpink&apos;,&#32;&apos;default&apos;))" bkcolor2="expr:iif(trim(PCNCD)=&apos;C&apos;,&apos;peachpuff&apos;,iif(trim(PCNCD)&#32;=&#32;&apos;P&apos;,&#32;&apos;lightpink&apos;,&#32;&apos;User&#32;Color22&apos;))" col="2" colid="PRHNAME" display="text" suppress="1"/>
											<cell align="center" bkcolor="expr:iif(trim(PCNCD)=&apos;C&apos;,&apos;peachpuff&apos;,iif(trim(PCNCD)&#32;=&#32;&apos;P&apos;,&#32;&apos;lightpink&apos;,&#32;&apos;default&apos;))" bkcolor2="expr:iif(trim(PCNCD)=&apos;C&apos;,&apos;peachpuff&apos;,iif(trim(PCNCD)&#32;=&#32;&apos;P&apos;,&#32;&apos;lightpink&apos;,&#32;&apos;User&#32;Color22&apos;))" checklength="Byte" col="3" colid="PRD" display="expr:decode(ATFOR,&apos;NUM&apos;,&apos;number&apos;,&apos;text&apos;)" edit="expr:decode(ATFOR,&apos;NUM&apos;,&apos;number&apos;,&apos;normal&apos;)" limit="30"/>
										</body>
									</format>
								</contents>
							</Grid>
							<Grid AreaSelect="TRUE" AutoEnter="TRUE" AutoFit="TRUE" AutoFitEndLine="Hide" BindDataset="ds_template2" BkColor2="default" BoldHead="true" Border="Flat" Bottom="439" ColSelect="TRUE" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="25" Height="385" Id="grd_template2" InputPanel="FALSE" Left="455" LineColor="user20" LineType="ExHORZ" MinWidth="100" OnCellDBLClick="grd_template_OnCellDblClick" OnCellPosChanged="grd_template_OnCellPosChanged" OnKeyDown="grd_detail_OnKeyDown" OnMouseOver="tab_template_div_template_grd_template_OnMouseOver" Right="905" RowHeight="20" Style="sty_grid" TabOrder="4" TabStop="true" Top="54" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="450">
								<contents>
									<format id="Default">
										<columns>
											<col width="0"/>
											<col width="30"/>
											<col width="170"/>
											<col width="70"/>
										</columns>
										<head>
											<cell align="center" col="0" color="user21" display="text" font="굴림,9" text="No"/>
											<cell align="center" col="1" color="user21" display="text" font="굴림,9" text="변경"/>
											<cell align="center" col="2" color="user21" display="text" font="굴림,9" text="INSIDE" wordwrap="word"/>
											<cell col="3" color="user21" display="text" font="굴림,9" text="값" wordwrap="word"/>
										</head>
										<body>
											<cell align="center" bkcolor2="user22" col="0" display="text" expr="currow+1"/>
											<cell align="center" bkcolor2="user22" bkimageid='expr:gfn_getFlagBkImageID(getColumn(currow,&#32;&quot;FLAG&quot;))' col="1" colid="FLAG" display="image"/>
											<cell align="left" bkcolor="expr:iif(trim(PCNCD)=&apos;C&apos;,&apos;peachpuff&apos;,iif(trim(PCNCD)&#32;=&#32;&apos;P&apos;,&#32;&apos;lightpink&apos;,&#32;&apos;default&apos;))" bkcolor2="expr:iif(trim(PCNCD)=&apos;C&apos;,&apos;peachpuff&apos;,iif(trim(PCNCD)&#32;=&#32;&apos;P&apos;,&#32;&apos;lightpink&apos;,&#32;&apos;User&#32;Color22&apos;))" col="2" colid="PRHNAME" display="text" suppress="1"/>
											<cell align="center" bkcolor="expr:iif(trim(PCNCD)=&apos;C&apos;,&apos;peachpuff&apos;,iif(trim(PCNCD)&#32;=&#32;&apos;P&apos;,&#32;&apos;lightpink&apos;,&#32;&apos;default&apos;))" bkcolor2="expr:iif(trim(PCNCD)=&apos;C&apos;,&apos;peachpuff&apos;,iif(trim(PCNCD)&#32;=&#32;&apos;P&apos;,&#32;&apos;lightpink&apos;,&#32;&apos;User&#32;Color22&apos;))" checklength="Byte" col="3" colid="PRD" display="expr:decode(ATFOR,&apos;NUM&apos;,&apos;number&apos;,&apos;text&apos;)" edit="expr:decode(ATFOR,&apos;NUM&apos;,&apos;number&apos;,&apos;normal&apos;)" limit="30"/>
										</body>
									</format>
								</contents>
							</Grid>
							<Grid AreaSelect="TRUE" AutoEnter="TRUE" AutoFit="TRUE" AutoFitEndLine="Hide" BindDataset="ds_template1" BkColor2="default" BoldHead="true" Border="Flat" Bottom="439" ColSelect="TRUE" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="25" Height="385" Id="grd_template1" InputPanel="FALSE" Left="4" LineColor="user20" LineType="ExHORZ" MinWidth="100" OnCellDBLClick="grd_template_OnCellDblClick" OnCellPosChanged="grd_template_OnCellPosChanged" OnKeyDown="grd_detail_OnKeyDown" OnMouseOver="tab_template_div_template_grd_template_OnMouseOver" Right="454" RowHeight="20" Style="sty_grid" TabOrder="5" TabStop="true" Top="54" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="450">
								<contents>
									<format id="Default">
										<columns>
											<col width="0"/>
											<col width="30"/>
											<col width="170"/>
											<col width="60"/>
										</columns>
										<head>
											<cell align="center" col="0" color="user21" display="text" font="굴림,9" text="No"/>
											<cell align="center" col="1" color="user21" display="text" font="굴림,9" text="변경"/>
											<cell align="center" col="2" color="user21" display="text" font="굴림,9" text="BASIC" wordwrap="word"/>
											<cell col="3" color="user21" display="text" font="굴림,9" text="값" wordwrap="word"/>
										</head>
										<body>
											<cell align="center" bkcolor2="user22" col="0" display="text" expr="currow+1"/>
											<cell align="center" bkcolor2="user22" bkimageid='expr:gfn_getFlagBkImageID(getColumn(currow,&#32;&quot;FLAG&quot;))' col="1" colid="FLAG" display="image"/>
											<cell align="left" bkcolor="expr:iif(trim(PCNCD)=&apos;C&apos;,&apos;peachpuff&apos;,iif(trim(PCNCD)&#32;=&#32;&apos;P&apos;,&#32;&apos;lightpink&apos;,&#32;&apos;default&apos;))" bkcolor2="expr:iif(trim(PCNCD)=&apos;C&apos;,&apos;peachpuff&apos;,iif(trim(PCNCD)&#32;=&#32;&apos;P&apos;,&#32;&apos;lightpink&apos;,&#32;&apos;User&#32;Color22&apos;))" col="2" colid="PRHNAME" display="text" suppress="1"/>
											<cell align="center" bkcolor="expr:iif(trim(PCNCD)=&apos;C&apos;,&apos;peachpuff&apos;,iif(trim(PCNCD)&#32;=&#32;&apos;P&apos;,&#32;&apos;lightpink&apos;,&#32;&apos;default&apos;))" bkcolor2="expr:iif(trim(PCNCD)=&apos;C&apos;,&apos;peachpuff&apos;,iif(trim(PCNCD)&#32;=&#32;&apos;P&apos;,&#32;&apos;lightpink&apos;,&#32;&apos;User&#32;Color22&apos;))" checklength="Byte" col="3" colid="PRD" display="expr:decode(ATFOR,&apos;NUM&apos;,&apos;number&apos;,&apos;text&apos;)" edit="expr:decode(ATFOR,&apos;NUM&apos;,&apos;number&apos;,&apos;normal&apos;)" limit="30"/>
										</body>
									</format>
								</contents>
							</Grid>
							<Shape BKColor="user0" Bottom="26" Height="26" Id="Shape1" Left="0" LineColor="user1" Right="1084" TabOrder="6" Top="0" Type="Rectangle" Width="1084"></Shape>
							<Static Align="Right" Height="24" Id="st_gtype" Left="314" Style="sty_lb_search" TabOrder="11" Text="기종/인승/속도/층수&#32;" Top="1" VAlign="Middle" Width="136"></Static>
							<Edit Align="CENTER" BindDataset="ds_detail" Border="Flat" Column="GTYPE" Enable="FALSE" Height="20" Id="ed_gtype" ImeMode="native" Left="454" Readonly="TRUE" Style="sty_ipt_search" TabOrder="10" Top="3" Width="80"></Edit>
							<Edit Align="CENTER" BindDataset="ds_detail" Border="Flat" Column="TYPE1" Enable="FALSE" Height="20" Id="ed_type1" Left="538" LeftMargin="4" Readonly="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="9" Top="3" Width="80"></Edit>
							<Edit Align="CENTER" BindDataset="ds_detail" Border="Flat" Column="TYPE2" Enable="FALSE" Height="20" Id="ed_type2" Left="622" LeftMargin="4" Readonly="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="8" Top="3" Width="80"></Edit>
							<Edit Align="CENTER" BindDataset="ds_detail" Border="Flat" Column="TYPE3" Enable="FALSE" Height="20" Id="ed_type3" Left="706" LeftMargin="4" Readonly="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="7" Top="3" Width="80"></Edit>
							<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_template" ImageID="btn_sub_07" Left="68" LeftMargin="12" OnClick="btn_template_OnClick" Style="sty_btn" TabOrder="12" Text="템플릿&#32;불러오기" Top="30" Transparent="TRUE" Width="112"></Button>
							<Grid AreaSelect="TRUE" AutoEnter="TRUE" AutoFit="TRUE" AutoFitEndLine="Hide" BindDataset="ds_template0" BkColor2="default" BoldHead="true" Border="Flat" Bottom="439" ColSelect="TRUE" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="25" Height="409" Id="grd_template0" InputPanel="FALSE" Left="2259" LineColor="user20" LineType="ExHORZ" MinWidth="100" OnCellDBLClick="grd_template_OnCellDblClick" OnCellPosChanged="grd_template_OnCellPosChanged" OnKeyDown="grd_detail_OnKeyDown" OnMouseOver="tab_template_div_template_grd_template_OnMouseOver" Right="2709" RowHeight="20" Style="sty_grid" TabOrder="13" TabStop="true" Top="30" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="450">
								<contents>
									<format id="Default">
										<columns>
											<col width="0"/>
											<col width="30"/>
											<col width="158"/>
											<col width="40"/>
										</columns>
										<head>
											<cell align="center" col="0" color="user21" display="text" font="굴림,9" text="No"/>
											<cell align="center" col="1" color="user21" display="text" font="굴림,9" text="변경"/>
											<cell align="center" col="2" color="user21" display="text" font="굴림,9" text="COMMON" wordwrap="word"/>
											<cell col="3" color="user21" display="text" font="굴림,9" text="값" wordwrap="word"/>
										</head>
										<body>
											<cell align="center" bkcolor2="user22" col="0" display="text" expr="currow+1"/>
											<cell align="center" bkcolor2="user22" bkimageid='expr:gfn_getFlagBkImageID(getColumn(currow,&#32;&quot;FLAG&quot;))' col="1" colid="FLAG" display="image"/>
											<cell align="left" bkcolor="expr:iif(trim(PCNCD)=&apos;C&apos;,&apos;peachpuff&apos;,iif(trim(PCNCD)&#32;=&#32;&apos;P&apos;,&#32;&apos;lightpink&apos;,&#32;&apos;default&apos;))" bkcolor2="expr:iif(trim(PCNCD)=&apos;C&apos;,&apos;peachpuff&apos;,iif(trim(PCNCD)&#32;=&#32;&apos;P&apos;,&#32;&apos;lightpink&apos;,&#32;&apos;User&#32;Color22&apos;))" col="2" colid="PRHNAME" display="text" suppress="1"/>
											<cell align="center" bkcolor="expr:iif(trim(PCNCD)=&apos;C&apos;,&apos;peachpuff&apos;,iif(trim(PCNCD)&#32;=&#32;&apos;P&apos;,&#32;&apos;lightpink&apos;,&#32;&apos;default&apos;))" bkcolor2="expr:iif(trim(PCNCD)=&apos;C&apos;,&apos;peachpuff&apos;,iif(trim(PCNCD)&#32;=&#32;&apos;P&apos;,&#32;&apos;lightpink&apos;,&#32;&apos;User&#32;Color22&apos;))" checklength="Byte" col="3" colid="PRD" display="text" edit="expr:decode(ATFOR,&apos;NUM&apos;,&apos;number&apos;,&apos;normal&apos;)" limit="30"/>
										</body>
									</format>
								</contents>
							</Grid>
							<Combo CodeColumn="CODE" Color="MENUTEXT" DataColumn="CODE_NAME" Height="20" Id="cb_block" InnerDataset="ds_duty_block" Left="2" TabOrder="15" Top="2" Width="224"></Combo>
							<Button Color="MENUTEXT" Height="21" Id="btn_duty" Left="226" OnClick="btn_duty_OnClick" TabOrder="14" Text="Duty&#32;Call" Top="2" Width="80"></Button>
							<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_depend" ImageID="btn_sub_03" Left="4" LeftMargin="12" OnClick="fn_dependDuty" Style="sty_btn" TabOrder="16" Text="종속성" Top="30" Transparent="TRUE" Width="62"></Button>
							<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_depend2" ImageID="btn_sub_07" Left="963" LeftMargin="12" Style="sty_btn" TabOrder="17" Top="2" Transparent="TRUE" Width="113"></Button>
							<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_plad_validation" ImageID="btn_sub_06" Left="180" LeftMargin="12" OnClick="btn_plad_mesg_OnClick" Style="sty_btn" TabOrder="18" Text="수용대수&#32;검증" Top="30" Transparent="TRUE" Width="102"></Button>
							<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_plad_create" ImageID="btn_sub_06" Left="372" LeftMargin="12" OnClick="btn_plad_OnClick" Style="sty_btn" TabOrder="19" Text="표준&#32;도면&#32;생성" Top="30" Transparent="TRUE" Width="96"></Button>
							<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_plad_search" ImageID="btn_sub_06" Left="276" LeftMargin="12" OnClick="btn_plad_OnClick" Style="sty_btn" TabOrder="20" Text="표준&#32;도면조회" Top="30" Transparent="TRUE" Width="96"></Button>
							<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_plad_cb" ImageID="btn_sub_13" Left="468" LeftMargin="12" OnClick="btn_plad_mesg_OnClick" Style="sty_btn" TabOrder="21" Text="상세&#32;Column&#32;Base&#32;요청" Top="30" Transparent="TRUE" Width="150"></Button>
						</Contents>
					</Div>
				</TabPage>
			</Contents>
		</Tab>
		<Shape BKColor="user0" Bottom="63" Height="26" Id="Shape1" Left="6" LineColor="user1" Right="963" TabOrder="2" Top="37" Type="Rectangle" Width="957"></Shape>
		<Static Align="Right" Height="24" Id="st_qtnum" Left="7" Style="sty_lb_search" TabOrder="3" Text="견적번호&#32;" Top="38" VAlign="Middle" Width="72"></Static>
		<Static Align="Right" Height="24" Id="st_qtdat" Left="478" Style="sty_lb_search" TabOrder="4" Text="견적작성일" Top="38" VAlign="Middle" Width="72"></Static>
		<Calendar BindDataset="ds_header" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="QTDAT" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_qtdat" Left="554" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="5" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="40" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="90"></Calendar>
		<Static Align="Right" Height="24" Id="st_name" Left="-118" Style="sty_lb_search" TabOrder="6" Text="현장명&#32;" Top="-3" VAlign="Middle" Width="61"></Static>
		<Static Align="Right" Height="24" Id="st_ser" Left="207" Style="sty_lb_search" TabOrder="7" Text="견적차수&#32;" Top="38" VAlign="Middle" Width="72"></Static>
		<Edit BindDataset="ds_header" Border="Flat" Column="QTNUM" Enable="FALSE" Height="20" Id="ed_qtnum" Left="83" LeftMargin="4" MaxLength="10" RightMargin="4" Style="sty_ipt_form" TabOrder="1" Top="40" Width="105"></Edit>
		<Edit BindDataset="ds_header" Border="Flat" CheckLength="Byte" Column="QTSER" Enable="FALSE" Height="20" Id="ed_ser" ImeMode="native" Left="283" LeftMargin="4" MaxLength="10" RightMargin="4" Style="sty_ipt_form" TabOrder="8" Top="40" Width="105"></Edit>
		<Div Height="30" Id="div_btn" Left="-2" TabOrder="9" Text="Div0" Top="3" Url="WB01::CommBtnForm.xml" Width="976">
			<Contents></Contents>
		</Div>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_qtser_plus" ImageID="btn_sub_02" Left="645" LeftMargin="12" OnClick="btn_qtser_plus_OnClick" Style="sty_btn" TabOrder="10" Text="차수+" Top="40" Transparent="TRUE" Visible="FALSE" Width="47"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_count" ImageID="btn_sub_04" Left="741" LeftMargin="12" OnClick="btn_count_OnClick" Style="sty_btn" TabOrder="11" Text="원가산출" Top="40" Transparent="TRUE" Visible="FALSE" Width="71"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_part" ImageID="btn_sub_04" Left="813" LeftMargin="12" OnClick="btn_part_OnClick" Style="sty_btn" TabOrder="12" Text="부분원가" Top="40" Transparent="TRUE" Visible="FALSE" Width="71"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_countRequest" ImageID="btn_sub_04" Left="813" LeftMargin="12" OnClick="btn_countRequest_OnClick" Style="sty_btn" TabOrder="13" Text="원가의뢰" Top="40" Transparent="TRUE" Visible="FALSE" Width="72"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_costApproval" ImageID="btn_sub_04" Left="885" LeftMargin="12" OnClick="btn_costApproval_OnClick" Style="sty_btn" TabOrder="14" Text="원가승인" Top="40" Transparent="TRUE" Visible="FALSE" Width="71"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_qtser_minus" ImageID="btn_sub_02" Left="693" LeftMargin="12" OnClick="btn_qtser_minus_OnClick" Style="sty_btn" TabOrder="15" Text="차수-" Top="40" Transparent="TRUE" Visible="FALSE" Width="47"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_costReject" ImageID="btn_sub_04" Left="405" LeftMargin="12" OnClick="btn_costReject_OnClick" Style="sty_btn" TabOrder="16" Text="원가반려" Top="40" Transparent="TRUE" Visible="FALSE" Width="71"></Button>
		<AxMSIE Bottom="611" Height="3" Id="AxMSIE0" Left="1016" Right="1016" TitleChange="AxMSIE0_TitleChange" Top="608" Width="0"></AxMSIE>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_estimate" ImageID="btn_sub_04" Left="741" LeftMargin="12" OnClick="btn_estimate_OnClick" Style="sty_btn" TabOrder="18" Text="승인요청" Top="40" Transparent="TRUE" Visible="FALSE" Width="71"></Button>
	</Form>
	<Script><![CDATA[/*
 ******************************************************************************************
 * 기      능   : 
 * 작  성  자   : 
 * 작성  일자   : 
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
#include "LIB::commons.js";	// 공통 스크립트 
#include "LIB::nsfRequest.js";	// 공통 스크립트 
#include "LIB::common_hdel.js";	// 공통 스크립트  /* GNY 추가 */

//=========================================================================================
// [ PART 1 ]
// Form에서 사용될 전역변수를 선언
// FORM에서 사용되는 전역변수는 대문자로 작성하며, F_XXX 의 형태를 갖도록 한다. 
//=========================================================================================

var F_FRM_ID 	= "Ses0031";
var F_FRM_TITLE = "견적상세(S/S)";	// 공통코드 화면명
var F_MAX_SERNO = 0;  			// 조회된 목록의 MAX(순번)
var F_CHG_DETAIL_ROWNUM = ""; 	// 최종 변경된 Detail 헹번호
var F_CHG_DETAIL_COLNUM = ""; 	// 최종 변경된 Detail 컬럼번호
var F_GRID_SELECT = "";			// Detail의 그리드를 선택하는 경우 Y로 세팅 2013.01.09
var F_CLCIK_EVENT = "OFF";		// ON의 경우 click 처리 (S/P 단가 처리 용) 2013.01.16
var F_CLICKED_ROW = -1; 		// ds_detail 그리드의 클릭한 행 2013.02.01

var flag;
var zprdgbn;
var zprgflg;

var zkunnr;
var zkunnrNm;

var vdate;

//=========================================================================================
// [ PART 2 ]
// Form Loading / Unloading 시 작업 정의
//=========================================================================================
function fn_OnLoadCompleted(obj) {

	gfn_initForm(true);	// Form 로드 이벤트 맨 첫줄에 기술

	tab.TabIndex = 0;

	// 2012.12.29 DVR수량~ 등 M/O별 공통사양 정보표기 부분은 화면에서 표기되지 않도록 요청 처리
	// 화면상에서만 보이지 않도록 조치함
	tab.main.div_header.grd_header.Visible = false;
	tab.main.div_header.grd_detail.Height  = tab.main.div_header.grd_detail.Height + 70;

	var codeArr    = ["SD107",    "BS102",  "VKBUR",  "VKGRP",  "CS115",  "SPART",      "WAERK",  "SD118"]; 	//코드콤보 설정
	var dsObjArr   = [ds_zprgflg, ds_sukum, ds_vkbur, ds_vkgrp, ds_zregn1, ds_spart_cd, ds_waerk, ds_fa_byrgbn ];
	var addTypeArr = [G_CODE_NONE,G_CODE_NONE,G_CODE_SELECT,G_CODE_NONE,G_CODE_NONE,G_CODE_NONE,G_CODE_NONE,G_CODE_NONE,G_CODE_NONE]; //[G_CODE_NONE,G_CODE_NONE,G_CODE_NONE]; [G_CODE_ALL];
	var oderTypeArr = ["DTEXT1"];
	gfn_searchCommCode(codeArr, dsObjArr, addTypeArr);

	div_btn.fn_loadUseBtn("30,40,45", F_FRM_TITLE, "", "");
	div_btn.btn_excel.domainID = "";
	div_btn.btn_excel.imageID  = "btn_comm_print_k";
	div_btn.btn_excel.Text     = "내역";
    
	fn_resize(); // 2013.02.07 사양 넓게 보이기 위해 사이즈 조정

    // 건물용도(대분류), 건물용도 코드목록 조회
    fn_query_bdtyp();	
    
	nsfRequest("queryInco", "combo/comboInco", "ds_list_inco1=ds_inco1", "ds_inco1=ds_list_inco1 ds_error=ds_error", "", "fn_afterQuery");
}

/********************************************************************************
* 기      능   : form UnloadCompleted 
********************************************************************************/
function fn_OnUnloadCompleted(obj) {
	return gfn_isFormUnload(obj);
}

/********************************************************************************
* 기      능   : 공통코드가 조회된 후의 Callback 함수 
********************************************************************************/
function fn_completeInit(sCode, sDsObj, sCodeType) {
	
	/*for ( i = 0 ; i <= ds_fa_byrgbn.GetRowCount() ; i++)
	{
		switch (ds_fa_byrgbn.GetColumn(i,"CODE")) {
		case "A" : 
			ds_fa_byrgbn.SetColumn(i,"CODE_NAME","삼성물산, 삼성에버랜드 설치비 30%증가"); break;
		case "B" : 
			ds_fa_byrgbn.SetColumn(i,"CODE_NAME","지하철/발전소 설치비 20%증가"); break;
		case "C" : 
			ds_fa_byrgbn.SetColumn(i,"CODE_NAME","1군건설사/10대이상현장 10%증가"); break;
		case "D" : 
			ds_fa_byrgbn.SetColumn(i,"CODE_NAME","일반공사"); break;
		case "E" : 
			ds_fa_byrgbn.SetColumn(i,"CODE_NAME","관급공사 설치비 10%증가"); break;
		default  : break;
		}
	}*/
	
	fn_init_form(); 	// 폼 초기화
	gfn_insertEmptyRow(ds_sukum, "");
}

/********************************************************************************
* 기      능   : 폼 초기화
********************************************************************************/
function fn_init_form() 
{
	var vfa_sonnr = fa_sonnr;
	var vfa_qtnum = fa_qtnum;
	var vfa_qtser = fa_qtser;
	var vfa_gsnam = fa_gsnam;

	ds_header.ClearData();
	ds_header.AddRow();
	ds_header.SetColumn(0, "MANDT", G_MANDT);

	//tab.main.div_header.cb_qtgbn.Index = 0; // 2013.02.05 견적구분 - 실행가 기본 선택, 2021.04.23 견적상세 조회 시 실행가만 조회되는 문제로 주석처리
		
	http.sync = true;

	nsfRequest("queryClass", "ses0031/searchClass", "ds_class=ds_class", "ds_class=ds_class ds_error=ds_error", "", "fn_afterQuery");

	if (fa_sonnr != null) {
		ds_header.SetColumn(0, "SONNR", fa_sonnr);
		nsfRequest("querySo", "ses0032/search", "ds_cond=ds_header ds_list=ds_header", "ds_header=ds_list ds_error=ds_error", "", "fn_afterQuery");
	} else {
		
		ds_header.SetColumn(0, "QTNUM", fa_qtnum);
		ds_header.SetColumn(0, "QTSER", fa_qtser);
		nsfRequest("queryHeader", "ses0030/header", "ds_cond=ds_header ds_header=ds_header", "ds_header=ds_header ds_error=ds_error", "", "fn_afterQuery");
	}

	http.sync = false;

	var obj = tab.main.div_header;

	zkunnr   = ds_header.Getcolumn(0, "ZKUNNR"   );
	zkunnrNm = ds_header.Getcolumn(0, "ZKUNNR_NM");

	obj.div_kunnr.ed_buyr_cd.Text = ds_header.GetColumn(0, "KUNNR");
	obj.div_kunnr.ed_buyr_cd.bindDataset = "ds_header";
	obj.div_kunnr.ed_buyr_cd.Column      = "KUNNR";

	var buyr_nm = ds_header.GetColumn(0, "BUYR_NM");
	
	if (buyr_nm == null) {
		buyr_nm = ds_header.GetColumn(0, "KUNNR_NM");
		ds_header.AddColumn("BUYR_NM", "STRING", 256);
		ds_header.SetColumn(0, "BUYR_NM", buyr_nm);
	}

	var qtdat  = ds_header.GetColumn(0, "QTDAT");
	var zyear  = Substr(qtdat,0,4);
	var zmonth = Substr(qtdat,4,2);

	// 2013.02.20 START 원가산출 기준 변경에 따라 제거 &&&&&
	// ds_exchange.ClearData();
	// ds_exchange.AddRow();
	// ds_exchange.SetColumn(0, "MANDT" , G_MANDT);
	// ds_exchange.SetColumn(0, "ZYEAR" , zyear  );
	// ds_exchange.SetColumn(0, "ZMONTH", zmonth );

	// 환율정보 조회
	// nsfRequest("queryExchange", "ses0031/searchExchange", "ds_exchange=ds_exchange", "ds_exchange=ds_exchange", "", "fn_afterQuery");
	// 2013.02.20 START 원가산출 기준 변경에 따라 제거 &&&&&

	obj.div_kunnr.ed_buyr_nm.Text = ds_header.GetColumn(0, "BUYR_NM");
	obj.div_kunnr.ed_buyr_nm.bindDataset = "ds_header";
	obj.div_kunnr.ed_buyr_nm.Column      = "BUYR_NM";

	obj.div_sman.ed_sman_cd.Text    = ds_header.Getcolumn(0, "ZKUNNR"   );
	obj.div_sman.ed_sman_nm.Text    = ds_header.Getcolumn(0, "ZKUNNR_NM");
	obj.div_sman.ed_sman_cd.Enable  = false;
	obj.div_sman.btn_popSman.Enable = false;
    trace("************99 flag : " + flag);
	if (flag == "I") 	{	// 신규건의 경우 2013.01.09 로직 수정
		cal_qtdat.Text = gfn_getCurrDate();
		obj.cb_zprgflg.Index = 0;
	}

	// 최종 변경된 셀정보 초기화
	F_CHG_DETAIL_COLNUM = ""; // 변경된 Detail 컬럼번호
	F_CHG_DETAIL_ROWNUM = ""; // 변경된 Detail 행번호

	F_MAX_SERNO  = 0;	             // 최종순번
	F_MAX_SERNO  = fn_getMaxSerno(); // 기 저장된 최종순번

	obj.div_kunnr.ed_buyr_cd.Width = 70;
	obj.div_kunnr.btn_popBuyr.Left = 71;
	obj.div_kunnr.ed_buyr_nm.Left  = 90;
	obj.div_kunnr.ed_buyr_nm.Width = 79;

	obj.div_kunnr.ed_buyr_cd.Enable  = false;
	obj.div_kunnr.ed_buyr_nm.Enable  = false;

	var zdeli = ds_header.GetColumn(0, "ZDELI");

	switch (zdeli) {
		case "X" : obj.div_kunnr.btn_popBuyr.Enable = true ; obj.ed_zdeli.Text = "단납기"; break;
		default  : obj.div_kunnr.btn_popBuyr.Enable = false; break;
	}

	var atinn = "";

	switch (G_MANDT) {
		case "183" : atinn = "0000000006"; break;
		default    : atinn = "0000000005"; break;
	}

	ds_acapa.ClearData();
	ds_acapa.AddRow();
	ds_acapa.SetColumn(0, "MANDT", G_MANDT);
	ds_acapa.SetColumn(0, "ATINN", atinn  );
	ds_acapa.SetColumn(0, "SPRAS", "3"    );
	nsfRequest("queryAcapa", "ses0031/searchAcapa", "ds_acapa=ds_acapa", "ds_acapa=ds_acapa", "", "fn_afterQuery");

	//광역 운송지역 sync 처리 2013.01.10
	http.sync = true;
	
	ds_cond_atnam.ClearData();
	ds_cond_atnam.AddRow();
	ds_cond_atnam.SetColumn(0, "MANDT" , G_MANDT   );
	ds_cond_atnam.SetColumn(0, "KLART" , "300"     );
	ds_cond_atnam.SetColumn(0, "CLASS1", "ELV_01"  );
	ds_cond_atnam.SetColumn(0, "ATKLA" , "EL_BASIC");
	ds_cond_atnam.SetColumn(0, "ATNAM" , "EL_ALOCT");
	ds_cond_atnam.SetColumn(0, "WHERE" , ""        );
	nsfRequest("queryZregn1", "com0150/find", "ds_cond_atnam=ds_cond_atnam ds_list_atnam=ds_zregn2", "ds_zregn2=ds_list_atnam", "", "fn_afterQuery");

	ds_cond_atnam.SetColumn(0, "ATNAM" , "EL_ADTA");
	nsfRequest("queryZregn2", "com0150/find", "ds_cond_atnam=ds_cond_atnam ds_list_atnam=ds_zregn3", "ds_zregn3=ds_list_atnam", "", "fn_afterQuery");

    ds_zregn3.sort("ATWTB");  // 운송지역 가나다 순 SORT 20130430 김선호
	http.sync = false;

	tab.template.div_template.cb_block.Index = 0;
	
}

//=========================================================================================
// [ PART 3 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,form닫기)
//=========================================================================================
/********************************************************************************
* 기      능   : 조회 1
********************************************************************************/
function fn_query() {
	ds_error.ClearData();

	nsfRequest("queryHeader", "ses0030/header", "ds_cond=ds_cond ds_header=ds_header", "ds_header=ds_header ds_error=ds_error", "", "fn_afterQuery");
    
    // 2014.01.08 임시 납기일 check - 김광우 과장 원가function 수정전까지	
	if ( substr(gfn_getCurrDate(),0,4) < substr(ds_header.getcolumn(0, "DELDAT"),0, 4))
	{
		gfn_showAlert("CW10025", "납기예정일이 전년도입니다 변경바랍니다.");
	}
}

/********************************************************************************
* 기      능   : 저장
********************************************************************************/
function fn_save() {

	var vT1000Cnt = 0;
	var lv_Y200Cnt = 0;
	var lv_Y300Cnt = 0;
	var lv_Y400Cnt = 0;
	var lv_Y500Cnt = 0;

	var lv_Message = "";
	var lv_Gtype = "";
	
//trace("!!" + ds_detail.savexml());
	ds_error.ClearData();

	if (zprgflg > "61") {            //입찰상태까지 당년에 한해 납기예정일 변경 및 저장 가능 2013.05.16
		gfn_showAlert("CW10057");
		return; // 입찰 이후의 진행 상태에서는 저장할 수 없습니다.
	}

	if (!fn_save_header())	{
		return;
	}
	
//-----< 2016.11.09 공통추가 개수 제한 계약관리부(홍수봉DR) 요청 by mj.Shin 	Start 
    // 감시반은 1개만 등록 가능
	// var vT1000Cnt = 0;
	// for (var i = 0; i < ds_detail.GetRowCount(); i++)	{
		// if (ds_detail.GetColumn(i, "MATNR") == "T-1000" && 
			// ds_detail.GetColumn(i, "FLAG") != "D" )	{
			// vT1000Cnt++;
		// }
	// }
	
	// if(vT1000Cnt > 1)	{
		// gfn_showAlert("CW10025", "MO에 감시반은 1개만 존재해야 합니다.");
		// return;
	// }
	// 감시반 및 공통(S/P 제외)은 1개만 등록 가능 
	for (var i = 0; i < ds_detail.GetRowCount(); i++)	{ 
		if (ds_detail.GetColumn(i, "FLAG") != "D") {
		  switch ( ds_detail.GetColumn(i, "MATNR") ) {
		   case "T-1000" : vT1000Cnt++; lv_Gtype = ds_detail.GetColumn(i, "GTYPE"); break;
		   case "Y-200" : lv_Y200Cnt++; lv_Gtype = ds_detail.GetColumn(i, "GTYPE"); break;
		   case "Y-300" : lv_Y300Cnt++; lv_Gtype = ds_detail.GetColumn(i, "GTYPE");	break;
		   case "Y-400" : lv_Y400Cnt++; lv_Gtype = ds_detail.GetColumn(i, "GTYPE"); break;
		   case "Y-500" : lv_Y500Cnt++; lv_Gtype = ds_detail.GetColumn(i, "GTYPE"); break;
		   default : break;
		  }			
		}
	}
	
	lv_Message = "MO에 [" + lv_Gtype + "]은(는) 1개만 존재해야 합니다.  관리팀에 문의 하세요.";
	if(vT1000Cnt > 1 or lv_Y200Cnt > 1 or lv_Y300Cnt > 1 or lv_Y400Cnt > 1 or lv_Y500Cnt > 1) {	
		gfn_showAlert("CW10025", lv_Message);
		return;
	}
	
//-----> 2016.11.09 공통추가 개수 제한 계약관리부(홍수봉DR) 요청 by mj.Shin 	End 



	if (gfn_showConfirm("CI10003") == true) { // CI10003 저장하시겠습니까?

		fn_createWait("",this);     // 처리중입니다. 메시지 처리

		F_GRID_SELECT = "";		// 2013.01.09 저장 시 clear

		var obj = tab.main.div_header;

		ds_header.SetColumn(0, "FLAG"  , "I");
		ds_header.Setcolumn(0, "ZKUNNR", obj.div_sman.ed_sman_cd.Text);

		if (obj.ed_zdeli.Text == "단납기")
			ds_header.SetColumn(0, "ZDELI", "X");
		
		fn_save_template();
		
		// 2012.01.10 운송지역 오류 데이터 저장 확인용
		var strHeaderRegion = trim(ds_header.GetColumn(0, "REGION"));
		if ( strHeaderRegion != null && strHeaderRegion != "" ) {
			if ( length(strHeaderRegion) != 9 ) {
				fn_destroyWait();
				var err[2];
				err[0] = "헤더";
				err[1] = "운송지역";
				gfn_showAlert("CW00184", err); // [${}:${}]은(는) 오류 데이터가 포함되어있습니다. \n 담당자 문의 바랍니다.
				return;
			}
		}

		var outDatasets = "";
		if ( ed_qtnum.Text == "" ) { // 견적번호가 없으면, 신규 등록이므로 헤더정보를 받는다.
			outDatasets = "ds_header=ds_header ds_error=ds_error";
		} else {
			outDatasets = "ds_error=ds_error";
		}
		//trace(ds_header.savexml());
		nsfRequest("saveHeader", "ses0031/saveHeader", "ds_header=ds_header ds_detail=ds_detail ds_template=ds_template_save"
					, outDatasets, "", "fn_afterSave");
	} else {
		return;
	}
}


/********************************************************************************
* 기      능   : 액셀  
********************************************************************************/
function fn_excel() {
	//gfn_exportExcel(tab.main.div_header.grd_detail, "견적MO상세");

	var t = tab.main.div_header;

	// 2013.04.19 출력으로 변경
	if (length(trim(ds_header.GetColumn(0, "QTNUM"))) == 0)		{
		gfn_showAlert("CW10062");
		return;
	}

	fn_createWait("",this);     // 처리중입니다. 메시지 처리

	ds_print_header.ClearData();
	ds_print_detail.ClearData();
	
	ds_print_header.Copy("ds_header");
	ds_print_detail.Copy("ds_detail");

	// 명칭 표시Data 치환처리
	ds_print_header.SetColumn(0, "QTGBN", t.cb_qtgbn.Text);		// 견적구분
	ds_print_header.SetColumn(0, "ZPRGFLG", t.cb_zprgflg.Text);	// 견적진행상태
	
	ds_print_header.AddColumn("SPART_NM", "STRING", 255);
	ds_print_header.SetColumn(0, "SPART_NM", t.cb_spart.Text);	// 제품군

	ds_print_header.SetColumn(0, "VKBUR",  t.cb_vkbur.Text);		// 부서명칭
	ds_print_header.SetColumn(0, "VKGRP",  t.cb_vkgrp.Text);		// 팀명칭
	ds_print_header.SetColumn(0, "KUNNR_NM", t.div_kunnr.ed_buyr_nm.Text);		// 고객명
	ds_print_header.SetColumn(0, "ZBDTYP", t.cb_zbdtyp.Text);		// 건물용도
	ds_print_header.SetColumn(0, "ZDELI",  t.ed_zdeli.Text);		// 단납기구분
	//ds_print_header.SetColumn(0, "ZREGN",  t.cb_zregn1.Text);		// 지역
	//ds_print_header.SetColumn(0, "ZLZONE", t.cb_zregn2.Text);		// 광역
	//ds_print_header.SetColumn(0, "REGION", t.cb_zregn3.Text);		// 운송지역
	ds_print_header.SetColumn(0, "FA_BYRGBN", t.cb_fa_byrgbn.Text);	// 업종구분

	fn_destroyWait();

	Dialog("SES::Ses0371.xml", "", -1, -1, "Resize=true");	// UbiReport Call
}


/********************************************************************************
* 기      능   : 닫기  
********************************************************************************/
function fn_close() {
	if (gfn_showConfirm("CW10025", "저장하지 않은 DATA는 손실됩니다. 견적상세화면 종료하시겠습니까?") == true) {
	    close();	    
	}else { 
	  return; 
	}
	
}

/********************************************************************************
* 기      능   : 출력
********************************************************************************/
function fn_print() {

	var zprgflg = ds_header.GetColumn(0, "ZPRGFLG");
	var vkbur   = ds_header.GetColumn(0, "VKBUR"  ); // 사업장
	var zeam;
	var h          = tab.main.div_header;
	var matnr      = "";
	var detailFlag = "";
	var nullCnt    = 0;

	for (var i=0; i<ds_detail.GetRowCount(); i++) {

		zeam       = ds_detail.GetColumn(i, "ZEAM" );
		matnr      = ds_detail.GetColumn(i, "MATNR");
		detailFlag = ds_detail.GetColumn(i, "FLAG" );

		if (matnr != "T-1000" && matnr != "Y-1000") {

			if ( zeam=="" || zeam==null || Round(zeam, 0) ==0) {
				nullCnt++;
			}
		}

		if (detailFlag!="" && detailFlag!=null) {
			gfn_showAlert("CW10084", ToString(i+1)); h.grd_detail.SetFocus(); return false; // CW10084 {}행의 자료가 저장되지 않았습니다.
		}
	}

	if (nullCnt > 0)	{
		gfn_showAlert("CW10085"); // CW10085 견적가를 확인하세요.
		return;
	}

	var spart = ds_header.GetColumn(0, "SPART");
	//if ( spart == "20" || spart == "30" || spart == "40" ) // 비승강기
	/*if ( spart == "30" || spart == "40" ) // 비승강기 : 주차 제외
	{
		if ( zprgflg == "20" || zprgflg == "21" ) { // 견적작성
			if (gfn_showConfirm("CI10007") == true) { // CI10005 진행상태를 입찰로 변경하시겠습니까?
				ds_header.SetColumn(0, "ZPRGFLG", "50"); // 50 입찰
				nsfRequest("saveHeaderFlag", "ses0031/updateHeaderFlag", "ds_header=ds_header", "ds_header=ds_header ds_error=ds_error", "", "fn_afterSave");
				fn_zprgflg();
			}
		}
	} else {*/
	
		if (zprgflg == "32" || zprgflg == "33" || zprgflg == "42") { // 32원가산출 33원가산출승인 42 원가팀완료
	
			if (gfn_showConfirm("CI10007") == true) { // CI10005 진행상태를 입찰로 변경하시겠습니까?
	
				ds_header.SetColumn(0, "ZPRGFLG", "50"); // 50 입찰
				nsfRequest("saveHeaderFlag", "ses0031/updateHeaderFlag", "ds_header=ds_header", "ds_header=ds_header ds_error=ds_error", "", "fn_afterSave");
				fn_zprgflg();
			}
		}
	//}
	
	fn_createWait("",this);     // 처리중입니다. 메시지 처리

	var gnm      = tab.main.div_header.div_kunnr.ed_buyr_nm.Text;
	var qtdat    = ds_header.GetColumn(0, "QTDAT");
		qtdat    = Substr(qtdat,0,4)+"년 "+Substr(qtdat,4,2)+"월 "+Substr(qtdat,6,2)+"일";
	var gam      = ds_header.GetColumn(0, "ZEAM") + " 원정";
	var mno      = ds_header.GetColumn(0, "QTNUM") + "-" + ds_header.GetColumn(0, "QTSER");
	var spart    = ds_header.GetColumn(0, "SPART"); // 제품군
	var gtype    = "";	
	var znumber  = 0; // 대수
	var zuam     = 0; // 단가
	var zeam     = 0; // 견적가
	var zeam_sp  = 0; // sp 견적가
	var zeam_sum = 0; // 견적가 합계
	var rate     = 0; // 비율

	ds_list1.ClearData();
	ds_list1.AddRow();
	ds_list1.SetColumn(0, "GNM", gnm                                  ); // 고객번호의 거래처명
	ds_list1.SetColumn(0, "SPT", ds_header.GetColumn(0, "GSNAM"      )); // 공사명

	ds_list1.SetColumn(0, "GAM", gam                                  ); // 금액
	ds_list1.SetColumn(0, "CDT", qtdat                                ); // 견적일자
	ds_list1.SetColumn(0, "COM", "서울사무소"                         ); // 회사
	ds_list1.SetColumn(0, "AD1", "서울시 종로구 연지동 1-7번지"       ); // 주소1
	ds_list1.SetColumn(0, "AD2", "현대그룹빌딩 동관 8~9층"            ); // 주소2
	ds_list1.SetColumn(0, "TEL", ds_header.GetColumn(0, "TEL"	     )); // 전화번호
	ds_list1.SetColumn(0, "FAX", ds_header.GetColumn(0, "FAX"	     )); // FAX
	ds_list1.SetColumn(0, "CEL", ds_header.GetColumn(0, "CEL"	     )); // CEL
	ds_list1.SetColumn(0, "NAM", ds_header.GetColumn(0, "ZKUNNR_NM"	 )); // 영업담당자
	ds_list1.SetColumn(0, "T01", ds_header.GetColumn(0, "SPRMK1"     )); // 특기사항1
	ds_list1.SetColumn(0, "T02", ds_header.GetColumn(0, "SPRMK2"     )); // 특기사항2
	ds_list1.SetColumn(0, "T03", ds_header.GetColumn(0, "SPRMK3"     )); // 특기사항3
	ds_list1.SetColumn(0, "T04", ds_header.GetColumn(0, "SPRMK4"     )); // 특기사항4
	ds_list1.SetColumn(0, "T05", ds_header.GetColumn(0, "SPRMK5"     )); // 특기사항5
	ds_list1.SetColumn(0, "T06", ds_header.GetColumn(0, "SPRMK6"     )); // 특기사항6
	ds_list1.SetColumn(0, "T07", ds_header.GetColumn(0, "SPRMK7"     )); // 특기사항7
	ds_list1.SetColumn(0, "T08", ds_header.GetColumn(0, "SPRMK8"     )); // 특기사항8
	ds_list1.SetColumn(0, "T09", ds_header.GetColumn(0, "SPRMK9"     )); // 특기사항9
	ds_list1.SetColumn(0, "T10", ds_header.GetColumn(0, "SPRMK10"    )); // 특기사항10
	ds_list1.SetColumn(0, "PID", ds_header.GetColumn(0, "ZPID"       )); // 현장담당자
	ds_list1.SetColumn(0, "P01", ds_header.GetColumn(0, "ZICIF_PPRT" )); // 계약보증금율
	ds_list1.SetColumn(0, "P02", ds_header.GetColumn(0, "ZICIF_1STRT")); // 1차중도금율
	ds_list1.SetColumn(0, "P03", ds_header.GetColumn(0, "ZICIF_2STRT")); // 2차중도금율
	ds_list1.SetColumn(0, "P04", ds_header.GetColumn(0, "ZICIF_RMRT" )); // 잔금율
	ds_list1.SetColumn(0, "C01", ds_header.GetColumn(0, "ZICIF_PPCT" )); // 계약보증금내용
	ds_list1.SetColumn(0, "C02", ds_header.GetColumn(0, "ZICIF_1STCT")); // 1차중도금내용
	ds_list1.SetColumn(0, "C03", ds_header.GetColumn(0, "ZICIF_2STCT")); // 2차중도금내용
	ds_list1.SetColumn(0, "C04", ds_header.GetColumn(0, "ZICIF_RMCT" )); // 잔금내용
	ds_list1.SetColumn(0, "MNO", mno                                  ); // 견적번호+차수
	ds_list1.SetColumn(0, "MON", ds_header.GetColumn(0, "ZDVMTS"     )); // 납기개월수
	ds_list1.SetColumn(0, "SPART", spart); // 제품군 (2012.12.10)
	ds_list1.SetColumn(0, "WAERK", "\\"); // 제품군 (2012.12.20)
	ds_list1.SetColumn(0, "MAIL", ds_header.GetColumn(0, "MAIL"	     )); // EMAIL
	ds_list1.SetColumn(0, "D01", ds_header.GetColumn(0, "ZICIF_PPCD" )); // 계약보증금조건
	ds_list1.SetColumn(0, "D02", ds_header.GetColumn(0, "ZICIF_1STCD")); // 1차중도금조건
	ds_list1.SetColumn(0, "D03", ds_header.GetColumn(0, "ZICIF_2STCD")); // 2차중도금조건
	ds_list1.SetColumn(0, "D04", ds_header.GetColumn(0, "ZICIF_RMCD" )); // 잔금조건

	//2017.09.07 견적서 출력 문구 변경(대리점) 추가 by mj.Shin 
	var lv_vkbur = ds_header.GetColumn(0, "VKBUR");
	var lv_agntp = "";
	if ( lv_vkbur == "B400" || lv_vkbur == "BC00" || lv_vkbur == "BI00") { 
		lv_agntp = "Y";
	} else {
		lv_agntp = "N";
	}
	ds_list1.SetColumn(0, "AGNTP", lv_agntp);
	
	ds_detail.UnFilter();
	ds_detail.Filter("GTYPE ==" + quote("SP"));
	zeam_sp = ds_detail.Sum("ZEAM");

	ds_detail.UnFilter();
	ds_detail.Filter("GTYPE !=" + quote("SP"));
	zeam_sum = ds_detail.Sum("ZEAM");

	var rowCnt = ds_detail.GetRowCount();

	ds_list2.ClearData();
	ds_list2.AddRow();
	//ds_list2.SetColumn(0, "QTY", ds_detail.Sum("ZNUMBER"));
	
	//감시반,SP 제외 (2012.12.17)
	var tot_znumber = toNumber(ds_detail.TotalCaseSum("MATNR!='T-1000'&&MATNR!='Y-1000'","ZNUMBER"));
	ds_list2.SetColumn(0, "QTY", tot_znumber);
	ds_list2.SetColumn(0, "WAERK", "\\");
 
	var spec_nm;
	var zprdgbn;
	var matnr;

	// 사양정보 처리 2012.12.31
	var vkbur = ds_header.GetColumn(0, "VKBUR");
	var type1;
	var type2;
	var type3;
	var zcapa;
	var zuse;
	var zopen;
	var zlen;
	//trace("ds_detail => " + ds_detail.savexml());
	//trace("ds_qtgbn => " + ds_qtgbn.savexml());
	if (rowCnt >= 1) {
	    zprdgbn = substr(ds_detail.GetColumn(0, "ZPRDGBN"), 0, 2);
		gtype   = ds_detail.GetColumn(0, "GTYPE"  );  
		//spec_nm = ds_detail.GetColumn(0, "ZUSE") + ds_detail.GetColumn(0, "TYPE1") + "-" 
		//         +ds_detail.GetColumn(0, "ZLEN") + "-" + decode(zprdgbn, "MW", ds_detail.GetColumn(0, "ZOPN"), ds_detail.GetColumn(0, "TYPE3"));
		matnr = ds_detail.GetColumn(0, "MATNR");
		//if (spart=="20") spec_nm = ds_detail.GetColumn(0, "TYPE1") + ds_detail.GetColumn(0, "ZUSE") + "-" + ds_detail.GetColumn(0, "TYPE2") + "-" + ds_detail.GetColumn(0, "TYPE3") + "("+ ds_detail.GetColumn(0, "ZACAPA") + ")"; //"모델명""승입방향"-"단수"-"파렛트수"("수용차종") - (2012.12.10)
		//if (spart=="40") spec_nm = ds_detail.GetColumn(0, "TYPE1"); // PSD - 역명만 표시 (2012.12.12)
		//if (spart=="30") spec_nm = ds_header.GetColumn(0, "GSNAM"); // 물류 - 공사명만 표시 => 1행만 표시 (2012.12.12)

		// 사양정보 처리 2012.12.31
		type1 = ds_detail.GetColumn(0, "TYPE1");
		type2 = ds_detail.GetColumn(0, "TYPE2");
		type3 = ds_detail.GetColumn(0, "TYPE3");
		zcapa = ds_detail.GetColumn(0, "ZACAPA");
		zuse  = ds_detail.GetColumn(0, "ZUSE");
		zopen = ds_detail.GetColumn(0, "ZOPN");
		zlen  = ds_detail.GetColumn(0, "ZLEN");
		
		
		//NEW 견적양식 2013.06.24
		if ( substr ( ds_detail.GetColumn(0,"MATNR"),0,1 ) == "S" ||
		     substr ( ds_detail.GetColumn(0,"MATNR"),0,1 ) == "W" ) {
				ds_list2.SetColumn(0, "TYPE2_01", ds_detail.GetColumn(0, "ZLEN"));
				ds_list2.SetColumn(0, "ZOPN_01", ds_detail.GetColumn(0, "TYPE2"));
				ds_list2.SetColumn(0, "ZLEN_01", ds_detail.GetColumn(0, ""));	     			
		} else {
			ds_list2.SetColumn(0, "TYPE2_01", ds_detail.GetColumn(0, "TYPE2"));			
			ds_list2.SetColumn(0, "ZOPN_01", ds_detail.GetColumn(0, "ZOPN"));
			ds_list2.SetColumn(0, "ZLEN_01", ds_detail.GetColumn(0, "ZLEN"));
		}
		ds_list2.SetColumn(0, "TYPE1_01", ds_detail.GetColumn(0, "TYPE1"));
		ds_list2.SetColumn(0, "TYPE3_01", ds_detail.GetColumn(0, "TYPE3"));
		if ( substr ( ds_detail.GetColumn(0,"MATNR"),0,1 ) == "L" ||
		     substr ( ds_detail.GetColumn(0,"MATNR"),0,1 ) == "S" ||
		     substr ( ds_detail.GetColumn(0,"MATNR"),0,1 ) == "W" ) {
			    ds_list2.SetColumn(0, "EA_01", "대");			     			
		} else {	
			    ds_list2.SetColumn(0, "EA_01", "식");
		}
		
		spec_nm = gfn_specInfo(vkbur, matnr, "", type1, type2, type3, zcapa, zuse, zopen, zlen);
        ds_list2.SetColumn(0, "SPC_01", spec_nm);
		znumber = decode(matnr, "T-1000", "0", ds_detail.GetColumn(0, "ZNUMBER"));  ds_list2.SetColumn(0, "QTY_01", znumber);
		zuam    = ds_detail.GetColumn(0, "ZUAM"   );  ds_list2
		.SetColumn(0, "RNO_01", "1"    );
		zeam    = ds_detail.GetColumn(0, "ZEAM"   );  ds_list2.SetColumn(0, "USE_01", gtype  );		
		//rate    = ParseInt(zeam) / ParseInt(zeam_sum);
		//zeam    = ParseInt(zeam) + Round(ParseInt(zeam_sp) * rate, 0); ds_list2.SetColumn(0, "GAM_01", zeam); // 견적가
		//zuam    = ParseInt(zeam) / ParseInt(znumber); ds_list2.SetColumn(0, "AMT_01", decode(spart, "30", 0, zuam)); // 단가
		
		rate    = toNumber(zeam) / toNumber(zeam_sum);
		zeam    = toNumber(zeam) + Round(toNumber(zeam_sp) * rate, 0); ds_list2.SetColumn(0, "GAM_01", zeam); // 견적가
		zuam    = toNumber(zeam) / toNumber(znumber); ds_list2.SetColumn(0, "AMT_01", decode(spart, "30", 0, zuam)); // 단가
		
		//주차 용도명 
		//trace("zprdgbn=>" + ZPRDGBN );
		var cidx ;
		if ( ZPRDGBN == "AP" ) {
		  switch ( ds_detail.GetColumn(0, "GTYPE") ) {
		   case "2PZ" : cidx = 0; break;
		   case "MPZ" : cidx = 1; break; 
		   case "MFC" : cidx = 2; break;
		   case "VRC" : cidx = 3; break;
		   case "HRC" : cidx = 4; break;
		   case "ELV" : cidx = 5; break;
		   case "STC" : cidx = 6; break;
		   case "CRT" : cidx = 7; break;
		   case "BPS" : cidx = 8; break;
		   case "LFC" : cidx = 9; break;
		   default : break;
		  }
		  //trace("cidx=>" + cidx);
		  zuse_nm = ds_jtype.GetColumn(cidx, "CODE_NAME"); ds_list2.SetColumn(0, "UNM_01", zuse_nm); // 용도명
		} 
		else { 
		  zuse_nm = ds_detail.GetColumn(0, "ZUSE_NM");
		  if ( ds_detail.GetColumn(0, "MATNR") == "T-1000" ) {  
			ds_list2.SetColumn(0, "UNM_01", gtype); // 감시반 일때 용도명 = 기종  
		  } else if  ( ds_detail.GetColumn(0, "MATNR") == "S-1000" ) {
			ds_list2.SetColumn(0, "UNM_01", "에스컬레이터"); //
		  } else if  ( ds_detail.GetColumn(0, "MATNR") == "W-1000" ) {
			ds_list2.SetColumn(0, "UNM_01", "무빙워크"); //
		  } else {
			ds_list2.SetColumn(0, "UNM_01", zuse_nm); //용도명  
		  }
		}
	}
	if (rowCnt >= 2) {
		zprdgbn = substr(ds_detail.GetColumn(1, "ZPRDGBN"), 0, 2);
		gtype   = ds_detail.GetColumn(1, "GTYPE"  );  
		//spec_nm = ds_detail.GetColumn(1, "ZUSE") + ds_detail.GetColumn(1, "TYPE1") + "-" 
		//        +ds_detail.GetColumn(1, "ZLEN") + "-" + decode(zprdgbn, "MW", ds_detail.GetColumn(1, "ZOPN"), ds_detail.GetColumn(1, "TYPE3"));
		matnr = ds_detail.GetColumn(1, "MATNR");
		//if (spart=="20") spec_nm = ds_detail.GetColumn(1, "TYPE1") + ds_detail.GetColumn(1, "ZUSE") + "-" + ds_detail.GetColumn(1, "TYPE2") + "-" + ds_detail.GetColumn(1, "TYPE3") + "("+ ds_detail.GetColumn(1, "ZACAPA") + ")"; //"모델명""승입방향"-"단수"-"파렛트수"("수용차종") - (2012.12.10)
		//if (spart=="40") spec_nm = ds_detail.GetColumn(1, "TYPE1"); // PSD - 역명만 표시 (2012.12.12)

		// 사양정보 처리 2012.12.31
		type1 = ds_detail.GetColumn(1, "TYPE1");
		type2 = ds_detail.GetColumn(1, "TYPE2");
		type3 = ds_detail.GetColumn(1, "TYPE3");
		zcapa = ds_detail.GetColumn(1, "ZACAPA");
		zuse  = ds_detail.GetColumn(1, "ZUSE");
		zopen = ds_detail.GetColumn(1, "ZOPN");
		zlen  = ds_detail.GetColumn(1, "ZLEN");
		
		//NEW 견적양식 
		if ( substr ( ds_detail.GetColumn(1,"MATNR"),0,1 ) == "S" ||
		     substr ( ds_detail.GetColumn(1,"MATNR"),0,1 ) == "W" ) {
				ds_list2.SetColumn(0, "TYPE2_02", ds_detail.GetColumn(1, "ZLEN"));
				ds_list2.SetColumn(0, "ZOPN_02", ds_detail.GetColumn(1, "TYPE2"));
				ds_list2.SetColumn(0, "ZLEN_02", ds_detail.GetColumn(1, ""));	     			
		} else {
			ds_list2.SetColumn(0, "TYPE2_02", ds_detail.GetColumn(1, "TYPE2"));			
			ds_list2.SetColumn(0, "ZOPN_02", ds_detail.GetColumn(1, "ZOPN"));
			ds_list2.SetColumn(0, "ZLEN_02", ds_detail.GetColumn(1, "ZLEN"));
		}
		ds_list2.SetColumn(0, "TYPE1_02", ds_detail.GetColumn(1, "TYPE1"));
		ds_list2.SetColumn(0, "TYPE3_02", ds_detail.GetColumn(1, "TYPE3"));
		if ( substr ( ds_detail.GetColumn(1,"MATNR"),0,1 ) == "L" ||
		     substr ( ds_detail.GetColumn(1,"MATNR"),0,1 ) == "S" ||
		     substr ( ds_detail.GetColumn(1,"MATNR"),0,1 ) == "W" ) {
			    ds_list2.SetColumn(0, "EA_02", "대"); 			
		} else {	
			    ds_list2.SetColumn(0, "EA_02", "식");
		}
		
		spec_nm = gfn_specInfo(vkbur, matnr, "", type1, type2, type3, zcapa, zuse, zopen, zlen);
		ds_list2.SetColumn(0, "SPC_02", spec_nm);
		
		znumber = decode(matnr, "T-1000", "0", ds_detail.GetColumn(1, "ZNUMBER"));  ds_list2.SetColumn(0, "QTY_02", znumber);
		zuam    = ds_detail.GetColumn(1, "ZUAM"   );  ds_list2.SetColumn(0, "RNO_02", "2"    );
		zeam    = ds_detail.GetColumn(1, "ZEAM"   );  ds_list2.SetColumn(0, "USE_02", gtype  );
		//rate    = ParseInt(zeam) / ParseInt(zeam_sum);
		//zeam    = ParseInt(zeam) + Round(ParseInt(zeam_sp) * rate, 0); ds_list2.SetColumn(0, "GAM_02", zeam); // 견적가
		//zuam    = ParseInt(zeam) / ParseInt(znumber); ds_list2.SetColumn(0, "AMT_02", zuam   ); // 단가
		rate    = toNumber(zeam) / toNumber(zeam_sum);
		zeam    = toNumber(zeam) + Round(toNumber(zeam_sp) * rate, 0); ds_list2.SetColumn(0, "GAM_02", zeam); // 견적가
		zuam    = toNumber(zeam) / toNumber(znumber); ds_list2.SetColumn(0, "AMT_02", zuam   ); // 단가
		//zuse_nm = ds_detail.GetColumn(1, "ZUSE_NM");  ds_list2.SetColumn(0, "UNM_02", zuse_nm); // 용도명
	    //주차 용도명 
		//trace("zprdgbn=>" + ZPRDGBN );
		var cidx ;
		if ( ZPRDGBN == "AP" ) {
		  switch ( ds_detail.GetColumn(1, "GTYPE") ) {
		   case "2PZ" : cidx = 0; break;
		   case "MPZ" : cidx = 1; break; 
		   case "MFC" : cidx = 2; break;
		   case "VRC" : cidx = 3; break;
		   case "HRC" : cidx = 4; break;
		   case "ELV" : cidx = 5; break;
		   case "STC" : cidx = 6; break;
		   case "CRT" : cidx = 7; break;
		   case "BPS" : cidx = 8; break;
		   case "LFC" : cidx = 9; break;
		   default : break;
		  }
		  //trace("cidx=>" + cidx);
		  zuse_nm = ds_jtype.GetColumn(cidx, "CODE_NAME"); ds_list2.SetColumn(0, "UNM_02", zuse_nm); // 용도명
		} 
		else { 
		  zuse_nm = ds_detail.GetColumn(1, "ZUSE_NM");  
		  if ( ds_detail.GetColumn(1, "MATNR") == "T-1000" ) {  
			ds_list2.SetColumn(0, "UNM_02", gtype); // 감시반 일때 용도명 = 기종  
		  } else if  ( ds_detail.GetColumn(1, "MATNR") == "S-1000" ) {
			ds_list2.SetColumn(0, "UNM_02", "에스컬레이터"); //
		  } else if  ( ds_detail.GetColumn(1, "MATNR") == "W-1000" ) {
			ds_list2.SetColumn(0, "UNM_02", "무빙워크"); //
		  } else {
			ds_list2.SetColumn(0, "UNM_02", zuse_nm); //용도명  
		  }
		}
	}
	if (rowCnt >= 3) {
		zprdgbn = substr(ds_detail.GetColumn(2, "ZPRDGBN"), 0, 2);
		gtype   = ds_detail.GetColumn(2, "GTYPE"  );  
		//spec_nm = ds_detail.GetColumn(2, "ZUSE") + ds_detail.GetColumn(2, "TYPE1") + "-" 
		//         +ds_detail.GetColumn(2, "ZLEN") + "-" + decode(zprdgbn, "MW", ds_detail.GetColumn(2, "ZOPN"), ds_detail.GetColumn(2, "TYPE3"));
		matnr = ds_detail.GetColumn(2, "MATNR");
		//if (spart=="20") spec_nm = ds_detail.GetColumn(2, "TYPE1") + ds_detail.GetColumn(2, "ZUSE") + "-" + ds_detail.GetColumn(2, "TYPE2") + "-" + ds_detail.GetColumn(2, "TYPE3") + "("+ ds_detail.GetColumn(2, "ZACAPA") + ")"; //"모델명""승입방향"-"단수"-"파렛트수"("수용차종") - (2012.12.10)
		//if (spart=="40") spec_nm = ds_detail.GetColumn(2, "TYPE1"); // PSD - 역명만 표시 (2012.12.12)

		// 사양정보 처리 2012.12.31
		type1 = ds_detail.GetColumn(2, "TYPE1");
		type2 = ds_detail.GetColumn(2, "TYPE2");
		type3 = ds_detail.GetColumn(2, "TYPE3");
		zcapa = ds_detail.GetColumn(2, "ZACAPA");
		zuse  = ds_detail.GetColumn(2, "ZUSE");
		zopen = ds_detail.GetColumn(2, "ZOPN");
		zlen  = ds_detail.GetColumn(2, "ZLEN");
		
		//NEW 견적양식 
		if ( substr ( ds_detail.GetColumn(2,"MATNR"),0,1 ) == "S" ||
		     substr ( ds_detail.GetColumn(2,"MATNR"),0,1 ) == "W" ) {
				ds_list2.SetColumn(0, "TYPE2_03", ds_detail.GetColumn(2, "ZLEN"));
				ds_list2.SetColumn(0, "ZOPN_03", ds_detail.GetColumn(2, "TYPE2"));
				ds_list2.SetColumn(0, "ZLEN_03", ds_detail.GetColumn(2, ""));	     			
		} else {
			ds_list2.SetColumn(0, "TYPE2_03", ds_detail.GetColumn(2, "TYPE2"));			
			ds_list2.SetColumn(0, "ZOPN_03", ds_detail.GetColumn(2, "ZOPN"));
			ds_list2.SetColumn(0, "ZLEN_03", ds_detail.GetColumn(2, "ZLEN"));
		}
		ds_list2.SetColumn(0, "TYPE1_03", ds_detail.GetColumn(2, "TYPE1"));
		ds_list2.SetColumn(0, "TYPE3_03", ds_detail.GetColumn(2, "TYPE3"));
		if ( substr ( ds_detail.GetColumn(2,"MATNR"),0,1 ) == "L" ||
		     substr ( ds_detail.GetColumn(2,"MATNR"),0,1 ) == "S" ||
		     substr ( ds_detail.GetColumn(2,"MATNR"),0,1 ) == "W" ) {
			    ds_list2.SetColumn(0, "EA_03", "대"); 			
		} else {	
			    ds_list2.SetColumn(0, "EA_03", "식");
		}
		
		spec_nm = gfn_specInfo(vkbur, matnr, "", type1, type2, type3, zcapa, zuse, zopen, zlen);

		ds_list2.SetColumn(0, "SPC_03", spec_nm);
		znumber = decode(matnr, "T-1000", "0", ds_detail.GetColumn(2, "ZNUMBER"));  ds_list2.SetColumn(0, "QTY_03", znumber);
		zuam    = ds_detail.GetColumn(2, "ZUAM"   );  ds_list2.SetColumn(0, "RNO_03", "3"    );
		zeam    = ds_detail.GetColumn(2, "ZEAM"   );  ds_list2.SetColumn(0, "USE_03", gtype  );
		//rate    = ParseInt(zeam) / ParseInt(zeam_sum);
		//zeam    = ParseInt(zeam) + Round(ParseInt(zeam_sp) * rate, 0); ds_list2.SetColumn(0, "GAM_03", zeam); // 견적가
		//zuam    = ParseInt(zeam) / ParseInt(znumber); ds_list2.SetColumn(0, "AMT_03", zuam   ); // 단가
		rate    = toNumber(zeam) / toNumber(zeam_sum);
		zeam    = toNumber(zeam) + Round(toNumber(zeam_sp) * rate, 0); ds_list2.SetColumn(0, "GAM_03", zeam); // 견적가
		zuam    = toNumber(zeam) / toNumber(znumber); ds_list2.SetColumn(0, "AMT_03", zuam   ); // 단가
		//zuse_nm = ds_detail.GetColumn(2, "ZUSE_NM");  ds_list2.SetColumn(0, "UNM_03", zuse_nm); // 용도명
		//주차 용도명 
		//trace("zprdgbn=>" + ZPRDGBN );
		var cidx ;
		if ( ZPRDGBN == "AP" ) {
		  switch ( ds_detail.GetColumn(2, "GTYPE") ) {
		   case "2PZ" : cidx = 0; break;
		   case "MPZ" : cidx = 1; break; 
		   case "MFC" : cidx = 2; break;
		   case "VRC" : cidx = 3; break;
		   case "HRC" : cidx = 4; break;
		   case "ELV" : cidx = 5; break;
		   case "STC" : cidx = 6; break;
		   case "CRT" : cidx = 7; break;
		   case "BPS" : cidx = 8; break;
		   case "LFC" : cidx = 9; break;
		   default : break;
		  }
		  //trace("cidx=>" + cidx);
		  zuse_nm = ds_jtype.GetColumn(cidx, "CODE_NAME"); ds_list2.SetColumn(0, "UNM_03", zuse_nm); // 용도명
		} 
		else { 
		  zuse_nm = ds_detail.GetColumn(2, "ZUSE_NM");  
		  if ( ds_detail.GetColumn(2, "MATNR") == "T-1000" ) {  
			ds_list2.SetColumn(0, "UNM_03", gtype); // 감시반 일때 용도명 = 기종  
		  } else if  ( ds_detail.GetColumn(2, "MATNR") == "S-1000" ) {
			ds_list2.SetColumn(0, "UNM_03", "에스컬레이터"); //
		  } else if  ( ds_detail.GetColumn(2, "MATNR") == "W-1000" ) {
			ds_list2.SetColumn(0, "UNM_03", "무빙워크"); //
		  } else {
			ds_list2.SetColumn(0, "UNM_03", zuse_nm); //용도명  
		  }
		}
	}
	if (rowCnt >= 4) {
		zprdgbn = substr(ds_detail.GetColumn(3, "ZPRDGBN"), 0, 2);
		gtype   = ds_detail.GetColumn(3, "GTYPE"  );  
		//spec_nm = ds_detail.GetColumn(3, "ZUSE") + ds_detail.GetColumn(3, "TYPE1") + "-" 
		//         +ds_detail.GetColumn(3, "ZLEN") + "-" + decode(zprdgbn, "MW", ds_detail.GetColumn(3, "ZOPN"), ds_detail.GetColumn(3, "TYPE3"));
		matnr = ds_detail.GetColumn(3, "MATNR");
		//if (spart=="20") spec_nm = ds_detail.GetColumn(3, "TYPE1") + ds_detail.GetColumn(3, "ZUSE") + "-" + ds_detail.GetColumn(3, "TYPE2") + "-" + ds_detail.GetColumn(3, "TYPE3") + "("+ ds_detail.GetColumn(3, "ZACAPA") + ")"; //"모델명""승입방향"-"단수"-"파렛트수"("수용차종") - (2012.12.10)
		//if (spart=="40") spec_nm = ds_detail.GetColumn(3, "TYPE1"); // PSD - 역명만 표시 (2012.12.12)

		// 사양정보 처리 2012.12.31
		type1 = ds_detail.GetColumn(3, "TYPE1");
		type2 = ds_detail.GetColumn(3, "TYPE2");
		type3 = ds_detail.GetColumn(3, "TYPE3");
		zcapa = ds_detail.GetColumn(3, "ZACAPA");
		zuse  = ds_detail.GetColumn(3, "ZUSE");
		zopen = ds_detail.GetColumn(3, "ZOPN");
		zlen  = ds_detail.GetColumn(3, "ZLEN");
		
		//NEW 견적양식 
		if ( substr ( ds_detail.GetColumn(3,"MATNR"),0,1 ) == "S" ||
		     substr ( ds_detail.GetColumn(3,"MATNR"),0,1 ) == "W" ) {
				ds_list2.SetColumn(0, "TYPE2_04", ds_detail.GetColumn(3, "ZLEN"));
				ds_list2.SetColumn(0, "ZOPN_04", ds_detail.GetColumn(3, "TYPE2"));
				ds_list2.SetColumn(0, "ZLEN_04", ds_detail.GetColumn(3, ""));	     			
		} else {
			ds_list2.SetColumn(0, "TYPE2_04", ds_detail.GetColumn(3, "TYPE2"));			
			ds_list2.SetColumn(0, "ZOPN_04", ds_detail.GetColumn(3, "ZOPN"));
			ds_list2.SetColumn(0, "ZLEN_04", ds_detail.GetColumn(3, "ZLEN"));
		}
		ds_list2.SetColumn(0, "TYPE1_04", ds_detail.GetColumn(3, "TYPE1"));
		ds_list2.SetColumn(0, "TYPE3_04", ds_detail.GetColumn(3, "TYPE3"));
		if ( substr ( ds_detail.GetColumn(3,"MATNR"),0,1 ) == "L" ||
		     substr ( ds_detail.GetColumn(3,"MATNR"),0,1 ) == "S" ||
		     substr ( ds_detail.GetColumn(3,"MATNR"),0,1 ) == "W" ) {
			    ds_list2.SetColumn(0, "EA_04", "대"); 			
		} else {	
			    ds_list2.SetColumn(0, "EA_04", "식");
		}
		
		spec_nm = gfn_specInfo(vkbur, matnr, "", type1, type2, type3, zcapa, zuse, zopen, zlen);

		ds_list2.SetColumn(0, "SPC_04", spec_nm);
		znumber = decode(matnr, "T-1000", "0", ds_detail.GetColumn(3, "ZNUMBER"));  ds_list2.SetColumn(0, "QTY_04", znumber);
		zuam    = ds_detail.GetColumn(3, "ZUAM"   );  ds_list2.SetColumn(0, "RNO_04", "4"    );
		zeam    = ds_detail.GetColumn(3, "ZEAM"   );  ds_list2.SetColumn(0, "USE_04", gtype  );
		//rate    = ParseInt(zeam) / ParseInt(zeam_sum);
		//zeam    = ParseInt(zeam) + Round(ParseInt(zeam_sp) * rate, 0); ds_list2.SetColumn(0, "GAM_04", zeam); // 견적가
		//zuam    = ParseInt(zeam) / ParseInt(znumber); ds_list2.SetColumn(0, "AMT_04", zuam   ); // 단가
		rate    = toNumber(zeam) / toNumber(zeam_sum);
		zeam    = toNumber(zeam) + Round(toNumber(zeam_sp) * rate, 0); ds_list2.SetColumn(0, "GAM_04", zeam); // 견적가
		zuam    = toNumber(zeam) / toNumber(znumber); ds_list2.SetColumn(0, "AMT_04", zuam   ); // 단가
		//zuse_nm = ds_detail.GetColumn(3, "ZUSE_NM");  ds_list2.SetColumn(0, "UNM_04", zuse_nm); // 용도명
		//주차 용도명 
		//trace("zprdgbn=>" + ZPRDGBN );
		var cidx ;
		if ( ZPRDGBN == "AP" ) {
		  switch ( ds_detail.GetColumn(3, "GTYPE") ) {
		   case "2PZ" : cidx = 0; break;
		   case "MPZ" : cidx = 1; break; 
		   case "MFC" : cidx = 2; break;
		   case "VRC" : cidx = 3; break;
		   case "HRC" : cidx = 4; break;
		   case "ELV" : cidx = 5; break;
		   case "STC" : cidx = 6; break;
		   case "CRT" : cidx = 7; break;
		   case "BPS" : cidx = 8; break;
		   case "LFC" : cidx = 9; break;
		   default : break;
		  }
		  //trace("cidx=>" + cidx);
		  zuse_nm = ds_jtype.GetColumn(cidx, "CODE_NAME"); ds_list2.SetColumn(0, "UNM_04", zuse_nm); // 용도명
		} 
		else { 
		  zuse_nm = ds_detail.GetColumn(3, "ZUSE_NM");  
		  if ( ds_detail.GetColumn(3, "MATNR") == "T-1000" ) {  
			ds_list2.SetColumn(0, "UNM_04", gtype); // 감시반 일때 용도명 = 기종  
		  } else if  ( ds_detail.GetColumn(3, "MATNR") == "S-1000" ) {
			ds_list2.SetColumn(0, "UNM_04", "에스컬레이터"); //
		  } else if  ( ds_detail.GetColumn(3, "MATNR") == "W-1000" ) {
			ds_list2.SetColumn(0, "UNM_04", "무빙워크"); //
		  } else {
			ds_list2.SetColumn(0, "UNM_04", zuse_nm); //용도명  
		  }
		}
	}
	if (rowCnt >= 5) {
		zprdgbn = substr(ds_detail.GetColumn(4, "ZPRDGBN"), 0, 2);
		gtype   = ds_detail.GetColumn(4, "GTYPE"  );  
		//spec_nm = ds_detail.GetColumn(4, "ZUSE") + ds_detail.GetColumn(4, "TYPE1") + "-" 
		//         +ds_detail.GetColumn(4, "ZLEN") + "-" + decode(zprdgbn, "MW", ds_detail.GetColumn(4, "ZOPN"), ds_detail.GetColumn(4, "TYPE3"));
		matnr = ds_detail.GetColumn(4, "MATNR");
		//if (spart=="20") spec_nm = ds_detail.GetColumn(4, "TYPE1") + ds_detail.GetColumn(4, "ZUSE") + "-" + ds_detail.GetColumn(4, "TYPE2") + "-" + ds_detail.GetColumn(4, "TYPE3") + "("+ ds_detail.GetColumn(4, "ZACAPA") + ")"; //"모델명""승입방향"-"단수"-"파렛트수"("수용차종") - (2012.12.10)
		//if (spart=="40") spec_nm = ds_detail.GetColumn(4, "TYPE1"); // PSD - 역명만 표시 (2012.12.12)

		// 사양정보 처리 2012.12.31
		type1 = ds_detail.GetColumn(4, "TYPE1");
		type2 = ds_detail.GetColumn(4, "TYPE2");
		type3 = ds_detail.GetColumn(4, "TYPE3");
		zcapa = ds_detail.GetColumn(4, "ZACAPA");
		zuse  = ds_detail.GetColumn(4, "ZUSE");
		zopen = ds_detail.GetColumn(4, "ZOPN");
		zlen  = ds_detail.GetColumn(4, "ZLEN");
		
		//NEW 견적양식 
		if ( substr ( ds_detail.GetColumn(4,"MATNR"),0,1 ) == "S" ||
		     substr ( ds_detail.GetColumn(4,"MATNR"),0,1 ) == "W" ) {
				ds_list2.SetColumn(0, "TYPE2_05", ds_detail.GetColumn(4, "ZLEN"));
				ds_list2.SetColumn(0, "ZOPN_05", ds_detail.GetColumn(4, "TYPE2"));
				ds_list2.SetColumn(0, "ZLEN_05", ds_detail.GetColumn(4, ""));	     			
		} else {
			ds_list2.SetColumn(0, "TYPE2_05", ds_detail.GetColumn(4, "TYPE2"));			
			ds_list2.SetColumn(0, "ZOPN_05", ds_detail.GetColumn(4, "ZOPN"));
			ds_list2.SetColumn(0, "ZLEN_05", ds_detail.GetColumn(4, "ZLEN"));
		}
		ds_list2.SetColumn(0, "TYPE1_05", ds_detail.GetColumn(4, "TYPE1"));
		ds_list2.SetColumn(0, "TYPE3_05", ds_detail.GetColumn(4, "TYPE3"));
		if ( substr ( ds_detail.GetColumn(4,"MATNR"),0,1 ) == "L" ||
		     substr ( ds_detail.GetColumn(4,"MATNR"),0,1 ) == "S" ||
		     substr ( ds_detail.GetColumn(4,"MATNR"),0,1 ) == "W" ) {
			    ds_list2.SetColumn(0, "EA_05", "대"); 			
		} else {	
			    ds_list2.SetColumn(0, "EA_05", "식");
		}
		
		spec_nm = gfn_specInfo(vkbur, matnr, "", type1, type2, type3, zcapa, zuse, zopen, zlen);

		ds_list2.SetColumn(0, "SPC_05", spec_nm);
		znumber = decode(matnr, "T-1000", "0", ds_detail.GetColumn(4, "ZNUMBER"));  ds_list2.SetColumn(0, "QTY_05", znumber);
		zuam    = ds_detail.GetColumn(4, "ZUAM"   );  ds_list2.SetColumn(0, "RNO_05", "5"    );
		zeam    = ds_detail.GetColumn(4, "ZEAM"   );  ds_list2.SetColumn(0, "USE_05", gtype  );
		//rate    = ParseInt(zeam) / ParseInt(zeam_sum);
		//zeam    = ParseInt(zeam) + Round(ParseInt(zeam_sp) * rate, 0); ds_list2.SetColumn(0, "GAM_05", zeam); // 견적가
		//zuam    = ParseInt(zeam) / ParseInt(znumber); ds_list2.SetColumn(0, "AMT_05", zuam   ); // 단가
		rate    = toNumber(zeam) / toNumber(zeam_sum);
		zeam    = toNumber(zeam) + Round(toNumber(zeam_sp) * rate, 0); ds_list2.SetColumn(0, "GAM_05", zeam); // 견적가
		zuam    = toNumber(zeam) / toNumber(znumber); ds_list2.SetColumn(0, "AMT_05", zuam   ); // 단가
		//zuse_nm = ds_detail.GetColumn(4, "ZUSE_NM");  ds_list2.SetColumn(0, "UNM_05", zuse_nm); // 용도명
		//주차 용도명 
		//trace("zprdgbn=>" + ZPRDGBN );
		var cidx ;
		if ( ZPRDGBN == "AP" ) {
		  switch ( ds_detail.GetColumn(4, "GTYPE") ) {
		   case "2PZ" : cidx = 0; break;
		   case "MPZ" : cidx = 1; break; 
		   case "MFC" : cidx = 2; break;
		   case "VRC" : cidx = 3; break;
		   case "HRC" : cidx = 4; break;
		   case "ELV" : cidx = 5; break;
		   case "STC" : cidx = 6; break;
		   case "CRT" : cidx = 7; break;
		   case "BPS" : cidx = 8; break;
		   case "LFC" : cidx = 9; break;
		   default : break;
		  }
		  //trace("cidx=>" + cidx);
		  zuse_nm = ds_jtype.GetColumn(cidx, "CODE_NAME"); ds_list2.SetColumn(0, "UNM_05", zuse_nm); // 용도명
		} 
		else { 
		  zuse_nm = ds_detail.GetColumn(4, "ZUSE_NM");  
		  if ( ds_detail.GetColumn(4, "MATNR") == "T-1000" ) {  
			ds_list2.SetColumn(0, "UNM_05", gtype); // 감시반 일때 용도명 = 기종  
		  } else if  ( ds_detail.GetColumn(4, "MATNR") == "S-1000" ) {
			ds_list2.SetColumn(0, "UNM_05", "에스컬레이터"); //
		  } else if  ( ds_detail.GetColumn(4, "MATNR") == "W-1000" ) {
			ds_list2.SetColumn(0, "UNM_05", "무빙워크"); //
		  } else {
			ds_list2.SetColumn(0, "UNM_05", zuse_nm); //용도명  
		  }
		}
	}
	if (rowCnt >= 6) {
		zprdgbn = substr(ds_detail.GetColumn(5, "ZPRDGBN"), 0, 2);
		gtype   = ds_detail.GetColumn(5, "GTYPE"  );  
		//spec_nm = ds_detail.GetColumn(5, "ZUSE") + ds_detail.GetColumn(5, "TYPE1") + "-" 
		//         +ds_detail.GetColumn(5, "ZLEN") + "-" + decode(zprdgbn, "MW", ds_detail.GetColumn(5, "ZOPN"), ds_detail.GetColumn(5, "TYPE3"));
		matnr = ds_detail.GetColumn(5, "MATNR");
		//if (spart=="20") spec_nm = ds_detail.GetColumn(5, "TYPE1") + ds_detail.GetColumn(5, "ZUSE") + "-" + ds_detail.GetColumn(5, "TYPE2") + "-" + ds_detail.GetColumn(5, "TYPE3") + "("+ ds_detail.GetColumn(5, "ZACAPA") + ")"; //"모델명""승입방향"-"단수"-"파렛트수"("수용차종") - (2012.12.10)
		//if (spart=="40") spec_nm = ds_detail.GetColumn(5, "TYPE1"); // PSD - 역명만 표시 (2012.12.12)

		// 사양정보 처리 2012.12.31
		type1 = ds_detail.GetColumn(5, "TYPE1");
		type2 = ds_detail.GetColumn(5, "TYPE2");
		type3 = ds_detail.GetColumn(5, "TYPE3");
		zcapa = ds_detail.GetColumn(5, "ZACAPA");
		zuse  = ds_detail.GetColumn(5, "ZUSE");
		zopen = ds_detail.GetColumn(5, "ZOPN");
		zlen  = ds_detail.GetColumn(5, "ZLEN");
		
		//NEW 견적양식 
		if ( substr ( ds_detail.GetColumn(5,"MATNR"),0,1 ) == "S" ||
		     substr ( ds_detail.GetColumn(5,"MATNR"),0,1 ) == "W" ) {
				ds_list2.SetColumn(0, "TYPE2_06", ds_detail.GetColumn(5, "ZLEN"));
				ds_list2.SetColumn(0, "ZOPN_06", ds_detail.GetColumn(5, "TYPE2"));
				ds_list2.SetColumn(0, "ZLEN_06", ds_detail.GetColumn(5, ""));	     			
		} else {
			ds_list2.SetColumn(0, "TYPE2_06", ds_detail.GetColumn(5, "TYPE2"));			
			ds_list2.SetColumn(0, "ZOPN_06", ds_detail.GetColumn(5, "ZOPN"));
			ds_list2.SetColumn(0, "ZLEN_06", ds_detail.GetColumn(5, "ZLEN"));
		}
		ds_list2.SetColumn(0, "TYPE1_06", ds_detail.GetColumn(5, "TYPE1"));
		ds_list2.SetColumn(0, "TYPE3_06", ds_detail.GetColumn(5, "TYPE3"));
		if ( substr ( ds_detail.GetColumn(5,"MATNR"),0,1 ) == "L" ||
		     substr ( ds_detail.GetColumn(5,"MATNR"),0,1 ) == "S" ||
		     substr ( ds_detail.GetColumn(5,"MATNR"),0,1 ) == "W" ) {
			    ds_list2.SetColumn(0, "EA_06", "대"); 			
		} else {	
			    ds_list2.SetColumn(0, "EA_06", "식");
		}
		
		spec_nm = gfn_specInfo(vkbur, matnr, "", type1, type2, type3, zcapa, zuse, zopen, zlen);

		ds_list2.SetColumn(0, "SPC_06", spec_nm);
		znumber = decode(matnr, "T-1000", "0", ds_detail.GetColumn(5, "ZNUMBER"));  ds_list2.SetColumn(0, "QTY_06", znumber);
		zuam    = ds_detail.GetColumn(5, "ZUAM"   );  ds_list2.SetColumn(0, "RNO_06", "6"    );
		zeam    = ds_detail.GetColumn(5, "ZEAM"   );  ds_list2.SetColumn(0, "USE_06", gtype  );
		//rate    = ParseInt(zeam) / ParseInt(zeam_sum);
		//zeam    = ParseInt(zeam) + Round(ParseInt(zeam_sp) * rate, 0); ds_list2.SetColumn(0, "GAM_06", zeam); // 견적가
		//zuam    = ParseInt(zeam) / ParseInt(znumber); ds_list2.SetColumn(0, "AMT_06", zuam   );
		rate    = toNumber(zeam) / toNumber(zeam_sum);
		zeam    = toNumber(zeam) + Round(toNumber(zeam_sp) * rate, 0); ds_list2.SetColumn(0, "GAM_06", zeam); // 견적가
		zuam    = toNumber(zeam) / toNumber(znumber); ds_list2.SetColumn(0, "AMT_06", zuam   );
		//zuse_nm = ds_detail.GetColumn(5, "ZUSE_NM");  ds_list2.SetColumn(0, "UNM_06", zuse_nm); // 용도명
		//주차 용도명 
		//trace("zprdgbn=>" + ZPRDGBN );
		var cidx ;
		if ( ZPRDGBN == "AP" ) {
		  switch ( ds_detail.GetColumn(5, "GTYPE") ) {
		   case "2PZ" : cidx = 0; break;
		   case "MPZ" : cidx = 1; break; 
		   case "MFC" : cidx = 2; break;
		   case "VRC" : cidx = 3; break;
		   case "HRC" : cidx = 4; break;
		   case "ELV" : cidx = 5; break;
		   case "STC" : cidx = 6; break;
		   case "CRT" : cidx = 7; break;
		   case "BPS" : cidx = 8; break;
		   case "LFC" : cidx = 9; break;
		   default : break;
		  }
		  //trace("cidx=>" + cidx);
		  zuse_nm = ds_jtype.GetColumn(cidx, "CODE_NAME"); ds_list2.SetColumn(0, "UNM_06", zuse_nm); // 용도명
		} 
		else { 
		  zuse_nm = ds_detail.GetColumn(5, "ZUSE_NM");  
		  if ( ds_detail.GetColumn(5, "MATNR") == "T-1000" ) {  
			ds_list2.SetColumn(0, "UNM_06", gtype); // 감시반 일때 용도명 = 기종  
		  } else if  ( ds_detail.GetColumn(5, "MATNR") == "S-1000" ) {
			ds_list2.SetColumn(0, "UNM_06", "에스컬레이터"); //
		  } else if  ( ds_detail.GetColumn(5, "MATNR") == "W-1000" ) {
			ds_list2.SetColumn(0, "UNM_06", "무빙워크"); //
		  } else {
			ds_list2.SetColumn(0, "UNM_06", zuse_nm); //용도명  
		  }
		}
	}
	if (rowCnt >= 7) {
		zprdgbn = substr(ds_detail.GetColumn(6, "ZPRDGBN"), 0, 2);
		gtype   = ds_detail.GetColumn(6, "GTYPE"  ); 
		//spec_nm = ds_detail.GetColumn(6, "ZUSE") + ds_detail.GetColumn(6, "TYPE1") + "-" 
		//         +ds_detail.GetColumn(6, "ZLEN") + "-" + decode(zprdgbn, "MW", ds_detail.GetColumn(6, "ZOPN"), ds_detail.GetColumn(6, "TYPE3"));
		matnr = ds_detail.GetColumn(6, "MATNR");
		//if (spart=="20") spec_nm = ds_detail.GetColumn(6, "TYPE1") + ds_detail.GetColumn(6, "ZUSE") + "-" + ds_detail.GetColumn(6, "TYPE2") + "-" + ds_detail.GetColumn(6, "TYPE3") + "("+ ds_detail.GetColumn(6, "ZACAPA") + ")"; //"모델명""승입방향"-"단수"-"파렛트수"("수용차종") - (2012.12.10)
		//if (spart=="40") spec_nm = ds_detail.GetColumn(6, "TYPE1"); // PSD - 역명만 표시 (2012.12.12)

		// 사양정보 처리 2012.12.31
		type1 = ds_detail.GetColumn(6, "TYPE1");
		type2 = ds_detail.GetColumn(6, "TYPE2");
		type3 = ds_detail.GetColumn(6, "TYPE3");
		zcapa = ds_detail.GetColumn(6, "ZACAPA");
		zuse  = ds_detail.GetColumn(6, "ZUSE");
		zopen = ds_detail.GetColumn(6, "ZOPN");
		zlen  = ds_detail.GetColumn(6, "ZLEN");
		
		//NEW 견적양식 
		if ( substr ( ds_detail.GetColumn(6,"MATNR"),0,1 ) == "S" ||
		     substr ( ds_detail.GetColumn(6,"MATNR"),0,1 ) == "W" ) {
				ds_list2.SetColumn(0, "TYPE2_07", ds_detail.GetColumn(6, "ZLEN"));
				ds_list2.SetColumn(0, "ZOPN_07", ds_detail.GetColumn(6, "TYPE2"));
				ds_list2.SetColumn(0, "ZLEN_07", ds_detail.GetColumn(6, ""));	     			
		} else {
			ds_list2.SetColumn(0, "TYPE2_07", ds_detail.GetColumn(6, "TYPE2"));			
			ds_list2.SetColumn(0, "ZOPN_07", ds_detail.GetColumn(6, "ZOPN"));
			ds_list2.SetColumn(0, "ZLEN_07", ds_detail.GetColumn(6, "ZLEN"));
		}
		ds_list2.SetColumn(0, "TYPE1_07", ds_detail.GetColumn(6, "TYPE1"));
		ds_list2.SetColumn(0, "TYPE3_07", ds_detail.GetColumn(6, "TYPE3"));
		if ( substr ( ds_detail.GetColumn(6,"MATNR"),0,1 ) == "L" ||
		     substr ( ds_detail.GetColumn(6,"MATNR"),0,1 ) == "S" ||
		     substr ( ds_detail.GetColumn(6,"MATNR"),0,1 ) == "W" ) {
			    ds_list2.SetColumn(0, "EA_07", "대"); 			
		} else {	
			    ds_list2.SetColumn(0, "EA_07", "식");
		}
		
		spec_nm = gfn_specInfo(vkbur, matnr, "", type1, type2, type3, zcapa, zuse, zopen, zlen);

		ds_list2.SetColumn(0, "SPC_07", spec_nm);
		znumber = decode(matnr, "T-1000", "0", ds_detail.GetColumn(6, "ZNUMBER"));  ds_list2.SetColumn(0, "QTY_07", znumber);
		zuam    = ds_detail.GetColumn(6, "ZUAM"   );  ds_list2.SetColumn(0, "RNO_07", "7"    );
		zeam    = ds_detail.GetColumn(6, "ZEAM"   );  ds_list2.SetColumn(0, "USE_07", gtype  );
		//rate    = ParseInt(zeam) / ParseInt(zeam_sum);
		//zeam    = ParseInt(zeam) + Round(ParseInt(zeam_sp) * rate, 0); ds_list2.SetColumn(0, "GAM_07", zeam); // 견적가
		//zuam    = ParseInt(zeam) / ParseInt(znumber); ds_list2.SetColumn(0, "AMT_07", zuam   ); // 단가
		rate    = toNumber(zeam) / toNumber(zeam_sum);
		zeam    = toNumber(zeam) + Round(toNumber(zeam_sp) * rate, 0); ds_list2.SetColumn(0, "GAM_07", zeam); // 견적가
		zuam    = toNumber(zeam) / toNumber(znumber); ds_list2.SetColumn(0, "AMT_07", zuam   ); // 단가
		//zuse_nm = ds_detail.GetColumn(6, "ZUSE_NM");  ds_list2.SetColumn(0, "UNM_07", zuse_nm); // 용도명
		//주차 용도명 
		//trace("zprdgbn=>" + ZPRDGBN );
		var cidx ;
		if ( ZPRDGBN == "AP" ) {
		  switch ( ds_detail.GetColumn(6, "GTYPE") ) {
		   case "2PZ" : cidx = 0; break;
		   case "MPZ" : cidx = 1; break; 
		   case "MFC" : cidx = 2; break;
		   case "VRC" : cidx = 3; break;
		   case "HRC" : cidx = 4; break;
		   case "ELV" : cidx = 5; break;
		   case "STC" : cidx = 6; break;
		   case "CRT" : cidx = 7; break;
		   case "BPS" : cidx = 8; break;
		   case "LFC" : cidx = 9; break;
		   default : break;
		  }
		  //trace("cidx=>" + cidx);
		  zuse_nm = ds_jtype.GetColumn(cidx, "CODE_NAME"); ds_list2.SetColumn(0, "UNM_07", zuse_nm); // 용도명
		} 
		else { 
		  zuse_nm = ds_detail.GetColumn(6, "ZUSE_NM");  
		  if ( ds_detail.GetColumn(6, "MATNR") == "T-1000" ) {  
			ds_list2.SetColumn(0, "UNM_07", gtype); // 감시반 일때 용도명 = 기종  
		  } else if  ( ds_detail.GetColumn(6, "MATNR") == "S-1000" ) {
			ds_list2.SetColumn(0, "UNM_07", "에스컬레이터"); //
		  } else if  ( ds_detail.GetColumn(6, "MATNR") == "W-1000" ) {
			ds_list2.SetColumn(0, "UNM_07", "무빙워크"); //
		  } else {
			ds_list2.SetColumn(0, "UNM_07", zuse_nm); //용도명  
		  }
		}
	}
	if (rowCnt >= 8) {
		zprdgbn = substr(ds_detail.GetColumn(7, "ZPRDGBN"), 0, 2);
		gtype   = ds_detail.GetColumn(7, "GTYPE"  );  
		//spec_nm = ds_detail.GetColumn(7, "ZUSE") + ds_detail.GetColumn(7, "TYPE1") + "-" 
		//         +ds_detail.GetColumn(7, "ZLEN") + "-" + decode(zprdgbn, "MW", ds_detail.GetColumn(7, "ZOPN"), ds_detail.GetColumn(7, "TYPE3"));
		matnr = ds_detail.GetColumn(7, "MATNR");
		//if (spart=="20") spec_nm = ds_detail.GetColumn(7, "TYPE1") + ds_detail.GetColumn(7, "ZUSE") + "-" + ds_detail.GetColumn(7, "TYPE2") + "-" + ds_detail.GetColumn(7, "TYPE3") + "("+ ds_detail.GetColumn(7, "ZACAPA") + ")"; //"모델명""승입방향"-"단수"-"파렛트수"("수용차종") - (2012.12.10)
		//if (spart=="40") spec_nm = ds_detail.GetColumn(7, "TYPE1"); // PSD - 역명만 표시 (2012.12.12)

		// 사양정보 처리 2012.12.31
		type1 = ds_detail.GetColumn(7, "TYPE1");
		type2 = ds_detail.GetColumn(7, "TYPE2");
		type3 = ds_detail.GetColumn(7, "TYPE3");
		zcapa = ds_detail.GetColumn(7, "ZACAPA");
		zuse  = ds_detail.GetColumn(7, "ZUSE");
		zopen = ds_detail.GetColumn(7, "ZOPN");
		zlen  = ds_detail.GetColumn(7, "ZLEN");
		
		//NEW 견적양식 
		if ( substr ( ds_detail.GetColumn(7,"MATNR"),0,1 ) == "S" ||
		     substr ( ds_detail.GetColumn(7,"MATNR"),0,1 ) == "W" ) {
				ds_list2.SetColumn(0, "TYPE2_08", ds_detail.GetColumn(7, "ZLEN"));
				ds_list2.SetColumn(0, "ZOPN_08", ds_detail.GetColumn(7, "TYPE2"));
				ds_list2.SetColumn(0, "ZLEN_08", ds_detail.GetColumn(7, ""));	     			
		} else {
			ds_list2.SetColumn(0, "TYPE2_08", ds_detail.GetColumn(7, "TYPE2"));			
			ds_list2.SetColumn(0, "ZOPN_08", ds_detail.GetColumn(7, "ZOPN"));
			ds_list2.SetColumn(0, "ZLEN_08", ds_detail.GetColumn(7, "ZLEN"));
		}
		ds_list2.SetColumn(0, "TYPE1_08", ds_detail.GetColumn(7, "TYPE1"));
		ds_list2.SetColumn(0, "TYPE3_08", ds_detail.GetColumn(7, "TYPE3"));
		if ( substr ( ds_detail.GetColumn(7,"MATNR"),0,1 ) == "L" ||
		     substr ( ds_detail.GetColumn(7,"MATNR"),0,1 ) == "S" ||
		     substr ( ds_detail.GetColumn(7,"MATNR"),0,1 ) == "W" ) {
			    ds_list2.SetColumn(0, "EA_08", "대"); 			
		} else {	
			    ds_list2.SetColumn(0, "EA_08", "식");
		}
		
		spec_nm = gfn_specInfo(vkbur, matnr, "", type1, type2, type3, zcapa, zuse, zopen, zlen);

		ds_list2.SetColumn(0, "SPC_08", spec_nm);
		znumber = decode(matnr, "T-1000", "0", ds_detail.GetColumn(7, "ZNUMBER"));  ds_list2.SetColumn(0, "QTY_08", znumber);
		zuam    = ds_detail.GetColumn(7, "ZUAM"   );  ds_list2.SetColumn(0, "RNO_08", "8"    );
		zeam    = ds_detail.GetColumn(7, "ZEAM"   );  ds_list2.SetColumn(0, "USE_08", gtype  );
		//rate    = ParseInt(zeam) / ParseInt(zeam_sum);
		//zeam    = ParseInt(zeam) + Round(ParseInt(zeam_sp) * rate, 0); ds_list2.SetColumn(0, "GAM_08", zeam); // 견적가
		//zuam    = ParseInt(zeam) / ParseInt(znumber); ds_list2.SetColumn(0, "AMT_08", zuam   ); // 단가
		rate    = toNumber(zeam) / toNumber(zeam_sum);
		zeam    = toNumber(zeam) + Round(toNumber(zeam_sp) * rate, 0); ds_list2.SetColumn(0, "GAM_08", zeam); // 견적가
		zuam    = toNumber(zeam) / toNumber(znumber); ds_list2.SetColumn(0, "AMT_08", zuam   ); // 단가
		//zuse_nm = ds_detail.GetColumn(7, "ZUSE_NM");  ds_list2.SetColumn(0, "UNM_08", zuse_nm); // 용도명
		//주차 용도명 
		//trace("zprdgbn=>" + ZPRDGBN );
		var cidx ;
		if ( ZPRDGBN == "AP" ) {
		  switch ( ds_detail.GetColumn(7, "GTYPE") ) {
		   case "2PZ" : cidx = 0; break;
		   case "MPZ" : cidx = 1; break; 
		   case "MFC" : cidx = 2; break;
		   case "VRC" : cidx = 3; break;
		   case "HRC" : cidx = 4; break;
		   case "ELV" : cidx = 5; break;
		   case "STC" : cidx = 6; break;
		   case "CRT" : cidx = 7; break;
		   case "BPS" : cidx = 8; break;
		   case "LFC" : cidx = 9; break;
		   default : break;
		  }
		  //trace("cidx=>" + cidx);
		  zuse_nm = ds_jtype.GetColumn(cidx, "CODE_NAME"); ds_list2.SetColumn(0, "UNM_08", zuse_nm); // 용도명
		} 
		else { 
		  zuse_nm = ds_detail.GetColumn(7, "ZUSE_NM");  
		  if ( ds_detail.GetColumn(7, "MATNR") == "T-1000" ) {  
			ds_list2.SetColumn(0, "UNM_08", gtype); // 감시반 일때 용도명 = 기종  
		  } else if  ( ds_detail.GetColumn(7, "MATNR") == "S-1000" ) {
			ds_list2.SetColumn(0, "UNM_08", "에스컬레이터"); //
		  } else if  ( ds_detail.GetColumn(7, "MATNR") == "W-1000" ) {
			ds_list2.SetColumn(0, "UNM_08", "무빙워크"); //
		  } else {
			ds_list2.SetColumn(0, "UNM_08", zuse_nm); //용도명  
		  }
		}
	}
	if (rowCnt >= 9) {
		zprdgbn = substr(ds_detail.GetColumn(8, "ZPRDGBN"), 0, 2);
		gtype   = ds_detail.GetColumn(8, "GTYPE"  );  
		//spec_nm = ds_detail.GetColumn(8, "ZUSE") + ds_detail.GetColumn(8, "TYPE1") + "-" 
		//         +ds_detail.GetColumn(8, "ZLEN") + "-" + decode(zprdgbn, "MW", ds_detail.GetColumn(8, "ZOPN"), ds_detail.GetColumn(8, "TYPE3"));
		matnr = ds_detail.GetColumn(8, "MATNR");
		//if (spart=="20") spec_nm = ds_detail.GetColumn(8, "TYPE1") + ds_detail.GetColumn(8, "ZUSE") + "-" + ds_detail.GetColumn(8, "TYPE2") + "-" + ds_detail.GetColumn(8, "TYPE3") + "("+ ds_detail.GetColumn(8, "ZACAPA") + ")"; //"모델명""승입방향"-"단수"-"파렛트수"("수용차종") - (2012.12.10)
		//if (spart=="40") spec_nm = ds_detail.GetColumn(8, "TYPE1"); // PSD - 역명만 표시 (2012.12.12)

		// 사양정보 처리 2012.12.31
		type1 = ds_detail.GetColumn(8, "TYPE1");
		type2 = ds_detail.GetColumn(8, "TYPE2");
		type3 = ds_detail.GetColumn(8, "TYPE3");
		zcapa = ds_detail.GetColumn(8, "ZACAPA");
		zuse  = ds_detail.GetColumn(8, "ZUSE");
		zopen = ds_detail.GetColumn(8, "ZOPN");
		zlen  = ds_detail.GetColumn(8, "ZLEN");
		
		//NEW 견적양식 
		if ( substr ( ds_detail.GetColumn(8,"MATNR"),0,1 ) == "S" ||
		     substr ( ds_detail.GetColumn(8,"MATNR"),0,1 ) == "W" ) {
				ds_list2.SetColumn(0, "TYPE2_09", ds_detail.GetColumn(8, "ZLEN"));
				ds_list2.SetColumn(0, "ZOPN_09", ds_detail.GetColumn(8, "TYPE2"));
				ds_list2.SetColumn(0, "ZLEN_09", ds_detail.GetColumn(8, ""));	     			
		} else {
			ds_list2.SetColumn(0, "TYPE2_09", ds_detail.GetColumn(8, "TYPE2"));			
			ds_list2.SetColumn(0, "ZOPN_09", ds_detail.GetColumn(8, "ZOPN"));
			ds_list2.SetColumn(0, "ZLEN_09", ds_detail.GetColumn(8, "ZLEN"));
		}
		ds_list2.SetColumn(0, "TYPE1_09", ds_detail.GetColumn(8, "TYPE1"));
		ds_list2.SetColumn(0, "TYPE3_09", ds_detail.GetColumn(8, "TYPE3"));
		if ( substr ( ds_detail.GetColumn(8,"MATNR"),0,1 ) == "L" ||
		     substr ( ds_detail.GetColumn(8,"MATNR"),0,1 ) == "S" ||
		     substr ( ds_detail.GetColumn(8,"MATNR"),0,1 ) == "W" ) {
			    ds_list2.SetColumn(0, "EA_09", "대"); 			
		} else {	
			    ds_list2.SetColumn(0, "EA_09", "식");
		}
		
		spec_nm = gfn_specInfo(vkbur, matnr, "", type1, type2, type3, zcapa, zuse, zopen, zlen);

		ds_list2.SetColumn(0, "SPC_09", spec_nm);
		znumber = decode(matnr, "T-1000", "0", ds_detail.GetColumn(8, "ZNUMBER"));  ds_list2.SetColumn(0, "QTY_09", znumber);
		zuam    = ds_detail.GetColumn(8, "ZUAM"   );  ds_list2.SetColumn(0, "RNO_09", "9"    );
		zeam    = ds_detail.GetColumn(8, "ZEAM"   );  ds_list2.SetColumn(0, "USE_09", gtype  );
		//rate    = ParseInt(zeam) / ParseInt(zeam_sum);
		//zeam    = ParseInt(zeam) + Round(ParseInt(zeam_sp) * rate, 0); ds_list2.SetColumn(0, "GAM_09", zeam); // 견적가
		//zuam    = ParseInt(zeam) / ParseInt(znumber); ds_list2.SetColumn(0, "AMT_09", zuam   ); // 단가
		rate    = toNumber(zeam) / toNumber(zeam_sum);
		zeam    = toNumber(zeam) + Round(toNumber(zeam_sp) * rate, 0); ds_list2.SetColumn(0, "GAM_09", zeam); // 견적가
		zuam    = toNumber(zeam) / toNumber(znumber); ds_list2.SetColumn(0, "AMT_09", zuam   ); // 단가
		//zuse_nm = ds_detail.GetColumn(8, "ZUSE_NM");  ds_list2.SetColumn(0, "UNM_09", zuse_nm); // 용도명
		//주차 용도명 
		//trace("zprdgbn=>" + ZPRDGBN );
		var cidx ;
		if ( ZPRDGBN == "AP" ) {
		  switch ( ds_detail.GetColumn(8, "GTYPE") ) {
		   case "2PZ" : cidx = 0; break;
		   case "MPZ" : cidx = 1; break; 
		   case "MFC" : cidx = 2; break;
		   case "VRC" : cidx = 3; break;
		   case "HRC" : cidx = 4; break;
		   case "ELV" : cidx = 5; break;
		   case "STC" : cidx = 6; break;
		   case "CRT" : cidx = 7; break;
		   case "BPS" : cidx = 8; break;
		   case "LFC" : cidx = 9; break;
		   default : break;
		  }
		  //trace("cidx=>" + cidx);
		  zuse_nm = ds_jtype.GetColumn(cidx, "CODE_NAME"); ds_list2.SetColumn(0, "UNM_09", zuse_nm); // 용도명
		} 
		else { 
		  zuse_nm = ds_detail.GetColumn(8, "ZUSE_NM");  
		  if ( ds_detail.GetColumn(8, "MATNR") == "T-1000" ) {  
			ds_list2.SetColumn(0, "UNM_09", gtype); // 감시반 일때 용도명 = 기종  
		  } else if  ( ds_detail.GetColumn(8, "MATNR") == "S-1000" ) {
			ds_list2.SetColumn(0, "UNM_09", "에스컬레이터"); //
		  } else if  ( ds_detail.GetColumn(8, "MATNR") == "W-1000" ) {
			ds_list2.SetColumn(0, "UNM_09", "무빙워크"); //
		  } else {
			ds_list2.SetColumn(0, "UNM_09", zuse_nm); //용도명  
		  }
		}
	}
	if (rowCnt >= 10) {
		zprdgbn = substr(ds_detail.GetColumn(9, "ZPRDGBN"), 0, 2);
		gtype   = ds_detail.GetColumn(9, "GTYPE"  );  
		//spec_nm = ds_detail.GetColumn(9, "ZUSE") + ds_detail.GetColumn(9, "TYPE1") + "-" 
		//         +ds_detail.GetColumn(9, "ZLEN") + "-" +decode(zprdgbn, "MW", ds_detail.GetColumn(9, "ZOPN"), ds_detail.GetColumn(9, "TYPE3"));
		matnr = ds_detail.GetColumn(9, "MATNR");
		//if (spart=="20") spec_nm = ds_detail.GetColumn(9, "TYPE1") + ds_detail.GetColumn(9, "ZUSE") + "-" + ds_detail.GetColumn(9, "TYPE2") + "-" + ds_detail.GetColumn(9, "TYPE3") + "("+ ds_detail.GetColumn(9, "ZACAPA") + ")"; //"모델명""승입방향"-"단수"-"파렛트수"("수용차종") - (2012.12.10)
		//if (spart=="40") spec_nm = ds_detail.GetColumn(9, "TYPE1"); // PSD - 역명만 표시 (2012.12.12)

		// 사양정보 처리 2012.12.31
		type1 = ds_detail.GetColumn(9, "TYPE1");
		type2 = ds_detail.GetColumn(9, "TYPE2");
		type3 = ds_detail.GetColumn(9, "TYPE3");
		zcapa = ds_detail.GetColumn(9, "ZACAPA");
		zuse  = ds_detail.GetColumn(9, "ZUSE");
		zopen = ds_detail.GetColumn(9, "ZOPN");
		zlen  = ds_detail.GetColumn(9, "ZLEN");
		
		//NEW 견적양식 
		if ( substr ( ds_detail.GetColumn(9,"MATNR"),0,1 ) == "S" ||
		     substr ( ds_detail.GetColumn(9,"MATNR"),0,1 ) == "W" ) {
				ds_list2.SetColumn(0, "TYPE2_10", ds_detail.GetColumn(9, "ZLEN"));
				ds_list2.SetColumn(0, "ZOPN_10", ds_detail.GetColumn(9, "TYPE2"));
				ds_list2.SetColumn(0, "ZLEN_10", ds_detail.GetColumn(9, ""));	     			
		} else {
			ds_list2.SetColumn(0, "TYPE2_10", ds_detail.GetColumn(9, "TYPE2"));			
			ds_list2.SetColumn(0, "ZOPN_10", ds_detail.GetColumn(9, "ZOPN"));
			ds_list2.SetColumn(0, "ZLEN_10", ds_detail.GetColumn(9, "ZLEN"));
		}
		ds_list2.SetColumn(0, "TYPE1_10", ds_detail.GetColumn(9, "TYPE1"));
		ds_list2.SetColumn(0, "TYPE3_10", ds_detail.GetColumn(9, "TYPE3"));
		if ( substr ( ds_detail.GetColumn(9,"MATNR"),0,1 ) == "L" ||
		     substr ( ds_detail.GetColumn(9,"MATNR"),0,1 ) == "S" ||
		     substr ( ds_detail.GetColumn(9,"MATNR"),0,1 ) == "W" ) {
			    ds_list2.SetColumn(0, "EA_10", "대"); 			
		} else {
		        ds_list2.SetColumn(0, "EA_10", "식"); 	
		}
	
		spec_nm = gfn_specInfo(vkbur, matnr, "", type1, type2, type3, zcapa, zuse, zopen, zlen);

		ds_list2.SetColumn(0, "SPC_10", spec_nm);
		znumber = decode(matnr, "T-1000", "0", ds_detail.GetColumn(9, "ZNUMBER"));  ds_list2.SetColumn(0, "QTY_10", znumber);
		zuam    = ds_detail.GetColumn(9, "ZUAM"   );  ds_list2.SetColumn(0, "RNO_10", "10"   );
		zeam    = ds_detail.GetColumn(9, "ZEAM"   );  ds_list2.SetColumn(0, "USE_10", gtype  );
		//rate    = ParseInt(zeam) / ParseInt(zeam_sum);
		//zeam    = ParseInt(zeam) + Round(ParseInt(zeam_sp) * rate, 0); ds_list2.SetColumn(0, "GAM_10", zeam); // 견적가
		//zuam    = ParseInt(zeam) / ParseInt(znumber); ds_list2.SetColumn(0, "AMT_10", zuam   ); // 단가
		rate    = toNumber(zeam) / toNumber(zeam_sum);
		zeam    = toNumber(zeam) + Round(toNumber(zeam_sp) * rate, 0); ds_list2.SetColumn(0, "GAM_10", zeam); // 견적가
		zuam    = toNumber(zeam) / toNumber(znumber); ds_list2.SetColumn(0, "AMT_10", zuam   ); // 단가
		//zuse_nm = ds_detail.GetColumn(9, "ZUSE_NM");  ds_list2.SetColumn(0, "UNM_10", zuse_nm); // 용도명
		//주차 용도명 
		//trace("zprdgbn=>" + ZPRDGBN );
		var cidx ;
		if ( ZPRDGBN == "AP" ) {
		  switch ( ds_detail.GetColumn(9, "GTYPE") ) {
		   case "2PZ" : cidx = 0; break;
		   case "MPZ" : cidx = 1; break; 
		   case "MFC" : cidx = 2; break;
		   case "VRC" : cidx = 3; break;
		   case "HRC" : cidx = 4; break;
		   case "ELV" : cidx = 5; break;
		   case "STC" : cidx = 6; break;
		   case "CRT" : cidx = 7; break;
		   case "BPS" : cidx = 8; break;
		   case "LFC" : cidx = 9; break;
		   default : break;
		  }
		  //trace("cidx=>" + cidx);
		  zuse_nm = ds_jtype.GetColumn(cidx, "CODE_NAME"); ds_list2.SetColumn(0, "UNM_10", zuse_nm); // 용도명
		} 
		else { 
		  zuse_nm = ds_detail.GetColumn(9, "ZUSE_NM");  
		  if ( ds_detail.GetColumn(9, "MATNR") == "T-1000" ) {  
			ds_list2.SetColumn(0, "UNM_10", gtype); // 감시반 일때 용도명 = 기종  
		  } else if  ( ds_detail.GetColumn(9, "MATNR") == "S-1000" ) {
			ds_list2.SetColumn(0, "UNM_10", "에스컬레이터"); //
		  } else if  ( ds_detail.GetColumn(9, "MATNR") == "W-1000" ) {
			ds_list2.SetColumn(0, "UNM_10", "무빙워크"); //
		  } else {
			ds_list2.SetColumn(0, "UNM_10", zuse_nm); //용도명  
		  }
		}
	}
	
	if ( rowCnt > 0 && rowCnt < 10 ) {
		ds_list2.SetColumn(0, "SPC_"+lpad((rowCnt+1), "0", 2), "     (이하여백)");
	}

	ds_detail.UnFilter();
	ds_list2.SetColumn(0, "AMT", ds_header.GetColumn(0, "ZSUM_ZEAM")); //ds_list2.SetColumn(0, "AMT", ds_detail.Sum("ZEAM"));
    ds_list1.SetColumn(0, "AMT", ds_header.GetColumn(0, "ZSUM_ZEAM"));
    fn_destroyWait();

   // trace(ds_list1.savexml());
   // trace(ds_list2.savexml());
    
	var arg = "fa_spart="+spart;
	Dialog("SES::Ses0370.xml", arg, -1, -1, "Resize=true");	// UbiReport Call
}

//=========================================================================================
// [ PART 4]
// Callback 함수 정의 : callback 함수명은 메인 함수의 fn_xxxx() 에서 xxxx 부분은 fn_afterXXXX()
// 형태가 되도록 작성 
//=========================================================================================
/********************************************************************************
* 기      능   : 조회 Callback  
********************************************************************************/
function fn_afterQuery(svcId, errCode, errMsg) {
    var vfa_disp = fa_disp;
    
	F_CLICKED_ROW = -1; // 2013.02.01 클릭한행 초기화
	fn_destroyWait();

	if        (svcId == "queryInco"    ) {

	} else if (svcId == "queryAcapa"   ) { // trace(ds_acapa.SaveXML());
	} else if (svcId == "queryExchange") { // trace(ds_exchange.SaveXML());
	} else if (svcId == "queryDuty"    ) {

		if(ds_error.rowcount() > 0) {
			gfn_showAlert(ds_error.GetColumn(0,"ERRMSG"));
			return;
		} else {
			fn_template("Duty", ds_detail.currow);
		}
	} else if (svcId == "queryZregn1") { // trace(ds_zregn2.SaveXML());
	} else if (svcId == "queryZregn2") { //	trace(ds_zregn3.SaveXML());
//trace("11111");	
		/*var idx     = tab.main.div_header.cb_zregn2.Index;
		var strCode = ds_zregn2.getColumn(idx, "ATWRT");
		var region  = ds_header.GetColumn(0, "REGION");
        
		cb_zregn2_OnChanged(strCode, strCode, "", "", "");
		var searchRow = ds_zregn3.searchRow("ATWRT =="+quote(region));
		tab.main.div_header.cb_zregn3.Index = searchRow;
				
		fn_destroyWait();*/
	} else if (svcId == "queryClass" ) {
	} else if (svcId == "queryZGtype") { // trace(ds_zgtype.SaveXML());
	} else if (svcId == "querySo"    ) {

		var zprgflg = ds_header.GetColumn(0, "ZPRGFLG"); // 진행상태
		if (zprgflg == "" || zprgflg == null)  ds_header.SetColumn(0, "ZPRGFLG", "20") ;
        
        
        /*if (zprgflg > "31") vdate = ds_header.GetColumn(0,"DELDAT");
        trace("************1");
        trace(ds_header.savexml());
        trace("vdddddddddate" + vdate);        */
        
		var matnr = ds_header.GetColumn(0, "MATNR");
		if (matnr == null) matnr = ds_detail.GetColumn(0, "MATNR");

		var	searchRow = ds_class.FindRow("MATNR", matnr);
			zprdgbn   = ds_class.GetColumn(searchRow, "CLASS_CD");

		if (zprdgbn != null) fn_queryTemplate();
		else {
			tab.DeleteTab(1);
			// (2012.12.12) 물류
			if (flag == "I") {
				btn_plus_OnClick();
				flag = "";
			}
		}

		fn_setFormByPrd(zprdgbn, svcId, ds_header.GetColumn(0, "SPART")); // 그리드 헤더 텍스트 변경 (2012.12.10)
        
        // 주차 : 수주계획  모델명(type1) -> 견적화면 모델명(용도)로 매칭 되도록 변경 2013.04.28 강슬기
	    if ( zprdgbn == "AP_01" ) {
			ds_detail.SetColumn(0, "ZUSE", ds_detail.GetColumn(0, "TYPE1"));
			ds_detail.SetColumn(0, "TYPE1", "");
		}	
		
		// 물류 
		if ( ds_header.GetColumn(0, "SPART") == "30" ) {  
			ds_detail.SetColumn(0, "ZUSE", ds_detail.GetColumn(0, "TYPE1"));
			ds_detail.SetColumn(0, "TYPE1", "");
			ds_detail.SetColumn(0, "TYPE1", ds_detail.GetColumn(0, "TYPE2"));
			ds_detail.SetColumn(0, "TYPE2", "");
			ds_detail.SetColumn(0, "ZACAPA", ds_detail.GetColumn(0, "TYPE3"));
			ds_detail.SetColumn(0, "TYPE3", "");
			ds_detail.SetColumn(0, "TYPE2", ds_detail.GetColumn(0, "ZNUMBER"));
			ds_detail.SetColumn(0, "ZNUMBER", "1");
		}
		
		//PSD 
		if ( zprdgbn == "PSD_01" ) {
			//ds_detail.SetColumn(0, "ZUSE", ds_detail.GetColumn(0, "TYPE1"));
			//ds_detail.SetColumn(0, "TYPE1", "");
			ds_detail.SetColumn(0, "ZACAPA", ds_detail.GetColumn(0, "TYPE2"));
			ds_detail.SetColumn(0, "TYPE2", "");
			ds_detail.SetColumn(0, "TYPE2", ds_detail.GetColumn(0, "TYPE3"));
			ds_detail.SetColumn(0, "TYPE3", "");
			ds_detail.SetColumn(0, "TYPE3", ds_detail.GetColumn(0, "ZNUMBER"));
			ds_detail.SetColumn(0, "ZNUMBER", "1");
		}
		
	} else if (svcId == "queryTemplate") {
//trace("22222");
        //광역 운송지역 sync 처리 2013.01.10   ---> 운송지역 데이타셋 필요해서 추가함.. 
		http.sync = true;
	
		ds_cond_atnam.ClearData();
		ds_cond_atnam.AddRow();
		ds_cond_atnam.SetColumn(0, "MANDT" , G_MANDT   );
		ds_cond_atnam.SetColumn(0, "KLART" , "300"     );
		ds_cond_atnam.SetColumn(0, "CLASS1", "ELV_01"  );
		ds_cond_atnam.SetColumn(0, "ATKLA" , "EL_BASIC");
		ds_cond_atnam.SetColumn(0, "ATNAM" , "EL_ALOCT");
		ds_cond_atnam.SetColumn(0, "WHERE" , ""        );
		nsfRequest("queryZregn1", "com0150/find", "ds_cond_atnam=ds_cond_atnam ds_list_atnam=ds_zregn2", "ds_zregn2=ds_list_atnam", "", "fn_afterQuery");

		ds_cond_atnam.SetColumn(0, "ATNAM" , "EL_ADTA");
		nsfRequest("queryZregn2", "com0150/find", "ds_cond_atnam=ds_cond_atnam ds_list_atnam=ds_zregn3", "ds_zregn3=ds_list_atnam", "", "fn_afterQuery");

		ds_zregn3.sort("ATWTB");  // 운송지역 가나다 순 SORT 20130430 김선호
		http.sync = false;
	
		nsfRequest("queryZ302", "ses0031/searchZ302", "ds_header=ds_header ds_t302=ds_t302", "ds_t302=ds_t302 ds_error=ds_error", "", "fn_afterQuery");
		ds_detail.OnColumnChanged = "ds_detail_OnColumnChanged";
		fn_template("", 0);
		
	} else if (svcId == "queryTemplateAdd") {
//trace("************99-2");
		for (var i = 0; i < ds_template_add.GetRowCount(); i++) {
			ds_template.addRow();
			ds_template.CopyRow(ds_template.row, "ds_template_add", i);
		}
		fn_template("A", ds_detail.currow);

	} else if (svcId == "queryHeader") {
		if (ds_header.GetColumn(0, "ZDElI") == "X")		{
			tab.main.div_header.ed_zdeli.Text = "단납기";
		}		
		zprgflg = ds_header.GetColumn(0,"ZPRGFLG");
		if (zprgflg > "31") vdate = ds_header.GetColumn(0,"DELDAT"); 
        //trace("************2");
        //trace("vdate ===> " + vdate); 
        
         /*if (ds_header.GetColumn(0, "SPART") == "30") {
            trace("vdate ===> " + ds_header.GetColumn(0, "SPART")); 
            http.sync = true;
            var codeArr    = ["SD115"]; 	//코드콤보 설정
			var dsObjArr   = [ ds_fa_byrgbn ];
			var addTypeArr = [G_CODE_NONE ];
	     	gfn_searchCommCode(codeArr, dsObjArr, addTypeArr );
			http.sync = false;
		 }*/

		if( length(trim(ds_header.GetColumnNF(0, "ZBDTYP"))) > 0 ) {
			var zbdtyp = trim(ds_header.GetColumnNF(0, "ZBDTYP"));
			var rowIdx = ds_list_build.FindRowNF("BUILDUSE", zbdtyp);
			if(length(trim(ds_list_build.GetColumnNF(rowIdx, "BUILDUSE_L"))) > 0 ){
			  	var rowIdxL = ds_list_build_l.FindRowNF("BUILDUSE_L", trim(ds_list_build.GetColumnNF(rowIdx, "BUILDUSE_L")));
				tab.main.div_header.cb_zbdtyp_l.index = rowIdxL;
			}
		 }
		 		 	 
		 nsfRequest("queryDetail", "ses0030/detail", "ds_cond=ds_header ds_detail=ds_detail", "ds_detail=ds_detail ds_error=ds_error", "", "fn_afterQuery");
        
        //trace("!!!"+ds_header.savexml());
        
        if (vfa_disp == "Y") fn_enable_set() ; //기술영업에서 조회할때는  화면을 only 조회 모드로 20150304 김선호
        
	} else if (svcId == "queryDetail") {
		
		nsfRequest("queryTemplate", "ses0031/searchTemplate", "ds_detail=ds_detail ds_template=ds_template", "ds_template=ds_template ds_error=ds_error", "", "fn_afterQuery");

		F_CHG_DETAIL_COLNUM = ""; // 변경된 Detail 컬럼번호
		F_CHG_DETAIL_ROWNUM = ""; // 변경된 Detail 행번호
		fn_zprgflg();

		fn_setFormByPrd(ds_detail.GetColumn(ds_detail.row, "ZPRDGBN"), svcId, ds_header.GetColumn(0, "SPART")); // 그리드 헤더 텍스트 변경 (2012.12.10)
        
        trace("************22");
//        trace("*****ds_template->" +  ds_template.savexml());
        
        
	} else if (svcId == "queryZ302") {
		fn_z302();

	} else if (svcId == "queryZ309" ) {
	} else if (svcId == "queryBlock") { // trace(ds_block.SaveXML()); // trace(ds_t302.SaveXML()); 

	} else if (svcId == "queryCost" ) { // trace(ds_check.SaveXML()); //trace(ds_t202.SaveXML()); trace(ds_t302.SaveXML());
		// 2013.01.02 메시지 처리 && 견적등록 재 조회 처리
		if(ds_error.GetRowCount() > 0 )	{
			gfn_showAlert(ds_error.GetColumn(0,"ERRMSG"));
			return;
		}
		parent.fn_query();

		fn_z302();
		// 견적 헤더 정보를 재조해하여 처리 2013.01.07
		ds_cond.ClearData();
		ds_cond.AddRow();
		ds_cond.SetColumn(0, "MANDT", ds_header.GetColumn(0, "MANDT"));
		ds_cond.SetColumn(0, "QTNUM", ds_header.GetColumn(0, "QTNUM"));
		ds_cond.SetColumn(0, "QTSER", ds_header.GetColumn(0, "QTSER"));
		nsfRequest("queryHeader", "ses0030/header", "ds_cond=ds_cond ds_header=ds_header", "ds_header=ds_header ds_error=ds_error", "", "fn_afterQuery");

		//nsfRequest("queryDetail", "ses0030/detail", "ds_cond=ds_header ds_detail=ds_detail", "ds_detail=ds_detail ds_error=ds_error", "", "");
		//ds_header.SetColumn(0, "ZPRGFLG", "32"); // 진행상태
		//fn_zprgflg();

		// 2013.01.02 메시지 추가
		gfn_showAlert("CI00006", "원가산출");

		if (ds_check.GetRowCount() > 0) {

			btn_part.Visible = true;

			// 부분원가 일치화 확인
			destroy("ds_check_temp");
			create("dataset", "ds_check_temp");
			ds_check_temp.copy(ds_check);
			ds_check_temp.Filter(" STATE != 'X' ");

			// 2013.03.13 부분원가 호출 여부 판단 처리
			if (ds_check_temp.GetRowCount() > 0)	{
				var qtnum = ds_header.getColumn(0, "QTNUM");
				var qtser = ds_header.getColumn(0, "QTSER");
				var arg   = "fa_qtnum = " + qtnum + " fa_qtser = " + qtser;
				gfn_openPopUpUrlHdel("SES::Ses0038.xml", true, arg);
			}
		} else {
			btn_part.Visible = false;
		}
	}

	if(ds_error.rowcount() > 0) {
		gfn_showMsg("CE00001");
		gfn_openWSErrorWin(grd_template1, ds_template, ds_error, "FLAG"); // error 정보 표시
	} else {
		if(errCode != 0) gfn_showMsg("CE00001");
		else 			 gfn_showMsg("CI00002", ds_header.RowCount() + "");
	}
}

/********************************************************************************
* 기      능   : 저장 Callback
********************************************************************************/
function fn_afterSave(svcId, errCode, errMsg) {

	F_CLICKED_ROW = -1; // 2013.02.01 클릭한행 초기화
	fn_destroyWait();

	if(ds_error.rowcount > 0)	{
		gfn_showAlert(ds_error.GetColumn(0,"ERRMSG"));
		return;
	}

	var qtdat   = ds_header.GetColumn(0, "QTDAT"  ); // 견적일자
	var zestdat = ds_header.GetColumn(0, "ZESTDAT"); // 입찰예정일
	var vkbur   = ds_header.GetColumn(0, "VKBUR"  ); // 사업장
	var vkgrp   = ds_header.GetColumn(0, "VKGRP"  ); // 영업그룹
	var zprgflg = ds_header.GetColumn(0, "ZPRGFLG"); // 진행상태
	var zkunnr  = ds_header.GetColumn(0, "ZKUNNR" ); // 담당자
	var qtnum	= ds_header.GetColumn(0, "QTNUM");
	
	if ( ds_cond.GetRowCount() == 0 ) {
		ds_cond.AddRow();
	}
	ds_cond.SetColumn(0, "FR_QTDAT"  , qtdat  );
	ds_cond.SetColumn(0, "TO_QTDAT"  , qtdat  );
	ds_cond.SetColumn(0, "FR_ZESTDAT", zestdat);
	ds_cond.SetColumn(0, "TO_ZESTDAT", zestdat);
	ds_cond.SetColumn(0, "VKBUR"     , vkbur  );
	ds_cond.SetColumn(0, "VKGRP"     , vkgrp  );
	ds_cond.SetColumn(0, "ZPRGFLG"   , zprgflg);
	ds_cond.SetColumn(0, "SMAN"      , zkunnr );
	ds_cond.SetColumn(0, "MANDT"     , G_MANDT);
	ds_cond.SetColumn(0, "QTNUM"     , qtnum );

	switch (svcId) {
		case "saveHeader"     : gfn_showAlert("CI00003");		// 저장을 완료했습니다.
								nsfRequest("queryHeader", "ses0030/header", "ds_cond=ds_header ds_header=ds_header", "ds_header=ds_header ds_error=ds_error", "", "fn_afterQuery");
								break;
		case "saveDetail"     : break;
		case "deleteDetail"   : break;
		case "saveHeaderFlag" : gfn_showAlert("CI00005");
								nsfRequest("queryHeader", "ses0030/header", "ds_cond=ds_header ds_header=ds_header", "ds_header=ds_header ds_error=ds_error", "", "");
								break;
		case "saveQtserAdd"   : gfn_showAlert("CI00005");
								parent.fn_query();
								// 재 조회를 위하여 견적번호 및 차수만 정보제공 2013.01.07
								ds_cond.ClearData();
								ds_cond.AddRow();
								ds_cond.SetColumn(0, "MANDT", ds_header.GetColumn(0, "MANDT"));
								ds_cond.SetColumn(0, "QTNUM", ds_header.GetColumn(0, "QTNUM"));
								ds_cond.SetColumn(0, "QTSER", ds_header.GetColumn(0, "QTSER"));
								nsfRequest("queryHeader", "ses0030/header", "ds_cond=ds_cond ds_header=ds_header", "ds_header=ds_header ds_error=ds_error", "", "fn_afterQuery");
								break;
		case "saveQtserDel"   : gfn_showAlert("CI00005");
								parent.fn_query();
								fn_close();
								break;
		default               : break;
	}
	
	if ( tab.TabIndex > 0 ) { // 2012.01.08 저장 후 견적내용 탭으로 이동
		tab.TabIndex = 0;
	}
}


//=========================================================================================
// [ PART 6 ]
// component Event 정의 : 각 Component 별 이벤트 
//=========================================================================================
/********************************************************************************
* 기      능   : 정렬 처리 
********************************************************************************/
function grd_detail_OnHeadClick(obj,nCell,nX,nY,nPivotIndex) {
	if( nCell == 0 ) {
		gfn_selectAllGrid(obj,nCell,nCell,true);
	} else {
		gfn_sortGrid(obj, nCell);
	}	
}

/********************************************************************************
* 기      능   : 조회
********************************************************************************/
function fn_OnClick_btn(obj) {
	var fncName = "fn_" + substr(obj.id, 4); 
	eval( fncName + "()");
}

/********************************************************************************
* 기      능   : 그리드 row 추가
********************************************************************************/
function btn_plus_OnClick(matnr, arr) {
//trace("************5");
	ds_detail.OnColumnChanged = "";
	ds_detail.CanRowPosChange = "";

	var oldRow = ds_detail.currow;
	var newRow = gfn_addGridRow(tab.main.div_header.grd_detail, -1, "FLAG");// 추가된 행번호 수신(FLAG:I) 

	var qtser = ds_header.getColumn(0, "QTSER");
	//var qtseq = toNumber(ds_detail.Max("QTSEQ")) + 1;
	var qtseq = toNumber(gfn_getColMax(ds_detail, "QTSEQ")) + 1;	// 2013.01.14 수정

	var vkbur = ds_header.GetColumn(0, "VKBUR");
	var shangh;
	var gtype;
	var rtype;
	var type1;
	var type2;
	var type3;
	var znumber;
	var sonnr;
	var searchRow;
	var zsarea;
 
	if (qtser == null) qtser = "0";

	F_MAX_SERNO++;

	ds_detail.SetColumn(newRow, "CHK" 	, 1			 );	// 선택여부
	ds_detail.SetColumn(newRow, "NEW_YN", "Y"		 );	// 신규여부
	ds_detail.SetColumn(newRow, "SERNO" , F_MAX_SERNO);	// 순번
	ds_detail.SetColumn(newRow, "MANDT" , ds_header.getColumn(0, "MANDT"));
	ds_detail.SetColumn(newRow, "QTNUM" , ds_header.getColumn(0, "QTNUM"));
	ds_detail.SetColumn(newRow, "QTSER" , ds_header.getColumn(0, "QTSER"));
	ds_detail.SetColumn(newRow, "QTSEQ" , qtseq);

	ds_cond.ClearData();
	ds_cond.AddRow();

	if (matnr == "T-1000" || matnr == "Y-1000" || matnr == "Y-200"  || matnr == "Y-300" || matnr == "Y-400" || matnr == "Y-500" ) 
	{

		znumber = 1;
		
    } else if (matnr == "L-1100" || matnr == "L-1200" ) {
        
		znumber = 1;

	} else if (arr != null) {
		shangh  = arr[0];
		matnr   = arr[1];
		gtype   = arr[2];
		type1   = arr[3];
		type2   = arr[4];
		type3   = arr[5];
		znumber = arr[6];
		sonnr   = arr[7];

	} else {
		gtype   = ds_header.GetColumn(0, "GTYPE"  );
		shangh  = ds_header.GetColumn(0, "SHANGH" ); // 국내상해구분
		matnr   = ds_header.GetColumn(0, "MATNR"  ); // 자재번호
		type1   = ds_header.GetColumn(0, "TYPE1"  );
		type2   = ds_header.GetColumn(0, "TYPE2"  );
		type3   = ds_header.GetColumn(0, "TYPE3"  );
		znumber = ds_header.GetColumn(0, "ZNUMBER");
		sonnr   = ds_header.GetColumn(0, "SONNR"  ); // 수주계획번호
		rtype   = ds_header.GetColumn(0, "RTYPE"  );

		if (oldRow < 0) oldRow = 0;

		if (gtype  == null || oldRow>0) gtype  = ds_detail.GetColumn(oldRow, "GTYPE"  );
		if (shangh == null || oldRow>0) shangh = ds_detail.GetColumn(oldRow, "SHANGH" );
		if (matnr  == null || oldRow>0) matnr  = ds_detail.GetColumn(oldRow, "MATNR"  );
		if (type1  == null || oldRow>0) type1  = ds_detail.GetColumn(oldRow, "TYPE1"  );
		if (type2  == null || oldRow>0) type2  = ds_detail.GetColumn(oldRow, "TYPE2"  );
		if (type3  == null || oldRow>0) type3  = ds_detail.GetColumn(oldRow, "TYPE3"  );
		if (znumber== null || oldRow>0) znumber= ds_detail.GetColumn(oldRow, "ZNUMBER");
		if (sonnr  == null || oldRow>0) sonnr  = ds_detail.GetColumn(oldRow, "SONNR"  );

		if (fa_sonnr != null && oldRow == 0) gtype = rtype;
	}

	searchRow = ds_class.FindRow("MATNR"    , matnr);
	zprdgbn   = ds_class.GetColumn(searchRow, "CLASS_CD");

	if (zprdgbn=="ELV_01" || zprdgbn=="ELV_02" || zprdgbn=="SHN_01") {

		zsarea = "D";

	} else if (zprdgbn=="ESC_01" || zprdgbn=="SHN_02" || zprdgbn=="MW_01") {

		zsarea = "KOREA";

	}  else if (zprdgbn=="AP_01" || zprdgbn=="PSD_01") {
	}

	ds_detail.SetColumn(newRow, "ZSAREA" , zsarea );
	ds_detail.SetColumn(newRow, "SHANGH" , shangh ); // 국내상해구분
	ds_detail.SetColumn(newRow, "MATNR"  , matnr  ); // 자재번호
	ds_detail.SetColumn(newRow, "GTYPE"  , gtype  );
	ds_detail.SetColumn(newRow, "TYPE1"  , type1  );
	ds_detail.SetColumn(newRow, "TYPE2"  , type2  );
	ds_detail.SetColumn(newRow, "TYPE3"  , type3  );
	ds_detail.SetColumn(newRow, "ZNUMBER", znumber);
	ds_detail.SetColumn(newRow, "SONNR"  , sonnr  ); // 수주계획번호
	ds_detail.SetColumn(newRow, "ZPRDGBN", zprdgbn);
	ds_detail.SetColumn(newRow, "MCLASS" , zprdgbn);

	ds_template.UnFilter();
	ds_template.Filter("QTSEQ !=" + quote(qtseq)); ds_temp.CopyF(ds_template); ds_template.Copy(ds_temp);

	ds_cond.SetColumn(0, "MANDT" , ds_header.GetColumn(0, "MANDT"));
	ds_cond.SetColumn(0, "QTNUM" , ds_header.GetColumn(0, "QTNUM"));
	ds_cond.SetColumn(0, "QTSER" , qtser  );
	ds_cond.SetColumn(0, "QTSEQ" , qtseq  );
	ds_cond.SetColumn(0, "MCLASS", zprdgbn);

	nsfRequest("queryTemplateAdd", "ses0031/searchTemplate", "ds_detail=ds_cond ds_template=ds_template_add", "ds_template_add=ds_template ds_error=ds_error", "", "fn_afterQuery");
	
	fn_applayHeaderCost(); //Detail의 원가,견적가,대수가 변경되면 헤더의 합계에 반영

	ds_detail.OnColumnChanged = "ds_detail_OnColumnChanged";
	ds_detail.CanRowPosChange = "ds_detail_CanRowPosChange";
}
/********************************************************************************
* 기      능   : 그리드 row 삭제
********************************************************************************/
function btn_minus_OnClick(obj) {
//trace("************6");
	// 2013.01.14 삭제되는 detail row정보
	var dRowIndex = ds_detail.row;
	// 추가된건을 삭제하는 경우 사양정보 삭제 2012.12.29
	if (ds_detail.GetColumn(dRowIndex, "FLAG") == "I")	{

		// 2013.02.01 화면상에서 MO를 추가 후 삭제 시 최종 추가된 MO부터 삭제 가능
		if (ds_detail.GetColumn(dRowIndex, "QTSEQ") == gfn_getColMax(ds_detail, "QTSEQ"))	{
			for (var i = 0; i < ds_template.GetRowCount(); i++) {
				if ( ds_detail.GetColumn(dRowIndex, "QTNUM") == ds_template.GetColumn(i, "QTNUM") &&
					 ds_detail.GetColumn(dRowIndex, "QTSER") == ds_template.GetColumn(i, "QTSER") &&
					 ds_detail.GetColumn(dRowIndex, "QTSEQ") == ds_template.GetColumn(i, "QTSEQ") )	{
					// 추가 후 삭제 시 삭제
					ds_template.DeleteRow(i);
				}
			}
		}else	{
			gfn_showAlert("CW10025", "최종 추가된 MO부터 삭제하십시요.");
			return;
		}
	}

	gfn_deleteGridRow( tab.main.div_header.grd_detail, ds_detail.row, "FLAG" );

	if (ds_detail.currow >= 0 )	{
		fn_template("A", ds_detail.currow);
	}

	var ds_h = ds_header;
	//fn_aspc("", "", "", 0, 0, 0, 0, ds_h);					// 2013.02.18 ★★★★★ 시방서는 삭제시 적용 안함
	fn_bcpi("", "", "", "", "", "", "", 0, 0, 0, 0, ds_h);  // LED 총 수량
	fn_bclcd("", "", "", "", 0, 0, 0, 0, ds_h); 			// LCD 총 수량
	fn_bcpi("", "", "", "", "", "", "", 0, 0, 0, 0, ds_h); 	// LED 총 수량
	fn_deph("", "", "", 0, 0, 0, 0, ds_h);					// 비상통화장치 DI-PBX 적용대수
	fn_ddvr("", "", "", 0, 0, 0, 0, ds_h);					// DVR 적용대수
	//fn_drvhq("", "", "", 0, 0, 0, 0, ds_h);					// 행선층 예약시스템 적용대수
	fn_dsv1("", "", "", 0, 0, 0, 0, ds_h);					// 감시반1
	fn_dsv2("", "", "", 0, 0, 0, 0, ds_h);					// 감시반2
	fn_aspd();												// 고속현장 2013.04.03

	fn_applayHeaderCost(); //Detail의 원가,견적가,대수가 변경되면 헤더의 합계에 반영
}

/********************************************************************************
* 기      능   : 우편번호 검색 
********************************************************************************/
function ufn_openZipcode(Obj) {	
	var arg = "strObj="+quote(Obj.id);
    gfn_openPopUpUrlHdel("SES::Ses0034.xml", true, arg);
}

var strZipcodeObj;
function ufn_openZipcode1(Obj) {	
	var arg = "strObj="+quote(Obj.id);
    //gfn_openPopUpUrlHdel("SES::Ses0034A.xml", true, arg);
    trace(arg);
	strZipcodeObj=Obj.id;
	AxMSIE0.Navigate2(G_SERVER_URL + "addressSearchLink.jsp");
}

var chk=0;

function AxMSIE0_TitleChange(obj,Text)
{
	chk++;
	trace("chk="+chk);
	trace("Text="+Text);
	if(Text!="address link"){
		if(chk==2){	
					trace("xxxx");

			ufn_setAddr();
			chk=1;
			
		}
	}else{
		chk=1;
	}
}

function ufn_setAddr() {

	var objDocument = AxMSIE0.Document;
	
	var roadAddrPart1 = objDocument.getElementById('roadAddrPart1').value;
	var roadAddrPart2 = objDocument.getElementById('roadAddrPart2').value;
	
	var roadAddr = roadAddrPart1 + ' ' + roadAddrPart2;	
	var jibunAddr = objDocument.getElementById('jibunAddr').value;
	
	var addrDetail = objDocument.getElementById('addrDetail').value;
	// 우편번호 6자리 >> 5자리 변경 201508
	var zipNo = objDocument.getElementById('zipNo').value; 
	//trace(objDocument);
	//trace("roadAddrPart1"+roadAddrPart1);
	//trace("roadAddrPart2"+roadAddrPart2);
	//trace("roadAddr"+roadAddr);
	//trace("jibunAddr"+jibunAddr);
	//trace("addrDetail"+addrDetail);
	trace("zipNo"+zipNo);
	
			tab.main.div_header.med_zipcode.value = zipNo;					
			//tab.main.div_header.ed_addr1.value = roadAddr;
			//tab.main.div_header.ed_addr2.value = addrDetail;	
			tab.main.div_header.ed_addr1.value = jibunAddr;
			tab.main.div_header.ed_addr2.value = addrDetail;
		/*
		//도로명주소
		if(IsValid(Object("med_zipcode"))!=false){
//			med_zipcode1_road.value = zipNo;			
			//ed_nziB.value = zipNo;				
			med_zipcode.value = zipNo;		
		}	
		if(IsValid(Object("ed_road1"))!=false){			
			ed_road1.value = roadAddr;	
		}
		if(IsValid(Object("ed_road2"))!=false){			
			ed_road2.value = addrDetail;	
		}												
	//}	*/
}

function ds_header_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex) {
//trace("************7");
	if (varNewValue != varOldValue) { 	// 값이 변경되었을 경우 변경구분 컬럼 자동 SET 

		obj.SetColumn(nRow, "CHK" , "1");
		gfn_changeFlag( obj, strColumnID, nRow, "FLAG"); // FLAG 변경 : U

		var ds0    = object(ds_template0.ID);
		var ds1    = object(ds_template1.ID);
		var atkla  = "";
		var prh    = "";
		var prd    = "";
		var oldPrd = ""; 

		if (strColumnId=="CO_DDVRTQ" || strColumnId=="CO_DEPHTQ" || strColumnId=="CO_DSSQ"   || strColumnId=="CO_BCLCDTQ" || strColumnId=="CO_CHPITQ" ||
			strColumnId=="CO_ASPC"   || strColumnId=="CO_DSV1"   || strColumnId=="CO_DSV1TQ" || strColumnId=="CO_DSV2"    || strColumnId=="CO_DSV2TQ") {

			// 2013.01.16 시방서의 경우 값이 변경되면 전체 MO에 반영되도록 처리
			if (strColumnId == "CO_ASPC")	{
				for (var i = 0; i < ds1.GetRowCountNF(); i++) {
					atkla = ds1.GetColumnNF(i, "ATKLA");
					prh   = ds1.GetColumnNF(i, "PRH"  );

					if ((atkla == "EL_BASIC" && prh == "EL_ASPC") ||
						(atkla == "ES_BASIC" && prh == "ES_ASPC") ||
						(atkla == "MW_BASIC" && prh == "MW_ASPC") )	{
						prd = obj.GetColumn(0, "CO_ASPC");
					
						//oldPrd = ds1.GetColumnNF(i, "PRD");
						ds1.SetColumnNF(i, "PRD", prd);
						ds1.SetColumnNF(i, "FLAG", "U");
					}
				}	
			}

			for (var i=0; i<ds0.GetRowCountNF(); i++) {

				atkla = ds0.GetColumnNF(i, "ATKLA");
				prh   = ds0.GetColumnNF(i, "PRH"  );

				if (atkla == " ") {
					switch (prh) {
						case "CO_DDVRTQ" : prd = obj.GetColumn(0, "CO_DDVRTQ" ); break;
						case "CO_DEPHTQ" : prd = obj.GetColumn(0, "CO_DEPHTQ" ); break;
						case "CO_DSSQ"   : prd = obj.GetColumn(0, "CO_DSSQ"   ); break;
						case "CO_BCLCDTQ": prd = obj.GetColumn(0, "CO_BCLCDTQ"); break;
						case "CO_CHPITQ" : prd = obj.GetColumn(0, "CO_CHPITQ" ); break;
						case "CO_ASPC"   : prd = obj.GetColumn(0, "CO_ASPC"   ); break;
						case "CO_DSV1"   : prd = obj.GetColumn(0, "CO_DSV1"   ); break;
						case "CO_DSV1TQ" : prd = obj.GetColumn(0, "CO_DSV1TQ" ); break;
						case "CO_DSV2"   : prd = obj.GetColumn(0, "CO_DSV2"   ); break;
						case "CO_DSV2TQ" : prd = obj.GetColumn(0, "CO_DSV2TQ" ); break;
						default          : continue; break;		// 2013.02.18 ★★★★★
					}
				}
				prd = trim(prd);		// 2013.02.18 ★★★★★

				oldPrd = trim(ds0.GetColumnNF(i, "PRD"));	// 2013.02.18 ★★★★★
				if (prd != oldPrd) {
					ds0.SetColumnNF(i, "PRD", prd);
					ds0.SetColumnNF(i, "FLAG", "U");
				}
			}
			// 2012.01.25 공통사양 수정 후 ds_user0 정보 수정되도록 조치
			ds_user0.Copy(ds0);
		} else if (strColumnId=="ZLZONE" || strColumnId=="REGION") {

			for (var i=0; i<ds1.GetRowCount(); i++) {

				prh = ds1.GetColumn(i, "PRH");

				switch (prh) {
					case "EL_ALOCT" : prd = obj.GetColumn(0, "ZLZONE"); ds1.SetColumn(i, "PRD", prd); break;
					case "EL_ADTA"  : prd = obj.GetColumn(0, "REGION"); ds1.SetColumn(i, "PRD", prd); break;
					default         : break;
				}
			}
		//납기일 변경시 	
		} else if (strColumnId=="DELDAT") {		
		    if ( zprgflg=="32" || zprgflg=="42" || zprgflg == "50" || zprgflg == "61") {//원가산출, 원가팀완료, 입찰, 수주 
				if ( substr(vdate,0,4) <> substr(ds_header.getcolumn(0, "DELDAT"),0, 4) ){
					//trace("vdate =>" + vdate);;
					//trace("header_deldat =>" + ds_header.getcolumn(0, "DELDAT"));
					gfn_showAlert("CW10025", "납기예정일은 동일년도에 한해서 변경가능합니다.");
					ds_header.setcolumn(0, "DELDAT", vdate);	
				}
			}
			if ( substr(gfn_getCurrDate(),0,4) < substr(ds_header.getcolumn(0, "DELDAT"),0, 4))
			{
				gfn_showAlert("CW10025", "납기예정일이 전년도입니다 변경바랍니다.");
			}
		} else if (strColumnId=="ZSUM_GSHANG") { //목표 시행율 		
/*
			trace("!!!!~~~!!!!!");
			//목표시행율에따라 MO 견적가 자동계산 
			for (var i = 0; i < ds_detail.GetRowCount(); i++)	{
				if ( toNumber(ds_detail.GetColumn(i, "ZCOST")) <> "") {
					ds_detail.SetColumn(i, "ZEAM") = toNumber(ds_detail.GetColumn(i, "ZCOST")) / toNumber(ed_gsum)
				}
			}
			obj.OnColumnChanged = "ds_detail_OnColumnChanged";
*/
		}
	}
}

function ds_header_OnRowPosChanged(obj,nOldRow,nRow) {
//trace("************8");
	if (obj.GetColumn(nOldRow, "FLAG") <> "U") return;  // 변경된 행만 체크	

	//if (ChgYn == "N") gfn_SetDatasetChgFlag(obj, nOldRow); // 변경된 자료가 없으면 선택여부,변경구분 초기화
}

function ds_detail_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex) {
//trace("************9");
	obj.OnColumnChanged = "";
	obj.CanRowPosChange = "";

	var nCol   = tab.main.div_header.grd_detail.GetCellPos();  // 현재 컬럼번호
	var cId    = strColumnId;
	var atkla  = "";
	var prh    = "";
	var prd    = "";
	var matnr     = ds_detail.GetColumn(nRow, "MATNR"  );
	var zeam      = ds_detail.GetColumn(nRow, "ZEAM"   );
	var zuam      = ds_detail.GetColumn(nRow, "ZUAM"   );
	var zcost     = ds_detail.GetColumn(nRow, "ZCOST"  );
	var znumber   = ds_detail.GetColumn(nRow, "ZNUMBER");
	var qtseq     = ds_detail.GetColumn(nRow, "QTSEQ"  );
	var filterStr = "";
	var shang     = 0;
	var searchRow = 0;

	if (varNewValue != varOldValue) { 	// 값이 변경되었을 경우 변경구분 컬럼 자동 SET 
		obj.SetColumn(nRow, "CHK" , "1");
		gfn_changeFlag( obj, strColumnID, nRow, "FLAG"); // FLAG 변경 : U
		F_CHG_DETAIL_COLNUM = nCol; // 현재 컬럼번호
		F_CHG_DETAIL_ROWNUM = nRow;	// 현재 행번호

		btn_count.Visible        = false;
		btn_countRequest.Visible = false; // 
		btn_part.Visible         = false; // 
		btn_estimate.Visible     = false;
		
		if (cId=="ZSAREA" || cId=="GTYPE" || cId=="ZUSE" || cId=="ZACAPA" || cId=="ZLEN" || cId=="ZOPN" || cId=="TYPE1" || cId=="TYPE2" || cId=="TYPE3") {

			if (zprdgbn == "AP_01") // (2012.12.10)
			{
				filterStr = "QTSEQ ==" + quote(qtseq) + " && ATKLA ==" + quote("AP_BASIC") + " && PRH == ";
				
				switch (cId) {
					case "GTYPE"  : prh = "AP_ATYP"; break;
					case "ZUSE"   : prh = "AP_AMOD" ; break;
					case "TYPE1"  : prh = "AP_AEA"; break;
					case "ZACAPA" : prh = "AP_ACS" ; break;
					case "TYPE2"  : prh = "AP_AQL" ; break;
					case "TYPE3"  : prh = "AP_AQC" ; break;
					case "ZLEN"   : prh = "AP_AQT" ; break;
					case "ZOPN"   : prh = "AP_AETS"; break;
					default       : break;
				}
			
			}
			else if (zprdgbn == "PSD_01") // (2012.12.10)
			{
				filterStr = "QTSEQ ==" + quote(qtseq) + " && ATKLA ==" + quote("PSD_BASIC") + " && PRH == ";
				
				switch (cId) {
					case "GTYPE"  : prh = "PSD_AFORM1"; break;
					case "ZUSE"   : prh = "PSD_ANAME" ; break;
					default       : break;
				}
			}

			prd = ds_detail.GetColumn(nRow, cId);
			searchRow = ds_template1.SearchRow(filterStr + quote(prh));
			ds_template1.SetColumn(searchRow, "PRD" , prd);
			ds_template1.SetColumn(searchRow, "FLAG", "U");

			// 국내 SSVF 선택시 적용코드 EN81로 적용 20131017 BY SEONHOWORLD
		/*	if ( cId == "GTYPE" || cId == "ZSAREA" )
			{
			   if ( gtype == "SSVF" && zsarea == "D" )
			   {    
			        prh = "EL_ACD2";
					prd = "EN81";
					searchRow = ds_template1.SearchRow(filterStr + quote(prh));
					ds_template1.SetColumn(searchRow, "PRD" , prd);
					ds_template1.SetColumn(searchRow, "FLAG", "U");
			   }
			}*/
			
			// 2013.05.29 추가 (설계부 요청사항)START
			// 기종, 용도, 인승, 용량, Door open type, 속도, 층수, 정지층수가 변경되면 EL_ECCH를 0으로 변경
			if (cId != "ZSAREA")	{
				// 승강기의 경우에만 적용
				if (zprdgbn == "ELV_01" || zprdgbn == "ELV_02" || zprdgbn == "SHN_01") {

					var vFilter5Str = "QTSEQ ==" + quote(qtseq) + " && ATKLA ==" + quote("EL_LAYOUT") + " && PRH == " + quote("EL_ECCH");

					// Layout의 CAR : CH의 값을 0으로 변경 처리
					var vSearch5Row = ds_template5.SearchRow(vFilter5Str);
					if (vSearch5Row == -1)	{
						// 필터된 정보에서 처리
						vSearch5Row = ds_template5.SearchRowNF(vFilter5Str);
						ds_template5.SetColumnNF(vSearch5Row, "PRD" , "0");
						ds_template5.SetColumnNF(vSearch5Row, "FLAG", "U");
					}else	{
						ds_template5.SetColumn(vSearch5Row, "PRD" , "0");
						ds_template5.SetColumn(vSearch5Row, "FLAG", "U");
					}

					if (vSearch5Row == -1 && (cId == "TYPE3" || cId == "ZLEN"))	{
						// 필터된 정보에서 처리 시 전체 정보에서도 변경
						vSearch5Row = ds_template.SearchRow(vFilter5Str);
						ds_template.SetColumn(vSearch5Row, "PRD" , "0");
						ds_template.SetColumn(vSearch5Row, "FLAG", "U");
					}
				}
			}
			
			// 2013.05.29 추가 (설계부 요청사항) END

		} else if (strColumnId == "ZNUMBER") {

			var ds_h = object(ds_header.ID);

			fn_bclcd("", "", "", "", 0, 0, 0, 0, ds_h); // LCD 총 수량
			fn_bcpi ("", "", "", "", "", "", "", 0, 0, 0, 0, ds_h); // LED 총 수량
			fn_deph ("", "", "", 0, 0, 0, 0, ds_h); // 비상통화장치 DI-PBX 적용대수
			fn_ddvr ("", "", "", 0, 0, 0, 0, ds_h); // DVR 적용대수
			//fn_drvhq("", "", "", 0, 0, 0, 0, ds_h); // 행선층 예약시스템 적용대수 - 2012.01.15 삭제
			fn_dsv1 ("", "", "", 0, 0, 0, 0, ds_h); // 감시반1
			fn_dsv2 ("", "", "", 0, 0, 0, 0, ds_h); // 감시반2
			
			//trace(matnr);
			// 2013.02.20 주차 - 대수 변경시 원가 재계산
			if ( zprdgbn == "AP_01" || zprdgbn == "PSD_01" || matnr = "F-1000") {
				ds_detail.SetColumn(nRow, "ZCOST", toNumber(ds_detail.GetColumn(nRow, "ZNUMBER")) * toNumber(ds_detail.GetColumn(nRow, "ZUAM")));
				zcost = ds_detail.GetColumn(nRow, "ZCOST");		//계산된 원가 
			}// 2013.03.19 대수 변경 시 금액 재 산출
			else	{
				ds_detail.SetColumn(nRow, "ZCOST", toNumber(ds_detail.GetColumn(nRow, "ZNUMBER")) * toNumber(ds_detail.GetColumn(nRow, "ZUAM")));
				zcost = ds_detail.GetColumn(nRow, "ZCOST");		//계산된 원가 
			}

			fn_shang(nRow, zeam, zuam, znumber, shang, zcost); // 시행율
			
			fn_applayHeaderCost(); // detail 합계를 header에 반영
			
		} else if (strColumnId == "FLAG") {

			if ( varOldValue == "D" ) { // 2012.01.15 삭제했던 MO 다시 살릴 때
				var ds_h = object(ds_header.ID);

				fn_bclcd("", "", "", "", 0, 0, 0, 0, ds_h); // LCD 총 수량
				fn_bcpi ("", "", "", "", "", "", "", 0, 0, 0, 0, ds_h); // LED 총 수량
				fn_deph ("", "", "", 0, 0, 0, 0, ds_h); // 비상통화장치 DI-PBX 적용대수
				fn_ddvr ("", "", "", 0, 0, 0, 0, ds_h); // DVR 적용대수
				//fn_drvhq("", "", "", 0, 0, 0, 0, ds_h); // 행선층 예약시스템 적용대수 - 2012.01.15 삭제
				fn_dsv1 ("", "", "", 0, 0, 0, 0, ds_h); // 감시반1
				fn_dsv2 ("", "", "", 0, 0, 0, 0, ds_h); // 감시반2
				fn_aspd();								// 고속현장 2013.04.03
			}

		} else if ( strColumnId == "ZUAM" ) { // 단가
			
			// 2012.01.16 S/P 단가 변경시 원가 계산
			if ( matnr == "Y-1000" || matnr == "Y-200" || matnr == "Y-300" || matnr == "L-1100" || matnr == "L-1200") {		
				//원가계산
				ds_detail.SetColumn(nRow, "ZCOST", toNumber(ds_detail.GetColumn(nRow, "ZNUMBER")) * toNumber(ds_detail.GetColumn(nRow, "ZUAM"))); 
				var zcost     = ds_detail.GetColumn(nRow, "ZCOST"  );	//계산된 원가 
				fn_shang(nRow, zeam, zuam, znumber, shang, zcost); 		// 시행율
			}

			// 2013.02.20 주차 - 단가 변경시 원가/시행율 재계산   // psd 추가 2013.03.30
			if ( zprdgbn == "AP_01" ) { //( zprdgbn == "AP_01" || zprdgbn == "PSD_01" ) {
				ds_detail.SetColumn(nRow, "ZCOST", toNumber(ds_detail.GetColumn(nRow, "ZNUMBER")) * toNumber(ds_detail.GetColumn(nRow, "ZUAM")));
				zcost = ds_detail.GetColumn(nRow, "ZCOST");			// 계산된 원가 
				fn_shang(nRow, zeam, zuam, znumber, shang, zcost);	// 시행율
			}
			
			if ( matnr = "F-1000" || zprdgbn == "PSD_01" ) {
				ds_detail.SetColumn(nRow, "ZCOST", toNumber(ds_detail.GetColumn(nRow, "ZUAM")));
				zcost = ds_detail.GetColumn(nRow, "ZCOST");			// 계산된 원가 
				fn_shang(nRow, zeam, zuam, znumber, shang, zcost);	// 시행율
			}

			fn_applayHeaderCost(); // detail 합계를 header에 반영
			
		} else if ( strColumnId == "ZCOST" ) { // 원가
			fn_shang(nRow, zeam, zuam, znumber, shang, zcost);
			fn_applayHeaderCost(); // detail 합계를 header에 반영
			
		} else if ( strColumnId == "ZEAM" ) { // 견적가
		
			fn_shang(nRow, zeam, zuam, znumber, shang, zcost); // 시행율
			fn_applayHeaderCost(); // detail 합계를 header에 반영
		
		} else if (strColumnId == "SHANGH" && G_LANG == "en") {

			ds_template.UnFilter();
			ds_template.Filter("QTSEQ !=" + quote(qtseq)); ds_temp.CopyF(ds_template); ds_template.Copy(ds_temp);

			zprdgbn = ds_detail.GetColumn(nRow, "ZPRDGBN");
			matnr   = ds_detail.GetColumn(nRow, "MATNR"  );

			if (varNewValue == "상해" || varNewValue == "상해_E") {
				if      (zprdgbn == "ELV_01" || "ELV_02") zprdgbn = "SHN_01";
				else if (zprdgbn == "ESC_01")             zprdgbn = "SHN_02";
			} else {
				searchRow = ds_class.FindRow("MATNR"    , matnr);
				zprdgbn   = ds_class.GetColumn(searchRow, "CLASS_CD");
			}

			ds_detail.SetColumn(nRow, "ZPRDGBN", zprdgbn);

			ds_cond.ClearData();
			ds_cond.AddRow();
			ds_cond.SetColumn(0, "MANDT" , ds_header.GetColumn(0, "MANDT"));
			ds_cond.SetColumn(0, "QTNUM" , ds_header.GetColumn(0, "QTNUM"));
			ds_cond.SetColumn(0, "QTSER" , ds_header.GetColumn(0, "QTSER"));
			ds_cond.SetColumn(0, "QTSEQ" , qtseq);
			ds_cond.SetColumn(0, "MCLASS", zprdgbn);

			nsfRequest("queryTemplateAdd", "ses0031/searchTemplate", "ds_detail=ds_cond ds_template=ds_template_add", "ds_template_add=ds_template ds_error=ds_error", "", "fn_afterQuery");
		}
	}

	obj.OnColumnChanged = "ds_detail_OnColumnChanged";
	obj.CanRowPosChange = "ds_detail_CanRowPosChange";
}

function ds_detail_OnRowPosChanged(obj,nOldRow,nRow) {
//trace("************10");
	if (obj.GetColumn(nOldRow, "FLAG") <> "U") 
		return;  // 변경된 행만 체크

	//if (ChgYn == "N")
	//	gfn_SetDatasetChgFlag(obj, nOldRow); // 변경된 자료가 없으면 선택여부,변경구분 초기화
}

function ds_detail_CanRowPosChange(obj,nOldRow,nRow) {
//trace("************11");
	//fn_template("C", nRow); // 2013.02.01 fn_template 호출 위치를 그리드 클릭이벤트로 변경
}

function ds_template_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex) {
//trace("************12");
	if (varNewValue != varOldValue) { 	// 값이 변경되었을 경우 변경구분 컬럼 자동 SET 

		var obj_flag = obj.GetColumn(nRow, "FLAG" );
		var atkla    = obj.GetColumn(nRow, "ATKLA");
		var prd      = obj.GetColumn(nRow, "PRD"  );
		var prh      = obj.GetColumn(nRow, "PRH"  );
		//var userRow  = ds_detail.currow;
		//var qtseq    = ds_detail.GetColumn(userRow, "QTSEQ");
		var qtseq    = obj.GetColumn(nRow, "QTSEQ"); // 2013.02.01 수정
		var chk_flag = "";
		var ds_h     = object(ds_header.ID);
		var obj_user;

		// 2013.01.02 사양 탭내에서 사양 변경시 ds_template 에도 변경 사항 적용
		ds_template.UnFilter();		// 2013.01.16 원가산출등에서 필터로 인한 오동작으로 추가
		var nTmplRow = ds_template.SearchRow(" QTSEQ == " + quote(qtseq) + " && ATKLA == " + quote(atkla) + " && PRH == " + quote(prh));
		if ( nTmplRow > -1 ) {
			ds_template.SetColumn(nTmplRow, "PRD" , prd);
			ds_template.SetColumn(nTmplRow, "FLAG", "U");

			if (F_GRID_SELECT == "Y")	{	// 변경된 값이 존재하는 경우 2013.01.09
				btn_count.Visible = false; // 원가산출버튼 비활성화 -> 저장후에 원가 산출 할 수 있음
				F_GRID_SELECT = "";
			}
		}

		switch (obj.GetID()) {
//			case "ds_template0"	: obj_user = object(ds_user0.ID); break;
			case "ds_template1"	: obj_user = object(ds_user1.ID); break;
			case "ds_template2"	: obj_user = object(ds_user2.ID); break;
			case "ds_template3"	: obj_user = object(ds_user3.ID); break;
			case "ds_template4"	: obj_user = object(ds_user4.ID); break;
			case "ds_template5"	: obj_user = object(ds_user5.ID); break;
			default : break;
		}

		if (obj.GetID() != "ds_template0") {

			obj.OnColumnChanged = "";

			var searchRow = obj_user.searchRow("ATKLA ==" + quote(atkla) + " && PRH ==" + quote(prh) + " && QTSEQ ==" + quote(qtseq));
			
			if (searchRow == -1) {
				obj_user.addRow();
				obj_user.CopyRow(obj_user.currow, obj, nRow);
				searchRow = obj_user.currow;
			}
			var user_prd  = obj_user.GetColumn(searchRow, "PRD");

			if (prd != null && prd != "" ) {
				if (prd != user_prd) {
					obj_user.SetColumn(searchRow, "FLAG", "U");
					obj_user.SetColumn(searchRow, "PRD", prd);
					obj.SetColumn(nRow, "PRD", prd);
					if (obj_flag == "I") obj.SetColumn(nRow, "FLAG", "I");
					else                 chk_flag = "Y";
				}
			} else {
				if (obj_flag == "I") {
					obj.SetColumn(nRow, "FLAG", "I");
					obj_user.SetColumn(searchRow, "PRD", prd);
				} else {
					chk_flag = "Y";
					if (prd == null || prd == "") user_prd = prd;
					obj_user.SetColumn(searchRow, "FLAG", "U");
					obj_user.SetColumn(searchRow, "PRD", prd);
					obj.SetColumn(nRow, "PRD", user_prd);
				}
			}

			if (chk_flag == "Y") {
				obj.SetColumn(nRow, "CHK" , "1");
				gfn_changeFlag( obj, strColumnID, nRow, "FLAG"); // FLAG 변경 : U
			}

			switch (obj.GetID()) {
				case "ds_template1"	:
					if (atkla == "EL_BASIC" && prh == "EL_ASPC") fn_aspc("", "", "", 0, 0, 0, 0, ds_h); // 시방서
					if (atkla == "ES_BASIC" && prh == "ES_ASPC") fn_aspc("", "", "", 0, 0, 0, 0, ds_h); // 시방서 2012.01.15 추가
					if (atkla == "MW_BASIC" && prh == "MW_ASPC") fn_aspc("", "", "", 0, 0, 0, 0, ds_h); // 시방서 2012.01.15 추가
					if (atkla == "EL_BASIC" && prh == "EL_ASPD") fn_aspd(); 							// 고속현장 2013.04.03
					/*if (atkla == "EL_BASIC" && prh == "EL_ASPLY") {  //일식외주 품목데이터에 표현 by 강슬기
						var nRow = ds_detail.SearchRow(" QTSEQ == " + quote(qtseq));
						ds_detail.SetColumn(nRow,"ZOUTC",prd);
					}*/					// 고속현장 2013.04.03
					if (prh == "SP_AUSE") {  //SP 용도 품목데이터 표현 BY 김선호 20131112
						var nRow = ds_detail.SearchRow(" QTSEQ == " + quote(qtseq));
						ds_detail.SetColumn(nRow,"ZUSE",prd);
					}
					if ( (prh == "ES_ASTD" && prd == "Y") || (prh == "MW_ASTD" && prd == "Y") ) 
						fn_astd(""); // ES/MW 사양 자동입력건 20131021
					break;
				case "ds_template2"	:
					if (atkla == "EL_INSIDE") {
						switch (prh) {
							case "EL_BCPI"  : fn_bcpi("", "", "", "", "", "", "", 0, 0, 0, 0, ds_h); break; // LED 총 수량
							case "EL_BCLCD" : fn_bclcd("", "", "", "", 0, 0, 0, 0, ds_h); break;
							default         : break;
						}
					} else if (atkla == "ES_OPTION") { // 2013.02.05 추가
						switch (prh) {
							case "ES_DSV1"  : fn_dsv1 ("", "", "", 0, 0, 0, 0, ds_h); break; // 감시반1
							case "ES_DSV2"  : fn_dsv2 ("", "", "", 0, 0, 0, 0, ds_h); break; // 감시반2
							default         : break;
						}
					} else if (atkla == "MW_OPTION") { // 2013.02.05 추가
						switch (prh) {
							case "MW_DSV1"  : fn_dsv1 ("", "", "", 0, 0, 0, 0, ds_h); break; // 감시반1
							case "MW_DSV2"  : fn_dsv2 ("", "", "", 0, 0, 0, 0, ds_h); break; // 감시반2
							default         : break;
						}
					}
					
					if (prh == "EL_BMDL" && prd != "")  
						fn_bmdl(prd); // 신형 MRL 사양 자동 입력 건 20140327 김선호 
					break;

				case "ds_template3"	:
					if (atkla == "EL_OUTSIDE") {
						switch (prh) {
							case "EL_CHLCD" : fn_bclcd("", "", "", "", 0, 0, 0, 0, ds_h); break; // LCD 총 수량
							default :
								if (prh == "EL_CHPI1" || prh == "EL_CHPI2" || prh == "EL_CHPI3" || prh == "EL_CHPI4") {
									fn_bcpi("", "", "", "", "", "", "", 0, 0, 0, 0, ds_h); // LED 총 수량
								} break;
						}
					} break;

				case "ds_template4"	:
					if (atkla == "EL_OPTION") {
						switch (prh) {
							case "EL_DEPH"  : fn_deph ("", "", "", 0, 0, 0, 0, ds_h); break; // 비상통화장치 DI-PBX 적용대수
							case "EL_DDVR"  : fn_ddvr ("", "", "", 0, 0, 0, 0, ds_h); break; // DVR 적용대수
							//case "EL_DRVHQ" : fn_drvhq("", "", "", 0, 0, 0, 0, ds_h); break; // 행선층 예약시스템 적용대수  - 2012.01.15 삭제
							case "EL_DSV1"  : fn_dsv1 ("", "", "", 0, 0, 0, 0, ds_h); break; // 감시반1
							case "EL_DSV2"  : fn_dsv2 ("", "", "", 0, 0, 0, 0, ds_h); break; // 감시반2
							default         : break;
						}
					} else if (atkla == "ES_OPTION") { // 2012.01.15 추가
						switch (prh) {
							case "ES_DSV1"  : fn_dsv1 ("", "", "", 0, 0, 0, 0, ds_h); break; // 감시반1
							case "ES_DSV2"  : fn_dsv2 ("", "", "", 0, 0, 0, 0, ds_h); break; // 감시반2
							default         : break;
						}
					} else if (atkla == "MW_OPTION") { // 2012.01.15 추가
						switch (prh) {
							case "MW_DSV1"  : fn_dsv1 ("", "", "", 0, 0, 0, 0, ds_h); break; // 감시반1
							case "MW_DSV2"  : fn_dsv2 ("", "", "", 0, 0, 0, 0, ds_h); break; // 감시반2
							default         : break;
						}
					}
					break;

				default : break;
			}
            
            
			obj.OnColumnChanged = "ds_template_OnColumnChanged";
		}
	}
}

// BMDL 값에 따른 사양 자동입력 fuction 20140327 김선호 
function fn_bmdl(prd) {  

    var spec ;
	qtseq  = ds_detail.GetColumn(ds_detail.currow, "QTSEQ");	
	
	var strFilterPrh2 = "QTSEQ=="+quote(qtseq)+
						"&&(PRH=="+quote("EL_BCL")+"||PRH=="+quote("EL_BHR")+"||PRH=="+quote("EL_BFR")+
						"||PRH=="+quote("EL_BCDM")+"||PRH=="+quote("EL_BCPI")+"||PRH=="+quote("EL_BMOPB")+")";
	var strFilterPrh3 =  "QTSEQ=="+quote(qtseq)+
						"&&(PRH=="+quote("EL_CHD1")+"||PRH=="+quote("EL_CHD2")+")";
						
	ds_template2.UnFilter();
	ds_template3.UnFilter();
	
	ds_template2.Filter(strFilterPrh2);
	ds_template3.Filter(strFilterPrh3);
    
	for (var i = 0 ; i < ds_template2.GetRowCount(); i++)	{
        ds_template2.SetColumn(i, "FLAG", "U");
	    spec = ds_template2.GetColumn(i,"PRH"); 
	    switch (prd){
			case "NYSB"  : 
				switch(spec){
					case "EL_BCL"   : ds_template2.SetColumn(i, "PRD", "CD199B"); break;
					case "EL_BHR"   : ds_template2.SetColumn(i, "PRD", "1FG"); break;
					case "EL_BFR"   : ds_template2.SetColumn(i, "PRD", "PV"); break;
					case "EL_BCDM"  : ds_template2.SetColumn(i, "PRD", "ARTMTL_SVR"); break;
					case "EL_BCPI"  : ds_template2.SetColumn(i, "PRD", "L210"); break;
					case "EL_BMOPB" : ds_template2.SetColumn(i, "PRD", "N362"); break;
					default       : break;					
				}
				break;
			case "NYSZ"  : 
				switch(spec){
					case "EL_BCL"   : ds_template2.SetColumn(i, "PRD", "CD199A"); break;
					case "EL_BHR"   : ds_template2.SetColumn(i, "PRD", "1FW"); break;
					case "EL_BFR"   : ds_template2.SetColumn(i, "PRD", "PV"); break;
					case "EL_BCDM"  : ds_template2.SetColumn(i, "PRD", "ARTMTL_BRZ"); break;
					case "EL_BCPI"  : ds_template2.SetColumn(i, "PRD", "L210"); break;
					case "EL_BMOPB" : ds_template2.SetColumn(i, "PRD", "N362"); break;
					default       : break;
				}
				break;
			case "NYSG"  : 
				switch(spec){
					case "EL_BCL"   : ds_template2.SetColumn(i, "PRD", "CD199A"); break;
					case "EL_BHR"   : ds_template2.SetColumn(i, "PRD", "1FW"); break;
					case "EL_BFR"   : ds_template2.SetColumn(i, "PRD", "PV"); break;
					case "EL_BCDM"  : ds_template2.SetColumn(i, "PRD", "ARTMTL_GLD"); break;
					case "EL_BCPI"  : ds_template2.SetColumn(i, "PRD", "L210"); break;
					case "EL_BMOPB" : ds_template2.SetColumn(i, "PRD", "N362"); break;
					default       : break;
				}
				break;
			case "NYSS"  : 
				switch(spec){
					case "EL_BCL"   : ds_template2.SetColumn(i, "PRD", "CD191A"); break;
					case "EL_BHR"   : ds_template2.SetColumn(i, "PRD", "1FG"); break;
					case "EL_BFR"   : ds_template2.SetColumn(i, "PRD", "PV"); break;
					case "EL_BCDM"  : ds_template2.SetColumn(i, "PRD", "ARTMTL_SVR"); break;
					case "EL_BCPI"  : ds_template2.SetColumn(i, "PRD", "L210"); break;
					case "EL_BMOPB" : ds_template2.SetColumn(i, "PRD", "N362"); break;
					default       : break;
				}
				break;
			case "NYDB"  : 
				switch(spec){
					case "EL_BCL"   : ds_template2.SetColumn(i, "PRD", "CD399A"); break;
					case "EL_BHR"   : ds_template2.SetColumn(i, "PRD", "1LB"); break;
					case "EL_BFR"   : ds_template2.SetColumn(i, "PRD", "PV"); break;
					case "EL_BCDM"  : ds_template2.SetColumn(i, "PRD", "ARTMTL_BLK"); break;
					case "EL_BCPI"  : ds_template2.SetColumn(i, "PRD", "L210"); break;
					case "EL_BMOPB" : ds_template2.SetColumn(i, "PRD", "N462"); break;
					default       : break;
				}
				break;
			case "NYDZ"  : 
				switch(spec){
					case "EL_BCL"   : ds_template2.SetColumn(i, "PRD", "CD319A"); break;
					case "EL_BHR"   : ds_template2.SetColumn(i, "PRD", "1LB"); break;
					case "EL_BFR"   : ds_template2.SetColumn(i, "PRD", "PV"); break;
					case "EL_BCDM"  : ds_template2.SetColumn(i, "PRD", "ARTMTL_BRZ"); break;
					case "EL_BCPI"  : ds_template2.SetColumn(i, "PRD", "L210"); break;
					case "EL_BMOPB" : ds_template2.SetColumn(i, "PRD", "N462"); break;
					default       : break;
				}
				break;
			default      : break;
	    }
	}	
	
	for (var i = 0 ; i < ds_template3.GetRowCount(); i++)	{   //HATCH DOOR  사양 자동 결정 
	    ds_template3.SetColumn(i, "FLAG", "U");
	    spec = ds_template3.GetColumn(i,"PRH"); 
		switch (prd) {
			case "NYSB"  : ds_template3.SetColumn(i, "PRD", "ARTMTL_SVR"); break;
			case "NYSZ"  : ds_template3.SetColumn(i, "PRD", "ARTMTL_BRZ"); break;
			case "NYSG"  : ds_template3.SetColumn(i, "PRD", "ARTMTL_GLD"); break;
			case "NYSS"  : ds_template3.SetColumn(i, "PRD", "ARTMTL_SVR"); break;
			case "NYDB"  : 
				switch(spec){
					case "EL_CHD1" : ds_template3.SetColumn(i, "PRD", "GLASTL_ART"); break;
					case "EL_CHD2" : ds_template3.SetColumn(i, "PRD", "ARTMTL_BLK"); break;
					default        : break;
			} break;
			case "NYDZ"  : 
				switch(spec){
					case "EL_CHD1" : ds_template3.SetColumn(i, "PRD", "GLASTL_ART"); break;
					case "EL_CHD2" : ds_template3.SetColumn(i, "PRD", "ARTMTL_BRZ"); break;
					default        : break;
			} break;
			default      : break;
		}								
	}

	ds_template2.UnFilter();
	ds_template3.UnFilter();
	
	ds_template2.Filter("qtseq=="+quote(qtseq));
	ds_template3.Filter("qtseq=="+quote(qtseq));
	
}

function fn_astd(qtseq) {

	qtseq  = ds_detail.GetColumn(ds_detail.currow, "QTSEQ");
	
	var strFilterPrh1 = "QTSEQ=="+quote(qtseq)+
						"&&(PRH=="+quote("ES_ATFRC")+"||PRH=="+quote("MW_ATFRC")+")";
	var strFilterPrh2 = "QTSEQ=="+quote(qtseq)+
						"&&(PRH=="+quote("ES_BCS")+"||PRH=="+quote("ES_BAB")+
						"||PRH=="+quote("MW_BCS")+"||PRH=="+quote("MW_BAP")+")";
	var strFilterPrh3 =  "QTSEQ=="+quote(qtseq)+
						"&&(PRH=="+quote("ES_CCOML")+"||PRH=="+quote("ES_CUSL")+"||PRH=="+quote("ES_CHRS")+
						"||PRH=="+quote("ES_CBSS")+"||PRH=="+quote("ES_CSMS")+"||PRH=="+quote("ES_CBODETS")+
						"||PRH=="+quote("MW_CCOML")+"||PRH=="+quote("MW_CUPL")+"||PRH=="+quote("MW_CHRS")+
						"||PRH=="+quote("MW_CBPS")+"||PRH=="+quote("MW_CSMS")+"||PRH=="+quote("MW_CBODETS")+")";
						
	ds_template1.UnFilter();
	ds_template2.UnFilter();
	ds_template3.UnFilter();
	
	ds_template1.Filter(strFilterPrh1);
	ds_template2.Filter(strFilterPrh2);
	ds_template3.Filter(strFilterPrh3);
     
    
	create("dataset", "ds_temp2");
	ds_temp2.copyF(ds_template3);
    
		
	for (var i = 0 ; i < ds_template1.GetRowCount(); i++)	{
		ds_template1.SetColumn(i, "PRD", "Y");
	}	
	for (var i = 0 ; i < ds_template2.GetRowCount(); i++)	{
		ds_template2.SetColumn(i, "PRD", "Y");
	}	
	for (var i = 0 ; i < ds_template3.GetRowCount(); i++)	{
		ds_template3.SetColumn(i, "PRD", "Y");
	}

	ds_template1.UnFilter();
	ds_template2.UnFilter();
	ds_template3.UnFilter();
	
	ds_template1.Filter("qtseq=="+quote(qtseq));
	ds_template2.Filter("qtseq=="+quote(qtseq));
	ds_template3.Filter("qtseq=="+quote(qtseq));
	
}

function fn_shang(nRow, zeam, zuam, znumber, shang, zcost) { // 시행율
//trace("************13");
	if (ParseInt(zeam) == 0) {
		shang = 0;
	} else {
		shang = ParseFloat(zcost) * 100 / ParseFloat(zeam);

		if (shang >= 999) shang = 999;
		else              shang = Round(shang, 1);
	}
	ds_detail.OnColumnChanged = "";
	ds_detail.SetColumn(nRow, "SHANG", shang);
	ds_detail.SetColumn(nRow, "FLAG", "U"   );
	ds_detail.OnColumnChanged = "ds_detail_OnColumnChanged";
}

function fn_aspc(prd_co, prd_max, qtseq_co, cnt_co, searchRow, znumber, znumber_sum, ds_h) { // 시방서
//trace("************14");
	var strFilterPrh = "PRH=="+quote("EL_ASPC")+"||PRH=="+quote("ES_ASPC")+"||PRH=="+quote("MW_ASPC");

	ds_user1.UnFilter();
	ds_user1.Filter(strFilterPrh);

	qtseq_co  = ds_detail.GetColumn(ds_detail.currow, "QTSEQ");
	searchRow = ds_user1.searchRow("QTSEQ=="+quote(qtseq_co)+"&& ("+strFilterPrh+")");

	prd_co    = ds_user1.GetColumn(searchRow, "PRD");
	for (var i = 0 ; i < ds_user1.GetRowCount(); i++)	{
		ds_user1.SetColumn(i, "PRD", prd_co);
	}

	ds_user1.UnFilter();
	ds_h.SetColumn(0, "CO_ASPC", prd_co);
}

function fn_bclcd(prd_co, prd_co2, prd_max, qtseq_co, cnt_co, searchRow, znumber, znumber_sum, ds_h) { // LCD 총 수량
//trace("************15");
	ds_user2.UnFilter(); ds_user2.Filter("PRH == " + quote("EL_BCLCD"));
	ds_user3.UnFilter(); ds_user3.Filter("PRH == " + quote("EL_CHLCD"));

	for (var i=0; i<ds_detail.GetRowCount(); i++) {
		if ( ds_detail.GetColumn(i, "FLAG") == "D" ) continue; // 2012.01.15 삭제된 행은 계산안함
		
		qtseq_co  = ds_detail.GetColumn(i, "QTSEQ");
		searchRow = ds_user2.searchRow("PRH =="+quote("EL_BCLCD")+" && QTSEQ == "+quote(qtseq_co));
		prd_co    = trim(ds_user2.GetColumn(searchRow, "PRD"));

		searchRow = ds_user3.searchRow("PRH =="+quote("EL_CHLCD")+" && QTSEQ == "+quote(qtseq_co));
		prd_co2   = trim(ds_user3.GetColumn(searchRow, "PRD"));

		znumber   = ParseInt(ds_detail.GetColumn(i, "ZNUMBER")); // 대수
		if (Length(prd_co) > 0 || Length(prd_co2) > 0) znumber_sum = ParseInt(znumber_sum) + znumber;
	}
	ds_user2.UnFilter();
	ds_user3.UnFilter();

	if (znumber_sum > 0) ds_h.SetColumn(0, "CO_BCLCDTQ", znumber_sum);
	else 				 ds_h.SetColumn(0, "CO_BCLCDTQ", ""         );
}

function fn_bcpi(prd_co, prd_co2, prd_co3, prd_co4, prd_co5, prd_max, qtseq_co, cnt_co, searchRow, znumber, znumber_sum, ds_h) { // LED 총 수량
//trace("************16");
	ds_user2.UnFilter(); ds_user2.Filter("PRH == " + quote("EL_BCPI"));
	ds_user3.UnFilter(); ds_user3.Filter("Substr(PRH,0,7)==" + quote("EL_CHPI"));

	for (var i=0; i<ds_detail.GetRowCount(); i++) {
		if ( ds_detail.GetColumn(i, "FLAG") == "D" ) continue; // 2012.01.15 삭제된 행은 계산안함
		
		qtseq_co  = ds_detail.GetColumn(i, "QTSEQ");
		searchRow = ds_user2.searchRow("PRH =="+quote("EL_BCPI")+" && QTSEQ == "+quote(qtseq_co));
		prd_co    = ds_user2.GetColumn(searchRow, "PRD");

		searchRow = ds_user3.searchRow("PRH =="+quote("EL_CHPI1")+" && QTSEQ == "+quote(qtseq_co));
		prd_co2   = ds_user3.GetColumn(searchRow, "PRD");

		searchRow = ds_user3.searchRow("PRH =="+quote("EL_CHPI2")+" && QTSEQ == "+quote(qtseq_co));
		prd_co3   = ds_user3.GetColumn(searchRow, "PRD");

		searchRow = ds_user3.searchRow("PRH =="+quote("EL_CHPI3")+" && QTSEQ == "+quote(qtseq_co));
		prd_co4   = ds_user3.GetColumn(searchRow, "PRD");

		searchRow = ds_user3.searchRow("PRH =="+quote("EL_CHPI4")+" && QTSEQ == "+quote(qtseq_co));
		prd_co5   = ds_user3.GetColumn(searchRow, "PRD");

		znumber   = ParseInt(ds_detail.GetColumn(i, "ZNUMBER")); // 대수
		if ( (prd_co == "L12" || prd_co == "L24")
			|| (prd_co2 == "L12" || prd_co2 == "L24")
			|| (prd_co3 == "L12" || prd_co3 == "L24")
			|| (prd_co4 == "L12" || prd_co4 == "L24")
			|| (prd_co5 == "L12" || prd_co5 == "L24")
		) {
			znumber_sum = ParseInt(znumber_sum) + znumber;
		}
	}
	ds_user2.UnFilter();
	ds_user3.UnFilter();

	if (znumber_sum > 0) ds_h.SetColumn(0, "CO_CHPITQ", znumber_sum);
	else 				 ds_h.SetColumn(0, "CO_CHPITQ", ""         );
}

function fn_deph(prd_co, prd_max, qtseq_co, cnt_co, searchRow, znumber, znumber_sum, ds_h) { // 비상통화장치 DI-PBX 적용대수
//trace("************17");
	ds_user4.UnFilter(); ds_user4.Filter("PRH == " + quote("EL_DEPH"));

	for (var i=0; i<ds_detail.GetRowCount(); i++) {
		if ( ds_detail.GetColumn(i, "FLAG") == "D" ) continue; // 2012.01.15 삭제된 행은 계산안함
	
		qtseq_co  = ds_detail.GetColumn(i, "QTSEQ");
		searchRow = ds_user4.searchRow("PRH=="+quote("EL_DEPH")+" && (PRD=="+quote("DI")+"||PRD=="+quote("DILP")+"||PRD=="+quote("HYBRIDW")+"||PRD=="+quote("HYBRIDWL")+") && QTSEQ=="+quote(qtseq_co));
		prd_co    = ds_user4.GetColumn(searchRow, "PRD");
		znumber   = ParseInt(ds_detail.GetColumn(i, "ZNUMBER")); // 대수
		if (prd_co == "DI"||prd_co == "DILP"||prd_co == "HYBRIDW"||prd_co == "HYBRIDWL") znumber_sum = ParseInt(znumber_sum) + znumber;
	}
	ds_user4.UnFilter();

	if (znumber_sum > 0) ds_h.SetColumn(0, "CO_DEPHTQ", znumber_sum);
	else 				 ds_h.SetColumn(0, "CO_DEPHTQ", ""         );
}


function fn_ddvr(prd_co, prd_max, qtseq_co, cnt_co, searchRow, znumber, znumber_sum, ds_h) { // DVR 적용대수
//trace("************18");
	ds_user4.UnFilter(); ds_user4.Filter("PRH == " + quote("EL_DDVR"));

	for (var i=0; i<ds_detail.GetRowCount(); i++) {
		if ( ds_detail.GetColumn(i, "FLAG") == "D" ) continue; // 2012.01.15 삭제된 행은 계산안함
	
		qtseq_co  = ds_detail.GetColumn(i, "QTSEQ");
		searchRow = ds_user4.searchRow("PRH =="+quote("EL_DDVR")+" && QTSEQ == "+quote(qtseq_co));
		prd_co    = trim(ds_user4.GetColumn(searchRow, "PRD"));
		znumber   = ParseInt(ds_detail.GetColumn(i, "ZNUMBER")); // 대수
		if (Length(prd_co) > 0) znumber_sum = ParseInt(znumber_sum) + znumber;
	}
	ds_user4.UnFilter();

	if (znumber_sum > 0) ds_h.SetColumn(0, "CO_DDVRTQ", znumber_sum);
	else 				 ds_h.SetColumn(0, "CO_DDVRTQ", ""         );
}

function fn_drvhq(prd_co, prd_max, qtseq_co, cnt_co, searchRow, znumber, znumber_sum, ds_h) { // 행선층 예약시스템 적용대수
//trace("************19");
	ds_user4.UnFilter(); ds_user4.Filter("PRH == " + quote("EL_DRVHQ"));

	for (var i=0; i<ds_detail.GetRowCount(); i++) {
		if ( ds_detail.GetColumn(i, "FLAG") == "D" ) continue; // 2012.01.15 삭제된 행은 계산안함
		
		qtseq_co  = ds_detail.GetColumn(i, "QTSEQ");
		searchRow = ds_user4.searchRow("PRH =="+quote("EL_DRVHQ")+" && QTSEQ == "+quote(qtseq_co));
		prd_co    = trim(ds_user4.GetColumn(searchRow, "PRD"));
		znumber   = ParseInt(ds_detail.GetColumn(i, "ZNUMBER")); // 대수
		if (Length(prd_co) > 0) znumber_sum = ParseInt(znumber_sum) + (znumber * ParseInt(prd_co));
	}
	ds_user4.UnFilter();

	if (znumber_sum > 0) ds_h.SetColumn(0, "CO_DSSQ", znumber_sum);
	else 				 ds_h.SetColumn(0, "CO_DSSQ", ""         );
}

function fn_dsv1(prd_co, prd_max, qtseq_co, cnt_co, searchRow, znumber, znumber_sum, ds_h) {
//trace("***********20");
	// 2013.02.05 엘리베이터는 ds_user4에, ES, MW는 ds_user2에 있으므로 합쳐서 계산
	destroy("ds_temp");
	create("dataset", "ds_temp");
	ds_temp.copy(ds_user2);
	ds_temp.AppendDataset(ds_user4);

	var strFileterPrh = "PRH=="+quote("EL_DSV1")+"||PRH=="+quote("ES_DSV1")+"||PRH=="+quote("MW_DSV1");
	ds_temp.Filter(strFileterPrh);

	for (var i=0; i<ds_detail.GetRowCount(); i++) {
		if ( ds_detail.GetColumn(i, "FLAG") == "D" ) continue; // 2012.01.15 삭제된 행은 계산안함
		
		qtseq_co  = ds_detail.GetColumn(i, "QTSEQ");
		searchRow = ds_temp.searchRow("QTSEQ == "+quote(qtseq_co) + "&& ("+strFileterPrh+")");
		prd_co    = trim(ds_temp.GetColumn(searchRow, "PRD"));
		znumber   = ParseInt(ds_detail.GetColumn(i, "ZNUMBER")); // 대수
		if (Length(prd_co) > 0) znumber_sum = ParseInt(znumber_sum) + znumber;

		if (prd_co == null || prd_co == "") cnt_co++;
		else                                prd_max = prd_co; //if (i==ds_detail.GetRowCount()-1) prd_max = ds_user4.Max("PRD");
	}

	if (cnt_co == ds_detail.GetRowCount()) ds_h.SetColumn(0, "CO_DSV1", "");
	else                                   ds_h.SetColumn(0, "CO_DSV1", prd_max);

	if (znumber_sum > 0) ds_h.SetColumn(0, "CO_DSV1TQ", znumber_sum);
	else 				 ds_h.SetColumn(0, "CO_DSV1TQ", ""         );
}

function fn_dsv2(prd_co, prd_max, qtseq_co, cnt_co, searchRow, znumber, znumber_sum, ds_h) {
//trace("************21");
	// 2013.02.05 엘리베이터는 ds_user4에, ES, MW는 ds_user2에 있으므로 합쳐서 계산
	destroy("ds_temp");
	create("dataset", "ds_temp");
	ds_temp.copy(ds_user2);
	ds_temp.AppendDataset(ds_user4);

	var strFileterPrh = "PRH=="+quote("EL_DSV2")+"||PRH=="+quote("ES_DSV2")+"||PRH=="+quote("MW_DSV2");
	ds_temp.Filter(strFileterPrh);

	for (var i=0; i<ds_detail.GetRowCount(); i++) {
		if ( ds_detail.GetColumn(i, "FLAG") == "D" ) continue; // 2012.01.15 삭제된 행은 계산안함
		
		qtseq_co  = ds_detail.GetColumn(i, "QTSEQ");
		searchRow = ds_temp.searchRow("QTSEQ == "+quote(qtseq_co) + "&& ("+strFileterPrh+")");
		prd_co    = trim(ds_temp.GetColumn(searchRow, "PRD"));
		znumber   = ParseInt(ds_detail.GetColumn(i, "ZNUMBER")); // 대수
		if (Length(prd_co) > 0) znumber_sum = ParseInt(znumber_sum) + znumber;

		if (prd_co == null || prd_co == "") cnt_co++;
		else                                prd_max = prd_co; //if (i==ds_detail.GetRowCount()-1) prd_max = ds_user4.Max("PRD");
	}

	if (cnt_co == ds_detail.GetRowCount()) ds_h.SetColumn(0, "CO_DSV2", "");
	else                                   ds_h.SetColumn(0, "CO_DSV2", prd_max);

	if (znumber_sum > 0) ds_h.SetColumn(0, "CO_DSV2TQ", znumber_sum);
	else 				 ds_h.SetColumn(0, "CO_DSV2TQ", ""         );
}

// 고속현장 2013.04.03
function fn_aspd() {
// 추가로 발생한 공용사양으로 호기별 사양서에 모두 존재하는 경우에 대하여 확인 필요
//trace("************fn_aspd);
	var strFilterPrh = "PRH=="+quote("EL_ASPD");
	
	ds_user1.UnFilter();
	ds_user1.Filter(strFilterPrh);

	var varAspd   = "";
	var varCheck  = false;
	var searchRow = -1;
	var qtseq_co  = "";

	// 고속 존재여부 확인
	for (var i = 0; i < ds_detail.GetRowCount(); i++) 	{
		if ( ds_detail.GetColumn(i, "FLAG") == "D" ) continue; // 삭제된 행은 제외

		qtseq_co = ds_detail.GetColumn(i, "QTSEQ");

		searchRow = ds_user1.searchRow("QTSEQ=="+quote(qtseq_co)+"&& ("+strFilterPrh+")");
		// 조건이 존재하는 경우
		if (searchRow != -1)	{
			varAspd = ds_user1.GetColumn(searchRow, "PRD");
			if (varAspd == "180" || varAspd == "210" || varAspd == "240")	{
				varCheck = true;
				break;
			}
		}
	}

	// 공용특성(고속현자)에 반영 처리
	var prd = "";
	var ds0 = object(ds_template0.ID);
	var prh    = "";
	var oldPrd = ""; 

	if (varCheck == true)	{
		prd = "Y";
	}

	for (var i = 0; i < ds0.GetRowCountNF(); i++) {

		prh = ds0.GetColumnNF(i, "PRH"  );
		
		if (prh == "CO_ASPD") 	{
			oldPrd = trim(ds0.GetColumnNF(i, "PRD"));

			if (prd != oldPrd) {
				ds0.SetColumnNF(i, "PRD", prd);
				ds0.SetColumnNF(i, "FLAG", "U");
			}
		}
	}

	ds_user0.Copy(ds0);
}

// 현재 조회된 자료의 MAX 순번 구하기
function fn_getMaxSerno() { 
//trace("************22");
	var max_serno 	= 0;
	var serno 		= 0; 
	for (var i=0;i<ds_detail.GetCount();i++) {
		serno = ds_detail.GetColumn(i, "SERNO");
		if (ToNumber(serno) > ToNumber(max_serno)) max_serno = serno;
	}
	return max_serno;
}


function grd_detail_OnKeyDown(obj,nChar,bShift,bCtrl,bAlt,nLLParam,nHLParam) {
//trace("************23");
	var ds = object(obj.BindDataset);
	
	if (nChar==13) { 	// 엔터키이면 다음 행으로 이동
		ds.row = ds.row + 1;
	} else if (nChar==27)	{ 	// Esc 키이면 변경전 자료로 되돌린다.
		var nCol = obj.GetCellPos();
		gfn_SetOrgColumn(obj, ds.row, nCol);
	} else {
		F_GRID_SELECT = "Y";	// 템플릿 입력 여부 2013.01.09
		gfn_GrdCellCopyPasteReset(obj, ds, bCtrl, nChar);
	}
}

function grd_detail_OnExpandEdit(obj,nRow,nCell,strVal,nPivotIndex) {
//trace("************24");
	if (ds_detail.RowCount()==0) return;

	switch (nCell) {
		case  4	:	var zprgflg  = ds_header.GetColumn(0, "ZPRGFLG"); // 진행상태
					var spart = ds_header.GetColumn(0, "SPART");
					//if ( spart == "30" ) return; // 물류

					switch (zprgflg) {
						case "34" : break; // 견적가승인요청
						//case "42" : break; // 원가팀완료 ==> 2012.01.18 원가팀완료에서도 기종 팝업창 띄울 수 있게 수정
						case "50" : break; // 입찰
						case "61" : break; // 수주
						case "90" : break; // 수주생성
						default   : var mandt = ds_header.GetColumn(0, "MANDT");
									var arg = "fa_mandt="+quote(mandt) + " fa_class="+quote(zprdgbn);
									var arr = gfn_openPopUpUrlHdel("COM::Com0220.xml", true, arg);
									if (arr != null && arr != 0) ds_detail.SetColumn(ds_detail.row, "GTYPE", arr[6]); break;
					} break;
		case 18	: 	var qtseq = ds_detail.GetColumn(nRow, "QTSEQ");
					var arg   = "ZPRDGBN=" + ds_detail.GetColumn(nRow, "ZPRDGBN");
					
					ds_report.UnFilter(); ds_report.Filter("QTSEQ ==" + quote(qtseq));
					ds_block.UnFilter();  ds_block.Filter("QTSEQ ==" + quote(qtseq));
					
					//2012.12.13.khs
					var findrow = ds_report.FindRow("QTSEQ" , qtseq);
					if (findrow == -1) {
						gfn_showAlert("CW00010");		//데이터가 없습니다.
						return false;
					}	

					for (var i=0; i<ds_block.GetRowCount(); i++) {
						ds_block.SetColumn(i, "NO", i+1);
					}
										
					Dialog("SES::Ses0037.xml", arg, -1, -1, "Resize=true"); break;
					
		case 19 :  //fn_moprint(); 		
	                var qtseq = ds_detail.GetColumn(nRow, "QTSEQ");
                 	
                    ds_template1.Filter("QTSEQ ==" + quote(qtseq) + " && PRD <> '' ");
                    ds_A.CopyF(ds_template1);
                    //trace("A" + ds_A.savexml());
                    //trace("A" + ds_template1.savexml());
                    ds_template1.UnFilter(); 
                                        
                    ds_template2.Filter("QTSEQ ==" + quote(qtseq) + " && PRD <> '' ");
                    ds_B.CopyF(ds_template2);
                    ds_template2.UnFilter(); 
                    
                    ds_template3.Filter("QTSEQ ==" + quote(qtseq) + " && PRD <> '' ");
                    ds_C.CopyF(ds_template3);
                    ds_template3.UnFilter(); 
                                        
                    ds_template4.Filter("QTSEQ ==" + quote(qtseq) + " && PRD <> '' ");
                    ds_D.CopyF(ds_template4);
                    ds_template4.UnFilter(); 
                    
                    ds_template5.Filter("QTSEQ ==" + quote(qtseq) + " && PRD <> '' ");
                    ds_E.CopyF(ds_template5);
					ds_template5.UnFilter(); 	
                    
                    ds_detail.Filter("QTSEQ ==" + quote(qtseq));
                    ds_F.CopyF(ds_detail);
                    ds_detail.UnFilter();
                    
                    
                    var arg = "aCnt="+quote(ds_A.GetRowCount())
					+ " bCnt="+quote(ds_B.GetRowCount())
					+ " CCnt="+quote(ds_C.GetRowCount())
					+ " DCnt="+quote(ds_D.GetRowCount())
					+ " ECnt="+quote(ds_E.GetRowCount())
					+ " FCnt="+quote(ds_F.GetRowCount())
					+ " ABCCnt="+quote(ds_A.GetRowCount()+ds_B.GetRowCount()+ds_C.GetRowCount())
					+ " GBN=A";
			
					Dialog("SES::Ses0372.xml", arg, -1, -1, "Resize=true");
		            
		            break;
		default : break;
	}
}

function grd_detail_OnCellClick(obj,nRow,nCell,nX,nY,nPivotIndex) {
//trace("************25");
	// 2013.02.01 fn_template 호출 위치를 그리드 클릭이벤트로 변경
	if ( F_CLICKED_ROW != nRow ) {
		F_CLICKED_ROW = nRow;
		fn_template("C", nRow);
	}

	F_CLCIK_EVENT = "ON";

	var fa_atkla = "";
	var fa_atnam = "";
	var colId    = "";
	var prd      = "";
	var zacapa   = "";
	var matnr    = ds_detail.GetColumn(nRow, "MATNR"  );
	var mclass   = ds_detail.GetColumn(nRow, "ZPRDGBN");
	var shangh   = ds_detail.GetColumn(nRow, "SHANGH" );
	var h        = tab.main.div_header;
	var searchRow;
	var qtnum = ds_detail.GetColumn(nRow, "QTNUM");
	var qtser = ds_detail.GetColumn(nRow, "QTSER");
	var qtseq = ds_detail.GetColumn(nRow, "QTSEQ");

	if (mclass == "ELV_01" || mclass == "ELV_02" || mclass == "SHN_01") {
		fa_atkla = quote("EL_BASIC");
	} else if (mclass == "ESC_01" || mclass == "SHN_02") {
		fa_atkla = quote("ES_BASIC");
	} else if (mclass == "MW_01") {
		fa_atkla = quote("MW_BASIC");
	}  else if (mclass == "AP_01") {
		fa_atkla = quote("AP_BASIC");
	} else if (mclass == "PSD_01") { // (2012.12.10)
		fa_atkla = quote("PSD_BASIC");
	}
	
//-----< 2016.11.09 공통추가 개수 제한 계약관리부(홍수봉DR) 요청 by mj.Shin 	Start 		
	if (nCell == 12 ) { 
		if ( matnr == "Y-200" || matnr == "Y-300" || matnr == "Y-400" || matnr == "Y-500") {
			h.grd_detail.SetCellProp("body", nCell, "Edit", "none"); 	// 대수 - 입력불가
		}else	{
			h.grd_detail.SetCellProp("body", nCell, "Edit", "integer");	// 대수 - 숫자입력
		}
	}
//-----> 2016.11.09 공통추가 개수 제한 계약관리부(홍수봉DR) 요청 by mj.Shin 	End 
	
	if (matnr == "T-1000" || matnr == "Y-1000" || matnr == "Y-200" || matnr == "Y-300" || matnr == "Y-400" || matnr == "Y-500" || matnr == "L-1100" || matnr == "L-1200") {
		if ( nCell == 2 ) {
			h.grd_detail.SetCellProp("body", nCell, "Edit", "none");
		} else if ( nCell == 13 ) {			// 2013.01.16 감시반 단가 입력 추가
			if ( matnr == "Y-1000" || matnr == "Y-200" || matnr == "Y-300" || matnr == "Y-400" || matnr == "Y-500" || matnr == "L-1100" || matnr == "L-1200" ) {
				h.grd_detail.SetCellProp("body", nCell, "Edit", "integer"); // 단가 - 숫자입력
			}else	{
				h.grd_detail.SetCellProp("body", nCell, "Edit", "none");	// 단가 - 입력불가
			}
		}
	} else if ( nCell == 2 ) {
		// 에스컬레이터, 무빙워크는 국내상해 구분 변경 가능
		if ( mclass == "ESC_01" || mclass == "MW_01" ) {
			h.grd_detail.SetCellProp("body", nCell, "Edit", "combo");
		} else {
			h.grd_detail.SetCellProp("body", nCell, "Edit", "none");
		}
	} else if (nCell==3 || (nCell>=5 && nCell<=11)) {

		if (mclass == "AP_01") { // (2012.12.10)
			switch (nCell) {
				case  3	: fa_atnam=""       ; colId="ZSAREA"; h.grd_detail.SetCellProp("body", nCell, "Edit", "none")   ; break; // 판매지역      -> (비활성화)
				case  5	: fa_atnam="AP_AMOD"; colId="ZUSE"  ; h.grd_detail.SetCellProp("body", nCell, "Edit", "normal") ; break; // 용도          -> 승입방향
				case  6	: fa_atnam="AP_AEA" ; colId="TYPE1" ; h.grd_detail.SetCellProp("body", nCell, "Edit", "none")   ; break; // 인승,폭       -> 모델명
				case  7	: fa_atnam="AP_ACS" ; colId="ZACAPA"; h.grd_detail.SetCellProp("body", nCell, "Edit", "none")   ; break; // 용량          -> 수용차종
				case  8	: fa_atnam="AP_AQL" ; colId="TYPE2" ; h.grd_detail.SetCellProp("body", nCell, "Edit", "integer"); break; // 속도/각도     -> 단수
				case  9 : fa_atnam="AP_AQC" ; colId="TYPE3" ; h.grd_detail.SetCellProp("body", nCell, "Edit", "integer"); break; // 층수/높이     -> 파렛트수
				case 10	: fa_atnam="AP_AQT" ; colId="ZLEN"  ; h.grd_detail.SetCellProp("body", nCell, "Edit", "integer"); break; // 정지층수/속도 -> 리프트수
				case 11	: fa_atnam="AP_AETS"; colId="ZOPN"  ; h.grd_detail.SetCellProp("body", nCell, "Edit", "none")   ; break; // DOOR개폐길이  -> 외부턴
				/*case 20	: fa_atnam=""       ; colId="ZOUTC" ; h.grd_detail.SetCellProp("body", nCell, "Edit", "combo")   ; 
				                                              h.grd_detail.SetCellProp("body", nCell, "Display", "combo");
				                                              h.grd_detail.SetCellProp("body", nCell, "ComboDataset", "ds_cmcode")  ;
				                                              h.grd_detail.SetCellProp("body", nCell, "ComboCol", "code")  ;
				                                              break;*/
				default : break;
			}
		} else if (mclass == "PSD_01") { // (2012.12.10)
			switch (nCell) {
				case  3	: fa_atnam=""         ; colId="ZSAREA"; h.grd_detail.SetCellProp("body", nCell, "Edit", "none")    ; break; // 판매지역	 	- (비활성화)
				case  5	: fa_atnam=""		  ; colId="ZUSE"  ; h.grd_detail.SetCellProp("body", nCell, "Edit", "normal")  ; break; // 용도 	        - (비활성화)
				case  6	: fa_atnam=""         ; colId="TYPE1" ; h.grd_detail.SetCellProp("body", nCell, "Edit", "integer") ; break; // 인승/폭	 	- 역사명
				case  7	: fa_atnam=""         ; colId="ZACAPA"; h.grd_detail.SetCellProp("body", nCell, "Edit", "normal")  ; break; // 용량		 	- (비활성화)
				case  8	: fa_atnam=""         ; colId="TYPE2" ; h.grd_detail.SetCellProp("body", nCell, "Edit", "normal")  ; break; // 속도/각도		- (비활성화)
				case  9 : fa_atnam=""         ; colId="TYPE3" ; h.grd_detail.SetCellProp("body", nCell, "Edit", "integer") ; break; // 층수/높이 		- (비활성화)
				case 10	: fa_atnam=""         ; colId="ZLEN"  ; h.grd_detail.SetCellProp("body", nCell, "Edit", "normal")  ; break; // 정지층수/속도- (비활성화)
				case 11	: fa_atnam=""         ; colId="ZOPN"  ; h.grd_detail.SetCellProp("body", nCell, "Edit", "normal")  ; break; // DOOR개폐길이 - (비확성화)
				default : break;
			}
		} else if (matnr == "F-1000") { // 물류 (2012.12.11)
			switch (nCell) {
				case  3	: fa_atnam=""         ; colId="ZSAREA"; h.grd_detail.SetCellProp("body", nCell, "Edit", "none")    ; break; // 판매지역	 	- (비활성화)
				case  5	: fa_atnam=""		  ; colId="ZUSE"  ; h.grd_detail.SetCellProp("body", nCell, "Edit", "normal")  ; break; // 용도 	        - (비활성화)
				case  6	: fa_atnam=""         ; colId="TYPE1" ; h.grd_detail.SetCellProp("body", nCell, "Edit", "integer") ; break; // 인승/폭	 	- (비활성화)
				case  7	: fa_atnam=""         ; colId="ZACAPA"; h.grd_detail.SetCellProp("body", nCell, "Edit", "integer") ; break; // 용량		 	- (비활성화)
				case  8	: fa_atnam=""         ; colId="TYPE2" ; h.grd_detail.SetCellProp("body", nCell, "Edit", "integer") ; break; // 속도/각도		- (비활성화)
				case  9 : fa_atnam=""         ; colId="TYPE3" ; h.grd_detail.SetCellProp("body", nCell, "Edit", "combo")   ; 
				                                                h.grd_detail.SetCellProp("body", nCell, "Display", "combo");
				                                                h.grd_detail.SetCellProp("body", nCell, "ComboDataset", "ds_cmcode")  ;
				                                                h.grd_detail.SetCellProp("body", nCell, "ComboCol", "code")  ;
				                                                break; // 층수/높이 		- (비활성화)
				case 10	: fa_atnam=""         ; colId="ZLEN"  ; h.grd_detail.SetCellProp("body", nCell, "Edit", "combo")   ; 
				                                                h.grd_detail.SetCellProp("body", nCell, "Display", "combo");
				                                                h.grd_detail.SetCellProp("body", nCell, "ComboDataset", "ds_cmcode")  ;
				                                                h.grd_detail.SetCellProp("body", nCell, "ComboCol", "code")  ;
				                                                break; // 정지층수/속도- (비활성화)
				case 11	: fa_atnam=""         ; colId="ZOPN"  ; h.grd_detail.SetCellProp("body", nCell, "Edit", "combo")   ; 
				                                                h.grd_detail.SetCellProp("body", nCell, "Display", "combo");
				                                                h.grd_detail.SetCellProp("body", nCell, "ComboDataset", "ds_cmcode")  ;
				                                                h.grd_detail.SetCellProp("body", nCell, "ComboCol", "code")  ;
				                                                break; // DOOR개폐길이 - (비확성화)
				default : break;
			}
		}

		if ((mclass!="SHN_01" && mclass!="AP_01" && mclass!="PSD_01" && matnr != "F-1000" &&
				(fa_atnam!="EL_AFQ" && fa_atnam!="EL_ASTQ" && fa_atnam!="ES_ARISE" && fa_atnam!="MW_ARIS" && fa_atnam!="ES_ALENG" && fa_atnam!="MW_ALENG")) ||
		    (mclass=="AP_01" && (fa_atnam=="AP_AEA" || fa_atnam=="AP_ACS" || fa_atnam=="AP_AETS") || fa_atnam=="AP_AMOD") ||
			(mclass=="SHN_01" && (fa_atnam=="EL_AUSE" || fa_atnam=="EL_AOPEN"))) {

			if ( fa_atnam == "" ) return;

			// (2012.12.10) 모델명이 AE* 시작될 경우에만 승입방향 선택 가능 ---> 경우의 수 없이 선택가능하도록 수정 2013.04.28  강슬기
			/*var sApModelName = h.grd_detail.GetCellText("Body", nRow, 5);
			sApModelName = iif(length(sApModelName) >= 2, left(sApModelName, 2), "");
			if ( fa_atnam == "AP_AEA" && sApModelName != "AE" ) return;
			*/
			if (mclass=="SHN_01") fa_atnam = "SH_" + fa_atnam;
		
			var arg = " fa_mandt="+G_MANDT+" fa_class="+mclass+" fa_atkla="+fa_atkla+" fa_atnam="+quote(fa_atnam)+" fa_where="+quote("");
			var arr = gfn_openPopupUrl("COM::Com0150.xml", true, arg);

			if (arr != null && arr != 0)	{
				ds_detail.SetColumn(nRow, colId, Trim(arr[6]));
				/* 인승에 따른 용량 셋팅 
				// 값이 존재하는 경우에만 변경 처리 2013.01.09
				if (fa_atnam="EL_AMAN" && colId == "TYPE1") {
	
					prd       = ds_detail.GetColumn(nRow, "TYPE1"); // 인승
					searchRow = ds_acapa.SearchRow("ATWRT ==" + quote(prd));
					zacapa    = ds_acapa.GetColumn(searchRow, "ZACAPA");
					ds_detail.SetColumn(nRow, "ZACAPA", zacapa);
	
					prd       = ds_detail.GetColumn(nRow, "ZACAPA");
					searchRow = ds_template1.SearchRow(searchRow + quote("EL_ACAPA"));	//  filterStr-> searchRow 수정 2013.01.18
					ds_template1.SetColumn(searchRow, "PRD" , prd);
					ds_template1.SetColumn(searchRow, "FLAG", "U");
	
					prd       = ds_detail.GetColumn(nRow, "GTYPE");
					searchRow = ds_template1.SearchRow(searchRow + quote("EL_ATYP"));	//  filterStr-> searchRow 수정 2013.01.18
					ds_template1.SetColumn(searchRow, "PRD" , prd);
					ds_template1.SetColumn(searchRow, "FLAG", "U");
				}
				*/
			}

			// (2012.12.11) 주차 - 모델명이 AE* 가 아닌 경우, 승입방향 초기화 ---> 경우의 수 없이 선택가능하도록 수정 2013.04.28  강슬기
			/*if ( mclass=="AP_01" && fa_atnam=="AP_AMOD" ) {
				var sApModelName = h.grd_detail.GetCellText("Body", nRow, 5);
				sApModelName = iif(length(sApModelName) >= 2, left(sApModelName, 2), "");
				if ( sApModelName != "AE" ) {
					ds_detail.SetColumn(nRow, "TYPE1", ""); // 승입방향
				}
			}*/
		}
	} else if (nCell == 13) {
		if ( mclass == "AP_01" ) { // 주차 (2012.12.10), PSD (2012.12.10)
			IF ( G_USER_ID = "2020254" || G_USER_ID = "2026317"|| G_USER_ID = "2029456" ||
			     G_USER_ID = "2004461" || G_USER_ID = "2017504"|| G_USER_ID = "2016087"   //강슬기 최호식//김유창 송창영 박현중 추가
			     || G_USER_ID = "2018713" || G_USER_ID = "2007495"  || G_USER_ID = "2026902" || G_USER_ID = "2021897") //우제석 김재명 송지호
			{    //담당자만 입력 가능 하도록 수정  2013.03.30 
			     h.grd_detail.SetCellProp("body", nCell, "Edit", "integer"); //단가 - 숫자입력
			}
		}
		//else if  ( mclass == "PSD_01" ) {
		//	     h.grd_detail.SetCellProp("body", nCell, "Edit", "integer"); //단가 - 숫자입력
		//}
		//else if ( matnr == "F-1000" ) { // 물류 (2012.12.12)
		//	h.grd_detail.SetCellProp("body", nCell, "Edit", "integer"); //단가 - 숫자입력
			//h.grd_detail.SetCellProp("body", nCell, "Edit", "none"); //단가 - 입력불가
			// 저장여부 확인
		/*	if ( qtnum == null || qtnum == "" ) {
				gfn_showAlert("CW10028"); // 저장버튼을 눌러 수정/추가 작업을 먼저 완료해주세요.
				return;
			}
			// 팝업창에서 원가,견적가 정보 받아서 설정
			var arg = "fa_qtnum=" + qtnum + " fa_qtser=" + qtser + " fa_qtseq=" + qtseq + " fa_gbn='50'";
			arg += " fa_zprgflg=" + ds_header.GetColumn(0, "ZPRGFLG"); // 2012.02.18 추가
			var arr = gfn_openPopUpUrlHdel("SES::Ses0360.xml", true, arg);
			if (arr != null && arr != 0) {
				ds_detail.SetColumn(nRow, "ZUAM" , arr[0]); // 단가
				ds_detail.SetColumn(nRow, "ZCOST", arr[1]); // 원가합계
				ds_detail.SetColumn(nRow, "ZEAM" , arr[2]); // 견적가합계
				ds_detail.SetColumn(nRow, "SHANG", arr[3]); // 시행율
			} */
		//	return;
		//}
		// 2013.01.16 수정
		else	{
			//sap 원가 연동 이전까지 입력 가능 처리 
			h.grd_detail.SetCellProp("body", nCell, "Edit", "integer"); //단가 - 입력불가
		}

		if (shangh=="상해" || shangh=="상해_E") {
			var qtnum = ds_detail.GetColumn(nRow, "QTNUM");
			var qtser = ds_detail.GetColumn(nRow, "QTSER");
			var qtseq = ds_detail.GetColumn(nRow, "QTSEQ");
			var arg   = " fa_mandt = "+G_MANDT+" fa_qtnum = "+qtnum+" fa_qtser = "+qtser+" fa_qtseq = "+qtseq;
			gfn_openPopUpUrlHdel("SES::Ses0171.xml", true, arg);
		}
	} else if (nCell == 14 || nCell == 15) {
		/*if ( matnr == "F-1000" ) { // 물류 (2012.12.12)
			h.grd_detail.SetCellProp("body", nCell, "Edit", "integer"); //단가 - 숫자입력
			//h.grd_detail.SetCellProp("body", nCell, "Edit", "none"); //단가 - 입력불가
			// 저장여부 확인
		/*	if ( qtnum == null || qtnum == "" ) {
				gfn_showAlert("CW10028"); // 저장버튼을 눌러 수정/추가 작업을 먼저 완료해주세요.
				return;
			}
			// 팝업창에서 원가,견적가 정보 받아서 설정
			var arg = "fa_qtnum=" + qtnum + " fa_qtser=" + qtser + " fa_qtseq=" + qtseq + " fa_gbn='50'";
			arg += " fa_zprgflg=" + ds_header.GetColumn(0, "ZPRGFLG"); // 2012.02.18 추가
			var arr = gfn_openPopUpUrlHdel("SES::Ses0360.xml", true, arg);
			if (arr != null && arr != 0) {
				ds_detail.SetColumn(nRow, "ZUAM" , arr[0]); // 단가
				ds_detail.SetColumn(nRow, "ZCOST", arr[1]); // 원가합계
				ds_detail.SetColumn(nRow, "ZEAM" , arr[2]); // 견적가합계
				ds_detail.SetColumn(nRow, "SHANG", arr[3]); // 시행율
			}
			return;
		}*/
	} else if (nCell == 20) {
		h.grd_detail.SetCellProp("body", nCell, "Edit", "combo")   ; 
		h.grd_detail.SetCellProp("body", nCell, "Display", "combo");
		h.grd_detail.SetCellProp("body", nCell, "ComboDataset", "ds_cmcode")  ;
		h.grd_detail.SetCellProp("body", nCell, "ComboCol", "code")  ;
	}

	// 시행율 (2012.12.11)
	if ( mclass == "AP_01" || mclass == "PSD_01" || matnr == "F-1000" ) {
		if ( h.grd_detail.GetCellProp("body", 16, "Expr") == "" ) {
			h.grd_detail.SetCellProp("body", 16, "Expr", "toNumber(toNumber(ZCOST,3)/toNumber(ZEAM,3)*100,1)");
		}
	}
}

function btn_template_OnClick(obj) {
//trace("************26");
	var mclass = ds_detail.GetColumn(ds_detail.currow, "ZPRDGBN");

	var arg = "mclass="+quote(mclass)+" nRow="+quote(ds_detail.currow);
    gfn_openPopUpUrlHdel("SES::Ses0582.xml", true, arg);
}

function cb_vkbur_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex) {
//trace("************27");
	ds_vkgrp.UnFilter();
	ds_vkgrp.Filter("DTEXT1 == '" + strCode + "'");
	cb_vkgrp.SetFocus();
	cb_vkgrp.index = 0;
}

// 버튼의 처리는 
function fn_zprgflg() {
//trace("************28");
	    zprgflg = ds_header.GetColumn(0, "ZPRGFLG" ); // 진행상태
	var vkbur   = ds_header.GetColumn(0, "VKBUR"   );
	var spart   = ds_header.GetColumn(0, "SPART"   );
	var partCnt = ds_header.GetColumn(0, "PART_CNT");
	var shangh  = ds_detail.GetColumn(0, "SHANGH"  );
	var h       = tab.main.div_header;
	var d       = tab.template.div_template;

    btn_countRequest.Visible = false;
	//btn_estimate.Visible = false;
	if (zprgflg >= "32") { // 32 원가산출

		btn_qtser_plus.Visible = true;
		btn_qtser_minus.Visible = true;    // 원가팀의뢰(41), 입찰(50) 이후로 (-)버튼 비활성화 20130904
 		cal_qtdat.Enable = false;

		if (zprgflg >= "61" || zprgflg = "41") { // 원가팀의뢰(41), 수주(61) 이후로 (-)버튼 비활성화 20130904
			btn_qtser_minus.Visible = false; 
		}	
		if (zprgflg >= "50") { // 50 입찰
			h.btn_popup.Enable=false; h.btn_plus.Enable=false; h.btn_minus.Enable=false; h.btn_common.Enable=false; h.cb_qtgbn.Enable = false;
			
		} else {
			h.btn_popup.Enable=true ; h.btn_plus.Enable=true ; h.btn_minus.Enable=true ; h.btn_common.Enable=true;  h.cb_qtgbn.Enable = true;
		}
        //특기사항 원가산출 이후 입력 가능 처리 20150407 최호식
		h.div_sprmk.Enable=true; h.cb_waerk.Enable=false; h.cb_inco1.Enable =false; h.ed_dev.Enable=false;

		if (zprgflg=="32" || zprgflg=="42") { // 32 원가산출, 42 원가팀완료
			h.cal_zestdat.Enable = false; //h.cal_deldat.Enable = false;  납기예정일 변경가능하도록 2013.05.10
			h.ed_dev.Enable      = false; h.chk_cst.Enable    = false; h.cb_zbdtyp_l.Enable = false;
			h.cb_zbdtyp.Enable   = false; //h.cb_zregn1.Enable  = false; h.cb_zregn2.Enable   = false; h.cb_zregn3.Enable   = false;
			h.ed_pid.Enable      = false; h.ed_tel.Enable     = false; h.med_zipcode.Enable = false; h.btn_zipcode.Enable = false;
			h.ed_addr1.Enable    = false; h.ed_addr2.Enable   = false; h.cb_inco1.Enable    = false;

			h.grd_detail.OnCellClick = "grd_detail_OnCellClick";
		} else {
			h.grd_detail.OnCellClick = "";
			if ( ds_header.GetColumn(0, "SPART") == "30" ) h.grd_detail.OnCellClick = "grd_detail_OnCellClick"; // 2013.02.18
		}

		for (var i=0; i<h.grd_detail.GetColCount(); i++) {
			if ((zprgflg=="32" || zprgflg=="33" || zprgflg=="41" || zprgflg=="42") && i==15 ) { // 32원가산출,33원가산출승인,41원가팀의뢰,42원가팀완료
				h.grd_detail.SetCellProp("body", i, "Edit", "masknumber");
			} else {
				h.grd_detail.SetCellProp("body", i, "Edit", "none");
			}
			
			// 입찰이전의 상태에서는 대수 수정 가능토록 변경 2013.01.09
			if (i==12)	{
				if ( zprgflg < "50" )	{
					h.grd_detail.SetCellProp("body", i, "Edit", "integer");
				}else	{
					h.grd_detail.SetCellProp("body", i, "Edit", "none");
				}
			}
		}
	} else if (zprgflg >= "20" && zprgflg < "32") { // 32 원가산출

		if (flag != "I") {
			btn_qtser_plus.Visible = true; btn_qtser_minus.Visible = true;

			switch (spart) {
				case "10" : if (partCnt>0 || ds_check.GetRowCount()>0) btn_part.Visible = true;
							else                                       btn_part.Visible = false;
							btn_countRequest.Visible = false; 
							btn_estimate.Visible = false;  break;
				case "20" : //btn_countRequest.Visible = iif(left(G_USER_ID,1)=="9"||isAlpha(right(G_SAP_USER_VGCD,1)), true, false); break; // 주차-대리점/지사만 원가의뢰 버튼 보임(2012.12.11)
				case "40" : btn_countRequest.Visible = iif(left(G_USER_ID,1)=="9"||isAlpha(right(G_SAP_USER_VGCD,1)), true, false); break; // PSD-대리점/지사만 원가의뢰 버튼 보임(2012.12.11)
				case "30" : btn_countRequest.Visible = iif(left(G_USER_ID,1)=="9"||isAlpha(right(G_SAP_USER_VGCD,1)), true, false); break; // 물류-대리점/지사만 원가의뢰 버튼 보임(2012.12.11)
				default   : btn_part.Visible = false; btn_countRequest.Visible = true;  break;
			}
		} else {
			btn_qtser_plus.Visible = false; btn_qtser_minus.Visible = false; btn_count.Visible = false; btn_countRequest.Visible = false; btn_part.Visible = false; btn_estimate.Visible = false;
		}
	}

	//2013.04.26 원가반려
	btn_costReject.Visible   = false;

	switch (zprgflg) {
		case "20" : btn_count.Visible = true ; 
		            if ( spart == "20" ) { btn_estimate.Visible = true; btn_countRequest.Visible = false;} 
		            break;
		case "24" : btn_qtser_plus.Visible = false; 
		            btn_qtser_minus.Visible = true; 
		            break;
		case "25" : btn_estimate.Visible = false;
		            if ( spart == "20" ) { 
		                 btn_countRequest.Visible = false; 
						 //원가산출요청에서 견적승인으로 프로세스 단일화 20151022 최호식
						 if ( G_USER_ID == "2020254" || G_USER_ID == "2026317"  || G_USER_ID = "2029456" ||
						      G_USER_ID = "2004461" || G_USER_ID = "2017504"|| G_USER_ID = "2016087" || G_USER_ID = "2018713" || G_USER_ID = "2007495" || G_USER_ID = "2026902" || G_USER_ID = "2021897" ) { // 강슬기,최호식,송지호
							btn_costApproval.Visible = true;
						} else {
							btn_costApproval.Visible = false;
						}
		            }
		            break;  
		case "26" : if ( spart == "20" ) { 
		             btn_estimate.Visible = false; 
		             btn_countRequest.Visible = false;
		            } 
		            break;           
		case "31" : // 원가산출요청
					btn_count.Visible = true ;
					if ( spart == "20" ) { // 2013.03.12 주차 : 아래 사용자만 원가승인 버튼 보임
						if ( G_USER_ID == "2020254" || G_USER_ID == "2026317"  || G_USER_ID = "2029456" ||
						      G_USER_ID = "2004461" || G_USER_ID = "2017504"|| G_USER_ID = "2016087" || G_USER_ID = "2018713" || G_USER_ID = "2007495" || G_USER_ID = "2026902" || G_USER_ID = "2021897" ) { // 강슬기,최호식,송지호
							btn_costApproval.Visible = true;
						} else {
							btn_costApproval.Visible = false;
						}
					}
					// 2013.04.26 원가반려버튼 : 영업3부만 해당
					if (vkbur == "B400")	{
						btn_costReject.Visible = true;
					}
					break;
		case "32" : btn_count.Visible = true ;
					if (partCnt>0 || ds_check.GetRowCount()>0) btn_part.Visible = true;
					else                                       btn_part.Visible = false;

					if (vkbur == "B400") {
						btn_costApproval.Visible = true; // B400 영업3부
						btn_costReject.Visible   = true;	//2013.04.26 원가반려
					}else	{
					    btn_costApproval.Visible = false;
					}
					
					break;
		case "33" : btn_count.Visible = true ;
					if (partCnt>0 || ds_check.GetRowCount()>0) btn_part.Visible = true;
					else                                       btn_part.Visible = false;

					if (vkbur == "B400") btn_costApproval.Visible = true ; // B400 영업3부
					else                 btn_costApproval.Visible = false; break;

		case "41" : // 2013.03.15 영업부서의 경우 보이지 않게 변경
					if (vkbur == "B100" || vkbur == "B200" || vkbur == "B300" || vkbur == "B400")
						btn_count.Visible = false ;
					else
						btn_count.Visible = true ;
					
					break;

		case "42" : if (vkbur == "C700"){
					 if ( G_USER_ID == "2020254" || G_USER_ID == "2026317"  || G_USER_ID = "2029456" ||
						      G_USER_ID = "2004461" || G_USER_ID = "2017504"|| G_USER_ID = "2016087" || G_USER_ID = "2018713" || G_USER_ID = "2007495" || G_USER_ID = "2026902" || G_USER_ID = "2021897" ) { // 강슬기,최호식,송지호
							btn_costApproval.Visible = true;
						} else {
							btn_costApproval.Visible = false;
						}
					}	
					//btn_costApproval.Visible = true ; // B400 영업3부
					else                 btn_costApproval.Visible = false;
					btn_count.Visible = true ;
					break;
					
		case "50" : btn_count.Visible = false; btn_part.Visible = false; btn_costApproval.Visible = false; btn_qtser_plus.Visible = true;  btn_qtser_minus.Visible = true;
					fn_enable_set(); break; // 입찰
		case "61" : btn_count.Visible = false;
					fn_enable_set();
				    break;
		case "90" : btn_count.Visible = false; 
					btn_qtser_plus.Visible = false; 		//2017.06.23 추가 by mj.Shin
					btn_qtser_minus.Visible = false;		//2017.06.23 추가 by mj.Shin
					fn_enable_set();
					break; // 수주생성
		default   : btn_count.Visible = true ;		            
					break;
	}
	
    //주차 담당자 이외 적용 사항 2013.03.30
        //TRACE("제품구분 "+ zprdgbn);
        var zprgflg = ds_header.GetColumn(0, "ZPRGFLG"); // 진행상태
        if ( zprdgbn == "AP_01"  &&  G_USER_ID != "2026317" &&  G_USER_ID != "2020254" && G_USER_ID != "2029456"
             &&  G_USER_ID != "2004461" &&  G_USER_ID != "2017504"  &&  G_USER_ID != "2016087"
              &&  G_USER_ID != "2018713"  &&  G_USER_ID != "2007495" &&  G_USER_ID != "2026902" && G_USER_ID != "2021897"
              )  	//최호식 강슬기 송지호
        {
        // 원가승인 이전 단계에서는 단가와 원가 금액을 보이지 않게 세팅  201303
	    //TRACE("진행상태 "+ zprgflg);
		 if (zprgflg != "33" && zprgflg != "50" && zprgflg != "61" && zprgflg != "90")
		 {
		    // ds_detail.oncolumnchanged = "" 하고 끝나는 시점에 다시 넣어준다. ! 
		    ds_detail.OnColumnChanged = "";
	        //ds_detail.CanRowPosChange = "";
		 	//ds_detail.OnRowPosChanged = ";
		 	
		 	for (var i=0; i<ds_detail.GetRowCount(); i++) {
		   		ds_detail.SetColumn(i, "ZUAM", "0");
				ds_detail.SetColumn(i, "ZCOST", "0");
				TRACE("원가"+i+" => "+ds_detail.GetColumn(i, "ZUAM"));
			}
			
			ds_detail.OnColumnChanged = "ds_detail_oncolumnchanged";
		    //ds_detail.OnRowPosChanged = "ds_detail_OnRowPosChanged";
		 }
		}
	// (2012.12.11) 주차,PSD,물류 - 원가산출버튼 안보임, Duty 비활성화
	if ( spart == "20" || spart == "40" || spart == "30" ) {

		btn_count.Visible = false;
		d.cb_block.Enable = false;
		d.btn_duty.Enable = false;
		if(spart != '20')
			d.btn_depend.Enable = false;
	}
}

function fn_queryTemplate() {
//trace("************29");
	if (flag == "I") {
		btn_plus_OnClick();
		flag = "";
	} else {
		nsfRequest("queryTemplate", "ses0031/searchTemplate", "ds_detail=ds_detail ds_template=ds_template", "ds_template=ds_template ds_error=ds_error", "", "fn_afterQuery");
		
		// trace("--------------------------" + ds_template.savexml());
	}
}

function fn_template(popupYn, nRow) {
	// trace(" ************30");
	if (ds_header.GetColumn(0, "SPART") == "30") return; // 물류는 사양 없음 (2012.12.12)

	fn_createWait("",this); // 처리중입니다. 메시지 처리

	var dstmp = object(ds_temp.ID     );
	var dst   = object(ds_template.ID );

	var ds0   = object(ds_template0.ID); ds0.OnColumnChanged = "";
	var ds1   = object(ds_template1.ID); ds1.OnColumnChanged = "";
	var ds2   = object(ds_template2.ID); ds2.OnColumnChanged = "";
	var ds3   = object(ds_template3.ID); ds3.OnColumnChanged = "";
	var ds4   = object(ds_template4.ID); ds4.OnColumnChanged = "";
	var ds5   = object(ds_template5.ID); ds5.OnColumnChanged = "";

	var ddvrtq  = ds_header.GetColumn(0, "CO_DDVRTQ" );
	var dephtq  = ds_header.GetColumn(0, "CO_DEPHTQ" );
	var dssq    = ds_header.GetColumn(0, "CO_DSSQ"   );
	var bclcdtq = ds_header.GetColumn(0, "CO_BCLCDTQ");
	var chpitq  = ds_header.GetColumn(0, "CO_CHPITQ" );
	var aspc    = ds_header.GetColumn(0, "CO_ASPC"   );
	var dsv1    = ds_header.GetColumn(0, "CO_DSV1"   );
	var dsv1tq  = ds_header.GetColumn(0, "CO_DSV1TQ" );
	var dsv2    = ds_header.GetColumn(0, "CO_DSV2"   );
	var dsv2tq  = ds_header.GetColumn(0, "CO_DSV2TQ" );

	var mandt      = "";
	var qtnum      = "";
	var qtser      = "";
	var qtseq      = "";
	var prseq      = "";
	var atkla      = "";
	var ds_flag    = "";
	var prd        = "";
	var prh        = "";
	var user_prd   = "";
	var user_flag  = "";
	var h          = "head";
	var t          = "Text";
	var searchRow  = 0;
	var matnr      = ds_detail.GetColumn(nRow, "MATNR");
	var user_qtseq = ds_detail.GetColumn(nRow, "QTSEQ");

	var maxprseq   = parseInt(ds_template_add.max("ZTPLSEQ"));
	var ztplseq    = 0;
	var addCnt     = 0;
	var prdCnt     = 0;

	var obj0 = tab.template.div_template.grd_template0;
	var obj1 = tab.template.div_template.grd_template1;
	var obj2 = tab.template.div_template.grd_template2;
	var obj3 = tab.template.div_template.grd_template3;
	var obj4 = tab.template.div_template.grd_template4;
	var obj5 = tab.template.div_template.grd_template5;
	var obj6 = tab.template.div_template;
	
	var fa  = "ATKLA==";
	var fa1 = fa+quote("EL_BASIC"  )+" || "+fa+quote("ES_BASIC" )+" || "+fa+quote("MW_BASIC" )+" || "+fa+quote("PSD_BASIC")+" || "+fa+quote("AP_BASIC")+" || Substr(PRH,0,3)=="+quote("WCL")+" || Substr(PRH,0,3)=="+quote("DW_")+" || Substr(PRH,0,3)=="+quote("SV_")+" || Substr(PRH,0,3)=="+quote("SP_");
	var fa2 = fa+quote("EL_INSIDE" )+" || "+fa+quote("ES_OPTION")+" || "+fa+quote("MW_OPTION")+" || "+fa+quote("PSD_SASH" );
	var fa3 = fa+quote("EL_OUTSIDE")+" || "+fa+quote("ES_SAFETY")+" || "+fa+quote("MW_SAFETY")+" || "+fa+quote("PSD_STEEL");
	var fa4 = fa+quote("EL_OPTION" )+" || "+fa+quote("ES_EXTER" )+" || "+fa+quote("MW_EXTER" )+" || "+fa+quote("PSD_ELEC" );
	var fa5 = fa+quote("EL_LAYOUT" );

	var fq  = "QTSEQ==" + quote(user_qtseq);
	var f1  = "Substr(PRH,0,3)==" + quote("CO_");
	var f2  = "Substr(PRH,0,3)!=" + quote("CO_");
	var fq1 = fq+" && "+f1;
	var fq2 = fq+" && "+f2;
    
	// Template 불러오기 & Duty call 처리 시 값이 변경된 경우에만 상태 Flag 변경
	if  (popupYn == "Y" || popupYn == "Duty") 	{
		ds_template.UnFilter();
		// 동일 MO의 최종 PRSEQ
		ds_temp.CopyF(ds_template.Filter("QTSEQ ==" + quote(user_qtseq)));
		var max_preseq = ds_temp.GetRowCount();

		var pre_flag = "";	// 이전상태
		var pre_prd  = "";	// 이전 값

		ds_template.UnFilter();
	
		for (var i = 0; i < ds_template_add.GetRowCount(); i++) {
			// PRD에 값이 존재하는지 확인
			prh = ds_template_add.GetColumn(i, "PRH");
			prd = trim(ds_template_add.GetColumn(i, "PRD"));

			// 공통 사양은 제외하고 처리 (최종적으로 공통사양 재 처리함)
			if (substr(prh, 0, 3) != "CO_") 	{
				// 기존 존재하는 
				searchRow = ds_template.searchRow("PRH ==" + quote(prh) + " && QTSEQ ==" + quote(user_qtseq));
				
				if (searchRow > -1)	{
					pre_flag = trim(ds_template.GetColumn(searchRow, "FLAG"));
					pre_prd  = trim(ds_template.GetColumn(searchRow, "PRD"));
					ds_template.SetColumn(searchRow, "PRD", prd);

					// FLAG 상태 변경 기존값과 다른경우 처리되도록
					if (pre_prd != prd && (pre_flag == null || pre_flag == "") )	{
						ds_template.SetColumn(searchRow, "FLAG", "U");
					}
				}
			}
		}
	}
	// 2013.02.18 ★★★★★  END NEW

//	dst.Filter(fq);
	if (popupYn != "C") { ds0.copy(dst); ds1.copy(dst); ds2.copy(dst); ds3.copy(dst); ds4.copy(dst); ds5.copy(dst); }
    //trace("qtseq!!!" + user_qtseq);
	zprdgbn = ds_detail.GetColumn(nRow, "ZPRDGBN");
	atkla   = " "; ds0.Filter(fa+quote(atkla) + " && Substr(PRHNAME, 0, 6) !=" + quote("REMARK") + " && Substr(PRH, 0, 3) !=" + quote("WCL") + " && Substr(PRH, 0, 3) !=" + quote("DW_") + " && Substr(PRH, 0, 3) !=" + quote("SP_"));

	dstmp.CopyF(ds0); ds0.Copy(dstmp); 	ds0.Filter(fq); if(IsValidObject(obj0)) obj0.SetCellProp(h,2,t,"COMMON");

	ds1.Filter(fa1); dstmp.CopyF(ds1); ds1.Copy(dstmp); ds1.Filter(fq);
	ds2.Filter(fa2); dstmp.CopyF(ds2); ds2.Copy(dstmp); ds2.Filter(fq);
	ds3.Filter(fa3); dstmp.CopyF(ds3); ds3.Copy(dstmp); ds3.Filter(fq);
	ds4.Filter(fa4); dstmp.CopyF(ds4); ds4.Copy(dstmp); ds4.Filter(fq);
	ds5.Filter(fa5); dstmp.CopyF(ds5); ds5.Copy(dstmp); ds5.Filter(fq);

	if (zprdgbn == "ELV_01" || zprdgbn == "ELV_02" || zprdgbn == "SHN_01") {

		obj1.Visible=true; obj1.SetCellProp(h,2,t,"BASIC"  );
		obj2.Visible=true; obj2.SetCellProp(h,2,t,"INSIDE" );
		obj3.Visible=true; obj3.SetCellProp(h,2,t,"OUTSIDE");
		obj4.Visible=true; obj4.SetCellProp(h,2,t,"OPTION" );
		obj5.Visible=true; obj5.SetCellProp(h,2,t,"LAYOUT" );
		obj0.Left = 2259;  obj6.Scroll = true; // 2013.02.07 사양 넓게 보이기 위해 사이즈 조정

	} else if (zprdgbn == "ESC_01" || zprdgbn == "SHN_02") {

		obj1.Visible=true; obj1.SetCellProp(h,2,t,"BASIC"   );
		obj2.Visible=true; obj2.SetCellProp(h,2,t,"OPTION"  );
		obj3.Visible=true; obj3.SetCellProp(h,2,t,"SAFETY"  );
		obj4.Visible=true; obj4.SetCellProp(h,2,t,"EXTERIOR");
		obj5.Visible=false; obj6.Scroll = true; obj0.Left = 1808; // 2013.02.07 사양 넓게 보이기 위해 사이즈 조정

	} else if (zprdgbn == "MW_01") {

		obj1.Visible=true; obj1.SetCellProp(h,2,t,"BASIC"   );
		obj2.Visible=true; obj2.SetCellProp(h,2,t,"OPTION"  );
		obj3.Visible=true; obj3.SetCellProp(h,2,t,"SAFETY"  );
		obj4.Visible=true; obj4.SetCellProp(h,2,t,"EXTERIOR");
		obj5.Visible=false; obj6.Scroll = true; obj0.Left = 1808; // 2013.02.07 사양 넓게 보이기 위해 사이즈 조정

	}  else if (zprdgbn == "AP_01") {

		obj1.Visible=true; obj1.SetCellProp(h,2,t,"BASIC");
		obj2.Visible=false;
		obj3.Visible=false;
		obj4.Visible=false;
		obj5.Visible=false; obj6.Scroll = false; obj0.Left = 455; // 2013.02.07 사양 넓게 보이기 위해 사이즈 조정
		obj0.Visible=false; obj6.ResizeScroll(); // (주차인 경우 공통사양 제외) (2012.12.10)

	}  else if (zprdgbn == "PSD_01") {

		obj1.Visible=true; obj1.SetCellProp(h,2,t,"BASIC");
		obj2.Visible=true; obj2.SetCellProp(h,2,t,"SASH" );
		obj3.Visible=true; obj3.SetCellProp(h,2,t,"STEEL");
		obj4.Visible=true; obj4.SetCellProp(h,2,t,"ELEC" );
		obj5.Visible=false; obj6.Scroll = true; obj0.Left = 1357; // 2013.02.07 사양 넓게 보이기 위해 사이즈 조정
		obj0.Visible=false; obj6.ResizeScroll(); // PSD인 경우 공통사양 제외 (2012.12.10)

	}  else if (zprdgbn == "SP_01" || zprdgbn == "SV_01" || zprdgbn = "WL_01" || zprdgbn = "DW_01") 
	{
		obj1.Visible = true; obj1.SetCellProp(h,2,t,"BASIC");
		obj2.Visible = false;
		obj3.Visible = false;
		obj4.Visible = false;
		obj5.Visible = false; obj6.Scroll = false; obj0.Left = 455; // 2013.02.07 사양 넓게 보이기 위해 사이즈 조정
	}
	obj6.resizeScroll(); // 2013.02.05 공통 안보이는 경우 있어서 스크롤 갱신

	if (popupYn == ""||popupYn == "Y" || popupYn == "Duty") {		// 2013.02.18 ★★★★★ Duty추가 반영
		ds_user0.ClearData(); ds_user0.copy(ds0);
		ds_user1.ClearData(); ds_user1.copy(ds1);
		ds_user2.ClearData(); ds_user2.copy(ds2);
		ds_user3.ClearData(); ds_user3.copy(ds3);
		ds_user4.ClearData(); ds_user4.copy(ds4);
		ds_user5.ClearData(); ds_user5.copy(ds5);
	}

	if (popupYn == "Y" || popupYn == "C" || popupYn == "A" || popupYn == "Duty") {

		var obj_template;
		var obj_user;

		for (var a=0; a<=5; a++) {

			switch (a) {
				case 0	: obj_template = object(ds0.ID); obj_user = object(ds_user0.ID); break;
				case 1	: obj_template = object(ds1.ID); obj_user = object(ds_user1.ID); break;
				case 2	: obj_template = object(ds2.ID); obj_user = object(ds_user2.ID); break;
				case 3	: obj_template = object(ds3.ID); obj_user = object(ds_user3.ID); break;
				case 4	: obj_template = object(ds4.ID); obj_user = object(ds_user4.ID); break;
				case 5	: obj_template = object(ds5.ID); obj_user = object(ds_user5.ID); break;
				default : break;
			}

			for (var i=0; i<obj_template.GetRowCount(); i++) {
				prd       = obj_template.GetColumn(i, "PRD");
				atkla     = obj_template.GetColumn(i, "ATKLA");
				prh       = obj_template.GetColumn(i, "PRH"  );
				searchRow = obj_user.searchRow("ATKLA ==" + quote(atkla) + " && PRH ==" + quote(prh) + " && QTSEQ ==" + quote(user_qtseq));
				user_prd  = Trim(obj_user.GetColumn(searchRow, "PRD"));
				user_flag = Trim(obj_user.GetColumn(searchRow, "FLAG"));
				ds_flag   = obj_template.GetColumn(i, "FLAG");

				if (prd != null && prd != "" ) {
					if (prd != user_prd) {

						switch (user_flag) {
							case "U" : obj_template.SetColumn(i, "PRD", user_prd); break;
							default  : obj_template.SetColumn(i, "PRD", prd);	   break;
						}
						if (ds_flag == "I") obj_template.SetColumn(i, "FLAG", "I");
						else                obj_template.SetColumn(i, "FLAG", "U");
					}
				} else {
					if (user_prd != null && user_prd != "") {
						obj_template.SetColumn(i, "PRD" , user_prd);
						if (ds_flag == "I") obj_template.SetColumn(i, "FLAG", "I");
						else                obj_template.SetColumn(i, "FLAG", "U");
					}
				}
			}
		}
	}

	ds0.OnColumnChanged = "ds_template_OnColumnChanged";
	ds1.OnColumnChanged = "ds_template_OnColumnChanged";

	for (var i=0; i<ds1.GetRowCount(); i++) { // 2013.02.14 데이터 왜곡을 막기 위해서 주석처리하고 테스트

		atkla = ds1.GetColumn(i, "ATKLA");
		prh   = ds1.GetColumn(i, "PRH"  );

		if (atkla == "EL_BASIC") {
			switch (prh) {
				case "EL_ACD1"  : prd = ds_detail.GetColumn(nRow, "ZSAREA"); ds1.SetColumn(i, "PRD", prd); break;
				case "EL_ATYP"  : prd = ds_detail.GetColumn(nRow, "GTYPE" ); ds1.SetColumn(i, "PRD", prd); break;
				case "EL_AUSE"  : prd = ds_detail.GetColumn(nRow, "ZUSE"  ); ds1.SetColumn(i, "PRD", prd); break;
				case "EL_ACAPA" : prd = ds_detail.GetColumn(nRow, "ZACAPA"); ds1.SetColumn(i, "PRD", prd); break;
				case "EL_ASTQ"  : prd = ds_detail.GetColumn(nRow, "ZLEN"  ); ds1.SetColumn(i, "PRD", prd); break;
				case "EL_AOPEN" : prd = ds_detail.GetColumn(nRow, "ZOPN"  ); ds1.SetColumn(i, "PRD", prd); break;
				case "EL_AMAN"  : prd = ds_detail.GetColumn(nRow, "TYPE1"); ds1.SetColumn(i, "PRD", prd); break;
				case "EL_ASPD"  : prd = ds_detail.GetColumn(nRow, "TYPE2"); ds1.SetColumn(i, "PRD", prd); break;
				case "EL_AFQ"   : prd = ds_detail.GetColumn(nRow, "TYPE3"); ds1.SetColumn(i, "PRD", prd); break;
				case "EL_ALOCT" : prd = ds_header.GetColumn(0, "ZLZONE"); ds1.SetColumn(i, "PRD", prd); break;
				case "EL_ADTA"  : prd = ds_header.GetColumn(0, "REGION"); ds1.SetColumn(i, "PRD", prd); break;
				/*case "EL_ACD2"  :   국내 STVF 일때 코드 자동 적용 201309
					if ( ds_detail.GetColumn(nRow, "ZSAREA") == "D" && ds_detail.GetColumn(nRow, "GTYPE") == "SSVF" ) 
					{
						ds1.SetColumn(i, "PRD", "EN81"); 
					}*/
					break;
				default         : break;
			}
		} else if (atkla == "ES_BASIC") {
			switch (prh) {
				case "ES_ALOCA" : prd = ds_detail.GetColumn(nRow, "SHANGH");
								  switch (prd) {
									case "상해" : prd = "SHAN"; break;
									default     : prd = "DOMA"; break;
								  }
								  ds1.SetColumn(i, "PRD", prd); break;
				case "ES_ALOCAT": prd = ds_detail.GetColumn(nRow, "ZSAREA"); ds1.SetColumn(i, "PRD", prd); break;
				case "ES_ATYP"  : prd = ds_detail.GetColumn(nRow, "GTYPE" ); ds1.SetColumn(i, "PRD", prd); break;
				case "ES_AWID"  : prd = ds_detail.GetColumn(nRow, "TYPE1" ); ds1.SetColumn(i, "PRD", prd); break;
				case "ES_ADEG"  : prd = ds_detail.GetColumn(nRow, "TYPE2" ); ds1.SetColumn(i, "PRD", prd); break;
				case "ES_ARISE" : prd = ds_detail.GetColumn(nRow, "TYPE3" ); ds1.SetColumn(i, "PRD", prd); break;
				case "ES_ASPE"  : prd = ds_detail.GetColumn(nRow, "ZLEN"  ); ds1.SetColumn(i, "PRD", prd); break;
				case "ES_ALOCT" : prd = ds_header.GetColumn(0, "ZLZONE"); ds1.SetColumn(i, "PRD", prd); break;
				case "ES_ADTA"  : prd = ds_header.GetColumn(0, "REGION"); ds1.SetColumn(i, "PRD", prd); break;
				default         : break;
			}
		} else if (atkla == "MW_BASIC") {
			switch (prh) {
				case "MW_ALOCA" : prd = ds_detail.GetColumn(nRow, "SHANGH");
								  switch (prd) {
									case "상해" : prd = "SHAN"; break;
									default     : prd = "DOMA"; break;
								  }
								  ds1.SetColumn(i, "PRD", prd); break;
				case "MW_ALOCAT": prd = ds_detail.GetColumn(nRow, "ZSAREA"); ds1.SetColumn(i, "PRD", prd); break;
				case "MW_ATYP"  : prd = ds_detail.GetColumn(nRow, "GTYPE" ); ds1.SetColumn(i, "PRD", prd); break;
				case "MW_AWID"  : prd = ds_detail.GetColumn(nRow, "TYPE1" ); ds1.SetColumn(i, "PRD", prd); break;
				case "MW_ADEG"  : prd = ds_detail.GetColumn(nRow, "TYPE2" ); ds1.SetColumn(i, "PRD", prd); break;
				case "MW_ARIS"  : prd = ds_detail.GetColumn(nRow, "TYPE3" ); ds1.SetColumn(i, "PRD", prd); break;
				case "MW_ASPE"  : prd = ds_detail.GetColumn(nRow, "ZLEN"  ); ds1.SetColumn(i, "PRD", prd); break;
				case "MW_ALENG" : prd = ds_detail.GetColumn(nRow, "ZOPN"  ); ds1.SetColumn(i, "PRD", prd); break;
				case "MW_ALOCT" : prd = ds_header.GetColumn(0, "ZLZONE"); ds1.SetColumn(i, "PRD", prd); break;
				case "MW_ADTA"  : prd = ds_header.GetColumn(0, "REGION"); ds1.SetColumn(i, "PRD", prd); break;
				default         : break;
			}
		} else if (atkla == "AP_BASIC") { // (2012.12.10)
			switch (prh) {
				case "AP_ATYP"  : prd = ds_detail.GetColumn(nRow, "GTYPE") ; ds1.SetColumn(i, "PRD", prd); break;
				case "AP_AMOD"  : prd = ds_detail.GetColumn(nRow, "ZUSE")  ; ds1.SetColumn(i, "PRD", prd); break;
				case "AP_AEA"   : prd = ds_detail.GetColumn(nRow, "TYPE1") ; ds1.SetColumn(i, "PRD", prd); break;
				case "AP_ACS"   : prd = ds_detail.GetColumn(nRow, "ZACAPA"); ds1.SetColumn(i, "PRD", prd); break;
				case "AP_AQL"   : prd = ds_detail.GetColumn(nRow, "TYPE2") ; ds1.SetColumn(i, "PRD", prd); break;
				case "AP_AQC"   : prd = ds_detail.GetColumn(nRow, "TYPE3") ; ds1.SetColumn(i, "PRD", prd); break;
				case "AP_AQT"   : prd = ds_detail.GetColumn(nRow, "ZLEN")  ; ds1.SetColumn(i, "PRD", prd); break;
				case "AP_AETS"  : prd = ds_detail.GetColumn(nRow, "ZOPN")  ; ds1.SetColumn(i, "PRD", prd); break;
				default         : break;
			}
		} else if (atkla == "PSD_BASIC") { // (2012.12.10)
			switch (prh) {
				case ""          : prd = ds_detail.GetColumn(nRow, "GTYPE"); ds1.SetColumn(i, "PRD", prd); break;
				case ""          : prd = ds_detail.GetColumn(nRow, "TYPE1"); ds1.SetColumn(i, "PRD", prd); break;
				default          : break;
			}
		}
	}

	ds2.OnColumnChanged = "ds_template_OnColumnChanged";
	ds3.OnColumnChanged = "ds_template_OnColumnChanged";
	ds4.OnColumnChanged = "ds_template_OnColumnChanged";

	for (var i=0; i<ds4.GetRowCount(); i++) {

		atkla = ds4.GetColumn(i, "ATKLA");
		prh   = ds4.GetColumn(i, "PRH"  );
		prd   = ds4.GetColumn(i, "PRD"  );

		if (atkla == "EL_OPTION" && Substr(prh, 0, 7) == "EL_FDSP") {
			//ds4.SetColumn(i, "PRD",  Replace(prd, ",", "")); // 2013.01.23 개별입력가격 숫자에 , 있었을 때 오류 확인을 위해서는 조회한 값을 그대로 보여줘야 함
		}
	}

	ds5.OnColumnChanged = "ds_template_OnColumnChanged";

	// 2013.02.15
	if ( popupYn == "Duty" ) {
		var ds_h = ds_header;
		fn_aspc("", "", "", 0, 0, 0, 0, ds_h);					// 시방서 처리
		fn_bcpi("", "", "", "", "", "", "", 0, 0, 0, 0, ds_h);  // LED 총 수량
		fn_bclcd("", "", "", "", 0, 0, 0, 0, ds_h); 			// LCD 총 수량
		fn_deph("", "", "", 0, 0, 0, 0, ds_h);					// 비상통화장치 DI-PBX 적용대수
		fn_ddvr("", "", "", 0, 0, 0, 0, ds_h);					// DVR 적용대수
		//fn_drvhq("", "", "", 0, 0, 0, 0, ds_h);					// 행선층 예약시스템 적용대수
		fn_dsv1("", "", "", 0, 0, 0, 0, ds_h);					// 감시반1
		fn_dsv2("", "", "", 0, 0, 0, 0, ds_h);					// 감시반2
		fn_aspd();												// 고속현장 2013.04.03
	}

	ds1.Sort("PRHNAME",True); ds2.Sort("PRHNAME",True); ds3.Sort("PRHNAME",True); ds4.Sort("PRHNAME",True);	ds5.Sort("PRHNAME",True);

	fn_destroyWait();
}

function fn_save_header() {
//trace("************31");
	if (ds_header.rowcount == 0) { gfn_showAlert("CW10062"); return false; } // 견적 Header가 없습니다.

	var mandt   = ds_header.GetColumn(0, "MANDT"      ); // 클라이언트
	var qtnum   = ds_header.GetColumn(0, "QTNUM"      ); // 견적번호
	var qtser   = ds_header.GetColumn(0, "QTSER"      ); // 견적차수
	var qtdat   = ds_header.GetColumn(0, "QTDAT"      ); // 견적일자
	var spart   = ds_header.GetColumn(0, "SPART"      ); // 제품군
	var qtgbn   = ds_header.GetColumn(0, "QTGBN"      ); // 견적구분 2013.02.05
	var zbdtyp  = ds_header.GetColumn(0, "ZBDTYP"     ); // 건물용도
	var zprgflg = ds_header.GetColumn(0, "ZPRGFLG"    ); // 진행상태
	var vkbur   = ds_header.GetColumn(0, "VKBUR"      ); // 사업장
	var vkgrp   = ds_header.GetColumn(0, "VKGRP"      ); // 영업그룹
	var zkunnr  = ds_header.GetColumn(0, "ZKUNNR"     ); // 담당자
	var kunnr   = ds_header.GetColumn(0, "KUNNR"      ); // 고객번호
	var gsnam   = ds_header.GetColumn(0, "GSNAM"      ); // 공사명
	var zestdat = ds_header.GetColumn(0, "ZESTDAT"    ); // 입찰예정일
	var deldat  = ds_header.GetColumn(0, "DELDAT"     ); // 납기예정일
	var zpid    = ds_header.GetColumn(0, "ZPID"       ); // 현장담당자
	var ztel    = ds_header.GetColumn(0, "ZTEL"       ); // 현장연락처
	var zpost   = ds_header.GetColumn(0, "ZADDR_ZPOST"); // 현장우편번호
	var addr1   = ds_header.GetColumn(0, "ZADDR_ADR1" ); // 현장주소1
	var addr2   = ds_header.GetColumn(0, "ZADDR_ADR2" ); // 현장주소2
	var zregn   = ds_header.GetColumn(0, "ZREGN"      ); // 지역
	var byrgbn  = ds_header.GetColumn(0, "FA_BYRGBN"  ); // 업종구분 - 물류 전용 2013.02.18
    var jgbn    = ds_header.GetColumn(0, "JGBN"      ); // 주차설비유무
    var zicif_pprt = ds_header.GetColumn(0, "ZICIF_PPRT"); // 선수금율
    var zicif_1strt = ds_header.GetColumn(0, "ZICIF_1STRT"); // 1차중도금율
    var zicif_2strt = ds_header.GetColumn(0, "ZICIF_2STRT"); // 2차중도금율
    var zicif_rmrt = ds_header.GetColumn(0, "ZICIF_RMRT"); // 잔금율
    
	var h       = tab.main.div_header;
	var zeam    = "";
	var matnr   = "";
	var znumber = "";
	var zprdgbn = "";
	var gtype   = "";
	var zuse    = "";
	var type1   = ""; // 인승, 폭
	var type2   = ""; // 속도, 각도
	var type3   = ""; // 층수
	var zacapa  = ""; // 용량
	var zlen    = ""; // 정지층수, 속도
	var zopn    = ""; // 도어개폐
	var arr;
	var cnt     = 0;
	var Date = gfn_getAfterDate(ds_header.GetColumn(0, ""), 365);

	if (qtdat   == null || qtdat   == "00000000") {	cnt++; gfn_showAlert("CW10037"); cal_qtdat.SetFocus();             return false;	} // 견적일자
	if (spart   == null || spart   == ""        ) {	cnt++; gfn_showAlert("CW10038"); h.cb_spart.SetFocus();            return false;	} // 제품군
	if (qtgbn   == null || qtgbn   == ""        ) { cnt++; gfn_showAlert("CW10039"); h.cb_qtgbn.SetFocus();            return false; 	} // 견적구분 2013.02.05
	if (zprgflg == null || zprgflg == ""        ) {	cnt++; gfn_showAlert("CW10041"); h.cb_zprgflg.SetFocus();          return false;	} // 진행상태
	if (vkbur   == null || vkbur   == ""        ) {	cnt++; gfn_showAlert("CW10042"); h.cb_vkbur.SetFocus();            return false;	} // 사업장
	if (vkgrp   == null || vkgrp   == ""        ) {	cnt++; gfn_showAlert("CW10043"); h.cb_vkgrp.SetFocus();            return false;	} // 영업그룹
	if (zkunnr  == null || zkunnr  == ""        ) {	cnt++; gfn_showAlert("CW10047"); h.div_sman.ed_sman_cd.SetFocus(); return false;	} // 담당자
	if (kunnr   == null || kunnr   == ""        ) {	cnt++; gfn_showAlert("CW10048"); h.ed_kunnr.SetFocus();            return false;	} // 고객번호
	if (gsnam   == null || gsnam   == ""        ) {	cnt++; gfn_showAlert("CW10049"); h.ed_gsnam.SetFocus();            return false;	} // 공사명
//	if (zdev    == null || zdev    == ""        ) { cnt++; gfn_showAlert(""); h.ed_dev.SetFocus();              return; } // 시행사
	if (zestdat == null || zestdat == "00000000") { cnt++; gfn_showAlert("CW10050"); h.cal_zestdat.SetFocus();         return false; } // 입찰예정일
	
	if (deldat  == null || deldat  == "00000000") {	cnt++; gfn_showAlert("CW10051"); h.cal_deldat.SetFocus();          return false; } // 납기예정일
	
	if (zbdtyp  == null || zbdtyp  == ""        ) { cnt++; gfn_showAlert("CW10040"); h.cb_zbdtyp.SetFocus();           return false; } // 건물용도
	//if (zregn   == null || zregn   == ""        ) {	cnt++; gfn_showAlert("CW10056"); h.cb_zregn1.SetFocus();           return false; } // 지역
	if (zpid    == null || zpid    == ""        ) { cnt++; gfn_showAlert("CW10052"); h.ed_pid.SetFocus();              return false; } // 현장담당자
	if (ztel    == null || ztel    == ""        ) { cnt++; gfn_showAlert("CW10053"); h.ed_tel.SetFocus();              return false; } // 현장연락처
	if (zpost   == null || zpost   == ""        ) {	cnt++; gfn_showAlert("CW10054"); h.med_zipcode.SetFocus();         return false; } // 우편번호
//	if (addr1   == null || addr1   == ""        ) {	cnt++; gfn_showAlert("CW10055"); h.ed_addr1.SetFocus();            return false; } // 현장주소
	//if (addr2   == null || addr2   == ""        ) {	cnt++; gfn_showAlert("CW10055"); h.ed_addr2.SetFocus();            return false; } // 현장주소
	if ( byrgbn == null || byrgbn == "" ) { cnt++; gfn_showAlert("CW00116", "도급구분"); h.cb_fa_byrgbn.SetFocus(); return false; } // 업종구분 - 물류전용 2013.02.18
	if (zicif_pprt == "") { cnt++; gfn_showAlert("선수금율을 입력해주세요."); h.zicif_pprt.SetFocus(); return false; } // 선수금비율 
	if (zicif_1strt == "" || zicif_2strt == "") { cnt++; gfn_showAlert("중도금율을 입력해주세요."); h.zicif_1strt.SetFocus(); return false; } // 중도금비율 
	if (zicif_rmrt == "") { cnt++; gfn_showAlert("잔금율을 입력해주세요."); h.zicif_rmrt.SetFocus(); return false; } // 잔금비율 
	
    if (jgbn    == "A"){ //주차설비 '유' 체크 시 , 내용 저장 필수 체크 
		http.sync = "true";
		//ds_headerJ.ClearData();
		//ds_headerJ.AddRow();
		//ds_headerJ.SetColumn(0, "MANDT"  , G_MANDT   );
		
		var inDs = "ds_cond=ds_header"
		         + " ds_header=ds_headerJ";
		var outDs ="ds_headerJ=ds_header"
				 + " ds_error=ds_error"	;

		nsfRequest("", "ses0052/find", inDs, outDs, "", "");
		//trace(ds_headerJ.savexml());
		if (ds_headerJ.GetRowCount() < 1) {
			gfn_showAlert("CW10025", "주차설비 '유' 입력시 상세내역 입력 및 저장 바랍니다.");
			return false;
		}
		
		http.sync = "false";
    }	 
	for (var i = 0; i < ds_detail.GetRowCount(); i++) 	{

		zprdgbn = Trim(ds_detail.GetColumn(i, "ZPRDGBN")); // 
		gtype   = Trim(ds_detail.GetColumn(i, "GTYPE"  )); // 기종
		zuse    = Trim(ds_detail.GetColumn(i, "ZUSE"   )); // 용도
		type1   = Trim(ds_detail.GetColumn(i, "TYPE1"  )); // 인승, 폭
		type2   = Trim(ds_detail.GetColumn(i, "TYPE2"  )); // 속도, 각도
		type3   = Trim(ds_detail.GetColumn(i, "TYPE3"  )); // 층수
		zacapa  = Trim(ds_detail.GetColumn(i, "ZACAPA" )); // 용량
		zlen    = Trim(ds_detail.GetColumn(i, "ZLEN"   )); // 정지층수, 속도
		zopn    = Trim(ds_detail.GetColumn(i, "ZOPN"   )); // 도어개폐

		znumber = ds_detail.GetColumn(i, "ZNUMBER");
		zeam    = ds_detail.GetColumn(i, "ZEAM");
		matnr   = ds_detail.GetColumn(i, "MATNR");

		if (matnr != "T-1000" && matnr != "Y-1000") {

			if (gtype =="" || gtype ==null) { cnt++; arr=[(i+1), "기종"]; gfn_showAlert("CW10034",arr); h.grd_detail.SetFocus(); return false; }
			if (zeam < 0) {cnt++; arr=[(i+1), "견적가"]; gfn_showAlert("견적가에는 음수를 입력할 수 없습니다."); h.grd_detail.SetFocus(); return false;}

			if (zprdgbn == "ELV_01" || zprdgbn == "ELV_02" || zprdgbn == "SHN_01") {

				if (zuse  =="" || zuse  ==null) { cnt++; arr=[(i+1), "용도"    ]; gfn_showAlert("CW10034",arr); h.grd_detail.SetFocus(); return false; }
				if (type1 =="" || type1 ==null) {
					if ( zuse != "PF" && zuse != "FT" && zuse != "AM" && zuse != "HF" ) { // 용도가 PF-인화,FT-화물,AM-자동차,HF-인화,장애 일 때는 인승이 필수가 아님
						cnt++; arr=[(i+1), "인승"    ]; gfn_showAlert("CW10034",arr); h.grd_detail.SetFocus(); return false;
					}
				}
				if (type2 =="" || type2 ==null) { cnt++; arr=[(i+1), "속도"    ]; gfn_showAlert("CW10034",arr); h.grd_detail.SetFocus(); return false; }
				if (type3 =="" || type3 ==null) { cnt++; arr=[(i+1), "층수"    ]; gfn_showAlert("CW10034",arr); h.grd_detail.SetFocus(); return false; }
				if (zacapa=="" || zacapa==null) { cnt++; arr=[(i+1), "용량"    ]; gfn_showAlert("CW10034",arr); h.grd_detail.SetFocus(); return false; }
				if (zlen  =="" || zlen  ==null) { cnt++; arr=[(i+1), "정지층수"]; gfn_showAlert("CW10034",arr); h.grd_detail.SetFocus(); return false; }
				if (zopn  =="" || zopn  ==null) { cnt++; arr=[(i+1), "도어개폐"]; gfn_showAlert("CW10034",arr); h.grd_detail.SetFocus(); return false; }

			} else if (zprdgbn == "ESC_01" || zprdgbn == "SHN_02") {

				if (type1 =="" || type1 ==null) { cnt++; arr=[(i+1), "폭"  ]; gfn_showAlert("CW10034",arr); h.grd_detail.SetFocus(); return false; }
				if (type2 =="" || type2 ==null) { cnt++; arr=[(i+1), "각도"]; gfn_showAlert("CW10034",arr); h.grd_detail.SetFocus(); return false; }
				if (type3 =="" || type3 ==null) { cnt++; arr=[(i+1), "높이"]; gfn_showAlert("CW10034",arr); h.grd_detail.SetFocus(); return false; }
				if (zlen  =="" || zlen  ==null) { cnt++; arr=[(i+1), "속도"]; gfn_showAlert("CW10034",arr); h.grd_detail.SetFocus(); return false; }

			} else if (zprdgbn == "MW_01") {

				if (type1 =="" || type1 ==null) { cnt++; arr=[(i+1), "폭"  ]; gfn_showAlert("CW10034",arr); h.grd_detail.SetFocus(); return false; }
				if (type2 =="" || type2 ==null) { cnt++; arr=[(i+1), "각도"]; gfn_showAlert("CW10034",arr); h.grd_detail.SetFocus(); return false; }
				if (type3 =="" || type3 ==null) { cnt++; arr=[(i+1), "높이"]; gfn_showAlert("CW10034",arr); h.grd_detail.SetFocus(); return false; }
				if (zlen  =="" || zlen  ==null) { cnt++; arr=[(i+1), "속도"]; gfn_showAlert("CW10034",arr); h.grd_detail.SetFocus(); return false; }
				if (zopn  =="" || zopn  ==null) { cnt++; arr=[(i+1), "길이"]; gfn_showAlert("CW10034",arr); h.grd_detail.SetFocus(); return false; }

			} else if (zprdgbn == "AP_01") {

				if (Substr(ZUSE, 0, 2) == "AE") {
					if (TYPE1=="" || TYPE1==null) { cnt++; arr=[(i+1), "승입방향"]; gfn_showAlert("CW10034",arr); h.grd_detail.SetFocus(); return false; }
				}
				if (zacapa=="" || zacapa==null) { cnt++; arr=[(i+1), "수용차종"]; gfn_showAlert("CW10034",arr); h.grd_detail.SetFocus(); return false; }
				if (ZUSE =="" || ZUSE ==null) { cnt++; arr=[(i+1), "모델명"  ]; gfn_showAlert("CW10034",arr); h.grd_detail.SetFocus(); return false; }
				if (type2 =="" || type2 ==null) { cnt++; arr=[(i+1), "단수"    ]; gfn_showAlert("CW10034",arr); h.grd_detail.SetFocus(); return false; }
				if (type3 =="" || type3 ==null) { cnt++; arr=[(i+1), "파렛트수"]; gfn_showAlert("CW10034",arr); h.grd_detail.SetFocus(); return false; }
				if ( gtype == "CRT" ) {   //crt 인 경우만 리프트수 필수 2013.07.15
				  if (zlen  =="" || zlen  ==null) { cnt++; arr=[(i+1), "리프트수"]; gfn_showAlert("CW10034",arr); h.grd_detail.SetFocus(); return false; }
				}
				if (zopn  =="" || zopn  ==null) { cnt++; arr=[(i+1), "외부턴"  ]; gfn_showAlert("CW10034",arr); h.grd_detail.SetFocus(); return false; }

			} else if (zprdgbn == "PSD_01") {
				if (type1 =="" || type1 ==null) { cnt++; arr=[(i+1), "역사명"  ]; gfn_showAlert("CW10034",arr); h.grd_detail.SetFocus(); return false; }
			}

			if (znumber=="" || znumber==null || Round(znumber, 0) ==0) {
				//cnt++; arr=[(i+1), "대수"  ]; gfn_showAlert("CW10034",arr); h.grd_detail.SetFocus(); return false; // 대수
			}
			
			// 2013.01.11 견적가 체크 (B400 부서 체크 로직 제외) -> 원가산출 이후 체크하도록 
			// if (zprgflg >= "32" && (zeam=="" || zeam==null || Round(zeam, 0) ==0)) {
				// cnt++;
				// arr=[(i+1), "견적가"];
				// gfn_showAlert("CW10034",arr);
				// h.grd_detail.SetFocus();
				// return false; // 견적가
			// }
		}
	}
	if (cnt==0) return true;
	else        return false;
}

function fn_save_template() {
//trace("************32");
	var iu_flag      = "";
	var qtnum        = ds_header.GetColumn(0, "QTNUM");
	var qtser        = ds_header.GetColumn(0, "QTSER");
	var qtseq        = "";
	var prd          = "";
	var prh          = "";
	var atkla        = "";
	var mclass       = "";
	var matnr        = "";
	var j            = 0;
	var detail_qtseq = "";
	var detail_flag  = "";
	var obj;

	// 공용사양의 고속현장 추가에 따른 기 Data의 일치화를 위한 재 호출
	// 고속현장 2013.04.03
	fn_aspd();

	ds_template_save.ClearData();

	for (var a=0; a<ds_detail.GetRowCount(); a++) {
		detail_flag  = ds_detail.GetColumn(a, "FLAG"  );
		detail_qtseq = ds_detail.GetColumn(a, "QTSEQ" );
		mclass       = ds_detail.GetColumn(a, "MCLASS");
		matnr        = ds_detail.GetColumn(a, "MATNR" );

		if (detail_flag == "D") {
			for (var b= ds_template.GetRowCount()-1; b>=0; b--) {
				qtseq = ds_template.GetColumn(b, "QTSEQ");
				if (detail_qtseq == qtseq) ds_template.DeleteRow(b);
			}
			// 2013.02.18 ★★★★★
			for ( var b = ds_template0.GetRowCount()-1 ; b >= 0 ; b-- ) {
				qtseq = ds_template0.GetColumn(b, "QTSEQ");
				if ( detail_qtseq == qtseq ) ds_template0.DeleteRow(b);
			}
			for ( var b = ds_template1.GetRowCount()-1 ; b >= 0 ; b-- ) {
				qtseq = ds_template1.GetColumn(b, "QTSEQ");
				if ( detail_qtseq == qtseq ) ds_template1.DeleteRow(b);
			}
			for ( var b = ds_template2.GetRowCount()-1 ; b >= 0 ; b-- ) {
				qtseq = ds_template2.GetColumn(b, "QTSEQ");
				if ( detail_qtseq == qtseq ) ds_template2.DeleteRow(b);
			}
			for ( var b = ds_template3.GetRowCount()-1 ; b >= 0 ; b-- ) {
				qtseq = ds_template3.GetColumn(b, "QTSEQ");
				if ( detail_qtseq == qtseq ) ds_template3.DeleteRow(b);
			}
			for ( var b = ds_template4.GetRowCount()-1 ; b >= 0 ; b-- ) {
				qtseq = ds_template4.GetColumn(b, "QTSEQ");
				if ( detail_qtseq == qtseq ) ds_template4.DeleteRow(b);
			}
			for ( var b = ds_template5.GetRowCount()-1 ; b >= 0 ; b-- ) {
				qtseq = ds_template5.GetColumn(b, "QTSEQ");
				if ( detail_qtseq == qtseq ) ds_template5.DeleteRow(b);
			}
			// 2013.02.18 ★★★★★
		}
	}

	for (var a=0; a<=5; a++) {

		switch (a) {
			case 0	: obj = object(ds_template0.ID); break;
			case 1	: obj = object(ds_template1.ID); break;
			case 2	: obj = object(ds_template2.ID); break;
			case 3	: obj = object(ds_template3.ID); break;
			case 4	: obj = object(ds_template4.ID); break;
			case 5	: obj = object(ds_template5.ID); break;
			default : break;
		}

		obj.UnFilter();

		for (var i=0; i<obj.GetRowCount(); i++) {

			iu_flag = obj.GetColumn(i, "FLAG" );
			atkla   = obj.GetColumn(i, "ATKLA");
			prh     = obj.GetColumn(i, "PRH"  );

			// 2013.02.22 공통사양 처리
			if (iu_flag == "I" || iu_flag == "U" || iu_flag == "A" || prh == "EL_ALOCT" || prh == "EL_ADTA" ||
			    prh == "CO_DDVRTQ" || prh == "CO_DEPHTQ" || prh == "CO_DSSQ" || prh == "CO_BCLCDTQ" ||
			    prh == "CO_CHPITQ" || prh == "CO_ASPC"   || prh == "CO_DSV1" || prh == "CO_DSV1TQ"  ||
			    prh == "CO_DSV2"   || prh == "CO_DSV2TQ" ) {
				if (atkla == " ") {
					switch (prh) {
						case "CO_DDVRTQ" : prd = ds_header.GetColumn(0, "CO_DDVRTQ" ); break;
						case "CO_DEPHTQ" : prd = ds_header.GetColumn(0, "CO_DEPHTQ" ); break;
						case "CO_DSSQ"   : prd = ds_header.GetColumn(0, "CO_DSSQ"   ); break;
						case "CO_BCLCDTQ": prd = ds_header.GetColumn(0, "CO_BCLCDTQ"); break;
						case "CO_CHPITQ" : prd = ds_header.GetColumn(0, "CO_CHPITQ" ); break;
						case "CO_ASPC"   : prd = ds_header.GetColumn(0, "CO_ASPC"   ); break;
						case "CO_DSV1"   : prd = ds_header.GetColumn(0, "CO_DSV1"   ); break;
						case "CO_DSV1TQ" : prd = ds_header.GetColumn(0, "CO_DSV1TQ" ); break;
						case "CO_DSV2"   : prd = ds_header.GetColumn(0, "CO_DSV2"   ); break;
						case "CO_DSV2TQ" : prd = ds_header.GetColumn(0, "CO_DSV2TQ" ); break;
						default          : prd = obj.GetColumn(i, "PRD"); break;
					}
				} else {
					switch (prh) {
						case "EL_ALOCT" : prd = ds_header.GetColumn(0, "ZLZONE"); ds_template1.SetColumn(i, "PRD", prd); iu_flag = "U"; break;
						case "EL_ADTA"  : prd = ds_header.GetColumn(0, "REGION"); ds_template1.SetColumn(i, "PRD", prd); iu_flag = "U"; break;
						default         : prd = Trim(obj.GetColumn(i, "PRD")); break;
					}
				}

				if (iu_flag == "I" && (prd == "" || prd == null)) {

				} else {
					ds_template_save.AddRow();

					// 2013.02.22 공통사양의 값이 존재하는 경우에는 상태를 U로 처리
					if (iu_flag == null || iu_flag == "")	{
					
						if (SubStr(prh, 0, 3) == "CO_")	{
							iu_flag = "U";
						}
					}
					// 2013.02.22 공통사양의 값이 존재하는 경우에는 상태를 U로 처리
					
					ds_template_save.SetColumn(j, "FLAG"  , iu_flag                   );
					ds_template_save.SetColumn(j, "MANDT" , obj.GetColumn(i, "MANDT" ));
					ds_template_save.SetColumn(j, "PRH"   , obj.GetColumn(i, "PRH"   ));
					ds_template_save.SetColumn(j, "PRD"   , prd                       );
					ds_template_save.SetColumn(j, "ZRMK"  , obj.GetColumn(i, "ZRMK"  ));
					ds_template_save.SetColumn(j, "QTNUM" , qtnum                     );
					ds_template_save.SetColumn(j, "QTSER" , qtser                     );
					ds_template_save.SetColumn(j, "QTSEQ" , obj.GetColumn(i, "QTSEQ" ));
					ds_template_save.SetColumn(j, "PRSEQ" , obj.GetColumn(i, "PRSEQ" ));
					j++;
				}
			}
		}
	}
}

function fn_z302() {
//trace("************33");
	var prdm01; var prdm02; var prdm03; var prdm04; var prdm05;
	var prdl01; var prdl02; var prdl03; var prdl04; var prdl05;
	var prde01; var prde02; var prde03; var prde04;	var prde05;	var prde06; var prde07; var prde08; var prde09;	var prde10;	var prde11; var prde12; var prde13; var prde14;	var prde15;
	var prdi01; var prdi02; var prdi03; var prdi04;
	var eqmm01; var eqmm02; var eqmm03; var eqmm04; var eqmm05;
	var eqma01; var eqma02;
	var eqml01; var eqml02; var eqml03; var eqml04;	var eqml05;
	var eqme01; var eqme02; var eqme03; var eqme04;	var eqme05;	var eqme06; var eqme07; var eqme08; var eqme09; var eqme10;	var eqme11; var eqme12; var eqme13; var eqme14; var eqme15;
	var eqme51; var eqme52; var eqme53; var eqme54;	var eqme55;	var eqme56; var eqme57; var eqme58; var eqme59;	var eqme60;	var eqme61; var eqme62; var eqme63; var eqme64;	var eqme65;	var eqme66; var eqme67; var eqme68; var eqme69; var eqme70;
	var eqme71; var eqme72; var eqme73; var eqme74;	var eqme75;	var eqme76; var eqme77; var eqme78; var eqme79;	var eqme80;	var eqme81; var eqme82; var eqme83; var eqme84;	var eqme85;	var eqme86; var eqme87; var eqme88; var eqme89; var eqme90;
	var eqme91; var eqme92; var eqme93; var eqme94;	var eqme95;	var eqme96; var eqme97; var eqme98; var eqme99;
	var eqmi01; var eqmi02; var eqmi03;
	var eqmo01; var eqmo02; var eqmo03; var eqmo04;	var eqmo05;	var eqmo06; var eqmo07; var eqmo08; var eqmo09;	var eqmo10;
	var eqmo11; var eqmo12; var eqmo13; var eqmo14;	var eqmo15;	var eqmo16; var eqmo17; var eqmo18; var eqmo19;	var eqmo20;
	var eqmo21; var eqmo22; var eqmo23; var eqmo24;	var eqmo25;	var eqmo26; var eqmo27; var eqmo28; var eqmo29; var eqmo30;
	var eqmo31; var eqmo32; var eqmo33; var eqmo34;	var eqmo35;	var eqmo36; var eqmo37; var eqmo38; var eqmo39; var eqmo40;
	var ctsm01; var ctsm02; var ctsm03; var ctsm04; var ctsm05;
	var ctsm06; var ctsm07; var ctsm08; var ctsm09; var ctsm10;
	var ctsm11; var ctsm12; var ctsm13; var ctsm14; var ctsm15;
	var ctsl01; var ctsl02; var ctsl03; var ctsl04;	var ctsl05;
	var ctse01; var ctse02; var ctse03; var ctse04;	var ctse05;
	var ctsi01; var ctsi02; var ctsi03;
	var fdsp01; var fdsp02; var fdsp03; var fdsp04;	var fdsp05;	var fdsp06; var fdsp07; var fdsp08; var fdsp09;	var fdsp10;	var fdsp11;
	var addt01;
	var pr=0;	var eq=0;	var ct=0;	var fdsp=0;	var addt=0; var zuam=0;	var zcost;  var colId;  var prh;	var prd;	var qtseq;  var znumber; var searchRow;
	var nEqTemp=0; var sPrdTemp;
    
	var vkgrp = ds_header.GetColumn(0, "VKGRP");
	var spart = ds_header.GetColumn(0, "SPART" );

	ds_report.ClearData();

	for (var a=0; a<ds_t302.GetRowCount(); a++) {

		prdm01=ds_t302.GetColumn(a,"PRDM01"); prdm02=ds_t302.GetColumn(a,"PRDM02"); prdm03=ds_t302.GetColumn(a,"PRDM03"); prdm04=ds_t302.GetColumn(a,"PRDM04"); prdm05=ds_t302.GetColumn(a,"PRDM05");
		prdl01=ds_t302.GetColumn(a,"PRDL01"); prdl02=ds_t302.GetColumn(a,"PRDL02"); prdl03=ds_t302.GetColumn(a,"PRDL03"); prdl04=ds_t302.GetColumn(a,"PRDL04"); prdl05=ds_t302.GetColumn(a,"PRDL05");
		prde01=ds_t302.GetColumn(a,"PRDE01"); prde02=ds_t302.GetColumn(a,"PRDE02"); prde03=ds_t302.GetColumn(a,"PRDE03"); prde04=ds_t302.GetColumn(a,"PRDE04");	prde05=ds_t302.GetColumn(a,"PRDE05");
		prde06=ds_t302.GetColumn(a,"PRDE06"); prde07=ds_t302.GetColumn(a,"PRDE07"); prde08=ds_t302.GetColumn(a,"PRDE08"); prde09=ds_t302.GetColumn(a,"PRDE09");	prde10=ds_t302.GetColumn(a,"PRDE10");
		prde11=ds_t302.GetColumn(a,"PRDE11"); prde12=ds_t302.GetColumn(a,"PRDE12"); prde13=ds_t302.GetColumn(a,"PRDE13"); prde14=ds_t302.GetColumn(a,"PRDE14");	prde15=ds_t302.GetColumn(a,"PRDE15");
		prdi01=ds_t302.GetColumn(a,"PRDI01"); prdi02=ds_t302.GetColumn(a,"PRDI02"); prdi03=ds_t302.GetColumn(a,"PRDI03"); prdi04=ds_t302.GetColumn(a,"PRDI04");
		eqmm01=ds_t302.GetColumn(a,"EQMM01"); eqmm02=ds_t302.GetColumn(a,"EQMM02"); eqmm03=ds_t302.GetColumn(a,"EQMM03"); eqmm04=ds_t302.GetColumn(a,"EQMM04"); eqmm05=ds_t302.GetColumn(a,"EQMM05");
		eqma01=ds_t302.GetColumn(a,"EQMA01");
		eqma02=ds_t302.GetColumn(a,"EQMA02");
		eqml01=ds_t302.GetColumn(a,"EQML01"); eqml02=ds_t302.GetColumn(a,"EQML02"); eqml03=ds_t302.GetColumn(a,"EQML03"); eqml04=ds_t302.GetColumn(a,"EQML04");	eqml05=ds_t302.GetColumn(a,"EQML05");
		eqme01=ds_t302.GetColumn(a,"EQME01"); eqme02=ds_t302.GetColumn(a,"EQME02"); eqme03=ds_t302.GetColumn(a,"EQME03"); eqme04=ds_t302.GetColumn(a,"EQME04");	eqme05=ds_t302.GetColumn(a,"EQME05");
		eqme06=ds_t302.GetColumn(a,"EQME06"); eqme07=ds_t302.GetColumn(a,"EQME07"); eqme08=ds_t302.GetColumn(a,"EQME08"); eqme09=ds_t302.GetColumn(a,"EQME09"); eqme10=ds_t302.GetColumn(a,"EQME10");
		eqme11=ds_t302.GetColumn(a,"EQME11"); eqme12=ds_t302.GetColumn(a,"EQME12"); eqme13=ds_t302.GetColumn(a,"EQME13"); eqme14=ds_t302.GetColumn(a,"EQME14"); eqme15=ds_t302.GetColumn(a,"EQME15");
		eqme51=ds_t302.GetColumn(a,"EQME51"); eqme52=ds_t302.GetColumn(a,"EQME52"); eqme53=ds_t302.GetColumn(a,"EQME53"); eqme54=ds_t302.GetColumn(a,"EQME54");	eqme55=ds_t302.GetColumn(a,"EQME55");
		eqme56=ds_t302.GetColumn(a,"EQME56"); eqme57=ds_t302.GetColumn(a,"EQME57"); eqme58=ds_t302.GetColumn(a,"EQME58"); eqme59=ds_t302.GetColumn(a,"EQME59");	eqme60=ds_t302.GetColumn(a,"EQME60");
		eqme61=ds_t302.GetColumn(a,"EQME61"); eqme62=ds_t302.GetColumn(a,"EQME62"); eqme63=ds_t302.GetColumn(a,"EQME63"); eqme64=ds_t302.GetColumn(a,"EQME64");	eqme65=ds_t302.GetColumn(a,"EQME65");
		eqme66=ds_t302.GetColumn(a,"EQME66"); eqme67=ds_t302.GetColumn(a,"EQME67"); eqme68=ds_t302.GetColumn(a,"EQME68"); eqme69=ds_t302.GetColumn(a,"EQME69"); eqme70=ds_t302.GetColumn(a,"EQME70");
		eqme71=ds_t302.GetColumn(a,"EQME71"); eqme72=ds_t302.GetColumn(a,"EQME72"); eqme73=ds_t302.GetColumn(a,"EQME73"); eqme74=ds_t302.GetColumn(a,"EQME74");	eqme75=ds_t302.GetColumn(a,"EQME75");
		eqme76=ds_t302.GetColumn(a,"EQME76"); eqme77=ds_t302.GetColumn(a,"EQME77"); eqme78=ds_t302.GetColumn(a,"EQME78"); eqme79=ds_t302.GetColumn(a,"EQME79");	eqme80=ds_t302.GetColumn(a,"EQME80");
		eqme81=ds_t302.GetColumn(a,"EQME81"); eqme82=ds_t302.GetColumn(a,"EQME82"); eqme83=ds_t302.GetColumn(a,"EQME83"); eqme84=ds_t302.GetColumn(a,"EQME84");	eqme85=ds_t302.GetColumn(a,"EQME85");
		eqme86=ds_t302.GetColumn(a,"EQME86"); eqme87=ds_t302.GetColumn(a,"EQME87"); eqme88=ds_t302.GetColumn(a,"EQME88"); eqme89=ds_t302.GetColumn(a,"EQME89"); eqme90=ds_t302.GetColumn(a,"EQME90");
		eqme91=ds_t302.GetColumn(a,"EQME91"); eqme92=ds_t302.GetColumn(a,"EQME92"); eqme93=ds_t302.GetColumn(a,"EQME93"); eqme94=ds_t302.GetColumn(a,"EQME94");	eqme95=ds_t302.GetColumn(a,"EQME95");
		eqme96=ds_t302.GetColumn(a,"EQME96"); eqme97=ds_t302.GetColumn(a,"EQME97"); eqme99=ds_t302.GetColumn(a,"EQME98"); eqme99=ds_t302.GetColumn(a,"EQME99"); 
		eqmi01=ds_t302.GetColumn(a,"EQMI01"); eqmi02=ds_t302.GetColumn(a,"EQMI02"); eqmi03=ds_t302.GetColumn(a,"EQMI03");
		eqmo01=ds_t302.GetColumn(a,"EQMO01"); eqmo02=ds_t302.GetColumn(a,"EQMO02"); eqmo03=ds_t302.GetColumn(a,"EQMO03"); eqmo04=ds_t302.GetColumn(a,"EQMO04");	eqmo05=ds_t302.GetColumn(a,"EQMO05");
		eqmo06=ds_t302.GetColumn(a,"EQMO06"); eqmo07=ds_t302.GetColumn(a,"EQMO07"); eqmo08=ds_t302.GetColumn(a,"EQMO08"); eqmo09=ds_t302.GetColumn(a,"EQMO09");	eqmo10=ds_t302.GetColumn(a,"EQMO10");
		eqmo11=ds_t302.GetColumn(a,"EQMO11"); eqmo12=ds_t302.GetColumn(a,"EQMO12"); eqmo13=ds_t302.GetColumn(a,"EQMO13"); eqmo14=ds_t302.GetColumn(a,"EQMO14");	eqmo15=ds_t302.GetColumn(a,"EQMO15");
		eqmo16=ds_t302.GetColumn(a,"EQMO16"); eqmo17=ds_t302.GetColumn(a,"EQMO17"); eqmo18=ds_t302.GetColumn(a,"EQMO18"); eqmo19=ds_t302.GetColumn(a,"EQMO19");	eqmo20=ds_t302.GetColumn(a,"EQMO20");
		eqmo21=ds_t302.GetColumn(a,"EQMO21"); eqmo22=ds_t302.GetColumn(a,"EQMO22"); eqmo23=ds_t302.GetColumn(a,"EQMO23"); eqmo24=ds_t302.GetColumn(a,"EQMO24");	eqmo25=ds_t302.GetColumn(a,"EQMO25");
		eqmo26=ds_t302.GetColumn(a,"EQMO26"); eqmo27=ds_t302.GetColumn(a,"EQMO27"); eqmo28=ds_t302.GetColumn(a,"EQMO28"); eqmo29=ds_t302.GetColumn(a,"EQMO29"); eqmo30=ds_t302.GetColumn(a,"EQMO30");
		eqmo31=ds_t302.GetColumn(a,"EQMO31"); eqmo32=ds_t302.GetColumn(a,"EQMO32"); eqmo33=ds_t302.GetColumn(a,"EQMO33"); eqmo34=ds_t302.GetColumn(a,"EQMO34");	eqmo35=ds_t302.GetColumn(a,"EQMO35");
		eqmo36=ds_t302.GetColumn(a,"EQMO36"); eqmo37=ds_t302.GetColumn(a,"EQMO37"); eqmo38=ds_t302.GetColumn(a,"EQMO38"); eqmo39=ds_t302.GetColumn(a,"EQMO39"); eqmo40=ds_t302.GetColumn(a,"EQMO40");
		ctsm01=ds_t302.GetColumn(a,"CTSM01"); ctsm02=ds_t302.GetColumn(a,"CTSM02"); ctsm03=ds_t302.GetColumn(a,"CTSM03"); ctsm04=ds_t302.GetColumn(a,"CTSM04"); ctsm05=ds_t302.GetColumn(a,"CTSM05");
		ctsm06=ds_t302.GetColumn(a,"CTSM06"); ctsm07=ds_t302.GetColumn(a,"CTSM07"); ctsm08=ds_t302.GetColumn(a,"CTSM08"); ctsm09=ds_t302.GetColumn(a,"CTSM09"); ctsm10=ds_t302.GetColumn(a,"CTSM10");
		ctsm11=ds_t302.GetColumn(a,"CTSM11"); ctsm12=ds_t302.GetColumn(a,"CTSM12"); ctsm13=ds_t302.GetColumn(a,"CTSM13"); ctsm14=ds_t302.GetColumn(a,"CTSM14"); ctsm15=ds_t302.GetColumn(a,"CTSM15");
		ctsl01=ds_t302.GetColumn(a,"CTSL01"); ctsl02=ds_t302.GetColumn(a,"CTSL02"); ctsl03=ds_t302.GetColumn(a,"CTSL03"); ctsl04=ds_t302.GetColumn(a,"CTSL04");	ctsl05=ds_t302.GetColumn(a,"CTSL05");
		ctse01=ds_t302.GetColumn(a,"CTSE01"); ctse02=ds_t302.GetColumn(a,"CTSE02"); ctse03=ds_t302.GetColumn(a,"CTSE03"); ctse04=ds_t302.GetColumn(a,"CTSE04");	ctse05=ds_t302.GetColumn(a,"CTSE05");
		ctsi01=ds_t302.GetColumn(a,"CTSI01"); ctsi02=ds_t302.GetColumn(a,"CTSI02"); ctsi03=ds_t302.GetColumn(a,"CTSI03");
		fdsp01=ds_t302.GetColumn(a,"FDSP01"); fdsp02=ds_t302.GetColumn(a,"FDSP02"); fdsp03=ds_t302.GetColumn(a,"FDSP03"); fdsp04=ds_t302.GetColumn(a,"FDSP04");	fdsp05=ds_t302.GetColumn(a,"FDSP05");
		fdsp06=ds_t302.GetColumn(a,"FDSP06"); fdsp07=ds_t302.GetColumn(a,"FDSP07"); fdsp08=ds_t302.GetColumn(a,"FDSP08"); fdsp09=ds_t302.GetColumn(a,"FDSP09");	fdsp10=ds_t302.GetColumn(a,"FDSP10"); fdsp11=ds_t302.GetColumn(a,"FDSP11");
		addt01=ds_t302.GetColumn(a,"ADDT01");
		
		pr  = ParseFloat(prdm01) + ParseFloat(prdm02) + ParseFloat(prdm03) + ParseFloat(prdm04) + ParseFloat(prdm05)
			+ ParseFloat(prdl01) + ParseFloat(prdl02) + ParseFloat(prdl03) + ParseFloat(prdl04) + ParseFloat(prdl05)
			+ ParseFloat(prde01) + ParseFloat(prde02) + ParseFloat(prde03) + ParseFloat(prde04) + ParseFloat(prde05) + ParseFloat(prde06) + ParseFloat(prde07) + ParseFloat(prde08) + ParseFloat(prde09) + ParseFloat(prde10)
			+ ParseFloat(prde11) + ParseFloat(prde12) + ParseFloat(prde13) + ParseFloat(prde14) + ParseFloat(prde15)
			+ ParseFloat(prdi01) + ParseFloat(prdi02) + ParseFloat(prdi03) + ParseFloat(prdi04) + ParseFloat(ctsm15);

		eq 	= ParseFloat(eqmm01) + ParseFloat(eqmm02) + ParseFloat(eqmm03) + ParseFloat(eqmm04) + ParseFloat(eqmm05)
			+ ParseFloat(eqml01) + ParseFloat(eqml02) + ParseFloat(eqml03) + ParseFloat(eqml04) + ParseFloat(eqml05)
			+ ParseFloat(eqme01) + ParseFloat(eqme02) + ParseFloat(eqme03) + ParseFloat(eqme04) + ParseFloat(eqme05) + ParseFloat(eqme06) + ParseFloat(eqme07) + ParseFloat(eqme08) + ParseFloat(eqme09) + ParseFloat(eqme10)
			+ ParseFloat(eqme11) + ParseFloat(eqme12) + ParseFloat(eqme13) + ParseFloat(eqme14) + ParseFloat(eqme15)
			+ ParseFloat(eqme51) + ParseFloat(eqme52) + ParseFloat(eqme53) + ParseFloat(eqme54) + ParseFloat(eqme55) + ParseFloat(eqme56) + ParseFloat(eqme57) + ParseFloat(eqme58) + ParseFloat(eqme59) + ParseFloat(eqme60)
			+ ParseFloat(eqme61) + ParseFloat(eqme62) + ParseFloat(eqme63) + ParseFloat(eqme64) + ParseFloat(eqme65) + ParseFloat(eqme66) + ParseFloat(eqme67) + ParseFloat(eqme68) + ParseFloat(eqme69) + ParseFloat(eqme70)
			+ ParseFloat(eqme71) + ParseFloat(eqme72) + ParseFloat(eqme73) + ParseFloat(eqme74) + ParseFloat(eqme75) + ParseFloat(eqme76) + ParseFloat(eqme77) + ParseFloat(eqme78) + ParseFloat(eqme79) + ParseFloat(eqme80)
			+ ParseFloat(eqme81) + ParseFloat(eqme82) + ParseFloat(eqme83) + ParseFloat(eqme84) + ParseFloat(eqme85) + ParseFloat(eqme86) + ParseFloat(eqme87) + ParseFloat(eqme88) + ParseFloat(eqme89) + ParseFloat(eqme90)
			+ ParseFloat(eqme91) + ParseFloat(eqme92) + ParseFloat(eqme93) + ParseFloat(eqme94) + ParseFloat(eqme95) + ParseFloat(eqme96) + ParseFloat(eqme97) + ParseFloat(eqme98) + ParseFloat(eqme99) 
			+ ParseFloat(eqmi01) + ParseFloat(eqmi02) + ParseFloat(eqmi03) 
			+ ParseFloat(eqmo01) + ParseFloat(eqmo02) + ParseFloat(eqmo03) + ParseFloat(eqmo04) + ParseFloat(eqmo05) + ParseFloat(eqmo06) + ParseFloat(eqmo07) + ParseFloat(eqmo08) + ParseFloat(eqmo09) + ParseFloat(eqmo10)
			+ ParseFloat(eqmo11) + ParseFloat(eqmo12) + ParseFloat(eqmo13) + ParseFloat(eqmo14) + ParseFloat(eqmo15) + ParseFloat(eqmo16) + ParseFloat(eqmo17) + ParseFloat(eqmo18) + ParseFloat(eqmo19) + ParseFloat(eqmo20)
			+ ParseFloat(eqmo21) + ParseFloat(eqmo22) + ParseFloat(eqmo23) + ParseFloat(eqmo24) + ParseFloat(eqmo25) + ParseFloat(eqmo26) + ParseFloat(eqmo27) + ParseFloat(eqmo28) + ParseFloat(eqmo29) + ParseFloat(eqmo30)
			+ ParseFloat(eqmo31) + ParseFloat(eqmo32) + ParseFloat(eqmo33) + ParseFloat(eqmo34) + ParseFloat(eqmo35) + ParseFloat(eqmo36) + ParseFloat(eqmo37) + ParseFloat(eqmo38) + ParseFloat(eqmo39) + ParseFloat(eqmo40);

		ct	= ParseFloat(ctsm01) + ParseFloat(ctsm02) + ParseFloat(ctsm03) + ParseFloat(ctsm04) + ParseFloat(ctsm05)
			+ ParseFloat(ctsm06) + ParseFloat(ctsm07) + ParseFloat(ctsm08) + ParseFloat(ctsm09) + ParseFloat(ctsm10)
			+ ParseFloat(ctsm11) + ParseFloat(ctsm12) + ParseFloat(ctsm13) + ParseFloat(ctsm14)
			+ ParseFloat(ctsl01) + ParseFloat(ctsl02) + ParseFloat(ctsl03) + ParseFloat(ctsl04) + ParseFloat(ctsl05)
			+ ParseFloat(ctse01) + ParseFloat(ctse02) + ParseFloat(ctse03) + ParseFloat(ctse04) + ParseFloat(ctse05)
			+ ParseFloat(ctsi01) + ParseFloat(ctsi02) + ParseFloat(ctsi03);
				
		fdsp= ParseFloat(fdsp01) + ParseFloat(fdsp02) + ParseFloat(fdsp03) + ParseFloat(fdsp04) + ParseFloat(fdsp05) + ParseFloat(fdsp06) + ParseFloat(fdsp07) + ParseFloat(fdsp08) + ParseFloat(fdsp09) + ParseFloat(fdsp10) + ParseFloat(fdsp11);
		addt= ParseFloat(addt01);

		zuam= pr + eq + ct + fdsp + addt;

		ds_report.AddRow();
		ds_report.SetColumn(a, "PR"  , pr  ); // 제조
		ds_report.SetColumn(a, "EQ"  , eq  ); // 설치
		ds_report.SetColumn(a, "CT"  , ct  ); // 보수
		ds_report.SetColumn(a, "FDSP", fdsp); // 영업개별입력
		ds_report.SetColumn(a, "ZUAM", zuam); // 견적가
		ds_report.SetColumn(a, "ADDT", addt); // 부분원가

		nEqTemp = eq - ParseFloat(eqmi01) - ParseFloat(eqmi02) - ParseFloat(eqmi03); // 2013.02.06 eq에서 eqmi 3개 항목를 제외한 94개 항목의 합계

		for (var i=0; i<ds_t302.GetColCount(); i++) {
			colId = ds_t302.GetColID(i);

			if (colId=="EQME79" || colId=="EQME80" || colId=="EQME81" || colId=="EQME82" || colId=="EQME87"	|| colId=="EQME89" ||
				colId=="FDS01"  || colId=="FDS02"  || colId=="FDS03"  || colId=="FDS04"  || colId=="FDS05"  ||
				colId=="FDSP01" || colId=="FDSP02" || colId=="FDSP03" || colId=="FDSP04" || colId=="FDSP05" ||
				colId=="FDS06"  || colId=="FDS07"  || colId=="FDS08"  || colId=="FDS09"  || colId=="FDS10"  ||
				colId=="FDSP06" || colId=="FDSP07" || colId=="FDSP08" || colId=="FDSP09" || colId=="FDSP10"	|| colId=="FDSP11" ||
				colId=="MODEL"  ) {

				prd = ds_t302.GetColumn(a, colId);
				ds_report.SetColumn(a, colId, prd);
			}
			/**********************************************************************
			// 2013.02.06
			// 현재 설치 옵션 원가 항목 금액이 ZCOBT302의 해당 매칭 FIELD 금액을 불러오고 있으나, 제조간접비+기타간접비+영업이익금액을 반영해 주어야 함.
			// * 처리공식 EX) 단납기 할증비 : ZCOBT302-EQML03 + ( ( ZCOBT302-EQML03 / 설치관련 총금액( 94개 FIELD ) ) * ( EQMI01+EQMI02+EQMI03 ) )
			// * 설치 옵션 원가 항목들에 대해서만 위의 로직으로 대체. --> 25개 항목
			**********************************************************************/
			if (colId=="EQML03" || colId=="EQME01" || colId=="EQME88" || colId=="EQME04" || colId=="EQME06" ||
				colId=="EQME86" || colId=="EQME83" || colId=="EQME84" || colId=="EQME85" || colId=="EQMO07" ||
				colId=="EQME55" || colId=="EQME56" || colId=="EQME59" || colId=="EQME60" || colId=="EQME61" ||
				colId=="EQME62" || colId=="EQME63" || colId=="EQME65" || colId=="EQME66" || colId=="EQME67" ||
				colId=="EQME73" || colId=="EQME75" || colId=="EQME76" || colId=="EQME77" || colId=="EQME78" ||
				// 2013.04.02 설치옵션원가에 항목 추가
				colId=="EQME51" || colId=="EQMO01" || colId=="EQMO02" || colId=="EQMO03" || colId=="EQMO15" ||
				colId=="EQMO04" || colId=="EQMO05" || colId=="EQMO06" || colId=="EQMO08" ||	colId=="EQMO09" ||
				colId=="EQMO10" || colId=="EQMO11" || colId=="EQMO12" || colId=="EQMO13" ||	colId=="EQMO14" ||
				colId=="EQMO16" || colId=="EQMO17" || colId=="EQMO18" || colId=="EQMO19" ||	colId=="EQMO20"	||
				colId=="EQMO21" || colId=="EQMO22" || colId=="EQMO23" ||
				// 2013.04.02 설치외주원가에 항목 추가
				colId=="EQME79" || colId=="EQME80" || colId=="EQME81" || colId=="EQME82" || colId=="EQME84" ||
				colId=="EQME87" || colId=="EQME11" || colId=="EQME12" || colId=="EQME57" || colId=="EQME58" ||
				colId=="EQME64" || colId=="EQME69" || colId=="EQME70" || colId=="EQME71" || colId=="EQME72" ||
				colId=="EQME74" || colId=="EQME52" || colId=="EQME10"
				|| colId=="EQME89"
			) {

				sPrdTemp = parseFloat(ds_t302.GetColumn(a, colId));
				prd = sPrdTemp + ( ( sPrdTemp / nEqTemp ) * ( parseFloat(eqmi01) + parseFloat(eqmi02) + parseFloat(eqmi03) ) );
				ds_report.SetColumn(a, colId, prd);
			}
		}

		// 2013.01.09 Cost Eng.팀 요청사항 : 설치옵션원가 ? 보양 CAGE : EQME79, 80, 81, 82, 86 금액의 합   ( ZCOBT302 TABLE )
		var nEqme86 = ParseFloat(eqme79) + ParseFloat(eqme80) + ParseFloat(eqme81) + ParseFloat(eqme82) + ParseFloat(eqme86);
		ds_report.SetColumn(a, "EQME86", nEqme86);

		// 2013.01.09 Cost Eng.팀 요청사항 : 설치옵션원가 ? 보양 HATCH DOOR : EQME84, 87 금액의 합
		var nEqme84 = ParseFloat(eqme84) + ParseFloat(eqme87);
		ds_report.SetColumn(a, "EQME84", nEqme84);

		qtseq = ds_t302.GetColumn(a, "QTSEQ");
		ds_template.UnFilter();
		ds_template.Filter("QTSEQ ==" + quote(qtseq));

		//2012.12.01. khs
		var qtseqSerchRow = ds_detail.searchRow("QTSEQ ==" + quote(qtseq));
		var zprdgbn = substr(ds_detail.GetColumn(qtseqSerchRow, "ZPRDGBN"), 0, 2);
		
		for (var i=0; i<ds_template.GetRowCount(); i++) {

			prh = ds_template.GetColumn(i, "PRH");
			prd = ds_template.GetColumn(i, "PRD");
			
			//ES, MW인 경우  - 2012.12.01.khs			
			if ( zprdgbn == "ES") prh = replace(prh, "ES","EL");
			else if (zprdgbn == "MW")  prh = replace(prh, "MW","EL");

			if (prh=="QTNUM"      || prh=="QTSER"      || prh=="EL_ATYP"   || prh=="EL_AUSE"    ||
				prh=="EL_AOPEN"   || prh=="EL_ASPD"    || prh=="EL_AFQ"    || prh=="EL_ASTQ"    ||
				prh=="EL_ACD2"    || prh=="EL_ATT"     || prh=="EL_ADTA"   ||
				prh=="EL_FDNCMQ"  || prh=="EL_FDWUQ"   || prh=="EL_FDSMDQ" || prh=="EL_FDSMSQ"  ||
				prh=="EL_ADRV"    || prh=="EL_BMDL"    || prh=="EL_BCL"    || prh=="EL_BFR"     ||
				prh=="EL_BFS"     || prh=="EL_BWM"     || prh=="EL_BWHG"   || prh=="EL_BMOPB"   || prh=="EL_BSOPB"  ||
				prh=="EL_BHOPB"   || prh=="EL_BCDM"    || prh=="EL_BCDHG"  || prh=="EL_BCPI"    ||
				prh=="EL_CJM1"	  || prh=="EL_CJM1Q"   || prh=="EL_CJM1M"  || prh=="EL_CJM1HG"  || prh=="EL_CHPI1"  ||
				prh=="EL_CJM2"	  || prh=="EL_CJM2Q"   || prh=="EL_CJM2M"  || prh=="EL_CJM2HG"  || prh=="EL_CHPI2"  ||
				prh=="EL_CJM3"	  || prh=="EL_CJM3Q"   || prh=="EL_CJM3M"  || prh=="EL_CJM3HG"  || prh=="EL_CHPI3"  ||
				prh=="EL_CJM4"	  || prh=="EL_CJM4Q"   || prh=="EL_CJM4M"  || prh=="EL_CJM4HG"  || prh=="EL_CHPI4"  ||
				prh=="EL_CHD1"	  || prh=="EL_CHD1HG"  || prh=="EL_CHD1Q"  ||
				prh=="EL_CHD2"	  || prh=="EL_CHD2HG"  || prh=="EL_CHD2Q"  ||
				prh=="EL_CHD3"	  || prh=="EL_CHD3HG"  || prh=="EL_CHD3Q"  ||
				prh=="EL_CHPBM1"  || prh=="EL_CHPBM1Q" || prh=="EL_CHPBM2" || prh=="EL_CHPBM2Q" ||
				prh=="EL_CHPBT"   || prh=="EL_CHPBTQ"  || prh=="EL_CHPBB"  || prh=="EL_CHPBBQ"  ||
				prh=="EL_CHIPM1"  || prh=="EL_CHIPM1Q" || prh=="EL_CHIPM2" || prh=="EL_CHIPM2Q" ||
				prh=="EL_CHIPT"   || prh=="EL_CHIPTQ"  || prh=="EL_CHIPB"  || prh=="EL_CHIPBQ"  ||
				prh=="EL_COB"     || prh=="EL_ECCH"    || prh=="EL_ECJJ"   || prh=="EL_ECHH"    || prh=="EL_EHO"    ||
				prh=="EL_EHTRH"   || prh=="EL_EHP"     || prh=="EL_EHTH"   || prh=="EL_ETM"     || prh=="EL_ETMM"   ||
				prh=="EL_ECSF"    || prh=="EL_ECRL"    || prh=="EL_ECWRL"  ||
				
				//2012.12.01.khs add
				prh=="EL_AWID" 	  || prh=="EL_ADEG"    || prh=="EL_ARISE"  || prh=="EL_AFLAT"   || prh=="EL_ASPE" 	||
				prh=="EL_AMOT" 	  || prh=="EL_ASTC"    || prh=="EL_AGCOL"  || prh=="EL_AHCOL"   || prh=="EL_AIODK"  ||
				prh=="EL_ASKTPN"  || prh=="EL_ASUBW"   || prh=="EL_BBRU"   || prh=="EL_BMP"     || prh=="EL_CCOML"   ||
				prh=="EL_CUSL"    || prh=="EL_DSOF"    || prh=="EL_DGR"    || prh=="EL_DBARR"   || prh=="EL_ALOCA"	||
				prh=="EL_AMAN"    || prh=="EL_ECW"     || prh=="EL_ECWAD"  || 
				//2013.04.05 추가
				prh=="EL_ALENG"   || prh=="EL_ARIS"
				)

				ds_report.SetColumn(a, prh, prd);
		}
				  
		searchRow = ds_vkgrp.searchRow("CODE ==" + quote(vkgrp));

		ds_report.SetColumn(a, "ZKUNNR", ds_header.GetColumn(0, "ZKUNNR_NM"			 )); // 영업담당자명
		ds_report.SetColumn(a, "VKGRT" , ds_vkgrp.GetColumn(searchRow, "CODE_NAME"   )); // 영업팀
		ds_report.SetColumn(a, "QTNUM" , ds_header.GetColumn(0, "QTNUM"              )); // 견적번호
		ds_report.SetColumn(a, "QTSER" , ds_header.GetColumn(0, "QTSER"              )); // 견적차수
		ds_report.SetColumn(a, "QTSEQ" , qtseq                                        ); // 견적일련번호
		ds_report.SetColumn(a, "GSNAM" , ds_header.GetColumn(0, "GSNAM"              )); // 프로젝트명
		ds_report.SetColumn(a, "KUNNR" , ds_header.GetColumn(0, "BUYR_NM"			 )); // 판매처
		ds_report.SetColumn(a, "MODEL" , zprdgbn									  ); // 모델
		ds_report.SetColumn(a, "QTDAT" , ds_header.GetColumn(0, "QTDAT"              )); // 견적일자
		ds_report.SetColumn(a, "WAERK" , decode(ds_header.GetColumn(0, "WAERK"), "KRW", "\\", ds_header.GetColumn(0, "WAERK"))); // 통화단위

		searchRow = ds_spart_cd.searchRow("CODE ==" + quote(spart));
		
		ds_report.SetColumn(a, "SPART" , ds_spart_cd.GetColumn(searchRow, "CODE_NAME")); // 제품군
		ds_report.SetColumn(a, "DELDAT", ds_header.GetColumn(0, "DELDAT"             )); // 납기일자

		searchRow = ds_detail.searchRow("QTSEQ ==" + quote(qtseq));

		ds_report.SetColumn(a, "ZCOST", ds_detail.GetColumn(searchRow, "ZCOST")); // 원가 총계
		
		var region = ds_header.GetColumn(0, "REGION");
		//trace(region);
		//trace("$$"+ds_zregn3.savexml());
		searchRow = ds_zregn3.searchRow("ATWRT ==" + quote(region)); 
		//trace(searchRow);
		ds_report.SetColumn(a, "REGION" , ds_zregn3.GetColumn(searchRow, "ATWTB")); //운송지역명
		//trace("^_^" + ds_report.savexml());
	}

	for (var i=0; i<ds_t302.GetRowCount(); i++) {
		ds_t302.SetColumn(i, "MANDT", G_MANDT);
	}
	nsfRequest("queryBlock", "ses0031/searchBlock", "ds_header=ds_header ds_block=ds_block", "ds_block=ds_block ds_error=ds_error", "", "fn_afterQuery");
}

// 원가산출 버튼 클릭
function btn_count_OnClick(obj) {
//trace("************34");
	// 2013.01.16 감시반 체크
	var vValue = 0;
	var vText = "";

	// 감시반 명칭
	vText  = trim(ds_header.GetColumn(0, "CO_DSV1")) + trim(ds_header.GetColumn(0, "CO_DSV2"));

	// 감시반1 수량
	if (length(trim(ds_header.GetColumn(0, "CO_DSV1TQ"))) <= 0)	{
		vValue = 0;
	}else	{
		vValue = toNumber(ds_header.GetColumn(0, "CO_DSV1TQ"));
	}

	// 감시반 2 수량 포함
	if (length(trim(ds_header.GetColumn(0, "CO_DSV2TQ"))) <= 0)	{
		vValue = toNumber(vValue) + 0;
	}else	{
		vValue = toNumber(vValue) + toNumber(ds_header.GetColumn(0, "CO_DSV2TQ"));
	}

	if (length(vText) <= 0)		{
		if (vValue > 0)		{
			gfn_showAlert("CW10025", "사양의 감시반 명칭을 확인하여 주십시요.");
			return;
		}
	}else	{
		if (vValue <= 0)		{
			gfn_showAlert("CW10025", "사양의 감시반 수량을 확인하여 주십시요.");
			return;
		}
	}
	// 상세에 감시반이 존재하는지 확인
	var vT1000Cnt = 0;
	for (var i = 0; i < ds_detail.GetRowCount(); i++)	{
		if (ds_detail.GetColumn(i, "MATNR") == "T-1000")		{
			vT1000Cnt++;
		}
	}

	if (vT1000Cnt > 1)	{
		gfn_showAlert("CW10025", "MO에 감시반은 1개만 존재해야 합니다.");
		return;
	}

	if (vText != "" && vText != null)	{
		if (vT1000Cnt <= 0)	{
			gfn_showAlert("CW10025", "MO에 감시반을 추가하여 주시기 바랍니다.");
			return;
		}
	}

	// check logic 추가 - 20140129  시행예산 박성철 DL 요청 
	//  EL 대수 2대 이하 현장 비상통화장치 종류  DILP 선택 불가 
	//  EL 대수 3대 이상 현장 비상통화장치 HYBRIDW, HYBRIDWL 선택 불가
	// 견적일 20140130 부터 시행 
	if ( ds_header.GetColumn(0,"QTDAT") >= "20140129"){
	// QNTY 는 EL 대수만 
		var qnty = 0;
		for (var i = 0; i < ds_detail.GetRowCount(); i++)	{
			if (substr(ds_detail.GetColumn(i,"MATNR"),0,1) == "L"){
				qnty = qnty + parseInt(ds_detail.GetColumn(i,"ZNUMBER"));
			}
		}
		var seq = 0;
		var value = '';
		ds_template.UnFilter();
		for (var i = 0; i < ds_detail.GetRowCount(); i++)	{
	    
			seq   = ds_detail.GetColumn(i, "QTSEQ"  );
			searchRow = ds_template.searchRow("QTSEQ ==" + quote(seq) + " && PRH ==" + quote("EL_DEPH") );
			value = ds_template.GetColumn(searchRow, "PRD");
		
			if ( qnty <= 2 ) {
				if ( value = "DILP" ){
					gfn_showAlert("CW10025", "D055 비상통화장치 2대 이하 현장 적용불가 (HYBRIDW,WL 선택요망).");
					return;
				}
			} else {		
				if ( value = "HYBRIDW" || value = "HYBRIDWL" ){
					gfn_showAlert("CW10025", "D055 비상통화장치 2대 이상 현장 적용불가 (DILP 선택요망).");
					return;
				}
			}
		}
	}

	ds_error.ClearData();

    fn_createWait("",this); // 처리중입니다. 메시지 처리

	var qtnum   = "";
	var qtser   = "";
	var qtseq   = "";
	var atkla   = "";
	var prh     = "";
	var prhname = "";
	var prd     = "";
	var qtdat   = Substr(ds_header.GetColumn(0, "QTDAT"), 0, 4);
	var poper   = "0" + Substr(ds_header.GetColumn(0, "QTDAT"), 4, 2);
	var matnr   = "";
	var vkbur   = ds_header.GetColumn(0, "VKBUR");
	var vkgrp   = ds_header.GetColumn(0, "VKGRP");
	var auart   = ds_header.GetColumn(0, "AUART");
	var searchRow;

	ds_cost.ClearData();
	ds_cost.AddRow();
	ds_cost.SetColumn(0, "DIV"  , "3");	// 분류( 1:사업계획,2:수주계획,3:견적,4:수주,9:예상 )
	ds_cost.SetColumn(0, "GBN"  , "3"); // 처리구분 (1: BOM, 2: 원가, 3: Web )
	ds_cost.SetColumn(0, "GJAHR", "");
	ds_cost.SetColumn(0, "POPER", "");
	ds_char.ClearData();
	
	ds_template.UnFilter();
	
	for (var i = 0; i < ds_template.GetRowCount(); i++) {

		qtnum   = ds_template.GetColumn(i, "QTNUM"  );
		qtser   = ds_template.GetColumn(i, "QTSER"  );
		qtseq   = ds_template.GetColumn(i, "QTSEQ"  );
		atkla   = ds_template.GetColumn(i, "ATKLA"  );
		prh     = ds_template.GetColumn(i, "PRH"    );
		prhname = ds_template.GetColumn(i, "PRHNAME");
		prd     = ds_template.GetColumn(i, "PRD"    );
		
		searchRow = ds_detail.searchRow("QTSEQ ==" + quote(qtseq));
		matnr     = ds_detail.getcolumn(searchRow, "MATNR");

		if (qtnum   == null) qtnum   = "";
		if (qtser   == null) qtser   = "";
		if (qtseq   == null) qtseq   = "";
		if (atkla   == null) atkla   = "";
		if (prh     == null) prh     = "";
		if (prhname == null) prhname = "";
		if (prd     == null) prd     = "";

		ds_char.AddRow();
		ds_char.SetColumn(i, "QTNUM", qtnum  ); // 견적번호
		ds_char.SetColumn(i, "QTSER", qtser  ); // 견적차수
		ds_char.SetColumn(i, "QTSEQ", qtseq  ); // 견적일련번호
		ds_char.SetColumn(i, "PSPID", ""     ); // 프로젝트 정의
		ds_char.SetColumn(i, "POSID", ""     ); // 작업 분석 구조 요소(WBS 요소)
		ds_char.SetColumn(i, "GJAHR", qtdat  );
		ds_char.SetColumn(i, "POPER", poper  );
		ds_char.SetColumn(i, "MATNR", matnr  );
		ds_char.SetColumn(i, "VKBUR", vkbur  );
		ds_char.SetColumn(i, "VKGRP", vkgrp  );
		ds_char.SetColumn(i, "AUART", auart  );
		ds_char.SetColumn(i, "KTGRM", ""     ); // 해당자재 계정지정그룹 
		ds_char.SetColumn(i, "NETWR", ""     ); // 문서통화에서의 오더품목의 정가
		ds_char.SetColumn(i, "REGIO", ""     ); // 광역지역
		ds_char.SetColumn(i, "LZONE", ""     ); // 운송지역
		ds_char.SetColumn(i, "ATKLA", atkla  ); // 특성그룹
		ds_char.SetColumn(i, "ATNAM", prh    ); // 특성코드
		ds_char.SetColumn(i, "ATBEZ", prhname); // 특성이름
		ds_char.SetColumn(i, "VALUE", prd    ); // 특성값
		ds_char.SetColumn(i, "ATWTB", ""     ); // 특성값내역
		ds_char.SetColumn(i, "MESSG", ""     ); // 메시지
	}

	nsfRequest("queryCost", "ses0031/searchCost"
			//, "ds_cost=ds_cost ds_char=ds_char ds_t202=ds_t202 ds_t302=ds_t302 ds_check=ds_check ds_header=ds_header ds_exchange=ds_exchange ds_detail=ds_detail"		// ds_exchange=ds_exchange 환율기준정보 변경으로 제거 2013.02.20 &&&&&
			, "ds_cost=ds_cost ds_char=ds_char ds_t202=ds_t202 ds_t302=ds_t302 ds_check=ds_check ds_header=ds_header ds_detail=ds_detail" 
			, "ds_char=ds_char ds_t202=ds_t202 ds_t302=ds_t302 ds_check=ds_check ds_error=ds_error", "", "fn_afterQuery");

}

// 원가의뢰 처리
function btn_countRequest_OnClick(obj) {
//trace("************35");
	/*if (fn_save_header() == false) return;

	var qtnum = ds_header.getColumn(0, "QTNUM");
	var qtser = ds_header.getColumn(0, "QTSER");
	var arg =  " fa_mandt = " + G_MANDT	 + " fa_qtnum = " + qtnum + " fa_qtser = " + qtser;
	var arr = gfn_openPopupUrl("SES::Ses0172.xml", true, arg);
	*/
	var qtnum = ds_header.getColumn(0, "QTNUM");

	if (qtnum == null || qtnum == "") {
		gfn_showAlert("CW10205"); return; // 견적번호를 입력하세요.
	}

	if (fn_save_header() == false) return;

	var qtser = ds_header.getColumn(0, "QTSER");
	var arg =  " fa_mandt = " + G_MANDT + " fa_qtnum = " + qtnum + " fa_qtser = " + qtser;
	var arr = gfn_openPopupUrl("SES::Ses0036.xml", true, arg);
}

function btn_part_OnClick(obj) {
//trace("************36");
	var qtnum = ds_header.getColumn(0, "QTNUM");
	var qtser = ds_header.getColumn(0, "QTSER");
	var arg   = "fa_qtnum = " + qtnum + " fa_qtser = " + qtser;
	gfn_openPopUpUrlHdel("SES::Ses0038.xml", true, arg);
}

function btn_costApproval_OnClick(obj) {
//trace("************37");
	ds_header.SetColumn(0, "ZPRGFLG", "33"); // 33 원가산출승인
	nsfRequest("saveHeaderFlag", "ses0031/updateHeaderFlag", "ds_header=ds_header", "ds_header=ds_header ds_error=ds_error", "", "fn_afterSave");
}

function btn_popup_OnClick(obj) {
//trace("************38");
	var spart = ds_header.GetColumn(0, "SPART"); // 제품군
	var kunnr = ds_header.GetColumn(0, "KUNNR");

	var arg = "branch="+quote("head")+" popupYn="+quote("Y")+" spart="+quote(spart)+" kunnr="+quote(kunnr)+" zkunnr="+quote(zkunnr)+" zkunnrNm="+quote(zkunnrNm);
	var arr = gfn_openPopUpUrlHdel("SES::Ses0032.xml", true, arg);

	if (arr != null && arr != 0) btn_plus_OnClick("", arr);
}

function btn_common_OnClick(obj) {
	var arr = gfn_openPopUpUrlHdel("COM::Coms019.xml", true, '');
	if (arr != null && arr != 0) {
		var matnr = arr[0];
		btn_plus_OnClick(matnr);

		ds_detail.SetColumn(ds_detail.row, "MATNR", arr[0]); // 자재번호
		ds_detail.SetColumn(ds_detail.row, "GTYPE", arr[1]); // 기종
	}
}

function tab_OnChanged(obj,nOldIndex,nNewindex) {
//trace("************40");
	if (nNewindex == 1 && ds_detail.GetRowCount() == 0) {
		gfn_showAlert("CW10063"); // 견적 Detail이 없습니다.
		tab.TabIndex = 0;
	}
}

// 선택한 row의 CNT값이 0 이상일 경우 수정불가(팝업으로만 선택)
function grd_template_OnCellPosChanged(obj,nRow,nCell,nOldRow,nOldCell,nPivotIndex,nOldPivotIndex) {
//trace("************41");
	var obj_template;

	switch (obj) {
		case "grd_template0" : obj_template = object(ds_template0.ID); break;
		case "grd_template1" : obj_template = object(ds_template1.ID); break;
		case "grd_template2" : obj_template = object(ds_template2.ID); break;
		case "grd_template3" : obj_template = object(ds_template3.ID); break;
		case "grd_template4" : obj_template = object(ds_template4.ID); break;
		case "grd_template5" : obj_template = object(ds_template5.ID); break;
		default : break;
	}

	var fa_atkla = obj_template.getcolumn(nRow, "ATKLA");
	var fa_atnam = obj_template.getcolumn(nRow, "PRH"  );

	if (obj_template.getColumn(nRow, "CNT") > 0 ||
	   (fa_atkla == "EL_BASIC" && (fa_atnam == "EL_AFQ" || fa_atnam == "EL_ASTQ")) ||
	   (fa_atkla == "ES_BASIC" && fa_atnam == "ES_ARISE") ||
	   (fa_atkla == "MW_BASIC" && (fa_atnam=="MW_ATYP"  || fa_atnam=="MW_ALOCAT" || fa_atnam=="MW_ALOCA" || fa_atnam=="MW_AWID" || fa_atnam=="MW_ASPE" || fa_atnam=="MW_ADEG" ||
								   fa_atnam=="MW_ARIS"  || fa_atnam=="MW_ALENG"  || fa_atnam=="MW_ATT" )) ||
	   (fa_atkla == " "        && (fa_atnam=="CO_DDVRTQ" || fa_atnam=="CO_DEPHTQ" || fa_atnam=="CO_DSSQ"   || fa_atnam=="CO_BCLCDTQ" || fa_atnam=="CO_CHPITQ" ||
								   fa_atnam=="CO_ASPC"   || fa_atnam=="CO_DSV1"   || fa_atnam=="CO_DSV1TQ" || fa_atnam=="CO_DSV2"    || fa_atnam=="CO_DSV2TQ" ||
								   fa_atnam=="CO_ASPD")) ||	// 고속현장 2013.04.03
	   (fa_atkla == "AP_BASIC" && (fa_atnam=="AP_ATYP"   || fa_atnam=="AP_AEA"    || fa_atnam=="AP_AMOD"   || fa_atnam=="AP_ACS"     || 
	                               fa_atnam=="AP_AQL"    || fa_atnam=="AP_AQC"    || fa_atnam=="AP_AQT"    || fa_atnam=="AP_AETS"))   || // (2012.12.10)
	   (fa_atkla == "PSD_BASIC" && (fa_atnam == "PSD_ANAME")) // (2012.12.10)
	   ) obj.Editable = false;
	else obj.Editable = true;
}

function grd_template_OnCellDblClick(obj,nRow,nCell,nX,nY,nPivotIndex) {
//trace("************42");
	var obj_template;

	switch (obj) {
		case "grd_template0" : obj_template = object(ds_template0.ID); break;
		case "grd_template1" : obj_template = object(ds_template1.ID); break;
		case "grd_template2" : obj_template = object(ds_template2.ID); break;
		case "grd_template3" : obj_template = object(ds_template3.ID); break;
		case "grd_template4" : obj_template = object(ds_template4.ID); break;
		case "grd_template5" : obj_template = object(ds_template5.ID); break;
		default : break;
	}

	var atkla = obj_template.getcolumn(nRow, "ATKLA");
	var atnam = obj_template.getcolumn(nRow, "PRH"  );

	switch (atkla) {
		case "EL_BASIC" : if (atnam == "EL_ATYP" || atnam == "EL_AUSE" || atnam == "EL_AMAN"  || atnam == "EL_ACAPA" || atnam == "EL_ASPD" || atnam=="EL_ATT" ||
							  atnam == "EL_AFQ"  || atnam == "EL_ASTQ" || atnam == "EL_AOPEN" || atnam == "EL_ALOCT" || atnam == "EL_ADTA" || atnam=="EL_ACD1") {
							gfn_showAlert("CW10094"); return; // 입력할 수 없습니다.
						  } else if (atnam=="SH_EL_ATYP" || atnam=="SH_EL_AUSE" || atnam=="SH_EL_AMAN"  || atnam=="SH_EL_ACAPA" || atnam=="SH_EL_ASPD" || atnam=="SH_EL_ATT" ||
									 atnam=="SH_EL_AFQ"  || atnam=="SH_EL_ASTQ" || atnam=="SH_EL_AOPEN" || atnam=="SH_EL_ALOCT" || atnam=="SH_EL_ADTA" || atnam=="SH_EL_ACD1") {
							gfn_showAlert("CW10094"); return; // 입력할 수 없습니다.
						  } break;
		case "ES_BASIC" : if (atnam=="ES_ATYP" || atnam=="ES_ALOCAT" || atnam=="ES_ALOCA" || atnam=="ES_AWID" || atnam=="ES_ASPE" || atnam=="ES_ADEG" ||
							  atnam=="ES_ARISE" || atnam=="ES_ATT") {
							gfn_showAlert("CW10094"); return; // 입력할 수 없습니다.
						  } else if (atnam=="SH_ES_ATYP" || atnam=="SH_ES_ALOCAT" || atnam=="SH_ES_ALOCA" || atnam=="SH_ES_AWID" || atnam=="SH_ES_ASPE" ||
							  atnam=="SH_ES_ARISE" || atnam=="SH_ES_ATT") {
							gfn_showAlert("CW10094"); return; // 입력할 수 없습니다.
						  } break;
		case "MW_BASIC" : if (atnam=="MW_ATYP" || atnam=="MW_ALOCAT" || atnam=="MW_ALOCA" || atnam=="MW_AWID" || atnam=="MW_ASPE" || atnam=="MW_ADEG" ||
							  atnam=="MW_ARIS" || atnam=="MW_ALENG" || atnam=="MW_ATT") {
							gfn_showAlert("CW10094"); return; // 입력할 수 없습니다.
						  } break;
		case " "        : if (atnam=="CO_DDVRTQ" || atnam=="CO_DEPHTQ" || atnam=="CO_DSSQ"   || atnam=="CO_BCLCDTQ" || atnam=="CO_CHPITQ" ||
							  atnam=="CO_ASPC"   || atnam=="CO_DSV1"   || atnam=="CO_DSV1TQ" || atnam=="CO_DSV2"    || atnam=="CO_DSV2TQ" ||
							  atnam=="CO_ASPD") {	// 고속현장 2013.04.03
							gfn_showAlert("CW10094"); return; // 입력할 수 없습니다.
						  } break;
		case "AP_BASIC" : // (2012.12.10)
						  if (atnam=="AP_ATYP" || atnam=="AP_AEA" || atnam=="AP_AMOD" || atnam=="AP_ACS" || atnam=="AP_AQL" || atnam=="AP_AQC" || atnam=="AP_AQT" || atnam=="AP_AETS") {
							gfn_showAlert("CW10094"); return; // 입력할 수 없습니다.
						  } break;
		case "PSD_BASIC": // (2012.12.10)
						  if (atnam=="PSD_AFORM1" || atnam=="PSD_ANAME") {
							gfn_showAlert("CW10094"); return; // 입력할 수 없습니다.
						  } break;
		default         : break;
	}

	if (obj_template.getColumn(nRow, "CNT") == 0) {
		obj.Editable = true; return;
	}

	var fa_atkla = quote(atkla);
	var fa_atnam = quote(atnam);
	
	var arg = " fa_mandt = "+G_MANDT+" fa_class = "+zprdgbn+" fa_atkla = "+fa_atkla+" fa_atnam = "+fa_atnam+" fa_where = "+quote("");
	var arr = gfn_openPopupUrl("COM::Com0150.xml", true, arg);
	if (arr != null && arr != 0)	{	// 2013.01.09 선택값 체크
		F_GRID_SELECT = "Y";
		obj_template.SetColumn(nRow, "PRD", arr[6]);
	}
}

function btn_qtser_plus_OnClick(obj) {
//trace("************43");
	ds_error.ClearData();

	var qtnum = ds_header.GetColumn(0, "QTNUM"); // 견적번호

	if (qtnum == null || qtnum == "") {
		gfn_showAlert("CW10065");
			return; // 견적번호가 없습니다.
	} else {
		if (gfn_showConfirm("CW10067") == true)
			fn_qtser("A"); // 차수를 증가하시겠습니까?
	}
}

function btn_qtser_minus_OnClick(obj) {
//trace("************44");
	ds_error.ClearData();

	var qtnum   = ds_header.GetColumn(0, "QTNUM"  ); // 견적번호
	var zprgflg = ds_header.GetColumn(0, "ZPRGFLG"); // 진행상태

	if (qtnum == null || qtnum == "") {
		gfn_showAlert("CW10065"); return; // 견적번호가 없습니다.
	} else if (zprgflg >= "50") { // 50 입찰
		gfn_showAlert("CW00072"); return; // 삭제가 불가한 데이터입니다.
	} else {
		if (gfn_showConfirm("CI00015", "차수") == true) fn_qtser("D"); // 차수를 삭제하시겠습니까?
	}
}

function fn_qtser(detail_flag) {
//trace("************45");
	var vSvcId = "saveQtserAdd";

	fn_createWait("",this); // 처리중입니다. 메시지 처리

	if(detail_flag == "D")
		vSvcId = "saveQtserDel";

	nsfRequest(  vSvcId
			   , "ses0031/saveQtser"
			   , "ds_header=ds_header ds_detail=ds_detail"	// 2013.01.09 수주계획번호용 detail 추가
			   , "ds_header=ds_header ds_error=ds_error"
			   , "qtser_flag=" + quote(detail_flag)			// A: 추가, D:삭제
			   , "fn_afterSave"
			   );

	// ds_header.OnColumnChanged = "";
	// ds_header.OnRowPosChanged = "";
	// ds_header.SetColumn(0, "FLAG", detail_flag);
	// ds_header.OnColumnChanged = "ds_header_OnColumnChanged";
	// ds_header.OnRowPosChanged = "ds_header_OnRowPosChanged";
				
	// ds_detail.OnColumnChanged = "";
	// ds_detail.CanRowPosChange = "";
	// ds_detail.OnRowPosChanged = "";

	// for (var i=0; i<ds_detail.GetRowCount(); i++) { ds_detail.SetColumn(i, "FLAG", detail_flag); }

	// ds_detail.OnColumnChanged = "ds_detail_OnColumnChanged";
	// ds_detail.CanRowPosChange = "ds_detail_CanRowPosChange";
	// ds_detail.OnRowPosChanged = "ds_detail_OnRowPosChanged";

	// ds_template_save.Copy(ds_detail);
	//nsfRequest("saveHeader", "ses0031/saveHeader", "ds_header=ds_header ds_detail=ds_detail ds_template=ds_template_save"
	//			, "ds_header=ds_header ds_error=ds_error", "", "fn_afterSave");
}

/*function cb_zregn2_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex) {
//trace("************2");
	var str = "";
	var searchRow;
	var qtseq;
	ds_zregn3.UnFilter();

	switch (strCode) {
		case "01" :	str = "ATWRT == " + quote("900016209");     break; // 제주도
		case "02" :	str = "Substr(ATWRT,0,1) == " + quote("7"); break; // 전라북도
		case "03" :	str = "ATWRT !="+quote("600013119")+" && Substr(ATWRT,0,1) =="+quote("6"); break; // 전라남도
		case "04" :	str = "Substr(ATWRT,0,1) == " + quote("5"); break; // 충청북도
		case "05" :	str = "ATWRT !="+quote("400011095")+" && Substr(ATWRT,0,1) =="+quote("4"); break; // 충청남도
		case "06" :	str = "ATWRT == " + quote("200005028") + "||ATWRT == " + quote("200005029") + "||ATWRT == " + quote("200007049")
		              + "||ATWRT == " + quote("200007053") + "||ATWRT == " + quote("200007212") + "||ATWRT == " + quote("200007214");     
		            break; // 인천광역시 + 부평 + 강화 + 영종 + 용유도 + 옹진군
		case "07" :	str = "Substr(ATWRT,0,1) == " + quote("3"); break; // 강원도
		case "08" :	str = "ATWRT == " + quote("600013119");     break; // 광주광역시
		case "09" :	str = "ATWRT !="+quote("200005029")+" && Substr(ATWRT,0,1) == "+quote("2"); break; // 경기도
		case "10" :	str = "ATWRT !="+quote("900016201")+" && Substr(ATWRT,0,1) == "+quote("9"); break; // 경상북도
		case "11" : str = "ATWRT !="+quote("800015170")+" && ATWRT !="+quote("800015181")+" && Substr(ATWRT,0,1) =="+quote("8"); break; // 경상남도
		case "12" : str = "ATWRT == "+quote("800015181"); break; // 부산광역시
		case "13" : str = "Substr(ATWRT,0,1) == " + quote("1"); break; // 서울특별시
		case "14" :	str = "ATWRT == " + quote("900016201");     break; // 대구광역시
		case "15" :	str = "ATWRT == " + quote("400011095");     break; // 대전광역시
		case "16" : str = "ATWRT == " + quote("800015170");     break; // 울산광역시
		case "17" : str = "ATWRT == " + quote("400011224");     break; // 세종특별자치시
		default : break;
	}

	ds_zregn3.Filter(str);
	tab.main.div_header.cb_zregn3.Index = 0;
}*/

/*function cb_zregn3_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex) {
//trace("************3");
	var str = Substr(strCode, 0, 1);
	var qtseq;
	var searchRow;

	switch (strCode) {
		case "200005029" : searchRow = ds_zregn2.searchRow("ATWRT =="+quote("06")); break; // 인천광역시
		case "200005028" : searchRow = ds_zregn2.searchRow("ATWRT =="+quote("06")); break; // 부평 -> 인천
		case "200007049" : searchRow = ds_zregn2.searchRow("ATWRT =="+quote("06")); break; // 강화 -> 인천
		case "200007053" : searchRow = ds_zregn2.searchRow("ATWRT =="+quote("06")); break; // 영종 -> 인천
		case "200007212" : searchRow = ds_zregn2.searchRow("ATWRT =="+quote("06")); break; // 용유도 -> 인천
		case "200007214" : searchRow = ds_zregn2.searchRow("ATWRT =="+quote("06")); break; // 옹진군 -> 인천
		case "400011095" : searchRow = ds_zregn2.searchRow("ATWRT =="+quote("15")); break; // 대전광역시
		case "600013119" : searchRow = ds_zregn2.searchRow("ATWRT =="+quote("08")); break; // 광주광역시
		case "800015181" : searchRow = ds_zregn2.searchRow("ATWRT =="+quote("12")); break; // 부산광역시
		case "800015170" : searchRow = ds_zregn2.searchRow("ATWRT =="+quote("16")); break; // 울산광역시
		case "900016201" : searchRow = ds_zregn2.searchRow("ATWRT =="+quote("14")); break; // 대구광역시
		case "900016209" : searchRow = ds_zregn2.searchRow("ATWRT =="+quote("01")); break; // 제주도
		default :
			switch (str) {
				case "1" : searchRow = ds_zregn2.searchRow("ATWRT =="+quote("13")); break; // 서울
				case "2" : searchRow = ds_zregn2.searchRow("ATWRT =="+quote("09")); break; // 경기도
				case "3" : searchRow = ds_zregn2.searchRow("ATWRT =="+quote("07")); break; // 강원도
				case "4" : searchRow = ds_zregn2.searchRow("ATWRT =="+quote("05")); break; // 충청남도
				case "5" : searchRow = ds_zregn2.searchRow("ATWRT =="+quote("04")); break; // 충청북도
				case "6" : searchRow = ds_zregn2.searchRow("ATWRT =="+quote("03")); break; // 전라남도
				case "7" : searchRow = ds_zregn2.searchRow("ATWRT =="+quote("02")); break; // 전라북도
				case "8" : searchRow = ds_zregn2.searchRow("ATWRT =="+quote("11")); break; // 경상남도
				case "9" : searchRow = ds_zregn2.searchRow("ATWRT =="+quote("10")); break; // 경상북도
				default  : break;
			} break;
	}
	tab.main.div_header.cb_zregn2.Index = searchRow;
}*/

function fn_enable_set() {
//trace("************46");
	var h = tab.main.div_header;

	h.div_sprmk.Enable   = false; h.btn_popup.Enable  = false; h.btn_plus.Enable    = false; h.btn_minus.Enable  = false;
	h.btn_common.Enable  = false; h.grd_zicif.Enable  = false;

	h.cal_zestdat.Enable = false; 
	
	if ( zprgflg > "61") {	h.cal_deldat.Enable = false; };
	
	h.ed_dev.Enable      = false; h.chk_cst.Enable     = false;
	h.cb_zbdtyp.Enable   = false; h.cb_zbdtyp_l.Enable = false;//h.cb_zregn1.Enable  = false; h.cb_zregn2.Enable   = false; h.cb_zregn3.Enable   = false;
	h.ed_pid.Enable      = false; h.ed_tel.Enable      = false; h.med_zipcode.Enable = false; h.btn_zipcode.Enable = false;
	h.ed_addr1.Enable    = false; h.ed_addr2.Enable    = false; h.cb_inco1.Enable    = false; h.ed_zagnt.Enable    = false;
	h.cb_qtgbn.Enable    = false;

	h.grd_detail.OnCellClick  = ""; // h.grd_detail.OnExpandEdit = "";
	if ( ds_header.GetColumn(0, "SPART") == "30" ) h.grd_detail.OnCellClick  = "grd_detail_OnCellClick";

	cal_qtdat.Enable = false;

	var obj0 = tab.template.div_template.grd_template0; obj0.Editable = false; obj0.OnCellPosChanged = ""; obj0.OnCellDblClick = "";
	var obj1 = tab.template.div_template.grd_template1; obj1.Editable = false; obj1.OnCellPosChanged = ""; obj1.OnCellDblClick = "";
	var obj2 = tab.template.div_template.grd_template2; obj2.Editable = false; obj2.OnCellPosChanged = ""; obj2.OnCellDblClick = "";
	var obj3 = tab.template.div_template.grd_template3; obj3.Editable = false; obj3.OnCellPosChanged = ""; obj3.OnCellDblClick = "";
	var obj4 = tab.template.div_template.grd_template4; obj4.Editable = false; obj4.OnCellPosChanged = ""; obj4.OnCellDblClick = "";
	var obj5 = tab.template.div_template.grd_template5; obj5.Editable = false; obj5.OnCellPosChanged = ""; obj5.OnCellDblClick = "";
	var obj6 = tab.template.div_template;

	obj6.cb_block.Enable     = false;
	obj6.btn_duty.Enable     = false;
	obj6.btn_depend.Enable   = false;
	obj6.btn_template.Enable = false;
}

function btn_duty_OnClick(obj) {
//trace("************47");

	btn_count.Visible = false;	// 2013.02.18 ★★★★★

	ds_error.ClearData();

	ds_cond.ClearData();
	ds_cond.AddRow();
	ds_cond.SetColumn(0, "MANDT"   , G_MANDT         );
	ds_cond.SetColumn(0, "BLOCKGBN", tab.template.div_template.cb_block.value);
	
	var cond = "BLOCKGBN=" + tab.template.div_template.cb_block.value;

	fn_duty();
	nsfRequest("queryDuty", "duty/genDuty", "ds_cond=ds_cond ds_template1=ds_template_add", "ds_template_add=ds_template1 ds_error=ds_error", cond, "fn_afterQuery");
	fn_createWait("",this);     // 처리중입니다. 메시지 처리
}

function fn_duty() {
//trace("************48");
	var j = 0;
	var obj_template;

	ds_template_add.ClearData();

	for (var a=0; a<=5; a++) {

		switch (a) {
			case 0	: obj_template = object(ds_template0.ID); break;
			case 1	: obj_template = object(ds_template1.ID); break;
			case 2	: obj_template = object(ds_template2.ID); break;
			case 3	: obj_template = object(ds_template3.ID); break;
			case 4	: obj_template = object(ds_template4.ID); break;
			case 5	: obj_template = object(ds_template5.ID); break;
			default : break;
		}

		for (var i=0; i<obj_template.GetRowCount(); i++) {
			ds_template_add.AddRow();
			ds_template_add.SetColumn(j, "FLAG"   , Trim(obj_template.GetColumn(i, "FLAG"   )));
			ds_template_add.SetColumn(j, "MANDT"  , Trim(obj_template.GetColumn(i, "MANDT"  )));
			ds_template_add.SetColumn(j, "ATKLA"  , Trim(obj_template.GetColumn(i, "ATKLA"  )));
			ds_template_add.SetColumn(j, "PRH"    , Trim(obj_template.GetColumn(i, "PRH"    )));
			ds_template_add.SetColumn(j, "PRHNAME", Trim(obj_template.GetColumn(i, "PRHNAME")));
			ds_template_add.SetColumn(j, "PRD"    , Trim(obj_template.GetColumn(i, "PRD"    )));
			ds_template_add.SetColumn(j, "ZRMK"   , Trim(obj_template.GetColumn(i, "ZRMK"   )));
			ds_template_add.SetColumn(j, "QTNUM"  , Trim(obj_template.GetColumn(i, "QTNUM"  )));
			ds_template_add.SetColumn(j, "QTSER"  , Trim(obj_template.GetColumn(i, "QTSER"  )));
			ds_template_add.SetColumn(j, "QTSEQ"  , Trim(obj_template.GetColumn(i, "QTSEQ"  )));
			ds_template_add.SetColumn(j, "PRSEQ"  , Trim(obj_template.GetColumn(i, "PRSEQ"  )));
			ds_template_add.SetColumn(j, "ATFOR"  , Trim(obj_template.GetColumn(i, "ATFOR"  )));	// 2013.01.09 사양 입력 구분
			j++;
		}
	}
}

function fn_query_detail(zprgflg) {
//trace("************49");
	ds_header.SetColumn(0, "ZPRGFLG", zprgflg); // 32 원가산출, 41 원가팀의뢰
	nsfRequest("saveHeaderFlag", "ses0031/updateHeaderFlag", "ds_header=ds_header", "ds_header=ds_header ds_error=ds_error", "", "fn_afterSave");
	nsfRequest("queryDetail", "ses0030/detail", "ds_cond=ds_header ds_detail=ds_detail", "ds_detail=ds_detail ds_error=ds_error", "", "");
}

function fn_setFormByPrd(sZprdgbn, svcId, sPart) // 제품군에 따른 화면 설정 (2012.12.10)
{
    // trace("************ 50");
	var objGrid = tab.main.div_header.grd_detail;
	
	//2016.12.22 분기기준 수정(자재ClassID -> 자재ClassID, 헤더:제품군) by mj.Shin 
	// if ( sZprdgbn == "AP_01" ) //주차
	if ( sZprdgbn == "AP_01" || sPart == "20" ) //주차
	{
		//tab.main.div_header.cb_zregn3.Enable = false; // 비활성화 - 운송지역 콤보
		
		// 기본값 설정 - 최초 입력시에만 설정
		if ( svcId == "querySo" )
		{
			// 특기사항 기본값
			tab.main.div_header.div_sprmk.ed_sprmk1.Text = "건축토목 및 1차전원 인입공사 제외";
			tab.main.div_header.div_sprmk.ed_sprmk2.Text = "수용차량 대수 : 승용 ( )대,  RV ( )대";
			//tab.main.div_header.div_sprmk.ed_sprmk3.Text = "무상보수 ( ) 개월";
			
			// 수금조건 기본값
			ds_header.SetColumn(0, "ZICIF_PPRT", 30); 		// 선수금-율(%)
			ds_header.SetColumn(0, "ZICIF_PPCD", "10"); 	// 선수금-조건	=> 10-현금
			ds_header.SetColumn(0, "ZICIF_PPCT", "계약시"); // 선수금-내용
			
			ds_header.SetColumn(0, "ZICIF_1STRT", 50); 				// 1차중도금-율(%)
			ds_header.SetColumn(0, "ZICIF_1STCD", "10"); 			// 1차중도금-조건	=> 10-현금
			ds_header.SetColumn(0, "ZICIF_1STCT", "주자재 반입시"); // 1차중도금-내용
			
			ds_header.SetColumn(0, "ZICIF_RMRT", 20); 					// 잔금-율(%)
			ds_header.SetColumn(0, "ZICIF_RMCD", "10"); 				// 잔금-조건	=> 10-현금
			ds_header.SetColumn(0, "ZICIF_RMCT", "사용검사필증교부시"); // 잔금-내용
		}
		
		// 디테일 그리드 헤더 텍스트 변경
		objGrid.SetCellProp("head",  5, "text", "모델명");   // 용도          -> 모델명 
		objGrid.SetCellProp("head",  6, "text", "승입방향"); // 인승,폭       -> 승입방향
		objGrid.SetCellProp("head",  7, "text", "수용차종"); // 용량          -> 수용차종
		objGrid.SetCellProp("head",  8, "text", "단수");     // 속도/각도     -> 단수
		objGrid.SetCellProp("head",  9, "text", "수용대수"); // 층수/높이     -> 파렛트수
		objGrid.SetCellProp("head", 10, "text", "리프트수"); // 정지층수/속도 -> 리프트수
		objGrid.SetCellProp("head", 11, "text", "외부턴");   // DOOR개폐길이  -> 외부턴
		objGrid.SetCellProp("head", 12, "text", "기수");   // DOOR개폐길이  -> 외부턴
		
		objGrid.SetColProp(3, "Width", "0"); //판매지역
		objGrid.SetColProp(18, "Width", "0"); //원가내역 필드 
		objGrid.SetColProp(19, "Width", "0"); //사양 필드 
		//objGrid.SetColProp(20, "Width", "0"); //일식외주 필드 
	}
	// else if ( sZprdgbn == "PSD_01" ) // PSD
	else if ( sZprdgbn == "PSD_01" || sPart == "40" ) // PSD
	  
	{
		tab.main.div_header.ed_zagnt.Enable  = false; // 비활성화-대리점명
		//tab.main.div_header.cb_zregn3.Enable = false; // 비활성화-운송지역
		
		// 기본값 설정 - 최초 입력시에만 설정
		if ( svcId == "querySo" )
		{
			//특기사항 기본값
			tab.main.div_header.div_sprmk.ed_sprmk1.Text = "Prototype Test 별도";
			tab.main.div_header.div_sprmk.ed_sprmk2.Text = "Spare Parts는 견적가 0.5% 이내";
			tab.main.div_header.div_sprmk.ed_sprmk3.Text = "임시동력 및 용수 등 Utility는 발주처 제공 조건(자재보관장소 포함)";
			tab.main.div_header.div_sprmk.ed_sprmk4.Text = "Operator Training은 현장교육에 중함";
			tab.main.div_header.div_sprmk.ed_sprmk5.Text = "1차측 전원공사 제외";
			
			// 수금조건 기본값
			ds_header.SetColumn(0, "ZICIF_PPRT", 30); 		// 선수금-율(%)
			ds_header.SetColumn(0, "ZICIF_PPCD", "10"); 	// 선수금-조건	=> 10-현금
			ds_header.SetColumn(0, "ZICIF_PPCT", "계약시"); // 선수금-내용
			ds_header.SetColumn(0, "ZICIF_1STRT", 50); 				// 1차중도금-율(%)
			ds_header.SetColumn(0, "ZICIF_1STCD", "10"); 			// 1차중도금-조건	=> 10-현금
			ds_header.SetColumn(0, "ZICIF_1STCT", "주자재 반입시"); // 1차중도금-내용
			ds_header.SetColumn(0, "ZICIF_RMRT", 20); 					// 잔금-율(%)
			ds_header.SetColumn(0, "ZICIF_RMCD", "10"); 				// 잔금-조건	=> 10-현금
			ds_header.SetColumn(0, "ZICIF_RMCT", "사용검사필증교부시"); // 잔금-내용
		}
		
		// 디테일 그리드 헤더 텍스트 변경
			objGrid.SetCellProp("head",  5, "text", "역사명");    
			objGrid.SetCellProp("head",  6, "text", "길이");  
			objGrid.SetCellProp("head",  7, "text", "타입");  
			objGrid.SetCellProp("head",  8, "text", "량수/문수");  
			objGrid.SetCellProp("head",  9, "text", "플랫폼수");  
			objGrid.SetCellProp("head", 10, "text", "제어방식");  
			objGrid.SetCellProp("head", 11, "text", "재질");   
		
		    objGrid.SetColProp(3, "Width", "0"); //판매지역
			//objGrid.SetColProp(12, "Width", "0"); //대수 필드 
			objGrid.SetColProp(18, "Width", "0"); //원가내역 필드 
			objGrid.SetColProp(19, "Width", "0"); //사양 필드 
			//objGrid.SetColProp(20, "Width", "0"); //일식외주 필드 
		// Type2, Type3 미사용
		//ds_detail.SetColumn(0, "TYPE2", "");
		//ds_detail.SetColumn(0, "TYPE3", "");		
		
	}
	else if ( sZprdgbn == "" || sZprdgbn == null )
	{
		if ( sPart == "30" ) // 물류
		{			
			//tab.main.div_header.cb_zregn3.Enable = false; // 비활성화-운송지역
			tab.main.div_header.cb_fa_byrgbn.Enable = true; // 활성화-업종구분
			
			/*// Type1, Type2, Type3 미사용
			ds_detail.SetColumn(0, "TYPE1", "");
			ds_detail.SetColumn(0, "TYPE2", "");
			ds_detail.SetColumn(0, "TYPE3", "");*/
			// 디테일 그리드 헤더 텍스트 변경
			objGrid.SetCellProp("head",  5, "text", "S/C TYPE");    
			objGrid.SetCellProp("head",  6, "text", "대수");  
			objGrid.SetCellProp("head",  7, "text", "RTV대수");  
			objGrid.SetCellProp("head",  8, "text", "보관량(CELL수)");  
			objGrid.SetCellProp("head",  9, "text", "설비");  
			objGrid.SetCellProp("head", 10, "text", "판넬");  
			objGrid.SetCellProp("head", 11, "text", "건축");   
			//objGrid.SetCellProp("head", 12, "text", "기수");   // DOOR개폐길이  -> 외부턴
			
			objGrid.SetColProp(3, "Width", "0"); //판매지역
			//objGrid.SetColProp(12, "Width", "0"); //대수 필드 
			objGrid.SetColProp(18, "Width", "0"); //원가내역 필드 
			objGrid.SetColProp(19, "Width", "0"); //사양 필드 
			//objGrid.SetColProp(20, "Width", "0"); //일식외주 필드 
						
		}
	}
}

// Detail의 원가,견적가가 변경되면 헤더의 합계에 반영
function fn_applayHeaderCost()
{
//trace("************51");
	tab.main.div_header.ed_sum_zcost.mask = "##0"; // 원가
	tab.main.div_header.ed_sum_zeam.mask  = "##0"; // 견적가
	tab.main.div_header.ed_sum_shang.mask = "##0.#"; // 시행율
	
	var nZnumber = round(ds_detail.caseSum("FLAG!='D'", "ZNUMBER"),0); // 대수
	//var nZeam    = round(ds_detail.caseSum("FLAG!='D'", "ZEAM"   ),0); // 견적가
	//var nZcost   = round(toNumber(ds_detail.caseSum("FLAG!='D'", "ZCOST"  )),0); // 원가
	var nZcost = 0;
	var nZeam = 0;
	//casesum 을 사용할경우 금액이 크면 data range를 벗어나 - 금액 발생 
	for (var i = 0; i < ds_detail.GetRowCount(); i++)	{
		if (ds_detail.GetColumn(i,"FLAG") != 'D') {
			nZcost = nZcost + toNumber(ds_detail.GetColumn(i,"ZCOST"));
		}
	}
	
	for (var i = 0; i < ds_detail.GetRowCount(); i++)	{
		if (ds_detail.GetColumn(i,"FLAG") != 'D') {
			nZeam = nZeam + toNumber(ds_detail.GetColumn(i,"ZEAM"));
		}
	}
	
	
	var nShang  = 0;
	if ( parseInt(nZeam) == 0 ) {
		nShang = 0;
	} else {
		nShang = parseFloat(nZcost) * 100 / parseFloat(nZeam);
		if (nShang >= 999) nShang = 999;
		else               nShang = round(nShang, 1);
	}
	
	ds_header.SetColumn(0, "ZSUM_ZNUMBER", nZnumber); // 대수
	ds_header.SetColumn(0, "ZSUM_ZCOST"  , nZcost  ); // 원가
	ds_header.SetColumn(0, "ZSUM_ZEAM"   , nZeam   ); // 견적가
	ds_header.SetColumn(0, "ZSUM_SHANG"  , nShang  ); // 시행율	
	
}

// 2013.01.08 설계부의 표준템플릿 사용시 종속성 Duty call
// 사양템플릿 화면에서 호출됨
function fn_stdGenDuty(vZTPLGBN, vGtype)
{
//trace("************52");
	fn_createWait("",this);     // 처리중입니다. 메시지 처리

	ds_error.ClearData();

	var cond = "strGtype=" + quote(vGtype);

	fn_duty();
	// 종속성 Duty 처리 후 기존 Duty적용 fn호출됨
	nsfRequest(   "queryDuty"
				, "duty/stdGenDuty"
				, "ds_template1=ds_template_add"
				, "ds_template_add=ds_template1 ds_error=ds_error"
				, cond
				, "fn_afterQuery"
			   );
}

// 2013.01.10 사양 그리드 값에 대한 tooltip 처리
function tab_template_div_template_grd_template_OnMouseOver(obj,nPosX,nPosY,nRow,nCell,nPivotIndex)
{
	if ( nCell == 2 || nCell == 3 )
	{
		obj.ToolTipText = obj.GetCellText('Body', nRow, nCell);
	}else	{
		obj.ToolTipText = "";
	}
}

// 2013.01.16 
function tab_main_div_header_grd_detail_OnCellPosChanged(obj,nRow,nCell,nOldRow,nOldCell,nPivotIndex,nOldPivotIndex)
{
	if (nOldRow != nRow)	{
		if (F_CLCIK_EVENT == "OFF")
			grd_detail_OnCellClick(obj, nRow, nCell);
		
		F_CLCIK_EVENT = "OFF";
	}
}

// 2013.02.07 사양 넓게 보이기 위해 사이즈 조정
function fn_resize() {
	this.onsize = "";

	//this.window.showwindow("Maximize");
	window.top    = GetPlatformInfo("WorkArea","top");
	window.left   = GetPlatformInfo("WorkArea","left");
	window.width  = GetPlatformInfo("WorkArea","width");
	window.height = GetPlatformInfo("WorkArea","height");

	tab.width  = window.width-10;
	tab.height = window.height-80;
	
	tab.main.div_header.Width       = tab.width-4;
	tab.template.div_template.Width = tab.width-2;

	tab.main.div_header.height      = tab.height-25;
	tab.template.div_template.height= tab.height-30;
	
	tab.main.div_header.grd_detail.height = tab.height-305;
	tab.main.div_header.grd_detail.width  = tab.width-10;
	
	tab.template.div_template.grd_template0.height = tab.template.div_template.height-60;
	tab.template.div_template.grd_template1.height = tab.template.div_template.height-60;
	tab.template.div_template.grd_template2.height = tab.template.div_template.height-60;
	tab.template.div_template.grd_template3.height = tab.template.div_template.height-60;
	tab.template.div_template.grd_template4.height = tab.template.div_template.height-60;
	tab.template.div_template.grd_template5.height = tab.template.div_template.height-60;
}

// 2013.03.06 종속성 검증 처리
function fn_dependDuty(obj)
{
	fn_createWait("",this);     // 처리중입니다. 메시지 처리

	ds_error.ClearData();

	var vGtype = "";
    
	
    if ( obj.id == "btn_depend" ){
		switch(ds_detail.GetColumn(ds_detail.currow, "ZPRDGBN"))	{
			case "ELV_01" : vGtype = "ZEL1";
							break;
			case "ESC_01" : vGtype = "ZES1";
							break;
			case "MW_01"  : vGtype = "ZMW1";
							break;
			case "AP_01"  : vGtype = "ZPK1";
							break;
			default       : break;
		}
	}else {
		switch(ds_detail.GetColumn(ds_detail.currow, "ZPRDGBN"))	{
			case "ELV_01" : vGtype = "ZEL3";
							break;
			case "ESC_01" : vGtype = "ZES3";
							break;
			case "MW_01"  : vGtype = "ZMW3";
							break;
			default       : break;
		}
	}

	var cond = "strGtype=" + quote(vGtype);

	fn_duty();

	// 종속성 Duty 처리 후 기존 Duty적용 fn호출됨
	nsfRequest(   "queryDuty"
				, "duty/dependDuty"
				, "ds_template1=ds_template_add"
				, "ds_template_add=ds_template1 ds_error=ds_error"
				, cond
				, "fn_afterQuery"
			   );
}

// 2013.04.26 원가반려 영업3부만 처리 가능
function btn_costReject_OnClick(obj)
{
	if (ds_header.GetColumn(0, "VKBUR") != "B400")	{
		gfn_showAlert("CW00071", "부서");
		return;
	}

	if (gfn_showConfirm("CI00024", "원가반려"))	{
		// 상태 변경 처리 zprgflg 25로 변경
		ds_header.SetColumn(0, "ZPRGFLG", "25");	// 25 : 견적승인으로 변경
		nsfRequest("saveHeaderFlag", "ses0031/updateHeaderFlag", "ds_header=ds_header", "ds_header=ds_header ds_error=ds_error", "", "fn_afterSave");
		fn_zprgflg();
	}
}

function tab_main_div_header_ed_gsum_OnKeyDown(obj,nChar,bShift,bCtrl,bAlt,nLLParam,nHLParam) {
	
	if (nChar == 13) {  //엔터 
	  
	  var ed_gsum = toNumber(tab.main.div_header.ed_gsum);	  
	  toNumber(ed_gsum);
	  //목표시행율에따라 MO 견적가 자동계산 
	  for (var i = 0; i < ds_detail.GetRowCount(); i++)	{
		if ( ds_detail.GetColumn(i, "ZCOST") <> "") {
			ds_detail.SetColumn(i, "ZEAM",  round(toNumber(ds_detail.GetColumn(i, "ZCOST")) / ed_gsum  * 100 ,0));
		}
	  }			
	}		
}
function btn_estimate_OnClick(obj)
{
	var qtnum = ds_header.GetColumn(0, "QTNUM"); // 견적번호

	if (qtnum == null || qtnum == "") {
		gfn_showAlert("CW10205"); return; // 견적번호를 입력하세요.
	}

	if (fn_save_header() == false) return;

	var qtser = ds_header.getColumn(0, "QTSER");
	var arg =  " fa_mandt = " + G_MANDT	 + " fa_qtnum = " + qtnum + " fa_qtser = " + qtser + " fa_zrqflg=1";
	var arr = gfn_openPopupUrl("SES::Ses0035.xml", true, arg); break;
}

function ufn_openPjt(obj)
{
	var arg = "fa_qtnum   = "+quote(tab.main.div_header.ed_aqtnum.Text)
	        + "fa_gsnam   = "+quote(tab.main.div_header.ed_gsnam.Text);		//프로젝트번호
	//trace("!!"+arg);
	//trace(tab.main.div_header.ed_aqtnum.Text);
	
//프로젝트명			+ " fa_zzpjt_nm  = "+quote(ed_qtso_nm.Text); 	
	var arr = gfn_openPopUpUrlHdel("Com::Com0250.xml", true, arg);			
	if (arr != null && arr != 0) {
		tab.main.div_header.ed_aqtnum.Text = arr[0];
	}	
}

function tab_main_div_header_grd_detail_OnEnterEdit(obj,nRow,nCell,nPivotIndex)
{
	if (F_CLCIK_EVENT == "OFF")
		grd_detail_OnCellClick(obj, nRow, nCell);
	
	F_CLCIK_EVENT = "OFF";	
}

function btn_plad_OnClick(obj) {
	var pladUrl = 'http://parking.hdel.co.kr/plad/';

	switch(obj.id) {
		case 'btn_plad_create':
	
			pladUrl += 'IF_003'
					+ '?qt_num='+ed_qtnum.Text+'&qt_serial='+ed_ser.Text+'&qt_seq='+ds_detail.GetColumn(ds_detail.currow, 'QTSEQ')
					+ '&user_id='+G_USER_ID+'&is_make_pdf=Y';
			break;
		case 'btn_plad_search':
	
			pladUrl += 'IF_004'
					+ '?qt_num='+ed_qtnum.Text+'&qt_serial='+ed_ser.Text+'&qt_seq='+ds_detail.GetColumn(ds_detail.currow, 'QTSEQ');
			break;
	}

	ExecBrowser(pladUrl);
}
function btn_plad_mesg_OnClick(obj) {
	var pladUrl = 'http://parking.hdel.co.kr/plad/';

	var popHeight = 100;
	var popWidth = 270;
	var popLeft = Window.left + (Window.width) / 2 - popWidth;
	var popTop = Window.top + (Window.height) / 2 - popHeight;

	switch(obj.id) {
		case 'btn_plad_validation':
			pladUrl += 'IF_001'
					+ '?qt_num='+ed_qtnum.Text+'&qt_serial='+ed_ser.Text+'&qt_seq='+ds_detail.GetColumn(ds_detail.currow, 'QTSEQ');
			break;
	
		case 'btn_plad_cb':
			pladUrl += 'IF_007'
					+ '?qt_num='+ed_qtnum.Text+'&qt_serial='+ed_ser.Text+'&qt_seq='+ds_detail.GetColumn(ds_detail.currow, 'QTSEQ');
			break;
	
		default:
			break;
	}
	if(IsExistVar('axmsiePlad'))
		Destory('axmsiePlad');
	Create('AxMSIE', 'axmsiePlad' );
	axmsiePlad.Navigate2('about:blank');
	axmsiePlad.Navigate2(pladUrl);
	axmsiePlad.NavigateComplete2 = 'axmsiePlad_NavigateComplete2';
}
function axmsiePlad_NavigateComplete2(obj,pDisp,URL) {
	var navValue = axmsiePlad.Document.getElementById('msg').value;
	if(trim(navValue != null))
		alert(navValue);
}
//=========================================================================================
//  함수기능  : 수주생성 문서유형, 건물용도, 지급조건, 인도조건, 종별구분 코드목록 조회
//  SV ID : fn_query_bdtyp
//  Call Back : fn_afterQuery_bdtyp
//  기능ID    : UF014
//  개선내역  : 2016.02.12 공용코드 개별 액션 호출 통합하여 처리
//=========================================================================================
function fn_query_bdtyp() {
    nsfRequest("query", "com0160/find_extend"
              ,"ds_cond_build=ds_cond_build ds_list_build=ds_list_build ds_list_build_l=ds_list_build_l"
              ,"ds_cond_build=ds_cond_build ds_list_build=ds_list_build ds_list_build_l=ds_list_build_l ds_error=ds_error"
              , ""
              , "fn_afterQuery_bdtyp"
              );
}

//=========================================================================================
//  함수기능  : 수주생성 문서유형, 건물용도, 지급조건, 인도조건, 종별구분 코드목록 조회 call Back
//  기능ID    : UF014
//=========================================================================================
function fn_afterQuery_bdtyp(svcId, errCode, errMsg) {
	
	// 건물용도 콤보박스 초기값 선언
    gfn_InsertRowCombo(ds_list_build, 0, "N", "Y", "BUILDUSE", "STEXT"); // 선택 행 추가
    gfn_InsertRowCombo(ds_list_build_l, 0, "N", "Y", "BUILDUSE_L", "STEXT"); //2020.12 jss
	
	ds_list_build.UnFilter();
	var zbdtyp = trim(ds_header.GetColumn(0, "ZBDTYP"));
	if( length(trim(zbdtyp)) != 0 ) { 
		var rowIdx = ds_list_build.FindRowNF("BUILDUSE", zbdtyp);
		var zbdtyp_l = trim(ds_list_build.GetColumnNF(rowIdx, "BUILDUSE_L"));
		if(length(zbdtyp_l) > 0 ){
			ds_list_build.Filter("BUILDUSE_L == "+quote(zbdtyp_l));
		}
	}
		
    // 에러 메시지 처리 추가
    if(ds_error.RowCount() > 0) 
    {
        gfn_showAlert(ds_error.GetColumn(0, "ERRMSG"));
    } 
}

function cb_zbdtyp_l_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	ds_list_build.UnFilter();
	if(length(trim(strCode)) > 0){
	  ds_list_build.Filter("BUILDUSE_L == "+quote(strCode));
	}else{
	  ds_list_build.UnFilter();
	} 	
	tab.main.div_header.cb_zbdtyp.index = 0;	
}]]></Script>
</Window>