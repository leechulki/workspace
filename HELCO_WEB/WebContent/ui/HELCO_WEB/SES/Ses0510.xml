<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="562" Id="Ses0410" Left="8" OnLoadCompleted="fn_OnLoadCompleted" OnUnloadCompleted="fn_OnUnloadCompleted" PidAttrib="7" Title="&#32;시방서&#32;검토&#32;요청" Top="8" Ver="1.0" Width="978" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_cond">
				<Contents>
					<colinfo id="cal_zrqdat_fm" size="256" summ="default" type="STRING"/>
					<colinfo id="cal_zrqdat_to" size="256" summ="default" type="STRING"/>
					<colinfo id="destat" size="256" summ="default" type="STRING"/>
					<colinfo id="part_cd" size="256" summ="default" type="STRING"/>
					<colinfo id="detail_cd" size="256" summ="default" type="STRING"/>
					<colinfo id="check_id" size="256" summ="default" type="STRING"/>
					<colinfo id="zrqno" size="256" summ="default" type="STRING"/>
					<colinfo id="searchkey" size="256" summ="default" type="STRING"/>
					<colinfo id="item_cd" size="256" summ="default" type="STRING"/>
					<colinfo id="sman" size="256" summ="default" type="STRING"/>
					<colinfo id="kunnr" size="256" summ="default" type="STRING"/>
					<record>
						<cal_zrqdat_fm></cal_zrqdat_fm>
						<cal_zrqdat_to></cal_zrqdat_to>
						<check_id></check_id>
						<destat></destat>
						<detail_cd></detail_cd>
						<item_cd></item_cd>
						<kunnr></kunnr>
						<part_cd></part_cd>
						<searchkey></searchkey>
						<sman></sman>
						<zrqno></zrqno>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_error">
				<Contents>
					<colinfo id="IDX" size="256" type="STRING"/>
					<colinfo id="ERRMSG" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_zrqstat_cd">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list">
				<Contents>
					<colinfo id="mandt" size="256" summ="default" type="STRING"/>
					<colinfo id="zrqno" size="256" summ="default" type="STRING"/>
					<colinfo id="zseq" size="256" summ="default" type="STRING"/>
					<colinfo id="destat" size="256" summ="default" type="STRING"/>
					<colinfo id="kunnr" size="256" summ="default" type="STRING"/>
					<colinfo id="name1" size="256" summ="default" type="STRING"/>
					<colinfo id="zrevym" size="256" summ="default" type="STRING"/>
					<colinfo id="sman" size="256" summ="default" type="STRING"/>
					<colinfo id="kunz2_nm" size="256" summ="default" type="STRING"/>
					<colinfo id="zrqdat" size="256" summ="default" type="STRING"/>
					<colinfo id="kunz3" size="256" summ="default" type="STRING"/>
					<colinfo id="kunz3_nm" size="256" summ="default" type="STRING"/>
					<colinfo id="zrecdt" size="256" summ="default" type="STRING"/>
					<colinfo id="zrefdt" size="256" summ="default" type="STRING"/>
					<colinfo id="vkbur" size="256" summ="default" type="STRING"/>
					<colinfo id="vkgrp" size="256" summ="default" type="STRING"/>
					<colinfo id="PART_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="part_nm" size="256" summ="default" type="STRING"/>
					<colinfo id="detail_cd" size="256" summ="default" type="STRING"/>
					<colinfo id="detail_nm" size="256" summ="default" type="STRING"/>
					<colinfo id="check_id" size="256" summ="default" type="STRING"/>
					<colinfo id="check_nm" size="256" summ="default" type="STRING"/>
					<colinfo id="item_cd" size="256" summ="default" type="STRING"/>
					<colinfo id="searchkey" size="256" summ="default" type="STRING"/>
					<colinfo id="spec_text" size="256" summ="default" type="STRING"/>
					<colinfo id="hdel_text" size="256" summ="default" type="STRING"/>
					<colinfo id="append_text" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond_dd07t">
				<Contents>
					<colinfo id="DOMNAME" size="50" type="STRING"/>
					<colinfo id="DOMVALUE_L" size="50" type="STRING"/>
					<colinfo id="CONCAT_YN" size="1" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_destat_cd">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_part_cd">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_detail_cd">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_check_id">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
		</Datasets>
		<Shape BKColor="user0" Bottom="34" Height="26" Id="Shape1" Left="8" LineColor="user1" Right="970" TabOrder="1" Top="8" Type="Rectangle" Width="962"></Shape>
		<Shape BKColor="user0" Bottom="60" Height="26" Id="Shape2" Left="8" LineColor="user1" Right="970" TabOrder="2" Top="34" Type="Rectangle" Width="962"></Shape>
		<Static Align="Right" Height="24" Id="st_qtdat_fm" Left="9" Style="sty_lb_search" TabOrder="3" Text="요청기간&#32;" Top="9" VAlign="Middle" Width="85"></Static>
		<Static Align="Right" Height="24" Id="st_sman" Left="690" Style="sty_lb_search" TabOrder="4" Text="영업담당자&#32;" Top="9" VAlign="Middle" Width="85"></Static>
		<Calendar BindDataset="ds_cond" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="CAL_ZRQDAT_FM" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_zrqdat_fm" Left="96" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="6" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="11" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="88"></Calendar>
		<Static Align="Center" Border="None" Color="user7" Font="굴림,9" Height="20" Id="st_soym_to" Left="186" TabOrder="5" Text="~" Top="12" VAlign="Middle" Width="18"></Static>
		<Calendar BindDataset="ds_cond" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="CAL_ZRQDAT_TO" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_zrqdat_to" Left="203" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="7" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="11" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="90"></Calendar>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="CODE" Column="DESTAT" DataColumn="CODE_NAME" Height="20" Id="cb_destat" InnerDataset="ds_destat_cd" Left="95" Style="sty_ipt_form" TabOrder="8" Top="36" Width="100"></Combo>
		<Static Align="Right" Height="24" Id="Static4" Left="312" Style="sty_lb_search" TabOrder="9" Text="거래선&#32;" Top="9" VAlign="Middle" Width="65"></Static>
		<Static Align="Right" Height="24" Id="Static5" Left="216" Style="sty_lb_search" TabOrder="10" Text="파&#32;트&#32;" Top="35" VAlign="Middle" Width="69"></Static>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_accept" ImageID="btn_sub_08" Left="8" LeftMargin="12" OnClick="btn_accept_OnClick" Style="sty_btn" TabOrder="11" Text="시방서&#32;검토&#32;요청" Top="91" Transparent="TRUE" Width="120"></Button>
		<Grid AutoEnter="TRUE" AutoFitEndLine="Hide" BindDataset="ds_list" BkColor2="default" BoldHead="true" Border="Flat" Bottom="552" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="25" Height="432" HScrollCell="TRUE" Id="grd_list" InputPanel="FALSE" Left="8" LineColor="user20" LineType="ExHORZ" OnCellClick="grd_list_OnCellClick" OnCellDBLClick="grd_list_OnCellDblClick" OnExpandEdit="grd_list_OnExpandEdit" OnHeadClick="grd_List_OnHeadClick" Right="973" RowHeight="50" ScrollCell="true" Style="sty_grid" TabOrder="12" TabStop="true" Top="120" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="965">
			<contents>
				<format id="Default">
					<columns>
						<col width="31"/>
						<col width="100"/>
						<col width="55"/>
						<col width="55"/>
						<col width="118"/>
						<col width="93"/>
						<col width="80"/>
						<col width="93"/>
						<col width="107"/>
						<col width="93"/>
						<col width="93"/>
						<col width="137"/>
						<col width="153"/>
						<col width="88"/>
						<col width="160"/>
						<col width="197"/>
						<col width="80"/>
						<col width="181"/>
						<col width="400"/>
						<col width="400"/>
						<col width="400"/>
					</columns>
					<head>
						<cell align="center" col="0" color="user21" display="text" font="굴림,9" text="No"/>
						<cell align="center" col="1" color="user21" display="text" font="굴림,9" text="요청일련번호"/>
						<cell align="center" col="2" color="user21" display="text" font="굴림,9" text="항목품번"/>
						<cell align="center" col="3" color="user21" display="text" font="굴림,9" text="처리상태"/>
						<cell align="center" col="4" color="user21" display="text" font="굴림,9" text="건설사"/>
						<cell align="center" col="5" color="user21" display="text" font="굴림,9" text="시방서개정년월"/>
						<cell align="center" col="6" color="user21" display="text" font="굴림,9" text="영업담당자"/>
						<cell align="center" col="7" color="user21" display="text" font="굴림,9" text="영업요청일자"/>
						<cell align="center" col="8" color="user21" display="text" font="굴림,9" text="기술영업담당자"/>
						<cell align="center" col="9" color="user21" display="text" font="굴림,9" text="접수일자"/>
						<cell align="center" col="10" color="user21" display="text" font="굴림,9" text="완료/반송일자"/>
						<cell align="center" col="11" color="user21" display="text" font="굴림,9" text="부서"/>
						<cell align="center" col="12" color="user21" display="text" font="굴림,9" text="팀"/>
						<cell align="center" col="13" color="user21" display="text" font="굴림,9" text="파트"/>
						<cell align="center" col="14" color="user21" display="text" font="굴림,9" text="세부파트"/>
						<cell align="center" col="15" color="user21" display="text" font="굴림,9" text="검토항목"/>
						<cell align="center" col="16" color="user21" display="text" font="굴림,9" text="항목번호"/>
						<cell align="center" col="17" color="user21" display="text" font="굴림,9" text="검색어"/>
						<cell align="center" col="18" color="user21" display="text" font="굴림,9" text="시방서내용"/>
						<cell align="center" col="19" color="user21" display="text" font="굴림,9" text="현대안/이유/의견"/>
						<cell align="center" col="20" color="user21" display="text" font="굴림,9" text="WEB항목/추가금액(원)"/>
					</head>
					<body>
						<cell align="center" bkcolor2="user22" col="0" display="text" expr="currow+1"/>
						<cell align="center" bkcolor2="user22" col="1" colid="ZRQNO" display="text"/>
						<cell align="center" bkcolor2="user22" col="2" colid="ZSEQ" display="combo"/>
						<cell align="center" bkcolor2="user22" col="3" colid="DESTAT" combocol="CODE" combodataset="ds_destat_cd" combotext="CODE_NAME" display="combo"/>
						<cell align="center" bkcolor2="user22" col="4" colid="NAME1" display="combo"/>
						<cell align="center" bkcolor2="user22" col="5" colid="ZREVYM" display="text" Mask="####.##"/>
						<cell align="center" bkcolor2="user22" col="6" colid="KUNZ2_NM" display="text"/>
						<cell align="center" bkcolor2="user22" col="7" colid="ZRQDAT" display="text" Mask="####.##.##"/>
						<cell align="center" bkcolor2="user22" col="8" colid="KUNZ3_NM" display="text"/>
						<cell align="center" bkcolor2="user22" col="9" colid="ZRECDT" display="text" Mask="####.##.##"/>
						<cell align="center" bkcolor2="user22" col="10" colid="ZREFDT" display="text" Mask="####.##.##"/>
						<cell align="center" bkcolor2="user22" col="11" colid="VKBUR" combocol="CODE" combotext="CODE" display="text"/>
						<cell align="center" bkcolor2="user22" col="12" colid="VKGRP" display="text"/>
						<cell align="left" bkcolor2="user22" col="13" colid="PART_NM" display="text"/>
						<cell align="left" bkcolor2="user22" col="14" colid="DETAIL_NM" display="text"/>
						<cell align="left" bkcolor2="user22" col="15" colid="CHECK_NM" display="text"/>
						<cell align="center" bkcolor2="user22" col="16" colid="ITEM_CD" display="text"/>
						<cell align="center" bkcolor2="user22" col="17" colid="SEARCHKEY" display="text"/>
						<cell align="left" bkcolor2="user22" col="18" colid="SPEC_TEXT" display="text" multiline="true" wordwrap="word"/>
						<cell align="left" bkcolor2="user22" col="19" colid="HDEL_TEXT" display="text" multiline="true" wordwrap="word"/>
						<cell align="left" bkcolor2="user22" col="20" colid="APPEND_TEXT" display="text" multiline="true" wordwrap="word"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Static Align="Right" Height="24" Id="Static3" Left="9" Style="sty_lb_search" TabOrder="13" Text="진행상태&#32;" Top="34" VAlign="Middle" Width="85"></Static>
		<Shape BKColor="user0" Bottom="86" Height="26" Id="Shape0" Left="8" LineColor="user1" Right="970" TabOrder="14" Top="60" Type="Rectangle" Width="962"></Shape>
		<Static Align="Right" Height="24" Id="Static0" Left="9" Style="sty_lb_search" TabOrder="15" Text="요청번호&#32;" Top="59" VAlign="Middle" Width="85"></Static>
		<Static Align="Right" Height="24" Id="Static1" Left="416" Style="sty_lb_search" TabOrder="16" Text="세부파트&#32;" Top="35" VAlign="Middle" Width="85"></Static>
		<Edit BindDataset="ds_cond" Border="Flat" Column="SMAN" Enable="FALSE" Height="20" Id="ed_sman_cd" Left="777" LeftMargin="4" OnKeyDown="OnKeyDown" RightMargin="4" Style="sty_ipt_form" TabOrder="17" Top="11" UpperOnly="TRUE" Width="80"></Edit>
		<Button Enable="FALSE" Height="18" Id="btn_popSman" ImageID="btn_icon_search" Left="858" OnClick="fn_OnClick_popup" TabOrder="18" Text="Button0" Top="12" Transparent="TRUE" Width="18"></Button>
		<Edit Border="Flat" CheckLength="Byte" Enable="FALSE" Height="20" Id="ed_sman_nm" ImeMode="none" Left="877" LeftMargin="4" MaxLength="105" RightMargin="4" Style="sty_ipt_search" TabOrder="19" Top="11" Width="83"></Edit>
		<Static Align="Right" Height="24" Id="Static6" Left="216" Style="sty_lb_search" TabOrder="20" Text="검색어&#32;" Top="60" VAlign="Middle" Width="69"></Static>
		<Static Align="Right" Height="24" Id="Static7" Left="690" Style="sty_lb_search" TabOrder="21" Text="검토항목&#32;" Top="35" VAlign="Middle" Width="85"></Static>
		<Edit BindDataset="ds_cond" Border="Flat" Column="item_cd" Height="19" Id="ed_zrqno" ImeMode="english" Left="96" LeftMargin="4" MaxLength="10" OnChanged="ed_qtso_no_OnChanged" OnCharChanged="ed_qtso_no_OnCharChanged" RightMargin="4" Style="sty_ipt_form" TabOrder="22" Top="63" UpperOnly="TRUE" Width="100"></Edit>
		<Edit BindDataset="ds_cond" Border="Flat" Column="SEARCHKEY" Height="19" Id="ed_searchkey" ImeMode="english" Left="288" LeftMargin="4" MaxLength="10" OnChanged="ed_qtso_no_OnChanged" OnCharChanged="ed_qtso_no_OnCharChanged" RightMargin="4" Style="sty_ipt_form" TabOrder="23" Top="63" UpperOnly="TRUE" Width="176"></Edit>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="CODE" Column="PART_CD" DataColumn="CODE_NAME" Height="20" Id="cb_part" InnerDataset="ds_part_cd" Left="288" OnChanged="cb_part_OnChanged" Style="sty_ipt_form" TabOrder="24" Top="36" Width="120"></Combo>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="CODE" Column="DETAIL_CD" DataColumn="CODE_NAME" Height="20" Id="cb_detail" InnerDataset="ds_detail_cd" Left="504" OnChanged="cb_detail_OnChanged" Style="sty_ipt_form" TabOrder="25" Top="36" Width="184"></Combo>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="CODE" Column="CHECK_ID" DataColumn="CODE_NAME" Height="20" Id="cb_check" InnerDataset="ds_check_id" Left="776" Style="sty_ipt_form" TabOrder="26" Top="36" Width="184"></Combo>
		<Edit BindDataset="ds_cond" Border="Flat" Column="kunnr" Height="20" Id="ed_kunnr" Left="381" LeftMargin="4" OnKeyDown="OnKeyDown" RightMargin="4" Style="sty_ipt_form" TabOrder="27" Top="11" UpperOnly="TRUE" Width="80"></Edit>
		<Button Height="18" Id="btn_findKunnr" ImageID="btn_icon_search" Left="462" OnClick="btn_findKunnr_OnClick" TabOrder="28" Text="Button0" Top="12" Transparent="TRUE" Width="18"></Button>
		<Edit Border="Flat" CheckLength="Byte" Enable="FALSE" Height="20" Id="ed_kunnr_nm" ImeMode="none" Left="481" LeftMargin="4" MaxLength="105" RightMargin="4" Style="sty_ipt_search" TabOrder="29" Top="11" Width="83"></Edit>
	</Form>
	<Script><![CDATA[/*
 ******************************************************************************************
 * 기      능   : 
 * 작  성  자   : 
 * 작성  일자   : 
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
#include "LIB::commons.js";	// 공통 스크립트 
#include "LIB::nsfRequest.js";	// 공통 스크립트 
#include "LIB::common_hdel.js";	// 공통 스크립트  /* GNY 추가 */
#include "LIB::common_sd.js";
//=========================================================================================
// [ PART 1 ]
// Form에서 사용될 전역변수를 선언
// FORM에서 사용되는 전역변수는 대문자로 작성하며, F_XXX 의 형태를 갖도록 한다. 
//=========================================================================================
var F_NOW_LISTROW;	//마지막 클릭 한 리스트 번호
//=========================================================================================
// [ PART 2 ]
// Form Loading / Unloading 시 작업 정의
//=========================================================================================
function fn_OnLoadCompleted(obj) {
	// Form 로드 이벤트 맨 첫줄에 기술 
	gfn_initForm(true);

	fn_init_form(); 	// 폼 초기화
}

/********************************************************************************
* 기      능   : form UnloadCompleted 
********************************************************************************/
function fn_OnUnloadCompleted(obj) {
	return gfn_isFormUnload(obj);
}

/********************************************************************************
* 기      능   : 폼 초기화
********************************************************************************/
function fn_init_form() {
	
	cal_zrqdat_fm.Text = addDate(gfn_getCurrDate(), -365);	// 현재일자 10일전의 일자부터
	cal_zrqdat_to.Text = gfn_getCurrDate();
	
	// 영업사원은 로그인 한 사람으로 고정
	ed_sman_cd.value = "H"+G_USER_ID;
	ed_sman_nm.Value = G_USER_NAME;
	
	trace("부서코드 : " + G_DPT1);

	// 공통코드 콤보목록 조회
 	fn_query_DD07T("ZSDDDESTAT", ds_destat_cd);		// 진행상태
 	fn_query_partcd();			//파트
}

// 진행상태 코드 조회
function fn_query_DD07T(pDomainId, pDs)
{  
	// 데이타셋 초기화
	ds_cond_dd07t.ClearData();	
	pDs.ClearData();
	
	// 데이타셋 설정
	ds_cond_dd07t.AddRow();
	ds_cond_dd07t.SetColumn(ds_cond_dd07t.row, "DOMNAME"	, pDomainId);  
	ds_cond_dd07t.SetColumn(ds_cond_dd07t.row, "CONCAT_YN"	, "N");  
	
	// 서비스 호출
	nsfRequest(  ""
			   , "combo/comboDD07T"
			   , "ds_cond_dd07t=ds_cond_dd07t " + pDs.ID+"="+pDs.ID
			   , pDs.ID+"="+pDs.ID +" ds_error=ds_error"
			   , ""
			   , "fn_afterQuery_DD07T_"+pDomainId); 
}

// 진행산태 코드 조회 CALL BACK
function fn_afterQuery_DD07T_ZSDDDESTAT(errCode, errMsg) 
{  
	gfn_InsertRowCombo(ds_destat_cd, 0, "Y", "Y"); // 선택 행 추가
	cb_destat.index = 0;
}

// 파트 코드 조회
function fn_query_partcd(){
	nsfRequest(  ""
			   , "ses0510/queryPartCd"
			   , "ds_part_cd=ds_part_cd"
			   , "ds_part_cd=ds_part_cd ds_error=ds_error"
			   , ""
			   , "fn_afterQuery_partCd");
}

// 파트 조회 CALL BACK
function fn_afterQuery_partCd(errCode, errMsg) 
{  
	gfn_InsertRowCombo(ds_part_cd, 0, "Y", "Y"); // 선택 행 추가
	cb_part.index = 0;
}

// 세부파트 코드 조회
function cb_part_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	ds_detail_cd.DeleteAll();
	nsfRequest(  ""
			   , "ses0510/queryDetailCd"
			   , "ds_detail_cd=ds_detail_cd"
			   , "ds_detail_cd=ds_detail_cd ds_error=ds_error"
			   , "part_cd="+cb_part.Value
			   , "fn_afterQuery_detailCd");
}

// 세부파트 코드 조회 CALL BACK
function fn_afterQuery_detailCd(errCode, errMsg) 
{  
	gfn_InsertRowCombo(ds_detail_cd, 0, "Y", "Y"); // 선택 행 추가
	cb_detail.index = 0;
}

// 세부파트 선택 시 검토항목 코드 조회
function cb_detail_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	ds_check_id.DeleteAll();
	nsfRequest(  ""
			   , "ses0510/queryCheckCd"
			   , "ds_check_id=ds_check_id"
			   , "ds_check_id=ds_check_id ds_error=ds_error"
			   , "detail_cd="+cb_detail.Value
			   , "fn_afterQuery_checkCd");
}

// 세부파트 선택 시 검토항목 코드 조회 CALL BACK
function fn_afterQuery_checkCd(errCode, errMsg)
{  
	gfn_InsertRowCombo(ds_check_id, 0, "Y", "Y"); // 선택 행 추가
	cb_check.index = 0;
}

/********************************************************************************
* 기      능   : 조회 
********************************************************************************/
function fn_query() {
	//fn_createWait("",this);     // 처리중입니다. 메시지 처리
	ds_list.DeleteAll();
	
	//거래선 데이터 추가
	ds_cond.SetColumn(0, "kunnr", ed_kunnr.Value);
	
	
	nsfRequest("fn_query", 
				"ses0510/selectDeviationList", 
				"ds_cond=ds_cond ds_list=ds_list", 
				"ds_list=ds_list ds_error=ds_error", 
				"", 
				"");
}


/********************************************************************************
* 기      능   : 닫기  
********************************************************************************/
function fn_close() {
	close();
}

function fn_afterQuery(){
	if (svcId == "query") fn_destroyWait();
}

//'시방서 검토 요청' 버큰 클릭
function btn_accept_OnClick(obj)
{
	F_NOW_LISTROW = -1;	// 부모창에서 '시방서 검토 요청' 버튼을 클릭한 경우
	                    // 팝업창이 입력 모드로 열리도록 설정
	                    
	var url = "SES::Ses0520.xml";
	var arg = "";
	gfn_openPopUpUrlHdel(url, true, arg);
}

// 더블 클릭시 창 열기
function grd_list_OnCellDblClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
	F_NOW_LISTROW = nRow;
	var url = "SES::Ses0520.xml";
	var arg = "";
	gfn_openPopUpUrlHdel(url, true, arg);
}

function grd_list_OnCellClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
	F_NOW_LISTROW = nRow;	//클릭 된 행 값을 저장
}


//영업담당자 조회 팝업
function fn_OnClick_popup(obj)
{
	var arg = "fa_sman_cd= " 	+ quote(ed_sman_cd.text) // 담당자코드
			 + " fa_sman_nm = " + quote(ed_sman_nm.text); // 담당자명 
			 	
	var arr = gfn_openPopUpUrlHdel("Com::Com0030.xml", true, arg);	
	
	//trace("arr : " + arr);
	
	if (arr != null && arr != 0) {
		ed_sman_cd.text = arr[0];	// 리턴된 담당자코드로 검색조건 SET
		ed_sman_nm.text = arr[1];	// 리턴된 담당자명으로 검색조건 SET
		ed_sman_nm.SetFocus();
	} 
}

//거래선 조회 팝업
function btn_findKunnr_OnClick(obj)
{

	// 거래선조회 팝업화면 OPEN
	var arg = "fa_buyr_cd= " 	+ quote(ed_kunnr.text)  	 // 거래코드
			 + " fa_buyr_nm = " + quote(ed_kunnr_nm.text)   // 거래선명
			 ;
	var arr = gfn_openPopUpUrlHdel("Com::Com0040.xml", true, arg );	 
	
	if (arr != null && arr != 0)
	{
		ed_kunnr.text = arr[0];	// 리턴된 협력업체코드로 검색조건 SET
		ed_kunnr_nm.text = arr[1];	// 리턴된 협력업체명으로 검색조건 SET
	}
}

/********************************************************************************
* 기      능   : 액셀  
********************************************************************************/
function fn_excel() {
	if ( ds_list.RowCount() > 0 )
		gfn_exportExcel(grd_list, "시방서 검토 요청 접수 및 결과 등록");
	else
		gfn_showAlert("CW00010");
}

function OnKeyDown(obj,nChar,bShift,bCtrl, bAlt,LLParam,HLParam)
{	
	if (nChar != 13)	
	{ 
		// Ctrl + C or trl + V
		if (bCtrl != 1 ) 
		{	
			switch (obj) {			
				case ed_kunnr:
					ed_kunnr_nm.text = "";  break;
				case ed_sman_cd:
					ed_sman_nm.text = "";   break;					
				default : break;
			}
			
		}
	}		
}]]></Script>
</Window>