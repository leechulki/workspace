<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="562" Id="Ses0010" Left="8" OnLoadCompleted="fn_OnLoadCompleted" OnUnloadCompleted="fn_OnUnloadCompleted" PidAttrib="7" Title="사양별&#32;특성값&#32;지정" Top="8" Ver="1.0" Width="656" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_cond">
				<Contents>
					<colinfo id="MANDT" size="256" summ="default" type="STRING"/>
					<colinfo id="ZTPLGBN" size="256" summ="default" type="STRING"/>
					<colinfo id="ZTPLNO" size="256" summ="default" type="STRING"/>
					<colinfo id="ZRMK" size="256" summ="default" type="STRING"/>
					<colinfo id="ZPRDGBN" size="256" summ="default" type="STRING"/>
					<colinfo id="SPRAS" size="256" summ="default" type="STRING"/>
					<colinfo id="BRNDCD" size="256" summ="default" type="STRING"/>
					<record>
						<BRNDCD></BRNDCD>
						<MANDT></MANDT>
						<SPRAS></SPRAS>
						<ZPRDGBN></ZPRDGBN>
						<ZRMK></ZRMK>
						<ZTPLGBN></ZTPLGBN>
						<ZTPLNO></ZTPLNO>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list" OnColumnChanged="ds_list_OnColumnChanged">
				<Contents>
					<colinfo id="FLAG" size="256" type="STRING"/>
					<colinfo id="MCLASS" size="256" type="STRING"/>
					<colinfo id="ATKLA" size="256" type="STRING"/>
					<colinfo id="PRH" size="256" type="STRING"/>
					<colinfo id="PRHNAME" size="256" type="STRING"/>
					<colinfo id="PRD" size="256" type="STRING"/>
					<colinfo id="ZTPLGBN" size="256" type="STRING"/>
					<colinfo id="ZTPLNM" size="256" type="STRING"/>
					<colinfo id="ZPRDGBN" size="256" type="STRING"/>
					<colinfo id="ZTPLSEQ" size="256" type="STRING"/>
					<colinfo id="ZTPLNO" size="256" type="STRING"/>
					<colinfo id="ATFOR" size="256" type="STRING"/>
					<colinfo id="PCNCD" size="256" type="STRING"/>
					<colinfo id="BRNDCD" size="256" type="STRING"/>
					<colinfo id="BRNDSEQ" size="256" type="STRING"/>
					<colinfo id="DISPTP" size="256" type="STRING"/>
					<colinfo id="MODITP" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_error">
				<Contents>
					<colinfo id="IDX" size="256" type="STRING"/>
					<colinfo id="ERRMSG" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ztplgbn">
				<Contents>
					<colinfo id="CODE" size="1" type="STRING"/>
					<colinfo id="CODE_NAME" size="1" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_temp" OnColumnChanged="ds_temp_OnColumnChanged">
				<Contents>
					<colinfo id="MCLASS" size="256" summ="default" type="STRING"/>
					<colinfo id="ATKLA" size="256" summ="default" type="STRING"/>
					<colinfo id="PRH" size="256" summ="default" type="STRING"/>
					<colinfo id="PRHNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="PRD" size="256" summ="default" type="STRING"/>
					<colinfo id="FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="ZTPLGBN" size="256" summ="default" type="STRING"/>
					<colinfo id="ZTPLNM" size="256" summ="default" type="STRING"/>
					<colinfo id="ZPRDGBN" size="256" summ="default" type="STRING"/>
					<colinfo id="ZTPLSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="ZTPLNO" size="256" summ="default" type="STRING"/>
					<colinfo id="PRH0" size="256" summ="default" type="STRING"/>
					<colinfo id="CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="ATFOR" size="256" summ="default" type="STRING"/>
					<colinfo id="PCNCD" size="256" summ="default" type="STRING"/>
					<colinfo id="BRNDCD" size="256" summ="default" type="STRING"/>
					<colinfo id="BRNDSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="DISPTP" size="256" summ="default" type="STRING"/>
					<colinfo id="MODITP" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_save">
				<Contents>
					<colinfo id="FLAG" size="256" type="STRING"/>
					<colinfo id="MCLASS" size="256" type="STRING"/>
					<colinfo id="ATKLA" size="256" type="STRING"/>
					<colinfo id="PRH" size="256" type="STRING"/>
					<colinfo id="PRD" size="256" type="STRING"/>
					<colinfo id="ZTPLGBN" size="256" type="STRING"/>
					<colinfo id="ZTPLNM" size="256" type="STRING"/>
					<colinfo id="ZPRDGBN" size="256" type="STRING"/>
					<colinfo id="ZTPLSEQ" size="256" type="STRING"/>
					<colinfo id="ZTPLNO" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_prhcd">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_head" OnColumnChanged="ds_head_OnColumnChanged">
				<Contents>
					<colinfo id="FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="ZTPLNO" size="256" summ="default" type="STRING"/>
					<colinfo id="ZTPLGBN" size="256" summ="default" type="STRING"/>
					<colinfo id="ZTPLNM" size="256" summ="default" type="STRING"/>
					<colinfo id="ZPRDGBN" size="256" summ="default" type="STRING"/>
					<colinfo id="ZRMK" size="256" summ="default" type="STRING"/>
					<colinfo id="BRNDCD" size="256" summ="default" type="STRING"/>
					<record>
						<BRNDCD></BRNDCD>
						<FLAG></FLAG>
						<ZPRDGBN></ZPRDGBN>
						<ZRMK></ZRMK>
						<ZTPLGBN></ZTPLGBN>
						<ZTPLNM></ZTPLNM>
						<ZTPLNO></ZTPLNO>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_zprdgbn">
				<Contents>
					<colinfo id="CODE" size="1" type="STRING"/>
					<colinfo id="CODE_NAME" size="1" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list_atnam_copy">
				<Contents>
					<colinfo id="CLASS1" size="256" type="STRING"/>
					<colinfo id="ATKLA" size="256" type="STRING"/>
					<colinfo id="ATNAM" size="256" type="STRING"/>
					<colinfo id="ATBEZ" size="256" type="STRING"/>
					<colinfo id="ATINN" size="256" type="STRING"/>
					<colinfo id="ATZHL" size="256" type="STRING"/>
					<colinfo id="ATWRT" size="256" type="STRING"/>
					<colinfo id="CHECKBOX" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list_abrand">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
		</Datasets>
		<Div Height="36" Id="div_btn" TabOrder="9" Text="Div0" Url="WB01::CommBtnForm.xml" Width="656">
			<Contents></Contents>
		</Div>
		<Shape BKColor="user0" Bottom="96" Height="56" Id="Shape1" Left="0" LineColor="user1" Right="648" TabOrder="8" Top="40" Type="Rectangle" Width="648"></Shape>
		<Edit BindDataset="ds_head" Border="Flat" Column="ZTPLNM" Height="20" Id="ed_TempName" ImeMode="english" Left="90" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="1" Top="72" UpperOnly="TRUE" Width="136"></Edit>
		<Static Align="Right" Height="20" Id="Static0" Left="5" Style="sty_lb_search" TabOrder="3" Text="제품구분&#32;" Top="45" VAlign="Middle" Width="80"></Static>
		<Combo Border="Flat" CodeColumn="CODE" DataColumn="CODE_NAME" Enable="FALSE" Height="20" Id="cb_zprdgbn" InnerDataset="ds_zprdgbn" Left="90" Style="sty_ipt_form" TabOrder="4" Top="45" Width="136"></Combo>
		<Tab Border="Flat" FixedImage="FALSE" Font="굴림,9" Height="408" Id="tab" Left="8" MouseOverColor="user16" OnChanging="Tab_OnChanging" SelColor="user15" SelectFont="굴림,9" Style="sty_tab" TabOrder="5" Top="104" Width="640">
			<Contents>
				<TabPage BorderColor="black" Height="383" Id="EL_BASIC" ImageEdgeWidth="2" ImageID="tab_main" Left="2" TabOrder="19" Text="1.기본" Top="23" Width="636"></TabPage>
				<TabPage BorderColor="black" Height="383" Id="EL_INSIDE" ImageEdgeWidth="2" ImageID="tab_main" Left="2" TabOrder="26" Text="2.카내의장" Top="23" Width="636">
					<Grid AreaSelect="TRUE" AutoEnter="TRUE" AutoFitEndLine="Hide" BindDataset="ds_list" BkColor2="default" BoldHead="true" Border="Flat" Bottom="385" ColSelect="TRUE" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="25" Height="384" Id="grd_list" InputPanel="FALSE" Left="6" LineColor="user20" LineType="ExHORZ" OnHeadClick="grd_list_OnHeadClick" Right="456" RowHeight="20" Style="sty_grid" TabOrder="1" TabStop="true" Top="1" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="450">
						<contents>
							<format id="Default">
								<columns>
									<col width="20"/>
									<col width="30"/>
									<col width="222"/>
									<col width="159"/>
								</columns>
								<head>
									<cell col="0" display="text"/>
									<cell align="center" bkimageid="icon_grid_sel" col="1" color="user21" display="text" font="굴림,9"/>
									<cell align="center" col="2" color="user21" display="text" domainid="bs.charac" font="굴림,9" text="특성내역" wordwrap="word"/>
									<cell col="3" display="text" domainid="bs.value1" font="굴림,9" text="특성값" wordwrap="word"/>
								</head>
								<body>
									<cell bkimageid='expr:gfn_getFlagBkImageID(getColumn(currow,&#32;&quot;FLAG&quot;))' col="0" display="text"/>
									<cell align="center" bkcolor2="user22" col="1" display="text" expr="currow+1"/>
									<cell bkcolor2="user22" col="2" colid="PRH" combocol="CODE" combodataset="ds_prhcd" combotext="CODE_NAME" display="combo" suppress="1"/>
									<cell align="left" checklength="Byte" col="3" colid="PRD" edit="expr:decode(ATFOR,&apos;NUM&apos;,&apos;number&apos;,&apos;normal&apos;)" limit="30"/>
								</body>
							</format>
						</contents>
					</Grid>
				</TabPage>
				<TabPage BorderColor="black" Height="383" Id="EL_OUTSIDE" ImageEdgeWidth="2" ImageID="tab_main" Left="2" TabOrder="31" Text="3.카외의장" Top="23" Width="636">
					<Grid AreaSelect="TRUE" AutoEnter="TRUE" AutoFitEndLine="Hide" BindDataset="ds_list" BkColor2="default" BoldHead="true" Border="Flat" Bottom="407" ColSelect="TRUE" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="25" Height="406" Id="Grid0" InputPanel="FALSE" Left="1" LineColor="user20" LineType="ExHORZ" OnHeadClick="grd_list_OnHeadClick" Right="451" RowHeight="20" Style="sty_grid" TabOrder="1" TabStop="true" Top="1" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="450">
						<contents>
							<format id="Default">
								<columns>
									<col width="20"/>
									<col width="30"/>
									<col width="222"/>
									<col width="159"/>
								</columns>
								<head>
									<cell col="0" display="text"/>
									<cell align="center" bkimageid="icon_grid_sel" col="1" color="user21" display="text" font="굴림,9"/>
									<cell align="center" col="2" color="user21" display="text" domainid="bs.charac" font="굴림,9" text="특성내역" wordwrap="word"/>
									<cell col="3" display="text" domainid="bs.value1" font="굴림,9" text="특성값" wordwrap="word"/>
								</head>
								<body>
									<cell bkimageid='expr:gfn_getFlagBkImageID(getColumn(currow,&#32;&quot;FLAG&quot;))' col="0" display="text"/>
									<cell align="center" bkcolor2="user22" col="1" display="text" expr="currow+1"/>
									<cell bkcolor2="user22" col="2" colid="PRH" combocol="CODE" combodataset="ds_prhcd" combotext="CODE_NAME" display="combo" suppress="1"/>
									<cell align="left" checklength="Byte" col="3" colid="PRD" edit="expr:decode(ATFOR,&apos;NUM&apos;,&apos;number&apos;,&apos;normal&apos;)" limit="30"/>
								</body>
							</format>
						</contents>
					</Grid>
				</TabPage>
				<TabPage BorderColor="black" Height="383" Id="EL_OPTION" ImageEdgeWidth="2" ImageID="tab_main" Left="2" TabOrder="32" Text="4.OPTION" Top="23" Width="636">
					<Grid AreaSelect="TRUE" AutoEnter="TRUE" AutoFitEndLine="Hide" BindDataset="ds_list" BkColor2="default" BoldHead="true" Border="Flat" Bottom="407" ColSelect="TRUE" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="25" Height="406" Id="Grid0" InputPanel="FALSE" Left="1" LineColor="user20" LineType="ExHORZ" OnHeadClick="grd_list_OnHeadClick" Right="451" RowHeight="20" Style="sty_grid" TabOrder="1" TabStop="true" Top="1" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="450">
						<contents>
							<format id="Default">
								<columns>
									<col width="20"/>
									<col width="30"/>
									<col width="222"/>
									<col width="159"/>
								</columns>
								<head>
									<cell col="0" display="text"/>
									<cell align="center" bkimageid="icon_grid_sel" col="1" color="user21" display="text" font="굴림,9"/>
									<cell align="center" col="2" color="user21" display="text" domainid="bs.charac" font="굴림,9" text="특성내역" wordwrap="word"/>
									<cell col="3" display="text" domainid="bs.value1" font="굴림,9" text="특성값" wordwrap="word"/>
								</head>
								<body>
									<cell bkimageid='expr:gfn_getFlagBkImageID(getColumn(currow,&#32;&quot;FLAG&quot;))' col="0" display="text"/>
									<cell align="center" bkcolor2="user22" col="1" display="text" expr="currow+1"/>
									<cell bkcolor2="user22" col="2" colid="PRH" combocol="CODE" combodataset="ds_prhcd" combotext="CODE_NAME" display="combo" suppress="1"/>
									<cell align="left" checklength="Byte" col="3" colid="PRD" edit="expr:decode(ATFOR,&apos;NUM&apos;,&apos;number&apos;,&apos;normal&apos;)" limit="30"/>
								</body>
							</format>
						</contents>
					</Grid>
				</TabPage>
				<TabPage BorderColor="black" Height="383" Id="EL_LAYOUT" ImageEdgeWidth="2" ImageID="tab_main" Left="2" TabOrder="32" Text="5.LAYOUT" Top="23" Width="636">
					<Grid AreaSelect="TRUE" AutoEnter="TRUE" AutoFitEndLine="Hide" BindDataset="ds_list" BkColor2="default" BoldHead="true" Border="Flat" Bottom="407" ColSelect="TRUE" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="25" Height="406" Id="Grid0" InputPanel="FALSE" Left="1" LineColor="user20" LineType="ExHORZ" OnHeadClick="grd_list_OnHeadClick" Right="451" RowHeight="20" Style="sty_grid" TabOrder="1" TabStop="true" Top="1" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="450">
						<contents>
							<format id="Default">
								<columns>
									<col width="20"/>
									<col width="30"/>
									<col width="222"/>
									<col width="159"/>
								</columns>
								<head>
									<cell col="0" display="text"/>
									<cell align="center" bkimageid="icon_grid_sel" col="1" color="user21" display="text" font="굴림,9"/>
									<cell align="center" col="2" color="user21" display="text" domainid="bs.charac" font="굴림,9" text="특성내역" wordwrap="word"/>
									<cell col="3" display="text" domainid="bs.value1" font="굴림,9" text="특성값" wordwrap="word"/>
								</head>
								<body>
									<cell bkimageid='expr:gfn_getFlagBkImageID(getColumn(currow,&#32;&quot;FLAG&quot;))' col="0" display="text"/>
									<cell align="center" bkcolor2="user22" col="1" display="text" expr="currow+1"/>
									<cell bkcolor2="user22" col="2" colid="PRH" combocol="CODE" combodataset="ds_prhcd" combotext="CODE_NAME" display="combo" suppress="1"/>
									<cell align="left" checklength="Byte" col="3" colid="PRD" edit="expr:decode(ATFOR,&apos;NUM&apos;,&apos;number&apos;,&apos;normal&apos;)" limit="30"/>
								</body>
							</format>
						</contents>
					</Grid>
				</TabPage>
				<TabPage BorderColor="black" Height="383" Id="EL_OTHERS" ImageEdgeWidth="2" ImageID="tab_main" Left="2" TabOrder="32" Text="6.OTHER" Top="23" Width="636">
					<Grid AreaSelect="TRUE" AutoEnter="TRUE" AutoFitEndLine="Hide" BindDataset="ds_list" BkColor2="default" BoldHead="true" Border="Flat" Bottom="407" ColSelect="TRUE" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="25" Height="406" Id="Grid0" InputPanel="FALSE" Left="1" LineColor="user20" LineType="ExHORZ" OnHeadClick="grd_list_OnHeadClick" Right="451" RowHeight="20" Style="sty_grid" TabOrder="1" TabStop="true" Top="1" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="450">
						<contents>
							<format id="Default">
								<columns>
									<col width="20"/>
									<col width="30"/>
									<col width="222"/>
									<col width="159"/>
								</columns>
								<head>
									<cell col="0" display="text"/>
									<cell align="center" bkimageid="icon_grid_sel" col="1" color="user21" display="text" font="굴림,9"/>
									<cell align="center" col="2" color="user21" display="text" domainid="bs.charac" font="굴림,9" text="특성내역" wordwrap="word"/>
									<cell col="3" display="text" domainid="bs.value1" font="굴림,9" text="특성값" wordwrap="word"/>
								</head>
								<body>
									<cell bkimageid='expr:gfn_getFlagBkImageID(getColumn(currow,&#32;&quot;FLAG&quot;))' col="0" display="text"/>
									<cell align="center" bkcolor2="user22" col="1" display="text" expr="currow+1"/>
									<cell bkcolor2="user22" col="2" colid="PRH" combocol="CODE" combodataset="ds_prhcd" combotext="CODE_NAME" display="combo" suppress="1"/>
									<cell align="left" checklength="Byte" col="3" colid="PRD" edit="expr:decode(ATFOR,&apos;NUM&apos;,&apos;number&apos;,&apos;normal&apos;)" limit="30"/>
								</body>
							</format>
						</contents>
					</Grid>
				</TabPage>
			</Contents>
		</Tab>
		<Button Appearance="FLAT" ButtonStyle="TRUE" Color="user5" Cursor="HAND" DomainID="btn.confirm" Height="22" Id="btn_close2" ImageID="btn_comm_confirm_k" Left="273" LeftMargin="20" OnClick="btn_close2_OnClick" TabOrder="6" Text="확인" Top="524" Width="52"></Button>
		<Button Appearance="FLAT" ButtonStyle="TRUE" Color="user5" Cursor="HAND" DomainID="btn.cancel" Height="22" Id="btn_cancel" ImageID="btn_comm_cancel_k" Left="329" LeftMargin="20" OnClick="fn_close" TabOrder="7" Text="취소" Top="524" Width="52"></Button>
		<Static Align="Right" Height="20" Id="st_TempName" Left="5" Style="sty_lb_search" TabOrder="10" Text="템플릿명&#32;" Top="72" VAlign="Middle" Width="79"></Static>
		<Edit BindDataset="ds_head" Border="Flat" Column="ZRMK" Height="20" Id="ed_Zrmk" ImeMode="english" Left="320" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="2" Top="72" UpperOnly="TRUE" Width="136"></Edit>
		<Combo Border="Flat" CodeColumn="CODE" DataColumn="CODE_NAME" Enable="FALSE" Height="20" Id="cb_ztplgbn" InnerDataset="ds_ztplgbn" Left="320" Style="sty_ipt_form" TabOrder="11" Top="45" Width="136"></Combo>
		<Static Align="Right" Height="20" Id="Static2" Left="234" Style="sty_lb_search" TabOrder="13" Text="비고&#32;" Top="72" VAlign="Middle" Width="80"></Static>
		<Static Align="Right" Height="20" Id="Static1" Left="234" Style="sty_lb_search" TabOrder="12" Text="템플릿구분&#32;" Top="45" VAlign="Middle" Width="80"></Static>
		<Grid AreaSelect="TRUE" AutoEnter="TRUE" AutoFitEndLine="Hide" BindDataset="ds_list" BkColor2="default" BoldHead="true" Border="Flat" Bottom="504" ColSelect="TRUE" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="25" Height="376" Id="grd_list" InputPanel="FALSE" Left="10" LineColor="user20" LineType="ExHORZ" OnCellDBLClick="grd_list_OnCellDblClick" OnCellPosChanged="grd_list_OnCellPosChanged" OnHeadClick="grd_list_OnHeadClick" Right="624" RowHeight="20" Style="sty_grid" TabOrder="14" TabStop="true" Top="128" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="614">
			<contents>
				<format id="Default">
					<columns>
						<col width="40"/>
						<col width="0"/>
						<col width="304"/>
						<col width="252"/>
						<col width="0"/>
					</columns>
					<head>
						<cell col="0" display="text"/>
						<cell align="center" bkimageid="icon_grid_sel" col="1" color="user21" display="text" font="굴림,9"/>
						<cell align="center" col="2" color="user21" display="text" domainid="bs.charac" font="굴림,9" text="특성내역" wordwrap="word"/>
						<cell col="3" display="text" domainid="bs.value1" font="굴림,9" text="특성값" wordwrap="word"/>
						<cell col="4" display="text" text="CNT"/>
					</head>
					<body>
						<cell bkimageid='expr:gfn_getFlagBkImageID(getColumn(currow,&#32;&quot;FLAG&quot;))' col="0" display="text"/>
						<cell align="center" bkcolor2="user22" col="1" display="text" expr="currow+1"/>
						<cell bkcolor2="user22" col="2" colid="PRHNAME" display="combo"/>
						<cell align="left" checklength="Byte" col="3" colid="PRD" display="text" edit="expr:decode(ATFOR,&apos;NUM&apos;,&apos;number&apos;,&apos;normal&apos;)" limit="30"/>
						<cell col="4" colid="CNT" display="text"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Combo Border="Flat" CodeColumn="CODE" DataColumn="CODE_NAME" Enable="FALSE" Height="20" Id="cb_abrand" INDEX="0" InnerDataset="ds_list_abrand" Left="544" Style="sty_ipt_form" TabOrder="15" Top="45" Width="96"></Combo>
		<Static Align="Right" Height="20" Id="Static3" Left="460" Style="sty_lb_search" TabOrder="16" Text="브랜드" Top="46" VAlign="Middle" Width="80"></Static>
		<Button Appearance="FLAT" ButtonStyle="TRUE" Color="user5" Cursor="HAND" DomainID="btn.query" Height="22" Id="btn_query" ImageID="btn_comm_query_k" Left="485" LeftMargin="20" OnClick="fn_OnClick_btn" TabOrder="17" Text="조회" Top="6" Width="52"></Button>
		<Button Appearance="FLAT" ButtonStyle="TRUE" Color="user5" Cursor="HAND" DomainID="btn.save" Height="22" Id="btn_save" ImageID="btn_comm_save_k" Left="541" LeftMargin="20" OnClick="fn_OnClick_btn" TabOrder="18" Text="저장" Top="6" Width="52"></Button>
	</Form>
	<Script><![CDATA[/*
 ******************************************************************************************
 * 기      능   : 
 * 작  성  자   : 
 * 작성  일자   : 
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */   
#include "LIB::commons.js";	// 공통 스크립트 
#include "LIB::nsfRequest.js";	// 공통 스크립트 
#include "LIB::common_hdel.js";	// 공통 스크립트  /* GNY 추가 */
//=========================================================================================
// [ PART 1 ]
// Form에서 사용될 전역변수를 선언
// FORM에서 사용되는 전역변수는 대문자로 작성하며, F_XXX 의 형태를 갖도록 한다. 
//=========================================================================================

var pGubun;

//=========================================================================================
// [ PART 2 ]
// Form Loading / Unloading 시 작업 정의
//=========================================================================================
function fn_OnLoadCompleted(obj) {
	gfn_initForm(false); 	// Form 로드 이벤트 맨 첫줄에 기술 
	
	gfn_translation(obj, G_LANG);	//언어
	
	fn_init_form(); 	// 폼 초기화
	div_btn.fn_loadUseBtn("", "사양별 특성값 지정", "", "");   	// 화면제목 설정 및 버튼 활성화
}

/********************************************************************************
* 기      능   : form UnloadCompleted 
********************************************************************************/
function fn_OnUnloadCompleted(obj) {
	return gfn_isFormUnload(obj);
}

//=========================================================================================
// [ PART 3 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,form닫기)
//=========================================================================================
/********************************************************************************
* 기      능   : 조회 1
********************************************************************************/
function fn_query() {

//	trace("pGubun " +  pGubun + "cb_zprdgbn.Value : " + cb_zprdgbn.Value);
	ds_temp.ClearData();		 
	ds_list.ClearData();	
    
	if (pGubun == "U") {
		fn_createWait("",this);     // 처리중입니다. 메시지 처리
		ds_cond.setColumn(0, "MANDT"  , G_MANDT);
		ds_cond.setColumn(0, "ZPRDGBN", pZprdgbn);
		ds_cond.setColumn(0, "SPRAS", G_LANG);
		// 2020 브랜드
		ds_cond.setColumn(0, "BRNDCD", pBrndcd);
		nsfRequest("query", "ses0020/findTemp", "ds_cond=ds_cond ds_temp=ds_temp", "ds_temp=ds_temp ds_error=ds_error", "", "fn_afterQueryTemp");
	} else if(pGubun == "S") {
		fn_createWait("",this);     // 처리중입니다. 메시지 처리
		ds_cond.setColumn(0, "MANDT" , G_MANDT);
        ds_cond.setColumn(0, "ZTPLNO", pZtplno);
        ds_cond.setColumn(0, "ZTPLGBN", cb_ztplgbn.Value);
        ds_cond.setColumn(0, "ZPRDGBN", pZprdgbn);
        ds_cond.setColumn(0, "ZRMK", ed_Zrmk.Text);
        ds_cond.setColumn(0, "SPRAS", G_LANG);
		// 2020 브랜드
		ds_cond.setColumn(0, "BRNDCD", pBrndcd);
		nsfRequest("query", "ses0020/find", "ds_cond=ds_cond ds_temp=ds_temp", "ds_temp=ds_temp ds_error=ds_error", "", "fn_afterQuery");
	}	
}

/********************************************************************************
* 기      능   : 폼 초기화
********************************************************************************/
function fn_init_form() {

	pGubun = pGubun;

	// 최종 변경된 셀정보 초기화
	F_CHG_COLNUM = "";	             // 변경된 컬럼번호
	F_CHG_ROWNUM = "";	             // 변경된 행번호
	F_MAX_SERNO  = 0;	             // 최종순번

	var codeArr = ["SD100"];
	var dsObjArr = [ds_ztplgbn];
	var addTypeArr = [G_CODE_ALL,G_CODE_ALL,G_CODE_ALL];
	var oderTypeArr = ["DTEXT1"];
	gfn_searchCommCode2(codeArr, dsObjArr, addTypeArr, oderTypeArr);

	//	ds_ztplgbn.DeleteAll();
	nsfRequest("query", "combo/comboClass", "ds_zprdgbn=ds_zprdgbn", "ds_zprdgbn=ds_zprdgbn", "fn_query_class");// combo값 가져오기 query
	
	// 2020 브랜드 콤보 조회
	fn_query_abrand();

	if(pGubun == "U") {
		ed_TempName.Enable = true;
	} else if(pGubun == "S") {
		ed_TempName.Enable = true;
		ed_TempName.Value = pZtplnm;		
	}

	// 2020 브랜드
	// 엘리베이터 건만 브랜드 콤보를 화면에 표시한다.
	if(pZprdgbn == 'ELV_01') {
		Static3.Visible = true;
		cb_abrand.Visible = true;
	} else {
		Static3.Visible = false;
		cb_abrand.Visible = false;
	}
} 

/********************************************************************************
* 기      능   : 닫기  
********************************************************************************/
function fn_close() {
	this.close();
}

/********************************************************************************
* 기      능   : 액셀  
********************************************************************************/
function fn_excel() {
}

//=========================================================================================
// [ PART 4]
// Callback 함수 정의 : callback 함수명은 메인 함수의 fn_xxxx() 에서 xxxx 부분은 fn_afterXXXX()
// 형태가 되도록 작성 
//=========================================================================================
/********************************************************************************
* 기      능   : 조회 Callback  
********************************************************************************/

function fn_afterQueryTemp(errCode, errMsg) {

	for (var i=tab.TabCount-1; i>=0;i--) {
		tab.DeleteTab(i);
	}
	var zprdgbn = cb_zprdgbn.value;
	
	if(zprdgbn == "ELV_01" || zprdgbn == "ELV_02") {

		tab.InsertTab("EL_BASIC"  , 0, "", "기본의장", "tab_main");
		tab.InsertTab("EL_INSIDE" , 1, "", "카내의장", "tab_main");
		tab.InsertTab("EL_OUTSIDE", 2, "", "카외의장", "tab_main");
		tab.InsertTab("EL_OPTION" , 3, "", "OPTION"  , "tab_main");
		tab.InsertTab("EL_LAYOUT" , 4, "", "LAYOUT"  , "tab_main");
		// 2020 브랜드
		tab.InsertTab("EL_OTHERS" , 5, "", "OTHER"  , "tab_main");
		ds_temp.filter("MCLASS == " + quote(zprdgbn) + " && ATKLA == 'EL_BASIC'");

	} else if(zprdgbn == "ESC_01" || zprdgbn == "MW_01") {

		tab.InsertTab("ES_BASIC"  , 0, "", "BASIC"   , "tab_main");
		tab.InsertTab("ES_OPTION" , 1, "", "OPTION"  , "tab_main");
		tab.InsertTab("ES_SAFETY" , 2, "", "SAFETY"  , "tab_main");
		tab.InsertTab("ES_EXTER"  , 3, "", "EXTERIOR", "tab_main");

		if   (zprdgbn == "ESC_01") ds_temp.filter("MCLASS == 'ESC_01' && ATKLA == 'ES_BASIC'");
		else 			           ds_temp.filter("MCLASS == 'MW_01'  && ATKLA == 'MW_BASIC'");
		
	} else if(zprdgbn == "AP_01") {
		tab.InsertTab("AP_BASIC", 0, "", "BASIC", "tab_main");
		ds_temp.filter("MCLASS == 'AP_01'");
		
	} else if(zprdgbn == "PSD_01") {

		tab.InsertTab("PSD_BASIC", 0, "", "BASIC", "tab_main");
		tab.InsertTab("PSD_SASH" , 1, "", "SASH" , "tab_main");
		tab.InsertTab("PSD_STEEL", 2, "", "STEEL", "tab_main");
		tab.InsertTab("PSD_ELEC" , 3, "", "ELEC" , "tab_main");
		ds_temp.filter("MCLASS == 'PSD_01' && ATKLA == 'PSD_BASIC'");

	} else if(zprdgbn == "SHN_01") {
		tab.InsertTab("ES_BASIC"  , 0, "", "BASIC"   , "tab_main");
		tab.InsertTab("ES_OPTION" , 1, "", "OPTION"  , "tab_main");
		tab.InsertTab("ES_SAFETY" , 2, "", "SAFETY"  , "tab_main");
		tab.InsertTab("ES_EXTER"  , 3, "", "EXTERIOR", "tab_main");
		ds_temp.filter("MCLASS == 'SHN_01' && ATKLA == 'ES_BASIC'");		

	} else if(zprdgbn == "FAG_01") {
		tab.InsertTab("FA_BASIC"  , 0, "", "BASIC"   , "tab_main");
		tab.InsertTab("FA_OPTION" , 1, "", "OPTION"  , "tab_main");
		ds_temp.filter("MCLASS == 'FAG_01' && ATKLA == 'FA_BASIC'");
	}

	ds_list.CopyF(ds_temp);
	ds_temp.UnFilter();

	fn_destroyWait();

	if(ds_error.rowcount() > 0) {
		gfn_showMsg("CE00001");
		gfn_openWSErrorWin(grd_list, ds_list, ds_error, "FLAG");		// error 정보 표시 
	} else {
	   
		//if (errCode != 0) gfn_showMsg("CE00001");	불필요한 에러 메시지로 제거
		//else 			  
		gfn_showMsg("CI00002", ds_list.RowCount() + "");
	}
} 

//=========================================================================================
// [ PART 4]
// Callback 함수 정의 : callback 함수명은 메인 함수의 fn_xxxx() 에서 xxxx 부분은 fn_afterXXXX()
// 형태가 되도록 작성 
//=========================================================================================
/********************************************************************************
* 기      능   : 조회 Callback  
********************************************************************************/
function fn_afterQuery(errCode, errMsg) {

	for (var i=tab.TabCount-1; i>=0;i--) {
		tab.DeleteTab(i);
	}
	var zprdgbn = cb_zprdgbn.value;

	if(zprdgbn == "ELV_01" || zprdgbn == "ELV_02") {

		tab.InsertTab("EL_BASIC"  , 0, "", "기본의장", "tab_main");
		tab.InsertTab("EL_INSIDE" , 1, "", "카내의장", "tab_main");
		tab.InsertTab("EL_OUTSIDE", 2, "", "카외의장", "tab_main");
		tab.InsertTab("EL_OPTION" , 3, "", "OPTION"  , "tab_main");
		tab.InsertTab("EL_LAYOUT" , 4, "", "LAYOUT"  , "tab_main");
		tab.InsertTab("EL_OTHERS" , 5, "", "OTHER"  , "tab_main");
		
		if      (pZprdgbn == "EL_BASIC"  ) tab.TabIndex = 0;
		else if (pZprdgbn == "EL_INSIDE" ) tab.TabIndex = 1;
		else if (pZprdgbn == "EL_OUTSIDE") tab.TabIndex = 2;
		else if (pZprdgbn == "EL_OPTION" ) tab.TabIndex = 3;
		else if (pZprdgbn == "EL_LAYOUT" ) tab.TabIndex = 4;
		else if (pZprdgbn == "EL_OTHERS" ) tab.TabIndex = 5;
	
	} else if(zprdgbn == "ESC_01" || zprdgbn == "MW_01") {
		tab.InsertTab("ES_BASIC"  , 0, "", "BASIC"   , "tab_main");
		tab.InsertTab("ES_OPTION" , 1, "", "OPTION"  , "tab_main");
		tab.InsertTab("ES_SAFETY" , 2, "", "SAFETY"  , "tab_main");
		tab.InsertTab("ES_EXTER"  , 3, "", "EXTERIOR", "tab_main");
		
		if      (pZprdgbn == "ES_BASIC" ) tab.TabIndex = 0;
		else if (pZprdgbn == "ES_OPTION") tab.TabIndex = 1;
		else if (pZprdgbn == "ES_SAFETY") tab.TabIndex = 2;
		else if (pZprdgbn == "ES_EXTER" ) tab.TabIndex = 3;
			
	} else if(zprdgbn == "AP_01") {
		tab.InsertTab("AP_BASIC", 0, "", "BASIC", "tab_main");

		if (pZprdgbn == "AP_BASIC" ) tab.TabIndex = 0;

	} else if(zprdgbn == "PSD_01") {
		tab.InsertTab("PSD_BASIC", 0, "", "BASIC", "tab_main");
		tab.InsertTab("PSD_SASH" , 1, "", "SASH" , "tab_main");
		tab.InsertTab("PSD_STEEL", 2, "", "STEEL", "tab_main");
		tab.InsertTab("PSD_ELEC" , 3, "", "ELEC" , "tab_main");
		
		if      (pZprdgbn == "PSD_BASIC") tab.TabIndex = 0;
		else if (pZprdgbn == "PSD_SASH" ) tab.TabIndex = 1;
		else if (pZprdgbn == "PSD_STEEL") tab.TabIndex = 2;
		else if (pZprdgbn == "PSD_ELEC" ) tab.TabIndex = 3;
		
	} else if(zprdgbn == "FAG_01") {
		tab.InsertTab("FA_BASIC"  , 0, "", "BASIC"   , "tab_main");
		tab.InsertTab("FA_OPTION" , 1, "", "OPTION"  , "tab_main");
		
		if      (pZprdgbn == "FA_BASIC" ) tab.TabIndex = 0;
		else if (pZprdgbn == "FA_OPTION") tab.TabIndex = 1;
	
	} else if(zprdgbn == "SHN_01") {
		tab.InsertTab("ES_BASIC"  , 0, "", "BASIC"   , "tab_main");
		tab.InsertTab("ES_OPTION" , 1, "", "OPTION"  , "tab_main");
		tab.InsertTab("ES_SAFETY" , 2, "", "SAFETY"  , "tab_main");
		tab.InsertTab("ES_EXTER"  , 3, "", "EXTERIOR", "tab_main");
		
		if      (pZprdgbn == "ES_BASIC" ) tab.TabIndex = 0;
		else if (pZprdgbn == "ES_OPTION") tab.TabIndex = 1;
		else if (pZprdgbn == "ES_SAFETY") tab.TabIndex = 2;
		else if (pZprdgbn == "ES_EXTER" ) tab.TabIndex = 3;
	}
//	ds_list.Copy(ds_temp);
	fn_destroyWait();
} 

/********************************************************************************
* 기      능   : 공통코드가 조회된 후의 Callback 함수 
********************************************************************************/
function fn_completeInit(sCode, sDsObj, sCodeType) {
    cb_ztplgbn.index = 0;
    
    if (pGubun == "U") {
		cb_zprdgbn.Value = pZprdgbn;
		cb_ztplgbn.value = Parent.cb_ztplgbn.value;	//cb_ztplgbn.Value = pZtplgbn;
		// 20020 브랜드
		cb_abrand.value  = Parent.cb_abrand.value;
	} else {
		cb_zprdgbn.Value = pZprdgbn;
		cb_ztplgbn.Value = pZtplgbn;
		// 20020 브랜드
		cb_abrand.Value  = pBrndcd;
		ed_Zrmk.value    = pZrmk;		// pGubun이 S의 경우에만 처리되고 있음
	}

	fn_query();
}

//=========================================================================================
// [ PART 6 ]
// component Event 정의 : 각 Component 별 이벤트 
//=========================================================================================
/********************************************************************************
* 기      능   : 정렬 처리 
********************************************************************************/
function grd_list_OnHeadClick(obj,nCell,nX,nY,nPivotIndex) {

	if( nCell == 0 ) gfn_selectAllGrid(obj,nCell,nCell,true);
	else             gfn_sortGrid(obj, nCell);
}

/********************************************************************************
* 기      능   : 조회
********************************************************************************/
function fn_OnClick_btn(obj) {
	var fncName = "fn_" + substr(obj.id, 4); 
	eval( fncName + "()");
}

//=========================================================================================
// [ PART 3 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,form닫기)
//=========================================================================================
/********************************************************************************
* 기      능   : 저장 1
********************************************************************************/
function fn_save() {

	gfn_clearGridSortMark(grd_list);
	
	if (pGubun == "U") {
		if(ed_TempName.Text =="" || ed_TempName.Text = null){
			gfn_showAlert("CW10203");	//템플릿명을 입력해주십시오
			ed_TempName.SetFocus(); return;
		}	
	}
		
	if(!gfn_showConfirm("CI00008")) return; //저장 하시겠습니까?

	if (pGubun == null) {
		gfn_showAlert("CW10204");	//저장할 자료가 없습니다.
	} else {
		var zprdgbn = cb_zprdgbn.Value;
		var ztplgbn = cb_ztplgbn.Value;
			
		ds_head.setColumn(0, "ZPRDGBN", zprdgbn);
		ds_head.setColumn(0, "ZTPLGBN", ztplgbn);
		ds_head.setColumn(0, "ZTPLNM",  ed_TempName.Text);
		
		// 2020 브랜드
		ds_head.setColumn(0, "BRNDCD", pBrndcd);

		if (pGubun == "S") {
	
			for( var i=0; i < ds_temp.rowcount; i++) {

				if(ds_temp.getColumn(i, "FLAG") == "U") {
					var nRow = ds_save.addRow();
					ds_save.copyRow(nRow, ds_temp, i);
					ds_save.setColumn(nRow, "ZTPLGBN", cb_ztplgbn.value);
					ds_save.setColumn(nRow, "ZTPLNM" , ed_TempName.Text);
					ds_save.setColumn(nRow, "ZPRDGBN", ds_temp.getColumn(i, "ATKLA"));
					ds_save.setColumn(nRow, "ZTPLNO" , pZtplno);
				}
			}
			ds_head.setColumn(0, "ZTPLNO" , pZtplno);  // 이름 추가
			
		} else if (pGubun == "U") { // 신규 저장
			ds_save.Copy(ds_temp); // trace(ds_temp.SaveXML());
		}
	
		var arg = "pGubun = " + quote(pGubun);
		nsfRequest("save", "ses0020/save", "ds_save=ds_save ds_head=ds_head", "ds_save=ds_save ds_error=ds_error", arg, "fn_afterSave");
		fn_createWait("",this);     // 처리중입니다. 메시지 처리
		//if (pGubun == "U") fn_close();// 신규 저장
	}
}

/********************************************************************************
* 기      능   : 저장 Callback
********************************************************************************/
function fn_afterSave(errCode, errMsg) {

	fn_destroyWait();

	if (ds_error.rowcount > 0) {
	    gfn_showAlert(ds_error.GetColumn(0,"ERRMSG"));
	} else {
	    gfn_showAlert("CI00003");		// 저장을 완료했습니다.
		switch (pGubun) {
			case "S" : 
				parent.fn_query(); 
				fn_query(); 
				break;
			case "U" : 
				parent.fn_query(); 
				fn_close(); 
				break;
		}
	}
}

var sAtkla = "";
var sCopyAtkla = 0; 

function Tab_OnChanging(obj,nOldIndex,nNewIndex) {

	var ztplgbn = cb_zprdgbn.value;

	var sObjID = substr(obj.id, 3);
    sAtkla = obj.GetItem(obj.Tabindex).id;
    sCopyAtkla  = obj.GetItem(nOldIndex).id; // 템플릿 찾기 용도 카피 용 
    
    if (ztplgbn == "ELV_02") {
        sObjID = "ELV_02";
    
    } else if(ztplgbn == "MW_01") {
        sObjID = "MW_01";
        sAtkla = "MW" + substr(sAtkla, 2);
    }
    
    if (pGubun == "S") { 
    
		for(var i=0; i < ds_list.rowcount; i++ ) { 
			if(ds_list.getColumn(i, "FLAG") == "U") {
			
				var sPrh = ds_list.getColumn(i, "PRH"); 
				var nSearchRow =  ds_temp.searchRow("ATKLA ==" + quote(sCopyAtkla) + " && PRH ==" + quote(sPrh) );
				//var nSearchRow =  ds_temp.searchRow("MCLASS ==" + quote(sObjID) + " && ATKLA ==" + quote(sCopyAtkla) + " && PRH ==" + quote(sPrh) );
				ds_temp.CopyRow(nSearchRow, ds_list, i);
			}		
		}     
    }

	ds_temp.filter("ATKLA ==" + quote(sAtkla));	//ds_temp.filter("MCLASS == "+quote(ztplgbn)+" && ATKLA =="+quote(sAtkla));
	ds_list.CopyF(ds_temp);
	ds_temp.UnFilter();
}

function ds_list_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex) {

	if (varNewValue != varOldValue) { 	     // 값이 변경되었을 경우 변경구분 컬럼 자동 SET 

		obj.SetColumn(nRow, "CHK" , "1");	// 선택여부   
			
		gfn_changeFlag( obj, strColumnID, nRow, "FLAG"); // FLAG 변경 : U
		
		if (pGubun == "S") obj.SetColumn(nRow, "FLAG" , "U");

		F_CHG_ROWNUM = nRow;	// 현재 행번호
		
		var sObjID     = cb_zprdgbn.Value;
		var sCopyAtkla = ds_list.getColumn(nRow, "ATKLA");
		var sPrh       = ds_list.getColumn(nRow, "PRH");
			
		var nSearchRow =  ds_temp.searchRow("ATKLA ==" + quote(sCopyAtkla) + " && PRH ==" + quote(sPrh) );
		//var nSearchRow =  ds_temp.searchRow("MCLASS ==" + quote(sObjID) + " && ATKLA ==" + quote(sCopyAtkla) + " && PRH ==" + quote(sPrh) );
		ds_temp.CopyRow(nSearchRow, ds_list, nRow);
	}
}

function ds_head_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex) {

	if (varNewValue != varOldValue) gfn_changeFlag(obj, strColumnID, nRow, "FLAG"); // FLAG 변경 : U
}

function grd_list_OnCellDblClick(obj,nRow,nCell,nX,nY,nPivotIndex) {

	if (ds_list.getColumn(ds_list.currow, "CNT") == 0) return;
	
	var cRow = ds_list.currow;
	
	var fa_class = cb_zprdgbn.Value; //"ELV_01"
	var fa_atkla = ds_list.getcolumn(ds_list.row, "ATKLA");
	var fa_atnam = ds_list.getcolumn(ds_list.row, "PRH"  );
	
	// 2020 브랜드
	var fa_brndcd = ds_list.getcolumn(ds_list.row, "BRNDCD");
	var fa_brndseq = ds_list.getcolumn(ds_list.row, "BRNDSEQ");
	var where = ""; 	//"AND E.ATZHL='0001'";	
	var arg = " fa_mandt="+G_MANDT+" fa_class="+fa_class+" fa_brndcd="+quote(fa_brndcd)+" fa_brndseq="+quote(fa_brndseq)+" fa_atkla="+fa_atkla+" fa_atnam="+quote(fa_atnam)+" fa_where="+quote("");

	ds_list_atnam_copy.ClearData();
	
	if (ds_list.getColumn(ds_list.currow, "PRH") == "EL_DOPTA")	{ //OPTION_A일 때는 멀티팝업에서 복수개로 선택한다.

		var arr = gfn_openPopupUrl("COM::Com0170.xml", true, arg);
		
		for (var i=0; i<ds_list_atnam_copy.count; i++) {

			if (ds_list_atnam_copy.GetColumn(i, "ATWRT") != null && ds_list_atnam_copy.GetColumn(i, "ATWRT") != "")	{

				var nSearchRow;
				if(i!=0) {
					ds_list.InsertRow(nRow);
					ds_list.CopyRow(nRow, ds_list, nRow+1);
					ds_temp.InsertRow(nRow);
					
					nSearchRow =  ds_temp.searchRow("PRH == 'EL_DOPTA'");
					
					ds_temp.CopyRow(nRow, ds_temp, nSearchRow);
					ds_list.setColumn(nRow, "ZTPLSEQ" , "ZZZ"+i);
				}
				ds_list.setColumn(nRow, "PRD" , ds_list_atnam_copy.GetColumn(i, "ATWRT"));
			}
		}
	} else {
		var arr = gfn_openPopupUrl("COM::Com0150.xml", true, arg);
		if (arr != null && arr != 0) ds_list.setColumn(nRow, "PRD" , arr[6]);
	}
}

// 선택한 row의 CNT값이 0 이상일 경우 수정불가(팝업으로만 선택)
function grd_list_OnCellPosChanged(obj,nRow,nCell,nOldRow,nOldCell,nPivotIndex,nOldPivotIndex) {

	if (ds_list.getColumn(ds_list.currow, "CNT") > 0) grd_list.Editable = false;
	else                                              grd_list.Editable = true;
}

function ds_temp_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex) {
}

function btn_close2_OnClick(obj) {
	fn_save();
}

/********************************************************************************
* 기      능   : 2020 브랜드 브랜드 코드 조회
********************************************************************************/
function fn_query_abrand() 
{
	nsfRequest("query"												// srvId
				, "coms01a/comboAtwrt"								// url
				, "ds_list_atwrt=ds_list_abrand"					// inDsList
				, "ds_list_abrand=ds_list_atwrt ds_error=ds_error"	// outDsList
				, "G_VKBUR='EL_ABRAND'"        						// strParam
				, "fn_afterQuery_abrand"							// CallBackFunc
				); 
}

/********************************************************************************
* 기      능   : 2020 브랜드 브랜드 코드 조회 CALL BACK
********************************************************************************/
function fn_afterQuery_abrand(svcId, errCode, errMsg) 
{
	gfn_InsertRowCombo(ds_list_abrand, 0, "", "", "CODE", "CODE_NAME"); // 선택 행 추가 
	ds_list_abrand.row = 0;
}

]]></Script>
</Window>