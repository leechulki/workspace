<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="1016" Id="Ses0451" Left="8" OnLoadCompleted="fn_OnLoadCompleted" OnUnloadCompleted="fn_OnUnloadCompleted" PidAttrib="7" Title="디자인의뢰요청등록" Top="8" Ver="1.0" Width="792" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_cond">
				<Contents>
					<colinfo id="MANDT" size="256" summ="default" type="STRING"/>
					<colinfo id="ZRQSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="QTSO_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="QTSER" size="256" summ="default" type="STRING"/>
					<colinfo id="QTSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="HOGI" size="256" summ="default" type="STRING"/>
					<colinfo id="GUBUN" size="256" summ="default" type="STRING"/>
					<colinfo id="MATNR" size="256" summ="default" type="STRING"/>
					<colinfo id="POSNR" size="256" summ="default" type="STRING"/>
					<record>
						<GUBUN></GUBUN>
						<HOGI></HOGI>
						<MANDT></MANDT>
						<MATNR></MATNR>
						<POSNR></POSNR>
						<QTSEQ></QTSEQ>
						<QTSER></QTSER>
						<QTSO_NO></QTSO_NO>
						<ZRQSEQ></ZRQSEQ>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_header">
				<Contents>
					<colinfo id="MANDT" size="256" summ="default" type="STRING"/>
					<colinfo id="ZRQSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="ZRQDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="DSNGBN" size="256" summ="default" type="STRING"/>
					<colinfo id="ZRQID" size="256" summ="default" type="STRING"/>
					<colinfo id="ZRQNM" size="256" summ="default" type="STRING"/>
					<colinfo id="ZRQ_DEPTNM" size="256" summ="default" type="STRING"/>
					<colinfo id="ZRQTEL" size="256" summ="default" type="STRING"/>
					<colinfo id="ZRQCEL" size="256" summ="default" type="STRING"/>
					<colinfo id="ZRQCN" size="256" summ="default" type="STRING"/>
					<colinfo id="ZRQSTAT" size="256" summ="default" type="STRING"/>
					<colinfo id="KUNNR_DS" size="256" summ="default" type="STRING"/>
					<colinfo id="KUNNR_DSNM" size="256" summ="default" type="STRING"/>
					<colinfo id="QTSO_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="QTSER" size="256" summ="default" type="STRING"/>
					<colinfo id="QTSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="HOGI" size="256" summ="default" type="STRING"/>
					<colinfo id="DLVDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="FINDAT" size="256" summ="default" type="STRING"/>
					<colinfo id="METR_2ND" size="256" summ="default" type="STRING"/>
					<colinfo id="ATYP_2ND" size="256" summ="default" type="STRING"/>
					<colinfo id="AMAN_2ND" size="256" summ="default" type="STRING"/>
					<colinfo id="AQTY_2ND" size="256" summ="default" type="STRING"/>
					<colinfo id="ASPD_2ND" size="256" summ="default" type="STRING"/>
					<colinfo id="AFLR_2ND" size="256" summ="default" type="STRING"/>
					<colinfo id="AUSE_2ND" size="256" summ="default" type="STRING"/>
					<colinfo id="ADOOR_2ND" size="256" summ="default" type="STRING"/>
					<colinfo id="CEIL_2ND" size="256" summ="default" type="STRING"/>
					<colinfo id="WALL_2ND" size="256" summ="default" type="STRING"/>
					<colinfo id="FLOR_2ND" size="256" summ="default" type="STRING"/>
					<colinfo id="HDRL_2ND" size="256" summ="default" type="STRING"/>
					<colinfo id="OPER_2ND" size="256" summ="default" type="STRING"/>
					<colinfo id="DOOR_2ND" size="256" summ="default" type="STRING"/>
					<colinfo id="POID_2ND" size="256" summ="default" type="STRING"/>
					<colinfo id="HATC_2ND" size="256" summ="default" type="STRING"/>
					<colinfo id="JAMB_2ND" size="256" summ="default" type="STRING"/>
					<colinfo id="HBTN_2ND" size="256" summ="default" type="STRING"/>
					<colinfo id="HLTN_2ND" size="256" summ="default" type="STRING"/>
					<colinfo id="EXPO_2ND" size="256" summ="default" type="STRING"/>
					<colinfo id="METR_3ND" size="256" summ="default" type="STRING"/>
					<colinfo id="ATYP_3ND" size="256" summ="default" type="STRING"/>
					<colinfo id="AMAN_3ND" size="256" summ="default" type="STRING"/>
					<colinfo id="AQTY_3ND" size="256" summ="default" type="STRING"/>
					<colinfo id="ASPD_3ND" size="256" summ="default" type="STRING"/>
					<colinfo id="AFLR_3ND" size="256" summ="default" type="STRING"/>
					<colinfo id="AUSE_3ND" size="256" summ="default" type="STRING"/>
					<colinfo id="ADOOR_3ND" size="256" summ="default" type="STRING"/>
					<colinfo id="CEIL_3ND" size="256" summ="default" type="STRING"/>
					<colinfo id="WALL_3ND" size="256" summ="default" type="STRING"/>
					<colinfo id="FLOR_3ND" size="256" summ="default" type="STRING"/>
					<colinfo id="HDRL_3ND" size="256" summ="default" type="STRING"/>
					<colinfo id="OPER_3ND" size="256" summ="default" type="STRING"/>
					<colinfo id="DOOR_3ND" size="256" summ="default" type="STRING"/>
					<colinfo id="POID_3ND" size="256" summ="default" type="STRING"/>
					<colinfo id="HATC_3ND" size="256" summ="default" type="STRING"/>
					<colinfo id="JAMB_3ND" size="256" summ="default" type="STRING"/>
					<colinfo id="HBTN_3ND" size="256" summ="default" type="STRING"/>
					<colinfo id="HLTN_3ND" size="256" summ="default" type="STRING"/>
					<colinfo id="EXPO_3ND" size="256" summ="default" type="STRING"/>
					<colinfo id="NOREST" size="256" summ="default" type="STRING"/>
					<colinfo id="REST01" size="256" summ="default" type="STRING"/>
					<colinfo id="REST02" size="256" summ="default" type="STRING"/>
					<colinfo id="REST03" size="256" summ="default" type="STRING"/>
					<colinfo id="DELV01" size="256" summ="default" type="STRING"/>
					<colinfo id="DELV02" size="256" summ="default" type="STRING"/>
					<colinfo id="DELV03" size="256" summ="default" type="STRING"/>
					<colinfo id="ADDTUSE01" size="256" summ="default" type="STRING"/>
					<colinfo id="ADDTUSE02" size="256" summ="default" type="STRING"/>
					<colinfo id="EX_KUNNR" size="256" summ="default" type="STRING"/>
					<colinfo id="EX_KUNNRNM" size="256" summ="default" type="STRING"/>
					<colinfo id="INTER_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="RQ_SA" size="256" summ="default" type="STRING"/>
					<colinfo id="RQ_SA_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="RQ_TB" size="256" summ="default" type="STRING"/>
					<colinfo id="RQ_TB_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="RQ_DB" size="256" summ="default" type="STRING"/>
					<colinfo id="RQ_DB_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="DS_TB" size="256" summ="default" type="STRING"/>
					<colinfo id="DS_TB_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="DS_DB" size="256" summ="default" type="STRING"/>
					<colinfo id="DS_DB_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="CDATE" size="256" summ="default" type="STRING"/>
					<colinfo id="CTIME" size="256" summ="default" type="STRING"/>
					<colinfo id="CUSER" size="256" summ="default" type="STRING"/>
					<colinfo id="UDATE" size="256" summ="default" type="STRING"/>
					<colinfo id="UTIME" size="256" summ="default" type="STRING"/>
					<colinfo id="UUSER" size="256" summ="default" type="STRING"/>
					<colinfo id="GSNAM" size="256" summ="default" type="STRING"/>
					<colinfo id="ZRSRLT" size="256" summ="default" type="STRING"/>
					<colinfo id="ZNUMBER" size="256" summ="default" type="STRING"/>
					<colinfo id="ZACAPA" size="256" summ="default" type="STRING"/>
					<colinfo id="ZUSE" size="256" summ="default" type="STRING"/>
					<colinfo id="ZOPN" size="256" summ="default" type="STRING"/>
					<colinfo id="ZLEN" size="256" summ="default" type="STRING"/>
					<colinfo id="VBELN" size="256" summ="default" type="STRING"/>
					<colinfo id="ZRQSEQ_DEL" size="256" summ="default" type="STRING"/>
					<colinfo id="EMAIL_DEPT" size="256" summ="default" type="STRING"/>
					<colinfo id="EMAIL_USERNUMB" size="256" summ="default" type="STRING"/>
					<colinfo id="EMAIL" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNRNM" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_error">
				<Contents>
					<colinfo id="IDX" size="256" type="STRING"/>
					<colinfo id="ERRMSG" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_template">
				<Contents>
					<colinfo id="FLAG" size="1" summ="default" type="STRING"/>
					<colinfo id="CHK" size="1" summ="default" type="STRING"/>
					<colinfo id="MANDT" size="256" summ="default" type="STRING"/>
					<colinfo id="ZTPLNO" size="256" summ="default" type="STRING"/>
					<colinfo id="ZTPLSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="PRH" size="256" summ="default" type="STRING"/>
					<colinfo id="PRHNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="PRD" size="256" summ="default" type="STRING"/>
					<colinfo id="ZRMK" size="256" summ="default" type="STRING"/>
					<colinfo id="MCLASS" size="256" summ="default" type="STRING"/>
					<colinfo id="ZTPLNM" size="256" summ="default" type="STRING"/>
					<colinfo id="ATKLA" size="256" summ="default" type="STRING"/>
					<colinfo id="QTNUM" size="256" summ="default" type="STRING"/>
					<colinfo id="QTSER" size="256" summ="default" type="STRING"/>
					<colinfo id="QTSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="PRSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="ATFOR" size="256" summ="default" type="STRING"/>
					<colinfo id="SCOLOR" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_template1">
				<Contents>
					<colinfo id="FLAG" size="1" summ="default" type="STRING"/>
					<colinfo id="CHK" size="1" summ="default" type="STRING"/>
					<colinfo id="MANDT" size="256" summ="default" type="STRING"/>
					<colinfo id="ZTPLNO" size="256" summ="default" type="STRING"/>
					<colinfo id="ZTPLSEQ" size="256" summ="default" type="INT"/>
					<colinfo id="PRH" size="256" summ="default" type="STRING"/>
					<colinfo id="PRHNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="PRD" size="256" summ="default" type="STRING"/>
					<colinfo id="ZRMK" size="256" summ="default" type="STRING"/>
					<colinfo id="MCLASS" size="256" summ="default" type="STRING"/>
					<colinfo id="ZTPLNM" size="256" summ="default" type="STRING"/>
					<colinfo id="ATKLA" size="256" summ="default" type="STRING"/>
					<colinfo id="QTNUM" size="256" summ="default" type="STRING"/>
					<colinfo id="QTSER" size="256" summ="default" type="STRING"/>
					<colinfo id="QTSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="PRSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="ATFOR" size="256" summ="default" type="STRING"/>
					<colinfo id="SCOLOR" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_template2">
				<Contents>
					<colinfo id="FLAG" size="1" summ="default" type="STRING"/>
					<colinfo id="CHK" size="1" summ="default" type="STRING"/>
					<colinfo id="MANDT" size="256" summ="default" type="STRING"/>
					<colinfo id="ZTPLNO" size="256" summ="default" type="STRING"/>
					<colinfo id="ZTPLSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="PRH" size="256" summ="default" type="STRING"/>
					<colinfo id="PRHNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="PRD" size="256" summ="default" type="STRING"/>
					<colinfo id="ZRMK" size="256" summ="default" type="STRING"/>
					<colinfo id="MCLASS" size="256" summ="default" type="STRING"/>
					<colinfo id="ZTPLNM" size="256" summ="default" type="STRING"/>
					<colinfo id="ATKLA" size="256" summ="default" type="STRING"/>
					<colinfo id="QTNUM" size="256" summ="default" type="STRING"/>
					<colinfo id="QTSER" size="256" summ="default" type="STRING"/>
					<colinfo id="QTSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="PRSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="ATFOR" size="256" summ="default" type="STRING"/>
					<colinfo id="SCOLOR" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_template3">
				<Contents>
					<colinfo id="FLAG" size="1" summ="default" type="STRING"/>
					<colinfo id="CHK" size="1" summ="default" type="STRING"/>
					<colinfo id="MANDT" size="256" summ="default" type="STRING"/>
					<colinfo id="ZTPLNO" size="256" summ="default" type="STRING"/>
					<colinfo id="ZTPLSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="PRH" size="256" summ="default" type="STRING"/>
					<colinfo id="PRHNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="PRD" size="256" summ="default" type="STRING"/>
					<colinfo id="ZRMK" size="256" summ="default" type="STRING"/>
					<colinfo id="MCLASS" size="256" summ="default" type="STRING"/>
					<colinfo id="ZTPLNM" size="256" summ="default" type="STRING"/>
					<colinfo id="ATKLA" size="256" summ="default" type="STRING"/>
					<colinfo id="QTNUM" size="256" summ="default" type="STRING"/>
					<colinfo id="QTSER" size="256" summ="default" type="STRING"/>
					<colinfo id="QTSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="PRSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="ATFOR" size="256" summ="default" type="STRING"/>
					<colinfo id="SCOLOR" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_template4">
				<Contents>
					<colinfo id="FLAG" size="1" summ="default" type="STRING"/>
					<colinfo id="CHK" size="1" summ="default" type="STRING"/>
					<colinfo id="MANDT" size="256" summ="default" type="STRING"/>
					<colinfo id="ZTPLNO" size="256" summ="default" type="STRING"/>
					<colinfo id="ZTPLSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="PRH" size="256" summ="default" type="STRING"/>
					<colinfo id="PRHNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="PRD" size="256" summ="default" type="STRING"/>
					<colinfo id="ZRMK" size="256" summ="default" type="STRING"/>
					<colinfo id="MCLASS" size="256" summ="default" type="STRING"/>
					<colinfo id="ZTPLNM" size="256" summ="default" type="STRING"/>
					<colinfo id="ATKLA" size="256" summ="default" type="STRING"/>
					<colinfo id="QTNUM" size="256" summ="default" type="STRING"/>
					<colinfo id="QTSER" size="256" summ="default" type="STRING"/>
					<colinfo id="QTSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="PRSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="ATFOR" size="256" summ="default" type="STRING"/>
					<colinfo id="SCOLOR" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_templateSd120">
				<Contents>
					<colinfo id="FLAG" size="1" summ="default" type="STRING"/>
					<colinfo id="CHK" size="1" summ="default" type="STRING"/>
					<colinfo id="MANDT" size="256" summ="default" type="STRING"/>
					<colinfo id="ZTPLNO" size="256" summ="default" type="STRING"/>
					<colinfo id="ZTPLSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="PRH" size="256" summ="default" type="STRING"/>
					<colinfo id="PRHNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="PRD" size="256" summ="default" type="STRING"/>
					<colinfo id="ZRMK" size="256" summ="default" type="STRING"/>
					<colinfo id="MCLASS" size="256" summ="default" type="STRING"/>
					<colinfo id="ZTPLNM" size="256" summ="default" type="STRING"/>
					<colinfo id="ATKLA" size="256" summ="default" type="STRING"/>
					<colinfo id="QTNUM" size="256" summ="default" type="STRING"/>
					<colinfo id="QTSER" size="256" summ="default" type="STRING"/>
					<colinfo id="QTSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="PRSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="ATFOR" size="256" summ="default" type="STRING"/>
					<colinfo id="SCOLOR" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_file" OnColumnChanged="ds_file_OnColumnChanged">
				<Contents>
					<colinfo id="FLAG" size="256" type="STRING"/>
					<colinfo id="MANDT" size="256" type="STRING"/>
					<colinfo id="ZRQSEQ" size="256" type="STRING"/>
					<colinfo id="ZATTSEQ" size="256" type="STRING"/>
					<colinfo id="ZATGBN" size="256" type="STRING"/>
					<colinfo id="ZATTPATH" size="256" type="STRING"/>
					<colinfo id="ZATTFN" size="256" type="STRING"/>
					<colinfo id="TEMP" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_code_atgbn">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
					<record>
						<CODE>R</CODE>
						<CODE_NAME>요청</CODE_NAME>
					</record>
					<record>
						<CODE>F</CODE>
						<CODE_NAME>완료</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_del_file" OnColumnChanged="ds_file_OnColumnChanged">
				<Contents>
					<colinfo id="FLAG" size="256" type="STRING"/>
					<colinfo id="MANDT" size="256" type="STRING"/>
					<colinfo id="ZRQSEQ" size="256" type="STRING"/>
					<colinfo id="ZATTSEQ" size="256" type="STRING"/>
					<colinfo id="ZATGBN" size="256" type="STRING"/>
					<colinfo id="ZATTPATH" size="256" type="STRING"/>
					<colinfo id="ZATTFN" size="256" type="STRING"/>
					<colinfo id="TEMP" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_code_dsngbn">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE>A</CODE>
						<CODE_NAME>표준</CODE_NAME>
					</record>
					<record>
						<CODE>B</CODE>
						<CODE_NAME>비표준</CODE_NAME>
					</record>
					<record>
						<CODE>C</CODE>
						<CODE_NAME>긴급(표준)</CODE_NAME>
					</record>
					<record>
						<CODE>D</CODE>
						<CODE_NAME>긴급(비표준)</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_code_email_dept">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_email">
				<Contents>
					<colinfo id="EMAIL_DEPT" size="256" summ="default" type="STRING"/>
					<colinfo id="EMAIL" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
		</Datasets>
		<Static Align="Right" Height="24" Id="st_name" Left="-116" Style="sty_lb_search" TabOrder="0" Text="현장명&#32;" Top="-6" VAlign="Middle" Width="61"></Static>
		<Div Height="30" Id="div_btn" TabOrder="2" Text="Div0" Url="WB01::CommBtnForm.xml" Width="790">
			<Contents></Contents>
		</Div>
		<Shape BKColor="user0" Bottom="60" Height="26" Id="Shape2" Left="4" LineColor="user1" Right="782" TabOrder="3" Top="34" Type="Rectangle" Width="778"></Shape>
		<Static Align="Right" Height="24" Id="st_zrqseq" Left="6" Style="sty_lb_search" TabOrder="4" Text="요청번호&#32;" Top="35" VAlign="Middle" Width="72"></Static>
		<Shape BKColor="user0" Bottom="86" Height="26" Id="Shape1" Left="4" LineColor="user1" Right="782" TabOrder="5" Top="60" Type="Rectangle" Width="778"></Shape>
		<Shape BKColor="user0" Bottom="164" Height="26" Id="Shape4" Left="4" LineColor="user1" Right="782" TabOrder="4" Top="138" Type="Rectangle" Width="778"></Shape>
		<Shape BKColor="user0" Bottom="138" Height="26" Id="Shape3" Left="4" LineColor="user1" Right="782" TabOrder="4" Top="112" Type="Rectangle" Width="778"></Shape>
		<Shape BKColor="user0" Bottom="112" Height="26" Id="Shape7" Left="4" LineColor="user1" Right="782" TabOrder="3" Top="86" Type="Rectangle" Width="778"></Shape>
		<Calendar BindDataset="ds_header" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="DLVDAT" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Enable="FALSE" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_dlvdat" Left="370" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="9" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="140" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="105"></Calendar>
		<Static Align="Right" Height="24" Id="st_zestdat" Left="278" Style="sty_lb_search" TabOrder="10" Text="발송일&#32;" Top="138" VAlign="Middle" Width="88"></Static>
		<Static Align="Right" Height="24" Id="st_kunnr" Left="6" Style="sty_lb_search" TabOrder="12" Text="의뢰자&#32;" Top="112" VAlign="Middle" Width="72"></Static>
		<Static Align="Right" Height="24" Id="st_sman" Left="278" Style="sty_lb_search" TabOrder="13" Text="수주번호&#32;" Top="87" VAlign="Middle" Width="88"></Static>
		<Static Align="Right" Height="24" Id="st_qtso_no" Left="6" Style="sty_lb_search" TabOrder="0" Text="견적번호&#32;" Top="61" VAlign="Middle" Width="72"></Static>
		<Static Align="Right" Height="24" Id="st_deldat" Left="510" Style="sty_lb_search" TabOrder="2" Text="완료요청일" Top="139" VAlign="Middle" Width="88"></Static>
		<Static Align="Right" Height="24" Id="st_dsngbn" Left="6" Style="sty_lb_search" TabOrder="2" Text="디자인구분&#32;" Top="87" VAlign="Middle" Width="72"></Static>
		<Edit BindDataset="ds_header" Border="Flat" Column="QTSO_NO" Enable="FALSE" Height="20" Id="ed_qtso_no" ImeMode="english" Left="82" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="13" Top="64" UpperOnly="TRUE" Width="121"></Edit>
		<Edit BindDataset="ds_header" Border="Flat" CheckLength="Byte" Column="ZRQSEQ" Enable="FALSE" Height="20" Id="ed_zrqseq" ImeMode="native" Left="82" LeftMargin="4" MaxLength="10" RightMargin="4" Style="sty_ipt_form" TabOrder="14" Top="37" Width="121"></Edit>
		<Static Align="Right" Height="24" Id="st_qtser" Left="278" Style="sty_lb_search" TabOrder="15" Text="차수&#32;" Top="62" VAlign="Middle" Width="88"></Static>
		<Static Align="Right" Height="24" Id="st_gsnam" Left="510" Style="sty_lb_search" TabOrder="16" Text="현장명&#32;" Top="87" VAlign="Middle" Width="88"></Static>
		<Edit BindDataset="ds_header" Border="Flat" Column="QTSER" Enable="FALSE" Height="20" Id="ed_qtser" ImeMode="english" Left="370" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="17" Top="64" UpperOnly="TRUE" Width="105"></Edit>
		<Edit BindDataset="ds_header" Border="Flat" Column="GSNAM" Enable="FALSE" Height="20" Id="ed_gsnam" ImeMode="english" Left="600" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="18" Top="88" Width="176"></Edit>
		<Static Align="Right" Height="24" Id="st_zrqtel" Left="278" Style="sty_lb_search" TabOrder="19" Text="연락처(사무실)&#32;" Top="112" VAlign="Middle" Width="88"></Static>
		<Edit BindDataset="ds_header" Border="Flat" Column="ZRQTEL" Height="20" Id="ed_zrqtel" ImeMode="none" Left="370" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="20" Top="115" Width="129"></Edit>
		<Static Align="Right" Height="24" Id="st_zrqcel" Left="510" Style="sty_lb_search" TabOrder="21" Text="연락처(핸드폰)&#32;" Top="113" VAlign="Middle" Width="88"></Static>
		<Edit BindDataset="ds_header" Border="Flat" Column="ZRQCEL" Height="20" Id="ed_zrqcel" ImeMode="none" Left="602" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="22" Top="115" Width="129"></Edit>
		<Static Align="Right" Height="24" Id="st_qtseq" Left="510" Style="sty_lb_search" TabOrder="23" Text="일련번호&#32;" Top="62" VAlign="Middle" Width="88"></Static>
		<Edit BindDataset="ds_header" Border="Flat" Column="QTSEQ" Enable="FALSE" Height="20" Id="ed_qtseq" ImeMode="english" Left="602" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="24" Top="64" Width="105"></Edit>
		<Edit BindDataset="ds_header" Border="Flat" Column="VBELN" Enable="FALSE" Height="20" Id="ed_vbeln" ImeMode="english" Left="370" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="25" Top="89" UpperOnly="TRUE" Width="105"></Edit>
		<Calendar BindDataset="ds_header" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="FINDAT" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Enable="FALSE" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_findat" Left="603" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="26" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="142" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="105"></Calendar>
		<Tab Border="Flat" FixedImage="FALSE" Font="굴림,9" Height="424" Id="tab" Left="8" MouseOverColor="user16" SelColor="user15" SelectFont="굴림,9" Style="sty_tab" TabOrder="1" Top="168" Width="776">
			<Contents>
				<TabPage BorderColor="black" Height="399" Id="tab1" ImageEdgeWidth="1" ImageID="tab_main" Left="2" TabOrder="19" Text="1안" Top="23" Width="772">
					<Div Border="SunkenEdge" Height="395" Id="div_template" scroll="true" TabOrder="1" Text="Div0" Top="1" Width="842">
						<Contents>
							<Grid AreaSelect="TRUE" AutoEnter="TRUE" AutoFit="TRUE" AutoFitEndLine="Hide" BindDataset="ds_template1" BkColor2="default" BoldHead="true" Border="Flat" Bottom="370" ColSelect="TRUE" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="25" Height="369" Id="grd_template1" InputPanel="FALSE" Left="1" LineColor="user20" LineType="ExHORZ" MinWidth="100" OnMouseOver="tab_template_div_template_grd_template_OnMouseOver" Right="451" RowHeight="20" Style="sty_grid" TabOrder="1" TabStop="true" Top="1" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="450">
								<contents>
									<format id="Default">
										<columns>
											<col width="0"/>
											<col width="0"/>
											<col width="170"/>
											<col width="60"/>
										</columns>
										<head>
											<cell align="center" col="0" color="user21" display="text" font="굴림,9" text="No"/>
											<cell align="center" col="1" color="user21" display="text" font="굴림,9" text="변경"/>
											<cell align="center" col="2" color="user21" display="text" font="굴림,9" text="BASIC" wordwrap="word"/>
											<cell col="3" color="user21" display="text" font="굴림,9" text="값" wordwrap="word"/>
										</head>
										<body>
											<cell align="center" bkcolor2="user22" col="0" display="text" expr="currow+1"/>
											<cell align="center" bkcolor2="user22" bkimageid='expr:gfn_getFlagBkImageID(getColumn(currow,&#32;&quot;FLAG&quot;))' col="1" colid="FLAG" display="image"/>
											<cell align="left" bkcolor="expr:iif(trim(SCOLOR)=&apos;C&apos;,&apos;peachpuff&apos;,&#32;&apos;default&apos;)" col="2" colid="PRHNAME" display="text" suppress="1"/>
											<cell align="center" bkcolor="expr:iif(trim(SCOLOR)=&apos;C&apos;,&apos;peachpuff&apos;,&#32;&apos;default&apos;)" checklength="Byte" col="3" colid="PRD" display="text" limit="30"/>
										</body>
									</format>
								</contents>
							</Grid>
							<Grid AreaSelect="TRUE" AutoEnter="TRUE" AutoFit="TRUE" AutoFitEndLine="Hide" BindDataset="ds_template2" BkColor2="default" BoldHead="true" Border="Flat" Bottom="370" ColSelect="TRUE" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="25" Height="369" Id="grd_template2" InputPanel="FALSE" Left="453" LineColor="user20" LineType="ExHORZ" MinWidth="100" OnMouseOver="tab_template_div_template_grd_template_OnMouseOver" Right="903" RowHeight="20" Style="sty_grid" TabOrder="2" TabStop="true" Top="1" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="450">
								<contents>
									<format id="Default">
										<columns>
											<col width="0"/>
											<col width="0"/>
											<col width="170"/>
											<col width="70"/>
										</columns>
										<head>
											<cell align="center" col="0" color="user21" display="text" font="굴림,9" text="No"/>
											<cell align="center" col="1" color="user21" display="text" font="굴림,9" text="변경"/>
											<cell align="center" col="2" color="user21" display="text" font="굴림,9" text="INSIDE" wordwrap="word"/>
											<cell col="3" color="user21" display="text" font="굴림,9" text="값" wordwrap="word"/>
										</head>
										<body>
											<cell align="center" bkcolor2="user22" col="0" display="text" expr="currow+1"/>
											<cell align="center" bkcolor2="user22" bkimageid='expr:gfn_getFlagBkImageID(getColumn(currow,&#32;&quot;FLAG&quot;))' col="1" colid="FLAG" display="image"/>
											<cell align="left" bkcolor="expr:iif(trim(SCOLOR)=&apos;C&apos;,&apos;peachpuff&apos;,&#32;&apos;default&apos;)" col="2" colid="PRHNAME" display="text" suppress="1"/>
											<cell align="center" bkcolor="expr:iif(trim(SCOLOR)=&apos;C&apos;,&apos;peachpuff&apos;,&#32;&apos;default&apos;)" checklength="Byte" col="3" colid="PRD" display="text" limit="30"/>
										</body>
									</format>
								</contents>
							</Grid>
							<Grid AreaSelect="TRUE" AutoEnter="TRUE" AutoFit="TRUE" AutoFitEndLine="Hide" BindDataset="ds_template3" BkColor2="default" BoldHead="true" Border="Flat" Bottom="369" ColSelect="TRUE" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="25" Height="369" Id="grd_template3" InputPanel="FALSE" Left="905" LineColor="user20" LineType="ExHORZ" MinWidth="100" OnMouseOver="tab_template_div_template_grd_template_OnMouseOver" Right="1355" RowHeight="20" Style="sty_grid" TabOrder="3" TabStop="true" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="450">
								<contents>
									<format id="Default">
										<columns>
											<col width="0"/>
											<col width="0"/>
											<col width="170"/>
											<col width="70"/>
										</columns>
										<head>
											<cell align="center" col="0" color="user21" display="text" font="굴림,9" text="No"/>
											<cell align="center" col="1" color="user21" display="text" font="굴림,9" text="변경"/>
											<cell align="center" col="2" color="user21" display="text" font="굴림,9" text="OUTSIDE" wordwrap="word"/>
											<cell col="3" color="user21" display="text" font="굴림,9" text="값" wordwrap="word"/>
										</head>
										<body>
											<cell align="center" bkcolor2="user22" col="0" display="text" expr="currow+1"/>
											<cell align="center" bkcolor2="user22" bkimageid='expr:gfn_getFlagBkImageID(getColumn(currow,&#32;&quot;FLAG&quot;))' col="1" colid="FLAG" display="image"/>
											<cell align="left" bkcolor="expr:iif(trim(SCOLOR)=&apos;C&apos;,&apos;peachpuff&apos;,&#32;&apos;default&apos;)" col="2" colid="PRHNAME" suppress="1"/>
											<cell align="center" bkcolor="expr:iif(trim(SCOLOR)=&apos;C&apos;,&apos;peachpuff&apos;,&#32;&apos;default&apos;)" checklength="Byte" col="3" colid="PRD" edit="none" limit="30"/>
										</body>
									</format>
								</contents>
							</Grid>
							<Grid AreaSelect="TRUE" AutoEnter="TRUE" AutoFit="TRUE" AutoFitEndLine="Hide" BindDataset="ds_template4" BkColor2="default" BoldHead="true" Border="Flat" Bottom="367" ColSelect="TRUE" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="25" Height="369" Id="grd_template4" InputPanel="FALSE" Left="1357" LineColor="user20" LineType="ExHORZ" MinWidth="100" OnMouseOver="tab_template_div_template_grd_template_OnMouseOver" Right="1807" RowHeight="20" Style="sty_grid" TabOrder="4" TabStop="true" Top="-2" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="450">
								<contents>
									<format id="Default">
										<columns>
											<col width="0"/>
											<col width="0"/>
											<col width="170"/>
											<col width="60"/>
										</columns>
										<head>
											<cell align="center" col="0" color="user21" display="text" font="굴림,9" text="No"/>
											<cell align="center" col="1" color="user21" display="text" font="굴림,9" text="변경"/>
											<cell align="center" col="2" color="user21" display="text" font="굴림,9" text="OPTION" wordwrap="word"/>
											<cell col="3" color="user21" display="text" font="굴림,9" text="값" wordwrap="word"/>
										</head>
										<body>
											<cell align="center" bkcolor2="user22" col="0" display="text" expr="currow+1"/>
											<cell align="center" bkcolor2="user22" bkimageid='expr:gfn_getFlagBkImageID(getColumn(currow,&#32;&quot;FLAG&quot;))' col="1" colid="FLAG" display="image"/>
											<cell align="left" bkcolor="expr:iif(trim(SCOLOR)=&apos;C&apos;,&apos;peachpuff&apos;,&#32;&apos;default&apos;)" col="2" colid="PRHNAME" suppress="1"/>
											<cell align="center" bkcolor="expr:iif(trim(SCOLOR)=&apos;C&apos;,&apos;peachpuff&apos;,&#32;&apos;default&apos;)" checklength="Byte" col="3" colid="PRD" edit="none" limit="30"/>
										</body>
									</format>
								</contents>
							</Grid>
						</Contents>
					</Div>
				</TabPage>
				<TabPage BorderColor="black" Height="399" Id="tab2" ImageEdgeWidth="1" ImageID="tab_main" Left="2" TabOrder="26" Text="2안,3안" Top="23" Width="772">
					<Shape BKColor="user0" Bottom="114" Height="96" Id="Shape2" Left="174" LineColor="user1" Right="470" TabOrder="3" Top="18" Type="Rectangle" Width="296"></Shape>
					<Static Align="Center" Height="112" Id="st_zrqseq" Left="8" Style="sty_lb_search" TabOrder="4" Text="승강기&#32;정보" Top="2" VAlign="Middle" Width="162"></Static>
					<Static Align="Center" Height="24" Id="Static0" Left="178" Style="sty_lb_search" TabOrder="5" Text="소재" Top="22" VAlign="Middle" Width="71"></Static>
					<Static Align="Center" Height="24" Id="Static1" Left="250" Style="sty_lb_search" TabOrder="6" Text="기종" Top="22" VAlign="Middle" Width="71"></Static>
					<Static Align="Center" Height="24" Id="Static2" Left="322" Style="sty_lb_search" TabOrder="7" Text="인승" Top="22" VAlign="Middle" Width="71"></Static>
					<Static Align="Center" Height="24" Id="Static3" Left="394" Style="sty_lb_search" TabOrder="8" Text="대수" Top="22" VAlign="Middle" Width="71"></Static>
					<Edit Align="CENTER" BindDataset="ds_header" Border="Flat" Column="METR_2ND" Height="20" Id="ed_bwm2" ImeMode="english" Left="178" LeftMargin="4" OnClick="getTemplateOption" Readonly="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="1" Top="46" UpperOnly="TRUE" Width="72"></Edit>
					<Edit Align="CENTER" BindDataset="ds_header" Border="Flat" Column="ATYP_2ND" Height="20" Id="ed_atyp2" ImeMode="english" Left="250" LeftMargin="4" OnClick="getTemplateOption" Readonly="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="2" Top="46" UpperOnly="TRUE" Width="72"></Edit>
					<Edit Align="CENTER" BindDataset="ds_header" Border="Flat" Column="AMAN_2ND" Height="20" Id="ed_aman2" ImeMode="english" Left="322" LeftMargin="4" OnClick="getTemplateOption" Readonly="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="3" Top="46" UpperOnly="TRUE" Width="72"></Edit>
					<Edit Align="CENTER" BindDataset="ds_header" Border="Flat" Column="AQTY_2ND" Height="20" Id="ed_znumber2" ImeMode="english" Left="394" LeftMargin="4" Number="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="4" Top="46" UpperOnly="TRUE" Width="72"></Edit>
					<Static Align="Center" Height="24" Id="Static4" Left="178" Style="sty_lb_search" TabOrder="13" Text="속도" Top="66" VAlign="Middle" Width="71"></Static>
					<Static Align="Center" Height="24" Id="Static5" Left="250" Style="sty_lb_search" TabOrder="14" Text="운행층" Top="66" VAlign="Middle" Width="71"></Static>
					<Static Align="Center" Height="24" Id="Static6" Left="322" Style="sty_lb_search" TabOrder="15" Text="용도" Top="66" VAlign="Middle" Width="71"></Static>
					<Static Align="Center" Height="24" Id="Static7" Left="394" Style="sty_lb_search" TabOrder="16" Text="도어" Top="66" VAlign="Middle" Width="71"></Static>
					<Edit Align="CENTER" BindDataset="ds_header" Border="Flat" Column="ADOOR_2ND" Height="20" Id="ed_aopen2" ImeMode="english" Left="394" LeftMargin="4" OnClick="getTemplateOption" Readonly="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="8" Top="90" UpperOnly="TRUE" Width="72"></Edit>
					<Edit Align="CENTER" BindDataset="ds_header" Border="Flat" Column="AUSE_2ND" Height="20" Id="ed_ause2" ImeMode="english" Left="322" LeftMargin="4" OnClick="getTemplateOption" Readonly="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="7" Top="90" UpperOnly="TRUE" Width="72"></Edit>
					<Edit Align="CENTER" BindDataset="ds_header" Border="Flat" Column="AFLR_2ND" Height="20" Id="ed_astq2" ImeMode="english" Left="250" LeftMargin="4" Number="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="6" Top="90" UpperOnly="TRUE" Width="72"></Edit>
					<Edit Align="CENTER" BindDataset="ds_header" Border="Flat" Column="ASPD_2ND" Height="20" Id="ed_aspd2" ImeMode="english" Left="178" LeftMargin="4" OnClick="getTemplateOption" Readonly="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="5" Top="90" UpperOnly="TRUE" Width="72"></Edit>
					<Static Align="Center" Height="160" Id="Static8" Left="8" Style="sty_lb_search" TabOrder="21" Text="카내의장" Top="116" VAlign="Middle" Width="32" WordWrap="TRUE"></Static>
					<Shape BKColor="user0" Bottom="114" Height="96" Id="Shape0" Left="473" LineColor="user1" Right="769" TabOrder="22" Top="18" Type="Rectangle" Width="296"></Shape>
					<Shape BKColor="user0" Bottom="278" Height="162" Id="Shape1" Left="174" LineColor="user1" Right="470" TabOrder="23" Top="116" Type="Rectangle" Width="296"></Shape>
					<Static Align="Center" Height="22" Id="Static10" Left="42" Style="sty_lb_search" TabOrder="24" Text="벽체" Top="139" VAlign="Middle" Width="128"></Static>
					<Shape BKColor="user0" Bottom="278" Height="162" Id="Shape3" Left="473" LineColor="user1" Right="769" TabOrder="25" Top="116" Type="Rectangle" Width="296"></Shape>
					<Static Align="Center" Height="22" Id="Static11" Left="42" Style="sty_lb_search" TabOrder="26" Text="바닥" Top="162" VAlign="Middle" Width="128"></Static>
					<Shape BKColor="user0" Bottom="394" Height="114" Id="Shape4" Left="174" LineColor="user1" Right="470" TabOrder="29" Top="280" Type="Rectangle" Width="296"></Shape>
					<Shape BKColor="user0" Bottom="394" Height="114" Id="Shape5" Left="473" LineColor="user1" Right="769" TabOrder="30" Top="280" Type="Rectangle" Width="296"></Shape>
					<Static Align="Center" Height="22" Id="Static12" Left="42" Style="sty_lb_search" TabOrder="31" Text="핸드레일" Top="185" VAlign="Middle" Width="128"></Static>
					<Static Align="Center" Height="22" Id="Static13" Left="42" Style="sty_lb_search" TabOrder="32" Text="조작반" Top="208" VAlign="Middle" Width="128"></Static>
					<Static Align="Center" Height="22" Id="Static14" Left="42" Style="sty_lb_search" TabOrder="33" Text="도어" Top="231" VAlign="Middle" Width="128"></Static>
					<Static Align="Center" Height="22" Id="Static15" Left="42" Style="sty_lb_search" TabOrder="34" Text="위치표시기" Top="254" VAlign="Middle" Width="128"></Static>
					<Static Align="Center" Height="114" Id="Static16" Left="8" Style="sty_lb_search" TabOrder="35" Text="카외의장" Top="278" VAlign="Middle" Width="32" WordWrap="TRUE"></Static>
					<Static Align="Center" Height="22" Id="Static17" Left="42" Style="sty_lb_search" TabOrder="36" Text="도어&#32;기준/기타" Top="278" VAlign="Middle" Width="128"></Static>
					<Static Align="Center" Height="22" Id="Static18" Left="42" Style="sty_lb_search" TabOrder="37" Text="삼방틀&#32;기준/기타" Top="301" VAlign="Middle" Width="128"></Static>
					<Static Align="Center" Height="22" Id="Static19" Left="42" Style="sty_lb_search" TabOrder="38" Text="홀버튼&#32;기준/기타" Top="324" VAlign="Middle" Width="128"></Static>
					<Static Align="Center" Height="22" Id="Static20" Left="42" Style="sty_lb_search" TabOrder="39" Text="홀랜턴" Top="347" VAlign="Middle" Width="128"></Static>
					<Static Align="Center" Height="22" Id="Static21" Left="42" Style="sty_lb_search" TabOrder="40" Text="위치표시기&#32;기준/기타" Top="370" VAlign="Middle" Width="128"></Static>
					<Static Align="Center" BKColor="yellow" Border="SunkenEdge" Color="black" Height="18" Id="Static22" Left="174" TabOrder="41" Text="2안" Top="2" VAlign="Middle" Width="296"></Static>
					<Static Align="Center" BKColor="yellow" Border="SunkenEdge" Color="black" Height="18" Id="Static23" Left="473" TabOrder="42" Text="3안" Top="2" VAlign="Middle" Width="296"></Static>
					<Static Align="Center" Height="24" Id="Static24" Left="476" Style="sty_lb_search" TabOrder="43" Text="소재" Top="22" VAlign="Middle" Width="71"></Static>
					<Static Align="Center" Height="24" Id="Static25" Left="548" Style="sty_lb_search" TabOrder="44" Text="기종" Top="22" VAlign="Middle" Width="71"></Static>
					<Static Align="Center" Height="24" Id="Static26" Left="620" Style="sty_lb_search" TabOrder="45" Text="인승" Top="22" VAlign="Middle" Width="71"></Static>
					<Static Align="Center" Height="24" Id="Static27" Left="692" Style="sty_lb_search" TabOrder="46" Text="대수" Top="22" VAlign="Middle" Width="71"></Static>
					<Edit Align="CENTER" BindDataset="ds_header" Border="Flat" Column="METR_3ND" Height="20" Id="ed_bwm3" ImeMode="english" Left="476" LeftMargin="4" OnClick="getTemplateOption" Readonly="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="9" Top="46" UpperOnly="TRUE" Width="72"></Edit>
					<Edit Align="CENTER" BindDataset="ds_header" Border="Flat" Column="ATYP_3ND" Height="20" Id="ed_atyp3" ImeMode="english" Left="548" LeftMargin="4" OnClick="getTemplateOption" Readonly="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="10" Top="46" UpperOnly="TRUE" Width="72"></Edit>
					<Edit Align="CENTER" BindDataset="ds_header" Border="Flat" Column="AMAN_3ND" Height="20" Id="ed_aman3" ImeMode="english" Left="620" LeftMargin="4" OnClick="getTemplateOption" Readonly="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="11" Top="46" UpperOnly="TRUE" Width="72"></Edit>
					<Edit Align="CENTER" BindDataset="ds_header" Border="Flat" Column="AQTY_3ND" Height="20" Id="ed_znumber3" ImeMode="english" Left="692" LeftMargin="4" Number="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="12" Top="46" UpperOnly="TRUE" Width="72"></Edit>
					<Static Align="Center" Height="24" Id="Static28" Left="476" Style="sty_lb_search" TabOrder="51" Text="속도" Top="66" VAlign="Middle" Width="71"></Static>
					<Static Align="Center" Height="24" Id="Static29" Left="548" Style="sty_lb_search" TabOrder="52" Text="운행층" Top="66" VAlign="Middle" Width="71"></Static>
					<Static Align="Center" Height="24" Id="Static30" Left="620" Style="sty_lb_search" TabOrder="53" Text="용도" Top="66" VAlign="Middle" Width="71"></Static>
					<Static Align="Center" Height="24" Id="Static31" Left="692" Style="sty_lb_search" TabOrder="54" Text="도어" Top="66" VAlign="Middle" Width="71"></Static>
					<Static Align="Center" Height="22" Id="Static9" Left="42" Style="sty_lb_search" TabOrder="60" Text="천장" Top="116" VAlign="Middle" Width="128"></Static>
					<Edit Align="CENTER" BindDataset="ds_header" Border="Flat" Column="ADOOR_3ND" Height="20" Id="ed_aopen3" ImeMode="english" Left="692" LeftMargin="4" OnClick="getTemplateOption" Readonly="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="16" Top="90" Width="72"></Edit>
					<Edit Align="CENTER" BindDataset="ds_header" Border="Flat" Column="AUSE_3ND" Height="20" Id="ed_ause3" ImeMode="english" Left="620" LeftMargin="4" OnClick="getTemplateOption" Readonly="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="15" Top="90" Width="72"></Edit>
					<Edit Align="CENTER" BindDataset="ds_header" Border="Flat" Column="AFLR_3ND" Height="20" Id="ed_astq3" ImeMode="english" Left="548" LeftMargin="4" Number="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="14" Top="90" Width="72"></Edit>
					<Edit Align="CENTER" BindDataset="ds_header" Border="Flat" Column="ASPD_3ND" Height="20" Id="ed_aspd3" ImeMode="english" Left="476" LeftMargin="4" OnClick="getTemplateOption" Readonly="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="13" Top="90" Width="72"></Edit>
					<Edit BindDataset="ds_header" Border="Flat" Column="FLOR_2ND" Height="20" Id="ed_flor_2nd" ImeMode="none" Left="178" LeftMargin="4" MaxLength="60" RightMargin="4" Style="sty_ipt_form" TabOrder="19" Top="163" Width="288"></Edit>
					<Edit BindDataset="ds_header" Border="Flat" Column="WALL_2ND" Height="20" Id="ed_wall_2nd" ImeMode="none" Left="178" LeftMargin="4" MaxLength="60" RightMargin="4" Style="sty_ipt_form" TabOrder="18" Top="140" Width="288"></Edit>
					<Edit BindDataset="ds_header" Border="Flat" Column="CEIL_2ND" Height="20" Id="ed_ceil_2nd" ImeMode="none" Left="178" LeftMargin="4" MaxLength="60" RightMargin="4" Style="sty_ipt_form" TabOrder="17" Top="117" Width="288"></Edit>
					<Edit BindDataset="ds_header" Border="Flat" Column="HDRL_2ND" Height="20" Id="ed_hdrl_2nd" ImeMode="none" Left="178" LeftMargin="4" MaxLength="60" RightMargin="4" Style="sty_ipt_form" TabOrder="20" Top="185" Width="288"></Edit>
					<Edit BindDataset="ds_header" Border="Flat" Column="OPER_2ND" Height="20" Id="ed_oper_2nd" ImeMode="none" Left="174" LeftMargin="4" MaxLength="60" RightMargin="4" Style="sty_ipt_form" TabOrder="21" Top="209" Width="288"></Edit>
					<Edit BindDataset="ds_header" Border="Flat" Column="DOOR_2ND" Height="20" Id="ed_door_2nd" ImeMode="none" Left="178" LeftMargin="4" MaxLength="60" RightMargin="4" Style="sty_ipt_form" TabOrder="22" Top="231" Width="288"></Edit>
					<Edit BindDataset="ds_header" Border="Flat" Column="POID_2ND" Height="20" Id="ed_poid_2nd" ImeMode="none" Left="178" LeftMargin="4" MaxLength="60" RightMargin="4" Style="sty_ipt_form" TabOrder="23" Top="255" Width="288"></Edit>
					<Edit BindDataset="ds_header" Border="Flat" Column="CEIL_3ND" Height="20" Id="ed_ceil_3nd" ImeMode="none" Left="477" LeftMargin="4" MaxLength="60" RightMargin="4" Style="sty_ipt_form" TabOrder="29" Top="117" Width="288"></Edit>
					<Edit BindDataset="ds_header" Border="Flat" Column="WALL_3ND" Height="20" Id="ed_wall_3nd" ImeMode="none" Left="477" LeftMargin="4" MaxLength="60" RightMargin="4" Style="sty_ipt_form" TabOrder="30" Top="140" Width="288"></Edit>
					<Edit BindDataset="ds_header" Border="Flat" Column="FLOR_3ND" Height="20" Id="ed_flor_3nd" ImeMode="none" Left="477" LeftMargin="4" MaxLength="60" RightMargin="4" Style="sty_ipt_form" TabOrder="31" Top="163" Width="288"></Edit>
					<Edit BindDataset="ds_header" Border="Flat" Column="HDRL_3ND" Height="20" Id="ed_hdrl_3nd" ImeMode="none" Left="477" LeftMargin="4" MaxLength="60" RightMargin="4" Style="sty_ipt_form" TabOrder="32" Top="185" Width="288"></Edit>
					<Edit BindDataset="ds_header" Border="Flat" Column="OPER_3ND" Height="20" Id="ed_oper_3nd" ImeMode="none" Left="477" LeftMargin="4" MaxLength="60" RightMargin="4" Style="sty_ipt_form" TabOrder="33" Top="208" Width="288"></Edit>
					<Edit BindDataset="ds_header" Border="Flat" Column="DOOR_3ND" Height="20" Id="ed_door_3nd" ImeMode="none" Left="477" LeftMargin="4" MaxLength="60" RightMargin="4" Style="sty_ipt_form" TabOrder="34" Top="231" Width="288"></Edit>
					<Edit BindDataset="ds_header" Border="Flat" Column="POID_3ND" Height="20" Id="ed_poid_3nd" ImeMode="none" Left="477" LeftMargin="4" MaxLength="60" RightMargin="4" Style="sty_ipt_form" TabOrder="35" Top="255" Width="288"></Edit>
					<Edit BindDataset="ds_header" Border="Flat" Column="EXPO_2ND" Height="20" Id="ed_expo_2nd" ImeMode="none" Left="178" LeftMargin="4" MaxLength="60" RightMargin="4" Style="sty_ipt_form" TabOrder="28" Top="371" Width="288"></Edit>
					<Edit BindDataset="ds_header" Border="Flat" Column="HLTN_2ND" Height="20" Id="ed_hltn_2nd" ImeMode="none" Left="178" LeftMargin="4" MaxLength="60" RightMargin="4" Style="sty_ipt_form" TabOrder="27" Top="348" Width="288"></Edit>
					<Edit BindDataset="ds_header" Border="Flat" Column="HBTN_2ND" Height="20" Id="ed_hbtn_2nd" ImeMode="none" Left="178" LeftMargin="4" MaxLength="60" RightMargin="4" Style="sty_ipt_form" TabOrder="26" Top="326" Width="288"></Edit>
					<Edit BindDataset="ds_header" Border="Flat" Column="JAMB_2ND" Height="20" Id="ed_jamb_2nd" ImeMode="none" Left="178" LeftMargin="4" MaxLength="60" RightMargin="4" Style="sty_ipt_form" TabOrder="25" Top="304" Width="288"></Edit>
					<Edit BindDataset="ds_header" Border="Flat" Column="HATC_2ND" Height="20" Id="ed_hatc_2nd" ImeMode="none" Left="178" LeftMargin="4" MaxLength="60" RightMargin="4" Style="sty_ipt_form" TabOrder="24" Top="281" Width="288"></Edit>
					<Edit BindDataset="ds_header" Border="Flat" Column="HATC_3ND" Height="20" Id="ed_hatc_3nd" ImeMode="none" Left="477" LeftMargin="4" MaxLength="60" RightMargin="4" Style="sty_ipt_form" TabOrder="36" Top="282" Width="288"></Edit>
					<Edit BindDataset="ds_header" Border="Flat" Column="JAMB_3ND" Height="20" Id="ed_jamb_3nd" ImeMode="none" Left="477" LeftMargin="4" MaxLength="60" RightMargin="4" Style="sty_ipt_form" TabOrder="37" Top="305" Width="288"></Edit>
					<Edit BindDataset="ds_header" Border="Flat" Column="HBTN_3ND" Height="20" Id="ed_hbtn_3nd" ImeMode="none" Left="477" LeftMargin="4" MaxLength="60" RightMargin="4" Style="sty_ipt_form" TabOrder="38" Top="327" Width="288"></Edit>
					<Edit BindDataset="ds_header" Border="Flat" Column="HLTN_3ND" Height="20" Id="ed_hltn_3nd" ImeMode="none" Left="477" LeftMargin="4" MaxLength="60" RightMargin="4" Style="sty_ipt_form" TabOrder="39" Top="349" Width="288"></Edit>
					<Edit BindDataset="ds_header" Border="Flat" Column="EXPO_3ND" Height="20" Id="ed_expo_3nd" ImeMode="none" Left="477" LeftMargin="4" MaxLength="60" RightMargin="4" Style="sty_ipt_form" TabOrder="40" Top="371" Width="288"></Edit>
				</TabPage>
			</Contents>
		</Tab>
		<Static Color="user6" Font="굴림,9,Bold" Height="20" Id="Static19" Left="19" TabOrder="31" Text="추가&#32;사양" Top="596" VAlign="Middle" Width="102"></Static>
		<Image Height="19" Id="Image0" ImageID="form_bl_title_sub" Left="6" TabOrder="32" Top="594" Width="11"></Image>
		<Shape BKColor="user0" Bottom="640" Height="26" Id="Shape0" Left="4" LineColor="user1" Right="782" TabOrder="33" Top="614" Type="Rectangle" Width="778"></Shape>
		<Static Align="Right" Height="24" Id="Static0" Left="6" Style="sty_lb_search" TabOrder="34" Text="결과물&#32;" Top="615" VAlign="Middle" Width="88"></Static>
		<Static Align="Right" Height="24" Id="Static1" Left="366" Style="sty_lb_search" TabOrder="35" Text="송부방법&#32;" Top="615" VAlign="Middle" Width="112"></Static>
		<Shape BKColor="user0" Bottom="691" Height="26" Id="Shape5" Left="4" LineColor="user1" Right="782" TabOrder="36" Top="665" Type="Rectangle" Width="778"></Shape>
		<Shape BKColor="user0" Bottom="768" Height="77" Id="Shape6" Left="4" LineColor="user1" Right="782" TabOrder="37" Top="691" Type="Rectangle" Width="778"></Shape>
		<Checkbox BindDataset="ds_header" Column="NOREST" Height="18" Id="chk_norest" Left="98" Style="sty_ipt_form_ind" TabOrder="38" Text="불필요" Top="617" Value="FALSE" Width="62"></Checkbox>
		<Checkbox BindDataset="ds_header" Column="REST03" Height="18" Id="chk_rest01" Left="162" Style="sty_ipt_form_ind" TabOrder="39" Text="A3보드" Top="617" Value="FALSE" Width="62"></Checkbox>
		<Checkbox BindDataset="ds_header" Column="REST02" Height="18" Id="chk_rest02" Left="226" Style="sty_ipt_form_ind" TabOrder="40" Text="A2보드" Top="617" Value="FALSE" Width="62"></Checkbox>
		<Checkbox BindDataset="ds_header" Column="REST01" Height="18" Id="chk_rest03" Left="290" Style="sty_ipt_form_ind" TabOrder="41" Text="A1보드" Top="617" Value="FALSE" Width="62"></Checkbox>
		<Checkbox BindDataset="ds_header" Column="DELV01" Height="18" Id="chk_delv01" Left="482" Style="sty_ipt_form_ind" TabOrder="42" Text="데이터" Top="617" Value="FALSE" Width="62"></Checkbox>
		<Checkbox BindDataset="ds_header" Column="DELV02" Height="18" Id="chk_delv02" Left="546" Style="sty_ipt_form_ind" TabOrder="43" Text="택배" Top="617" Value="FALSE" Width="62"></Checkbox>
		<Checkbox BindDataset="ds_header" Column="DELV03" Height="18" Id="chk_delv03" Left="610" Style="sty_ipt_form_ind" TabOrder="44" Text="내방" Top="617" Value="FALSE" Width="62"></Checkbox>
		<Static Align="Right" Height="24" Id="Static2" Left="6" Style="sty_lb_search" TabOrder="45" Text="기&#32;디자인&#32;담당&#32;" Top="665" VAlign="Middle" Width="88"></Static>
		<Static Align="Right" Height="24" Id="Static3" Left="366" Style="sty_lb_search" TabOrder="46" Text="인테리어&#32;시행&#32;예산&#32;" Top="665" VAlign="Middle" Width="112"></Static>
		<Static Align="Right" Height="70" Id="Static5" Left="6" Style="sty_lb_search" TabOrder="47" Text="특기사항&#32;" Top="690" VAlign="Middle" Width="88"></Static>
		<TextArea BindDataset="ds_header" CheckLength="Byte" Column="ZRQCN" Height="70" Id="ta_zrqcn" Left="96" MaxLength="256" Style="sty_ipt_form" TabOrder="48" Top="690" Width="672"></TextArea>
		<Div BKColor="user0" Height="22" Id="div_zrqid" Left="81" OnLoadCompleted="fn_OnLoadCompleted" TabOrder="49" Text="Div0" Top="115" Url="COM::Coms002.xml" Width="182">
			<Contents></Contents>
		</Div>
		<Div BKColor="user0" Height="22" Id="div_ex_kunnr" Left="97" OnLoadCompleted="fn_OnLoadCompleted" TabOrder="50" Text="Div0" Top="668" Url="COM::Coms002.xml" Width="182">
			<Contents></Contents>
		</Div>
		<MaskEdit BindDataset="ds_header" BKColor="user5" Border="Flat" BorderColor="user13" Column="INTER_AMT" Height="20" Id="ed_inter_amt" Left="480" TabOrder="51" Top="668" Value="0" Width="96"></MaskEdit>
		<Static Height="16" Id="Static8" Left="579" TabOrder="52" Text="천원/대&#32;(간접비&#32;포함&#32;기준)" Top="672" Width="161"></Static>
		<Static Align="Right" Height="24" Id="st_rqvbcd" Left="6" Style="sty_lb_search" TabOrder="53" Text="의뢰자&#32;부서&#32;" Top="137" VAlign="Middle" Width="72"></Static>
		<Edit BindDataset="ds_header" Border="Flat" Column="ZRQ_DEPTNM" Enable="FALSE" Height="20" Id="ed_zrq_deptnm" ImeMode="none" Left="81" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="54" Top="141" Width="191"></Edit>
		<Static Color="user6" Font="굴림,9,Bold" Height="20" Id="Static4" Left="19" TabOrder="55" Text="결재" Top="773" VAlign="Middle" Width="102"></Static>
		<Image Height="19" Id="Image1" ImageID="form_bl_title_sub" Left="6" TabOrder="56" Top="771" Width="11"></Image>
		<Shape BKColor="user0" Bottom="819" Height="26" Id="Shape8" Left="4" LineColor="user1" Right="782" TabOrder="57" Top="793" Type="Rectangle" Width="778"></Shape>
		<Static Align="Right" Height="24" Id="Static6" Left="6" Style="sty_lb_search" TabOrder="58" Text="담당&#32;" Top="794" VAlign="Middle" Width="88"></Static>
		<Static Align="Right" Height="24" Id="Static7" Left="286" Style="sty_lb_search" TabOrder="59" Text="팀장&#32;" Top="794" VAlign="Middle" Width="88"></Static>
		<Static Align="Right" Height="24" Id="Static9" Left="518" Style="sty_lb_search" TabOrder="60" Text="부서장&#32;" Top="794" VAlign="Middle" Width="88"></Static>
		<Edit BindDataset="ds_header" Border="Flat" Column="RQ_SA_NM" Enable="FALSE" Height="20" Id="ed_rq_sa_nm" ImeMode="english" Left="96" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="61" Top="796" Width="105"></Edit>
		<Edit BindDataset="ds_header" Border="Flat" Column="RQ_TB_NM" Enable="FALSE" Height="20" Id="ed_rq_tb_nm" ImeMode="english" Left="376" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="62" Top="796" Width="105"></Edit>
		<Edit BindDataset="ds_header" Border="Flat" Column="RQ_DB_NM" Enable="FALSE" Height="20" Id="ed_rq_db_nm" ImeMode="english" Left="608" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="63" Top="796" Width="105"></Edit>
		<Shape BKColor="user0" Bottom="665" Height="26" Id="Shape9" Left="4" LineColor="user1" Right="782" TabOrder="64" Top="639" Type="Rectangle" Width="778"></Shape>
		<Static Align="Right" Height="24" Id="Static10" Left="6" Style="sty_lb_search" TabOrder="65" Text="용도추가&#32;" Top="640" VAlign="Middle" Width="88"></Static>
		<Checkbox BindDataset="ds_header" Column="ADDTUSE01" Height="18" Id="chk_addtuse01" Left="98" Style="sty_ipt_form_ind" TabOrder="66" Text="장애인적용" Top="642" Value="FALSE" Width="90"></Checkbox>
		<Checkbox BindDataset="ds_header" Column="ADDTUSE02" Height="18" Id="chk_addtuse02" Left="201" Style="sty_ipt_form_ind" TabOrder="67" Text="비상용" Top="642" Value="FALSE" Width="62"></Checkbox>
		<Static Height="16" Id="Static12" Left="579" TabOrder="68" Text="천원/대&#32;(간접비&#32;포함&#32;기준)" Top="696" Width="161"></Static>
		<Button Cursor="HAND" Height="20" Id="btn_add" ImageID="btn_icon_plus" Left="729" LeftMargin="12" OnClick="btn_add_OnClick" Style="sty_btn" TabOrder="71" Top="835" Transparent="TRUE" Width="22"></Button>
		<Button Cursor="HAND" Height="20" Id="btn_del" ImageID="btn_icon_minus" Left="756" LeftMargin="12" OnClick="btn_del_OnClick" Style="sty_btn" TabOrder="70" Top="835" Transparent="TRUE" Width="22"></Button>
		<Grid AutoFit="TRUE" AutoFitEndLine="Hide" BindDataset="ds_file" BkColor2="default" BoldHead="true" Border="Flat" Bottom="992" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="134" Id="grd_file" InputPanel="true" Left="7" LineColor="user20" LineType="ExHORZ" MinWidth="100" OnCellDBLClick="grd_file_OnCellDblClick" OnExpandEdit="grd_file_OnExpandEdit" Right="780" RowHeight="20" Style="sty_grid" TabOrder="71" TabStop="true" Top="858" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="773">
			<contents>
				<format id="Default">
					<columns>
						<col width="30"/>
						<col width="30"/>
						<col width="60"/>
						<col width="60"/>
						<col width="275"/>
						<col width="151"/>
					</columns>
					<head>
						<cell align="center" col="0" color="user21" display="text" font="굴림,9" text="No"/>
						<cell align="center" col="1" color="user21" display="text" font="굴림,9" text="변경"/>
						<cell align="center" col="2" color="user21" display="text" font="굴림,9" text="일련번호"/>
						<cell align="center" col="3" color="user21" display="text" font="굴림,9" text="구분"/>
						<cell align="center" col="4" color="user21" display="text" font="굴림,9" text="파일경로"/>
						<cell align="center" col="5" color="user21" display="text" font="굴림,9" text="파일명"/>
					</head>
					<body>
						<cell align="center" col="0" display="text" expr="currow+1"/>
						<cell align="center" bkcolor2="user22" bkimageid='expr:gfn_getFlagBkImageID(getColumn(currow,&#32;&quot;FLAG&quot;))' col="1" display="image"/>
						<cell align="center" bkcolor2="user22" col="2" display="text" expr="currow+1"/>
						<cell align="center" bkcolor2="user22" col="3" colid="ZATGBN" combocol="CODE" combodataset="ds_code_atgbn" combotext="CODE_NAME" display="combo"/>
						<cell align="center" bkcolor2="user22" col="4" colid="ZATTPATH" display="text"/>
						<cell bkcolor2="user22" col="5" colid="ZATTFN" display="text" expandimage="btn_icon_next_01" expandshow="true"/>
					</body>
				</format>
			</contents>
		</Grid>
		<FileDialog Bottom="856" Height="24" Id="fileDialog" Left="540" Right="564" TabOrder="74" Top="832" Width="24"></FileDialog>
		<File Bottom="856" Height="24" Id="f_tmp" Left="613" Right="637" TabOrder="76" Top="832" Width="24"></File>
		<FileDialog Bottom="856" FilePath="c:\" Height="24" Id="saveDialog" Left="676" Right="700" TabOrder="75" Top="832" Type="Save" Width="24"></FileDialog>
		<CyHttpFile Height="24" Id="httpFile" Left="644" Top="832" Width="24"></CyHttpFile>
		<Image Height="19" Id="Image2" ImageID="form_bl_title_sub" Left="6" TabOrder="73" Top="833" Width="11"></Image>
		<Static Color="user6" Font="굴림,9,Bold" Height="20" Id="Static11" Left="19" TabOrder="72" Text="공사계약품의서,&#32;도면,&#32;관련자료" Top="835" VAlign="Middle" Width="301"></Static>
		<Combo BindDataset="ds_header" CodeColumn="CODE" Column="DSNGBN" DataColumn="CODE_NAME" Height="18" Id="cd_dsngbn" InnerDataset="ds_code_dsngbn" Left="80" OnChanged="rd_dsngbn_OnChanged" TabOrder="74" Top="88" Width="191"></Combo>
		<Static Align="Right" Height="24" Id="Static13" Left="278" Style="sty_lb_search" TabOrder="75" Text="수신부서" Top="35" VAlign="Middle" Width="88"></Static>
		<Combo BindDataset="ds_header" CodeColumn="CODE" Column="EMAIL_DEPT" DataColumn="CODE_NAME" Height="18" Id="cd_email_dept" InnerDataset="ds_code_email_dept" Left="368" TabOrder="76" Top="37" Width="191"></Combo>
	</Form>
	<Script><![CDATA[/*
 ******************************************************************************************
 * 기      능   : 
 * 작  성  자   : 
 * 작성  일자   : 
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
#include "LIB::commons.js";	// 공통 스크립트 
#include "LIB::nsfRequest.js";	// 공통 스크립트 
#include "LIB::common_hdel.js";	// 공통 스크립트  /* GNY 추가 */


//=========================================================================================
// [ PART 1 ]
// Form에서 사용될 전역변수를 선언
// FORM에서 사용되는 전역변수는 대문자로 작성하며, F_XXX 의 형태를 갖도록 한다. 
//=========================================================================================
var F_FORM_ID 	= "Ses0451";
var F_FRM_ID 	= "Ses0451";   
//var F_FRM_TITLE = "디자인의뢰요청등록";	// 공통코드 화면명
var F_IS_AGENT  = "";
var F_USER_GBN  = "";
var imgUploadFlg = ""; 					// 권한별 이미지 업로드 여부 "":업로드, "VIEW":보기
var F_SERVER_DIR = "SD";

//=========================================================================================
// [ PART 2 ]
// Form Loading / Unloading 시 작업 정의
//=========================================================================================
function fn_OnLoadCompleted(obj)
{
	gfn_initForm(false);	// Form 로드 이벤트 맨 첫줄에 기술
	fn_init_form();			// 폼 초기화
	div_btn.fn_loadUseBtn("30,60", trim(fa_f_frm_title), "", ""); // 10-승인,30-저장

	F_USER_GBN = right(G_USER_GROUP_B, 2); // 20 : 담당, 30 : 팀장, 40 : 부서장, 50 : 관리자
	F_IS_AGENT = decode(left(G_USER_ID, 1), "9", true, false);

	if(trim(fa_zrqseq_del) == "A"){
		cd_email_dept.Enable = false;
	}
}

/********************************************************************************
* 기      능   : form UnloadCompleted 
********************************************************************************/
function fn_OnUnloadCompleted(obj)
{
	return gfn_isFormUnload(obj);
}

/********************************************************************************
* 기      능   : 폼 초기화
********************************************************************************/
function fn_init_form()
{
	var zrqseq  = ""; if ( IsExistVar("fa_zrqseq" ) ) zrqseq  = trim(fa_zrqseq );
	var qtso_no = ""; if ( IsExistVar("fa_qtso_no") ) qtso_no = trim(fa_qtso_no);
	var qtser   = ""; if ( IsExistVar("fa_qtser"  ) ) qtser   = trim(fa_qtser  );
	var qtseq   = ""; if ( IsExistVar("fa_qtseq"  ) ) qtseq   = trim(fa_qtseq  );
	var hogi    = ""; if ( IsExistVar("fa_hogi"   ) ) hogi    = trim(fa_hogi   );
	var matnr   = ""; if ( IsExistVar("fa_matnr"  ) ) matnr   = trim(fa_matnr  );
	var posnr   = ""; if ( IsExistVar("fa_posnr"  ) ) posnr   = trim(fa_posnr  );
	
	// 2013.06.03
	// 의뢰자 변경가능하도록 수정
	div_zrqid.ed_sman_cd.enable = true;
	div_zrqid.btn_popSman.enable = true;
	
	if ( substr(fa_qtso_no,0,1) = "S" ) { //서비스 견적일때
		ed_gsnam.enable = true; //현장명 수정가능처리
		tab.TabIndex = 1;				  //탭 기본설정
	}
	
	ds_cond.ClearData();
	ds_cond.AddRow();
	ds_cond.SetColumn(0, "MANDT"  , G_MANDT);
	ds_cond.SetColumn(0, "ZRQSEQ" , zrqseq );
	ds_cond.SetColumn(0, "QTSO_NO", qtso_no);
	ds_cond.SetColumn(0, "QTSER"  , qtser  );
	ds_cond.SetColumn(0, "QTSEQ"  , qtseq  );
	ds_cond.SetColumn(0, "HOGI"   , hogi   );
	ds_cond.SetColumn(0, "MATNR"  , matnr  );
	ds_cond.SetColumn(0, "POSNR"  , posnr  );
	
	fn_query_DD07T("ZSDEMAILGBN", ds_code_email_dept); //이메일 수신부서

	fn_query();
}

// 공통코드 조회
function fn_query_DD07T(pDomainId, pDs)
{  
	// 데이타셋 초기화
	ds_cond_dd07t.ClearData();	
	pDs.ClearData();
	
	// 데이타셋 설정
	ds_cond_dd07t.AddRow();
	ds_cond_dd07t.SetColumn(ds_cond_dd07t.row, "DOMNAME"	, pDomainId);  
	ds_cond_dd07t.SetColumn(ds_cond_dd07t.row, "CONCAT_YN"	, "N");  
	
	// 서비스 호출
	nsfRequest(  "query"
			   , "combo/comboDD07T"
			   , "ds_cond_dd07t=ds_cond_dd07t " + pDs.ID+"="+pDs.ID
			   , pDs.ID+"="+pDs.ID +" ds_error=ds_error"
			   , ""
			   , "fn_afterQuery_DD07T_"+pDomainId); 
}


//=========================================================================================
// [ PART 3 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,form닫기)
//=========================================================================================
/********************************************************************************
* 기      능   : 조회
********************************************************************************/
function fn_query()
{
	var inDs =  "ds_cond=ds_cond"
			 + " ds_header=ds_header"
			 + " ds_template=ds_template"
			 + " ds_templateSd120=ds_templateSd120"
			 + " ds_file=ds_file"	
			 + " ds_email=ds_email"		 
	;
	var outDs = "ds_header=ds_header"
			 + " ds_template=ds_template"
			 + " ds_templateSd120=ds_templateSd120"
			 + " ds_file=ds_file"	
			 + " ds_email=ds_email"	
			 + " ds_error=ds_error"
	;

	fn_createWait("",this);     // 처리중입니다. 메시지 처리
	
	nsfRequest("query", "ses0451/find", inDs, outDs, "", "fn_afterQuery");
}

/********************************************************************************
* 기      능   : 저장
********************************************************************************/
function fn_save()
{
	ds_header.SetColumn(0, "ZRQID"   , div_zrqid.ed_sman_cd.Text); // 요청자ID
	ds_header.SetColumn(0, "EX_KUNNR", div_ex_kunnr.ed_sman_cd.Text); // 디자인담당ID
	ds_header.SetColumn(0, "ZRQSEQ_DEL", trim(fa_zrqseq_del  ));
	
	// 필수 체크
	var finDat = ds_header.GetColumn(0, "FINDAT"); // 완료일
	var dsnGbn = ds_header.GetColumn(0, "DSNGBN"); // 디자인구분
	var inter_amt = ds_header.GetColumn(0, "INTER_AMT"); // 인테리어 시행예산
	var chk_norest = ds_header.GetColumn(0, "NOREST"); // 결과물-불필요
	var chk_rest01 = ds_header.GetColumn(0, "REST01"); // 결과물-A1보드
	var chk_rest02 = ds_header.GetColumn(0, "REST02"); // 결과물-A2보드
	var chk_rest03 = ds_header.GetColumn(0, "REST03"); // 결과물-A3보드
	var chk_delv01 = ds_header.GetColumn(0, "DELV01"); // 송부방법-데이터
	var chk_delv02 = ds_header.GetColumn(0, "DELV02"); // 송부방법-택배
	var chk_delv03 = ds_header.GetColumn(0, "DELV03"); // 송부방법-내방
	var chk_addtuse01 = ds_header.GetColumn(0, "ADDTUSE01"); // 추가용도-장애인적용	
	var chk_addtuse02 = ds_header.GetColumn(0, "ADDTUSE02"); // 추가용도-비상용		
	var zrqcn      = ds_header.GetColumn(0, "ZRQCN");  // 특기사항	
	var metr_2nd   = ds_header.GetColumn(0, "METR_2ND");
	var atyp_2nd   = ds_header.GetColumn(0, "ATYP_2ND");
	var aman_2nd   = ds_header.GetColumn(0, "AMAN_2ND");
	var aqty_2nd   = ds_header.GetColumn(0, "AQTY_2ND");
	var aspd_2nd   = ds_header.GetColumn(0, "ASPD_2ND");
	var aflr_2nd   = ds_header.GetColumn(0, "AFLR_2ND");
	var ause_2nd   = ds_header.GetColumn(0, "AUSE_2ND");
	var adoor_2nd  = ds_header.GetColumn(0, "ADOOR_2ND");
	var metr_3nd   = ds_header.GetColumn(0, "METR_3ND");
	var atyp_3nd   = ds_header.GetColumn(0, "ATYP_3ND");
	var aman_3nd   = ds_header.GetColumn(0, "AMAN_3ND");
	var aqty_3nd   = ds_header.GetColumn(0, "AQTY_3ND");
	var aspd_3nd   = ds_header.GetColumn(0, "ASPD_3ND");
	var aflr_3nd   = ds_header.GetColumn(0, "AFLR_3ND");
	var ause_3nd   = ds_header.GetColumn(0, "AUSE_3ND");
	var adoor_3nd  = ds_header.GetColumn(0, "ADOOR_3ND");
	var dsngbn     = cd_dsngbn.Value;
	var gsnam      = ed_gsnam.Text;
	var email_dept = ds_header.GetColumn(0, "EMAIL_DEPT"); //이메일 수신부서
	
	//trace(cd_dsngbn.Value);
	if ( finDat == null || finDat == "" ) { gfn_showAlert("CW00208", "완료일");     return false; } // [${}]은/는 필수입력 입니다. 확인바랍니다.
	if ( dsnGbn == null || dsnGbn == "" ) { gfn_showAlert("CW00208", "디자인구분"); return false; } // [${}]은/는 필수입력 입니다. 확인바랍니다.
	if ( dsnGbn == "I" ) { // 인테리어 사양 선택시 시행예산 필수 입력
		if ( inter_amt == null || inter_amt == "" || inter_amt == "0" ) { gfn_showAlert("CW00208", "인테리어 시행 예산"); return false; } // [${}]은/는 필수입력 입니다. 확인바랍니다.
	}
	if ( !chk_norest && !chk_rest01 && !chk_rest02 && !chk_rest03) {
		gfn_showAlert("CW00208", "결과물"); // [${}]은/는 필수입력 입니다. 확인바랍니다.
		return false;
	}
	if ( !chk_delv01 && !chk_delv02 && !chk_delv03 ) {
		gfn_showAlert("CW00208", "송부방법"); // [${}]은/는 필수입력 입니다. 확인바랍니다.
		return false;
	}
	if ( zrqcn == null || zrqcn == "" ) {
		gfn_showAlert("CW00208", "특기사항"); // [${}]은/는 필수입력 입니다. 확인바랍니다.
		return false;
	}
	if ( dsngbn == null || dsngbn == "") { 
		gfn_showAlert("CW00208", "디자인구분"); // [${}]은/는 필수입력 입니다. 확인바랍니다.
		return false;
	}
	
	if ( gsnam == null || gsnam == "") { 
		gfn_showAlert("CW00208", "현장명"); // [${}]은/는 필수입력 입니다. 확인바랍니다.
		return false;
	}
	//의장승인용샘플, 승인완료샘플 요청시 이메일 수신부서 필수체크
	if( trim(fa_zrqseq_del  ) == "B" || trim(fa_zrqseq_del  ) == "C"){
		if ( email_dept == null || email_dept == "") { 
			gfn_showAlert("CW00208", "수신부서"); // [${}]은/는 필수입력 입니다. 확인바랍니다.
			return false;
		}
	}
	//2013.06.03 
	// 디자인구분에 따른 완료일 지정[발송일 기준: 표준 3일 이후/비표준 6일 이후]
	/*var nDateDiff = toNumber(finDat) - toNumber(ds_header.GetColumn(0, "DLVDAT"));	
	if ( dsnGbn == "S" ) {
		if ( nDateDiff < 3 ) {
			gfn_showAlert("CW10025", "디자인구분이 표준일때 완료일은 발송일 기준 3일 이후로 선택해야 합니다.");
			return false;
		}
	} else if ( dsnGbn == "D") {
		if ( nDateDiff < 6 ) {
			gfn_showAlert("CW10025", "디자인구분이 비표준일 때 완료일은 발송일 기준 6일 이후로 선택해야 합니다.");
			return false;
		}
	}*/
	/* 2안 3안 상세항목 필수 저장 제외처리 20160229
	if ( metr_2nd == null || metr_2nd == "" ) { gfn_showAlert("CW00208", "소재(2안)");     return false; } // [${}]은/는 필수입력 입니다. 확인바랍니다.
	if ( atyp_2nd == null || atyp_2nd == "" ) { gfn_showAlert("CW00208", "기종(2안)");     return false; } // [${}]은/는 필수입력 입니다. 확인바랍니다.
	if ( aman_2nd == null || aman_2nd == "" ) { gfn_showAlert("CW00208", "인승(2안)");     return false; } // [${}]은/는 필수입력 입니다. 확인바랍니다.
	if ( aqty_2nd == null || aqty_2nd == "" ) { gfn_showAlert("CW00208", "대수(2안)");     return false; } // [${}]은/는 필수입력 입니다. 확인바랍니다.
	if ( aspd_2nd == null || aspd_2nd == "" ) { gfn_showAlert("CW00208", "속도(2안)");     return false; } // [${}]은/는 필수입력 입니다. 확인바랍니다.
	if ( aflr_2nd == null || aflr_2nd == "" ) { gfn_showAlert("CW00208", "운행증(2안)");   return false; } // [${}]은/는 필수입력 입니다. 확인바랍니다.
	if ( ause_2nd == null || ause_2nd == "" ) { gfn_showAlert("CW00208", "용도(2안)");     return false; } // [${}]은/는 필수입력 입니다. 확인바랍니다.
	if ( adoor_2nd== null || adoor_2nd== "" ) { gfn_showAlert("CW00208", "도어(2안)");     return false; } // [${}]은/는 필수입력 입니다. 확인바랍니다.
	if ( metr_3nd == null || metr_3nd == "" ) { gfn_showAlert("CW00208", "소재(3안)");     return false; } // [${}]은/는 필수입력 입니다. 확인바랍니다.
	if ( atyp_3nd == null || atyp_3nd == "" ) { gfn_showAlert("CW00208", "기종(3안)");     return false; } // [${}]은/는 필수입력 입니다. 확인바랍니다.
	if ( aman_3nd == null || aman_3nd == "" ) { gfn_showAlert("CW00208", "인승(3안)");     return false; } // [${}]은/는 필수입력 입니다. 확인바랍니다.
	if ( aqty_3nd == null || aqty_3nd == "" ) { gfn_showAlert("CW00208", "대수(3안)");     return false; } // [${}]은/는 필수입력 입니다. 확인바랍니다.
	if ( aspd_3nd == null || aspd_3nd == "" ) { gfn_showAlert("CW00208", "속도(3안)");     return false; } // [${}]은/는 필수입력 입니다. 확인바랍니다.
	if ( aflr_3nd == null || aflr_3nd == "" ) { gfn_showAlert("CW00208", "운행증(3안)");   return false; } // [${}]은/는 필수입력 입니다. 확인바랍니다.
	if ( ause_3nd == null || ause_3nd == "" ) { gfn_showAlert("CW00208", "용도(3안)");     return false; } // [${}]은/는 필수입력 입니다. 확인바랍니다.
	if ( adoor_3nd== null || adoor_3nd== "" ) { gfn_showAlert("CW00208", "도어(3안)");     return false; } // [${}]은/는 필수입력 입니다. 확인바랍니다.
	*/
	// 변경된 정보 있는지 체크
	if ( ! ds_header.GetUpdate() && ! ds_file.GetUpdate()) {
		gfn_showAlert("변경된 정보가 없습니다.");
		return;
	}
	
	if ( !gfn_showConfirm("CI00024", "[저장]") ) { // [저장]을 하시겠습니까?
		return;
	}
	
	// 첨부파일 정리
	ds_del_file.ClearData();
	for ( var i = 0 ; i < ds_file.GetRowCount() ; i++ ) {
		// 일련번호를 재부여한다.
		ds_file.SetColumn(i, "ZRQSEQ", ds_header.GetColumn(0, "ZRQSEQ"));

		// DB처리 완료후, 실제 삭제할 파일을 별도 데이터셋에 저장해둔다.
		if ( ds_file.GetColumn(i, "FLAG") == "D" ) {
			ds_del_file.AddRow();
			ds_del_file.CopyRow(ds_del_file.rowcount-1, ds_file, i);
		}
	}
	var inDs = "ds_header=ds_header"
			 + " ds_file=ds_file"
	;
	var outDs = "ds_header=ds_header"
			 + " ds_file=ds_file"
			 + " ds_error=ds_error"
	;
	
	fn_createWait("",this);     // 처리중입니다. 메시지 처리
	
	nsfRequest("save", "ses0451/save", inDs, outDs, "", "fn_afterSave");
}

/********************************************************************************
* 기      능   : 승인>>전송버튼으로 
********************************************************************************/
function fn_trans(obj)
{
	/*if ( ds_header.GetUpdate() || ds_file.GetUpdate()) {
		var arrMsg = ["내용", "전송"];
		gfn_showAlert("CW10003", arrMsg); // 변경된 ${}이 존재하여 ${}이 불가능합니다. 변경된 정보를 저장후 다시 실행하여 주십시오.
		return;
	}*/
	
	if ( !gfn_showConfirm("CI00024", "[전송]") ) { // [승인]을 하시겠습니까?
		return;
	}
	
	var zrqstat = ds_header.getColumn(0, "ZRQSTAT");
	var rq_sa = ds_header.getColumn(0, "RQ_SA"); // 발신부서 담당자ID - ID가 있으면 승인됨
	var rq_tb = ds_header.getColumn(0, "RQ_TB"); // 발신부서 팀장ID   - ID가 있으면 승인됨
	var rq_db = ds_header.getColumn(0, "RQ_DB"); // 발신부서 부서장ID - ID가 있으면 승인됨
	
	if ( zrqstat == "W" ) { // 작성 상태
		// 대리점
		if ( F_IS_AGENT ) {
			ds_header.setcolumn(0, "RQ_SA", G_SAP_USER_ID);
			ds_header.setcolumn(0, "ZRQSTAT", "R");
		}
		// 영업부
		else {
			//if ( cd_dsngbn.Value != "D" ) {
			    //건설사표준 이외 담당 승인 
				ds_header.setcolumn(0, "RQ_SA", G_SAP_USER_ID);
				ds_header.setcolumn(0, "ZRQSTAT", "R");
			/*} else {
				if ( rq_sa == "" ) {
					ds_header.setcolumn(0, "RQ_SA", G_SAP_USER_ID);
				} else if ( rq_tb == "" ) {
					ds_header.setcolumn(0, "RQ_TB", G_SAP_USER_ID);
				} else if ( rq_db == "" ) {
					ds_header.setcolumn(0, "RQ_DB", G_SAP_USER_ID);
					ds_header.setcolumn(0, "ZRQSTAT", "R");	
				}
		    }*/
		}
	}
	
	var inDs = "ds_header=ds_header"
	;
	var outDs = "ds_header=ds_header"
			 + " ds_error=ds_error"
	;
	
	fn_createWait("",this);     // 처리중입니다. 메시지 처리
	
	nsfRequest("appr", "ses0451/saveZrqstat", inDs, outDs, "", "fn_afterSave");
}

/********************************************************************************
* 기      능   : 승인 버튼 컨트롤
********************************************************************************/
function setButtonStatus()
{
	var zrqseq  = ds_header.getColumn(0, "ZRQSEQ");
	var zrqstat = ds_header.getColumn(0, "ZRQSTAT");
	var rq_sa = ds_header.getColumn(0, "RQ_SA"); // 발신부서 담당자ID - ID가 있으면 승인됨
	var rq_tb = ds_header.getColumn(0, "RQ_TB"); // 발신부서 팀장ID   - ID가 있으면 승인됨
	var rq_db = ds_header.getColumn(0, "RQ_DB"); // 발신부서 부서장ID - ID가 있으면 승인됨
	
	zrqseq = decode(zrqseq, null, "", trim(zrqseq));
	rq_sa = decode(rq_sa, null, "", trim(rq_sa));
	rq_tb = decode(rq_tb, null, "", trim(rq_tb));
	rq_db = decode(rq_db, null, "", trim(rq_db));
	
	// 저장,첨부파일 버튼 제어
	if ( zrqstat != "W" ) { // 작성 상태가 아니면 저장,첨부파일 버튼 제거
		div_btn.btn_save.Enable = false;
		cd_email_dept.Enable = false;
		grd_file.SetCellProp("body", 5, "Expandshow", "false");
		btn_add.Enable = false;
		btn_del.Enable = false;			
	}
	
	div_btn.btn_trans.Enable = false;
	
	// 저장하기전 승인 불가
	if ( length(zrqseq) == 0 ) {
		return;
	}
	
	if ( zrqstat == "W" ) { // 작성 상태
		// 대리점
		if ( F_IS_AGENT ) {
			// 승인이 가능한 경우
			if ( (F_USER_GBN == "50" || F_USER_GBN == "10") && length(rq_sa) == 0 ) { // (담당자) 미승인 상태
				div_btn.btn_trans.Enable = true;
			}
		}
		// 영업부
		else {
			// 승인이 가능한 경우
			if (   ((F_USER_GBN == "50" || F_USER_GBN == "40"|| F_USER_GBN == "20" || F_USER_GBN == "30") && (length(rq_sa) == 0 )) // (담당자) 담당자 미승인
				|| ((F_USER_GBN == "50" || F_USER_GBN == "30") && (length(rq_sa) > 0 && length(rq_tb) == 0 )) // (팀장) 담당자 승인 & 팀장 미승인
				|| ((F_USER_GBN == "50" || F_USER_GBN == "40") && (length(rq_sa) > 0 && length(rq_db) == 0 )) // (부서장) 담당자 승인 & 팀장 승인 & 부서장 미승인
			) {
				div_btn.btn_trans.Enable = true;						
			}
		}
	} else { // 조회 전용
		rd_dsngbn.Enable = false;
		cd_dsngbn.Enable = false;
		ed_zrqtel.Enable = false;
		ed_zrqcel.Enable = false;
		cal_findat.Enable = false;
		
		chk_norest.Enable = false;
		chk_rest01.Enable = false;
		chk_rest02.Enable = false;
		chk_rest03.Enable = false;
		chk_delv01.Enable = false;
		chk_delv02.Enable = false;
		chk_delv03.Enable = false;
		chk_addtuse01.Enable = false;
		chk_addtuse02.Enable = false;				
		
		div_ex_kunnr.ed_sman_cd.Enable = false;
		div_ex_kunnr.ed_sman_nm.Enable = false;
		div_ex_kunnr.btn_popSman.Enable = false;
		
		for ( var i = 0 ; i < tab.tab2.Components.count ; i++ ) {
			var comp = tab.tab2.Components[i];
			if ( comp.GetType() == "Edit" && comp.Enable == true ) {
				comp.Enable = false;
			}
		}
		
		ed_inter_amt.Enable = false;
		ta_zrqcn.Enable = false;
	}
}

/********************************************************************************
* 기      능   : 닫기  
********************************************************************************/
function fn_close()
{
	this.close();
}

/********************************************************************************
* 기      능   : 액셀  
********************************************************************************/
function fn_excel()
{
}

//=========================================================================================
// [ PART 4]
// Callback 함수 정의 : callback 함수명은 메인 함수의 fn_xxxx() 에서 xxxx 부분은 fn_afterXXXX()
// 형태가 되도록 작성 
//=========================================================================================
/********************************************************************************
* 기      능   : 저장 Callback
********************************************************************************/
function fn_afterQuery(svcId, errCode, errMsg)
{
	fn_destroyWait();

	if ( ds_error.GetRowCount() > 0 ) {
		gfn_showAlert("CE00001");
	}
	
	if ( svcId == "query" ) {
		
		var zrqseq = ds_cond.GetColumn(0, "ZRQSEQ");
		var qtso_no = ds_cond.GetColumn(0, "QTSO_NO");
		var qtseq  = ds_cond.GetColumn(0, "QTSEQ");
		var qtser  = ds_cond.GetColumn(0, "QTSER");
		var hogi   = ds_cond.GetColumn(0, "HOGI");
		var vkburgrp = trim(G_SAP_USER_VBNM) + " / " + trim(G_SAP_USER_VGNM);	

		// 요청일련번호가 있으면 조회/수정
		if ( length(zrqseq) > 0 ) {
			ds_header.SetColumn(0, "ZRQ_DEPTNM"	, vkburgrp);
			if (length(trim(ds_header.GetColumn(0,"HOGI"))) == 0) { // 견적의 경우
				st_qtso_no.Text = "견적번호";
				st_qtser.Text   = "차수";
				ed_qtser.Column = "QTSER";				
			} else {
				st_qtso_no.Text = "프로젝트";
				st_qtser.Text   = "호기";
				ed_qtser.Column = "HOGI";
			}
		}
		// 요청일련번호가 없으면 등록
		else {
			if (length(trim(hogi)) == 0) { // 견적의 경우
				st_qtso_no.Text = "견적번호";
				st_qtser.Text   = "차수";
				ed_qtser.Column = "QTSER";				
			} else {
				st_qtso_no.Text = "프로젝트";
				st_qtser.Text   = "호기";
				ed_qtser.Column = "HOGI";
			}
			//trace(cd_dsngbn.Value);
			var dlvDatDefault = today(); // 발송일 기본값 : 작성일 기준, 2시 이후 익일 적용>>>>12시로 변경 2016.01.23 디자인팀요청
			if ( toNumber(substr(getDate(),8,2)) >= 12 ) {
				dlvDatDefault = addDate(dlvDatDefault, 1);
			}
			//2013.06.03 수정
			//완료일 기본값[발송일 기준 3일 이후]  -> 발송일 기준 6일 이후 
			var finDatDefault = addDate(dlvDatDefault, 6); // 완료일 기본값
			//var vkburgrp = trim(G_SAP_USER_VBNM) + " / " + trim(G_SAP_USER_VGNM);
			ds_header.ClearData();
			ds_header.AddRow();
			ds_header.SetColumn(0, "MANDT"  , G_MANDT);
			ds_header.SetColumn(0, "ZRQSEQ" , ""     );
			ds_header.SetColumn(0, "QTSO_NO", qtso_no);
			ds_header.SetColumn(0, "QTSER"  , qtser  );
			ds_header.SetColumn(0, "QTSEQ"  , qtseq  );
			ds_header.SetColumn(0, "HOGI"   , hogi   );
			ds_header.SetColumn(0, "ZRQDAT"		, gfn_getCurrDate()); // 요청일 
			ds_header.SetColumn(0, "DSNGBN"		, ""); // 디자인구분 S : 표준  D: 비표준 
			ds_header.SetColumn(0, "ZRQID"		, G_SAP_USER_ID);	// 요청자 아이디
			ds_header.SetColumn(0, "ZRQNM"		, G_SAP_USER_NAME);	// 요청자 명
			div_zrqid.ed_sman_cd.Text = G_SAP_USER_ID;
			div_zrqid.ed_sman_nm.Text = G_SAP_USER_NAME;
			ds_header.SetColumn(0, "ZRQ_DEPTNM"	, vkburgrp); //G_SAP_USER_VBNM);	// 요청자 부서명
			ds_header.SetColumn(0, "ZRQTEL"		,G_USERTELE); // 요청자 사무실 전화번호
			ds_header.SetColumn(0, "ZRQCEL"		,G_USERMBPN); // 요청자 핸드폰 
			ds_header.SetColumn(0, "ZRQCN"		, ""); // 특기사항
			ds_header.SetColumn(0, "ZRSRLT"     , ""); // 처리결과
			ds_header.SetColumn(0, "ZRQSTAT"	, "W"); // 요청상태 -> 작성
			ds_header.SetColumn(0, "KUNNR_DS"	, ""); // 디자인담당자
			ds_header.SetColumn(0, "DLVDAT"		, dlvDatDefault); // 발송일자
			ds_header.SetColumn(0, "FINDAT"		, finDatDefault); // 완료일자
			ds_header.SetColumn(0, "CEIL_2ND"	, ""); // 카내 천장 (2안)
			ds_header.SetColumn(0, "WALL_2ND"	, ""); // 카내 벽체 (2안)
			ds_header.SetColumn(0, "FLOR_2ND"	, ""); // 카내 바닥 (2안)
			ds_header.SetColumn(0, "HDRL_2ND"	, ""); // 카내 핸드레일 (2안)
			ds_header.SetColumn(0, "OPER_2ND"	, ""); // 카내 운전반 (2안)
			ds_header.SetColumn(0, "DOOR_2ND"	, ""); // 카내 도어 (2안)
			ds_header.SetColumn(0, "POID_2ND"	, ""); // 카내 위치표시기 (2안)
			ds_header.SetColumn(0, "HATC_2ND"	, ""); // 카외 도어 (2안)
			ds_header.SetColumn(0, "JAMB_2ND"	, ""); // 카외 상방틀 (2안)
			ds_header.SetColumn(0, "HBTN_2ND"	, ""); // 카외 홀버튼 (2안)
			ds_header.SetColumn(0, "HLTN_2ND"	, ""); // 카외 홀랜턴 (2안)
			ds_header.SetColumn(0, "EXPO_2ND"	, ""); // 카외 위치표시기 (2안)
			ds_header.SetColumn(0, "CEIL_3ND"	, ""); // 카내 천장 (3안)
			ds_header.SetColumn(0, "WALL_3ND"	, ""); // 카내 벽체 (3안)
			ds_header.SetColumn(0, "FLOR_3ND"	, ""); // 카내 바닥 (3안)
			ds_header.SetColumn(0, "HDRL_3ND"	, ""); // 카내 핸드레일 (3안)
			ds_header.SetColumn(0, "OPER_3ND"	, ""); // 카내 운전반 (3안)
			ds_header.SetColumn(0, "DOOR_3ND"	, ""); // 카내 도어 (3안)
			ds_header.SetColumn(0, "POID_3ND"	, ""); // 카내 위치표시기 (3안)
			ds_header.SetColumn(0, "HATC_3ND"	, ""); // 카외 도어 (3안)
			ds_header.SetColumn(0, "JAMB_3ND"	, ""); // 카외 상방틀 (3안)
			ds_header.SetColumn(0, "HBTN_3ND"	, ""); // 카외 홀버튼 (3안)
			ds_header.SetColumn(0, "HLTN_3ND"	, ""); // 카외 홀랜턴 (3안)
			ds_header.SetColumn(0, "EXPO_3ND"	, ""); // 카외 위치표시기 (3안)
			ds_header.SetColumn(0, "NOREST"		, ""); // 결과물 불필요(Y)
			ds_header.SetColumn(0, "REST01"		, ""); // 결과물 A1보드(Y)
			ds_header.SetColumn(0, "REST02"		, ""); // 결과물 A2보드(Y)
			ds_header.SetColumn(0, "REST03"		, ""); // 결과물 A3보드(Y)
			ds_header.SetColumn(0, "DELV01"		, ""); // 송부방법 데이터(Y)
			ds_header.SetColumn(0, "DELV02"		, ""); // 송부방법 택배(Y)
			ds_header.SetColumn(0, "DELV03"		, ""); // 송부방법 내방(Y)
			ds_header.SetColumn(0, "ADDTUSE01"	, ""); // 추가용도-장애인적용(Y)
			ds_header.SetColumn(0, "ADDTUSE02"	, ""); // 추가용도-비상용(Y)						
			ds_header.SetColumn(0, "EX_KUNNR"	, ""); // 기 디자인 담당
			div_ex_kunnr.ed_sman_cd.Text = "";
			div_ex_kunnr.ed_sman_nm.Text = "";
			ds_header.SetColumn(0, "INTER_AMT"	, "0"); // 인테리어 시행예산
			ds_header.SetColumn(0, "RQ_SA"		, ""); // 발신부서 담당자
			ds_header.SetColumn(0, "RQ_TB"		, ""); // 발신부서 팀장
			ds_header.SetColumn(0, "RQ_DB"		, ""); // 발신부서 부서장
			ds_header.SetColumn(0, "DS_TB"		, ""); // 디자인 팀장
			ds_header.SetColumn(0, "DS_DB"		, ""); // 기술영업 부서장
			var vbeln = ""; if ( IsExistVar("fa_vbeln") ) vbeln = trim(fa_vbeln);
			ds_header.SetColumn(0, "VBELN"		, vbeln); // 수주번호
			var gsnam = ""; if ( IsExistVar("fa_gsnam") ) gsnam = trim(fa_gsnam);
			ds_header.SetColumn(0, "GSNAM"		, gsnam); // 현장명
		}
		
		// 소재
		var nSearchRow = ds_template.SearchRow("PRH=='EL_BWM'");
		if ( length(zrqseq) == 0 ) {
			tab.tab2.ed_bwm2.Text = "";
			tab.tab2.ed_bwm3.Text = "";
			if ( nSearchRow > -1 ) {
				tab.tab2.ed_bwm2.Text = ds_template.GetColumn(nSearchRow, "PRD");
				tab.tab2.ed_bwm3.Text = ds_template.GetColumn(nSearchRow, "PRD");
			}
		}
		var userData = "ELV_01|EL_INSIDE|EL_BWM";
		tab.tab2.ed_bwm2.UserData = userData + "|" + tab.tab2.ed_bwm2.Column;
		tab.tab2.ed_bwm3.UserData = userData + "|" + tab.tab2.ed_bwm3.Column;
		
		// 기종
		var nSearchRow = ds_template.SearchRow("PRH=='EL_ATYP'||PRH=='ES_ATYP'||PRH=='MW_ATYP'");
		var prh = "";
		if ( length(zrqseq) == 0 ) {
			tab.tab2.ed_atyp2.Text = "";
			tab.tab2.ed_atyp3.Text = "";
			if ( nSearchRow > -1 ) {
				tab.tab2.ed_atyp2.Text = ds_template.GetColumn(nSearchRow, "PRD");
				tab.tab2.ed_atyp3.Text = ds_template.GetColumn(nSearchRow, "PRD");
				prh = ds_template.getColumn(nSearchRow, "PRH");
			}
		}
		var userData;
		if ( prh == "ES_ATYP" ) {
			userData = "ESC_01|ES_BASIC|ES_ATYP";
		} else if ( prh == "MW_ATYP" ) {
			userData = "MW_01|MW_BASIC|MW_ATYP";
		} else {
			userData = "ELV_01|EL_BASIC|EL_ATYP";
		}
		tab.tab2.ed_atyp2.UserData = userData + "|" + tab.tab2.ed_atyp2.Column;
		tab.tab2.ed_atyp3.UserData = userData + "|" + tab.tab2.ed_atyp3.Column;
		
		// 인승
		var nSearchRow = ds_template.SearchRow("PRH=='EL_AMAN'");
		if ( length(zrqseq) == 0 ) {
			tab.tab2.ed_aman2.Text = "";
			tab.tab2.ed_aman3.Text = "";
			if ( nSearchRow > -1 ) {
				tab.tab2.ed_aman2.Text = ds_template.GetColumn(nSearchRow, "PRD");
				tab.tab2.ed_aman3.Text = ds_template.GetColumn(nSearchRow, "PRD");
			}
		}
		var userData = "ELV_01|EL_BASIC|EL_AMAN";
		tab.tab2.ed_aman2.UserData = userData + "|" + tab.tab2.ed_aman2.Column;
		tab.tab2.ed_aman3.UserData = userData + "|" + tab.tab2.ed_aman3.Column;
		
		// 대수 - 입력
		if ( length(zrqseq) == 0 ) {
			var znumber = ""; if ( IsExistVar("fa_znumber") ) znumber = trim(fa_znumber);
			tab.tab2.ed_znumber2.Text = znumber;
			tab.tab2.ed_znumber3.Text = znumber;
		}
		
		// 속도
		var nSearchRow = ds_template.SearchRow("PRH=='EL_ASPD'");
		if ( length(zrqseq) == 0 ) {
			tab.tab2.ed_aspd2.Text = "";
			tab.tab2.ed_aspd3.Text = "";
			if ( nSearchRow > -1 ) {
				tab.tab2.ed_aspd2.Text = ds_template.GetColumn(nSearchRow, "PRD");
				tab.tab2.ed_aspd3.Text = ds_template.GetColumn(nSearchRow, "PRD");
			}
		}
		var userData = "ELV_01|EL_BASIC|EL_ASPD";
		tab.tab2.ed_aspd2.UserData = userData + "|" + tab.tab2.ed_aspd2.Column;
		tab.tab2.ed_aspd3.UserData = userData + "|" + tab.tab2.ed_aspd3.Column;
		
		// 운행층 - 입력
		var nSearchRow = ds_template.SearchRow("PRH=='EL_ASTQ'");
		if ( length(zrqseq) == 0 ) {
			tab.tab2.ed_astq2.Text = "";
			tab.tab2.ed_astq3.Text = "";
			if ( nSearchRow > -1 ) {
				tab.tab2.ed_astq2.Text = ds_template.GetColumn(nSearchRow, "PRD");
				tab.tab2.ed_astq3.Text = ds_template.GetColumn(nSearchRow, "PRD");
			}
		}
		
		// 용도
		var nSearchRow = ds_template.SearchRow("PRH=='EL_AUSE'");
		if ( length(zrqseq) == 0 ) {
			tab.tab2.ed_ause2.Text = "";
			tab.tab2.ed_ause3.Text = "";
			if ( nSearchRow > -1 ) {
				tab.tab2.ed_ause2.Text = ds_template.GetColumn(nSearchRow, "PRD");
				tab.tab2.ed_ause3.Text = ds_template.GetColumn(nSearchRow, "PRD");
			}
		}
		var userData = "ELV_01|EL_BASIC|EL_AUSE";
		tab.tab2.ed_ause2.UserData = userData + "|" + tab.tab2.ed_ause2.Column;
		tab.tab2.ed_ause3.UserData = userData + "|" + tab.tab2.ed_ause3.Column;
		
		// 도어
		var nSearchRow = ds_template.SearchRow("PRH=='EL_AOPEN'");
		if ( length(zrqseq) == 0 ) {
			tab.tab2.ed_aopen2.Text = "";
			tab.tab2.ed_aopen3.Text = "";
			if ( nSearchRow > -1 ) {
				tab.tab2.ed_aopen2.Text = ds_template.GetColumn(nSearchRow, "PRD");
				tab.tab2.ed_aopen3.Text = ds_template.GetColumn(nSearchRow, "PRD");
			}
		}
		var userData = "ELV_01|EL_BASIC|EL_AOPEN";
		tab.tab2.ed_aopen2.UserData = userData + "|" + tab.tab2.ed_aopen2.Column;
		tab.tab2.ed_aopen3.UserData = userData + "|" + tab.tab2.ed_aopen3.Column;
		
		div_zrqid.ed_sman_cd.Text = ds_header.GetColumn(0, "ZRQID"); // 요청자ID
		div_zrqid.ed_sman_nm.Text = ds_header.GetColumn(0, "ZRQNM"); // 요청자명
		
		div_ex_kunnr.ed_sman_cd.Text = ds_header.GetColumn(0, "EX_KUNNR"); 	 // 디자인담당ID
		div_ex_kunnr.ed_sman_nm.Text = ds_header.GetColumn(0, "EX_KUNNRNM"); // 디자인담당명
		
		var dsTemp = gfn_drawTemplateSet(ds_template, ds_templateSd120);
		
		// 사양 쪼개기
		var fa  = "ATKLA==";
		var fa1 = fa+quote("EL_BASIC"  )+" || "+fa+quote("ES_BASIC" )+" || "+fa+quote("MW_BASIC" )+" || "+fa+quote("PSD_BASIC")+" || "+fa+quote("AP_BASIC")+" || Substr(PRH,0,3)=="+quote("SV_")+" || Substr(PRH,0,3)=="+quote("SP_");
		var fa2 = fa+quote("EL_INSIDE" )+" || "+fa+quote("ES_OPTION")+" || "+fa+quote("MW_OPTION")+" || "+fa+quote("PSD_SASH" );
		var fa3 = fa+quote("EL_OUTSIDE")+" || "+fa+quote("ES_SAFETY")+" || "+fa+quote("MW_SAFETY")+" || "+fa+quote("PSD_STEEL");
		var fa4 = fa+quote("EL_OPTION" )+" || "+fa+quote("ES_EXTER" )+" || "+fa+quote("MW_EXTER" )+" || "+fa+quote("PSD_ELEC" );
		
		dsTemp.Filter(fa1);
		ds_template1.CopyF(dsTemp);
				
		dsTemp.Filter(fa2);
		ds_template2.CopyF(dsTemp);
		
		dsTemp.Filter(fa3);
		ds_template3.CopyF(dsTemp);
		
		dsTemp.Filter(fa4);
		ds_template4.CopyF(dsTemp);
		
		// 상태에 따른 버튼 제어
		setButtonStatus();
	}
	
}

/********************************************************************************
* 기      능   : 저장 Callback
********************************************************************************/
function fn_afterSave(svcId, errCode, errMsg)
{
	fn_destroyWait();

	if ( ds_error.GetRowCount() > 0 ) {
		gfn_showAlert("CE00001");
		return;
	}
	
	if ( svcId == "save" ) {
	
		//2013.06.03 파일첨부기능 추가 
		for ( var i = 0 ; i < ds_del_file.GetRowCount() ; i++ ) { 		//실제 파일 삭제
			tit_fileDelete(F_SERVER_DIR, ds_del_file.getColumn(i, "ZATTFN"), "");
		}
		ds_del_file.ClearData();

		gfn_showAlert("CI00006", "[저장]"); // ${} 처리를 완료했습니다.
		
	} else if ( svcId == "appr" ) {
		fn_email();// 메일 전송
		gfn_showAlert("CI00006", "[전송]"); // ${} 처리를 완료했습니다.
		
	}

	parent.fn_query();
	
	// 재조회
	ds_cond.ClearData();
	ds_cond.AddRow();
	ds_cond.SetColumn(0, "MANDT" , G_MANDT  );
	ds_cond.SetColumn(0, "ZRQSEQ", ds_header.GetColumn(0, "ZRQSEQ"));



	fn_query();
}

/********************************************************************************
* 기      능   : 메일 전송
********************************************************************************/
function fn_email(obj){

	var body;
	var title;
	var zkun_email;
	var zrqseq_del;
	var vMsg;
	var qtso_no;
	
	zrqseq_del = trim(fa_zrqseq_del  );
	qtso_no = trim(fa_qtso_no);

	if(zrqseq_del=='B'){
		vMsg = "의장승인용샘플신청이 접수되었습니다.\n";
	}else if(zrqseq_del=='C'){
		vMsg = "승인의장 샘플이 접수되었습니다.\n";
	}
	
	for(var i = 0; i < ds_email.GetRowCount(); i++){
	zkun_email = ds_email.GetColumn(i,"EMAIL");
	title = vMSG;
	body = vMSG ;
	body = body + "견적번호 : " + qtso_no;
	//body = body + " 발송일 : " + gfn_getCurrDate();   
		    
		tit_clearActionInfo();	
		tit_callService(
			"COMM_ACT"
			, "sendmail"
			, ""
			, ""
			//, "USER_JUMIN=" + quote(med_jumin1.value+med_jumin2.value)
			//	+ 
			," SEND_USER=ADMIN@HDEL.CO.KR"
				//+ " RECE_USER=SK.KANG@HDEL.CO.KR"
				+ " RECE_USER=" + quote( zkun_email )  
				+ " MESGTITL=" + quote( title ) 
				+ " MESGBODY=" + quote( body ) 
			, ""  //"fn_afterQuery"
			, false
			, true);		
					
	}
}

/********************************************************************************
* 기      능   : 공통코드가 조회된 후의 Callback 함수 
********************************************************************************/
function fn_completeInit(sCode, sDsObj, sCodeType)
{
}

//=========================================================================================
// [ PART 6 ]
// component Event 정의 : 각 Component 별 이벤트 
//=========================================================================================
// 2013.01.10 사양 그리드 값에 대한 tooltip 처리
function tab_template_div_template_grd_template_OnMouseOver(obj,nPosX,nPosY,nRow,nCell,nPivotIndex)
{
	if ( nCell == 2 || nCell == 3 )
	{
		obj.ToolTipText = obj.GetCellText('Body', nRow, nCell);
	}else	{
		obj.ToolTipText = "";
	}
}

function getTemplateOption(obj)
{
	var strData = obj.UserData;
	var arrData = strData.split("|");
	if ( arrData.length > 0 ) {	
		var arg  = "fa_mandt = " + quote(G_MANDT);
			arg += " fa_class = " + quote(arrData[0]);
			arg += " fa_atkla = " + quote(arrData[1]);
			arg += " fa_atnam = " + quote(arrData[2]);
			arg += " fa_where = " + quote("");
	
		var arr = gfn_openPopupUrl("COM::Com0150.xml", true, arg);
		if (arr != null && arr != 0) {
			ds_header.SetColumn(0, arrData[3], Trim(arr[6]));
		}
	}
}

/********************************************************************************
* 기      능   : 첨부파일 추가
********************************************************************************/
function btn_add_OnClick(obj)
{
	var nRow = ds_file.AddRow();
	var nSeq = toNumber(ds_file.Max("ZATTSEQ"));
	if ( nSeq == "" || nSeq == null ) nSeq = 0;
	
	ds_file.setColumn(nRow, "FLAG"   , "I");
	ds_file.setColumn(nRow, "MANDT"  , ds_header.GetColumn(0, "MANDT" ));
	ds_file.setColumn(nRow, "ZRQSEQ" , ds_header.GetColumn(0, "ZRQSEQ"));
	ds_file.SetColumn(nRow, "ZATTSEQ", nSeq+1);
	ds_file.SetColumn(nRow, "ZATGBN", "R"    ); //첨부파일 구분 요청-R, 완료-F
}

/********************************************************************************
* 기      능   : 첨부파일 삭제
********************************************************************************/
function btn_del_OnClick(obj)
{
	var nRow = ds_file.currow;
	if ( nRow > -1 ) {
		var sRowType = ds_file.GetRowType(nRow);
		if ( sRowType == "insert" ) {
			ds_file.DeleteRow(nRow);
		} else {
			ds_file.SetColumn(nRow, "FLAG", "D");
		}
	}
}

/********************************************************************************
* 기      능   : 그리드에서 file upload 입력시 
********************************************************************************/
function grd_file_OnExpandEdit(obj,nRow,nCell,strVal,nPivotIndex)
{
	if ( nCell == obj.GetBindCellIndex("body", "ZATTFN" ) ) {
		var arr = gfn_openFileMgr(
		      F_SERVER_DIR							// fa_serverDir
			, ds_file.getColumn(nRow, "ZATTFN")		// fa_serverFileName
			, ds_file.getColumn(nRow, "ZATTPATH")	// fa_localFileDir
			, ""									// fa_fileType
			, imgUploadFlg							// fa_saveType ("":업로드, "VIEW":보기)
			, true									// fa_isServerSave
			//, 									// fa_saveFileName
			//, false								// fa_isSave
			//, 									// fa_maxFileSize
		);

		if ( arr != null ) {
		   ds_file.setColumn(nRow, "ZATTPATH", arr[0]); // 디렉토리 정보 
		   ds_file.setColumn(nRow, "ZATTFN"  , arr[1]); // 파일명 
		}
	}
}

/********************************************************************************
* 기      능   : 파일 정보 변경
********************************************************************************/
function ds_file_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{
	if ( varOldValue != varNewValue ) {
		if ( ds_file.GetColumn(nRow, "FLAG") != "I" && ds_file.GetColumn(nRow, "FLAG") != "D" ) {
			ds_file.SetColumn(nRow, "FLAG", "U");
		}
	}
}

/********************************************************************************
* 기      능   : 그리드 더블클릭으로 파일 다운로드
********************************************************************************/
function grd_file_OnCellDblClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
	// 2013.04.18 저장되지 않은 파일은 다운로드 불가능
	var zrqseq   = ds_file.GetColumn(nRow, "ZRQSEQ");
	var zattseq  = ds_file.GetColumn(nRow, "ZATTSEQ");
	var zattfn   = ds_file.GetColumn(nRow, "ZATTFN");
	var zattpath = ds_file.GetColumn(nRow, "ZATTPATH");
	if (   length(trim(zrqseq))   == 0
		|| length(trim(zattseq))  == 0
		|| length(trim(zattfn))   == 0
		|| length(trim(zattpath)) == 0
	) {
		gfn_showAlert("CW10025", "파일은 저장한 후에 다운로드할 수 있습니다.");
		return;
	}
	
	var svrFileName = ds_file.GetColumn(nRow, "ZATTFN");
	var orgFileName = ds_file.GetColumn(nRow, "ZATTFN");
	var ext         = gfn_getFileExt(ds_file.getColumn(nRow, "ZATTFN"));

	saveDialog.FileName = orgFileName;
	saveDialog.Filter = "All(*.*)|*.*";	//"Acrobet Reader(*.pdf)|*.pdf|CAD Files(*.dwg)|*.dwg|";
	saveDialog.FilterIndex = "";		//decode(ext, "pdf","0", "1");
    saveDialog.open();

	var idx = indexOf(saveDialog.FileName, ".");
	var fdFileName = saveDialog.FileName;
    var fileName =  decode(idx, -1, fdFileName, substr(fdFileName, 0, indexOf(fdFileName, ".")));
    var localFileName = fileName + "." + ext;

	var rMsg = tit_fileRead(
						httpFile
						, F_SERVER_DIR			// 저장 디렉토리
						, svrFileName			// 서버에서 전송받을 이름
						, saveDialog.FilePath	// 로컬 경로
						, localFileName			// 로컬 파일명
	);
	
	if ( rMsg[0] == "E" ) {
		if ( length(trim(rMsg[1])) > 0 ) {
			gfn_showAlert("CW10025", rMsg[1]);
		} else {
			gfn_showAlert("CW10025", "파일 다운로드에 실패하였습니다.");
		}
	} else {
		gfn_showAlert("CW10025", "파일을 다운로드 하였습니다.");
	}
}

/********************************************************************************
* 기      능   : 디자인 구분값 변경 시
********************************************************************************/
function rd_dsngbn_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	//trace(strCode+strText);
	//완료일 계산
	var strDlvdat = ds_header.GetColumn(0, "DLVDAT");
	var intAdddat;
	
	if (strCode == "A") {	
		intAdddat = 3;		//표준
	} else if ( strCode == "B" ) {
		intAdddat = 6;		//비표준 , 건설사표준안
	} else if ( strCode == "C"|| strCode == "D") {
		intAdddat = 2;		//긴급
	}
	
	var strFindat = addDate(strDlvdat, intAdddat); 
		
	ds_header.SetColumn(0, "FINDAT"		, strFindat); // 완료일자
				
}

]]></Script>
</Window>