<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="470" Id="Com0120" Left="8" OnLoadCompleted="fn_OnLoadCompleted" OnUnloadCompleted="fn_OnUnloadCompleted" PidAttrib="7" Title="공통코드조회" Top="8" Ver="1.0" Width="368" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_error">
				<Contents>
					<colinfo id="IDX" size="256" type="STRING"/>
					<colinfo id="ERRMSG" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_gtype_cd">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_gtype">
				<Contents>
					<colinfo id="Zgtype" size="256" type="STRING"/>
					<colinfo id="Auart" size="256" type="STRING"/>
					<colinfo id="Matnr" size="256" type="STRING"/>
					<colinfo id="Spart" size="256" type="STRING"/>
					<colinfo id="Zprdgbn" size="256" type="STRING"/>
					<record>
						<Auart>ZS01</Auart>
						<Zgtype>VF1</Zgtype>
						<Zgtypename>P8-C060-5/5</Zgtypename>
						<Matnr>L-1000</Matnr>
						<Spart>10</Spart>
					</record>
					<record>
						<Auart>ZS01</Auart>
						<Zgtype>VF2</Zgtype>
						<Zgtypename>P15-C060-10/10</Zgtypename>
						<Matnr>L-1000</Matnr>
						<Spart>10</Spart>
					</record>
					<record>
						<Auart>ZS01</Auart>
						<Zgtype>VF3</Zgtype>
						<Zgtypename>P15-C090-15/15</Zgtypename>
						<Matnr>L-1000</Matnr>
						<Spart>10</Spart>
					</record>
					<record>
						<Auart>ZS01</Auart>
						<Zgtype>SSVF1</Zgtype>
						<Zgtypename>P8-CO60-5/5</Zgtypename>
						<Matnr>L-1000</Matnr>
						<Spart>10</Spart>
					</record>
					<record>
						<Auart>ZS01</Auart>
						<Zgtype>SSVF2</Zgtype>
						<Zgtypename>P15-C090-15/15</Zgtypename>
						<Matnr>L-1000</Matnr>
						<Spart>10</Spart>
					</record>
					<record>
						<Auart>ZS01</Auart>
						<Zgtype>LXVF1</Zgtype>
						<Zgtypename>P15-C090-15/15</Zgtypename>
						<Matnr>L-1000</Matnr>
						<Spart>10</Spart>
					</record>
					<record>
						<Auart>ZS01</Auart>
						<Zgtype>LXVF2</Zgtype>
						<Zgtypename>P17-CO105-20/20</Zgtypename>
						<Matnr>L-1000</Matnr>
						<Spart>10</Spart>
					</record>
					<record>
						<Auart>ZS01</Auart>
						<Zgtype>LXVF3</Zgtype>
						<Zgtypename>P17-CO120-25/25</Zgtypename>
						<Matnr>L-1000</Matnr>
						<Spart>10</Spart>
					</record>
					<record>
						<Auart>ZS01</Auart>
						<Zgtype>FIGL</Zgtype>
						<Zgtypename>P17-C0180-30/30</Zgtypename>
						<Matnr>L-1000</Matnr>
						<Spart>10</Spart>
					</record>
					<record>
						<Auart>ZS01</Auart>
						<Zgtype>I-XEL</Zgtype>
						<Zgtypename>P24-CO240-30/30</Zgtypename>
						<Matnr>L-1000</Matnr>
						<Spart>10</Spart>
					</record>
					<record>
						<Auart>ZS01</Auart>
						<Zgtype>초고속(국내)</Zgtype>
						<Zgtypename>P24-C0360-50/50</Zgtypename>
						<Matnr>L-1000</Matnr>
						<Spart>10</Spart>
					</record>
					<record>
						<Auart>ZS01</Auart>
						<Zgtype>ES1</Zgtype>
						<Zgtypename>WBT-1200-4500</Zgtypename>
						<Matnr>S-1000</Matnr>
						<Spart>10</Spart>
					</record>
					<record>
						<Auart>ZS01</Auart>
						<Zgtype>ES2</Zgtype>
						<Zgtypename>WBB-1200-10000</Zgtypename>
						<Matnr>S-1000</Matnr>
						<Spart>10</Spart>
					</record>
					<record>
						<Auart>ZS01</Auart>
						<Zgtype>ES3</Zgtype>
						<Zgtypename>MLBT-1200-10000</Zgtypename>
						<Matnr>S-1000</Matnr>
						<Spart>10</Spart>
					</record>
					<record>
						<Auart>ZS01</Auart>
						<Zgtype>ES4</Zgtype>
						<Zgtypename>더블구동-1200-15000</Zgtypename>
						<Matnr>S-1000</Matnr>
						<Spart>10</Spart>
					</record>
					<record>
						<Auart>ZS01</Auart>
						<Zgtype>MW</Zgtype>
						<Zgtypename>1200-25000</Zgtypename>
						<Matnr>W-1000</Matnr>
						<Spart>10</Spart>
					</record>
					<record>
						<Auart>ZN01</Auart>
						<Zgtype>STVF(교체)</Zgtype>
						<Zgtypename>P8-C060-15/15</Zgtypename>
						<Matnr>L-1000</Matnr>
						<Spart>10</Spart>
					</record>
					<record>
						<Auart>ZN01</Auart>
						<Zgtype>LXVF(교체)</Zgtype>
						<Zgtypename>P13-C090-15/15</Zgtypename>
						<Matnr>L-1000</Matnr>
						<Spart>10</Spart>
					</record>
					<record>
						<Auart>ZJ01</Auart>
						<Zgtype>APG1</Zgtype>
						<Zgtypename>AETLT18-40</Zgtypename>
						<Matnr>J-1000</Matnr>
						<Spart>20</Spart>
					</record>
					<record>
						<Auart>ZJ01</Auart>
						<Zgtype>APG2</Zgtype>
						<Zgtypename>AAN3-22</Zgtypename>
						<Matnr>J-1000</Matnr>
						<Spart>20</Spart>
					</record>
					<record>
						<Auart>ZJ01</Auart>
						<Zgtype>APG3</Zgtype>
						<Zgtypename>ABC(자전거)</Zgtypename>
						<Matnr>J-1000</Matnr>
						<Spart>20</Spart>
					</record>
					<record>
						<Auart>ZE01</Auart>
						<Zgtype>VF1(해외)</Zgtype>
						<Zgtypename>P750(11)-C060-6/6</Zgtypename>
						<Matnr>L-1000</Matnr>
						<Spart>10</Spart>
					</record>
					<record>
						<Auart>ZE01</Auart>
						<Zgtype>VF2(해외)</Zgtype>
						<Zgtypename>P1000(15)-C060-10/10</Zgtypename>
						<Matnr>L-1000</Matnr>
						<Spart>10</Spart>
					</record>
					<record>
						<Auart>ZE01</Auart>
						<Zgtype>VF3(해외)</Zgtype>
						<Zgtypename>P1000(15)-C090-15/15</Zgtypename>
						<Matnr>L-1000</Matnr>
						<Spart>10</Spart>
					</record>
					<record>
						<Auart>ZE01</Auart>
						<Zgtype>LXVF1(해외)</Zgtype>
						<Zgtypename>P1000(15)-CO90-15/15</Zgtypename>
						<Matnr>L-1000</Matnr>
						<Spart>10</Spart>
					</record>
					<record>
						<Auart>ZE01</Auart>
						<Zgtype>LXVF2(해외)</Zgtype>
						<Zgtypename>P17-CO120-25/25</Zgtypename>
						<Matnr>L-1000</Matnr>
						<Spart>10</Spart>
					</record>
					<record>
						<Auart>ZE01</Auart>
						<Zgtype>FIGL(해외)</Zgtype>
						<Zgtypename>P17-C0180-30/30</Zgtypename>
						<Matnr>L-1000</Matnr>
						<Spart>10</Spart>
					</record>
					<record>
						<Auart>ZE01</Auart>
						<Zgtype>I-XEL(해외)</Zgtype>
						<Zgtypename>P24-C0240-30/30</Zgtypename>
						<Matnr>L-1000</Matnr>
						<Spart>10</Spart>
					</record>
					<record>
						<Auart>ZE01</Auart>
						<Zgtype>초고속(해외)</Zgtype>
						<Zgtypename>P24-CO360-50/50</Zgtypename>
						<Matnr>L-1000</Matnr>
						<Spart>10</Spart>
					</record>
					<record>
						<Auart>ZE01</Auart>
						<Zgtype>SHIP(해외)</Zgtype>
						<Zgtypename>500-30-8/8</Zgtypename>
						<Matnr>L-2000</Matnr>
						<Spart>10</Spart>
					</record>
					<record>
						<Auart>ZE01</Auart>
						<Zgtype>ES(해외)</Zgtype>
						<Zgtypename>MLBT&#32;1200-R4500</Zgtypename>
						<Matnr>S-1000</Matnr>
						<Spart>10</Spart>
					</record>
					<record>
						<Auart>ZE01</Auart>
						<Zgtype>APG(해외)</Zgtype>
						<Zgtypename>AETLT18-40</Zgtypename>
						<Matnr>W-1000</Matnr>
						<Spart>20</Spart>
					</record>
					<record>
						<Auart>ZT01</Auart>
						<Zgtype>VF1(중계)</Zgtype>
						<Zgtypename>P1000(15)-C060-10/10</Zgtypename>
						<Matnr>L-1000</Matnr>
						<Spart>10</Spart>
					</record>
					<record>
						<Auart>ZT01</Auart>
						<Zgtype>SSVF(중계)</Zgtype>
						<Zgtypename>P15-C060-5/5</Zgtypename>
						<Matnr>L-1000</Matnr>
						<Spart>10</Spart>
					</record>
					<record>
						<Auart>ZT01</Auart>
						<Zgtype>VF2(중계)</Zgtype>
						<Zgtypename>P1000(15)-C090-15/15</Zgtypename>
						<Matnr>L-1000</Matnr>
						<Spart>10</Spart>
					</record>
					<record>
						<Auart>ZT01</Auart>
						<Zgtype>LXVF1(중계)</Zgtype>
						<Zgtypename>P15-CO90-15/15</Zgtypename>
						<Matnr>L-1000</Matnr>
						<Spart>10</Spart>
					</record>
					<record>
						<Auart>ZT01</Auart>
						<Zgtype>ES(중계)</Zgtype>
						<Zgtypename>WBT&#32;1200-R4500</Zgtypename>
						<Matnr>S-1000</Matnr>
						<Spart>10</Spart>
					</record>
					<record>
						<Auart>ZF01</Auart>
						<Zgtype>물류</Zgtype>
						<Zgtypename>물류</Zgtypename>
						<Matnr>F-1000</Matnr>
						<Spart>30</Spart>
					</record>
					<record>
						<Auart>ZG01</Auart>
						<Zgtype>PSD</Zgtype>
						<Zgtypename>PSD</Zgtypename>
						<Matnr>G-1000</Matnr>
						<Spart>40</Spart>
					</record>
					<record>
						<Auart>ZC01</Auart>
						<Zgtype>SP(해외)</Zgtype>
						<Zgtypename>부품수출</Zgtypename>
						<Matnr>Y-1000</Matnr>
						<Spart>10</Spart>
					</record>
					<record>
						<Auart>ZE01</Auart>
						<Zgtype>PSD(해외)</Zgtype>
						<Zgtypename>해외PSD</Zgtypename>
						<Matnr>G-1000</Matnr>
						<Spart>40</Spart>
					</record>
					<record>
						<Auart>ZE01</Auart>
						<Zgtype>물류(해외)</Zgtype>
						<Zgtypename>해외물류</Zgtypename>
						<Matnr>F-1000</Matnr>
						<Spart>30</Spart>
					</record>
					<record>
						<Auart>ZR11</Auart>
						<Zgtype>임대수익</Zgtype>
						<Zgtypename>임대수익</Zgtypename>
						<Matnr></Matnr>
						<Spart>10</Spart>
					</record>
					<record>
						<Auart>ZR11</Auart>
						<Zgtype>U-1000</Zgtype>
						<Zgtypename>정기보수</Zgtypename>
						<Matnr>U-1000</Matnr>
						<Spart>10</Spart>
					</record>
					<record>
						<Auart>ZR11</Auart>
						<Zgtype>U-1000J</Zgtype>
						<Zgtypename>주차보수</Zgtypename>
						<Matnr>U-1000</Matnr>
						<Spart>20</Spart>
					</record>
					<record>
						<Auart>ZR11</Auart>
						<Zgtype>U-1000F</Zgtype>
						<Zgtypename>물류보수</Zgtypename>
						<Matnr>U-1000</Matnr>
						<Spart>30</Spart>
					</record>
					<record>
						<Auart>ZR11</Auart>
						<Zgtype>U-1000G</Zgtype>
						<Zgtypename>PSD보수</Zgtypename>
						<Matnr>U-1000</Matnr>
						<Spart>40</Spart>
					</record>
					<record>
						<Auart>ZR13</Auart>
						<Zgtype>NS-100</Zgtype>
						<Zgtypename>수리공사</Zgtypename>
						<Matnr>NS-100</Matnr>
						<Spart>10</Spart>
					</record>
					<record>
						<Auart>ZR12</Auart>
						<Zgtype>NB-100</Zgtype>
						<Zgtypename>부품판매</Zgtypename>
						<Matnr>NB-100</Matnr>
						<Spart>10</Spart>
					</record>
					<record>
						<Auart>ZS01</Auart>
						<Zgtype>국내승강기(기타)</Zgtype>
						<Zgtypename>국내승강기기타</Zgtypename>
						<Matnr>L-1000</Matnr>
						<Spart>10</Spart>
					</record>
					<record>
						<Auart>ZE01</Auart>
						<Zgtype>해외승강기(기타)</Zgtype>
						<Zgtypename>해외승강기기타</Zgtypename>
						<Matnr>L-1000</Matnr>
						<Spart>10</Spart>
					</record>
				</Contents>
			</Dataset>
		</Datasets>
		<Div Height="36" Id="div_btn" TabOrder="4" Text="Div0" Url="WB01::CommBtnForm.xml" Width="368">
			<Contents></Contents>
		</Div>
		<Grid AutoFitEndLine="Hide" BindDataset="ds_gtype_cd" BkColor2="default" BoldHead="true" Border="Flat" Bottom="432" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="384" Id="grd_list" InputPanel="FALSE" Left="8" LineColor="user20" LineType="ExHORZ" OnCellDBLClick="grd_list_OnCellDblClick" OnHeadClick="grd_list_OnHeadClick" OnKeyDown="grd_list_OnKeyDown" OnRButtonDown="grd_list_OnRButtonDown" Right="360" RowHeight="20" Style="sty_grid" TabOrder="-1" TabStop="true" Top="48" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="352">
			<contents>
				<format id="Default">
					<columns>
						<col width="45"/>
						<col width="130"/>
						<col width="150"/>
					</columns>
					<head>
						<cell align="center" col="0" color="user21" display="text" font="굴림,9" text="No"/>
						<cell align="center" col="1" color="user21" display="text" font="굴림,9" text="기종코드"/>
						<cell align="center" col="2" color="user21" display="text" font="굴림,9" text="기종내역"/>
					</head>
					<body>
						<cell align="center" col="0" display="text" expr="currow+1"/>
						<cell align="center" bkcolor2="user22" col="1" colid="CODE" display="text"/>
						<cell align="left" bkcolor2="user22" col="2" colid="CODE" display="text"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Button Appearance="FLAT" ButtonStyle="TRUE" Color="user5" Cursor="HAND" DomainID="btn.confirm" Height="22" Id="btn_confirm" ImageID="btn_comm_confirm_k" Left="144" LeftMargin="20" OnClick="fn_OnClick_btn" TabOrder="0" Text="확인" Top="437" Width="52"></Button>
		<Button Appearance="FLAT" ButtonStyle="TRUE" Color="user5" Cursor="HAND" DomainID="btn.cancel" Height="22" Id="btn_cancel" ImageID="btn_comm_cancel_k" Left="200" LeftMargin="20" OnClick="fn_OnClick_btn" TabOrder="0" Text="취소" Top="437" Width="52"></Button>
	</Form>
	<Script><![CDATA[/*
 ******************************************************************************************
 * 기      능   : 공통코드검색 (Com0120) 팝업
 * 작  성  자   : 이지훈
 * 작성  일자   : 2012.06.26
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 * COMMENT
   1. WFC URL 				: 
   2. WFC OPERATION NAME 	: 
   3. WFC OBJ NAME 			: 
   4. 개발자료 :  
 ******************************************************************************************
*/
#include "LIB::commons.js";	// 공통 스크립트 
#include "LIB::nsfRequest.js";	// 공통 스크립트  /* GNY 추가 */
#include "LIB::common_hdel.js";	// 공통 스크립트  /* GNY 추가 */
//=========================================================================================
// [ PART 1 ]
// Form에서 사용될 전역변수를 선언
// FORM에서 사용되는 전역변수는 대문자로 작성하며, F_XXX 의 형태를 갖도록 한다. 
//=========================================================================================
 
==========================================================================
// [ PART 2 ]
// Form Loading / Unloading 시 작업 정의
//=========================================================================================
function fn_OnLoadCompleted(obj) {

	gfn_initForm();		// Form 로드 이벤트 맨 첫줄에 기술 
	
	div_btn.fn_loadUseBtn("", "기종조회", "", "");   	// 화면제목 설정 및 버튼 활성화
	
	// 서비스호출
	nsfRequest("query"															// srvId
				, "combo/comboGtype"											// url
				, "ds_gtype_cd=ds_gtype_cd ds_gtype=ds_gtype"					// inDsList
				, "ds_gtype_cd=ds_gtype_cd ds_gtype=ds_gtype ds_error=ds_error"	// outDsList
				, ""															// strParam
				, "fn_afterQuery"												// CallBackFunc
				);
}

/********************************************************************************
* 기      능   : 조회 (header 조회)
********************************************************************************/
function fn_query() { 
}
/********************************************************************************
* 기      능   : 조회 Callback  
********************************************************************************/
function fn_afterQuery(errCode, errMsg) {
trace(ds_gtype.SaveXML());
}

/********************************************************************************
* 기      능   : 공통코드가 조회된 후의 Callback 함수 
********************************************************************************/
function fn_completeInit(sCode, sDsObj, sCodeType) {
}
/********************************************************************************
* 기      능   : form UnloadCompleted 
********************************************************************************/
function fn_OnUnloadCompleted(obj) {
	return gfn_isFormUnload(obj);
}
//=========================================================================================
// [ PART 3 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,form닫기)
//=========================================================================================

/********************************************************************************
* 기      능   : 닫기  
********************************************************************************/
function fn_close() {
	close();
}
/********************************************************************************
* 기      능   : 그리드 헤더 클릭시 정렬 처리 
********************************************************************************/
function grd_list_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
{
	if ( nCell == 0 ) {
		gfn_selectGridCol("grd_list"); // 현재 처리할 format 기억
	} else {
		gfn_sortGrid(obj,nCell);
	}
} 
 
function fn_OnClick_btn(obj)
{
	var fncName = "fn_" + substr(obj.id, 4); 
	eval( fncName + "()");
}

/********************************************************************************
* 기      능   : 액셀 (버튼 클릭 시)
********************************************************************************/
function fn_excel() {
}

/********************************************************************************
* 기      능   : 확인버튼 클릭 시
********************************************************************************/
function fn_confirm() { 
	var arr;
	if (ds_gtype_cd.GetColumn(ds_gtype_cd.row, 'CODE')==ds_gtype.GetColumn(ds_gtype_cd.row, 'Zgtype'))
	{
		arr = [
					  ds_gtype.GetColumn(ds_gtype_cd.row, 'Zgtype') 		// 기종코드
					, ds_gtype.GetColumn(ds_gtype_cd.row, 'Auart')		// 판매문서유형
					, ds_gtype.GetColumn(ds_gtype_cd.row, 'Matnr')		// 자재번호
					, ds_gtype.GetColumn(ds_gtype_cd.row, 'Spart')		// 제품군
				  ];
	}
	else
	{
		var i=0;
		for (i=0;i<ds_gtype.RowCount();i++)
		{
			if (ds_gtype_cd.GetColumn(ds_gtype_cd.row, 'CODE')==ds_gtype.GetColumn(i, 'Zgtype'))
			{
				arr = [
							  ds_gtype.GetColumn(i, 'Zgtype') 		// 기종코드
							, ds_gtype.GetColumn(i, 'Auart')		// 판매문서유형
							, ds_gtype.GetColumn(i, 'Matnr')		// 자재번호
							, ds_gtype.GetColumn(i, 'Spart')		// 제품군
						  ];
				break;
			}
		}
	}
	/*// 선택된 거래선코드, 거래선명을 배열에 담는다.
	arr = [
				  ds_gtype_cd.GetColumn(ds_gtype_cd.row, 'Zgtype') 		// 기종코드
				, ds_gtype_cd.GetColumn(ds_gtype_cd.row, "CODE_NAME")	// 기종명
			  ];*/
	Trace(arr);
	close(arr);	// 배열을 연동화면으로 전송하고 팝업화면을 닫는다.
	  
}

/********************************************************************************
// 취소버튼 클릭 시
********************************************************************************/
function fn_cancel(obj)
{  
	fn_OnClick_btn(btn_close); 	// 팝업화면을 닫는다.
} 
 

function grd_list_OnCellDblClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
	fn_OnClick_btn(btn_confirm);  // 조회 호출
}

function grd_list_OnKeyDown(obj,nChar,bShift,bCtrl,bAlt,nLLParam,nHLParam)
{
	if (nChar==13)
	{
		fn_OnClick_btn(btn_confirm);  // 확인버튼 클릭 호출
	}
}
]]></Script>
</Window>