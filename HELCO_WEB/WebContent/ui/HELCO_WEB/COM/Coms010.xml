<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="53" Id="Coms010" Left="8" OnLoadCompleted="fn_OnLoadCompleted" OnUnloadCompleted="fn_OnUnloadCompleted" PidAttrib="7" Title="템플릿" Top="8" Ver="1.0" Width="978" WorkArea="true">
		<Shape BKColor="user0" Bottom="53" Height="53" Id="Shape0" Left="0" LineColor="user1" Right="978" TabOrder="0" Top="0" Type="Rectangle" Width="978"></Shape>
		<Static Align="Right" Height="24" Id="Static0" Left="1" Style="sty_lb_search" TabOrder="1" Text="견적일&#32;" Top="1" VAlign="Middle" Width="80"></Static>
		<Calendar Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_qtdat_fm" Left="83" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="2" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="3" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="80"></Calendar>
		<Static Align="Center" Border="None" Color="user7" Font="굴림,9" Height="20" Id="st_gubun0" Left="163" TabOrder="3" Text="~" Top="3" VAlign="Middle" Width="18"></Static>
		<Calendar Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_qtdat_to" Left="181" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="4" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="3" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="80"></Calendar>
		<Div BKColor="user0" Height="50" Id="div_vbvg" Left="300" OnLoadCompleted="fn_OnLoadCompleted" OnTimer="WB0199010A_OnTimer" TabOrder="12" Text="Div0" Top="1" Url="COM::Coms013.xml" Width="244">
			<Contents></Contents>
		</Div>
		<Static Align="Right" Height="24" Id="Static2" Left="600" Style="sty_lb_search" TabOrder="4" Text="입찰결과" Top="1" VAlign="Middle" Width="80"></Static>
		<Combo Border="Flat" CodeColumn="CODE" Column="CODE_NAME" DataColumn="CODE_NAME" Height="20" Id="cb_zprgflg" Left="682" Style="sty_ipt_form" TabOrder="9" Top="3" Width="80"></Combo>
		<Static Align="Right" Height="24" Id="Static3" Left="1" Style="sty_lb_search" TabOrder="8" Text="예상수주일&#32;" Top="27" VAlign="Middle" Width="80"></Static>
		<Calendar Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_zestdat_fm" Left="83" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="5" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="29" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="80"></Calendar>
		<Static Align="Center" Border="None" Color="user7" Font="굴림,9" Height="20" Id="st_gubun1" Left="163" TabOrder="6" Text="~" Top="29" VAlign="Middle" Width="18"></Static>
		<Calendar Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_zestdat_to" Left="181" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="7" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="29" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="80"></Calendar>
		<Static Align="Right" Height="24" Id="Static5" Left="600" Style="sty_lb_search" TabOrder="9" Text="담당자" Top="27" VAlign="Middle" Width="80"></Static>
		<Div BKColor="user0" Height="22" Id="div_sman" Left="682" OnLoadCompleted="fn_OnLoadCompleted" OnTimer="WB0199010A_OnTimer" TabOrder="10" Text="Div0" Top="29" Url="COM::Coms002.xml" Width="280">
			<Contents></Contents>
		</Div>
		<Combo Border="Flat" CodeColumn="CODE" Column="CODE_NAME" DataColumn="CODE_NAME" Height="20" Id="cb_zpstat" Left="835" Style="sty_ipt_form" TabOrder="16" Top="3" Width="133"></Combo>
		<Static Align="Right" Height="24" Id="st_pst" Left="765" Style="sty_lb_search" TabOrder="15" Text="진행상태&#32;" Top="2" VAlign="Middle" Width="68"></Static>
	</Form>
	<Script><![CDATA[/*
 ******************************************************************************************
 * 기      능   : 
 * 작  성  자   : 
 * 작성  일자   : 
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
#include "LIB::commons.js";	// 공통 스크립트 
#include "LIB::nsfRequest.js";	// 공통 스크립트 
#include "LIB::common_hdel.js";	// 공통 스크립트  /* GNY 추가 */
//=========================================================================================

function fn_OnLoadCompleted(obj)
{
	fn_init_form();
}

/********************************************************************************
* 기      능   : 폼 초기화
********************************************************************************/
function fn_init_form() {

	div_vbvg.Static1.left = 0;
	div_vbvg.Static1.top = 26;
	div_vbvg.cb_frvg.left = 83;
	div_vbvg.cb_frvg.top = 27;
	div_vbvg.Static2.visible = false;
	div_vbvg.ed_sman_cd.visible = false;
	div_vbvg.btn_popSman.visible = false;

	// Dataset 동적생성
	Create("dataset", "ds_zprgflg1");
	object("ds_zprgflg1").AddColumn("CODE", "STRING", 256);
	object("ds_zprgflg1").AddColumn("CODE_NAME", "STRING", 256);

	ds_zprgflg1.DeleteAll();
	ds_zprgflg1.AddRow();

	ds_zprgflg1.SetColumn(0,"CODE","SD108");
	ds_zprgflg1.SetColumn(0,"CODE_NAME","SD108");
	fn_nsfRequest("combo","comboXml","ds_zprgflg1=ds_zprgflg1","ds_zprgflg1=ds_zprgflg1","fn_completeInit");
	
	// Dataset 동적생성
	Create("dataset", "ds_zpstat");
	object("ds_zpstat").AddColumn("CODE", "STRING", 256);
	object("ds_zpstat").AddColumn("CODE_NAME", "STRING", 256);

	ds_zpstat.DeleteAll();
	ds_zpstat.AddRow();

	ds_zpstat.SetColumn(0,"CODE","SD107");
	ds_zpstat.SetColumn(0,"CODE_NAME","SD107");
	fn_nsfRequest("combo","comboXml","ds_zpstat=ds_zpstat","ds_zpstat=ds_zpstat","fn_completeInit");
	
	cal_qtdat_fm.Value = substr(gfn_getCurrDate(),0,6) + "01";
	cal_qtdat_to.Value = gfn_getCurrDate();

	cal_zestdat_fm.Value = '';
	cal_zestdat_to.Value = '';
	
	/*var codeArr = ["SD107"]; 	//코드콤보 설정
	var dsObjArr = [ds_zpstat];
	var addTypeArr = [G_CODE_ALL];
	gfn_searchCommCode(codeArr, dsObjArr, addTypeArr);*/
} 

/********************************************************************************
* 기      능   : 컨트롤러 전송
********************************************************************************/
function fn_nsfRequest(url1,url2,ds1,ds2,callback) {
	nsfRequest("query", url1+"/"+url2, ds1, ds2+" ds_error=ds_error", "", callback);
}

/********************************************************************************
* 기      능   : 공통코드가 조회된 후의 Callback 함수 
********************************************************************************/
function fn_completeInit(sCode, sDsObj, sCodeType) {
	var code_name = gfn_getCodeNameHdel(G_CODE_ALL);

	ds_zprgflg1.InsertRow(0); 

	ds_zprgflg1.SetColumn(ds_zprgflg1.row, "CODE", "");
	ds_zprgflg1.SetColumn(ds_zprgflg1.row, "CODE_NAME", code_name);
	ds_zprgflg1.ApplyChange();  
	
	cb_zprgflg.InnerDataset = "ds_zprgflg1";
	cb_zprgflg.index = 0;
	
	ds_zpstat.InsertRow(0); 

	ds_zpstat.SetColumn(ds_zpstat.row, "CODE", "");
	ds_zpstat.SetColumn(ds_zpstat.row, "CODE_NAME", code_name);
	ds_zpstat.ApplyChange();

	cb_zpstat.InnerDataset = "ds_zpstat";
	cb_zpstat.index = 0;

	cal_qtdat_fm.SetFocus();
}

function fn_OnUnloadCompleted(obj)
{
	Destroy("ds_zprgflg1");
}]]></Script>
</Window>