<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="800" Id="QM1001002B" Left="8" OnLoadCompleted="fn_OnLoadCompleted" OnUnloadCompleted="fn_OnUnloadCompleted" PidAttrib="7" Title="Lab.,&#32;정밀측정실&#32;의뢰" Top="8" Ver="1.0" Width="792" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_cond">
				<Contents>
					<colinfo id="FORMGBN" size="256" summ="default" type="STRING"/>
					<colinfo id="REQSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="MANDT" size="256" summ="default" type="STRING"/>
					<record>
						<FORMGBN></FORMGBN>
						<MANDT></MANDT>
						<REQSEQ></REQSEQ>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Editable="True" Id="ds_master">
				<Contents>
					<colinfo id="REQSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="TITLE" size="256" summ="default" type="STRING"/>
					<colinfo id="FORMGBN" size="256" summ="default" type="STRING"/>
					<colinfo id="STATCD" size="256" summ="default" type="STRING"/>
					<colinfo id="GOODSGBN" size="256" summ="default" type="STRING"/>
					<colinfo id="REQDT" size="256" summ="default" type="STRING"/>
					<colinfo id="REQGBN" size="256" summ="default" type="STRING"/>
					<colinfo id="REQVENDNM" size="256" summ="default" type="STRING"/>
					<colinfo id="REQID" size="256" summ="default" type="STRING"/>
					<colinfo id="REQNM" size="256" summ="default" type="STRING"/>
					<colinfo id="REQCELL" size="256" summ="default" type="STRING"/>
					<colinfo id="BFMATNR" size="256" summ="default" type="STRING"/>
					<colinfo id="FTREPORTCD" size="256" summ="default" type="STRING"/>
					<colinfo id="REQATTDCD" size="256" summ="default" type="STRING"/>
					<colinfo id="TECHATTDCD" size="256" summ="default" type="STRING"/>
					<colinfo id="TESTGBN" size="256" summ="default" type="STRING"/>
					<colinfo id="TESTGBN_ETCTXT" size="256" summ="default" type="STRING"/>
					<colinfo id="SMPCNT" size="256" summ="default" type="STRING"/>
					<colinfo id="CPNCD" size="256" summ="default" type="STRING"/>
					<colinfo id="CPNNM" size="256" summ="default" type="STRING"/>
					<colinfo id="SMPQLT" size="256" summ="default" type="STRING"/>
					<colinfo id="GOODSNM" size="256" summ="default" type="STRING"/>
					<colinfo id="MODELNM" size="256" summ="default" type="STRING"/>
					<colinfo id="LAWRQ_CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="LAWRQ_CHKLSTYN" size="256" summ="default" type="STRING"/>
					<colinfo id="LAWRQ_CONTYN" size="256" summ="default" type="STRING"/>
					<colinfo id="LAWRQ_NAYN" size="256" summ="default" type="STRING"/>
					<colinfo id="ATT_CNFRMYN" size="256" summ="default" type="STRING"/>
					<colinfo id="ATT_SPECYN" size="256" summ="default" type="STRING"/>
					<colinfo id="ATT_BPYN" size="256" summ="default" type="STRING"/>
					<colinfo id="ATT_CHKLSTYN" size="256" summ="default" type="STRING"/>
					<colinfo id="ATT_PAXYN" size="256" summ="default" type="STRING"/>
					<colinfo id="ATT_KCSYN" size="256" summ="default" type="STRING"/>
					<colinfo id="ATT_FTFLOWYN" size="256" summ="default" type="STRING"/>
					<colinfo id="ATT_STRPTYN" size="256" summ="default" type="STRING"/>
					<colinfo id="ATT_IMPRPTYN" size="256" summ="default" type="STRING"/>
					<colinfo id="ATT_NAYN" size="256" summ="default" type="STRING"/>
					<colinfo id="HOGI" size="256" summ="default" type="STRING"/>
					<colinfo id="SPEC" size="256" summ="default" type="STRING"/>
					<colinfo id="CTESTYMD" size="256" summ="default" type="STRING"/>
					<colinfo id="BOSUCONTACT" size="256" summ="default" type="STRING"/>
					<colinfo id="ETC" size="256" summ="default" type="STRING"/>
					<colinfo id="THOGI" size="256" summ="default" type="STRING"/>
					<colinfo id="ATYPE" size="256" summ="default" type="STRING"/>
					<colinfo id="AUSE" size="256" summ="default" type="STRING"/>
					<colinfo id="PCNT" size="256" summ="default" type="STRING"/>
					<colinfo id="CAPA" size="256" summ="default" type="STRING"/>
					<colinfo id="STCNT" size="256" summ="default" type="STRING"/>
					<colinfo id="DOMETER" size="256" summ="default" type="STRING"/>
					<colinfo id="ABYN" size="256" summ="default" type="STRING"/>
					<colinfo id="TMSPEC" size="256" summ="default" type="STRING"/>
					<colinfo id="CONSOLE" size="256" summ="default" type="STRING"/>
					<colinfo id="INVERTER" size="256" summ="default" type="STRING"/>
					<colinfo id="ROPE_MG" size="256" summ="default" type="STRING"/>
					<colinfo id="ROPING" size="256" summ="default" type="STRING"/>
					<colinfo id="COMPENCHAIN" size="256" summ="default" type="STRING"/>
					<colinfo id="RAIL_CC" size="256" summ="default" type="STRING"/>
					<colinfo id="GUIDESHOE_CAR" size="256" summ="default" type="STRING"/>
					<colinfo id="GUIDESHOE_CWT" size="256" summ="default" type="STRING"/>
					<colinfo id="BRAKESPEC" size="256" summ="default" type="STRING"/>
					<colinfo id="REGULATOR" size="256" summ="default" type="STRING"/>
					<colinfo id="STOPEQP" size="256" summ="default" type="STRING"/>
					<colinfo id="USEYN" size="256" summ="default" type="STRING"/>
					<colinfo id="CREID" size="256" summ="default" type="STRING"/>
					<colinfo id="CREDT" size="256" summ="default" type="STRING"/>
					<colinfo id="MODID" size="256" summ="default" type="STRING"/>
					<colinfo id="MODDT" size="256" summ="default" type="STRING"/>
					<colinfo id="DEGREE" size="256" summ="default" type="STRING"/>
					<colinfo id="VELOCITY" size="256" summ="default" type="STRING"/>
					<colinfo id="MANDT" size="256" summ="default" type="STRING"/>
					<colinfo id="IMP_FILENM" size="256" summ="default" type="STRING"/>
					<colinfo id="IMP_FILEPATH" size="256" summ="default" type="STRING"/>
					<colinfo id="IMP_FILENM_APP" size="256" summ="default" type="STRING"/>
					<colinfo id="BLOCKCD" size="256" summ="default" type="STRING"/>
					<colinfo id="POSITIONNM" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_error">
				<Contents>
					<colinfo id="IDX" size="256" type="STRING"/>
					<colinfo id="ERRMSG" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_file">
				<Contents>
					<colinfo id="FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="REQSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="FILESEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="FILENM" size="256" summ="default" type="STRING"/>
					<colinfo id="FILEPATH" size="256" summ="default" type="STRING"/>
					<colinfo id="FILENM_APP" size="256" summ="default" type="STRING"/>
					<colinfo id="FILESIZE" size="256" summ="default" type="STRING"/>
					<colinfo id="TEMP" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset CanColumnChange="ds_test_CanColumnChange" DataSetType="Dataset" Editable="True" Id="ds_test">
				<Contents>
					<colinfo id="CHECK" size="256" summ="default" type="STRING"/>
					<colinfo id="REQSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="TESTSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="TESTNM" size="256" summ="default" type="STRING"/>
					<colinfo id="TESTCONT1" size="256" summ="default" type="STRING"/>
					<colinfo id="TESTCONT2" size="256" summ="default" type="STRING"/>
					<colinfo id="USEYN" size="256" summ="default" type="STRING"/>
					<colinfo id="CREID" size="256" summ="default" type="STRING"/>
					<colinfo id="CREDT" size="256" summ="default" type="STRING"/>
					<colinfo id="MODID" size="256" summ="default" type="STRING"/>
					<colinfo id="MODDT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_code_reqgbn">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE>M</CODE>
						<CODE_NAME>기계</CODE_NAME>
					</record>
					<record>
						<CODE>E</CODE>
						<CODE_NAME>전기</CODE_NAME>
					</record>
					<record>
						<CODE>D</CODE>
						<CODE_NAME>의장</CODE_NAME>
					</record>
					<record>
						<CODE>P</CODE>
						<CODE_NAME>프로그램</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_code_goodsgbn">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE>E/L</CODE>
						<CODE_NAME>E/L</CODE_NAME>
					</record>
					<record>
						<CODE>E/S</CODE>
						<CODE_NAME>E/S</CODE_NAME>
					</record>
					<record>
						<CODE>ETC</CODE>
						<CODE_NAME>기타</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_code_testgbn">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE>DEV</CODE>
						<CODE_NAME>개발품</CODE_NAME>
					</record>
					<record>
						<CODE>DCB</CODE>
						<CODE_NAME>DCB</CODE_NAME>
					</record>
					<record>
						<CODE>4MC</CODE>
						<CODE_NAME>4M변경</CODE_NAME>
					</record>
					<record>
						<CODE>FIX</CODE>
						<CODE_NAME>정기시험</CODE_NAME>
					</record>
					<record>
						<CODE>REF</CODE>
						<CODE_NAME>참고용</CODE_NAME>
					</record>
					<record>
						<CODE>ETC</CODE>
						<CODE_NAME>기타</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Editable="True" Id="ds_master_chk">
				<Contents>
					<colinfo id="REQSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="TITLE" size="256" summ="default" type="STRING"/>
					<colinfo id="FORMGBN" size="256" summ="default" type="STRING"/>
					<colinfo id="STATCD" size="256" summ="default" type="STRING"/>
					<colinfo id="GOODSGBN" size="256" summ="default" type="STRING"/>
					<colinfo id="REQDT" size="256" summ="default" type="STRING"/>
					<colinfo id="REQGBN" size="256" summ="default" type="STRING"/>
					<colinfo id="REQVENDNM" size="256" summ="default" type="STRING"/>
					<colinfo id="REQID" size="256" summ="default" type="STRING"/>
					<colinfo id="REQNM" size="256" summ="default" type="STRING"/>
					<colinfo id="REQCELL" size="256" summ="default" type="STRING"/>
					<colinfo id="BFMATNR" size="256" summ="default" type="STRING"/>
					<colinfo id="FTREPORTCD" size="256" summ="default" type="STRING"/>
					<colinfo id="REQATTDCD" size="256" summ="default" type="STRING"/>
					<colinfo id="TECHATTDCD" size="256" summ="default" type="STRING"/>
					<colinfo id="TESTGBN" size="256" summ="default" type="STRING"/>
					<colinfo id="TESTGBN_ETCTXT" size="256" summ="default" type="STRING"/>
					<colinfo id="SMPCNT" size="256" summ="default" type="STRING"/>
					<colinfo id="CPNCD" size="256" summ="default" type="STRING"/>
					<colinfo id="CPNNM" size="256" summ="default" type="STRING"/>
					<colinfo id="SMPQLT" size="256" summ="default" type="STRING"/>
					<colinfo id="GOODSNM" size="256" summ="default" type="STRING"/>
					<colinfo id="MODELNM" size="256" summ="default" type="STRING"/>
					<colinfo id="LAWRQ_CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="LAWRQ_CHKLSTYN" size="256" summ="default" type="STRING"/>
					<colinfo id="LAWRQ_CONTYN" size="256" summ="default" type="STRING"/>
					<colinfo id="LAWRQ_NAYN" size="256" summ="default" type="STRING"/>
					<colinfo id="ATT_CNFRMYN" size="256" summ="default" type="STRING"/>
					<colinfo id="ATT_SPECYN" size="256" summ="default" type="STRING"/>
					<colinfo id="ATT_BPYN" size="256" summ="default" type="STRING"/>
					<colinfo id="ATT_CHKLSTYN" size="256" summ="default" type="STRING"/>
					<colinfo id="ATT_PAXYN" size="256" summ="default" type="STRING"/>
					<colinfo id="ATT_KCSYN" size="256" summ="default" type="STRING"/>
					<colinfo id="ATT_FTFLOWYN" size="256" summ="default" type="STRING"/>
					<colinfo id="ATT_STRPTYN" size="256" summ="default" type="STRING"/>
					<colinfo id="ATT_IMPRPTYN" size="256" summ="default" type="STRING"/>
					<colinfo id="ATT_NAYN" size="256" summ="default" type="STRING"/>
					<colinfo id="HOGI" size="256" summ="default" type="STRING"/>
					<colinfo id="SPEC" size="256" summ="default" type="STRING"/>
					<colinfo id="CTESTYMD" size="256" summ="default" type="STRING"/>
					<colinfo id="BOSUCONTACT" size="256" summ="default" type="STRING"/>
					<colinfo id="ETC" size="256" summ="default" type="STRING"/>
					<colinfo id="THOGI" size="256" summ="default" type="STRING"/>
					<colinfo id="ATYPE" size="256" summ="default" type="STRING"/>
					<colinfo id="AUSE" size="256" summ="default" type="STRING"/>
					<colinfo id="PCNT" size="256" summ="default" type="STRING"/>
					<colinfo id="CAPA" size="256" summ="default" type="STRING"/>
					<colinfo id="STCNT" size="256" summ="default" type="STRING"/>
					<colinfo id="DOMETER" size="256" summ="default" type="STRING"/>
					<colinfo id="ABYN" size="256" summ="default" type="STRING"/>
					<colinfo id="TMSPEC" size="256" summ="default" type="STRING"/>
					<colinfo id="CONSOLE" size="256" summ="default" type="STRING"/>
					<colinfo id="INVERTER" size="256" summ="default" type="STRING"/>
					<colinfo id="ROPE_MG" size="256" summ="default" type="STRING"/>
					<colinfo id="ROPING" size="256" summ="default" type="STRING"/>
					<colinfo id="COMPENCHAIN" size="256" summ="default" type="STRING"/>
					<colinfo id="RAIL_CC" size="256" summ="default" type="STRING"/>
					<colinfo id="GUIDESHOE_CAR" size="256" summ="default" type="STRING"/>
					<colinfo id="GUIDESHOE_CWT" size="256" summ="default" type="STRING"/>
					<colinfo id="BRAKESPEC" size="256" summ="default" type="STRING"/>
					<colinfo id="REGULATOR" size="256" summ="default" type="STRING"/>
					<colinfo id="STOPEQP" size="256" summ="default" type="STRING"/>
					<colinfo id="USEYN" size="256" summ="default" type="STRING"/>
					<colinfo id="CREID" size="256" summ="default" type="STRING"/>
					<colinfo id="CREDT" size="256" summ="default" type="STRING"/>
					<colinfo id="MODID" size="256" summ="default" type="STRING"/>
					<colinfo id="MODDT" size="256" summ="default" type="STRING"/>
					<colinfo id="VELOCITY" size="256" summ="default" type="STRING"/>
					<colinfo id="BLOCKCD" size="256" summ="default" type="STRING"/>
					<record>
						<ABYN>0</ABYN>
						<ATT_BPYN>0</ATT_BPYN>
						<ATT_CHKLSTYN>0</ATT_CHKLSTYN>
						<ATT_CNFRMYN>0</ATT_CNFRMYN>
						<ATT_FTFLOWYN>0</ATT_FTFLOWYN>
						<ATT_IMPRPTYN>0</ATT_IMPRPTYN>
						<ATT_KCSYN>0</ATT_KCSYN>
						<ATT_NAYN>0</ATT_NAYN>
						<ATT_PAXYN>0</ATT_PAXYN>
						<ATT_SPECYN>0</ATT_SPECYN>
						<ATT_STRPTYN>0</ATT_STRPTYN>
						<ATYPE>0</ATYPE>
						<AUSE>0</AUSE>
						<BFMATNR>0</BFMATNR>
						<BLOCKCD>0</BLOCKCD>
						<BOSUCONTACT>0</BOSUCONTACT>
						<BRAKESPEC>0</BRAKESPEC>
						<CAPA>0</CAPA>
						<COMPENCHAIN>0</COMPENCHAIN>
						<CONSOLE>0</CONSOLE>
						<CPNCD>0</CPNCD>
						<CPNNM>제조사</CPNNM>
						<CREDT>0</CREDT>
						<CREID>0</CREID>
						<CTESTYMD>0</CTESTYMD>
						<DOMETER>0</DOMETER>
						<ETC>0</ETC>
						<FORMGBN>0</FORMGBN>
						<FTREPORTCD>0</FTREPORTCD>
						<GOODSGBN>제품구분</GOODSGBN>
						<GOODSNM>품명</GOODSNM>
						<GUIDESHOE_CAR>0</GUIDESHOE_CAR>
						<GUIDESHOE_CWT>0</GUIDESHOE_CWT>
						<HOGI>0</HOGI>
						<INVERTER>0</INVERTER>
						<LAWRQ_CHKLSTYN>0</LAWRQ_CHKLSTYN>
						<LAWRQ_CODE>0</LAWRQ_CODE>
						<LAWRQ_CONTYN>0</LAWRQ_CONTYN>
						<LAWRQ_NAYN>0</LAWRQ_NAYN>
						<MODDT>0</MODDT>
						<MODELNM>모델명</MODELNM>
						<MODID>0</MODID>
						<PCNT>0</PCNT>
						<RAIL_CC>0</RAIL_CC>
						<REGULATOR>0</REGULATOR>
						<REQATTDCD>0</REQATTDCD>
						<REQCELL>의뢰자&#32;연락처</REQCELL>
						<REQDT>0</REQDT>
						<REQGBN>의뢰구분</REQGBN>
						<REQID>의뢰자번호</REQID>
						<REQNM>의뢰자명</REQNM>
						<REQSEQ>0</REQSEQ>
						<REQVENDNM>의뢰팀</REQVENDNM>
						<ROPE_MG>0</ROPE_MG>
						<ROPING>0</ROPING>
						<SMPCNT>시료수</SMPCNT>
						<SMPQLT>시료재질</SMPQLT>
						<SPEC>0</SPEC>
						<STATCD>0</STATCD>
						<STCNT>0</STCNT>
						<STOPEQP>0</STOPEQP>
						<TECHATTDCD>0</TECHATTDCD>
						<TESTGBN>시험구분</TESTGBN>
						<TESTGBN_ETCTXT>0</TESTGBN_ETCTXT>
						<THOGI>0</THOGI>
						<TITLE>제목</TITLE>
						<TMSPEC>0</TMSPEC>
						<USEYN>0</USEYN>
						<VELOCITY>0</VELOCITY>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Editable="True" Id="ds_master_cp2">
				<Contents></Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_file_cp">
				<Contents></Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Editable="True" Id="ds_test_cp">
				<Contents></Contents>
			</Dataset>
			<Dataset CanColumnChange="ds_test_CanColumnChange" DataSetType="Dataset" Editable="True" Id="ds_testinfo">
				<Contents>
					<colinfo id="REQSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="TESTREV" size="256" summ="default" type="STRING"/>
					<colinfo id="TESTSYMD" size="256" summ="default" type="STRING"/>
					<colinfo id="TESTPYMD" size="256" summ="default" type="STRING"/>
					<colinfo id="CHNSRSN" size="256" summ="default" type="STRING"/>
					<colinfo id="USEYN" size="256" summ="default" type="STRING"/>
					<colinfo id="CREID" size="256" summ="default" type="STRING"/>
					<colinfo id="CREDT" size="256" summ="default" type="STRING"/>
					<colinfo id="MODID" size="256" summ="default" type="STRING"/>
					<colinfo id="MODDT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_file_del">
				<Contents>
					<colinfo id="FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="REQSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="FILESEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="FILENM" size="256" summ="default" type="STRING"/>
					<colinfo id="FILEPATH" size="256" summ="default" type="STRING"/>
					<colinfo id="FILENM_APP" size="256" summ="default" type="STRING"/>
					<colinfo id="FILESIZE" size="256" summ="default" type="STRING"/>
					<colinfo id="TEMP" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Editable="True" Id="ds_mail">
				<Contents>
					<colinfo id="REQSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="TITLE" size="256" summ="default" type="STRING"/>
					<colinfo id="STATCD" size="256" summ="default" type="STRING"/>
					<colinfo id="REQDT" size="256" summ="default" type="STRING"/>
					<colinfo id="REQVENDNM" size="256" summ="default" type="STRING"/>
					<colinfo id="REQID" size="256" summ="default" type="STRING"/>
					<colinfo id="REQNM" size="256" summ="default" type="STRING"/>
					<colinfo id="REQCELL" size="256" summ="default" type="STRING"/>
					<colinfo id="MANDT" size="256" summ="default" type="STRING"/>
					<colinfo id="REQMAIL" size="256" summ="default" type="STRING"/>
					<colinfo id="MAILDT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond2">
				<Contents>
					<colinfo id="POSID" size="255" type="STRING"/>
					<colinfo id="GBN" size="256" type="STRING"/>
					<record>
						<GBN></GBN>
						<POSID></POSID>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_pdm" UseClientLayout="1">
				<Contents>
					<colinfo id="PATH" size="256" summ="default" type="STRING"/>
					<colinfo id="CATE" size="256" summ="default" type="STRING"/>
					<colinfo id="CDATE" size="256" summ="default" type="STRING"/>
					<record>
						<CATE></CATE>
						<CDATE></CDATE>
						<PATH></PATH>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_index">
				<Contents>
					<colinfo id="REQSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="STATCD" size="256" summ="default" type="STRING"/>
					<record>
						<REQSEQ></REQSEQ>
						<STATCD></STATCD>
					</record>
				</Contents>
			</Dataset>
		</Datasets>
		<Shape BKColor="user0" Bottom="56" Height="26" Id="Shape12" Left="4" LineColor="user1" Right="782" TabOrder="20" Top="30" Type="Rectangle" Width="778"></Shape>
		<Shape BKColor="user0" Bottom="570" Height="26" Id="Shape0" Left="4" LineColor="user1" Right="782" TabOrder="5" Top="544" Type="Rectangle" Width="778"></Shape>
		<Static Align="Right" Height="24" Id="st_name" Left="-116" Style="sty_lb_search" TabOrder="2" Text="현장명&#32;" Top="-6" VAlign="Middle" Width="61"></Static>
		<Calendar BindDataset="ds_master" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="REQDT" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Enable="FALSE" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_dlvdat" Left="649" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="3" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="33" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="105"></Calendar>
		<Static Color="user6" Font="굴림,9,Bold" Height="20" Id="Static19" Left="19" TabOrder="3" Text="법적요구사항" Top="438" VAlign="Middle" Width="102"></Static>
		<Image Height="19" Id="Image0" ImageID="form_bl_title_sub" Left="6" TabOrder="4" Top="436" Width="11"></Image>
		<Checkbox BindDataset="ds_master" BKColor="user0" Column="ATT_SPECYN" Height="18" Id="chk_att01" Left="98" OnClick="chk_att01_OnClick" Style="sty_ipt_form_ind" TabOrder="7" Text="부품규격&#32;or&#32;구매시방서" Top="547" Value="FALSE" Width="130"></Checkbox>
		<Shape BKColor="user0" Bottom="595" Height="26" Id="Shape10" Left="4" LineColor="user1" Right="782" TabOrder="8" Top="569" Type="Rectangle" Width="778"></Shape>
		<Checkbox BindDataset="ds_master" BKColor="user0" Column="ATT_FTFLOWYN" Height="18" Id="chk_att06" Left="98" OnClick="chk_att01_OnClick" Style="sty_ipt_form_ind" TabOrder="9" Text="기능시험절차서" Top="572" Value="FALSE" Width="90"></Checkbox>
		<Checkbox BindDataset="ds_master" BKColor="user0" Column="ATT_STRPTYN" Height="18" Id="chk_att07" Left="193" OnClick="chk_att01_OnClick" Style="sty_ipt_form_ind" TabOrder="10" Text="자체시험&#32;성적서" Top="572" Value="FALSE" Width="95"></Checkbox>
		<Button Cursor="HAND" Height="20" Id="btn_fileadd" ImageID="btn_icon_plus" Left="732" LeftMargin="12" OnClick="btn_add_OnClick" Style="sty_btn" TabOrder="11" Top="604" Transparent="TRUE" Width="22"></Button>
		<Button Cursor="HAND" Height="20" Id="btn_filedel" ImageID="btn_icon_minus" Left="756" LeftMargin="12" OnClick="btn_del_OnClick" Style="sty_btn" TabOrder="12" Top="604" Transparent="TRUE" Width="22"></Button>
		<Grid AutoFit="TRUE" AutoFitEndLine="Hide" BindDataset="ds_file" BkColor2="default" BoldHead="true" Border="Flat" Bottom="745" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="118" Id="grd_file" InputPanel="true" Left="7" LineColor="user20" LineType="ExHORZ" MinWidth="100" OnCellDBLClick="grd_file_OnCellDblClick" OnExpandEdit="grd_file_OnCellDblClick" Right="780" RowHeight="20" Style="sty_grid" TabOrder="13" TabStop="true" Top="627" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="773">
			<contents>
				<format id="Default">
					<columns>
						<col width="32"/>
						<col width="43"/>
						<col width="450"/>
						<col width="210"/>
						<col width="0"/>
					</columns>
					<head>
						<cell align="center" col="0" color="user21" display="text" font="굴림,9" text="No"/>
						<cell align="center" col="1" color="user21" display="text" font="굴림,9" text="변경"/>
						<cell align="center" col="2" color="user21" display="text" font="굴림,9" text="파일명"/>
						<cell align="center" col="3" color="user21" display="text" font="굴림,9" text="파일사이즈"/>
						<cell align="center" col="4" color="user21" display="text" font="굴림,9" text="파일명(서버)"/>
					</head>
					<body>
						<cell align="center" col="0" display="text" expr="currow+1"/>
						<cell align="center" bkcolor2="user22" bkimageid='expr:gfn_getFlagBkImageID(getColumn(currow,&#32;&quot;FLAG&quot;))' col="1" display="image"/>
						<cell bkcolor2="user22" col="2" colid="FILENM" display="text" expandimage="btn_icon_next_01" expandshow="true"/>
						<cell bkcolor2="user22" col="3" colid="FILESIZE" display="number"/>
						<cell bkcolor2="user22" col="4" colid="FILENM_APP" display="text"/>
					</body>
				</format>
			</contents>
		</Grid>
		<FileDialog Bottom="625" Height="24" Id="fileDialog" Left="540" Right="564" TabOrder="72" Top="601" Width="24"></FileDialog>
		<File Bottom="625" Height="24" Id="f_tmp" Left="613" Right="637" TabOrder="74" Top="601" Width="24"></File>
		<FileDialog Bottom="625" FilePath="c:\" Height="24" Id="saveDialog" Left="676" Right="700" TabOrder="73" Top="601" Type="Save" Width="24"></FileDialog>
		<CyHttpFile Height="24" Id="httpFile" Left="644" Top="601" Width="24"></CyHttpFile>
		<Static Color="user6" Font="굴림,9,Bold" Height="20" Id="Static11" Left="16" TabOrder="14" Text="첨부파일" Top="601" VAlign="Middle" Width="301"></Static>
		<Shape BKColor="user0" Bottom="30" Height="26" Id="Shape11" Left="4" LineColor="user1" Right="782" TabOrder="17" Top="4" Type="Rectangle" Width="778"></Shape>
		<Static Align="Right" Height="24" Id="Static10" Left="6" Style="sty_lb_search" TabOrder="15" Text="처리&#32;결과&#32;" Top="5" VAlign="Middle" Width="88"></Static>
		<Edit AutoSelect="TRUE" BindDataset="ds_master" Border="Flat" Column="TITLE" Height="20" Id="ed_title" ImeMode="none" Left="97" LeftMargin="4" MaxLength="100" RightMargin="4" Style="sty_ipt_form" TabOrder="16" Top="8" UsePopupMenu="FALSE" Width="673"></Edit>
		<Static Align="Center" Height="24" Id="Static12" Left="6" Style="sty_lb_search" TabOrder="18" Text="제목" Top="5" VAlign="Middle" Width="88"></Static>
		<Static Align="Center" Height="24" Id="Static13" Left="6" Style="sty_lb_search" TabOrder="19" Text="접수번호" Top="31" VAlign="Middle" Width="88"></Static>
		<Edit BindDataset="ds_master" Border="Flat" Column="REQSEQ" Enable="FALSE" Height="20" Id="Edit1" ImeMode="english" Left="97" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="21" Top="33" UpperOnly="TRUE" Width="150"></Edit>
		<Static Align="Center" Height="24" Id="Static14" Left="278" Style="sty_lb_search" TabOrder="22" Text="의뢰팀" Top="32" VAlign="Middle" Width="88"></Static>
		<Static Align="Center" Height="24" Id="Static15" Left="558" Style="sty_lb_search" TabOrder="23" Text="의뢰일자" Top="32" VAlign="Middle" Width="88"></Static>
		<Shape BKColor="user0" Bottom="82" Height="26" Id="Shape13" Left="4" LineColor="user1" Right="782" TabOrder="25" Top="56" Type="Rectangle" Width="778"></Shape>
		<Static Align="Center" Height="24" Id="Static16" Left="6" Style="sty_lb_search" TabOrder="24" Text="의뢰구분" Top="57" VAlign="Middle" Width="88"></Static>
		<Static Align="Center" Height="24" Id="Static17" Left="278" Style="sty_lb_search" TabOrder="26" Text="의뢰자" Top="58" VAlign="Middle" Width="88"></Static>
		<Static Align="Center" Height="24" Id="Static18" Left="558" Style="sty_lb_search" TabOrder="27" Text="의뢰자&#32;연락처" Top="58" VAlign="Middle" Width="88"></Static>
		<Edit BindDataset="ds_master" Border="Flat" Column="REQCELL" Height="20" Id="ed_reqcell" ImeMode="english" Left="649" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="28" Top="59" Width="105"></Edit>
		<Shape BKColor="user0" Bottom="134" Height="26" Id="Shape14" Left="4" LineColor="user1" Right="782" TabOrder="30" Top="108" Type="Rectangle" Width="778"></Shape>
		<Static Align="Center" Height="24" Id="Static20" Left="6" Style="sty_lb_search" TabOrder="29" Text="시험구분" Top="109" VAlign="Middle" Width="88"></Static>
		<Shape BKColor="user0" Bottom="160" Height="26" Id="Shape15" Left="4" LineColor="user1" Right="782" TabOrder="32" Top="134" Type="Rectangle" Width="778"></Shape>
		<Static Align="Center" Height="24" Id="Static21" Left="6" Style="sty_lb_search" TabOrder="31" Text="품명" Top="135" VAlign="Middle" Width="88"></Static>
		<Edit BindDataset="ds_master" Border="Flat" Column="GOODSNM" Enable="FALSE" Height="20" Id="ed_goodsnm" ImeMode="english" Left="180" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="33" Top="137" UpperOnly="TRUE" Width="151"></Edit>
		<Edit BindDataset="ds_master" Border="Flat" Column="POSITIONNM" Enable="FALSE" Height="20" Id="ed_blockcd" ImeMode="english" Left="97" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="34" Top="137" UpperOnly="TRUE" Width="80"></Edit>
		<Static Align="Center" Height="24" Id="Static23" Left="369" Style="sty_lb_search" TabOrder="35" Text="모델명" Top="136" VAlign="Middle" Width="105"></Static>
		<Edit BindDataset="ds_master" Border="Flat" Column="MODELNM" Height="20" Id="ed_modelnm" ImeMode="english" Left="479" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="36" Top="137" Width="230"></Edit>
		<Shape BKColor="user0" Bottom="108" Height="26" Id="Shape16" Left="4" LineColor="user1" Right="782" TabOrder="38" Top="82" Type="Rectangle" Width="778"></Shape>
		<Static Align="Center" Height="24" Id="Static24" Left="6" Style="sty_lb_search" TabOrder="37" Text="제품구분" Top="83" VAlign="Middle" Width="88"></Static>
		<Shape BKColor="user0" Bottom="186" Height="26" Id="Shape17" Left="4" LineColor="user1" Right="782" TabOrder="40" Top="160" Type="Rectangle" Width="778"></Shape>
		<Static Align="Center" Height="24" Id="Static25" Left="6" Style="sty_lb_search" TabOrder="39" Text="도면번호" Top="161" VAlign="Middle" Width="88"></Static>
		<Edit BindDataset="ds_master" Border="Flat" Column="BFMATNR" Height="20" Id="ed_bfmatnr" ImeMode="english" Left="97" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="41" Top="163" UpperOnly="TRUE" Width="113"></Edit>
		<Static Align="Center" Height="24" Id="Static26" Left="278" Style="sty_lb_search" TabOrder="42" Text="시료수" Top="162" VAlign="Middle" Width="88"></Static>
		<Edit BindDataset="ds_master" Border="Flat" Column="SMPCNT" Height="20" Id="Edit13" ImeMode="english" Left="369" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="43" Top="163" UpperOnly="TRUE" Width="105"></Edit>
		<Static Align="Center" Height="24" Id="Static27" Left="558" Style="sty_lb_search" TabOrder="44" Text="시험차수" Top="162" VAlign="Middle" Width="88"></Static>
		<Edit BindDataset="ds_master" Border="Flat" Column="DEGREE" Enable="FALSE" Height="20" Id="ed_degree" ImeMode="english" Left="650" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="45" Top="163" Width="105"></Edit>
		<Shape BKColor="user0" Bottom="486" Height="26" Id="Shape18" Left="4" LineColor="user1" Right="782" TabOrder="47" Top="460" Type="Rectangle" Width="778"></Shape>
		<Static Align="Center" Height="24" Id="Static28" Left="6" Style="sty_lb_search" TabOrder="46" Text="적용&#32;CODE" Top="461" VAlign="Middle" Width="88"></Static>
		<Edit AutoSelect="TRUE" BindDataset="ds_master" Border="Flat" Column="LAWRQ_CODE" Enable="FALSE" Height="20" Id="ed_lawrq_code" ImeMode="english" Left="97" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="48" Top="463" UpperOnly="TRUE" Width="121"></Edit>
		<Static Height="16" Id="Static29" Left="579" TabOrder="49" Text="예)&#32;81-50,&#32;81-70" Top="466" Width="161"></Static>
		<Shape BKColor="user0" Bottom="512" Height="26" Id="Shape19" Left="4" LineColor="user1" Right="782" TabOrder="50" Top="486" Type="Rectangle" Width="778"></Shape>
		<Static Align="Center" Height="24" Id="Static31" Left="6" Style="sty_lb_search" TabOrder="51" Text="Code분석" Top="487" VAlign="Middle" Width="88"></Static>
		<Static Height="16" Id="Static30" Left="579" TabOrder="52" Text="예)&#32;Check&#32;list" Top="492" Width="161"></Static>
		<Checkbox BindDataset="ds_master" BKColor="user0" Column="LAWRQ_CONTYN" Height="18" Id="chk_contyn" Left="225" OnClick="chk_contyn_OnClick" Style="sty_ipt_form_ind" TabOrder="53" Text="Code&#32;내용&#32;유첨" Top="489" Value="FALSE" Width="100"></Checkbox>
		<Checkbox BindDataset="ds_master" BKColor="user0" Column="LAWRQ_CHKLSTYN" Height="18" Id="chk_chklstyn" Left="98" OnClick="chk_chklstyn_OnClick" Style="sty_ipt_form_ind" TabOrder="54" Text="Check&#32;list&#32;유첨" Top="489" Value="FALSE" Width="100"></Checkbox>
		<Checkbox BindDataset="ds_master" BKColor="user0" Column="LAWRQ_NAYN" Height="18" Id="chk_nayn" Left="337" OnClick="chk_nayn_OnClick" Style="sty_ipt_form_ind" TabOrder="55" Text="해당사항&#32;없음" Top="489" Value="FALSE" Width="100"></Checkbox>
		<Static Color="user6" Font="굴림,9,Bold" Height="20" Id="Static32" Left="19" TabOrder="56" Text="유첨내용(시험진행&#32;관련&#32;첨부자료&#32;불만족시&#32;반송처리됨&#32;&#32;&#32;&#32;&#32;)" Top="518" VAlign="Middle" Width="400"></Static>
		<Image Height="19" Id="Image1" ImageID="form_bl_title_sub" Left="6" TabOrder="57" Top="516" Width="11"></Image>
		<Checkbox BindDataset="ds_master" Column="ATT_CNFRMYN" Height="18" Id="chk_att_cnfrmyn" Left="350" Style="sty_ipt_form_ind" TabOrder="58" Top="517" Value="FALSE" Width="15"></Checkbox>
		<Static Align="Center" Height="49" Id="Static0" Left="6" Style="sty_lb_search" TabOrder="6" Text="제출항목" Top="545" VAlign="Middle" Width="88"></Static>
		<Button Height="18" Id="btn_reqnm" ImageID="btn_icon_search" Left="450" OnClick="btn_reqnm_OnClick" TabOrder="60" Text="Button0" Top="60" Transparent="TRUE" Width="18"></Button>
		<Edit BindDataset="ds_master" Border="Flat" Column="REQNM" DisableBKColor="user12" Enable="FALSE" Height="20" Id="ed_reqnm" Left="369" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="59" Top="59" UpperOnly="TRUE" Width="80"></Edit>
		<Checkbox BindDataset="ds_master" BKColor="user0" Column="ATT_KCSYN" Height="18" Id="chk_att05" Left="520" OnClick="chk_att01_OnClick" Style="sty_ipt_form_ind" TabOrder="61" Text="KC/KS인증서" Top="546" Value="FALSE" Width="80"></Checkbox>
		<Checkbox BindDataset="ds_master" BKColor="user0" Column="ATT_PAXYN" Height="18" Id="chk_att04" Left="442" OnClick="chk_att01_OnClick" Style="sty_ipt_form_ind" TabOrder="62" Text="승인원" Top="547" Value="FALSE" Width="62"></Checkbox>
		<Checkbox BindDataset="ds_master" BKColor="user0" Column="ATT_CHKLSTYN" Height="18" Id="chk_att03" Left="298" OnClick="chk_att01_OnClick" Style="sty_ipt_form_ind" TabOrder="63" Text="CODE&#32;검토(Check&#32;list)" Top="547" Value="FALSE" Width="140"></Checkbox>
		<Checkbox BindDataset="ds_master" BKColor="user0" Column="ATT_BPYN" Height="18" Id="chk_att02" Left="234" OnClick="chk_att01_OnClick" Style="sty_ipt_form_ind" TabOrder="64" Text="설계도면" Top="547" Value="FALSE" Width="65"></Checkbox>
		<Checkbox BindDataset="ds_master" BKColor="user0" Column="ATT_IMPRPTYN" Height="18" Id="chk_att08" Left="297" OnClick="chk_att01_OnClick" Style="sty_ipt_form_ind" TabOrder="65" Text="개선보고서(재시험의뢰시)" Top="572" Value="FALSE" Width="140"></Checkbox>
		<Checkbox BindDataset="ds_master" BKColor="user0" Column="ATT_NAYN" Height="18" Id="chk_attna" Left="449" OnClick="chk_attna_OnClick" Style="sty_ipt_form_ind" TabOrder="66" Text="해당사항&#32;없음(참고용)" Top="572" Value="FALSE" Width="130"></Checkbox>
		<Edit BindDataset="ds_master" Border="Flat" CheckLength="Byte" Column="REQID" Enable="FALSE" Height="20" Id="ed_reqid" ImeMode="none" Left="469" LeftMargin="4" MaxLength="105" RightMargin="4" Style="sty_ipt_search" TabOrder="67" Top="59" Width="80"></Edit>
		<Edit BindDataset="ds_master" Border="Flat" Column="REQVENDNM" Enable="FALSE" Height="20" Id="ed_reqvendnm" ImeMode="english" Left="369" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="68" Top="33" Width="105"></Edit>
		<Combo BindDataset="ds_master" CodeColumn="CODE" Column="REQGBN" DataColumn="CODE_NAME" Editable="TRUE" Height="18" Id="cb_reqgbn" InnerDataset="ds_code_reqgbn" Left="96" TabOrder="69" Top="58" Width="150"></Combo>
		<Combo BindDataset="ds_master" CodeColumn="CODE" Column="GOODSGBN" DataColumn="CODE_NAME" Editable="TRUE" Height="18" Id="cb_goodsgbn" InnerDataset="ds_code_goodsgbn" Left="96" TabOrder="70" Top="84" Width="150"></Combo>
		<Combo BindDataset="ds_master" CodeColumn="CODE" Column="TESTGBN" DataColumn="CODE_NAME" Editable="TRUE" Height="18" Id="cb_testgbn" InnerDataset="ds_code_testgbn" Left="96" OnChanged="cb_testgbn_OnChanged" TabOrder="71" Top="111" Width="150"></Combo>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_testadd" ImageID="btn_icon_plus" Left="728" LeftMargin="12" OnClick="btn_testadd_OnClick" Style="sty_btn" TabOrder="72" Top="188" Transparent="TRUE" Width="22"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_testdel" ImageID="btn_icon_minus" Left="752" LeftMargin="12" OnClick="btn_testdel_OnClick" Style="sty_btn" TabOrder="73" Top="188" Transparent="TRUE" Width="22"></Button>
		<Static Color="user6" Font="굴림,9,Bold" Height="20" Id="Static1" Left="19" TabOrder="74" Text="시험항목" Top="190" VAlign="Middle" Width="102"></Static>
		<Image Height="19" Id="Image2" ImageID="form_bl_title_sub" Left="6" TabOrder="75" Top="188" Width="11"></Image>
		<Grid AreaSelect="true" AutoFit="TRUE" AutoFitEndLine="Hide" BindDataset="ds_test" BkColor2="default" BoldHead="true" Border="Flat" Bottom="434" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="223" Id="Grid0" InputPanel="true" Left="7" LineColor="user20" LineType="ExHORZ" MinWidth="100" Right="780" RowHeight="20" Style="sty_grid" TabOrder="76" TabStop="true" Top="211" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="773">
			<contents>
				<format id="Default">
					<columns>
						<col width="30"/>
						<col width="147"/>
						<col width="275"/>
						<col width="216"/>
					</columns>
					<head>
						<cell align="center" col="0" color="user21" display="text" font="굴림,9" text="No"/>
						<cell align="center" col="1" color="user21" display="text" font="굴림,9" text="시험항목"/>
						<cell align="center" col="2" color="user21" display="text" font="굴림,9" text="시험기준&#32;및&#32;방법"/>
						<cell col="3" color="user21" display="text" font="굴림,9" text="판정기준"/>
					</head>
					<body>
						<cell align="center" col="0" display="text" expr="currow+1"/>
						<cell align="left" bkcolor2="user22" col="1" colid="TESTNM" combodisplayrowcnt="0" display="text" edit="normal"/>
						<cell align="left" bkcolor2="user22" col="2" colid="TESTCONT1" display="text" edit="normal"/>
						<cell align="left" col="3" colid="TESTCONT2" display="text" edit="normal"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Edit BindDataset="ds_master" Border="Flat" Column="TESTGBN_ETCTXT" Height="20" Id="ed_testgbn_etctxt" ImeMode="english" Left="250" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="77" Top="111" Visible="FALSE" Width="105"></Edit>
		<Button Height="18" Id="btn_model" ImageID="btn_icon_search" Left="336" OnClick="btn_model_OnClick" TabOrder="78" Text="Button0" Top="138" Transparent="TRUE" Width="18"></Button>
		<Div Height="30" Id="div_imp" Left="5" TabOrder="79" Text="Div0" Top="752" Width="711">
			<Contents>
				<Shape BKColor="user12" Bottom="30" Height="26" Id="Shape7" Left="3" LineColor="user13" Right="563" TabOrder="4" Top="4" Type="Rectangle" Width="560"></Shape>
				<Button Height="19" Id="btn_imp_openfile" ImageID="btn_icon_polder" Left="532" OnClick="div_imp_btn_imp_openfile_OnClick" TabOrder="1" Text="Button0" Top="8" Width="19"></Button>
				<Edit BindDataset="ds_master" Border="Flat" Column="IMP_FILENM" Enable="FALSE" Height="20" Id="ed_imp_filename" Left="139" LeftMargin="4" Readonly="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="2" Top="7" Width="382"></Edit>
				<Static Height="24" Id="Static41" Left="4" Style="sty_lb_form_basic" TabOrder="3" Text="&#32;*&#32;&#32;&#32;개선대책&#32;보고서&#32;&#32;&#32;*" Top="5" VAlign="Middle" Width="124"></Static>
				<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_imp_download" ImageID="btn_sub_06" Left="588" LeftMargin="12" OnClick="div_imp_btn_imp_download_OnClick" Style="sty_btn" TabOrder="5" Text="보고서&#32;다운로드" Top="7" Transparent="TRUE" Width="95"></Button>
			</Contents>
		</Div>
		<FileDialog Bottom="624" FilePath="c:\" Height="24" Id="saveDialog1" Left="504" Right="528" TabOrder="84" Top="600" Type="Save" Width="24"></FileDialog>
		<FileDialog Bottom="625" Height="24" Id="FileDialog1" Left="460" Right="484" TabOrder="84" Top="601" Width="24"></FileDialog>
		<Static Align="Center" Height="24" Id="Static22" Left="278" Style="sty_lb_search" TabOrder="80" Text="제조사" Top="84" VAlign="Middle" Width="88"></Static>
		<Edit BindDataset="ds_master" Border="Flat" Column="CPNNM" Height="20" Id="ed_cpnnm" ImeMode="english" Left="369" LeftMargin="4" OnChanged="ed_cpnnm_OnChanged" RightMargin="4" Style="sty_ipt_form" TabOrder="81" Top="85" UpperOnly="TRUE" Width="80"></Edit>
		<Static Align="Center" Height="24" Id="Static2" Left="558" Style="sty_lb_search" TabOrder="82" Text="시료재질" Top="84" VAlign="Middle" Width="88"></Static>
		<Edit BindDataset="ds_master" Border="Flat" Column="SMPQLT" Height="20" Id="Edit10" ImeMode="english" Left="649" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="83" Top="85" Width="105"></Edit>
		<Button Height="18" Id="btn_cpnnm" ImageID="btn_icon_search" Left="451" OnClick="btn_cpnnm_OnClick" TabOrder="84" Text="Button0" Top="86" Transparent="TRUE" Width="18"></Button>
		<Edit BindDataset="ds_master" Border="Flat" CheckLength="Byte" Column="CPNCD" Enable="FALSE" Height="20" Id="ed_cpnno" ImeMode="none" Left="470" LeftMargin="4" MaxLength="105" Readonly="TRUE" RightMargin="4" Style="sty_ipt_search" TabOrder="85" Top="85" Width="80"></Edit>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_pdm" ImageID="btn_sub_03" Left="214" LeftMargin="12" OnClick="btn_pdm_OnClick" Style="sty_btn" TabOrder="86" TabStop="FALSE" Text="Check" Top="163" Transparent="TRUE" Width="60"></Button>
	</Form>
	<Script><![CDATA[/*
 ******************************************************************************************
 * 기      능   : Lab., 정밀측정실 의뢰
 * 작  성  자   : YSH
 * 작성  일자   : 2020.10.14
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
#include "LIB::commons.js";	// 공통 스크립트 
#include "LIB::nsfRequest.js";	// 공통 스크립트 

//=========================================================================================
// [ PART 1 ]
// Form에서 사용될 전역변수를 선언
// FORM에서 사용되는 전역변수는 대문자로 작성하며, F_XXX 의 형태를 갖도록 한다. 
//=========================================================================================
var F_FRM_TITLE = "Lab. 의뢰서";	// 공통코드 화면명
var F_USER_GBN  = "";
var F_FORMGBN  = "1";
var imgUploadFlg = ""; 					// 권한별 이미지 업로드 여부 "":업로드, "VIEW":보기
var F_SERVER_DIR = "QM";

var inputMode = "I";	// I:신규  M:수정  R:읽기전용
var modFlg = false;		// 수정여부

// 파일관련 
var F_SIZE = 1024 * 10096;	// 10MB
var _F_FILE_DIR = "";	// 로컬에서 현재 선택한 파일 디렉토리 
var _F_FILE_NAME = "";	// 로컬에서 현재 선택한 파일  명 
var _F_FILE_SIZE = 0;	// 파일 사이즈 
var _F_FILE_DELETE = false;
var _F_FILENM_APP_DEL = ""; // 저장 하지 않을 시 삭제용

var	_SERVER_FNAME = "";  // 서버 파일명

var G_REQSEQ = "";
var G_CATE = "";

//=========================================================================================
// [ PART 2 ]
// Form Loading / Unloading 시 작업 정의
//=========================================================================================
function fn_OnLoadCompleted(obj)
{
	F_USER_GBN = right(G_USER_GROUP_B, 2); // 20 : 담당, 30 : 팀장, 40 : 부서장, 50 : 관리자

	gfn_initForm(false);	// Form 로드 이벤트 맨 첫줄에 기술
	fn_init_form();			// 폼 초기화

/*
	div_btn.fn_loadUseBtn("55", F_FRM_TITLE, "", ""); // 55-신청	
	div_btn.btn_request.DomainId = "";
	div_btn.btn_request.Text     = "의뢰";  // 신청 => 의뢰	
	*/
}

/********************************************************************************
* 기      능   : form UnloadCompleted 
********************************************************************************/
function fn_OnUnloadCompleted(obj)
{
	return gfn_isFormUnload(obj);
}

/********************************************************************************
* 기      능   : 폼 초기화
********************************************************************************/
function fn_init_form()
{

	var reqseq  = ""; if ( IsExistVar("p_reqseq" ) ) reqseq  = trim(p_reqseq );	
	var formgbn  = "1"; if ( IsExistVar("p_formgbn" ) ) formgbn  = trim(p_formgbn );
	
	if ( formgbn == "4" ) {
		F_FRM_TITLE = "정밀측정실 의뢰서";	// 공통코드 화면명		

		//div_btn.st_title.value = "정밀측정실 의뢰서";		
		//div_btn.fn_loadUseBtn("55", F_FRM_TITLE, "", ""); // 55-신청
	}
	
	F_FORMGBN = formgbn;

	
	if( reqseq != "" ) {

		ds_cond.ClearData();
		ds_cond.AddRow();
		ds_cond.SetColumn(0, "REQSEQ"  , reqseq);
	
		fn_query();
	} else {
	
	
		ds_master.ClearData();
		ds_master.AddRow();	
				
		ed_reqnm.Text = G_USER_NAME;
		ed_reqid.Text = G_USER_ID;
		ed_reqvendnm.Text = G_VEND_NAME;
		ed_reqcell.Text = G_USERMBPN;		
	}
}

//=========================================================================================
// [ PART 3 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,form닫기)
//=========================================================================================
/********************************************************************************
* 기      능   : 조회
********************************************************************************/
function fn_query()
{
	tit_clearActionInfo();
	tit_addSearchActionInfo("qm10:QM1001002B_S2");
	tit_addSearchActionInfo("qm10:QM1001003B_S3");
	tit_addSearchActionInfo("qm10:QM1001002B_S3");
	tit_addSearchActionInfo("qm10:QM1001002B_S5");

	tit_callService(
        ""
        , ""
        , "ds_cond=ds_cond"
        , "ds_master=ds_master ds_test=ds_test ds_file=ds_file ds_index=ds_index"
        , ""
        , "fn_afterQuery"
        , true
        , true);	
}

/********************************************************************************
 * 기      능   : 조회 for mail
 ********************************************************************************/
function fn_squery()
{ 
		
	  
	if( G_REQSEQ != null && G_REQSEQ != "" ) { 
		ds_master.SetColumn(ds_master.currow, "REQSEQ", G_REQSEQ);
		
		tit_clearActionInfo();
		tit_addSearchActionInfo("qm10:QM1001002B_S4");
		tit_callService(
			""
			 , ""
			 , "ds_master=ds_master"
			 , "ds_mail=ds_mail"
			 , ""
			 , "fn_afterSquery"
			 , true
			 , true);			
	} else {
		this.Close();	
	}
	

 }


/********************************************************************************
* 기      능   : 신청 처리 ( 의뢰 )
********************************************************************************/
function fn_request(obj)
{
	// validation check		
	if(!fn_chkVal()) {	
		return;	
	}
	
	if(!confirm("시험의뢰 이후 수정이 불가능합니다. 의뢰하시겠습니까?")) {
		return;	
	}
	
	// 마스터 테이블
	ds_master_cp2.ClearData();
	for(var i=0; i < ds_master.colcount; i++) { 
		ds_master_cp2.addColumn( ToLower(ds_master.GetColID(i)), "STRING", 256);
	}
	
	ds_master_cp2.AddRow();	
	
	for(var i=0; i < ds_master.colcount; i++) { 
		ds_master_cp2.SetColumn(ds_master_cp2.row
		                     , ToLower(ds_master.GetColID(i))
		                     , ds_master.GetColumn(ds_master.row, ds_master.GetColID(i)));
	}
		
	ds_master_cp2.SetColumn(ds_master.row, "formgbn", F_FORMGBN);
	ds_master_cp2.SetColumn(ds_master.row, "statcd", "10");	
		
	// 시험항목
	ds_test_cp.ClearData();
	
	for(var i=0; i < ds_test.colcount; i++) { 
		ds_test_cp.addColumn( ToLower(ds_test.GetColID(i)), "STRING", 256);
	}		

	for(var j=0; j < ds_test.rowcount ; j++) { 	
		ds_test_cp.AddRow();	
		for(var i=0; i < ds_test.colcount; i++) { 
								
			ds_test_cp.SetColumn( j
								, ToLower(ds_test.GetColID(i))
								, ds_test.GetColumn(j, ds_test.GetColID(i)));
								
		}
		ds_test_cp.SetColumn(j,"testseq", "" + (j+1));
	}
	
	// 첨부파일
	ds_file_cp.ClearData();
	for(var i=0; i < ds_file.colcount; i++) { 
		ds_file_cp.addColumn( ToLower(ds_file.GetColID(i)), "STRING", 256);
	}
	
	for(var j=0; j < ds_file.rowcount ; j++) { 	
		ds_file_cp.AddRow();	
		for(var i=0; i < ds_file.colcount; i++) { 
								
			ds_file_cp.SetColumn( j
								, ToLower(ds_file.GetColID(i))
								, ds_file.GetColumn(j, ds_file.GetColID(i)));
		}
		//ds_file_cp.SetColumn(j,"fileseq", "" + (j+1));
	}		
	
	var inDs = "ds_master=ds_master_cp2"
			+ " ds_test=ds_test_cp"
			+ " ds_file=ds_file_cp"
	;
	var outDs = "ds_master=ds_master"
			 + " ds_error=ds_error"
	;
	
	fn_createWait("",this);     // 처리중입니다. 메시지 처리
	
	nsfRequest("save", "qm1001002/save", inDs, outDs, "G_REQSEQ=G_REQSEQ", "fn_afterSave");
	
}


/********************************************************************************
* 기      능   : 임시저장
********************************************************************************/
function fn_read(obj)
{
	// 마스터 테이블
	ds_master_cp2.ClearData();
	for(var i=0; i < ds_master.colcount; i++) { 
		ds_master_cp2.addColumn( ToLower(ds_master.GetColID(i)), "STRING", 256);
	}
	
	ds_master_cp2.AddRow();	
	
	for(var i=0; i < ds_master.colcount; i++) { 
		ds_master_cp2.SetColumn(ds_master_cp2.row
		                     , ToLower(ds_master.GetColID(i))
		                     , ds_master.GetColumn(ds_master.row, ds_master.GetColID(i)));
	}
		
	ds_master_cp2.SetColumn(ds_master.row, "formgbn", F_FORMGBN);
	ds_master_cp2.SetColumn(ds_master.row, "statcd", "00");	
		
	// 시험항목
	ds_test_cp.ClearData();
	
	for(var i=0; i < ds_test.colcount; i++) { 
		ds_test_cp.addColumn( ToLower(ds_test.GetColID(i)), "STRING", 256);
	}		

	for(var j=0; j < ds_test.rowcount ; j++) { 	
		ds_test_cp.AddRow();	
		for(var i=0; i < ds_test.colcount; i++) { 
								
			ds_test_cp.SetColumn( j
								, ToLower(ds_test.GetColID(i))
								, ds_test.GetColumn(j, ds_test.GetColID(i)));
								
		}
		ds_test_cp.SetColumn(j,"testseq", "" + (j+1));
	}
	
	// 첨부파일
	ds_file_cp.ClearData();
	for(var i=0; i < ds_file.colcount; i++) { 
		ds_file_cp.addColumn( ToLower(ds_file.GetColID(i)), "STRING", 256);
	}
	
	for(var j=0; j < ds_file.rowcount ; j++) { 	
		ds_file_cp.AddRow();	
		for(var i=0; i < ds_file.colcount; i++) { 
								
			ds_file_cp.SetColumn( j
								, ToLower(ds_file.GetColID(i))
								, ds_file.GetColumn(j, ds_file.GetColID(i)));			
		}

		//ds_file_cp.SetColumn(j,"fileseq", "" + (j+1));
	}		
	
	var inDs = "ds_master=ds_master_cp2"
			+ " ds_test=ds_test_cp"
			+ " ds_file=ds_file_cp"
	;
	var outDs = "ds_master=ds_master"
			 + " ds_error=ds_error"
	;
	
	fn_createWait("",this);     // 처리중입니다. 메시지 처리
	

	
	nsfRequest("save", "qm1001002/save", inDs, outDs, "", "fn_afterSave");		

}

/********************************************************************************
* 기      능   : 닫기  
********************************************************************************/
function fn_close()
{
	if( confirm("시험 의뢰를 중단하시겠습니까?") ) {		
		// 저장되지 않은 파일 삭제
		var rowcnt = ds_file.rowcount;
		
		for( var i = 0 ;  i < rowcnt ; i++ ) { 			
			var sFileName = ds_file.GetColumn(i, "FILENM");
			if(length(sFileName) != 0 && ds_file.GetColumn(i, "FLAG") == "I" ) {
				var arr = tit_fileDelete("QM",ds_file.getColumn(i, "FILENM_APP"), false);
			}
		}
		
		// 개선 대책 보고서 저장되지 않은 파일 삭제
		if(_F_FILENM_APP_DEL != "" ) {	
			var arr = tit_fileDelete("QM",_F_FILENM_APP_DEL, false);	
		}
	} else {		
		return;
	}
	
	this.close();
}

//=========================================================================================
// [ PART 4]
// Callback 함수 정의 : callback 함수명은 메인 함수의 fn_xxxx() 에서 xxxx 부분은 fn_afterXXXX()
// 형태가 되도록 작성 
//=========================================================================================


/********************************************************************************
* 기      능   : 조회 Callback
********************************************************************************/
function fn_afterQuery(svcId, errCode, errMsg)
{
	// 차수증가
	if( ds_master.GetColumn(ds_master.row, "STATCD") == "99" ) {
	
		cb_reqgbn.Enable = false;
		cb_goodsgbn.Enable = false;
		cb_testgbn.Enable = false;
		ed_testgbn_etctxt.Enable = false;
		
		btn_model.Enable = false;
		ed_goodsnm.Enable = false;
		ed_bfmatnr.Enable = false;
		btn_bfmatnr.Enable = false;
		
		ed_cpnnm.Enable = false;
		btn_cpnnm.Enable = false;		
		
		gfn_showAlert("CI30001", "시험 재의뢰 시 기존에 의뢰한 의뢰서 재사용. " );
	} else {
	
		var degree = toNumber(trim(ds_master.GetColumn(ds_master.row, "DEGREE"))) ;
		
		if ( degree == null ||  degree < 2 ) {		
			// 1차의뢰 비활성화
			div_imp.Visible = false;		
		}	
	}	
	
	F_FORMGBN = ds_master.GetColumn(ds_master.row, "FORMGBN");
	
	if ( F_FORMGBN == "4" ) {
		F_FRM_TITLE = "정밀측정실 의뢰서";	// 공통코드 화면명		
		div_btn.st_title.value = "정밀측정실 의뢰서";		
		//div_btn.fn_loadUseBtn("55", F_FRM_TITLE, "", ""); // 55-신청
	}
			
	if( ds_master.GetColumn(ds_master.row, "TESTGBN") == "ETC" ) { 
		ed_testgbn_etctxt.Visible = true;
	}
	
	if( chk_chklstyn.Value || chk_contyn.Value ) {
		ed_lawrq_code.Enable = true;	
	}	
	
	// 현재 완료인 상태에서 임시저장 보고서가 있을 시 버튼 비활성화 및 팝업 메세지 호출
	// 접수 번호 이력을 조회 하여 마지막에 상태정보 가져오기
	var B_STATCD = ds_index.GetColumn(0, "STATCD");
	
	if(B_STATCD == "00" && ds_master.GetColumn(ds_master.row, "STATCD") == "99") {
		// 의뢰, 임시저장 버튼 비활성화
		parent.div_btn.btn_request.Enable = false;
		parent.div_btn.btn_read.Enable = false;
		
		gfn_showAlert("CI30001", "임시저장 의뢰서가 존재 합니다. \n 확인 바랍니다.");
	}
	
}


 /********************************************************************************
 * 기      능   : 메일발송
 ********************************************************************************/
function fn_sendMail()
{
	 	 
	var rece_user = ds_mail.GetColumn(ds_mail.currow , "REQMAIL");	 	
	//var send_user = "youngho.song@hyundaielevator.com";
	var send_user = "QV@hdel.co.kr";
	var send_user_nm = "품질인증팀";	 

	var cc_user = "";
	var cc_user_nm = "";
	 
	var rece_user_nm = ds_mail.GetColumn(ds_mail.currow , "REQNM");
	 
	var title = ds_mail.GetColumn(ds_mail.currow , "TITLE"); // 타이틀 
	var reqseq = ds_mail.GetColumn(ds_mail.currow , "REQSEQ"); // 접수번호 
	 
	var maildt = ds_mail.GetColumn(ds_mail.currow , "MAILDT");
	var reqnm = ds_mail.GetColumn(ds_mail.currow , "REQNM"); // 의뢰자
	var reqvendnm = ds_mail.GetColumn(ds_mail.currow , "REQVENDNM"); // 의뢰자 팀명
	 	 
	var mesgtitl  = ""; //제목
	var mesgbody  = ""; //내용
	 
	var pop_meg = "";		 

	mesgtitl += title + " 시험의뢰가 정상적으로 의뢰 되었습니다.";
		 
	mesgbody = title + ' 시험의뢰가 정상적으로 의뢰 되었습니다. \n\n'; 
		 
	mesgbody =  mesgbody +'접수번호: ' + reqseq + '\n';
	mesgbody =  mesgbody +'의뢰일시: ' + maildt + '\n\n';
	
	mesgbody =  mesgbody +'의뢰자: ' + reqnm +'(' + reqvendnm + ')' + '\n';
		 
	mesgbody =  mesgbody +'의뢰한 내용 검토 후 담당자 지정 및 시험 완료 예정일 안내 하겠습니다. \n\n';
	mesgbody =  mesgbody +'시험 자료 및 내용이 불충분할 경우 반송 처리 될 수 있습니다. \n\n';
		 
	mesgbody =  mesgbody +'품질인증팀';
	 
	 if(rece_user != "")
	 {
 
		 tit_callService(
			 "COMM_ACT"
			 , "sendmailNew"
			 , ""
			 , ""
			 ," SEND_USER=" + quote( send_user )
				 + " RECV_USER=" + quote( rece_user )
				 + " CC_USER=" + quote(cc_user)
				 + " SEND_USER_NM=" + quote( send_user_nm )
				 + " RECV_USER_NM=" + quote( rece_user_nm )
				 + " CC_USER_NM=" + quote(cc_user_nm)
				 + " MESGTITL="  + quote( mesgtitl )
				 + " MESGBODY="  + quote( mesgbody )
			 , ""
			 , false
			 , true);
		 pop_meg = '메일이 발송 되었습니다.';	
	 }
	 
	 
	this.Close();
 }
 
 

 /********************************************************************************
 * 기      능   : 조회 for mail Callback
 ********************************************************************************/
 function fn_afterSquery(svcId, errCode, errMsg){
	fn_sendMail();	 
 }

/********************************************************************************
* 기      능   : 저장 Callback
********************************************************************************/
function fn_afterSave(svcId, errCode, errMsg)
{
	fn_destroyWait();		
	
	
	if ( errCode != 0 || ds_error.RowCount() > 0) 
	{
		gfn_showMsg("CE00001");		
		gfn_showAlert("CI30001", "저장 시 오류가 발생하였습니다. \n" +  ds_error.GetColumn( ds_error.row, "ERRMSG"));		
		return;
	} 	
	else 	
	{
		// 삭제한 첨부파일 삭제
		var rowcnt = ds_file.rowcount;
				
		for( var i = 0 ;  i < rowcnt ; i++ ) { 			
			var sFileName = ds_file.GetColumn(i, "FILENM");
			if(length(sFileName) != 0 && ds_file.GetColumn(i, "FLAG") == "D" ) {
				var arr = tit_fileDelete("QM",ds_file.getColumn(i, "FILENM_APP"), false);
			}
		}
		
		if( ds_master_cp2.GetColumn(ds_master_cp2.currow, "statcd") == "00")  {
			gfn_showAlert("CI30001", "임시저장 처리되었습니다." );
			gfn_showMsg("CI00003");
			this.close();
		} else {	
			gfn_showAlert("CI30001", "의뢰 처리되었습니다." );

			fn_squery();
		}
		
	}	
}

/********************************************************************************
* 기      능   : 첨부파일 추가
********************************************************************************/
function btn_add_OnClick(obj)
{

	var fileNameApp = "";
	
	if(ds_file.rowcount >= 30)
	{
		gfn_openMsgWin("추가할 수 있는 파일 개수를 초과했습니다.\n (최대 30개 저장가능)","","A");
		return;
	}
	
	var sRtn = fileDialog.open();
	
	if(sRtn == 0) return;	
	
	if ( length(fileDialog.FilePath) == 0 
		|| length(fileDialog.FileName ) == 0 ) {
		return;
	}	
	
	var fileSize = f_tmp.GetLength(fileDialog.FilePath + "\\" + fileDialog.FileName );
	if ( fileSize <= 0 ) {
		gfn_showAlert("CW00048");
		return;
	}
	
	if ( fileSize > toNumber(F_SIZE)) {
		gfn_showAlert("CW00047", "10 Mbytes" );	
		return;
	}	
	
	// 파일정보
	if(length(fileDialog.FileName) == 0 ) {
		gfn_showMsg("첨부 파일을 확인해 주세요.");
		return;
	}	
	
	var nRow = ds_file.AddRow();
	var nSeq =  fn_getMaxFileseq();	
	
	ds_file.setColumn(nRow, "FLAG"   , "I");
	ds_file.setColumn(nRow, "REQSEQ"  , ds_master.GetColumn(0, "REQSEQ" ));
	ds_file.SetColumn(nRow, "FILESEQ", nSeq);
	ds_file.setColumn(nRow, "FILESIZE", fileSize);
	ds_file.setColumn(nRow, "FILEPATH", fileDialog.FilePath);
	ds_file.setColumn(nRow, "FILENM", fileDialog.FileName);
	
	fileNameApp = left(GetDate(),8) +"_"+ right(GetDate(),6) +"_"+ G_USER_ID +"_"+ ds_file.getColumn(nRow, "FILESEQ");

	var arr = tit_fileWrite(httpFile
	, "QM"
	, ds_file.getColumn(nRow, "FILEPATH")
	, ds_file.getColumn(nRow, "FILENM")
	, fileNameApp// 실제 db에 저장될 파일 이름
	, "U"	  // time stamp를 붙이지 않을 경우 U 사용 
	//, ds_del_file.GetColumn(nRow,"FILENM"));    // ds_list_i.getColumn(i, "DEL_FNAME") );//삭제할 이전 파일명 
	, "" );
	
	if ( arr[0] == "S" ) {
		ds_file.setColumn(nRow, "FILEPATH", arr[1]);
		ds_file.setColumn(nRow, "FILENM_APP", arr[2]);		
	} else if ( arr[0] != "S" ) {
		gfn_showMsg("CW00035"); 
		alert(arr[0]);
		return;
	}	
	
}


function fn_getMaxFileseq()
{ 
	var max_seq 	= 0;
	var seq 		= 0; 
	for (var i=0;i<ds_file.GetCount();i++)
	{
		seq = ds_file.GetColumn(i, "FILESEQ");  
		if (ToNumber(seq) > ToNumber(max_seq))
		{
			max_seq = seq;
		}
	}
	return ToNumber(max_seq) + 1;
}


/********************************************************************************
* 기      능   : 첨부파일 삭제
********************************************************************************/
function btn_del_OnClick(obj)
{
	var nRow = ds_file.currow;
	
	if ( nRow > -1 ) {	
		var sRowType = ds_file.GetRowType(nRow);
		if ( sRowType == "insert" ) {
				
			var sFileName = ds_file.GetColumn(nRow, "FILENM");
			
			if(length(sFileName) != 0) {
				var arr = tit_fileDelete("QM",ds_file.getColumn(nRow, "FILENM_APP"), false);
			}
	
			ds_file.DeleteRow(nRow);
		} else {
			ds_file.SetColumn(nRow, "FLAG", "D");		
		}			
	}
}



/********************************************************************************
* 기      능   : 그리드 더블클릭으로 파일 다운로드
********************************************************************************/
function grd_file_OnCellDblClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
	var svrFileName = ds_file.GetColumn(nRow, "FILENM_APP");
	var orgFileName = ds_file.GetColumn(nRow, "FILENM");
	var ext         = gfn_getFileExt(ds_file.getColumn(nRow, "FILENM"));
	
	saveDialog.FileName = orgFileName;
	saveDialog.Filter = "All(*.*)|*.*";
    saveDialog.Open();

	var idx = indexOf(saveDialog.FileName, ".");
	var fdFileName = saveDialog.FileName;
    var fileName =  decode(idx, -1, fdFileName, substr(fdFileName, 0, indexOf(fdFileName, ".")));
    var localFileName = fileName + "." + ext;

	var rMsg = tit_fileRead(
							httpFile
							, F_SERVER_DIR			// 저장 디렉토리
							, svrFileName			// 서버에서 전송받을 이름
							, saveDialog.FilePath	// 로컬 경로
							, localFileName			// 로컬 파일명
	);
	
	if ( rMsg[0] == "E" ) {
		if ( length(trim(rMsg[1])) > 0 ) {
			gfn_showAlert("CW10025", rMsg[1]);
		} else {
			gfn_showAlert("CW10025", "파일 다운로드에 실패하였습니다.");
		}
	} else if ( rMsg[0] == null  || rMsg[0] == "" ) {
		gfn_showAlert("CW10025", "해당파일이 존재하지 않습니다.");
	} else {
		gfn_showAlert("CW10025", "파일을 다운로드 하였습니다.");
	}
}

/********************************************************************************
* 기      능   : 시험항목 (+)버튼
********************************************************************************/
function btn_testadd_OnClick(obj)
{	
	if(ds_test.rowcount >= 20)
	{
		gfn_openMsgWin("추가할 수 있는 시험항목을 초과했습니다.\n (최대 20개 저장가능)","","A");
		return;
	}

	ds_test.AddRow();
}

/********************************************************************************
* 기      능   : 시험항목 (-)버튼
********************************************************************************/
function btn_testdel_OnClick(obj)
{
	ds_test.DeleteRow(ds_test.row);
	modFlg = true;
}

/********************************************************************************
* 기      능   : 법적요구사항 용도추가 체크박스 단건 선택만 가능
********************************************************************************/

function chk_nayn_OnClick(obj,strValue)
{
	if(strValue) {
		chk_chklstyn.Value = false;
		chk_contyn.Value = false;
		ed_lawrq_code.Text = "";
		ed_lawrq_code.Enable = false;
	}
}
function chk_chklstyn_OnClick(obj,strValue)
{
	if(strValue) {
		chk_nayn.Value = false;
		ed_lawrq_code.Enable = true;
	}
}
function chk_contyn_OnClick(obj,strValue)
{
	if(strValue) {
		chk_nayn.Value = false;
		ed_lawrq_code.Enable = true;
	}
}


/********************************************************************************
* 기      능   : 유첨내용 해당사항없음
********************************************************************************/
function chk_attna_OnClick(obj,strValue)
{
	if(strValue) {
		chk_att01.Value = false;
		chk_att02.Value = false;
		chk_att03.Value = false;
		chk_att04.Value = false;
		chk_att05.Value = false;
		chk_att06.Value = false;
		chk_att07.Value = false;
		chk_att08.Value = false;	
	}
}

function chk_att01_OnClick(obj,strValue)
{
	if(strValue) {
		chk_attna.Value = false;
	}	
}


function cb_testgbn_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	if(strCode == "ETC" ) { 
		ed_testgbn_etctxt.Visible = true;
	} else {
		ed_testgbn_etctxt.Value = "";
		ed_testgbn_etctxt.Visible = false;
	}	
}

/********************************************************************************
* 기      능   : PDM 팝업
********************************************************************************/
function btn_pdm_OnClick(obj)
{		
	//var url = "http://plm.hdel.co.kr/jsp/help/SRMopenDrawing.jsp?md$number=";
	
	var bfmatnr = ed_bfmatnr.Text;
	
	if( bfmatnr == null || bfmatnr == '' || bfmatnr == 'N/A' || bfmatnr == '해당없음' ) {
		gfn_showAlert("도면번호 입력 후 Check를 눌러 주시기 바랍니다." );
		return;
	}
	
	//url = url + bfmatnr;
			
	//ExecBrowser(url);
	
	//if(G_USER_ID == "TEST07") {
		// 도면번호 넘기기
		ds_cond2.SetColumn(0,"POSID",ds_master.GetColumn(0,"BFMATNR"));
		
		//ds_pdm.ClearData();
		// DB2 에서 oracle 쿼리를 사용하기 위해 넘기는 부분
		fn_pdmQuery();
        
   // }
	
}


/********************************************************************************
* 기      능   : PDM 도면 유무 확인 후 메세지 팝업 
********************************************************************************/
function fn_pdmQuery() {

	tit_callService(
          "PS0101001A_ACT"
        , "pdmexecute"
        , "ds_cond=ds_cond2"
        , "ds_pdm=ds_pdm"
        , ""
        , ""
        , true
        , true
        , true);
     
	//for (var i = 0; i < ds_pdm.RowCount(); i++) {
		G_CATE = ds_pdm.GetColumn(0, 'CATE');
		
		// 오라클에서 넘어오는 값에 따라 메세지 팝업 호출
		if (G_CATE == '0') {
			gfn_showAlert("CW10025", "정상적으로 입력 되었습니다. 의뢰 진행 바랍니다.");
		} else if (G_CATE == 'wip') {
			gfn_showAlert("CW10025", "wip version을 입력하셨습니다. 정식도면 번호 입력해 주시기 바랍니다.");
		} else {
			gfn_showAlert("CW10025", "입력하신 도면번호는 PLM 서버에 없습니다. 다시 한번 확인 후 입력 해 주시기 바랍니다.");
		}
		// 로컬에서 테스트시 oracle 부분이 연결이 안돼어 있어 임시 값을 넣어 테스트 하는 부분
		//ds_pdm.SetColumn(0, "CATE", "0");	  0 : 승인, wip 외 나머지 미승인 
}

/********************************************************************************
* 기      능   : 도면번호 DETAIL
********************************************************************************/
function btn_bfmatnr_OnClick(obj)
{
	//var rtn = gfn_openPopup("QM1001002C",true);
	var rtn = gfn_openPopUpUrlHdel("QM10::QM1001002C.xml", true, "");

	if ( rtn !=null && rtn != "" && rtn != "0" ) 
	{
		ed_bfmatnr.Value = rtn[0];
		ed_goodsnm.Value = rtn[1];
		
		ds_master.SetColumn(ds_master.row, "MODELNM", rtn[3]);	
	}	
}

/********************************************************************************
* 기      능   : 의뢰자 DETAIL
********************************************************************************/
function btn_reqnm_OnClick(obj)
{
	var arg = " fa_sman_nm = " + quote(ed_reqnm.text); // 담당자명 

	var arr = gfn_openPopUpUrlHdel("QM10::QM1001002D.xml", true, arg);
	
	if (arr != null && arr != 0) {
		ed_reqid.text = arr[0];	// 리턴된 담당자코드로 검색조건 SET
		ed_reqnm.text = arr[1];	// 리턴된 담당자명으로 검색조건 SET
		ed_reqvendnm.Text = arr[2];  // 소속팀
		ed_reqcell.Text = arr[3];  // 연락처
		ed_reqnm.SetFocus();
	} 	
}

/********************************************************************************
* 기      능   : 제조사 DETAIL
********************************************************************************/
function btn_cpnnm_OnClick(obj)
{
	var arg = " fa_cpnnm = " + quote(ed_cpnnm.text); // 제조사명
	
	var arr = gfn_openPopUpUrlHdel("QM10::QM1001002E.xml", true, arg);
	
		if (arr != null && arr != 0) {
		
			ed_cpnnm.text = arr[1];	// 회사명
			ed_cpnno.text = arr[0];	// 회사코드 			
			ed_cpnnm.SetFocus();
	}	
}

/********************************************************************************
* 기      능   : 데이터셋 값 변경 시 - Flag 처리 
********************************************************************************/
function ds_test_CanColumnChange(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{
	gfn_changeFlag( obj, strColumnID, nRow, "FLAG" );
}


/********************************************************************************
* 기      능   : Null check
********************************************************************************/
function fn_chkVal()
{
	var dscnt = ds_master.GetColCount();
		
	// 마스터 테이블
	for ( var i=0 ; i < dscnt ; i++ ) {
		
		var val = ds_master_chk.GetColumn(0, ds_master.GetColID(i));
		
		if( !( val == null || val == '0' || val == '' ) && Length(Trim(ds_master.getColumn(0, ds_master.GetColID(i)))) == 0 ) {				
			gfn_showAlert("CI30001", val + " 항목은 필수 항목입니다." );
			return false;
		}
	}
	
	var reqgbn = ds_master.GetColumn(0, "REQGBN"); 			// 의뢰구분
	var G_TESTGBN = ds_master.GetColumn(0, "TESTGBN");		// 시험구분
	
	// 의뢰구분 ( M - 기계, E - 전기 ) 이면 도면번호 필수 체크  
	if(  reqgbn != "D" &&  reqgbn != "P" ) {
	
		// 시험구분 REF -참고용 일때는 도면번호 필수 체크 제외 
		if( G_TESTGBN != "REF" ){
	
			if ( ds_master.GetColumn(0, "BFMATNR") == null || ds_master.GetColumn(0, "BFMATNR") == '' ){
				gfn_showAlert("CI30001", "도면번호 입력 후 Check를 눌러 주시기 바랍니다" );
				return false;
			}
			
			if ( ds_pdm.GetColumn(0, "CATE") == null || ds_pdm.GetColumn(0, "CATE") == '' || ds_pdm.GetColumn(0, "CATE") != "0" ){
				gfn_showAlert("CI30001", "도면번호 Check를 클릭하여 도면번호를 확인 바랍니다." );
				return false;
			}
			
		}

	}
	
	// 시험 정보 	
	var testcnt = ds_test.rowcount;
	
	if ( testcnt < 1 ) { 
		gfn_showAlert("CI30001", "시험항목을 입력해 주세요." );			
		return false;		
	}
	
	for ( var i=0 ; i < testcnt ; i++) {
	
		// 4,5,6 컬럼 입력항목		
		if( Length(Trim(ds_test.getColumn(i, "TESTNM"))) == 0 ) {
			gfn_showAlert("CI30001", "시험정보 " + (i+1) + "번째 행에 입력되지 않은 값이 있습니다.");
			return false;		
		}
		
		if( Length(Trim(ds_test.getColumn(i, "TESTCONT1"))) == 0 ) {
			gfn_showAlert("CI30001", "시험정보 " + (i+1) + "번째 행에 입력되지 않은 값이 있습니다.");
			return false;		
		}
		
		if( Length(Trim(ds_test.getColumn(i, "TESTCONT2"))) == 0 ) {
			gfn_showAlert("CI30001", "시험정보 " + (i+1) + "번째 행에 입력되지 않은 값이 있습니다.");
			return false;
		}
		
	}
	
	if( !(chk_attna.Value 
		|| chk_att01.Value
		|| chk_att02.Value
		|| chk_att03.Value
		|| chk_att04.Value
		|| chk_att05.Value
		|| chk_att06.Value
		|| chk_att07.Value
		|| chk_att08.Value )) {	
		gfn_showAlert("CI30001", " 유첨내용을 확인해 주세요. " );
		chk_att_cnfrmyn.SetFocus();
		return false;
	}		
		
	if(!chk_attna.Value) {
		// 첨부파일
		var filecnt = ds_file.rowcount;
		
		if ( filecnt < 1 ) { 
			gfn_showAlert("CI30001", "파일을 첨부해 주세요." );
			return false;		
		}
		
		for ( var i=0 ; i < filecnt ; i++) {	
			if( Length(Trim(ds_file.getColumn(i, "FILENM"))) == 0 ) {
				gfn_showAlert("CI30001", "첨부파일 " + (i+1) + "번째 행에 입력되지 않은 값이 있습니다.");
				return false;
			}
		}
	}
		
	if(chk_att_cnfrmyn.Value == null || chk_att_cnfrmyn.Value == "" || chk_att_cnfrmyn.Value == "0") {
	
		gfn_showAlert("CI30001", "유첨내용의 유의사항을 확인해 주세요" );
		chk_att_cnfrmyn.SetFocus();
		return false;
	}
		
	if( !(chk_chklstyn.Value || chk_contyn.Value|| chk_nayn.Value )) {	
		gfn_showAlert("CI30001", " 법적요구사항을 확인해 주세요. " );
		chk_att_cnfrmyn.SetFocus();
		return false;
	}	
	
	if( chk_chklstyn.Value || chk_contyn.Value ) {	
		if( Length(Trim(ed_lawrq_code.Text)) == 0 ) {
			gfn_showAlert("CI30001", " 적용 CODE를 확인해 주세요. " );
			ed_lawrq_code.SetFocus();
			return false;
		}	
	}
	
	// 차수 증가 의뢰일 경우 개선대책보고서 필수
	var degree = toNumber(trim(ds_master.GetColumn(ds_master.row, "DEGREE"))) ;
	if( degree != null && degree > 1 ) {
		
		if( Length(Trim(ds_master.getColumn(ds_master.row, "IMP_FILENM"))) == 0 ) {
		
			gfn_showAlert("CI30001", " 개선대책보고서를 확인해 주세요. " );
			div_imp.ed_imp_filename.SetFocus();
			return false;		
		}		
	}
		
	return true;
}

function ed_cpnnm_OnChanged(obj,strText)
{
	ed_cpnno.Text = "";
}


function fn_download_file(obj,nRow,nCell,nX,nY,nPivotIndex) {
	fn_createWait("", this);

	//var FileName = ds_list10.getColumn(nRow, "FNAME");
	//var FPATH = ds_list10.getColumn(nRow, "FPATH");
	
	var FileName = "";
	var FPATH = "";

	if (Length(FPATH) == 0 && Length(FileName) == 0) {
		gfn_showAlert("CI30001", "파일이 존재하지 않습니다.");
		return;
	}
	
	
	saveDialog.FileName = FileName;

	if (saveDialog.open()) {
		tit_fileReadFromFtpServer(
			httpFile
			, FPATH
			, FileName
			, saveDialog.FilePath
			, saveDialog.FileName
		);
	}

	fn_destroyWait();
}

/********************************************************************************
* 기      능   : 개선대책 보고서 다운로드
********************************************************************************/
function div_imp_btn_imp_download_OnClick(obj)
{

	if (length( div_imp.ed_imp_filename.value ) == 0 ) {
		gfn_showAlert("CW10025", "개선대책 보고서 파일이 존재하지 않습니다.");
		return;
	}
	
	var svrFileName = ds_master.GetColumn(0, "IMP_FILENM_APP");
	var orgFileName = ds_master.GetColumn(0, "IMP_FILENM");
	var ext         = gfn_getFileExt(ds_master.getColumn(0, "IMP_FILENM"));
	
	saveDialog1.FileName = orgFileName;
	saveDialog1.Filter = "All(*.*)|*.*";
    saveDialog1.Open();

	var idx = indexOf(saveDialog1.FileName, ".");
	var fdFileName = saveDialog1.FileName;
    var fileName =  decode(idx, -1, fdFileName, substr(fdFileName, 0, indexOf(fdFileName, ".")));
    var localFileName = fileName + "." + ext;
        
	var rMsg = tit_fileRead(
							httpFile
							, F_SERVER_DIR			// 저장 디렉토리
							, svrFileName			// 서버에서 전송받을 이름
							, saveDialog1.FilePath	// 로컬 경로
							, localFileName			// 로컬 파일명
	);
	
	if ( rMsg[0] == "E" ) {
		if ( length(trim(rMsg[1])) > 0 ) {
			alert(rMsg[1]);
			gfn_showAlert("CW10025", rMsg[1]);
		} else {
			gfn_showAlert("CW10025", "파일 다운로드에 실패하였습니다.");
		}
	} else if ( rMsg[0] == null  || rMsg[0] == "" ) {
		gfn_showAlert("CW10025", "해당파일이 존재하지 않습니다.");
	} else {
	
		//alert(rMsg[1]);
		rMsg = null;
		
		gfn_showAlert("CW10025", "파일을 다운로드 하였습니다.");
	}	
}

/********************************************************************************
* 기      능   : 개선대책  보고서 파일 첨부(선택)
********************************************************************************/
function div_imp_btn_imp_openfile_OnClick(obj)
{

	fileDialog1.open();

	if ( length(fileDialog1.FilePath) == 0 
		|| length( fileDialog1.FileName ) == 0 ) {
		return;
	}

	var fileSize = f_tmp.GetLength(fileDialog1.FilePath + "\\" + fileDialog1.FileName );
	if ( fileSize <= 0 ) {
		gfn_showAlert("CW00048");
		return;
	}
	
	/*
	if ( toNumber(maxFileSize) > 0 ) {
		if ( fileSize > toNumber(maxFileSize)) {
			gfn_showAlert("CW00047", maxFileSize/1024 + "K bytes" );
			return;
		}
	}
	*/
	
	_F_FILE_DIR =  fileDialog1.FilePath;
	_F_FILE_NAME = fileDialog1.FileName;
	_F_FILE_SIZE = fileSize;
	
	div_imp.ed_imp_filename.value = "";	
	
	// 파일명
	div_imp.ed_imp_filename.value = _F_FILE_NAME;
	
	// 서버저장 
	fn_save_impfile(obj);	
}

/********************************************************************************
* 기      능   : 개선대책보고서 파일 첨부(저장)
********************************************************************************/
function fn_save_impfile(obj)
{	
	var fileNameApp = left(GetDate(),8) +"_"+ right(GetDate(),6) +"_"+ G_USER_ID;

	var arr = tit_fileWrite( 
			httpFile
			, "QM"
			, _F_FILE_DIR
			, _F_FILE_NAME	//로컬파일명
			, fileNameApp // 실제 db에 저장될 파일 이름
			, "U"
			, _SERVER_FNAME ); //삭제할 이전 파일명 

	// 처리 결과 확인하기 
	if( arr[0] != "S" ) {
		gfn_showAlert( arr[0] );			
	} else {
	
		_SERVER_FNAME = fileNameApp;
		
		ds_master.SetColumn(ds_master.row, "IMP_FILENM" , _F_FILE_NAME);
		ds_master.SetColumn(ds_master.row, "IMP_FILEPATH" , arr[1]);
		ds_master.SetColumn(ds_master.row, "IMP_FILENM_APP" , arr[2]);
		
		// 저장 하지 않고 CLOSE 시 삭제 처리용
		_F_FILENM_APP_DEL = arr[2];			
					

	}
}


/********************************************************************************
* 기      능   : 품목검색 DETAIL
********************************************************************************/
function btn_model_OnClick(obj)
{
	var arg = " fa_reqgbn = " + quote(decode(cb_reqgbn.value,'P','','D','', cb_reqgbn.value)); // 의뢰구분	

	var rtn = gfn_openPopUpUrlHdel("QM10::QM1001002K.xml", true, arg);

	if ( rtn !=null && rtn != "" && rtn != "0" ) 
	{
		ed_goodsnm.Value = rtn[0];
		ds_master.SetColumn(ds_master.row, "BLOCKCD" , rtn[1]); // 품목코드		
		ds_master.SetColumn(ds_master.row, "POSITIONNM" , rtn[2]); // 위치
	//	ds_master.SetColumn(ds_master.row, "REQGBN" , rtn[3]); // 의뢰구분		// 이효재 팀원 요청으로 품명 선택시 의뢰구분 변경 되는것 차단 20210716
	}		
}
]]></Script>
</Window>