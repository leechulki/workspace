<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="1200" Id="QM1001003G" Left="8" OnLoadCompleted="fn_OnLoadCompleted" OnUnloadCompleted="fn_OnUnloadCompleted" PidAttrib="7" Title="Pilot&#32;접수&#32;Body" Top="8" Ver="1.0" Width="792" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_cond">
				<Contents>
					<colinfo id="FORMGBN" size="256" summ="default" type="STRING"/>
					<colinfo id="REQSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="TESTREV" size="256" summ="default" type="STRING"/>
					<record>
						<FORMGBN></FORMGBN>
						<REQSEQ></REQSEQ>
						<TESTREV/>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_error">
				<Contents>
					<colinfo id="IDX" size="256" type="STRING"/>
					<colinfo id="ERRMSG" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_file">
				<Contents>
					<colinfo id="FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="REQSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="FILESEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="FILENM" size="256" summ="default" type="STRING"/>
					<colinfo id="FILEPATH" size="256" summ="default" type="STRING"/>
					<colinfo id="FILENM_APP" size="256" summ="default" type="STRING"/>
					<colinfo id="FILESIZE" size="256" summ="default" type="STRING"/>
					<colinfo id="TEMP" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Editable="True" Id="ds_test" OnColumnChanged="ds_test_OnColumnChanged">
				<Contents>
					<colinfo id="CHECK" size="256" summ="default" type="STRING"/>
					<colinfo id="REQSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="TESTSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="TESTNM" size="256" summ="default" type="STRING"/>
					<colinfo id="TESTCONT1" size="256" summ="default" type="STRING"/>
					<colinfo id="TESTCONT2" size="256" summ="default" type="STRING"/>
					<colinfo id="USEYN" size="256" summ="default" type="STRING"/>
					<colinfo id="CREID" size="256" summ="default" type="STRING"/>
					<colinfo id="CREDT" size="256" summ="default" type="STRING"/>
					<colinfo id="MODID" size="256" summ="default" type="STRING"/>
					<colinfo id="MODDT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_code_reqgbn">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE>M</CODE>
						<CODE_NAME>기계</CODE_NAME>
					</record>
					<record>
						<CODE>E</CODE>
						<CODE_NAME>전기</CODE_NAME>
					</record>
					<record>
						<CODE>D</CODE>
						<CODE_NAME>의장</CODE_NAME>
					</record>
					<record>
						<CODE>P</CODE>
						<CODE_NAME>프로그램</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_code_goodsgbn">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE>E/L</CODE>
						<CODE_NAME>E/L</CODE_NAME>
					</record>
					<record>
						<CODE>E/S</CODE>
						<CODE_NAME>E/S</CODE_NAME>
					</record>
					<record>
						<CODE>ETC</CODE>
						<CODE_NAME>기타</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Editable="True" Id="ds_master_cp2">
				<Contents></Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_file_cp">
				<Contents></Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Editable="True" Id="ds_test_cp">
				<Contents></Contents>
			</Dataset>
			<Dataset CanColumnChange="ds_test_CanColumnChange" DataSetType="Dataset" Editable="True" Id="ds_rnd">
				<Contents>
					<colinfo id="CHECK" size="256" summ="default" type="STRING"/>
					<colinfo id="REQSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="RNDSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="GOODSNM" size="256" summ="default" type="STRING"/>
					<colinfo id="MODELNM" size="256" summ="default" type="STRING"/>
					<colinfo id="BFMATNR" size="256" summ="default" type="STRING"/>
					<colinfo id="RNDCONT" size="256" summ="default" type="STRING"/>
					<colinfo id="FILENM" size="256" summ="default" type="STRING"/>
					<colinfo id="FILEPATH" size="256" summ="default" type="STRING"/>
					<colinfo id="FILENM_APP" size="256" summ="default" type="STRING"/>
					<colinfo id="BIGO" size="256" summ="default" type="STRING"/>
					<colinfo id="USEYN" size="256" summ="default" type="STRING"/>
					<colinfo id="CREID" size="256" summ="default" type="STRING"/>
					<colinfo id="CREDT" size="256" summ="default" type="STRING"/>
					<colinfo id="MODID" size="256" summ="default" type="STRING"/>
					<colinfo id="MODDT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset CanColumnChange="ds_test_CanColumnChange" DataSetType="Dataset" Editable="True" Id="ds_rnd_cp">
				<Contents></Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Editable="True" Id="ds_master_chk">
				<Contents>
					<colinfo id="REQSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="TITLE" size="256" summ="default" type="STRING"/>
					<colinfo id="FORMGBN" size="256" summ="default" type="STRING"/>
					<colinfo id="STATCD" size="256" summ="default" type="STRING"/>
					<colinfo id="GOODSGBN" size="256" summ="default" type="STRING"/>
					<colinfo id="REQDT" size="256" summ="default" type="STRING"/>
					<colinfo id="REQGBN" size="256" summ="default" type="STRING"/>
					<colinfo id="REQVENDNM" size="256" summ="default" type="STRING"/>
					<colinfo id="REQID" size="256" summ="default" type="STRING"/>
					<colinfo id="REQNM" size="256" summ="default" type="STRING"/>
					<colinfo id="REQCELL" size="256" summ="default" type="STRING"/>
					<colinfo id="BFMATNR" size="256" summ="default" type="STRING"/>
					<colinfo id="FTREPORTCD" size="256" summ="default" type="STRING"/>
					<colinfo id="REQATTDCD" size="256" summ="default" type="STRING"/>
					<colinfo id="TECHATTDCD" size="256" summ="default" type="STRING"/>
					<colinfo id="TESTGBN" size="256" summ="default" type="STRING"/>
					<colinfo id="TESTGBN_ETCTXT" size="256" summ="default" type="STRING"/>
					<colinfo id="SMPCNT" size="256" summ="default" type="STRING"/>
					<colinfo id="CPNCD" size="256" summ="default" type="STRING"/>
					<colinfo id="CPNNM" size="256" summ="default" type="STRING"/>
					<colinfo id="SMPQLT" size="256" summ="default" type="STRING"/>
					<colinfo id="GOODSNM" size="256" summ="default" type="STRING"/>
					<colinfo id="MODELNM" size="256" summ="default" type="STRING"/>
					<colinfo id="LAWRQ_CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="LAWRQ_CHKLSTYN" size="256" summ="default" type="STRING"/>
					<colinfo id="LAWRQ_CONTYN" size="256" summ="default" type="STRING"/>
					<colinfo id="LAWRQ_NAYN" size="256" summ="default" type="STRING"/>
					<colinfo id="ATT_CNFRMYN" size="256" summ="default" type="STRING"/>
					<colinfo id="ATT_SPECYN" size="256" summ="default" type="STRING"/>
					<colinfo id="ATT_BPYN" size="256" summ="default" type="STRING"/>
					<colinfo id="ATT_CHKLSTYN" size="256" summ="default" type="STRING"/>
					<colinfo id="ATT_PAXYN" size="256" summ="default" type="STRING"/>
					<colinfo id="ATT_KCSYN" size="256" summ="default" type="STRING"/>
					<colinfo id="ATT_FTFLOWYN" size="256" summ="default" type="STRING"/>
					<colinfo id="ATT_STRPTYN" size="256" summ="default" type="STRING"/>
					<colinfo id="ATT_IMPRPTYN" size="256" summ="default" type="STRING"/>
					<colinfo id="ATT_NAYN" size="256" summ="default" type="STRING"/>
					<colinfo id="HOGI" size="256" summ="default" type="STRING"/>
					<colinfo id="SPEC" size="256" summ="default" type="STRING"/>
					<colinfo id="CTESTYMD" size="256" summ="default" type="STRING"/>
					<colinfo id="BOSUCONTACT" size="256" summ="default" type="STRING"/>
					<colinfo id="ETC" size="256" summ="default" type="STRING"/>
					<colinfo id="THOGI" size="256" summ="default" type="STRING"/>
					<colinfo id="ATYPE" size="256" summ="default" type="STRING"/>
					<colinfo id="AUSE" size="256" summ="default" type="STRING"/>
					<colinfo id="PCNT" size="256" summ="default" type="STRING"/>
					<colinfo id="CAPA" size="256" summ="default" type="STRING"/>
					<colinfo id="STCNT" size="256" summ="default" type="STRING"/>
					<colinfo id="DOMETER" size="256" summ="default" type="STRING"/>
					<colinfo id="ABYN" size="256" summ="default" type="STRING"/>
					<colinfo id="TMSPEC" size="256" summ="default" type="STRING"/>
					<colinfo id="CONSOLE" size="256" summ="default" type="STRING"/>
					<colinfo id="INVERTER" size="256" summ="default" type="STRING"/>
					<colinfo id="ROPE_MG" size="256" summ="default" type="STRING"/>
					<colinfo id="ROPING" size="256" summ="default" type="STRING"/>
					<colinfo id="COMPENCHAIN" size="256" summ="default" type="STRING"/>
					<colinfo id="RAIL_CC" size="256" summ="default" type="STRING"/>
					<colinfo id="GUIDESHOE_CAR" size="256" summ="default" type="STRING"/>
					<colinfo id="GUIDESHOE_CWT" size="256" summ="default" type="STRING"/>
					<colinfo id="BRAKESPEC" size="256" summ="default" type="STRING"/>
					<colinfo id="REGULATOR" size="256" summ="default" type="STRING"/>
					<colinfo id="STOPEQP" size="256" summ="default" type="STRING"/>
					<colinfo id="USEYN" size="256" summ="default" type="STRING"/>
					<colinfo id="CREID" size="256" summ="default" type="STRING"/>
					<colinfo id="CREDT" size="256" summ="default" type="STRING"/>
					<colinfo id="MODID" size="256" summ="default" type="STRING"/>
					<colinfo id="MODDT" size="256" summ="default" type="STRING"/>
					<colinfo id="VELOCITY" size="256" summ="default" type="STRING"/>
					<record>
						<ABYN>0</ABYN>
						<ATT_BPYN>0</ATT_BPYN>
						<ATT_CHKLSTYN>0</ATT_CHKLSTYN>
						<ATT_CNFRMYN>0</ATT_CNFRMYN>
						<ATT_FTFLOWYN>0</ATT_FTFLOWYN>
						<ATT_IMPRPTYN>0</ATT_IMPRPTYN>
						<ATT_KCSYN>0</ATT_KCSYN>
						<ATT_NAYN>0</ATT_NAYN>
						<ATT_PAXYN>0</ATT_PAXYN>
						<ATT_SPECYN>0</ATT_SPECYN>
						<ATT_STRPTYN>0</ATT_STRPTYN>
						<ATYPE>0</ATYPE>
						<AUSE>0</AUSE>
						<BFMATNR>0</BFMATNR>
						<BOSUCONTACT>보수&#32;점검자/연락처</BOSUCONTACT>
						<BRAKESPEC>0</BRAKESPEC>
						<CAPA>0</CAPA>
						<COMPENCHAIN>0</COMPENCHAIN>
						<CONSOLE>0</CONSOLE>
						<CPNCD>0</CPNCD>
						<CPNNM>0</CPNNM>
						<CREDT>0</CREDT>
						<CREID>0</CREID>
						<CTESTYMD>완성검사일</CTESTYMD>
						<DOMETER>0</DOMETER>
						<ETC>기타</ETC>
						<FORMGBN>0</FORMGBN>
						<FTREPORTCD>기능시험&#32;성적서</FTREPORTCD>
						<GOODSGBN>제품구분</GOODSGBN>
						<GOODSNM>0</GOODSNM>
						<GUIDESHOE_CAR>0</GUIDESHOE_CAR>
						<GUIDESHOE_CWT>0</GUIDESHOE_CWT>
						<HOGI>호기정보</HOGI>
						<INVERTER>0</INVERTER>
						<LAWRQ_CHKLSTYN>0</LAWRQ_CHKLSTYN>
						<LAWRQ_CODE>0</LAWRQ_CODE>
						<LAWRQ_CONTYN>0</LAWRQ_CONTYN>
						<LAWRQ_NAYN>0</LAWRQ_NAYN>
						<MODDT>0</MODDT>
						<MODELNM>0</MODELNM>
						<MODID>0</MODID>
						<PCNT>0</PCNT>
						<RAIL_CC>0</RAIL_CC>
						<REGULATOR>0</REGULATOR>
						<REQATTDCD>의뢰자&#32;입회여부</REQATTDCD>
						<REQCELL>의뢰자&#32;연락처</REQCELL>
						<REQDT>0</REQDT>
						<REQGBN>의뢰구분</REQGBN>
						<REQID>의뢰자번호</REQID>
						<REQNM>의뢰자명</REQNM>
						<REQSEQ>0</REQSEQ>
						<REQVENDNM>의뢰팀</REQVENDNM>
						<ROPE_MG>0</ROPE_MG>
						<ROPING>0</ROPING>
						<SMPCNT>0</SMPCNT>
						<SMPQLT>0</SMPQLT>
						<SPEC>사양정보</SPEC>
						<STATCD>0</STATCD>
						<STCNT>0</STCNT>
						<STOPEQP>0</STOPEQP>
						<TECHATTDCD>기술팀&#32;입회여부</TECHATTDCD>
						<TESTGBN>0</TESTGBN>
						<TESTGBN_ETCTXT>0</TESTGBN_ETCTXT>
						<THOGI>0</THOGI>
						<TITLE>제목</TITLE>
						<TMSPEC>0</TMSPEC>
						<USEYN>0</USEYN>
						<VELOCITY>0</VELOCITY>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_code_reqattdcd">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE>A</CODE>
						<CODE_NAME>입회</CODE_NAME>
					</record>
					<record>
						<CODE>N</CODE>
						<CODE_NAME>미입회</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_code_techattdcd">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE>T</CODE>
						<CODE_NAME>설치기술팀</CODE_NAME>
					</record>
					<record>
						<CODE>S</CODE>
						<CODE_NAME>S/E팀</CODE_NAME>
					</record>
					<record>
						<CODE>N</CODE>
						<CODE_NAME>미입회</CODE_NAME>
					</record>
					<record>
						<CODE>TS</CODE>
						<CODE_NAME>설치기술팀,&#32;S/E팀</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_code_ftreportcd">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE>E</CODE>
						<CODE_NAME>유</CODE_NAME>
					</record>
					<record>
						<CODE>N</CODE>
						<CODE_NAME>무</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_testrev">
				<Contents>
					<colinfo id="val" size="256" summ="default" type="STRING"/>
					<record>
						<val>1</val>
					</record>
					<record>
						<val>2</val>
					</record>
					<record>
						<val>3</val>
					</record>
					<record>
						<val>4</val>
					</record>
					<record>
						<val>5</val>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Editable="True" Id="ds_testinfo" OnColumnChanged="ds_test_OnColumnChanged">
				<Contents>
					<colinfo id="REQSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="TESTREV" size="256" summ="default" type="STRING"/>
					<colinfo id="TESTSYMD" size="256" summ="default" type="STRING"/>
					<colinfo id="TESTPYMD" size="256" summ="default" type="STRING"/>
					<colinfo id="CHNSRSN" size="256" summ="default" type="STRING"/>
					<colinfo id="USEYN" size="256" summ="default" type="STRING"/>
					<colinfo id="CREID" size="256" summ="default" type="STRING"/>
					<colinfo id="CREDT" size="256" summ="default" type="STRING"/>
					<colinfo id="MODID" size="256" summ="default" type="STRING"/>
					<colinfo id="MODDT" size="256" summ="default" type="STRING"/>
					<colinfo id="OTESTREV" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Editable="True" Id="ds_testinfo_cp">
				<Contents></Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Editable="True" Id="ds_master" OnColumnChanged="ds_master_OnColumnChanged">
				<Contents>
					<colinfo id="REQSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="TITLE" size="256" summ="default" type="STRING"/>
					<colinfo id="FORMGBN" size="256" summ="default" type="STRING"/>
					<colinfo id="STATCD" size="256" summ="default" type="STRING"/>
					<colinfo id="GOODSGBN" size="256" summ="default" type="STRING"/>
					<colinfo id="REQDT" size="256" summ="default" type="STRING"/>
					<colinfo id="REQGBN" size="256" summ="default" type="STRING"/>
					<colinfo id="REQVENDNM" size="256" summ="default" type="STRING"/>
					<colinfo id="REQID" size="256" summ="default" type="STRING"/>
					<colinfo id="REQNM" size="256" summ="default" type="STRING"/>
					<colinfo id="REQCELL" size="256" summ="default" type="STRING"/>
					<colinfo id="BFMATNR" size="256" summ="default" type="STRING"/>
					<colinfo id="FTREPORTCD" size="256" summ="default" type="STRING"/>
					<colinfo id="REQATTDCD" size="256" summ="default" type="STRING"/>
					<colinfo id="TECHATTDCD" size="256" summ="default" type="STRING"/>
					<colinfo id="TESTGBN" size="256" summ="default" type="STRING"/>
					<colinfo id="TESTGBN_ETCTXT" size="256" summ="default" type="STRING"/>
					<colinfo id="SMPCNT" size="256" summ="default" type="STRING"/>
					<colinfo id="CPNCD" size="256" summ="default" type="STRING"/>
					<colinfo id="CPNNM" size="256" summ="default" type="STRING"/>
					<colinfo id="SMPQLT" size="256" summ="default" type="STRING"/>
					<colinfo id="GOODSNM" size="256" summ="default" type="STRING"/>
					<colinfo id="MODELNM" size="256" summ="default" type="STRING"/>
					<colinfo id="LAWRQ_CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="LAWRQ_CHKLSTYN" size="256" summ="default" type="STRING"/>
					<colinfo id="LAWRQ_CONTYN" size="256" summ="default" type="STRING"/>
					<colinfo id="LAWRQ_NAYN" size="256" summ="default" type="STRING"/>
					<colinfo id="ATT_CNFRMYN" size="256" summ="default" type="STRING"/>
					<colinfo id="ATT_SPECYN" size="256" summ="default" type="STRING"/>
					<colinfo id="ATT_BPYN" size="256" summ="default" type="STRING"/>
					<colinfo id="ATT_CHKLSTYN" size="256" summ="default" type="STRING"/>
					<colinfo id="ATT_PAXYN" size="256" summ="default" type="STRING"/>
					<colinfo id="ATT_KCSYN" size="256" summ="default" type="STRING"/>
					<colinfo id="ATT_FTFLOWYN" size="256" summ="default" type="STRING"/>
					<colinfo id="ATT_STRPTYN" size="256" summ="default" type="STRING"/>
					<colinfo id="ATT_IMPRPTYN" size="256" summ="default" type="STRING"/>
					<colinfo id="ATT_NAYN" size="256" summ="default" type="STRING"/>
					<colinfo id="HOGI" size="256" summ="default" type="STRING"/>
					<colinfo id="SPEC" size="256" summ="default" type="STRING"/>
					<colinfo id="CTESTYMD" size="256" summ="default" type="STRING"/>
					<colinfo id="BOSUCONTACT" size="256" summ="default" type="STRING"/>
					<colinfo id="ETC" size="256" summ="default" type="STRING"/>
					<colinfo id="THOGI" size="256" summ="default" type="STRING"/>
					<colinfo id="ATYPE" size="256" summ="default" type="STRING"/>
					<colinfo id="AUSE" size="256" summ="default" type="STRING"/>
					<colinfo id="PCNT" size="256" summ="default" type="STRING"/>
					<colinfo id="CAPA" size="256" summ="default" type="STRING"/>
					<colinfo id="STCNT" size="256" summ="default" type="STRING"/>
					<colinfo id="DOMETER" size="256" summ="default" type="STRING"/>
					<colinfo id="ABYN" size="256" summ="default" type="STRING"/>
					<colinfo id="TMSPEC" size="256" summ="default" type="STRING"/>
					<colinfo id="CONSOLE" size="256" summ="default" type="STRING"/>
					<colinfo id="INVERTER" size="256" summ="default" type="STRING"/>
					<colinfo id="ROPE_MG" size="256" summ="default" type="STRING"/>
					<colinfo id="ROPING" size="256" summ="default" type="STRING"/>
					<colinfo id="COMPENCHAIN" size="256" summ="default" type="STRING"/>
					<colinfo id="RAIL_CC" size="256" summ="default" type="STRING"/>
					<colinfo id="GUIDESHOE_CAR" size="256" summ="default" type="STRING"/>
					<colinfo id="GUIDESHOE_CWT" size="256" summ="default" type="STRING"/>
					<colinfo id="BRAKESPEC" size="256" summ="default" type="STRING"/>
					<colinfo id="REGULATOR" size="256" summ="default" type="STRING"/>
					<colinfo id="STOPEQP" size="256" summ="default" type="STRING"/>
					<colinfo id="USEYN" size="256" summ="default" type="STRING"/>
					<colinfo id="CREID" size="256" summ="default" type="STRING"/>
					<colinfo id="CREDT" size="256" summ="default" type="STRING"/>
					<colinfo id="MODID" size="256" summ="default" type="STRING"/>
					<colinfo id="MODDT" size="256" summ="default" type="STRING"/>
					<colinfo id="TESTREV" size="256" summ="default" type="STRING"/>
					<colinfo id="TESTERNM" size="256" summ="default" type="STRING"/>
					<colinfo id="TESTERID" size="256" summ="default" type="STRING"/>
					<colinfo id="TESTERCELL" size="256" summ="default" type="STRING"/>
					<colinfo id="RST" size="256" summ="default" type="STRING"/>
					<colinfo id="ACTDT" size="256" summ="default" type="STRING"/>
					<colinfo id="TESTSYMD" size="256" summ="default" type="STRING"/>
					<colinfo id="TESTPYMD" size="256" summ="default" type="STRING"/>
					<colinfo id="TESTEYMD" size="256" summ="default" type="STRING"/>
					<colinfo id="JIGCOST" size="256" summ="default" type="STRING"/>
					<colinfo id="TRVCOST" size="256" summ="default" type="STRING"/>
					<colinfo id="TRSCOST" size="256" summ="default" type="STRING"/>
					<colinfo id="TESTCOST" size="256" summ="default" type="STRING"/>
					<colinfo id="CHNSRSN" size="256" summ="default" type="STRING"/>
					<colinfo id="NFLLWRSN" size="256" summ="default" type="STRING"/>
					<colinfo id="RTNRSN" size="256" summ="default" type="STRING"/>
					<colinfo id="BIGO" size="256" summ="default" type="STRING"/>
					<colinfo id="TOTALCOST" size="256" summ="default" type="STRING"/>
					<colinfo id="DEGREE" size="256" summ="default" type="STRING"/>
					<colinfo id="RST_FILENM" size="256" summ="default" type="STRING"/>
					<colinfo id="RST_FILEPATH" size="256" summ="default" type="STRING"/>
					<colinfo id="RST_FILENM_APP" size="256" summ="default" type="STRING"/>
					<colinfo id="IMP_FILENM" size="256" summ="default" type="STRING"/>
					<colinfo id="IMP_FILEPATH" size="256" summ="default" type="STRING"/>
					<colinfo id="IMP_FILENM_APP" size="256" summ="default" type="STRING"/>
					<colinfo id="APP_PYN" size="256" summ="default" type="STRING"/>
					<colinfo id="END_DOCU_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="REQMAIL" size="256" summ="default" type="STRING"/>
					<colinfo id="HREQMAIL" size="256" summ="default" type="STRING"/>
					<colinfo id="TESTERVENDNM" size="256" summ="default" type="STRING"/>
					<colinfo id="TESTERMAIL" size="256" summ="default" type="STRING"/>
					<colinfo id="HREQNM" size="256" summ="default" type="STRING"/>
					<colinfo id="MAILDT" size="256" summ="default" type="STRING"/>
					<colinfo id="TESTPYMD_TXT" size="256" summ="default" type="STRING"/>
					<colinfo id="SBNM" size="256" summ="default" type="STRING"/>
					<colinfo id="SBVENDNM" size="256" summ="default" type="STRING"/>
					<colinfo id="POSITIONNM" size="256" summ="default" type="STRING"/>
					<colinfo id="BLOCKCD" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_code_rst">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME></CODE_NAME>
					</record>
					<record>
						<CODE>P</CODE>
						<CODE_NAME>합격</CODE_NAME>
					</record>
					<record>
						<CODE>F</CODE>
						<CODE_NAME>불합격</CODE_NAME>
					</record>
					<record>
						<CODE>R</CODE>
						<CODE_NAME>참고용</CODE_NAME>
					</record>
					<record>
						<CODE>C</CODE>
						<CODE_NAME>시험취소</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_code_rtnrsn">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME></CODE_NAME>
					</record>
					<record>
						<CODE>시료&#32;미&#32;제출</CODE>
						<CODE_NAME>시료&#32;미&#32;제출</CODE_NAME>
					</record>
					<record>
						<CODE>기준&#32;서류&#32;미달</CODE>
						<CODE_NAME>기준&#32;서류&#32;미달</CODE_NAME>
					</record>
					<record>
						<CODE>의뢰자&#32;요청</CODE>
						<CODE_NAME>의뢰자&#32;요청</CODE_NAME>
					</record>
					<record>
						<CODE>기타</CODE>
						<CODE_NAME>기타</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_code_nfllwrsn">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME></CODE_NAME>
					</record>
					<record>
						<CODE>장비</CODE>
						<CODE_NAME>장비</CODE_NAME>
					</record>
					<record>
						<CODE>인원</CODE>
						<CODE_NAME>인원</CODE_NAME>
					</record>
					<record>
						<CODE>업무로드</CODE>
						<CODE_NAME>업무로드</CODE_NAME>
					</record>
					<record>
						<CODE>긴급출장</CODE>
						<CODE_NAME>긴급출장</CODE_NAME>
					</record>
					<record>
						<CODE>도면</CODE>
						<CODE_NAME>도면</CODE_NAME>
					</record>
					<record>
						<CODE>기타</CODE>
						<CODE_NAME>기타</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_code_chnsrsn">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME></CODE_NAME>
					</record>
					<record>
						<CODE>예산</CODE>
						<CODE_NAME>예산</CODE_NAME>
					</record>
					<record>
						<CODE>시료</CODE>
						<CODE_NAME>시료</CODE_NAME>
					</record>
					<record>
						<CODE>추가시험</CODE>
						<CODE_NAME>추가시험</CODE_NAME>
					</record>
					<record>
						<CODE>의뢰자&#32;요청</CODE>
						<CODE_NAME>의뢰자&#32;요청</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Editable="True" Id="ds_testinfo_chnsrsn" OnColumnChanged="ds_testinfo_chnsrsn_OnColumnChanged">
				<Contents>
					<colinfo id="REQSEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="TESTREV" size="256" summ="default" type="STRING"/>
					<colinfo id="CHNSRSN" size="256" summ="default" type="STRING"/>
					<colinfo id="OTESTREV" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
		</Datasets>
		<Shape BKColor="user0" Bottom="54" Height="26" Id="Shape12" Left="4" LineColor="user1" Right="782" TabOrder="8" Top="28" Type="Rectangle" Width="778"></Shape>
		<Static Align="Right" Height="24" Id="st_name" Left="-116" Style="sty_lb_search" TabOrder="2" Text="현장명&#32;" Top="-38" VAlign="Middle" Width="61"></Static>
		<Calendar BindDataset="ds_master" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="REQDT" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Enable="FALSE" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_dlvdat" Left="649" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="2" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="31" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="105"></Calendar>
		<Button Cursor="HAND" Height="20" Id="btn_fileadd" ImageID="btn_icon_plus" Left="731" LeftMargin="12" OnClick="btn_add_OnClick" Style="sty_btn" TabOrder="3" Top="951" Transparent="TRUE" Width="22"></Button>
		<Button Cursor="HAND" Height="20" Id="btn_filedel" ImageID="btn_icon_minus" Left="756" LeftMargin="12" OnClick="btn_del_OnClick" Style="sty_btn" TabOrder="4" Top="951" Transparent="TRUE" Width="22"></Button>
		<Grid AutoFit="TRUE" AutoFitEndLine="Hide" BindDataset="ds_file" BkColor2="default" BoldHead="true" Border="Flat" Bottom="1092" ColSizing="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="118" Id="grd_file" InputPanel="true" Left="7" LineColor="user20" LineType="ExHORZ" MinWidth="100" OnCellDBLClick="grd_file_OnCellDblClick" OnExpandEdit="grd_file_OnExpandEdit" Right="780" RowHeight="20" Style="sty_grid" TabOrder="5" TabStop="true" Top="974" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="773">
			<contents>
				<format id="Default">
					<columns>
						<col width="30"/>
						<col width="48"/>
						<col width="450"/>
						<col width="210"/>
						<col width="0"/>
					</columns>
					<head>
						<cell align="center" col="0" color="user21" display="text" font="굴림,9" text="No"/>
						<cell align="center" col="1" color="user21" display="text" font="굴림,9" text="변경"/>
						<cell align="center" col="2" color="user21" display="text" font="굴림,9" text="파일명"/>
						<cell align="center" col="3" color="user21" display="text" font="굴림,9" text="파일사이즈"/>
						<cell align="center" col="4" color="user21" display="text" font="굴림,9" text="파일명(서버)"/>
					</head>
					<body>
						<cell align="center" col="0" display="text" expr="currow+1"/>
						<cell align="center" bkcolor2="user22" bkimageid='expr:gfn_getFlagBkImageID(getColumn(currow,&#32;&quot;FLAG&quot;))' col="1" display="image"/>
						<cell bkcolor2="user22" col="2" colid="FILENM" display="text" expandimage="btn_icon_next_01" expandshow="true"/>
						<cell bkcolor2="user22" col="3" colid="FILESIZE" display="number"/>
						<cell bkcolor2="user22" col="4" colid="FILENM_APP" display="text"/>
					</body>
				</format>
			</contents>
		</Grid>
		<FileDialog Bottom="972" Height="24" Id="fileDialog" Left="540" Right="564" TabOrder="72" Top="948" Width="24"></FileDialog>
		<File Bottom="972" Height="24" Id="f_tmp" Left="613" Right="637" TabOrder="74" Top="948" Width="24"></File>
		<FileDialog Bottom="972" FilePath="c:\" Height="24" Id="saveDialog" Left="676" Right="700" TabOrder="73" Top="948" Type="Save" Width="24"></FileDialog>
		<CyHttpFile Height="24" Id="httpFile" Left="644" Top="948" Width="24"></CyHttpFile>
		<Static Color="user6" Font="굴림,9,Bold" Height="20" Id="Static11" Left="16" TabOrder="6" Text="첨부파일" Top="948" VAlign="Middle" Width="301"></Static>
		<Static Align="Center" Height="24" Id="Static13" Left="6" Style="sty_lb_search" TabOrder="7" Text="접수번호" Top="29" VAlign="Middle" Width="88"></Static>
		<Edit BindDataset="ds_master" Border="Flat" Column="REQSEQ" Enable="FALSE" Height="20" Id="Edit1" ImeMode="english" Left="97" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="9" Top="31" UpperOnly="TRUE" Width="150"></Edit>
		<Static Align="Center" Height="24" Id="Static14" Left="278" Style="sty_lb_search" TabOrder="10" Text="의뢰팀" Top="30" VAlign="Middle" Width="88"></Static>
		<Static Align="Center" Height="24" Id="Static15" Left="558" Style="sty_lb_search" TabOrder="11" Text="의뢰일자" Top="30" VAlign="Middle" Width="88"></Static>
		<Shape BKColor="user0" Bottom="80" Height="26" Id="Shape13" Left="4" LineColor="user1" Right="782" TabOrder="13" Top="54" Type="Rectangle" Width="778"></Shape>
		<Static Align="Center" Height="24" Id="Static16" Left="6" Style="sty_lb_search" TabOrder="12" Text="의뢰구분" Top="55" VAlign="Middle" Width="88"></Static>
		<Static Align="Center" Height="24" Id="Static17" Left="278" Style="sty_lb_search" TabOrder="14" Text="의뢰자" Top="56" VAlign="Middle" Width="88"></Static>
		<Static Align="Center" Height="24" Id="Static18" Left="558" Style="sty_lb_search" TabOrder="15" Text="의뢰자&#32;연락처" Top="56" VAlign="Middle" Width="88"></Static>
		<Edit BindDataset="ds_master" Border="Flat" Column="REQCELL" Enable="FALSE" Height="20" Id="ed_reqcell" ImeMode="english" Left="649" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="16" Top="57" Width="105"></Edit>
		<Shape BKColor="user0" Bottom="132" Height="26" Id="Shape14" Left="4" LineColor="user1" Right="782" TabOrder="18" Top="106" Type="Rectangle" Width="778"></Shape>
		<Static Align="Center" Height="24" Id="Static20" Left="6" Style="sty_lb_search" TabOrder="17" Text="기능시험&#32;성적서" Top="107" VAlign="Middle" Width="88"></Static>
		<Shape BKColor="user0" Bottom="106" Height="26" Id="Shape16" Left="4" LineColor="user1" Right="782" TabOrder="20" Top="80" Type="Rectangle" Width="778"></Shape>
		<Static Align="Center" Height="24" Id="Static24" Left="6" Style="sty_lb_search" TabOrder="19" Text="제품구분" Top="81" VAlign="Middle" Width="88"></Static>
		<Shape BKColor="user0" Bottom="158" Height="26" Id="Shape17" Left="4" LineColor="user1" Right="782" TabOrder="21" Top="132" Type="Rectangle" Width="778"></Shape>
		<Edit BindDataset="ds_master" Border="Flat" Column="DEGREE" Enable="FALSE" Height="20" Id="ed_degree" ImeMode="english" Left="97" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="22" Top="135" Width="105"></Edit>
		<Edit BindDataset="ds_master" Border="Flat" Column="REQNM" Enable="FALSE" Height="20" Id="ed_reqnm" Left="369" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="23" Top="57" UpperOnly="TRUE" Width="80"></Edit>
		<Edit BindDataset="ds_master" Border="Flat" CheckLength="Byte" Column="REQID" Enable="FALSE" Height="20" Id="ed_reqid" ImeMode="none" Left="469" LeftMargin="4" MaxLength="105" RightMargin="4" Style="sty_ipt_search" TabOrder="24" Top="57" Width="80"></Edit>
		<Edit BindDataset="ds_master" Border="Flat" Column="REQVENDNM" Enable="FALSE" Height="20" Id="ed_reqvendnm" ImeMode="english" Left="369" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="25" Top="31" Width="105"></Edit>
		<Combo BindDataset="ds_master" CodeColumn="CODE" Column="REQGBN" DataColumn="CODE_NAME" Editable="TRUE" Enable="FALSE" Height="18" Id="cb_reqgbn" InnerDataset="ds_code_reqgbn" Left="96" TabOrder="26" Top="56" Width="150"></Combo>
		<Combo BindDataset="ds_master" CodeColumn="CODE" Column="GOODSGBN" DataColumn="CODE_NAME" Editable="TRUE" Enable="FALSE" Height="18" Id="cb_goodsgbn" InnerDataset="ds_code_goodsgbn" Left="96" TabOrder="27" Top="82" Width="150"></Combo>
		<Combo BindDataset="ds_master" CodeColumn="CODE" Column="FTREPORTCD" DataColumn="CODE_NAME" Editable="TRUE" Enable="FALSE" Height="18" Id="cb_ftreport" InnerDataset="ds_code_ftreportcd" Left="96" TabOrder="28" Top="109" Width="150"></Combo>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_testadd" ImageID="btn_icon_plus" Left="728" LeftMargin="12" OnClick="btn_testadd_OnClick" Style="sty_btn" TabOrder="29" Top="194" Transparent="TRUE" Width="22"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_testdel" ImageID="btn_icon_minus" Left="752" LeftMargin="12" OnClick="btn_testdel_OnClick" Style="sty_btn" TabOrder="30" Top="194" Transparent="TRUE" Width="22"></Button>
		<Static Color="user6" Font="굴림,9,Bold" Height="20" Id="Static1" Left="19" TabOrder="31" Text="시험항목" Top="196" VAlign="Middle" Width="102"></Static>
		<Image Height="19" Id="Image2" ImageID="form_bl_title_sub" Left="6" TabOrder="32" Top="194" Width="11"></Image>
		<Grid AutoFit="TRUE" AutoFitEndLine="Hide" BindDataset="ds_test" BkColor2="default" BoldHead="true" Border="Flat" Bottom="440" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="223" Id="Grid0" InputPanel="true" Left="7" LineColor="user20" LineType="ExHORZ" MinWidth="100" Right="780" RowHeight="20" Style="sty_grid" TabOrder="33" TabStop="true" Top="217" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="773">
			<contents>
				<format id="Default">
					<columns>
						<col width="30"/>
						<col width="147"/>
						<col width="275"/>
						<col width="216"/>
					</columns>
					<head>
						<cell align="center" col="0" color="user21" display="text" font="굴림,9" text="No"/>
						<cell align="center" col="1" color="user21" display="text" font="굴림,9" text="시험항목"/>
						<cell align="center" col="2" color="user21" display="text" font="굴림,9" text="시험기준&#32;및&#32;방법"/>
						<cell col="3" color="user21" display="text" font="굴림,9" text="판정기준"/>
					</head>
					<body>
						<cell align="center" col="0" display="text" expr="currow+1"/>
						<cell align="left" bkcolor2="user22" col="1" colid="TESTNM" combodisplayrowcnt="0" display="text" edit="normal"/>
						<cell align="left" bkcolor2="user22" col="2" colid="TESTCONT1" display="text" edit="normal"/>
						<cell align="left" col="3" colid="TESTCONT2" display="text" edit="normal"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Static Align="Center" Height="24" Id="Static2" Left="278" Style="sty_lb_search" TabOrder="34" Text="의뢰자&#32;입회여부" Top="108" VAlign="Middle" Width="88"></Static>
		<Static Align="Center" Height="24" Id="Static3" Left="558" Style="sty_lb_search" TabOrder="35" Text="기술팀&#32;입회여부" Top="108" VAlign="Middle" Width="88"></Static>
		<Combo BindDataset="ds_master" CodeColumn="CODE" Column="REQATTDCD" DataColumn="CODE_NAME" Editable="TRUE" Enable="FALSE" Height="18" Id="cb_reqattd" InnerDataset="ds_code_reqattdcd" Left="370" TabOrder="36" Top="109" Width="150"></Combo>
		<Combo BindDataset="ds_master" CodeColumn="CODE" Column="TECHATTDCD" DataColumn="CODE_NAME" Editable="TRUE" Enable="FALSE" Height="18" Id="cb_techattd" InnerDataset="ds_code_techattdcd" Left="650" TabOrder="37" Top="109" Width="120"></Combo>
		<Static Align="Center" Height="24" Id="Static4" Left="6" Style="sty_lb_search" TabOrder="38" Text="차수" Top="133" VAlign="Middle" Width="88"></Static>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_rndadd" ImageID="btn_icon_plus" Left="728" LeftMargin="12" OnClick="btn_rndadd_OnClick" Style="sty_btn" TabOrder="39" Top="442" Transparent="TRUE" Visible="FALSE" Width="22"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_rnddel" ImageID="btn_icon_minus" Left="752" LeftMargin="12" OnClick="btn_rnddel_OnClick" Style="sty_btn" TabOrder="40" Top="442" Transparent="TRUE" Visible="FALSE" Width="22"></Button>
		<Static Color="user6" Font="굴림,9,Bold" Height="20" Id="Static5" Left="19" TabOrder="41" Text="개발항목" Top="444" VAlign="Middle" Width="102"></Static>
		<Image Height="19" Id="Image3" ImageID="form_bl_title_sub" Left="6" TabOrder="42" Top="442" Width="11"></Image>
		<Grid AutoFit="TRUE" AutoFitEndLine="Hide" BindDataset="ds_rnd" BkColor2="default" BoldHead="true" Border="Flat" Bottom="605" ColSizing="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="140" Id="grd_rnd" InputPanel="true" Left="7" LineColor="user20" LineType="ExHORZ" MinWidth="100" OnCellDBLClick="grd_rnd_OnCellDblClick" OnExpandUp="grd_rnd_OnExpandUp" OnMouseOver="grd_rnd_OnMouseOver" Right="780" RowHeight="20" Style="sty_grid" TabOrder="45" TabStop="true" Top="465" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="773">
			<contents>
				<format id="Default">
					<columns>
						<col width="30"/>
						<col width="114"/>
						<col width="114"/>
						<col width="147"/>
						<col width="147"/>
						<col width="147"/>
						<col width="147"/>
					</columns>
					<head>
						<cell align="center" col="0" color="user21" display="text" font="굴림,9" text="No"/>
						<cell align="center" col="1" color="user21" display="text" font="굴림,9" text="품명"/>
						<cell align="center" col="2" color="user21" display="text" font="굴림,9" text="모델명"/>
						<cell align="center" col="3" color="user21" display="text" font="굴림,9" text="도면번호"/>
						<cell align="center" col="4" color="user21" display="text" font="굴림,9" text="개발내용"/>
						<cell align="center" col="5" color="user21" display="text" font="굴림,9" text="첨부자료"/>
						<cell align="center" col="6" color="user21" display="text" font="굴림,9" text="비고"/>
					</head>
					<body>
						<cell align="center" col="0" display="text" expr="currow+1"/>
						<cell align="left" bkcolor2="user22" col="1" colid="GOODSNM" combodisplayrowcnt="0" display="text" edit="normal" expandimage="btn_icon_search"/>
						<cell align="left" bkcolor2="user22" col="2" colid="MODELNM" display="text" edit="normal" expandimage="btn_icon_search"/>
						<cell align="left" bkcolor2="user22" col="3" colid="BFMATNR" combodisplayrowcnt="0" display="normal" edit="normal" expandimage="btn_icon_search" expandshow="true"/>
						<cell align="left" bkcolor2="user22" col="4" colid="RNDCONT" combodisplayrowcnt="0" display="text" edit="normal"/>
						<cell align="left" bkcolor2="user22" col="5" colid="FILENM" combodisplayrowcnt="0" display="text" expandimage="btn_icon_next_01" expandshow="true"/>
						<cell align="left" bkcolor2="user22" col="6" colid="BIGO" combodisplayrowcnt="0" display="text" edit="normal"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Static Height="16" Id="Static6" Left="11" TabOrder="44" Text="첨부자료:&#32;인증서,&#32;시험성적서등&#32;(예,KC인증서,&#32;다이나모&#32;시험보고서)" Top="608" Width="500"></Static>
		<Shape BKColor="user0" Bottom="680" Height="26" Id="Shape0" Left="4" LineColor="user1" Right="782" TabOrder="46" Top="654" Type="Rectangle" Width="778"></Shape>
		<Static Align="Center" Height="24" Id="Static26" Left="6" Style="sty_lb_search" TabOrder="45" Text="호기정보" Top="655" VAlign="Middle" Width="100"></Static>
		<Edit BindDataset="ds_master" Border="Flat" Column="HOGI" Enable="FALSE" Height="20" Id="ed_hogi" ImeMode="english" Left="114" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="47" Top="658" UpperOnly="TRUE" Width="500"></Edit>
		<Shape BKColor="user0" Bottom="706" Height="26" Id="Shape4" Left="4" LineColor="user1" Right="782" TabOrder="49" Top="680" Type="Rectangle" Width="778"></Shape>
		<Static Align="Center" Height="24" Id="Static31" Left="6" Style="sty_lb_search" TabOrder="48" Text="사양정보" Top="681" VAlign="Middle" Width="100"></Static>
		<Shape BKColor="user0" Bottom="732" Height="26" Id="Shape5" Left="4" LineColor="user1" Right="782" TabOrder="51" Top="706" Type="Rectangle" Width="778"></Shape>
		<Static Align="Center" Height="24" Id="Static34" Left="6" Style="sty_lb_search" TabOrder="50" Text="완성검사일" Top="706" VAlign="Middle" Width="100"></Static>
		<Edit BindDataset="ds_master" Border="Flat" Column="SPEC" Enable="FALSE" Height="20" Id="ed_spec" ImeMode="english" Left="114" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="52" Top="683" UpperOnly="TRUE" Width="500"></Edit>
		<Shape BKColor="user0" Bottom="758" Height="26" Id="Shape6" Left="4" LineColor="user1" Right="782" TabOrder="54" Top="732" Type="Rectangle" Width="778"></Shape>
		<Static Align="Center" Height="24" Id="Static37" Left="6" Style="sty_lb_search" TabOrder="53" Text="현장&#32;관련&#32;연락처" Top="732" VAlign="Middle" Width="100"></Static>
		<Edit BindDataset="ds_master" Border="Flat" Column="BOSUCONTACT" Enable="FALSE" Height="20" Id="ed_bosucontact" ImeMode="english" Left="114" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="55" Top="735" UpperOnly="TRUE" Width="500"></Edit>
		<Image Height="19" Id="Image1" ImageID="form_bl_title_sub" Left="6" TabOrder="56" Top="634" Width="11"></Image>
		<Static Color="user6" Font="굴림,9,Bold" Height="20" Id="Static0" Left="19" TabOrder="57" Text="Pilot&#32;현장&#32;정보" Top="635" VAlign="Middle" Width="102"></Static>
		<Static Height="16" Id="Static7" Left="11" TabOrder="58" Text="*&#32;전체&#32;Pilot&#32;적용&#32;현장&#32;List&#32;첨부할&#32;것" Top="787" Width="500"></Static>
		<Shape BKColor="user0" Bottom="784" Height="26" Id="Shape1" Left="4" LineColor="user1" Right="782" TabOrder="60" Top="758" Type="Rectangle" Width="778"></Shape>
		<Static Align="Center" Height="24" Id="Static8" Left="6" Style="sty_lb_search" TabOrder="59" Text="기타" Top="758" VAlign="Middle" Width="100"></Static>
		<Edit BindDataset="ds_master" Border="Flat" Column="ETC" Enable="FALSE" Height="20" Id="ed_etc" ImeMode="english" Left="114" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="61" Top="761" UpperOnly="TRUE" Width="500"></Edit>
		<Calendar BindDataset="ds_master" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="CTESTYMD" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Enable="FALSE" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_ctestymd" Left="115" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="62" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="708" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="105"></Calendar>
		<Shape BKColor="user12" Bottom="832" Height="28" Id="Shape2" Left="4" LineColor="user13" Right="782" TabOrder="63" Top="804" Type="Rectangle" Width="778"></Shape>
		<Static Align="Right" Height="26" Id="Static9" Left="4" Style="sty_lb_form_basic" TabOrder="63" Text="Jig&#32;제작비용" Top="805" VAlign="Middle" Width="72"></Static>
		<Edit Align="RIGHT" BindDataset="ds_master" Border="Flat" Column="TOTALCOST" Enable="FALSE" Height="20" Id="ed_totalcost" ImeMode="native" Left="696" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="64" Top="808" Width="80"></Edit>
		<Static Align="Right" Height="26" Id="Static19" Left="156" Style="sty_lb_form_basic" TabOrder="65" Text="출장비" Top="805" VAlign="Middle" Width="72"></Static>
		<Static Align="Right" Height="26" Id="Static21" Left="620" Style="sty_lb_form_basic" TabOrder="66" Text="Total" Top="805" VAlign="Middle" Width="72"></Static>
		<Static Align="Right" Height="26" Id="Static33" Left="460" Style="sty_lb_form_basic" TabOrder="67" Text="사외기관&#32;시험비" Top="805" VAlign="Middle" Width="80"></Static>
		<Static Align="Right" Height="26" Id="Static22" Left="308" Style="sty_lb_form_basic" TabOrder="68" Text="운반비" Top="805" VAlign="Middle" Width="72"></Static>
		<Edit Align="RIGHT" BindDataset="ds_master" Border="Flat" Column="TESTCOST" Enable="FALSE" Height="20" Id="ed_testcost" ImeMode="native" Left="544" LeftMargin="4" OnChar="Edit20_OnChar" RightMargin="4" Style="sty_ipt_form" TabOrder="69" Top="808" Width="70"></Edit>
		<Edit Align="RIGHT" BindDataset="ds_master" Border="Flat" Column="TRSCOST" Enable="FALSE" Height="20" Id="ed_trscost" ImeMode="native" Left="384" LeftMargin="4" OnChar="Edit20_OnChar" RightMargin="4" Style="sty_ipt_form" TabOrder="70" Top="808" Width="70"></Edit>
		<Edit Align="RIGHT" BindDataset="ds_master" Border="Flat" Column="TRVCOST" Enable="FALSE" Height="20" Id="ed_trvcost" ImeMode="native" Left="232" LeftMargin="4" OnChar="Edit20_OnChar" RightMargin="4" Style="sty_ipt_form" TabOrder="71" Top="808" Width="70"></Edit>
		<Edit Align="RIGHT" BindDataset="ds_master" Border="Flat" Column="JIGCOST" Enable="FALSE" Height="20" Id="ed_jigcost" ImeMode="native" Left="80" LeftMargin="4" OnChar="Edit20_OnChar" RightMargin="4" Style="sty_ipt_form" TabOrder="72" Top="808" Width="70"></Edit>
		<Shape BKColor="user0" Bottom="864" Height="26" Id="Shape3" Left="4" LineColor="user1" Right="782" TabOrder="74" Top="838" Type="Rectangle" Width="778"></Shape>
		<Static Align="Center" Height="24" Id="Static35" Left="6" Style="sty_lb_search" TabOrder="73" Text="계획&#32;변경&#32;사유" Top="839" VAlign="Middle" Width="100"></Static>
		<Shape BKColor="user0" Bottom="890" Height="26" Id="Shape7" Left="4" LineColor="user1" Right="782" TabOrder="76" Top="864" Type="Rectangle" Width="778"></Shape>
		<Static Align="Center" Height="24" Id="Static36" Left="6" Style="sty_lb_search" TabOrder="75" Text="미준수&#32;사유" Top="865" VAlign="Middle" Width="100"></Static>
		<Shape BKColor="user0" Bottom="916" Height="26" Id="Shape8" Left="4" LineColor="user1" Right="782" TabOrder="78" Top="890" Type="Rectangle" Width="778"></Shape>
		<Static Align="Center" Height="24" Id="Static23" Left="6" Style="sty_lb_search" TabOrder="77" Text="반송사유" Top="890" VAlign="Middle" Width="100"></Static>
		<Shape BKColor="user0" Bottom="942" Height="26" Id="Shape9" Left="4" LineColor="user1" Right="782" TabOrder="80" Top="916" Type="Rectangle" Width="778"></Shape>
		<Static Align="Center" Height="24" Id="Static38" Left="6" Style="sty_lb_search" TabOrder="79" Text="비고" Top="916" VAlign="Middle" Width="100"></Static>
		<Edit BindDataset="ds_master" Border="Flat" Column="BIGO" Height="20" Id="Edit9" ImeMode="english" Left="113" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="81" Top="919" UpperOnly="TRUE" Width="500"></Edit>
		<Combo BindDataset="ds_master" CodeColumn="CODE" Column="RTNRSN" DataColumn="CODE_NAME" Editable="TRUE" Height="18" Id="cb_rtnrsn" InnerDataset="ds_code_rtnrsn" Left="113" OnChanged="rd_dsngbn_OnChanged" TabOrder="82" Top="891" Width="150"></Combo>
		<Combo BindDataset="ds_master" CodeColumn="CODE" Column="NFLLWRSN" DataColumn="CODE_NAME" Enable="FALSE" Height="18" Id="cb_nfllwrsn" InnerDataset="ds_code_nfllwrsn" Left="113" OnChanged="rd_dsngbn_OnChanged" TabOrder="83" Top="867" Width="150"></Combo>
		<Combo BindDataset="ds_testinfo" CodeColumn="CODE" Column="CHNSRSN" DataColumn="CODE_NAME" Enable="FALSE" Height="18" Id="cb_chnsrsn" InnerDataset="ds_code_chnsrsn" Left="113" TabOrder="84" Top="841" Width="150"></Combo>
		<Shape BKColor="user12" Bottom="1153" Height="26" Id="sh_rst_report" Left="7" LineColor="user13" Right="567" TabOrder="89" Top="1127" Type="Rectangle" Width="560"></Shape>
		<Button Enable="FALSE" Height="19" Id="btn_openFile" ImageID="btn_icon_polder" Left="536" OnClick="btn_openFile_OnClick" TabOrder="86" Text="Button0" Top="1131" Width="19"></Button>
		<Edit BindDataset="ds_master" Border="Flat" Column="RST_FILENM" Enable="FALSE" Height="20" Id="ed_FileName" Left="143" LeftMargin="4" Readonly="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="87" Top="1130" Width="382"></Edit>
		<Static Height="24" Id="st_insuName" Left="8" Style="sty_lb_form_basic" TabOrder="88" Text="&#32;*&#32;&#32;&#32;시험결과&#32;보고서&#32;&#32;&#32;*" Top="1128" VAlign="Middle" Width="124"></Static>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_rst_download" ImageID="btn_sub_06" Left="592" LeftMargin="12" OnClick="btn_rst_download_OnClick" Style="sty_btn" TabOrder="90" Text="시험결과&#32;보고서" Top="1130" Transparent="TRUE" Width="95"></Button>
		<Static Align="Center" Height="24" Id="Static49" Left="278" Style="sty_lb_search" TabOrder="91" Text="시험자" Top="82" VAlign="Middle" Width="88"></Static>
		<Static Align="Center" Height="24" Id="Static50" Left="558" Style="sty_lb_search" TabOrder="92" Text="시험자&#32;연락처" Top="82" VAlign="Middle" Width="88"></Static>
		<Edit BindDataset="ds_master" Border="Flat" Column="TESTERCELL" Height="20" Id="ed_testercell" ImeMode="english" Left="649" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="93" Top="83" Width="105"></Edit>
		<Button Height="18" Id="btn_testernm" ImageID="btn_icon_search" Left="450" OnClick="btn_testernm_OnClick" TabOrder="95" Text="Button0" Top="84" Transparent="TRUE" Width="18"></Button>
		<Edit BindDataset="ds_master" Border="Flat" Column="TESTERNM" DisableBKColor="user12" Enable="FALSE" Height="20" Id="ed_testernm" Left="369" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="94" Top="83" UpperOnly="TRUE" Width="80"></Edit>
		<Edit BindDataset="ds_master" Border="Flat" CheckLength="Byte" Column="TESTERID" Enable="FALSE" Height="20" Id="ed_testerno" ImeMode="none" Left="469" LeftMargin="4" MaxLength="105" RightMargin="4" Style="sty_ipt_search" TabOrder="96" Top="83" Width="80"></Edit>
		<Shape BKColor="user0" Bottom="184" Height="26" Id="Shape10" Left="4" LineColor="user1" Right="782" TabOrder="99" Top="158" Type="Rectangle" Width="778"></Shape>
		<Calendar BindDataset="ds_master" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="TESTEYMD" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Enable="FALSE" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="Calendar0" Left="649" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="97" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="161" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="105"></Calendar>
		<Static Align="Center" Height="24" Id="Static25" Left="6" Style="sty_lb_search" TabOrder="98" Text="시험&#32;시작일" Top="159" VAlign="Middle" Width="88"></Static>
		<Static Align="Center" Height="24" Id="Static27" Left="278" Style="sty_lb_search" TabOrder="100" Text="시험&#32;완료&#32;예정일" Top="160" VAlign="Middle" Width="88"></Static>
		<Static Align="Center" Height="24" Id="Static28" Left="558" Style="sty_lb_search" TabOrder="101" Text="시험&#32;완료일" Top="160" VAlign="Middle" Width="88"></Static>
		<Calendar BindDataset="ds_testinfo" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="TESTSYMD" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_testsymd" Left="97" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="102" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="161" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="105"></Calendar>
		<Calendar BindDataset="ds_testinfo" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="TESTPYMD" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_testpymd" Left="369" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="103" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="161" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="105"></Calendar>
		<Static Align="Center" Height="24" Id="Static54" Left="558" Style="sty_lb_search" TabOrder="104" Text="Rev." Top="134" VAlign="Middle" Width="88"></Static>
		<Combo BindDataset="ds_master" CodeColumn="val" Column="TESTREV" DataColumn="val" Editable="TRUE" Height="18" Id="cb_testrev" InnerDataset="ds_testrev" Left="648" OnChanged="cb_testrev_OnChanged" TabOrder="105" Top="136" Width="80"></Combo>
		<Shape BKColor="user0" Bottom="28" Height="26" Id="Shape11" Left="4" LineColor="user1" Right="782" TabOrder="108" Top="2" Type="Rectangle" Width="778"></Shape>
		<Static Align="Right" Height="24" Id="Static10" Left="6" Style="sty_lb_search" TabOrder="106" Text="처리&#32;결과&#32;" Top="3" VAlign="Middle" Width="88"></Static>
		<Edit AutoSelect="TRUE" BindDataset="ds_master" Border="Flat" Column="TITLE" Enable="FALSE" Height="20" Id="ed_title" ImeMode="none" Left="97" LeftMargin="4" MaxLength="200" RightMargin="4" Style="sty_ipt_form" TabOrder="107" Top="6" UsePopupMenu="FALSE" Width="450"></Edit>
		<Static Align="Center" Height="24" Id="Static12" Left="6" Style="sty_lb_search" TabOrder="109" Text="제목" Top="3" VAlign="Middle" Width="88"></Static>
		<Static Align="Center" Height="24" Id="Static55" Left="558" Style="sty_lb_search" TabOrder="110" Text="결과" Top="4" VAlign="Middle" Width="88"></Static>
		<Combo BindDataset="ds_master" CodeColumn="CODE" Column="RST" DataColumn="CODE_NAME" Editable="TRUE" Enable="FALSE" Height="18" Id="cb_rst" InnerDataset="ds_code_rst" Left="648" TabOrder="111" Top="5" Width="120"></Combo>
		<Div Height="30" Id="div_imp" Left="4" TabOrder="112" Text="Div0" Top="1096" Width="711">
			<Contents>
				<Shape BKColor="user12" Bottom="26" Height="26" Id="Shape7" Left="3" LineColor="user13" Right="563" TabOrder="4" Top="0" Type="Rectangle" Width="560"></Shape>
				<Button Enable="FALSE" Height="19" Id="btn_imp_openfile" ImageID="btn_icon_polder" Left="532" OnClick="btn_openFile_OnClick" TabOrder="1" Text="Button0" Top="4" Visible="FALSE" Width="19"></Button>
				<Edit BindDataset="ds_master" Border="Flat" Column="IMP_FILENM" Enable="FALSE" Height="20" Id="ed_imp_filename" Left="139" LeftMargin="4" Readonly="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="2" Top="3" Width="382"></Edit>
				<Static Height="24" Id="Static41" Left="4" Style="sty_lb_form_basic" TabOrder="3" Text="&#32;*&#32;&#32;&#32;개선대책&#32;보고서&#32;&#32;&#32;*" Top="1" VAlign="Middle" Width="124"></Static>
				<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_imp_download" ImageID="btn_sub_06" Left="588" LeftMargin="12" OnClick="div_imp_btn_imp_download_OnClick" Style="sty_btn" TabOrder="5" Text="개선대책&#32;보고서" Top="3" Transparent="TRUE" Width="95"></Button>
			</Contents>
		</Div>
		<FileDialog Bottom="970" FilePath="c:\" Height="24" Id="saveDialog1" Left="512" Right="536" TabOrder="112" Top="946" Type="Save" Width="24"></FileDialog>
	</Form>
	<Script><![CDATA[/*
 ******************************************************************************************
 * 기      능   : Pilot 접수 Body
 * 작  성  자   : YSH
 * 작성  일자   : 2020.10.14
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
#include "LIB::commons.js";	// 공통 스크립트 
#include "LIB::nsfRequest.js";	// 공통 스크립트 

//=========================================================================================
// [ PART 1 ]
// Form에서 사용될 전역변수를 선언
// FORM에서 사용되는 전역변수는 대문자로 작성하며, F_XXX 의 형태를 갖도록 한다. 
//=========================================================================================
var F_FRM_TITLE = "의뢰서 접수요청";	// 공통코드 화면명
var F_USER_GBN  = "";
var F_SERVER_DIR = "QM";
var F_TESTREV = "";

var modFlg = false;		// 수정여부
var modFlg2 = false;		// 수정여부

// 파일관련 
var F_SIZE = 1024 * 10096;	// 10MB
var _F_FILE_DIR = "";	// 로컬에서 현재 선택한 파일 디렉토리 
var _F_FILE_NAME = "";	// 로컬에서 현재 선택한 파일  명 
var _F_FILE_SIZE = 0;	// 파일 사이즈 
var _F_FILE_DELETE = false;
var _F_FILENM_APP_DEL = ""; // 저장 하지 않을 시 삭제용

var	_SERVER_FNAME = "";  // 서버 파일명



//=========================================================================================
// [ PART 2 ]
// Form Loading / Unloading 시 작업 정의
//=========================================================================================
function fn_OnLoadCompleted(obj)
{
	gfn_initForm(false);	// Form 로드 이벤트 맨 첫줄에 기술
	//fn_init_form();			// 폼 초기화	
}

/********************************************************************************
* 기      능   : form UnloadCompleted 
********************************************************************************/
function fn_OnUnloadCompleted(obj)
{
	return gfn_isFormUnload(obj);
}


/********************************************************************************
* 기      능   : 폼 초기화
********************************************************************************/
function fn_init_form()
{
	var reqseq  = ""; if ( IsExistVar("p_reqseq" ) ) reqseq  = trim(p_reqseq );
	
	ds_cond.ClearData();
	ds_cond.AddRow();
	ds_cond.SetColumn(0, "REQSEQ"  , reqseq);
		
	fn_query();	
}
//=========================================================================================
// [ PART 3 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,form닫기)
//=========================================================================================
/********************************************************************************
* 기      능   : 조회
********************************************************************************/
function fn_query()
{
	tit_clearActionInfo();
	tit_addSearchActionInfo("qm10:QM1001003B_S1");
	tit_addSearchActionInfo("qm10:QM1001003B_S2");
	tit_addSearchActionInfo("qm10:QM1001003B_S3");
	tit_addSearchActionInfo("qm10:QM1001003B_S4");
	tit_addSearchActionInfo("qm10:QM1001003B_S5");	

	tit_callService(
        ""
        , ""
        , "ds_cond=ds_cond"
        , "ds_master=ds_master ds_testinfo=ds_testinfo ds_test=ds_test ds_rnd=ds_rnd ds_file=ds_file"
        , ""
        , "fn_afterQuery"
        , true
        , true);	
}

/********************************************************************************
* 기      능   : 조회 for mail
********************************************************************************/
function fn_squery()
{

	ds_master.DeleteAll();

	tit_clearActionInfo();
	tit_addSearchActionInfo("qm10:QM1001003B_S1");

	tit_callService(
        ""
        , ""
        , "ds_cond=ds_cond"
        , "ds_master=ds_master"
        , ""
        , "fn_afterSquery"
        , true
        , true);	
}


/********************************************************************************
* 기      능   : 저장(수정)  처리
********************************************************************************/
function fn_save(obj)
{	
	if (length(trim(cal_testsymd.Value)) == 0)		{
		gfn_showAlert("CW00001", "시험 시작일");
		cal_testsymd.SetFocus();
		return;
	}	
	if (length(trim(cal_testpymd.Value)) == 0)		{
		gfn_showAlert("CW00001", "시험 완료 예정일");
		cal_testpymd.SetFocus();
		return;
	}
	if(!gfn_checkFromToObj(cal_testsymd, cal_testpymd, true, "시험일", 0, false)) {
		gfn_showAlert("시험시작일과 완료예정일을 확인해 주세요.");
		cal_testpymd.SetFocus();
		return;
	}
	
	if (length(trim(ed_testerno.Text)) == 0)		{
		gfn_showAlert("CW00001", "시험자");
		ed_testerno.SetFocus();
		return;
	}
	
	if(!fn_chkVal()) {	
		return;	
	}	
	
	// 시험항목 수정여부
	if(modFlg) {
		if (length(trim(cb_chnsrsn.Text)) == 0)		{
			gfn_showAlert("CW00001", "계획 변경 사유");
			cb_chnsrsn.SetFocus();
			return;
		}
	}
	
	if(confirm("수정 하시겠습니까?")) {
		fn_saveRequest( obj, "수정");
	}
}

/********************************************************************************
* 기      능   : 접수 처리
********************************************************************************/
function fn_receipt(obj)
{	

	
	if (length(trim(cal_testsymd.Value)) == 0)		{
		gfn_showAlert("CW00001", "시험 시작일");
		cal_testsymd.SetFocus();
		return;
	}	
	if (length(trim(cal_testpymd.Value)) == 0)		{
		gfn_showAlert("CW00001", "시험 완료 예정일");
		cal_testpymd.SetFocus();
		return;
	}
	if(!gfn_checkFromToObj(cal_testsymd, cal_testpymd, true, "시험일", 0, false)) {
		gfn_showAlert("시험시작일과 완료예정일을 확인해 주세요.");
		cal_testpymd.SetFocus();
		return;
	}	
	if (length(trim(ed_testerno.Text)) == 0)		{
		gfn_showAlert("CW00001", "시험자");
		ed_testerno.SetFocus();
		return;
	}
	
	if(!fn_chkVal()) {	
		return;	
	}	
	
	if(confirm("접수 하시겠습니까?")) {	
		fn_saveRequest( obj, "접수");	
	}
}

/********************************************************************************
* 기      능   :  취소 처리 => 의뢰취소
********************************************************************************/
function fn_cancel(obj) 
{ 
	if(confirm("정말 의뢰취소 하시겠습니까?")) {	
	
		fn_saveRequest( obj, "취소");
	}
}


/********************************************************************************
* 기      능   :  반려 처리  => 반송
********************************************************************************/
function fn_sendback(obj)
{
	if (length(trim(cb_rtnrsn.Text)) == 0)	{
		gfn_showAlert("CW00001", "반송사유");
		cb_rtnrsn.SetFocus();
		return;
	}	
	
	if(confirm("반송 하시겠습니까?")) {
		fn_saveRequest( obj, "반송");
	}
}

/********************************************************************************
* 기      능   :  완료 처리
********************************************************************************/
function fn_finish(obj)
{

	
	if (length(trim(cb_rst.Text)) == 0)		{
		gfn_showAlert("CW00001", "결과");
		cb_rst.SetFocus();
		return;		
	}
	
	if (length(trim(ed_FileName.Text)) == 0)		{
		gfn_showAlert("CW00001", "시험결과 보고서");
		cb_rst.SetFocus();
		return;		
	}	
	
	if (length(trim(ed_jigcost.Text)) == 0)		{
		gfn_showAlert("CW00001", "Jig 제작비용");
		ed_jigcost.SetFocus();
		return;
	}
	if (length(trim(ed_trvcost.Text)) == 0)		{
		gfn_showAlert("CW00001", "출장비");
		ed_trvcost.SetFocus();
		return;
	}
	if (length(trim(ed_trscost.Text)) == 0)		{
		gfn_showAlert("CW00001", "운반비");
		ed_trscost.SetFocus();
		return;
	}
	if (length(trim(ed_testcost.Text)) == 0)		{
		gfn_showAlert("CW00001", "사외기관 시험비");
		ed_testcost.SetFocus();
		return;
	}
	if (length(trim(ed_totalcost.Text)) == 0)		{
		gfn_showAlert("CW00001", "총제작비용");
		ed_totalcost.SetFocus();
		return;
	}
	
	if (length(trim(cal_testsymd.Value)) == 0)		{
		gfn_showAlert("CW00001", "시험 시작일");
		cal_testsymd.SetFocus();
		return;
	}	
	if (length(trim(cal_testpymd.Value)) == 0)		{
		gfn_showAlert("CW00001", "시험 완료 예정일");
		cal_testpymd.SetFocus();
		return;
	}
	if(!gfn_checkFromToObj(cal_testsymd, cal_testpymd, true, "시험일", 0, false)) {
		gfn_showAlert("시험시작일과 완료예정일을 확인해 주세요.");
		cal_testpymd.SetFocus();
		return;
	}
	
	// 시험 완료 예정일 초과시 미준수 사유 입력
	if(toNumber(gfn_getCurrDate()) > toNumber(cal_testpymd.value) ) {
		if (length(trim(cb_nfllwrsn.Value)) == 0)		{
			gfn_showAlert("CW00001", "미준수 사유");
			cb_nfllwrsn.SetFocus();
			return;
		}
	}
	
	if (length(trim(ed_testerno.Text)) == 0)		{
		gfn_showAlert("CW00001", "시험자");
		ed_testerno.SetFocus();
		return;
	}
	
	if(!fn_chkVal()) {	
		return;	
	}	
	
	// 시험항목 수정여부
	if(modFlg) {
		if (length(trim(cb_chnsrsn.Text)) == 0)		{
			gfn_showAlert("CW00001", "계획 변경 사유");
			cb_chnsrsn.SetFocus();
			return;
		}
	}
		
	var docuno = ds_master.GetColumn(ds_master.row, "END_DOCU_NO"); 
	
		
	// 결재 팝업 시작 
	var arg = "F_DOCU_NO='" + docuno + "'";
		    arg+= " GBN_CODE='Q'";
			
	var arr = gfn_openPopupUrl("QM10::QM1002001A.xml", true, arg);	
	
	if ( arr == "" || arr == "C" ) {		
		gfn_showAlert("CI30001", "기안이 취소 되었습니다." );	
		return;
	} else {
		ds_master.SetColumn(ds_master.row, "END_DOCU_NO", arr); // 20: 접수
	}
	
	fn_saveRequest( obj, "기안");
	
}


/********************************************************************************
* 기      능   :  결재 처리
********************************************************************************/
function fn_decide(obj)
{	
	var docuno = ds_master.GetColumn(ds_master.row, "END_DOCU_NO"); 
	
	if( docuno == null || docuno  == '' ) {
		alert("결재번호가 없습니다.");
	}
		
	// 결재 팝업 시작 
	var arg = "F_DOCU_NO=" + docuno ;
		    arg+= " GBN_CODE='Q'";
			
	var arr = gfn_openPopupUrl("QM10::QM1002002A.xml", true, arg);
		
	if ( arr == "" || arr == "0" ) {		
		//gfn_showAlert("CI30001", "결재가 취소 되었습니다." );	
		return;
	} else if ( arr == "END" ) {	
		// 최종결재일 경우 update	
			
		// 결재 완료	
		ds_master.SetColumn(ds_master.row, "APP_PYN", "D"); // APP_PYN - D : 결재완료

		tit_clearActionInfo();	
		tit_addSingleActionInfo("qm10:QM1001003B_U2");
	
		tit_callService(
			  ""
			, ""
			, "ds_master=ds_master"
			, ""  
			, ""
			, "fn_afterFinish"
			, ""
			, ""
			, true);
	} else if ( arr == "R" ) {	
		// 최종결재일 경우 update	
			
		// 결재 완료	
		ds_master.SetColumn(ds_master.row, "APP_PYN", "R"); // APP_PYN - R : 반려

		tit_clearActionInfo();	
		tit_addSingleActionInfo("qm10:QM1001003B_U2");
	
		tit_callService(
			  ""
			, ""
			, "ds_master=ds_master"
			, ""  
			, ""
			, "fn_afterReject"
			, ""
			, ""
			, true);			
	} else if ( length(trim(arr)) > 1 ) {
		// 중간 결재시 창 닫기
		this.close();
	}
}

 /********************************************************************************
 * 기      능   : 최종승인 Callback
 ********************************************************************************/
 function fn_afterFinish(svcId, errCode, errMsg)
 {
     fn_destroyWait();
     
	 var rst = ds_master.GetColumn(ds_master.currow , "RST");
	 if ( rst == "P" || rst == "F" ) { 
		 fn_squery(); 
	 } 	
	 
	 gfn_showAlert("CI30001", "시험이 완료 처리되었습니다." );
	 gfn_showMsg("CI00003");		     
     
     this.close(); 
 }


/********************************************************************************
* 기      능   : 결재반려 Callback
********************************************************************************/
function fn_afterReject(svcId, errCode, errMsg)
{
	fn_destroyWait();				
	this.close();
}

/********************************************************************************
* 기      능   :  반려 처리
********************************************************************************/
function fn_reject(obj)
{	
	// 결재와 동일 (팝업에서 처리)
	fn_decide(obj);
}


/********************************************************************************
* 기      능   :  저장 트랜잭션 처리
********************************************************************************/
function fn_saveRequest( obj, actNm)
{	
	// 마스터 테이블
	ds_master_cp2.ClearData();
	for(var i=0; i < ds_master.colcount; i++) { 
		ds_master_cp2.addColumn( ToLower(ds_master.GetColID(i)), "STRING", 256);
	}
	
	ds_master_cp2.AddRow();
	
	for(var i=0; i < ds_master.colcount; i++) { 
		ds_master_cp2.SetColumn(ds_master_cp2.row
		                     , ToLower(ds_master.GetColID(i))
		                     , ds_master.GetColumn(ds_master.row, ds_master.GetColID(i)));
	}
	
	if( actNm == "완료" ) {
		ds_master_cp2.SetColumn(ds_master.row, "statcd", "99"); // 99: 완료	
	} else if( actNm == "반송" ) {
		ds_master_cp2.SetColumn(ds_master.row, "statcd", "40"); // 40: 반송
	} else if( actNm == "취소" ) {
		ds_master_cp2.SetColumn(ds_master.row, "statcd", "80"); // 80: 의뢰취소
	} else if( actNm == "접수" ) {
		ds_master_cp2.SetColumn(ds_master.row, "statcd", "20"); // 20: 접수
	} else if( actNm == "수정" ) {
		ds_master_cp2.SetColumn(ds_master.row, "statcd", "22"); // 22: 수정
	} else if( actNm == "기안" ) {
		ds_master_cp2.SetColumn(ds_master_cp2.row, "app_pyn", "P"); // APP_PYN - P : 결재진행중
	}
		
	// 시험항목 수정여부
	if(modFlg) { 			
		//var ntestrev = ToString(ToInteger(F_TESTREV) + 1);
		
		var ntestrev = "0";
		
		if( actNm != "접수" ) {		
			ntestrev = ToString(ToInteger(F_TESTREV) + 1);
		}
		
		ds_master_cp2.SetColumn(ds_master.row, "testrev", ntestrev);
		
		// 시험정보 테이블
		ds_testinfo_cp.ClearData();
		for(var i=0; i < ds_testinfo.colcount; i++) { 
			ds_testinfo_cp.addColumn( ToLower(ds_testinfo.GetColID(i)), "STRING", 256);
		}
		ds_testinfo_cp.addColumn( "otestrev", "STRING", 256);
		
		ds_testinfo_cp.AddRow();
		
		for(var i=0; i < ds_testinfo.colcount; i++) { 
			ds_testinfo_cp.SetColumn(ds_testinfo_cp.row
								 , ToLower(ds_testinfo.GetColID(i))
								 , ds_testinfo.GetColumn(ds_testinfo.row, ds_testinfo.GetColID(i)));
		}		
		ds_testinfo_cp.SetColumn(ds_testinfo.row, "testrev", ntestrev); 
		ds_testinfo_cp.SetColumn(ds_testinfo.row, "otestrev", F_TESTREV); 
		
		for(var i=0; i < ds_test.colcount; i++) { 
			ds_test_cp.addColumn( ToLower(ds_test.GetColID(i)), "STRING", 256);
		}
				
		for(var j=0; j < ds_test.rowcount ; j++) { 	
			ds_test_cp.AddRow();	
			for(var i=0; i < ds_test.colcount; i++) { 
						
				ds_test_cp.SetColumn( j
									, ToLower(ds_test.GetColID(i))
									, ds_test.GetColumn(j, ds_test.GetColID(i)));
			}
			ds_test_cp.SetColumn(j,"testseq", "" + (j+1));
			ds_test_cp.SetColumn(j,"testrev", "" + ntestrev);
		}	
	} else if( actNm == "반송" ) {	
		ds_master_cp2.SetColumn(ds_master.row, "testrev", "-1");	
	}
	
	// 첨부파일
	ds_file_cp.ClearData();
	for(var i=0; i < ds_file.colcount; i++) { 
		ds_file_cp.addColumn( ToLower(ds_file.GetColID(i)), "STRING", 256);
	}
	
	for(var j=0; j < ds_file.rowcount ; j++) { 	
		ds_file_cp.AddRow();	
		for(var i=0; i < ds_file.colcount; i++) { 
								
			ds_file_cp.SetColumn( j
								, ToLower(ds_file.GetColID(i))
								, ds_file.GetColumn(j, ds_file.GetColID(i)));
		}
		//ds_file_cp.SetColumn(j,"fileseq", "" + (j+1));
	}			
		
	var inDs = "ds_master=ds_master_cp2"
			+ " ds_test=ds_test_cp"
			+ " ds_testinfo=ds_testinfo_cp"
			+ " ds_file=ds_file_cp"
	;
	var outDs = "ds_master=ds_master"
			 + " ds_error=ds_error"
	;
		
	fn_createWait("",this);     // 처리중입니다. 메시지 처리

	nsfRequest("save", "qm1001003/save", inDs, outDs, "", "fn_afterSave");

}


/********************************************************************************
* 기      능   : 닫기  
********************************************************************************/
function fn_close()
{
	// 저장되지 않은 파일 삭제
	if(_F_FILENM_APP_DEL != "" ) {	
		var arr = tit_fileDelete("QM",_F_FILENM_APP_DEL, false);	
	}
	this.close();
}
//=========================================================================================
// [ PART 4]
// Callback 함수 정의 : callback 함수명은 메인 함수의 fn_xxxx() 에서 xxxx 부분은 fn_afterXXXX()
// 형태가 되도록 작성 
//=========================================================================================

/********************************************************************************
* 기      능   : 조회 Callback
********************************************************************************/
function fn_afterQuery(svcId, errCode, errMsg)
{
	var statcd = ds_master.GetColumn(ds_master.currow , "STATCD");
	var app_pyn = ds_master.GetColumn(ds_master.currow , "APP_PYN");
	
	// 개선대책보고서
	if( Length(Trim(ds_master.getColumn(ds_master.row, "IMP_FILENM"))) == 0 ) {
		div_imp.Visible = false;
		
		sh_rst_report.Top = sh_rst_report.Top - 20;
		st_insuName.Top = st_insuName.Top -20;
		ed_FileName.Top = ed_FileName.Top - 20;
		btn_openFile.Top = btn_openFile.Top -20;
		btn_rst_download.Top = btn_rst_download.Top -20;
	}	
	
	var auth  = ""; if ( parent.IsExistVar("p_auth" ) ) auth  = trim(parent.p_auth );
			
	if( auth == 'R' ) {	 // 11.26 의뢰화면에서 호출시 조회만 가능	
	
		F_FRM_TITLE = "진행상태 조회";
		parent.div_btn.fn_loadUseBtn("", F_FRM_TITLE, "", ""); 
		btn_testadd.Visible = false;
		btn_testdel.Visible = false;	
		
		if ( statcd != "99") {		
			btn_rst_download.Visible = false;		
		}		
		
	} else if( statcd == "10" && ( G_VEND_CODE == "0000009936" || "0000009922")) { // 의뢰 , 품질인증부 or 정보기술부
	
		parent.div_btn.fn_loadUseBtn("5,65", F_FRM_TITLE, "", ""); // 5-접수,65-반송,62-완료		
		cb_chnsrsn.Enable = false;
		
		// 	시험자 자동 세팅
		ed_testernm.Text = G_USER_NAME;
		ed_testerno.Text = G_USER_ID;
		ed_testercell.Text = G_USERMBPN;		
		
	} else if( (statcd == "20" || statcd == "22") && ( G_VEND_CODE == "0000009936" || "0000009922") && app_pyn == "P") { // 결재진행중	
		
		parent.div_btn.fn_loadUseBtn("15,32,40", F_FRM_TITLE, "", ""); // 5-접수,65-반송,62-완료, 30-저장 	, 35-취소 , 40 -출력   ,  15 - 결재, 32- 반려 	
	
	} else if( (statcd == "20" || statcd == "22") && ( G_VEND_CODE == "0000009936" || "0000009922")) { // 접수, 수정

		parent.div_btn.fn_loadUseBtn("30,35,40,62", F_FRM_TITLE, "", ""); // 5-접수,65-반송,62-완료, 30-저장 	, 35-취소 , 40 -출력 
		
		parent.div_btn.btn_save.DomainId = "";
		parent.div_btn.btn_save.Text     = "수정";  // 저장 => 수정
		parent.div_btn.btn_finish.DomainId = "";
		parent.div_btn.btn_finish.Text   = "기안"; //  완료 => 기안
		//div_btn.btn_cancel.Text     = "취소";  // 취소 => 의뢰취소
		
		//결과
		cb_rst.Enable = true;
		
		// 제작비용 
		ed_jigcost.Enable = true;
		ed_trscost.Enable = true;
		ed_trvcost.Enable = true;
		ed_testcost.Enable = true;
		
		// 사유 		
		cb_nfllwrsn.Enable = true;
		//cb_chnsrsn.Enable  = true;
		cb_rtnrsn.Enable = false;
		
		// 시험결과 보고서 선택 버튼
		btn_openFile.Enable = true;
	} else { // 완료
		F_FRM_TITLE = "시험결과 검색";
		parent.div_btn.fn_loadUseBtn("15,40", F_FRM_TITLE, "", ""); 
		btn_testadd.Visible = false;
		btn_testdel.Visible = false;		
		
		btn_fileadd.Visible = false;
		btn_filedel.Visible = false;
	}
	
	if( ds_master.GetColumn(ds_master.row, "TESTGBN") == "ETC" ) { 
		ed_testgbn_etctxt.Visible = true;
	} 	

	F_TESTREV = ds_master.GetColumn(ds_master.currow , "TESTREV");
	
	ds_testrev.ClearData();
	
	for( var i=0 ; i < F_TESTREV + 1 ; i++ ) {
		ds_testrev.AddRow();		
		ds_testrev.SetColumn(i,"val",ToString(i));
	}
		
	if( F_TESTREV == "-1" ) {
		ds_testrev.AddRow();		
		//ds_testrev.SetColumn(i,"val","1");
		//cb_testrev.Value = "1";
		ds_testrev.SetColumn(i,"val","0");
		cb_testrev.Value = "0";
		cb_testrev.Enable = false;
	} else {
		cb_testrev.Value = F_TESTREV;
	}
}

/********************************************************************************
* 기      능   : 저장 Callback
********************************************************************************/
function fn_afterSave(svcId, errCode, errMsg)
{
	fn_destroyWait();
	
	var statcd = ds_master.GetColumn(ds_master.currow , "STATCD");
	
	if ( errCode != 0 || ds_error.RowCount() > 0) 
	{
		gfn_showMsg("CE00001");		
		gfn_showAlert("CI30001", "저장 시 오류가 발생하였습니다. \n" +  ds_error.GetColumn( ds_error.row, "ERRMSG"));		
		return;
	} else {
	
		// 삭제한 첨부파일 삭제
		var rowcnt = ds_file.rowcount;
				
		for( var i = 0 ;  i < rowcnt ; i++ ) { 			
			var sFileName = ds_file.GetColumn(i, "FILENM");
			if(length(sFileName) != 0 && ds_file.GetColumn(i, "FLAG") == "D" ) {
				var arr = tit_fileDelete("QM",ds_file.getColumn(i, "FILENM_APP"), false);
			}
		}
			
		if( statcd == "20" && app_pyn == "") { // 접수			
			gfn_showAlert("CI30001", "접수 처리되었습니다." );		
			gfn_showMsg("CI00003");		
			fn_squery(); 
		} else if ( statcd == "99") { // 완료
			gfn_showAlert("CI30001", "완료 처리되었습니다." );		
			gfn_showMsg("CI00003");				
			var rst = ds_master.GetColumn(ds_master.currow , "RST");			
			if ( rst == "P" || rst == "F" ) { 
				fn_squery(); 
			} 						

		} else if ( statcd == "40") { // 반송			
			gfn_showAlert("CI30001", "반송 처리되었습니다." );		
			gfn_showMsg("CI00003");		
			fn_squery(); 
		} else if ( statcd == "80") { // 의뢰취소				
			gfn_showAlert("CI30001", "의뢰취소 처리되었습니다." );		
			gfn_showMsg("CI00003");		
		} else if ( statcd == "22") { // 수정
			gfn_showAlert("CI30001", "수정 처리되었습니다." );		
			gfn_showMsg("CI00003");		
		}
				
		this.close();
	}
}


/********************************************************************************
* 기      능   : 조회 for mail Callback
********************************************************************************/
function fn_afterSquery(svcId, errCode, errMsg){

	var statcd = ds_master.GetColumn(ds_master.currow , "STATCD");
	var app_pyn = ds_master.GetColumn(ds_master.currow , "APP_PYN");

	if( statcd == "20" && app_pyn == "") { // 접수
		fn_sendMail("접수");
	} else if ( statcd == "99") { // 완료
		var rst = ds_master.GetColumn(ds_master.currow , "RST");
		if ( rst == "P" || rst == "F" ) { 
			fn_sendMail("완료");
		}
	} else if ( statcd == "40") { // 반송				
		fn_sendMail("반송");
	} 
	
	this.Close();

}

/********************************************************************************
* 기      능   : 메일발송
********************************************************************************/
function fn_sendMail(actNm)
{
	
	var send_user = ds_master.GetColumn(ds_master.currow , "TESTERMAIL");
	var rece_user = ds_master.GetColumn(ds_master.currow , "REQMAIL");
		
	var cc_user =  "";
    var cc_user_nm = "";
	
	var send_user_nm = ds_master.GetColumn(ds_master.currow , "TESTERNM");
	var rece_user_nm = ds_master.GetColumn(ds_master.currow , "REQNM");
	
	var title = ds_master.GetColumn(ds_master.currow , "TITLE"); // 타이틀 
	var reqseq = ds_master.GetColumn(ds_master.currow , "REQSEQ"); // 접수번호 
	
	var maildt = ds_master.GetColumn(ds_master.currow , "MAILDT"); // 접수/반송/완료 시간
	var reqnm = ds_master.GetColumn(ds_master.currow , "REQNM"); // 의뢰자
	var reqvendnm = ds_master.GetColumn(ds_master.currow , "REQVENDNM"); // 의뢰자 팀명
	
	var testernm = ds_master.GetColumn(ds_master.currow , "TESTERNM"); // 시험자
	var testervendnm = ds_master.GetColumn(ds_master.currow , "TESTERVENDNM"); // 시험자 팀명
	
	var sbnm = ds_master.GetColumn(ds_master.currow , "SBNM"); // 반송자
	var sbvendnm = ds_master.GetColumn(ds_master.currow , "SBVENDNM"); // 반송자 팀명
	
	var testpymd = ds_master.GetColumn(ds_master.currow , "TESTPYMD_TXT"); // 시험 완료일
	
	var rtnrsn = ds_master.GetColumn(ds_master.currow , "RTNRSN"); // 반송사유
		
	var mesgtitl  = ""; //제목
	var mesgbody  = ""; //내용
	
	var pop_meg = "";	
	
	if( actNm == "접수" ) {
		mesgtitl += title + " 시험의뢰가 정상적으로 접수 되었습니다.";
		
		mesgbody = ' 시험의뢰가 정상적으로 접수 되었습니다. \n\n'; 
		
		mesgbody =  mesgbody +'접수번호: ' + reqseq + '\n';
		mesgbody =  mesgbody +'접수일시: ' + maildt + '\n\n';
		
		mesgbody =  mesgbody +'의뢰자: ' + reqnm +'(' + reqvendnm + ')' + '\n';
		mesgbody =  mesgbody +'시험자: ' + testernm  +'(' + testervendnm + ')' + '\n\n';
		
		mesgbody =  mesgbody +'시험완료 예정일: ' + testpymd + '\n\n';
		
		mesgbody =  mesgbody + testervendnm;
				
	} else if( actNm == "반송" ) {	
		mesgtitl += title + ' 시험의뢰가 반송되었습니다.'; 
		
		mesgbody = ' 시험의뢰가 반송되었습니다. \n\n'; 
		
		mesgbody =  mesgbody +'접수번호: ' + reqseq + '\n';
		mesgbody =  mesgbody +'반송일시: ' + maildt + '\n\n';
		
		mesgbody =  mesgbody +'의뢰자: ' + reqnm +'(' + reqvendnm + ')' + '\n';
		mesgbody =  mesgbody +'반송자: ' + sbnm  +'(' + sbvendnm + ')' + '\n\n';
		
		mesgbody =  mesgbody +'시험의뢰서 반송사유 및 비고란을 참고하시기 바랍니다.\n';
		mesgbody =  mesgbody +'반송사유: '+ rtnrsn + '\n\n';
		
		mesgbody =  mesgbody + testervendnm;		
		
		// 의뢰자 팀장 메일 참조 추가
		//cc_user = "shlim@hdel.co.kr";
		cc_user = ds_master.GetColumn(ds_master.currow , "HREQMAIL");
		cc_user_nm = ds_master.GetColumn(ds_master.currow , "HREQNM");
		
	} else if( actNm == "완료" ) {
	
		var rst = ds_master.GetColumn(ds_master.currow , "RST");
		
		if (rst == "P" ) {
			rst = "합격";
		} else if (rst == "F" ) {
			rst = "불합격";
		}
		
		mesgtitl += title + " 시험의뢰가 " + rst + "하였습니다.";
		
		mesgbody = ' 시험의뢰가 ' + rst +'하였습니다. \n\n'; 
		
		mesgbody =  mesgbody +'접수번호: ' + reqseq + '\n';
		mesgbody =  mesgbody +'완료일시: ' + maildt + '\n\n';
		
		mesgbody =  mesgbody +'의뢰자: ' + reqnm +'(' + reqvendnm + ')' + '\n';
		mesgbody =  mesgbody +'시험자: ' + testernm  +'(' + testervendnm + ')' + '\n\n';
		
		mesgbody =  mesgbody +'의뢰한 시험이 완료되었습니다.\n';
		mesgbody =  mesgbody +'시료 회수 진행 바랍니다.\n';
		mesgbody =  mesgbody +'SRM(신뢰성 결과검색)에서 시험 완료 보고서를 확인하시기 바랍니다.\n';	
		
		// 의뢰자 팀장 메일 참조 추가
		cc_user = ds_master.GetColumn(ds_master.currow , "HREQMAIL");
		cc_user_nm = ds_master.GetColumn(ds_master.currow , "HREQNM");

	}	
	
    if(rece_user != "")
    {

		tit_callService(
			"COMM_ACT"
			, "sendmailNew"
			, ""
			, ""
			," SEND_USER=" + quote( send_user )
				+ " RECV_USER=" + quote( rece_user )
				+ " CC_USER=" + quote(cc_user)
				+ " SEND_USER_NM=" + quote( send_user_nm )
				+ " RECV_USER_NM=" + quote( rece_user_nm )
				+ " CC_USER_NM=" + quote(cc_user_nm)
				+ " MESGTITL="  + quote( mesgtitl )
				+ " MESGBODY="  + quote( mesgbody )
			, ""
			, false
			, true);
		pop_meg = '메일이 발송 되었습니다.';	
    }
    
    gfn_showInform("CW10025", pop_meg);
	
	this.close();    

}



/********************************************************************************
* 기      능   : 그리드 더블클릭으로 파일 다운로드
********************************************************************************/
function grd_file_OnCellDblClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
	var svrFileName = ds_file.GetColumn(nRow, "FILENM_APP");
	var orgFileName = ds_file.GetColumn(nRow, "FILENM");
	var ext         = gfn_getFileExt(ds_file.getColumn(nRow, "FILENM"));
	
	saveDialog.FileName = orgFileName;
	saveDialog.Filter = "All(*.*)|*.*";
    saveDialog.Open();

	var idx = indexOf(saveDialog.FileName, ".");
	var fdFileName = saveDialog.FileName;
    var fileName =  decode(idx, -1, fdFileName, substr(fdFileName, 0, indexOf(fdFileName, ".")));
    var localFileName = fileName + "." + ext;

	var rMsg = tit_fileRead(
							httpFile
							, F_SERVER_DIR			// 저장 디렉토리
							, svrFileName			// 서버에서 전송받을 이름
							, saveDialog.FilePath	// 로컬 경로
							, localFileName			// 로컬 파일명
	);
	
	if ( rMsg[0] == "E" ) {
		if ( length(trim(rMsg[1])) > 0 ) {
			gfn_showAlert("CW10025", rMsg[1]);
		} else {
			gfn_showAlert("CW10025", "파일 다운로드에 실패하였습니다.");
		}
	} else if ( rMsg[0] == null  || rMsg[0] == "" ) {
		gfn_showAlert("CW10025", "해당파일이 존재하지 않습니다.");
	} else {
		gfn_showAlert("CW10025", "파일을 다운로드 하였습니다.");
	}
}


/********************************************************************************
* 기      능   : 시험항목 (+)버튼
********************************************************************************/
function btn_testadd_OnClick(obj)
{	
	if(ds_test.rowcount >= 20)
	{
		gfn_openMsgWin("추가할 수 있는 시험항목을 초과했습니다.\n (최대 20개 저장가능)","","A");
		return;
	}

	ds_test.AddRow();
	ds_test.SetColumn(ds_test.currow,"REQSEQ",ds_master.GetColumn(0,"REQSEQ"));
}


/********************************************************************************
* 기      능   : 시험항목 (-)버튼
********************************************************************************/
function btn_testdel_OnClick(obj)
{
	ds_test.DeleteRow(ds_test.row);
	modFlg = true;
	
	var statcd = ds_master.GetColumn(ds_master.currow , "STATCD");
	if( statcd == "20" || statcd == "22" ) {
		cb_chnsrsn.Enable  = true;
	}	
}


/********************************************************************************
* 기      능   : 데이터셋 값 변경 시 - Flag 처리 
********************************************************************************/
function ds_test_CanColumnChange(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{
	gfn_changeFlag( obj, strColumnID, nRow, "FLAG" );
}


/********************************************************************************
* 기      능   : Null check
********************************************************************************/
function fn_chkVal()
{
	
	// 시험 정보 	
	var testcnt = ds_test.rowcount;
	
	if ( testcnt < 1 ) { 
		gfn_showAlert("CI30001", "시험항목을 입력해 주세요." );			
		return false;
	}
	
	for ( var i=0 ; i < testcnt ; i++) {	
		// 4,5,6 컬럼 입력항목		
		if( Length(Trim(ds_test.getColumn(i, "TESTNM"))) == 0 ) {
			gfn_showAlert("CI30001", "시험정보 " + (i+1) + "번째 행에 입력되지 않은 값이 있습니다.");
			return false;		
		}		
		if( Length(Trim(ds_test.getColumn(i, "TESTCONT1"))) == 0 ) {
			gfn_showAlert("CI30001", "시험정보 " + (i+1) + "번째 행에 입력되지 않은 값이 있습니다.");
			return false;		
		}		
		if( Length(Trim(ds_test.getColumn(i, "TESTCONT2"))) == 0 ) {
			gfn_showAlert("CI30001", "시험정보 " + (i+1) + "번째 행에 입력되지 않은 값이 있습니다.");
			return false;
		}		
	}
	
	return true;	
}

/********************************************************************************
* 기      능   : 시험항목 시험정보 수정
********************************************************************************/
function ds_test_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{	
	modFlg = true;
	
	var statcd = ds_master.GetColumn(ds_master.currow , "STATCD");
	if( statcd == "20" || statcd == "22" ) {
		cb_chnsrsn.Enable  = true;
	}	
}

/********************************************************************************
* 기      능   : 계획 변경 사유 수정
********************************************************************************/
function ds_testinfo_chnsrsn_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{
	modFlg2 = true;
}

/********************************************************************************
* 기      능   : 시험자 DETAIL
********************************************************************************/
function btn_testernm_OnClick(obj)
{	
	var arg = " fa_sman_nm = " + quote(ed_testernm.text); // 담당자명 

	var arr = gfn_openPopUpUrlHdel("QM10::QM1001002D.xml", true, arg);
	
	if (arr != null && arr != 0) {
		ed_testerno.text = arr[0];	// 리턴된 담당자코드로 검색조건 SET
		ed_testernm.text = arr[1];	// 리턴된 담당자명으로 검색조건 SET
		//ed_reqvendnm.Text = arr[2];  // 소속팀
		ed_testercell.Text = arr[3];  // 연락처
		ed_testernm.SetFocus();
	} 	
}

function ds_master_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{

	if ( strColumnID == "JIGCOST" || strColumnID == "TRSCOST" || strColumnID == "TRVCOST" || strColumnID == "TESTCOST" ) {
	
		var totalcost = ToNumber(ed_jigcost.Text) + ToNumber(ed_trscost.Text) + ToNumber(ed_trvcost.Text) + ToNumber(ed_testcost.Text);
		ed_totalcost.Text =  totalcost;		
	}
}


// 숫자입력체크
function Edit20_OnChar(obj,strPreText,nChar,strPostText,LLParam,HLParam)
{
	// 숫자와 - 만 입력가능하도록 설정
	// 8 : backspace 키, 46 : Delete 키, 45 : -, 나머지 : 숫자 키
	if(!(nChar>= 48 && nChar <= 57) && nChar != 46 && nChar != 8)
	{
		alert("숫자만 입력하세요.");
		obj.Text = "";
		return false;
	}
}

function cb_testrev_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{

	var statcd = ds_master.GetColumn(ds_master.currow , "STATCD");

	if(modFlg && ( statcd == "10" || statcd == "20" || statcd == "22" )) {
		if(!confirm("수정된 정보가 있습니다. 그래도 변경 하시겠습니까? ")) {
		
			obj.Index = nOldIndex;
			return;
		}	
	}
	
	ds_cond.SetColumn(0, "TESTREV"  , strCode);	
	
	tit_clearActionInfo();
	tit_addSearchActionInfo("qm10:QM1001003B_S6");
	tit_addSearchActionInfo("qm10:QM1001003B_S7");

	tit_callService(
        ""
        , ""
        , "ds_cond=ds_cond"
        , "ds_test=ds_test ds_testinfo=ds_testinfo"
        , ""
        , "fn_afterRevQuery"
        , ""
        , true
        , true);	
	
}


/********************************************************************************
* 기      능   : REV 조회 Callback
********************************************************************************/
function fn_afterRevQuery(svcId, errCode, errMsg)
{
	if( F_TESTREV == cb_testrev.Value) {
		grd_test.Editable = true;	
		btn_testadd.Enable = true;
		btn_testdel.Enable = true;
		
		cal_testsymd.Enable = true;
		cal_testpymd.Enable = true;
		//cb_chnsrsn.Enable = true;
		
		// 공통 버튼 활성화
		var comps = div_btn.Components["Button"];
		for(var iCnt=0;iCnt < comps.count();iCnt++) {
			comps[iCnt].Enable = true;
		}
		
		//cb_chnsrsn.Text = "";
		
	} else {
		grd_test.Editable = false;
		btn_testadd.Enable = false;
		btn_testdel.Enable = false;
		
		cal_testsymd.Enable = false;
		cal_testpymd.Enable = false;
		cb_chnsrsn.Enable = false;

		// 공통 버튼 비활성화
		var comps = div_btn.Components["Button"];
		for(var iCnt=0;iCnt < comps.count();iCnt++) {		
			if( comps[iCnt].ID != "btn_close" ) {
				comps[iCnt].Enable = false;
			}
		}		
	}	
	modFlg = false;
}

/********************************************************************************
* 기      능   : 시험결과 보고서 파일 첨부(선택)
********************************************************************************/

function btn_openFile_OnClick(obj)
{
	
	fileDialog.open();

	if ( length(fileDialog.FilePath) == 0 
		|| length( fileDialog.FileName ) == 0 ) {
		return;
	}

	var fileSize = f_tmp.GetLength(fileDialog.FilePath + "\\" + fileDialog.FileName );
	if ( fileSize <= 0 ) {
		gfn_showAlert("CW00048");
		return;
	}
	
	if ( toNumber(maxFileSize) > 0 ) {
		if ( fileSize > toNumber(maxFileSize)) {
			gfn_showAlert("CW00047", maxFileSize/1024 + "K bytes" );
			return;
		}
	}
	_F_FILE_DIR =  fileDialog.FilePath;
	_F_FILE_NAME = fileDialog.FileName;
	_F_FILE_SIZE = fileSize;
	
	ed_FileName.value = "";	
	
	// 파일명
	ed_FileName.value = _F_FILE_NAME;
	
	// 서버저장 
	btn_saveFile_OnClick(obj);
}

/********************************************************************************
* 기      능   : 시험결과 보고서 파일 첨부(저장)
********************************************************************************/
function btn_saveFile_OnClick(obj)
{	
	var fileNameApp = left(GetDate(),8) +"_"+ right(GetDate(),6) +"_"+ G_USER_ID;

	var arr = tit_fileWrite( 
			httpFile
			, "QM"
			, _F_FILE_DIR
			, _F_FILE_NAME	//로컬파일명
			, fileNameApp // 실제 db에 저장될 파일 이름
			, "U"
			, _SERVER_FNAME ); //삭제할 이전 파일명 

		// 처리 결과 확인하기 
		if( arr[0] != "S" ) {
			gfn_showAlert( arr[0] );
		} else {
		
			_SERVER_FNAME = fileNameApp;
			
			ds_master.SetColumn(ds_master.row, "RST_FILENM" , _F_FILE_NAME);
			ds_master.SetColumn(ds_master.row, "RST_FILEPATH" , arr[1]);
			ds_master.SetColumn(ds_master.row, "RST_FILENM_APP" , arr[2]);
			
			// 저장 하지 않고 CLOSE 시 삭제 처리용
			_F_FILENM_APP_DEL = arr[2];			
		}
}


function grd_rnd_OnCellDblClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
	if ( nCell == "5" ) { // 첨부자료
	
		var svrFileName = ds_rnd.GetColumn(nRow, "FILENM_APP");
		var orgFileName = ds_rnd.GetColumn(nRow, "FILENM");
		var ext         = gfn_getFileExt(ds_rnd.getColumn(nRow, "FILENM"));
		
		saveDialog.FileName = orgFileName;
		saveDialog.Filter = "All(*.*)|*.*";
		saveDialog.Open();
		
		var idx = indexOf(saveDialog.FileName, ".");
		var fdFileName = saveDialog.FileName;
		var fileName =  decode(idx, -1, fdFileName, substr(fdFileName, 0, indexOf(fdFileName, ".")));
		var localFileName = fileName + "." + ext;
		
		var rMsg = tit_fileRead(
						httpFile
						, F_SERVER_DIR			// 저장 디렉토리
						, svrFileName			// 서버에서 전송받을 이름
						, saveDialog.FilePath	// 로컬 경로
						, localFileName			// 로컬 파일명
		);
		
		if ( rMsg[0] == "E" ) {
			if ( length(trim(rMsg[1])) > 0 ) {
				gfn_showAlert("CW10025", rMsg[1]);
			} else {
				gfn_showAlert("CW10025", "파일 다운로드에 실패하였습니다.");
			}
		} else if ( rMsg[0] == null  || rMsg[0] == "" ) {
			gfn_showAlert("CW10025", "해당파일이 존재하지 않습니다.");
		} else {
			gfn_showAlert("CW10025", "파일을 다운로드 하였습니다.");
		}	
	}	
	
	if ( nCell == "3" ) { // 도면번호
	
		var url = "http://plm.hdel.co.kr/jsp/help/SRMopenDrawing.jsp?md$number=";
	
		var bfmatnr = ds_rnd.GetColumn(nRow, "BFMATNR");
		
		if( bfmatnr == null || bfmatnr == '' || bfmatnr == 'N/A' || bfmatnr == '해당없음' ) {
			gfn_showAlert("도면번호가 입력되지 않았습니다." );
			return;
		}
		
		url = url + bfmatnr;
				
		ExecBrowser(url);	
	}	
}

function grd_rnd_OnExpandUp(obj,nRow,nCell,strVal,nPivotIndex)
{
	if ( nCell == "5" ) { // 첨부자료
	
		var svrFileName = ds_rnd.GetColumn(nRow, "FILENM_APP");
		var orgFileName = ds_rnd.GetColumn(nRow, "FILENM");
		var ext         = gfn_getFileExt(ds_rnd.getColumn(nRow, "FILENM"));
		
		saveDialog.FileName = orgFileName;
		saveDialog.Filter = "All(*.*)|*.*";
		saveDialog.Open();
		
		var idx = indexOf(saveDialog.FileName, ".");
		var fdFileName = saveDialog.FileName;
		var fileName =  decode(idx, -1, fdFileName, substr(fdFileName, 0, indexOf(fdFileName, ".")));
		var localFileName = fileName + "." + ext;
		
		var rMsg = tit_fileRead(
						httpFile
						, F_SERVER_DIR			// 저장 디렉토리
						, svrFileName			// 서버에서 전송받을 이름
						, saveDialog.FilePath	// 로컬 경로
						, localFileName			// 로컬 파일명
		);
		
		if ( rMsg[0] == "E" ) {
			if ( length(trim(rMsg[1])) > 0 ) {
				gfn_showAlert("CW10025", rMsg[1]);
			} else {
				gfn_showAlert("CW10025", "파일 다운로드에 실패하였습니다.");
			}
		} else if ( rMsg[0] == null  || rMsg[0] == "" ) {
			gfn_showAlert("CW10025", "해당파일이 존재하지 않습니다.");
		} else {
			gfn_showAlert("CW10025", "파일을 다운로드 하였습니다.");
		}	
	}	
	
	if ( nCell == "3" ) { // 도면번호
	
		var url = "http://plm.hdel.co.kr/jsp/help/SRMopenDrawing.jsp?md$number=";
	
		var bfmatnr = ds_rnd.GetColumn(nRow, "BFMATNR");
		
		if( bfmatnr == null || bfmatnr == '' || bfmatnr == 'N/A' || bfmatnr == '해당없음' ) {
			gfn_showAlert("도면번호가 입력되지 않았습니다." );
			return;
		}
		
		url = url + bfmatnr;
				
		ExecBrowser(url);	
	}
}



/********************************************************************************
* 기      능   : 결과 보고서 다운로드
********************************************************************************/
function btn_rst_download_OnClick(obj)
{
	if (length( ed_FileName.value ) == 0 ) {
		gfn_showAlert("CW10025", "결과 보고서 파일이 존재하지 않습니다.");
		return;
	}
	
	var svrFileName = ds_master.GetColumn(0, "RST_FILENM_APP");
	var orgFileName = ds_master.GetColumn(0, "RST_FILENM");
	var ext         = gfn_getFileExt(ds_master.getColumn(0, "RST_FILENM"));
	
	saveDialog.FileName = orgFileName;
	saveDialog.Filter = "All(*.*)|*.*";
    saveDialog.Open();

	var idx = indexOf(saveDialog.FileName, ".");
	var fdFileName = saveDialog.FileName;
    var fileName =  decode(idx, -1, fdFileName, substr(fdFileName, 0, indexOf(fdFileName, ".")));
    var localFileName = fileName + "." + ext;
    
	var rMsg = tit_fileRead(
							httpFile
							, F_SERVER_DIR			// 저장 디렉토리
							, svrFileName			// 서버에서 전송받을 이름
							, saveDialog.FilePath	// 로컬 경로
							, localFileName			// 로컬 파일명
	);
	
	if ( rMsg[0] == "E" ) {
		if ( length(trim(rMsg[1])) > 0 ) {
			gfn_showAlert("CW10025", rMsg[1]);
		} else {
			gfn_showAlert("CW10025", "파일 다운로드에 실패하였습니다.");
		}
	} else if ( rMsg[0] == null  || rMsg[0] == "" ) {
		gfn_showAlert("CW10025", "해당파일이 존재하지 않습니다.");
	} else {
		gfn_showAlert("CW10025", "파일을 다운로드 하였습니다.");
	}
}
/********************************************************************************
* 기      능   : 첨부파일 추가
********************************************************************************/
function btn_add_OnClick(obj)
{

	var fileNameApp = "";
	
	if(ds_file.rowcount >= 30)
	{
		gfn_openMsgWin("추가할 수 있는 파일 개수를 초과했습니다.\n (최대 30개 저장가능)","","A");
		return;
	}
	
	var sRtn = fileDialog.open();
	
	if(sRtn == 0) return;	
	
	if ( length(fileDialog.FilePath) == 0 
		|| length(fileDialog.FileName ) == 0 ) {
		return;
	}	
	
	var fileSize = f_tmp.GetLength(fileDialog.FilePath + "\\" + fileDialog.FileName );
	if ( fileSize <= 0 ) {
		gfn_showAlert("CW00048");
		return;
	}
	
	if ( fileSize > toNumber(F_SIZE)) {
		gfn_showAlert("CW00047", "10 Mbytes" );	
		return;
	}	
	
	// 파일정보
	if(length(fileDialog.FileName) == 0 ) {
		gfn_showMsg("첨부 파일을 확인해 주세요.");
		return;
	}	
	
	if(ds_file.rowcount >= 30) {
		gfn_showMsg("추가할 수 있는 파일 개수를 초과했습니다. (최대 30개 저장가능)");
		return;
	}
	
	var nRow = ds_file.AddRow();
	var nSeq =  fn_getMaxFileseq();	
	
	ds_file.setColumn(nRow, "FLAG"   , "I");
	ds_file.setColumn(nRow, "REQSEQ"  , ds_master.GetColumn(0, "REQSEQ" ));
	ds_file.SetColumn(nRow, "FILESEQ", nSeq);
	ds_file.setColumn(nRow, "FILESIZE", fileSize);
	ds_file.setColumn(nRow, "FILEPATH", fileDialog.FilePath);
	ds_file.setColumn(nRow, "FILENM", fileDialog.FileName);
	
	fileNameApp = left(GetDate(),8) +"_"+ right(GetDate(),6) +"_"+ G_USER_ID +"_"+ ds_file.getColumn(nRow, "FILESEQ");

	var arr = tit_fileWrite(httpFile
	, "QM"
	, ds_file.getColumn(nRow, "FILEPATH")
	, ds_file.getColumn(nRow, "FILENM")
	, fileNameApp// 실제 db에 저장될 파일 이름
	, "U"	  // time stamp를 붙이지 않을 경우 U 사용 
	//, ds_del_file.GetColumn(nRow,"FILENM"));    // ds_list_i.getColumn(i, "DEL_FNAME") );//삭제할 이전 파일명 
	, "" );
	
	if ( arr[0] == "S" ) {
		//ds_file.setColumn(nRow, "FILENM_APP", fileNameApp);
		ds_file.setColumn(nRow, "FILEPATH", arr[1]);
		ds_file.setColumn(nRow, "FILENM_APP", arr[2]);
	} else if ( arr[0] != "S" ) {
		//gfn_showMsg("CW00035"); 
		alert(arr[0]);
		return;
	}	
	
}

function fn_getMaxFileseq()
{ 
	var max_seq 	= 0;
	var seq 		= 0; 
	for (var i=0;i<ds_file.GetCount();i++)
	{
		seq = ds_file.GetColumn(i, "FILESEQ");  
		if (ToNumber(seq) > ToNumber(max_seq))
		{
			max_seq = seq;
		}
	}
	return ToNumber(max_seq) + 1;
}


/********************************************************************************
* 기      능   : 첨부파일 삭제
********************************************************************************/
function btn_del_OnClick(obj)
{
	var nRow = ds_file.currow;
	
	if ( nRow > -1 ) {	
		var sRowType = ds_file.GetRowType(nRow);
		if ( sRowType == "insert" ) {		

			var sFileName = ds_file.GetColumn(nRow, "FILENM");
			
			if(length(sFileName) != 0) {
				var arr = tit_fileDelete("QM",ds_file.getColumn(nRow, "FILENM_APP"), false);
			}
		
			ds_file.DeleteRow(nRow);
		} else {
			ds_file.SetColumn(nRow, "FLAG", "D");		
		}
	}
}

function grd_rnd_OnMouseOver(obj,nPosX,nPosY,nRow,nCell,nPivotIndex)
{
	if((parseInt(nRow) > -1 && parseInt(nCell) == 2) || 
		(parseInt(nRow) > -1 && parseInt(nCell) == 3) || 
		(parseInt(nRow) > -1 && parseInt(nCell) == 4) ) {
		
		grd_rnd.ToolTipText = grd_rnd.GetCellValue(nRow,nCell);		
	} else {
	
		grd_rnd.ToolTipText = "";
	}		
}


/********************************************************************************
* 기      능   : 개선대책 보고서 다운로드
********************************************************************************/
function div_imp_btn_imp_download_OnClick(obj)
{

	if (length( div_imp.ed_imp_filename.value ) == 0 ) {
		gfn_showAlert("CW10025", "개선대책 보고서 파일이 존재하지 않습니다.");
		return;
	}
	
	var svrFileName = ds_master.GetColumn(0, "IMP_FILENM_APP");
	var orgFileName = ds_master.GetColumn(0, "IMP_FILENM");
	var ext         = gfn_getFileExt(ds_master.getColumn(0, "IMP_FILENM"));
	
	saveDialog1.FileName = orgFileName;
	saveDialog1.Filter = "All(*.*)|*.*";
    saveDialog1.Open();

	var idx = indexOf(saveDialog1.FileName, ".");
	var fdFileName = saveDialog1.FileName;
    var fileName =  decode(idx, -1, fdFileName, substr(fdFileName, 0, indexOf(fdFileName, ".")));
    var localFileName = fileName + "." + ext;
    
    
	var rMsg = tit_fileRead(
							httpFile
							, F_SERVER_DIR			// 저장 디렉토리
							, svrFileName			// 서버에서 전송받을 이름
							, saveDialog1.FilePath	// 로컬 경로
							, localFileName			// 로컬 파일명
	);
	
	if ( rMsg[0] == "E" ) {
		if ( length(trim(rMsg[1])) > 0 ) {
			alert(rMsg[1]);
			gfn_showAlert("CW10025", rMsg[1]);
		} else {
			gfn_showAlert("CW10025", "파일 다운로드에 실패하였습니다.");
		}
	} else if ( rMsg[0] == null  || rMsg[0] == "" ) {
		gfn_showAlert("CW10025", "해당파일이 존재하지 않습니다.");
	} else {
	
		//alert(rMsg[1]);
		rMsg = null;
		
		gfn_showAlert("CW10025", "파일을 다운로드 하였습니다.");
	}	
}]]></Script>
</Window>