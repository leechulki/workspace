<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="400" Id="PS1501003A" Left="8" OnLoadCompleted="fn_OnLoadCompleted" OnUnloadCompleted="fn_OnUnloadCompleted" PidAttrib="7" Title="전자결재&#32;결재처리" Top="8" Ver="1.0" Width="648" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_cond" UseClientLayout="1">
				<Contents>
					<colinfo id="DOCU_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN" size="256" summ="default" type="STRING"/>
					<record>
						<DOCU_NO></DOCU_NO>
						<GBN></GBN>
						<POSID></POSID>
						<PSPID></PSPID>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_head">
				<Contents>
					<colinfo id="LIFNR" size="255" type="STRING"/>
					<colinfo id="NAME1" size="256" type="STRING"/>
					<colinfo id="NAMEC" size="256" type="STRING"/>
					<colinfo id="CNT" size="256" type="STRING"/>
					<colinfo id="DIRECT" size="256" type="STRING"/>
					<colinfo id="INDIRECT" size="256" type="STRING"/>
					<colinfo id="TELNO_O" size="256" type="STRING"/>
					<colinfo id="FAX_O" size="256" type="STRING"/>
					<colinfo id="ADDR" size="256" type="STRING"/>
					<record>
						<ADDR></ADDR>
						<CNT></CNT>
						<DIRECT></DIRECT>
						<FAX_O></FAX_O>
						<INDIRECT></INDIRECT>
						<LIFNR></LIFNR>
						<NAME1></NAME1>
						<NAMEC></NAMEC>
						<TELNO_O></TELNO_O>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_apply">
				<Contents>
					<colinfo id="GID" size="0" summ="default" type="STRING"/>
					<colinfo id="GNM" size="0" summ="default" type="STRING"/>
					<colinfo id="RANK" size="0" summ="default" type="STRING"/>
					<colinfo id="DPTNM" size="0" summ="default" type="STRING"/>
					<colinfo id="USERMBPN" size="256" summ="default" type="STRING"/>
					<colinfo id="AREA_N" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="PERNO" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_master">
				<Contents>
					<colinfo id="column0" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond2">
				<Contents>
					<colinfo id="DOCU_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="NEXT_STATE" size="256" summ="default" type="STRING"/>
					<colinfo id="REJT_MEMO" size="256" summ="default" type="STRING"/>
					<colinfo id="APP_MEMO" size="256" summ="default" type="STRING"/>
					<colinfo id="CURR_STATE" size="256" summ="default" type="STRING"/>
					<colinfo id="REJT_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="STATE" size="256" summ="default" type="STRING"/>
					<colinfo id="PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="REQ_BN_MG" size="256" summ="default" type="STRING"/>
					<colinfo id="REQ_BN_MG_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="REQ_BN_TM" size="256" summ="default" type="STRING"/>
					<colinfo id="REQ_BN_TM_DT" size="256" summ="default" type="STRING"/>
					<colinfo id="REJT_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="REJT_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="REQ_BN_QC" size="256" summ="default" type="STRING"/>
					<colinfo id="REQ_BN_QC_DT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_detail">
				<Contents>
					<colinfo id="column0" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_last">
				<Contents>
					<colinfo id="APP_CNFM_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="APP_STATE" size="256" summ="default" type="STRING"/>
					<colinfo id="APP_MEMO" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_return">
				<Contents>
					<colinfo id="PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="JOB_CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="M_TYPE" size="256" summ="default" type="STRING"/>
					<colinfo id="CONTENTS" size="256" summ="default" type="STRING"/>
					<colinfo id="ALM_INDC" size="256" summ="default" type="STRING"/>
					<colinfo id="BELONG" size="256" summ="default" type="STRING"/>
					<record>
						<ALM_INDC></ALM_INDC>
						<BELONG></BELONG>
						<CONTENTS></CONTENTS>
						<JOB_CODE></JOB_CODE>
						<LIFNR></LIFNR>
						<M_TYPE></M_TYPE>
						<POSID></POSID>
						<PSPID></PSPID>
					</record>
				</Contents>
			</Dataset>
		</Datasets>
		<Static Align="Center" BKColor="user5" Height="15" Id="st_cha64" Left="539" Style="sty_lb_form_basic" TabOrder="44" Top="166" VAlign="Middle" Width="90"></Static>
		<Static Align="Center" BKColor="user5" Height="22" Id="st_cha54" Left="539" Style="sty_lb_form_basic" TabOrder="41" Top="143" VAlign="Middle" Width="91"></Static>
		<Static Align="Center" BKColor="user5" Height="15" Id="st_cha74" Left="539" Style="sty_lb_form_basic" TabOrder="47" Top="182" VAlign="Middle" Width="91"></Static>
		<Static Align="Center" BKColor="user5" Height="15" Id="st_cha84" Left="539" Style="sty_lb_form_basic" TabOrder="50" Top="198" VAlign="Middle" Width="91"></Static>
		<Shape BKColor="user12" Bottom="136" Height="17" Id="Shape4" Left="538" LineColor="user13" Right="634" TabOrder="81" Top="119" Type="Rectangle" Width="96"></Shape>
		<Shape BKColor="user12" Bottom="120" Height="17" Id="Shape37" Left="538" LineColor="user13" Right="634" TabOrder="10" Top="103" Type="Rectangle" Width="96"></Shape>
		<Shape BKColor="user12" Bottom="104" Height="17" Id="Shape32" Left="538" LineColor="user13" Right="634" TabOrder="7" Top="87" Type="Rectangle" Width="96"></Shape>
		<Shape BKColor="user12" Bottom="88" Height="40" Id="sh3" Left="538" LineColor="user13" Right="634" TabOrder="4" Top="48" Type="Rectangle" Width="96"></Shape>
		<Static Align="Center" BKColor="user5" Height="15" Id="st_cha94" Left="539" Style="sty_lb_form_basic" TabOrder="88" Top="120" VAlign="Middle" Width="93"></Static>
		<Static Align="Center" BKColor="user5" Height="15" Id="st_cha44" Left="539" Style="sty_lb_form_basic" TabOrder="87" Top="104" VAlign="Middle" Width="93"></Static>
		<Static Align="Center" BKColor="user5" Height="15" Id="st_cha34" Left="539" Style="sty_lb_form_basic" TabOrder="86" Top="88" VAlign="Middle" Width="93"></Static>
		<Static Align="Center" BKColor="user5" Height="15" Id="st_cha24" Left="539" Style="sty_lb_form_basic" TabOrder="77" Top="72" VAlign="Middle" Width="93"></Static>
		<Static Align="Center" BKColor="user5" Height="22" Id="st_cha14" Left="539" Style="sty_lb_form_basic" TabOrder="85" Top="49" VAlign="Middle" Width="93"></Static>
		<Div Height="35" Id="div_btn" Left="-1" TabOrder="1" Text="Div0" Url="WB01::CommBtnForm.xml" Width="645">
			<Contents></Contents>
		</Div>
		<Shape BKColor="user12" Bottom="88" Height="40" Id="sh1" Left="412" LineColor="user13" Right="476" TabOrder="2" Top="48" Type="Rectangle" UserData="ddd" Width="64"></Shape>
		<Shape BKColor="user12" Bottom="88" Height="40" Id="sh2" Left="475" LineColor="user13" Right="539" TabOrder="3" Top="48" Type="Rectangle" Width="64"></Shape>
		<Shape BKColor="user12" Bottom="104" Height="17" Id="Shape30" Left="412" LineColor="user13" Right="476" TabOrder="5" Top="87" Type="Rectangle" Width="64"></Shape>
		<Shape BKColor="user12" Bottom="104" Height="17" Id="Shape31" Left="475" LineColor="user13" Right="539" TabOrder="6" Top="87" Type="Rectangle" Width="64"></Shape>
		<Shape BKColor="user12" Bottom="120" Height="17" Id="Shape35" Left="412" LineColor="user13" Right="476" TabOrder="8" Top="103" Type="Rectangle" UserData="dsfsdfsd" Width="64"></Shape>
		<Shape BKColor="user12" Bottom="120" Height="17" Id="Shape36" Left="475" LineColor="user13" Right="539" TabOrder="9" Top="103" Type="Rectangle" Width="64"></Shape>
		<Shape BKColor="user12" Bottom="136" Height="88" Id="Shape40" Left="326" LineColor="user13" Right="350" TabOrder="11" Top="48" Type="Rectangle" Width="24"></Shape>
		<Static Align="Center" Height="64" Id="Static8" Left="327" Style="sty_lb_form_basic" TabOrder="12" Text="결" Top="49" VAlign="Middle" Width="22"></Static>
		<Static Align="Center" Height="49" Id="Static0" Left="327" Style="sty_lb_form_basic" TabOrder="13" Text="재" Top="86" VAlign="Middle" Width="22"></Static>
		<Static Align="Center" BKColor="user5" Height="22" Id="st_cha12" Left="413" Style="sty_lb_form_basic" TabOrder="14" Top="49" VAlign="Middle" Width="62"></Static>
		<Static Align="Center" BKColor="user5" Height="22" Id="st_cha13" Left="476" Style="sty_lb_form_basic" TabOrder="15" Top="49" VAlign="Middle" Width="62"></Static>
		<Static Align="Center" BKColor="user5" Height="15" Id="st_cha32" Left="413" Style="sty_lb_form_basic" TabOrder="18" Top="88" VAlign="Middle" Width="62"></Static>
		<Static Align="Center" BKColor="user5" Height="15" Id="st_cha33" Left="476" Style="sty_lb_form_basic" TabOrder="19" Top="88" VAlign="Middle" Width="62"></Static>
		<Static Align="Center" BKColor="user5" Height="15" Id="st_cha42" Left="413" Style="sty_lb_form_basic" TabOrder="20" Top="104" VAlign="Middle" Width="62"></Static>
		<Static Align="Center" BKColor="user5" Height="15" Id="st_cha43" Left="476" Style="sty_lb_form_basic" TabOrder="21" Top="104" VAlign="Middle" Width="62"></Static>
		<Static Align="Center" BKColor="user5" Height="15" Id="st_cha22" Left="413" Style="sty_lb_form_basic" TabOrder="16" Top="72" VAlign="Middle" Width="62"></Static>
		<Static Align="Center" BKColor="user5" Height="15" Id="st_cha23" Left="476" Style="sty_lb_form_basic" TabOrder="17" Top="72" VAlign="Middle" Width="62"></Static>
		<Shape BKColor="user12" Bottom="88" Height="40" Id="Shape20" Left="349" LineColor="user13" Right="413" TabOrder="22" Top="48" Type="Rectangle" Width="64"></Shape>
		<Shape BKColor="user12" Bottom="104" Height="17" Id="Shape21" Left="349" LineColor="user13" Right="413" TabOrder="23" Top="87" Type="Rectangle" Width="64"></Shape>
		<Shape BKColor="user12" Bottom="120" Height="17" Id="Shape22" Left="349" LineColor="user13" Right="413" TabOrder="24" Top="103" Type="Rectangle" Width="64"></Shape>
		<Static Align="Center" BKColor="user5" Height="22" Id="st_cha11" Left="350" Style="sty_lb_form_basic" TabOrder="25" Top="49" VAlign="Middle" Width="62"></Static>
		<Static Align="Center" BKColor="user5" Height="15" Id="st_cha31" Left="350" Style="sty_lb_form_basic" TabOrder="27" Top="88" VAlign="Middle" Width="62"></Static>
		<Static Align="Center" BKColor="user5" Height="15" Id="st_cha41" Left="350" Style="sty_lb_form_basic" TabOrder="28" Top="104" VAlign="Middle" Width="62"></Static>
		<Static Align="Center" BKColor="user5" Height="15" Id="st_cha21" Left="350" Style="sty_lb_form_basic" TabOrder="26" Top="72" VAlign="Middle" Width="62"></Static>
		<Shape BKColor="user12" Bottom="182" Height="40" Id="Shape23" Left="412" LineColor="user13" Right="476" TabOrder="29" Top="142" Type="Rectangle" UserData="ddd" Width="64"></Shape>
		<Shape BKColor="user12" Bottom="182" Height="40" Id="Shape24" Left="475" LineColor="user13" Right="539" TabOrder="30" Top="142" Type="Rectangle" Width="64"></Shape>
		<Shape BKColor="user12" Bottom="182" Height="40" Id="Shape25" Left="538" LineColor="user13" Right="634" TabOrder="31" Top="142" Type="Rectangle" Width="96"></Shape>
		<Shape BKColor="user12" Bottom="198" Height="17" Id="Shape28" Left="412" LineColor="user13" Right="476" TabOrder="32" Top="181" Type="Rectangle" Width="64"></Shape>
		<Shape BKColor="user12" Bottom="198" Height="17" Id="Shape29" Left="475" LineColor="user13" Right="539" TabOrder="33" Top="181" Type="Rectangle" Width="64"></Shape>
		<Shape BKColor="user12" Bottom="198" Height="17" Id="Shape41" Left="538" LineColor="user13" Right="634" TabOrder="34" Top="181" Type="Rectangle" Width="96"></Shape>
		<Shape BKColor="user12" Bottom="214" Height="17" Id="Shape44" Left="412" LineColor="user13" Right="476" TabOrder="35" Top="197" Type="Rectangle" UserData="dsfsdfsd" Width="64"></Shape>
		<Shape BKColor="user12" Bottom="214" Height="17" Id="Shape45" Left="475" LineColor="user13" Right="539" TabOrder="36" Top="197" Type="Rectangle" Width="64"></Shape>
		<Shape BKColor="user12" Bottom="214" Height="17" Id="Shape46" Left="538" LineColor="user13" Right="634" TabOrder="37" Top="197" Type="Rectangle" Width="96"></Shape>
		<Shape BKColor="user12" Bottom="214" Height="72" Id="Shape49" Left="326" LineColor="user13" Right="350" TabOrder="38" Top="142" Type="Rectangle" Width="24"></Shape>
		<Static Align="Center" BKColor="user5" Height="22" Id="st_cha52" Left="413" Style="sty_lb_form_basic" TabOrder="39" Top="143" VAlign="Middle" Width="62"></Static>
		<Static Align="Center" BKColor="user5" Height="22" Id="st_cha53" Left="476" Style="sty_lb_form_basic" TabOrder="40" Top="143" VAlign="Middle" Width="62"></Static>
		<Static Align="Center" BKColor="user5" Height="15" Id="st_cha72" Left="413" Style="sty_lb_form_basic" TabOrder="45" Top="182" VAlign="Middle" Width="62"></Static>
		<Static Align="Center" BKColor="user5" Height="15" Id="st_cha73" Left="476" Style="sty_lb_form_basic" TabOrder="46" Top="182" VAlign="Middle" Width="62"></Static>
		<Static Align="Center" BKColor="user5" Height="15" Id="st_cha82" Left="413" Style="sty_lb_form_basic" TabOrder="48" Top="198" VAlign="Middle" Width="62"></Static>
		<Static Align="Center" BKColor="user5" Height="15" Id="st_cha83" Left="476" Style="sty_lb_form_basic" TabOrder="49" Top="198" VAlign="Middle" Width="62"></Static>
		<Static Align="Center" BKColor="user5" Height="15" Id="st_cha62" Left="413" Style="sty_lb_form_basic" TabOrder="42" Top="166" VAlign="Middle" Width="62"></Static>
		<Static Align="Center" BKColor="user5" Height="15" Id="st_cha63" Left="476" Style="sty_lb_form_basic" TabOrder="43" Top="166" VAlign="Middle" Width="62"></Static>
		<Shape BKColor="user12" Bottom="182" Height="40" Id="Shape50" Left="349" LineColor="user13" Right="413" TabOrder="51" Top="142" Type="Rectangle" Width="64"></Shape>
		<Shape BKColor="user12" Bottom="198" Height="17" Id="Shape51" Left="349" LineColor="user13" Right="413" TabOrder="52" Top="181" Type="Rectangle" Width="64"></Shape>
		<Shape BKColor="user12" Bottom="214" Height="17" Id="Shape52" Left="349" LineColor="user13" Right="413" TabOrder="53" Top="197" Type="Rectangle" Width="64"></Shape>
		<Static Align="Center" BKColor="user5" Height="22" Id="st_cha51" Left="350" Style="sty_lb_form_basic" TabOrder="54" Top="143" VAlign="Middle" Width="62"></Static>
		<Static Align="Center" BKColor="user5" Height="15" Id="st_cha71" Left="350" Style="sty_lb_form_basic" TabOrder="56" Top="182" VAlign="Middle" Width="62"></Static>
		<Static Align="Center" BKColor="user5" Height="15" Id="st_cha81" Left="350" Style="sty_lb_form_basic" TabOrder="57" Top="198" VAlign="Middle" Width="62"></Static>
		<Static Align="Center" BKColor="user5" Height="15" Id="st_cha61" Left="350" Style="sty_lb_form_basic" TabOrder="55" Top="166" VAlign="Middle" Width="62"></Static>
		<Static Align="Center" Height="17" Id="Static14" Left="327" Style="sty_lb_form_basic" TabOrder="59" Top="196" VAlign="Middle" Width="22"></Static>
		<Static Align="Center" Height="17" Id="Static15" Left="327" Style="sty_lb_form_basic" TabOrder="58" Text="수" Top="143" VAlign="Middle" Width="22"></Static>
		<Static Align="Center" Height="18" Id="Static43" Left="327" Style="sty_lb_form_basic" TabOrder="60" Text="신" Top="160" VAlign="Middle" Width="22"></Static>
		<Static Align="Center" Height="18" Id="Static44" Left="327" Style="sty_lb_form_basic" TabOrder="61" Text="팀" Top="178" VAlign="Middle" Width="22"></Static>
		<Static BindDataset="ds_master" BKColor="user5" Border="None" Column="DPTNM" Height="20" Id="st_dept" Left="114" Style="sty_lb_form_basic" TabOrder="67" Top="83" VAlign="Middle" Width="184"></Static>
		<Static BindDataset="ds_master" BKColor="user5" Border="None" Column="RANK" Height="20" Id="st_rank" Left="114" Style="sty_lb_form_basic" TabOrder="68" Top="104" VAlign="Middle" Width="184"></Static>
		<Static BindDataset="ds_master" BKColor="user5" Border="None" Column="APP_REQ_NM" Height="20" Id="st_namec" Left="114" Style="sty_lb_form_basic" TabOrder="69" Top="125" VAlign="Middle" Width="184"></Static>
		<Static BindDataset="ds_master" BKColor="user5" Border="None" Column="APP_REQ_DT" Height="20" Id="st_enters" Left="114" Style="sty_lb_form_basic" TabOrder="70" Top="146" VAlign="Middle" Width="184"></Static>
		<Static BKColor="user5" Border="None" Height="20" Id="Static28" Left="114" Style="sty_lb_form_basic" TabOrder="71" Text="&#32;수신처&#32;참조" Top="167" VAlign="Middle" Width="184"></Static>
		<Static Align="Right" BKColor="user5" Border="None" Height="20" Id="Static17" Left="19" Style="sty_lb_form_basic" TabOrder="62" Text="기&#32;안&#32;부&#32;서&#32;" Top="83" VAlign="Middle" Width="88"></Static>
		<Static Align="Right" BKColor="user5" Border="None" Height="20" Id="Static18" Left="19" Style="sty_lb_form_basic" TabOrder="63" Text="직&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;위&#32;" Top="104" VAlign="Middle" Width="88"></Static>
		<Static Align="Right" BKColor="user5" Border="None" Height="20" Id="Static20" Left="19" Style="sty_lb_form_basic" TabOrder="64" Text="기&#32;&#32;&#32;안&#32;&#32;&#32;자&#32;" Top="125" VAlign="Middle" Width="88"></Static>
		<Static Align="Right" BKColor="user5" Border="None" Height="20" Id="Static22" Left="19" Style="sty_lb_form_basic" TabOrder="65" Text="기&#32;안&#32;일&#32;자&#32;" Top="146" VAlign="Middle" Width="88"></Static>
		<Static Align="Right" BKColor="user5" Border="None" Height="20" Id="Static23" Left="19" Style="sty_lb_form_basic" TabOrder="66" Text="수&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;신&#32;" Top="167" VAlign="Middle" Width="88"></Static>
		<Shape BKColor="user12" Bottom="273" Height="26" Id="Shape0" Left="18" LineColor="user13" Right="632" TabOrder="74" Top="247" Type="Rectangle" Width="614"></Shape>
		<Edit Border="Flat" Height="20" Id="ed_rejtMemo" ImeMode="native" Left="101" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="72" Top="250" Width="528"></Edit>
		<Static Align="Right" Height="24" Id="st_rejtmemo" Left="19" Style="sty_lb_form_basic" TabOrder="73" Text="반려&#32;메모&#32;" Top="248" VAlign="Middle" Width="80"></Static>
		<Grid AreaSelect="TRUE" AutoEnter="TRUE" AutoFit="TRUE" AutoFitEndLine="Hide" BindDataset="ds_detail" BkColor2="default" BoldHead="true" Border="Flat" Bottom="384" ColSelect="TRUE" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" FixedColSizing="TRUE" HeadBorder="Flat" HeadHeight="20" Height="101" Id="grd_detail" InputPanel="FALSE" Left="18" LineColor="user20" LineType="ExHORZ" MinWidth="100" Right="631" RowHeight="20" Style="sty_grid" TabOrder="75" TabStop="true" Top="283" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="613">
			<contents>
				<format id="Default">
					<columns>
						<col width="40"/>
						<col width="386"/>
					</columns>
					<head>
						<cell align="center" col="0" display="text" font="Default,9" text="차수" TrimType="Both"/>
						<cell align="center" col="1" display="text" font="Default,9" text="결재&#32;메모" TrimType="Both"/>
					</head>
					<body>
						<cell align="center" bkcolor="expr:iif(APP_MEMO_INDC&#32;==&#32;&apos;Y&apos;,&#32;&apos;honeydew&apos;,&#32;&apos;&apos;)" col="0" display="normal" expr="(CURROW+1)+&apos;차&apos;"/>
						<cell align="left" bkcolor="expr:iif(APP_MEMO_INDC&#32;==&#32;&apos;Y&apos;,&#32;&apos;honeydew&apos;,&#32;&apos;&apos;)" col="1" colid="APP_MEMO" display="text" edit="expr:iif(APP_MEMO_INDC&#32;==&#32;&apos;Y&apos;,&#32;&apos;normal&apos;,&#32;&apos;none&apos;)" imemode="native"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Image Enable="FALSE" Height="20" Id="img_ci" ImageID="img::top_ci.gif" Left="36" OnClick="img_ci_OnClick" Static="FALSE" TabOrder="76" Top="53" Width="172"></Image>
		<Shape BKColor="user12" Bottom="136" Height="17" Id="Shape1" Left="349" LineColor="user13" Right="413" TabOrder="78" Top="119" Type="Rectangle" Width="64"></Shape>
		<Shape BKColor="user12" Bottom="136" Height="17" Id="Shape2" Left="412" LineColor="user13" Right="476" TabOrder="79" Top="119" Type="Rectangle" Width="64"></Shape>
		<Shape BKColor="user12" Bottom="136" Height="17" Id="Shape3" Left="475" LineColor="user13" Right="539" TabOrder="80" Top="119" Type="Rectangle" Width="64"></Shape>
		<Static Align="Center" BKColor="user5" Height="15" Id="st_cha91" Left="350" Style="sty_lb_form_basic" TabOrder="84" Top="120" VAlign="Middle" Width="62"></Static>
		<Static Align="Center" BKColor="user5" Height="15" Id="st_cha92" Left="413" Style="sty_lb_form_basic" TabOrder="82" Top="120" VAlign="Middle" Width="62"></Static>
		<Static Align="Center" BKColor="user5" Height="15" Id="st_cha93" Left="476" Style="sty_lb_form_basic" TabOrder="83" Top="120" VAlign="Middle" Width="62"></Static>
	</Form>
	<Script><![CDATA[﻿﻿﻿﻿﻿﻿/*
 ******************************************************************************************
 * 기      능   : 
 * 작  성  자   : 
 * 작성  일자   : 
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
#include "LIB::commons.js";	// 공통 스크립트 
//=========================================================================================
// [ PART 1 ]
// Form에서 사용될 전역변수를 선언
// FORM에서 사용되는 전역변수는 대문자로 작성하며, F_XXX 의 형태를 갖도록 한다. 
//=========================================================================================
var _SUPRTCD = "";
var _state = "";
var enter = "";
var stats = "";
var name1 = "";
var namee = "";
var retif = "";
var lifnr_c = "";
var perno_c = "";
var jumin = "";
var lifnr = "";
var perno = "";
var perkey = "";
var pspid  = "";
var birth  = "";
var fv_last_state = "";
var F_SIZE = 1024 * 4096;
//=========================================================================================
// [ PART 2 ]
// Form Loading / Unloading 시 작업 정의
//=========================================================================================
function fn_OnLoadCompleted(obj) {
	// Form 로드 이벤트 맨 첫줄에 기술 
	gfn_initForm();
	
	// 현재 문서에 대한 ds_cond 세팅.
	//ds_cond.SetColumn(0, "PSPID", G_PSPID);
	//ds_cond.SetColumn(0, "POSID", G_POSID);
	//ds_cond.SetColumn(0, "GBN", G_GBN);
	ds_cond.SetColumn(0, "DOCU_NO", F_DOCU_NO);
	
	// 현재 결재라인 정보 가져오기
	ufn_getPaymentLineInfo();
	
	//ufn_initApplyInfo();

}

/********************************************************************************
* 기      능   : 결재선 정보 가져오기
********************************************************************************/
function ufn_getPaymentLineInfo() 
{
	tit_clearActionInfo();	
	tit_addSearchActionInfo("ps96:PS9603002A_S1");	// 최근결재정보 Master
	tit_addSearchActionInfo("ps96:PS9603002A_S2");	// 결재정보 Detail
	tit_addSearchActionInfo("ps96:PS9603002A_S3");	// 최근 결재해야할 사람
	tit_callService(
        ""
        , ""
        , "ds_cond=ds_cond"
		, "ds_master=ds_master ds_detail=ds_detail ds_last=ds_last"
        , ""
        , "ufn_afterPaymentLineInfo"
        , true);
}

/********************************************************************************
* 기      능   : 결재 정보 조회 후
********************************************************************************/
function ufn_afterPaymentLineInfo(){
	// ## 결재상태
	// ## A0 : 1차결재 / A1 : 2차결재 / A2 : 3차결재
	// ## A0 -> A1(1차->2차), A1 -> A2(2차->3차) 두 가지로 분류
	// MASTER 최신 결재상태가 A0 또는 A1 이면 결재 가능
	var sState = ds_master.getColumn(0, "APP_STATE");
	fv_last_state = ds_last.GetColumn(0, "APP_STATE");
	//Trace(fv_last_state);
	
	// 마지막 결재해야할 사람 = 로그인한 사람이고,  1차결재 또는 2차결재 일 경우 결재, 반려가능.
	if((sState == 'A0' || sState == 'A1' || sState == 'A2') && ds_last.GetColumn(0, "APP_CNFM_ID") == G_USER_ID)	
	{
		div_btn.btn_decide.Enable = true;
		div_btn.btn_reject.Enable = true;
	}
	else
	{
		div_btn.btn_decide.Enable = false;
		div_btn.btn_reject.Enable = false;
	}
	
	
	// 반려 메모 표시
	ed_rejtMemo.Text = ds_master.GetColumn(0, "REJT_MEMO");


	
	// 상세 결재내역 세팅
	var nFindRow = ds_detail.SearchRow("APP_STATE == 'A0'");	// 1차결재정보 세팅
	
	if(nFindRow >= 0)
	{
		st_cha11.Text = ds_detail.GetColumn(nFindRow, "DPTNM1");	// 부서명1
		st_cha21.Text = ds_detail.GetColumn(nFindRow, "DPTNM2");	// 부서명2
		st_cha91.Text = ds_detail.GetColumn(nFindRow, "APP_CNFM_DT");	// 결재일
		st_cha31.Text = ds_detail.GetColumn(nFindRow, "RANK");	// 직위
		st_cha41.Text = ds_detail.GetColumn(nFindRow, "APP_CNFM_NM");	// 성명
		
		if(Length(ds_detail.GetColumn(nFindRow, "APP_CNFM_DT")) > 0)
		{
			st_cha91.BkColor = 'lightgreen';
		}
	}
	
	var nFindRow = ds_detail.SearchRow("APP_STATE == 'A1'");	// 2차결재정보 세팅
	
	if(nFindRow >= 0)
	{
		st_cha12.Text = ds_detail.GetColumn(nFindRow, "DPTNM1");	// 부서명1
		st_cha22.Text = ds_detail.GetColumn(nFindRow, "DPTNM2");	// 부서명2
		st_cha92.Text = ds_detail.GetColumn(nFindRow, "APP_CNFM_DT");	// 결재일
		st_cha32.Text = ds_detail.GetColumn(nFindRow, "RANK");	// 직위
		st_cha42.Text = ds_detail.GetColumn(nFindRow, "APP_CNFM_NM");	// 성명
		
		if(Length(ds_detail.GetColumn(nFindRow, "APP_CNFM_DT")) > 0)
		{
			st_cha92.BkColor = 'lightgreen';
		}
	}
	
	var nFindRow = ds_detail.SearchRow("APP_STATE == 'A2'");	// 3차결재정보 세팅
	
	if(nFindRow >= 0)
	{
		st_cha13.Text = ds_detail.GetColumn(nFindRow, "DPTNM1");	// 부서명1
		st_cha23.Text = ds_detail.GetColumn(nFindRow, "DPTNM2");	// 부서명2
		st_cha93.Text = ds_detail.GetColumn(nFindRow, "APP_CNFM_DT");	// 결재일
		st_cha33.Text = ds_detail.GetColumn(nFindRow, "RANK");	// 직위
		st_cha43.Text = ds_detail.GetColumn(nFindRow, "APP_CNFM_NM");	// 성명
		
		if(Length(ds_detail.GetColumn(nFindRow, "APP_CNFM_DT")) > 0)
		{
			st_cha93.BkColor = 'lightgreen';
		}
	}
	
	var nFindRow = ds_detail.SearchRow("APP_STATE == 'A3'");	// 4차결재정보 세팅
	
	if(nFindRow >= 0)
	{
		st_cha14.Text = ds_detail.GetColumn(nFindRow, "DPTNM1");	// 부서명1
		st_cha24.Text = ds_detail.GetColumn(nFindRow, "DPTNM2");	// 부서명2
		st_cha94.Text = ds_detail.GetColumn(nFindRow, "APP_CNFM_DT");	// 결재일
		st_cha34.Text = ds_detail.GetColumn(nFindRow, "RANK");	// 직위
		st_cha44.Text = ds_detail.GetColumn(nFindRow, "APP_CNFM_NM");	// 성명
		
		if(Length(ds_detail.GetColumn(nFindRow, "APP_CNFM_DT")) > 0)
		{
			st_cha94.BkColor = 'lightgreen';
		}
	}
	
	
	
}


/********************************************************************************
* 기      능   : 공통코드가 조회된 후의 Callback 함수 
********************************************************************************/
function fn_completeInit(sCode, sDsObj, sCodeType) {
//ALERT("2");
	//fn_query2();
}

/********************************************************************************
* 기      능   : 조회 Callback  
********************************************************************************/
function fn_afterQuery(errCode, errMsg) {
	gfn_showMsg("CI00002",ds_swn.RowCount()+"");
}

/********************************************************************************
* 기      능   : 결재
********************************************************************************/
function fn_decide() {

	var updateFlag = true;
	
	
	if(!gfn_openMsgWin("결재 하시겠습니까?", "I", "C", "")) return;
	
	var sNextState = ds_last.GetColumn(0, "APP_STATE");
	var sCurrState = "";
	
	ds_cond2.ClearData();
	ds_cond2.AddRow();
	ds_cond2.SetColumn(0, "DOCU_NO", F_DOCU_NO);	//문서번호
	ds_cond2.SetColumn(0, "PSPID", G_PSPID);	//프로젝트번호
	ds_cond2.SetColumn(0, "POSID", G_POSID);	//호기번호
	ds_cond2.SetColumn(0, "GBN", G_GBN);		//작업구분
	
	if(sNextState == 'A1')	// 다음결재가 2차
	{
		sCurrState = 'A0';	
		ds_cond2.SetColumn(0, "REQ_BN_MG", G_USER_ID);		// 지사장 승인자
		ds_cond2.SetColumn(0, "REQ_BN_MG_DT", gfn_getCurrDate());			// 지사장 승인일
		ds_cond2.SetColumn(0, "REQ_BN_TM", '');		// 팀장 승인자
		ds_cond2.SetColumn(0, "REQ_BN_TM_DT", '');	// 팀장 승인일
		ds_cond2.SetColumn(0, "REQ_BN_QC", '');		// QC팀장 승인자
		ds_cond2.SetColumn(0, "REQ_BN_QC_DT", '');	// QC팀장 승인일
		ds_cond2.SetColumn(0, "STATE", "F");	// ZPSTW1401 상태값
	}
	else if(sNextState == 'A2')	
	{
		sCurrState = 'A1';	// 다음 : 3차결재
		ds_cond2.SetColumn(0, "REQ_BN_MG", '');		// 지사장 승인자
		ds_cond2.SetColumn(0, "REQ_BN_MG_DT", '');			// 지사장 승인일
		ds_cond2.SetColumn(0, "REQ_BN_TM", G_USER_ID);		// 팀장 승인자
		ds_cond2.SetColumn(0, "REQ_BN_TM_DT", gfn_getCurrDate());	// 팀장 승인일
		ds_cond2.SetColumn(0, "REQ_BN_QC", '');		// QC팀장 승인자
		ds_cond2.SetColumn(0, "REQ_BN_QC_DT", '');	// QC팀장 승인일
		
		if(G_GBN == 'X')	// ES_CRT일 경우에는 H로 임의 세팅.
		{
			ds_cond2.SetColumn(0, "STATE", "K");	// ZPSTW1401 상태값
		}
		else
		{
			ds_cond2.SetColumn(0, "STATE", "G");	// ZPSTW1401 상태값
		}
		
	}
	else if(sNextState == 'A3')	// QC팀장 결재
	{
		sCurrState = 'A2';	// 다음 : QC팀장 결재
		ds_cond2.SetColumn(0, "REQ_BN_MG", '');		// 지사장 승인자
		ds_cond2.SetColumn(0, "REQ_BN_MG_DT", '');			// 지사장 승인일
		ds_cond2.SetColumn(0, "REQ_BN_TM", '');		// 팀장 승인자
		ds_cond2.SetColumn(0, "REQ_BN_TM_DT", );	// 팀장 승인일
		ds_cond2.SetColumn(0, "REQ_BN_QC", G_USER_ID);		// QC팀장 승인자
		ds_cond2.SetColumn(0, "REQ_BN_QC_DT", gfn_getCurrDate());	// QC팀장 승인일
		
		ds_cond2.SetColumn(0, "STATE", "G");	// ZPSTW1401 상태값
	}

	ds_cond2.SetColumn(0, "NEXT_STATE", sNextState);			//다음결재상태
	ds_cond2.SetColumn(0, "CURR_STATE", sCurrState);			//현재결재상태
	ds_cond2.SetColumn(0, "REJT_DT", '');			//반려일자
	ds_cond2.SetColumn(0, "REJT_MEMO", '');			//반려메모

	tit_clearActionInfo();
	tit_addMultiActionInfo("ps96:PS9603002A_U1");	// ZPSTEA01M UPDATE
	tit_addMultiActionInfo("ps96:PS9603002A_U2");	// ZPSTEA01D UPDATE
	
	if(sCurrState == 'A0')
	{
		tit_addMultiActionInfo("ps96:PS9603002A_U3");	// ZPSTW1401 UPDATE - 2차결재
	}
	else if(sCurrState == 'A1')
	{
		tit_addMultiActionInfo("ps96:PS9603002A_U8");	// ZPSTW1401 UPDATE - 3차결재
	}
	else	// A2
	{
		tit_addMultiActionInfo("ps96:PS9603002A_U9");	// ZPSTW1401 UPDATE - 4차결재
	}
	
	tit_callService(
			""
			, ""
			, "ds_cond2=ds_cond2"
			, ""
			, ""
			, "fn_afterSave"
			, ""
			, ""
			, true);
}
/********************************************************************************
* 기      능   : 저장 Callback  
********************************************************************************/
function fn_afterSave(errCode, errMsg) {
	tit_clearActionInfo();
	tit_addMultiActionInfo("ps96:PS9603002A_U4");	// ZPSTEA01D에 1차,2차,3차 결재자 메모 UPDATE
	tit_callService(
			""
			, ""
			, "ds_detail=ds_detail"
			, ""
			, ""
			, "fn_afterSave2"
			, ""
			, ""
			, true);	
	
}

function fn_afterSave2(errCode, errMsg) {
	if ( errCode != 0 ) {
		gfn_showAlert("CE00001");
		
	} else {
		ufn_getPaymentLineInfo();
		gfn_openMsgWin("결재되었습니다.");
		
		var sNextState = ds_last.GetColumn(0, "APP_STATE");
		
		if(sNextState == "A2" || sNextState == "A3")
		{
			fn_sendMail();
		}else{
			close();
		}

	}
}

/********************************************************************************
* 기      능   : 반려
********************************************************************************/
function fn_reject() {
	if(!gfn_openMsgWin("반려 하시겠습니까?", "I", "C", "")) return;
	
	var sNextState = ds_last.GetColumn(0, "APP_STATE");
	
	ds_cond2.ClearData();
	ds_cond2.AddRow();
	ds_cond2.SetColumn(0, "DOCU_NO", F_DOCU_NO);	//문서번호
	ds_cond2.SetColumn(0, "PSPID", G_PSPID);	//프로젝트번호
	ds_cond2.SetColumn(0, "POSID", G_POSID);	//호기번호
	ds_cond2.SetColumn(0, "GBN", G_GBN);		//작업구분
	ds_cond2.SetColumn(0, "REQ_BN_MG", '');		// 지사장 승인자
	ds_cond2.SetColumn(0, "REQ_BN_MG_DT", '');			// 지사장 승인일
	ds_cond2.SetColumn(0, "REQ_BN_TM", '');		// 팀장 승인자
	ds_cond2.SetColumn(0, "REQ_BN_TM_DT", '');	// 팀장 승인일
	ds_cond2.SetColumn(0, "REQ_BN_QC", '');		// QC팀장 승인자
	ds_cond2.SetColumn(0, "REQ_BN_QC_DT", '');	// QC팀장 승인일
	
	ds_cond2.SetColumn(0, "STATE", "D");						// ZPSTW1401 상태값
	ds_cond2.SetColumn(0, "REJT_ID", G_USER_ID);			//반려자사번
	ds_cond2.SetColumn(0, "REJT_NM", G_USER_NAME);			//반려자명
	ds_cond2.SetColumn(0, "REJT_DT", gfn_getCurrDate());			//반려일자
	ds_cond2.SetColumn(0, "REJT_MEMO", ed_rejtMemo.Text);			//반려메모
	ds_cond2.SetColumn(0, "NEXT_STATE", sNextState);			//현재 결재상태
	
	ds_return.SetColumn(0, "PSPID", G_PSPID);			//프로젝트번호
	ds_return.SetColumn(0, "POSID", G_POSID);			//호기번호
	ds_return.SetColumn(0, "LIFNR", G_LIFNR_OUT);		//외주업체코드
	ds_return.SetColumn(0, "JOB_CODE", G_GBN);	//외주작업코드
	ds_return.SetColumn(0, "M_TYPE", "3");										//메모타입(1:메모, 2:보완, 3:반려)
	ds_return.SetColumn(0, "CONTENTS", ed_rejtMemo.Text);						//반려사유
	ds_return.SetColumn(0, "ALM_INDC", "00000");								//알림대상(5자리) - 반려사유 등록 시 알림대상은 저장하지 않는다
	ds_return.SetColumn(0, "BELONG", G_VEND_NAME);							//메모등록 당시의 등록자 소속
	//Trace(ds_return.saveXML());
	
	tit_clearActionInfo();
	tit_addMultiActionInfo("ps96:PS9603002A_U5");	// ZPSTEA01M UPDATE
	tit_addMultiActionInfo("ps96:PS9603002A_U6");	// ZPSTEA01D UPDATE
	tit_addMultiActionInfo("ps96:PS9603002A_U7");	// ZPSTW1401 UPDATE
	tit_addMultiActionInfo("ps15:PS1505001P_I1");	//반려사유 저장
	
	tit_callService(
			""
			, ""
			, "ds_cond2=ds_cond2 ds_memo=ds_return:A"
			, ""
			, ""
			, "fn_afterRjct"
			, ""
			, ""
			, true);
}

function fn_afterRjct(errCode, errMsg)
{
	if ( errCode != 0 ) {
		gfn_showAlert("CE00001");
		
	} else {
		gfn_openMsgWin("반려처리되었습니다.");
		fn_sendRjctMail();
		close();
	}
	
}

/********************************************************************************
* 기      능   : 반려 메일발송
********************************************************************************/
function fn_sendRjctMail()
{
	//보내는 사람(1차)과 받는 사람(2차)을 Detail정보에서 둘다 가지고 있음.
	var sNextState = ds_last.GetColumn(0, "APP_STATE");
	var sCurrState = "";
	
	if(sNextState == 'A1')
	{
		sCurrState = 'A0';
	}
	else if(sNextState == 'A2')
	{
		sCurrState = 'A1';
	}
	else if(sNextState == 'A3')
	{
		sCurrState = 'A2';
	}
	
	var nSendRow = ds_detail.SearchRow("APP_STATE=='"+sNextState+"'");		//보내는 사람의 정보 Row
	var nRecvRow = ds_detail.SearchRow("APP_STATE=='"+sCurrState+"'");		// 받는사람의 정보 Row
	
	
	var send_user = "helco" + ds_detail.GetColumn(nSendRow, "APP_CNFM_ID") + "@hdel.co.kr";//보내는사람
	var rece_user = "helco" + ds_detail.GetColumn(nRecvRow, "APP_CNFM_ID") + "@hdel.co.kr"; //받는사람
	
	var send_user_nm = ds_detail.GetColumn(nSendRow, "APP_CNFM_NM"); //발신자 이름
	var rece_user_nm = ds_detail.GetColumn(nRecvRow, "APP_CNFM_NM"); //수신자 이름
		
	var mesgtitl  = ""; //제목
	var mesgbody  = ""; //내용
	
	var pop_meg = "";
	
	mesgtitl += '기타외주작업 반려메일 (' + G_POSID +' - ' + substr(G_ZSITE_NM,0,7) + ")";
	
	mesgbody = ds_detail.GetColumn(nSendRow, "DPTNM") + ' ' + ds_detail.GetColumn(nSendRow, "APP_CNFM_NM") +' 님이 SRM을 통해 발송한 메일입니다. ' + '\n\n'; 
	
    mesgbody =  mesgbody +'프로젝트번호: ' + G_POSID + '\n';
    mesgbody = mesgbody + '프로젝트명: ' + G_ZSITE_NM + '\n\n';
    
    mesgbody = mesgbody + '외주작업구분: '  + G_JOB_NAME + '를(을) 반려합니다.\n';
    mesgbody = mesgbody + '(결재 화면: SRM-발주기성-기타외주작업 작업지시서(관리자) 결재화면)\n\n';
    mesgbody = mesgbody + '감사합니다.\n';
    //------------------------------------------------------------------------------
	
	var cc_user = "";
    var cc_user_nm = "";
	
	//Trace(rece_user);
	//Trace(rece_user_nm);
	//Trace(send_user);
	//Trace(send_user_nm);
	//Trace(mesgtitl);
	//Trace(mesgbody);
	
	//send_user = "helco2029847@hdel.co.kr";
	//send_user_nm = "송광용";
	
    //rece_user = "helco2029847@hdel.co.kr";
	//rece_user_nm = "송광용";
	
    if(rece_user != "")
    {
    /*
		tit_callService(
			"COMM_ACT"
			, "sendmail"
			, ""
			, ""
			," SEND_USER=" + quote( send_user )
				+ " RECE_USER=" + quote( rece_user )
				+ " MESGTITL="  + quote( mesgtitl )
				+ " MESGBODY="  + quote( mesgbody )
			, ""
			, false
			, true);*/
			
		tit_callService(
			"COMM_ACT"
			, "sendmailNew"
			, ""
			, ""
			," SEND_USER=" + quote( send_user )
				+ " RECV_USER=" + quote( rece_user )
				+ " CC_USER=" + quote(cc_user)
				+ " SEND_USER_NM=" + quote( send_user_nm )
				+ " RECV_USER_NM=" + quote( rece_user_nm )
				+ " CC_USER_NM=" + quote(cc_user_nm)
				+ " MESGTITL="  + quote( mesgtitl )
				+ " MESGBODY="  + quote( mesgbody )
			, ""
			, false
			, true);
		pop_meg = '메일이 발송 되었습니다.';	
    }
    		
	close();
}

/********************************************************************************
* 기      능   : 메일발송
********************************************************************************/
function fn_sendMail()
{
	//보내는 사람(1차)과 받는 사람(2차)을 Detail정보에서 둘다 가지고 있음.
	var sNextState = ds_last.GetColumn(0, "APP_STATE");
	var sCurrState = "";
	
	if(sNextState == 'A2')
	{
		sCurrState = 'A1';
	}
	else if(sNextState == 'A3')
	{
		sCurrState = 'A2';
	}
	
	var nSendRow = ds_detail.SearchRow("APP_STATE=='"+sCurrState+"'");		//보내는 사람의 정보 Row
	var nRecvRow = ds_detail.SearchRow("APP_STATE=='"+sNextState+"'");		// 받는사람의 정보 Row
	
	//var nSendRow = ds_detail.SearchRow("APP_STATE=='A1'");		//보내는 사람의 정보 Row
	//var nRecvRow = ds_detail.SearchRow("APP_STATE=='A2'");		// 받는사람의 정보 Row
	
	
	var send_user = "helco" + ds_detail.GetColumn(nSendRow, "APP_CNFM_ID") + "@hdel.co.kr";//보내는사람
	var rece_user = "helco" + ds_detail.GetColumn(nRecvRow, "APP_CNFM_ID") + "@hdel.co.kr"; //받는사람
	
	Trace(rece_user);
	var send_user_nm = ds_detail.GetColumn(nSendRow, "APP_CNFM_NM"); //발신자 이름
	var rece_user_nm = ds_detail.GetColumn(nRecvRow, "APP_CNFM_NM"); //수신자 이름
		
	var mesgtitl  = ""; //제목
	var mesgbody  = ""; //내용
	
	var pop_meg = "";
	
	mesgtitl += '기타외주작업 결재요청 (' + G_POSID +' - ' + substr(G_ZSITE_NM,0,7) + ")";
	
	mesgbody = ds_detail.GetColumn(nSendRow, "DPTNM") + ' ' + ds_detail.GetColumn(nSendRow, "APP_CNFM_NM") +' 님이 SRM을 통해 발송한 메일입니다. ' + '\n\n'; 
	
    mesgbody =  mesgbody +'프로젝트번호: ' + G_POSID + '\n';
    mesgbody = mesgbody + '프로젝트명: ' + G_ZSITE_NM + '\n\n';
    
    mesgbody = mesgbody + '외주작업구분: '  + G_JOB_NAME + '를(을) 신청하오니 결재 바랍니다.\n';
    mesgbody = mesgbody + '(결재 화면: SRM-발주기성-기타외주작업 작업지시서(관리자) 결재화면)\n\n';
    mesgbody = mesgbody + '감사합니다.\n';
    //------------------------------------------------------------------------------
	
	var cc_user = "";
    var cc_user_nm = "";
	
	//Trace(rece_user);
	//Trace(rece_user_nm);
	//Trace(send_user);
	//Trace(send_user_nm);
	//Trace(mesgtitl);
	//Trace(mesgbody);
	
	//send_user = "helco2029847@hdel.co.kr";
	//send_user_nm = "송광용";
	
    //rece_user = "helco2029847@hdel.co.kr";
	//rece_user_nm = "송광용";
	
    if(rece_user != "")
    {
    /*
		tit_callService(
			"COMM_ACT"
			, "sendmail"
			, ""
			, ""
			," SEND_USER=" + quote( send_user )
				+ " RECE_USER=" + quote( rece_user )
				+ " MESGTITL="  + quote( mesgtitl )
				+ " MESGBODY="  + quote( mesgbody )
			, ""
			, false
			, true);*/
			
		tit_callService(
			"COMM_ACT"
			, "sendmailNew"
			, ""
			, ""
			," SEND_USER=" + quote( send_user )
				+ " RECV_USER=" + quote( rece_user )
				+ " CC_USER=" + quote(cc_user)
				+ " SEND_USER_NM=" + quote( send_user_nm )
				+ " RECV_USER_NM=" + quote( rece_user_nm )
				+ " CC_USER_NM=" + quote(cc_user_nm)
				+ " MESGTITL="  + quote( mesgtitl )
				+ " MESGBODY="  + quote( mesgbody )
			, ""
			, false
			, true);
		pop_meg = '메일이 발송 되었습니다.';	
    }
    

    if(fv_last_state != 'A2' && fv_last_state != 'A3')
    {
		fv_last_state = 'END';
	}
	close(fv_last_state);
}

/********************************************************************************
* 기      능   : form UnloadCompleted 
********************************************************************************/
function fn_OnUnloadCompleted(obj) {
	return gfn_isFormUnload(obj);
}
/********************************************************************************
* 기      능   : 닫기  
********************************************************************************/
function fn_close() {
	//parent.fn_Query();
	close();
	
}


]]></Script>
</Window>