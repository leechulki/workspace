<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="344" Id="PS9602004A" Left="8" OnLoadCompleted="OnLoadCompleted" PidAttrib="7" Title="Copy&#32;Tools" Top="8" Ver="1.0" Width="472" WorkArea="true">
		<Static Border="None" Color="user7" Font="굴림,9" Height="15" Id="Static16" Left="11" TabOrder="1" Text="붙여넣기&#32;할&#32;번호를&#32;입력하세요." Top="187" VAlign="Middle" Width="322"></Static>
		<Static Border="None" Color="user7" Font="굴림,9" Height="13" Id="Static1" Left="13" TabOrder="2" Text="(예)&#32;2,&#32;4&#32;또는&#32;2-10" Top="204" VAlign="Middle" Width="322"></Static>
		<Div Height="36" Id="div_btn" TabOrder="3" Url="WB01::CommBtnForm.xml" Width="472">
			<Contents></Contents>
		</Div>
		<Shape BKColor="user12" Bottom="99" Height="26" Id="Shape2" Left="8" LineColor="user13" Right="154" TabOrder="4" Top="73" Type="Rectangle" Width="146"></Shape>
		<Static Align="Right" Height="24" Id="Static2" Left="9" Style="sty_lb_form_basic" TabOrder="5" Text="세로열&#32;복사&#32;" Top="74" VAlign="Middle" Width="111"></Static>
		<Shape BKColor="user12" Bottom="99" Height="26" Id="Shape3" Left="152" LineColor="user13" Right="226" TabOrder="6" Top="73" Type="Rectangle" Width="74"></Shape>
		<Static Align="Center" Height="24" Id="Static3" Left="121" Style="sty_lb_form_basic" TabOrder="7" Text="복사할&#32;번호&#32;" Top="74" VAlign="Middle" Width="72"></Static>
		<Shape BKColor="user12" Bottom="99" Height="26" Id="Shape4" Left="225" LineColor="user13" Right="459" TabOrder="8" Top="73" Type="Rectangle" Width="234"></Shape>
		<Static Align="Center" Height="24" Id="Static5" Left="194" Style="sty_lb_form_basic" TabOrder="9" Text="붙여넣기&#32;할&#32;번호&#32;" Top="74" VAlign="Middle" Width="264"></Static>
		<Static Color="user34" Font="굴림,9" Height="15" Id="Static12" Left="10" TabOrder="10" Text="(※)&#32;[복사할&#32;번호]에&#32;입력한&#32;ROW의&#32;검사요청일,&#32;검사접수일,&#32;검사예정일을&#32;" Top="44" Width="452"></Static>
		<Static Color="user34" Font="굴림,9" Height="15" Id="Static15" Left="10" TabOrder="11" Text="&#32;&#32;&#32;&#32;&#32;&#32;&#32;[붙여넣기&#32;할&#32;번호]에&#32;입력한&#32;각&#32;ROW에&#32;복사" Top="59" Width="452"></Static>
		<Div BKColor="user5" Height="75" Id="Div0" Left="8" TabOrder="11" Text="Div0" Top="99" Visible="FALSE" Width="451">
			<Contents>
				<Shape BKColor="user12" Bottom="25" Height="26" Id="Shape1" Left="0" LineColor="user13" Right="451" TabOrder="1" Top="-1" Type="Rectangle" Width="451"></Shape>
				<Shape BKColor="user12" Bottom="50" Height="26" Id="Shape0" Left="0" LineColor="user13" Right="451" TabOrder="2" Top="24" Type="Rectangle" Width="451"></Shape>
				<Shape BKColor="user12" Bottom="75" Height="26" Id="Shape5" Left="0" LineColor="user13" Right="451" TabOrder="3" Top="49" Type="Rectangle" Width="451"></Shape>
				<Static Align="Right" Height="24" Id="Static4" Left="1" Style="sty_lb_form_basic" TabOrder="4" Text="전체적용(1-2)&#32;&#32;" VAlign="Middle" Width="111"></Static>
				<Static Align="Right" Height="24" Id="Static0" Left="1" Style="sty_lb_form_basic" TabOrder="5" Text="1.&#32;검사요청일&#32;" Top="25" VAlign="Middle" Width="111"></Static>
				<Static Align="Right" Height="24" Id="Static6" Left="1" Style="sty_lb_form_basic" TabOrder="6" Text="2.&#32;검사접수일&#32;" Top="50" VAlign="Middle" Width="111"></Static>
				<Edit Border="Flat" Height="20" Id="ed_f2" Left="114" LeftMargin="4" Number="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="11" Top="52" Width="70"></Edit>
				<Edit Border="Flat" Height="20" Id="ed_f1" Left="114" LeftMargin="4" Number="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="9" Top="27" Width="70"></Edit>
				<Edit Border="Flat" Height="20" Id="ed_fall" Left="114" LeftMargin="4" Number="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="7" Top="2" Width="70"></Edit>
				<Edit Border="Flat" Height="20" Id="ed_tall" Left="186" LeftMargin="4" OnCharChanged="ed_tall_OnCharChanged" OnKillFocus="ed_tall_OnKillFocus" RightMargin="4" Style="sty_ipt_form" TabOrder="8" Top="2" Width="262"></Edit>
				<Edit Border="Flat" Height="20" Id="ed_t1" Left="186" LeftMargin="4" OnCharChanged="ed_tall_OnCharChanged" OnKillFocus="ed_tall_OnKillFocus" RightMargin="4" Style="sty_ipt_form" TabOrder="10" Top="27" Width="262"></Edit>
				<Edit Border="Flat" Height="20" Id="ed_t2" Left="186" LeftMargin="4" OnCharChanged="ed_tall_OnCharChanged" OnKillFocus="ed_tall_OnKillFocus" RightMargin="4" Style="sty_ipt_form" TabOrder="12" Top="52" Width="262"></Edit>
			</Contents>
		</Div>
		<Div BKColor="user5" Height="25" Id="Div1" Left="8" TabOrder="13" Text="Div1" Top="99" Width="451">
			<Contents>
				<Shape BKColor="user12" Bottom="25" Height="26" Id="Shape6" Left="0" LineColor="user13" Right="451" TabOrder="1" Top="-1" Type="Rectangle" Width="451"></Shape>
				<Static Align="Right" Height="24" Id="Static7" Left="1" Style="sty_lb_form_basic" TabOrder="2" Text="1.&#32;검사예정일&#32;" VAlign="Middle" Width="111"></Static>
				<Edit Border="Flat" Height="20" Id="ed_f3" Left="114" LeftMargin="4" Number="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="3" Top="2" Width="70"></Edit>
				<Edit Border="Flat" Height="20" Id="ed_t3" Left="186" LeftMargin="4" OnCharChanged="ed_tall_OnCharChanged" OnKillFocus="ed_tall_OnKillFocus" RightMargin="4" Style="sty_ipt_form" TabOrder="3" Top="2" Width="262"></Edit>
			</Contents>
		</Div>
	</Form>
	<Script><![CDATA[/*
 ******************************************************************************************
 * 기      능   : copy tool
				  이전 화면에서 pgmId , arrCols 정보를 받아 해당 그리드의 특정 로우의 특정 컬럼을 복사한다.
				  ex) pgmId - "grdList" , arrCols - "COL1=COL1,COL2=COL2"
 * 작  성  자   :
 * 작성  일자   :
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
#include "LIB::commons.js";	// 공통 스크립트
#include "LIB::utility.js";	// 다중 선택
//=========================================================================================
// [ PART 1 ]
// Form에서 사용될 전역변수를 선언
// FORM에서 사용되는 전역변수는 대문자로 작성하며, F_XXX 의 형태를 갖도록 한다.
//=========================================================================================
var targetId = "";
var userGroup = "";
//=========================================================================================
// [ PART 2 ]
// Form Loading / Unloading 시 작업 정의
//=========================================================================================
function OnLoadCompleted(obj)
{
	// Form 로드 이벤트 맨 첫줄에 기술
	gfn_initForm();
	userGroup = gfn_getUserGroup();
	Div0.ed_fall.SetFocus();
	targetId = object(pgmId);
	if(targetId == 'PS0701001A')
	{
		Div0.Visible = true;
		Div1.Visible = false;
	}
	else
	{
		Div0.Visible = false;
		Div1.Visible = true;
	}	
}
/********************************************************************************
* 기      능   : 닫기
********************************************************************************/
function fn_close(){
	close();
}
/********************************************************************************
* 기      능   : 복사 75
********************************************************************************/
function fn_copy(obj)
{
	var frRow = "";
	var toRow = "";
	var arrCols;

	if( length(Div0.ed_fall.value) > 0 && length(Div0.ed_tall.value) > 0 ) {
		frRow = trim(Div0.ed_fall.Text);
		toRow = trim(Div0.ed_tall.Text);
		arrCols = "123";
		fn_copyAll(frRow,toRow,arrCols,"row");
	}
	if( length(Div0.ed_f1.value) > 0 && length(Div0.ed_t1.value) > 0 ) {
		frRow = trim(Div0.ed_f1.Text);
		toRow = trim(Div0.ed_t1.Text);
		arrCols = "1";
		fn_copyAll(frRow,toRow,arrCols,"row");
	}
	if( length(Div0.ed_f2.value) > 0 && length(Div0.ed_t2.value) > 0 ) {
		frRow = trim(Div0.ed_f2.Text);
		toRow = trim(Div0.ed_t2.Text);
		arrCols = "2";
		fn_copyAll(frRow,toRow,arrCols,"row");
	}
	if( length(Div1.ed_f3.value) > 0 && length(Div1.ed_t3.value) > 0 ) {
		frRow = trim(Div1.ed_f3.Text);
		toRow = trim(Div1.ed_t3.Text);
		arrCols = "3";
		fn_copyAll(frRow,toRow,arrCols,"row");
	}
}

/********************************************************************************
* 기      능   : 전체복사
********************************************************************************/
function fn_copyAll(frRow,toRow,arrCols,gbn){
	var toRows;
	var	arrTo = split(toRow, ',');
	for(var i=0; i<length(arrTo); i++){
		toRows = trim(arrTo[i]);
		if(toRows=='') continue;
		if(isDigit(toRows)){
			if(frRow == toRows){
				// alert("복사 할 번호와 붙여넣기 할 번호는 달라야 합니다.");
				gfn_showMsg('CW00129');
				return;
			}
			fn_copyRow(targetId, toNumber(frRow)-1, toNumber(toRows)-1, '0',arrCols);
		} else {
			if(IndexOf(toRows, "-")!=-1){
				var toList = split(toRows, '-');

				if(length(toList)<2){
					if(!isDigit(toRows)){
						// alert("[ , ], [ - ] 제외한 특수문자가 있거나 문장형식이 올바르지 않습니다.");
						gfn_showMsg('CW00130');
						return;
					}
				}
				if(length(toList)>2) {
					// alert("[ - ] 또는 [ , ] 는 연속해서 사용할 수 없습니다.");
					gfn_showMsg('CW00131');
					return;
				}

				var tomin = toList[0];
				var tomax = toList[1];
				if(!isDigit(tomin) || !isDigit(tomax)){
					// alert("[ , ], [ - ] 제외한 특수문자가 있거나 문장형식이 올바르지 않습니다.");
					gfn_showMsg('CW00130');
					return;
				}
				if(toNumber(tomin) > toNumber(tomax)){
					// alert("시작줄은 완료줄보다 작아야 합니다.");
					gfn_showMsg('CW00128');
					return;
				}
//				if(frRow==tomin || frRow==tomax){
					// alert("복사 할 번호와 붙여넣기 할 번호는 달라야 합니다.");
//					gfn_showMsg('CW00129');
//					return;
//				}
				fn_copyRow(targetId, toNumber(frRow)-1, toNumber(tomin)-1, toNumber(tomax)-1,arrCols);
			} else {
				// alert("[ , ], [ - ] 제외한 특수문자가 있거나 문장형식이 올바르지 않습니다.");
				gfn_showMsg('CW00130');
				return;
			}
		}
	}
}
/********************************************************************************
* 기      능   : prarm(해당그리드,
                       Source Dataset의 복사 할 Record Index,
                       Target Dataset의 복사되어 변경 될 첫번째 Row Index,
                       Target Dataset의 복사되어 변경 될 마지막 Row Index,
                       복사할 칼럼
********************************************************************************/
function fn_copyRow(gridObj, frRow, toRow0, toRow1,cols){
	var dsObj = object(gridObj.bindDataset);
	gridObj.Redraw = false;
	if(pgmId == 'PS0701001A') //완성검사접수에서 호출
	{
		if(toRow1=='0'){
			if( IndexOf(cols, "1") != -1 ) ds_list.SetColumn(toRow0,"DATE4",ds_list.GetColumn(frRow,"DATE4"));
			if( IndexOf(cols, "2") != -1 ) ds_list.SetColumn(toRow0,"DATE1",ds_list.GetColumn(frRow,"DATE1"));
		}
		else
		{
			for(var i=toRow0; i<=toRow1; i++){
				if( IndexOf(cols, "1") != -1 ) ds_list.SetColumn(i,"DATE4",ds_list.GetColumn(frRow,"DATE4"));
				if( IndexOf(cols, "2") != -1 ) ds_list.SetColumn(i,"DATE1",ds_list.GetColumn(frRow,"DATE1"));
				if( IndexOf(cols, "3") != -1 ) ds_list.SetColumn(i,"DATE2",ds_list.GetColumn(frRow,"DATE2"));
			}
		}
	}
	if(pgmId == 'PS0701002A') //완성검사접수현황에서 호출
	{
		
		if(toRow1=='0'){
			if( IndexOf(cols, "3") != -1 ) ds_list.SetColumn(toRow0,"DATE2",ds_list.GetColumn(frRow,"DATE2"));
		}
		else
		{
			for(var i=toRow0; i<=toRow1; i++){
				if( IndexOf(cols, "3") != -1 ) ds_list.SetColumn(i,"DATE2",ds_list.GetColumn(frRow,"DATE2"));
			}
		}		
	}
	gfn_showMsg("CI00005");
	gridObj.Redraw = true;
}

/********************************************************************************
* 기      능   : 붙여넣기할 칼럼에 숫자,',','-' 이외의 문자는 입력불가
********************************************************************************/
function ed_tall_OnCharChanged(obj,strPreText,strPostText)
{
	var nChar = right(strPostText,1);
	if(nChar != '0' && nChar != '1' && nChar != '2' && nChar != '3' && nChar != '4' && nChar != '5' &&
	   nChar != '6' && nChar != '7' && nChar != '8' && nChar != '9' && nChar !=',' && nChar != '-'   && nChar != ''  ) {
		gfn_showMsg('CW00130');
		obj.value = strPreText;
		return;
	}
}
/********************************************************************************
* 기      능   : 붙여넣기할 칼럼에 포커스이동시 마지막 문자열이 ',','-' 인 경우 삭제
********************************************************************************/
function ed_tall_OnKillFocus(obj)
{
	var nChar = right(obj.value,1);
	if(nChar == ',' || nChar == '-') {
		obj.value = left(obj.value,length(obj.value)-1);
		return;
	}
}
]]></Script>
</Window>