<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="562" Id="CS0603001A" Left="8" OnLoadCompleted="fn_OnLoadCompleted" OnUnloadCompleted="fn_OnUnloadCompleted" PidAttrib="7" Title="신규인수&#32;관리" Top="8" Ver="1.0" Width="978" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_cond">
				<Contents>
					<colinfo id="CS101_FDT_F" size="255" summ="default" type="STRING"/>
					<colinfo id="CS101_FDT_T" size="255" summ="default" type="STRING"/>
					<colinfo id="POSID" size="255" summ="default" type="STRING"/>
					<colinfo id="GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="BSU" size="256" summ="default" type="STRING"/>
					<colinfo id="BPM" size="256" summ="default" type="STRING"/>
					<colinfo id="ARA" size="256" summ="default" type="STRING"/>
					<colinfo id="PBN" size="256" summ="default" type="STRING"/>
					<colinfo id="TEM" size="256" summ="default" type="STRING"/>
					<colinfo id="DPT" size="256" summ="default" type="STRING"/>
					<record>
						<ARA></ARA>
						<BPM></BPM>
						<BSU></BSU>
						<CS101_FDT_F></CS101_FDT_F>
						<CS101_FDT_T></CS101_FDT_T>
						<DPT></DPT>
						<GBN></GBN>
						<PBN></PBN>
						<POSID></POSID>
						<TEM></TEM>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list" OnColumnChanged="ds_list_OnColumnChanged">
				<Contents>
					<colinfo id="CS101_PJT" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="CS101_FDT" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSITE_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="KUNNR_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="NAME1" size="256" summ="default" type="STRING"/>
					<colinfo id="CS101_HNO" size="256" summ="default" type="STRING"/>
					<colinfo id="FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="ARA" size="256" summ="default" type="STRING"/>
					<colinfo id="TEM" size="256" summ="default" type="STRING"/>
					<colinfo id="PLAT" size="256" summ="default" type="STRING"/>
					<colinfo id="ADDR" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSITE_TEL" size="256" summ="default" type="STRING"/>
					<colinfo id="CS101_BSU" size="256" summ="default" type="STRING"/>
					<colinfo id="MON" size="256" summ="default" type="STRING"/>
					<colinfo id="SID" size="256" summ="default" type="STRING"/>
					<colinfo id="PBN" size="256" summ="default" type="STRING"/>
					<colinfo id="CONTR_DA" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond2">
				<Contents>
					<colinfo id="POSID" size="255" summ="default" type="STRING"/>
					<colinfo id="GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="BSU" size="256" summ="default" type="STRING"/>
					<colinfo id="FDT" size="256" summ="default" type="STRING"/>
					<colinfo id="PBN" size="256" summ="default" type="STRING"/>
					<colinfo id="BPM" size="256" summ="default" type="STRING"/>
					<colinfo id="ARA" size="256" summ="default" type="STRING"/>
					<colinfo id="TEM" size="256" summ="default" type="STRING"/>
					<record>
						<ARA></ARA>
						<BPM></BPM>
						<BSU></BSU>
						<FDT></FDT>
						<GBN></GBN>
						<PBN></PBN>
						<POSID></POSID>
						<TEM></TEM>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_juj_cd">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
					<colinfo id="BSU" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_buj_cd">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
					<colinfo id="BSU" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list3">
				<Contents>
					<colinfo id="CSA_PJT" size="256" type="STRING"/>
					<colinfo id="CSA_HNO" size="256" type="STRING"/>
					<colinfo id="CSA_CSQ" size="256" type="STRING"/>
					<colinfo id="CSA_CTG" size="256" type="STRING"/>
					<colinfo id="CSA_CNM" size="256" type="STRING"/>
					<colinfo id="CSA_TEL" size="256" type="STRING"/>
					<colinfo id="CSA_TEX" size="256" type="STRING"/>
					<colinfo id="CSA_CPN" size="256" type="STRING"/>
					<colinfo id="CSA_HTL" size="256" type="STRING"/>
					<colinfo id="CSA_HEX" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cus_cd">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list4">
				<Contents>
					<colinfo id="CS101_HNO" size="256" type="STRING"/>
					<colinfo id="CS101_PJT" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list5">
				<Contents>
					<colinfo id="CSA_PJT" size="256" type="STRING"/>
					<colinfo id="CSA_HNO" size="256" type="STRING"/>
					<colinfo id="CSA_CSQ" size="256" type="STRING"/>
					<colinfo id="CSA_CTG" size="256" type="STRING"/>
					<colinfo id="CSA_CNM" size="256" type="STRING"/>
					<colinfo id="CSA_TEL" size="256" type="STRING"/>
					<colinfo id="CSA_TEX" size="256" type="STRING"/>
					<colinfo id="CSA_CPN" size="256" type="STRING"/>
					<colinfo id="CSA_HTL" size="256" type="STRING"/>
					<colinfo id="CSA_HEX" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list2" OnColumnChanged="ds_list2_OnColumnChanged">
				<Contents>
					<colinfo id="BUJ" size="30" summ="default" type="STRING"/>
					<colinfo id="CH_FLG" size="0" summ="default" type="STRING"/>
					<colinfo id="CS101_ABG" size="60" summ="default" type="STRING"/>
					<colinfo id="CS101_AGB" size="60" summ="default" type="STRING"/>
					<colinfo id="CS101_BYD" size="24" summ="default" type="STRING"/>
					<colinfo id="CS101_FDT" size="24" summ="default" type="STRING"/>
					<colinfo id="CS101_FYN" size="3" summ="default" type="STRING"/>
					<colinfo id="CS101_HNA" size="90" summ="default" type="STRING"/>
					<colinfo id="CS101_HNO" size="9" summ="default" type="STRING"/>
					<colinfo id="CS101_IJY" size="24" summ="default" type="STRING"/>
					<colinfo id="CS101_PJT" size="18" summ="default" type="STRING"/>
					<colinfo id="CS101_VSD" size="24" summ="default" type="STRING"/>
					<colinfo id="DATE1" size="1" summ="default" type="STRING"/>
					<colinfo id="FLAG" size="0" summ="default" type="STRING"/>
					<colinfo id="IJD" size="24" summ="default" type="STRING"/>
					<colinfo id="JUJ" size="30" summ="default" type="STRING"/>
					<colinfo id="LIFNR" size="1" summ="default" type="STRING"/>
					<colinfo id="NAME1" size="256" summ="default" type="STRING"/>
					<colinfo id="NAMET" size="60" summ="default" type="STRING"/>
					<colinfo id="CELLPT" size="256" summ="default" type="STRING"/>
					<colinfo id="TELF1" size="256" summ="default" type="STRING"/>
					<colinfo id="TELFX" size="256" summ="default" type="STRING"/>
					<colinfo id="NAMET2" size="256" summ="default" type="STRING"/>
					<colinfo id="CELLPT2" size="256" summ="default" type="STRING"/>
					<colinfo id="ORG" size="1" summ="default" type="STRING"/>
					<colinfo id="ORG_BUJ" size="0" summ="default" type="STRING"/>
					<colinfo id="ORG_JUJ" size="0" summ="default" type="STRING"/>
					<colinfo id="PAPRID" size="30" summ="default" type="STRING"/>
					<colinfo id="TEMNO" size="18" summ="default" type="STRING"/>
					<colinfo id="ZMUSAOCNT" size="6" summ="default" type="STRING"/>
					<colinfo id="ZMUSAOCNT2" size="6" summ="default" type="STRING"/>
					<colinfo id="ZMUSAOCNT3" size="11" summ="default" type="INT"/>
					<colinfo id="ZQEGEMSA" size="24" summ="default" type="STRING"/>
					<colinfo id="ZSPEC1" size="15" summ="default" type="STRING"/>
					<colinfo id="ZSPEC2" size="75" summ="default" type="STRING"/>
					<colinfo id="ZSPEC9" size="9" summ="default" type="STRING"/>
					<colinfo id="POSID_OLD" size="256" summ="default" type="STRING"/>
					<colinfo id="DSCODE" size="256" summ="default" type="STRING"/>
					<colinfo id="FNM1" size="256" summ="default" type="STRING"/>
					<colinfo id="FNM2" size="256" summ="default" type="STRING"/>
					<colinfo id="FNM3" size="256" summ="default" type="STRING"/>
					<colinfo id="FNM4" size="256" summ="default" type="STRING"/>
					<colinfo id="FNM1_APP" size="256" summ="default" type="STRING"/>
					<colinfo id="FNM2_APP" size="256" summ="default" type="STRING"/>
					<colinfo id="FNM3_APP" size="256" summ="default" type="STRING"/>
					<colinfo id="FNM4_APP" size="256" summ="default" type="STRING"/>
					<colinfo id="SID" size="256" summ="default" type="STRING"/>
					<colinfo id="STN" size="256" summ="default" type="STRING"/>
					<colinfo id="FDT" size="256" summ="default" type="STRING"/>
					<colinfo id="TDT" size="256" summ="default" type="STRING"/>
					<colinfo id="GAO" size="256" summ="default" type="STRING"/>
					<colinfo id="PUB" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK_HNOINFO" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK_CSTINFO" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond_copy">
				<Contents>
					<colinfo id="CS101_FDT_F" size="255" type="STRING"/>
					<colinfo id="CS101_FDT_T" size="255" type="STRING"/>
					<colinfo id="POSID" size="255" type="STRING"/>
					<colinfo id="GBN" size="256" type="STRING"/>
					<colinfo id="BSU" size="256" type="STRING"/>
					<colinfo id="BPM" size="256" type="STRING"/>
					<colinfo id="ARA" size="256" type="STRING"/>
					<record>
						<ARA></ARA>
						<BPM></BPM>
						<BSU></BSU>
						<CS101_FDT_F></CS101_FDT_F>
						<CS101_FDT_T></CS101_FDT_T>
						<GBN></GBN>
						<POSID></POSID>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond1">
				<Contents>
					<colinfo id="PSPID" size="255" type="STRING"/>
					<colinfo id="USERID" size="256" type="STRING"/>
					<record>
						<PSPID></PSPID>
						<USERID></USERID>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list1">
				<Contents>
					<colinfo id="TEXT" size="255" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list6" OnColumnChanged="ds_list_OnColumnChanged">
				<Contents>
					<colinfo id="CS101_PJT" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="CS101_FDT" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSITE_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="KUNNR_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="NAME1" size="256" summ="default" type="STRING"/>
					<colinfo id="CS101_HNO" size="256" summ="default" type="STRING"/>
					<colinfo id="CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="ARA" size="256" summ="default" type="STRING"/>
					<colinfo id="PLAT" size="256" summ="default" type="STRING"/>
					<colinfo id="ADDR" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSITE_TEL" size="256" summ="default" type="STRING"/>
					<colinfo id="CS101_BSU" size="256" summ="default" type="STRING"/>
					<colinfo id="TEMNO" size="256" summ="default" type="STRING"/>
					<colinfo id="NAMET" size="256" summ="default" type="STRING"/>
					<colinfo id="CELLPT" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="TELF1" size="256" summ="default" type="STRING"/>
					<colinfo id="TELFX" size="256" summ="default" type="STRING"/>
					<colinfo id="NAMET2" size="256" summ="default" type="STRING"/>
					<colinfo id="CELLPT2" size="256" summ="default" type="STRING"/>
					<colinfo id="ZMAN_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="ZTEL" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond6">
				<Contents>
					<colinfo id="POSID" size="255" summ="default" type="STRING"/>
					<colinfo id="CS101_BSU" size="256" summ="default" type="STRING"/>
					<colinfo id="CS101_FDT" size="256" summ="default" type="STRING"/>
					<record>
						<CS101_BSU></CS101_BSU>
						<CS101_FDT></CS101_FDT>
						<POSID></POSID>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cnt">
				<Contents>
					<colinfo id="CNT" size="255" type="STRING"/>
					<record>
						<CNT></CNT>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_pbn">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME>-&#32;전체&#32;-</CODE_NAME>
					</record>
					<record>
						<CODE>A</CODE>
						<CODE_NAME>승강기</CODE_NAME>
					</record>
					<record>
						<CODE>B</CODE>
						<CODE_NAME>주차</CODE_NAME>
					</record>
					<record>
						<CODE>C</CODE>
						<CODE_NAME>PSD</CODE_NAME>
					</record>
					<record>
						<CODE>D</CODE>
						<CODE_NAME>물류</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_report">
				<Contents>
					<colinfo id="NAM" size="256" type="STRING"/>
					<colinfo id="PJT" size="256" type="STRING"/>
					<colinfo id="CNT" size="256" type="STRING"/>
					<colinfo id="BSU" size="256" type="STRING"/>
					<colinfo id="DAT" size="256" type="STRING"/>
					<colinfo id="ADR" size="256" type="STRING"/>
					<record>
						<ADR></ADR>
						<BSU></BSU>
						<CNT></CNT>
						<DAT></DAT>
						<NAM></NAM>
						<PJT></PJT>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_days">
				<Contents>
					<colinfo id="DAYS" size="256" type="STRING"/>
					<record>
						<DAYS></DAYS>
					</record>
				</Contents>
			</Dataset>
		</Datasets>
		<Shape BKColor="user0" Bottom="52" Height="52" Id="Shape0" Left="0" LineColor="user1" Right="978" TabOrder="1" Top="0" Type="Rectangle" Width="978"></Shape>
		<Button Cursor="HAND" Height="18" Id="Button0" ImageID="btn_icon_search" Left="447" OnClick="btn_pjt_OnClick" TabOrder="8" Text="Button0" Top="6" Width="18"></Button>
		<Edit BindDataset="ds_cond" Border="Flat" Column="POSID" Height="20" Id="ed_pjt" Left="388" MaxLength="6" Style="sty_ipt_search" TabOrder="7" Top="5" UpperOnly="TRUE" Width="57"></Edit>
		<Static Align="Right" Height="20" Id="Static2" Left="306" Style="sty_lb_search" TabOrder="3" Text="Proj&#32;No&#32;" Top="5" VAlign="Middle" Width="80"></Static>
		<Calendar BindDataset="ds_cond" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="CS101_FDT_T" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_cs101_fdt_t" Left="207" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_search" SundayTextColor="user35" TabOrder="6" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="5" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="97"></Calendar>
		<Static Align="Center" Border="None" Color="user7" Font="굴림,9" Height="20" Id="Static13" Left="187" TabOrder="4" Text="~" Top="5" VAlign="Middle" Width="18"></Static>
		<Calendar BindDataset="ds_cond" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="CS101_FDT_F" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_cs101_fdt_f" Left="87" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_search" SundayTextColor="user35" TabOrder="5" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="5" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="97"></Calendar>
		<Static Align="Right" Height="20" Id="st_cs101_fdt" Left="5" Style="sty_lb_search" TabOrder="2" Text="인수일&#32;" Top="5" VAlign="Middle" Width="80"></Static>
		<Static Height="16" Id="st_cs101_byd" Left="64" TabOrder="9" Text="처리예정일" Top="576" Visible="FALSE" Width="66"></Static>
		<Static Height="15" Id="st_cs101_ijy" Left="136" TabOrder="10" Text="입주예정일" Top="576" Visible="FALSE" Width="80"></Static>
		<Static Height="13" Id="st_juj" Left="252" TabOrder="11" Text="주점검자" Top="587" Visible="FALSE" Width="40"></Static>
		<Static Height="13" Id="st_buj" Left="324" TabOrder="12" Text="부점검자" Top="587" Visible="FALSE" Width="40"></Static>
		<Static Align="Right" Height="20" Id="st_bsu" Left="467" Style="sty_lb_search" TabOrder="13" Text="협력사&#32;" Top="5" VAlign="Middle" Width="80"></Static>
		<Div BKColor="user0" Height="20" Id="div_code" Left="549" OnLoadCompleted="fn_OnLoadCompleted" OnTimer="WB0199010A_OnTimer" TabOrder="14" Text="Div0" Top="5" Url="WB01::WB0199010A.xml" Width="415">
			<Contents></Contents>
		</Div>
		<Tab Border="Flat" Font="굴림,9" Height="496" Id="Tab00" Left="8" MouseOverColor="user16" OnChanged="Tab00_OnChanged" SelColor="user15" SelectFont="굴림,9" Style="sty_tab" TabOrder="15" Top="56" Width="958">
			<Contents>
				<TabPage BorderColor="black" Height="470" Id="tab1" ImageID="tab_form_06" Left="2" TabOrder="19" Text="신규인수관리" Top="24" Width="954">
					<Grid AutoEnter="TRUE" AutoFitEndLine="Hide" BindDataset="ds_list" BkColor2="default" BoldHead="true" Border="Flat" Bottom="470" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="462" Id="grd_list" InputPanel="FALSE" Left="6" LineColor="user20" LineType="ExHORZ" OnCellDBLClick="Tab00_tab1_grd_list_OnCellDblClick" OnKeyDown="grd_list_OnKeyDown" Right="954" RowHeight="20" Style="sty_grid" TabOrder="1" TabStop="true" Top="8" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="948">
						<contents>
							<format id="Default">
								<columns>
									<col width="20"/>
									<col width="40"/>
									<col width="70"/>
									<col width="70"/>
									<col width="50"/>
									<col width="50"/>
									<col width="200"/>
									<col width="70"/>
									<col width="80"/>
									<col width="50"/>
									<col width="150"/>
									<col width="150"/>
									<col width="0"/>
									<col width="60"/>
									<col width="60"/>
									<col width="180"/>
									<col width="90"/>
								</columns>
								<head>
									<cell align="center" col="0" color="user21" display="text" font="굴림,9"/>
									<cell align="center" col="1" color="user21" display="text" font="굴림,9" text="No"/>
									<cell align="center" col="2" color="user21" display="text" font="굴림,9" text="영업계약일"/>
									<cell align="center" col="3" color="user21" display="text" font="굴림,9" text="인수일"/>
									<cell align="center" col="4" color="user21" display="text" font="굴림,9" text="개월수"/>
									<cell align="center" col="5" color="user21" display="text" font="굴림,9" text="원PJT"/>
									<cell align="center" col="6" color="user21" display="text" font="굴림,9" text="현장명"/>
									<cell align="center" col="7" color="user21" display="text" font="굴림,9" text="인수증"/>
									<cell align="center" col="8" color="user21" display="text" font="굴림,9" text="하도급승인서"/>
									<cell align="center" col="9" color="user21" display="text" font="굴림,9" text="지역"/>
									<cell align="center" col="10" color="user21" display="text" font="굴림,9" text="팀"/>
									<cell align="center" col="11" color="user21" display="text" font="굴림,9" text="보수협력사"/>
									<cell align="center" col="12" color="user21" display="text" font="굴림,9" text="고객명"/>
									<cell align="center" col="13" color="user21" display="text" font="굴림,9" text="대수"/>
									<cell align="center" col="14" color="user21" display="text" font="굴림,9" text="PLAT"/>
									<cell align="center" col="15" color="user21" display="text" font="굴림,9" text="현장주소"/>
									<cell align="center" col="16" color="user21" display="text" font="굴림,9" text="현장전화번호"/>
								</head>
								<body>
									<cell align="center" bkimageid='expr:gfn_getFlagBkImageID(getColumn(currow,&#32;&quot;FLAG&quot;))' col="0" colid="FLAG" display="text"/>
									<cell align="center" bkcolor2="user22" col="1" display="text" expr="currow+1"/>
									<cell align="center" bkcolor2="user22" col="2" colid="CONTR_DA" display="text" Mask="####.##.##"/>
									<cell align="center" bkcolor2="user22" col="3" colid="CS101_FDT" display="text" Mask="####.##.##"/>
									<cell align="right" bkcolor2="user22" col="4" colid="MON" display="text"/>
									<cell align="center" bkcolor2="user22" col="5" colid="CS101_PJT" display="text"/>
									<cell bkcolor2="user22" col="6" colid="ZSITE_NM" display="text"/>
									<cell align="center" bkcolor2="user22" bkimagealign="stretch" bkimageid="btn_grid_01" col="7" cursor="hand" display="button" text="인수증출력"/>
									<cell align="center" bkcolor2="user22" bkimagealign="stretch" bkimageid="btn_grid_01" col="8" cursor="hand" display="button" text="승인서출력"/>
									<cell align="center" bkcolor2="user22" col="9" colid="ARA" display="text"/>
									<cell bkcolor2="user22" col="10" colid="TEM" display="text"/>
									<cell bkcolor2="user22" col="11" colid="NAME1" display="text"/>
									<cell bkcolor2="user22" bkimagealign="right" bkimageid="icon_grid_edit" checklength="Byte" col="12" colid="KUNNR_NM" display="text" edit="normal" limit="35"/>
									<cell align="center" bkcolor2="user22" col="13" colid="CS101_HNO" display="text"/>
									<cell align="center" bkcolor2="user22" col="14" colid="PLAT" display="text"/>
									<cell bkcolor2="user22" col="15" colid="ADDR" display="text"/>
									<cell bkcolor2="user22" col="16" colid="ZSITE_TEL" display="text"/>
								</body>
								<summary>
									<cell align="center" col="0" color="user26" colspan="4" display="text" font="굴림,9" text="합&#32;계"/>
									<cell align="right" bkcolor="user25" col="4" color="user26" display="text"/>
									<cell align="right" bkcolor="user25" col="5" color="user26" display="text"/>
									<cell align="right" bkcolor="user25" col="6" color="user26" display="text"/>
									<cell align="right" bkcolor="user25" col="7" color="user26" display="text"/>
									<cell align="right" bkcolor="user25" col="8" color="user26" display="text"/>
									<cell align="right" bkcolor="user25" col="9" color="user26" display="text"/>
									<cell align="right" bkcolor="user25" col="10" color="user26" display="text"/>
									<cell align="right" bkcolor="user25" col="11" color="user26" display="text"/>
									<cell align="right" bkcolor="user25" col="12" color="user26" display="text"/>
									<cell align="right" bkcolor="user25" col="13" color="user26" display="number" expr='sum(&quot;CS101_HNO&quot;)'/>
									<cell align="right" bkcolor="user25" col="14" color="user26" display="number" expr='sum(&quot;PLAT&quot;)'/>
									<cell align="right" bkcolor="user25" col="15" color="user26" display="text"/>
									<cell align="right" bkcolor="user25" col="16" color="user26" display="text"/>
								</summary>
							</format>
						</contents>
					</Grid>
				</TabPage>
				<TabPage BorderColor="black" Height="470" Id="tab2" ImageID="tab_form_06" Left="2" TabOrder="26" Text="신규인수상세" Top="24" Width="954">
					<Grid AutoEnter="TRUE" AutoFitEndLine="Hide" BindDataset="ds_list2" BkColor2="default" BoldHead="true" Border="Flat" Bottom="466" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="462" Id="grd_list2" InputPanel="FALSE" Left="4" LineColor="user20" LineType="ExHORZ" OnCellClick="Tab00_tab2_grd_list2_OnCellClick" OnCellDBLClick="Tab00_tab2_grd_list2_OnCellDblClick" OnExpandEdit="grd_list2_OnExpandEdit" Right="952" RowHeight="20" Style="sty_grid" TabOrder="1" TabStop="true" Top="4" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="948">
						<contents>
							<format id="Default">
								<columns>
									<col fix="left" width="20"/>
									<col fix="left" width="40"/>
									<col fix="left" width="70"/>
									<col fix="left" width="40"/>
									<col fix="left" width="100"/>
									<col width="100"/>
									<col width="70"/>
									<col width="120"/>
									<col width="120"/>
									<col width="75"/>
									<col width="80"/>
									<col width="80"/>
									<col width="80"/>
									<col width="80"/>
									<col width="80"/>
									<col width="80"/>
									<col width="70"/>
									<col width="60"/>
									<col width="50"/>
									<col width="70"/>
									<col width="70"/>
									<col width="80"/>
									<col width="80"/>
									<col width="80"/>
									<col width="50"/>
									<col width="110"/>
									<col width="100"/>
									<col width="100"/>
									<col width="100"/>
									<col width="120"/>
									<col width="60"/>
									<col width="120"/>
									<col width="60"/>
									<col width="100"/>
									<col width="70"/>
									<col width="70"/>
									<col width="70"/>
									<col width="60"/>
								</columns>
								<head>
									<cell align="center" col="0" color="user21" display="text" font="굴림,9"/>
									<cell align="center" col="1" color="user21" display="text" font="굴림,9" text="No"/>
									<cell align="center" col="2" color="user21" display="text" font="굴림,9" text="인수일"/>
									<cell align="center" col="3" color="user21" display="text" font="굴림,9" text="호기"/>
									<cell align="center" col="4" color="user21" display="text" font="굴림,9" text="호기명"/>
									<cell align="center" col="5" color="user21" display="text" font="굴림,9" text="승강기번호(ID)"/>
									<cell align="center" col="6" color="user21" display="text" font="굴림,9" text="좌표입력"/>
									<cell align="center" col="7" color="user21" display="text" font="굴림,9" text="기종"/>
									<cell align="center" col="8" color="user21" display="text" font="굴림,9" text="사양"/>
									<cell align="center" col="9" color="user21" display="text" font="굴림,9" text="검사상태"/>
									<cell align="center" col="10" color="user21" display="text" font="굴림,9" text="방문예정일"/>
									<cell align="center" col="11" color="user21" display="text" font="굴림,9" text="방문일"/>
									<cell align="center" col="12" color="user21" display="text" font="굴림,9" text="입주예정일"/>
									<cell align="center" col="13" color="user21" display="text" font="굴림,9" text="입주일"/>
									<cell align="center" col="14" color="user21" display="text" font="굴림,9" text="주점검자"/>
									<cell align="center" col="15" color="user21" display="text" font="굴림,9" text="부점검자"/>
									<cell align="center" col="16" color="user21" display="text" font="굴림,9" text="문제점보고"/>
									<cell align="center" col="17" color="user21" display="text" font="굴림,9" text="지적이력"/>
									<cell align="center" col="18" color="user21" display="text" font="굴림,9" text="구호기"/>
									<cell align="center" col="19" color="user21" display="text" font="굴림,9" text="시내외구분"/>
									<cell align="center" col="20" color="user21" display="text" font="굴림,9" text="빌딩구분"/>
									<cell align="center" col="21" color="user21" display="text" font="굴림,9" text="총무상지급"/>
									<cell align="center" col="22" color="user21" display="text" font="굴림,9" text="무상일반"/>
									<cell align="center" col="23" color="user21" display="text" font="굴림,9" text="무상공사"/>
									<cell align="center" col="24" color="user21" display="text" font="굴림,9" text="FM대상"/>
									<cell align="center" col="25" color="user21" display="text" font="굴림,9" text="하자보증개시기준"/>
									<cell align="center" col="26" color="user21" display="text" font="굴림,9" text="하자보증개시일"/>
									<cell align="center" col="27" color="user21" display="text" font="굴림,9" text="하자보증만료일"/>
									<cell align="center" col="28" color="user21" display="text" font="굴림,9" text="하자보증개월수"/>
									<cell align="center" col="29" color="user21" display="text" font="굴림,9" text="보증보험발행처"/>
									<cell align="center" col="30" color="user21" display="text" font="굴림,9" text="설치PM"/>
									<cell align="center" col="31" color="user21" display="text" font="굴림,9" text="설치업체"/>
									<cell align="center" col="32" color="user21" display="text" font="굴림,9" text="설치팀장"/>
									<cell align="center" col="33" color="user21" display="text" font="굴림,9" text="완성검사기관"/>
									<cell align="center" col="34" color="user21" display="text" font="굴림,9" text="완성검사일"/>
									<cell align="center" col="35" color="user21" display="text" font="굴림,9" text="Q/E검사자"/>
									<cell align="center" col="36" color="user21" display="text" font="굴림,9" text="Q/E검사일"/>
									<cell align="center" col="37" color="user21" display="text" font="굴림,9" text="PLAT수"/>
								</head>
								<body>
									<cell align="center" bkimageid='expr:gfn_getFlagBkImageID(getColumn(currow,&#32;&quot;FLAG&quot;))' celltype="head" col="0" colid="FLAG" display="text"/>
									<cell align="center" bkcolor2="user22" col="1" display="text" expr="currow+1"/>
									<cell align="center" bkcolor2="user22" col="2" colid="CS101_FDT" display="text" Mask="####.##.##"/>
									<cell align="center" bkcolor2="user22" col="3" colid="CS101_HNO" display="text"/>
									<cell align="left" bkcolor2="user22" bkimagealign="right" bkimageid="expr:fn_ChangeIcon(CS101_FDT)" checklength="Byte" col="4" colid="CS101_HNA" display="text" edit="expr:fn_changeFlag(CS101_FDT)" limit="30"/>
									<cell align="center" bkcolor2="user22" bkimagealign="right" bkimageid="expr:fn_ChangeIcon(CS101_FDT)" checklength="Byte" col="5" colid="SID" display="text" edit="expr:fn_changeFlag(CS101_FDT,5)" limit="7" Mask="####-###"/>
									<cell align="center" bkcolor2="user22" bkimagealign="stretch" bkimageid="btn_grid_01" col="6" cursor="hand" display="button" text="좌표입력"/>
									<cell bkcolor2="user22" col="7" colid="ZSPEC1" display="text"/>
									<cell bkcolor2="user22" col="8" colid="ZSPEC2" display="text"/>
									<cell align="center" bkcolor="azure" col="9" colid="DSCODE" display="text"/>
									<cell bkcolor2="user22" col="10" colid="CS101_BYD" display="text" expandimage="btn_grid_icon_pen" expandshow="expr:fn_changeCal(CS101_FDT)" expandsize="18" Mask="####.##.##"/>
									<cell align="center" bkcolor2="user22" col="11" colid="CS101_VSD" display="text" Mask="####.##.##"/>
									<cell bkcolor2="user22" col="12" colid="CS101_IJY" display="text" expandimage="btn_grid_icon_pen" expandshow="expr:fn_changeCal(CS101_FDT)" expandsize="18" Mask="####.##.##"/>
									<cell align="center" bkcolor2="user22" col="13" colid="IJD" display="text" Mask="####.##.##"/>
									<cell align="left" bkcolor2="user22" bkimagealign="right" bkimageid="expr:fn_ChangeIcon(CS101_FDT)" col="14" colid="JUJ" combocol="CODE" combodataset="ds_juj_cd" combotext="CODE_NAME" display="combo" edit="expr:fn_changeCombo(CS101_FDT)"/>
									<cell align="left" bkcolor2="user22" bkimagealign="right" bkimageid="expr:fn_ChangeIcon(CS101_FDT)" col="15" colid="BUJ" combocol="CODE" combodataset="ds_buj_cd" combotext="CODE_NAME" display="combo" edit="expr:fn_changeCombo(CS101_FDT)"/>
									<cell align="center" bkcolor2="user22" bkimagealign="stretch" bkimageid="btn_grid_01" col="16" display="button" text="문제점보고"/>
									<cell align="center" bkcolor2="user22" bkimagealign="stretch" bkimageid="btn_grid_01" col="17" display="button" text="지적이력"/>
									<cell align="center" bkcolor2="user22" col="18" colid="POSID_OLD" display="text"/>
									<cell align="center" bkcolor2="user22" col="19" colid="CS101_AGB" display="text"/>
									<cell align="center" bkcolor2="user22" col="20" colid="CS101_ABG" display="text"/>
									<cell align="right" bkcolor2="user22" col="21" colid="ZMUSAOCNT3" display="number"/>
									<cell align="right" bkcolor2="user22" col="22" colid="ZMUSAOCNT2" display="number"/>
									<cell align="right" bkcolor2="user22" col="23" colid="ZMUSAOCNT" display="number"/>
									<cell align="center" bkcolor2="user22" col="24" colid="CS101_FYN" display="text"/>
									<cell bkcolor2="user22" col="25" colid="STN" display="text"/>
									<cell align="center" bkcolor2="user22" col="26" colid="FDT" display="text" Mask="####.##.##"/>
									<cell align="center" bkcolor2="user22" col="27" colid="TDT" display="text" Mask="####.##.##"/>
									<cell align="right" bkcolor2="user22" col="28" colid="GAO" display="number"/>
									<cell bkcolor2="user22" col="29" colid="PUB" display="text"/>
									<cell align="center" bkcolor2="user22" col="30" colid="TEMNO" display="text"/>
									<cell bkcolor2="user22" col="31" colid="NAME1" display="text"/>
									<cell align="center" bkcolor2="user22" col="32" colid="NAMET" display="text"/>
									<cell bkcolor2="user22" col="33" colid="ORG" display="text"/>
									<cell align="center" bkcolor2="user22" col="34" colid="DATE1" display="text" Mask="####.##.##"/>
									<cell align="center" bkcolor2="user22" col="35" colid="PAPRID" display="text"/>
									<cell align="center" bkcolor2="user22" col="36" colid="ZQEGEMSA" display="text" Mask="####.##.##"/>
									<cell bkcolor2="user22" col="37" colid="ZSPEC9" display="number"/>
								</body>
							</format>
						</contents>
					</Grid>
				</TabPage>
				<TabPage BorderColor="black" Height="470" Id="tab3" ImageID="tab_form_06" Left="2" TabOrder="9" Text="특이사항" Top="24" Width="954">
					<TextArea BindDataset="ds_list1" Border="Flat" Column="TEXT" Height="437" Id="commTextArea00" Left="2" Readonly="TRUE" Style="sty_ipt_form" TabOrder="1" Top="30" VScroll="TRUE" Width="950"></TextArea>
					<Static Align="Center" Border="Flat" BorderColor="user13" DomainID="com.spcdetail" Height="24" Id="commStatic22" Left="2" Style="sty_lb_form_basic" TabOrder="2" Text="특기사항" Top="3" VAlign="Middle" Width="950"></Static>
				</TabPage>
				<TabPage BorderColor="black" Height="470" Id="tab4" ImageID="tab_form_06" Left="2" TabOrder="9" Text="고객정보등록" Top="24" Width="954">
					<Shape BKColor="user12" Bottom="29" Height="26" Id="Shape1" Left="3" LineColor="user13" Right="951" TabOrder="1" Top="3" Type="Rectangle" Width="948"></Shape>
					<Static Align="Right" Height="24" Id="Static4" Left="4" Style="sty_lb_form_basic" TabOrder="2" Text="통합&#32;Proj&#32;No&#32;" Top="4" VAlign="Middle" Width="86"></Static>
					<Static Align="Right" Height="24" Id="Static11" Left="222" Style="sty_lb_form_basic" TabOrder="3" Text="고객구분&#32;" Top="4" VAlign="Middle" Width="86"></Static>
					<Shape BKColor="user12" Bottom="54" Height="26" Id="Shape0" Left="3" LineColor="user13" Right="951" TabOrder="4" Top="28" Type="Rectangle" Width="948"></Shape>
					<Static Align="Right" Height="24" Id="Static0" Left="440" Style="sty_lb_form_basic" TabOrder="5" Text="성명&#32;" Top="4" VAlign="Middle" Width="86"></Static>
					<Static Align="Right" Height="24" Id="Static1" Left="4" Style="sty_lb_form_basic" TabOrder="6" Text="HP&#32;" Top="29" VAlign="Middle" Width="86"></Static>
					<Static Align="Right" Height="24" Id="Static2" Left="222" Style="sty_lb_form_basic" TabOrder="7" Text="TEL(지역번호포함)&#32;" Top="29" VAlign="Middle" Width="120"></Static>
					<Static Align="Right" Height="24" Id="Static3" Left="511" Style="sty_lb_form_basic" TabOrder="8" Text="해피콜&#32;" Top="29" VAlign="Middle" Width="86"></Static>
					<Edit BindDataset="ds_list3" Border="Flat" Column="CSA_PJT" Enable="FALSE" Height="20" Id="Edit3" Left="92" Readonly="TRUE" Style="sty_ipt_form" TabOrder="9" Top="6" Width="128"></Edit>
					<Combo BindDataset="ds_list3" Border="Flat" CodeColumn="CODE" Column="CSA_CTG" DataColumn="CODE_NAME" Height="20" Id="Combo1" InnerDataset="ds_cus_cd" Left="309" Style="sty_ipt_form" TabOrder="11" Top="5" Width="129"></Combo>
					<Static Align="Center" Border="None" Color="user7" Font="굴림,9" Height="20" Id="Static17" Left="440" TabOrder="10" Text="교환" Top="31" VAlign="Middle" Width="26"></Static>
					<Edit BindDataset="ds_list3" Border="Flat" CheckLength="Byte" Column="CSA_TEL" Height="20" Id="ed_tel" Left="344" MaxLength="11" Number="TRUE" Style="sty_ipt_form" TabOrder="14" Top="31" Width="92"></Edit>
					<Edit BindDataset="ds_list3" Border="Flat" CheckLength="Byte" Column="CSA_TEX" Height="20" Id="Edit1" Left="470" MaxLength="4" Number="TRUE" Style="sty_ipt_form" TabOrder="15" Top="31" Width="39"></Edit>
					<Edit BindDataset="ds_list3" Border="Flat" CheckLength="Byte" Column="CSA_HTL" Height="20" Id="Edit2" Left="599" MaxLength="11" Number="TRUE" Style="sty_ipt_form" TabOrder="17" Top="31" Width="92"></Edit>
					<Static Align="Center" Border="None" Color="user7" Font="굴림,9" Height="20" Id="Static5" Left="695" TabOrder="16" Text="교환" Top="31" VAlign="Middle" Width="26"></Static>
					<Edit BindDataset="ds_list3" Border="Flat" CheckLength="Byte" Column="CSA_HEX" Height="20" Id="Edit4" Left="725" MaxLength="4" Number="TRUE" Style="sty_ipt_form" TabOrder="18" Top="31" Width="39"></Edit>
					<Edit BindDataset="ds_list3" Border="Flat" CheckLength="Byte" Column="CSA_CNM" Height="20" Id="Edit5" Left="528" MaxLength="10" Style="sty_ipt_form" TabOrder="12" Top="6" Width="128"></Edit>
					<Edit BindDataset="ds_list3" Border="Flat" CheckLength="Byte" Column="CSA_CPN" Height="20" Id="Edit6" Left="92" MaxLength="11" Number="TRUE" Style="sty_ipt_form" TabOrder="13" Top="31" Width="128"></Edit>
					<Grid AutoFit="TRUE" AutoFitEndLine="Hide" BindDataset="ds_list3" BkColor2="default" BoldHead="true" Border="Flat" Bottom="467" ColSizing="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="405" Id="grd_list" InputPanel="FALSE" Left="3" LineColor="user20" LineType="ExHORZ" MinWidth="100" OnHeadClick="Tab00_tab4_grd_list_OnHeadClick" Right="951" RowHeight="20" Style="sty_grid" TabOrder="19" TabStop="true" Top="62" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="948">
						<contents>
							<format id="Default">
								<columns>
									<col width="20"/>
									<col width="40"/>
									<col width="140"/>
									<col width="170"/>
									<col width="170"/>
									<col width="170"/>
									<col width="170"/>
								</columns>
								<head>
									<cell align="center" col="0" color="user21" display="text" font="굴림,9"/>
									<cell align="center" col="1" color="user21" display="text" font="굴림,9" text="No"/>
									<cell align="center" col="2" color="user21" display="text" font="굴림,9" text="성명"/>
									<cell align="center" col="3" color="user21" display="text" font="굴림,9" text="고객구분"/>
									<cell align="center" col="4" color="user21" display="text" font="굴림,9" text="HP"/>
									<cell align="center" col="5" color="user21" display="text" font="굴림,9" text="전화번호"/>
									<cell align="center" col="6" color="user21" display="text" font="굴림,9" text="해피콜"/>
								</head>
								<body>
									<cell align="center" celltype="head" col="0" display="text" text="▶"/>
									<cell align="center" bkcolor2="user22" col="1" display="text" expr="currow+1"/>
									<cell bkcolor2="user22" col="2" colid="CSA_CNM" display="text"/>
									<cell bkcolor2="user22" col="3" colid="CSA_CTG" combocol="CODE" combodataset="ds_cus_cd" combotext="CODE_NAME" display="combo"/>
									<cell bkcolor2="user22" col="4" colid="CSA_CPN" display="text"/>
									<cell bkcolor2="user22" col="5" colid="CSA_TEL" display="text"/>
									<cell bkcolor2="user22" col="6" colid="CSA_HTL" display="text"/>
								</body>
							</format>
						</contents>
					</Grid>
				</TabPage>
			</Contents>
		</Tab>
		<Calendar Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="146" Id="cal_temp" Left="984" MonthOnly="TRUE" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" OnDayClick="cal_temp_OnDayClick" OnKillFocus="cal_temp_OnKillFocus" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="16" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="224" Value="20080401" Visible="FALSE" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="152"></Calendar>
		<FileDialog Bottom="600" Height="24" Id="fileDialog" Left="408" Right="432" TabOrder="17" Top="576" Width="24"></FileDialog>
		<CyHttpFile Height="24" Id="httpFile" Left="444" Top="576" Width="24"></CyHttpFile>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="CODE" Column="PBN" DataColumn="CODE_NAME" Height="20" Id="cb_pbn" InnerDataset="ds_pbn" Left="86" Style="sty_ipt_search" TabOrder="18" Top="27" Width="80"></Combo>
		<Static Align="Right" Height="20" Id="st_pbn" Left="5" Style="sty_lb_search" TabOrder="17" Text="제품군&#32;" Top="28" VAlign="Middle" Width="80"></Static>
	</Form>
	<Script><![CDATA[﻿﻿﻿﻿﻿﻿/*
 ******************************************************************************************
 * 기      능   : 
 * 작  성  자   : 
 * 작성  일자   : 
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
#include "LIB::commons.js";	// 공통 스크립트 
//=========================================================================================
// [ PART 1 ]
// Form에서 사용될 전역변수를 선언
// FORM에서 사용되는 전역변수는 대문자로 작성하며, F_XXX 의 형태를 갖도록 한다. 
//=========================================================================================
var user_grp = "";
var tab_idx = "0";
var tmp_idx = "0";
//=========================================================================================
// [ PART 2 ]
// Form Loading / Unloading 시 작업 정의
//=========================================================================================
function fn_OnLoadCompleted(obj) {
	// Form 로드 이벤트 맨 첫줄에 기술 
	gfn_initForm(true);

	user_grp = gfn_getUserGroup();

	//인계일 : 현재월의 첫날짜, 마지막날짜
	var firstDay = substr(gfn_getCurrDate(),0,6)+"01";
	var lastDay = gfn_getLeapLastDay(gfn_getCurrDate());
	cal_cs101_fdt_f.value = firstDay;
	cal_cs101_fdt_t.value = lastDay;

	ed_pjt.SetFocus();
	//버튼활성화 처리
	ufn_enableBtn("query", true);
//	if(user_grp == '20' || user_grp == '30'){
	if(user_grp == '20') {
		ufn_enableBtn("save", false);
	} else {
		//ufn_enableBtn("save", true);
		ufn_enableBtn("save", false);
	}
	ufn_enableBtn("input", false);
	ufn_enableBtn("delete", false);

	//주점검자,부점검자 콤보 SELECT
	tit_clearActionInfo();
	tit_addSearchActionInfo("cs06:CS0603001B_S2");
	tit_callService(
		""
		, ""
		, "ds_cond=ds_cond"
		, "ds_juj_cd=ds_juj_cd"
		, ""
		, "fn_afterQueryCd"
		, true
		, true);
}
/********************************************************************************
* 기      능   : 공통코드가 조회된 후의 Callback 함수 
********************************************************************************/
function fn_completeInit(sCode, sDsObj, sCodeType) {
	cb_pbn.Index = 0;
	
	if(Tab00.TabIndex == 3) {
		fn_query3();
	}
}
/********************************************************************************
* 기      능   : form UnloadCompleted 
********************************************************************************/
function fn_OnUnloadCompleted(obj) {
	return gfn_isFormUnload(obj);
}
//=========================================================================================
// [ PART 3 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,form닫기)
//=========================================================================================
/********************************************************************************
* 기      능   : 조회 (신규인수 관리)
********************************************************************************/
function fn_query() {
	// 인계일자
	if ( !gfn_checkFromToObj(cal_cs101_fdt_f, cal_cs101_fdt_t, true, st_cs101_fdt.value, 0, true) ) {
		return;
	}

	if(ed_pjt.value != "")
		ds_cond.SetColumn(0,"GBN","A");
	else if(ed_pjt.value == "")
		ds_cond.SetColumn(0,"GBN","B");

	if(user_grp == "10") { // 보수협력사일 경우
		ds_cond.SetColumn(0, "BSU", G_LGORT);
		ds_cond.SetColumn(0, "TEM", '');
		ds_cond.SetColumn(0, "BPM", '');
		ds_cond.SetColumn(0, "ARA", '');
	} else if(user_grp == "20") { // 보수PM일 경우
		ds_cond.SetColumn(0, "BSU", trim(div_code.cb_small.value));
		ds_cond.SetColumn(0, "TEM", '');
		ds_cond.SetColumn(0, "BPM", G_USER_ID);
		ds_cond.SetColumn(0, "ARA", '');
	} else if(user_grp == "30") { // 지방사무소일 경우
		ds_cond.SetColumn(0, "BSU", trim(div_code.cb_small.value));
		ds_cond.SetColumn(0, "TEM", G_SAP_USER_VGCD);
		ds_cond.SetColumn(0, "BPM", '');
		ds_cond.SetColumn(0, "ARA", '');
	} else if(user_grp == "40") { // 고객지원부일 경우
	    //====================================수정시작=======================================	
		/*
		ds_cond.SetColumn(0, "BSU", trim(div_code.cb_small.value));
		if(div_code.cb_big.value == '1') { // 협력사 콤보1이 지역일 경우
			ds_cond.SetColumn(0, "TEM", '');
			ds_cond.SetColumn(0, "BPM", '');
			ds_cond.SetColumn(0, "ARA", trim(div_code.cb_mid.value));
		} else if(div_code.cb_big.value == '2') { // 협력사 콤보1이 PM일 경우
			ds_cond.SetColumn(0, "TEM", '');
			ds_cond.SetColumn(0, "BPM", trim(div_code.cb_mid.value));
			ds_cond.SetColumn(0, "ARA", '');
		} else { // 협력사 콤보1이 팀일 경우
			ds_cond.SetColumn(0, "TEM", trim(div_code.cb_mid.value));
			ds_cond.SetColumn(0, "BPM", '');
			ds_cond.SetColumn(0, "ARA", '');
		}
		*/
		if(div_code.cb_big.value == '1') { // 협력사 콤보1이 지역일 경우
		ds_cond.SetColumn(0, "TEM", '');
		ds_cond.SetColumn(0, "BPM", '');
		ds_cond.SetColumn(0, "ARA", trim(div_code.cb_mid.value));
		ds_cond.SetColumn(0, "DPT", '');
		ds_cond.SetColumn(0, "BSU", trim(div_code.cb_small.value));
		
	} else if(div_code.cb_big.value == '2') { // 협력사 콤보1이 PM일 경우
		ds_cond.SetColumn(0, "TEM", '');
		ds_cond.SetColumn(0, "BPM", trim(div_code.cb_mid.value));
		ds_cond.SetColumn(0, "ARA", '');
		ds_cond.SetColumn(0, "DPT", '');
		ds_cond.SetColumn(0, "BSU", trim(div_code.cb_small.value));
		
	} else if(div_code.cb_big.value == '3') { // 협력사 콤보1이 팀 
		ds_cond.SetColumn(0, "TEM", trim(div_code.cb_mid.value));
		ds_cond.SetColumn(0, "BPM", '');
		ds_cond.SetColumn(0, "ARA", '');
		ds_cond.SetColumn(0, "DPT", '');
		ds_cond.SetColumn(0, "BSU", trim(div_code.cb_small.value));
		
	} else { // 협력사 콤보1이 부서일 경우
		ds_cond.SetColumn(0, "TEM", trim(div_code.cb_small.value));
		ds_cond.SetColumn(0, "BPM", '');
		ds_cond.SetColumn(0, "ARA", '');
		ds_cond.SetColumn(0, "DPT", substr(trim(div_code.cb_mid.value),0,2));
		ds_cond.SetColumn(0, "BSU", '');
	}
		
		//====================================수정끝=======================================	
		
	}
	
	/* 20120914 LHR 제품구분 추가 (이선재SW 요청) */	
	if(cb_pbn.value <> 0) { 
		ds_cond.SetColumn(0, "PBN", cb_pbn.Value);
	} else{
		ds_cond.SetColumn(0, "PBN", "");
	}
	
	// 필수 입력 항목 체크 
	if(user_grp == "40") { // 고객지원부일 경우
		if(length(div_code.cb_big.value) == 0 && length(div_code.cb_mid.value) == 0) {
			var arr = [st_bsu.value];
			gfn_showMsg("CW00045", arr);
			return;
		}		
	}
	
	// 최대 6개월로 제한. 2019.04.01 Han J.H
	var diffDays = gfn_getDayCnt(ds_days, cal_cs101_fdt_f.value, cal_cs101_fdt_t.value);
		
	if(diffDays > 180) {
		gfn_showAlert("CW00078","6");
		cal_reqdate_fm.SetFocus();
		return;
	}		
	
	tit_clearActionInfo();
	tit_addSearchActionInfo("cs06:CS0603001A_S1");
	
	tit_callService(
        ""
        , ""
        , "ds_cond=ds_cond"
        , "ds_list=ds_list"
        , ""
        , "fn_afterQuery"
        , true);
}

function fn_query1() {
	ds_cond1.DeleteAll();
	ds_cond1.AddRow();
	ds_cond1.SetColumn(0, "PSPID", ds_list.GetColumn(0, "CS101_PJT"));
	ds_cond1.SetColumn(0, "USERID", G_USER_ID);

	tit_callService(
          "PS0101001A_ACT"
        , "query"
        , "ds_cond=ds_cond1"
        , "ds_list1=ds_list"
        , ""
        , "fn_afterQuery1"
        , false);
}

function fn_query4() {
	ds_cond1.DeleteAll();
	ds_cond1.AddRow();
	ds_cond1.SetColumn(0, "PSPID", ds_list.GetColumn(ds_list.currow, "CS101_PJT"));
	ds_cond1.SetColumn(0, "USERID", G_USER_ID);

	tit_callService(
          "PS0101001A_ACT"
        , "query"
        , "ds_cond=ds_cond1"
        , "ds_list1=ds_list"
        , ""
        , "fn_afterQuery4"
        , false);
}

/********************************************************************************
* 기      능   : 조회(신규인수 상세등록)
********************************************************************************/
function fn_query2() {
	if(ds_list.row < 0 || ds_list.GetColumn(ds_list.row,"CS101_PJT") == "")
		return;

	ds_cond2.SetColumn(0,"POSID",ds_list.GetColumn(ds_list.row,"CS101_PJT"));
	
	if(user_grp == "10") { // 보수협력사일 경우
		ds_cond2.SetColumn(0, "BSU", G_LGORT);
		ds_cond2.SetColumn(0, "TEM", '');
		ds_cond2.SetColumn(0, "BPM", '');
		ds_cond2.SetColumn(0, "ARA", '');
	} else if(user_grp == "20") { // 보수PM일 경우
		ds_cond2.SetColumn(0, "BSU", trim(div_code.cb_small.value));
		ds_cond2.SetColumn(0, "TEM", '');
		ds_cond2.SetColumn(0, "BPM", G_USER_ID);
		ds_cond2.SetColumn(0, "ARA", '');
	} else if(user_grp == "30") { // 지방사무소일 경우
		ds_cond2.SetColumn(0, "BSU", trim(div_code.cb_small.value));
		ds_cond2.SetColumn(0, "TEM", G_SAP_USER_VGCD);
		ds_cond2.SetColumn(0, "BPM", '');
		ds_cond2.SetColumn(0, "ARA", '');
	} else if(user_grp == "40") { // 고객지원부일 경우
		ds_cond2.SetColumn(0, "BSU", trim(div_code.cb_small.value));
		if(div_code.cb_big.value == '1') { // 협력사 콤보1이 지역일 경우
			ds_cond2.SetColumn(0, "TEM", '');
			ds_cond2.SetColumn(0, "BPM", '');
			ds_cond2.SetColumn(0, "ARA", trim(div_code.cb_mid.value));
		} else if(div_code.cb_big.value == '2') { // 협력사 콤보1이 PM일 경우
			ds_cond2.SetColumn(0, "TEM", '');
			ds_cond2.SetColumn(0, "BPM", trim(div_code.cb_mid.value));
			ds_cond2.SetColumn(0, "ARA", '');
		} else { // 협력사 콤보1이 팀일 경우
			ds_cond2.SetColumn(0, "TEM", trim(div_code.cb_mid.value));
			ds_cond2.SetColumn(0, "BPM", '');
			ds_cond2.SetColumn(0, "ARA", '');
		}
	}

	/* 20120914 LHR 제품구분 추가 (이선재SW 요청) */		
	if(ds_list.GetColumn(0, "PBN") <> 0) { 
		ds_cond2.SetColumn(0, "PBN", ds_list.GetColumn(0, "PBN"));
	} else{
		ds_cond2.SetColumn(0, "PBN", "");
	}
	
	if(user_grp == '10') { 
		ds_cond2.SetColumn(0,"BSU",G_LGORT); 
	}

	tit_clearActionInfo();
	tit_addSearchActionInfo("cs06:CS0603001B_S1");
	
	tit_callService(
        ""
        , ""
        , "ds_cond=ds_cond2"
        , "ds_list2=ds_list"
        , ""
        , "fn_afterQuery2"
        , true);
}
/********************************************************************************
* 기      능   : 조회(고객정보등록)
********************************************************************************/
function fn_query3() {
	if(ds_list.row < 0 || ds_list.GetColumn(ds_list.row,"CS101_PJT") == "") {
		ufn_enableBtn("input", false);		
		ufn_enableBtn("delete", false);		
		return;
	}

	if(tmp_idx == "0") {
		ds_cond2.SetColumn(0,"POSID",ds_list.GetColumn(ds_list.row,"CS101_PJT"));
		ds_cond2.SetColumn(0,"FDT",ds_list.GetColumn(ds_list.row,"CS101_FDT"));
	} else if(tmp_idx == "1") {
		ds_cond2.SetColumn(0,"POSID",ds_list2.GetColumn(ds_list2.row,"CS101_PJT"));
		ds_cond2.SetColumn(0,"FDT",ds_list2.GetColumn(ds_list2.row,"CS101_FDT"));
	}

	tit_clearActionInfo();
	tit_addSearchActionInfo("cs06:CS0603001C_S1");
	tit_addSearchActionInfo("cs06:CS0603001C_S2");

	tit_callService(
        ""
        , ""
        , "ds_cond=ds_cond2"
        , "ds_list3=ds_list ds_list4=ds_list4"
        , ""
        , "fn_afterQuery3"
        , true);
}
/********************************************************************************
* 기      능   : 삽입 
********************************************************************************/
function fn_input() {
	ds_list3.AddRow();
	ds_list3.SetColumn(ds_list3.rowcount-1,"CSA_PJT",ds_cond2.GetColumn(0,"POSID"));
}
/********************************************************************************
* 기      능   : Delete 
********************************************************************************/
function fn_delete() {
	ds_list3.DeleteRow(ds_list3.row);
}
/********************************************************************************
* 기      능   : 저장 
********************************************************************************/
function fn_save() {

	// 물류 분사 PSD 트랜젝션 제어 20170831 Start*****//
	// M 프로젝트는 신규인수 대상이 아니므로 G 프로젝트에 대한 트랜잭션만 막는다.
	if (substr(ds_cond2.GetColumn(0,"POSID") ,0,1) == "G"){
		gfn_showAlert("CW00246");
		return;
	}
	// 물류 분사 PSD 트랜젝션 제어 20170831 End*****//
	
	if(Tab00.TabIndex == 0)
		fn_save1();
	else if(Tab00.TabIndex == 1)	
		fn_save2();
	else if(Tab00.TabIndex == 3)	
		fn_save3();
}
/********************************************************************************
* 기      능   : 저장 (신규인수관리)
********************************************************************************/
function fn_save1() {
	if ( !gfn_isChangeDs(ds_list, true, "FLAG") ) {
		return;
	}

	// 고객명 필수입력 체크
	var dsArr = ["KUNNR_NM"];
	var lbArr = ["고객명"];
	if ( gfn_isGridNull(Tab00.tab1.grd_list,dsArr,lbArr,"FLAG") ) {
		return;
	}

	tit_clearActionInfo();
	// 저장 처리 
	tit_addSaveActionInfo(
        ""
        , "cs06:CS0603001A_U1"
        , ""
        , "FLAG"
        , ""
        , -1
        , "");

	tit_addSaveActionInfo(
        ""
        , "cs06:CS0603001A_U2"
        , ""
        , "FLAG"
        , ""
        , -1
        , "");

	tit_callService(
        ""
        , ""
        , "ds_list=ds_list:A"
        , ""
        , ""
        , "fn_afterSave");
}
/********************************************************************************
* 기      능   : 저장 (신규인수상세)
********************************************************************************/
function fn_save2() {
	if ( !gfn_isChangeDs(ds_list2, true, "FLAG") ) {
		return;
	}

	//고객명 필수입력 체크
	// var dsArr = ["CS101_HNA","CS101_BYD","CS101_IJY","JUJ","BUJ"];
	// var lbArr = ["호기명","처리예정일","입주예정일","주점검자","부점검자"];
	// if ( gfn_isGridNull(Tab00.tab2.grd_list2,dsArr,lbArr,"FLAG") ) {
		// return;
	// }
	
	for(var i=0; i<ds_list2.rowcount; i++)
	{
		if(ds_list2.GetColumn(i,"FLAG") == "U")
		{
			if(ds_list2.GetColumn(i,"JUJ") == ds_list2.GetColumn(i,"BUJ"))
			{
				var arr = [st_juj.value, st_buj.value ];
				gfn_showAlert("CW00025", arr);
				obj.setColumn(i, "JUJ", obj.GetOrgColumn(i,"JUJ") );
				return;
			}
			if(ds_list2.GetColumn(i,"JUJ") != ds_list2.GetOrgColumn(i,"JUJ") ||
			   ds_list2.GetColumn(i,"BUJ") != ds_list2.GetOrgColumn(i,"BUJ") )
			{
				ds_list2.SetColumn(i,"CH_FLG","1");
				ds_list2.SetColumn(i,"ORG_JUJ",ds_list2.GetOrgColumn(i,"JUJ"));
				ds_list2.SetColumn(i,"ORG_BUJ",ds_list2.GetOrgColumn(i,"BUJ"));
			}  
			if(length(trim(ds_list2.GetColumn(i, "SID"))) != 0){
				if(length(trim(ds_list2.GetColumn(i, "SID"))) < 7) {
					gfn_showAlert("승강기 번호는 숫자 7자리로 입력이 가능합니다.");
					return;
				}
			}
		}	
	}

/*
	tit_clearActionInfo();
	tit_addSearchActionInfo("cs06:CS0603001A_S3");
	tit_callService(
        "PDA_ACT"
        , "" 
        , "ds_list2=ds_list2"
        , "ds_cnt=ds_cnt"
        , ""
        , "fn_afterGisCount"
        , true);
*/

	tit_clearActionInfo();
	// 저장 처리 
	tit_addSaveActionInfo(
		""
		, "cs06:CS0603001B_U1"
		, ""
		, "FLAG"
		, ""
		, -1
		, "");

	tit_addSaveActionInfo(
		""
		, "cs06:CS0603001B_U2"
		, ""
		, "FLAG"
		, ""
		, -1
		, "");

	tit_addSelectExActionInfo("cs06:CS0603001B_S3", "", "cs06:CS0603001B_I1");

	tit_callService(
		""
		, ""
		, "ds_list=ds_list2:A"
		, ""
		, ""
		, "fn_afterSave2");
}
/********************************************************************************
* 기      능   : 저장 (고객정보등록)
********************************************************************************/
function fn_save3() {
	if ( !gfn_isChangeDs(ds_list3, true, "") ) {
		return;
	}

	// 고객명 필수입력 체크
	var dsArr = ["CSA_CTG","CSA_CNM","CSA_TEL"];
	var lbArr = ["고객구분","성명","전화번호"];
	if ( gfn_isGridNull(Tab00.tab4.grd_list,dsArr,lbArr,"") ) {
		return;
	}

	if(length(Tab00.tab4.ed_tel.Text) < 9) {
		gfn_showAlert("CW10025", "전화번호는 최소 9자리이상 입력하셔야 합니다.");
		return false;
	}

	var rows = 0;
	for(var i=0; i<ds_list4.rowcount; i++)
	{
		for(var j=0; j<ds_list3.rowcount; j++)
		{
			ds_list5.AddRow();
			ds_list5.SetColumn(rows,"CSA_PJT",ds_list3.GetColumn(j,"CSA_PJT"));
			ds_list5.SetColumn(rows,"CSA_HNO",ds_list4.GetColumn(i,"Cs101_HNO"));
			ds_list5.SetColumn(rows,"CSA_CSQ",j+1);
			ds_list5.SetColumn(rows,"CSA_CTG",ds_list3.GetColumn(j,"CSA_CTG"));
			ds_list5.SetColumn(rows,"CSA_CNM",ds_list3.GetColumn(j,"CSA_CNM"));
			ds_list5.SetColumn(rows,"CSA_TEL",ds_list3.GetColumn(j,"CSA_TEL"));
			ds_list5.SetColumn(rows,"CSA_TEX",ds_list3.GetColumn(j,"CSA_TEX"));
			ds_list5.SetColumn(rows,"CSA_CPN",ds_list3.GetColumn(j,"CSA_CPN"));
			ds_list5.SetColumn(rows,"CSA_HTL",ds_list3.GetColumn(j,"CSA_HTL"));
			ds_list5.SetColumn(rows,"CSA_HEX",ds_list3.GetColumn(j,"CSA_HEX"));
			
			rows++;
		}
	}	

	tit_clearActionInfo();

	tit_addSingleActionInfo("cs06:CS0603001C_D1");
	tit_addMultiActionInfo("cs06:CS0603001C_D1");
	if(ds_list5.rowcount > 0){
		tit_addMultiActionInfo("cs06:CS0603001C_I1");
		tit_addMultiActionInfo("cs06:CS0603001C_U1");
	}	

	tit_callService(
        ""
        , ""
        , "ds_cond=ds_cond2:A ds_list5=ds_list5:A"
        , ""
        , ""
        , "fn_afterSave3");

}
/********************************************************************************
* 기      능   : 닫기  
********************************************************************************/
function fn_close() {
	close();
}

//=========================================================================================
// [ PART 4]
// Callback 함수 정의 : callback 함수명은 메인 함수의 fn_xxxx() 에서 xxxx 부분은 fn_afterXXXX()
// 형태가 되도록 작성 
//=========================================================================================
/********************************************************************************
* 기      능   : 조회 Callback  
********************************************************************************/
function fn_afterQuery(errCode, errMsg) {
	gfn_showMsg("CI00002",ds_list.RowCount()+"");

	ds_cond_copy.SetColumn(0,"BSU","");
	ds_cond_copy.copy(ds_cond);

	if(user_grp == "30" && length(trim(div_code.cb_small.value)) == 0) {
		ds_cond_copy.SetColumn(0,"BSU",G_LGORT);
	}

	ds_cond.SetColumn(0,"GBN","");
	ds_cond.SetColumn(0,"BSU","");
	ds_cond.SetColumn(0,"BPM","");
	ds_cond.SetColumn(0,"ARA","");

	if(ds_list.RowCount() > 0) {
		fn_query1();
	}
}
function fn_afterQuery1(errCode, errMsg) {
	//gfn_showSearchMsg(Tab00.tab1.grd_list1, errCode, errMsg);
}
function fn_afterQuery4(errCode, errMsg) {
	//gfn_showSearchMsg(Tab00.tab1.grd_list1, errCode, errMsg);
}
/********************************************************************************
* 기      능   : 조회 Callback  
********************************************************************************/
function fn_afterQuery2(errCode, errMsg) {
	gfn_showMsg("CI00002",ds_list2.RowCount()+"");
	ds_cond2.SetColumn(0,"BSU","");
}
/********************************************************************************
* 기      능   : 조회 Callback  
********************************************************************************/
function fn_afterQuery3(errCode, errMsg) {
	gfn_showMsg("CI00002",ds_list3.RowCount()+"");
}
/********************************************************************************
* 기      능   : 조회 Callback  :주점검자,부점검자 콤보
********************************************************************************/
function fn_afterQueryCd(errCode, errMsg) {
	ds_buj_cd.copy(ds_juj_cd);
}

/********************************************************************************
* 기      능   : 저장 Callback  
********************************************************************************/
function fn_afterSave(errCode, errMsg) {
	if ( errCode!= 0 ) {
		gfn_showMsg("CE00001");
	} else {
		gfn_showMsg("CI00003");
		fn_query();
	}
}

/********************************************************************************
* 기      능   : 저장 Callback  
********************************************************************************/
function fn_afterSave2(errCode, errMsg) {
	if ( errCode!= 0 ) {
		gfn_showMsg("CE00001");
	} else {
		gfn_showMsg("CI00003");
		fn_query2();
	}
}
/********************************************************************************
* 기      능   : 저장 Callback  
********************************************************************************/
function fn_afterSave3(errCode, errMsg) {
	if ( errCode!= 0 ) {
		gfn_showMsg("CE00001");
	} else {
		gfn_showMsg("CI00003");
		ds_list5.ClearData();
		fn_query3();
	}
}

function fn_afterGisCount() {
	if(ds_cnt.GetColumn(0, "CNT") == 0) {
		gfn_showAlert("GIS맵 정보가 없습니다. X,Y좌표를 등록하셔야 합니다.");
		return;
	} else {
		tit_clearActionInfo();
		// 저장 처리 
		tit_addSaveActionInfo(
			""
			, "cs06:CS0603001B_U1"
			, ""
			, "FLAG"
			, ""
			, -1
			, "");

		tit_addSaveActionInfo(
			""
			, "cs06:CS0603001B_U2"
			, ""
			, "FLAG"
			, ""
			, -1
			, "");

		tit_addSelectExActionInfo("cs06:CS0603001B_S3", "", "cs06:CS0603001B_I1");

		tit_callService(
			""
			, ""
			, "ds_list=ds_list2:A"
			, ""
			, ""
			, "fn_afterSave2");
	}
}

//=========================================================================================
// [ PART 5 ]
// Detail Process Event 정의 ( User Define function )
// 사용자 정의 함수는 ufn_xxxx() 형태로 작성 
//=========================================================================================
/********************************************************************************
* 기      능   : 사용자 정의 함수  
********************************************************************************/
function ufn_userfunction() {

}

//=========================================================================================
// [ PART 6 ]
// component Event 정의 : 각 Component 별 이벤트 
//=========================================================================================
function grd_list_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
{
	gfn_sortGrid(obj,nCell);
}
/********************************************************************************
* 기      능   : 그리드에서 enter key 클릭 시 focus이동
********************************************************************************/
function grd_list_OnKeyDown(obj,nChar)
{
	if( nChar == "13") {
		obj.SetCellPos(1);
		obj.SetFocus();
	}
}

/********************************************************************************
* 기      능   : 데이터셋 값 변경 시 - Flag 처리 
********************************************************************************/
function ds_list_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{ 
	switch( strColumnID ) {
	    case "KUNNR_NM":
			if(trim(ds_list.GetColumn(nRow,"KUNNR_NM")) == trim(ds_list.GetOrgColumn(nRow,"KUNNR_NM")) )
				obj.SetColumn(nRow, "FLAG", "");
			else
				obj.SetColumn(nRow, "FLAG", "U");	
	        break;
	}        
}
/********************************************************************************
* 기      능   : 데이터셋 값 변경 시 - Flag 처리 
********************************************************************************/
function ds_list2_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{ 
	switch( strColumnID ) {
	    case "KUNNR_NM":
			obj.SetColumn(nRow, "FLAG", "U");
	        break;
	    case "CS101_HNA":
			obj.SetColumn(nRow, "FLAG", "U");
	        break;
	    case "SID":
			obj.SetColumn(nRow, "FLAG", "U");
	        break;
	    case "CS101_BYD":
			if(trim(ds_list2.getColumn(nRow, "CS101_FDT")) > varNewValue) {
				obj.fireevent = false;
				var arr = [st_cs101_byd.value, st_cs101_fdt.value ];
				gfn_showAlert("CW00007", arr);
				obj.setColumn(nRow, "CS101_BYD", obj.GetOrgColumn(nRow,"CS101_BYD") );
				obj.fireevent = true;
				break;
			}
			if(length(ds_list2.getColumn(nRow, "CS101_IJY")) >0 && trim(ds_list2.getColumn(nRow, "CS101_IJY")) <= varNewValue) {
				obj.fireevent = false;
				var arr = [st_cs101_byd.value, st_cs101_ijy.value ];
				gfn_showAlert("CW00023", arr);
				obj.setColumn(nRow, "CS101_BYD", obj.GetOrgColumn(nRow,"CS101_BYD") );
				obj.fireevent = true;
				break;
			}
			obj.SetColumn(nRow, "FLAG", "U");
	        break;
	    case "CS101_IJY":
			if(trim(ds_list2.getColumn(nRow, "CS101_BYD")) >= varNewValue) {
				obj.fireevent = false;
				var arr = [st_cs101_ijy.value, st_cs101_byd.value ];
				gfn_showAlert("CW00024", arr);
				obj.setColumn(nRow, "CS101_IJY", obj.GetOrgColumn(nRow,"CS101_IJY") );
				obj.fireevent = true;
				break;
			}
			obj.SetColumn(nRow, "FLAG", "U");
	        break;        
	    case "JUJ":
			if(trim(ds_list2.getColumn(nRow, "JUJ")) == trim(ds_list2.getColumn(nRow, "BUJ"))) {
				obj.fireevent = false;
				var arr = [st_juj.value, st_buj.value ];
				gfn_showAlert("CW00025", arr);
				obj.setColumn(nRow, "JUJ", obj.GetOrgColumn(nRow,"JUJ") );
				obj.fireevent = true;
				break;
			}
			obj.SetColumn(nRow, "FLAG", "U");
	        break;        
	    case "BUJ":
			if(trim(ds_list2.getColumn(nRow, "JUJ")) == trim(ds_list2.getColumn(nRow, "BUJ"))) {
				obj.fireevent = false;
				var arr = [st_buj.value, st_juj.value ];
				gfn_showAlert("CW00025", arr);
				obj.setColumn(nRow, "BUJ", obj.GetOrgColumn(nRow,"BUJ") );
				obj.fireevent = true;
				break;
			}
			obj.SetColumn(nRow, "FLAG", "U");
	        break;        
	}
}
/********************************************************************************
* 기      능   : 텝 선택시
********************************************************************************/
function Tab00_OnChanged(obj, nOldIndex, nNewIndex) {
	if(obj.TabIndex == 1) {
		tmp_idx = tab_idx;
		tab_idx = "1";
		ufn_enableBtn("query", false);
		ufn_enableBtn("input", false);
		ufn_enableBtn("delete", false);
//		if(user_grp == '20' || user_grp == '30'){
		if(user_grp == '20') {
			ufn_enableBtn("save", true);
		} else {
			ufn_enableBtn("save", true);
			//ufn_enableBtn("save", false);
		}

		ds_cond_copy.SetColumn(0,"BSU",ds_list.GetColumn(ds_list.currow,"CS101_BSU"));

		if(TRIM(ds_cond_copy.GetColumn(0,"BSU")) > '') {
			ds_juj_cd.Filter("BSU=="+quote(TRIM(ds_cond_copy.GetColumn(0,"BSU"))));
			ds_buj_cd.Filter("BSU=="+quote(TRIM(ds_cond_copy.GetColumn(0,"BSU"))));
		} else {
			ds_juj_cd.Filter("1==1");
			ds_buj_cd.Filter("1==1");
		}

		fn_query2();
	} else if( obj.TabIndex == 2 ) {
		tmp_idx = tab_idx;
		tab_idx = "2";
		ufn_enableBtn("query", false);
		ufn_enableBtn("input", false);
		ufn_enableBtn("delete", false);
		ufn_enableBtn("save", false);
		fn_query4();
		return;
	} else if( obj.TabIndex == 3) {
		tmp_idx = tab_idx;
		tab_idx = "3";
//		if(user_grp == "20" || user_grp == '30')
		if(user_grp == "20") {
			ufn_enableBtn("query", false);
			ufn_enableBtn("input", true);
			ufn_enableBtn("delete", true);
			ufn_enableBtn("save", true);
		} else {
			ufn_enableBtn("query", false);
			ufn_enableBtn("input", true);
			ufn_enableBtn("delete", true);
			ufn_enableBtn("save", true);
		}

		//코드콤보 설정 : 고객정보
		var codeArr = ["CS118"];
		var dsObjArr = [ds_cus_cd];
		var addTypeArr = [G_CODE_ALL];
		gfn_searchCommCode(codeArr, dsObjArr, addTypeArr);
		fn_query3();
	} else {
		tmp_idx = tab_idx;
		tab_idx = "0";
		ufn_enableBtn("query", true);
		ufn_enableBtn("input", false);
		ufn_enableBtn("delete", false);
//		if(user_grp == '20'  || user_grp == '30')
		if(user_grp == '20') {
			ufn_enableBtn("save", false);
		} else {
			//ufn_enableBtn("save", true);
			ufn_enableBtn("save", false);
		}

		return;
	}	
}

/********************************************************************************
* 기      능   : 그리드에서 날짜 입력시 
********************************************************************************/
function grd_list2_OnExpandEdit(obj,nRow,nCell,strVal,nPivotIndex)
{
/*
	var rect = obj.GetCellRect(nRow, ncell);

	cal_temp.top = rect[1] + 70;
	cal_temp.Left = rect[0] + 20; 
	cal_temp.Visible = true;
*/
	var rect = obj.GetCellRect(nRow, ncell);

	cal_temp.top = rect[1] + 100;
	if (cal_temp.top > 400)
	{
		cal_temp.top = 400;
	}
	cal_temp.Left = rect[0] + 20; 
	if (cal_temp.Left > 790)
	{
		cal_temp.Left = 790;
	}	 
	cal_temp.Visible = true;

	if(nCell == 10) {
		cal_temp.value = ds_list2.getColumn(nRow, "CS101_BYD");
	} else if (nCell == 12) {
		cal_temp.value = ds_list2.getColumn(nRow, "CS101_IJY");
	}
	cal_temp.SetFocus();
}
/********************************************************************************
* 기      능   : 달력에서 일자 선택했을 경우 
********************************************************************************/
function cal_temp_OnDayClick(obj,strText)
{
	if(Tab00.tab2.grd_list2.GetClickedCell() == 10)
		ds_list2.SetColumn(ds_list2.row, "CS101_BYD", strText);
	else if (Tab00.tab2.grd_list2.GetClickedCell() == 12)
		ds_list2.SetColumn(ds_list2.row, "CS101_IJY", strText);
	obj.Visible = false;
}
/********************************************************************************
* 기      능   : 달력에서 포커스 잃었을 경우 
********************************************************************************/
function cal_temp_OnKillFocus(obj)
{
	obj.Visible = false;
}

/********************************************************************************
* 기      능   : 원프로젝트 팝업
********************************************************************************/
function btn_pjt_OnClick(obj)
{
	var arg = "pjt="+quote(ed_pjt.Text);
	gfn_openPopup("CS9601002A",true,arg);
}

function Tab00_tab4_grd_list_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
{
	gfn_sortGrid(obj,nCell);	
}

/********************************************************************************
* 기      능   : 액셀  
********************************************************************************/
function fn_excel() {
	gfn_saveToExcel(Tab00.tab1.grd_list, true );
}

function Tab00_tab2_grd_list2_OnCellClick(obj,nRow,nCell,nX,nY,nPivotIndex) {
	if(nCell == 6) {
		var arg = "pjt=" + quote(ds_list2.GetColumn(ds_list2.currow, "CS101_PJT")) + 
					" hno=" + quote(ds_list2.GetColumn(ds_list2.currow, "CS101_HNO")) + 
					" user_id=" + quote(G_USER_ID);

		gfn_openPopup("CS9608001A", true, arg);
	// 성적서 유형
	} else if(nCell == 9) {
		var t_hno = ds_list2.GetColumn(nRow, "CS101_PJT") + ds_list2.GetColumn(nRow, "CS101_HNO");
		var gbn = substr(ds_list2.GetColumn(nRow, "CS101_HNO"), 0, 1);
		var pjt = ds_list2.GetColumn(nRow, "CS101_PJT");
		var hno = t_hno;

		fn_goNextForm(gbn,pjt,hno);
	} else if(nCell == 16) { // 호기정보 및 고객정보 등록 시에만 문제점 보고 작성 가능
		//필수 체크 해제 요청 기획팀 김나영 사원 20160517
		// if (ds_list2.GetColumn(nRow,"CHK_HNOINFO") == "Y") {
			// gfn_showAlert( nRow + 1 +  "번째 호기의 호기명을 저장하신 후 작성하십시오." );
			// return;		
		// } 
		// if (ds_list2.GetColumn(nRow,"CHK_CSTINFO") == "Y") {
			// gfn_showAlert( "고객정보를 등록하신 후 작성하십시오." );
			// return;		
		// }
		
		ds_list2.row = nRow;
		//var arg = "pjt="+quote(ed_pjt.Text);
		gfn_openPopup("CS0605001A",true);
				
	} else if(nCell == 17) {
		ds_list2.row = nRow;
		//var arg = "pjt="+quote(ed_pjt.Text);
		gfn_openPopup("CS0605002A",true);
	}
}

/********************************************************************************
* 기      능   : 검사 성적서 신규 변경 20180123 이하림 ( 김종욱 요청 )
********************************************************************************/
function fn_goNextForm(gbn,pjt,hno) {
	var formID = "";

	switch (gbn) {

		case 'L':
			formID = "PS0102001L";
			break;			

		case 'S':
			formID = "PS0102001S";
			break;
			
		case 'W':
			formID = "PS0102001S";
			break;

	}

	var arg = "PRE_GBN="+quote(gbn);
	    arg += " PRE_PJT="+quote(pjt);
		arg += " PRE_HNO="+quote(hno);
	
	gfn_openPopup(formID, true, arg);
}

function fn_changeFlag(fdt,nCell) {
//	if(length(fdt) == 0 || user_grp == '20' || user_grp == '30') {
//	if(length(fdt) == 0 || user_grp == '20') {
	if(length(fdt) == 0) {
		return "none";
	} else if(length(fdt) <> 0 && nCell == 5) {
		return "numchar";
	}
	else{
		return "normal";
	}
}

function fn_ChangeIcon(fdt)
{
//	if(length(fdt) == 0 || user_grp == '20' || user_grp == '30') {
//	if(length(fdt) == 0 || user_grp == '20') {
	if(length(fdt) == 0 ) {
		return "";
	} else {
		return "icon_grid_edit";
	}	
}

function fn_changeCal(fdt)
{
//	if(length(fdt) == 0 || user_grp == '20' || user_grp == '30') {
//	if(length(fdt) == 0 || user_grp == '20') {
	if(length(fdt) == 0 ) {
		return "false";
	} else {
		return "true";
	}	
}

function fn_changeCombo(fdt)
{
//	if(length(fdt) == 0 || user_grp == '20' || user_grp == '30') {
//	if(length(fdt) == 0 || user_grp == '20') {
	if(length(fdt) == 0 ) {
		return "none";
	} else {
		return "combo";
	}	
}

function Tab00_tab2_grd_list2_OnCellDblClick(obj,nRow,nCell,nX,nY,nPivotIndex) {
	if(nCell == 3) {
		var arg = "pjt=" + quote(ds_list2.GetColumn(ds_list2.currow, "CS101_PJT")) + 
					" hno=" + quote(ds_list2.GetColumn(ds_list2.currow, "CS101_HNO")) + 
					" user_id=" + quote(G_USER_ID);

		gfn_openPopup("CS9608001A", true, arg);
	} else if(nCell == 30 || nCell == 31 || nCell == 32) {
		gfn_openPopup("PS0101001C",true);
	}
}

function Tab00_tab1_grd_list_OnCellDblClick(obj,nRow,nCell,nX,nY,nPivotIndex) {
	if(nCell == 5) {
		var arg = "posid="+quote(ds_list.GetColumn(nRow,"CS101_PJT"));
		gfn_openWin("WB0199061A",arg);
	}

	if(nCell == "7") { // 인수증 인쇄
		if(substr(ds_list.GetColumn(ds_list.row,"CS101_PJT"),0,1) <> "M") {
			ds_cond6.SetColumn(0,"POSID",ds_list.GetColumn(ds_list.row,"CS101_PJT"));
			ds_cond6.SetColumn(0,"CS101_BSU",ds_list.GetColumn(ds_list.row,"CS101_BSU"));
			ds_cond6.SetColumn(0,"CS101_FDT",ds_list.GetColumn(ds_list.row,"CS101_FDT"));
	
			tit_clearActionInfo();
			tit_addSearchActionInfo("cs06:CS0603001B_S4");
			tit_callService(
				""
				, ""
				, "ds_cond6=ds_cond6"
				, "ds_list6=ds_list6"
				, ""
				, "fn_afterReport1"
				, true);
		} else {
			gfn_showAlert("타사현장(M프로젝트)은 인수증 출력을 할수 없습니다.");
			return;
		}
	}

	if(nCell == "8") { // 무상보수 하도급 승인서 인쇄
		if(substr(ds_list.GetColumn(ds_list.row,"CS101_PJT"),0,1) <> "M") {
			ds_cond6.SetColumn(0,"POSID",ds_list.GetColumn(ds_list.row,"CS101_PJT"));
			ds_cond6.SetColumn(0,"CS101_BSU",ds_list.GetColumn(ds_list.row,"CS101_BSU"));
			ds_cond6.SetColumn(0,"CS101_FDT",ds_list.GetColumn(ds_list.row,"CS101_FDT"));
	
			tit_clearActionInfo();
			tit_addSearchActionInfo("cs06:CS0603001B_S5");
			tit_callService(
				""
				, ""
				, "ds_cond6=ds_cond6"
				, "ds_report=ds_report"
				, ""
				, "fn_afterReport2"
				, true);
		} else {
			gfn_showAlert("타사현장(M프로젝트)은 무상보수 하도급 승인서 출력을 할수 없습니다.");
			return;
		}
	}
}

/********************************************************************************
* 기      능   : 조회 Callback  
********************************************************************************/
function fn_afterReport1(errCode, errMsg) {
	Dialog("CS06::CS0603001B.xml", "");
}

function fn_afterReport2(errCode, errMsg) {
	Dialog("CS06::CS0602001B.xml", "");
}
]]></Script>
</Window>