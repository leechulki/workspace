<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="608" Id="CS0605001A" Left="8" OnLoadCompleted="fn_OnLoadCompleted" OnUnloadCompleted="fn_OnUnloadCompleted" PidAttrib="7" Title="문제점보고서&#32;작성" Top="8" Ver="1.0" Width="846" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_cond">
				<Contents>
					<colinfo id="POSID" size="255" summ="default" type="STRING"/>
					<colinfo id="HNO" size="256" summ="default" type="STRING"/>
					<colinfo id="PARTID" size="256" summ="default" type="STRING"/>
					<record>
						<HNO></HNO>
						<PARTID></PARTID>
						<POSID></POSID>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list" OnColumnChanged="ds_list_OnColumnChanged">
				<Contents>
					<colinfo id="CS108_SCT" size="256" summ="default" type="STRING"/>
					<colinfo id="CS108_QIC" size="256" summ="default" type="STRING"/>
					<colinfo id="CS106_QMR" size="256" summ="default" type="STRING"/>
					<colinfo id="CS108_QII" size="256" summ="default" type="STRING"/>
					<colinfo id="CS108_QAD" size="256" summ="default" type="STRING"/>
					<colinfo id="CS108_JYD" size="256" summ="default" type="STRING"/>
					<colinfo id="CS108_JCD" size="256" summ="default" type="STRING"/>
					<colinfo id="CS108_JCR" size="256" summ="default" type="STRING"/>
					<colinfo id="FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="CS106_MIR" size="256" summ="default" type="STRING"/>
					<colinfo id="CS108_PJT" size="256" summ="default" type="STRING"/>
					<colinfo id="CS108_HNO" size="256" summ="default" type="STRING"/>
					<colinfo id="CS108_QAD_PATH" size="256" summ="default" type="STRING"/>
					<colinfo id="CS108_JAD" size="256" summ="default" type="STRING"/>
					<colinfo id="CS108_JAD_PATH" size="256" summ="default" type="STRING"/>
					<colinfo id="CS108_TXT_QC" size="256" summ="default" type="STRING"/>
					<colinfo id="CS108_NTC_QC" size="256" summ="default" type="STRING"/>
					<colinfo id="CS108_NTC_QC_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="CS108_RSN_NTC_QC" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list_h">
				<Contents>
					<colinfo id="CS101_PJT" size="256" summ="default" type="STRING"/>
					<colinfo id="CS101_HNO" size="256" summ="default" type="STRING"/>
					<colinfo id="CS101_HNA" size="256" summ="default" type="STRING"/>
					<colinfo id="MM028_CTEXT2" size="256" summ="default" type="STRING"/>
					<colinfo id="NAME1" size="256" summ="default" type="STRING"/>
					<colinfo id="CS107_VSM" size="256" summ="default" type="STRING"/>
					<colinfo id="CS107_JSD" size="256" summ="default" type="STRING"/>
					<colinfo id="CS107_JID" size="256" summ="default" type="STRING"/>
					<colinfo id="CS107_PST" size="256" summ="default" type="STRING"/>
					<colinfo id="CS107_VSD" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSITE_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="KUNNR_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="CS107_PST_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="CS107_BGO" size="256" summ="default" type="STRING"/>
					<colinfo id="PST_GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="CS107_VSD_QC" size="256" summ="default" type="STRING"/>
					<colinfo id="CS107_VSM_QC" size="256" summ="default" type="STRING"/>
					<colinfo id="CS107_JSD_QC" size="256" summ="default" type="STRING"/>
					<colinfo id="CS107_JID_QC" size="256" summ="default" type="STRING"/>
					<colinfo id="CS107_NTC_QC" size="256" summ="default" type="STRING"/>
					<colinfo id="CS107_VSD_PS" size="256" summ="default" type="STRING"/>
					<colinfo id="CS107_VSM_PS" size="256" summ="default" type="STRING"/>
					<colinfo id="CS107_JSD_PS" size="256" summ="default" type="STRING"/>
					<colinfo id="CS107_JID_PS" size="256" summ="default" type="STRING"/>
					<colinfo id="MM028_CTEXT6" size="256" summ="default" type="STRING"/>
					<colinfo id="NAME6" size="256" summ="default" type="STRING"/>
					<colinfo id="GBU" size="256" summ="default" type="STRING"/>
					<colinfo id="JUJ_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="JUJ_TEL" size="256" summ="default" type="STRING"/>
					<colinfo id="CS107_CON_QC" size="256" summ="default" type="STRING"/>
					<colinfo id="CELLP" size="256" summ="default" type="STRING"/>
					<colinfo id="CS107_RMK_PS" size="256" summ="default" type="STRING"/>
					<colinfo id="CELLP2" size="256" summ="default" type="STRING"/>
					<colinfo id="CELLP3" size="256" summ="default" type="STRING"/>
					<colinfo id="CELLP4" size="256" summ="default" type="STRING"/>
					<colinfo id="CELLP5" size="256" summ="default" type="STRING"/>
					<colinfo id="CS107_ESD_PS" size="256" summ="default" type="STRING"/>
					<colinfo id="CS107_CYN" size="256" summ="default" type="STRING"/>
					<colinfo id="PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="CS107_RSN_QC" size="256" summ="default" type="STRING"/>
					<colinfo id="CS107_RSN_QC_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="PAPRID" size="256" summ="default" type="STRING"/>
					<colinfo id="CS101_RCD" size="256" summ="default" type="STRING"/>
					<colinfo id="CS101_IGD" size="256" summ="default" type="STRING"/>
					<colinfo id="CS107_QJD" size="256" summ="default" type="STRING"/>
					<colinfo id="NAMET2" size="256" summ="default" type="STRING"/>
					<colinfo id="PAPRIDTX" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_notice_cd">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_save" OnColumnChanged="ds_list_OnColumnChanged">
				<Contents>
					<colinfo id="FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="PJT" size="256" summ="default" type="STRING"/>
					<colinfo id="HNO" size="256" summ="default" type="STRING"/>
					<colinfo id="ABG" size="256" summ="default" type="STRING"/>
					<colinfo id="AGB" size="256" summ="default" type="STRING"/>
					<colinfo id="ARA" size="256" summ="default" type="STRING"/>
					<colinfo id="BSU" size="256" summ="default" type="STRING"/>
					<colinfo id="BPM" size="256" summ="default" type="STRING"/>
					<colinfo id="BGT" size="256" summ="default" type="STRING"/>
					<colinfo id="BHD" size="256" summ="default" type="STRING"/>
					<colinfo id="CBS" size="256" summ="default" type="STRING"/>
					<colinfo id="FDT" size="256" summ="default" type="STRING"/>
					<colinfo id="GND" size="256" summ="default" type="STRING"/>
					<colinfo id="HTY" size="256" summ="default" type="STRING"/>
					<colinfo id="JUC" size="256" summ="default" type="STRING"/>
					<colinfo id="MON" size="256" summ="default" type="STRING"/>
					<colinfo id="PST" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSPEC1" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSPEC" size="256" summ="default" type="STRING"/>
					<colinfo id="GBU" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list3" OnColumnChanged="ds_list_OnColumnChanged">
				<Contents>
					<colinfo id="FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="TRAN_PHONE" size="256" summ="default" type="STRING"/>
					<colinfo id="TRAN_CALLBACK" size="256" summ="default" type="STRING"/>
					<colinfo id="TRAN_STATUS" size="256" summ="default" type="STRING"/>
					<colinfo id="TRAN_DATE" size="256" summ="default" type="STRING"/>
					<colinfo id="TRAN_MSG" size="256" summ="default" type="STRING"/>
					<colinfo id="TRAN_SUBJECT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_sms" OnColumnChanged="ds_list_OnColumnChanged">
				<Contents>
					<colinfo id="FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="TRAN_PHONE" size="256" summ="default" type="STRING"/>
					<colinfo id="TRAN_CALLBACK" size="256" summ="default" type="STRING"/>
					<colinfo id="TRAN_STATUS" size="256" summ="default" type="STRING"/>
					<colinfo id="TRAN_DATE" size="256" summ="default" type="STRING"/>
					<colinfo id="TRAN_MSG" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_confirm_cd">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME>-&#32;선택&#32;-</CODE_NAME>
					</record>
					<record>
						<CODE>1</CODE>
						<CODE_NAME>처리완료</CODE_NAME>
					</record>
					<record>
						<CODE>2</CODE>
						<CODE_NAME>처리미완료</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_confirm" OnColumnChanged="ds_list_OnColumnChanged">
				<Contents>
					<colinfo id="CS107_PJT" size="256" summ="default" type="STRING"/>
					<colinfo id="CS107_HNO" size="256" summ="default" type="STRING"/>
					<colinfo id="CS107_CYN" size="256" summ="default" type="STRING"/>
					<record>
						<CS107_CYN></CS107_CYN>
						<CS107_HNO></CS107_HNO>
						<CS107_PJT></CS107_PJT>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_rsn">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_MailRvcList">
				<Contents>
					<colinfo id="ATTN_ID" size="255" summ="default" type="STRING"/>
					<colinfo id="ATTN" size="256" summ="default" type="STRING"/>
					<colinfo id="MAILADR" size="256" summ="default" type="STRING"/>
					<colinfo id="RCV_CODE" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_rcond">
				<Contents>
					<colinfo id="ZPROGRAM" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN" size="256" summ="default" type="STRING"/>
					<record>
						<GBN></GBN>
						<ZPROGRAM></ZPROGRAM>
					</record>
				</Contents>
			</Dataset>
		</Datasets>
		<Shape BKColor="user12" Bottom="600" Height="51" Id="Shape5" Left="7" LineColor="user13" Right="837" TabOrder="22" Top="549" Type="Rectangle" Width="830"></Shape>
		<Shape BKColor="user0" Bottom="88" Height="52" Id="Shape0" Left="0" LineColor="user1" Right="846" TabOrder="1" Top="36" Type="Rectangle" Width="846"></Shape>
		<Static Align="Right" Height="20" Id="Static0" Left="5" Style="sty_lb_search" TabOrder="2" Text="Proj&#32;No&#32;" Top="41" VAlign="Middle" Width="80"></Static>
		<Static Align="Right" Height="20" Id="Static7" Left="5" Style="sty_lb_search" TabOrder="5" Text="호기&#32;" Top="63" VAlign="Middle" Width="80"></Static>
		<Static Align="Right" Height="20" Id="Static1" Left="159" Style="sty_lb_search" TabOrder="4" Text="고객명&#32;" Top="41" VAlign="Middle" Width="80"></Static>
		<Static Align="Right" Height="20" Id="Static6" Left="159" Style="sty_lb_search" TabOrder="6" Text="호기명&#32;" Top="63" VAlign="Middle" Width="80"></Static>
		<Edit Border="Flat" Enable="FALSE" Height="20" Id="ed_pjt" Left="87" Style="sty_ipt_search" TabOrder="3" Top="41" Width="70"></Edit>
		<Edit Border="Flat" Enable="FALSE" Height="20" Id="ed_hno" Left="87" Style="sty_ipt_search" TabOrder="7" Top="63" Width="70"></Edit>
		<Edit Border="Flat" Enable="FALSE" Height="20" Id="ed_hna" Left="241" Style="sty_ipt_search" TabOrder="9" Top="63" Width="182"></Edit>
		<Edit BindDataset="ds_list_h" Border="Flat" Column="KUNNR_NM" Enable="FALSE" Height="20" Id="Edit3" Left="241" Style="sty_ipt_search" TabOrder="8" Top="41" Width="182"></Edit>
		<Edit BindDataset="ds_list_h" Border="Flat" Column="ZSITE_NM" Enable="FALSE" Height="20" Id="Edit4" Left="507" Style="sty_ipt_search" TabOrder="10" Top="41" Width="158"></Edit>
		<Shape BKColor="user12" Bottom="117" Height="26" Id="Shape1" Left="7" LineColor="user13" Right="837" TabOrder="11" Top="91" Type="Rectangle" Width="830"></Shape>
		<Static Align="Right" Height="24" Id="Static14" Left="526" Style="sty_lb_form_basic" TabOrder="14" Text="보수협력&#32;" Top="92" VAlign="Middle" Width="86"></Static>
		<Static Align="Right" Height="24" Id="Static11" Left="311" Style="sty_lb_form_basic" TabOrder="13" Text="지역&#32;" Top="92" VAlign="Middle" Width="90"></Static>
		<Static Align="Right" Height="24" Id="st_vsd" Left="104" Style="sty_lb_form_basic" TabOrder="12" Text="방문일&#32;" Top="92" VAlign="Middle" Width="86"></Static>
		<Edit BindDataset="ds_list_h" Border="Flat" Column="MM028_CTEXT2" Enable="FALSE" Height="20" Id="Edit6" Left="403" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="15" Top="94" Width="97"></Edit>
		<Edit BindDataset="ds_list_h" Border="Flat" Column="NAME1" Enable="FALSE" Height="20" Id="Edit7" Left="614" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="16" Top="94" Width="214"></Edit>
		<Shape BKColor="user12" Bottom="143" Height="27" Id="Shape2" Left="7" LineColor="user13" Right="837" TabOrder="17" Top="116" Type="Rectangle" Width="830"></Shape>
		<Static Align="Right" Height="24" Id="Static5" Left="311" Style="sty_lb_form_basic" TabOrder="20" Text="작성일&#32;" Top="117" VAlign="Middle" Width="90"></Static>
		<Static Align="Right" Height="24" Id="st_vsm" Left="104" Style="sty_lb_form_basic" TabOrder="18" Text="방문자&#32;" Top="117" VAlign="Middle" Width="86"></Static>
		<Edit BindDataset="ds_list_h" Border="Flat" Column="CS107_VSM" Height="20" Id="ed_vsm" Left="192" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="19" Top="119" Width="97"></Edit>
		<Grid AutoEnter="TRUE" AutoFitEndLine="Hide" BindDataset="ds_list" BkColor2="default" BoldHead="true" Border="Flat" Bottom="543" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="239" Id="grd_list" InputPanel="FALSE" Left="8" LineColor="user20" LineType="ExHORZ" OnExpandEdit="grd_list_OnExpandEdit" Right="838" RowHeight="20" Style="sty_grid" TabOrder="24" TabStop="true" Top="304" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="830">
			<contents>
				<format id="Default">
					<columns>
						<col width="20"/>
						<col width="40"/>
						<col width="0"/>
						<col width="60"/>
						<col width="100"/>
						<col width="160"/>
						<col width="120"/>
						<col width="75"/>
						<col width="50"/>
						<col width="50"/>
						<col width="186"/>
						<col width="80"/>
						<col width="90"/>
						<col width="80"/>
						<col width="186"/>
						<col width="100"/>
					</columns>
					<head>
						<cell align="center" col="0" color="user21" display="text" font="굴림,9"/>
						<cell align="center" col="1" color="user21" display="text" font="굴림,9" text="NO"/>
						<cell align="center" col="2" color="user21" display="text" font="굴림,9" text="설치부통보"/>
						<cell align="center" col="3" color="user21" display="text" font="굴림,9" text="검사개소"/>
						<cell align="center" col="4" color="user21" display="text" font="굴림,9" text="검사항목"/>
						<cell align="center" col="5" color="user21" display="text" font="굴림,9" text="중점내용"/>
						<cell align="center" col="6" color="user21" display="text" font="굴림,9" text="문제점"/>
						<cell align="center" col="7" color="user21" display="text" font="굴림,9" text="문제점이미지"/>
						<cell align="center" col="8" color="user21" display="text" font="굴림,9" text="원인부서"/>
						<cell align="center" col="9" color="user21" display="text" font="굴림,9" text="조치부서"/>
						<cell align="center" col="10" color="user21" display="text" font="굴림,9" text="조치계획"/>
						<cell align="center" col="11" color="user21" display="text" font="굴림,9" text="조치예정일"/>
						<cell align="center" col="12" color="user21" display="text" font="굴림,9" text="발생사유"/>
						<cell align="center" col="13" color="user21" display="text" font="굴림,9" text="조치일"/>
						<cell align="center" col="14" color="user21" display="text" font="굴림,9" text="조치결과"/>
						<cell align="center" col="15" color="user21" display="text" font="굴림,9" text="조치결과이미지"/>
					</head>
					<body>
						<cell align="center" bkcolor2="user22" bkimageid='expr:gfn_getFlagBkImageID(getColumn(currow,&#32;&quot;FLAG&quot;))' col="0" colid="FLAG" display="text"/>
						<cell align="center" bkcolor2="user22" col="1" display="text" expr="currow+1"/>
						<cell bkcolor2="user22" col="2" colid="CS108_SCT" display="checkbox" edit='expr:fn_changeSct(getColumn(currow,&#32;&quot;CS108_QIC&quot;))'/>
						<cell align="center" bkcolor2="user22" col="3" colid="CS108_QIC" display="text"/>
						<cell align="left" bkcolor2="user22" col="4" colid="CS106_QMR" display="text"/>
						<cell bkcolor2="user22" col="5" colid="CS106_MIR" display="text"/>
						<cell align="left" bkcolor2="user22" bkimagealign="right" bkimageid='expr:fn_changeQii2(getColumn(currow,&#32;&quot;CS108_QIC&quot;))' checklength="Byte" col="6" colid="CS108_QII" display="text" edit='expr:fn_changeQii(getColumn(currow,&#32;&quot;CS108_QIC&quot;))' limit="100"/>
						<cell bkcolor2="user22" col="7" colid="CS108_QAD" display="text" expandimage="btn_icon_next_01" expandshow='expr:fn_changeQad(getColumn(currow,&#32;&quot;CS108_QIC&quot;))'/>
						<cell align="left" bkcolor2="user22" bkimagealign="right" bkimageid='expr:fn_changeJcr3(GetColumn(currow,&quot;CS108_SCT&quot;))' checklength="Byte" col="8" colid="CS108_RSN_NTC_QC" combocol="CODE" combodataset="ds_notice_cd" combotext="CODE_NAME" display="combo" edit='expr:fn_changeJcd4(GetColumn(currow,&quot;CS108_SCT&quot;))' limit="100"/>
						<cell align="left" bkcolor2="user22" bkimagealign="right" bkimageid='expr:fn_changeJcr3(GetColumn(currow,&quot;CS108_SCT&quot;))' checklength="Byte" col="9" colid="CS108_NTC_QC" combocol="CODE" combodataset="ds_notice_cd" combotext="CODE_NAME" display="combo" edit='expr:fn_changeJcd4(GetColumn(currow,&quot;CS108_SCT&quot;))' limit="100"/>
						<cell align="left" bkcolor2="user22" bkimagealign="right" bkimageid='expr:fn_changeJcr3(GetColumn(currow,&quot;CS108_SCT&quot;))' checklength="Byte" col="10" colid="CS108_TXT_QC" display="text" edit='expr:fn_changeJcd3(GetColumn(currow,&quot;CS108_SCT&quot;))' limit="100"/>
						<cell bkcolor2="user22" col="11" colid="CS108_JYD" display="text" expandimage="btn_grid_icon_pen" expandshow='expr:fn_changeJcd2(GetColumn(currow,&quot;CS108_SCT&quot;))' expandsize="18" Mask="####.##.##"/>
						<cell align="left" bkcolor2="user22" bkimagealign="right" bkimageid='expr:fn_changeJcr3(GetColumn(currow,&quot;CS108_SCT&quot;))' checklength="Byte" col="12" colid="CS108_RSN_QC" combocol="CODE" combodataset="ds_rsn" combotext="CODE_NAME" display="combo" edit='expr:fn_changeJcd4(GetColumn(currow,&quot;CS108_SCT&quot;))' limit="100"/>
						<cell bkcolor2="user22" col="13" colid="CS108_JCD" display="text" expandimage="btn_grid_icon_pen" expandshow='expr:fn_changeJcd(GetColumn(currow,&quot;CS108_SCT&quot;))' expandsize="18" Mask="####.##.##"/>
						<cell align="left" bkcolor2="user22" bkimagealign="right" bkimageid='expr:fn_changeJcr2(GetColumn(currow,&quot;CS108_SCT&quot;))' checklength="Byte" col="14" colid="CS108_JCR" display="text" edit='expr:fn_changeJcr(GetColumn(currow,&quot;CS108_SCT&quot;))' limit="100"/>
						<cell bkcolor2="user22" col="15" colid="CS108_JAD" display="text" expandimage="btn_icon_next_01" expandshow='expr:fn_changeQad(getColumn(currow,&#32;&quot;CS108_QIC&quot;))'/>
					</body>
				</format>
			</contents>
		</Grid>
		<Static Align="Right" Height="49" Id="Static10" Left="8" Style="sty_lb_form_basic" TabOrder="21" Text="내용&#32;" Top="550" VAlign="Middle" Width="86"></Static>
		<TextArea BindDataset="ds_list_h" Border="Flat" CheckLength="Byte" Column="CS107_BGO" Height="45" Id="TextArea00" Left="96" MaxLength="255" Style="sty_ipt_form" TabOrder="23" Top="552" VScroll="TRUE" Width="738"></TextArea>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_point_del" ImageID="btn_sub_09" Left="703" LeftMargin="12" OnClick="btn_point_del_OnClick" Style="sty_btn" TabOrder="25" Text="문제점검사항목삭제" Top="279" Transparent="TRUE" Width="131"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_point_add" ImageID="btn_sub_09" Left="570" LeftMargin="12" OnClick="btn_point_add_OnClick" Style="sty_btn" TabOrder="26" Text="문제점검사항목추가" Top="279" Transparent="TRUE" Width="131"></Button>
		<Calendar BindDataset="ds_list_h" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="CS107_VSD" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_cs107_vsd" Left="192" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="27" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="94" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="97"></Calendar>
		<Div Height="36" Id="div_btn" TabOrder="28" Text="Div0" ToolTipFont="Default,0" Url="WB01::CommBtnForm.xml" Width="846">
			<Contents></Contents>
		</Div>
		<MaskEdit BindDataset="ds_list_h" Border="Flat" Column="CS107_JSD" Enable="FALSE" Height="20" Id="med_hogif" Left="403" LeftMargin="4" Mask="####.##.##" MaxLength="10" RightMargin="4" Style="sty_ipt_form" TabOrder="29" Top="119" Type="STRING" Width="97"></MaskEdit>
		<Calendar Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="146" Id="cal_temp" Left="880" MonthOnly="TRUE" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" OnDayClick="cal_temp_OnDayClick" OnKillFocus="cal_temp_OnKillFocus" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="31" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="136" Value="20130415" Visible="FALSE" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="152"></Calendar>
		<FileDialog Bottom="320" Height="24" Id="fileDialog" Left="884" Right="908" TabOrder="34" Top="296" Width="24"></FileDialog>
		<Static Height="19" Id="st_jyd" Left="80" TabOrder="31" Text="조치예정일" Top="670" Visible="FALSE" Width="70"></Static>
		<Static Height="25" Id="st_jcd" Left="168" TabOrder="32" Text="조치일" Top="680" Visible="FALSE" Width="62"></Static>
		<Static Height="23" Id="st_jcr" Left="236" TabOrder="33" Text="조치결과" Top="674" Visible="FALSE" Width="74"></Static>
		<Static Height="15" Id="st_qii" Left="22" TabOrder="34" Text="문제점" Top="681" Visible="FALSE" Width="52"></Static>
		<File Bottom="320" Height="24" Id="f_tmp" Left="953" Right="977" TabOrder="38" Top="296" Width="24"></File>
		<Shape BKColor="user12" Bottom="194" Height="26" Id="Shape3" Left="7" LineColor="user13" Right="837" TabOrder="35" Top="168" Type="Rectangle" Width="830"></Shape>
		<Static Align="Right" Height="24" Id="st_ntc_qc" Left="311" Style="sty_lb_form_basic" TabOrder="37" Text="QC통보부서" Top="169" VAlign="Middle" Width="90"></Static>
		<Static Align="Right" Height="24" Id="st_vsd_qc" Left="104" Style="sty_lb_form_basic" TabOrder="36" Text="방문일&#32;" Top="169" VAlign="Middle" Width="86"></Static>
		<Shape BKColor="user12" Bottom="219" Height="26" Id="Shape4" Left="7" LineColor="user13" Right="837" TabOrder="38" Top="193" Type="Rectangle" Width="830"></Shape>
		<Static Align="Right" Height="24" Id="Static16" Left="311" Style="sty_lb_form_basic" TabOrder="41" Text="작성일&#32;" Top="194" VAlign="Middle" Width="90"></Static>
		<Static Align="Right" Height="24" Id="st_vsm_qc" Left="104" Style="sty_lb_form_basic" TabOrder="39" Text="방문자&#32;" Top="194" VAlign="Middle" Width="86"></Static>
		<Edit BindDataset="ds_list_h" Border="Flat" Column="CS107_VSM_QC" Height="20" Id="ed_vsm_qc" Left="192" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="40" Top="196" Width="97"></Edit>
		<Calendar BindDataset="ds_list_h" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="CS107_VSD_QC" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_cs107_vsd_qc" Left="192" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="42" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="170" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="97"></Calendar>
		<MaskEdit BindDataset="ds_list_h" Border="Flat" Column="CS107_JSD_QC" Enable="FALSE" Height="20" Id="MaskEdit0" Left="403" LeftMargin="4" Mask="####.##.##" MaxLength="10" RightMargin="4" Style="sty_ipt_form" TabOrder="43" Top="196" Type="STRING" Width="97"></MaskEdit>
		<Static Align="Center" BKColor="user40" Height="49" Id="st_qc" Left="8" Style="sty_lb_form_basic" TabOrder="44" Text="QC" Top="169" VAlign="Middle" Width="95"></Static>
		<Shape BKColor="user12" Bottom="246" Height="26" Id="Shape6" Left="7" LineColor="user13" Right="837" TabOrder="45" Top="220" Type="Rectangle" Width="830"></Shape>
		<Static Align="Right" Height="24" Id="Static20" Left="311" Style="sty_lb_form_basic" TabOrder="47" Text="대지역&#32;" Top="221" VAlign="Middle" Width="90"></Static>
		<Static Align="Right" Height="24" Id="st_vsd_ps" Left="104" Style="sty_lb_form_basic" TabOrder="46" Text="작업예정일&#32;" Top="221" VAlign="Middle" Width="86"></Static>
		<Edit BindDataset="ds_list_h" Border="Flat" Column="MM028_CTEXT6" Enable="FALSE" Height="20" Id="Edit8" Left="403" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="48" Top="223" Width="97"></Edit>
		<Shape BKColor="user12" Bottom="271" Height="26" Id="Shape7" Left="7" LineColor="user13" Right="837" TabOrder="49" Top="245" Type="Rectangle" Width="830"></Shape>
		<Static Align="Right" Height="24" Id="st_esd_ps" Left="311" Style="sty_lb_form_basic" TabOrder="52" Text="작업완료일&#32;" Top="246" VAlign="Middle" Width="90"></Static>
		<Static Align="Right" Height="24" Id="st_vsm_ps" Left="104" Style="sty_lb_form_basic" TabOrder="50" Text="작업자&#32;" Top="246" VAlign="Middle" Width="86"></Static>
		<Edit BindDataset="ds_list_h" Border="Flat" Column="CS107_VSM_PS" Height="20" Id="ed_vsm_ps" Left="192" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="51" Top="248" Width="97"></Edit>
		<Calendar BindDataset="ds_list_h" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="CS107_VSD_PS" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_cs107_vsd_ps" Left="192" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="53" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="223" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="97"></Calendar>
		<Static Align="Center" BKColor="user40" Height="51" Id="st_ps" Left="8" Style="sty_lb_form_basic" TabOrder="54" Text="설치" Top="220" VAlign="Middle" Width="95"></Static>
		<Combo BindDataset="ds_list_h" Border="Flat" CodeColumn="CODE" Column="CS107_NTC_QC" DataColumn="CODE_NAME" DisableBKColor="user5" Height="20" Id="cb_ntc_qc" INDEX="0" InnerDataset="ds_notice_cd" Left="402" Style="sty_ipt_form" TabOrder="55" Top="169" Width="100"></Combo>
		<Static Align="Right" Height="20" Id="Static2" Left="425" Style="sty_lb_search" TabOrder="56" Text="현장명&#32;" Top="41" VAlign="Middle" Width="80"></Static>
		<Static Align="Right" Height="20" Id="Static4" Left="425" Style="sty_lb_search" TabOrder="58" Text="진행단계&#32;" Top="63" VAlign="Middle" Width="80"></Static>
		<Edit BindDataset="ds_list_h" Border="Flat" Column="CS107_PST_NM" Enable="FALSE" Height="20" Id="Edit0" Left="507" Style="sty_ipt_search" TabOrder="57" Top="63" Width="158"></Edit>
		<Static Align="Right" Height="24" Id="Static3" Left="526" Style="sty_lb_form_basic" TabOrder="59" Text="점검자연락처&#32;" Top="117" VAlign="Middle" Width="86"></Static>
		<Edit BindDataset="ds_list_h" Border="Flat" Column="JUJ_NM" Enable="FALSE" Height="20" Id="Edit1" Left="614" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="60" Top="119" Width="100"></Edit>
		<Edit BindDataset="ds_list_h" Border="Flat" Column="JUJ_TEL" Enable="FALSE" Height="20" Id="Edit2" Left="716" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="61" Top="119" Width="100"></Edit>
		<Calendar BindDataset="ds_list_h" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="CS107_CON_QC" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_cs107_con_qc" Left="614" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="63" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="170" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="97"></Calendar>
		<Static Align="Right" Height="24" Id="st_con_qc" Left="526" Style="sty_lb_form_basic" TabOrder="62" Text="조치요청일&#32;" Top="169" VAlign="Middle" Width="86"></Static>
		<Edit BindDataset="ds_list_h" Border="Flat" Column="NAME6" Enable="FALSE" Height="20" Id="Edit9" Left="614" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="64" Top="223" Width="214"></Edit>
		<Static Align="Right" Height="24" Id="Static19" Left="526" Style="sty_lb_form_basic" TabOrder="65" Text="설치협력&#32;" Top="221" VAlign="Middle" Width="86"></Static>
		<Static Align="Right" Height="24" Id="st_cs107_rmk_ps" Left="526" Style="sty_lb_form_basic" TabOrder="66" Text="비고&#32;" Top="246" VAlign="Middle" Width="86"></Static>
		<Edit BindDataset="ds_list_h" Border="Flat" Column="CS107_RMK_PS" Height="20" Id="ed_cs107_rmk_ps" Left="614" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="67" Top="248" Width="215"></Edit>
		<Calendar BindDataset="ds_list_h" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="CS107_ESD_PS" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_cs107_esd_ps" Left="403" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="68" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="248" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="97"></Calendar>
		<Shape BKColor="user12" Bottom="167" Height="27" Id="Shape8" Left="7" LineColor="user13" Right="837" TabOrder="69" Top="140" Type="Rectangle" Width="830"></Shape>
		<Static Align="Right" Height="24" Id="Static8" Left="526" Style="sty_lb_form_basic" TabOrder="70" Text="보수담당자확인" Top="142" VAlign="Middle" Width="86"></Static>
		<Static Align="Center" BKColor="user40" Height="75" Id="st_bsu" Left="8" Style="sty_lb_form_basic" TabOrder="71" Text="보수" Top="92" VAlign="Middle" Width="95"></Static>
		<Combo BindDataset="ds_list_h" Border="Flat" CodeColumn="CODE" Column="CS107_CYN" DataColumn="CODE_NAME" DisableBKColor="user5" Height="20" Id="cb_confirm" INDEX="0" InnerDataset="ds_confirm_cd" Left="613" Style="sty_ipt_form" TabOrder="72" Top="142" Width="100"></Combo>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_confirm" ImageID="btn_sub_02" Left="717" LeftMargin="12" OnClick="btn_confirm_OnClick" Style="sty_btn" TabOrder="73" Text="저장" Top="143" Transparent="TRUE" Width="50"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_report" ImageID="btn_sub_06" Left="474" LeftMargin="12" OnClick="btn_report_OnClick" Style="sty_btn" TabOrder="74" Text="검사지적사항" Top="279" Transparent="TRUE" Width="104"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Enable="FALSE" Height="20" Id="btn_csimg" ImageID="btn_sub_05" Left="378" LeftMargin="12" OnClick="btn_csimg_OnClick" Style="sty_btn" TabOrder="75" Text="이미지&#32;등록" Top="279" Transparent="TRUE" Width="86"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_qcChange" ImageID="btn_sub_06" Left="266" LeftMargin="12" OnClick="btn_qcChange_OnClick" Style="sty_btn" TabOrder="76" Text="조치부서&#32;변경" Top="279" Transparent="TRUE" Visible="FALSE" Width="100"></Button>
		<Static Align="Right" Height="24" Id="Static9" Left="526" Style="sty_lb_form_basic" TabOrder="77" Text="발생사유&#32;" Top="194" VAlign="Middle" Width="86"></Static>
		<Combo BindDataset="ds_list_h" Border="Flat" CodeColumn="CODE" Column="CS107_RSN_QC" DataColumn="CODE_NAME" Height="20" Id="cb_rsn" InnerDataset="ds_rsn" Left="614" Style="sty_ipt_search" TabOrder="78" Top="195" Width="98"></Combo>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_changAuth" ImageID="btn_sub_05" Left="712" LeftMargin="12" OnClick="btn_changAuth_OnClick" Style="sty_btn" TabOrder="79" Text="QC권한" Top="48" Transparent="TRUE" Visible="FALSE" Width="96"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_sendEmail" ImageID="btn_sub_05" Left="896" LeftMargin="12" OnClick="btn_sendEmail_OnClick" Style="sty_btn" TabOrder="80" Text="E-mail" Top="48" Transparent="TRUE" Visible="FALSE" Width="96"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_view" ImageID="btn_sub_11" Left="10" LeftMargin="12" OnClick="btn_view_OnClick" Style="sty_btn" TabOrder="81" Text="검사성적서(검사POINT)" Top="279" Transparent="TRUE" Width="158"></Button>
	</Form>
	<Script><![CDATA[/*
 ******************************************************************************************
 * 기      능   : 
 * 작  성  자   : 
 * 작성  일자   : 
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
#include "LIB::commons.js";	// 공통 스크립트 
#include "LIB::nsfRequest.js";
#include "LIB::common_sd.js";
#include "LIB::common_cs.js";	// 서비스 공통 스크립트
//=========================================================================================
// [ PART 1 ]
// Form에서 사용될 전역변수를 선언
// FORM에서 사용되는 전역변수는 대문자로 작성하며, F_XXX 의 형태를 갖도록 한다. 
//=========================================================================================
var imgUploadFlg = "VIEW"; //권한별 이미지 업로드 여부 "":업로드, "VIEW":보기
var imgUploadFlgJ = "VIEW"; //권한별 이미지 업로드 여부 "":업로드, "VIEW":보기
var auth = "";
var authQC = "" ; // 효율 개선부 체크 201605
var SEND_MAIL_TO_PM = false; // 메일 전송 여부 
var pdchang_visible = false;
//=========================================================================================
// [ PART 2 ]
// Form Loading / Unloading 시 작업 정의
//=========================================================================================
function fn_OnLoadCompleted(obj) {
	// Form 로드 이벤트 맨 첫줄에 기술
	gfn_initForm();
	
	// 공통코드 
	var codeArr = ["CS204"];
	var dsObjArr = [ds_rsn];
	var addTypeArr = [G_CODE_ALL];
	gfn_searchCommCode(codeArr, dsObjArr, addTypeArr);
	
	// QC 판정 부서
	gfn_queryDD07T("ZCS_NTC_CD", ds_notice_cd, "N");
		
	ed_pjt.value = ds_list2.GetColumn(ds_list2.row,"CS101_PJT");
	ed_hno.value = ds_list2.GetColumn(ds_list2.row,"CS101_HNO");
	ed_hna.value = ds_list2.GetColumn(ds_list2.row,"CS101_HNA");

   	auth = gfn_getUserGroup();
   	authQC = auth60;

   	if(G_USER_GROUP_E == "E40" || G_USER_GROUP_E == "E30") {
		auth = "50"; //설치부를 "50"으로 사용
		
		if(authQC == true) {
			auth = "60"; // QC  "60"
		}		
	}
	// 효율개선부 요청으로 설치 협력사도 작성 가능토록 201703 
	if(G_USER_GROUP_E == "E10" ) {
		auth = "50"; //설치부를 "50"으로 사용		
	}
	// 김종욱, 김대식 =>> 설치부 내용도 저장 하도록 변경 201802 
	//======================== QC 권한 버튼 활성화 여부 권한 =======================================
	// if(G_USER_ID == "2021692" || G_USER_ID == "2021706" || G_USER_ID == "2021200" || G_USER_ID == "2023687" || G_USER_ID == "2018900" || G_USER_ID == "2029758" || G_USER_ID == "2999999") {
		// btn_changAuth.Visible = true;
	// }
	gfn_initDs(ds_rcond, true);
	ds_rcond.SetColumn(0, "ZPROGRAM", "CS0605001A");
	ds_rcond.SetColumn(0, "GBN", "01");	
	pdchang_visible = gfn_getAuth(ds_rcond);
	ds_rcond.ClearData();

	if (pdchang_visible == true) {	
		btn_changAuth.Visible = true;
	}
	//=============================================================================================
	//======================== 사용자에 따른 초기 권한 설정 =======================================
	// if(G_USER_ID == "2021200" || G_USER_ID == "2023687" || G_USER_ID == "2023237" || G_USER_ID == "2018900" || G_USER_ID == "2029758" || G_USER_ID == "2999999") // 정보기술부 인원 보수로 셋팅
	// {
		// auth = "30";
	// }
	pdchang_visible = false;
	gfn_initDs(ds_rcond, true);
	ds_rcond.SetColumn(0, "ZPROGRAM", "CS0605001A");
	ds_rcond.SetColumn(0, "GBN", "02");	
	pdchang_visible = gfn_getAuth(ds_rcond);
	ds_rcond.ClearData();

	if (pdchang_visible == true) {	
		auth = "30";
	}
	//=============================================================================================
	//======================== E-mail 버튼 활성화 설정=============================================
	// if(G_USER_ID == "2021200" || G_USER_ID == "2018900" || G_USER_ID == "2029758" || G_USER_ID == "2999999") // test 
	// {
		// btn_sendEmail.Visible = true;
	// }
	pdchang_visible = false;
	gfn_initDs(ds_rcond, true);
	ds_rcond.SetColumn(0, "ZPROGRAM", "CS0605001A");
	ds_rcond.SetColumn(0, "GBN", "03");	
	pdchang_visible = gfn_getAuth(ds_rcond);
	ds_rcond.ClearData();

	if (pdchang_visible == true) {	
		btn_sendEmail.Visible = true;
	}
	//=============================================================================================
	
	fn_query();
}
/********************************************************************************
* 기      능   : 공통코드가 조회된 후의 Callback 함수 
********************************************************************************/
function fn_completeInit(sCode, sDsObj, sCodeType) {
}
/********************************************************************************
* 기      능   : form UnloadCompleted 
********************************************************************************/
function fn_OnUnloadCompleted(obj) {
	return gfn_isFormUnload(obj);
}

function fn_openPopupMessage() {
	gfn_openPopup("CS0605001E", true);
}
//=========================================================================================
// [ PART 3 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,form닫기)
//=========================================================================================
/********************************************************************************
* 기      능   : 조회 (header 조회)
********************************************************************************/
function fn_query() {

	ds_cond.SetColumn(0,"POSID",ds_list2.GetColumn(ds_list2.row,"CS101_PJT"));
	ds_cond.SetColumn(0,"HNO",ds_list2.GetColumn(ds_list2.row,"CS101_HNO"));
	
	tit_clearActionInfo();
	tit_addSearchActionInfo("cs06:CS0605001A_S1");
	tit_addSearchActionInfo("cs06:CS0605001A_S2");
	
	tit_callService(
        ""
        , ""
        , "ds_cond=ds_cond"
        , "ds_list_h=ds_list_h ds_list=ds_list"
        , ""
        , "fn_afterQuery"
        , true);
}
/********************************************************************************
* 기      능   : 삽입 
********************************************************************************/
function fn_insert() {
}
/********************************************************************************
* 기      능   : Delete 
********************************************************************************/
function fn_delete() {
	tit_clearActionInfo();
	//zcst108 조치예정일 관련 date update
	tit_addSaveActionInfo(
        "cs06:CS0605001A_U27"
        , ""
        , ""
        , "FLAG"
        , ""
        , -1
        , "");

	tit_callService(
        ""
        , ""
        , "ds_list=ds_list:A"
        , ""
        , ""
        , "fn_afterSave");	
}
/********************************************************************************
* 기      능   : 저장 
********************************************************************************/
function fn_save() {
	if(auth == "10" || auth == "30" || auth == "40") {//2010.02.17 LJH (auth == "30" 추가)
		fn_save10();
	} else if(auth == "50") {
		fn_save50();
	} else if(auth == "60") {
		fn_save60();
	}
}
/********************************************************************************
* 기      능   : 저장 (보수협력사)
********************************************************************************/
function fn_save10() {
	if ( ds_list.rowcount == 0 )
	{
		gfn_showAlert("CW00034"); 
		return;			
	}	

	if(!gfn_isChangeDs(ds_list, false) && !gfn_isChangeDs(ds_list_h, false))
	{
	    // CW00005=변경된 정보가 없습니다.
		gfn_showAlert("CW00005"); 
		return;
	}

	// 방문일 필수입력 체크
	if(gfn_isNull(cal_cs107_vsd, true, st_vsd.value)) {
		gfn_showAlert("CW00001",st_vsd.value);  // 누락 여부 팝업창으로 안내
		return;
	}
	if(gfn_isNull(ed_vsm, true, st_vsm.value)){
		gfn_showAlert("CW00001",st_vsm.value);  // 누락 여부 팝업창으로 안내
		return;
	}
	// 문제점 필수입력 체크
	var dsArr = ["CS108_QII"];
	var lbArr = [st_qii.value];
	if (ds_list.getColumn(0,"CS108_QIC") != "0000") 
	{
		if ( gfn_isGridNull(grd_list,dsArr,lbArr,"FLAG") ) {
			return;
		}

		//삭제된 이미지 file server에서 삭제하기
		for(var k=0; k < ds_list.GetDelRowCount(); k++)
		{
			tit_fileDelete("CS" , ds_list.GetDelColumn(k, "CS108_QAD"), true); //성공:true, 실패:false
		}	

		var fileName = "";
		//file서버에 이미지 저장
		for(var i = 0; i < ds_list.rowcount; i++)
		{
			//파일이미지 크기 제한
			var tmpFileObj = find("_tmpFile");
			if ( tmpFileObj == null ) {
				Create("File", "_tmpFile");
			}
			
			var size = _tmpFile.GetLength(ds_list.getColumn(i, "CS108_QAD_PATH") + "\\" + ds_list.getColumn(i, "CS108_QAD"));
	
			if (length(ds_list.getColumn(i, "CS108_QAD_PATH")) == 0 || length(ds_list.getColumn(i, "CS108_QAD")) == 0  ) {
			
			} else {
				if ( size > 550000 ) {
					gfn_showMsg("CW00183","500KB");
					return false;
				}			
			}

			if(length(ds_list.getColumn(i, "CS108_QAD")) != 0 && length(ds_list.getColumn(i, "CS108_QAD_PATH")) != 0)
			{
				fileName = ds_list_h.getColumn(0, "CS101_PJT")+ds_list_h.getColumn(0, "CS101_HNO")+ds_list.getColumn(i, "CS108_QIC")+"."+gfn_getFileExt(ds_list.getColumn(i, "CS108_QAD"));
				var arr = tit_fileWrite(httpFile
					, "CS"
					, ds_list.getColumn(i, "CS108_QAD_PATH")
					, ds_list.getColumn(i, "CS108_QAD")
					, fileName// 실제 db에 저장될 파일 이름
					, "U"	// time stamp를 붙이지 않을 경우 U 사용 
					, "");//ds_list.getColumn(i, "CS108_QAD") );//삭제할 이전 파일명 
				if ( arr[0] == "S" ) {
					ds_list.setColumn(i, "CS108_QAD", arr[2]);
				}
				else if ( arr[0] != "S" )
				{
					gfn_showMsg("CW00035"); 
					return;
				}
			}
		}
	}

	tit_clearActionInfo();

	// MASTER (ZCST107)
	var sqlId1 = "cs06:CS0605001A_I11";
	if( length( ds_list_h.getColumn(0, "PST_GBN") ) > 0 ) {
		sqlId1 = "cs06:CS0605001A_U11";
	}
	tit_addSingleActionInfo(sqlId1);

	// ZCST108
	var sqlId = "cs06:CS0605001A_D11";
	// 삭제 처리 
	tit_addSingleActionInfo(sqlId);

	// CHILD 저장 (ZCST108)
	tit_addMultiActionInfo("cs06:CS0605001A_I12");

	// MASTER (ZCST101)
    tit_addSingleActionInfo("cs06:CS0605001A_U30");

	tit_callService(
        ""
        , ""
        , "ds_list_h=ds_list_h:A ds_list=ds_list:A"
        , ""
        , ""
        , "fn_afterSave");
}
/********************************************************************************
* 기      능   : 저장 (설치부)
********************************************************************************/
function fn_save50() {
/*	if(!gfn_isChangeDs(ds_list, false))
	{
	    // CW00005=변경된 정보가 없습니다.
		gfn_showAlert("CW00005"); 
		return;
	}
*/
	for(var i = 0; i< ds_list.rowcount; i++) {
		if(ds_list.GetColumn(i,"CS108_SCT") == "1") {
			ds_list.SetColumn(i,"FLAG","I");
		} else {
			ds_list.SetColumn(i,"FLAG","");
		}
	}

	// 필수입력 체크
	if(gfn_isNull_alert(cal_cs107_vsd_ps, true, st_vsd_ps.value)) 
		return;		
	if(gfn_isNull_alert(ed_vsm_ps, true, st_vsm_ps.value))
		return;		

	// 그리드 필수입력 체크
	var dsArr = ["CS108_JCD","CS108_JCR"];
	var lbArr = [st_jcd.value,st_jcr];
	if ( gfn_isGridNull(grd_list,dsArr,lbArr,"FLAG","I") ) {
		return;
	}

	//삭제된 이미지 file server에서 삭제하기
	for(var k=0; k < ds_list.GetDelRowCount(); k++)
	{
		tit_fileDelete("CS" , ds_list.GetDelColumn(k, "CS108_JAD"), true); //성공:true, 실패:false
	}	

	var fileName = "";
	//file서버에 이미지 저장
	for(var i = 0; i < ds_list.rowcount; i++)
	{
		//파일이미지 크기 제한
		var tmpFileObj = find("_tmpFile");
		if ( tmpFileObj == null ) {
			Create("File", "_tmpFile");
		}
		
		var size = _tmpFile.GetLength(ds_list.getColumn(i, "CS108_JAD_PATH") + "\\" + ds_list.getColumn(i, "CS108_JAD"));

		if (length(ds_list.getColumn(i, "CS108_JAD_PATH")) == 0 || length(ds_list.getColumn(i, "CS108_JAD")) == 0  ) {
		
		} else {
			if ( size > 550000 ) {
				gfn_showMsg("CW00183","500KB");
				return false;
			}			
		}

		if(length(ds_list.getColumn(i, "CS108_JAD")) != 0 && length(ds_list.getColumn(i, "CS108_JAD_PATH")) != 0)
		{
			fileName = "J"+ds_list_h.getColumn(0, "CS101_PJT")+ds_list_h.getColumn(0, "CS101_HNO")+ds_list.getColumn(i, "CS108_QIC")+"."+gfn_getFileExt(ds_list.getColumn(i, "CS108_JAD"));
			var arr = tit_fileWrite(httpFile
				, "CS"
				, ds_list.getColumn(i, "CS108_JAD_PATH")
				, ds_list.getColumn(i, "CS108_JAD")
				, fileName// 실제 db에 저장될 파일 이름
				, "U"	// time stamp를 붙이지 않을 경우 U 사용 
				, "");//ds_list.getColumn(i, "CS108_QAD") );//삭제할 이전 파일명 
			if ( arr[0] == "S" ) {
				ds_list.setColumn(i, "CS108_JAD", arr[2]);
			}
			else if ( arr[0] != "S" )
			{
				gfn_showMsg("CW00035"); 
				return;
			}
		}
	}

	tit_clearActionInfo();
	//ZCST107
	tit_addSingleActionInfo("cs06:CS0605001A_U31"); 
	//ZCST108
	tit_addSaveActionInfo(
        "cs06:CS0605001A_U26"
        , ""
        , ""
        , "FLAG"
        , ""
        , -1
        , "");

	tit_callService(
        ""
        , ""
        , "ds_list_h=ds_list_h:A ds_list=ds_list:A"
        , ""
        , ""
        , "fn_afterSave");	
}
/********************************************************************************
* 기      능   : 저장 (QC)
********************************************************************************/
function fn_save60() {

	// 필수 항목 체크 start ******************************************//
	// 방문일자, 방문자, 통보부서 필수입력 체크
	if(gfn_isNull_alert(cal_cs107_vsd_qc, true, st_vsd_qc.value))
		return;
	if(gfn_isNull_alert(ed_vsm_qc, true, st_vsm_qc.value))
		return;	
	if(gfn_isNull_alert(cb_ntc_qc, true, st_ntc_qc.value))
		return;				
	if(gfn_isNull_alert(cal_cs107_con_qc, true, st_con_qc.value))
		return;	
	if(gfn_isNull_alert(cb_rsn, true, st_rsn.value)) // 발생사유 
		return;				

	for(var i=0; i<ds_list.rowcount; i++) {
		
		/*===============================================================*/
		//==========================MMS 연계개발로 인한 항목 추가 시작============================//
		//==========================2021.06.08 J.H Han=======================================//
		if(ds_list.GetColumn(i,"CS108_RSN_NTC_QC") == "") {
			gfn_showAlert("CW00001", (i + 1) + "번 항목의 원인부서");
			grd_list.SetFocus();
			return;
		}
		//==========================MMS 연계개발로 인한 항목 추가 종료============================//
		
		if(ds_list.GetColumn(i,"CS108_NTC_QC") == "") {
			gfn_showAlert("CW00001", (i + 1) + "번 항목의 조치부서");
			grd_list.SetFocus();
			return;
		}
		
		if(ds_list.GetColumn(i,"CS108_RSN_QC") == "") {
			gfn_showAlert("CW00001", (i + 1) + "번 항목의 발생사유");
			grd_list.SetFocus();
			return;
		}
	}
	// 필수 항목 체크 end  ******************************************//

	tit_clearActionInfo();
	tit_addSingleActionInfo("cs06:CS0605001A_U35");  // update zcst107
	tit_addMultiActionInfo("cs06:CS0605001A_U32");   // update zcst108

	tit_callService(
        ""
        , ""
        , "ds_list_h=ds_list_h:A ds_list=ds_list:A"
        , ""
        , ""
        , "fn_afterSave");	
}
/********************************************************************************
* 기      능   : 전송 (보수협력사)
********************************************************************************/
function fn_trans() {

	if ( ds_list.rowcount == 0 )
	{
		gfn_showAlert("CW00034"); 
		return;			
	}	

	// 방문일 필수입력 체크
	if(gfn_isNull(cal_cs107_vsd, true, st_vsd.value))
		return;

	// 고객명 필수입력 체크
	var dsArr = ["CS108_QII"];
	var lbArr = [st_qii.value];
	if (ds_list.getColumn(0,"CS108_QIC") != "0000") 
	{
		if ( gfn_isGridNull(grd_list,dsArr,lbArr,"FLAG") ) {
			return;
		}

		//삭제된 이미지 file server에서 삭제하기
		for(var k=0; k < ds_list.GetDelRowCount(); k++)
		{
			tit_fileDelete("CS" , ds_list.GetDelColumn(k, "CS108_QAD"), true); //성공:true, 실패:false
		}	

		var fileName = "";
		//file서버에 이미지 저장
		for(var i = 0; i < ds_list.rowcount; i++)
		{
			//파일이미지 크기 제한
			var tmpFileObj = find("_tmpFile");
			if ( tmpFileObj == null ) {
				Create("File", "_tmpFile");
			}
			
			var size = _tmpFile.GetLength(ds_list.getColumn(i, "CS108_QAD_PATH") + "\\" + ds_list.getColumn(i, "CS108_QAD"));
	
			if (length(ds_list.getColumn(i, "CS108_QAD_PATH")) == 0 || length(ds_list.getColumn(i, "CS108_QAD")) == 0  ) {
			
			} else {
				if ( size > 550000 ) {
					gfn_showMsg("CW00183","500KB");
					return false;
				}			
			}

			if(length(ds_list.getColumn(i, "CS108_QAD")) != 0 && length(ds_list.getColumn(i, "CS108_QAD_PATH")) != 0)
			{
				fileName = ds_list_h.getColumn(0, "CS101_PJT")+ds_list_h.getColumn(0, "CS101_HNO")+ds_list.getColumn(i, "CS108_QIC")+"."+gfn_getFileExt(ds_list.getColumn(i, "CS108_QAD"));
				
				var arr = tit_fileWrite(httpFile
					, "CS"
					, ds_list.getColumn(i, "CS108_QAD_PATH")
					, ds_list.getColumn(i, "CS108_QAD")
					, fileName// 실제 db에 저장될 파일 이름
					, "U"	// time stamp를 붙이지 않을 경우 U 사용 
					, ds_list.getColumn(i, "CS108_QAD") );//삭제할 이전 파일명 
				if ( arr[0] == "S" ) {
					ds_list.setColumn(i, "CS108_QAD", arr[2]);
				}
				else if ( arr[0] != "S" )
				{
					gfn_showMsg("CW00035"); 
					return;
				}
			}
			else
			{ //이미지 취소시 file server에서 삭제하기
				//tit_fileDelete("CS" , ds_list.getOrgColumn(i, "CS108_QAD"), true); //성공:true, 실패:false
			}
		}
	}	
	// 문제점 항목 있는 경우
	if(ds_list.GetColumn(0,"CS108_QIC") <> "0000") {
		fn_sendSms("A"); //2014.03.20 2017750 문제점보고서 접수시 해당 호기의 설치검사원에게 SMS발송
		
		//====================설치검사원에게 보수-접수 단계에서 메일 보내기 시작===========================================
		fn_sendMailToInspection();// 보수 접수의 경우 판정요청 위해 설치검사원에게 이메일 전송 
		//====================설치검사원에게 보수-접수 단계에서 메일 보내기 종료===========================================
	}

	tit_clearActionInfo();
	
	// MASTER (ZCST107) : 전송시 접수처리
	tit_addSingleActionInfo("cs06:CS0605001A_U12");

	// ZCST108
	var sqlId = "cs06:CS0605001A_D11";
	// 삭제 처리 
	tit_addSingleActionInfo(sqlId);
	
	// CHILD 저장 (ZCST108)
	tit_addMultiActionInfo("cs06:CS0605001A_I12");
	// MASTER (ZCST101)
	tit_addSingleActionInfo("cs06:CS0605001A_U30");

	tit_callService(
		""
		, ""
		, "ds_list_h=ds_list_h:A ds_list=ds_list:A"
		, ""
		, ""
		, "fn_afterSave");
					        
}
/********************************************************************************
* 기      능   : 접수(보수 / QC / 설치) 
********************************************************************************/
function fn_receipt(){
	
	var sqlId;
	//================================기존 로직 주석처리-전송 단계에서 문제점 보고서 존재시 기존 문자와 동시에 메일 발송되도록 처리. 설치QC 김종욱님 요청=========================================
	// MASTER (ZCST107)
	/*if(auth == "20") {
		sqlId = "cs06:CS0605001A_U21";
		fn_sendMailToInspection();// 보수 접수의 경우 판정요청 위해 설치검사원에게 이메일 전송 
	} else */
	//================================기존 로직 주석처리 종료=====================================================================================================================================
	if(auth == "50") {
		
		// 작업 완료일 필수입력 체크
		if(gfn_isNull(cal_cs107_esd_ps, true, st_esd_ps.value))
			return;
			
		sqlId = "cs06:CS0605001A_U34";
		fn_sendSms("C"); // 설치 접수 시 보수 pm 에게 SMS 전송 

	} else if(auth == "60") {
		sqlId = "cs06:CS0605001A_U33";
		
		fn_sendSms("B"); //QC 접수 시 통보 부서에 따라 SMS 전송 
		if(SEND_MAIL_TO_PM) {
			//trace("FLAG  = " +SEND_MAIL_TO_PM);
			fn_sendMailToPM();//QC 접수 시 설치 통보의 경우 설치pm에게 전송 
			// 초기화 
			SEND_MAIL_TO_PM = false;
		}
	}

	tit_clearActionInfo();
	tit_addSingleActionInfo(sqlId);
	tit_callService(
		""
		, ""
		, "ds_list_h=ds_list_h:A ds_list=ds_list:A"
		, ""
		, ""
		, "fn_afterSave");	
	      
}
/********************************************************************************
* 기      능   : 반송(보수PM,고객지원부 관리자) 
********************************************************************************/
function fn_sendback(){
	tit_clearActionInfo();

	// MASTER (ZCST107)
	var sqlId = "cs06:CS0605001A_U23";
	if(auth == "30" || auth == "40" )
		sqlId = "cs06:CS0605001A_U29";
	tit_addSingleActionInfo(sqlId);

	tit_callService(
        ""
        , ""
        , "ds_list_h=ds_list_h:A"
        , ""
        , ""
        , "");	
}
/********************************************************************************
* 기      능   : 승인(고객지원부 관리자)  -->> 단계 간소화, 사용안함 201304 LHR
********************************************************************************/
function fn_approval(){
	tit_clearActionInfo();

	// MASTER (ZCST101)
	var sqlId = "cs06:CS0605001A_U25";
	tit_addSingleActionInfo(sqlId);

	// MASTER (ZCST107)
	sqlId = "cs06:CS0605001A_U28";
	tit_addSingleActionInfo(sqlId);

	tit_callService(
        ""
        , ""
        , "ds_list_h=ds_list_h:A"
        , ""
        , ""
        , "fn_afterSave");	
}
/********************************************************************************
* 기      능   : 닫기  
********************************************************************************/
function fn_close() {
	close();
}
//=========================================================================================
// [ PART 4]
// Callback 함수 정의 : callback 함수명은 메인 함수의 fn_xxxx() 에서 xxxx 부분은 fn_afterXXXX()
// 형태가 되도록 작성 
//=========================================================================================
/********************************************************************************
* 기      능   : 조회 Callback  
********************************************************************************/
function fn_afterQuery(errCode, errMsg) {
//	if(length(ds_list_h.GetColumn(0,"CS107_VSM")) == 0)
//		ds_list_h.SetColumn(0,"CS107_VSM",G_USER_NAME);

	cal_cs107_vsd.Enable = false;
	ed_vsm.Enable = false;

	div_btn.btn_receipt.enable = false;
	div_btn.btn_approval.enable = false;
	div_btn.btn_delete.enable = false;
	div_btn.btn_save.enable = false;
	div_btn.btn_trans.enable = false;
	div_btn.btn_sendback.enable = false;
    btn_point_add.Enable = false;
    btn_point_del.Enable = false;
   	btn_confirm.Enable = false;
   	
   	//보수현장담당자 최종 확인
   	if(auth == "10" || auth == "20" || auth == "30" || auth == "40"){
		btn_confirm.Enable = true;
	} 
	var jcd_cnt = 0;
	for( i=0; i<ds_list.rowcount; i++ ){
		if(length(ds_list.GetColumn(i,"CS108_JYD")) > 0 || length(ds_list.GetColumn(i,"CS108_JCD")) > 0 || 
		   length(ds_list.GetColumn(i,"CS108_JCR")) > 0 )
			jcd_cnt++;
	}

	var pst = ds_list_h.GetColumn(0,"CS107_PST");
	
	fn_setAuth(auth, pst, jcd_cnt);
	
	//==================   원인 부서 및 검사 개소 변경 ====================
	// QC 김종욱 에 한해서 원인 부서 및 검사 개소 변경 201608 
	// 정의성 추가  20170821
	// 모바일 미사용
	// if(G_USER_ID == "2021692" OR G_USER_ID == "2022826"
	                          // OR G_USER_ID == "2021200" OR G_USER_ID == "2023687"
	                          // OR G_USER_ID == "2018900"
	                          // OR G_USER_ID == "2029758") 
	// {
		// btn_qcChange.Visible = true;	
	// }	
	pdchang_visible = false;
	gfn_initDs(ds_rcond, true);
	ds_rcond.SetColumn(0, "ZPROGRAM", "CS0605001A");
	ds_rcond.SetColumn(0, "GBN", "04");	
	pdchang_visible = gfn_getAuth(ds_rcond);
	ds_rcond.ClearData();

	if (pdchang_visible == true) {	
		btn_qcChange.Visible = true;
	}
	//=======================================================================	
		
	// 효율개선부 김종욱 요청 참고사항 팝업 20170224
	// 보수 작성 및 보수 승인에 팝업 - 보수 접수 이전 상태에서 적용
	// 모바일 미사용

	if(auth <= "30" && (pst == "A1" || length(pst) == 0) ) {
		fn_openPopupMessage();
	}
	//====================보수이체 문제점 작성시 참고사항 popup 실행 권한 ======
	// if(G_USER_ID == "2021692" && pst == "A5") {
		// fn_openPopupMessage();
	// }	
	pdchang_visible = false;
	gfn_initDs(ds_rcond, true);
	ds_rcond.SetColumn(0, "ZPROGRAM", "CS0605001A");
	ds_rcond.SetColumn(0, "GBN", "05");	
	pdchang_visible = gfn_getAuth(ds_rcond);
	ds_rcond.ClearData();

	if (pdchang_visible == true && pst == "A5") {	
		fn_openPopupMessage();
	}
	//=========================================================================
		
}
/******************************************************
*  Grid 에서 컬럼 값 변경 시 해당 검사개소에 대한 문제점 칼럼 속성변경
* @param  qicValue(ds_list.SC108_QIC)에 해당하는 값
* @return  검사개소에 해당하는 문제점 컬럼 속성값
******************************************************/
function fn_changeQii(qicValue){
	if( (auth == "10" || auth == "30" || auth == "40") && qicValue != "0000" )
		return "normal";
	else 
		return "none";
}
/******************************************************
*  Grid 에서 컬럼 값 변경 시 해당 검사개소에 대한 문제점 칼럼 속성변경
* @param  qicValue(ds_list.SC108_QIC)에 해당하는 값
* @return  검사개소에 해당하는 문제점 컬럼 이미지 속성값
******************************************************/
function fn_changeQii2(qicValue){
	if( (auth == "10" || auth == "30" || auth == "40") && qicValue != "0000" )
		return "icon_grid_edit";
	else 
		return "";
}
/******************************************************
*  Grid 에서 컬럼 값 변경 시 해당 검사개소에 대한 문제점 칼럼 속성변경
* @param  qicValue(ds_list.SC108_QIC)에 해당하는 값
* @return  검사개소에 해당하는 문제점 컬럼 속성값
******************************************************/
function fn_changeQad(qicValue){
	//if( auth == "10" && qicValue != "0000" )
		return "true";
	//else 
		//return "false";
}
/******************************************************
*  권한에 따른 Grid 컬럼의 검사개소에 대한 통보여부 칼럼 속성변경
* @param  qicValue(ds_list.SC108_QIC)에 해당하는 값
* @return  검사개소에 해당하는 통보여부 컬럼 속성값
******************************************************/
function fn_changeSct(qicValue){
	if( auth == "20" && qicValue != "0000" )
		return "checkbox";
	else 
		return "none";
}
/******************************************************
*  권한에 따른 Grid 컬럼의 속성변경
* @param  
* @return  조치예정일 컬럼 속성값
******************************************************/
function fn_changeJcd2(sctValue){
	if( auth == "60" && (ds_list_h.GetColumn(0,"CS107_PST") == "A5"||ds_list_h.GetColumn(0,"CS107_PST") == "B1") && sctValue == "0")
		return "true";
	else 
		return "false";
}
/******************************************************
*  권한에 따른 Grid 컬럼의 속성변경
* @param  
* @return  조치 계획 컬럼 속성값
******************************************************/
function fn_changeJcd3(sctValue){
	if( auth == "60" && (ds_list_h.GetColumn(0,"CS107_PST") == "A5"||ds_list_h.GetColumn(0,"CS107_PST") == "B1") && sctValue == "0")
		return "normal";
	else 
		return "none";
}
/******************************************************
*  권한에 따른 Grid 컬럼의 속성변경
* @param  
* @return  조치 부서 컬럼 속성값
******************************************************/
function fn_changeJcd4(sctValue){
	if( auth == "60" && (ds_list_h.GetColumn(0,"CS107_PST") == "A5"||ds_list_h.GetColumn(0,"CS107_PST") == "B1") && sctValue == "0")
		return "combo";
	else 
		return "none";
}
/******************************************************
*  권한에 따른 Grid 컬럼의 속성변경
* @param  
* @return  조치부서 계획  컬럼 이미지 속성값
******************************************************/
function fn_changeJcr3(sctValue){
	if( auth == "60" && (ds_list_h.GetColumn(0,"CS107_PST") == "A5"||ds_list_h.GetColumn(0,"CS107_PST") == "B1") && sctValue == "0")
		return "icon_grid_edit";
	else 
		return "";
}
/******************************************************
*  권한에 따른 Grid 컬럼의 속성변경
* @param  
* @return  조치일 컬럼 속성값
******************************************************/
function fn_changeJcd(sctValue){
	if( auth == "50" && (ds_list_h.GetColumn(0,"CS107_PST") == "C0"||ds_list_h.GetColumn(0,"CS107_PST") == "C1") && sctValue == "1")
		return "true";
	else 
		return "false";
}
/******************************************************
*  권한에 따른 Grid 컬럼의 속성변경
* @param  
* @return  조치내용 컬럼 속성값
******************************************************/
function fn_changeJcr(sctValue){
	if( auth == "50" && (ds_list_h.GetColumn(0,"CS107_PST") == "C0"||ds_list_h.GetColumn(0,"CS107_PST") == "C1") && sctValue == "1")
		return "normal";
	else 
		return "none";
}
/******************************************************
*  권한에 따른 Grid 컬럼의 속성변경
* @param  
* @return  조치내용 칼럼 이미지 속성값
******************************************************/
function fn_changeJcr2(sctValue){
	if( auth == "50" && (ds_list_h.GetColumn(0,"CS107_PST") == "C0"||ds_list_h.GetColumn(0,"CS107_PST") == "C1") && sctValue == "1")
		return "icon_grid_edit";
	else 
		return "";
}
/********************************************************************************
* 기      능   : 조회 Callback  
********************************************************************************/
function fn_afterQuery2(errCode, errMsg) {
	gfn_showMsg("CI00002",ds_list2.RowCount()+"");
}

/********************************************************************************
* 기      능   : 저장 Callback  
********************************************************************************/
function fn_afterSave(errCode, errMsg) {

	if ( errCode!= 0 ) {
		gfn_showMsg("CE00001");
	} else {
		gfn_showMsg("CI00003");
	}
	fn_query();
}
//=========================================================================================
// [ PART 5 ]
// Detail Process Event 정의 ( User Define function )
// 사용자 정의 함수는 ufn_xxxx() 형태로 작성 
//=========================================================================================
/********************************************************************************
* 기      능   : 사용자 정의 함수  
********************************************************************************/
function ufn_userfunction() {
}
//=========================================================================================
// [ PART 6 ]
// component Event 정의 : 각 Component 별 이벤트 
//=========================================================================================
function grd_list_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
{
	gfn_sortGrid(obj,nCell);
}
/********************************************************************************
* 기      능   : 그리드에서 enter key 클릭 시 focus이동
********************************************************************************/
function grd_list_OnKeyDown(obj,nChar)
{
	if( nChar == "13") {
		obj.SetFocus();
	}
}

/********************************************************************************
* 기      능   : 그리드에서 file upload 입력시 
********************************************************************************/
function grd_list_OnExpandEdit(obj,nRow,nCell,strVal,nPivotIndex)
{

	// nCell == 7  문제점 이미지 
	if ( nCell == 7 ) {
	
		var arr = gfn_openFileMgr(
		    "CS"
			, ds_list.getColumn(nRow, "CS108_QAD")//FileDialog.FileName
			, ds_list.getColumn(nRow, "CS108_QAD_PATH")//FileDialog.FilePath
			, imgUploadFlg
		);
		if ( arr != null ) {
		   ds_list.setColumn(nRow, "CS108_QAD_PATH",arr[0]) ; // 디렉토리 정보 
		   ds_list.setColumn(nRow, "CS108_QAD",arr[1]); // 파일명 
		}
		
	// nCell == 15  조치결과 이미지 
	} else if ( nCell == 15 ) {
		var arr = gfn_openFileMgr(
		    "CS"
			, ds_list.getColumn(nRow, "CS108_JAD")//FileDialog.FileName
			, ds_list.getColumn(nRow, "CS108_JAD_PATH")//FileDialog.FilePath
			, imgUploadFlgJ
		);
		
		if ( arr != null ) {
		   ds_list.setColumn(nRow, "CS108_JAD_PATH",arr[0]) ; // 디렉토리 정보 
		   ds_list.setColumn(nRow, "CS108_JAD",arr[1]); // 파일명 
		}
	} else {
		var rect = obj.GetCellRect(nRow, ncell);
	
		cal_temp.top = rect[1] + 270;
		cal_temp.Left = rect[0] + 20; 
		cal_temp.Visible = true;
		if(nCell == 11)
			cal_temp.value = ds_list.getColumn(nRow, "CS108_JYD");
		else if (nCell == 13)
			cal_temp.value = ds_list.getColumn(nRow, "CS108_JCD");
		cal_temp.SetFocus();
	}	
}
/********************************************************************************
* 기      능   : 달력에서 일자 선택했을 경우 
********************************************************************************/
function cal_temp_OnDayClick(obj,strText)
{
	if(grd_list.GetClickedCell() == 11)
		ds_list.SetColumn(ds_list.row, "CS108_JYD", strText);
	else if (grd_list.GetClickedCell() == 13)
		ds_list.SetColumn(ds_list.row, "CS108_JCD", strText);
	obj.Visible = false;
}
/********************************************************************************
* 기      능   : 달력에서 포커스 잃었을 경우 
********************************************************************************/
function cal_temp_OnKillFocus(obj)
{
	obj.Visible = false;
}

/********************************************************************************
* 기      능   : 보수담당자 확인여부 저장 시
********************************************************************************/
function btn_confirm_OnClick(obj)
{
	
	ds_confirm.SetColumn(0, "CS107_PJT", ds_list.GetColumn(0, "CS108_PJT"));
	ds_confirm.SetColumn(0, "CS107_HNO", ds_list.GetColumn(0, "CS108_HNO"));
	ds_confirm.SetColumn(0, "CS107_CYN", cb_confirm.Value);
	
	tit_clearActionInfo();
	tit_addSingleActionInfo("cs06:CS0605001A_U41"); 

	tit_callService(
        ""
        , ""
        , "ds_confirm=ds_confirm"
        , ""
        , ""
        , "");	
}

function btn_point_add_OnClick(obj)
{
	gfn_openPopup("CS0605001B",true);
}
function btn_point_del_OnClick(obj)
{
	ds_list.DeleteRow(ds_list.row);
}

/********************************************************************************
* 기      능   : 데이터셋 값 변경 시 - 조치예정일,조치일,조치내용
********************************************************************************/

function ds_list_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{
	switch( strColumnID ) {
		case "FLAG":
			break;
		case "CS108_JYD":	// 조치예정일
			if(ds_list.getColumn(nRow, "CS108_JYD") < cal_cs107_vsd.Value) {
				obj.fireevent = false;
				var arr = [st_jyd.value, st_vsd.value ];
				gfn_showAlert("CW00007", arr);
				obj.setColumn(nRow, "CS108_JYD", obj.GetOrgColumn(nRow,"CS108_JYD") );
				obj.fireevent = true;
			}

			break;
		case "CS108_JCD":	// 조치일
			if(ds_list.getColumn(nRow, "CS108_JCD") < ds_list.getColumn(nRow, "CS108_JYD")) {
				obj.fireevent = false;
				var arr = [st_jcd.value, st_jyd.value ];
				gfn_showAlert("CW00007", arr);
				obj.setColumn(nRow, "CS108_JCD", obj.GetOrgColumn(nRow,"CS108_JCD") );
				obj.fireevent = true;
			}

			break;
	}
}
/********************************************************************************
* 기      능   : 액셀  
********************************************************************************/
function fn_excel() {
	gfn_saveToExcel(grd_list, true );
}

function fn_setAuth(auth, pst) {
	if(auth < "50") {
		cal_cs107_vsd.Enable = true;
		ed_vsm.Enable = true;
		cal_cs107_vsd_qc.Enable = false;
		ed_vsm_qc.Enable = false;
		cb_ntc_qc.Enable = false;
		cal_cs107_con_qc.Enable = false;
		cal_cs107_vsd_ps.Enable = false;
		cal_cs107_esd_ps.Enable = false;
		ed_vsm_ps.Enable = false;
		ed_cs107_rmk_ps.Enable = false;
		grd_list.SetCellProp("body",8,"Edit","none");
	}
	else if(auth == "50") {
		cal_cs107_vsd.Enable = false;
		ed_vsm.Enable = false;
		cb_ntc_qc.Enable = false;
		cal_cs107_con_qc.Enable = false;
		cal_cs107_vsd_qc.Enable = false;
		ed_vsm_qc.Enable = false;
		ed_vsm_ps.Enable = true;
		ed_cs107_rmk_ps.Enable = true;
		cal_cs107_esd_ps.Enable = true;
		cal_cs107_vsd_ps.Enable = true;
		grd_list.SetCellProp("body",8,"Edit","none");
	} 
	else if(auth == "60") {
		cal_cs107_vsd.Enable = false;
		ed_vsm.Enable = false;
		cal_cs107_vsd_ps.Enable = false;
		ed_vsm_ps.Enable = false;
		ed_cs107_rmk_ps.Enable = false;
		cal_cs107_esd_ps.Enable = false;
	} 
	

	// 보수-접수의 경우도 이미지 등록 가능하게 201602
   	if( (auth == "10" || auth == "30" || auth == "40") && pst == "A5")
   	{	
		btn_csimg.Enable = true;
		imgUploadFlg ="";
		imgUploadFlgJ ="VIEW";
   	}	
		
	//보수협력사/지사 -  최초 작성의 경우 저장 가능
   	if( (auth == "10" || auth == "30" || auth == "40") && (length(pst) == 0))
   	{
		div_btn.btn_save.enable = true;
		div_btn.btn_receipt.enable = false;
		btn_point_add.Enable = true;
		btn_point_del.Enable = true;
		
		imgUploadFlg ="";
		imgUploadFlgJ ="VIEW";
   	}	
	//보수협력사/지사 - 작성 및 반송상태인 경우 전송 및 저장 가능
   	if( (auth == "10" || auth == "30" || auth == "20" || auth == "40") && (pst == "A1" || pst == "A2"))
   	{
		div_btn.btn_trans.enable = true;
		div_btn.btn_save.enable = true;
		div_btn.btn_receipt.enable = false;
		btn_point_add.Enable = true;
		btn_point_del.Enable = true;
		
		imgUploadFlg ="";
		imgUploadFlgJ ="VIEW";
   	}
   	//보수PM - 전송상태 인 경우 접수 및 반송 가능
   	else if( auth == "20" && pst == "A3" ) 
   	{
		div_btn.btn_receipt.enable = false;
		div_btn.btn_sendback.enable = true;

		imgUploadFlg ="VIEW";
		imgUploadFlgJ ="VIEW";
   	}
   	//QC - 보수_접수 상태인 경우 저장 가능
   	else if( auth == "60" && pst == "A5" )
   	{
		div_btn.btn_save.enable = true;

		imgUploadFlg ="VIEW"; 
		imgUploadFlgJ ="";
   	}
   	//QC - 저장 상태인 경우 접수 및 저장(수정) 가능
   	else if( auth == "60" && pst == "B1" )
   	{
		div_btn.btn_save.enable = true;
		div_btn.btn_receipt.enable = true;

		imgUploadFlg ="VIEW";
		imgUploadFlgJ ="";
   	}
   	//설치부 - 설치통보상태인 경우 저장 가능
   	else if( auth == "50" && pst == "C0" ) 
   	{
		div_btn.btn_save.enable = true;

		imgUploadFlg ="VIEW";
		imgUploadFlgJ ="";
   	}
   	//설치부 - 저장상태인 경우 접수 및 저장(수정) 가능
   	else if( auth == "50" && pst == "C1" )
   	{
		//div_btn.btn_delete.enable = true;
		div_btn.btn_save.enable = true;
		div_btn.btn_receipt.enable = true;

		imgUploadFlg ="VIEW";
		imgUploadFlgJ ="";
   	}
   	
}

function fn_sendSms(arr) {

	var title;
	var txt;
	var msg;
	
	ds_sms.ClearData();
	ds_sms.AddRow();
		
	if( arr == "A" ){ // 보수 접수 시 sms 정보 설정
	
		ds_sms.SetColumn(0, "TRAN_PHONE", ds_list_h.GetColumn(0, "CELLP")) ; // 설치검사원
		ds_sms.AddRow();
		ds_sms.SetColumn(1, "TRAN_PHONE", ds_list_h.GetColumn(0, "CELLP2")) ; //보수pm
		title = "[SRM 보수이체접수] ";
		txt = substr(ds_list.GetColumn(0, "CS108_QII"),0,10);
		
	} else if( arr == "B" ){ // QC 접수 시 sms 정보 설정
		
		title = "[SRM - QC 통보] ";
		txt = substr(ds_list.GetColumn(0, "CS108_TXT_QC"),0,10);
	
		if( ds_list_h.GetColumn(0, "CS107_NTC_QC") == 1 ) { // 설치 통보
			SEND_MAIL_TO_PM = true;
			ds_sms.SetColumn(0, "TRAN_PHONE", ds_list_h.GetColumn(0, "CELLP3")) ; //설치pm
			ds_sms.AddRow();
			ds_sms.SetColumn(1, "TRAN_PHONE", ds_list_h.GetColumn(0, "CELLP4")) ; //설치업체 대표
			ds_sms.AddRow();
			ds_sms.SetColumn(2, "TRAN_PHONE", ds_list_h.GetColumn(0, "CELLP5")) ; //작업팀장
		
		} else if( ds_list_h.GetColumn(0, "CS107_NTC_QC") == 2 ) { // 보수 통보

			ds_sms.SetColumn(0, "TRAN_PHONE", ds_list_h.GetColumn(0, "CELLP2")) ; //보수pm
			
		} 
	
	} else if( arr == "C" ){ // 설치 접수 시 sms 정보 설정 
		title = "[SRM - 설치조치완료] ";
		txt = substr(ds_list.GetColumn(0, "CS108_JCR"),0,10);
		ds_sms.SetColumn(0, "TRAN_PHONE", ds_list_h.GetColumn(0, "CELLP2")) ; //보수pm
	}
	
	msg = title
	      + ed_pjt.Text + " "
	      + substr(Edit4.Text,0,10) + ".."+ " "
	      + txt + "..";
	
	ds_list3.ClearData();

	for(var i = 0; i< ds_sms.rowcount; i++) {

		ds_list3.AddRow();
		ds_list3.SetColumn( i, "FLAG", 'U');
		ds_list3.SetColumn( i, "TRAN_SUBJECT", title); // 제목
		ds_list3.SetColumn( i, "TRAN_PHONE", ds_sms.GetColumn(i, "TRAN_PHONE")); // 전화번호
		ds_list3.SetColumn( i, "TRAN_CALLBACK", '02-3670-1213'); // 2018  03  발신번호 
		ds_list3.SetColumn( i, "TRAN_STATUS", '1');
		ds_list3.SetColumn( i, "TRAN_DATE", '');
		ds_list3.SetColumn( i, "TRAN_MSG", msg);
			
	}

//trace(ds_list3.SaveXML());
//return;
	tit_clearActionInfo();
	tit_addSaveActionInfo(
        ""
        , "cs06:CS0605001A_I18"
        , ""
        , "FLAG");
	tit_callService(
        "PDA_ACT"
        , ""
        , "ds_list_m=ds_list3:A"
        , ""
        , ""						
		, ""	 				
		, true							
		, false							
		, true);        
        
}

function fn_print() {
	//UbiReport Call
	//trace(ds_list.SaveXML());
	Dialog("CS06::CS0605001C.xml", "");
}

/********************************************************************************
* 기      능   : 호기별 검사 성적서
********************************************************************************/
function btn_report_OnClick(obj)
{
	var formID="";
	var gbn = substr(ds_list_h.GetColumn(0, "CS101_HNO") ,0 ,1);
	var pjt = ds_list_h.GetColumn(0, "CS101_PJT");
	var hno = ds_list_h.GetColumn(0, "CS101_PJT")+ds_list_h.GetColumn(0, "CS101_HNO");

	//trace(ds_list_h.SaveXML());
	switch (gbn) 
	{
		case 'L':
			formID = "PS0102001L";
			break;			
		
		case 'S':
			formID = "PS0102001S"; //나중에 변경
			break;
			
		case 'W':
			formID = "PS0102001S"; //나중에 변경
			break;	
	}
	
	var arg = "PRE_GBN="+quote(gbn);
	    arg += " PRE_PJT="+quote(pjt);
		arg += " PRE_HNO="+quote(hno);
	
	gfn_openPopup(formID, true, arg);
	
}

/********************************************************************************
* 기      능   : 보수 접수의 상태에서 이미지 등록 201602
********************************************************************************/
function btn_csimg_OnClick(obj)
{
	if(!gfn_isChangeDs(ds_list, false) && !gfn_isChangeDs(ds_list_h, false))
	{
	    // CW00005=변경된 정보가 없습니다.
		gfn_showAlert("CW00005"); 
		return;
	}

	if (ds_list.getColumn(0,"CS108_QIC") != "0000") 
	{
		if ( gfn_isGridNull(grd_list,dsArr,lbArr,"FLAG") ) {
			return;
		}

		//삭제된 이미지 file server에서 삭제하기
		for(var k=0; k < ds_list.GetDelRowCount(); k++)
		{
			tit_fileDelete("CS" , ds_list.GetDelColumn(k, "CS108_QAD"), true); //성공:true, 실패:false
		}	

		var fileName = "";
		//file서버에 이미지 저장
		for(var i = 0; i < ds_list.rowcount; i++)
		{
			//파일이미지 크기 제한
			var tmpFileObj = find("_tmpFile");
			if ( tmpFileObj == null ) {
				Create("File", "_tmpFile");
			}
			
			var size = _tmpFile.GetLength(ds_list.getColumn(i, "CS108_QAD_PATH") + "\\" + ds_list.getColumn(i, "CS108_QAD"));
	
			if (length(ds_list.getColumn(i, "CS108_QAD_PATH")) == 0 || length(ds_list.getColumn(i, "CS108_QAD")) == 0  ) {
			
			} else {
				if ( size > 550000 ) {
					gfn_showMsg("CW00183","500KB");
					return false;
				}			
			}

			if(length(ds_list.getColumn(i, "CS108_QAD")) != 0 && length(ds_list.getColumn(i, "CS108_QAD_PATH")) != 0)
			{
				fileName = ds_list_h.getColumn(0, "CS101_PJT")+ds_list_h.getColumn(0, "CS101_HNO")+ds_list.getColumn(i, "CS108_QIC")+"."+gfn_getFileExt(ds_list.getColumn(i, "CS108_QAD"));
				var arr = tit_fileWrite(httpFile
					, "CS"
					, ds_list.getColumn(i, "CS108_QAD_PATH")
					, ds_list.getColumn(i, "CS108_QAD")
					, fileName// 실제 db에 저장될 파일 이름
					, "U"	// time stamp를 붙이지 않을 경우 U 사용 
					, "");//ds_list.getColumn(i, "CS108_QAD") );//삭제할 이전 파일명 
				if ( arr[0] == "S" ) {
					ds_list.setColumn(i, "CS108_QAD", arr[2]);
				}
				else if ( arr[0] != "S" )
				{
					gfn_showMsg("CW00035"); 
					return;
				}
			}
		}
	}

	tit_clearActionInfo();
	tit_addMultiActionInfo("cs06:CS0605001A_U42");
	tit_callService(
        ""
        , ""
        , "ds_list_h=ds_list_h:A ds_list=ds_list:A"
        , ""
        , ""
        , "fn_afterSave");
	
}
function btn_qcChange_OnClick(obj)
{
	arg =  "pjt=" + quote(ds_list.GetColumn(0, "CS108_PJT"))
	    + " hno=" + quote(ds_list.GetColumn(0, "CS108_HNO"));
	    //alert(arg);
	gfn_openPopup("CS0605001D", true, arg);
}

/********************************************************************************
* 기      능   : 효율개선팀 요청 , 설치 입력 처리 
********************************************************************************/
function btn_changAuth_OnClick(obj)
{	
	if(auth = "50") {
		auth = "60";
		btn_changAuth.Text = "QC권한";
	} else if(auth = "60") {
		auth = "50";
		btn_changAuth.Text = "설치권한";
	}
	fn_query();
}

/********************************************************************************
* 기      능   : 검사성적서(검사POINT) viewer 
********************************************************************************/
function btn_view_OnClick(obj)
{
	 gfn_openPopup("CS0605001F", true);
}

/********************************************************************************
* 기      능   : email 
********************************************************************************/
function btn_sendEmail_OnClick(obj)
{
	fn_sendMailToInspection();
	//fn_sendMailToPM();
}
function fn_sendMailToPM() {
	// 수신자 메일 정보 가져오기 
	ds_MailRvcList.ClearData();
	tit_clearActionInfo();
	tit_addSearchActionInfo("cs06:CS0605001A_S3");
	tit_callService(
        ""
        , ""
        , "ds_cond=ds_cond"
        , "ds_MailRvcList=ds_MailRvcList"
        , ""						
        , ""						
		, true							
		, false							
		, true);

//TRACE(ds_MailRvcList.SaveXML()); return;

	var h_rsn_row = ds_rsn.FindRow("CODE", ds_list_h.GetColumn(0,"CS107_RSN_QC")) ;
	var h_ntc_row = ds_notice_cd.FindRow("CODE", ds_list_h.GetColumn(0,"CS107_NTC_QC") ) ;
	ds_list_h.SetColumn(0, "CS107_RSN_QC_NM", ds_rsn.GetColumn(h_rsn_row,"CODE_NAME"));
	ds_list_h.SetColumn(0, "CS107_NTC_QC_NM", ds_notice_cd.GetColumn(h_ntc_row,"CODE_NAME"));

	var d_ntc_row = 0;
	for(var i=0; i<ds_list.rowcount; i++) {
		d_ntc_row = ds_notice_cd.FindRow("CODE", ds_list.GetColumn(i,"CS108_NTC_QC")) ;
		if(d_ntc_row < 0 ) {
			d_ntc_row = 0;
		}
		ds_list.SetColumn(i, "CS108_NTC_QC_NM", ds_notice_cd.GetColumn(d_ntc_row,"CODE_NAME"));
	}

	var zkun_email;
	//zkun_email = "harim.lee@hdel.co.kr" ;
	zkun_email = ds_MailRvcList.GetColumn(0, "MAILADR");

	tit_clearActionInfo();	
	tit_callService(
		"CS0609001A_ACT"
		, "sendMailToPM"
		, "ds_list_h=ds_list_h ds_list=ds_list ds_MailRvcList=ds_MailRvcList"
		, ""
		," SEND_USER=ADMIN@HDEL.CO.KR"
			+ " RECE_USER=" + quote( zkun_email )  
		, ""						
		, true							
		, false							
		, true);
}
function fn_sendMailToInspection() {

	var rcv_id = ds_list_h.GetColumn(0, "PAPRID");
	var rcv_nm = ds_list_h.GetColumn(0, "PAPRIDTX");
	
	// 수신자 메일 정보 가져오기 
	ds_MailRvcList.ClearData();
	ds_cond.SetColumn(0, "PARTID", rcv_id);
	tit_clearActionInfo();
	tit_addSearchActionInfo("cs06:CS0605001A_S4");
	tit_callService(
        ""
        , ""
        , "ds_cond=ds_cond"
        , "ds_MailRvcList=ds_MailRvcList"
        , ""						
        , ""						
		, true							
		, false							
		, true);

//TRACE(ds_MailRvcList.SaveXML()); return;

	var h_rsn_row = ds_rsn.FindRow("CODE", ds_list_h.GetColumn(0,"CS107_RSN_QC")) ;
	var h_ntc_row = ds_notice_cd.FindRow("CODE", ds_list_h.GetColumn(0,"CS107_NTC_QC") ) ;
	ds_list_h.SetColumn(0, "CS107_RSN_QC_NM", ds_rsn.GetColumn(h_rsn_row,"CODE_NAME"));
	ds_list_h.SetColumn(0, "CS107_NTC_QC_NM", ds_notice_cd.GetColumn(h_ntc_row,"CODE_NAME"));

	var d_ntc_row = 0;
	for(var i=0; i<ds_list.rowcount; i++) {
		d_ntc_row = ds_notice_cd.FindRow("CODE", ds_list.GetColumn(i,"CS108_NTC_QC")) ;
		if(d_ntc_row < 0 ) {
			d_ntc_row = 0;
		}
		ds_list.SetColumn(i, "CS108_NTC_QC_NM", ds_notice_cd.GetColumn(d_ntc_row,"CODE_NAME"));
	}

	var zkun_email;
	zkun_email = ds_MailRvcList.GetColumn(0, "MAILADR");

//alert(zkun_email);
//return;

	tit_clearActionInfo();	
	tit_callService(
		"CS0609001A_ACT"
		, "sendMailToInspection"
		, "ds_list_h=ds_list_h ds_list=ds_list ds_MailRvcList=ds_MailRvcList"
		, ""
		," SEND_USER=ADMIN@HDEL.CO.KR"
			+ " RECE_USER=" + quote( zkun_email )  
		, ""						
		, true							
		, false							
		, true);
}]]></Script>
</Window>