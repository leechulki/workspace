<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="562" Id="CS0606001A" Left="8" OnLoadCompleted="fn_OnLoadCompleted" OnUnloadCompleted="fn_OnUnloadCompleted" PidAttrib="7" Title="문제점처리&#32;현황" Top="8" Ver="1.0" Width="978" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_cond">
				<Contents>
					<colinfo id="CS101_FDT_F" size="255" summ="default" type="STRING"/>
					<colinfo id="CS101_FDT_T" size="255" summ="default" type="STRING"/>
					<colinfo id="POSID" size="255" summ="default" type="STRING"/>
					<colinfo id="GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="CS101_PST" size="256" summ="default" type="STRING"/>
					<colinfo id="BSU" size="256" summ="default" type="STRING"/>
					<colinfo id="BPM" size="256" summ="default" type="STRING"/>
					<colinfo id="ARA" size="256" summ="default" type="STRING"/>
					<colinfo id="TEM" size="256" summ="default" type="STRING"/>
					<colinfo id="SCT_GBN" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZACTSS" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZLIFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN2" size="256" summ="default" type="STRING"/>
					<colinfo id="PROBLEM" size="256" summ="default" type="STRING"/>
					<colinfo id="PARTID" size="256" summ="default" type="STRING"/>
					<colinfo id="PST_A5" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK_HNO" size="256" summ="default" type="STRING"/>
					<colinfo id="CYN" size="256" summ="default" type="STRING"/>
					<colinfo id="RSN" size="256" summ="default" type="STRING"/>
					<colinfo id="DPT" size="256" summ="default" type="STRING"/>
					<record>
						<ARA></ARA>
						<BPM></BPM>
						<BSU></BSU>
						<CHK_HNO></CHK_HNO>
						<CS101_FDT_F></CS101_FDT_F>
						<CS101_FDT_T></CS101_FDT_T>
						<CS101_PST></CS101_PST>
						<CYN></CYN>
						<DPT></DPT>
						<GBN></GBN>
						<GBN2></GBN2>
						<PARTID></PARTID>
						<POSID></POSID>
						<PROBLEM></PROBLEM>
						<PST_A5></PST_A5>
						<RSN></RSN>
						<SCT_GBN></SCT_GBN>
						<TEM></TEM>
						<ZZACTSS></ZZACTSS>
						<ZZLIFNR></ZZLIFNR>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_pst_cd">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list2" OnColumnChanged="ds_list2_OnColumnChanged">
				<Contents>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="CS101_PJT" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="CS101_RCD" size="256" summ="default" type="STRING"/>
					<colinfo id="CS101_WDT" size="256" summ="default" type="STRING"/>
					<colinfo id="CS101_IGD" size="256" summ="default" type="STRING"/>
					<colinfo id="CS101_FDT" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSITE_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="KUNNR_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="CS101_HNO" size="256" summ="default" type="STRING"/>
					<colinfo id="CS101_HNA" size="256" summ="default" type="STRING"/>
					<colinfo id="CS101_VSD" size="256" summ="default" type="STRING"/>
					<colinfo id="CTEXT2" size="256" summ="default" type="STRING"/>
					<colinfo id="PAPRIDTX" size="256" summ="default" type="STRING"/>
					<colinfo id="CELLP" size="256" summ="default" type="STRING"/>
					<colinfo id="CELLP2" size="256" summ="default" type="STRING"/>
					<colinfo id="PLAT" size="256" summ="default" type="STRING"/>
					<colinfo id="BSU" size="256" summ="default" type="STRING"/>
					<colinfo id="BPM" size="256" summ="default" type="STRING"/>
					<colinfo id="NAMET2" size="256" summ="default" type="STRING"/>
					<colinfo id="ARA" size="256" summ="default" type="STRING"/>
					<colinfo id="CS108_SCT" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZACTSS" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="CS108_JYD" size="256" summ="default" type="STRING"/>
					<colinfo id="CS107_NTC_QC" size="256" summ="default" type="STRING"/>
					<colinfo id="CS107_JSD" size="256" summ="default" type="STRING"/>
					<colinfo id="CS107_QJD" size="256" summ="default" type="STRING"/>
					<colinfo id="CS107_JSD_QC" size="256" summ="default" type="STRING"/>
					<colinfo id="CS107_JSD_PS" size="256" summ="default" type="STRING"/>
					<colinfo id="CS107_CON_QC" size="256" summ="default" type="STRING"/>
					<colinfo id="CS108_QII" size="256" summ="default" type="STRING"/>
					<colinfo id="CS106_QMR" size="256" summ="default" type="STRING"/>
					<colinfo id="CS107_CYN" size="256" summ="default" type="STRING"/>
					<colinfo id="CS108_JYD2" size="256" summ="default" type="STRING"/>
					<colinfo id="CS108_TXT_QC" size="256" summ="default" type="STRING"/>
					<colinfo id="CS107_RSN_QC" size="256" summ="default" type="STRING"/>
					<colinfo id="CS107_RSN_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="CS106_MIR" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_zzactss">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_zzlifnr">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
					<colinfo id="ZZACTSS" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_partid">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list3">
				<Contents>
					<colinfo id="FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="TRAN_PHONE" size="256" summ="default" type="STRING"/>
					<colinfo id="TRAN_CALLBACK" size="256" summ="default" type="STRING"/>
					<colinfo id="TRAN_STATUS" size="256" summ="default" type="STRING"/>
					<colinfo id="TRAN_DATE" size="256" summ="default" type="STRING"/>
					<colinfo id="TRAN_MSG" size="256" summ="default" type="STRING"/>
					<colinfo id="TRAN_SUBJECT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cyn">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME>-&#32;&#32;전체&#32;&#32;-</CODE_NAME>
					</record>
					<record>
						<CODE>1</CODE>
						<CODE_NAME>처리완료</CODE_NAME>
					</record>
					<record>
						<CODE>2</CODE>
						<CODE_NAME>처리미완료</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_auth60">
				<Contents>
					<colinfo id="GNUMB" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_rsn">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_notice_cd">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_rsn_grd">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_rcond">
				<Contents>
					<colinfo id="ZPROGRAM" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN" size="256" summ="default" type="STRING"/>
					<record>
						<GBN></GBN>
						<ZPROGRAM></ZPROGRAM>
					</record>
				</Contents>
			</Dataset>
		</Datasets>
		<Shape BKColor="user0" Bottom="52" Height="52" Id="Shape0" Left="0" LineColor="user1" Right="978" TabOrder="1" Top="0" Type="Rectangle" Width="978"></Shape>
		<Static Align="Right" Height="20" Id="Static1" Left="503" Style="sty_lb_search" TabOrder="2" Text="진행상태&#32;" Top="5" VAlign="Middle" Width="80"></Static>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="CODE" Column="CS101_PST" DataColumn="CODE_NAME" Height="20" Id="cb_pst" InnerDataset="ds_pst_cd" Left="584" Style="sty_ipt_search" TabOrder="3" Top="3" Width="111"></Combo>
		<Grid AutoEnter="TRUE" AutoFitEndLine="Hide" BindDataset="ds_list2" BkColor2="default" BoldHead="true" Border="Flat" Bottom="556" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="476" Id="grd_list" InputPanel="FALSE" Left="8" LineColor="user20" LineType="ExHORZ" OnCellDBLClick="grd_list_OnCellDblClick" OnHeadClick="grd_list_OnHeadClick" Right="973" RowHeight="20" Style="sty_grid" TabOrder="4" TabStop="true" Top="80" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="965">
			<contents>
				<format id="Default">
					<columns>
						<col fix="left" width="30"/>
						<col fix="left" width="30"/>
						<col fix="left" width="65"/>
						<col fix="left" width="65"/>
						<col fix="left" width="65"/>
						<col fix="left" width="65"/>
						<col fix="left" width="57"/>
						<col fix="left" width="113"/>
						<col fix="left" width="112"/>
						<col fix="left" width="50"/>
						<col fix="left" width="40"/>
						<col width="50"/>
						<col width="65"/>
						<col width="100"/>
						<col width="65"/>
						<col width="65"/>
						<col width="100"/>
						<col width="55"/>
						<col width="50"/>
						<col width="65"/>
						<col width="60"/>
						<col width="0"/>
						<col width="65"/>
						<col width="75"/>
						<col width="55"/>
						<col width="55"/>
						<col width="65"/>
						<col width="65"/>
						<col width="65"/>
						<col width="65"/>
						<col width="50"/>
						<col width="65"/>
						<col width="89"/>
						<col width="80"/>
						<col width="80"/>
						<col width="100"/>
						<col width="200"/>
						<col width="200"/>
						<col width="50"/>
						<col width="198"/>
						<col width="65"/>
						<col width="60"/>
						<col width="65"/>
						<col width="198"/>
					</columns>
					<head>
						<cell align="center" col="0" color="user21" display="text" font="굴림,9" text="선택"/>
						<cell align="center" col="1" color="user21" display="text" font="굴림,9" text="NO"/>
						<cell align="center" col="2" color="user21" display="text" font="굴림,9" text="QC검사일"/>
						<cell align="center" col="3" color="user21" display="text" font="굴림,9" text="완성검사일"/>
						<cell align="center" col="4" color="user21" display="text" font="굴림,9" text="인계일"/>
						<cell align="center" col="5" color="user21" display="text" font="굴림,9" text="인수일"/>
						<cell align="center" col="6" color="user21" display="text" font="굴림,9" text="Proj&#32;No"/>
						<cell align="center" col="7" color="user21" display="text" font="굴림,9" text="고객명"/>
						<cell align="center" col="8" color="user21" display="text" font="굴림,9" text="현장명"/>
						<cell align="center" col="9" color="user21" display="text" font="굴림,9" text="PLAT수"/>
						<cell align="center" col="10" color="user21" display="text" font="굴림,9" text="호기"/>
						<cell align="center" col="11" color="user21" display="text" font="굴림,9" text="호기명"/>
						<cell align="center" col="12" color="user21" display="text" font="굴림,9" text="설치지역"/>
						<cell align="center" col="13" color="user21" display="text" font="굴림,9" text="설치협력사"/>
						<cell align="center" col="14" color="user21" display="text" font="굴림,9" text="작업팀장"/>
						<cell align="center" col="15" color="user21" display="text" font="굴림,9" text="대지역"/>
						<cell align="center" col="16" color="user21" display="text" font="굴림,9" text="보수협력사"/>
						<cell align="center" col="17" color="user21" display="text" font="굴림,9" text="업체구분"/>
						<cell align="center" col="18" color="user21" display="text" font="굴림,9" text="보수PM"/>
						<cell align="center" col="19" color="user21" display="text" font="굴림,9" text="방문일"/>
						<cell align="center" col="20" color="user21" display="text" font="굴림,9" text="진행상태"/>
						<cell align="center" col="21" color="user21" display="text" font="굴림,9" text="설치부통보"/>
						<cell align="center" col="22" color="user21" display="text" font="굴림,9" text="설치검사원"/>
						<cell align="center" col="23" color="user21" display="text" font="굴림,9" text="QC통보부서"/>
						<cell align="center" col="24" color="user21" display="text" font="굴림,9" text="발생사유"/>
						<cell align="center" col="25" color="user21" display="text" font="굴림,9" text="조치결과"/>
						<cell align="center" bkcolor="user40" col="26" color="user21" display="text" font="굴림,9" text="보수작성일"/>
						<cell align="center" bkcolor="user40" col="27" color="user21" display="text" font="굴림,9" text="보수접수일"/>
						<cell align="center" bkcolor="user23" col="28" color="user21" display="text" font="굴림,9" text="QC작성일"/>
						<cell align="center" bkcolor="user23" col="29" color="user21" display="text" font="굴림,9" text="QC확인일"/>
						<cell align="center" col="30" color="user21" display="text" font="굴림,9" text="설치PM"/>
						<cell align="center" bkcolor="user1" col="31" color="user21" display="text" font="굴림,9" text="설치작성일"/>
						<cell align="center" bkcolor="user40" col="32" color="user21" display="text" font="굴림,9" text="보수담당확인"/>
						<cell align="center" col="33" color="user21" display="text" font="굴림,9" text="문제점보고"/>
						<cell align="center" col="34" color="user21" display="text" font="굴림,9" text="OCR성적서"/>
						<cell align="center" col="35" color="user21" display="text" font="굴림,9" text="검사항목"/>
						<cell align="center" col="36" color="user21" display="text" font="굴림,9" text="중점내용"/>
						<cell align="center" col="37" color="user21" display="text" font="굴림,9" text="문제점"/>
						<cell align="center" col="38" color="user21" display="text" font="굴림,9" text="조치부서"/>
						<cell align="center" col="39" color="user21" display="text" font="굴림,9" text="조치계획"/>
						<cell align="center" col="40" color="user21" display="text" font="굴림,9" text="조치예정일"/>
						<cell align="center" col="41" color="user21" display="text" font="굴림,9" text="발생사유"/>
						<cell align="center" col="42" color="user21" display="text" font="굴림,9" text="조치일"/>
						<cell align="center" col="43" color="user21" display="text" font="굴림,9" text="조치결과"/>
					</head>
					<body>
						<cell align="center" bkcolor2="user22" col="0" colid="CHK" display="checkbox" edit="checkbox"/>
						<cell align="center" bkcolor2="user22" col="1" display="text" expr="currow+1"/>
						<cell align="center" bkcolor2="user22" col="2" colid="CS101_RCD" display="text" Mask="####.##.##"/>
						<cell align="center" bkcolor2="user22" col="3" colid="CS101_WDT" display="text" Mask="####.##.##"/>
						<cell align="center" bkcolor2="user22" col="4" colid="CS101_IGD" display="text" Mask="####.##.##"/>
						<cell align="center" bkcolor2="user22" col="5" colid="CS101_FDT" display="text" Mask="####.##.##"/>
						<cell bkcolor2="user22" col="6" colid="CS101_PJT" display="text"/>
						<cell bkcolor2="user22" col="7" colid="KUNNR_NM" display="text"/>
						<cell bkcolor2="user22" col="8" colid="ZSITE_NM" display="text"/>
						<cell align="center" bkcolor2="user22" col="9" colid="PLAT" display="text"/>
						<cell align="center" bkcolor2="user22" col="10" colid="CS101_HNO" display="text"/>
						<cell bkcolor2="user22" col="11" colid="CS101_HNA" display="text"/>
						<cell align="center" bkcolor2="user22" col="12" colid="ZZACTSS" display="text"/>
						<cell bkcolor2="user22" col="13" colid="LIFNR" display="text"/>
						<cell align="center" bkcolor2="user22" col="14" colid="NAMET2" display="text"/>
						<cell align="center" bkcolor2="user22" col="15" colid="ARA" display="text"/>
						<cell bkcolor2="user22" col="16" colid="BSU" display="text"/>
						<cell align="center" bkcolor2="user22" col="17" colid="BSU_GB" display="text"/>
						<cell align="center" bkcolor2="user22" col="18" colid="BPM" display="text"/>
						<cell align="center" bkcolor2="user22" col="19" colid="CS101_VSD" display="text" Mask="####.##.##"/>
						<cell align="center" bkcolor2="user22" col="20" colid="CTEXT2" display="text"/>
						<cell align="center" bkcolor2="user22" col="21" colid="CS108_SCT" display="text"/>
						<cell align="center" bkcolor2="user22" col="22" colid="PAPRIDTX" display="text"/>
						<cell align="center" bkcolor2="user22" col="23" colid="CS107_NTC_QC" combocol="CODE" combodataset="ds_notice_cd" combotext="CODE_NAME" display="combo"/>
						<cell align="center" bkcolor2="user22" col="24" colid="CS107_RSN_NM" display="text"/>
						<cell align="center" bkcolor2="user22" col="25" colid="CS108_JYD" display="text"/>
						<cell align="center" bkcolor2="user22" col="26" colid="CS107_JSD" display="text" Mask="####.##.##"/>
						<cell align="center" bkcolor2="user22" col="27" colid="CS107_QJD" display="text" Mask="####.##.##"/>
						<cell align="center" bkcolor2="user22" col="28" colid="CS107_JSD_QC" display="text" Mask="####.##.##"/>
						<cell align="center" bkcolor2="user22" col="29" colid="CS107_CON_QC" display="text" Mask="####.##.##"/>
						<cell align="center" bkcolor2="user22" col="30" colid="PS_NAMET" display="text"/>
						<cell align="center" bkcolor2="user22" col="31" colid="CS107_JSD_PS" display="text" Mask="####.##.##"/>
						<cell align="center" bkcolor2="user22" col="32" colid="CS107_CYN_NM" combotext="CODE_NAME" display="text"/>
						<cell align="center" bkcolor2="user22" bkimagealign="stretch" bkimageid="btn_grid_01" col="33" cursor="hand" display="button" text="문제점보고"/>
						<cell align="center" bkcolor2="user22" bkimagealign="stretch" bkimageid="btn_grid_01" col="34" cursor="hand" display="button" text="성적서확인"/>
						<cell bkcolor2="user22" col="35" colid="CS106_QMR" display="text"/>
						<cell bkcolor2="user22" col="36" colid="CS106_MIR" display="text"/>
						<cell bkcolor2="user22" col="37" colid="CS108_QII" display="text"/>
						<cell align="center" bkcolor2="user22" col="38" colid="CS108_NTC_QC" combocol="CODE" combodataset="ds_notice_cd" combotext="CODE_NAME" display="combo"/>
						<cell bkcolor2="user22" col="39" colid="CS108_TXT_QC" display="text"/>
						<cell bkcolor2="user22" col="40" colid="CS108_JYD2" display="text" Mask="####.##.##"/>
						<cell align="center" bkcolor2="user22" col="41" colid="CS108_RSN_QC" combocol="CODE" combodataset="ds_rsn_grd" combotext="CODE_NAME" display="combo"/>
						<cell bkcolor2="user22" col="42" colid="CS108_JCD" display="text" Mask="####.##.##"/>
						<cell bkcolor2="user22" col="43" colid="CS108_JCR" display="text"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Static Align="Right" Height="20" Id="st_cs101_fdt" Left="5" Style="sty_lb_search" TabOrder="5" Text="인수일&#32;" Top="4" VAlign="Middle" Width="80"></Static>
		<Calendar BindDataset="ds_cond" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="CS101_FDT_F" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_cs101_fdt_f" Left="87" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_search" SundayTextColor="user35" TabOrder="8" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="4" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="97"></Calendar>
		<Static Align="Center" Border="None" Color="user7" Font="굴림,9" Height="20" Id="Static13" Left="187" TabOrder="7" Text="~" Top="5" VAlign="Middle" Width="18"></Static>
		<Calendar BindDataset="ds_cond" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="CS101_FDT_T" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_cs101_fdt_t" Left="207" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_search" SundayTextColor="user35" TabOrder="9" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="4" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="97"></Calendar>
		<Static Align="Right" Height="20" Id="Static2" Left="306" Style="sty_lb_search" TabOrder="6" Text="Proj&#32;No&#32;" Top="5" VAlign="Middle" Width="80"></Static>
		<Edit BindDataset="ds_cond" Border="Flat" Column="POSID" Height="20" Id="ed_pjt" Left="388" Style="sty_ipt_search" TabOrder="10" Top="5" Width="57"></Edit>
		<Button Height="18" Id="Button0" ImageID="btn_icon_search" Left="447" OnClick="btn_pjt_OnClick" TabOrder="11" Text="Button0" Top="5" Width="18"></Button>
		<Static Align="Right" Height="20" Id="st_bsu" Left="5" Style="sty_lb_search" TabOrder="12" Text="보수&#32;협력사&#32;" Top="26" VAlign="Middle" Width="80"></Static>
		<Div BKColor="user0" Height="20" Id="div_code" Left="87" OnLoadCompleted="fn_OnLoadCompleted" OnTimer="WB0199010A_OnTimer" TabOrder="13" Text="Div0" Top="27" Url="WB01::WB0199010A.xml" Width="415">
			<Contents></Contents>
		</Div>
		<Static Align="Right" Height="20" Id="st_zzactss" Left="503" Style="sty_lb_search" TabOrder="14" Text="설치&#32;협력사&#32;" Top="27" VAlign="Middle" Width="80"></Static>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="CODE" Column="ZZACTSS" DataColumn="CODE_NAME" Height="20" Id="cb_zzactss" InnerDataset="ds_zzactss" Left="584" OnChanged="cb_zzactss_OnChanged" Style="sty_ipt_search" TabOrder="15" Top="26" Width="111"></Combo>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="CODE" Column="ZZLIFNR" DataColumn="CODE_NAME" Height="20" Id="cb_zzlifnr" InnerDataset="ds_zzlifnr" Left="695" Style="sty_ipt_search" TabOrder="16" Top="26" Width="111"></Combo>
		<Checkbox BindDataset="ds_cond" BKColor="user0" Column="PROBLEM" Height="21" Id="chk_problem" Left="801" TabOrder="17" Text="문제점없음" Top="5" Value="FALSE" Width="97"></Checkbox>
		<Static Align="Right" Height="20" Id="Static0" Left="807" Style="sty_lb_search" TabOrder="18" Text="설치검사원&#32;" Top="27" VAlign="Middle" Width="80"></Static>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="CODE" Column="PARTID" DataColumn="CODE_NAME" Height="20" Id="cb_partid" InnerDataset="ds_partid" Left="888" OnChanged="cb_partid_OnChanged" Style="sty_ipt_search" TabOrder="19" Top="26" Width="85"></Combo>
		<Checkbox BindDataset="ds_cond" BKColor="user0" Column="PST_A5" DisableBKColor="user0" Enable="FALSE" FalseValue="0" Height="21" Id="chk_pst_a5" Left="697" TabOrder="20" Text="보수접수&#32;기준" Top="5" Value="FALSE" Width="103"></Checkbox>
		<Checkbox BindDataset="ds_cond" BKColor="user0" Column="CHK_HNO" DisableBKColor="user0" Enable="FALSE" FalseValue="0" Height="21" Id="chk_hno" Left="885" TabOrder="21" Text="호기별&#32;출력" Top="5" Value="FALSE" Width="83"></Checkbox>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_sms" ImageID="btn_sub_04" Left="902" LeftMargin="12" OnClick="btn_sms_OnClick" Style="sty_btn" TabOrder="22" Text="SMS전송" Top="56" Transparent="TRUE" Visible="FALSE" Width="75"></Button>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="CODE" Column="CYN" DataColumn="CODE_NAME" Height="20" Id="cb_cyn" InnerDataset="ds_cyn" Left="808" OnChanged="cb_partid_OnChanged" Style="sty_ipt_search" TabOrder="24" Top="55" Width="85"></Combo>
		<Static Align="Right" BKColor="user5" Color="black" Height="20" Id="st_cyn" Left="696" Style="sty_lb_search" TabOrder="23" Text="보수담당자&#32;확인&#32;" Top="55" VAlign="Middle" Width="111"></Static>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="CODE" Column="RSN" DataColumn="CODE_NAME" Height="20" Id="cb_rsn" InnerDataset="ds_rsn" Left="584" Style="sty_ipt_search" TabOrder="25" Top="55" Width="80"></Combo>
		<Static Align="Right" BKColor="user5" Color="black" Height="20" Id="st_rsn" Left="504" Style="sty_lb_search" TabOrder="26" Text="발생&#32;사유&#32;" Top="56" VAlign="Middle" Width="71"></Static>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_manage_receive_mail" ImageID="btn_sub_07" Left="382" LeftMargin="12" OnClick="btn_manage_receive_mail_OnClick" Style="sty_btn" TabOrder="27" Text="Mail&#32;수신&#32;리스트" Top="56" Transparent="TRUE" Visible="FALSE" Width="114"></Button>
	</Form>
	<Script><![CDATA[﻿﻿﻿﻿﻿﻿/*
 ******************************************************************************************
 * 기      능   : 
 * 작  성  자   : 
 * 작성  일자   : 
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
#include "LIB::commons.js";	// 공통 스크립트 
#include "LIB::nsfRequest.js";
#include "LIB::common_sd.js";
#include "LIB::common_cs.js";	// 서비스 공통 스크립트
//=========================================================================================
// [ PART 1 ]
// Form에서 사용될 전역변수를 선언
// FORM에서 사용되는 전역변수는 대문자로 작성하며, F_XXX 의 형태를 갖도록 한다. 
//=========================================================================================
var gRow = null;
var user_grp = "";
var pdchang_visible = false;
//=========================================================================================
// [ PART 2 ]
// Form Loading / Unloading 시 작업 정의
//=========================================================================================
function fn_OnLoadCompleted(obj) {
	// Form 로드 이벤트 맨 첫줄에 기술 
	gfn_initForm(true);
    
    user_grp = gfn_getUserGroup();

    fn_chkAuth60(); // 효율 개선부 ZCS72  권한 체크
    
	//인계일 : 현재월의 첫날짜, 마지막날짜
	var firstDay = substr(gfn_getCurrDate(),0,6)+"01";
	var lastDay = gfn_getCurrDate();
	cal_cs101_fdt_f.value = firstDay;
	cal_cs101_fdt_t.value = lastDay;
    	
	//코드콤보 설정 : 지역
	var codeArr = ["CS183","PS003","CS204"];
	var dsObjArr = [ds_pst_cd,ds_zzactss,ds_rsn];
	var addTypeArr = [G_CODE_ALL,G_CODE_ALL,G_CODE_ALL];
	gfn_searchCommCode(codeArr, dsObjArr, addTypeArr);
	
	// QC 판정 부서
	gfn_queryDD07T("ZCS_NTC_CD", ds_notice_cd, "N");
	
	tit_clearActionInfo();
	tit_addSearchActionInfo("ps02:PS0203001A_S1");
	tit_addSearchActionInfo("ps02:PS0203001A_S2");
	tit_callService(
		""
		, ""
		, "ds_cond_cd=ds_cond"
		, "ds_zzlifnr=ds_zzlifnr ds_partid=ds_partid"
		, ""
		, "fn_afterZzlifnr"
		, true,true);
	
	ed_pjt.SetFocus();
}
/********************************************************************************
* 기      능   : 공통코드가 조회된 후의 Callback 함수 
********************************************************************************/
function fn_completeInit(sCode, sDsObj, sCodeType) {
	cb_pst.Value = "";
	cb_zzactss.Index = 0;
	
	cb_rsn.Index = 0 ;

	chk_pst_a5.Value = false; 
	chk_hno.Value = false; 
	
	// QC 서비스 모두 사용토록 201602
	chk_pst_a5.Enable = true; // 보수접수일 기준 조회 가능
	chk_hno.Enable = true; //문제점 항목별 조회 가능


	//서비스 효율개선팀(조영재DL, 김나영SW, 이충규 SW) SMS 전송 버튼 활성화 : 미접수 사항 독촉
	// if (G_USER_ID == "2020041" || G_USER_ID == "2025388" || G_USER_ID == "2025396" ||
		// G_USER_ID == "2017750" || G_USER_ID == "2021200" || G_USER_ID == "2023687" ||
		// G_USER_ID == "2018900" || G_USER_ID == "2029758" || G_USER_ID == "2999999") {

		// btn_sms.Visible = true;
	// }
	//============== 서비스 효율개선팀(조영재DL, 김나영SW, 이충규 SW) SMS 전송 버튼 활성화 : 미접수 사항 독촉==============	
	gfn_initDs(ds_rcond, true);
	ds_rcond.SetColumn(0, "ZPROGRAM", "CS0606001A");
	ds_rcond.SetColumn(0, "GBN", "01");	
	pdchang_visible = gfn_getAuth(ds_rcond);
	ds_rcond.ClearData();

	if (pdchang_visible == true) {	
		btn_sms.Visible = true;
	}
	//==========================================================================================

	// 메일수신 관리 팝업 김종욱-전현정
	// if(G_USER_ID == "2021692" || G_USER_ID == "2021056" || G_USER_ID == "2018900" || G_USER_ID == "2029758" || G_USER_ID == "2999999"){
		// btn_manage_receive_mail.Visible = true;
	// } 
	//============== 서비스 효율개선팀(조영재DL, 김나영SW, 이충규 SW) SMS 전송 버튼 활성화 : 미접수 사항 독촉==============	
	pdchang_visible = false;
	gfn_initDs(ds_rcond, true);
	ds_rcond.SetColumn(0, "ZPROGRAM", "CS0606001A");
	ds_rcond.SetColumn(0, "GBN", "02");	
	pdchang_visible = gfn_getAuth(ds_rcond);
	ds_rcond.ClearData();

	if (pdchang_visible == true) {	
		btn_manage_receive_mail.Visible = true;
	}	
	//==========================================================================================
	ds_rsn_grd.Copy("ds_rsn");
	ds_rsn_grd.DeleteRow(0);
	
}
/********************************************************************************
* 기      능   : form UnloadCompleted 
********************************************************************************/
function fn_OnUnloadCompleted(obj) {
	return gfn_isFormUnload(obj);
}

var auth60 = false; 
function fn_chkAuth60(){
	ds_auth60.ClearData();
	
	tit_clearActionInfo();																	
	tit_addSearchActionInfo("cs06:CS0606001A_S2");									
	tit_callService(		
			""
			, ""							
			, ""							
			, "ds_auth60=ds_list"							
			, ""							
			, ""							
			, true							
			, false							
			, true); 
			
	if(ds_auth60.RowCount() > 0) {
		auth60 = true;
	}
}

//=========================================================================================
// [ PART 3 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,form닫기)
//=========================================================================================
/********************************************************************************
* 기      능   : 조회 (신규인수 관리)
********************************************************************************/
function fn_query() {
	if(length(ed_pjt.value) == 0)
		// 인계일자
		if ( !gfn_checkFromToObj(cal_cs101_fdt_f, cal_cs101_fdt_t, true, st_cs101_fdt.value, 0, true) ) {
			return;
		}

	if(user_grp == "10") { // 보수협력사일 경우
		ds_cond.SetColumn(0, "BSU", G_LGORT);
		ds_cond.SetColumn(0, "TEM", '');
		ds_cond.SetColumn(0, "BPM", '');
		ds_cond.SetColumn(0, "ARA", '');
	} else if(user_grp == "20") { // 보수PM일 경우
		ds_cond.SetColumn(0, "BSU", trim(div_code.cb_small.value));
		ds_cond.SetColumn(0, "TEM", '');
		ds_cond.SetColumn(0, "BPM", G_USER_ID);
		ds_cond.SetColumn(0, "ARA", '');
	} else if(user_grp == "30") { // 지방사무소일 경우
		ds_cond.SetColumn(0, "BSU", trim(div_code.cb_small.value));
		ds_cond.SetColumn(0, "TEM", G_SAP_USER_VGCD);
		ds_cond.SetColumn(0, "BPM", '');
		ds_cond.SetColumn(0, "ARA", '');
	} else if(user_grp == "40") { // 고객지원부일 경우
		//====================================수정시작=======================================	
		/*
		ds_cond.SetColumn(0, "BSU", trim(div_code.cb_small.value));
		if(div_code.cb_big.value == '1') { // 협력사 콤보1이 지역일 경우
			ds_cond.SetColumn(0, "TEM", '');
			ds_cond.SetColumn(0, "BPM", '');
			ds_cond.SetColumn(0, "ARA", trim(div_code.cb_mid.value));
		} else if(div_code.cb_big.value == '2') { // 협력사 콤보1이 PM일 경우
			ds_cond.SetColumn(0, "TEM", '');
			ds_cond.SetColumn(0, "BPM", trim(div_code.cb_mid.value));
			ds_cond.SetColumn(0, "ARA", '');
		} else { // 협력사 콤보1이 팀일 경우
			ds_cond.SetColumn(0, "TEM", trim(div_code.cb_mid.value));
			ds_cond.SetColumn(0, "BPM", '');
			ds_cond.SetColumn(0, "ARA", '');
		}
		*/
		
		if(div_code.cb_big.value == '1') { // 협력사 콤보1이 지역일 경우
			ds_cond.SetColumn(0, "TEM", '');
			ds_cond.SetColumn(0, "BPM", '');
			ds_cond.SetColumn(0, "ARA", trim(div_code.cb_mid.value));
			ds_cond.SetColumn(0, "DPT", '');
			ds_cond.SetColumn(0, "BSU", trim(div_code.cb_small.value));
		
		} else if(div_code.cb_big.value == '2') { // 협력사 콤보1이 PM일 경우
			ds_cond.SetColumn(0, "TEM", '');
			ds_cond.SetColumn(0, "BPM", trim(div_code.cb_mid.value));
			ds_cond.SetColumn(0, "ARA", '');
			ds_cond.SetColumn(0, "DPT", '');
			ds_cond.SetColumn(0, "BSU", trim(div_code.cb_small.value));
			
		} else if(div_code.cb_big.value == '3') { // 협력사 콤보1이 팀 
			ds_cond.SetColumn(0, "TEM", trim(div_code.cb_mid.value));
			ds_cond.SetColumn(0, "BPM", '');
			ds_cond.SetColumn(0, "ARA", '');
			ds_cond.SetColumn(0, "DPT", '');
			ds_cond.SetColumn(0, "BSU", trim(div_code.cb_small.value));
			
		} else { // 협력사 콤보1이 부서일 경우
			ds_cond.SetColumn(0, "TEM", trim(div_code.cb_small.value));
			ds_cond.SetColumn(0, "BPM", '');
			ds_cond.SetColumn(0, "ARA", '');
			ds_cond.SetColumn(0, "DPT", substr(trim(div_code.cb_mid.value),0,2));
			ds_cond.SetColumn(0, "BSU", '');
		}			
		//====================================수정끝=======================================	
		
		
	}

	if(auth60 == true) {	// 효율개선부인경우 ZCS72		
		ds_cond.SetColumn(0, "GBN2", "B");
		//====================================수정시작=======================================	
		/*
		ds_cond.SetColumn(0, "BSU", trim(div_code.cb_small.value));
		if(div_code.cb_big.value == '1') { // 협력사 콤보1이 지역일 경우
			ds_cond.SetColumn(0, "TEM", '');
			ds_cond.SetColumn(0, "BPM", '');
			ds_cond.SetColumn(0, "ARA", trim(div_code.cb_mid.value));
		} else if(div_code.cb_big.value == '2') { // 협력사 콤보1이 PM일 경우
			ds_cond.SetColumn(0, "TEM", '');
			ds_cond.SetColumn(0, "BPM", trim(div_code.cb_mid.value));
			ds_cond.SetColumn(0, "ARA", '');
		} else { // 협력사 콤보1이 팀일 경우
			ds_cond.SetColumn(0, "TEM", trim(div_code.cb_mid.value));
			ds_cond.SetColumn(0, "BPM", '');
			ds_cond.SetColumn(0, "ARA", '');
		}
		*/
		
		if(div_code.cb_big.value == '1') { // 협력사 콤보1이 지역일 경우
			ds_cond.SetColumn(0, "TEM", '');
			ds_cond.SetColumn(0, "BPM", '');
			ds_cond.SetColumn(0, "ARA", trim(div_code.cb_mid.value));
			ds_cond.SetColumn(0, "DPT", '');
			ds_cond.SetColumn(0, "BSU", trim(div_code.cb_small.value));
		
		} else if(div_code.cb_big.value == '2') { // 협력사 콤보1이 PM일 경우
			ds_cond.SetColumn(0, "TEM", '');
			ds_cond.SetColumn(0, "BPM", trim(div_code.cb_mid.value));
			ds_cond.SetColumn(0, "ARA", '');
			ds_cond.SetColumn(0, "DPT", '');
			ds_cond.SetColumn(0, "BSU", trim(div_code.cb_small.value));
			
		} else if(div_code.cb_big.value == '3') { // 협력사 콤보1이 팀 
			ds_cond.SetColumn(0, "TEM", trim(div_code.cb_mid.value));
			ds_cond.SetColumn(0, "BPM", '');
			ds_cond.SetColumn(0, "ARA", '');
			ds_cond.SetColumn(0, "DPT", '');
			ds_cond.SetColumn(0, "BSU", trim(div_code.cb_small.value));
			
		} else { // 협력사 콤보1이 부서일 경우
			ds_cond.SetColumn(0, "TEM", trim(div_code.cb_small.value));
			ds_cond.SetColumn(0, "BPM", '');
			ds_cond.SetColumn(0, "ARA", '');
			ds_cond.SetColumn(0, "DPT", substr(trim(div_code.cb_mid.value),0,2));
			ds_cond.SetColumn(0, "BSU", '');
		}								
		//====================================수정끝=======================================	
		
	} else {
		if(G_USER_GROUP_E == 'E40')	// 설치
		{
			ds_cond.SetColumn(0, "BPM", '');
			ds_cond.SetColumn(0, "ARA", '');
			ds_cond.SetColumn(0, "BSU", '');
			ds_cond.SetColumn(0, "GBN2", "C");
		}
		else if(G_USER_GROUP_E == 'E30')	// 설치
		{
			ds_cond.SetColumn(0, "BPM", '');
			ds_cond.SetColumn(0, "ARA", '');
			ds_cond.SetColumn(0, "BSU", '');
			ds_cond.SetColumn(0, "ZZACTSS", G_AREA_CODE);
			ds_cond.SetColumn(0, "GBN2", "C");
		}
		else
		{
			ds_cond.SetColumn(0, "ZZACTSS", '');
			ds_cond.SetColumn(0, "ZZLIFNR", '');
			ds_cond.SetColumn(0, "GBN2", "A");
		}

		//기존 'E40'이 처리하기로 되어있었는데 'E30'도 처리가능하도록 수정 - 2010.2.11 한상협CJ
		if(G_USER_GROUP_E == 'E40' || G_USER_GROUP_E == 'E30')
		{
			ds_cond.SetColumn(0,"SCT_GBN","Y");
		}
	}

	gRow = null;
	ds_cond.SetColumn(0, "PROBLEM", chk_problem.Value);
	ds_cond.SetColumn(0, "CHK_HNO", chk_hno.Value);
	ds_cond.SetColumn(0, "PST_A5", chk_pst_a5.Value);

	tit_clearActionInfo();
	tit_addSearchActionInfo("cs06:CS0606001A_S1");
	
	tit_callService(
        ""
        , ""
        , "ds_cond=ds_cond"
        , "ds_list2=ds_list"
        , ""
        , "fn_afterQuery"
        , true);
}

/********************************************************************************
* 기      능   : 닫기  
********************************************************************************/
function fn_close() {
	close();
}

//=========================================================================================
// [ PART 4]
// Callback 함수 정의 : callback 함수명은 메인 함수의 fn_xxxx() 에서 xxxx 부분은 fn_afterXXXX()
// 형태가 되도록 작성 
//=========================================================================================
/********************************************************************************
* 기      능   : 조회 Callback  
********************************************************************************/
function fn_afterQuery(errCode, errMsg) {
/*	
	if(G_USER_GROUP_E == 'E40')
	{
		ds_list2.Filter("CS108_SCT=='Y'");
		gfn_showMsg("CI00002",ds_list2.RowCount()+"");
	}
	else
	{
		ds_list2.Filter("1==1");
		gfn_showMsg("CI00002",ds_list2.RowCount()+"");
	}
*/	
	gfn_showMsg("CI00002",ds_list2.RowCount()+"");
	ds_cond.SetColumn(0,"BSU", '');
	ds_cond.SetColumn(0,"BPM", '');
	ds_cond.SetColumn(0,"ARA", '');
	ds_cond.SetColumn(0,"TEM", '');
}
/********************************************************************************
* 기      능   : 조회 Callback  :주점검자,부점검자 콤보
********************************************************************************/
function fn_afterQueryCd(errCode, errMsg) {
	//ds_buj_cd.copy(ds_juj_cd);
}
/********************************************************************************
* 기      능   : COMBO 조회 Callback  - 사무소,협력업체
********************************************************************************/
function fn_afterZzlifnr(errCode, errMsg) {
	gfn_insertEmptyRow( ds_zzlifnr, G_CODE_ALL );
	gfn_insertEmptyRow( ds_partid, G_CODE_ALL );
	cb_zzlifnr.Index = 0;
	cb_partid.Index = 0;

	var idx = ds_partid.FindRow("CODE", G_USER_ID);

	if(idx >= 0 && substr(G_USER_GROUP_E,0,1) == 'E') {   // 설치 검사원 리스트 ZQMT031
		cb_partid.Value = G_USER_ID;
		//cb_partid.Enable = false;
	} else if(auth60 == true) { 
		// 효율개선부 ZCS72
	} else {
		if(substr(G_USER_GROUP_E,0,1) == 'E') // 설치
		{
			div_code.Enable = false;
			cb_partid.Enable = false;

			ds_pst_cd.Filter("CODE >= 'C0' || CODE == ''");
			cb_pst.Index = 0;
		}
		else
		{ // 서비스
			cb_zzactss.Enable = false;
			cb_zzlifnr.Enable = false;
			cb_partid.Enable = false;
			// 보수 담당자도 전체 데이타 조회 가능토록 20150811
			//ds_pst_cd.Filter("CODE <= 'A6' || CODE == ''");
			cb_pst.Index = 0;
		}
	}
}
//=========================================================================================
// [ PART 5 ]
// Detail Process Event 정의 ( User Define function )
// 사용자 정의 함수는 ufn_xxxx() 형태로 작성 
//=========================================================================================
/********************************************************************************
* 기      능   : 사용자 정의 함수  
********************************************************************************/
function ufn_userfunction() {
}

//=========================================================================================
// [ PART 6 ]
// component Event 정의 : 각 Component 별 이벤트 
//=========================================================================================
function grd_list_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
{
	gfn_sortGrid(obj,nCell);
}

/********************************************************************************
* 기      능   : 원프로젝트 팝업
********************************************************************************/
function btn_pjt_OnClick(obj)
{
	var arg = "pjt="+quote(ed_pjt.Text);
	gfn_openPopup("CS9601002A",true,arg);
	//var arr = gfn_openPopup("CS9601002A",true,arg);
	//if ( arr != null ) {
	//	ed_pjt.value = arr[0];
	//}
}
/********************************************************************************
* 기      능   : 액셀  
********************************************************************************/
function fn_excel() {
	gfn_saveToExcel(grd_list, true);
}
/********************************************************************************
* 기      능   : 문제점보고서 작성 팝업
********************************************************************************/
function grd_list_OnCellDblClick(obj,nRow,nCell,nX,nY,nPivotIndex) {
	ds_list2.row = nRow;
	var arg = "";

	if(nCell == 33)
	{	
		arg = "cellp=" + quote(ds_list2.GetColumn(nRow,"CELLP"))
	        + "auth60=" + auth60;
		gfn_openPopup("CS0605001A",true,arg);
	}
	else if(nCell == 34)
	{
		arg = "s_pspid="+quote(ds_list2.GetColumn(nRow, "CS101_PJT")) +
		      " s_posid="+quote(ds_list2.GetColumn(nRow, "CS101_HNO")) +
			  " s_gbn='CS'";		
		gfn_openWin("QM0503004A",arg);  
	}
	
	
}

/********************************************************************************
* 기      능   : 사무소 변경시 협력업체 FILTERING
********************************************************************************/
function cb_zzactss_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	if(strCode == '') ds_zzlifnr.Filter("1==1");
	else ds_zzlifnr.Filter("ZZACTSS=="+quote(strCode)+" || CODE==''");
	cb_zzlifnr.Index = 0;
}

function cb_partid_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex) {
	var idx = ds_partid.FindRow("CODE", G_USER_ID);
}

function ds_list2_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex) {
	if(strColumnID == "CHK") {
		if(ds_list2.getColumn(nRow, "CHK") == "1") {
			if(gRow != null) {
				ds_list2.SetColumn(gRow, "CHK", "0");
			}

			gRow = nRow;
		} else {
			if(gRow == nRow) {
				gRow = null;
			}
		}
	}
}

function btn_sms_OnClick(obj) {
	gfn_clearMsgBar();

	if(ds_list2.rowCount() < 1) {
		gfn_showMsg("CW00010");
		return;
	}

	if(ds_list2.FindRow("CHK", 1) == -1) {
		gfn_showMsg("CW00013");
		return;
	}

	var tmp_jsd, tmp_qjd, tmp_qcd, str;

	tmp_jsd = trim(ds_list2.GetColumn(ds_list2.currow, "CS107_JSD"));		// 보수작성일
	tmp_qjd = trim(ds_list2.GetColumn(ds_list2.currow, "CS107_QJD"));		// 보수접수일
	tmp_qcd = trim(ds_list2.GetColumn(ds_list2.currow, "CS107_JSD_QC"));	// QC작성일

	if(length(tmp_jsd) > 0) {
		if(length(tmp_qjd) == 0) {
			str = "A";
		} else {
			if(length(tmp_qcd) == 0) {
				str = "B";
			} else {
				str = "C";
			}
		}
	} else {
		str = "C";
	}

	fn_sendSms(str);
}

function fn_sendSms(arr) {
	var tel;
	var txt;
	var msg;

	if(arr == "C") {
		gfn_showAlert("메세지 전송이 불가능한 상태입니다.");
		return;
	}

	ds_list3.ClearData();

	if(arr == "A") {		// 보수PM에게 SMS 전송
		tel = ds_list2.GetColumn(ds_list2.currow, "CELLP2"); // 보수PM
		txt = "빠른 시간안에 접수하시기 바랍니다.";
	} else if(arr == "B") {	// QC담당자에게 SMS 전송
		tel = "010-3345-9541";	// QC담당자(김대식SW) 휴대폰 번호
		txt = "빠른 시간안에 작성하시기 바랍니다.";
	}

	msg = "[문제점보고] "
	      + ds_list2.GetColumn(ds_list2.currow, "CS101_PJT") + " "
	      + substr(ds_list2.GetColumn(ds_list2.currow, "ZSITE_NM"),0,10) + ".."+ " "
	      + txt;

	ds_list3.AddRow();
	ds_list3.SetColumn(0, "FLAG", "U");
	ds_list3.SetColumn(0, "TRAN_SUBJECT", "[문제점보고 독촉]");
	ds_list3.SetColumn(0, "TRAN_PHONE", tel);
	ds_list3.SetColumn(0, "TRAN_CALLBACK", '02-3670-1213'); // 2018 03 21 
	ds_list3.SetColumn(0, "TRAN_STATUS", "0");
	ds_list3.SetColumn(0, "TRAN_DATE", "");
	ds_list3.SetColumn(0, "TRAN_MSG", msg);

	tit_clearActionInfo();
	tit_addSaveActionInfo(
        ""
        , "cs06:CS0605001A_I18"
        , ""
        , "FLAG");
	tit_callService(
        "PDA_ACT"
        , ""
        , "ds_list_m=ds_list3:A"
        , ""
        , ""
        , "fn_afterSms");
}

function fn_afterSms(errCode, errMsg) {
	if(errCode != 0) {
		gfn_showMsg("CE00001");
	} else {
		gfn_showAlert("메세지 전송이 완료되었습니다."); 
	}
}

function btn_manage_receive_mail_OnClick(obj)
{
	gfn_openPopup("CS0605001G",true);
}
]]></Script>
</Window>