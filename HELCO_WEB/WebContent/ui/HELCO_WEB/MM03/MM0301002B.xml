<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="562" Id="MM0301002B" Left="8" OnLoadCompleted="fn_OnLoadCompleted" OnUnloadCompleted="fn_OnUnloadCompleted" PidAttrib="7" Title="현장별&#32;거래명세서&#32;상세" Top="8" Ver="1.0" Width="978" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_pro_f_cd">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_werks_cd">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ekgrp_cd">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_key">
				<Contents>
					<colinfo id="INVNR" size="31" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_potype">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
					<record>
						<CODE>X</CODE>
						<CODE_NAME>대상</CODE_NAME>
					</record>
					<record>
						<CODE></CODE>
						<CODE_NAME>비대상</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond">
				<Contents>
					<colinfo id="UDATE1" size="255" summ="default" type="STRING"/>
					<colinfo id="UDATE2" size="255" summ="default" type="STRING"/>
					<colinfo id="EKGRP" size="255" summ="default" type="STRING"/>
					<colinfo id="INVNR" size="255" summ="default" type="STRING"/>
					<colinfo id="LGORT" size="255" summ="default" type="STRING"/>
					<colinfo id="LIFNR" size="255" summ="default" type="STRING"/>
					<colinfo id="MATNR" size="255" summ="default" type="STRING"/>
					<colinfo id="WERKS" size="255" summ="default" type="STRING"/>
					<colinfo id="POSID1" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID2" size="256" summ="default" type="STRING"/>
					<colinfo id="GUBN" size="2" summ="default" type="STRING"/>
					<colinfo id="KNTTP" size="3" summ="default" type="STRING"/>
					<record>
						<EKGRP></EKGRP>
						<GUBN></GUBN>
						<INVNR></INVNR>
						<KNTTP></KNTTP>
						<LGORT></LGORT>
						<LIFNR></LIFNR>
						<MATNR></MATNR>
						<POSID1></POSID1>
						<POSID2></POSID2>
						<UDATE1></UDATE1>
						<UDATE2></UDATE2>
						<WERKS></WERKS>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_lgort_cd">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_sum" OnColumnChanged="ds_sum_OnColumnChanged">
				<Contents>
					<colinfo id="CHECK" size="1" summ="default" type="STRING"/>
					<colinfo id="DDATE" size="8" summ="default" type="STRING"/>
					<colinfo id="DTIME" size="8" summ="default" type="STRING"/>
					<colinfo id="EKGRP" size="60" summ="default" type="STRING"/>
					<colinfo id="MATNR" size="54" summ="default" type="STRING"/>
					<colinfo id="MENGE" size="33" summ="default" type="DECIMAL"/>
					<colinfo id="NAME1" size="105" summ="default" type="STRING"/>
					<colinfo id="NETPR" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="POSID" size="72" summ="default" type="STRING"/>
					<colinfo id="POST1" size="120" summ="default" type="STRING"/>
					<colinfo id="RV_NAME" size="100" summ="default" type="STRING"/>
					<colinfo id="SDATE" size="8" summ="default" type="STRING"/>
					<colinfo id="STATE" size="3" summ="default" type="STRING"/>
					<colinfo id="STIME" size="8" summ="default" type="STRING"/>
					<colinfo id="UDATE" size="8" summ="default" type="STRING"/>
					<colinfo id="WAERS" size="15" summ="default" type="STRING"/>
					<colinfo id="BIGO" size="3" summ="default" type="STRING"/>
					<colinfo id="GEOSAN" size="3" summ="default" type="STRING"/>
					<colinfo id="SHIPDAT" size="24" summ="default" type="STRING"/>
					<colinfo id="MISU_GUBN" size="3" summ="default" type="STRING"/>
					<colinfo id="EKGRP2" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list" OnColumnChanged="ds_list_OnColumnChanged">
				<Contents>
					<colinfo id="B_MENGE" size="33" summ="default" type="DECIMAL"/>
					<colinfo id="CHAR1" size="300" summ="default" type="STRING"/>
					<colinfo id="CHDAT" size="8" summ="default" type="STRING"/>
					<colinfo id="CHECK" size="1" summ="default" type="STRING"/>
					<colinfo id="CHTIM" size="8" summ="default" type="STRING"/>
					<colinfo id="DDATE" size="8" summ="default" type="STRING"/>
					<colinfo id="DTIME" size="8" summ="default" type="STRING"/>
					<colinfo id="EBELN" size="30" summ="default" type="STRING"/>
					<colinfo id="EBELP" size="15" summ="default" type="STRING"/>
					<colinfo id="EDATE" size="24" summ="default" type="STRING"/>
					<colinfo id="EINDT" size="24" summ="default" type="STRING"/>
					<colinfo id="EKGRP" size="9" summ="default" type="STRING"/>
					<colinfo id="ETIME" size="18" summ="default" type="STRING"/>
					<colinfo id="EXTWG" size="54" summ="default" type="STRING"/>
					<colinfo id="FLAG" size="0" summ="default" type="STRING"/>
					<colinfo id="GROES" size="96" summ="default" type="STRING"/>
					<colinfo id="INFNR" size="30" summ="default" type="STRING"/>
					<colinfo id="INS_Q" size="33" summ="default" type="DECIMAL"/>
					<colinfo id="INVITEM" size="15" summ="default" type="STRING"/>
					<colinfo id="INVNR" size="30" summ="default" type="STRING"/>
					<colinfo id="KNTTP" size="3" summ="default" type="STRING"/>
					<colinfo id="LGOBE" size="48" summ="default" type="STRING"/>
					<colinfo id="LGORT" size="12" summ="default" type="STRING"/>
					<colinfo id="LIFNR" size="30" summ="default" type="STRING"/>
					<colinfo id="MAKTX" size="120" summ="default" type="STRING"/>
					<colinfo id="MANDT" size="9" summ="default" type="STRING"/>
					<colinfo id="MATNR" size="54" summ="default" type="STRING"/>
					<colinfo id="MEINS" size="9" summ="default" type="STRING"/>
					<colinfo id="MENGE" size="33" summ="default" type="DECIMAL"/>
					<colinfo id="MENGE1" size="33" summ="default" type="DECIMAL"/>
					<colinfo id="MENGE3" size="16" summ="default" type="DECIMAL"/>
					<colinfo id="NAME1" size="105" summ="default" type="STRING"/>
					<colinfo id="NETPR" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="POSID" size="72" summ="default" type="STRING"/>
					<colinfo id="POSID1" size="6" summ="default" type="STRING"/>
					<colinfo id="POST1" size="120" summ="default" type="STRING"/>
					<colinfo id="POTYPE" size="3" summ="default" type="STRING"/>
					<colinfo id="PRO_F" size="3" summ="default" type="STRING"/>
					<colinfo id="PSTYP" size="3" summ="default" type="STRING"/>
					<colinfo id="RDATE_P" size="0" summ="default" type="STRING"/>
					<colinfo id="SDATE" size="8" summ="default" type="STRING"/>
					<colinfo id="STATE" size="3" summ="default" type="STRING"/>
					<colinfo id="STIME" size="8" summ="default" type="STRING"/>
					<colinfo id="UDATE" size="8" summ="default" type="STRING"/>
					<colinfo id="VALUE" size="90" summ="default" type="STRING"/>
					<colinfo id="WAERS" size="15" summ="default" type="STRING"/>
					<colinfo id="WERKS" size="12" summ="default" type="STRING"/>
					<colinfo id="WERKS_TXT" size="90" summ="default" type="STRING"/>
					<colinfo id="ZEINR" size="120" summ="default" type="STRING"/>
					<colinfo id="SHIPDAT" size="24" summ="default" type="STRING"/>
					<colinfo id="BIGO" size="1" summ="default" type="STRING"/>
					<colinfo id="P_END" size="256" summ="default" type="STRING"/>
					<colinfo id="BOX_CK" size="6" summ="default" type="STRING"/>
					<colinfo id="KNTTP1" size="3" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_state_cd">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list_0">
				<Contents>
					<colinfo id="B_MENGE" size="33" summ="default" type="DECIMAL"/>
					<colinfo id="CHAR1" size="300" summ="default" type="STRING"/>
					<colinfo id="CHDAT" size="8" summ="default" type="STRING"/>
					<colinfo id="CHECK" size="1" summ="default" type="STRING"/>
					<colinfo id="CHTIM" size="8" summ="default" type="STRING"/>
					<colinfo id="DDATE" size="8" summ="default" type="STRING"/>
					<colinfo id="DTIME" size="8" summ="default" type="STRING"/>
					<colinfo id="EBELN" size="30" summ="default" type="STRING"/>
					<colinfo id="EBELP" size="15" summ="default" type="STRING"/>
					<colinfo id="EDATE" size="24" summ="default" type="STRING"/>
					<colinfo id="EINDT" size="24" summ="default" type="STRING"/>
					<colinfo id="EKGRP" size="9" summ="default" type="STRING"/>
					<colinfo id="ETIME" size="18" summ="default" type="STRING"/>
					<colinfo id="EXTWG" size="54" summ="default" type="STRING"/>
					<colinfo id="FLAG" size="0" summ="default" type="STRING"/>
					<colinfo id="GROES" size="96" summ="default" type="STRING"/>
					<colinfo id="INFNR" size="30" summ="default" type="STRING"/>
					<colinfo id="INS_Q" size="33" summ="default" type="DECIMAL"/>
					<colinfo id="INVITEM" size="15" summ="default" type="STRING"/>
					<colinfo id="INVNR" size="30" summ="default" type="STRING"/>
					<colinfo id="KNTTP" size="3" summ="default" type="STRING"/>
					<colinfo id="LGOBE" size="48" summ="default" type="STRING"/>
					<colinfo id="LGORT" size="12" summ="default" type="STRING"/>
					<colinfo id="LIFNR" size="30" summ="default" type="STRING"/>
					<colinfo id="MANDT" size="9" summ="default" type="STRING"/>
					<colinfo id="MATNR" size="54" summ="default" type="STRING"/>
					<colinfo id="MEINS" size="9" summ="default" type="STRING"/>
					<colinfo id="MENGE" size="33" summ="default" type="DECIMAL"/>
					<colinfo id="MENGE1" size="33" summ="default" type="DECIMAL"/>
					<colinfo id="MENGE3" size="16" summ="default" type="DECIMAL"/>
					<colinfo id="NAME1" size="105" summ="default" type="STRING"/>
					<colinfo id="NETPR" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="POSID" size="72" summ="default" type="STRING"/>
					<colinfo id="POSID1" size="6" summ="default" type="STRING"/>
					<colinfo id="POST1" size="120" summ="default" type="STRING"/>
					<colinfo id="POTYPE" size="3" summ="default" type="STRING"/>
					<colinfo id="PRO_F" size="3" summ="default" type="STRING"/>
					<colinfo id="PSTYP" size="3" summ="default" type="STRING"/>
					<colinfo id="RDATE_P" size="0" summ="default" type="STRING"/>
					<colinfo id="SDATE" size="8" summ="default" type="STRING"/>
					<colinfo id="STATE" size="3" summ="default" type="STRING"/>
					<colinfo id="STIME" size="8" summ="default" type="STRING"/>
					<colinfo id="TXZ01" size="482" summ="default" type="STRING"/>
					<colinfo id="UDATE" size="8" summ="default" type="STRING"/>
					<colinfo id="VALUE" size="90" summ="default" type="STRING"/>
					<colinfo id="WAERS" size="15" summ="default" type="STRING"/>
					<colinfo id="WERKS" size="12" summ="default" type="STRING"/>
					<colinfo id="WERKS_TXT" size="90" summ="default" type="STRING"/>
					<colinfo id="ZEINR" size="120" summ="default" type="STRING"/>
					<colinfo id="SHIPDAT" size="24" summ="default" type="STRING"/>
					<colinfo id="BIGO" size="1" summ="default" type="STRING"/>
					<colinfo id="P_END" size="256" summ="default" type="STRING"/>
					<colinfo id="BOX_CK" size="6" summ="default" type="STRING"/>
					<colinfo id="KNTTP1" size="3" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_gubn_cd">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
					<record>
						<CODE>1</CODE>
						<CODE_NAME>납기일자</CODE_NAME>
					</record>
					<record>
						<CODE>2</CODE>
						<CODE_NAME>발주일자</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_bigo_cd">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE>0</CODE>
						<CODE_NAME>정상</CODE_NAME>
					</record>
					<record>
						<CODE>1</CODE>
						<CODE_NAME>품목&#32;삭제/변경</CODE_NAME>
					</record>
					<record>
						<CODE>2</CODE>
						<CODE_NAME>미수금&#32;현장</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_box_ck_cd">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME>구박스</CODE_NAME>
					</record>
					<record>
						<CODE>24</CODE>
						<CODE_NAME>신박스</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_knttp_cd">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME>-&#32;ALL&#32;-</CODE_NAME>
					</record>
					<record>
						<CODE>Q</CODE>
						<CODE_NAME>일반</CODE_NAME>
					</record>
					<record>
						<CODE>F</CODE>
						<CODE_NAME>투자자산</CODE_NAME>
					</record>
					<record>
						<CODE>K</CODE>
						<CODE_NAME>외주임가공</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_temp" OnColumnChanged="ds_list_OnColumnChanged">
				<Contents>
					<colinfo id="B_MENGE" size="33" summ="default" type="DECIMAL"/>
					<colinfo id="CHAR1" size="300" summ="default" type="STRING"/>
					<colinfo id="CHDAT" size="8" summ="default" type="STRING"/>
					<colinfo id="CHECK" size="1" summ="default" type="STRING"/>
					<colinfo id="CHTIM" size="8" summ="default" type="STRING"/>
					<colinfo id="DDATE" size="8" summ="default" type="STRING"/>
					<colinfo id="DTIME" size="8" summ="default" type="STRING"/>
					<colinfo id="EBELN" size="30" summ="default" type="STRING"/>
					<colinfo id="EBELP" size="15" summ="default" type="STRING"/>
					<colinfo id="EDATE" size="24" summ="default" type="STRING"/>
					<colinfo id="EINDT" size="24" summ="default" type="STRING"/>
					<colinfo id="EKGRP" size="9" summ="default" type="STRING"/>
					<colinfo id="ETIME" size="18" summ="default" type="STRING"/>
					<colinfo id="EXTWG" size="54" summ="default" type="STRING"/>
					<colinfo id="FLAG" size="0" summ="default" type="STRING"/>
					<colinfo id="GROES" size="96" summ="default" type="STRING"/>
					<colinfo id="INFNR" size="30" summ="default" type="STRING"/>
					<colinfo id="INS_Q" size="33" summ="default" type="DECIMAL"/>
					<colinfo id="INVITEM" size="15" summ="default" type="STRING"/>
					<colinfo id="INVNR" size="30" summ="default" type="STRING"/>
					<colinfo id="KNTTP" size="3" summ="default" type="STRING"/>
					<colinfo id="LGOBE" size="48" summ="default" type="STRING"/>
					<colinfo id="LGORT" size="12" summ="default" type="STRING"/>
					<colinfo id="LIFNR" size="30" summ="default" type="STRING"/>
					<colinfo id="MAKTX" size="120" summ="default" type="STRING"/>
					<colinfo id="MANDT" size="9" summ="default" type="STRING"/>
					<colinfo id="MATNR" size="54" summ="default" type="STRING"/>
					<colinfo id="MEINS" size="9" summ="default" type="STRING"/>
					<colinfo id="MENGE" size="33" summ="default" type="DECIMAL"/>
					<colinfo id="MENGE1" size="33" summ="default" type="DECIMAL"/>
					<colinfo id="MENGE3" size="16" summ="default" type="DECIMAL"/>
					<colinfo id="NAME1" size="105" summ="default" type="STRING"/>
					<colinfo id="NETPR" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="POSID" size="72" summ="default" type="STRING"/>
					<colinfo id="POSID1" size="6" summ="default" type="STRING"/>
					<colinfo id="POST1" size="120" summ="default" type="STRING"/>
					<colinfo id="POTYPE" size="3" summ="default" type="STRING"/>
					<colinfo id="PRO_F" size="3" summ="default" type="STRING"/>
					<colinfo id="PSTYP" size="3" summ="default" type="STRING"/>
					<colinfo id="RDATE_P" size="0" summ="default" type="STRING"/>
					<colinfo id="SDATE" size="8" summ="default" type="STRING"/>
					<colinfo id="STATE" size="3" summ="default" type="STRING"/>
					<colinfo id="STIME" size="8" summ="default" type="STRING"/>
					<colinfo id="UDATE" size="8" summ="default" type="STRING"/>
					<colinfo id="VALUE" size="90" summ="default" type="STRING"/>
					<colinfo id="WAERS" size="15" summ="default" type="STRING"/>
					<colinfo id="WERKS" size="12" summ="default" type="STRING"/>
					<colinfo id="WERKS_TXT" size="90" summ="default" type="STRING"/>
					<colinfo id="ZEINR" size="120" summ="default" type="STRING"/>
					<colinfo id="SHIPDAT" size="24" summ="default" type="STRING"/>
					<colinfo id="BIGO" size="1" summ="default" type="STRING"/>
					<colinfo id="P_END" size="256" summ="default" type="STRING"/>
					<colinfo id="BOX_CK" size="6" summ="default" type="STRING"/>
					<colinfo id="KNTTP1" size="3" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_temp1" OnColumnChanged="ds_list_OnColumnChanged">
				<Contents>
					<colinfo id="B_MENGE" size="33" summ="default" type="DECIMAL"/>
					<colinfo id="CHAR1" size="300" summ="default" type="STRING"/>
					<colinfo id="CHDAT" size="8" summ="default" type="STRING"/>
					<colinfo id="CHECK" size="1" summ="default" type="STRING"/>
					<colinfo id="CHTIM" size="8" summ="default" type="STRING"/>
					<colinfo id="DDATE" size="8" summ="default" type="STRING"/>
					<colinfo id="DTIME" size="8" summ="default" type="STRING"/>
					<colinfo id="EBELN" size="30" summ="default" type="STRING"/>
					<colinfo id="EBELP" size="15" summ="default" type="STRING"/>
					<colinfo id="EDATE" size="24" summ="default" type="STRING"/>
					<colinfo id="EINDT" size="24" summ="default" type="STRING"/>
					<colinfo id="EKGRP" size="9" summ="default" type="STRING"/>
					<colinfo id="ETIME" size="18" summ="default" type="STRING"/>
					<colinfo id="EXTWG" size="54" summ="default" type="STRING"/>
					<colinfo id="FLAG" size="0" summ="default" type="STRING"/>
					<colinfo id="GROES" size="96" summ="default" type="STRING"/>
					<colinfo id="INFNR" size="30" summ="default" type="STRING"/>
					<colinfo id="INS_Q" size="33" summ="default" type="DECIMAL"/>
					<colinfo id="INVITEM" size="15" summ="default" type="STRING"/>
					<colinfo id="INVNR" size="30" summ="default" type="STRING"/>
					<colinfo id="KNTTP" size="3" summ="default" type="STRING"/>
					<colinfo id="LGOBE" size="48" summ="default" type="STRING"/>
					<colinfo id="LGORT" size="12" summ="default" type="STRING"/>
					<colinfo id="LIFNR" size="30" summ="default" type="STRING"/>
					<colinfo id="MAKTX" size="120" summ="default" type="STRING"/>
					<colinfo id="MANDT" size="9" summ="default" type="STRING"/>
					<colinfo id="MATNR" size="54" summ="default" type="STRING"/>
					<colinfo id="MEINS" size="9" summ="default" type="STRING"/>
					<colinfo id="MENGE" size="33" summ="default" type="DECIMAL"/>
					<colinfo id="MENGE1" size="33" summ="default" type="DECIMAL"/>
					<colinfo id="MENGE3" size="16" summ="default" type="DECIMAL"/>
					<colinfo id="NAME1" size="105" summ="default" type="STRING"/>
					<colinfo id="NETPR" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="POSID" size="72" summ="default" type="STRING"/>
					<colinfo id="POSID1" size="6" summ="default" type="STRING"/>
					<colinfo id="POST1" size="120" summ="default" type="STRING"/>
					<colinfo id="POTYPE" size="3" summ="default" type="STRING"/>
					<colinfo id="PRO_F" size="3" summ="default" type="STRING"/>
					<colinfo id="PSTYP" size="3" summ="default" type="STRING"/>
					<colinfo id="RDATE_P" size="0" summ="default" type="STRING"/>
					<colinfo id="SDATE" size="8" summ="default" type="STRING"/>
					<colinfo id="STATE" size="3" summ="default" type="STRING"/>
					<colinfo id="STIME" size="8" summ="default" type="STRING"/>
					<colinfo id="UDATE" size="8" summ="default" type="STRING"/>
					<colinfo id="VALUE" size="90" summ="default" type="STRING"/>
					<colinfo id="WAERS" size="15" summ="default" type="STRING"/>
					<colinfo id="WERKS" size="12" summ="default" type="STRING"/>
					<colinfo id="WERKS_TXT" size="90" summ="default" type="STRING"/>
					<colinfo id="ZEINR" size="120" summ="default" type="STRING"/>
					<colinfo id="SHIPDAT" size="24" summ="default" type="STRING"/>
					<colinfo id="BIGO" size="1" summ="default" type="STRING"/>
					<colinfo id="P_END" size="256" summ="default" type="STRING"/>
					<colinfo id="BOX_CK" size="6" summ="default" type="STRING"/>
					<colinfo id="KNTTP1" size="3" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cnt">
				<Contents>
					<colinfo id="CNT" size="256" type="STRING"/>
					<record>
						<CNT></CNT>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_condmts">
				<Contents>
					<colinfo id="INVNR" size="31" summ="default" type="STRING"/>
					<record>
						<INVNR></INVNR>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_mts">
				<Contents>
					<colinfo id="MANDT" size="9" summ="default" type="STRING"/>
					<colinfo id="INVNR" size="30" summ="default" type="STRING"/>
					<colinfo id="INVITEM" size="15" summ="default" type="STRING"/>
					<colinfo id="RDATE_P" size="8" summ="default" type="STRING"/>
					<colinfo id="RECE_DATE" size="8" summ="default" type="STRING"/>
					<colinfo id="RECE_TIME" size="6" summ="default" type="STRING"/>
					<colinfo id="DEL_DATE" size="8" summ="default" type="STRING"/>
					<colinfo id="DEL_TIME" size="6" summ="default" type="STRING"/>
					<colinfo id="EBELN" size="30" summ="default" type="STRING"/>
					<colinfo id="EBELP" size="15" summ="default" type="STRING"/>
					<colinfo id="POSID" size="72" summ="default" type="STRING"/>
					<colinfo id="POST1" size="120" summ="default" type="STRING"/>
					<colinfo id="POTYPE" size="3" summ="default" type="STRING"/>
					<colinfo id="EKGRP" size="9" summ="default" type="STRING"/>
					<colinfo id="KNTTP" size="3" summ="default" type="STRING"/>
					<colinfo id="PSTYP" size="3" summ="default" type="STRING"/>
					<colinfo id="WERKS" size="12" summ="default" type="STRING"/>
					<colinfo id="WERKS_TXT" size="90" summ="default" type="STRING"/>
					<colinfo id="LGORT" size="12" summ="default" type="STRING"/>
					<colinfo id="LGOBE" size="48" summ="default" type="STRING"/>
					<colinfo id="MATNR" size="54" summ="default" type="STRING"/>
					<colinfo id="MAKTX" size="120" summ="default" type="STRING"/>
					<colinfo id="GROES" size="96" summ="default" type="STRING"/>
					<colinfo id="ZEINR" size="120" summ="default" type="STRING"/>
					<colinfo id="MENGE" size="33" summ="default" type="DECIMAL"/>
					<colinfo id="MEINS" size="9" summ="default" type="STRING"/>
					<colinfo id="EINDT" size="24" summ="default" type="STRING"/>
					<colinfo id="LIFNR" size="30" summ="default" type="STRING"/>
					<colinfo id="NAME1" size="105" summ="default" type="STRING"/>
					<colinfo id="INFNR" size="30" summ="default" type="STRING"/>
					<colinfo id="NETPR" size="22" summ="default" type="DECIMAL"/>
					<colinfo id="WAERS" size="15" summ="default" type="STRING"/>
					<colinfo id="EXTWG" size="54" summ="default" type="STRING"/>
					<colinfo id="UDATE" size="8" summ="default" type="STRING"/>
					<colinfo id="EDATE" size="24" summ="default" type="STRING"/>
					<colinfo id="ETIME" size="18" summ="default" type="STRING"/>
					<colinfo id="VALUE" size="90" summ="default" type="STRING"/>
					<colinfo id="CHAR1" size="300" summ="default" type="STRING"/>
					<colinfo id="CHDAT" size="8" summ="default" type="STRING"/>
					<colinfo id="CHTIM" size="8" summ="default" type="STRING"/>
					<colinfo id="INS_Q" size="33" summ="default" type="DECIMAL"/>
					<colinfo id="SDATE" size="8" summ="default" type="STRING"/>
					<colinfo id="STIME" size="8" summ="default" type="STRING"/>
					<colinfo id="DDATE" size="8" summ="default" type="STRING"/>
					<colinfo id="DTIME" size="8" summ="default" type="STRING"/>
					<colinfo id="MBLNR" size="20" summ="default" type="STRING"/>
					<colinfo id="MBLPO" size="5" summ="default" type="STRING"/>
					<colinfo id="BUDAT" size="8" summ="default" type="STRING"/>
					<colinfo id="IN_DT" size="8" summ="default" type="STRING"/>
					<colinfo id="IN_TM" size="8" summ="default" type="STRING"/>
					<colinfo id="STO_MBLNR" size="20" summ="default" type="STRING"/>
					<colinfo id="STO_MBLPO" size="5" summ="default" type="STRING"/>
					<colinfo id="CA_DT" size="8" summ="default" type="STRING"/>
					<colinfo id="CA_TM" size="8" summ="default" type="STRING"/>
					<colinfo id="PRO_F" size="3" summ="default" type="STRING"/>
					<colinfo id="FIELD" size="3" summ="default" type="STRING"/>
					<colinfo id="CR_DAT" size="8" summ="default" type="STRING"/>
					<colinfo id="CR_TIM" size="8" summ="default" type="STRING"/>
					<colinfo id="QM_CHK" size="3" summ="default" type="STRING"/>
					<colinfo id="USABIL" size="3" summ="default" type="STRING"/>
					<colinfo id="B_MENGE" size="33" summ="default" type="DECIMAL"/>
					<colinfo id="USNAM" size="36" summ="default" type="STRING"/>
					<colinfo id="QM_CID" size="36" summ="default" type="STRING"/>
					<colinfo id="QM_CIDTXT" size="105" summ="default" type="STRING"/>
					<colinfo id="MBLNR2" size="30" summ="default" type="STRING"/>
					<colinfo id="MBLPO2" size="33" summ="default" type="DECIMAL"/>
					<colinfo id="BUDAT2" size="8" summ="default" type="STRING"/>
					<colinfo id="OU_DT" size="8" summ="default" type="STRING"/>
					<colinfo id="OU_TM" size="8" summ="default" type="STRING"/>
					<colinfo id="CAN_MBLNR" size="30" summ="default" type="STRING"/>
					<colinfo id="CAN_MBLPO" size="18" summ="default" type="STRING"/>
					<colinfo id="CA_DT1" size="8" summ="default" type="STRING"/>
					<colinfo id="CA_TM1" size="8" summ="default" type="STRING"/>
					<colinfo id="CA_DT2" size="8" summ="default" type="STRING"/>
					<colinfo id="CA_TM2" size="8" summ="default" type="STRING"/>
					<colinfo id="BOX_CK" size="6" summ="default" type="STRING"/>
					<colinfo id="INVTAG" size="42" summ="default" type="STRING"/>
					<colinfo id="QR_YN" size="6" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_condmts2">
				<Contents>
					<colinfo id="INVNR" size="31" summ="default" type="STRING"/>
					<colinfo id="INVITEM" size="15" summ="default" type="STRING"/>
					<colinfo id="G_MANDT" size="256" summ="default" type="STRING"/>
					<record>
						<G_MANDT></G_MANDT>
						<INVITEM></INVITEM>
						<INVNR></INVNR>
					</record>
				</Contents>
			</Dataset>
		</Datasets>
		<Shape BKColor="user0" Bottom="30" Height="30" Id="Shape0" Left="0" LineColor="user1" Right="978" TabOrder="1" Top="0" Type="Rectangle" Width="978"></Shape>
		<Static Align="Right" Height="20" Id="st_vend_code" Left="5" Style="sty_lb_search" TabOrder="2" Text="공급업체&#32;" Top="5" VAlign="Middle" Width="80"></Static>
		<Edit Border="Flat" Enable="FALSE" Height="20" Id="ed_lifnrName" Left="87" Style="sty_ipt_search_ind" TabOrder="3" Top="5" Width="107"></Edit>
		<Shape BKColor="user12" Bottom="64" Height="26" Id="Shape1" Left="10" LineColor="user13" Right="968" TabOrder="4" Top="38" Type="Rectangle" Width="958"></Shape>
		<Static Align="Right" Height="24" Id="st_werks" Left="312" Style="sty_lb_form_basic" TabOrder="5" Text="Plant&#32;" Top="39" VAlign="Middle" Width="101"></Static>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="CODE" Column="WERKS" DataColumn="CODE_NAME" Height="20" Id="cb_werks" InnerDataset="ds_werks_cd" Left="414" Style="sty_ipt_form" TabOrder="6" Top="40" Width="83"></Combo>
		<Static Align="Right" Height="24" Id="st_logrt" Left="499" Style="sty_lb_form_basic" TabOrder="8" Text="저장위치&#32;" Top="39" VAlign="Middle" Width="64"></Static>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="CODE" Column="LGORT" DataColumn="CODE_NAME" Height="20" Id="cb_lgort" InnerDataset="ds_lgort_cd" Left="564" Style="sty_ipt_form_ind" TabOrder="9" Top="40" Width="88"></Combo>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="CODE" Column="EKGRP" DataColumn="CODE_NAME" Height="20" Id="cb_ekgrp" InnerDataset="ds_ekgrp_cd" Left="710" Style="sty_ipt_form" TabOrder="11" Top="40" Width="96"></Combo>
		<Static Align="Right" Height="24" Id="st_ekgrp" Left="653" Style="sty_lb_form_basic" TabOrder="10" Text="구매그룹&#32;" Top="39" VAlign="Middle" Width="56"></Static>
		<Static Align="Right" Height="24" Id="st_eindt" Left="11" Style="sty_lb_form_basic" TabOrder="12" Top="39" VAlign="Middle" Width="96"></Static>
		<Static Align="Center" Border="None" Color="user7" Font="굴림,9" Height="20" Id="Static8" Left="203" TabOrder="13" Text="~" Top="41" VAlign="Middle" Width="16"></Static>
		<Calendar BindDataset="ds_cond" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="UDATE1" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_udate_fm" Left="109" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form_ind" SundayTextColor="user35" TabOrder="14" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="41" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="91"></Calendar>
		<Calendar BindDataset="ds_cond" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="UDATE2" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_udate_to" Left="220" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form_ind" SundayTextColor="user35" TabOrder="15" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="41" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="91"></Calendar>
		<Shape BKColor="user12" Bottom="89" Height="26" Id="Shape2" Left="10" LineColor="user13" Right="968" TabOrder="7" Top="63" Type="Rectangle" Width="958"></Shape>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="Button3" ImageID="btn_sub_06" Left="873" LeftMargin="12" OnClick="ufn_listGeoRae" Style="sty_btn" TabOrder="17" Text="거래명세내역" Top="95" Transparent="TRUE" Width="95"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Enable="FALSE" Height="20" Id="bt_chjgeom" ImageID="btn_sub_04" Left="800" LeftMargin="12" OnClick="gfn_goChulJang" Style="sty_btn" TabOrder="18" Text="출장검사" Top="95" Transparent="TRUE" Width="71"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_save" ImageID="btn_sub_02" Left="678" LeftMargin="12" OnClick="fn_save" Style="sty_btn" TabOrder="19" Text="저장" Top="95" Transparent="TRUE" Width="47"></Button>
		<Static Align="Right" Height="24" Id="Static2" Left="653" Style="sty_lb_form_basic" TabOrder="20" Text="거래명세서번호&#32;" Top="64" VAlign="Middle" Width="96"></Static>
		<Static Align="Right" Height="24" Id="Static5" Left="11" Style="sty_lb_form_basic" TabOrder="21" Text="호기번호(WBS)&#32;" Top="64" VAlign="Middle" Width="96"></Static>
		<Static Align="Right" Height="24" Id="st_matnr" Left="499" Style="sty_lb_form_basic" TabOrder="22" Text="자재번호&#32;" Top="64" VAlign="Middle" Width="64"></Static>
		<Edit BindDataset="ds_cond" Border="Flat" Column="INVNR" Height="20" Id="ed_invnr" ImeMode="english" Left="751" LeftMargin="4" MaxLength="10" Number="TRUE" RightMargin="4" Style="sty_ipt_form" TabOrder="24" Top="66" UpperOnly="TRUE" Width="118"></Edit>
		<Edit BindDataset="ds_cond" Border="Flat" Column="MATNR" Height="20" Id="ed_matnr" ImeMode="english" Left="565" LeftMargin="4" MaxLength="9" RightMargin="4" Style="sty_ipt_form" TabOrder="23" Top="66" UpperOnly="TRUE" Width="86"></Edit>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="Button2" ImageID="btn_sub_04" Left="727" LeftMargin="12" OnClick="fn_cancel" Style="sty_btn" TabOrder="25" Text="저장삭제" Top="95" Transparent="TRUE" Width="71"></Button>
		<Static Align="Right" Height="24" Id="st_rdate_p" Left="312" Style="sty_lb_form_basic" TabOrder="26" Text="납품예정일등록&#32;" Top="64" VAlign="Middle" Width="101"></Static>
		<Calendar Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="RDATE_P" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Enable="FALSE" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_rdate_p" Left="415" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" OnChanged="ufn_checkDate" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form_ind" SundayTextColor="user35" TabOrder="27" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="66" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="81"></Calendar>
		<Edit Border="Flat" Height="20" Id="ed_posid2" ImeMode="english" Left="220" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="30" Top="66" UpperOnly="TRUE" UseIME="FALSE" Width="90"></Edit>
		<Static Align="Center" Border="None" Color="user7" Font="굴림,9" Height="20" Id="Static0" Left="204" TabOrder="28" Text="~" Top="66" VAlign="Middle" Width="16"></Static>
		<Edit BindDataset="ds_cond" Border="Flat" Column="POSID1" Height="20" Id="ed_posid1" ImeMode="english" Left="109" LeftMargin="4" RightMargin="4" Style="sty_ipt_form" TabOrder="29" Top="66" UpperOnly="TRUE" UseIME="FALSE" Width="91"></Edit>
		<Grid AreaSelect="TRUE" AutoFitEndLine="Hide" BindDataset="ds_sum" BkColor2="default" BoldHead="true" Border="Flat" Bottom="302" CellMoving="TRUE" ColSelect="TRUE" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="182" Id="grd_sum" InputPanel="FALSE" Left="8" LineColor="user20" LineType="ExHORZ" OnCellPosChanged="grd_sum_OnCellPosChanged" OnHeadClick="grd_sum_OnHeadClick" Right="966" RowHeight="20" Style="sty_grid" TabOrder="31" TabStop="true" Top="120" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="958">
			<contents>
				<format id="Default">
					<columns>
						<col width="20"/>
						<col width="75"/>
						<col width="190"/>
						<col width="80"/>
						<col width="80"/>
						<col width="92"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="100"/>
						<col width="50"/>
						<col width="88"/>
						<col width="60"/>
						<col width="60"/>
					</columns>
					<head>
						<cell align="center" col="0" display="checkbox" font="굴림,9"/>
						<cell align="center" col="1" cursor="hand" display="text" font="굴림,9" text="Proj.&#32;번호"/>
						<cell align="center" col="2" cursor="hand" display="text" font="굴림,9" text="공사명"/>
						<cell align="center" col="3" cursor="hand" display="text" font="굴림,9" text="납기일"/>
						<cell align="center" col="4" cursor="hand" display="text" font="굴림,9" text="출고예정일"/>
						<cell align="center" col="5" cursor="hand" display="text" font="굴림,9" text="자재번호"/>
						<cell align="center" col="6" cursor="hand" display="text" font="굴림,9" text="발주&#32;승인일자"/>
						<cell align="center" col="7" cursor="hand" display="text" font="굴림,9" text="발주&#32;승인시간"/>
						<cell align="center" col="8" cursor="hand" display="text" font="굴림,9" text="발주&#32;삭제일자"/>
						<cell align="center" col="9" cursor="hand" display="text" font="굴림,9" text="금액"/>
						<cell align="center" col="10" cursor="hand" display="text" font="굴림,9" text="통화"/>
						<cell align="center" col="11" cursor="hand" display="text" font="굴림,9" text="처리상태"/>
						<cell align="center" col="12" cursor="hand" display="text" font="굴림,9" text="비고"/>
						<cell align="center" col="13" cursor="hand" display="text" font="굴림,9" text="거산"/>
					</head>
					<body>
						<cell align="center" bkcolor2="user22" col="0" colid="CHECK" display="checkbox" edit="checkbox"/>
						<cell align="center" bkcolor2="user22" col="1" colid="POSID" color='expr:iif(ds_sum.getColumn(row,&quot;BIGO&quot;)&#32;!=&#32;&quot;0&quot;,&#32;&apos;red&apos;,&apos;&apos;)' display="text"/>
						<cell align="left" bkcolor2="user22" col="2" colid="POST1" color='expr:iif(ds_sum.getColumn(row,&quot;BIGO&quot;)&#32;!=&#32;&quot;0&quot;,&#32;&apos;red&apos;,&apos;&apos;)' display="text"/>
						<cell align="center" bkcolor2="user22" col="3" colid="UDATE" color='expr:iif(ds_sum.getColumn(row,&quot;BIGO&quot;)&#32;!=&#32;&quot;0&quot;,&#32;&apos;red&apos;,&apos;&apos;)' display="text" Mask="####.##.##"/>
						<cell align="center" bkcolor2="user22" col="4" colid="SHIPDAT" color='expr:iif(ds_sum.getColumn(row,&quot;BIGO&quot;)&#32;!=&#32;&quot;0&quot;,&#32;&apos;red&apos;,&apos;&apos;)' display="text" Mask="####.##.##"/>
						<cell align="center" bkcolor2="user22" col="5" colid="MATNR" color='expr:iif(ds_sum.getColumn(row,&quot;BIGO&quot;)&#32;!=&#32;&quot;0&quot;,&#32;&apos;red&apos;,&apos;&apos;)' display="text"/>
						<cell align="center" bkcolor2="user22" col="6" colid="SDATE" color='expr:iif(ds_sum.getColumn(row,&quot;BIGO&quot;)&#32;!=&#32;&quot;0&quot;,&#32;&apos;red&apos;,&apos;&apos;)' display="text" Mask="####.##.##"/>
						<cell align="center" bkcolor2="user22" col="7" colid="STIME" color='expr:iif(ds_sum.getColumn(row,&quot;BIGO&quot;)&#32;!=&#32;&quot;0&quot;,&#32;&apos;red&apos;,&apos;&apos;)' display="text" Mask="##:##:##"/>
						<cell align="center" bkcolor2="user22" col="8" colid="DDATE" color='expr:iif(ds_sum.getColumn(row,&quot;BIGO&quot;)&#32;!=&#32;&quot;0&quot;,&#32;&apos;red&apos;,&apos;&apos;)' display="text" Mask="####.##.##"/>
						<cell align="right" bkcolor2="user22" col="9" colid="NETPR" color='expr:iif(ds_sum.getColumn(row,&quot;BIGO&quot;)&#32;!=&#32;&quot;0&quot;,&#32;&apos;red&apos;,&apos;&apos;)' display="number" Mask="###,###"/>
						<cell align="center" bkcolor2="user22" col="10" colid="WAERS" color='expr:iif(ds_sum.getColumn(row,&quot;BIGO&quot;)&#32;!=&#32;&quot;0&quot;,&#32;&apos;red&apos;,&apos;&apos;)' display="text"/>
						<cell align="center" bkcolor2="user22" col="11" colid="STATE" color='expr:iif(ds_sum.getColumn(row,&quot;BIGO&quot;)&#32;!=&#32;&quot;0&quot;,&#32;&apos;red&apos;,&apos;&apos;)' combocol="CODE" combodataset="ds_state_cd" combodisplayrowcnt="1" combotext="CODE_NAME" display="combo"/>
						<cell align="center" bkcolor2="user22" col="12" colid="BIGO" color='expr:iif(ds_sum.getColumn(row,&quot;BIGO&quot;)&#32;!=&#32;&quot;0&quot;,&#32;&apos;red&apos;,&apos;&apos;)' combocol="CODE" combodataset="ds_bigo_cd" combodisplayrowcnt="1" combotext="CODE_NAME" display="combo"/>
						<cell align="center" bkcolor2="user22" col="13" colid="GEOSAN" color='expr:iif(ds_sum.getColumn(row,&quot;BIGO&quot;)&#32;!=&#32;&quot;0&quot;,&#32;&apos;red&apos;,&apos;&apos;)' combodisplayrowcnt="1" display="text"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Grid AreaSelect="TRUE" AutoEnter="TRUE" AutoFitEndLine="Hide" BindDataset="ds_list" BkColor2="default" BoldHead="true" Border="Flat" Bottom="555" CellMoving="TRUE" ColSelect="TRUE" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="243" Id="grd_list" InputPanel="FALSE" Left="8" LineColor="user20" LineType="ExHORZ" OnCellDBLClick="grd_list_OnCellDBClik" OnCellPosChanged="ds_list_OnColumnChanged" OnHeadClick="grd_list_OnHeadClick" Right="966" RowHeight="20" Style="sty_grid" TabOrder="16" TabStop="true" Top="312" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="958">
			<contents>
				<format id="Default">
					<columns>
						<col fix="left" width="30"/>
						<col fix="left" width="80"/>
						<col width="60"/>
						<col width="80"/>
						<col width="110"/>
						<col width="70"/>
						<col width="70"/>
						<col width="70"/>
						<col width="70"/>
						<col width="50"/>
						<col width="60"/>
						<col width="90"/>
						<col width="80"/>
						<col width="80"/>
						<col width="120"/>
						<col width="80"/>
						<col width="90"/>
						<col width="70"/>
						<col width="110"/>
						<col width="70"/>
						<col width="70"/>
						<col width="60"/>
						<col width="60"/>
						<col width="60"/>
						<col width="80"/>
						<col width="110"/>
						<col width="120"/>
						<col width="80"/>
						<col width="100"/>
						<col width="110"/>
						<col width="80"/>
						<col width="90"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="60"/>
						<col width="122"/>
					</columns>
					<head>
						<cell align="center" bkimageid="icon_grid_sel" col="0" display="text" font="굴림,9"/>
						<cell align="center" col="1" cursor="hand" display="text" font="굴림,9" text="발주번호"/>
						<cell align="center" col="2" cursor="hand" display="text" font="굴림,9" text="품목번호"/>
						<cell align="center" col="3" cursor="hand" display="text" font="굴림,9" text="호기번호"/>
						<cell align="center" col="4" cursor="hand" display="text" font="굴림,9" text="공사내역"/>
						<cell align="center" col="5" cursor="hand" display="text" font="굴림,9" text="발주수량"/>
						<cell align="center" col="6" cursor="hand" display="text" font="굴림,9" text="기납품수량"/>
						<cell align="center" col="7" cursor="hand" display="text" font="굴림,9" text="불량수량"/>
						<cell align="center" col="8" cursor="hand" display="text" font="굴림,9" text="발주잔량"/>
						<cell align="center" col="9" cursor="hand" display="text" font="굴림,9" text="단위"/>
						<cell align="center" col="10" cursor="hand" display="text" font="굴림,9" text="저장위치"/>
						<cell align="center" col="11" cursor="hand" display="text" font="굴림,9" text="거래명세서&#32;상태"/>
						<cell align="center" col="12" cursor="hand" display="text" font="굴림,9" text="저장위치&#32;이름"/>
						<cell align="center" col="13" cursor="hand" display="text" font="굴림,9" text="자재번호"/>
						<cell align="center" col="14" cursor="hand" display="text" font="굴림,9" text="자재내역"/>
						<cell align="center" col="15" cursor="hand" display="text" font="굴림,9" text="치수"/>
						<cell align="center" col="16" cursor="hand" display="text" font="굴림,9" text="도면번호"/>
						<cell align="center" col="17" cursor="hand" display="text" font="굴림,9" text="납기일"/>
						<cell align="center" col="18" cursor="hand" display="text" font="굴림,9" text="변경납품일"/>
						<cell align="center" col="19" cursor="hand" display="text" font="굴림,9" text="출고예정일"/>
						<cell align="center" col="20" cursor="hand" display="text" font="굴림,9" text="단가"/>
						<cell align="center" col="21" cursor="hand" display="text" font="굴림,9" text="통화"/>
						<cell align="center" col="22" cursor="hand" display="text" font="굴림,9" text="Box&#32;번호"/>
						<cell align="center" col="23" cursor="hand" display="text" font="굴림,9" text="BOX&#32;구분"/>
						<cell align="center" col="24" cursor="hand" display="text" font="굴림,9" text="Box&#32;발주대상"/>
						<cell align="center" col="25" cursor="hand" display="text" font="굴림,9" text="납품일&#32;변경일자"/>
						<cell align="center" col="26" cursor="hand" display="text" font="굴림,9" text="납품일&#32;변경시간"/>
						<cell align="center" col="27" cursor="hand" display="text" font="굴림,9" text="애칭번호"/>
						<cell align="center" col="28" cursor="hand" display="text" font="굴림,9" text="자재별특성치"/>
						<cell col="29" cursor="hand" display="text" font="굴림,9" text="특성치변경일"/>
						<cell col="30" cursor="hand" display="text" font="굴림,9" text="변경시간"/>
						<cell align="center" col="31" cursor="hand" display="text" font="굴림,9" text="출장검사결과"/>
						<cell align="center" col="32" cursor="hand" display="text" font="굴림,9" text="발주&#32;승인일자"/>
						<cell align="center" col="33" cursor="hand" display="text" font="굴림,9" text="발주&#32;승인시간"/>
						<cell align="center" col="34" cursor="hand" display="text" font="굴림,9" text="발주&#32;삭제일자"/>
						<cell align="center" col="35" cursor="hand" display="text" font="굴림,9" text="발주&#32;삭제시간"/>
						<cell align="center" col="36" cursor="hand" display="text" font="굴림,9" text="계정지정범주"/>
						<cell align="center" col="37" cursor="hand" display="text" font="굴림,9" text="비고"/>
						<cell align="center" col="38" cursor="hand" display="text" font="굴림,9" text="마감"/>
					</head>
					<body>
						<cell align="center" bkcolor2="user22" col="0" colid="CHECK" display="checkbox" edit="checkbox"/>
						<cell bkcolor2="user22" col="1" colid="EBELN" color='expr:iif(length(ds_list.getColumn(row,&quot;DDATE&quot;))&#32;&gt;&#32;0&#32;||&#32;ds_list.getColumn(row,&quot;BIGO&quot;)&#32;==&#32;&quot;1&quot;&#32;||&#32;(ds_list.getColumn(row,&quot;WERKS&quot;)&#32;==&#32;&quot;1000&quot;&#32;&amp;&amp;&#32;length(ds_list.getColumn(row,&quot;P_END&quot;))&#32;&#32;&gt;&#32;0)&#32;,&#32;&apos;red&apos;,&apos;&apos;)' display="text"/>
						<cell align="center" bkcolor2="user22" col="2" colid="EBELP" color='expr:iif(length(ds_list.getColumn(row,&quot;DDATE&quot;))&#32;&gt;&#32;0&#32;||&#32;ds_list.getColumn(row,&quot;BIGO&quot;)&#32;==&#32;&quot;1&quot;&#32;||&#32;(ds_list.getColumn(row,&quot;WERKS&quot;)&#32;==&#32;&quot;1000&quot;&#32;&amp;&amp;&#32;length(ds_list.getColumn(row,&quot;P_END&quot;))&#32;&#32;&gt;&#32;0)&#32;,&#32;&apos;red&apos;,&apos;&apos;)' display="text"/>
						<cell align="center" bkcolor2="user22" col="3" colid="POSID" color='expr:iif(length(ds_list.getColumn(row,&quot;DDATE&quot;))&#32;&gt;&#32;0&#32;||&#32;ds_list.getColumn(row,&quot;BIGO&quot;)&#32;==&#32;&quot;1&quot;&#32;||&#32;(ds_list.getColumn(row,&quot;WERKS&quot;)&#32;==&#32;&quot;1000&quot;&#32;&amp;&amp;&#32;length(ds_list.getColumn(row,&quot;P_END&quot;))&#32;&#32;&gt;&#32;0)&#32;,&#32;&apos;red&apos;,&apos;&apos;)' display="text"/>
						<cell bkcolor2="user22" col="4" colid="POST1" color='expr:iif(length(ds_list.getColumn(row,&quot;DDATE&quot;))&#32;&gt;&#32;0&#32;||&#32;ds_list.getColumn(row,&quot;BIGO&quot;)&#32;==&#32;&quot;1&quot;&#32;||&#32;(ds_list.getColumn(row,&quot;WERKS&quot;)&#32;==&#32;&quot;1000&quot;&#32;&amp;&amp;&#32;length(ds_list.getColumn(row,&quot;P_END&quot;))&#32;&#32;&gt;&#32;0)&#32;,&#32;&apos;red&apos;,&apos;&apos;)' display="text"/>
						<cell align="right" bkcolor2="user22" col="5" colid="MENGE3" color='expr:iif(length(ds_list.getColumn(row,&quot;DDATE&quot;))&#32;&gt;&#32;0&#32;||&#32;ds_list.getColumn(row,&quot;BIGO&quot;)&#32;==&#32;&quot;1&quot;&#32;||&#32;(ds_list.getColumn(row,&quot;WERKS&quot;)&#32;==&#32;&quot;1000&quot;&#32;&amp;&amp;&#32;length(ds_list.getColumn(row,&quot;P_END&quot;))&#32;&#32;&gt;&#32;0)&#32;,&#32;&apos;red&apos;,&apos;&apos;)' display="number" Mask="###,###.##"/>
						<cell align="right" bkcolor2="user22" col="6" colid="MENGE1" color='expr:iif(length(ds_list.getColumn(row,&quot;DDATE&quot;))&#32;&gt;&#32;0&#32;||&#32;ds_list.getColumn(row,&quot;BIGO&quot;)&#32;==&#32;&quot;1&quot;&#32;||&#32;(ds_list.getColumn(row,&quot;WERKS&quot;)&#32;==&#32;&quot;1000&quot;&#32;&amp;&amp;&#32;length(ds_list.getColumn(row,&quot;P_END&quot;))&#32;&#32;&gt;&#32;0)&#32;,&#32;&apos;red&apos;,&apos;&apos;)' display="number" Mask="###,###.##"/>
						<cell align="right" bkcolor2="user22" bkimagealign="left" col="7" colid="B_MENGE" color='expr:iif(length(ds_list.getColumn(row,&quot;DDATE&quot;))&#32;&gt;&#32;0&#32;||&#32;ds_list.getColumn(row,&quot;BIGO&quot;)&#32;==&#32;&quot;1&quot;&#32;||&#32;(ds_list.getColumn(row,&quot;WERKS&quot;)&#32;==&#32;&quot;1000&quot;&#32;&amp;&amp;&#32;length(ds_list.getColumn(row,&quot;P_END&quot;))&#32;&#32;&gt;&#32;0)&#32;,&#32;&apos;red&apos;,&apos;&apos;)' display="number" Mask="###,###.##"/>
						<cell align="right" bkcolor2="user22" bkimagealign="left" bkimageid="icon_grid_edit" col="8" colid="MENGE" color='expr:iif(length(ds_list.getColumn(row,&quot;DDATE&quot;))&#32;&gt;&#32;0&#32;||&#32;ds_list.getColumn(row,&quot;BIGO&quot;)&#32;==&#32;&quot;1&quot;&#32;||&#32;(ds_list.getColumn(row,&quot;WERKS&quot;)&#32;==&#32;&quot;1000&quot;&#32;&amp;&amp;&#32;length(ds_list.getColumn(row,&quot;P_END&quot;))&#32;&#32;&gt;&#32;0)&#32;,&#32;&apos;red&apos;,&apos;&apos;)' display="number" edit="normal" Mask="###,###.##"/>
						<cell align="center" bkcolor2="user22" col="9" colid="MEINS" color='expr:iif(length(ds_list.getColumn(row,&quot;DDATE&quot;))&#32;&gt;&#32;0&#32;||&#32;ds_list.getColumn(row,&quot;BIGO&quot;)&#32;==&#32;&quot;1&quot;&#32;||&#32;(ds_list.getColumn(row,&quot;WERKS&quot;)&#32;==&#32;&quot;1000&quot;&#32;&amp;&amp;&#32;length(ds_list.getColumn(row,&quot;P_END&quot;))&#32;&#32;&gt;&#32;0)&#32;,&#32;&apos;red&apos;,&apos;&apos;)' display="text"/>
						<cell align="center" bkcolor2="user22" col="10" colid="LGORT" color='expr:iif(length(ds_list.getColumn(row,&quot;DDATE&quot;))&#32;&gt;&#32;0&#32;||&#32;ds_list.getColumn(row,&quot;BIGO&quot;)&#32;==&#32;&quot;1&quot;&#32;||&#32;(ds_list.getColumn(row,&quot;WERKS&quot;)&#32;==&#32;&quot;1000&quot;&#32;&amp;&amp;&#32;length(ds_list.getColumn(row,&quot;P_END&quot;))&#32;&#32;&gt;&#32;0)&#32;,&#32;&apos;red&apos;,&apos;&apos;)' display="text"/>
						<cell align="center" bkcolor2="user22" col="11" colid="PRO_F" color='expr:iif(length(ds_list.getColumn(row,&quot;DDATE&quot;))&#32;&gt;&#32;0&#32;||&#32;ds_list.getColumn(row,&quot;BIGO&quot;)&#32;==&#32;&quot;1&quot;&#32;||&#32;(ds_list.getColumn(row,&quot;WERKS&quot;)&#32;==&#32;&quot;1000&quot;&#32;&amp;&amp;&#32;length(ds_list.getColumn(row,&quot;P_END&quot;))&#32;&#32;&gt;&#32;0)&#32;,&#32;&apos;red&apos;,&apos;&apos;)' combocol="CODE" combodataset="ds_pro_f_cd" combotext="CODE_NAME" display="combo"/>
						<cell align="center" bkcolor2="user22" col="12" colid="LGOBE" color='expr:iif(length(ds_list.getColumn(row,&quot;DDATE&quot;))&#32;&gt;&#32;0&#32;||&#32;ds_list.getColumn(row,&quot;BIGO&quot;)&#32;==&#32;&quot;1&quot;&#32;||&#32;(ds_list.getColumn(row,&quot;WERKS&quot;)&#32;==&#32;&quot;1000&quot;&#32;&amp;&amp;&#32;length(ds_list.getColumn(row,&quot;P_END&quot;))&#32;&#32;&gt;&#32;0)&#32;,&#32;&apos;red&apos;,&apos;&apos;)' display="text"/>
						<cell align="center" bkcolor2="user22" col="13" colid="MATNR" color='expr:iif(length(ds_list.getColumn(row,&quot;DDATE&quot;))&#32;&gt;&#32;0&#32;||&#32;ds_list.getColumn(row,&quot;BIGO&quot;)&#32;==&#32;&quot;1&quot;&#32;||&#32;(ds_list.getColumn(row,&quot;WERKS&quot;)&#32;==&#32;&quot;1000&quot;&#32;&amp;&amp;&#32;length(ds_list.getColumn(row,&quot;P_END&quot;))&#32;&#32;&gt;&#32;0)&#32;,&#32;&apos;red&apos;,&apos;&apos;)' display="text"/>
						<cell bkcolor2="user22" col="14" colid="MAKTX" color='expr:iif(length(ds_list.getColumn(row,&quot;DDATE&quot;))&#32;&gt;&#32;0&#32;||&#32;ds_list.getColumn(row,&quot;BIGO&quot;)&#32;==&#32;&quot;1&quot;&#32;||&#32;(ds_list.getColumn(row,&quot;WERKS&quot;)&#32;==&#32;&quot;1000&quot;&#32;&amp;&amp;&#32;length(ds_list.getColumn(row,&quot;P_END&quot;))&#32;&#32;&gt;&#32;0)&#32;,&#32;&apos;red&apos;,&apos;&apos;)' display="text"/>
						<cell bkcolor2="user22" col="15" colid="GROES" color='expr:iif(length(ds_list.getColumn(row,&quot;DDATE&quot;))&#32;&gt;&#32;0&#32;||&#32;ds_list.getColumn(row,&quot;BIGO&quot;)&#32;==&#32;&quot;1&quot;&#32;||&#32;(ds_list.getColumn(row,&quot;WERKS&quot;)&#32;==&#32;&quot;1000&quot;&#32;&amp;&amp;&#32;length(ds_list.getColumn(row,&quot;P_END&quot;))&#32;&#32;&gt;&#32;0)&#32;,&#32;&apos;red&apos;,&apos;&apos;)' display="text"/>
						<cell align="center" bkcolor2="user22" col="16" colid="ZEINR" color='expr:iif(length(ds_list.getColumn(row,&quot;DDATE&quot;))&#32;&gt;&#32;0&#32;||&#32;ds_list.getColumn(row,&quot;BIGO&quot;)&#32;==&#32;&quot;1&quot;&#32;||&#32;(ds_list.getColumn(row,&quot;WERKS&quot;)&#32;==&#32;&quot;1000&quot;&#32;&amp;&amp;&#32;length(ds_list.getColumn(row,&quot;P_END&quot;))&#32;&#32;&gt;&#32;0)&#32;,&#32;&apos;red&apos;,&apos;&apos;)' display="text"/>
						<cell align="center" bkcolor2="user22" col="17" colid="EINDT" color='expr:iif(length(ds_list.getColumn(row,&quot;DDATE&quot;))&#32;&gt;&#32;0&#32;||&#32;ds_list.getColumn(row,&quot;BIGO&quot;)&#32;==&#32;&quot;1&quot;&#32;||&#32;(ds_list.getColumn(row,&quot;WERKS&quot;)&#32;==&#32;&quot;1000&quot;&#32;&amp;&amp;&#32;length(ds_list.getColumn(row,&quot;P_END&quot;))&#32;&#32;&gt;&#32;0)&#32;,&#32;&apos;red&apos;,&apos;&apos;)' display="text" Mask="####.##.##"/>
						<cell align="center" bkcolor2="user22" col="18" colid="UDATE" color='expr:iif(length(ds_list.getColumn(row,&quot;DDATE&quot;))&#32;&gt;&#32;0&#32;||&#32;ds_list.getColumn(row,&quot;BIGO&quot;)&#32;==&#32;&quot;1&quot;&#32;||&#32;(ds_list.getColumn(row,&quot;WERKS&quot;)&#32;==&#32;&quot;1000&quot;&#32;&amp;&amp;&#32;length(ds_list.getColumn(row,&quot;P_END&quot;))&#32;&#32;&gt;&#32;0)&#32;,&#32;&apos;red&apos;,&apos;&apos;)' display="text" Mask="####.##.##"/>
						<cell align="center" bkcolor2="user22" col="19" colid="SHIPDAT" color='expr:iif(length(ds_list.getColumn(row,&quot;DDATE&quot;))&#32;&gt;&#32;0&#32;||&#32;ds_list.getColumn(row,&quot;BIGO&quot;)&#32;==&#32;&quot;1&quot;&#32;||&#32;(ds_list.getColumn(row,&quot;WERKS&quot;)&#32;==&#32;&quot;1000&quot;&#32;&amp;&amp;&#32;length(ds_list.getColumn(row,&quot;P_END&quot;))&#32;&#32;&gt;&#32;0)&#32;,&#32;&apos;red&apos;,&apos;&apos;)' display="text" Mask="####.##.##"/>
						<cell align="right" bkcolor2="user22" col="20" colid="NETPR" color='expr:iif(length(ds_list.getColumn(row,&quot;DDATE&quot;))&#32;&gt;&#32;0&#32;||&#32;ds_list.getColumn(row,&quot;BIGO&quot;)&#32;==&#32;&quot;1&quot;&#32;||&#32;(ds_list.getColumn(row,&quot;WERKS&quot;)&#32;==&#32;&quot;1000&quot;&#32;&amp;&amp;&#32;length(ds_list.getColumn(row,&quot;P_END&quot;))&#32;&#32;&gt;&#32;0)&#32;,&#32;&apos;red&apos;,&apos;&apos;)' display="number" Mask="###,###"/>
						<cell align="center" bkcolor2="user22" col="21" colid="WAERS" color='expr:iif(length(ds_list.getColumn(row,&quot;DDATE&quot;))&#32;&gt;&#32;0&#32;||&#32;ds_list.getColumn(row,&quot;BIGO&quot;)&#32;==&#32;&quot;1&quot;&#32;||&#32;(ds_list.getColumn(row,&quot;WERKS&quot;)&#32;==&#32;&quot;1000&quot;&#32;&amp;&amp;&#32;length(ds_list.getColumn(row,&quot;P_END&quot;))&#32;&#32;&gt;&#32;0)&#32;,&#32;&apos;red&apos;,&apos;&apos;)' display="text"/>
						<cell align="center" bkcolor2="user22" col="22" colid="EXTWG" color='expr:iif(length(ds_list.getColumn(row,&quot;DDATE&quot;))&#32;&gt;&#32;0&#32;||&#32;ds_list.getColumn(row,&quot;BIGO&quot;)&#32;==&#32;&quot;1&quot;&#32;||&#32;(ds_list.getColumn(row,&quot;WERKS&quot;)&#32;==&#32;&quot;1000&quot;&#32;&amp;&amp;&#32;length(ds_list.getColumn(row,&quot;P_END&quot;))&#32;&#32;&gt;&#32;0)&#32;,&#32;&apos;red&apos;,&apos;&apos;)' display="text"/>
						<cell align="center" bkcolor2="user22" col="23" colid="BOX_CK" color='expr:iif(length(ds_list.getColumn(row,&quot;DDATE&quot;))&#32;&gt;&#32;0&#32;||&#32;ds_list.getColumn(row,&quot;BIGO&quot;)&#32;==&#32;&quot;1&quot;&#32;||&#32;(ds_list.getColumn(row,&quot;WERKS&quot;)&#32;==&#32;&quot;1000&quot;&#32;&amp;&amp;&#32;length(ds_list.getColumn(row,&quot;P_END&quot;))&#32;&#32;&gt;&#32;0)&#32;,&#32;&apos;red&apos;,&apos;&apos;)' combocol="CODE" combodataset="ds_box_ck_cd" combotext="CODE_NAME" display="combo"/>
						<cell align="center" bkcolor2="user22" col="24" colid="POTYPE" color='expr:iif(length(ds_list.getColumn(row,&quot;DDATE&quot;))&#32;&gt;&#32;0&#32;||&#32;ds_list.getColumn(row,&quot;BIGO&quot;)&#32;==&#32;&quot;1&quot;&#32;||&#32;(ds_list.getColumn(row,&quot;WERKS&quot;)&#32;==&#32;&quot;1000&quot;&#32;&amp;&amp;&#32;length(ds_list.getColumn(row,&quot;P_END&quot;))&#32;&#32;&gt;&#32;0)&#32;,&#32;&apos;red&apos;,&apos;&apos;)' combocol="CODE" combodataset="ds_potype" combotext="CODE_NAME" display="combo"/>
						<cell align="center" bkcolor2="user22" col="25" colid="EDATE" color='expr:iif(length(ds_list.getColumn(row,&quot;DDATE&quot;))&#32;&gt;&#32;0&#32;||&#32;ds_list.getColumn(row,&quot;BIGO&quot;)&#32;==&#32;&quot;1&quot;&#32;||&#32;(ds_list.getColumn(row,&quot;WERKS&quot;)&#32;==&#32;&quot;1000&quot;&#32;&amp;&amp;&#32;length(ds_list.getColumn(row,&quot;P_END&quot;))&#32;&#32;&gt;&#32;0)&#32;,&#32;&apos;red&apos;,&apos;&apos;)' display="text" Mask="####.##.##"/>
						<cell align="center" bkcolor2="user22" col="26" colid="ETIME" color='expr:iif(length(ds_list.getColumn(row,&quot;DDATE&quot;))&#32;&gt;&#32;0&#32;||&#32;ds_list.getColumn(row,&quot;BIGO&quot;)&#32;==&#32;&quot;1&quot;&#32;||&#32;(ds_list.getColumn(row,&quot;WERKS&quot;)&#32;==&#32;&quot;1000&quot;&#32;&amp;&amp;&#32;length(ds_list.getColumn(row,&quot;P_END&quot;))&#32;&#32;&gt;&#32;0)&#32;,&#32;&apos;red&apos;,&apos;&apos;)' display="text" Mask="##:##:##"/>
						<cell align="center" bkcolor2="user22" col="27" colid="VALUE" color='expr:iif(length(ds_list.getColumn(row,&quot;DDATE&quot;))&#32;&gt;&#32;0&#32;||&#32;ds_list.getColumn(row,&quot;BIGO&quot;)&#32;==&#32;&quot;1&quot;&#32;||&#32;(ds_list.getColumn(row,&quot;WERKS&quot;)&#32;==&#32;&quot;1000&quot;&#32;&amp;&amp;&#32;length(ds_list.getColumn(row,&quot;P_END&quot;))&#32;&#32;&gt;&#32;0)&#32;,&#32;&apos;red&apos;,&apos;&apos;)' display="text"/>
						<cell bkcolor2="user22" col="28" colid="CHAR1" color='expr:iif(length(ds_list.getColumn(row,&quot;DDATE&quot;))&#32;&gt;&#32;0&#32;||&#32;ds_list.getColumn(row,&quot;BIGO&quot;)&#32;==&#32;&quot;1&quot;&#32;||&#32;(ds_list.getColumn(row,&quot;WERKS&quot;)&#32;==&#32;&quot;1000&quot;&#32;&amp;&amp;&#32;length(ds_list.getColumn(row,&quot;P_END&quot;))&#32;&#32;&gt;&#32;0)&#32;,&#32;&apos;red&apos;,&apos;&apos;)' display="text"/>
						<cell col="29" colid="CHDAT" color='expr:iif(length(ds_list.getColumn(row,&quot;DDATE&quot;))&#32;&gt;&#32;0&#32;||&#32;ds_list.getColumn(row,&quot;BIGO&quot;)&#32;==&#32;&quot;1&quot;&#32;||&#32;(ds_list.getColumn(row,&quot;WERKS&quot;)&#32;==&#32;&quot;1000&quot;&#32;&amp;&amp;&#32;length(ds_list.getColumn(row,&quot;P_END&quot;))&#32;&#32;&gt;&#32;0)&#32;,&#32;&apos;red&apos;,&apos;&apos;)' display="text" Mask="####.##.##"/>
						<cell align="center" col="30" colid="CHTIM" color='expr:iif(length(ds_list.getColumn(row,&quot;DDATE&quot;))&#32;&gt;&#32;0&#32;||&#32;ds_list.getColumn(row,&quot;BIGO&quot;)&#32;==&#32;&quot;1&quot;&#32;||&#32;(ds_list.getColumn(row,&quot;WERKS&quot;)&#32;==&#32;&quot;1000&quot;&#32;&amp;&amp;&#32;length(ds_list.getColumn(row,&quot;P_END&quot;))&#32;&#32;&gt;&#32;0)&#32;,&#32;&apos;red&apos;,&apos;&apos;)' display="text" Mask="##:##:##"/>
						<cell align="right" bkcolor2="user22" col="31" colid="INS_Q" color='expr:iif(length(ds_list.getColumn(row,&quot;DDATE&quot;))&#32;&gt;&#32;0&#32;||&#32;ds_list.getColumn(row,&quot;BIGO&quot;)&#32;==&#32;&quot;1&quot;&#32;||&#32;(ds_list.getColumn(row,&quot;WERKS&quot;)&#32;==&#32;&quot;1000&quot;&#32;&amp;&amp;&#32;length(ds_list.getColumn(row,&quot;P_END&quot;))&#32;&#32;&gt;&#32;0)&#32;,&#32;&apos;red&apos;,&apos;&apos;)' display="text"/>
						<cell align="center" bkcolor2="user22" col="32" colid="SDATE" color='expr:iif(length(ds_list.getColumn(row,&quot;DDATE&quot;))&#32;&gt;&#32;0&#32;||&#32;ds_list.getColumn(row,&quot;BIGO&quot;)&#32;==&#32;&quot;1&quot;&#32;||&#32;(ds_list.getColumn(row,&quot;WERKS&quot;)&#32;==&#32;&quot;1000&quot;&#32;&amp;&amp;&#32;length(ds_list.getColumn(row,&quot;P_END&quot;))&#32;&#32;&gt;&#32;0)&#32;,&#32;&apos;red&apos;,&apos;&apos;)' display="text" Mask="####.##.##"/>
						<cell align="center" bkcolor2="user22" col="33" colid="STIME" color='expr:iif(length(ds_list.getColumn(row,&quot;DDATE&quot;))&#32;&gt;&#32;0&#32;||&#32;ds_list.getColumn(row,&quot;BIGO&quot;)&#32;==&#32;&quot;1&quot;&#32;||&#32;(ds_list.getColumn(row,&quot;WERKS&quot;)&#32;==&#32;&quot;1000&quot;&#32;&amp;&amp;&#32;length(ds_list.getColumn(row,&quot;P_END&quot;))&#32;&#32;&gt;&#32;0)&#32;,&#32;&apos;red&apos;,&apos;&apos;)' display="text" Mask="##:##:##"/>
						<cell align="center" bkcolor2="user22" col="34" colid="DDATE" color='expr:iif(length(ds_list.getColumn(row,&quot;DDATE&quot;))&#32;&gt;&#32;0&#32;||&#32;ds_list.getColumn(row,&quot;BIGO&quot;)&#32;==&#32;&quot;1&quot;&#32;||&#32;(ds_list.getColumn(row,&quot;WERKS&quot;)&#32;==&#32;&quot;1000&quot;&#32;&amp;&amp;&#32;length(ds_list.getColumn(row,&quot;P_END&quot;))&#32;&#32;&gt;&#32;0)&#32;,&#32;&apos;red&apos;,&apos;&apos;)' display="text" Mask="####.##.##"/>
						<cell align="center" bkcolor2="user22" col="35" colid="DTIME" color='expr:iif(length(ds_list.getColumn(row,&quot;DDATE&quot;))&#32;&gt;&#32;0&#32;||&#32;ds_list.getColumn(row,&quot;BIGO&quot;)&#32;==&#32;&quot;1&quot;&#32;||&#32;(ds_list.getColumn(row,&quot;WERKS&quot;)&#32;==&#32;&quot;1000&quot;&#32;&amp;&amp;&#32;length(ds_list.getColumn(row,&quot;P_END&quot;))&#32;&#32;&gt;&#32;0)&#32;,&#32;&apos;red&apos;,&apos;&apos;)' display="text" Mask="##:##:##"/>
						<cell align="center" bkcolor2="user22" col="36" colid="KNTTP" color='expr:iif(length(ds_list.getColumn(row,&quot;DDATE&quot;))&#32;&gt;&#32;0&#32;||&#32;ds_list.getColumn(row,&quot;BIGO&quot;)&#32;==&#32;&quot;1&quot;&#32;||&#32;(ds_list.getColumn(row,&quot;WERKS&quot;)&#32;==&#32;&quot;1000&quot;&#32;&amp;&amp;&#32;length(ds_list.getColumn(row,&quot;P_END&quot;))&#32;&#32;&gt;&#32;0)&#32;,&#32;&apos;red&apos;,&apos;&apos;)' display="text"/>
						<cell align="center" bkcolor2="user22" col="37" colid="BIGO" color='expr:iif(length(ds_list.getColumn(row,&quot;DDATE&quot;))&#32;&gt;&#32;0&#32;||&#32;ds_list.getColumn(row,&quot;BIGO&quot;)&#32;==&#32;&quot;1&quot;&#32;||&#32;(ds_list.getColumn(row,&quot;WERKS&quot;)&#32;==&#32;&quot;1000&quot;&#32;&amp;&amp;&#32;length(ds_list.getColumn(row,&quot;P_END&quot;))&#32;&#32;&gt;&#32;0)&#32;,&#32;&apos;red&apos;,&apos;&apos;)' combocol="CODE" combodataset="ds_bigo_cd" combotext="CODE_NAME" display="combo"/>
						<cell align="left" bkcolor2="user22" col="38" colid="P_END" color='expr:iif(length(ds_list.getColumn(row,&quot;DDATE&quot;))&#32;&gt;&#32;0&#32;||&#32;ds_list.getColumn(row,&quot;BIGO&quot;)&#32;==&#32;&quot;1&quot;&#32;||&#32;(ds_list.getColumn(row,&quot;WERKS&quot;)&#32;==&#32;&quot;1000&quot;&#32;&amp;&amp;&#32;length(ds_list.getColumn(row,&quot;P_END&quot;))&#32;&#32;&gt;&#32;0)&#32;,&#32;&apos;red&apos;,&apos;&apos;)' combodisplayrowcnt="1" display="text"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="CODE" Column="GUBN" DataColumn="CODE_NAME" Editable="TRUE" Height="20" Id="cb_gubn" InnerDataset="ds_gubn_cd" Left="14" Style="sty_ipt_form_ind" TabOrder="32" Top="40" Width="91"></Combo>
		<Static Align="Right" Height="24" Id="Static3" Left="806" Style="sty_lb_form_basic" TabOrder="33" Text="계정범주&#32;" Top="39" VAlign="Middle" Width="79"></Static>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="CODE" Column="KNTTP" DataColumn="CODE_NAME" Height="20" Id="cb_knttp" InnerDataset="ds_knttp_cd" Left="885" Style="sty_ipt_form" TabOrder="34" Top="40" Width="83"></Combo>
		<Checkbox Height="11" Id="cb_detail" Left="876" TabOrder="35" Text="STO현장" Top="70" Value="FALSE" Width="73"></Checkbox>
	</Form>
	<Script><![CDATA[﻿﻿﻿﻿﻿﻿/*
 ******************************************************************************************
 * 기      능   : 
 * 작  성  자   : 
 * 작성  일자   : 
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
#include "LIB::commons.js";	// 공통 스크립트 
//=========================================================================================
// [ PART 1 ]
// Form에서 사용될 전역변수를 선언
// FORM에서 사용되는 전역변수는 대문자로 작성하며, F_XXX 의 형태를 갖도록 한다. 
//=========================================================================================
var teco = null;
var CHK = "0"; // 이중실행 방지 변수
var F_TIMEOUT = 0;
//=========================================================================================
// [ PART 2 ]
// Form Loading / Unloading 시 작업 정의
//=========================================================================================
function fn_OnLoadCompleted(obj) {
	// Form 로드 이벤트 맨 첫줄에 기술 
	gfn_initForm(true);

	// HTTP TIMEOUT 설정
    F_TIMEOUT = HTTP.TimeOut;

	// 공급 업체명 설정 
	ed_lifnrName.value = G_VEND_NAME;
	ds_cond.setColumn(0, "LIFNR", G_VEND_CODE_M);
    ds_cond.setColumn(0, "G_MANDT", G_MANDT);

    // 엑셀 버튼 비활성화
    ufn_enableBtn("excel", false);

    // 코드 DataSet 가져오기
    var codeArr = ["6"];
    var dsObjArr = [ds_pro_f_cd];
    var addTypeArr = [G_CODE_ALL];
    gfn_searchCommCode(codeArr, dsObjArr, addTypeArr,true);

    // 코드 DataSet 가져오기
    var codeArr = ["10"];
    var dsObjArr = [ds_ekgrp_cd];
    var addTypeArr = [G_CODE_ALL];
    gfn_searchCommCode(codeArr, dsObjArr, addTypeArr,true);

    // 플랜트코드 DataSet 가져오기
    var codeArr = ["11"];
    var dsObjArr = [ds_werks_cd];
    var addTypeArr = [G_CODE_ALL];
    gfn_searchCommCode(codeArr, dsObjArr, addTypeArr,true);

    //  상태 코드 DataSet 가져오기
    var codeArr = ["5"];
    var dsObjArr = [ds_state_cd];
    var addTypeArr = [G_CODE_NONE];
    gfn_searchCommCode(codeArr, dsObjArr, addTypeArr,true);

    //  저장위치 DataSet 가져오기
    var codeArr = ["12"];
    var dsObjArr = [ds_lgort_cd];
    var addTypeArr = [G_CODE_NONE];
    var oderTypeArr = ["DTEXT1"];
    gfn_searchCommCode2(codeArr, dsObjArr, addTypeArr, oderTypeArr, true);

	// 현재 조회 일자 설정 
	cal_udate_fm.value = gfn_getCurrDate();
	cal_udate_to.value = gfn_getAfterDate(cal_udate_fm.value, 15);

	// 납기예정일자 설정 
	cal_rdate_p.value = gfn_getCurrDate();



    // PO조회에서 호출된 경우 조건값 입력
	if ( isExistVar("fa_udate_fm", true) ) {
	   cal_udate_to.value = fa_udate_to;
	   cal_udate_fm.value = fa_udate_fm;

       cb_werks.Value = fa_werks;
       cb_lgort.Value = fa_lgort;
	   cb_ekgrp.Value = fa_ekgrp;
	   ed_posid1.Value = fa_posid1;
	   ed_posid2.Value = fa_posid2;
	   ed_posid2.Value = fa_posid2;
	   cb_gubn.Value = fa_gubn;
	   
       ds_cond.SetColumn(0,"KNTTP",fa_knttp);
       
	   if (isExistVar("fa_invnr", true)) {
			ed_invnr.Value = fa_invnr;
			cb_gubn.Index = 0;
	   }
	   
	   fn_query();
	} else {     
	   gfn_showMsg("CI00007");
	} 

}
/********************************************************************************
* 기      능   : 공통코드가 조회된 후의 Callback 함수 
********************************************************************************/
function fn_completeInit(sCode, sDsObj, sCodeType) {
	//  구분 설정 
	cb_gubn.Index = 0;

	//  Plant  설정 
	cb_werks.Index = 0;
	
	//  저장위치  설정 
	cb_lgort.Index = 0;

	//  구매그룹  설정 
	cb_ekgrp.Index = 0;

}
/********************************************************************************
* 기      능   : form UnloadCompleted 
********************************************************************************/
function fn_OnUnloadCompleted(obj) {
	return gfn_isFormUnload(obj);
}
//=========================================================================================
// [ PART 3 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,form닫기)
//=========================================================================================
/********************************************************************************
* 기      능   : 조회 
********************************************************************************/
function fn_query() {
    // 이중 실행 방지(1일 경우 실행중)
	if (CHK != "0") return;
	
//	ufn_chkJajae(); //JQPR 입고예정일 미입력 수량 JYJ 임시 주석 200210
    
    // Message 영역 초기화
	global.FRM_BOTTOM.img_msgType.imageId = "";
	global.FRM_BOTTOM.st_msg.value = "";
	
/*	if ( gfn_isNull(cb_werks, true) ) {
		gfn_showMsg("CW00001","Plant");
		return;
	}*/
	var posgbn1 = "";
	var posgbn2 = "";
	
	var maxdate1 = gfn_getAfterDate(cal_udate_fm.value, 90);
	var maxdate = gfn_getAfterDate(cal_udate_fm.value, 180);
	var message_arg1 = ["조회기간","90일"];
	var message_arg = ["조회기간","180일"];
	if (G_VEND_CODE == "3128147552" || G_VEND_CODE == "1278167377" || G_VEND_CODE == "1268191379" || G_VEND_CODE == "1258199290" ||
		G_VEND_CODE == "1260267909" || G_VEND_CODE == "1268637313" || G_VEND_CODE == "1348523088" || G_VEND_CODE == "1178113200" ||
		G_VEND_CODE == "1358115507" || G_VEND_CODE == "2068653211" || G_VEND_CODE == "2188115501" || G_VEND_CODE == "1191381097" ||
		G_VEND_CODE == "1348156956" || G_VEND_CODE == "2148898192" || G_VEND_CODE == "6518800811" || G_VEND_CODE == "2908600679" ||
		G_VEND_CODE == "3128126519" || G_VEND_CODE == "8328100309" || G_VEND_CODE == "1268186124" || G_VEND_CODE == "2100152155") {
		if (cal_udate_to > maxdate1)
		{
			gfn_showAlert("CW00133",message_arg1);
			return;
		}
	}
	else {
		if (cal_udate_to > maxdate)
		{
			gfn_showAlert("CW00133",message_arg);
			return;
		}
	}
	
	// 특정edit에 숫자나 영문이 들어가지 않으면 조회 불가 200918 yj
	if (chk_edcode(trim(ed_posid1.Text)) == false) {
		alert("호기번호에는 영문과 숫자만 입력 가능합니다.");
		return false;
	}
	else if (chk_edcode(trim(ed_matnr.Text)) == false) {
		alert("자재번호에는 영문과 숫자만 입력 가능합니다.");
		return false;
	}

	if ( length(ed_invnr.value) == 0 ) {
		// 필수 입력 항목 체크 
		if ( gfn_isNull(cal_udate_fm, true) ) {
			gfn_showMsg("CW00001",cb_gubn.Text+"(시작)");
			return;
		}
		if ( gfn_isNull(cal_udate_to, true) ) {
			gfn_showMsg("CW00001",cb_gubn.Text+"(종료)");
			return;
		}

		if ( !gfn_checkDate( cal_udate_fm.value, cal_udate_to.value, true, cal_udate_to) ) {
			return;
		}

		if ( gfn_isNull(cb_lgort, true) ) {
			gfn_showMsg("CW00001","저장위치");
			return;
		}

		if (length(ed_posid1.value) > 0 && length(ed_posid1.value) < 6){
			gfn_showAlert("CW00092");
			ed_posid1.SetFocus();
			return;
		}
		
		if (length(ed_posid1.value) >= 6){
			
			posgbn1 = ed_posid1.value;
			if (length(ed_posid2.value) > 0)
			{
				posgbn2 = gfn_fillChar(ed_posid2.value,11,"Z");
			}
			else
			{
				posgbn2 = gfn_fillChar(ed_posid1.value,11,"Z");
			}
		}
	}
	
	if(cb_werks.Value = "2000" && cb_lgort.Value = "9000" && cb_knttp.value != "F")
	{
		gfn_showAlert("당사 자산과 관련된 발주의 조회는 계정범주에 투자잔산이 선택되어 있을 경우에만 조회 됩니다.");
	}
	
	
	ds_cond.SetColumn(0,"POSID1",posgbn1);
	ds_cond.SetColumn(0,"POSID2",posgbn2);
	

    // 발주조회 변수 지정
	var posid;
	var udate;
	var matnr;
	
	if (isExistVar("fa_posid", true)) {
		posid = fa_posid;
		udate = fa_udate;
		matnr = fa_matnr;
	}
	
	tit_clearActionInfo();
	
	if (length(ed_invnr.value) > 0)	{
		tit_addSearchActionInfo("mm03:MM0301002B_S3");
		if(cb_detail.Value == "1")
		{
			tit_addSearchActionInfo("mm03:MM0301002B_S6");
		} else {
			tit_addSearchActionInfo("mm03:MM0301002B_S4");
		}		
	} else {
		tit_addSearchActionInfo("mm03:MM0301002B_S1");
		if(cb_detail.Value == "1")
		{
			tit_addSearchActionInfo("mm03:MM0301002B_S5");
		} else {
			tit_addSearchActionInfo("mm03:MM0301002B_S2");
		}		
	}

    // 이중 실행 방지(실행 시 1)
	CHK = "1";
	
	http.TimeOut = 3600;

	tit_callService(
        ""
        , ""
        , "ds_cond=ds_cond"
        , "ds_sum=ds_sum ds_list=ds_list"
        , "POSID="+quote(posid) +" UDATE="+quote(udate) +" MATNR1="+quote(matnr)
        , "fn_afterQuery"
        , ""
        , ""
        , false);
}
/********************************************************************************
* 기      능   : 삽입 
********************************************************************************/
function fn_insert() {
}
/********************************************************************************
* 기      능   : Delete 
********************************************************************************/
function fn_delete() {

}

/********************************************************************************
* 기      능   : 거래명세서 저장취소 
********************************************************************************/
function fn_cancel() {
    // 이중 실행 방지(1일 경우 실행중)
	if (CHK != "0") return;

/*	if ( !gfn_isChangeDs(ds_list, true, "FLAG") ) {
		return;
	}*/

	// 입력할 거래명세서에 납품예정일을 입력
	var chkSize = 0;
	for ( var i = 0; i < ds_list.rowCount(); i++ ) {
		if( ds_list.getColumn(i, "CHECK") == "1") {
			if (ds_list.GetColumn(i,"PRO_F") != "1" ){
				gfn_showAlert("CW00026");
				obj.SetColumn(nRow,"CHECK", "0");
				return;
			}
			chkSize++;
		}
	}
	
	if (chkSize < 1) {
		gfn_showAlert("CW00001","선택");
		return;
	}
	
	if (!gfn_showConfirm("CI00009")) {
		return;
	}

	// 저장할 데이터셋 복사
	gfn_copyDS(ds_list,ds_list_0, "CHECK=1");

	// 입력할 거래명세서에 납품예정일을 입력
	for ( var i = 0; i < ds_list_0.rowcount; i++ ) {
		ds_list_0.SetColumn(i,"FLAG","D");
	}
	tit_clearActionInfo();

    //저장 삭제시 바코드TAG번호에도 삭제표기
    tit_addSaveActionInfo(
        ""
        , ""
        , "mm03:MM0301002A_U2"
        , "FLAG"
        , "", -1 );
        
	// 저장 처리 
	tit_addSaveActionInfo(
        ""
        , ""
        , "mm03:MM0301002A_U1"
        , "FLAG"
        , "", -1 );
        
    // zmmt017 _Z 저장 처리 
	tit_addSaveActionInfo(
        ""
        , ""
        , "mm03:MM0301002A_U3"
        , "FLAG"
        , "", -1 );

	// 이중 실행 방지(실행 시 1)
	CHK = "1";

	tit_callService(
        ""
        , ""
        , "ds_list=ds_list_0:A"
        , ""
        , ""
        , "fn_afterCancel");
}


/********************************************************************************
* 기      능   : 저장 
********************************************************************************/
function fn_save() {
    // 이중 실행 방지(1일 경우 실행중)
	if (CHK != "0") return;

	// JQPR 입고예정일 미입력 개수 확인 임시 주석 200210
/*	if(ds_cnt.GetColumn(0, "CNT") > 0) {
		fn_afterChkJajae();
		return;
	}*/

	if ( gfn_isNull(cal_rdate_p, true) ) {
		gfn_showMsg("CW00001","납품예정일등록");
		return;
	}

    if ( !gfn_checkDate( gfn_getCurrDate(), cal_rdate_p, true, cal_rdate_p, "현재일","납품예정일등록") ) {
		return;
	}

	ds_list.fireevent = false;
	
	var err[2];	
	//  데이터 검증. - 2013.08.09 박찬욱 대리 요청으로 다시 적용
	for ( var i = 0; i < ds_sum.rowCount(); i++ ) {
		if( ds_sum.getColumn(i, "CHECK") == "1") {
			
			//미수금 현장은 작성 제한
			// 보수 자재의 경우 2000번 플랜트는 제한 제외 - 20130930 조요환과장 요청 HSS
			if (ds_sum.getColumn(i,"WERKS") != "2000" && ds_sum.getColumn(i,"BIGO") == "2")
			{
			   ds_list.fireevent = true;
			   gfn_showAlert("CW00071","미수현장 :"+ds_sum.GetColumn(i,"POST1"));
			   ds_list.SetColumn(i,"CHECK", "0");
			   return;
			}
			// 서면 발주의 경우 거래명세서 생성제한 2016.05.20 - JYW
			if (substr(ds_sum.GetColumn(i,"EKGRP2"),0,1) == "8")
			{
				ds_list.fireevent = true;
		    	gfn_showAlert("CW00071"," 구매그룹 :"+ds_sum.GetColumn(i,"EKGRP2"));
				return;
			}
			
		}
	}
	var knttp = "";
	var asset = "";
	var count = "";
	
	ds_list.Filter("CHECK == 1");
	//  데이터 검증.
		
	for ( var i = 0; i < ds_list.rowCount(); i++ ) {
		if( ds_list.getColumn(i, "CHECK") == "1") {
		
			if (length(knttp) == 0)
			{
				knttp = ds_list.getColumn(i,"KNTTP1");
			}
			if (toNumber(ds_list.getColumn(i,"MENGE")) <= 0)
			{
				var arr = ["납품수량은 0 이상의 값으로", "발주 잔량"];
				gfn_showAlert("CW00015",arr);
				ds_list.SetColumn(i, "FLAG", "");
				ds_list.SetColumn(i,"CHECK", "0");
				ds_list.fireevent = true;
				grd_sum_OnCellPosChanged(grd_sum,ds_sum.rowposition);
				return;
			}
			if (ds_list.getColumn(i,"PRO_F") == "0")
			{
			   gfn_showAlert("CW00088",quote(ds_list.getColumn(i,"MATNR")));
			   ds_list.SetColumn(i, "FLAG", "");
			   ds_list.SetColumn(i,"CHECK", "0");
			   ds_list.fireevent = true;
			   grd_sum_OnCellPosChanged(grd_sum,ds_sum.rowposition);
			   return;
			} 
			if (ds_list.GetColumn(i,"BIGO") == "1" 
			 && (substr(ds_list.GetColumn(i, "POSID"),6,2) != "NS" 
			 && substr(ds_list.GetColumn(i, "POSID"),6,2) != "NB")) {  // 조요환 과장 요청으로 NB,NS의 경우 통제 제외 2014.03.05
			    err[0] = grd_list.GetCellProp("head",3,"text");
			    err[1] = ds_list.GetColumn(i,"POSID");
			    ds_list.SetColumn(i,"CHECK", "0");
				gfn_showAlert("CW00184",err);
				ds_list.fireevent = true;
				grd_sum_OnCellPosChanged(grd_sum,ds_sum.rowposition);
				return;
			}		
			// 선택시 체크로 변경 2009.05.06
			// 2010.06.21 박찬욱 요청으로 TECO 제한 다시 로직 적용
			if (ds_list.GetColumn(i, "WERKS") == "1000"  && length(ds_list.GetColumn(i,"P_END")) > 0 
			    && (substr(ds_list.GetColumn(i, "POSID"),6,2) != "NS" && substr(ds_list.GetColumn(i, "POSID"),6,2) != "NB")) 
			 {  
			    // 조요환 과장 요청으로 NB,NS의 경우 통제 제외 2014.03.05
			    teco = [ds_list.GetColumn(i,"POSID"),ds_list.GetColumn(i,"P_END")];
				gfn_showAlert("CW00193", teco);
				ds_list.SetColumn(i,"CHECK", "0");
				ds_list.fireevent = true;
				grd_sum_OnCellPosChanged(grd_sum,ds_sum.rowposition);
				return;
			}		

			// 보수 비상통화장치 관련 자산 관리로  2000 번 플랜트의 자산의( knttp가 'F') 일반과 함께 발행 불가 2014.01.09 hss
            // 일반 자산/ 외주임가공 거래명세서 생성으로 범주별 거래명세서 생성 필수
			if (knttp != ds_list.getColumn(i,"KNTTP1"))  {
			    asset = [ds_list.GetColumn(i,"POSID"), "계정범주 불일치 (일반/투자자산/외주임가공 분리 작성 필수)"];
			    gfn_showAlert("CW00193", asset);
				grd_sum_OnCellPosChanged(grd_sum,ds_sum.rowposition);
				ds_list.fireevent = true;
				return;
			}	
			
			// 저장할 데이터셋 복사
			gfn_copyDS(ds_list,ds_temp,"CHECK == 1");				
			gfn_copyDS(ds_temp,ds_temp1,"POSID="+quote("STOCK"));	
							
			if(ds_temp.rowCount() != ds_temp1.rowCount() && ds_temp1.rowCount() != "0")
			{
				gfn_showAlert("CW10025", "STOCK과 PROJECT 자재는 분리하여 거래명세서 생성해야합니다.");
				//gfn_showAlert("STOCK과 PROJECT 자재는 분리하여 거래명세서 생성해야합니다");
				return;
			}
			
		}
	
	}
	ds_list.fireevent = true;


	// 저장할 데이터셋 복사
	gfn_copyDS(ds_list,ds_list_0, "CHECK=1");

	var kgubn = false;   // 일식외주 구분

	// 입력할 거래명세서에 납품예정일을 입력
	for ( var i = 0; i < ds_list_0.rowcount; i++ ) {
		// 일식외주는 일반 발주와 동시에 작성할수 없음. 2008.09.03
		if (ds_list_0.getColumn(i,"KNTTP") == "P")
		{
			kgubn = true;
		}
	}

	// 입력할 거래명세서에 납품예정일을 입력
	for ( var i = 0; i < ds_list_0.rowcount; i++ ) {
		// 일식외주는 일반 발주와 동시에 작성할수 없음. 2008.09.03
		if (kgubn && ds_list_0.getColumn(i,"KNTTP") != "P")
		{
			gfn_showAlert("CW00166");
			return;
		}

		// 일자 입력
		ds_list_0.SetColumn(i,"RDATE_P",cal_rdate_p.Value);
		ds_list_0.SetColumn(i,"FLAG","I");
	}

	if ( !gfn_isChangeDs(ds_list_0, true, "FLAG") ) {
		return;
	}

	// 하나의 거래명세서 item  제한 85개
	if (ds_list_0.rowcount > 85){
		gfn_showAlert("CW00087","85");
		return;
	}

	if (!gfn_showConfirm("CI00008")) {
		for ( var i = 0; i < ds_list.rowCount(); i++ ) {
	
			if( ds_list.getColumn(i, "FLAG") == "I") {
				ds_list.SetColumn(i,"FLAG","");
			}
		}		
		return;
	}
	// tit_showDs(ds_list_0);
	// return;
	tit_clearActionInfo();
	ds_key.ClearData();
	// 저장 처리 
	tit_addSearchActionInfo("mm03:MM0301002A_T1",true);

	tit_addSearchActionInfo("mm03:MM0301002A_S2",true);
	tit_addSaveActionInfo(
        "mm03:MM0301002A_I1"
        , ""
        , ""
        , "FLAG"
		,""
		, 0
		, "");

	// 이중 실행 방지(실행 시 1)
	CHK = "1";
	
	//   call 서비스에서 commit실행하여 commit 필요없음.

	tit_callService(
        ""
        , ""
        , "ds_list=ds_list_0:A ds_cond=ds_cond ds_key=ds_key"
        , "ds_key=ds_key"
        , ""
        , "fn_afterSave");
}
/********************************************************************************
* 기      능   : 닫기  
********************************************************************************/
function fn_close() {
	close();
}

/********************************************************************************
* 기      능   : 액셀  
********************************************************************************/
function fn_excel() {
	// Excel Export 
	ds_list.Filter("CHECK == 1");
	gfn_exportExcel(grd_list,G_USER_ID);
}

//=========================================================================================
// [ PART 4]
// Callback 함수 정의 : callback 함수명은 메인 함수의 fn_xxxx() 에서 xxxx 부분은 fn_afterXXXX()
// 형태가 되도록 작성 
//=========================================================================================

/********************************************************************************
* 기      능   : 조회 Callback  
********************************************************************************/
function fn_afterQuery(errCode, errMsg) {
	// 이중 실행 방지(실행 후 0으로)
    CHK = "0";
    
    // HTTP TIMEOUT 설정
    http.TimeOut = F_TIMEOUT;
    
    // 조회 결과가 있으면 엑셀 버튼 활성화
	if ( gfn_showSearchMsg(grd_sum) ) {
		ufn_enableBtn("excel", true);
		cal_rdate_p.Enable = true;
		if (length(ed_invnr.value) > 0) {
			btn_save.Enable = false;
		} else {
			btn_save.Enable = true;
		}
		fa_posid = "";
		fa_udate = "";
		fa_matnr = "";

	// 미수현장 조회 2010.07.08 - 2013.08.09 박찬욱 대리 요청으로 다시 적용
		var misu = "";
		var nRow = 0;

		for (var i = 0; i < ds_sum.RowCount(); i++) {
			
			if (ds_sum.GetColumn(i,"MISU_GUBN") == "Y")
			{

				nRow = gds_misu.searchRow("I_PSPID== " + quote(substr(ds_sum.GetColumn(i,"POSID"),0,6)));

				if ( nRow >= 0) {
					if(gds_misu.getColumn(nRow, "E_MISU") == "1") {
						ds_sum.SetColumn(i,"BIGO","2");
					}
				} 
				else{
					misu = gfn_getMisu(substr(ds_sum.GetColumn(i,"POSID"),0,6));
					
					if (misu == "1"){
						ds_sum.SetColumn(i,"BIGO","2");
					}
				}
			}
		}
		ds_sum.rowposition = 0;
		
	} else {
		ufn_enableBtn("excel", false);
		cal_rdate_p.Enable = false;
	}
}

/********************************************************************************
* 기      능   : 저장 Callback  
********************************************************************************/
function fn_afterSave(errCode, errMsg) {
	// 이중 실행 방지(실행 후 0으로)
    CHK = "0";
 
 	if ( errCode!= 0 ) {
		gfn_showMsg("CE00001");
		fn_query();
	} else {
	
		var vInvnr;
		vInvnr = ds_key.GetColumn(0,"INVNR");
		
		ds_condmts.ClearData();
		ds_condmts.AddRow();
		ds_condmts.SetColumn(0,"INVNR", vInvnr);
		
		//trace(ds_condmts.SaveXML());
		
					
		tit_clearActionInfo();
		tit_addSearchActionInfo("mm11:MM1102001A_S6"); // 입력된 거래명세서 번호 데이타 조회 

		tit_callService(
			""
			, ""
			, "ds_condmts=ds_condmts"
			, "ds_mts=ds_mts"
			, ""
			, "fn_afterSave2"
			, true);	
	}

}


function fn_afterSave2() {

	//trace(ds_mts.SaveXML());
		
		tit_callService(
			  "MM0301002B_ACT"
			, "query"
			, "ds_mts=ds_mts"
			, ""
			, ""
			, "fn_afterSave3"
			, true);
}
		

function fn_afterSave3() {
		gfn_showMsg("CI00016","거래명세서 " +quote(ds_key.GetColumn(0,"INVNR")));
		ed_invnr.value = ds_key.GetColumn(0,"INVNR");
		if (length(ed_invnr.value) > 0) {
			btn_save.Enable = false;			
			fn_query();
		}
}

/********************************************************************************
* 기      능   :  취소 Callback  
********************************************************************************/
function fn_afterCancel(errCode, errMsg) {
	// 이중 실행 방지(실행 후 0으로)
    CHK = "0";
 alert(CHK);
 	if ( errCode!= 0 ) {
		gfn_showMsg("CE00001");
	} else {
	
		trace(ds_list_0.SaveXML());
			ds_condmts2.ClearData();
			for (var i = 0; i <= ds_list.GetRowCount()-1; i++) {	
				ds_condmts2.AddRow();
				ds_condmts2.SetColumn(i, "INVNR", ds_list_0.GetColumn(i,"INVNR"));
				ds_condmts2.SetColumn(i, "INVITEM", ds_list_0.GetColumn(i,"INVITEM"));	
				ds_condmts2.SetColumn(i, "G_MANDT", G_MANDT);
			}
	
	trace(ds_condmts2.SaveXML());
	
	
	
			tit_callService(
			  "MM0301002B_ACT"
			, "query2"
			, "ds_condmts2=ds_condmts2"
			, ""
			, ""
			, "fn_afterCancel2"
			, true);			
	
	}
}

function fn_afterCancel2() {
	gfn_showMsg("CI00004");
	
			if (ed_invnr.value != "") {
				if (!gfn_showConfirm("CI00017")) {
					ed_invnr = "";
				}
			}
			fn_query();
}


//=========================================================================================
// [ PART 5 ]
// Detail Process Event 정의 ( User Define function )
// 사용자 정의 함수는 ufn_xxxx() 형태로 작성 
//=========================================================================================
/********************************************************************************
* 기      능   :  JQPR 입고예정일 미입력 시 팝업 
********************************************************************************/
function ufn_chkJajae() {
	tit_clearActionInfo();
	tit_addSearchActionInfo("mm03:MM0301001C_S7");
	tit_callService(
        ""
        , ""
        , ""
        , "ds_cnt=ds_cnt"
        , ""
        , ""
        , true);
}

function fn_afterChkJajae(errCode, errMsg) {
	if(ds_cnt.GetColumn(0, "CNT") > 0) {
		gfn_alert("JQPR ONE STOP PROCESS에 입고예정일이 미입력된 자재를 모두 입력하여야만 사용 가능합니다.");
	}
}

//=========================================================================================
// [ PART 6 ]
// component Event 정의 : 각 Component 별 이벤트 
//=========================================================================================

/********************************************************************************
* 기      능   : 그리드 헤더 클릭시 정렬 처리 
********************************************************************************/
function grd_list_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
{
	if ( nCell == 0 ) {
		// 그리드 표시할 컬럼 선택 
		gfn_selectGridCol(obj);
	}
	else {
		// 그리드 정렬 처리 
		gfn_sortGrid(obj,nCell);
	}
}

/********************************************************************************
* 기      능   : 그리드 자재번호 클릭시 자재상세 팝업 
********************************************************************************/
function grd_list_OnCellDBClik(obj,nRow,nCell){
   if (nCell == 12 || nCell == 13){
      gfn_openPopup("MM0901001A", true, "fa_matnr=" + quote(obj.GetCellValue(nRow,12)), 420, 529);
   }
}


/********************************************************************************
* 기      능   : 데이터셋 값 변경 시 - Flag 처리 
********************************************************************************/
function ds_list_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{ 
    // Message 영역 초기화
	global.FRM_BOTTOM.img_msgType.imageId = "";
	global.FRM_BOTTOM.st_msg.value = "";

	switch( strColumnID ) {
		case "FLAG":
			break; 
		case "CHECK":
					ds_list.FireEvent = false;
					if (ds_list.GetColumn(nRow, "FLAG") == "I" && ds_list.GetColumn(nRow,"CHECK") == "0") {
						ds_list.SetColumn(nRow,"FLAG","");
						ds_list.SetColumn(nRow,"CHECK","0");
						ds_list.SetColumn(nRow,"MENGE",ds_list.GetOrgColumn(nRow,"MENGE"));
						ds_list.FireEvent = true;
						return;
					} else if (ds_list.GetColumn(nRow,"CHECK") == "0") {
						if (ds_list.GetColumn(nRow, "FLAG") != "") {
							ds_list.SetColumn(nRow, "FLAG","");
						}
						ds_list.FireEvent = true;
						return;
					}
					if (length(ed_invnr.value) == 0 && ds_list.GetColumn(nRow,"WERKS") == "1000" && length(ds_list.GetColumn(nRow,"P_END")) > 0) {
						teco = [ds_list.GetColumn(nRow,"POSID"),ds_list.GetColumn(nRow,"P_END")];
						gfn_showAlert("CW00193",teco);
						ds_list.SetColumn(nRow,"CHECK", "0");
						ds_list.SetColumn(nRow,"FLAG","");
						ds_list.SetColumn(nRow,"MENGE",ds_list.GetOrgColumn(nRow,"MENGE"));
						ds_list.fireevent = true;
						return;
					} 

					ds_list.FireEvent = true;	        
	        break;
		case "MENGE":// 납품수량 
			obj.FireEvent = false;
		    var meval = toNumber(obj.GetColumn(nRow,"MENGE3")) - toNumber(obj.GetColumn(nRow,"MENGE1"));

			if ( ds_list.GetOrgColumn(nRow,"MENGE") == varNewValue ) {
    			obj.SetColumn(nRow, "FLAG", "");
    			obj.SetColumn(nRow,"CHECK", "0");
				obj.FireEvent = true;
				return;
			}
			else if ( toNumber(varNewValue) > toNumber(meval) || toNumber(varNewValue) <= 0)
			{
			   var arr = ["납품수량은 0 이상의 값으로", "발주 잔량"];
			   gfn_showAlert("CW00015",arr);
			   obj.SetColumn(nRow, "MENGE", obj.GetOrgBuffColumn(nRow,"MENGE"));
			   obj.SetColumn(nRow, "FLAG", "");
			   obj.SetColumn(nRow,"CHECK", "0");
	 		   obj.FireEvent = true;
			   return;
			}
			//자재 단위가 ST, EA 일때 소수점 입력 방지 조영욱 추가 2015.07.17
			else if ( ds_list.GetColumn(nRow, "MEINS") == "ST" || ds_list.GetColumn(nRow, "MEINS") == "EA" )
			{
				var a = ceil( ds_list.GetColumn(nRow,"MENGE"));
				var b = floor( ds_list.GetColumn(nRow,"MENGE"));
				
					if ( a <> b ) {	
					
						var arr2 = ["수량 단위가 ST, EA 일때 소수점 입력은"];
						gfn_showAlert("CW00114",arr2);
						obj.SetColumn(nRow, "MENGE", obj.GetOrgBuffColumn(nRow,"MENGE"));
						obj.SetColumn(nRow, "FLAG", "");
						obj.SetColumn(nRow,"CHECK", "0");
						obj.FireEvent = true;
						return;
					}
			}

			for (var i = 0; i < ds_list.GetRowCount(); i++) {
				if (ds_list.GetColumn(i, "FLAG") == "D") {
				    obj.SetColumn(nRow, "MENGE", toNumber(obj.GetOrgBuffColumn(nRow,"MENGE")));
					gfn_showAlert("CW00017");
					obj.FireEvent = true;
					return;
				}
			}
			obj.FireEvent = true;

			obj.SetColumn(nRow, "FLAG", "I");
			obj.SetColumn(nRow, "CHECK", "1");
    		break;
	}

	var size = 0;
	for (var i=0; i < ds_list.rowcount; i++){
		if(ds_list.getColumn(i,"CHECK") == "1") {
			size++;
		}
	}

	if (size > 0){
		bt_chjgeom.Enable = true;
	} else {
		bt_chjgeom.Enable = false;
	}	
}


/********************************************************************************
* 기      능   : 납품예정일 검사
********************************************************************************/

function ufn_checkDate(obj,strOldText,strNewText)
{
    if ( !gfn_checkDate( gfn_getCurrDate(), cal_rdate_p, true, cal_rdate_p, "현재일","납품예정일등록") ) {
		return;
	}
	
	if (gfn_getCurrDate() < cal_rdate_p.value){
		if (gfn_showConfirm("CI00028")) {
			//alert("입력한 납품예정일이 맞는지 한번 더 확인 부탁 드립니다");
			return;
		} else {
			cal_rdate_p.value = gfn_getCurrDate();
		}
	}
}

/********************************************************************************
* 기      능   : 거래명세서 내역 페이지로 이동
********************************************************************************/

function ufn_listGeoRae(obj)
{
	// 필수 입력 항목 체크 
	if ( gfn_isNull(cal_udate_fm, true) ) {
		gfn_showMsg("CW00001","납품예정일(시작)");
		return;
	}
	if ( gfn_isNull(cal_udate_to, true) ) {
		gfn_showMsg("CW00001","납품예정일(종료)");
		return;
	}
	
	if ( !gfn_checkDate( cal_udate_fm.value, cal_udate_to.value, true, cal_udate_to) ) {
		return;
	}

	var arg = "fa_rdate_p_fm=" + quote(cal_udate_fm.Value);
	arg += " fa_rdate_p_to=" + quote( cal_udate_to.Value) ;
	arg += " fa_werks=" + quote( cb_werks.Value );
	arg += " fa_ekgrp=" + quote( cb_ekgrp.Value );
	arg += " fa_posid1=" + quote( ed_posid1.Value );
	arg += " fa_posid2=" + quote( ed_posid2.Value );

   gfn_openWin("MM0301001C", arg);	
}

function gfn_goChulJang(obj)
{
	ds_list.fireevent = false;
	gfn_copyDS(ds_list,ds_list_0,"CHECK=1");
	
	if (ds_list_0.rowcount > 1){
		gfn_showAlert("CW00095");
		ds_list.fireevent = true;
		return;
	} 
	ds_list.fireevent = true;

	 if (ds_list_0.GetColumn(0,"KNTTP") == "P"){
		gfn_openWin("QM0301001A");
	 } else {
		gfn_openWin("QM0101002A");
	 }
}


function grd_sum_OnCellPosChanged(obj,nRow,nCell,nOldRow,nOldCell,nPivotIndex,nOldPivotIndex)
{ 
	ds_list.filter("POSID1 == " + quote( ds_sum.GetColumn(nRow,"POSID"))+"&&"+ 
				   "UDATE =="+ quote( ds_sum.GetColumn(nRow,"UDATE"))+"&&"+
				   "MATNR =="+ quote( ds_sum.GetColumn(nRow,"MATNR")));
}

function grd_sum_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
{
	if ( nCell == 0 ) {
		//  전체 선택 해제
		gfn_selectAllGrid(obj);
	} else {
		// 그리드 정렬 처리 
		gfn_sortGrid(obj,nCell);
	}	
}

function ds_sum_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{
	if ( strColumnID == "CHECK" ) {
		ds_list.fireevent = false;
		ds_list.UnFilter();
//		for (var i =0; i < ds_sum.rowcount; i++) {
			for (var j = 0 ; j < ds_list.rowcount; j++) {
				if (ds_list.GetColumn(j,"POSID1") == ds_sum.GetColumn(nRow,"POSID") &&
					ds_list.GetColumn(j,"UDATE") == ds_sum.GetColumn(nRow,"UDATE") &&
					ds_list.GetColumn(j,"MATNR") == ds_sum.GetColumn(nRow,"MATNR")) {
					if (ds_sum.GetColumn(nRow,"CHECK") == "1")
					{
						if (length(ed_invnr.value) == 0 && ds_list.GetColumn(j,"WERKS") == "1000" && length(ds_list.GetColumn(j,"P_END")) > 0) {
							teco = [ds_list.GetColumn(j,"POSID"),ds_list.GetColumn(j,"P_END")];
							ds_list.SetColumn(nRow,"CHECK", "0");
							ds_sum.SetColumn(nRow,"CHECK", "0");
							gfn_showAlert("CW00193",teco);
							alert(length(ed_invnr.value));
							return;
						} 
						else
						{
							ds_list.SetColumn(j,"CHECK", "1");
						}
						
					} 
					else 
					{
						ds_list.SetColumn(j,"CHECK", "0");
					}
				}
			}
//		}
		
		ds_list.filter("POSID1 == " + quote( ds_sum.GetColumn(ds_sum.rowposition,"POSID"))+"&&"+ 
					   "UDATE =="+ quote( ds_sum.GetColumn(ds_sum.rowposition,"UDATE"))+"&&"+
					   "MATNR =="+ quote( ds_sum.GetColumn(ds_sum.rowposition,"MATNR")));
		ds_list.fireevent = true;
	}	
}




function ch_knttp_OnClick(obj,strValue)
{
	cb_werks.Value = "2000";
	cb_lgort.Value = "9000";
}

/********************************************************************************
* 기      능   : 특정edit 입력 문자 검사
********************************************************************************/
function chk_edcode(str) {

	var pattern = "[^A-z0-9 ]+"; // 영문,숫자가 아닌 문자 filtering하는 정규식
	var reg = CreateRegExp(pattern, "g");
	var str_notnum = reg.Exec(str);
	
	if ( str_notnum.length >0) {
		// 영문,숫자가 아닌 문자 입력 불가
		return false;
	}
	return true;
}]]></Script>
</Window>