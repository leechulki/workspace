<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="562" Id="Scl0040" Left="8" OnLoadCompleted="fn_OnLoadCompleted" OnUnloadCompleted="fn_OnUnloadCompleted" PidAttrib="7" Title="프로젝트별&#32;수금대장" Top="8" Ver="1.0" Width="978" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_cond">
				<Contents>
					<colinfo id="FR_YMD" size="8" type="STRING"/>
					<colinfo id="TO_YMD" size="8" type="STRING"/>
					<colinfo id="FR_SO" size="10" type="STRING"/>
					<colinfo id="TO_SO" size="10" type="STRING"/>
					<colinfo id="FR_VB" size="4" type="STRING"/>
					<colinfo id="TO_VB" size="4" type="STRING"/>
					<colinfo id="FR_VG" size="3" type="STRING"/>
					<colinfo id="TO_VG" size="3" type="STRING"/>
					<colinfo id="SMAN" size="10" type="STRING"/>
					<colinfo id="BUYR" size="10" type="STRING"/>
					<colinfo id="AUART" size="4" type="STRING"/>
					<colinfo id="SPART" size="2" type="STRING"/>
					<colinfo id="STADA" size="8" type="STRING"/>
					<colinfo id="BSTNK" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list">
				<Contents>
					<colinfo id="AUART" size="1" type="STRING"/>
					<colinfo id="SPART" size="1" type="STRING"/>
					<colinfo id="VTWEG" size="1" type="STRING"/>
					<colinfo id="VKBURT" size="1" type="STRING"/>
					<colinfo id="VKBUR" size="1" type="STRING"/>
					<colinfo id="VKGRPT" size="1" type="STRING"/>
					<colinfo id="VKGRP" size="1" type="STRING"/>
					<colinfo id="VBELN" size="1" type="STRING"/>
					<colinfo id="ZMAN" size="1" type="STRING"/>
					<colinfo id="ZMANT" size="1" type="STRING"/>
					<colinfo id="ZZPJT_ID" size="1" type="STRING"/>
					<colinfo id="KUNNR" size="1" type="STRING"/>
					<colinfo id="KUNRZ1T" size="1" type="STRING"/>
					<colinfo id="BRAN1" size="1" type="STRING"/>
					<colinfo id="KUNNRT" size="1" type="STRING"/>
					<colinfo id="BSTDK" size="1" type="STRING"/>
					<colinfo id="BUILDUSE" size="1" type="STRING"/>
					<colinfo id="BUILDUSET" size="1" type="STRING"/>
					<colinfo id="BSTNK" size="1" type="STRING"/>
					<colinfo id="ADDR" size="1" type="STRING"/>
					<colinfo id="ENFOR" size="1" type="STRING"/>
					<colinfo id="ADMITNO" size="1" type="STRING"/>
					<colinfo id="NETWR" size="1" type="STRING"/>
					<colinfo id="WAVWR" size="1" type="STRING"/>
					<colinfo id="ZTERMT" size="1" type="STRING"/>
					<colinfo id="NETWR_U" size="1" type="STRING"/>
					<colinfo id="WAVWR_U" size="1" type="STRING"/>
					<colinfo id="WAERK_U" size="1" type="STRING"/>
					<colinfo id="NETWR_K" size="1" type="STRING"/>
					<colinfo id="WAVWR_K" size="1" type="STRING"/>
					<colinfo id="WAERK_K" size="1" type="STRING"/>
					<colinfo id="NOBILL2" size="1" type="STRING"/>
					<colinfo id="LIFNR" size="1" type="STRING"/>
					<colinfo id="LIFNR_NM" size="1" type="STRING"/>
					<colinfo id="ZQNTY" size="1" type="STRING"/>
					<colinfo id="LAND1" size="1" type="STRING"/>
					<colinfo id="LANDX" size="1" type="STRING"/>
					<colinfo id="RATE" size="1" type="STRING"/>
					<colinfo id="DEMAND_DA" size="1" type="STRING"/>
					<colinfo id="RECAD_DA" size="1" type="STRING"/>
					<colinfo id="CHADE_DA" size="1" type="STRING"/>
					<colinfo id="CHAAD_DA" size="1" type="STRING"/>
					<colinfo id="CHAAD_CNT" size="1" type="STRING"/>
					<colinfo id="AEDAT" size="1" type="STRING"/>
					<colinfo id="SEP_MON" size="1" type="STRING"/>
					<colinfo id="BILL" size="1" type="STRING"/>
					<colinfo id="SUGM" size="1" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_error">
				<Contents>
					<colinfo id="IDX" size="1" type="STRING"/>
					<colinfo id="ERRMSG" size="1" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_auart_cd">
				<Contents>
					<colinfo id="CODE" size="1" type="STRING"/>
					<colinfo id="CODE_NAME" size="1" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_spart_cd">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond_buyr_list">
				<Contents>
					<colinfo id="SIGN" size="1" type="STRING"/>
					<colinfo id="OPTION" size="2" type="STRING"/>
					<colinfo id="LOW" size="10" type="STRING"/>
					<colinfo id="HIGH" size="10" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond_so_list">
				<Contents>
					<colinfo id="SIGN" size="1" type="STRING"/>
					<colinfo id="OPTION" size="2" type="STRING"/>
					<colinfo id="LOW" size="10" type="STRING"/>
					<colinfo id="HIGH" size="10" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_days">
				<Contents>
					<colinfo id="DAYS" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
		</Datasets>
		<Grid AutoFitEndLine="Hide" BindDataset="ds_list" BkColor2="default" BoldHead="true" Border="Flat" Bottom="552" ColSizing="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="440" Id="grd_list" InputPanel="FALSE" Left="8" LineColor="user20" LineType="ExHORZ" OnCellDBLClick="grd_list_OnCellDblClick" OnHeadClick="grd_list_OnHeadClick" OnKeyDown="grd_list_OnKeyDown" Right="971" RowHeight="20" Style="sty_grid" TabOrder="9" TabStop="true" Top="112" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="963">
			<contents>
				<format id="Default">
					<columns>
						<col width="40"/>
						<col width="81"/>
						<col width="51"/>
						<col width="50"/>
						<col width="48"/>
						<col width="53"/>
						<col width="112"/>
						<col width="45"/>
						<col width="106"/>
						<col width="67"/>
						<col width="66"/>
						<col width="63"/>
						<col width="72"/>
						<col width="105"/>
						<col width="53"/>
						<col width="80"/>
						<col width="80"/>
						<col width="58"/>
						<col width="81"/>
						<col width="133"/>
						<col width="153"/>
						<col width="80"/>
						<col width="82"/>
						<col width="117"/>
						<col width="80"/>
						<col width="95"/>
						<col width="43"/>
						<col width="95"/>
						<col width="95"/>
						<col width="80"/>
						<col width="95"/>
						<col width="95"/>
						<col width="70"/>
						<col width="80"/>
						<col width="110"/>
						<col width="55"/>
						<col width="56"/>
						<col width="95"/>
						<col width="64"/>
						<col width="115"/>
						<col width="123"/>
						<col width="107"/>
						<col width="112"/>
						<col width="77"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="52"/>
						<col width="80"/>
						<col width="66"/>
					</columns>
					<head>
						<cell align="center" bkimageid="icon_grid_sel" col="0" color="user21" display="text" font="굴림,9"/>
						<cell align="center" col="1" color="user21" display="text" font="굴림,9" text="S/O번호"/>
						<cell align="center" col="2" color="user21" display="text" font="굴림,9" text="오더유형"/>
						<cell align="center" col="3" color="user21" display="text" font="굴림,9" text="유통경로"/>
						<cell align="center" col="4" color="user21" display="text" font="굴림,9" text="제품군"/>
						<cell align="center" col="5" color="user21" display="text" font="굴림,9" text="부서코드"/>
						<cell align="center" col="6" color="user21" display="text" font="굴림,9" text="부서명"/>
						<cell align="center" col="7" color="user21" display="text" font="굴림,9" text="팀코드"/>
						<cell align="center" col="8" color="user21" display="text" font="굴림,9" text="팀명"/>
						<cell align="center" col="9" color="user21" display="text" font="굴림,9" text="담당자코드"/>
						<cell align="center" col="10" color="user21" display="text" font="굴림,9" text="담당자명"/>
						<cell align="center" col="11" color="user21" display="text" font="굴림,9" text="프로젝트"/>
						<cell align="center" col="12" color="user21" display="text" font="굴림,9" text="거래선코드"/>
						<cell align="center" col="13" color="user21" display="text" font="굴림,9" text="거래선"/>
						<cell align="center" col="14" color="user21" display="text" font="굴림,9" text="신용등급"/>
						<cell align="center" col="15" color="user21" display="text" font="굴림,9" text="계약일"/>
						<cell align="center" col="16" color="user21" display="text" font="굴림,9" text="납기일"/>
						<cell align="center" col="17" color="user21" display="text" font="굴림,9" text="건물용도"/>
						<cell align="center" col="18" color="user21" display="text" font="굴림,9" text="내역"/>
						<cell align="center" col="19" color="user21" display="text" font="굴림,9" text="현장명"/>
						<cell align="center" col="20" color="user21" display="text" font="굴림,9" text="주소"/>
						<cell align="center" col="21" color="user21" display="text" font="굴림,9" text="시행사"/>
						<cell align="center" col="22" color="user21" display="text" font="굴림,9" text="수주승인번호"/>
						<cell align="center" col="23" color="user21" display="text" font="굴림,9" text="수주금액(VAT제외)"/>
						<cell align="center" col="24" color="user21" display="text" font="굴림,9" text="수주일"/>
						<cell align="center" col="25" color="user21" display="text" font="굴림,9" text="원가"/>
						<cell align="center" col="26" color="user21" display="text" font="굴림,9" text="통화"/>
						<cell align="center" col="27" color="user21" display="text" font="굴림,9" text="달러환산액"/>
						<cell align="center" col="28" color="user21" display="text" font="굴림,9" text="달러환산원가"/>
						<cell align="center" col="29" color="user21" display="text" font="굴림,9" text="달러화키"/>
						<cell align="center" col="30" color="user21" display="text" font="굴림,9" text="원화환산액"/>
						<cell align="center" col="31" color="user21" display="text" font="굴림,9" text="원화환산원가"/>
						<cell align="center" col="32" color="user21" display="text" font="굴림,9" text="원화키"/>
						<cell align="center" col="33" color="user21" display="text" font="굴림,9" text="협력업체코드"/>
						<cell align="center" col="34" color="user21" display="text" font="굴림,9" text="협력업체명"/>
						<cell align="center" col="35" color="user21" display="text" font="굴림,9" text="대수"/>
						<cell align="center" col="36" color="user21" display="text" font="굴림,9" text="국가코드"/>
						<cell align="center" col="37" color="user21" display="text" font="굴림,9" text="국가명"/>
						<cell align="center" col="38" color="user21" display="text" font="굴림,9" text="공정율(%)"/>
						<cell align="center" col="39" color="user21" display="text" font="굴림,9" text="청구금액(VAT제외)"/>
						<cell align="center" col="40" color="user21" display="text" font="굴림,9" text="미청구금액(VAT제외)"/>
						<cell align="center" col="41" color="user21" display="text" font="굴림,9" text="수금액(VAT제외)"/>
						<cell align="center" col="42" color="user21" display="text" font="굴림,9" text="미수금액(VAT제외)"/>
						<cell align="center" col="43" color="user21" display="text" font="굴림,9" text="승인요청일"/>
						<cell align="center" col="44" color="user21" display="text" font="굴림,9" text="승인일"/>
						<cell align="center" col="45" color="user21" display="text" font="굴림,9" text="변경요청일"/>
						<cell align="center" col="46" color="user21" display="text" font="굴림,9" text="변경승인일"/>
						<cell align="center" col="47" color="user21" display="text" font="굴림,9" text="변경차수"/>
						<cell align="center" col="48" color="user21" display="text" font="굴림,9" text="변경일"/>
						<cell align="center" col="49" color="user21" display="text" font="굴림,9" text="분할개월수"/>
					</head>
					<body>
						<cell align="center" col="0" expr="currow+1"/>
						<cell align="center" bkcolor2="user22" col="1" colid="VBELN" display="text"/>
						<cell align="center" bkcolor2="user22" col="2" colid="AUART" display="text"/>
						<cell align="center" bkcolor2="user22" col="3" colid="VTWEG" display="text"/>
						<cell align="center" bkcolor2="user22" col="4" colid="SPART" display="text" expr="gfn_GetListCodeName(F_FORM_ID,GC_CDGB_SPART,&#32;SPART)"/>
						<cell align="center" bkcolor2="user22" col="5" colid="VKBUR" display="text"/>
						<cell align="left" bkcolor2="user22" col="6" colid="VKBURT" display="text"/>
						<cell align="center" bkcolor2="user22" col="7" colid="VKGRP" display="text"/>
						<cell align="left" bkcolor2="user22" col="8" colid="VKGRPT" display="text"/>
						<cell align="center" bkcolor2="user22" col="9" colid="ZMAN" display="text"/>
						<cell align="center" bkcolor2="user22" col="10" colid="ZMANT" display="text"/>
						<cell align="center" bkcolor2="user22" col="11" colid="ZZPJT_ID" display="text"/>
						<cell align="center" bkcolor2="user22" col="12" colid="KUNNR" display="text"/>
						<cell align="left" bkcolor2="user22" col="13" colid="KUNNRT" display="text"/>
						<cell align="center" bkcolor2="user22" col="14" colid="BRAN1" display="text"/>
						<cell align="center" bkcolor2="user22" col="15" colid="CONTR_DA" display="text" expr="gfn_getChkDate(F_FORM_ID,&#32;CONTR_DA)" Mask="expr:gfn_getMaskDate(F_FORM_ID)"/>
						<cell align="center" bkcolor2="user22" col="16" colid="VDATU" display="text" expr="gfn_getChkDate(F_FORM_ID,&#32;&#32;VDATU)" Mask="expr:gfn_getMaskDate(F_FORM_ID)"/>
						<cell align="center" bkcolor2="user22" col="17" colid="BUILDUSE" display="text"/>
						<cell align="left" bkcolor2="user22" col="18" colid="BUILDUSET" display="text"/>
						<cell align="left" bkcolor2="user22" col="19" colid="BSTNK" display="text"/>
						<cell align="left" bkcolor2="user22" col="20" colid="ADDR" display="text"/>
						<cell align="left" bkcolor2="user22" col="21" colid="ENFOR" display="text"/>
						<cell align="center" bkcolor2="user22" col="22" colid="ADMITNO" display="text"/>
						<cell align="right" bkcolor2="user22" col="23" colid="NETWR" display="number"/>
						<cell align="center" bkcolor2="user22" col="24" colid="BSTDK" display="text" expr="gfn_getChkDate(F_FORM_ID,&#32;BSTDK)" Mask="expr:gfn_getMaskDate(F_FORM_ID)"/>
						<cell align="right" bkcolor2="user22" col="25" colid="WAVWR" display="number"/>
						<cell align="center" bkcolor2="user22" col="26" colid="WAERK" display="text"/>
						<cell align="right" bkcolor2="user22" col="27" colid="NETWR_U" display="number"/>
						<cell align="right" bkcolor2="user22" col="28" colid="WAVWR_U" display="number"/>
						<cell align="center" bkcolor2="user22" col="29" colid="WAERK_U" display="text"/>
						<cell align="right" bkcolor2="user22" col="30" colid="NETWR_K" display="number"/>
						<cell align="right" bkcolor2="user22" col="31" colid="WAVWR_K" display="number"/>
						<cell align="center" bkcolor2="user22" col="32" colid="WAERK_K" display="text"/>
						<cell align="center" bkcolor2="user22" col="33" colid="LIFNR" display="text"/>
						<cell align="left" bkcolor2="user22" col="34" colid="LIFNR_NM" display="text"/>
						<cell align="right" bkcolor2="user22" col="35" colid="ZQNTY" display="number"/>
						<cell align="center" bkcolor2="user22" col="36" colid="LAND1" display="text"/>
						<cell align="left" bkcolor2="user22" col="37" colid="LANDX" display="text"/>
						<cell align="right" bkcolor2="user22" col="38" colid="RATE" display="number" LimitDec="2"/>
						<cell align="right" bkcolor2="user22" col="39" colid="BILL" display="number"/>
						<cell align="right" bkcolor2="user22" col="40" display="number" expr="NETWR&#32;-&#32;BILL"/>
						<cell align="right" bkcolor2="user22" col="41" colid="SUGM" display="number"/>
						<cell align="right" bkcolor2="user22" col="42" display="number" expr="NETWR&#32;-&#32;SUGM"/>
						<cell align="center" bkcolor2="user22" col="43" colid="DEMAND_DA" display="text" expr="gfn_getChkDate(F_FORM_ID,&#32;DEMAND_DA)" Mask="expr:gfn_getMaskDate(F_FORM_ID)"/>
						<cell align="center" bkcolor2="user22" col="44" colid="RECAD_DA" display="text" expr="gfn_getChkDate(F_FORM_ID,&#32;RECAD_DA)" Mask="expr:gfn_getMaskDate(F_FORM_ID)"/>
						<cell align="center" bkcolor2="user22" col="45" colid="CHADE_DA" display="text" expr="gfn_getChkDate(F_FORM_ID,&#32;CHADE_DA)" Mask="expr:gfn_getMaskDate(F_FORM_ID)"/>
						<cell align="center" bkcolor2="user22" col="46" colid="CHAAD_DA" display="text" expr="gfn_getChkDate(F_FORM_ID,&#32;CHAAD_DA)" Mask="expr:gfn_getMaskDate(F_FORM_ID)"/>
						<cell align="right" bkcolor2="user22" col="47" colid="CHAAD_CNT" display="number"/>
						<cell align="center" bkcolor2="user22" col="48" colid="AEDAT" display="text" expr="gfn_getChkDate(F_FORM_ID,&#32;AEDAT)" Mask="expr:gfn_getMaskDate(F_FORM_ID)"/>
						<cell align="right" bkcolor2="user22" col="49" colid="SEP_MON" display="number"/>
					</body>
					<summary>
						<cell bkcolor="user25" col="0" color="user26" display="text">
							<cell align="center" col="0" color="user26" colspan="4" display="text" text="합계"/>
						</cell>
						<cell align="right" bkcolor="user25" col="1" color="user26" display="text"/>
						<cell align="right" bkcolor="user25" col="2" color="user26" display="text"/>
						<cell align="right" bkcolor="user25" col="3" color="user26" display="text"/>
						<cell align="right" bkcolor="user25" col="4" color="user26" display="text"/>
						<cell align="right" bkcolor="user25" col="5" color="user26" display="text"/>
						<cell align="right" bkcolor="user25" col="6" color="user26" display="text"/>
						<cell align="right" bkcolor="user25" col="7" color="user26" display="text"/>
						<cell align="right" bkcolor="user25" col="8" color="user26" display="text"/>
						<cell align="right" bkcolor="user25" col="9" color="user26" display="text"/>
						<cell align="right" bkcolor="user25" col="10" color="user26" display="text"/>
						<cell align="right" bkcolor="user25" col="11" color="user26" display="text"/>
						<cell align="right" bkcolor="user25" col="12" color="user26" display="text"/>
						<cell align="right" bkcolor="user25" col="13" color="user26" display="text"/>
						<cell align="right" bkcolor="user25" col="14" color="user26" display="text"/>
						<cell align="right" bkcolor="user25" col="15" color="user26" display="text"/>
						<cell align="right" bkcolor="user25" col="16" color="user26" display="text"/>
						<cell align="right" bkcolor="user25" col="17" color="user26" display="text"/>
						<cell align="right" bkcolor="user25" col="18" color="user26" display="text"/>
						<cell align="right" bkcolor="user25" col="19" color="user26" display="text"/>
						<cell align="right" bkcolor="user25" col="20" color="user26" display="text"/>
						<cell align="right" bkcolor="user25" col="21" color="user26" display="text"/>
						<cell align="right" bkcolor="user25" col="22" color="user26" display="text"/>
						<cell align="right" bkcolor="user25" col="23" color="user26" display="number" expr='sum(&quot;NETWR&quot;)'/>
						<cell align="right" bkcolor="user25" col="24" color="user26" display="text"/>
						<cell align="right" bkcolor="user25" col="25" color="user26" display="number" expr='sum(&quot;WAVWR&quot;)'/>
						<cell align="right" bkcolor="user25" col="26" color="user26" display="text"/>
						<cell align="right" bkcolor="user25" col="27" color="user26" display="number" expr='sum(&quot;NETWR_U&quot;)'/>
						<cell align="right" bkcolor="user25" col="28" color="user26" display="number" expr='sum(&quot;WAVWR_U&quot;)'/>
						<cell align="right" bkcolor="user25" col="29" color="user26" display="text"/>
						<cell align="right" bkcolor="user25" col="30" color="user26" display="number" expr='sum(&quot;NETWR_K&quot;)'/>
						<cell align="right" bkcolor="user25" col="31" color="user26" display="number" expr='sum(&quot;WAVWR_K&quot;)'/>
						<cell align="right" bkcolor="user25" col="32" color="user26" display="text"/>
						<cell align="right" bkcolor="user25" col="33" color="user26" display="text"/>
						<cell align="right" bkcolor="user25" col="34" color="user26" display="text"/>
						<cell align="right" bkcolor="user25" col="35" color="user26" display="number" expr='sum(&quot;ZQNTY&quot;)'/>
						<cell align="right" bkcolor="user25" col="36" color="user26" display="text"/>
						<cell align="right" bkcolor="user25" col="37" color="user26" display="text"/>
						<cell align="right" bkcolor="user25" col="38" color="user26" display="text"/>
						<cell align="right" bkcolor="user25" col="39" color="user26" display="number" expr='sum(&quot;BILL&quot;)'/>
						<cell align="right" bkcolor="user25" col="40" color="user26" display="number" expr='sum(&quot;NETWR&quot;)&#32;-&#32;sum(&quot;BILL&quot;)'/>
						<cell align="right" bkcolor="user25" col="41" color="user26" display="number" expr='sum(&quot;SUGM&quot;)'/>
						<cell align="right" bkcolor="user25" col="42" color="user26" display="number" expr='sum(&quot;NETWR&quot;)&#32;-&#32;sum(&quot;SUGM&quot;)'/>
						<cell align="right" bkcolor="user25" col="43" color="user26" display="text"/>
						<cell align="right" bkcolor="user25" col="44" color="user26" display="text"/>
						<cell align="right" bkcolor="user25" col="45" color="user26" display="text"/>
						<cell align="right" bkcolor="user25" col="46" color="user26" display="text"/>
						<cell align="right" bkcolor="user25" col="47" color="user26" display="number" expr='sum(&quot;CHAAD_CNT&quot;)'/>
						<cell align="right" bkcolor="user25" col="48" color="user26" display="text"/>
						<cell align="right" bkcolor="user25" col="49" color="user26" display="number" expr='sum(&quot;SEP_MON&quot;)'/>
					</summary>
				</format>
			</contents>
		</Grid>
		<Shape BKColor="user0" Bottom="75" Height="75" Id="Shape1" Left="0" LineColor="user1" Right="978" TabOrder="0" Top="0" Type="Rectangle" Width="978"></Shape>
		<Combo Border="Flat" CodeColumn="CODE" DataColumn="CODE_NAME" Height="20" Id="cb_auart" InnerDataset="ds_auart_cd" Left="378" Style="sty_ipt_search" TabOrder="6" Top="48" Width="77"></Combo>
		<Calendar Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_fr_ymd" Left="87" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_search_ind" SundayTextColor="user35" TabOrder="0" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="5" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="85"></Calendar>
		<Calendar Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_to_ymd" Left="189" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_search_ind" SundayTextColor="user35" TabOrder="1" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="6" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="85"></Calendar>
		<Calendar Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_stada" Left="87" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_search" SundayTextColor="user35" TabOrder="3" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="49" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="85"></Calendar>
		<Static Align="Right" Height="20" Id="st_i_ymd" Left="5" Style="sty_lb_search" TabOrder="0" Text="수주기간&#32;" Top="5" VAlign="Middle" Width="80"></Static>
		<Static Align="Right" Height="20" Id="st_i_auart" Left="297" Style="sty_lb_search" TabOrder="0" Text="오더유형&#32;" Top="49" VAlign="Middle" Width="80"></Static>
		<Static Align="Right" Height="20" Id="st_i_stada" Left="5" Style="sty_lb_search" TabOrder="0" Text="수금기준일자&#32;" Top="49" VAlign="Middle" Width="80"></Static>
		<Static Align="Center" Border="None" Color="user7" Font="굴림,9" Height="20" Id="Static13" Left="173" TabOrder="0" Text="~" Top="6" VAlign="Middle" Width="15"></Static>
		<Static Align="Right" Height="20" Id="st_i_so" Left="5" Style="sty_lb_search" TabOrder="0" Text="S/O&#32;" Top="27" VAlign="Middle" Width="80"></Static>
		<Static Align="Right" Height="20" Id="st_i_spart" Left="456" Style="sty_lb_search" TabOrder="0" Text="제품군&#32;" Top="48" VAlign="Middle" Width="80"></Static>
		<Static Align="Right" Height="20" Id="Static5" Left="297" Style="sty_lb_search" TabOrder="11" Text="현장명&#32;" Top="27" VAlign="Middle" Width="80"></Static>
		<Edit Border="Flat" CheckLength="Byte" Height="20" Id="ed_bstnk" ImeMode="none" Left="379" LeftMargin="4" MaxLength="30" RightMargin="4" Style="sty_ipt_search" TabOrder="5" Top="27" Width="226"></Edit>
		<Combo Border="Flat" CodeColumn="CODE" DataColumn="CODE_NAME" Height="20" Id="cb_spart" InnerDataset="ds_spart_cd" Left="536" Style="sty_ipt_form" TabOrder="7" Top="48" Width="70"></Combo>
		<Div BKColor="user0" Height="22" Id="div_sman" Left="691" OnLoadCompleted="fn_OnLoadCompleted" TabOrder="10" Text="Div0" Top="49" Url="COM::Coms002.xml" Width="222">
			<Contents></Contents>
		</Div>
		<Static Align="Right" Height="20" Id="Static0" Left="297" Style="sty_lb_search" TabOrder="20" Text="거래선&#32;" Top="5" VAlign="Middle" Width="80"></Static>
		<Static Align="Right" Height="20" Id="Static1" Left="608" Style="sty_lb_search" TabOrder="21" Text="담당자&#32;" Top="49" VAlign="Middle" Width="80"></Static>
		<Static Align="Right" Height="20" Id="Static4" Left="608" Style="sty_lb_search" TabOrder="23" Text="팀&#32;" Top="27" VAlign="Middle" Width="80"></Static>
		<Static Align="Right" Height="20" Id="Static3" Left="608" Style="sty_lb_search" TabOrder="22" Text="부서&#32;" Top="5" VAlign="Middle" Width="80"></Static>
		<Div BKColor="user0" Height="44" Id="div_vbvg" Left="690" OnLoadCompleted="fn_OnLoadCompleted" OnTimer="WB0199010A_OnTimer" TabOrder="8" Text="Div0" Top="3" Url="COM::Coms001.xml" Width="282">
			<Contents></Contents>
		</Div>
		<Div BKColor="user0" Border="Flat" Height="22" Id="div_sales" Left="87" OnLoadCompleted="fn_OnLoadCompleted" TabOrder="2" Text="Div0" Top="27" Url="COM::Coms008.xml" Width="209">
			<Contents></Contents>
		</Div>
		<Div BKColor="user0" Height="22" Id="div_buyr" Left="379" OnLoadCompleted="fn_OnLoadCompleted" TabOrder="4" Text="Div0" Top="5" Url="COM::Coms009.xml" Width="223">
			<Contents></Contents>
		</Div>
		<Button Height="20" Id="btn_scl0041" Left="8" OnClick="btn_scl0041_OnClick" TabOrder="24" Text="수금관리대장&#32;상세" Top="88" Width="122"></Button>
		<Button Appearance="FLAT" ButtonStyle="TRUE" Color="user5" Cursor="HAND" DomainID="btn.query" Height="22" Id="btn_query" ImageID="btn_comm_query_k" Left="821" LeftMargin="20" OnClick="fn_OnClick_btn" TabOrder="25" Text="조회" Top="84" Visible="FALSE" Width="52"></Button>
		<Button Appearance="FLAT" ButtonStyle="TRUE" Color="user5" Cursor="HAND" DomainID="btn.excel" Height="22" Id="btn_excel" ImageID="btn_comm_excel_k" Left="872" LeftMargin="20" OnClick="fn_OnClick_btn" TabOrder="27" Text="엑셀" Top="84" Visible="FALSE" Width="52"></Button>
		<Button Appearance="FLAT" ButtonStyle="TRUE" Color="user5" Cursor="HAND" DomainID="btn.close" Height="22" Id="btn_close" ImageID="btn_comm_close_k" Left="921" LeftMargin="20" OnClick="fn_OnClick_btn" TabOrder="26" Text="닫기" Top="84" Visible="FALSE" Width="52"></Button>
	</Form>
	<Script><![CDATA[/*
 ******************************************************************************************
 * 기      능   : 프로젝트별 수금현황(Scl0040)
 * 작  성  자   : 구란이
 * 작성  일자   : 2012.05.09
 * ----------------------------------------------------------------------------------------
 * HISTORY    : V1.0 : 2012.09.03 : 신규
 * COMMENT
   0. T-CODE                : ZSDR117 
   1. RFC URL 				: http://elsdev.hyundaielevator.co.kr:8000/sap/bc/srt/wsdl/bndg_4FA8CB6DB8C3013FE1008000CBF22518/wsdl11/allinone/ws_policy/document?sap-client=910
   2. RFC OPERATION NAME 	: ZWEB_SD_PROJECT
   3. RFC OBJ NAME 			: ZSDS_PJT
   4. 개발자료 : 2008년 3월 1일 자료로 테스트 가능
 ******************************************************************************************
*/
#include "LIB::commons.js";	// 공통 스크립트 
#include "LIB::nsfRequest.js";	// 공통 스크립트  /* GNY 추가 */
#include "LIB::common_hdel.js";	// 공통 스크립트  /* GNY 추가 */

//=========================================================================================
// [ PART 1 ]
// Form에서 사용될 전역변수를 선언
// FORM에서 사용되는 전역변수는 대문자로 작성하며, F_XXX 의 형태를 갖도록 한다. 
//=========================================================================================
var F_FORM_ID = "Scl0040";

// 서브화면 조정 필요시 값 입력, 불필요 시 "" 
// var F_BUYR_WIDTH 	= "";  	// 거래선코드 서브화면 폼 WIDTH
// var F_BUYR_CD_WIDTH	= "";  	// 거래선코드 서브화면 코드 WIDTH
// var F_BUYR_NM_WIDTH	= "";  	// 거래선코드 서브화면 코드명 WIDTH 
// var F_SMAN_WIDTH 	= "";  	// 담당자코드 서브화면 폼 WIDTH
// var F_SMAN_CD_WIDTH	= "";  	// 담당자코드 서브화면 코드 WIDTH
// var F_SMAN_NM_WIDTH	= "";  	// 담당자코드 서브화면 코드명 WIDTH 
// var F_VBVG_WIDTH 	= "";  	// 부서/팀코드 서브화면 폼 WIDTH
// var F_VBVG_VB_WIDTH	= "";  	// 부서/팀코드 서브화면 부서코드 WIDTH
// var F_VBVG_VG_WIDTH	= "";  	// 부서/팀코드 서브화면 팀코드 WIDTH
// var F_FRVB_ESSN_YN  = "";	// 시작부서코드 필수여부
// var F_TOVB_ESSN_YN  = "";	// 종료부서코드 필수여부
// var F_TOVB_HIDDEN_YN = "";	// 종료부서코드 숨김 여부

//=========================================================================================
// [ PART 2 ]
// Form Loading / Unloading 시 작업 정의
//=========================================================================================
function fn_OnLoadCompleted(obj) {
	
	gfn_initForm(true);  
	
	// DIVISION 사이즈 조정
	//FromEditSize, ToStaticStartWidth, ToStaticNm, ToStaticSize, ToEditStartWidth, ToEditSize, flag
	div_sales.fn_reSize	(85, "1", "~", 15, "1", 85, ''	);  // SO 사이즈 조정	(FROM, TO 모두 처리)
	div_buyr.fn_reSize	(84, "1", "~", 15, "1", 84, '1'	);  // 거래선 사이즈 조정 (FROM만 처리)  
	
	/* list 코드 LOAD */ 
	gfn_SetListCode(F_FORM_ID, GC_CDGB_SPART, ds_spart_cd, cb_spart, 0, "Y", "N");  	// 제품군   
 	
	// 오더유형 콤보목록 조회
	nsfRequest("query", "combo/comboAuart"	, "ds_auart_cd=ds_auart_cd"
											, "ds_auart_cd=ds_auart_cd ds_error=ds_error"
											, ""
											, "fn_afterQuery_auart"); 
	 
	// 폼 초기화
	fn_init_form();
}

/********************************************************************************
* 기      능   : 공통코드가 조회된 후의 Callback 함수 (common.js에서 호출됨)
********************************************************************************/
function fn_completeInit(sCode, sDsObj, sCodeType) {
	gfn_showMsg("CI00007"); 
	cb_auart.Index = 0;
}

/********************************************************************************
* 기      능   : form UnloadCompleted 
********************************************************************************/
function fn_OnUnloadCompleted(obj) {
	return gfn_isFormUnload(obj);
}
 
//=========================================================================================
// [ PART 3 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,form닫기)
//=========================================================================================
/********************************************************************************
* 기      능   : 조회 1
********************************************************************************/
var fn_query_chk = false; //중복조회 방지용 flag

function fn_query() { 
	
	trace("fn_query()호출 start");
	
	var arr = ['수주기간', '12'];
	if(gfn_getDayCnt(ds_days, cal_fr_ymd.Value, cal_to_ymd.Value) > 365) {
		gfn_showAlert("CW10087", arr);
		cal_fr_ymd.SetFocus();
		return false;
	}
	
	gfn_clearMsgBar();
	var user_grp = gfn_getUserGroup(); 
	
	// sort mark 삭제 
	gfn_clearGridSortMark(grd_list); 
	
	// 조회조건 항목오류검증
	if (fn_valid_chk("query") == false)  return;
	
	// 조회조건 설정
	ds_cond.ClearData();
	ds_cond_so_list.ClearData();
	ds_cond_buyr_list.ClearData();
	if (fn_param_set("query") == false)  return; 

	// trace(ds_cond.SaveXML());
	// trace(ds_cond_so_list.SaveXML());
	// trace(ds_cond_buyr_list.SaveXML());   

	if(!fn_query_chk) {
		fn_query_chk = true;
	} else {
		gfn_showAlert("CW10025", "조회중입니다..");
		return;
	}
	// 서비스 호출  
	fn_createWait("",this);     // 처리중입니다. 메시지 처리
	ds_list.ClearData();  	
	ds_error.ClearData();  	
	nsfRequest("query"															// srvId
				, "scl0040/find"												// url
				, "ds_cond=ds_cond" + " ds_cond_so_list=ds_cond_so_list"
				                   	+ " ds_cond_buyr_list=ds_cond_buyr_list" 	// inDsList
				, "ds_list=ds_list ds_error=ds_error"							// outDsList
				, ""															// strParam
				, "fn_afterQuery"												// CallBackFunc
				);
 
}

// 오더유형 조회
function fn_query_auart() { 
	
	// 오더유형 콤보목록 조회
	nsfRequest("query", "combo/comboAuart"	, "ds_auart_cd=ds_auart_cd"
											, "ds_auart_cd=ds_auart_cd ds_error=ds_error"
											, ""
											, "fn_afterQuery_auart"); 

 
}

// INPUT PARAM SET
// pProcGb : 처리구분 (query:조회)
function fn_param_set(pProcGb)
{  
	
	switch(pProcGb)
	{
		case "query" :  // 조회 시
			 
			ds_cond.AddRow();  
			 
			ds_cond.SetColumn(0, "FR_YMD"	, replace(trim(cal_fr_ymd.text),".","")	); 	// 수주일  
			ds_cond.SetColumn(0, "TO_YMD"	, replace(trim(cal_to_ymd.text),".","")	);  // 수주일  
			ds_cond.SetColumn(0, "FR_SO"	, ""									);  // S/O_FR   
			ds_cond.SetColumn(0, "TO_SO"	, ""									);  // S/O_TO
			ds_cond.SetColumn(0, "FR_VB"	, trim(div_vbvg.cb_frvb.Value)			);  // 부서코드_FR
			ds_cond.SetColumn(0, "TO_VB"	, trim(div_vbvg.cb_tovb.Value)			);  // 부서코드_TO
			ds_cond.SetColumn(0, "FR_VG"	, trim(div_vbvg.cb_frvg.Value)			);  // 팀코드_FR  
			ds_cond.SetColumn(0, "TO_VG"	, trim(div_vbvg.cb_tovg.Value)			);  // 팀코드_TO  
			ds_cond.SetColumn(0, "SMAN"	  	, trim(div_sman.ed_sman_cd.text)		);  // 담당자  
			ds_cond.SetColumn(0, "BUYR"		, ""									);  // 거래선  
			ds_cond.SetColumn(0, "AUART"	, trim(cb_auart.value)					);  // 오더유형
			ds_cond.SetColumn(0, "SPART"	, trim(cb_spart.value)					);  // 제품군  
			ds_cond.SetColumn(0, "STADA"	, replace(trim(cal_stada.text),".","")	);  // 기준일    
			ds_cond.SetColumn(0, "BSTNK"	, trim(ed_bstnk.text)					);  // 현장명 
			 
			// SubForm 데이타셋을 Copy해옴  : 빈행제외
			gfn_copyDs(div_sales.Ds_rtn, ds_cond_so_list, GC_SO_FILTER_COND); 		// so 범위조건
							 		
			gfn_copyDs(div_buyr.Ds_rtn, ds_cond_buyr_list, GC_BUYR_FILTER_COND); 	// 거래선 범위조건
			// gfn_copyDsRtn(div_sales.Ds_rtn			
							// , ds_cond_so_list			
							// , GC_SO_FILTER_COND
							// , div_sales.ed_fromEdit.text
							// , div_sales.ed_toEdit.text
							// )	; 	// so 범위조건
							 		
			// gfn_copyDsRtn(div_buyr.Ds_rtn	
							// , ds_cond_buyr_list	
							// , GC_BUYR_FILTER_COND
							// , div_buyr.fr_ed_buyr_cd.text
							// , ""
							// )	; 	// 거래선 범위조건
	 
			break;  
			
		default: 
			break; 
	}   

	return true;
	
}
/********************************************************************************
* 기      능   : 닫기  
********************************************************************************/
function fn_close() {
	close();
}

/********************************************************************************
* 기      능   : 액셀  
********************************************************************************/
function fn_excel() {
	
	// trace("fn_excel()호출 start");
 
	// 조회조건 항목오류검증
	if (fn_valid_chk("excel") == false)  return; 
	
	// Excel Export 
	gfn_exportExcel(grd_list, "프로젝트별 수금현황");
	//gfn_saveToExcel(grd_list, true);
	
}

//=========================================================================================
// [ PART 4]
// Callback 함수 정의 : callback 함수명은 메인 함수의 fn_xxxx() 에서 xxxx 부분은 fn_afterXXXX()
// 형태가 되도록 작성 
//=========================================================================================
/********************************************************************************
* 기      능   : 조회 Callback  
********************************************************************************/
function fn_afterQuery(errCode, errMsg) { 

	fn_query_chk = false; //중복조회 방지용 flag
	fn_destroyWait();

	// trace("fn_afterQuery 호출 start"); 
	// trace(ds_error.SaveXML());
	// trace(ds_list.SaveXML()); 
	
	if(ds_error.RowCount() > 0) 	// 조회실패
	{ 
		gfn_showMsgBar(ds_error.GetColumn(0,"ERRMSG"));   
	} 
	else 
	{ 
		// 조회된 자료가 있을 경우 
		if (ds_list.RowCount() > 0) 
		{ 
			grd_list.SetFocus();  						 // 그리드 첫번째 행에 포커스 위치시킨다.
			gfn_showMsg("CI00002", ds_list.RowCount()+"");  // CI00002 : "조회를 완료했습니다.조회건수 [${}건]"
			
		} 
		else 
		{	 
			gfn_showMsg("CW00010"); 					// CW00010 : "데이터가 없습니다."
		}
	} 
}

//=========================================================================================
// [ PART 6 ]
// component Event 정의 : 각 Component 별 이벤트 
//=========================================================================================
/********************************************************************************
* 기      능   : 그리드 헤더 클릭시 정렬 처리 
********************************************************************************/
function grd_list_OnHeadClick(obj,nCell,nX,nY,nPivotIndex) {
	if (nCell == 0) {
		gfn_selectGridCol(obj); 
	} else {
		// 그리드 정렬 처리 
		gfn_sortGrid(obj, nCell);
	}
}
 
// 그리드 더블클릭 시
function grd_list_OnCellDblClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{ 
	// 수금관리대장상세 화면 팝업
	btn_scl0041_OnClick(); 
}

// 임시코딩
function fn_OnClick_btn(obj)
{ 
	//var fncName = "fn_" + substr(obj.id, 4); 
	//eval( fncName + "()");
}

// 항목 오류 검증
// pProcGb : 처리구분 (query:조회,excel:엑셀)
function fn_valid_chk(pProcGb)
{   
	var arr;
	
 	switch(pProcGb)
	{
		case "query" :   
		
			if (length(cal_fr_ymd.Value) == 0)
			{
				// CW00208 : "[${}]은/는 필수입력 입니다.확인바랍니다.")
				gfn_showAlert("CW00208","수주기간(시작일자)");
				gfn_SetFocus(cal_fr_ymd,"Y"); 
				return false;
			} 
			if (length(cal_to_ymd.Value) == 0)
			{
				gfn_showAlert("CW00208","수주기간(종료일자)");
				gfn_SetFocus(cal_to_ymd,"Y");   
				return false;
			} 
			
			if (gfn_checkDate( trim(cal_fr_ymd.Value)
								, trim(cal_to_ymd.Value)
								, true
								, cal_fr_ymd
								, "수주기간 시작일자"
								, "수주기간 종료일자" ) == false)
			{
				return false;
			} 
			// SO시작번호가 없고 시작부서도 없으면 오류처리
			if (length(trim(div_sales.ed_fromEdit.Text)) == 0 && length(div_vbvg.cb_frvb.value)==0)
			{
				// "CW10008", "SO번호를 입력하시거나 부서를 선택하시기 바랍니다."
				gfn_showAlert("CW10008");
				gfn_SetFocus(div_sales.ed_fromEdit,"Y"); 
				return false;
			}
			
			break;  
			
		case "excel" :   // 엑셀
			
			if (ds_list.RowCount() <=0)
			{ 
				// CW00010 : "데이터가 없습니다."
				gfn_showAlert("CW00010");
				return false;
			}
			break;
		default: 
			break; 
	}   

	return true;
}

/********************************************************************************
* 기      능   : 새로고침
********************************************************************************/
function fn_refresh() {

	// 폼초기화
	//fn_init_form();
	
}  

// 폼 초기화 
function fn_init_form()
{
	// 임시코딩 
	//if (length(G_SESSION_ID)==0)
	//{
	//	btn_query.Visible = true; 
	//	btn_excel.Visible = true;
	//	btn_close.Visible = true;
	//}
	//else
	//{ 
	//	btn_query.Visible = false; 
	//	btn_excel.Visible = false;
	//	btn_close.Visible = false;
	//}
	
	// 메세지바 초기화
	gfn_clearMsgBar();   
	
	/* 수주기간 기본값 SETTING */ 
	cal_fr_ymd.value = "19990101"; //substr(gfn_getCurrDate(),0,6) + "01";	// 시작일자 = 현재년월 + 01
	cal_to_ymd.value = gfn_getCurrDate();	 					// 종료년월 = 현재년월일
	
	/* 기준일자 기본값 SETTING*/
	cal_stada.value = gfn_getCurrDate();   						// 기준일자 = 현재년월일 
	
	ds_cond.ClearData();  	// 검색조건 데이타셋 초기화
	ds_list.ClearData(); 	// 검색결과 그리드데이타셋 초기화
	
	div_vbvg.Border = "none"; 
	div_sman.Border = "none";
	div_buyr.Border = "none";
	div_sales.Border= "none";
	
	// 부서 검색조건 스타일 적용
	div_vbvg.cb_frvb.Style = "sty_ipt_search_ind";		// 필수항목적용
	
	// SO 검색조건 스타일 적용
	div_sales.ed_fromEdit.Style = "sty_ipt_search_ind";	// 필수항목적용
	
	// 그리드 FIX
	gfn_grid_fix(grd_list , 4);	// 제품군에서 fix
	
	
} 

// 팝업화면 호출
// obj : 버튼obj
function fn_OnClick_popup(obj)
{
	switch (obj.id)
	{
		case "" :  
			break; 
				
		default:
			break;
	}
	return; 
} 

// 오더유형코드목록 조회 CALL BACK함수
function fn_afterQuery_auart(errCode, errMsg) 
{  
	// trace("fn_afterQuery_auart");
	gfn_InsertRowCombo(ds_auart_cd, 0, "Y", "N", "Y"); // 오더유형에 전체 행 추가
	cb_auart.index = 0;
}  

// 수금관리대장상세 버튼 클릭 시  수금관리대장상세 화면 팝업
function btn_scl0041_OnClick(obj)
{
	if (ds_list.row < 0) return;
	
	var arg = "fa_zzpjt_id = " + quote(ds_list.getcolumn(ds_list.row, "ZZPJT_ID"));  // 프로젝트ID
	
	var pjt = ds_list.getcolumn(ds_list.row, "ZZPJT_ID");
	
	if (substr(pjt, 0, 1) == 'E' or substr(pjt, 0, 1) == 'C' or substr(pjt, 0, 1) == 'T')
	{
	  return gfn_openPopUpUrlHdel("Scl::Scl0043.xml", true, arg );
	}
	else
	{
	  return gfn_openPopUpUrlHdel("Scl::Scl0041.xml", true, arg );
	}
}

function grd_list_OnKeyDown(obj,nChar,bShift,bCtrl,bAlt,nLLParam,nHLParam)
{
	var ds = object(obj.BindDataset);  
	
	// Enter 키이면
	if (nChar==13)
	{ 
		ds.row = ds.row + 1;  // 다음 행으로 이동
	} 
	else 
	{
		gfn_GrdCellCopyPasteReset(obj,  ds, bCtrl, nChar);
	} 
}
]]></Script>
</Window>