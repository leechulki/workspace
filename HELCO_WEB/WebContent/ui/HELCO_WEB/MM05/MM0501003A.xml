<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="562" Id="MM0501003A" Left="8" OnLoadCompleted="fn_OnLoadCompleted" OnUnloadCompleted="fn_OnUnloadCompleted" PidAttrib="7" Style="sty_ipt_form" Title="일일배차&#32;관리" Top="8" Ver="1.0" Width="978" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_ztype_cd">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME>-&#32;전&#32;체&#32;-</CODE_NAME>
					</record>
					<record>
						<CODE>11</CODE>
						<CODE_NAME>천안&#32;-&gt;&#32;현장</CODE_NAME>
					</record>
					<record>
						<CODE>12</CODE>
						<CODE_NAME>업체&#32;-&gt;&#32;현장</CODE_NAME>
					</record>
					<record>
						<CODE>13</CODE>
						<CODE_NAME>업체&#32;-&gt;&#32;천안</CODE_NAME>
					</record>
					<record>
						<CODE>14</CODE>
						<CODE_NAME>현장&#32;-&gt;&#32;천안</CODE_NAME>
					</record>
					<record>
						<CODE>15</CODE>
						<CODE_NAME>이천&#32;-&gt;&#32;천안</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_zlzone_cd">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond">
				<Contents>
					<colinfo id="ERDAT_FM" size="256" type="STRING"/>
					<colinfo id="ERDAT_TO" size="255" type="STRING"/>
					<colinfo id="ZLZONE" size="255" type="STRING"/>
					<colinfo id="ZTYPE" size="255" type="STRING"/>
					<colinfo id="PJT" size="10" type="STRING"/>
					<colinfo id="TPLST" size="11" type="STRING"/>
					<record>
						<ERDAT_FM></ERDAT_FM>
						<ERDAT_TO></ERDAT_TO>
						<PJT></PJT>
						<TPLST></TPLST>
						<ZLZONE></ZLZONE>
						<ZTYPE></ZTYPE>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_subcond">
				<Contents>
					<colinfo id="ZKNUM" size="255" type="STRING"/>
					<colinfo id="ZKNUM2" size="255" type="STRING"/>
					<colinfo id="BOX" size="10" type="STRING"/>
					<colinfo id="TPLST" size="12" type="STRING"/>
					<colinfo id="PSPID" size="256" type="STRING"/>
					<record>
						<BOX></BOX>
						<PSPID></PSPID>
						<TPLST></TPLST>
						<ZKNUM></ZKNUM>
						<ZKNUM2></ZKNUM2>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_rcond">
				<Contents>
					<colinfo id="ZKNUM1" size="255" type="STRING"/>
					<colinfo id="ZKNUM2" size="255" type="STRING"/>
					<record>
						<ZKNUM1></ZKNUM1>
						<ZKNUM2></ZKNUM2>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_tplst_cd">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME>-&#32;전&#32;체&#32;-</CODE_NAME>
					</record>
					<record>
						<CODE>1000</CODE>
						<CODE_NAME>이천</CODE_NAME>
					</record>
					<record>
						<CODE>1100</CODE>
						<CODE_NAME>천안</CODE_NAME>
					</record>
					<record>
						<CODE>1200</CODE>
						<CODE_NAME>충주</CODE_NAME>
					</record>
					<record>
						<CODE>1300</CODE>
						<CODE_NAME>진천</CODE_NAME>
					</record>
					<record>
						<CODE>1111</CODE>
						<CODE_NAME>기타</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_box_cd">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME>ALL</CODE_NAME>
					</record>
					<record>
						<CODE>BOX01</CODE>
						<CODE_NAME>BOX01</CODE_NAME>
					</record>
					<record>
						<CODE>BOX02</CODE>
						<CODE_NAME>BOX02</CODE_NAME>
					</record>
					<record>
						<CODE>BOX03</CODE>
						<CODE_NAME>BOX03</CODE_NAME>
					</record>
					<record>
						<CODE>BOX04</CODE>
						<CODE_NAME>BOX04</CODE_NAME>
					</record>
					<record>
						<CODE>BOX05</CODE>
						<CODE_NAME>BOX05</CODE_NAME>
					</record>
					<record>
						<CODE>BOX06</CODE>
						<CODE_NAME>BOX06</CODE_NAME>
					</record>
					<record>
						<CODE>BOX07</CODE>
						<CODE_NAME>BOX07</CODE_NAME>
					</record>
					<record>
						<CODE>BOX08</CODE>
						<CODE_NAME>BOX08</CODE_NAME>
					</record>
					<record>
						<CODE>BOX09</CODE>
						<CODE_NAME>BOX09</CODE_NAME>
					</record>
					<record>
						<CODE>BOX10</CODE>
						<CODE_NAME>BOX10</CODE_NAME>
					</record>
					<record>
						<CODE>BOX11</CODE>
						<CODE_NAME>BOX11</CODE_NAME>
					</record>
					<record>
						<CODE>BOX12</CODE>
						<CODE_NAME>BOX12</CODE_NAME>
					</record>
					<record>
						<CODE>BOX13</CODE>
						<CODE_NAME>BOX13</CODE_NAME>
					</record>
					<record>
						<CODE>BOX14</CODE>
						<CODE_NAME>BOX14</CODE_NAME>
					</record>
					<record>
						<CODE>BOX15</CODE>
						<CODE_NAME>BOX15</CODE_NAME>
					</record>
					<record>
						<CODE>BOX16</CODE>
						<CODE_NAME>BOX16</CODE_NAME>
					</record>
					<record>
						<CODE>BOX17</CODE>
						<CODE_NAME>BOX17</CODE_NAME>
					</record>
					<record>
						<CODE>BOX18</CODE>
						<CODE_NAME>BOX18</CODE_NAME>
					</record>
					<record>
						<CODE>BOX19</CODE>
						<CODE_NAME>BOX19</CODE_NAME>
					</record>
					<record>
						<CODE>BOX20</CODE>
						<CODE_NAME>BOX20</CODE_NAME>
					</record>
					<record>
						<CODE>BOX21</CODE>
						<CODE_NAME>BOX21</CODE_NAME>
					</record>
					<record>
						<CODE>BOX22</CODE>
						<CODE_NAME>BOX22</CODE_NAME>
					</record>
					<record>
						<CODE>BOX23</CODE>
						<CODE_NAME>BOX23</CODE_NAME>
					</record>
					<record>
						<CODE>BOX24</CODE>
						<CODE_NAME>BOX24</CODE_NAME>
					</record>
					<record>
						<CODE>BOX25</CODE>
						<CODE_NAME>BOX25</CODE_NAME>
					</record>
					<record>
						<CODE>BOX26</CODE>
						<CODE_NAME>BOX26</CODE_NAME>
					</record>
					<record>
						<CODE>BOX27</CODE>
						<CODE_NAME>BOX27</CODE_NAME>
					</record>
					<record>
						<CODE>BOX28</CODE>
						<CODE_NAME>BOX28</CODE_NAME>
					</record>
					<record>
						<CODE>BOX29</CODE>
						<CODE_NAME>BOX29</CODE_NAME>
					</record>
					<record>
						<CODE>BOX30</CODE>
						<CODE_NAME>BOX30</CODE_NAME>
					</record>
					<record>
						<CODE>BOX31</CODE>
						<CODE_NAME>BOX31</CODE_NAME>
					</record>
					<record>
						<CODE>BOX32</CODE>
						<CODE_NAME>BOX32</CODE_NAME>
					</record>
					<record>
						<CODE>BOX33</CODE>
						<CODE_NAME>BOX33</CODE_NAME>
					</record>
					<record>
						<CODE>BOX34</CODE>
						<CODE_NAME>BOX34</CODE_NAME>
					</record>
					<record>
						<CODE>BOX35</CODE>
						<CODE_NAME>BOX35</CODE_NAME>
					</record>
					<record>
						<CODE>BOX36</CODE>
						<CODE_NAME>BOX36</CODE_NAME>
					</record>
					<record>
						<CODE>BOX37</CODE>
						<CODE_NAME>BOX37</CODE_NAME>
					</record>
					<record>
						<CODE>BOX38</CODE>
						<CODE_NAME>BOX38</CODE_NAME>
					</record>
					<record>
						<CODE>BOX39</CODE>
						<CODE_NAME>BOX39</CODE_NAME>
					</record>
					<record>
						<CODE>BOX40</CODE>
						<CODE_NAME>BOX40</CODE_NAME>
					</record>
					<record>
						<CODE>BOX41</CODE>
						<CODE_NAME>BOX41</CODE_NAME>
					</record>
					<record>
						<CODE>BOX42</CODE>
						<CODE_NAME>BOX42</CODE_NAME>
					</record>
					<record>
						<CODE>BOX43</CODE>
						<CODE_NAME>BOX43</CODE_NAME>
					</record>
					<record>
						<CODE>BOX44</CODE>
						<CODE_NAME>BOX44</CODE_NAME>
					</record>
					<record>
						<CODE>BOX45</CODE>
						<CODE_NAME>BOX45</CODE_NAME>
					</record>
					<record>
						<CODE>BOX46</CODE>
						<CODE_NAME>BOX46</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list" OnRowPosChanged="ds_list_OnCellPosChanged">
				<Contents>
					<colinfo id="BEZEI" size="60" summ="default" type="STRING"/>
					<colinfo id="CELLP" size="30" summ="default" type="STRING"/>
					<colinfo id="CELLP2" size="30" summ="default" type="STRING"/>
					<colinfo id="CHECK" size="1" summ="default" type="STRING"/>
					<colinfo id="DPTEN" size="24" summ="default" type="STRING"/>
					<colinfo id="ERDAT" size="24" summ="default" type="STRING"/>
					<colinfo id="ERZET" size="18" summ="default" type="STRING"/>
					<colinfo id="HOGI" size="1000" summ="default" type="STRING"/>
					<colinfo id="MANDT" size="9" summ="default" type="STRING"/>
					<colinfo id="MOB_NUMBER" size="30" summ="default" type="STRING"/>
					<colinfo id="NAME1" size="105" summ="default" type="STRING"/>
					<colinfo id="NAMET" size="105" summ="default" type="STRING"/>
					<colinfo id="ORT01" size="105" summ="default" type="STRING"/>
					<colinfo id="POSID" size="72" summ="default" type="STRING"/>
					<colinfo id="POST1" size="120" summ="default" type="STRING"/>
					<colinfo id="PSPID" size="72" summ="default" type="STRING"/>
					<colinfo id="SNAME1" size="105" summ="default" type="STRING"/>
					<colinfo id="SPEC" size="3000" summ="default" type="STRING"/>
					<colinfo id="STRAS" size="105" summ="default" type="STRING"/>
					<colinfo id="TABNM" size="1" summ="default" type="STRING"/>
					<colinfo id="TRAID" size="60" summ="default" type="STRING"/>
					<colinfo id="UPTEN" size="18" summ="default" type="STRING"/>
					<colinfo id="ZCHAN" size="120" summ="default" type="STRING"/>
					<colinfo id="ZCHAN_NM" size="29" summ="default" type="STRING"/>
					<colinfo id="ZKNUM" size="36" summ="default" type="STRING"/>
					<colinfo id="ZKNUM2" size="6" summ="default" type="STRING"/>
					<colinfo id="ZLZONE" size="30" summ="default" type="STRING"/>
					<colinfo id="ZLZONE_NM" size="60" summ="default" type="STRING"/>
					<colinfo id="ZSPEC1" size="15" summ="default" type="STRING"/>
					<colinfo id="ZSPEC2" size="75" summ="default" type="STRING"/>
					<colinfo id="ZSTAT4" size="1" summ="default" type="STRING"/>
					<colinfo id="ZTEXT" size="120" summ="default" type="STRING"/>
					<colinfo id="ZTON" size="118" summ="default" type="STRING"/>
					<colinfo id="ZTRANS" size="3" summ="default" type="STRING"/>
					<colinfo id="ZTYPE" size="6" summ="default" type="STRING"/>
					<colinfo id="ZTYPE_NM" size="14" summ="default" type="STRING"/>
					<colinfo id="ZZTEAMJ" size="60" summ="default" type="STRING"/>
					<colinfo id="ZZTEAMJ2" size="60" summ="default" type="STRING"/>
					<colinfo id="ZZTEMNO" size="18" summ="default" type="STRING"/>
					<colinfo id="ZZTEMNO2" size="18" summ="default" type="STRING"/>
					<colinfo id="ERNAM" size="256" summ="default" type="STRING"/>
					<colinfo id="TPLST" size="12" summ="default" type="STRING"/>
					<colinfo id="AEDAT" size="24" summ="default" type="STRING"/>
					<colinfo id="AENAM" size="30" summ="default" type="STRING"/>
					<colinfo id="UZEIT" size="18" summ="default" type="STRING"/>
					<colinfo id="BOX_CK" size="256" summ="default" type="STRING"/>
					<colinfo id="ZFULLSET" size="2" summ="default" type="STRING"/>
					<colinfo id="TPLSTDT1" size="100" summ="default" type="STRING"/>
					<colinfo id="TPLSTDT2" size="100" summ="default" type="STRING"/>
					<colinfo id="TPLSTDT3" size="100" summ="default" type="STRING"/>
					<colinfo id="TPLSTDT4" size="100" summ="default" type="STRING"/>
					<colinfo id="TPLSTDT5" size="100" summ="default" type="STRING"/>
					<colinfo id="TPLSTDTQTY1" size="30" summ="default" type="STRING"/>
					<colinfo id="TPLSTDTQTY2" size="30" summ="default" type="STRING"/>
					<colinfo id="TPLSTDTQTY3" size="30" summ="default" type="STRING"/>
					<colinfo id="TPLSTDTQTY4" size="30" summ="default" type="STRING"/>
					<colinfo id="TPLSTDTQTY5" size="30" summ="default" type="STRING"/>
					<colinfo id="TPLSTDTZTON1" size="100" summ="default" type="STRING"/>
					<colinfo id="TPLSTDTZTON2" size="100" summ="default" type="STRING"/>
					<colinfo id="TPLSTDTZTON3" size="100" summ="default" type="STRING"/>
					<colinfo id="TPLSTDTZTON4" size="100" summ="default" type="STRING"/>
					<colinfo id="TPLSTDTZTON5" size="100" summ="default" type="STRING"/>
					<colinfo id="TPLSTDT6" size="100" summ="default" type="STRING"/>
					<colinfo id="TPLSTDT7" size="100" summ="default" type="STRING"/>
					<colinfo id="TPLSTDTQTY6" size="30" summ="default" type="STRING"/>
					<colinfo id="TPLSTDTQTY7" size="30" summ="default" type="STRING"/>
					<colinfo id="TPLSTDTZTON6" size="100" summ="default" type="STRING"/>
					<colinfo id="TPLSTDTZTON7" size="100" summ="default" type="STRING"/>
					<colinfo id="CARINFO" size="1000" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list_0">
				<Contents>
					<colinfo id="BEZEI" size="60" summ="default" type="STRING"/>
					<colinfo id="CELLP" size="30" summ="default" type="STRING"/>
					<colinfo id="CELLP2" size="30" summ="default" type="STRING"/>
					<colinfo id="CHECK" size="1" summ="default" type="STRING"/>
					<colinfo id="DPTEN" size="24" summ="default" type="STRING"/>
					<colinfo id="ERDAT" size="24" summ="default" type="STRING"/>
					<colinfo id="ERZET" size="18" summ="default" type="STRING"/>
					<colinfo id="HOGI" size="1000" summ="default" type="STRING"/>
					<colinfo id="MANDT" size="9" summ="default" type="STRING"/>
					<colinfo id="MOB_NUMBER" size="30" summ="default" type="STRING"/>
					<colinfo id="NAME1" size="105" summ="default" type="STRING"/>
					<colinfo id="NAMET" size="105" summ="default" type="STRING"/>
					<colinfo id="ORT01" size="105" summ="default" type="STRING"/>
					<colinfo id="POSID" size="72" summ="default" type="STRING"/>
					<colinfo id="POST1" size="120" summ="default" type="STRING"/>
					<colinfo id="PSPID" size="72" summ="default" type="STRING"/>
					<colinfo id="SNAME1" size="105" summ="default" type="STRING"/>
					<colinfo id="SPEC" size="3000" summ="default" type="STRING"/>
					<colinfo id="STRAS" size="105" summ="default" type="STRING"/>
					<colinfo id="TABNM" size="1" summ="default" type="STRING"/>
					<colinfo id="TRAID" size="60" summ="default" type="STRING"/>
					<colinfo id="UPTEN" size="18" summ="default" type="STRING"/>
					<colinfo id="ZCHAN" size="120" summ="default" type="STRING"/>
					<colinfo id="ZCHAN_NM" size="29" summ="default" type="STRING"/>
					<colinfo id="ZKNUM" size="36" summ="default" type="STRING"/>
					<colinfo id="ZKNUM2" size="6" summ="default" type="STRING"/>
					<colinfo id="ZLZONE" size="30" summ="default" type="STRING"/>
					<colinfo id="ZLZONE_NM" size="60" summ="default" type="STRING"/>
					<colinfo id="ZSPEC1" size="15" summ="default" type="STRING"/>
					<colinfo id="ZSPEC2" size="75" summ="default" type="STRING"/>
					<colinfo id="ZSTAT4" size="1" summ="default" type="STRING"/>
					<colinfo id="ZTEXT" size="120" summ="default" type="STRING"/>
					<colinfo id="ZTON" size="118" summ="default" type="STRING"/>
					<colinfo id="ZTRANS" size="3" summ="default" type="STRING"/>
					<colinfo id="ZTYPE" size="6" summ="default" type="STRING"/>
					<colinfo id="ZTYPE_NM" size="14" summ="default" type="STRING"/>
					<colinfo id="ZZTEAMJ" size="60" summ="default" type="STRING"/>
					<colinfo id="ZZTEAMJ2" size="60" summ="default" type="STRING"/>
					<colinfo id="ZZTEMNO" size="18" summ="default" type="STRING"/>
					<colinfo id="ZZTEMNO2" size="18" summ="default" type="STRING"/>
					<colinfo id="ERNAM" size="256" summ="default" type="STRING"/>
					<colinfo id="TPLST" size="12" summ="default" type="STRING"/>
					<colinfo id="AEDAT" size="24" summ="default" type="STRING"/>
					<colinfo id="AENAM" size="30" summ="default" type="STRING"/>
					<colinfo id="UZEIT" size="18" summ="default" type="STRING"/>
					<colinfo id="BOX_CK" size="256" summ="default" type="STRING"/>
					<colinfo id="ZFULLSET" size="2" summ="default" type="STRING"/>
					<colinfo id="TPLSTDT1" size="100" summ="default" type="STRING"/>
					<colinfo id="TPLSTDT2" size="100" summ="default" type="STRING"/>
					<colinfo id="TPLSTDT3" size="100" summ="default" type="STRING"/>
					<colinfo id="TPLSTDT4" size="100" summ="default" type="STRING"/>
					<colinfo id="TPLSTDT5" size="100" summ="default" type="STRING"/>
					<colinfo id="TPLSTDTQTY1" size="30" summ="default" type="STRING"/>
					<colinfo id="TPLSTDTQTY2" size="30" summ="default" type="STRING"/>
					<colinfo id="TPLSTDTQTY3" size="30" summ="default" type="STRING"/>
					<colinfo id="TPLSTDTQTY4" size="30" summ="default" type="STRING"/>
					<colinfo id="TPLSTDTQTY5" size="30" summ="default" type="STRING"/>
					<colinfo id="TPLSTDTZTON1" size="100" summ="default" type="STRING"/>
					<colinfo id="TPLSTDTZTON2" size="100" summ="default" type="STRING"/>
					<colinfo id="TPLSTDTZTON3" size="100" summ="default" type="STRING"/>
					<colinfo id="TPLSTDTZTON4" size="100" summ="default" type="STRING"/>
					<colinfo id="TPLSTDTZTON5" size="100" summ="default" type="STRING"/>
					<colinfo id="TPLSTDT6" size="100" summ="default" type="STRING"/>
					<colinfo id="TPLSTDT7" size="100" summ="default" type="STRING"/>
					<colinfo id="TPLSTDTQTY6" size="30" summ="default" type="STRING"/>
					<colinfo id="TPLSTDTQTY7" size="30" summ="default" type="STRING"/>
					<colinfo id="TPLSTDTZTON6" size="100" summ="default" type="STRING"/>
					<colinfo id="TPLSTDTZTON7" size="100" summ="default" type="STRING"/>
					<colinfo id="CARINFO" size="1000" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_zstat4">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
					<record>
						<CODE>1</CODE>
						<CODE_NAME>운송계획</CODE_NAME>
					</record>
					<record>
						<CODE>2</CODE>
						<CODE_NAME>납품문서</CODE_NAME>
					</record>
					<record>
						<CODE>3</CODE>
						<CODE_NAME>출고전기</CODE_NAME>
					</record>
					<record>
						<CODE>4</CODE>
						<CODE_NAME>BOM삭제</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_state">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
					<record>
						<CODE>0</CODE>
						<CODE_NAME>PR</CODE_NAME>
					</record>
					<record>
						<CODE>1</CODE>
						<CODE_NAME>PO</CODE_NAME>
					</record>
					<record>
						<CODE>2</CODE>
						<CODE_NAME>GR</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ekgrp_cd">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_chulha">
				<Contents>
					<colinfo id="ZBELN" size="10" type="STRING"/>
					<colinfo id="ZOSNR" size="6" type="STRING"/>
					<colinfo id="PSPID" size="74" type="STRING"/>
					<colinfo id="PSPNR" size="8" type="STRING"/>
					<colinfo id="POSID3" size="74" type="STRING"/>
					<colinfo id="BUDAT" size="8" type="STRING"/>
					<colinfo id="RSNUM" size="10" type="STRING"/>
					<colinfo id="RSPOS" size="4" type="STRING"/>
					<colinfo id="MATNR" size="18" type="STRING"/>
					<colinfo id="LFIMG" size="13" type="DECIMAL"/>
					<colinfo id="ERFME" size="3" type="STRING"/>
					<colinfo id="MBLNR" size="10" type="STRING"/>
					<colinfo id="AENAM" size="12" type="STRING"/>
					<colinfo id="ZRTNVAL" size="1" type="STRING"/>
					<colinfo id="ZRTNMSG" size="64" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_error">
				<Contents>
					<colinfo id="IDX" size="256" type="STRING"/>
					<colinfo id="ERRMSG" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cancel">
				<Contents>
					<colinfo id="ZBELN" size="10" type="STRING"/>
					<colinfo id="ZOSNR" size="6" type="STRING"/>
					<colinfo id="RSNUM" size="10" type="STRING"/>
					<colinfo id="RSPOS" size="4" type="STRING"/>
					<colinfo id="BUDAT" size="8" type="STRING"/>
					<colinfo id="MBLNR" size="10" type="STRING"/>
					<colinfo id="MJAHR" size="4" type="STRING"/>
					<colinfo id="AENAM" size="12" type="STRING"/>
					<colinfo id="ZRTNVAL" size="1" type="STRING"/>
					<colinfo id="ZRTNMSG" size="64" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_detail" OnColumnChanged="ds_detail_OnCellPosChanged">
				<Contents>
					<colinfo id="BLOCK" size="120" summ="default" type="STRING"/>
					<colinfo id="BUDAT" size="0" summ="default" type="STRING"/>
					<colinfo id="CHECK" size="1" summ="default" type="STRING"/>
					<colinfo id="EKGRP" size="9" summ="default" type="STRING"/>
					<colinfo id="ENMNG" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="ERFME" size="9" summ="default" type="STRING"/>
					<colinfo id="ERFMG" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="EXTWG" size="54" summ="default" type="STRING"/>
					<colinfo id="JEAGO" size="17" summ="default" type="DECIMAL"/>
					<colinfo id="LFIMG" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="LIFNR" size="30" summ="default" type="STRING"/>
					<colinfo id="NAME1" size="100" summ="default" type="STRING"/>
					<colinfo id="MATNR" size="54" summ="default" type="STRING"/>
					<colinfo id="MATNR_NM" size="120" summ="default" type="STRING"/>
					<colinfo id="MBLNR" size="0" summ="default" type="STRING"/>
					<colinfo id="MJAHR" size="4" summ="default" type="CHAR"/>
					<colinfo id="MTART" size="12" summ="default" type="STRING"/>
					<colinfo id="POSID" size="74" summ="default" type="STRING"/>
					<colinfo id="POSID2" size="3" summ="default" type="STRING"/>
					<colinfo id="POSID3" size="74" summ="default" type="STRING"/>
					<colinfo id="POSNR" size="18" summ="default" type="STRING"/>
					<colinfo id="POST1" size="120" summ="default" type="STRING"/>
					<colinfo id="PSPID" size="72" summ="default" type="STRING"/>
					<colinfo id="RSNUM" size="30" summ="default" type="STRING"/>
					<colinfo id="RSPOS" size="12" summ="default" type="STRING"/>
					<colinfo id="SBDKZ" size="3" summ="default" type="STRING"/>
					<colinfo id="SPEC" size="180" summ="default" type="STRING"/>
					<colinfo id="STATE" size="1" summ="default" type="STRING"/>
					<colinfo id="TABNM" size="1" summ="default" type="STRING"/>
					<colinfo id="VBELN" size="30" summ="default" type="STRING"/>
					<colinfo id="VBELN7" size="30" summ="default" type="STRING"/>
					<colinfo id="VRKME" size="9" summ="default" type="STRING"/>
					<colinfo id="ZBELN" size="30" summ="default" type="STRING"/>
					<colinfo id="ZKNUM" size="36" summ="default" type="STRING"/>
					<colinfo id="ZKNUM2" size="256" summ="default" type="STRING"/>
					<colinfo id="ZLOG3" size="192" summ="default" type="STRING"/>
					<colinfo id="ZOSNR" size="18" summ="default" type="STRING"/>
					<colinfo id="ZRTNMSG" size="0" summ="default" type="STRING"/>
					<colinfo id="ZRTNVAL" size="0" summ="default" type="STRING"/>
					<colinfo id="ZSIZE" size="180" summ="default" type="STRING"/>
					<colinfo id="ZSPEC1" size="15" summ="default" type="STRING"/>
					<colinfo id="ZSPEC2" size="75" summ="default" type="STRING"/>
					<colinfo id="ZSTAT4" size="1" summ="default" type="STRING"/>
					<colinfo id="ZGI" size="50" summ="default" type="STRING"/>
					<colinfo id="BOXCK" size="100" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_detail_0">
				<Contents>
					<colinfo id="BLOCK" size="120" summ="default" type="STRING"/>
					<colinfo id="BUDAT" size="0" summ="default" type="STRING"/>
					<colinfo id="CHECK" size="1" summ="default" type="STRING"/>
					<colinfo id="EKGRP" size="9" summ="default" type="STRING"/>
					<colinfo id="ENMNG" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="ERFME" size="9" summ="default" type="STRING"/>
					<colinfo id="ERFMG" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="EXTWG" size="54" summ="default" type="STRING"/>
					<colinfo id="JEAGO" size="17" summ="default" type="DECIMAL"/>
					<colinfo id="LFIMG" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="LIFNR" size="30" summ="default" type="STRING"/>
					<colinfo id="NAME1" size="100" summ="default" type="STRING"/>
					<colinfo id="MATNR" size="54" summ="default" type="STRING"/>
					<colinfo id="MATNR_NM" size="120" summ="default" type="STRING"/>
					<colinfo id="MBLNR" size="0" summ="default" type="STRING"/>
					<colinfo id="MJAHR" size="4" summ="default" type="CHAR"/>
					<colinfo id="MTART" size="12" summ="default" type="STRING"/>
					<colinfo id="POSID" size="74" summ="default" type="STRING"/>
					<colinfo id="POSID2" size="3" summ="default" type="STRING"/>
					<colinfo id="POSID3" size="74" summ="default" type="STRING"/>
					<colinfo id="POSNR" size="18" summ="default" type="STRING"/>
					<colinfo id="POST1" size="120" summ="default" type="STRING"/>
					<colinfo id="PSPID" size="72" summ="default" type="STRING"/>
					<colinfo id="RSNUM" size="30" summ="default" type="STRING"/>
					<colinfo id="RSPOS" size="12" summ="default" type="STRING"/>
					<colinfo id="SBDKZ" size="3" summ="default" type="STRING"/>
					<colinfo id="SPEC" size="180" summ="default" type="STRING"/>
					<colinfo id="STATE" size="1" summ="default" type="STRING"/>
					<colinfo id="TABNM" size="1" summ="default" type="STRING"/>
					<colinfo id="VBELN" size="30" summ="default" type="STRING"/>
					<colinfo id="VBELN7" size="30" summ="default" type="STRING"/>
					<colinfo id="VRKME" size="9" summ="default" type="STRING"/>
					<colinfo id="ZBELN" size="30" summ="default" type="STRING"/>
					<colinfo id="ZKNUM" size="36" summ="default" type="STRING"/>
					<colinfo id="ZKNUM2" size="256" summ="default" type="STRING"/>
					<colinfo id="ZLOG3" size="192" summ="default" type="STRING"/>
					<colinfo id="ZOSNR" size="18" summ="default" type="STRING"/>
					<colinfo id="ZRTNMSG" size="0" summ="default" type="STRING"/>
					<colinfo id="ZRTNVAL" size="0" summ="default" type="STRING"/>
					<colinfo id="ZSIZE" size="180" summ="default" type="STRING"/>
					<colinfo id="ZSPEC1" size="15" summ="default" type="STRING"/>
					<colinfo id="ZSPEC2" size="75" summ="default" type="STRING"/>
					<colinfo id="ZSTAT4" size="1" summ="default" type="STRING"/>
					<colinfo id="ZGI" size="50" summ="default" type="STRING"/>
					<colinfo id="BOXCK" size="100" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_rlist">
				<Contents>
					<colinfo id="BLOCK" size="250" summ="default" type="STRING"/>
					<colinfo id="BMMG" size="11" summ="default" type="DECIMAL"/>
					<colinfo id="EBELN" size="30" summ="default" type="STRING"/>
					<colinfo id="EXTWG" size="2" summ="default" type="STRING"/>
					<colinfo id="JEAGO" size="16" summ="default" type="DECIMAL"/>
					<colinfo id="LFIMG" size="16" summ="default" type="DECIMAL"/>
					<colinfo id="MATNR" size="105" summ="default" type="STRING"/>
					<colinfo id="MATNR_NM" size="482" summ="default" type="STRING"/>
					<colinfo id="NAME1" size="105" summ="default" type="STRING"/>
					<colinfo id="ORNUM" size="1" summ="default" type="STRING"/>
					<colinfo id="POSID1" size="3" summ="default" type="STRING"/>
					<colinfo id="POSID2" size="3" summ="default" type="STRING"/>
					<colinfo id="PSPID" size="8" summ="default" type="STRING"/>
					<colinfo id="VRKME" size="2" summ="default" type="STRING"/>
					<colinfo id="ZKNUM" size="36" summ="default" type="STRING"/>
					<colinfo id="BOX_CK" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_grdFormat">
				<Contents>
					<colinfo id="comPath" size="256" type="STRING"/>
					<colinfo id="formatID" size="256" type="STRING"/>
					<colinfo id="Arch" size="256" type="STRING"/>
				</Contents>
			</Dataset>
		</Datasets>
		<Div Height="24" Id="btn_div" Left="-1" TabOrder="15" Text="Div0" Top="198" Width="979">
			<Contents>
				<Combo BindDataset="ds_subcond" Border="Flat" CodeColumn="CODE" Column="BOX" DataColumn="CODE_NAME" Height="20" Id="cb_box" InnerDataset="ds_box_cd" Left="95" OnChanged="cb_box_OnChanged" Style="sty_ipt_search" TabOrder="1" Width="83"></Combo>
				<Static Align="Right" BindDataset="ds_rcond" Height="20" Id="st_box" Left="6" Style="sty_lb_search" TabOrder="2" Text="BOX&#32;" Top="1" VAlign="Middle" Width="88"></Static>
				<Calendar Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_budat" Left="269" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_search_ind" SundayTextColor="user35" TabOrder="3" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="2" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="97"></Calendar>
				<Static Align="Right" BindDataset="ds_rcond" Height="20" Id="Static0" Left="179" Style="sty_lb_search" TabOrder="4" Text="전기일자&#32;" Top="2" VAlign="Middle" Width="88"></Static>
				<Button ButtonStyle="TRUE" Cursor="HAND" Enable="FALSE" Height="20" Id="btn_del" ImageID="btn_sub_04" Left="755" LeftMargin="12" OnClick="ufn_DelItem" Style="sty_btn" TabOrder="5" Text="자재삭제" Top="1" Transparent="TRUE" Width="72"></Button>
				<Button ButtonStyle="TRUE" Cursor="HAND" Enable="FALSE" Height="20" Id="btn_chulgo" ImageID="btn_sub_04" Left="827" LeftMargin="12" OnClick="ufn_Chulha" Style="sty_btn" TabOrder="6" Text="출고전기" Top="1" Transparent="TRUE" Width="72"></Button>
				<Button ButtonStyle="TRUE" Cursor="HAND" Enable="FALSE" Height="20" Id="btn_cancel" ImageID="btn_sub_04" Left="899" LeftMargin="12" OnClick="ufn_Cancel" Style="sty_btn" TabOrder="7" Text="출고취소" Top="1" Transparent="TRUE" Width="72"></Button>
			</Contents>
		</Div>
		<Grid AutoFitEndLine="Hide" BindDataset="ds_list" BkColor2="default" BoldHead="true" Border="Flat" Bottom="194" CellMoving="TRUE" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="158" Id="grd_list" InputPanel="FALSE" Left="5" LineColor="user20" LineType="ExHORZ" OnHeadClick="grd_list_OnHeadClick" Right="973" RowHeight="20" Style="sty_grid" TabOrder="1" TabStop="true" Top="36" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="968">
			<contents>
				<format id="Default">
					<columns>
						<col fix="left" width="30"/>
						<col fix="left" width="20"/>
						<col fix="left" width="70"/>
						<col fix="left" width="80"/>
						<col fix="left" width="40"/>
						<col fix="left" width="94"/>
						<col fix="left" width="140"/>
						<col width="59"/>
						<col width="125"/>
						<col width="60"/>
						<col width="73"/>
						<col width="60"/>
						<col width="73"/>
						<col width="60"/>
						<col width="73"/>
						<col width="60"/>
						<col width="73"/>
						<col width="60"/>
						<col width="73"/>
						<col width="60"/>
						<col width="73"/>
						<col width="60"/>
						<col width="73"/>
						<col width="70"/>
						<col width="60"/>
						<col width="70"/>
						<col width="60"/>
						<col width="58"/>
						<col width="70"/>
						<col width="0"/>
						<col width="85"/>
						<col width="70"/>
						<col width="85"/>
						<col width="0"/>
						<col width="0"/>
						<col width="0"/>
						<col width="150"/>
						<col width="70"/>
						<col width="60"/>
						<col width="70"/>
						<col width="156"/>
						<col width="481"/>
						<col width="80"/>
						<col width="100"/>
						<col width="70"/>
						<col width="70"/>
						<col width="70"/>
						<col width="70"/>
					</columns>
					<head>
						<cell bkimageid="icon_grid_sel" col="0" display="text"/>
						<cell align="center" col="1" display="checkbox" edit="checkbox" font="굴림,9"/>
						<cell align="center" col="2" cursor="hand" display="text" font="굴림,9" text="진행상태"/>
						<cell align="center" col="3" cursor="hand" display="text" font="굴림,9" text="호차"/>
						<cell align="center" col="4" cursor="hand" display="text" font="굴림,9" text="경유"/>
						<cell align="center" col="5" cursor="hand" display="text" font="굴림,9" text="프로젝트"/>
						<cell align="center" col="6" cursor="hand" display="text" font="굴림,9" text="현장명"/>
						<cell align="center" col="7" cursor="hand" display="text" font="굴림,9" text="구분"/>
						<cell align="center" col="8" cursor="hand" display="text" font="굴림,9" text="출하내역"/>
						<cell align="center" col="9" cursor="hand" display="text" font="굴림,9" text="출발지1"/>
						<cell align="center" col="10" cursor="hand" display="text" font="굴림,9" text="차량1"/>
						<cell align="center" col="11" cursor="hand" display="text" font="굴림,9" text="출발지2"/>
						<cell align="center" col="12" cursor="hand" display="text" font="굴림,9" text="차량2"/>
						<cell align="center" col="13" cursor="hand" display="text" font="굴림,9" text="출발지3"/>
						<cell align="center" col="14" cursor="hand" display="text" font="굴림,9" text="차량3"/>
						<cell align="center" col="15" cursor="hand" display="text" font="굴림,9" text="출발지4"/>
						<cell align="center" col="16" cursor="hand" display="text" font="굴림,9" text="차량4"/>
						<cell align="center" col="17" cursor="hand" display="text" font="굴림,9" text="출발지5"/>
						<cell align="center" col="18" cursor="hand" display="text" font="굴림,9" text="차량5"/>
						<cell align="center" col="19" cursor="hand" display="text" font="굴림,9" text="출발지6"/>
						<cell align="center" col="20" cursor="hand" display="text" font="굴림,9" text="차량6"/>
						<cell align="center" col="21" cursor="hand" display="text" font="굴림,9" text="출발지7"/>
						<cell align="center" col="22" cursor="hand" display="text" font="굴림,9" text="차량7"/>
						<cell align="center" col="23" cursor="hand" display="text" font="굴림,9" text="배차일자"/>
						<cell align="center" col="24" cursor="hand" display="text" font="굴림,9" text="배차시간"/>
						<cell align="center" col="25" cursor="hand" display="text" font="굴림,9" text="하차일자"/>
						<cell align="center" col="26" cursor="hand" display="text" font="굴림,9" text="하차시간"/>
						<cell align="center" col="27" cursor="hand" display="text" font="굴림,9" text="지역"/>
						<cell align="center" col="28" cursor="hand" display="text" font="굴림,9" text="PM"/>
						<cell align="center" col="29" cursor="hand" display="text" font="굴림,9" text="치수"/>
						<cell align="center" col="30" cursor="hand" display="text" font="굴림,9" text="연락처"/>
						<cell align="center" col="31" cursor="hand" display="text" font="굴림,9" text="팀장"/>
						<cell align="center" col="32" cursor="hand" display="text" font="굴림,9" text="연락처"/>
						<cell align="center" col="33" cursor="hand" display="text" font="굴림,9" text="차량기사"/>
						<cell align="center" col="34" cursor="hand" display="text" font="굴림,9" text="전화번호"/>
						<cell align="center" col="35" cursor="hand" display="text" font="굴림,9" text="차량번호"/>
						<cell align="center" col="36" cursor="hand" display="text" font="굴림,9" text="차량운송정보"/>
						<cell align="center" col="37" cursor="hand" display="text" font="굴림,9" text="대표호기"/>
						<cell align="center" col="38" cursor="hand" display="text" font="굴림,9" text="BOX구분"/>
						<cell align="center" col="39" cursor="hand" display="text" font="굴림,9" text="기종"/>
						<cell align="center" col="40" cursor="hand" display="text" font="굴림,9" text="사양"/>
						<cell align="center" col="41" cursor="hand" display="text" font="굴림,9" text="호기-현장호기"/>
						<cell align="center" col="42" cursor="hand" display="text" font="굴림,9" text="배차타입"/>
						<cell align="center" col="43" cursor="hand" display="text" font="굴림,9" text="지연사유"/>
						<cell align="center" col="44" cursor="hand" display="text" font="굴림,9" text="생성자"/>
						<cell align="center" col="45" cursor="hand" display="text" font="굴림,9" text="변경일자"/>
						<cell align="center" col="46" cursor="hand" display="text" font="굴림,9" text="변경시간"/>
						<cell align="center" col="47" cursor="hand" display="text" font="굴림,9" text="변경자"/>
					</head>
					<body>
						<cell align="center" col="0" display="text" expr="currow&#32;+&#32;1"/>
						<cell align="center" bkcolor2="user22" col="1" colid="CHECK" display="checkbox" edit="checkbox"/>
						<cell align="center" bkcolor2="user22" col="2" colid="ZSTAT4" color="expr:ufn_setColor(grd_list,ZSTAT4)" combocol="CODE" combodataset="ds_zstat4" combotext="CODE_NAME" display="combo"/>
						<cell align="center" bkcolor2="user22" col="3" colid="ZKNUM" color="expr:ufn_setColor(grd_list,ZSTAT4)" display="text"/>
						<cell align="center" bkcolor2="user22" col="4" colid="ZKNUM2" color="expr:ufn_setColor(grd_list,ZSTAT4)" display="text"/>
						<cell align="center" bkcolor2="user22" col="5" colid="PSPID" color="expr:ufn_setColor(grd_list,ZSTAT4)" display="text"/>
						<cell align="left" bkcolor2="user22" col="6" colid="POST1" color="expr:ufn_setColor(grd_list,ZSTAT4)" display="text"/>
						<cell align="center" bkcolor2="user22" col="7" colid="LIFCD" color="expr:ufn_setColor(grd_list,ZSTAT4)" display="text"/>
						<cell bkcolor2="user22" col="8" colid="ZTEXT" color="expr:ufn_setColor(grd_list,ZSTAT4)" display="text"/>
						<cell align="center" bkcolor2="user22" col="9" colid="BEZEI" color="expr:ufn_setColor(grd_list,ZSTAT4)" display="text"/>
						<cell align="left" bkcolor2="user22" col="10" colid="ZTON" color="expr:ufn_setColor(grd_list,ZSTAT4)" display="text"/>
						<cell align="center" bkcolor2="user22" col="11" colid="TPLSTDT2" color="expr:ufn_setColor(grd_list,ZSTAT4)" display="text"/>
						<cell align="left" bkcolor2="user22" col="12" colid="TPLSTDTZTON2" color="expr:ufn_setColor(grd_list,ZSTAT4)" display="text"/>
						<cell align="center" bkcolor2="user22" col="13" colid="TPLSTDT3" color="expr:ufn_setColor(grd_list,ZSTAT4)" display="text"/>
						<cell align="left" bkcolor2="user22" col="14" colid="TPLSTDTZTON3" color="expr:ufn_setColor(grd_list,ZSTAT4)" display="text"/>
						<cell align="center" bkcolor2="user22" col="15" colid="TPLSTDT4" color="expr:ufn_setColor(grd_list,ZSTAT4)" display="text"/>
						<cell align="left" bkcolor2="user22" col="16" colid="TPLSTDTZTON4" color="expr:ufn_setColor(grd_list,ZSTAT4)" display="text"/>
						<cell align="center" bkcolor2="user22" col="17" colid="TPLSTDT5" color="expr:ufn_setColor(grd_list,ZSTAT4)" display="text"/>
						<cell align="left" bkcolor2="user22" col="18" colid="TPLSTDTZTON5" color="expr:ufn_setColor(grd_list,ZSTAT4)" display="text"/>
						<cell align="center" bkcolor2="user22" col="19" colid="TPLSTDT6" color="expr:ufn_setColor(grd_list,ZSTAT4)" display="text"/>
						<cell align="left" bkcolor2="user22" col="20" colid="TPLSTDTZTON6" color="expr:ufn_setColor(grd_list,ZSTAT4)" display="text"/>
						<cell align="center" bkcolor2="user22" col="21" colid="TPLSTDT7" color="expr:ufn_setColor(grd_list,ZSTAT4)" display="text"/>
						<cell align="left" bkcolor2="user22" col="22" colid="TPLSTDTZTON7" color="expr:ufn_setColor(grd_list,ZSTAT4)" display="text"/>
						<cell align="center" bkcolor2="user22" col="23" colid="ERDAT" color="expr:ufn_setColor(grd_list,ZSTAT4)" display="text" Mask="####.##.##"/>
						<cell align="center" bkcolor2="user22" col="24" colid="ERZET" color="expr:ufn_setColor(grd_list,ZSTAT4)" display="text" Mask="##:##"/>
						<cell align="center" bkcolor2="user22" col="25" colid="DPTEN" color="expr:ufn_setColor(grd_list,ZSTAT4)" display="text" Mask="####.##.##"/>
						<cell align="center" bkcolor2="user22" col="26" colid="UPTEN" color="expr:ufn_setColor(grd_list,ZSTAT4)" display="text" Mask="##:##"/>
						<cell align="center" bkcolor2="user22" col="27" colid="ZLZONE_NM" color="expr:ufn_setColor(grd_list,ZSTAT4)" display="text"/>
						<cell align="center" bkcolor2="user22" col="28" colid="ZZTEAMJ" color="expr:ufn_setColor(grd_list,ZSTAT4)" display="text"/>
						<cell align="center" bkcolor2="user22" col="29" colid="GROES" display="text"/>
						<cell align="left" bkcolor2="user22" col="30" colid="CELLP" color="expr:ufn_setColor(grd_list,ZSTAT4)" display="text"/>
						<cell align="center" bkcolor2="user22" col="31" colid="ZZTEAMJ2" color="expr:ufn_setColor(grd_list,ZSTAT4)" display="text"/>
						<cell align="left" bkcolor2="user22" col="32" colid="CELLP2" color="expr:ufn_setColor(grd_list,ZSTAT4)" display="text"/>
						<cell align="center" bkcolor2="user22" col="33" colid="NAMET" color="expr:ufn_setColor(grd_list,ZSTAT4)" combodisplayrowcnt="1" display="text"/>
						<cell align="center" bkcolor2="user22" col="34" colid="MOB_NUMBER" color="expr:ufn_setColor(grd_list,ZSTAT4)" display="text"/>
						<cell align="center" bkcolor2="user22" col="35" colid="TRAID" color="expr:ufn_setColor(grd_list,ZSTAT4)" display="text"/>
						<cell align="left" bkcolor2="user22" col="36" colid="CARINFO" color="expr:ufn_setColor(grd_list,ZSTAT4)" display="text"/>
						<cell align="center" bkcolor2="user22" col="37" colid="POSID" color="expr:ufn_setColor(grd_list,ZSTAT4)" display="text"/>
						<cell align="center" bkcolor2="user22" col="38" colid="BOX_CK" color='expr:iif(length(ds_list.getColumn(row,&quot;DDATE&quot;))&#32;&gt;&#32;0&#32;||&#32;ds_list.getColumn(row,&quot;BIGO&quot;)&#32;==&#32;&quot;1&quot;&#32;||&#32;(ds_list.getColumn(row,&quot;WERKS&quot;)&#32;==&#32;&quot;1000&quot;&#32;&amp;&amp;&#32;length(ds_list.getColumn(row,&quot;P_END&quot;))&#32;&#32;&gt;&#32;0)&#32;,&#32;&apos;red&apos;,&apos;&apos;)' combocol="CODE" combodataset="ds_box_ck_cd" combotext="CODE_NAME" display="combo"/>
						<cell align="center" bkcolor2="user22" col="39" colid="ZSPEC1" color="expr:ufn_setColor(grd_list,ZSTAT4)" display="text"/>
						<cell bkcolor2="user22" col="40" colid="ZSPEC2" color="expr:ufn_setColor(grd_list,ZSTAT4)" display="text"/>
						<cell bkcolor2="user22" col="41" colid="HOGI" color="expr:ufn_setColor(grd_list,ZSTAT4)" display="text"/>
						<cell align="center" bkcolor2="user22" col="42" colid="ZTYPE_NM" color="expr:ufn_setColor(grd_list,ZSTAT4)" display="text"/>
						<cell align="center" bkcolor2="user22" col="43" colid="ZCHAN_NM" color="expr:ufn_setColor(grd_list,ZSTAT4)" display="text"/>
						<cell align="center" bkcolor2="user22" col="44" colid="ERNAM" color="expr:ufn_setColor(grd_list,ZSTAT4)" display="text"/>
						<cell align="center" bkcolor2="user22" col="45" colid="AEDAT" display="text" Mask="####.##.##"/>
						<cell align="center" bkcolor2="user22" col="46" colid="UZEIT" display="text" Mask="##:##"/>
						<cell align="center" bkcolor2="user22" col="47" colid="AENAM" color="expr:ufn_setColor(grd_list,ZSTAT4)" display="text"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Shape BKColor="user0" Bottom="30" Height="30" Id="Shape0" Left="0" LineColor="user1" Right="978" TabOrder="2" Top="0" Type="Rectangle" Width="978"></Shape>
		<Static Align="Right" Height="20" Id="st_date" Left="6" Style="sty_lb_search" TabOrder="4" Text="배차일자&#32;" Top="5" VAlign="Middle" Width="55"></Static>
		<Calendar BindDataset="ds_cond" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="ERDAT_FM" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_erdat_fm" Left="63" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_search_ind" SundayTextColor="user35" TabOrder="3" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="5" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="95"></Calendar>
		<Static Align="Right" Height="20" Id="st_zzlifnr" Left="273" Style="sty_lb_search" TabOrder="5" Text="배차구분&#32;" Top="5" VAlign="Middle" Width="55"></Static>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="CODE" Column="ZTYPE" DataColumn="CODE_NAME" Height="20" Id="cb_ztype" InnerDataset="ds_ztype_cd" Left="329" Style="sty_ipt_search" TabOrder="6" Top="4" Width="80"></Combo>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="CODE" Column="ZLZONE" DataColumn="CODE_NAME" Height="20" Id="cb_zlzone" InnerDataset="ds_zlzone_cd" Left="605" Style="sty_ipt_search" TabOrder="8" Top="4" Width="88"></Combo>
		<Static Align="Right" Height="20" Id="st_mode" Left="549" Style="sty_lb_search" TabOrder="7" Text="지역&#32;" Top="5" VAlign="Middle" Width="55"></Static>
		<Static Align="Right" Height="20" Id="st_pjt" Left="694" Style="sty_lb_search" TabOrder="9" Text="프로젝트번호&#32;" Top="5" VAlign="Middle" Width="81"></Static>
		<Edit BindDataset="ds_cond" Border="Flat" Column="PJT" Height="20" Id="ed_pjt" ImeMode="english" Left="777" Style="sty_ipt_search" TabOrder="11" Top="5" UpperOnly="TRUE" Width="76"></Edit>
		<Button Height="18" Id="btn_pjt" ImageID="btn_icon_search" Left="854" OnClick="btn_pjt_OnClick" TabOrder="10" Text="Button0" Top="6" Width="18"></Button>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="CODE" Column="TPLST" DataColumn="CODE_NAME" Height="20" Id="cb_tplst" InnerDataset="ds_tplst_cd" Left="467" Style="sty_ipt_search" TabOrder="14" Top="4" Width="80"></Combo>
		<Static Align="Right" Height="20" Id="st_tplst" Left="410" Style="sty_lb_search" TabOrder="13" Text="출발지&#32;" Top="5" VAlign="Middle" Width="55"></Static>
		<Grid AreaSelect="TRUE" AutoEnter="TRUE" AutoFitEndLine="Hide" BindDataset="ds_detail" BkColor2="default" BoldHead="true" Border="Flat" Bottom="554" CellMoving="TRUE" ColSelect="TRUE" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="330" Id="grd_detail" InputPanel="FALSE" Left="5" LineColor="user20" LineType="ExHORZ" OnCellClick="grd_detail_OnCellClick" OnHeadClick="grd_detail_OnHeadClick" Right="973" RowHeight="20" Style="sty_grid" TabOrder="12" TabStop="true" Top="224" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="968">
			<contents>
				<format id="Default">
					<columns>
						<col fix="left" width="30"/>
						<col fix="left" width="20"/>
						<col width="80"/>
						<col width="60"/>
						<col width="50"/>
						<col width="62"/>
						<col width="60"/>
						<col width="127"/>
						<col width="75"/>
						<col width="120"/>
						<col width="70"/>
						<col width="70"/>
						<col width="70"/>
						<col width="70"/>
						<col width="70"/>
						<col width="50"/>
						<col width="140"/>
						<col width="140"/>
						<col width="120"/>
						<col width="60"/>
						<col width="60"/>
						<col width="60"/>
						<col width="70"/>
						<col width="132"/>
					</columns>
					<head>
						<cell bkimageid="icon_grid_sel" col="0" display="text"/>
						<cell align="center" col="1" display="checkbox" font="굴림,9"/>
						<cell align="center" col="2" cursor="hand" display="text" font="굴림,9" text="호기번호"/>
						<cell align="center" col="3" cursor="hand" display="text" font="굴림,9" text="BLOCK"/>
						<cell align="center" col="4" cursor="hand" display="text" font="굴림,9" text="BOX"/>
						<cell align="center" col="5" cursor="hand" display="text" font="굴림,9" text="BOX구분"/>
						<cell align="center" col="6" cursor="hand" display="text" font="굴림,9" text="기종"/>
						<cell align="center" col="7" cursor="hand" display="text" font="굴림,9" text="사양"/>
						<cell align="center" col="8" cursor="hand" display="text" font="굴림,9" text="자재번호"/>
						<cell align="center" col="9" cursor="hand" display="text" font="굴림,9" text="품명"/>
						<cell align="center" col="10" cursor="hand" display="text" font="굴림,9" text="진행상태"/>
						<cell align="center" col="11" cursor="hand" display="text" font="굴림,9" text="소요수량"/>
						<cell align="center" col="12" cursor="hand" display="text" font="굴림,9" text="기불출수량"/>
						<cell align="center" col="13" cursor="hand" display="text" font="굴림,9" text="출고예정수량"/>
						<cell align="center" col="14" cursor="hand" display="text" font="굴림,9" text="재고"/>
						<cell align="center" col="15" cursor="hand" display="text" font="굴림,9" text="단위"/>
						<cell align="center" col="16" cursor="hand" display="text" font="굴림,9" text="SPEC"/>
						<cell align="center" col="17" cursor="hand" display="text" font="굴림,9" text="SIZE"/>
						<cell col="18" display="text" font="굴림,9" text="납품업체"/>
						<cell col="19" display="text" font="굴림,9" text="자재유형"/>
						<cell col="20" display="text" font="굴림,9" text="발주유형"/>
						<cell align="center" col="21" cursor="hand" display="text" font="굴림,9" text="발주상태"/>
						<cell align="center" col="22" cursor="hand" display="text" font="굴림,9" text="담당자"/>
						<cell col="23" display="text" font="굴림,9" text="출고로그"/>
					</head>
					<body>
						<cell align="center" col="0" display="text" expr="currow&#32;+&#32;1"/>
						<cell align="center" bkcolor2="user22" col="1" colid="CHECK" display="checkbox" edit="checkbox"/>
						<cell align="center" bkcolor2="user22" col="2" colid="POSID" color="expr:iif(LFIMG&gt;JEAGO,&apos;red&apos;,&apos;default&apos;)" display="text" suppress="1"/>
						<cell align="center" bkcolor2="user22" col="3" colid="BLOCK" color="expr:iif(LFIMG&gt;JEAGO,&apos;red&apos;,&apos;default&apos;)" display="text" suppress="2"/>
						<cell align="center" bkcolor2="user22" col="4" colid="EXTWG" color="expr:iif(LFIMG&gt;JEAGO,&apos;red&apos;,&apos;default&apos;)" display="text" suppress="3"/>
						<cell align="center" bkcolor2="user22" col="5" colid="BOXCK" color="expr:iif(LFIMG&gt;JEAGO,&apos;red&apos;,&apos;default&apos;)" display="text" suppress="3"/>
						<cell align="center" bkcolor2="user22" col="6" colid="ZSPEC1" color="expr:iif(LFIMG&gt;JEAGO,&apos;red&apos;,&apos;default&apos;)" display="text" suppress="4"/>
						<cell align="left" bkcolor2="user22" col="7" colid="ZSPEC2" color="expr:iif(LFIMG&gt;JEAGO,&apos;red&apos;,&apos;default&apos;)" combocol="CODE" combodataset="ds_ekgrp_cd" combotext="CODE_NAME" display="text" suppress="4"/>
						<cell align="center" bkcolor2="user22" col="8" colid="MATNR" color="expr:iif(LFIMG&gt;JEAGO,&apos;red&apos;,&apos;default&apos;)" display="text"/>
						<cell align="left" bkcolor2="user22" col="9" colid="MATNR_NM" color="expr:iif(LFIMG&gt;JEAGO,&apos;red&apos;,&apos;default&apos;)" display="text"/>
						<cell align="center" bkcolor2="user22" col="10" colid="ZSTAT4" color="expr:iif(LFIMG&gt;JEAGO,&apos;red&apos;,&apos;default&apos;)" combocol="CODE" combodataset="ds_zstat4" combotext="CODE_NAME" display="combo"/>
						<cell align="right" bkcolor2="user22" col="11" colid="ERFMG" color="expr:iif(LFIMG&gt;JEAGO,&apos;red&apos;,&apos;default&apos;)" display="number" Mask="expr:iif(ERFMG&#32;&gt;&#32;0&#32;,&apos;#,##0.000&apos;,&apos;&apos;)"/>
						<cell align="right" bkcolor2="user22" col="12" colid="ENMNG" color="expr:iif(LFIMG&gt;JEAGO,&apos;red&apos;,&apos;default&apos;)" display="number" Mask="expr:iif(ENMNG&#32;&gt;&#32;0&#32;,&apos;#,##0.000&apos;,&apos;&apos;)"/>
						<cell align="right" bkcolor2="user22" bkimagealign="left" bkimageid="expr:iif(ZSTAT4==&apos;3&apos;,&apos;&apos;,&apos;icon_grid_edit&apos;)" col="13" colid="LFIMG" color="expr:iif(LFIMG&gt;JEAGO,&apos;red&apos;,&apos;default&apos;)" display="number" edit="expr:iif(ZSTAT4==&apos;3&apos;,&apos;none&apos;,&apos;normal&apos;)" Mask="expr:iif(LFIMG&#32;&gt;&#32;0&#32;,&apos;#,##0.000&apos;,&apos;&apos;)"/>
						<cell align="right" bkcolor2="user22" col="14" colid="JEAGO" color="expr:iif(LFIMG&gt;JEAGO,&apos;red&apos;,&apos;default&apos;)" display="number" Mask="expr:iif(JEAGO&#32;&gt;&#32;0,&#32;&apos;#,##0.000&apos;,&apos;&apos;)"/>
						<cell align="center" bkcolor2="user22" col="15" colid="VRKME" color="expr:iif(LFIMG&gt;JEAGO,&apos;red&apos;,&apos;default&apos;)" display="text"/>
						<cell bkcolor2="user22" col="16" colid="SPEC" color="expr:iif(LFIMG&gt;JEAGO,&apos;red&apos;,&apos;default&apos;)" display="text"/>
						<cell align="left" bkcolor2="user22" col="17" colid="ZSIZE" color="expr:iif(LFIMG&gt;JEAGO,&apos;red&apos;,&apos;default&apos;)" display="text"/>
						<cell col="18" colid="NAME1" color="expr:iif(LFIMG&gt;JEAGO,&apos;red&apos;,&apos;default&apos;)" display="text"/>
						<cell align="center" col="19" colid="MTART" color="expr:iif(LFIMG&gt;JEAGO,&apos;red&apos;,&apos;default&apos;)" display="text"/>
						<cell align="center" col="20" colid="SBDKZ" color="expr:iif(LFIMG&gt;JEAGO,&apos;red&apos;,&apos;default&apos;)" display="text"/>
						<cell align="center" bkcolor2="user22" col="21" colid="STATE" color="expr:iif(LFIMG&gt;JEAGO,&apos;red&apos;,&apos;default&apos;)" combocol="CODE" combodataset="ds_state" combotext="CODE_NAME" display="combo"/>
						<cell align="center" bkcolor2="user22" col="22" colid="EKGRP" combocol="CODE" combodataset="ds_ekgrp_cd" combotext="CODE_NAME" display="combo"/>
						<cell col="23" colid="ZLOG3" color="expr:iif(LFIMG&gt;JEAGO,&apos;red&apos;,&apos;default&apos;)" display="text"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Calendar BindDataset="ds_cond" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="ERDAT_TO" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_erdat_to" Left="176" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_search_ind" SundayTextColor="user35" TabOrder="16" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="5" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="95"></Calendar>
		<Static Align="Center" Border="None" Color="user7" Font="굴림,9" Height="20" Id="Static8" Left="158" TabOrder="17" Text="~" Top="6" VAlign="Middle" Width="16"></Static>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_normal" ImageID="btn_sub_05" Left="881" LeftMargin="12" OnClick="common_OnClick" Style="sty_btn" TabOrder="18" Text="레이아웃&#32;저장" Top="6" Transparent="TRUE" Width="87"></Button>
		<FileDialog Bottom="20" Height="24" Id="fdg_con_" Left="-4" Right="20" TabOrder="5" Top="-4" Width="24"></FileDialog>
		<File Bottom="20" Height="24" Id="fil_con" Left="24" Right="48" TabOrder="5" Top="-4" Width="24"></File>
	</Form>
	<Script><![CDATA[﻿﻿﻿﻿﻿﻿/*
 ******************************************************************************************
 * 기      능   : 
 * 작  성  자   : 
 * 작성  일자   : 
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
#include "LIB::commons.js";	// 공통 스크립트 
//=========================================================================================
// [ PART 1 ]
// Form에서 사용될 전역변수를 선언
// FORM에서 사용되는 전역변수는 대문자로 작성하며, F_XXX 의 형태를 갖도록 한다. 
//=========================================================================================
var F_ROW = 0;
var arr = split(G_ORG_USER_INFO, "^", true);
var org_id = arr[0];
var in_use = false;


var fv_objFil;
var strTemp = '';
var fv_url = "";		
var fv_formatContents;
//=========================================================================================
// [ PART 2 ]
// Form Loading / Unloading 시 작업 정의
//=========================================================================================
function fn_OnLoadCompleted(obj) 
{
	// Form 로드 이벤트 맨 첫줄에 기술 
	gfn_initForm(true);

    // 코드 DataSet 가져오기
    var codeArr = ["10"];
    var dsObjArr = [ds_ekgrp_cd];
    var addTypeArr = [G_CODE_NONE];
    gfn_searchCommCode(codeArr, dsObjArr, addTypeArr,true);

	// 현재 조회 일자 설정 
	cal_erdat_fm.value = gfn_getCurrDate();
	cal_erdat_to.value = gfn_getAfterDate(cal_erdat_fm.value, 0);


	tit_clearActionInfo();
	tit_addSearchActionInfo("mm05:MM0501001A_S2");
	
	tit_callService(
        ""
        , ""
        , ""
        , "ds_zlzone_cd=ds_zlzone_cd"
        , ""
        , "fn_cdAfterQuery"
        , true);

    // 엑셀 버튼 비활성화
	ufn_enableBtn("save", false);
	ufn_enableBtn("cancel", false);
	ufn_enableBtn("print", false);
	ufn_enableBtn("excel", false);
    
	gfn_showMsg("CI00007");
	
	
	fv_url = "MM0501003A";	//"WNT_grdContents"; 
    lfn_setGirdContents("grd_list", grd_list.Format);
    
    // 출하예정현황 화면에서 바로가기 버튼 클릭시 화면 로딩 처리 
    if ( isExistVar("posid", true)  && isExistVar("zknum", true))
	{
		ed_pjt.Text = posid;
		cal_erdat_fm.Text = substr(zknum, 0,8);
		cal_erdat_to.Text = substr(zknum, 0,8);
		
		fn_query();
	}
}
/********************************************************************************
* 기      능   : 공통코드가 조회된 후의 Callback 함수 
********************************************************************************/
function fn_completeInit(sCode, sDsObj, sCodeType) 
{
	//  배차구분
	cb_ztype.Index = 0;
	//  출발지
	cb_tplst.Index = 0;
	//  지역
	cb_zlzone.Index = 0;
	//  BOX
	btn_div.cb_box.Index = 0;

}
/********************************************************************************
* 기      능   : form UnloadCompleted 
********************************************************************************/
function fn_OnUnloadCompleted(obj) 
{
	return gfn_isFormUnload(obj);
}
//=========================================================================================
// [ PART 3 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,form닫기)
//=========================================================================================
/********************************************************************************
* 기      능   : 조회 
********************************************************************************/
function fn_query() 
{
    // Message 영역 초기화
	global.FRM_BOTTOM.img_msgType.imageId = "";
	global.FRM_BOTTOM.st_msg.value = "";
	
	if (in_use) return;
	
	if (length(ed_pjt.value) > 0 )
	{
		tit_clearActionInfo();
		// 필수 입력 항목 체크 
		if ( gfn_isNull(cal_erdat_fm, true) ) {
			gfn_showMsg("CW00001","배차일자 시작");
			return;
		}
		// 필수 입력 항목 체크 
		if ( gfn_isNull(cal_erdat_to, true) ) {
			gfn_showMsg("CW00001","배차일자 종료");
			return;
		}

		tit_clearActionInfo();
		tit_addSearchActionInfo("mm05:MM0501003A_S2");
		//tit_addSearchActionInfo("mm05:MM0501003A_S1");
	}
	else
	{
		// 필수 입력 항목 체크 
		if ( gfn_isNull(cal_erdat_fm, true) ) {
			gfn_showMsg("CW00001","배차일자 시작");
			return;
		}
		// 필수 입력 항목 체크 
		if ( gfn_isNull(cal_erdat_to, true) ) {
			gfn_showMsg("CW00001","배차일자 종료");
			return;
		}
		var maxdate = gfn_getAfterDate(cal_erdat_fm.value, 15);
		var message_arg = ["조회기간","15일"];
		if (cal_erdat_to > maxdate)
		{
			gfn_showAlert("CW00133",message_arg);
			return;
		}

		tit_clearActionInfo();
		tit_addSearchActionInfo("mm05:MM0501003A_S1");
	}
	
	
	grd_list.SetCellProp("head", 1, "Text", 0);
	grd_detail.SetCellProp("head", 1, "Text", 0);
	
	in_use = true;
	// 상세 자재 초기화
	if (ds_detail.rowcount > 0) 
	{
		ds_detail.ClearData();
	}
	
	tit_callService(
		""
		, ""
		, "ds_cond=ds_cond"
		, "ds_list=ds_list"
		, ""
		, "fn_afterQuery"
		, true);
}

/********************************************************************************
* 기      능   : 닫기  
********************************************************************************/
function fn_close() 
{
	close();
}

/********************************************************************************
* 기      능   : 액셀  
********************************************************************************/
function fn_excel() 
{
	// Excel Export 
	gfn_exportExcel(grd_list,G_USER_ID);
}

/********************************************************************************
* 기      능   : 운송계획 변경 
********************************************************************************/
function fn_save() 
{
	// ZTRANS가 'A'인경우 현대택배에 연락
	if (ds_list.GetColumn(ds_list.row,"ZTRANS") == "A")
	{
		gfn_showAlert("CW00168");
		return;
	}
	
	//  ZLET002,3,4,17,이외의 데이터는 현장직투입으로 수정불가.
	// if (length(ds_list.GetColumn(ds_list.row,"TABNM")) = 0)
	// {
		// gfn_showAlert("CW00169");
		// return;
	// }	
	
	var arg = "fa_zknum=" + quote(grd_list.GetCellValue(ds_list.row,grd_list.GetBindCellIndex("body","ZKNUM")));
	arg += " fa_zknum2=" + quote(grd_list.GetCellValue(ds_list.row,grd_list.GetBindCellIndex("body","ZKNUM2")));
	arg += " fa_pspid=" + quote(grd_list.GetCellValue(ds_list.row,grd_list.GetBindCellIndex("body","PSPID")));
	arg += " fa_tabnm=" + quote(ds_list.GetColumn(ds_list.row,"TABNM"));
	
	// 배차계획 변경창
	var result = null;
	result = gfn_openPopup("MM0501003B", true, arg);
	
	// 저장후 재조회
	if (result != null && result > 0 ) 
	{
		fn_query();
	}
}

/********************************************************************************
* 기      능   : 취소 (기존 데이터의 취소 flag update 및 취소사유 입력)  
********************************************************************************/
function fn_cancel() 
{
	//  납푸문서, 출고전기가 있으면 취소불가
	switch (ds_list.GetColumn(ds_list.row,"ZSTAT"))
	{
		case '2':
			gfn_showAlert("CW00171","납품문서 내역");
			return;
			break;
		case '3':
			gfn_showAlert("CW00171","출고전기 내역");
			return;
			break;
		default : break;
	}

	// ZTRANS가 'A'인경우 현대택배에 연락
	if (ds_list.GetColumn(ds_list.row,"ZTRANS") == "A")
	{
		gfn_showAlert("CW00168");
		return;
	}
	
	//  ZLET002,3,4,17,이외의 데이터는 현장직투입으로 수정불가.
	// if (length(ds_list.GetColumn(ds_list.row,"TABNM")) = 0)
	// {
		// gfn_showAlert("CW00169");
		// return;
	// }
	
	var arg = "fa_zknum=" + quote(grd_list.GetCellValue(ds_list.row,grd_list.GetBindCellIndex("body","ZKNUM")));
	arg += " fa_zknum2=" + quote(grd_list.GetCellValue(ds_list.row,grd_list.GetBindCellIndex("body","ZKNUM2")));
	arg += " fa_tabnm=" + quote(ds_list.GetColumn(ds_list.row,"TABNM"));
	
	// 취소사유 입력창
	var result = null;
	result = gfn_openPopup("MM0501003C", true, arg);
	
	// 취소후 재조회
	if (result != null && result > 0 ) 
	{
		fn_query();
	}
}

/********************************************************************************
* 기      능   : 엑셀출력
********************************************************************************/
function fn_excel() 
{
	// 변경 입력창
	gfn_openPopup("MM0501003B", true, arg);
}

/********************************************************************************
* 기      능   :  출하지시서 출력
********************************************************************************/
function fn_print() 
{
	if(in_use) return;
    ds_list.fireevent = false;
	gfn_copyDs(ds_list,ds_list_0,"CHECK=1");
    ds_list.fireevent = true;
    
	if (ds_list_0.rowcount < 1) {
		gfn_showAlert("CW00116","출력 대상을");
		return;
	}
	
	var fa_zknum1 = "";
	var fa_zknum2 = "";
	var gubn = "N";
	if (gfn_getCurrDate() > "20100422")
	{
		gubn = "Y";
	}
	
	if (ds_list_0.rowcount > 0) 
	{
		fa_zknum1 += "AND T3.ZKNUM IN (";
		fa_zknum2 += "AND T7.ZKNUM IN (";

		for (var i =0; i < ds_list_0.rowcount ; i++)
		{
			if (i == 0)
			{
				fa_zknum1 +=  "'"+ds_list_0.GetColumn(i,"ZKNUM")+"'";
				fa_zknum2 +=  "'"+ds_list_0.GetColumn(i,"ZKNUM")+"'";
			 } 
			 else if (i == ds_list_0.rowcount-1) 
			 {
				 fa_zknum1 +=  ",'"+ds_list_0.GetColumn(i,"ZKNUM")+"'";
				 fa_zknum2 +=  ",'"+ds_list_0.GetColumn(i,"ZKNUM")+"'";
			}
			else 
			{
				fa_zknum1 +=  ",'"+ds_list_0.GetColumn(i,"ZKNUM")+"'";
				fa_zknum2 +=  ",'"+ds_list_0.GetColumn(i,"ZKNUM")+"'";
			}
			
			if (ds_list_0.GetColumn(i,"AEDAT") <= "20100422" )
			{
				gubn = "N";
			}
		}
		fa_zknum1 += ")";
		fa_zknum2 += ")";
	}
	
	in_use = true;
	tit_clearActionInfo();
	tit_addSearchActionInfo("mm05:MM0501003A_S4");
	
	tit_callService(
		""
		, ""
		, ""
		, "ds_rlist=ds_rlist"
		, "ZKNUM1="+quote(fa_zknum1)+" ZKNUM2="+quote(fa_zknum2)+" GUBN="+quote(gubn)
		, "fn_afterPrintQuery"
		, true);	
}

//=========================================================================================
// [ PART 4]
// Callback 함수 정의 : callback 함수명은 메인 함수의 fn_xxxx() 에서 xxxx 부분은 fn_afterXXXX()
// 형태가 되도록 작성 
//=========================================================================================
/********************************************************************************
* 기      능   : 조회 Callback  
********************************************************************************/
function fn_afterQuery(errCode, errMsg) 
{
	in_use = false;
    // 조회 결과가 있으면 엑셀 버튼 활성화
	if ( ds_list.rowCount() > 0 ) 
	{
		ufn_enableBtn("save", true);
		ufn_enableBtn("cancel", true);
		ufn_enableBtn("print", true);
		ufn_enableBtn("excel", true);
		
		gfn_showMsg("CI00002", ds_list.rowCount() + "");
		btn_div.cb_box.Index = 0;
		// 전기일자 입력
		btn_div.cal_budat.value = gfn_getCurrDate();//cal_erdat_to.value;
		
		ds_list_OnCellPosChanged(ds_list,0);
	} 
	else 
	{
		ufn_enableBtn("excel", false);
		gfn_showMsg("CW00010");
	}
}

/********************************************************************************
* 기      능   : Callback  
********************************************************************************/
function fn_cdAfterQuery(errCode, errMsg) 
{
	ds_zlzone_cd.insertRow(0);
	ds_zlzone_cd.setColumn(0, "CODE", "");
	ds_zlzone_cd.setColumn(0, "CODE_NAME", "- 전 체 -");
	//  지역
	cb_zlzone.Index = 0;
}

/********************************************************************************
* 기      능   : 인쇄 Callback  
********************************************************************************/
function fn_afterPrintQuery() 
{
	in_use = false;
	// tit_showDS(ds_rlist);
	// UbiReport Call
	Dialog("MM05::MM0501003D.xml","", -1, -1, "Resize=true");
}

/********************************************************************************
* 기      능   : 상세조회 Callback  
********************************************************************************/
function fn_afterDetailQuery(errCode, errMsg) 
{
	in_use = false;
   // 조회 결과 > 0 && 출하가능이면은 버튼 활성화
	if ( ds_list.rowCount() > 0 ) 
	{
		gfn_showMsg("CI00002", ds_detail.rowCount() + "");
		btn_div.btn_del.Enable = true;
		if (ds_list.GetColumn(ds_list.row,"TABNM") > "")
		{
			btn_div.btn_chulgo.Enable = true;
			btn_div.btn_cancel.Enable = true;
			cb_box_OnChanged();
		}
		else
		{
			btn_div.btn_chulgo.Enable = false;
			btn_div.btn_cancel.Enable = false;
		}
	} 
	else 
	{
		gfn_showMsg("CW00010");
	}
}

/********************************************************************************
* 기      능   : 아이템 삭제 Callback  
********************************************************************************/
function fn_afterItemDel(errCode, errMsg) 
{
	if ( errCode != 0 ) 
	{
		gfn_showMsg("CE00001");
	} 
	else 
	{
		gfn_showMsg("CI00003");
		ufn_DetailQuery();
	}
}

//=========================================================================================
// [ PART 5 ]
// Detail Process Event 정의 ( User Define function )
// 사용자 정의 함수는 ufn_xxxx() 형태로 작성 
//=========================================================================================
/********************************************************************************
* 기      능   : 리스트의 폰트 색깔 처리
********************************************************************************/
function ufn_setColor(obj,stat4)
{
	cValue = decode(stat4,'1','default','2','green','3','blue');
	//선택된 로우의 Font Color
	obj.SelColor = cValue;
	//Grid의 Font Color
	return cValue;
}

/********************************************************************************
* 기      능   : 상세정보 표시
********************************************************************************/
function ufn_DetailQuery() 
{
	// detail 조회
	ds_subcond.SetColumn(0,"ZKNUM",grd_list.GetCellValue(ds_list.row,grd_list.GetBindCellIndex("body","ZKNUM")));
	ds_subcond.SetColumn(0,"ZKNUM2",grd_list.GetCellValue(ds_list.row,grd_list.GetBindCellIndex("body","ZKNUM2")));
	ds_subcond.SetColumn(0,"TPLST",ds_list.GetColumn(ds_list.row,"TPLST"));
//	alert(substr(ds_list.GetColumn(ds_list.row,"PSPID"),6,2));
 
 // JQPR 현장도 프로젝트단위로 조회 신종길 kj 요청 2016.09.29 조영욱
 	if (substr(ds_list.GetColumn(ds_list.row,"PSPID"),6,2) = 'NC' || 
	    substr(ds_list.GetColumn(ds_list.row,"PSPID"),6,2) = 'NS' ||
	    substr(ds_list.GetColumn(ds_list.row,"PSPID"),0,1) = 'Q')
	{
		ds_subcond.SetColumn(0,"PSPID",substr(ds_list.getColumn(ds_list.row,"PSPID"),0,7));
	} else{
		ds_subcond.SetColumn(0,"PSPID",ds_list.GetColumn(ds_list.row,"PSPID"));
	}

	tit_clearActionInfo();
	tit_addSearchActionInfo("mm05:MM0501003A_S3");
	tit_callService(
		""
		, ""
		, "ds_subcond=ds_subcond"
		, "ds_detail=ds_detail ds_subcond=ds_subcond"
		, ""
		, "fn_afterDetailQuery"
		, true);
}

/********************************************************************************
* 기      능   : item 삭제 (ZLET017,ZLET004)
********************************************************************************/
function ufn_DelItem(obj)
{
	ds_detail.fireevent = false;

	gfn_copyDs(ds_detail,ds_detail_0,"CHECK=1");
	
	if (length(ds_subcond.GetColumn(0,"BOX")) > 0) 
	{
		ds_detail.Filter("EXTWG ==" + quote(ds_subcond.GetColumn(0,"BOX")));
	} 
	else
	{
		ds_detail.UnFilter();
	}
	ds_detail.fireevent = true;
	
	if (ds_detail_0.rowcount < 1 )
	{
		gfn_showAlert("CW00013");
		return;
	}
	
	if (length(ds_list.GetColumn(ds_list.row,"TABNM")) > 0) 
	{
		for (var i = 0; i < ds_detail_0.rowcount ; i++)
		{
	
			switch (ds_detail_0.GetColumn(i,"ZSTAT4"))
			{
				case '2':
					gfn_showAlert("CW00171","납품문서");
					return;
					break;
				case '3':
					gfn_showAlert("CW00171","출고전기");
					return;
					break;
				default : break;
			}
		}
	}
	// 자재 삭제시 배차 취소로 변경 요청후 취소함 (정병기)
	// if (ds_detail.rowcount == ds_detail_0.rowcount)
	// {
		// if (!gfn_showConfirm("CI00022")) return;
		// fn_cancel();
		// return;
	// }
	// else
	// {
		// if (!gfn_showConfirm("CI00015","선택된 자재")) return;
	// }
	
	if (!gfn_showConfirm("CI00015","선택된 자재")) return;
	
	tit_clearActionInfo();
	if (length(ds_list.GetColumn(ds_list.row,"TABNM")) > 0) 
	{
		tit_addMultiActionInfo("mm05:MM0501003A_U1");
		tit_addMultiActionInfo("mm05:MM0501003A_U4");
	}
	else
	{
		tit_addMultiActionInfo("mm05:MM0501003A_U7");
	}
	
	
	tit_callService(
		""
		, ""
		, "ds_detail_0=ds_detail_0"
		, ""
		, ""
		, "fn_afterItemDel"
		, "");
}

//=========================================================================================
// [ PART 6 ]
// component Event 정의 : 각 Component 별 이벤트 
//=========================================================================================
/********************************************************************************
* 기      능   : 상단 그리드 head 선택
********************************************************************************/
function grd_list_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
{
	if ( nCell == 0 ) 
	{
		// 그리드 표시할 컬럼 선택 
		gfn_selectGridCol(obj,true);
	} 
	else if ( nCell == 1 )
	 {
		// 그리드 표시할 컬럼 선택 
		gfn_selectAllGrid2(obj,1,1,true);
	} 
	else 
	{
		// 그리드 정렬 처리 
		gfn_multiSortGrid(obj, false, 2);
	}
}

/********************************************************************************
* 기      능   : 하단 그리드 head 선택
********************************************************************************/
function grd_detail_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
{
	if ( nCell == 0 ) 
	{
		// 그리드 표시할 컬럼 선택 
		gfn_selectGridCol(obj,true);
	} 
	else if ( nCell == 1 ) 
	{
		//  전체 선택 해제
		gfn_selectAllGrid2(obj,1,1,true);
	} 
	else 
	{
		// 그리드 정렬 처리 
		//gfn_multiSortGrid(obj, false, 2);
		gfn_sortGrid(obj,nCell);
	}
}

/********************************************************************************
* 기      능   : 원프로젝트 팝업
********************************************************************************/
function btn_pjt_OnClick(obj)
{
	var arg = "pjt="+quote(ed_pjt.value);
	gfn_openPopup("CS9601002A",true,arg);
}

/********************************************************************************
* 기      능   : 상단그리드의 위치 변경
********************************************************************************/
function ds_list_OnCellPosChanged(obj,nOldRow,nRow)
{
	if (ds_list.rowcount < 1) return;

	// 체크한 자재에 대한 변경확인
	ds_list.fireevent = false;
	var ch_count = 0;
	
	for (var i = 0; i < ds_detail.rowcount ; i++)
	{
		if(ds_detail.GetColumn(i, "CHECK") == "1")
		{
			ch_count++;
		}
	}
	
	if (ch_count > 0) 
	{
		if (!gfn_showConfirm("CI00020")) 
		{
			obj.Row = nOldRow;
			ds_list.fireevent  = true;
			return;
		}
	}
	ds_list.fireevent = true;	
	// detail 조회
	ufn_DetailQuery();	
}

/********************************************************************************
* 기      능   :  선택박스 변경
********************************************************************************/
function cb_box_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{ 
	ds_detail.fireevent = false;
	if (length(ds_subcond.GetColumn(0,"BOX")) > 0) 
	{
		ds_detail.Filter("EXTWG ==" + quote(ds_subcond.GetColumn(0,"BOX")));
	} 
	else
	{
		ds_detail.UnFilter();
	}
	ds_detail.fireevent = true;
}

/********************************************************************************
* 기      능   :  하단그리드의  정보변경 - MulitiSelect = false
********************************************************************************/
function grd_detail_OnCellClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
	grd_detail.SetCellProp("body",1,"edit","checkbox");

	if (GetKeyState("Shift"))
	{
		ds_detail.FireEvent = false;

		if(nRow >= F_ROW )
		{
			for(F_ROW;F_ROW<=nRow;F_ROW++)
			{
				// if (ds_detail.GetColumn(F_ROW,"CHECK") == "1")
				// {
					// ds_detail.SetColumn(F_ROW,"CHECK","0");
				// }
				// else
				// {
					ds_detail.SetColumn(F_ROW,"CHECK","1");
				// }
			}
		} 
		else 
		{
			for(F_ROW;F_ROW>=nRow;F_ROW--)
			{ 
				// if (ds_detail.GetColumn(F_ROW,"CHECK") == "1")
				// {
					// ds_detail.SetColumn(F_ROW,"CHECK","0");
				// }
				// else
				// {
					ds_detail.SetColumn(F_ROW,"CHECK","1");
				// }
			}			
		}

		ds_detail.FireEvent = true;

		grd_detail.SetCellProp("body",1,"edit","none");
	}

	grd_detail.SetCellProp("body",1,"edit","checkbox");
	F_ROW = nRow;	
}

/********************************************************************************
* 기      능   :  그룹 선택 처리 - MulitiSelect = true
********************************************************************************/
function grd_detail_OnKeyDown(obj,nChar,bShift,bCtrl,bAlt,nLLParam,nHLParam)
{
	if ( GetKeyState("Shift") OR GetKeyState("Ctrl") )
	{
		ds_detail.fireEvent = false;
		
		for(var i=0;i<=ds_detail.rowcount();i++)
		{
			if(ds_detail.GetSelect(i))
			{ 
				ds_detail.setColumn(i,"check","1");
			}
		}
		
		ds_detail.fireEvent = true;
	}
}


/********************************************************************************
* 기      능   :  출고수량 변경시 데이터 체크
********************************************************************************/

function ds_detail_OnCellPosChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{
    // Message 영역 초기화
	global.FRM_BOTTOM.img_msgType.imageId = "";
	global.FRM_BOTTOM.st_msg.value = "";

	if ( strColumnID == "LFIMG") 
	{
			obj.FireEvent = false;
		    var meval = toNumber(obj.GetColumn(nRow,"ERFMG")) - toNumber(obj.GetColumn(nRow,"ENMNG"));

			if ( ds_list.GetOrgColumn(nRow,"LFIMG") == varNewValue ) {
    			obj.SetColumn(nRow,"CHECK", "0");
				obj.FireEvent = true;
				return;
			}
			else if ( toNumber(varNewValue) > toNumber(meval) || toNumber(varNewValue) <= 0)
			{
			   var arr = ["출고 예정수량은 0 이상의 값으로", "소요수량과 기불출수량의 차"];
			   gfn_showAlert("CW00015",arr);
			   obj.SetColumn(nRow, "LFIMG", varOldValue);
			   obj.SetColumn(nRow,"CHECK", "0");
	 		   obj.FireEvent = true;
			   return;
			}

			obj.FireEvent = true;

			obj.SetColumn(nRow, "CHECK", "1");
	}	
}



/********************************************************************************
* 기      능   :  출고전기
********************************************************************************/
function ufn_Chulha(obj)
{
    ds_detail.fireevent = false;
	gfn_copyDs(ds_detail,ds_detail_0,"CHECK=1");
    ds_detail.fireevent = true;
    
    
	if (ds_detail_0.rowcount < 1) {
		gfn_showAlert("CW00116","출고 대상을");
		return;
	}

	for (var i = 0; i < ds_detail_0.rowcount ; i++)
	{

		switch (ds_detail_0.GetColumn(i,"ZSTAT4"))
		{
			case '2':
				gfn_showAlert("CW00171","납품문서");
				return;
				break;
			case '3':
				gfn_showAlert("CW00171","출고전기");
				return;
				break;
			default : break;
		}
	}
	
	// 필수 입력 항목 체크 
	if ( gfn_isNull(btn_div.cal_budat, true) ) {
		gfn_showMsg("CW00001","전기일자");
		return;
	}	
	
	//gfn_copyDs(ds_detail,ds_chulha,"");
	ds_chulha.ClearData();
	for (var i = 0; i < ds_detail_0.rowcount; i++)
	{
		ds_chulha.AddRow();

		ds_chulha.SetColumn(i,"ZBELN",ds_detail_0.GetColumn(i,"ZBELN"));
		ds_chulha.SetColumn(i,"ZOSNR",ds_detail_0.GetColumn(i,"ZOSNR"));
		if (substr(ds_detail_0.GetColumn(i,"PSPID"),0,1) == "Q"){
			ds_chulha.SetColumn(i,"PSPID",ds_detail_0.GetColumn(i,"POSID"));
		}
		else {
			ds_chulha.SetColumn(i,"PSPID",ds_detail_0.GetColumn(i,"PSPID"));
		}
		ds_chulha.SetColumn(i,"PSPNR",ds_detail_0.GetColumn(i,"PSPNR"));
		ds_chulha.SetColumn(i,"POSID3",ds_detail_0.GetColumn(i,"POSID3"));
		ds_chulha.SetColumn(i,"BUDAT",btn_div.cal_budat.value);
		ds_chulha.SetColumn(i,"RSNUM",ds_detail_0.GetColumn(i,"RSNUM"));
		ds_chulha.SetColumn(i,"RSPOS",ds_detail_0.GetColumn(i,"RSPOS"));
		ds_chulha.SetColumn(i,"MATNR",ds_detail_0.GetColumn(i,"MATNR"));
		ds_chulha.SetColumn(i,"LFIMG",ds_detail_0.GetColumn(i,"LFIMG"));
		ds_chulha.SetColumn(i,"ERFME",ds_detail_0.GetColumn(i,"ERFME"));
		ds_chulha.SetColumn(i,"MBLNR",ds_detail_0.GetColumn(i,"MBLNR"));
		ds_chulha.SetColumn(i,"AENAM", org_id);
		ds_chulha.SetColumn(i,"ZRTNVAL",ds_detail_0.GetColumn(i,"ZRTNVAL"));
		ds_chulha.SetColumn(i,"ZRTNMSG",ds_detail_0.GetColumn(i,"ZRTNMSG"));
	}
	
   //tit_showDs(ds_chulha,false);

	if (!gfn_showConfirm("CI00014","출고")) return;

	// 저장 처리 
	tit_callService(
        "MM0501003A_ACT"
        , "save"
        , "ds_chulha=ds_chulha:A"
        , "ds_error=ds_error"
        , ""
        , "fn_afterSave");	
}

/********************************************************************************
* 기      능   :  출고전기 취소
********************************************************************************/
function ufn_Cancel(obj)
{
    ds_detail.fireevent = false;
	gfn_copyDs(ds_detail,ds_detail_0,"CHECK=1");
    ds_detail.fireevent = true;
    
    
	if (ds_detail_0.rowcount < 1) 
	{
		gfn_showAlert("CW00116","취소 대상을");
		return;
	}

	for (var i = 0; i < ds_detail_0.rowcount ; i++)
	{
		// 상태
		switch (ds_detail_0.GetColumn(i,"ZSTAT4"))
		{
			case '1':
				gfn_showAlert("CW00171","운송계획");
				return;
				break;
			default : break;
		}
		// 다른 호차 운송계획의 정보존재
		if (ds_detail_0.GetColumn(i,"ZGI") > '')
		{
			gfn_showAlert("CW00171",ds_detail_0.GetColumn(i,"ZGI"));
			return;
		}
	}
	
	// 필수 입력 항목 체크 
	if ( gfn_isNull(btn_div.cal_budat, true) ) {
		gfn_showMsg("CW00001","전기일자");
		return;
	}	
	
	//gfn_copyDs(ds_detail,ds_chulha,"");
	ds_cancel.ClearData();
	for (var i = 0; i < ds_detail_0.rowcount; i++)
	{
		ds_cancel.AddRow();

		ds_cancel.SetColumn(i,"ZBELN",ds_detail_0.GetColumn(i,"ZBELN"));
		ds_cancel.SetColumn(i,"ZOSNR",ds_detail_0.GetColumn(i,"ZOSNR"));
		ds_cancel.SetColumn(i,"RSNUM",ds_detail_0.GetColumn(i,"RSNUM"));
		ds_cancel.SetColumn(i,"RSPOS",ds_detail_0.GetColumn(i,"RSPOS"));
		ds_cancel.SetColumn(i,"BUDAT",btn_div.cal_budat.value);
		ds_cancel.SetColumn(i,"MBLNR",ds_detail_0.GetColumn(i,"VBELN7"));
		ds_cancel.SetColumn(i,"MJAHR",ds_detail_0.GetColumn(i,"MJAHR"));
		ds_cancel.SetColumn(i,"AENAM", org_id);
		ds_cancel.SetColumn(i,"ZRTNVAL",ds_detail_0.GetColumn(i,"ZRTNVAL"));
		ds_cancel.SetColumn(i,"ZRTNMSG",ds_detail_0.GetColumn(i,"ZRTNMSG"));

	}
	
//tit_showDs(ds_cancel,false);

	if (!gfn_showConfirm("CI00014","취소")) return;

	// 저장 처리 
	tit_callService(
        "MM0501003A_ACT"
        , "cancel"
        , "ds_cancel=ds_cancel:A"
        , "ds_error=ds_error"
        , ""
        , "fn_afterSave");	
}


/********************************************************************************
* 기      능   : 저장 Callback  
********************************************************************************/
function fn_afterSave(errCode, errMsg) {
	if ( errMsg == "INVALID_DATA" ) {
		gfn_showAlert("CW00182", errMsg);
		ufn_DetailQuery();
	} else if ( ds_error.rowcount() > 0 ) {
		gfn_showAlert("CE00001");
		// error 정보 표시 
		gfn_openWSErrorWin(grd_detail, ds_detail, ds_error,"CHECK");
		ufn_DetailQuery();
	} else {
		gfn_showMsg("CI00003");
		ufn_DetailQuery();
	}
}




/*  그리드 레이아웃 설정 기능    */
function lfn_existGrdContents(grdObj, grdFormat) {
    var strContents = '';    
    var cont_path = AliasToRealPath("%TOBE%") + "Cotents\\" + mid(fv_url) + "\\";    
    var rtnVal = false;
    
    grdFormat = iif(lfn_isNull(grdFormat), "Default", grdFormat);
    
    var crFileName = cont_path + fv_url + "_" + grdObj + "_" + grdFormat + ".xml";

    if (fil_con.IsExistFile(crFileName)) {
        fil_con.FileName = crFileName;
        fil_con.Open("rt");
        
        strContents = fil_con.Read();
        
        fil_con.Close();
        
        object(grdObj).Contents = strContents;
        object(grdObj).Format = iif(toUpper(grdFormat)=="DEFAULT", null, grdFormat);
        
        rtnVal = true;
    } 
    
    return rtnVal;
}

function lfn_setGirdContents(grdObj, grdFormat) {
        
	fv_objFil = fil_con;
        	
    var grdCont = object(grdObj).Contents;
    
    lfn_existGrdContents(grdObj, grdFormat);
 
   	fv_formatContents = replace(replace(grdCont, '<contents>', ''), '</contents>', '');
   	
	var arrCont = split(fv_formatContents, '<format id="', 'webstyle');
	var strPos;
	
	if (length(arrCont) > 2) {
        for (var i=1; i<length(arrCont); i++) {
            strPos = pos(arrCont[i], '"');
            
            ds_grdFormat.AddRow();
            ds_grdFormat.SetColumn(ds_grdFormat.row, "comPath", grdObj);
            ds_grdFormat.SetColumn(ds_grdFormat.row, "formatID", left(arrCont[i], strPos));
            ds_grdFormat.SetColumn(ds_grdFormat.row, "arch", '<contents>\n<format id="' + arrCont[i] + '</contents>');
        }
        
        strPos = ds_grdFormat.SearchRow("comPath==" + quote(grdObj) + " && formatID==" + quote(grdFormat));
        
        if (strPos > -1) {
            object(grdObj).Format = grdFormat;
            object(grdObj).Contents = lfn_replaceText(ds_grdFormat.GetColumn(strPos, "arch"));
        }
    }
}

function lfn_replaceText(strCont) {
    var rtnVal =strCont;
    
    rtnVal = replace(rtnVal, "&amp;", "&");
    rtnVal = replace(rtnVal, "&lt;", "<");
    rtnVal = replace(rtnVal, "&gt;", ">");
    rtnVal = replace(rtnVal, "&quot;", "\"");
    rtnVal = replace(rtnVal, "&apos;", "'");
    
    return rtnVal;
}




function lfn_rtnFormatContents(grdObj, strTxt) {
    
    if ( lfn_existGrdContents(grdObj, strTxt) ) return;

    var strPos = ds_grdFormat.SearchRow("comPath==" + quote(grdObj) + " && toUpper(formatID)==" + toUpper(quote(strTxt)));
    
    if (strPos > -1) {
        object(grdObj).Format = iif(toUpper(strTxt)=="DEFAULT", null, strTxt);
        object(grdObj).Contents = lfn_replaceText(ds_grdFormat.GetColumn(strPos, "arch"));
    }
}


function common_OnClick(obj) {
    lfn_saveGrdContents("grd_list", object("grd_list").Format);
    gfn_showInform("CW10025", "화면 레이아웃 설정이 완료되었습니다.");	

}

function lfn_saveGrdContents(grdObj, grdFormat) {
    
    var cont_path = AliasToRealPath("%TOBE%") + "Cotents\\" + mid(fv_url) + "\\";
    
    grdFormat = iif(lfn_isNull(grdFormat), "Default", grdFormat);
    
    var crFileName = cont_path + fv_url + "_" + grdObj + "_" + grdFormat + ".xml";
    fv_objFil.MakeDir(cont_path);
    
    var strBF = '';
	strBF += object(grdObj).GetCurContents();
	
	fv_objFil.FileName = crFileName;
	fv_objFil.Open("wt");
	
	fv_objFil.Write(strBF);
	fv_objFil.Close();
}


function lfn_isNull(strValue)
{
    if (strValue == null)
    {
        return true;
    }
    else
    {
        switch(toUpper(type(strValue)))
        {
            case "STRING":
                if( length(unquote(strValue)) <= 0 )
                {
                    return true;
                }
                break;
            case "ARRAY":
            case "OBJECT":
            case "BINARY":
                if( length(strValue) <= 0 )
                {
                    return true;
                }
                break;
        }
    }
    return false;
}
]]></Script>
</Window>