<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="560" Id="MM0501001A" Left="8" OnLoadCompleted="fn_OnLoadCompleted" OnUnloadCompleted="fn_OnUnloadCompleted" PidAttrib="7" Style="sty_ipt_form" Title="기간별&#32;배차계획표" ToolTipFont="Default,0" Top="8" Ver="1.0" Width="978" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_zlzone_cd">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond">
				<Contents>
					<colinfo id="ERDAT" size="255" summ="default" type="STRING"/>
					<colinfo id="GBN" size="255" summ="default" type="STRING"/>
					<colinfo id="ZLZONE" size="255" summ="default" type="STRING"/>
					<colinfo id="ZTYPE" size="255" summ="default" type="STRING"/>
					<colinfo id="PJT" size="10" summ="default" type="STRING"/>
					<colinfo id="TPLST" size="11" summ="default" type="STRING"/>
					<colinfo id="ZZACTSS" size="256" summ="default" type="STRING"/>
					<colinfo id="NAMET" size="256" summ="default" type="STRING"/>
					<colinfo id="ERDAT_TO" size="256" summ="default" type="STRING"/>
					<colinfo id="HOGI" size="256" summ="default" type="STRING"/>
					<colinfo id="ZFULLSET" size="2" summ="default" type="STRING"/>
					<colinfo id="ZTON3" size="2" summ="default" type="STRING"/>
					<record>
						<ERDAT></ERDAT>
						<ERDAT_TO></ERDAT_TO>
						<GBN></GBN>
						<HOGI></HOGI>
						<NAMET></NAMET>
						<PJT></PJT>
						<TPLST></TPLST>
						<ZFULLSET></ZFULLSET>
						<ZLZONE></ZLZONE>
						<ZTON3></ZTON3>
						<ZTYPE></ZTYPE>
						<ZZACTSS></ZZACTSS>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_tplst_cd">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME>-&#32;전&#32;체&#32;-</CODE_NAME>
					</record>
					<record>
						<CODE>1000</CODE>
						<CODE_NAME>이천</CODE_NAME>
					</record>
					<record>
						<CODE>1100</CODE>
						<CODE_NAME>천안</CODE_NAME>
					</record>
					<record>
						<CODE>9012</CODE>
						<CODE_NAME>거산</CODE_NAME>
					</record>
					<record>
						<CODE>1111</CODE>
						<CODE_NAME>기타</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ztype_cd">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME>-&#32;전&#32;체&#32;-</CODE_NAME>
					</record>
					<record>
						<CODE>1</CODE>
						<CODE_NAME>국내</CODE_NAME>
					</record>
					<record>
						<CODE>2</CODE>
						<CODE_NAME>해외</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_sum">
				<Contents>
					<colinfo id="ZCAR1" size="11" summ="default" type="INT"/>
					<colinfo id="ZCAR2" size="11" summ="default" type="INT"/>
					<colinfo id="ZCAR3" size="11" summ="default" type="INT"/>
					<colinfo id="ZCAR4" size="11" summ="default" type="INT"/>
					<colinfo id="ZTON1" size="66" summ="default" type="DECIMAL"/>
					<colinfo id="ZTON2" size="66" summ="default" type="DECIMAL"/>
					<colinfo id="ZTON3" size="66" summ="default" type="DECIMAL"/>
					<colinfo id="ZTON4" size="66" summ="default" type="DECIMAL"/>
					<record>
						<ZCAR1/>
						<ZCAR2/>
						<ZCAR3/>
						<ZCAR4/>
						<ZTON1/>
						<ZTON2/>
						<ZTON3/>
						<ZTON4/>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_zzactss">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset CanColumnChange="ds_list_OnColumnChanged" DataSetType="Dataset" Editable="True" Id="ds_list">
				<Contents>
					<colinfo id="BEZEI" size="60" summ="default" type="STRING"/>
					<colinfo id="CHECK" size="3" summ="default" type="STRING"/>
					<colinfo id="CELLP" size="30" summ="default" type="STRING"/>
					<colinfo id="CELLP2" size="30" summ="default" type="STRING"/>
					<colinfo id="DPTEN" size="24" summ="default" type="STRING"/>
					<colinfo id="ERDAT" size="24" summ="default" type="STRING"/>
					<colinfo id="ERZET" size="18" summ="default" type="STRING"/>
					<colinfo id="FLAG" size="3" summ="default" type="STRING"/>
					<colinfo id="GUBN" size="3" summ="default" type="STRING"/>
					<colinfo id="HOGI" size="1000" summ="default" type="STRING"/>
					<colinfo id="MANDT" size="9" summ="default" type="STRING"/>
					<colinfo id="MOB_NUMBER" size="100" summ="default" type="STRING"/>
					<colinfo id="NAMET" size="4000" summ="default" type="STRING"/>
					<colinfo id="POSID" size="72" summ="default" type="STRING"/>
					<colinfo id="POST1" size="120" summ="default" type="STRING"/>
					<colinfo id="PSPID" size="72" summ="default" type="STRING"/>
					<colinfo id="SPEC" size="4000" summ="default" type="STRING"/>
					<colinfo id="TRAID" size="60" summ="default" type="STRING"/>
					<colinfo id="UPTEN" size="18" summ="default" type="STRING"/>
					<colinfo id="ZCHAN" size="120" summ="default" type="STRING"/>
					<colinfo id="ZCHAN_NM" size="29" summ="default" type="STRING"/>
					<colinfo id="ZKNUM" size="36" summ="default" type="STRING"/>
					<colinfo id="ZKNUM2" size="6" summ="default" type="STRING"/>
					<colinfo id="ZLZONE" size="30" summ="default" type="STRING"/>
					<colinfo id="ZLZONE_NM" size="60" summ="default" type="STRING"/>
					<colinfo id="ZSPEC1" size="15" summ="default" type="STRING"/>
					<colinfo id="ZSPEC2" size="75" summ="default" type="STRING"/>
					<colinfo id="ZTEXT" size="120" summ="default" type="STRING"/>
					<colinfo id="ZTON" size="118" summ="default" type="STRING"/>
					<colinfo id="ZTYPE" size="6" summ="default" type="STRING"/>
					<colinfo id="ZTYPE_NM" size="14" summ="default" type="STRING"/>
					<colinfo id="ZZACTSS" size="9" summ="default" type="STRING"/>
					<colinfo id="ZZTEAMJ" size="60" summ="default" type="STRING"/>
					<colinfo id="ZZTEAMJ2" size="1000" summ="default" type="STRING"/>
					<colinfo id="ZZTEMNO" size="18" summ="default" type="STRING"/>
					<colinfo id="ZZTEMNO2" size="18" summ="default" type="STRING"/>
					<colinfo id="MSG" size="400" summ="default" type="STRING"/>
					<colinfo id="MSG1" size="400" summ="default" type="STRING"/>
					<colinfo id="AEDAT" size="24" summ="default" type="STRING"/>
					<colinfo id="UZEIT" size="18" summ="default" type="STRING"/>
					<colinfo id="SMDATE1" size="24" summ="default" type="STRING"/>
					<colinfo id="SMDATE2" size="24" summ="default" type="STRING"/>
					<colinfo id="ZQNTY" size="256" summ="default" type="STRING"/>
					<colinfo id="ZKZWI" size="22" summ="default" type="DECIMAL"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list_0">
				<Contents>
					<colinfo id="BEZEI" size="60" summ="default" type="STRING"/>
					<colinfo id="CHECK" size="3" summ="default" type="STRING"/>
					<colinfo id="CELLP" size="30" summ="default" type="STRING"/>
					<colinfo id="CELLP2" size="30" summ="default" type="STRING"/>
					<colinfo id="DPTEN" size="24" summ="default" type="STRING"/>
					<colinfo id="ERDAT" size="24" summ="default" type="STRING"/>
					<colinfo id="ERZET" size="18" summ="default" type="STRING"/>
					<colinfo id="FLAG" size="3" summ="default" type="STRING"/>
					<colinfo id="GUBN" size="3" summ="default" type="STRING"/>
					<colinfo id="HOGI" size="1000" summ="default" type="STRING"/>
					<colinfo id="MANDT" size="9" summ="default" type="STRING"/>
					<colinfo id="MOB_NUMBER" size="30" summ="default" type="STRING"/>
					<colinfo id="NAMET" size="4000" summ="default" type="STRING"/>
					<colinfo id="POSID" size="72" summ="default" type="STRING"/>
					<colinfo id="POST1" size="120" summ="default" type="STRING"/>
					<colinfo id="PSPID" size="72" summ="default" type="STRING"/>
					<colinfo id="SPEC" size="4000" summ="default" type="STRING"/>
					<colinfo id="TRAID" size="60" summ="default" type="STRING"/>
					<colinfo id="UPTEN" size="18" summ="default" type="STRING"/>
					<colinfo id="ZCHAN" size="120" summ="default" type="STRING"/>
					<colinfo id="ZCHAN_NM" size="29" summ="default" type="STRING"/>
					<colinfo id="ZKNUM" size="36" summ="default" type="STRING"/>
					<colinfo id="ZKNUM2" size="6" summ="default" type="STRING"/>
					<colinfo id="ZLZONE" size="30" summ="default" type="STRING"/>
					<colinfo id="ZLZONE_NM" size="60" summ="default" type="STRING"/>
					<colinfo id="ZSPEC1" size="15" summ="default" type="STRING"/>
					<colinfo id="ZSPEC2" size="75" summ="default" type="STRING"/>
					<colinfo id="ZTEXT" size="120" summ="default" type="STRING"/>
					<colinfo id="ZTON" size="118" summ="default" type="STRING"/>
					<colinfo id="ZTYPE" size="6" summ="default" type="STRING"/>
					<colinfo id="ZTYPE_NM" size="14" summ="default" type="STRING"/>
					<colinfo id="ZZACTSS" size="9" summ="default" type="STRING"/>
					<colinfo id="ZZTEAMJ" size="60" summ="default" type="STRING"/>
					<colinfo id="ZZTEAMJ2" size="1000" summ="default" type="STRING"/>
					<colinfo id="ZZTEMNO" size="18" summ="default" type="STRING"/>
					<colinfo id="ZZTEMNO2" size="18" summ="default" type="STRING"/>
					<colinfo id="MSG" size="400" summ="default" type="STRING"/>
					<colinfo id="MSG1" size="400" summ="default" type="STRING"/>
					<colinfo id="AEDAT" size="24" summ="default" type="STRING"/>
					<colinfo id="UZEIT" size="18" summ="default" type="STRING"/>
					<colinfo id="SMDATE1" size="24" summ="default" type="STRING"/>
					<colinfo id="SMDATE2" size="24" summ="default" type="STRING"/>
					<colinfo id="ZQNTY" size="256" summ="default" type="STRING"/>
					<colinfo id="ZKZWI" size="22" summ="default" type="DECIMAL"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list_1">
				<Contents>
					<colinfo id="BEZEI" size="60" summ="default" type="STRING"/>
					<colinfo id="CHECK" size="3" summ="default" type="STRING"/>
					<colinfo id="CELLP" size="30" summ="default" type="STRING"/>
					<colinfo id="CELLP2" size="30" summ="default" type="STRING"/>
					<colinfo id="DPTEN" size="24" summ="default" type="STRING"/>
					<colinfo id="ERDAT" size="24" summ="default" type="STRING"/>
					<colinfo id="ERZET" size="18" summ="default" type="STRING"/>
					<colinfo id="FLAG" size="3" summ="default" type="STRING"/>
					<colinfo id="GUBN" size="3" summ="default" type="STRING"/>
					<colinfo id="HOGI" size="1000" summ="default" type="STRING"/>
					<colinfo id="MANDT" size="9" summ="default" type="STRING"/>
					<colinfo id="MOB_NUMBER" size="30" summ="default" type="STRING"/>
					<colinfo id="NAMET" size="4000" summ="default" type="STRING"/>
					<colinfo id="POSID" size="72" summ="default" type="STRING"/>
					<colinfo id="POST1" size="120" summ="default" type="STRING"/>
					<colinfo id="PSPID" size="72" summ="default" type="STRING"/>
					<colinfo id="SPEC" size="4000" summ="default" type="STRING"/>
					<colinfo id="TRAID" size="60" summ="default" type="STRING"/>
					<colinfo id="UPTEN" size="18" summ="default" type="STRING"/>
					<colinfo id="ZCHAN" size="120" summ="default" type="STRING"/>
					<colinfo id="ZCHAN_NM" size="29" summ="default" type="STRING"/>
					<colinfo id="ZKNUM" size="36" summ="default" type="STRING"/>
					<colinfo id="ZKNUM2" size="6" summ="default" type="STRING"/>
					<colinfo id="ZLZONE" size="30" summ="default" type="STRING"/>
					<colinfo id="ZLZONE_NM" size="60" summ="default" type="STRING"/>
					<colinfo id="ZSPEC1" size="15" summ="default" type="STRING"/>
					<colinfo id="ZSPEC2" size="75" summ="default" type="STRING"/>
					<colinfo id="ZTEXT" size="120" summ="default" type="STRING"/>
					<colinfo id="ZTON" size="118" summ="default" type="STRING"/>
					<colinfo id="ZTYPE" size="6" summ="default" type="STRING"/>
					<colinfo id="ZTYPE_NM" size="14" summ="default" type="STRING"/>
					<colinfo id="ZZACTSS" size="9" summ="default" type="STRING"/>
					<colinfo id="ZZTEAMJ" size="1000" summ="default" type="STRING"/>
					<colinfo id="ZZTEAMJ2" size="60" summ="default" type="STRING"/>
					<colinfo id="ZZTEMNO" size="18" summ="default" type="STRING"/>
					<colinfo id="ZZTEMNO2" size="18" summ="default" type="STRING"/>
					<colinfo id="MSG" size="400" summ="default" type="STRING"/>
					<colinfo id="MSG1" size="400" summ="default" type="STRING"/>
					<colinfo id="AEDAT" size="24" summ="default" type="STRING"/>
					<colinfo id="UZEIT" size="18" summ="default" type="STRING"/>
					<colinfo id="SMDATE1" size="24" summ="default" type="STRING"/>
					<colinfo id="SMDATE2" size="24" summ="default" type="STRING"/>
					<colinfo id="ZQNTY" size="256" summ="default" type="STRING"/>
					<colinfo id="ZKZWI" size="22" summ="default" type="DECIMAL"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_sms">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_emtran">
				<Contents>
					<colinfo id="TRAN_PHONE" size="256" summ="default" type="STRING"/>
					<colinfo id="TRAN_CALLBACK" size="256" summ="default" type="STRING"/>
					<colinfo id="TRAN_MSG" size="256" summ="default" type="STRING"/>
					<colinfo id="TRAN_ETC1" size="256" summ="default" type="STRING"/>
					<colinfo id="TRAN_ETC2" size="256" summ="default" type="STRING"/>
					<colinfo id="TRAN_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN" size="3" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_emtran_0">
				<Contents>
					<colinfo id="TRAN_PHONE" size="256" summ="default" type="STRING"/>
					<colinfo id="TRAN_CALLBACK" size="256" summ="default" type="STRING"/>
					<colinfo id="TRAN_MSG" size="256" summ="default" type="STRING"/>
					<colinfo id="TRAN_ETC1" size="256" summ="default" type="STRING"/>
					<colinfo id="TRAN_ETC2" size="256" summ="default" type="STRING"/>
					<colinfo id="TRAN_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="GBN" size="3" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_tr_list">
				<Contents>
					<colinfo id="MOB_NUMBER" size="90" summ="default" type="STRING"/>
					<colinfo id="NAMET" size="105" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_tr_cond">
				<Contents>
					<colinfo id="TRAID" size="12" summ="default" type="STRING"/>
					<colinfo id="INPUTROW" size="5" summ="default" type="INT"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_zzactss_1">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME>-&#32;전체&#32;-</CODE_NAME>
					</record>
					<record>
						<CODE>01</CODE>
						<CODE_NAME>직영</CODE_NAME>
					</record>
					<record>
						<CODE>02</CODE>
						<CODE_NAME>강남</CODE_NAME>
					</record>
					<record>
						<CODE>03</CODE>
						<CODE_NAME>부산</CODE_NAME>
					</record>
					<record>
						<CODE>04</CODE>
						<CODE_NAME>대구</CODE_NAME>
					</record>
					<record>
						<CODE>05</CODE>
						<CODE_NAME>광주</CODE_NAME>
					</record>
					<record>
						<CODE>06</CODE>
						<CODE_NAME>대전</CODE_NAME>
					</record>
					<record>
						<CODE>07</CODE>
						<CODE_NAME>전주</CODE_NAME>
					</record>
					<record>
						<CODE>08</CODE>
						<CODE_NAME>강원</CODE_NAME>
					</record>
					<record>
						<CODE>09</CODE>
						<CODE_NAME>울산</CODE_NAME>
					</record>
					<record>
						<CODE>10</CODE>
						<CODE_NAME>인천</CODE_NAME>
					</record>
					<record>
						<CODE>11</CODE>
						<CODE_NAME>마창</CODE_NAME>
					</record>
					<record>
						<CODE>12</CODE>
						<CODE_NAME>제주</CODE_NAME>
					</record>
					<record>
						<CODE>13</CODE>
						<CODE_NAME>E/S</CODE_NAME>
					</record>
					<record>
						<CODE>14</CODE>
						<CODE_NAME>보수</CODE_NAME>
					</record>
					<record>
						<CODE>15</CODE>
						<CODE_NAME>주차</CODE_NAME>
					</record>
					<record>
						<CODE>16</CODE>
						<CODE_NAME>일식외주</CODE_NAME>
					</record>
					<record>
						<CODE>20</CODE>
						<CODE_NAME>중부</CODE_NAME>
					</record>
					<record>
						<CODE>21</CODE>
						<CODE_NAME>강북</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_hogi_cd">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME>-&#32;전&#32;체&#32;-</CODE_NAME>
					</record>
					<record>
						<CODE>3</CODE>
						<CODE_NAME>소형(1대)</CODE_NAME>
					</record>
					<record>
						<CODE>1</CODE>
						<CODE_NAME>소형(1~2대)</CODE_NAME>
					</record>
					<record>
						<CODE>2</CODE>
						<CODE_NAME>중형이상</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_fullset_cd">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME>-&#32;전&#32;체&#32;-</CODE_NAME>
					</record>
					<record>
						<CODE>X</CODE>
						<CODE_NAME>FULL&#32;SET</CODE_NAME>
					</record>
					<record>
						<CODE>Y</CODE>
						<CODE_NAME>FULL&#32;SET(JAMB포함)</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
		</Datasets>
		<Grid AutoFitEndLine="Hide" AutoSelect="TRUE" BindDataset="ds_list" BkColor2="default" BoldHead="true" Border="Flat" Bottom="552" CellMoving="TRUE" ColSelect="TRUE" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="504" Id="grd_list" InputPanel="FALSE" Left="4" LineColor="user20" LineType="ExHORZ" MultiSelect="TRUE" OnCellDBLClick="grd_list_OnCellDBClik" OnHeadClick="grd_list_OnHeadClick" OnKeyDown="grd_list_OnKeyDown" Right="972" RowHeight="20" Style="sty_grid" TabOrder="1" TabStop="true" Top="48" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="968">
			<contents>
				<format id="Default">
					<columns>
						<col fix="left" width="20"/>
						<col fix="left" width="20"/>
						<col width="75"/>
						<col width="58"/>
						<col width="70"/>
						<col width="58"/>
						<col width="153"/>
						<col width="125"/>
						<col width="59"/>
						<col width="70"/>
						<col width="70"/>
						<col width="70"/>
						<col width="70"/>
						<col width="73"/>
						<col width="70"/>
						<col width="71"/>
						<col width="58"/>
						<col width="82"/>
						<col width="79"/>
						<col width="82"/>
						<col width="0"/>
						<col width="79"/>
						<col width="70"/>
						<col width="72"/>
						<col width="80"/>
						<col width="400"/>
						<col width="400"/>
						<col width="80"/>
						<col width="100"/>
						<col width="70"/>
						<col width="70"/>
						<col width="70"/>
						<col width="70"/>
					</columns>
					<head>
						<cell col="0" display="checkbox"/>
						<cell align="center" bkimageid="icon_grid_sel" col="1" display="text" font="굴림,9"/>
						<cell align="center" col="2" cursor="hand" display="text" font="굴림,9" text="호차"/>
						<cell align="center" col="3" cursor="hand" display="text" font="굴림,9" text="경유"/>
						<cell align="center" col="4" cursor="hand" display="text" font="굴림,9" text="프로젝트"/>
						<cell align="center" col="5" cursor="hand" display="text" font="굴림,9" text="설치대수"/>
						<cell align="center" col="6" cursor="hand" display="text" font="굴림,9" text="현장명"/>
						<cell align="center" col="7" cursor="hand" display="text" font="굴림,9" text="출하내역"/>
						<cell align="center" col="8" cursor="hand" display="text" font="굴림,9" text="출발지"/>
						<cell align="center" col="9" cursor="hand" display="text" font="굴림,9" text="배차일자"/>
						<cell align="center" col="10" cursor="hand" display="text" font="굴림,9" text="배차시간"/>
						<cell align="center" col="11" cursor="hand" display="text" font="굴림,9" text="하차일자"/>
						<cell align="center" col="12" cursor="hand" display="text" font="굴림,9" text="하차시간"/>
						<cell align="center" col="13" cursor="hand" display="text" font="굴림,9" text="차량"/>
						<cell align="center" col="14" cursor="hand" display="text" font="굴림,9" text="운반비"/>
						<cell align="center" col="15" cursor="hand" display="text" font="굴림,9" text="설치대지역"/>
						<cell align="center" col="16" cursor="hand" display="text" font="굴림,9" text="지역"/>
						<cell align="center" col="17" cursor="hand" display="text" font="굴림,9" text="PM"/>
						<cell align="center" col="18" cursor="hand" display="text" font="굴림,9" text="연락처"/>
						<cell align="center" col="19" cursor="hand" display="text" font="굴림,9" text="팀장"/>
						<cell align="center" col="20" cursor="hand" display="text" font="굴림,9" text="치수"/>
						<cell align="center" col="21" cursor="hand" display="text" font="굴림,9" text="연락처"/>
						<cell align="center" col="22" cursor="hand" display="text" font="굴림,9" text="차량번호"/>
						<cell align="center" col="23" cursor="hand" display="text" font="굴림,9" text="차량기사"/>
						<cell align="center" col="24" cursor="hand" display="text" font="굴림,9" text="전화번호"/>
						<cell align="center" col="25" cursor="hand" display="text" font="굴림,9" text="호기-현장호기"/>
						<cell col="26" display="text" font="굴림,9" text="SPEC"/>
						<cell align="center" col="27" cursor="hand" display="text" font="굴림,9" text="배차타입"/>
						<cell align="center" col="28" cursor="hand" display="text" font="굴림,9" text="지연사유"/>
						<cell align="center" col="29" cursor="hand" display="text" font="굴림,9" text="변경일자"/>
						<cell align="center" col="30" cursor="hand" display="text" font="굴림,9" text="변경시간"/>
						<cell align="center" col="31" cursor="hand" display="text" font="굴림,9" text="배차SMS"/>
						<cell align="center" col="32" cursor="hand" display="text" font="굴림,9" text="차량SMS"/>
					</head>
					<body>
						<cell col="0" colid="CHECK" display="checkbox" edit="checkbox"/>
						<cell align="center" bkcolor2="user22" col="1" display="text" expr="currow+1"/>
						<cell align="center" bkcolor2="user22" col="2" colid="ZKNUM" display="text"/>
						<cell align="center" bkcolor2="user22" col="3" colid="ZKNUM2" display="text"/>
						<cell align="center" bkcolor2="user22" col="4" colid="PSPID" display="text"/>
						<cell align="center" bkcolor2="user22" col="5" colid="ZQNTY" display="text"/>
						<cell align="left" bkcolor2="user22" col="6" colid="POST1" display="text"/>
						<cell bkcolor2="user22" col="7" colid="ZTEXT" display="text"/>
						<cell align="center" bkcolor2="user22" col="8" colid="BEZEI" display="text"/>
						<cell align="center" bkcolor2="user22" col="9" colid="ERDAT" display="text" Mask="####.##.##"/>
						<cell align="center" bkcolor2="user22" col="10" colid="ERZET" display="text" Mask="##:##"/>
						<cell align="center" bkcolor2="user22" col="11" colid="DPTEN" display="text" Mask="####.##.##"/>
						<cell align="center" bkcolor2="user22" col="12" colid="UPTEN" display="text" Mask="##:##"/>
						<cell align="left" bkcolor2="user22" col="13" colid="ZTON" display="text"/>
						<cell align="center" bkcolor2="user22" col="14" colid="ZKZWI" display="text" edit="normal"/>
						<cell align="center" bkcolor2="user22" col="15" colid="ZZACTSS" combocol="CODE" combodataset="ds_zzactss" combotext="CODE_NAME" display="combo"/>
						<cell align="center" bkcolor2="user22" col="16" colid="ZLZONE_NM" display="text"/>
						<cell align="center" bkcolor2="user22" col="17" colid="ZZTEAMJ" display="text"/>
						<cell align="center" bkcolor2="user22" col="18" colid="CELLP" display="text"/>
						<cell align="center" bkcolor2="user22" col="19" colid="ZZTEAMJ2" display="text"/>
						<cell align="center" bkcolor2="user22" col="20" colid="GROES" display="text"/>
						<cell align="center" bkcolor2="user22" col="21" colid="CELLP2" display="text"/>
						<cell align="center" bkcolor2="user22" col="22" colid="TRAID" display="text" edit="normal"/>
						<cell align="center" bkcolor2="user22" col="23" colid="NAMET" combodisplayrowcnt="1" display="text" edit="normal"/>
						<cell align="center" bkcolor2="user22" col="24" colid="MOB_NUMBER" display="text" edit="normal"/>
						<cell bkcolor2="user22" col="25" colid="HOGI" display="text"/>
						<cell col="26" colid="SPEC" display="text"/>
						<cell align="center" bkcolor2="user22" col="27" colid="ZTYPE_NM" display="text"/>
						<cell align="center" bkcolor2="user22" col="28" colid="ZCHAN_NM" display="text"/>
						<cell align="center" bkcolor2="user22" col="29" colid="AEDAT" display="text" Mask="####.##.##"/>
						<cell align="center" bkcolor2="user22" col="30" colid="UZEIT" display="text" Mask="##:##"/>
						<cell align="center" bkcolor2="user22" col="31" colid="SMDATE1" display="text" edit="normal" Mask="####.##.##"/>
						<cell align="center" bkcolor2="user22" col="32" colid="SMDATE2" display="text" edit="normal" Mask="####.##.##"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Shape BKColor="user0" Bottom="48" Height="48" Id="Shape0" Left="0" LineColor="user1" Right="978" TabOrder="2" Top="0" Type="Rectangle" Width="978"></Shape>
		<Static Align="Right" Height="20" Id="st_date" Left="6" Style="sty_lb_search" TabOrder="4" Text="배차일자&#32;" Top="5" VAlign="Middle" Width="88"></Static>
		<Calendar BindDataset="ds_cond" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="ERDAT" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_erdat_fm" Left="96" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_search_ind" SundayTextColor="user35" TabOrder="3" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="5" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="97"></Calendar>
		<Static Align="Right" Height="20" Id="st_zzlifnr" Left="314" Style="sty_lb_search" TabOrder="5" Text="지역구분&#32;" Top="5" VAlign="Middle" Width="88"></Static>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="CODE" Column="ZTYPE" DataColumn="CODE_NAME" Height="20" Id="cb_ztype" InnerDataset="ds_ztype_cd" Left="403" Style="sty_ipt_search" TabOrder="6" Top="4" Width="104"></Combo>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="CODE" Column="ZLZONE" DataColumn="CODE_NAME" Editable="TRUE" Height="20" Id="cb_zlzone" InnerDataset="ds_zlzone_cd" Left="597" Search="NOTFILTERED" Style="sty_ipt_search" TabOrder="8" Top="4" Width="88"></Combo>
		<Static Align="Right" Height="20" Id="st_mode" Left="508" Style="sty_lb_search" TabOrder="7" Text="지역&#32;" Top="5" VAlign="Middle" Width="88"></Static>
		<Static Align="Right" Height="20" Id="Static0" Left="686" Style="sty_lb_search" TabOrder="9" Text="프로젝트번호" Top="5" VAlign="Middle" Width="88"></Static>
		<Edit BindDataset="ds_cond" Border="Flat" Column="PJT" Height="20" Id="ed_pjt" ImeMode="english" Left="776" Style="sty_ipt_search" TabOrder="11" Top="5" UpperOnly="TRUE" Width="76"></Edit>
		<Button Height="18" Id="btn_pjt" ImageID="btn_icon_search" Left="853" OnClick="btn_pjt_OnClick" TabOrder="10" Text="Button0" Top="6" Width="18"></Button>
		<Static Align="Right" Height="20" Id="st_tplst" Left="314" Style="sty_lb_search" TabOrder="12" Text="출발지&#32;" Top="26" VAlign="Middle" Width="88"></Static>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="CODE" Column="TPLST" DataColumn="CODE_NAME" Height="20" Id="cb_tplst" InnerDataset="ds_tplst_cd" Left="403" Style="sty_ipt_search" TabOrder="13" Top="25" Width="104"></Combo>
		<Static Align="Right" Height="20" Id="Static13" Left="508" Style="sty_lb_search" TabOrder="14" Text="설치대지역" Top="26" VAlign="Middle" Width="88"></Static>
		<Edit BindDataset="ds_cond" Border="Flat" Column="NAMET" Height="20" Id="Edit0" ImeMode="none" Left="776" Style="sty_ipt_search" TabOrder="16" Top="26" UpperOnly="TRUE" Width="76"></Edit>
		<Static Align="Right" Height="20" Id="Static14" Left="686" Style="sty_lb_search" TabOrder="15" Text="PM" Top="26" VAlign="Middle" Width="88"></Static>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="CODE" Column="ZZACTSS" DataColumn="CODE_NAME" Editable="TRUE" Height="20" Id="Combo1" InnerDataset="ds_zzactss_1" Left="597" Search="NOTFILTERED" Style="sty_ipt_search" TabOrder="17" Top="25" Width="88"></Combo>
		<Calendar BindDataset="ds_cond" Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Column="ERDAT_TO" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="20" Id="cal_erdat_to" Left="212" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_search_ind" SundayTextColor="user35" TabOrder="18" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="5" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="97"></Calendar>
		<Static Align="Center" Border="None" Color="user7" Font="굴림,9" Height="20" Id="Static15" Left="194" TabOrder="19" Text="~" Top="5" VAlign="Middle" Width="18"></Static>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="CODE" Column="HOGI" DataColumn="CODE_NAME" Height="20" Id="cb_hogi" InnerDataset="ds_hogi_cd" Left="62" Style="sty_ipt_search" TabOrder="20" Top="25" Width="91"></Combo>
		<Static Align="Right" Height="20" Id="Static17" Left="6" Style="sty_lb_search" TabOrder="21" Text="대수구분&#32;" Top="26" VAlign="Middle" Width="54"></Static>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="CODE" Column="ZFULLSET" DataColumn="CODE_NAME" Height="20" Id="cb_fullset" InnerDataset="ds_fullset_cd" Left="211" Style="sty_ipt_search" TabOrder="22" Top="25" Width="99"></Combo>
		<Static Align="Right" Height="20" Id="Static1" Left="155" Style="sty_lb_search" TabOrder="23" Text="출하구분" Top="26" VAlign="Middle" Width="54"></Static>
		<Checkbox Align="LEFT" BindDataset="ds_cond" Column="ZTON3" Height="20" Id="ck_zton3" Left="856" OnClick="ck_input_OnClick" TabOrder="24" Text="3.5TON제외" Top="25" Width="88"></Checkbox>
	</Form>
	<Script><![CDATA[﻿﻿﻿﻿﻿﻿/*
 ******************************************************************************************
 * 기      능   : 
 * 작  성  자   : 
 * 작성  일자   : 
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
#include "LIB::commons.js";	// 공통 스크립트 
//=========================================================================================
// [ PART 1 ]
// Form에서 사용될 전역변수를 선언
// FORM에서 사용되는 전역변수는 대문자로 작성하며, F_XXX 의 형태를 갖도록 한다. 
//=========================================================================================

//=========================================================================================
// [ PART 2 ]
// Form Loading / Unloading 시 작업 정의
//=========================================================================================
function fn_OnLoadCompleted(obj) 
{
	// Form 로드 이벤트 맨 첫줄에 기술 
	gfn_initForm(true);

	// 현재 조회 일자 설정 
	cal_erdat_to.value = gfn_getCurrDate();
	cal_erdat_fm.value = gfn_getBeforeDate(cal_erdat_to.value, 7);
	
	//  지역구분
	cb_ztype.Index = 1;

   // 대지역코드 ,배차 SMS전송 권한자 DataSet 가져오기
    var codeArr = ["PS003","LESMS"];
    var dsObjArr = [ds_zzactss,ds_sms];
    var addTypeArr = [G_CODE_NONE,G_CODE_NONE];
    gfn_searchCommCode(codeArr, dsObjArr, addTypeArr,true);

    //제조지원부만 운반비가 보이도록 로직 추가 2012.07.16 이호영
    var user_grp4 = ""; //자재
   	user_grp4 = G_USER_GROUP_M; //자재
   	//gfn_showAlert(user_grp4);
   	if (length(user_grp4) == 0)
   	{
   	   fn_hide_grid_column("ZKZWI");
   	}
   	

	tit_clearActionInfo();
	tit_addSearchActionInfo("mm05:MM0501006A_S2");
	
	tit_callService(
        ""
        , ""
        , ""
        , "ds_zlzone_cd=ds_zlzone_cd"
        , ""
        , "fn_cdAfterQuery"
        , true);

    // 엑셀 버튼 비활성화
	ufn_enableBtn("excel", false);
    
	gfn_showMsg("CI00007");
}
/********************************************************************************
* 기      능   : 공통코드가 조회된 후의 Callback 함수 
********************************************************************************/
function fn_completeInit(sCode, sDsObj, sCodeType) 
{
	//  출발지
	cb_tplst.Index = 0;
	//  지역
	cb_zlzone.Index = 0;
}
/********************************************************************************
* 기      능   : form UnloadCompleted 
********************************************************************************/
function fn_OnUnloadCompleted(obj) 
{
	return gfn_isFormUnload(obj);
}
//=========================================================================================
// [ PART 3 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,form닫기)
//=========================================================================================
/********************************************************************************
* 기      능   : 조회 
********************************************************************************/
function fn_query() 
{
    // Message 영역 초기화
	global.FRM_BOTTOM.img_msgType.imageId = "";
	global.FRM_BOTTOM.st_msg.value = "";
	
	//http.TimeOut = 1800;

	if (length(ed_pjt.value) > 0 )
	{
		tit_clearActionInfo();
		tit_addSearchActionInfo("mm05:MM0501006A_S3");
		//tit_addSearchActionInfo("mm05:MM0501006A_S4");
		
		tit_callService(
			""
			, ""
			, "ds_cond=ds_cond"
			, "ds_list=ds_list ds_sum=ds_sum"
			, ""
			, "fn_afterQuery"
			, true);
	}
	else
	{
		// 필수 입력 항목 체크 
		if ( gfn_isNull(cal_erdat_fm, true) ) 
		{
			gfn_showMsg("CW00001","배차일자 시작");
			return;
		}

		if ( gfn_isNull(cal_erdat_to, true) ) 
		{
			gfn_showMsg("CW00001","배차일자 종료");
			return;
		}
		
		var maxdate = gfn_getAfterDate(cal_erdat_fm.value, 30);
		var message_arg = ["조회기간","30일"];
		if (cal_erdat_to > maxdate)
		{
			gfn_showAlert("CW00133",message_arg);
			return;
		}		
		
		tit_clearActionInfo();
		tit_addSearchActionInfo("mm05:MM0501006A_S1");
		//tit_addSearchActionInfo("mm05:MM0501006A_S4");
		
		tit_callService(
			""
			, ""
			, "ds_cond=ds_cond"
			, "ds_list=ds_list ds_sum=ds_sum"
			, ""
			, "fn_afterQuery"
			, true);
	}
}


/********************************************************************************
* 기      능   : 저장 
********************************************************************************/
function fn_save() {

	// 테이블 별로 분리 하여 담기
	ds_list_0.ClearData();
	ds_list_1.ClearData();

	//var err[2];
		
	if (!gfn_showConfirm("CI00008")) {
		return;
	}
	
	ds_list.fireevent = false;	
	gfn_copyDs(ds_list, ds_list_0, "GUBN=2");
	gfn_copyDs(ds_list, ds_list_1, "GUBN=6");

	ds_list.fireevent = true;

	tit_clearActionInfo();

	// 저장 처리 
	tit_addSaveActionInfo(
        ""
        , "mm05:MM0501001A_U1"
        , ""
        , "FLAG"
		,""
		, 0
		, "");
	tit_addSaveActionInfo(
        ""
        , "mm05:MM0501001A_U2"
        , ""
        , "FLAG"
		,""
		, 0
		, "");


	tit_callService(
        ""
        , ""
        , "ds_list_0=ds_list_0:A ds_list_1=ds_list_1:A"
        , ""
        , ""
        , "fn_afterSave");
}
/********************************************************************************
* 기      능   : 닫기  
********************************************************************************/
function fn_close() 
{
	close();
}

/********************************************************************************
* 기      능   : 액셀  
********************************************************************************/
function fn_excel() 
{
	// Excel Export 
	gfn_exportExcel(grd_list,G_USER_ID);
}

/********************************************************************************
* 기      능   :  거래명세서 생성
********************************************************************************/
function fn_print() 
{
	// UbiReport Call
	Dialog("MM05::MM0501001C.xml","", -1, -1, "Resize=true");
}

//=========================================================================================
// [ PART 4]
// Callback 함수 정의 : callback 함수명은 메인 함수의 fn_xxxx() 에서 xxxx 부분은 fn_afterXXXX()
// 형태가 되도록 작성 
//=========================================================================================
/********************************************************************************
* 기      능   : 조회 Callback  
********************************************************************************/
function fn_afterQuery(errCode, errMsg) 
{
    // 조회 결과가 있으면 엑셀 버튼 활성화
	if ( ds_list.rowCount() > 0 ) 
	{
		ufn_enableBtn("excel", true);
		gfn_showMsg("CI00002", ds_list.rowCount() + "");

		var arr = split(G_ORG_USER_INFO, "^", true); 
		var sms = ds_sms.searchRow("CODE== " + quote(arr[0]));
		var cnt = 0;

		if (sms >= 0)
		{
			btn_carSMS.Visible = true;
			btn_carSMS.Enable = true;
			if (G_USER_GROUP_M > 10)
			{
				btn_planSMS.Visible = true;
				btn_planSMS.Enable = true;
			}
			
			if (length(ed_pjt.text) < 1)
			{
				ds_list.fireevent = false;
				for (var i = 0; i < ds_list.rowcount; i++)
				{
					if (substr(ds_list.GetColumn(i,"ERZET"),0,4) == "0830" && length(trim(ds_list.GetColumn(i,"TRAID"))) < 1)
					{
						ds_list.SetColumn(i,"CHECK","1");
						ds_list.SetColumn(i,"FLAG","U");
						ds_list.SetColumn(i,"TRAID","2854");
						ds_list.SetColumn(i,"NAMET","이재두");
						ds_list.SetColumn(i,"MOB_NUMBER","019-228-9887");		
						cnt++;
					}
					if (substr(ds_list.GetColumn(i,"ERZET"),0,4) == "0850"  && length(trim(ds_list.GetColumn(i,"TRAID"))) < 1)
					{
						ds_list.SetColumn(i,"CHECK","1");
						ds_list.SetColumn(i,"FLAG","U");
						ds_list.SetColumn(i,"TRAID","2196");
						ds_list.SetColumn(i,"NAMET","김수영");
						ds_list.SetColumn(i,"MOB_NUMBER","011-9523-2403");
						cnt++;
					}
				}
				ds_list.fireevent = true;
			}
			// 셔틀 입력시 저장 확인
			if (cnt > 0) {
				fn_save();
			}
		}
	} 
	else 
	{
		ufn_enableBtn("excel", false);
//		cal_rdate_p.Enable = false;
		gfn_showMsg("CW00010");
	}
}

function fn_cdAfterQuery(errCode, errMsg) 
{
	ds_zlzone_cd.insertRow(0);
	ds_zlzone_cd.setColumn(0, "CODE", "");
	ds_zlzone_cd.setColumn(0, "CODE_NAME", "- 전 체 -");
	//  지역
	cb_zlzone.Index = 0;
}

/********************************************************************************
* 기      능   : 저장 Callback  
********************************************************************************/
function fn_afterSave(errCode, errMsg) {
	if ( errCode!= 0 ) {
		gfn_showMsg("CE00001");
	} else {
		gfn_showMsg("CI00003");
	}
	fn_query();
}
//=========================================================================================
// [ PART 5 ]
// Detail Process Event 정의 ( User Define function )
// 사용자 정의 함수는 ufn_xxxx() 형태로 작성 
//=========================================================================================

//=========================================================================================
// [ PART 6 ]
// component Event 정의 : 각 Component 별 이벤트 
//=========================================================================================
/********************************************************************************
* 기      능   : Head Click
********************************************************************************/
function grd_list_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
{
	if ( nCell == 0 ) 
	{
		// 전체 선택 취소
		gfn_selectAllGrid(obj);
	} 
	else 
	{
		// 그리드 정렬 처리 
		gfn_multiSortGrid(obj, false, 1);
	}
}

/********************************************************************************
* 기      능   : 상세 조회 팝업
********************************************************************************/
function grd_list_OnCellDBClik(obj,nRow,nCell)
{
	if (nCell <  21 || (nCell > 23 && nCell < 30))
	{
		// 상세 조회 팝업
		var arg = "fa_zknum=" + quote(obj.GetCellValue(nRow,grd_list.GetBindCellIndex("body","ZKNUM"))) 
				+ " fa_zknum2=" + quote(obj.GetCellValue(nRow,grd_list.GetBindCellIndex("body","ZKNUM2")));
		
		gfn_openPopup("MM0501001B", true, arg, 420, 529);
	}
}

/********************************************************************************
* 기      능   : 원프로젝트 팝업
********************************************************************************/
function btn_pjt_OnClick(obj)
{
	var arg = "pjt="+quote(ed_pjt.value);
	gfn_openPopup("CS9601002A",true,arg);
}

function grd_list_OnKeyDown(obj,nChar,bShift,bCtrl,bAlt,nLLParam,nHLParam)
{
	if ( bCtrl ) {
		if(nChar == 86) {
			// Ctrl + V 일경우 : 엑셀에서 그리드로
			pasteEx();
			return;
		}
	}
}


function pasteEx() 
{
	var objDataset = ds_list;
	var strBuff = GetClipBoard("CF_CSV");
	var arrBuff = Split2(strBuff,"\n",",");
	var stRow = objDataset.row;
	
	var nRowPos = objDataset.rowpos;		// 현재 row posistion
	var nRowCnt = objDataset.rowcount;		// 현재 dataset의 row 수 
	var nInputRowCnt = arrBuff.length;	// 입력 받은 row의 수 
	
	//objDataset.FireEvent = false; //추가해주세요.
	
	// 현재 위치에서 입력받은 수를 더했을때 현재 총 row를 넘으면 미리 생성해준다. 
	var nMakeRow = (nRowPos + nInputRowCnt) - nRowCnt;
	if(nMakeRow > 0) {
		// for(i = 0 ; i < nMakeRow; i++) {
			// objDataset.AddRow();
		// }
		var arr = ["입력","행수"];
		gfn_showAlert("CW00133",arr);
		return;
	}

	for ( var i = 0; i < arrBuff.length; i ++ ) 
	{
		var strTmp = arrBuff[i];
		strTmp = replace(strTmp,"["); 
		strTmp = replace(strTmp,"]");
		
		var arrCell = Split(strTmp,",");
		for ( var j = 0; j < arrCell.length; j ++ ) 
		{
			//trace("행 : "+i+", 열 :"+(nColPos+j)+", 값 : "+ arrCell[j] );
			if (j ==0)
			{
				objDataset.setcolumn(nRowPos+i,"NAMET",arrCell[j]);
			} 
			else if (j == 1)
			{
				objDataset.setcolumn(nRowPos+i,"MOB_NUMBER",arrCell[j]);
			}
			else
			{
				objDataset.setcolumn(nRowPos+i,"TRAID",arrCell[j]);
			}
		}
		//objDataset.SetColumn(stRow, "column0", strTmp);
		//stRow ++;
	}
	//objDataset.FireEvent = true; //추가해주세요.
	///ClearClipboard();
}

/********************************************************************************
* 기      능   :  데이터 변경시 처리 
********************************************************************************/
function ds_list_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{
	if (strColumnID != "CHECK")
	{
		gfn_changeFlag( obj, strColumnID, nRow, "FLAG" );
	}
	if (strColumnID == "TRAID" && length(obj.GetColumn(nRow, "NAMET")) < 1)
	{
		ds_tr_cond.ClearData();
		ds_tr_cond.AddRow();
		ds_tr_cond.SetColumn(0, "TRAID", varNewValue);
		ds_tr_cond.SetColumn(0,"INPUTROW", nRow);
										
		listRow = nRow;

		tit_clearActionInfo();
		// 저장 처리 
		tit_addSearchActionInfo("mm05:MM0501006A_S5");

		tit_callService(
			""
			,""
			, "ds_tr_cond=ds_tr_cond"
			, "ds_tr_list=ds_tr_list"
			, ""
			, "fn_setTraid"
			, false
			, true);		
	}
}

/********************************************************************************
* 기      능   :  배차정보 SMS전송
********************************************************************************/

function ufn_planSMSOnClick(obj)
{
	for(var i = 0; i < ds_list.rowcount; i++)
	{
		if (ds_list.GetColumn(i,"CHECK") == "1" && length(ds_list.GetColumn(i,"CELLP")) < 10 && length(ds_list.GetColumn(i,"CELLP2")) < 10)
		{
			gfn_showAlert("CW00001","전화번호");
			ds_list.SetColumn(i,"CHECK","0");
			return;
		}
		
		//도착일자로 체크
		if (ds_list.GetColumn(i,"CHECK") == "1" && ds_list.GetColumn(i,"DPTEN") < gfn_getCurrDate())
		{
			gfn_showAlert("CW00121","기간이 만료");
			ds_list.SetColumn(i,"CHECK","0");
			return;
		}

		//SMS 전송 체크
		if (ds_list.GetColumn(i,"CHECK") == "1" && length(ds_list.GetColumn(i,"SMDATE1")) > 0)
		{
			gfn_showAlert("CW00121","SMS가 전송");
			ds_list.SetColumn(i,"CHECK","0");
			return;
		}

	}

   // 선택정보 담기
	ds_list_0.ClearData();

	// 선택된 데이터 복사
	ds_list.fireevent = false;	
	gfn_copyDs(ds_list, ds_list_0, "CHECK=1");
	ds_list.fireevent = true;	

    if (ds_list_0.rowcount < 1)
    {
		gfn_showAlert("CW00013");
		return;
    }

    //저장확인
	if (!gfn_showConfirm("CI00010")) {
		return;
	}
	
	ds_emtran_0.ClearData();
	var cellp = "";
	var gbn = "N";
	var j = 0;
	
	for (var i = 0 ; i < ds_list_0.rowcount ; i++ )
	{
		if (gbn == "N")
		{
			cellp = Trim(ds_list_0.GetColumn(i,"CELLP"));
		}
		else
		{
			cellp = Trim(ds_list_0.GetColumn(i,"CELLP2"));
		}

		ds_emtran_0.AddRow();
		ds_emtran_0.setColumn(j,"TRAN_ID",G_USER_ID);
		ds_emtran_0.setColumn(j,"TRAN_PHONE", Replace(cellp,"-",""));
		ds_emtran_0.setColumn(j,"TRAN_CALLBACK","15770603");
		ds_emtran_0.setColumn(j,"TRAN_MSG",ds_list_0.GetColumn(i,"MSG"));
		ds_emtran_0.setColumn(j,"TRAN_ETC1","MM_WEB");
		ds_emtran_0.setColumn(j,"TRAN_ETC2",ds_list_0.GetColumn(i,"PSPID"));	

		if (length(cellp) >= 10)
		{
			ds_emtran_0.SetColumn(j, "GBN", 1);
		}

		if (gbn == "N")
		{
			i--;
			gbn = "Y";
		} else {
			gbn = "N";
		}

		j++;
	}
	ds_emtran.ClearData();
	gfn_copyDs(ds_emtran_0, ds_emtran, "GBN = 1");

    //tit_showDs(ds_emtran,false);
	tit_clearActionInfo();

	//저장 처리 
	tit_addMultiActionInfo("mm05:MM0501001A_I1");
	// tit_addSaveActionInfo(                    // 20101022 저장이 되지 않아 수정
        // "mm05:MM0501001A_I1"
        // , ""
        // , ""
        // , ""
		// ,""
		// , 0
		// , "");
		
	tit_callService(
        "PDA_ACT"
        , ""
        , "ds_emtran=ds_emtran:A"
        , ""
        , ""
        , "fn_afterPlanSave"
        , true
        , true
        , true);
}

/********************************************************************************
* 기      능   :  차량정보 SMS전송
********************************************************************************/

function ufn_carSMSOnClick(obj)
{
	for(var i = 0; i < ds_list.rowcount; i++)
	{
		if (ds_list.GetColumn(i,"CHECK") == "1" && length(ds_list.GetColumn(i,"CELLP")) < 10 && length(ds_list.GetColumn(i,"CELLP2")) < 10)
		{
			gfn_showAlert("CW00001","전화번호");
			ds_list.SetColumn(i,"CHECK","0");
			return;
		}
		if (ds_list.GetColumn(i,"CHECK") == "1" && length(ds_list.GetColumn(i,"MOB_NUMBER")) < 10)
		{
			gfn_showAlert("CW00001","전화번호");
			ds_list.SetColumn(i,"CHECK","0");
			return;
		}
		// 도착일자로 체크
		if (ds_list.GetColumn(i,"CHECK") == "1" && ds_list.GetColumn(i,"DPTEN") < gfn_getCurrDate())
		{
			gfn_showAlert("CW00121","기간이 만료");
			ds_list.SetColumn(i,"CHECK","0");
			return;
		}

		// SMS 전송 체크
		if (ds_list.GetColumn(i,"CHECK") == "1" && length(ds_list.GetColumn(i,"SMDATE2")) > 0)
		{
			gfn_showAlert("CW00121","SMS가 전송");
			ds_list.SetColumn(i,"CHECK","0");
			return;
		}

	}

   // 선택정보 담기
	ds_list_0.ClearData();

	// 선택된 데이터 복사
	ds_list.fireevent = false;	
	gfn_copyDs(ds_list, ds_list_0, "CHECK=1");
	ds_list.fireevent = true;	
    
    if (ds_list_0.rowcount < 1)
    {
		gfn_showAlert("CW00013");
		return;
    }
    //저장확인
	if (!gfn_showConfirm("CI00010")) {
		return;
	}
	
	ds_emtran_0.ClearData();
	var cellp = "";
	var gbn = "N";
	var j = 0;
	
	for (var i = 0 ; i < ds_list_0.rowcount ; i++ )
	{
		if (gbn == "N")
		{
			cellp = Trim(ds_list_0.GetColumn(i,"CELLP"));
		}
		else
		{
			cellp = Trim(ds_list_0.GetColumn(i,"CELLP2"));
		}

		ds_emtran_0.AddRow();
		ds_emtran_0.setColumn(j,"TRAN_ID",G_USER_ID);
		ds_emtran_0.setColumn(j,"TRAN_PHONE", Replace(cellp,"-",""));
		//ds_emtran_0.setColumn(j,"TRAN_CALLBACK","15770603");
		ds_emtran_0.setColumn(j,"TRAN_CALLBACK","0415827015");
		ds_emtran_0.setColumn(j,"TRAN_MSG",ds_list_0.GetColumn(i,"MSG1"));
		ds_emtran_0.setColumn(j,"TRAN_ETC1","MM_WEB");
		ds_emtran_0.setColumn(j,"TRAN_ETC2",ds_list_0.GetColumn(i,"PSPID"));	
		ds_emtran_0.SetColumn(j, "GBN", 0);
		if (length(cellp) >= 10)
		{
			ds_emtran_0.SetColumn(j, "GBN", 1);
		}

		if (gbn == "N")
		{
			i--;
			gbn = "Y";
		} else {
			gbn = "N";
		}

		j++;
	}
	ds_emtran.ClearData();
	gfn_copyDs(ds_emtran_0, ds_emtran, "GBN = 1");

	//tit_showDs(ds_emtran,false);

	tit_clearActionInfo();
	// 저장 처리 
	tit_addMultiActionInfo("mm05:MM0501001A_I1");
	// tit_addSaveActionInfo(                    // 20101022 저장이 되지 않아 수정
        // "mm05:MM0501001A_I1"
        // , ""
        // , ""
        // , ""
		// ,""
		// , 0
		// , "");
    
	tit_callService(
        "PDA_ACT"
        , ""
        , "ds_emtran=ds_emtran:A"
        , ""
        , ""
        , "fn_afterCarSave"
        , true
        , true
        , true);
}

/********************************************************************************
* 기      능   : 저장 Callback  
********************************************************************************/
function fn_afterPlanSave(errCode, errMsg) {

	if ( errCode!= 0 ) {
		gfn_showAlert("CE00001");
		fn_query();
	} else {
		gfn_showMsg("CI00003");

		tit_clearActionInfo();

		tit_addMultiActionInfo("mm05:MM0501001A_I2");

		tit_callService(
			""
			, ""
			, "ds_list=ds_list_0:A"
			, ""
			, ""
			, "fn_afterSMSSave"
			,true);
	}
}
/********************************************************************************
* 기      능   : 저장 Callback  
********************************************************************************/
function fn_afterCarSave(errCode, errMsg) {
	if ( errCode!= 0 ) {
		gfn_showAlert("CE00001");
		fn_query();
	} else {
		gfn_showMsg("CI00003");

		tit_clearActionInfo();
		
		tit_addMultiActionInfo("mm05:MM0501001A_I3");
	
		tit_callService(
			""
			, ""
			, "ds_list=ds_list_0:A"
			, ""
			, ""
			, "fn_afterSMSSave"
			, true);
	}
}
/********************************************************************************
* 기      능   : 저장 Callback  
********************************************************************************/
function fn_afterSMSSave(errCode, errMsg) {
	if ( errCode!= 0 ) {
		gfn_showAlert("CE00001");
	} else {
		gfn_showMsg("CI00003");
	}
	fn_query();
}


function fn_setTraid()
{
	if (ds_tr_list.rowcount > 0)
	{
		ds_list.fireevent = false;
		ds_list.SetColumn(ds_tr_cond.GetColumn(0,"INPUTROW"),"CHECK","1");
		ds_list.SetColumn(ds_tr_cond.GetColumn(0,"INPUTROW"),"NAMET",ds_tr_list.GetColumn(0,"NAMET")); 
		ds_list.SetColumn(ds_tr_cond.GetColumn(0,"INPUTROW"),"MOB_NUMBER",ds_tr_list.GetColumn(0,"MOB_NUMBER")); 
		ds_list.SetColumn(ds_tr_cond.GetColumn(0,"INPUTROW"),"FLAG","U"); 
		
		ds_list.fireevent = true;
	}
}

function fn_hide_grid_column(colid) {
    grd_list.SetCellProp("head",	grd_list.GetBindCellIndex("body",colid),"Display","null");
	grd_list.SetCellProp("body",	grd_list.GetBindCellIndex("body",colid),"Display","null");
	grd_list.SetColProp(grd_list.GetBindCellIndex("body",colid),"Width",0);
}
]]></Script>
</Window>