<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="562" Id="PS0710004B" Left="8" OnLoadCompleted="fn_OnLoadCompleted" OnUnloadCompleted="fn_OnUnloadCompleted" PidAttrib="7" Title="관리코드&#32;관리" Top="8" Ver="1.0" Width="978" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_from">
				<Contents>
					<colinfo id="CHECK" size="256" summ="default" type="STRING"/>
					<colinfo id="PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
					<colinfo id="POST1" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSPEC1" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSPEC2" size="256" summ="default" type="STRING"/>
					<colinfo id="TEXT30" size="256" summ="default" type="STRING"/>
					<colinfo id="NAMET" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNR_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="NAMET2" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZSHIP1" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZCOMP2" size="256" summ="default" type="STRING"/>
					<colinfo id="ASTD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATE1" size="256" summ="default" type="STRING"/>
					<colinfo id="REQ_DATE" size="256" summ="default" type="STRING"/>
					<colinfo id="REQ_DATE2" size="256" summ="default" type="STRING"/>
					<colinfo id="DATE4" size="256" summ="default" type="STRING"/>
					<colinfo id="ZBEPJEO" size="256" summ="default" type="STRING"/>
					<colinfo id="ZPDM_SAL" size="256" summ="default" type="STRING"/>
					<colinfo id="SAL_DATE" size="256" summ="default" type="STRING"/>
					<colinfo id="ZPDM_TSL" size="256" summ="default" type="STRING"/>
					<colinfo id="TSL_DATE" size="256" summ="default" type="STRING"/>
					<colinfo id="ZPDM_DES" size="256" summ="default" type="STRING"/>
					<colinfo id="DES_DATE" size="256" summ="default" type="STRING"/>
					<colinfo id="QM" size="256" summ="default" type="STRING"/>
					<colinfo id="FILE_END" size="256" summ="default" type="STRING"/>
					<colinfo id="KETF1_DATE" size="256" summ="default" type="STRING"/>
					<colinfo id="RECEPTIONIST" size="256" summ="default" type="STRING"/>
					<colinfo id="KETF2_DATE" size="256" summ="default" type="STRING"/>
					<colinfo id="KETF3_DATE" size="256" summ="default" type="STRING"/>
					<colinfo id="DCHK" size="256" summ="default" type="STRING"/>
					<colinfo id="BIGO" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK_KIND" size="256" summ="default" type="STRING"/>
					<colinfo id="CHASU" size="256" summ="default" type="STRING"/>
					<colinfo id="CFM_DATE" size="256" summ="default" type="STRING"/>
					<colinfo id="FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="ISREMD" size="256" summ="default" type="STRING"/>
					<colinfo id="SAL_GAP" size="256" summ="default" type="STRING"/>
					<colinfo id="TSL_GAP" size="256" summ="default" type="STRING"/>
					<colinfo id="DES_GAP" size="256" summ="default" type="STRING"/>
					<colinfo id="AUSE" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="KEYCODE" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZACTSS" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_to" UseClientLayout="1">
				<Contents>
					<colinfo id="CHECK" size="256" summ="default" type="STRING"/>
					<colinfo id="PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
					<colinfo id="POST1" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSPEC1" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSPEC2" size="256" summ="default" type="STRING"/>
					<colinfo id="TEXT30" size="256" summ="default" type="STRING"/>
					<colinfo id="NAMET" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNR_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="NAMET2" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZSHIP1" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZCOMP2" size="256" summ="default" type="STRING"/>
					<colinfo id="ASTD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATE1" size="256" summ="default" type="STRING"/>
					<colinfo id="REQ_DATE" size="256" summ="default" type="STRING"/>
					<colinfo id="REQ_DATE2" size="256" summ="default" type="STRING"/>
					<colinfo id="DATE4" size="256" summ="default" type="STRING"/>
					<colinfo id="ZBEPJEO" size="256" summ="default" type="STRING"/>
					<colinfo id="ZPDM_SAL" size="256" summ="default" type="STRING"/>
					<colinfo id="SAL_DATE" size="256" summ="default" type="STRING"/>
					<colinfo id="ZPDM_TSL" size="256" summ="default" type="STRING"/>
					<colinfo id="TSL_DATE" size="256" summ="default" type="STRING"/>
					<colinfo id="ZPDM_DES" size="256" summ="default" type="STRING"/>
					<colinfo id="DES_DATE" size="256" summ="default" type="STRING"/>
					<colinfo id="QM" size="256" summ="default" type="STRING"/>
					<colinfo id="FILE_END" size="256" summ="default" type="STRING"/>
					<colinfo id="KETF1_DATE" size="256" summ="default" type="STRING"/>
					<colinfo id="RECEPTIONIST" size="256" summ="default" type="STRING"/>
					<colinfo id="KETF2_DATE" size="256" summ="default" type="STRING"/>
					<colinfo id="KETF3_DATE" size="256" summ="default" type="STRING"/>
					<colinfo id="DCHK" size="256" summ="default" type="STRING"/>
					<colinfo id="BIGO" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK_KIND" size="256" summ="default" type="STRING"/>
					<colinfo id="CHASU" size="256" summ="default" type="STRING"/>
					<colinfo id="CFM_DATE" size="256" summ="default" type="STRING"/>
					<colinfo id="FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="ISREMD" size="256" summ="default" type="STRING"/>
					<colinfo id="SAL_GAP" size="256" summ="default" type="STRING"/>
					<colinfo id="TSL_GAP" size="256" summ="default" type="STRING"/>
					<colinfo id="DES_GAP" size="256" summ="default" type="STRING"/>
					<colinfo id="AUSE" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="KEYCODE" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZACTSS" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond">
				<Contents>
					<colinfo id="PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZSHIPF" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZSHIPT" size="256" summ="default" type="STRING"/>
					<colinfo id="PSPID_LIST" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_img" UseClientLayout="1">
				<Contents>
					<colinfo id="IMG" size="256" summ="default" type="STRING"/>
					<record>
						<IMG></IMG>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_keyList">
				<Contents>
					<colinfo id="CHECK" size="256" summ="default" type="STRING"/>
					<colinfo id="PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
					<colinfo id="POST1" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSPEC1" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSPEC2" size="256" summ="default" type="STRING"/>
					<colinfo id="TEXT30" size="256" summ="default" type="STRING"/>
					<colinfo id="NAMET" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNR_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="NAMET2" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZSHIP1" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZCOMP2" size="256" summ="default" type="STRING"/>
					<colinfo id="ASTD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATE1" size="256" summ="default" type="STRING"/>
					<colinfo id="REQ_DATE" size="256" summ="default" type="STRING"/>
					<colinfo id="DATE4" size="256" summ="default" type="STRING"/>
					<colinfo id="ZBEPJEO" size="256" summ="default" type="STRING"/>
					<colinfo id="ZPDM_SAL" size="256" summ="default" type="STRING"/>
					<colinfo id="SAL_DATE" size="256" summ="default" type="STRING"/>
					<colinfo id="ZPDM_TSL" size="256" summ="default" type="STRING"/>
					<colinfo id="TSL_DATE" size="256" summ="default" type="STRING"/>
					<colinfo id="ZPDM_DES" size="256" summ="default" type="STRING"/>
					<colinfo id="DES_DATE" size="256" summ="default" type="STRING"/>
					<colinfo id="QM" size="256" summ="default" type="STRING"/>
					<colinfo id="FILE_END" size="256" summ="default" type="STRING"/>
					<colinfo id="KETF1_DATE" size="256" summ="default" type="STRING"/>
					<colinfo id="RECEPTIONIST" size="256" summ="default" type="STRING"/>
					<colinfo id="KETF2_DATE" size="256" summ="default" type="STRING"/>
					<colinfo id="KETF3_DATE" size="256" summ="default" type="STRING"/>
					<colinfo id="DCHK" size="256" summ="default" type="STRING"/>
					<colinfo id="BIGO" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK_KIND" size="256" summ="default" type="STRING"/>
					<colinfo id="CHASU" size="256" summ="default" type="STRING"/>
					<colinfo id="CFM_DATE" size="256" summ="default" type="STRING"/>
					<colinfo id="FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="ISREMD" size="256" summ="default" type="STRING"/>
					<colinfo id="SAL_GAP" size="256" summ="default" type="STRING"/>
					<colinfo id="TSL_GAP" size="256" summ="default" type="STRING"/>
					<colinfo id="DES_GAP" size="256" summ="default" type="STRING"/>
					<colinfo id="AUSE" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="KEYCODE" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZACTSS" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_keyCond">
				<Contents>
					<colinfo id="PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK_KIND" size="256" summ="default" type="STRING"/>
					<colinfo id="CHASU" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZACTSS" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_keyGen">
				<Contents>
					<colinfo id="KEYCODE" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_from_tmp">
				<Contents>
					<colinfo id="CHECK" size="256" summ="default" type="STRING"/>
					<colinfo id="PSPID" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID" size="256" summ="default" type="STRING"/>
					<colinfo id="POST1" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSPEC1" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSPEC2" size="256" summ="default" type="STRING"/>
					<colinfo id="TEXT30" size="256" summ="default" type="STRING"/>
					<colinfo id="NAMET" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNR_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="NAMET2" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZSHIP1" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZCOMP2" size="256" summ="default" type="STRING"/>
					<colinfo id="ASTD" size="256" summ="default" type="STRING"/>
					<colinfo id="DATE1" size="256" summ="default" type="STRING"/>
					<colinfo id="REQ_DATE" size="256" summ="default" type="STRING"/>
					<colinfo id="REQ_DATE2" size="256" summ="default" type="STRING"/>
					<colinfo id="DATE4" size="256" summ="default" type="STRING"/>
					<colinfo id="ZBEPJEO" size="256" summ="default" type="STRING"/>
					<colinfo id="ZPDM_SAL" size="256" summ="default" type="STRING"/>
					<colinfo id="SAL_DATE" size="256" summ="default" type="STRING"/>
					<colinfo id="ZPDM_TSL" size="256" summ="default" type="STRING"/>
					<colinfo id="TSL_DATE" size="256" summ="default" type="STRING"/>
					<colinfo id="ZPDM_DES" size="256" summ="default" type="STRING"/>
					<colinfo id="DES_DATE" size="256" summ="default" type="STRING"/>
					<colinfo id="QM" size="256" summ="default" type="STRING"/>
					<colinfo id="FILE_END" size="256" summ="default" type="STRING"/>
					<colinfo id="KETF1_DATE" size="256" summ="default" type="STRING"/>
					<colinfo id="RECEPTIONIST" size="256" summ="default" type="STRING"/>
					<colinfo id="KETF2_DATE" size="256" summ="default" type="STRING"/>
					<colinfo id="KETF3_DATE" size="256" summ="default" type="STRING"/>
					<colinfo id="DCHK" size="256" summ="default" type="STRING"/>
					<colinfo id="BIGO" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK_KIND" size="256" summ="default" type="STRING"/>
					<colinfo id="CHASU" size="256" summ="default" type="STRING"/>
					<colinfo id="CFM_DATE" size="256" summ="default" type="STRING"/>
					<colinfo id="FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="ISREMD" size="256" summ="default" type="STRING"/>
					<colinfo id="SAL_GAP" size="256" summ="default" type="STRING"/>
					<colinfo id="TSL_GAP" size="256" summ="default" type="STRING"/>
					<colinfo id="DES_GAP" size="256" summ="default" type="STRING"/>
					<colinfo id="AUSE" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="KEYCODE" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_kind">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE>A</CODE>
						<CODE_NAME>설치</CODE_NAME>
					</record>
					<record>
						<CODE>B</CODE>
						<CODE_NAME>설치(재검)-현대</CODE_NAME>
					</record>
					<record>
						<CODE>F</CODE>
						<CODE_NAME>설치(재검)-건축</CODE_NAME>
					</record>
					<record>
						<CODE>G</CODE>
						<CODE_NAME>설치(재검)-업체</CODE_NAME>
					</record>
					<record>
						<CODE>D</CODE>
						<CODE_NAME>설치(교체)</CODE_NAME>
					</record>
					<record>
						<CODE>C</CODE>
						<CODE_NAME>수시</CODE_NAME>
					</record>
					<record>
						<CODE>E</CODE>
						<CODE_NAME>수시(재검)-현대</CODE_NAME>
					</record>
					<record>
						<CODE>H</CODE>
						<CODE_NAME>수시(재검)-건축</CODE_NAME>
					</record>
					<record>
						<CODE>I</CODE>
						<CODE_NAME>수시(재검)-업체</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
		</Datasets>
		<Static Border="Flat" BorderColor="deepskyblue" Height="59" Id="Static3" Left="8" TabOrder="14" Top="37" Width="848"></Static>
		<Shape BKColor="user0" Bottom="30" Height="30" Id="Shape0" Left="-1" LineColor="user1" Right="977" TabOrder="1" Top="0" Type="Rectangle" Width="978"></Shape>
		<Static Align="Right" Height="20" Id="st_pjt" Left="8" Style="sty_lb_search" TabOrder="2" Text="Proj&#32;No&#32;" Top="4" VAlign="Middle" Width="100"></Static>
		<Edit BindDataset="ds_cond" Border="Flat" CheckLength="Byte" Column="PSPID" Height="20" Id="ed_pjt" ImeMode="english" Left="114" Style="sty_ipt_search" TabOrder="3" Top="4" UpperOnly="TRUE" Width="390"></Edit>
		<Calendar Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="146" Id="cal_temp" Left="1072" MonthOnly="TRUE" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" OnDayClick="cal_temp_OnDayClick" OnKillFocus="cal_temp_OnKillFocus" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="4" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="176" Value="20080401" Visible="FALSE" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="152"></Calendar>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_import" ImageID="btn_sub_07" Left="1040" LeftMargin="12" OnClick="btn_import_OnClick" Style="sty_btn" TabOrder="5" Text="&#32;관리코드&#32;생성" Top="5" Transparent="TRUE" Width="109"></Button>
		<Image BindDataset="ds_img" Color="HIGHLIGHT" Column="IMG" Font="Default,48" Height="65" Id="img_Right" Left="857" OnClick="img_Right_OnClick" Static="FALSE" TabOrder="6" Text="▶" Top="192" Width="72"></Image>
		<Image BindDataset="ds_img" Color="HIGHLIGHT" Column="IMG" Font="Default,48" Height="65" Id="img_Left" Left="857" OnClick="img_Left_OnClick" Static="FALSE" TabOrder="7" Text="◀" Top="384" Width="72"></Image>
		<Grid AreaSelect="true" AutoEnter="TRUE" AutoFitEndLine="Hide" AutoSelect="TRUE" BindDataset="ds_from" BkColor2="default" BoldHead="true" Border="Flat" Bottom="553" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="449" Id="grd_list_l" InputPanel="FALSE" Left="8" LineColor="user20" LineType="ExHORZ" OnCellClick="grd_list_l_OnCellClick" OnHeadClick="grd_list_OnHeadClick" Right="444" RowHeight="20" Style="sty_grid" TabOrder="8" TabStop="true" Top="104" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="436">
			<contents>
				<format id="Default">
					<columns>
						<col fix="left" width="20"/>
						<col fix="left" width="25"/>
						<col fix="left" width="20"/>
						<col fix="left" width="56"/>
						<col fix="left" width="70"/>
						<col fix="left" width="120"/>
						<col width="55"/>
						<col width="53"/>
						<col width="90"/>
						<col width="90"/>
						<col width="143"/>
						<col width="89"/>
					</columns>
					<head>
						<cell bkimageid="icon_grid_sel" col="0" cursor="hand" display="text"/>
						<cell align="center" col="1" color="user21" display="text" font="굴림,9" text="NO"/>
						<cell align="center" col="2" color="user21" display="checkbox" font="굴림,9"/>
						<cell align="center" col="3" color="user21" display="text" font="굴림,9" text="사무소"/>
						<cell align="center" col="4" color="user21" display="text" font="굴림,9" text="호기번호"/>
						<cell align="center" col="5" color="user21" display="text" font="굴림,9" text="프로젝트명"/>
						<cell align="center" col="6" color="user21" display="text" font="굴림,9" text="검사종류"/>
						<cell align="center" col="7" color="user21" display="text" font="굴림,9" text="차수"/>
						<cell align="center" col="8" color="user21" display="text" font="굴림,9" text="검사희망일(b)"/>
						<cell align="center" col="9" color="user21" display="text" font="굴림,9" text="확정검사요청일"/>
						<cell bkcolor="mediumslateblue" col="10" color="user22" display="text" font="굴림,9" text="관리코드"/>
						<cell align="center" col="11" color="user21" display="text" font="굴림,9" text="삭제"/>
					</head>
					<body>
						<cell align="center" bkimageid='expr:gfn_getFlagBkImageID(getColumn(currow,&#32;&quot;FLAG&quot;))' col="0" color='expr:iif(CHECK&#32;==&#32;&apos;1&apos;,&#32;&quot;red&quot;,&quot;default&quot;)' display="text"/>
						<cell align="center" bkcolor2="user22" col="1" color='expr:iif(CHECK&#32;==&#32;&apos;1&apos;,&#32;&quot;red&quot;,&quot;default&quot;)' display="text" expr="CURROW+1"/>
						<cell align="center" bkcolor2="user22" col="2" colid="CHECK" color='expr:iif(CHECK&#32;==&#32;&apos;1&apos;,&#32;&quot;red&quot;,&quot;default&quot;)' display="checkbox" edit="checkbox"/>
						<cell align="center" bkcolor2="user22" col="3" colid="TEXT30" color='expr:iif(CHECK&#32;==&#32;&apos;1&apos;,&#32;&quot;red&quot;,&quot;default&quot;)' display="text"/>
						<cell align="center" bkcolor2="user22" col="4" colid="POSID" color='expr:iif(CHECK&#32;==&#32;&apos;1&apos;,&#32;&quot;red&quot;,&quot;default&quot;)' display="text"/>
						<cell bkcolor2="user22" col="5" colid="POST1" color='expr:iif(CHECK&#32;==&#32;&apos;1&apos;,&#32;&quot;red&quot;,&quot;default&quot;)' display="text"/>
						<cell align="center" bkcolor2="user22" col="6" colid="CHK_KIND" color='expr:iif(CHECK&#32;==&#32;&apos;1&apos;,&#32;&quot;red&quot;,&quot;default&quot;)' combocol="CODE" combodataset="ds_kind" combotext="CODE_NAME" display="combo"/>
						<cell align="center" bkcolor2="user22" col="7" colid="CHASU" color='expr:iif(CHECK&#32;==&#32;&apos;1&apos;,&#32;&quot;red&quot;,&quot;default&quot;)' display="text"/>
						<cell align="center" bkcolor2="user22" col="8" colid="REQ_DATE" color='expr:iif(CHECK&#32;==&#32;&apos;1&apos;,&#32;&quot;red&quot;,&quot;default&quot;)' display="text" Mask="####.##.##"/>
						<cell align="center" bkcolor2="user22" col="9" colid="REQ_DATE2" color='expr:iif(CHECK&#32;==&#32;&apos;1&apos;,&#32;&quot;red&quot;,&quot;default&quot;)' display="text" Mask="####.##.##"/>
						<cell align="center" bkcolor2="user22" col="10" colid="KEYCODE" color='expr:iif(CHECK&#32;==&#32;&apos;1&apos;,&#32;&quot;red&quot;,&quot;default&quot;)' display="text"/>
						<cell align="center" bkcolor2="user22" col="11" color='expr:iif(CHECK&#32;==&#32;&apos;1&apos;,&#32;&quot;red&quot;,&quot;default&quot;)' display="button" edit="button" text="삭제"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Grid AreaSelect="TRUE" AutoEnter="TRUE" AutoFitEndLine="Hide" BindDataset="ds_to" BkColor2="default" BoldHead="true" Border="Flat" Bottom="553" ColSelect="TRUE" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="486" Id="grd_list_r" InputPanel="FALSE" Left="936" LineColor="user20" LineType="ExHORZ" OnHeadClick="grd_list_OnHeadClick" Right="974" RowHeight="20" Style="sty_grid" TabOrder="9" TabStop="true" Top="67" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="38">
			<contents>
				<format id="Default">
					<columns>
						<col fix="left" width="20"/>
						<col fix="left" width="25"/>
						<col fix="left" width="20"/>
						<col fix="left" width="56"/>
						<col fix="left" width="70"/>
						<col fix="left" width="120"/>
						<col width="55"/>
						<col width="53"/>
						<col width="143"/>
					</columns>
					<head>
						<cell bkimageid="icon_grid_sel" col="0" cursor="hand" display="text"/>
						<cell align="center" col="1" color="user21" display="text" font="굴림,9" text="NO"/>
						<cell align="center" col="2" color="user21" display="checkbox" font="굴림,9"/>
						<cell align="center" col="3" color="user21" display="text" font="굴림,9" text="사무소"/>
						<cell align="center" col="4" color="user21" display="text" font="굴림,9" text="호기번호"/>
						<cell align="center" col="5" color="user21" display="text" font="굴림,9" text="프로젝트명"/>
						<cell align="center" col="6" color="user21" display="text" font="굴림,9" text="검사종류"/>
						<cell align="center" col="7" color="user21" display="text" font="굴림,9" text="차수"/>
						<cell bkcolor="mediumslateblue" col="8" color="user22" display="text" font="굴림,9" text="관리코드"/>
					</head>
					<body>
						<cell align="center" bkimageid='expr:gfn_getFlagBkImageID(getColumn(currow,&#32;&quot;FLAG&quot;))' col="0" color='expr:iif(CHECK&#32;==&#32;&apos;1&apos;,&#32;&quot;red&quot;,&quot;default&quot;)' display="text"/>
						<cell align="center" bkcolor2="user22" col="1" color='expr:iif(CHECK&#32;==&#32;&apos;1&apos;,&#32;&quot;red&quot;,&quot;default&quot;)' display="text" expr="CURROW+1"/>
						<cell align="center" bkcolor2="user22" col="2" colid="CHECK" color='expr:iif(CHECK&#32;==&#32;&apos;1&apos;,&#32;&quot;red&quot;,&quot;default&quot;)' display="checkbox" edit="checkbox"/>
						<cell align="center" bkcolor2="user22" col="3" colid="TEXT30" color='expr:iif(CHECK&#32;==&#32;&apos;1&apos;,&#32;&quot;red&quot;,&quot;default&quot;)' display="text"/>
						<cell align="center" bkcolor2="user22" col="4" colid="POSID" color='expr:iif(CHECK&#32;==&#32;&apos;1&apos;,&#32;&quot;red&quot;,&quot;default&quot;)' display="text"/>
						<cell bkcolor2="user22" col="5" colid="POST1" color='expr:iif(CHECK&#32;==&#32;&apos;1&apos;,&#32;&quot;red&quot;,&quot;default&quot;)' display="text"/>
						<cell align="center" bkcolor2="user22" col="6" colid="CHK_KIND" color='expr:iif(CHECK&#32;==&#32;&apos;1&apos;,&#32;&quot;red&quot;,&quot;default&quot;)' combocol="CODE" combodataset="ds_kind" combotext="CODE_NAME" display="combo"/>
						<cell align="center" bkcolor2="user22" col="7" colid="CHASU" color='expr:iif(CHECK&#32;==&#32;&apos;1&apos;,&#32;&quot;red&quot;,&quot;default&quot;)' display="text"/>
						<cell align="center" bkcolor2="user22" col="8" colid="KEYCODE" color='expr:iif(CHECK&#32;==&#32;&apos;1&apos;,&#32;&quot;red&quot;,&quot;default&quot;)' display="text"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Static Height="16" Id="Static9" Left="520" TabOrder="10" Text="여러&#32;개의&#32;프로젝트를&#32;검색할&#32;때&#32;:&#32;N15671,&#32;N15672&#32;(콤마로&#32;구분)" Top="8" Width="353"></Static>
		<Static Font="맑은&#32;고딕,9,Bold" Height="16" Id="Static0" Left="14" TabOrder="11" Text="※&#32;관리코드&#32;생성&#32;후,&#32;반드시&#32;저장버튼을&#32;클릭하셔야&#32;저장됩니다." Top="41" Width="381"></Static>
		<Static Color="darkblue" Font="맑은&#32;고딕,9,Bold" Height="16" Id="Static1" Left="14" TabOrder="12" Text="1)&#32;관리코드&#32;생성&#32;:&#32;좌측&#32;관리코드에&#32;생성할&#32;데이터를&#32;체크&#32;-&gt;&#32;▶&#32;클릭&#32;-&gt;&#32;우측&#32;관리코드&#32;생성할&#32;데이터&#32;체크&#32;-&gt;&#32;관리코드&#32;생성버튼&#32;클릭&#32;-&gt;&#32;저장버튼&#32;클릭" Top="58" Width="833"></Static>
		<Static Color="darkblue" Font="맑은&#32;고딕,9,Bold" Height="16" Id="Static2" Left="14" TabOrder="13" Text="2)&#32;관리코드&#32;삭제&#32;:&#32;좌측에서&#32;삭제&#32;버튼&#32;클릭&#32;시&#32;관리코드&#32;삭제처리" Top="74" Width="833"></Static>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_init" ImageID="btn_sub_08" Left="1160" LeftMargin="12" OnClick="btn_init_OnClick" Style="sty_btn" TabOrder="15" Text="&#32;관리코드&#32;초기화" Top="5" Transparent="TRUE" Width="120"></Button>
	</Form>
	<Script><![CDATA[﻿﻿﻿﻿﻿﻿﻿﻿/*
 ******************************************************************************************
 * 기      능   : 
 * 작  성  자   : 
 * 작성  일자   : 
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
#include "LIB::commons.js";	// 공통 스크립트 
#include "LIB::utility.js";	// 다중 선택 
//=========================================================================================
// [ PART 1 ]
// Form에서 사용될 전역변수를 선언
// FORM에서 사용되는 전역변수는 대문자로 작성하며, F_XXX 의 형태를 갖도록 한다. 
//=========================================================================================
var userGroup = "";
var name1 = "";
var fv_row = 0;
var F_ADMIN_DEPT = "F7,F6";	// 효율개선부 , 정보기술실(관리부서) 		
var F_ADMIN_YN   = "Y";		// 관리부서 여부
//=========================================================================================
// [ PART 2 ]
// Form Loading / Unloading 시 작업 정의
//=========================================================================================
function fn_OnLoadCompleted(obj) {
	gfn_initForm(true);
	gfn_initDs(ds_cond, true);
	gfn_initDs(ds_img, true);
	
	ds_cond.SetColumn(0, "PSPID", s_pspid);
	//http.Sync = true;

	// 프로젝트 필수체크	
	if(!gfn_isNull(ed_pjt, true, st_pjt.value))
	{
		fn_query();
	}
		
	//http.Sync = false;
	if (IndexOf(F_ADMIN_DEPT, G_DPT1) == -1)		{
		F_ADMIN_YN = "N";		
	}
	

}
/********************************************************************************
* 기      능   : 공통코드가 조회된 후의 Callback 함수 
********************************************************************************/
function fn_completeInit(sCode, sDsObj, sCodeType) {

}
/********************************************************************************
* 기      능   : 조회 Callback  - 리스트의 검사기관 조회
********************************************************************************/
function fn_afterLifnr(errCode, errMsg) {
	
//	gfn_insertEmptyRow(ds_lifnr_cd,G_CODE_ALL);
		
//	cb_write.Index = 0;

}
/********************************************************************************
* 기      능   : form UnloadCompleted 
********************************************************************************/
function fn_OnUnloadCompleted(obj) {
	return gfn_isFormUnload(obj);
}
//=========================================================================================
// [ PART 3 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,form닫기)
//=========================================================================================
/********************************************************************************
* 기      능   : 조회 1
********************************************************************************/
function fn_query() {
    var qry = "";
	var args = "";

	ds_from.ClearData();

	// 프로젝트 필수체크	
	if(gfn_isNull(ed_pjt, true, st_pjt.value))
		return;
		
	/*
	if(chk_co1.Value == '1' || chk_co2.Value == '1' || chk_co3.Value == '1') 
	{
		qry += " AND (B.ZZGUBUN IN (";
		if(chk_co1.Value == '1') qry+= "'10','13'";
		if(chk_co2.Value == '1') qry+= "'11','12','14'";
		if(chk_co3.Value == '1') qry+= "'20',";
		qry+= "'')) ";
		ds_cond.SetColumn(0,"CO_GBN","C");
	}	
		
	args = " SQRY="+quote(qry);	
	*/
	ds_cond.SetColumn(0, "PSPID_LIST", "");
	var arrayP = Array();
	var sPspid = ds_cond.getColumn(0, "PSPID");
	var convert = "";
	

	arrayP = Split(sPspid,",");
	
	convert = "(";
	for(var i=0;i<Length(arrayP);i++)
	{
		convert += "'"+arrayP[i]+"',";
	}
	
	convert = Substr(convert,0,Length(convert)-1);
	convert+=")";
	
	sPspid = convert;
	
	ds_cond.SetColumn(0, "PSPID_LIST", sPspid);
	
	qry= " AND A.POSID IN "+sPspid;

	args = " SQRY="+quote(qry);	

	tit_clearActionInfo();	
	tit_addSearchActionInfo("ps07:PS0710004B_S1");
	tit_callService(
        ""
        , ""
        , "ds_cond=ds_cond"
        , "ds_from=ds_from"
        , args
        , "fn_afterQuery"
        , ""
        , true
        , true);  
        
}
/********************************************************************************
* 기      능   : 삽입 20
********************************************************************************/
function fn_input() {		
}
/********************************************************************************
* 기      능   : Delete 
********************************************************************************/
function fn_delete() {
}
/********************************************************************************
* 기      능   : 저장 
********************************************************************************/
function fn_save() {
	if(ds_to.FindRow("CHECK", 1)==-1){
		gfn_showMsg('CW00046');
		return;
	}
	
	//기존에 관리코드가 생성되어 있으면 어떻게??
	
	ds_keyList.ClearData();
	//생성된 관리코드 반영하여 데이터 생성
	ds_to.Filter("CHECK==1");
	ds_keyList.copyF(ds_to);
	ds_to.unFilter();

	tit_clearActionInfo();
	tit_addMultiActionInfo("ps07:PS0710004A_I2");
	tit_callService(
		""
		, ""
		, "ds_keyList=ds_keyList"
		, ""
		, ""
		, "fn_afterkeyGen"
		, ""
		, ""
		, true);	
}	
/********************************************************************************
* 기      능   : 전송 60
********************************************************************************/
function fn_trans() {
}
/********************************************************************************
* 기      능   : 닫기  
********************************************************************************/
function fn_close() {
	close();
}
/********************************************************************************
* 기      능   : 액셀  
********************************************************************************/
function fn_excel() {
	// Excel Export 
	//gfn_saveToExcel(grd_list, true ); 
}
/********************************************************************************
* 기      능   : 접수 5
********************************************************************************/
function fn_receipt() {
}
/********************************************************************************
* 기      능   : 승인 10
********************************************************************************/
function fn_approval() {
}
/********************************************************************************
* 기      능   : d결재 15
********************************************************************************/
function fn_decide() {
}
/********************************************************************************
* 기      능   : 취소 35
********************************************************************************/
function fn_cancel() {
}
/********************************************************************************
* 기      능   : print 40
********************************************************************************/

/********************************************************************************
* 기      능   : 발행 50
********************************************************************************/
function fn_out() {
}
/********************************************************************************
* 기      능   : 신청 55
********************************************************************************/
function fn_request() {
}
/********************************************************************************
* 기      능   : 반송 65
********************************************************************************/
function fn_sendback() {
}
/********************************************************************************
* 기      능   : 계산 70
********************************************************************************/
function fn_cal() {
}
/********************************************************************************
* 기      능   : 복사 75
********************************************************************************/
function fn_copy() {
}
/********************************************************************************
* 기      능   : 확인 80
********************************************************************************/
function fn_confirm() {
}
//=========================================================================================
// [ PART 4]
// Callback 함수 정의 : callback 함수명은 메인 함수의 fn_xxxx() 에서 xxxx 부분은 fn_afterXXXX()
// 형태가 되도록 작성 
//=========================================================================================
/********************************************************************************
* 기      능   : 조회 Callback  
********************************************************************************/
function fn_afterQuery(errCode, errMsg) {
	// 메시지 처리 
	gfn_showSearchMsg(grd_list_l);

}
/********************************************************************************
* 기      능   : 저장 Callback  
********************************************************************************/
function fn_afterSave(errCode, errMsg) {
	if ( errCode!= 0 ) {
		gfn_showMsg("CE00001");
	} else {
		gfn_showMsg("CI00003");
	}
	
	fn_query();
}
/********************************************************************************
* 기      능   : 삭제 Callback  
********************************************************************************/
function fn_afterDelete(errCode, errMsg) {
	if ( errCode!= 0 ) {
		gfn_showMsg("CE00001");
	} else {
		gfn_showMsg("CI00003");
	}	
	fn_query();
}
//=========================================================================================
// [ PART 5 ]
// Detail Process Event 정의 ( User Define function )
// 사용자 정의 함수는 ufn_xxxx() 형태로 작성 
//=========================================================================================
/********************************************************************************
* 기      능   : 사용자 정의 함수  
********************************************************************************/
function ufn_userfunction() {
}
/********************************************************************************
* 기      능   : master / detail 데이터셋 초기 데이터 셋팅 
********************************************************************************/
function ufn_save(gbn){
}
//=========================================================================================
// [ PART 6 ]
// component Event 정의 : 각 Component 별 이벤트 
//=========================================================================================
/********************************************************************************
* 기      능   : 그리드 헤더 클릭시 정렬 처리 
********************************************************************************/
function grd_list_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
{ 
	if ( nCell == 0 ) 
	{
		gfn_selectGridCol(obj); 
	} 
	else if ( nCell == 1 ) {
		return;
	}
	else if ( nCell == 2) {
		// 그리드 표시할 컬럼 선택 
		gfn_selectAllGrid(obj,nCell,nCell,true);
	} else {
		// 그리드 정렬 처리 
		gfn_sortGrid(obj,nCell);
	}
}
/********************************************************************************
* 기      능   : 데이터셋 값 변경 시 - Flag 처리 
********************************************************************************/
function ds_list_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{ 
}


// ▶ 버튼 클릭 시
function img_Right_OnClick(obj,nX,nY)
{
	if(ds_from.FindRow("CHECK", 1)==-1){
		gfn_showMsg('CW00046');
		return;
	}
	
	ds_from_tmp.ClearData();
	ds_from.Filter("CHECK==1");
	ds_from_tmp.CopyF(ds_from);
	ds_from.UnFilter();
	
	// 체크된 From 내에서 다른 검사종류가 있을 경우 에러
	for(var i=0; i<ds_from.rowcount;i++)
	{
		var sChk     = ds_from.GetColumn(i, "CHECK");
		var sChkKind = ds_from.GetColumn(i, "CHK_KIND");
		var sChasu   = ds_from.GetColumn(i, "CHASU");
		
		if(sChk == '1')
		{
			var nFindRow = ds_from_tmp.searchRow("CHK_KIND!='"+sChkKind+"'");
			
			if(nFindRow >= 0)
			{
				gfn_openMsgWin("검사종류가 다른 현장은 이동이 불가합니다.");
				return;
			}
		}
	}
	
	// From => TO   (TO에 있는 데이터와 비교) - 다른 검사정류가 있을 경우 에러
	for(var i=0; i<ds_from.rowcount; i++)
	{
		//To에 동일한 데이터가 존재할 시 에러메시지
		var sPspid   = ds_from.GetColumn(i, "PSPID");
		var sPosid   = ds_from.GetColumn(i, "POSID");
		var sChkKind = ds_from.GetColumn(i, "CHK_KIND");
		var sChasu   = ds_from.GetColumn(i, "CHASU");
		var sChk     = ds_from.GetColumn(i, "CHECK");
		
		if(sChk == '1')
		{
			var nFindRow  = ds_to.SearchRow("POSID == '"+sPosid+"' && CHK_KIND == '"+sChkKind+"' && CHASU == '"+sChasu+"'");
			var nFindRow2 = ds_to.SearchRow("CHK_KIND != '"+sChkKind+"'");
			
			if(nFindRow >= 0)
			{
				gfn_openMsgWin("이미 선택한 호기입니다.");
				return;
			}
			
			if(nFindRow2 >= 0)
			{
				gfn_openMsgWin("검사종류가 다른 현장의 경우 이동 불가합니다.");
				return;
			}
		}
		
	}
	
	var nAddRow = 0;
	
	// 왼쪽 그리드 -> 오른쪽 그리드로 데이터 이동
	for(var i=0; i<ds_from.rowcount; i++)
	{
		var sChk     = ds_from.GetColumn(i, "CHECK");
		var sKeyCode = ds_from.GetColumn(i, "KEYCODE");
		
		if(sChk == '1' && Length(sKeyCode) == 0)
		{
			nAddRow = ds_to.AddRow();
			ds_to.CopyRow(nAddRow, ds_from, i);
		}
	}
	
	ds_to.Sort("KEYCODE:A TEXT30:A POSID:A CHK_KIND:A CHASU:A");
	
	
}

// ◀ 버튼 클릭 시
function img_Left_OnClick(obj,nX,nY)
{
	if(ds_to.FindRow("CHECK", 1)==-1){
		gfn_showMsg('CW00046');
		return;
	}
	
	//선택된 데이터는 삭제
	for(var i=ds_to.GetRowCount();i>=0;i--)
	{
		var sChk = ds_to.GetColumn(i, "CHECK");
		
		if(sChk == '1')
		{
			ds_to.DeleteRow(i);
		}
	}
}


function grd_list_l_OnCellClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
	//삭제 버튼 클릭 시
	if(nCell == 11)
	{
		var sPspid   = "";
		var sChkKind = "";
		var sChasu   = "";
		var sReqDate = "";
		
		/*
		if(ds_from.SearchRow("CHECK == '1'") < 0)
		{
			// 관리코드를 삭제할 데이터가 선택되지 않았습니다.
			gfn_showMsg("관리코드를 삭제할 데이터가 선택되지 않았습니다.");
			return;
		}
		*/
		
		// 관리코드 삭제
		/*
		ds_from.Filter("CHECK==1");
		ds_keyList.copyF(ds_from);
		ds_from.unFilter();
		*/
		ds_keyList.ClearData();
		ds_keyList.addRow();
		ds_keyList.copyRow(0, ds_from, nRow);
		
		tit_clearActionInfo();
		tit_addMultiActionInfo("ps07:PS0710004A_D1");
		tit_callService(
			""
			, ""
			, "ds_keyList=ds_keyList"
			, ""
			, ""
			, "fn_afterkeyDel"
			, ""
			, ""
			, true);
	}
}

/********************************************************************************
* 기      능   : 관리코드 삭제 후 CALLBACK
********************************************************************************/
function fn_afterkeyDel(errCode, errMsg) {
	if ( errCode != 0 ) {
		gfn_showMsg("CE00001");
	} else {
		fn_query();
		grd_list_l.SetFocus();
	}

}

// 관리코드 생성 버튼 클릭 시
function btn_import_OnClick(obj)
{
	var sPspid   = "";
	var sChkKind = "";
	var sChasu   = "";
	var sReqDate = "";
	
	if(ds_to.SearchRow("CHECK == '1'") < 0)
	{
		gfn_showMsg("관리코드를 생성할 데이터가 선택되지 않았습니다.");
		return;
	}
	
	
	//생성 시 관리코드가 있는 데이터는 생성 불가.
	var nFindRow = ds_to.SearchRow("CHECK == '1' && LENGTH(KEYCODE) != 0");

	if(nFindRow >= 0)
	{
		gfn_showMsg("관리코드가 존재하는 데이터는 생성 불가합니다.");
		return;
	}
	
	var sMaxPspid = ds_to.CaseMax("CHECK=='1'","PSPID");
	var nRow2     = ds_to.SearchRow("CHECK == '1'");
	var sMaxChasu = ds_to.CaseMax("CHECK=='1' && PSPID=='"+sMaxPspid+"'","CHASU");
	var sMaxActss = ds_to.CaseMax("CHECK=='1' && PSPID=='"+sMaxPspid+"'","ZZACTSS");
	
	ds_keyCond.ClearData();
	ds_keyCond.addRow();
	ds_keyCond.SetColumn(0, "PSPID", sMaxPspid);
	ds_keyCond.SetColumn(0, "CHK_KIND", ds_to.GetColumn(nRow2, "CHK_KIND"));
	ds_keyCond.SetColumn(0, "CHASU", sMaxChasu);
	ds_keyCond.SetColumn(0, "ZZACTSS", sMaxActss);
	
	// 관리코드 생성 (동기)
	tit_clearActionInfo();
	tit_addSearchActionInfo("ps07:PS0710004A_S3");
	tit_callService(
		""
		, ""
		, "ds_keyCond=ds_keyCond"
		, "ds_keyGen=ds_keyGen"
		, ""		
		, ""
		, ""
		, ""
		, true);
	
	for(var i=0;i<ds_to.GetRowCount();i++)
	{
		sChk = ds_to.GetColumn(i,"CHECK");
		
		if(sChk == 1)
		{
			ds_to.SetColumn(i, "KEYCODE", ds_keyGen.getColumn(0, "KEYCODE"));
		}
	}
	

}

/********************************************************************************
* 기      능   : 관리코드 생성 후 CALLBACK
********************************************************************************/
function fn_afterkeyGen(errCode, errMsg) {
	if ( errCode != 0 ) {
		gfn_showMsg("CE00001");
	} else {
		ds_to.ClearData();
		fn_query();
		gfn_openMsgWin("저장되었습니다.\nKETF에도 반영해야 정상 작동 합니다.");
	}

}
function btn_init_OnClick(obj)
{
	if(ds_to.GetRowCount() > 0)
	{
		for(var i=0; i< ds_to.GetRowCount();i++)
		{
			ds_to.fireevent = false;
			ds_to.SetColumn(i, "KEYCODE", "");
			ds_to.fireevent = true;
		}
	}
}
]]></Script>
</Window>