<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="562" Id="QM0501001A" Left="8" OnLoadCompleted="fn_OnLoadCompleted" OnUnloadCompleted="fn_OnUnloadCompleted" PidAttrib="7" Title="설치검사요청등록" Top="8" Ver="1.0" Width="978" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_team">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
					<colinfo id="ZZLIFNR" size="256" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME></CODE_NAME>
						<ZZLIFNR></ZZLIFNR>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_check">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME>&#32;</CODE_NAME>
					</record>
					<record>
						<CODE>8950</CODE>
						<CODE_NAME>중간</CODE_NAME>
					</record>
					<record>
						<CODE>8960</CODE>
						<CODE_NAME>완성</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cond">
				<Contents>
					<colinfo id="TEAM" size="256" summ="default" type="STRING"/>
					<colinfo id="FPJT" size="256" summ="default" type="STRING"/>
					<colinfo id="TPJT" size="256" summ="default" type="STRING"/>
					<colinfo id="FHNO" size="256" summ="default" type="STRING"/>
					<colinfo id="THNO" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZACTSS" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZLIFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="USERGROUP" size="256" summ="default" type="STRING"/>
					<record>
						<FHNO></FHNO>
						<FPJT></FPJT>
						<TEAM></TEAM>
						<THNO></THNO>
						<TPJT></TPJT>
						<USERGROUP></USERGROUP>
						<ZZACTSS></ZZACTSS>
						<ZZLIFNR></ZZLIFNR>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list" OnColumnChanged="ufn_chgExamType">
				<Contents>
					<colinfo id="PJT" size="256" summ="default" type="STRING"/>
					<colinfo id="HNO" size="256" summ="default" type="STRING"/>
					<colinfo id="CHASU" size="256" summ="default" type="STRING"/>
					<colinfo id="EXAMTYPE" size="256" summ="default" type="STRING"/>
					<colinfo id="EXAMREQDATE" size="256" summ="default" type="STRING"/>
					<colinfo id="RELEASE" size="256" summ="default" type="STRING"/>
					<colinfo id="STARTDATE" size="256" summ="default" type="STRING"/>
					<colinfo id="FINISHDATE" size="256" summ="default" type="STRING"/>
					<colinfo id="SPEC" size="256" summ="default" type="STRING"/>
					<colinfo id="STEAM" size="256" summ="default" type="STRING"/>
					<colinfo id="STEAMNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNRNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="BGUBUN" size="256" summ="default" type="STRING"/>
					<colinfo id="ADDR" size="256" summ="default" type="STRING"/>
					<colinfo id="ZCITY" size="256" summ="default" type="STRING"/>
					<colinfo id="ZCITYNM" size="256" summ="default" type="STRING"/>
					<colinfo id="EXAMREQUEST" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZACTSS" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSPEC1" size="256" summ="default" type="STRING"/>
					<colinfo id="FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="POST1" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZDAT01" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID_OLD" size="256" summ="default" type="STRING"/>
					<colinfo id="PARQDT" size="256" summ="default" type="STRING"/>
					<colinfo id="FNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="FNAME_PATH" size="256" summ="default" type="STRING"/>
					<colinfo id="FPATH" size="256" summ="default" type="STRING"/>
					<colinfo id="FNAME_APP" size="256" summ="default" type="STRING"/>
					<colinfo id="SPEED" size="256" summ="default" type="STRING"/>
					<colinfo id="RELEASE2" size="256" summ="default" type="STRING"/>
					<colinfo id="PASS" size="256" summ="default" type="STRING"/>
					<colinfo id="N_CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="GUIDCHK" size="256" summ="default" type="STRING"/>
					<colinfo id="FNAME2" size="256" summ="default" type="STRING"/>
					<colinfo id="FNAME_PATH2" size="256" summ="default" type="STRING"/>
					<colinfo id="FPATH2" size="256" summ="default" type="STRING"/>
					<colinfo id="FNAME_APP2" size="256" summ="default" type="STRING"/>
					<colinfo id="DAESU" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSPEC4" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSPEC7" size="256" summ="default" type="STRING"/>
					<colinfo id="G_CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZACTSS_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="DAEGI" size="256" summ="default" type="STRING"/>
					<colinfo id="ACTSS" size="256" summ="default" type="STRING"/>
					<colinfo id="D_CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="S_DATE" size="256" summ="default" type="STRING"/>
					<colinfo id="F_DATE" size="256" summ="default" type="STRING"/>
					<colinfo id="NOPASS" size="256" summ="default" type="STRING"/>
					<colinfo id="PRE_INSP_INDC" size="256" summ="default" type="STRING"/>
					<colinfo id="PASS120" size="256" summ="default" type="STRING"/>
					<colinfo id="PM_CELLP" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_inCond">
				<Contents>
					<colinfo id="LIFNR" size="256" type="STRING"/>
					<colinfo id="TEMNO" size="256" type="STRING"/>
					<record>
						<LIFNR></LIFNR>
						<TEMNO></TEMNO>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_inCount">
				<Contents>
					<colinfo id="COUNT" size="256" type="INT"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_019Cond">
				<Contents>
					<colinfo id="PJT" size="256" type="STRING"/>
					<colinfo id="HNO" size="256" type="STRING"/>
					<colinfo id="EXAMTYPE" size="256" type="STRING"/>
					<colinfo id="MAXSEQ" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_019Result">
				<Contents>
					<colinfo id="MAXSEQ" size="256" type="STRING"/>
					<colinfo id="DSCODE" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_zzactss">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_zzlifnr">
				<Contents>
					<colinfo id="CODE" size="256" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" type="STRING"/>
					<colinfo id="ZZACTSS" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_019Result2">
				<Contents>
					<colinfo id="MAXSEQ" size="256" type="STRING"/>
					<colinfo id="DSCODE" size="256" type="STRING"/>
					<colinfo id="PARQDT" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list_i" OnColumnChanged="ufn_chgExamType">
				<Contents>
					<colinfo id="PJT" size="256" summ="default" type="STRING"/>
					<colinfo id="HNO" size="256" summ="default" type="STRING"/>
					<colinfo id="CHASU" size="256" summ="default" type="STRING"/>
					<colinfo id="EXAMTYPE" size="256" summ="default" type="STRING"/>
					<colinfo id="EXAMREQDATE" size="256" summ="default" type="STRING"/>
					<colinfo id="RELEASE" size="256" summ="default" type="STRING"/>
					<colinfo id="STARTDATE" size="256" summ="default" type="STRING"/>
					<colinfo id="FINISHDATE" size="256" summ="default" type="STRING"/>
					<colinfo id="SPEC" size="256" summ="default" type="STRING"/>
					<colinfo id="STEAM" size="256" summ="default" type="STRING"/>
					<colinfo id="STEAMNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNRNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="BGUBUN" size="256" summ="default" type="STRING"/>
					<colinfo id="ADDR" size="256" summ="default" type="STRING"/>
					<colinfo id="ZCITY" size="256" summ="default" type="STRING"/>
					<colinfo id="ZCITYNM" size="256" summ="default" type="STRING"/>
					<colinfo id="EXAMREQUEST" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZACTSS" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSPEC1" size="256" summ="default" type="STRING"/>
					<colinfo id="FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="POST1" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZDAT01" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID_OLD" size="256" summ="default" type="STRING"/>
					<colinfo id="PARQDT" size="256" summ="default" type="STRING"/>
					<colinfo id="FNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="FNAME_PATH" size="256" summ="default" type="STRING"/>
					<colinfo id="FPATH" size="256" summ="default" type="STRING"/>
					<colinfo id="FNAME_APP" size="256" summ="default" type="STRING"/>
					<colinfo id="SPEED" size="256" summ="default" type="STRING"/>
					<colinfo id="DAEGI" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_release">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME></CODE_NAME>
					</record>
					<record>
						<CODE>A</CODE>
						<CODE_NAME>면제</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_n">
				<Contents>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_NAME" size="256" summ="default" type="STRING"/>
					<record>
						<CODE></CODE>
						<CODE_NAME></CODE_NAME>
					</record>
					<record>
						<CODE>A</CODE>
						<CODE_NAME>유</CODE_NAME>
					</record>
					<record>
						<CODE>B</CODE>
						<CODE_NAME>무</CODE_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list_j" OnColumnChanged="ufn_chgExamType">
				<Contents>
					<colinfo id="PJT" size="256" summ="default" type="STRING"/>
					<colinfo id="HNO" size="256" summ="default" type="STRING"/>
					<colinfo id="CHASU" size="256" summ="default" type="STRING"/>
					<colinfo id="EXAMTYPE" size="256" summ="default" type="STRING"/>
					<colinfo id="EXAMREQDATE" size="256" summ="default" type="STRING"/>
					<colinfo id="RELEASE" size="256" summ="default" type="STRING"/>
					<colinfo id="STARTDATE" size="256" summ="default" type="STRING"/>
					<colinfo id="FINISHDATE" size="256" summ="default" type="STRING"/>
					<colinfo id="SPEC" size="256" summ="default" type="STRING"/>
					<colinfo id="STEAM" size="256" summ="default" type="STRING"/>
					<colinfo id="STEAMNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNRNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="BGUBUN" size="256" summ="default" type="STRING"/>
					<colinfo id="ADDR" size="256" summ="default" type="STRING"/>
					<colinfo id="ZCITY" size="256" summ="default" type="STRING"/>
					<colinfo id="ZCITYNM" size="256" summ="default" type="STRING"/>
					<colinfo id="EXAMREQUEST" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZACTSS" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSPEC1" size="256" summ="default" type="STRING"/>
					<colinfo id="FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="POST1" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZDAT01" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID_OLD" size="256" summ="default" type="STRING"/>
					<colinfo id="PARQDT" size="256" summ="default" type="STRING"/>
					<colinfo id="FNAME2" size="256" summ="default" type="STRING"/>
					<colinfo id="FNAME_PATH2" size="256" summ="default" type="STRING"/>
					<colinfo id="FPATH2" size="256" summ="default" type="STRING"/>
					<colinfo id="FNAME_APP2" size="256" summ="default" type="STRING"/>
					<colinfo id="SPEED" size="256" summ="default" type="STRING"/>
					<colinfo id="DAEGI" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_end">
				<Contents>
					<colinfo id="DATE_F" size="256" summ="default" type="STRING"/>
					<colinfo id="DATE_T" size="256" summ="default" type="STRING"/>
					<colinfo id="MDATE" size="256" summ="default" type="STRING"/>
					<colinfo id="MTIME" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list_d">
				<Contents>
					<colinfo id="MDATE" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZACTSS" size="256" summ="default" type="STRING"/>
					<colinfo id="DAESU" size="256" summ="default" type="STRING"/>
					<colinfo id="DAESU_C" size="256" summ="default" type="STRING"/>
					<colinfo id="DAESU_T" size="256" summ="default" type="STRING"/>
					<colinfo id="DAESU_H" size="256" summ="default" type="STRING"/>
					<colinfo id="DAESU_J" size="256" summ="default" type="STRING"/>
					<colinfo id="DAESU_CK" size="256" summ="default" type="STRING"/>
					<colinfo id="DAESU_H2" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_exam">
				<Contents>
					<colinfo id="EXAMREQDATE" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZACTSS" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_eCount">
				<Contents>
					<colinfo id="ZDATE" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list_d2">
				<Contents>
					<colinfo id="MDATE" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZACTSS" size="256" summ="default" type="STRING"/>
					<colinfo id="DAESU" size="256" summ="default" type="STRING"/>
					<colinfo id="DAESU_C" size="256" summ="default" type="STRING"/>
					<colinfo id="DAESU_T" size="256" summ="default" type="STRING"/>
					<colinfo id="DAESU_H" size="256" summ="default" type="STRING"/>
					<colinfo id="DAESU_J" size="256" summ="default" type="STRING"/>
					<colinfo id="DAESU_CK" size="256" summ="default" type="STRING"/>
					<colinfo id="DAESU_H2" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_daegi">
				<Contents></Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_excel">
				<Contents>
					<colinfo id="Col01" size="256" summ="default" type="STRING"/>
					<colinfo id="Col02" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="dsObj">
				<Contents>
					<colinfo id="A" size="256" summ="default" type="STRING"/>
					<colinfo id="B" size="256" summ="default" type="STRING"/>
					<colinfo id="C" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_list_sms" OnColumnChanged="ufn_chgExamType">
				<Contents>
					<colinfo id="PJT" size="256" summ="default" type="STRING"/>
					<colinfo id="HNO" size="256" summ="default" type="STRING"/>
					<colinfo id="CHASU" size="256" summ="default" type="STRING"/>
					<colinfo id="EXAMTYPE" size="256" summ="default" type="STRING"/>
					<colinfo id="EXAMREQDATE" size="256" summ="default" type="STRING"/>
					<colinfo id="RELEASE" size="256" summ="default" type="STRING"/>
					<colinfo id="STARTDATE" size="256" summ="default" type="STRING"/>
					<colinfo id="FINISHDATE" size="256" summ="default" type="STRING"/>
					<colinfo id="SPEC" size="256" summ="default" type="STRING"/>
					<colinfo id="STEAM" size="256" summ="default" type="STRING"/>
					<colinfo id="STEAMNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNR" size="256" summ="default" type="STRING"/>
					<colinfo id="LIFNRNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="BGUBUN" size="256" summ="default" type="STRING"/>
					<colinfo id="ADDR" size="256" summ="default" type="STRING"/>
					<colinfo id="ZCITY" size="256" summ="default" type="STRING"/>
					<colinfo id="ZCITYNM" size="256" summ="default" type="STRING"/>
					<colinfo id="EXAMREQUEST" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZACTSS" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSPEC1" size="256" summ="default" type="STRING"/>
					<colinfo id="FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="POST1" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZDAT01" size="256" summ="default" type="STRING"/>
					<colinfo id="POSID_OLD" size="256" summ="default" type="STRING"/>
					<colinfo id="PARQDT" size="256" summ="default" type="STRING"/>
					<colinfo id="FNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="FNAME_PATH" size="256" summ="default" type="STRING"/>
					<colinfo id="FPATH" size="256" summ="default" type="STRING"/>
					<colinfo id="FNAME_APP" size="256" summ="default" type="STRING"/>
					<colinfo id="SPEED" size="256" summ="default" type="STRING"/>
					<colinfo id="RELEASE2" size="256" summ="default" type="STRING"/>
					<colinfo id="PASS" size="256" summ="default" type="STRING"/>
					<colinfo id="N_CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="GUIDCHK" size="256" summ="default" type="STRING"/>
					<colinfo id="FNAME2" size="256" summ="default" type="STRING"/>
					<colinfo id="FNAME_PATH2" size="256" summ="default" type="STRING"/>
					<colinfo id="FPATH2" size="256" summ="default" type="STRING"/>
					<colinfo id="FNAME_APP2" size="256" summ="default" type="STRING"/>
					<colinfo id="DAESU" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSPEC4" size="256" summ="default" type="STRING"/>
					<colinfo id="ZSPEC7" size="256" summ="default" type="STRING"/>
					<colinfo id="G_CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="ZZACTSS_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="DAEGI" size="256" summ="default" type="STRING"/>
					<colinfo id="ACTSS" size="256" summ="default" type="STRING"/>
					<colinfo id="D_CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="S_DATE" size="256" summ="default" type="STRING"/>
					<colinfo id="F_DATE" size="256" summ="default" type="STRING"/>
					<colinfo id="NOPASS" size="256" summ="default" type="STRING"/>
					<colinfo id="PRE_INSP_INDC" size="256" summ="default" type="STRING"/>
					<colinfo id="PASS120" size="256" summ="default" type="STRING"/>
					<colinfo id="PM_CELLP" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_sendMms">
				<Contents>
					<colinfo id="TRAN_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="TRAN_PHONE" size="256" summ="default" type="STRING"/>
					<colinfo id="TRAN_CALLBACK" size="256" summ="default" type="STRING"/>
					<colinfo id="TRAN_MSG" size="256" summ="default" type="STRING"/>
					<colinfo id="TRAN_ETC1" size="256" summ="default" type="STRING"/>
					<colinfo id="TRAN_ETC2" size="256" summ="default" type="STRING"/>
					<colinfo id="SUBJECT" size="256" summ="default" type="STRING"/>
					<colinfo id="HOGI" size="256" summ="default" type="STRING"/>
					<colinfo id="ART" size="256" summ="default" type="STRING"/>
					<colinfo id="PARQDT" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="TEMNONM" size="256" summ="default" type="STRING"/>
					<colinfo id="PM_CELLP" size="256" summ="default" type="STRING"/>
					<colinfo id="CELLPT" size="256" summ="default" type="STRING"/>
					<colinfo id="MSG_1" size="256" summ="default" type="STRING"/>
					<colinfo id="MSG_2" size="256" summ="default" type="STRING"/>
					<colinfo id="POST1" size="256" summ="default" type="STRING"/>
					<colinfo id="TEXT1" size="256" summ="default" type="STRING"/>
					<colinfo id="TRAN_TIME" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_datetime">
				<Contents>
					<colinfo id="DATETIME" size="255" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
		</Datasets>
		<Shape BKColor="user0" Bottom="30" Height="30" Id="Shape0" Left="0" LineColor="user1" Right="978" TabOrder="1" Top="0" Type="Rectangle" Width="978"></Shape>
		<Static Align="Right" Height="20" Id="Static0" Left="5" Style="sty_lb_search" TabOrder="2" Text="설치업체&#32;" Top="5" VAlign="Middle" Width="80"></Static>
		<Edit Border="Flat" Enable="FALSE" Height="20" Id="ed_sTeam" Left="87" Style="sty_ipt_search" TabOrder="3" Top="5" Width="107"></Edit>
		<Shape BKColor="user12" Bottom="88" Height="26" Id="Shape1" Left="10" LineColor="user13" Right="1217" TabOrder="4" Top="62" Type="Rectangle" Width="1207"></Shape>
		<Static Align="Right" Height="24" Id="Static4" Left="427" Style="sty_lb_form_basic" TabOrder="5" Text="설치팀&#32;" Top="63" VAlign="Middle" Width="80"></Static>
		<Static Align="Right" Height="24" Id="Static11" Left="623" Style="sty_lb_form_basic" TabOrder="6" Text="프로젝트&#32;" Top="63" VAlign="Middle" Width="80"></Static>
		<Edit BindDataset="ds_cond" Border="Flat" CheckLength="Byte" Column="FPJT" Height="20" Id="ed_fPjt" ImeMode="english" Left="706" LeftMargin="4" MaxLength="6" RightMargin="4" Style="sty_ipt_form" TabOrder="7" Top="65" UpperOnly="TRUE" Width="87"></Edit>
		<Edit BindDataset="ds_cond" Border="Flat" CheckLength="Byte" Column="TPJT" Height="20" Id="ed_tPjt" ImeMode="english" Left="834" LeftMargin="4" MaxLength="6" RightMargin="4" Style="sty_ipt_form" TabOrder="8" Top="65" UpperOnly="TRUE" Width="87"></Edit>
		<Static Align="Center" Border="None" Color="user7" Font="굴림,9" Height="20" Id="Static2" Left="816" TabOrder="9" Text="~" Top="65" VAlign="Middle" Width="16"></Static>
		<Grid AutoEnter="TRUE" AutoFitEndLine="Hide" BindDataset="ds_list" BkColor2="default" BoldHead="true" Border="Flat" Bottom="552" CellMoving="TRUE" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" FixedColSizing="TRUE" HeadBorder="Flat" HeadHeight="20" Height="448" Id="grd_list" InputPanel="FALSE" Left="8" LineColor="user20" LineType="ExHORZ" OnCellClick="grd_list_OnCellClick" OnExpandEdit="grd_list_OnExpandEdit" OnHeadClick="grd_list_OnHeadClick" Right="966" RowHeight="20" Style="sty_grid" TabOrder="10" TabStop="true" Top="104" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="958">
			<contents>
				<format id="Default">
					<columns>
						<col fix="left" width="39"/>
						<col fix="left" width="60"/>
						<col fix="left" width="130"/>
						<col fix="left" width="65"/>
						<col width="50"/>
						<col width="80"/>
						<col width="70"/>
						<col width="70"/>
						<col width="73"/>
						<col width="60"/>
						<col width="80"/>
						<col width="74"/>
						<col width="50"/>
						<col width="50"/>
						<col width="68"/>
						<col width="130"/>
						<col width="60"/>
						<col width="300"/>
						<col width="60"/>
						<col width="60"/>
						<col width="80"/>
						<col width="110"/>
						<col width="65"/>
						<col width="150"/>
						<col width="80"/>
						<col width="150"/>
						<col width="50"/>
						<col width="0"/>
						<col width="0"/>
						<col width="0"/>
					</columns>
					<head>
						<cell bkimageid="icon_grid_sel" col="0" display="text"/>
						<cell align="center" col="1" display="text" font="굴림,9" text="PROJECT"/>
						<cell align="center" col="2" display="text" font="굴림,9" text="PROJECT명"/>
						<cell align="center" col="3" display="text" font="굴림,9" text="호기"/>
						<cell align="center" col="4" display="text" font="굴림,9" text="차수"/>
						<cell align="center" col="5" display="text" font="굴림,9" text="검사유형"/>
						<cell align="center" col="6" display="text" font="굴림,9" text="착공일"/>
						<cell align="center" col="7" display="text" font="굴림,9" text="준공일"/>
						<cell align="center" col="8" display="text" font="굴림,9" text="우수설치팀"/>
						<cell align="center" col="9" display="text" font="굴림,9" text="검사신청"/>
						<cell align="center" col="10" display="text" font="굴림,9" text="검사요청일"/>
						<cell align="center" col="11" display="text" font="굴림,9" text="관리자권한"/>
						<cell align="center" col="12" display="text" font="굴림,9" text="지도"/>
						<cell align="center" col="13" display="text" font="굴림,9" text="대기"/>
						<cell align="center" col="14" display="text" font="굴림,9" text="대기일정"/>
						<cell align="center" col="15" display="text" font="굴림,9" text="SPEC"/>
						<cell col="16" display="text" font="굴림,9" text="사무소"/>
						<cell align="center" col="17" display="text" font="굴림,9" text="설치지역&#32;주소"/>
						<cell align="center" col="18" display="text" font="굴림,9" text="설치팀"/>
						<cell align="center" col="19" display="text" font="굴림,9" text="설치팀명"/>
						<cell align="center" col="20" display="text" font="굴림,9" text="업체코드"/>
						<cell align="center" col="21" display="text" font="굴림,9" text="업체명"/>
						<cell align="center" col="22" display="text" font="굴림,9" text="현장호기"/>
						<cell align="center" col="23" display="text" font="굴림,9" text="현장이미지"/>
						<cell align="center" col="24" display="text" font="굴림,9" text="감리단검사"/>
						<cell align="center" col="25" display="text" font="굴림,9" text="감리단&#32;검사&#32;시트"/>
						<cell align="center" col="26" display="text" font="굴림,9" text="대수"/>
						<cell align="center" col="27" display="text" font="굴림,9" text="용도"/>
						<cell align="center" col="28" display="text" font="굴림,9" text="층수"/>
						<cell col="29" display="text" text="대기체크"/>
					</head>
					<body>
						<cell align="center" bkcolor2="user22" col="0" display="text" expr="currow+1"/>
						<cell align="center" bkcolor2="user22" col="1" colid="PJT" display="text"/>
						<cell align="left" bkcolor2="user22" col="2" colid="POST1" display="text"/>
						<cell align="center" bkcolor2="user22" col="3" colid="HNO" display="text"/>
						<cell align="center" bkcolor2="user22" col="4" colid="CHASU" display="text"/>
						<cell align="center" bkcolor2="user22" bkimagealign="right" bkimageid="icon_grid_edit" col="5" colid="EXAMTYPE" combocol="CODE" combodataset="ds_check" combotext="CODE_NAME" display="combo" edit="combo"/>
						<cell align="center" bkcolor2="user22" col="6" colid="ZZDAT01" display="text" Mask="####.##.##"/>
						<cell align="center" bkcolor2="user22" col="7" colid="FINISHDATE" display="text" Mask="####.##.##"/>
						<cell align="center" bkcolor2="user22" col="8" colid="RELEASE2" combocol="CODE" combodataset="ds_release" combotext="CODE_NAME" display="combo" edit='expr:iif(length(EXAMTYPE)&#32;&gt;&#32;0&#32;&amp;&amp;&#32;length(EXAMREQDATE)&#32;&gt;&#32;0&#32;,&quot;combo&quot;&#32;,&quot;none&quot;)'/>
						<cell bkcolor2="user22" bkimagealign="right" bkimageid="icon_grid_edit" col="9" colid="EXAMREQUEST" display="checkbox" edit="checkbox"/>
						<cell align="center" bkcolor2="user22" col="10" colid="EXAMREQDATE" display="text" expandimage="btn_grid_icon_pen" expandshow="true" expandsize="18" Mask="####.##.##"/>
						<cell bkcolor2="user22" bkimagealign="right" bkimageid="icon_grid_edit" col="11" colid="G_CHK" display="checkbox" edit='expr:iif(F_ADMIN_YN&#32;==&#32;&quot;Y&quot;&#32;,&quot;checkbox&quot;&#32;,&quot;none&quot;)'/>
						<cell bkcolor2="user22" bkimagealign="right" bkimageid="icon_grid_edit" col="12" colid="GUIDCHK" display="checkbox" edit="checkbox"/>
						<cell bkcolor2="user22" bkimagealign="right" bkimageid="icon_grid_edit" col="13" colid="DAEGI" display="checkbox" edit="checkbox"/>
						<cell align="center" bkcolor2="user22" col="14" display="button" edit="button" text="일정입력"/>
						<cell bkcolor2="user22" col="15" colid="SPEC" display="text"/>
						<cell align="center" col="16" colid="ZZACTSS_NM" display="text"/>
						<cell align="left" bkcolor2="user22" col="17" colid="ADDR" display="text"/>
						<cell align="center" bkcolor2="user22" col="18" colid="STEAM" display="text"/>
						<cell align="center" bkcolor2="user22" col="19" colid="STEAMNAME" display="text"/>
						<cell align="center" bkcolor2="user22" col="20" colid="LIFNR" display="text"/>
						<cell bkcolor2="user22" col="21" colid="LIFNRNAME" display="text"/>
						<cell align="center" bkcolor2="user22" col="22" colid="POSID_OLD" display="text"/>
						<cell bkcolor2="user22" col="23" colid="FNAME" display="text" expandimage="expr:ufn_expandImg()" expandshow="expr:ufn_expandShow()"/>
						<cell align="center" bkcolor2="user22" bkimagealign="right" bkimageid="icon_grid_edit" col="24" colid="N_CHK" combocol="CODE" combodataset="ds_n" combotext="CODE_NAME" display="combo" edit="combo"/>
						<cell bkcolor2="user22" col="25" colid="FNAME2" display="text" expandimage="expr:ufn_expandImg()" expandshow="expr:ufn_expandShow()"/>
						<cell align="left" bkcolor2="user22" col="26" colid="DAESU" display="number" Mask="##.#"/>
						<cell align="left" bkcolor2="user22" col="27" colid="ZSPEC4" display="text"/>
						<cell align="left" bkcolor2="user22" col="28" colid="ZSPEC7" display="number"/>
						<cell col="29" colid="D_CHK" display="text"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="CODE" Column="TEAM" DataColumn="CODE_NAME" Height="20" Id="cb_team" InnerDataset="ds_team" Left="508" Style="sty_ipt_form" TabOrder="11" Top="64" Width="110"></Combo>
		<Calendar Border="Flat" ClickedBkColor="user32" ClickedTextColor="user33" Dateformat="yyyy.MM.dd" DayFont="돋움,9" DaySelect="Auto" DaySpacingHeight="6" DrawWeekSeparator="FALSE" EditAlign="CENTER" Font="돋움,9" HeaderBorder="NONE" HeaderFont="돋움,10,Bold" Height="146" Id="cal_temp" Left="984" MonthOnly="TRUE" MonthPickerFormat="yyyy년&#32;MMMM" MonthPopupBorder="FLAT" OnDayClick="cal_temp_OnDayClick" OnKillFocus="cal_temp_OnKillFocus" SaturdayTextColor="user34" SelectedDayFont="돋움,9,Bold" Style="sty_ipt_form" SundayTextColor="user35" TabOrder="12" TextColor="user36" TitleBKColor="user37" TitleTextColor="user38" TodayColor="user39" Top="96" Value="20080401" Visible="FALSE" WeekBKColor="user40" WeekColor="user41" WeeksFont="돋움,10" Width="152"></Calendar>
		<Button Height="18" Id="btn_fPjt" ImageID="btn_icon_search" Left="795" OnClick="btn_pjt_OnClick" TabOrder="13" Text="Button0" Top="66" Width="18"></Button>
		<Button Height="18" Id="btn_tPjt" ImageID="btn_icon_search" Left="923" OnClick="btn_pjt_OnClick" TabOrder="14" Text="Button0" Top="66" Width="18"></Button>
		<Static Align="Right" Height="24" Id="Static1" Left="11" Style="sty_lb_form_basic" TabOrder="15" Text="사무소&#32;" Top="63" VAlign="Middle" Width="80"></Static>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="CODE" Column="ZZACTSS" DataColumn="CODE_NAME" Height="20" Id="cb_zzactss" InnerDataset="ds_zzactss" Left="92" OnChanged="cb_zzactss_OnChanged" Style="sty_ipt_search" TabOrder="16" Top="64" Width="124"></Combo>
		<Static Align="Right" Height="24" Id="Static3" Left="219" Style="sty_lb_form_basic" TabOrder="17" Text="협력업체&#32;" Top="63" VAlign="Middle" Width="80"></Static>
		<Combo BindDataset="ds_cond" Border="Flat" CodeColumn="CODE" Column="ZZLIFNR" DataColumn="CODE_NAME" Height="20" Id="cb_zzlifnr" InnerDataset="ds_zzlifnr" Left="300" OnChanged="cb_zzlifnr_OnChanged" Style="sty_ipt_search" TabOrder="18" Top="64" Width="124"></Combo>
		<Static Height="18" Id="st_examreqdate" Left="12" TabOrder="19" Text="검사요청일" Top="579" Visible="FALSE" Width="100"></Static>
		<FileDialog Bottom="48" FilePath="c:\" Height="24" Id="saveDialog" Left="1159" Right="1183" TabOrder="21" Top="24" Type="Save" Width="24"></FileDialog>
		<File Bottom="48" Height="24" Id="f_tmp" Left="1128" Right="1152" TabOrder="22" Top="24" Width="24"></File>
		<CyHttpFile Height="24" Id="httpFile" Left="1095" Top="24" Width="24"></CyHttpFile>
		<FileDialog Bottom="48" Height="24" Id="fileDialog" Left="1059" Right="1083" TabOrder="20" Top="24" Width="24"></FileDialog>
		<Static Color="user8" Font="Default,8" Height="26" Id="Static5" Left="234" TabOrder="20" Text="E/L:105M/M&#32;이하,&#32;E/S류는&#32;전체가&#32;중간검사&#32;진행하지&#32;않음.&#32;단,&#32;완성검사시&#32;중간검사와&#32;관련된&#32;당사&#32;검사기준&#32;불일치항목&#13;&#10;(레일연결부,&#32;레일간거리&#32;등)은&#32;설치협력사에서&#32;조치완료후&#32;보수인계한다." Top="3" Width="678"></Static>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_pre_plan" ImageID="btn_sub_07" Left="756" LeftMargin="12" OnClick="fn_btn_pre_plan_OnClick" Style="sty_btn" TabOrder="21" TabStop="FALSE" Text="우수설치팀관리" Top="36" Transparent="TRUE" Width="110"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_end" ImageID="btn_sub_02" Left="344" LeftMargin="12" OnClick="btn_end_OnClick" Style="sty_btn" TabOrder="22" TabStop="FALSE" Text="마감" Top="37" Transparent="TRUE" Width="50"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_daesu" ImageID="btn_sub_06" Left="872" LeftMargin="12" OnClick="btn_daesu_OnClick" Style="sty_btn" TabOrder="23" TabStop="FALSE" Text="신청대수확인" Top="36" Transparent="TRUE" Width="96"></Button>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_baltop" ImageID="btn_sub_08" Left="626" LeftMargin="12" OnClick="btn_baltop_OnClick" Style="sty_btn" TabOrder="24" TabStop="FALSE" Text="불합격상위설치팀" Top="36" Transparent="TRUE" Width="120"></Button>
		<Static Height="11" Id="stc_content" Left="954" TabOrder="25" Text="프로젝트&#32;번호는&#32;좌/우&#32;하나만&#32;입력해도&#32;됩니다." Top="69" Width="259"></Static>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_midInspTeam" ImageID="btn_sub_16" Left="400" LeftMargin="12" OnClick="btn_midInspTeam_OnClick" Style="sty_btn" TabOrder="26" TabStop="FALSE" Text="105&#32;및&#32;120m/min&#32;중간검사&#32;대상팀" Top="36" Transparent="TRUE" Width="217"></Button>
	</Form>
	<Script><![CDATA[/*
 ******************************************************************************************
 * 기      능   : 
 * 작  성  자   : 
 * 작성  일자   : 
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
#include "LIB::commons.js";	// 공통 스크립트 
//=========================================================================================
// [ PART 1 ]
// Form에서 사용될 전역변수를 선언
// FORM에서 사용되는 전역변수는 대문자로 작성하며, F_XXX 의 형태를 갖도록 한다. 
//        *DSCODE*
//        A : 합격
//        B : 자체검사합격 
//        C : 조건부합격
//        D : 면제
//        H : 협조
//        J : 취소
//        K : 보류
//        M : 자재/건축보류
//        N : 불합격 
//        R : 불합격(*)
//=========================================================================================
var userGroup = "";
var imgUploadFlg = "VIEW"; //권한별 이미지 업로드 여부 "":업로드, "VIEW":보기
var lv_speed = 0; //속도
var lv_nopass = ""; // 불합격상위팀
var lv_pass120 = ""; // 120m/min 중간검사 대상팀
var lv_preInspIndc = "";
var lv_dcrg = "";
var lv_dcwrg = "";
var F_ADMIN_DEPT = "F7,F6";	// 효율개선부 , 정보기술실(관리부서) 		
var F_ADMIN_YN   = "Y";		// 관리부서 여부
var F_ZZACTSS = ""; // 사무소 
var F_GROUP = ""; // 권한 
 
var F_PJT = ""; // PJT
var F_HOGI = ""; // HOGI 
var F_TYPE = ""; // 검사유형
var F_CHASU = ""; //차수 
var F_PAPRDT = "";//검사신청일
//=========================================================================================
// [ PART 2 ]
// Form Loading / Unloading 시 작업 정의
//=========================================================================================
function fn_OnLoadCompleted(obj) {
	gfn_initForm(true);

	userGroup = gfn_getUserGroup();
	
	ed_sTeam.Text = G_VEND_NAME;

	var codeArr = ["PS003"];
    var dsObjArr = [ds_zzactss];
    var addTypeArr = [G_CODE_ALL];
    gfn_searchCommCode(codeArr, dsObjArr, addTypeArr);
	

	//Trace(G_DPT1);
    ds_cond.SetColumn(0,"USERGROUP",userGroup);
	//alert(getDate()); 
	fn_initQuery();
}
/********************************************************************************
* 기      능   : 공통코드가 조회된 후의 Callback 함수 
********************************************************************************/
function fn_completeInit(sCode, sDsObj, sCodeType) {
//alert(G_DPT1);
   if (IndexOf(F_ADMIN_DEPT, G_DPT1) == -1)		{
		F_ADMIN_YN = "N";		
	}
	if(userGroup == '10')
	{
		cb_zzactss.Index = 0;
		cb_zzactss.Enable = false;
		imgUploadFlg = "";
	}
	else if(userGroup == '30')
	{
		cb_zzactss.Index = ds_zzactss.SearchRow("CODE=="+quote(G_AREA_CODE_E));
		cb_zzactss.Enable = true;
	}
	else
	{
		cb_zzactss.Index = 0;
		cb_zzactss.Enable = true;
		imgUploadFlg = "";
	}
}
/********************************************************************************
* 기      능   : form UnloadCompleted 
********************************************************************************/
function fn_OnUnloadCompleted(obj) {
	return gfn_isFormUnload(obj);
}
//=========================================================================================
// [ PART 3 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,form닫기)
//=========================================================================================
/********************************************************************************
* 기      능   : 조회 1
********************************************************************************/
function fn_query() {
	if(ufn_checkQuery()){


       ds_daegi.deleteAll(); 
    //    ds_list_d2.ClearData();
	 
		tit_clearActionInfo();
		tit_addSearchActionInfo("qm05:QM0501001A_S2");
	//	tit_addSearchActionInfo("qm05:QM0501001A_S10");
	//	tit_addSearchActionInfo("qm05:QM0501001A_S11");
		tit_callService(
			""
			, ""
			, "ds_cond=ds_cond"
			, "ds_list=ds_list"// ds_end=ds_end ds_list_d=ds_list_d"
			, ""
			, "fn_afterQuery"
			, true);
	}
}
function ufn_checkQuery(){
/*
	if ( !gfn_checkFromToObj(ed_fPjt, ed_tPjt, true, "Pjt No From,To", 0, true)   ) 
	{
    	return;
	}
*/	
	var sFpjt = ds_cond.GetColumn(0,"FPJT");
	var sTpjt = ds_cond.GetColumn(0,"TPJT");
	
	// 프로젝트 From, To 둘다 비어있을 경우
	if((Length(sFpjt) == 0 || sFpjt == "") && (Length(sTpjt) == 0 || sTpjt == ""))
	{
		gfn_showAlert("프로젝트 번호를 입력하세요.");
		return false;
	}
	
	
	/*
	if(sFpjt > sTpjt){
		//alert("Pjt No From,To 를 확인하세요. ");
		gfn_showAlert("CW00022","Pjt No From,To");
		return false;		
	}
	*/
	
	return true;
}
function fn_initQuery() {
	tit_clearActionInfo();
	tit_addSearchActionInfo("qm05:QM0501001A_S1");
	tit_addSearchActionInfo("ps02:PS0203001A_S1");
	tit_callService(
        ""
        , ""
        , "ds_cond=ds_cond"
        , "ds_team=ds_team ds_zzlifnr=ds_zzlifnr"
        , ""
        , "fn_afterInitQuery"
        , true);
}
function fn_afterInitQuery(){
	if(userGroup == '10')
	{
		ds_zzlifnr.Filter("CODE=="+quote(G_VEND_CODE_E));
		cb_zzlifnr.Index = 0;
		cb_zzlifnr.Enable = false;
		
		ds_team.Filter("ZZLIFNR=="+quote(G_VEND_CODE_E)+" || CODE==''");
		cb_team.Index = 0;
		cb_team.Enable = true;
	}
	else if(userGroup == '30')
	{
		gfn_insertEmptyRow( ds_zzlifnr, G_CODE_ALL );
		ds_zzlifnr.Filter("ZZACTSS=="+quote(G_AREA_CODE_E)+" || CODE==''");
		cb_zzlifnr.Index = 0;
		cb_zzlifnr.Enable = true;
	}
	else
	{
		gfn_insertEmptyRow( ds_zzlifnr, G_CODE_ALL );
		cb_zzlifnr.Index = 0;
		cb_zzlifnr.Enable = true;
	}
	gfn_insertEmptyRow( ds_team, G_CODE_ALL );
	cb_team.Index = 0;
}
/********************************************************************************
* 기      능   : 삽입 20
********************************************************************************/
function fn_insert() {
	// 그리드에 row 추가 
	var newRow = gfn_addGridRow(grd_list, -1, "FLAG");
}
/********************************************************************************
* 기      능   : Delete 
********************************************************************************/
function fn_delete() {
	if ( ds_list.rowCount() < 1 ) {
		// 삭제할 정보 없음. 	
		return;
	}
	
	// Grid 삭제 처리 
	gfn_deleteGridRow( grd_list, ds_list.row, "FLAG" );
}
/********************************************************************************
* 기      능   : 저장 
********************************************************************************/
function fn_save() {
	if(fn_checkSave()){
//alert("쨘!");
	var fileName = "";
		var fileName2 = "";
//fn_afterSave();
    //   trace(ds_list_d.SaveXML());
	//file서버에 이미지 저장
		
		for(var i = 0; i < ds_list.rowcount; i++)
		{
	      if(ds_list.getColumn(i, "GUIDCHK") == '1')
	      {
	         //ds_list.SetColumn(i, "GUIDCHK", 'X');
	      }
	      
	      	  for (var j= ds_daegi.rowcount(); j>=0; j--) {

                if((ds_daegi.GetColumn(j, "POSID") == ds_list.getColumn(i, "HNO")) && ds_list.getColumn(i, "DAEGI") == 0) {
         //alert(i);
                    ds_daegi.DeleteRow(j); } 
                }
			if(ds_list.getColumn(i, "FLAG") == 'U' && ds_list.getColumn(i, "EXAMTYPE") == '8950' && 
			   length(ds_list.getColumn(i, "FNAME")) != 0 && length(ds_list.getColumn(i, "FNAME_PATH")) != 0)
			{
				//fileName = left(GetDate(),8)+"_"+right(GetDate(),6)+"_"+ds_list.getColumn(i, "HNO")+ds_list.getColumn(i, "EXAMTYPE")+ds_list.getColumn(i, "CHASU")+"."+gfn_getFileExt(ds_list.getColumn(i, "FNAME"));
				fileName = left(GetDate(),8)+"_"+right(GetDate(),6)+"_"+ds_list.getColumn(i, "FNAME");//+"."+gfn_getFileExt(ds_list.getColumn(i, "FNAME"));
				var arr = tit_fileWrite(httpFile
					, "QM"
					, ds_list.getColumn(i, "FNAME_PATH")
					, ds_list.getColumn(i, "FNAME")
					, fileName// 실제 db에 저장될 파일 이름
					, "U"	  // time stamp를 붙이지 않을 경우 U 사용 
					, "");    // ds_list.getColumn(i, "CS108_QAD") );//삭제할 이전 파일명 
				if ( arr[0] == "S" ) {
					ds_list.setColumn(i, "FNAME_APP", arr[2]);
					ds_list.setColumn(i, "FPATH", ds_list.getColumn(i, "FNAME_PATH"));
				}
				else if ( arr[0] != "S" )
				{
					gfn_showMsg("CW00035"); 
					return;
				}
			}
			 //검사단 시트 upload
			 if(ds_list.getColumn(i, "FLAG") == 'U' && length(ds_list.getColumn(i, "FNAME2")) != 0 && length(ds_list.getColumn(i, "FNAME_PATH2")) != 0)
			{
				//fileName = left(GetDate(),8)+"_"+right(GetDate(),6)+"_"+ds_list.getColumn(i, "HNO")+ds_list.getColumn(i, "EXAMTYPE")+ds_list.getColumn(i, "CHASU")+"."+gfn_getFileExt(ds_list.getColumn(i, "FNAME"));
				fileName2 = left(GetDate(),8)+"_"+right(GetDate(),6)+"_"+ds_list.getColumn(i, "FNAME2")+"N";//+"."+gfn_getFileExt(ds_list.getColumn(i, "FNAME"));
				var arr = tit_fileWrite(httpFile
					, "QM"
					, ds_list.getColumn(i, "FNAME_PATH2")
					, ds_list.getColumn(i, "FNAME2")
					, fileName2// 실제 db에 저장될 파일 이름
					, "U"	  // time stamp를 붙이지 않을 경우 U 사용 
					, "");    // ds_list.getColumn(i, "CS108_QAD") );//삭제할 이전 파일명 
				if ( arr[0] == "S" ) {
					ds_list.setColumn(i, "FNAME_APP2", arr[2]);
					ds_list.setColumn(i, "FPATH2", ds_list.getColumn(i, "FNAME_PATH2"));
				}
				else if ( arr[0] != "S" )
				{
					gfn_showMsg("CW00035"); 
					return;
				}
			}
		}
		
		ds_list.Filter("FLAG='U' && EXAMTYPE='8950' && length(FNAME) > 0");
		ds_list_i.CopyF(ds_list);
		ds_list.UnFilter();

		ds_list.Filter("FLAG='U' && length(FNAME2) > 0");
		ds_list_j.CopyF(ds_list);
		ds_list.UnFilter();
		
		//afterSave 문자발송용.
		ds_list.Filter("FLAG='U'");
		ds_list_sms.CopyF(ds_list);
		ds_list.UnFilter();
		
		// 저장 처리 
		tit_clearActionInfo();
		tit_addSaveActionInfo(
			""
			, "qm05:QM0501001A_I1"
			, ""
			, "FLAG");	
		
			
		tit_addSelectExActionInfo("qm05:QM0501001A_S8", "qm05:QM0501001A_I2", "qm05:QM0501001A_U1");	// zqmt019i	
		tit_addSelectExActionInfo("qm05:QM0501001A_S9", "qm05:QM0501001A_I3", "qm05:QM0501001A_U2");	//zqmt019g
	    //tit_addSelectExActionInfo("qm05:QM0501001A_U3");
		tit_callService(
			""
			, ""
			, "ds_list=ds_list:U ds_list_i=ds_list_i ds_list_j=ds_list_j"// ds_list_d=ds_list_d"
			, ""
			, ""
			, "fn_afterSave"
			,""
			,""
		,"true");
		
	}
	

}
/********************************************************************************
* 기      능   : 저장전에 자료 검증 
********************************************************************************/
function fn_checkSave(){
	var j = 0;
    ds_list_d2.ClearData();
    ds_list_d.ClearData();
	for(var i=0;i<ds_list.GetRowCount();i++){
	
		if(ds_list.GetColumn(i,"EXAMREQUEST")=="1"){
			j=j+1;
		//	alert(substr(ds_list.GetColumn(i,"PJT"),0,1));
			if(Length(Trim(ds_list.GetColumn(i,"EXAMTYPE")))!=4){
				//alert("검사유형을 선택하십시오.");
				gfn_showAlert("CW00001","검사유형");
				return false;
			}
			if(Length(Trim(ds_list.GetColumn(i,"CHASU")))!=2){
				//alert("차수를 입력하십시오.");
				gfn_showAlert("CW00001","차수");
				return false;
			}
			if(Length(Trim(ds_list.GetColumn(i,"EXAMREQDATE")))!=8){
				//alert("검사요청일을 입력하십시오.");
				gfn_showAlert("CW00001","검사요청일");
				return false;
			}
			if(length(trim(ds_list.GetColumn(i,"PARQDT"))) == 8 && ToNumber(gfn_getWorkingDate(2,"1000",ds_list.GetColumn(i,"PARQDT"))) > ToNumber(ds_list.GetColumn(i,"EXAMREQDATE"))){
				var arr = [st_examreqdate.value,gfn_getWorkingDate(2,"1000",ds_list.GetColumn(i,"PARQDT"))];
				gfn_showMsg("CW00007",arr);
				ds_list.row = i;
				return false;
			}
			//제외처리 (홍세희sw요청--201710116
			// N프로젝트 일시 감리단 검사/검사시트 파일 필수 입력(감리단 유인 경우 필수)
			if(substr(ds_list.GetColumn(i,"PJT"),0,1) == 'N'){ 
			  //   alert(ds_list.GetColumn(i,"N_CHK"));
			    // alert(length(ds_list.GetColumn(i,"FNAME2")));
			  //  if( ds_list.GetColumn(i,"N_CHK") == 'A'  && length(ds_list.GetColumn(i,"FNAME2")) <= 0){
			 //	gfn_showAlert("CW00001","감리단검사/검사시트");
			//	return false;
			  // }
			}
			// N프로젝트 일시 감리단 검사/검사시트 파일 필수 입력(감리단 유인 경우 필수)
			if(substr(ds_list.GetColumn(i,"PJT"),0,1) == 'N'){ 
			 //   if(length(ds_list.GetColumn(i,"N_CHK")) <= 0){
			//	gfn_showAlert("CW00001","감리단검사");
			//	return false;
			 //  }
			}
			//대기 일정 체크 
			if(ds_list.GetColumn(i,"DAEGI") == '1' && ds_list.GetColumn(i,"D_CHK") <> 'X'){
				gfn_showAlert("CW10025","대기 체크 시 일정을 입력해 주시기 바랍니다.");
				return false;
			}
			//대수확인	
           if( ds_list.GetColumn(i,"ZZACTSS") == ''|| ds_list.GetColumn(i,"ZZACTSS") == '01'|| ds_list.GetColumn(i,"ZZACTSS") == '02' || ds_list.GetColumn(i,"ZZACTSS") == '08' || ds_list.GetColumn(i,"ZZACTSS") == '10' 
                ||  ds_list.GetColumn(i,"ZZACTSS") == '14' || ds_list.GetColumn(i,"ZZACTSS") == '20'  ||  ds_list.GetColumn(i,"ZZACTSS") == '21'  ||  ds_list.GetColumn(i,"ZZACTSS") == '19')
             {  
                ds_exam.SetColumn(0,"ZZACTSS", '22')  ; //수도권으로 사무소 변경
             }
              else if (ds_list.GetColumn(i,"ZZACTSS") == '15' || ds_list.GetColumn(i,"ZZACTSS") == '16' )
             {  
                ds_exam.SetColumn(0,"ZZACTSS", '23')  ; //주차로 사무소  변경
             }
              else
             {
                ds_exam.SetColumn(0,"ZZACTSS", ds_list.GetColumn(i,"ZZACTSS"))  ; 
             }
              
               ds_exam.SetColumn(0,"EXAMREQDATE",ds_list.GetColumn(i,"EXAMREQDATE"));
              
                tit_clearActionInfo();
		        tit_addSearchActionInfo("qm05:QM0501001A_S11");
		        tit_callService(
			     ""
			   , ""
			   , "ds_exam=ds_exam"
			   , "ds_list_d=ds_list_d"
			   , ""
			   , ""//"ufn_afterdaesuCount"
			   , ""
               , ""
			   , true);	
			   
			
			   
			   if(ds_list_d2.GetRowCount()==0)	
               {//alert("a");
	             ds_list_d2.copyF(ds_list_d);
                 ds_list_d2.SetColumn(0,"DAESU_H2", ds_list_d.GetColumn(0,"DAESU_H") + ds_list.GetColumn(i, "DAESU"));
                // alert(ds_list_d.GetColumn(0,"DAESU_T"));
                //  alert(ds_list_d2.GetColumn(0,"DAESU_H2"));
                 if(ds_list_d.GetColumn(0,"DAESU_T") < ds_list_d2.GetColumn(0,"DAESU_H2")) //  총대수보다 현 신청대수가 클 경우 
                 {//alert("C");
                    var txt = (parseInt(j) + 1) + "행 검사요청일 신청대수가 초과하였습니다.다른 일자를";
  	                gfn_showAlert("CW00116", txt);
		            return false;
                 }
               }
                else
                {
                 for(var j=0;j<ds_list_d2.GetRowCount();j++)
                 {
                  if( (ds_list_d.GetColumn(0,"MDATE") == ds_list_d2.GetColumn(j,"MDATE")) && (ds_list_d.GetColumn(0,"ZZACTSS") == ds_list_d2.GetColumn(j,"ZZACTSS")) )
                   {//alert("w");
                     ds_list_d2.SetColumn(j,"DAESU_H2", ds_list_d2.GetColumn(j,"DAESU_H2") + ds_list.GetColumn(i, "DAESU"));
                     ds_list_d.ClearData();
                     if(ds_list_d2.GetColumn(j,"DAESU_H2") > ds_list_d2.GetColumn(j,"DAESU_T")) //  총대수보다 현 신청대수가 클 경우 
                     {//alert("f");
                        var txt = (parseInt(j) + 1) + "행 검사요청일 신청대수가 초과하였습니다. 다른 일자를 ";
  	                    gfn_showAlert("CW00116", txt);
	           //  return;
		                 return false;
                      }
                    }
                    else
                    {//alert("d");
              
                      ds_list_d.SetColumn(0,"DAESU_H2", ds_list_d.GetColumn(0,"DAESU_H") + ds_list.GetColumn(i, "DAESU"));

                      if(ds_list_d.GetColumn(0,"DAESU_T") < ds_list_d.GetColumn(0,"DAESU_H2")) //  총대수보다 현 신청대수가 클 경우 
                      {//alert("C");
     
                        var txt = (parseInt(j) + 1) + "행 검사요청일 신청대수가 초과하였습니다.다른 일자를";
  	                    gfn_showAlert("CW00116", txt);

		                 return false;
                       }
                        
                     }
      
                   }
                   
                   ds_list_d2.AppendDataset(ds_list_d);
               }
      //    trace(ds_list_d.SaveXML());
      //      trace(ds_list_d2.SaveXML());

		}
		else
		{
			ds_list.SetColumn(i,"FLAG","");
		}
	//	trace(ds_list_d.SaveXML());
	}

	if(j==0){
		//alert("검사신청을 하나이상 체크하십시오.");
		gfn_showAlert("CW00013");
		return false;
	}

	return true;
}
/********************************************************************************
* 기      능   : 닫기  
********************************************************************************/
function fn_close() {
	close();
}
/********************************************************************************
* 기      능   : 액셀  
********************************************************************************/
function fn_excel() {
	// Excel Export 
	gfn_saveToExcel(grd_list, true );
}
//=========================================================================================
// [ PART 4]
// Callback 함수 정의 : callback 함수명은 메인 함수의 fn_xxxx() 에서 xxxx 부분은 fn_afterXXXX()
// 형태가 되도록 작성 
//=========================================================================================
/********************************************************************************
* 기      능   : 조회 Callback  
********************************************************************************/
function fn_afterQuery(errCode, errMsg) {
	// 메시지 처리 
	//Trace(ds_list.saveXML());
	gfn_showSearchMsg(grd_list);
}
/********************************************************************************
* 기      능   : 저장 Callback  
********************************************************************************/
function fn_afterSave(errCode, errMsg) {
	if ( errCode != 0 ) {
		gfn_showMsg("CE00001");
	} else {
		gfn_showMsg("CI00003");
		
		tit_clearActionInfo();
        tit_addMultiActionInfo("qm05:QM0501001A_U3");
        tit_callService(
		  ""	
		, ""
		, "ds_list_d2=ds_list_d2"
		, ""
		, ""
		, ""//"fn_afterSave"
		, ""
		, ""
		, true  // ""
    );
    
   // alert(ds_daegi.rowcount);
    
    if(ds_daegi.rowcount > 0)  //대기현장
    {
      	
		tit_clearActionInfo();
        tit_addMultiActionInfo("qm05:QM0501001A_I4");
        tit_callService(
		  ""	
		, ""
		, "ds_daegi=ds_daegi"
		, ""
		, ""
		, ""//"fn_afterSave"
		, ""
		, ""
		, true  // ""
      );
    }
    
    tit_clearActionInfo();
	tit_addSearchActionInfo("ps15:PS1505001G_S1");// 문자발송 일시 SELECT
	tit_callService(
          ""
        , ""
        , "ds_cond=ds_cond"
        , "ds_datetime=ds_datetime"
        , ""
        , ""
        , ""
        , ""
        , true);
        
    // 문자 발송
    for(var i=0; i < ds_list_sms.GetRowCount(); i++)
	{
		// PM발송
		nAddRow = ds_sendMms.AddRow();
		
		var sExamType = "";
		if(ds_list_sms.GetColumn(i, "EXAMTYPE") == '8960')
		{
			sExamType = "완성검사";
		}
		else
		{
			sExamType = "중간검사";
		}
		
		var msg = "프로젝트명:"+ds_list_sms.GetColumn(i, "POST1");
			msg+= "\n"+ "호기번호:"+ds_list_sms.GetColumn(i, "HNO")+" 차수:"+ds_list_sms.GetColumn(i, "CHASU");
			msg+= "\n"+ "검사유형:"+sExamType+"\n검사요청일:"+Substr(ds_list_sms.GetColumn(i, "EXAMREQDATE"),0,4)
			+"-"+Substr(ds_list_sms.GetColumn(i, "EXAMREQDATE"),4,2)+"-"+Substr(ds_list_sms.GetColumn(i, "EXAMREQDATE"),6,2);
			msg+= "\n검사요청이 등록되었습니다.\n검사일정 확정 시 추가 문자 발송됩니다.(검사일 3일전)\n[현대엘리베이터 설치품질검사팀]";
			
		
		
		// 2.PM
		ds_sendMms.setColumn(nAddRow,"TRAN_ID",G_USER_ID);
		//ds_sendMms.setColumn(nAddRow,"TRAN_PHONE", Replace('010-7160-1959',"-",""));
		ds_sendMms.setColumn(nAddRow,"TRAN_PHONE", Replace(ds_list_sms.GetColumn(i,"PM_CELLP"),"-",""));
		ds_sendMms.setColumn(nAddRow,"TRAN_CALLBACK", "1577-0603");
		ds_sendMms.setColumn(nAddRow,"TRAN_ETC1","WEB_APPROVAL");
		ds_sendMms.setColumn(nAddRow,"TRAN_ETC2", "");	
		ds_sendMms.setColumn(nAddRow,"SUBJECT", "");		
		ds_sendMms.SetColumn(nAddRow, "TRAN_MSG", msg);		
		ds_sendMms.SetColumn(nAddRow,"TRAN_TIME",  ds_datetime.GetColumn(0, "DATETIME"));
	}
	
	//Trace(ds_sendMms.saveXML());
	
	
	tit_clearActionInfo();
		
	//저장 처리 
	tit_addMultiActionInfo("ps15:PS1505001G_I1");
		
	tit_callService(
		"PDA_ACT"
		, ""
		, "ds_sms=ds_sendMms:A"
		, ""
		, ""
		, ""
		, ""
		, true
		, true);
    
    
		// 저장 성공시 재조회
		fn_query();
	}
}
//=========================================================================================
// [ PART 5 ]
// Detail Process Event 정의 ( User Define function )
// 사용자 정의 함수는 ufn_xxxx() 형태로 작성 
//=========================================================================================
/********************************************************************************
* 기      능   : 사용자 정의 함수  
********************************************************************************/
function ufn_resetList(){
	ds_list.FireEvent=false;
	ds_list.SetColumn(ds_list.currow,"EXAMTYPE","");	
	ds_list.SetColumn(ds_list.currow,"EXAMREQUEST","");	
	ds_list.SetColumn(ds_list.currow,"CHASU","");	
	ds_list.SetColumn(ds_list.currow,"EXAMREQDATE","");	
	ds_list.SetColumn(ds_list.currow,"RELEASE","");	
	ds_list.SetColumn(ds_list.currow,"RELEASE2","");	
	ds_list.SetColumn(ds_list.currow,"GUIDCHK","");	
	ds_list.SetColumn(ds_list.currow,"N_CHK","");	
	ds_list.SetColumn(ds_list.currow,"DAESU",0.0);
	ds_list.FireEvent=true;
}

function ufn_chgExamType(obj,nRow,strColumnID,varOldValue,varNewValue) {
	if(length(trim(ds_list.GetColumn(nRow,"STEAM"))) == 0)
	{
		gfn_showMsg("CW00176");
		ds_list.FireEvent=false;
		ds_list.SetColumn(nRow,"CHASU","");
		ds_list.SetColumn(nRow,"EXAMTYPE","");
		ds_list.SetColumn(nRow,"EXAMREQUEST","");
		ds_list.SetColumn(nRow,"EXAMREQDATE","");
		ds_list.SetColumn(nRow,"DAESU",0.0);
		ds_list.FireEvent=true;
		return;
	}
	
	//면제팀 확인
	if(strColumnID=="RELEASE2"){

	  if(varNewValue=="A"){
	  // 중간검사 속도 180  이상 면제제외
	    if(ds_list.getcolumn(nRow,"EXAMTYPE")=="8950" && ds_list.getcolumn(nRow,"SPEED") >= 180)
	    {
	        ufn_resetList();
			gfn_showAlert("면제대상이 아닙니다.");
			return false;
	    } // 완성검사 속도 150 이상 면제제외
	    else if(ds_list.getcolumn(nRow,"EXAMTYPE")=="8960" && ds_list.getcolumn(nRow,"SPEED") >= 150)
	    {
	        ufn_resetList();
			gfn_showAlert("면제대상이 아닙니다.");
			return false;
	    }//면제팀이 아닐 시
	    else if(ds_list.getcolumn(nRow,"PASS") <> 'X')
	    {
	        ufn_resetList();
			gfn_showAlert("면제대상이 아닙니다.");
			return false;
	    }
	    // 면제 기간이 아닐 시 
	    else if(ds_list.getcolumn(nRow,"PASS") == 'X' && (ds_list.getcolumn(nRow,"F_DATE") < ds_list.getcolumn(nRow,"EXAMREQDATE") || ds_list.getcolumn(nRow,"S_DATE") > ds_list.getcolumn(nRow,"EXAMREQDATE")))
	    {   
	          ufn_resetList();
			  gfn_showAlert("면제대상이 아닙니다.");
			  return false;
	    }
	    
	    //교체공사 일 시 무족건 검사
	   else if(substr(ds_list.GetColumn(nRow,"PJT"),0,1) == 'N')
	    {
	     // ufn_resetList();
	      //gfn_showAlert("면제대상이 아닙니다.");
		  //return false;
	    }
  	  else
	  {
	      ds_list.SetColumn(nRow,"DAESU", 0.0);
	  }
	  
		// 면제 대상일 경우
		ds_list.SetColumn(nRow,"RELEASE","O");
	 }

	   else{
	       ufn_resetList();
	    }
   }
	
	if(strColumnID=="EXAMTYPE"){
		ds_list.SetColumn(nRow,"PARQDT","");

		//BGUBUN=10(EL),11(ES),12(MW),14(ES(선박)),20(주차기)
		//EL:중간검사 필수 입력후 완성검사 진행, 나머지는 중간검사 선택 입력후 완성검사 진행-20090828(정현지C)
		//박명식 과장 요청으로 ES류는 중간검사 대상에서 제외(2013.09.13)
		if(varNewValue=="8950" && ds_list.getcolumn(nRow,"BGUBUN")!="10" && 
		                          //ds_list.getcolumn(nRow,"BGUBUN")!="11" &&
		                          //ds_list.getcolumn(nRow,"BGUBUN")!="12" &&
		                          //ds_list.getcolumn(nRow,"BGUBUN")!="14" &&
		                          ds_list.getcolumn(nRow,"BGUBUN")!="20"){
			ufn_resetList();
			gfn_showAlert("해당호기는 중간검사대상이 아닙니다.");
			return false;			
		}
		else if(varNewValue=="8950" && (ds_list.getcolumn(nRow,"BGUBUN")=="10" || 
		                                //ds_list.getcolumn(nRow,"BGUBUN")=="11" || 
		                                //ds_list.getcolumn(nRow,"BGUBUN")=="12" || ds_list.getcolumn(nRow,"BGUBUN")=="14" ||
		                                ds_list.getcolumn(nRow,"BGUBUN")=="20")){
			ufn_set019Cond();
			ufn_completeCount();
		}
		//ES인 경우 7월1일 이전에 중간검사없이 완성검사신청이 가능했음, 7월1일 이후는 중간검사입력이 필수임
		//7월1일 이전에 입력한 ES호기는 불합격일 경우 완성검사를 재신청해야 되는데 중간검사입력이 안되어있어서 
		//완성검사 신청이 안됨 . 이런호기는 예외처리해서 완성검사 재신청하도록 처리함.
		//else if(varNewValue=="8960" && (ds_list.getcolumn(nRow,"HNO")=="104330S01" || ds_list.getcolumn(nRow,"HNO")=="104330S02")){
			//ufn_set019Cond();
			//ufn_maxDscode();
		//}
		//주차는 중간검사 선택 입력후 완성검사 진행 나머지는 중간검사 필수 입력후 중간검사결과 입력 후 완성검사 진행-20100702(정현지C)
		// ES류는 중간검사 없이 완성검사 진행(박명식 과장 요청 2013.09.13)
		else if(varNewValue=="8960" && ds_list.getcolumn(nRow,"BGUBUN")!="20" 
		        && ds_list.getcolumn(nRow,"BGUBUN")!="11" && ds_list.getcolumn(nRow,"BGUBUN")!="12" 
		        && ds_list.getcolumn(nRow,"BGUBUN")!="14"
		       )
		{   
		
		//else if(varNewValue=="8960" && ds_list.getcolumn(nRow,"BGUBUN")!="20" && ds_list.getcolumn(nRow,"SPEED")>120){
			//중간검사 여부 체크
			lv_speed   = ds_list.getcolumn(nRow,"SPEED"); //EL은 속도가 105 이상일경우만 중간검사 시행
		    lv_nopass  = ds_list.getcolumn(nRow,"NOPASS"); //불합격 상위설치팀의 경우  중간검사 필수
		    lv_pass120 = ds_list.GetColumn(nRow, "PASS120");
		    lv_preInspIndc = ds_list.GetColumn(nRow, "PRE_INSP_INDC"); // 완성검사를 한번이라도 받은 적이 있다면 Y 아니면 N
		    lv_dcrg    = ds_list.GetColumn(nRow, "EL_DCRG");
		    lv_dcwrg   = ds_list.GetColumn(nRow, "EL_DCWRG");
		    
		 
		    ufn_set019Cond();
			ds_019Cond.SetColumn(0,"EXAMTYPE","8950");
			ufn_middleExist();			
		}	
		// ES류는 중간검사 없이 완성검사 진행(박명식 과장 요청 2013.09.13)
		else if(varNewValue=="8960" && ( ds_list.getcolumn(nRow,"BGUBUN")=="20" ||        
		        ds_list.getcolumn(nRow,"BGUBUN")=="11" || ds_list.getcolumn(nRow,"BGUBUN")=="12" || ds_list.getcolumn(nRow,"BGUBUN")=="14" )
		       )
		{
			ufn_set019Cond();
			ufn_maxDscode();
		}
	}//검사요청일 
	if(strColumnID=="EXAMREQDATE"){
		
		if(ToNumber(varNewValue) < ToNumber(gfn_getCurrDate()) || ToNumber(varNewValue) < ToNumber(ds_list.GetColumn(ds_list.currow,"STARTDATE"))){
			//alert("검사요청일을 확인하십시오.");
			gfn_showAlert("CW00022","검사요청일");
			ds_list.FireEvent=false;
			ds_list.SetColumn(nRow,strColumnID,varOldValue);
			ds_list.FireEvent=true;
			return;
		}
		if(length(trim(ds_list.GetColumn(nRow,"PARQDT"))) == 8 && ToNumber(gfn_getWorkingDate(2,"1000",ds_list.GetColumn(nRow,"PARQDT"))) > ToNumber(varNewValue)){
			ds_list.FireEvent=false;
			var arr = [st_examreqdate.value,gfn_getWorkingDate(2,"1000",ds_list.GetColumn(nRow,"PARQDT"))];
			gfn_showMsg("CW00007",arr);
			ds_list.SetColumn(nRow,"EXAMREQDATE",ds_list.GetOrgColumn(nRow,"EXAMREQDATE"));
			ds_list.FireEvent=true;
			return;
		}
		if(ds_list.getcolumn(ds_list.currow,"RELEASE2") == 'A' && ds_list.getcolumn(ds_list.currow,"PASS") == 'X' && (ToNumber(varNewValue) <  ToNumber(ds_list.GetColumn(ds_list.currow,"S_DATE"))  || ToNumber(varNewValue) > ToNumber(ds_list.GetColumn(ds_list.currow,"F_DATE")))){
			//alert("검사요청일을 확인하십시오.");
			gfn_showAlert("면제대상이 아닙니다.");
			ds_list.FireEvent=false;
			ds_list.SetColumn(nRow,strColumnID,varOldValue);
			ds_list.FireEvent=true;
			return;
		}
		
		   ufn_setexamCond();
		   ufn_chkdate();
	}		
	//지도 
	if(strColumnID=="GUIDCHK"){
	  if(varNewValue == '1')
	  {
	    ds_list.SetColumn(nRow,"DAESU", 2.0);
	  }
	  else
	  {
  	    ufn_resetList();
	  }
	}
	// 관리자권한 
	if(strColumnID == "G_CHK"){
	  if(varNewValue == '1')
	  {
	    ds_list.SetColumn(ds_list.currow,"DAESU",0.0);	
	  }
	 else
	  {
	    ufn_resetList();
	  }
	 }
	 //대기 
	if(strColumnID=="DAEGI"){
	  if(varNewValue == '1')
	  {
	  
	  }
	  else
	  {   
  	    ds_list.SetColumn(ds_list.currow,"D_CHK",'');	
	  }
	}
	// 검사요청 체크박스 : 서버에 전송할 flag 처리
	ds_list.FireEvent=false;
	if(ds_list.GetColumn(nRow,"EXAMREQUEST")=="1"){
		ds_list.SetColumn(nRow,"FLAG","U");
	}
	else{
		ds_list.SetColumn(nRow,"FLAG","");
	}
	
	//ufn_afterDaesu();
	ds_list.FireEvent=true;	
}


function ufn_set019Cond(){
	if(ds_019Cond.GetRowCount()==0)	ds_019Cond.AddRow();
	ds_019Cond.SetColumn(0,"PJT",ds_list.GetColumn(ds_list.currow,"PJT"));
	ds_019Cond.SetColumn(0,"HNO",ds_list.GetColumn(ds_list.currow,"HNO"));
	ds_019Cond.SetColumn(0,"EXAMTYPE",ds_list.GetColumn(ds_list.currow,"EXAMTYPE"));		
}

function ufn_completeCount(){
	if(ds_019Cond.getColumn(0,"EXAMTYPE")=="8950"){
		tit_clearActionInfo();
		tit_addSearchActionInfo("qm05:QM0501001A_S5");
		tit_callService(
			""
			, ""
			, "ds_019Cond=ds_019Cond"
			, "ds_inCount=ds_inCount"
			, ""
			, "ufn_afterCompCount"
			, true);	
	}	
}

function ufn_cpCount(){
	
		tit_clearActionInfo();
		tit_addSearchActionInfo("qm05:QM0501001A_S5");
		tit_callService(
		   ""
		  , ""
		  , "ds_019Cond=ds_019Cond"
		  , "ds_inCount=ds_inCount"
		  , ""
		  , ""//"ufn_afterdaesuCount"
		  , ""
          , ""
		  , true);		
		
}

function ufn_setexamCond(){
	if(ds_exam.GetRowCount()==0)	ds_exam.AddRow();
      ds_exam.SetColumn(0,"EXAMREQDATE",ds_list.GetColumn(ds_list.currow,"EXAMREQDATE"));
      if( ds_list.GetColumn(ds_list.currow,"ZZACTSS") == ''|| ds_list.GetColumn(ds_list.currow,"ZZACTSS") == '01'|| ds_list.GetColumn(ds_list.currow,"ZZACTSS") == '02' || ds_list.GetColumn(ds_list.currow,"ZZACTSS") == '08' || ds_list.GetColumn(ds_list.currow,"ZZACTSS") == '10' 
          ||  ds_list.GetColumn(ds_list.currow,"ZZACTSS") == '14' || ds_list.GetColumn(ds_list.currow,"ZZACTSS") == '20'  ||  ds_list.GetColumn(ds_list.currow,"ZZACTSS") == '21' ||  ds_list.GetColumn(ds_list.currow,"ZZACTSS") == '19')
      {  
          ds_exam.SetColumn(0,"ZZACTSS", '22')  ; //수도권으로 사무소 변경
      }
      else if (ds_list.GetColumn(ds_list.currow,"ZZACTSS") == '15' || ds_list.GetColumn(ds_list.currow,"ZZACTSS") == '16' )
      {  
          ds_exam.SetColumn(0,"ZZACTSS", '23')  ; //주차로 사무소  변경
      }
      else
      {
          ds_exam.SetColumn(0,"ZZACTSS",ds_list.GetColumn(ds_list.currow,"ZZACTSS"));
      }
     
    

}

function ufn_chkdate(){
	
		tit_clearActionInfo();
		tit_addSearchActionInfo("qm05:QM0501001A_S12");
		tit_callService(
			""
			, ""
			, "ds_exam=ds_exam"
			, "ds_eCount=ds_eCount"
			, ""
			, "ufn_afterexamCount"
			, true);	

}

function ufn_afterexamCount(){ //alert(ds_eCount.GetColumn(0,"ZDATE"));
	if(length(ds_eCount.GetColumn(0,"ZDATE")) > 0){
	   ufn_chktime();
	}
	else{		
		   ufn_resetList();
		   gfn_showAlert("검사 스케줄이 입력되지 않았습니다. 담당자에게 문의하세요.");
		   return false;
	}
}

function ufn_chktime(){
      if(ToNumber(ds_eCount.GetColumn(0,"ZDATE")) < ToNumber(getDate())){
           ufn_resetList();
		   gfn_showAlert("검사 신청이 마감되었습니다.");
		   return false;
		}	
}

function ufn_afterCompCount(){
	if(ds_inCount.GetColumn(0,"COUNT") > 0){
		ufn_resetList();
		gfn_showAlert("이미 완성검사를 신청하였습니다.");
		return false;
	}
	else{		
		if(ds_inCount.GetColumn(0,"COUNT") == 0){
			ufn_maxDscode();
		}
	}
}




function ufn_maxDscode(){
	tit_clearActionInfo();
	tit_addSearchActionInfo("qm05:QM0501001A_S4");
	tit_addSearchActionInfo("qm05:QM0501001A_S7");
		
	tit_callService(
		""
		, ""
		, "ds_019Cond=ds_019Cond"
		, "ds_019Result=ds_019Result ds_019Result2=ds_019Result2"
		, ""
		, "ufn_afterCheck"
		, true);				
}

function ufn_afterCheck(errCode, errMsg) {		
//alert(ds_list.GetColumn(ds_list.currow,"G_CHK") )
	var strChasu = ToString(ToNumber(ds_019Result.GetColumn(0,"MAXSEQ"))+1);
	if(Length(strChasu)==1) strChasu = "0"+strChasu;
	var strDscode = ds_019Result.GetColumn(0,"DSCODE");

	if(ds_list.GetColumn(ds_list.currow,"EXAMTYPE")=="8950"){
		if(strDscode == "A" || strDscode == "B" || strDscode == "C" || strDscode == "D" || strDscode == "H" || strDscode == "E" || strDscode == ""){
			ufn_resetList();
			gfn_showAlert("이미 중간검사가 완료되었습니다.");
			return false;
		}
		else{
			ds_list.FireEvent=false;
			if(ds_019Result.GetRowCount()==0){
				ds_list.SetColumn(ds_list.currow,"CHASU","01");	
				ds_list.SetColumn(ds_list.currow,"DAESU",2.0);	//중간 검사의 경우 2대
			}
			else{
	 			ds_list.SetColumn(ds_list.currow,"CHASU",strChasu);	
				ds_list.SetColumn(ds_list.currow,"DAESU",0.5);	//중간 검사의 경우 2차검사 0.5
			}
			if(ds_list.GetColumn(ds_list.currow,"GUIDCHK") =='1')//지도가 체크인 경우
			{
			     ds_list.SetColumn(ds_list.currow,"DAESU",2.0);	//지도의 경우 1대
			}
			//주차 / es의 경우 1대
			if(ds_list.GetColumn(ds_list.currow,"ZZACTSS") == '13' || ds_list.GetColumn(ds_list.currow,"ZZACTSS") == '15')//
			{
			     ds_list.SetColumn(ds_list.currow,"DAESU",1.0);	
			}
			//면제인  경우 0대 
			if(ds_list.GetColumn(ds_list.currow,"RELEASE2") == 'A')
			{
			     ds_list.SetColumn(ds_list.currow,"DAESU",0.0);	
			}
			//관리자의 경우  0대 
			if(ds_list.GetColumn(ds_list.currow,"G_CHK") == '1')
			{
			     ds_list.SetColumn(ds_list.currow,"DAESU",0.0);	
			}
			if(strChasu >= 3)
			{
			  gfn_showAlert("3차검사 이상의 경우 설치PM 확인 후 검사 진행 바랍니다.");
			}
			ds_list.SetColumn(ds_list.currow,"EXAMREQUEST","1");
			ds_list.FireEvent=true;
			ds_inCond.SetColumn(0,"LIFNR",ds_list.GetColumn(ds_list.currow,"LIFNR"));
			ds_inCond.SetColumn(0,"TEMNO",ds_list.GetColumn(ds_list.currow,"STEAM"));

			tit_clearActionInfo();
			tit_addSearchActionInfo("qm05:QM0501001A_S3");
			tit_callService(
				""
				, ""
				, "ds_inCond=ds_inCond"
				, "ds_inCount=ds_inCount"
				, ""
				, "ufn_afterExamType"
				, true);	
		}
	}
	else if(ds_list.GetColumn(ds_list.currow,"EXAMTYPE")=="8960"){
		if(strDscode == "A" || strDscode == "B" || strDscode == "C" || strDscode == "D" || strDscode == "H" || strDscode == "E" || strDscode == ""){
			ufn_resetList();
			gfn_showAlert("이미 완성검사가 완료되었습니다.");
			return false;
		}else{
			//유형이 중간검사(8950)이고 DSCODE(결과값)가 없는경우만 PARQDT세팅한ZZDAT01다. - 단납기인경우
			if(ds_019Result2.GetColumn(0,"DSCODE") == "")
				ds_list.SetColumn(ds_list.row, "PARQDT",ds_019Result2.GetColumn(0,"PARQDT"));
			ds_list.FireEvent=false;
			if(ds_019Result.GetRowCount()==0){
				ds_list.SetColumn(ds_list.currow,"CHASU","01");
				//alert(parseInt(ds_list.GetColumn(ds_list.currow,"ZSPEC7")));
				if(parseInt(ds_list.GetColumn(ds_list.currow,"ZSPEC7"))>= 40 )
				{
				  ds_list.SetColumn(ds_list.currow,"DAESU", 2.0); //고층인 경우 2대		
				}else if(ds_list.GetColumn(ds_list.currow,"ZSPEC4") == "FT" || (parseInt(ds_list.GetColumn(ds_list.currow,"ZSPEC7")) < 40 && parseInt(ds_list.GetColumn(ds_list.currow,"ZSPEC7")) >= 30))
				{// alert("a");
				  ds_list.SetColumn(ds_list.currow,"DAESU", 1.5); //화물용인경우 1.5	
				 // alert(ds_list.GetColumn(ds_list.currow,"DAESU"));
				}else if(ds_list.GetColumn(ds_list.currow,"G_CHK") == '1')//관리자의 경우  0대 
		     	{
			      ds_list.SetColumn(ds_list.currow,"DAESU",0.0);	
			    }else
				{//alert("b");
				  ds_list.SetColumn(ds_list.currow,"DAESU", 1.0); //1차 검사의 경우 1대 		
				}
		     			
			}
			else{
				ds_list.SetColumn(ds_list.currow,"CHASU",strChasu);	
				ds_list.SetColumn(ds_list.currow,"DAESU", 0.5);  //2차검사 이상의 경우 0.5대	
			}	
			
			if(ds_list.GetColumn(ds_list.currow,"GUIDCHK") =='1')//지도가 체크인 경우
			{
			    ds_list.SetColumn(ds_list.currow,"DAESU",2.0);	//지도의 경우 1대
			}
			//주차 / es의 경우 1대
			if(ds_list.GetColumn(ds_list.currow,"ZZACTSS") == '13' || ds_list.GetColumn(ds_list.currow,"ZZACTSS") == '15')//
			{
			     ds_list.SetColumn(ds_list.currow,"DAESU",1.0);	
			}
			//면제인  경우 0대 
			if(ds_list.GetColumn(ds_list.currow,"RELEASE2") == 'A')
			{
			     ds_list.SetColumn(ds_list.currow,"DAESU",0.0);	
			}
					//관리자의 경우  0대 
			if(ds_list.GetColumn(ds_list.currow,"G_CHK") == '1')
			{
			     ds_list.SetColumn(ds_list.currow,"DAESU",0.0);	
			}
			if(strChasu >=3)
			{
			  gfn_showAlert("3차검사 이상의 경우 설치PM 확인 후 검사 진행 바랍니다.");
			}
			// =============완성검사도 면제 대상 셋팅되게 수정==============//
			//ds_list.SetColumn(ds_list.currow,"EXAMREQUEST","1");  //기존소스
			//ds_list.SetColumn(ds_list.currow,"RELEASE","");	    //기존소스
			//ds_list.FireEvent=true;                               //기존소스
			ds_list.SetColumn(ds_list.currow,"EXAMREQUEST","1");			
			ds_list.FireEvent=true;
			tit_clearActionInfo();
			tit_addSearchActionInfo("qm05:QM0501001A_S3");
			tit_callService(
				""
				, ""
				, "ds_inCond=ds_inCond"
				, "ds_inCount=ds_inCount"
				, ""
				, "ufn_afterExamType"
				, true);		
			//================================================================//
		}
	}		
	else{
		ds_list.FireEvent=false;
		ds_list.SetColumn(ds_list.currow,"CHASU","");		
		ds_list.SetColumn(ds_list.currow,"EXAMREQUEST","0");
		ds_list.SetColumn(ds_list.currow,"RELEASE","");	
		ds_list.SetColumn(ds_list.currow,"DAESU", 0.0);
		ds_list.FireEvent=true;
	}
	
	
 //  ufn_afterDaesu();
}

function ufn_afterExamType(errCode, errMsg) {
	ds_list.FireEvent=false;

	//Trace("COUNT : "+ds_inCount.GetColumn(0,"COUNT"));
	//Trace("RELEASE2 : "+ds_list.GetColumn(ds_list.currow,"RELEASE2"));
	if (ds_list.GetColumn(ds_list.currow,"RELEASE2") =='A'){
		ds_list.SetColumn(ds_list.currow,"RELEASE","O");
	}
	else if (ds_inCount.GetColumn(0,"COUNT") == 0 || ds_list.GetColumn(ds_list.currow,"RELEASE2") ==''){
		ds_list.SetColumn(ds_list.currow,"RELEASE","");
	}
	
	ds_list.FireEvent=true;
}


function ufn_middleExist(){

	tit_clearActionInfo();
	tit_addSearchActionInfo("qm05:QM0501001A_S4");
	tit_callService(
		""
		, ""
		, "ds_019Cond=ds_019Cond"
		, "ds_019Result=ds_019Result"
		, ""
		, "ufn_afterMiddleExist"
		, true);				
}

function ufn_afterMiddleExist(){
	var strDscode = ds_019Result.GetColumn(0,"DSCODE");
	//alert(strDscode);
	//alert(lv_speed);
	//alert(lv_nopass);
   ufn_set019Cond();
   ufn_cpCount();
	//주차이외의 호기는 중간검사결과가 합격일 경우만 완성검사 대상이 된다. - 20100702(정현지C)
	if(!(strDscode=="A" || strDscode=="B" || strDscode=="C" || strDscode=="D" || strDscode=="H" || strDscode == "E" ) )	
	{
		if(lv_preInspIndc == 'Y')	// 한번이라도 완성검사를 받았다면 PASS
		{
			ds_019Cond.SetColumn(0,"EXAMTYPE","8960");
			ufn_maxDscode();
		}
		else if( lv_speed >= 150)
		{
			ufn_resetList();
			gfn_showAlert("중간검사 대상 기종입니다.");
			lv_speed = 0;
			return false;
		}
		else if( lv_speed >= 105 && lv_speed <= 120 && lv_pass120 == 'X' && lv_dcrg <> 'Y')//|| lv_nopass == 'X')  //EL은 속도가 120이상이고, 120m/m 중간검사 대상팀 일 경우에만 + 불합격 상위설치팀일 경우 중간검사 필수
		//else if( lv_speed >= 120 && lv_pass120 == 'X')//|| lv_nopass == 'X')  //EL은 속도가 120이상이고, 120m/m 중간검사 대상팀 일 경우에만 + 불합격 상위설치팀일 경우 중간검사 필수
		{
			   ufn_resetList();
			   gfn_showAlert("105m/m, 120m/m 기종 중간검사 대상설치팀입니다.");
			   lv_speed = 0;
			   return false;
		}
		
		else if( lv_nopass == 'X')
		{   
	
			  if (ds_inCount.GetColumn(0,"COUNT") <= 0) {
		          ufn_resetList();
			      gfn_alert("해당 소장님은 불합격상위설치팀으로 "
                     + "\n"
                     + "\n완성검사 전 중간검사 신청 및 진행 바랍니다.");          
			   lv_nopass = 0;
			   return false;
	            }
	            else{
	            	ds_019Cond.SetColumn(0,"EXAMTYPE","8960");
			        ufn_maxDscode();
	            }
		}
		else
		{
			ds_019Cond.SetColumn(0,"EXAMTYPE","8960");
			ufn_maxDscode();
		}
		/*
		ufn_resetList();
		gfn_showAlert("완성검사 대상이 아닙니다.");
		return false;
		*/
		
	}
	else{
		ds_019Cond.SetColumn(0,"EXAMTYPE","8960");
		ufn_maxDscode();
	}
}
//=========================================================================================
// [ PART 6 ]
// component Event 정의 : 각 Component 별 이벤트 
//=========================================================================================
/********************************************************************************
* 기      능   : 그리드 헤더 클릭시 정렬 처리 
********************************************************************************/
function grd_list_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
{
	if ( nCell == 0 ) {
		// 그리드 표시할 컬럼 선택 
		gfn_selectGridCol(obj);
	} else {
		// 그리드 정렬 처리 
		gfn_sortGrid(obj,nCell);
	}
}
/********************************************************************************
* 기      능   : 데이터셋 값 변경 시 - Flag 처리 
********************************************************************************/
function ds_list_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{
	ds_list.FireEvent=false;

	if(strColumnID == "EXAMREQUEST"){
		if(ds_list.GetColumn(nRow,"EXAMREQUEST")=="1"){
			ds_list.SetColumn(nRow,"FLAG","U");
		}
		else{
			ds_list.SetColumn(nRow,"FLAG","");
		}
	}
	ds_list.FireEvent=true;
}
// 달력 처리 부분 
/********************************************************************************
* 기      능   : 그리드에서 날짜 입력시 
********************************************************************************/
function grd_list_OnExpandEdit(obj,nRow,nCell,strVal,nPivotIndex)
{

	if ( nCell == 23 ) {
		var arr = gfn_openFileMgr(
		    "QM"
			, ds_list.getColumn(nRow, "FNAME")//FileDialog.FileName
			, ds_list.getColumn(nRow, "FNAME_PATH")//FileDialog.FilePath
			, imgUploadFlg
			, ""
			, ""
			, ""
			, "true"
		);
		
		if ( arr != null ) {
		   ds_list.setColumn(nRow, "FNAME_PATH",arr[0]) ; // 디렉토리 정보 
		   ds_list.setColumn(nRow, "FNAME",arr[1]); // 파일명 
		}
		//alert( ds_list.GetColumn(nRow, "FNAME_PATH"));
		
		//alert( ds_list.GetColumn(nRow, "FNAME"));
	    //alert(arr);
	} else if ( nCell == 25 ) {
		var arr = gfn_openFileMgr(
		    "QM"
			, ds_list.getColumn(nRow, "FNAME2")//FileDialog.FileName
			, ds_list.getColumn(nRow, "FNAME_PATH2")//FileDialog.FilePath
			, imgUploadFlg
			, ""
			, ""
			, ""
			, "true"
		);
		
		if ( arr != null ) {
		   ds_list.setColumn(nRow, "FNAME_PATH2",arr[0]) ; // 디렉토리 정보 
		   ds_list.setColumn(nRow, "FNAME2",arr[1]); // 파일명 
		}
	}
	 else {
		var rect = obj.GetCellRect(nRow, ncell);
		cal_temp.top = rect[1] + 100;
		if (cal_temp.top > 400)
		{
			cal_temp.top = 400;
		}
		cal_temp.Left = rect[0] + 20;
		if (cal_temp.Left > 790)
		{
			cal_temp.Left = 790;
		}	 
		cal_temp.Visible = true;
	
		if(nCell == 10)
		{
			cal_temp.value = ds_list.getColumn(nRow, "EXAMREQDATE");
		}
		
		cal_temp.SetFocus();
	}	
}
/********************************************************************************
* 기      능   : 달력에서 일자 선택했을 경우 
********************************************************************************/
function cal_temp_OnDayClick(obj,strText)
{
	if(grd_list.GetClickedCell() == 10)
	{
		ds_list.SetColumn(ds_list.row, "EXAMREQDATE", strText);
	}
	
	obj.Visible = false;
}
/********************************************************************************
* 기      능   : 달력에서 포커스 잃었을 경우 
********************************************************************************/
function cal_temp_OnKillFocus(obj)
{
	obj.Visible = false;
}
/********************************************************************************
* 기      능   : 원프로젝트 팝업
********************************************************************************/
function btn_pjt_OnClick(obj)
{
	var strId = obj.id;
	var strPjt;
	if(strId=="btn_fPjt") strPjt = ed_fPjt.Text;
	else if(strId=="btn_tPjt") strPjt = ed_tPjt.Text;
	var arg = "pjt="+quote(strPjt)+" strId="+quote(strId);
	gfn_openPopup("CS9601002A",true,arg);
}
/********************************************************************************
* 기      능   : 사무소 변경시 협력업체 FILTERING
********************************************************************************/
function cb_zzactss_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	if(strCode == '') ds_zzlifnr.Filter("1==1");
	else ds_zzlifnr.Filter("ZZACTSS=="+quote(strCode)+" || CODE==''");
	cb_zzlifnr.Index = 0;
	//설치팀 dataset초기화
	ds_team.Filter("1==1");
	cb_team.Index = 0;
}
/********************************************************************************
* 기      능   : 협력업체 변경시 팀장 FILTERING
********************************************************************************/
function cb_zzlifnr_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	if(strCode == '') ds_team.Filter("1==1");
	else ds_team.Filter("ZZLIFNR=="+quote(strCode)+" || CODE==''");
	cb_team.Index = 0;
}
/********************************************************************************
* 기      능   : expandImage image여부
********************************************************************************/
function ufn_expandImg()
{
if(userGroup == '10' || userGroup == '40') return "btn_icon_next_01";
	else return "";
}
/********************************************************************************
* 기      능   : expandImage image여부
********************************************************************************/
function ufn_expandShow()
{
	if(userGroup == '10'|| userGroup == '40') return "true";
	else return "false";
}
/********************************************************************************
* 기      능   : 면제팀관리 POP-UP
********************************************************************************/
function fn_btn_pre_plan_OnClick(obj)
{
	if (F_ADMIN_YN != "Y")	{
       gfn_showAlert('면제팀 관리 부서가 아닙니다.');
		return;
	}

	var arr = gfn_openWin('QM0501001C');

}
/********************************************************************************
* 기      능   : 검사대수 마감일 관리 POP-UP
********************************************************************************/
function btn_end_OnClick(obj)
{
	if (F_ADMIN_YN != "Y")	{
		gfn_showAlert('마감 관리 부서가 아닙니다.');
		return;
	}

	var arr = gfn_openWin('QM0501001D');
}
/********************************************************************************
* 기      능   :  사무소/권한별 대수 확인  POP-UP
********************************************************************************/
function btn_daesu_OnClick(obj)
{     

      var args  = ' F_ZZACTSS='+quote(ds_cond.getColumn(0, "ZZACTSS"));
         args += ' F_GROUP='+quote(userGroup);
          
	  gfn_openPopup("QM0501001E", true, args);

}
/********************************************************************************
* 기      능   :  대기 일정 입력  POP-UP
********************************************************************************/
function grd_list_OnCellClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
	if ( nCell == 14 && ds_list.getColumn(nRow, "DAEGI") == '1' ) {// && F_ADMIN_YN == "Y") {

	    var args  = ' F_PJT='+quote(ds_list.getColumn(nRow, "PJT"));
            args += ' F_HOGI='+quote(ds_list.getColumn(nRow, "HNO"));
            args += ' F_TYPE='+quote(ds_list.getColumn(nRow, "EXAMTYPE"));
            args += ' F_CHASU='+quote(ds_list.getColumn(nRow, "CHASU"));
            args += ' F_PAPRDT='+quote(ds_list.getColumn(nRow, "EXAMREQDATE"));
         
	  gfn_openPopup("QM0501001F", true, args);

	}
}
/********************************************************************************
* 기      능   :  불합격 상위업체 관리 POP-UP
********************************************************************************/
function btn_baltop_OnClick(obj)
{
	if (F_ADMIN_YN != "Y")	{
       gfn_showAlert('불합격상위설치팀 관리 부서가 아닙니다.');
		return;
	}
	var sParam = "";
	var arr = gfn_openWin('QM0501001G');
	
}

/********************************************************************************
* 기      능   :  불합격 상위업체 관리 POP-UP
********************************************************************************/
function btn_midInspTeam_OnClick(obj)
{
	if (F_ADMIN_YN != "Y")	{
       gfn_showAlert('120m/m 중간검사대상팀 관리 부서가 아닙니다.');
		return;
	}
	var sParam = "";
	var arr = gfn_openWin('QM0501001H',sParam);
}
]]></Script>
</Window>