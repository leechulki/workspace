<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="hdel.sd.sso.dao.Sso0060ND"> 
  
    <resultMap id="selectCodeListResultMap" type="hdel.sd.sso.domain.Sso0060"> 
        <result property="CODE" column="CODE"/>
        <result property="NAME" column="NAME"/>
        <result property="INFO" column="INFO"/>
    </resultMap> 
    <resultMap id="selectManagerListResultMap" type="hdel.sd.sso.domain.Sso0060"> 
        <result property="MANAGER" column="MANAGER"/>
    </resultMap> 
    <resultMap id="selectListVbVgResultMap" type="hdel.sd.sso.domain.Sso0060"> 
        <result property="VKBUR_NM" column="VKBUR_NM"/>
        <result property="VKGRP_NM" column="VKGRP_NM"/> 
    </resultMap> 
    <resultMap id="selectListQtnumResultMap" type="hdel.sd.sso.domain.Sso0060"> 
        <result property="QTNUM" column="QTNUM"/>
        <result property="QTSER" column="QTSER"/>
        <result property="VBELN" column="VBELN"/>
        <result property="ZPRGFLG" column="ZPRGFLG"/>
    </resultMap>  
    <resultMap id="selectListQtnumInfoResultMap" type="hdel.sd.sso.domain.Sso0060"> 
        <result property="AUART"     column="AUART"/>       <!-- 판매 문서 유형       -->
        <result property="SPART"     column="SPART"/>       <!-- 제품군            -->
        <result property="VKBUR"     column="VKBUR"/>       <!-- 사업장            -->
        <result property="VKGRP"     column="VKGRP"/>       <!-- 영업 그룹        -->  
        <result property="WAERK"     column="WAERK"/>       <!-- SD 문서 통화        -->
        <result property="VDATU"     column="VDATU"/>       <!-- 납품요청일        -->
        <result property="KUNNR_RG" column="KUNNR_RG"/> <!-- 판매처            -->
        <result property="KUNNR_Z1" column="KUNNR_Z1"/> <!-- 협력업체-대리점    -->
        <result property="KUNNR_Z2" column="KUNNR_Z2"/> <!-- 담당자            -->
        <result property="WWBLD"     column="WWBLD"/>       <!-- 건물 용도        -->
        <result property="SONNR"     column="SONNR"/>       <!-- 수주계획번호        -->
        <result property="INCO"     column="INCO"/>
        <result property="INCO1"     column="INCO1"/>
        <result property="INCO2"     column="INCO2"/>
        <result property="ZPRGFLG"     column="ZPRGFLG"/>  <!-- 견적진행상태        -->
        <result property="WAERK"     column="WAERK"/>
        <result property="QTDAT"     column="QTDAT"/>
        <result property="CNT" 		column="CNT"/>
        <result property="LHCHK" 	column="LHCHK"/>  		<!-- LH현장 여부        -->
        <result property="LIFNRCHK" column="LIFNRCHK"/> 	<!-- 계약형태 	      -->
    </resultMap> 
    <resultMap id="selectListQtnumItemInfoResultMap" type="hdel.sd.sso.domain.Sso0060">
        <result property="QTSEQ"     column="QTSEQ"/>       <!-- 견적일련번호        --> 
        <result property="MATNR"     column="MATNR"/>       <!-- 자재 번호           -->
        <result property="NETWR"     column="NETWR"/>       <!-- 금액            -->
        <result property="WAVWR"     column="WAVWR"/>       <!-- 원가            -->
        <result property="ARKTX"     column="ARKTX"/>       <!-- SPEC            -->
        <result property="ZNUMBER"    column="ZNUMBER"/>  <!-- 대수            -->    
        <result property="BRNDCD"     column="BRNDCD"/>  <!-- 브랜드코드            -->
        <result property="BRNDSEQ"    column="BRNDSEQ"/>  <!-- 브랜드적용차수            -->
    </resultMap>  
    <resultMap id="selectListRecadDaResultMap" type="hdel.sd.sso.domain.Sso0060">
        <result property="RECAD_DA" column="RECAD_DA"/>   <!-- 수주승인일    --> 
    </resultMap> 
    <resultMap id="selectExchangeRateMap" type="hdel.sd.sso.domain.Sso0060"> 
        <result property="VBELN"  column="VBELN"/>
        <result property="EXRATE" column="EXRATE"/>
    </resultMap>
	<resultMap id="getVbeln" type="hdel.sd.sso.domain.Sso0060"> 
	    <result property="VBELN"  column="VBELN"/>
	</resultMap>
    <resultMap id="selectSopindResultMap" type="hdel.sd.sso.domain.Sso0060"> 
        <result property="AUART" column="AUART"/>
        <result property="SOPIND" column="SOPIND"/>
    </resultMap> 
    
    <!-- 2018.03.30 영업오더 적용환율 표기 기준 변경(가격결정일자 -> 수주일자 기준 환율 표기) by mj.Shin	Start 
    <select id="selectExchangeRate" parameterType="hdel.sd.sso.domain.Sso0060ParamVO" resultMap="selectExchangeRateMap">
    SELECT  A.VBELN, B.KURSK AS EXRATE
      FROM SAPHEE.VBAK A INNER JOIN SAPHEE.VBKD AS B ON A.MANDT = B.MANDT AND A.VBELN = B.VBELN AND B.POSNR = '000000'
     WHERE A.MANDT = #{MANDT}   
       AND A.ZZPJT_ID = #{VBELN} 
     FETCH FIRST 1 ROWS ONLY
      WITH UR
    </select>
    2018.03.30 가격결정일자 -> 수주일자 기준 환율 표기 수정 by mj.Shin	End -->
    
    <!-- 프로젝트번호로 견적번호 조회   -->
    <select id="selectListQtnum" parameterType="hdel.sd.sso.domain.Sso0060ParamVO" resultMap="selectListQtnumResultMap">
    SELECT  A.QTNUM           AS QTNUM  -- 견적번호 
          , A.QTSER         AS QTSER  -- 견적차수 
          , TRIM(A.VBELN)     AS VBELN  -- 프로젝트번호
          , ZPRGFLG         AS ZPRGFLG -- 견적진행상태
      FROM SAPHEE.ZSDT1046 A -- 견적HEADER T/B
     WHERE A.MANDT = #{MANDT}   
       AND A.VBELN = #{VBELN} 
     FETCH FIRST 1 ROWS ONLY
      WITH UR
    </select>
    
    <!--  견적번호로 최종 차수  및 프로젝트번호 조회   -->
    <select id="selectListQtser" parameterType="hdel.sd.sso.domain.Sso0060ParamVO" resultMap="selectListQtnumResultMap">
    SELECT  A.QTNUM         AS QTNUM  -- 견적번호 
          , A.QTSER         AS QTSER  -- 견적차수 
          , TRIM(A.VBELN)     AS VBELN  -- 프로젝트번호
          , ZPRGFLG         AS ZPRGFLG -- 견적진행상태
      FROM SAPHEE.ZSDT1046 A  -- 견적HEADER T/B
     WHERE A.MANDT = #{MANDT}   
       AND A.QTNUM = #{QTNUM}
       AND A.QTSER = (SELECT MAX(QTSER) 
                           FROM SAPHEE.ZSDT1046
                       WHERE MANDT = #{MANDT}   
                         AND QTNUM = #{QTNUM}
                      GROUP BY MANDT, QTNUM
                     ) 
     FETCH FIRST 1 ROWS ONLY
      WITH UR
    </select>
    
    <!--  견적번호로 견적상세정보(파트너정보 포함) 조회  -->
    <select id="selectListQtnumInfo" parameterType="hdel.sd.sso.domain.Sso0060ParamVO" resultMap="selectListQtnumInfoResultMap">
		with z1058 as (
			select distinct
				qtso_no as qtnum
				,qtser
				,count(*) over() as cnt
				,max(kunnr_z3) over(partition by qtser) as kunnr_z3
			from saphee.zsdt1058
			where mandt=#{MANDT}
			and qtso_no=#{QTNUM}
		)
		,z1077 as (
			select distinct
				qtso_no as qtnum
				,qtser
				,count(*) over() as cnt
				,max(kunnr_z3) over(partition by qtser) as kunnr_z3
			from saphee.zsdt1077
			where mandt=#{MANDT}
			and qtso_no=#{QTNUM}
		)
		, z1091 as (
		    select distinct
				qtnum
				,qtser
				,count(*) over() as lhchk_cnt
		     from saphee.zsdt1091
		    where mandt  = #{MANDT}
		      and qtnum  = #{QTNUM}
			  and qtser  = #{QTSER}
/*			  and zaddin = 'A'  */
			  and lh = 'X'
		)
		select
			z1046.auart as AUART		-- 판매 문서 유형
			,z1046.spart as SPART		-- 제품군
			,z1046.vkbur as VKBUR		-- 부서코드
			,z1046.vkgrp as VKGRP		-- 팀코드 
			,z1046.gsnam as BSTKD		-- 현장명
			,z1046.waerk as WAERK		-- SD 문서 통화
			,z1046.deldat as VDATU		-- 납품요청일
			,z1046.kunnr as KUNNR_RG	-- 판매처  (파트너정보)
			,z1046.zagnt as KUNNR_Z1	-- 협력업체-대리점 (파트너정보)
			,z1046.zkunnr as KUNNR_Z2	-- 담당자 (파트너정보)
			,z1046.zbdtyp as WWBLD		-- 건물 용도
			,z1046.sonnr as SONNR		-- 수주계획번호
			,z1046.inco as INCO			-- 인도조건
			,z1046.inco as INCO1		-- 인도조건
			,z1046.inco2 as INCO2		-- 이도조건2
			,z1046.zprgflg as ZPRGFLG	-- 수주진행상태 
			,z1046.waerk as WAERK		-- 화폐단위
			,z1046.qtdat as QTDAT		-- 견적일자
			,value(z1058.kunnr_z3, z1077.kunnr_z3) as KUNNR_Z3
			,value(z1058.cnt, z1077.cnt) as CNT
			,case when z1091.lhchk_cnt > 0 then 'X' else '' end as LHCHK	-- LH현장 여부
			,z1046.lifnrchk				-- 계약형태 
		from saphee.zsdt1046 as z1046
			left join z1058 on z1046.qtnum=z1058.qtnum and z1046.qtser=z1058.qtser
			left join z1077 on z1046.qtnum=z1077.qtnum and z1046.qtser=z1077.qtser
			left join z1091 on z1046.qtnum=z1091.qtnum and z1046.qtser=z1091.qtser			
		where z1046.mandt=#{MANDT}
		and z1046.qtnum=#{QTNUM}
		and z1046.qtser=#{QTSER}
		with ur
    </select> 
    
    <!--  견적번호로 견적품목상세정보 조회  -->
    <select id="selectListQtnumItemInfo" parameterType="hdel.sd.sso.domain.Sso0060ParamVO" resultMap="selectListQtnumItemInfoResultMap">
    SELECT 
           A.QTSEQ        AS QTSEQ   -- 견적일련번호
          ,A.MATNR         AS MATNR   -- 자재 번호
          ,A.ZEAM         AS NETWR   -- 금액
          ,A.ZCOST        AS WAVWR   -- 원가
          ,''             AS ARKTX   -- SPEC (수주생성 시 사양정보로 다시 생성하기로 하여 견적자료 불필요)
          ,A.ZNUMBER     AS ZNUMBER -- 대수   (대수만큼 품목 목록 재생성해야 함)
          ,TRIM(A.BRNDCD) AS BRNDCD 
          ,A.BRNDSEQ AS BRNDSEQ
     FROM SAPHEE.ZSDT1047 A       -- 견적DETAIL  T/B
    WHERE A.MANDT = #{MANDT}    -- CLIENT
      AND A.QTNUM = #{QTNUM}    -- 견적번호
      AND A.QTSER = #{QTSER}    -- 견적차수
    ORDER BY A.QTSEQ 
      WITH UR
    </select>

    <!--  부서,팀 정보 조회   -->
    <select id="selectListVbVg" parameterType="hdel.sd.sso.domain.Sso0060ParamVO" resultMap="selectListVbVgResultMap">    
    SELECT  A.BEZEI AS VKBUR_NM  -- 부서명 
           ,B.BEZEI AS VKGRP_NM  -- 팀명
      FROM SAPHEE.TVKBT A  -- 부서T/B
          ,SAPHEE.TVGRT B  -- 팀T/B
     WHERE A.MANDT = #{MANDT}
       AND A.VKBUR = #{VKBUR}
       AND A.SPRAS = '3'  
       AND B.MANDT = #{MANDT}
       AND B.VKGRP = #{VKGRP}
       AND B.SPRAS = '3'
     FETCH FIRST 1 ROWS ONLY
    WITH UR
    </select>
    
    <!--  판매처목록 조회   -->
    <select id="selectListKunnrRg" parameterType="hdel.sd.sso.domain.Sso0060ParamVO" resultMap="selectCodeListResultMap">
    SELECT KUNNR                 AS CODE       -- 판매처코드
          ,NAME1                 AS NAME     -- 판매처명
          ,LAND1||'/'||ORT01||' '||STRAS     AS INFO        -- 판매처주소
      FROM SAPHEE.KNA1
     WHERE 1=1
       AND MANDT= #{MANDT}
       AND KTOKD IN ('Z001', 'Z002', 'Z004' )
       AND KUNNR = CHAR(REPEAT('0', 10 - LENGTH(RTRIM(LTRIM(#{CODE}||''))) ) ||#{CODE}||'') 
      WITH UR 
    </select>
    
    <!--  납품처목록 조회   -->
    <select id="selectListKunnrWe" parameterType="hdel.sd.sso.domain.Sso0060ParamVO" resultMap="selectCodeListResultMap">
    SELECT KUNNR                 AS CODE       -- 납품처코드
          ,NAME1                 AS NAME     -- 납품처명
          ,LAND1||'/'||ORT01||' '||STRAS     AS INFO        -- 납품처주소
      FROM SAPHEE.KNA1
     WHERE 1=1
       AND MANDT= #{MANDT}
       AND KTOKD IN ( 'Z004', 'Z101' ) 
       AND KUNNR = CHAR(REPEAT('0', 10 - LENGTH(RTRIM(LTRIM(#{CODE}||''))) ) ||#{CODE}||'') 
      WITH UR 
    </select>
      
    <!--  대리점정보 조회   -->
    <select id="selectListKunnrZ1" parameterType="hdel.sd.sso.domain.Sso0060ParamVO" resultMap="selectCodeListResultMap">
    SELECT   LIFNR AS CODE  -- 대리점코드
           , NAME1 AS NAME    -- 대리점명
           , ''    AS INFO    -- 부가정보
      FROM SAPHEE.LFA1
     WHERE MANDT = #{MANDT} 
       AND LIFNR = #{CODE}
      WITH UR
    </select> 
    
    <!--  담당자정보 조회   -->
    <select id="selectListKunnrZ2" parameterType="hdel.sd.sso.domain.Sso0060ParamVO" resultMap="selectCodeListResultMap">
    SELECT  KUNNR                 AS CODE        -- 담당자코드    
          , NAME1                 AS NAME        -- 담당자명
          , ORT01||' '||STRAS     AS INFO        -- 담당자정보
      FROM SAPHEE.KNA1
     WHERE MANDT = #{MANDT}
       AND KTOKD = 'Z201'
       AND KUNNR = #{CODE} 
      WITH UR
    </select> 
    
    <!--  기술영업담당자정보 조회   -->
    <select id="selectListKunnrZ3" parameterType="hdel.sd.sso.domain.Sso0060ParamVO" resultMap="selectCodeListResultMap">
    SELECT  KUNNR                 AS CODE        -- 기술영업담당자코드    
          , NAME1                 AS NAME        -- 기술영업담당자명
          , ORT01||' '||STRAS     AS INFO        -- 기술영업담당자정보
      FROM SAPHEE.KNA1
     WHERE MANDT = #{MANDT}
       AND KTOKD = 'Z201'
       AND KUNNR = #{CODE} 
      WITH UR
    </select> 
    
    <select id="selectListManager" parameterType="hdel.sd.sso.domain.Sso0060ParamVO" resultMap="selectManagerListResultMap">
    SELECT MANAGER
    FROM SAPHEE.ZSDT0149
    WHERE MANDT = #{MANDT}
      AND SDFIELD = #{SDFIELD}
      AND DEALER = #{ZKUNNR}
    WITH UR
    </select>
    
    <!--  수주승인일 조회   -->
    <select id="selectListRecadDa" parameterType="hdel.sd.sso.domain.Sso0060ParamVO" resultMap="selectListRecadDaResultMap">
    SELECT RECAD_DA         -- 수주승인일 
      FROM SAPHEE.VBAK
     WHERE MANDT = #{MANDT} 
       AND VBELN = #{VBELN} 
      WITH UR
    </select>  

    <!-- 견적진행상태 변경 -->
    <update id="updateZsdt1046Zprgflg" parameterType="hdel.sd.sso.domain.Sso0060">
        UPDATE SAPHEE.ZSDT1046
           SET ZPRGFLG = #{ZPRGFLG}
             , UTIME   = #{UTIME}
             , UUSER   = #{UUSER}
         WHERE MANDT = #{MANDT}
           AND QTNUM = #{QTNUM}
           AND QTSER = #{QTSER}
    </update>

    <!-- 수주계획 상태 변경 -->
    <update id="updateZsdt1001Sorlt" parameterType="hdel.sd.sso.domain.Sso0060">
        UPDATE SAPHEE.ZSDT1001
           SET SORLT = #{ZPRGFLG}
             , UTIME = #{UTIME}
             , UUSER = #{UUSER}
         WHERE MANDT = #{MANDT}
           AND SONNR IN (SELECT SONNR FROM SAPHEE.ZSDT1047 
                             WHERE MANDT = #{MANDT}
                               AND QTNUM = #{QTNUM}
                               AND QTSER = #{QTSER} )
    </update>
    <!--  2016 ADD QUERY PARK SOO KEUN -->
    <select id="selectTmpCount" parameterType="hdel.sd.sso.domain.Sso0060ParamVO" resultType="int">
        SELECT COUNT(MANDT) AS CNT
        FROM   SAPHEE.ZSDT1100
        WHERE  1 = 1
          AND  MANDT = #{MANDT}
          AND  QTNUM = #{QTNUM}
          AND  QTSER = #{QTSER}
        WITH UR
    </select>
    <select id="selectTmpQtHeader" parameterType="hdel.sd.sso.domain.Sso0060ParamVO" resultType="hdel.sd.sso.domain.ZSDT1100">
        SELECT MANDT
              ,QTNUM
              ,QTSER
              ,AUART
              ,SPART
              ,VKBUR
              ,VKGRP
              ,KUNNR_RG
              ,KUNNR_RG2
              ,KUNNR_WE
              ,KUNNR_Z1
              ,KUNNR_Z2
              ,KUNNR_Z3
              ,BSTKD
              ,BSTDK
              ,VDATU
              ,ZTERM
              ,WAERK
              ,TRIM(INCO1) AS INCO1
              ,TRIM(INCO2) AS INCO2
              ,CONTR_DA
              ,WWBLD
              ,REPMO
              ,GUAMO
              ,FRMDA
              ,STADA
              ,RECAD_DA
              ,WORMO
              ,TRIM(PSPID) AS PSPID
              ,REGION
              ,HIGH_G
              ,ADMITNO
              ,CHEOR
              ,COMPL_DA
              ,FINAL_DA
              ,TRIM(ENFOR) AS ENFOR
              ,TURNKEY
              ,KISCON
              ,HEL_REG
              ,TRIM(LIFNR) AS LIFNR
              ,TRIM(LIFNR2) AS LIFNR2
              ,TRIM(LIFNR3) AS LIFNR3
              ,LIFNRCHK
              ,TRIM(REG_NO) AS REG_NO
              ,TRIM(REG_PE) AS REG_PE
              ,TRIM(EMAIL) AS EMAIL
              ,TRIM(SOCNO) AS SOCNO
              ,TRIM(CORNO) AS CORNO
              ,TRIM(COMNO) AS COMNO
              ,SEP_MON
              ,BILL_GBN
              ,HB_STN
              ,HB_FROM
              ,HB_TO
              ,HB_PUB
              ,MB_STN
              ,FKSAK
              ,KVGR1
              ,SHCHK
              ,LHCHK
              ,KUNAPRV
              ,ACHTP
              ,ACHDT
              ,ACHNO
              ,SOPTP
              ,SOPDT
              ,AUPTP
              ,VIPTP
              ,ARCPI
        FROM   SAPHEE.ZSDT1100
        WHERE  1 = 1
          AND  MANDT = #{MANDT}
          AND  QTNUM = #{QTNUM}
          AND  QTSER = #{QTSER}
        WITH UR
    </select>
    <update id="mergeTmpQtHeader" parameterType="hdel.sd.sso.domain.ZSDT1100">
        MERGE INTO SAPHEE.ZSDT1100 AS T1
        USING( SELECT CAST(#{MANDT}  AS VARCHAR(9)) AS MANDT
                     ,CAST(#{QTNUM}  AS VARCHAR(30)) AS QTNUM
                     ,CAST(#{QTSER}  AS SMALLINT) AS QTSER
               FROM   SYSIBM.SYSDUMMY1
             ) AS T2 ON T1.MANDT = T2.MANDT AND T1.QTNUM = T2.QTNUM AND T1.QTSER = T2.QTSER
        WHEN MATCHED THEN
        UPDATE
        SET   <if test="AUART != null">T1.AUART     =  #{AUART} </if>
              <if test="AUART == null or AUART == '' ">T1.AUART     =  '' </if>
              <if test="SPART != null">,T1.SPART     =  #{SPART}</if>     
              <if test="VKBUR != null">,T1.VKBUR     =  #{VKBUR}</if>     
              <if test="VKGRP != null">,T1.VKGRP     =  #{VKGRP}</if>     
              <if test="KUNNR_RG != null">,T1.KUNNR_RG  =  #{KUNNR_RG}</if>     
              <if test="KUNNR_RG2 != null">,T1.KUNNR_RG2  =  #{KUNNR_RG2}</if>     
              <if test="KUNNR_WE != null">,T1.KUNNR_WE  =  #{KUNNR_WE}</if>     
              <if test="KUNNR_Z1 != null">,T1.KUNNR_Z1  =  #{KUNNR_Z1}</if>     
              <if test="KUNNR_Z2 != null">,T1.KUNNR_Z2  =  #{KUNNR_Z2}</if>     
              <if test="KUNNR_Z3 != null">,T1.KUNNR_Z3  =  #{KUNNR_Z3}</if>     
              <if test="BSTKD != null">,T1.BSTKD  =  #{BSTKD}</if>     
              <if test="BSTDK != null">,T1.BSTDK  =  #{BSTDK}</if>     
              <if test="VDATU != null">,T1.VDATU  =  #{VDATU}</if>     
              <if test="ZTERM != null">,T1.ZTERM  =  #{ZTERM}</if>     
              <if test="WAERK != null">,T1.WAERK  =  #{WAERK}</if>     
              <if test="INCO1 != null">,T1.INCO1  =  #{INCO1}</if>     
              <if test="INCO2 != null">,T1.INCO2  =  #{INCO2}</if>     
              <if test="CONTR_DA != null">,T1.CONTR_DA  =  #{CONTR_DA}</if>     
              <if test="WWBLD != null">,T1.WWBLD  =  #{WWBLD}</if>     
              <if test="REPMO != null">,T1.REPMO  =  #{REPMO}</if>     
              <if test="GUAMO != null">,T1.GUAMO  =  #{GUAMO}</if>     
              <if test="FRMDA != null">,T1.FRMDA  =  #{FRMDA}</if>     
              <if test="STADA != null">,T1.STADA  =  #{STADA}</if>     
              <if test="RECAD_DA != null">,T1.RECAD_DA  =  #{RECAD_DA}</if>     
              <if test="WORMO != null">,T1.WORMO  =  #{WORMO}</if>     
              <if test="PSPID != null">,T1.PSPID  =  #{PSPID}</if>     
              <if test="REGION != null">,T1.REGION  =  #{REGION}</if>     
              <if test="HIGH_G != null">,T1.HIGH_G  =  #{HIGH_G}</if>     
              <if test="ADMITNO != null">,T1.ADMITNO  =  #{ADMITNO}</if>     
              <if test="CHEOR != null">,T1.CHEOR  =  #{CHEOR}</if>     
              <if test="COMPL_DA != null">,T1.COMPL_DA  =  #{COMPL_DA}</if>     
              <if test="FINAL_DA != null">,T1.FINAL_DA  =  #{FINAL_DA}</if>     
              <if test="ENFOR != null">,T1.ENFOR  =  #{ENFOR}</if>     
              <if test="TURNKEY != null">,T1.TURNKEY  =  #{TURNKEY}</if>     
              <if test="KISCON != null">,T1.KISCON  =  #{KISCON}</if>     
              <if test="HEL_REG != null">,T1.HEL_REG  =  #{HEL_REG}</if>     
              <if test="LIFNR != null">,T1.LIFNR  =  #{LIFNR}</if>     
              <if test="LIFNR2 != null">,T1.LIFNR2  =  #{LIFNR2}</if>     
              <if test="LIFNR3 != null">,T1.LIFNR3  =  #{LIFNR3}</if>     
              <if test="LIFNRCHK != null">,T1.LIFNRCHK  =  #{LIFNRCHK}</if>     
              <if test="REG_NO != null">,T1.REG_NO  =  #{REG_NO}</if>     
              <if test="REG_PE != null">,T1.REG_PE  =  #{REG_PE}</if>     
              <if test="EMAIL != null">,T1.EMAIL  =  #{EMAIL}</if>     
              <if test="SOCNO != null">,T1.SOCNO  =  #{SOCNO}</if>     
              <if test="CORNO != null">,T1.CORNO  =  #{CORNO}</if>     
              <if test="COMNO != null">,T1.COMNO  =  #{COMNO}</if>     
              <if test="SEP_MON != null">,T1.SEP_MON  =  #{SEP_MON}</if>     
              <if test="BILL_GBN != null">,T1.BILL_GBN  =  #{BILL_GBN}</if>     
              <if test="HB_STN != null">,T1.HB_STN  =  #{HB_STN}</if>     
              <if test="HB_FROM != null">,T1.HB_FROM  =  #{HB_FROM}</if>     
              <if test="HB_TO != null">,T1.HB_TO  =  #{HB_TO}</if>     
              <if test="HB_PUB != null">,T1.HB_PUB  =  #{HB_PUB}</if>     
              <if test="MB_STN != null">,T1.MB_STN  =  #{MB_STN}</if>     
              <if test="FKSAK != null">,T1.FKSAK  =  #{FKSAK}</if>     
              <if test="KVGR1 != null">,T1.KVGR1  =  #{KVGR1}</if>     
              <if test="SHCHK != null">,T1.SHCHK  =  #{SHCHK}</if>
              <if test="LHCHK != null">,T1.LHCHK  =  #{LHCHK}</if>
              <if test="KUNAPRV != null">,T1.KUNAPRV  =  #{KUNAPRV}</if>
              <if test="ACHTP != null">,T1.ACHTP  =  #{ACHTP}</if>
              <if test="ACHDT != null">,T1.ACHDT  =  #{ACHDT}</if>
              <if test="ACHNO != null">,T1.ACHNO  =  #{ACHNO}</if>
              <if test="SOPTP != null">,T1.SOPTP  =  #{SOPTP}</if>
              <if test="SOPDT != null">,T1.SOPDT  =  #{SOPDT}</if>
              <if test="AUPTP != null">,T1.AUPTP  =  #{AUPTP}</if>
              <if test="VIPTP != null">,T1.VIPTP  =  #{VIPTP}</if>
              
        WHEN NOT MATCHED THEN      
            INSERT
            (
             T1.MANDT
            ,T1.QTNUM
            ,T1.QTSER
              <if test="AUART != null">,T1.AUART</if>               
              <if test="SPART != null">,T1.SPART</if>               
              <if test="VKBUR != null">,T1.VKBUR</if>               
              <if test="VKGRP != null">,T1.VKGRP</if>               
              <if test="KUNNR_RG != null">,T1.KUNNR_RG</if>         
              <if test="KUNNR_RG2 != null">,T1.KUNNR_RG2</if>      
              <if test="KUNNR_WE != null">,T1.KUNNR_WE</if>         
              <if test="KUNNR_Z1 != null">,T1.KUNNR_Z1</if>         
              <if test="KUNNR_Z2 != null">,T1.KUNNR_Z2</if>         
              <if test="KUNNR_Z3 != null">,T1.KUNNR_Z3</if>         
              <if test="BSTKD != null">,T1.BSTKD</if>                  
              <if test="BSTDK != null">,T1.BSTDK</if>                  
              <if test="VDATU != null">,T1.VDATU</if>                  
              <if test="ZTERM != null">,T1.ZTERM</if>                  
              <if test="WAERK != null">,T1.WAERK</if>                  
              <if test="INCO1 != null">,T1.INCO1</if>                  
              <if test="INCO2 != null">,T1.INCO2</if>                  
              <if test="CONTR_DA != null">,T1.CONTR_DA</if>         
              <if test="WWBLD != null">,T1.WWBLD</if>                  
              <if test="REPMO != null">,T1.REPMO</if>                  
              <if test="GUAMO != null">,T1.GUAMO</if>                  
              <if test="FRMDA != null">,T1.FRMDA</if>                  
              <if test="STADA != null">,T1.STADA</if>                  
              <if test="RECAD_DA != null">,T1.RECAD_DA</if>         
              <if test="WORMO != null">,T1.WORMO</if>                  
              <if test="PSPID != null">,T1.PSPID</if>                  
              <if test="REGION != null">,T1.REGION</if>               
              <if test="HIGH_G != null">,T1.HIGH_G</if>               
              <if test="ADMITNO != null">,T1.ADMITNO</if>            
              <if test="CHEOR != null">,T1.CHEOR</if>                  
              <if test="COMPL_DA != null">,T1.COMPL_DA</if>         
              <if test="FINAL_DA != null">,T1.FINAL_DA</if>         
              <if test="ENFOR != null">,T1.ENFOR</if>                  
              <if test="TURNKEY != null">,T1.TURNKEY</if>            
              <if test="KISCON != null">,T1.KISCON</if>               
              <if test="HEL_REG != null">,T1.HEL_REG</if>            
              <if test="LIFNR != null">,T1.LIFNR</if>                  
              <if test="LIFNR2 != null">,T1.LIFNR2</if>               
              <if test="LIFNR3 != null">,T1.LIFNR3</if>               
              <if test="LIFNRCHK != null">,T1.LIFNRCHK</if>         
              <if test="REG_NO != null">,T1.REG_NO</if>               
              <if test="REG_PE != null">,T1.REG_PE</if>               
              <if test="EMAIL != null">,T1.EMAIL</if>                  
              <if test="SOCNO != null">,T1.SOCNO</if>                  
              <if test="CORNO != null">,T1.CORNO</if>                  
              <if test="COMNO != null">,T1.COMNO</if>                  
              <if test="SEP_MON != null">,T1.SEP_MON</if>            
              <if test="BILL_GBN != null">,T1.BILL_GBN</if>         
              <if test="HB_STN != null">,T1.HB_STN</if>               
              <if test="HB_FROM != null">,T1.HB_FROM</if>            
              <if test="HB_TO != null">,T1.HB_TO</if>                  
              <if test="HB_PUB != null">,T1.HB_PUB</if>               
              <if test="MB_STN != null">,T1.MB_STN</if>               
              <if test="FKSAK != null">,T1.FKSAK</if>                  
              <if test="KVGR1 != null">,T1.KVGR1</if> 
              <if test="SHCHK != null">,T1.SHCHK</if>
              <if test="LHCHK != null">,T1.LHCHK</if>
              <if test="KUNAPRV != null">,T1.KUNAPRV</if>
              <if test="ACHTP != null">,T1.ACHTP</if>
              <if test="ACHDT != null">,T1.ACHDT</if>
              <if test="ACHNO != null">,T1.ACHNO</if>
              <if test="SOPTP != null">,T1.SOPTP</if>
              <if test="SOPDT != null">,T1.SOPDT</if>
              <if test="AUPTP != null">,T1.AUPTP</if>
              <if test="VIPTP != null">,T1.VIPTP</if>
              
            )
            VALUES
            (
             #{MANDT}
            ,#{QTNUM}
            ,#{QTSER}
              <if test="AUART != null">,#{AUART}</if>               
              <if test="SPART != null">,#{SPART}</if>               
              <if test="VKBUR != null">,#{VKBUR}</if>               
              <if test="VKGRP != null">,#{VKGRP}</if>               
              <if test="KUNNR_RG != null">,#{KUNNR_RG}</if>         
              <if test="KUNNR_RG2 != null">,#{KUNNR_RG2}</if>      
              <if test="KUNNR_WE != null">,#{KUNNR_WE}</if>         
              <if test="KUNNR_Z1 != null">,#{KUNNR_Z1}</if>         
              <if test="KUNNR_Z2 != null">,#{KUNNR_Z2}</if>         
              <if test="KUNNR_Z3 != null">,#{KUNNR_Z3}</if>         
              <if test="BSTKD != null">,#{BSTKD}</if>                  
              <if test="BSTDK != null">,#{BSTDK}</if>                  
              <if test="VDATU != null">,#{VDATU}</if>                  
              <if test="ZTERM != null">,#{ZTERM}</if>                  
              <if test="WAERK != null">,#{WAERK}</if>                  
              <if test="INCO1 != null">,#{INCO1}</if>                  
              <if test="INCO2 != null">,#{INCO2}</if>                  
              <if test="CONTR_DA != null">,#{CONTR_DA}</if>         
              <if test="WWBLD != null">,#{WWBLD}</if>                  
              <if test="REPMO != null">,#{REPMO}</if>                  
              <if test="GUAMO != null">,#{GUAMO}</if>                  
              <if test="FRMDA != null">,#{FRMDA}</if>                  
              <if test="STADA != null">,#{STADA}</if>                  
              <if test="RECAD_DA != null">,#{RECAD_DA}</if>         
              <if test="WORMO != null">,#{WORMO}</if>                  
              <if test="PSPID != null">,#{PSPID}</if>                  
              <if test="REGION != null">,#{REGION}</if>               
              <if test="HIGH_G != null">,#{HIGH_G}</if>               
              <if test="ADMITNO != null">,#{ADMITNO}</if>            
              <if test="CHEOR != null">,#{CHEOR}</if>                  
              <if test="COMPL_DA != null">,#{COMPL_DA}</if>         
              <if test="FINAL_DA != null">,#{FINAL_DA}</if>         
              <if test="ENFOR != null">,#{ENFOR}</if>                  
              <if test="TURNKEY != null">,#{TURNKEY}</if>            
              <if test="KISCON != null">,#{KISCON}</if>               
              <if test="HEL_REG != null">,#{HEL_REG}</if>            
              <if test="LIFNR != null">,#{LIFNR}</if>                  
              <if test="LIFNR2 != null">,#{LIFNR2}</if>               
              <if test="LIFNR3 != null">,#{LIFNR3}</if>               
              <if test="LIFNRCHK != null">,#{LIFNRCHK}</if>         
              <if test="REG_NO != null">,#{REG_NO}</if>               
              <if test="REG_PE != null">,#{REG_PE}</if>               
              <if test="EMAIL != null">,#{EMAIL}</if>                  
              <if test="SOCNO != null">,#{SOCNO}</if>                  
              <if test="CORNO != null">,#{CORNO}</if>                  
              <if test="COMNO != null">,#{COMNO}</if>                  
              <if test="SEP_MON != null">,#{SEP_MON}</if>            
              <if test="BILL_GBN != null">,#{BILL_GBN}</if>         
              <if test="HB_STN != null">,#{HB_STN}</if>               
              <if test="HB_FROM != null">,#{HB_FROM}</if>            
              <if test="HB_TO != null">,#{HB_TO}</if>                  
              <if test="HB_PUB != null">,#{HB_PUB}</if>               
              <if test="MB_STN != null">,#{MB_STN}</if>               
              <if test="FKSAK != null">,#{FKSAK}</if>                  
              <if test="KVGR1 != null">,#{KVGR1}</if>     
              <if test="SHCHK != null">,#{SHCHK}</if>
              <if test="LHCHK != null">,#{LHCHK}</if>
              <if test="KUNAPRV != null">,#{KUNAPRV}</if>
              <if test="ACHTP != null">,#{ACHTP}</if>
              <if test="ACHDT != null">,#{ACHDT}</if>
              <if test="ACHNO != null">,#{ACHNO}</if>
              <if test="SOPTP != null">,#{SOPTP}</if>
              <if test="SOPDT != null">,#{SOPDT}</if>
              <if test="AUPTP != null">,#{AUPTP}</if>
              <if test="VIPTP != null">,#{VIPTP}</if>
            )
    </update>    
    <insert id="insertTmpQtHeader" parameterType="hdel.sd.sso.domain.ZSDT1100">
            INSERT INTO SAPHEE.ZSDT1100
            (
             MANDT
            ,QTNUM
            ,QTSER
              <if test="AUART != null">,AUART</if>               
              <if test="SPART != null">,SPART</if>               
              <if test="VKBUR != null">,VKBUR</if>               
              <if test="VKGRP != null">,VKGRP</if>               
              <if test="KUNNR_RG != null">,KUNNR_RG</if>         
              <if test="KUNNR_RG2 != null">,KUNNR_RG2</if>      
              <if test="KUNNR_WE != null">,KUNNR_WE</if>         
              <if test="KUNNR_Z1 != null">,KUNNR_Z1</if>         
              <if test="KUNNR_Z2 != null">,KUNNR_Z2</if>         
              <if test="KUNNR_Z3 != null">,KUNNR_Z3</if>         
              <if test="BSTKD != null">,BSTKD</if>                  
              <if test="BSTDK != null">,BSTDK</if>                  
              <if test="VDATU != null">,VDATU</if>                  
              <if test="ZTERM != null">,ZTERM</if>                  
              <if test="WAERK != null">,WAERK</if>                  
              <if test="INCO1 != null">,INCO1</if>                  
              <if test="INCO2 != null">,INCO2</if>                  
              <if test="CONTR_DA != null">,CONTR_DA</if>         
              <if test="WWBLD != null">,WWBLD</if>                  
              <if test="REPMO != null">,REPMO</if>                  
              <if test="GUAMO != null">,GUAMO</if>                  
              <if test="FRMDA != null">,FRMDA</if>                  
              <if test="STADA != null">,STADA</if>                  
              <if test="RECAD_DA != null">,RECAD_DA</if>         
              <if test="WORMO != null">,WORMO</if>                  
              <if test="PSPID != null">,PSPID</if>                  
              <if test="REGION != null">,REGION</if>               
              <if test="HIGH_G != null">,HIGH_G</if>               
              <if test="ADMITNO != null">,ADMITNO</if>            
              <if test="CHEOR != null">,CHEOR</if>                  
              <if test="COMPL_DA != null">,COMPL_DA</if>         
              <if test="FINAL_DA != null">,FINAL_DA</if>         
              <if test="ENFOR != null">,ENFOR</if>                  
              <if test="TURNKEY != null">,TURNKEY</if>            
              <if test="KISCON != null">,KISCON</if>               
              <if test="HEL_REG != null">,HEL_REG</if>            
              <if test="LIFNR != null">,LIFNR</if>                  
              <if test="LIFNR2 != null">,LIFNR2</if>               
              <if test="LIFNR3 != null">,LIFNR3</if>               
              <if test="LIFNRCHK != null">,LIFNRCHK</if>         
              <if test="REG_NO != null">,REG_NO</if>               
              <if test="REG_PE != null">,REG_PE</if>               
              <if test="EMAIL != null">,EMAIL</if>                  
              <if test="SOCNO != null">,SOCNO</if>                  
              <if test="CORNO != null">,CORNO</if>                  
              <if test="COMNO != null">,COMNO</if>                  
              <if test="SEP_MON != null">,SEP_MON</if>            
              <if test="BILL_GBN != null">,BILL_GBN</if>         
              <if test="HB_STN != null">,HB_STN</if>               
              <if test="HB_FROM != null">,HB_FROM</if>            
              <if test="HB_TO != null">,HB_TO</if>                  
              <if test="HB_PUB != null">,HB_PUB</if>               
              <if test="MB_STN != null">,MB_STN</if>               
              <if test="FKSAK != null">,FKSAK</if>                  
              <if test="KVGR1 != null">,KVGR1</if>
              <if test="SHCHK != null">,SHCHK</if>
              <if test="LHCHK != null">,LHCHK</if>
              <if test="KUNAPRV != null">,KUNAPRV</if>
              <if test="ACHTP != null">,ACHTP</if>               
              <if test="ACHDT != null">,ACHDT</if>
              <if test="ACHNO != null">,ACHNO</if>
              <if test="SOPTP != null">,SOPTP</if>
              <if test="SOPDT != null">,SOPDT</if>                            
              <if test="AUPTP != null">,AUPTP</if>
              <if test="VIPTP != null">,VIPTP</if>
              <if test="ARCPI != null">,ARCPI</if>
            )
            VALUES
            (
             #{MANDT}
            ,#{QTNUM}
            ,#{QTSER}
              <if test="AUART != null">,#{AUART}</if>               
              <if test="SPART != null">,#{SPART}</if>               
              <if test="VKBUR != null">,#{VKBUR}</if>               
              <if test="VKGRP != null">,#{VKGRP}</if>               
              <if test="KUNNR_RG != null">,#{KUNNR_RG}</if>         
              <if test="KUNNR_RG2 != null">,#{KUNNR_RG2}</if>      
              <if test="KUNNR_WE != null">,#{KUNNR_WE}</if>         
              <if test="KUNNR_Z1 != null">,#{KUNNR_Z1}</if>         
              <if test="KUNNR_Z2 != null">,#{KUNNR_Z2}</if>         
              <if test="KUNNR_Z3 != null">,#{KUNNR_Z3}</if>         
              <if test="BSTKD != null">,#{BSTKD}</if>                  
              <if test="BSTDK != null">,#{BSTDK}</if>                  
              <if test="VDATU != null">,#{VDATU}</if>                  
              <if test="ZTERM != null">,#{ZTERM}</if>                  
              <if test="WAERK != null">,#{WAERK}</if>                  
              <if test="INCO1 != null">,#{INCO1}</if>                  
              <if test="INCO2 != null">,#{INCO2}</if>                  
              <if test="CONTR_DA != null">,#{CONTR_DA}</if>         
              <if test="WWBLD != null">,#{WWBLD}</if>                  
              <if test="REPMO != null">,#{REPMO}</if>                  
              <if test="GUAMO != null">,#{GUAMO}</if>                  
              <if test="FRMDA != null">,#{FRMDA}</if>                  
              <if test="STADA != null">,#{STADA}</if>                  
              <if test="RECAD_DA != null">,#{RECAD_DA}</if>         
              <if test="WORMO != null">,#{WORMO}</if>                  
              <if test="PSPID != null">,#{PSPID}</if>                  
              <if test="REGION != null">,#{REGION}</if>               
              <if test="HIGH_G != null">,#{HIGH_G}</if>               
              <if test="ADMITNO != null">,#{ADMITNO}</if>            
              <if test="CHEOR != null">,#{CHEOR}</if>                  
              <if test="COMPL_DA != null">,#{COMPL_DA}</if>         
              <if test="FINAL_DA != null">,#{FINAL_DA}</if>         
              <if test="ENFOR != null">,#{ENFOR}</if>                  
              <if test="TURNKEY != null">,#{TURNKEY}</if>            
              <if test="KISCON != null">,#{KISCON}</if>               
              <if test="HEL_REG != null">,#{HEL_REG}</if>            
              <if test="LIFNR != null">,#{LIFNR}</if>                  
              <if test="LIFNR2 != null">,#{LIFNR2}</if>               
              <if test="LIFNR3 != null">,#{LIFNR3}</if>               
              <if test="LIFNRCHK != null">,#{LIFNRCHK}</if>         
              <if test="REG_NO != null">,#{REG_NO}</if>               
              <if test="REG_PE != null">,#{REG_PE}</if>               
              <if test="EMAIL != null">,#{EMAIL}</if>                  
              <if test="SOCNO != null">,#{SOCNO}</if>                  
              <if test="CORNO != null">,#{CORNO}</if>                  
              <if test="COMNO != null">,#{COMNO}</if>                  
              <if test="SEP_MON != null">,#{SEP_MON}</if>            
              <if test="BILL_GBN != null">,#{BILL_GBN}</if>         
              <if test="HB_STN != null">,#{HB_STN}</if>               
              <if test="HB_FROM != null">,#{HB_FROM}</if>            
              <if test="HB_TO != null">,#{HB_TO}</if>                  
              <if test="HB_PUB != null">,#{HB_PUB}</if>               
              <if test="MB_STN != null">,#{MB_STN}</if>               
              <if test="FKSAK != null">,#{FKSAK}</if>                  
              <if test="KVGR1 != null">,#{KVGR1}</if>  
              <if test="SHCHK != null">,#{SHCHK}</if>
              <if test="LHCHK != null">,#{LHCHK}</if>
              <if test="KUNAPRV != null">,#{KUNAPRV}</if>
              <if test="ACHTP != null">,#{ACHTP}</if>   
              <if test="ACHDT != null">,#{ACHDT}</if>
              <if test="ACHNO != null">,#{ACHNO}</if>
              <if test="SOPTP != null">,#{SOPTP}</if>
              <if test="SOPDT != null">,#{SOPDT}</if>
              <if test="AUPTP != null">,#{AUPTP}</if>
              <if test="VIPTP != null">,#{VIPTP}</if>
              <if test="ARCPI != null">,#{ARCPI}</if>
            )
    </insert>
    <update id="updateTmpQtHeader" parameterType="hdel.sd.sso.domain.ZSDT1100">
        UPDATE SAPHEE.ZSDT1100
        SET   <if test="AUART != null">AUART     =  #{AUART} </if>
              <if test="AUART == null or AUART == '' ">AUART =  '' </if>
              <if test="SPART != null">,SPART     =  #{SPART}</if>     
              <if test="VKBUR != null">,VKBUR     =  #{VKBUR}</if>     
              <if test="VKGRP != null">,VKGRP     =  #{VKGRP}</if>     
              <if test="KUNNR_RG != null">,KUNNR_RG  =  #{KUNNR_RG}</if>     
              <if test="KUNNR_RG2 != null">,KUNNR_RG2  =  #{KUNNR_RG2}</if>     
              <if test="KUNNR_WE != null">,KUNNR_WE  =  #{KUNNR_WE}</if>     
              <if test="KUNNR_Z1 != null">,KUNNR_Z1  =  #{KUNNR_Z1}</if>     
              <if test="KUNNR_Z2 != null">,KUNNR_Z2  =  #{KUNNR_Z2}</if>     
              <if test="KUNNR_Z3 != null">,KUNNR_Z3  =  #{KUNNR_Z3}</if>     
              <if test="BSTKD != null">,BSTKD  =  #{BSTKD}</if>     
              <if test="BSTDK != null">,BSTDK  =  #{BSTDK}</if>     
              <if test="VDATU != null">,VDATU  =  #{VDATU}</if>     
              <if test="ZTERM != null">,ZTERM  =  #{ZTERM}</if>     
              <if test="WAERK != null">,WAERK  =  #{WAERK}</if>     
              <if test="INCO1 != null">,INCO1  =  #{INCO1}</if>     
              <if test="INCO2 != null">,INCO2  =  #{INCO2}</if>     
              <if test="CONTR_DA != null">,CONTR_DA  =  #{CONTR_DA}</if>     
              <if test="WWBLD != null">,WWBLD  =  #{WWBLD}</if>     
              <if test="REPMO != null">,REPMO  =  #{REPMO}</if>     
              <if test="GUAMO != null">,GUAMO  =  #{GUAMO}</if>     
              <if test="FRMDA != null">,FRMDA  =  #{FRMDA}</if>     
              <if test="STADA != null">,STADA  =  #{STADA}</if>     
              <if test="RECAD_DA != null">,RECAD_DA  =  #{RECAD_DA}</if>     
              <if test="WORMO != null">,WORMO  =  #{WORMO}</if>     
              <if test="PSPID != null">,PSPID  =  #{PSPID}</if>     
              <if test="REGION != null">,REGION  =  #{REGION}</if>     
              <if test="HIGH_G != null">,HIGH_G  =  #{HIGH_G}</if>     
              <if test="ADMITNO != null">,ADMITNO  =  #{ADMITNO}</if>     
              <if test="CHEOR != null">,CHEOR  =  #{CHEOR}</if>     
              <if test="COMPL_DA != null">,COMPL_DA  =  #{COMPL_DA}</if>     
              <if test="FINAL_DA != null">,FINAL_DA  =  #{FINAL_DA}</if>     
              <if test="ENFOR != null">,ENFOR  =  #{ENFOR}</if>     
              <if test="TURNKEY != null">,TURNKEY  =  #{TURNKEY}</if>     
              <if test="KISCON != null">,KISCON  =  #{KISCON}</if>     
              <if test="HEL_REG != null">,HEL_REG  =  #{HEL_REG}</if>     
              <if test="LIFNR != null">,LIFNR  =  #{LIFNR}</if>     
              <if test="LIFNR2 != null">,LIFNR2  =  #{LIFNR2}</if>     
              <if test="LIFNR3 != null">,LIFNR3  =  #{LIFNR3}</if>     
              <if test="LIFNRCHK != null">,LIFNRCHK  =  #{LIFNRCHK}</if>     
              <if test="REG_NO != null">,REG_NO  =  #{REG_NO}</if>     
              <if test="REG_PE != null">,REG_PE  =  #{REG_PE}</if>     
              <if test="EMAIL != null">,EMAIL  =  #{EMAIL}</if>     
              <if test="SOCNO != null">,SOCNO  =  #{SOCNO}</if>     
              <if test="CORNO != null">,CORNO  =  #{CORNO}</if>     
              <if test="COMNO != null">,COMNO  =  #{COMNO}</if>     
              <if test="SEP_MON != null">,SEP_MON  =  #{SEP_MON}</if>     
              <if test="BILL_GBN != null">,BILL_GBN  =  #{BILL_GBN}</if>     
              <if test="HB_STN != null">,HB_STN  =  #{HB_STN}</if>     
              <if test="HB_FROM != null">,HB_FROM  =  #{HB_FROM}</if>     
              <if test="HB_TO != null">,HB_TO  =  #{HB_TO}</if>     
              <if test="HB_PUB != null">,HB_PUB  =  #{HB_PUB}</if>     
              <if test="MB_STN != null">,MB_STN  =  #{MB_STN}</if>     
              <if test="FKSAK != null">,FKSAK  =  #{FKSAK}</if>     
              <if test="KVGR1 != null">,KVGR1  =  #{KVGR1}</if> 
              <if test="SHCHK != null">,SHCHK  =  #{SHCHK}</if>
              <if test="LHCHK != null">,LHCHK  =  #{LHCHK}</if>
              <if test="KUNAPRV != null">,KUNAPRV  =  #{KUNAPRV}</if>
              <if test="ACHTP != null">,ACHTP  =  #{ACHTP}</if>
              <if test="ACHDT != null">,ACHDT  =  #{ACHDT}</if>
              <if test="ACHNO != null">,ACHNO  =  #{ACHNO}</if>
              <if test="SOPTP != null">,SOPTP  =  #{SOPTP}</if>
              <if test="SOPDT != null">,SOPDT  =  #{SOPDT}</if>
              <if test="AUPTP != null">,AUPTP  =  #{AUPTP}</if>
              <if test="VIPTP != null">,VIPTP  =  #{VIPTP}</if>
              <if test="ARCPI != null">,ARCPI  =  #{ARCPI}</if>
        WHERE 1 = 1
          AND MANDT =  #{MANDT}
          AND QTNUM =  #{QTNUM}
          AND QTSER =  #{QTSER}
    </update>
    <delete id="deleteTmpQtHeader" parameterType="hdel.sd.sso.domain.ZSDT1100">
        DELETE FROM SAPHEE.ZSDT1100
        WHERE 1 = 1
          AND MANDT =  #{MANDT}
          AND QTNUM =  #{QTNUM}
          AND QTSER =  #{QTSER}
    </delete>
    <select id="selectTmpQtItem" parameterType="hdel.sd.sso.domain.Sso0060ParamVO" resultType="hdel.sd.sso.domain.ZSDT1101">
        SELECT MANDT
              ,QTNUM
              ,QTSER
              ,QTSEQ
              ,POSNR
              ,MATNR
              ,ARKTX 
              ,KWMENG
              ,WERKS
              ,NETWR
              ,WAVWR
              ,EDATU
              ,REPMO
              ,GUAMO
              ,WORMO
              ,WAERK
              ,CONDA
              ,STADA
              ,ZRMDA
              ,WWBLD
              ,TRIM(BRNDCD) AS BRNDCD
              ,BRNDSEQ AS BRNDSEQ
        FROM   SAPHEE.ZSDT1101 
        WHERE 1 = 1
          AND MANDT =  #{MANDT}
          AND QTNUM =  #{QTNUM}
          AND QTSER =  #{QTSER}
        ORDER BY QTSEQ
        WITH UR
    </select>
    <insert id="insertTmpQtItem" parameterType="hdel.sd.sso.domain.ZSDT1101">
        INSERT INTO SAPHEE.ZSDT1101  
        (                            
         MANDT                       
        ,QTNUM                       
        ,QTSER                       
        ,QTSEQ                       
        ,POSNR                       
        <if test="MATNR != null">,MATNR</if>                       
        <if test="ARKTX != null">,ARKTX</if>                       
        <if test="KWMENG != null">,KWMENG</if>                        
        <if test="WERKS != null">,WERKS</if>                        
        <if test="NETWR != null">,NETWR</if>                       
        <if test="WAVWR != null">,WAVWR</if>                        
        <if test="EDATU != null">,EDATU</if>                        
        <if test="REPMO != null">,REPMO</if>                         
        <if test="GUAMO != null">,GUAMO</if>                        
        <if test="WORMO != null">,WORMO</if>                          
        <if test="WAERK != null">,WAERK</if>                            
        <if test="CONDA != null">,CONDA</if>                          
        <if test="STADA != null">,STADA</if>                          
        <if test="ZRMDA != null">,ZRMDA</if>                               
        <if test="WWBLD != null">,WWBLD</if>
        <if test="BRNDCD != null">,BRNDCD</if>                               
        <if test="BRNDSEQ != null">,BRNDSEQ</if>
        )                            
        VALUES                       
        (                            
         #{MANDT}                    
        ,#{QTNUM}                    
        ,#{QTSER}                    
        ,#{QTSEQ}                    
        ,#{POSNR}                    
        <if test="MATNR != null">,#{MATNR}</if>                       
        <if test="ARKTX != null">,#{ARKTX}</if>                       
        <if test="KWMENG != null">,#{KWMENG}</if>                        
        <if test="WERKS != null">,#{WERKS}</if>                        
        <if test="NETWR != null">,#{NETWR}</if>                       
        <if test="WAVWR != null">,#{WAVWR}</if>                        
        <if test="EDATU != null">,#{EDATU}</if>                        
        <if test="REPMO != null">,#{REPMO}</if>                         
        <if test="GUAMO != null">,#{GUAMO}</if>                        
        <if test="WORMO != null">,#{WORMO}</if>                          
        <if test="WAERK != null">,#{WAERK}</if>                            
        <if test="CONDA != null">,#{CONDA}</if>                          
        <if test="STADA != null">,#{STADA}</if>                          
        <if test="ZRMDA != null">,#{ZRMDA}</if>                               
        <if test="WWBLD != null">,#{WWBLD}</if>
        <if test="BRNDCD != null">,#{BRNDCD}</if>
        <if test="BRNDSEQ != null">,#{BRNDSEQ}</if>
        )                            
    </insert>
    <update id="updateTmpQtItem" parameterType="hdel.sd.sso.domain.ZSDT1101">
        UPDATE SAPHEE.ZSDT1101
        SET <if test="MATNR != null">  MATNR  = #{MATNR} </if>                       
            <if test="MATNR == null or MATNR == '' ">  MATNR  = ''</if>
            <if test="ARKTX != null"> ,ARKTX  = #{ARKTX} </if>                       
            <if test="KWMENG != null">,KWMENG = #{KWMENG}</if>                        
            <if test="WERKS != null"> ,WERKS  = #{WERKS} </if>                        
            <if test="NETWR != null"> ,NETWR  = #{NETWR} </if>                       
            <if test="WAVWR != null"> ,WAVWR  = #{WAVWR} </if>                        
            <if test="EDATU != null"> ,EDATU  = #{EDATU} </if>                        
            <if test="REPMO != null"> ,REPMO  = #{REPMO} </if>                         
            <if test="GUAMO != null"> ,GUAMO  = #{GUAMO} </if>                        
            <if test="WORMO != null"> ,WORMO  = #{WORMO} </if>                          
            <if test="WAERK != null"> ,WAERK  = #{WAERK} </if>                            
            <if test="CONDA != null"> ,CONDA  = #{CONDA} </if>                          
            <if test="STADA != null"> ,STADA  = #{STADA} </if>                          
            <if test="ZRMDA != null"> ,ZRMDA  = #{ZRMDA} </if>                               
            <if test="WWBLD != null"> ,WWBLD  = #{WWBLD} </if>
            <if test="BRNDCD != null"> ,BRNDCD  = #{BRNDCD} </if> 
            <if test="BRNDSEQ != null"> ,BRNDSEQ  = #{BRNDSEQ} </if>
        WHERE 1 = 1
          AND MANDT =  #{MANDT}
          AND QTNUM =  #{QTNUM}
          AND QTSER =  #{QTSER}
          AND QTSEQ =  #{QTSEQ}
          AND POSNR =  #{POSNR}
    </update>
    <delete id="deleteAllTmpQtItem" parameterType="hdel.sd.sso.domain.ZSDT1101">
        DELETE FROM SAPHEE.ZSDT1101
        WHERE 1 = 1
          AND MANDT =  #{MANDT}
          AND QTNUM =  #{QTNUM}
          AND QTSER =  #{QTSER}
    </delete>
    <delete id="deleteTmpQtItem" parameterType="hdel.sd.sso.domain.ZSDT1101">
        DELETE FROM SAPHEE.ZSDT1101
        WHERE 1 = 1
          AND MANDT =  #{MANDT}
          AND QTNUM =  #{QTNUM}
          AND QTSER =  #{QTSER}
          AND QTSEQ =  #{QTSEQ}
          AND POSNR =  #{POSNR}
    </delete>
    <select id="selectTmpQtBiliingPlan" parameterType="hdel.sd.sso.domain.Sso0060ParamVO" resultType="hdel.sd.sso.domain.ZSDT1102">
        SELECT MANDT
              ,QTNUM
              ,QTSER
              ,POSNR
              ,SEQ
              ,FKDAT
              ,MLBEZ
              ,ZTERM
              ,FAKWR
              ,FAKSP
              ,FKSAF
              ,WAERK
        FROM   SAPHEE.ZSDT1102
        WHERE 1 = 1
          AND MANDT =  #{MANDT}
          AND QTNUM =  #{QTNUM}
          AND QTSER =  #{QTSER}
        ORDER BY SEQ
        WITH UR                            
    </select>
    <select id="selectTmpQtBiliingMaxSeq" parameterType="hdel.sd.sso.domain.Sso0060ParamVO" resultType="int">
        SELECT VALUE(MAX(SEQ), 0) AS SEQ
        FROM   SAPHEE.ZSDT1102
        WHERE 1 = 1
          AND MANDT =  #{MANDT}
          AND QTNUM =  #{QTNUM}
          AND QTSER =  #{QTSER}
        WITH UR                            
    </select>
    <delete id="deleteTmpQtBiliing" parameterType="hdel.sd.sso.domain.Sso0060ParamVO">
        DELETE FROM SAPHEE.ZSDT1102
        WHERE 1 = 1
          AND MANDT =  #{MANDT}
          AND QTNUM =  #{QTNUM}
          AND QTSER =  #{QTSER}
    </delete>
    <insert id="insertTmpQtBiliingPlan" parameterType="hdel.sd.sso.domain.ZSDT1102">
        INSERT INTO SAPHEE.ZSDT1102
        (
         MANDT
        ,QTNUM
        ,QTSER
        ,POSNR
        ,SEQ
        <if test="FKDAT != null">,FKDAT</if>
        <if test="MLBEZ != null">,MLBEZ</if>
        <if test="ZTERM != null">,ZTERM</if>
        <if test="FAKWR != null">,FAKWR</if>
        <if test="FAKSP != null">,FAKSP</if>
        <if test="FKSAF != null">,FKSAF</if>
        <if test="WAERK != null">,WAERK</if>
        )
        VALUES
        (
         #{MANDT}
        ,#{QTNUM}
        ,#{QTSER}
        ,#{POSNR}
        ,#{SEQ}
        <if test="FKDAT != null">,#{FKDAT}</if>
        <if test="MLBEZ != null">,#{MLBEZ}</if>
        <if test="ZTERM != null">,#{ZTERM}</if>
        <if test="FAKWR != null">,#{FAKWR}</if>
        <if test="FAKSP != null">,#{FAKSP}</if>
        <if test="FKSAF != null">,#{FKSAF}</if>
        <if test="WAERK != null">,#{WAERK}</if>
        )
    </insert>
    <update id="updateTmpQtBiliingPlan" parameterType="hdel.sd.sso.domain.ZSDT1102">
        UPDATE SAPHEE.ZSDT1102
        SET FKDAT  = #{FKDAT}
            <if test="MLBEZ != null">,MLBEZ = #{MLBEZ}</if>
            <if test="MLBEZ == null">,MLBEZ = ''</if>
            <if test="ZTERM != null">,ZTERM = #{ZTERM}</if>
            <if test="ZTERM == null">,ZTERM = ''</if>
            <if test="FAKWR != null">,FAKWR = #{FAKWR}</if>
            <if test="FAKWR == null">,FAKWR = ''</if>
            <if test="FAKSP != null">,FAKSP = #{FAKSP}</if>
            <if test="FAKSP == null">,FAKSP = ''</if>
            <if test="FKSAF != null">,FKSAF = #{FKSAF}</if>
            <if test="FKSAF == null">,FKSAF = ''</if>
            <if test="WAERK != null">,WAERK = #{WAERK}</if>
            <if test="WAERK == null">,WAERK = ''</if>
        WHERE 1 = 1
          AND MANDT =  #{MANDT}
          AND QTNUM =  #{QTNUM}
          AND QTSER =  #{QTSER}
          AND POSNR =  #{POSNR}
          AND SEQ   =  #{SEQ}
    </update>
    <delete id="deleteTmpQtBiliingPlan" parameterType="hdel.sd.sso.domain.ZSDT1102">
        DELETE FROM SAPHEE.ZSDT1102
        WHERE 1 = 1
          AND MANDT =  #{MANDT}
          AND QTNUM =  #{QTNUM}
          AND QTSER =  #{QTSER}
          AND POSNR =  #{POSNR}
          AND SEQ   =  #{SEQ}
    </delete>
    <select id="selectTmpQtText" parameterType="hdel.sd.sso.domain.Sso0060ParamVO" resultType="hdel.sd.sso.domain.ZSDT1103">
        SELECT MANDT
              ,QTNUM
              ,QTSER
              ,SER  
              ,TEXT 
        FROM   SAPHEE.ZSDT1103
        WHERE 1 = 1
          AND MANDT =  #{MANDT}
          AND QTNUM =  #{QTNUM}
          AND QTSER =  #{QTSER}
        ORDER BY SER
        WITH UR                            
    </select>
    <select id="selectTmpQtTxtMaxSeq" parameterType="hdel.sd.sso.domain.Sso0060ParamVO" resultType="int">
        SELECT VALUE(MAX(SER), 0) AS SER
        FROM   SAPHEE.ZSDT1103
        WHERE 1 = 1
          AND MANDT =  #{MANDT}
          AND QTNUM =  #{QTNUM}
          AND QTSER =  #{QTSER}
        WITH UR                            
    </select>
    <delete id="deleteTmpQtMsTxtSer" parameterType="hdel.sd.sso.domain.Sso0060ParamVO">
        DELETE
        FROM   SAPHEE.ZSDT1103
        WHERE 1 = 1
          AND MANDT =  #{MANDT}
          AND QTNUM =  #{QTNUM}
          AND QTSER =  #{QTSER}
    </delete>
    <insert id="insertTmpQtText" parameterType="hdel.sd.sso.domain.ZSDT1103">
        INSERT INTO SAPHEE.ZSDT1103
        (
         MANDT
        ,QTNUM
        ,QTSER
        ,SER
        <if test="TEXT != null">,TEXT</if> 
        )
        VALUES
        (
         #{MANDT}
        ,#{QTNUM}
        ,#{QTSER}
        ,#{SER}
        <if test="TEXT != null">,#{TEXT}</if>
        )
    </insert>
    <update id="updateTmpQtText" parameterType="hdel.sd.sso.domain.ZSDT1103">
        UPDATE SAPHEE.ZSDT1103
        SET <if test="TEXT != null"> TEXT  = #{TEXT}</if>
            <if test="TEXT == null or TEXT == '' "> TEXT = ''</if>
        WHERE 1 = 1
          AND MANDT =  #{MANDT}
          AND QTNUM =  #{QTNUM}
          AND QTSER =  #{QTSER}
          AND SER   =  #{SER}
    </update>
    <delete id="deleteTmpQtText" parameterType="hdel.sd.sso.domain.ZSDT1103">
        DELETE FROM SAPHEE.ZSDT1103
        WHERE 1 = 1
          AND MANDT =  #{MANDT}
          AND QTNUM =  #{QTNUM}
          AND QTSER =  #{QTSER}
          AND SER   =  #{SER}
    </delete>
	<select id="getVbeln" parameterType = "hdel.sd.sso.domain.Sso0060" resultMap="getVbeln">
		SELECT VBELN
		FROM   SAPHEE.ZSDT1046
		WHERE  MANDT    = #{MANDT}
		AND    QTNUM    = #{QTNUM}
		AND    QTSER    = #{QTSER}
	</select>
	<select id="selectSopind" parameterType="hdel.sd.sso.domain.Sso0060" resultMap="selectSopindResultMap">
		SELECT AUART
			  ,SOPIND
		FROM   SAPHEE.ZSDT0215
		WHERE  MANDT = #{MANDT}
		AND	   AUART = #{AUART}
	</select>
</mapper>