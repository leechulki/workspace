<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="hdel.ps.dao.PS1701002Dao">
<!--    <cache/>-->

    <select id="selectGroupByTemno" parameterType="hdel.ps.domain.PS17ParamVO" resultType="HashMap" useCache="false">
        SELECT T1.PSPID,
               T1.TEMNO,
               T1.NAMET,
               T1.BINWON,
               T1.PRO_R,
               T1.ZSITE_NM,
               T1.POSID,
               T1.ZZSHIP1,
               T1.ZZCOMP2,
               T0.CATEGORY,
               T0.LOD,
               T0.L0,
               T0.L1,
               T0.L2,
               T0.L3,
               T0.L4,
               T0.N0,
               T0.N1,
               T0.N2,
               T0.N3,
               T0.N4,
               T0.N5,
               T0.N6,
               T0.N7,
               T0.N8,
               T0.N9,
               T0.N10,
               T0.N11,
               T0.N12,
               T0.N13,
               T0.N14,
               T0.N15,
               T0.N16,
               T0.N17,
               T0.N18,
               T0.N19,
               T0.N20,
               T0.N21,
               T0.N22,
               T0.N23,
               T0.N24,
               T0.N25,
               T0.N26,
               T0.N27,
               T0.N28,
               T0.N29,
               T0.N30,
               T0.N31,
               T0.N32,
               T0.N33,
               T0.N34,
               T0.N35,
               T0.N36,
               T0.N37,
               T0.N38,
               T0.N39,
               T0.N40,
               T0.N41,
               T0.N42,
               T0.N43,
               T0.N44,
               T0.N45,
               T0.N46,
               T0.N47,
               T0.N48,
               T0.N49,
               T0.N50,
               T0.N51,
               T0.N52,
               T0.N53,
               T0.N54,
               T0.N55,
               T0.N56,
               T0.N57,
               T0.N58,
               T0.N59,
               T0.N60,
               T0.N61,
               T0.N62,
               T0.N63,
               T0.N64,
               T0.N65,
               T0.N66,
               T0.N67,
               T0.N68,
               T0.N69,
               T0.N70,
               T0.N71,
               T0.N72,
               T0.N73,
               T0.N74,
               T0.N75,
               T0.N76,
               T0.N77,
               T0.N78,
               T0.N79,
               T0.N80,
               T0.N81,
               T0.N82,
               T0.N83,
               T0.N84,
               T0.N85,
               T0.N86,
               T0.N87,
               T0.N88,
               T0.N89,
               T0.N90,
               T0.N91,
               T0.N92,
               T0.N93,
               T0.N94,
               T0.N95,
               T0.N96,
               T0.N97,
               T0.N98,
               T0.N99,
               T0.N100,
               T0.N101,
               T0.N102,
               T0.N103,
               T0.N104,
               T0.N105,
               T0.N106,
               T0.N107,
               T0.N108,
               T0.N109,
               T0.N110,
               T0.N111,
               T0.N112,
               T0.N113,
               T0.N114,
               T0.N115,
               T0.N116,
               T0.N117,
               T0.N118,
               T0.N119,
               T0.N120,
               T0.N121,
               T0.N122,
               T0.N123,
               T0.N124,
               T0.N125,
               T0.N126,
               T0.N127,
               T0.N128,
               T0.N129,
               T0.N130,
               T0.N131,
               T0.N132,
               T0.N133,
               T0.N134,
               T0.N135,
               T0.N136,
               T0.N137,
               T0.N138,
               T0.N139,
               T0.N140,
               T0.N141,
               T0.N142,
               T0.N143,
               T0.N144,
               T0.N145,
               T0.N146,
               T0.N147,
               T0.N148,
               T0.N149,
               T0.N150,
               T0.N151,
               T0.N152,
               T0.N153,
               REPLACE(T0.BIGO, ' / ', '&#10;') BIGO
        FROM SAPHEE.${tableName} T1
        LEFT OUTER JOIN (SELECT MANDT,
                               PSPID,
                               POSID,
                               CASE WHEN CATEGORY = 'MH' THEN 1
                                    WHEN CATEGORY = 'Capacity' THEN 2
                                    ELSE 3 END ODR,
                               CATEGORY,
                               LOD,
                               L0,
                               L1,
                               L2,
                               L3,
                               L4,
                               N0,
                               N1,
                               N2,
                               N3,
                               N4,
                               N5,
                               N6,
                               N7,
                               N8,
                               N9,
                               N10,
                               N11,
                               N12,
                               N13,
                               N14,
                               N15,
                               N16,
                               N17,
                               N18,
                               N19,
                               N20,
                               N21,
                               N22,
                               N23,
                               N24,
                               N25,
                               N26,
                               N27,
                               N28,
                               N29,
                               N30,
                               N31,
                               N32,
                               N33,
                               N34,
                               N35,
                               N36,
                               N37,
                               N38,
                               N39,
                               N40,
                               N41,
                               N42,
                               N43,
                               N44,
                               N45,
                               N46,
                               N47,
                               N48,
                               N49,
                               N50,
                               N51,
                               N52,
                               N53,
                               N54,
                               N55,
                               N56,
                               N57,
                               N58,
                               N59,
                               N60,
                               N61,
                               N62,
                               N63,
                               N64,
                               N65,
                               N66,
                               N67,
                               N68,
                               N69,
                               N70,
                               N71,
                               N72,
                               N73,
                               N74,
                               N75,
                               N76,
                               N77,
                               N78,
                               N79,
                               N80,
                               N81,
                               N82,
                               N83,
                               N84,
                               N85,
                               N86,
                               N87,
                               N88,
                               N89,
                               N90,
                               N91,
                               N92,
                               N93,
                               N94,
                               N95,
                               N96,
                               N97,
                               N98,
                               N99,
                               N100,
                               N101,
                               N102,
                               N103,
                               N104,
                               N105,
                               N106,
                               N107,
                               N108,
                               N109,
                               N110,
                               N111,
                               N112,
                               N113,
                               N114,
                               N115,
                               N116,
                               N117,
                               N118,
                               N119,
                               N120,
                               N121,
                               N122,
                               N123,
                               N124,
                               N125,
                               N126,
                               N127,
                               N128,
                               N129,
                               N130,
                               N131,
                               N132,
                               N133,
                               N134,
                               N135,
                               N136,
                               N137,
                               N138,
                               N139,
                               N140,
                               N141,
                               N142,
                               N143,
                               N144,
                               N145,
                               N146,
                               N147,
                               N148,
                               N149,
                               N150,
                               N151,
                               N152,
                               N153,
                               BIGO
                        FROM SAPHEE.${tableName2}
                        UNION ALL
                        SELECT S0.MANDT,
                               S0.PSPID,
                               S0.POSID,
                               3 ODR,
                               'Load'                                               CATEGORY,
                               CASE WHEN S1.LOD = 0 THEN 0 ELSE S0.LOD * 100 / S1.LOD END    LOD,
                               CASE WHEN S1.L0 = 0 THEN 0 ELSE S0.L0 * 100 / S1.L0 END    L0,
                               CASE WHEN S1.L1 = 0 THEN 0 ELSE S0.L1 * 100 / S1.L1 END    L1,
                               CASE WHEN S1.L2 = 0 THEN 0 ELSE S0.L2 * 100 / S1.L2 END    L2,
                               CASE WHEN S1.L3 = 0 THEN 0 ELSE S0.L3 * 100 / S1.L3 END    L3,
                               CASE WHEN S1.L4 = 0 THEN 0 ELSE S0.L4 * 100 / S1.L4 END    L4,
                               CASE WHEN S1.N0 = 0 THEN 0 ELSE S0.N0 * 100 / S1.N0 END    N0,
                               CASE WHEN S1.N1 = 0 THEN 0 ELSE S0.N1 * 100 / S1.N1 END    N1,
                               CASE WHEN S1.N2 = 0 THEN 0 ELSE S0.N2 * 100 / S1.N2 END    N2,
                               CASE WHEN S1.N3 = 0 THEN 0 ELSE S0.N3 * 100 / S1.N3 END    N3,
                               CASE WHEN S1.N4 = 0 THEN 0 ELSE S0.N4 * 100 / S1.N4 END    N4,
                               CASE WHEN S1.N5 = 0 THEN 0 ELSE S0.N5 * 100 / S1.N5 END    N5,
                               CASE WHEN S1.N6 = 0 THEN 0 ELSE S0.N6 * 100 / S1.N6 END    N6,
                               CASE WHEN S1.N7 = 0 THEN 0 ELSE S0.N7 * 100 / S1.N7 END    N7,
                               CASE WHEN S1.N8 = 0 THEN 0 ELSE S0.N8 * 100 / S1.N8 END    N8,
                               CASE WHEN S1.N9 = 0 THEN 0 ELSE S0.N9 * 100 / S1.N9 END    N9,
                               CASE WHEN S1.N10 = 0 THEN 0 ELSE S0.N10 * 100 / S1.N10 END N10,
                               CASE WHEN S1.N11 = 0 THEN 0 ELSE S0.N11 * 100 / S1.N11 END N11,
                               CASE WHEN S1.N12 = 0 THEN 0 ELSE S0.N12 * 100 / S1.N12 END N12,
                               CASE WHEN S1.N13 = 0 THEN 0 ELSE S0.N13 * 100 / S1.N13 END N13,
                               CASE WHEN S1.N14 = 0 THEN 0 ELSE S0.N14 * 100 / S1.N14 END N14,
                               CASE WHEN S1.N15 = 0 THEN 0 ELSE S0.N15 * 100 / S1.N15 END N15,
                               CASE WHEN S1.N16 = 0 THEN 0 ELSE S0.N16 * 100 / S1.N16 END N16,
                               CASE WHEN S1.N17 = 0 THEN 0 ELSE S0.N17 * 100 / S1.N17 END N17,
                               CASE WHEN S1.N18 = 0 THEN 0 ELSE S0.N18 * 100 / S1.N18 END N18,
                               CASE WHEN S1.N19 = 0 THEN 0 ELSE S0.N19 * 100 / S1.N19 END N19,
                               CASE WHEN S1.N20 = 0 THEN 0 ELSE S0.N20 * 100 / S1.N20 END N20,
                               CASE WHEN S1.N21 = 0 THEN 0 ELSE S0.N21 * 100 / S1.N21 END N21,
                               CASE WHEN S1.N22 = 0 THEN 0 ELSE S0.N22 * 100 / S1.N22 END N22,
                               CASE WHEN S1.N23 = 0 THEN 0 ELSE S0.N23 * 100 / S1.N23 END N23,
                               CASE WHEN S1.N24 = 0 THEN 0 ELSE S0.N24 * 100 / S1.N24 END N24,
                               CASE WHEN S1.N25 = 0 THEN 0 ELSE S0.N25 * 100 / S1.N25 END N25,
                               CASE WHEN S1.N26 = 0 THEN 0 ELSE S0.N26 * 100 / S1.N26 END N26,
                               CASE WHEN S1.N27 = 0 THEN 0 ELSE S0.N27 * 100 / S1.N27 END N27,
                               CASE WHEN S1.N28 = 0 THEN 0 ELSE S0.N28 * 100 / S1.N28 END N28,
                               CASE WHEN S1.N29 = 0 THEN 0 ELSE S0.N29 * 100 / S1.N29 END N29,
                               CASE WHEN S1.N30 = 0 THEN 0 ELSE S0.N30 * 100 / S1.N30 END N30,
                               CASE WHEN S1.N31 = 0 THEN 0 ELSE S0.N31 * 100 / S1.N31 END N31,
                               CASE WHEN S1.N32 = 0 THEN 0 ELSE S0.N32 * 100 / S1.N32 END N32,
                               CASE WHEN S1.N33 = 0 THEN 0 ELSE S0.N33 * 100 / S1.N33 END N33,
                               CASE WHEN S1.N34 = 0 THEN 0 ELSE S0.N34 * 100 / S1.N34 END N34,
                               CASE WHEN S1.N35 = 0 THEN 0 ELSE S0.N35 * 100 / S1.N35 END N35,
                               CASE WHEN S1.N36 = 0 THEN 0 ELSE S0.N36 * 100 / S1.N36 END N36,
                               CASE WHEN S1.N37 = 0 THEN 0 ELSE S0.N37 * 100 / S1.N37 END N37,
                               CASE WHEN S1.N38 = 0 THEN 0 ELSE S0.N38 * 100 / S1.N38 END N38,
                               CASE WHEN S1.N39 = 0 THEN 0 ELSE S0.N39 * 100 / S1.N39 END N39,
                               CASE WHEN S1.N40 = 0 THEN 0 ELSE S0.N40 * 100 / S1.N40 END N40,
                               CASE WHEN S1.N41 = 0 THEN 0 ELSE S0.N41 * 100 / S1.N41 END N41,
                               CASE WHEN S1.N42 = 0 THEN 0 ELSE S0.N42 * 100 / S1.N42 END N42,
                               CASE WHEN S1.N43 = 0 THEN 0 ELSE S0.N43 * 100 / S1.N43 END N43,
                               CASE WHEN S1.N44 = 0 THEN 0 ELSE S0.N44 * 100 / S1.N44 END N44,
                               CASE WHEN S1.N45 = 0 THEN 0 ELSE S0.N45 * 100 / S1.N45 END N45,
                               CASE WHEN S1.N46 = 0 THEN 0 ELSE S0.N46 * 100 / S1.N46 END N46,
                               CASE WHEN S1.N47 = 0 THEN 0 ELSE S0.N47 * 100 / S1.N47 END N47,
                               CASE WHEN S1.N48 = 0 THEN 0 ELSE S0.N48 * 100 / S1.N48 END N48,
                               CASE WHEN S1.N49 = 0 THEN 0 ELSE S0.N49 * 100 / S1.N49 END N49,
                               CASE WHEN S1.N50 = 0 THEN 0 ELSE S0.N50 * 100 / S1.N50 END N50,
                               CASE WHEN S1.N51 = 0 THEN 0 ELSE S0.N51 * 100 / S1.N51 END N51,
                               CASE WHEN S1.N52 = 0 THEN 0 ELSE S0.N52 * 100 / S1.N52 END N52,
                               CASE WHEN S1.N53 = 0 THEN 0 ELSE S0.N53 * 100 / S1.N53 END N53,
                               CASE WHEN S1.N54 = 0 THEN 0 ELSE S0.N54 * 100 / S1.N54 END N54,
                               CASE WHEN S1.N55 = 0 THEN 0 ELSE S0.N55 * 100 / S1.N55 END N55,
                               CASE WHEN S1.N56 = 0 THEN 0 ELSE S0.N56 * 100 / S1.N56 END N56,
                               CASE WHEN S1.N57 = 0 THEN 0 ELSE S0.N57 * 100 / S1.N57 END N57,
                               CASE WHEN S1.N58 = 0 THEN 0 ELSE S0.N58 * 100 / S1.N58 END N58,
                               CASE WHEN S1.N59 = 0 THEN 0 ELSE S0.N59 * 100 / S1.N59 END N59,
                               CASE WHEN S1.N60 = 0 THEN 0 ELSE S0.N60 * 100 / S1.N60 END N60,
                               CASE WHEN S1.N61 = 0 THEN 0 ELSE S0.N61 * 100 / S1.N61 END N61,
                               CASE WHEN S1.N62 = 0 THEN 0 ELSE S0.N62 * 100 / S1.N62 END N62,
                               CASE WHEN S1.N63 = 0 THEN 0 ELSE S0.N63 * 100 / S1.N63 END N63,
                               CASE WHEN S1.N64 = 0 THEN 0 ELSE S0.N64 * 100 / S1.N64 END N64,
                               CASE WHEN S1.N65 = 0 THEN 0 ELSE S0.N65 * 100 / S1.N65 END N65,
                               CASE WHEN S1.N66 = 0 THEN 0 ELSE S0.N66 * 100 / S1.N66 END N66,
                               CASE WHEN S1.N67 = 0 THEN 0 ELSE S0.N67 * 100 / S1.N67 END N67,
                               CASE WHEN S1.N68 = 0 THEN 0 ELSE S0.N68 * 100 / S1.N68 END N68,
                               CASE WHEN S1.N69 = 0 THEN 0 ELSE S0.N69 * 100 / S1.N69 END N69,
                               CASE WHEN S1.N70 = 0 THEN 0 ELSE S0.N70 * 100 / S1.N70 END N70,
                               CASE WHEN S1.N71 = 0 THEN 0 ELSE S0.N71 * 100 / S1.N71 END N71,
                               CASE WHEN S1.N72 = 0 THEN 0 ELSE S0.N72 * 100 / S1.N72 END N72,
                               CASE WHEN S1.N73 = 0 THEN 0 ELSE S0.N73 * 100 / S1.N73 END N73,
                               CASE WHEN S1.N74 = 0 THEN 0 ELSE S0.N74 * 100 / S1.N74 END N74,
                               CASE WHEN S1.N75 = 0 THEN 0 ELSE S0.N75 * 100 / S1.N75 END N75,
                               CASE WHEN S1.N76 = 0 THEN 0 ELSE S0.N76 * 100 / S1.N76 END N76,
                               CASE WHEN S1.N77 = 0 THEN 0 ELSE S0.N77 * 100 / S1.N77 END N77,
                               CASE WHEN S1.N78 = 0 THEN 0 ELSE S0.N78 * 100 / S1.N78 END N78,
                               CASE WHEN S1.N79 = 0 THEN 0 ELSE S0.N79 * 100 / S1.N79 END N79,
                               CASE WHEN S1.N80 = 0 THEN 0 ELSE S0.N80 * 100 / S1.N80 END N80,
                               CASE WHEN S1.N81 = 0 THEN 0 ELSE S0.N81 * 100 / S1.N81 END N81,
                               CASE WHEN S1.N82 = 0 THEN 0 ELSE S0.N82 * 100 / S1.N82 END N82,
                               CASE WHEN S1.N83 = 0 THEN 0 ELSE S0.N83 * 100 / S1.N83 END N83,
                               CASE WHEN S1.N84 = 0 THEN 0 ELSE S0.N84 * 100 / S1.N84 END N84,
                               CASE WHEN S1.N85 = 0 THEN 0 ELSE S0.N85 * 100 / S1.N85 END N85,
                               CASE WHEN S1.N86 = 0 THEN 0 ELSE S0.N86 * 100 / S1.N86 END N86,
                               CASE WHEN S1.N87 = 0 THEN 0 ELSE S0.N87 * 100 / S1.N87 END N87,
                               CASE WHEN S1.N88 = 0 THEN 0 ELSE S0.N88 * 100 / S1.N88 END N88,
                               CASE WHEN S1.N89 = 0 THEN 0 ELSE S0.N89 * 100 / S1.N89 END N89,
                               CASE WHEN S1.N90 = 0 THEN 0 ELSE S0.N90 * 100 / S1.N90 END N90,
                               CASE WHEN S1.N91 = 0 THEN 0 ELSE S0.N91 * 100 / S1.N91 END N91,
                               CASE WHEN S1.N92 = 0 THEN 0 ELSE S0.N92 * 100 / S1.N92 END N92,
                               CASE WHEN S1.N93 = 0 THEN 0 ELSE S0.N93 * 100 / S1.N93 END N93,
                               CASE WHEN S1.N94 = 0 THEN 0 ELSE S0.N94 * 100 / S1.N94 END N94,
                               CASE WHEN S1.N95 = 0 THEN 0 ELSE S0.N95 * 100 / S1.N95 END N95,
                               CASE WHEN S1.N96 = 0 THEN 0 ELSE S0.N96 * 100 / S1.N96 END N96,
                               CASE WHEN S1.N97 = 0 THEN 0 ELSE S0.N97 * 100 / S1.N97 END N97,
                               CASE WHEN S1.N98 = 0 THEN 0 ELSE S0.N98 * 100 / S1.N98 END N98,
                               CASE WHEN S1.N99 = 0 THEN 0 ELSE S0.N99 * 100 / S1.N99 END N99,
                               CASE WHEN S1.N100 = 0 THEN 0 ELSE S0.N100 * 100 / S1.N100 END N100,
                               CASE WHEN S1.N101 = 0 THEN 0 ELSE S0.N101 * 100 / S1.N101 END N101,
                               CASE WHEN S1.N102 = 0 THEN 0 ELSE S0.N102 * 100 / S1.N102 END N102,
                               CASE WHEN S1.N103 = 0 THEN 0 ELSE S0.N103 * 100 / S1.N103 END N103,
                               CASE WHEN S1.N104 = 0 THEN 0 ELSE S0.N104 * 100 / S1.N104 END N104,
                               CASE WHEN S1.N105 = 0 THEN 0 ELSE S0.N105 * 100 / S1.N105 END N105,
                               CASE WHEN S1.N106 = 0 THEN 0 ELSE S0.N106 * 100 / S1.N106 END N106,
                               CASE WHEN S1.N107 = 0 THEN 0 ELSE S0.N107 * 100 / S1.N107 END N107,
                               CASE WHEN S1.N108 = 0 THEN 0 ELSE S0.N108 * 100 / S1.N108 END N108,
                               CASE WHEN S1.N109 = 0 THEN 0 ELSE S0.N109 * 100 / S1.N109 END N109,
                               CASE WHEN S1.N110 = 0 THEN 0 ELSE S0.N110 * 100 / S1.N110 END N110,
                               CASE WHEN S1.N111 = 0 THEN 0 ELSE S0.N111 * 100 / S1.N111 END N111,
                               CASE WHEN S1.N112 = 0 THEN 0 ELSE S0.N112 * 100 / S1.N112 END N112,
                               CASE WHEN S1.N113 = 0 THEN 0 ELSE S0.N113 * 100 / S1.N113 END N113,
                               CASE WHEN S1.N114 = 0 THEN 0 ELSE S0.N114 * 100 / S1.N114 END N114,
                               CASE WHEN S1.N115 = 0 THEN 0 ELSE S0.N115 * 100 / S1.N115 END N115,
                               CASE WHEN S1.N116 = 0 THEN 0 ELSE S0.N116 * 100 / S1.N116 END N116,
                               CASE WHEN S1.N117 = 0 THEN 0 ELSE S0.N117 * 100 / S1.N117 END N117,
                               CASE WHEN S1.N118 = 0 THEN 0 ELSE S0.N118 * 100 / S1.N118 END N118,
                               CASE WHEN S1.N119 = 0 THEN 0 ELSE S0.N119 * 100 / S1.N119 END N119,
                               CASE WHEN S1.N120 = 0 THEN 0 ELSE S0.N120 * 100 / S1.N120 END N120,
                               CASE WHEN S1.N121 = 0 THEN 0 ELSE S0.N121 * 100 / S1.N121 END N121,
                               CASE WHEN S1.N122 = 0 THEN 0 ELSE S0.N122 * 100 / S1.N122 END N122,
                               CASE WHEN S1.N123 = 0 THEN 0 ELSE S0.N123 * 100 / S1.N123 END N123,
                               CASE WHEN S1.N124 = 0 THEN 0 ELSE S0.N124 * 100 / S1.N124 END N124,
                               CASE WHEN S1.N125 = 0 THEN 0 ELSE S0.N125 * 100 / S1.N125 END N125,
                               CASE WHEN S1.N126 = 0 THEN 0 ELSE S0.N126 * 100 / S1.N126 END N126,
                               CASE WHEN S1.N127 = 0 THEN 0 ELSE S0.N127 * 100 / S1.N127 END N127,
                               CASE WHEN S1.N128 = 0 THEN 0 ELSE S0.N128 * 100 / S1.N128 END N128,
                               CASE WHEN S1.N129 = 0 THEN 0 ELSE S0.N129 * 100 / S1.N129 END N129,
                               CASE WHEN S1.N130 = 0 THEN 0 ELSE S0.N130 * 100 / S1.N130 END N130,
                               CASE WHEN S1.N131 = 0 THEN 0 ELSE S0.N131 * 100 / S1.N131 END N131,
                               CASE WHEN S1.N132 = 0 THEN 0 ELSE S0.N132 * 100 / S1.N132 END N132,
                               CASE WHEN S1.N133 = 0 THEN 0 ELSE S0.N133 * 100 / S1.N133 END N133,
                               CASE WHEN S1.N134 = 0 THEN 0 ELSE S0.N134 * 100 / S1.N134 END N134,
                               CASE WHEN S1.N135 = 0 THEN 0 ELSE S0.N135 * 100 / S1.N135 END N135,
                               CASE WHEN S1.N136 = 0 THEN 0 ELSE S0.N136 * 100 / S1.N136 END N136,
                               CASE WHEN S1.N137 = 0 THEN 0 ELSE S0.N137 * 100 / S1.N137 END N137,
                               CASE WHEN S1.N138 = 0 THEN 0 ELSE S0.N138 * 100 / S1.N138 END N138,
                               CASE WHEN S1.N139 = 0 THEN 0 ELSE S0.N139 * 100 / S1.N139 END N139,
                               CASE WHEN S1.N140 = 0 THEN 0 ELSE S0.N140 * 100 / S1.N140 END N140,
                               CASE WHEN S1.N141 = 0 THEN 0 ELSE S0.N141 * 100 / S1.N141 END N141,
                               CASE WHEN S1.N142 = 0 THEN 0 ELSE S0.N142 * 100 / S1.N142 END N142,
                               CASE WHEN S1.N143 = 0 THEN 0 ELSE S0.N143 * 100 / S1.N143 END N143,
                               CASE WHEN S1.N144 = 0 THEN 0 ELSE S0.N144 * 100 / S1.N144 END N144,
                               CASE WHEN S1.N145 = 0 THEN 0 ELSE S0.N145 * 100 / S1.N145 END N145,
                               CASE WHEN S1.N146 = 0 THEN 0 ELSE S0.N146 * 100 / S1.N146 END N146,
                               CASE WHEN S1.N147 = 0 THEN 0 ELSE S0.N147 * 100 / S1.N147 END N147,
                               CASE WHEN S1.N148 = 0 THEN 0 ELSE S0.N148 * 100 / S1.N148 END N148,
                               CASE WHEN S1.N149 = 0 THEN 0 ELSE S0.N149 * 100 / S1.N149 END N149,
                               CASE WHEN S1.N150 = 0 THEN 0 ELSE S0.N150 * 100 / S1.N150 END N140,
                               CASE WHEN S1.N151 = 0 THEN 0 ELSE S0.N151 * 100 / S1.N151 END N141,
                               CASE WHEN S1.N152 = 0 THEN 0 ELSE S0.N152 * 100 / S1.N152 END N142,
                               CASE WHEN S1.N153 = 0 THEN 0 ELSE S0.N153 * 100 / S1.N153 END N143,
                               '' BIGO
                        FROM (SELECT *
                              FROM SAPHEE.${tableName2}
                              WHERE MANDT = '183'
                                AND CATEGORY = 'MH') S0
                                 INNER JOIN (SELECT *
                                             FROM SAPHEE.${tableName2}
                                             WHERE MANDT = '183'
                                               AND CATEGORY = 'Capacity') S1 ON (S0.MANDT = S1.MANDT AND S0.PSPID = S1.PSPID AND S0.POSID = S1.POSID)) T0 ON (T1.MANDT = T0.MANDT AND T1.PSPID = T0.PSPID AND T1.POSID = T0.POSID)
        WHERE T1.MANDT = #{mandt}
        <if test="zzactss != '' and zzactss != null and chk != 1">
        AND T1.ACTSS = #{zzactss}
        </if>
        <if test="zzlifnr != '' and zzlifnr != null and chk != 1">
        AND T1.LIFNR = #{zzlifnr}
        </if>
        <if test="zzpmnum != '' and zzpmnum != null">
        AND T1.TEMNO = #{zzpmnum}
        AND T1.ZZSHIP1 &lt;= #{lastDateOfMonth} AND T1.ZZCOMP2 &gt;= #{fstDateOfMdate}
        ORDER BY T1.MANDT, T1.PSPID, T1.POSID, T1.TEMNO, T0.ODR
        </if>
    </select>

    <select id="selectGroupByActss" parameterType="hdel.ps.domain.PS17ParamVO" resultType="HashMap" useCache="false">
        SELECT
            1 AS HSTATUS,
            GRUP,
            ACTSS,
            MAX(ACTSS_NM) ACTSS_NM,
            LIFNR,
            MAX(LIFNR_NM) AS LIFNR_NM,
            CASE WHEN SUM(CP0) = 0 THEN 0 ELSE SUM(MH0) * 100 / SUM(CP0) END "LOAD",
            COUNT(CASE WHEN ZZSHIP1 BETWEEN #{fstDateOfMdate} AND #{lastDateOfMonth} THEN 1 ELSE NULL END) E1,
            COUNT(CASE WHEN ZZSHIP1 &gt; #{mdate} AND ZZSHIP1 &lt;= #{lastDateOfMonth} THEN 1 ELSE NULL END) P1,
            SUM(CASE WHEN ZZSHIP1 &lt;= #{lastDateOfMonth} AND ZZCOMP2 &gt;= #{fstDateOfMdate}
                     THEN MH1
                     ELSE 0
                     END) MH1,
            SUM(CASE WHEN LIFNR = ''
		             THEN 0
		             WHEN ACTSS <![CDATA[<>]]> '01' AND (LIFNR = '8001' OR LIFNR = '0000008001')
		             THEN 0
		             WHEN ZZSHIP1 &lt;= #{lastDateOfMonth} AND ZZCOMP2 &gt;= #{fstDateOfMdate}
		             THEN CP1
		             ELSE 0
		             END) CP1,
            CASE WHEN SUM(CASE WHEN LIFNR = ''
					             THEN 0
					             WHEN ACTSS <![CDATA[<>]]> '01' AND (LIFNR = '8001' OR LIFNR = '0000008001')
		             			 THEN 0
					             WHEN ZZSHIP1 &lt;= #{lastDateOfMonth} AND ZZCOMP2 &gt;= #{fstDateOfMdate}
					             THEN CP1
					             ELSE 0
					             END) = 0 THEN 0 ELSE SUM(CASE WHEN ZZSHIP1 &lt;= #{lastDateOfMonth} AND ZZCOMP2 &gt;= #{fstDateOfMdate}
									                     THEN MH1
									                     ELSE 0
									                     END) * 100 / SUM(CASE WHEN LIFNR = ''
																	             THEN 0
																	             WHEN ACTSS <![CDATA[<>]]> '01' AND (LIFNR = '8001' OR LIFNR = '0000008001')
		             															 THEN 0
																	             WHEN ZZSHIP1 &lt;= #{lastDateOfMonth} AND ZZCOMP2 &gt;= #{fstDateOfMdate}
																	             THEN CP1
																	             ELSE 0
																	             END) END L1,
            COUNT(CASE WHEN ZZSHIP1 BETWEEN #{fstDateOf1thNextMonth} AND #{lastDateOf1thNextMonth} THEN 1 ELSE NULL END) E2,
            SUM(CASE WHEN ZZSHIP1 &lt;= #{lastDateOf1thNextMonth} AND ZZCOMP2 &gt;= #{fstDateOf1thNextMonth}
                     THEN MH2
                     ELSE 0
                     END) MH2,
            SUM(CASE WHEN LIFNR = '' OR (ACTSS <![CDATA[<>]]> '01' AND (LIFNR = '8001' OR LIFNR = '0000008001'))
             THEN 0
             WHEN ZZSHIP1 &lt;= #{lastDateOf1thNextMonth} AND ZZCOMP2 &gt;= #{fstDateOf1thNextMonth}
             THEN CP2
             ELSE 0
             END) CP2,
            CASE WHEN SUM(CASE WHEN LIFNR = ''
					             THEN 0
					             WHEN ACTSS <![CDATA[<>]]> '01' AND (LIFNR = '8001' OR LIFNR = '0000008001')
		             			 THEN 0
					             WHEN ZZSHIP1 &lt;= #{lastDateOf1thNextMonth} AND ZZCOMP2 &gt;= #{fstDateOf1thNextMonth}
					             THEN CP2
					             ELSE 0
					             END) = 0 THEN 0 ELSE SUM(CASE WHEN ZZSHIP1 &lt;= #{lastDateOf1thNextMonth} AND ZZCOMP2 &gt;= #{fstDateOf1thNextMonth}
										                     THEN MH2
										                     ELSE 0
										                     END) * 100 / SUM(CASE WHEN LIFNR = ''
																	             THEN 0
																	             WHEN ACTSS <![CDATA[<>]]> '01' AND (LIFNR = '8001' OR LIFNR = '0000008001')
		             			 												 THEN 0
																	             WHEN ZZSHIP1 &lt;= #{lastDateOf1thNextMonth} AND ZZCOMP2 &gt;= #{fstDateOf1thNextMonth}
																	             THEN CP2
																	             ELSE 0
																	             END) END L2,
            COUNT(CASE WHEN ZZSHIP1 BETWEEN #{fstDateOf2thNextMonth} AND #{lastDateOf2thNextMonth} THEN 1 ELSE NULL END) E3,
            SUM(CASE WHEN ZZSHIP1 &lt;= #{lastDateOf2thNextMonth} AND ZZCOMP2 &gt;= #{fstDateOf2thNextMonth}
                     THEN MH3
                     ELSE 0
                     END) MH3,
            SUM(CASE WHEN LIFNR = ''
             THEN 0
             WHEN ACTSS <![CDATA[<>]]> '01' AND (LIFNR = '8001' OR LIFNR = '0000008001')
		     THEN 0
		     WHEN ZZSHIP1 &lt;= #{lastDateOf2thNextMonth} AND ZZCOMP2 &gt;= #{fstDateOf2thNextMonth}
		     THEN CP3
             ELSE 0
             END) CP3,
            CASE WHEN SUM(CASE WHEN LIFNR = ''
				             THEN 0
				             WHEN ACTSS <![CDATA[<>]]> '01' AND (LIFNR = '8001' OR LIFNR = '0000008001')
		             	     THEN 0
				             WHEN ZZSHIP1 &lt;= #{lastDateOf2thNextMonth} AND ZZCOMP2 &gt;= #{fstDateOf2thNextMonth}
						     THEN CP3
				             ELSE 0
				             END) = 0 THEN 0 ELSE SUM(CASE WHEN ZZSHIP1 &lt;= #{lastDateOf2thNextMonth} AND ZZCOMP2 &gt;= #{fstDateOf2thNextMonth}
								                     THEN MH3
								                     ELSE 0
								                     END) * 100 / SUM(CASE WHEN LIFNR = '' 
																             THEN 0
																             WHEN ACTSS <![CDATA[<>]]> '01' AND (LIFNR = '8001' OR LIFNR = '0000008001')
		             			 											 THEN 0
																             WHEN ZZSHIP1 &lt;= #{lastDateOf2thNextMonth} AND ZZCOMP2 &gt;= #{fstDateOf2thNextMonth}
																		     THEN CP3
																             ELSE 0
																             END) END L3
        FROM SAPHEE.${tableName} T1
        LEFT OUTER JOIN (SELECT MANDT,
                                    PSPID,
                                    POSID,
                                    MAX(CASE WHEN CATEGORY = 'MH' THEN ${load} ELSE NULL END)       MH0,
                                    MAX(CASE WHEN CATEGORY = 'MH' THEN ${l0} ELSE NULL END)       MH1,
                                    MAX(CASE WHEN CATEGORY = 'MH' THEN ${l1} ELSE NULL END)       MH2,
                                    MAX(CASE WHEN CATEGORY = 'MH' THEN ${l2} ELSE NULL END)       MH3,
                                    MAX(CASE WHEN CATEGORY = 'Capacity' THEN ${load} ELSE NULL END) CP0,
                                    MAX(CASE WHEN CATEGORY = 'Capacity' THEN ${l0} ELSE NULL END) CP1,
                                    MAX(CASE WHEN CATEGORY = 'Capacity' THEN ${l1} ELSE NULL END) CP2,
                                    MAX(CASE WHEN CATEGORY = 'Capacity' THEN ${l2} ELSE NULL END) CP3
                             FROM SAPHEE.${tableName2}
                             GROUP BY MANDT, PSPID, POSID) T0 ON (T1.MANDT = T0.MANDT AND T1.PSPID = T0.PSPID AND T1.POSID = T0.POSID)
        WHERE T1.MANDT = #{mandt}
        AND T1.ACTSS = #{zzactss}
        GROUP BY GRUP, ACTSS, LIFNR
        <if test="DB2.equals(true)">
        FOR FETCH ONLY
        WITH UR
        </if>
    </select>

    <select id="selectGroupByLifnr" parameterType="hdel.ps.domain.PS17ParamVO" resultType="HashMap" useCache="false">
        WITH INWON AS (
            SELECT A.MANDT,
                   P.DTEXT4 AS GRUP,
                   Z00.ACTSS,
                   (SELECT COUNT(ZZACTSS) FROM SAPHEE.ZMASTER02 S LEFT OUTER JOIN SAPHEE.ZPSTW0302 D ON (D.MANDT = C.MANDT AND D.INP_DT = C.INP_DT AND D.LIFNR = C.LIFNR AND D.PERNO = C.PERNO) WHERE S.MANDT = D.MANDT AND S.POSID = D.PSPID AND POSID_1 = D.POSID AND S.ZZACTSS &lt;&gt; R.ZZACTSS) AS ACTSS_NOT_EQL,
                   A.LIFNR,
                   A.TEMNO,
                   A.PERNO,
                   A.RETID,
                   A.ENTER,
                   C.TUIP_CHKA,
                   C.TUIP_CHKB
            FROM SAPHEE.ZPST0001 AS A
                     INNER JOIN SAPHEE.ZPST0034 AS B ON A.MANDT = B.MANDT AND A.LIFNR = B.LIFNR AND A.GBN = B.GBN
                     LEFT OUTER JOIN SAPHEE.ZPSTW0301 C ON (A.MANDT = C.MANDT AND C.INP_DT = #{mdate} AND A.LIFNR = C.LIFNR AND A.PERNO = C.PERNO)
                     LEFT OUTER JOIN SAPHEE.ZPST0001 Z01 ON Z01.MANDT = A.MANDT AND Z01.LIFNR = A.LIFNR AND Z01.GBN = 'A' AND Z01.PERNO = A.PERNO
                     LEFT OUTER JOIN SAPHEE.ZPST0000 Z00 ON Z00.MANDT = Z01.MANDT AND Z00.ACTSS = Z01.ACTSS
                     LEFT OUTER JOIN SAPHEE.ZLCODE P ON (P.MANDT = A.MANDT AND P.LANG = 'ko' AND P.CODE1 = 'PS003' AND P.CODE2 = A.ACTSS)
                     LEFT OUTER JOIN SAPHEE.ZWBT010 R ON (R.MANDT = A.MANDT AND R.LIFNR = A.LIFNR)
            WHERE A.MANDT = '183'
              AND A.GBN = 'A'
              AND (A.POSIE = 'X' OR A.POSIT = 'X')
              AND A.GUBUN IN ('01', '02')
              AND A.TYPE = '1'
              AND A.DIRECT = 'X'
              AND (A.RETID = '' OR A.RETID = '00000000' OR A.RETID &gt;= #{mdate})
              AND B.SO5 &lt;&gt; 'X'
              AND A.ENTER &lt;= #{mdate}

            UNION ALL

            SELECT P1.MANDT,
                   P.DTEXT4 AS GRUP,
                   Z00.ACTSS,
                   (SELECT COUNT(ZZACTSS) FROM SAPHEE.ZMASTER02 S LEFT OUTER JOIN SAPHEE.ZPSTW0302 D ON (D.MANDT = C.MANDT AND D.INP_DT = C.INP_DT AND D.LIFNR = C.LIFNR AND D.PERNO = C.PERNO) WHERE S.MANDT = D.MANDT AND S.POSID = D.PSPID AND POSID_1 = D.POSID AND S.ZZACTSS &lt;&gt; R.ZZACTSS) AS ACTSS_NOT_EQL,
                   P1.LIFNR,
                   P1.TEMNO,
                   P1.PERNO,
                   P1.RETID,
                   P1.ENTER,
                   C.TUIP_CHKA,
                   C.TUIP_CHKB
            FROM SAPHEE.ZPST0138 AS P1
                     INNER JOIN SAPHEE.ZPST0034 AS B ON P1.MANDT = B.MANDT AND P1.LIFNR = B.LIFNR AND P1.GBN = B.GBN
                     LEFT OUTER JOIN SAPHEE.ZPSTW0301 C ON (P1.MANDT = C.MANDT AND C.INP_DT = #{mdate} AND P1.LIFNR = C.LIFNR AND P1.PERNO = C.PERNO)
                     LEFT OUTER JOIN SAPHEE.ZPST0001 Z01 ON Z01.MANDT = P1.MANDT AND Z01.LIFNR = P1.LIFNR AND Z01.GBN = 'A' AND Z01.PERNO = P1.PERNO
                     LEFT OUTER JOIN SAPHEE.ZPST0000 Z00 ON Z00.MANDT = Z01.MANDT AND Z00.ACTSS = Z01.ACTSS
                     LEFT OUTER JOIN SAPHEE.ZLCODE P ON (P.MANDT = P1.MANDT AND P.LANG = 'ko' AND P.CODE1 = 'PS003' AND P.CODE2 = P1.ACTSS)
                     LEFT OUTER JOIN SAPHEE.ZWBT010 R ON (R.MANDT = P1.MANDT AND R.LIFNR = P1.LIFNR)
            WHERE P1.MANDT = '183'
              AND P1.GBN = 'A'
              AND (SELECT CASE
                              WHEN COUNT(P.MANDT) = 0 THEN 'B'
                              ELSE CASE
                                       WHEN (SELECT COUNT(*)
                                             FROM SAPHEE.ZPST0143 P2
                                             WHERE P2.MANDT = P1.MANDT
                                               AND P2.LIFNR = P1.LIFNR
                                               AND P2.PERNO = P1.PERNO
                                               AND P2.SIGN &gt; ''
                                               AND P2.GBN = 'A') = 0 THEN 'A'
                                       WHEN (SELECT COUNT(*)
                                             FROM SAPHEE.ZPST0143 P2
                                             WHERE P2.MANDT = P1.MANDT
                                               AND P2.LIFNR = P1.LIFNR
                                               AND P2.PERNO = P1.PERNO
                                               AND P2.SIGN = '반송'
                                               AND P2.GBN = 'A') &gt; 0 OR (SELECT COUNT(*)
                                                                         FROM SAPHEE.ZPST0143 P2
                                                                         WHERE P2.MANDT = P1.MANDT
                                                                           AND P2.LIFNR = P1.LIFNR
                                                                           AND P2.PERNO = P1.PERNO
                                                                           AND P2.SIGN &gt; ''
                                                                           AND P2.GBN = 'A') = COUNT(P.MANDT) THEN 'D'
                                       ELSE 'C' END
                              END CNT
                   FROM SAPHEE.ZPST0143 AS P
                   WHERE P.MANDT = P1.MANDT
                     AND P.LIFNR = P1.LIFNR
                     AND P.PERNO = P1.PERNO
                     AND P.GBN = 'A'
                  ) IN ('A', 'C')
              AND (SELECT CASE
                              WHEN COUNT(P.MANDT) = 0 THEN 'B'
                              ELSE CASE
                                       WHEN (SELECT COUNT(*)
                                             FROM SAPHEE.ZPST0143 P2
                                             WHERE P2.MANDT = P1.MANDT
                                               AND P2.LIFNR = P1.LIFNR
                                               AND P2.PERNO = P1.PERNO
                                               AND P2.SIGN &gt; ''
                                               AND P2.GBN = 'A') = 0 THEN 'A'
                                       WHEN (SELECT COUNT(*)
                                             FROM SAPHEE.ZPST0143 P2
                                             WHERE P2.MANDT = P1.MANDT
                                               AND P2.LIFNR = P1.LIFNR
                                               AND P2.PERNO = P1.PERNO
                                               AND P2.SIGN = '반송'
                                               AND P2.GBN = 'A') &gt; 0 OR (SELECT COUNT(*)
                                                                         FROM SAPHEE.ZPST0143 P2
                                                                         WHERE P2.MANDT = P1.MANDT
                                                                           AND P2.LIFNR = P1.LIFNR
                                                                           AND P2.PERNO = P1.PERNO
                                                                           AND P2.SIGN &gt; ''
                                                                           AND P2.GBN = 'A') = COUNT(P.MANDT) THEN 'D'
                                       ELSE 'C' END
                              END CNT
                   FROM SAPHEE.ZPST0143 AS P
                   WHERE P.MANDT = P1.MANDT
                     AND P.LIFNR = P1.LIFNR
                     AND P.PERNO = P1.PERNO
                     AND P.GBN = 'A'
                  ) &lt;&gt; 'D'
              AND P1.STATS = 'B'
              AND P1.RETIF = ''
              AND (P1.POSIE = 'X' OR P1.POSIT = 'X')
              AND P1.GUBUN IN ('01', '02')
              AND P1.TYPE = '1'
              AND P1.DIRECT = 'X'
              AND (P1.RETID = '' OR P1.RETID = '00000000' OR P1.RETID &gt;= #{mdate})
              AND B.SO5 &lt;> 'X'
              AND P1.ENTER &lt;= #{mdate}
        )
        SELECT
            1 AS HSTATUS,
            GRUP,
            ACTSS,
            MAX(ACTSS_NM) ACTSS_NM,
            LIFNR,
            MAX(LIFNR_NM) LIFNR_NM,
            TEMNO,
            MAX(NAMET) NAMET,
            COUNT(CASE WHEN T1.ZZCHAKG = 'X' THEN 1 ELSE NULL END) HCNT,
            AVG(PRO_R) PRO_R,
            SUM(TOT_MH * CAST(1 - (PRO_R / 100) AS DOUBLE)) MH,
            CASE WHEN SUM(CP0) = 0 THEN 0 ELSE SUM(MH0) * 100 / SUM(CP0) END "LOAD",
            (SELECT COUNT(T2.PERNO) FROM INWON T2 WHERE T2.ACTSS = T1.ACTSS AND T2.LIFNR = T1.LIFNR AND T1.TEMNO = T2.TEMNO) BINWON,
            (SELECT COUNT(DISTINCT CASE WHEN T2.TUIP_CHKA = 'X' AND T2.ACTSS_NOT_EQL &gt; 0 THEN T2.PERNO ELSE NULL END) FROM INWON T2 WHERE T1.ACTSS = T2.ACTSS AND T1.LIFNR = T2.LIFNR AND T1.TEMNO = T2.TEMNO) JINWON,
            VALUE(SUM(CASE WHEN ZZSHIP1 BETWEEN #{fstDateOfMdate} AND #{lastDateOfMonth} THEN JCNT ELSE NULL END),0) JCNT,
            VALUE((SELECT COUNT(T2.PERNO) FROM INWON T2 WHERE T2.ACTSS = T1.ACTSS AND T2.LIFNR = T1.LIFNR AND T1.TEMNO = T2.TEMNO), 0) - VALUE((SELECT COUNT(DISTINCT CASE WHEN T2.TUIP_CHKA = 'X' AND T2.ACTSS_NOT_EQL &gt; 0 THEN T2.PERNO ELSE NULL END) FROM INWON T2 WHERE T1.ACTSS = T2.ACTSS AND T1.LIFNR = T2.LIFNR AND T1.TEMNO = T2.TEMNO), 0) HINWON,
            AVG(OPT) OPT,
            COUNT(CASE WHEN ZZSHIP1 BETWEEN #{fstDateOfMdate} AND #{lastDateOfMonth} THEN 1 ELSE NULL END) E1,
            COUNT(CASE WHEN ZZSHIP1 &gt; #{mdate} AND ZZSHIP1 &lt;= #{lastDateOfMonth} THEN 1 ELSE NULL END) P1,
            SUM(CASE WHEN ZZSHIP1 &lt;= #{lastDateOfMonth} AND ZZCOMP2 &gt;= #{fstDateOfMdate}
                     THEN MH1
                     ELSE 0
                     END) MH1,
            SUM(CASE WHEN TEMNO = ''
             THEN 0
             WHEN ZZSHIP1 &lt;= #{lastDateOfMonth} AND ZZCOMP2 &gt;= #{fstDateOfMdate}
             THEN CP1
             ELSE 0
             END) CP1,
            CASE WHEN SUM(CASE WHEN TEMNO = ''
					             THEN 0
					             WHEN ZZSHIP1 &lt;= #{lastDateOfMonth} AND ZZCOMP2 &gt;= #{fstDateOfMdate}
					             THEN CP1
					             ELSE 0
					             END) = 0 THEN 0 ELSE SUM(CASE WHEN ZZSHIP1 &lt;= #{lastDateOfMonth} AND ZZCOMP2 &gt;= #{fstDateOfMdate}
									                     THEN MH1
									                     ELSE 0
									                     END) * 100 / SUM(CASE WHEN TEMNO = ''
																	             THEN 0
																	             WHEN ZZSHIP1 &lt;= #{lastDateOfMonth} AND ZZCOMP2 &gt;= #{fstDateOfMdate}
																	             THEN CP1
																	             ELSE 0
																	             END) END L1,
            COUNT(CASE WHEN ZZSHIP1 BETWEEN #{fstDateOf1thNextMonth} AND #{lastDateOf1thNextMonth} THEN 1 ELSE NULL END) E2,
            SUM(CASE WHEN ZZSHIP1 &lt;= #{lastDateOf1thNextMonth} AND ZZCOMP2 &gt;= #{fstDateOf1thNextMonth}
                     THEN MH2
                     ELSE 0
                     END) MH2,
            SUM(CASE WHEN TEMNO = ''
             THEN 0
             WHEN ZZSHIP1 &lt;= #{lastDateOf1thNextMonth} AND ZZCOMP2 &gt;= #{fstDateOf1thNextMonth}
             THEN CP2
             ELSE 0
             END) CP2,
            CASE WHEN SUM(  CASE WHEN TEMNO = ''
					             THEN 0
					             WHEN ZZSHIP1 &lt;= #{lastDateOf1thNextMonth} AND ZZCOMP2 &gt;= #{fstDateOf1thNextMonth}
					             THEN CP2
					             ELSE 0
					             END) = 0 THEN 0 ELSE SUM(CASE WHEN ZZSHIP1 &lt;= #{lastDateOf1thNextMonth} AND ZZCOMP2 &gt;= #{fstDateOf1thNextMonth}
											                     THEN MH2
											                     ELSE 0
											                     END) * 100 / SUM(CASE WHEN TEMNO = ''
																	             THEN 0
																	             WHEN ZZSHIP1 &lt;= #{lastDateOf1thNextMonth} AND ZZCOMP2 &gt;= #{fstDateOf1thNextMonth}
																	             THEN CP2
																	             ELSE 0
																	             END) END L2,
            COUNT(CASE WHEN ZZSHIP1 BETWEEN #{fstDateOf2thNextMonth} AND #{lastDateOf2thNextMonth} THEN 1 ELSE NULL END) E3,
            SUM(CASE WHEN ZZSHIP1 &lt;= #{lastDateOf2thNextMonth} AND ZZCOMP2 &gt;= #{fstDateOf2thNextMonth}
                     THEN MH3
                     ELSE 0
                     END) MH3,
            SUM(CASE WHEN TEMNO = ''
             THEN 0
             WHEN ZZSHIP1 &lt;= #{lastDateOf2thNextMonth} AND ZZCOMP2 &gt;= #{fstDateOf2thNextMonth}
             THEN CP3
             ELSE 0
             END) CP3,
            CASE WHEN SUM(CASE WHEN TEMNO = ''
					             THEN 0
					             WHEN ZZSHIP1 &lt;= #{lastDateOf2thNextMonth} AND ZZCOMP2 &gt;= #{fstDateOf2thNextMonth}
					             THEN CP3
					             ELSE 0
					             END) = 0 THEN 0 ELSE SUM(CASE WHEN ZZSHIP1 &lt;= #{lastDateOf2thNextMonth} AND ZZCOMP2 &gt;= #{fstDateOf2thNextMonth}
										                     THEN MH3
										                     ELSE 0
										                     END) * 100 / SUM(CASE WHEN TEMNO = ''
																	             THEN 0
																	             WHEN ZZSHIP1 &lt;= #{lastDateOf2thNextMonth} AND ZZCOMP2 &gt;= #{fstDateOf2thNextMonth}
																	             THEN CP3
																	             ELSE 0
																	             END) END L3
        FROM SAPHEE.${tableName} T1
        LEFT OUTER JOIN (SELECT MANDT,
                                    PSPID,
                                    POSID,
                                    MAX(CASE WHEN CATEGORY = 'MH' THEN ${load} ELSE NULL END)       MH0,
                                    MAX(CASE WHEN CATEGORY = 'MH' THEN ${l0} ELSE NULL END)       MH1,
                                    MAX(CASE WHEN CATEGORY = 'MH' THEN ${l1} ELSE NULL END)       MH2,
                                    MAX(CASE WHEN CATEGORY = 'MH' THEN ${l2} ELSE NULL END)       MH3,
                                    MAX(CASE WHEN CATEGORY = 'Capacity' THEN ${load} ELSE NULL END) CP0,
                                    MAX(CASE WHEN CATEGORY = 'Capacity' THEN ${l0} ELSE NULL END) CP1,
                                    MAX(CASE WHEN CATEGORY = 'Capacity' THEN ${l1} ELSE NULL END) CP2,
                                    MAX(CASE WHEN CATEGORY = 'Capacity' THEN ${l2} ELSE NULL END) CP3
                             FROM SAPHEE.${tableName2}
                             GROUP BY MANDT, PSPID, POSID) T0 ON (T1.MANDT = T0.MANDT AND T1.PSPID = T0.PSPID AND T1.POSID = T0.POSID)
        WHERE T1.MANDT = #{mandt}
        <if test="zzactss != '' and zzactss != null">
        AND T1.ACTSS = #{zzactss}
        </if>
        <if test="zzlifnr != '' and zzlifnr != null">
        AND T1.LIFNR = #{zzlifnr}
        </if>
        GROUP BY GRUP, ACTSS, LIFNR, TEMNO, NAMET
        <if test="DB2.equals(true)">
        FOR FETCH ONLY
        WITH UR
        </if>
    </select>

    <select id="selectGroupByTeam" parameterType="hdel.ps.domain.PS17ParamVO" resultType="HashMap" useCache="false">
        WITH INWON AS (
            SELECT A.MANDT,
                   P.DTEXT4 AS GRUP,
                   Z00.ACTSS,
                   (SELECT COUNT(ZZACTSS) FROM SAPHEE.ZMASTER02 S LEFT OUTER JOIN SAPHEE.ZPSTW0302 D ON (D.MANDT = C.MANDT AND D.INP_DT = C.INP_DT AND D.LIFNR = C.LIFNR AND D.PERNO = C.PERNO) WHERE S.MANDT = D.MANDT AND S.POSID = D.PSPID AND POSID_1 = D.POSID AND S.ZZACTSS &lt;&gt; R.ZZACTSS) AS ACTSS_NOT_EQL,
                   A.LIFNR,
                   A.PERNO,
                   A.RETID,
                   A.ENTER,
                   C.TUIP_CHKA,
                   C.TUIP_CHKB
            FROM SAPHEE.ZPST0001 AS A
                     INNER JOIN SAPHEE.ZPST0034 AS B ON A.MANDT = B.MANDT AND A.LIFNR = B.LIFNR AND A.GBN = B.GBN
                     LEFT OUTER JOIN SAPHEE.ZPSTW0301 C ON (A.MANDT = C.MANDT AND C.INP_DT = #{mdate} AND A.LIFNR = C.LIFNR AND A.PERNO = C.PERNO)
                     LEFT OUTER JOIN SAPHEE.ZPST0001 Z01 ON Z01.MANDT = A.MANDT AND Z01.LIFNR = A.LIFNR AND Z01.GBN = 'A' AND Z01.PERNO = A.PERNO
                     LEFT OUTER JOIN SAPHEE.ZPST0000 Z00 ON Z00.MANDT = Z01.MANDT AND Z00.ACTSS = Z01.ACTSS
                     LEFT OUTER JOIN SAPHEE.ZLCODE P ON (P.MANDT = A.MANDT AND P.LANG = 'ko' AND P.CODE1 = 'PS003' AND P.CODE2 = A.ACTSS)
                     LEFT OUTER JOIN SAPHEE.ZWBT010 R ON (R.MANDT = A.MANDT AND R.LIFNR = A.LIFNR)
            WHERE A.MANDT = '183'
              AND A.GBN = 'A'
              AND (A.POSIE = 'X' OR A.POSIT = 'X')
              AND A.GUBUN IN ('01', '02')
              AND A.TYPE = '1'
              AND A.DIRECT = 'X'
              AND (A.RETID = '' OR A.RETID = '00000000' OR A.RETID &gt;= #{mdate})
              AND B.SO5 &lt;&gt; 'X'
              AND A.ENTER &lt;= #{mdate}

            UNION ALL

            SELECT P1.MANDT,
                   P.DTEXT4 AS GRUP,
                   Z00.ACTSS,
                   (SELECT COUNT(ZZACTSS) FROM SAPHEE.ZMASTER02 S LEFT OUTER JOIN SAPHEE.ZPSTW0302 D ON (D.MANDT = C.MANDT AND D.INP_DT = C.INP_DT AND D.LIFNR = C.LIFNR AND D.PERNO = C.PERNO) WHERE S.MANDT = D.MANDT AND S.POSID = D.PSPID AND POSID_1 = D.POSID AND S.ZZACTSS &lt;&gt; R.ZZACTSS) AS ACTSS_NOT_EQL,
                   P1.LIFNR,
                   P1.PERNO,
                   P1.RETID,
                   P1.ENTER,
                   C.TUIP_CHKA,
                   C.TUIP_CHKB
            FROM SAPHEE.ZPST0138 AS P1
                     INNER JOIN SAPHEE.ZPST0034 AS B ON P1.MANDT = B.MANDT AND P1.LIFNR = B.LIFNR AND P1.GBN = B.GBN
                     LEFT OUTER JOIN SAPHEE.ZPSTW0301 C ON (P1.MANDT = C.MANDT AND C.INP_DT = #{mdate} AND P1.LIFNR = C.LIFNR AND P1.PERNO = C.PERNO)
                     LEFT OUTER JOIN SAPHEE.ZPST0001 Z01 ON Z01.MANDT = P1.MANDT AND Z01.LIFNR = P1.LIFNR AND Z01.GBN = 'A' AND Z01.PERNO = P1.PERNO
                     LEFT OUTER JOIN SAPHEE.ZPST0000 Z00 ON Z00.MANDT = Z01.MANDT AND Z00.ACTSS = Z01.ACTSS
                     LEFT OUTER JOIN SAPHEE.ZLCODE P ON (P.MANDT = P1.MANDT AND P.LANG = 'ko' AND P.CODE1 = 'PS003' AND P.CODE2 = P1.ACTSS)
                     LEFT OUTER JOIN SAPHEE.ZWBT010 R ON (R.MANDT = P1.MANDT AND R.LIFNR = P1.LIFNR)
            WHERE P1.MANDT = '183'
              AND P1.GBN = 'A'
              AND (SELECT CASE
                              WHEN COUNT(P.MANDT) = 0 THEN 'B'
                              ELSE CASE
                                       WHEN (SELECT COUNT(*)
                                             FROM SAPHEE.ZPST0143 P2
                                             WHERE P2.MANDT = P1.MANDT
                                               AND P2.LIFNR = P1.LIFNR
                                               AND P2.PERNO = P1.PERNO
                                               AND P2.SIGN &gt; ''
                                               AND P2.GBN = 'A') = 0 THEN 'A'
                                       WHEN (SELECT COUNT(*)
                                             FROM SAPHEE.ZPST0143 P2
                                             WHERE P2.MANDT = P1.MANDT
                                               AND P2.LIFNR = P1.LIFNR
                                               AND P2.PERNO = P1.PERNO
                                               AND P2.SIGN = '반송'
                                               AND P2.GBN = 'A') &gt; 0 OR (SELECT COUNT(*)
                                                                         FROM SAPHEE.ZPST0143 P2
                                                                         WHERE P2.MANDT = P1.MANDT
                                                                           AND P2.LIFNR = P1.LIFNR
                                                                           AND P2.PERNO = P1.PERNO
                                                                           AND P2.SIGN &gt; ''
                                                                           AND P2.GBN = 'A') = COUNT(P.MANDT) THEN 'D'
                                       ELSE 'C' END
                              END CNT
                   FROM SAPHEE.ZPST0143 AS P
                   WHERE P.MANDT = P1.MANDT
                     AND P.LIFNR = P1.LIFNR
                     AND P.PERNO = P1.PERNO
                     AND P.GBN = 'A'
                  ) IN ('A', 'C')
              AND (SELECT CASE
                              WHEN COUNT(P.MANDT) = 0 THEN 'B'
                              ELSE CASE
                                       WHEN (SELECT COUNT(*)
                                             FROM SAPHEE.ZPST0143 P2
                                             WHERE P2.MANDT = P1.MANDT
                                               AND P2.LIFNR = P1.LIFNR
                                               AND P2.PERNO = P1.PERNO
                                               AND P2.SIGN &gt; ''
                                               AND P2.GBN = 'A') = 0 THEN 'A'
                                       WHEN (SELECT COUNT(*)
                                             FROM SAPHEE.ZPST0143 P2
                                             WHERE P2.MANDT = P1.MANDT
                                               AND P2.LIFNR = P1.LIFNR
                                               AND P2.PERNO = P1.PERNO
                                               AND P2.SIGN = '반송'
                                               AND P2.GBN = 'A') &gt; 0 OR (SELECT COUNT(*)
                                                                         FROM SAPHEE.ZPST0143 P2
                                                                         WHERE P2.MANDT = P1.MANDT
                                                                           AND P2.LIFNR = P1.LIFNR
                                                                           AND P2.PERNO = P1.PERNO
                                                                           AND P2.SIGN &gt; ''
                                                                           AND P2.GBN = 'A') = COUNT(P.MANDT) THEN 'D'
                                       ELSE 'C' END
                              END CNT
                   FROM SAPHEE.ZPST0143 AS P
                   WHERE P.MANDT = P1.MANDT
                     AND P.LIFNR = P1.LIFNR
                     AND P.PERNO = P1.PERNO
                     AND P.GBN = 'A'
                  ) &lt;&gt; 'D'
              AND P1.STATS = 'B'
              AND P1.RETIF = ''
              AND (P1.POSIE = 'X' OR P1.POSIT = 'X')
              AND P1.GUBUN IN ('01', '02')
              AND P1.TYPE = '1'
              AND P1.DIRECT = 'X'
              AND (P1.RETID = '' OR P1.RETID = '00000000' OR P1.RETID &gt;= #{mdate})
              AND B.SO5 &lt;> 'X'
              AND P1.ENTER &lt;= #{mdate}
        ), SUMMARY AS (
            SELECT MANDT,
                   PSPID,
                   POSID,
                   MAX(CASE WHEN CATEGORY = 'MH' THEN ${load} ELSE NULL END)       MH0,
                   MAX(CASE WHEN CATEGORY = 'MH' THEN ${l0} ELSE NULL END)         MH1,
                   MAX(CASE WHEN CATEGORY = 'MH' THEN ${l1} ELSE NULL END)         MH2,
                   MAX(CASE WHEN CATEGORY = 'MH' THEN ${l2} ELSE NULL END)         MH3,
                   MAX(CASE WHEN CATEGORY = 'Capacity' THEN ${load} ELSE NULL END) CP0,
                   MAX(CASE WHEN CATEGORY = 'Capacity' THEN ${l0} ELSE NULL END)   CP1,
                   MAX(CASE WHEN CATEGORY = 'Capacity' THEN ${l1} ELSE NULL END)   CP2,
                   MAX(CASE WHEN CATEGORY = 'Capacity' THEN ${l2} ELSE NULL END)   CP3
            FROM SAPHEE.${tableName2}
            GROUP BY MANDT, PSPID, POSID
        )
        SELECT
            1 AS HSTATUS,
            GUBUN,
            GRUP2,
            ZORD,
            GRUP,
            ACTSS,
            CASE WHEN GUBUN = 0 THEN ACTSS_NM ELSE GRUP END ACTSS_NM,
            HCNT,
            PRO_R,
            T.LOAD,
            MH,
            MH0,
            CP0,
            BINWON,
            VALUE((
	        	SELECT COUNT(DISTINCT X1.LIFNR||X3.ACTSS||X1.NAMEE||X1.TMCD||X2.ZZACTSS)
	        	  FROM SAPHEE.ZPSTW0301 AS X1
	        	  LEFT OUTER JOIN SAPHEE.ZPST0001 AS X3
	               ON X3.MANDT = X1.MANDT
	              AND X3.LIFNR = X1.LIFNR
	              AND X3.PERNO = X1.PERNO
	              AND X3.GBN = 'A'
	              LEFT OUTER JOIN SAPHEE.ZPSTW0302 AS X4
	                           ON X4.MANDT = X1.MANDT
	                          AND X4.INP_DT = X1.INP_DT
	                          AND X4.LIFNR = X1.LIFNR
	                          AND X4.PERNO = X1.PERNO
	              LEFT OUTER JOIN SAPHEE.ZMASTER02 AS X2
	        	               ON X4.MANDT = X2.MANDT
	        	              AND X4.PSPID = X2.POSID
	        	              AND X4.POSID = X2.POSID_1
	              LEFT OUTER JOIN SAPHEE.LFA1 AS L
	                           ON L.MANDT = X1.MANDT
	                          AND L.LIFNR = X1.LIFNR
	        	 WHERE X1.MANDT = '183'
	        	   AND X1.INP_DT = #{mdate}
	        	   AND X1.TUIP_CHKA = 'X'
	        	   AND SUBSTR(X1.PERNO,1,1) = 'S'
	        
	        	   AND X3.ACTSS <![CDATA[<>]]> X2.ZZACTSS
	        	   AND T.ACTSS <![CDATA[<>]]> X2.ZZACTSS
	        	   AND X3.ACTSS = T.ACTSS
	        	   AND T.ACTSS NOT IN ('15','16','00','')
	        	   AND T.ACTSS IS NOT NULL
	  			   AND X3.RETIF <![CDATA[<>]]> 'X'
	  			   
	  	
	
	        ),0) AS JINWON,
	        VALUE((
	        	SELECT COUNT(DISTINCT X1.LIFNR||X3.ACTSS||X1.NAMEE||X1.TMCD||X2.ZZACTSS)
	        	  FROM SAPHEE.ZPSTW0301 AS X1
	        	  LEFT OUTER JOIN SAPHEE.ZPST0001 AS X3
	               ON X3.MANDT = X1.MANDT
	              AND X3.LIFNR = X1.LIFNR
	              AND X3.PERNO = X1.PERNO
	              AND X3.GBN = 'A'
	              LEFT OUTER JOIN SAPHEE.ZPSTW0302 AS X4
	                           ON X4.MANDT = X1.MANDT
	                          AND X4.INP_DT = X1.INP_DT
	                          AND X4.LIFNR = X1.LIFNR
	                          AND X4.PERNO = X1.PERNO
	              LEFT OUTER JOIN SAPHEE.ZMASTER02 AS X2
	        	               ON X4.MANDT = X2.MANDT
	        	              AND X4.PSPID = X2.POSID
	        	              AND X4.POSID = X2.POSID_1
	              LEFT OUTER JOIN SAPHEE.LFA1 AS L
	                           ON L.MANDT = X1.MANDT
	                          AND L.LIFNR = X1.LIFNR
	        	 WHERE X1.MANDT = '183'
	        	   AND X1.INP_DT = #{mdate}
	        	   AND X1.TUIP_CHKA = 'X'
	        	   AND SUBSTR(X1.PERNO,1,1) = 'S'
	        	   AND X3.ACTSS <![CDATA[<>]]> X2.ZZACTSS
	        	   AND T.ACTSS = X2.ZZACTSS
	        	   AND X3.ACTSS <![CDATA[<>]]> T.ACTSS
	        	   AND T.ACTSS NOT IN ('15','16','00','')
	        	   AND T.ACTSS IS NOT NULL
				   AND X3.RETIF <![CDATA[<>]]> 'X'
				   

	        ),0) AS PJIWON,
            -- VALUE(BINWON,0) - VALUE(JINWON,0) AS HINWON,
            0 AS HINWON,
            E1,
            P1,
            MH1,
            CP1,
            L1,
            E2,
            MH2,
            CP2,
            L2,
            E3,
            MH3,
            CP3,
            L3
        FROM (
            SELECT
                0 GUBUN,
                GRUP,
                (CASE WHEN ACTSS = '21' OR ACTSS = '10' OR ACTSS = '08' -- 강북, 인천, 강원
		             THEN '1'
		             WHEN ACTSS = '02' OR ACTSS = '19' OR ACTSS = '20'  -- 강남, 강서, 중부
		             THEN '2'
		             WHEN ACTSS = '06' OR ACTSS = '05' OR ACTSS = '07' OR ACTSS = '12' -- 대전, 광주, 전주, 제주
		             THEN '3'
		             WHEN ACTSS = '03' OR ACTSS = '04' OR ACTSS = '11' OR ACTSS = '09' -- 부산, 대구, 경남, 울산
		             THEN '4'
		             WHEN ACTSS = '13' OR ACTSS = '01' -- E/S, 직영
		             THEN '5'
		             ELSE '6' -- 리모델링
		             END) AS GRUP2,
                CASE WHEN ACTSS = '21'
		      		 THEN '01'
		      		 WHEN ACTSS = '10'
		      		 THEN '02'
		      		 WHEN ACTSS = '08'
		      		 THEN '03'
		      		 WHEN ACTSS = '02'
		      		 THEN '01'
		      		 WHEN ACTSS = '19'
		      		 THEN '02'
		      		 WHEN ACTSS = '20'
		      		 THEN '03'
		      		 WHEN ACTSS = '06'
		      		 THEN '01'
		      		 WHEN ACTSS = '05'
		      		 THEN '02'
		      		 WHEN ACTSS = '07'
		      		 THEN '03'
		      		 WHEN ACTSS = '12'
		      		 THEN '04'
		      		 WHEN ACTSS = '03'
		      		 THEN '01'
		      		 WHEN ACTSS = '04'
		      		 THEN '02'
		      		 WHEN ACTSS = '11'
		      		 THEN '03'
		      		 WHEN ACTSS = '09'
		      		 THEN '04'
		      		 WHEN ACTSS = '13'
		      		 THEN '01'
		      		 WHEN ACTSS = '01'
		      		 THEN '02'
		      		 ELSE '01'
                END AS ZORD,
                ACTSS,
                MAX(ACTSS_NM) ACTSS_NM,
                COUNT(CASE WHEN T1.ZZCHAKG = 'X' THEN 1 ELSE NULL END) HCNT,
                (
		        	SELECT AVG(PRO_R)
		        	  FROM SAPHEE.${tableName} AS X
		        	 WHERE X.MANDT = '183'
		        	   AND X.ACTSS = T1.ACTSS
		        	   AND X.PRO_R <![CDATA[<>]]> 0
		        	   AND X.ZZSHIP1 BETWEEN #{fstDateOfMdate} AND #{lastDateOfMonth}
		        ) PRO_R,
                SUM(TOT_MH * CAST(1 - (PRO_R / 100) AS DOUBLE)) MH,
                VALUE(SUM(MH0),0) MH0,
                VALUE(SUM(CP0),0) CP0,
                CASE WHEN SUM(CP0) = 0 THEN 0 ELSE SUM(MH0) * 100 / SUM(CP0) END "LOAD",
                (SELECT COUNT(T2.PERNO) FROM INWON T2 WHERE T2.ACTSS = T1.ACTSS) BINWON,
                
                COUNT(CASE WHEN ZZSHIP1 BETWEEN #{fstDateOfMdate} AND #{lastDateOfMonth} THEN 1 ELSE NULL END) E1,
                COUNT(CASE WHEN ZZSHIP1 &gt; #{mdate} AND ZZSHIP1 &lt;= #{lastDateOfMonth} THEN 1 ELSE NULL END) P1, 
                VALUE(SUM(CASE WHEN ZZSHIP1 &lt;= #{lastDateOfMonth} AND ZZCOMP2 &gt;= #{fstDateOfMdate}
                     THEN MH1
                     ELSE 0
                     END),0) MH1,
                VALUE(SUM(CASE WHEN LIFNR = ''
					           THEN 0
					           WHEN ACTSS <![CDATA[<>]]> '01' AND (LIFNR = '8001' OR LIFNR = '0000008001')
		             		   THEN 0
		             		   WHEN ZZSHIP1 &lt;= #{lastDateOfMonth} AND ZZCOMP2 &gt;= #{fstDateOfMdate}
		             		   THEN CP1
					           ELSE 0
					           END),0) CP1,
                CASE WHEN SUM(CASE WHEN LIFNR = ''
					           THEN 0
					           WHEN ACTSS <![CDATA[<>]]> '01' AND (LIFNR = '8001' OR LIFNR = '0000008001')
		             		   THEN 0
					           WHEN ZZSHIP1 &lt;= #{lastDateOfMonth} AND ZZCOMP2 &gt;= #{fstDateOfMdate}
		             		   THEN CP1
					           ELSE 0
					           END) = 0 THEN 0 ELSE SUM(CASE WHEN ZZSHIP1 &lt;= #{lastDateOfMonth} AND ZZCOMP2 &gt;= #{fstDateOfMdate}
										                     THEN MH1
										                     ELSE 0
										                     END) * 100 / SUM(CASE WHEN LIFNR = ''
																		           THEN 0
																		           WHEN ACTSS <![CDATA[<>]]> '01' AND (LIFNR = '8001' OR LIFNR = '0000008001')
		             			 												   THEN 0
																		           WHEN ZZSHIP1 &lt;= #{lastDateOfMonth} AND ZZCOMP2 &gt;= #{fstDateOfMdate}
															             		   THEN CP1
																		           ELSE 0
																		           END) END L1,
                COUNT(CASE WHEN ZZSHIP1 BETWEEN #{fstDateOf1thNextMonth} AND #{lastDateOf1thNextMonth} THEN 1 ELSE NULL END) E2,
                VALUE(SUM(CASE WHEN ZZSHIP1 &lt;= #{lastDateOf1thNextMonth} AND ZZCOMP2 &gt;= #{fstDateOf1thNextMonth}
                     THEN MH2
                     ELSE 0
                     END),0) MH2,
                VALUE(SUM(CASE WHEN LIFNR = ''
					           THEN 0
					           WHEN ACTSS <![CDATA[<>]]> '01' AND (LIFNR = '8001' OR LIFNR = '0000008001')
		             		   THEN 0
		             		   WHEN ZZSHIP1 &lt;= #{lastDateOf1thNextMonth} AND ZZCOMP2 &gt;= #{fstDateOf1thNextMonth}
					           THEN CP2
					           ELSE 0
					           END),0) CP2,
                CASE WHEN SUM(CASE WHEN LIFNR = ''
					           	   THEN 0
					           	   WHEN ACTSS <![CDATA[<>]]> '01' AND (LIFNR = '8001' OR LIFNR = '0000008001')
		             			   THEN 0
					               WHEN ZZSHIP1 &lt;= #{lastDateOf1thNextMonth} AND ZZCOMP2 &gt;= #{fstDateOf1thNextMonth}
						           THEN CP2
						           ELSE 0
					               END) = 0 THEN 0 ELSE SUM(CASE WHEN ZZSHIP1 &lt;= #{lastDateOf1thNextMonth} AND ZZCOMP2 &gt;= #{fstDateOf1thNextMonth}
											                     THEN MH2
											                     ELSE 0
											                     END) * 100 / SUM(CASE WHEN LIFNR = ''
																			           THEN 0
																			           WHEN ACTSS <![CDATA[<>]]> '01' AND (LIFNR = '8001' OR LIFNR = '0000008001')
		             			 													   THEN 0
																			           WHEN ZZSHIP1 &lt;= #{lastDateOf1thNextMonth} AND ZZCOMP2 &gt;= #{fstDateOf1thNextMonth}
																			           THEN CP2
																			           ELSE 0
																			           END) END L2,
                COUNT(CASE WHEN ZZSHIP1 BETWEEN #{fstDateOf2thNextMonth} AND #{lastDateOf2thNextMonth} THEN 1 ELSE NULL END) E3,
                VALUE(SUM(CASE WHEN ZZSHIP1 &lt;= #{lastDateOf2thNextMonth} AND ZZCOMP2 &gt;= #{fstDateOf2thNextMonth}
                     THEN MH3
                     ELSE 0
                     END),0) MH3,
                VALUE(SUM(CASE WHEN LIFNR = ''
					           THEN 0
					           WHEN ACTSS <![CDATA[<>]]> '01' AND (LIFNR = '8001' OR LIFNR = '0000008001')
		             		   THEN 0
					           WHEN ZZSHIP1 &lt;= #{lastDateOf2thNextMonth} AND ZZCOMP2 &gt;= #{fstDateOf2thNextMonth}
					           THEN CP3
					           ELSE 0
					           END),0) CP3,
                CASE WHEN SUM(CASE WHEN LIFNR = ''
					               THEN 0
					               WHEN ACTSS <![CDATA[<>]]> '01' AND (LIFNR = '8001' OR LIFNR = '0000008001')
		             			   THEN 0
					               WHEN ZZSHIP1 &lt;= #{lastDateOf2thNextMonth} AND ZZCOMP2 &gt;= #{fstDateOf2thNextMonth}
						           THEN CP3
						           ELSE 0
					               END) = 0 THEN 0 ELSE SUM(CASE WHEN ZZSHIP1 &lt;= #{lastDateOf2thNextMonth} AND ZZCOMP2 &gt;= #{fstDateOf2thNextMonth}
											                     THEN MH3
											                     ELSE 0
											                     END) * 100 / SUM(CASE WHEN LIFNR = ''
																	         THEN 0
																	         WHEN ACTSS <![CDATA[<>]]> '01' AND (LIFNR = '8001' OR LIFNR = '0000008001')
		             			 											 THEN 0
																	         WHEN ZZSHIP1 &lt;= #{lastDateOf2thNextMonth} AND ZZCOMP2 &gt;= #{fstDateOf2thNextMonth}
																             THEN CP3
																             ELSE 0
																	         END) END L3
            FROM SAPHEE.${tableName} T1
            LEFT OUTER JOIN SUMMARY T0 ON (T1.MANDT = T0.MANDT AND T1.PSPID = T0.PSPID AND T1.POSID = T0.POSID)
            GROUP BY T1.GRUP, T1.ACTSS
            UNION ALL
            SELECT
                1 GUBUN,
                GRUP,
                (CASE WHEN MAX(T1.ACTSS) = '21' OR MAX(T1.ACTSS) = '10' OR MAX(T1.ACTSS) = '08' -- 강북, 인천, 강원
		             THEN '1'
		             WHEN MAX(T1.ACTSS) = '02' OR MAX(T1.ACTSS) = '19' OR MAX(T1.ACTSS) = '20'  -- 강남, 강서, 중부
		             THEN '2'
		             WHEN MAX(T1.ACTSS) = '06' OR MAX(T1.ACTSS) = '05' OR MAX(T1.ACTSS) = '07' OR MAX(T1.ACTSS) = '12' -- 대전, 광주, 전주, 제주
		             THEN '3'
		             WHEN MAX(T1.ACTSS) = '03' OR MAX(T1.ACTSS) = '04' OR MAX(T1.ACTSS) = '11' OR MAX(T1.ACTSS) = '09' -- 부산, 대구, 경남, 울산
		             THEN '4'
		             WHEN MAX(T1.ACTSS) = '13' OR MAX(T1.ACTSS) = '01' -- E/S, 직영
		             THEN '5'
		             ELSE '6' -- 리모델링
		             END) AS GRUP2,
                1 AS ZORD,
                '' ACTSS,
                '' ACTSS_NM,
                COUNT(CASE WHEN T1.ZZCHAKG = 'X' THEN 1 ELSE NULL END) HCNT,
                CASE WHEN MAX(T1.ACTSS) = '21' OR MAX(T1.ACTSS) = '10' OR MAX(T1.ACTSS) = '08' -- 강북, 인천, 강원
				       THEN (
				       			SELECT AVG(X.PRO_R)
				       			  FROM SAPHEE.${tableName} AS X
				       			 WHERE X.MANDT = '183'
				       			   AND X.ACTSS IN ('21', '10', '08')
				       			   AND X.PRO_R <![CDATA[<>]]> 0
				       			   AND X.ZZSHIP1 BETWEEN #{fstDateOfMdate} AND #{lastDateOfMonth}
				       	    )
				       WHEN MAX(T1.ACTSS) = '02' OR MAX(T1.ACTSS) = '19' OR MAX(T1.ACTSS) = '20'  -- 강남, 강서, 중부
				       THEN (
				       			SELECT AVG(X.PRO_R)
				       			  FROM SAPHEE.${tableName} AS X
				       			 WHERE X.MANDT = '183'
				       			   AND X.ACTSS IN ('02', '19', '20')
				       			   AND X.PRO_R <![CDATA[<>]]> 0
				       			   AND X.ZZSHIP1 BETWEEN #{fstDateOfMdate} AND #{lastDateOfMonth}
				       	    )
				       WHEN MAX(T1.ACTSS) = '06' OR MAX(T1.ACTSS) = '05' OR MAX(T1.ACTSS) = '07' OR MAX(T1.ACTSS) = '12' -- 대전, 광주, 전주, 제주
				       THEN (
				       			SELECT AVG(X.PRO_R)
				       			  FROM SAPHEE.${tableName} AS X
				       			 WHERE X.MANDT = '183'
				       			   AND X.ACTSS IN ('06', '05', '07', '12')
				       			   AND X.PRO_R <![CDATA[<>]]> 0
				       			   AND X.ZZSHIP1 BETWEEN #{fstDateOfMdate} AND #{lastDateOfMonth}

				       	    )
				       WHEN MAX(T1.ACTSS) = '03' OR MAX(T1.ACTSS) = '04' OR MAX(T1.ACTSS) = '11' OR MAX(T1.ACTSS) = '09' -- 부산, 대구, 경남, 울산
				       THEN (
				       			SELECT AVG(X.PRO_R)
				       			  FROM SAPHEE.${tableName} AS X
				       			 WHERE X.MANDT = '183'
				       			   AND X.ACTSS IN ('03', '04', '11', '09')
				       			   AND X.PRO_R <![CDATA[<>]]> 0
				       			   AND X.ZZSHIP1 BETWEEN #{fstDateOfMdate} AND #{lastDateOfMonth}
				 
				       	    )
				       WHEN MAX(T1.ACTSS) = '13' OR MAX(T1.ACTSS) = '01' -- E/S, 직영
				       THEN (
				       			SELECT AVG(X.PRO_R)
				       			  FROM SAPHEE.${tableName} AS X
				       			 WHERE X.MANDT = '183'
				       			   AND X.ACTSS IN ('13', '01')
				       			   AND X.PRO_R <![CDATA[<>]]> 0
				       			   AND X.ZZSHIP1 BETWEEN #{fstDateOfMdate} AND #{lastDateOfMonth}
		
				       	    )
				       ELSE (
				       			SELECT AVG(X.PRO_R)
				       			  FROM SAPHEE.${tableName} AS X
				       			 WHERE X.MANDT = '183'
				       			   AND X.ACTSS IN ('14')
				       			   AND X.PRO_R <![CDATA[<>]]> 0
				       			   AND X.ZZSHIP1 BETWEEN #{fstDateOfMdate} AND #{lastDateOfMonth}

				       	    ) -- 리모델링
				       END AS PRO_R,
                SUM(TOT_MH * CAST(1 - (PRO_R / 100) AS DOUBLE)) MH,
                VALUE(SUM(MH0),0) MH0,
                VALUE(SUM(CP0),0) CP0,
                CASE WHEN SUM(CP0) = 0 THEN 0 ELSE SUM(MH0) * 100 / SUM(CP0) END AS "LOAD",
                (SELECT COUNT(T2.PERNO) FROM INWON T2 WHERE T2.GRUP = T1.GRUP) BINWON,

                COUNT(CASE WHEN ZZSHIP1 BETWEEN #{fstDateOfMdate} AND #{lastDateOfMonth} THEN 1 ELSE NULL END) E1,
                COUNT(CASE WHEN ZZSHIP1 &gt; #{mdate} AND ZZSHIP1 &lt;= #{lastDateOfMonth} THEN 1 ELSE NULL END) P1,
                VALUE(SUM(CASE WHEN ZZSHIP1 &lt;= #{lastDateOfMonth} AND ZZCOMP2 &gt;= #{fstDateOfMdate}
                     THEN MH1
                     ELSE 0
                     END),0) MH1,
                VALUE(SUM(CASE WHEN LIFNR = ''
				               THEN 0
				               WHEN ACTSS <![CDATA[<>]]> '01' AND (LIFNR = '8001' OR LIFNR = '0000008001')
		             		   THEN 0
				               WHEN ZZSHIP1 &lt;= #{lastDateOfMonth} AND ZZCOMP2 &gt;= #{fstDateOfMdate}
		             		   THEN CP1
					           ELSE 0
				               END),0) CP1,
                CASE WHEN SUM(CASE WHEN LIFNR = ''
					               THEN 0
					               WHEN ACTSS <![CDATA[<>]]> '01' AND (LIFNR = '8001' OR LIFNR = '0000008001')
		             			   THEN 0
					               WHEN ZZSHIP1 &lt;= #{lastDateOfMonth} AND ZZCOMP2 &gt;= #{fstDateOfMdate}
			             		   THEN CP1
						           ELSE 0
					               END) = 0 THEN 0 ELSE SUM(CASE WHEN ZZSHIP1 &lt;= #{lastDateOfMonth} AND ZZCOMP2 &gt;= #{fstDateOfMdate}
											                     THEN MH1
											                     ELSE 0
											                     END) * 100 / SUM(CASE WHEN LIFNR = ''
																	              THEN 0
																	              WHEN ACTSS <![CDATA[<>]]> '01' AND (LIFNR = '8001' OR LIFNR = '0000008001')
		             			 												  THEN 0
																	              WHEN ZZSHIP1 &lt;= #{lastDateOfMonth} AND ZZCOMP2 &gt;= #{fstDateOfMdate}
															             		   THEN CP1
																		           ELSE 0
																	              END) END L1,
                COUNT(CASE WHEN ZZSHIP1 BETWEEN #{fstDateOf1thNextMonth} AND #{lastDateOf1thNextMonth} THEN 1 ELSE NULL END) E2,
                VALUE(SUM(CASE WHEN ZZSHIP1 &lt;= #{lastDateOf1thNextMonth} AND ZZCOMP2 &gt;= #{fstDateOf1thNextMonth}
                     THEN MH2
                     ELSE 0
                     END),0) MH2,
                VALUE(SUM(CASE WHEN LIFNR = ''
				               THEN 0
				               WHEN ACTSS <![CDATA[<>]]> '01' AND (LIFNR = '8001' OR LIFNR = '0000008001')
		             		   THEN 0
				               WHEN ZZSHIP1 &lt;= #{lastDateOf1thNextMonth} AND ZZCOMP2 &gt;= #{fstDateOf1thNextMonth}
					           THEN CP2
					           ELSE 0
				               END),0) CP2,
                CASE WHEN SUM(CASE WHEN LIFNR = ''
					               THEN 0
					               WHEN ACTSS <![CDATA[<>]]> '01' AND (LIFNR = '8001' OR LIFNR = '0000008001')
		             			   THEN 0
					               WHEN ZZSHIP1 &lt;= #{lastDateOf1thNextMonth} AND ZZCOMP2 &gt;= #{fstDateOf1thNextMonth}
						           THEN CP2
						           ELSE 0
					               END) = 0 THEN 0 ELSE SUM(CASE WHEN ZZSHIP1 &lt;= #{lastDateOf1thNextMonth} AND ZZCOMP2 &gt;= #{fstDateOf1thNextMonth}
											                     THEN MH2
											                     ELSE 0
											                     END) * 100 / SUM(CASE WHEN LIFNR = ''
																	              THEN 0
																	              WHEN ACTSS <![CDATA[<>]]> '01' AND (LIFNR = '8001' OR LIFNR = '0000008001')
		             			 												  THEN 0
																	              WHEN ZZSHIP1 &lt;= #{lastDateOf1thNextMonth} AND ZZCOMP2 &gt;= #{fstDateOf1thNextMonth}
																		           THEN CP2
																		           ELSE 0
																	              END) END L2,
                COUNT(CASE WHEN ZZSHIP1 BETWEEN #{fstDateOf2thNextMonth} AND #{lastDateOf2thNextMonth} THEN 1 ELSE NULL END) E3,
                VALUE(SUM(CASE WHEN ZZSHIP1 &lt;= #{lastDateOf2thNextMonth} AND ZZCOMP2 &gt;= #{fstDateOf2thNextMonth}
                     THEN MH3
                     ELSE 0
                     END),0) MH3,
                VALUE(SUM(CASE WHEN LIFNR = ''
				               THEN 0
				               WHEN ACTSS <![CDATA[<>]]> '01' AND (LIFNR = '8001' OR LIFNR = '0000008001')
		             		   THEN 0
				               WHEN ZZSHIP1 &lt;= #{lastDateOf2thNextMonth} AND ZZCOMP2 &gt;= #{fstDateOf2thNextMonth}
					           THEN CP3
					           ELSE 0
				               END),0) CP3,
                CASE WHEN SUM(CASE WHEN LIFNR = ''
					               THEN 0
					               WHEN ACTSS <![CDATA[<>]]> '01' AND (LIFNR = '8001' OR LIFNR = '0000008001')
		             			   THEN 0
					               WHEN ZZSHIP1 &lt;= #{lastDateOf2thNextMonth} AND ZZCOMP2 &gt;= #{fstDateOf2thNextMonth}
						           THEN CP3
						           ELSE 0
					               END) = 0 THEN 0 ELSE SUM(CASE WHEN ZZSHIP1 &lt;= #{lastDateOf2thNextMonth} AND ZZCOMP2 &gt;= #{fstDateOf2thNextMonth}
											                     THEN MH3
											                     ELSE 0
											                     END) * 100 / SUM(CASE WHEN LIFNR = ''
																	              THEN 0
																	              WHEN ACTSS <![CDATA[<>]]> '01' AND (LIFNR = '8001' OR LIFNR = '0000008001')
		             			 												  THEN 0
																	              WHEN ZZSHIP1 &lt;= #{lastDateOf2thNextMonth} AND ZZCOMP2 &gt;= #{fstDateOf2thNextMonth}
																		           THEN CP3
																		           ELSE 0
																	              END) END L3
            FROM SAPHEE.${tableName} T1
            LEFT OUTER JOIN SUMMARY T0 ON (T1.MANDT = T0.MANDT AND T1.PSPID = T0.PSPID AND T1.POSID = T0.POSID)
            GROUP BY GRUP
            UNION ALL
            SELECT
                1 GUBUN,
                '현대EL' AS GRUP,
                0 AS GRUP2,
                1 AS ZORD,
                '' ACTSS,
                '' ACTSS_NM,
                COUNT(CASE WHEN T1.ZZCHAKG = 'X' THEN 1 ELSE NULL END) AS HCNT,
                (
		        	SELECT AVG(PRO_R)
		        	  FROM SAPHEE.${tableName} AS X
		        	 WHERE X.MANDT = '183'
		        	   AND X.PRO_R <![CDATA[<>]]> 0
		        	   AND X.ZZSHIP1 BETWEEN #{fstDateOfMdate} AND #{lastDateOfMonth}
		        ) PRO_R,
                SUM(TOT_MH * CAST(1 - (PRO_R / 100) AS DOUBLE)) MH,
                VALUE(SUM(MH0),0) MH0,
                VALUE(SUM(CP0),0) CP0,
                CASE WHEN SUM(CP0) = 0 THEN 0 ELSE SUM(MH0) * 100 / SUM(CP0) END AS "LOAD",
                (SELECT COUNT(T2.PERNO) FROM INWON T2) BINWON,

                COUNT(CASE WHEN ZZSHIP1 BETWEEN #{fstDateOfMdate} AND #{lastDateOfMonth} THEN 1 ELSE NULL END) E1,
                COUNT(CASE WHEN ZZSHIP1 &gt; #{mdate} AND ZZSHIP1 &lt;= #{lastDateOfMonth} THEN 1 ELSE NULL END) P1,
                VALUE(SUM(CASE WHEN ZZSHIP1 &lt;= #{lastDateOfMonth} AND ZZCOMP2 &gt;= #{fstDateOfMdate}
                     THEN MH1
                     ELSE 0
                     END),0) MH1,
                VALUE(SUM(CASE WHEN LIFNR = ''
				               THEN 0
				               WHEN ACTSS <![CDATA[<>]]> '01' AND (LIFNR = '8001' OR LIFNR = '0000008001')
		             		   THEN 0
				               WHEN ZZSHIP1 &lt;= #{lastDateOfMonth} AND ZZCOMP2 &gt;= #{fstDateOfMdate}
		             		   THEN CP1
					           ELSE 0
				               END),0) CP1,
                CASE WHEN SUM(CASE WHEN LIFNR = ''
					               THEN 0
					               WHEN ACTSS <![CDATA[<>]]> '01' AND (LIFNR = '8001' OR LIFNR = '0000008001')
		             			   THEN 0
					               WHEN ZZSHIP1 &lt;= #{lastDateOfMonth} AND ZZCOMP2 &gt;= #{fstDateOfMdate}
			             		   THEN CP1
						           ELSE 0
					               END) = 0 THEN 0 ELSE SUM(CASE WHEN ZZSHIP1 &lt;= #{lastDateOfMonth} AND ZZCOMP2 &gt;= #{fstDateOfMdate}
											                     THEN MH1
											                     ELSE 0
											                     END) * 100 / SUM(CASE WHEN LIFNR = ''
																	               THEN 0
																	               WHEN ACTSS <![CDATA[<>]]> '01' AND (LIFNR = '8001' OR LIFNR = '0000008001')
		             			 												   THEN 0
																	               WHEN ZZSHIP1 &lt;= #{lastDateOfMonth} AND ZZCOMP2 &gt;= #{fstDateOfMdate}
															             		   THEN CP1
																		           ELSE 0
																	               END) END L1,
                COUNT(CASE WHEN ZZSHIP1 BETWEEN #{fstDateOf1thNextMonth} AND #{lastDateOf1thNextMonth} THEN 1 ELSE NULL END) E2,
                VALUE(SUM(CASE WHEN ZZSHIP1 &lt;= #{lastDateOf1thNextMonth} AND ZZCOMP2 &gt;= #{fstDateOf1thNextMonth}
                     THEN MH2
                     ELSE 0
                     END),0) MH2,
                VALUE(SUM(CASE WHEN LIFNR = ''
				               THEN 0
				               WHEN ACTSS <![CDATA[<>]]> '01' AND (LIFNR = '8001' OR LIFNR = '0000008001')
		             		   THEN 0
				               WHEN ZZSHIP1 &lt;= #{lastDateOf1thNextMonth} AND ZZCOMP2 &gt;= #{fstDateOf1thNextMonth}
					           THEN CP2
					           ELSE 0
				               END),0) CP2,
                CASE WHEN SUM(CASE WHEN LIFNR = ''
					               THEN 0
					               WHEN ACTSS <![CDATA[<>]]> '01' AND (LIFNR = '8001' OR LIFNR = '0000008001')
		             			   THEN 0
					               WHEN ZZSHIP1 &lt;= #{lastDateOf1thNextMonth} AND ZZCOMP2 &gt;= #{fstDateOf1thNextMonth}
						           THEN CP2
						           ELSE 0
					               END) = 0 THEN 0 ELSE SUM(CASE WHEN ZZSHIP1 &lt;= #{lastDateOf1thNextMonth} AND ZZCOMP2 &gt;= #{fstDateOf1thNextMonth}
											                     THEN MH2
											                     ELSE 0
											                     END) * 100 / SUM(CASE WHEN LIFNR = ''
																	               THEN 0
																	               WHEN ACTSS <![CDATA[<>]]> '01' AND (LIFNR = '8001' OR LIFNR = '0000008001')
		             			 												   THEN 0
																	               WHEN ZZSHIP1 &lt;= #{lastDateOf1thNextMonth} AND ZZCOMP2 &gt;= #{fstDateOf1thNextMonth}
																		           THEN CP2
																		           ELSE 0
																	               END) END L2,
                COUNT(CASE WHEN ZZSHIP1 BETWEEN #{fstDateOf2thNextMonth} AND #{lastDateOf2thNextMonth} THEN 1 ELSE NULL END) E3,
                VALUE(SUM(CASE WHEN ZZSHIP1 &lt;= #{lastDateOf2thNextMonth} AND ZZCOMP2 &gt;= #{fstDateOf2thNextMonth}
                     THEN MH3
                     ELSE 0
                     END),0) MH3,
                VALUE(SUM(CASE WHEN LIFNR = ''
				               THEN 0
				               WHEN ACTSS <![CDATA[<>]]> '01' AND (LIFNR = '8001' OR LIFNR = '0000008001')
		             		   THEN 0
				               WHEN ZZSHIP1 &lt;= #{lastDateOf2thNextMonth} AND ZZCOMP2 &gt;= #{fstDateOf2thNextMonth}
					           THEN CP3
					           ELSE 0
				               END),0) CP3,
                CASE WHEN SUM(CASE WHEN LIFNR = ''
					               THEN 0
					               WHEN ACTSS <![CDATA[<>]]> '01' AND (LIFNR = '8001' OR LIFNR = '0000008001')
		             			   THEN 0
					               WHEN ZZSHIP1 &lt;= #{lastDateOf2thNextMonth} AND ZZCOMP2 &gt;= #{fstDateOf2thNextMonth}
						           THEN CP3
						           ELSE 0
					               END) = 0 THEN 0 ELSE SUM(CASE WHEN ZZSHIP1 &lt;= #{lastDateOf2thNextMonth} AND ZZCOMP2 &gt;= #{fstDateOf2thNextMonth}
											                     THEN MH3
											                     ELSE 0
											                     END) * 100 / SUM(CASE WHEN LIFNR = ''
																	               THEN 0
																	               WHEN ACTSS <![CDATA[<>]]> '01' AND (LIFNR = '8001' OR LIFNR = '0000008001')
		             			 												   THEN 0
																	               WHEN ZZSHIP1 &lt;= #{lastDateOf2thNextMonth} AND ZZCOMP2 &gt;= #{fstDateOf2thNextMonth}
																		           THEN CP3
																		           ELSE 0
																	               END) END L3
            FROM SAPHEE.${tableName} T1
            LEFT OUTER JOIN SUMMARY T0 ON (T1.MANDT = T0.MANDT AND T1.PSPID = T0.PSPID AND T1.POSID = T0.POSID)
        ) T
        ORDER BY GRUP2, ZORD, ACTSS
        <if test="DB2.equals(true)">
        FOR FETCH ONLY
        WITH UR
        </if>
    </select>

    <select id="selectGrupByActss" parameterType="hdel.ps.domain.PS17ParamVO" resultType="HashMap">
        SELECT CODE2 AS ACTSS,
               DTEXT4 AS GRUP
        FROM SAPHEE.ZLCODE
        WHERE MANDT = '183'
          AND LANG = 'ko'
          AND CODE1 = 'PS003'
        <if test="DB2.equals(true)">
        FOR FETCH ONLY
        WITH UR
        </if>
    </select>

    <select id="selectHoliday" parameterType="hdel.ps.domain.PS17ParamVO" resultType="HashMap">
        SELECT * FROM DB2WEB.TB_HOLIDAY
        WHERE HOLIDAY_YMD &gt; '20200101'
        FOR FETCH ONLY
        WITH UR
    </select>

    <select id="selectZPSTW1703" parameterType="hdel.ps.domain.PS17ParamVO" resultType="hdel.ps.domain.ZPSTW1703">
        SELECT * FROM SAPHEE.ZPSTW1703
    <if test="DB2.equals(true)">
        FOR FETCH ONLY
        WITH UR
    </if>
    </select>

    <select id="selectZPSTW1704" parameterType="hdel.ps.domain.PS17ParamVO" resultType="hdel.ps.domain.ZPSTW1704">
        SELECT * FROM SAPHEE.ZPSTW1704
    <if test="DB2.equals(true)">
        FOR FETCH ONLY
        WITH UR
    </if>
    </select>

    <select id="selectZPSTW1705" parameterType="hdel.ps.domain.PS17ParamVO" resultType="hdel.ps.domain.ZPSTW1705">
        SELECT * FROM SAPHEE.ZPSTW1705
    <if test="DB2.equals(true)">
        FOR FETCH ONLY
        WITH UR
    </if>
    </select>

    <select id="selectZPSTW1706" parameterType="hdel.ps.domain.PS17ParamVO" resultType="hdel.ps.domain.ZPSTW1706">
        SELECT * FROM SAPHEE.ZPSTW1706
    <if test="DB2.equals(true)">
        FOR FETCH ONLY
        WITH UR
    </if>
    </select>

    <select id="selectZPSTW1707" parameterType="hdel.ps.domain.PS17ParamVO" resultType="hdel.ps.domain.ZPSTW1707">
        SELECT * FROM SAPHEE.ZPSTW1707
    <if test="DB2.equals(true)">
        FOR FETCH ONLY
        WITH UR
    </if>
    </select>

    <select id="selectZPSTW1708" parameterType="hdel.ps.domain.PS17ParamVO" resultType="hdel.ps.domain.ZPSTW1708">
        SELECT * FROM SAPHEE.ZPSTW1708
    <if test="DB2.equals(true)">
        FOR FETCH ONLY
        WITH UR
    </if>
    </select>

    <select id="selectZPSTW1709" parameterType="hdel.ps.domain.PS17ParamVO" resultType="hdel.ps.domain.ZPSTW1709">
        SELECT * FROM SAPHEE.ZPSTW1709
    <if test="DB2.equals(true)">
        FOR FETCH ONLY
        WITH UR
    </if>
    </select>

    <select id="selectZPSTW1710" parameterType="hdel.ps.domain.PS17ParamVO" resultType="hdel.ps.domain.ZPSTW1710">
        SELECT * FROM SAPHEE.ZPSTW1710
    <if test="DB2.equals(true)">
        FOR FETCH ONLY
        WITH UR
    </if>
    </select>

    <select id="selectZPSTW1711" parameterType="hdel.ps.domain.PS17ParamVO" resultType="hdel.ps.domain.ZPSTW1711">
        SELECT * FROM SAPHEE.ZPSTW1711
    <if test="DB2.equals(true)">
        FOR FETCH ONLY
        WITH UR
    </if>
    </select>

    <select id="selectZPSTW1712" parameterType="hdel.ps.domain.PS17ParamVO" resultType="hdel.ps.domain.ZPSTW1712">
        SELECT * FROM SAPHEE.ZPSTW1712
    <if test="DB2.equals(true)">
        FOR FETCH ONLY
        WITH UR
    </if>
    </select>

    <select id="selectGroupByTeamPlusMinus" parameterType="hdel.ps.domain.PS17ParamVO" resultType="HashMap">
        WITH PLUSMINUS AS (
           SELECT *
            FROM (SELECT T1.MANDT,
                       T1.GRUP,
                       T1.ACTSS,
                       T1.LIFNR,
                       MAX(T1.LIFNR_NM)                                            LIFNR_NM,
                       MAX(T1.ACTSS_ORG)                                           ACTSS_ORG,
                       MAX(T1.ACTSS_NM)                                            ACTSS_NM,
                       SUM(CASE WHEN CATEGORY = 'MH' THEN ${load} ELSE NULL END)       MH0,
                       SUM(CASE WHEN CATEGORY = 'MH' THEN ${l0} ELSE NULL END)        MH1,
                       SUM(CASE WHEN CATEGORY = 'MH' THEN ${l1} ELSE NULL END)        MH2,
                       SUM(CASE WHEN CATEGORY = 'MH' THEN ${l2} ELSE NULL END)        MH3,
                       SUM(CASE WHEN CATEGORY = 'Capacity' THEN ${load} ELSE NULL END) CP0,
                       SUM(CASE WHEN CATEGORY = 'Capacity' THEN ${l0} ELSE NULL END)  CP1,
                       SUM(CASE WHEN CATEGORY = 'Capacity' THEN ${l1} ELSE NULL END)  CP2,
                       SUM(CASE WHEN CATEGORY = 'Capacity' THEN ${l2} ELSE NULL END)  CP3
                FROM SAPHEE.${tableName} T1
                         INNER JOIN SAPHEE.${tableName2} T2 ON (T1.MANDT = T2.MANDT AND T1.PSPID = T2.PSPID AND T1.POSID = T2.POSID)
                WHERE T1.ACTSS &lt;&gt; T1.ACTSS_ORG
                  AND T1.ACTSS_ORG &gt; ''
                GROUP BY T1.MANDT, T1.GRUP, T1.ACTSS, T1.LIFNR
               ) T
            WHERE (MH0 = 0 AND CP0 &gt; 0)
             OR (MH1 = 0 AND CP1 &gt; 0)
             OR (MH2 = 0 AND CP2 &gt; 0)
             OR (MH3 = 0 AND CP3 &gt; 0)
        )
        SELECT 'P' GBN,
               (SELECT DTEXT4 FROM SAPHEE.ZLCODE WHERE MANDT = #{mandt} AND LANG = 'ko' AND CODE1 = 'PS003' AND CODE2 = ACTSS_ORG) GRUP,
               ACTSS_ORG                                                ACTSS,
               LIFNR,
               MAX(ACTSS_NM)                                                 ACTSS_NM,
               MAX(LIFNR_NM)                                                 LIFNR_NM,
               SUM(CASE WHEN (MH0 = 0 AND CP0 &gt; 0) THEN CP0 ELSE 0 END) CP0,
               SUM(CASE WHEN (MH1 = 0 AND CP1 &gt; 0) THEN CP1 ELSE 0 END) CP1,
               SUM(CASE WHEN (MH2 = 0 AND CP2 &gt; 0) THEN CP2 ELSE 0 END) CP2,
               SUM(CASE WHEN (MH3 = 0 AND CP3 &gt; 0) THEN CP3 ELSE 0 END) CP3
        FROM PLUSMINUS T
        WHERE LIFNR &lt;&gt; '0000008001'
        GROUP BY ACTSS_ORG, LIFNR
        UNION ALL
        SELECT 'M' AS GBN,
               (SELECT DTEXT4 FROM SAPHEE.ZLCODE WHERE MANDT = '183' AND LANG = 'ko' AND CODE1 = 'PS003' AND CODE2 = ACTSS) GRUP,
               ACTSS,
               LIFNR,
               MAX(ACTSS_NM)                                                 ACTSS_NM,
               MAX(LIFNR_NM)                                                 LIFNR_NM,
               SUM(CASE WHEN (MH0 = 0 AND CP0 &gt; 0) THEN CP0 ELSE 0 END) * -1 CP0,
               SUM(CASE WHEN (MH1 = 0 AND CP1 &gt; 0) THEN CP1 ELSE 0 END) * -1 CP1,
               SUM(CASE WHEN (MH2 = 0 AND CP2 &gt; 0) THEN CP2 ELSE 0 END) * -1 CP2,
               SUM(CASE WHEN (MH3 = 0 AND CP3 &gt; 0) THEN CP3 ELSE 0 END) * -1 CP3
        FROM PLUSMINUS T
        WHERE LIFNR &lt;&gt; '0000008001'
        GROUP BY ACTSS, LIFNR
            FOR FETCH ONLY
        WITH UR
    </select>

</mapper>
