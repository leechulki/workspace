<?xml version="1.0" encoding="euc-kr"?>
<query dynamic="true">
	<type>select</type>
	<description><![CDATA[]]></description>
	<reload>true</reload>
	<monitoring>true</monitoring>
	<result-count>1</result-count>
	<statement>
SELECT  A1.AREA CS136_ARA,
		CASE WHEN A1.LGORT = 'ZZZZ' THEN '총합계'
		     WHEN A1.LGORT = 'YYYY' THEN '지방계'
			 WHEN A1.LGORT = 'XXXX' THEN '지역계'
			 ELSE A1.AREA_NM
		END AREA_NM,
        A1.LGORT CS136_BSU,
		A1.LIFNR_NM,
		A1.CS136_HNO,
		CASE WHEN A1.CS136_HNO = 'G' THEN ''
			 ELSE A1.HNO_NM
		END HNO_NM,
		CASE WHEN A1.CS136_GND = 'I' OR A1.CS136_GND = 'J' OR A1.CS136_GND = 'K' THEN ''
			 ELSE A1.GND_NM
		END GND_NM,
		A1.CS136_GND,
        A1.AFLG,
        A1.BFLG,
		VALUE(B1.CS131_CNT,0) CS131_CNT,
		VALUE(B1.CS131_AMT,0) CS131_AMT,
		VALUE(B1.GISUNG_AMT,0) GISUNG_AMT,
		VALUE(B1.GONG_AMT,0) GONG_AMT,
		VALUE(B1.BUGA_AMT,0) BUGA_AMT,
		VALUE(B1.SUM_AMT,0) SUM_AMT
FROM
      (
        --지역,협력사,제품구분,보수구분(틀)
        SELECT  DISTINCT   'ZZ' ARA_GBN,
        		        'ZZ' AREA,
                        '' AREA_NM,
                        '' LIFNR,
                        '' LIFNR_NM,
                        'ZZZZ' LGORT,
                        D.CS136_HNO,
                        D.HNO_NM,
                        D.CS136_GND,
                        D.GND_NM,
                        D.AFLG,
                        D.BFLG,
                        '' ORD
                FROM   (SELECT MM028A.CODE2 AREA,
                               MM028A.CTEXT2 AREA_NM
                        FROM SAPHEE.ZLCODE MM028A
                        WHERE MM028A.MANDT = #G_MANDT#
                        AND MM028A.LANG = #G_LANG#
                        AND MM028A.CODE1 = 'CS115'
                       ) C,
                       (SELECT A.CODE2 CS136_HNO,
                               A.CTEXT2 HNO_NM,
                        	   B.CODE2 CS136_GND,
                        	   B.CTEXT2 GND_NM,
                        	   A.AFLG,
                        	   B.BFLG
                        FROM  (SELECT 'G' CODE2, '합계' CTEXT2, '5' AFLG FROM SYSIBM.SYSDUMMY1) A,
                              (SELECT 'K' CODE2, '총합계' CTEXT2, '5' BFLG FROM SYSIBM.SYSDUMMY1) B
                	   ) D
        UNION ALL
         SELECT  DISTINCT   'YY' ARA_GBN,
		        'YY' AREA,
                '' AREA_NM,
                '' LIFNR,
                '' LIFNR_NM,
                'YYYY' LGORT,
                D.CS136_HNO,
                D.HNO_NM,
                D.CS136_GND,
                D.GND_NM,
                D.AFLG,
                D.BFLG,
                '' ORD
        FROM   (SELECT MM028A.CODE2 AREA,
                       MM028A.CTEXT2 AREA_NM
                FROM SAPHEE.ZLCODE MM028A
                WHERE MM028A.MANDT = #G_MANDT#
                AND MM028A.LANG = #G_LANG#
                AND MM028A.CODE1 = 'CS115'
               ) C,
               (SELECT A.CODE2 CS136_HNO,
                       A.CTEXT2 HNO_NM,
                	   B.CODE2 CS136_GND,
                	   B.CTEXT2 GND_NM,
                	   A.AFLG,
                	   B.BFLG
                FROM  (SELECT 'G' CODE2, '합계' CTEXT2, '4' AFLG FROM SYSIBM.SYSDUMMY1) A,
                      (SELECT 'J' CODE2, '지방계' CTEXT2, '4' BFLG FROM SYSIBM.SYSDUMMY1) B
        	   ) D
        UNION ALL
         SELECT DISTINCT C.AREA||'1' ARA_GBN,C.AREA,
                C.AREA_NM,
                '' LIFNR,
                '' LIFNR_NM,
                'XXXX' LGORT,
                D.CS136_HNO,
                D.HNO_NM,
                D.CS136_GND,
                D.GND_NM,
                D.AFLG,
                D.BFLG,
                '' ORD
        FROM   (SELECT A.AREA,
                       A.AREA_NM,
                       B.LIFNR,
                       B.LIFNR_NM,
                       B.LGORT
                FROM
                       (SELECT MM028A.CODE2 AREA,
                               MM028A.CTEXT2 AREA_NM
                       FROM SAPHEE.ZLCODE MM028A
                       WHERE MM028A.MANDT = #G_MANDT#
                       AND MM028A.LANG = #G_LANG#
                       AND MM028A.CODE1 = 'CS115'
                       ) A,
                       (
                       SELECT MM012A.LIFNR,
                              MM012A.NAME1 LIFNR_NM,
                              MM005A.LGORT,
							  WB010A.BSU_ARA
                       FROM SAPHEE.ZWBT010 WB010A,
                            SAPHEE.ZMMT012 MM012A,
                            SAPHEE.ZMMT005 MM005A
                       WHERE WB010A.MANDT = #G_MANDT#
                       AND WB010A.MANDT = MM012A.MANDT
                       AND WB010A.LIFNR = MM012A.LIFNR
                       AND MM012A.MANDT = MM005A.MANDT
                       AND MM012A.LIFNR = MM005A.LIFNR
                       AND WB010A.BSU_GB = '3'
                       ) B
                 WHERE A.AREA = B.BSU_ARA
<isNotNull col="AREA">
                   AND A.AREA = #AREA#
</isNotNull>
               ) C,
               (SELECT A.CODE2 CS136_HNO,
                       A.CTEXT2 HNO_NM,
                	   B.CODE2 CS136_GND,
                	   B.CTEXT2 GND_NM,
                	   A.AFLG,
                	   B.BFLG
                FROM  (SELECT 'G' CODE2, '합계' CTEXT2, '3' AFLG FROM SYSIBM.SYSDUMMY1) A,
                      (SELECT 'I' CODE2, '지역계' CTEXT2, '3' BFLG FROM SYSIBM.SYSDUMMY1) B
        	   ) D
        UNION ALL
        SELECT  C.AREA||'0' ARA_GBN,
		        C.AREA,
                C.AREA_NM,
                C.LIFNR,
                C.LIFNR_NM,
                C.LGORT,
                D.CS136_HNO,
                D.HNO_NM,
                D.CS136_GND,
                D.GND_NM,
                D.AFLG,
                D.BFLG,
                D.ORD
        FROM
                (SELECT A.AREA,
                       A.AREA_NM,
                       B.LIFNR,
                       B.LIFNR_NM,
                       B.LGORT
                FROM
                       (SELECT MM028A.CODE2 AREA,
                               MM028A.CTEXT2 AREA_NM
                       FROM SAPHEE.ZLCODE MM028A
                       WHERE MM028A.MANDT = #G_MANDT#
                       AND MM028A.LANG = #G_LANG#
                       AND MM028A.CODE1 = 'CS115'
                       ) A,
                       (
                       SELECT MM012A.LIFNR,
                              MM012A.NAME1 LIFNR_NM,
                              MM005A.LGORT,
							  WB010A.BSU_ARA
                       FROM SAPHEE.ZWBT010 WB010A,
                            SAPHEE.ZMMT012 MM012A,
                            SAPHEE.ZMMT005 MM005A
                       WHERE WB010A.MANDT = #G_MANDT#
                       AND WB010A.MANDT = MM012A.MANDT
                       AND WB010A.LIFNR = MM012A.LIFNR
                       AND MM012A.MANDT = MM005A.MANDT
                       AND MM012A.LIFNR = MM005A.LIFNR
                       AND WB010A.BSU_GB = '3'
                       ) B
                 WHERE A.AREA = B.BSU_ARA
<isNotNull col="AREA">
                   AND A.AREA = #AREA#
</isNotNull>
                ) C,
                (
                SELECT A.CODE2 CS136_HNO,
                       A.CTEXT2 HNO_NM,
                	   B.CODE2 CS136_GND,
                	   B.CTEXT2 GND_NM,
                		A.AFLG,
                		B.BFLG,
                		B.ORD
                FROM
                      (
                        SELECT CODE2,CTEXT2,
                			   '1' AFLG
                        FROM SAPHEE.ZLCODE MM028A
                        WHERE MM028A.MANDT = #G_MANDT#
                        AND MM028A.LANG = #G_LANG#
                        AND MM028A.CODE1 = 'CS131'
                        UNION
                        SELECT 'G' CODE2, '합계' CTEXT2,
                			   '2' AFLG
                        FROM SYSIBM.SYSDUMMY1
                       ) A,
                       (
                        SELECT MM028B.CODE2,
                        	   CASE MM028B.CODE2 WHEN 'B' THEN '무상' WHEN 'F' THEN '소계' ELSE MM028B.CTEXT2 END CTEXT2,
                        	   CASE MM028B.CODE2 WHEN 'B' THEN '2' WHEN 'C' THEN '3' WHEN 'D' THEN '1' WHEN 'E' THEN '4' END ORD,
                			   '1' BFLG
                        FROM SAPHEE.ZLCODE MM028B
                        WHERE MM028B.MANDT = #G_MANDT#
                        AND MM028B.LANG = #G_LANG#
                        AND MM028B.CODE1 = 'CS135'
                        AND MM028B.CODE2 > 'A'
                        UNION ALL
                        SELECT 'H' CODE2,
                        	   '협력사계' CTEXT2,
                        	   '' ORD,
                			   '2' BFLG
                        FROM SYSIBM.SYSDUMMY1
                       ) B
                WHERE A.AFLG = B.BFLG
                ORDER BY A.CODE2,B.ORD
                ) D

       ) A1
	   LEFT OUTER JOIN
       (
        SELECT  CS136_ARA,
                CS136_BSU,
        		CS136_HNO,
        		CS136_GND,
        		SUM(CS131_CNT) CS131_CNT,
        		SUM(CS131_AMT) CS131_AMT,
        		CASE WHEN SUM(CS131_AMT) = 0 THEN 0
        			 WHEN SUM(CS131_AMT) > 0 THEN CEIL((DOUBLE(SUM(SUM_AMT))/DOUBLE(SUM(CS131_AMT)))*100)
        			 ELSE 0
        		END GISUNG_AMT,
        		SUM(GONG_AMT) GONG_AMT,
        	    SUM(BUGA_AMT) BUGA_AMT,
        		SUM(SUM_AMT) SUM_AMT
        FROM  (
                -- (발주(계약)종류(cs136_gnd) 가 'A','B','C','D','E'인 데이타의 지역,협력사,제품구분 보수구분별 합계
                SELECT  CS136_ARA,
                        CS136_BSU,
                		CS136_HNO,
                		CASE CS136_GND WHEN 'A' THEN 'B' ELSE CS136_GND END CS136_GND,
                		CS131_CNT,
                		CS131_AMT,
                		GISUNG_AMT,
                		GONG_AMT,
                	    BUGA_AMT,
                		SUM_AMT
                FROM   (
                        SELECT  CS136A.CS136_ARA,
                                CS136A.CS136_BSU,
                        		CASE WHEN SUBSTR(CS136A.CS136_HNO,1,1) = 'L' OR SUBSTR(CS136A.CS136_HNO,1,1) = 'S' OR SUBSTR(CS136A.CS136_HNO,1,1) = 'W' OR SUBSTR(CS136A.CS136_HNO,1,1) = 'Z' THEN 'A'
                        			 WHEN SUBSTR(CS136A.CS136_HNO,1,1) = 'J' THEN 'B'
                        			 WHEN SUBSTR(CS136A.CS136_HNO,1,1) = 'M' THEN 'C'
                        			 WHEN SUBSTR(CS136A.CS136_HNO,1,1) = 'G' THEN 'D'
                        		END CS136_HNO,
                        		CS136A.CS136_GND CS136_GND,
                        		CASE WHEN CS136A.CS136_GND IN ('A','B')
                        			 	  THEN VALUE(COUNT(CS136A.MANDT),0)
                        			 WHEN CS136A.CS136_GND IN ('C','D','E')
                        			 	 THEN VALUE(COUNT(CS136A.MANDT),0)
                        		     ELSE 0
                        		END CS131_CNT,
                        		CASE WHEN CS136A.CS136_GND IN ('A','B')
                        			 	  THEN 0
                        			 WHEN CS136A.CS136_GND IN ('C','D','E')
                        			 	  THEN VALUE(SUM(CS131A.CS131_AMT),0)
                        			 ELSE 0
                        		END CS131_AMT,
                        		CASE WHEN CS136A.CS136_GND IN ('A','B')
                        			 	  THEN 0
                        			 WHEN (CS136A.CS136_GND IN ('C','D','E')) AND VALUE(SUM(CS131A.CS131_AMT),0) > 0
                        			 	  THEN CEIL(VALUE((DOUBLE(SUM(CS136A.CS136_BAM)+SUM(CS136A.CS136_IY1)+SUM(CS136A.CS136_IY2)+SUM(CS136A.CS136_IY3)+SUM(CS136A.CS136_IY4)+SUM(CS136A.CS136_RET))/DOUBLE(SUM(CS131A.CS131_AMT)))*100,0))
                        			 ELSE 0
                        		END GISUNG_AMT,
	                       		CASE WHEN CS136A.CS136_GND BETWEEN 'A' AND 'E'
                            	 	  THEN VALUE(SUM(CS136A.CS136_BAM)+SUM(CS136A.CS136_IY1)+SUM(CS136A.CS136_IY2)+SUM(CS136A.CS136_IY3)+SUM(CS136A.CS136_IY4)+SUM(CS136A.CS136_RET),0)
                                	 ELSE 0
                                END GONG_AMT,
                                CASE WHEN CS136A.CS136_GND BETWEEN 'A' AND 'E'
                                	 	  THEN CEIL(VALUE(DOUBLE(SUM(CS136A.CS136_BAM)+SUM(CS136A.CS136_IY1)+SUM(CS136A.CS136_IY2)+SUM(CS136A.CS136_IY3)+SUM(CS136A.CS136_IY4)+SUM(CS136A.CS136_RET))*1.1,0)) - 
                                	 	       VALUE(SUM(CS136A.CS136_BAM)+SUM(CS136A.CS136_IY1)+SUM(CS136A.CS136_IY2)+SUM(CS136A.CS136_IY3)+SUM(CS136A.CS136_IY4)+SUM(CS136A.CS136_RET),0)
                                     ELSE 0
                                END BUGA_AMT,
                                CASE WHEN CS136A.CS136_GND BETWEEN 'A' AND 'E'
                                	 	  THEN CEIL(VALUE(DOUBLE(SUM(CS136A.CS136_BAM)+SUM(CS136A.CS136_IY1)+SUM(CS136A.CS136_IY2)+SUM(CS136A.CS136_IY3)+SUM(CS136A.CS136_IY4)+SUM(CS136A.CS136_RET))*1.1,0))
                                	 ELSE 0
                                END SUM_AMT
                        FROM SAPHEE.ZCST136 CS136A
                                    LEFT OUTER JOIN SAPHEE.ZCST131 CS131A ON CS136A.MANDT = CS131A.MANDT
                                                                       	 AND CS136A.CS136_BSU = CS131A.CS131_BSU
                                                                         AND CS136A.CS136_HNO = CS131A.CS131_HNO
	                                                                 AND CS136A.CS136_ARA = CS131A.CS131_ARA
                                                                         AND CS136A.CS136_GND = CS131A.CS131_GND
                                                                         AND CS136A.CS136_JYM = CS131A.CS131_MYM
                                                                         AND CS136A.CS136_UPN = CS131A.CS131_UPN
                                                                         AND CS136A.CS136_CST = CS131A.CS131_CST
                                                                         AND CS136A.CS136_PJT = CS131A.CS131_PJT
                                                                         AND CS136A.CS136_HNO = CS131A.CS131_HNO
                                                                         AND CS136A.CS136_SEQ = CS131A.CS131_SEQ
                                                                         AND CS136A.CS136_ISR = CS131A.CS131_ISR
                                                                         AND CS131A.CS131_ARA LIKE '_%'
                                                                         AND CS131A.CS131_BSU LIKE '_%'
<isNotNull col="AREA">
                                                                         AND CS131A.CS131_ARA = #AREA#
</isNotNull>
--                                                                         AND CS131A.CS131_YYM BETWEEN #YYYYMMF# AND #YYYYMMT#
                                                                         AND CS131A.CS131_GBU = '3'
                        WHERE CS136A.MANDT = #G_MANDT#
                        AND CS136A.CS136_GYM BETWEEN #YYYYMMF# AND #YYYYMMT#
                        AND CS136A.CS136_GBU = '3'
                        AND CS136A.CS136_PST = 'A6'
                        AND CS136A.CS136_MGB = ''
                        AND CS136A.CS136_GNO > ''
                	AND CS136A.CS136_ARA LIKE '_%'
                	AND CS136A.CS136_BSU LIKE '_%'
<isNotNull col="AREA">
                	AND CS136A.CS136_ARA = #AREA#
</isNotNull>
                	AND (CS131A.CS131_MYB IS NULL OR CS131A.CS131_MYB = '')
                        AND (CS131A.VBELN IS NULL OR CS131A.VBELN > '')
                        AND SUBSTR(CS136A.CS136_HNO,1,1) IN ('L','S','W','Z','G','J')
                        GROUP BY CS136A.CS136_ARA,
                                 CS136A.CS136_BSU,
                		         CASE WHEN SUBSTR(CS136A.CS136_HNO,1,1) = 'L' OR SUBSTR(CS136A.CS136_HNO,1,1) = 'S' OR SUBSTR(CS136A.CS136_HNO,1,1) = 'W' OR SUBSTR(CS136A.CS136_HNO,1,1) = 'Z' THEN 'A'
                        		 	  WHEN SUBSTR(CS136A.CS136_HNO,1,1) = 'J' THEN 'B'
                        		 	  WHEN SUBSTR(CS136A.CS136_HNO,1,1) = 'M' THEN 'C'
                        		 	  WHEN SUBSTR(CS136A.CS136_HNO,1,1) = 'G' THEN 'D'
                        		 END,
                        		 CS136A.CS136_GND
                       ) H

                UNION ALL

                -- (발주(계약)종류(cs136_gnd) 가 'A','B','C','D','E'인 데이타의 지역,협력사,제품구분별 소계
                SELECT  CS136_ARA,
                        CS136_BSU,
                		CS136_HNO,
                		'F' CS136_GND,
                		SUM(CS131_CNT) CS131_CNT,
                		SUM(CS131_AMT) CS131_AMT,
                		CASE WHEN SUM(CS131_AMT) = 0 THEN 0
                			 WHEN SUM(CS131_AMT) > 0 THEN CEIL((DOUBLE(SUM(SUM_AMT))/DOUBLE(SUM(CS131_AMT)))*100)
                			 ELSE 0
                		END GISUNG_AMT,
                		SUM(GONG_AMT) GONG_AMT,
                	    SUM(BUGA_AMT) BUGA_AMT,
                		SUM(SUM_AMT) SUM_AMT
                FROM (
                        SELECT  CS136A.CS136_ARA,
                                CS136A.CS136_BSU,
                        		CASE WHEN SUBSTR(CS136A.CS136_HNO,1,1) = 'L' OR SUBSTR(CS136A.CS136_HNO,1,1) = 'S' OR SUBSTR(CS136A.CS136_HNO,1,1) = 'W' OR SUBSTR(CS136A.CS136_HNO,1,1) = 'Z' THEN 'A'
                        			 WHEN SUBSTR(CS136A.CS136_HNO,1,1) = 'J' THEN 'B'
                        			 WHEN SUBSTR(CS136A.CS136_HNO,1,1) = 'M' THEN 'C'
                        			 WHEN SUBSTR(CS136A.CS136_HNO,1,1) = 'G' THEN 'D'
                        		END CS136_HNO,
                        		CS136A.CS136_GND CS136_GND,
                        		CASE WHEN CS136A.CS136_GND IN ('A','B')
                        			 	  THEN VALUE(COUNT(CS136A.MANDT),0)
                        			 WHEN CS136A.CS136_GND IN ('C','D','E')
                        			 	 THEN VALUE(COUNT(CS136A.MANDT),0)
                        		     ELSE 0
                        		END CS131_CNT,
                        		CASE WHEN CS136A.CS136_GND IN ('A','B')
                        			 	  THEN 0
                        			 WHEN CS136A.CS136_GND IN ('C','D','E')
                        			 	  THEN VALUE(SUM(CS131A.CS131_AMT),0)
                        			 ELSE 0
                        		END CS131_AMT,
                        		0 GISUNG_AMT,
                        		CASE WHEN CS136A.CS136_GND BETWEEN 'A' AND 'E'
                            	 	  THEN VALUE(SUM(CS136A.CS136_BAM)+SUM(CS136A.CS136_IY1)+SUM(CS136A.CS136_IY2)+SUM(CS136A.CS136_IY3)+SUM(CS136A.CS136_IY4)+SUM(CS136A.CS136_RET),0)
                                	 ELSE 0
                                END GONG_AMT,
                                CASE WHEN CS136A.CS136_GND BETWEEN 'A' AND 'E'
                                	 	  THEN CEIL(VALUE(DOUBLE(SUM(CS136A.CS136_BAM)+SUM(CS136A.CS136_IY1)+SUM(CS136A.CS136_IY2)+SUM(CS136A.CS136_IY3)+SUM(CS136A.CS136_IY4)+SUM(CS136A.CS136_RET))*1.1,0)) - 
                                	 	       VALUE(SUM(CS136A.CS136_BAM)+SUM(CS136A.CS136_IY1)+SUM(CS136A.CS136_IY2)+SUM(CS136A.CS136_IY3)+SUM(CS136A.CS136_IY4)+SUM(CS136A.CS136_RET),0)
                                     ELSE 0
                                END BUGA_AMT,
                                CASE WHEN CS136A.CS136_GND BETWEEN 'A' AND 'E'
                                	 	  THEN CEIL(VALUE(DOUBLE(SUM(CS136A.CS136_BAM)+SUM(CS136A.CS136_IY1)+SUM(CS136A.CS136_IY2)+SUM(CS136A.CS136_IY3)+SUM(CS136A.CS136_IY4)+SUM(CS136A.CS136_RET))*1.1,0))
                                	 ELSE 0
                                END SUM_AMT
                        FROM SAPHEE.ZCST136 CS136A
                                    LEFT OUTER JOIN SAPHEE.ZCST131 CS131A ON CS136A.MANDT = CS131A.MANDT
                                                                       	 AND CS136A.CS136_BSU = CS131A.CS131_BSU
                                                                         AND CS136A.CS136_HNO = CS131A.CS131_HNO
	                                                                 AND CS136A.CS136_ARA = CS131A.CS131_ARA
                                                                         AND CS136A.CS136_GND = CS131A.CS131_GND
                                                                         AND CS136A.CS136_JYM = CS131A.CS131_MYM
                                                                         AND CS136A.CS136_UPN = CS131A.CS131_UPN
                                                                         AND CS136A.CS136_CST = CS131A.CS131_CST
                                                                         AND CS136A.CS136_PJT = CS131A.CS131_PJT
                                                                         AND CS136A.CS136_HNO = CS131A.CS131_HNO
                                                                         AND CS136A.CS136_SEQ = CS131A.CS131_SEQ
                                                                         AND CS136A.CS136_ISR = CS131A.CS131_ISR
                                                                         AND CS131A.CS131_ARA LIKE '_%'
                                                                         AND CS131A.CS131_BSU LIKE '_%'
<isNotNull col="AREA">
                                                                         AND CS131A.CS131_ARA = #AREA#
</isNotNull>
--                                                                         AND CS131A.CS131_YYM BETWEEN #YYYYMMF# AND #YYYYMMT#
                                                                         AND CS131A.CS131_GBU = '3'
                        WHERE CS136A.MANDT = #G_MANDT#
                        AND CS136A.CS136_GYM BETWEEN #YYYYMMF# AND #YYYYMMT#
                        AND CS136A.CS136_GBU = '3'
                        AND CS136A.CS136_PST = 'A6'
                        AND CS136A.CS136_MGB = ''
                        AND CS136A.CS136_GNO > ''
        	    	AND CS136A.CS136_ARA LIKE '_%'
        	    	AND CS136A.CS136_BSU LIKE '_%'
<isNotNull col="AREA">
        	    	AND CS136A.CS136_ARA = #AREA#
</isNotNull>
        	    	AND (CS131A.CS131_MYB IS NULL OR CS131A.CS131_MYB = '')
                        AND (CS131A.VBELN IS NULL OR CS131A.VBELN > '')
                        AND SUBSTR(CS136A.CS136_HNO,1,1) IN ('L','S','W','Z','G','J')
                        GROUP BY CS136A.CS136_ARA,
                                 CS136A.CS136_BSU,
                		         CASE WHEN SUBSTR(CS136A.CS136_HNO,1,1) = 'L' OR SUBSTR(CS136A.CS136_HNO,1,1) = 'S' OR SUBSTR(CS136A.CS136_HNO,1,1) = 'W' OR SUBSTR(CS136A.CS136_HNO,1,1) = 'Z' THEN 'A'
                        		 	  WHEN SUBSTR(CS136A.CS136_HNO,1,1) = 'J' THEN 'B'
                        		 	  WHEN SUBSTR(CS136A.CS136_HNO,1,1) = 'M' THEN 'C'
                        		 	  WHEN SUBSTR(CS136A.CS136_HNO,1,1) = 'G' THEN 'D'
                        		 END,
                        		 CS136A.CS136_GND
                )   A
                GROUP BY CS136_ARA,CS136_BSU,CS136_HNO

                UNION ALL

                -- (발주(계약)종류(cs136_gnd) 가 'F'인 데이타의 지역,협력사,제품구분 보수구분별 합계(부품판매인건비)
                SELECT  CS136_ARA,
                        CS136_BSU,
                		'G' CS136_HNO,
                		'G' CS136_GND,
                		CS131_CNT,
                		CS131_AMT,
                		GISUNG_AMT,
                		GONG_AMT,
                	    BUGA_AMT,
                		SUM_AMT
                FROM (
                		SELECT  CS136A.CS136_ARA,
                                CS136A.CS136_BSU,
                        		CASE WHEN SUBSTR(CS136A.CS136_HNO,1,1) = 'L' OR SUBSTR(CS136A.CS136_HNO,1,1) = 'S' OR SUBSTR(CS136A.CS136_HNO,1,1) = 'W' OR SUBSTR(CS136A.CS136_HNO,1,1) = 'Z' THEN 'A'
                        			 WHEN SUBSTR(CS136A.CS136_HNO,1,1) = 'J' THEN 'B'
                        			 WHEN SUBSTR(CS136A.CS136_HNO,1,1) = 'M' THEN 'C'
                        			 WHEN SUBSTR(CS136A.CS136_HNO,1,1) = 'G' THEN 'D'
                        		END CS136_HNO,
                        		CS136A.CS136_GND CS136_GND,
                        		0 CS131_CNT,
                        		0 CS131_AMT,
                        		0 GISUNG_AMT,
                        		VALUE(DOUBLE(SUM(CS136A.CS136_BAM)+SUM(CS136A.CS136_IY1)+SUM(CS136A.CS136_IY2)+SUM(CS136A.CS136_IY3)+SUM(CS136A.CS136_IY4)+SUM(CS136A.CS136_RET)),0) GONG_AMT,
                       		    CEIL(VALUE(DOUBLE(SUM(CS136A.CS136_BAM)+SUM(CS136A.CS136_IY1)+SUM(CS136A.CS136_IY2)+SUM(CS136A.CS136_IY3)+SUM(CS136A.CS136_IY4)+SUM(CS136A.CS136_RET))*1.1,0)) - 
                                	 	       VALUE(SUM(CS136A.CS136_BAM)+SUM(CS136A.CS136_IY1)+SUM(CS136A.CS136_IY2)+SUM(CS136A.CS136_IY3)+SUM(CS136A.CS136_IY4)+SUM(CS136A.CS136_RET),0) BUGA_AMT,
                        		CEIL(VALUE(DOUBLE(SUM(CS136A.CS136_BAM)+SUM(CS136A.CS136_IY1)+SUM(CS136A.CS136_IY2)+SUM(CS136A.CS136_IY3)+SUM(CS136A.CS136_IY4)+SUM(CS136A.CS136_RET))*1.1,0)) SUM_AMT
                        FROM SAPHEE.ZCST136 CS136A
                                    LEFT OUTER JOIN SAPHEE.ZCST131 CS131A ON CS136A.MANDT = CS131A.MANDT
                                                                       	 AND CS136A.CS136_BSU = CS131A.CS131_BSU
                                                                         AND CS136A.CS136_HNO = CS131A.CS131_HNO
	                                                                 AND CS136A.CS136_ARA = CS131A.CS131_ARA
                                                                         AND CS136A.CS136_GND = CS131A.CS131_GND
                                                                         AND CS136A.CS136_JYM = CS131A.CS131_MYM
                                                                         AND CS136A.CS136_UPN = CS131A.CS131_UPN
                                                                         AND CS136A.CS136_CST = CS131A.CS131_CST
                                                                         AND CS136A.CS136_PJT = CS131A.CS131_PJT
                                                                         AND CS136A.CS136_HNO = CS131A.CS131_HNO
                                                                         AND CS136A.CS136_SEQ = CS131A.CS131_SEQ
                                                                         AND CS136A.CS136_ISR = CS131A.CS131_ISR
                                                                         AND CS131A.CS131_ARA LIKE '_%'
                                                                         AND CS131A.CS131_BSU LIKE '_%'
<isNotNull col="AREA">
                                                                         AND CS131A.CS131_ARA = #AREA#
</isNotNull>
--                                                                         AND CS131A.CS131_YYM BETWEEN #YYYYMMF# AND #YYYYMMT#
                                                                         AND CS131A.CS131_GBU = '3'
                        WHERE CS136A.MANDT = #G_MANDT#
                        AND CS136A.CS136_GYM BETWEEN #YYYYMMF# AND #YYYYMMT#
                        AND CS136A.CS136_GBU = '3'
                        AND CS136A.CS136_PST = 'A6'
                        AND CS136A.CS136_MGB = ''
                        AND CS136A.CS136_GNO > ''
                        AND CS136A.CS136_GND = 'F'
                	AND CS136A.CS136_ARA LIKE '_%'
                	AND CS136A.CS136_BSU LIKE '_%'
<isNotNull col="AREA">
                	AND CS136A.CS136_ARA = #AREA#
</isNotNull>
                        AND CS136A.CS136_GND = 'F'
                        AND (CS131A.CS131_MYB IS NULL OR CS131A.CS131_MYB = '')
                        AND (CS131A.VBELN IS NULL OR CS131A.VBELN > '')
                        AND SUBSTR(CS136A.CS136_HNO,1,1) IN ('L','S','W','Z','G','J')
                        GROUP BY CS136A.CS136_ARA,
                                 CS136A.CS136_BSU,
                		         CASE WHEN SUBSTR(CS136A.CS136_HNO,1,1) = 'L' OR SUBSTR(CS136A.CS136_HNO,1,1) = 'S' OR SUBSTR(CS136A.CS136_HNO,1,1) = 'W' OR SUBSTR(CS136A.CS136_HNO,1,1) = 'Z' THEN 'A'
                        		 	  WHEN SUBSTR(CS136A.CS136_HNO,1,1) = 'J' THEN 'B'
                        		 	  WHEN SUBSTR(CS136A.CS136_HNO,1,1) = 'M' THEN 'C'
                        		 	  WHEN SUBSTR(CS136A.CS136_HNO,1,1) = 'G' THEN 'D'
                        		 END,CS136A.CS136_GND
                )   A

                UNION ALL

                -- (발주(계약)종류(cs136_gnd) 가 'A','B','C','D','E','F'인 데이타의 지역,협력사,제품구분 보수구분별 협력사합계
                SELECT  CS136_ARA,
                        CS136_BSU,
                		CS136_HNO,
                		CS136_GND,
                		SUM(CS131_CNT) CS131_CNT,
                		SUM(CS131_AMT) CS131_AMT,
                        		CASE WHEN SUM(CS131_AMT) = 0 THEN 0
                        			 WHEN SUM(CS131_AMT) > 0 THEN CEIL((DOUBLE(SUM(SUM_AMT))/DOUBLE(SUM(CS131_AMT)))*100)
                        			 ELSE 0
                   		END GISUNG_AMT,
                		SUM(GONG_AMT) GONG_AMT,
                	    SUM(BUGA_AMT) BUGA_AMT,
                		SUM(SUM_AMT) SUM_AMT
                FROM (
                        SELECT  CS136_ARA,
                                CS136_BSU,
                        		'G' CS136_HNO,
                        		'H' CS136_GND,
                        		SUM(CS131_CNT) CS131_CNT,
                        		SUM(CS131_AMT) CS131_AMT,
                        		0 GISUNG_AMT,
                        		SUM(GONG_AMT) GONG_AMT,
                        	    SUM(BUGA_AMT) BUGA_AMT,
                        		SUM(SUM_AMT) SUM_AMT
                        FROM (
                                SELECT  CS136A.CS136_ARA,
                                        CS136A.CS136_BSU,
                                		CASE WHEN SUBSTR(CS136A.CS136_HNO,1,1) = 'L' OR SUBSTR(CS136A.CS136_HNO,1,1) = 'S' OR SUBSTR(CS136A.CS136_HNO,1,1) = 'W' OR SUBSTR(CS136A.CS136_HNO,1,1) = 'Z' THEN 'A'
                                			 WHEN SUBSTR(CS136A.CS136_HNO,1,1) = 'J' THEN 'B'
                                			 WHEN SUBSTR(CS136A.CS136_HNO,1,1) = 'M' THEN 'C'
                                			 WHEN SUBSTR(CS136A.CS136_HNO,1,1) = 'G' THEN 'D'
                                		END CS136_HNO,
                                		CS136A.CS136_GND CS136_GND,
                                		CASE WHEN CS136A.CS136_GND IN ('A','B')
                                			 	  THEN VALUE(COUNT(CS136A.MANDT),0)
                                			 WHEN CS136A.CS136_GND IN ('C','D','E')
                                			 	 THEN VALUE(COUNT(CS136A.MANDT),0)
                                		     ELSE 0
                                		END CS131_CNT,
                                		CASE WHEN CS136A.CS136_GND IN ('A','B')
                                			 	  THEN 0
                                			 WHEN CS136A.CS136_GND IN ('C','D','E')
                                			 	  THEN VALUE(SUM(CS131A.CS131_AMT),0)
                                			 ELSE 0
                                		END CS131_AMT,
                                		0 GISUNG_AMT,
                                		CASE WHEN CS136A.CS136_GND BETWEEN 'A' AND 'E'
                            	 	  THEN VALUE(SUM(CS136A.CS136_BAM)+SUM(CS136A.CS136_IY1)+SUM(CS136A.CS136_IY2)+SUM(CS136A.CS136_IY3)+SUM(CS136A.CS136_IY4)+SUM(CS136A.CS136_RET),0)
                                	 ELSE 0
                                END GONG_AMT,
                                CASE WHEN CS136A.CS136_GND BETWEEN 'A' AND 'E'
                                	 	  THEN CEIL(VALUE(DOUBLE(SUM(CS136A.CS136_BAM)+SUM(CS136A.CS136_IY1)+SUM(CS136A.CS136_IY2)+SUM(CS136A.CS136_IY3)+SUM(CS136A.CS136_IY4)+SUM(CS136A.CS136_RET))*1.1,0)) - 
                                	 	       VALUE(SUM(CS136A.CS136_BAM)+SUM(CS136A.CS136_IY1)+SUM(CS136A.CS136_IY2)+SUM(CS136A.CS136_IY3)+SUM(CS136A.CS136_IY4)+SUM(CS136A.CS136_RET),0)
                                     ELSE 0
                                END BUGA_AMT,
                                CASE WHEN CS136A.CS136_GND BETWEEN 'A' AND 'E'
                                	 	  THEN CEIL(VALUE(DOUBLE(SUM(CS136A.CS136_BAM)+SUM(CS136A.CS136_IY1)+SUM(CS136A.CS136_IY2)+SUM(CS136A.CS136_IY3)+SUM(CS136A.CS136_IY4)+SUM(CS136A.CS136_RET))*1.1,0))
                                	 ELSE 0
                                END SUM_AMT
                                FROM SAPHEE.ZCST136 CS136A
                                            LEFT OUTER JOIN SAPHEE.ZCST131 CS131A ON CS136A.MANDT = CS131A.MANDT
                                                                       	         AND CS136A.CS136_BSU = CS131A.CS131_BSU
                                                                                 AND CS136A.CS136_HNO = CS131A.CS131_HNO
	                                                                         AND CS136A.CS136_ARA = CS131A.CS131_ARA
                                                                                 AND CS136A.CS136_GND = CS131A.CS131_GND
                                                                                 AND CS136A.CS136_JYM = CS131A.CS131_MYM
                                                                                 AND CS136A.CS136_UPN = CS131A.CS131_UPN
                                                                                 AND CS136A.CS136_CST = CS131A.CS131_CST
                                                                                 AND CS136A.CS136_PJT = CS131A.CS131_PJT
                                                                                 AND CS136A.CS136_HNO = CS131A.CS131_HNO
                                                                                 AND CS136A.CS136_SEQ = CS131A.CS131_SEQ
                                                                                 AND CS136A.CS136_ISR = CS131A.CS131_ISR
                                                                                 AND CS131A.CS131_ARA LIKE '_%'
                                                                                 AND CS131A.CS131_BSU LIKE '_%'
<isNotNull col="AREA">
                                                                                 AND CS131A.CS131_ARA = #AREA#
</isNotNull>
--                                                                                 AND CS131A.CS131_YYM BETWEEN #YYYYMMF# AND #YYYYMMT#
                                                                                 AND CS131A.CS131_GBU = '3'
                                WHERE CS136A.MANDT = #G_MANDT#
                                AND CS136A.CS136_GYM BETWEEN #YYYYMMF# AND #YYYYMMT#
                                AND CS136A.CS136_GBU = '3'
                                AND CS136A.CS136_PST = 'A6'
                                AND CS136A.CS136_MGB = ''
                                AND CS136A.CS136_GNO > ''
                		AND CS136A.CS136_ARA LIKE '_%'
                		AND CS136A.CS136_BSU LIKE '_%'
<isNotNull col="AREA">
                		AND CS136A.CS136_ARA = #AREA#
</isNotNull>
                		AND (CS131A.CS131_MYB IS NULL OR CS131A.CS131_MYB = '')
                                AND (CS131A.VBELN IS NULL OR CS131A.VBELN > '')
                                AND SUBSTR(CS136A.CS136_HNO,1,1) IN ('L','S','W','Z','G','J')
                                GROUP BY CS136A.CS136_ARA,
                                         CS136A.CS136_BSU,
                        		         CASE WHEN SUBSTR(CS136A.CS136_HNO,1,1) = 'L' OR SUBSTR(CS136A.CS136_HNO,1,1) = 'S' OR SUBSTR(CS136A.CS136_HNO,1,1) = 'W' OR SUBSTR(CS136A.CS136_HNO,1,1) = 'Z' THEN 'A'
                                		 	  WHEN SUBSTR(CS136A.CS136_HNO,1,1) = 'J' THEN 'B'
                                		 	  WHEN SUBSTR(CS136A.CS136_HNO,1,1) = 'M' THEN 'C'
                                		 	  WHEN SUBSTR(CS136A.CS136_HNO,1,1) = 'G' THEN 'D'
                                		 END,
                                		 CS136A.CS136_GND
                        )   A
                        GROUP BY CS136_ARA,CS136_BSU,CS136_HNO

                        UNION ALL

                        SELECT  CS136_ARA,
                                CS136_BSU,
                        		'G' CS136_HNO,
                        		'H' CS136_GND,
                        		CS131_CNT,
                        		CS131_AMT,
                        		GISUNG_AMT,
                        		GONG_AMT,
                        	    BUGA_AMT,
                        		SUM_AMT
                        FROM (
                        		SELECT  CS136A.CS136_ARA,
                                        CS136A.CS136_BSU,
                                		CASE WHEN SUBSTR(CS136A.CS136_HNO,1,1) = 'L' OR SUBSTR(CS136A.CS136_HNO,1,1) = 'S' OR SUBSTR(CS136A.CS136_HNO,1,1) = 'W' OR SUBSTR(CS136A.CS136_HNO,1,1) = 'Z' THEN 'A'
                                			 WHEN SUBSTR(CS136A.CS136_HNO,1,1) = 'J' THEN 'B'
                                			 WHEN SUBSTR(CS136A.CS136_HNO,1,1) = 'M' THEN 'C'
                                			 WHEN SUBSTR(CS136A.CS136_HNO,1,1) = 'G' THEN 'D'
                                		END CS136_HNO,
                                		CS136A.CS136_GND,
                                		0 CS131_CNT,
                                		0 CS131_AMT,
                                		0 GISUNG_AMT,
                                		VALUE(DOUBLE(SUM(CS136A.CS136_BAM)+SUM(CS136A.CS136_IY1)+SUM(CS136A.CS136_IY2)+SUM(CS136A.CS136_IY3)+SUM(CS136A.CS136_IY4)+SUM(CS136A.CS136_RET)),0) GONG_AMT,
                       		    CEIL(VALUE(DOUBLE(SUM(CS136A.CS136_BAM)+SUM(CS136A.CS136_IY1)+SUM(CS136A.CS136_IY2)+SUM(CS136A.CS136_IY3)+SUM(CS136A.CS136_IY4)+SUM(CS136A.CS136_RET))*1.1,0)) - 
                                	 	       VALUE(SUM(CS136A.CS136_BAM)+SUM(CS136A.CS136_IY1)+SUM(CS136A.CS136_IY2)+SUM(CS136A.CS136_IY3)+SUM(CS136A.CS136_IY4)+SUM(CS136A.CS136_RET),0) BUGA_AMT,
                        		CEIL(VALUE(DOUBLE(SUM(CS136A.CS136_BAM)+SUM(CS136A.CS136_IY1)+SUM(CS136A.CS136_IY2)+SUM(CS136A.CS136_IY3)+SUM(CS136A.CS136_IY4)+SUM(CS136A.CS136_RET))*1.1,0)) SUM_AMT
                                FROM SAPHEE.ZCST136 CS136A
                                            LEFT OUTER JOIN SAPHEE.ZCST131 CS131A ON CS136A.MANDT = CS131A.MANDT
                                                                       	         AND CS136A.CS136_BSU = CS131A.CS131_BSU
                                                                                 AND CS136A.CS136_HNO = CS131A.CS131_HNO
	                                                                         AND CS136A.CS136_ARA = CS131A.CS131_ARA
                                                                                 AND CS136A.CS136_GND = CS131A.CS131_GND
                                                                                 AND CS136A.CS136_JYM = CS131A.CS131_MYM
                                                                                 AND CS136A.CS136_UPN = CS131A.CS131_UPN
                                                                                 AND CS136A.CS136_CST = CS131A.CS131_CST
                                                                                 AND CS136A.CS136_PJT = CS131A.CS131_PJT
                                                                                 AND CS136A.CS136_HNO = CS131A.CS131_HNO
                                                                                 AND CS136A.CS136_SEQ = CS131A.CS131_SEQ
                                                                                 AND CS136A.CS136_ISR = CS131A.CS131_ISR
                                                                                 AND CS131A.CS131_ARA LIKE '_%'
                                                                                 AND CS131A.CS131_BSU LIKE '_%'
<isNotNull col="AREA">
                                                                                 AND CS131A.CS131_ARA = #AREA#
</isNotNull>
--                                                                                 AND CS131A.CS131_YYM BETWEEN #YYYYMMF# AND #YYYYMMT#
                                                                                 AND CS131A.CS131_GBU = '3'
                                WHERE CS136A.MANDT = #G_MANDT#
                                AND CS136A.CS136_GYM BETWEEN #YYYYMMF# AND #YYYYMMT#
                                AND CS136A.CS136_GBU = '3'
                                AND CS136A.CS136_PST = 'A6'
                                AND CS136A.CS136_MGB = ''
                                AND CS136A.CS136_GNO > ''
                                AND CS136A.CS136_GND = 'F'
                		AND CS136A.CS136_ARA LIKE '_%'
                		AND CS136A.CS136_BSU LIKE '_%'
<isNotNull col="AREA">
                		AND CS136A.CS136_ARA = #AREA#
</isNotNull>
                                AND CS136A.CS136_GND = 'F'
                                AND (CS131A.CS131_MYB IS NULL OR CS131A.CS131_MYB = '')
                                AND (CS131A.VBELN IS NULL OR CS131A.VBELN > '')
                                AND SUBSTR(CS136A.CS136_HNO,1,1) IN ('L','S','W','Z','G','J')
                                GROUP BY CS136A.CS136_ARA,
                                         CS136A.CS136_BSU,
                        		         CASE WHEN SUBSTR(CS136A.CS136_HNO,1,1) = 'L' OR SUBSTR(CS136A.CS136_HNO,1,1) = 'S' OR SUBSTR(CS136A.CS136_HNO,1,1) = 'W' OR SUBSTR(CS136A.CS136_HNO,1,1) = 'Z' THEN 'A'
                                		 	  WHEN SUBSTR(CS136A.CS136_HNO,1,1) = 'J' THEN 'B'
                                		 	  WHEN SUBSTR(CS136A.CS136_HNO,1,1) = 'M' THEN 'C'
                                		 	  WHEN SUBSTR(CS136A.CS136_HNO,1,1) = 'G' THEN 'D'
                                		 END,CS136A.CS136_GND
                )   A
        ) B
        GROUP BY CS136_ARA,CS136_BSU,CS136_HNO,CS136_GND

        UNION ALL

        -- (발주(계약)종류(cs136_gnd) 가 'A','B','C','D','E','F'인 데이타의 지역별 합계
        SELECT  CS136_ARA,
                'XXXX' CS136_BSU,
        		'G' CS136_HNO,
        		'I' CS136_GND,
        		SUM(CS131_CNT) CS131_CNT,
        		SUM(CS131_AMT) CS131_AMT,
                		CASE WHEN SUM(CS131_AMT) = 0 THEN 0
                			 WHEN SUM(CS131_AMT) > 0 THEN CEIL((DOUBLE(SUM(SUM_AMT))/DOUBLE(SUM(CS131_AMT)))*100)
                			 ELSE 0
           		END GISUNG_AMT,
        		SUM(GONG_AMT) GONG_AMT,
        	    SUM(BUGA_AMT) BUGA_AMT,
        		SUM(SUM_AMT) SUM_AMT
        FROM (
                SELECT  CS136_ARA,
                        CS136_BSU,
                		'G' CS136_HNO,
                		'H' CS136_GND,
                		SUM(CS131_CNT) CS131_CNT,
                		SUM(CS131_AMT) CS131_AMT,
                		0 GISUNG_AMT,
                		SUM(GONG_AMT) GONG_AMT,
                	    SUM(BUGA_AMT) BUGA_AMT,
                		SUM(SUM_AMT) SUM_AMT
                FROM (
                        SELECT  CS136A.CS136_ARA,
                                CS136A.CS136_BSU,
                        		CASE WHEN SUBSTR(CS136A.CS136_HNO,1,1) = 'L' OR SUBSTR(CS136A.CS136_HNO,1,1) = 'S' OR SUBSTR(CS136A.CS136_HNO,1,1) = 'W' OR SUBSTR(CS136A.CS136_HNO,1,1) = 'Z' THEN 'A'
                        			 WHEN SUBSTR(CS136A.CS136_HNO,1,1) = 'J' THEN 'B'
                        			 WHEN SUBSTR(CS136A.CS136_HNO,1,1) = 'M' THEN 'C'
                        			 WHEN SUBSTR(CS136A.CS136_HNO,1,1) = 'G' THEN 'D'
                        		END CS136_HNO,
                        		CS136A.CS136_GND CS136_GND,
                        		CASE WHEN CS136A.CS136_GND IN ('A','B')
                        			 	  THEN VALUE(COUNT(CS136A.MANDT),0)
                        			 WHEN CS136A.CS136_GND IN ('C','D','E')
                        			 	 THEN VALUE(COUNT(CS136A.MANDT),0)
                        		     ELSE 0
                        		END CS131_CNT,
                        		CASE WHEN CS136A.CS136_GND IN ('A','B')
                        			 	  THEN 0
                        			 WHEN CS136A.CS136_GND IN ('C','D','E')
                        			 	  THEN VALUE(SUM(CS131A.CS131_AMT),0)
                        			 ELSE 0
                        		END CS131_AMT,
                        		0 GISUNG_AMT,
                        		CASE WHEN CS136A.CS136_GND BETWEEN 'A' AND 'E'
                            	 	  THEN VALUE(SUM(CS136A.CS136_BAM)+SUM(CS136A.CS136_IY1)+SUM(CS136A.CS136_IY2)+SUM(CS136A.CS136_IY3)+SUM(CS136A.CS136_IY4)+SUM(CS136A.CS136_RET),0)
                                	 ELSE 0
                                END GONG_AMT,
                                CASE WHEN CS136A.CS136_GND BETWEEN 'A' AND 'E'
                                	 	  THEN CEIL(VALUE(DOUBLE(SUM(CS136A.CS136_BAM)+SUM(CS136A.CS136_IY1)+SUM(CS136A.CS136_IY2)+SUM(CS136A.CS136_IY3)+SUM(CS136A.CS136_IY4)+SUM(CS136A.CS136_RET))*1.1,0)) - 
                                	 	       VALUE(SUM(CS136A.CS136_BAM)+SUM(CS136A.CS136_IY1)+SUM(CS136A.CS136_IY2)+SUM(CS136A.CS136_IY3)+SUM(CS136A.CS136_IY4)+SUM(CS136A.CS136_RET),0)
                                     ELSE 0
                                END BUGA_AMT,
                                CASE WHEN CS136A.CS136_GND BETWEEN 'A' AND 'E'
                                	 	  THEN CEIL(VALUE(DOUBLE(SUM(CS136A.CS136_BAM)+SUM(CS136A.CS136_IY1)+SUM(CS136A.CS136_IY2)+SUM(CS136A.CS136_IY3)+SUM(CS136A.CS136_IY4)+SUM(CS136A.CS136_RET))*1.1,0))
                                	 ELSE 0
                                END SUM_AMT
                        FROM SAPHEE.ZCST136 CS136A
                                    LEFT OUTER JOIN SAPHEE.ZCST131 CS131A ON CS136A.MANDT = CS131A.MANDT
                                                                       	 AND CS136A.CS136_BSU = CS131A.CS131_BSU
                                                                         AND CS136A.CS136_HNO = CS131A.CS131_HNO
	                                                                 AND CS136A.CS136_ARA = CS131A.CS131_ARA
                                                                         AND CS136A.CS136_GND = CS131A.CS131_GND
                                                                         AND CS136A.CS136_JYM = CS131A.CS131_MYM
                                                                         AND CS136A.CS136_UPN = CS131A.CS131_UPN
                                                                         AND CS136A.CS136_CST = CS131A.CS131_CST
                                                                         AND CS136A.CS136_PJT = CS131A.CS131_PJT
                                                                         AND CS136A.CS136_HNO = CS131A.CS131_HNO
                                                                         AND CS136A.CS136_SEQ = CS131A.CS131_SEQ
                                                                         AND CS136A.CS136_ISR = CS131A.CS131_ISR
                                                                         AND CS131A.CS131_ARA LIKE '_%'
                                                                         AND CS131A.CS131_BSU LIKE '_%'
<isNotNull col="AREA">
                                                                         AND CS131A.CS131_ARA = #AREA#
</isNotNull>
--                                                                         AND CS131A.CS131_YYM BETWEEN #YYYYMMF# AND #YYYYMMT#
                                                                         AND CS131A.CS131_GBU = '3'
                             ,(
                               SELECT A.AREA,
                                       B.LGORT
                                FROM
                                       (SELECT MM028A.CODE2 AREA
                                       FROM SAPHEE.ZLCODE MM028A
                                       WHERE MM028A.MANDT = #G_MANDT#
                                       AND MM028A.LANG = #G_LANG#
                                       AND MM028A.CODE1 = 'CS115'
                                       ) A,
                                       (
                                       SELECT MM005A.LGORT,
                							  WB010A.BSU_ARA
                                       FROM SAPHEE.ZWBT010 WB010A,
                                            SAPHEE.ZMMT012 MM012A,
                                            SAPHEE.ZMMT005 MM005A
                                       WHERE WB010A.MANDT = #G_MANDT#
                                       AND WB010A.MANDT = MM012A.MANDT
                                       AND WB010A.LIFNR = MM012A.LIFNR
                                       AND MM012A.MANDT = MM005A.MANDT
                                       AND MM012A.LIFNR = MM005A.LIFNR
                                       ) B
                					   WHERE A.AREA = B.BSU_ARA
                					   ORDER BY A.AREA,B.LGORT
                              ) ARA_BSU
                        WHERE CS136A.MANDT = #G_MANDT#
                        AND CS136A.CS136_GYM BETWEEN #YYYYMMF# AND #YYYYMMT#
                        AND CS136A.CS136_GBU = '3'
                        AND CS136A.CS136_PST = 'A6'
                        AND CS136A.CS136_MGB = ''
                        AND CS136A.CS136_GNO > ''
                        AND CS136_ARA  = ARA_BSU.AREA
                        AND CS136_BSU  = ARA_BSU.LGORT
               		AND CS136A.CS136_ARA LIKE '_%'
               		AND CS136A.CS136_BSU LIKE '_%'
<isNotNull col="AREA">
               		AND CS136A.CS136_ARA = #AREA#
</isNotNull>
               		AND (CS131A.CS131_MYB IS NULL OR CS131A.CS131_MYB = '')
                        AND (CS131A.VBELN IS NULL OR CS131A.VBELN > '')
                        AND SUBSTR(CS136A.CS136_HNO,1,1) IN ('L','S','W','Z','G','J')
                        GROUP BY CS136A.CS136_ARA,
                                 CS136A.CS136_BSU,
                		         CASE WHEN SUBSTR(CS136A.CS136_HNO,1,1) = 'L' OR SUBSTR(CS136A.CS136_HNO,1,1) = 'S' OR SUBSTR(CS136A.CS136_HNO,1,1) = 'W' OR SUBSTR(CS136A.CS136_HNO,1,1) = 'Z' THEN 'A'
                        		 	  WHEN SUBSTR(CS136A.CS136_HNO,1,1) = 'J' THEN 'B'
                        		 	  WHEN SUBSTR(CS136A.CS136_HNO,1,1) = 'M' THEN 'C'
                        		 	  WHEN SUBSTR(CS136A.CS136_HNO,1,1) = 'G' THEN 'D'
                        		 END,
                        		 CS136A.CS136_GND
                )   A
                GROUP BY CS136_ARA,CS136_BSU,CS136_HNO

                UNION ALL

                SELECT  CS136_ARA,
                        CS136_BSU,
                		'G' CS136_HNO,
                		'H' CS136_GND,
                		CS131_CNT,
                		CS131_AMT,
                		GISUNG_AMT,
                		GONG_AMT,
                	    BUGA_AMT,
                		SUM_AMT
                FROM (
                		SELECT  CS136A.CS136_ARA,
                                CS136A.CS136_BSU,
                        		CASE WHEN SUBSTR(CS136A.CS136_HNO,1,1) = 'L' OR SUBSTR(CS136A.CS136_HNO,1,1) = 'S' OR SUBSTR(CS136A.CS136_HNO,1,1) = 'W' OR SUBSTR(CS136A.CS136_HNO,1,1) = 'Z' THEN 'A'
                        			 WHEN SUBSTR(CS136A.CS136_HNO,1,1) = 'J' THEN 'B'
                        			 WHEN SUBSTR(CS136A.CS136_HNO,1,1) = 'M' THEN 'C'
                        			 WHEN SUBSTR(CS136A.CS136_HNO,1,1) = 'G' THEN 'D'
                        		END CS136_HNO,
                        		CS136A.CS136_GND,
                        		0 CS131_CNT,
                        		0 CS131_AMT,
                        		0 GISUNG_AMT,
                        		VALUE(DOUBLE(SUM(CS136A.CS136_BAM)+SUM(CS136A.CS136_IY1)+SUM(CS136A.CS136_IY2)+SUM(CS136A.CS136_IY3)+SUM(CS136A.CS136_IY4)+SUM(CS136A.CS136_RET)),0) GONG_AMT,
                       		    CEIL(VALUE(DOUBLE(SUM(CS136A.CS136_BAM)+SUM(CS136A.CS136_IY1)+SUM(CS136A.CS136_IY2)+SUM(CS136A.CS136_IY3)+SUM(CS136A.CS136_IY4)+SUM(CS136A.CS136_RET))*1.1,0)) - 
                                	 	       VALUE(SUM(CS136A.CS136_BAM)+SUM(CS136A.CS136_IY1)+SUM(CS136A.CS136_IY2)+SUM(CS136A.CS136_IY3)+SUM(CS136A.CS136_IY4)+SUM(CS136A.CS136_RET),0) BUGA_AMT,
                        		CEIL(VALUE(DOUBLE(SUM(CS136A.CS136_BAM)+SUM(CS136A.CS136_IY1)+SUM(CS136A.CS136_IY2)+SUM(CS136A.CS136_IY3)+SUM(CS136A.CS136_IY4)+SUM(CS136A.CS136_RET))*1.1,0)) SUM_AMT
                        FROM SAPHEE.ZCST136 CS136A
                                    LEFT OUTER JOIN SAPHEE.ZCST131 CS131A ON CS136A.MANDT = CS131A.MANDT
                                                                       	 AND CS136A.CS136_BSU = CS131A.CS131_BSU
                                                                         AND CS136A.CS136_HNO = CS131A.CS131_HNO
	                                                                 AND CS136A.CS136_ARA = CS131A.CS131_ARA
                                                                         AND CS136A.CS136_GND = CS131A.CS131_GND
                                                                         AND CS136A.CS136_JYM = CS131A.CS131_MYM
                                                                         AND CS136A.CS136_UPN = CS131A.CS131_UPN
                                                                         AND CS136A.CS136_CST = CS131A.CS131_CST
                                                                         AND CS136A.CS136_PJT = CS131A.CS131_PJT
                                                                         AND CS136A.CS136_HNO = CS131A.CS131_HNO
                                                                         AND CS136A.CS136_SEQ = CS131A.CS131_SEQ
                                                                         AND CS136A.CS136_ISR = CS131A.CS131_ISR
                                                                         AND CS131A.CS131_ARA LIKE '_%'
                                                                         AND CS131A.CS131_BSU LIKE '_%'
<isNotNull col="AREA">
                                                                         AND CS131A.CS131_ARA = #AREA#
</isNotNull>
--                                                                         AND CS131A.CS131_YYM BETWEEN #YYYYMMF# AND #YYYYMMT#
                                                                         AND CS131A.CS131_GBU = '3'
                             ,(
                               SELECT A.AREA,
                                       B.LGORT
                                FROM
                                       (SELECT MM028A.CODE2 AREA
                                       FROM SAPHEE.ZLCODE MM028A
                                       WHERE MM028A.MANDT = #G_MANDT#
                                       AND MM028A.LANG = #G_LANG#
                                       AND MM028A.CODE1 = 'CS115'
                                       ) A,
                                       (
                                       SELECT MM005A.LGORT,
                							  WB010A.BSU_ARA
                                       FROM SAPHEE.ZWBT010 WB010A,
                                            SAPHEE.ZMMT012 MM012A,
                                            SAPHEE.ZMMT005 MM005A
                                       WHERE WB010A.MANDT = #G_MANDT#
                                       AND WB010A.MANDT = MM012A.MANDT
                                       AND WB010A.LIFNR = MM012A.LIFNR
                                       AND MM012A.MANDT = MM005A.MANDT
                                       AND MM012A.LIFNR = MM005A.LIFNR
                                       ) B
                					   WHERE A.AREA = B.BSU_ARA
                					   ORDER BY A.AREA,B.LGORT
                              ) ARA_BSU
                        WHERE CS136A.MANDT = #G_MANDT#
                        AND CS136A.CS136_GYM BETWEEN #YYYYMMF# AND #YYYYMMT#
                        AND CS136A.CS136_GBU = '3'
                        AND CS136A.CS136_PST = 'A6'
                        AND CS136A.CS136_MGB = ''
                        AND CS136A.CS136_GNO > ''
                        AND CS136A.CS136_GND = 'F'
                        AND CS136_ARA  = ARA_BSU.AREA
                        AND CS136_BSU  = ARA_BSU.LGORT
               		AND CS136A.CS136_ARA LIKE '_%'
               		AND CS136A.CS136_BSU LIKE '_%'
<isNotNull col="AREA">
               		AND CS136A.CS136_ARA = #AREA#
</isNotNull>
                        AND CS136A.CS136_GND = 'F'
                        AND (CS131A.CS131_MYB IS NULL OR CS131A.CS131_MYB = '')
                        AND (CS131A.VBELN IS NULL OR CS131A.VBELN > '')
                        AND SUBSTR(CS136A.CS136_HNO,1,1) IN ('L','S','W','Z','G','J')
                        GROUP BY CS136A.CS136_ARA,
                                 CS136A.CS136_BSU,
                		         CASE WHEN SUBSTR(CS136A.CS136_HNO,1,1) = 'L' OR SUBSTR(CS136A.CS136_HNO,1,1) = 'S' OR SUBSTR(CS136A.CS136_HNO,1,1) = 'W' OR SUBSTR(CS136A.CS136_HNO,1,1) = 'Z' THEN 'A'
                        		 	  WHEN SUBSTR(CS136A.CS136_HNO,1,1) = 'J' THEN 'B'
                        		 	  WHEN SUBSTR(CS136A.CS136_HNO,1,1) = 'M' THEN 'C'
                        		 	  WHEN SUBSTR(CS136A.CS136_HNO,1,1) = 'G' THEN 'D'
                        		 END,CS136A.CS136_GND
                )   A
        ) B
        GROUP BY CS136_ARA


		UNION ALL

		--지방계
		SELECT  'YY' CS136_ARA,
                'YYYY' CS136_BSU,
        		'G' CS136_HNO,
        		'J' CS136_GND,
        		SUM(CS131_CNT) CS131_CNT,
        		SUM(CS131_AMT) CS131_AMT,
                		CASE WHEN SUM(CS131_AMT) = 0 THEN 0
                			 WHEN SUM(CS131_AMT) > 0 THEN CEIL((DOUBLE(SUM(SUM_AMT))/DOUBLE(SUM(CS131_AMT)))*100)
                			 ELSE 0
           		END GISUNG_AMT,
        		SUM(GONG_AMT) GONG_AMT,
        	    SUM(BUGA_AMT) BUGA_AMT,
        		SUM(SUM_AMT) SUM_AMT
        FROM (
                SELECT  'ARA' ARA,
        		        CS136_ARA,
                        CS136_BSU,
                		'G' CS136_HNO,
                		'H' CS136_GND,
                		SUM(CS131_CNT) CS131_CNT,
                		SUM(CS131_AMT) CS131_AMT,
                		0 GISUNG_AMT,
                		SUM(GONG_AMT) GONG_AMT,
                	    SUM(BUGA_AMT) BUGA_AMT,
                		SUM(SUM_AMT) SUM_AMT
                FROM (
                        SELECT  CS136A.CS136_ARA,
                                CS136A.CS136_BSU,
                        		CASE WHEN SUBSTR(CS136A.CS136_HNO,1,1) = 'L' OR SUBSTR(CS136A.CS136_HNO,1,1) = 'S' OR SUBSTR(CS136A.CS136_HNO,1,1) = 'W' OR SUBSTR(CS136A.CS136_HNO,1,1) = 'Z' THEN 'A'
                        			 WHEN SUBSTR(CS136A.CS136_HNO,1,1) = 'J' THEN 'B'
                        			 WHEN SUBSTR(CS136A.CS136_HNO,1,1) = 'M' THEN 'C'
                        			 WHEN SUBSTR(CS136A.CS136_HNO,1,1) = 'G' THEN 'D'
                        		END CS136_HNO,
                        		CS136A.CS136_GND CS136_GND,
                        		CASE WHEN CS136A.CS136_GND IN ('A','B')
                        			 	  THEN VALUE(COUNT(CS136A.MANDT),0)
                        			 WHEN CS136A.CS136_GND IN ('C','D','E')
                        			 	 THEN VALUE(COUNT(CS136A.MANDT),0)
                        		     ELSE 0
                        		END CS131_CNT,
                        		CASE WHEN CS136A.CS136_GND IN ('A','B')
                        			 	  THEN 0
                        			 WHEN CS136A.CS136_GND IN ('C','D','E')
                        			 	  THEN VALUE(SUM(CS131A.CS131_AMT),0)
                        			 ELSE 0
                        		END CS131_AMT,
                        		0 GISUNG_AMT,
                        		CASE WHEN CS136A.CS136_GND BETWEEN 'A' AND 'E'
                            	 	  THEN VALUE(SUM(CS136A.CS136_BAM)+SUM(CS136A.CS136_IY1)+SUM(CS136A.CS136_IY2)+SUM(CS136A.CS136_IY3)+SUM(CS136A.CS136_IY4)+SUM(CS136A.CS136_RET),0)
                                	 ELSE 0
                                END GONG_AMT,
                                CASE WHEN CS136A.CS136_GND BETWEEN 'A' AND 'E'
                                	 	  THEN CEIL(VALUE(DOUBLE(SUM(CS136A.CS136_BAM)+SUM(CS136A.CS136_IY1)+SUM(CS136A.CS136_IY2)+SUM(CS136A.CS136_IY3)+SUM(CS136A.CS136_IY4)+SUM(CS136A.CS136_RET))*1.1,0)) - 
                                	 	       VALUE(SUM(CS136A.CS136_BAM)+SUM(CS136A.CS136_IY1)+SUM(CS136A.CS136_IY2)+SUM(CS136A.CS136_IY3)+SUM(CS136A.CS136_IY4)+SUM(CS136A.CS136_RET),0)
                                     ELSE 0
                                END BUGA_AMT,
                                CASE WHEN CS136A.CS136_GND BETWEEN 'A' AND 'E'
                                	 	  THEN CEIL(VALUE(DOUBLE(SUM(CS136A.CS136_BAM)+SUM(CS136A.CS136_IY1)+SUM(CS136A.CS136_IY2)+SUM(CS136A.CS136_IY3)+SUM(CS136A.CS136_IY4)+SUM(CS136A.CS136_RET))*1.1,0))
                                	 ELSE 0
                                END SUM_AMT
                        FROM SAPHEE.ZCST136 CS136A
                                    LEFT OUTER JOIN SAPHEE.ZCST131 CS131A ON CS136A.MANDT = CS131A.MANDT
                                                                       	 AND CS136A.CS136_BSU = CS131A.CS131_BSU
                                                                         AND CS136A.CS136_HNO = CS131A.CS131_HNO
	                                                                 AND CS136A.CS136_ARA = CS131A.CS131_ARA
                                                                         AND CS136A.CS136_GND = CS131A.CS131_GND
                                                                         AND CS136A.CS136_JYM = CS131A.CS131_MYM
                                                                         AND CS136A.CS136_UPN = CS131A.CS131_UPN
                                                                         AND CS136A.CS136_CST = CS131A.CS131_CST
                                                                         AND CS136A.CS136_PJT = CS131A.CS131_PJT
                                                                         AND CS136A.CS136_HNO = CS131A.CS131_HNO
                                                                         AND CS136A.CS136_SEQ = CS131A.CS131_SEQ
                                                                         AND CS136A.CS136_ISR = CS131A.CS131_ISR
                                                                         AND CS131A.CS131_ARA LIKE '_%'
                                                                         AND CS131A.CS131_BSU LIKE '_%'
<isNotNull col="AREA">
                                                                         AND CS131A.CS131_ARA = #AREA#
</isNotNull>
--                                                                         AND CS131A.CS131_YYM BETWEEN #YYYYMMF# AND #YYYYMMT#
                                                                         AND CS131A.CS131_GBU = '3'
                             ,(
                               SELECT A.AREA,
                                       B.LGORT
                                FROM
                                       (SELECT MM028A.CODE2 AREA
                                       FROM SAPHEE.ZLCODE MM028A
                                       WHERE MM028A.MANDT = #G_MANDT#
                                       AND MM028A.LANG = #G_LANG#
                                       AND MM028A.CODE1 = 'CS115'
                                       ) A,
                                       (
                                       SELECT MM005A.LGORT,
                							  WB010A.BSU_ARA
                                       FROM SAPHEE.ZWBT010 WB010A,
                                            SAPHEE.ZMMT012 MM012A,
                                            SAPHEE.ZMMT005 MM005A
                                       WHERE WB010A.MANDT = #G_MANDT#
                                       AND WB010A.MANDT = MM012A.MANDT
                                       AND WB010A.LIFNR = MM012A.LIFNR
                                       AND MM012A.MANDT = MM005A.MANDT
                                       AND MM012A.LIFNR = MM005A.LIFNR
                                       ) B
                					   WHERE A.AREA = B.BSU_ARA
                					   ORDER BY A.AREA,B.LGORT
                              ) ARA_BSU
                        WHERE CS136A.MANDT = #G_MANDT#
                        AND CS136_ARA &lt;&gt; 'E5'
                        AND CS136A.CS136_GYM BETWEEN #YYYYMMF# AND #YYYYMMT#
                        AND CS136A.CS136_GBU = '3'
                        AND CS136A.CS136_PST = 'A6'
                        AND CS136A.CS136_MGB = ''
                        AND CS136A.CS136_GNO > ''
                        AND CS136_ARA  = ARA_BSU.AREA
                        AND CS136_BSU  = ARA_BSU.LGORT
               		AND CS136A.CS136_ARA LIKE '_%'
               		AND CS136A.CS136_BSU LIKE '_%'
<isNotNull col="AREA">
               		AND CS136A.CS136_ARA = #AREA#
</isNotNull>
               		AND (CS131A.CS131_MYB IS NULL OR CS131A.CS131_MYB = '')
                        AND (CS131A.VBELN IS NULL OR CS131A.VBELN > '')
                        AND SUBSTR(CS136A.CS136_HNO,1,1) IN ('L','S','W','Z','G','J')
                        GROUP BY CS136A.CS136_ARA,
                                 CS136A.CS136_BSU,
                		         CASE WHEN SUBSTR(CS136A.CS136_HNO,1,1) = 'L' OR SUBSTR(CS136A.CS136_HNO,1,1) = 'S' OR SUBSTR(CS136A.CS136_HNO,1,1) = 'W' OR SUBSTR(CS136A.CS136_HNO,1,1) = 'Z' THEN 'A'
                        		 	  WHEN SUBSTR(CS136A.CS136_HNO,1,1) = 'J' THEN 'B'
                        		 	  WHEN SUBSTR(CS136A.CS136_HNO,1,1) = 'M' THEN 'C'
                        		 	  WHEN SUBSTR(CS136A.CS136_HNO,1,1) = 'G' THEN 'D'
                        		 END,
                        		 CS136A.CS136_GND
                )   A
                GROUP BY CS136_ARA,CS136_BSU,CS136_HNO

                UNION ALL

                SELECT  'ARA' ARA,
        		        CS136_ARA,
                        CS136_BSU,
                		'G' CS136_HNO,
                		'H' CS136_GND,
                		CS131_CNT,
                		CS131_AMT,
                		GISUNG_AMT,
                		GONG_AMT,
                	    BUGA_AMT,
                		SUM_AMT
                FROM (
                		SELECT  CS136A.CS136_ARA,
                                CS136A.CS136_BSU,
                        		CASE WHEN SUBSTR(CS136A.CS136_HNO,1,1) = 'L' OR SUBSTR(CS136A.CS136_HNO,1,1) = 'S' OR SUBSTR(CS136A.CS136_HNO,1,1) = 'W' OR SUBSTR(CS136A.CS136_HNO,1,1) = 'Z' THEN 'A'
                        			 WHEN SUBSTR(CS136A.CS136_HNO,1,1) = 'J' THEN 'B'
                        			 WHEN SUBSTR(CS136A.CS136_HNO,1,1) = 'M' THEN 'C'
                        			 WHEN SUBSTR(CS136A.CS136_HNO,1,1) = 'G' THEN 'D'
                        		END CS136_HNO,
                        		CS136A.CS136_GND,
                        		0 CS131_CNT,
                        		0 CS131_AMT,
                        		0 GISUNG_AMT,
                        		VALUE(DOUBLE(SUM(CS136A.CS136_BAM)+SUM(CS136A.CS136_IY1)+SUM(CS136A.CS136_IY2)+SUM(CS136A.CS136_IY3)+SUM(CS136A.CS136_IY4)+SUM(CS136A.CS136_RET)),0) GONG_AMT,
                       		    CEIL(VALUE(DOUBLE(SUM(CS136A.CS136_BAM)+SUM(CS136A.CS136_IY1)+SUM(CS136A.CS136_IY2)+SUM(CS136A.CS136_IY3)+SUM(CS136A.CS136_IY4)+SUM(CS136A.CS136_RET))*1.1,0)) - 
                                	 	       VALUE(SUM(CS136A.CS136_BAM)+SUM(CS136A.CS136_IY1)+SUM(CS136A.CS136_IY2)+SUM(CS136A.CS136_IY3)+SUM(CS136A.CS136_IY4)+SUM(CS136A.CS136_RET),0) BUGA_AMT,
                        		CEIL(VALUE(DOUBLE(SUM(CS136A.CS136_BAM)+SUM(CS136A.CS136_IY1)+SUM(CS136A.CS136_IY2)+SUM(CS136A.CS136_IY3)+SUM(CS136A.CS136_IY4)+SUM(CS136A.CS136_RET))*1.1,0)) SUM_AMT
                        FROM SAPHEE.ZCST136 CS136A
                                    LEFT OUTER JOIN SAPHEE.ZCST131 CS131A ON CS136A.MANDT = CS131A.MANDT
                                                                       	 AND CS136A.CS136_BSU = CS131A.CS131_BSU
                                                                         AND CS136A.CS136_HNO = CS131A.CS131_HNO
	                                                                 AND CS136A.CS136_ARA = CS131A.CS131_ARA
                                                                         AND CS136A.CS136_GND = CS131A.CS131_GND
                                                                         AND CS136A.CS136_JYM = CS131A.CS131_MYM
                                                                         AND CS136A.CS136_UPN = CS131A.CS131_UPN
                                                                         AND CS136A.CS136_CST = CS131A.CS131_CST
                                                                         AND CS136A.CS136_PJT = CS131A.CS131_PJT
                                                                         AND CS136A.CS136_HNO = CS131A.CS131_HNO
                                                                         AND CS136A.CS136_SEQ = CS131A.CS131_SEQ
                                                                         AND CS136A.CS136_ISR = CS131A.CS131_ISR
                                                                         AND CS131A.CS131_ARA LIKE '_%'
                                                                         AND CS131A.CS131_BSU LIKE '_%'
<isNotNull col="AREA">
                                                                         AND CS131A.CS131_ARA = #AREA#
</isNotNull>
--                                                                         AND CS131A.CS131_YYM BETWEEN #YYYYMMF# AND #YYYYMMT#
                                                                         AND CS131A.CS131_GBU = '3'
                             ,(
                               SELECT A.AREA,
                                       B.LGORT
                                FROM
                                       (SELECT MM028A.CODE2 AREA
                                       FROM SAPHEE.ZLCODE MM028A
                                       WHERE MM028A.MANDT = #G_MANDT#
                                       AND MM028A.LANG = #G_LANG#
                                       AND MM028A.CODE1 = 'CS115'
                                       ) A,
                                       (
                                       SELECT MM005A.LGORT,
                							  WB010A.BSU_ARA
                                       FROM SAPHEE.ZWBT010 WB010A,
                                            SAPHEE.ZMMT012 MM012A,
                                            SAPHEE.ZMMT005 MM005A
                                       WHERE WB010A.MANDT = #G_MANDT#
                                       AND WB010A.MANDT = MM012A.MANDT
                                       AND WB010A.LIFNR = MM012A.LIFNR
                                       AND MM012A.MANDT = MM005A.MANDT
                                       AND MM012A.LIFNR = MM005A.LIFNR
                                       ) B
                					   WHERE A.AREA = B.BSU_ARA
                					   ORDER BY A.AREA,B.LGORT
                              ) ARA_BSU
                        WHERE CS136A.MANDT = #G_MANDT#
                        AND CS136_ARA &lt;&gt; 'E5'
                        AND CS136A.CS136_GYM BETWEEN #YYYYMMF# AND #YYYYMMT#
                        AND CS136A.CS136_GBU = '3'
                        AND CS136A.CS136_PST = 'A6'
                        AND CS136A.CS136_MGB = ''
                        AND CS136A.CS136_GNO > ''
                        AND CS136A.CS136_GND = 'F'
                        AND CS136_ARA  = ARA_BSU.AREA
                        AND CS136_BSU  = ARA_BSU.LGORT
               		AND CS136A.CS136_ARA LIKE '_%'
               		AND CS136A.CS136_BSU LIKE '_%'
<isNotNull col="AREA">
               		AND CS136A.CS136_ARA = #AREA#
</isNotNull>
                        AND CS136A.CS136_GND = 'F'
                        AND (CS131A.CS131_MYB IS NULL OR CS131A.CS131_MYB = '')
                        AND (CS131A.VBELN IS NULL OR CS131A.VBELN > '')
                        AND SUBSTR(CS136A.CS136_HNO,1,1) IN ('L','S','W','Z','G','J')
                        GROUP BY CS136A.CS136_ARA,
                                 CS136A.CS136_BSU,
                		         CASE WHEN SUBSTR(CS136A.CS136_HNO,1,1) = 'L' OR SUBSTR(CS136A.CS136_HNO,1,1) = 'S' OR SUBSTR(CS136A.CS136_HNO,1,1) = 'W' OR SUBSTR(CS136A.CS136_HNO,1,1) = 'Z' THEN 'A'
                        		 	  WHEN SUBSTR(CS136A.CS136_HNO,1,1) = 'J' THEN 'B'
                        		 	  WHEN SUBSTR(CS136A.CS136_HNO,1,1) = 'M' THEN 'C'
                        		 	  WHEN SUBSTR(CS136A.CS136_HNO,1,1) = 'G' THEN 'D'
                        		 END,CS136A.CS136_GND
                )   A
        ) B
        GROUP BY ARA

       UNION ALL

        -- (발주(계약)종류(cs136_gnd) 가 'A','B','C','D','E','F'인 데이타의 총 합계
        SELECT  'ZZ'CS136_ARA,
                'ZZZZ' CS136_BSU,
        		'G' CS136_HNO,
        		'K' CS136_GND,
        		SUM(CS131_CNT) CS131_CNT,
        		SUM(DOUBLE(CS131_AMT)) CS131_AMT,
        		CASE WHEN SUM(DOUBLE(CS131_AMT)) = 0 THEN 0
        			 WHEN SUM(DOUBLE(CS131_AMT)) > 0 THEN CEIL((DOUBLE(SUM(SUM_AMT))/DOUBLE(SUM(CS131_AMT)))*100)
        			 ELSE 0
           		END GISUNG_AMT,
        		SUM(DOUBLE(GONG_AMT)) GONG_AMT,
        	    SUM(DOUBLE(BUGA_AMT)) BUGA_AMT,
        		SUM(DOUBLE(SUM_AMT)) SUM_AMT
        FROM (
                SELECT  'TOT' TOT,
				        CS136_ARA,
                        CS136_BSU,
                		'G' CS136_HNO,
                		'H' CS136_GND,
                		SUM(DOUBLE(CS131_CNT)) CS131_CNT,
                		SUM(DOUBLE(CS131_AMT)) CS131_AMT,
                		0 GISUNG_AMT,
                		SUM(DOUBLE(GONG_AMT)) GONG_AMT,
                	    SUM(DOUBLE(BUGA_AMT)) BUGA_AMT,
                		SUM(DOUBLE(SUM_AMT)) SUM_AMT
                FROM (
                        SELECT  CS136A.CS136_ARA,
                                CS136A.CS136_BSU,
                        		CASE WHEN SUBSTR(CS136A.CS136_HNO,1,1) = 'L' OR SUBSTR(CS136A.CS136_HNO,1,1) = 'S' OR SUBSTR(CS136A.CS136_HNO,1,1) = 'W' OR SUBSTR(CS136A.CS136_HNO,1,1) = 'Z' THEN 'A'
                        			 WHEN SUBSTR(CS136A.CS136_HNO,1,1) = 'J' THEN 'B'
                        			 WHEN SUBSTR(CS136A.CS136_HNO,1,1) = 'M' THEN 'C'
                        			 WHEN SUBSTR(CS136A.CS136_HNO,1,1) = 'G' THEN 'D'
                        		END CS136_HNO,
                        		CS136A.CS136_GND CS136_GND,
                        		CASE WHEN CS136A.CS136_GND IN ('A','B')
                        			 	  THEN VALUE(COUNT(CS136A.MANDT),0)
                        			 WHEN CS136A.CS136_GND IN ('C','D','E')
                        			 	 THEN VALUE(COUNT(CS136A.MANDT),0)
                        		     ELSE 0
                        		END CS131_CNT,
                        		CASE WHEN CS136A.CS136_GND IN ('A','B')
                        			 	  THEN 0
                        			 WHEN CS136A.CS136_GND IN ('C','D','E')
                        			 	  THEN VALUE(SUM(CS131A.CS131_AMT),0)
                        			 ELSE 0
                        		END CS131_AMT,
                        		0 GISUNG_AMT,
                        		CASE WHEN CS136A.CS136_GND BETWEEN 'A' AND 'E'
                            	 	  THEN VALUE(SUM(CS136A.CS136_BAM)+SUM(CS136A.CS136_IY1)+SUM(CS136A.CS136_IY2)+SUM(CS136A.CS136_IY3)+SUM(CS136A.CS136_IY4)+SUM(CS136A.CS136_RET),0)
                                	 ELSE 0
                                END GONG_AMT,
                                CASE WHEN CS136A.CS136_GND BETWEEN 'A' AND 'E'
                                	 	  THEN CEIL(VALUE(DOUBLE(SUM(CS136A.CS136_BAM)+SUM(CS136A.CS136_IY1)+SUM(CS136A.CS136_IY2)+SUM(CS136A.CS136_IY3)+SUM(CS136A.CS136_IY4)+SUM(CS136A.CS136_RET))*1.1,0)) - 
                                	 	       VALUE(SUM(CS136A.CS136_BAM)+SUM(CS136A.CS136_IY1)+SUM(CS136A.CS136_IY2)+SUM(CS136A.CS136_IY3)+SUM(CS136A.CS136_IY4)+SUM(CS136A.CS136_RET),0)
                                     ELSE 0
                                END BUGA_AMT,
                                CASE WHEN CS136A.CS136_GND BETWEEN 'A' AND 'E'
                                	 	  THEN CEIL(VALUE(DOUBLE(SUM(CS136A.CS136_BAM)+SUM(CS136A.CS136_IY1)+SUM(CS136A.CS136_IY2)+SUM(CS136A.CS136_IY3)+SUM(CS136A.CS136_IY4)+SUM(CS136A.CS136_RET))*1.1,0))
                                	 ELSE 0
                                END SUM_AMT
                        FROM SAPHEE.ZCST136 CS136A
                                    LEFT OUTER JOIN SAPHEE.ZCST131 CS131A ON CS136A.MANDT = CS131A.MANDT
                                                                       	 AND CS136A.CS136_BSU = CS131A.CS131_BSU
                                                                         AND CS136A.CS136_HNO = CS131A.CS131_HNO
	                                                                 AND CS136A.CS136_ARA = CS131A.CS131_ARA
                                                                         AND CS136A.CS136_GND = CS131A.CS131_GND
                                                                         AND CS136A.CS136_JYM = CS131A.CS131_MYM
                                                                         AND CS136A.CS136_UPN = CS131A.CS131_UPN
                                                                         AND CS136A.CS136_CST = CS131A.CS131_CST
                                                                         AND CS136A.CS136_PJT = CS131A.CS131_PJT
                                                                         AND CS136A.CS136_HNO = CS131A.CS131_HNO
                                                                         AND CS136A.CS136_SEQ = CS131A.CS131_SEQ
                                                                         AND CS136A.CS136_ISR = CS131A.CS131_ISR
                                                                         AND CS131A.CS131_ARA LIKE '_%'
                                                                         AND CS131A.CS131_BSU LIKE '_%'
<isNotNull col="AREA">
                                                                         AND CS131A.CS131_ARA = #AREA#
</isNotNull>
--                                                                         AND CS131A.CS131_YYM BETWEEN #YYYYMMF# AND #YYYYMMT#
                                                                         AND CS131A.CS131_GBU = '3'
                             ,(
                               SELECT A.AREA,
                                       B.LGORT
                                FROM
                                       (SELECT MM028A.CODE2 AREA
                                       FROM SAPHEE.ZLCODE MM028A
                                       WHERE MM028A.MANDT = #G_MANDT#
                                       AND MM028A.LANG = #G_LANG#
                                       AND MM028A.CODE1 = 'CS115'
                                       ) A,
                                       (
                                       SELECT MM005A.LGORT,
                							  WB010A.BSU_ARA
                                       FROM SAPHEE.ZWBT010 WB010A,
                                            SAPHEE.ZMMT012 MM012A,
                                            SAPHEE.ZMMT005 MM005A
                                       WHERE WB010A.MANDT = #G_MANDT#
                                       AND WB010A.MANDT = MM012A.MANDT
                                       AND WB010A.LIFNR = MM012A.LIFNR
                                       AND MM012A.MANDT = MM005A.MANDT
                                       AND MM012A.LIFNR = MM005A.LIFNR
                                       ) B
                					   WHERE A.AREA = B.BSU_ARA
                					   ORDER BY A.AREA,B.LGORT
                              ) ARA_BSU
                        WHERE CS136A.MANDT = #G_MANDT#
                        AND CS136A.CS136_GYM BETWEEN #YYYYMMF# AND #YYYYMMT#
                        AND CS136A.CS136_GBU = '3'
                        AND CS136A.CS136_PST = 'A6'
                        AND CS136A.CS136_MGB = ''
                        AND CS136A.CS136_GNO > ''
                        AND CS136_ARA  = ARA_BSU.AREA
                        AND CS136_BSU  = ARA_BSU.LGORT
               		AND CS136A.CS136_ARA LIKE '_%'
               		AND CS136A.CS136_BSU LIKE '_%'
<isNotNull col="AREA">
               		AND CS136A.CS136_ARA = #AREA#
</isNotNull>
               		AND (CS131A.CS131_MYB IS NULL OR CS131A.CS131_MYB = '')
                        AND (CS131A.VBELN IS NULL OR CS131A.VBELN > '')
                        AND SUBSTR(CS136A.CS136_HNO,1,1) IN ('L','S','W','Z','G','J')
                        GROUP BY CS136A.CS136_ARA,
                                 CS136A.CS136_BSU,
                		         CASE WHEN SUBSTR(CS136A.CS136_HNO,1,1) = 'L' OR SUBSTR(CS136A.CS136_HNO,1,1) = 'S' OR SUBSTR(CS136A.CS136_HNO,1,1) = 'W' OR SUBSTR(CS136A.CS136_HNO,1,1) = 'Z' THEN 'A'
                        		 	  WHEN SUBSTR(CS136A.CS136_HNO,1,1) = 'J' THEN 'B'
                        		 	  WHEN SUBSTR(CS136A.CS136_HNO,1,1) = 'M' THEN 'C'
                        		 	  WHEN SUBSTR(CS136A.CS136_HNO,1,1) = 'G' THEN 'D'
                        		 END,
                        		 CS136A.CS136_GND
                )   A
                GROUP BY CS136_ARA,CS136_BSU,CS136_HNO

                UNION ALL

                SELECT  'TOT' TOT,
				         CS136_ARA,
                        CS136_BSU,
                		'G' CS136_HNO,
                		'H' CS136_GND,
                		CS131_CNT,
                		CS131_AMT,
                		GISUNG_AMT,
                		GONG_AMT,
                	    BUGA_AMT,
                		SUM_AMT
                FROM (
                		SELECT  CS136A.CS136_ARA,
                                CS136A.CS136_BSU,
                        		CASE WHEN SUBSTR(CS136A.CS136_HNO,1,1) = 'L' OR SUBSTR(CS136A.CS136_HNO,1,1) = 'S' OR SUBSTR(CS136A.CS136_HNO,1,1) = 'W' OR SUBSTR(CS136A.CS136_HNO,1,1) = 'Z' THEN 'A'
                        			 WHEN SUBSTR(CS136A.CS136_HNO,1,1) = 'J' THEN 'B'
                        			 WHEN SUBSTR(CS136A.CS136_HNO,1,1) = 'M' THEN 'C'
                        			 WHEN SUBSTR(CS136A.CS136_HNO,1,1) = 'G' THEN 'D'
                        		END CS136_HNO,
                        		CS136A.CS136_GND,
                        		0 CS131_CNT,
                        		0 CS131_AMT,
                        		0 GISUNG_AMT,
                        		VALUE(DOUBLE(SUM(CS136A.CS136_BAM)+SUM(CS136A.CS136_IY1)+SUM(CS136A.CS136_IY2)+SUM(CS136A.CS136_IY3)+SUM(CS136A.CS136_IY4)+SUM(CS136A.CS136_RET)),0) GONG_AMT,
                       		    CEIL(VALUE(DOUBLE(SUM(CS136A.CS136_BAM)+SUM(CS136A.CS136_IY1)+SUM(CS136A.CS136_IY2)+SUM(CS136A.CS136_IY3)+SUM(CS136A.CS136_IY4)+SUM(CS136A.CS136_RET))*1.1,0)) - 
                                	 	       VALUE(SUM(CS136A.CS136_BAM)+SUM(CS136A.CS136_IY1)+SUM(CS136A.CS136_IY2)+SUM(CS136A.CS136_IY3)+SUM(CS136A.CS136_IY4)+SUM(CS136A.CS136_RET),0) BUGA_AMT,
                        		CEIL(VALUE(DOUBLE(SUM(CS136A.CS136_BAM)+SUM(CS136A.CS136_IY1)+SUM(CS136A.CS136_IY2)+SUM(CS136A.CS136_IY3)+SUM(CS136A.CS136_IY4)+SUM(CS136A.CS136_RET))*1.1,0)) SUM_AMT
                        FROM SAPHEE.ZCST136 CS136A
                                    LEFT OUTER JOIN SAPHEE.ZCST131 CS131A ON CS136A.MANDT = CS131A.MANDT
                                                                       	 AND CS136A.CS136_BSU = CS131A.CS131_BSU
                                                                         AND CS136A.CS136_HNO = CS131A.CS131_HNO
	                                                                 AND CS136A.CS136_ARA = CS131A.CS131_ARA
                                                                         AND CS136A.CS136_GND = CS131A.CS131_GND
                                                                         AND CS136A.CS136_JYM = CS131A.CS131_MYM
                                                                         AND CS136A.CS136_UPN = CS131A.CS131_UPN
                                                                         AND CS136A.CS136_CST = CS131A.CS131_CST
                                                                         AND CS136A.CS136_PJT = CS131A.CS131_PJT
                                                                         AND CS136A.CS136_HNO = CS131A.CS131_HNO
                                                                         AND CS136A.CS136_SEQ = CS131A.CS131_SEQ
                                                                         AND CS136A.CS136_ISR = CS131A.CS131_ISR
                                                                         AND CS131A.CS131_ARA LIKE '_%'
                                                                         AND CS131A.CS131_BSU LIKE '_%'
<isNotNull col="AREA">
                                                                         AND CS131A.CS131_ARA = #AREA#
</isNotNull>
--                                                                         AND CS131A.CS131_YYM BETWEEN #YYYYMMF# AND #YYYYMMT#
                                                                         AND CS131A.CS131_GBU = '3'
                             ,(
                                SELECT A.AREA,
                                       B.LGORT
                                FROM
                                       (SELECT MM028A.CODE2 AREA
                                       FROM SAPHEE.ZLCODE MM028A
                                       WHERE MM028A.MANDT = #G_MANDT#
                                       AND MM028A.LANG = #G_LANG#
                                       AND MM028A.CODE1 = 'CS115'
                                       ) A,
                                       (
                                       SELECT MM005A.LGORT,
                							  WB010A.BSU_ARA
                                       FROM SAPHEE.ZWBT010 WB010A,
                                            SAPHEE.ZMMT012 MM012A,
                                            SAPHEE.ZMMT005 MM005A
                                       WHERE WB010A.MANDT = #G_MANDT#
                                       AND WB010A.MANDT = MM012A.MANDT
                                       AND WB010A.LIFNR = MM012A.LIFNR
                                       AND MM012A.MANDT = MM005A.MANDT
                                       AND MM012A.LIFNR = MM005A.LIFNR
                                       ) B
                					   WHERE A.AREA = B.BSU_ARA
                					   ORDER BY A.AREA,B.LGORT
                              ) ARA_BSU
                        WHERE CS136A.MANDT = #G_MANDT#
                        AND CS136A.CS136_GYM BETWEEN #YYYYMMF# AND #YYYYMMT#
                        AND CS136A.CS136_GBU = '3'
                        AND CS136A.CS136_PST = 'A6'
                        AND CS136A.CS136_MGB = ''
                        AND CS136A.CS136_GNO > ''
                        AND CS136A.CS136_GND = 'F'
                        AND CS136_ARA  = ARA_BSU.AREA
                        AND CS136_BSU  = ARA_BSU.LGORT
               		AND CS136A.CS136_BSU LIKE '_%'
<isNotNull col="AREA">
               		AND CS136A.CS136_ARA = #AREA#
</isNotNull>
                        AND CS136A.CS136_GND = 'F'
                        AND (CS131A.CS131_MYB IS NULL OR CS131A.CS131_MYB = '')
                        AND (CS131A.VBELN IS NULL OR CS131A.VBELN > '')
                        AND SUBSTR(CS136A.CS136_HNO,1,1) IN ('L','S','W','Z','G','J')
                        GROUP BY CS136A.CS136_ARA,
                                 CS136A.CS136_BSU,
                		         CASE WHEN SUBSTR(CS136A.CS136_HNO,1,1) = 'L' OR SUBSTR(CS136A.CS136_HNO,1,1) = 'S' OR SUBSTR(CS136A.CS136_HNO,1,1) = 'W' OR SUBSTR(CS136A.CS136_HNO,1,1) = 'Z' THEN 'A'
                        		 	  WHEN SUBSTR(CS136A.CS136_HNO,1,1) = 'J' THEN 'B'
                        		 	  WHEN SUBSTR(CS136A.CS136_HNO,1,1) = 'M' THEN 'C'
                        		 	  WHEN SUBSTR(CS136A.CS136_HNO,1,1) = 'G' THEN 'D'
                        		 END,CS136A.CS136_GND
                )   A

        ) B
        GROUP BY TOT


       ) TOT
       GROUP BY CS136_ARA,CS136_BSU,CS136_HNO,CS136_GND
       ) B1
        ON  A1.AREA = B1.CS136_ARA
        AND A1.LGORT = B1.CS136_BSU
        AND A1.CS136_HNO = B1.CS136_HNO
        AND A1.CS136_GND = B1.CS136_GND
        WHERE A1.CS136_HNO IN ('A','B','C','G')
        ORDER BY A1.ARA_GBN,A1.AREA,A1.LGORT,A1.CS136_HNO,A1.ORD

WITH UR	</statement>
	<input default-name="ds_cond">
		<col name="G_MANDT" size="255" type="VARCHAR" description="" /> 
		<col name="G_LANG" size="255" type="VARCHAR" description="" /> 
		<col name="AREA" size="255" type="VARCHAR" description="" /> 
		<col name="YYYYMMF" size="255" type="VARCHAR" description="" /> 
		<col name="YYYYMMT" size="255" type="VARCHAR" description="" /> 
	</input>
	<output default-name="ds_list">
		<col name="CS136_ARA" size="15" type="VARCHAR" description="" /> 
		<col name="AREA_NM" size="60" type="VARCHAR" description="" /> 
		<col name="CS136_BSU" size="12" type="VARCHAR" description="" /> 
		<col name="LIFNR_NM" size="105" type="VARCHAR" description="" /> 
		<col name="CS136_HNO" size="15" type="VARCHAR" description="" /> 
		<col name="HNO_NM" size="60" type="VARCHAR" description="" /> 
		<col name="GND_NM" size="60" type="VARCHAR" description="" /> 
		<col name="CS136_GND" size="15" type="VARCHAR" description="" /> 
		<col name="AFLG" size="1" type="VARCHAR" description="" /> 
		<col name="BFLG" size="1" type="VARCHAR" description="" /> 
		<col name="CS131_CNT" size="22" type="DOUBLE" description="" /> 
		<col name="CS131_AMT" size="22" type="DOUBLE" description="" /> 
		<col name="GISUNG_AMT" size="22" type="DOUBLE" description="" /> 
		<col name="GONG_AMT" size="22" type="DOUBLE" description="" /> 
		<col name="BUGA_AMT" size="22" type="DOUBLE" description="" /> 
		<col name="SUM_AMT" size="22" type="DOUBLE" description="" /> 
	</output>
</query>
