<?xml version="1.0" encoding="euc-kr"?>
<query dynamic="true">
	<type>insert</type>
	<description><![CDATA[상해제작 한국수출품 리스트 - INSERT]]></description>
	<reload>true</reload>
	<monitoring>true</monitoring>
	<result-count>0</result-count>
	<statement>
MERGE INTO SAPHEE.ZPPT040A AS P40A 
   USING (
         SELECT
              CAST(#G_MANDT# AS VARCHAR(3)) AS MANDT,
              CAST(SUBSTR(#POSID#,1,6) AS VARCHAR(6)) AS PSPID,
              CAST(#POSID# AS VARCHAR(9)) AS POSID
          FROM
              SYSIBM.SYSDUMMY1
       )  P4  ON    P40A.MANDT  = P4.MANDT
                AND  P40A.PSPID = P4.PSPID
                AND  P40A.POSID = P4.POSID
   WHEN MATCHED THEN 
     UPDATE
     SET 
  	 P40A.POST1 = CASE WHEN VALUE(CAST(#POST1# AS CHAR(120)),'') &gt;= '' THEN VALUE(CAST(#POST1# AS CHAR(120)),'') ELSE P40A.POST1 END,
   	 P40A.TYPE =  CASE WHEN VALUE(CAST(#TYPE# AS CHAR(15)),'') &gt;= '' THEN VALUE(CAST(#TYPE# AS CHAR(15)),'') ELSE P40A.TYPE END,
   	 P40A.SPEC =  CASE WHEN VALUE(CAST(#SPEC# AS CHAR(90)),'') &gt;= '' THEN VALUE(CAST(#SPEC# AS CHAR(90)),'') ELSE P40A.SPEC END,
   	 P40A.HLDAT1 = CASE WHEN VALUE(CAST(#HLDAT1# AS CHAR(8)),'') &gt;= '' THEN VALUE(CAST(#HLDAT1# AS CHAR(16)),'') ELSE P40A.HLDAT1 END ,
   	 P40A.HLDAT2 = CASE WHEN VALUE(CAST(#HLDAT2# AS CHAR(24)),'') &gt;= '' THEN SAPHEE.SET_ZERODATE(VALUE(CAST(#HLDAT2# AS CHAR(24)),''),'D') ELSE P40A.HLDAT2 END ,
   	 P40A.HLDAT3 = CASE WHEN VALUE(CAST(#HLDAT3# AS CHAR(24)),'') &gt;= '' THEN SAPHEE.SET_ZERODATE(VALUE(CAST(#HLDAT3# AS CHAR(24)),''),'D') ELSE P40A.HLDAT3 END ,
   	 P40A.HLDAT4 = CASE WHEN VALUE(CAST(#HLDAT4# AS CHAR(24)),'') &gt;= '' THEN SAPHEE.SET_ZERODATE(VALUE(CAST(#HLDAT4# AS CHAR(24)),''),'D') ELSE P40A.HLDAT4 END ,
   	 P40A.HLDAT5 = CASE WHEN VALUE(CAST(#HLDAT5# AS CHAR(24)),'') &gt;= '' THEN SAPHEE.SET_ZERODATE(VALUE(CAST(#HLDAT5# AS CHAR(24)),''),'D') ELSE P40A.HLDAT5 END ,
   	 P40A.HLDAT6 = CASE WHEN VALUE(CAST(#HLDAT6# AS CHAR(24)),'') &gt;= '' THEN SAPHEE.SET_ZERODATE(VALUE(CAST(#HLDAT6# AS CHAR(24)),''),'D') ELSE P40A.HLDAT6 END ,
   	 P40A.HLDAT7 = CASE WHEN VALUE(CAST(#HLDAT7# AS CHAR(24)),'') &gt;= '' THEN SAPHEE.SET_ZERODATE(VALUE(CAST(#HLDAT7# AS CHAR(24)),''),'D') ELSE P40A.HLDAT7 END ,
   	 P40A.SLDAT1 = CASE WHEN VALUE(CAST(#SLDAT1# AS CHAR(24)),'') &gt;= '' THEN SAPHEE.SET_ZERODATE(VALUE(CAST(#SLDAT1# AS CHAR(24)),''),'D') ELSE P40A.SLDAT1 END ,
  	 P40A.SLDAT2 = CASE WHEN VALUE(CAST(#SLDAT2# AS CHAR(24)),'') &gt;= '' THEN SAPHEE.SET_ZERODATE(VALUE(CAST(#SLDAT2# AS CHAR(24)),''),'D') ELSE P40A.SLDAT2 END ,
   	 P40A.SLDAT3 = CASE WHEN VALUE(CAST(#SLDAT3# AS CHAR(24)),'') &gt;= '' THEN SAPHEE.SET_ZERODATE(VALUE(CAST(#SLDAT3# AS CHAR(24)),''),'D') ELSE P40A.SLDAT3 END ,
   	 P40A.SLDAT4 = CASE WHEN VALUE(CAST(#SLDAT4# AS CHAR(24)),'') &gt;= '' THEN SAPHEE.SET_ZERODATE(VALUE(CAST(#SLDAT4# AS CHAR(24)),''),'D') ELSE P40A.SLDAT4 END ,
   	 P40A.SLDAT5 = CASE WHEN VALUE(CAST(#SLDAT5# AS CHAR(24)),'') &gt;= '' THEN SAPHEE.SET_ZERODATE(VALUE(CAST(#SLDAT5# AS CHAR(24)),''),'D') ELSE P40A.SLDAT5 END ,
   	 P40A.SLDAT6 = CASE WHEN VALUE(CAST(#SLDAT6# AS CHAR(24)),'') &gt;= '' THEN SAPHEE.SET_ZERODATE(VALUE(CAST(#SLDAT6# AS CHAR(24)),''),'D') ELSE P40A.SLDAT6 END ,
   	 P40A.SYDAT2 = CASE WHEN VALUE(CAST(#SYDAT2# AS CHAR(24)),'') &gt;= '' THEN SAPHEE.SET_ZERODATE(VALUE(CAST(#SYDAT2# AS CHAR(24)),''),'D') ELSE P40A.SYDAT2 END ,
   	 P40A.SYDAT3 = CASE WHEN VALUE(CAST(#SYDAT3# AS CHAR(24)),'') &gt;= '' THEN SAPHEE.SET_ZERODATE(VALUE(CAST(#SYDAT3# AS CHAR(24)),''),'D') ELSE P40A.SYDAT3 END ,
   	 P40A.SYDAT4 = CASE WHEN VALUE(CAST(#SYDAT4# AS CHAR(24)),'') &gt;= '' THEN SAPHEE.SET_ZERODATE(VALUE(CAST(#SYDAT4# AS CHAR(24)),''),'D') ELSE P40A.SYDAT4 END ,
   	 P40A.SYDAT5 = CASE WHEN VALUE(CAST(#SYDAT5# AS CHAR(24)),'') &gt;= '' THEN SAPHEE.SET_ZERODATE(VALUE(CAST(#SYDAT5# AS CHAR(24)),''),'D') ELSE P40A.SYDAT5 END ,
   	 P40A.SYDAT6 = CASE WHEN VALUE(CAST(#SYDAT6# AS CHAR(24)),'') &gt;= '' THEN SAPHEE.SET_ZERODATE(VALUE(CAST(#SYDAT6# AS CHAR(24)),''),'D') ELSE P40A.SYDAT6 END ,
   	 P40A.UPDAT = HEX(CURRENT DATE) ,
   	 P40A.UPTIM = HEX(CURRENT TIME),
   	 P40A.UPNAM = CAST(#G_USER_ID# AS CHAR(36)),
   	 P40A.BIGO = SUBSTR(CAST(#BIGO# AS CHAR(50)),1,50),
   	 P40A.HLDAT8 = CASE WHEN VALUE(CAST(#HLDAT8# AS CHAR(24)),'') &gt;= '' THEN SAPHEE.SET_ZERODATE(VALUE(CAST(#HLDAT8# AS CHAR(24)),''),'D') ELSE P40A.HLDAT8 END ,
   	 P40A.SLOUTS = CASE WHEN VALUE(CAST(#SLOUTS# AS CHAR(1)),'') &gt;= '' THEN VALUE(CAST(#SLOUTS# AS CHAR(1)),'') ELSE P40A.SLOUTS END,
   	 P40A.HLDAT9 = CASE WHEN VALUE(CAST(#HLDAT9# AS CHAR(24)),'') &gt;= '' THEN SAPHEE.SET_ZERODATE(VALUE(CAST(#HLDAT9# AS CHAR(24)),''),'D') ELSE P40A.HLDAT9 END,
   	 P40A.TRUSS = CAST(#TRUSS# AS CHAR(5)) 

   WHEN NOT MATCHED THEN 
     INSERT ( 
    	 P40A.MANDT
    	, P40A.PSPID
    	, P40A.POSID
   	, P40A.POST1
   	, P40A.TYPE
   	, P40A.SPEC
   	, P40A.HLDAT1
   	, P40A.HLDAT2
   	, P40A.HLDAT3
   	, P40A.HLDAT4
   	, P40A.HLDAT5
   	, P40A.HLDAT6
   	, P40A.HLDAT7
   	, P40A.SLDAT1
   	, P40A.SLDAT2
   	, P40A.SLDAT3
   	, P40A.SLDAT4
   	, P40A.SLDAT5
   	, P40A.SLDAT6
   	, P40A.SYDAT2
   	, P40A.SYDAT3
   	, P40A.SYDAT4
   	, P40A.SYDAT5
   	, P40A.SYDAT6
   	, P40A.SYDAT1
    	, P40A.CRDAT
    	, P40A.CRTIM
    	, P40A.UPDAT
    	, P40A.UPTIM
   	, P40A.CRNAM
    	, P40A.UPNAM
    	, P40A.BIGO
    	, P40A.HLDAT8
    	, P40A.SLOUTS
    	, P40A.HLDAT9
    , P40A.TRUSS	
     ) VALUES ( 
    	 #G_MANDT#
    	, SUBSTR(CAST(#POSID# AS CHAR(24)) , 1,6)
    	, #POSID#
   	, VALUE(CAST(#POST1#AS CHAR(120)),'')
   	, VALUE(CAST(#TYPE#AS CHAR(15)),'')
   	, VALUE(CAST(#SPEC#AS CHAR(90)),'')
   	, VALUE(CAST(#HLDAT1#AS CHAR(16)),'')
   	, SAPHEE.SET_ZERODATE(VALUE(CAST(#HLDAT2#AS CHAR(24)),''),'D')
   	, SAPHEE.SET_ZERODATE(VALUE(CAST(#HLDAT3#AS CHAR(24)),''),'D')
   	, SAPHEE.SET_ZERODATE(VALUE(CAST(#HLDAT4#AS CHAR(24)),''),'D')
   	, SAPHEE.SET_ZERODATE(VALUE(CAST(#HLDAT5#AS CHAR(24)),''),'D')
   	, SAPHEE.SET_ZERODATE(VALUE(CAST(#HLDAT6#AS CHAR(24)),''),'D')
   	, SAPHEE.SET_ZERODATE(VALUE(CAST(#HLDAT7#AS CHAR(24)),''),'D')
   	, SAPHEE.SET_ZERODATE(VALUE(CAST(#SLDAT1#AS CHAR(24)),''),'D')
   	, SAPHEE.SET_ZERODATE(VALUE(CAST(#SLDAT2#AS CHAR(24)),''),'D')
   	, SAPHEE.SET_ZERODATE(VALUE(CAST(#SLDAT3#AS CHAR(24)),''),'D')
   	, SAPHEE.SET_ZERODATE(VALUE(CAST(#SLDAT4#AS CHAR(24)),''),'D')
   	, SAPHEE.SET_ZERODATE(VALUE(CAST(#SLDAT5#AS CHAR(24)),''),'D')
   	, SAPHEE.SET_ZERODATE(VALUE(CAST(#SLDAT6#AS CHAR(24)),''),'D')
   	, SAPHEE.SET_ZERODATE(VALUE(CAST(#SYDAT2#AS CHAR(24)),''),'D')
   	, SAPHEE.SET_ZERODATE(VALUE(CAST(#SYDAT3#AS CHAR(24)),''),'D')
   	, SAPHEE.SET_ZERODATE(VALUE(CAST(#SYDAT4#AS CHAR(24)),''),'D')
   	, SAPHEE.SET_ZERODATE(VALUE(CAST(#SYDAT5#AS CHAR(24)),''),'D')
   	, SAPHEE.SET_ZERODATE(VALUE(CAST(#SYDAT6#AS CHAR(24)),''),'D')
              , SAPHEE.SET_ZERODATE('','D')
    	, HEX(CURRENT DATE)
    	, HEX(CURRENT TIME)
    	, HEX(CURRENT DATE)
    	, HEX(CURRENT TIME)
    	, CAST(#G_USER_ID# AS CHAR(36))
    	, CAST(#G_USER_ID# AS CHAR(36))
    	, SUBSTR(CAST(#BIGO# AS CHAR(50)), 1, 50)
    	, SAPHEE.SET_ZERODATE(VALUE(CAST(#HLDAT8#AS CHAR(24)),''),'D')
    	, VALUE(CAST(#SLOUTS#AS CHAR(1)),'')
    	, SAPHEE.SET_ZERODATE(VALUE(CAST(#HLDAT9#AS CHAR(24)),''),'D')
    	, VALUE(CAST(#TRUSS#AS CHAR(5)),'')
     )	</statement>
	<input default-name="ds_list">
		<col name="MANDT" size="9" type="VARCHAR" description="" /> 
		<col name="PSPID" size="72" type="VARCHAR" description="" /> 
		<col name="POSID" size="72" type="VARCHAR" description="" /> 
		<col name="POST1" size="120" type="VARCHAR" description="" /> 
		<col name="TYPE" size="15" type="VARCHAR" description="" /> 
		<col name="SPEC" size="90" type="VARCHAR" description="" /> 
		<col name="HLDAT1" size="24" type="VARCHAR" description="" /> 
		<col name="HLDAT2" size="24" type="VARCHAR" description="" /> 
		<col name="SLDAT1" size="24" type="VARCHAR" description="" /> 
		<col name="SLDAT2" size="24" type="VARCHAR" description="" /> 
		<col name="SLDAT3" size="24" type="VARCHAR" description="" /> 
		<col name="SLDAT4" size="24" type="VARCHAR" description="" /> 
		<col name="SLDAT5" size="24" type="VARCHAR" description="" /> 
		<col name="CRDAT" size="24" type="VARCHAR" description="" /> 
		<col name="CRTIM" size="18" type="VARCHAR" description="" /> 
		<col name="UPDAT" size="24" type="VARCHAR" description="" /> 
		<col name="UPTIM" size="18" type="VARCHAR" description="" />
		<col name="HLDAT8" size="24" type="VARCHAR" description="" />
		<col name="SLOUTS" size="1" type="VARCHAR" description="" /> 
		<col name="HLDAT9" size="24" type="VARCHAR" description="" />
		<col name="TRUSS" size="5" type="VARCHAR" description="" />
	</input>
	<output default-name="_none">
	</output>
</query>
