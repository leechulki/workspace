<?xml version="1.0" encoding="euc-kr"?>
<query>
	<type>select</type>
	<description><![CDATA[]]></description>
	<reload>true</reload>
	<monitoring>true</monitoring>
	<result-count>0</result-count>
	<statement>
<![CDATA[
SELECT A.POSID AS PSPID, A.POSID_1 AS POSID, B.ZZGUBUN
            ,VALUE(B.INTERPHON, '') AS INTERPHON, VALUE(B.BD_SERNO, '') AS BD_SERNO
            ,VALUE(CAST(B.SIZE1 AS INTEGER)  , 0) AS SIZE1
            ,B.SIZE2
            ,VALUE(CAST(B.SIZE3 AS INTEGER)  , 0) AS SIZE3
            ,VALUE(CAST(B.SIZE4 AS INTEGER)  , 0) AS SIZE4
            ,VALUE(CAST(B.SIZE5 AS INTEGER)  , 0) AS SIZE5
            ,VALUE(CAST(B.SIZE6 AS INTEGER)  , 0) AS SIZE6
            ,VALUE(CAST(B.SIZE7 AS INTEGER)  , 0) AS SIZE7            

            --,VALUE(CAST(SIZE8 AS INTEGER)  , 0) AS SIZE8
            --,VALUE(CAST(SIZE9 AS INTEGER)  , 0) AS SIZE9
            ,B.SIZE8
            ,B.SIZE9
            ,B.DIPBXNUMB
            ,VALUE(B.SIZE10, '') AS SIZE10
            ,VALUE(CAST(B.BIGO AS VARCHAR(3000)), '') AS BIGO
            ,VALUE((SELECT BIGO||' '||BIGO2 FROM SAPHEE.ZQMTW0101B WHERE MANDT = #G_MANDT# AND PSPID = #PJT# AND POSID = #HNO#) ,'') AS SBIGO
            
            ,VALUE((SELECT Z.VALUE FROM SAPHEE.ZSDT0005 AS Z WHERE Z.MANDT =#G_MANDT#  AND Z.HOGI =   #HNO# AND Z.CHARACTERISTIC = 'EL_ASTD'  
                  AND Z.SEQ = (SELECT MAX(X.SEQ) FROM SAPHEE.ZSDT0005 AS X WHERE X.MANDT = Z.MANDT AND X.HOGI = Z.HOGI AND X.CHARACTERISTIC = Z.CHARACTERISTIC)), '') AS CH_CODE3
            ,VALUE(T.CH_CODE4  ,'') AS CH_CODE4  
            ,VALUE((SELECT Z.VALUE FROM SAPHEE.ZSDT0005 AS Z WHERE Z.MANDT =#G_MANDT#  AND Z.HOGI =   #HNO# AND Z.CHARACTERISTIC = 'EL_ECBG'  
                  AND Z.SEQ = (SELECT MAX(X.SEQ) FROM SAPHEE.ZSDT0005 AS X WHERE X.MANDT = Z.MANDT AND X.HOGI = Z.HOGI AND X.CHARACTERISTIC = Z.CHARACTERISTIC)), '') AS CH_CODE5
            ,VALUE((SELECT Z.VALUE FROM SAPHEE.ZSDT0005 AS Z WHERE Z.MANDT =#G_MANDT#  AND Z.HOGI =   #HNO# AND Z.CHARACTERISTIC = 'EL_ECWBG'   
                  AND Z.SEQ = (SELECT MAX(X.SEQ) FROM SAPHEE.ZSDT0005 AS X WHERE X.MANDT = Z.MANDT AND X.HOGI = Z.HOGI AND X.CHARACTERISTIC = Z.CHARACTERISTIC)), '') AS CH_CODE6
            ,VALUE((SELECT Z.VALUE FROM SAPHEE.ZSDT0005 AS Z WHERE Z.MANDT =#G_MANDT#  AND Z.HOGI =   #HNO# AND Z.CHARACTERISTIC = 'EL_EHP'   
                  AND Z.SEQ = (SELECT MAX(X.SEQ) FROM SAPHEE.ZSDT0005 AS X WHERE X.MANDT = Z.MANDT AND X.HOGI = Z.HOGI AND X.CHARACTERISTIC = Z.CHARACTERISTIC)), '') AS CH_CODE7
            ,VALUE((SELECT Z.VALUE FROM SAPHEE.ZSDT0005 AS Z WHERE Z.MANDT =#G_MANDT#  AND Z.HOGI =   #HNO# AND Z.CHARACTERISTIC = 'EL_DVS'    
                  AND Z.SEQ = (SELECT MAX(X.SEQ) FROM SAPHEE.ZSDT0005 AS X WHERE X.MANDT = Z.MANDT AND X.HOGI = Z.HOGI AND X.CHARACTERISTIC = Z.CHARACTERISTIC)), '') AS CH_CODE8  
            ,VALUE(T.CH_CODE9  ,'') AS CH_CODE9     
            ,VALUE(T.CH_CODE10  ,'') AS CH_CODE10  
            ,VALUE(T.CH_CODE11  ,'') AS CH_CODE11  
            ,VALUE(T.CH_CODE12  ,'') AS CH_CODE12          
            ,VALUE((SELECT Z.VALUE FROM SAPHEE.ZSDT0005 AS Z WHERE Z.MANDT =#G_MANDT#  AND Z.HOGI =   #HNO# AND Z.CHARACTERISTIC = 'EL_DCP'   
                 AND Z.SEQ = (SELECT MAX(X.SEQ) FROM SAPHEE.ZSDT0005 AS X WHERE X.MANDT = Z.MANDT AND X.HOGI = Z.HOGI AND X.CHARACTERISTIC = Z.CHARACTERISTIC)), '') AS CH_CODE13
            ,VALUE((SELECT Z.VALUE FROM SAPHEE.ZSDT0005 AS Z WHERE Z.MANDT =#G_MANDT#  AND Z.HOGI =   #HNO# AND Z.CHARACTERISTIC = 'EL_ETM'   
                 AND Z.SEQ = (SELECT MAX(X.SEQ) FROM SAPHEE.ZSDT0005 AS X WHERE X.MANDT = Z.MANDT AND X.HOGI = Z.HOGI AND X.CHARACTERISTIC = Z.CHARACTERISTIC)), '') AS CH_CODE14
            ,VALUE((SELECT Z.VALUE FROM SAPHEE.ZSDT0005 AS Z WHERE Z.MANDT =#G_MANDT#  AND Z.HOGI =   #HNO# AND Z.CHARACTERISTIC = 'EL_ADRV'  
                 AND Z.SEQ = (SELECT MAX(X.SEQ) FROM SAPHEE.ZSDT0005 AS X WHERE X.MANDT = Z.MANDT AND X.HOGI = Z.HOGI AND X.CHARACTERISTIC = Z.CHARACTERISTIC)), '') AS CH_CODE15
            ,VALUE((SELECT Z.VALUE FROM SAPHEE.ZSDT0005 AS Z WHERE Z.MANDT =#G_MANDT#  AND Z.HOGI =   #HNO# AND Z.CHARACTERISTIC = 'EL_DFCC'    
                 AND Z.SEQ = (SELECT MAX(X.SEQ) FROM SAPHEE.ZSDT0005 AS X WHERE X.MANDT = Z.MANDT AND X.HOGI = Z.HOGI AND X.CHARACTERISTIC = Z.CHARACTERISTIC)), '') AS CH_CODE16
            ,VALUE((SELECT Z.CHAR_VALUE FROM SAPHEE.ZSDT0094  AS Z WHERE Z.MANDT = #G_MANDT#  AND Z.HOGI = #HNO# AND Z.NAM_CHAR = 'EL_DHCC'
			      AND Z.SEQ = ( SELECT MAX(X.SEQ)  FROM SAPHEE.ZSDT0094 AS X  WHERE X.MANDT = Z.MANDT  AND X.HOGI = Z.HOGI  AND X.NAM_CHAR = Z.NAM_CHAR)), '') AS CH_CODE17
            ,VALUE((SELECT Z.VALUE FROM SAPHEE.ZSDT0005 AS Z WHERE Z.MANDT =#G_MANDT#  AND Z.HOGI =   #HNO# AND Z.CHARACTERISTIC = 'EL_DHSE' 
                 AND Z.SEQ = (SELECT MAX(X.SEQ) FROM SAPHEE.ZSDT0005 AS X WHERE X.MANDT = Z.MANDT AND X.HOGI = Z.HOGI AND X.CHARACTERISTIC = Z.CHARACTERISTIC)), '') AS CH_CODE18
            ,VALUE((SELECT Z.VALUE FROM SAPHEE.ZSDT0005 AS Z WHERE Z.MANDT =#G_MANDT#  AND Z.HOGI =   #HNO# AND Z.CHARACTERISTIC = 'EL_DFGAD' 
                 AND Z.SEQ = (SELECT MAX(X.SEQ) FROM SAPHEE.ZSDT0005 AS X WHERE X.MANDT = Z.MANDT AND X.HOGI = Z.HOGI AND X.CHARACTERISTIC = Z.CHARACTERISTIC)), '') AS CH_CODE19
            ,VALUE(T.CH_CODE20  ,'') AS CH_CODE20
            ,VALUE((SELECT Z.VALUE FROM SAPHEE.ZSDT0005 AS Z WHERE Z.MANDT =#G_MANDT#  AND Z.HOGI =   #HNO# AND Z.CHARACTERISTIC = 'EL_DTMDP' 
                 AND Z.SEQ = (SELECT MAX(X.SEQ) FROM SAPHEE.ZSDT0005 AS X WHERE X.MANDT = Z.MANDT AND X.HOGI = Z.HOGI AND X.CHARACTERISTIC = Z.CHARACTERISTIC)), '') AS CH_CODE21
            ,VALUE((SELECT Z.VALUE FROM SAPHEE.ZSDT0005 AS Z WHERE Z.MANDT =#G_MANDT#  AND Z.HOGI =   #HNO# AND Z.CHARACTERISTIC = 'EL_DTS'   
                 AND Z.SEQ = (SELECT MAX(X.SEQ) FROM SAPHEE.ZSDT0005 AS X WHERE X.MANDT = Z.MANDT AND X.HOGI = Z.HOGI AND X.CHARACTERISTIC = Z.CHARACTERISTIC)), '') AS CH_CODE22
            ,VALUE((SELECT Z.VALUE FROM SAPHEE.ZSDT0005 AS Z WHERE Z.MANDT =#G_MANDT#  AND Z.HOGI =   #HNO# AND Z.CHARACTERISTIC = 'EL_DBC'  
                 AND Z.SEQ = (SELECT MAX(X.SEQ) FROM SAPHEE.ZSDT0005 AS X WHERE X.MANDT = Z.MANDT AND X.HOGI = Z.HOGI AND X.CHARACTERISTIC = Z.CHARACTERISTIC)), '') AS CH_CODE23
            ,VALUE((SELECT (CASE WHEN Z.VALUE = 'DG360'
                                THEN 'Y'
                                ELSE ''
                                END) AS VALUE
                      FROM SAPHEE.ZSDT0005 AS Z 
                     WHERE Z.MANDT = #G_MANDT#  
                       AND Z.HOGI  =   #HNO#
                       AND Z.CHARACTERISTIC = 'EL_ECGV' 
                       AND Z.SEQ = ( SELECT MAX(X.SEQ) 
		                               FROM SAPHEE.ZSDT0005 AS X 
		                              WHERE X.MANDT = Z.MANDT
		                                AND X.HOGI = Z.HOGI 
		                                AND X.CHARACTERISTIC = Z.CHARACTERISTIC)), '') AS CH_CODE24
                
            ,VALUE(T.CH_CODE25 ,'') AS CH_CODE25
            ,VALUE((SELECT Z.VALUE FROM SAPHEE.ZSDT0005 AS Z WHERE Z.MANDT =#G_MANDT#  AND Z.HOGI =   #HNO# AND Z.CHARACTERISTIC = 'EL_CHLF'   
                AND Z.SEQ = (SELECT MAX(X.SEQ) FROM SAPHEE.ZSDT0005 AS X WHERE X.MANDT = Z.MANDT AND X.HOGI = Z.HOGI AND X.CHARACTERISTIC = Z.CHARACTERISTIC)), '') AS CH_CODE26
            ,VALUE(T.CH_CODE27 ,'') AS CH_CODE27
            ,VALUE((SELECT Z.VALUE FROM SAPHEE.ZSDT0005 AS Z WHERE Z.MANDT =#G_MANDT#  AND Z.HOGI =   #HNO# AND Z.CHARACTERISTIC = 'EL_DSPD'   
                AND Z.SEQ = (SELECT MAX(X.SEQ) FROM SAPHEE.ZSDT0005 AS X WHERE X.MANDT = Z.MANDT AND X.HOGI = Z.HOGI AND X.CHARACTERISTIC = Z.CHARACTERISTIC)), '') AS CH_CODE28
            ,VALUE((SELECT Z.VALUE FROM SAPHEE.ZSDT0005 AS Z WHERE Z.MANDT =#G_MANDT#  AND Z.HOGI =   #HNO# AND Z.CHARACTERISTIC = 'EL_CJM1FR'   
                AND Z.SEQ = (SELECT MAX(X.SEQ) FROM SAPHEE.ZSDT0005 AS X WHERE X.MANDT = Z.MANDT AND X.HOGI = Z.HOGI AND X.CHARACTERISTIC = Z.CHARACTERISTIC)), '') AS CH_CODE29
            ,VALUE((SELECT Z.VALUE FROM SAPHEE.ZSDT0005 AS Z WHERE Z.MANDT =#G_MANDT#  AND Z.HOGI =   #HNO# AND Z.CHARACTERISTIC = 'EL_CJM2FR'   
                AND Z.SEQ = (SELECT MAX(X.SEQ) FROM SAPHEE.ZSDT0005 AS X WHERE X.MANDT = Z.MANDT AND X.HOGI = Z.HOGI AND X.CHARACTERISTIC = Z.CHARACTERISTIC)), '') AS CH_CODE30
            ,VALUE((SELECT Z.VALUE FROM SAPHEE.ZSDT0005 AS Z WHERE Z.MANDT =#G_MANDT#  AND Z.HOGI =   #HNO# AND Z.CHARACTERISTIC = 'EL_AFF'   
                AND Z.SEQ = (SELECT MAX(X.SEQ) FROM SAPHEE.ZSDT0005 AS X WHERE X.MANDT = Z.MANDT AND X.HOGI = Z.HOGI AND X.CHARACTERISTIC = Z.CHARACTERISTIC)), '') AS CH_CODE31
            ,VALUE((SELECT Z.VALUE FROM SAPHEE.ZSDT0005 AS Z WHERE Z.MANDT =#G_MANDT#  AND Z.HOGI =   #HNO# AND Z.CHARACTERISTIC = 'EL_ARF'   
                AND Z.SEQ = (SELECT MAX(X.SEQ) FROM SAPHEE.ZSDT0005 AS X WHERE X.MANDT = Z.MANDT AND X.HOGI = Z.HOGI AND X.CHARACTERISTIC = Z.CHARACTERISTIC)), '') AS CH_CODE32
			, '' AS EL_TYPE
			, ( SELECT MAX(S.CHKDT) FROM SAPHEE.ZQMT055H S WHERE S.MANDT = A.MANDT AND S.POSID = A.POSID_1 AND S.EL_TYPE = 'EL' ) AS CHKDT
    FROM  SAPHEE.ZMASTER02 AS A 
    LEFT OUTER JOIN  SAPHEE.ZQMTW0203 AS B
      ON A.MANDT =  B.MANDT
    AND A.POSID = B.PSPID
    AND A.POSID_1 = B.POSID
    
   	LEFT OUTER JOIN  
	(SELECT  MAX(A.MANDT) AS MANDT, MAX( G.HOGI) AS HOGI,
             MAX(CASE WHEN A.ATNAM ='EL_ASTDA' THEN ( CASE WHEN ATWTB = ''  or ATWTB is null  THEN cast(CAST(ATFLV AS int) as char(10)) ELSE ATWTB END  )ELSE '' END) AS CH_CODE4 ,
             MAX(CASE WHEN A.ATNAM ='EL_DCCA'   THEN (CASE WHEN ATWTB = ''  or ATWTB is null  THEN cast(CAST(ATFLV AS int) as char(10)) ELSE ATWTB END )ELSE '' END ) AS CH_CODE9  ,
             MAX(CASE WHEN A.ATNAM ='EL_BWCAD' THEN (CASE WHEN ATWTB = ''  or ATWTB is null  THEN cast(CAST(ATFLV AS int) as char(10)) ELSE ATWTB END )ELSE '' END ) AS CH_CODE10  ,
             MAX(CASE WHEN A.ATNAM ='EL_BCDAD' THEN (CASE WHEN ATWTB = ''  or ATWTB is null  THEN cast(CAST(ATFLV AS int) as char(10)) ELSE ATWTB END )ELSE '' END ) AS CH_CODE11  ,
             MAX(CASE WHEN A.ATNAM ='EL_CHD1AD' THEN (CASE WHEN ATWTB = ''  or ATWTB is null  THEN cast(CAST(ATFLV AS int) as char(10)) ELSE ATWTB END )ELSE '' END ) AS CH_CODE12  ,
             MAX(CASE WHEN A.ATNAM ='EL_DEQS' THEN (CASE WHEN ATWTB = ''  or ATWTB is null  THEN cast(CAST(ATFLV AS int) as char(10)) ELSE ATWTB END )ELSE '' END ) AS CH_CODE20  ,
             MAX(CASE WHEN A.ATNAM ='EL_BCCRD'  THEN (CASE WHEN ATWTB = ''  or ATWTB is null  THEN cast(CAST(ATFLV AS int) as char(10)) ELSE ATWTB END )ELSE '' END ) AS CH_CODE25 ,
             MAX(CASE WHEN A.ATNAM ='EL_DPO'  THEN (CASE WHEN ATWTB = ''  or ATWTB is null  THEN cast(CAST(ATFLV AS int) as char(10)) ELSE ATWTB END )ELSE '' END ) AS CH_CODE27
     FROM   SAPHEE.CABN AS A INNER JOIN SAPHEE.IBSYMBOL AS C ON A.MANDT = C.MANDT AND A.ATINN = C.ATINN 
    INNER JOIN SAPHEE.IBINVALUES AS D ON C.MANDT = D.MANDT AND C.SYMBOL_ID = D.SYMBOL_ID 
    INNER JOIN SAPHEE.IBIN AS E ON D.MANDT = E.MANDT AND D.IN_RECNO = E.IN_RECNO 
    INNER JOIN SAPHEE.IBINOWN AS F ON E.MANDT = F.MANDT AND E.INSTANCE = F.INSTANCE 
    INNER JOIN SAPHEE.VBAP AS G ON F.MANDT = G.MANDT AND F.INSTANCE = G.CUOBJ 
    LEFT OUTER JOIN ( SELECT MANDT,ATINN, ATZHL,ADZHL,ATWRT FROM SAPHEE.CAWN ) AS H ON A.MANDT = H.MANDT AND A.ATINN = H.ATINN  AND C.ATWRT = H.ATWRT 
    LEFT OUTER JOIN SAPHEE.CAWNT AS I ON H.MANDT = I.MANDT AND H.ATINN = I.ATINN AND H.ATZHL = I.ATZHL AND I.SPRAS = '3' 
   WHERE A.MANDT = #G_MANDT#
     AND G.HOGI = #HNO#
	 AND A.ATNAM  in ('EL_ASTDA','EL_DCCA','EL_BWCAD','EL_BCDAD','EL_CHD1AD',
                      'EL_DEQS','EL_BCCRD','EL_DPO' ) 
) AS T
   ON A.MANDT = T.MANDT
   AND A.POSID = SUBSTR(T.HOGI,1,6)
   AND A.POSID_1 = T.HOGI 

 WHERE A.MANDT = #G_MANDT#
     AND A.POSID = #PJT#
     AND A.POSID_1 = #HNO#

FOR FETCH ONLY
WITH UR	]]></statement>
	<input default-name="ds_cond">
	</input>
	<output default-name="ds_master">
	</output>
</query>
