<?xml version="1.0" encoding="euc-kr"?>
<query>
	<type>select</type>
	<description><![CDATA[]]></description>
	<reload>true</reload>
	<monitoring>true</monitoring>
	<result-count>0</result-count>
	<statement>
<![CDATA[
SELECT  A.POSID AS PSPID,  C.NAME1  AS LIFNRNM, '(' || B.NAMET2 || ')' AS NAMET2
             ,B.NAMET AS PMNM,  A.ZSITE_NM,  B.ZSPEC1,  B.ZSPEC2
             ,SUBSTR(B.POSID_1, 7,3) || '(' || B.POSID_OLD || ')'  AS HOGI
             ,B.POSID_1 AS POSID
             ,D.INTERPHON,  D.BD_SERNO,  D.SIZE1,  D.SIZE2,  D.SIZE3,  D.SIZE4
             ,D.SIZE5,  D.SIZE6,  D.SIZE7,  D.SIZE8,  D.SIZE9,  D.SIZE10
             ,VALUE(CAST(D.BIGO AS VARCHAR(3000)), '') AS BIGO
             ,B.ZBEPJEO, B.ZZGUBUN
             ,E.PAPRDT,  E.PAPRIDTX
             ,(SELECT BIGO FROM SAPHEE.ZQMTW0101B WHERE MANDT = #G_MANDT# AND PSPID = #PSPID# AND POSID = #POSID#) AS SBIGO
             ,CODE3_1,    CODE3_2,    CODE3_3,    CODE3_4,    CODE3_5,    CODE3_6,    CODE3_7,    CODE3_8,    CODE3_9,    CODE3_10    
             ,CODE3_11,  CODE3_12,   CODE3_13,  CODE3_14,   CODE3_15,  CODE3_16,   CODE3_17,  CODE3_18,   CODE3_19,  CODE3_20    
             ,CODE3_21,  CODE3_22,   CODE3_23,  CODE3_24,   CODE3_25,  CODE3_26,   CODE3_27,  CODE3_28,   CODE3_29,  CODE3_30    
             ,VALUE((SELECT Z.VALUE FROM SAPHEE.ZSDT0005 AS Z WHERE Z.MANDT =#G_MANDT#  AND Z.HOGI =   #POSID# AND Z.CHARACTERISTIC = 'EL_ASTD'  
                  AND Z.SEQ = (SELECT MAX(X.SEQ) FROM SAPHEE.ZSDT0005 AS X WHERE X.MANDT = Z.MANDT AND X.HOGI = Z.HOGI AND X.CHARACTERISTIC = Z.CHARACTERISTIC)), '') AS CH_CODE3
             ,VALUE(T.CH_CODE4  ,'') AS CH_CODE4  
             ,VALUE((SELECT Z.VALUE FROM SAPHEE.ZSDT0005 AS Z WHERE Z.MANDT =#G_MANDT#  AND Z.HOGI =   #POSID# AND Z.CHARACTERISTIC = 'EL_ECBG'  
                  AND Z.SEQ = (SELECT MAX(X.SEQ) FROM SAPHEE.ZSDT0005 AS X WHERE X.MANDT = Z.MANDT AND X.HOGI = Z.HOGI AND X.CHARACTERISTIC = Z.CHARACTERISTIC)), '') AS CH_CODE5
             ,VALUE((SELECT Z.VALUE FROM SAPHEE.ZSDT0005 AS Z WHERE Z.MANDT =#G_MANDT#  AND Z.HOGI =   #POSID# AND Z.CHARACTERISTIC = 'EL_ECWBG'   
                  AND Z.SEQ = (SELECT MAX(X.SEQ) FROM SAPHEE.ZSDT0005 AS X WHERE X.MANDT = Z.MANDT AND X.HOGI = Z.HOGI AND X.CHARACTERISTIC = Z.CHARACTERISTIC)), '') AS CH_CODE6
             ,VALUE((SELECT Z.VALUE FROM SAPHEE.ZSDT0005 AS Z WHERE Z.MANDT =#G_MANDT#  AND Z.HOGI =   #POSID# AND Z.CHARACTERISTIC = 'EL_EHP'   
                  AND Z.SEQ = (SELECT MAX(X.SEQ) FROM SAPHEE.ZSDT0005 AS X WHERE X.MANDT = Z.MANDT AND X.HOGI = Z.HOGI AND X.CHARACTERISTIC = Z.CHARACTERISTIC)), '') AS CH_CODE7
             ,VALUE((SELECT Z.VALUE FROM SAPHEE.ZSDT0005 AS Z WHERE Z.MANDT =#G_MANDT#  AND Z.HOGI =   #POSID# AND Z.CHARACTERISTIC = 'EL_DVS'    
                  AND Z.SEQ = (SELECT MAX(X.SEQ) FROM SAPHEE.ZSDT0005 AS X WHERE X.MANDT = Z.MANDT AND X.HOGI = Z.HOGI AND X.CHARACTERISTIC = Z.CHARACTERISTIC)), '') AS CH_CODE8  
             ,VALUE(T.CH_CODE9  ,'') AS CH_CODE9     
             ,VALUE(T.CH_CODE10  ,'') AS CH_CODE10  
             ,VALUE(T.CH_CODE11  ,'') AS CH_CODE11  
             ,VALUE(T.CH_CODE12  ,'') AS CH_CODE12          
             ,VALUE((SELECT Z.VALUE FROM SAPHEE.ZSDT0005 AS Z WHERE Z.MANDT =#G_MANDT#  AND Z.HOGI =   #POSID# AND Z.CHARACTERISTIC = 'EL_DCP'   
                 AND Z.SEQ = (SELECT MAX(X.SEQ) FROM SAPHEE.ZSDT0005 AS X WHERE X.MANDT = Z.MANDT AND X.HOGI = Z.HOGI AND X.CHARACTERISTIC = Z.CHARACTERISTIC)), '') AS CH_CODE13
             ,VALUE((SELECT Z.VALUE FROM SAPHEE.ZSDT0005 AS Z WHERE Z.MANDT =#G_MANDT#  AND Z.HOGI =   #POSID# AND Z.CHARACTERISTIC = 'EL_ETM'   
                 AND Z.SEQ = (SELECT MAX(X.SEQ) FROM SAPHEE.ZSDT0005 AS X WHERE X.MANDT = Z.MANDT AND X.HOGI = Z.HOGI AND X.CHARACTERISTIC = Z.CHARACTERISTIC)), '') AS CH_CODE14
             ,VALUE((SELECT Z.VALUE FROM SAPHEE.ZSDT0005 AS Z WHERE Z.MANDT =#G_MANDT#  AND Z.HOGI =   #POSID# AND Z.CHARACTERISTIC = 'EL_ADRV'  
                 AND Z.SEQ = (SELECT MAX(X.SEQ) FROM SAPHEE.ZSDT0005 AS X WHERE X.MANDT = Z.MANDT AND X.HOGI = Z.HOGI AND X.CHARACTERISTIC = Z.CHARACTERISTIC)), '') AS CH_CODE15
             ,VALUE((SELECT Z.VALUE FROM SAPHEE.ZSDT0005 AS Z WHERE Z.MANDT =#G_MANDT#  AND Z.HOGI =   #POSID# AND Z.CHARACTERISTIC = 'EL_DFCC'    
                 AND Z.SEQ = (SELECT MAX(X.SEQ) FROM SAPHEE.ZSDT0005 AS X WHERE X.MANDT = Z.MANDT AND X.HOGI = Z.HOGI AND X.CHARACTERISTIC = Z.CHARACTERISTIC)), '') AS CH_CODE16
             ,VALUE((SELECT Z.CHAR_VALUE FROM SAPHEE.ZSDT0094  AS Z WHERE Z.MANDT = #G_MANDT#  AND Z.HOGI = #POSID# AND Z.NAM_CHAR = 'EL_DHCC'
			      AND Z.SEQ = ( SELECT MAX(X.SEQ)  FROM SAPHEE.ZSDT0094 AS X  WHERE X.MANDT = Z.MANDT  AND X.HOGI = Z.HOGI  AND X.NAM_CHAR = Z.NAM_CHAR)), '') AS CH_CODE17
             ,VALUE((SELECT Z.VALUE FROM SAPHEE.ZSDT0005 AS Z WHERE Z.MANDT =#G_MANDT#  AND Z.HOGI =   #POSID# AND Z.CHARACTERISTIC = 'EL_DHSE' 
                 AND Z.SEQ = (SELECT MAX(X.SEQ) FROM SAPHEE.ZSDT0005 AS X WHERE X.MANDT = Z.MANDT AND X.HOGI = Z.HOGI AND X.CHARACTERISTIC = Z.CHARACTERISTIC)), '') AS CH_CODE18
             ,VALUE((SELECT Z.VALUE FROM SAPHEE.ZSDT0005 AS Z WHERE Z.MANDT =#G_MANDT#  AND Z.HOGI =   #POSID# AND Z.CHARACTERISTIC = 'EL_DFGAD' 
                 AND Z.SEQ = (SELECT MAX(X.SEQ) FROM SAPHEE.ZSDT0005 AS X WHERE X.MANDT = Z.MANDT AND X.HOGI = Z.HOGI AND X.CHARACTERISTIC = Z.CHARACTERISTIC)), '') AS CH_CODE19
             ,VALUE(T.CH_CODE20  ,'') AS CH_CODE20
             ,VALUE((SELECT Z.VALUE FROM SAPHEE.ZSDT0005 AS Z WHERE Z.MANDT =#G_MANDT#  AND Z.HOGI =   #POSID# AND Z.CHARACTERISTIC = 'EL_DTMDP' 
                 AND Z.SEQ = (SELECT MAX(X.SEQ) FROM SAPHEE.ZSDT0005 AS X WHERE X.MANDT = Z.MANDT AND X.HOGI = Z.HOGI AND X.CHARACTERISTIC = Z.CHARACTERISTIC)), '') AS CH_CODE21
             ,VALUE((SELECT Z.VALUE FROM SAPHEE.ZSDT0005 AS Z WHERE Z.MANDT =#G_MANDT#  AND Z.HOGI =   #POSID# AND Z.CHARACTERISTIC = 'EL_DTS'   
                 AND Z.SEQ = (SELECT MAX(X.SEQ) FROM SAPHEE.ZSDT0005 AS X WHERE X.MANDT = Z.MANDT AND X.HOGI = Z.HOGI AND X.CHARACTERISTIC = Z.CHARACTERISTIC)), '') AS CH_CODE22
             ,VALUE((SELECT Z.VALUE FROM SAPHEE.ZSDT0005 AS Z WHERE Z.MANDT =#G_MANDT#  AND Z.HOGI =   #POSID# AND Z.CHARACTERISTIC = 'EL_DBC'  
                 AND Z.SEQ = (SELECT MAX(X.SEQ) FROM SAPHEE.ZSDT0005 AS X WHERE X.MANDT = Z.MANDT AND X.HOGI = Z.HOGI AND X.CHARACTERISTIC = Z.CHARACTERISTIC)), '') AS CH_CODE23
             ,VALUE((SELECT (CASE WHEN Z.VALUE = 'DG360'
                                THEN 'Y'
                                ELSE ''
                                END) AS VALUE
                       FROM SAPHEE.ZSDT0005 AS Z WHERE Z.MANDT =#G_MANDT#  AND Z.HOGI =   #POSID# AND Z.CHARACTERISTIC = 'EL_ECGV' 
                AND Z.SEQ = (SELECT MAX(X.SEQ) FROM SAPHEE.ZSDT0005 AS X WHERE X.MANDT = Z.MANDT AND X.HOGI = Z.HOGI AND X.CHARACTERISTIC = Z.CHARACTERISTIC)), '') AS CH_CODE24
             ,VALUE(T.CH_CODE25 ,'') AS CH_CODE25
             ,VALUE((SELECT Z.VALUE FROM SAPHEE.ZSDT0005 AS Z WHERE Z.MANDT =#G_MANDT#  AND Z.HOGI =   #POSID# AND Z.CHARACTERISTIC = 'EL_CHLF'   
                AND Z.SEQ = (SELECT MAX(X.SEQ) FROM SAPHEE.ZSDT0005 AS X WHERE X.MANDT = Z.MANDT AND X.HOGI = Z.HOGI AND X.CHARACTERISTIC = Z.CHARACTERISTIC)), '') AS CH_CODE26
             ,VALUE(T.CH_CODE27 ,'') AS CH_CODE27
             ,VALUE((SELECT Z.VALUE FROM SAPHEE.ZSDT0005 AS Z WHERE Z.MANDT =#G_MANDT#  AND Z.HOGI =   #POSID# AND Z.CHARACTERISTIC = 'EL_DSPD'   
                AND Z.SEQ = (SELECT MAX(X.SEQ) FROM SAPHEE.ZSDT0005 AS X WHERE X.MANDT = Z.MANDT AND X.HOGI = Z.HOGI AND X.CHARACTERISTIC = Z.CHARACTERISTIC)), '') AS CH_CODE28
             ,VALUE((SELECT Z.VALUE FROM SAPHEE.ZSDT0005 AS Z WHERE Z.MANDT =#G_MANDT#  AND Z.HOGI =   #POSID# AND Z.CHARACTERISTIC = 'EL_CJM1FR'   
                AND Z.SEQ = (SELECT MAX(X.SEQ) FROM SAPHEE.ZSDT0005 AS X WHERE X.MANDT = Z.MANDT AND X.HOGI = Z.HOGI AND X.CHARACTERISTIC = Z.CHARACTERISTIC)), '') AS CH_CODE29
             ,VALUE((SELECT Z.VALUE FROM SAPHEE.ZSDT0005 AS Z WHERE Z.MANDT =#G_MANDT#  AND Z.HOGI =   #POSID# AND Z.CHARACTERISTIC = 'EL_CJM2FR'   
                AND Z.SEQ = (SELECT MAX(X.SEQ) FROM SAPHEE.ZSDT0005 AS X WHERE X.MANDT = Z.MANDT AND X.HOGI = Z.HOGI AND X.CHARACTERISTIC = Z.CHARACTERISTIC)), '') AS CH_CODE30
             ,VALUE((SELECT Z.VALUE FROM SAPHEE.ZSDT0005 AS Z WHERE Z.MANDT =#G_MANDT#  AND Z.HOGI =   #POSID# AND Z.CHARACTERISTIC = 'EL_AFF'   
                AND Z.SEQ = (SELECT MAX(X.SEQ) FROM SAPHEE.ZSDT0005 AS X WHERE X.MANDT = Z.MANDT AND X.HOGI = Z.HOGI AND X.CHARACTERISTIC = Z.CHARACTERISTIC)), '') AS CH_CODE31
             ,VALUE((SELECT Z.VALUE FROM SAPHEE.ZSDT0005 AS Z WHERE Z.MANDT =#G_MANDT#  AND Z.HOGI =  #POSID# AND Z.CHARACTERISTIC = 'EL_ARF'   
                AND Z.SEQ = (SELECT MAX(X.SEQ) FROM SAPHEE.ZSDT0005 AS X WHERE X.MANDT = Z.MANDT AND X.HOGI = Z.HOGI AND X.CHARACTERISTIC = Z.CHARACTERISTIC)), '') AS CH_CODE32
   			 , SUBSTR(B.POSID_1,1,1) AS POSID_A
		     , SUBSTR(B.POSID_1,2,1) AS POSID_B
		     , SUBSTR(B.POSID_1,3,1) AS POSID_C
		     , SUBSTR(B.POSID_1,4,1) AS POSID_D
		     , SUBSTR(B.POSID_1,5,1) AS POSID_E
		     , SUBSTR(B.POSID_1,6,1) AS POSID_F
		     , SUBSTR(B.POSID_1,8,1) AS POSID_G
		     , SUBSTR(B.POSID_1,9,1) AS POSID_H
		     , SUBSTR(B.POSID_1,7,1) AS POSID_I
		     , VALUE((SELECT Z.VALUE 
		                FROM SAPHEE.ZSDT0005 AS Z 
		               WHERE Z.MANDT = #G_MANDT#  
		                 AND Z.HOGI  =   #POSID# 
		                 AND Z.CHARACTERISTIC = 'EL_ERBQ'  
                         AND Z.SEQ = (SELECT MAX(X.SEQ) 
                                        FROM SAPHEE.ZSDT0005 AS X 
                                       WHERE X.MANDT = Z.MANDT 
                                         AND X.HOGI = Z.HOGI 
                                         AND X.CHARACTERISTIC = Z.CHARACTERISTIC)), '') AS EL_ERBQ
			 , 'N' AS RESET_INDC
			 , 'N' AS MOD_INDC
			 , 'N' AS RESET_MOD
 FROM SAPHEE.ZMASTER01 AS A
   INNER JOIN SAPHEE.ZMASTER02 AS B
        ON A.MANDT = B.MANDT
      AND A.POSID = B.POSID
    LEFT OUTER JOIN SAPHEE.LFA1 AS C
       ON B.MANDT = C.MANDT
     AND B.LIFNR = C.LIFNR
    LEFT OUTER JOIN SAPHEE.ZQMTW0203 AS D
       ON B.MANDT = D.MANDT
     AND B.POSID = D.PSPID
     AND B.POSID_1 = D.POSID
     
      	LEFT OUTER JOIN  
	(SELECT  MAX(A.MANDT) AS MANDT, MAX( G.HOGI) AS HOGI,
             MAX(CASE WHEN A.ATNAM ='EL_ASTDA' THEN ( CASE WHEN ATWTB = ''  or ATWTB is null  THEN cast(CAST(ATFLV AS int) as char(10)) ELSE ATWTB END  )ELSE '' END) AS CH_CODE4 ,
             MAX(CASE WHEN A.ATNAM ='EL_DCCA'   THEN (CASE WHEN ATWTB = ''  or ATWTB is null  THEN cast(CAST(ATFLV AS int) as char(10)) ELSE ATWTB END )ELSE '' END ) AS CH_CODE9  ,
             MAX(CASE WHEN A.ATNAM ='EL_BWCAD' THEN (CASE WHEN ATWTB = ''  or ATWTB is null  THEN cast(CAST(ATFLV AS int) as char(10)) ELSE ATWTB END )ELSE '' END ) AS CH_CODE10  ,
             MAX(CASE WHEN A.ATNAM ='EL_BCDAD' THEN (CASE WHEN ATWTB = ''  or ATWTB is null  THEN cast(CAST(ATFLV AS int) as char(10)) ELSE ATWTB END )ELSE '' END ) AS CH_CODE11  ,
             MAX(CASE WHEN A.ATNAM ='EL_CHD1AD' THEN (CASE WHEN ATWTB = ''  or ATWTB is null  THEN cast(CAST(ATFLV AS int) as char(10)) ELSE ATWTB END )ELSE '' END ) AS CH_CODE12  ,
             MAX(CASE WHEN A.ATNAM ='EL_DEQS' THEN (CASE WHEN ATWTB = ''  or ATWTB is null  THEN cast(CAST(ATFLV AS int) as char(10)) ELSE ATWTB END )ELSE '' END ) AS CH_CODE20  ,
             MAX(CASE WHEN A.ATNAM ='EL_BCCRD'  THEN (CASE WHEN ATWTB = ''  or ATWTB is null  THEN cast(CAST(ATFLV AS int) as char(10)) ELSE ATWTB END )ELSE '' END ) AS CH_CODE25 ,
             MAX(CASE WHEN A.ATNAM ='EL_DPO'  THEN (CASE WHEN ATWTB = ''  or ATWTB is null  THEN cast(CAST(ATFLV AS int) as char(10)) ELSE ATWTB END )ELSE '' END ) AS CH_CODE27 
     FROM   SAPHEE.CABN AS A INNER JOIN SAPHEE.IBSYMBOL AS C ON A.MANDT = C.MANDT AND A.ATINN = C.ATINN 
    INNER JOIN SAPHEE.IBINVALUES AS D ON C.MANDT = D.MANDT AND C.SYMBOL_ID = D.SYMBOL_ID 
    INNER JOIN SAPHEE.IBIN AS E ON D.MANDT = E.MANDT AND D.IN_RECNO = E.IN_RECNO 
    INNER JOIN SAPHEE.IBINOWN AS F ON E.MANDT = F.MANDT AND E.INSTANCE = F.INSTANCE 
    INNER JOIN SAPHEE.VBAP AS G ON F.MANDT = G.MANDT AND F.INSTANCE = G.CUOBJ 
    LEFT OUTER JOIN ( SELECT MANDT,ATINN, ATZHL,ADZHL,ATWRT FROM SAPHEE.CAWN ) AS H ON A.MANDT = H.MANDT AND A.ATINN = H.ATINN  AND C.ATWRT = H.ATWRT 
    LEFT OUTER JOIN SAPHEE.CAWNT AS I ON H.MANDT = I.MANDT AND H.ATINN = I.ATINN AND H.ATZHL = I.ATZHL AND I.SPRAS = '3' 
   WHERE A.MANDT = #G_MANDT#
     AND G.HOGI = #POSID#
	 AND A.ATNAM  in ('EL_ASTDA','EL_DCCA','EL_BWCAD','EL_BCDAD','EL_CHD1AD',
                      'EL_DEQS','EL_BCCRD','EL_DPO' ) 
) AS T
   ON B.MANDT = T.MANDT
   AND B.POSID = SUBSTR(T.HOGI,1,6)
   AND B.POSID_1 = T.HOGI 
   
     
    LEFT OUTER JOIN ( SELECT X.MANDT,  X.PSPID, X.HOGI, X.PAPRDT, X.PAPRIDTX
                                     FROM SAPHEE.ZQMT019 AS X
                                   WHERE X.MANDT = #G_MANDT#
                                       AND X.WERKS = '1000'
                                       AND X.PSPID = #PSPID#
                                       AND X.ART = '8960'
                                       AND X.HOGI = #POSID#
                                     ORDER BY X.SEQ DESC
                                   FETCH FIRST 1 ROWS ONLY ) AS E
       ON B.MANDT = E.MANDT
     AND B.POSID = E.PSPID
     AND B.POSID_1 = E.HOGI
    LEFT OUTER JOIN ( SELECT  F.MANDT, F.PSPID, F.POSID
                                              ,MAX(CASE WHEN F.ROWN = 1 THEN F.CODE3 ELSE '' END) AS CODE3_1	 
                                              ,MAX(CASE WHEN F.ROWN = 2 THEN F.CODE3 ELSE '' END) AS CODE3_2
			    ,MAX(CASE WHEN F.ROWN = 3 THEN F.CODE3 ELSE '' END) AS CODE3_3	     
                                              ,MAX(CASE WHEN F.ROWN = 4 THEN F.CODE3 ELSE '' END) AS CODE3_4
			    ,MAX(CASE WHEN F.ROWN = 5 THEN F.CODE3 ELSE '' END) AS CODE3_5	     
                                              ,MAX(CASE WHEN F.ROWN = 6 THEN F.CODE3 ELSE '' END) AS CODE3_6
			    ,MAX(CASE WHEN F.ROWN = 7 THEN F.CODE3 ELSE '' END) AS CODE3_7      
                                              ,MAX(CASE WHEN F.ROWN = 8 THEN F.CODE3 ELSE '' END) AS CODE3_8			 
			    ,MAX(CASE WHEN F.ROWN = 9 THEN F.CODE3 ELSE '' END) AS CODE3_9      
                                              ,MAX(CASE WHEN F.ROWN = 10 THEN F.CODE3 ELSE '' END) AS CODE3_10
			    ,MAX(CASE WHEN F.ROWN = 11 THEN F.CODE3 ELSE '' END) AS CODE3_11   
                                              ,MAX(CASE WHEN F.ROWN = 12 THEN F.CODE3 ELSE '' END) AS CODE3_12
			    ,MAX(CASE WHEN F.ROWN = 13 THEN F.CODE3 ELSE '' END) AS CODE3_13   
                                              ,MAX(CASE WHEN F.ROWN = 14 THEN F.CODE3 ELSE '' END) AS CODE3_14
			    ,MAX(CASE WHEN F.ROWN = 15 THEN F.CODE3 ELSE '' END) AS CODE3_15   
                                              ,MAX(CASE WHEN F.ROWN = 16 THEN F.CODE3 ELSE '' END) AS CODE3_16
			    ,MAX(CASE WHEN F.ROWN = 17 THEN F.CODE3 ELSE '' END) AS CODE3_17   
                                              ,MAX(CASE WHEN F.ROWN = 18 THEN F.CODE3 ELSE '' END) AS CODE3_18
			    ,MAX(CASE WHEN F.ROWN = 19 THEN F.CODE3 ELSE '' END) AS CODE3_19   
                                              ,MAX(CASE WHEN F.ROWN = 20 THEN F.CODE3 ELSE '' END) AS CODE3_20
			    ,MAX(CASE WHEN F.ROWN = 21 THEN F.CODE3 ELSE '' END) AS CODE3_21   
                                              ,MAX(CASE WHEN F.ROWN = 22 THEN F.CODE3 ELSE '' END) AS CODE3_22
			    ,MAX(CASE WHEN F.ROWN = 23 THEN F.CODE3 ELSE '' END) AS CODE3_23   
                                              ,MAX(CASE WHEN F.ROWN = 24 THEN F.CODE3 ELSE '' END) AS CODE3_24
			    ,MAX(CASE WHEN F.ROWN = 25 THEN F.CODE3 ELSE '' END) AS CODE3_25   
                                              ,MAX(CASE WHEN F.ROWN = 26 THEN F.CODE3 ELSE '' END) AS CODE3_26
			    ,MAX(CASE WHEN F.ROWN = 27 THEN F.CODE3 ELSE '' END) AS CODE3_27   
                                              ,MAX(CASE WHEN F.ROWN = 28 THEN F.CODE3 ELSE '' END) AS CODE3_28
			    ,MAX(CASE WHEN F.ROWN = 29 THEN F.CODE3 ELSE '' END) AS CODE3_29   
                                              ,MAX(CASE WHEN F.ROWN = 30 THEN F.CODE3 ELSE '' END) AS CODE3_30
			  
                                    FROM (
                                                SELECT  ROW_NUMBER() OVER(PARTITION BY X.MANDT, X.PSPID, X.POSID 
                                                              ORDER BY X.MANDT, X.PSPID, X.POSID, X.CODE1, X.CODE2, X.CODE3 ) AS ROWN
                                                             ,X.MANDT, X.PSPID, X.POSID
                                                             --,X2.CODENM AS CODE3
                                                             ,(CASE WHEN X2.CODENM = '±âÅ¸' THEN X.BIGO ELSE X2.CODENM END) AS CODE3
                                                   FROM SAPHEE.ZQMTW0202 AS X
                                                   INNER JOIN SAPHEE.ZQMTW0201 AS X2
                                                       ON  X.MANDT = X2.MANDT
                                                     AND  X.CODE3  = X2.CODE
                                                     AND  X.ZZGUBUN = X2.ZZGUBUN
                                                  WHERE X.MANDT = #G_MANDT#
                                                      AND X.PSPID = #PSPID#     AND   X.POSID = #POSID#
	                                 ) AS F
	 
	                      GROUP BY  F.MANDT, F.PSPID, F.POSID  ) AS G
      ON B.MANDT = G.MANDT
    AND B.POSID = G.PSPID
    AND B.POSID_1 = G.POSID


 WHERE A.MANDT = #G_MANDT#
     AND A.POSID = #PSPID#
     AND B.POSID_1 = #POSID#

FOR FETCH ONLY
WITH UR	]]></statement>
	<input default-name="ds_master">
	</input>
	<output default-name="ds_print">
	</output>
</query>
