<?xml version="1.0" encoding="euc-kr"?>
<query dynamic="true">
	<type>select</type>
	<description><![CDATA[리포트 일자별 현황 요약 조회]]></description>
	<reload>true</reload>
	<monitoring>true</monitoring>
	<result-count>0</result-count>
	<statement>		
		SELECT T1.ZKNUM AS ZKNUM, T1.ZKNUM2 AS ZKNUM2, CASE WHEN TPLSTDT1 = '' THEN BEZEI ELSE  LF1.NAME1 END NAME, 
	        CASE WHEN TPLSTDT1 = '' THEN 
	        SUBSTR(CASE WHEN T1.ZTON1  > 0 THEN ',1T-'       || TRIM(CHAR(T1.ZTON1 )) ELSE '' END ||
	        CASE WHEN T1.ZTON2  > 0 THEN ',2.5T-'     || TRIM(CHAR(T1.ZTON2 )) ELSE '' END ||
	        CASE WHEN T1.ZTON3  > 0 THEN ',3.5T-'     || TRIM(CHAR(T1.ZTON3 )) ELSE '' END ||
	        CASE WHEN T1.ZTON4  > 0 THEN ',5T-'       || TRIM(CHAR(T1.ZTON4 )) ELSE '' END ||
	        CASE WHEN T1.ZTON5  > 0 THEN ',8T-'       || TRIM(CHAR(T1.ZTON5 )) ELSE '' END ||
	        CASE WHEN T1.ZTON6  > 0 THEN ',11T-'      || TRIM(CHAR(T1.ZTON6 )) ELSE '' END ||
	        CASE WHEN T1.ZTON7  > 0 THEN ',18T-'      || TRIM(CHAR(T1.ZTON7 )) ELSE '' END ||
	        CASE WHEN T1.ZTON8  > 0 THEN ',25T-'      || TRIM(CHAR(T1.ZTON8 )) ELSE '' END ||
	        CASE WHEN T1.ZTON9  > 0 THEN ',Trailer-'  || TRIM(CHAR(T1.ZTON9 )) ELSE '' END ||
	        CASE WHEN T1.ZTON10 > 0 THEN ',택배-' || TRIM(CHAR(T1.ZTON10)) ELSE '' END ||
	        CASE WHEN T1.ZTON11 > 0 THEN ',Trailer(20)-' || TRIM(CHAR(T1.ZTON11)) ELSE '' END ||
	        CASE WHEN T1.ZTON12 > 0 THEN ',Trailer(40)-' || TRIM(CHAR(T1.ZTON12)) ELSE '' END ||
	        CASE WHEN T1.ZTON13 > 0 THEN ',Trailer(20)round-' || TRIM(CHAR(T1.ZTON13)) ELSE '' END ||
	        CASE WHEN T1.ZTON15 > 0 THEN ',셔틀-' || TRIM(CHAR(T1.ZTON15)) ELSE '' END ||
	        CASE WHEN T1.ZTON14 > 0 THEN ',Trailer(40)round-' || TRIM(CHAR(T1.ZTON14)) ELSE '' END,2)
	    	ELSE TPLSTDTZTON1 END TPLSTDTZTON, '1' ORD
	    	, SAPHEE.GET_LE_SPEC(T1.MANDT,T1.ZKNUM,T1.ZKNUM2) AS SPEC
		FROM SAPHEE.ZLET002 AS T1 LEFT OUTER JOIN SAPHEE.ZMMT012 AS LF1 ON T1.TPLSTDT1 = LF1.LIFNR 		
		WHERE T1.MANDT = #G_MANDT# AND T1.ERDAT =  #ERDAT#
		UNION ALL
    	SELECT T1.ZKNUM AS ZKNUM, T1.ZKNUM2 AS ZKNUM2, BEZEI AS NAME,         
	        SUBSTR(CASE WHEN T1.ZTON1  > 0 THEN ',1T-'       || TRIM(CHAR(T1.ZTON1 )) ELSE '' END ||
	        CASE WHEN T1.ZTON2  > 0 THEN ',2.5T-'     || TRIM(CHAR(T1.ZTON2 )) ELSE '' END ||
	        CASE WHEN T1.ZTON3  > 0 THEN ',3.5T-'     || TRIM(CHAR(T1.ZTON3 )) ELSE '' END ||
	        CASE WHEN T1.ZTON4  > 0 THEN ',5T-'       || TRIM(CHAR(T1.ZTON4 )) ELSE '' END ||
	        CASE WHEN T1.ZTON5  > 0 THEN ',8T-'       || TRIM(CHAR(T1.ZTON5 )) ELSE '' END ||
	        CASE WHEN T1.ZTON6  > 0 THEN ',11T-'      || TRIM(CHAR(T1.ZTON6 )) ELSE '' END ||
	        CASE WHEN T1.ZTON7  > 0 THEN ',18T-'      || TRIM(CHAR(T1.ZTON7 )) ELSE '' END ||
	        CASE WHEN T1.ZTON8  > 0 THEN ',25T-'      || TRIM(CHAR(T1.ZTON8 )) ELSE '' END ||
	        CASE WHEN T1.ZTON9  > 0 THEN ',Trailer-'  || TRIM(CHAR(T1.ZTON9 )) ELSE '' END ||
	        CASE WHEN T1.ZTON10 > 0 THEN ',택배-' || TRIM(CHAR(T1.ZTON10)) ELSE '' END ||
	        CASE WHEN T1.ZTON11 > 0 THEN ',Trailer(20)-' || TRIM(CHAR(T1.ZTON11)) ELSE '' END ||
	        CASE WHEN T1.ZTON12 > 0 THEN ',Trailer(40)-' || TRIM(CHAR(T1.ZTON12)) ELSE '' END ||
	        CASE WHEN T1.ZTON13 > 0 THEN ',Trailer(20)round-' || TRIM(CHAR(T1.ZTON13)) ELSE '' END ||
	        CASE WHEN T1.ZTON15 > 0 THEN ',셔틀-' || TRIM(CHAR(T1.ZTON15)) ELSE '' END ||
	        CASE WHEN T1.ZTON14 > 0 THEN ',Trailer(40)round-' || TRIM(CHAR(T1.ZTON14)) ELSE '' END,2)
	    	AS TPLSTDTZTON, '7' ORD
	    	, SAPHEE.GET_LE_SPEC(T1.MANDT,T1.ZKNUM,T1.ZKNUM2) AS SPEC
		FROM SAPHEE.ZLET006 AS T1
		WHERE T1.MANDT = #G_MANDT# AND T1.ERDAT =  #ERDAT#
		UNION ALL
		SELECT T1.ZKNUM AS ZKNUM, T1.ZKNUM2 AS ZKNUM2, LF2.NAME1 AS NAME, TPLSTDTZTON2 AS TPLSTDTZTON, '2' ORD, SAPHEE.GET_LE_SPEC(T1.MANDT,T1.ZKNUM,T1.ZKNUM2) AS SPEC
		FROM SAPHEE.ZLET002 AS T1 LEFT OUTER JOIN SAPHEE.ZMMT012 AS LF2 ON T1.TPLSTDT2 = LF2.LIFNR 
		WHERE T1.MANDT = #G_MANDT#  AND T1.ERDAT =  #ERDAT# AND TPLSTDTZTON2 &lt;&gt; ''
		UNION ALL
		SELECT T1.ZKNUM AS ZKNUM, T1.ZKNUM2 AS ZKNUM2, LF3.NAME1 AS NAME, TPLSTDTZTON3 AS TPLSTDTZTON, '3' ORD, SAPHEE.GET_LE_SPEC(T1.MANDT,T1.ZKNUM,T1.ZKNUM2) AS SPEC
		FROM SAPHEE.ZLET002 AS T1 LEFT OUTER JOIN SAPHEE.ZMMT012 AS LF3 ON T1.TPLSTDT3 = LF3.LIFNR 
		WHERE T1.MANDT = #G_MANDT#  AND T1.ERDAT =  #ERDAT# AND TPLSTDTZTON3 &lt;&gt; ''
		UNION ALL
		SELECT T1.ZKNUM AS ZKNUM, T1.ZKNUM2 AS ZKNUM2, LF4.NAME1 AS NAME, TPLSTDTZTON4 AS TPLSTDTZTON, '4' ORD, SAPHEE.GET_LE_SPEC(T1.MANDT,T1.ZKNUM,T1.ZKNUM2) AS SPEC
		FROM SAPHEE.ZLET002 AS T1 LEFT OUTER JOIN SAPHEE.ZMMT012 AS LF4 ON T1.TPLSTDT4 = LF4.LIFNR 
		WHERE T1.MANDT = #G_MANDT#  AND T1.ERDAT =  #ERDAT# AND TPLSTDTZTON4 &lt;&gt; ''
		UNION ALL
		SELECT T1.ZKNUM AS ZKNUM, T1.ZKNUM2 AS ZKNUM2, LF5.NAME1 AS NAME, TPLSTDTZTON5 AS TPLSTDTZTON, '5' ORD, SAPHEE.GET_LE_SPEC(T1.MANDT,T1.ZKNUM,T1.ZKNUM2) AS SPEC
		FROM SAPHEE.ZLET002 AS T1 LEFT OUTER JOIN SAPHEE.ZMMT012 AS LF5 ON T1.TPLSTDT5 = LF5.LIFNR 
		WHERE T1.MANDT = #G_MANDT#  AND T1.ERDAT =  #ERDAT# AND  TPLSTDTZTON5 &lt;&gt; ''
		UNION ALL
		SELECT T1.ZKNUM AS ZKNUM, T1.ZKNUM2 AS ZKNUM2, LF6.NAME1 AS NAME, TPLSTDTZTON6 AS TPLSTDTZTON, '6' ORD, SAPHEE.GET_LE_SPEC(T1.MANDT,T1.ZKNUM,T1.ZKNUM2) AS SPEC
		FROM SAPHEE.ZLET002 AS T1 LEFT OUTER JOIN SAPHEE.ZMMT012 AS LF6 ON T1.TPLSTDT6 = LF6.LIFNR 
		WHERE T1.MANDT = #G_MANDT#  AND T1.ERDAT =  #ERDAT# AND TPLSTDTZTON6 &lt;&gt; ''
		UNION ALL
		SELECT T1.ZKNUM AS ZKNUM, T1.ZKNUM2 AS ZKNUM2, LF7.NAME1 AS NAME, TPLSTDTZTON7 AS TPLSTDTZTON, '7' ORD, SAPHEE.GET_LE_SPEC(T1.MANDT,T1.ZKNUM,T1.ZKNUM2) AS SPEC
		FROM SAPHEE.ZLET002 AS T1 LEFT OUTER JOIN SAPHEE.ZMMT012 AS LF7 ON T1.TPLSTDT7 = LF7.LIFNR 
		WHERE T1.MANDT = #G_MANDT#  AND T1.ERDAT =  #ERDAT# AND TPLSTDTZTON7 &lt;&gt; ''
		ORDER BY ZKNUM, ZKNUM2, ORD ASC        
		FOR FETCH ONLY
		WITH UR
	</statement>
	<input default-name="ds_cond">
		<input default-name="ds_cond">
		<col name="G_MANDT" size="255" type="VARCHAR" description="" /> 
		<col name="PJT" size="255" type="VARCHAR" description="" /> 
		<col name="ERDAT" size="255" type="VARCHAR" description="" /> 
	</input>
	</input>
	<output default-name="ds_sublist">
		<col name="ZKNUM" size="255" type="VARCHAR" description="" />
		<col name="ZKNUM2" size="255" type="VARCHAR" description="" />
		<col name="NAME" size="255" type="VARCHAR" description="" /> 
		<col name="TPLSTDTZTON" size="255" type="VARCHAR" description="" />
		<col name="SPEC" size="3000" type="VARCHAR" description="" /> 
	</output>
</query>
