<?xml version="1.0" encoding="euc-kr"?>
<query dynamic="true">
	<type>select</type>
	<description><![CDATA[운송계획 조회- 출발지상세정보]]></description>
	<reload>true</reload>
	<monitoring>true</monitoring>
	<result-count>0</result-count>
	<statement>
		SELECT  
        CASE WHEN BEZEI = '천안' THEN '0000008502' ELSE '0000008501' END BEZEI_NM,
              ZTON1||','||ZTON2||','||ZTON3||','||ZTON4||','||ZTON5||','||ZTON6||','||ZTON7||','||ZTON8||','||ZTON9||','||ZTON10||','||
              ZTON11||','||ZTON12||','||ZTON13||','||ZTON14||','||ZTON15 AS CARQT ,
       	SUBSTR(CASE WHEN ZTON1  > 0 THEN ',1T-'       || TRIM(CHAR(ZTON1 )) ELSE '' END ||
  	        CASE WHEN ZTON2  > 0 THEN ',2.5T-'     || TRIM(CHAR(ZTON2 )) ELSE '' END ||
  	        CASE WHEN ZTON3  > 0 THEN ',3.5T-'     || TRIM(CHAR(ZTON3 )) ELSE '' END ||
  	        CASE WHEN ZTON4  > 0 THEN ',5T-'       || TRIM(CHAR(ZTON4 )) ELSE '' END ||
  	        CASE WHEN ZTON5  > 0 THEN ',8T-'       || TRIM(CHAR(ZTON5 )) ELSE '' END ||
  	        CASE WHEN ZTON6  > 0 THEN ',11T-'      || TRIM(CHAR(ZTON6 )) ELSE '' END ||
  	        CASE WHEN ZTON7  > 0 THEN ',18T-'      || TRIM(CHAR(ZTON7 )) ELSE '' END ||
  	        CASE WHEN ZTON8  > 0 THEN ',25T-'      || TRIM(CHAR(ZTON8 )) ELSE '' END ||
  	        CASE WHEN ZTON9  > 0 THEN ',Trailer-'  || TRIM(CHAR(ZTON9 )) ELSE '' END ||
  	        CASE WHEN ZTON10 > 0 THEN ',택배-' || TRIM(CHAR(ZTON10)) ELSE '' END ||
  	        CASE WHEN ZTON11 > 0 THEN ',Trailer(20)-' || TRIM(CHAR(ZTON11)) ELSE '' END ||
  	        CASE WHEN ZTON12 > 0 THEN ',Trailer(40)-' || TRIM(CHAR(ZTON12)) ELSE '' END ||
  	        CASE WHEN ZTON13 > 0 THEN ',Trailer(20)round-' || TRIM(CHAR(ZTON13)) ELSE '' END ||
  	        CASE WHEN ZTON15 > 0 THEN ',셔틀-' || TRIM(CHAR(ZTON15)) ELSE '' END ||
  	        CASE WHEN ZTON14 > 0 THEN ',Trailer(40)round-' || TRIM(CHAR(ZTON14)) ELSE '' END,2) AS ZTON,
          '' AS BEZEII, '1' AS ORD,
          ZTON1||','||ZTON2||','||ZTON3||','||ZTON4||','||ZTON5||','||ZTON6||','||ZTON7||','||ZTON8||','||ZTON9||','||ZTON10||','||
          ZTON11||','||ZTON12||','||ZTON13||','||ZTON14||','||ZTON15 AS CAREACH
    	FROM SAPHEE.ZLET002
    	WHERE MANDT = #G_MANDT# AND ZKNUM = #ZKNUM#  AND ZKNUM2 = #ZKNUM2# AND  TPLSTDT1 = ''   
    	UNION ALL 
		SELECT TPLSTDT1 AS BEZEI_NM, DECODE(CHAR(TPLSTDTQTY1), '0', '', CHAR(TPLSTDTQTY1)) AS CARQT, TPLSTDTZTON1 AS ZTON, '' AS BEZEII, '1' AS ORD, TPLSTDTQTY1 AS CAREACH
		FROM SAPHEE.ZLET002 
		WHERE MANDT = #G_MANDT# AND ZKNUM = #ZKNUM#  AND ZKNUM2 = #ZKNUM2# AND TPLSTDT1 &lt;&gt; ''
		UNION ALL
		SELECT TPLSTDT2 AS BEZEI_NM, DECODE(CHAR(TPLSTDTQTY2), '0', '', CHAR(TPLSTDTQTY2)) AS CARQT, TPLSTDTZTON2 AS ZTON  , '' AS BEZEII, '2' AS ORD, TPLSTDTQTY2 AS CAREACH
		FROM SAPHEE.ZLET002 
		WHERE MANDT = #G_MANDT# AND ZKNUM = #ZKNUM#   AND ZKNUM2 = #ZKNUM2#
		UNION  ALL
		SELECT TPLSTDT3 AS BEZEI_NM, DECODE(CHAR(TPLSTDTQTY3), '0', '', CHAR(TPLSTDTQTY3)) AS CARQT, TPLSTDTZTON3 AS ZTON  , '' AS BEZEII, '3' AS ORD, TPLSTDTQTY3 AS CAREACH
		FROM SAPHEE.ZLET002 
		WHERE MANDT = #G_MANDT# AND ZKNUM = #ZKNUM#   AND ZKNUM2 = #ZKNUM2#
		UNION ALL
		SELECT TPLSTDT4 AS BEZEI_NM, DECODE(CHAR(TPLSTDTQTY4), '0', '', CHAR(TPLSTDTQTY4)) AS CARQT, TPLSTDTZTON4 AS ZTON  , '' AS BEZEII, '4' AS ORD, TPLSTDTQTY4 AS CAREACH
		FROM SAPHEE.ZLET002 
		WHERE MANDT = #G_MANDT# AND ZKNUM = #ZKNUM#   AND ZKNUM2 = #ZKNUM2#
		UNION  ALL
		SELECT TPLSTDT5 AS BEZEI_NM, DECODE(CHAR(TPLSTDTQTY5), '0', '', CHAR(TPLSTDTQTY5)) AS CARQT, TPLSTDTZTON5 AS ZTON  , '' AS BEZEII, '5' AS ORD, TPLSTDTQTY5 AS CAREACH
		FROM SAPHEE.ZLET002 
		WHERE MANDT = #G_MANDT# AND ZKNUM = #ZKNUM#   AND ZKNUM2 = #ZKNUM2#
		UNION  ALL
		SELECT TPLSTDT6 AS BEZEI_NM, DECODE(CHAR(TPLSTDTQTY6), '0', '', CHAR(TPLSTDTQTY6)) AS CARQT, TPLSTDTZTON6 AS ZTON  , '' AS BEZEII, '6' AS ORD, TPLSTDTQTY6 AS CAREACH
		FROM SAPHEE.ZLET002 
		WHERE MANDT = #G_MANDT# AND ZKNUM = #ZKNUM#  AND ZKNUM2 = #ZKNUM2#
		UNION  ALL
		SELECT TPLSTDT7 AS BEZEI_NM, DECODE(CHAR(TPLSTDTQTY7), '0', '', CHAR(TPLSTDTQTY7)) AS CARQT, TPLSTDTZTON7 AS ZTON  , '' AS BEZEII, '7' AS ORD, TPLSTDTQTY7 AS CAREACH
		FROM SAPHEE.ZLET002 
		WHERE MANDT = #G_MANDT# AND ZKNUM = #ZKNUM#  AND ZKNUM2 = #ZKNUM2#
		ORDER BY ORD ASC
		WITH UR
	</statement>
	<input default-name="ds_cond">
		<col name="ZKNUM" size="36" type="VARCHAR" description="" /> 
		<col name="ZKNUM2" size="6" type="VARCHAR" description="" /> 
	</input>
	<output default-name="ds_list2">
		<col name="BEZEI_NM" size="36" type="VARCHAR" description="" /> 
		<col name="CARQT" size="6" type="NUMERIC" description="" /> 
		<col name="ZTON" size="120" type="VARCHAR" description="" /> 
		<col name="BEZEI" size="36" type="VARCHAR" description="" /> 		
	</output>
</query>
