<?xml version="1.0" encoding="euc-kr"?>
<query dynamic="true">
	<type>select</type>
	<description><![CDATA[]]></description>
	<reload>true</reload>
	<monitoring>true</monitoring>
	<result-count>0</result-count>
	<statement>
SELECT
         A.GROUP           AS GROUP
        ,A.DEPT            AS DEPT
        ,A.GUBUN           AS GUBUN
        ,A.AMTGUBUN        AS AMTGUBUN
        ,B.ITEM            AS ITEM
        ,B.ITEMNM          AS ITEMNM

        ,B.TEAMNM
        ,B.MAN

        ,VALUE(B.BFAMT, 0) AS BFAMT
        ,VALUE(B.AFAMT, 0) AS AFAMT
        --,VALUE(B.BFAMT, 0) - VALUE(B.AFAMT, 0) AS FAMT
		,VALUE(B.AFAMT, 0) - VALUE(B.BFAMT, 0) AS FAMT
        ,VALUE(B.QNTY, 0)  AS QNTY
        --,(VALUE(B.BFAMT, 0) - VALUE(B.AFAMT, 0)) * VALUE(B.QNTY, 0) AS SAVEFAMT
		,(VALUE(B.AFAMT, 0) - VALUE(B.BFAMT, 0) ) * VALUE(B.QNTY, 0) AS SAVEFAMT
        ,B.PLANYM         AS PLANYM
        ,VALUE(B.M01, 0)  AS M01
        ,VALUE(B.M02, 0)  AS M02
        ,VALUE(B.M03, 0)  AS M03
        ,VALUE(B.M04, 0)  AS M04
        ,VALUE(B.M05, 0)  AS M05
        ,VALUE(B.M06, 0)  AS M06
        ,VALUE(B.M07, 0)  AS M07
        ,VALUE(B.M08, 0)  AS M08
        ,VALUE(B.M09, 0)  AS M09
        ,VALUE(B.M10, 0)  AS M10
        ,VALUE(B.M11, 0)  AS M11
        ,VALUE(B.M12, 0)  AS M12
        ,VALUE(B.M01, 0) + VALUE(B.M02, 0) + VALUE(B.M03, 0) + VALUE(B.M04, 0) + VALUE(B.M05, 0) + VALUE(B.M06, 0) + VALUE(B.M07, 0) + VALUE(B.M08, 0) + VALUE(B.M09, 0) + VALUE(B.M10, 0) + VALUE(B.M11, 0) + VALUE(B.M12, 0) AS TOT
  FROM (SELECT MANDT, DTEXT1 AS GROUP, CODE2 AS DEPT, CAST('A' AS VARCHAR(1)) AS GUBUN, CAST('P' AS VARCHAR(1)) AS AMTGUBUN FROM SAPHEE.ZLCODE WHERE CODE1 = 'QM01'
        UNION ALL
        SELECT MANDT, DTEXT1 AS GROUP, CODE2 AS DEPT, CAST('A' AS VARCHAR(1)) AS GUBUN, CAST('R' AS VARCHAR(1)) AS AMTGUBUN FROM SAPHEE.ZLCODE WHERE CODE1 = 'QM01'
        UNION ALL
        SELECT MANDT, DTEXT1 AS GROUP, CODE2 AS DEPT, CAST('A' AS VARCHAR(1)) AS GUBUN, CAST('Z' AS VARCHAR(1)) AS AMTGUBUN FROM SAPHEE.ZLCODE WHERE CODE1 = 'QM01'
        UNION ALL
        SELECT MANDT, DTEXT1 AS GROUP, CODE2 AS DEPT, CAST('N' AS VARCHAR(1)) AS GUBUN, CAST('P' AS VARCHAR(1)) AS AMTGUBUN FROM SAPHEE.ZLCODE WHERE CODE1 = 'QM01'
        UNION ALL
        SELECT MANDT, DTEXT1 AS GROUP, CODE2 AS DEPT, CAST('N' AS VARCHAR(1)) AS GUBUN, CAST('R' AS VARCHAR(1)) AS AMTGUBUN FROM SAPHEE.ZLCODE WHERE CODE1 = 'QM01'
        UNION ALL
        SELECT MANDT, DTEXT1 AS GROUP, CODE2 AS DEPT, CAST('N' AS VARCHAR(1)) AS GUBUN, CAST('Z' AS VARCHAR(1)) AS AMTGUBUN FROM SAPHEE.ZLCODE WHERE CODE1 = 'QM01'
       ) AS A
        INNER JOIN TABLE(SELECT 
								      ZQMT071U.DEPT   AS DEPT
							         ,ZQMT071U.GJAHR  AS GJAHR
							         ,ZQMT071U.GUBUN  AS GUBUN
							         ,ZQMT071U.ITEM   AS ITEM
							         ,ZQMT071U.ITEMNM AS ITEMNM

                                                                                                           ,ZQMT071U.TEAMNM
							         ,ZQMT071U.MAN

									 ,'P'            AS AMTGUBUN
									 ,CASE WHEN ZQMT071U.WAERK IN ('KRW', 'JPY') THEN ZQMT071U.BFAMT * 100 ELSE ZQMT071U.BFAMT END AS BFAMT
									 ,CASE WHEN ZQMT071U.WAERK IN ('KRW', 'JPY') THEN ZQMT071U.AFAMT * 100 ELSE ZQMT071U.AFAMT END AS AFAMT
									 ,ZQMT071U.QNTY   AS QNTY
									 ,ZQMT071U.PLANYM AS PLANYM
								     ,SUM(CASE WHEN ZQMT072U.PLANYM = #GJAHR#||'01' THEN CASE WHEN ZQMT071U.WAERK IN ('KRW', 'JPY') THEN ZQMT072U.PLANAMT * 100 ELSE ZQMT072U.PLANAMT END END) AS M01
								     ,SUM(CASE WHEN ZQMT072U.PLANYM = #GJAHR#||'02' THEN CASE WHEN ZQMT071U.WAERK IN ('KRW', 'JPY') THEN ZQMT072U.PLANAMT * 100 ELSE ZQMT072U.PLANAMT END END) AS M02
								     ,SUM(CASE WHEN ZQMT072U.PLANYM = #GJAHR#||'03' THEN CASE WHEN ZQMT071U.WAERK IN ('KRW', 'JPY') THEN ZQMT072U.PLANAMT * 100 ELSE ZQMT072U.PLANAMT END END) AS M03
								     ,SUM(CASE WHEN ZQMT072U.PLANYM = #GJAHR#||'04' THEN CASE WHEN ZQMT071U.WAERK IN ('KRW', 'JPY') THEN ZQMT072U.PLANAMT * 100 ELSE ZQMT072U.PLANAMT END END) AS M04
								     ,SUM(CASE WHEN ZQMT072U.PLANYM = #GJAHR#||'05' THEN CASE WHEN ZQMT071U.WAERK IN ('KRW', 'JPY') THEN ZQMT072U.PLANAMT * 100 ELSE ZQMT072U.PLANAMT END END) AS M05
								     ,SUM(CASE WHEN ZQMT072U.PLANYM = #GJAHR#||'06' THEN CASE WHEN ZQMT071U.WAERK IN ('KRW', 'JPY') THEN ZQMT072U.PLANAMT * 100 ELSE ZQMT072U.PLANAMT END END) AS M06
								     ,SUM(CASE WHEN ZQMT072U.PLANYM = #GJAHR#||'07' THEN CASE WHEN ZQMT071U.WAERK IN ('KRW', 'JPY') THEN ZQMT072U.PLANAMT * 100 ELSE ZQMT072U.PLANAMT END END) AS M07
								     ,SUM(CASE WHEN ZQMT072U.PLANYM = #GJAHR#||'08' THEN CASE WHEN ZQMT071U.WAERK IN ('KRW', 'JPY') THEN ZQMT072U.PLANAMT * 100 ELSE ZQMT072U.PLANAMT END END) AS M08
								     ,SUM(CASE WHEN ZQMT072U.PLANYM = #GJAHR#||'09' THEN CASE WHEN ZQMT071U.WAERK IN ('KRW', 'JPY') THEN ZQMT072U.PLANAMT * 100 ELSE ZQMT072U.PLANAMT END END) AS M09
								     ,SUM(CASE WHEN ZQMT072U.PLANYM = #GJAHR#||'10' THEN CASE WHEN ZQMT071U.WAERK IN ('KRW', 'JPY') THEN ZQMT072U.PLANAMT * 100 ELSE ZQMT072U.PLANAMT END END) AS M10
								     ,SUM(CASE WHEN ZQMT072U.PLANYM = #GJAHR#||'11' THEN CASE WHEN ZQMT071U.WAERK IN ('KRW', 'JPY') THEN ZQMT072U.PLANAMT * 100 ELSE ZQMT072U.PLANAMT END END) AS M11
								     ,SUM(CASE WHEN ZQMT072U.PLANYM = #GJAHR#||'12' THEN CASE WHEN ZQMT071U.WAERK IN ('KRW', 'JPY') THEN ZQMT072U.PLANAMT * 100 ELSE ZQMT072U.PLANAMT END END) AS M12
							    FROM SAPHEE.ZQMT071U AS ZQMT071U
								     LEFT OUTER JOIN SAPHEE.ZQMT072U AS ZQMT072U
								    	   ON ZQMT071U.MANDT = ZQMT072U.MANDT AND ZQMT071U.GJAHR = ZQMT072U.GJAHR AND ZQMT071U.DEPT = ZQMT072U.DEPT AND ZQMT071U.ITEM = ZQMT072U.ITEM
							   WHERE ZQMT071U.MANDT = #G_MANDT#
						<isNotNull col="DEPT">
						         AND ZQMT071U.DEPT  = #DEPT#
						</isNotNull>
						 	     AND ZQMT071U.GJAHR = #GJAHR#
						 	  GROUP BY ZQMT071U.DEPT, ZQMT071U.GJAHR, ZQMT071U.GUBUN, ZQMT071U.ITEM, ZQMT071U.ITEMNM, ZQMT071U.QNTY, ZQMT071U.PLANYM
						 	          ,CASE WHEN ZQMT071U.WAERK IN ('KRW', 'JPY') THEN ZQMT071U.BFAMT * 100 ELSE ZQMT071U.BFAMT END
						 	          ,CASE WHEN ZQMT071U.WAERK IN ('KRW', 'JPY') THEN ZQMT071U.AFAMT * 100 ELSE ZQMT071U.AFAMT END

                                                                                                            ,ZQMT071U.TEAMNM,  ZQMT071U.MAN                                                                                                            

							  UNION

							  SELECT 
								      ZQMT071U.DEPT  AS DEPT
							         ,ZQMT071U.GJAHR AS GJAHR
							         ,ZQMT071U.GUBUN AS GUBUN
							         ,ZQMT071U.ITEM   AS ITEM
							         ,ZQMT071U.ITEMNM AS ITEMNM

                                                                                                           ,ZQMT071U.TEAMNM
							         ,ZQMT071U.MAN

									 ,'R'            AS AMTGUBUN
									 ,CASE WHEN ZQMT071U.WAERK IN ('KRW', 'JPY') THEN ZQMT071U.BFAMT * 100 ELSE ZQMT071U.BFAMT END AS BFAMT
									 ,CASE WHEN ZQMT071U.WAERK IN ('KRW', 'JPY') THEN ZQMT071U.AFAMT * 100 ELSE ZQMT071U.AFAMT END AS AFAMT
									 ,ZQMT071U.QNTY   AS QNTY
									 ,ZQMT071U.PLANYM AS PLANYM
								     ,SUM(CASE WHEN ZQMT076U.RSLTYM = #GJAHR#||'01' THEN CASE WHEN ZQMT076U.WAERK IN ('KRW', 'JPY') THEN ZQMT076U.RSLTAMT * 100 ELSE ZQMT076U.RSLTAMT END END) AS M01
								     ,SUM(CASE WHEN ZQMT076U.RSLTYM = #GJAHR#||'02' THEN CASE WHEN ZQMT076U.WAERK IN ('KRW', 'JPY') THEN ZQMT076U.RSLTAMT * 100 ELSE ZQMT076U.RSLTAMT END END) AS M02
								     ,SUM(CASE WHEN ZQMT076U.RSLTYM = #GJAHR#||'03' THEN CASE WHEN ZQMT076U.WAERK IN ('KRW', 'JPY') THEN ZQMT076U.RSLTAMT * 100 ELSE ZQMT076U.RSLTAMT END END) AS M03
								     ,SUM(CASE WHEN ZQMT076U.RSLTYM = #GJAHR#||'04' THEN CASE WHEN ZQMT076U.WAERK IN ('KRW', 'JPY') THEN ZQMT076U.RSLTAMT * 100 ELSE ZQMT076U.RSLTAMT END END) AS M04
								     ,SUM(CASE WHEN ZQMT076U.RSLTYM = #GJAHR#||'05' THEN CASE WHEN ZQMT076U.WAERK IN ('KRW', 'JPY') THEN ZQMT076U.RSLTAMT * 100 ELSE ZQMT076U.RSLTAMT END END) AS M05
								     ,SUM(CASE WHEN ZQMT076U.RSLTYM = #GJAHR#||'06' THEN CASE WHEN ZQMT076U.WAERK IN ('KRW', 'JPY') THEN ZQMT076U.RSLTAMT * 100 ELSE ZQMT076U.RSLTAMT END END) AS M06
								     ,SUM(CASE WHEN ZQMT076U.RSLTYM = #GJAHR#||'07' THEN CASE WHEN ZQMT076U.WAERK IN ('KRW', 'JPY') THEN ZQMT076U.RSLTAMT * 100 ELSE ZQMT076U.RSLTAMT END END) AS M07
								     ,SUM(CASE WHEN ZQMT076U.RSLTYM = #GJAHR#||'08' THEN CASE WHEN ZQMT076U.WAERK IN ('KRW', 'JPY') THEN ZQMT076U.RSLTAMT * 100 ELSE ZQMT076U.RSLTAMT END END) AS M08
								     ,SUM(CASE WHEN ZQMT076U.RSLTYM = #GJAHR#||'09' THEN CASE WHEN ZQMT076U.WAERK IN ('KRW', 'JPY') THEN ZQMT076U.RSLTAMT * 100 ELSE ZQMT076U.RSLTAMT END END) AS M09
								     ,SUM(CASE WHEN ZQMT076U.RSLTYM = #GJAHR#||'10' THEN CASE WHEN ZQMT076U.WAERK IN ('KRW', 'JPY') THEN ZQMT076U.RSLTAMT * 100 ELSE ZQMT076U.RSLTAMT END END) AS M10
								     ,SUM(CASE WHEN ZQMT076U.RSLTYM = #GJAHR#||'11' THEN CASE WHEN ZQMT076U.WAERK IN ('KRW', 'JPY') THEN ZQMT076U.RSLTAMT * 100 ELSE ZQMT076U.RSLTAMT END END) AS M11
								     ,SUM(CASE WHEN ZQMT076U.RSLTYM = #GJAHR#||'12' THEN CASE WHEN ZQMT076U.WAERK IN ('KRW', 'JPY') THEN ZQMT076U.RSLTAMT * 100 ELSE ZQMT076U.RSLTAMT END END) AS M12
							    FROM SAPHEE.ZQMT071U AS ZQMT071U
								     LEFT OUTER JOIN SAPHEE.ZQMT076U AS ZQMT076U
								    	  ON ZQMT071U.MANDT = ZQMT076U.MANDT AND ZQMT071U.GJAHR = ZQMT076U.GJAHR AND ZQMT071U.DEPT = ZQMT076U.DEPT AND ZQMT071U.ITEM = ZQMT076U.ITEM
							   WHERE ZQMT071U.MANDT = #G_MANDT#
						<isNotNull col="DEPT">
						         AND ZQMT071U.DEPT  = #DEPT#
						</isNotNull>
						 		 AND ZQMT071U.GJAHR = #GJAHR#
						 	  GROUP BY ZQMT071U.DEPT, ZQMT071U.GJAHR, ZQMT071U.GUBUN, ZQMT071U.ITEM, ZQMT071U.ITEMNM, ZQMT071U.QNTY, ZQMT071U.PLANYM
						 	          ,CASE WHEN ZQMT071U.WAERK IN ('KRW', 'JPY') THEN ZQMT071U.BFAMT * 100 ELSE ZQMT071U.BFAMT END
						 	          ,CASE WHEN ZQMT071U.WAERK IN ('KRW', 'JPY') THEN ZQMT071U.AFAMT * 100 ELSE ZQMT071U.AFAMT END

                                                                                                            ,ZQMT071U.TEAMNM,  ZQMT071U.MAN                                                                                                            


							  UNION

				              SELECT 
								      ZQMT071U.DEPT  AS DEPT
							         ,ZQMT071U.GJAHR AS GJAHR
							         ,ZQMT071U.GUBUN AS GUBUN
							         ,ZQMT071U.ITEM   AS ITEM
							         ,ZQMT071U.ITEMNM AS ITEMNM

                                                                                                           ,ZQMT071U.TEAMNM
							         ,ZQMT071U.MAN

									 ,'Z'            AS AMTGUBUN
									 ,CASE WHEN ZQMT071U.WAERK IN ('KRW', 'JPY') THEN ZQMT071U.BFAMT * 100 ELSE ZQMT071U.BFAMT END AS BFAMT
									 ,CASE WHEN ZQMT071U.WAERK IN ('KRW', 'JPY') THEN ZQMT071U.AFAMT * 100 ELSE ZQMT071U.AFAMT END AS AFAMT
									 ,ZQMT071U.QNTY   AS QNTY
									 ,ZQMT071U.PLANYM AS PLANYM
								     ,SUM(CASE WHEN ZQMT076U.RSLTYM = #GJAHR#||'01' THEN CASE WHEN ZQMT076U.WAERK IN ('KRW', 'JPY') THEN ZQMT076U.CHKAMT * 100 ELSE ZQMT076U.CHKAMT END END) AS M01
								     ,SUM(CASE WHEN ZQMT076U.RSLTYM = #GJAHR#||'02' THEN CASE WHEN ZQMT076U.WAERK IN ('KRW', 'JPY') THEN ZQMT076U.CHKAMT * 100 ELSE ZQMT076U.CHKAMT END END) AS M02
								     ,SUM(CASE WHEN ZQMT076U.RSLTYM = #GJAHR#||'03' THEN CASE WHEN ZQMT076U.WAERK IN ('KRW', 'JPY') THEN ZQMT076U.CHKAMT * 100 ELSE ZQMT076U.CHKAMT END END) AS M03
								     ,SUM(CASE WHEN ZQMT076U.RSLTYM = #GJAHR#||'04' THEN CASE WHEN ZQMT076U.WAERK IN ('KRW', 'JPY') THEN ZQMT076U.CHKAMT * 100 ELSE ZQMT076U.CHKAMT END END) AS M04
								     ,SUM(CASE WHEN ZQMT076U.RSLTYM = #GJAHR#||'05' THEN CASE WHEN ZQMT076U.WAERK IN ('KRW', 'JPY') THEN ZQMT076U.CHKAMT * 100 ELSE ZQMT076U.CHKAMT END END) AS M05
								     ,SUM(CASE WHEN ZQMT076U.RSLTYM = #GJAHR#||'06' THEN CASE WHEN ZQMT076U.WAERK IN ('KRW', 'JPY') THEN ZQMT076U.CHKAMT * 100 ELSE ZQMT076U.CHKAMT END END) AS M06
								     ,SUM(CASE WHEN ZQMT076U.RSLTYM = #GJAHR#||'07' THEN CASE WHEN ZQMT076U.WAERK IN ('KRW', 'JPY') THEN ZQMT076U.CHKAMT * 100 ELSE ZQMT076U.CHKAMT END END) AS M07
								     ,SUM(CASE WHEN ZQMT076U.RSLTYM = #GJAHR#||'08' THEN CASE WHEN ZQMT076U.WAERK IN ('KRW', 'JPY') THEN ZQMT076U.CHKAMT * 100 ELSE ZQMT076U.CHKAMT END END) AS M08
								     ,SUM(CASE WHEN ZQMT076U.RSLTYM = #GJAHR#||'09' THEN CASE WHEN ZQMT076U.WAERK IN ('KRW', 'JPY') THEN ZQMT076U.CHKAMT * 100 ELSE ZQMT076U.CHKAMT END END) AS M09
								     ,SUM(CASE WHEN ZQMT076U.RSLTYM = #GJAHR#||'10' THEN CASE WHEN ZQMT076U.WAERK IN ('KRW', 'JPY') THEN ZQMT076U.CHKAMT * 100 ELSE ZQMT076U.CHKAMT END END) AS M10
								     ,SUM(CASE WHEN ZQMT076U.RSLTYM = #GJAHR#||'11' THEN CASE WHEN ZQMT076U.WAERK IN ('KRW', 'JPY') THEN ZQMT076U.CHKAMT * 100 ELSE ZQMT076U.CHKAMT END END) AS M11
								     ,SUM(CASE WHEN ZQMT076U.RSLTYM = #GJAHR#||'12' THEN CASE WHEN ZQMT076U.WAERK IN ('KRW', 'JPY') THEN ZQMT076U.CHKAMT * 100 ELSE ZQMT076U.CHKAMT END END) AS M12
							    FROM SAPHEE.ZQMT071U AS ZQMT071U
								     LEFT OUTER JOIN TABLE (SELECT ZQMT076U.MANDT AS MANDT,   ZQMT076U.GJAHR AS GJAHR, ZQMT076U.DEPT AS DEPT, ZQMT076U.ITEM AS ITEM,
								                                   ZQMT076U.RSLTYM AS RSLTYM, ZQMT076U.WAERK AS WAERK, 
								                                   CASE WHEN REPLACE(ZQMT074U.CFDATE, '00000000', '') = '' THEN 0 ELSE ZQMT076U.CHKAMT END AS CHKAMT
								                              FROM SAPHEE.ZQMT076U AS ZQMT076U
								                                   INNER JOIN SAPHEE.ZQMT074U AS ZQMT074U  
										                                   ON ZQMT074U.MANDT = ZQMT076U.MANDT AND ZQMT074U.GJAHR = ZQMT076U.GJAHR AND ZQMT074U.DEPT = ZQMT076U.DEPT AND ZQMT074U.RSLTYM = ZQMT076U.RSLTYM

                                                             WHERE ZQMT076U.MANDT = #G_MANDT# 
                                                               AND ZQMT076U.GJAHR = #GJAHR#
                                                           <isNotNull col="DEPT">
                                                               AND ZQMT076U.DEPT = #DEPT#
                                                           </isNotNull>
								                           )AS ZQMT076U
								    	    ON ZQMT071U.MANDT = ZQMT076U.MANDT AND ZQMT071U.GJAHR = ZQMT076U.GJAHR AND ZQMT071U.DEPT = ZQMT076U.DEPT AND ZQMT071U.ITEM = ZQMT076U.ITEM

							   WHERE ZQMT071U.MANDT = #G_MANDT#
						<isNotNull col="DEPT">
						         AND ZQMT071U.DEPT  = #DEPT#
						</isNotNull>
						 		 AND ZQMT071U.GJAHR = #GJAHR#
						 	  GROUP BY ZQMT071U.DEPT, ZQMT071U.GJAHR, ZQMT071U.GUBUN, ZQMT071U.ITEM, ZQMT071U.ITEMNM, ZQMT071U.QNTY, ZQMT071U.PLANYM
						 	          ,CASE WHEN ZQMT071U.WAERK IN ('KRW', 'JPY') THEN ZQMT071U.BFAMT * 100 ELSE ZQMT071U.BFAMT END
						 	          ,CASE WHEN ZQMT071U.WAERK IN ('KRW', 'JPY') THEN ZQMT071U.AFAMT * 100 ELSE ZQMT071U.AFAMT END

                                                                                                            ,ZQMT071U.TEAMNM,  ZQMT071U.MAN                                                                                                            

				             ) AS B
	                           ON B.DEPT = A.DEPT AND B.GUBUN = A.GUBUN AND B.AMTGUBUN = A.AMTGUBUN

 WHERE A.MANDT = #G_MANDT#
<isNotNull col="DEPT">
   AND A.DEPT  = #DEPT#
</isNotNull>
ORDER BY A.GROUP, A.DEPT, A.GUBUN, B.ITEM, B.ITEMNM, A.AMTGUBUN
WITH UR	</statement>
	<input default-name="ds_cond">
	</input>
	<output default-name="ds_list">
	</output>
</query>
