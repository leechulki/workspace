<?xml version="1.0" encoding="euc-kr"?>
<query dynamic="true">
	<type>select</type>
	<description><![CDATA[]]></description>
	<reload>true</reload>
	<monitoring>true</monitoring>
	<result-count>0</result-count>
	<statement>
SELECT
         ''       AS CHK
        ,A.DEPT   AS DEPT
        ,A.GJAHR  AS GJAHR
        ,A.ITEM   AS ITEM
        ,A.ITEMNM AS ITEMNM
        ,CASE WHEN A.WAERK IN ('KRW', 'JPY') THEN A.BFAMT * 100 ELSE A.BFAMT END AS BFAMT
        ,CASE WHEN A.WAERK IN ('KRW', 'JPY') THEN A.AFAMT * 100 ELSE A.AFAMT END AS AFAMT
        ,A.WAERK  AS WAERK
        ,A.QNTY   AS QNTY
        ,A.UNIT   AS UNIT
        ,A.PLANYM AS PLANYM
        ,A.GUBUN  AS GUBUN
        ,A.STYM   AS STYM
        ,A.CONFDT AS CONFDT
        ,A.CONFNM AS CONFNM
        ,CASE WHEN A.WAERK IN ('KRW', 'JPY') THEN B.M01 * 100 ELSE B.M01 END AS M01
        ,CASE WHEN A.WAERK IN ('KRW', 'JPY') THEN B.M02 * 100 ELSE B.M02 END AS M02
        ,CASE WHEN A.WAERK IN ('KRW', 'JPY') THEN B.M03 * 100 ELSE B.M03 END AS M03
        ,CASE WHEN A.WAERK IN ('KRW', 'JPY') THEN B.M04 * 100 ELSE B.M04 END AS M04
        ,CASE WHEN A.WAERK IN ('KRW', 'JPY') THEN B.M05 * 100 ELSE B.M05 END AS M05
        ,CASE WHEN A.WAERK IN ('KRW', 'JPY') THEN B.M06 * 100 ELSE B.M06 END AS M06
        ,CASE WHEN A.WAERK IN ('KRW', 'JPY') THEN B.M07 * 100 ELSE B.M07 END AS M07
        ,CASE WHEN A.WAERK IN ('KRW', 'JPY') THEN B.M08 * 100 ELSE B.M08 END AS M08
        ,CASE WHEN A.WAERK IN ('KRW', 'JPY') THEN B.M09 * 100 ELSE B.M09 END AS M09
        ,CASE WHEN A.WAERK IN ('KRW', 'JPY') THEN B.M10 * 100 ELSE B.M10 END AS M10
        ,CASE WHEN A.WAERK IN ('KRW', 'JPY') THEN B.M11 * 100 ELSE B.M11 END AS M11
        ,CASE WHEN A.WAERK IN ('KRW', 'JPY') THEN B.M12 * 100 ELSE B.M12 END AS M12
FROM    SAPHEE.ZQMT071U AS A
	    INNER JOIN TABLE
	    (
			SELECT 
				     ZQMT071U.DEPT   AS DEPT
			        ,ZQMT071U.GJAHR  AS GJAHR
			        ,ZQMT071U.ITEM   AS ITEM
				    ,MAX(CASE WHEN ZQMT072U.PLANYM = #GJAHR#||'01' THEN ZQMT072U.PLANAMT END) AS M01
				    ,MAX(CASE WHEN ZQMT072U.PLANYM = #GJAHR#||'02' THEN ZQMT072U.PLANAMT END) AS M02
				    ,MAX(CASE WHEN ZQMT072U.PLANYM = #GJAHR#||'03' THEN ZQMT072U.PLANAMT END) AS M03
				    ,MAX(CASE WHEN ZQMT072U.PLANYM = #GJAHR#||'04' THEN ZQMT072U.PLANAMT END) AS M04
				    ,MAX(CASE WHEN ZQMT072U.PLANYM = #GJAHR#||'05' THEN ZQMT072U.PLANAMT END) AS M05
				    ,MAX(CASE WHEN ZQMT072U.PLANYM = #GJAHR#||'06' THEN ZQMT072U.PLANAMT END) AS M06
				    ,MAX(CASE WHEN ZQMT072U.PLANYM = #GJAHR#||'07' THEN ZQMT072U.PLANAMT END) AS M07
				    ,MAX(CASE WHEN ZQMT072U.PLANYM = #GJAHR#||'08' THEN ZQMT072U.PLANAMT END) AS M08
				    ,MAX(CASE WHEN ZQMT072U.PLANYM = #GJAHR#||'09' THEN ZQMT072U.PLANAMT END) AS M09
				    ,MAX(CASE WHEN ZQMT072U.PLANYM = #GJAHR#||'10' THEN ZQMT072U.PLANAMT END) AS M10
				    ,MAX(CASE WHEN ZQMT072U.PLANYM = #GJAHR#||'11' THEN ZQMT072U.PLANAMT END) AS M11
				    ,MAX(CASE WHEN ZQMT072U.PLANYM = #GJAHR#||'12' THEN ZQMT072U.PLANAMT END) AS M12
			FROM    SAPHEE.ZQMT071U AS ZQMT071U
				    LEFT OUTER JOIN SAPHEE.ZQMT072U AS ZQMT072U
				    	ON ZQMT071U.MANDT = ZQMT072U.MANDT AND ZQMT071U.GJAHR = ZQMT072U.GJAHR AND ZQMT071U.DEPT = ZQMT072U.DEPT AND ZQMT071U.ITEM = ZQMT072U.ITEM
			WHERE   ZQMT071U.MANDT = #G_MANDT#
			AND     ZQMT071U.DEPT  = #DEPT#
			AND     ZQMT071U.GJAHR = #GJAHR#
		<isNotNull col="ITEMNM">
		    AND     ZQMT071U.ITEMNM LIKE '%'||#ITEMNM#||'%'
		</isNotNull>
			GROUP BY ZQMT071U.DEPT, ZQMT071U.GJAHR, ZQMT071U.ITEM
		) AS B
			ON B.DEPT = A.DEPT AND B.GJAHR = A.GJAHR AND B.ITEM = A.ITEM
WHERE   A.MANDT = #G_MANDT#
AND     A.DEPT  = #DEPT#
AND     A.GJAHR = #GJAHR#
AND    (A.STYM = '000000' OR A.STYM = '' OR A.STYM > SUBSTR(CAST(HEX(DATE(CURRENT DATE) - 12 MONTHS) AS VARCHAR(8)), 1, 6) )
<isNotNull col="ITEMNM">
AND     A.ITEMNM LIKE '%'||#ITEMNM#||'%'
</isNotNull>
ORDER BY A.GUBUN, A.ITEM
WITH UR	</statement>
	<input default-name="ds_cond">
	</input>
	<output default-name="ds_list">
	</output>
</query>
