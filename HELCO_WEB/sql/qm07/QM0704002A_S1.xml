<?xml version="1.0" encoding="euc-kr"?>
<query dynamic="true">
	<type>select</type>
	<description><![CDATA[]]></description>
	<reload>true</reload>
	<monitoring>true</monitoring>
	<result-count>0</result-count>
	<statement>
SELECT
         A.GROUP           AS GROUP
        ,A.DEPT            AS DEPT
        ,A.GUBUN           AS GUBUN
        ,A.AMTGUBUN        AS AMTGUBUN
        ,B.ITEM            AS ITEM
        ,B.ITEMNM          AS ITEMNM

        ,B.TEAMNM
        ,B.MAN , B.MAN2 , B.MAN3 ,B.GUBUN2
        , B.ITEM_PR , B.ITEM_CH
        ,VALUE(B.BFAMT, 0) AS BFAMT
        ,VALUE(B.AFAMT, 0) AS AFAMT
        ,VALUE(B.BFAMT, 0) - VALUE(B.AFAMT, 0) AS FAMT
        ,VALUE(B.QNTY, 0)  AS QNTY
        ,(VALUE(B.BFAMT, 0) - VALUE(B.AFAMT, 0)) * VALUE(B.QNTY, 0) AS SAVEFAMT
        ,B.PLANYM         AS PLANYM
        ,VALUE(B.M01, 0)  AS M01
        ,VALUE(B.M02, 0)  AS M02
        ,VALUE(B.M03, 0)  AS M03
        ,VALUE(B.M04, 0)  AS M04
        ,VALUE(B.M05, 0)  AS M05
        ,VALUE(B.M06, 0)  AS M06
        ,VALUE(B.M07, 0)  AS M07
        ,VALUE(B.M08, 0)  AS M08
        ,VALUE(B.M09, 0)  AS M09
        ,VALUE(B.M10, 0)  AS M10
        ,VALUE(B.M11, 0)  AS M11
        ,VALUE(B.M12, 0)  AS M12
        ,VALUE(B.M01, 0) + VALUE(B.M02, 0) + VALUE(B.M03, 0) + VALUE(B.M04, 0) + VALUE(B.M05, 0) + VALUE(B.M06, 0) + VALUE(B.M07, 0) + VALUE(B.M08, 0) + VALUE(B.M09, 0) + VALUE(B.M10, 0) + VALUE(B.M11, 0) + VALUE(B.M12, 0) AS TOT
  FROM (SELECT MANDT, DTEXT1 AS GROUP, CODE2 AS DEPT, CAST('A' AS VARCHAR(1)) AS GUBUN, CAST('P' AS VARCHAR(1)) AS AMTGUBUN FROM SAPHEE.ZLCODE WHERE CODE1 = 'QM01'
        UNION ALL
        SELECT MANDT, DTEXT1 AS GROUP, CODE2 AS DEPT, CAST('A' AS VARCHAR(1)) AS GUBUN, CAST('R' AS VARCHAR(1)) AS AMTGUBUN FROM SAPHEE.ZLCODE WHERE CODE1 = 'QM01'
        UNION ALL
        SELECT MANDT, DTEXT1 AS GROUP, CODE2 AS DEPT, CAST('A' AS VARCHAR(1)) AS GUBUN, CAST('Z' AS VARCHAR(1)) AS AMTGUBUN FROM SAPHEE.ZLCODE WHERE CODE1 = 'QM01'
        UNION ALL
        SELECT MANDT, DTEXT1 AS GROUP, CODE2 AS DEPT, CAST('N' AS VARCHAR(1)) AS GUBUN, CAST('P' AS VARCHAR(1)) AS AMTGUBUN FROM SAPHEE.ZLCODE WHERE CODE1 = 'QM01'
        UNION ALL
        SELECT MANDT, DTEXT1 AS GROUP, CODE2 AS DEPT, CAST('N' AS VARCHAR(1)) AS GUBUN, CAST('R' AS VARCHAR(1)) AS AMTGUBUN FROM SAPHEE.ZLCODE WHERE CODE1 = 'QM01'
        UNION ALL
        SELECT MANDT, DTEXT1 AS GROUP, CODE2 AS DEPT, CAST('N' AS VARCHAR(1)) AS GUBUN, CAST('Z' AS VARCHAR(1)) AS AMTGUBUN FROM SAPHEE.ZLCODE WHERE CODE1 = 'QM01'
       ) AS A
        INNER JOIN TABLE(SELECT 
								      ZQMT071.DEPT   AS DEPT
							         ,ZQMT071.GJAHR  AS GJAHR
							         ,ZQMT071.GUBUN  AS GUBUN
							         ,ZQMT071.ITEM   AS ITEM
							         ,ZQMT071.ITEMNM AS ITEMNM

                                     ,ZQMT071.TEAMNM
							         ,ZQMT071.MAN , ZQMT071.MAN2 ,ZQMT071.MAN3 , ZQMT071.ITEM_PR , ZQMT071.ITEM_CH ,ZQMT071.GUBUN2

									 ,'P'            AS AMTGUBUN
									 ,CASE WHEN ZQMT071.WAERK IN ('KRW', 'JPY') THEN ZQMT071.BFAMT * 100 ELSE ZQMT071.BFAMT END AS BFAMT
									 ,CASE WHEN ZQMT071.WAERK IN ('KRW', 'JPY') THEN ZQMT071.AFAMT * 100 ELSE ZQMT071.AFAMT END AS AFAMT
									 ,ZQMT071.QNTY   AS QNTY
									 ,ZQMT071.PLANYM AS PLANYM
								     ,SUM(CASE WHEN ZQMT072.PLANYM = #GJAHR#||'01' THEN CASE WHEN ZQMT071.WAERK IN ('KRW', 'JPY') THEN ZQMT072.PLANAMT * 100 ELSE ZQMT072.PLANAMT END END) AS M01
								     ,SUM(CASE WHEN ZQMT072.PLANYM = #GJAHR#||'02' THEN CASE WHEN ZQMT071.WAERK IN ('KRW', 'JPY') THEN ZQMT072.PLANAMT * 100 ELSE ZQMT072.PLANAMT END END) AS M02
								     ,SUM(CASE WHEN ZQMT072.PLANYM = #GJAHR#||'03' THEN CASE WHEN ZQMT071.WAERK IN ('KRW', 'JPY') THEN ZQMT072.PLANAMT * 100 ELSE ZQMT072.PLANAMT END END) AS M03
								     ,SUM(CASE WHEN ZQMT072.PLANYM = #GJAHR#||'04' THEN CASE WHEN ZQMT071.WAERK IN ('KRW', 'JPY') THEN ZQMT072.PLANAMT * 100 ELSE ZQMT072.PLANAMT END END) AS M04
								     ,SUM(CASE WHEN ZQMT072.PLANYM = #GJAHR#||'05' THEN CASE WHEN ZQMT071.WAERK IN ('KRW', 'JPY') THEN ZQMT072.PLANAMT * 100 ELSE ZQMT072.PLANAMT END END) AS M05
								     ,SUM(CASE WHEN ZQMT072.PLANYM = #GJAHR#||'06' THEN CASE WHEN ZQMT071.WAERK IN ('KRW', 'JPY') THEN ZQMT072.PLANAMT * 100 ELSE ZQMT072.PLANAMT END END) AS M06
								     ,SUM(CASE WHEN ZQMT072.PLANYM = #GJAHR#||'07' THEN CASE WHEN ZQMT071.WAERK IN ('KRW', 'JPY') THEN ZQMT072.PLANAMT * 100 ELSE ZQMT072.PLANAMT END END) AS M07
								     ,SUM(CASE WHEN ZQMT072.PLANYM = #GJAHR#||'08' THEN CASE WHEN ZQMT071.WAERK IN ('KRW', 'JPY') THEN ZQMT072.PLANAMT * 100 ELSE ZQMT072.PLANAMT END END) AS M08
								     ,SUM(CASE WHEN ZQMT072.PLANYM = #GJAHR#||'09' THEN CASE WHEN ZQMT071.WAERK IN ('KRW', 'JPY') THEN ZQMT072.PLANAMT * 100 ELSE ZQMT072.PLANAMT END END) AS M09
								     ,SUM(CASE WHEN ZQMT072.PLANYM = #GJAHR#||'10' THEN CASE WHEN ZQMT071.WAERK IN ('KRW', 'JPY') THEN ZQMT072.PLANAMT * 100 ELSE ZQMT072.PLANAMT END END) AS M10
								     ,SUM(CASE WHEN ZQMT072.PLANYM = #GJAHR#||'11' THEN CASE WHEN ZQMT071.WAERK IN ('KRW', 'JPY') THEN ZQMT072.PLANAMT * 100 ELSE ZQMT072.PLANAMT END END) AS M11
								     ,SUM(CASE WHEN ZQMT072.PLANYM = #GJAHR#||'12' THEN CASE WHEN ZQMT071.WAERK IN ('KRW', 'JPY') THEN ZQMT072.PLANAMT * 100 ELSE ZQMT072.PLANAMT END END) AS M12
							    FROM SAPHEE.ZQMT071 AS ZQMT071
								     LEFT OUTER JOIN SAPHEE.ZQMT072 AS ZQMT072
								    	   ON ZQMT071.MANDT = ZQMT072.MANDT AND ZQMT071.GJAHR = ZQMT072.GJAHR AND ZQMT071.DEPT = ZQMT072.DEPT AND ZQMT071.ITEM = ZQMT072.ITEM
							   WHERE ZQMT071.MANDT = #G_MANDT#
						<isNotNull col="DEPT">
						         AND ZQMT071.DEPT  = #DEPT#
						</isNotNull>
						 	     AND ZQMT071.GJAHR = #GJAHR#
						 	  GROUP BY ZQMT071.DEPT, ZQMT071.GJAHR, ZQMT071.GUBUN, ZQMT071.ITEM, ZQMT071.ITEMNM, ZQMT071.QNTY, ZQMT071.PLANYM 
						 	          ,CASE WHEN ZQMT071.WAERK IN ('KRW', 'JPY') THEN ZQMT071.BFAMT * 100 ELSE ZQMT071.BFAMT END
						 	          ,CASE WHEN ZQMT071.WAERK IN ('KRW', 'JPY') THEN ZQMT071.AFAMT * 100 ELSE ZQMT071.AFAMT END

                                                                                                            ,ZQMT071.TEAMNM,  ZQMT071.MAN   ,  ZQMT071.MAN2 ,  ZQMT071.MAN3, ZQMT071.ITEM_PR , ZQMT071.ITEM_CH  ,ZQMT071.GUBUN2                                                                                   

							  UNION

							  SELECT 
								      ZQMT071.DEPT  AS DEPT
							         ,ZQMT071.GJAHR AS GJAHR
							         ,ZQMT071.GUBUN AS GUBUN
							         ,ZQMT071.ITEM   AS ITEM
							         ,ZQMT071.ITEMNM AS ITEMNM

                                    ,ZQMT071.TEAMNM
							        ,ZQMT071.MAN ,ZQMT071.MAN2 ,ZQMT071.MAN3
                                    , ZQMT071.ITEM_PR , ZQMT071.ITEM_CH ,ZQMT071.GUBUN2
									 ,'R'            AS AMTGUBUN
									 ,CASE WHEN ZQMT071.WAERK IN ('KRW', 'JPY') THEN ZQMT071.BFAMT * 100 ELSE ZQMT071.BFAMT END AS BFAMT
									 ,CASE WHEN ZQMT071.WAERK IN ('KRW', 'JPY') THEN ZQMT071.AFAMT * 100 ELSE ZQMT071.AFAMT END AS AFAMT
									 ,ZQMT071.QNTY   AS QNTY
									 ,ZQMT071.PLANYM AS PLANYM
								     ,SUM(CASE WHEN ZQMT076.RSLTYM = #GJAHR#||'01' THEN CASE WHEN ZQMT076.WAERK IN ('KRW', 'JPY') THEN ZQMT076.RSLTAMT * 100 ELSE ZQMT076.RSLTAMT END END) AS M01
								     ,SUM(CASE WHEN ZQMT076.RSLTYM = #GJAHR#||'02' THEN CASE WHEN ZQMT076.WAERK IN ('KRW', 'JPY') THEN ZQMT076.RSLTAMT * 100 ELSE ZQMT076.RSLTAMT END END) AS M02
								     ,SUM(CASE WHEN ZQMT076.RSLTYM = #GJAHR#||'03' THEN CASE WHEN ZQMT076.WAERK IN ('KRW', 'JPY') THEN ZQMT076.RSLTAMT * 100 ELSE ZQMT076.RSLTAMT END END) AS M03
								     ,SUM(CASE WHEN ZQMT076.RSLTYM = #GJAHR#||'04' THEN CASE WHEN ZQMT076.WAERK IN ('KRW', 'JPY') THEN ZQMT076.RSLTAMT * 100 ELSE ZQMT076.RSLTAMT END END) AS M04
								     ,SUM(CASE WHEN ZQMT076.RSLTYM = #GJAHR#||'05' THEN CASE WHEN ZQMT076.WAERK IN ('KRW', 'JPY') THEN ZQMT076.RSLTAMT * 100 ELSE ZQMT076.RSLTAMT END END) AS M05
								     ,SUM(CASE WHEN ZQMT076.RSLTYM = #GJAHR#||'06' THEN CASE WHEN ZQMT076.WAERK IN ('KRW', 'JPY') THEN ZQMT076.RSLTAMT * 100 ELSE ZQMT076.RSLTAMT END END) AS M06
								     ,SUM(CASE WHEN ZQMT076.RSLTYM = #GJAHR#||'07' THEN CASE WHEN ZQMT076.WAERK IN ('KRW', 'JPY') THEN ZQMT076.RSLTAMT * 100 ELSE ZQMT076.RSLTAMT END END) AS M07
								     ,SUM(CASE WHEN ZQMT076.RSLTYM = #GJAHR#||'08' THEN CASE WHEN ZQMT076.WAERK IN ('KRW', 'JPY') THEN ZQMT076.RSLTAMT * 100 ELSE ZQMT076.RSLTAMT END END) AS M08
								     ,SUM(CASE WHEN ZQMT076.RSLTYM = #GJAHR#||'09' THEN CASE WHEN ZQMT076.WAERK IN ('KRW', 'JPY') THEN ZQMT076.RSLTAMT * 100 ELSE ZQMT076.RSLTAMT END END) AS M09
								     ,SUM(CASE WHEN ZQMT076.RSLTYM = #GJAHR#||'10' THEN CASE WHEN ZQMT076.WAERK IN ('KRW', 'JPY') THEN ZQMT076.RSLTAMT * 100 ELSE ZQMT076.RSLTAMT END END) AS M10
								     ,SUM(CASE WHEN ZQMT076.RSLTYM = #GJAHR#||'11' THEN CASE WHEN ZQMT076.WAERK IN ('KRW', 'JPY') THEN ZQMT076.RSLTAMT * 100 ELSE ZQMT076.RSLTAMT END END) AS M11
								     ,SUM(CASE WHEN ZQMT076.RSLTYM = #GJAHR#||'12' THEN CASE WHEN ZQMT076.WAERK IN ('KRW', 'JPY') THEN ZQMT076.RSLTAMT * 100 ELSE ZQMT076.RSLTAMT END END) AS M12
							    FROM SAPHEE.ZQMT071 AS ZQMT071
								     LEFT OUTER JOIN SAPHEE.ZQMT076 AS ZQMT076
								    	  ON ZQMT071.MANDT = ZQMT076.MANDT AND ZQMT071.GJAHR = ZQMT076.GJAHR AND ZQMT071.DEPT = ZQMT076.DEPT AND ZQMT071.ITEM = ZQMT076.ITEM
							   WHERE ZQMT071.MANDT = #G_MANDT#
						<isNotNull col="DEPT">
						         AND ZQMT071.DEPT  = #DEPT#
						</isNotNull>
						 		 AND ZQMT071.GJAHR = #GJAHR#
						 	  GROUP BY ZQMT071.DEPT, ZQMT071.GJAHR, ZQMT071.GUBUN, ZQMT071.ITEM, ZQMT071.ITEMNM, ZQMT071.QNTY, ZQMT071.PLANYM
						 	          ,CASE WHEN ZQMT071.WAERK IN ('KRW', 'JPY') THEN ZQMT071.BFAMT * 100 ELSE ZQMT071.BFAMT END
						 	          ,CASE WHEN ZQMT071.WAERK IN ('KRW', 'JPY') THEN ZQMT071.AFAMT * 100 ELSE ZQMT071.AFAMT END

                                                                                                            ,ZQMT071.TEAMNM,  ZQMT071.MAN ,ZQMT071.MAN2 ,ZQMT071.MAN3   , ZQMT071.ITEM_PR , ZQMT071.ITEM_CH ,ZQMT071.GUBUN2                                                                                              

							  UNION

				              SELECT 
								      ZQMT071.DEPT  AS DEPT
							         ,ZQMT071.GJAHR AS GJAHR
							         ,ZQMT071.GUBUN AS GUBUN
							         ,ZQMT071.ITEM   AS ITEM
							         ,ZQMT071.ITEMNM AS ITEMNM

                                     ,ZQMT071.TEAMNM
							         ,ZQMT071.MAN ,ZQMT071.MAN2 ,ZQMT071.MAN3
                                     , ZQMT071.ITEM_PR , ZQMT071.ITEM_CH ,ZQMT071.GUBUN2
									 ,'Z'            AS AMTGUBUN
									 ,CASE WHEN ZQMT071.WAERK IN ('KRW', 'JPY') THEN ZQMT071.BFAMT * 100 ELSE ZQMT071.BFAMT END AS BFAMT
									 ,CASE WHEN ZQMT071.WAERK IN ('KRW', 'JPY') THEN ZQMT071.AFAMT * 100 ELSE ZQMT071.AFAMT END AS AFAMT
									 ,ZQMT071.QNTY   AS QNTY
									 ,ZQMT071.PLANYM AS PLANYM
								     ,SUM(CASE WHEN ZQMT076.RSLTYM = #GJAHR#||'01' THEN CASE WHEN ZQMT076.WAERK IN ('KRW', 'JPY') THEN ZQMT076.CHKAMT * 100 ELSE ZQMT076.CHKAMT END END) AS M01
								     ,SUM(CASE WHEN ZQMT076.RSLTYM = #GJAHR#||'02' THEN CASE WHEN ZQMT076.WAERK IN ('KRW', 'JPY') THEN ZQMT076.CHKAMT * 100 ELSE ZQMT076.CHKAMT END END) AS M02
								     ,SUM(CASE WHEN ZQMT076.RSLTYM = #GJAHR#||'03' THEN CASE WHEN ZQMT076.WAERK IN ('KRW', 'JPY') THEN ZQMT076.CHKAMT * 100 ELSE ZQMT076.CHKAMT END END) AS M03
								     ,SUM(CASE WHEN ZQMT076.RSLTYM = #GJAHR#||'04' THEN CASE WHEN ZQMT076.WAERK IN ('KRW', 'JPY') THEN ZQMT076.CHKAMT * 100 ELSE ZQMT076.CHKAMT END END) AS M04
								     ,SUM(CASE WHEN ZQMT076.RSLTYM = #GJAHR#||'05' THEN CASE WHEN ZQMT076.WAERK IN ('KRW', 'JPY') THEN ZQMT076.CHKAMT * 100 ELSE ZQMT076.CHKAMT END END) AS M05
								     ,SUM(CASE WHEN ZQMT076.RSLTYM = #GJAHR#||'06' THEN CASE WHEN ZQMT076.WAERK IN ('KRW', 'JPY') THEN ZQMT076.CHKAMT * 100 ELSE ZQMT076.CHKAMT END END) AS M06
								     ,SUM(CASE WHEN ZQMT076.RSLTYM = #GJAHR#||'07' THEN CASE WHEN ZQMT076.WAERK IN ('KRW', 'JPY') THEN ZQMT076.CHKAMT * 100 ELSE ZQMT076.CHKAMT END END) AS M07
								     ,SUM(CASE WHEN ZQMT076.RSLTYM = #GJAHR#||'08' THEN CASE WHEN ZQMT076.WAERK IN ('KRW', 'JPY') THEN ZQMT076.CHKAMT * 100 ELSE ZQMT076.CHKAMT END END) AS M08
								     ,SUM(CASE WHEN ZQMT076.RSLTYM = #GJAHR#||'09' THEN CASE WHEN ZQMT076.WAERK IN ('KRW', 'JPY') THEN ZQMT076.CHKAMT * 100 ELSE ZQMT076.CHKAMT END END) AS M09
								     ,SUM(CASE WHEN ZQMT076.RSLTYM = #GJAHR#||'10' THEN CASE WHEN ZQMT076.WAERK IN ('KRW', 'JPY') THEN ZQMT076.CHKAMT * 100 ELSE ZQMT076.CHKAMT END END) AS M10
								     ,SUM(CASE WHEN ZQMT076.RSLTYM = #GJAHR#||'11' THEN CASE WHEN ZQMT076.WAERK IN ('KRW', 'JPY') THEN ZQMT076.CHKAMT * 100 ELSE ZQMT076.CHKAMT END END) AS M11
								     ,SUM(CASE WHEN ZQMT076.RSLTYM = #GJAHR#||'12' THEN CASE WHEN ZQMT076.WAERK IN ('KRW', 'JPY') THEN ZQMT076.CHKAMT * 100 ELSE ZQMT076.CHKAMT END END) AS M12
							    FROM SAPHEE.ZQMT071 AS ZQMT071
								     LEFT OUTER JOIN TABLE (SELECT ZQMT076.MANDT AS MANDT,   ZQMT076.GJAHR AS GJAHR, ZQMT076.DEPT AS DEPT, ZQMT076.ITEM AS ITEM,
								                                   ZQMT076.RSLTYM AS RSLTYM, ZQMT076.WAERK AS WAERK, 
								                                   CASE WHEN REPLACE(ZQMT074.CFDATE, '00000000', '') = '' THEN 0 ELSE ZQMT076.CHKAMT END AS CHKAMT
								                              FROM SAPHEE.ZQMT076 AS ZQMT076
								                                   INNER JOIN SAPHEE.ZQMT074 AS ZQMT074  
										                                   ON ZQMT074.MANDT = ZQMT076.MANDT AND ZQMT074.GJAHR = ZQMT076.GJAHR AND ZQMT074.DEPT = ZQMT076.DEPT AND ZQMT074.RSLTYM = ZQMT076.RSLTYM

                                                             WHERE ZQMT076.MANDT = #G_MANDT# 
                                                               AND ZQMT076.GJAHR = #GJAHR#
                                                           <isNotNull col="DEPT">
                                                               AND ZQMT076.DEPT = #DEPT#
                                                           </isNotNull>
								                           )AS ZQMT076
								    	    ON ZQMT071.MANDT = ZQMT076.MANDT AND ZQMT071.GJAHR = ZQMT076.GJAHR AND ZQMT071.DEPT = ZQMT076.DEPT AND ZQMT071.ITEM = ZQMT076.ITEM

							   WHERE ZQMT071.MANDT = #G_MANDT#
						<isNotNull col="DEPT">
						         AND ZQMT071.DEPT  = #DEPT#
						</isNotNull>
						 		 AND ZQMT071.GJAHR = #GJAHR#
						 	  GROUP BY ZQMT071.DEPT, ZQMT071.GJAHR, ZQMT071.GUBUN, ZQMT071.ITEM, ZQMT071.ITEMNM, ZQMT071.QNTY, ZQMT071.PLANYM
						 	          ,CASE WHEN ZQMT071.WAERK IN ('KRW', 'JPY') THEN ZQMT071.BFAMT * 100 ELSE ZQMT071.BFAMT END
						 	          ,CASE WHEN ZQMT071.WAERK IN ('KRW', 'JPY') THEN ZQMT071.AFAMT * 100 ELSE ZQMT071.AFAMT END

                                                                                                            ,ZQMT071.TEAMNM,  ZQMT071.MAN ,ZQMT071.MAN2 ,ZQMT071.MAN3   , ZQMT071.ITEM_PR , ZQMT071.ITEM_CH   ,ZQMT071.GUBUN2                                                                                                      

				             ) AS B
	                           ON B.DEPT = A.DEPT AND B.GUBUN = A.GUBUN AND B.AMTGUBUN = A.AMTGUBUN

 WHERE A.MANDT = #G_MANDT#
<isNotNull col="DEPT">
   AND A.DEPT  = #DEPT#
</isNotNull>
ORDER BY A.GROUP, A.DEPT, A.GUBUN, B.ITEM, B.ITEMNM, A.AMTGUBUN 
WITH UR	</statement>
	<input default-name="ds_cond">
	</input>
	<output default-name="ds_list">
	</output>
</query>
