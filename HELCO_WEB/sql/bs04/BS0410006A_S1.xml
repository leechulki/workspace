<?xml version="1.0" encoding="euc-kr"?>
<query dynamic="true">
	<type>select</type>
	<description><![CDATA[]]></description>
	<reload>true</reload>
	<monitoring>true</monitoring>
	<result-count>0</result-count>
	<statement>
SELECT T3.MANDT,
             T3.DTP,
			 T3.GBN1,
             T3.GBN2, 
			 T3.GBN3, 
			 T3.VKBUR, 
			 T3.MPLAN,
           (CASE WHEN T3.VKBUR ='B3'  THEN 'A1'
                        WHEN T3.VKBUR ='B1'  THEN 'A2'
                        WHEN T3.VKBUR = 'B2' THEN 'A3'
                        WHEN T3.VKBUR = 'B4' THEN 'A4'
						WHEN T3.VKBUR = 'BC' THEN 'A5'
					    WHEN T3.VKBUR = 'BL' THEN 'A6'
					    WHEN T3.VKBUR = 'BM' THEN 'A7'
					    WHEN T3.VKBUR = 'B8' THEN 'A9'
					    WHEN T3.VKBUR = 'BG'     THEN 'A8'
                        WHEN T3.VKBUR = 'XXXX' THEN 'B2'
                        WHEN T3.VKBUR = 'CA' THEN  'C1'
                        WHEN T3.VKBUR = 'CE' THEN  'C2'
                        WHEN T3.VKBUR = 'CC' THEN  'C3'
                        WHEN T3.VKBUR = 'CD' THEN  'C4'
                        WHEN T3.VKBUR = 'E6' THEN  'D2'
                        WHEN T3.VKBUR = 'H4'    THEN 'F1' 
						WHEN T3.VKBUR = 'FD'    THEN 'G1' 
	         END ) AS ACHIEVE  ,
						  T3.MON01 AS MON01, T3.MON02 AS MON02,  T3.MON03 AS MON03, T3.MON04 AS MON04,           
			              T3.MON05 AS MON05, T3.MON06 AS MON06,  T3.MON07 AS MON07, T3.MON08 AS MON08,           
			              T3.MON09 AS MON09, T3.MON10 AS MON10,  T3.MON11 AS MON11, T3.MON12 AS MON12, 0 PER     

			 
			 

FROM
   (SELECT T2.MANDT,
           (CASE WHEN T2.VKBUR ='B3' THEN 'MP 영업부'
			   			   WHEN T2.VKBUR ='B1' THEN '영업 1부'
						  WHEN T2.VKBUR = 'B2' THEN '영업 2부'
						  WHEN T2.VKBUR = 'B4' THEN '영업 3부'
						   WHEN T2.VKBUR = 'BC' THEN '영업4부'
						  WHEN T2.VKBUR = 'B8' THEN '기술영업부'
						  WHEN T2.VKBUR = 'XXXX' THEN '설치담당'
						  WHEN T2.VKBUR = 'CA' THEN  'S/S영업부'
						  WHEN T2.VKBUR = 'C7' THEN  '주차영업부'
						  WHEN T2.VKBUR = 'B7' THEN  '기술영업팀'
						  WHEN T2.VKBUR = 'CE' THEN 'S/S SE'
						  WHEN T2.VKBUR = 'CC' THEN 'S/S 기술부'
						  WHEN T2.VKBUR = 'CD' THEN 'S/S서비스팀'
						  WHEN T2.VKBUR = 'E6' THEN '리모델링영업부' 
						  WHEN T2.VKBUR = 'H4' THEN 'Special Project TFT'
						  WHEN T2.VKBUR = 'FD' THEN  '디자인연구소'
					  	  WHEN T2.VKBUR = 'BG' THEN '한국영업3부' 
						  WHEN T2.VKBUR = 'BL' THEN '한국리모델링영업부'
						  WHEN T2.VKBUR = 'BM' THEN  '한국주차영업부'
						  END ) AS DTP ,
						  T2.GBN1,
              			  T2.GBN2, 
			              T2.GBN3, 
			              T2.VKBUR, 
			              T3.PLAN_NETWR MPLAN,
			              T2.ACHIEVE,
                           T2.MON01 AS MON01, T2.MON02 AS MON02,  T2.MON03 AS MON03, T2.MON04 AS MON04,
			              T2.MON05 AS MON05, T2.MON06 AS MON06,  T2.MON07 AS MON07, T2.MON08 AS MON08,
			              T2.MON09 AS MON09, T2.MON10 AS MON10,  T2.MON11 AS MON11, T2.MON12 AS MON12, 0 PER
						  
				
FROM 						
(  
SELECT T1.MANDT, 
            ( CASE WHEN T1.VKBUR  = 'B1' OR T1.VKBUR  = 'B2' OR T1.VKBUR  = 'B3' OR T1.VKBUR  = 'B4' OR T1.VKBUR  = 'B8'  OR T1.VKBUR  = 'C7'   OR T1.VKBUR  = 'B7'  OR T1.VKBUR  = 'BC' OR T1.VKBUR  = 'BL' OR T1.VKBUR  = 'BG' OR T1.VKBUR  = 'BM' THEN 'A'  
                   WHEN T1.VKBUR  = 'XXXX' OR T1.VKBUR  = 'E100'                                                                                                                THEN 'B' 
                   WHEN T1.VKBUR  = 'CA' OR T1.VKBUR  = 'CC' OR T1.VKBUR  = 'CD'  OR T1.VKBUR  = 'CE'  THEN 'C'    
                   WHEN T1.VKBUR = 'E6'                                      THEN 'D'
                   WHEN T1.VKBUR  = 'H4'                                                                                                                                        THEN 'E' 
                   ELSE 'ZZZZ' END) AS GBN1, 
			 T1.GBN2, 
			 T1.GBN3, 
			 T1.VKBUR,
			 SUBSTR(T1.MAKE_MM,1,4) MAKE_Y,
			 T1.ACHIEVE,
           ROUND(SUM(T1.MON01)/1000000,0) AS MON01,  ROUND( SUM(T1.MON02)/1000000,0) AS MON02,   ROUND(SUM(T1.MON03)/1000000,0) AS MON03,   ROUND(SUM(T1.MON04)/1000000,0) AS MON04,
			 ROUND(SUM(T1.MON05)/1000000,0) AS MON05,   ROUND(SUM(T1.MON06) /1000000,0)AS MON06,   ROUND(SUM(T1.MON07) /1000000,0)AS MON07,   ROUND(SUM(T1.MON08)/1000000,0) AS MON08,
			 ROUND( SUM(T1.MON09)/1000000,0) AS MON09,   ROUND(SUM(T1.MON10) /1000000,0)AS MON10,   ROUND(SUM(T1.MON11) /1000000,0)AS MON11,   ROUND(SUM(T1.MON12)/1000000,0) AS MON12, 0 PER
   FROM(

		SELECT A.MANDT, '' AS GBN1,  '' AS GBN2,  '' AS GBN3, ''AS MPLAN,'' AS ACHIEVE,A.MR_DPT1 AS VKBUR , A.MAKE_MM,
		             (CASE WHEN SUBSTR(A.MAKE_MM, 5, 2) = '01' THEN CAST(A.MR_NETWR * VALUE(E.ACCOUNTS,1)  AS DECIMAL(13, 2) ) ELSE 0 END) AS MON01,
					 (CASE WHEN SUBSTR(A.MAKE_MM, 5, 2) = '02' THEN CAST(A.MR_NETWR * VALUE(E.ACCOUNTS,1)  AS DECIMAL(13, 2) ) ELSE 0 END) AS MON02,
					 (CASE WHEN SUBSTR(A.MAKE_MM, 5, 2) = '03' THEN CAST(A.MR_NETWR * VALUE(E.ACCOUNTS,1)  AS DECIMAL(13, 2) ) ELSE 0 END) AS MON03,
					 (CASE WHEN SUBSTR(A.MAKE_MM, 5, 2) = '04' THEN CAST(A.MR_NETWR * VALUE(E.ACCOUNTS,1)  AS DECIMAL(13, 2) ) ELSE 0 END) AS MON04,
					 (CASE WHEN SUBSTR(A.MAKE_MM, 5, 2) = '05' THEN CAST(A.MR_NETWR * VALUE(E.ACCOUNTS,1)  AS DECIMAL(13, 2) ) ELSE 0 END) AS MON05,
					 (CASE WHEN SUBSTR(A.MAKE_MM, 5, 2) = '06' THEN CAST(A.MR_NETWR * VALUE(E.ACCOUNTS,1)  AS DECIMAL(13, 2) ) ELSE 0 END) AS MON06,
					 (CASE WHEN SUBSTR(A.MAKE_MM, 5, 2) = '07' THEN CAST(A.MR_NETWR * VALUE(E.ACCOUNTS,1)  AS DECIMAL(13, 2) ) ELSE 0 END) AS MON07,
					 (CASE WHEN SUBSTR(A.MAKE_MM, 5, 2) = '08' THEN CAST(A.MR_NETWR * VALUE(E.ACCOUNTS,1)  AS DECIMAL(13, 2) ) ELSE 0 END) AS MON08,
					 (CASE WHEN SUBSTR(A.MAKE_MM, 5, 2) = '09' THEN CAST(A.MR_NETWR * VALUE(E.ACCOUNTS,1)  AS DECIMAL(13, 2) ) ELSE 0 END) AS MON09,
					 (CASE WHEN SUBSTR(A.MAKE_MM, 5, 2) = '10' THEN CAST(A.MR_NETWR * VALUE(E.ACCOUNTS,1)  AS DECIMAL(13, 2) ) ELSE 0 END) AS MON10,
					 (CASE WHEN SUBSTR(A.MAKE_MM, 5, 2) = '11' THEN CAST(A.MR_NETWR * VALUE(E.ACCOUNTS,1)  AS DECIMAL(13, 2) ) ELSE 0 END) AS MON11,
					 (CASE WHEN SUBSTR(A.MAKE_MM, 5, 2) = '12' THEN CAST(A.MR_NETWR * VALUE(E.ACCOUNTS,1)  AS DECIMAL(13, 2) ) ELSE 0 END) AS MON12
		  FROM SAPHEE.ZSDTW006 AS A
		  INNER JOIN SAPHEE.VBAK AS B
               ON A.MANDT = B.MANDT
             AND A.PSPID   = B.ZZPJT_ID
		  LEFT OUTER JOIN SAPHEE.ZCURRCHG AS E
            ON A.MANDT  = E.MANDT
          AND A.WAERK  = E.WAERK 			 
		WHERE A.MANDT = #G_MANDT#
              <isNotNull col="MAKF_DT">
		      AND SUBSTR(A.MAKE_MM, 1, 4) = SUBSTR(#MAKF_DT#,1,4) 
             </isNotNull>
                            	
                                          		 
	    UNION ALL
		
		SELECT A.MANDT, '' AS GBN1,  '' AS GBN2, '' AS GBN3,''AS MPLAN, '' AS ACHIEVE,A.DEPT AS VKBUR, A.MAKE_MM,
		             (CASE WHEN SUBSTR(A.MAKE_MM, 5, 2) = '01' THEN CAST(A.MR_NETWR * VALUE(E.ACCOUNTS,1)  AS DECIMAL(13, 2) ) ELSE 0 END) AS MON01,
					 (CASE WHEN SUBSTR(A.MAKE_MM, 5, 2) = '02' THEN CAST(A.MR_NETWR * VALUE(E.ACCOUNTS,1)  AS DECIMAL(13, 2) ) ELSE 0 END) AS MON02,
					 (CASE WHEN SUBSTR(A.MAKE_MM, 5, 2) = '03' THEN CAST(A.MR_NETWR * VALUE(E.ACCOUNTS,1)  AS DECIMAL(13, 2) ) ELSE 0 END) AS MON03,
					 (CASE WHEN SUBSTR(A.MAKE_MM, 5, 2) = '04' THEN CAST(A.MR_NETWR * VALUE(E.ACCOUNTS,1)  AS DECIMAL(13, 2) ) ELSE 0 END) AS MON04,
					 (CASE WHEN SUBSTR(A.MAKE_MM, 5, 2) = '05' THEN CAST(A.MR_NETWR * VALUE(E.ACCOUNTS,1)  AS DECIMAL(13, 2) ) ELSE 0 END) AS MON05,
					 (CASE WHEN SUBSTR(A.MAKE_MM, 5, 2) = '06' THEN CAST(A.MR_NETWR * VALUE(E.ACCOUNTS,1)  AS DECIMAL(13, 2) ) ELSE 0 END) AS MON06,
					 (CASE WHEN SUBSTR(A.MAKE_MM, 5, 2) = '07' THEN CAST(A.MR_NETWR * VALUE(E.ACCOUNTS,1)  AS DECIMAL(13, 2) ) ELSE 0 END) AS MON07,
					 (CASE WHEN SUBSTR(A.MAKE_MM, 5, 2) = '08' THEN CAST(A.MR_NETWR * VALUE(E.ACCOUNTS,1)  AS DECIMAL(13, 2) ) ELSE 0 END) AS MON08,
					 (CASE WHEN SUBSTR(A.MAKE_MM, 5, 2) = '09' THEN CAST(A.MR_NETWR * VALUE(E.ACCOUNTS,1)  AS DECIMAL(13, 2) ) ELSE 0 END) AS MON09,
					 (CASE WHEN SUBSTR(A.MAKE_MM, 5, 2) = '10' THEN CAST(A.MR_NETWR * VALUE(E.ACCOUNTS,1)  AS DECIMAL(13, 2) ) ELSE 0 END) AS MON10,
					 (CASE WHEN SUBSTR(A.MAKE_MM, 5, 2) = '11' THEN CAST(A.MR_NETWR * VALUE(E.ACCOUNTS,1)  AS DECIMAL(13, 2) ) ELSE 0 END) AS MON11,
					 (CASE WHEN SUBSTR(A.MAKE_MM, 5, 2) = '12' THEN CAST(A.MR_NETWR * VALUE(E.ACCOUNTS,1)  AS DECIMAL(13, 2) ) ELSE 0 END) AS MON12
		  FROM SAPHEE.ZSDTW031 AS A
		  LEFT OUTER JOIN SAPHEE.ZCURRCHG AS E
            ON A.MANDT  = E.MANDT
          AND A.WAERK  = E.WAERK 		  
		WHERE A.MANDT = #G_MANDT#
              <isNotNull col="MAKF_DT">
		      AND SUBSTR(A.MAKE_MM, 1, 4) = SUBSTR(#MAKF_DT#,1,4) 
             </isNotNull>
                            	
              		 
	    UNION ALL
		
		SELECT A.MANDT, '' AS GBN1,  '' AS GBN2,  '' AS GBN3, ''AS MPLAN, '' AS ACHIEVE,A.DEPT AS VKBUR, A.MAKE_MM,
		             (CASE WHEN SUBSTR(A.MAKE_MM, 5, 2) = '01' THEN CAST(A.MR_NETWR * VALUE(E.ACCOUNTS,1)  AS DECIMAL(13, 2) ) ELSE 0 END) AS MON01,
					 (CASE WHEN SUBSTR(A.MAKE_MM, 5, 2) = '02' THEN CAST(A.MR_NETWR * VALUE(E.ACCOUNTS,1)  AS DECIMAL(13, 2) ) ELSE 0 END) AS MON02,
					 (CASE WHEN SUBSTR(A.MAKE_MM, 5, 2) = '03' THEN CAST(A.MR_NETWR * VALUE(E.ACCOUNTS,1)  AS DECIMAL(13, 2) ) ELSE 0 END) AS MON03,
					 (CASE WHEN SUBSTR(A.MAKE_MM, 5, 2) = '04' THEN CAST(A.MR_NETWR * VALUE(E.ACCOUNTS,1)  AS DECIMAL(13, 2) ) ELSE 0 END) AS MON04,
					 (CASE WHEN SUBSTR(A.MAKE_MM, 5, 2) = '05' THEN CAST(A.MR_NETWR * VALUE(E.ACCOUNTS,1)  AS DECIMAL(13, 2) ) ELSE 0 END) AS MON05,
					 (CASE WHEN SUBSTR(A.MAKE_MM, 5, 2) = '06' THEN CAST(A.MR_NETWR * VALUE(E.ACCOUNTS,1)  AS DECIMAL(13, 2) ) ELSE 0 END) AS MON06,
					 (CASE WHEN SUBSTR(A.MAKE_MM, 5, 2) = '07' THEN CAST(A.MR_NETWR * VALUE(E.ACCOUNTS,1)  AS DECIMAL(13, 2) ) ELSE 0 END) AS MON07,
					 (CASE WHEN SUBSTR(A.MAKE_MM, 5, 2) = '08' THEN CAST(A.MR_NETWR * VALUE(E.ACCOUNTS,1)  AS DECIMAL(13, 2) ) ELSE 0 END) AS MON08,
					 (CASE WHEN SUBSTR(A.MAKE_MM, 5, 2) = '09' THEN CAST(A.MR_NETWR * VALUE(E.ACCOUNTS,1)  AS DECIMAL(13, 2) ) ELSE 0 END) AS MON09,
					 (CASE WHEN SUBSTR(A.MAKE_MM, 5, 2) = '10' THEN CAST(A.MR_NETWR * VALUE(E.ACCOUNTS,1)  AS DECIMAL(13, 2) ) ELSE 0 END) AS MON10,
					 (CASE WHEN SUBSTR(A.MAKE_MM, 5, 2) = '11' THEN CAST(A.MR_NETWR * VALUE(E.ACCOUNTS,1)  AS DECIMAL(13, 2) ) ELSE 0 END) AS MON11,
					 (CASE WHEN SUBSTR(A.MAKE_MM, 5, 2) = '12' THEN CAST(A.MR_NETWR * VALUE(E.ACCOUNTS,1)  AS DECIMAL(13, 2) ) ELSE 0 END) AS MON12
		  FROM SAPHEE.ZSDTW041 AS A
		  LEFT OUTER JOIN SAPHEE.ZCURRCHG AS E
            ON A.MANDT  = E.MANDT
          AND A.WAERK  = E.WAERK 		  
		WHERE A.MANDT = #G_MANDT#
              <isNotNull col="MAKF_DT">
		      AND SUBSTR(A.MAKE_MM, 1, 4) = SUBSTR(#MAKF_DT#,1,4) 
             </isNotNull>
                            	
	    UNION ALL
		
		SELECT A.MANDT, '' AS GBN1,  '' AS GBN2, '' AS GBN3, ''AS MPLAN, '' AS ACHIEVE,'XXXX' AS VKBUR, A.MAKE_MM,  --설치부분 
		             (CASE WHEN SUBSTR(A.MAKE_MM, 5, 2) = '01' THEN CAST(A.MR_NETWR * VALUE(E.ACCOUNTS,1)  AS DECIMAL(13, 2) ) ELSE 0 END) AS MON01,
					 (CASE WHEN SUBSTR(A.MAKE_MM, 5, 2) = '02' THEN CAST(A.MR_NETWR * VALUE(E.ACCOUNTS,1)  AS DECIMAL(13, 2) ) ELSE 0 END) AS MON02,
					 (CASE WHEN SUBSTR(A.MAKE_MM, 5, 2) = '03' THEN CAST(A.MR_NETWR * VALUE(E.ACCOUNTS,1)  AS DECIMAL(13, 2) ) ELSE 0 END) AS MON03,
					 (CASE WHEN SUBSTR(A.MAKE_MM, 5, 2) = '04' THEN CAST(A.MR_NETWR * VALUE(E.ACCOUNTS,1)  AS DECIMAL(13, 2) ) ELSE 0 END) AS MON04,
					 (CASE WHEN SUBSTR(A.MAKE_MM, 5, 2) = '05' THEN CAST(A.MR_NETWR * VALUE(E.ACCOUNTS,1)  AS DECIMAL(13, 2) ) ELSE 0 END) AS MON05,
					 (CASE WHEN SUBSTR(A.MAKE_MM, 5, 2) = '06' THEN CAST(A.MR_NETWR * VALUE(E.ACCOUNTS,1)  AS DECIMAL(13, 2) ) ELSE 0 END) AS MON06,
					 (CASE WHEN SUBSTR(A.MAKE_MM, 5, 2) = '07' THEN CAST(A.MR_NETWR * VALUE(E.ACCOUNTS,1)  AS DECIMAL(13, 2) ) ELSE 0 END) AS MON07,
					 (CASE WHEN SUBSTR(A.MAKE_MM, 5, 2) = '08' THEN CAST(A.MR_NETWR * VALUE(E.ACCOUNTS,1)  AS DECIMAL(13, 2) ) ELSE 0 END) AS MON08,
					 (CASE WHEN SUBSTR(A.MAKE_MM, 5, 2) = '09' THEN CAST(A.MR_NETWR * VALUE(E.ACCOUNTS,1)  AS DECIMAL(13, 2) ) ELSE 0 END) AS MON09,
					 (CASE WHEN SUBSTR(A.MAKE_MM, 5, 2) = '10' THEN CAST(A.MR_NETWR * VALUE(E.ACCOUNTS,1)  AS DECIMAL(13, 2) ) ELSE 0 END) AS MON10,
					 (CASE WHEN SUBSTR(A.MAKE_MM, 5, 2) = '11' THEN CAST(A.MR_NETWR * VALUE(E.ACCOUNTS,1)  AS DECIMAL(13, 2) ) ELSE 0 END) AS MON11,
					 (CASE WHEN SUBSTR(A.MAKE_MM, 5, 2) = '12' THEN CAST(A.MR_NETWR * VALUE(E.ACCOUNTS,1)  AS DECIMAL(13, 2) ) ELSE 0 END) AS MON12
		  FROM SAPHEE.ZPSTW0401 AS A
		  LEFT OUTER JOIN SAPHEE.ZCURRCHG AS E
            ON A.MANDT  = E.MANDT
          AND A.WAERK  = E.WAERK 		  
		WHERE A.MANDT = #G_MANDT#
              <isNotNull col="MAKF_DT">
		      AND SUBSTR(A.MAKE_MM, 1, 4) = SUBSTR(#MAKF_DT#,1,4) 
             </isNotNull>
                            	
	 
	    UNION ALL
		
		SELECT A.MANDT, '' AS GBN1,  '' AS GBN2, '' AS GBN3, ''AS MPLAN, '' AS ACHIEVE,DEPARTMENT AS VKBUR, A.MAKE_MM, --기술영업
		             (CASE WHEN SUBSTR(A.MAKE_MM, 5, 2) = '01' THEN CAST(A.MR_NETWR * VALUE(E.ACCOUNTS,1)  AS DECIMAL(13, 2) ) ELSE 0 END) AS MON01,
					 (CASE WHEN SUBSTR(A.MAKE_MM, 5, 2) = '02' THEN CAST(A.MR_NETWR * VALUE(E.ACCOUNTS,1)  AS DECIMAL(13, 2) ) ELSE 0 END) AS MON02,
					 (CASE WHEN SUBSTR(A.MAKE_MM, 5, 2) = '03' THEN CAST(A.MR_NETWR * VALUE(E.ACCOUNTS,1)  AS DECIMAL(13, 2) ) ELSE 0 END) AS MON03,
					 (CASE WHEN SUBSTR(A.MAKE_MM, 5, 2) = '04' THEN CAST(A.MR_NETWR * VALUE(E.ACCOUNTS,1)  AS DECIMAL(13, 2) ) ELSE 0 END) AS MON04,
					 (CASE WHEN SUBSTR(A.MAKE_MM, 5, 2) = '05' THEN CAST(A.MR_NETWR * VALUE(E.ACCOUNTS,1)  AS DECIMAL(13, 2) ) ELSE 0 END) AS MON05,
					 (CASE WHEN SUBSTR(A.MAKE_MM, 5, 2) = '06' THEN CAST(A.MR_NETWR * VALUE(E.ACCOUNTS,1)  AS DECIMAL(13, 2) ) ELSE 0 END) AS MON06,
					 (CASE WHEN SUBSTR(A.MAKE_MM, 5, 2) = '07' THEN CAST(A.MR_NETWR * VALUE(E.ACCOUNTS,1)  AS DECIMAL(13, 2) ) ELSE 0 END) AS MON07,
					 (CASE WHEN SUBSTR(A.MAKE_MM, 5, 2) = '08' THEN CAST(A.MR_NETWR * VALUE(E.ACCOUNTS,1)  AS DECIMAL(13, 2) ) ELSE 0 END) AS MON08,
					 (CASE WHEN SUBSTR(A.MAKE_MM, 5, 2) = '09' THEN CAST(A.MR_NETWR * VALUE(E.ACCOUNTS,1)  AS DECIMAL(13, 2) ) ELSE 0 END) AS MON09,
					 (CASE WHEN SUBSTR(A.MAKE_MM, 5, 2) = '10' THEN CAST(A.MR_NETWR * VALUE(E.ACCOUNTS,1)  AS DECIMAL(13, 2) ) ELSE 0 END) AS MON10,
					 (CASE WHEN SUBSTR(A.MAKE_MM, 5, 2) = '11' THEN CAST(A.MR_NETWR * VALUE(E.ACCOUNTS,1)  AS DECIMAL(13, 2) ) ELSE 0 END) AS MON11,
					 (CASE WHEN SUBSTR(A.MAKE_MM, 5, 2) = '12' THEN CAST(A.MR_NETWR * VALUE(E.ACCOUNTS,1)  AS DECIMAL(13, 2) ) ELSE 0 END) AS MON12
		  FROM SAPHEE.ZSDTW008 AS A
		  LEFT OUTER JOIN SAPHEE.ZCURRCHG AS E
            ON A.MANDT  = E.MANDT
          AND A.WAERK  = E.WAERK 
		WHERE A.MANDT = #G_MANDT#
              <isNotNull col="MAKF_DT">
		      AND SUBSTR(A.MAKE_MM, 1, 4) = SUBSTR(#MAKF_DT#,1,4) 
             </isNotNull>
                            	

	    UNION ALL
		
		SELECT A.MANDT, '' AS GBN1,  '' AS GBN2, '' AS GBN3, ''AS MPLAN, '' AS ACHIEVE,DEPARTMENT AS VKBUR, A.MAKE_MM, --디자인연구소 
		             (CASE WHEN SUBSTR(A.MAKE_MM, 5, 2) = '01' THEN CAST(A.MR_NETWR * VALUE(E.ACCOUNTS,1)  AS DECIMAL(13, 2) ) ELSE 0 END) AS MON01,
					 (CASE WHEN SUBSTR(A.MAKE_MM, 5, 2) = '02' THEN CAST(A.MR_NETWR * VALUE(E.ACCOUNTS,1)  AS DECIMAL(13, 2) ) ELSE 0 END) AS MON02,
					 (CASE WHEN SUBSTR(A.MAKE_MM, 5, 2) = '03' THEN CAST(A.MR_NETWR * VALUE(E.ACCOUNTS,1)  AS DECIMAL(13, 2) ) ELSE 0 END) AS MON03,
					 (CASE WHEN SUBSTR(A.MAKE_MM, 5, 2) = '04' THEN CAST(A.MR_NETWR * VALUE(E.ACCOUNTS,1)  AS DECIMAL(13, 2) ) ELSE 0 END) AS MON04,
					 (CASE WHEN SUBSTR(A.MAKE_MM, 5, 2) = '05' THEN CAST(A.MR_NETWR * VALUE(E.ACCOUNTS,1)  AS DECIMAL(13, 2) ) ELSE 0 END) AS MON05,
					 (CASE WHEN SUBSTR(A.MAKE_MM, 5, 2) = '06' THEN CAST(A.MR_NETWR * VALUE(E.ACCOUNTS,1)  AS DECIMAL(13, 2) ) ELSE 0 END) AS MON06,
					 (CASE WHEN SUBSTR(A.MAKE_MM, 5, 2) = '07' THEN CAST(A.MR_NETWR * VALUE(E.ACCOUNTS,1)  AS DECIMAL(13, 2) ) ELSE 0 END) AS MON07,
					 (CASE WHEN SUBSTR(A.MAKE_MM, 5, 2) = '08' THEN CAST(A.MR_NETWR * VALUE(E.ACCOUNTS,1)  AS DECIMAL(13, 2) ) ELSE 0 END) AS MON08,
					 (CASE WHEN SUBSTR(A.MAKE_MM, 5, 2) = '09' THEN CAST(A.MR_NETWR * VALUE(E.ACCOUNTS,1)  AS DECIMAL(13, 2) ) ELSE 0 END) AS MON09,
					 (CASE WHEN SUBSTR(A.MAKE_MM, 5, 2) = '10' THEN CAST(A.MR_NETWR * VALUE(E.ACCOUNTS,1)  AS DECIMAL(13, 2) ) ELSE 0 END) AS MON10,
					 (CASE WHEN SUBSTR(A.MAKE_MM, 5, 2) = '11' THEN CAST(A.MR_NETWR * VALUE(E.ACCOUNTS,1)  AS DECIMAL(13, 2) ) ELSE 0 END) AS MON11,
					 (CASE WHEN SUBSTR(A.MAKE_MM, 5, 2) = '12' THEN CAST(A.MR_NETWR * VALUE(E.ACCOUNTS,1)  AS DECIMAL(13, 2) ) ELSE 0 END) AS MON12
		  FROM SAPHEE.ZSDTW017 AS A
		  LEFT OUTER JOIN SAPHEE.ZCURRCHG AS E
            ON A.MANDT  = E.MANDT
          AND A.WAERK  = E.WAERK 
		WHERE A.MANDT = #G_MANDT#
              <isNotNull col="MAKF_DT">
		      AND SUBSTR(A.MAKE_MM, 1, 4) = SUBSTR(#MAKF_DT#,1,4) 
             </isNotNull>
                            	
                                          		 
	) AS T1
	
	
GROUP BY T1.MANDT, T1.GBN2, T1.GBN3, T1.VKBUR, T1.MPLAN,T1.ACHIEVE, SUBSTR(T1.MAKE_MM,1,4)
) AS T2
	LEFT OUTER JOIN SAPHEE.ZSDTW010 T3 ON T3.MANDT = #G_MANDT#
		                              AND T3.MAKE_Y = T2. MAKE_Y
	                                  AND T3.VKBUR = T2.VKBUR	
									  
) AS T3

GROUP BY  T3.MANDT, T3.DTP, T3.GBN1, T3.GBN2 ,T3.GBN3, T3.VKBUR, T3.MPLAN, T3.ACHIEVE,  MON01,  MON02, MON03, MON04,           
			        MON05,  MON06,  MON07,  MON08, MON09,  MON10,  MON11, MON12


ORDER BY T3.GBN1, T3.ACHIEVE	</statement>
	<input default-name="ds_cond">
	</input>
	<output default-name="ds_list">
	</output>
</query>
