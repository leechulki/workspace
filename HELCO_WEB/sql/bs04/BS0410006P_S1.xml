<?xml version="1.0" encoding="euc-kr"?>
<query dynamic="true">
	<type>select</type>
	<description><![CDATA[]]></description>
	<reload>true</reload>
	<monitoring>true</monitoring>
	<result-count>0</result-count>
	<statement>
SELECT  MAX(T4.GUBUN1) AS GUBUN1,
              MAX(T4.A) AS A,
			  MAX(T4.B) AS B,
              MAX(T4.C) AS C,
  		      MAX(T4.D) AS D,
			  MAX(T4.E) AS E,
			  MAX(T4.F) AS F,
			  MAX(T4.G) AS G,
		      MAX(T4.A1) AS A1,
			  MAX(T4.B1) AS B1,
              MAX(T4.C1) AS C1,
  		      MAX(T4.D1) AS D1,
			  MAX(T4.E1) AS E1,
			  MAX(T4.F1) AS F1,
			  MAX(T4.G1) AS G1,
		      MAX(T4.A2) AS A2,
			  MAX(T4.B2) AS B2,
              MAX(T4.C2) AS C2,
  		      MAX(T4.D2) AS D2,
			  MAX(T4.E2) AS E2,
			  MAX(T4.F2) AS F2,
			  MAX(T4.G2) AS G2,
			  MAX(T4.A3) AS A3,
			  MAX(T4.B3) AS B3,
              MAX(T4.C3) AS C3,
  		      MAX(T4.D3) AS D3,
			  MAX(T4.E3) AS E3,
			  MAX(T4.F3) AS F3,
			  MAX(T4.G3) AS G3,
			  MAX(T4.A4) AS A4,
			  MAX(T4.B4) AS B4,
              MAX(T4.C4) AS C4,
  		      MAX(T4.D4) AS D4,
			  MAX(T4.E4) AS E4,
			  MAX(T4.F4) AS F4,
			  MAX(T4.G4) AS G4,
			  MAX(T4.A5) AS A5,
			  MAX(T4.B5) AS B5,
              MAX(T4.C5) AS C5,
  		      MAX(T4.D5) AS D5,
			  MAX(T4.E5) AS E5,
			  MAX(T4.F5) AS F5,
			  MAX(T4.G5) AS G5
			
			   

              

FROM
(SELECT GUBUN1,
             (CASE WHEN T3.GUBUN1 = 'A' THEN  T3.NETWR
			   ELSE 0 END  ) AS A,
			 (CASE WHEN T3.GUBUN1 = 'B' THEN  T3.NETWR
			   ELSE 0 END  ) AS B,
			 (CASE WHEN T3.GUBUN1 = 'C' THEN  T3.NETWR
			   ELSE 0 END  ) AS C,
			  (CASE WHEN T3.GUBUN1 = 'D' THEN  T3.NETWR
			   ELSE 0 END  ) AS D,
			  (CASE WHEN T3.GUBUN1 = 'E' THEN  T3.NETWR
			   ELSE 0 END  ) AS E,
			  (CASE WHEN T3.GUBUN1 = 'F' THEN  T3.NETWR
			    ELSE 0 END  ) AS F,
			  (CASE WHEN T3.GUBUN1 = 'G' THEN  T3.NETWR
			   ELSE 0 END  ) AS G,
			  (CASE WHEN T3.GUBUN1 = 'A1' THEN  T3.NETWR
			   ELSE 0 END  ) AS A1,
			  (CASE WHEN T3.GUBUN1 = 'B1' THEN  T3.NETWR
			   ELSE 0 END  ) AS B1,
			  (CASE WHEN T3.GUBUN1 = 'C1' THEN  T3.NETWR
			   ELSE 0 END  ) AS C1,
			  (CASE WHEN T3.GUBUN1 = 'D1' THEN  T3.NETWR
			  ELSE 0 END  ) AS D1,
			  (CASE WHEN T3.GUBUN1 = 'E1' THEN  T3.NETWR
			   ELSE 0 END  ) AS E1,
			  (CASE WHEN T3.GUBUN1 = 'F1' THEN  T3.NETWR
			   ELSE 0 END  ) AS F1,
			  (CASE WHEN T3.GUBUN1 = 'G1' THEN  T3.NETWR
			   ELSE 0 END  ) AS G1,
			  (CASE WHEN T3.GUBUN1 = 'A2' THEN  T3.NETWR
			   ELSE 0 END  ) AS A2,
			  (CASE WHEN T3.GUBUN1 = 'B2' THEN  T3.NETWR
			   ELSE 0 END  ) AS B2,
			  (CASE WHEN T3.GUBUN1 = 'C2' THEN  T3.NETWR
			  ELSE 0 END  ) AS C2,
			  (CASE WHEN T3.GUBUN1 = 'D2' THEN  T3.NETWR
			   ELSE 0 END  ) AS D2,
			  (CASE WHEN T3.GUBUN1 = 'E2' THEN  T3.NETWR
			   ELSE 0 END  ) AS E2,
			  (CASE WHEN T3.GUBUN1 = 'F2' THEN  T3.NETWR
			   ELSE 0 END  ) AS F2,
			  (CASE WHEN T3.GUBUN1 = 'G2' THEN  T3.NETWR
			   ELSE 0 END  ) AS G2,
			    (CASE WHEN T3.GUBUN1 = 'A3' THEN  T3.NETWR
			  ELSE 0 END  ) AS A3,
			  (CASE WHEN T3.GUBUN1 = 'B3' THEN  T3.NETWR
			   ELSE 0 END  ) AS B3,
			  (CASE WHEN T3.GUBUN1 = 'C3' THEN  T3.NETWR
			   ELSE 0 END  ) AS C3,
			  (CASE WHEN T3.GUBUN1 = 'D3' THEN  T3.NETWR
			   ELSE 0 END  ) AS D3,
			  (CASE WHEN T3.GUBUN1 = 'E3' THEN  T3.NETWR
			   ELSE 0 END  ) AS E3,
			  (CASE WHEN T3.GUBUN1 = 'F3' THEN  T3.NETWR
			  ELSE 0 END  ) AS F3,
			  (CASE WHEN T3.GUBUN1 = 'G3' THEN  T3.NETWR
			   ELSE 0 END  ) AS G3,
			  (CASE WHEN T3.GUBUN1 = 'A4' THEN  T3.NETWR
			   ELSE 0 END  ) AS A4,
			  (CASE WHEN T3.GUBUN1 = 'B4' THEN  T3.NETWR
			   ELSE 0 END  ) AS B4,
			  (CASE WHEN T3.GUBUN1 = 'C4' THEN  T3.NETWR
			   ELSE 0 END  ) AS C4,
			  (CASE WHEN T3.GUBUN1 = 'D4' THEN  T3.NETWR
			   ELSE 0 END  ) AS D4,
			  (CASE WHEN T3.GUBUN1 = 'E4' THEN  T3.NETWR
			  ELSE 0 END  ) AS E4,
			  (CASE WHEN T3.GUBUN1 = 'F4' THEN  T3.NETWR
			  ELSE 0 END  ) AS F4,
			  (CASE WHEN T3.GUBUN1 = 'G4' THEN  T3.NETWR
			   ELSE 0 END  ) AS G4,
			  (CASE WHEN T3.GUBUN1 = 'A5' THEN  T3.NETWR
			   ELSE 0 END  ) AS A5,
			  (CASE WHEN T3.GUBUN1 = 'B5' THEN  T3.NETWR
			  ELSE 0 END  ) AS B5,
			  (CASE WHEN T3.GUBUN1 = 'C5' THEN  T3.NETWR
			  ELSE 0 END  ) AS C5,
			  (CASE WHEN T3.GUBUN1 = 'D5' THEN  T3.NETWR
			  ELSE 0 END  ) AS D5,
			  (CASE WHEN T3.GUBUN1 = 'E5' THEN  T3.NETWR
			  ELSE 0 END  ) AS E5,
			  (CASE WHEN T3.GUBUN1 = 'F5' THEN  T3.NETWR
			  ELSE 0 END  ) AS F5,
			  (CASE WHEN T3.GUBUN1 = 'G5' THEN  T3.NETWR
			  ELSE 0 END  ) AS G5
			  

			  

FROM
(SELECT MAX(GUBUN1) AS GUBUN1,
            '' AS GBN2,

            ROUND(SUM(T2.NETWR)/1000000,0) AS NETWR

FROM
(SELECT 
             ( CASE WHEN T1.TYPE = 'B' AND T1.ACTION = 'A' THEN 'A'
			             WHEN T1.TYPE = 'C' AND T1.ACTION = 'A' THEN 'B'
						 WHEN T1.TYPE = 'A' AND T1.ACTION = 'A' THEN 'C'
						 WHEN T1.TYPE = 'D' AND T1.ACTION = 'A' THEN 'D'
						 WHEN T1.TYPE = 'E' AND T1.ACTION = 'A' THEN 'E'
					     WHEN T1.TYPE = 'F' AND T1.ACTION = 'A' THEN 'F'
						 WHEN T1.TYPE = 'G' AND T1.ACTION = 'A' THEN 'G'

						 WHEN T1.TYPE = 'B' AND T1.ACTION = 'B' THEN 'A1'
			             WHEN T1.TYPE = 'C' AND T1.ACTION = 'B' THEN 'B1'
						 WHEN T1.TYPE = 'A' AND T1.ACTION = 'B' THEN 'C1'
						 WHEN T1.TYPE = 'D' AND T1.ACTION = 'B' THEN 'D1'
						 WHEN T1.TYPE = 'E' AND T1.ACTION = 'B' THEN 'E1'
					     WHEN T1.TYPE = 'F' AND T1.ACTION = 'B' THEN 'F1'
						 WHEN T1.TYPE = 'G' AND T1.ACTION = 'B' THEN 'G1'
						 
						 WHEN T1.TYPE = 'B' AND T1.ACTION = 'C' THEN 'A2'
			             WHEN T1.TYPE = 'C' AND T1.ACTION = 'C' THEN 'B2'
						 WHEN T1.TYPE = 'A' AND T1.ACTION = 'C' THEN 'C2'
						 WHEN T1.TYPE = 'D' AND T1.ACTION = 'C' THEN 'D2'
						 WHEN T1.TYPE = 'E' AND T1.ACTION = 'C' THEN 'E2'
					     WHEN T1.TYPE = 'F' AND T1.ACTION = 'C' THEN 'F2'
						 WHEN T1.TYPE = 'G' AND T1.ACTION = 'C' THEN 'G2'
						 
						 WHEN T1.TYPE = 'B' AND T1.ACTION = 'D' THEN 'A3'
			             WHEN T1.TYPE = 'C' AND T1.ACTION = 'D' THEN 'B3'
						 WHEN T1.TYPE = 'A' AND T1.ACTION = 'D' THEN 'C3'
						 WHEN T1.TYPE = 'D' AND T1.ACTION = 'D' THEN 'D3'
						 WHEN T1.TYPE = 'E' AND T1.ACTION = 'D' THEN 'E3'
					     WHEN T1.TYPE = 'F' AND T1.ACTION = 'D' THEN 'F3'
						 WHEN T1.TYPE = 'G' AND T1.ACTION = 'D' THEN 'G4'
						 
						 WHEN T1.TYPE = 'B' AND T1.ACTION = 'E' THEN 'A4'
			             WHEN T1.TYPE = 'C' AND T1.ACTION = 'E' THEN 'B4'
						 WHEN T1.TYPE = 'A' AND T1.ACTION = 'E' THEN 'C4'
						 WHEN T1.TYPE = 'D' AND T1.ACTION = 'E' THEN 'D4'
						 WHEN T1.TYPE = 'E' AND T1.ACTION = 'E' THEN 'E4'
					     WHEN T1.TYPE = 'F' AND T1.ACTION = 'E' THEN 'F4'
						 WHEN T1.TYPE = 'G' AND T1.ACTION = 'E' THEN 'G4'
						 
						 WHEN T1.TYPE = 'B' AND T1.ACTION = 'F' THEN 'A5'
			             WHEN T1.TYPE = 'C' AND T1.ACTION = 'F' THEN 'B5'
						 WHEN T1.TYPE = 'A' AND T1.ACTION = 'F' THEN 'C5'
						 WHEN T1.TYPE = 'D' AND T1.ACTION = 'F' THEN 'D5'
						 WHEN T1.TYPE = 'E' AND T1.ACTION = 'F' THEN 'E5'
					     WHEN T1.TYPE = 'F' AND T1.ACTION = 'F' THEN 'F5'
						 WHEN T1.TYPE = 'G' AND T1.ACTION = 'F' THEN 'G5'
						 
					
						 
						 END ) AS GUBUN1,
						 '' AS GBN2,
						 T1.NETWR AS NETWR
						 
						 			

FROM
(SELECT A.MANDT,
             A.TYPE,
              A.ACTION, 
			  ''AS GNB1,
			  '' AS GBN2,
CAST(A.MR_NETWR * VALUE(E.ACCOUNTS,1)  AS DECIMAL(13, 2) )  AS  NETWR 
  FROM SAPHEE.ZSDTW008 AS A
    LEFT OUTER JOIN SAPHEE.ZCURRCHG AS E
                  ON A.MANDT  = E.MANDT
                 AND A.WAERK  = E.WAERK 
WHERE A.MANDT = #G_MANDT#
		     <isNotNull col="MAKF_DT">
		     AND SUBSTR(A.MAKE_MM, 1, 4) = SUBSTR(#MAKF_DT#,1,4) 
             </isNotNull>

UNION ALL
SELECT A.MANDT,
             A.TYPE,
              A.ACTION,
			  ''AS GNB1,
			  '' AS GBN2,
CAST(A.MR_NETWR * VALUE(E.ACCOUNTS,1)  AS DECIMAL(13, 2) )  AS  NETWR 
  FROM SAPHEE.ZSDTW006 AS A
    LEFT OUTER JOIN SAPHEE.ZCURRCHG AS E
                  ON A.MANDT  = E.MANDT
                 AND A.WAERK  = E.WAERK 
 WHERE A.MANDT = #G_MANDT#
		     <isNotNull col="MAKF_DT">
		     AND SUBSTR(A.MAKE_MM, 1, 4) = SUBSTR(#MAKF_DT#,1,4) 
             </isNotNull>
UNION ALL

SELECT A.MANDT,
             A.TYPE,
              A.ACTION,
			  ''AS GNB1,
			  '' AS GBN2,
CAST(A.MR_NETWR * VALUE(E.ACCOUNTS,1)  AS DECIMAL(13, 2) )  AS  NETWR 
  FROM SAPHEE.ZSDTW001 AS A
    LEFT OUTER JOIN SAPHEE.ZCURRCHG AS E
                  ON A.MANDT  = E.MANDT
                 AND A.WAERK  = E.WAERK 
WHERE A.MANDT = #G_MANDT#
		     <isNotNull col="MAKF_DT">
		     AND SUBSTR(A.MAKE_MM, 1, 4) = SUBSTR(#MAKF_DT#,1,4) 
             </isNotNull>
			 
 UNION ALL
 
 SELECT A.MANDT,
             A.TYPE,
              A.ACTION,
			  ''AS GNB1,
			  '' AS GBN2,
CAST(A.MR_NETWR * VALUE(E.ACCOUNTS,1)  AS DECIMAL(13, 2) )  AS  NETWR 
  FROM SAPHEE.ZSDTW031 AS A
    LEFT OUTER JOIN SAPHEE.ZCURRCHG AS E
                  ON A.MANDT  = E.MANDT
                 AND A.WAERK  = E.WAERK 
WHERE A.MANDT = #G_MANDT#
		     <isNotNull col="MAKF_DT">
		     AND SUBSTR(A.MAKE_MM, 1, 4) = SUBSTR(#MAKF_DT#,1,4) 
             </isNotNull>

 
 UNION ALL
 
 SELECT A.MANDT,
             A.TYPE,
              A.ACTION,
			  ''AS GNB1,
			  '' AS GBN2,
CAST(A.MR_NETWR_T * VALUE(E.ACCOUNTS,1)  AS DECIMAL(13, 2) )  AS  NETWR 
  FROM SAPHEE.ZSDTW041 AS A
    LEFT OUTER JOIN SAPHEE.ZCURRCHG AS E
                  ON A.MANDT  = E.MANDT
                 AND A.WAERK  = E.WAERK 
 WHERE A.MANDT = #G_MANDT#
		     <isNotNull col="MAKF_DT">
		     AND SUBSTR(A.MAKE_MM, 1, 4) = SUBSTR(#MAKF_DT#,1,4) 
             </isNotNull>
 
 UNION ALL
 
 SELECT A.MANDT,
             A.TYPE,
              A.ACTION,
			  ''AS GNB1,
			  '' AS GBN2,
CAST(A.MR_NETWR_T * VALUE(E.ACCOUNTS,1)  AS DECIMAL(13, 2) )  AS  NETWR 
  FROM SAPHEE.ZPSTW0401 AS A
    LEFT OUTER JOIN SAPHEE.ZCURRCHG AS E
                  ON A.MANDT  = E.MANDT
                 AND A.WAERK  = E.WAERK 
WHERE A.MANDT = #G_MANDT#
		     <isNotNull col="MAKF_DT">
		     AND SUBSTR(A.MAKE_MM, 1, 4) = SUBSTR(#MAKF_DT#,1,4) 
             </isNotNull>

)	AS T1
			  
) AS T2
where GUBUN1  is not null		  

GROUP BY GUBUN1
) AS T3	
) AS T4
			  
			  
	
			  

			  
	
			  
	</statement>
	<input default-name="ds_cond">
	</input>
	<output default-name="ds_list_p2">
	</output>
</query>
