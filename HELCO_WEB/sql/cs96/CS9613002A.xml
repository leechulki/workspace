<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="562" Id="CS9613002A" Left="8" OnLoadCompleted="fn_OnLoadCompleted" OnUnloadCompleted="fn_OnUnloadCompleted" PidAttrib="7" Title="시행율&#32;관리" Top="8" Ver="1.0" Width="978" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_cond">
				<Contents>
					<colinfo id="ZYEAR" size="256" summ="default" type="STRING"/>
					<record>
						<ZYEAR></ZYEAR>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_year">
				<Contents>
					<colinfo id="ZYEAR" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_nmb">
				<Contents>
					<colinfo id="ZYEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="VKBUR" size="256" summ="default" type="STRING"/>
					<colinfo id="VKGRP" size="256" summ="default" type="STRING"/>
					<colinfo id="CTEXT2" size="256" summ="default" type="STRING"/>
					<colinfo id="M_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="J_RAT" size="256" summ="default" type="DECIMAL"/>
					<colinfo id="H_RAT" size="256" summ="default" type="DECIMAL"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_dipbx2ex">
				<Contents>
					<colinfo id="ZYEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="GUBUN" size="256" summ="default" type="STRING"/>
					<colinfo id="AMT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_gsb">
				<Contents>
					<colinfo id="ZYEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="GUBUN" size="256" summ="default" type="STRING"/>
					<colinfo id="GUBUNNM" size="256" summ="default" type="STRING"/>
					<colinfo id="FLR" size="256" summ="default" type="STRING"/>
					<colinfo id="COMMI" size="256" summ="default" type="STRING"/>
					<colinfo id="INCRE" size="256" summ="default" type="STRING"/>
					<colinfo id="FLRNM" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_spd">
				<Contents>
					<colinfo id="ZYEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="GUBUN" size="256" summ="default" type="STRING"/>
					<colinfo id="RAT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_mpr">
				<Contents>
					<colinfo id="ZYEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="GUBUN" size="256" summ="default" type="STRING"/>
					<colinfo id="GUBUNNM" size="256" summ="default" type="STRING"/>
					<colinfo id="RAT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_rop">
				<Contents>
					<colinfo id="ZYEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="GUBUN" size="256" summ="default" type="STRING"/>
					<colinfo id="GUBUNNM" size="256" summ="default" type="STRING"/>
					<colinfo id="TIME" size="256" summ="default" type="STRING"/>
					<colinfo id="MAN" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_cnt">
				<Contents>
					<colinfo id="C500" size="256" summ="default" type="STRING"/>
					<colinfo id="C501" size="256" summ="default" type="STRING"/>
					<colinfo id="C502" size="256" summ="default" type="STRING"/>
					<colinfo id="C503" size="256" summ="default" type="STRING"/>
					<colinfo id="C504" size="256" summ="default" type="STRING"/>
					<colinfo id="C505" size="256" summ="default" type="STRING"/>
					<colinfo id="C506" size="256" summ="default" type="STRING"/>
					<colinfo id="C507" size="256" summ="default" type="STRING"/>
					<colinfo id="C600" size="256" summ="default" type="STRING"/>
					<colinfo id="C601" size="256" summ="default" type="STRING"/>
					<colinfo id="C602" size="256" summ="default" type="STRING"/>
					<colinfo id="C603" size="256" summ="default" type="STRING"/>
					<colinfo id="C604" size="256" summ="default" type="STRING"/>
					<colinfo id="C605" size="256" summ="default" type="STRING"/>
					<colinfo id="C606" size="256" summ="default" type="STRING"/>
					<colinfo id="C607" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_wrk">
				<Contents>
					<colinfo id="CS600_YEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="CS600_RAT" size="256" summ="default" type="STRING"/>
					<colinfo id="CS600_RAT2" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_mat">
				<Contents>
					<colinfo id="CS606_YEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="CS606_SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="CS606_APT" size="256" summ="default" type="STRING"/>
					<colinfo id="CS606_CVN" size="256" summ="default" type="STRING"/>
					<colinfo id="CS606_MLT" size="256" summ="default" type="STRING"/>
					<colinfo id="CS606_ETC" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_hrtsmat">
				<Contents>
					<colinfo id="CS601_YEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="CS601_TYP" size="256" summ="default" type="STRING"/>
					<colinfo id="CS601_TYPNM" size="256" summ="default" type="STRING"/>
					<colinfo id="CS601_CRT" size="256" summ="default" type="STRING"/>
					<colinfo id="CS601_JAMT" size="256" summ="default" type="STRING"/>
					<colinfo id="CS601_TAMT" size="256" summ="default" type="STRING"/>
					<colinfo id="CS601_RAT" size="256" summ="default" type="STRING"/>
					<colinfo id="CS601_CNT_A" size="256" summ="default" type="STRING"/>
					<colinfo id="CS601_AMT_A" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_dipbx">
				<Contents>
					<colinfo id="CS602_YEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="CS602_TYP" size="256" summ="default" type="STRING"/>
					<colinfo id="CS602_TYPNM" size="256" summ="default" type="STRING"/>
					<colinfo id="CS602_DAMT" size="256" summ="default" type="STRING"/>
					<colinfo id="CS602_LP" size="256" summ="default" type="STRING"/>
					<colinfo id="CS602_CP" size="256" summ="default" type="STRING"/>
					<colinfo id="CS602_KEY" size="256" summ="default" type="STRING"/>
					<colinfo id="CS602_JAMT_O" size="256" summ="default" type="STRING"/>
					<colinfo id="CS602_MH" size="256" summ="default" type="STRING"/>
					<colinfo id="CS602_JAMT" size="256" summ="default" type="STRING"/>
					<colinfo id="CS602_TAMT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_inc">
				<Contents>
					<colinfo id="CS605_YEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="CS605_INTV" size="256" summ="default" type="STRING"/>
					<colinfo id="CS605_RAT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ind">
				<Contents>
					<colinfo id="CS604_YEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="CS604_US" size="256" summ="default" type="STRING"/>
					<colinfo id="CS604_NS" size="256" summ="default" type="STRING"/>
					<colinfo id="CS604_NB" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
		</Datasets>
		<Shape BKColor="user0" Bottom="30" Height="30" Id="Shape0" Left="0" LineColor="user1" Right="978" TabOrder="1" Top="0" Type="Rectangle" Width="978"></Shape>
		<Static Align="Right" Height="20" Id="st_dat" Left="9" Style="sty_lb_search" TabOrder="2" Text="기준&#32;년" Top="5" VAlign="Middle" Width="80"></Static>
		<Combo Border="Flat" CodeColumn="ZYEAR" DataColumn="ZYEAR" DisableBKColor="user5" Height="20" Id="cb_year" InnerDataset="ds_year" Left="90" OnChanged="cb_year_OnChanged" Style="sty_ipt_search" TabOrder="3" Top="4" Width="75"></Combo>
		<Tab Border="Flat" Font="굴림,9" Height="510" Id="tab_main" Left="8" MouseOverColor="user16" OnChanged="tab00_OnChanged" SelColor="user15" SelectFont="굴림,9" Style="sty_tab" TabOrder="4" Top="40" Width="960">
			<Contents>
				<TabPage BorderColor="black" Height="484" Id="tab1" ImageID="tab_form_09" Left="2" TabOrder="1" Text="노무비" Top="24" Width="956">
					<Grid AutoEnter="TRUE" AutoFitEndLine="Hide" AutoScrollBar="Vert" BindDataset="ds_nmb" BkColor2="default" BoldHead="true" Border="Flat" Bottom="477" CellMoving="TRUE" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="470" Id="grd_nmb" InputPanel="FALSE" Left="7" LineColor="user20" LineType="ExHORZ" OnCellDBLClick="grd_list_OnCellDblClick" OnExpandEdit="grd_list_OnExpandEdit" OnHeadClick="grd_list_OnHeadClick" Right="612" RowHeight="20" Style="sty_grid" TabOrder="1" TabStop="true" Top="7" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="605">
						<contents>
							<format id="Default">
								<columns>
									<col width="26"/>
									<col width="192"/>
									<col width="145"/>
									<col width="110"/>
									<col width="114"/>
								</columns>
								<head>
									<cell col="0" display="text" font="굴림,9" text="No"/>
									<cell align="center" col="1" display="text" font="굴림,9" text="지사명"/>
									<cell col="2" display="text" font="굴림,9" text="직영임율"/>
									<cell col="3" display="text" font="굴림,9" text="직영배부경비(%)"/>
									<cell col="4" display="text" font="굴림,9" text="협력배부경비(%)"/>
								</head>
								<body>
									<cell align="center" bkcolor="user22" col="0" display="text" expr="currow+1"/>
									<cell align="center" bkcolor="user22" celltype="body" col="1" colid="CTEXT2" display="text"/>
									<cell align="right" col="2" colid="M_AMT" display="currency" edit="number" limit="6"/>
									<cell align="right" col="3" colid="J_RAT" display="number" edit="number" limit="3" LimitDec="1" Mask="###.#%"/>
									<cell align="right" col="4" colid="H_RAT" display="number" edit="number" limit="3" LimitDec="1" Mask="###.#%"/>
								</body>
							</format>
						</contents>
					</Grid>
				</TabPage>
				<TabPage BorderColor="black" Height="484" Id="tab2" ImageID="tab_form_09" Left="2" TabOrder="2" Text="재료비" Top="24" Width="956">
					<Grid AutoEnter="TRUE" AutoFitEndLine="Hide" AutoScrollBar="Vert" BindDataset="ds_mat" BkColor2="default" BoldHead="true" Border="Flat" Bottom="312" CellMoving="TRUE" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="280" Id="grd_mat" InputPanel="FALSE" Left="7" LineColor="user20" LineType="ExHORZ" OnCellDBLClick="grd_list_OnCellDblClick" OnExpandEdit="grd_list_OnExpandEdit" OnHeadClick="grd_list_OnHeadClick" Right="346" RowHeight="20" Style="sty_grid" TabOrder="1" TabStop="true" Top="32" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="339">
						<contents>
							<format id="Default">
								<columns>
									<col width="35"/>
									<col width="72"/>
									<col width="72"/>
									<col width="72"/>
									<col width="72"/>
								</columns>
								<head>
									<cell col="0" display="text" font="굴림,9" text="연차"/>
									<cell col="1" display="text" font="굴림,9" text="아파트"/>
									<cell col="2" display="text" font="굴림,9" text="근린생활"/>
									<cell col="3" display="text" font="굴림,9" text="주상복합"/>
									<cell col="4" display="text" font="굴림,9" text="기타"/>
								</head>
								<body>
									<cell align="center" bkcolor2="user22" col="0" colid="CS606_SEQ" display="text"/>
									<cell align="right" bkcolor2="user22" col="1" colid="CS606_APT" display="currency" edit="number" limit="6"/>
									<cell align="right" col="2" colid="CS606_CVN" display="currency" edit="number" limit="6"/>
									<cell align="right" bkcolor2="user22" col="3" colid="CS606_MLT" display="currency" edit="number" limit="6"/>
									<cell align="right" bkcolor2="user22" col="4" colid="CS606_ETC" display="currency" edit="number" limit="6"/>
								</body>
							</format>
						</contents>
					</Grid>
					<Static Color="user6" Height="11" Id="Static3" Left="7" TabOrder="2" Text="DI-PBX&#32;자재비" Top="336" Width="83"></Static>
					<Grid AutoEnter="TRUE" AutoFitEndLine="Hide" AutoScrollBar="None" BindDataset="ds_dipbx" BkColor2="default" BoldHead="true" Border="Flat" Bottom="452" CellMoving="TRUE" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="100" Id="grd_dipbx" InputPanel="FALSE" Left="7" LineColor="user20" LineType="ExHORZ" OnCellDBLClick="grd_list_OnCellDblClick" OnExpandEdit="grd_list_OnExpandEdit" OnHeadClick="grd_list_OnHeadClick" Right="789" RowHeight="20" Style="sty_grid" TabOrder="3" TabStop="true" Top="352" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="782">
						<contents>
							<format id="Default">
								<columns>
									<col width="142"/>
									<col width="80"/>
									<col width="80"/>
									<col width="80"/>
									<col width="80"/>
									<col width="80"/>
									<col width="80"/>
									<col width="80"/>
									<col width="80"/>
								</columns>
								<head>
									<cell col="0" display="text" font="굴림,9" text="상품"/>
									<cell col="1" display="text" font="굴림,9" text="단말기대금"/>
									<cell col="2" display="text" font="굴림,9" text="LP-OPB"/>
									<cell col="3" display="text" font="굴림,9" text="CP"/>
									<cell col="4" display="text" font="굴림,9" text="Key"/>
									<cell col="5" display="text" font="굴림,9" text="잡자재비"/>
									<cell col="6" display="text" font="굴림,9" text="설치&#32;M/H"/>
									<cell col="7" display="text" font="굴림,9" text="자재비"/>
									<cell col="8" display="text" font="굴림,9" text="통신비"/>
								</head>
								<body>
									<cell align="center" bkcolor2="user22" col="0" colid="CS602_TYPNM" display="text"/>
									<cell align="right" bkcolor2="user22" col="1" colid="CS602_DAMT" display="currency" edit="number" limit="7"/>
									<cell align="right" col="2" colid="CS602_LP" display="currency" edit="number" limit="7"/>
									<cell align="right" bkcolor2="user22" col="3" colid="CS602_CP" display="currency" edit="number" limit="7"/>
									<cell align="right" bkcolor2="user22" col="4" colid="CS602_KEY" display="currency" edit="number" limit="7"/>
									<cell align="right" bkcolor2="user22" col="5" colid="CS602_JAMT_O" display="currency" edit="number" limit="7"/>
									<cell align="right" bkcolor2="user22" col="6" colid="CS602_MH" display="number" edit="number" limit="2"/>
									<cell align="right" bkcolor2="user22" col="7" colid="CS602_JAMT" display="currency" edit="number" limit="7"/>
									<cell align="right" bkcolor2="user22" col="8" colid="CS602_TAMT" display="currency" edit="number" limit="7"/>
								</body>
							</format>
						</contents>
					</Grid>
					<Grid AutoEnter="TRUE" AutoFitEndLine="Hide" AutoScrollBar="None" BindDataset="ds_hrtsmat" BkColor2="default" BoldHead="true" Border="Flat" Bottom="113" CellMoving="TRUE" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="80" Id="grd_hrtsmat" InputPanel="FALSE" Left="357" LineColor="user20" LineType="ExHORZ" OnCellDBLClick="grd_list_OnCellDblClick" OnExpandEdit="grd_list_OnExpandEdit" OnHeadClick="grd_list_OnHeadClick" Right="788" RowHeight="20" Style="sty_grid" TabOrder="4" TabStop="true" Top="33" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="431">
						<contents>
							<format id="Default">
								<columns>
									<col width="70"/>
									<col width="40"/>
									<col width="70"/>
									<col width="65"/>
									<col width="65"/>
									<col width="55"/>
									<col width="65"/>
								</columns>
								<head>
									<cell col="0" display="text" font="굴림,9" text="구분"/>
									<cell col="1" display="text" font="굴림,9" text="CRT"/>
									<cell col="2" display="text" font="굴림,9" text="자재비"/>
									<cell col="3" display="text" font="굴림,9" text="통신비"/>
									<cell col="4" display="text" font="굴림,9" text="요율"/>
									<cell col="5" display="text" font="굴림,10" text="추가대수"/>
									<cell col="6" display="text" font="굴림,10" text="추가금액"/>
								</head>
								<body>
									<cell align="center" bkcolor2="user22" col="0" colid="CS601_TYPNM" display="text"/>
									<cell align="center" bkcolor2="user22" col="1" colid="CS601_CRT" display="text"/>
									<cell align="right" col="2" colid="CS601_JAMT" display="currency" edit="number" limit="8"/>
									<cell align="right" bkcolor2="user22" col="3" colid="CS601_TAMT" display="currency" edit="number" limit="6"/>
									<cell align="right" col="4" colid="CS601_RAT" display="currency" edit="number" limit="7"/>
									<cell align="right" col="5" colid="CS601_CNT_A" display="number" edit="number" limit="3"/>
									<cell align="right" col="6" colid="CS601_AMT_A" display="currency" edit="number" limit="7"/>
								</body>
							</format>
						</contents>
					</Grid>
					<Static Color="user6" Height="11" Id="Static0" Left="359" TabOrder="5" Text="HRTS&#32;자재비" Top="15" Width="83"></Static>
					<Static Color="user6" Height="16" Id="Static1" Left="799" TabOrder="7" Text="DI-PBX2&#32;EXCHANGER" Top="16" Width="127"></Static>
					<Grid AutoEnter="TRUE" AutoFitEndLine="Hide" AutoScrollBar="Vert" BindDataset="ds_dipbx2ex" BkColor2="default" BoldHead="true" Border="Flat" Bottom="452" CellMoving="TRUE" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="420" Id="grd_dipbx2ex" InputPanel="FALSE" Left="798" LineColor="user20" LineType="ExHORZ" OnCellDBLClick="grd_list_OnCellDblClick" OnExpandEdit="grd_list_OnExpandEdit" OnHeadClick="grd_list_OnHeadClick" Right="950" RowHeight="20" Style="sty_grid" TabOrder="6" TabStop="true" Top="32" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="152">
						<contents>
							<format id="Default">
								<columns>
									<col width="50"/>
									<col width="84"/>
								</columns>
								<head>
									<cell col="0" display="text" font="굴림,9" text="대수"/>
									<cell col="1" display="text" font="굴림,9" text="원가"/>
								</head>
								<body>
									<cell align="center" bkcolor2="user22" col="0" colid="GUBUN" display="text"/>
									<cell align="right" col="1" colid="AMT" display="currency" edit="number" limit="8" Mask="########"/>
								</body>
							</format>
						</contents>
					</Grid>
					<Static Color="user6" Height="11" Id="Static2" Left="10" TabOrder="8" Text="재료비" Top="16" Width="83"></Static>
				</TabPage>
				<TabPage BorderColor="black" Height="484" Id="tab3" ImageID="tab_form_09" Left="2" TabOrder="3" Text="인센티브" Top="24" Width="956">
					<Grid AutoEnter="TRUE" AutoFitEndLine="Hide" AutoScrollBar="None" BindDataset="ds_inc" BkColor2="default" BoldHead="true" Border="Flat" Bottom="192" CellMoving="TRUE" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="160" Id="grd_inc" InputPanel="FALSE" Left="7" LineColor="user20" LineType="ExHORZ" OnCellDBLClick="grd_list_OnCellDblClick" OnExpandEdit="grd_list_OnExpandEdit" OnHeadClick="grd_list_OnHeadClick" Right="174" RowHeight="20" Style="sty_grid" TabOrder="1" TabStop="true" Top="32" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="167">
						<contents>
							<format id="Default">
								<columns>
									<col width="26"/>
									<col width="70"/>
									<col width="70"/>
								</columns>
								<head>
									<cell col="0" display="text" font="굴림,9" text="No"/>
									<cell col="1" display="text" font="굴림,9" text="구간시작"/>
									<cell col="2" display="text" font="굴림,9" text="비율"/>
								</head>
								<body>
									<cell align="center" bkcolor2="user22" col="0" display="text" expr="currow+1"/>
									<cell align="center" bkcolor2="user22" col="1" colid="CS605_INTV" display="number" edit="number" limit="3"/>
									<cell align="right" bkcolor2="user22" col="2" colid="CS605_RAT" display="number" edit="number" limit="3" Mask="##.#%"/>
								</body>
							</format>
						</contents>
					</Grid>
					<Static Color="user6" Height="12" Id="Static0" Left="13" TabOrder="2" Text="협력사&#32;인센티브" Top="13" Width="92"></Static>
				</TabPage>
				<TabPage BorderColor="black" Height="484" Id="tab4" ImageID="tab_form_09" Left="2" TabOrder="4" Text="경비&#32;및&#32;기타" Top="24" Width="956">
					<Grid AutoEnter="TRUE" AutoFitEndLine="Hide" AutoScrollBar="None" BindDataset="ds_gsb" BkColor2="default" BoldHead="true" Border="Flat" Bottom="92" CellMoving="TRUE" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="60" Id="grd_gsb" InputPanel="FALSE" Left="6" LineColor="user20" LineType="ExHORZ" OnCellDBLClick="grd_list_OnCellDblClick" OnExpandEdit="grd_list_OnExpandEdit" OnHeadClick="grd_list_OnHeadClick" Right="436" RowHeight="20" Style="sty_grid" TabOrder="1" TabStop="true" Top="32" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="430">
						<contents>
							<format id="Default">
								<columns>
									<col width="26"/>
									<col width="100"/>
									<col width="100"/>
									<col width="100"/>
									<col width="103"/>
								</columns>
								<head>
									<cell col="0" display="text" font="굴림,9" text="No"/>
									<cell col="1" display="text" font="굴림,9" text="구분"/>
									<cell col="2" display="text" font="굴림,9" text="기준층"/>
									<cell col="3" display="text" font="굴림,9" text="기준수수료"/>
									<cell col="4" display="text" font="굴림,9" text="체증"/>
								</head>
								<body>
									<cell align="center" bkcolor2="user22" col="0" display="text" expr="currow+1"/>
									<cell align="center" bkcolor2="user22" col="1" colid="GUBUNNM" display="text"/>
									<cell align="left" bkcolor2="user22" col="2" colid="FLRNM" display="text"/>
									<cell align="right" bkcolor2="user22" col="3" colid="COMMI" display="currency" edit="number" limit="7" Mask="#######"/>
									<cell align="right" bkcolor2="user22" col="4" colid="INCRE" display="currency" edit="number" limit="5" Mask="#####"/>
								</body>
							</format>
						</contents>
					</Grid>
					<Static Color="user6" Height="13" Id="Static0" Left="11" TabOrder="2" Text="검사비" Top="13" Width="40"></Static>
					<Static Color="user6" Height="13" Id="Static1" Left="11" TabOrder="4" Text="속도" Top="173" Width="40"></Static>
					<Grid AutoEnter="TRUE" AutoFitEndLine="Hide" AutoScrollBar="None" BindDataset="ds_spd" BkColor2="default" BoldHead="true" Border="Flat" Bottom="312" CellMoving="TRUE" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="120" Id="grd_spd" InputPanel="FALSE" Left="7" LineColor="user20" LineType="ExHORZ" OnCellDBLClick="grd_list_OnCellDblClick" OnExpandEdit="grd_list_OnExpandEdit" OnHeadClick="grd_list_OnHeadClick" Right="208" RowHeight="20" Style="sty_grid" TabOrder="3" TabStop="true" Top="192" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="201">
						<contents>
							<format id="Default">
								<columns>
									<col width="100"/>
									<col width="100"/>
								</columns>
								<head>
									<cell col="0" display="text" font="굴림,9" text="속도구분"/>
									<cell col="1" display="text" font="굴림,9" text="점검&#32;M/H"/>
								</head>
								<body>
									<cell align="center" bkcolor2="user22" col="0" colid="GUBUN" display="text"/>
									<cell align="right" bkcolor2="user22" col="1" colid="RAT" display="number" edit="number" limit="3" Mask="###.##"/>
								</body>
							</format>
						</contents>
					</Grid>
					<Static Color="user6" Height="11" Id="Static2" Left="235" TabOrder="6" Text="점검주기" Top="173" Width="51"></Static>
					<Grid AutoEnter="TRUE" AutoFitEndLine="Hide" AutoScrollBar="None" BindDataset="ds_mpr" BkColor2="default" BoldHead="true" Border="Flat" Bottom="272" CellMoving="TRUE" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="80" Id="grd_mpr" InputPanel="FALSE" Left="231" LineColor="user20" LineType="ExHORZ" OnCellDBLClick="grd_list_OnCellDblClick" OnExpandEdit="grd_list_OnExpandEdit" OnHeadClick="grd_list_OnHeadClick" Right="432" RowHeight="20" Style="sty_grid" TabOrder="5" TabStop="true" Top="192" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="201">
						<contents>
							<format id="Default">
								<columns>
									<col width="100"/>
									<col width="100"/>
								</columns>
								<head>
									<cell col="0" display="text" font="굴림,9" text="주기구분"/>
									<cell col="1" display="text" font="굴림,9" text="비율"/>
								</head>
								<body>
									<cell align="center" bkcolor2="user22" col="0" colid="GUBUNNM" display="text"/>
									<cell align="right" bkcolor2="user22" col="1" colid="RAT" display="number" edit="number" limit="3" Mask="##.#%"/>
								</body>
							</format>
						</contents>
					</Grid>
					<Static Color="user6" Height="11" Id="Static3" Left="459" TabOrder="8" Text="Roping&#32;방식" Top="173" Width="83"></Static>
					<Grid AutoEnter="TRUE" AutoFitEndLine="Hide" AutoScrollBar="None" BindDataset="ds_rop" BkColor2="default" BoldHead="true" Border="Flat" Bottom="272" CellMoving="TRUE" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="80" Id="grd_rop" InputPanel="FALSE" Left="454" LineColor="user20" LineType="ExHORZ" OnCellDBLClick="grd_list_OnCellDblClick" OnExpandEdit="grd_list_OnExpandEdit" OnHeadClick="grd_list_OnHeadClick" Right="755" RowHeight="20" Style="sty_grid" TabOrder="7" TabStop="true" Top="192" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="301">
						<contents>
							<format id="Default">
								<columns>
									<col width="100"/>
									<col width="100"/>
									<col width="100"/>
								</columns>
								<head>
									<cell col="0" display="text" font="굴림,9" text="방식"/>
									<cell col="1" display="text" font="굴림,9" text="작업시간"/>
									<cell col="2" display="text" font="굴림,9" text="투입인원"/>
								</head>
								<body>
									<cell align="center" bkcolor2="user22" col="0" colid="GUBUNNM" display="text"/>
									<cell align="right" bkcolor2="user22" col="1" colid="TIME" display="number" edit="number" limit="3" Mask="###"/>
									<cell align="right" bkcolor2="user22" col="2" colid="MAN" display="number" edit="number" limit="3" Mask="###"/>
								</body>
							</format>
						</contents>
					</Grid>
					<Static Color="user6" Height="11" Id="Static4" Left="358" TabOrder="9" Text="(직영만&#32;해당)" Top="275" Width="80"></Static>
				</TabPage>
				<TabPage BorderColor="black" Height="484" Id="tab5" ImageID="tab_form_09" Left="2" TabOrder="5" Text="간접비&#32;및&#32;공사임율" Top="24" Width="956">
					<Shape BKColor="user12" Bottom="65" Height="26" Id="Shape4" Left="135" LineColor="user13" Right="232" TabOrder="1" Top="39" Type="Rectangle" Width="97"></Shape>
					<Static Align="Center" Height="24" Id="Static24" Left="136" Style="sty_lb_form_basic" TabOrder="2" Text="정기보수" Top="40" VAlign="Middle" Width="95"></Static>
					<Shape BKColor="user12" Bottom="90" Height="26" Id="Shape0" Left="135" LineColor="user13" Right="232" TabOrder="3" Top="64" Type="Rectangle" Width="97"></Shape>
					<Static Align="Center" Height="24" Id="Static0" Left="136" Style="sty_lb_form_basic" TabOrder="4" Text="수리공사" Top="65" VAlign="Middle" Width="95"></Static>
					<Shape BKColor="user12" Bottom="115" Height="26" Id="Shape1" Left="135" LineColor="user13" Right="232" TabOrder="5" Top="89" Type="Rectangle" Width="97"></Shape>
					<Static Align="Center" Height="24" Id="Static1" Left="136" Style="sty_lb_form_basic" TabOrder="6" Text="부품판매" Top="90" VAlign="Middle" Width="95"></Static>
					<Static Color="user6" Height="11" Id="Static3" Left="139" TabOrder="7" Text="간접비" Top="21" Width="83"></Static>
					<Static Color="user6" Height="11" Id="Static2" Left="283" TabOrder="8" Text="(%)" Top="46" Width="83"></Static>
					<Static Color="user6" Height="11" Id="Static4" Left="283" TabOrder="9" Text="(%)" Top="72" Width="83"></Static>
					<Static Color="user6" Height="11" Id="Static5" Left="283" TabOrder="10" Text="(%)" Top="97" Width="83"></Static>
					<Shape BKColor="user12" Bottom="65" Height="26" Id="Shape2" Left="415" LineColor="user13" Right="512" TabOrder="11" Top="39" Type="Rectangle" Width="97"></Shape>
					<Static Align="Center" Height="24" Id="Static6" Left="416" Style="sty_lb_form_basic" TabOrder="12" Text="정기보수" Top="40" VAlign="Middle" Width="95"></Static>
					<MaskEdit BindDataset="ds_wrk" Column="CS600_RAT" DigitLen="7" Height="28" Id="edt_wrk" Left="511" Mask="######" MaxLength="6" ShadowColor="user12" Style="sty_ipt_form" TabOrder="13" Top="38" Value="0" Width="91"></MaskEdit>
					<MaskEdit BindDataset="ds_ind" Column="CS604_NB" DigitLen="3" Height="26" Id="edt_ind_nb" Left="231" Mask="##" MaxLength="3" ShadowColor="user12" Style="sty_ipt_form" TabOrder="14" Top="89" Value="0" Width="47"></MaskEdit>
					<MaskEdit BindDataset="ds_ind" Column="CS604_NS" DigitLen="3" Height="26" Id="edt_ind_ns" Left="231" Mask="##" MaxLength="3" ShadowColor="user12" Style="sty_ipt_form" TabOrder="15" Top="64" Value="0" Width="47"></MaskEdit>
					<MaskEdit BindDataset="ds_ind" Column="CS604_US" DigitLen="3" Height="26" Id="edt_ind_us" Left="231" Mask="##" MaxLength="3" ShadowColor="user12" Style="sty_ipt_form" TabOrder="16" Top="38" Value="0" Width="47"></MaskEdit>
					<Static Color="user6" Height="11" Id="Static7" Left="419" TabOrder="17" Text="공사임율" Top="21" Width="83"></Static>
					<Static Align="Center" Height="24" Id="Static8" Left="416" Style="sty_lb_form_basic" TabOrder="18" Text="수리공사" Top="65" VAlign="Middle" Width="95"></Static>
					<MaskEdit BindDataset="ds_wrk" Column="CS600_RAT2" DigitLen="7" Height="28" Id="edt_wrk2" Left="511" Mask="######" MaxLength="6" ShadowColor="user12" Style="sty_ipt_form" TabOrder="19" Top="63" Value="0" Width="91"></MaskEdit>
				</TabPage>
			</Contents>
		</Tab>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_copy" ImageID="btn_sub_05" Left="885" LeftMargin="12" OnClick="btn_copy_OnClick" Style="sty_btn" TabOrder="5" Text="Copy&#32;Tool" Top="32" Transparent="TRUE" Width="83"></Button>
	</Form>
	<Script><![CDATA[﻿﻿﻿﻿﻿﻿﻿/*
 ******************************************************************************************
 * 기      능   : 정기보수 수주 시행율 관리
 * 작  성  자   : 이종석
 * 작성  일자   : 2014.10.22
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
#include "LIB::commons.js";	// 공통 스크립트 
//=========================================================================================
// [ PART 1 ]
// Form에서 사용될 전역변수를 선언
// FORM에서 사용되는 전역변수는 대문자로 작성하며, F_XXX 의 형태를 갖도록 한다. 
//=========================================================================================

//=========================================================================================
// [ PART 2 ]
// Form Loading / Unloading 시 작업 정의
//=========================================================================================
function fn_OnLoadCompleted(obj) {
	gfn_initForm();


	//기준 년 콤포를 초기화한다.
	ufn_initYearCombo();
}
/********************************************************************************
* 기      능   : 공통코드가 조회된 후의 Callback 함수 
********************************************************************************/
function fn_completeInit(sCode, sDsObj, sCodeType) {

}
/********************************************************************************
* 기      능   : form UnloadCompleted 
********************************************************************************/
function fn_OnUnloadCompleted(obj) {
	return gfn_isFormUnload(obj);
}
//=========================================================================================
// [ PART 3 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,form닫기)
//=========================================================================================

/********************************************************************************
* 기      능   : 조회 1
********************************************************************************/
function fn_query() {

}
/********************************************************************************
* 기      능   : 삽입 20
********************************************************************************/
function fn_insert() {

}

/********************************************************************************
* 기      능   : 취소 35
********************************************************************************/
function fn_cancel() {
	if(!gfn_showConfirm("CI00013", "입력"))
	{
		return;
	}
	
	var strYear = cb_year.Value;
	if(cb_year.Index == 0)
	{
		gfn_showAlert("CW10025", "연도를 선택해주세요.");
		return;
	}
	
	ds_cond.SetColumn(0, "ZYEAR", strYear);
	
	//각 그리드를 채우기 위한 함수를 호출한다.
	
	ufn_retrieveData(ds_cond);		//13개 그리드에 데이터를 채운다
}

/********************************************************************************
* 기      능   : Delete 
********************************************************************************/
function fn_delete() {

}
/********************************************************************************
* 기      능   : 저장 
********************************************************************************/
function fn_save() {
	
	//선택 연도를 조회한다.
	var strYear = cb_year.Value;
	if(cb_year.Index == 0)
	{
		gfn_showAlert("CW10025", "연도를 선택해주세요.");
		return;
	}
	
	ds_cond.SetColumn(0, "ZYEAR", strYear);
	
	/* Start Of Input Validation Routines -------------------------------------------------------------------------------------- */
	
	//준비작업
	tit_clearActionInfo();

	//ZCST500 : S2 : 노무비
	if(!ufn_checkDataSetStatus(ds_nmb))
	{
		gfn_showAlert("CW10025", "노무비 항목 중 누락된 항목이 존재합니다. \n확인 후 다시 시도하시기 바랍니다.");
		tab_main.tab1.grd_nmb.SetFocus();
		return;
	}

	if(ds_cnt.GetColumn(0, "C500") > 0)	//데이터 존재 시 Delete문 추가
	{
		tit_addMultiActionInfo("cs96:CS9613002A_D2");
	}
	tit_addMultiActionInfo("cs96:CS9613002A_I2");	
	
	//ZCST5XX : S3 : 재료비
	if(!ufn_checkDataSetStatus(ds_mat))
	{
		gfn_showAlert("CW10025", "재료비 항목 중 누락된 항목이 존재합니다. \n확인 후 다시 시도하시기 바랍니다.");
		return;
	}

	if(ds_cnt.GetColumn(0, "C606") > 0)	//데이터 존재 시 Delete문 추가
	{
		tit_addMultiActionInfo("cs96:CS9613002A_D3");
	}
	tit_addMultiActionInfo("cs96:CS9613002A_I3");	
	
	//ZCST601 : S4 : HRTS 자재비
	if(!ufn_checkDataSetStatus(ds_hrtsmat))
	{
		gfn_showAlert("CW10025", "HRTS 자재비 항목 중 누락된 항목이 존재합니다. \n확인 후 다시 시도하시기 바랍니다.");
		return;
	}

	if(ds_cnt.GetColumn(0, "C601") > 0)	//데이터 존재 시 Delete문 추가
	{
		tit_addMultiActionInfo("cs96:CS9613002A_D4");
	}
	tit_addMultiActionInfo("cs96:CS9613002A_I4");		
	
	//ZCST5XX : S5 : DI-PBX 자재비
	if(!ufn_checkDataSetStatus(ds_dipbx))
	{
		gfn_showAlert("CW10025", "DI-PBX 자재비 항목 중 누락된 항목이 존재합니다. \n확인 후 다시 시도하시기 바랍니다.");
		return;
	}

	if(ds_cnt.GetColumn(0, "C602") > 0)	//데이터 존재 시 Delete문 추가
	{
		tit_addMultiActionInfo("cs96:CS9613002A_D5");
	}
	tit_addMultiActionInfo("cs96:CS9613002A_I5");	
	
	
	//ZCST507 : S6 : DI-PBX2 EXCHANGER
	if(!ufn_checkDataSetStatus(ds_dipbx2ex))
	{
		gfn_showAlert("CW10025", "DI-PBX2 EXCHANGER 항목 중 누락된 항목이 존재합니다. \n확인 후 다시 시도하시기 바랍니다.");
		return;
	}

	if(ds_cnt.GetColumn(0, "C507") > 0)	//데이터 존재 시 Delete문 추가
	{
		tit_addMultiActionInfo("cs96:CS9613002A_D6");
	}
	tit_addMultiActionInfo("cs96:CS9613002A_I6");	

	//ZCST5XX : S7 : 인센티브
	if(!ufn_checkDataSetStatus(ds_inc))
	{
		gfn_showAlert("CW10025", "인센티브 항목 중 누락된 항목이 존재합니다. \n확인 후 다시 시도하시기 바랍니다.");
		return;
	}

	if(ds_cnt.GetColumn(0, "C605") > 0)	//데이터 존재 시 Delete문 추가
	{
		tit_addMultiActionInfo("cs96:CS9613002A_D7");
	}
	tit_addMultiActionInfo("cs96:CS9613002A_I7");		

	//ZCST501 : S8 : 검사비
	if(!ufn_checkDataSetStatus(ds_gsb))
	{
		gfn_showAlert("CW10025", "검사비 항목 중 누락된 항목이 존재합니다. \n확인 후 다시 시도하시기 바랍니다.");
		return;
	}

	if(ds_cnt.GetColumn(0, "C501") > 0)	//데이터 존재 시 Delete문 추가
	{
		tit_addMultiActionInfo("cs96:CS9613002A_D8");
	}
	tit_addMultiActionInfo("cs96:CS9613002A_I8");	
	
	//ZCST502 : S9 : 속도별 요율
	if(!ufn_checkDataSetStatus(ds_spd))
	{
		gfn_showAlert("CW10025", "속도 항목 중 누락된 항목이 존재합니다. \n확인 후 다시 시도하시기 바랍니다.");
		return;
	}

	if(ds_cnt.GetColumn(0, "C502") > 0)	//데이터 존재 시 Delete문 추가
	{
		tit_addMultiActionInfo("cs96:CS9613002A_D9");
	}
	tit_addMultiActionInfo("cs96:CS9613002A_I9");		
	
	//ZCST506 : S10 : 점검주기
	if(!ufn_checkDataSetStatus(ds_mpr))
	{
		gfn_showAlert("CW10025", "검사주기 항목 중 누락된 항목이 존재합니다. \n확인 후 다시 시도하시기 바랍니다.");
		return;
	}

	if(ds_cnt.GetColumn(0, "C506") > 0)	//데이터 존재 시 Delete문 추가
	{
		tit_addMultiActionInfo("cs96:CS9613002A_D10");
	}
	tit_addMultiActionInfo("cs96:CS9613002A_I10");		

	//ZCST503 : S11 : Roping 방식
	if(!ufn_checkDataSetStatus(ds_rop))
	{
		gfn_showAlert("CW10025", "Roping 방식 항목 중 누락된 항목이 존재합니다. \n확인 후 다시 시도하시기 바랍니다.");
		return;
	}

	if(ds_cnt.GetColumn(0, "C503") > 0)	//데이터 존재 시 Delete문 추가
	{
		tit_addMultiActionInfo("cs96:CS9613002A_D11");
	}
	tit_addMultiActionInfo("cs96:CS9613002A_I11");		

	//ZCST604 : S12 : 간접비 : ds_ind
	
	if(tab_main.tab5.edt_ind_us.value == "")
	{	
		gfn_showAlert("CW10025", "간접비 항목 중 정기보수 항목이 누락되었습니다.\n확인 후 다시 시도하시기 바랍니다.");
		tab_main.tab5.edt_ind_us.SetFocus();
		return;	
	}	
	
	if(tab_main.tab5.edt_ind_ns.value == "")
	{	
		gfn_showAlert("CW10025", "간접비 항목 중 수리공사 항목이 누락되었습니다.\n확인 후 다시 시도하시기 바랍니다.");
		tab_main.tab5.edt_ind_ns.SetFocus();
		return;	
	}	
	
	if(tab_main.tab5.edt_ind_nb.value == "")
	{	
		gfn_showAlert("CW10025", "간접비 항목 중 부품판매 항목이 누락되었습니다.\n확인 후 다시 시도하시기 바랍니다.");
		tab_main.tab5.edt_ind_nb.SetFocus();
		return;	
	}	
	
	if(ds_cnt.GetColumn(0, "C604") > 0)	//데이터 존재 시 Delete문 추가
	{
		tit_addMultiActionInfo("cs96:CS9613002A_D12");
	}
	tit_addMultiActionInfo("cs96:CS9613002A_I12");		
		
	
	//ZCST600 : S13 : 공사임율 : ds_wrk
	if(tab_main.tab5.edt_wrk.value == "")
	{	
		gfn_showAlert("CW10025", "공사임율(정기보수) 항목 중 누락된 항목이 존재합니다. \n확인 후 다시 시도하시기 바랍니다.");
		tab_main.tab5.edt_wrk.SetFocus();
		return;	
	}	
		
	if(tab_main.tab5.edt_wrk2.value == "")
	{	
		gfn_showAlert("CW10025", "공사임율(수리공사) 항목 중 누락된 항목이 존재합니다. \n확인 후 다시 시도하시기 바랍니다.");
		tab_main.tab5.edt_wrk2.SetFocus();
		return;	
	}		
	
	if(ds_cnt.GetColumn(0, "C600") > 0)	//데이터 존재 시 Delete문 추가
	{
		tit_addMultiActionInfo("cs96:CS9613002A_D13");
	}
	tit_addMultiActionInfo("cs96:CS9613002A_I13");		
		
	/* End Of Input Validation Routines ---------------------------------------------------------------------------------------- */
		
	if(!gfn_showConfirm("CI00008", "저장확인"))
	{
		tit_clearActionInfo();
		return;
	}	
	
	tit_callService(
	""
	, ""
	, "ds_cond=ds_cond ds_nmb=ds_nmb ds_mat=ds_mat ds_hrtsmat=ds_hrtsmat ds_dipbx=ds_dipbx ds_dipbx2ex=ds_dipbx2ex ds_inc=ds_inc ds_gsb=ds_gsb ds_spd=ds_spd ds_mpr=ds_mpr ds_rop=ds_rop ds_ind=ds_ind ds_wrk=ds_wrk"
	, ""
	, ""
	, "fn_afterSave");
}

/********************************************************************************
* 기      능   : 닫기  
********************************************************************************/
function fn_close() {
	close();
}

//=========================================================================================
// [ PART 4]
// Callback 함수 정의 : callback 함수명은 메인 함수의 fn_xxxx() 에서 xxxx 부분은 fn_afterXXXX()
// 형태가 되도록 작성 
//=========================================================================================
/********************************************************************************
* 기      능   : 조회 Callback  
********************************************************************************/
function fn_afterQuery(errCode, errMsg) {
	// 메시지 처리 
	//gfn_showSearchMsg();
}
/********************************************************************************
* 기      능   : 저장 Callback  
********************************************************************************/
function fn_afterSave(errCode, errMsg) {
	if(errCode != 0) {
		gfn_showMsg("CE00001");
	} else {
		gfn_showMsg("CI00003");
		close();
	}
}
//=========================================================================================
// [ PART 5 ]
// Detail Process Event 정의 ( User Define function )
// 사용자 정의 함수는 ufn_xxxx() 형태로 작성 
//=========================================================================================

/********************************************************************************
* 기      능   : 기준 연도 콤보박스용 저장연도 조회(ZCST501)
********************************************************************************/
function ufn_initYearCombo() 
{
	tit_clearActionInfo();	
	tit_addSearchActionInfo("cs96:CS9613002A_S1");
	tit_callService(
        ""
        , ""
        , ""
        , "ds_year=ds_year"
        , ""
        , "ufn_afterInitYearCombo"
        , true);
}

function ufn_afterInitYearCombo(errCode, errMsg) {
	ds_year.insertRow(0);
	ds_year.setColumn(0, "ZYEAR", "- 선택 -");
	cb_year.value = "";
	cb_year.Index = 0;
}

/********************************************************************************
* 기      능   : 각 그리드에 빈값이 존재하는지 확인한다.
********************************************************************************/
function ufn_checkDataSetStatus(ds_target)
{
	for(iCnt=0;iCnt < ds_target.count;iCnt++)
	{
		for(iCntIn=0;iCntIn < ds_target.GetColCount();iCntIn++)
		{
			if(trim(ds_target.GetColumn(iCnt, iCntIn)).length == 0)
			{
				return false;
			}
		}	
	}	
	return true;
}

/********************************************************************************
* 기      능   : 연도별 데이터 retrieve
********************************************************************************/
function ufn_retrieveData(ds_cond)
{

	ufn_clearGrid();

	tit_clearActionInfo();	
	
	tit_addSearchActionInfo("cs96:CS9613002A_S21",null, true);		//각 테이블의 해당 연도의 카운트를 가져온다. 
	
	tit_addSearchActionInfo("cs96:CS9613002A_S2", null, true);  	//연도별 노무비 데이터 				ds_nmb
	tit_addSearchActionInfo("cs96:CS9613002A_S3", null, true);		//연도별 재료비						ds_mat
	tit_addSearchActionInfo("cs96:CS9613002A_S4", null, true);		//연도별 HRTS 자재비				ds_hrtsmat
	tit_addSearchActionInfo("cs96:CS9613002A_S5", null, true);		//연도별 DI-PBX 자재비				ds_dipbx
	tit_addSearchActionInfo("cs96:CS9613002A_S6", null, true);		//연도별 DIPBX2 EXCHANGER 데이터 	ds_dipbx2ex
	tit_addSearchActionInfo("cs96:CS9613002A_S7", null, true);		//연도별 인센티브					ds_inc
	tit_addSearchActionInfo("cs96:CS9613002A_S8", null, true);		//연도별 검사비						ds_gsb
	tit_addSearchActionInfo("cs96:CS9613002A_S9", null, true);		//연도별 속도						ds_spd
	tit_addSearchActionInfo("cs96:CS9613002A_S10", null, true);		//연도별 점검주기					ds_mpr
	tit_addSearchActionInfo("cs96:CS9613002A_S11", null, true);		//연도별 Roping 방식				ds_rop
	tit_addSearchActionInfo("cs96:CS9613002A_S12", null, true);		//연도별 간접비						ds_ind
	tit_addSearchActionInfo("cs96:CS9613002A_S13", null, true);		//연도별 공사임율					ds_wrk	
	tit_callService(	
        ""
        , ""
        , "ds_cond=ds_cond"
        , "ds_cnt=ds_cnt ds_nmb=ds_nmb ds_mat=ds_mat ds_hrtsmat=ds_hrtsmat ds_dipbx=ds_dipbx ds_dipbx2ex=ds_dipbx2ex ds_inc=ds_inc ds_gsb=ds_gsb ds_spd=ds_spd ds_mpr=ds_mpr ds_rop=ds_rop ds_ind=ds_ind ds_wrk=ds_wrk"
        , ""
        , "fn_afterQuery"
        , true
        , true);

}

/********************************************************************************
* 기      능   : 그리드의 데이터를 clear
********************************************************************************/
function ufn_clearGrid()
{
	gfn_clearGridSortMark(tab_main.tab1.grd_nmb); 
	gfn_clearGridSortMark(tab_main.tab2.grd_mat);
	gfn_clearGridSortMark(tab_main.tab2.grd_hrtsmat);
	gfn_clearGridSortMark(tab_main.tab2.grd_dipbx);
	gfn_clearGridSortMark(tab_main.tab2.grd_dipbx2ex);
	gfn_clearGridSortMark(tab_main.tab3.grd_inc);
	gfn_clearGridSortMark(tab_main.tab4.grd_gsb);
	gfn_clearGridSortMark(tab_main.tab4.grd_spd);
	gfn_clearGridSortMark(tab_main.tab4.grd_mpr);
	gfn_clearGridSortMark(tab_main.tab4.grd_rop);
	
	ds_nmb.Clear();
	ds_mat.Clear();
	ds_hrtsmat.Clear();
	ds_dipbx.Clear();
	ds_dipbx2ex.Clear();
	ds_inc.Clear();
	ds_gsb.Clear();
	ds_spd.Clear();
	ds_mpr.Clear();
	ds_rop.Clear();
	ds_ind.Clear();
	ds_wrk.Clear();
}

//=========================================================================================
// [ PART 6 ]
// component Event 정의 : 각 Component 별 이벤트 
//=========================================================================================
/********************************************************************************
* 기      능   : 그리드 헤더 클릭시 정렬 처리 
********************************************************************************/
function grd_list_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
{
	gfn_sortGrid(obj,nCell);
/*
	if ( nCell == 0 ) {
		// 그리드 표시할 컬럼 선택 
		gfn_selectGridCol(obj);
	} else {
		// 그리드 정렬 처리 
		gfn_sortGrid(obj,nCell);
	}
*/ 
}
 
/********************************************************************************
* 기      능   : 연도 변경
********************************************************************************/

function cb_year_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	
	//선택 연도를 조회한다.
	
	var strYear = cb_year.Value;
	if(cb_year.Index == 0)
	{
		gfn_showAlert("CW10025", "연도를 선택해주세요.");
		return;
	}
	
	ds_cond.SetColumn(0, "ZYEAR", strYear);
	
	//각 그리드를 채우기 위한 함수를 호출한다.
	
	ufn_retrieveData(ds_cond);		//13개 그리드에 데이터를 채운다
}

/********************************************************************************
* 기      능   : 카피툴 버튼 클릭
********************************************************************************/

function btn_copy_OnClick(obj)
{
	var arg = "scr='002A'";
	
	gfn_openPopup("CS9613002B", true, arg);
}
]]></Script>
</Window>