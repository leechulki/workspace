<?xml version="1.0" encoding="euc-kr"?>
<query>
	<type>select</type>
	<description><![CDATA[]]></description>
	<reload>true</reload>
	<monitoring>true</monitoring>
	<result-count>1</result-count>
	<statement>
<![CDATA[
SELECT  --TRIM(CHAR(ROWNUMBER() OVER(PARTITION BY REPLACE(Z01.JUMIN,'-','') ORDER BY Z01.RETID))) 
              --||'Â÷'  AS CHASU

              TRIM(CHAR(ROWNUMBER() OVER(PARTITION BY Z01.PERKEY ORDER BY Z01.RETID))) 
              ||'Â÷'  AS CHASU

             ,Z01.NAME1     ,Z01.RETID      ,ZLCD109.CTEXT2 AS RSN1      ,ZLCD110.CTEXT2 AS RSN2
             ,ZLCD111.CTEXT2 AS RSN3    ,ZPST0147.BIGO  AS RSN4
FROM SAPHEE.ZPST0001 AS Z01
    LEFT OUTER JOIN SAPHEE.ZPST0147 AS ZPST0147 ON Z01.MANDT=ZPST0147.MANDT AND Z01.LIFNR=ZPST0147.LIFNR AND Z01.PERNO=ZPST0147.PERNO
    LEFT OUTER JOIN SAPHEE.ZLCODE AS ZLCD109 ON ZPST0147.MANDT=ZLCD109.MANDT AND ZLCD109.LANG='KO' AND ZLCD109.CODE1='PS109' AND ZPST0147.PS109=ZLCD109.CODE2
    LEFT OUTER JOIN SAPHEE.ZLCODE AS ZLCD110 ON ZPST0147.MANDT=ZLCD110.MANDT AND ZLCD110.LANG='KO' AND ZLCD110.CODE1='PS110' AND ZPST0147.PS110=ZLCD110.CODE2
    LEFT OUTER JOIN SAPHEE.ZLCODE AS ZLCD111 ON ZPST0147.MANDT=ZLCD111.MANDT AND ZLCD111.LANG='KO' AND ZLCD111.CODE1='PS111' AND ZPST0147.PS111=ZLCD111.CODE2

WHERE Z01.MANDT = #G_MANDT#
--AND REPLACE(saphee.decrypt(Z01.JUMIN),'-','') = #JUMIN#
AND Z01.PERKEY = #PERKEY#
AND Z01.RETIF = 'X'
ORDER BY Z01.RETID

FOR FETCH ONLY WITH UR	]]></statement>
	<input default-name="ds_cond">
	</input>
	<output default-name="ds_ret">
	</output>
</query>
