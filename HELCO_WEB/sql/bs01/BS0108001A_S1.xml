<?xml version="1.0" encoding="euc-kr"?>
<query dynamic="true">
	<type>select</type>
	<description><![CDATA[]]></description>
	<reload>true</reload>
	<monitoring>true</monitoring>
	<result-count>1</result-count>
	<statement>
SELECT  '0' AS CHK
       ,'' AS FLAG
       ,BS101.BS101_RDT
       ,BS101.BS101_SEQ
       ,(SELECT M28.CTEXT2 FROM SAPHEE.ZLCODE M28 WHERE M28.MANDT = BS101.MANDT AND M28.CODE1 = 'CS131' AND M28.LANG = #G_LANG# AND M28.CODE2 = BS101.BS101_GBN) AS BS101_GBN
       ,(SELECT UF.USERNAME FROM SAPHEE.ZUSERF UF WHERE UF.MANDT = BS101.MANDT AND UF.USERNUMB = BS101.BS101_CID) AS BS101_CID
       ,BS101.BS101_AYM AS BS101_AYM
       ,BS101.BS101_ASQ AS BS101_ASQ
       ,BS101.BS101_AYM||'-'||BS101.BS101_ASQ AS BS101_NO
       ,BS101.BS101_GNM
       ,BS101.BS101_SPT
       ,BS101.BS101_QTY
       ,BS101.BS101_PST	   
       ,BS101.BS101_GNO       
       ,BS101.BS101_JRT
       ,VALUE(BS103_TDT ,'') AS BS103_TDT 
       ,VALUE(BS103_GDT ,'') AS BS103_GDT 
       ,VALUE(BS103_COMA,'') AS BS103_COMA
       ,VALUE(BS103_AMTA,0) AS BS103_AMTA
       ,VALUE(BS103_AMTW,0) AS BS103_AMTW
       ,ROUND(CASE WHEN VALUE(BS103_AMTA,0) = 0 THEN 0 ELSE VALUE(BS103_AMTW,0)/VALUE(BS103_AMTA,0)*100 END,2) AS SI_RATE
       ,VALUE(BS103_AMTT,0) AS BS103_AMTT
       ,ROUND(CASE WHEN VALUE(BS103_AMTA,0) = 0 THEN 0 ELSE VALUE(BS103_AMTT,0)/VALUE(BS103_AMTA,0)*100 END,2) AS TU_RATE
       ,VALUE(BS103_RSN ,'') AS BS103_RSN 
       ,VALUE(BS103_COMB,'') AS BS103_COMB
       ,VALUE(BS103_AMTB,0) AS BS103_AMTB
       ,ROUND(CASE WHEN VALUE(BS103_AMTB,0) = 0 THEN 0 ELSE VALUE(BS103_AMTW,0)/VALUE(BS103_AMTB,0)*100 END,2) AS TU2_RATE
       ,CASE WHEN BS103_PST IS NULL THEN '' ELSE BS103_PST END AS BS103_PST		 
       ,VALUE(BS103_RMK,'') AS BS103_RMK
       ,(SELECT M028.CTEXT2 FROM SAPHEE.ZLCODE AS M028 WHERE M028.MANDT = BS101.MANDT AND M028.CODE1 = 'BS116' AND M028.LANG = #G_LANG# AND M028.CODE2 = BS102_TYP) AS BS102_TYP
FROM SAPHEE.ZBST101 AS BS101
     LEFT OUTER JOIN SAPHEE.ZBST103 AS BS103 
	 ON BS101.MANDT = BS103.MANDT
	 AND BS101.BS101_AYM = BS103.BS103_AYM
	 AND BS101.BS101_ASQ = BS103.BS103_ASQ
	 LEFT OUTER JOIN SAPHEE.ZBST102 AS BS102
	 ON BS101.MANDT = BS102.MANDT
	 AND BS101.BS101_RDT = BS102.BS102_RDT
	 AND BS101.BS101_SEQ = BS102.BS102_SEQ
	 AND BS102.BS102_ISR = '001'
WHERE BS101.MANDT = #G_MANDT#
AND BS101.BS101_CDT BETWEEN #FCDT# AND #TCDT#
AND BS101.BS101_GNO = #G_ORG_VEND_CODE#
<isNotNull col="GBN">
AND BS101.BS101_GBN = #GBN#
</isNotNull>
<isEqual col="PST" value="10">
AND (BS103.BS103_PST IS NULL OR BS103.BS103_PST = '10')
</isEqual>
<isEqual col="PST" value="15">
AND BS103.BS103_PST = '15'
</isEqual>
<isNull col="PST">
AND (BS103.BS103_PST IS NULL OR BS103.BS103_PST = '10' OR BS103.BS103_PST = '15')
</isNull>

AND BS101.BS101_PST = '30'
AND BS101.BS101_JRT = '10'
<isEqual col="DESC" value="Y">
AND BS101_CID = #G_USER_ID#
</isEqual>

ORDER BY BS101.BS101_AYM||'-'||BS101.BS101_ASQ

WITH UR	</statement>
	<input default-name="ds_cond">
		<col name="PST" size="255" type="VARCHAR" description="" /> 
		<col name="G_MANDT" size="255" type="VARCHAR" description="" /> 
		<col name="FCDT" size="255" type="VARCHAR" description="" /> 
		<col name="TCDT" size="255" type="VARCHAR" description="" /> 
		<col name="GNO" size="255" type="VARCHAR" description="" /> 
		<col name="GBN" size="255" type="VARCHAR" description="" /> 
	</input>
	<output default-name="ds_list">
	</output>
</query>
