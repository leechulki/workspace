<?xml version="1.0" encoding="euc-kr"?>
<query dynamic="true">
	<type>select</type>
	<description><![CDATA[]]></description>
	<reload>true</reload>
	<monitoring>true</monitoring>
	<result-count>1</result-count>
	<statement>
SELECT  '0' AS CHK
       ,'' AS FLAG
       ,BS201.BS201_RDT
       ,BS201.BS201_SEQ
       ,BS201.BS201_SIR
       ,(SELECT M28.CTEXT2 FROM SAPHEE.ZLCODE M28 WHERE M28.MANDT = BS201.MANDT AND M28.CODE1 = 'CS131' AND M28.LANG = #G_LANG# AND M28.CODE2 = BS201.BS201_GBN) AS BS201_GBN
       ,(SELECT UF.USERNAME FROM SAPHEE.ZUSERF UF WHERE UF.MANDT = BS201.MANDT AND UF.USERNUMB = BS201.BS201_CID) AS BS201_CID
       ,BS201.BS201_AYM AS BS201_AYM
       ,BS201.BS201_ASQ AS BS201_ASQ
       ,BS201.BS201_AYM||'-'||BS201.BS201_ASQ AS BS201_NO
       ,BS201.BS201_DEV
       ,BS201.BS201_GNM
       ,BS201.BS201_SPT
       ,CASE 
             WHEN BS201.BS201_RDT &lt; '20110501' 
             THEN BS201.BS201_QTY
             ELSE (SELECT COUNT(*) FROM SAPHEE.ZBST202 WHERE MANDT = #G_MANDT# AND BS202_RDT = BS201.BS201_RDT AND BS202_SEQ = BS201.BS201_SEQ AND BS202_SIR = BS201.BS201_SIR)
        END BS201_QTY
       ,BS201.BS201_PST	   
       ,BS201.BS201_GNO       
       ,BS201.BS201_JRT
       ,BS201.BS201_CDT
       ,VALUE(BS203_TDT ,'') AS BS203_TDT 
       ,VALUE(BS203_GDT ,'') AS BS203_GDT 
       ,VALUE(BS203_COMA,'') AS BS203_COMA
       ,VALUE(BS203_AMTA,0) AS BS203_AMTA
       ,VALUE(BS203_AMTW,0) AS BS203_AMTW
       ,ROUND(CASE WHEN VALUE(BS203_AMTA,0) = 0 THEN 0 ELSE VALUE(BS203_AMTW,0)/VALUE(BS203_AMTA,0)*100 END,2) AS SI_RATE
       ,VALUE(BS203_AMTT,0) AS BS203_AMTT
       ,ROUND(CASE WHEN VALUE(BS203_AMTA,0) = 0 THEN 0 ELSE VALUE(BS203_AMTT,0)/VALUE(BS203_AMTA,0)*100 END,2) AS TU_RATE
       ,VALUE(BS203_RSN ,'') AS BS203_RSN 
       ,VALUE(BS203_COMB,'') AS BS203_COMB
       ,VALUE(BS203_AMTB,0) AS BS203_AMTB
       ,ROUND(CASE WHEN VALUE(BS203_AMTB,0) = 0 THEN 0 ELSE VALUE(BS203_AMTW,0)/VALUE(BS203_AMTB,0)*100 END,2) AS TU2_RATE
       ,CASE WHEN BS203_PST IS NULL THEN '' ELSE BS203_PST END AS BS203_PST		 
       ,VALUE(BS203_RMK,'') AS BS203_RMK
       ,CASE 
             WHEN BS201.BS201_RDT &lt; '20110501'
             THEN (SELECT M028.CTEXT2 FROM SAPHEE.ZLCODE AS M028 WHERE M028.MANDT = BS201.MANDT AND M028.CODE1 = 'BS116' AND M028.LANG = #G_LANG# AND M028.CODE2 = BS202_TYP)
             ELSE BS202.BS202_TYP
        END AS BS202_TYP
       ,VALUE(BS202_USE,'')||VALUE(BS202_MAN,'')||'-'||VALUE(BS202_OPN,'')||VALUE(BS202_SPD,'')||'-'||VALUE(BS202_STP,'') AS BS202_SPC
FROM SAPHEE.ZBST201 AS BS201
     LEFT OUTER JOIN SAPHEE.ZBST203 AS BS203 
	 ON BS201.MANDT = BS203.MANDT
	 AND BS201.BS201_AYM = BS203.BS203_AYM
	 AND BS201.BS201_ASQ = BS203.BS203_ASQ
	 LEFT OUTER JOIN SAPHEE.ZBST202 AS BS202
	 ON BS201.MANDT = BS202.MANDT
	 AND BS201.BS201_RDT = BS202.BS202_RDT
	 AND BS201.BS201_SEQ = BS202.BS202_SEQ
	 AND BS201.BS201_SIR = BS202.BS202_SIR
	 AND BS202.BS202_ISR = '001'
WHERE BS201.MANDT = #G_MANDT#
AND BS201.BS201_CDT BETWEEN #FCDT# AND #TCDT#
<isNotNull col="GBN">
AND BS201.BS201_GBN = #GBN#
</isNotNull>
<isEqual col="PST" value="10">
AND (BS203.BS203_PST IS NULL OR BS203.BS203_PST = '10')
</isEqual>
<isEqual col="PST" value="15">
AND BS203.BS203_PST = '15'
</isEqual>
<isNull col="PST">
AND (BS203.BS203_PST IS NULL OR BS203.BS203_PST = '10' OR BS203.BS203_PST = '15')
</isNull>
AND BS201.BS201_AGB = 'A'
AND BS201.BS201_PST = '30'
AND BS201.BS201_JRT = '10'
<isNotNull col="ARA">
AND BS201.BS201_ARA = #ARA#
</isNotNull>
<isNotNull col="GNO">
AND BS201.BS201_GNO = #GNO#
</isNotNull>
<isNotNull col="USER">
AND BS201.BS201_CID = #USER#
</isNotNull>
<isEqual col="DESC" value="Y">
AND BS201.BS201_CID = #G_USER_ID#
</isEqual>

ORDER BY BS201.BS201_AYM||'-'||BS201.BS201_ASQ

WITH UR	</statement>
	<input default-name="ds_cond">
	</input>
	<output default-name="ds_list">
	</output>
</query>
