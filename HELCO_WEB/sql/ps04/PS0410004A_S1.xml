<?xml version="1.0" encoding="euc-kr"?>
<query dynamic="true">
	<type>select</type>
	<description><![CDATA[]]></description>
	<reload>true</reload>
	<monitoring>true</monitoring>
	<result-count>1</result-count>
	<statement>
	SELECT  T2.PSPID,     T2.POSID  ,  T2.FDBC      , T2.CAGEA    , T2.CAGEW   , T2.CAGEC  ,  T2.CAGEF ,                     
            T2.JAMB200  , T2.HATCH  ,  T2.BUTTON    , T2.JAMB200C , T2.BUTTONC , T2.HATCHC ,                     
            T2.JAMB100  , T2.JAMB50 ,   T2.JAMB100C , T2.JAMB50C  , T2.SPSFM   ,
			CASE WHEN T2.CAGEA    = '' THEN 0 ELSE 1 END AS CNTA,
            CASE WHEN T2.CAGEW    = '' THEN 0 ELSE 1 END AS CNTB,
            CASE WHEN T2.CAGEC    = '' THEN 0 ELSE 1 END AS CNTC,
            CASE WHEN T2.CAGEF    = '' THEN 0 ELSE 1 END AS CNTD,
            CASE WHEN T2.JAMB200  = '' THEN 0 ELSE 1 END AS CNTE,
            CASE WHEN T2.HATCH    = '' THEN 0 ELSE 1 END AS CNTF,
            CASE WHEN T2.BUTTON   = '' THEN 0 ELSE 1 END AS CNTG,
            CASE WHEN T2.JAMB100  = '' THEN 0 ELSE 1 END AS CNTH,
            CASE WHEN T2.JAMB50   = '' THEN 0 ELSE 1 END AS CNTI,
            CASE WHEN T2.SPSFM    = '' THEN 0 ELSE 1 END AS CNTJ,
            CASE WHEN T2.FDBC     = '' THEN 0 ELSE 1 END AS CNTK
                          
FROM

(
   SELECT A.POSID AS PSPID, A.POSID_1 AS POSID ,
            MAX(VALUE(CASE WHEN T.ATNAM = 'EL_FDBC'    THEN T.VALUE ELSE '' END,'')) AS FDBC ,    
            MAX(VALUE(CASE WHEN T.ATNAM = 'EL_FDBCGA'  THEN T.VALUE ELSE '' END,'')) AS CAGEA ,      
            MAX(VALUE(CASE WHEN T.ATNAM = 'EL_FDBCGW'  THEN T.VALUE ELSE '' END,'')) AS CAGEW ,     
            MAX(VALUE(CASE WHEN T.ATNAM = 'EL_FDBCGC'  THEN T.VALUE ELSE '' END,'')) AS CAGEC    ,   
            MAX(VALUE(CASE WHEN T.ATNAM = 'EL_FDBCGF'  THEN T.VALUE ELSE '' END,'')) AS CAGEF    ,    
            MAX(VALUE(CASE WHEN T.ATNAM = 'EL_FDBJB'   THEN T.VALUE ELSE '' END,'')) AS JAMB200  ,     
            MAX(VALUE(CASE WHEN T.ATNAM = 'EL_FDBHD'   THEN T.VALUE ELSE '' END,'')) AS HATCH    ,    
            MAX(VALUE(CASE WHEN T.ATNAM = 'EL_FDBBT'   THEN T.VALUE ELSE '' END,'')) AS BUTTON   ,     
            MAX(VALUE(CASE WHEN T.ATNAM = 'EL_FDBJBQ'  THEN T.VALUE ELSE '' END,'')) AS JAMB200C ,      
            MAX(VALUE(CASE WHEN T.ATNAM = 'EL_FDBBTQ'  THEN T.VALUE ELSE '' END,'')) AS BUTTONC  ,     
            MAX(VALUE(CASE WHEN T.ATNAM = 'EL_FDBHDQ'  THEN T.VALUE ELSE '' END,'')) AS HATCHC   ,    
            MAX(VALUE(CASE WHEN T.ATNAM = 'EL_FDBJB2'  THEN T.VALUE ELSE '' END,'')) AS JAMB100  ,     
            MAX(VALUE(CASE WHEN T.ATNAM = 'EL_FDBJB3'  THEN T.VALUE ELSE '' END,'')) AS JAMB50   ,    
            MAX(VALUE(CASE WHEN T.ATNAM = 'EL_FDBJB2Q' THEN T.VALUE ELSE '' END,'')) AS JAMB100C ,      
            MAX(VALUE(CASE WHEN T.ATNAM = 'EL_FDBJB3Q' THEN T.VALUE ELSE '' END,'')) AS JAMB50C ,
            MAX(VALUE(CASE WHEN T.ATNAM = 'SP_SFM' THEN T.VALUE ELSE '' END,'')) AS SPSFM   
			
FROM SAPHEE.ZMASTER02  AS A
LEFT OUTER JOIN 
(SELECT A.MANDT,  HOGI, ATNAM, CASE WHEN ATWTB = ''  or ATWTB is null  THEN cast(CAST(ATFLV AS int) as char(10)) ELSE ATWTB END   AS VALUE
     FROM   SAPHEE.CABN AS A INNER JOIN SAPHEE.IBSYMBOL AS C ON A.MANDT = C.MANDT AND A.ATINN = C.ATINN 
    INNER JOIN SAPHEE.IBINVALUES AS D ON C.MANDT = D.MANDT AND C.SYMBOL_ID = D.SYMBOL_ID 
    INNER JOIN SAPHEE.IBIN AS E ON D.MANDT = E.MANDT AND D.IN_RECNO = E.IN_RECNO 
    INNER JOIN SAPHEE.IBINOWN AS F ON E.MANDT = F.MANDT AND E.INSTANCE = F.INSTANCE 
    INNER JOIN SAPHEE.VBAP AS G ON F.MANDT = G.MANDT AND F.INSTANCE = G.CUOBJ 
    LEFT OUTER JOIN ( SELECT MANDT,ATINN, ATZHL,ADZHL,ATWRT FROM SAPHEE.CAWN ) AS H ON A.MANDT = H.MANDT AND A.ATINN = H.ATINN  AND C.ATWRT = H.ATWRT 
    LEFT OUTER JOIN SAPHEE.CAWNT AS I ON H.MANDT = I.MANDT AND H.ATINN = I.ATINN AND H.ATZHL = I.ATZHL AND I.SPRAS = '3' 
   WHERE A.MANDT = #G_MANDT#
     AND G.HOGI  LIKE #PSPID# ||'%'
     AND A.ATNAM IN ('EL_ZDBCG', 'EL_ZDBJB', 'EL_ZDBHD', 'EL_ZDBBT', 'EL_FDBC',  'EL_FDBCGA', 'EL_FDBCGW', 'EL_FDBCGC', 'EL_FDBCGF', 'EL_FDBJB', 'EL_FDBHD', 
                                 'EL_FDBBT', 'EL_FDBJBQ', 'EL_FDBBTQ', 'EL_FDBHDQ', 'EL_FDBJB2', 'EL_FDBJB3', 'EL_FDBJB2Q', 'EL_FDBJB3Q', 'SP_SFM') 
) AS T
 ON A.MANDT = T.MANDT
AND A.POSID = SUBSTR(T.HOGI,1,6)
AND A.POSID_1 = T.HOGI
WHERE A.MANDT = #G_MANDT#
  AND A.POSID = #PSPID#
  
GROUP BY A.POSID, A.POSID_1

)  AS T2

FOR FETCH ONLY
WITH UR	</statement>
	<input default-name="ds_cond">
	</input>
	<output default-name="ds_list">
	</output>
</query>
