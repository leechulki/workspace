<?xml version="1.0" encoding="euc-kr"?>
<query dynamic="true">
	<type>select</type>
	<description><![CDATA[수주 리모델링 자동도면 대상 호기 조회]]></description>
	<reload>true</reload>
	<monitoring>true</monitoring>
	<result-count>0</result-count>
	<statement>

SELECT X.HOGI AS HOGI
      ,Y.SUVST
FROM   TABLE (
			SELECT A.MANDT
			      ,A.ZZPJT_ID
			      ,B.HOGI
				  ,MAX(CASE WHEN H.ATNAM = 'EL_ATYP' THEN
					  CASE F.ATWRT WHEN '' THEN TRIM(CHAR(BIGINT(VALUE(F.ATFLV,0)))) ELSE TRIM(F.ATWRT) END
				   ELSE
					  ''
				   END)  AS EL_ATYP  
				  ,MAX(CASE WHEN H.ATNAM = 'EL_AUSE' THEN
					  CASE F.ATWRT WHEN '' THEN TRIM(CHAR(BIGINT(VALUE(F.ATFLV,0)))) ELSE TRIM(F.ATWRT) END
				   ELSE
					  ''
				   END)  AS EL_AUSE  
				  ,MAX(CASE WHEN H.ATNAM = 'EL_AMAN' THEN
					  CASE F.ATWRT WHEN '' THEN TRIM(CHAR(BIGINT(VALUE(F.ATFLV,0)))) ELSE TRIM(F.ATWRT) END
				   ELSE
					  ''
				   END)  AS EL_AMAN  
				  ,MAX(CASE WHEN H.ATNAM = 'EL_ASPD' THEN
					  CASE F.ATWRT WHEN '' THEN TRIM(CHAR(BIGINT(VALUE(F.ATFLV,0)))) ELSE TRIM(F.ATWRT) END
				   ELSE
					  ''
				   END)  AS EL_ASPD  
				  ,MAX(CASE WHEN H.ATNAM = 'EL_ERPR' THEN
					  CASE F.ATWRT WHEN '' THEN TRIM(CHAR(BIGINT(VALUE(F.ATFLV,0)))) ELSE TRIM(F.ATWRT) END
				   ELSE
					  ''
				   END)  AS EL_ERPR  
				  ,MAX(CASE WHEN H.ATNAM = 'EL_EHM' THEN
					  CASE F.ATWRT WHEN '' THEN TRIM(CHAR(BIGINT(VALUE(F.ATFLV,0)))) ELSE TRIM(F.ATWRT) END
				   ELSE
					  ''
				   END)  AS EL_EHM  
				  ,MAX(CASE WHEN H.ATNAM = 'EL_ETHRU' THEN
					  CASE F.ATWRT WHEN '' THEN TRIM(CHAR(BIGINT(VALUE(F.ATFLV,0)))) ELSE TRIM(F.ATWRT) END
				   ELSE
					  ''
				   END)  AS EL_ETHRU  
				  ,MAX(CASE WHEN H.ATNAM = 'EL_ECWTP' THEN
					  CASE F.ATWRT WHEN '' THEN TRIM(CHAR(BIGINT(VALUE(F.ATFLV,0)))) ELSE TRIM(F.ATWRT) END
				   ELSE
					  ''
				   END)  AS EL_ECWTP
			FROM SAPHEE.VBAK AS A
				 INNER JOIN SAPHEE.VBAP AS B ON A.MANDT = B.MANDT AND A.VBELN = B.VBELN
				 INNER JOIN SAPHEE.IBINOWN AS C ON B.MANDT = C.MANDT AND B.CUOBJ = C.INSTANCE
				 INNER JOIN SAPHEE.IBIN AS D ON C.MANDT = D.MANDT AND C.INSTANCE = D.INSTANCE
				 INNER JOIN SAPHEE.IBINVALUES AS E ON D.MANDT = E.MANDT AND D.IN_RECNO = E.IN_RECNO
				 INNER JOIN SAPHEE.IBSYMBOL AS F  ON E.MANDT = F.MANDT AND E.SYMBOL_ID = F.SYMBOL_ID
				 INNER JOIN SAPHEE.CABN AS H ON F.MANDT = H.MANDT AND F.ATINN = H.ATINN
			WHERE A.MANDT = #G_MANDT#
			 AND  A.ZZPJT_ID = #VBELN#
			 AND  H.ATNAM IN ( 'EL_ATYP', 'EL_AUSE', 'EL_AMAN', 'EL_ASPD', 'EL_ERPR', 'EL_EHM', 'EL_ETHRU', 'EL_ECWTP')
			GROUP BY A.MANDT
			        ,A.ZZPJT_ID
			        ,B.HOGI
	   ) X
	   LEFT OUTER JOIN SAPHEE.ZPST1135 AS Y ON Y.MANDT = X.MANDT AND Y.ZZPJT_ID = X.ZZPJT_ID AND Y.HOGI = X.HOGI
WHERE  X.EL_ATYP = 'LXVF'
  AND  X.EL_AUSE IN ('PS', 'HC', 'EP', 'EH')
  AND  TO_NUMBER(X.EL_AMAN) BETWEEN 6  AND 21
  AND  X.EL_ASPD IN ( '60', '90', '105')
  AND  X.EL_ERPR IN ( '1:1', '2:1')
  AND  X.EL_EHM = 'CEMEN'
  AND  X.EL_ETHRU != 'Y'
  AND  X.EL_ECWTP = 'R'
WITH UR


 </statement>
	<input default-name="ds_cond">
	</input>
	<output default-name="ds_rad_hogi">
	</output>
</query>
