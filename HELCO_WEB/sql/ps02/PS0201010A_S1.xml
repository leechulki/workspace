<?xml version="1.0" encoding="euc-kr"?>
<query dynamic="true">
	<type>select</type>
	<description><![CDATA[]]></description>
	<reload>true</reload>
	<monitoring>true</monitoring>
	<result-count>0</result-count>
	<statement>

	SELECT T.GJAHR
	 	 , T.WWEEK
	     , T.SWEEK
	     , T.GBN
	     , SUM(T.ZZACTSS_21_PLAN) AS ZZACTSS_21_PLAN
	     , SUM(T.ZZACTSS_21_KEYIN) AS ZZACTSS_21_KEYIN
	     , DECODE(SUM(T.ZZACTSS_21_PLAN),0,0,TO_CHAR(ROUND(DECIMAL(SUM(T.ZZACTSS_21_KEYIN),15,2) / DECIMAL(SUM(T.ZZACTSS_21_PLAN),15,2),2)*100,'990'))||'%' AS PER_21
	     
	     , SUM(T.ZZACTSS_10_PLAN) AS ZZACTSS_10_PLAN
	     , SUM(T.ZZACTSS_10_KEYIN) AS ZZACTSS_10_KEYIN
	     , DECODE(SUM(T.ZZACTSS_10_PLAN),0,0,TO_CHAR(ROUND(DECIMAL(SUM(T.ZZACTSS_10_KEYIN),15,2) / DECIMAL(SUM(T.ZZACTSS_10_PLAN),15,2),2)*100,'990'))||'%' AS PER_10
	     
	     , SUM(T.ZZACTSS_08_PLAN) AS ZZACTSS_08_PLAN
	     , SUM(T.ZZACTSS_08_KEYIN) AS ZZACTSS_08_KEYIN
	     , DECODE(SUM(T.ZZACTSS_08_PLAN),0,0,TO_CHAR(ROUND(DECIMAL(SUM(T.ZZACTSS_08_KEYIN),15,2) / DECIMAL(SUM(T.ZZACTSS_08_PLAN),15,2),2)*100,'990'))||'%' AS PER_08
	     
	     , (SUM(T.ZZACTSS_21_PLAN) + SUM(T.ZZACTSS_10_PLAN) + SUM(T.ZZACTSS_08_PLAN)) AS SUM_PLAN_01
	     , (SUM(T.ZZACTSS_21_KEYIN) + SUM(T.ZZACTSS_10_KEYIN) + SUM(T.ZZACTSS_08_KEYIN)) AS SUM_KEYIN_01
	     , CASE WHEN (SUM(T.ZZACTSS_21_PLAN) + SUM(T.ZZACTSS_10_PLAN) + SUM(T.ZZACTSS_08_PLAN)) = 0
	            THEN '0%'
	            ELSE  TO_CHAR((ROUND(DECIMAL((SUM(T.ZZACTSS_21_KEYIN) + SUM(T.ZZACTSS_10_KEYIN) + SUM(T.ZZACTSS_08_KEYIN)))
	                   / DECIMAL((SUM(T.ZZACTSS_21_PLAN) + SUM(T.ZZACTSS_10_PLAN) + SUM(T.ZZACTSS_08_PLAN))),2)*100),'990')||'%'
	     		END AS SUM_PER_01
	     
	     , SUM(T.ZZACTSS_02_PLAN) AS ZZACTSS_02_PLAN
	     , SUM(T.ZZACTSS_02_KEYIN) AS ZZACTSS_02_KEYIN
	     , DECODE(SUM(T.ZZACTSS_02_PLAN),0,0,TO_CHAR(ROUND(DECIMAL(SUM(T.ZZACTSS_02_KEYIN),15,2) / DECIMAL(SUM(T.ZZACTSS_02_PLAN),15,2),2)*100,'990'))||'%' AS PER_02
	    
	     , SUM(T.ZZACTSS_19_PLAN) AS ZZACTSS_19_PLAN
	     , SUM(T.ZZACTSS_19_KEYIN) AS ZZACTSS_19_KEYIN
	     
	     , DECODE(SUM(T.ZZACTSS_19_PLAN),0,0,TO_CHAR(ROUND(DECIMAL(SUM(T.ZZACTSS_19_KEYIN),15,2) / DECIMAL(SUM(T.ZZACTSS_19_PLAN),15,2),2)*100,'990'))||'%' AS PER_19
	     
	     , SUM(T.ZZACTSS_20_PLAN) AS ZZACTSS_20_PLAN
	     , SUM(T.ZZACTSS_20_KEYIN) AS ZZACTSS_20_KEYIN
	     , DECODE(SUM(T.ZZACTSS_20_PLAN),0,0,TO_CHAR(ROUND(DECIMAL(SUM(T.ZZACTSS_20_KEYIN),15,2) / DECIMAL(SUM(T.ZZACTSS_20_PLAN),15,2),2)*100,'990'))||'%' AS PER_20
	     
	     , (SUM(T.ZZACTSS_02_PLAN) + SUM(T.ZZACTSS_19_PLAN) + SUM(T.ZZACTSS_20_PLAN)) AS SUM_PLAN_02
	     , (SUM(T.ZZACTSS_02_KEYIN) + SUM(T.ZZACTSS_19_KEYIN) + SUM(T.ZZACTSS_20_KEYIN)) AS SUM_KEYIN_02
	     , CASE WHEN (SUM(T.ZZACTSS_02_PLAN) + SUM(T.ZZACTSS_19_PLAN) + SUM(T.ZZACTSS_20_PLAN)) = 0
	            THEN '0%'
	            ELSE  TO_CHAR((ROUND(DECIMAL((SUM(T.ZZACTSS_02_KEYIN) + SUM(T.ZZACTSS_19_KEYIN) + SUM(T.ZZACTSS_20_KEYIN)))
	                   / DECIMAL((SUM(T.ZZACTSS_02_PLAN) + SUM(T.ZZACTSS_19_PLAN) + SUM(T.ZZACTSS_20_PLAN))),2)*100),'990')||'%'
	     		END AS SUM_PER_02
	     
	     
	     , SUM(T.ZZACTSS_06_PLAN) AS ZZACTSS_06_PLAN
	     , SUM(T.ZZACTSS_06_KEYIN) AS ZZACTSS_06_KEYIN
	     , DECODE(SUM(T.ZZACTSS_06_PLAN),0,0,TO_CHAR(ROUND(DECIMAL(SUM(T.ZZACTSS_06_KEYIN),15,2) / DECIMAL(SUM(T.ZZACTSS_06_PLAN),15,2),2)*100,'990'))||'%' AS PER_06
	     
	     , SUM(T.ZZACTSS_05_PLAN) AS ZZACTSS_05_PLAN
	     , SUM(T.ZZACTSS_05_KEYIN) AS ZZACTSS_05_KEYIN
	     , DECODE(SUM(T.ZZACTSS_05_PLAN),0,0,TO_CHAR(ROUND(DECIMAL(SUM(T.ZZACTSS_05_KEYIN),15,2) / DECIMAL(SUM(T.ZZACTSS_05_PLAN),15,2),2)*100,'990'))||'%' AS PER_05
	     
	     , SUM(T.ZZACTSS_07_PLAN) AS ZZACTSS_07_PLAN
	     , SUM(T.ZZACTSS_07_KEYIN) AS ZZACTSS_07_KEYIN
	     , DECODE(SUM(T.ZZACTSS_07_PLAN),0,0,TO_CHAR(ROUND(DECIMAL(SUM(T.ZZACTSS_07_KEYIN),15,2) / DECIMAL(SUM(T.ZZACTSS_07_PLAN),15,2),2)*100,'990'))||'%' AS PER_07
	     
	     
	     , (SUM(T.ZZACTSS_06_PLAN) + SUM(T.ZZACTSS_05_PLAN) + SUM(T.ZZACTSS_07_PLAN)) AS SUM_PLAN_03
	     , (SUM(T.ZZACTSS_06_KEYIN) + SUM(T.ZZACTSS_05_KEYIN) + SUM(T.ZZACTSS_07_KEYIN) ) AS SUM_KEYIN_03
	     , CASE WHEN (SUM(T.ZZACTSS_06_PLAN) + SUM(T.ZZACTSS_05_PLAN) + SUM(T.ZZACTSS_07_PLAN)) = 0
	            THEN '0%'
	            ELSE  TO_CHAR((ROUND(DECIMAL((SUM(T.ZZACTSS_06_KEYIN) + SUM(T.ZZACTSS_05_KEYIN) + SUM(T.ZZACTSS_07_KEYIN)))
	                   / DECIMAL((SUM(T.ZZACTSS_06_PLAN) + SUM(T.ZZACTSS_05_PLAN) + SUM(T.ZZACTSS_07_PLAN))),2)*100),'990')||'%'
	     		END AS SUM_PER_03
	     
	     
	     
	     , SUM(T.ZZACTSS_03_PLAN) AS ZZACTSS_03_PLAN
	     , SUM(T.ZZACTSS_03_KEYIN) AS ZZACTSS_03_KEYIN
	     , DECODE(SUM(T.ZZACTSS_03_PLAN),0,0,TO_CHAR(ROUND(DECIMAL(SUM(T.ZZACTSS_03_KEYIN),15,2) / DECIMAL(SUM(T.ZZACTSS_03_PLAN),15,2),2)*100,'990'))||'%' AS PER_03
	     
	     , SUM(T.ZZACTSS_04_PLAN) AS ZZACTSS_04_PLAN
	     , SUM(T.ZZACTSS_04_KEYIN) AS ZZACTSS_04_KEYIN
	     , DECODE(SUM(T.ZZACTSS_04_PLAN),0,0,TO_CHAR(ROUND(DECIMAL(SUM(T.ZZACTSS_04_KEYIN),15,2) / DECIMAL(SUM(T.ZZACTSS_04_PLAN),15,2),2)*100,'990'))||'%' AS PER_04
	     
	     , SUM(T.ZZACTSS_09_PLAN) AS ZZACTSS_09_PLAN
	     , SUM(T.ZZACTSS_09_KEYIN) AS ZZACTSS_09_KEYIN
	     , DECODE(SUM(T.ZZACTSS_09_PLAN),0,0,TO_CHAR(ROUND(DECIMAL(SUM(T.ZZACTSS_09_KEYIN),15,2) / DECIMAL(SUM(T.ZZACTSS_09_PLAN),15,2),2)*100,'990'))||'%' AS PER_09
	     
	     , SUM(T.ZZACTSS_11_PLAN) AS ZZACTSS_11_PLAN
	     , SUM(T.ZZACTSS_11_KEYIN) AS ZZACTSS_11_KEYIN
	     , DECODE(SUM(T.ZZACTSS_11_PLAN),0,0,TO_CHAR(ROUND(DECIMAL(SUM(T.ZZACTSS_11_KEYIN),15,2) / DECIMAL(SUM(T.ZZACTSS_11_PLAN),15,2),2)*100,'990'))||'%' AS PER_11
	     
	     
	     , (SUM(T.ZZACTSS_03_PLAN) + SUM(T.ZZACTSS_04_PLAN) + SUM(T.ZZACTSS_09_PLAN) + SUM(T.ZZACTSS_11_PLAN)) AS SUM_PLAN_04
	     , (SUM(T.ZZACTSS_03_KEYIN) + SUM(T.ZZACTSS_04_KEYIN) + SUM(T.ZZACTSS_09_KEYIN) + SUM(T.ZZACTSS_11_KEYIN)) AS SUM_KEYIN_04
	     , CASE WHEN (SUM(T.ZZACTSS_03_PLAN) + SUM(T.ZZACTSS_04_PLAN) + SUM(T.ZZACTSS_09_PLAN) + SUM(T.ZZACTSS_11_PLAN)) = 0
	            THEN '0%'
	            ELSE  TO_CHAR((ROUND(DECIMAL((SUM(T.ZZACTSS_03_KEYIN) + SUM(T.ZZACTSS_04_KEYIN) + SUM(T.ZZACTSS_09_KEYIN) + SUM(T.ZZACTSS_11_KEYIN)))
	                   / DECIMAL((SUM(T.ZZACTSS_03_PLAN) + SUM(T.ZZACTSS_04_PLAN) + SUM(T.ZZACTSS_09_PLAN) + SUM(T.ZZACTSS_11_PLAN))),2)*100),'990')||'%'
	     		END AS SUM_PER_04
	     
	     , SUM(T.ZZACTSS_12_PLAN) AS ZZACTSS_12_PLAN
	     , SUM(T.ZZACTSS_12_KEYIN) AS ZZACTSS_12_KEYIN
	     , DECODE(SUM(T.ZZACTSS_12_PLAN),0,0,TO_CHAR(ROUND(DECIMAL(SUM(T.ZZACTSS_12_KEYIN),15,2) / DECIMAL(SUM(T.ZZACTSS_12_PLAN),15,2),2)*100,'990'))||'%' AS PER_12
	     
	     , SUM(T.ZZACTSS_14_PLAN) AS ZZACTSS_14_PLAN
	     , SUM(T.ZZACTSS_14_KEYIN) AS ZZACTSS_14_KEYIN
	     , DECODE(SUM(T.ZZACTSS_14_PLAN),0,0,TO_CHAR(ROUND(DECIMAL(SUM(T.ZZACTSS_14_KEYIN),15,2) / DECIMAL(SUM(T.ZZACTSS_14_PLAN),15,2),2)*100,'990'))||'%' AS PER_14
	     
	     , SUM(T.ZZACTSS_01_PLAN) AS ZZACTSS_01_PLAN
	     , SUM(T.ZZACTSS_01_KEYIN) AS ZZACTSS_01_KEYIN
	     , DECODE(SUM(T.ZZACTSS_01_PLAN),0,0,TO_CHAR(ROUND(DECIMAL(SUM(T.ZZACTSS_01_KEYIN),15,2) / DECIMAL(SUM(T.ZZACTSS_01_PLAN),15,2),2)*100,'990'))||'%' AS PER_01
	
	  FROM
	  (
	  		SELECT TBL.GJAHR
	  			 , TBL.WWEEK
			     , TBL.SWEEK
			     , TBL.GBN
			     , (
						CASE WHEN TBL.ZZACTSS = '21'
						     THEN TBL.PLAN_CNT
						     ELSE 0
						     END
			       ) AS ZZACTSS_21_PLAN -- 강북
			     , (
						CASE WHEN TBL.ZZACTSS = '21'
						     THEN TBL.KEYIN_CNT
						     ELSE 0
						     END
			       ) AS ZZACTSS_21_KEYIN -- 강북
			     , (
			     		CASE WHEN TBL.ZZACTSS = '10'
						     THEN TBL.PLAN_CNT
						     ELSE 0
						     END
			       ) AS ZZACTSS_10_PLAN -- 인천
			     , (
			     		CASE WHEN TBL.ZZACTSS = '10'
						     THEN TBL.KEYIN_CNT
						     ELSE 0
						     END
			       ) AS ZZACTSS_10_KEYIN -- 인천
				 , (
				 		CASE WHEN TBL.ZZACTSS = '08'
						     THEN TBL.PLAN_CNT
						     ELSE 0
						     END
				   ) AS ZZACTSS_08_PLAN -- 강원
				 , (
				 		CASE WHEN TBL.ZZACTSS = '08'
						     THEN TBL.KEYIN_CNT
						     ELSE 0
						     END
				   ) AS ZZACTSS_08_KEYIN -- 강원
			
				 , (
				 		CASE WHEN TBL.ZZACTSS = '02'
						     THEN TBL.PLAN_CNT
						     ELSE 0
						     END
					) AS ZZACTSS_02_PLAN -- 강남
					
				 , (
				 		CASE WHEN TBL.ZZACTSS = '02'
						     THEN TBL.KEYIN_CNT
						     ELSE 0
						     END
					) AS ZZACTSS_02_KEYIN -- 강남
					
				
				 , (
				 		CASE WHEN TBL.ZZACTSS = '19'
						     THEN TBL.PLAN_CNT
						     ELSE 0
						     END
				   ) AS ZZACTSS_19_PLAN -- 강서
				 , (
				 		CASE WHEN TBL.ZZACTSS = '19'
						     THEN TBL.KEYIN_CNT
						     ELSE 0
						     END
				   ) AS ZZACTSS_19_KEYIN -- 강서  
				 , (
				 		CASE WHEN TBL.ZZACTSS = '20'
						     THEN TBL.PLAN_CNT
						     ELSE 0
						     END
				   ) AS ZZACTSS_20_PLAN -- 중부
				 , (
				 		CASE WHEN TBL.ZZACTSS = '20'
						     THEN TBL.KEYIN_CNT
						     ELSE 0
						     END
				   ) AS ZZACTSS_20_KEYIN -- 중부
				   
				 , (
				 		CASE WHEN TBL.ZZACTSS = '06'
						     THEN TBL.PLAN_CNT
						     ELSE 0
						     END
				   ) AS ZZACTSS_06_PLAN -- 대전
				 , (
				 		CASE WHEN TBL.ZZACTSS = '06'
						     THEN TBL.KEYIN_CNT
						     ELSE 0
						     END
				   ) AS ZZACTSS_06_KEYIN -- 대전
				 , (
				 		CASE WHEN TBL.ZZACTSS = '05'
						     THEN TBL.PLAN_CNT
						     ELSE 0
						     END
				   ) AS ZZACTSS_05_PLAN -- 광주
				 , (
				 		CASE WHEN TBL.ZZACTSS = '05'
						     THEN TBL.KEYIN_CNT
						     ELSE 0
						     END
				   ) AS ZZACTSS_05_KEYIN -- 광주
				 , (
				 		CASE WHEN TBL.ZZACTSS = '07'
						     THEN TBL.PLAN_CNT
						     ELSE 0
						     END
				   ) AS ZZACTSS_07_PLAN -- 전주
				 , (
				 		CASE WHEN TBL.ZZACTSS = '07'
						     THEN TBL.KEYIN_CNT
						     ELSE 0
						     END
				   ) AS ZZACTSS_07_KEYIN -- 전주
				 , (
				 		CASE WHEN TBL.ZZACTSS = '12'
						     THEN TBL.PLAN_CNT
						     ELSE 0
						     END
				   ) AS ZZACTSS_12_PLAN -- 제주
				 , (
				 		CASE WHEN TBL.ZZACTSS = '12'
						     THEN TBL.KEYIN_CNT
						     ELSE 0
						     END
				   ) AS ZZACTSS_12_KEYIN -- 제주
				   
				 , (
				 		CASE WHEN TBL.ZZACTSS = '03'
						     THEN TBL.PLAN_CNT
						     ELSE 0
						     END
				   ) AS ZZACTSS_03_PLAN -- 부산
				 , (
				 		CASE WHEN TBL.ZZACTSS = '03'
						     THEN TBL.KEYIN_CNT
						     ELSE 0
						     END
				   ) AS ZZACTSS_03_KEYIN -- 부산
				 , (
				 		CASE WHEN TBL.ZZACTSS = '04'
						     THEN TBL.PLAN_CNT
						     ELSE 0
						     END
				   ) AS ZZACTSS_04_PLAN -- 대구
				 , (
				 		CASE WHEN TBL.ZZACTSS = '04'
						     THEN TBL.KEYIN_CNT
						     ELSE 0
						     END
				   ) AS ZZACTSS_04_KEYIN -- 대구
				 , (
				 		CASE WHEN TBL.ZZACTSS = '11'
						     THEN TBL.PLAN_CNT
						     ELSE 0
						     END
				   ) AS ZZACTSS_11_PLAN -- 경남
				 , (
				 		CASE WHEN TBL.ZZACTSS = '11'
						     THEN TBL.KEYIN_CNT
						     ELSE 0
						     END
				   ) AS ZZACTSS_11_KEYIN -- 경남
				 , (
				 		CASE WHEN TBL.ZZACTSS = '09'
						     THEN TBL.PLAN_CNT
						     ELSE 0
						     END
				   ) AS ZZACTSS_09_PLAN -- 울산
			
				 , (
				 		CASE WHEN TBL.ZZACTSS = '09'
						     THEN TBL.KEYIN_CNT
						     ELSE 0
						     END
				   ) AS ZZACTSS_09_KEYIN -- 울산
				   
				 , (
				 		CASE WHEN TBL.ZZACTSS = '14'
						     THEN TBL.PLAN_CNT
						     ELSE 0
						     END
				   ) AS ZZACTSS_14_PLAN -- 리모델링
				 , (
				 		CASE WHEN TBL.ZZACTSS = '14'
						     THEN TBL.KEYIN_CNT
						     ELSE 0
						     END
				   ) AS ZZACTSS_14_KEYIN -- 리모델링
				 , (
				 		CASE WHEN TBL.ZZACTSS = '01'
						     THEN TBL.PLAN_CNT
						     ELSE 0
						     END
				   ) AS ZZACTSS_01_PLAN -- 직영
				 , (
				 		CASE WHEN TBL.ZZACTSS = '01'
						     THEN TBL.KEYIN_CNT
						     ELSE 0
						     END
				   ) AS ZZACTSS_01_KEYIN -- 직영
				 
			FROM (
			 SELECT T1.GJAHR
			     , T1.SWEEK
			     , T1.WWEEK
			     , CASE WHEN #CNFM_TERM# = 'W2'
			            THEN 'W2'
			            WHEN #CNFM_TERM# = 'W3'
			            THEN 'W3'
			            WHEN #CNFM_TERM# = 'W4'
			            THEN 'W4'
			            WHEN #CNFM_TERM# = 'W6'
			            THEN 'W6'
			            ELSE ''
			            END AS GBN
			     , T2.ZZACTSS
			     , T2.TEXT30
			     , COUNT(1) AS PLAN_CNT
			     , SUM(DECODE(VALUE(T3.PM_CNFM,'0'),'X',1,0)) KEYIN_CNT
			     
			     
			  FROM SAPHEE.ZPPT190 AS T1
			  LEFT OUTER JOIN SAPHEE.ZMASTER02 AS T2
			               ON T1.MANDT = T2.MANDT
			              AND T1.PSPID = T2.POSID
			              AND T1.POSID = T2.POSID_1
			  LEFT OUTER JOIN SAPHEE.ZPST0190 AS T3
			               ON T1.MANDT = T3.MANDT
			              AND T1.GJAHR = T3.GJAHR
			              AND T1.SWEEK = T3.SWEEK
			              AND T1.WWEEK = T3.WWEEK
			              AND T1.DGUBUN = T3.DGUBUN
			              AND T1.PSPID  = T3.PSPID
			              AND T1.POSID  = T3.POSID
			  LEFT OUTER JOIN SAPHEE.ZMASTER01 AS T4
			               ON T1.MANDT = T4.MANDT
			              AND T1.PSPID = T4.POSID
			  LEFT OUTER JOIN SAPHEE.PRPS AS T5
			               ON T1.MANDT = T5.MANDT
			              AND T1.POSID = T5.POSID         
			 WHERE T1.MANDT = #G_MANDT#
			   AND T1.DGUBUN = '1'
			   <isNotNull col="QUERY_DATE">
				#QUERY_DATE+#
			   </isNotNull>
			   
			     GROUP BY T1.GJAHR
			     , T1.SWEEK
			     , T1.WWEEK
			     , T2.ZZACTSS
			     , T2.TEXT30
			  
			) AS TBL
	  ) T
	WHERE 1=1
	GROUP BY  T.GJAHR
	     , T.SWEEK
	     , T.WWEEK
	     , T.GBN

FOR FETCH ONLY
WITH UR	</statement>
	<input default-name="ds_cond">
	</input>
	<output default-name="ds_list">
	</output>
</query>
